{
    "hands_on_practices": [
        {
            "introduction": "我们实践的第一步是从一个具体的例子开始：计算臭氧（$\\text{O}_3$）的偶极矩。这个练习旨在揭示一个核心问题：即使是像Hartree-Fock这样的基本理论，在处理具有显著静态相关特征的分子时也可能得出错误的结论。通过比较平均场方法（HF）和包含电子相关作用的方法给出的结果，你将亲身体会到电子相关如何深刻影响分子的电子分布和可观测属性。",
            "id": "2451531",
            "problem": "在玻恩-奥本海默近似下，一个中性三原子分子的电偶极矩矢量由所有电荷的一阶矩定义为\n$$\n\\boldsymbol{\\mu} \\;=\\; \\sum_{A} Z_A e\\, \\mathbf{R}_A \\;-\\; \\int \\rho(\\mathbf{r})\\, e\\, \\mathbf{r}\\, d^3 r,\n$$\n其中 $Z_A$ 是原子核 $A$ 的原子序数，$e$ 是基本电荷，$\\mathbf{R}_A$ 是原子核位置矢量，$\\rho(\\mathbf{r})$ 是电子电荷密度。在与布居分析一致的电子密度点电荷近似中，分子偶极矩可以计算为\n$$\n\\boldsymbol{\\mu} \\;=\\; \\sum_{i=1}^{N} q_i\\, \\mathbf{R}_i,\n$$\n其中 $q_i$ 是以 $e$ 为单位的净原子部分电荷，其总和为零，$\\mathbf{R}_i$ 是以埃（$\\mathring{\\mathrm{A}}$）为单位的原子位置矢量。其大小为 $|\\boldsymbol{\\mu}|$，单位换算为 $1~\\mathrm{e\\cdot\\mathring{A}} = 4.80320427~\\mathrm{D}$，其中 $\\mathrm{D}$ 表示德拜（Debye）。角度必须以度为单位处理。\n\n使用此定义，编写一个完整的程序，用于根据提供的臭氧（$\\text{O}_3$）几何构型和净原子部分电荷，计算其在哈特里-福克（HF）和相关能级（例如 Møller-Plesset 二阶微扰理论（MP2）或单双激发耦合簇（CCSD））下的偶极矩大小（单位为德拜）。使用以下参数集作为测试套件。对于弯曲构型，将中心原子置于原点，并将两个端基原子放置在距离原点为键长 $L$ 的 $xy$ 平面上，两个端基原子之间的键角为 $\\theta$（度）；具体来说，取端基原子的位置为\n$$\n\\mathbf{R}_{\\text{term},1} = \\big(L \\cos(\\theta/2),\\, L \\sin(\\theta/2),\\, 0\\big),\\quad\n\\mathbf{R}_{\\text{term},2} = \\big(L \\cos(\\theta/2),\\, -L \\sin(\\theta/2),\\, 0\\big),\n$$\n中心原子位于 $\\mathbf{R}_{\\text{cent}} = (0,0,0)$。对于线性构型，将中心原子置于 $\\mathbf{R}_{\\text{cent}}=(0,0,0)$，两个端基原子置于 $\\mathbf{R}_{\\text{term},1}=(+L,0,0)$ 和 $\\mathbf{R}_{\\text{term},2}=(-L,0,0)$。\n\n所有电荷均以 $e$ 为单位给出，且总和为零。对于每种情况，报告三个值：HF 偶极矩大小（德拜）、相关方法偶极矩大小（德拜）以及这两个大小之间的绝对差值（德拜）。将这三个值都表示为四舍五入到六位小数的浮点数。您的程序应生成单行输出，包含一个逗号分隔的列表的列表，例如 $[[x_1,y_1,z_1],[x_2,y_2,z_2],\\dots]$。\n\n测试套件：\n- 情况 1（臭氧，弯曲型）：$L = 1.278~\\mathring{\\mathrm{A}}$，$\\theta = 116.8^\\circ$。HF 电荷：$\\{+0.300,\\,-0.150,\\,-0.150\\}$。相关电荷：$\\{+0.165,\\,-0.0825,\\,-0.0825\\}$。\n- 情况 2（臭氧，弯曲型）：$L = 1.278~\\mathring{\\mathrm{A}}$，$\\theta = 116.8^\\circ$。HF 电荷：$\\{+0.400,\\,-0.200,\\,-0.200\\}$。相关电荷：$\\{+0.180,\\,-0.090,\\,-0.090\\}$。\n- 情况 3（线性对称三原子，边界情况）：$L = 1.160~\\mathring{\\mathrm{A}}$，$\\theta = 180.0^\\circ$。HF 电荷：$\\{+1.000,\\,-0.500,\\,-0.500\\}$。相关电荷：$\\{+1.000,\\,-0.500,\\,-0.500\\}$。\n\n要求的最终输出格式：\n您的程序必须打印单行\n$$\n\\big[\\,[\\mu_{\\mathrm{HF},1},\\,\\mu_{\\mathrm{corr},1},\\,\\Delta_1],\\;[\\mu_{\\mathrm{HF},2},\\,\\mu_{\\mathrm{corr},2},\\,\\Delta_2],\\;[\\mu_{\\mathrm{HF},3},\\,\\mu_{\\mathrm{corr},3},\\,\\Delta_3]\\,\\big],\n$$\n其中每个 $\\mu$ 和 $\\Delta$ 都四舍五入到六位小数，单位为德拜。",
            "solution": "该问题陈述已经过严格验证，并被确定为有效。它在科学上是合理的、适定的、客观的，并为得出唯一解提供了一套完整且一致的数据和定义。该问题涉及计算化学中的一个标准计算——根据量子化学计算得出的点电荷模型确定分子偶极矩。所有提供的值和几何规定在物理上和数学上都是合理的。\n\n求解过程如下。核心原理是在点电荷近似内计算分子电偶极矩矢量 $\\boldsymbol{\\mu}$。提供的公式为\n$$\n\\boldsymbol{\\mu} \\;=\\; \\sum_{i=1}^{N} q_i\\, \\mathbf{R}_i\n$$\n其中 $N$ 是原子数，$q_i$ 是以基本电荷 $e$ 为单位的净原子部分电荷，$\\mathbf{R}_i$ 是相应的以埃（$\\mathring{\\mathrm{A}}$）为单位的原子位置矢量。得到的偶极矩矢量 $\\boldsymbol{\\mu}$ 的单位将是 $\\mathrm{e\\cdot\\mathring{A}}$。\n\n对于每个测试用例，我们必须首先确定分子中三个原子的笛卡尔坐标（$\\mathbf{R}_i$）。问题明确了坐标系和原子布局。\n\n对于弯曲的三原子分子，如情况 1 和 2 中的臭氧，中心原子位于原点 $\\mathbf{R}_{\\text{cent}} = (0,0,0)$。两个端基原子对称地放置在 $xy$ 平面内，距离原点为 $L$，它们之间的键角为 $\\theta$。位置由以下公式给出：\n$$\n\\mathbf{R}_{\\text{term},1} = \\big(L \\cos(\\theta/2),\\, L \\sin(\\theta/2),\\, 0\\big)\n$$\n$$\n\\mathbf{R}_{\\text{term},2} = \\big(L \\cos(\\theta/2),\\, -L \\sin(\\theta/2),\\, 0\\big)\n$$\n至关重要的是要注意，计算库中的三角函数通常要求角度以弧度为单位，因此给定的以度为单位的角度 $\\theta$ 必须通过关系式 $1^{\\circ} = \\pi/180$ 弧度进行转换。\n\n对于线性对称三原子分子，如情况 3，也提供了一个特定的坐标系：中心原子在原点 $\\mathbf{R}_{\\text{cent}}=(0,0,0)$，两个端基原子在 $\\mathbf{R}_{\\text{term},1}=(+L,0,0)$ 和 $\\mathbf{R}_{\\text{term},2}=(-L,0,0)$。\n\n部分电荷 $q_i$ 必须分配给正确的原子。对于所考虑的对称三原子分子（$\\text{O}_3$），有一个独特的中心原子和两个化学等价的端基原子。提供的电荷集，例如 $\\{+0.300,\\,-0.150,\\,-0.150\\}$，包含一个唯一值和两个相同的值。根据化学原理，唯一的电荷对应于中心原子，相同的电荷对应于两个端基原子。\n\n在确定坐标 $\\mathbf{R}_i$ 和电荷 $q_i$ 后，偶极矩矢量 $\\boldsymbol{\\mu} = (\\mu_x, \\mu_y, \\mu_z)$ 的分量计算如下：\n$$\n\\mu_x = \\sum_{i=1}^{3} q_i R_{i,x}\n$$\n$$\n\\mu_y = \\sum_{i=1}^{3} q_i R_{i,y}\n$$\n$$\n\\mu_z = \\sum_{i=1}^{3} q_i R_{i,z}\n$$\n对于弯曲情况，当 $\\mathbf{R}_{\\text{cent}} = \\mathbf{0}$，$q_1=q_{\\text{cent}}$，且 $q_2=q_3=q_{\\text{term}}$ 时，计算得以简化。由于对称性，$y$ 和 $z$ 分量变为零：\n$$\n\\mu_y = q_{\\text{term}}(L \\sin(\\theta/2)) + q_{\\text{term}}(-L \\sin(\\theta/2)) = 0\n$$\n$$\n\\mu_z = 0\n$$\n唯一非零的分量是 $\\mu_x$：\n$$\n\\mu_x = q_{\\text{cent}}(0) + q_{\\text{term}}(L \\cos(\\theta/2)) + q_{\\text{term}}(L \\cos(\\theta/2)) = 2 q_{\\text{term}} L \\cos(\\theta/2)\n$$\n对于线性情况，计算更加简单。当 $q_2=q_3=q_{\\text{term}}$ 时：\n$$\n\\mu_x = q_{\\text{term}}(+L) + q_{\\text{term}}(-L) = 0\n$$\n因此，对于线性对称情况，根据对称性要求，$\\boldsymbol{\\mu} = \\mathbf{0}$。\n\n在计算出单位为 $\\mathrm{e\\cdot\\mathring{A}}$ 的矢量 $\\boldsymbol{\\mu}$ 后，使用欧几里得范数求其大小 $|\\boldsymbol{\\mu}|$：\n$$\n|\\boldsymbol{\\mu}| = \\sqrt{\\mu_x^2 + \\mu_y^2 + \\mu_z^2}\n$$\n问题要求以德拜（$\\mathrm{D}$）为单位的大小。使用提供的转换因子进行转换：\n$$\n|\\boldsymbol{\\mu}|_{\\mathrm{D}} = |\\boldsymbol{\\mu}|_{\\mathrm{e\\cdot\\mathring{A}}} \\times 4.80320427~\\mathrm{D/(e\\cdot\\mathring{A})}\n$$\n此计算对哈特里-福克 (HF) 和相关电荷集都执行，分别得到 $\\mu_{\\mathrm{HF}}$ 和 $\\mu_{\\mathrm{corr}}$。最后，计算绝对差值：\n$$\n\\Delta = |\\mu_{\\mathrm{HF}} - \\mu_{\\mathrm{corr}}|\n$$\n对于每种情况，所有三个结果值（$\\mu_{\\mathrm{HF}}$, $\\mu_{\\mathrm{corr}}$, $\\Delta$）都四舍五入到六位小数。最终的程序为所有测试用例实现了这个完整的过程，并按规定格式化输出。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes molecular dipole moment magnitudes for a series of test cases\n    based on a point-charge approximation.\n    \"\"\"\n    \n    # Conversion factor from e*Angstrom to Debye\n    CONVERSION_FACTOR = 4.80320427\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (L, theta, HF_charges, Correlated_charges)\n    # Charges are ordered as (central, terminal1, terminal2).\n    test_cases = [\n        # Case 1 (ozone, bent)\n        (1.278, 116.8, (0.300, -0.150, -0.150), (0.165, -0.0825, -0.0825)),\n        # Case 2 (ozone, bent)\n        (1.278, 116.8, (0.400, -0.200, -0.200), (0.180, -0.090, -0.090)),\n        # Case 3 (linear symmetric triatomic)\n        (1.160, 180.0, (1.000, -0.500, -0.500), (1.000, -0.500, -0.500)),\n    ]\n\n    def calculate_dipole_magnitude_eA(L, theta, charges):\n        \"\"\"\n        Calculates the magnitude of the dipole moment in e*Angstrom.\n\n        Args:\n            L (float): Bond length in Angstrom.\n            theta (float): Bond angle in degrees.\n            charges (tuple): A tuple of three partial charges (q_central, q_term1, q_term2).\n\n        Returns:\n            float: The dipole moment magnitude in e*Angstrom.\n        \"\"\"\n        q_cent, q_term1, q_term2 = charges\n\n        if np.isclose(theta, 180.0):\n            # Linear geometry as specified\n            R_cent = np.array([0.0, 0.0, 0.0])\n            R_term1 = np.array([L, 0.0, 0.0])\n            R_term2 = np.array([-L, 0.0, 0.0])\n        else:\n            # Bent geometry as specified\n            theta_rad_half = np.radians(theta / 2.0)\n            R_cent = np.array([0.0, 0.0, 0.0])\n            R_term1 = np.array([L * np.cos(theta_rad_half), L * np.sin(theta_rad_half), 0.0])\n            R_term2 = np.array([L * np.cos(theta_rad_half), -L * np.sin(theta_rad_half), 0.0])\n            \n        # Define charge and position vectors\n        charge_vector = np.array([q_cent, q_term1, q_term2])\n        position_matrix = np.array([R_cent, R_term1, R_term2])\n\n        # Calculate dipole moment vector sum(q_i * R_i)\n        # Transpose position_matrix to multiply charges with corresponding x,y,z coordinates\n        mu_vector = np.dot(charge_vector, position_matrix)\n        \n        # Calculate magnitude of the dipole moment vector\n        mu_magnitude = np.linalg.norm(mu_vector)\n        \n        return mu_magnitude\n\n    all_results = []\n    for case in test_cases:\n        L, theta, hf_charges, corr_charges = case\n        \n        # Calculate HF dipole magnitude\n        mu_hf_eA = calculate_dipole_magnitude_eA(L, theta, hf_charges)\n        mu_hf_D = mu_hf_eA * CONVERSION_FACTOR\n        \n        # Calculate correlated dipole magnitude\n        mu_corr_eA = calculate_dipole_magnitude_eA(L, theta, corr_charges)\n        mu_corr_D = mu_corr_eA * CONVERSION_FACTOR\n        \n        # Calculate the absolute difference\n        delta = abs(mu_hf_D - mu_corr_D)\n        \n        # Append formatted results as strings with 6 decimal places\n        all_results.append([\n            f\"{mu_hf_D:.6f}\",\n            f\"{mu_corr_D:.6f}\",\n            f\"{delta:.6f}\"\n        ])\n\n    # Format the final output string as a list of lists without extra spaces\n    formatted_sublists = []\n    for sublist in all_results:\n        formatted_sublists.append(f\"[{','.join(sublist)}]\")\n    final_output_string = f\"[{','.join(formatted_sublists)}]\"\n\n    print(final_output_string)\n\nsolve()\n```"
        },
        {
            "introduction": "在上一个练习中，我们看到了电子相关的重要性，现在我们将深入探讨静态相关的根源。本练习将使用一个经典的化学反应——铍原子插入氢分子（$Be + H_2 \\rightarrow H\\text{-}Be\\text{-}H$）——的简化模型，来模拟势能面上电子态的相互作用。通过构建一个简单的$2 \\times 2$哈密顿矩阵，你将能够直观地理解静态相关是如何在化学键断裂和形成过程中的“避免交叉”区域产生的，并学会如何量化这种多参考特性。",
            "id": "2454410",
            "problem": "考虑一个用于插入反应 $Be + H_2 \\rightarrow H\\text{-}Be\\text{-}H$ 的简化双组态量子模型。设几何构型由一维反应坐标 $s$（无量纲）和弯曲角 $\\theta$（单位为弧度）参数化。在由两个主要电子组态构成的透热基中，电子哈密顿量表示为对称的 $2 \\times 2$ 矩阵\n$$\nH(s,\\theta) = \\begin{pmatrix}\nE_{1}(s,\\theta)  V_{12}(s,\\theta) \\\\\nV_{12}(s,\\theta)  E_{2}(s,\\theta)\n\\end{pmatrix},\n$$\n其模型分量（无量纲单位）如下：\n$$\nE_{1}(s,\\theta) = k\\,(s - s_{r})^{2} + b_{1}\\,(\\theta - \\pi)^{2},\n$$\n$$\nE_{2}(s,\\theta) = k\\,(s - s_{i})^{2} + b_{2}\\,(\\theta - \\pi)^{2} + \\delta,\n$$\n$$\nV_{12}(s,\\theta) = V_{0}\\,\\exp\\!\\big(-\\alpha\\,(s - s_{c})^{2}\\big)\\,\\exp\\!\\big(-\\gamma\\,(\\theta - \\pi)^{2}\\big).\n$$\n使用以下固定参数值：$k = 1.0$，$s_{r} = 3.0$，$s_{i} = 1.2$，$b_{1} = 0.10$，$b_{2} = 0.30$，$\\delta = 0.20$，$V_{0} = 0.05$，$\\alpha = 2.0$，$s_{c} = 2.0$ 和 $\\gamma = 1.0$。所有能量和耦合都采用相同的任意无量纲单位。\n\n对于每个几何构型 $(s,\\theta)$，设 $H(s,\\theta)$ 在透热基中的归一化基态本征矢量为 $|\\Psi_{0}\\rangle = c_{1}|\\phi_{1}\\rangle + c_{2}|\\phi_{2}\\rangle$，其中 $|c_{1}|^{2} + |c_{2}|^{2} = 1$。定义静态相关指数 $\\mathrm{SCI}(s,\\theta)$ 为\n$$\n\\mathrm{SCI}(s,\\theta) = 4\\,|c_{1}|^{2}\\,|c_{2}|^{2},\n$$\n其取值范围在 $[0,1]$ 内，并在完全双组态混合 $|c_{1}|^{2} = |c_{2}|^{2} = 1/2$ 时达到最大值 $1$。\n\n任务：对于下面列出的几何构型测试集，计算每种情况下 $\\mathrm{SCI}(s,\\theta)$ 的值，并四舍五入到恰好三位小数。然后，确定具有最大 $\\mathrm{SCI}$ 值的案例的从零开始的索引（如果多个案例共享相同的最大值，则选择最小的索引）。按照最终输出格式的要求，将所有 $\\mathrm{SCI}$ 值和最大值索引作为单个列表在一行中报告。角度必须以弧度处理，且所有输出均为无量纲。\n\n测试集（$(s,\\theta)$ 的有序列表）：\n- 案例 $0$：$(s=\\;3.0,\\;\\theta=\\;\\pi)$\n- 案例 $1$：$(s=\\;2.044,\\;\\theta=\\;\\pi)$\n- 案例 $2$：$(s=\\;2.044,\\;\\theta=\\;2.2)$\n- 案例 $3$：$(s=\\;1.2,\\;\\theta=\\;\\pi)$\n- 案例 $4$：$(s=\\;2.3,\\;\\theta=\\;\\pi)$\n\n最终输出格式：您的程序应生成单行输出，其中包含一个用方括号括起来的、以逗号分隔的结果列表。该列表按顺序列出五个 $\\mathrm{SCI}$ 值，后跟最大值的整数索引。例如，输出必须具有 $ [\\mathrm{SCI}_{0},\\mathrm{SCI}_{1},\\mathrm{SCI}_{2},\\mathrm{SCI}_{3},\\mathrm{SCI}_{4},i_{\\max}] $ 的形式，其中每个 $\\mathrm{SCI}_{j}$ 是一个四舍五入到恰好三位小数的浮点数，而 $i_{\\max}$ 是一个整数。",
            "solution": "我们使用一个双组态透热哈密顿量 $H(s,\\theta)$ 来模拟插入反应 $Be + H_2 \\rightarrow H\\text{-}Be\\text{-}H$，其中 $s$ 是一个无量纲反应坐标，$\\theta$ 是弯曲角（单位为弧度）。该哈密顿量为\n$$\nH(s,\\theta) = \\begin{pmatrix}\nE_{1}(s,\\theta)  V_{12}(s,\\theta) \\\\\nV_{12}(s,\\theta)  E_{2}(s,\\theta)\n\\end{pmatrix},\n$$\n其中\n$$\nE_{1}(s,\\theta) = k\\,(s - s_{r})^{2} + b_{1}\\,(\\theta - \\pi)^{2}, \\quad\nE_{2}(s,\\theta) = k\\,(s - s_{i})^{2} + b_{2}\\,(\\theta - \\pi)^{2} + \\delta,\n$$\n$$\nV_{12}(s,\\theta) = V_{0}\\,\\exp\\!\\big(-\\alpha\\,(s - s_{c})^{2}\\big)\\,\\exp\\!\\big(-\\gamma\\,(\\theta - \\pi)^{2}\\big),\n$$\n以及固定参数 $k = 1.0$，$s_{r} = 3.0$，$s_{i} = 1.2$，$b_{1} = 0.10$，$b_{2} = 0.30$，$\\delta = 0.20$，$V_{0} = 0.05$，$\\alpha = 2.0$，$s_{c} = 2.0$，$\\gamma = 1.0$。该模型捕捉了沿着插入坐标的两个主要电子组态之间近简并的基本物理原理，其耦合依赖于几何构型。\n\n为了从第一性原理识别静态相关，我们对角化实对称矩阵 $H(s,\\theta)$ 以获得本征值 $E_{-} \\le E_{+}$ 和相应的归一化本征矢量。较低（基态）的本征矢量可以在透热基中写为\n$$\n|\\Psi_{0} \\rangle = c_{1} |\\phi_{1} \\rangle + c_{2} |\\phi_{2} \\rangle,\n$$\n其中 $|c_{1}|^{2} + |c_{2}|^{2} = 1$。此处的静态（也称非动态）相关的度量是两个组态之间由近简并引起的混合程度，可由以下公式量化：\n$$\n\\mathrm{SCI}(s,\\theta) = 4\\,|c_{1}|^{2}\\,|c_{2}|^{2}.\n$$\n这直接源于双组态图像：当对角能隙 $\\Delta(s,\\theta) = E_{1}(s,\\theta) - E_{2}(s,\\theta)$ 趋近于零而 $V_{12}(s,\\theta)$ 是有限值时，基态本征矢量几乎均等地混合了透热组态，即 $|c_{1}|^{2} \\approx |c_{2}|^{2} \\approx 1/2$，从而得到 $\\mathrm{SCI} \\approx 1$，这表示强的静态相关。相反地，当 $|\\Delta(s,\\theta)| \\gg |V_{12}(s,\\theta)|$ 时，基态几乎是单个组态，因此 $|c_{1}|^{2} \\approx 1$ 或 $0$，且 $\\mathrm{SCI} \\approx 0$，这表示由动态相关主导的弱静态相关。\n\n基于这些原理的算法步骤：\n1. 对于每个 $(s,\\theta)$，使用给定的参数值计算 $E_{1}(s,\\theta)$、$E_{2}(s,\\theta)$ 和 $V_{12}(s,\\theta)$。\n2. 构建对称矩阵 $H(s,\\theta)$，并通过求解定态薛定谔方程\n$$\nH(s,\\theta)\\,\\mathbf{c} = E\\,\\mathbf{c},\n$$\n来计算其本征值和归一化本征矢量，其中 $\\mathbf{c} = (c_{1}, c_{2})^{\\top}$ 代表基态。\n3. 从基态本征矢量中提取 $|c_{1}|^{2}$ 和 $|c_{2}|^{2}$，并计算\n$$\n\\mathrm{SCI}(s,\\theta) = 4\\,|c_{1}|^{2}\\,|c_{2}|^{2}.\n$$\n4. 将每个 $\\mathrm{SCI}$ 值四舍五入到恰好三位小数。\n5. 确定最大 $\\mathrm{SCI}$ 值的从零开始的索引 $i_{\\max}$；为避免因四舍五入引起的平局问题，原则上应使用未四舍五入的值来选择最大值，然后在报告时应用指定的四舍五入规则，并在出现精确平局的情况下选择最小的索引。\n\n对所提供测试集的物理解释：\n- 在 $(s=\\;3.0,\\theta=\\;\\pi)$ 和 $(s=\\;1.2,\\theta=\\;\\pi)$ 处，一个透热势能面远低于另一个（相对于 $|V_{12}|$ 而言， $|\\Delta|$ 较大），因此 $|c_{1}|^{2}$ 或 $|c_{2}|^{2}$ 接近 $1$，得到 $\\mathrm{SCI} \\approx 0$，这对应于弱静态相关。\n- 在 $(s \\approx 2.044,\\theta=\\;\\pi)$ 附近，透热势能面近简并（$\\Delta \\approx 0$），且耦合相当可观，导致几乎相等的组态混合，因此 $\\mathrm{SCI} \\approx 1$，这标识出势能面上静态相关最强的区域。\n- $s$ 或 $\\theta$ 与该区域的微小偏差会增加 $|\\Delta|$ 并减小 $|V_{12}|$，从而减少混合，降低 $\\mathrm{SCI}$ 值。\n\n该程序实现了这些步骤，以计算并按所要求的单行格式报告列表 $[\\mathrm{SCI}_{0},\\mathrm{SCI}_{1},\\mathrm{SCI}_{2},\\mathrm{SCI}_{3},\\mathrm{SCI}_{4},i_{\\max}]$，其中角度以弧度为单位，所有输出均为无量纲单位。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef hamiltonian(s, theta):\n    # Parameters (dimensionless)\n    k = 1.0\n    s_r = 3.0\n    s_i = 1.2\n    b1 = 0.10\n    b2 = 0.30\n    delta = 0.20\n    V0 = 0.05\n    alpha = 2.0\n    s_c = 2.0\n    gamma = 1.0\n\n    E1 = k * (s - s_r) ** 2 + b1 * (theta - np.pi) ** 2\n    E2 = k * (s - s_i) ** 2 + b2 * (theta - np.pi) ** 2 + delta\n    V12 = V0 * np.exp(-alpha * (s - s_c) ** 2) * np.exp(-gamma * (theta - np.pi) ** 2)\n\n    H = np.array([[E1, V12],\n                  [V12, E2]], dtype=float)\n    return H\n\ndef static_correlation_index(s, theta):\n    H = hamiltonian(s, theta)\n    # Diagonalize symmetric 2x2 Hamiltonian\n    evals, evecs = np.linalg.eigh(H)\n    # Ground state eigenvector is column corresponding to smallest eigenvalue\n    idx_min = np.argmin(evals)\n    vec = evecs[:, idx_min]\n    # Normalize defensively (should already be normalized by eigh)\n    vec = vec / np.linalg.norm(vec)\n    p1 = float(vec[0] ** 2)  # |c1|^2\n    p2 = 1.0 - p1            # |c2|^2\n    sci = 4.0 * p1 * p2\n    return sci\n\ndef solve():\n    # Define the test cases from the problem statement: (s, theta) with theta in radians.\n    test_cases = [\n        (3.0, np.pi),     # Case 0\n        (2.044, np.pi),   # Case 1\n        (2.044, 2.2),     # Case 2\n        (1.2, np.pi),     # Case 3\n        (2.3, np.pi),     # Case 4\n    ]\n\n    sci_values = []\n    for (s, theta) in test_cases:\n        sci = static_correlation_index(s, theta)\n        sci_values.append(sci)\n\n    # Determine index of maximum SCI using unrounded values; tie broken by first occurrence.\n    imax = int(np.argmax(sci_values))\n\n    # Round SCI values to exactly three decimals for output.\n    sci_strings = [f\"{v:.3f}\" for v in sci_values]\n\n    # Build final output list: five SCI values followed by the integer index.\n    output_items = sci_strings + [str(imax)]\n    print(f\"[{','.join(output_items)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        },
        {
            "introduction": "理解了静态相关的来源和影响后，一个计算化学家面临的实际问题是：如何在一个真实的计算任务中判断静态相关是否显著？本练习将向你介绍一个在耦合簇（Coupled Cluster）理论中广泛使用的实用工具——$T_1$诊断。通过实现一个简化的$T_1$诊断计算，你将学会如何评估单参考波函数的可靠性，并识别出那些需要更高级的多参考方法来准确描述的体系。",
            "id": "2454438",
            "problem": "给定一个简化的、第一性原理定义的耦合簇单激发诊断（T1诊断），用于评估取代有机双自由基中静态（非动态）电子相关的起始。考虑一个固定的、非正则的正交归一轨道基，其中占据和虚拟子空间之间的非对角Fock矩阵元不必为零。对于每个体系，设单激发的集合由占据指数 $i$ 和虚拟指数 $a$ 索引。近似的单激发振幅由下式给出：\n$$\nt_i^a \\approx \\frac{F_{ai}}{\\varepsilon_a - \\varepsilon_i},\n$$\n其中 $F_{ai}$ 是以哈特里（hartree）为单位的非对角Fock矩阵元，$\\varepsilon_p$ 是以哈特里为单位的轨道能。将T1诊断定义为：\n$$\nT_1 \\equiv \\frac{\\left(\\sum_{i,a} \\left(t_i^a\\right)^2\\right)^{1/2}}{\\sqrt{n_{\\text{occ}}}},\n$$\n其中 $n_{\\text{occ}}$ 是占据的自spin轨道数。在开壳层双自由基的背景下，使用常规的启发式阈值：\n$$\n\\tau = 0.04,\n$$\n并且当且仅当 $T_1 \\ge \\tau$ 时，宣告预测静态相关的出现。诊断值 $T_1$ 是无量纲的。\n\n您的任务是实现一个程序，对每个测试用例，使用上述公式计算 $T_1$，并根据所述准则判断是否预测会出现静态相关。所有轨道能和Fock矩阵元都必须以哈特里为单位处理。每个测试用例的最终输出必须包含四舍五入到五位小数的 $T_1$ 值（无量纲）以及相关的静态相关出现与否的布尔决策。\n\n测试组（每个测试用例指定了 $n_{\\text{occ}}$、一个 $F_{ai}$ 值列表以及一个相应的能隙 $\\Delta_{ia} = \\varepsilon_a - \\varepsilon_i$ 列表；所有能量单位均为哈特里，且所有能隙满足 $\\Delta_{ia} > 0$）：\n\n- 案例 A（中等耦合，较大能隙）：$n_{\\text{occ}} = 5$， $F_{ai} = [0.02, 0.015, 0.01]$， $\\Delta_{ia} = [0.5, 0.6, 0.8]$。\n- 案例 B（接近阈值的边界情况）：$n_{\\text{occ}} = 2$， $F_{ai} = [0.01, 0.01]$， $\\Delta_{ia} = [0.25, 0.25]$。\n- 案例 C（小能隙和强耦合）：$n_{\\text{occ}} = 6$， $F_{ai} = [0.03, 0.025, 0.02, 0.02]$， $\\Delta_{ia} = [0.15, 0.2, 0.2, 0.25]$。\n- 案例 D（无耦合）：$n_{\\text{occ}} = 4$， $F_{ai} = [0.0, 0.0]$， $\\Delta_{ia} = [0.3, 0.4]$。\n- 案例 E（单个近简并激发）：$n_{\\text{occ}} = 4$， $F_{ai} = [0.005]$， $\\Delta_{ia} = [0.05]$。\n\n要求：\n\n- 对于每个提供的配对，使用 $t_i^a = F_{ai}/\\Delta_{ia}$ 计算 $t_i^a$，然后为每个案例计算如上定义的 $T_1$。\n- 对于每个案例，将 $T_1$ 与 $\\tau = 0.04$ 进行比较，并根据准则 $T_1 \\ge \\tau$ 判断是否预测静态相关的出现。\n- 最终程序输出必须是包含一个由方括号括起来的逗号分隔列表的单行。该列表必须按A到E的顺序包含每个案例的圆整后的 $T_1$ 值（作为四舍五入到五位小数的浮点数），紧随其后的是布尔决策（使用标记 True 或 False）。例如，输出格式必须是\n`[T1_A,onset_A,T1_B,onset_B,T1_C,onset_C,T1_D,onset_D,T1_E,onset_E]`。",
            "solution": "问题陈述已通过验证并被视为有效。它在科学上是合理的，在算术上是适定的，并为得出唯一且可验证的解提供了所有必要的数据。该问题需要计算耦合簇T1诊断值，这是量子化学中评估静态电子相关重要性的一个标准度量。\n\n控制方程如下。单激发振幅 $t_i^a$ 衡量了参考行列式与单激发行列式之间的混合程度，由一阶微扰理论近似得出：\n$$\nt_i^a \\approx \\frac{F_{ai}}{\\varepsilon_a - \\varepsilon_i} = \\frac{F_{ai}}{\\Delta_{ia}}\n$$\n此处，$F_{ai}$ 代表占据自旋轨道 $i$ 和虚拟自旋轨道 $a$ 之间的Fock矩阵非对角元，而 $\\Delta_{ia} = \\varepsilon_a - \\varepsilon_i$ 是相应的轨道能差。所有量均以原子单位（哈特里）表示。\n\nT1诊断定义为单激发振幅向量的范数，通过占据轨道数 $n_{\\text{occ}}$ 的平方根进行归一化：\n$$\nT_1 \\equiv \\frac{\\left(\\sum_{i,a} \\left(t_i^a\\right)^2\\right)^{1/2}}{\\sqrt{n_{\\text{occ}}}}\n$$\n此表达式等价于 $T_1 = ||\\mathbf{t}||_2 / \\sqrt{n_{\\text{occ}}}$，其中 $||\\mathbf{t}||_2$ 是振幅向量 $\\mathbf{t} = (t_1, t_2, \\ldots)$ 的欧几里得范数。\n\n如果诊断值超过预定义的阈值 $\\tau$，则判定静态相关是显著的。问题指定了一个对于开壳层双自由基而言的常规阈值：\n$$\n\\tau = 0.04\n$$\n因此，静态相关出现的条件是 $T_1 \\ge \\tau$。\n\n我们对每个测试用例进行计算。\n\n案例 A:\n给定：$n_{\\text{occ}} = 5$, $F_{ai} = [0.02, 0.015, 0.01]$, $\\Delta_{ia} = [0.5, 0.6, 0.8]$。\n振幅计算如下：\n$t_1 = 0.02 / 0.5 = 0.04$\n$t_2 = 0.015 / 0.6 = 0.025$\n$t_3 = 0.01 / 0.8 = 0.0125$\n振幅平方和为 $\\sum_{i,a} (t_i^a)^2 = (0.04)^2 + (0.025)^2 + (0.0125)^2 = 0.0016 + 0.000625 + 0.00015625 = 0.00238125$。\nT1诊断值为：\n$$\nT_1 = \\frac{\\sqrt{0.00238125}}{\\sqrt{5}} \\approx \\frac{0.04880}{2.23607} \\approx 0.02182\n$$\n由于 $0.02182  0.04$，未预测到静态相关的出现。结果：$(0.02182, \\text{False})$。\n\n案例 B:\n给定：$n_{\\text{occ}} = 2$, $F_{ai} = [0.01, 0.01]$, $\\Delta_{ia} = [0.25, 0.25]$。\n振幅为：\n$t_1 = 0.01 / 0.25 = 0.04$\n$t_2 = 0.01 / 0.25 = 0.04$\n振幅平方和为 $\\sum_{i,a} (t_i^a)^2 = (0.04)^2 + (0.04)^2 = 0.0016 + 0.0016 = 0.0032$。\nT1诊断值为：\n$$\nT_1 = \\frac{\\sqrt{0.0032}}{\\sqrt{2}} = \\sqrt{\\frac{0.0032}{2}} = \\sqrt{0.0016} = 0.04\n$$\n由于 $0.04 \\ge 0.04$，预测到静态相关的出现。结果：$(0.04000, \\text{True})$。\n\n案例 C:\n给定：$n_{\\text{occ}} = 6$, $F_{ai} = [0.03, 0.025, 0.02, 0.02]$, $\\Delta_{ia} = [0.15, 0.2, 0.2, 0.25]$。\n振幅为：\n$t_1 = 0.03 / 0.15 = 0.2$\n$t_2 = 0.025 / 0.2 = 0.125$\n$t_3 = 0.02 / 0.2 = 0.1$\n$t_4 = 0.02 / 0.25 = 0.08$\n振幅平方和为 $\\sum_{i,a} (t_i^a)^2 = (0.2)^2 + (0.125)^2 + (0.1)^2 + (0.08)^2 = 0.04 + 0.015625 + 0.01 + 0.0064 = 0.072025$。\nT1诊断值为：\n$$\nT_1 = \\frac{\\sqrt{0.072025}}{\\sqrt{6}} = \\frac{0.268375}{2.44949} \\approx 0.10956\n$$\n由于 $0.10956 \\ge 0.04$，预测到静态相关的出现。结果：$(0.10956, \\text{True})$。\n\n案例 D:\n给定：$n_{\\text{occ}} = 4$, $F_{ai} = [0.0, 0.0]$, $\\Delta_{ia} = [0.3, 0.4]$。\n非对角Fock矩阵元为零，所以所有振幅均为零：$t_i^a = 0$。\n因此，振幅平方和为 $\\sum_{i,a} (t_i^a)^2 = 0$。\nT1诊断值为：\n$$\nT_1 = \\frac{\\sqrt{0}}{\\sqrt{4}} = 0.0\n$$\n由于 $0.0  0.04$，未预测到静态相关的出现。结果：$(0.00000, \\text{False})$。\n\n案例 E:\n给定：$n_{\\text{occ}} = 4$, $F_{ai} = [0.005]$, $\\Delta_{ia} = [0.05]$。\n存在一个显著的激发。振幅为：\n$t_1 = 0.005 / 0.05 = 0.1$\n振幅平方和为 $\\sum_{i,a} (t_i^a)^2 = (0.1)^2 = 0.01$。\nT1诊断值为：\n$$\nT_1 = \\frac{\\sqrt{0.01}}{\\sqrt{4}} = \\frac{0.1}{2.0} = 0.05\n$$\n由于 $0.05 \\ge 0.04$，预测到静态相关的出现。结果：$(0.05000, \\text{True})$。\n\n计算现已完成，将按要求以编程方式实现。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the T1 diagnostic for several test cases and determines\n    if static correlation onset is predicted.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {'id': 'A', 'n_occ': 5, 'F_ai': [0.02, 0.015, 0.01], 'Delta_ia': [0.5, 0.6, 0.8]},\n        {'id': 'B', 'n_occ': 2, 'F_ai': [0.01, 0.01], 'Delta_ia': [0.25, 0.25]},\n        {'id': 'C', 'n_occ': 6, 'F_ai': [0.03, 0.025, 0.02, 0.02], 'Delta_ia': [0.15, 0.2, 0.2, 0.25]},\n        {'id': 'D', 'n_occ': 4, 'F_ai': [0.0, 0.0], 'Delta_ia': [0.3, 0.4]},\n        {'id': 'E', 'n_occ': 4, 'F_ai': [0.005], 'Delta_ia': [0.05]},\n    ]\n    \n    # Heuristic threshold for static correlation onset\n    tau = 0.04\n    \n    results = []\n    \n    for case in test_cases:\n        n_occ = case['n_occ']\n        # Convert lists to numpy arrays for vectorized operations\n        F_ai = np.array(case['F_ai'])\n        Delta_ia = np.array(case['Delta_ia'])\n        \n        # Calculate the single-excitation amplitudes t_i^a\n        # Handle the case where Delta_ia might contain zeros to avoid division by zero,\n        # although the problem statement guarantees Delta_ia  0.\n        # Adding a small epsilon or specific check is good practice but not strictly\n        # necessary given the problem constraints.\n        t_ia = F_ai / Delta_ia\n        \n        # Calculate the sum of squares of the amplitudes\n        sum_sq_t = np.sum(t_ia**2)\n        \n        # Calculate the T1 diagnostic\n        # Denominator will not be zero as n_occ is always a positive integer.\n        T1 = np.sqrt(sum_sq_t) / np.sqrt(n_occ)\n        \n        # Compare with the threshold to get the boolean decision\n        onset_predicted = T1 = tau\n        \n        # Append the formatted results, rounded to five decimal places\n        results.append(f\"{T1:.5f}\")\n        results.append(str(onset_predicted))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}