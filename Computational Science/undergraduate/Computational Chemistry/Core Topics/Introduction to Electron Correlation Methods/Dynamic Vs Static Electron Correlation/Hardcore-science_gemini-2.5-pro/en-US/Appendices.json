{
    "hands_on_practices": [
        {
            "introduction": "To truly grasp static correlation, we must go to its conceptual heart: the competition between electron delocalization and repulsion. This practice uses the two-site Hubbard model, a cornerstone of theoretical chemistry, to explore how this balance gives rise to \"diradical character.\" You will implement this model from first principles and compute the diradical index from natural orbital occupations, the most rigorous measure of static correlation in such systems. ",
            "id": "2454423",
            "problem": "Consider probing the diradical character of the transition state in a $[2+2]$ cycloaddition reaction using a minimal, first-principles, two-site, two-electron model that captures the competition between electron delocalization and on-site repulsion, which governs the balance between dynamic and static electron correlation. Model the two interacting frontier orbitals of the transition state by a two-site, two-electron Hubbard-type Hamiltonian in second quantization,\n$$\n\\hat{H} \\;=\\; -\\,t \\sum_{\\sigma \\in \\{\\uparrow,\\downarrow\\}} \\left( \\hat{c}_{1\\sigma}^{\\dagger}\\hat{c}_{2\\sigma} + \\hat{c}_{2\\sigma}^{\\dagger}\\hat{c}_{1\\sigma} \\right) \\;+\\; U \\sum_{i=1}^{2} \\hat{n}_{i\\uparrow}\\hat{n}_{i\\downarrow} \\;+\\; \\Delta \\left[ \\left(\\hat{n}_{1\\uparrow}+\\hat{n}_{1\\downarrow}\\right) - \\left(\\hat{n}_{2\\uparrow}+\\hat{n}_{2\\downarrow}\\right) \\right],\n$$\nwhere $t$ is the hopping parameter, $U$ is the on-site electron repulsion, and $\\Delta$ is the site-energy asymmetry that differentiates the two frontier sites. The fermionic creation and annihilation operators $\\hat{c}_{i\\sigma}^{\\dagger}$ and $\\hat{c}_{i\\sigma}$ act on site $i \\in \\{1,2\\}$ and spin $\\sigma \\in \\{\\uparrow,\\downarrow\\}$, with the number operators $\\hat{n}_{i\\sigma}=\\hat{c}_{i\\sigma}^{\\dagger}\\hat{c}_{i\\sigma}$. Work in the sector with exactly $N=2$ electrons. Let the normalized ground state be $\\lvert \\Psi_0 \\rangle$, defined as the lowest-energy normalized eigenvector of $\\hat{H}$ in the $N=2$ sector.\n\nDefine the spin-summed one-particle reduced density matrix (1-RDM) in the spatial site basis by\n$$\n\\gamma_{ij} \\;=\\; \\sum_{\\sigma \\in \\{\\uparrow,\\downarrow\\}} \\langle \\Psi_0 \\lvert \\hat{c}_{i\\sigma}^{\\dagger}\\hat{c}_{j\\sigma} \\rvert \\Psi_0 \\rangle, \\quad i,j \\in \\{1,2\\}.\n$$\nLet the natural orbital occupation numbers be the eigenvalues of the $2\\times 2$ matrix $\\boldsymbol{\\gamma}$, ordered as $n_1 \\ge n_2$, which satisfy $n_1+n_2=2$. Define the diradical index $y$ by\n$$\ny \\;=\\; 1 \\;-\\; \\tfrac{1}{2}\\Big( \\lvert n_1 - 1 \\rvert \\;+\\; \\lvert n_2 - 1 \\rvert \\Big).\n$$\nThis index satisfies $y \\approx 0$ for a closed-shell state dominated by dynamic electron correlation (with $n_1 \\approx 2$ and $n_2 \\approx 0$) and $y \\approx 1$ for a diradical (open-shell singlet) characterized by strong static electron correlation (with $n_1 \\approx 1$ and $n_2 \\approx 1$).\n\nTask: For each parameter triple $(t,U,\\Delta)$ in the test suite below, compute the corresponding diradical index $y$ as defined above. All parameters are dimensionless. Your program should produce a single line of output containing the results as a comma-separated list of decimal numbers enclosed in square brackets, in the same order as the test suite.\n\nTest suite:\n- Case $1$: $(t,U,\\Delta) = (\\,1.0,\\,0.2,\\,0.0\\,)$.\n- Case $2$: $(t,U,\\Delta) = (\\,1.0,\\,8.0,\\,0.0\\,)$.\n- Case $3$: $(t,U,\\Delta) = (\\,1.0,\\,2.0,\\,0.0\\,)$.\n- Case $4$: $(t,U,\\Delta) = (\\,1.0,\\,4.0,\\,0.5\\,)$.\n- Case $5$: $(t,U,\\Delta) = (\\,0.0,\\,4.0,\\,0.0\\,)$.\n\nFinal output format: a single line with\n$$\n[ y_1, y_2, y_3, y_4, y_5 ]\n$$\nwhere $y_k$ is the diradical index for Case $k$, expressed as a decimal number. No additional text or formatting is permitted in the output line.",
            "solution": "The physical system is represented by a minimal two-site, two-electron Hamiltonian that captures the essential competition between kinetic delocalization and on-site repulsion in a transition state’s pair of frontier orbitals. The Hamiltonian,\n$$\n\\hat{H} \\;=\\; -\\,t \\sum_{\\sigma} \\left( \\hat{c}_{1\\sigma}^{\\dagger}\\hat{c}_{2\\sigma} + \\hat{c}_{2\\sigma}^{\\dagger}\\hat{c}_{1\\sigma} \\right) \\;+\\; U \\sum_{i=1}^{2} \\hat{n}_{i\\uparrow}\\hat{n}_{i\\downarrow} \\;+\\; \\Delta \\left[ \\left(\\hat{n}_{1\\uparrow}+\\hat{n}_{1\\downarrow}\\right) - \\left(\\hat{n}_{2\\uparrow}+\\hat{n}_{2\\downarrow}\\right) \\right],\n$$\nbalances the hopping parameter $t$, which favors delocalization and closed-shell character, with the interaction parameter $U$, which penalizes double occupancy and favors localization and static correlation. The site-energy asymmetry $\\Delta$ biases the electron density toward one site, diminishing diradical character when large relative to $t$.\n\nWe work in the $N=2$ electron sector on a Hilbert space built from four spin-orbitals: $\\{(1\\uparrow),(1\\downarrow),(2\\uparrow),(2\\downarrow)\\}$. The number of Slater determinants is $\\binom{4}{2}=6$. The exact approach proceeds from first principles:\n\n1. Represent the many-electron basis states $\\{\\lvert \\Phi_a \\rangle\\}_{a=1}^{6}$ as occupation-number vectors of the four spin-orbitals. The fermionic operators obey canonical anticommutation relations, ensuring correct phase factors. Construct the Hamiltonian matrix $H_{ab}=\\langle \\Phi_a \\lvert \\hat{H} \\rvert \\Phi_b \\rangle$ by applying $\\hat{H}$ term-by-term:\n   - The interaction term contributes $U$ to the diagonal element when both spins are occupied on the same site, i.e., when $\\hat{n}_{i\\uparrow}\\hat{n}_{i\\downarrow}=1$.\n   - The site-energy term contributes $\\Delta$ times the difference in total occupation between site $1$ and site $2$.\n   - The hopping terms connect determinants that differ by moving a single electron of spin $\\sigma$ between sites $1$ and $2$, with amplitude $-t$ and a fermionic sign determined by the parity of occupied spin-orbitals between the annihilated and created modes.\n\n2. Diagonalize the Hermitian matrix $\\mathbf{H}$ to obtain the lowest eigenvalue and its normalized eigenvector. The lowest-energy normalized eigenvector defines the ground state $\\lvert \\Psi_0 \\rangle$.\n\n3. Compute the spin-summed one-particle reduced density matrix (1-RDM) in the spatial site basis,\n   $$\n   \\gamma_{ij} \\;=\\; \\sum_{\\sigma \\in \\{\\uparrow,\\downarrow\\}} \\langle \\Psi_0 \\lvert \\hat{c}_{i\\sigma}^{\\dagger}\\hat{c}_{j\\sigma} \\rvert \\Psi_0 \\rangle,\\quad i,j\\in\\{1,2\\}.\n   $$\n   This requires constructing, for each pair $(i,j)$ and spin $\\sigma$, the operator matrix with elements $O^{(i,j,\\sigma)}_{ab}=\\langle \\Phi_a \\lvert \\hat{c}_{i\\sigma}^{\\dagger}\\hat{c}_{j\\sigma} \\rvert \\Phi_b \\rangle$ in the $N=2$ basis. The matrix elements are obtained by sequentially applying annihilation and creation operators to $\\lvert \\Phi_b \\rangle$, tracking fermionic signs:\n   - Apply $\\hat{c}_{j\\sigma}$ to remove an electron from $(j,\\sigma)$ if present, with sign $(-1)^{\\nu_j}$ where $\\nu_j$ is the number of occupied spin-orbitals preceding $(j,\\sigma)$ in a fixed ordering.\n   - Apply $\\hat{c}_{i\\sigma}^{\\dagger}$ to add an electron to $(i,\\sigma)$ if absent, with sign $(-1)^{\\nu_i'}$ where $\\nu_i'$ counts occupied orbitals preceding $(i,\\sigma)$ in the intermediate state.\n   The product of these signs gives the matrix element amplitude. Summing over spin yields $\\gamma_{ij}$.\n\n4. The natural orbital occupation numbers $\\{n_1,n_2\\}$ are the eigenvalues of the $2\\times 2$ matrix $\\boldsymbol{\\gamma}$, ordered so that $n_1 \\ge n_2$. Particle number conservation ensures $n_1+n_2=2$.\n\n5. Define the diradical index\n   $$\n   y \\;=\\; 1 \\;-\\; \\tfrac{1}{2}\\left(\\lvert n_1-1\\rvert+\\lvert n_2-1\\rvert\\right),\n   $$\n   which maps a closed-shell configuration $\\{n_1,n_2\\}=\\{2,0\\}$ to $y=0$ and a perfect diradical $\\{n_1,n_2\\}=\\{1,1\\}$ to $y=1$. Values $y$ near $0$ indicate predominately dynamic correlation, while values near $1$ indicate significant static (multireference) correlation typical of diradical character.\n\nApplying this procedure to the test suite:\n- Case $1$ with $(t,U,\\Delta)=(1.0,0.2,0.0)$ has weak interaction relative to hopping, favoring a closed-shell ground state with $n_1 \\approx 2$ and $n_2 \\approx 0$, hence $y$ close to $0$.\n- Case $2$ with $(1.0,8.0,0.0)$ has strong interaction that suppresses double occupancy, yielding $n_1 \\approx 1$ and $n_2 \\approx 1$, hence $y$ close to $1$.\n- Case $3$ with $(1.0,2.0,0.0)$ lies between these extremes, giving intermediate $y$.\n- Case $4$ with $(1.0,4.0,0.5)$ adds site asymmetry that localizes electrons unevenly, reducing the diradical character compared with the symmetric case at similar $U/t$.\n- Case $5$ with $(0.0,4.0,0.0)$ eliminates hopping; the lowest-energy state avoids double occupancy and places one electron on each site, resulting in $n_1=n_2=1$ and $y=1$ exactly.\n\nThe program constructs $\\mathbf{H}$ and the relevant one-body operators from first principles, obtains $\\lvert \\Psi_0 \\rangle$, computes $\\boldsymbol{\\gamma}$, extracts $\\{n_1,n_2\\}$, evaluates $y$ for each case, and prints the list $[y_1,y_2,y_3,y_4,y_5]$ as required.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# Indices for spin-orbitals: 0: 1↑, 1: 1↓, 2: 2↑, 3: 2↓\nUP = 0\nDOWN = 1\nsite_spin_to_index = {\n    (1, 'up'): 0,\n    (1, 'down'): 1,\n    (2, 'up'): 2,\n    (2, 'down'): 3,\n}\n\ndef popcount_below(state: int, idx: int) -> int:\n    \"\"\"Count number of occupied spin-orbitals with indices < idx.\"\"\"\n    if idx <= 0:\n        return 0\n    mask = (1 << idx) - 1\n    return int(bin(state & mask).count(\"1\"))\n\ndef is_occupied(state: int, idx: int) -> bool:\n    return (state >> idx) & 1 == 1\n\ndef apply_annihilation(state: int, idx: int):\n    \"\"\"Apply c_idx to state. Return (sign, new_state) or (0, None) if not applicable.\"\"\"\n    if not is_occupied(state, idx):\n        return 0.0, None\n    sign = -1.0 if (popcount_below(state, idx) % 2 == 1) else 1.0\n    new_state = state & ~(1 << idx)\n    return sign, new_state\n\ndef apply_creation(state: int, idx: int):\n    \"\"\"Apply c_idx^\\dagger to state. Return (sign, new_state) or (0, None) if not applicable.\"\"\"\n    if is_occupied(state, idx):\n        return 0.0, None\n    sign = -1.0 if (popcount_below(state, idx) % 2 == 1) else 1.0\n    new_state = state | (1 << idx)\n    return sign, new_state\n\ndef generate_basis_Ne(ne=2):\n    \"\"\"Generate basis states (as integers) with exactly ne electrons among 4 spin-orbitals.\"\"\"\n    basis = []\n    for s in range(1 << 4):\n        if bin(s).count(\"1\") == ne:\n            basis.append(s)\n    return basis\n\ndef diagonal_energy_terms(state: int, U: float, Delta: float) -> float:\n    \"\"\"Compute diagonal contributions from U and Delta for a given basis state.\"\"\"\n    n1_up = 1 if is_occupied(state, site_spin_to_index[(1, 'up')]) else 0\n    n1_dn = 1 if is_occupied(state, site_spin_to_index[(1, 'down')]) else 0\n    n2_up = 1 if is_occupied(state, site_spin_to_index[(2, 'up')]) else 0\n    n2_dn = 1 if is_occupied(state, site_spin_to_index[(2, 'down')]) else 0\n    # U term: on-site double occupancy\n    E_U = U * ((n1_up * n1_dn) + (n2_up * n2_dn))\n    # Delta term: site-energy asymmetry\n    E_D = Delta * ((n1_up + n1_dn) - (n2_up + n2_dn))\n    return E_U + E_D\n\ndef build_hamiltonian(t: float, U: float, Delta: float, basis, index_of):\n    \"\"\"Construct the 6x6 Hamiltonian matrix in the N=2 sector.\"\"\"\n    dim = len(basis)\n    H = np.zeros((dim, dim), dtype=float)\n    # Diagonal terms\n    for a, state in enumerate(basis):\n        H[a, a] += diagonal_energy_terms(state, U, Delta)\n    # Hopping terms: -t * sum_sigma (c1σ† c2σ + c2σ† c1σ)\n    for a, state in enumerate(basis):\n        for spin in ('up', 'down'):\n            i1 = site_spin_to_index[(1, spin)]\n            i2 = site_spin_to_index[(2, spin)]\n            # c1† c2\n            sgn1, s1 = apply_annihilation(state, i2)\n            if s1 is not None:\n                sgn2, s2 = apply_creation(s1, i1)\n                if s2 is not None:\n                    b = index_of[s2]\n                    H[b, a] += -t * (sgn1 * sgn2)\n            # c2† c1\n            sgn1, s1 = apply_annihilation(state, i1)\n            if s1 is not None:\n                sgn2, s2 = apply_creation(s1, i2)\n                if s2 is not None:\n                    b = index_of[s2]\n                    H[b, a] += -t * (sgn1 * sgn2)\n    return H\n\ndef build_one_body_operator(i_site: int, j_site: int, spin: str, basis, index_of):\n    \"\"\"Build the operator matrix for c_{i_site,spin}^\\dagger c_{j_site,spin} in N=2 basis.\"\"\"\n    dim = len(basis)\n    O = np.zeros((dim, dim), dtype=float)\n    p = site_spin_to_index[(i_site, spin)]\n    q = site_spin_to_index[(j_site, spin)]\n    for b_idx, state in enumerate(basis):\n        sgn_a, s1 = apply_annihilation(state, q)\n        if s1 is None:\n            continue\n        sgn_c, s2 = apply_creation(s1, p)\n        if s2 is None:\n            continue\n        a_idx = index_of[s2]\n        O[a_idx, b_idx] += sgn_a * sgn_c\n    return O\n\ndef compute_gamma(Psi: np.ndarray, basis, index_of):\n    \"\"\"Compute the 2x2 spin-summed 1-RDM gamma_{ij} in the spatial site basis.\"\"\"\n    # Build operator matrices for each (i,j,spin)\n    # gamma_{ij} = sum_sigma <Psi| c_{iσ}^\\dagger c_{jσ} |Psi>\n    gam = np.zeros((2, 2), dtype=float)\n    for i_site in (1, 2):\n        for j_site in (1, 2):\n            val = 0.0\n            for spin in ('up', 'down'):\n                O = build_one_body_operator(i_site, j_site, spin, basis, index_of)\n                val += float(np.vdot(Psi, O @ Psi).real)\n            gam[i_site - 1, j_site - 1] = val\n    return gam\n\ndef diradical_index_from_gamma(gamma: np.ndarray) -> float:\n    \"\"\"Compute diradical index y from 2x2 gamma.\"\"\"\n    evals = np.linalg.eigvalsh(gamma)\n    # Sort descending\n    evals = np.sort(evals)[::-1]\n    n1, n2 = float(evals[0]), float(evals[1])\n    y = 1.0 - 0.5 * (abs(n1 - 1.0) + abs(n2 - 1.0))\n    return y\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Cases: (t, U, Delta)\n    test_cases = [\n        (1.0, 0.2, 0.0),  # dynamic correlation dominated\n        (1.0, 8.0, 0.0),  # strong static correlation\n        (1.0, 2.0, 0.0),  # intermediate\n        (1.0, 4.0, 0.5),  # asymmetry reduces diradical character\n        (0.0, 4.0, 0.0),  # no hopping: perfect diradical\n    ]\n\n    # Prepare basis and mapping once (N=2 sector)\n    basis = generate_basis_Ne(ne=2)\n    index_of = {s: i for i, s in enumerate(basis)}\n\n    results = []\n    for t, U, Delta in test_cases:\n        H = build_hamiltonian(t, U, Delta, basis, index_of)\n        # Diagonalize\n        evals, evecs = np.linalg.eigh(H)\n        Psi0 = evecs[:, 0]  # ground state eigenvector\n        gamma = compute_gamma(Psi0, basis, index_of)\n        y = diradical_index_from_gamma(gamma)\n        results.append(y)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        },
        {
            "introduction": "Static correlation is not a fixed property but is highly dependent on molecular geometry, often peaking at the transition states of chemical reactions where bonds are partially broken and formed. In this exercise, we will model the classic insertion reaction of a beryllium atom into a hydrogen molecule, $Be + \\text{H}_2 \\rightarrow \\text{H-Be-H}$. By diagonalizing a simple two-state Hamiltonian, you will compute a static correlation index across the potential energy surface and identify the region where the electronic structure is most strongly multiconfigurational. ",
            "id": "2454410",
            "problem": "Consider a simplified two-configuration quantum model for the insertion reaction $Be + \\text{H}_2 \\rightarrow \\text{H-Be-H}$. Let the geometry be parameterized by a one-dimensional reaction coordinate $s$ (dimensionless) and the bending angle $\\theta$ (in radians). In a diabatic basis of two dominant electronic configurations, the electronic Hamiltonian is represented by the symmetric $2 \\times 2$ matrix\n$$\nH(s,\\theta) = \\begin{pmatrix}\nE_{1}(s,\\theta) & V_{12}(s,\\theta) \\\\\nV_{12}(s,\\theta) & E_{2}(s,\\theta)\n\\end{pmatrix},\n$$\nwith the following model components in dimensionless units:\n$$\nE_{1}(s,\\theta) = k\\,(s - s_{r})^{2} + b_{1}\\,(\\theta - \\pi)^{2},\n$$\n$$\nE_{2}(s,\\theta) = k\\,(s - s_{i})^{2} + b_{2}\\,(\\theta - \\pi)^{2} + \\delta,\n$$\n$$\nV_{12}(s,\\theta) = V_{0}\\,\\exp\\!\\big(-\\alpha\\,(s - s_{c})^{2}\\big)\\,\\exp\\!\\big(-\\gamma\\,(\\theta - \\pi)^{2}\\big).\n$$\nUse the fixed parameter values $k = 1.0$, $s_{r} = 3.0$, $s_{i} = 1.2$, $b_{1} = 0.10$, $b_{2} = 0.30$, $\\delta = 0.20$, $V_{0} = 0.05$, $\\alpha = 2.0$, $s_{c} = 2.0$, and $\\gamma = 1.0$. All energies and couplings are in the same arbitrary, dimensionless unit.\n\nFor each geometry $(s,\\theta)$, let the normalized ground-state eigenvector of $H(s,\\theta)$ in the diabatic basis be $\\lvert \\Psi_{0}\\rangle = c_{1}\\lvert \\phi_{1}\\rangle + c_{2}\\lvert \\phi_{2}\\rangle$ with $|c_{1}|^{2} + |c_{2}|^{2} = 1$. Define the static correlation index $\\mathrm{SCI}(s,\\theta)$ by\n$$\n\\mathrm{SCI}(s,\\theta) = 4\\,|c_{1}|^{2}\\,|c_{2}|^{2},\n$$\nwhich takes values in $[0,1]$ and attains its maximum $1$ at perfect two-configuration mixing $|c_{1}|^{2} = |c_{2}|^{2} = 1/2$.\n\nTask: For the test suite of geometries listed below, compute $\\mathrm{SCI}(s,\\theta)$ for each case, rounded to exactly three decimal places. Then determine the zero-based index of the case with the largest $\\mathrm{SCI}$ (if multiple cases share the same maximum, choose the smallest index). Report all $\\mathrm{SCI}$ values and the index of the maximum as a single list on one line as specified in the final output format. Angles must be treated in radians, and all outputs are dimensionless.\n\nTest suite (ordered list of $(s,\\theta)$):\n- Case $0$: $(s=\\;3.0,\\;\\theta=\\;\\pi)$\n- Case $1$: $(s=\\;2.044,\\;\\theta=\\;\\pi)$\n- Case $2$: $(s=\\;2.044,\\;\\theta=\\;2.2)$\n- Case $3$: $(s=\\;1.2,\\;\\theta=\\;\\pi)$\n- Case $4$: $(s=\\;2.3,\\;\\theta=\\;\\pi)$\n\nFinal output format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with the five $\\mathrm{SCI}$ values in order followed by the integer index of the maximum. For example, the output must have the form $[\\mathrm{SCI}_{0},\\mathrm{SCI}_{1},\\mathrm{SCI}_{2},\\mathrm{SCI}_{3},\\mathrm{SCI}_{4},i_{\\max}]$, where each $\\mathrm{SCI}_{j}$ is a float rounded to exactly three decimal places and $i_{\\max}$ is an integer.",
            "solution": "We model the insertion reaction $Be + \\text{H}_2 \\rightarrow \\text{H-Be-H}$ using a two-configuration diabatic Hamiltonian $H(s,\\theta)$, where $s$ is a dimensionless reaction coordinate and $\\theta$ is the bending angle in radians. The Hamiltonian is\n$$\nH(s,\\theta) = \\begin{pmatrix}\nE_{1}(s,\\theta) & V_{12}(s,\\theta) \\\\\nV_{12}(s,\\theta) & E_{2}(s,\\theta)\n\\end{pmatrix},\n$$\nwith\n$$\nE_{1}(s,\\theta) = k\\,(s - s_{r})^{2} + b_{1}\\,(\\theta - \\pi)^{2}, \\quad\nE_{2}(s,\\theta) = k\\,(s - s_{i})^{2} + b_{2}\\,(\\theta - \\pi)^{2} + \\delta,\n$$\n$$\nV_{12}(s,\\theta) = V_{0}\\,\\exp\\!\\big(-\\alpha\\,(s - s_{c})^{2}\\big)\\,\\exp\\!\\big(-\\gamma\\,(\\theta - \\pi)^{2}\\big),\n$$\nand fixed parameters $k = 1.0$, $s_{r} = 3.0$, $s_{i} = 1.2$, $b_{1} = 0.10$, $b_{2} = 0.30$, $\\delta = 0.20$, $V_{0} = 0.05$, $\\alpha = 2.0$, $s_{c} = 2.0$, $\\gamma = 1.0$. This model captures the essential physics of near-degeneracy between two dominant electronic configurations along the insertion coordinate, with geometry-dependent coupling.\n\nTo identify static correlation from first principles, we diagonalize the real symmetric matrix $H(s,\\theta)$ to obtain eigenvalues $E_{-} \\le E_{+}$ and corresponding normalized eigenvectors. The lower (ground-state) eigenvector can be written in the diabatic basis as\n$$\n\\lvert \\Psi_{0} \\rangle = c_{1} \\lvert \\phi_{1} \\rangle + c_{2} \\lvert \\phi_{2} \\rangle,\n$$\nwith $|c_{1}|^{2} + |c_{2}|^{2} = 1$. The measure of static (also called nondynamic) correlation here is the degree of near-degeneracy-induced mixing between the two configurations, quantified by\n$$\n\\mathrm{SCI}(s,\\theta) = 4\\,|c_{1}|^{2}\\,|c_{2}|^{2}.\n$$\nThis follows directly from the two-configuration picture: when the diagonal gap $\\Delta(s,\\theta) = E_{1}(s,\\theta) - E_{2}(s,\\theta)$ approaches zero while $V_{12}(s,\\theta)$ is finite, the ground-state eigenvector mixes the diabatic configurations nearly equally, $|c_{1}|^{2} \\approx |c_{2}|^{2} \\approx 1/2$, giving $\\mathrm{SCI} \\approx 1$, which indicates strong static correlation. Conversely, when $|\\Delta(s,\\theta)| \\gg |V_{12}(s,\\theta)|$, the ground state is nearly a single configuration, so $|c_{1}|^{2} \\approx 1$ or $0$, and $\\mathrm{SCI} \\approx 0$, indicating weak static correlation dominated by dynamic correlation.\n\nAlgorithmic steps grounded in these principles:\n1. For each $(s,\\theta)$, evaluate $E_{1}(s,\\theta)$, $E_{2}(s,\\theta)$, and $V_{12}(s,\\theta)$ using the given parameter values.\n2. Form the symmetric matrix $H(s,\\theta)$ and compute its eigenvalues and normalized eigenvectors by solving the time-independent Schrödinger equation\n$$\nH(s,\\theta)\\,\\mathbf{c} = E\\,\\mathbf{c},\n$$\nwhere $\\mathbf{c} = (c_{1}, c_{2})^{\\top}$ for the ground state.\n3. Extract $|c_{1}|^{2}$ and $|c_{2}|^{2}$ from the ground-state eigenvector and compute\n$$\n\\mathrm{SCI}(s,\\theta) = 4\\,|c_{1}|^{2}\\,|c_{2}|^{2}.\n$$\n4. Round each $\\mathrm{SCI}$ to exactly three decimal places.\n5. Determine the zero-based index $i_{\\max}$ of the largest rounded or unrounded $\\mathrm{SCI}$; to avoid tie-breaking issues from rounding, it is principled to use the unrounded values for selecting the maximum and then apply the specified rounding for reporting, while selecting the smallest index in case of exact ties.\n\nPhysical interpretation on the provided test suite:\n- At $(s=\\;3.0,\\theta=\\;\\pi)$ and $(s=\\;1.2,\\theta=\\;\\pi)$, one diabatic surface is much lower than the other (large $|\\Delta|$ relative to $|V_{12}|$), so $|c_{1}|^{2}$ or $|c_{2}|^{2}$ is close to $1$, yielding $\\mathrm{SCI} \\approx 0$, which corresponds to weak static correlation.\n- Near $(s \\approx 2.044,\\theta=\\;\\pi)$, the diabatic surfaces are nearly degenerate ($\\Delta \\approx 0$) and the coupling is appreciable, giving nearly equal configuration mixing and hence $\\mathrm{SCI} \\approx 1$, which identifies the region of the potential energy surface with the strongest static correlation.\n- Slight deviations in $s$ or $\\theta$ from that region increase $|\\Delta|$ and decrease $|V_{12}|$, reducing the mixing and thereby lowering $\\mathrm{SCI}$.\n\nThe program implements these steps to compute and report the list $[\\mathrm{SCI}_{0},\\mathrm{SCI}_{1},\\mathrm{SCI}_{2},\\mathrm{SCI}_{3},\\mathrm{SCI}_{4},i_{\\max}]$ in the required single-line format, with angles in radians and all outputs in dimensionless units.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef hamiltonian(s, theta):\n    # Parameters (dimensionless)\n    k = 1.0\n    s_r = 3.0\n    s_i = 1.2\n    b1 = 0.10\n    b2 = 0.30\n    delta = 0.20\n    V0 = 0.05\n    alpha = 2.0\n    s_c = 2.0\n    gamma = 1.0\n\n    E1 = k * (s - s_r) ** 2 + b1 * (theta - np.pi) ** 2\n    E2 = k * (s - s_i) ** 2 + b2 * (theta - np.pi) ** 2 + delta\n    V12 = V0 * np.exp(-alpha * (s - s_c) ** 2) * np.exp(-gamma * (theta - np.pi) ** 2)\n\n    H = np.array([[E1, V12],\n                  [V12, E2]], dtype=float)\n    return H\n\ndef static_correlation_index(s, theta):\n    H = hamiltonian(s, theta)\n    # Diagonalize symmetric 2x2 Hamiltonian\n    evals, evecs = np.linalg.eigh(H)\n    # Ground state eigenvector is column corresponding to smallest eigenvalue\n    idx_min = np.argmin(evals)\n    vec = evecs[:, idx_min]\n    # Normalize defensively (should already be normalized by eigh)\n    vec = vec / np.linalg.norm(vec)\n    p1 = float(vec[0] ** 2)  # |c1|^2\n    p2 = 1.0 - p1            # |c2|^2\n    sci = 4.0 * p1 * p2\n    return sci\n\ndef solve():\n    # Define the test cases from the problem statement: (s, theta) with theta in radians.\n    test_cases = [\n        (3.0, np.pi),     # Case 0\n        (2.044, np.pi),   # Case 1\n        (2.044, 2.2),     # Case 2\n        (1.2, np.pi),     # Case 3\n        (2.3, np.pi),     # Case 4\n    ]\n\n    sci_values = []\n    for (s, theta) in test_cases:\n        sci = static_correlation_index(s, theta)\n        sci_values.append(sci)\n\n    # Determine index of maximum SCI using unrounded values; tie broken by first occurrence.\n    imax = int(np.argmax(sci_values))\n\n    # Round SCI values to exactly three decimals for output.\n    sci_strings = [f\"{v:.3f}\" for v in sci_values]\n\n    # Build final output list: five SCI values followed by the integer index.\n    output_items = sci_strings + [str(imax)]\n    print(f\"[{','.join(output_items)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        },
        {
            "introduction": "While simple models provide deep insight, practical computational chemistry requires tools to diagnose static correlation in calculations on complex molecules. This practice introduces the T1 diagnostic, a valuable metric derived from coupled cluster theory, one of the most accurate single-reference methods. By implementing a simplified version of this diagnostic, you will learn how chemists assess whether a system is well-described by a single electronic configuration or if a more advanced multireference approach is necessary. ",
            "id": "2454438",
            "problem": "You are given a simplified, first-principles definition of the coupled cluster singles diagnostic (the T1 diagnostic) to assess the onset of static (nondynamic) electron correlation in substituted organic diradicals. Consider a fixed, noncanonical orthonormal orbital basis in which the off-diagonal Fock matrix elements between occupied and virtual subspaces need not vanish. For each system, let the set of single excitations be indexed by occupied indices $i$ and virtual indices $a$. The approximate single-excitation amplitudes are given by\n$$\nt_i^a \\approx \\frac{F_{ai}}{\\varepsilon_a - \\varepsilon_i},\n$$\nwhere $F_{ai}$ is the off-diagonal Fock matrix element in hartree and $\\varepsilon_p$ are the orbital energies in hartree. Define the T1 diagnostic as\n$$\nT_1 \\equiv \\frac{\\left(\\sum_{i,a} \\left(t_i^a\\right)^2\\right)^{1/2}}{\\sqrt{n_{\\text{occ}}}},\n$$\nwhere $n_{\\text{occ}}$ is the number of occupied spin-orbitals. In the context of open-shell diradicals, use the conventional heuristic threshold\n$$\n\\tau = 0.04,\n$$\nand declare that the onset of static correlation is predicted if and only if $T_1 \\ge \\tau$. The diagnostic $T_1$ is dimensionless.\n\nYour task is to implement a program that, for each test case, computes $T_1$ using the formulas above and decides whether static correlation is predicted to onset under the stated criterion. All orbital energies and Fock matrix elements must be treated in hartree. The final output for each test case must contain the value of $T_1$ rounded to five decimal places (dimensionless) and the associated boolean decision for onset of static correlation.\n\nTest suite (each test case specifies $n_{\\text{occ}}$, a list of $F_{ai}$ values, and a list of corresponding energy gaps $\\Delta_{ia} = \\varepsilon_a - \\varepsilon_i$; all energies are in hartree and all gaps satisfy $\\Delta_{ia} > 0$):\n\n- Case A (moderate couplings, sizable gaps): $n_{\\text{occ}} = 5$, $F_{ai} = [0.02, 0.015, 0.01]$, $\\Delta_{ia} = [0.5, 0.6, 0.8]$.\n- Case B (borderline near the threshold): $n_{\\text{occ}} = 2$, $F_{ai} = [0.01, 0.01]$, $\\Delta_{ia} = [0.25, 0.25]$.\n- Case C (small gaps and stronger couplings): $n_{\\text{occ}} = 6$, $F_{ai} = [0.03, 0.025, 0.02, 0.02]$, $\\Delta_{ia} = [0.15, 0.2, 0.2, 0.25]$.\n- Case D (no coupling): $n_{\\text{occ}} = 4$, $F_{ai} = [0.0, 0.0]$, $\\Delta_{ia} = [0.3, 0.4]$.\n- Case E (single near-degenerate excitation): $n_{\\text{occ}} = 4$, $F_{ai} = [0.005]$, $\\Delta_{ia} = [0.05]$.\n\nRequirements:\n\n- Compute $t_i^a$ using $t_i^a = F_{ai}/\\Delta_{ia}$ for each provided pair, then compute $T_1$ as defined above for each case.\n- For each case, compare $T_1$ to $\\tau = 0.04$ and decide if static correlation onset is predicted by the criterion $T_1 \\ge \\tau$.\n- The final program output must be a single line containing a comma-separated list enclosed in square brackets. The list must contain, for each case in the order A through E, the rounded $T_1$ value (as a float rounded to five decimal places) immediately followed by the boolean decision (using the tokens True or False). For example, the output format must be\n\"[T1_A,onset_A,T1_B,onset_B,T1_C,onset_C,T1_D,onset_D,T1_E,onset_E]\".",
            "solution": "The problem entails the computation of the coupled cluster T1 diagnostic, a standard measure in quantum chemistry for assessing the importance of static electron correlation.\n\nThe governing equations are as follows. The single-excitation amplitudes, $t_i^a$, which measure the mixing between the reference determinant and singly excited determinants, are approximated from first-order perturbation theory as:\n$$\nt_i^a \\approx \\frac{F_{ai}}{\\varepsilon_a - \\varepsilon_i} = \\frac{F_{ai}}{\\Delta_{ia}}\n$$\nHere, $F_{ai}$ represents the off-diagonal element of the Fock matrix between an occupied spin-orbital $i$ and a virtual spin-orbital $a$, and $\\Delta_{ia} = \\varepsilon_a - \\varepsilon_i$ is the corresponding orbital energy difference. All quantities are in atomic units (hartree).\n\nThe T1 diagnostic is defined as the norm of the vector of single-excitation amplitudes, normalized by the square root of the number of occupied orbitals, $n_{\\text{occ}}$:\n$$\nT_1 \\equiv \\frac{\\left(\\sum_{i,a} \\left(t_i^a\\right)^2\\right)^{1/2}}{\\sqrt{n_{\\text{occ}}}}\n$$\nThis expression is equivalent to $T_1 = ||\\mathbf{t}||_2 / \\sqrt{n_{\\text{occ}}}$, where $||\\mathbf{t}||_2$ is the Euclidean norm of the vector of amplitudes $\\mathbf{t} = (t_1, t_2, \\ldots)$.\n\nStatic correlation is determined to be significant if the diagnostic value exceeds a predefined threshold, $\\tau$. The problem specifies a threshold conventional for open-shell diradicals:\n$$\n\\tau = 0.04\n$$\nThe condition for the onset of static correlation is therefore $T_1 \\ge \\tau$.\n\nCase A:\nGiven: $n_{\\text{occ}} = 5$, $F_{ai} = [0.02, 0.015, 0.01]$, $\\Delta_{ia} = [0.5, 0.6, 0.8]$.\nThe amplitudes are computed as:\n$t_1 = 0.02 / 0.5 = 0.04$\n$t_2 = 0.015 / 0.6 = 0.025$\n$t_3 = 0.01 / 0.8 = 0.0125$\nThe sum of squared amplitudes is $\\sum_{i,a} (t_i^a)^2 = (0.04)^2 + (0.025)^2 + (0.0125)^2 = 0.0016 + 0.000625 + 0.00015625 = 0.00238125$.\nThe T1 diagnostic is:\n$$\nT_1 = \\frac{\\sqrt{0.00238125}}{\\sqrt{5}} \\approx \\frac{0.04880}{2.23607} \\approx 0.02182\n$$\nSince $0.02182 < 0.04$, the onset of static correlation is not predicted. Result: $(0.02182, \\text{False})$.\n\nCase B:\nGiven: $n_{\\text{occ}} = 2$, $F_{ai} = [0.01, 0.01]$, $\\Delta_{ia} = [0.25, 0.25]$.\nThe amplitudes are:\n$t_1 = 0.01 / 0.25 = 0.04$\n$t_2 = 0.01 / 0.25 = 0.04$\nThe sum of squared amplitudes is $\\sum_{i,a} (t_i^a)^2 = (0.04)^2 + (0.04)^2 = 0.0016 + 0.0016 = 0.0032$.\nThe T1 diagnostic is:\n$$\nT_1 = \\frac{\\sqrt{0.0032}}{\\sqrt{2}} = \\sqrt{\\frac{0.0032}{2}} = \\sqrt{0.0016} = 0.04\n$$\nSince $0.04 \\ge 0.04$, the onset of static correlation is predicted. Result: $(0.04000, \\text{True})$.\n\nCase C:\nGiven: $n_{\\text{occ}} = 6$, $F_{ai} = [0.03, 0.025, 0.02, 0.02]$, $\\Delta_{ia} = [0.15, 0.2, 0.2, 0.25]$.\nThe amplitudes are:\n$t_1 = 0.03 / 0.15 = 0.2$\n$t_2 = 0.025 / 0.2 = 0.125$\n$t_3 = 0.02 / 0.2 = 0.1$\n$t_4 = 0.02 / 0.25 = 0.08$\nThe sum of squared amplitudes is $\\sum_{i,a} (t_i^a)^2 = (0.2)^2 + (0.125)^2 + (0.1)^2 + (0.08)^2 = 0.04 + 0.015625 + 0.01 + 0.0064 = 0.072025$.\nThe T1 diagnostic is:\n$$\nT_1 = \\frac{\\sqrt{0.072025}}{\\sqrt{6}} = \\frac{0.268375}{2.44949} \\approx 0.10956\n$$\nSince $0.10956 \\ge 0.04$, the onset of static correlation is predicted. Result: $(0.10956, \\text{True})$.\n\nCase D:\nGiven: $n_{\\text{occ}} = 4$, $F_{ai} = [0.0, 0.0]$, $\\Delta_{ia} = [0.3, 0.4]$.\nThe off-diagonal Fock matrix elements are zero, so all amplitudes are zero: $t_i^a = 0$.\nConsequently, the sum of squared amplitudes is $\\sum_{i,a} (t_i^a)^2 = 0$.\nThe T1 diagnostic is:\n$$\nT_1 = \\frac{\\sqrt{0}}{\\sqrt{4}} = 0.0\n$$\nSince $0.0 < 0.04$, the onset of static correlation is not predicted. Result: $(0.00000, \\text{False})$.\n\nCase E:\nGiven: $n_{\\text{occ}} = 4$, $F_{ai} = [0.005]$, $\\Delta_{ia} = [0.05]$.\nThere is a single significant excitation. The amplitude is:\n$t_1 = 0.005 / 0.05 = 0.1$\nThe sum of squared amplitudes is $\\sum_{i,a} (t_i^a)^2 = (0.1)^2 = 0.01$.\nThe T1 diagnostic is:\n$$\nT_1 = \\frac{\\sqrt{0.01}}{\\sqrt{4}} = \\frac{0.1}{2.0} = 0.05\n$$\nSince $0.05 \\ge 0.04$, the onset of static correlation is predicted. Result: $(0.05000, \\text{True})$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the T1 diagnostic for several test cases and determines\n    if static correlation onset is predicted.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {'id': 'A', 'n_occ': 5, 'F_ai': [0.02, 0.015, 0.01], 'Delta_ia': [0.5, 0.6, 0.8]},\n        {'id': 'B', 'n_occ': 2, 'F_ai': [0.01, 0.01], 'Delta_ia': [0.25, 0.25]},\n        {'id': 'C', 'n_occ': 6, 'F_ai': [0.03, 0.025, 0.02, 0.02], 'Delta_ia': [0.15, 0.2, 0.2, 0.25]},\n        {'id': 'D', 'n_occ': 4, 'F_ai': [0.0, 0.0], 'Delta_ia': [0.3, 0.4]},\n        {'id': 'E', 'n_occ': 4, 'F_ai': [0.005], 'Delta_ia': [0.05]},\n    ]\n    \n    # Heuristic threshold for static correlation onset\n    tau = 0.04\n    \n    results = []\n    \n    for case in test_cases:\n        n_occ = case['n_occ']\n        # Convert lists to numpy arrays for vectorized operations\n        F_ai = np.array(case['F_ai'])\n        Delta_ia = np.array(case['Delta_ia'])\n        \n        # Calculate the single-excitation amplitudes t_i^a\n        # Handle the case where Delta_ia might contain zeros to avoid division by zero,\n        # although the problem statement guarantees Delta_ia > 0.\n        # Adding a small epsilon or specific check is good practice but not strictly\n        # necessary given the problem constraints.\n        t_ia = F_ai / Delta_ia\n        \n        # Calculate the sum of squares of the amplitudes\n        sum_sq_t = np.sum(t_ia**2)\n        \n        # Calculate the T1 diagnostic\n        # Denominator will not be zero as n_occ is always a positive integer.\n        T1 = np.sqrt(sum_sq_t) / np.sqrt(n_occ)\n        \n        # Compare with the threshold to get the boolean decision\n        onset_predicted = T1 >= tau\n        \n        # Append the formatted results, rounded to five decimal places\n        results.append(f\"{T1:.5f}\")\n        results.append(str(onset_predicted))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}