{
    "hands_on_practices": [
        {
            "introduction": "理论化学中，一个方法的可靠性常通过其是否遵循基本原理来评判。第一个实践提供了一个直接、定量的测试，用于检验其中一个核心原理：尺寸一致性 (size consistency)。你将通过实现一个简单的检查程序，来验证不同的计算方法在多大程度上满足一个直观的概念——两个无相互作用体系的总能量 $E(A+B)$ 应等于它们各自能量之和 $E(A) + E(B)$。",
            "id": "2805734",
            "problem": "构造一个程序化的定量测试，用于检验电子结构方法的尺寸一致性。该测试使用在大的单电子基组下，并采用 Born–Oppenheimer 近似处理的两个充分分离的氦原子。其基本依据是无相互作用子系统的能量可加性：当总哈密顿量分解为直和时，能量是相加的。形式上，设子系统的哈密顿量为 $H_A$ 和 $H_B$，它们作用于不相交的希尔伯特空间，在大的分离距离 $R$ 下，子系统间的相互作用可以忽略。复合哈密顿量为 $H = H_A \\oplus H_B$，因此当子系统无相互作用时，基态能量满足 $E(A + B) = E(A) + E(B)$。尺寸一致性是指当 $A$ 和 $B$ 不相互作用时，某种方法能返回 $E_{\\text{method}}(A + B) = E_{\\text{method}}(A) + E_{\\text{method}}(B)$ 的性质。对于两个相同的原子，在足够大的原子间距 $R$ 下，该条件简化为 $E_{\\text{method}}(\\text{He}\\cdot\\text{He}) = 2 E_{\\text{method}}(\\text{He})$。\n\n基于此，设计一个尺寸一致性的数值化通过/失败测试，定义如下。对于给定的方法、分离距离 $R$（单位为 bohr）、在相同理论水平和基组下计算的单体能量 $E_{\\text{mono}}$（单位为 Hartree）和二聚体能量 $E_{\\text{dimer}}$（单位为 Hartree），以及一个容差 $\\tau$（单位为 Hartree），当且仅当满足以下条件时，该方法通过测试：\n$$\n\\left| E_{\\text{dimer}} - 2 E_{\\text{mono}} \\right| \\le \\tau.\n$$\n所有能量单位必须是 Hartree，且 $R$ 必须足够大以使得相互作用可以忽略。\n\n实现一个程序，根据下文提供的测试套件，对每种情况输出一个布尔值列表，指明该方法在指定容差内是否具有尺寸一致性。提供原子间距 $R$ 是为了科学上的完备性，但它不直接进入数值判据（它为无相互作用的假设提供了依据）。\n\n使用以下测试套件，旨在探测大基组下（基组重叠误差可忽略）的多种场景：\n- 情况 1 (Hartree–Fock): $R = 30.0$ bohr, $E_{\\text{mono}} = -2.861679995$ Hartree, $E_{\\text{dimer}} = -5.723356990$ Hartree, $\\tau = 1\\times 10^{-5}$ Hartree。\n- 情况 2 (耦合簇单双激发): $R = 50.0$ bohr, $E_{\\text{mono}} = -2.902786500$ Hartree, $E_{\\text{dimer}} = -5.805572990$ Hartree, $\\tau = 1\\times 10^{-5}$ Hartree。\n- 情况 3 (二阶 Møller–Plesset 微扰理论): $R = 40.0$ bohr, $E_{\\text{mono}} = -2.902350000$ Hartree, $E_{\\text{dimer}} = -5.804698000$ Hartree, $\\tau = 1\\times 10^{-5}$ Hartree。\n- 情况 4 (单双激发组态相互作用): $R = 30.0$ bohr, $E_{\\text{mono}} = -2.902500000$ Hartree, $E_{\\text{dimer}} = -5.804800000$ Hartree, $\\tau = 1\\times 10^{-5}$ Hartree。\n- 情况 5 (边界情况): $R = 35.0$ bohr, $E_{\\text{mono}} = -2.900000000$ Hartree, $E_{\\text{dimer}} = -5.800010000$ Hartree, $\\tau = 1\\times 10^{-5}$ Hartree。\n\n您的程序必须：\n- 对于每种情况，计算绝对偏差 $\\left| E_{\\text{dimer}} - 2 E_{\\text{mono}} \\right|$ 并与 $\\tau$ 进行比较。\n- 为每种情况返回一个布尔值：如果不等式成立，则为 $\\,\\text{True}$，否则为 $\\,\\text{False}$。\n\n最终输出格式：您的程序应生成单行输出，其中包含用方括号括起来的、以逗号分隔的结果列表（例如，\"[True,False,True,True,False]\"）。",
            "solution": "所述问题在科学上是合理的、内容自洽且提法恰当。它为尺寸一致性这一基本量子化学性质定义了一个正确且定量的测试。所提供的数据是符合实际的，并用以说明几种标准电子结构方法的已知行为。我们将着手进行分析。\n\n尺寸一致性的概念是任何可靠的量子化学方法的关键要求。它规定，由两个无相互作用的子系统 $A$ 和 $B$ 组成的系统的能量，必须等于各个子系统能量的总和。如果总哈密顿量 $H$ 可以写成子系统哈密顿量的直和，即 $H = H_A \\oplus H_B$，那么总能量必须是可加的： $E(A + B) = E(A) + E(B)$。\n\n该问题指定了一个包含两个相同且充分分离的氦原子的场景，其相互作用能可以忽略不计。在这种情况下，尺寸一致性判据得以简化。设 $E_{\\text{mono}}$ 是单个氦原子的能量，$E_{\\text{dimer}}$ 是在大的分离距离 $R$ 下双原子系统（“二聚体”）的能量。一个具有尺寸一致性的方法必须满足关系式 $E_{\\text{dimer}} = 2 E_{\\text{mono}}$。\n\n该问题基于一个容差 $\\tau$ 定义了一个尺寸一致性的数值测试。如果与精确可加性的绝对偏差在此容差范围内，则该方法被认为是尺寸一致的：\n$$\n\\left| E_{\\text{dimer}} - 2 E_{\\text{mono}} \\right| \\le \\tau\n$$\n我们将尺寸一致性误差定义为 $\\Delta E_{\\text{SC}} = E_{\\text{dimer}} - 2 E_{\\text{mono}}$。因此，该测试就是检查是否满足 $|\\Delta E_{\\text{SC}}| \\le \\tau$。\n\n我们现在评估所提供的五个测试案例。\n\n情况 1：Hartree–Fock (HF)\n给定: $E_{\\text{mono}} = -2.861679995$ Hartree, $E_{\\text{dimer}} = -5.723356990$ Hartree, 以及 $\\tau = 1 \\times 10^{-5}$ Hartree。\n尺寸一致性误差为：\n$$\n\\Delta E_{\\text{SC}} = -5.723356990 - 2 \\times (-2.861679995) = -5.723356990 + 5.723359990 = 0.000003000 \\text{ Hartree}\n$$\n我们检验该条件：\n$$\n|\\Delta E_{\\text{SC}}| = |0.000003000| = 3.0 \\times 10^{-6} \\le 1 \\times 10^{-5}\n$$\n条件满足。结果为 $\\text{True}$。这是预料之中的，因为 Hartree-Fock 方法是尺寸一致的。\n\n情况 2：耦合簇单双激发 (CCSD)\n给定: $E_{\\text{mono}} = -2.902786500$ Hartree, $E_{\\text{dimer}} = -5.805572990$ Hartree, 以及 $\\tau = 1 \\times 10^{-5}$ Hartree。\n尺寸一致性误差为：\n$$\n\\Delta E_{\\text{SC}} = -5.805572990 - 2 \\times (-2.902786500) = -5.805572990 + 5.805573000 = 0.000000010 \\text{ Hartree}\n$$\n我们检验该条件：\n$$\n|\\Delta E_{\\text{SC}}| = |0.000000010| = 1.0 \\times 10^{-8} \\le 1 \\times 10^{-5}\n$$\n条件满足。结果为 $\\text{True}$。这是预料之中的，因为所有标准的耦合簇方法都是尺寸一致的。\n\n情况 3：二阶 Møller–Plesset 微扰理论 (MP2)\n给定: $E_{\\text{mono}} = -2.902350000$ Hartree, $E_{\\text{dimer}} = -5.804698000$ Hartree, 以及 $\\tau = 1 \\times 10^{-5}$ Hartree。\n尺寸一致性误差为：\n$$\n\\Delta E_{\\text{SC}} = -5.804698000 - 2 \\times (-2.902350000) = -5.804698000 + 5.804700000 = 0.000002000 \\text{ Hartree}\n$$\n我们检验该条件：\n$$\n|\\Delta E_{\\text{SC}}| = |0.000002000| = 2.0 \\times 10^{-6} \\le 1 \\times 10^{-5}\n$$\n条件满足。结果为 $\\text{True}$。这是预料之中的，因为任何有限阶的 Møller–Plesset 微扰理论都是尺寸一致的。\n\n情况 4：单双激发组态相互作用 (CISD)\n给定: $E_{\\text{mono}} = -2.902500000$ Hartree, $E_{\\text{dimer}} = -5.804800000$ Hartree, 以及 $\\tau = 1 \\times 10^{-5}$ Hartree。\n尺寸一致性误差为：\n$$\n\\Delta E_{\\text{SC}} = -5.804800000 - 2 \\times (-2.902500000) = -5.804800000 + 5.805000000 = 0.000200000 \\text{ Hartree}\n$$\n我们检验该条件：\n$$\n|\\Delta E_{\\text{SC}}| = |0.000200000| = 2.0 \\times 10^{-4} \\le 1 \\times 10^{-5}\n$$\n条件不满足，因为 $2.0 \\times 10^{-4} > 1 \\times 10^{-5}$。结果为 $\\text{False}$。这是截断的组态相互作用方法失败的典型例子。对于二聚体，每个单体上的单激发（例如 $c_{i \\to a}^\\dagger c_{k \\to c}^\\dagger |\\Phi_0\\rangle$）的乘积表现为双激发，但也存在四激发（例如每个单体上双激发的乘积），而后者被排除在 CISD 波函数拟设之外。这种不平衡导致了尺寸一致性的缺失。\n\n情况 5：边界情况\n给定: $E_{\\text{mono}} = -2.900000000$ Hartree, $E_{\\text{dimer}} = -5.800010000$ Hartree, 以及 $\\tau = 1 \\times 10^{-5}$ Hartree。\n尺寸一致性误差为：\n$$\n\\Delta E_{\\text{SC}} = -5.800010000 - 2 \\times (-2.900000000) = -5.800010000 + 5.800000000 = -0.000010000 \\text{ Hartree}\n$$\n我们检验该条件，注意到使用了小于等于：\n$$\n|\\Delta E_{\\text{SC}}| = |-0.000010000| = 1.0 \\times 10^{-5} \\le 1 \\times 10^{-5}\n$$\n条件满足，因为绝对偏差恰好等于容差。结果为 $\\text{True}$。\n\n总之，结果是：HF($\\text{True}$), CCSD($\\text{True}$), MP2($\\text{True}$), CISD($\\text{False}$), 边界情况($\\text{True}$)。程序实现将把这一逻辑代码化。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\n# No external libraries are necessary for this calculation.\n\ndef solve():\n    \"\"\"\n    Performs a quantitative test of size consistency for several electronic\n    structure methods based on provided energy data.\n    \"\"\"\n    # The test suite provides data for five cases. Each tuple contains:\n    # (Method Name, R, E_mono, E_dimer, tolerance)\n    # R (separation in bohr) is provided for context but not used in the calculation.\n    test_cases = [\n        # Case 1 (Hartree–Fock)\n        (\"HF\", 30.0, -2.861679995, -5.723356990, 1e-5),\n        # Case 2 (Coupled Cluster with Singles and Doubles)\n        (\"CCSD\", 50.0, -2.902786500, -5.805572990, 1e-5),\n        # Case 3 (Second-Order Møller–Plesset Perturbation Theory)\n        (\"MP2\", 40.0, -2.902350000, -5.804698000, 1e-5),\n        # Case 4 (Configuration Interaction with Singles and Doubles)\n        (\"CISD\", 30.0, -2.902500000, -5.804800000, 1e-5),\n        # Case 5 (Boundary case)\n        (\"Boundary\", 35.0, -2.900000000, -5.800010000, 1e-5),\n    ]\n\n    results = []\n    for case in test_cases:\n        # Unpack the tuple for clarity. The method name and R are not needed for the check.\n        _, _, e_mono, e_dimer, tau = case\n\n        # Calculate the absolute deviation from size consistency.\n        # The condition is |E_dimer - 2 * E_mono| <= tau.\n        deviation = abs(e_dimer - 2.0 * e_mono)\n\n        # The method passes the test if the deviation is within the tolerance.\n        # The comparison is inclusive (<=).\n        passes_test = deviation <= tau\n        results.append(passes_test)\n\n    # The final output must be a single string: a comma-separated list of\n    # booleans enclosed in square brackets.\n    # The map(str, ...) function correctly converts True to \"True\" and False to \"False\".\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "既然我们已经看到像 CISD (Configuration Interaction with Singles and Doubles) 这样的一些方法未能通过尺寸一致性测试，一个自然的问题便是：为什么？这个练习将从数值验证转向理论解释。通过分析一个简化的、但功能强大的双分子无相互作用模型，你将运用基础的线性代数来推导尺寸一致性误差的精确数学形式，从而揭示 CISD 方法自身的结构是如何导致这一缺陷的。",
            "id": "2805781",
            "problem": "考虑两个相同的、无限分离的氢二聚体 $\\mathrm{H}_{2}^{(A)}$ 和 $\\mathrm{H}_{2}^{(B)}$，它们处于拉伸构型，并在 Born–Oppenheimer 近似（固定原子核）和每个单体使用最小基组的框架下进行处理。对每个单体，使用一个双组态自旋匹配模型空间，该空间由限制性 Hartree–Fock (RHF) 参考行列式 $\\lvert \\Phi_{0} \\rangle$ 和相应的双激发行列式 $\\lvert \\Phi_{2} \\rangle$ 构成，在后者中电子对从成键空间轨道被提升到反键空间轨道。对每个孤立的单体，假设如下：(i) 选择能量零点，使得 $\\langle \\Phi_{0} \\rvert \\hat{H} \\lvert \\Phi_{0} \\rangle = 0$；(ii) $\\lvert \\Phi_{2} \\rangle$ 的对角能量为 $\\Delta > 0$；(iii) 两个行列式之间的非对角耦合是一个实数常数 $v \\neq 0$，因此限制在 $\\{ \\lvert \\Phi_{0} \\rangle, \\lvert \\Phi_{2} \\rangle \\}$ 空间内的电子哈密顿量为\n$$\n\\mathbf{H}_{\\text{mono}} \\;=\\; \\begin{pmatrix}\n0 & v \\\\\nv & \\Delta\n\\end{pmatrix}.\n$$\n此处，单双激发组态相互作用 (Configuration Interaction with Singles and Doubles, CISD) 定义为：使用变分原理，在由所考虑系统的 RHF 参考态经过所有单激发和双激发得到的行列式所张成的空间内，求解薛定谔方程得到的变分解。对于上述双行列式空间中的一个双电子单体，CISD 与完全组态相互作用 (full configuration interaction) 一致。\n\n现在构建一个复合的、无相互作用的二聚体 $\\mathrm{H}_{2}^{(A)} + \\mathrm{H}_{2}^{(B)}$，其哈密顿量为 $\\hat{H} = \\hat{H}_{A} + \\hat{H}_{B}$，并取二聚体的 CISD 模型空间由以下三个乘积行列式张成\n$$\n\\big\\{ \\lvert \\Phi_{0}^{A} \\Phi_{0}^{B} \\rangle,\\; \\lvert \\Phi_{2}^{A} \\Phi_{0}^{B} \\rangle,\\; \\lvert \\Phi_{0}^{A} \\Phi_{2}^{B} \\rangle \\big\\},\n$$\n该空间省略了非连通乘积 $\\lvert \\Phi_{2}^{A} \\Phi_{2}^{B} \\rangle$，因为相对于二聚体的 RHF 参考态，它是一个四重激发。假设单体之间严格无相互作用，因此不同单体上的激发之间没有耦合，且能量移动不超出单体贡献之和。\n\n仅使用变分原理、无相互作用子系统的可分离性以及线性代数，完成以下任务：\n- 推导单个单体的 CISD 基态能量 $E_{\\text{mono}}(\\Delta, v)$。\n- 在上述三行列式空间内，推导无相互作用二聚体的 CISD 基态能量 $E_{\\text{dimer}}^{\\text{CISD}}(\\Delta, v)$。\n- 将尺寸一致性误差定义为 $\\delta E_{\\text{CISD}}(\\Delta, v) \\equiv E_{\\text{dimer}}^{\\text{CISD}}(\\Delta, v) - \\big[ E_{\\text{mono}}(\\Delta, v) + E_{\\text{mono}}(\\Delta, v) \\big]$，并求出 $\\delta E_{\\text{CISD}}(\\Delta, v)$ 的闭式解析表达式。\n\n将最终答案表示为关于 $\\Delta$ 和 $v$ 的单个简化解析表达式。无需四舍五入。答案以符号形式给出，不包含单位。",
            "solution": "该问题陈述是有效的，因为它具有科学依据、问题明确且客观。它提出了一个理论化学中用于分析尺寸一致性的标准模型。我们现在开始求解。\n\n该问题要求分三步推导，以求出简化的单双激发组态相互作用 (CISD) 模型的尺寸一致性误差。\n\n首先，我们确定单个单体的基态能量 $E_{\\text{mono}}(\\Delta, v)$。在指定的双行列式基 $\\{ \\lvert \\Phi_{0} \\rangle, \\lvert \\Phi_{2} \\rangle \\}$ 内，单体的电子哈密顿量由下式给出：\n$$\n\\mathbf{H}_{\\text{mono}} = \\begin{pmatrix} 0 & v \\\\ v & \\Delta \\end{pmatrix}\n$$\n通过求解久期方程 $\\det(\\mathbf{H}_{\\text{mono}} - E\\mathbf{I}) = 0$ 来求能量本征值，其中 $\\mathbf{I}$ 是 2 维单位矩阵。\n$$\n\\det \\begin{pmatrix} -E & v \\\\ v & \\Delta - E \\end{pmatrix} = 0\n$$\n这导出特征多项式：\n$$\n(-E)(\\Delta - E) - v^2 = 0\n$$\n$$\nE^2 - \\Delta E - v^2 = 0\n$$\n这是一个关于能量 $E$ 的二次方程。应用二次公式 $E = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$，其中系数为 $a = 1$、$b = -\\Delta$ 和 $c = -v^2$，我们得到两个能量本征值：\n$$\nE = \\frac{\\Delta \\pm \\sqrt{(-\\Delta)^2 - 4(1)(-v^2)}}{2} = \\frac{\\Delta \\pm \\sqrt{\\Delta^2 + 4v^2}}{2}\n$$\n基态能量是这两个本征值中较小的一个。鉴于 $\\Delta > 0$ 且 $v \\neq 0$，项 $\\sqrt{\\Delta^2 + 4v^2}$ 严格大于 $\\Delta$。因此，最低的能量本征值对应于负号。该能量即为单体的 CISD 能量，在这个双态模型中，它与完全组态相互作用 (Full Configuration Interaction, FCI) 能量相同。\n$$\nE_{\\text{mono}}(\\Delta, v) = \\frac{\\Delta - \\sqrt{\\Delta^2 + 4v^2}}{2}\n$$\n\n第二步，我们确定无相互作用二聚体的 CISD 基态能量 $E_{\\text{dimer}}^{\\text{CISD}}(\\Delta, v)$。二聚体的哈密顿量为 $\\hat{H} = \\hat{H}_{A} + \\hat{H}_{B}$。二聚体的 CISD 模型空间由 3 个基函数 $\\{ \\lvert \\Psi_1 \\rangle, \\lvert \\Psi_2 \\rangle, \\lvert \\Psi_3 \\rangle \\} = \\{ \\lvert \\Phi_{0}^{A} \\Phi_{0}^{B} \\rangle, \\lvert \\Phi_{2}^{A} \\Phi_{0}^{B} \\rangle, \\lvert \\Phi_{0}^{A} \\Phi_{2}^{B} \\rangle \\}$ 张成。我们必须在此基上构建哈密顿矩阵 $\\mathbf{H}_{\\text{dimer}}^{\\text{CISD}}$。矩阵元为 $H_{ij} = \\langle \\Psi_i \\rvert \\hat{H}_A + \\hat{H}_B \\rvert \\Psi_j \\rangle$。利用单体基态的性质和无相互作用的假设：\n$H_{11} = \\langle \\Phi_{0}^{A} \\Phi_{0}^{B} \\rvert \\hat{H}_A + \\hat{H}_B \\rvert \\Phi_{0}^{A} \\Phi_{0}^{B} \\rangle = \\langle \\Phi_{0}^{A} \\rvert \\hat{H}_A \\rvert \\Phi_{0}^{A} \\rangle + \\langle \\Phi_{0}^{B} \\rvert \\hat{H}_B \\rvert \\Phi_{0}^{B} \\rangle = 0 + 0 = 0$。\n$H_{22} = \\langle \\Phi_{2}^{A} \\Phi_{0}^{B} \\rvert \\hat{H}_A + \\hat{H}_B \\rvert \\Phi_{2}^{A} \\Phi_{0}^{B} \\rangle = \\langle \\Phi_{2}^{A} \\rvert \\hat{H}_A \\rvert \\Phi_{2}^{A} \\rangle + \\langle \\Phi_{0}^{B} \\rvert \\hat{H}_B \\rvert \\Phi_{0}^{B} \\rangle = \\Delta + 0 = \\Delta$。\n$H_{33} = \\langle \\Phi_{0}^{A} \\Phi_{2}^{B} \\rvert \\hat{H}_A + \\hat{H}_B \\rvert \\Phi_{0}^{A} \\Phi_{2}^{B} \\rangle = \\langle \\Phi_{0}^{A} \\rvert \\hat{H}_A \\rvert \\Phi_{0}^{A} \\rangle + \\langle \\Phi_{2}^{B} \\rvert \\hat{H}_B \\rvert \\Phi_{2}^{B} \\rangle = 0 + \\Delta = \\Delta$。\n$H_{12} = \\langle \\Phi_{0}^{A} \\Phi_{0}^{B} \\rvert \\hat{H}_A + \\hat{H}_B \\rvert \\Phi_{2}^{A} \\Phi_{0}^{B} \\rangle = \\langle \\Phi_{0}^{A} \\rvert \\hat{H}_A \\rvert \\Phi_{2}^{A} \\rangle \\langle \\Phi_{0}^{B} \\rvert \\Phi_{0}^{B} \\rangle = v \\cdot 1 = v$。\n$H_{13} = \\langle \\Phi_{0}^{A} \\Phi_{0}^{B} \\rvert \\hat{H}_A + \\hat{H}_B \\rvert \\Phi_{0}^{A} \\Phi_{2}^{B} \\rangle = \\langle \\Phi_{0}^{A} \\rvert \\Phi_{0}^{A} \\rangle \\langle \\Phi_{0}^{B} \\rvert \\hat{H}_B \\rvert \\Phi_{2}^{B} \\rangle = 1 \\cdot v = v$。\n$H_{23} = \\langle \\Phi_{2}^{A} \\Phi_{0}^{B} \\rvert \\hat{H}_A + \\hat{H}_B \\rvert \\Phi_{0}^{A} \\Phi_{2}^{B} \\rangle = 0$，因为哈密顿量仅耦合同一单体内的态。\n得到的厄米矩阵为：\n$$\n\\mathbf{H}_{\\text{dimer}}^{\\text{CISD}} = \\begin{pmatrix} 0 & v & v \\\\ v & \\Delta & 0 \\\\ v & 0 & \\Delta \\end{pmatrix}\n$$\n为了求本征值 $E$，我们求解特征方程 $\\det(\\mathbf{H}_{\\text{dimer}}^{\\text{CISD}} - E\\mathbf{I}) = 0$：\n$$\n\\det \\begin{pmatrix} -E & v & v \\\\ v & \\Delta - E & 0 \\\\ v & 0 & \\Delta - E \\end{pmatrix} = -E(\\Delta - E)^2 - v(v(\\Delta-E)) - v(-v(\\Delta-E)) = 0\n$$\n$$\n-E(\\Delta - E)^2 - 2v^2(\\Delta - E) = 0\n$$\n$$\n-(\\Delta - E)[E(\\Delta - E) + 2v^2] = 0\n$$\n该方程产生两种可能性：\n1. $\\Delta - E = 0 \\implies E = \\Delta$。\n2. $E(\\Delta - E) + 2v^2 = 0 \\implies E^2 - \\Delta E - 2v^2 = 0$。\n第二种情况是一个二次方程，其解为：\n$$\nE = \\frac{\\Delta \\pm \\sqrt{\\Delta^2 - 4(1)(-2v^2)}}{2} = \\frac{\\Delta \\pm \\sqrt{\\Delta^2 + 8v^2}}{2}\n$$\n因此，三个本征值为 $\\Delta$、$\\frac{1}{2}(\\Delta + \\sqrt{\\Delta^2 + 8v^2})$ 和 $\\frac{1}{2}(\\Delta - \\sqrt{\\Delta^2 + 8v^2})$。基态能量是其中最小的一个。由于 $\\sqrt{\\Delta^2 + 8v^2} > \\Delta$，最低的本征值是：\n$$\nE_{\\text{dimer}}^{\\text{CISD}}(\\Delta, v) = \\frac{\\Delta - \\sqrt{\\Delta^2 + 8v^2}}{2}\n$$\n\n第三步，我们计算尺寸一致性误差 $\\delta E_{\\text{CISD}}(\\Delta, v)$，其定义为二聚体的能量与两倍单体能量之差。\n$$\n\\delta E_{\\text{CISD}}(\\Delta, v) = E_{\\text{dimer}}^{\\text{CISD}}(\\Delta, v) - 2 E_{\\text{mono}}(\\Delta, v)\n$$\n代入上面推导出的表达式：\n$$\n\\delta E_{\\text{CISD}}(\\Delta, v) = \\left( \\frac{\\Delta - \\sqrt{\\Delta^2 + 8v^2}}{2} \\right) - 2\\left( \\frac{\\Delta - \\sqrt{\\Delta^2 + 4v^2}}{2} \\right)\n$$\n$$\n\\delta E_{\\text{CISD}}(\\Delta, v) = \\frac{\\Delta - \\sqrt{\\Delta^2 + 8v^2}}{2} - (\\Delta - \\sqrt{\\Delta^2 + 4v^2})\n$$\n$$\n\\delta E_{\\text{CISD}}(\\Delta, v) = \\frac{\\Delta - \\sqrt{\\Delta^2 + 8v^2} - 2\\Delta + 2\\sqrt{\\Delta^2 + 4v^2}}{2}\n$$\n$$\n\\delta E_{\\text{CISD}}(\\Delta, v) = \\frac{-\\Delta - \\sqrt{\\Delta^2 + 8v^2} + 2\\sqrt{\\Delta^2 + 4v^2}}{2}\n$$\n该表达式可以重排为更有条理的形式：\n$$\n\\delta E_{\\text{CISD}}(\\Delta, v) = \\sqrt{\\Delta^2 + 4v^2} - \\frac{\\Delta + \\sqrt{\\Delta^2 + 8v^2}}{2}\n$$\n这就是尺寸一致性误差的最终闭式表达式。由于 $v \\neq 0$，该误差通常不为零，这表明截断的 CISD 方法不具有尺寸一致性。此问题源于在二聚体的模型空间中省略了非连通的四重激发组态 $\\lvert \\Phi_{2}^{A} \\Phi_{2}^{B} \\rangle$。",
            "answer": "$$\n\\boxed{\\sqrt{\\Delta^2 + 4v^2} - \\frac{\\Delta + \\sqrt{\\Delta^2 + 8v^2}}{2}}\n$$"
        },
        {
            "introduction": "最后一个实践将展示为何尺寸一致性不仅是一个理论上的噱头，更是预测科学中的一个实际必需品。我们常常通过计算小片段的性质并将其外推到体积极限来研究大体系，如聚合物或材料。本练习将模拟计算聚合物带隙的这一过程，展示一个尺寸不一致的方法会如何引入系统性误差，并最终导致对宏观性质的定性错误预测。",
            "id": "2462334",
            "problem": "您需要编写一个完整的、可运行的程序，在一个受控的合成情景中，演示尺寸一致性和尺寸延展性如何影响对一系列寡聚物的强度性质（此处为带隙）的外推。其教学目标是将尺寸一致性和尺寸延展性的定义与一个可通过数学方法检验的外推任务联系起来，并量化尺寸不一致方法对推断的无限聚合物极限带隙所造成的影响。\n\n基本原理。请使用以下标准定义和经过充分检验的事实作为出发点：\n- 尺寸一致性：对于两个无相互作用的子系统 $A$ 和 $B$，一个尺寸一致的方法对于每个电子态都满足 $E(A+B)=E(A)+E(B)$。\n- 尺寸延展性：对于一个子系统的 $N$ 个相同的、无相互作用的副本，像总相关能这样的广延量会随 $N$ 呈线性变化。\n- 对于长度为 $N$ 的准一维共轭寡聚物，许多强度光谱性质（例如最低单重态激发能，通俗地称为带隙）会趋近于一个 $N\\to\\infty$ 的极限，其有限尺寸修正项会随 $N$ 的负幂次消失。这启发我们将真实带隙对 $N$ 的依赖关系建模为一个关于 $1/N$ 的平滑函数。\n\n情景。考虑一个具有 $N$ 个共轭双键的多烯寡聚物序列。设物理上正确（尺寸一致）的带隙序列由一个关于 $1/N$ 的平滑展开式表示，\n$$\nE_{\\mathrm{g,true}}(N)=E_{\\infty}+\\frac{a}{N}+\\frac{b}{N^{2}},\n$$\n其中 $E_{\\infty}$（单位为电子伏特）、$a$（单位为电子伏特）和 $b$（单位为电子伏特）是对于给定化学系列的常数。假设一种尺寸一致且尺寸延展的电子结构方法，如耦合簇单双激发（CCSD），为了本次测试的目的，能够在主导阶上恢复这种函数依赖关系。\n\n现在，引入一个与组态相互作用单双激发（CISD）相关的尺寸不一致性的通用模型：当基态和激发态的总能量各自包含一个在不同态之间不能严格抵消的非加和性相关误差时，预测的带隙会继承一个不随 $N$ 消失的残余偏差。为了在性质层面上捕捉这种效应，让 CISD 预测的带隙遵循以下公式：\n$$\nE_{\\mathrm{g,CISD}}(N)=E_{\\mathrm{g,true}}(N)+\\delta_{0}+\\frac{\\delta_{1}}{N},\n$$\n其中 $\\delta_{0}$（单位为电子伏特）是一个由于尺寸不一致性而产生的、在 $N\\to\\infty$ 时仍然存在的残余态相关非加和性偏移量，而 $\\delta_{1}$（单位为电子伏特）则捕捉了次阶的态相关有限尺寸失配。\n\n您的任务。针对下方的每个测试用例：\n1. 对于给定的 $N$ 值，通过设置 $E_{\\mathrm{g,CCSD}}(N)=E_{\\mathrm{g,true}}(N)$ 来生成合成的 CCSD 一致序列 $E_{\\mathrm{g,CCSD}}(N)$。\n2. 对于相同的 $N$ 值，使用给定的 $\\delta_{0}$ 和 $\\delta_{1}$ 生成合成的 CISD 不一致序列 $E_{\\mathrm{g,CISD}}(N)$。\n3. 对每个序列分别使用以下形式的线性最小二乘拟合来估计无限聚合物极限：\n$$\nE_{\\mathrm{g}}(N)\\approx c_{0}+c_{1}\\left(\\frac{1}{N}\\right)+c_{2}\\left(\\frac{1}{N^{2}}\\right),\n$$\n并报告拟合的截距 $c_{0}$ 作为外推的 $E_{\\infty}$（单位为电子伏特）。\n4. 对于每种方法（类 CCSD 和类 CISD）和每个测试用例，计算估计的 $E_{\\infty}$ 与测试用例中提供的真实 $E_{\\infty}$ 之间的绝对误差（单位为电子伏特）。\n\n数值和单位要求：\n- 所有带隙和误差必须以电子伏特（eV）表示。\n- 您的程序必须将每个报告的浮点数输出四舍五入到六位小数。\n\n测试套件。使用以下参数集。每个测试用例是一个元组，包含：$N$ 值的列表；真实的 $E_{\\infty}$；$E_{\\mathrm{g,true}}(N)$ 的系数 $a$ 和 $b$；以及 CISD 偏差参数 $\\delta_{0}$ 和 $\\delta_{1}$。所有能量单位均为电子伏特，$N$ 无单位。\n- 测试 1 (一般正常路径): $([4,6,8,12,16],\\,2.0,\\,6.0,\\,1.5,\\,0.2,\\,0.1)$\n- 测试 2 (无尺寸不一致性): $([4,8,12,20,40],\\,1.5,\\,4.0,\\,0.5,\\,0.0,\\,0.0)$\n- 测试 3 (边界：最少拟合点): $([5,10,20],\\,3.0,\\,3.0,\\,0.0,\\,-0.15,\\,0.0)$\n- 测试 4 (强曲率和次阶 CISD 失配): $([6,7,8,12,24],\\,1.0,\\,10.0,\\,5.0,\\,0.05,\\,-0.2)$\n- 测试 5 (大 $N$ 主导): $([10,20,40,80,160],\\,0.8,\\,2.4,\\,0.4,\\,0.3,\\,0.0)$\n\n输出规格：\n- 对于每个测试用例，按此顺序将四个浮点数附加到结果列表中：类 CCSD 的外推 $E_{\\infty}$ 估计值，类 CISD 的外推 $E_{\\infty}$ 估计值，类 CCSD 估计值的绝对误差，以及类 CISD 估计值的绝对误差。所有值必须以电子伏特为单位，并四舍五入到六位小数。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。例如，输出格式必须类似于\n\"[x11,x12,x13,x14,x21,x22,x23,x24,...]\"\n不含多余的空白或文本。\n\n您的实现必须是自包含的，无需用户输入，并遵守指定的执行环境。",
            "solution": "所提出的问题是计算科学中一个有效的练习。它具有科学依据，问题明确且客观。它正确地使用简化但具有物理意义的模型来构建一个数值实验，以展示量子化学中的一个基本概念：尺寸一致性对于通过从小系统外推获得大系统正确性质的至关重要性。我们现在开始提供解决方案。\n\n核心任务是量化在使用尺寸不一致的理论方法时，将强度性质——电子带隙 $E_g$——外推到无限聚合物极限（$N \\to \\infty$）时所引入的误差。我们获得了由“真实”或尺寸一致的方法（如 CCSD）和尺寸不一致的方法（如 CISD）计算的长度为 $N$ 的寡聚物带隙的模型。\n\n真实的带隙由以下函数形式给出：\n$$\nE_{\\mathrm{g,true}}(N) = E_{\\infty} + \\frac{a}{N} + \\frac{b}{N^2}\n$$\n此处，$E_{\\infty}$ 是无限聚合物的真实带隙，系数为 $a$ 和 $b$ 的项代表随着 $N$ 增大而消失的有限尺寸修正。这种形式对于准一维系统具有物理动机。为解决此问题，我们假设像 CCSD 这样的尺寸一致方法能够完美地再现此行为。因此，我们设定：\n$$\nE_{\\mathrm{g,CCSD}}(N) = E_{\\mathrm{g,true}}(N)\n$$\n\n像 CISD 这样的尺寸不一致方法会引入一个不能随系统尺寸正确变化的误差。这通过向真实能量添加一个偏差项来建模：\n$$\nE_{\\mathrm{g,CISD}}(N) = E_{\\mathrm{g,true}}(N) + \\delta_{0} + \\frac{\\delta_{1}}{N}\n$$\n项 $\\delta_0$ 代表一个即使对于无限大系统（$N \\to \\infty$）也持续存在的非加和性、态相关误差。这是尺寸不一致性影响强度性质的数学标志。项 $\\delta_1/N$ 是一个次阶的尺寸相关误差。代入 $E_{\\mathrm{g,true}}(N)$ 的表达式，我们可以将 CISD 模型重写为：\n$$\nE_{\\mathrm{g,CISD}}(N) = (E_{\\infty} + \\delta_0) + \\frac{a + \\delta_1}{N} + \\frac{b}{N^2}\n$$\n\n估计无限极限带隙 $E_{\\infty}$ 的过程是，对一组计算出的数据点 $(N_i, E_{\\mathrm{g}}(N_i))$ 使用以下模型进行线性最小二乘拟合：\n$$\nE_{\\mathrm{g}}(N) \\approx c_0 + c_1 \\left(\\frac{1}{N}\\right) + c_2 \\left(\\frac{1}{N^2}\\right)\n$$\n外推的带隙是拟合的截距 $c_0$。这是一个标准的多变量线性回归问题。我们寻求找到系数 $\\mathbf{c} = [c_0, c_1, c_2]^T$，以最小化方程组 $\\mathbf{A}\\mathbf{c} \\approx \\mathbf{y}$ 的残差平方和，其中：\n- $\\mathbf{y}$ 是计算出的带隙向量，$[E_{\\mathrm{g}}(N_1), E_{\\mathrm{g}}(N_2), \\dots]^T$。\n- $\\mathbf{A}$ 是设计矩阵，其中第 $i$ 行是 $[1, 1/N_i, 1/N_i^2]$。\n\n系数向量 $\\mathbf{c}$ 的最小二乘解由 $\\mathbf{c} = (\\mathbf{A}^T\\mathbf{A})^{-1}\\mathbf{A}^T\\mathbf{y}$ 给出。我们将使用 `numpy.linalg.lstsq` 函数来计算它。\n\n对于尺寸一致的 CCSD 数据，生成的点 $(1/N_i, E_{\\mathrm{g,CCSD}}(N_i))$ 精确地位于拟合模型定义的曲线上。因此，最小二乘拟合将是完美的（在机器精度范围内），产生的外推截距为 $c_0 = E_{\\infty}$。由此产生的误差 $|c_0 - E_{\\infty}|$ 应该有效为零。\n\n对于尺寸不一致的 CISD 数据，生成的点位于由 $(E_{\\infty} + \\delta_0) + (a + \\delta_1)/N + b/N^2$ 定义的曲线上。当我们将这些数据拟合到模型 $c_0 + c_1/N + c_2/N^2$ 时，最小二乘法程序将找到一个截距 $c_0 \\approx E_{\\infty} + \\delta_0$。因此，外推的带隙存在系统性错误，误差 $|c_0 - E_{\\infty}|$ 将约等于 $|\\delta_0|$。这直接证明了尺寸不一致性如何阻碍向宏观极限的精确外推。\n\n对于每个测试用例，算法流程如下：\n1. 对于给定的一组 $N$ 值和参数（$E_{\\infty}, a, b, \\delta_0, \\delta_1$），构建设计矩阵 $\\mathbf{A}$，其列为 $N^0$、$N^{-1}$ 和 $N^{-2}$。\n2. 使用 $E_{\\mathrm{g,CCSD}}(N)$ 公式生成“数据”向量 $\\mathbf{y}_{\\mathrm{CCSD}}$。\n3. 使用最小二乘法求解 $\\mathbf{A}\\mathbf{c}_{\\mathrm{CCSD}} \\approx \\mathbf{y}_{\\mathrm{CCSD}}$ 以得到 $\\mathbf{c}_{\\mathrm{CCSD}}$。第一个元素是外推的带隙 $c_{0,\\mathrm{CCSD}}$。\n4. 计算绝对误差 $|c_{0,\\mathrm{CCSD}} - E_{\\infty}|$。\n5. 使用 $E_{\\mathrm{g,CISD}}(N)$ 公式生成“数据”向量 $\\mathbf{y}_{\\mathrm{CISD}}$。\n6. 使用最小二乘法求解 $\\mathbf{A}\\mathbf{c}_{\\mathrm{CISD}} \\approx \\mathbf{y}_{\\mathrm{CISD}}$ 以得到 $\\mathbf{c}_{\\mathrm{CISD}}$。第一个元素是外推的带隙 $c_{0,\\mathrm{CISD}}$。\n7. 计算绝对误差 $|c_{0,\\mathrm{CISD}} - E_{\\infty}|$。\n8. 收集并报告这四个值，并四舍五入到指定的精度。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Demonstrates the effect of size consistency on extrapolating oligomer\n    properties by simulating band gap calculations and performing a\n    least-squares fit to the infinite-polymer limit.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each tuple contains:\n    # (list of N values, E_inf_true, a, b, delta_0, delta_1)\n    test_cases = [\n        # Test 1 (general happy path)\n        ([4, 6, 8, 12, 16], 2.0, 6.0, 1.5, 0.2, 0.1),\n        # Test 2 (no size inconsistency)\n        ([4, 8, 12, 20, 40], 1.5, 4.0, 0.5, 0.0, 0.0),\n        # Test 3 (boundary: minimal fit points)\n        ([5, 10, 20], 3.0, 3.0, 0.0, -0.15, 0.0),\n        # Test 4 (strong curvature and subleading CISD mismatch)\n        ([6, 7, 8, 12, 24], 1.0, 10.0, 5.0, 0.05, -0.2),\n        # Test 5 (large-N dominance)\n        ([10, 20, 40, 80, 160], 0.8, 2.4, 0.4, 0.3, 0.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        Ns_list, E_inf_true, a, b, delta_0, delta_1 = case\n        \n        # Convert list of N values to a numpy array for vectorization\n        Ns = np.array(Ns_list, dtype=float)\n        \n        # Prepare the variables for the linear least-squares fit\n        inv_N = 1.0 / Ns\n        inv_N2 = inv_N**2\n        \n        # Construct the design matrix A for the model E_g = c0 + c1*(1/N) + c2*(1/N^2)\n        # The columns are N^0, N^-1, N^-2\n        A = np.vstack([np.ones_like(Ns), inv_N, inv_N2]).T\n        \n        # --- 1. CCSD-like (size-consistent) method ---\n        \n        # Generate the synthetic band gap data\n        # E_g_ccsd is identical to E_g_true in this model\n        E_g_ccsd = E_inf_true + a * inv_N + b * inv_N2\n        \n        # Perform the linear least-squares fit: A * c = E_g_ccsd\n        # lstsq returns the solution vector (c), residuals, rank, and singular values\n        c_ccsd, _, _, _ = np.linalg.lstsq(A, E_g_ccsd, rcond=None)\n        \n        # The extrapolated infinite-polymer band gap is the intercept c0\n        extrapolated_E_inf_ccsd = c_ccsd[0]\n        \n        # Calculate the absolute error\n        error_ccsd = np.abs(extrapolated_E_inf_ccsd - E_inf_true)\n        \n        # --- 2. CISD-like (size-inconsistent) method ---\n        \n        # Generate the synthetic band gap data with the inconsistency bias\n        E_g_cisd = E_g_ccsd + delta_0 + delta_1 * inv_N\n        \n        # Perform the linear least-squares fit for the CISD data\n        c_cisd, _, _, _ = np.linalg.lstsq(A, E_g_cisd, rcond=None)\n        \n        # The extrapolated infinite-polymer band gap is the intercept c0\n        extrapolated_E_inf_cisd = c_cisd[0]\n        \n        # Calculate the absolute error\n        error_cisd = np.abs(extrapolated_E_inf_cisd - E_inf_true)\n        \n        # --- 3. Store results ---\n        \n        # Append the four required values for this test case\n        results.extend([\n            extrapolated_E_inf_ccsd,\n            extrapolated_E_inf_cisd,\n            error_ccsd,\n            error_cisd\n        ])\n\n    # Final print statement in the exact required format.\n    # Each float is rounded to six decimal places.\n    formatted_results = [f\"{val:.6f}\" for val in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}