{
    "hands_on_practices": [
        {
            "introduction": "在数值磁流体动力学中，维持磁场的无散约束（即 $\\nabla \\cdot \\mathbf{B} = 0$）是一项核心挑战。如果违反该约束，将导致非物理性的磁单极子产生，从而破坏仿真的准确性。本练习将引导您完成一个符号推导，以证明约束输运（CT）方法，由于其内在的交错网格结构，能够精确地保持该约束的离散形式，无论在电场中包含了多么复杂的物理过程（例如电阻效应）。这个练习揭示了CT方法鲁棒性的基石。",
            "id": "3469558",
            "problem": "考虑一个通过电阻性广义相对论磁流体力学 (GRMHD) 演化的双中子星模拟的局部区域，该区域特化为平直时空，因此其直减函数为 $\\,\\alpha=1\\,$，移位矢量为 $\\,\\beta^{i}=0\\,$，空间度规为 $\\,\\gamma_{ij}=\\delta_{ij}\\,$。在 Heaviside–Lorentz 单位制下进行计算，其中 $\\,c=1\\,$ 且 $\\,\\mu_{0}=1\\,$。电磁演化由积分形式的 Faraday 定律支配，在此设定下，其微分形式简化为 $\\,\\partial_{t}\\boldsymbol{B}=-\\nabla\\times\\boldsymbol{E}\\,$。电流由磁准静态极限下的 Ampère 定律定义，即 $\\,\\boldsymbol{J}=\\nabla\\times\\boldsymbol{B}\\,$；电场遵循非相对论极限下的电阻性 Ohm 定律，即 $\\,\\boldsymbol{E}=-\\boldsymbol{v}\\times\\boldsymbol{B}+\\eta\\,\\boldsymbol{J}\\,$，其中 $\\,\\eta>0\\,$ 是一个恒定的电阻率，$\\,\\boldsymbol{v}\\,$ 是流体的三维速度。\n\n在 $\\,x$–$y\\,$ 平面上的一个二维均匀笛卡尔 Yee 网格上进行离散化，网格间距为 $\\,\\Delta x=\\Delta y=\\Delta\\,$，并采用周期性边界条件。磁场分量 $\\,B_{x}\\,$ 和 $\\,B_{y}\\,$ 分别作为面平均值存储在位置 $\\,\\left(i+\\tfrac{1}{2},j\\right)\\,$ 和 $\\,\\left(i,j+\\tfrac{1}{2}\\right)\\,$ 处，而平面外电场分量 $\\,E_{z}\\,$ 作为边平均值存储在位置 $\\,\\left(i+\\tfrac{1}{2},j+\\tfrac{1}{2}\\right)\\,$ 处。磁场的约束输运 (CT) 更新通过 Stokes 定理定义为边心电动势 (EMF) $\\,E_{z}\\,$ 的离散旋度：\n$$\nB_{x}^{\\,n+1}\\!\\left(i+\\tfrac{1}{2},j\\right)\n=\nB_{x}^{\\,n}\\!\\left(i+\\tfrac{1}{2},j\\right)\n-\n\\frac{\\Delta t}{\\Delta}\n\\Big(\nE_{z}^{\\,n+\\theta}\\!\\left(i+\\tfrac{1}{2},j+\\tfrac{1}{2}\\right)\n-\nE_{z}^{\\,n+\\theta}\\!\\left(i+\\tfrac{1}{2},j-\\tfrac{1}{2}\\right)\n\\Big),\n$$\n$$\nB_{y}^{\\,n+1}\\!\\left(i,j+\\tfrac{1}{2}\\right)\n=\nB_{y}^{\\,n}\\!\\left(i,j+\\tfrac{1}{2}\\right)\n+\n\\frac{\\Delta t}{\\Delta}\n\\Big(\nE_{z}^{\\,n+\\theta}\\!\\left(i+\\tfrac{1}{2},j+\\tfrac{1}{2}\\right)\n-\nE_{z}^{\\,n+\\theta}\\!\\left(i-\\tfrac{1}{2},j+\\tfrac{1}{2}\\right)\n\\Big),\n$$\n其中 $\\,\\theta\\in[0,1]\\,$ 表示与电阻源项的隐式-显式 (IMEX) 处理相一致的任何时间中心化方案。边心电动势由电阻性 Ohm 定律在 $\\,\\boldsymbol{v}=\\boldsymbol{0}\\,$ 的情况下构造，因此有 $\\,E_{z}=\\eta\\,J_{z}\\,$。离散电流 $\\,J_{z}\\,$ 使用应用于面心磁场的、与 Stokes 定理兼容的同一离散旋度算子计算得出：\n$$\nJ_{z}^{\\,n+\\varphi}\\!\\left(i+\\tfrac{1}{2},j+\\tfrac{1}{2}\\right)\n=\n\\frac{1}{\\Delta}\n\\Big(\nB_{y}^{\\,n+\\varphi}\\!\\left(i+1,j+\\tfrac{1}{2}\\right)\n-\nB_{y}^{\\,n+\\varphi}\\!\\left(i,j+\\tfrac{1}{2}\\right)\n-\nB_{x}^{\\,n+\\varphi}\\!\\left(i+\\tfrac{1}{2},j+1\\right)\n+\nB_{x}^{\\,n+\\varphi}\\!\\left(i+\\tfrac{1}{2},j\\right)\n\\Big),\n$$\n其中 $\\,\\varphi\\,$ 是与所选 IMEX 积分器兼容的任意阶段指数，且 $\\,E_{z}^{\\,n+\\theta}=\\eta\\,J_{z}^{\\,n+\\varphi}\\,$。\n\n将与 Gauss 定律一致的单元中心离散散度算子定义为\n$$\n\\left(\\nabla_{h}\\cdot\\boldsymbol{B}\\right)^{n}\\!(i,j)\n=\n\\frac{B_{x}^{\\,n}\\!\\left(i+\\tfrac{1}{2},j\\right)-B_{x}^{\\,n}\\!\\left(i-\\tfrac{1}{2},j\\right)}{\\Delta}\n+\n\\frac{B_{y}^{\\,n}\\!\\left(i,j+\\tfrac{1}{2}\\right)-B_{y}^{\\,n}\\!\\left(i,j-\\tfrac{1}{2}\\right)}{\\Delta}.\n$$\n\n假设初始磁场由离散矢量势 $\\,A_{z}^{\\,0}\\!\\left(i+\\tfrac{1}{2},j+\\tfrac{1}{2}\\right)=\\dfrac{B_{0}}{k}\\cos\\!\\big(k\\,x_{i+\\frac{1}{2}}\\big)\\cos\\!\\big(k\\,y_{j+\\frac{1}{2}}\\big)\\,$ 通过离散旋度构造：\n$$\nB_{x}^{\\,0}\\!\\left(i+\\tfrac{1}{2},j\\right)\n=\n\\frac{A_{z}^{\\,0}\\!\\left(i+\\tfrac{1}{2},j+\\tfrac{1}{2}\\right)-A_{z}^{\\,0}\\!\\left(i+\\tfrac{1}{2},j-\\tfrac{1}{2}\\right)}{\\Delta},\n\\quad\nB_{y}^{\\,0}\\!\\left(i,j+\\tfrac{1}{2}\\right)\n=\n-\\frac{A_{z}^{\\,0}\\!\\left(i+\\tfrac{1}{2},j+\\tfrac{1}{2}\\right)-A_{z}^{\\,0}\\!\\left(i-\\tfrac{1}{2},j+\\tfrac{1}{2}\\right)}{\\Delta},\n$$\n这样，根据构造，初始离散散度在每个单元上都为零。\n\n仅使用 Faraday 定律和 Ampère 定律的积分表述以及上述在 Yee 网格上的离散算子，推导在使用所定义的约束输运更新和电阻性电动势进行一个持续时间为 $\\,\\Delta t\\,$ 的单步前向欧拉积分后，更新后的单元中心离散散度 $\\,\\left(\\nabla_{h}\\cdot\\boldsymbol{B}\\right)^{n+1}\\!(i,j)\\,$ 的表达式。然后，计算 $\\,\\left(\\nabla_{h}\\cdot\\boldsymbol{B}\\right)^{n+1}\\!(i,j)\\,$ 的结果值。你的最终答案必须是一个实数。不需要单位。不要四舍五入。",
            "solution": "用户想要找出经过单个前向欧拉时间步后，离散的、单元中心的磁场散度 $\\left(\\nabla_{h}\\cdot\\boldsymbol{B}\\right)^{n+1}\\!\\!(i,j)$ 的值。\n\n首先，我们必须验证问题陈述的有效性。\n\n### 步骤 1：提取给定条件\n- **时空**：平直，直减函数 $\\alpha=1$，移位矢量 $\\beta^{i}=0$，空间度规 $\\gamma_{ij}=\\delta_{ij}$。\n- **单位制**：Heaviside–Lorentz，其中 $c=1$ 且 $\\mu_{0}=1$。\n- **控制方程 (连续谱)**：\n    - Faraday 定律：$\\partial_{t}\\boldsymbol{B}=-\\nabla\\times\\boldsymbol{E}$。\n    - Ampère 定律 (磁准静态)：$\\boldsymbol{J}=\\nabla\\times\\boldsymbol{B}$。\n    - Ohm 定律 (电阻性，非相对论极限)：$\\boldsymbol{E}=-\\boldsymbol{v}\\times\\boldsymbol{B}+\\eta\\,\\boldsymbol{J}$，其中电阻率 $\\eta>0$ 为常数，流体速度 $\\boldsymbol{v}=\\boldsymbol{0}$，简化为 $\\boldsymbol{E}=\\eta\\,\\boldsymbol{J}$。\n- **离散化**：\n    - $x$–$y$ 平面上的二维均匀笛卡尔 Yee 网格，间距为 $\\Delta x=\\Delta y=\\Delta$。\n    - $B_{x}$ 位于面心 $\\left(i+\\tfrac{1}{2},j\\right)$。\n    - $B_{y}$ 位于面心 $\\left(i,j+\\tfrac{1}{2}\\right)$。\n    - $E_{z}$ 位于边心 $\\left(i+\\tfrac{1}{2},j+\\tfrac{1}{2}\\right)$。\n- **离散算子**：\n    - **约束输运 (CT) 更新**：\n      $$B_{x}^{\\,n+1}\\!\\left(i+\\tfrac{1}{2},j\\right) = B_{x}^{\\,n}\\!\\left(i+\\tfrac{1}{2},j\\right) - \\frac{\\Delta t}{\\Delta} \\Big( E_{z}^{\\,n+\\theta}\\!\\left(i+\\tfrac{1}{2},j+\\tfrac{1}{2}\\right) - E_{z}^{\\,n+\\theta}\\!\\left(i+\\tfrac{1}{2},j-\\tfrac{1}{2}\\right) \\Big)$$\n      $$B_{y}^{\\,n+1}\\!\\left(i,j+\\tfrac{1}{2}\\right) = B_{y}^{\\,n}\\!\\left(i,j+\\tfrac{1}{2}\\right) + \\frac{\\Delta t}{\\Delta} \\Big( E_{z}^{\\,n+\\theta}\\!\\left(i+\\tfrac{1}{2},j+\\tfrac{1}{2}\\right) - E_{z}^{\\,n+\\theta}\\!\\left(i-\\tfrac{1}{2},j+\\tfrac{1}{2}\\right) \\Big)$$\n    - **离散电流 ($z$分量)**：\n      $$J_{z}^{\\,n+\\varphi}\\!\\left(i+\\tfrac{1}{2},j+\\tfrac{1}{2}\\right) = \\frac{1}{\\Delta} \\Big( B_{y}^{\\,n+\\varphi}\\!\\left(i+1,j+\\tfrac{1}{2}\\right) - B_{y}^{\\,n+\\varphi}\\!\\left(i,j+\\tfrac{1}{2}\\right) - B_{x}^{\\,n+\\varphi}\\!\\left(i+\\tfrac{1}{2},j+1\\right) + B_{x}^{\\,n+\\varphi}\\!\\left(i+\\tfrac{1}{2},j\\right) \\Big)$$\n    - **电场**：$E_{z}^{\\,n+\\theta}=\\eta\\,J_{z}^{\\,n+\\varphi}$。\n    - **离散散度**：\n      $$\\left(\\nabla_{h}\\cdot\\boldsymbol{B}\\right)^{n}\\!(i,j) = \\frac{B_{x}^{\\,n}\\!\\left(i+\\tfrac{1}{2},j\\right)-B_{x}^{\\,n}\\!\\left(i-\\tfrac{1}{2},j\\right)}{\\Delta} + \\frac{B_{y}^{\\,n}\\!\\left(i,j+\\tfrac{1}{2}\\right)-B_{y}^{\\,n}\\!\\left(i,j-\\tfrac{1}{2}\\right)}{\\Delta}$$\n- **初始条件**：\n    - 初始磁场 $\\boldsymbol{B}^0$ 通过离散矢量势 $A_{z}^{0}\\!\\left(i+\\tfrac{1}{2},j+\\tfrac{1}{2}\\right)$ 导出：\n      $$B_{x}^{\\,0}\\!\\left(i+\\tfrac{1}{2},j\\right) = \\frac{A_{z}^{\\,0}\\!\\left(i+\\tfrac{1}{2},j+\\tfrac{1}{2}\\right)-A_{z}^{\\,0}\\!\\left(i+\\tfrac{1}{2},j-\\tfrac{1}{2}\\right)}{\\Delta}$$\n      $$B_{y}^{\\,0}\\!\\left(i,j+\\tfrac{1}{2}\\right) = -\\frac{A_{z}^{\\,0}\\!\\left(i+\\tfrac{1}{2},j+\\tfrac{1}{2}\\right)-A_{z}^{\\,0}\\!\\left(i-\\tfrac{1}{2},j+\\tfrac{1}{2}\\right)}{\\Delta}$$\n    - 问题陈述初始离散散度为零：$\\left(\\nabla_{h}\\cdot\\boldsymbol{B}\\right)^{0}\\!(i,j)=0$。\n- **任务**：\n    - 推导经过单步前向欧拉步 ($\\Delta t$) 后 $\\left(\\nabla_{h}\\cdot\\boldsymbol{B}\\right)^{n+1}\\!(i,j)$ 的表达式。\n    - 计算其值。对于前向欧拉步，我们取时间中心化参数 $\\theta=0$，右端项计算的阶段指数为 $\\varphi=n$。我们关心的是第一步，所以我们从 $n=0$ 演化到 $n+1=1$。\n\n### 步骤 2：使用提取的给定条件进行验证\n该问题具有科学依据、是适定且客观的。它描述了一种用于求解简化电阻性 MHD 方程组的标准数值方法（Yee 网格上的约束输运）。其中的物理学虽然经过简化，但对于此类数值测试是自洽和标准的。所有定义和离散算子都已明确给出，并且是计算电磁学和磁流体力学领域的标准。初始条件定义明确。问题具体，可以通过严格推导来回答。该问题不违反任何指定的无效性标准。\n\n### 步骤 3：结论和行动\n问题有效。我们开始求解。\n\n目标是计算在时间步 $n+1$ 的磁场离散散度，记为 $\\left(\\nabla_{h}\\cdot\\boldsymbol{B}\\right)^{n+1}\\!(i,j)$。我们从其定义开始：\n$$\n\\left(\\nabla_{h}\\cdot\\boldsymbol{B}\\right)^{n+1}\\!(i,j) = \\frac{B_{x}^{\\,n+1}\\!\\left(i+\\tfrac{1}{2},j\\right)-B_{x}^{\\,n+1}\\!\\left(i-\\tfrac{1}{2},j\\right)}{\\Delta} + \\frac{B_{y}^{\\,n+1}\\!\\left(i,j+\\tfrac{1}{2}\\right)-B_{y}^{\\,n+1}\\!\\left(i,j-\\tfrac{1}{2}\\right)}{\\Delta}\n$$\n我们可以将其改写为：\n$$\n\\Delta\\left(\\nabla_{h}\\cdot\\boldsymbol{B}\\right)^{n+1}\\!(i,j) = \\Big[ B_{x}^{\\,n+1}\\!\\left(i+\\tfrac{1}{2},j\\right)-B_{x}^{\\,n+1}\\!\\left(i-\\tfrac{1}{2},j\\right) \\Big] + \\Big[ B_{y}^{\\,n+1}\\!\\left(i,j+\\tfrac{1}{2}\\right)-B_{y}^{\\,n+1}\\!\\left(i,j-\\tfrac{1}{2}\\right) \\Big]\n$$\n现在，将给定的约束输运 (CT) 更新方程代入 $B_{x}^{\\,n+1}$ 和 $B_{y}^{\\,n+1}$ 的表达式中。问题指定了前向欧拉步，所以我们使用 $\\theta=0$ 并在时间步 $n$ 计算电场。\n对于 $x$ 分量的差值：\n$$\nB_{x}^{\\,n+1}\\!\\left(i+\\tfrac{1}{2},j\\right)-B_{x}^{\\,n+1}\\!\\left(i-\\tfrac{1}{2},j\\right) = \\\\\n\\left[ B_{x}^{\\,n}\\!\\left(i+\\tfrac{1}{2},j\\right) - \\frac{\\Delta t}{\\Delta} \\Big( E_{z}^{\\,n}\\!\\left(i+\\tfrac{1}{2},j+\\tfrac{1}{2}\\right) - E_{z}^{\\,n}\\!\\left(i+\\tfrac{1}{2},j-\\tfrac{1}{2}\\right) \\Big) \\right] - \\\\\n\\left[ B_{x}^{\\,n}\\!\\left(i-\\tfrac{1}{2},j\\right) - \\frac{\\Delta t}{\\Delta} \\Big( E_{z}^{\\,n}\\!\\left(i-\\tfrac{1}{2},j+\\tfrac{1}{2}\\right) - E_{z}^{\\,n}\\!\\left(i-\\tfrac{1}{2},j-\\tfrac{1}{2}\\right) \\Big) \\right]\n$$\n按时间步对各项进行分组：\n$$\n= \\Big[ B_{x}^{\\,n}\\!\\left(i+\\tfrac{1}{2},j\\right) - B_{x}^{\\,n}\\!\\left(i-\\tfrac{1}{2},j\\right) \\Big] - \\frac{\\Delta t}{\\Delta} \\Big[ E_{z}^{\\,n}\\!\\left(i+\\tfrac{1}{2},j+\\tfrac{1}{2}\\right) - E_{z}^{\\,n}\\!\\left(i+\\tfrac{1}{2},j-\\tfrac{1}{2}\\right) - E_{z}^{\\,n}\\!\\left(i-\\tfrac{1}{2},j+\\tfrac{1}{2}\\right) + E_{z}^{\\,n}\\!\\left(i-\\tfrac{1}{2},j-\\tfrac{1}{2}\\right) \\Big]\n$$\n对于 $y$ 分量的差值：\n$$\nB_{y}^{\\,n+1}\\!\\left(i,j+\\tfrac{1}{2}\\right)-B_{y}^{\\,n+1}\\!\\left(i,j-\\tfrac{1}{2}\\right) = \\\\\n\\left[ B_{y}^{\\,n}\\!\\left(i,j+\\tfrac{1}{2}\\right) + \\frac{\\Delta t}{\\Delta} \\Big( E_{z}^{\\,n}\\!\\left(i+\\tfrac{1}{2},j+\\tfrac{1}{2}\\right) - E_{z}^{\\,n}\\!\\left(i-\\tfrac{1}{2},j+\\tfrac{1}{2}\\right) \\Big) \\right] - \\\\\n\\left[ B_{y}^{\\,n}\\!\\left(i,j-\\tfrac{1}{2}\\right) + \\frac{\\Delta t}{\\Delta} \\Big( E_{z}^{\\,n}\\!\\left(i+\\tfrac{1}{2},j-\\tfrac{1}{2}\\right) - E_{z}^{\\,n}\\!\\left(i-\\tfrac{1}{2},j-\\tfrac{1}{2}\\right) \\Big) \\right]\n$$\n按时间步对各项进行分组：\n$$\n= \\Big[ B_{y}^{\\,n}\\!\\left(i,j+\\tfrac{1}{2}\\right) - B_{y}^{\\,n}\\!\\left(i,j-\\tfrac{1}{2}\\right) \\Big] + \\frac{\\Delta t}{\\Delta} \\Big[ E_{z}^{\\,n}\\!\\left(i+\\tfrac{1}{2},j+\\tfrac{1}{2}\\right) - E_{z}^{\\,n}\\!\\left(i-\\tfrac{1}{2},j+\\tfrac{1}{2}\\right) - E_{z}^{\\,n}\\!\\left(i+\\tfrac{1}{2},j-\\tfrac{1}{2}\\right) + E_{z}^{\\,n}\\!\\left(i-\\tfrac{1}{2},j-\\tfrac{1}{2}\\right) \\Big]\n$$\n现在，我们将 $x$ 分量和 $y$ 分量的差值相加，得到 $\\Delta\\left(\\nabla_{h}\\cdot\\boldsymbol{B}\\right)^{n+1}\\!(i,j):$\n$$\n\\Delta\\left(\\nabla_{h}\\cdot\\boldsymbol{B}\\right)^{n+1}\\!(i,j) = \\Big[ B_{x}^{\\,n}\\!\\left(i+\\tfrac{1}{2},j\\right) - B_{x}^{\\,n}\\!\\left(i-\\tfrac{1}{2},j\\right) \\Big] + \\Big[ B_{y}^{\\,n}\\!\\left(i,j+\\tfrac{1}{2}\\right) - B_{y}^{\\,n}\\!\\left(i,j-\\tfrac{1}{2}\\right) \\Big] \\\\\n- \\frac{\\Delta t}{\\Delta} \\Big[ E_{z}^{\\,n}\\!\\left(i+\\tfrac{1}{2},j+\\tfrac{1}{2}\\right) - E_{z}^{\\,n}\\!\\left(i+\\tfrac{1}{2},j-\\tfrac{1}{2}\\right) - E_{z}^{\\,n}\\!\\left(i-\\tfrac{1}{2},j+\\tfrac{1}{2}\\right) + E_{z}^{\\,n}\\!\\left(i-\\tfrac{1}{2},j-\\tfrac{1}{2}\\right) \\Big] \\\\\n+ \\frac{\\Delta t}{\\Delta} \\Big[ E_{z}^{\\,n}\\!\\left(i+\\tfrac{1}{2},j+\\tfrac{1}{2}\\right) - E_{z}^{\\,n}\\!\\left(i-\\tfrac{1}{2},j+\\tfrac{1}{2}\\right) - E_{z}^{\\,n}\\!\\left(i+\\tfrac{1}{2},j-\\tfrac{1}{2}\\right) + E_{z}^{\\,n}\\!\\left(i-\\tfrac{1}{2},j-\\tfrac{1}{2}\\right) \\Big]\n$$\n右边的第一行正好是 $\\Delta\\left(\\nabla_{h}\\cdot\\boldsymbol{B}\\right)^{n}\\!(i,j)$。我们来检查包含 $E_{z}^{\\,n}$ 的项。我们收集在单元 $(i,j)$ 的四个顶点处 $E_{z}^{\\,n}$ 的所有系数：\n- $E_{z}^{\\,n}\\!\\left(i+\\tfrac{1}{2},j+\\tfrac{1}{2}\\right)$: 系数为 $-\\frac{\\Delta t}{\\Delta}(1) + \\frac{\\Delta t}{\\Delta}(1) = 0$。\n- $E_{z}^{\\,n}\\!\\left(i+\\tfrac{1}{2},j-\\tfrac{1}{2}\\right)$: 系数为 $-\\frac{\\Delta t}{\\Delta}(-1) + \\frac{\\Delta t}{\\Delta}(-1) = 0$。\n- $E_{z}^{\\,n}\\!\\left(i-\\tfrac{1}{2},j+\\tfrac{1}{2}\\right)$: 系数为 $-\\frac{\\Delta t}{\\Delta}(-1) + \\frac{\\Delta t}{\\Delta}(-1) = 0$。\n- $E_{z}^{\\,n}\\!\\left(i-\\tfrac{1}{2},j-\\tfrac{1}{2}\\right)$: 系数为 $-\\frac{\\Delta t}{\\Delta}(1) + \\frac{\\Delta t}{\\Delta}(1) = 0$。\n所有包含 $E_{z}^{\\,n}$ 的项都完全抵消了。这是 Yee 网格的一个基本性质，即离散旋度的离散散度恒等于零。因此，方程简化为：\n$$\n\\Delta\\left(\\nabla_{h}\\cdot\\boldsymbol{B}\\right)^{n+1}\\!(i,j) = \\Delta\\left(\\nabla_{h}\\cdot\\boldsymbol{B}\\right)^{n}\\!(i,j)\n$$\n两边同除以 $\\Delta$，我们得到更新后散度的表达式：\n$$\n\\left(\\nabla_{h}\\cdot\\boldsymbol{B}\\right)^{n+1}\\!(i,j) = \\left(\\nabla_{h}\\cdot\\boldsymbol{B}\\right)^{n}\\!(i,j)\n$$\n这表明，约束输运格式在每个时间步都精确地保持磁场的初始离散散度，这与时间步长 $\\Delta t$、电场 $E_z$ 的形式或时间中心化参数 $\\theta$ 无关。\n\n问题要求计算单步前向欧拉积分后的散度值，这意味着我们需要计算 $\\left(\\nabla_{h}\\cdot\\boldsymbol{B}\\right)^{1}\\!(i,j)$。根据我们推导的关系，这等于初始散度：\n$$\n\\left(\\nabla_{h}\\cdot\\boldsymbol{B}\\right)^{1}\\!(i,j) = \\left(\\nabla_{h}\\cdot\\boldsymbol{B}\\right)^{0}\\!(i,j)\n$$\n问题指出，初始场的构造方式使得初始散度为零。我们可以验证这一说法。从 $n=0$ 时的散度定义开始：\n$$\n\\Delta\\left(\\nabla_{h}\\cdot\\boldsymbol{B}\\right)^{0}\\!(i,j) = B_{x}^{\\,0}\\!\\left(i+\\tfrac{1}{2},j\\right)-B_{x}^{\\,0}\\!\\left(i-\\tfrac{1}{2},j\\right) + B_{y}^{\\,0}\\!\\left(i,j+\\tfrac{1}{2}\\right)-B_{y}^{\\,0}\\!\\left(i,j-\\tfrac{1}{2}\\right)\n$$\n代入由离散矢量势 $A_{z}^{\\,0}$ 定义的 $B_{x}^{\\,0}$ 和 $B_{y}^{\\,0}$：\n$$\n\\Delta\\left(\\nabla_{h}\\cdot\\boldsymbol{B}\\right)^{0}\\!(i,j) = \\frac{A_{z}^{\\,0}\\!\\left(i+\\tfrac{1}{2},j+\\tfrac{1}{2}\\right)-A_{z}^{\\,0}\\!\\left(i+\\tfrac{1}{2},j-\\tfrac{1}{2}\\right)}{\\Delta} - \\frac{A_{z}^{\\,0}\\!\\left(i-\\tfrac{1}{2},j+\\tfrac{1}{2}\\right)-A_{z}^{\\,0}\\!\\left(i-\\tfrac{1}{2},j-\\tfrac{1}{2}\\right)}{\\Delta} \\\\\n- \\frac{A_{z}^{\\,0}\\!\\left(i+\\tfrac{1}{2},j+\\tfrac{1}{2}\\right)-A_{z}^{\\,0}\\!\\left(i-\\tfrac{1}{2},j+\\tfrac{1}{2}\\right)}{\\Delta} - \\left(-\\frac{A_{z}^{\\,0}\\!\\left(i+\\tfrac{1}{2},j-\\tfrac{1}{2}\\right)-A_{z}^{\\,0}\\!\\left(i-\\tfrac{1}{2},j-\\tfrac{1}{2}\\right)}{\\Delta}\\right)\n$$\n两边乘以 $\\Delta$ 并合并各项：\n$$\n\\Delta^2\\left(\\nabla_{h}\\cdot\\boldsymbol{B}\\right)^{0}\\!(i,j) = \\\\\n\\big[ A_{z}^{\\,0}\\!\\left(i+\\tfrac{1}{2},j+\\tfrac{1}{2}\\right)-A_{z}^{\\,0}\\!\\left(i+\\tfrac{1}{2},j-\\tfrac{1}{2}\\right) - A_{z}^{\\,0}\\!\\left(i-\\tfrac{1}{2},j+\\tfrac{1}{2}\\right)+A_{z}^{\\,0}\\!\\left(i-\\tfrac{1}{2},j-\\tfrac{1}{2}\\right) \\big] \\\\\n+ \\big[ -A_{z}^{\\,0}\\!\\left(i+\\tfrac{1}{2},j+\\tfrac{1}{2}\\right)+A_{z}^{\\,0}\\!\\left(i-\\tfrac{1}{2},j+\\tfrac{1}{2}\\right) +A_{z}^{\\,0}\\!\\left(i+\\tfrac{1}{2},j-\\tfrac{1}{2}\\right)-A_{z}^{\\,0}\\!\\left(i-\\tfrac{1}{2},j-\\tfrac{1}{2}\\right) \\big]\n$$\n将各项相加，可以看出它们完全抵消。例如，$A_{z}^{\\,0}\\!\\left(i+\\tfrac{1}{2},j+\\tfrac{1}{2}\\right) - A_{z}^{\\,0}\\!\\left(i+\\tfrac{1}{2},j+\\tfrac{1}{2}\\right) = 0$。这对单元 $(i,j)$ 的所有四个顶点位置都成立。因此，\n$$\n\\Delta^2\\left(\\nabla_{h}\\cdot\\boldsymbol{B}\\right)^{0}\\!(i,j) = 0 \\implies \\left(\\nabla_{h}\\cdot\\boldsymbol{B}\\right)^{0}\\!(i,j) = 0\n$$\n由于初始散度为零，并且 CT 格式在每一步都保持该值不变，因此经过一个前向欧拉步（或任意数量的步数）后，散度也为零。\n\n经过单步后，$\\left(\\nabla_{h}\\cdot\\boldsymbol{B}\\right)^{n+1}\\!(i,j)$ 的值为 $0$。",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "理论上的完美保持需要在实践中得到验证。本练习将通过一个数值基准测试来具体展示约束输运方法的优越性。您将实现并比较一个CT类型的交错网格方案与一个更直观但“朴素”的单元中心方案。这个练习将清晰地揭示，为何在朴素方案中看似合理的近似会导致在维持无散约束上的灾难性失败，而CT方法即使在弯曲时空的背景下也依然稳健。",
            "id": "3469592",
            "problem": "考虑广义相对论 (GR) 的三加一分解中的磁感应约束，其中欧拉观测者测量的磁场表示为 $B^i$，空间度规的行列式为 $\\gamma$。其基本依据是弯曲时空中的麦克斯韦方程组和比安基恒等式，这些方程和恒等式意味着磁场必须满足守恒形式的无散约束\n$$\n\\partial_i\\left(\\sqrt{\\gamma}\\,B^i\\right)=0,\n$$\n其中 $\\sqrt{\\gamma}$ 是空间度规行列式的平方根。在数值相对论和磁流体力学中，约束输运 (CT) 格式被设计用来强制执行该约束的一个离散模拟。\n\n您将需要在一个弱弯曲、随时间变化的背景度规上构建一个基准测试，指定一个精确满足连续谱约束的解析磁场 $B^i(t,\\mathbf{x})$，并比较两种离散散度的计算方法：\n- 一种类似 CT 的、基于交错网格的构造，它通过矢量势 $A_i$ 的离散旋度得到面心通量 $\\tilde{B}^i \\equiv \\sqrt{\\gamma}\\,B^i$，其离散散度在机器精度内为零，以及\n- 一种朴素的、基于胞元中心的构造，它通过相邻胞元中心值的简单平均来近似面心通量，这种方法不会保持离散约束，并会产生截断误差水平的漂移。\n\n请使用以下科学上一致的设置。\n\n1) 域、坐标和网格。\n- 使用周期性的立方体域，坐标为 $(x,y,z)\\in [0,1)\\times[0,1)\\times[0,1)$。\n- 使用均匀的笛卡尔网格，每个维度有 $N$ 个胞元，胞元中心位于\n$$\nx_i=\\frac{i+\\tfrac{1}{2}}{N},\\quad y_j=\\frac{j+\\tfrac{1}{2}}{N},\\quad z_k=\\frac{k+\\tfrac{1}{2}}{N},\n$$\n其中 $i,j,k\\in\\{0,1,\\dots,N-1\\}$，间距为 $\\Delta x=\\Delta y=\\Delta z=1/N$。\n- 使用周期性边界条件。\n\n2) 弱弯曲背景（微扰度规）。\n- 定义一个振幅为 $\\varepsilon$、角频率为 $\\omega$ 的随时间变化的对角度规微扰 $h_{ij}(t,\\mathbf{x})$：\n$$\nh_{xx}(t,\\mathbf{x})=\\sin\\!\\left(2\\pi x\\right)\\sin\\!\\left(\\omega t\\right),\\quad\nh_{yy}(t,\\mathbf{x})=\\sin\\!\\left(2\\pi y\\right)\\sin\\!\\left(\\omega t\\right),\\quad\nh_{zz}(t,\\mathbf{x})=\\sin\\!\\left(2\\pi z\\right)\\sin\\!\\left(\\omega t\\right),\n$$\n并且当 $i\\neq j$ 时 $h_{ij}=0$。空间度规为\n$$\n\\gamma_{ij}(t,\\mathbf{x}) = \\delta_{ij} + \\varepsilon\\, h_{ij}(t,\\mathbf{x}).\n$$\n由于 $\\gamma_{ij}$ 是对角的，其行列式为\n$$\n\\gamma(t,\\mathbf{x})=\\left(1+\\varepsilon\\,h_{xx}\\right)\\left(1+\\varepsilon\\,h_{yy}\\right)\\left(1+\\varepsilon\\,h_{zz}\\right),\n$$\n且 $\\sqrt{\\gamma}$ 是该乘积的正平方根。假设 $\\varepsilon$ 足够小，以至于在给定的时间内 $\\gamma$ 处处保持为正。\n\n3) 解析矢量势和磁场。\n- 选择一个不依赖于时间且仅有 z 分量的矢量势，\n$$\nA_x=0,\\quad A_y=0,\\quad A_z(\\mathbf{x})=\\cos\\!\\left(2\\pi x\\right)\\cos\\!\\left(2\\pi y\\right)\\cos\\!\\left(2\\pi z\\right).\n$$\n- 使用逆变 Levi-Civita 符号密度 $\\tilde{\\epsilon}^{ijk}$（其中 $\\tilde{\\epsilon}^{xyz}=+1$ 及其置换），定义守恒的磁通量密度\n$$\n\\tilde{B}^i(t,\\mathbf{x}) \\equiv \\sqrt{\\gamma}\\,B^i(t,\\mathbf{x}) = \\tilde{\\epsilon}^{ijk}\\,\\partial_j A_k(\\mathbf{x}).\n$$\n由于 $A_i$ 不依赖于时间，等式右侧也不依赖于时间，因此根据偏导数的反对称性和可交换性，可得出连续谱约束：\n$$\n\\partial_i\\left(\\sqrt{\\gamma}\\,B^i\\right) = \\partial_i\\left(\\tilde{\\epsilon}^{ijk}\\,\\partial_j A_k\\right)=0.\n$$\n具体表达式为，\n$$\n\\tilde{B}^x(\\mathbf{x})=\\partial_y A_z = -2\\pi \\sin\\!\\left(2\\pi y\\right)\\cos\\!\\left(2\\pi x\\right)\\cos\\!\\left(2\\pi z\\right),\n$$\n$$\n\\tilde{B}^y(\\mathbf{x})=-\\partial_x A_z = 2\\pi \\sin\\!\\left(2\\pi x\\right)\\cos\\!\\left(2\\pi y\\right)\\cos\\!\\left(2\\pi z\\right),\n$$\n$$\n\\tilde{B}^z(\\mathbf{x})=0.\n$$\n那么解析磁场为\n$$\nB^i(t,\\mathbf{x})=\\frac{\\tilde{B}^i(\\mathbf{x})}{\\sqrt{\\gamma}(t,\\mathbf{x})},\n$$\n并且对于所有 $t$，在连续谱中精确满足 $\\partial_i\\left(\\sqrt{\\gamma}B^i\\right)=0$。\n\n4) 网格上的两种离散散度计算。\n\n4a) 类似 CT 的方法：通过交错 $A_i$ 的离散旋度计算面心通量：\n- 在类 Yee 结构的边上交错排布 $A_i$，并通过离散旋度计算面心通量 $\\tilde{B}^i$：\n  - 将 $A_z$ 放置在沿 z 方向的边中心 $(x_{i+\\tfrac{1}{2}}, y_{j+\\tfrac{1}{2}}, z_k)$ 处，并在此处解析地计算 $A_z$ 的值。\n  - 计算面心通量\n  $$\n  \\tilde{B}^x\\Big|_{(x_{i+\\tfrac{1}{2}},y_j,z_k)} = \\frac{A_z\\big(x_{i+\\tfrac{1}{2}},y_{j+\\tfrac{1}{2}},z_k\\big)-A_z\\big(x_{i+\\tfrac{1}{2}},y_{j-\\tfrac{1}{2}},z_k\\big)}{\\Delta y},\n  $$\n  $$\n  \\tilde{B}^y\\Big|_{(x_i,y_{j+\\tfrac{1}{2}},z_k)} = -\\,\\frac{A_z\\big(x_{i+\\tfrac{1}{2}},y_{j+\\tfrac{1}{2}},z_k\\big)-A_z\\big(x_{i-\\tfrac{1}{2}},y_{j+\\tfrac{1}{2}},z_k\\big)}{\\Delta x},\n  $$\n  且 $\\tilde{B}^z=0$。\n- 将胞元中心 $(x_i,y_j,z_k)$ 处的离散散度定义为有限体积的通量差\n  $$\n  \\left[\\nabla\\cdot\\tilde{\\mathbf{B}}\\right]_{i,j,k} \\equiv \\frac{\\tilde{B}^x_{i,j,k}-\\tilde{B}^x_{i-1,j,k}}{\\Delta x}+\\frac{\\tilde{B}^y_{i,j,k}-\\tilde{B}^y_{i,j-1,k}}{\\Delta y}+\\frac{\\tilde{B}^z_{i,j,k}-\\tilde{B}^z_{i,j,k-1}}{\\Delta z},\n  $$\n  使用周期性索引。数值上证明此离散散度在舍入误差范围内为零，因为它是离散旋度的离散散度。\n\n4b) 朴素的胞元中心重构法：\n- 通过在胞元中心计算 $\\tilde{B}^i(\\mathbf{x})$ 并除以胞元中心的 $\\sqrt{\\gamma}(t,\\mathbf{x})$ 来计算胞元中心的解析磁场 $B^i_{i,j,k}(t)$：\n  $$\n  B^i_{i,j,k}(t)=\\frac{\\tilde{B}^i(x_i,y_j,z_k)}{\\sqrt{\\gamma}(t,x_i,y_j,z_k)}.\n  $$\n- 通过相邻胞元中心值的简单平均来近似面心通量：\n  $$\n  \\tilde{B}^x_{\\text{naive},\\,i,j,k} \\equiv \\left[\\frac{\\sqrt{\\gamma}_{i,j,k}+\\sqrt{\\gamma}_{i+1,j,k}}{2}\\right]\\left[\\frac{B^x_{i,j,k}+B^x_{i+1,j,k}}{2}\\right],\n  $$\n  $$\n  \\tilde{B}^y_{\\text{naive},\\,i,j,k} \\equiv \\left[\\frac{\\sqrt{\\gamma}_{i,j,k}+\\sqrt{\\gamma}_{i,j+1,k}}{2}\\right]\\left[\\frac{B^y_{i,j,k}+B^y_{i,j+1,k}}{2}\\right],\n  $$\n  $$\n  \\tilde{B}^z_{\\text{naive},\\,i,j,k} \\equiv \\left[\\frac{\\sqrt{\\gamma}_{i,j,k}+\\sqrt{\\gamma}_{i,j,k+1}}{2}\\right]\\left[\\frac{B^z_{i,j,k}+B^z_{i,j,k+1}}{2}\\right],\n  $$\n  使用周期性索引。\n- 使用这些朴素的面心通量计算与 4a 中相同的离散散度算子。这个朴素散度不会精确为零，并且会表现出依赖于 $\\Delta x$ 和 $\\sqrt{\\gamma}$ 空间变化的截断误差。\n\n5) 误差度量。\n- 对于每种格式，计算所有胞元上离散散度的均方根 (RMS) 值，\n$$\nE \\equiv \\sqrt{\\frac{1}{N^3}\\sum_{i,j,k}\\left(\\left[\\nabla\\cdot\\tilde{\\mathbf{B}}\\right]_{i,j,k}\\right)^2}.\n$$\n\n6) 测试套件。\n为以下参数集 $(N,\\varepsilon,\\omega,t)$ 评估 RMS 误差：\n- 情况 A (理想路径): $(N=\\;16,\\;\\varepsilon=\\;0.05,\\;\\omega=\\;2.0,\\;t=\\;0.30)$。\n- 情况 B (微扰在时间上消失的边界): $(N=\\;16,\\;\\varepsilon=\\;0.05,\\;\\omega=\\;2.0,\\;t=\\;0.00)$。\n- 情况 C (更强曲率下的网格加密): $(N=\\;32,\\;\\varepsilon=\\;0.10,\\;\\omega=\\;2.0,\\;t=\\;0.30)$。\n- 情况 D (不同的频率和时间): $(N=\\;24,\\;\\varepsilon=\\;0.10,\\;\\omega=\\;3.0,\\;t=\\;0.73)$。\n\n对于每种情况，计算两个浮点数：$E_{\\mathrm{CT}}$ 用于类似 CT 的交错离散旋度，以及 $E_{\\mathrm{naive}}$ 用于朴素的胞元中心重构。\n\n7) 要求的最终输出格式。\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，顺序如下\n$$\n\\left[E_{\\mathrm{CT}}^{\\mathrm{A}},\\,E_{\\mathrm{naive}}^{\\mathrm{A}},\\,E_{\\mathrm{CT}}^{\\mathrm{B}},\\,E_{\\mathrm{naive}}^{\\mathrm{B}},\\,E_{\\mathrm{CT}}^{\\mathrm{C}},\\,E_{\\mathrm{naive}}^{\\mathrm{C}},\\,E_{\\mathrm{CT}}^{\\mathrm{D}},\\,E_{\\mathrm{naive}}^{\\mathrm{D}}\\right],\n$$\n每个浮点数以科学记数法打印，精确到 10 位有效数字（例如，$1.234567890\\text{e-}04$）。由于所有量在构造上都是无量纲的，因此不需要单位。根据三角函数参数的定义，角度以弧度为单位。本问题中不使用百分比。\n\n您的任务是在一个独立的、可运行的程序中实现这整个过程，该程序执行所有计算并以指定的格式精确打印最终列表。不允许用户输入、外部文件或网络访问。",
            "solution": "所述问题是有效的。它在科学上基于数值相对论和磁流体力学的原理，定义清晰完整，表述客观，是一个适定问题。我们将着手构建解决方案。\n\n这个问题的核心在于数值上强制执行磁场的无散约束 $\\partial_i(\\sqrt{\\gamma}\\,B^i)=0$，这是从弯曲时空中的麦克斯韦方程组推导出的一个基本定律。在任何数值模拟中都必须维持这一约束，以避免非物理现象，例如磁单极子的产生。我们将实现并比较两种不同的数值格式，用于计算磁通量密度 $\\tilde{\\mathbf{B}} \\equiv \\sqrt{\\gamma}\\,\\mathbf{B}$ 的离散散度。\n\n该问题提供了一个在周期性域上的特定解析设置，具有随时间变化的弱弯曲度规。磁场由矢量势 $A_k$ 导出，这保证了在连续谱中无散约束是精确满足的。守恒通量密度为 $\\tilde{B}^i = \\tilde{\\epsilon}^{ijk}\\,\\partial_j A_k$。其散度为 $\\partial_i \\tilde{B}^i = \\partial_i (\\tilde{\\epsilon}^{ijk}\\,\\partial_j A_k)$，由于 $\\tilde{\\epsilon}^{ijk}$ 的反对称性和偏导数的可交换性 $\\partial_i \\partial_j = \\partial_j \\partial_i$，该散度恒为零。我们的任务是检验这两种不同的数值格式在离散层面上对这一性质的保持程度如何。\n\n我们将使用一个包含 $N^3$ 个胞元的均匀笛卡尔网格，网格间距为 $\\Delta x = \\Delta y = \\Delta z = 1/N$。\n\n**1. 约束输运 (CT) 方法**\n\n第一种方法是“约束输运” (CT) 格式，也称为 Yee 交错网格方法。CT 方法的核心原理是以一种能在离散层面上保持连续谱微积分中关键矢量恒等式的方式来离散化微分算子。在这里，我们利用恒等式 $\\nabla \\cdot (\\nabla \\times \\mathbf{A}) = 0$。通过将磁场定义为离散矢量势的离散旋度，其离散散度在数学上将为零，误差仅达到机器浮点精度。\n\n问题指定 $A_k = (0, 0, A_z)$，其中 $A_z(\\mathbf{x})=\\cos(2\\pi x)\\cos(2\\pi y)\\cos(2\\pi z)$。守恒通量为 $\\tilde{B}^x = \\partial_y A_z$，$\\tilde{B}^y = -\\partial_x A_z$ 和 $\\tilde{B}^z = 0$。\n\n为实现这一点，我们在网格上离散化 $A_z$。遵循类 Yee 交错排布，我们在网格胞元沿 z 方向的边中心计算 $A_z$ 的值。对于索引为 $(i,j,k)$ 的胞元，这些边中心位于坐标 $(x_{i+1/2}, y_{j+1/2}, z_k)$ 处。我们将此位置的 $A_z$ 值表示为 $A_z(i+1/2, j+1/2, k)$。\n\n然后使用二阶中心有限差分计算面心通量，这相当于一个离散旋度算子：\n- 通量的 x 分量 $\\tilde{B}^x$ 位于 x 面的中心，位置在 $(x_{i+1/2}, y_j, z_k)$。我们这样计算它：\n$$\n\\tilde{B}^x_{i,j,k} \\equiv \\tilde{B}^x\\Big|_{(x_{i+1/2}, y_j, z_k)} = \\frac{A_z(i+1/2, j+1/2, k) - A_z(i+1/2, j-1/2, k)}{\\Delta y}\n$$\n- y 分量 $\\tilde{B}^y$ 位于 y 面的中心，位置在 $(x_i, y_{j+1/2}, z_k)$：\n$$\n\\tilde{B}^y_{i,j,k} \\equiv \\tilde{B}^y\\Big|_{(x_i, y_{j+1/2}, z_k)} = -\\frac{A_z(i+1/2, j+1/2, k) - A_z(i-1/2, j+1/2, k)}{\\Delta x}\n$$\n- $\\tilde{B}^z$ 处处为零。所采用的索引记法是常见的，其中 $\\tilde{B}^x_{i,j,k}$ 表示位于 $x_{i+1/2}$ 面上的通量，依此类推。\n\n离散散度在胞元中心 $(x_i, y_j, z_k)$ 处使用有限体积法计算，即对面心通量进行中心差分：\n$$\n\\left[\\nabla\\cdot\\tilde{\\mathbf{B}}\\right]_{i,j,k} = \\frac{\\tilde{B}^x_{i,j,k} - \\tilde{B}^x_{i-1,j,k}}{\\Delta x} + \\frac{\\tilde{B}^y_{i,j,k} - \\tilde{B}^y_{i,j-1,k}}{\\Delta y} + 0\n$$\n如果我们将离散通量的定义代入此表达式，我们会发现各项完全抵消。第一项变为：\n$$\n\\frac{1}{\\Delta x \\Delta y} \\left[ \\left( A_z(i+\\frac{1}{2}, j+\\frac{1}{2}, k) - A_z(i+\\frac{1}{2}, j-\\frac{1}{2}, k) \\right) - \\left( A_z(i-\\frac{1}{2}, j+\\frac{1}{2}, k) - A_z(i-\\frac{1}{2}, j-\\frac{1}{2}, k) \\right) \\right]\n$$\n第二项为：\n$$\n-\\frac{1}{\\Delta y \\Delta x} \\left[ \\left( A_z(i+\\frac{1}{2}, j+\\frac{1}{2}, k) - A_z(i-\\frac{1}{2}, j+\\frac{1}{2}, k) \\right) - \\left( A_z(i+\\frac{1}{2}, j-\\frac{1}{2}, k) - A_z(i-\\frac{1}{2}, j-\\frac{1}{2}, k) \\right) \\right]\n$$\n重新排列各项表明这两个表达式大小相等，方向相反。它们的和恒为零。因此，离散旋度的离散散度为零。由此产生的误差 $E_{\\mathrm{CT}}$ 仅由浮点舍入误差引起，预计将处于机器精度的量级。这展示了 CT 方法的强大之处。请注意，度规 $\\gamma_{ij}$ 根本不参与此计算，因为我们处理的是守恒量 $\\tilde{B}^i$，它是通过 $A_k$ 的旋度独立于度规定义的。\n\n**2. 朴素的胞元中心方法**\n\n第二种方法是一种更直接但鲁棒性较差的方法。它从计算所有在胞元中心的值开始。\n- 首先，我们计算胞元中心的物理磁场 $B^i_{i,j,k} = B^i(t, x_i, y_j, z_k)$。这包括：\n  1. 计算解析的守恒通量密度 $\\tilde{B}^i(x_i, y_j, z_k)$。\n  2. 计算度规分量 $h_{ll}(t, x_i, y_j, z_k)$，然后计算 $\\sqrt{\\gamma(t, x_i, y_j, z_k)}$。\n  3. 相除得到 $B^i_{i,j,k} = \\tilde{B}^i(x_i,y_j,z_k) / \\sqrt{\\gamma(t, x_i,y_j,z_k)}$。\n\n- 接下来，我们需要在胞元面上重构通量。朴素格式通过分别对来自相邻胞元的度规因子 $\\sqrt{\\gamma}$ 和场分量 $B^i$ 进行平均来实现这一点。对于通过 $x$ 面（位于 $x_{i+1/2}$）的通量，这是：\n$$\n\\tilde{B}^x_{\\text{naive},\\,i,j,k} = \\left[\\frac{\\sqrt{\\gamma}_{i,j,k}+\\sqrt{\\gamma}_{i+1,j,k}}{2}\\right]\\left[\\frac{B^x_{i,j,k}+B^x_{i+1,j,k}}{2}\\right]\n$$\n其他分量也类似。\n\n- 最后，我们使用与之前相同的有限体积公式计算离散散度，但使用的是这些朴素构造的通量。\n\n这种方法会引入误差。平均值的乘积不等于乘积的平均值。面心通量 $(\\sqrt{\\gamma} B^x)|_{i+1/2}$ 的一个更好的二阶近似是 $\\frac{1}{2}((\\sqrt{\\gamma} B^x)_i + (\\sqrt{\\gamma} B^x)_{i+1})$。所选的格式引入了一个额外的误差项，该项与 $(\\sqrt{\\gamma}_{i+1}-\\sqrt{\\gamma}_i)(B^x_{i+1}-B^x_i)$ 成正比，其阶数为 $O(\\Delta x^2)$。当这些通量近似值用于离散散度公式时，各项不再抵消。由此产生的离散散度不为零，代表在格式的截断误差水平上产生了磁单极子源。这个误差 $E_{\\mathrm{naive}}$ 将与网格间距成正比（具体来说，对于这个二阶格式是 $O(\\Delta x^2)$），并与 $\\sqrt{\\gamma}$ 和 $B^i$ 的空间变化幅度成正比。我们预计 $E_{\\mathrm{naive}}$ 将显著大于 $E_{\\mathrm{CT}}$，并且会随着网格加密而减小。\n\n**3. 实现与误差计算**\n\n对于每个测试用例 $(N,\\varepsilon,\\omega,t)$，实现将遵循以下步骤。我们将使用 `numpy` 进行高效的数组计算，并用 `np.roll` 处理周期性边界条件。\n- 对于 CT 方法，我们为 $A_z$ 生成一个交错网格，通过有限差分计算面心通量 $\\tilde{B}^i$，然后计算该场的散度。\n- 对于朴素方法，我们生成一个胞元中心网格，在其上计算所有量（$B^i$, $\\sqrt{\\gamma}$），通过平均重构面通量，然后计算散度。\n- 对于这两种格式，我们计算所得离散散度场在所有 $N^3$ 个胞元上的均方根 (RMS) 值，以量化误差。\n\n最终输出将是每个测试用例的这些 RMS 误差 $E_{\\mathrm{CT}}$ 和 $E_{\\mathrm{naive}}$ 的列表，并按要求格式化。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the benchmark problem for constraint transport methods.\n    \n    This function iterates through a set of predefined test cases. For each case, it computes\n    the discrete magnetic field divergence using two different numerical schemes:\n    1. A Constraint-Transport (CT) like staggered-grid method.\n    2. A naive cell-centered averaging method.\n    \n    It then calculates the root-mean-square (RMS) error of the divergence for each scheme\n    and prints the results in a comma-separated list as specified.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each tuple is (N, epsilon, omega, t)\n    test_cases = [\n        (16, 0.05, 2.0, 0.30),  # Case A\n        (16, 0.05, 2.0, 0.00),  # Case B\n        (32, 0.10, 2.0, 0.30),  # Case C\n        (24, 0.10, 3.0, 0.73),  # Case D\n    ]\n\n    results = []\n    for N, epsilon, omega, t in test_cases:\n        # ---- Grid setup ----\n        dx = dy = dz = 1.0 / N\n        \n        # ---- Analytic function definitions ----\n        def A_z(x, y, z):\n            return np.cos(2 * np.pi * x) * np.cos(2 * np.pi * y) * np.cos(2 * np.pi * z)\n\n        def tilde_B_x(x, y, z):\n            return -2 * np.pi * np.sin(2 * np.pi * y) * np.cos(2 * np.pi * x) * np.cos(2 * np.pi * z)\n\n        def tilde_B_y(x, y, z):\n            return 2 * np.pi * np.sin(2 * np.pi * x) * np.cos(2 * np.pi * y) * np.cos(2 * np.pi * z)\n\n        def h_pert(t_val, omega_val, coord_val):\n            return np.sin(2 * np.pi * coord_val) * np.sin(omega_val * t_val)\n\n        # ---- 1) CT-like, face-centered fluxes from discrete curl of staggered A_i ----\n\n        # Grid for A_z (z-edge centers: x_{i+1/2}, y_{j+1/2}, z_k)\n        i_idx, j_idx, k_idx = np.arange(N), np.arange(N), np.arange(N)\n        z_edge_x_coords = (i_idx + 0.5) / N  # Actually x_i, for x_{i+1/2} we average later\n        z_edge_y_coords = (j_idx + 0.5) / N  # Actually y_j\n        z_edge_z_coords = (k_idx + 0.5) / N\n        \n        # Correct coordinates for A_z at (i+1/2, j+1/2, k)\n        x_Az_coords = (i_idx + 1.0) / N\n        y_Az_coords = (j_idx + 1.0) / N\n        z_Az_coords = (k_idx + 0.5) / N\n        x_az_mg, y_az_mg, z_az_mg = np.meshgrid(x_Az_coords, y_Az_coords, z_Az_coords, indexing='ij')\n\n        A_z_staggered = A_z(x_az_mg, y_az_mg, z_az_mg)\n\n        # Compute face-centered fluxes via discrete curl\n        # B_tilde_x at (i+1/2, j, k)\n        A_z_for_Bx = 0.5 * (A_z_staggered + np.roll(A_z_staggered, 1, axis=0))\n        B_tilde_x_ct = (A_z_for_Bx - np.roll(A_z_for_Bx, 1, axis=1)) / dy\n        \n        # B_tilde_y at (i, j+1/2, k)\n        A_z_for_By = 0.5 * (A_z_staggered + np.roll(A_z_staggered, 1, axis=1))\n        B_tilde_y_ct = -(A_z_for_By - np.roll(A_z_for_By, 1, axis=0)) / dx\n\n        # The problem statement's discrete curl is slightly different, let's use it exactly\n        # A_z(i+1/2, j+1/2, k) - A_z(i+1/2, j-1/2, k) for Bx\n        # For Bx at (i+1/2, j, k), we need A_z at (i+1/2, j+1/2, k) and (i+1/2, j-1/2, k)\n        x_bxf_coords = (i_idx + 1.0) / N\n        y_bxf_coords = (j_idx) / N\n        z_bxf_coords = (k_idx + 0.5) / N\n        x_bxf_mg, y_bxf_mg, z_bxf_mg = np.meshgrid(x_bxf_coords, y_bxf_coords, z_bxf_coords, indexing='ij')\n        A_z_jp_Bx = A_z(x_bxf_mg, y_bxf_mg + 0.5/N, z_bxf_mg)\n        A_z_jm_Bx = A_z(x_bxf_mg, y_bxf_mg - 0.5/N, z_bxf_mg)\n        B_tilde_x_ct = (A_z_jp_Bx - A_z_jm_Bx) / dy\n        \n        # For By at (i, j+1/2, k), we need A_z at (i+1/2, j+1/2, k) and (i-1/2, j+1/2, k)\n        x_byf_coords = (i_idx) / N\n        y_byf_coords = (j_idx + 1.0) / N\n        z_byf_coords = (k_idx + 0.5) / N\n        x_byf_mg, y_byf_mg, z_byf_mg = np.meshgrid(x_byf_coords, y_byf_coords, z_byf_coords, indexing='ij')\n        A_z_ip_By = A_z(x_byf_mg + 0.5/N, y_byf_mg, z_byf_mg)\n        A_z_im_By = A_z(x_byf_mg - 0.5/N, y_byf_mg, z_byf_mg)\n        B_tilde_y_ct = -(A_z_ip_By - A_z_im_By) / dx\n        \n        # Compute discrete divergence at cell centers (i, j, k)\n        # Needs Bx at i+1/2 and i-1/2. Bx is defined at i+1/2. So Bx_{i,j,k} is at i+1/2\n        div_x_ct = (B_tilde_x_ct - np.roll(B_tilde_x_ct, 1, axis=0)) / dx\n        # Needs By at j+1/2 and j-1/2. By is defined at j+1/2.\n        div_y_ct = (B_tilde_y_ct - np.roll(B_tilde_y_ct, 1, axis=1)) / dy\n        div_B_ct = div_x_ct + div_y_ct\n\n        E_ct = np.sqrt(np.mean(div_B_ct**2))\n        results.append(f\"{E_ct:.10e}\")\n        \n        # ---- 2) Naive, cell-centered reconstruction ----\n\n        # Grid for cell-centered quantities (x_i, y_j, z_k)\n        cell_x_coords = (i_idx + 0.5) / N\n        cell_y_coords = (j_idx + 0.5) / N\n        cell_z_coords = (k_idx + 0.5) / N\n        x_ccc, y_ccc, z_ccc = np.meshgrid(cell_x_coords, cell_y_coords, cell_z_coords, indexing='ij')\n\n        h_xx_ccc = h_pert(t, omega, x_ccc)\n        h_yy_ccc = h_pert(t, omega, y_ccc)\n        h_zz_ccc = h_pert(t, omega, z_ccc)\n        \n        sqrt_gamma_ccc = np.sqrt(\n            (1 + epsilon * h_xx_ccc) *\n            (1 + epsilon * h_yy_ccc) *\n            (1 + epsilon * h_zz_ccc)\n        )\n        \n        tilde_B_x_ccc = tilde_B_x(x_ccc, y_ccc, z_ccc)\n        tilde_B_y_ccc = tilde_B_y(x_ccc, y_ccc, z_ccc)\n        \n        B_x_ccc = tilde_B_x_ccc / sqrt_gamma_ccc\n        B_y_ccc = tilde_B_y_ccc / sqrt_gamma_ccc\n        # B_z_ccc is zero.\n\n        # Approximate face-centered fluxes by simple averaging\n        # x-fluxes at (i+1/2, j, k)\n        sqrt_gamma_avg_x = 0.5 * (sqrt_gamma_ccc + np.roll(sqrt_gamma_ccc, -1, axis=0))\n        B_x_avg = 0.5 * (B_x_ccc + np.roll(B_x_ccc, -1, axis=0))\n        B_tilde_x_naive = sqrt_gamma_avg_x * B_x_avg\n        \n        # y-fluxes at (i, j+1/2, k)\n        sqrt_gamma_avg_y = 0.5 * (sqrt_gamma_ccc + np.roll(sqrt_gamma_ccc, -1, axis=1))\n        B_y_avg = 0.5 * (B_y_ccc + np.roll(B_y_ccc, -1, axis=1))\n        B_tilde_y_naive = sqrt_gamma_avg_y * B_y_avg\n\n        # z-fluxes are zero.\n\n        # Compute discrete divergence using naive fluxes\n        div_x_naive = (B_tilde_x_naive - np.roll(B_tilde_x_naive, 1, axis=0)) / dx\n        div_y_naive = (B_tilde_y_naive - np.roll(B_tilde_y_naive, 1, axis=1)) / dy\n        div_B_naive = div_x_naive + div_y_naive\n        \n        E_naive = np.sqrt(np.mean(div_B_naive**2))\n        results.append(f\"{E_naive:.10e}\")\n        \n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在理解了CT方法的“为何”与“如何”之后，最后一个练习将其应用于数值相对论中的一个真实场景：黑洞的切除边界。您的任务是正确计算边界上的电场，这是确保演化稳定性的关键一步。这个练习展示了抽象的CT框架如何与前沿模拟中的物理边界条件相结合，体现了其在实际研究中的应用价值。",
            "id": "3469553",
            "problem": "在广义相对论磁流体力学 (GRMHD) 的背景下，考虑时空的 $3+1$ 分解，请思考从麦克斯韦方程组和理想磁流体力学 (MHD) 条件推导出的磁感应方程。对于稠密化磁场 $ \\sqrt{\\gamma}\\,B^{i} $，其守恒形式的磁感应方程与约束输运 (CT) 方法一致，该方法通过使用边心电场演化面心磁通量来保持离散的无散度约束 $ \\nabla \\cdot (\\sqrt{\\gamma}\\, \\mathbf{B}) = 0 $。在理想 MHD 中，欧拉（正常）观测者测得的电场由 $ \\mathbf{E} = - \\mathbf{v} \\times \\mathbf{B} $ 给出，其中 $ \\mathbf{v} $ 是流体的三维速度。\n\n一个黑洞切除边界与位于 $ x = x_{b} $ 的坐标面对齐。为了保持稳定性并防止非物理性的物质从切除区域流入计算域，通过将内部速度投影到边界的切平面上来施加无流入边界条件：$ \\mathbf{v}_{\\mathrm{t}} = \\mathbf{v} - (\\mathbf{v}\\cdot\\mathbf{n})\\,\\mathbf{n} $，其中 $ \\mathbf{n} $ 是切除边界的向外单位法向量。\n\n假设在边界处有一个局部正交归一四分体，使得直减函数为 $ \\alpha = 1 $，移位矢量为 $ \\beta^{i} = 0 $，空间度规为 $ \\gamma_{ij} = \\delta_{ij} $。考虑位于 $ x = x_{b} $ 的边界面，其单位法向量为 $ \\mathbf{n} = (1, 0, 0) $。该面的一个边平行于 $ z $ 轴；在此边上，CT 更新需要根据理想 MHD 关系式从切向速度计算出的边心电场分量 $ E_{z} $。\n\n给定边界边上的内部重构原始场为\n$ \\mathbf{v} = (0.6,\\,-0.2,\\,0.3) $ 和 $ \\mathbf{B} = (0.4,\\,0.5,\\,-0.1) $，\n请计算约束输运方案将使用的边界边心电场分量 $ E_{z} $，计算时需通过上述定义的 $ \\mathbf{v} $ 的切向投影来强制执行无流入条件，并使用理想 MHD 关系式 $ \\mathbf{E} = - \\mathbf{v}_{\\mathrm{t}} \\times \\mathbf{B} $。\n\n请以代码单位表示您对 $ E_{z} $ 的最终答案，并将答案四舍五入到四位有效数字。",
            "solution": "问题陈述已经过严格评估，并被确定为有效。它在广义相对论磁流体动力学 (GRMHD) 的既定框架以及求解相关方程（如约束输运 (CT)）的数值方法中具有科学依据。该问题是适定的、客观的且自洽的，提供了计算唯一、有意义解所需的所有数据和关系。不存在矛盾、歧义或违反物理原理的情况。\n\n任务是计算黑洞切除边界上某个边处的电场 $z$ 分量 $E_{z}$。这个量是磁场约束输运更新所必需的。计算必须通过仅使用流体速度的切向分量来强制执行无流入边界条件。\n\n给定条件如下：\n局部时空度规实际上是闵可夫斯基度规：直减函数 $\\alpha = 1$，移位矢量 $\\beta^{i} = 0$，空间度规 $\\gamma_{ij} = \\delta_{ij}$。\n边界是一个坐标面，其向外单位法向量为 $\\mathbf{n} = (1, 0, 0)$。\n边界边上重构的原始流体速度为 $\\mathbf{v} = (0.6, -0.2, 0.3)$。\n边界边上重构的磁场为 $\\mathbf{B} = (0.4, 0.5, -0.1)$。\n\n边界条件要求使用速度的切向投影 $\\mathbf{v}_{\\mathrm{t}}$，其定义为：\n$$\n\\mathbf{v}_{\\mathrm{t}} = \\mathbf{v} - (\\mathbf{v}\\cdot\\mathbf{n})\\,\\mathbf{n}\n$$\n电场由使用该切向速度的理想 MHD 条件确定：\n$$\n\\mathbf{E} = - \\mathbf{v}_{\\mathrm{t}} \\times \\mathbf{B}\n$$\n\n首先，我们计算切向速度矢量 $\\mathbf{v}_{\\mathrm{t}}$。速度 $\\mathbf{v}$ 和法向量 $\\mathbf{n}$ 的点积是：\n$$\n\\mathbf{v} \\cdot \\mathbf{n} = (v_x, v_y, v_z) \\cdot (n_x, n_y, n_z) = (0.6)(1) + (-0.2)(0) + (0.3)(0) = 0.6\n$$\n这个分量 $v_n = 0.6$ 代表法向速度，其值为正，表示流体正流出计算域。切向投影移除了这个法向分量。\n$$\n(\\mathbf{v} \\cdot \\mathbf{n})\\mathbf{n} = 0.6 \\, (1, 0, 0) = (0.6, 0, 0)\n$$\n现在，我们从原始速度矢量中减去这个法向分量，以获得切向速度：\n$$\n\\mathbf{v}_{\\mathrm{t}} = \\mathbf{v} - (\\mathbf{v} \\cdot \\mathbf{n})\\mathbf{n} = (0.6, -0.2, 0.3) - (0.6, 0, 0) = (0, -0.2, 0.3)\n$$\n如要求的那样，所得矢量 $\\mathbf{v}_{\\mathrm{t}}$ 完全与边界面相切（其 $x$ 分量为零）。\n\n接下来，我们通过计算 $\\mathbf{v}_{\\mathrm{t}}$ 和 $\\mathbf{B}$ 的叉积来计算电场 $\\mathbf{E}$。\n$$\n\\mathbf{E} = - (\\mathbf{v}_{\\mathrm{t}} \\times \\mathbf{B}) = - \\left| \\begin{matrix} \\mathbf{\\hat{x}} & \\mathbf{\\hat{y}} & \\mathbf{\\hat{z}} \\\\ v_{tx} & v_{ty} & v_{tz} \\\\ B_x & B_y & B_z \\end{matrix} \\right| = - \\left| \\begin{matrix} \\mathbf{\\hat{x}} & \\mathbf{\\hat{y}} & \\mathbf{\\hat{z}} \\\\ 0 & -0.2 & 0.3 \\\\ 0.4 & 0.5 & -0.1 \\end{matrix} \\right|\n$$\n问题要求计算 $z$ 分量 $E_z$。叉积 $\\mathbf{v}_{\\mathrm{t}} \\times \\mathbf{B}$ 的 $z$ 分量由 $(v_{tx}B_y - v_{ty}B_x)$ 给出。\n$$\n(\\mathbf{v}_{\\mathrm{t}} \\times \\mathbf{B})_z = v_{tx}B_y - v_{ty}B_x = (0)(0.5) - (-0.2)(0.4) = 0 - (-0.08) = 0.08\n$$\n电场的 $z$ 分量是这个值的负数：\n$$\nE_z = -(\\mathbf{v}_{\\mathrm{t}} \\times \\mathbf{B})_z = -0.08\n$$\n问题要求答案四舍五入到四位有效数字。计算出的值恰好是 $-0.08$。为了用四位有效数字表示它，我们必须添加后缀零。\n因此，该值为 $-0.08000$。",
            "answer": "$$\\boxed{-0.08000}$$"
        }
    ]
}