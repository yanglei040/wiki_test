{
    "hands_on_practices": [
        {
            "introduction": "要掌握双曲型偏微分方程组的适定性，关键在于理解其特征结构。本练习将引导你分析广义和谐坐标（GH）系统，这是一种在数值相对论中广泛使用的爱因斯坦方程表述。通过对该系统进行线性化并计算其特征速度，你将能确定信息在时空中的传播速度，这是验证一个表述在物理上与数学上自洽性的第一步。",
            "id": "3498060",
            "problem": "考虑以广义和谐（GH）形式写出的真空爱因斯坦方程，其中坐标满足广义和谐条件，规范源函数 $H_{a}(x)$ 的规定独立于度规。令 $g_{ab}$ 为时空度规，$\\eta_{ab}$ 表示闵可夫斯基度规。在具有闵可夫斯基直减率 $\\alpha = 1$ 和移位矢量 $\\beta^{i} = 0$ 的 $3+1$ 分解中，选择一个与 $\\partial_{t}$ 对齐的单位类时法向 $n^{a}$，并为微扰 $g_{ab} = \\eta_{ab} + \\varepsilon \\psi_{ab}$（其中 $\\varepsilon$ 很小）引入一阶变量：定义 $\\psi_{ab}$，$\\Pi_{ab} := -n^{c} \\partial_{c} \\psi_{ab}$ 和 $\\Phi_{iab} := \\partial_{i} \\psi_{ab}$。假设一个常数规范源 $H_{a} = \\kappa n_{a}$（其中 $\\kappa$ 为常数），并包含一个常数约束阻尼参数 $\\gamma_{0}$；两者都独立于动力学场。\n\n从 GH 形式在主部层面上为每个度规分量产生一个准线性波动方程这一事实出发，对闵可夫斯基空间进行线性化，并提取控制 $(\\psi_{ab}, \\Pi_{ab}, \\Phi_{iab})$ 的一阶系统的主部。考虑沿单位空间余矢量 $s_{i}$ 方向的传播，并构建作用于简化变量三元组 $(\\psi_{ab}, \\Pi_{ab}, \\Phi_{sab})$ 的主符号，其中 $\\Phi_{sab} := s^{i} \\Phi_{iab}$。通过找到相应主符号的特征值，计算相对于类时法向 $n^{a}$ 的特征速度。然后，确定谱半径，其定义为这些特征速度中的最大绝对值。\n\n提供谱半径的最终答案，形式为单个精确数。不需要四舍五入，最终答案中也不应包含任何单位。",
            "solution": "该问题陈述已经过验证，被认为是有效的。它在科学上基于广义相对论和偏微分方程的原理，是适定的，有足够的信息得到唯一解，并以客观、正式的语言表述。所有给定条件都是一致的，并且与数值相对论形式的适定性研究相关。\n\n问题要求计算线性化的广义和谐（GH）系统的特征速度的谱半径。正如问题陈述所指引的，出发点是 GH 形式的主部是针对度规 $g_{ab}$ 的每个分量的一组准线性波动方程。\n\n在闵可夫斯基背景 $g_{ab} = \\eta_{ab} + \\varepsilon \\psi_{ab}$ 周围进行线性化后，GH 形式中真空爱因斯坦方程的主部变成了一组关于度规微扰 $\\psi_{ab}$ 的解耦线性波动方程：\n$$ \\eta^{cd} \\partial_c \\partial_d \\psi_{ab} = 0 $$\n这里，$\\eta^{cd}$ 是逆闵可夫斯基度规。在指定的具有直减率 $\\alpha=1$ 和移位矢量 $\\beta^i=0$ 的 $3+1$ 分解中，坐标是闵可夫斯基的，因此 $\\eta^{cd} = \\text{diag}(-1, 1, 1, 1)$。$\\psi_{ab}$ 的每个分量的波动方程为：\n$$ -\\partial_t^2 \\psi_{ab} + \\delta^{ij} \\partial_i \\partial_j \\psi_{ab} = 0 $$\n$$ \\implies \\partial_t^2 \\psi_{ab} = \\delta^{ij} \\partial_i \\partial_j \\psi_{ab} $$\n规范源函数 $H_a = \\kappa n_a$ 和约束阻尼参数 $\\gamma_0$ 被指定为常数且独立于动力学场。在线性化过程中，这些项影响演化方程的源项或低阶导数，但它们不改变由二阶导数构成的主部。因此，它们不影响系统的特征速度。\n\n为分析特征速度，我们使用所提供的变量将这个二阶系统转换为一阶系统：\n1.  度规微扰 $\\psi_{ab}$。\n2.  $\\Pi_{ab} := -n^c \\partial_c \\psi_{ab} = -\\partial_t \\psi_{ab}$ （因为 $n^c$ 与 $\\partial_t$ 对齐）。\n3.  $\\Phi_{iab} := \\partial_i \\psi_{ab}$。\n\n根据这些定义，我们可以写出一个关于时间的一阶系统。第一个演化方程直接来自 $\\Pi_{ab}$ 的定义：\n$$ \\partial_t \\psi_{ab} = -\\Pi_{ab} $$\n第二个演化方程由波动方程和 $\\Pi_{ab}$ 的定义导出：\n$$ \\partial_t \\Pi_{ab} = -\\partial_t^2 \\psi_{ab} = -\\delta^{ij} \\partial_i \\partial_j \\psi_{ab} $$\n使用 $\\Phi_{iab}$ 的定义，这变为：\n$$ \\partial_t \\Pi_{ab} = -\\delta^{ij} \\partial_i (\\partial_j \\psi_{ab}) = -\\delta^{ij} \\partial_i \\Phi_{jab} $$\n第三个演化方程是关于 $\\Phi_{iab}$ 的。假设场具有足够的光滑性，我们可以交换偏导数的次序：\n$$ \\partial_t \\Phi_{iab} = \\partial_t (\\partial_i \\psi_{ab}) = \\partial_i (\\partial_t \\psi_{ab}) = \\partial_i (-\\Pi_{ab}) = -\\partial_i \\Pi_{ab} $$\n\n现在我们有了一个一阶偏微分方程组。为求特征速度，我们进行平面波分析。我们寻找形如 $f(t, \\vec{x}) = \\hat{f} \\exp(i(k_j x^j - \\omega t))$ 的解，其中传播方向为空间单位余矢量 $s_i$，因此波矢量为 $k_j = k s_j$。此拟设将微分算子变换如下：$\\partial_t \\to -i\\omega$ 和 $\\partial_j \\to ik_j = iks_j$。特征速度定义为 $\\lambda = \\omega/k$。\n\n将此变换应用于该偏微分方程组，我们得到一个关于振幅 $(\\hat{\\psi}_{ab}, \\hat{\\Pi}_{ab}, \\hat{\\Phi}_{iab})$ 的代数系统：\n$$ -i\\omega \\hat{\\psi}_{ab} = -\\hat{\\Pi}_{ab} \\implies \\lambda \\hat{\\psi}_{ab} = \\hat{\\Pi}_{ab} $$\n$$ -i\\omega \\hat{\\Pi}_{ab} = -\\delta^{ij} (iks_i) \\hat{\\Phi}_{jab} = -ik s^j \\hat{\\Phi}_{jab} \\implies \\lambda \\hat{\\Pi}_{ab} = s^j \\hat{\\Phi}_{jab} $$\n$$ -i\\omega \\hat{\\Phi}_{iab} = -(iks_i) \\hat{\\Pi}_{ab} \\implies \\lambda \\hat{\\Phi}_{iab} = s_i \\hat{\\Pi}_{ab} $$\n\n问题指引我们使用简化的变量三元组 $(\\psi_{ab}, \\Pi_{ab}, \\Phi_{sab})$，其中 $\\Phi_{sab} := s^i \\Phi_{iab}$。在傅里叶域中，这对应于 $\\hat{\\Phi}_{sab} = s^i \\hat{\\Phi}_{iab}$。我们可以通过将第三个方程与 $s^i$ 进行缩并来为此变量创建一个演化方程：\n$$ s^i (\\lambda \\hat{\\Phi}_{iab}) = s^i (s_i \\hat{\\Pi}_{ab}) \\implies \\lambda (s^i \\hat{\\Phi}_{iab}) = (s^i s_i) \\hat{\\Pi}_{ab} $$\n由于 $s_i$ 是一个单位余矢量，因此 $s^i s_i = \\delta^{ij} s_i s_j = 1$。于是，我们有：\n$$ \\lambda \\hat{\\Phi}_{sab} = \\hat{\\Pi}_{ab} $$\n根据定义，第二个方程涉及 $s^j \\hat{\\Phi}_{jab} = \\hat{\\Phi}_{sab}$。所以，第二个方程是：\n$$ \\lambda \\hat{\\Pi}_{ab} = \\hat{\\Phi}_{sab} $$\n第一个方程保持为 $\\lambda \\hat{\\psi}_{ab} = \\hat{\\Pi}_{ab}$。\n\n现在我们得到了一个关于简化三元组 $(\\hat{\\psi}_{ab}, \\hat{\\Pi}_{ab}, \\hat{\\Phi}_{sab})$ 振幅的封闭代数系统：\n1.  $\\lambda \\hat{\\psi}_{ab} - \\hat{\\Pi}_{ab} = 0$\n2.  $\\lambda \\hat{\\Pi}_{ab} - \\hat{\\Phi}_{sab} = 0$\n3.  $\\lambda \\hat{\\Phi}_{sab} - \\hat{\\Pi}_{ab} = 0$\n\n该系统可以写成矩阵形式。对于每组指标 $ab$，我们有：\n$$ \\begin{pmatrix} \\lambda  -1  0 \\\\ 0  \\lambda  -1 \\\\ 0  -1  \\lambda \\end{pmatrix} \\begin{pmatrix} \\hat{\\psi}_{ab} \\\\ \\hat{\\Pi}_{ab} \\\\ \\hat{\\Phi}_{sab} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\n为使非平凡解存在，矩阵的行列式必须为零。此条件给出了速度 $\\lambda$ 的特征方程：\n$$ \\det \\begin{pmatrix} \\lambda  -1  0 \\\\ 0  \\lambda  -1 \\\\ 0  -1  \\lambda \\end{pmatrix} = \\lambda \\det \\begin{pmatrix} \\lambda  -1 \\\\ -1  \\lambda \\end{pmatrix} - (-1) \\det \\begin{pmatrix} 0  -1 \\\\ 0  \\lambda \\end{pmatrix} + 0 = \\lambda(\\lambda^2 - 1) = 0 $$\n该特征方程的根即为特征速度：\n$$ \\lambda = 0, \\quad \\lambda = 1, \\quad \\lambda = -1 $$\n特征速度的集合为 $\\{ -1, 0, 1 \\}$。\n\n谱半径定义为这些特征速度中的最大绝对值。\n$$ \\rho = \\max(|\\lambda|) = \\max(|-1|, |0|, |1|) = \\max(1, 0, 1) = 1 $$\n线性化 GH 系统主部的谱半径为 $1$。这对应于在此背景下以光速（设为 $c=1$）传播的物理特征（引力波）。",
            "answer": "$$\\boxed{1}$$"
        },
        {
            "introduction": "对于更复杂的系统，仅靠特征分析不足以证明其适定性，此时需要借助强大的能量方法。本练习将展示如何为一个简化的爱因斯坦方程系统构建一个“对称化子”（symmetrizer）。这个关键的数学工具能够帮助我们建立能量估计，从而确保系统的稳定性，即便在将方程降为一阶系统的过程中引入了非物理的约束变量。",
            "id": "3498080",
            "problem": "考虑一个线性常系数偏微分方程(PDE)模型，其灵感来源于数值相对论中广义相对论的线性化 Arnowitt–Deser–Misner (ADM) 形式的一维简化。令状态向量为 $U = (h, K, \\Gamma, C)^{\\top}$，其中 $h$ 是度规微扰，$K$ 是外曲率的迹，$\\Gamma$ 是一个缩并联络函数，而 $C$ 是一个通过朴素一阶简化引入的约束变量，意在表示 $C \\equiv \\Gamma - \\partial_{x} h$。该朴素简化系统的主部为\n$$\n\\partial_{t} h = - 2 K, \\quad\n\\partial_{t} K = - \\partial_{x} \\Gamma, \\quad\n\\partial_{t} \\Gamma = - \\partial_{x} K - \\beta \\, \\partial_{x} C, \\quad\n\\partial_{t} C = 0,\n$$\n其中 $\\beta \\in \\mathbb{R}$ 是一个常数参数。假设在一维环面上采用周期性边界条件，从而分部积分不产生边界项。这种朴素简化引入了一个伪零速约束变量 $C$，它不与任何物理传播模式相关联。\n\n通过 $\\partial_{t} \\widehat{U} + i k \\, \\mathcal{A} \\widehat{U} = 0$ 将主部沿波数 $k \\in \\mathbb{R}$ 的空间傅里叶符号定义为 $\\mathcal{A}$，\n$$\n\\mathcal{A} \\equiv\n\\begin{pmatrix}\n0  0  0  0 \\\\\n0  0  -1  0 \\\\\n0  -1  0  -\\beta \\\\\n0  0  0  0\n\\end{pmatrix}.\n$$\n从能量方法和对称双曲性的定义出发，构造一个对称正定的对称化矩阵 $H$，该矩阵与 $k$ 无关，且满足 $H \\mathcal{A} = (H \\mathcal{A})^{\\top}$。使用最简单的对角元选择，以确保正定性，同时在以下能量估计中仍然能控制伪约束 $C$\n$$\nE[U](t) \\equiv \\int \\! U(t,x)^{\\top} H \\, U(t,x) \\, dx.\n$$\n请以 $\\beta$ 的函数闭合形式，明确给出满足这些性质的矩阵 $H$。\n\n你的最终答案必须是使用 LaTeX $\\mathrm{pmatrix}$ 环境表示的 $H$ 的单一解析表达式。无需四舍五入，也不涉及单位。请仅用 $\\beta$ 精确表达你的矩阵对称化子。",
            "solution": "主符号 $\\mathcal{A}$ 捕捉了主阶空间耦合。如果存在一个对称正定矩阵 $H$ 使得 $H \\mathcal{A}$ 是对称的，即\n$$\nH \\mathcal{A} = (H \\mathcal{A})^{\\top} \\quad \\Longleftrightarrow \\quad H \\mathcal{A} = \\mathcal{A}^{\\top} H.\n$$\n则可以实现对称双曲结构。在周期性边界条件下并忽略低阶项，使用二次能量的能量方法\n$$\nE[U](t) \\equiv \\int U^{\\top} H U \\, dx\n$$\n给出\n$$\n\\frac{d}{dt} E[U](t) = \\int \\left( \\partial_{t} U^{\\top} H U + U^{\\top} H \\, \\partial_{t} U \\right) dx\n= - \\int \\left( \\partial_{x} U^{\\top} \\, \\mathcal{A}^{\\top} H U + U^{\\top} H \\, \\partial_{x} (\\mathcal{A} U) \\right) dx.\n$$\n通过分部积分并利用周期性，\n$$\n\\frac{d}{dt} E[U](t) = - \\int \\partial_{x} \\left( U^{\\top} H \\mathcal{A} U \\right) dx + \\int U^{\\top} \\left( H \\mathcal{A} - \\mathcal{A}^{\\top} H \\right) \\partial_{x} U \\, dx.\n$$\n因此，如果 $H \\mathcal{A}$ 是对称的，第二个积分消失，而第一个积分是一个全导数，其域积分因周期性而为零。因此，$H \\mathcal{A}$ 对称意味着在主部层面能量守恒，并且能控制所有出现在 $E[U]$ 中的变量，包括伪约束变量 $C$。\n\n我们现在构造满足 $H \\mathcal{A} = (H \\mathcal{A})^{\\top}$ 且对称正定的 $H$。因为 $\\mathcal{A}$ 的第一行和第一列都为零，所以 $h$ 与主符号解耦。不失一般性，我们可以选择 $H_{11} = 1$。我们关注于非平凡的 $(K,\\Gamma,C)$ 块，它对应于索引 $(2,3,4)$，其矩阵为\n$$\n\\mathcal{A}_{\\text{blk}} =\n\\begin{pmatrix}\n0  -1  0 \\\\\n-1  0  -\\beta \\\\\n0  0  0\n\\end{pmatrix}.\n$$\n设一个一般的对称块对称化子为\n$$\nH_{\\text{blk}} =\n\\begin{pmatrix}\na  d  e \\\\\nd  b  f \\\\\ne  f  c\n\\end{pmatrix},\n$$\n其中 $a,b,c \\in \\mathbb{R}$ 和 $d,e,f \\in \\mathbb{R}$ 待定，并且我们还将要求其具有正定性。计算 $H_{\\text{blk}} \\mathcal{A}_{\\text{blk}}$：\n\\begin{align*}\nH_{\\text{blk}} \\mathcal{A}_{\\text{blk}} =\n\\begin{pmatrix}\na \\cdot 0 + d \\cdot (-1) + e \\cdot 0  a \\cdot (-1) + d \\cdot 0 + e \\cdot 0  a \\cdot 0 + d \\cdot (-\\beta) + e \\cdot 0 \\\\\nd \\cdot 0 + b \\cdot (-1) + f \\cdot 0  d \\cdot (-1) + b \\cdot 0 + f \\cdot 0  d \\cdot 0 + b \\cdot (-\\beta) + f \\cdot 0 \\\\\ne \\cdot 0 + f \\cdot (-1) + c \\cdot 0  e \\cdot (-1) + f \\cdot 0 + c \\cdot 0  e \\cdot 0 + f \\cdot (-\\beta) + c \\cdot 0\n\\end{pmatrix} \\\\\n=\n\\begin{pmatrix}\n- d  - a  - \\beta d \\\\\n- b  - d  - \\beta b \\\\\n- f  - e  - \\beta f\n\\end{pmatrix}.\n\\end{align*}\n其转置为\n$$\n(H_{\\text{blk}} \\mathcal{A}_{\\text{blk}})^{\\top} =\n\\begin{pmatrix}\n- d  - b  - f \\\\\n- a  - d  - e \\\\\n- \\beta d  - \\beta b  - \\beta f\n\\end{pmatrix}.\n$$\n令 $H_{\\text{blk}} \\mathcal{A}_{\\text{blk}} = (H_{\\text{blk}} \\mathcal{A}_{\\text{blk}})^{\\top}$ 可得约束条件\n$$\na = b, \\quad f = \\beta d, \\quad e = \\beta b = \\beta a.\n$$\n通过设置 $d = 0$ (从而 $f = 0$)，并选择 $a = b = 1$ 和 $e = \\beta$，我们可以得到一个产生正定 $H_{\\text{blk}}$ 的特别简单的选择。剩下的参数 $c$ 控制能量中伪约束 $C$ 的权重。当 $d = 0$ 时，该块矩阵变为\n$$\nH_{\\text{blk}} =\n\\begin{pmatrix}\n1  0  \\beta \\\\\n0  1  0 \\\\\n\\beta  0  c\n\\end{pmatrix}.\n$$\n为确保正定性，我们检查其主子式：\n- $1 \\times 1$ 主子式为 $1 > 0$。\n- $2 \\times 2$ 顺序主子式为 $\\det \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} = 1 > 0$。\n- 完整的行列式为\n$$\n\\det(H_{\\text{blk}}) = 1 \\cdot (1 \\cdot c - 0) - 0 + \\beta \\cdot (0 - 1 \\cdot \\beta) = c - \\beta^{2}.\n$$\n因此，$H_{\\text{blk}}$ 是正定的当且仅当 $c - \\beta^{2} > 0$，即 $c > \\beta^{2}$。一个最小的简单选择是 $c = 1 + \\beta^{2}$。\n\n将其扩展回包含 $h$ 的完整 $4 \\times 4$ 对称化子，令 $H_{11} = 1$，除上述指定的 $(K,\\Gamma,C)$ 块外，其他元素均为零，我们提出\n$$\nH =\n\\begin{pmatrix}\n1  0  0  0 \\\\\n0  1  0  \\beta \\\\\n0  0  1  0 \\\\\n0  \\beta  0  1 + \\beta^{2}\n\\end{pmatrix}.\n$$\n该矩阵 $H$ 是对称的，与 $k$ 无关，并且对所有实数 $\\beta$ 都是正定的，因为 $1 + \\beta^{2} > \\beta^{2}$。此外，如上所示，选择 $a = b = 1$, $d = 0$, $e = \\beta$, $f = 0$ 可以确保 $H \\mathcal{A} = (H \\mathcal{A})^{\\top}$，因此能量方法得出\n$$\n\\frac{d}{dt} E[U](t) = 0\n$$\n在周期性边界条件下的主部层面成立。特别地，伪约束变量 $C$ 以权重 $1 + \\beta^{2}$ 和交叉耦合项 $H_{24} = \\beta$ 进入能量表达式，因此其贡献在能量估计中受到对称化子的控制。\n\n因此，所求的对称化子即为上述矩阵 $H$。",
            "answer": "$$\\boxed{\\begin{pmatrix}\n1  0  0  0 \\\\\n0  1  0  \\beta \\\\\n0  0  1  0 \\\\\n0  \\beta  0  1 + \\beta^{2}\n\\end{pmatrix}}$$"
        },
        {
            "introduction": "一个适定的偏微分方程组本身并不足够，还必须施加正确的边界条件才能确保数值解的稳定。这个实践练习将引导你完成一个面向代码的任务：在计算区域的边界上应用特征分析。你将学会如何验证所选的边界条件是否“保持约束”，从而防止不符合物理规律的伪解从边界侵入模拟区域。",
            "id": "3498073",
            "problem": "考虑一个线性的、常系数的、一阶对称双曲约束子系统，该系统是数值相对论中用于引力波的公式（如广义谐波 (GH) 公式）的代表。设约束向量为 $C(x,t) \\in \\mathbb{R}^m$，其在一维空间中根据以下方程演化\n$$\n\\partial_t C + A \\, \\partial_x C = 0,\n$$\n其中 $A \\in \\mathbb{R}^{m \\times m}$ 是对称矩阵，并且可以通过实特征值对角化。对于一个具有向外单位法向量 $n \\in \\{-1,+1\\}$（左边界 $n=-1$，右边界 $n=+1$）的边界，定义法向通量矩阵 $A^n = n A$，及其特征分解 $A = Q \\Lambda Q^{\\mathsf{T}}$，其中 $Q$ 是正交矩阵，$\\Lambda = \\mathrm{diag}(\\lambda_1,\\ldots,\\lambda_m)$。边界上的特征变量为\n$$\nW = Q^{\\mathsf{T}} C,\n$$\n法向特征速度为 $\\lambda_k^n = n \\lambda_k$。一个保约束的、最大耗散的边界条件要求所有入射的特征分量为零，即对于所有满足 $\\lambda_k^n  0$ 的索引 $k$，在边界上必须有 $W_k = 0$。\n\n您的任务是开发一个程序，对于边界上给定的约束值，通过计算特征投影并检查所有入射分量是否在指定的容差范围内为零，来验证边界条件是否是保约束的。使用以下数据，这些数据在科学上与一个对称双曲模型是一致的：\n\n- 维度 $m = 3$。\n- 正交矩阵\n$$\nQ = \\begin{pmatrix}\n\\frac{1}{\\sqrt{2}}  \\frac{1}{\\sqrt{2}}  0 \\\\\n-\\frac{1}{\\sqrt{2}}  \\frac{1}{\\sqrt{2}}  0 \\\\\n0  0  1\n\\end{pmatrix}.\n$$\n- 特征速度对角矩阵\n$$\n\\Lambda = \\mathrm{diag}\\left(1.0,\\,-0.5,\\;0.0\\right),\n$$\n所以 $\\lambda_1 = 1.0$，$\\lambda_2 = -0.5$，$\\lambda_3 = 0.0$。\n- 向外单位法向量：左边界 $n = -1$，右边界 $n = +1$。\n- 容差 $\\epsilon = 10^{-8}$；将任何满足 $|W_k| \\le \\epsilon$ 的入射特征分量 $W_k$ 视为零。\n- 对于每个测试用例，每个边界上的约束值是通过预设的特征数据 $W$ 经由 $C = Q W$ 构建的。程序必须根据这些 $C$ 值计算 $W = Q^{\\mathsf{T}} C$ 并验证其入射分量。\n\n定义以下测试套件，其中每个测试用例是在左边界和右边界上的一对特征数据向量 $(W^{\\mathrm{left}}, W^{\\mathrm{right}})$。每个边界上相应的约束向量是 $C^{\\mathrm{left}} = Q W^{\\mathrm{left}}$ 和 $C^{\\mathrm{right}} = Q W^{\\mathrm{right}}$。\n\n- 测试用例1（正常路径）：$W^{\\mathrm{left}} = [0.0,\\;1.2,\\;-0.3]$，$W^{\\mathrm{right}} = [0.5,\\;0.0,\\;0.25]$。\n- 测试用例2（左边界违例）：$W^{\\mathrm{left}} = [10^{-3},\\;0.0,\\;0.0]$，$W^{\\mathrm{right}} = [0.0,\\;0.0,\\;0.0]$。\n- 测试用例3（右边界违例）：$W^{\\mathrm{left}} = [0.0,\\;0.0,\\;0.0]$，$W^{\\mathrm{right}} = [0.0,\\;-2\\times 10^{-3},\\;0.1]$。\n- 测试用例4（边界分量在容差范围内）：$W^{\\mathrm{left}} = [5\\times 10^{-9},\\;0.33,\\;-0.12]$，$W^{\\mathrm{right}} = [0.41,\\;-5\\times 10^{-9},\\;0.0]$。\n- 测试用例5（中性特征不为零但被允许）：$W^{\\mathrm{left}} = [0.0,\\;0.0,\\;10.0]$，$W^{\\mathrm{right}} = [0.0,\\;0.0,\\;-7.0]$。\n\n入射特征的索引由 $\\lambda_k^n$ 的符号确定：\n- 在左边界，$n=-1$，入射索引满足 $\\lambda_k^n = -\\lambda_k  0$，等价于 $\\lambda_k  0$，因此入射索引集为 $\\{1\\}$（第一个特征场）。\n- 在右边界，$n=+1$，入射索引满足 $\\lambda_k^n = \\lambda_k  0$，因此入射索引集为 $\\{2\\}$（第二个特征场）。\n- 具有 $\\lambda_k^n = 0$ 的中性场（此处为 $k=3$）既非入射也非出射，因此不必测试其是否为零。\n\n程序要求：\n- 对于每个测试用例，计算 $C^{\\mathrm{left}} = Q W^{\\mathrm{left}}$ 和 $C^{\\mathrm{right}} = Q W^{\\mathrm{right}}$。\n- 从 $C^{\\mathrm{left}}$ 和 $C^{\\mathrm{right}}$ 计算 $W^{\\mathrm{left}} = Q^{\\mathsf{T}} C^{\\mathrm{left}}$ 和 $W^{\\mathrm{right}} = Q^{\\mathsf{T}} C^{\\mathrm{right}}$。\n- 检查每个边界上的所有入射分量是否满足为零条件 $|W_k| \\le \\epsilon$。\n- 为每个测试用例返回一个布尔值，指示边界条件是否同时在两个边界上都是保约束的。\n\n最终输出格式：\n- 您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表，例如 $[r_1,r_2,r_3,r_4,r_5]$，其中每个 $r_i$ 是对应于按顺序列出的第 $i$ 个测试用例的布尔值。\n\n此问题不涉及物理单位；所有量均为无量纲实数。",
            "solution": "该问题是有效的，因为它具有科学依据、是适定的，并为偏微分方程数值解领域的标准验证任务提供了一套完整且一致的数据和指令。\n\n该问题研究了一个线性、一阶、对称双曲偏微分方程组的边界条件，其一般形式为：\n$$\n\\partial_t C + A \\, \\partial_x C = 0\n$$\n此处，$C(x, t) \\in \\mathbb{R}^m$ 表示一个包含 $m$ 个场的向量，$A$ 是一个常数 $m \\times m$ 矩阵。为使系统成为对称双曲系统，$A$ 必须是对称的，这保证了它具有实特征值和一组正交归一的特征向量基。这个性质是基础性的，因为它允许将系统分解为一组独立的标量平流方程。\n\n矩阵 $A$ 的特征分解由 $A = Q \\Lambda Q^{\\mathsf{T}}$ 给出，其中 $Q$ 是一个正交矩阵，其列是 $A$ 的特征向量，而 $\\Lambda = \\mathrm{diag}(\\lambda_1, \\ldots, \\lambda_m)$ 是相应特征值的对角矩阵，这些特征值被称为特征速度。\n\n通过定义一组新的变量，即特征变量 $W = Q^{\\mathsf{T}}C$，我们可以将该系统对角化。将 $C = QW$ 代入偏微分方程，并从左侧乘以 $Q^{\\mathsf{T}}$，得到：\n$$\n\\partial_t (Q^{\\mathsf{T}}C) + (Q^{\\mathsf{T}} A Q) \\partial_x (Q^{\\mathsf{T}}C) = 0\n$$\n$$\n\\partial_t W + \\Lambda \\partial_x W = 0\n$$\n这是一个关于 $W$ 各分量的 $m$ 个解耦的标量平流方程组：\n$$\n\\partial_t W_k + \\lambda_k \\partial_x W_k = 0, \\quad \\text{for } k = 1, \\ldots, m\n$$\n每个分量 $W_k$ 代表一个以恒定速度 $\\lambda_k$ 传播的波，或称为特征场。\n\n在边界上，信息流动的方向由法向特征速度 $\\lambda_k^n = n \\lambda_k$ 的符号确定，其中 $n$ 是向外的单位法向量。\n- 如果 $\\lambda_k^n  0$，特征场 $W_k$ 是出射的，意味着其在边界上的值由域内部的解确定。\n- 如果 $\\lambda_k^n  0$，特征场 $W_k$ 是入射的，意味着其值从边界传播到域内。对于一个适定的初边值问题，这些入射场必须由边界条件指定。\n- 如果 $\\lambda_k^n = 0$，该场相对于边界是中性或静止的，通常需要特殊处理，但对于正在测试的条件，它是不受约束的。\n\n该问题指定了一个保约束、最大耗散的边界条件，它将约束向量 $C$ 的所有入射特征分量设置为零。这是数值相对论中的一种标准做法，以防止约束违背通过边界进入计算域。\n\n对于给定的参数：\n- 特征值：$\\lambda_1 = 1.0$，$\\lambda_2 = -0.5$，$\\lambda_3 = 0.0$。\n- 左边界：向外法向量为 $n = -1$。法向特征速度为 $\\lambda_1^n = -1.0$，$\\lambda_2^n = 0.5$，$\\lambda_3^n = 0.0$。唯一的入射场是满足 $\\lambda_k^n  0$ 的场，对应于 $k=1$。因此，边界条件为 $W_1 = 0$。\n- 右边界：向外法向量为 $n = +1$。法向特征速度为 $\\lambda_1^n = 1.0$，$\\lambda_2^n = -0.5$，$\\lambda_3^n = 0.0$。唯一的入射场对应于 $k=2$。因此，边界条件为 $W_2 = 0$。\n- 场 $W_3$ 在两个边界上都是中性的（$\\lambda_3^n=0$），因此不受此边界条件的约束。\n\n计算任务是针对几个测试用例，验证给定的约束边界数据是否满足这些条件。每个测试用例的步骤如下：\n1.  对于每个边界（左边界和右边界），从提供的特征数据向量 $W^{\\text{given}}$ 开始。\n2.  使用变换 $C = Q W^{\\text{given}}$ 构建边界上的约束向量。这模拟了系统在边界上的状态。\n3.  从该约束向量 $C$，通过逆变换 $W^{\\text{computed}} = Q^{\\mathsf{T}} C$ 计算特征变量。解析上，$W^{\\text{computed}} = W^{\\text{given}}$，但此步骤模拟了一个现实的验证过程，并检查实现的一致性。\n4.  在左边界，检查入射分量 $W^{\\text{computed}}_1$ 是否在指定的容差 $\\epsilon = 10^{-8}$ 范围内为零。即，检查 $|(W^{\\text{left, computed}})_1| \\le \\epsilon$ 是否成立。请注意，在采用从0开始索引的编程中，这对应于索引为0的分量。\n5.  在右边界，检查入射分量 $W^{\\text{computed}}_2$ 是否在容差范围内为零。即，检查 $|(W^{\\text{right, computed}})_2| \\le \\epsilon$ 是否成立。在从0开始的索引中，这对应于索引为1的分量。\n6.  当且仅当左、右两个边界的条件都满足时，一个测试用例才被认为是有效的。\n\n程序将为五个测试用例中的每一个实现此逻辑，并为每个用例报告一个布尔结果。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Validates boundary conditions for a symmetric hyperbolic system.\n    \"\"\"\n    \n    # Define problem parameters\n    m = 3\n    epsilon = 1e-8\n    \n    # Orthogonal matrix Q\n    Q = np.array([\n        [1/np.sqrt(2), 1/np.sqrt(2), 0.0],\n        [-1/np.sqrt(2), 1/np.sqrt(2), 0.0],\n        [0.0, 0.0, 1.0]\n    ])\n    \n    # Transpose of Q for characteristic projection\n    QT = Q.T\n    \n    # Test suite with characteristic data (W_left, W_right)\n    # Each W is a numpy array.\n    test_cases = [\n        # Test case 1 (happy path)\n        (np.array([0.0, 1.2, -0.3]), np.array([0.5, 0.0, 0.25])),\n        # Test case 2 (violation at left boundary)\n        (np.array([1e-3, 0.0, 0.0]), np.array([0.0, 0.0, 0.0])),\n        # Test case 3 (violation at right boundary)\n        (np.array([0.0, 0.0, 0.0]), np.array([0.0, -2e-3, 0.1])),\n        # Test case 4 (boundary components within tolerance)\n        (np.array([5e-9, 0.33, -0.12]), np.array([0.41, -5e-9, 0.0])),\n        # Test case 5 (neutral characteristic non-vanishing but allowed)\n        (np.array([0.0, 0.0, 10.0]), np.array([0.0, 0.0, -7.0])),\n    ]\n\n    # Incoming characteristic indices (0-based) for each boundary\n    # Left boundary (n=-1): lambda_k > 0 => k=1 (index 0)\n    # Right boundary (n=+1): lambda_k  0 => k=2 (index 1)\n    incoming_idx_left = 0\n    incoming_idx_right = 1\n\n    results = []\n\n    for W_left_given, W_right_given in test_cases:\n        # ---- Step 1: Construct C from given W ----\n        C_left = Q @ W_left_given\n        C_right = Q @ W_right_given\n        \n        # ---- Step 2: Recover W from C ----\n        # This step simulates the verification process on a given C.\n        # Due to floating point precision, W_computed might not be exactly W_given.\n        W_left_computed = QT @ C_left\n        W_right_computed = QT @ C_right\n        \n        # ---- Step 3: Check boundary conditions ----\n        is_case_valid = True\n        \n        # Check left boundary\n        incoming_component_left = W_left_computed[incoming_idx_left]\n        if abs(incoming_component_left) > epsilon:\n            is_case_valid = False\n            \n        # Check right boundary, only if left is valid\n        if is_case_valid:\n            incoming_component_right = W_right_computed[incoming_idx_right]\n            if abs(incoming_component_right) > epsilon:\n                is_case_valid = False\n        \n        results.append(is_case_valid)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}