{
    "hands_on_practices": [
        {
            "introduction": "Mastering the Baumgarte–Shapiro–Shibata–Nakamura (BSSN) formalism begins with fluency in its core algebraic transformation. This first practice grounds you in this fundamental concept by tasking you with the direct decomposition of a given physical spatial metric $\\gamma_{ij}$ into its conformal factor $\\phi$ and conformal metric $\\tilde{\\gamma}_{ij}$. By working from first principles, you will solidify your understanding of the defining relations that underpin the entire BSSN framework .",
            "id": "3468149",
            "problem": "You are working with the Baumgarte–Shapiro–Shibata–Nakamura (BSSN) conformal decomposition in the context of the $3+1$ split of General Relativity. The BSSN variables are defined through a conformal rescaling of the spatial metric, where the physical spatial metric $ \\gamma_{ij} $ is decomposed as\n$$\n\\gamma_{ij} = \\exp(4\\phi)\\,\\tilde{\\gamma}_{ij},\n$$\ntogether with the unit-determinant condition\n$$\n\\det(\\tilde{\\gamma}_{ij}) = 1.\n$$\nConsider a time-slice in Cartesian coordinates with the spatial metric\n$$\n\\gamma_{ij} = \n\\begin{pmatrix}\n4 & 1 & 0 \\\\\n1 & 2 & 0 \\\\\n0 & 0 & 3\n\\end{pmatrix}.\n$$\nStarting from the above core definitions, and without invoking any additional formula beyond these definitions and basic linear algebra, perform the BSSN conformal decomposition for this $ \\gamma_{ij} $:\n- Derive $ \\phi $ from first principles using the two defining relations.\n- Compute $ \\tilde{\\gamma}_{ij} $ explicitly.\n- Verify that the unit-determinant condition $ \\det(\\tilde{\\gamma}_{ij}) = 1 $ holds.\n\nUse exact arithmetic with symbols where appropriate and do not approximate. Express your final answer as the simplified analytic expression for $ \\phi $. No numerical rounding is required, and no units are involved since $ \\phi $ is dimensionless.",
            "solution": "The BSSN conformal decomposition is defined by two relations:\n$$\n\\gamma_{ij} = \\exp\\!\\left(4 \\phi\\right)\\,\\tilde{\\gamma}_{ij}, \\qquad \\det\\!\\left(\\tilde{\\gamma}_{ij}\\right) = 1.\n$$\nWe begin by taking determinants of both sides of the decomposition. Using the multiplicative property of determinants and the fact that for a scalar $ a $ and a $ 3 \\times 3 $ matrix $ M $ one has $ \\det(a M) = a^{3} \\det(M) $, we obtain\n$$\n\\det(\\gamma_{ij}) = \\det\\!\\left(\\exp\\!\\left(4 \\phi\\right)\\,\\tilde{\\gamma}_{ij}\\right) = \\exp\\!\\left(12 \\phi\\right)\\, \\det\\!\\left(\\tilde{\\gamma}_{ij}\\right).\n$$\nImposing the unit-determinant condition $ \\det(\\tilde{\\gamma}_{ij}) = 1 $ gives\n$$\n\\det(\\gamma_{ij}) = \\exp\\!\\left(12 \\phi\\right).\n$$\nTaking the natural logarithm of both sides yields\n$$\n\\phi = \\frac{1}{12}\\, \\ln\\!\\left(\\det(\\gamma_{ij})\\right).\n$$\n\nIt remains to compute $ \\det(\\gamma_{ij}) $ for the given matrix. The matrix is block diagonal up to the upper-left $ 2 \\times 2 $ block, so\n$$\n\\det(\\gamma_{ij}) = 3 \\, \\det\\!\\begin{pmatrix} 4 & 1 \\\\ 1 & 2 \\end{pmatrix} = 3 \\left(4 \\cdot 2 - 1 \\cdot 1\\right) = 3 \\cdot 7 = 21.\n$$\nTherefore,\n$$\n\\phi = \\frac{1}{12}\\, \\ln(21).\n$$\n\nNext, we compute the conformal metric $ \\tilde{\\gamma}_{ij} $. From the defining relation,\n$$\n\\tilde{\\gamma}_{ij} = \\exp\\!\\left(-4 \\phi\\right)\\, \\gamma_{ij}.\n$$\nUsing $ \\exp\\!\\left(12 \\phi\\right) = \\det(\\gamma_{ij}) = 21 $, we have\n$$\n\\exp\\!\\left(4 \\phi\\right) = \\exp\\!\\left(\\frac{4}{12} \\ln(21)\\right) = \\exp\\!\\left(\\frac{1}{3} \\ln(21)\\right) = 21^{1/3},\n$$\nand hence\n$$\n\\exp\\!\\left(-4 \\phi\\right) = 21^{-1/3}.\n$$\nThus,\n$$\n\\tilde{\\gamma}_{ij} = 21^{-1/3}\n\\begin{pmatrix}\n4 & 1 & 0 \\\\\n1 & 2 & 0 \\\\\n0 & 0 & 3\n\\end{pmatrix}.\n$$\n\nFinally, we verify the unit-determinant condition:\n$$\n\\det(\\tilde{\\gamma}_{ij}) = \\det\\!\\left(21^{-1/3} \\gamma_{ij}\\right) = \\left(21^{-1/3}\\right)^{3} \\det(\\gamma_{ij}) = 21^{-1} \\cdot 21 = 1,\n$$\nas required. This completes the decomposition and verification. The requested final answer for $ \\phi $ is the exact expression $ \\frac{1}{12} \\ln(21) $.",
            "answer": "$$\\boxed{\\frac{1}{12}\\ln(21)}$$"
        },
        {
            "introduction": "With a firm grasp of the algebraic decomposition, the next step is to connect these new variables to the underlying geometry of spacetime. This exercise challenges you to verify the consistency of the BSSN expression for the Ricci tensor $R_{ij}$, a cornerstone of the Einstein field equations, by comparing it against a direct calculation from the physical metric. Successfully completing this theoretical check  deepens your understanding of how the BSSN formalism correctly captures the essential physics of curvature.",
            "id": "3468204",
            "problem": "Consider a single spatial hypersurface in the Arnowitt–Deser–Misner (ADM) $3+1$ formalism with Cartesian coordinates $(x,y,z)$. Adopt the Baumgarte–Shapiro–Shibata–Nakamura (BSSN) conformal decomposition $\\gamma_{ij} = \\exp(4 \\phi)\\,\\tilde{\\gamma}_{ij}$ with $\\det \\tilde{\\gamma}_{ij} = 1$. Let the conformal metric be flat, $\\tilde{\\gamma}_{ij}(x) = \\delta_{ij}$, and let the conformal factor be the analytic function $\\phi(x,y,z) = \\alpha\\,x\\,y + \\beta\\,z^{2}$, where $\\alpha$ and $\\beta$ are real constants. Work in Euclidean Cartesian components so that $\\delta_{ij}$ and its associated Levi–Civita connection are used for raising and lowering indices and covariant differentiation in the conformal sector.\n\nStarting only from the fundamental definitions of the Levi–Civita connection and Ricci curvature for a metric, and from the conformal relation $\\gamma_{ij} = \\exp(4 \\phi)\\,\\tilde{\\gamma}_{ij}$, do the following:\n\n1. Compute the Ricci tensor $R_{ij}[\\gamma]$ directly (the ADM route) by forming the Levi–Civita connection of $\\gamma_{ij}$ and contracting the Riemann tensor as defined from that connection.\n2. Independently, compute the decomposition $R_{ij} = \\tilde{R}_{ij} + R^{\\phi}_{ij}$ in the BSSN route, where $\\tilde{R}_{ij}$ is the Ricci tensor built from $\\tilde{\\gamma}_{ij}$ and $R^{\\phi}_{ij}$ contains the terms that arise from the conformal factor $\\phi$.\n3. Define the difference tensor $\\Delta R_{ij} \\equiv R_{ij}^{\\text{ADM}} - \\left(\\tilde{R}_{ij} + R^{\\phi}_{ij}\\right)$ and evaluate it at the point $p$ with coordinates $(x,y,z) = (1,-1,2)$.\n4. Compute the Frobenius norm $N \\equiv \\sqrt{\\gamma^{ik}\\,\\gamma^{jl}\\,\\Delta R_{ij}\\,\\Delta R_{kl}}$ at the point $p$.\n\nReport the exact value of $N$ as a single real number. No rounding is required. Express the final answer as a dimensionless real number.",
            "solution": "The problem requires computing the Ricci tensor of a given metric, $\\gamma_{ij}$, using two different methods and then finding the Frobenius norm of the difference between the results. The metric is defined on a three-dimensional spatial slice with Cartesian coordinates $(x,y,z)$, which we can denote as $(x^1, x^2, x^3)$. The metric is given by a conformal decomposition, $\\gamma_{ij} = \\exp(4 \\phi)\\,\\tilde{\\gamma}_{ij}$, where the conformal metric is flat, $\\tilde{\\gamma}_{ij} = \\delta_{ij}$, and the conformal factor is $\\phi(x,y,z) = \\alpha\\,x\\,y + \\beta\\,z^{2}$.\n\nThe core of the problem is to verify the mathematical identity between a direct calculation of the Ricci tensor from its fundamental definition (the ADM route) and the standard formula for the Ricci tensor under a conformal transformation (the BSSN route). If the two methods are carried out correctly, their results must be identical. Consequently, their difference, $\\Delta R_{ij}$, must be the zero tensor. The Frobenius norm of the zero tensor is necessarily zero. The specific functional form of $\\phi$ and the evaluation point $p$ are ultimately irrelevant to the final result, as the identity holds for any sufficiently smooth conformal factor. We shall demonstrate this identity through direct calculation.\n\n### Part 1: Direct Computation of $R_{ij}[\\gamma]$ (ADM Route)\n\nThe physical metric is $\\gamma_{ij} = \\exp(4\\phi)\\delta_{ij}$. The inverse metric is $\\gamma^{ij} = \\exp(-4\\phi)\\delta^{ij}$. The Ricci tensor, $R_{ij}$, is defined in terms of the Christoffel symbols, $\\Gamma^k_{ij}$, as $R_{ij} = R^k_{ikj}$. The components of the Riemann curvature tensor are given by $R^k_{imj} = \\partial_m \\Gamma^k_{ij} - \\partial_j \\Gamma^k_{im} + \\Gamma^p_{ij}\\Gamma^k_{pm} - \\Gamma^p_{im}\\Gamma^k_{pj}$. Due to the symmetry of the Christoffel symbols in their lower indices for a metric-compatible connection, this is equivalent to $R_{ij} = \\partial_k \\Gamma^k_{ij} - \\partial_j \\Gamma^k_{ik} + \\Gamma^m_{ij}\\Gamma^k_{mk} - \\Gamma^m_{ik}\\Gamma^k_{mj}$.\n\nFirst, we compute the Christoffel symbols $\\Gamma^k_{ij}$ for the metric $\\gamma_{ij}$:\n$$\n\\Gamma^k_{ij} = \\frac{1}{2} \\gamma^{kl} (\\partial_i \\gamma_{jl} + \\partial_j \\gamma_{il} - \\partial_l \\gamma_{ij})\n$$\nThe derivatives of the metric are $\\partial_m \\gamma_{ij} = 4 (\\partial_m \\phi) \\exp(4\\phi) \\delta_{ij}$. Substituting this into the formula for $\\Gamma^k_{ij}$:\n$$\n\\Gamma^k_{ij} = \\frac{1}{2} \\exp(-4\\phi)\\delta^{kl} [4(\\partial_i\\phi)\\exp(4\\phi)\\delta_{jl} + 4(\\partial_j\\phi)\\exp(4\\phi)\\delta_{il} - 4(\\partial_l\\phi)\\exp(4\\phi)\\delta_{ij}]\n$$\n$$\n\\Gamma^k_{ij} = 2 \\delta^{kl} [(\\partial_i\\phi)\\delta_{jl} + (\\partial_j\\phi)\\delta_{il} - (\\partial_l\\phi)\\delta_{ij}]\n$$\nContracting the Kronecker deltas gives:\n$$\n\\Gamma^k_{ij} = 2 [(\\partial_i\\phi)\\delta^k_j + (\\partial_j\\phi)\\delta^k_i - \\delta_{ij}\\delta^{kl}(\\partial_l\\phi)] = 2 [(\\partial_i\\phi)\\delta^k_j + (\\partial_j\\phi)\\delta^k_i - \\delta_{ij}\\partial^k\\phi]\n$$\nwhere indices on derivatives of $\\phi$ are raised and lowered with the flat conformal metric $\\delta_{ij}$, e.g., $\\partial^k\\phi = \\delta^{kl}\\partial_l\\phi$.\n\nNext, we compute the terms required for the Ricci tensor.\nThe linear terms in $\\phi$ involve derivatives of $\\Gamma^k_{ij}$:\n$$\n\\partial_k \\Gamma^k_{ij} = \\partial_k [2 ((\\partial_i\\phi)\\delta^k_j + (\\partial_j\\phi)\\delta^k_i - \\delta_{ij}\\partial^k\\phi)] = 2(\\partial_j\\partial_i\\phi + \\partial_i\\partial_j\\phi - \\delta_{ij}\\partial_k\\partial^k\\phi) = 4\\partial_i\\partial_j\\phi - 2\\delta_{ij}\\tilde{\\Delta}\\phi\n$$\nwhere $\\tilde{\\Delta}\\phi = \\delta^{kl}\\partial_k\\partial_l\\phi$ is the flat-space Laplacian.\nFor the second linear term, we need the trace of the Christoffel symbol:\n$$\n\\Gamma^k_{ik} = 2 [(\\partial_i\\phi)\\delta^k_k + (\\partial_k\\phi)\\delta^k_i - \\delta_{ik}\\partial^k\\phi] = 2 [3\\partial_i\\phi + \\partial_i\\phi - \\partial_i\\phi] = 6\\partial_i\\phi\n$$\nTaking the derivative, we get $\\partial_j \\Gamma^k_{ik} = 6\\partial_i\\partial_j\\phi$.\nThe total contribution from linear terms is:\n$$\n\\partial_k \\Gamma^k_{ij} - \\partial_j \\Gamma^k_{ik} = (4\\partial_i\\partial_j\\phi - 2\\delta_{ij}\\tilde{\\Delta}\\phi) - 6\\partial_i\\partial_j\\phi = -2\\partial_i\\partial_j\\phi - 2\\delta_{ij}\\tilde{\\Delta}\\phi\n$$\nThe quadratic terms in $\\phi$ are $\\Gamma^m_{ij}\\Gamma^k_{mk} - \\Gamma^m_{ik}\\Gamma^k_{mj}$:\n$$\n\\Gamma^m_{ij}\\Gamma^k_{mk} = [2 ((\\partial_i\\phi)\\delta^m_j + (\\partial_j\\phi)\\delta^m_i - \\delta_{ij}\\partial^m\\phi)] [6\\partial_m\\phi] = 12 [(\\partial_i\\phi)(\\partial_j\\phi) + (\\partial_j\\phi)(\\partial_i\\phi) - \\delta_{ij}\\partial^m\\phi\\partial_m\\phi]\n$$\n$$\n\\Gamma^m_{ij}\\Gamma^k_{mk} = 24(\\partial_i\\phi)(\\partial_j\\phi) - 12\\delta_{ij}|\\tilde{\\nabla}\\phi|^2\n$$\nwhere $|\\tilde{\\nabla}\\phi|^2 = \\delta^{kl}\\partial_k\\phi\\partial_l\\phi$.\nThe final term is $\\Gamma^m_{ik}\\Gamma^k_{mj}$:\n$$\n\\Gamma^m_{ik}\\Gamma^k_{mj} = [2 ((\\partial_i\\phi)\\delta^m_k + (\\partial_k\\phi)\\delta^m_i - \\delta_{ik}\\partial^m\\phi)] [2 ((\\partial_m\\phi)\\delta^k_j + (\\partial_j\\phi)\\delta^k_m - \\delta_{mj}\\partial^k\\phi)]\n$$\nThis product expands into nine terms which sum to:\n$$\n\\Gamma^m_{ik}\\Gamma^k_{mj} = 4[5(\\partial_i\\phi)(\\partial_j\\phi) - 2\\delta_{ij}|\\tilde{\\nabla}\\phi|^2] = 20(\\partial_i\\phi)(\\partial_j\\phi) - 8\\delta_{ij}|\\tilde{\\nabla}\\phi|^2\n$$\nThe total contribution from quadratic terms is:\n$$\n\\Gamma^m_{ij}\\Gamma^k_{mk} - \\Gamma^m_{ik}\\Gamma^k_{mj} = (24(\\partial_i\\phi)(\\partial_j\\phi) - 12\\delta_{ij}|\\tilde{\\nabla}\\phi|^2) - (20(\\partial_i\\phi)(\\partial_j\\phi) - 8\\delta_{ij}|\\tilde{\\nabla}\\phi|^2)\n$$\n$$\n= 4(\\partial_i\\phi)(\\partial_j\\phi) - 4\\delta_{ij}|\\tilde{\\nabla}\\phi|^2\n$$\nCombining linear and quadratic parts, we obtain the Ricci tensor from the ADM route:\n$$\nR_{ij}^{\\text{ADM}} = -2\\partial_i\\partial_j\\phi - 2\\delta_{ij}\\tilde{\\Delta}\\phi + 4(\\partial_i\\phi)(\\partial_j\\phi) - 4\\delta_{ij}|\\tilde{\\nabla}\\phi|^2\n$$\n\n### Part 2: Computation via BSSN Decomposition Route\n\nThe BSSN formalism relies on a standard result from differential geometry for the Ricci tensor of a conformally transformed metric $\\gamma_{ij} = \\exp(4\\phi)\\tilde{\\gamma}_{ij}$. The general formula in $3$ dimensions is:\n$$\nR_{ij} = \\tilde{R}_{ij} - 2(\\tilde{\\nabla}_i\\tilde{\\nabla}_j\\phi + \\tilde{\\gamma}_{ij}\\tilde{\\Delta}_{\\tilde{\\gamma}}\\phi) + 4(\\tilde{\\nabla}_i\\phi\\tilde{\\nabla}_j\\phi - \\tilde{\\gamma}_{ij}(\\tilde{\\nabla}\\phi)^2_{\\tilde{\\gamma}})\n$$\nwhere $\\tilde{\\nabla}$ is the covariant derivative compatible with $\\tilde{\\gamma}_{ij}$. The problem defines the BSSN route result as $R_{ij}^{\\text{BSSN}} = \\tilde{R}_{ij} + R^{\\phi}_{ij}$.\n\nIn our specific case, the conformal metric is flat, $\\tilde{\\gamma}_{ij} = \\delta_{ij}$, so its Ricci tensor $\\tilde{R}_{ij}$ is zero. The covariant derivatives $\\tilde{\\nabla}$ become partial derivatives $\\partial$.\nThus, we have:\n$$\n\\tilde{R}_{ij} = 0\n$$\nAnd $R^{\\phi}_{ij}$ is given by the remaining terms:\n$$\nR^{\\phi}_{ij} = -2(\\partial_i\\partial_j\\phi + \\delta_{ij}\\tilde{\\Delta}\\phi) + 4(\\partial_i\\phi\\partial_j\\phi - \\delta_{ij}|\\tilde{\\nabla}\\phi|^2)\n$$\n$$\nR^{\\phi}_{ij} = -2\\partial_i\\partial_j\\phi - 2\\delta_{ij}\\tilde{\\Delta}\\phi + 4\\partial_i\\phi\\partial_j\\phi - 4\\delta_{ij}|\\tilde{\\nabla}\\phi|^2\n$$\nThe total result from the BSSN decomposition is $R_{ij}^{\\text{BSSN}} = 0 + R^{\\phi}_{ij} = R^{\\phi}_{ij}$.\n\n### Part 3: Difference Tensor $\\Delta R_{ij}$\n\nThe problem defines the difference tensor as $\\Delta R_{ij} \\equiv R_{ij}^{\\text{ADM}} - (\\tilde{R}_{ij} + R^{\\phi}_{ij})$.\nFrom Part 1 and Part 2, we have:\n$$\nR_{ij}^{\\text{ADM}} = -2\\partial_i\\partial_j\\phi - 2\\delta_{ij}\\tilde{\\Delta}\\phi + 4\\partial_i\\phi\\partial_j\\phi - 4\\delta_{ij}|\\tilde{\\nabla}\\phi|^2\n$$\n$$\n\\tilde{R}_{ij} + R^{\\phi}_{ij} = 0 + (-2\\partial_i\\partial_j\\phi - 2\\delta_{ij}\\tilde{\\Delta}\\phi + 4\\partial_i\\phi\\partial_j\\phi - 4\\delta_{ij}|\\tilde{\\nabla}\\phi|^2)\n$$\nThe expressions are identical. Therefore, the difference tensor is identically zero:\n$$\n\\Delta R_{ij} = R_{ij}^{\\text{ADM}} - R_{ij}^{\\text{BSSN}} = 0\n$$\nThis result is a mathematical identity and holds true for any sufficiently differentiable conformal factor $\\phi$, at all points in the manifold. The specific form $\\phi = \\alpha\\,x\\,y + \\beta\\,z^{2}$ and the point $p$ with coordinates $(1,-1,2)$ are consistent with this general result. Evaluating at $p$:\n$$\n\\Delta R_{ij}|_p = 0\n$$\n\n### Part 4: Frobenius Norm $N$\n\nThe Frobenius norm is defined as $N \\equiv \\sqrt{\\gamma^{ik}\\,\\gamma^{jl}\\,\\Delta R_{ij}\\,\\Delta R_{kl}}$.\nSince $\\Delta R_{ij} = 0$ for all components $(i,j)$, the term inside the square root is zero:\n$$\n\\gamma^{ik}\\,\\gamma^{jl}\\,\\Delta R_{ij}\\,\\Delta R_{kl} = \\gamma^{ik}\\,\\gamma^{jl}\\,(0)\\,(0) = 0\n$$\nTherefore, the norm is:\n$$\nN = \\sqrt{0} = 0\n$$\nThis is a dimensionless real number, as requested.",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "The true power of the BSSN formalism lies not just in its mathematical elegance, but in its dramatic improvement of the numerical stability of simulations. This hands-on numerical experiment allows you to explore this critical feature by comparing the performance of different, yet algebraically equivalent, choices for the evolved conformal factor variable ($\\phi$, $W$, or $\\chi$). By implementing a simplified model of a moving puncture spacetime , you will gain practical insight into why specific variable choices are crucial for the robustness of modern numerical relativity codes.",
            "id": "3468207",
            "problem": "You will implement and analyze a self-contained, one-dimensional toy model that captures how different choices of the conformal factor variable in the Baumgarte–Shapiro–Shibata–Nakamura (BSSN) formulation influence numerical stability and the Hamiltonian constraint violation in a moving puncture context with one-plus-log slicing and Gamma-driver shift. The goal is to compare the effects of evolving three different conformal factor variables, namely $\\,\\phi\\,$, $\\,\\chi = e^{-4\\phi}\\,$, and $\\,W = e^{-2\\phi}\\,$, on the numerical accuracy and robustness of the discretized Hamiltonian constraint.\n\nStart from the following well-tested facts and core definitions:\n- In the $3+1$ decomposition of General Relativity (GR), the Hamiltonian constraint is a scalar equation that, in vacuum, relates intrinsic curvature of spatial slices to extrinsic curvature and energy density. \n- In the Baumgarte–Shapiro–Shibata–Nakamura (BSSN) formulation, one performs a conformal decomposition of the spatial metric $\\,\\gamma_{ij} = e^{4\\phi} \\tilde{\\gamma}_{ij}\\,$ with $\\,\\det \\tilde{\\gamma}_{ij} = 1\\,$, and uses evolved variables including the conformal factor $\\,\\phi\\,$ or its algebraic transforms $\\,\\chi = e^{-4\\phi}\\,$ or $\\,W = e^{-2\\phi}\\,$.\n- For conformally flat, time-symmetric, vacuum initial data corresponding to a Schwarzschild black hole in isotropic coordinates, the conformal factor is $\\,\\psi = 1 + \\frac{m}{2r}\\,$, and the physical spatial metric is $\\,\\gamma_{ij} = \\psi^{4} \\delta_{ij}\\,$. In this setting, the Hamiltonian constraint reduces to the flat-space Laplace equation $\\,\\Delta \\psi = 0\\,$ away from the puncture. Hence, the discrete Laplacian of $\\,\\psi\\,$ should be approximately zero, and its magnitude provides a surrogate measure of Hamiltonian constraint violation (up to a compactly supported distribution at the puncture, which we explicitly exclude from the diagnostic).\n\nTo model a single moving puncture with one-plus-log slicing and Gamma-driver shift without implementing the full system, adopt the following surrogate model in one spatial dimension:\n- Spatial coordinate $\\,x \\in [-L, L]\\,$ with a uniform grid.\n- Regularized isotropic conformal factor\n$$\n\\psi(x) = 1 + \\frac{m}{2\\sqrt{x^{2} + \\varepsilon^{2}}},\n$$\nwhere $\\,m > 0\\,$ and $\\,\\varepsilon > 0\\,$ soften the puncture so that all fields are finite.\n- Define the three conformal variable representations\n$$\n\\phi = \\ln \\psi,\\quad \\chi = e^{-4\\phi} = \\psi^{-4},\\quad W = e^{-2\\phi} = \\psi^{-2}.\n$$\n- To mimic the moving puncture with one-plus-log slicing and Gamma-driver shift, advect the chosen conformal variable $\\,q \\in \\{\\phi,\\chi,W\\}\\,$ by the linear transport equation\n$$\n\\partial_{t} q + v_{\\mathrm{eff}}(x) \\,\\partial_{x} q = 0,\n$$\nwith an effective advection speed\n$$\nv_{\\mathrm{eff}}(x) = v \\, W(x),\n$$\nwhere $\\,v > 0\\,$ is a constant parameter and $\\,W(x) = \\psi(x)^{-2}\\,$ is computed from the initial $\\,\\psi\\,$. This choice encodes that the one-plus-log slicing collapses the lapse near the puncture, slowing down advection through a factor proportional to $\\,W\\,$. The Gamma-driver shift is represented here in a reduced form by a constant-$\\,v\\,$ advection modulated by $\\,W$.\n\nNumerical discretization requirements:\n- Use a method of lines with a Strong Stability Preserving Runge–Kutta (SSP-RK3) time integrator.\n- Use a first-order, monotone upwind finite difference for the spatial derivative $\\,\\partial_{x} q\\,$ at each grid point, based on the sign of $\\,v_{\\mathrm{eff}}(x)\\,$. For $\\,v_{\\mathrm{eff}}(x) > 0\\,$, use the backward difference.\n- Impose simple outflow/zero-gradient boundary conditions by copying boundary values where the stencil would require data outside the domain.\n- Choose the time step $\\,\\Delta t\\,$ using a Courant–Friedrichs–Lewy (CFL) condition\n$$\n\\Delta t = \\mathrm{CFL} \\times \\frac{\\Delta x}{\\max_{x} |v_{\\mathrm{eff}}(x)|}.\n$$\n\nAfter evolving $\\,q\\,$ to the specified final time $\\,T\\,$, reconstruct $\\,\\psi\\,$ via the inverse map:\n- If $\\,q = \\phi\\,$, then $\\,\\psi = e^{\\phi}$.\n- If $\\,q = \\chi\\,$, then $\\,\\psi = \\chi^{-1/4}$.\n- If $\\,q = W\\,$, then $\\,\\psi = W^{-1/2}$.\n\nThen, compute the discrete Hamiltonian constraint residual surrogate\n$$\n\\mathcal{H}_i = \\frac{\\psi_{i+1} - 2\\psi_i + \\psi_{i-1}}{\\Delta x^2},\n$$\nonly on grid points satisfying $\\,|x_i| \\ge r_{\\mathrm{exc}}\\,$ to exclude the puncture core where the continuum equation includes a distributional source. Also exclude the outermost grid points where the stencil would be incomplete. Quantify the violation via the following two norms:\n- The root-mean-square norm\n$$\n\\|\\mathcal{H}\\|_{2} = \\sqrt{\\frac{1}{N_{\\mathrm{mask}}} \\sum_{i \\in \\mathrm{mask}} \\mathcal{H}_i^2},\n$$\nwhere $\\,N_{\\mathrm{mask}}\\,$ is the number of points in the mask.\n- The maximum norm\n$$\n\\|\\mathcal{H}\\|_{\\infty} = \\max_{i \\in \\mathrm{mask}} |\\mathcal{H}_i|.\n$$\n\nImplement the above for the following fixed physical profile parameters and diagnostics:\n- Use $\\,m = 1\\,$, $\\,\\varepsilon = 0.05\\,$, $\\,L = 5\\,$, and $\\,r_{\\mathrm{exc}} = 0.2\\,$.\n- Use the initial $\\,\\psi\\,$ profile as given above to construct $\\,\\phi\\,$, $\\,\\chi\\,$, and $\\,W\\,$ at $\\,t=0\\,$. Compute $\\,v_{\\mathrm{eff}}(x)\\,$ from the initial $\\,W\\,$ and keep it fixed in time.\n\nYour program must implement the following test suite, where each case is a tuple $\\,(\\mathrm{var}, N, \\mathrm{CFL}, v, T)\\,$:\n1. $\\,(\\text{\"phi\"}, 801, 0.4, 0.5, 0.5)\\,$\n2. $\\,(\\text{\"W\"}, 801, 0.4, 0.5, 0.5)\\,$\n3. $\\,(\\text{\"chi\"}, 801, 0.4, 0.5, 0.5)\\,$\n4. $\\,(\\text{\"phi\"}, 201, 0.4, 0.5, 0.5)\\,$\n5. $\\,(\\text{\"W\"}, 201, 0.4, 0.5, 0.5)\\,$\n6. $\\,(\\text{\"chi\"}, 201, 0.9, 0.8, 0.5)\\,$\n\nFor each test case, output a pair $[\\|\\mathcal{H}\\|_{2}, \\|\\mathcal{H}\\|_{\\infty}]$ as floating-point numbers.\n\nFinal output format:\n- Your program should produce a single line of output containing a list of the six results, each itself being a two-element list in the order of the test suite, for example:\n\"[ [h2_case1, hinf_case1], [h2_case2, hinf_case2], ..., [h2_case6, hinf_case6] ]\".\nAngles do not appear and no physical unit conversion is required. All outputs must be dimensionless floating-point numbers.",
            "solution": "The problem is valid. It presents a well-posed, scientifically grounded numerical experiment to investigate the properties of different conformal variable choices in the BSSN formulation of numerical relativity. All parameters and methods are explicitly defined, forming a self-contained and solvable problem.\n\nHerein, we present the methodology and implementation of a one-dimensional toy model simulating the advection of a puncture, designed to compare the numerical performance of three distinct conformal factor variables used in the Baumgarte–Shapiro–Shibata–Nakamura (BSSN) formalism.\n\n**1. Physical and Mathematical Model**\n\nThe foundation of this model is the conformally flat, time-symmetric initial data for a Schwarzschild black hole in isotropic coordinates. In this simplified context, the Hamiltonian constraint of General Relativity reduces to the flat-space Laplace equation for the conformal factor $\\psi$. The initial spatial profile of $\\psi$ is given by a regularized form:\n$$\n\\psi(x, t=0) = 1 + \\frac{m}{2\\sqrt{x^2 + \\varepsilon^2}}\n$$\nwhere $m=1$ is the mass parameter, and $\\varepsilon=0.05$ is a regularization parameter to soften the singularity at the puncture $x=0$. The spatial domain is $x \\in [-L, L]$ with $L=5$.\n\nWe investigate three different evolved variables, all derived from $\\psi$:\n1.  The logarithmic conformal factor: $\\phi = \\ln \\psi$\n2.  The $W$-factor: $W = e^{-2\\phi} = \\psi^{-2}$\n3.  The $\\chi$-factor: $\\chi = e^{-4\\phi} = \\psi^{-4}$\n\nThe dynamics are modeled by a linear advection equation, which serves as a surrogate for the complex evolution under one-plus-log slicing and a Gamma-driver shift condition. The chosen variable $q \\in \\{\\phi, W, \\chi\\}$ evolves according to:\n$$\n\\partial_t q + v_{\\mathrm{eff}}(x) \\partial_x q = 0\n$$\nThe effective advection velocity $v_{\\mathrm{eff}}(x)$ is fixed in time and determined by the initial state:\n$$\nv_{\\mathrm{eff}}(x) = v \\cdot W(x, t=0) = v \\cdot \\psi(x, t=0)^{-2}\n$$\nwhere $v$ is a constant parameter. Since $\\psi(x) \\ge 1$, we have $W(x) \\le 1$, and since $v>0$ in all test cases, the advection speed $v_{\\mathrm{eff}}(x)$ is always positive, indicating flow from left to right.\n\n**2. Numerical Discretization**\n\nWe employ the method of lines to solve the partial differential equation. The spatial domain $[-L, L]$ is discretized into a uniform grid of $N$ points $x_i$, with spacing $\\Delta x = \\frac{2L}{N-1}$.\n\n_Spatial Discretization_:\nThe spatial derivative $\\partial_x q$ is approximated using a first-order upwind scheme. Since $v_{\\mathrm{eff}}(x) > 0$ for all $x$, this corresponds to a backward finite difference:\n$$\n(\\partial_x q)_i \\approx \\frac{q_i - q_{i-1}}{\\Delta x}\n$$\nThis transforms the PDE into a system of Ordinary Differential Equations (ODEs) for the grid point values $q_i(t)$:\n$$\n\\frac{dq_i}{dt} = -v_{\\mathrm{eff},i} \\left( \\frac{q_i - q_{i-1}}{\\Delta x} \\right), \\quad \\text{for } i = 1, \\dots, N-1.\n$$\n\n_Boundary Conditions_:\nThe problem specifies \"outflow/zero-gradient\" boundary conditions realized by \"copying boundary values where the stencil would require data outside the domain.\" At the left (inflow) boundary $i=0$, the backward difference stencil requires a ghost point value $q_{-1}$. Following the specified rule, we set $q_{-1} = q_0$. This results in a zero spatial derivative at the boundary:\n$$\n(\\partial_x q)_0 \\approx \\frac{q_0 - q_0}{\\Delta x} = 0\n$$\nConsequently, the ODE for the boundary point is $\\frac{dq_0}{dt} = 0$, meaning $q_0$ remains constant throughout the evolution. The right boundary does not require a special condition, as the backward difference stencil does not access points outside the grid for any $i < N$.\n\n_Time Integration_:\nThe system of ODEs is integrated forward in time using the third-order Strong Stability Preserving Runge–Kutta (SSP-RK3) method. For an ODE system $\\frac{d\\vec{y}}{dt} = \\vec{F}(\\vec{y})$, one time step from $t_n$ to $t_{n+1}=t_n+\\Delta t$ is computed as:\n$$\n\\begin{aligned}\n\\vec{y}^{(1)} &= \\vec{y}_n + \\Delta t \\vec{F}(\\vec{y}_n) \\\\\n\\vec{y}^{(2)} &= \\frac{3}{4} \\vec{y}_n + \\frac{1}{4} \\vec{y}^{(1)} + \\frac{1}{4} \\Delta t \\vec{F}(\\vec{y}^{(1)}) \\\\\n\\vec{y}_{n+1} &= \\frac{1}{3} \\vec{y}_n + \\frac{2}{3} \\vec{y}^{(2)} + \\frac{2}{3} \\Delta t \\vec{F}(\\vec{y}^{(2)})\n\\end{aligned}\n$$\nThe time step $\\Delta t$ is determined by the Courant–Friedrichs–Lewy (CFL) condition to ensure numerical stability:\n$$\n\\Delta t = \\mathrm{CFL} \\times \\frac{\\Delta x}{\\max_{i} |v_{\\mathrm{eff},i}|}\n$$\nTo reach the final time $T$ exactly, we calculate the number of steps as $N_{\\mathrm{steps}} = \\lceil T / \\Delta t \\rceil$ and use a modified step size $\\Delta t' = T/N_{\\mathrm{steps}}$.\n\n**3. Analysis of Numerical Error**\n\nAfter evolving the chosen variable $q$ to final time $T$, we reconstruct the conformal factor $\\psi$ using the corresponding inverse transformation:\n- If $q = \\phi$, then $\\psi = e^{\\phi}$.\n- If $q = \\chi$, then $\\psi = \\chi^{-1/4}$.\n- If $q = W$, then $\\psi = W^{-1/2}$.\n\nThe numerical error is quantified by measuring the violation of the Hamiltonian constraint. For the given initial data, this constraint is proportional to the Laplacian of $\\psi$. We compute a discrete surrogate for this violation at each interior grid point $i \\in \\{1, \\dots, N-2\\}$:\n$$\n\\mathcal{H}_i = \\frac{\\psi_{i+1} - 2\\psi_i + \\psi_{i-1}}{\\Delta x^2}\n$$\nTo avoid diagnostics near the puncture core (where the continuum equation has a source term) and near the boundaries (where the stencil is incomplete), we evaluate the violation only on a masked set of grid points. The mask includes all interior points $x_i$ such that $|x_i| \\ge r_{\\mathrm{exc}}$, where $r_{\\mathrm{exc}}=0.2$.\n\nThe total violation is quantified using two norms over the $N_{\\mathrm{mask}}$ points in this masked region:\n- The L2 (root-mean-square) norm: $\\|\\mathcal{H}\\|_{2} = \\sqrt{\\frac{1}{N_{\\mathrm{mask}}} \\sum_{i \\in \\mathrm{mask}} \\mathcal{H}_i^2}$\n- The L-infinity (maximum) norm: $\\|\\mathcal{H}\\|_{\\infty} = \\max_{i \\in \\mathrm{mask}} |\\mathcal{H}_i|$\n\nThe implementation performs these steps for each case in the provided test suite and reports the pair $[\\|\\mathcal{H}\\|_{2}, \\|\\mathcal{H}\\|_{\\infty}]$.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite for the BSSN conformal variable toy model.\n    \"\"\"\n    test_cases = [\n        (\"phi\", 801, 0.4, 0.5, 0.5),\n        (\"W\", 801, 0.4, 0.5, 0.5),\n        (\"chi\", 801, 0.4, 0.5, 0.5),\n        (\"phi\", 201, 0.4, 0.5, 0.5),\n        (\"W\", 201, 0.4, 0.5, 0.5),\n        (\"chi\", 201, 0.9, 0.8, 0.5),\n    ]\n\n    # Fixed physical and diagnostic parameters\n    m = 1.0\n    eps = 0.05\n    L = 5.0\n    r_exc = 0.2\n\n    def rhs(q, v_eff, dx):\n        \"\"\"\n        Calculates the right-hand side of the semi-discretized advection equation\n        using a first-order upwind (backward) scheme.\n        dq/dt = -v_eff * dq/dx\n        \"\"\"\n        dqdt = np.zeros_like(q)\n        # Backward difference for i = 1 to N-1\n        grad_q = (q[1:] - q[:-1]) / dx\n        dqdt[1:] = -v_eff[1:] * grad_q\n        # dqdt[0] is 0 due to the zero-gradient boundary condition at inflow\n        return dqdt\n\n    def ssp_rk3_step(q, dt, v_eff, dx):\n        \"\"\"\n        Performs a single time step using the SSP-RK3 method.\n        \"\"\"\n        # Stage 1\n        q1 = q + dt * rhs(q, v_eff, dx)\n        # Stage 2\n        q2 = 0.75 * q + 0.25 * q1 + 0.25 * dt * rhs(q1, v_eff, dx)\n        # Stage 3\n        q_next = (1.0 / 3.0) * q + (2.0 / 3.0) * q2 + (2.0 / 3.0) * dt * rhs(q2, v_eff, dx)\n        return q_next\n\n    results = []\n    for case in test_cases:\n        var_name, N, CFL, v, T = case\n\n        # 1. Setup grid and initial conditions\n        x = np.linspace(-L, L, N)\n        dx = x[1] - x[0]\n\n        psi_0 = 1.0 + m / (2.0 * np.sqrt(x**2 + eps**2))\n\n        # The advection velocity is fixed in time based on the initial W profile\n        w_initial = psi_0**(-2.0)\n        v_eff = v * w_initial\n\n        if var_name == \"phi\":\n            q0 = np.log(psi_0)\n        elif var_name == \"W\":\n            q0 = psi_0**(-2.0)\n        elif var_name == \"chi\":\n            q0 = psi_0**(-4.0)\n        else:\n            raise ValueError(f\"Unknown variable name: {var_name}\")\n        \n        q = q0.copy()\n\n        # 2. Time evolution\n        dt_cfl = CFL * dx / np.max(np.abs(v_eff))\n        if dt_cfl = 0:\n            # Handle cases with zero velocity if they occurred\n            n_steps = 1\n        else:\n            n_steps = int(np.ceil(T / dt_cfl))\n        \n        # Use a constant dt to reach T exactly\n        dt = T / n_steps\n\n        for _ in range(n_steps):\n            q = ssp_rk3_step(q, dt, v_eff, dx)\n        \n        q_final = q\n\n        # 3. Reconstruct psi and compute Hamiltonian violation\n        if var_name == \"phi\":\n            psi_final = np.exp(q_final)\n        elif var_name == \"W\":\n            psi_final = q_final**(-0.5)\n        elif var_name == \"chi\":\n            psi_final = q_final**(-0.25)\n            \n        # Compute discrete Laplacian (Hamiltonian surrogate)\n        H_residual = np.zeros(N)\n        H_residual[1:-1] = (psi_final[2:] - 2 * psi_final[1:-1] + psi_final[:-2]) / dx**2\n        \n        # 4. Apply mask and compute norms\n        # Mask for valid indices (interior points for Laplacian)\n        interior_indices = np.arange(1, N - 1)\n        x_interior = x[interior_indices]\n        H_interior = H_residual[interior_indices]\n        \n        # Further mask to exclude the puncture core\n        puncture_mask = np.abs(x_interior) >= r_exc\n        \n        H_masked = H_interior[puncture_mask]\n        \n        n_mask = len(H_masked)\n        if n_mask > 0:\n            h2_norm = np.sqrt(np.sum(H_masked**2) / n_mask)\n            hinf_norm = np.max(np.abs(H_masked))\n        else:\n            h2_norm = 0.0\n            hinf_norm = 0.0\n            \n        results.append([h2_norm, hinf_norm])\n\n    # Convert results to string for the required output format\n    result_str = \"[\" + \", \".join([f\"[{res[0]}, {res[1]}]\" for res in results]) + \"]\"\n    print(result_str)\n\nsolve()\n```"
        }
    ]
}