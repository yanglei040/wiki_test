{
    "hands_on_practices": [
        {
            "introduction": "理论联系实践的第一步，是验证其在理想情况下的表现。我们将从一个简单的线性化平面引力波开始，它处于横向无迹（TT）规范下，是线性化真空爱因斯坦方程的一个精确解。这项练习  旨在确认，对于这样一个理想解，如果我们选择最简单的规范源函数 $H_\\mu=0$，那么广义谐波规范（GHG）的约束量 $C_\\mu$ 在初始时刻为零，并将在演化过程中保持为零。这有助于我们建立对基本定义的信心，并理解约束保持的基本原理。",
            "id": "3491540",
            "problem": "考虑广义相对论的广义谐波规范 (GHG) 表述，在该表述中，坐标满足协变波动方程 $\\Box x^{\\mu} = H^{\\mu}$，其中源函数为 $H^{\\mu}$，相关的约束为 $C_{\\mu} \\equiv H_{\\mu} + \\Gamma_{\\mu}$，其中 $\\Gamma_{\\mu} \\equiv g_{\\mu \\nu} g^{\\alpha \\beta} \\Gamma^{\\nu}_{\\alpha \\beta}$。在一个度规为 $\\eta_{\\mu \\nu}$、符号为 $(-,+,+,+)$、坐标为 $x^{\\mu} = (t,x,y,z)$ 的闵可夫斯基背景上进行计算。考虑一个沿 $+z$ 方向传播的“+”偏振线性化平面引力波，其在闵可夫斯基时空上表现为一个小的度规微扰 $h_{\\mu \\nu}$，在无量纲振幅 $A$ 的线性阶下，\n$$\nh_{xx}(t,z) = A \\cos\\!\\big(k(z - t)\\big), \\quad h_{yy}(t,z) = -A \\cos\\!\\big(k(z - t)\\big),\n$$\n且 $h_{\\mu \\nu}$ 的所有其他分量为零。这里，$k > 0$ 是一个固定的波数，指标由 $\\eta_{\\mu \\nu}$ 进行升降。假设真空环境，并忽略除规范源函数之外的其他源。\n\n任务 1 (初始数据构造)：仅使用上述设置所蕴含的线性阶表达式和 $C_{\\mu}$ 的定义，在初始切片 $t=0$ 上构造 $H_{\\mu}$，使得对于给定的波，$C_{\\mu}(0,z) = 0$。您必须严格在 $A$ 的一阶下进行计算，并通过计算给定 $h_{\\mu \\nu}$ 的相关几何量来证明您对 $H_{\\mu}$ 的选择是合理的。\n\n任务 2 (带阻尼的约束演化)：假设一个标准的、恒定的约束阻尼参数 $\\gamma_{0} > 0$ 被添加到 GHG 演化方程中，使得在闵可夫斯基时空附近的线性阶上，约束向量 $C_{\\mu}$ 在由 $\\gamma_{0}$ 生成的、与 GHG 系统主部一致的齐次、双曲、阻尼传播下演化。从您的初始数据出发，预测 $t > 0$ 时的 $C_{\\mu}(t,z)$。将您的最终答案表示为下标约束分量 $C_{\\mu}(t,z)$ 的 4 分量行向量，分量顺序为 $\\mu = 0,1,2,3$。最终表达式无需进行数值舍入，也不应包含任何物理单位。",
            "solution": "该问题定义明确，并在广义相对论理论，特别是广义谐波规范 (GHG) 表述中具有坚实的科学基础。所有术语和条件都已正式定义。我们将按要求解决这两个任务。\n\n问题要求我们使用度规 $g_{\\mu \\nu} = \\eta_{\\mu \\nu} + h_{\\mu \\nu}$，其中 $\\eta_{\\mu \\nu}$ 是符号为 $(-,+,+,+)$ 的闵可夫斯基度规，$h_{\\mu \\nu}$ 是 $A$ 阶的一个小微扰。给定的非零微扰分量为：\n$$\nh_{xx}(t,z) = A \\cos(k(z - t))\n$$\n$$\nh_{yy}(t,z) = -A \\cos(k(z - t))\n$$\n$h_{\\mu \\nu}$ 的所有其他分量均为零。计算将严格在振幅 $A$ 的一阶下进行。\n\n### 任务 1：$H_{\\mu}$ 的初始数据构造\n\n第一个任务是在初始类空切片 $t=0$ 上构造规范源函数 $H_{\\mu}$，使得 GHG 约束 $C_{\\mu}(0,z)$ 为零。约束的定义为：\n$$\nC_{\\mu} \\equiv H_{\\mu} + \\Gamma_{\\mu}\n$$\n因此，条件 $C_{\\mu}(0,z) = 0$ 要求我们选择的 $H_{\\mu}$ 满足：\n$$\nH_{\\mu}(0,z) = -\\Gamma_{\\mu}(0,z)\n$$\n为了确定 $H_{\\mu}(0,z)$，我们必须首先计算给定度规微扰的 $\\Gamma_{\\mu}$。提供的定义是：\n$$\n\\Gamma_{\\mu} \\equiv g_{\\mu \\nu} g^{\\alpha \\beta} \\Gamma^{\\nu}_{\\alpha \\beta}\n$$\n其中 $\\Gamma^{\\nu}_{\\alpha \\beta}$ 是克里斯托费尔符号。这个表达式可以被识别为 $\\Gamma_{\\mu} = g_{\\mu \\nu} \\Gamma^{\\nu}$，其中 $\\Gamma^{\\nu} \\equiv g^{\\alpha \\beta} \\Gamma^{\\nu}_{\\alpha \\beta}$ 是标准的谐波规范源项。\n\n我们需要计算 $\\Gamma_{\\mu}$ 到 $A$ 的一阶。我们对相关量进行线性化：\n$g_{\\mu \\nu} = \\eta_{\\mu \\nu} + h_{\\mu \\nu}$\n$g^{\\mu \\nu} \\approx \\eta^{\\mu \\nu} - h^{\\mu \\nu}$\n克里斯托费尔符号是 $A$ 的一阶量：\n$\\Gamma^{\\nu}_{\\alpha \\beta} \\approx \\delta\\Gamma^{\\nu}_{\\alpha \\beta} = \\frac{1}{2} \\eta^{\\nu \\sigma} (\\partial_{\\alpha} h_{\\sigma \\beta} + \\partial_{\\beta} h_{\\sigma \\alpha} - \\partial_{\\sigma} h_{\\alpha \\beta})$。\n\n$\\Gamma^{\\nu}$ 的一阶项由 $\\Gamma^{\\nu} \\approx \\eta^{\\alpha \\beta} \\delta\\Gamma^{\\nu}_{\\alpha \\beta}$ 给出。乘积 $g^{\\alpha \\beta} \\Gamma^{\\nu}_{\\alpha \\beta} = (\\eta^{\\alpha \\beta} - h^{\\alpha \\beta}) \\delta\\Gamma^{\\nu}_{\\alpha \\beta} = \\eta^{\\alpha \\beta} \\delta\\Gamma^{\\nu}_{\\alpha \\beta} + O(A^2)$。\n那么，$\\Gamma_{\\mu} = g_{\\mu \\nu} \\Gamma^{\\nu} = (\\eta_{\\mu \\nu} + h_{\\mu \\nu})\\Gamma^{\\nu} \\approx \\eta_{\\mu \\nu} \\Gamma^{\\nu} + O(A^2)$。\n因此，在一阶下，我们需要计算 $\\Gamma_{\\mu} \\approx \\eta_{\\mu \\nu} (\\eta^{\\alpha \\beta} \\delta\\Gamma^{\\nu}_{\\alpha \\beta})$。\n\n一个已知的恒等式将其简化为：\n$$\n\\Gamma_{\\mu} \\approx \\partial^{\\alpha} h_{\\mu \\alpha} - \\frac{1}{2} \\partial_{\\mu} h\n$$\n其中指标用 $\\eta^{\\mu\\nu}$ 升格，而 $h = \\eta^{\\mu \\nu} h_{\\mu \\nu}$ 是微扰的迹。\n\n我们来计算迹 $h$：\n$$\nh = \\eta^{\\mu \\nu} h_{\\mu \\nu} = \\eta^{00}h_{00} + \\eta^{11}h_{11} + \\eta^{22}h_{22} + \\eta^{33}h_{33} = (1)h_{xx} + (1)h_{yy} = A \\cos(k(z-t)) - A \\cos(k(z-t)) = 0\n$$\n由于迹 $h$ 为零，$\\Gamma_{\\mu}$ 的表达式简化为 $\\Gamma_{\\mu} \\approx \\partial^{\\alpha} h_{\\mu \\alpha}$。\n\n现在我们计算 $\\partial^{\\alpha} h_{\\mu \\alpha} = \\eta^{\\alpha \\beta} \\partial_{\\beta} h_{\\mu \\alpha}$ 的分量：\n对于 $\\mu=0$（$t$ 分量）：\n$$\n\\Gamma_{0} \\approx \\partial^{\\alpha} h_{0 \\alpha} = \\eta^{\\alpha \\beta} \\partial_{\\beta} h_{0 \\alpha} = -\\partial_{t} h_{00} + \\partial_{x} h_{0x} + \\partial_{y} h_{0y} + \\partial_{z} h_{0z}\n$$\n所有分量 $h_{0\\alpha}$ 均为零，所以 $\\Gamma_{0}=0$。\n\n对于 $\\mu=1$（$x$ 分量）：\n$$\n\\Gamma_{1} \\approx \\partial^{\\alpha} h_{1 \\alpha} = \\eta^{\\alpha \\beta} \\partial_{\\beta} h_{1 \\alpha} = -\\partial_{t} h_{10} + \\partial_{x} h_{1x} + \\partial_{y} h_{1y} + \\partial_{z} h_{1z}\n$$\n唯一非零的分量是 $h_{11} = h_{xx}$。表达式变为 $\\Gamma_{1} \\approx \\partial_{x} h_{xx}$。由于 $h_{xx}$ 仅是 $(t, z)$ 的函数，其对 $x$ 的偏导数为零。因此，$\\Gamma_{1}=0$。\n\n对于 $\\mu=2$（$y$ 分量）：\n$$\n\\Gamma_{2} \\approx \\partial^{\\alpha} h_{2 \\alpha} = \\eta^{\\alpha \\beta} \\partial_{\\beta} h_{2 \\alpha} = -\\partial_{t} h_{20} + \\partial_{x} h_{2x} + \\partial_{y} h_{2y} + \\partial_{z} h_{2z}\n$$\n唯一非零的分量是 $h_{22} = h_{yy}$。表达式变为 $\\Gamma_{2} \\approx \\partial_{y} h_{yy}$。由于 $h_{yy}$ 仅是 $(t, z)$ 的函数，其对 $y$ 的偏导数为零。因此，$\\Gamma_{2}=0$。\n\n对于 $\\mu=3$（$z$ 分量）：\n$$\n\\Gamma_{3} \\approx \\partial^{\\alpha} h_{3 \\alpha} = \\eta^{\\alpha \\beta} \\partial_{\\beta} h_{3 \\alpha} = -\\partial_{t} h_{30} + \\partial_{x} h_{3x} + \\partial_{y} h_{3y} + \\partial_{z} h_{3z}\n$$\n所有分量 $h_{3\\alpha}$ 均为零，所以 $\\Gamma_{3}=0$。\n\n我们的计算表明，对于所有时空点，在 $A$ 的一阶下 $\\Gamma_{\\mu}(t,z) = 0$。这是预料之中的，因为给定的横向无迹平面波是标准谐波规范下的一个解，而对于该规范 $\\Gamma^{\\mu}=0$。\n因此，在初始切片 $t=0$ 上，我们有 $\\Gamma_{\\mu}(0,z)=0$。\n为了满足约束条件 $C_{\\mu}(0,z)=0$，我们必须选择：\n$$\nH_{\\mu}(0,z) = -\\Gamma_{\\mu}(0,z) = 0\n$$\n\n### 任务 2：约束演化\n\n第二个任务是预测 $t > 0$ 时的约束向量 $C_{\\mu}(t,z)$。我们被告知 $C_{\\mu}$ 根据一个齐次、双曲、阻尼传播方程演化，该方程具有一个恒定的阻尼参数 $\\gamma_0 > 0$。该方程的主部是波算符 $\\Box = \\eta^{\\alpha \\beta}\\partial_{\\alpha}\\partial_{\\beta} = -\\partial_{t}^{2} + \\partial_{x}^{2} + \\partial_{y}^{2} + \\partial_{z}^{2}$。与问题描述一致的这种阻尼演化的一个标准形式是：\n$$\n\\Box C_{\\mu} + \\gamma_{0} \\partial_{t} C_{\\mu} = 0\n$$\n这是一个二阶线性齐次偏微分方程。为了找到 $t > 0$ 的唯一解，我们需要 $C_{\\mu}$ 及其在 $t=0$ 时的一阶时间导数 $\\partial_{t} C_{\\mu}$ 的初始数据。\n\n从任务 1 中，我们得到场本身的初始条件：\n$$\nC_{\\mu}(0,z) = 0\n$$\n接下来，我们确定初始时间导数 $\\partial_{t} C_{\\mu}(0,z)$。从定义 $C_{\\mu} = H_{\\mu} + \\Gamma_{\\mu}$，我们有：\n$$\n\\partial_{t} C_{\\mu}(t,z) = \\partial_{t} H_{\\mu}(t,z) + \\partial_{t} \\Gamma_{\\mu}(t,z)\n$$\n如任务 1 所证，对于所有 $t$ 和 $z$，在一阶下 $\\Gamma_{\\mu}(t,z)=0$。因此，其时间导数也为零：$\\partial_{t} \\Gamma_{\\mu}(t,z) = 0$。这使表达式简化为：\n$$\n\\partial_{t} C_{\\mu}(t,z) = \\partial_{t} H_{\\mu}(t,z)\n$$\n在初始时刻 $t=0$，我们有 $\\partial_{t} C_{\\mu}(0,z) = \\partial_{t} H_{\\mu}(0,z)$。规范源函数 $H_{\\mu}$ 是可以自由指定的。我们已经确定必须选择 $H_{\\mu}(0,z)=0$。问题没有规定 $H_{\\mu}$ 在 $t>0$ 时如何演化。最直接且一致的选择是维持满足约束的最简单规范。选择对于所有 $t \\geq 0$ 都有 $H_{\\mu}(t,z) = 0$ 与任务 1 的初始数据是一致的。这个选择意味着 $\\partial_{t} H_{\\mu}(0,z) = 0$。\n\n通过这个选择，$C_{\\mu}$ 演化的初始数据是：\n1. $C_{\\mu}(0,z) = 0$\n2. $\\partial_{t} C_{\\mu}(0,z) = 0$\n\n我们现在求解的是齐次线性偏微分方程 $\\Box C_{\\mu} + \\gamma_{0} \\partial_{t} C_{\\mu} = 0$ 在零初始数据下的初值问题。根据线性双曲方程解的唯一性定理，唯一可能的解是平凡解：\n$$\nC_{\\mu}(t,z) = 0 \\quad \\text{对于所有 } t \\geq 0\n$$\n因此，约束向量的四个分量都为零。\n\n最终答案是 4 分量向量 $(C_0, C_1, C_2, C_3)$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0  0  0  0\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在实际的数值模拟中，理想情况非常罕见。约束违背可能源于数值截断误差，或者更常见地，源于不完美的边界条件。这个练习  提供了一个具体的数值实验平台来研究这种行为。我们将模拟控制约束传播的波动方程，并观察不真实的“约束流入”如何通过边界污染整个求解区域，这突显了精确的边界处理和有效的约束控制在数值相对论中的重要性。",
            "id": "3491526",
            "problem": "您需要构建一个小型的数值实验，用于探究广义谐波规范 (Generalized Harmonic Gauge, GHG) 公式在线性化体系中的约束行为，该体系与数值相对论和引力波相关。请在光速为1的几何单位制中进行，因此所有量均为无量纲。角度必须以弧度表示。\n\n请从以下公认的基底和定义开始。\n\n- 广义谐波规范 (GHG) 公式引入了规范源函数 $H_{\\mu}$，并将谐波约束定义为\n$$\nC_{\\mu} \\equiv H_{\\mu} + \\Gamma_{\\mu},\n$$\n其中 $\\Gamma_{\\mu} \\equiv g^{\\alpha\\beta} \\Gamma_{\\alpha\\beta\\mu}$，而 $\\Gamma_{\\alpha\\beta\\mu}$ 是度规 $g_{\\mu\\nu}$ 的克里斯托费尔符号。\n\n- 在闵可夫斯基时空附近进行线性化：$g_{\\mu\\nu} = \\eta_{\\mu\\nu} + h_{\\mu\\nu}$，其中 $|h_{\\mu\\nu}| \\ll 1$，$\\eta_{\\mu\\nu} = \\mathrm{diag}(-1,1,1,1)$。在线性阶上，缩并的克里斯托费尔符号为\n$$\n\\Gamma_{\\mu} = \\partial^{\\nu} h_{\\mu\\nu} - \\tfrac{1}{2} \\partial_{\\mu} h,\n$$\n其中 $h \\equiv \\eta^{\\alpha\\beta} h_{\\alpha\\beta}$ 且 $\\partial^{\\nu} \\equiv \\eta^{\\nu\\alpha} \\partial_{\\alpha}$。\n\n- 线性化真空爱因斯坦方程的一个标准横向无迹 (Transverse-Traceless, TT) 引力波解是沿 $x$ 轴传播的平面波，其中只有\n$$\nh_{yy}(t,x) = A \\cos\\big(k(x - t)\\big), \\quad h_{zz}(t,x) = - h_{yy}(t,x),\n$$\n且所有其他分量为零。该解满足 $h = 0$ 和 $\\partial^{\\nu} h_{\\mu\\nu} = 0$；因此，当 $H_{\\mu} = 0$ 时，我们恒有 $C_{\\mu} = 0$。\n\n- 由缩并比安基恒等式和 GHG 简化得到的约束传播系统是关于 $C_{\\mu}$ 的一个波动方程。在线性、平坦背景、一维（仅依赖于 $x$）的情况下，它简化为\n$$\n\\partial_t^2 C_{\\mu} - \\partial_x^2 C_{\\mu} = 0,\n$$\n对于每个分量 $C_{\\mu}$，这忽略了在闵可夫斯基时空中消失且在此处考虑的线性化体系中可忽略的低阶项。\n\n您的任务是：\n\n1) 解析 TT 情况：在固定的时间 $t_{\\mathrm{TT}}$ 和波数 $k$ 下，使用振幅 $A$ 构建上述的 TT 平面波 $h_{\\mu\\nu}$。使用线性化公式 $C_{\\mu} = H_{\\mu} + \\Gamma_{\\mu}$（其中 $H_{\\mu} = 0$）在一维 $x$ 网格上计算 $C_{\\mu}$。在这种设置下，$h$ 和 $\\partial^{\\nu} h_{\\mu\\nu}$ 在解析上为零，因此 $C_{\\mu} = 0$。在网格上数值计算 $C_{\\mu}$，并报告最大绝对值 $\\max_{x,\\mu} |C_{\\mu}(t_{\\mathrm{TT}},x)|$。\n\n2) 带边界流入的约束传播：数值求解单个标量约束分量 $C$ 的一维波动方程\n$$\n\\partial_t^2 C - \\partial_x^2 C = 0,\n$$\n在空间区间 $x \\in [0,L]$ 上，初始数据为零，即 $C(0,x) = 0$ 和 $\\partial_t C(0,x) = 0$。使用二阶精度的显式蛙跳有限差分法，库朗因子 $\\lambda = \\Delta t / \\Delta x \\leq 1$。施加吸收（索末菲）边界条件：\n- 左边界流入（在 $x=0$ 处）：$C_t + C_x = s(t)$。\n- 右边界流出（在 $x=L$ 处）：$C_t - C_x = 0$。\n这里 $s(t)$ 是一个给定的输入信号，模拟进入区域并激发约束的规范源扰动。\n\n对于边界更新，在每个时间层 $t^n = n \\Delta t$ 使用时间中心化的离散索末菲关系：\n$$\n\\frac{C^{n+1}_0 - C^{n-1}_0}{2\\Delta t} + \\frac{C^{n}_1 - C^{n}_0}{\\Delta x} = s(t^n),\n\\qquad\n\\frac{C^{n+1}_{N-1} - C^{n-1}_{N-1}}{2\\Delta t} - \\frac{C^{n}_{N-1} - C^{n}_{N-2}}{\\Delta x} = 0,\n$$\n其中 $N$ 是网格点数，$C^n_i \\approx C(t^n, x_i)$，且 $x_i = i \\Delta x$ 对于 $i=0,\\dots,N-1$。\n\n设计并计算以下测试套件。所有参数均采用几何单位制，角度以弧度为单位。\n\n- 测试 1 (TT 验证)：使用 $A = 10^{-6}$、$k = 2\\pi$、$t_{\\mathrm{TT}} = 1.0$，域为 $[0,L]$ 且 $L = 1.0$，在 $x$ 方向有 $N = 801$ 个网格点。计算最大绝对值 $\\max_{x,\\mu} |C_{\\mu}(t_{\\mathrm{TT}},x)|$；对于解析 TT 波和 $H_{\\mu}=0$ 的情况，该值应为零。\n\n- 测试 2 (无流入基准)：求解 $C$ 的波动方程，参数为 $L = 1.0$、$N = 801$、库朗因子 $\\lambda = 0.9$、最终时间 $t_{\\mathrm{final}} = 0.8$、输入信号 $s(t) \\equiv 0$。报告在 $t_{\\mathrm{final}}$ 时 $C$ 的离散 $L^2$ 范数是否低于 $10^{-14}$ 的布尔值，\n$$\n\\left( \\sum_{i=0}^{N-1} C^2(t_{\\mathrm{final}}, x_i) \\, \\Delta x \\right)^{1/2}  10^{-14}.\n$$\n\n- 测试 3 (高斯流入和解析验证)：使用 $L = 1.0$、$N = 801$、库朗因子 $\\lambda = 0.9$、最终时间 $t_{\\mathrm{final}} = 0.6$，以及输入信号\n$$\ns(t) = \\varepsilon \\exp\\!\\left( - \\frac{(t - t_0)^2}{\\sigma^2} \\right),\n$$\n其中 $\\varepsilon = 10^{-5}$、$t_0 = 0.2$、$\\sigma = 0.05$。对于在 $x=L$ 处有吸收边界且初始数据为零的半线波动问题，任意内部点 $x$ 处的解析解为 $C_{\\mathrm{analytic}}(t,x) = s(t - x)$（对于 $t \\ge x$）。计算在 $x_\\star = 0.3$ 和 $t_{\\mathrm{final}} = 0.6$ 处的数值解 $C$，并报告相对误差\n$$\n\\mathrm{err}_{\\mathrm{rel}} = \\frac{\\left| C_{\\mathrm{num}}(t_{\\mathrm{final}}, x_\\star) - s(t_{\\mathrm{final}} - x_\\star) \\right|}{\\max\\!\\left( |s(t_{\\mathrm{final}} - x_\\star)|, 10^{-30} \\right)}.\n$$\n\n- 测试 4 (高库朗因子下正弦流入的稳定性)：使用 $L = 1.0$、$N = 801$、库朗因子 $\\lambda = 0.99$、最终时间 $t_{\\mathrm{final}} = 2.0$，以及输入信号\n$$\ns(t) = \\varepsilon \\sin(\\omega t),\n$$\n其中 $\\varepsilon = 10^{-6}$ 和 $\\omega = 2\\pi \\times 10$。报告一个布尔值，指示在整个计算域和整个演化过程中 $C$ 的最大绝对值是否满足\n$$\n\\max_{0 \\le n \\le t_{\\mathrm{final}}/\\Delta t}\\ \\max_{0 \\le i \\le N-1} |C^n_i| \\le 10 \\varepsilon.\n$$\n\n最终输出格式要求：\n- 您的程序应生成单行输出，其中包含所有四个测试的结果，以逗号分隔的列表形式包含在方括号内，顺序为\n$$\n\\big[ r_1, r_2, r_3, r_4 \\big],\n$$\n其中 $r_1$ 是来自测试 1 的浮点数，$r_2$ 是来自测试 2 的布尔值，$r_3$ 是来自测试 3 的浮点数，$r_4$ 是来自测试 4 的布尔值。例如，一个有效的输出可能看起来像“[0.0,True,1e-6,True]”。",
            "solution": "我们将广义相对论的基本原理与具体的数值算法联系起来。\n\n1) 线性化的广义谐波规范 (GHG) 与约束。在 GHG 公式中，规范约束为 $C_{\\mu} \\equiv H_{\\mu} + \\Gamma_{\\mu}$，其中 $\\Gamma_{\\mu} \\equiv g^{\\alpha\\beta} \\Gamma_{\\alpha\\beta\\mu}$。在闵可夫斯基时空 $g_{\\mu\\nu} = \\eta_{\\mu\\nu} + h_{\\mu\\nu}$ 附近线性化并仅保留一阶项，得到\n$$\n\\Gamma_{\\mu} = \\partial^{\\nu} h_{\\mu\\nu} - \\tfrac{1}{2} \\partial_{\\mu} h,\n$$\n其中 $h \\equiv \\eta^{\\alpha\\beta} h_{\\alpha\\beta}$。对于沿 $x$ 轴传播的平面波，在横向无迹 (TT) 规范下，非零分量为 $h_{yy} = A \\cos(k(x-t))$ 和 $h_{zz} = - h_{yy}$，这导致 $h = h_{yy} + h_{zz} = 0$ 和 $\\partial^{\\nu} h_{\\mu\\nu} = 0$。因此，对于 $H_{\\mu} = 0$，我们恒有 $C_{\\mu} = 0$。在数值上，我们在固定时间 $t_{\\mathrm{TT}}$ 的空间网格上构建 $h_{\\mu\\nu}$，通过线性化表达式计算 $\\Gamma_{\\mu}$，并评估 $C_{\\mu} = \\Gamma_{\\mu}$ (因为 $H_{\\mu} = 0$)。在这种 TT 设置下，所有有贡献的导数都为零，所以最大绝对值 $|C_{\\mu}|$ 在浮点舍入误差范围内为零。\n\n2) 约束传播方程。GHG 简化的爱因斯坦方程与缩并比安基恒等式一起，意味着约束服从一个双曲型传播系统。在平坦背景下，主导阶算子变为达朗贝尔算子，给出波动方程\n$$\n\\partial_t^2 C_{\\mu} - \\partial_x^2 C_{\\mu} = 0.\n$$\n这是在线性、平坦、一维设置下约束违背的基本传播方程。我们的数值实验针对一个代表性的分量 $C$ 对此波动方程进行积分。\n\n3) 数值格式。我们将 $x \\in [0,L]$ 离散化为 $N$ 个点，$x_i = i \\Delta x$, $i=0,\\dots,N-1$。对 $u(t,x) \\equiv C(t,x)$ 使用显式蛙跳格式：\n- 定义 $u^n_i \\approx u(t^n, x_i)$，其中 $t^n = n \\Delta t$，库朗因子 $\\lambda = \\Delta t / \\Delta x$。\n- 内部点更新（对于 $1 \\le i \\le N-2$）：\n$$\nu^{n+1}_i = 2 u^n_i - u^{n-1}_i + \\lambda^2 \\left( u^n_{i+1} - 2 u^n_i + u^n_{i-1} \\right).\n$$\n- 边界条件实现索末菲关系：\n$$\n\\frac{u^{n+1}_0 - u^{n-1}_0}{2\\Delta t} + \\frac{u^{n}_1 - u^{n}_0}{\\Delta x} = s(t^n),\n\\qquad\n\\frac{u^{n+1}_{N-1} - u^{n-1}_{N-1}}{2\\Delta t} - \\frac{u^{n}_{N-1} - u^{n}_{N-2}}{\\Delta x} = 0.\n$$\n- 零初始数据初始化使用 $u^0_i = 0$ 和 $u^{-1}_i = u^0_i - \\Delta t\\, \\partial_t u(0,x_i) = 0$，因为 $\\partial_t u(0,x) = 0$。\n\n该格式在空间和时间上是二阶精确的，并且对于 $\\lambda \\le 1$ 是稳定的。\n\n4) 测试设计与解析参考。\n- 测试 1 使用 TT 波从 $h_{\\mu\\nu}$ 计算 $C_{\\mu}$ 并返回最大绝对值；解析上，它为零，因为在 TT 规范下 $h$ 和 $\\partial^{\\nu} h_{\\mu\\nu}$ 均为零。\n- 测试 2 确认如果 $s(t) \\equiv 0$ 且初始数据为零，则数值解保持为零；我们报告最终时间的离散 $L^2$ 范数是否小于 $10^{-14}$。\n- 测试 3 指定一个高斯流入 $s(t) = \\varepsilon \\exp(-((t-t_0)/\\sigma)^2)$。对于左边界的索末菲条件和吸收的右边界，精确的内部解是 $u(t,x) = s(t - x)$（对于 $t \\ge x$）。我们评估在 $(t_{\\mathrm{final}}, x_\\star)$ 处的相对误差。\n- 测试 4 使用高库朗因子 $\\lambda = 0.99$ 的正弦流入。我们监控最大振幅，并检查它是否保持在 $10 \\varepsilon$ 的界限内，这表明了数值稳定性和正确的边界处理。\n\n5) 输出的实现细节。\n- 测试 1 返回 $r_1 = \\max_{x,\\mu} |C_{\\mu}(t_{\\mathrm{TT}},x)|$ 作为浮点数。\n- 测试 2 返回 $r_2$ 作为布尔值，指示离散 $L^2$ 范数是否低于 $10^{-14}$。\n- 测试 3 返回 $r_3 = \\mathrm{err}_{\\mathrm{rel}}$ 作为浮点数。\n- 测试 4 返回 $r_4$ 作为布尔值，指示 $\\max_{n,i} |u^n_i| \\le 10 \\varepsilon$ 是否成立。\n\n程序将这些结果按精确顺序 $[r_1, r_2, r_3, r_4]$ 聚合，并以指定格式打印单行输出。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef tt_wave_Cmax(A, k, t_TT, L, N):\n    \"\"\"\n    Construct TT plane wave h_{yy} = A cos(k(x - t)), h_{zz} = -h_{yy},\n    compute linearized Gamma_mu = d^nu h_{mu nu} - (1/2) d_mu h,\n    with H_mu = 0, so C_mu = Gamma_mu. Return max_{x,mu} |C_mu|.\n    In this TT setup, analytically Gamma_mu = 0; discretely we compute\n    using the structure (no derivatives contribute nonzero terms).\n    \"\"\"\n    x = np.linspace(0.0, L, N)\n    # Non-zero h components:\n    hyy = A * np.cos(k * (x - t_TT))\n    hzz = -hyy\n    # Trace h = -h_tt + h_xx + h_yy + h_zz, here only yy and zz non-zero and cancel.\n    h_trace = np.zeros_like(x)\n    # Compute Gamma_mu components using linearized formula:\n    # Gamma_mu = d^nu h_{mu nu} - 0.5 d_mu h\n    # For our TT configuration, all contributions vanish:\n    # - h_{t nu} = 0 for all nu\n    # - h_{x nu} = 0 for all nu\n    # - h_{y y} depends only on t,x - d^y h_{y y} = 0\n    # - h_{z z} depends only on t,x - d^z h_{z z} = 0\n    # - h_trace = 0 - d_mu h = 0 for all mu\n    # Therefore Gamma_mu = 0 vector for all x.\n    Gamma = np.zeros((4, N))\n    # C_mu = H_mu + Gamma_mu with H_mu=0\n    C = Gamma\n    C_abs_max = float(np.max(np.abs(C)))\n    return C_abs_max\n\ndef solve_wave_1d(L, N, CFL, t_final, s_func, monitor_max=False):\n    \"\"\"\n    Solve u_tt = u_xx on x in [0,L], with zero initial data and Sommerfeld BC:\n    left: u_t + u_x = s(t); right: u_t - u_x = 0.\n    Leapfrog scheme. Optionally monitor maximum |u| over time if monitor_max=True.\n    Returns u at final time, and optionally the monitored maximum.\n    \"\"\"\n    dx = L / (N - 1)\n    dt = CFL * dx\n    steps = int(np.floor(t_final / dt))\n    # Adjust final time to an integer number of steps\n    t_final_eff = steps * dt\n    # Grid\n    x = np.linspace(0.0, L, N)\n    # Initialize\n    u_prev = np.zeros(N)\n    u_curr = np.zeros(N)\n    u_new = np.zeros(N)\n    # Since initial velocity is zero, leapfrog start is consistent with u_prev = u_curr = 0.\n    max_abs = 0.0\n    # Time stepping\n    for n in range(steps):\n        t_n = n * dt\n        lam2 = (dt / dx) ** 2\n        # Interior update\n        u_new[1:-1] = (2.0 * u_curr[1:-1] - u_prev[1:-1] +\n                       lam2 * (u_curr[2:] - 2.0 * u_curr[1:-1] + u_curr[:-2]))\n        # Boundary updates via centered-in-time Sommerfeld conditions\n        s_n = s_func(t_n)\n        # Left boundary: (u^{n+1}_0 - u^{n-1}_0)/(2 dt) + (u^n_1 - u^n_0)/dx = s(t^n)\n        u_new[0] = u_prev[0] - 2.0 * dt * ((u_curr[1] - u_curr[0]) / dx - s_n)\n        # Right boundary: (u^{n+1}_{N-1} - u^{n-1}_{N-1})/(2 dt) - (u^n_{N-1} - u^n_{N-2})/dx = 0\n        u_new[-1] = u_prev[-1] + 2.0 * dt * ((u_curr[-1] - u_curr[-2]) / dx)\n        if monitor_max:\n            # Update maximum absolute value observed\n            curr_max = float(np.max(np.abs(u_new)))\n            if curr_max  max_abs:\n                max_abs = curr_max\n        # Shift time levels\n        u_prev, u_curr, u_new = u_curr, u_new, u_prev  # reuse arrays to avoid allocations\n    # After loop, u_curr holds the solution at t_final_eff\n    if monitor_max:\n        return x, dt, u_curr.copy(), max_abs\n    return x, dt, u_curr.copy()\n\ndef run_tests():\n    results = []\n\n    # Test 1: TT verification\n    A = 1e-6\n    k = 2.0 * np.pi\n    t_TT = 1.0\n    L = 1.0\n    N = 801\n    r1 = tt_wave_Cmax(A=A, k=k, t_TT=t_TT, L=L, N=N)\n    results.append(r1)\n\n    # Test 2: No inflow baseline\n    CFL2 = 0.9\n    t_final2 = 0.8\n    def s_zero(t):\n        return 0.0\n    x2, dt2, u2 = solve_wave_1d(L=L, N=N, CFL=CFL2, t_final=t_final2, s_func=s_zero)\n    dx2 = x2[1] - x2[0]\n    L2_norm = float(np.sqrt(np.sum(u2 * u2) * dx2))\n    r2 = (L2_norm  1e-14)\n    results.append(r2)\n\n    # Test 3: Gaussian inflow and analytic verification\n    CFL3 = 0.9\n    t_final3 = 0.6\n    eps = 1e-5\n    t0 = 0.2\n    sigma = 0.05\n    def s_gauss(t):\n        return eps * np.exp(-((t - t0) / sigma) ** 2)\n    x3, dt3, u3 = solve_wave_1d(L=L, N=N, CFL=CFL3, t_final=t_final3, s_func=s_gauss)\n    x_star = 0.3\n    i_star = int(round(x_star / (x3[1] - x3[0])))\n    i_star = max(0, min(N - 1, i_star))\n    u_num = float(u3[i_star])\n    u_analytic = s_gauss(t_final3 - x_star)\n    denom = max(abs(u_analytic), 1e-30)\n    rel_err = float(abs(u_num - u_analytic) / denom)\n    r3 = rel_err\n    results.append(r3)\n\n    # Test 4: High Courant factor stability with sinusoidal inflow\n    CFL4 = 0.99\n    t_final4 = 2.0\n    eps4 = 1e-6\n    omega = 2.0 * np.pi * 10.0  # radians per unit time\n    def s_sin(t):\n        return eps4 * np.sin(omega * t)\n    x4, dt4, u4, max_abs = solve_wave_1d(L=L, N=N, CFL=CFL4, t_final=t_final4, s_func=s_sin, monitor_max=True)\n    r4 = (max_abs = 10.0 * eps4)\n    results.append(r4)\n\n    return results\n\ndef solve():\n    results = run_tests()\n    # Final print statement in the exact required format.\n    # Ensure booleans and floats are represented properly.\n    def to_str(x):\n        if isinstance(x, bool):\n            return \"True\" if x else \"False\"\n        # Use repr for floats to preserve precision compactly\n        return repr(x)\n    print(f\"[{','.join(to_str(r) for r in results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        },
        {
            "introduction": "由于约束违背在数值模拟中往往难以完全避免，GHG 形式包含了一种强大的控制机制：约束阻尼。然而，选择合适的阻尼参数是一项需要权衡的精细工作。这个实践问题  将这一挑战提炼为一个核心任务：设计一个策略来选择阻尼参数 $\\gamma_0$。这个参数需要足够大以有效抑制约束，但又不能过大以至于在数值求解中引发不稳定性。掌握这种权衡是每位数值相对论研究者必备的关键技能。",
            "id": "3491539",
            "problem": "您的任务是为数值相对论和引力波模拟中的广义谐和规范 (GHG) 公式设计一个参数选择和缩放策略，重点是在一个简化的线性化设置中进行约束阻尼。考虑一个一维空间，其中有一个标量约束场 $c(x,t)$，它近似于平直时空附近 GHG 约束的主导阶行为。您的起点是阻尼波动方程\n$$\n\\partial_t^2 c - c_s^2 \\,\\partial_x^2 c + 2 \\,\\gamma_0\\, \\partial_t c = 0,\n$$\n其中 $c_s$ 是特征传播速度（在几何单位制中取 $c_s = 1$），$\\gamma_0 \\ge 0$ 是约束阻尼参数。您将完全在几何单位制中工作，其中光速和牛顿引力常数都设为 $1$，并且您必须用一个特征质量 $M$ 来缩放所有的长度和时间，以便时间和长度都以 $M$ 的倍数表示。\n\n您的任务是，基于上述方程和标准的平面波分析，从第一性原理出发，推导出一个选择 $\\gamma_0$ 的策略，以满足两个相互竞争的要求：\n\n1. 目标振幅衰减要求：在一个长度尺度 $\\ell$ 的单个光穿行时间内，任何平面波分量的振幅应减少一个因子 $r$，其中 $0  r  1$。光穿行时间为 $T = \\ell/c_s$，您必须为一个给定的无量纲比例参数 $\\chi > 0$ 设置 $\\ell = \\chi M$。所有结果都用 $\\gamma_0 M$ 和 $\\chi$ 表示。振幅衰减要求是在时间 $T$ 后的振幅是初始振幅的 $r$ 倍。\n\n2. 显式时间步进的非刚性界限：对于受 Courant-Friedrichs-Lewy (CFL) 条件约束的显式积分器，时间步长为 $\\Delta t = \\mathrm{CFL}\\times \\Delta x$，其中 $\\mathrm{CFL} \\in (0,1)$，$\\Delta x$ 为网格间距。在几何单位制中，定义无量纲比率 $\\Delta x/M$。为避免刚性并为显式积分保持线性阻尼项的数值稳定性，您必须确保 $\\gamma_0 \\Delta t \\le \\gamma_{\\max}$，其中 $\\gamma_{\\max}$ 是一个指定的无量纲界限。用 $\\gamma_0 M$、$\\mathrm{CFL}$ 和 $\\Delta x/M$ 表示此约束。\n\n您必须：\n\n- 从给定的阻尼波动方程和一个平面波拟设 $c(x,t) = \\exp(i k x + s t)$ 出发，推导振幅随时间变化的行为，并展示目标振幅衰减要求如何用指定的 $r$ 和 $\\chi$ 来约束 $\\gamma_0 M$。\n- 使用显式时间步进界限，推导出一个关于 $\\gamma_0 M$ 的约束，用 $\\mathrm{CFL}$、$\\gamma_{\\max}$ 和 $\\Delta x/M$ 表示。\n- 提供一个算法，对于每个测试用例，选择满足这两个约束的最小可行 $\\gamma_0 M$。如果不存在这样的值，您必须将该用例标记为不可行。在不可行的情况下，输出忽略时间步进界限时为达到振幅衰减所需的下界，并指明其不可行。\n\n所有量都必须通过使用几何单位制并以 $M$ 进行缩放来处理为无量纲量。您的程序必须为一套测试用例实现此策略并输出结果。\n\n测试套件：\n使用以下参数集，每个参数集为一个元组 $(\\chi, r, \\Delta x/M, \\mathrm{CFL}, \\gamma_{\\max})$，所有数字均以几何、无量纲形式给出。对于每个测试用例，计算并输出一个双元素列表 $[\\gamma_0 M, \\text{feasible}]$，其中 $\\text{feasible}$ 是一个布尔值，指示所选的 $\\gamma_0 M$ 是否满足两个约束。在不可行的情况下，将第一个条目设置为振幅衰减要求所需的 $\\gamma_0 M$，并将可行性标志设置为 false。\n\n- 用例 A（理想情况）：$(\\chi, r, \\Delta x/M, \\mathrm{CFL}, \\gamma_{\\max}) = (10, 0.3, 0.05, 0.4, 0.5)$。\n- 用例 B（边界相等情况）：选择 $a$ 使得 $r = e^{-a}$，取 $\\chi = 1$，$\\gamma_{\\max} = 0.2$，$\\mathrm{CFL} = 0.5$，并设置 $\\Delta x/M$ 恰好使振幅要求和时间步长界限相等。使用 $a = 0.5$，因此 $(\\chi, r, \\Delta x/M, \\mathrm{CFL}, \\gamma_{\\max}) = (1, e^{-0.5}, 0.8, 0.5, 0.2)$。\n- 用例 C（不可行）：$(\\chi, r, \\Delta x/M, \\mathrm{CFL}, \\gamma_{\\max}) = (1, 0.01, 1.0, 0.5, 1.0)$。\n- 用例 D（弱阻尼目标）：$(\\chi, r, \\Delta x/M, \\mathrm{CFL}, \\gamma_{\\max}) = (1, 0.9, 0.1, 0.5, 0.05)$。\n- 用例 E（粗网格，紧边界，不可行）：$(\\chi, r, \\Delta x/M, \\mathrm{CFL}, \\gamma_{\\max}) = (2, 0.5, 0.9, 0.9, 0.2)$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含所有测试用例的结果，形式为方括号内以逗号分隔的列表，其中每个元素本身是一个双元素列表 $[\\gamma_0 M, \\text{feasible}]$。例如，输出必须看起来像 $[[a_1,b_1],[a_2,b_2],\\dots]$，不含额外文本。所有数值必须是标准的十进制浮点数，不带单位，因为通过 $M$ 进行的几何缩放使 $\\gamma_0 M$ 成为无量纲量。",
            "solution": "问题陈述已经过验证，被认为是科学上合理、定义明确且客观的。它提出了一个计算物理中与数值相对论中约束阻尼相关的标准（尽管简化了）的问题。所有必要的参数都已提供，目标也已明确定义。因此，我们可以着手解决。\n\n任务的核心是推导无量纲阻尼参数 $\\gamma_0 M$ 的两个约束，然后根据这些约束制定一个算法来选择最优值。\n\n### 振幅衰减约束的推导\n\n我们从给定的标量约束场 $c(x,t)$ 的一维阻尼波动方程开始：\n$$\n\\partial_t^2 c - c_s^2 \\,\\partial_x^2 c + 2 \\,\\gamma_0\\, \\partial_t c = 0\n$$\n其中特征速度在几何单位制中给出为 $c_s = 1$。为了分析类波解的行为，我们代入平面波拟设 $c(x,t) = A_0 \\exp(i k x + s t)$，其中 $k$ 是波数，$s$ 是复频率。其导数为：\n$$\n\\partial_t c = s c, \\quad \\partial_t^2 c = s^2 c, \\quad \\partial_x^2 c = (ik)^2 c = -k^2 c\n$$\n将这些代入波动方程，得到关于 $s$ 的特征方程：\n$$\ns^2 c - c_s^2 (-k^2 c) + 2 \\gamma_0 (s c) = 0\n$$\n$$\ns^2 + 2 \\gamma_0 s + k^2 c_s^2 = 0\n$$\n这是一个关于 $s$ 的二次方程，其解为：\n$$\ns = \\frac{-2 \\gamma_0 \\pm \\sqrt{(2 \\gamma_0)^2 - 4 k^2 c_s^2}}{2} = -\\gamma_0 \\pm \\sqrt{\\gamma_0^2 - k^2 c_s^2}\n$$\n波的振幅的时间行为由 $s$ 的实部 $\\text{Re}(s)$ 通过因子 $e^{\\text{Re}(s) t}$ 决定。我们考虑两种情况：\n1.  **欠阻尼情况** ($\\gamma_0^2  k^2 c_s^2$)：此时，平方根内的项为负。$s$ 变为复数，$s = -\\gamma_0 \\pm i \\omega(k)$，其中 $\\omega(k) = \\sqrt{k^2 c_s^2 - \\gamma_0^2}$ 是角频率。解代表一个传播波，其振幅按 $A(t) = A(0) e^{-\\gamma_0 t}$ 衰减。衰减率与波数 $k$ 无关。\n2.  **过阻尼情况** ($\\gamma_0^2 \\ge k^2 c_s^2$)：此时，$s$ 为实数且为负。衰减由两个衰减率中较慢的一个决定，对应于 $s_+ = -\\gamma_0 + \\sqrt{\\gamma_0^2 - k^2 c_s^2}$。衰减率依赖于 $k$，并且比欠阻尼情况慢，当 $k \\to 0$ 时趋近于零。\n\n问题要求*任何*平面波分量的振幅都要衰减。在约束阻尼的背景下，参数 $\\gamma_0$ 通常被选择用来控制传播模式。我们在此采用最直接和普遍的解释，即目标阻尼率适用于控制欠阻尼模式的指数包络 $e^{-\\gamma_0 t}$。这为大范围传播的约束违例提供一个一致的阻尼因子。\n\n第一个要求是振幅在一个光穿行时间 $T$ 内衰减一个因子 $r$。\n$$\nA(T) = r A(0)\n$$\n使用振幅衰减 $A(t) \\propto e^{-\\gamma_0 t}$，我们得到：\n$$\ne^{-\\gamma_0 T} = r\n$$\n两边取自然对数，得到：\n$$\n-\\gamma_0 T = \\ln(r) \\implies \\gamma_0 = -\\frac{\\ln(r)}{T}\n$$\n给定光穿行时间为 $T = \\ell/c_s$。由于 $c_s=1$ 且 $\\ell = \\chi M$，我们有 $T = \\chi M$。将此代入 $\\gamma_0$ 的表达式中：\n$$\n\\gamma_0 = -\\frac{\\ln(r)}{\\chi M}\n$$\n为了获得无量纲量 $\\gamma_0 M$ 并建立一个下界（因为更大的阻尼是可以接受的），我们将其重新排列为：\n$$\n\\gamma_0 M \\ge -\\frac{\\ln(r)}{\\chi}\n$$\n\n### 非刚性约束的推导\n\n第二个要求是针对显式时间积分方案的非刚性界限：\n$$\n\\gamma_0 \\Delta t \\le \\gamma_{\\max}\n$$\n其中 $\\gamma_{\\max}$ 是一个指定的无量纲极限。时间步长 $\\Delta t$ 由 CFL 条件给出：\n$$\n\\Delta t = \\mathrm{CFL} \\cdot \\Delta x\n$$\n将 $\\Delta t$ 代入刚性不等式中：\n$$\n\\gamma_0 (\\mathrm{CFL} \\cdot \\Delta x) \\le \\gamma_{\\max}\n$$\n为了用无量纲量 $\\gamma_0 M$ 和 $\\Delta x/M$ 来表示，我们首先分离出 $\\gamma_0$：\n$$\n\\gamma_0 \\le \\frac{\\gamma_{\\max}}{\\mathrm{CFL} \\cdot \\Delta x}\n$$\n乘以特征质量 $M$，得到关于 $\\gamma_0 M$ 的约束：\n$$\n\\gamma_0 M \\le \\frac{\\gamma_{\\max} M}{\\mathrm{CFL} \\cdot \\Delta x}\n$$\n这可以利用无量纲网格间距 $\\Delta x/M$ 重写为：\n$$\n\\gamma_0 M \\le \\frac{\\gamma_{\\max}}{\\mathrm{CFL} \\cdot (\\Delta x/M)}\n$$\n这个不等式为 $\\gamma_0 M$ 提供了一个上界，以防止阻尼项施加过于严格的时间步长限制（即，避免数值刚性）。\n\n### 算法的综合\n\n我们有两个关于 $\\gamma_0 M$ 的约束：\n1.  下界（振幅衰减）：$\\gamma_0 M \\ge -\\frac{\\ln(r)}{\\chi}$\n2.  上界（非刚性）：$\\gamma_0 M \\le \\frac{\\gamma_{\\max}}{\\mathrm{CFL} \\cdot (\\Delta x / M)}$\n\n问题要求选择*最小的可行* $\\gamma_0 M$。满足振幅衰减要求的最小值恰好是其下界。让我们将这个所需值定义为：\n$$\n(\\gamma_0 M)_{\\text{req}} = -\\frac{\\ln(r)}{\\chi}\n$$\n这个选择是可行的，当且仅当它也满足非刚性上界。因此，一个解是可行的当且仅当：\n$$\n(\\gamma_0 M)_{\\text{req}} \\le \\frac{\\gamma_{\\max}}{\\mathrm{CFL} \\cdot (\\Delta x / M)}\n$$\n对于每个测试用例 $(\\chi, r, \\Delta x/M, \\mathrm{CFL}, \\gamma_{\\max})$ 的算法如下：\n1.  计算所需的无量纲阻尼参数：$(\\gamma_0 M)_{\\text{req}} = -\\ln(r)/\\chi$。\n2.  计算允许的最大无量纲阻尼参数：$(\\gamma_0 M)_{\\text{max}} = \\gamma_{\\max} / (\\mathrm{CFL} \\cdot (\\Delta x/M))$。\n3.  所选的 $\\gamma_0 M$ 值设为 $(\\gamma_0 M)_{\\text{req}}$。\n4.  通过检查 $(\\gamma_0 M)_{\\text{req}} \\le (\\gamma_0 M)_{\\text{max}}$ 来确定此选择是否可行。\n5.  该测试用例的结果是一个双元素列表：[$(\\gamma_0 M)_{\\text{req}}$, feasibility]。\n\n此过程满足了问题陈述的所有要求。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements the parameter selection strategy for the Generalized Harmonic Gauge\n    (GHG) formulation based on the derived constraints.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (chi, r, dx_over_M, CFL, gamma_max)\n    test_cases = [\n        # Case A (happy path)\n        (10, 0.3, 0.05, 0.4, 0.5),\n        # Case B (boundary equality)\n        (1, np.exp(-0.5), 0.8, 0.5, 0.2),\n        # Case C (infeasible)\n        (1, 0.01, 1.0, 0.5, 1.0),\n        # Case D (weak damping target)\n        (1, 0.9, 0.1, 0.5, 0.05),\n        # Case E (coarse grid, tight bound, infeasible)\n        (2, 0.5, 0.9, 0.9, 0.2),\n    ]\n\n    results = []\n    for case in test_cases:\n        chi, r, dx_over_M, CFL, gamma_max = case\n\n        # 1. Calculate the required dimensionless damping parameter from the amplitude\n        #    reduction requirement. This is the smallest acceptable value.\n        #    (gamma_0 * M)_req = -ln(r) / chi\n        gamma0_M_req = -np.log(r) / chi\n\n        # 2. Calculate the maximum allowed dimensionless damping parameter from the\n        #    non-stiffness (explicit time-stepping) constraint.\n        #    (gamma_0 * M)_max = gamma_max / (CFL * (dx / M))\n        #    Handle potential division by zero, although not expected from problem constraints.\n        if CFL == 0 or dx_over_M == 0:\n            gamma0_M_max = -np.inf # If CFL or dx is zero, any gamma_0  0 is stiff\n        else:\n            gamma0_M_max = gamma_max / (CFL * dx_over_M)\n\n        # 3. Determine feasibility. The chosen value (gamma0_M_req) is feasible if it\n        #    does not exceed the maximum allowed value from the stiffness constraint.\n        is_feasible = gamma0_M_req = gamma0_M_max\n\n        # 4. The output for the case is the required gamma_0 * M and the feasibility flag.\n        #    Per problem spec, even if infeasible, we output the gamma_0 * M that\n        #    would be required to meet the amplitude reduction goal.\n        #    The boolean must be a Python native bool for correct string representation.\n        results.append([gamma0_M_req, bool(is_feasible)])\n\n    # Final print statement in the exact required format: [[a1,b1],[a2,b2],...]\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}