{
    "hands_on_practices": [
        {
            "introduction": "The BSSN evolution equations are a system of partial differential equations that must be solved on a discrete computational grid. This requires replacing continuous derivatives with finite-difference approximations. This exercise provides fundamental practice in deriving a high-accuracy, fourth-order finite-difference stencil, a crucial step in developing numerical relativity codes that can minimize discretization error and faithfully capture complex gravitational dynamics. ",
            "id": "3489794",
            "problem": "In the Baumgarte-Shapiro-Shibata-Nakamura (BSSN) formalism of numerical relativity, the contracted conformal connection functions are denoted by $\\tilde{\\Gamma}^{i}$. Consider the divergence $\\partial_{i}\\tilde{\\Gamma}^{i}$ evaluated on a uniform Cartesian grid with spacing $h$ in each coordinate direction, with grid points at $x_{m}=m h$, $y_{n}=n h$, and $z_{p}=p h$ for integers $m,n,p$. \n\nStarting from Taylor expansions about a grid point, derive a fourth-order accurate, centered finite-difference approximation for $\\partial_{i}\\tilde{\\Gamma}^{i}$ at the grid point $(m,n,p)$ in terms of the values of $\\tilde{\\Gamma}^{i}$ at neighboring grid points. You must justify the order of accuracy directly from the Taylor expansions and identify the leading-order truncation error term symbolically.\n\nThen, specialize to the smooth test field\n- $\\tilde{\\Gamma}^{x}(x,y,z)=\\sin(x)\\,\\cos(y)\\,\\exp(z)$,\n- $\\tilde{\\Gamma}^{y}(x,y,z)=\\cos(x)\\,\\sin(y)\\,\\exp(z)$,\n- $\\tilde{\\Gamma}^{z}(x,y,z)=\\exp(x+y)\\,\\cos(z)$,\n\nand compute the leading-order truncation error of your fourth-order centered finite-difference approximation to $\\partial_{i}\\tilde{\\Gamma}^{i}$ at the physical point $(x,y,z)=(0,0,0)$. Express your final answer as a single closed-form analytic expression in terms of $h$ only. No numerical rounding is required, and no units are needed.",
            "solution": "The problem requires the derivation of a fourth-order accurate, centered finite-difference approximation for the divergence of the contracted conformal connection functions, $\\partial_{i}\\tilde{\\Gamma}^{i}$, and the calculation of its leading-order truncation error for a specific test field. The divergence in three-dimensional Cartesian coordinates is $\\partial_{i}\\tilde{\\Gamma}^{i} = \\partial_{x}\\tilde{\\Gamma}^{x} + \\partial_{y}\\tilde{\\Gamma}^{y} + \\partial_{z}\\tilde{\\Gamma}^{z}$. Due to the linearity of the differentiation and the finite-difference operators, we can derive the stencil for a single partial derivative, e.g., $\\partial_x f(x)$, and then apply it to each term in the divergence.\n\nLet's derive the fourth-order accurate, centered finite-difference approximation for the first derivative of a generic smooth function $f(x)$ at a grid point $x$. We use a five-point stencil involving points at $x \\pm h$ and $x \\pm 2h$. The approximation $D_x f$ can be written as a linear combination of the function values at these points:\n$$D_x f = \\frac{c_{-2}f(x-2h) + c_{-1}f(x-h) + c_0 f(x) + c_1 f(x+h) + c_2 f(x+2h)}{h}$$\nWe use Taylor series expansions of $f$ around $x$:\n$$ f(x+kh) = f(x) + (kh)f'(x) + \\frac{(kh)^2}{2!}f''(x) + \\frac{(kh)^3}{3!}f'''(x) + \\frac{(kh)^4}{4!}f^{(4)}(x) + \\frac{(kh)^5}{5!}f^{(5)}(x) + \\mathcal{O}(h^6) $$\nFor a centered difference scheme for the first derivative, the stencil must be antisymmetric, so $c_{-k} = -c_k$, and the central point coefficient must be zero, $c_0=0$. The approximation takes the form:\n$$ D_x f = \\frac{c_1(f(x+h) - f(x-h)) + c_2(f(x+2h) - f(x-2h))}{h} $$\nLet's expand the difference terms:\n$$ f(x+h) - f(x-h) = 2h f'(x) + \\frac{2h^3}{6}f'''(x) + \\frac{2h^5}{120}f^{(5)}(x) + \\mathcal{O}(h^7) $$\n$$ f(x+2h) - f(x-2h) = 4h f'(x) + \\frac{16h^3}{6}f'''(x) + \\frac{64h^5}{120}f^{(5)}(x) + \\mathcal{O}(h^7) $$\nSubstituting these into the expression for $D_x f$:\n$$ D_x f = \\frac{c_1}{h}\\left(2h f' + \\frac{h^3}{3}f''' + \\frac{h^5}{60}f^{(5)}\\right) + \\frac{c_2}{h}\\left(4h f' + \\frac{8h^3}{3}f''' + \\frac{8h^5}{15}f^{(5)}\\right) + \\mathcal{O}(h^6) $$\n$$ D_x f = (2c_1 + 4c_2)f'(x) + \\left(\\frac{c_1}{3} + \\frac{8c_2}{3}\\right)h^2f'''(x) + \\left(\\frac{c_1}{60} + \\frac{8c_2}{15}\\right)h^4f^{(5)}(x) + \\mathcal{O}(h^6) $$\nTo obtain an approximation for $f'(x)$, the coefficient of $f'(x)$ must be $1$. To achieve fourth-order accuracy, the coefficient of the $h^2f'''(x)$ term must be zero. This gives us a system of two linear equations for $c_1$ and $c_2$:\n$1$. $2c_1 + 4c_2 = 1$\n$2$. $\\frac{c_1}{3} + \\frac{8c_2}{3} = 0 \\implies c_1 + 8c_2 = 0 \\implies c_1 = -8c_2$\n\nSubstituting $c_1 = -8c_2$ into the first equation:\n$$ 2(-8c_2) + 4c_2 = 1 \\implies -16c_2 + 4c_2 = 1 \\implies -12c_2 = 1 \\implies c_2 = -\\frac{1}{12} $$\nThen, $c_1 = -8(-\\frac{1}{12}) = \\frac{8}{12} = \\frac{2}{3}$.\n\nThe finite-difference operator for $\\partial_x$ is therefore:\n$$ D_x f = \\frac{2}{3h}(f(x+h) - f(x-h)) - \\frac{1}{12h}(f(x+2h) - f(x-2h)) $$\n$$ D_x f = \\frac{8(f(x+h) - f(x-h)) - (f(x+2h) - f(x-2h))}{12h} $$\n$$ D_x f = \\frac{-f(x+2h) + 8f(x+h) - 8f(x-h) + f(x-2h)}{12h} $$\nThe leading-order truncation error term is given by the $h^4f^{(5)}(x)$ term in the expansion. Using the values found for $c_1$ and $c_2$:\n$$ \\text{Error Term} = \\left(\\frac{c_1}{60} + \\frac{8c_2}{15}\\right)h^4f^{(5)}(x) = \\left(\\frac{2/3}{60} + \\frac{8(-1/12)}{15}\\right)h^4f^{(5)}(x) $$\n$$ = \\left(\\frac{2}{180} - \\frac{8}{180}\\right)h^4f^{(5)}(x) = \\left(\\frac{1}{90} - \\frac{4}{90}\\right)h^4f^{(5)}(x) = -\\frac{3}{90}h^4f^{(5)}(x) = -\\frac{1}{30}h^4f^{(5)}(x) $$\nSo, the truncation error for the operator $D_x$ is $T_x = D_x f - \\partial_x f = -\\frac{1}{30}h^4 \\partial_x^5 f + \\mathcal{O}(h^6)$.\n\nThe fourth-order finite-difference approximation for $\\partial_{i}\\tilde{\\Gamma}^{i}$ at a grid point $(m,n,p)$ is the sum of the stencils for each partial derivative:\n$$ \\mathcal{D}(\\tilde{\\Gamma})|_{(m,n,p)} = \\frac{-\\tilde{\\Gamma}^x_{m+2,n,p} + 8\\tilde{\\Gamma}^x_{m+1,n,p} - 8\\tilde{\\Gamma}^x_{m-1,n,p} + \\tilde{\\Gamma}^x_{m-2,n,p}}{12h} $$\n$$ + \\frac{-\\tilde{\\Gamma}^y_{m,n+2,p} + 8\\tilde{\\Gamma}^y_{m,n+1,p} - 8\\tilde{\\Gamma}^y_{m,n-1,p} + \\tilde{\\Gamma}^y_{m,n-2,p}}{12h} $$\n$$ + \\frac{-\\tilde{\\Gamma}^z_{m,n,p+2} + 8\\tilde{\\Gamma}^z_{m,n,p+1} - 8\\tilde{\\Gamma}^z_{m,n,p-1} + \\tilde{\\Gamma}^z_{m,n,p-2}}{12h} $$\nThe leading-order truncation error $T = \\mathcal{D}(\\tilde{\\Gamma}) - \\partial_i \\tilde{\\Gamma}^i$ is the sum of the individual leading-order errors:\n$$ T_{LO} = -\\frac{h^4}{30}\\partial_x^5 \\tilde{\\Gamma}^x - \\frac{h^4}{30}\\partial_y^5 \\tilde{\\Gamma}^y - \\frac{h^4}{30}\\partial_z^5 \\tilde{\\Gamma}^z = -\\frac{h^4}{30}\\left(\\partial_x^5 \\tilde{\\Gamma}^x + \\partial_y^5 \\tilde{\\Gamma}^y + \\partial_z^5 \\tilde{\\Gamma}^z\\right) $$\n\nNow, we specialize to the given smooth test field and evaluate the error at $(x,y,z)=(0,0,0)$.\nThe components are:\n- $\\tilde{\\Gamma}^{x}(x,y,z)=\\sin(x)\\,\\cos(y)\\,\\exp(z)$\n- $\\tilde{\\Gamma}^{y}(x,y,z)=\\cos(x)\\,\\sin(y)\\,\\exp(z)$\n- $\\tilde{\\Gamma}^{z}(x,y,z)=\\exp(x+y)\\,\\cos(z)$\n\nWe need to compute the fifth partial derivatives and evaluate them at $(0,0,0)$.\n\nFor $\\tilde{\\Gamma}^x$:\n$$ \\partial_x^5 \\tilde{\\Gamma}^x = \\partial_x^5(\\sin(x)\\,\\cos(y)\\,\\exp(z)) = \\cos(y)\\,\\exp(z)\\,\\frac{d^5}{dx^5}(\\sin(x)) $$\nThe derivatives of $\\sin(x)$ are $\\cos(x)$, $-\\sin(x)$, $-\\cos(x)$, $\\sin(x)$, $\\cos(x)$. So, $\\frac{d^5}{dx^5}(\\sin(x)) = \\cos(x)$.\n$$ \\partial_x^5 \\tilde{\\Gamma}^x = \\cos(x)\\,\\cos(y)\\,\\exp(z) $$\nAt $(0,0,0)$: $\\partial_x^5 \\tilde{\\Gamma}^x|_{(0,0,0)} = \\cos(0)\\,\\cos(0)\\,\\exp(0) = 1 \\cdot 1 \\cdot 1 = 1$.\n\nFor $\\tilde{\\Gamma}^y$:\n$$ \\partial_y^5 \\tilde{\\Gamma}^y = \\partial_y^5(\\cos(x)\\,\\sin(y)\\,\\exp(z)) = \\cos(x)\\,\\exp(z)\\,\\frac{d^5}{dy^5}(\\sin(y)) $$\nSimilarly, $\\frac{d^5}{dy^5}(\\sin(y)) = \\cos(y)$.\n$$ \\partial_y^5 \\tilde{\\Gamma}^y = \\cos(x)\\,\\cos(y)\\,\\exp(z) $$\nAt $(0,0,0)$: $\\partial_y^5 \\tilde{\\Gamma}^y|_{(0,0,0)} = \\cos(0)\\,\\cos(0)\\,\\exp(0) = 1 \\cdot 1 \\cdot 1 = 1$.\n\nFor $\\tilde{\\Gamma}^z$:\n$$ \\partial_z^5 \\tilde{\\Gamma}^z = \\partial_z^5(\\exp(x+y)\\,\\cos(z)) = \\exp(x+y)\\,\\frac{d^5}{dz^5}(\\cos(z)) $$\nThe derivatives of $\\cos(z)$ are $-\\sin(z)$, $-\\cos(z)$, $\\sin(z)$, $\\cos(z)$, $-\\sin(z)$. So, $\\frac{d^5}{dz^5}(\\cos(z)) = -\\sin(z)$.\n$$ \\partial_z^5 \\tilde{\\Gamma}^z = -\\exp(x+y)\\,\\sin(z) $$\nAt $(0,0,0)$: $\\partial_z^5 \\tilde{\\Gamma}^z|_{(0,0,0)} = -\\exp(0)\\,\\sin(0) = -1 \\cdot 0 = 0$.\n\nFinally, we substitute these values into the expression for the leading-order truncation error at $(0,0,0)$:\n$$ T_{LO}|_{(0,0,0)} = -\\frac{h^4}{30}\\left(\\partial_x^5 \\tilde{\\Gamma}^x|_{(0,0,0)} + \\partial_y^5 \\tilde{\\Gamma}^y|_{(0,0,0)} + \\partial_z^5 \\tilde{\\Gamma}^z|_{(0,0,0)}\\right) $$\n$$ T_{LO}|_{(0,0,0)} = -\\frac{h^4}{30}(1 + 1 + 0) = -\\frac{2h^4}{30} = -\\frac{h^4}{15} $$\nThe leading-order truncation error is $-\\frac{h^4}{15}$.",
            "answer": "$$\\boxed{-\\frac{h^4}{15}}$$"
        },
        {
            "introduction": "After discretizing space, we must evolve the system forward in time. While explicit time-stepping schemes like the Runge-Kutta method are common, their stability is not guaranteed and depends on the size of the time step, $\\Delta t$. This hands-on practice delves into the Courant-Friedrichs-Lewy (CFL) condition, which establishes a \"speed limit\" for stable evolution by connecting the physical propagation speeds within the PDE system to the grid spacing. By analyzing the characteristic speeds of the linearized BSSN system, you will determine the maximum allowable time step, a critical calculation for any practical simulation. ",
            "id": "3489827",
            "problem": "Consider the Baumgarte-Shapiro-Shibata-Nakamura (BSSN) formulation of the Einstein equations in numerical relativity, linearized about Minkowski spacetime in one spatial dimension with background lapse $\\alpha = 1$, shift $\\beta^{i} = 0$, spatial metric $\\gamma_{ij} = \\delta_{ij}$, and extrinsic curvature $K_{ij} = 0$. Adopt Bona-Massó slicing with the $1+\\log$ choice, namely $f(\\alpha) = 2/\\alpha$, so that the gauge condition on the lapse is $\\partial_{t}\\alpha = -2 \\alpha K$. For the shift, use the hyperbolic Gamma-driver condition in its standard two-equation form,\n$$\n\\partial_{t}\\beta^{i} = B^{i}, \\qquad \\partial_{t}B^{i} = \\partial_{t}\\tilde{\\Gamma}^{i} - \\eta B^{i},\n$$\nwith constant damping parameter $\\eta \\ge 0$, where $\\tilde{\\Gamma}^{i}$ are the contracted conformal connection functions of BSSN. Work to principal part (highest spatial derivative order) and neglect lower-order and damping contributions when determining characteristic speeds.\n\nYou will evolve the linearized system using the method of lines with a second-order centered finite-difference approximation to the spatial derivative $\\partial_{x}$ and the classical fourth-order explicit Runge–Kutta (RK4) time integrator. For a Fourier mode of wavenumber $k$, the spatial finite-difference operator’s symbol for $\\partial_{x}$ is\n$$\n\\lambda_{D}(k) = \\frac{i\\sin(k\\Delta x)}{\\Delta x}.\n$$\n\nStarting from these premises:\n- Derive the maximum characteristic speed $v_{\\max}$ of the linearized BSSN system with the above gauge conditions.\n- Using the RK4 stability function applied to the semi-discrete system with purely imaginary eigenvalues, determine the largest value $C$ such that a Courant–Friedrichs–Lewy (CFL) condition of the form $\\Delta t \\le C\\,\\Delta x$ ensures linear stability for all Fourier modes.\n\nExpress your final answer for $C$ as a single exact dimensionless constant. No rounding is required.",
            "solution": "To find the characteristic speeds, we analyze the principal part of the linearized BSSN equations with the given gauge conditions. This involves examining the decoupled wave equations for different sectors of the theory.\n\nThe lapse $\\alpha$ and the trace of the extrinsic curvature $K$ are governed by the given Bona-Massó slicing condition and the BSSN evolution equation for $K$. The slicing condition is $\\partial_{t}\\alpha = -2\\alpha K$. Linearizing around $\\alpha=1$ and $K=0$, we get $\\partial_{t}(\\delta\\alpha) = -2K$. The principal part of the BSSN evolution equation for $K$ is $\\partial_{t}K = -\\nabla^{2}\\alpha$. Linearizing and specializing to one dimension gives $\\partial_{t}K = -\\partial_{x}^{2}(\\delta\\alpha)$. Combining the two equations by differentiating the first with respect to time gives:\n$$\n\\partial_{t}^{2}(\\delta\\alpha) = -2\\partial_{t}K = -2(-\\partial_{x}^{2}(\\delta\\alpha)) = 2\\partial_{x}^{2}(\\delta\\alpha)\n$$\nThis is a wave equation, $\\partial_{t}^{2}u - v^{2}\\partial_{x}^{2}u = 0$, with a propagation speed of $v_{\\alpha} = \\sqrt{2}$.\n\nThe physical degrees of freedom are contained in the conformal, traceless part of the metric, $\\tilde{\\gamma}_{ij}$, and the extrinsic curvature, $\\tilde{A}_{ij}$. The BSSN equations for these, linearized and at the principal part, are $\\partial_{t}\\tilde{\\gamma}_{ij} = -2\\tilde{A}_{ij}$ and $\\partial_t \\tilde{A}_{ij} \\approx [\\tilde{R}_{ij}]^{TF}$, where $\\tilde{R}_{ij} \\approx -\\frac{1}{2}\\nabla^{2}\\tilde{\\gamma}_{ij}$ is the linearized conformal Ricci tensor. The trace-free condition on $\\tilde{\\gamma}_{ij}$ ensures the TF operator is the identity on $\\nabla^2\\tilde{\\gamma}_{ij}$. Combining the equations:\n$$\n\\partial_{t}^{2}\\tilde{\\gamma}_{ij} = -2\\partial_{t}\\tilde{A}_{ij} \\approx -2\\left(-\\frac{1}{2}\\partial_{x}^{2}\\tilde{\\gamma}_{ij}\\right) = \\partial_{x}^{2}\\tilde{\\gamma}_{ij}\n$$\nThis is a wave equation with propagation speed $v_{\\gamma} = 1$. This corresponds to the speed of gravitational waves (the speed of light, $c=1$).\n\nThe shift vector $\\beta^{i}$ and the auxiliary variable $B^{i}$ are governed by the hyperbolic Gamma-driver conditions. Neglecting damping ($\\eta=0$), we have $\\partial_{t}\\beta^{i} = B^{i}$ and $\\partial_{t}B^{i} = \\partial_{t}\\tilde{\\Gamma}^{i}$. This gives a wave equation for $\\beta^{i}$: $\\partial_{t}^{2}\\beta^{i} = \\partial_{t}\\tilde{\\Gamma}^{i}$. The principal part of $\\partial_{t}\\tilde{\\Gamma}^{i}$ is determined by the highest-order spatial derivatives, which come from the evolution of the shift itself. The expression is $\\partial_t \\tilde{\\Gamma}^i \\approx \\nabla^2\\beta^i + \\frac{1}{3}\\nabla^i(\\nabla_j\\beta^j)$. In one dimension, this becomes:\n$$\n\\partial_t \\tilde{\\Gamma}^x \\approx \\partial_x^2\\beta^x + \\frac{1}{3}\\partial_x^2\\beta^x = \\frac{4}{3}\\partial_x^2\\beta^x\n$$\nSubstituting this into the wave equation for $\\beta^x$ gives $\\partial_t^2\\beta^x = \\frac{4}{3}\\partial_x^2\\beta^x$. This gives a propagation speed for the shift gauge modes of $v_{\\beta} = \\sqrt{4/3} = 2/\\sqrt{3}$.\n\nThe maximum characteristic speed is the maximum of all derived speeds:\n$$\nv_{\\max} = \\max\\left(1, \\sqrt{2}, \\frac{2}{\\sqrt{3}}\\right) = \\max(1, 1.414..., 1.154...) = \\sqrt{2}\n$$\nNow we determine the CFL constant. For a hyperbolic system, the semi-discretized operator has purely imaginary eigenvalues $\\lambda(k) = v \\lambda_D(k) = v \\frac{i\\sin(k\\Delta x)}{\\Delta x}$. For the RK4 time integrator, the stability condition is that $z = \\lambda(k)\\Delta t$ must lie within the stability region. For purely imaginary $z=i\\omega$, the RK4 stability boundary is $|\\omega| \\le \\sqrt{8} = 2\\sqrt{2}$.\n\nThe CFL condition must hold for the worst case, which corresponds to the maximum speed $v_{\\max}$ and the wavenumber $k$ that maximizes the magnitude of the operator symbol.\nWe need $|z| = |\\lambda(k)\\Delta t| \\le 2\\sqrt{2}$ for all $k$ and all characteristic speeds $v$.\n$$\n\\left|v \\frac{i\\sin(k\\Delta x)}{\\Delta x} \\Delta t\\right| \\le 2\\sqrt{2}\n$$\nTo ensure stability for all modes, we must use the maximum values for $|v|$ and $|\\sin(k\\Delta x)|$:\n$\\max|v| = v_{\\max} = \\sqrt{2}$ and $\\max_k |\\sin(k\\Delta x)| = 1$. The condition becomes:\n$$\n\\frac{v_{\\max}}{\\Delta x}\\Delta t \\le 2\\sqrt{2}\n$$\nRearranging for $\\Delta t$ gives the CFL condition: $\\Delta t \\le \\frac{2\\sqrt{2}}{v_{\\max}}\\Delta x$. The constant $C$ is:\n$$\nC = \\frac{2\\sqrt{2}}{v_{\\max}} = \\frac{2\\sqrt{2}}{\\sqrt{2}} = 2\n$$",
            "answer": "$$\\boxed{2}$$"
        },
        {
            "introduction": "A cornerstone of reliable scientific computing is verification: ensuring that a numerical code behaves as theoretically expected. In the BSSN formalism, the Hamiltonian and momentum constraints, $\\mathcal{H}$ and $\\mathcal{M}_i$, provide a powerful built-in check, as they must vanish for an exact solution of Einstein's equations. This exercise demonstrates how to use these constraint violations to perform a convergence test, a standard procedure where one confirms that numerical errors decrease at the expected rate as the grid resolution is increased, thereby building confidence in the simulation results. ",
            "id": "3489760",
            "problem": "In the Baumgarte-Shapiro-Shibata-Nakamura (BSSN) formalism for numerical relativity, the Hamiltonian constraint $\\mathcal{H}$ and the momentum constraint $\\mathcal{M}_i$ vanish for an exact solution, but their numerically computed residuals are nonzero due to truncation error. Consider a three-dimensional ($3$-D) uniform Cartesian grid of spacing $h$ covering a fixed coordinate domain $\\Omega$ of volume $|\\Omega|$, evolved by a method-of-lines scheme that uses fourth-order accurate ($4$th-order) centered finite differences for all spatial derivatives and a fourth-order accurate ($4$th-order) explicit time integrator, with Courant-Friedrichs-Lewy (CFL) time step $\\Delta t = \\lambda h$ for a fixed $\\lambda > 0$. Assume the scheme is stable for the smooth solution under consideration, and that the constraints at each grid point are assembled using the same order of spatial discrete derivatives as used in the evolution equations. Assume further that the discrete spatial metric $\\gamma_{ij}$ and its inverse $\\gamma^{ij}$ are available at each grid point and are smooth functions of the grid spacing in the sense induced by the numerical solution.\n\nYour task is to identify the correct definition of discrete $L_2$ norms for the Hamiltonian and momentum constraints on this grid that are consistent with the continuum $L_2$ norm, and to predict the leading-order convergence rate of these norms under uniform refinement $h \\to h/2$.\n\nSelect the option that provides both a correct pair of discrete $L_2$ norm definitions and a correct convergence-rate prediction consistent with the assumptions above.\n\nA. Define\n$||\\mathcal{H}||_{2,h} = \\left( \\sum_{\\mathbf{x}\\in\\Omega_h} \\mathcal{H}(\\mathbf{x})^2 \\,\\Delta V \\right)^{1/2}$ and $||\\mathcal{M}||_{2,h} = \\left( \\sum_{\\mathbf{x}\\in\\Omega_h} \\gamma^{ij}(\\mathbf{x}) \\,\\mathcal{M}_i(\\mathbf{x}) \\,\\mathcal{M}_j(\\mathbf{x}) \\,\\Delta V \\right)^{1/2}$ with $\\Delta V = h^3$, and predict $||\\mathcal{H}||_{2,h} = \\mathcal{O}(h^4)$ and $||\\mathcal{M}||_{2,h} = \\mathcal{O}(h^4)$ as $h \\to 0$.\n\nB. Define root-mean-square norms $||\\mathcal{H}||_{2,h} = \\left( \\frac{1}{N}\\sum_{\\mathbf{x}\\in\\Omega_h} \\mathcal{H}(\\mathbf{x})^2 \\right)^{1/2}$ and $||\\mathcal{M}||_{2,h} = \\left( \\frac{1}{N}\\sum_{\\mathbf{x}\\in\\Omega_h} \\delta^{ij} \\,\\mathcal{M}_i(\\mathbf{x}) \\,\\mathcal{M}_j(\\mathbf{x}) \\right)^{1/2}$ with $N$ the number of grid points and $\\delta^{ij}$ the Kronecker symbol, and predict $||\\mathcal{H}||_{2,h} = \\mathcal{O}(h^2)$ and $||\\mathcal{M}||_{2,h} = \\mathcal{O}(h^2)$.\n\nC. Define unweighted discrete Euclidean norms $||\\mathcal{H}||_{2,h} = \\left( \\sum_{\\mathbf{x}\\in\\Omega_h} \\mathcal{H}(\\mathbf{x})^2 \\right)^{1/2}$ and $||\\mathcal{M}||_{2,h} = \\left( \\sum_{\\mathbf{x}\\in\\Omega_h} \\mathcal{M}_i(\\mathbf{x}) \\,\\mathcal{M}_i(\\mathbf{x}) \\right)^{1/2}$, and predict $||\\mathcal{H}||_{2,h}, ||\\mathcal{M}||_{2,h} = \\mathcal{O}(h^{5/2})$ under uniform refinement.\n\nD. Define the same volume-weighted norms as in option A, but predict $||\\mathcal{H}||_{2,h} = \\mathcal{O}(h^5)$ and $||\\mathcal{M}||_{2,h} = \\mathcal{O}(h^5)$ because spatial order $4$ and temporal order $4$ combine under the CFL scaling $\\Delta t \\propto h$.",
            "solution": "First, we determine the correct definition for the discrete $L_2$ norms. These norms must be consistent with their continuum counterparts. The continuum $L_2$ norm of a scalar field $f$ and a covector field $V_i$ on a spatial manifold with metric $\\gamma_{ij}$ over a domain $\\Omega$ are defined as:\n$$||f||_{2, \\text{cont}} = \\left( \\int_\\Omega f^2 \\, dV \\right)^{1/2}$$\n$$||V||_{2, \\text{cont}} = \\left( \\int_\\Omega \\gamma^{ij} V_i V_j \\, dV \\right)^{1/2}$$\nHere, $dV$ is the volume element. A discrete norm consistent with this definition is found by approximating the integral with a Riemann sum over the grid points $\\mathbf{x} \\in \\Omega_h$. For a uniform Cartesian grid with spacing $h$, the discrete volume element is $\\Delta V = h^3$.\n\nFor the Hamiltonian constraint $\\mathcal{H}$ (a scalar), the discrete $L_2$ norm is:\n$$||\\mathcal{H}||_{2,h} = \\left( \\sum_{\\mathbf{x} \\in \\Omega_h} \\mathcal{H}(\\mathbf{x})^2 \\, \\Delta V \\right)^{1/2}$$\n\nFor the momentum constraint $\\mathcal{M}_i$ (a covector), we must use the inverse spatial metric $\\gamma^{ij}$ to compute its invariant magnitude squared, $\\gamma^{ij} \\mathcal{M}_i \\mathcal{M}_j$. The discrete $L_2$ norm is then:\n$$||\\mathcal{M}||_{2,h} = \\left( \\sum_{\\mathbf{x} \\in \\Omega_h} \\gamma^{ij}(\\mathbf{x}) \\mathcal{M}_i(\\mathbf{x}) \\mathcal{M}_j(\\mathbf{x}) \\, \\Delta V \\right)^{1/2}$$\nThese definitions correctly approximate the continuum integrals and handle the tensorial nature of the fields.\n\nSecond, we predict the convergence rate. The numerical scheme uses a 4th-order accurate spatial discretization and a 4th-order accurate time integrator. With a CFL condition $\\Delta t = \\lambda h$, the global error of the evolved fields at a fixed time $T$ for a stable scheme is the sum of the spatial and temporal errors:\n$$ \\text{Global Error} = \\mathcal{O}(h^4) + \\mathcal{O}(\\Delta t^4) = \\mathcal{O}(h^4) + \\mathcal{O}((\\lambda h)^4) = \\mathcal{O}(h^4) $$\nThis is the pointwise error in the numerically computed fields, e.g., $\\gamma_{ij,h}(\\mathbf{x}) = \\gamma_{ij,\\text{exact}}(\\mathbf{x}) + \\mathcal{O}(h^4)$. The constraint residuals, $\\mathcal{H}$ and $\\mathcal{M}_i$, are computed using these inexact fields and 4th-order accurate discrete derivative operators. Since both the input fields and the operators have 4th-order errors, the resulting pointwise constraint violation is also 4th-order:\n$$ \\mathcal{H}_h(\\mathbf{x}) = \\mathcal{O}(h^4) \\quad \\text{and} \\quad \\mathcal{M}_{i,h}(\\mathbf{x}) = \\mathcal{O}(h^4) $$\nFinally, we compute the convergence of the discrete $L_2$ norm. For the Hamiltonian:\n$$ ||\\mathcal{H}||_{2,h}^2 = \\sum_{\\mathbf{x} \\in \\Omega_h} \\mathcal{H}_h(\\mathbf{x})^2 \\, h^3 $$\nThe number of grid points $N$ in a fixed domain scales as $N = |\\Omega|/h^3 = \\mathcal{O}(h^{-3})$.\n$$ ||\\mathcal{H}||_{2,h}^2 = N \\cdot (\\text{average value of } \\mathcal{H}_h^2) \\cdot h^3 \\approx \\mathcal{O}(h^{-3}) \\cdot (\\mathcal{O}(h^4))^2 \\cdot h^3 = \\mathcal{O}(h^{-3}) \\cdot \\mathcal{O}(h^8) \\cdot h^3 = \\mathcal{O}(h^8) $$\nTaking the square root gives the convergence rate of the norm:\n$$ ||\\mathcal{H}||_{2,h} = \\sqrt{\\mathcal{O}(h^8)} = \\mathcal{O}(h^4) $$\nThe same reasoning applies to $||\\mathcal{M}||_{2,h}$.\n\nComparing this result with the given options:\n- **Option A**: Provides the correct norm definitions and predicts an $\\mathcal{O}(h^4)$ convergence rate. This matches our derivation.\n- **Option B**: Uses incorrect norms (root-mean-square, and $\\delta^{ij}$ for the momentum norm) and an incorrect convergence rate.\n- **Option C**: Uses unweighted norms that do not approximate the continuum integral.\n- **Option D**: Uses correct norms but predicts an incorrect convergence rate.\n\nThus, Option A is the only one that is fully correct.",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}