{
    "hands_on_practices": [
        {
            "introduction": "The well-posedness of the Cauchy problem hinges first on the ability to construct valid initial data. This practice delves into the heart of this \"problem of constraints\" by employing the conformal method, a cornerstone of modern numerical relativity. You will see how the formidable Hamiltonian constraint can be transformed into the more tractable Lichnerowicz equation, and by solving it for a simplified physical scenario, you will build an analytical solution for the initial geometry of multiple black holes .",
            "id": "3490067",
            "problem": "Consider the vacuum Einstein constraint equations on a three-dimensional manifold with Riemannian metric, to be evolved according to the Cauchy problem of general relativity. Let the initial data manifold be $\\mathbb{R}^{3}$, and adopt the conformal method in which the physical metric is written as $\\bar{g}_{ij} = \\phi^{4} \\gamma_{ij}$ and the physical extrinsic curvature as $\\bar{K}_{ij} = \\phi^{-2} A_{ij} + \\tfrac{1}{3}\\phi^{4}\\gamma_{ij} K$, where $\\gamma_{ij}$ is a chosen background metric, $\\phi$ is a positive conformal factor, $K$ is the mean curvature, and $A_{ij}$ is a symmetric transverse-traceless tensor with respect to $\\gamma_{ij}$. Assume vacuum, so the constraint equations are the Hamiltonian constraint $R(\\bar{g}) + K^{2} - \\bar{K}_{ij}\\bar{K}^{ij} = 0$ and the momentum constraint $\\bar{\\nabla}^{j}\\bar{K}_{ij} - \\bar{\\nabla}_{i} K = 0$, where $R(\\bar{g})$ is the scalar curvature of $\\bar{g}_{ij}$ and $\\bar{\\nabla}$ is the Levi-Civita connection of $\\bar{g}_{ij}$. In the conformal method, the Hamiltonian constraint reduces to the Lichnerowicz equation\n$$\n\\Delta_{\\gamma} \\phi - \\tfrac{1}{8} R(\\gamma)\\,\\phi + \\tfrac{1}{8}\\phi^{-7} A_{ij}A^{ij} - \\tfrac{1}{12}K^{2}\\phi^{5} = 0,\n$$\nwhere $\\Delta_{\\gamma}$ and $R(\\gamma)$ are the Laplace-Beltrami operator and scalar curvature of $\\gamma_{ij}$, respectively.\n\nWork with time-symmetric data, meaning $K_{ij} = 0$, which implies $K = 0$ and $A_{ij} = 0$. Choose a conformally flat background metric $\\gamma_{ij} = \\delta_{ij}$ on $\\mathbb{R}^{3}$ so that $R(\\gamma) = 0$. Then $\\phi$ satisfies the reduced equation\n$$\n\\Delta \\phi = 0\n$$\non the punctured domain $\\mathbb{R}^{3} \\setminus \\{\\mathbf{c}_{1},\\dots,\\mathbf{c}_{N}\\}$, where $\\{\\mathbf{c}_{a}\\}_{a=1}^{N} \\subset \\mathbb{R}^{3}$ are distinct points representing separate asymptotically flat ends. Impose the asymptotic flatness condition $\\phi(\\mathbf{x}) \\to 1$ as $|\\mathbf{x}| \\to \\infty$, and require that near each puncture $\\mathbf{c}_{a}$ the conformal factor has the local behavior\n$$\n\\phi(\\mathbf{x}) = \\frac{m_{a}}{2\\,|\\mathbf{x} - \\mathbf{c}_{a}|} + \\text{regular at } \\mathbf{c}_{a},\n$$\nwith fixed parameters $m_{a}  0$ for $a = 1,\\dots,N$. Using only the vacuum constraints and standard elliptic theory as foundational principles, determine the unique harmonic function $\\phi(\\mathbf{x})$ on $\\mathbb{R}^{3} \\setminus \\{\\mathbf{c}_{a}\\}$ satisfying these boundary conditions. Give your final answer as a single closed-form analytical expression for $\\phi(\\mathbf{x})$. No numerical approximation is required, and no units are to be reported in the final answer.",
            "solution": "The problem asks for the unique solution for the conformal factor $\\phi$ under a specific set of simplifying assumptions within the context of the Cauchy problem for Einstein's vacuum field equations. The provided framework is the conformal method for constructing initial data.\n\nThe central equation governing the conformal factor $\\phi$ is the Hamiltonian constraint, which in the conformal decomposition takes the form of the Lichnerowicz equation:\n$$\n\\Delta_{\\gamma} \\phi - \\tfrac{1}{8} R(\\gamma)\\,\\phi + \\tfrac{1}{8}\\phi^{-7} A_{ij}A^{ij} - \\tfrac{1}{12}K^{2}\\phi^{5} = 0.\n$$\nThe problem specifies several conditions:\n1.  The initial data is time-symmetric, which means the extrinsic curvature of the initial slice vanishes, $\\bar{K}_{ij} = 0$. This implies that its trace, the mean curvature $K=\\bar{g}^{ij}\\bar{K}_{ij}$, is zero, and its trace-free part, $A_{ij}$, is also zero. So, $K=0$ and $A_{ij}=0$.\n2.  The background metric $\\gamma_{ij}$ on the manifold $\\mathbb{R}^3$ is chosen to be the flat Euclidean metric, $\\gamma_{ij} = \\delta_{ij}$. The scalar curvature of the flat metric is zero, $R(\\gamma) = 0$. The corresponding Laplace-Beltrami operator $\\Delta_{\\gamma}$ becomes the standard Laplacian on $\\mathbb{R}^3$, denoted by $\\Delta$.\n\nSubstituting these conditions, $R(\\gamma)=0$, $A_{ij}=0$, and $K=0$, into the Lichnerowicz equation gives:\n$$\n\\Delta \\phi - \\tfrac{1}{8} (0)\\,\\phi + \\tfrac{1}{8}\\phi^{-7} (0) - \\tfrac{1}{12}(0)^{2}\\phi^{5} = 0,\n$$\nwhich simplifies to the three-dimensional Laplace equation:\n$$\n\\Delta \\phi(\\mathbf{x}) = 0.\n$$\nThis equation for $\\phi(\\mathbf{x})$ must be solved on the domain $\\mathcal{D} = \\mathbb{R}^{3} \\setminus \\{\\mathbf{c}_{1},\\dots,\\mathbf{c}_{N}\\}$, where $\\{\\mathbf{c}_{a}\\}_{a=1}^{N}$ are $N$ distinct points, subject to a set of boundary conditions.\n\nThe boundary conditions are:\n1.  Asymptotic flatness: $\\phi(\\mathbf{x}) \\to 1$ as $|\\mathbf{x}| \\to \\infty$. This condition is imposed at the \"boundary at infinity\" of the domain.\n2.  Puncture behavior: Near each point $\\mathbf{c}_{a}$, the function $\\phi(\\mathbf{x})$ must exhibit a specific singular behavior:\n    $$\n    \\phi(\\mathbf{x}) = \\frac{m_{a}}{2\\,|\\mathbf{x} - \\mathbf{c}_{a}|} + \\text{regular at } \\mathbf{c}_{a}.\n    $$\n    The term \"regular at $\\mathbf{c}_{a}$\" implies that the remainder of $\\phi(\\mathbf{x})$ after subtracting the singular part is a harmonic function in a neighborhood that includes the point $\\mathbf{c}_{a}$.\n\nThis setup constitutes a standard boundary value problem in potential theory. Since the Laplace equation is a linear partial differential equation, we can use the principle of superposition to construct the solution. We seek a function that is harmonic on $\\mathcal{D}$ and satisfies the specified behaviors at the boundaries of $\\mathcal{D}$ (i.e., at infinity and at the punctures $\\mathbf{c}_{a}$).\n\nLet's build the solution from elementary harmonic functions.\nA constant function is harmonic. The function $f(\\mathbf{x}) = 1/|\\mathbf{x}-\\mathbf{y}|$ is the fundamental solution of the Laplacian in three dimensions and is harmonic for all $\\mathbf{x} \\neq \\mathbf{y}$.\n\nConsider the following general form for the solution, which is a linear combination of these elementary harmonic functions:\n$$\n\\phi(\\mathbf{x}) = C + \\sum_{a=1}^{N} \\frac{C_a}{|\\mathbf{x} - \\mathbf{c}_a|},\n$$\nwhere $C$ and the set of coefficients $\\{C_a\\}_{a=1}^{N}$ are constants to be determined. By construction, this function is harmonic everywhere except at the points $\\mathbf{c}_a$, thus satisfying $\\Delta\\phi=0$ on the domain $\\mathcal{D}$.\n\nWe now apply the boundary conditions to determine the constants.\nFirst, let's examine the asymptotic behavior as $|\\mathbf{x}| \\to \\infty$. In this limit, each term of the sum vanishes:\n$$\n\\lim_{|\\mathbf{x}| \\to \\infty} \\frac{C_a}{|\\mathbf{x} - \\mathbf{c}_a|} = 0.\n$$\nSo, the limit of our proposed solution is:\n$$\n\\lim_{|\\mathbf{x}| \\to \\infty} \\phi(\\mathbf{x}) = C.\n$$\nTo satisfy the asymptotic flatness condition $\\phi(\\mathbf{x}) \\to 1$, we must set $C=1$. The candidate solution becomes:\n$$\n\\phi(\\mathbf{x}) = 1 + \\sum_{a=1}^{N} \\frac{C_a}{|\\mathbf{x} - \\mathbf{c}_a|}.\n$$\nNext, let's impose the condition at each puncture. Fix an index $b \\in \\{1, \\dots, N\\}$ and examine the function's behavior near $\\mathbf{c}_b$. We can separate the $b$-th term from the sum:\n$$\n\\phi(\\mathbf{x}) = \\frac{C_b}{|\\mathbf{x} - \\mathbf{c}_b|} + \\left( 1 + \\sum_{a=1, a \\neq b}^{N} \\frac{C_a}{|\\mathbf{x} - \\mathbf{c}_a|} \\right).\n$$\nThe expression within the parentheses, let's call it $h_b(\\mathbf{x})$, is a sum of a constant and functions of the form $1/|\\mathbf{x} - \\mathbf{c}_a|$ where $a \\neq b$. As $\\mathbf{x}$ approaches $\\mathbf{c}_b$, none of the denominators $|\\mathbf{x} - \\mathbf{c}_a|$ for $a \\neq b$ approach zero. Therefore, $h_b(\\mathbf{x})$ is well-defined, continuously differentiable, and harmonic in a neighborhood of $\\mathbf{c}_b$. In other words, $h_b(\\mathbf{x})$ is the \"regular part\" of the solution at $\\mathbf{c}_b$.\n\nThe problem requires the singular part of $\\phi(\\mathbf{x})$ at $\\mathbf{c}_b$ to be precisely $\\frac{m_{b}}{2\\,|\\mathbf{x} - \\mathbf{c}_{b}|}$. By comparing this with the singular part of our candidate solution, $\\frac{C_b}{|\\mathbf{x} - \\mathbf{c}_b|}$, we can uniquely determine the coefficient $C_b$:\n$$\nC_b = \\frac{m_b}{2}.\n$$\nThis logic applies to every puncture $a = 1, \\dots, N$. Thus, we have determined all the coefficients: $C_a = \\frac{m_a}{2}$.\n\nSubstituting these coefficients into our general form yields the unique solution:\n$$\n\\phi(\\mathbf{x}) = 1 + \\sum_{a=1}^{N} \\frac{m_a}{2|\\mathbf{x} - \\mathbf{c}_a|}.\n$$\nThis function satisfies Laplace's equation on the punctured domain and all specified boundary conditions. The uniqueness of this solution is guaranteed by standard theorems of potential theory for exterior boundary value problems. This particular solution is known in the relativity literature as the Bowen-York solution for time-symmetric, conformally flat initial data corresponding to $N$ black holes.",
            "answer": "$$\n\\boxed{1 + \\sum_{a=1}^{N} \\frac{m_a}{2|\\mathbf{x} - \\mathbf{c}_a|}}\n$$"
        },
        {
            "introduction": "With valid initial data in hand, the focus shifts to stable time evolution, where the choice of spacetime coordinates, or \"gauge,\" is paramount. This numerical exercise explores how the gauge can alter the fundamental character of the evolution equations, potentially destroying the hyperbolicity required for a well-posed Cauchy problem. By simulating a simple toy model, you will directly observe the onset of instability when the system transitions from hyperbolic to elliptic, providing a tangible lesson on the importance of maintaining causality in numerical simulations .",
            "id": "3490105",
            "problem": "Consider a toy Partial Differential Equation (PDE) intended to mimic how gauge choices in General Relativity (GR) can affect the hyperbolicity of evolution equations and the well-posedness of the Cauchy problem. Let $u = u(t,x)$ be a scalar field on a one-dimensional spatial domain with periodic boundary conditions, and consider the PDE\n$$\n\\partial_t^2 u(t,x) \\;=\\; g(t)\\,\\partial_x^2 u(t,x),\n$$\non the periodic interval $x \\in [0,2\\pi]$ with angles measured in radians. Assume smooth initial data $u(0,x)$ and $\\partial_t u(0,x)$.\n\nYou are to treat this as a Cauchy problem and analyze the principal symbol and its dependence on a gauge-like function $g(t)$, showing how the classification of the PDE changes as $g(t)$ varies. The context is numerical relativity and gravitational waves, where global hyperbolicity guarantees well-posedness of the Cauchy problem for physically meaningful gauges; this toy model abstracts how poorly chosen gauges can destroy hyperbolicity.\n\nDefinitions and foundational bases:\n- The Cauchy problem asks whether given $u(0,x)$ and $\\partial_t u(0,x)$ one obtains a unique solution $u(t,x)$ that depends continuously on the initial data for $t \\ge 0$.\n- The principal symbol of a second-order PDE in two variables $t,x$ with co-vector $(\\tau,\\xi)$ has the form $p(\\tau,\\xi;t) = A(t)\\,\\tau^2 + B(t)\\,\\tau\\,\\xi + C(t)\\,\\xi^2$, where classification into hyperbolic, parabolic, or elliptic is determined by the discriminant $D(t) = B(t)^2 - 4 A(t) C(t)$.\n- For the given PDE, $A(t) = 1$, $B(t) = 0$, and $C(t) = -g(t)$, so the principal symbol is $p(\\tau,\\xi;t) = \\tau^2 - g(t)\\,\\xi^2$. Hyperbolicity corresponds to real characteristic speeds and hence $D(t)  0$, ellipticity to $D(t)  0$, and parabolic degeneracy to $D(t) = 0$.\n- In numerical relativity, global hyperbolicity ensures that the evolution equations are hyperbolic in a globally consistent way, making the Cauchy problem well-posed globally on the spacetime. Loss of hyperbolicity corresponds to the breakdown of global hyperbolicity in the toy model.\n\nTasks:\n1. Starting from the definition of principal symbol and the discriminant, show in your solution how the sign of $g(t)$ determines whether the PDE is hyperbolic, elliptic, or degenerate. Then, explain why the initial-value problem is well-posed when $g(t)  0$ (hyperbolic) and ill-posed when $g(t)  0$ (elliptic), and discuss the parabolic/degenerate boundary case $g(t) = 0$.\n2. Numerically integrate the PDE using a second-order accurate explicit time-stepping scheme for a Fourier-spectral spatial discretization with $N_x$ equispaced points on $[0,2\\pi]$ (angles in radians). Use initial data $u(0,x) = \\sin(x)$ and $\\partial_t u(0,x) = 0$.\n3. Define a dimensionless gauge function $g(t)$ for each test case and simulate over a fixed time window $t \\in [0,T_{\\text{end}}]$ with a uniform time step $\\Delta t$. For numerical stability and clarity, use $N_x = 256$, $T_{\\text{end}} = 2$, and $\\Delta t = 10^{-3}$.\n4. Track the squared $L^2$ energy\n$$\nE(t) \\;=\\; \\frac{1}{2\\pi}\\int_{0}^{2\\pi} u(t,x)^2\\,dx,\n$$\nand define the energy growth factor $R(t) = E(t)/E(0)$. Let the ill-posedness onset time $t_{\\text{onset}}$ be the earliest time at which $R(t)$ first exceeds a threshold $R_{\\text{thr}} = 10$. If no such exceedance occurs by $T_{\\text{end}}$, set $t_{\\text{onset}} = -1$.\n5. Implement the following test suite of gauge functions $g(t)$:\n   - Case $1$ (globally hyperbolic): $g(t) = 1$ for all $t \\in [0,T_{\\text{end}}]$.\n   - Case $2$ (hyperbolic-to-elliptic transition): $g(t) = 1 - t$ for $t \\in [0,T_{\\text{end}}]$, which crosses from positive to negative at $t = 1$.\n   - Case $3$ (globally elliptic): $g(t) = -1$ for all $t \\in [0,T_{\\text{end}}]$.\n   - Case $4$ (degenerate boundary): $g(t) = 0$ for all $t \\in [0,T_{\\text{end}}]$.\n6. For each case, compute $t_{\\text{onset}}$ in dimensionless time units and aggregate the results into a single line of output containing the $4$ onset times as a comma-separated list enclosed in square brackets.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[t_1,t_2,t_3,t_4]$), where each $t_i$ is a floating-point number representing the ill-posedness onset time in dimensionless units, with $t_i = -1$ indicating that no onset occurred within the simulation window.\n\nThe implementation must be self-contained and runnable as-is, without any user input or external files. All angles are in radians, and all quantities are dimensionless. Ensure scientific realism by using the specified numerical parameters and by handling the transition case to demonstrate the onset of ill-posedness when the principal symbol changes sign. The output must strictly follow the prescribed single-line format.",
            "solution": "The problem presents a toy model for analyzing the well-posedness of the Cauchy problem in the context of partial differential equations (PDEs) that arise in numerical relativity. We are given a second-order linear PDE, $\\partial_t^2 u(t,x) = g(t)\\,\\partial_x^2 u(t,x)$, where the function $g(t)$ acts as a \"gauge choice\" that can alter the fundamental character of the equation. We will first provide a theoretical analysis of the PDE's classification and its implications for the initial-value problem. Subsequently, we will describe the numerical scheme used to simulate the evolution and detect the onset of ill-posedness.\n\n### Theoretical Analysis: PDE Classification and Well-Posedness\n\nThe given PDE is\n$$ \\partial_t^2 u(t,x) = g(t)\\,\\partial_x^2 u(t,x) $$\nwhich can be rewritten as\n$$ \\partial_t^2 u(t,x) - g(t)\\,\\partial_x^2 u(t,x) = 0. $$\nTo classify this PDE, we analyze its principal symbol. For a general second-order PDE in two variables $(t,x)$, given by $\\sum_{i,j} A_{ij} \\partial_i \\partial_j u + \\dots = 0$, the principal symbol is obtained by replacing each partial derivative $\\partial_i$ with a corresponding co-vector component $\\sigma_i$. Here, we use $(\\tau, \\xi)$ as the co-vector dual to $(t,x)$. We replace $\\partial_t \\rightarrow \\tau$ and $\\partial_x \\rightarrow \\xi$ in the highest-order terms of the PDE. This yields the characteristic polynomial:\n$$ p(\\tau, \\xi; t) = \\tau^2 - g(t)\\xi^2. $$\nThis is a quadratic form in $(\\tau, \\xi)$. Its classification into hyperbolic, elliptic, or parabolic types depends on its discriminant. For a general form $A\\tau^2 + B\\tau\\xi + C\\xi^2$, the discriminant is $D = B^2 - 4AC$. In our case, $A = 1$, $B = 0$, and $C = -g(t)$. The discriminant is therefore:\n$$ D(t) = (0)^2 - 4(1)(-g(t)) = 4g(t). $$\nThe classification of the PDE at a given time $t$ depends directly on the sign of $g(t)$:\n\n1.  **Hyperbolic Case ($g(t)  0$):** If $g(t)  0$, the discriminant $D(t)  0$. The characteristic equation $p(\\tau, \\xi; t) = 0$ has two distinct real roots for $\\tau/\\xi$, given by $\\tau/\\xi = \\pm\\sqrt{g(t)}$. These roots represent the characteristic speeds, $c(t) = \\pm\\sqrt{g(t)}$, at which information propagates. Because these speeds are real and finite, the domain of dependence for any point $(t_0, x_0)$ is a finite interval on the initial slice $t=0$. This guarantees that the Cauchy problem is well-posed: a unique solution exists and depends continuously on the initial data. This is the case for wave-like phenomena.\n\n2.  **Elliptic Case ($g(t)  0$):** If $g(t)  0$, the discriminant $D(t)  0$. The characteristic speeds become purely imaginary, $c(t) = \\pm\\sqrt{-|g(t)|} = \\pm i\\sqrt{|g(t)|}$. This signifies a lack of a real-valued \"speed of propagation\". An elliptic PDE does not support a well-posed initial-value problem. To see why, consider a Fourier mode solution of the form $u(t,x) \\propto e^{ikx}$ for some wavenumber $k$. Substituting this into the PDE gives an ordinary differential equation (ODE) for the time-dependent amplitude $\\hat{u}_k(t)$:\n    $$ \\frac{d^2\\hat{u}_k}{dt^2} = g(t)(-k^2)\\hat{u}_k = -g(t)k^2\\hat{u}_k. $$\n    When $g(t)  0$, the coefficient on the right-hand side, $-g(t)k^2$, is positive. The ODE is $\\ddot{\\hat{u}}_k = \\omega_k(t)^2 \\hat{u}_k$ with a real frequency $\\omega_k(t) = k\\sqrt{|g(t)|}$. The general solution includes terms proportional to $e^{\\int \\omega_k(t) dt}$. This exponential growth factor is larger for higher wavenumbers $k$. Consequently, any high-frequency components in the initial data (including numerical round-off error) will be amplified at an arbitrarily fast rate, leading to a catastrophic breakdown of the solution. The problem is ill-posed.\n\n3.  **Parabolic/Degenerate Case ($g(t) = 0$):** If $g(t) = 0$, the discriminant $D(t) = 0$. The PDE simplifies to $\\partial_t^2 u = 0$. The characteristic speed is zero. The solution is simply $u(t,x) = u(0,x) + t\\,\\partial_t u(0,x)$. The evolution at each spatial point $x$ is independent of its neighbors. While degenerate, the Cauchy problem for this equation is still well-posed.\n\n### Numerical Implementation\n\nTo investigate these behaviors numerically, we discretize the PDE and solve it for the given initial data and test cases.\n\n**Spatial Discretization:** The problem specifies a periodic domain $x \\in [0, 2\\pi]$, which is ideally suited for a Fourier spectral method. We represent the solution $u(t,x)$ on a grid of $N_x$ equispaced points $x_j = 2\\pi j/N_x$ for $j=0, \\dots, N_x-1$. The second spatial derivative $\\partial_x^2 u$ is computed efficiently and with high accuracy in Fourier space. Let $\\hat{u}_k(t)$ be the Discrete Fourier Transform (DFT) of the grid values $u(t, x_j)$. The transform of the second derivative is then $(-k^2)\\hat{u}_k(t)$, where $k$ are the integer wavenumbers. The operation is performed as follows:\n1. Compute the DFT of $u$: $\\hat{u} = \\text{FFT}(u)$.\n2. Multiply by $-k^2$: $\\widehat{\\partial_x^2 u} = -k^2 \\hat{u}$.\n3. Compute the inverse DFT: $\\partial_x^2 u = \\text{IFFT}(\\widehat{\\partial_x^2 u})$.\n\n**Temporal Discretization:** We use a second-order accurate explicit time-stepping scheme. The leapfrog method is a standard choice for second-order-in-time equations. Given $u^n \\approx u(n\\Delta t)$, the update rule is:\n$$ u^{n+1} = 2u^n - u^{n-1} + (\\Delta t)^2 \\, g(n\\Delta t) \\, (\\partial_x^2 u)^n, $$\nwhere $(\\partial_x^2 u)^n$ is the spatial derivative evaluated at time $n\\Delta t$. This is a two-step method, requiring solutions at two previous time levels, $u^n$ and $u^{n-1}$. a\nTo initialize the scheme, we need $u^0$ and $u^1$. $u^0 = u(0,x)$ is given. We compute $u^1$ using a second-order Taylor expansion around $t=0$:\n$$ u^1 \\approx u(0,x) + \\Delta t \\, \\partial_t u(0,x) + \\frac{(\\Delta t)^2}{2} \\partial_t^2 u(0,x). $$\nUsing the initial data $\\partial_t u(0,x) = 0$ and the PDE itself to find $\\partial_t^2 u(0,x) = g(0)\\,\\partial_x^2 u(0,x)$, the first step becomes:\n$$ u^1 = u^0 + \\frac{(\\Delta t)^2}{2} g(0) (\\partial_x^2 u)^0. $$\nWith $u^0$ and $u^1$ available, we set $u_{\\text{prev}} = u^0$ and $u_{\\text{curr}} = u^1$ to begin the main leapfrog loop.\n\n**Analysis of Ill-Posedness:** We monitor the squared $L^2$ energy of the solution, which for a periodic domain is defined as $E(t) = \\frac{1}{2\\pi}\\int_0^{2\\pi} u(t,x)^2 dx$. Numerically, this is approximated as the mean of the squared grid values: $E(t) \\approx \\frac{1}{N_x} \\sum_{j=0}^{N_x-1} u(t,x_j)^2$. The energy growth factor $R(t) = E(t)/E(0)$ tracks the solution's stability. Ill-posedness manifests as a rapid, unbounded growth in energy. We define the onset time $t_{\\text{onset}}$ as the first time $t$ for which $R(t)$ exceeds a threshold $R_{\\text{thr}} = 10$. If the threshold is not met by the final time $T_{\\text{end}} = 2$, we set $t_{\\text{onset}} = -1$.\n\n### Expected Behavior of Test Cases\n\n1.  **Case 1 ($g(t) = 1$):** This is the standard wave equation. The analytical solution is $u(t,x) = \\sin(x)\\cos(t)$. The energy is $E(t) = E(0)\\cos^2(t)$, which is bounded. We expect $R(t) \\le 1$, so $t_{\\text{onset}} = -1$.\n2.  **Case 2 ($g(t) = 1 - t$):** The equation is hyperbolic for $t  1$ and elliptic for $t  1$. The solution should remain stable until $t=1$, after which numerical noise at high frequencies will begin to grow exponentially. We expect $t_{\\text{onset}}$ to be slightly greater than $1$.\n3.  **Case 3 ($g(t) = -1$):** The equation is elliptic for all $t \\ge 0$. High-frequency modes will grow exponentially from the start. The onset time will be determined by the growth of the fastest-growing mode, $k_{\\text{max}} = N_x/2 = 128$, and should be very short.\n4.  **Case 4 ($g(t) = 0$):** The equation is $\\partial_t^2 u = 0$. With zero initial velocity, the solution is static: $u(t,x) = u(0,x) = \\sin(x)$. The energy is constant, so $t_{\\text{onset}} = -1$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_onset_time(g_func, T_end, dt, Nx, R_thr):\n    \"\"\"\n    Solves the PDE u_tt = g(t) u_xx and finds the onset time of ill-posedness.\n\n    Args:\n        g_func (callable): The gauge function g(t).\n        T_end (float): The end time of the simulation.\n        dt (float): The time step.\n        Nx (int): The number of spatial grid points.\n        R_thr (float): The energy growth ratio threshold.\n\n    Returns:\n        float: The onset time, or -1.0 if no onset occurs.\n    \"\"\"\n    # 1. Setup spatial grid and wavenumbers\n    x = np.linspace(0, 2 * np.pi, Nx, endpoint=False)\n    # Wavenumbers for numpy's FFT\n    k = np.fft.fftfreq(Nx, d=1.0 / Nx)\n\n    # 2. Set initial conditions\n    u_0 = np.sin(x)\n    v_0 = np.zeros(Nx)  # du/dt(0, x) = 0\n\n    # 3. Calculate initial energy\n    E0 = np.mean(u_0**2)\n    # If initial energy is zero, growth factor is ill-defined.\n    if E0  1e-16: # A small tolerance for floating point\n        return -1.0\n\n    # 4. Initialize the time-stepping scheme (Leapfrog)\n    # The leapfrog scheme u_next = 2*u_curr - u_prev + dt^2 * accel\n    # requires a startup step. We use a Taylor expansion to find u(dt).\n    # u(dt) ~= u(0) + dt*v(0) + 0.5*dt^2*a(0)\n    # where a(0) = g(0)*d^2u/dx^2(0).\n\n    # Calculate acceleration at t=0\n    g_val_0 = g_func(0.0)\n    u_hat_0 = np.fft.fft(u_0)\n    d2u_dx2_hat_0 = -(k**2) * u_hat_0\n    d2u_dx2_0 = np.fft.ifft(d2u_dx2_hat_0).real\n    accel_0 = g_val_0 * d2u_dx2_0\n\n    # Compute u at the first time step, t=dt\n    u_1 = u_0 + dt * v_0 + 0.5 * dt**2 * accel_0\n\n    # Setup for the main loop\n    u_prev = u_0  # Solution at time t-dt\n    u_curr = u_1  # Solution at time t\n    t = dt\n\n    num_steps = int(round(T_end / dt))\n\n    # 5. Main evolution loop\n    # We already computed the state at step 1 (t=dt), so we loop from step 2.\n    for i in range(1, num_steps):\n        # Calculate acceleration at the current time t\n        g_val = g_func(t)\n        u_hat = np.fft.fft(u_curr)\n        d2u_dx2_hat = -(k**2) * u_hat\n        d2u_dx2 = np.fft.ifft(d2u_dx2_hat).real\n        accel = g_val * d2u_dx2\n\n        # Perform the leapfrog step to find u at t+dt\n        u_next = 2 * u_curr - u_prev + dt**2 * accel\n\n        # Update state variables for the next iteration\n        u_prev = u_curr\n        u_curr = u_next\n        t += dt\n\n        # 6. Check for ill-posedness onset\n        # Calculate energy and growth factor\n        E = np.mean(u_curr**2)\n        R = E / E0\n\n        if R  R_thr:\n            return t\n\n    # If the loop completes without exceeding the threshold\n    return -1.0\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (globally hyperbolic)\n        {'name': 'Case 1', 'g_func': lambda t: 1.0},\n        # Case 2 (hyperbolic-to-elliptic transition)\n        {'name': 'Case 2', 'g_func': lambda t: 1.0 - t},\n        # Case 3 (globally elliptic)\n        {'name': 'Case 3', 'g_func': lambda t: -1.0},\n        # Case 4 (degenerate boundary)\n        {'name': 'Case 4', 'g_func': lambda t: 0.0}\n    ]\n\n    # Simulation parameters\n    Nx = 256\n    T_end = 2.0\n    dt = 1e-3\n    R_thr = 10.0\n\n    results = []\n    for case in test_cases:\n        t_onset = compute_onset_time(\n            g_func=case['g_func'],\n            T_end=T_end,\n            dt=dt,\n            Nx=Nx,\n            R_thr=R_thr\n        )\n        # Round the result to a reasonable number of decimal places\n        # to match the time step precision for a clean output.\n        if t_onset != -1.0:\n            results.append(round(t_onset, 4))\n        else:\n            results.append(t_onset)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Building on the concept of hyperbolicity, this practice advances from a scalar model to a system of coupled equations, which is more representative of formulations of Einstein's equations. Here, you will engage with the more rigorous condition of *strong hyperbolicity* by analyzing the principal matrix of a gauge subsystem. This analysis will allow you to compute the characteristic speeds and diagnose instabilities tied to a specific gauge parameter, providing the tools necessary to assess the well-posedness of complex evolution systems .",
            "id": "3490121",
            "problem": "Consider the linear constant-coefficient first-order reduction of a gauge subsystem that arises from a linearization of the Arnowitt-Deser-Misner (ADM) formulation with a Bona–Massó-type slicing condition about Minkowski spacetime in one spatial dimension. Let the evolved fields be the lapse perturbation $\\alpha$, the trace of the extrinsic curvature perturbation $K$, and the auxiliary variable $D = \\partial_x \\alpha$. The linear system is\n$$\n\\partial_t \\alpha \\;=\\; -\\,\\mu_L\\, K,\\qquad\n\\partial_t K \\;+\\; \\partial_x D \\;=\\; 0,\\qquad\n\\partial_t D \\;+\\; \\mu_L\\,\\partial_x K \\;=\\; 0,\n$$\nwhere $\\mu_L \\in \\mathbb{R}$ is a constant gauge parameter. Write this in the standard first-order form\n$$\n\\partial_t \\mathbf{u} \\;+\\; A\\,\\partial_x \\mathbf{u} \\;=\\; S\\,\\mathbf{u},\n$$\nwith $\\mathbf{u} = (\\alpha, K, D)^{\\mathsf{T}}$, principal part matrix\n$$\nA \\;=\\; \\begin{pmatrix}\n0  0  0\\\n$$4pt]\n0  0  1\\\n$$4pt]\n0  \\mu_L  0\n\\end{pmatrix},\n$$\nand lower-order source matrix\n$$\nS \\;=\\; \\begin{pmatrix}\n0  -\\mu_L  0\\\n$$4pt]\n0  0  0\\\n$$4pt]\n0  0  0\n\\end{pmatrix}.\n$$\nA Partial Differential Equation (PDE) system in this constant-coefficient setting is called strongly hyperbolic if, for each unit spatial direction, the principal symbol has a complete set of eigenvectors and all characteristic speeds are real. For the one-dimensional case above, this reduces to the matrix $A$ having a complete set of eigenvectors and real eigenvalues. For a Fourier mode with wavenumber $k \\in \\mathbb{R}$, the temporal evolution operator is\n$$\nM(k) \\;=\\; -\\,\\mathrm{i}\\,k\\,A \\;+\\; S,\n$$\nso that $\\partial_t \\widehat{\\mathbf{u}} \\,=\\, M(k)\\,\\widehat{\\mathbf{u}}$ in Fourier space, and the instantaneous growth rate for that mode is given by the maximal real part of the eigenvalues of $M(k)$.\n\nTask. You must implement a program that, for each specified test case, does all of the following purely algorithmic steps:\n- Step $1$: Construct $A$ and $S$ from the given $\\mu_L$.\n- Step $2$: Determine whether the system is strongly hyperbolic by checking that all eigenvalues of $A$ are real and that $A$ has a complete set of eigenvectors (i.e., the eigenvector matrix has full rank).\n- Step $3$: For two given wavenumbers $k_1$ and $k_2$, compute the maximal growth rates $g(k_1)$ and $g(k_2)$, where $g(k) = \\max\\{\\operatorname{Re}(\\lambda) : \\lambda \\text{ eigenvalue of } M(k)\\}$.\n- Step $4$: Estimate the high-frequency growth slope\n$$\ns \\;=\\; \\frac{g(k_2)-g(k_1)}{k_2 - k_1}.\n$$\n- Step $5$: Compute two characteristic diagnostics of the principal symbol $A$:\n  - The instability indicator\n  $$\n  b \\;=\\; \\max_{\\lambda \\in \\sigma(A)} \\left|\\operatorname{Im}(\\lambda)\\right|,\n  $$\n  which quantifies the magnitude of non-real characteristic speeds.\n  - The maximal real characteristic speed magnitude\n  $$\n  v \\;=\\; \\max_{\\lambda \\in \\sigma(A)} \\left|\\operatorname{Re}(\\lambda)\\right|,\n  $$\n  interpreted as $0$ if any eigenvalue is non-real.\n\nYou must round all floating-point outputs $s$, $b$, and $v$ to exactly $6$ decimal places. For each test case, your program must output a list of the form $[\\text{strong}, s, b, v]$, where $\\text{strong}$ is a boolean indicating strong hyperbolicity. The final output must be a single line containing a list of these per-test-case lists, with no spaces. Angles do not appear, and there are no physical units in this problem.\n\nTest Suite. Run your program on the following parameter sets $(\\mu_L, k_1, k_2)$:\n- Case $1$: $(4, 8, 16)$.\n- Case $2$: $(0, 8, 16)$.\n- Case $3$: $(-1, 8, 16)$.\n- Case $4$: $(0.01, 8, 16)$.\n\nFinal Output Format. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with each test case contributing a sub-list in the order given above, and with no spaces anywhere. For example, the line must look like\n$$\n[\\,[\\text{strong}_1, s_1, b_1, v_1],\\,[\\text{strong}_2, s_2, b_2, v_2],\\,[\\text{strong}_3, s_3, b_3, v_3],\\,[\\text{strong}_4, s_4, b_4, v_4]\\,],\n$$\nprinted exactly as a single line, with floats rounded to $6$ decimals.",
            "solution": "The problem requires an analysis of a linear, constant-coefficient system of partial differential equations (PDEs) for several test cases. The analysis involves determining the system's hyperbolicity and calculating various diagnostic quantities. The solution proceeds by first analytically deriving expressions for all required quantities in terms of the gauge parameter $\\mu_L$, and then implementing these formulas.\n\nThe governing PDE system is given in first-order form as $\\partial_t \\mathbf{u} + A\\,\\partial_x \\mathbf{u} = S\\,\\mathbf{u}$, with the state vector $\\mathbf{u} = (\\alpha, K, D)^{\\mathsf{T}}$, the principal part matrix $A$, and the source matrix $S$:\n$$\nA = \\begin{pmatrix}\n0  0  0 \\\\\n0  0  1 \\\\\n0  \\mu_L  0\n\\end{pmatrix}, \\quad\nS = \\begin{pmatrix}\n0  -\\mu_L  0 \\\\\n0  0  0 \\\\\n0  0  0\n\\end{pmatrix}\n$$\n\nFirst, we analyze the properties of the principal part matrix $A$. The characteristic speeds of the system are the eigenvalues of $A$. The characteristic equation is $\\det(A - \\lambda I) = 0$:\n$$\n\\det\\begin{pmatrix} -\\lambda  0  0 \\\\ 0  -\\lambda  1 \\\\ 0  \\mu_L  -\\lambda \\end{pmatrix} = -\\lambda(\\lambda^2 - \\mu_L) = 0\n$$\nThe eigenvalues, which represent the characteristic speeds, are $\\lambda_1 = 0$, $\\lambda_2 = \\sqrt{\\mu_L}$, and $\\lambda_3 = -\\sqrt{\\mu_L}$.\n\nThe system is strongly hyperbolic if all eigenvalues of $A$ are real and $A$ possesses a complete set of eigenvectors.\n1.  **Reality of Eigenvalues**: The eigenvalues are real if and only if $\\mu_L \\ge 0$. If $\\mu_L  0$, $\\sqrt{\\mu_L}$ and $-\\sqrt{\\mu_L}$ are purely imaginary and non-zero.\n2.  **Completeness of Eigenvectors**:\n    - If $\\mu_L  0$, the eigenvalues $0, \\sqrt{\\mu_L}, -\\sqrt{\\mu_L}$ are real and distinct. A matrix with distinct eigenvalues is always diagonalizable, which implies it has a complete set of linearly independent eigenvectors.\n    - If $\\mu_L = 0$, the matrix becomes $A = \\left(\\begin{smallmatrix} 0  0  0 \\\\ 0  0  1 \\\\ 0  0  0 \\end{smallmatrix}\\right)$. The eigenvalue $\\lambda=0$ has an algebraic multiplicity of $3$. The eigenvectors $\\mathbf{v}$ are found by solving $A\\mathbf{v} = 0$, which yields $v_3=0$. The eigenspace is spanned by $(1, 0, 0)^{\\mathsf{T}}$ and $(0, 1, 0)^{\\mathsf{T}}$, so its dimension (the geometric multiplicity) is $2$. Since the geometric multiplicity ($2$) is less than the algebraic multiplicity ($3$), the matrix is not diagonalizable and does not have a complete set of eigenvectors.\n    - If $\\mu_L  0$, the eigenvalues are not all real.\n\nCombining these conditions, the system is strongly hyperbolic if and only if $\\mu_L  0$. This provides a simple criterion for the boolean output `strong`.\n\nNext, we derive the analytical expressions for the diagnostics $b$ and $v$.\n- The instability indicator is $b = \\max_{\\lambda \\in \\sigma(A)} |\\operatorname{Im}(\\lambda)|$.\n  - If $\\mu_L \\ge 0$, all eigenvalues are real, so their imaginary parts are $0$. Thus, $b = 0$.\n  - If $\\mu_L  0$, the eigenvalues are $0, i\\sqrt{-\\mu_L}, -i\\sqrt{-\\mu_L}$. The imaginary parts are $0, \\sqrt{-\\mu_L}, -\\sqrt{-\\mu_L}$. The maximum absolute value is $b = \\sqrt{-\\mu_L}$.\n- The maximal real characteristic speed magnitude is $v = \\max_{\\lambda \\in \\sigma(A)} |\\operatorname{Re}(\\lambda)|$, with the condition that $v=0$ if any eigenvalue is non-real.\n  - If $\\mu_L  0$, the eigenvalues are not all real, so by definition, $v=0$.\n  - If $\\mu_L = 0$, the eigenvalues are $0, 0, 0$. All are real, and their real parts are $0$. Thus, $v = 0$.\n  - If $\\mu_L  0$, the eigenvalues are $0, \\sqrt{\\mu_L}, -\\sqrt{\\mu_L}$. All are real. The maximum absolute value is $v = \\sqrt{\\mu_L}$.\n\nNow, we analyze the Fourier-space evolution operator $M(k) = -ikA + S$ to determine the growth rates.\n$$\nM(k) = -ik\\begin{pmatrix}\n0  0  0 \\\\\n0  0  1 \\\\\n0  \\mu_L  0\n\\end{pmatrix} + \\begin{pmatrix}\n0  -\\mu_L  0 \\\\\n0  0  0 \\\\\n0  0  0\n\\end{pmatrix} = \\begin{pmatrix}\n0  -\\mu_L  0 \\\\\n0  0  -ik \\\\\n0  -ik\\mu_L  0\n\\end{pmatrix}\n$$\nThe eigenvalues $\\lambda_M$ of $M(k)$ determine the temporal behavior of Fourier modes. The characteristic equation is $\\det(M(k) - \\lambda_M I) = 0$:\n$$\n\\det\\begin{pmatrix} -\\lambda_M  -\\mu_L  0 \\\\ 0  -\\lambda_M  -ik \\\\ 0  -ik\\mu_L  -\\lambda_M \\end{pmatrix} = -\\lambda_M(\\lambda_M^2 - (-ik)(-ik\\mu_L)) = -\\lambda_M(\\lambda_M^2 + \\mu_L k^2) = 0\n$$\nThe eigenvalues of $M(k)$ are $\\lambda_{M,1} = 0$ and $\\lambda_{M,2,3} = \\pm\\sqrt{-\\mu_L k^2} = \\pm ik\\sqrt{\\mu_L}$.\n\nThe instantaneous growth rate is $g(k) = \\max\\{\\operatorname{Re}(\\lambda_M)\\}$.\n- If $\\mu_L \\ge 0$, the eigenvalues are $0, \\pm ik\\sqrt{\\mu_L}$, which are all purely imaginary (or zero). The real parts are all $0$. Thus, $g(k) = 0$.\n- If $\\mu_L  0$, let $\\mu_L = -c^2$ for $c = \\sqrt{-\\mu_L}  0$. The eigenvalues become $0, \\pm ik(ic) = \\mp kc$. These are $0, kc, -kc$, which are all real. The maximum real part is $g(k) = kc = k\\sqrt{-\\mu_L}$, assuming wavenumber $k \\ge 0$.\n\nFinally, we compute the high-frequency growth slope $s = (g(k_2)-g(k_1))/(k_2 - k_1)$.\n- If $\\mu_L \\ge 0$, $g(k) = 0$ for all $k$, so $g(k_1)=g(k_2)=0$. This yields $s = 0$.\n- If $\\mu_L  0$, $g(k) = k\\sqrt{-\\mu_L}$. The slope is $s = (k_2\\sqrt{-\\mu_L} - k_1\\sqrt{-\\mu_L})/(k_2 - k_1) = \\sqrt{-\\mu_L}(k_2 - k_1)/(k_2 - k_1) = \\sqrt{-\\mu_L}$.\n\nThe algorithm to be implemented will use these derived analytical formulas, which is more robust and efficient than numerical computation of matrix eigenvalues and ranks for each case.\n\nSummary of analytical formulas:\n- Strong hyperbolicity (`strong`): `true` if $\\mu_L  0$, `false` otherwise.\n- Instability indicator ($b$): $b = \\sqrt{-\\mu_L}$ if $\\mu_L  0$, else $b=0$.\n- Max characteristic speed ($v$): $v = \\sqrt{\\mu_L}$ if $\\mu_L  0$, else $v=0$.\n- Growth slope ($s$): $s = \\sqrt{-\\mu_L}$ if $\\mu_L  0$, else $s=0$.\n\nThese formulas are applied to each test case to generate the final results.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem for the given test suite by analyzing the PDE system properties\n    based on the parameter mu_L.\n    \"\"\"\n    # Test Suite: (mu_L, k1, k2)\n    test_cases = [\n        (4.0, 8.0, 16.0),\n        (0.0, 8.0, 16.0),\n        (-1.0, 8.0, 16.0),\n        (0.01, 8.0, 16.0),\n    ]\n\n    results_data = []\n\n    for case in test_cases:\n        mu_L, k1, k2 = case\n\n        # Step 2: Determine strong hyperbolicity.\n        # The system is strongly hyperbolic if and only if mu_L  0.\n        # This is because for mu_L  0, the eigenvalues of A are real and distinct.\n        # For mu_L = 0, A is defective (incomplete set of eigenvectors).\n        # For mu_L  0, A has non-real eigenvalues.\n        is_strong_hyperbolic = mu_L  0\n\n        # Step 5: Compute characteristic diagnostics of A.\n        # The eigenvalues of A are 0, +/-sqrt(mu_L).\n\n        # b = max(|Im(lambda)|)\n        if mu_L  0:\n            b = np.sqrt(-mu_L)\n        else:\n            b = 0.0\n\n        # v = max(|Re(lambda)|), or 0 if any lambda is non-real.\n        if mu_L  0:\n            v = np.sqrt(mu_L)\n        else:\n            # This covers mu_L  0 (non-real eigenvalues) and mu_L = 0 (all eigenvalues are 0).\n            v = 0.0\n\n        # Steps 3  4: Compute growth rates and estimate slope s.\n        # The eigenvalues of M(k) are 0, +/- i*k*sqrt(mu_L).\n        # The growth rate g(k) is the max real part of these eigenvalues.\n        # The slope s is (g(k2)-g(k1))/(k2-k1).\n\n        if mu_L  0:\n            # g(k) = k * sqrt(-mu_L). Eigenvalues of M(k) are real: 0, +/- k*sqrt(-mu_L).\n            s = np.sqrt(-mu_L)\n        else:\n            # g(k) = 0. Eigenvalues of M(k) are purely imaginary or zero.\n            s = 0.0\n        \n        results_data.append([is_strong_hyperbolic, s, b, v])\n\n    # Format the final output string according to the problem specification.\n    # No spaces, boolean as lowercase, floats to 6 decimal places.\n    output_parts = []\n    for res in results_data:\n        strong, s_val, b_val, v_val = res\n        strong_str = str(strong).lower()\n        s_str = f\"{s_val:.6f}\"\n        b_str = f\"{b_val:.6f}\"\n        v_str = f\"{v_val:.6f}\"\n        output_parts.append(f\"[{strong_str},{s_str},{b_str},{v_str}]\")\n    \n    final_output = f\"[{','.join(output_parts)}]\"\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}