{
    "hands_on_practices": [
        {
            "introduction": "在求解爱因斯坦方程的柯西问题时，第一步是构建满足约束方程的初始数据。共形方法是一种强大技术，它将哈密顿约束转化为一个椭圆型的偏微分方程，即Lichnerowicz方程。这个练习将带你解决该方程在一个简化但基础的场景下的解析解，从而为理解如何为数值相对论模拟生成物理上一致的初始“快照”打下坚实基础。",
            "id": "3490067",
            "problem": "考虑一个具有黎曼度规的三维流形上的真空爱因斯坦约束方程，该流形将根据广义相对论的柯西问题进行演化。设初始数据流形为 $\\mathbb{R}^{3}$，并采用共形方法，其中物理度规写作 $\\bar{g}_{ij} = \\phi^{4} \\gamma_{ij}$，物理外在曲率写作 $\\bar{K}_{ij} = \\phi^{-2} A_{ij} + \\tfrac{1}{3}\\phi^{4}\\gamma_{ij} K$。这里 $\\gamma_{ij}$ 是选定的背景度规，$\\phi$ 是一个正的共形因子，$K$ 是平均曲率，$A_{ij}$ 是一个关于 $\\gamma_{ij}$ 的对称横向无迹张量。假设真空情况，则约束方程为哈密顿约束 $R(\\bar{g}) + K^{2} - \\bar{K}_{ij}\\bar{K}^{ij} = 0$ 和动量约束 $\\bar{\\nabla}^{j}\\bar{K}_{ij} - \\bar{\\nabla}_{i} K = 0$，其中 $R(\\bar{g})$ 是 $\\bar{g}_{ij}$ 的标量曲率，$\\bar{\\nabla}$ 是 $\\bar{g}_{ij}$ 的列维-奇维塔联络。在共形方法中，哈密顿约束简化为 Lichnerowicz 方程\n$$\n\\Delta_{\\gamma} \\phi - \\tfrac{1}{8} R(\\gamma)\\,\\phi + \\tfrac{1}{8}\\phi^{-7} A_{ij}A^{ij} - \\tfrac{1}{12}K^{2}\\phi^{5} = 0,\n$$\n其中 $\\Delta_{\\gamma}$ 和 $R(\\gamma)$ 分别是 $\\gamma_{ij}$ 的拉普拉斯-贝尔特拉米算子和标量曲率。\n\n使用时间对称数据，即 $K_{ij} = 0$，这意味着 $K = 0$ 且 $A_{ij} = 0$。选择 $\\mathbb{R}^{3}$ 上的共形平坦背景度规 $\\gamma_{ij} = \\delta_{ij}$，因此 $R(\\gamma) = 0$。那么 $\\phi$ 在刺穿域 $\\mathbb{R}^{3} \\setminus \\{\\mathbf{c}_{1},\\dots,\\mathbf{c}_{N}\\}$ 上满足简化后的方程\n$$\n\\Delta \\phi = 0\n$$\n，其中 $\\{\\mathbf{c}_{a}\\}_{a=1}^{N} \\subset \\mathbb{R}^{3}$ 是代表独立渐近平坦端的不同点。施加渐近平坦条件，即当 $|\\mathbf{x}| \\to \\infty$ 时 $\\phi(\\mathbf{x}) \\to 1$，并要求在每个刺穿点 $\\mathbf{c}_{a}$ 附近，共形因子具有局部行为\n$$\n\\phi(\\mathbf{x}) = \\frac{m_{a}}{2\\,|\\mathbf{x} - \\mathbf{c}_{a}|} + \\text{在 } \\mathbf{c}_{a} \\text{ 处正则},\n$$\n其中 $a = 1,\\dots,N$ 的参数 $m_{a} > 0$ 是固定的。仅使用真空约束和标准椭圆理论作为基本原理，确定在 $\\mathbb{R}^{3} \\setminus \\{\\mathbf{c}_{a}\\}$ 上满足这些边界条件的唯一调和函数 $\\phi(\\mathbf{x})$。请给出 $\\phi(\\mathbf{x})$ 的单个闭式解析表达式作为最终答案。不需要数值近似，最终答案中也不应报告任何单位。",
            "solution": "该问题要求在爱因斯坦真空场方程柯西问题的背景下，根据一组特定的简化假设，求解共形因子 $\\phi$ 的唯一解。所提供的框架是用于构造初始数据的共形方法。\n\n控制共形因子 $\\phi$ 的核心方程是哈密顿约束，在共形分解中，它表现为 Lichnerowicz 方程：\n$$\n\\Delta_{\\gamma} \\phi - \\tfrac{1}{8} R(\\gamma)\\,\\phi + \\tfrac{1}{8}\\phi^{-7} A_{ij}A^{ij} - \\tfrac{1}{12}K^{2}\\phi^{5} = 0.\n$$\n问题指定了几个条件：\n1.  初始数据是时间对称的，这意味着初始切片的外在曲率消失，即 $\\bar{K}_{ij} = 0$。这意味着其迹（即平均曲率 $K=\\bar{g}^{ij}\\bar{K}_{ij}$）为零，其无迹部分 $A_{ij}$ 也为零。因此，$K=0$ 且 $A_{ij}=0$。\n2.  流形 $\\mathbb{R}^3$ 上的背景度规 $\\gamma_{ij}$ 被选为平坦的欧几里得度规，即 $\\gamma_{ij} = \\delta_{ij}$。平坦度规的标量曲率为零，即 $R(\\gamma) = 0$。相应的拉普拉斯-贝尔特拉米算子 $\\Delta_{\\gamma}$ 变为 $\\mathbb{R}^3$ 上的标准拉普拉斯算子，记作 $\\Delta$。\n\n将这些条件 $R(\\gamma)=0$、$A_{ij}=0$ 和 $K=0$ 代入 Lichnerowicz 方程得到：\n$$\n\\Delta \\phi - \\tfrac{1}{8} (0)\\,\\phi + \\tfrac{1}{8}\\phi^{-7} (0) - \\tfrac{1}{12}(0)^{2}\\phi^{5} = 0,\n$$\n该方程简化为三维拉普拉斯方程：\n$$\n\\Delta \\phi(\\mathbf{x}) = 0.\n$$\n这个关于 $\\phi(\\mathbf{x})$ 的方程必须在区域 $\\mathcal{D} = \\mathbb{R}^{3} \\setminus \\{\\mathbf{c}_{1},\\dots,\\mathbf{c}_{N}\\}$ 上求解，其中 $\\{\\mathbf{c}_{a}\\}_{a=1}^{N}$ 是 $N$ 个不同的点，并且需满足一组边界条件。\n\n边界条件是：\n1.  渐近平坦性：当 $|\\mathbf{x}| \\to \\infty$ 时，$\\phi(\\mathbf{x}) \\to 1$。这个条件施加在区域的“无穷远边界”上。\n2.  刺穿点行为：在每个点 $\\mathbf{c}_{a}$ 附近，函数 $\\phi(\\mathbf{x})$ 必须表现出特定的奇异行为：\n    $$\n    \\phi(\\mathbf{x}) = \\frac{m_{a}}{2\\,|\\mathbf{x} - \\mathbf{c}_{a}|} + \\text{在 } \\mathbf{c}_{a} \\text{ 处正则}.\n    $$\n    术语“在 $\\mathbf{c}_{a}$ 处正则”意味着从 $\\phi(\\mathbf{x})$ 中减去奇异部分后的余项，在包含点 $\\mathbf{c}_{a}$ 的邻域内是一个调和函数。\n\n这个设定构成了位势论中的一个标准边值问题。由于拉普拉斯方程是线性偏微分方程，我们可以使用叠加原理来构造解。我们寻求一个在 $\\mathcal{D}$ 上调和并且在 $\\mathcal{D}$ 的边界（即无穷远处和刺穿点 $\\mathbf{c}_{a}$ 处）满足指定行为的函数。\n\n让我们从基本调和函数开始构建解。常数函数是调和的。函数 $f(\\mathbf{x}) = 1/|\\mathbf{x}-\\mathbf{y}|$ 是三维拉普拉斯算子的基本解，并且对于所有 $\\mathbf{x} \\neq \\mathbf{y}$ 都是调和的。\n\n考虑以下形式的通解，它是这些基本调和函数的线性组合：\n$$\n\\phi(\\mathbf{x}) = C + \\sum_{a=1}^{N} \\frac{C_a}{|\\mathbf{x} - \\mathbf{c}_a|},\n$$\n其中 $C$ 和系数集 $\\{C_a\\}_{a=1}^{N}$ 是待定常数。根据构造，该函数除了在点 $\\mathbf{c}_a$ 外处处调和，因此在区域 $\\mathcal{D}$ 上满足 $\\Delta\\phi=0$。\n\n我们现在应用边界条件来确定这些常数。\n首先，考察 $|\\mathbf{x}| \\to \\infty$ 时的渐近行为。在此极限下，和式中的每一项都趋于零：\n$$\n\\lim_{|\\mathbf{x}| \\to \\infty} \\frac{C_a}{|\\mathbf{x} - \\mathbf{c}_a|} = 0.\n$$\n所以，我们提出的解的极限是：\n$$\n\\lim_{|\\mathbf{x}| \\to \\infty} \\phi(\\mathbf{x}) = C.\n$$\n为了满足渐近平坦条件 $\\phi(\\mathbf{x}) \\to 1$，我们必须设定 $C=1$。候选解变为：\n$$\n\\phi(\\mathbf{x}) = 1 + \\sum_{a=1}^{N} \\frac{C_a}{|\\mathbf{x} - \\mathbf{c}_a|}.\n$$\n接下来，我们在每个刺穿点施加条件。固定一个索引 $b \\in \\{1, \\dots, N\\}$ 并考察函数在 $\\mathbf{c}_b$ 附近的行为。我们可以将第 $b$ 项从和式中分离出来：\n$$\n\\phi(\\mathbf{x}) = \\frac{C_b}{|\\mathbf{x} - \\mathbf{c}_b|} + \\left( 1 + \\sum_{a=1, a \\neq b}^{N} \\frac{C_a}{|\\mathbf{x} - \\mathbf{c}_a|} \\right).\n$$\n括号内的表达式，我们称之为 $h_b(\\mathbf{x})$，是一个常数与形如 $1/|\\mathbf{x} - \\mathbf{c}_a|$（其中 $a \\neq b$）的函数之和。当 $\\mathbf{x}$ 趋近于 $\\mathbf{c}_b$ 时，对于 $a \\neq b$，分母 $|\\mathbf{x} - \\mathbf{c}_a|$ 均不趋于零。因此，$h_b(\\mathbf{x})$ 在 $\\mathbf{c}_b$ 的一个邻域内是良定义的、连续可微的且调和的。换句话说，$h_b(\\mathbf{x})$ 是解在 $\\mathbf{c}_b$ 处的“正则部分”。\n\n问题要求 $\\phi(\\mathbf{x})$ 在 $\\mathbf{c}_b$ 处的奇异部分恰好为 $\\frac{m_{b}}{2\\,|\\mathbf{x} - \\mathbf{c}_{b}|}$。通过将其与我们候选解的奇异部分 $\\frac{C_b}{|\\mathbf{x} - \\mathbf{c}_b|}$ 进行比较，我们可以唯一地确定系数 $C_b$：\n$$\nC_b = \\frac{m_b}{2}.\n$$\n这个逻辑适用于每一个刺穿点 $a = 1, \\dots, N$。因此，我们确定了所有的系数：$C_a = \\frac{m_a}{2}$。\n\n将这些系数代入我们的通解形式，得到唯一解：\n$$\n\\phi(\\mathbf{x}) = 1 + \\sum_{a=1}^{N} \\frac{m_a}{2|\\mathbf{x} - \\mathbf{c}_a|}.\n$$\n这个函数在刺穿域上满足拉普拉斯方程以及所有指定的边界条件。该解的唯一性由位势论中关于外部边值问题的标准定理保证。这个特定的解在相对论文献中被称为 Bowen-York 解，对应于 $N$ 个黑洞的时间对称、共形平坦的初始数据。",
            "answer": "$$\n\\boxed{1 + \\sum_{a=1}^{N} \\frac{m_a}{2|\\mathbf{x} - \\mathbf{c}_a|}}\n$$"
        },
        {
            "introduction": "一旦我们有了有效的初始数据，下一步就是将其在时间上向前演化。然而，并非所有演化方程组都能保证稳定、可预测的解。这个动手练习通过一个玩具模型，生动地揭示了保持演化方程双曲性的重要性。你将通过数值模拟亲眼见证，当一个系统从双曲型转变为椭圆型时，柯西问题是如何变得不适定（ill-posed）并导致灾难性的数值不稳定性的。",
            "id": "3490105",
            "problem": "考虑一个玩具偏微分方程（PDE），旨在模拟广义相对论（GR）中的规范选择如何影响演化方程的双曲性以及柯西问题的适定性。设 $u = u(t,x)$ 为一维空间域上的标量场，具有周期性边界条件，并考虑以下 PDE\n$$\n\\partial_t^2 u(t,x) \\;=\\; g(t)\\,\\partial_x^2 u(t,x),\n$$\n该方程定义在周期区间 $x \\in [0,2\\pi]$ 上，角度以弧度为单位。假设初始数据 $u(0,x)$ 和 $\\partial_t u(0,x)$ 是光滑的。\n\n你需要将其视为一个柯西问题，分析其主符号及其对类规范函数 $g(t)$ 的依赖关系，展示 PDE 的分类如何随 $g(t)$ 的变化而改变。其背景是数值相对论和引力波，其中全局双曲性保证了对于物理上有意义的规范，柯西问题是适定的；这个玩具模型抽象地说明了选择不当的规范会如何破坏双曲性。\n\n定义与基础：\n- 柯西问题旨在探究：给定 $u(0,x)$ 和 $\\partial_t u(0,x)$，是否能得到一个在 $t \\ge 0$ 上连续依赖于初始数据的唯一解 $u(t,x)$。\n- 对于一个二阶双变量 $(t,x)$ 的 PDE，其主符号（协矢量为 $(\\tau,\\xi)$）具有形式 $p(\\tau,\\xi;t) = A(t)\\,\\tau^2 + B(t)\\,\\tau\\,\\xi + C(t)\\,\\xi^2$，其中方程被分为双曲型、抛物型或椭圆型是由判别式 $D(t) = B(t)^2 - 4 A(t) C(t)$ 决定的。\n- 对于给定的 PDE，$A(t) = 1$，$B(t) = 0$，$C(t) = -g(t)$，因此主符号为 $p(\\tau,\\xi;t) = \\tau^2 - g(t)\\,\\xi^2$。双曲性对应于实的特征速度，因此 $D(t) > 0$；椭圆性对应于 $D(t)  0$；抛物型退化对应于 $D(t) = 0$。\n- 在数值相对论中，全局双曲性确保演化方程以全局一致的方式是双曲的，从而使柯西问题在整个时空上是全局适定的。双曲性的丧失对应于该玩具模型中全局双曲性的破坏。\n\n任务：\n1. 从主符号和判别式的定义出发，在你的解答中说明 $g(t)$ 的符号如何决定 PDE 是双曲型、椭圆型还是退化型。然后，解释为什么当 $g(t) > 0$（双曲型）时初值问题是适定的，而当 $g(t)  0$（椭圆型）时是病态的，并讨论抛物型/退化边界情况 $g(t) = 0$。\n2. 使用二阶精度的显式时间步进格式，对具有 $N_x$ 个等距点（角度以弧度为单位）的区间 $[0,2\\pi]$ 上的傅里叶谱方法空间离散进行数值积分。使用初始数据 $u(0,x) = \\sin(x)$ 和 $\\partial_t u(0,x) = 0$。\n3. 为每个测试案例定义一个无量纲的规范函数 $g(t)$，并在固定的时间窗口 $t \\in [0,T_{\\text{end}}]$ 内使用均匀的时间步长 $\\Delta t$ 进行模拟。为了数值稳定性和清晰度，使用 $N_x = 256$，$T_{\\text{end}} = 2$ 以及 $\\Delta t = 10^{-3}$。\n4. 追踪平方 $L^2$ 能量\n$$\nE(t) \\;=\\; \\frac{1}{2\\pi}\\int_{0}^{2\\pi} u(t,x)^2\\,dx,\n$$\n并定义能量增长因子 $R(t) = E(t)/E(0)$。令病态起始时间 $t_{\\text{onset}}$ 为 $R(t)$ 首次超过阈值 $R_{\\text{thr}} = 10$ 的最早时间。如果在 $T_{\\text{end}}$ 之前没有超过该阈值，则设 $t_{\\text{onset}} = -1$。\n5. 实现以下规范函数 $g(t)$ 的测试套件：\n   - 案例 1（全局双曲型）：对于所有 $t \\in [0,T_{\\text{end}}]$，$g(t) = 1$。\n   - 案例 2（双曲到椭圆型转变）：对于 $t \\in [0,T_{\\text{end}}]$，$g(t) = 1 - t$，该函数在 $t = 1$ 时从正值变为负值。\n   - 案例 3（全局椭圆型）：对于所有 $t \\in [0,T_{\\text{end}}]$，$g(t) = -1$。\n   - 案例 4（退化边界）：对于所有 $t \\in [0,T_{\\text{end}}]$，$g(t) = 0$。\n6. 对每个案例，计算以无量纲时间单位表示的 $t_{\\text{onset}}$，并将结果汇总到单行输出中，该行包含一个由方括号括起来的、逗号分隔的 4 个起始时间列表。\n\n最终输出格式：\n- 你的程序应产生单行输出，其中包含一个由方括号括起来的、逗号分隔的结果列表（例如，$[t_1,t_2,t_3,t_4]$），其中每个 $t_i$ 是一个浮点数，代表无量纲单位下的病态起始时间，而 $t_i = -1$ 表示在模拟窗口内没有发生病态。\n\n实现必须是自包含的，并且可以直接运行，无需任何用户输入或外部文件。所有角度均以弧度为单位，所有量均为无量纲。通过使用指定的数值参数并处理转变案例来确保科学真实性，以演示当主符号改变符号时病态的发生。输出必须严格遵循规定的单行格式。",
            "solution": "该问题提出了一个玩具模型，用于分析在数值相对论中出现的偏微分方程（PDE）背景下柯西问题的适定性。我们给定一个二阶线性 PDE，$\\partial_t^2 u(t,x) = g(t)\\,\\partial_x^2 u(t,x)$，其中函数 $g(t)$ 充当“规范选择”，可以改变方程的基本性质。我们首先将对 PDE 的分类及其对初值问题的影响进行理论分析。随后，我们将描述用于模拟演化和检测病态起始的数值方案。\n\n### 理论分析：PDE 分类与适定性\n\n给定的 PDE 是\n$$ \\partial_t^2 u(t,x) = g(t)\\,\\partial_x^2 u(t,x) $$\n可以重写为\n$$ \\partial_t^2 u(t,x) - g(t)\\,\\partial_x^2 u(t,x) = 0. $$\n为了对这个 PDE进行分类，我们分析其主符号。对于一个由 $\\sum_{i,j} A_{ij} \\partial_i \\partial_j u + \\dots = 0$ 给出的通用二阶双变量 $(t,x)$ PDE，其主符号是通过将每个偏导数 $\\partial_i$ 替换为相应的协矢量分量 $\\sigma_i$ 来获得的。这里，我们使用 $(\\tau, \\xi)$ 作为对偶于 $(t,x)$ 的协矢量。我们在 PDE 的最高阶项中将 $\\partial_t \\rightarrow \\tau$ 和 $\\partial_x \\rightarrow \\xi$ 进行替换。这得到特征多项式：\n$$ p(\\tau, \\xi; t) = \\tau^2 - g(t)\\xi^2. $$\n这是一个关于 $(\\tau, \\xi)$ 的二次型。其分为双曲型、椭圆型或抛物型取决于其判别式。对于一般形式 $A\\tau^2 + B\\tau\\xi + C\\xi^2$，判别式为 $D = B^2 - 4AC$。在我们的例子中，$A = 1$，$B = 0$，$C = -g(t)$。因此判别式为：\n$$ D(t) = (0)^2 - 4(1)(-g(t)) = 4g(t). $$\n在给定时间 $t$，PDE 的分类直接取决于 $g(t)$ 的符号：\n\n1.  **双曲型情况 ($g(t) > 0$)：** 如果 $g(t) > 0$，则判别式 $D(t) > 0$。特征方程 $p(\\tau, \\xi; t) = 0$ 对于 $\\tau/\\xi$ 有两个不同的实根，由 $\\tau/\\xi = \\pm\\sqrt{g(t)}$ 给出。这些根代表了信息传播的特征速度 $c(t) = \\pm\\sqrt{g(t)}$。因为这些速度是实数且有限，所以任意点 $(t_0, x_0)$ 的依赖域是初始切片 $t=0$ 上的一个有限区间。这保证了柯西问题是适定的：存在唯一解，并且该解连续地依赖于初始数据。这是类波现象的情况。\n\n2.  **椭圆型情况 ($g(t)  0$)：** 如果 $g(t)  0$，则判别式 $D(t)  0$。特征速度变为纯虚数，$c(t) = \\pm\\sqrt{-|g(t)|} = \\pm i\\sqrt{|g(t)|}$。这表示缺乏一个实值的“传播速度”。椭圆型 PDE 不支持适定的初值问题。为了理解原因，考虑一个形式为 $u(t,x) \\propto e^{ikx}$ 的傅里叶模式解，其中 $k$ 是某个波数。将此代入 PDE，得到一个关于时间相关的振幅 $\\hat{u}_k(t)$ 的常微分方程（ODE）：\n    $$ \\frac{d^2\\hat{u}_k}{dt^2} = g(t)(-k^2)\\hat{u}_k = -g(t)k^2\\hat{u}_k. $$\n    当 $g(t)  0$ 时，右侧的系数 $-g(t)k^2$ 是正的。该 ODE 为 $\\ddot{\\hat{u}}_k = \\omega_k(t)^2 \\hat{u}_k$，其中 $\\omega_k(t) = k\\sqrt{|g(t)|}$ 是一个实频率。通解包含与 $e^{\\int \\omega_k(t) dt}$ 成比例的项。这个指数增长因子对于更高的波数 $k$ 更大。因此，初始数据中的任何高频分量（包括数值舍入误差）都将以任意快的速率被放大，导致解的灾难性崩溃。该问题是病态的。\n\n3.  **抛物型/退化情况 ($g(t) = 0$)：** 如果 $g(t) = 0$，则判别式 $D(t) = 0$。PDE 简化为 $\\partial_t^2 u = 0$。特征速度为零。解就是 $u(t,x) = u(0,x) + t\\,\\partial_t u(0,x)$。每个空间点 $x$ 的演化都与其邻近点无关。虽然是退化的，但该方程的柯西问题仍然是适定的。\n\n### 数值实现\n\n为了在数值上研究这些行为，我们对 PDE 进行离散化，并针对给定的初始数据和测试案例进行求解。\n\n**空间离散化：** 问题指定了一个周期域 $x \\in [0, 2\\pi]$，这非常适合使用傅里叶谱方法。我们在一个由 $N_x$ 个等距点 $x_j = 2\\pi j/N_x$（其中 $j=0, \\dots, N_x-1$）组成的网格上表示解 $u(t,x)$。二阶空间导数 $\\partial_x^2 u$ 在傅里叶空间中可以高效且高精度地计算。设 $\\hat{u}_k(t)$ 是网格值 $u(t, x_j)$ 的离散傅里叶变换（DFT）。那么二阶导数的变换就是 $(-k^2)\\hat{u}_k(t)$，其中 $k$ 是整数波数。该操作按以下步骤执行：\n1. 计算 $u$ 的 DFT：$\\hat{u} = \\text{FFT}(u)$。\n2. 乘以 $-k^2$：$\\widehat{\\partial_x^2 u} = -k^2 \\hat{u}$。\n3. 计算逆 DFT：$\\partial_x^2 u = \\text{IFFT}(\\widehat{\\partial_x^2 u})$。\n\n**时间离散化：** 我们使用二阶精度的显式时间步进格式。蛙跳法（leapfrog method）是处理时间上二阶方程的标准选择。给定 $u^n \\approx u(n\\Delta t)$，更新规则为：\n$$ u^{n+1} = 2u^n - u^{n-1} + (\\Delta t)^2 \\, g(n\\Delta t) \\, (\\partial_x^2 u)^n, $$\n其中 $(\\partial_x^2 u)^n$ 是在时间 $n\\Delta t$ 处计算的空间导数。这是一个两步法，需要前两个时间层级的解，$u^n$ 和 $u^{n-1}$。\n为了初始化该格式，我们需要 $u^0$ 和 $u^1$。$u^0 = u(0,x)$ 是给定的。我们使用围绕 $t=0$ 的二阶泰勒展开来计算 $u^1$：\n$$ u^1 \\approx u(0,x) + \\Delta t \\, \\partial_t u(0,x) + \\frac{(\\Delta t)^2}{2} \\partial_t^2 u(0,x). $$\n利用初始数据 $\\partial_t u(0,x) = 0$ 和 PDE 本身来找到 $\\partial_t^2 u(0,x) = g(0)\\,\\partial_x^2 u(0,x)$，第一步变为：\n$$ u^1 = u^0 + \\frac{(\\Delta t)^2}{2} g(0) (\\partial_x^2 u)^0. $$\n在 $u^0$ 和 $u^1$ 可用后，我们设置 $u_{\\text{prev}} = u^0$ 和 $u_{\\text{curr}} = u^1$ 来开始主蛙跳循环。\n\n**病态分析：** 我们监测解的平方 $L^2$ 能量，对于周期域，其定义为 $E(t) = \\frac{1}{2\\pi}\\int_0^{2\\pi} u(t,x)^2 dx$。在数值上，这被近似为网格值平方的平均值：$E(t) \\approx \\frac{1}{N_x} \\sum_{j=0}^{N_x-1} u(t,x_j)^2$。能量增长因子 $R(t) = E(t)/E(0)$ 追踪解的稳定性。病态表现为能量的快速、无界增长。我们将起始时间 $t_{\\text{onset}}$ 定义为 $R(t)$ 首次超过阈值 $R_{\\text{thr}} = 10$ 的时间 $t$。如果在最终时间 $T_{\\text{end}} = 2$ 之前未达到该阈值，我们设置 $t_{\\text{onset}} = -1$。\n\n### 测试案例的预期行为\n\n1.  **案例 1 ($g(t) = 1$)：** 这是标准的波动方程。解析解为 $u(t,x) = \\sin(x)\\cos(t)$。能量为 $E(t) = E(0)\\cos^2(t)$，是有界的。我们预期 $R(t) \\le 1$，因此 $t_{\\text{onset}} = -1$。\n2.  **案例 2 ($g(t) = 1 - t$)：** 该方程在 $t  1$ 时是双曲型的，在 $t > 1$ 时是椭圆型的。解应在 $t=1$ 之前保持稳定，之后高频数值噪声将开始指数增长。我们预期 $t_{\\text{onset}}$ 会略大于 $1$。\n3.  **案例 3 ($g(t) = -1$)：** 该方程对所有 $t \\ge 0$ 都是椭圆型的。高频模式将从一开始就指数增长。起始时间将由增长最快的模式 $k_{\\text{max}} = N_x/2 = 128$ 的增长决定，并且应该非常短。\n4.  **案例 4 ($g(t) = 0$)：** 该方程为 $\\partial_t^2 u = 0$。在初始速度为零的情况下，解是静态的：$u(t,x) = u(0,x) = \\sin(x)$。能量是恒定的，因此 $t_{\\text{onset}} = -1$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_onset_time(g_func, T_end, dt, Nx, R_thr):\n    \"\"\"\n    Solves the PDE u_tt = g(t) u_xx and finds the onset time of ill-posedness.\n\n    Args:\n        g_func (callable): The gauge function g(t).\n        T_end (float): The end time of the simulation.\n        dt (float): The time step.\n        Nx (int): The number of spatial grid points.\n        R_thr (float): The energy growth ratio threshold.\n\n    Returns:\n        float: The onset time, or -1.0 if no onset occurs.\n    \"\"\"\n    # 1. Setup spatial grid and wavenumbers\n    x = np.linspace(0, 2 * np.pi, Nx, endpoint=False)\n    # Wavenumbers for numpy's FFT\n    k = np.fft.fftfreq(Nx, d=1.0 / Nx)\n\n    # 2. Set initial conditions\n    u_0 = np.sin(x)\n    v_0 = np.zeros(Nx)  # du/dt(0, x) = 0\n\n    # 3. Calculate initial energy\n    E0 = np.mean(u_0**2)\n    # If initial energy is zero, growth factor is ill-defined.\n    if E0  1e-16: # A small tolerance for floating point\n        return -1.0\n\n    # 4. Initialize the time-stepping scheme (Leapfrog)\n    # The leapfrog scheme u_next = 2*u_curr - u_prev + dt^2 * accel\n    # requires a startup step. We use a Taylor expansion to find u(dt).\n    # u(dt) ~= u(0) + dt*v(0) + 0.5*dt^2*a(0)\n    # where a(0) = g(0)*d^2u/dx^2(0).\n\n    # Calculate acceleration at t=0\n    g_val_0 = g_func(0.0)\n    u_hat_0 = np.fft.fft(u_0)\n    d2u_dx2_hat_0 = -(k**2) * u_hat_0\n    d2u_dx2_0 = np.fft.ifft(d2u_dx2_hat_0).real\n    accel_0 = g_val_0 * d2u_dx2_0\n\n    # Compute u at the first time step, t=dt\n    u_1 = u_0 + dt * v_0 + 0.5 * dt**2 * accel_0\n\n    # Setup for the main loop\n    u_prev = u_0  # Solution at time t-dt\n    u_curr = u_1  # Solution at time t\n    t = dt\n\n    num_steps = int(round(T_end / dt))\n\n    # 5. Main evolution loop\n    # We already computed the state at step 1 (t=dt), so we loop from step 2.\n    for i in range(1, num_steps):\n        # Calculate acceleration at the current time t\n        g_val = g_func(t)\n        u_hat = np.fft.fft(u_curr)\n        d2u_dx2_hat = -(k**2) * u_hat\n        d2u_dx2 = np.fft.ifft(d2u_dx2_hat).real\n        accel = g_val * d2u_dx2\n\n        # Perform the leapfrog step to find u at t+dt\n        u_next = 2 * u_curr - u_prev + dt**2 * accel\n\n        # Update state variables for the next iteration\n        u_prev = u_curr\n        u_curr = u_next\n        t += dt\n\n        # 6. Check for ill-posedness onset\n        # Calculate energy and growth factor\n        E = np.mean(u_curr**2)\n        R = E / E0\n\n        if R > R_thr:\n            return t\n\n    # If the loop completes without exceeding the threshold\n    return -1.0\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (globally hyperbolic)\n        {'name': 'Case 1', 'g_func': lambda t: 1.0},\n        # Case 2 (hyperbolic-to-elliptic transition)\n        {'name': 'Case 2', 'g_func': lambda t: 1.0 - t},\n        # Case 3 (globally elliptic)\n        {'name': 'Case 3', 'g_func': lambda t: -1.0},\n        # Case 4 (degenerate boundary)\n        {'name': 'Case 4', 'g_func': lambda t: 0.0}\n    ]\n\n    # Simulation parameters\n    Nx = 256\n    T_end = 2.0\n    dt = 1e-3\n    R_thr = 10.0\n\n    results = []\n    for case in test_cases:\n        t_onset = compute_onset_time(\n            g_func=case['g_func'],\n            T_end=T_end,\n            dt=dt,\n            Nx=Nx,\n            R_thr=R_thr\n        )\n        # Round the result to a reasonable number of decimal places\n        # to match the time step precision for a clean output.\n        if t_onset != -1.0:\n            results.append(round(t_onset, 4))\n        else:\n            results.append(t_onset)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "我们已经知道保持双曲性至关重要，但对于一个给定的爱因斯坦方程表述，我们如何系统地检验它是否具备这一关键属性呢？这个练习将深入一个具体的、从ADM (Arnowitt-Deser-Misner)表述中线性化得到的方程组。你将学会分析其主部（principal part）的性质，以判断系统是否为强双曲的（strongly hyperbolic），这是确保柯西问题适定性的一个关键数学条件。",
            "id": "3490121",
            "problem": "考虑一个规范子系统，它是在一维空间中，围绕闵可夫斯基时空，对带有 Bona–Massó 型切片条件的 Arnowitt-Deser-Misner (ADM) 形式进行线性化所产生的线性常系数一阶简化。设演化场为直减率微扰 $\\alpha$、外在曲率微扰的迹 $K$ 以及辅助变量 $D = \\partial_x \\alpha$。该线性系统为\n$$\n\\partial_t \\alpha \\;=\\; -\\mu_L K,\\qquad\n\\partial_t K \\;+\\; \\partial_x D \\;=\\; 0,\\qquad\n\\partial_t D \\;+\\; \\mu_L\\partial_x K \\;=\\; 0,\n$$\n其中 $\\mu_L \\in \\mathbb{R}$ 是一个常数规范参数。将其写成标准一阶形式\n$$\n\\partial_t \\mathbf{u} \\;+\\; A\\,\\partial_x \\mathbf{u} \\;=\\; S\\,\\mathbf{u},\n$$\n其中 $\\mathbf{u} = (\\alpha, K, D)^{\\mathsf{T}}$，主部矩阵为\n$$\nA \\;=\\; \\begin{pmatrix}\n0  0  0 \\\\[4pt]\n0  0  1 \\\\[4pt]\n0  \\mu_L  0\n\\end{pmatrix},\n$$\n低阶源矩阵为\n$$\nS \\;=\\; \\begin{pmatrix}\n0  -\\mu_L  0 \\\\[4pt]\n0  0  0 \\\\[4pt]\n0  0  0\n\\end{pmatrix}.\n$$\n在这种常系数情况下，如果对于每个单位空间方向，主特征标都具有一组完备的特征向量且所有特征速度都为实数，则该偏微分方程 (PDE) 组被称为强双曲的。对于上述一维情况，这简化为矩阵 $A$ 具有一组完备的特征向量和实特征值。对于波数为 $k \\in \\mathbb{R}$ 的傅里叶模式，其时间演化算子为\n$$\nM(k) \\;=\\; -i k A \\;+\\; S,\n$$\n因此在傅里叶空间中 $\\partial_t \\widehat{\\mathbf{u}} = M(k)\\widehat{\\mathbf{u}}$，并且该模式的瞬时增长率由 $M(k)$ 特征值实部的最大值给出。\n\n任务。您必须实现一个程序，对于每个指定的测试用例，完成以下所有纯算法步骤：\n- 步骤 $1$：根据给定的 $\\mu_L$ 构建 $A$ 和 $S$。\n- 步骤 $2$：通过检查 $A$ 的所有特征值是否为实数，以及 $A$ 是否具有完备的特征向量集（即特征向量矩阵满秩），来确定系统是否为强双曲的。\n- 步骤 $3$：对于给定的两个波数 $k_1$ 和 $k_2$，计算最大增长率 $g(k_1)$ 和 $g(k_2)$，其中 $g(k) = \\max\\{\\operatorname{Re}(\\lambda) : \\lambda \\text{ 是 } M(k) \\text{ 的特征值}\\}$。\n- 步骤 $4$：估计高频增长斜率\n$$\ns \\;=\\; \\frac{g(k_2)-g(k_1)}{k_2 - k_1}.\n$$\n- 步骤 $5$：计算主特征标 $A$ 的两个特征诊断量：\n  - 不稳定度指标\n  $$\n  b \\;=\\; \\max_{\\lambda \\in \\sigma(A)} \\left|\\operatorname{Im}(\\lambda)\\right|,\n  $$\n  它量化了非实数特征速度的大小。\n  - 最大实特征速度大小\n  $$\n  v \\;=\\; \\max_{\\lambda \\in \\sigma(A)} \\left|\\operatorname{Re}(\\lambda)\\right|,\n  $$\n  如果任何特征值为非实数，则解释为 $0$。\n\n您必须将所有浮点输出 $s$, $b$ 和 $v$ 四舍五入到恰好 $6$ 位小数。对于每个测试用例，您的程序必须输出形式为 $[\\text{strong}, s, b, v]$ 的列表，其中 $\\text{strong}$ 是一个布尔值，指示是否为强双曲。最终输出必须是包含这些每个测试用例列表的单行，其中不含空格。此问题中不出现角度，也没有物理单位。\n\n测试套件。在以下参数集 $(\\mu_L, k_1, k_2)$ 上运行您的程序：\n- 情况 $1$：$(\\mu_L, k_1, k_2) = (4, 8, 16)$。\n- 情况 $2$：$(\\mu_L, k_1, k_2) = (0, 8, 16)$。\n- 情况 $3$：$(\\mu_L, k_1, k_2) = (-1, 8, 16)$。\n- 情况 $4$：$(\\mu_L, k_1, k_2) = (0.01, 8, 16)$。\n\n最终输出格式。您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，每个测试用例按上述顺序构成一个子列表，并且任何地方都没有空格。例如，该行必须看起来像\n$$\n[\\,[\\text{strong}_1, s_1, b_1, v_1],\\,[\\text{strong}_2, s_2, b_2, v_2],\\,[\\text{strong}_3, s_3, b_3, v_3],\\,[\\text{strong}_4, s_4, b_4, v_4]\\,],\n$$\n并精确地作为单行打印，浮点数四舍五入到 $6$ 位小数。",
            "solution": "该问题要求对一个线性常系数偏微分方程(PDE)组的多个测试用例进行分析。分析内容包括确定系统的双曲性并计算各种诊断量。解决方案首先根据规范参数 $\\mu_L$ 解析推导出所有所需量的表达式，然后实现这些公式。\n\n控制 PDE 系统以一阶形式给出为 $\\partial_t \\mathbf{u} + A\\,\\partial_x \\mathbf{u} = S\\,\\mathbf{u}$，其中状态向量为 $\\mathbf{u} = (\\alpha, K, D)^{\\mathsf{T}}$，主部矩阵为 $A$，源矩阵为 $S$：\n$$\nA = \\begin{pmatrix}\n0  0  0 \\\\\n0  0  1 \\\\\n0  \\mu_L  0\n\\end{pmatrix}, \\quad\nS = \\begin{pmatrix}\n0  -\\mu_L  0 \\\\\n0  0  0 \\\\\n0  0  0\n\\end{pmatrix}\n$$\n\n首先，我们分析主部矩阵 $A$ 的性质。系统的特征速度是 $A$ 的特征值。特征方程为 $\\det(A - \\lambda I) = 0$：\n$$\n\\det\\begin{pmatrix} -\\lambda  0  0 \\\\ 0  -\\lambda  1 \\\\ 0  \\mu_L  -\\lambda \\end{pmatrix} = -\\lambda(\\lambda^2 - \\mu_L) = 0\n$$\n代表特征速度的特征值为 $\\lambda_1 = 0$, $\\lambda_2 = \\sqrt{\\mu_L}$ 和 $\\lambda_3 = -\\sqrt{\\mu_L}$。\n\n如果 $A$ 的所有特征值都是实数且 $A$ 拥有一组完备的特征向量，则该系统是强双曲的。\n1.  **特征值的实数性**：特征值为实数的充要条件是 $\\mu_L \\ge 0$。如果 $\\mu_L  0$，$\\sqrt{\\mu_L}$ 和 $-\\sqrt{\\mu_L}$ 是非零纯虚数。\n2.  **特征向量的完备性**：\n    - 如果 $\\mu_L > 0$，特征值 $0, \\sqrt{\\mu_L}, -\\sqrt{\\mu_L}$ 是实数且互不相同。具有不同特征值的矩阵总是可对角化的，这意味着它有一组完备的线性无关特征向量。\n    - 如果 $\\mu_L = 0$，矩阵变为 $A = \\left(\\begin{smallmatrix} 0  0  0 \\\\ 0  0  1 \\\\ 0  0  0 \\end{smallmatrix}\\right)$。特征值 $\\lambda=0$ 的代数重数为 $3$。通过求解 $A\\mathbf{v} = 0$ 找到特征向量 $\\mathbf{v}$，得到 $v_3=0$。特征空间由 $(1, 0, 0)^{\\mathsf{T}}$ 和 $(0, 1, 0)^{\\mathsf{T}}$ 张成，因此其维度（几何重数）为 $2$。由于几何重数 ($2$) 小于代数重数 ($3$)，该矩阵不可对角化，没有完备的特征向量集。\n    - 如果 $\\mu_L  0$，特征值不全为实数。\n\n综合这些条件，系统是强双曲的当且仅当 $\\mu_L > 0$。这为布尔输出 `strong` 提供了一个简单的判据。\n\n接下来，我们推导诊断量 $b$ 和 $v$ 的解析表达式。\n- 不稳定度指标是 $b = \\max_{\\lambda \\in \\sigma(A)} |\\operatorname{Im}(\\lambda)|$。\n  - 如果 $\\mu_L \\ge 0$，所有特征值都是实数，因此它们的虚部为 $0$。所以，$b = 0$。\n  - 如果 $\\mu_L  0$，特征值为 $0, i\\sqrt{-\\mu_L}, -i\\sqrt{-\\mu_L}$。虚部分别是 $0, \\sqrt{-\\mu_L}, -\\sqrt{-\\mu_L}$。最大绝对值为 $b = \\sqrt{-\\mu_L}$。\n- 最大实特征速度大小是 $v = \\max_{\\lambda \\in \\sigma(A)} |\\operatorname{Re}(\\lambda)|$，条件是如果任何特征值为非实数，则 $v=0$。\n  - 如果 $\\mu_L  0$，特征值不全为实数，因此根据定义，$v=0$。\n  - 如果 $\\mu_L = 0$，特征值为 $0, 0, 0$。它们都是实数，实部为 $0$。因此，$v = 0$。\n  - 如果 $\\mu_L > 0$，特征值为 $0, \\sqrt{\\mu_L}, -\\sqrt{\\mu_L}$。它们都是实数。最大绝对值为 $v = \\sqrt{\\mu_L}$。\n\n现在，我们分析傅里叶空间演化算子 $M(k) = -ikA + S$ 以确定增长率。\n$$\nM(k) = -ik\\begin{pmatrix}\n0  0  0 \\\\\n0  0  1 \\\\\n0  \\mu_L  0\n\\end{pmatrix} + \\begin{pmatrix}\n0  -\\mu_L  0 \\\\\n0  0  0 \\\\\n0  0  0\n\\end{pmatrix} = \\begin{pmatrix}\n0  -\\mu_L  0 \\\\\n0  0  -ik \\\\\n0  -ik\\mu_L  0\n\\end{pmatrix}\n$$\n$M(k)$ 的特征值 $\\lambda_M$ 决定了傅里叶模式的时间行为。特征方程是 $\\det(M(k) - \\lambda_M I) = 0$：\n$$\n\\det\\begin{pmatrix} -\\lambda_M  -\\mu_L  0 \\\\ 0  -\\lambda_M  -ik \\\\ 0  -ik\\mu_L  -\\lambda_M \\end{pmatrix} = -\\lambda_M(\\lambda_M^2 - (-ik)(-ik\\mu_L)) = -\\lambda_M(\\lambda_M^2 + \\mu_L k^2) = 0\n$$\n$M(k)$ 的特征值为 $\\lambda_{M,1} = 0$ 和 $\\lambda_{M,2,3} = \\pm\\sqrt{-\\mu_L k^2} = \\pm ik\\sqrt{\\mu_L}$。\n\n瞬时增长率是 $g(k) = \\max\\{\\operatorname{Re}(\\lambda_M)\\}$。\n- 如果 $\\mu_L \\ge 0$，特征值为 $0, \\pm ik\\sqrt{\\mu_L}$，它们都是纯虚数（或零）。实部全为 $0$。因此，$g(k) = 0$。\n- 如果 $\\mu_L  0$，设 $\\mu_L = -c^2$，其中 $c = \\sqrt{-\\mu_L} > 0$。特征值变为 $0, \\pm ik(ic) = \\mp kc$。它们是 $0, kc, -kc$，都是实数。最大实部为 $g(k) = kc = k\\sqrt{-\\mu_L}$，假设波数 $k \\ge 0$。\n\n最后，我们计算高频增长斜率 $s = (g(k_2)-g(k_1))/(k_2 - k_1)$。\n- 如果 $\\mu_L \\ge 0$，$g(k) = 0$ 对于所有 $k$ 成立，所以 $g(k_1)=g(k_2)=0$。这得出 $s = 0$。\n- 如果 $\\mu_L  0$，$g(k) = k\\sqrt{-\\mu_L}$。斜率为 $s = (k_2\\sqrt{-\\mu_L} - k_1\\sqrt{-\\mu_L})/(k_2 - k_1) = \\sqrt{-\\mu_L}(k_2 - k_1)/(k_2 - k_1) = \\sqrt{-\\mu_L}$。\n\n将要实现的算法将使用这些推导出的解析公式，这比为每个案例进行矩阵特征值和秩的数值计算更稳健、更高效。\n\n解析公式总结：\n- 强双曲性 (`strong`)：如果 $\\mu_L > 0$ 则为 `true`，否则为 `false`。\n- 不稳定度指标 ($b$)：如果 $\\mu_L  0$，则 $b = \\sqrt{-\\mu_L}$，否则 $b=0$。\n- 最大特征速度 ($v$)：如果 $\\mu_L > 0$，则 $v = \\sqrt{\\mu_L}$，否则 $v=0$。\n- 增长斜率 ($s$)：如果 $\\mu_L  0$，则 $s = \\sqrt{-\\mu_L}$，否则 $s=0$。\n\n将这些公式应用于每个测试用例以生成最终结果。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem for the given test suite by analyzing the PDE system properties\n    based on the parameter mu_L.\n    \"\"\"\n    # Test Suite: (mu_L, k1, k2)\n    test_cases = [\n        (4.0, 8.0, 16.0),\n        (0.0, 8.0, 16.0),\n        (-1.0, 8.0, 16.0),\n        (0.01, 8.0, 16.0),\n    ]\n\n    results_data = []\n\n    for case in test_cases:\n        mu_L, k1, k2 = case\n\n        # Step 2: Determine strong hyperbolicity.\n        # The system is strongly hyperbolic if and only if mu_L > 0.\n        # This is because for mu_L > 0, the eigenvalues of A are real and distinct.\n        # For mu_L = 0, A is defective (incomplete set of eigenvectors).\n        # For mu_L  0, A has non-real eigenvalues.\n        is_strong_hyperbolic = mu_L > 0\n\n        # Step 5: Compute characteristic diagnostics of A.\n        # The eigenvalues of A are 0, +/-sqrt(mu_L).\n\n        # b = max(|Im(lambda)|)\n        if mu_L  0:\n            b = np.sqrt(-mu_L)\n        else:\n            b = 0.0\n\n        # v = max(|Re(lambda)|), or 0 if any lambda is non-real.\n        if mu_L > 0:\n            v = np.sqrt(mu_L)\n        else:\n            # This covers mu_L  0 (non-real eigenvalues) and mu_L = 0 (all eigenvalues are 0).\n            v = 0.0\n\n        # Steps 3  4: Compute growth rates and estimate slope s.\n        # The eigenvalues of M(k) are 0, +/- i*k*sqrt(mu_L).\n        # The growth rate g(k) is the max real part of these eigenvalues.\n        # The slope s is (g(k2)-g(k1))/(k2-k1).\n\n        if mu_L  0:\n            # g(k) = k * sqrt(-mu_L). Eigenvalues of M(k) are real: 0, +/- k*sqrt(-mu_L).\n            s = np.sqrt(-mu_L)\n        else:\n            # g(k) = 0. Eigenvalues of M(k) are purely imaginary or zero.\n            s = 0.0\n        \n        results_data.append([is_strong_hyperbolic, s, b, v])\n\n    # Format the final output string according to the problem specification.\n    # No spaces, boolean as lowercase, floats to 6 decimal places.\n    output_parts = []\n    for res in results_data:\n        strong, s_val, b_val, v_val = res\n        strong_str = str(strong).lower()\n        s_str = f\"{s_val:.6f}\"\n        b_str = f\"{b_val:.6f}\"\n        v_str = f\"{v_val:.6f}\"\n        output_parts.append(f\"[{strong_str},{s_str},{b_str},{v_str}]\")\n    \n    final_output = f\"[{','.join(output_parts)}]\"\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}