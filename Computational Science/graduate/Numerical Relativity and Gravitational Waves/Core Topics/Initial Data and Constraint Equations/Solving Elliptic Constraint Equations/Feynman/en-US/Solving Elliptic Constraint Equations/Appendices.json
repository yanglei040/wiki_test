{
    "hands_on_practices": [
        {
            "introduction": "The Einstein constraint equations can appear daunting, but under common simplifying assumptions, their structure becomes much clearer. This first practice demonstrates how, in a vacuum spacetime with constant mean curvature (CMC), the momentum constraint simplifies into a vector elliptic equation for a potential field $W^i$ . Working through this derivation provides a foundational understanding of the mathematical problem at the heart of many initial data solvers and introduces key concepts like uniqueness and the role of boundary conditions.",
            "id": "3486526",
            "problem": "Consider vacuum Cauchy initial data in the $3\\!+\\!1$ decomposition of General Relativity, where the momentum constraint is given by $\\nabla_{j}\\!\\left(K^{ij}-\\gamma^{ij}K\\right)=0$. Adopt the conformal transverse-traceless decomposition with $\\gamma_{ij}=\\psi^{4}\\tilde{\\gamma}_{ij}$, $K=\\text{const}$, and the trace-free part of the extrinsic curvature decomposed as $A^{ij}=\\psi^{-10}\\left(\\tilde{A}_{\\mathrm{TT}}^{ij}+(\\tilde{\\mathbb{L}}W)^{ij}\\right)$, where $\\tilde{A}_{\\mathrm{TT}}^{ij}$ is a prescribed transverse-traceless (TT) tensor with respect to the conformal metric $\\tilde{\\gamma}_{ij}$ and $(\\tilde{\\mathbb{L}}W)^{ij}$ is the conformal Killing operator acting on a vector field $W^{i}$, defined by $(\\tilde{\\mathbb{L}}W)^{ij}=\\tilde{\\nabla}^{i}W^{j}+\\tilde{\\nabla}^{j}W^{i}-\\tfrac{2}{3}\\tilde{\\gamma}^{ij}\\tilde{\\nabla}_{k}W^{k}$. Assume a conformally flat background, $\\tilde{\\gamma}_{ij}=\\delta_{ij}$, on the manifold $\\mathbb{R}^{3}$ with asymptotically Euclidean falloff, $\\tilde{A}_{\\mathrm{TT}}^{ij}=\\mathcal{O}(r^{-3})$ and $W^{i}=\\mathcal{O}(r^{-1})$ as $r\\to\\infty$, where $r$ is the Euclidean radius. Starting from the momentum constraint and the fundamental definitions above, derive the elliptic system that $W^{i}$ must satisfy in this setting, solve it under the stated boundary conditions, and justify uniqueness of $W^{i}$ modulo conformal Killing vectors (CKVs) of $\\tilde{\\gamma}_{ij}$. Express the final answer for the three components of the solution $W^{i}$ as a single row matrix. No rounding is required, and no physical units are involved in this problem.",
            "solution": "The problem requires us to derive and solve the elliptic system for the vector field $W^i$ which is part of the conformal transverse-traceless decomposition of the extrinsic curvature in vacuum General Relativity under the assumption of a constant mean curvature ($K=\\text{const}$) slice.\n\nThe starting point is the momentum constraint equation for vacuum spacetimes:\n$$\n\\nabla_{j}\\!\\left(K^{ij}-\\gamma^{ij}K\\right)=0\n$$\nwhere $\\nabla_j$ is the covariant derivative compatible with the spatial metric $\\gamma_{ij}$, $K^{ij}$ is the extrinsic curvature tensor, and $K = \\gamma_{ij}K^{ij}$ is its trace.\n\nWe decompose the extrinsic curvature into its trace-free part $A^{ij}$ and its trace part:\n$$\nK^{ij} = A^{ij} + \\frac{1}{3}\\gamma^{ij}K\n$$\nSubstituting this into the momentum constraint gives:\n$$\n\\nabla_{j}\\!\\left(A^{ij} + \\frac{1}{3}\\gamma^{ij}K - \\gamma^{ij}K\\right) = \\nabla_{j}\\!\\left(A^{ij} - \\frac{2}{3}\\gamma^{ij}K\\right) = 0\n$$\nExpanding the divergence:\n$$\n\\nabla_{j}A^{ij} - \\frac{2}{3}\\nabla_{j}(\\gamma^{ij}K) = 0\n$$\n$$\n\\nabla_{j}A^{ij} - \\frac{2}{3}(K\\nabla_{j}\\gamma^{ij} + \\gamma^{ij}\\nabla_{j}K) = 0\n$$\nDue to metric compatibility, $\\nabla_{j}\\gamma^{ij}=0$. The problem states that $K=\\text{const}$, which implies its covariant derivative is zero, $\\nabla_j K = \\partial_j K = 0$. Thus, the momentum constraint simplifies significantly to:\n$$\n\\nabla_{j}A^{ij} = 0\n$$\nNext, we apply the conformal decomposition. The spatial metric is $\\gamma_{ij} = \\psi^4 \\tilde{\\gamma}_{ij}$, which implies the inverse metric is $\\gamma^{ij} = \\psi^{-4} \\tilde{\\gamma}^{ij}$. The trace-free part of the extrinsic curvature is given by $A^{ij}=\\psi^{-10}\\tilde{A}^{ij}$, where $\\tilde{A}^{ij} = \\tilde{A}_{\\mathrm{TT}}^{ij}+(\\tilde{\\mathbb{L}}W)^{ij}$. The tensor $\\tilde{A}^{ij}$ is trace-free with respect to the conformal metric $\\tilde{\\gamma}_{ij}$, i.e., $\\tilde{\\gamma}_{ij}\\tilde{A}^{ij}=0$.\n\nWe need to relate the physical divergence $\\nabla_j A^{ij}$ to the divergence with respect to the conformal metric, $\\tilde{\\nabla}_j \\tilde{A}^{ij}$. Using the transformation law for the covariant derivative of a contravariant tensor of rank 2, we have:\n$$\n\\nabla_j A^{ij} = \\partial_j A^{ij} + \\Gamma^i_{jk} A^{jk} + \\Gamma^j_{jk} A^{ik}\n$$\nThe Christoffel symbols are related by $\\Gamma^i_{jk} = \\tilde{\\Gamma}^i_{jk} + 2(\\delta^i_j \\tilde{\\nabla}_k\\ln\\psi + \\delta^i_k \\tilde{\\nabla}_j\\ln\\psi - \\tilde{\\gamma}_{jk}\\tilde{\\nabla}^i\\ln\\psi)$ and $\\Gamma^j_{jk} = \\tilde{\\Gamma}^j_{jk} + 6\\tilde{\\nabla}_k\\ln\\psi$. Substituting $A^{ij} = \\psi^{-10}\\tilde{A}^{ij}$ and the relations for the Christoffel symbols:\n$$\n\\nabla_j (\\psi^{-10}\\tilde{A}^{ij}) = \\partial_j(\\psi^{-10}\\tilde{A}^{ij}) + \\left(\\tilde{\\Gamma}^i_{jk} + 2(\\delta^i_j \\tilde{\\nabla}_k\\ln\\psi + \\delta^i_k \\tilde{\\nabla}_j\\ln\\psi - \\tilde{\\gamma}_{jk}\\tilde{\\nabla}^i\\ln\\psi)\\right)\\psi^{-10}\\tilde{A}^{jk} + \\left(\\tilde{\\Gamma}^j_{jk} + 6\\tilde{\\nabla}_k\\ln\\psi\\right)\\psi^{-10}\\tilde{A}^{ik}\n$$\nExpanding and collecting terms, we get:\n$$\n\\psi^{10}\\nabla_j A^{ij} = (\\partial_j \\tilde{A}^{ij} + \\tilde{\\Gamma}^i_{jk}\\tilde{A}^{jk} + \\tilde{\\Gamma}^j_{jk}\\tilde{A}^{ik}) - 10\\tilde{A}^{ij}\\tilde{\\nabla}_j\\ln\\psi + 2\\tilde{A}^{ik}\\tilde{\\nabla}_k\\ln\\psi + 2\\tilde{A}^{ji}\\tilde{\\nabla}_j\\ln\\psi - 2\\tilde{\\gamma}_{jk}\\tilde{A}^{jk}\\tilde{\\nabla}^i\\ln\\psi + 6\\tilde{A}^{ik}\\tilde{\\nabla}_k\\ln\\psi\n$$\nThe term in the first parenthesis is $\\tilde{\\nabla}_j\\tilde{A}^{ij}$. Since $\\tilde{A}^{ij}$ is trace-free, $\\tilde{\\gamma}_{jk}\\tilde{A}^{jk}=0$. Using the symmetry of $\\tilde{A}^{ij}$, the remaining terms are:\n$$\n\\psi^{10}\\nabla_j A^{ij} = \\tilde{\\nabla}_j \\tilde{A}^{ij} + (-10+2)\\tilde{A}^{ij}\\tilde{\\nabla}_j\\ln\\psi + (2+6)\\tilde{A}^{ik}\\tilde{\\nabla}_k\\ln\\psi = \\tilde{\\nabla}_j \\tilde{A}^{ij} - 8\\tilde{A}^{ij}\\tilde{\\nabla}_j\\ln\\psi + 8\\tilde{A}^{ik}\\tilde{\\nabla}_k\\ln\\psi\n$$\nBy relabeling the dummy summation index in the last term from $k$ to $j$, we see that the terms involving derivatives of $\\psi$ cancel out.\n$$\n\\nabla_j A^{ij} = \\psi^{-10} \\tilde{\\nabla}_j \\tilde{A}^{ij}\n$$\nThus, the momentum constraint $\\nabla_j A^{ij} = 0$ is equivalent to $\\tilde{\\nabla}_j \\tilde{A}^{ij} = 0$.\nWe now substitute the decomposition $\\tilde{A}^{ij} = \\tilde{A}_{\\mathrm{TT}}^{ij} + (\\tilde{\\mathbb{L}}W)^{ij}$:\n$$\n\\tilde{\\nabla}_j (\\tilde{A}_{\\mathrm{TT}}^{ij} + (\\tilde{\\mathbb{L}}W)^{ij}) = 0\n$$\nBy definition, a transverse-traceless tensor $\\tilde{A}_{\\mathrm{TT}}^{ij}$ is divergence-free with respect to the conformal metric, i.e., $\\tilde{\\nabla}_j \\tilde{A}_{\\mathrm{TT}}^{ij} = 0$. This leaves us with an elliptic equation for the vector field $W^i$:\n$$\n\\tilde{\\nabla}_j (\\tilde{\\mathbb{L}}W)^{ij} = 0\n$$\nThe problem specifies a conformally flat background on $\\mathbb{R}^3$, so $\\tilde{\\gamma}_{ij}=\\delta_{ij}$. In this case, the conformal covariant derivative $\\tilde{\\nabla}_j$ becomes the ordinary partial derivative $\\partial_j$. The conformal Killing operator becomes:\n$$\n(\\tilde{\\mathbb{L}}W)^{ij} = \\partial^{i}W^{j}+\\partial^{j}W^{i}-\\frac{2}{3}\\delta^{ij}\\partial_{k}W^{k}\n$$\nThe equation for $W^i$ is $\\partial_j (\\tilde{\\mathbb{L}}W)^{ij} = 0$. Let's expand this:\n$$\n\\partial_j \\left(\\partial^{i}W^{j}+\\partial^{j}W^{i}-\\frac{2}{3}\\delta^{ij}\\partial_{k}W^{k}\\right) = 0\n$$\n$$\n\\partial^i(\\partial_j W^j) + \\partial_j\\partial^j W^i - \\frac{2}{3}\\partial^i(\\partial_k W^k) = 0\n$$\nUsing vector notation where $\\vec{\\nabla}\\cdot\\vec{W} = \\partial_j W^j$ is the divergence and $\\nabla^2 = \\partial_j \\partial^j$ is the Laplacian, this equation for the $i$-th component of $\\vec{W}$ is:\n$$\n\\nabla^2 W^i + \\frac{1}{3} \\partial^i (\\partial_j W^j) = 0\n$$\nThis is the elliptic system that $W^i$ must satisfy. To solve it, we take its divergence by applying $\\partial_i$:\n$$\n\\partial_i(\\nabla^2 W^i) + \\partial_i\\left(\\frac{1}{3} \\partial^i (\\partial_j W^j)\\right) = 0\n$$\n$$\n\\nabla^2 (\\partial_i W^i) + \\frac{1}{3} \\nabla^2 (\\partial_j W^j) = 0\n$$\nLet $\\theta = \\partial_j W^j$. The equation becomes $\\frac{4}{3}\\nabla^2\\theta=0$, which implies $\\nabla^2\\theta=0$. So, the divergence of $\\vec{W}$ is a harmonic function on $\\mathbb{R}^3$.\nThe boundary condition on $W^i$ is $W^i = \\mathcal{O}(r^{-1})$ as $r \\to \\infty$. This implies that its derivatives fall off faster: $\\partial_j W^i = \\mathcal{O}(r^{-2})$. Therefore, $\\theta = \\partial_j W^j = \\mathcal{O}(r^{-2})$. A harmonic function on $\\mathbb{R}^3$ that vanishes at infinity (which $\\mathcal{O}(r^{-2})$ does) must be identically zero. Thus, $\\theta = \\partial_j W^j = 0$.\n\nSubstituting $\\partial_j W^j = 0$ back into the elliptic system for $W^i$, we get:\n$$\n\\nabla^2 W^i = 0\n$$\nEach component $W^i$ must be a harmonic function on $\\mathbb{R}^3$. The boundary condition is $W^i = \\mathcal{O}(r^{-1})$, which implies $\\lim_{r\\to\\infty} W^i(x) = 0$. By a standard theorem of potential theory (a corollary of Liouville's theorem for harmonic functions), any harmonic function on all of $\\mathbb{R}^n$ ($n\\geq 2$) which vanishes at infinity must be identically zero.\nTherefore, the unique solution satisfying the given conditions is $W^i = 0$ for $i=1, 2, 3$.\n\nThe problem mentions uniqueness modulo conformal Killing vectors (CKVs). A vector field $X^i$ is a CKV of $\\tilde{\\gamma}_{ij}$ if its conformal Killing operator vanishes, $(\\tilde{\\mathbb{L}}X)^{ij}=0$. If $W^i$ is a solution to $\\tilde{\\nabla}_j(\\tilde{\\mathbb{L}}W)^{ij}=0$, then $W^i+X^i$ is also a solution. This constitutes the ambiguity. However, the solution must satisfy the boundary condition $W^i = \\mathcal{O}(r^{-1})$. If two solutions $W_1^i$ and $W_2^i$ satisfy this condition, their difference $\\delta W^i = W_1^i - W_2^i$ must also satisfy it, so $\\delta W^i=\\mathcal{O}(r^{-1})$. This difference must be a CKV. The CKVs of flat space $\\mathbb{R}^3$ are translations ($X^i=c^i$), rotations ($X^i=\\omega^i_j x^j$), dilatations ($X^i=cx^i$), and special conformal transformations ($X^i=b^i r^2 - 2x^i(b\\cdot x)$). None of these non-trivial CKVs fall off at infinity. The only CKV that satisfies the $\\mathcal{O}(r^{-1})$ falloff condition is the trivial one, $X^i=0$. Therefore, the boundary condition fixes the solution uniquely, removing any ambiguity from CKVs. The solution is $W^i=0$.\n\nThe three components of the solution vector $W^i$ are $(W^1, W^2, W^3) = (0, 0, 0)$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0 & 0 & 0\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Having derived the fundamental elliptic system, we now explore a powerful method for solving it in spacetimes with spherical symmetry. This exercise involves expanding the vector potential $W^i$ in a basis of vector spherical harmonics, a technique that decouples the partial differential equation into a set of more manageable radial ordinary differential equations (ODEs) . This practice is invaluable for understanding how spectral methods are applied to solve the constraint equations, forming the basis of many highly accurate numerical codes.",
            "id": "3486545",
            "problem": "You are tasked with formulating and implementing the vacuum Constant Mean Curvature (CMC) momentum constraint in the Arnowitt-Deser-Misner (ADM) conformal method on a spherical domain. Start from first principles and derive the decoupled radial ordinary differential equations (ODEs) satisfied by the expansion coefficients when the vector potential $W^i$ is expanded in the complete basis of vector spherical harmonics on the unit sphere. The domain is a ball of radius $R$ in flat three-dimensional space, and the conformal metric is Euclidean. Assume vacuum and CMC so that the source term vanishes. Use the canonical decomposition of $W^i$ into a gradient family and a toroidal (divergence-free, purely tangential) family built from scalar potentials on the sphere. Enforce regularity at the origin $r=0$ and homogeneous Dirichlet boundary conditions on the outer boundary $r=R$ for the scalar potentials that generate the two families. Derive the decoupled radial ODEs for the radial coefficients associated with each spherical harmonic mode indexed by the angular momentum number $\\ell \\in \\mathbb{N}$, and implement a program that solves these ODEs and evaluates the scalar potentials at specified radii.\n\nYour program should implement the following computational task:\n- For each test case, with parameters $(\\ell, R, r_{\\text{eval}}, p_R, t_R)$, where $\\ell$ is the angular momentum number in the vector spherical harmonics expansion, $R$ is the outer radius of the spherical domain, $r_{\\text{eval}}$ is the radius at which the solution is evaluated, $p_R$ is the Dirichlet boundary value at $r=R$ for the scalar potential that generates the gradient family, and $t_R$ is the Dirichlet boundary value at $r=R$ for the scalar potential that generates the toroidal family, compute the values $p_\\ell(r_{\\text{eval}})$ and $t_\\ell(r_{\\text{eval}})$ under the regularity-at-origin requirement.\n\nUse the following test suite of parameter values, each given as $(\\ell, R, r_{\\text{eval}}, p_R, t_R)$:\n- Test case $1$: $(\\ell = 1, R = 1.0, r_{\\text{eval}} = 0.0, p_R = 1.0, t_R = 1.0)$\n- Test case $2$: $(\\ell = 2, R = 1.0, r_{\\text{eval}} = 0.5, p_R = 2.0, t_R = 3.0)$\n- Test case $3$: $(\\ell = 3, R = 2.0, r_{\\text{eval}} = 1.0, p_R = 1.5, t_R = 0.4)$\n- Test case $4$: $(\\ell = 4, R = 1.5, r_{\\text{eval}} = 1.5, p_R = 10.0, t_R = 2.0)$\n- Test case $5$: $(\\ell = 10, R = 1.0, r_{\\text{eval}} = 0.9, p_R = 1.0, t_R = 1.0)$\n\nNo physical units are involved.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Aggregate the outputs as $[p_1, t_1, p_2, t_2, p_3, t_3, p_4, t_4, p_5, t_5]$, where $p_k$ and $t_k$ denote $p_\\ell(r_{\\text{eval}})$ and $t_\\ell(r_{\\text{eval}})$ for the $k$-th test case in the above order.",
            "solution": "The problem requires the derivation and solution of the radial equations for the scalar potentials generating the vacuum Constant Mean Curvature (CMC) momentum constraint vector field $W^i$ on a spherical domain. We begin from first principles within the Arnowitt-Deser-Misner (ADM) conformal method.\n\nThe momentum constraint equation in the ADM formalism is given by $D_j K^{ij} - D^i K = 8\\pi G S^i$, where $K_{ij}$ is the extrinsic curvature, $K$ is its trace, $D_j$ is the covariant derivative compatible with the $3$-metric $g_{ij}$, and $S^i$ is the momentum density of matter sources. We are given vacuum conditions, so $S^i = 0$. Using the trace-free part of the extrinsic curvature, $A^{ij} = K^{ij} - \\frac{1}{3} g^{ij} K$, the vacuum momentum constraint becomes $D_j A^{ij} - \\frac{2}{3} g^{ij} D_j K = 0$. For the CMC case, the mean curvature $K$ is constant, so $D_j K = 0$, and the equation simplifies to $D_j A^{ij} = 0$.\n\nIn the conformal approach, we set the spatial metric $g_{ij} = \\psi^4 \\tilde{g}_{ij}$ and the trace-free extrinsic curvature $A^{ij} = \\psi^{-10} \\tilde{A}^{ij}$, where quantities with a tilde are associated with a background conformal metric $\\tilde{g}_{ij}$. The problem specifies a conformally flat background, so we may take $\\tilde{g}_{ij} = \\delta_{ij}$, the Euclidean metric. The covariant derivative $\\tilde{D}_j$ becomes the ordinary partial derivative $\\partial_j$. The momentum constraint equation transforms to $\\tilde{D}_j \\tilde{A}^{ij} = 0$.\n\nThe symmetric trace-free tensor $\\tilde{A}^{ij}$ is decomposed using the York-Lichnerowicz decomposition:\n$$\n\\tilde{A}^{ij} = (\\text{LW})^{ij} + \\tilde{A}^{ij}_{\\text{TT}}\n$$\nHere, $\\tilde{A}^{ij}_{\\text{TT}}$ is the transverse-traceless part, and $(\\text{LW})^{ij}$ is the longitudinal part, generated by a vector potential $W^k$ via the operator $(\\text{LW})^{ij} = \\tilde{D}^i W^j + \\tilde{D}^j W^i - \\frac{2}{3} \\tilde{g}^{ij} \\tilde{D}_k W^k$.\nSince $\\tilde{D}_j \\tilde{A}^{ij}_{\\text{TT}} = 0$ by definition, the momentum constraint becomes $\\tilde{D}_j (\\text{LW})^{ij} = 0$. On the flat background metric $\\delta_{ij}$, this gives:\n$$\n\\partial_j \\left( \\partial^i W^j + \\partial^j W^i - \\frac{2}{3} \\delta^{ij} \\partial_k W^k \\right) = 0\n$$\n$$\n\\partial_j \\partial^i W^j + \\partial_j \\partial^j W^i - \\frac{2}{3} \\partial^i (\\partial_k W^k) = 0\n$$\nUsing the notation $\\Delta = \\partial_j \\partial^j$ for the flat-space Laplacian, this equation for the vector potential $W^i$ is:\n$$\n\\Delta W^i + \\frac{1}{3} \\partial^i (\\partial_j W^j) = 0\n$$\nIn vector notation, this is $\\Delta \\vec{W} + \\frac{1}{3} \\nabla(\\nabla \\cdot \\vec{W}) = 0$.\n\nThe problem states that $W^i$ is decomposed into a \"gradient family\" and a \"toroidal (divergence-free, purely tangential) family\". This corresponds to the Helmholtz decomposition of a vector field:\n$$\n\\vec{W} = \\nabla p + \\vec{U}\n$$\nwhere $p$ is a scalar potential and $\\vec{U}$ is a divergence-free vector field, $\\nabla \\cdot \\vec{U} = 0$. The gradient family is $\\nabla p$ and the toroidal family is $\\vec{U}$. Substituting this into the vector equation for $\\vec{W}$:\n$$\n\\Delta(\\nabla p + \\vec{U}) + \\frac{1}{3} \\nabla(\\nabla \\cdot (\\nabla p + \\vec{U})) = 0\n$$\nSince $\\nabla \\cdot \\vec{U} = 0$, the equation becomes:\n$$\n\\Delta(\\nabla p) + \\Delta \\vec{U} + \\frac{1}{3} \\nabla(\\nabla \\cdot \\nabla p) = 0\n$$\nUsing the vector identity $\\Delta(\\nabla p) = \\nabla(\\nabla^2 p)$, we have:\n$$\n\\nabla(\\nabla^2 p) + \\Delta \\vec{U} + \\frac{1}{3} \\nabla(\\nabla^2 p) = 0 \\quad \\implies \\quad \\frac{4}{3} \\nabla(\\nabla^2 p) + \\Delta \\vec{U} = 0\n$$\nThe first term is a gradient (irrotational) and the second term is divergence-free, since $\\nabla \\cdot (\\Delta \\vec{U}) = \\Delta (\\nabla \\cdot \\vec{U}) = \\Delta(0) = 0$. For their sum to be zero everywhere, each term must be zero independently. This gives two decoupled equations:\n1. $\\nabla(\\nabla^2 p) = 0 \\implies \\nabla^2 p = C$. The constant $C$ can be set to $0$ without loss of generality, resulting in the scalar Laplace equation: $\\nabla^2 p = 0$.\n2. $\\Delta \\vec{U} = 0$. This is the vector Laplace equation for the divergence-free part $\\vec{U}$.\n\nWe solve these equations on the specified spherical domain by expanding the scalar potentials in spherical harmonics. Let the scalar potential $p$ be expanded as:\n$$\np(r, \\theta, \\phi) = \\sum_{\\ell=0}^{\\infty} \\sum_{m=-\\ell}^{\\ell} p_{\\ell m}(r) Y_{\\ell m}(\\theta, \\phi)\n$$\nThe problem specifies coefficients indexed by $\\ell$, so we analyze the radial part for each $\\ell$-mode. The Laplacian in spherical coordinates is $\\nabla^2 = \\frac{1}{r^2} \\frac{\\partial}{\\partial r} (r^2 \\frac{\\partial}{\\partial r}) + \\frac{1}{r^2} \\Delta_S$, where $\\Delta_S Y_{\\ell m} = -\\ell(\\ell+1) Y_{\\ell m}$. Substituting the expansion for $p$ into $\\nabla^2 p = 0$ yields a radial Ordinary Differential Equation (ODE) for each coefficient $p_\\ell(r)$:\n$$\n\\frac{1}{r^2} \\frac{d}{dr} \\left(r^2 \\frac{d p_\\ell}{dr}\\right) - \\frac{\\ell(\\ell+1)}{r^2} p_\\ell = 0 \\quad \\implies \\quad r^2 p''_\\ell + 2r p'_\\ell - \\ell(\\ell+1) p_\\ell = 0\n$$\nThis is a standard Euler-Cauchy equation. Its general solution is $p_\\ell(r) = C_1 r^\\ell + C_2 r^{-(\\ell+1)}$.\n\nThe toroidal field $\\vec{U}$ is divergence-free and purely tangential. Such a field can be generated from a scalar potential $t$ via the relation $\\vec{U} = \\nabla \\times (\\vec{r} \\, t)$. Expanding $t$ in spherical harmonics, $t(r, \\theta, \\phi) = \\sum_{\\ell,m} t_{\\ell m}(r) Y_{\\ell m}(\\theta, \\phi)$, the vector Laplace equation $\\Delta \\vec{U} = 0$ must hold for each mode. The action of the vector Laplacian on a toroidal field of this form yields:\n$$\n\\Delta (\\nabla \\times (\\vec{r} \\, t_\\ell Y_{\\ell m})) = \\nabla \\times \\left( \\vec{r} \\left[ \\frac{1}{r^2}\\frac{d}{dr}\\left(r^2\\frac{d t_\\ell}{dr}\\right) - \\frac{\\ell(\\ell+1)}{r^2} t_\\ell \\right] Y_{\\ell m} \\right)\n$$\nFor this to be zero, the term in the square brackets must vanish. This gives the radial ODE for $t_\\ell(r)$:\n$$\nr^2 t''_\\ell + 2r t'_\\ell - \\ell(\\ell+1) t_\\ell = 0\n$$\nThis is identical to the ODE for $p_\\ell(r)$, thus it has the same general solution form: $t_\\ell(r) = D_1 r^\\ell + D_2 r^{-(\\ell+1)}$.\n\nWe now apply the boundary conditions.\nFirst, regularity at the origin ($r=0$) requires that the solutions remain finite. The term proportional to $r^{-(\\ell+1)}$ diverges as $r \\to 0$ for any $\\ell \\ge 0$. Thus, for both $p_\\ell(r)$ and $t_\\ell(r)$, the coefficient of this term must be zero ($C_2=0$, $D_2=0$). The regular solutions are:\n$$\np_\\ell(r) = C_1 r^\\ell \\quad \\text{and} \\quad t_\\ell(r) = D_1 r^\\ell\n$$\nSecond, the problem provides Dirichlet boundary conditions at the outer radius $r=R$: $p_\\ell(R) = p_R$ and $t_\\ell(R) = t_R$. We apply these to find the constants $C_1$ and $D_1$. Note that the problem text makes a conflicting statement about homogeneous boundary conditions, but the computational task and test cases unambiguously specify non-homogeneous values, which we adopt for the solution.\nFor $p_\\ell(r)$:\n$$\np_\\ell(R) = C_1 R^\\ell = p_R \\quad \\implies \\quad C_1 = p_R R^{-\\ell}\n$$\nThe solution is $p_\\ell(r) = p_R \\left(\\frac{r}{R}\\right)^\\ell$.\nFor $t_\\ell(r)$:\n$$\nt_\\ell(R) = D_1 R^\\ell = t_R \\quad \\implies \\quad D_1 = t_R R^{-\\ell}\n$$\nThe solution is $t_\\ell(r) = t_R \\left(\\frac{r}{R}\\right)^\\ell$.\n\nThe computational task is to evaluate these solutions at a specified radius $r = r_{\\text{eval}}$. The final expressions are:\n$$\np_\\ell(r_{\\text{eval}}) = p_R \\left(\\frac{r_{\\text{eval}}}{R}\\right)^\\ell\n$$\n$$\nt_\\ell(r_{\\text{eval}}) = t_R \\left(\\frac{r_{\\text{eval}}}{R}\\right)^\\ell\n$$\nThese formulae are valid for $\\ell \\in \\mathbb{N}$ (i.e., $\\ell \\ge 1$), as specified in the problem statement's context. For the case $r_{\\text{eval}}=0$ and $\\ell \\ge 1$, the result is $0$. For the case $r_{\\text{eval}}=R$, the result is $p_R$ and $t_R$ respectively. The program below implements these closed-form solutions for the provided test cases.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the radial ODEs for the scalar potentials of the ADM momentum constraint\n    vector field and evaluates the solutions at specified radii for given test cases.\n    \"\"\"\n    \n    # Test cases are given as tuples: (l, R, r_eval, p_R, t_R)\n    # l: angular momentum number\n    # R: outer radius of the spherical domain\n    # r_eval: radius at which the solution is evaluated\n    # p_R: Dirichlet boundary value at r=R for the gradient family potential\n    # t_R: Dirichlet boundary value at r=R for the toroidal family potential\n    test_cases = [\n        (1, 1.0, 0.0, 1.0, 1.0),\n        (2, 1.0, 0.5, 2.0, 3.0),\n        (3, 2.0, 1.0, 1.5, 0.4),\n        (4, 1.5, 1.5, 10.0, 2.0),\n        (10, 1.0, 0.9, 1.0, 1.0),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        l, R, r_eval, p_R, t_R = case\n        \n        # The derived analytical solutions for the radial functions p_l(r) and t_l(r) are:\n        # p_l(r) = p_R * (r / R)^l\n        # t_l(r) = t_R * (r / R)^l\n        # These solutions satisfy regularity at the origin (r=0) and the\n        # Dirichlet boundary condition at the outer radius (r=R).\n        \n        # The problem states l is in N. For l >= 1, if r_eval is 0, the result is 0.\n        # np.power handles this case correctly (0.0 ** positive_number = 0.0).\n        # It also handles the case r_eval = R, where (r_eval/R) = 1.\n        \n        if R <= 0:\n            # Radius must be positive. This case is not expected based on the problem.\n            # We can treat this as an error or handle gracefully.\n            # Assuming valid inputs as per problem statement.\n            base_ratio = 0.0\n        else:\n            base_ratio = r_eval / R\n            \n        p_eval = p_R * np.power(base_ratio, l)\n        t_eval = t_R * np.power(base_ratio, l)\n        \n        results.extend([p_eval, t_eval])\n\n    # Format the final output string as a comma-separated list in brackets.\n    # The map(str, ...) is used to handle floating point representation.\n    # The problem does not specify precision, so default float-to-string is used.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "This final practice transitions from analytical techniques to direct numerical implementation, tackling a scenario essential for simulating black holes. Here, we will solve the constraint equations on a spherical shell domain bounded by a black hole's apparent horizon on the inside and a finite approximation of infinity on the outside . You will implement a finite-difference scheme and apply physically-motivated mixed boundary conditions, gaining hands-on experience in constructing quasi-equilibrium initial data, a critical step for modern gravitational wave simulations.",
            "id": "3486554",
            "problem": "You are to design and implement a program that numerically solves a simplified model of the elliptic constraint equations encountered in General Relativity (GR) initial data construction for black holes under quasi-equilibrium conditions and mixed inner boundary conditions at apparent horizons. The target mathematical model is strictly one-dimensional, spherically symmetric, and dimensionless, with all quantities treated as pure numbers without units.\n\nStart from the conformal decomposition of the spatial metric and the vacuum Hamiltonian constraint and momentum constraint, invoking a time-symmetric initial slice and spherical symmetry. Use the following foundational facts as your base: (i) in a time-symmetric vacuum slice, the extrinsic curvature vanishes, and the vacuum Hamiltonian constraint reduces to a homogeneous linear elliptic equation for the conformal factor, and (ii) in spherical symmetry, the flat-space Laplacian acting on a radially dependent scalar reduces to a radial operator. Avoid assuming any pre-derived discretization expressions or solution formulas; your derivation must follow from these principles.\n\nConsider a spherical shell domain with radius $r \\in [R_{\\mathrm{h}}, R_{\\max}]$, where $R_{\\mathrm{h}} > 0$ is a prescribed inner boundary representing an Apparent Horizon (AH), and $R_{\\max} > R_{\\mathrm{h}}$ is a finite outer boundary approximating spatial infinity. Let $\\psi(r)$ denote the conformal factor and $\\beta^r(r)$ the radial component of the shift vector. Assume a conformally flat background and time symmetry, so that the vacuum Hamiltonian constraint reduces to a homogeneous elliptic equation for $\\psi(r)$, and assume a homogeneous elliptic equation for $\\beta^r(r)$ in spherical symmetry consistent with the vanishing of sources and torques in a non-rotating, spherically symmetric quasi-equilibrium configuration.\n\nImpose the following boundary conditions:\n- Inner boundary at $r = R_{\\mathrm{h}}$:\n  - For the conformal factor $\\psi(r)$, enforce a quasi-equilibrium Apparent Horizon (AH) condition in the form of a Robin boundary condition consistent with an isolated isometry throat in spherical symmetry: $r \\,\\partial_r \\psi + \\psi = 0$ at $r = R_{\\mathrm{h}}$.\n  - For the shift component $\\beta^r(r)$, enforce a Neumann condition that represents no normal coordinate motion of the AH: $\\partial_r \\beta^r = 0$ at $r = R_{\\mathrm{h}}$.\n- Outer boundary at $r = R_{\\max}$:\n  - Asymptotic flatness for the conformal factor: $\\psi(R_{\\max}) = 1$.\n  - Vanishing shift in an inertial frame: $\\beta^r(R_{\\max}) = 0$.\n\nTasks:\n1. Derive, from the divergence form of the Laplacian in spherical symmetry, the one-dimensional operator that acts on any radially dependent function $u(r)$, and write the homogeneous elliptic equations satisfied by $\\psi(r)$ and $\\beta^r(r)$ in the domain $r \\in (R_{\\mathrm{h}}, R_{\\max})$.\n2. Derive a second-order finite difference scheme on a uniform grid of $N+1$ nodes, with $N \\in \\mathbb{N}$, covering the interval $[R_{\\mathrm{h}}, R_{\\max}]$. Ensure that your interior stencil is second-order accurate and that you consistently and stably enforce the mixed inner boundary conditions (Robin for $\\psi$, Neumann for $\\beta^r$) and the outer Dirichlet conditions (for both fields). Your implementation must assemble and solve the resulting linear systems for $\\psi$ and $\\beta^r$.\n3. For $\\psi(r)$, derive the analytic solution in spherical symmetry to the corresponding homogeneous elliptic equation with the given mixed boundary conditions. Use this analytic solution as a reference to quantify a maximum-norm relative error across the grid.\n4. Define the following diagnostic measures to evaluate quasi-equilibrium enforcement and solution quality:\n   - $E_{\\psi}^{\\infty}$: the maximum relative error of $\\psi$ with respect to the derived analytic solution over all grid nodes, computed as the maximum over $i$ of $\\left|\\psi_{\\mathrm{num}}(r_i) - \\psi_{\\mathrm{ref}}(r_i)\\right|$ divided by the maximum over $i$ of $\\left|\\psi_{\\mathrm{ref}}(r_i)\\right|$.\n   - $R_{\\psi}^{\\infty}$: the maximum absolute value over interior nodes of the discrete elliptic operator applied to $\\psi_{\\mathrm{num}}$, i.e., the discrete residual in the interior.\n   - $B_{\\psi}$: the absolute value of the discrete inner boundary residual $R_{\\mathrm{h}} \\,(\\partial_r \\psi)_{\\mathrm{disc}} + \\psi$ evaluated at $r = R_{\\mathrm{h}}$.\n   - $R_{\\beta}^{\\infty}$: the maximum absolute value over interior nodes of the discrete elliptic operator applied to $\\beta^r_{\\mathrm{num}}$.\n   - $B_{\\beta}$: the absolute value of the discrete inner boundary residual $(\\partial_r \\beta^r)_{\\mathrm{disc}}$ evaluated at $r = R_{\\mathrm{h}}$.\n5. For each test case below, compute a single scalar quality score $q$ defined by $q = \\max\\{ E_{\\psi}^{\\infty}, R_{\\psi}^{\\infty}, B_{\\psi}, R_{\\beta}^{\\infty}, B_{\\beta} \\}$. Your program must output these quality scores for the specified test suite as a single line.\n\nAll computations are dimensionless. Angles do not appear. Express all final numerical outputs as floating-point numbers without units.\n\nTest suite:\n- Case $1$: $R_{\\mathrm{h}} = 2$, $R_{\\max} = 10$, $N = 200$.\n- Case $2$: $R_{\\mathrm{h}} = 2$, $R_{\\max} = 10$, $N = 40$.\n- Case $3$: $R_{\\mathrm{h}} = 9$, $R_{\\max} = 10$, $N = 200$.\n- Case $4$: $R_{\\mathrm{h}} = 0.5$, $R_{\\max} = 5$, $N = 200$.\n\nFinal output format requirement:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the test cases, i.e., $[q_1, q_2, q_3, q_4]$.\n\nYour submission must be a complete, runnable program that implements the above, without requiring any user input or external files, and must strictly follow the final output format.",
            "solution": "The user has provided a valid, well-posed problem in computational physics, specifically concerning the numerical solution of simplified elliptic constraint equations in general relativity. The problem is scientifically grounded, objective, and contains all necessary information to proceed with a unique solution.\n\n### 1. Governing Equations and Analytic Solutions\n\nThe problem requires solving homogeneous elliptic equations for the conformal factor $\\psi(r)$ and the radial shift vector component $\\beta^r(r)$ in a spherically symmetric, one-dimensional domain $r \\in [R_{\\mathrm{h}}, R_{\\max}]$. The appropriate operator is the Laplacian in spherical coordinates acting on a purely radial function $u(r)$. Starting from the divergence form, $\\nabla^2 u = \\vec{\\nabla} \\cdot (\\vec{\\nabla} u)$, we note that for $u(r)$, the gradient is $\\vec{\\nabla} u = \\frac{du}{dr} \\hat{r}$. The divergence of this vector field is $\\vec{\\nabla} \\cdot (\\frac{du}{dr} \\hat{r}) = \\frac{1}{r^2} \\frac{d}{dr}(r^2 \\frac{du}{dr})$. Expanding this gives the operator:\n$$\n\\nabla^2 u(r) = \\frac{d^2 u}{dr^2} + \\frac{2}{r} \\frac{du}{dr}\n$$\nThe governing equations for both fields are instances of Laplace's equation, $\\nabla^2 u = 0$:\n$$\n\\frac{d^2 \\psi}{dr^2} + \\frac{2}{r} \\frac{d \\psi}{dr} = 0\n$$\n$$\n\\frac{d^2 \\beta^r}{dr^2} + \\frac{2}{r} \\frac{d \\beta^r}{dr} = 0\n$$\nThese are Cauchy-Euler ordinary differential equations. The general solution is of the form $u(r) = A + B/r$, where $A$ and $B$ are constants determined by boundary conditions.\n\n**Analytic Solution for $\\psi(r)$:**\nThe boundary conditions are $\\psi(R_{\\max}) = 1$ and the Robin condition $r \\frac{d\\psi}{dr} + \\psi = 0$ at $r=R_{\\mathrm{h}}$.\nApplying the Robin condition to the general form $\\psi(r) = A + B/r$ (with derivative $\\frac{d\\psi}{dr} = -B/r^2$):\n$$\nR_{\\mathrm{h}} \\left(-\\frac{B}{R_{\\mathrm{h}}^2}\\right) + \\left(A + \\frac{B}{R_{\\mathrm{h}}}\\right) = 0 \\implies -\\frac{B}{R_{\\mathrm{h}}} + A + \\frac{B}{R_{\\mathrm{h}}} = 0 \\implies A = 0\n$$\nThe solution must be of the form $\\psi(r) = B/r$. Applying the outer Dirichlet condition:\n$$\n\\psi(R_{\\max}) = \\frac{B}{R_{\\max}} = 1 \\implies B = R_{\\max}\n$$\nThus, the analytic reference solution is $\\psi_{\\mathrm{ref}}(r) = R_{\\max}/r$.\n\n**Analytic Solution for $\\beta^r(r)$:**\nThe boundary conditions are $\\beta^r(R_{\\max}) = 0$ and the Neumann condition $\\frac{d\\beta^r}{dr} = 0$ at $r=R_{\\mathrm{h}}$.\nApplying the Neumann condition to the general form $\\beta^r(r) = C + D/r$:\n$$\n\\frac{d\\beta^r}{dr}\\bigg|_{r=R_{\\mathrm{h}}} = -\\frac{D}{R_{\\mathrm{h}}^2} = 0 \\implies D = 0\n$$\nThe solution must be of the form $\\beta^r(r) = C$. Applying the outer Dirichlet condition:\n$$\n\\beta^r(R_{\\max}) = C = 0 \\implies C = 0\n$$\nThus, the analytic solution is the trivial solution $\\beta^r(r) = 0$.\n\n### 2. Finite Difference Discretization\nWe discretize the domain $[R_{\\mathrm{h}}, R_{\\max}]$ using $N+1$ uniformly spaced nodes $r_i = R_{\\mathrm{h}} + i \\cdot \\Delta r$ for $i=0, 1, \\dots, N$, where the grid spacing is $\\Delta r = (R_{\\max} - R_{\\mathrm{h}})/N$. Let $u_i$ denote the numerical approximation of $u(r_i)$.\n\n**Interior Stencil:** For interior nodes $i=1, \\dots, N-1$, we use second-order central differences for the derivatives:\n$$\n\\frac{d u}{d r}\\bigg|_{r_i} \\approx \\frac{u_{i+1} - u_{i-1}}{2\\Delta r}, \\quad \\frac{d^2 u}{d r^2}\\bigg|_{r_i} \\approx \\frac{u_{i+1} - 2u_i + u_{i-1}}{(\\Delta r)^2}\n$$\nSubstituting these into the governing equation $u'' + (2/r)u' = 0$ gives the discrete equation for each interior node:\n$$\n\\left(1 - \\frac{\\Delta r}{r_i}\\right)u_{i-1} - 2u_i + \\left(1 + \\frac{\\Delta r}{r_i}\\right)u_{i+1} = 0\n$$\n\n**Boundary Conditions:**\nThe unknowns are the values $u_0, u_1, \\dots, u_{N-1}$. The value $u_N$ is fixed by the outer boundary condition. This results in a linear system of $N$ equations for $N$ unknowns.\n\n- **Outer Boundary ($r_N = R_{\\max}$):** The Dirichlet conditions are enforced exactly:\n  - $\\psi_N = 1$\n  - $\\beta^r_N = 0$\n  These values are not unknowns; they are incorporated into the right-hand side of the linear system for the equation at node $i=N-1$.\n\n- **Inner Boundary for $\\psi$ ($r_0 = R_{\\mathrm{h}}$):** The Robin condition $r\\psi' + \\psi = 0$ is discretized using a second-order accurate one-sided finite difference for the derivative $\\psi'(r_0)$:\n  $$\n  \\psi'(r_0) \\approx \\frac{-3\\psi_0 + 4\\psi_1 - \\psi_2}{2\\Delta r}\n  $$\n  Substituting this into the Robin condition gives the first equation of the linear system for $\\psi$:\n  $$\n  R_{\\mathrm{h}}\\left(\\frac{-3\\psi_0 + 4\\psi_1 - \\psi_2}{2\\Delta r}\\right) + \\psi_0 = 0 \\implies (-3R_{\\mathrm{h}} + 2\\Delta r)\\psi_0 + (4R_{\\mathrm{h}})\\psi_1 - R_{\\mathrm{h}}\\psi_2 = 0\n  $$\n\n- **Inner Boundary for $\\beta^r$ ($r_0 = R_{\\mathrm{h}}$):** The Neumann condition $(\\beta^r)'=0$ is discretized using the ghost point method to maintain second-order accuracy. We introduce a ghost point at $r_{-1} = r_0 - \\Delta r$ and enforce both the boundary condition and the governing PDE at $r_0$.\n  1. Central difference for BC: $\\frac{\\beta^r_1 - \\beta^r_{-1}}{2\\Delta r} = 0 \\implies \\beta^r_{-1} = \\beta^r_1$.\n  2. PDE at $r_0$: $(\\beta^r)'' + \\frac{2}{r_0}(\\beta^r)' = 0$. Using central differences, this relates $\\beta^r_{-1}, \\beta^r_0, \\beta^r_1$.\n  Substituting $\\beta^r_{-1} = \\beta^r_1$ into the discretized PDE at $r_0$ simplifies to:\n  $$\n  \\beta^r_0 - \\beta^r_1 = 0\n  $$\n  This provides the first equation for the $\\beta^r$ system. Although it appears first-order, it arises from a second-order accurate procedure.\n\n### 3. Linear Systems and Diagnostics\n\nFor each field, $\\psi$ and $\\beta^r$, we assemble an $N \\times N$ linear system $A\\mathbf{u} = \\mathbf{b}$, which is then solved for the vector of unknowns $\\mathbf{u} = [u_0, \\dots, u_{N-1}]^T$. The matrices $A$ are nearly tridiagonal.\n\nThe quality of the numerical solutions $\\psi_{\\mathrm{num}}$ and $\\beta^r_{\\mathrm{num}}$ is assessed using five diagnostic measures:\n\n1.  $E_{\\psi}^{\\infty}$: The maximum-norm relative error of $\\psi$, comparing the numerical solution $\\psi_{\\mathrm{num}}$ to the analytic reference $\\psi_{\\mathrm{ref}}(r_i) = R_{\\max}/r_i$.\n    $$\n    E_{\\psi}^{\\infty} = \\frac{\\max_i |\\psi_{\\mathrm{num}}(r_i) - \\psi_{\\mathrm{ref}}(r_i)|}{\\max_i |\\psi_{\\mathrm{ref}}(r_i)|}\n    $$\n2.  $R_{\\psi}^{\\infty}$: The maximum absolute residual of the discrete elliptic operator in the interior of the domain, a measure of how well the numerical solution satisfies the governing equation.\n    $$\n    R_{\\psi}^{\\infty} = \\max_{i=1,\\dots,N-1} \\left| \\frac{1}{(\\Delta r)^2} \\left[ \\left(1 - \\frac{\\Delta r}{r_i}\\right)\\psi_{\\mathrm{num},i-1} - 2\\psi_{\\mathrm{num},i} + \\left(1 + \\frac{\\Delta r}{r_i}\\right)\\psi_{\\mathrm{num},i+1} \\right] \\right|\n    $$\n3.  $B_{\\psi}$: The absolute residual of the Robin boundary condition at the inner boundary, evaluated using a consistent second-order one-sided derivative.\n    $$\n    B_{\\psi} = \\left| R_{\\mathrm{h}} \\left(\\frac{-3\\psi_{\\mathrm{num},0} + 4\\psi_{\\mathrm{num},1} - \\psi_{\\mathrm{num},2}}{2 \\Delta r}\\right) + \\psi_{\\mathrm{num},0} \\right|\n    $$\n4.  $R_{\\beta}^{\\infty}$: The maximum absolute interior residual for $\\beta^r$, analogous to $R_{\\psi}^{\\infty}$.\n5.  $B_{\\beta}$: The absolute residual of the Neumann boundary condition at the inner boundary, evaluated using the same second-order one-sided derivative for consistency.\n    $$\n    B_{\\beta} = \\left| \\frac{-3\\beta^r_{\\mathrm{num},0} + 4\\beta^r_{\\mathrm{num},1} - \\beta^r_{\\mathrm{num},2}}{2 \\Delta r} \\right|\n    $$\nFinally, for each test case, a single quality score $q$ is computed as the maximum of these five diagnostic values:\n$$\nq = \\max\\{ E_{\\psi}^{\\infty}, R_{\\psi}^{\\infty}, B_{\\psi}, R_{\\beta}^{\\infty}, B_{\\beta} \\}\n$$",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve_system_and_get_q(Rh, Rmax, N):\n    \"\"\"\n    Solves the 1D elliptic equations for psi and beta_r and computes the quality score q.\n    \"\"\"\n    # 1. Setup grid\n    delta_r = (Rmax - Rh) / N\n    # r is a grid of N+1 nodes from Rh to Rmax\n    r = np.linspace(Rh, Rmax, N + 1)\n    \n    # 2. Solve for psi\n    # We solve for N unknowns: psi_0 to psi_{N-1}. psi_N is known.\n    # We construct and solve the linear system A_psi * x = b_psi.\n    A_psi = np.zeros((N, N))\n    b_psi = np.zeros(N)\n    \n    psi_N = 1.0\n\n    # The problem constraints ensure N is large enough (>= 40), so N > 2.\n    # Row 0: Inner Robin BC for psi (using 2nd-order one-sided derivative)\n    # (-3*Rh + 2*delta_r)*psi_0 + (4*Rh)*psi_1 - Rh*psi_2 = 0\n    A_psi[0, 0] = -3 * Rh + 2 * delta_r\n    A_psi[0, 1] = 4 * Rh\n    A_psi[0, 2] = -Rh\n    # b_psi[0] is 0\n    \n    # Rows 1 to N-2: Interior points\n    for i in range(1, N - 1):\n        ri = r[i]\n        A_psi[i, i - 1] = 1.0 - delta_r / ri\n        A_psi[i, i] = -2.0\n        A_psi[i, i + 1] = 1.0 + delta_r / ri\n        # b_psi[i] is 0\n        \n    # Row N-1: Interior point adjacent to outer boundary\n    r_nm1 = r[N - 1]\n    A_psi[N - 1, N - 2] = 1.0 - delta_r / r_nm1\n    A_psi[N - 1, N - 1] = -2.0\n    b_psi[N - 1] = -(1.0 + delta_r / r_nm1) * psi_N\n    \n    psi_sol = np.linalg.solve(A_psi, b_psi)\n    psi_num = np.append(psi_sol, psi_N)\n\n    # 3. Solve for beta_r\n    # We solve for N unknowns: beta_0 to beta_{N-1}. beta_N is known.\n    A_beta = np.zeros((N, N))\n    b_beta = np.zeros(N) # b_beta is entirely zeros\n\n    beta_N = 0.0\n    \n    # Row 0: Inner Neumann BC for beta (from 2nd-order ghost point method)\n    # beta_0 - beta_1 = 0\n    A_beta[0, 0] = 1.0\n    A_beta[0, 1] = -1.0\n    \n    # Rows 1 to N-2: Interior points\n    for i in range(1, N - 1):\n        ri = r[i]\n        A_beta[i, i - 1] = 1.0 - delta_r / ri\n        A_beta[i, i] = -2.0\n        A_beta[i, i + 1] = 1.0 + delta_r / ri\n\n    # Row N-1: Interior point adjacent to outer boundary\n    r_nm1 = r[N - 1]\n    A_beta[N - 1, N - 2] = 1.0 - delta_r / r_nm1\n    A_beta[N - 1, N - 1] = -2.0\n    # b_beta[N-1] is -(1.0 + delta_r/r_nm1) * beta_N = 0\n    \n    beta_sol = np.linalg.solve(A_beta, b_beta)\n    beta_num = np.append(beta_sol, beta_N)\n    \n    # 4. Calculate diagnostic measures\n    # Analytic solution for psi\n    psi_ref = Rmax / r\n    \n    # E_psi_inf: Max-norm relative error for psi\n    E_psi_inf_num = np.max(np.abs(psi_num - psi_ref))\n    E_psi_inf_den = np.max(np.abs(psi_ref)) # This is psi_ref[0] = Rmax/Rh\n    E_psi_inf = E_psi_inf_num / E_psi_inf_den\n\n    # R_psi_inf: Max absolute interior residual for psi\n    residuals_psi = []\n    for i in range(1, N): # Interior nodes are from r_1 to r_{N-1}\n        ri = r[i]\n        op_val = (1.0 / (delta_r**2)) * \\\n                 ((1.0 - delta_r / ri) * psi_num[i - 1] - 2.0 * psi_num[i] + (1.0 + delta_r / ri) * psi_num[i + 1])\n        residuals_psi.append(np.abs(op_val))\n    R_psi_inf = np.max(residuals_psi) if residuals_psi else 0.0\n\n    # B_psi: Absolute inner boundary residual for psi\n    d_psi_dr_0 = (-3*psi_num[0] + 4*psi_num[1] - psi_num[2]) / (2.0 * delta_r)\n    B_psi = np.abs(Rh * d_psi_dr_0 + psi_num[0])\n    \n    # R_beta_inf: Max absolute interior residual for beta_r\n    residuals_beta = []\n    for i in range(1, N):\n        ri = r[i]\n        op_val = (1.0 / (delta_r**2)) * \\\n                 ((1.0 - delta_r / ri) * beta_num[i - 1] - 2.0 * beta_num[i] + (1.0 + delta_r / ri) * beta_num[i + 1])\n        residuals_beta.append(np.abs(op_val))\n    R_beta_inf = np.max(residuals_beta) if residuals_beta else 0.0\n    \n    # B_beta: Absolute inner boundary residual for beta_r\n    d_beta_dr_0 = (-3*beta_num[0] + 4*beta_num[1] - beta_num[2]) / (2.0 * delta_r)\n    B_beta = np.abs(d_beta_dr_0)\n    \n    # 5. Compute quality score q\n    q = np.max([E_psi_inf, R_psi_inf, B_psi, R_beta_inf, B_beta])\n    \n    return q\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (Rh, Rmax, N)\n        (2.0, 10.0, 200),\n        (2.0, 10.0, 40),\n        (9.0, 10.0, 200),\n        (0.5, 5.0, 200),\n    ]\n\n    results = []\n    for case in test_cases:\n        Rh, Rmax, N = case\n        q = solve_system_and_get_q(Rh, Rmax, int(N))\n        results.append(q)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}