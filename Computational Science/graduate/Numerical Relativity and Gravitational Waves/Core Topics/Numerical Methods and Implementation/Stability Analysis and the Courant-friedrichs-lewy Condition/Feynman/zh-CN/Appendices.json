{
    "hands_on_practices": [
        {
            "introduction": "本练习是数值稳定性分析的基石。我们将通过分析一个用于模拟线性化引力波的简单波动方程的数值格式，来深入理解稳定性。通过构建离散色散关系，您将学习如何量化数值耗散和相位误差等数值误差，并为一个高阶格式确定最大稳定时间步长，这是开发可靠数值代码的一项关键技能 ()。",
            "id": "3487872",
            "problem": "考虑横向无迹规范下的线性化引力波，其中度规微扰 $h(t,x)$ 的每个独立分量都满足标量波动方程 $\\partial_{t}^{2} h = c^{2} \\partial_{x}^{2} h$，波速为 $c$。使用六阶精度的中心有限差分近似对空间二阶导数在间距为 $\\Delta x$ 的均匀网格上进行空间离散化，\n$$\n\\partial_{x}^{2} h(x_{j}) \\approx \\frac{1}{180 \\Delta x^{2}}\\left[2 h_{j-3} - 27 h_{j-2} + 270 h_{j-1} - 490 h_{j} + 270 h_{j+1} - 27 h_{j+2} + 2 h_{j+3}\\right].\n$$\n通过引入 $\\pi = \\partial_{t} h$，将时间上二阶的波动方程降为一阶系统，使得 $\\partial_{t} h = \\pi$ 和 $\\partial_{t} \\pi = c^{2} \\partial_{x}^{2} h$。使用应用于“线方法”常微分方程系统的显式三阶强稳定性保持 Runge-Kutta 方法（SSP Runge-Kutta of order three，简写为 RK3）对此半离散系统进行时间推进。对于平面波拟设 $h_{j}(t) = \\Re\\{\\hat{h}(t) \\exp(i \\kappa j \\Delta x)\\}$，构建将离散角频率与空间波数联系起来的全离散色散关系。\n\n然后，确定满足以下条件的最大时间步长 $\\Delta t$：\n1) 对于最高可分辨波数，时间积分器严格阻尼网格奈奎斯特波数处的寄生模式，即单步放大因子的模长严格小于1。\n2) 对于所有每个波长至少有四个采样点的模式（即无量纲波数 $\\theta = \\kappa \\Delta x \\leq \\pi/2$），仅由时间离散化引起的相对相速度误差的大小不超过 $0.05$（百分之五），其中离散相位由在虚轴上求值的 Runge-Kutta 稳定性函数的辐角定义。\n\n假设使用相对论单位，令 $c = 1$。将最大 $\\Delta t$ 的最终答案表示为乘以 $\\Delta x/c$ 的单个数值系数，并将该系数四舍五入到四位有效数字。",
            "solution": "首先验证问题，发现其具有科学依据、是适定且客观的。这是偏微分方程数值分析中的一个标准问题。\n\n问题要求在使用特定的有限差分和时间积分格式离散化的一维标量波动方程的稳定和精确数值演化中，找到最大的时间步长 $\\Delta t$。两个约束条件分别涉及最高波数处的稳定性和良好分辨波的相精度。\n\n我们首先分析半离散系统。波动方程为 $\\partial_{t}^{2} h = c^{2} \\partial_{x}^{2} h$。通过引入辅助变量 $\\pi = \\partial_{t} h$，可将其降为一阶系统。\n$$\n\\begin{cases}\n\\partial_{t} h = \\pi \\\\\n\\partial_{t} \\pi = c^{2} \\partial_{x}^{2} h\n\\end{cases}\n$$\n在线方法中，我们首先对空间导数进行离散化。令 $h_j(t) \\approx h(t, x_j)$，其中 $x_j = j \\Delta x$。空间二阶导数由给定的六阶精度有限差分算子近似，我们将其表示为 $D_{xx}$。半离散常微分方程组 (ODE) 为：\n$$\n\\begin{cases}\n\\frac{d h_j}{dt} = \\pi_j \\\\\n\\frac{d \\pi_j}{dt} = c^{2} D_{xx} [h_j]\n\\end{cases}\n$$\n其中 $D_{xx}[h_j] = \\frac{1}{180 \\Delta x^{2}}\\left[2 h_{j-3} - 27 h_{j-2} + 270 h_{j-1} - 490 h_{j} + 270 h_{j+1} - 27 h_{j+2} + 2 h_{j+3}\\right]$。\n\n为了分析稳定性和色散性质，我们对解使用平面波 (von Neumann) 拟设：\n$$\nh_j(t) = \\hat{h}(t) e^{i \\kappa x_j} = \\hat{h}(t) e^{i \\kappa j \\Delta x}\n$$\n$$\n\\pi_j(t) = \\hat{\\pi}(t) e^{i \\kappa x_j} = \\hat{\\pi}(t) e^{i \\kappa j \\Delta x}\n$$\n其中 $\\kappa$ 是波数。令 $\\theta = \\kappa \\Delta x$ 为无量纲波数。将空间差分算子 $D_{xx}$ 应用于该拟设：\n$$\nD_{xx} [e^{i \\kappa j \\Delta x}] = \\frac{e^{i \\kappa j \\Delta x}}{180 \\Delta x^{2}}\\left[2 e^{-i3\\theta} - 27 e^{-i2\\theta} + 270 e^{-i\\theta} - 490 + 270 e^{i\\theta} - 27 e^{i2\\theta} + 2 e^{i3\\theta}\\right]\n$$\n使用恒等式 $e^{i\\phi} + e^{-i\\phi} = 2\\cos(\\phi)$，上式可化简为：\n$$\nD_{xx} [e^{i \\kappa j \\Delta x}] = \\frac{e^{i \\kappa j \\Delta x}}{\\Delta x^{2}} \\left( \\frac{4\\cos(3\\theta) - 54\\cos(2\\theta) + 540\\cos(\\theta) - 490}{180} \\right)\n$$\n空间算子对平面波的作用是乘以一个因子，这个因子就是该算子的符号。关于振幅 $\\hat{h}(t)$ 和 $\\hat{\\pi}(t)$ 的常微分方程组变为：\n$$\n\\frac{d}{dt} \\begin{pmatrix} \\hat{h} \\\\ \\hat{\\pi} \\end{pmatrix} = \\begin{pmatrix} 0 & 1 \\\\ \\frac{c^2}{\\Delta x^2} \\frac{S(\\theta)}{180} & 0 \\end{pmatrix} \\begin{pmatrix} \\hat{h} \\\\ \\hat{\\pi} \\end{pmatrix}\n$$\n其中 $S(\\theta) = 4\\cos(3\\theta) - 54\\cos(2\\theta) + 540\\cos(\\theta) - 490$。矩阵的特征值 $\\lambda$ 由 $\\lambda^2 - \\frac{c^2 S(\\theta)}{180 \\Delta x^2} = 0$ 给出。对于一个稳定的模板，$S(\\theta) \\le 0$ 对 $\\theta \\in [0, \\pi]$ 成立，因此特征值是纯虚数：$\\lambda = \\pm i \\omega_{\\text{num}}(\\kappa)$，其中 $\\omega_{\\text{num}}(\\kappa)$ 是半离散角频率。\n$$\n\\omega_{\\text{num}}(\\kappa) = \\sqrt{-\\frac{c^2 S(\\theta)}{180 \\Delta x^2}} = \\frac{c}{\\Delta x} \\sqrt{-\\frac{S(\\theta)}{180}}\n$$\n我们定义一个无量纲频率函数 $q(\\theta) = \\sqrt{-S(\\theta)/180}$，因此 $\\omega_{\\text{num}} = \\frac{c}{\\Delta x} q(\\theta)$。\n\n该系统使用三阶强稳定性保持 Runge-Kutta (SSP-RK3) 方法进行时间推进。对于常微分方程 $\\frac{dy}{dt} = \\mathcal{L}y$，更新公式为 $y^{n+1} = G(\\Delta t \\mathcal{L}) y^n$，其中 $G(z)$ 是该方法的稳定性多项式。对于 RK3，这是 $\\exp(z)$ 的三阶泰勒展开式：\n$$\nG(z) = 1 + z + \\frac{z^2}{2} + \\frac{z^3}{6}\n$$\n稳定性多项式的自变量是 $z = \\lambda \\Delta t$。根据题目要求设置 $c=1$，并定义库朗数 $\\nu = \\frac{\\Delta t}{\\Delta x}$（通常 $\\nu = c\\Delta t/\\Delta x$，但这里 $c=1$），我们有：\n$$\nz = \\pm i \\omega_{\\text{num}} \\Delta t = \\pm i \\frac{1}{\\Delta x} q(\\theta) (\\nu \\Delta x) = \\pm i \\nu q(\\theta)\n$$\n单步放大因子为 $g = G(\\pm i \\nu q(\\theta))$。其模的平方为：\n$$\n|g|^2 = |G(i\\nu q(\\theta))|^2 = \\left| \\left(1 - \\frac{(\\nu q)^2}{2}\\right) + i\\left(\\nu q - \\frac{(\\nu q)^3}{6}\\right) \\right|^2 = 1 - \\frac{(\\nu q)^4}{12} + \\frac{(\\nu q)^6}{36}\n$$\n\n现在我们应用这两个约束条件。\n\n**约束1：奈奎斯特波数处的阻尼**\n奈奎斯特波数对应于网格上可分辨的最短波长，$\\lambda_{\\min} = 2\\Delta x$，这意味着 $\\kappa = \\pi/\\Delta x$ 且 $\\theta = \\pi$。问题要求这些寄生模式被严格阻尼，即 $|g(\\pi)|  1$。\n使用 $|g|^2$ 的表达式：\n$$\n|g|^2  1 \\implies 1 - \\frac{(\\nu q(\\pi))^4}{12} + \\frac{(\\nu q(\\pi))^6}{36}  1 \\implies \\frac{(\\nu q(\\pi))^4}{36} \\left( (\\nu q(\\pi))^2 - 3 \\right)  0\n$$\n由于 $\\nu > 0$ 且 $q(\\pi) \\neq 0$，这要求 $(\\nu q(\\pi))^2  3$，或 $\\nu q(\\pi)  \\sqrt{3}$。\n我们必须计算 $q(\\pi)$。在 $\\theta = \\pi$ 处，$\\cos(\\pi)=-1$, $\\cos(2\\pi)=1$, $\\cos(3\\pi)=-1$。\n$$\nS(\\pi) = 4(-1) - 54(1) + 540(-1) - 490 = -4 - 54 - 540 - 490 = -1088\n$$\n因此，$q(\\pi) = \\sqrt{-(-1088)/180} = \\sqrt{1088/180} = \\sqrt{272/45}$。\n条件变为 $\\nu \\sqrt{272/45}  \\sqrt{3}$，这给出：\n$$\n\\nu  \\sqrt{3 \\times \\frac{45}{272}} = \\sqrt{\\frac{135}{272}} \\approx 0.70450\n$$\n问题要求的是最大的 $\\Delta t$。这对应于 $\\nu$ 允许值的上确界，即稳定性极限 $\\nu_{\\text{lim},1} = \\sqrt{135/272}$。\n\n**约束2：相速度误差**\n该约束适用于每个波长至少有四个采样点的模式，即 $\\lambda \\ge 4\\Delta x$。这对应于波数 $\\kappa \\le \\frac{2\\pi}{4\\Delta x} = \\frac{\\pi}{2\\Delta x}$，所以 $\\theta = \\kappa \\Delta x \\le \\pi/2$。\n\n由时间离散化引起的相对相速度误差是全离散相移和半离散相移之间的相对误差。在 $\\Delta t$ 内的半离散相移是 $\\omega_{\\text{num}}\\Delta t = q(\\theta) \\nu$。全离散相移是 $|\\arg(g)| = |\\arg(G(i\\nu q(\\theta)))|$。\n相对相位误差是 $\\epsilon_p = \\frac{|\\arg(G(iX))|}{X} - 1$，其中 $X = \\nu q(\\theta)$。\n$$\n\\epsilon_p(X) = \\frac{1}{X} \\arctan\\left(\\frac{X - X^3/6}{1 - X^2/2}\\right) - 1\n$$\n我们要求对于所有的 $\\theta \\in [0, \\pi/2]$，都有 $|\\epsilon_p(X)| \\le 0.05$。该误差的领头阶泰勒展开是 $ \\epsilon_p(X) \\approx X^4/30$。为了找到最大误差，我们必须找到 $X = \\nu q(\\theta)$ 在 $\\theta \\in [0, \\pi/2]$ 上的最大值。这需要找到 $q(\\theta)$ 在此区间内的最大值。\n$q(\\theta)^2 = -S(\\theta)/180$ 的导数是：\n$$\n\\frac{d}{d\\theta}q(\\theta)^2 = -\\frac{1}{180} \\frac{d S(\\theta)}{d\\theta} = -\\frac{1}{180}(-12\\sin(3\\theta) + 108\\sin(2\\theta)-540\\sin\\theta) = \\frac{\\sin\\theta}{15}(4\\cos^2\\theta - 18\\cos\\theta + 44)\n$$\n二次项 $4u^2 - 18u + 44$（其中 $u=\\cos\\theta$）的判别式为 $\\Delta = (-18)^2 - 4(4)(44) = 324 - 704  0$，所以它没有实根且恒为正。由于对于 $\\theta \\in (0, \\pi/2]$，$\\sin\\theta > 0$，因此导数是正的。因此，$q(\\theta)$ 在 $[0, \\pi/2]$ 上是单调递增的。\n$q(\\theta)$ 在此区间上的最大值出现在 $\\theta=\\pi/2$ 处。\n在 $\\theta=\\pi/2$ 处：$\\cos(\\pi/2)=0$，$\\cos(\\pi)=-1$，$\\cos(3\\pi/2)=0$。\n$$\nS(\\pi/2) = 4(0) - 54(-1) + 540(0) - 490 = 54 - 490 = -436\n$$\n$q(\\pi/2) = \\sqrt{-(-436)/180} = \\sqrt{436/180} = \\sqrt{109/45}$。\n$X$ 的最大值是 $X_{\\max} = \\nu q(\\pi/2) = \\nu\\sqrt{109/45}$。相位误差约束变为 $|\\epsilon_p(X_{\\max})| \\le 0.05$。我们需要求解 $\\epsilon_p(X_{crit}) = 0.05$ 以得到 $X_{crit}$。\n$$\n\\frac{1}{X_{crit}} \\arctan\\left(\\frac{X_{crit} - X_{crit}^3/6}{1 - X_{crit}^2/2}\\right) - 1 = 0.05\n$$\n这是一个关于 $X_{crit}$ 的超越方程。数值解给出 $X_{crit} \\approx 1.138$。\n因此，约束条件为 $X_{\\max} \\le X_{crit}$，这转化为：\n$$\n\\nu \\sqrt{\\frac{109}{45}} \\le 1.138 \\implies \\nu \\le \\frac{1.138}{\\sqrt{109/45}} \\approx \\frac{1.138}{1.5563} \\approx 0.7312\n$$\n所以第二个约束给出的上限为 $\\nu_{\\text{lim},2} \\approx 0.7312$。\n\n**结论**\n为了同时满足两个约束条件，我们必须取两个上限中较小的一个：\n$$\n\\nu_{\\max} = \\min(\\nu_{\\text{lim},1}, \\nu_{\\text{lim},2}) = \\min\\left(\\sqrt{\\frac{135}{272}}, 0.7312\\right) = \\min(0.70450, 0.7312) = \\sqrt{\\frac{135}{272}}\n$$\n最严格的约束来自奈奎斯特频率处的稳定性要求。库朗数 $\\nu = \\Delta t/(\\Delta x/c)$ 的最大值为 $\\sqrt{135/272}$。\n$$\n\\nu_{\\max} = \\sqrt{\\frac{135}{272}} \\approx 0.70450306...\n$$\n将此系数四舍五入到四位有效数字，得到 $0.7045$。\n最大时间步长为 $\\Delta t = 0.7045 \\frac{\\Delta x}{c}$。",
            "answer": "$$\\boxed{0.7045}$$"
        },
        {
            "introduction": "虽然线性分析是基础，但包括广义相对论在内的真实物理世界本质上是非线性的。本练习使用一个代理方程来探讨非线性如何影响波的传播并导致激波的形成。您将实现一个“非线性CFL”条件，它不仅考虑了波速，还考虑了非线性陡峭化的时间尺度，为实际模拟提供了更真实的稳定性估计 ()。",
            "id": "3487869",
            "problem": "考虑一个用于数值相对论中的非线性规范波测试的一维代理模型，该模型由一个标量一阶非线性双曲偏微分方程描述，\n$$\n\\partial_t u + a(u)\\,\\partial_x u = 0, \\quad a(u) = c_0\\left(1 + \\beta u^2\\right),\n$$\n其中 $u=u(x,t)$ 是无量纲的规范波振幅，$x$ 是位置（单位为米），$t$ 是时间（单位为秒），$c_0$ 是一个恒定的特征速度（单位为米/秒），$\\beta$ 是一个无量纲的非线性参数。假设初始数据形式为\n$$\nu(x,0) = A \\sin(k x),\n$$\n其中振幅 $A$（无量纲），波数 $k$ 的单位为弧度/米。角度必须以弧度为单位处理。\n\n您将为一个采用时间前向欧拉法推进的显式单调有限体积法估算一个“非线性 Courant-Friedrichs-Lewy (CFL) 阈值”，该方法旨在捕捉类平流行为。显式时间步长 $\\Delta t$ 必须同时满足以下两点：(i) 一个源于最大特征速度、基于速度的 CFL 界限，以及 (ii) 一个与振幅相关的界限，该界限确保陡峭化和激波的形成被延迟到所选的最小步数之后，以便让数值耗散发挥作用。您必须将此估算值与一个使用线性特征速度的线性化 CFL 预测值进行对比。\n\n使用以下基本且经过充分检验的事实：\n\n- 对于具有非线性速度 $a(u)$ 的守恒律类型平流，特征线满足 $\\frac{dx}{dt}=a(u)$，且斜率 $w=\\partial_x u$（对于光滑解）根据以下方程演化\n$$\n\\frac{d}{dt} w = -a'(u)\\, w^2,\n$$\n其中 $a'(u) = \\frac{d}{du}a(u)$。\n- 如果 $u(x,0)=A\\sin(kx)$ 且 $a'(u)\\neq 0$，那么梯度爆炸（激波形成）的最早时间为\n$$\nt_s = \\frac{1}{\\max_x\\left(a'(u(x,0))\\,|\\partial_x u(x,0)|\\right)}.\n$$\n- 对于非线性速度 $a(u)=c_0(1+\\beta u^2)$ 和初始条件 $u(x,0)=A\\sin(kx)$，我们有 $a'(u)=2c_0\\beta u$ 和 $\\partial_x u(x,0)=Ak\\cos(kx)$，由此可得\n$$\nt_s = \\frac{1}{c_0\\,\\beta\\,A^2\\,k}.\n$$\n- 对于安全因子为 $\\nu\\in(0,1]$ 的显式单调方法，其基于速度的 CFL 界限为\n$$\n\\Delta t_{\\text{speed}} = \\nu \\frac{\\Delta x}{a_{\\max}}, \\quad a_{\\max} = \\max_x |a(u(x,0))| = c_0\\left(1+\\beta A^2\\right),\n$$\n其中 $\\Delta x$ 是网格间距，单位为米。\n- 线性化 CFL 预测（忽略依赖于振幅的速度）为\n$$\n\\Delta t_{\\text{lin}} = \\nu \\frac{\\Delta x}{c_0}.\n$$\n\n将非线性 CFL 阈值定义为\n$$\n\\Delta t_{\\text{nl}} = \\min\\left(\\Delta t_{\\text{speed}},\\, \\frac{t_s}{M}\\right),\n$$\n其中 $M$ 是一个选定的正整数，代表在达到解析陡峭化时间 $t_s$ 之前的最小显式时间步数，从而体现了一个实际要求，即激波的形成应被延迟，以使数值耗散能够发挥作用。如果 $\\beta=0$，则将 $t_s$ 视为 $+\\infty$，因此 $\\Delta t_{\\text{nl}}=\\Delta t_{\\text{speed}}$。\n\n您的任务是编写一个程序，对每个测试用例，计算并返回数对 $[\\Delta t_{\\text{nl}},\\,\\Delta t_{\\text{lin}}]$，两者都以秒为单位表示。角度必须以弧度处理，并且所有物理单位必须一致：$c_0$ 的单位是米/秒，$\\Delta x$ 的单位是米， $k$ 的单位是弧度/米。使用 $k = 2\\pi/L$，其中 $L$ 是波长，单位是米。\n\n测试套件参数集：\n- 案例1（具有中等非线性的一般“理想路径”）：$c_0 = 2.99792458\\times 10^8$ 米/秒, $\\Delta x = 1000$ 米, $\\beta = 0.1$, $A = 0.5$, $L = 1.0\\times 10^6$ 米, $\\nu = 0.9$, $M = 50$。\n- 案例2（边界条件，线性化极限）：$c_0 = 2.99792458\\times 10^8$ 米/秒, $\\Delta x = 500$ 米, $\\beta = 0.0$, $A = 0.8$, $L = 1.0\\times 10^5$ 米, $\\nu = 1.0$, $M = 20$。\n- 案例3（边缘情况，强非线性，激波时间界限起主导作用）：$c_0 = 3.0\\times 10^8$ 米/秒, $\\Delta x = 100$ 米, $\\beta = 1.0$, $A = 1.0$, $L = 1.0\\times 10^4$ 米, $\\nu = 0.8$, $M = 100$。\n- 案例4（边缘情况，细网格，基于速度的界限起主导作用）：$c_0 = 2.99792458\\times 10^8$ 米/秒, $\\Delta x = 1$ 米, $\\beta = 0.5$, $A = 0.9$, $L = 1.0\\times 10^5$ 米, $\\nu = 0.95$, $M = 200$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含结果，格式为一个以逗号分隔的 Python 风格的列表之列表，每个内部列表包含两个浮点数 $[\\Delta t_{\\text{nl}}, \\Delta t_{\\text{lin}}]$（单位为秒），并按照测试套件案例的顺序排列（例如，$[[x_1,y_1],[x_2,y_2],[x_3,y_3],[x_4,y_4]]$）。",
            "solution": "问题陈述已经过验证，被认为是可靠、自洽且适定的。任务是为一个用于数值相对论的规范波方程简化模型计算两种类型的时间步长阈值：一种是线性化的，另一种是非线性的。计算将针对四个不同的参数集进行。\n\n问题的核心在于应用指定的 Courant-Friedrichs-Lewy (CFL) 条件公式，该条件是双曲偏微分方程显式时间积分格式稳定性的一个必要条件。该问题引入了一个“非线性 CFL 阈值” $\\Delta t_{\\text{nl}}$，它创新地将标准的基于速度的 CFL 限制与一个和激波形成时间 $t_s$ 相关的启发式约束结合起来。这体现了双重的数值挑战：既要解析高速波的传播，又要处理由非线性陡峭化引起的不连续点（激波）的形成。\n\n为每个测试用例计算所需值 $[\\Delta t_{\\text{nl}}, \\Delta t_{\\text{lin}}]$ 的步骤如下。\n\n首先，我们为给定案例定义物理和数值参数：特征速度 $c_0$、网格间距 $\\Delta x$、非线性参数 $\\beta$、初始振幅 $A$、波长 $L$、CFL 安全因子 $\\nu$ 以及激波延迟步数 $M$。\n\n波数 $k$ 由波长 $L$ 通过标准关系式推导得出：\n$$\nk = \\frac{2\\pi}{L}\n$$\n\n接下来，我们计算线性化 CFL 时间步长 $\\Delta t_{\\text{lin}}$。该值基于波速恒定且等于 $c_0$ 的假设，忽略了任何非线性的、依赖于振幅的效应。它是一个用于比较的基准。其公式如下：\n$$\n\\Delta t_{\\text{lin}} = \\nu \\frac{\\Delta x}{c_0}\n$$\n此处，$\\Delta x / c_0$ 代表速度为 $c_0$ 的波穿过一个网格单元所需的时间，而 $\\nu \\in (0, 1]$ 是一个安全因子。\n\n然后，我们计算非线性 CFL 阈值 $\\Delta t_{\\text{nl}}$ 所需的分量。此阈值必须满足两个独立的约束。\n\n第一个约束是基于速度的 CFL 条件 $\\Delta t_{\\text{speed}}$。此条件考虑了局部波速 $a(u) = c_0(1 + \\beta u^2)$ 依赖于波振幅 $u$ 的事实。为保证稳定性，时间步长必须受整个区域上可能出现的最大波速 $a_{\\max}$ 的限制。对于初始条件 $u(x,0) = A \\sin(kx)$，最大振幅为 $A$，因此最大速度为：\n$$\na_{\\max} = \\max_x |a(u(x,0))| = c_0\\left(1+\\beta A^2\\right)\n$$\n相应的基于速度的时间步长限制为：\n$$\n\\Delta t_{\\text{speed}} = \\nu \\frac{\\Delta x}{a_{\\max}} = \\nu \\frac{\\Delta x}{c_0\\left(1+\\beta A^2\\right)}\n$$\n\n第二个约束与非线性波陡峭化有关。非线性双曲方程的一个关键特征是，光滑的初始数据有在有限时间内发展出垂直梯度、形成激波的趋势。问题给出了该激波形成时间 $t_s$ 的公式：\n$$\nt_s = \\frac{1}{c_0\\,\\beta\\,A^2\\,k}\n$$\n问题引入了一个实际要求，即数值模拟在达到此解析激波时间之前必须至少运行 $M$ 个时间步。这确保了数值方法有机会捕捉陡峭化过程，并且其固有的数值耗散可以对将要形成的激波进行正则化。该约束表示为 $\\Delta t \\le t_s / M$。当 $\\beta = 0$ 时，会出现一个重要的特殊情况。在这种线性平流情景下，不会发生陡峭化，因此 $t_s$ 实际上是无穷大。问题明确指出，在这种情况下，第二个约束被忽略。\n\n最后，非线性 CFL 阈值 $\\Delta t_{\\text{nl}}$ 被定义为这两个界限中更严格的一个：即基于速度的限制和陡峭化限制。\n$$\n\\Delta t_{\\text{nl}} = \\min\\left(\\Delta t_{\\text{speed}},\\, \\frac{t_s}{M}\\right)\n$$\n如果 $\\beta=0$，这简化为 $\\Delta t_{\\text{nl}} = \\Delta t_{\\text{speed}}$，由于 $a_{\\max} = c_0$，它进一步简化为 $\\Delta t_{\\text{nl}} = \\Delta t_{\\text{lin}}$。\n\n通过将这些步骤应用于测试套件中提供的每个参数集，我们可以系统地计算出数值对 $[\\Delta t_{\\text{nl}}, \\Delta t_{\\text{lin}}]$，并以指定的格式呈现它们。下面将对每个案例执行计算。\n\n案例1：$c_0 = 2.99792458\\times 10^8$，$\\Delta x = 1000$，$\\beta = 0.1$， $A = 0.5$， $L = 1.0\\times 10^6$， $\\nu = 0.9$， $M = 50$。\n- $k = 2\\pi / (1.0 \\times 10^6) \\approx 6.283 \\times 10^{-6}$ $\\text{rad/m}$。\n- $\\Delta t_{\\text{lin}} = 0.9 \\times 1000 / (2.99792458 \\times 10^8) \\approx 3.002077 \\times 10^{-6}$ $\\text{s}$。\n- $a_{\\max} = c_0(1 + 0.1 \\times 0.5^2) = 1.025\\,c_0$。\n- $\\Delta t_{\\text{speed}} = \\Delta t_{\\text{lin}} / 1.025 \\approx 2.928855 \\times 10^{-6}$ $\\text{s}$。\n- $t_s = 1 / (c_0 \\times 0.1 \\times 0.5^2 \\times k) \\approx 0.021236$ $\\text{s}$。\n- $t_s/M = 0.021236 / 50 \\approx 4.2471 \\times 10^{-4}$ $\\text{s}$。\n- $\\Delta t_{\\text{nl}} = \\min(2.928855 \\times 10^{-6}, 4.2471 \\times 10^{-4}) = 2.928855 \\times 10^{-6}$ $\\text{s}$。\n\n案例2：$c_0 = 2.99792458\\times 10^8$，$\\Delta x = 500$，$\\beta = 0.0$， $A = 0.8$， $L = 1.0\\times 10^5$， $\\nu = 1.0$， $M = 20$。\n- $\\beta = 0$，所以 $t_s \\to \\infty$ 且 $a_{\\max} = c_0$。\n- $\\Delta t_{\\text{speed}} = \\Delta t_{\\text{lin}} = 1.0 \\times 500 / (2.99792458 \\times 10^8) \\approx 1.667821 \\times 10^{-6}$ $\\text{s}$。\n- $\\Delta t_{\\text{nl}} = \\Delta t_{\\text{speed}} = 1.667821 \\times 10^{-6}$ $\\text{s}$。\n\n案例3：$c_0 = 3.0\\times 10^8$，$\\Delta x = 100$，$\\beta = 1.0$， $A = 1.0$， $L = 1.0\\times 10^4$， $\\nu = 0.8$， $M = 100$。\n- $k = 2\\pi / (1.0 \\times 10^4) \\approx 6.283 \\times 10^{-4}$ $\\text{rad/m}$。\n- $\\Delta t_{\\text{lin}} = 0.8 \\times 100 / (3.0 \\times 10^8) \\approx 2.666667 \\times 10^{-7}$ $\\text{s}$。\n- $a_{\\max} = c_0(1 + 1.0 \\times 1.0^2) = 2.0\\,c_0$。\n- $\\Delta t_{\\text{speed}} = \\Delta t_{\\text{lin}} / 2.0 \\approx 1.333333 \\times 10^{-7}$ $\\text{s}$。\n- $t_s = 1 / (c_0 \\times 1.0 \\times 1.0^2 \\times k) \\approx 5.30516 \\times 10^{-6}$ $\\text{s}$。\n- $t_s/M = 5.30516 \\times 10^{-6} / 100 \\approx 5.30516 \\times 10^{-8}$ $\\text{s}$。\n- $\\Delta t_{\\text{nl}} = \\min(1.333333 \\times 10^{-7}, 5.30516 \\times 10^{-8}) = 5.30516 \\times 10^{-8}$ $\\text{s}$。\n\n案例4：$c_0 = 2.99792458\\times 10^8$，$\\Delta x = 1$，$\\beta = 0.5$， $A = 0.9$， $L = 1.0\\times 10^5$， $\\nu = 0.95$， $M = 200$。\n- $k = 2\\pi / (1.0 \\times 10^5) \\approx 6.283 \\times 10^{-5}$ $\\text{rad/m}$。\n- $\\Delta t_{\\text{lin}} = 0.95 \\times 1 / (2.99792458 \\times 10^8) \\approx 3.168850 \\times 10^{-9}$ $\\text{s}$。\n- $a_{\\max} = c_0(1 + 0.5 \\times 0.9^2) = 1.405\\,c_0$。\n- $\\Delta t_{\\text{speed}} = \\Delta t_{\\text{lin}} / 1.405 \\approx 2.255409 \\times 10^{-9}$ $\\text{s}$。\n- $t_s = 1 / (c_0 \\times 0.5 \\times 0.9^2 \\times k) \\approx 1.31102 \\times 10^{-4}$ $\\text{s}$。\n- $t_s/M = 1.31102 \\times 10^{-4} / 200 \\approx 6.5551 \\times 10^{-7}$ $\\text{s}$。\n- $\\Delta t_{\\text{nl}} = \\min(2.255409 \\times 10^{-9}, 6.5551 \\times 10^{-7}) = 2.255409 \\times 10^{-9}$ $\\text{s}$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the nonlinear and linearized CFL time step thresholds\n    for a given set of test cases modeling a nonlinear gauge wave.\n    \"\"\"\n\n    # test_cases are lists of tuples (c0, dx, beta, A, L, nu, M)\n    test_cases = [\n        (2.99792458e8, 1000.0, 0.1, 0.5, 1.0e6, 0.9, 50),\n        (2.99792458e8, 500.0, 0.0, 0.8, 1.0e5, 1.0, 20),\n        (3.0e8, 100.0, 1.0, 1.0, 1.0e4, 0.8, 100),\n        (2.99792458e8, 1.0, 0.5, 0.9, 1.0e5, 0.95, 200),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        c0, dx, beta, A, L, nu, M = case\n\n        # Calculate the wavenumber k\n        k = 2 * np.pi / L\n\n        # Calculate the linearized CFL time step, dt_lin\n        dt_lin = nu * dx / c0\n\n        # Calculate the speed-based CFL time step, dt_speed\n        a_max = c0 * (1.0 + beta * A**2)\n        dt_speed = nu * dx / a_max\n        \n        # Calculate the nonlinear CFL threshold, dt_nl\n        if beta == 0.0:\n            # For the linear case, t_s is infinite, so the steepening\n            # bound is not a constraint. dt_nl is just dt_speed.\n            dt_nl = dt_speed\n        else:\n            # Calculate the shock formation time, t_s\n            # The denominator c0 * beta * A^2 * k must be non-zero\n            # because beta != 0.\n            t_s = 1.0 / (c0 * beta * A**2 * k)\n            \n            # The nonlinear CFL threshold is the minimum of the speed-based\n            # limit and the shock-steepening limit.\n            dt_nl = min(dt_speed, t_s / M)\n        \n        results.append([dt_nl, dt_lin])\n\n    # Final print statement in the exact required format.\n    # The string representation of a list of lists is desired.\n    formatted_results = \",\".join(map(str, results))\n    print(f\"[{formatted_results}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "这最后一个练习将所有概念整合到数值相对论的完整框架中。您将直接从时空的3+1分解的度规分量中推导并实现一个局域CFL估算器。本练习展示了抽象的CFL条件如何应用于产品级代码中，以处理弯曲时空的复杂性，例如引力时间膨胀（递减函数 $\\alpha$）和参考系拖拽（移位矢量 $\\beta^i$），从而确保黑洞和引力波模拟的稳定性 ()。",
            "id": "3487841",
            "problem": "您的任务是设计并实现一个用于引力波和双黑洞并合的数值相对论模拟中的局部估计器，该估计器用于计算 Courant-Friedrichs-Lewy (CFL) 条件，并能考虑时空曲率的影响。该估计器必须从一个双曲系统在局部正交四分体基底中的主特征标构建，然后映射到与数值网格相关的坐标速度。\n\n起点和要求：\n- 使用广义相对论的三加一 (3+1) 分解，其中包含直减函数 $\\alpha$、移位向量 $\\beta^i$ 和空间度规 $\\gamma_{ij}$，其中 $i,j \\in \\{x,y,z\\}$。假设 $\\gamma_{ij}$ 是对称正定的，并且在本问题中，您可以限制为对角化的 $\\gamma_{ij}$。\n- 使用一个无质量波状双曲系统的主特征标，其特征面相对于时空度规是零性的。在一个局部正交四分体基底 $\\{e_0, e_a\\}$ 中，$e_0$ 是类时的，$e_a$ ($a\\in\\{1,2,3\\}$) 是类空正交的，沿每个空间三足方向的特征速度为 $\\pm 1$（在光速等于一的单位制下）。\n- 通过归一化坐标基向量，从空间度规 $\\gamma_{ij}$ 构建正交三足方向，使得每个三足向量 $n^i$ 满足 $\\gamma_{ij} n^i n^j = 1$。然后，从零性条件 $g_{\\mu\\nu} dx^{\\mu} dx^{\\nu} = 0$ 和 3+1 线元出发，通过投影这些零性方向来推导沿每个网格轴的坐标特征速度，推导过程需包含 $\\alpha$ 和 $\\beta^i$ 的效应。\n- 通过汇总每个网格轴上最大模的坐标速度，并将其与网格间距 $\\Delta x$、$\\Delta y$ 和 $\\Delta z$ 结合，定义与 CFL 条件相关的局部谱半径。在多空间维度中，使用适用于显式线方法积分器的加法形式。\n- 实现一个预测器，对于给定的候选时间步长 $\\Delta t$，如果该候选时间步长超过了您的 CFL 估计器计算出的局部最大允许时间步长，则将该位置标记为“预测不稳定”。\n\n观测不稳定性模型：\n- 为测试您的估计器的预测能力，请定义一个“观测”不稳定性准则。该准则通过使用您推导出的相同坐标特征速度 $\\lambda_i$ 来计算方向 Courant 数之和 $\\sum_i \\lambda_i \\Delta t / \\Delta x_i$。如果此和超过 $1$，则标记为不稳定。这为显式格式中的不稳定性提供了一个简单的、局部的、基于模型的观测代理。\n- 使用国际单位制 (SI)。网格间距 $\\Delta x_i$ 以米表示，时间步长 $\\Delta t$ 以秒表示，速度以米/秒表示。使用光速 $c = 299\\,792\\,458\\,\\mathrm{m/s}$ 将无量纲的特征速度（为 $c$ 的分数）转换为国际单位制速度。\n\n程序输入和输出：\n- 您的程序必须为以下五个不同局部状态的测试套件实现上述估计器和观测不稳定性模型。每个测试用例由 $\\alpha$、$\\beta^i$、对角化的 $\\gamma_{ii}$、以米为单位的网格间距 $(\\Delta x, \\Delta y, \\Delta z)$ 和应用的时间步长 $\\Delta t$（以秒为单位）指定：\n    1. 情况 A（中等曲率，适度移位）：$\\alpha = 0.7$, $\\beta^i = (0.05, 0.02, 0.0)$, $\\gamma_{ii} = (2.0736, 2.0736, 2.0736)$, $(\\Delta x, \\Delta y, \\Delta z) = (150, 150, 150)\\,\\mathrm{m}$, $\\Delta t = 3.0\\times 10^{-4}\\,\\mathrm{s}$。\n    2. 情况 B（强曲率，近视界状，轴向移位）：$\\alpha = 0.2$, $\\beta^i = (0.05, 0.0, 0.0)$, $\\gamma_{ii} = (16.0, 16.0, 16.0)$, $(\\Delta x, \\Delta y, \\Delta z) = (100, 100, 100)\\,\\mathrm{m}$, $\\Delta t = 2.0\\times 10^{-4}\\,\\mathrm{s}$。\n    3. 情况 C（各向异性度规和网格）：$\\alpha = 0.9$, $\\beta^i = (0.2, -0.1, 0.05)$, $\\gamma_{ii} = (1.5, 2.5, 3.5)$, $(\\Delta x, \\Delta y, \\Delta z) = (200, 100, 50)\\,\\mathrm{m}$, $\\Delta t = 4.0\\times 10^{-4}\\,\\mathrm{s}$。\n    4. 情况 D（平直三足，零移位，等式边缘）：$\\alpha = 1.0$, $\\beta^i = (0.0, 0.0, 0.0)$, $\\gamma_{ii} = (1.0, 1.0, 1.0)$, $(\\Delta x, \\Delta y, \\Delta z) = (300, 300, 300)\\,\\mathrm{m}$, $\\Delta t = 3.338\\times 10^{-7}\\,\\mathrm{s}$。\n    5. 情况 E（并合核心状，非平凡移位）：$\\alpha = 0.5$, $\\beta^i = (0.1, 0.08, 0.0)$, $\\gamma_{ii} = (10.0, 10.0, 10.0)$, $(\\Delta x, \\Delta y, \\Delta z) = (75, 75, 150)\\,\\mathrm{m}$, $\\Delta t = 1.0\\times 10^{-4}\\,\\mathrm{s}$。\n- 对于每种情况，计算：\n    1. 根据您的局部 CFL 估计器计算出的预测最大稳定时间步长 $\\Delta t_{\\max}$（单位：秒）。\n    2. 一个布尔值，指示预测的不稳定性，定义为 $\\Delta t > \\Delta t_{\\max}$。\n    3. 一个布尔值，指示观测到的不稳定性，由局部加法 Courant 准则 $\\sum_i \\lambda_i \\Delta t / \\Delta x_i > 1$ 定义，其中 $\\lambda_i$ 是沿每个轴的坐标特征速度（单位：米/秒）。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。该列表必须是扁平的，并按顺序包含五个情况的结果：情况 A 的 $\\Delta t_{\\max}$（浮点数，单位为秒）、情况 A 的预测不稳定性（布尔值）、情况 A 的观测不稳定性（布尔值），然后是情况 B、情况 C、情况 D 和情况 E 的相同三元组。例如，输出应类似于 $[\\Delta t_{\\max,A},\\mathrm{predA},\\mathrm{obsA},\\Delta t_{\\max,B},\\mathrm{predB},\\mathrm{obsB},\\ldots]$。\n\n注：\n- 本问题不涉及角度；无需特殊角度单位。\n- 所有速度必须一致处理：四分体特征速度在光速单位下为 $\\pm 1$，坐标速度在与以米为单位的网格间距结合之前，必须使用 $c$ 转换为米/秒。\n- 通过遵守 $\\alpha^2 \\ge \\beta_{\\perp}^2$ 的要求来确保科学真实性，从而使时间坐标保持类时性。所提供的测试套件满足此条件。",
            "solution": "经评估，用户提供的问题是有效的。它在科学上基于数值相对论和时空 3+1 分解的既定原则。该问题是适定的，提供了推导唯一确定性解所需的完整且一致的数据和定义集。其语言客观、正式。这项任务是在广义相对论背景下推导和应用 Courant-Friedrichs-Lewy (CFL) 稳定性条件的一项标准（尽管不简单）的练习。\n\n解决方案首先从时空度规推导坐标特征速度，然后使用这些速度构建时间步长的 CFL 极限。\n\n**1. 坐标特征速度的推导**\n\n在广义相对论中，确定类波系统特征速度的基本原理是信息沿时空度规 $g_{\\mu\\nu}$ 的零性测地线传播。零性路径由条件 $ds^2 = g_{\\mu\\nu} dx^\\mu dx^\\nu = 0$ 定义。\n\n该问题指定使用 Arnowitt-Deser-Misner (ADM) 或 3+1 形式，其中时空线元 $ds^2$ 分解为：\n$$ds^2 = -\\alpha^2 dt^2 + \\gamma_{ij} (dx^i - \\beta^i dt)(dx^j - \\beta^j dt)$$\n这里，$\\alpha$ 是直减函数，$\\beta^i$ 是移位向量，$\\gamma_{ij}$ 是给定时间切片上的三维空间度规。索引 $i, j$ 的取值范围为 1 到 3（或 $x, y, z$）。\n\n为了找到光信号的坐标速度 $v^i = dx^i/dt$，我们令 $ds^2=0$ 并除以 $dt^2$：\n$$-\\alpha^2 + \\gamma_{ij} \\left(\\frac{dx^i}{dt} - \\beta^i\\right)\\left(\\frac{dx^j}{dt} - \\beta^j\\right) = 0$$\n代入 $v^i = dx^i/dt$，我们得到坐标速度空间中未来光锥边界的方程：\n$$\\gamma_{ij} (v^i - \\beta^i)(v^j - \\beta^j) = \\alpha^2$$\n这个方程描述了 $v^i$ 速度空间中的一个椭球体。为了确定 CFL 条件，我们需要沿每个网格轴的最大可能坐标速度。让我们找出沿 $x$ 轴的最大速度，记为 $\\lambda_x$。这对应于在椭球体约束下求 $v^x$ 的最大值。\n\n令 $w^i = v^i - \\beta^i$。约束变为 $\\gamma_{ij} w^i w^j = \\alpha^2$。我们想要找到 $v^x = w^x + \\beta^x$ 的极值。这等价于找到 $w^x$ 的极值。由于问题说明 $\\gamma_{ij}$ 是对角的，我们可以写成 $\\gamma_{ij} = \\text{diag}(\\gamma_{xx}, \\gamma_{yy}, \\gamma_{zz})$。约束方程简化为：\n$$\\gamma_{xx} (w^x)^2 + \\gamma_{yy} (w^y)^2 + \\gamma_{zz} (w^z)^2 = \\alpha^2$$\n为了找到 $w^x$ 的最大值和最小值，我们令 $w^y = 0$ 和 $w^z = 0$。这得出：\n$$\\gamma_{xx} (w^x)^2 = \\alpha^2 \\implies w^x = \\pm \\frac{\\alpha}{\\sqrt{\\gamma_{xx}}}$$\n因此，坐标速度 $v^x$ 的极值为：\n$$v^x_{\\pm} = \\beta^x + w^x = \\beta^x \\pm \\frac{\\alpha}{\\sqrt{\\gamma_{xx}}}$$\n与 CFL 条件相关的特征速度是具有最大模值的那个。它由下式给出：\n$$\\lambda_x = \\max(|v^x_+|, |v^x_-|) = \\max\\left(\\left|\\beta^x + \\frac{\\alpha}{\\sqrt{\\gamma_{xx}}}\\right|, \\left|\\beta^x - \\frac{\\alpha}{\\sqrt{\\gamma_{xx}}}\\right|\\right)$$\n由于 $\\alpha>0$ 和 $\\sqrt{\\gamma_{xx}}>0$，这简化为：\n$$\\lambda_x = |\\beta^x| + \\frac{\\alpha}{\\sqrt{\\gamma_{xx}}}$$\n以此类推，沿 $y$ 轴和 $z$ 轴的最大模特征速度为：\n$$\\lambda_y = |\\beta^y| + \\frac{\\alpha}{\\sqrt{\\gamma_{yy}}}$$\n$$\\lambda_z = |\\beta^z| + \\frac{\\alpha}{\\sqrt{\\gamma_{zz}}}$$\n这些速度 $\\lambda_i$ 是无量纲的，以光速 $c$ 为单位表示。要将它们转换为国际单位制 (m/s)，我们乘以 $c = 299792458 \\, \\mathrm{m/s}$。令 $\\lambda_{i, \\text{SI}} = c \\cdot \\lambda_i$。\n\n**2. CFL 条件和不稳定性准则**\n\n对于使用显式线方法格式求解的多维双曲系统，CFL 稳定性条件的一种常见形式是加法形式。方向 Courant 数之和必须小于或等于一个常数 $C_{\\text{CFL}}$，其数量级为 1。问题指定了一个对应于 $C_{\\text{CFL}} = 1$ 的稳定性极限。条件是：\n$$\\Delta t \\left( \\frac{\\lambda_{x, \\text{SI}}}{\\Delta x} + \\frac{\\lambda_{y, \\text{SI}}}{\\Delta y} + \\frac{\\lambda_{z, \\text{SI}}}{\\Delta z} \\right) \\le 1$$\n其中 $\\Delta x, \\Delta y, \\Delta z$ 是以米为单位的网格间距。\n\n根据这个不等式，我们可以确定最大稳定时间步长 $\\Delta t_{\\max}$：\n$$\\Delta t_{\\max} = \\left( \\frac{\\lambda_{x, \\text{SI}}}{\\Delta x} + \\frac{\\lambda_{y, \\text{SI}}}{\\Delta y} + \\frac{\\lambda_{z, \\text{SI}}}{\\Delta z} \\right)^{-1}$$\n代入 $\\lambda_{i, \\text{SI}}$ 的表达式：\n$$\\Delta t_{\\max} = \\left[ c \\left( \\frac{|\\beta^x| + \\alpha/\\sqrt{\\gamma_{xx}}}{\\Delta x} + \\frac{|\\beta^y| + \\alpha/\\sqrt{\\gamma_{yy}}}{\\Delta y} + \\frac{|\\beta^z| + \\alpha/\\sqrt{\\gamma_{zz}}}{\\Delta z} \\right) \\right]^{-1}$$\n\n问题为给定的试验时间步长 $\\Delta t$ 定义了两个不稳定性准则：\n1.  **预测不稳定性**：这是一个布尔标志，如果给定的时间步长 $\\Delta t$ 超过计算出的最大允许时间步长 $\\Delta t_{\\max}$，则为真。\n    $$\\text{预测不稳定性} = (\\Delta t > \\Delta t_{\\max})$$\n2.  **观测不稳定性**：这是一个布尔标志，如果方向 Courant 数之和超过 1，则为真。\n    $$\\text{观测不稳定性} = \\left( \\frac{\\lambda_{x, \\text{SI}} \\Delta t}{\\Delta x} + \\frac{\\lambda_{y, \\text{SI}} \\Delta t}{\\Delta y} + \\frac{\\lambda_{z, \\text{SI}} \\Delta t}{\\Delta z} > 1 \\right)$$\n通过代数重排可以清楚地看出，这两个条件在逻辑上是等价的。如果 $\\sum_i (\\lambda_{i, \\text{SI}} \\Delta t / \\Delta x_i) > 1$，那么 $\\Delta t > (\\sum_i \\lambda_{i, \\text{SI}} / \\Delta x_i)^{-1}$，这与 $\\Delta t > \\Delta t_{\\max}$ 是相同的。\n\n**3. 算法实现**\n\n对于提供的每个测试用例，执行以下计算步骤：\n1.  提取局部度规分量 $\\alpha$、$\\beta^i = (\\beta^x, \\beta^y, \\beta^z)$ 和对角化的 $\\gamma_{ii} = (\\gamma_{xx}, \\gamma_{yy}, \\gamma_{zz})$，以及网格间距 $(\\Delta x, \\Delta y, \\Delta z)$ 和试验时间步长 $\\Delta t$。\n2.  使用推导出的公式计算无量纲的特征速度 $\\lambda_x, \\lambda_y, \\lambda_z$。\n3.  计算 $\\Delta t_{\\max}$ 表达式的分母，即 CFL 时间尺度的倒数之和：$S = c \\left( \\frac{\\lambda_x}{\\Delta x} + \\frac{\\lambda_y}{\\Delta y} + \\frac{\\lambda_z}{\\Delta z} \\right)$。\n4.  计算最大稳定时间步长：$\\Delta t_{\\max} = 1/S$。\n5.  评估预测的不稳定性：比较 $\\Delta t > \\Delta t_{\\max}$ 得到的布尔值。\n6.  评估观测到的不稳定性：比较 $\\Delta t \\cdot S > 1$ 得到的布尔值。\n7.  为每种情况收集结果三元组（$\\Delta t_{\\max}$、预测的不稳定性、观测到的不稳定性）。\n8.  将所有结果格式化为单个扁平列表以供最终输出。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes a local CFL estimator for numerical relativity simulations,\n    evaluates it for several test cases, and predicts stability.\n    \"\"\"\n    # Define physical constants and test cases as per the problem statement.\n    C_LIGHT = 299792458.0  # Speed of light in m/s\n\n    test_cases = [\n        # Case A (moderate curvature, modest shift)\n        {\n            \"name\": \"A\",\n            \"alpha\": 0.7,\n            \"beta\": np.array([0.05, 0.02, 0.0]),\n            \"gamma_ii\": np.array([2.0736, 2.0736, 2.0736]),\n            \"delta_x\": np.array([150.0, 150.0, 150.0]),\n            \"delta_t\": 3.0e-4,\n        },\n        # Case B (strong curvature, near-horizon-like, axial shift)\n        {\n            \"name\": \"B\",\n            \"alpha\": 0.2,\n            \"beta\": np.array([0.05, 0.0, 0.0]),\n            \"gamma_ii\": np.array([16.0, 16.0, 16.0]),\n            \"delta_x\": np.array([100.0, 100.0, 100.0]),\n            \"delta_t\": 2.0e-4,\n        },\n        # Case C (anisotropic metric and grid)\n        {\n            \"name\": \"C\",\n            \"alpha\": 0.9,\n            \"beta\": np.array([0.2, -0.1, 0.05]),\n            \"gamma_ii\": np.array([1.5, 2.5, 3.5]),\n            \"delta_x\": np.array([200.0, 100.0, 50.0]),\n            \"delta_t\": 4.0e-4,\n        },\n        # Case D (flat triad, zero shift, equality edge)\n        {\n            \"name\": \"D\",\n            \"alpha\": 1.0,\n            \"beta\": np.array([0.0, 0.0, 0.0]),\n            \"gamma_ii\": np.array([1.0, 1.0, 1.0]),\n            \"delta_x\": np.array([300.0, 300.0, 300.0]),\n            \"delta_t\": 3.338e-7,\n        },\n        # Case E (merger-core-like, nontrivial shift)\n        {\n            \"name\": \"E\",\n            \"alpha\": 0.5,\n            \"beta\": np.array([0.1, 0.08, 0.0]),\n            \"gamma_ii\": np.array([10.0, 10.0, 10.0]),\n            \"delta_x\": np.array([75.0, 75.0, 150.0]),\n            \"delta_t\": 1.0e-4,\n        },\n    ]\n\n    all_results = []\n    for case in test_cases:\n        alpha = case[\"alpha\"]\n        beta = case[\"beta\"]\n        gamma_ii = case[\"gamma_ii\"]\n        delta_x = case[\"delta_x\"]\n        delta_t = case[\"delta_t\"]\n\n        # 1. Derive the largest-magnitude coordinate characteristic speeds.\n        # These speeds are dimensionless (in units of c).\n        # The formula is lambda_i = |beta^i| + alpha / sqrt(gamma_ii).\n        sqrt_gamma_ii = np.sqrt(gamma_ii)\n        lambda_dimless = np.abs(beta) + alpha / sqrt_gamma_ii\n\n        # 2. Formulate the CFL condition to find the maximum stable timestep.\n        # The additive form is dt * sum(lambda_i_SI / dx_i) = 1.\n        # lambda_i_SI are the speeds in SI units (m/s).\n        lambda_si = C_LIGHT * lambda_dimless\n        \n        # This is the sum term S = sum(lambda_i_SI / dx_i), with units of 1/s.\n        cfl_sum_term = np.sum(lambda_si / delta_x)\n\n        # The maximum stable timestep is dt_max = 1 / S.\n        delta_t_max = 1.0 / cfl_sum_term\n\n        # 3. Evaluate the instability criteria for the given trial step delta_t.\n        \n        # Predicted instability: True if delta_t  delta_t_max.\n        predicted_instability = delta_t  delta_t_max\n\n        # Observed instability: True if sum of Courant numbers  1.\n        # This is equivalent to sum(lambda_i * dt / dx_i)  1,\n        # or dt * sum(lambda_i / dx_i)  1, which is dt * cfl_sum_term  1.\n        observed_instability = (delta_t * cfl_sum_term)  1.0\n        \n        all_results.extend([delta_t_max, predicted_instability, observed_instability])\n\n    # Final print statement in the exact required format.\n    # The format string converts floats and booleans to their string representations.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```"
        }
    ]
}