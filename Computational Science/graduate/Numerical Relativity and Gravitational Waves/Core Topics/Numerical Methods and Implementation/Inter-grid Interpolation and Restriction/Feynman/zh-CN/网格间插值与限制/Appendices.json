{
    "hands_on_practices": [
        {
            "introduction": "自适应网格加密（AMR）模拟的精度在很大程度上取决于跨网格传递算子的质量。本练习将从基本原理出发，着手构建一个高阶的延长（或插值）算子 。通过要求该算子能够精确地重构特定阶数以下的多项式，我们可以推导出高阶插值模板所需的具体权重，这是发展数值方法的一项基本技能。",
            "id": "3477765",
            "problem": "考虑在数值相对论中，用于演化双黑洞并合附近的时空度规和曲率的 Baumgarte–Shapiro–Shibata–Nakamura (BSSN) 形式体系中所使用的自适应网格加密 (AMR) 层次结构。设一个粗网格层具有均匀的网格间距 $H$ 和光滑标量场 $\\phi(x)$ 的网格中心采样值，该标量场例如表示该层上的一个规范不变引力波提取标量。引入一个加密比为 $r=2$ 的细网格层，因此其间距为 $h=H/2$，并且其网格中心位于每个粗网格单元内，相对于粗网格中心有 $\\pm H/4$ 的偏移。\n\n您的任务是，从第一性原理出发，构建一个四阶张量积多项式延拓算子，该算子将粗网格中心数据映射到细网格中心，并且对最高三次的多项式是精确的。在一维空间中进行推导，得出典型的一维模板，该模板可作为在更高维度中构建张量积算子的基础。\n\n具体来说，确定用于位于相对于位置 $x_i$ 处粗网格中心偏移量为 $+H/4$ 的细网格中心的四点一维插值权重。在 $x_i + H/4$ 处的插值细网格值 $\\phi^{f}$ 必须写成四个相邻粗网格中心值 $\\{\\phi_{i-1}, \\phi_i, \\phi_{i+1}, \\phi_{i+2}\\}$ 的线性组合，使得该算子能精确地再现任何最高三次的多项式 $\\phi(x)$。将您的最终答案表示为一个行向量，其中包含与 $\\{\\phi_{i-1}, \\phi_i, \\phi_{i+1}, \\phi_{i+2}\\}$ 顺序对应的四个系数。\n\n无需进行数值舍入。最终答案必须是单一的解析表达式。",
            "solution": "该问题要求构建一个一维四阶多项式延拓算子，用于将间距为 $H$ 的粗网格上的数据插值到一个特定的细网格点上。细网格点上的插值（我们记为 $\\phi^f$）将表示为来自四个指定的相邻粗网格点值的线性组合。该算子必须对任何最高三次的多项式都精确，这意味着其局部截断误差为 $\\mathcal{O}(H^4)$ 阶，这与一个四阶方法是一致的。\n\n设粗网格点位于位置 $x_j = jH$ (其中 $j$ 为任意整数)。标量场 $\\phi(x)$ 在这些点上的值记为 $\\phi_j = \\phi(x_j)$。具体任务是对于给定的粗网格单元索引 $i$，求出位于 $x_f = x_i + H/4$ 的细网格点上的插值。插值公式指定使用来自索引为 $\\{i-1, i, i+1, i+2\\}$ 的四个粗网格点上的值。\n\n插值公式是这些粗网格值的线性组合：\n$$ \\phi^f = c_{-1} \\phi_{i-1} + c_0 \\phi_i + c_1 \\phi_{i+1} + c_2 \\phi_{i+2} $$\n系数 $\\{c_{-1}, c_0, c_1, c_2\\}$ 是定义插值模板的未知权重。\n\n为了在不失一般性的前提下简化推导，我们可以通过设置 $x_i = 0$ 来建立一个局部坐标系。此时，模板中涉及的粗网格点的位置为：\n$$ x_{i-1} = -H, \\quad x_i = 0, \\quad x_{i+1} = H, \\quad x_{i+2} = 2H $$\n目标细网格点位于 $x_f = x_i + H/4 = H/4$。\n\n基本约束是插值必须对任何最高三次的多项式都精确。这意味着如果 $\\phi(x)$ 是这样一个多项式，那么该公式必须精确地得出 $\\phi(x_f)$。我们可以通过要求该公式对最高三次多项式向量空间的一个基是精确的来强制执行此条件。单项式基 $\\{1, x, x^2, x^3\\}$ 是一个方便的选择。\n\n我们对每个基多项式应用此条件：\n\n1.  对于 $\\phi(x) = 1$：\n    函数在所有点上的值都是 $1$。插值公式必须能再现这个常数值。\n    $$ 1 = c_{-1}\\phi(-H) + c_0\\phi(0) + c_1\\phi(H) + c_2\\phi(2H) = c_{-1}(1) + c_0(1) + c_1(1) + c_2(1) $$\n    这给出了我们的第一个线性方程：\n    $$ c_{-1} + c_0 + c_1 + c_2 = 1 \\quad (1) $$\n\n2.  对于 $\\phi(x) = x$：\n    粗网格点上的值为 $\\phi(x_j) = x_j$。需要恢复的细网格点上的值为 $\\phi(x_f) = x_f = H/4$。\n    $$ \\frac{H}{4} = c_{-1}(-H) + c_0(0) + c_1(H) + c_2(2H) $$\n    假设 $H \\neq 0$，我们可以两边除以 $H$：\n    $$ -c_{-1} + c_1 + 2c_2 = \\frac{1}{4} \\quad (2) $$\n\n3.  对于 $\\phi(x) = x^2$：\n    各点上的值为 $\\phi(x_j) = x_j^2$。细网格点上的值为 $\\phi(x_f) = x_f^2 = (H/4)^2 = H^2/16$。\n    $$ \\frac{H^2}{16} = c_{-1}(-H)^2 + c_0(0)^2 + c_1(H)^2 + c_2(2H)^2 = c_{-1}H^2 + c_1H^2 + 4c_2H^2 $$\n    两边除以 $H^2$：\n    $$ c_{-1} + c_1 + 4c_2 = \\frac{1}{16} \\quad (3) $$\n\n4.  对于 $\\phi(x) = x^3$：\n    各点上的值为 $\\phi(x_j) = x_j^3$。细网格点上的值为 $\\phi(x_f) = x_f^3 = (H/4)^3 = H^3/64$。\n    $$ \\frac{H^3}{64} = c_{-1}(-H)^3 + c_0(0)^3 + c_1(H)^3 + c_2(2H)^3 = -c_{-1}H^3 + c_1H^3 + 8c_2H^3 $$\n    两边除以 $H^3$：\n    $$ -c_{-1} + c_1 + 8c_2 = \\frac{1}{64} \\quad (4) $$\n\n我们得到了一个关于四个未知系数 $\\{c_{-1}, c_0, c_1, c_2\\}$ 的四元线性方程组。我们可以解这个方程组。让我们首先关注方程 $(2)$、$(3)$ 和 $(4)$，它们构成了一个关于 $c_{-1}$、$c_1$ 和 $c_2$ 的子系统。\n从方程 $(4)$ 中减去方程 $(2)$：\n$$ (-c_{-1} + c_1 + 8c_2) - (-c_{-1} + c_1 + 2c_2) = \\frac{1}{64} - \\frac{1}{4} $$\n$$ 6c_2 = \\frac{1 - 16}{64} = -\\frac{15}{64} $$\n$$ c_2 = -\\frac{15}{6 \\times 64} = -\\frac{5}{2 \\times 64} = -\\frac{5}{128} $$\n\n现在，将 $c_2$ 的值代入方程 $(2)$ 和 $(3)$。\n根据方程 $(3)$:\n$$ c_{-1} + c_1 = \\frac{1}{16} - 4c_2 = \\frac{1}{16} - 4\\left(-\\frac{5}{128}\\right) = \\frac{1}{16} + \\frac{20}{128} = \\frac{8}{128} + \\frac{20}{128} = \\frac{28}{128} = \\frac{7}{32} \\quad (A) $$\n根据方程 $(2)$:\n$$ -c_{-1} + c_1 = \\frac{1}{4} - 2c_2 = \\frac{1}{4} - 2\\left(-\\frac{5}{128}\\right) = \\frac{1}{4} + \\frac{10}{128} = \\frac{32}{128} + \\frac{10}{128} = \\frac{42}{128} = \\frac{21}{64} \\quad (B) $$\n\n现在我们求解由方程 $(A)$ 和 $(B)$ 组成的关于 $c_{-1}$ 和 $c_1$ 的方程组。将 $(A)$ 和 $(B)$ 相加：\n$$ (c_{-1} + c_1) + (-c_{-1} + c_1) = \\frac{7}{32} + \\frac{21}{64} $$\n$$ 2c_1 = \\frac{14}{64} + \\frac{21}{64} = \\frac{35}{64} \\implies c_1 = \\frac{35}{128} $$\n将 $c_1$ 的值代回方程 $(A)$：\n$$ c_{-1} = \\frac{7}{32} - c_1 = \\frac{7}{32} - \\frac{35}{128} = \\frac{28}{128} - \\frac{35}{128} = -\\frac{7}{128} $$\n\n最后，我们使用方程 $(1)$ 来确定 $c_0$：\n$$ c_0 = 1 - (c_{-1} + c_1 + c_2) = 1 - \\left(-\\frac{7}{128} + \\frac{35}{128} - \\frac{5}{128}\\right) $$\n$$ c_0 = 1 - \\left(\\frac{-7 + 35 - 5}{128}\\right) = 1 - \\frac{23}{128} = \\frac{128 - 23}{128} = \\frac{105}{128} $$\n\n因此，该模板的四个插值权重为：\n$$ c_{-1} = -\\frac{7}{128}, \\quad c_0 = \\frac{105}{128}, \\quad c_1 = \\frac{35}{128}, \\quad c_2 = -\\frac{5}{128} $$\n问题要求将最终答案表示为这些系数组成的行向量。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-\\frac{7}{128}  \\frac{105}{128}  \\frac{35}{128}  -\\frac{5}{128}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "延长算子用于创建精细网格上的数据，而限制算子则将信息传递到粗糙网格，这个降采样过程很容易产生信号混叠（aliasing）。本练习将深入傅里叶域，分析高频模式（如数值噪音或规范伪影）在限制操作后如何被错误地表示为低频信号 。你不仅需要诊断这一问题，还将亲手设计一个预滤波器来抑制这种污染，这是确保模拟结果物理保真度的关键技术。",
            "id": "3477707",
            "problem": "考虑一个一维均匀细网格，其间距为 $h$，网格索引为 $j \\in \\mathbb{Z}$。在此网格上采样了一个标量场，代表 Newman–Penrose Weyl 标量 $\\psi_4$，记为 $\\psi_{4,j}$。在用于数值相对论中引力波提取的网格层次结构中，使用一个限制算子将数据从细网格传输到间距为 $2h$ 的粗网格。在本问题中，该限制算子通过注入（injection）定义：粗网格上索引 $i$ 处的值是细网格上偶数索引处的值，即 $\\Psi_i = \\psi_{4,2i}$。\n\n假设细网格场包含一个单一的离散傅里叶模式，形式为 $\\psi_{4,j} = \\exp(i \\kappa j)$，其中无量纲的细网格波数 $\\kappa \\in [-\\pi,\\pi]$。将此限制操作视为一个线性时不变运算，后跟一个因子为 $2$ 的抽样（decimation）。\n\n首先，从平面波的定义和抽样下的采样性质出发，推导该限制算子在傅里叶域中的离散传递函数：确定限制 $\\exp(i \\kappa j)$ 后产生的粗网格波数 $\\kappa_c$ 以及乘以该模式的相应复振幅因子（增益）。解释由于抽样而发生的任何混叠（aliasing）。\n\n接下来，为了减轻细网格奈奎斯特波数 $\\kappa = \\pi$ 附近的高频规范模式对粗网格 $\\psi_4$ 的污染，你需要在细网格上设计一个对称的三点前置滤波器，并于限制操作前应用。该前置滤波器是卷积\n$$\n\\tilde{\\psi}_{4,j} \\;=\\; a\\,\\psi_{4,j-1} \\;+\\; (1-2a)\\,\\psi_{4,j} \\;+\\; a\\,\\psi_{4,j+1} \\, ,\n$$\n其中 $a \\in \\mathbb{R}$ 是一个实数参数。设计要求是：\n(i) 前置滤波器必须在主导阶上保留低频内容（即，在 $\\kappa = 0$ 时必须具有单位增益），以及\n(ii) 在限制操作后，它必须消除纯奈奎斯特模式 $\\psi_{4,j} = (-1)^j$ 对粗网格的贡献（即，粗网格对 $\\kappa = \\pi$ 的响应应恰好为零）。\n\n使用线性移不变滤波器和抽样的离散傅里叶分析的基本原理，计算前置滤波器的离散频率响应，将其与限制算子复合，评估该链在奈奎斯特输入 $\\kappa = \\pi$ 时的响应，并求解满足要求 (ii) 的唯一值 $a$。给出 $a$ 的精确值作为最终答案。无需四舍五入，且答案是无量纲的。",
            "solution": "我们首先分析限制算子，然后设计前置滤波器。使用的基本概念是：(a) 线性移不变卷积及其离散时间傅里叶变换，(b) 采样平面波的表示，以及 (c) 因子为 2 的抽样对采样正弦波及其波数的影响。\n\n注入限制。限制算子定义为 $\\Psi_i = \\psi_{4,2i}$。对于一个细网格平面波 $\\psi_{4,j} = \\exp(i \\kappa j)$，限制后的序列是\n$$\n\\Psi_i \\;=\\; \\psi_{4,2i} \\;=\\; \\exp(i \\kappa \\cdot 2i) \\;=\\; \\exp\\!\\big(i (2\\kappa) i\\big) \\, .\n$$\n将 $\\Psi_i$ 解释为在索引为 $i$、间距为 $2h$ 的粗网格上的一个平面波，无量纲的粗网格波数是每个粗网格索引的相位增量，\n$$\n\\kappa_c \\;=\\; 2\\kappa \\;\\;\\; \\text{取模 } 2\\pi \\text{ 并折叠到 } [-\\pi,\\pi] \\, \\text{内}。\n$$\n因此，因子为 2 的抽样将细网格上波数为 $\\kappa$ 的模式映射到粗网格上波数为 $\\kappa_c = 2\\kappa$ 模 $2\\pi$ 的模式，当 $2\\kappa \\notin [-\\pi,\\pi]$ 时会发生混叠。这种注入限制对纯正弦波的振幅增益为 1，因为没有进行平均；输出是输入的一个采样子序列：\n$$\n\\text{增益 } R(\\kappa) \\;=\\; 1 \\, .\n$$\n一个值得注意的特例是细网格的奈奎斯特模式 $\\kappa = \\pi$，此时\n$$\n\\Psi_i \\;=\\; \\exp\\!\\big(i (2\\pi) i\\big) \\;=\\; 1 \\, ,\n$$\n即 $\\kappa_c = 0$ 且振幅为常数，这表明细网格的奈奎斯特分量会混叠成粗网格的零频分量。\n\n前置滤波器设计。我们现在用对称三点核对细网格数据进行前置滤波\n$$\ng[-1] = a, \\quad g[0] = 1 - 2a, \\quad g[+1] = a \\, .\n$$\n该核的离散时间傅里叶变换（频率响应）是\n$$\nG(\\kappa) \\;=\\; a\\,\\exp(-i\\kappa) \\;+\\; (1-2a) \\;+\\; a\\,\\exp(i\\kappa) \\;=\\; 1 - 2a + 2a \\cos(\\kappa) \\, .\n$$\n要求 (i)：在主导阶上保留低频内容等效于在零频率处具有单位增益。我们验证\n$$\nG(0) \\;=\\; 1 - 2a + 2a \\cos(0) \\;=\\; 1 - 2a + 2a \\cdot 1 \\;=\\; 1 \\, ,\n$$\n此式对所有实数 $a$ 均成立，因此低频内容的振幅得以保留。由于该滤波器是对称的，它在 $\\kappa = 0$ 附近具有零线性相位失真，这与在主导阶上保留平滑内容是一致的。\n\n在奈奎斯特模式下的链式响应。考虑一个纯奈奎斯特输入 $\\psi_{4,j} = \\exp(i \\pi j) = (-1)^j$，因此 $\\kappa = \\pi$。前置滤波后的序列是\n$$\n\\tilde{\\psi}_{4,j} \\;=\\; \\big(g * \\psi_4\\big)_j \\;=\\; G(\\pi)\\,\\exp(i \\pi j) \\, ,\n$$\n其中在 $\\kappa = \\pi$ 处的振幅因子是\n$$\nG(\\pi) \\;=\\; 1 - 2a + 2a \\cos(\\pi) \\;=\\; 1 - 2a - 2a \\;=\\; 1 - 4a \\, .\n$$\n应用注入限制得到粗网格序列\n$$\n\\tilde{\\Psi}_i \\;=\\; \\tilde{\\psi}_{4,2i} \\;=\\; G(\\pi)\\,\\exp\\!\\big(i \\pi \\cdot 2i\\big) \\;=\\; G(\\pi) \\cdot 1 \\;=\\; G(\\pi) \\, .\n$$\n如前所示，抽样将 $\\kappa = \\pi$ 映射到 $\\kappa_c = 0$，因此奈奎斯特输入的粗网格输出是一个常数，其振幅等于 $G(\\pi)$。\n\n设计要求 (ii) 要求将粗网格对奈奎斯特模式的此响应完全消除。因此我们要求\n$$\nG(\\pi) \\;=\\; 0 \\;\\;\\;\\Longrightarrow\\;\\;\\; 1 - 4a \\;=\\; 0 \\, .\n$$\n解出 $a$ 得\n$$\na \\;=\\; \\frac{1}{4} \\, .\n$$\n根据设计，该值在低频处保留了单位增益，并在奈奎斯特波数 $\\kappa = \\pi$ 处施加了一个传输零点，从而抑制了高频规范模式在注入限制后混叠到粗网格 $\\psi_4$ 中。",
            "answer": "$$\\boxed{\\frac{1}{4}}$$"
        },
        {
            "introduction": "在构建和分析了单个算子之后，我们必须评估它们的综合效应。本练习涉及一个“往返”测试：将数据限制到粗糙网格，然后再延长回精细网格 。通过应用经典的插值理论，你将为这一过程引入的最大误差推导出一个严格的界限，从而提供一个功能强大且与网格细化比无关的验证工具，用于检验AMR代码的正确性。",
            "id": "3477759",
            "problem": "考虑一个周长为 $L$ 的一维周期性世界管，在其上对无量纲的引力波应变场 $u(x)$ 进行采样，用于采用自适应网格加密（AMR）的数值相对论模拟。设最精细的均匀网格间距为 $h_{f}$，节点为 $x_{n} = n h_{f}$（其中 $n = 0, 1, \\dots, N-1$ 且 $N h_{f} = L$），并设一个较粗的网格间距为 $h_{c} = r h_{f}$，其中 $r \\geq 2$ 为整数加密因子。定义从精细网格到粗网格的限制算子 $R$ 为在粗网格节点上的逐点注入，即 $R u (x_{jr}) = u(x_{jr})$，其中 $j = 0, 1, \\dots, N/r - 1$。定义从粗网格回到精细网格的延拓算子 $P$ 为在粗网格节点间的分段线性插值，即，对于任何精细网格索引 $n = j r + s$（其中 $s \\in \\{0, 1, \\dots, r-1\\}$），\n$$\nP(Ru)(x_{n}) = \\left(1 - \\frac{s}{r}\\right) \\, Ru(x_{j r}) + \\frac{s}{r} \\, Ru(x_{(j+1) r}) ,\n$$\n其中 $j+1$ 采用周期性索引。往返算子为 $E = I - P R$，其中 $I$ 是作用于 $u$ 的精细网格样本上的单位映射。\n\n您的任务是提出一个与加密无关的验证测试：对于任意 $r$，将 $E$ 应用于一个在精细网格上采样的、二次连续可微的、周期性的、无量纲的应变场 $u \\in C^{2}_{\\mathrm{per}}([0,L])$，并评估在精细网格上的往返误差范数 $\\|E u\\|$。从插值理论的基本原理和带余项的泰勒定理出发，推导出一个形式为\n$$\n\\|E u\\|_{L^{\\infty}} \\leq C \\, \\|u''\\|_{L^{\\infty}},\n$$\n的界，该界只依赖于粗网格间距 $h_{c}$，而不另外依赖于加密因子 $r$，从而使该测试与加密无关。请确定在指定的 $R$ 和 $P$ 算子下，对所有 $u \\in C^{2}_{\\mathrm{per}}([0,L])$ 和所有 $r \\geq 2$ 一致成立的最小常数 $C$。\n\n您的最终答案必须是这个最优常数 $C$ 的单个闭式解析表达式，用 $h_{c}$ 表示。不需要进行数值四舍五入，最终表达式中不应包含任何单位。",
            "solution": "任务是找到用粗网格间距 $h_c$ 表示的最小常数 $C$，使得不等式 $\\|E u\\|_{L^{\\infty}} \\leq C \\|u''\\|_{L^{\\infty}}$ 对任何二次连续可微的周期函数 $u(x)$ 和任何整数加密因子 $r \\geq 2$ 均成立。\n\n往返算子为 $E = I - P R$，其中 $I$ 是精细网格上的单位算子，$R$ 是通过注入实现的限制，$P$ 是通过分段线性插值实现的延拓。在精细网格点 $x_n$ 上的误差由 $e(x_n) = (Eu)(x_n) = u(x_n) - (PRu)(x_n)$ 给出。\n\n算子 $PR$ 首先在粗网格节点 $x_{jr}$ 处对 $u$ 进行采样，然后将这些值线性插值回精细网格。因此，对于位于粗网格区间 $[x_{jr}, x_{(j+1)r}]$ 内的任何精细网格点 $x_n$，值 $(PRu)(x_n)$ 就是经过点 $(x_{jr}, u(x_{jr}))$ 和 $(x_{(j+1)r}, u(x_{(j+1)r}))$ 的线性多项式 $v(x)$ 的值。误差 $e(x_n) = u(x_n) - v(x_n)$ 是线性插值的标准误差。\n\n对于函数 $u \\in C^2([a,b])$，在点 $x \\in [a,b]$ 的线性插值误差由带余项的泰勒定理给出：\n$$\ne(x) = u(x) - v(x) = \\frac{u''(\\xi)}{2!} (x-a)(x-b)\n$$\n其中某个 $\\xi \\in (a,b)$。\n\n在我们的情境中，我们考虑一个单一的粗网格区间 $[x_j^c, x_{j+1}^c]$，其中 $x_j^c = x_{jr}$。该区间的端点是 $a = x_{jr}$ 和 $b = x_{(j+1)r}$。区间的长度为 $h_c = b-a = (j+1)rh_f - jrh_f = rh_f$。\n\n该区间内的一个精细网格点 $x_n$ 由 $x_n = x_{jr+s} = x_{jr} + s h_f$ 给出，其中 $s \\in \\{0, 1, \\dots, r-1\\}$。$s=0$ 和 $s=r$ 的特殊情况对应于区间端点，在这些点上插值误差为零。对于任何 $s \\in \\{1, \\dots, r-1\\}$，误差 $e(x_n)$ 通常是非零的。\n\n将 $x=x_n$, $a=x_{jr}$, 和 $b=x_{(j+1)r}$ 代入误差公式：\n$$\ne(x_n) = \\frac{u''(\\xi_n)}{2} (x_n - x_{jr}) (x_n - x_{(j+1)r})\n$$\n其中 $\\xi_n \\in (x_{jr}, x_{(j+1)r})$。\n乘积中的项是 $(x_n - x_{jr}) = sh_f$ 和 $(x_n - x_{(j+1)r}) = sh_f - rh_f = (s-r)h_f$。\n因此，在精细网格点 $x_n = x_{jr+s}$ 上的误差是：\n$$\ne(x_{jr+s}) = \\frac{u''(\\xi_n)}{2} s(s-r) h_f^2\n$$\n为了找到在精细网格上误差的 $L^{\\infty}$-范数，我们必须找到 $|e(x_n)|$ 在所有 $n$ 上的最大值。这涉及到在所有粗网格区间 $j$ 和所有精细网格偏移量 $s$ 上求最大值。\n$$\n\\|Eu\\|_{L^\\infty} = \\max_{j,s} |e(x_{jr+s})|\n$$\n对误差表达式取绝对值，并用其全局最大值 $\\|u''\\|_{L^\\infty} = \\sup_{x \\in [0,L]} |u''(x)|$ 来界定 $|u''(\\xi_n)|$，我们得到：\n$$\n|e(x_{jr+s})| \\leq \\frac{\\|u''\\|_{L^\\infty}}{2} |s(s-r)| h_f^2 = \\frac{\\|u''\\|_{L^\\infty}}{2} s(r-s) h_f^2\n$$\n其中 $s \\in \\{0, 1, \\dots, r-1\\}$。\n\n问题简化为求二次函数 $f(s) = s(r-s)$ 在整数 $s \\in \\{0, 1, \\dots, r-1\\}$ 范围内的最大值。这是一个开口向下的抛物线，根在 $s=0$ 和 $s=r$ 处，顶点在 $s=r/2$ 处。\n如果 $r$ 是偶数，$r=2k$（对于某个整数 $k \\geq 1$），那么 $s=r/2 = k$ 是允许范围内的整数。最大值为 $f(k) = k(2k-k) = k^2 = (r/2)^2 = r^2/4$。\n如果 $r$ 是奇数，$r=2k+1$（对于某个整数 $k \\geq 1$），那么 $s=r/2$ 不是整数。对于整数 $s$，最大值将出现在最接近 $r/2$ 的两个整数处，即 $s=k$ 和 $s=k+1$。其值为 $f(k)=k(2k+1-k) = k(k+1)$，以及 $f(k+1)=(k+1)(2k+1-(k+1))=(k+1)k$。用 $r$ 表示，$k=(r-1)/2$ 且 $k+1=(r+1)/2$，所以最大值为 $\\frac{r-1}{2} \\frac{r+1}{2} = \\frac{r^2-1}{4}$。\n总的来说，$s(r-s)$ 在 $s \\in \\{0, 1, \\dots, r-1\\}$ 上的最大值是 $\\lfloor r/2 \\rfloor \\lceil r/2 \\rceil$。\n\n所以，对于一个固定的 $r$，我们有如下的紧致界：\n$$\n\\|Eu\\|_{L^\\infty} \\leq \\frac{\\|u''\\|_{L^\\infty}}{2} \\left( \\lfloor \\frac{r}{2} \\rfloor \\lceil \\frac{r}{2} \\rceil \\right) h_f^2\n$$\n问题要求该界用 $h_c = rh_f$ 表示，所以 $h_f = h_c/r$。代入此式可得：\n$$\n\\|Eu\\|_{L^\\infty} \\leq \\frac{\\|u''\\|_{L^\\infty}}{2} \\left( \\lfloor \\frac{r}{2} \\rfloor \\lceil \\frac{r}{2} \\rceil \\right) \\left(\\frac{h_c}{r}\\right)^2 = \\|u''\\|_{L^\\infty} \\frac{h_c^2}{2} \\left( \\frac{\\lfloor r/2 \\rfloor \\lceil r/2 \\rceil}{r^2} \\right)\n$$\n这给出了一个常数 $C(r, h_c) = \\frac{h_c^2}{2} \\frac{\\lfloor r/2 \\rfloor \\lceil r/2 \\rceil}{r^2}$。然而，问题要求的是一个与 $r$ 无关且对所有 $r \\geq 2$ 都有效的单一常数 $C$。为了找到这样一个常数，我们必须对所有有效的 $r$ 取此表达式的上确界：\n$$\nC = \\sup_{r \\geq 2, r \\in \\mathbb{Z}} \\left[ \\frac{h_c^2}{2} \\left( \\frac{\\lfloor r/2 \\rfloor \\lceil r/2 \\rceil}{r^2} \\right) \\right] = \\frac{h_c^2}{2} \\sup_{r \\geq 2, r \\in \\mathbb{Z}} \\left[ \\frac{\\lfloor r/2 \\rfloor \\lceil r/2 \\rceil}{r^2} \\right]\n$$\n我们来分析一下 $K(r) = \\frac{\\lfloor r/2 \\rfloor \\lceil r/2 \\rceil}{r^2}$ 这一项：\n如果 $r=2k$ 为偶数（$k \\geq 1$）：$K(2k) = \\frac{k \\cdot k}{(2k)^2} = \\frac{k^2}{4k^2} = \\frac{1}{4}$。\n如果 $r=2k+1$ 为奇数（$k \\geq 1$）：$K(2k+1) = \\frac{k(k+1)}{(2k+1)^2} = \\frac{k^2+k}{4k^2+4k+1}$。\n我们将奇数情况与 1/4 进行比较：\n$$\n\\frac{1}{4} - K(2k+1) = \\frac{1}{4} - \\frac{k^2+k}{4k^2+4k+1} = \\frac{(4k^2+4k+1) - 4(k^2+k)}{4(4k^2+4k+1)} = \\frac{1}{4(2k+1)^2}  0\n$$\n因此，对于所有奇数 $r$，$K(r)  1/4$；对于所有偶数 $r$，$K(r) = 1/4$。在所有整数 $r \\geq 2$ 上的上确界是：\n$$\n\\sup_{r \\geq 2, r \\in \\mathbb{Z}} K(r) = \\frac{1}{4}\n$$\n对于任何偶数 $r \\geq 2$，都可以达到这个上确界。\n\n将此值代回 $C$ 的表达式中：\n$$\nC = \\frac{h_c^2}{2} \\left(\\frac{1}{4}\\right) = \\frac{h_c^2}{8}\n$$\n这是对所有 $u \\in C^2_{\\mathrm{per}}$ 和所有 $r \\geq 2$ 满足该不等式的最小可能常数 $C$。为了确认这是最小的，我们注意到这个界是可以达到的。对于任何偶数 $r$，最大误差在粗网格区间的中点 $s=r/2$ 处达到。我们可以构造一个局部是二次的周期函数 $u(x)$（例如，在 $[0, h_c]$ 上 $u(x) = \\frac{1}{2} M x^2$ 并进行适当延拓），对于该函数 $\\|u''\\|_{L^\\infty} \\approx |M|$，且在 $x=h_c/2$ 处的误差趋近于 $\\frac{|M|h_c^2}{8}$。因此，对所有函数 $u$ 和加密因子 $r$ 的上确界可导出这个常数。\n\n最终的常数是 $C = \\frac{h_c^2}{8}$。",
            "answer": "$$\\boxed{\\frac{h_c^2}{8}}$$"
        }
    ]
}