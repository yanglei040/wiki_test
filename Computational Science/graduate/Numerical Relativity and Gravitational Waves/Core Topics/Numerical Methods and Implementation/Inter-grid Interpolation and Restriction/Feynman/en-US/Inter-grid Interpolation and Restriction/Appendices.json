{
    "hands_on_practices": [
        {
            "introduction": "The accuracy of numerical simulations using Adaptive Mesh Refinement (AMR) is critically dependent on the quality of the operators that transfer data between grids. A powerful and fundamental method for creating high-precision operators is to require that they exactly reproduce simple functions, such as polynomials, up to a certain degree. This exercise guides you through the first-principles construction of a fourth-order prolongation operator, providing concrete insight into how the formal order of accuracy is achieved in practice .",
            "id": "3477765",
            "problem": "Consider an Adaptive Mesh Refinement (AMR) hierarchy used in the Baumgarte–Shapiro–Shibata–Nakamura (BSSN) formulation in numerical relativity to evolve the spacetime metric and curvature near a binary black hole coalescence. Let a coarse level have uniform cell spacing $H$ and cell-centered samples of a smooth scalar field $\\phi(x)$ representing, for example, a gauge-invariant gravitational-wave extraction scalar on that level. A fine level is introduced with refinement ratio $r=2$, so its spacing is $h=H/2$, and its cell centers lie at offsets $\\pm H/4$ from each coarse cell center within each coarse cell.\n\nYour task is to construct, from first principles, a fourth-order tensor-product polynomial prolongation operator that maps coarse cell-centered data to fine cell centers and is exact for polynomials up to degree three. Work in one spatial dimension to derive the canonical one-dimensional stencil that serves as the building block for the tensor-product operator in higher dimensions.\n\nSpecifically, determine the four-point one-dimensional interpolation weights for the fine cell center located at offset $+H/4$ relative to a coarse cell center at position $x_i$. The interpolated fine value $\\phi^{f}$ at $x_i + H/4$ must be written as a linear combination of the four neighboring coarse cell-centered values $\\{\\phi_{i-1}, \\phi_i, \\phi_{i+1}, \\phi_{i+2}\\}$ such that the operator reproduces exactly any polynomial $\\phi(x)$ of degree up to three. Express your final answer as a row vector of the four coefficients in the order corresponding to $\\{\\phi_{i-1}, \\phi_i, \\phi_{i+1}, \\phi_{i+2}\\}$.\n\nNo numerical rounding is required. The final answer must be a single analytical expression.",
            "solution": "The problem requires the construction of a one-dimensional, fourth-order polynomial prolongation operator to interpolate data from a coarse grid with spacing $H$ to a specific fine grid point. The interpolated value at the fine point, which we denote as $\\phi^f$, is to be expressed as a linear combination of values from four specified neighboring coarse grid points. The operator must be exact for any polynomial of degree up to $3$, which implies its local truncation error is of order $\\mathcal{O}(H^4)$, consistent with a fourth-order method.\n\nLet the coarse grid points be located at positions $x_j = jH$ for any integer $j$. The values of a scalar field $\\phi(x)$ at these points are denoted $\\phi_j = \\phi(x_j)$. The specific task is to find the interpolated value at a fine grid point located at $x_f = x_i + H/4$ for a given coarse cell index $i$. The interpolation formula is specified to use the four coarse grid values from the points with indices $\\{i-1, i, i+1, i+2\\}$.\n\nThe interpolation formula is a linear combination of these coarse grid values:\n$$ \\phi^f = c_{-1} \\phi_{i-1} + c_0 \\phi_i + c_1 \\phi_{i+1} + c_2 \\phi_{i+2} $$\nThe coefficients $\\{c_{-1}, c_0, c_1, c_2\\}$ are the unknown weights that define the interpolation stencil.\n\nTo simplify the derivation without loss of generality, we can establish a local coordinate system by setting $x_i = 0$. The positions of the coarse grid points involved in the stencil are then:\n$$ x_{i-1} = -H, \\quad x_i = 0, \\quad x_{i+1} = H, \\quad x_{i+2} = 2H $$\nThe target fine point is located at $x_f = x_i + H/4 = H/4$.\n\nThe fundamental constraint is that the interpolation must be exact for any polynomial of degree up to $3$. This means that if $\\phi(x)$ is such a polynomial, then the formula must yield exactly $\\phi(x_f)$. We can enforce this condition by requiring the formula to be exact for a basis of the vector space of polynomials of degree at most $3$. The monomial basis $\\{1, x, x^2, x^3\\}$ is a convenient choice.\n\nWe apply this condition for each basis polynomial:\n\n1.  For $\\phi(x) = 1$:\n    The value of the function is $1$ at all points. The interpolation formula must reproduce this constant value.\n    $$ 1 = c_{-1}\\phi(-H) + c_0\\phi(0) + c_1\\phi(H) + c_2\\phi(2H) = c_{-1}(1) + c_0(1) + c_1(1) + c_2(1) $$\n    This gives our first linear equation:\n    $$ c_{-1} + c_0 + c_1 + c_2 = 1 \\quad (1) $$\n\n2.  For $\\phi(x) = x$:\n    The values at the coarse points are $\\phi(x_j) = x_j$. The value at the fine point to be recovered is $\\phi(x_f) = x_f = H/4$.\n    $$ \\frac{H}{4} = c_{-1}(-H) + c_0(0) + c_1(H) + c_2(2H) $$\n    Assuming $H \\neq 0$, we can divide by $H$:\n    $$ -c_{-1} + c_1 + 2c_2 = \\frac{1}{4} \\quad (2) $$\n\n3.  For $\\phi(x) = x^2$:\n    The values are given by $\\phi(x_j) = x_j^2$. The value at the fine point is $\\phi(x_f) = x_f^2 = (H/4)^2 = H^2/16$.\n    $$ \\frac{H^2}{16} = c_{-1}(-H)^2 + c_0(0)^2 + c_1(H)^2 + c_2(2H)^2 = c_{-1}H^2 + c_1H^2 + 4c_2H^2 $$\n    Dividing by $H^2$:\n    $$ c_{-1} + c_1 + 4c_2 = \\frac{1}{16} \\quad (3) $$\n\n4.  For $\\phi(x) = x^3$:\n    The values are given by $\\phi(x_j) = x_j^3$. The value at the fine point is $\\phi(x_f) = x_f^3 = (H/4)^3 = H^3/64$.\n    $$ \\frac{H^3}{64} = c_{-1}(-H)^3 + c_0(0)^3 + c_1(H)^3 + c_2(2H)^3 = -c_{-1}H^3 + c_1H^3 + 8c_2H^3 $$\n    Dividing by $H^3$:\n    $$ -c_{-1} + c_1 + 8c_2 = \\frac{1}{64} \\quad (4) $$\n\nWe have obtained a system of four linear equations for the four unknown coefficients $\\{c_{-1}, c_0, c_1, c_2\\}$. We can solve this system. Let's first focus on equations $(2)$, $(3)$, and $(4)$, which form a subsystem for $c_{-1}$, $c_1$, and $c_2$.\nSubtracting equation $(2)$ from equation $(4)$:\n$$ (-c_{-1} + c_1 + 8c_2) - (-c_{-1} + c_1 + 2c_2) = \\frac{1}{64} - \\frac{1}{4} $$\n$$ 6c_2 = \\frac{1 - 16}{64} = -\\frac{15}{64} $$\n$$ c_2 = -\\frac{15}{6 \\times 64} = -\\frac{5}{2 \\times 64} = -\\frac{5}{128} $$\n\nNow, substitute the value of $c_2$ into equations $(2)$ and $(3)$.\nFrom equation $(3)$:\n$$ c_{-1} + c_1 = \\frac{1}{16} - 4c_2 = \\frac{1}{16} - 4\\left(-\\frac{5}{128}\\right) = \\frac{1}{16} + \\frac{20}{128} = \\frac{8}{128} + \\frac{20}{128} = \\frac{28}{128} = \\frac{7}{32} \\quad (A) $$\nFrom equation $(2)$:\n$$ -c_{-1} + c_1 = \\frac{1}{4} - 2c_2 = \\frac{1}{4} - 2\\left(-\\frac{5}{128}\\right) = \\frac{1}{4} + \\frac{10}{128} = \\frac{32}{128} + \\frac{10}{128} = \\frac{42}{128} = \\frac{21}{64} \\quad (B) $$\n\nWe now solve the system of two equations $(A)$ and $(B)$ for $c_{-1}$ and $c_1$. Adding $(A)$ and $(B)$:\n$$ (c_{-1} + c_1) + (-c_{-1} + c_1) = \\frac{7}{32} + \\frac{21}{64} $$\n$$ 2c_1 = \\frac{14}{64} + \\frac{21}{64} = \\frac{35}{64} \\implies c_1 = \\frac{35}{128} $$\nSubstituting $c_1$ back into equation $(A)$:\n$$ c_{-1} = \\frac{7}{32} - c_1 = \\frac{7}{32} - \\frac{35}{128} = \\frac{28}{128} - \\frac{35}{128} = -\\frac{7}{128} $$\n\nFinally, we use equation $(1)$ to determine $c_0$:\n$$ c_0 = 1 - (c_{-1} + c_1 + c_2) = 1 - \\left(-\\frac{7}{128} + \\frac{35}{128} - \\frac{5}{128}\\right) $$\n$$ c_0 = 1 - \\left(\\frac{-7 + 35 - 5}{128}\\right) = 1 - \\frac{23}{128} = \\frac{128 - 23}{128} = \\frac{105}{128} $$\n\nThe four interpolation weights for the stencil are therefore:\n$$ c_{-1} = -\\frac{7}{128}, \\quad c_0 = \\frac{105}{128}, \\quad c_1 = \\frac{35}{128}, \\quad c_2 = -\\frac{5}{128} $$\nThe problem requests the final answer as a row vector of these coefficients.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-\\frac{7}{128} & \\frac{105}{128} & \\frac{35}{128} & -\\frac{5}{128}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "While polynomial exactness guarantees accuracy for smooth, slowly varying fields, it is equally important to understand how operators behave on wave-like data, which is central to studying gravitational waves. By employing discrete Fourier analysis, we can translate the action of an operator into the frequency domain, revealing how it amplifies, dampens, or aliases different modes. This practice delves into the Fourier analysis of a linear interpolation operator, quantifying its effect on high-frequency content and providing a deeper understanding of numerical stability and phase accuracy .",
            "id": "3477729",
            "problem": "In numerical relativity simulations of binary black hole mergers employing Adaptive Mesh Refinement (AMR), inter-grid operators must preserve phase information of propagating gravitational wave content encoded in metric variables. Consider a one-dimensional, vertex-centered, uniform grid hierarchy with coarse-grid spacing $H$ and fine-grid spacing $h$ satisfying $H=2h$. Let $j \\in \\mathbb{Z}$ index coarse-grid vertices at positions $x_{j} = j H$ and $k \\in \\mathbb{Z}$ index fine-grid vertices at positions $x_{k} = k h$. The linear interpolation (prolongation) operator $P$ maps coarse-grid data $u_{j}$ to fine-grid data $v_{k}$ by exact injection on coincident vertices and centered averaging on intermediate vertices, namely $v_{2j} = u_{j}$ and $v_{2j+1} = \\frac{1}{2} \\left( u_{j} + u_{j+1} \\right)$. Using discrete Fourier analysis and taking angles in radians, define the coarse-grid Fourier mode by $u_{j} = \\exp\\!\\big( \\mathrm{i}\\, \\theta\\, j \\big)$ with $\\theta \\in [-\\pi,\\pi]$. Treat the fine-grid representation in the standard two-harmonic subspace spanned by the fine-grid phases $\\varrho = \\theta/2$ and $\\varrho + \\pi$, which is the aliasing pair associated with the $2{:}1$ refinement. Starting only from the definitions above and the properties of the complex exponential, derive the Fourier symbol (the two-component coefficient vector) of the prolongation operator $P$ that maps the coarse-grid mode amplitude to the amplitudes of the two fine-grid harmonics $\\exp\\!\\big( \\mathrm{i}\\, \\varrho\\, k \\big)$ and $\\exp\\!\\big( \\mathrm{i}\\, (\\varrho + \\pi)\\, k \\big)$. Then, quantify the amplification of the coarse-grid Nyquist mode by computing the Euclidean norm of this two-component symbol at $\\theta = \\pi$. Provide your final answer as the two components of the symbol as functions of $\\theta$ and the single real number for the Nyquist-mode amplification. No rounding is required.",
            "solution": "The problem requires the derivation of the Fourier symbol for a linear interpolation (prolongation) operator used in Adaptive Mesh Refinement (AMR) and the subsequent calculation of its amplification effect on the Nyquist mode.\n\n### Derivation of the Fourier Symbol\n\nOur goal is to find the coefficients $\\hat{P}_0(\\theta)$ and $\\hat{P}_1(\\theta)$ such that the action of the prolongation operator $P$ on the coarse-grid mode $u_j = \\exp(\\mathrm{i}\\theta j)$ yields a fine-grid function $v_k$ of the form:\n$$ v_k = \\hat{P}_0(\\theta) \\exp(\\mathrm{i} \\varrho k) + \\hat{P}_1(\\theta) \\exp(\\mathrm{i} (\\varrho + \\pi) k) $$\nwhere $\\varrho = \\theta/2$.\n\nThe second basis function can be simplified using the identity $\\exp(\\mathrm{i}\\pi) = -1$:\n$$ \\exp(\\mathrm{i} (\\varrho + \\pi) k) = \\exp(\\mathrm{i}\\varrho k) \\exp(\\mathrm{i}\\pi k) = \\exp(\\mathrm{i}\\varrho k) (\\exp(\\mathrm{i}\\pi))^k = (-1)^k \\exp(\\mathrm{i}\\varrho k) $$\nThus, the expression for $v_k$ becomes:\n$$ v_k = \\left( \\hat{P}_0(\\theta) + (-1)^k \\hat{P}_1(\\theta) \\right) \\exp(\\mathrm{i}\\varrho k) $$\n\nWe now apply the definition of the operator $P$ to the input mode $u_j = \\exp(\\mathrm{i}\\theta j)$ to find expressions for $v_k$. We must consider two cases based on the parity of the fine-grid index $k$.\n\n**Case 1: $k$ is even.**\nLet $k=2j$. The operator rule is $v_{2j} = u_j$.\nSubstituting the input mode and relating the indices ($j=k/2$) and phases ($\\theta = 2\\varrho$):\n$$ v_k = v_{2j} = u_j = \\exp(\\mathrm{i}\\theta j) = \\exp(\\mathrm{i}(2\\varrho) (k/2)) = \\exp(\\mathrm{i}\\varrho k) $$\nComparing this with the general form for even $k$ (where $(-1)^k=1$):\n$$ v_k = (\\hat{P}_0(\\theta) + \\hat{P}_1(\\theta)) \\exp(\\mathrm{i}\\varrho k) $$\nwe obtain our first equation:\n$$ \\hat{P}_0(\\theta) + \\hat{P}_1(\\theta) = 1 $$\n\n**Case 2: $k$ is odd.**\nLet $k=2j+1$. The operator rule is $v_{2j+1} = \\frac{1}{2}(u_j + u_{j+1})$.\nSubstituting the input mode:\n$$ v_{2j+1} = \\frac{1}{2} \\left( \\exp(\\mathrm{i}\\theta j) + \\exp(\\mathrm{i}\\theta (j+1)) \\right) = \\frac{1}{2} \\exp(\\mathrm{i}\\theta j) (1 + \\exp(\\mathrm{i}\\theta)) $$\nWe can relate $j$ to the odd index $k$ by $j = (k-1)/2$. Substituting this and $\\theta=2\\varrho$:\n$$ v_k = \\frac{1}{2} \\exp\\left(\\mathrm{i}(2\\varrho) \\frac{k-1}{2}\\right) (1 + \\exp(\\mathrm{i}2\\varrho)) = \\frac{1}{2} \\exp(\\mathrm{i}\\varrho(k-1)) (1 + \\exp(\\mathrm{i}2\\varrho)) $$\nUsing the identity $1+\\exp(\\mathrm{i}2\\varrho) = \\exp(\\mathrm{i}\\varrho)(\\exp(-\\mathrm{i}\\varrho)+\\exp(\\mathrm{i}\\varrho)) = 2\\exp(\\mathrm{i}\\varrho)\\cos(\\varrho)$:\n$$ v_k = \\frac{1}{2} \\exp(\\mathrm{i}\\varrho k - \\mathrm{i}\\varrho) \\cdot (2\\exp(\\mathrm{i}\\varrho)\\cos(\\varrho)) = \\exp(\\mathrm{i}\\varrho k) \\cos(\\varrho) $$\nComparing this result with the general form for odd $k$ (where $(-1)^k=-1$):\n$$ v_k = (\\hat{P}_0(\\theta) - \\hat{P}_1(\\theta)) \\exp(\\mathrm{i}\\varrho k) $$\nwe obtain our second equation:\n$$ \\hat{P}_0(\\theta) - \\hat{P}_1(\\theta) = \\cos(\\varrho) = \\cos(\\theta/2) $$\n\n**Solving for the symbol components.**\nWe now have a system of two linear equations for $\\hat{P}_0(\\theta)$ and $\\hat{P}_1(\\theta)$:\n$$ \\begin{cases} \\hat{P}_0(\\theta) + \\hat{P}_1(\\theta) = 1 \\\\ \\hat{P}_0(\\theta) - \\hat{P}_1(\\theta) = \\cos(\\theta/2) \\end{cases} $$\nAdding the two equations gives:\n$$ 2\\hat{P}_0(\\theta) = 1 + \\cos(\\theta/2) $$\nUsing the half-angle identity $1+\\cos(\\alpha) = 2\\cos^2(\\alpha/2)$, with $\\alpha = \\theta/2$:\n$$ \\hat{P}_0(\\theta) = \\frac{1 + \\cos(\\theta/2)}{2} = \\cos^2(\\theta/4) $$\nSubtracting the second equation from the first gives:\n$$ 2\\hat{P}_1(\\theta) = 1 - \\cos(\\theta/2) $$\nUsing the half-angle identity $1-\\cos(\\alpha) = 2\\sin^2(\\alpha/2)$, with $\\alpha = \\theta/2$:\n$$ \\hat{P}_1(\\theta) = \\frac{1 - \\cos(\\theta/2)}{2} = \\sin^2(\\theta/4) $$\nThus, the Fourier symbol of the prolongation operator $P$ is the vector $(\\cos^2(\\theta/4), \\sin^2(\\theta/4))$.\n\n### Nyquist Mode Amplification\n\nThe second task is to quantify the amplification of the coarse-grid Nyquist mode, which corresponds to the highest representable frequency on the coarse grid. For the phase domain $\\theta \\in [-\\pi, \\pi]$, the Nyquist mode occurs at $\\theta = \\pi$.\nWe evaluate the symbol components at $\\theta = \\pi$:\n$$ \\hat{P}_0(\\pi) = \\cos^2(\\pi/4) = \\left(\\frac{\\sqrt{2}}{2}\\right)^2 = \\frac{2}{4} = \\frac{1}{2} $$\n$$ \\hat{P}_1(\\pi) = \\sin^2(\\pi/4) = \\left(\\frac{\\sqrt{2}}{2}\\right)^2 = \\frac{2}{4} = \\frac{1}{2} $$\nThe symbol vector at the Nyquist frequency is $(\\frac{1}{2}, \\frac{1}{2})$.\nThe amplification is defined as the Euclidean norm of this vector:\n$$ \\| (\\hat{P}_0(\\pi), \\hat{P}_1(\\pi)) \\|_2 = \\sqrt{ \\left(\\frac{1}{2}\\right)^2 + \\left(\\frac{1}{2}\\right)^2 } = \\sqrt{\\frac{1}{4} + \\frac{1}{4}} = \\sqrt{\\frac{2}{4}} = \\sqrt{\\frac{1}{2}} = \\frac{1}{\\sqrt{2}} = \\frac{\\sqrt{2}}{2} $$\nThe amplification of the coarse-grid Nyquist mode is $\\frac{\\sqrt{2}}{2}$.\n\nThe final answer consists of the two components of the symbol and this amplification factor.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\cos^2\\left(\\frac{\\theta}{4}\\right) & \\sin^2\\left(\\frac{\\theta}{4}\\right) & \\frac{\\sqrt{2}}{2}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "A powerful verification technique for AMR codes is the \"round-trip\" test, where data is restricted to a coarser grid and immediately prolongated back to the fine grid. The discrepancy between the original and round-tripped data is a direct measure of the information lost during the inter-grid transfer process. This exercise utilizes Taylor's theorem to derive a rigorous analytical bound on this round-trip error, connecting the performance of the numerical scheme to the grid resolution and the physical smoothness of the solution being simulated .",
            "id": "3477759",
            "problem": "Consider a one-dimensional, periodic worldtube of circumference $L$ on which the dimensionless gravitational-wave strain field $u(x)$ is sampled for numerical relativity simulations that employ Adaptive Mesh Refinement (AMR). Let the finest uniform grid have spacing $h_{f}$ with nodes $x_{n} = n h_{f}$ for $n = 0, 1, \\dots, N-1$, where $N h_{f} = L$, and let a coarser grid have spacing $h_{c} = r h_{f}$ for an integer refinement factor $r \\geq 2$. Define the restriction operator $R$ from the fine grid to the coarse grid by pointwise injection at the coarse nodes, i.e., $R u (x_{jr}) = u(x_{jr})$ for $j = 0, 1, \\dots, N/r - 1$. Define the prolongation operator $P$ from the coarse grid back to the fine grid by piecewise linear interpolation between coarse nodes, i.e., for any fine index $n = j r + s$ with $s \\in \\{0, 1, \\dots, r-1\\}$,\n$$\nP(Ru)(x_{n}) = \\left(1 - \\frac{s}{r}\\right) \\, Ru(x_{j r}) + \\frac{s}{r} \\, Ru(x_{(j+1) r}) ,\n$$\nwith periodic indexing for $j+1$. The round-trip operator is $E = I - P R$, where $I$ is the identity map on fine-grid samples of $u$.\n\nYou are tasked to propose a refinement-agnostic verification test: for any $r$, apply $E$ to a twice continuously differentiable, periodic, dimensionless strain field $u \\in C^{2}_{\\mathrm{per}}([0,L])$ sampled on the fine grid, and assess the round-trip error norm $\\|E u\\|$ on the fine grid. Starting from first principles of interpolation theory and Taylor’s theorem with remainder, derive a bound of the form\n$$\n\\|E u\\|_{L^{\\infty}} \\leq C \\, \\|u''\\|_{L^{\\infty}},\n$$\nthat depends only on the coarse spacing $h_{c}$ and not on the refinement factor $r$ separately, thereby making the test refinement-agnostic. Identify the smallest such constant $C$ that holds uniformly for all $u \\in C^{2}_{\\mathrm{per}}([0,L])$ and all $r \\geq 2$ under the specified $R$ and $P$.\n\nYour final answer must be the single closed-form analytic expression for this optimal constant $C$, expressed in terms of $h_{c}$. No numerical rounding is required, and no units should be included in the final expression.",
            "solution": "The task is to find the smallest constant $C$, expressed in terms of the coarse grid spacing $h_c$, such that the inequality $\\|E u\\|_{L^{\\infty}} \\leq C \\|u''\\|_{L^{\\infty}}$ holds for any twice continuously differentiable, periodic function $u(x)$ and any integer refinement factor $r \\geq 2$.\n\nThe round-trip operator is $E = I - P R$, where $I$ is the identity operator on the fine grid, $R$ is restriction by injection, and $P$ is prolongation by piecewise linear interpolation. The error at a fine-grid point $x_n$ is given by $e(x_n) = (Eu)(x_n) = u(x_n) - (PRu)(x_n)$.\n\nThe operator $PR$ first samples $u$ at the coarse-grid nodes $x_{jr}$ and then linearly interpolates these values back to the fine grid. Thus, for any fine-grid point $x_n$ lying within a coarse-grid interval $[x_{jr}, x_{(j+1)r}]$, the value $(PRu)(x_n)$ is simply the value of the linear polynomial $v(x)$ that passes through the points $(x_{jr}, u(x_{jr}))$ and $(x_{(j+1)r}, u(x_{(j+1)r}))$. The error $e(x_n) = u(x_n) - v(x_n)$ is the standard error of linear interpolation.\n\nFor a function $u \\in C^2([a,b])$, the error of linear interpolation at a point $x \\in [a,b]$ is given by Taylor's theorem with remainder:\n$$\ne(x) = u(x) - v(x) = \\frac{u''(\\xi)}{2!} (x-a)(x-b)\n$$\nfor some $\\xi \\in (a,b)$.\n\nIn our context, let's consider a single coarse interval $[x_j^c, x_{j+1}^c]$, where $x_j^c = x_{jr}$. The endpoints of this interval are $a = x_{jr}$ and $b = x_{(j+1)r}$. The length of the interval is $h_c = b-a = (j+1)rh_f - jrh_f = rh_f$.\n\nA fine-grid point $x_n$ within this interval is given by $x_n = x_{jr+s} = x_{jr} + s h_f$, where $s \\in \\{0, 1, \\dots, r-1\\}$. The special cases $s=0$ and $s=r$ correspond to the interval endpoints, where the interpolation error is zero. For any $s \\in \\{1, \\dots, r-1\\}$, the error $e(x_n)$ is non-zero in general.\n\nSubstituting $x=x_n$, $a=x_{jr}$, and $b=x_{(j+1)r}$ into the error formula:\n$$\ne(x_n) = \\frac{u''(\\xi_n)}{2} (x_n - x_{jr}) (x_n - x_{(j+1)r})\n$$\nwhere $\\xi_n \\in (x_{jr}, x_{(j+1)r})$.\nThe terms in the product are $(x_n - x_{jr}) = sh_f$ and $(x_n - x_{(j+1)r}) = sh_f - rh_f = (s-r)h_f$.\nThus, the error at the fine point $x_n = x_{jr+s}$ is:\n$$\ne(x_{jr+s}) = \\frac{u''(\\xi_n)}{2} s(s-r) h_f^2\n$$\nTo find the $L^{\\infty}$-norm of the error over the fine grid, we must find the maximum of $|e(x_n)|$ over all $n$. This involves maximizing over all coarse intervals $j$ and all fine-grid offsets $s$.\n$$\n\\|Eu\\|_{L^\\infty} = \\max_{j,s} |e(x_{jr+s})|\n$$\nTaking the absolute value of the error expression and bounding $|u''(\\xi_n)|$ by its global maximum, $\\|u''\\|_{L^\\infty} = \\sup_{x \\in [0,L]} |u''(x)|$, we get:\n$$\n|e(x_{jr+s})| \\leq \\frac{\\|u''\\|_{L^\\infty}}{2} |s(s-r)| h_f^2 = \\frac{\\|u''\\|_{L^\\infty}}{2} s(r-s) h_f^2\n$$\nfor $s \\in \\{0, 1, \\dots, r-1\\}$.\n\nThe problem reduces to finding the maximum value of the quadratic function $f(s) = s(r-s)$ for integer values of $s$ in the range $s \\in \\{0, 1, \\dots, r-1\\}$. This is a downward-opening parabola with roots at $s=0$ and $s=r$, and its vertex is at $s=r/2$.\nIf $r$ is an even integer, $r=2k$ for some integer $k \\geq 1$, then $s=r/2 = k$ is an integer in the allowed range. The maximum value is $f(k) = k(2k-k) = k^2 = (r/2)^2 = r^2/4$.\nIf $r$ is an odd integer, $r=2k+1$ for some integer $k \\geq 1$, then $s=r/2$ is not an integer. The maximum for integer $s$ will occur at the two integers closest to $r/2$, which are $s=k$ and $s=k+1$. The value is $f(k)=k(2k+1-k) = k(k+1)$, and $f(k+1)=(k+1)(2k+1-(k+1))=(k+1)k$. In terms of $r$, $k=(r-1)/2$ and $k+1=(r+1)/2$, so the maximum value is $\\frac{r-1}{2} \\frac{r+1}{2} = \\frac{r^2-1}{4}$.\nIn general, the maximum value of $s(r-s)$ for $s \\in \\{0, 1, \\dots, r-1\\}$ is $\\lfloor r/2 \\rfloor \\lceil r/2 \\rceil$.\n\nSo, for a fixed $r$, we have the sharp bound:\n$$\n\\|Eu\\|_{L^\\infty} \\leq \\frac{\\|u''\\|_{L^\\infty}}{2} \\left( \\lfloor \\frac{r}{2} \\rfloor \\lceil \\frac{r}{2} \\rceil \\right) h_f^2\n$$\nThe problem requires the bound to be expressed in terms of $h_c = rh_f$, so $h_f = h_c/r$. Substituting this gives:\n$$\n\\|Eu\\|_{L^\\infty} \\leq \\frac{\\|u''\\|_{L^\\infty}}{2} \\left( \\lfloor \\frac{r}{2} \\rfloor \\lceil \\frac{r}{2} \\rceil \\right) \\left(\\frac{h_c}{r}\\right)^2 = \\|u''\\|_{L^\\infty} \\frac{h_c^2}{2} \\left( \\frac{\\lfloor r/2 \\rfloor \\lceil r/2 \\rceil}{r^2} \\right)\n$$\nThis gives a constant $C(r, h_c) = \\frac{h_c^2}{2} \\frac{\\lfloor r/2 \\rfloor \\lceil r/2 \\rceil}{r^2}$. However, the problem asks for a single constant $C$ that is independent of $r$ and valid for all $r \\geq 2$. To find such a constant, we must take the supremum of this expression over all valid $r$:\n$$\nC = \\sup_{r \\geq 2, r \\in \\mathbb{Z}} \\left[ \\frac{h_c^2}{2} \\left( \\frac{\\lfloor r/2 \\rfloor \\lceil r/2 \\rceil}{r^2} \\right) \\right] = \\frac{h_c^2}{2} \\sup_{r \\geq 2, r \\in \\mathbb{Z}} \\left[ \\frac{\\lfloor r/2 \\rfloor \\lceil r/2 \\rceil}{r^2} \\right]\n$$\nLet's analyze the term $K(r) = \\frac{\\lfloor r/2 \\rfloor \\lceil r/2 \\rceil}{r^2}$:\nIf $r=2k$ is even ($k \\geq 1$): $K(2k) = \\frac{k \\cdot k}{(2k)^2} = \\frac{k^2}{4k^2} = \\frac{1}{4}$.\nIf $r=2k+1$ is odd ($k \\geq 1$): $K(2k+1) = \\frac{k(k+1)}{(2k+1)^2} = \\frac{k^2+k}{4k^2+4k+1}$.\nWe compare the odd case to $1/4$:\n$$\n\\frac{1}{4} - K(2k+1) = \\frac{1}{4} - \\frac{k^2+k}{4k^2+4k+1} = \\frac{(4k^2+4k+1) - 4(k^2+k)}{4(4k^2+4k+1)} = \\frac{1}{4(2k+1)^2} > 0\n$$\nThus, $K(r) < 1/4$ for all odd $r$, and $K(r) = 1/4$ for all even $r$. The supremum over all integers $r \\geq 2$ is:\n$$\n\\sup_{r \\geq 2, r \\in \\mathbb{Z}} K(r) = \\frac{1}{4}\n$$\nThis supremum is achieved for any even integer $r \\geq 2$.\n\nSubstituting this value back into the expression for $C$:\n$$\nC = \\frac{h_c^2}{2} \\left(\\frac{1}{4}\\right) = \\frac{h_c^2}{8}\n$$\nThis is the smallest possible constant $C$ that satisfies the inequality for all $u \\in C^2_{\\mathrm{per}}$ and all $r \\geq 2$. To confirm it is the smallest, we note that the bound is attained. For any even $r$, the maximum error is achieved at the midpoint of a coarse interval, $s=r/2$. We can construct a periodic $u(x)$ that is locally quadratic (e.g., $u(x) = \\frac{1}{2} M x^2$ on $[0, h_c]$ and extended appropriately) for which $\\|u''\\|_{L^\\infty} \\approx |M|$ and the error at $x=h_c/2$ approaches $\\frac{|M|h_c^2}{8}$. Therefore, the supremum over all functions $u$ and refinement factors $r$ leads to this constant.\n\nThe final constant is $C = \\frac{h_c^2}{8}$.",
            "answer": "$$\\boxed{\\frac{h_c^2}{8}}$$"
        }
    ]
}