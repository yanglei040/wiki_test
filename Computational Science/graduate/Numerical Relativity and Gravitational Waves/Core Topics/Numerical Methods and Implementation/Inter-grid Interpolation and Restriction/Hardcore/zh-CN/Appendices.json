{
    "hands_on_practices": [
        {
            "introduction": "本练习侧重于高阶插值算符的基本构建。通过要求算符对多项式精确，您将从第一性原理推导插值权重，这是开发精确数值格式的一项核心技能。这项练习  对于理解自适应网格加密（AMR）模拟的精度是如何从基础上建立起来至关重要。",
            "id": "3477765",
            "problem": "考虑在数值相对论的 Baumgarte–Shapiro–Shibata–Nakamura (BSSN) 形式体系中使用的一种自适应网格加密 (AMR) 层级结构，用于演化双黑洞并合附近的时空度规和曲率。设一个粗网格层具有均匀的单元间距 $H$，以及一个光滑标量场 $\\phi(x)$ 的单元中心采样值，该标量场例如代表该层级上的一个规范不变的引力波提取标量。引入一个加密比为 $r=2$ 的细网格层，因此其间距为 $h=H/2$，其单元中心位于每个粗网格单元内部，与粗网格单元中心的偏移量为 $\\pm H/4$。\n\n你的任务是，从第一性原理出发，构建一个四阶张量积多项式延拓算子，该算子将粗网格单元中心的数据映射到细网格单元中心，并且对于最高三次的多项式是精确的。在一维空间中进行推导，得出规范的一维模板，该模板可作为高维中张量积算子的构建模块。\n\n具体来说，确定用于计算位于相对于位置 $x_i$ 处粗网格单元中心偏移量为 $+H/4$ 的细网格单元中心值的四点一维插值权重。在 $x_i + H/4$ 处的插值细网格值 $\\phi^{f}$ 必须写成四个相邻粗网格单元中心值 $\\{\\phi_{i-1}, \\phi_i, \\phi_{i+1}, \\phi_{i+2}\\}$ 的线性组合，使得该算子能精确再现任何最高三次的多项式 $\\phi(x)$。将你的最终答案表示为一个行向量，其中包含四个系数，顺序与 $\\{\\phi_{i-1}, \\phi_i, \\phi_{i+1}, \\phi_{i+2}\\}$ 对应。\n\n无需进行数值舍入。最终答案必须是单一的解析表达式。",
            "solution": "该问题要求构建一个一维、四阶多项式延拓算子，用于将间距为 $H$ 的粗网格上的数据插值到一个特定的细网格点。在细网格点上的插值（我们记作 $\\phi^f$）需要表示为来自四个指定相邻粗网格点上值的线性组合。该算子必须对最高3次的多项式是精确的，这意味着其局部截断误差为 $\\mathcal{O}(H^4)$ 阶，这与一个四阶方法是一致的。\n\n设粗网格点位于位置 $x_j = jH$，其中 $j$ 为任意整数。标量场 $\\phi(x)$ 在这些点上的值记为 $\\phi_j = \\phi(x_j)$。具体的任务是，对于一个给定的粗网格单元索引 $i$，求出位于 $x_f = x_i + H/4$ 的细网格点上的插值。插值公式指定使用来自索引为 $\\{i-1, i, i+1, i+2\\}$ 的四个粗网格点上的值。\n\n插值公式是这些粗网格值的线性组合：\n$$ \\phi^f = c_{-1} \\phi_{i-1} + c_0 \\phi_i + c_1 \\phi_{i+1} + c_2 \\phi_{i+2} $$\n系数 $\\{c_{-1}, c_0, c_1, c_2\\}$ 是定义该插值模板的未知权重。\n\n为简化推导，我们可以不失一般性地通过设置 $x_i = 0$ 来建立一个局部坐标系。那么模板中涉及的粗网格点的位置为：\n$$ x_{i-1} = -H, \\quad x_i = 0, \\quad x_{i+1} = H, \\quad x_{i+2} = 2H $$\n目标细网格点位于 $x_f = x_i + H/4 = H/4$。\n\n基本约束是插值必须对最高3次的多项式是精确的。这意味着如果 $\\phi(x)$ 是这样一个多项式，那么该公式必须精确地得出 $\\phi(x_f)$。我们可以通过要求该公式对于最高3次多项式向量空间的一个基是精确的来强制满足此条件。单项式基 $\\{1, x, x^2, x^3\\}$ 是一个方便的选择。\n\n我们将此条件应用于每个基多项式：\n\n1.  对于 $\\phi(x) = 1$：\n    函数在所有点上的值都是 $1$。插值公式必须再现这个常数值。\n    $$ 1 = c_{-1}\\phi(-H) + c_0\\phi(0) + c_1\\phi(H) + c_2\\phi(2H) = c_{-1}(1) + c_0(1) + c_1(1) + c_2(1) $$\n    这给出了我们的第一个线性方程：\n    $$ c_{-1} + c_0 + c_1 + c_2 = 1 \\quad (1) $$\n\n2.  对于 $\\phi(x) = x$：\n    在粗网格点上的值为 $\\phi(x_j) = x_j$。待求的细网格点上的值为 $\\phi(x_f) = x_f = H/4$。\n    $$ \\frac{H}{4} = c_{-1}(-H) + c_0(0) + c_1(H) + c_2(2H) $$\n    假设 $H \\neq 0$，我们可以两边同除以 $H$：\n    $$ -c_{-1} + c_1 + 2c_2 = \\frac{1}{4} \\quad (2) $$\n\n3.  对于 $\\phi(x) = x^2$：\n    各点上的值为 $\\phi(x_j) = x_j^2$。细网格点上的值为 $\\phi(x_f) = x_f^2 = (H/4)^2 = H^2/16$。\n    $$ \\frac{H^2}{16} = c_{-1}(-H)^2 + c_0(0)^2 + c_1(H)^2 + c_2(2H)^2 = c_{-1}H^2 + c_1H^2 + 4c_2H^2 $$\n    两边同除以 $H^2$：\n    $$ c_{-1} + c_1 + 4c_2 = \\frac{1}{16} \\quad (3) $$\n\n4.  对于 $\\phi(x) = x^3$：\n    各点上的值为 $\\phi(x_j) = x_j^3$。细网格点上的值为 $\\phi(x_f) = x_f^3 = (H/4)^3 = H^3/64$。\n    $$ \\frac{H^3}{64} = c_{-1}(-H)^3 + c_0(0)^3 + c_1(H)^3 + c_2(2H)^3 = -c_{-1}H^3 + c_1H^3 + 8c_2H^3 $$\n    两边同除以 $H^3$：\n    $$ -c_{-1} + c_1 + 8c_2 = \\frac{1}{64} \\quad (4) $$\n\n我们得到了一个关于四个未知系数 $\\{c_{-1}, c_0, c_1, c_2\\}$ 的四元线性方程组。我们可以解这个方程组。让我们首先关注方程 $(2)$、$(3)$ 和 $(4)$，它们构成了一个关于 $c_{-1}$、$c_1$ 和 $c_2$ 的子系统。\n方程 $(4)$ 减去方程 $(2)$：\n$$ (-c_{-1} + c_1 + 8c_2) - (-c_{-1} + c_1 + 2c_2) = \\frac{1}{64} - \\frac{1}{4} $$\n$$ 6c_2 = \\frac{1 - 16}{64} = -\\frac{15}{64} $$\n$$ c_2 = -\\frac{15}{6 \\times 64} = -\\frac{5}{2 \\times 64} = -\\frac{5}{128} $$\n\n现在，将 $c_2$ 的值代入方程 $(2)$ 和 $(3)$。\n由方程 $(3)$ 得：\n$$ c_{-1} + c_1 = \\frac{1}{16} - 4c_2 = \\frac{1}{16} - 4\\left(-\\frac{5}{128}\\right) = \\frac{1}{16} + \\frac{20}{128} = \\frac{8}{128} + \\frac{20}{128} = \\frac{28}{128} = \\frac{7}{32} \\quad (A) $$\n由方程 $(2)$ 得：\n$$ -c_{-1} + c_1 = \\frac{1}{4} - 2c_2 = \\frac{1}{4} - 2\\left(-\\frac{5}{128}\\right) = \\frac{1}{4} + \\frac{10}{128} = \\frac{32}{128} + \\frac{10}{128} = \\frac{42}{128} = \\frac{21}{64} \\quad (B) $$\n\n我们现在解由方程 $(A)$ 和 $(B)$ 组成的方程组来求 $c_{-1}$ 和 $c_1$。将 $(A)$ 和 $(B)$ 相加：\n$$ (c_{-1} + c_1) + (-c_{-1} + c_1) = \\frac{7}{32} + \\frac{21}{64} $$\n$$ 2c_1 = \\frac{14}{64} + \\frac{21}{64} = \\frac{35}{64} \\implies c_1 = \\frac{35}{128} $$\n将 $c_1$ 的值代回方程 $(A)$：\n$$ c_{-1} = \\frac{7}{32} - c_1 = \\frac{7}{32} - \\frac{35}{128} = \\frac{28}{128} - \\frac{35}{128} = -\\frac{7}{128} $$\n\n最后，我们使用方程 $(1)$ 来确定 $c_0$：\n$$ c_0 = 1 - (c_{-1} + c_1 + c_2) = 1 - \\left(-\\frac{7}{128} + \\frac{35}{128} - \\frac{5}{128}\\right) $$\n$$ c_0 = 1 - \\left(\\frac{-7 + 35 - 5}{128}\\right) = 1 - \\frac{23}{128} = \\frac{128 - 23}{128} = \\frac{105}{128} $$\n\n因此，该模板的四个插值权重为：\n$$ c_{-1} = -\\frac{7}{128}, \\quad c_0 = \\frac{105}{128}, \\quad c_1 = \\frac{35}{128}, \\quad c_2 = -\\frac{5}{128} $$\n问题要求将最终答案表示为这些系数组成的行向量。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-\\frac{7}{128}  \\frac{105}{128}  \\frac{35}{128}  -\\frac{5}{128}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "构建算符之后，我们必须分析它们的行为。本练习  引入傅里叶分析这一强大工具，以理解插值算符如何作用于数据的不同频率分量。确定傅里叶符号可以揭示算符如何放大或抑制模式，这对于确保引力波模拟的稳定性和保真度至关重要。",
            "id": "3477729",
            "problem": "在采用自适应网格加密（AMR）的二元黑洞并合数值相对论模拟中，跨网格算子必须保持度规变量中编码的传播引力波内容的相位信息。考虑一个一维、顶点中心、均匀的网格层级，其中粗网格间距为 $H$，细网格间距为 $h$，满足 $H=2h$。设 $j \\in \\mathbb{Z}$ 为位置 $x_{j} = j H$ 处的粗网格顶点的索引，$k \\in \\mathbb{Z}$ 为位置 $x_{k} = k h$ 处的细网格顶点的索引。线性插值（延拓）算子 $P$ 将粗网格数据 $u_{j}$ 映射到细网格数据 $v_{k}$，其方式为在重合顶点上进行精确注入，并在中间顶点上进行中心平均，即 $v_{2j} = u_{j}$ 和 $v_{2j+1} = \\frac{1}{2} \\left( u_{j} + u_{j+1} \\right)$。使用离散傅里叶分析并以弧度为单位，将粗网格傅里叶模式定义为 $u_{j} = \\exp\\!\\big( \\mathrm{i}\\, \\theta\\, j \\big)$，其中 $\\theta \\in [-\\pi,\\pi]$。在由细网格相位 $\\varrho = \\theta/2$ 和 $\\varrho + \\pi$ 张成的标准双谐波子空间中处理细网格表示，这是与 $2{:}1$ 加密相关的混叠对。仅从上述定义和复指数的性质出发，推导延拓算子 $P$ 的傅里叶符号（双分量系数向量），该算子将粗网格模式的振幅映射到两个细网格谐波 $\\exp\\!\\big( \\mathrm{i}\\, \\varrho\\, k \\big)$ 和 $\\exp\\!\\big( \\mathrm{i}\\, (\\varrho + \\pi)\\, k \\big)$ 的振幅。然后，通过计算在 $\\theta = \\pi$ 处此双分量符号的欧几里得范数，来量化粗网格奈奎斯特模式的放大率。以符号的两个分量（作为 $\\theta$ 的函数）和奈奎斯特模式放大率的单个实数的形式给出你的最终答案。不需要四舍五入。",
            "solution": "### 傅里叶符号的推导\n\n我们的目标是找到系数 $\\hat{P}_0(\\theta)$ 和 $\\hat{P}_1(\\theta)$，使得延拓算子 $P$ 作用于粗网格模式 $u_j = \\exp(\\mathrm{i}\\theta j)$ 产生形式如下的细网格函数 $v_k$：\n$$ v_k = \\hat{P}_0(\\theta) \\exp(\\mathrm{i} \\varrho k) + \\hat{P}_1(\\theta) \\exp(\\mathrm{i} (\\varrho + \\pi) k) $$\n其中 $\\varrho = \\theta/2$。\n\n第二个基函数可以使用恒等式 $\\exp(\\mathrm{i}\\pi) = -1$ 来简化：\n$$ \\exp(\\mathrm{i} (\\varrho + \\pi) k) = \\exp(\\mathrm{i}\\varrho k) \\exp(\\mathrm{i}\\pi k) = \\exp(\\mathrm{i}\\varrho k) (\\exp(\\mathrm{i}\\pi))^k = (-1)^k \\exp(\\mathrm{i}\\varrho k) $$\n因此，$v_k$ 的表达式变为：\n$$ v_k = \\left( \\hat{P}_0(\\theta) + (-1)^k \\hat{P}_1(\\theta) \\right) \\exp(\\mathrm{i}\\varrho k) $$\n\n现在我们将算子 $P$ 的定义应用于输入模式 $u_j = \\exp(\\mathrm{i}\\theta j)$，以找到 $v_k$ 的表达式。我们必须根据细网格索引 $k$ 的奇偶性考虑两种情况。\n\n**情况1：$k$ 为偶数。**\n设 $k=2j$。算子法则是 $v_{2j} = u_j$。\n代入输入模式，并关联索引（$j=k/2$）和相位（$\\theta = 2\\varrho$）：\n$$ v_k = v_{2j} = u_j = \\exp(\\mathrm{i}\\theta j) = \\exp(\\mathrm{i}(2\\varrho) (k/2)) = \\exp(\\mathrm{i}\\varrho k) $$\n将此与 $k$ 为偶数时（此时 $(-1)^k=1$）的一般形式进行比较：\n$$ v_k = (\\hat{P}_0(\\theta) + \\hat{P}_1(\\theta)) \\exp(\\mathrm{i}\\varrho k) $$\n我们得到第一个方程：\n$$ \\hat{P}_0(\\theta) + \\hat{P}_1(\\theta) = 1 $$\n\n**情况2：$k$ 为奇数。**\n设 $k=2j+1$。算子法则是 $v_{2j+1} = \\frac{1}{2}(u_j + u_{j+1})$。\n代入输入模式：\n$$ v_{2j+1} = \\frac{1}{2} \\left( \\exp(\\mathrm{i}\\theta j) + \\exp(\\mathrm{i}\\theta (j+1)) \\right) = \\frac{1}{2} \\exp(\\mathrm{i}\\theta j) (1 + \\exp(\\mathrm{i}\\theta)) $$\n我们可以通过 $j = (k-1)/2$ 将 $j$ 与奇数索引 $k$ 联系起来。代入此式和 $\\theta=2\\varrho$：\n$$ v_k = \\frac{1}{2} \\exp\\left(\\mathrm{i}(2\\varrho) \\frac{k-1}{2}\\right) (1 + \\exp(\\mathrm{i}2\\varrho)) = \\frac{1}{2} \\exp(\\mathrm{i}\\varrho(k-1)) (1 + \\exp(\\mathrm{i}2\\varrho)) $$\n使用恒等式 $1+\\exp(\\mathrm{i}2\\varrho) = \\exp(\\mathrm{i}\\varrho)(\\exp(-\\mathrm{i}\\varrho)+\\exp(\\mathrm{i}\\varrho)) = 2\\exp(\\mathrm{i}\\varrho)\\cos(\\varrho)$：\n$$ v_k = \\frac{1}{2} \\exp(\\mathrm{i}\\varrho k - \\mathrm{i}\\varrho) \\cdot (2\\exp(\\mathrm{i}\\varrho)\\cos(\\varrho)) = \\exp(\\mathrm{i}\\varrho k) \\cos(\\varrho) $$\n将此结果与 $k$ 为奇数时（此时 $(-1)^k=-1$）的一般形式进行比较：\n$$ v_k = (\\hat{P}_0(\\theta) - \\hat{P}_1(\\theta)) \\exp(\\mathrm{i}\\varrho k) $$\n我们得到第二个方程：\n$$ \\hat{P}_0(\\theta) - \\hat{P}_1(\\theta) = \\cos(\\varrho) = \\cos(\\theta/2) $$\n\n**求解符号分量。**\n现在我们有一个关于 $\\hat{P}_0(\\theta)$ 和 $\\hat{P}_1(\\theta)$ 的二元线性方程组：\n$$ \\begin{cases} \\hat{P}_0(\\theta) + \\hat{P}_1(\\theta) = 1 \\\\ \\hat{P}_0(\\theta) - \\hat{P}_1(\\theta) = \\cos(\\theta/2) \\end{cases} $$\n两方程相加得到：\n$$ 2\\hat{P}_0(\\theta) = 1 + \\cos(\\theta/2) $$\n使用半角恒等式 $1+\\cos(\\alpha) = 2\\cos^2(\\alpha/2)$，其中 $\\alpha = \\theta/2$：\n$$ \\hat{P}_0(\\theta) = \\frac{1 + \\cos(\\theta/2)}{2} = \\cos^2(\\theta/4) $$\n第一个方程减去第二个方程得到：\n$$ 2\\hat{P}_1(\\theta) = 1 - \\cos(\\theta/2) $$\n使用半角恒等式 $1-\\cos(\\alpha) = 2\\sin^2(\\alpha/2)$，其中 $\\alpha = \\theta/2$：\n$$ \\hat{P}_1(\\theta) = \\frac{1 - \\cos(\\theta/2)}{2} = \\sin^2(\\theta/4) $$\n因此，延拓算子 $P$ 的傅里叶符号是向量 $(\\cos^2(\\theta/4), \\sin^2(\\theta/4))$。\n\n### 奈奎斯特模式放大率\n\n第二个任务是量化粗网格奈奎斯特模式的放大率，该模式对应于粗网格上可表示的最高频率。对于相位域 $\\theta \\in [-\\pi, \\pi]$，奈奎斯特模式出现在 $\\theta = \\pi$ 处。\n我们在 $\\theta = \\pi$ 处计算符号分量：\n$$ \\hat{P}_0(\\pi) = \\cos^2(\\pi/4) = \\left(\\frac{\\sqrt{2}}{2}\\right)^2 = \\frac{2}{4} = \\frac{1}{2} $$\n$$ \\hat{P}_1(\\pi) = \\sin^2(\\pi/4) = \\left(\\frac{\\sqrt{2}}{2}\\right)^2 = \\frac{2}{4} = \\frac{1}{2} $$\n奈奎斯特频率处的符号向量是 $(\\frac{1}{2}, \\frac{1}{2})$。\n放大率定义为此向量的欧几里得范数：\n$$ \\| (\\hat{P}_0(\\pi), \\hat{P}_1(\\pi)) \\|_2 = \\sqrt{ \\left(\\frac{1}{2}\\right)^2 + \\left(\\frac{1}{2}\\right)^2 } = \\sqrt{\\frac{1}{4} + \\frac{1}{4}} = \\sqrt{\\frac{2}{4}} = \\sqrt{\\frac{1}{2}} = \\frac{1}{\\sqrt{2}} = \\frac{\\sqrt{2}}{2} $$\n粗网格奈奎斯特模式的放大率是 $\\frac{\\sqrt{2}}{2}$。\n\n最终答案由符号的两个分量和这个放大因子组成。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\cos^2\\left(\\frac{\\theta}{4}\\right)  \\sin^2\\left(\\frac{\\theta}{4}\\right)  \\frac{\\sqrt{2}}{2}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "数值方法的一个关键方面是验证其实现并理解其误差特性。本问题  指导您为一个涉及限制和延拓的“往返”操作推导理论误差界。这类分析为代码验证测试提供了具体、可衡量的目标，并加深了您对算符误差如何与底层解的光滑性相关联的理解。",
            "id": "3477759",
            "problem": "考虑一个周长为 $L$ 的一维周期性世界管，在该世界管上对无量纲的引力波应变场 $u(x)$ 进行采样，用于采用自适应网格加密（AMR）的数值相对论模拟。设最细的均匀网格间距为 $h_{f}$，节点为 $x_{n} = n h_{f}$（其中 $n = 0, 1, \\dots, N-1$ 且 $N h_{f} = L$），并设一个较粗的网格间距为 $h_{c} = r h_{f}$，其中 $r \\geq 2$ 是一个整数加密因子。定义从细网格到粗网格的限制算子 $R$，通过在粗网格节点上的逐点注入实现，即对 $j = 0, 1, \\dots, N/r - 1$，有 $R u (x_{jr}) = u(x_{jr})$。定义从粗网格回到细网格的延长算子 $P$，通过在粗网格节点之间进行分段线性插值实现，即对于任何细网格索引 $n = j r + s$（其中 $s \\in \\{0, 1, \\dots, r-1\\}$），\n$$\nP(Ru)(x_{n}) = \\left(1 - \\frac{s}{r}\\right) \\, Ru(x_{j r}) + \\frac{s}{r} \\, Ru(x_{(j+1) r}) ,\n$$\n其中对 $j+1$ 使用周期性索引。往返算子为 $E = I - P R$，其中 $I$ 是作用于 $u$ 的细网格采样值上的单位映射。\n\n你的任务是提出一个与加密无关的验证测试：对于任意 $r$，将 $E$ 应用于在细网格上采样的二次连续可微、周期性的无量纲应变场 $u \\in C^{2}_{\\mathrm{per}}([0,L])$，并评估细网格上的往返误差范数 $\\|E u\\|$。从插值理论和带余项的泰勒定理的基本原理出发，推导一个形式为\n$$\n\\|E u\\|_{L^{\\infty}} \\leq C \\, \\|u''\\|_{L^{\\infty}},\n$$\n的界，该界仅依赖于粗网格间距 $h_{c}$，而不单独依赖于加密因子 $r$，从而使该测试与加密无关。找出在指定的 $R$ 和 $P$ 下，对所有 $u \\in C^{2}_{\\mathrm{per}}([0,L])$ 和所有 $r \\geq 2$ 一致成立的最小常数 $C$。\n\n你的最终答案必须是这个最优常数 $C$ 的单一闭式解析表达式，用 $h_{c}$ 表示。不需要进行数值舍入，最终表达式中也不应包含单位。",
            "solution": "任务是找到用粗网格间距 $h_c$ 表示的最小常数 $C$，使得不等式 $\\|E u\\|_{L^{\\infty}} \\leq C \\|u''\\|_{L^{\\infty}}$ 对任何二次连续可微的周期函数 $u(x)$ 和任何整数加密因子 $r \\geq 2$ 都成立。\n\n往返算子是 $E = I - P R$，其中 $I$ 是细网格上的单位算子，$R$ 是通过注入的限制算子，$P$ 是通过分段线性插值的延长算子。在细网格点 $x_n$ 处的误差由 $e(x_n) = (Eu)(x_n) = u(x_n) - (PRu)(x_n)$ 给出。\n\n算子 $PR$ 首先在粗网格节点 $x_{jr}$ 处对 $u$ 进行采样，然后将这些值线性插值回细网格。因此，对于位于粗网格区间 $[x_{jr}, x_{(j+1)r}]$ 内的任何细网格点 $x_n$，值 $(PRu)(x_n)$ 就是通过点 $(x_{jr}, u(x_{jr}))$ 和 $(x_{(j+1)r}, u(x_{(j+1)r}))$ 的线性多项式 $v(x)$ 的值。误差 $e(x_n) = u(x_n) - v(x_n)$ 是线性插值的标准误差。\n\n对于一个函数 $u \\in C^2([a,b])$，在点 $x \\in [a,b]$ 处的线性插值误差由带余项的泰勒定理给出：\n$$\ne(x) = u(x) - v(x) = \\frac{u''(\\xi)}{2!} (x-a)(x-b)\n$$\n其中 $\\xi \\in (a,b)$。\n\n在我们的情境中，考虑单个粗网格区间 $[x_j^c, x_{j+1}^c]$，其中 $x_j^c = x_{jr}$。该区间的端点是 $a = x_{jr}$ 和 $b = x_{(j+1)r}$。区间长度为 $h_c = b-a = (j+1)rh_f - jrh_f = rh_f$。\n\n此区间内的一个细网格点由 $x_n = x_{jr+s} = x_{jr} + s h_f$ 给出，其中 $s \\in \\{0, 1, \\dots, r-1\\}$。$s=0$ 和 $s=r$ 的特殊情况对应于区间端点，在这些点上插值误差为零。对于任何 $s \\in \\{1, \\dots, r-1\\}$，误差 $e(x_n)$ 通常不为零。\n\n将 $x=x_n$、$a=x_{jr}$ 和 $b=x_{(j+1)r}$ 代入误差公式：\n$$\ne(x_n) = \\frac{u''(\\xi_n)}{2} (x_n - x_{jr}) (x_n - x_{(j+1)r})\n$$\n其中 $\\xi_n \\in (x_{jr}, x_{(j+1)r})$。\n乘积中的项是 $(x_n - x_{jr}) = sh_f$ 和 $(x_n - x_{(j+1)r}) = sh_f - rh_f = (s-r)h_f$。\n因此，在细网格点 $x_n = x_{jr+s}$ 处的误差是：\n$$\ne(x_{jr+s}) = \\frac{u''(\\xi_n)}{2} s(s-r) h_f^2\n$$\n为了找到细网格上误差的 $L^{\\infty}$-范数，我们必须找到 $|e(x_n)|$ 在所有 $n$ 上的最大值。这涉及在所有粗区间 $j$ 和所有细网格偏移量 $s$ 上求最大值。\n$$\n\\|Eu\\|_{L^\\infty} = \\max_{j,s} |e(x_{jr+s})|\n$$\n取误差表达式的绝对值，并用其全局最大值 $\\|u''\\|_{L^\\infty} = \\sup_{x \\in [0,L]} |u''(x)|$ 来界定 $|u''(\\xi_n)|$，我们得到：\n$$\n|e(x_{jr+s})| \\leq \\frac{\\|u''\\|_{L^\\infty}}{2} |s(s-r)| h_f^2 = \\frac{\\|u''\\|_{L^\\infty}}{2} s(r-s) h_f^2\n$$\n对于 $s \\in \\{0, 1, \\dots, r-1\\}$。\n\n问题简化为在 $s \\in \\{0, 1, \\dots, r-1\\}$ 的范围内，为整数 $s$ 找到二次函数 $f(s) = s(r-s)$ 的最大值。这是一个开口向下的抛物线，根在 $s=0$ 和 $s=r$ 处，其顶点在 $s=r/2$。\n如果 $r$ 是偶数，即 $r=2k$（对于某个整数 $k \\geq 1$），那么 $s=r/2 = k$ 是允许范围内的整数。最大值是 $f(k) = k(2k-k) = k^2 = (r/2)^2 = r^2/4$。\n如果 $r$ 是奇数，即 $r=2k+1$（对于某个整数 $k \\geq 1$），那么 $s=r/2$ 不是整数。整数 $s$ 的最大值将出现在最接近 $r/2$ 的两个整数处，即 $s=k$ 和 $s=k+1$。其值为 $f(k)=k(2k+1-k) = k(k+1)$，以及 $f(k+1)=(k+1)(2k+1-(k+1))=(k+1)k$。用 $r$ 表示，$k=(r-1)/2$ 且 $k+1=(r+1)/2$，所以最大值是 $\\frac{r-1}{2} \\frac{r+1}{2} = \\frac{r^2-1}{4}$。\n一般来说，对于 $s \\in \\{0, 1, \\dots, r-1\\}$，$s(r-s)$ 的最大值是 $\\lfloor r/2 \\rfloor \\lceil r/2 \\rceil$。\n\n所以，对于固定的 $r$，我们有锐界：\n$$\n\\|Eu\\|_{L^\\infty} \\leq \\frac{\\|u''\\|_{L^\\infty}}{2} \\left( \\lfloor \\frac{r}{2} \\rfloor \\lceil \\frac{r}{2} \\rceil \\right) h_f^2\n$$\n问题要求将界用 $h_c = rh_f$ 表示，所以 $h_f = h_c/r$。代入得到：\n$$\n\\|Eu\\|_{L^\\infty} \\leq \\frac{\\|u''\\|_{L^\\infty}}{2} \\left( \\lfloor \\frac{r}{2} \\rfloor \\lceil \\frac{r}{2} \\rceil \\right) \\left(\\frac{h_c}{r}\\right)^2 = \\|u''\\|_{L^\\infty} \\frac{h_c^2}{2} \\left( \\frac{\\lfloor r/2 \\rfloor \\lceil r/2 \\rceil}{r^2} \\right)\n$$\n这给出了一个常数 $C(r, h_c) = \\frac{h_c^2}{2} \\frac{\\lfloor r/2 \\rfloor \\lceil r/2 \\rceil}{r^2}$。然而，问题要求一个对所有 $r \\geq 2$ 都有效且与 $r$ 无关的单一常数 $C$。为了找到这样的常数，我们必须对这个表达式在所有有效的 $r$ 上取上确界：\n$$\nC = \\sup_{r \\geq 2, r \\in \\mathbb{Z}} \\left[ \\frac{h_c^2}{2} \\left( \\frac{\\lfloor r/2 \\rfloor \\lceil r/2 \\rceil}{r^2} \\right) \\right] = \\frac{h_c^2}{2} \\sup_{r \\geq 2, r \\in \\mathbb{Z}} \\left[ \\frac{\\lfloor r/2 \\rfloor \\lceil r/2 \\rceil}{r^2} \\right]\n$$\n我们来分析 $K(r) = \\frac{\\lfloor r/2 \\rfloor \\lceil r/2 \\rceil}{r^2}$ 这一项：\n如果 $r=2k$ 是偶数（$k \\geq 1$）：$K(2k) = \\frac{k \\cdot k}{(2k)^2} = \\frac{k^2}{4k^2} = \\frac{1}{4}$。\n如果 $r=2k+1$ 是奇数（$k \\geq 1$）：$K(2k+1) = \\frac{k(k+1)}{(2k+1)^2} = \\frac{k^2+k}{4k^2+4k+1}$。\n我们将奇数情况与 $1/4$ 进行比较：\n$$\n\\frac{1}{4} - K(2k+1) = \\frac{1}{4} - \\frac{k^2+k}{4k^2+4k+1} = \\frac{(4k^2+4k+1) - 4(k^2+k)}{4(4k^2+4k+1)} = \\frac{1}{4(2k+1)^2} > 0\n$$\n因此，对于所有奇数 $r$，$K(r)  1/4$，而对于所有偶数 $r$，$K(r) = 1/4$。在所有整数 $r \\geq 2$ 上的上确界是：\n$$\n\\sup_{r \\geq 2, r \\in \\mathbb{Z}} K(r) = \\frac{1}{4}\n$$\n对于任何偶数 $r \\geq 2$，都可以达到这个上确界。\n\n将此值代回 $C$ 的表达式：\n$$\nC = \\frac{h_c^2}{2} \\left(\\frac{1}{4}\\right) = \\frac{h_c^2}{8}\n$$\n这是满足对所有 $u \\in C^2_{\\mathrm{per}}$ 和所有 $r \\geq 2$ 成立的不等式的最小可能常数 $C$。为了确认这是最小的，我们注意到这个界是可以达到的。对于任何偶数 $r$，最大误差在粗区间的中点 $s=r/2$ 处达到。我们可以构造一个周期函数 $u(x)$，它局部是二次的（例如，在 $[0, h_c]$ 上 $u(x) = \\frac{1}{2} M x^2$ 并进行适当延拓），对于该函数 $\\|u''\\|_{L^\\infty} \\approx |M|$ 且在 $x=h_c/2$ 处的误差接近 $\\frac{|M|h_c^2}{8}$。因此，对所有函数 $u$ 和加密因子 $r$ 取上确界会得到这个常数。\n\n最终的常数是 $C = \\frac{h_c^2}{8}$。",
            "answer": "$$\\boxed{\\frac{h_c^2}{8}}$$"
        }
    ]
}