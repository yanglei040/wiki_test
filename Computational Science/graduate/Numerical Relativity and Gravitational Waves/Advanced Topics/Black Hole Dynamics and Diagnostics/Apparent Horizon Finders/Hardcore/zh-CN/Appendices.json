{
    "hands_on_practices": [
        {
            "introduction": "我们从一个基础但至关重要的练习开始。这项实践旨在通过将其应用于最简单且最重要的静态黑洞解——史瓦西时空，来巩固对表观视界的基本定义。通过从第一性原理出发，将零膨胀率 $\\Theta_{(\\ell)}=0$ 的抽象微分几何概念应用于各向同性坐标下的特定度规，您将亲自推导出视界的位置，从而在抽象理论与具体的可验证结果之间建立坚实的桥梁 。",
            "id": "3464010",
            "problem": "考虑在时间对称切片上用各向同性坐标表示的史瓦西时空，其中该切片的外曲率 $K_{ij}$ 为零。在等时超曲面上的空间三维度规是共形平坦的，可写为\n$$\n\\gamma_{ij}\\,dx^{i}\\,dx^{j} = \\psi(r)^{4}\\left(dr^{2} + r^{2}\\,d\\Omega^{2}\\right),\n$$\n其中共形因子为 $\\psi(r) = 1 + \\frac{M}{2 r}$，质量参数 $M0$。用视界寻找的语言来说，嵌入在切片中的闭合二维曲面 $\\mathcal{S}$ 的向外零膨胀 $\\Theta_{(\\ell)}$ 由基本关系式定义\n$$\n\\Theta_{(\\ell)} = D_{i} s^{i} + K_{ij} s^{i} s^{j} - K,\n$$\n其中 $D_{i}$ 是与 $\\gamma_{ij}$ 相容的协变导数，$s^{i}$ 是 $\\mathcal{S}$ 在切片内指向外部的单位法向量，$K = \\gamma^{ij} K_{ij}$ 是外曲率的迹。边际外陷获面（MOTS）是一个满足 $\\Theta_{(\\ell)} = 0$ 的闭合二维曲面。\n\n仅使用这些定义和给定的度规，采用由恒定各向同性半径 $r = \\text{const}$ 的坐标球面给出的球对称拟设 $\\mathcal{S}$。在时间对称切片上推导 $\\Theta_{(\\ell)}(r)$ 的显式表达式，并求解 MOTS 方程 $\\Theta_{(\\ell)}(r) = 0$，以获得视界的各向同性半径 $r_{\\text{AH}}$ 作为 $M$ 的函数。然后，通过在几何单位制下，对于 $M = 1$ 的特定选择，在 $r = r_{\\text{AH}}$ 处计算你推导出的 $\\Theta_{(\\ell)}(r)$ 的值，来数值验证你的解析结果。\n\n将最终答案报告为 $r_{\\text{AH}}$ 关于 $M$ 的闭合形式解析表达式。无需四舍五入，最终答案中不应包含单位。",
            "solution": "所述问题是有效的。它在科学上基于广义相对论的原理，特别是关于史瓦西度规和视界（边际外陷获面，或 MOTS）的概念。该问题是适定的，提供了一套清晰、自洽的定义和度规，并要求进行特定的推导和求解。不存在矛盾、歧义或事实错误。\n\n我们被要求在史瓦西时空的一个时间对称切片上找到视界的各向同性半径。\n\n首先，我们简化给定的向外零膨胀 $\\Theta_{(\\ell)}$ 的表达式。该切片是时间对称的，这意味着外曲率张量 $K_{ij}$ 为零。这又意味着它的迹 $K = \\gamma^{ij}K_{ij}$ 也为零。因此，膨胀的公式简化为：\n$$\n\\Theta_{(\\ell)} = D_{i} s^{i}\n$$\n其中 $D_{i}$ 是与空间三维度规 $\\gamma_{ij}$ 相关的协变导数，$s^{i}$ 是切片内二维曲面 $\\mathcal{S}$ 指向外部的单位法向量。这个表达式 $D_i s^i$ 是单位法向量场的散度。\n\n空间度规在各向同性坐标 $(r, \\theta, \\phi)$ 中给出为：\n$$\n\\gamma_{ij}\\,dx^{i}\\,dx^{j} = \\psi(r)^{4}\\left(dr^{2} + r^{2}\\,d\\Omega^{2}\\right) = \\psi(r)^{4} dr^2 + \\psi(r)^4 r^2 d\\theta^2 + \\psi(r)^4 r^2 \\sin^2\\theta d\\phi^2\n$$\n其中共形因子为 $\\psi(r) = 1 + \\frac{M}{2r}$。该度规是对角的，其分量为：\n$$\n\\gamma_{rr} = \\psi(r)^{4}, \\quad \\gamma_{\\theta\\theta} = \\psi(r)^{4} r^{2}, \\quad \\gamma_{\\phi\\phi} = \\psi(r)^{4} r^{2} \\sin^{2}\\theta\n$$\n度规的行列式是 $\\gamma = \\det(\\gamma_{ij}) = \\gamma_{rr}\\gamma_{\\theta\\theta}\\gamma_{\\phi\\phi} = \\psi(r)^{12} r^{4} \\sin^{2}\\theta$。其平方根是 $\\sqrt{\\gamma} = \\psi(r)^{6} r^{2} \\sin\\theta$。\n\n曲面 $\\mathcal{S}$ 是一个恒定坐标半径的球面，可以用水平集函数 $f(r, \\theta, \\phi) = r - \\text{const} = 0$ 来描述。协变法向量 $n_i$ 由 $f$ 的梯度给出：\n$$\nn_i = \\partial_i f = (1, 0, 0)\n$$\n逆变分量 $n^i$ 通过用逆度规 $n^i = \\gamma^{ij}n_j$ 提升指标得到。逆度规 $\\gamma^{ij}$ 的非零分量是 $\\gamma^{rr} = \\psi(r)^{-4}$，$\\gamma^{\\theta\\theta} = \\psi(r)^{-4}r^{-2}$ 和 $\\gamma^{\\phi\\phi} = \\psi(r)^{-4}r^{-2}\\sin^{-2}\\theta$。这给出：\n$$\nn^r = \\gamma^{rr} n_r = \\psi(r)^{-4} \\times 1 = \\psi(r)^{-4}\n$$\n并且 $n^\\theta = n^\\phi = 0$。该法向量的模长的平方是 $|n|^2 = \\gamma_{ij}n^i n^j = \\gamma_{rr}(n^r)^2 = \\psi(r)^{4}(\\psi(r)^{-4})^2 = \\psi(r)^{-4}$。因此模长为 $|n| = \\psi(r)^{-2}$。指向外部的单位法向量 $s^i$ 是 $s^i = n^i/|n|$：\n$$\ns^i = \\frac{(\\psi(r)^{-4}, 0, 0)}{\\psi(r)^{-2}} = (\\psi(r)^{-2}, 0, 0)\n$$\n\n现在我们可以计算散度 $\\Theta_{(\\ell)} = D_i s^i$。使用曲线坐标中的标准散度公式：\n$$\nD_i s^i = \\frac{1}{\\sqrt{\\gamma}} \\partial_j (\\sqrt{\\gamma} s^j)\n$$\n因为只有 $s^i$ 的 $r$ 分量非零，这简化为：\n$$\n\\Theta_{(\\ell)} = \\frac{1}{\\sqrt{\\gamma}} \\partial_r (\\sqrt{\\gamma} s^r) = \\frac{1}{\\psi^6 r^2 \\sin\\theta} \\partial_r(\\psi^6 r^2 \\sin\\theta \\cdot \\psi^{-2}) = \\frac{1}{\\psi^6 r^2 \\sin\\theta} \\partial_r(\\psi^4 r^2 \\sin\\theta)\n$$\n项 $\\sin\\theta$ 相对于 $r$ 是常数。我们使用乘积法则来微分 $\\psi^4 r^2$：\n$$\n\\partial_r(\\psi^4 r^2) = (\\partial_r \\psi^4) r^2 + \\psi^4 (\\partial_r r^2) = (4\\psi^3 \\psi') r^2 + \\psi^4(2r)\n$$\n其中 $\\psi' = \\frac{d\\psi}{dr} = \\frac{d}{dr}\\left(1 + \\frac{M}{2r}\\right) = -\\frac{M}{2r^2}$。将此代入：\n$$\n\\partial_r(\\psi^4 r^2) = 4\\psi^3 \\left(-\\frac{M}{2r^2}\\right) r^2 + 2r\\psi^4 = -2M\\psi^3 + 2r\\psi^4 = 2\\psi^3(r\\psi - M)\n$$\n现在我们将 $\\psi(r)$ 的表达式代入括号中的项：\n$$\nr\\psi - M = r\\left(1+\\frac{M}{2r}\\right) - M = r + \\frac{M}{2} - M = r - \\frac{M}{2}\n$$\n因此，导数是 $\\partial_r(\\psi^4 r^2) = 2\\psi^3(r - \\frac{M}{2})$。\n将所有结果代回 $\\Theta_{(\\ell)}$ 的表达式：\n$$\n\\Theta_{(\\ell)}(r) = \\frac{1}{\\psi^6 r^2 \\sin\\theta} \\left[ 2\\psi^3\\left(r - \\frac{M}{2}\\right) \\sin\\theta \\right] = \\frac{2(r - \\frac{M}{2})}{\\psi^3 r^2}\n$$\n这就是在各向同性半径为 $r$ 的球面上，向外零膨胀 $\\Theta_{(\\ell)}(r)$ 所要求的显式表达式。\n\n一个 MOTS（视界）由条件 $\\Theta_{(\\ell)}(r) = 0$ 定义。我们求解该方程以得到视界半径 $r_{\\text{AH}}$：\n$$\n\\frac{2(r_{\\text{AH}} - \\frac{M}{2})}{\\psi(r_{\\text{AH}})^3 r_{\\text{AH}}^2} = 0\n$$\n对于一个物理黑洞，我们对 $r_{\\text{AH}}  0$ 和 $M  0$ 的解感兴趣。在此范围内，分母是严格为正的，因为 $\\psi(r) = 1 + \\frac{M}{2r}  1$。方程成立当且仅当分子为零：\n$$\n2\\left(r_{\\text{AH}} - \\frac{M}{2}\\right) = 0\n$$\n这给出了视界的各向同性半径的解：\n$$\nr_{\\text{AH}} = \\frac{M}{2}\n$$\n\n最后，我们按要求验证此结果。对于 $M=1$ 的情况，我们有 $r_{\\text{AH}}=\\frac{1}{2}$。我们在 $M=1$ 时，在 $r=r_{\\text{AH}}$ 处计算我们推导出的 $\\Theta_{(\\ell)}(r)$ 表达式：\n$$\n\\Theta_{(\\ell)}\\left(r=\\frac{1}{2}\\right) = \\frac{2\\left(\\frac{1}{2} - \\frac{M}{2}\\right)}{\\psi\\left(\\frac{1}{2}\\right)^3 \\left(\\frac{1}{2}\\right)^2} \\Bigg|_{M=1} = \\frac{2\\left(\\frac{1}{2} - \\frac{1}{2}\\right)}{\\psi\\left(\\frac{1}{2}\\right)^3 \\left(\\frac{1}{4}\\right)} = \\frac{2(0)}{\\left(1+\\frac{1}{2(1/2)}\\right)^3 \\left(\\frac{1}{4}\\right)} = 0\n$$\n结果确实为零，这数值上验证了解析解。",
            "answer": "$$\n\\boxed{\\frac{M}{2}}\n$$"
        },
        {
            "introduction": "在掌握了基础理论之后，这项实践将引导您从纯理论分析转向实际的数值计算任务。我们将探讨一种在现代数值模拟中至关重要的非平凡坐标系——“小号”（trumpet）坐标，并要求您在此坐标下降维的史瓦西几何中寻找表观视界。这项练习强调了一个核心物理原理：表观视界的面积半径 $R=2M$ 是一个不变量，您需要实现一个数值求根算法来求解这个在具体坐标下变得复杂的条件，从而在实际的计算环境中应用坐标无关的物理原理 。",
            "id": "3464001",
            "problem": "考虑一个质量为 $M$ 的非旋转史瓦西黑洞，采用几何化单位制，其中引力常数 $G$ 和光速 $c$ 满足 $G=c=1$。在广义相对论的 $3+1$ 表述中，将视界定义为空间切片上最外层的闭合二维曲面，其出射零测地线展开为零。对于球对称时空，一个面积半径为 $R$ 的圆形二维球面的出射零测地线展开 $\\Theta_+$ 由 Misner-Sharp 质量 $m(R)$ 通过不变关系式 $$1 - \\frac{2 m(R)}{R} = g^{ab} \\nabla_a R \\nabla_b R,$$ 确定，而在真空史瓦西时空中，有 $m(R)=M$（常数）。由此推断，视界位于面积半径 $R=2M$ 处，且与切片方式无关。\n\n在移动奇点演化中使用的喇叭切片中，奇点附近的稳态切片几何表现出一个像 $1/\\sqrt{r}$ 那样发散的共形因子，这导致在奇点处有一个有限的极限面积半径。考虑以下解析给定的球对称、共形平坦的空间度规切片，\n$$\\gamma_{ij} = \\psi^4(r)\\,\\delta_{ij},\\qquad \\psi(r) = 1 + \\frac{b}{\\sqrt{r}},$$\n其中 $r$ 是迷向坐标半径，$b0$ 是一个控制喇叭柱状末端半径的常数。坐标球面的面积半径由下式给出：\n$$R(r) = \\psi^2(r)\\,r = \\big(\\sqrt{r} + b\\big)^2.$$\n该切片捕捉了奇点附近的典型喇叭行为（$\\psi \\sim b/\\sqrt{r}$），并且是渐近平坦的（当 $r \\to \\infty$ 时 $\\psi \\to 1$）。\n\n您的任务是：\n1. 从视界由出射展开为零的定义以及 Misner-Sharp 关系式出发，解释为什么在任何球对称切片下，史瓦西时空中的视界都必须满足 $R=2M$。\n2. 使用上述解析切片几何，推导该切片上视界的坐标半径 $r_h$ 所满足的条件，并确定解 $r_h \\ge 0$ 存在的判据。\n3. 实现一个视界寻找器，给定 $(M,b)$，通过对变量 $x = \\sqrt{r} \\ge 0$ 使用稳健的区间套法和二分法，在 $r \\ge 0$ 范围内搜索函数 $$f(r) = R(r) - 2M = \\big(\\sqrt{r} + b\\big)^2 - 2M$$ 的根。如果存在有效的根，则返回坐标半径 $r_h$；否则返回 $-1$ 表示该切片上没有视界。\n4. 将数值视界寻找器的输出与推导出的解析表达式进行验证，并确保在所有存在视界的情况下，两者在小容差范围内保持一致。\n\n单位：半径使用与 $M$ 相同的几何化单位（在此约定中为无量纲）。不涉及角度。\n\n测试套件：\n使用以下参数值集合 $(M,b)$：\n- 情况1（正常情况）：$(1.0,\\,1.1)$。\n- 情况2（边界情况，视界在奇点处）：$(1.0,\\,\\sqrt{2})$。\n- 情况3（无视界）：$(1.0,\\,1.5)$。\n- 情况4（质量更大的正常情况）：$(2.0,\\,1.8)$。\n- 情况5（质量更大的无视界情况）：$(2.0,\\,2.2)$。\n\n对于每种情况，程序必须输出一个浮点数：如果视界存在，则为坐标半径 $r_h$；否则为 $-1$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表（例如，\"[result1,result2,result3,result4,result5]\"）。每个结果必须是一个浮点数。",
            "solution": "该问题陈述在科学上是合理的、适定的和客观的。它提出了一个数值相对论中的标准问题，涉及在史瓦西时空的特定“喇叭”切片上定位视界。所有提供的方程和定义都是该领域的标准内容。任务结构逻辑清晰，从基本原理引导到解析推导，最终到数值实现和验证。因此，该问题被认为是有效的。\n\n以下是分步解答。\n\n**1. 史瓦西时空中的视界条件**\n\n视界被定义为给定空间切片上最外层的临界俘获面，即一个闭合的二维曲面，其出射零测地线的展开 $\\Theta_+$ 为零。因此，视界的条件是 $\\Theta_+ = 0$。\n\n在球对称时空中，展开 $\\Theta_+$ 与对称的二维球面的几何性质有关。问题提供了连接面积半径 $R$ 内包含的 Misner-Sharp 质量 $m(R)$ 与面积半径函数 $R$ 的空间梯度的基本不变关系：\n$$1 - \\frac{2 m(R)}{R} = g^{ab} \\nabla_a R \\nabla_b R$$\n这里，$g^{ab}$ 是完整四维时空度规 $g_{ab}$ 的逆，$\\nabla_a$ 是与之兼容的协变导数。右侧项 $g^{ab} \\nabla_a R \\nabla_b R$ 是面积半径梯度的平方范数。对于生成与二维球面正交的出射零测地线的零矢量场 $l^a$，展开由 $\\Theta_+ = \\frac{1}{R} \\nabla_a(R l^a)$ 给出。对于球对称系统，可以证明这与梯度项直接相关。出射零测地线满足 $ds^2=0$，其展开必须为非负，这意味着非快子式展开由 $\\sqrt{g^{ab} \\nabla_a R \\nabla_b R}$ 决定。因此，临界俘获面 $\\Theta_+ = 0$ 的条件等价于 $R$ 的梯度为零矢量的条件：\n$$g^{ab} \\nabla_a R \\nabla_b R = 0$$\n将此代入 Misner-Sharp 关系式，得到：\n$$1 - \\frac{2 m(R)}{R} = 0$$\n问题陈述指出，对于质量为 $M$ 的真空史瓦西时空，Misner-Sharp 质量对于任何半径都是常数，即 $m(R) = M$。这是 Birkhoff 定理的陈述。因此，视界条件变为：\n$$1 - \\frac{2 M}{R} = 0$$\n解出面积半径 $R$，得到唯一结果：\n$$R = 2M$$\n这个结果仅依赖于视界的定义（$\\Theta_+ = 0$）和时空是史瓦西时空的事实（$m(R) = M$）。它不依赖于特定的坐标系或切片方式（即时间坐标的选择以及度规分解为空间和时间部分的方式）。因此，视界总是位于面积半径为 $R=2M$ 的曲面上，无论选择何种球对称切片。\n\n**2. 喇叭切片上的视界**\n\n现在我们将一般条件 $R=2M$ 应用于所给定的特定喇叭切片。该切片的几何由共形平坦空间度规 $\\gamma_{ij} = \\psi^4(r)\\,\\delta_{ij}$ 给出，共形因子为 $\\psi(r) = 1 + \\frac{b}{\\sqrt{r}}$。对于该度规，半径为 $r$ 的坐标球面的面积半径 $R$ 由下式给出：\n$$R(r) = \\psi^2(r) \\, r = \\left(1 + \\frac{b}{\\sqrt{r}}\\right)^2 r = \\left(\\sqrt{r}\\left(1 + \\frac{b}{\\sqrt{r}}\\right)\\right)^2 = \\left(\\sqrt{r} + b\\right)^2$$\n为了找到视界的坐标半径 $r_h$，我们将其面积半径 $R(r_h)$ 设为等于 $2M$：\n$$R(r_h) = \\left(\\sqrt{r_h} + b\\right)^2 = 2M$$\n为了解出 $r_h$，我们首先解出 $\\sqrt{r_h}$。由于坐标半径 $r$ 必须为非负，即 $r_h \\ge 0$，其平方根 $\\sqrt{r_h}$ 也必须是实数且非负。参数 $b$ 被给定为正数，$b0$。因此，和 $\\sqrt{r_h} + b$ 严格为正。对等式两边取平方根，得到：\n$$\\sqrt{r_h} + b = \\sqrt{2M}$$\n我们选择了右边的正平方根，因为左边必须为正。\n分离出 $\\sqrt{r_h}$ 项，我们发现：\n$$\\sqrt{r_h} = \\sqrt{2M} - b$$\n为了存在 $r_h$ 的物理-解，$\\sqrt{r_h}$ 的值必须是实数且非负。这对参数 $b$ 施加了一个关键条件：\n$$\\sqrt{2M} - b \\ge 0 \\implies b \\le \\sqrt{2M}$$\n这是该切片上存在视界的判据。\n- 如果 $b  \\sqrt{2M}$，右边为负，因此 $\\sqrt{r_h}$ 没有实数解。在这种情况下，该切片上不存在视界。函数 $R(r)$ 在 $r \\to 0$ 处有最小值，此时 $R(r) \\approx (b)^2 = b^2$。如果 $b^2  2M$，那么对所有 $r \\ge 0$ 都有 $R(r)  2M$，条件 $R=2M$ 永远无法满足。\n- 如果 $b \\le \\sqrt{2M}$，则存在一个非负的 $\\sqrt{r_h}$ 解。我们可以两边平方来求得坐标半径 $r_h$：\n$$r_h = \\left(\\sqrt{2M} - b\\right)^2$$\n边界情况出现在 $b = \\sqrt{2M}$ 时，此时 $r_h = 0$。这对应于视界位于奇点 $r=0$ 处。对于 $b  \\sqrt{2M}$，我们有 $r_h > 0$。\n\n**3. 数值视界寻找器设计**\n\n任务是实现一个数值求根器，求解方程 $f(r) = R(r) - 2M = 0$，即：\n$$f(r) = \\left(\\sqrt{r} + b\\right)^2 - 2M = 0$$\n其中 $r \\ge 0$。问题指定对变量 $x = \\sqrt{r}$ 使用二分法，其中 $x \\ge 0$。让我们定义一个对应于 $f(r)$ 的新函数 $g(x)$：\n$$g(x) = (x + b)^2 - 2M$$\n我们需要找到 $g(x)=0$ 在 $x \\ge 0$ 上的根。\n算法流程如下：\n1.  首先，检查解析推导出的存在性条件：$b \\le \\sqrt{2M}$。这等价于 $b^2 \\le 2M$。如果 $b^2 > 2M$，则根不存在，寻找器应返回 $-1$。\n2.  如果根存在（$b^2 \\le 2M$），我们需要为二分法建立一个区间 $[x_a, x_b]$，使得 $g(x_a)$ 和 $g(x_b)$ 异号。\n    -   让我们在定义域的下界 $x = 0$ 处计算 $g(x)$。\n        $$g(0) = (0 + b)^2 - 2M = b^2 - 2M$$\n        由于我们已经确定根存在（$b^2 \\le 2M$），我们知道 $g(0) \\le 0$。因此，我们可以将区间的下端点设为 $x_a = 0$。\n    -   对于上界 $x_b$，我们需要一个值使得 $g(x_b) > 0$。$g(x)$ 的导数是 $g'(x) = 2(x+b)$，对于 $x \\ge 0$ 和 $b > 0$，它总是正的。因此，$g(x)$ 是一个单调递增函数。一个合适的上界选择可以参考解析根 $x_h = \\sqrt{2M} - b$。一个简单、稳健且保证大于根的上界选择是 $x_b = \\sqrt{2M}$。让我们验证一下：\n        $$g(\\sqrt{2M}) = (\\sqrt{2M} + b)^2 - 2M = (2M + 2b\\sqrt{2M} + b^2) - 2M = 2b\\sqrt{2M} + b^2$$\n        由于 $b0$ 和 $M0$，该值总是正的。\n    -   因此，如果根存在，它保证位于 $x$ 的区间 $[0, \\sqrt{2M}]$ 内。\n3.  确定了区间 $[x_a, x_b] = [0, \\sqrt{2M}]$ 后，我们可以应用二分算法：\n    -   迭代一个固定的次数（例如，对于标准浮点数，$100$ 次迭代提供足够的精度）。\n    -   在每次迭代中，计算中点 $x_m = (x_a + x_b)/2$。\n    -   计算 $g(x_m)$。如果 $g(x_m)  0$，根在区间的上半部分，所以我们更新 $x_a = x_m$。否则，根在区间的下半部分，我们更新 $x_b = x_m$。\n4.  迭代结束后，根近似为 $x_h \\approx (x_a + x_b)/2$。\n5.  最终结果是坐标半径 $r_h = x_h^2$。\n\n**4. 验证**\n\n对于存在视界的情况（$b \\le \\sqrt{2M}$），数值实现将与解析解 $r_h = (\\sqrt{2M} - b)^2$ 进行验证。\n- 情况 1: $(M,b) = (1.0, 1.1)$。我们有 $b = 1.1  \\sqrt{2 \\cdot 1.0} \\approx 1.414$。存在视界。解析解 $r_h = (\\sqrt{2} - 1.1)^2 \\approx 0.098728$。数值求解器应收敛到此值。\n- 情况 2: $(M,b) = (1.0, \\sqrt{2})$。我们有 $b = \\sqrt{2M}$。在奇点处存在视界。解析解 $r_h = (\\sqrt{2} - \\sqrt{2})^2 = 0$。数值求解器应返回 $0$。\n- 情况 3: $(M,b) = (1.0, 1.5)$。我们有 $b = 1.5 > \\sqrt{2}$。不存在视界。算法应返回 $-1$。\n- 情况 4: $(M,b) = (2.0, 1.8)$。我们有 $b = 1.8  \\sqrt{2 \\cdot 2.0} = 2.0$。存在视界。解析解 $r_h = (2.0 - 1.8)^2 = (0.2)^2 = 0.04$。数值求解器应收敛到此值。\n- 情况 5: $(M,b) = (2.0, 2.2)$。我们有 $b = 2.2 > 2.0$。不存在视界。算法应返回 $-1$。\n\n所提出的数值方法是稳健的，并且与解析推导一致。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef find_horizon(M, b):\n    \"\"\"\n    Finds the coordinate radius of the apparent horizon for a trumpet slice.\n\n    The apparent horizon is located where the areal radius R(r) = 2M.\n    For the given slice, R(r) = (sqrt(r) + b)^2.\n    The equation to solve is (sqrt(r) + b)^2 = 2M for r = 0.\n    Let x = sqrt(r), so the equation becomes (x + b)^2 = 2M for x = 0.\n\n    Args:\n        M (float): The mass of the Schwarzschild black hole.\n        b (float): The parameter of the trumpet slice.\n\n    Returns:\n        float: The coordinate radius r_h of the apparent horizon, or -1 if none exists.\n    \"\"\"\n    if M = 0 or b = 0:\n        # Physical parameters must be positive as per problem constraints.\n        return -1.0\n        \n    sqrt_2M = np.sqrt(2.0 * M)\n\n    # Criterion for horizon existence: b = sqrt(2M)\n    if b > sqrt_2M:\n        return -1.0\n        \n    # Handle the boundary case where the horizon is at the puncture r=0\n    if np.isclose(b, sqrt_2M):\n        return 0.0\n\n    # Define the function g(x) = (x + b)^2 - 2M, where x = sqrt(r).\n    # We need to find the root of g(x) = 0 for x = 0.\n    g = lambda x: (x + b)**2 - 2.0 * M\n\n    # Set up the bracket for bisection on the variable x = sqrt(r).\n    # From the analysis, g(0) = b^2 - 2M = 0, so xa=0 is a valid lower bound.\n    # The analytical solution for x is sqrt(2M) - b, which is less than sqrt(2M).\n    # So, xb = sqrt(2M) serves as a robust upper bound since g(sqrt(2M))  0.\n    xa = 0.0\n    xb = sqrt_2M\n    \n    # Bisection method for finding the root x_h.\n    # 100 iterations is more than sufficient for double precision.\n    for _ in range(100):\n        xm = (xa + xb) / 2.0\n        # If g(xm) has the same sign as g(xa) (which is negative),\n        # then the root is in [xm, xb].\n        if g(xm)  0:\n            xa = xm\n        # Otherwise, the root is in [xa, xm].\n        else:\n            xb = xm\n            \n    # The root for x=sqrt(r) is approximated by the midpoint of the final interval.\n    xh = (xa + xb) / 2.0\n    \n    # The coordinate radius of the horizon is r_h = x_h^2.\n    rh = xh**2\n    \n    return rh\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (1.0, 1.1),\n        (1.0, np.sqrt(2.0)),\n        (1.0, 1.5),\n        (2.0, 1.8),\n        (2.0, 2.2),\n    ]\n\n    results = []\n    for M, b in test_cases:\n        result = find_horizon(M, b)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # Using a format specifier to ensure consistent output representation.\n    print(f\"[{','.join(f'{r:.12f}' for r in results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "最后的这项高级实践将带您直面一个在真实模拟中无法回避的关键问题：数值误差。在数值相对论模拟中，哈密顿约束和动量约束方程并非被精确满足，其截断误差会像伪源一样“污染”表观视界的定义方程。这项练习通过向膨胀方程中注入人工源项来模拟约束违例的影响，将寻找视界从一个精确的求根问题转变为一个最小化残差的优化问题，这能让您深入理解在实际应用中视界寻找算法的鲁棒性与局限性 。",
            "id": "3464017",
            "problem": "您将实现一个简化的、独立的数值研究，探讨在 Arnowitt–Deser–Misner (ADM) 3+1分解中，哈密顿约束和动量约束的违反对寻找边际外陷获面（MOTS）的影响。其中，视界被建模为在各向同性坐标下的时间对称史瓦西切片上，出射膨胀为零的点。您的程序必须对轴对称试探面上的出射膨胀残差进行建模，注入人工约束残差，并计算残差景观，通过最小化均方根（RMS）残差来提取最佳拟合面。所有角度必须以弧度处理，所有半径必须以质量参数 $M$ 的单位表示。\n\n将使用的基本基础和定义：\n- 在 3+1 分解中，哈密顿约束为 $H \\equiv R + K^2 - K_{ij} K^{ij} - 16 \\pi \\rho = 0$，动量约束为 $M^i \\equiv D_j (K^{ij} - \\gamma^{ij} K) - 8 \\pi S^i = 0$，其中 $\\gamma_{ij}$ 是空间度规，$K_{ij}$ 是外曲率，$R$ 是 $\\gamma_{ij}$ 的里奇标量，$D_i$ 是与 $\\gamma_{ij}$ 兼容的协变导数。\n- 在对嵌入 $(\\Sigma,\\gamma_{ij})$ 中、具有向外空间单位法向量 $s^i$ 的闭合二维面进行零膨胀计算时，出射膨胀为 $\\theta \\equiv D_i s^i + K_{ij} s^i s^j - K$。在史瓦西时空的时间对称切片上，$K_{ij} = 0$ 且 $K = 0$，因此 $\\theta = D_i s^i$，这等于该二维面在物理度规 $\\gamma_{ij}$ 中的平均曲率。\n- 考虑史瓦西时空在时间对称切片上的共形平坦各向同性形式：$\\gamma_{ij} = \\psi^4 \\delta_{ij}$，其中 $\\psi(r) = 1 + \\dfrac{M}{2 r}$，$r$ 是各向同性径向坐标，$M$ 是质量参数（使用 $M=1$）。已知的平均曲率共形变换定律表明，对于一个描述为球面上图的星状面，其物理平均曲率可以通过一个共形因子与平直空间平均曲率相关联。\n- 对于围绕球体有小形变的轴对称星状试探面，将其表面半径参数化为 $R(\\theta) = R_0 \\left(1 + a_2 Y_{20}(\\theta)\\right)$，其中 $R_0  0$ 且 $|a_2|$ 很小，$Y_{20}(\\theta)$ 是阶 $\\ell = 2$、次 $m = 0$ 的实球谐函数，按标准方式归一化。令 $Y_{10}(\\theta)$ 表示相应的 $\\ell=1, m=0$ 谐函数。\n- 针对围绕球体的小形变，将平直平均曲率线性化，并利用 $\\gamma_{ij} = \\psi^4 \\delta_{ij}$ 和 $\\psi(r) = 1 + \\dfrac{1}{2 r}$ （设 $M=1$）的共形重缩放，获得一个出射膨胀模型 $\\theta(\\theta; R_0, a_2)$，该模型包含一个常数（球面）部分和通过 $Y_{20}(\\theta)$ 体現的 $a_2$ 线性响应。\n- 通过向膨胀添加一个形式为 $\\delta \\theta(\\theta) = \\alpha \\, C_H(\\theta) + \\beta \\, \\hat{n}_i C_M^i(\\theta)$ 的代理附加项来人工注入约束残差，其中 $C_H$ 模拟哈密顿约束残差，$C_M^i$ 模拟动量约束残差，$\\hat{n}^i$ 是向外法向量，$\\alpha, \\beta$ 是标量权重。对于轴对称情况，使用 $C_H(\\theta) = A_H \\, Y_{20}(\\theta)$ 和 $\\hat{n}_i C_M^i(\\theta) = A_M \\, Y_{10}(\\theta)$，其中振幅为 $A_H$ 和 $A_M$。\n\n您的任务：\n- 实现一个程序，为由参数 $(R_0, a_2)$ 表征的每个试探面计算离散化均方根残差\n$$\n\\mathcal{E}(R_0, a_2) = \\left( \\frac{\\int_0^\\pi \\theta(\\theta; R_0, a_2)^2 \\sin\\theta \\, d\\theta}{\\int_0^\\pi \\sin\\theta \\, d\\theta} \\right)^{1/2},\n$$\n在 $\\theta \\in [0,\\pi]$上使用均匀网格，并使用权重为 $\\sin\\theta$ 的黎曼和来计算积分。所有角度均以弧度处理。球面平均分母在离散近似中必须精确为 $\\int_0^\\pi \\sin\\theta \\, d\\theta = 2$。\n- 对于下述每个测试用例，在指定的参数集上最小化 $\\mathcal{E}$。您必须在区间 $[0.3, 1.2]$ 上使用包含 $901$ 个均匀间隔点的网格搜索来对 $R_0$ 进行搜索。对于需要优化 $a_2$ 的测试用例，您也必须尋找最小化 $\\mathcal{E}$ 的 $a_2$；您可以选择任何数值稳定的方法，前提是它是独立的且无需用户输入，并且您必须确保找到的 $a_2$ 对于给定的 $R_0$ 能够最小化 $\\mathcal{E}$。在所有情况下，报告最小化参数 $R_0^\\star$ 和相应的最小 RMS 残差值 $\\mathcal{E}^\\star$。\n- 使用实球谐函数 $Y_{\\ell 0}(\\theta) = \\sqrt{\\dfrac{2\\ell+1}{4\\pi}} \\, P_\\ell(\\cos\\theta)$，其中 $P_\\ell$ 是勒让德多项式。严格遵循此归一化方式处理 $Y_{10}$ 和 $Y_{20}$。\n- 角度必须以弧度为单位。半径必须以 $M$ 为单位报告（固定 $M=1$）。最终输出必须四舍五入到六位小数。\n\n测试套件：\n1. 基准（无注入）：$\\alpha = 0$, $\\beta = 0$, $A_H = 0$, $A_M = 0$。固定 $a_2 = 0$，仅对 $R_0$ 进行优化。\n2. 哈密顿四极注入（带形状自由度）：$\\alpha = 1$, $\\beta = 0$, $A_H = 0.2$, $A_M = 0$。同时对 $R_0$ 和 $a_2$ 进行优化。\n3. 动量偶极注入（无形状自由度）：$\\alpha = 0$, $\\beta = 1$, $A_H = 0$, $A_M = 0.1$。固定 $a_2 = 0$，仅对 $R_0$ 进行优化。\n4. 组合适度注入（无形状自由度）：$\\alpha = 1$, $\\beta = 1$, $A_H = 0.15$, $A_M = 0.15$。固定 $a_2 = 0$，仅对 $R_0$ 进行优化。\n\n要求的最终输出格式：\n- 您的程序应生成单行输出，包含一个 JSON 风格的列表之列表形式的结果，每个测试用例对应一个内部列表，其中包含两个浮点数 $[R_0^\\star, \\mathcal{E}^\\star]$，四舍五入到六位小数。例如：[[0.500000,0.000000],[...],...]。不得打印任何额外文本。\n\n角度单位必须是弧度，所有半径必须以 $M=1$ 的 $M$ 为单位报告。通过遵守所述的建模假设和归一化来确保科学真实性，并通过在 $\\theta$ 中使用足够精细的采样来准确逼近积分，从而确保数值稳定性。在指定的运行时环境下，最终输出必须是确定性且可复现的。",
            "solution": "该问题具有科学依据，是良定的，并且所有术语都有正式定义。它提出了一个简化但连贯的数值相对论领域的数值研究。诸如时间对称性和约束违例形式等假设，是此类教学模型的标准配置。膨胀模型的推导和随后的数值最小化是可处理的。因此，该问题是有效的。\n\n解决方案分为三个阶段：首先，推导作为试探面参数函数的出射零膨胀 $\\theta$ 的数学模型；其次，定义待最小化的均方根（RMS）残差 $\\mathcal{E}$；第三，概述为给定测试用例执行此最小化的数值算法。\n\n**1. 出射零膨胀 $\\theta$ 的模型**\n\n我们的任务是在时间对称的史瓦西时空切片上对出射零膨胀 $\\theta$进行建模，其中度规在各向同性坐标下给出。\n\n空间度规为 $\\gamma_{ij} = \\psi^4 \\delta_{ij}$，其中 $\\delta_{ij}$ 是平直欧几里得度规，$\\psi(r) = 1 + \\frac{M}{2r}$ 是共形因子。我们设定质量 $M=1$。在时间对称切片上，外曲率 $K_{ij}$ 为零。因此，嵌入此切片中的二维面的出射膨胀 $\\theta$ 简化为其平均曲率 $\\theta = D_i s^i$，其中 $s^i$ 是指向该面外部的空间单位法向量，$D_i$ 是与 $\\gamma_{ij}$ 兼容的协变导数。\n\n试探面是轴对称和星状的，由半径 $R(\\theta) = R_0(1 + a_2 Y_{20}(\\theta))$ 描述，其中 $R_0$ 是平均各向同性半径，$a_2$ 是小形变振幅，$Y_{20}(\\theta)$ 是一个实球谐函数。\n\n我们旨在使其为零的总膨胀残差，是这个几何膨胀与一个模拟约束违例的人工项之和：\n$$\n\\theta_{total}(\\theta; R_0, a_2) = \\theta_{geom}(\\theta; R_0, a_2) + \\delta\\theta_{constraints}(\\theta)\n$$\n\n**1.1. 几何膨胀 $\\theta_{geom}$**\n\n我们通过将完美球面的精确表达式与形变的线性化响应相结合，来构建 $\\theta_{geom}$ 的模型。\n\n对于位于恒定各向同性半径 $r=R_0$ 的球面，其精确的平均曲率（出射膨胀）可以直接计算。算子为 $\\theta = \\frac{1}{\\sqrt{\\gamma}}\\partial_i(\\sqrt{\\gamma}s^i)$。对于径向法向量 $s^i = (\\psi^{-2}, 0, 0)$ 和体元 $\\sqrt{\\gamma} = \\psi^6 r^2 \\sin\\theta$，这得出：\n$$\n\\theta_{spherical}(R_0) = \\frac{1}{\\psi^4 r^2} \\frac{d}{dr}(\\psi^4 r^2) \\bigg|_{r=R_0} = \\frac{4R_0 - 2M}{R_0(2R_0+M)}\n$$\n设 $M=1$，我们膨胀模型的球面（单极）部分是：\n$$\n\\theta_0(R_0) = \\frac{4R_0 - 2}{R_0(2R_0+1)}\n$$\n该项在 $R_0 = M/2 = 0.5$ 处正确地消失，这是各向同性坐标下视界的位置。\n\n对于形变部分，我们遵循问题的规定。我们将面 $r = R_0(1+a_2 Y_{20}(\\theta))$ 的*平直空间*平均曲率线性化，然后应用共形重缩放。平直空间平均曲率为 $H_{flat} \\approx \\frac{2}{R_0}(1-a_2 Y_{20}) + \\frac{1}{R_0^2} \\Delta_S (R_0 a_2 Y_{20})$，其中 $\\Delta_S$ 是单位球面上的拉普拉斯算子。由于 $\\Delta_S Y_{\\ell m} = -\\ell(\\ell+1) Y_{\\ell m}$，对于 $\\ell=2$ 这给出 $H_{flat} \\approx \\frac{2}{R_0} + \\frac{a_2}{R_0}(2 - \\ell(\\ell+1))Y_{20} = \\frac{2}{R_0} + \\frac{a_2}{R_0}(2-6)Y_{20} = \\frac{2}{R_0} - \\frac{4a_2}{R_0}Y_{20}$。平均曲率的符号约定可能不同；导致正线性响应的约定是 $H_{flat} \\approx \\frac{2}{R_0} + \\frac{4a_2}{R_0}Y_{20}(\\theta)$。\n\n问题陈述使用共形重缩放定律。共形因子 $\\psi$ 对背景的小扰动的领头阶效应是将其按 $\\psi^{-2}$ 比例缩放。因此，$a_2$ 中的线性响应是：\n$$\n\\delta\\theta_{a_2}(\\theta; R_0, a_2) \\approx \\psi(R_0)^{-2} \\left(\\frac{4a_2}{R_0} Y_{20}(\\theta)\\right) = \\left(1+\\frac{1}{2R_0}\\right)^{-2} \\frac{4a_2}{R_0} Y_{20}(\\theta) = \\frac{16 R_0 a_2}{(2R_0+1)^2} Y_{20}(\\theta)\n$$\n结合球面部分和形变部分，我们的几何膨胀模型是：\n$$\n\\theta_{geom}(\\theta; R_0, a_2) = \\frac{4R_0 - 2}{R_0(2R_0+1)} + a_2 \\frac{16 R_0}{(2R_0+1)^2} Y_{20}(\\theta)\n$$\n\n**1.2. 约束违例项 $\\delta\\theta_{constraints}$**\n\n注入的约束违例被建模为一个附加项：\n$$\n\\delta\\theta_{constraints}(\\theta) = \\alpha C_H(\\theta) + \\beta \\hat{n}_i C_M^i(\\theta)\n$$\n使用指定的轴对称形式 $C_H(\\theta) = A_H Y_{20}(\\theta)$ 和 $\\hat{n}_i C_M^i(\\theta) = A_M Y_{10}(\\theta)$，这变为：\n$$\n\\delta\\theta_{constraints}(\\theta) = \\alpha A_H Y_{20}(\\theta) + \\beta A_M Y_{10}(\\theta)\n$$\n\n**1.3. 总膨胀残差**\n\n残差的完整表达式为：\n$$\n\\theta_{total}(\\theta; R_0, a_2) = \\frac{4R_0 - 2}{R_0(2R_0+1)} + \\left( a_2 \\frac{16 R_0}{(2R_0+1)^2} + \\alpha A_H \\right) Y_{20}(\\theta) + \\beta A_M Y_{10}(\\theta)\n$$\n球谐函数归一化为 $Y_{\\ell 0}(\\theta) = \\sqrt{\\frac{2\\ell+1}{4\\pi}} P_\\ell(\\cos\\theta)$，其中 $P_\\ell$ 是勒让德多项式。\n\n**2. RMS 残差与最小化**\n\n目标是找到最小化 RMS 残差的表面参数 $(R_0, a_2)$：\n$$\n\\mathcal{E}(R_0, a_2) = \\left( \\frac{\\int_0^\\pi \\theta_{total}(\\theta; R_0, a_2)^2 \\sin\\theta \\, d\\theta}{\\int_0^\\pi \\sin\\theta \\, d\\theta} \\right)^{1/2}\n$$\n分母为 $\\int_0^\\pi \\sin\\theta \\, d\\theta = 2$。我们将使用在 $\\theta \\in [0, \\pi]$ 的 $N$ 个点的精细网格上的离散黎曼和来近似分子积分，其中 $\\Delta\\theta = \\pi/(N-1)$：\n$$\n\\int_0^\\pi f(\\theta) \\sin\\theta \\, d\\theta \\approx \\sum_{i=0}^{N-1} f(\\theta_i) \\sin(\\theta_i) \\Delta\\theta\n$$\n\n对于需要为给定 $R_0$ 优化 $a_2$ 的测试用例，我们注意到 $\\mathcal{E}^2$ 是 $a_2$ 的二次函数。最小值可以通过设置 $\\frac{\\partial \\mathcal{E}^2}{\\partial a_2} = 0$ 解析地求出。这对每个 $R_0$ 得出一个最优的 $a_{2,opt}$：\n$$\na_{2,opt}(R_0) = -\\alpha A_H \\frac{(2R_0+1)^2}{16R_0}\n$$\n这个公式在测试用例 2 中使用。对于其他情况，$a_2$ 固定为 $0$。\n\n**3. 算法**\n\n对于四个测试用例中的每一个：\n1.  初始化最小残差 $\\mathcal{E}^\\star = \\infty$ 和最佳拟合半径 $R_0^\\star = \\text{NaN}$。\n2.  定义一个包含 901 个候选半径 $R_0 \\in [0.3, 1.2]$ 的网格。\n3.  定义一个用于数值积分的 $N$ 个角度 $\\theta_i \\in [0, \\pi]$ 的精细网格。\n4.  在角度网格上预计算 $Y_{10}(\\theta_i)$ 和 $Y_{20}(\\theta_i)$ 的值。\n5.  遍历其网格中的每个 $R_0$：\n    a. 确定此步骤的 $a_2$ 值。如果启用了优化（测试用例 2），则使用上述公式计算 $a_{2,opt}(R_0)$。否则，$a_2=0$。\n    b. 使用完整模型在角度网格上构建 $\\theta_{total}(\\theta_i)$ 值的向量。\n    c. 通过数值黎曼和计算 $\\mathcal{E}^2$ 的分子： $I = \\sum_{i=0}^{N-1} \\theta_{total}(\\theta_i)^2 \\sin(\\theta_i) \\Delta\\theta$。\n    d. 计算此 $R_0$ 的 RMS 残差：$\\mathcal{E}(R_0) = \\sqrt{I / 2}$。\n    e. 如果 $\\mathcal{E}(R_0)  \\mathcal{E}^\\star$，则更新 $\\mathcal{E}^\\star = \\mathcal{E}(R_0)$ 和 $R_0^\\star = R_0$。\n6.  遍历所有 $R_0$ 后，存储最终的对 $[R_0^\\star, \\mathcal{E}^\\star]$，四舍五入到六位小数。\n7.  收集所有测试用例的结果，并将其格式化为所需的输出字符串。",
            "answer": "```python\nimport numpy as np\nfrom scipy.special import legendre\n\ndef solve():\n    \"\"\"\n    Computes a numerical study of apparent horizon finding in the presence of\n    artificial ADM constraint violations on a time-symmetric Schwarzschild slice.\n    \"\"\"\n\n    # Test suite as defined in the problem statement\n    test_cases = [\n        {'id': 1, 'alpha': 0.0, 'beta': 0.0, 'A_H': 0.0, 'A_M': 0.0, 'optimize_a2': False},\n        {'id': 2, 'alpha': 1.0, 'beta': 0.0, 'A_H': 0.2, 'A_M': 0.0, 'optimize_a2': True},\n        {'id': 3, 'alpha': 0.0, 'beta': 1.0, 'A_H': 0.0, 'A_M': 0.1, 'optimize_a2': False},\n        {'id': 4, 'alpha': 1.0, 'beta': 1.0, 'A_H': 0.15, 'A_M': 0.15, 'optimize_a2': False},\n    ]\n\n    # Numerical parameters\n    M = 1.0  # Mass parameter, fixed\n    R0_grid = np.linspace(0.3, 1.2, 901)\n    N_theta = 2000  # Number of points for angular integration\n    theta_grid = np.linspace(0, np.pi, N_theta)\n    d_theta = np.pi / (N_theta - 1)\n    \n    # Pre-compute Legendre polynomials for Y_l0\n    cos_theta = np.cos(theta_grid)\n    P_1 = legendre(1)(cos_theta)\n    P_2 = legendre(2)(cos_theta)\n\n    # Pre-compute spherical harmonics Y_l0(theta)\n    # Y_l0(theta) = sqrt((2l+1)/(4pi)) * P_l(cos(theta))\n    Y_10 = np.sqrt(3.0 / (4.0 * np.pi)) * P_1\n    Y_20 = np.sqrt(5.0 / (4.0 * np.pi)) * P_2\n\n    final_results = []\n\n    for case in test_cases:\n        alpha, beta = case['alpha'], case['beta']\n        A_H, A_M = case['A_H'], case['A_M']\n        optimize_a2 = case['optimize_a2']\n\n        min_E_sq = np.inf\n        best_R0 = np.nan\n\n        for R0 in R0_grid:\n            # 1. Determine a2 for this R0\n            if optimize_a2:\n                # This analytical formula minimizes the RMS residual w.r.t. a2 for a given R0\n                # a2_opt = -alpha * A_H * (2*R0+M)^2 / (16*M*R0)\n                # With M=1:\n                if R0 > 0:\n                    a2 = -alpha * A_H * ((2.0 * R0 + 1.0)**2) / (16.0 * R0)\n                else:\n                    a2 = 0\n            else:\n                a2 = 0.0\n\n            # 2. Construct the total expansion residual theta_total\n            \n            # Spherical (monopole) part of the geometric expansion\n            # theta_0 = (4*R0 - 2*M) / (R0 * (2*R0 + M))\n            # With M=1:\n            theta_0_term = (4.0 * R0 - 2.0) / (R0 * (2.0 * R0 + 1.0))\n\n            # Quadrupole part from a2 deformation\n            # theta_a2_coeff = a2 * 16 * M * R0 / (2*R0 + M)**2\n            # With M=1:\n            theta_a2_coeff = a2 * 16.0 * R0 / ((2.0 * R0 + 1.0)**2)\n\n            # Combine all parts to form the total residual theta_total\n            # theta_total = theta_0 + (theta_a2_coeff + alpha*A_H)*Y20 + (beta*A_M)*Y10\n            \n            theta_total_vec = (\n                theta_0_term + \n                (theta_a2_coeff + alpha * A_H) * Y_20 +\n                (beta * A_M) * Y_10\n            )\n\n            # 3. Calculate the squared RMS residual E^2\n            # Integral is sum(f(theta_i) * sin(theta_i) * dtheta)\n            integral_numerator = np.sum(theta_total_vec**2 * np.sin(theta_grid)) * d_theta\n            \n            # Denominator is integral(sin(theta) dtheta) from 0 to pi, which is 2.\n            # E_sq = integral_numerator / 2.0\n            current_E_sq = integral_numerator / 2.0\n\n            # 4. Update minimum\n            if current_E_sq  min_E_sq:\n                min_E_sq = current_E_sq\n                best_R0 = R0\n\n        min_E = np.sqrt(min_E_sq)\n        final_results.append([round(best_R0, 6), round(min_E, 6)])\n\n    # Format output as a JSON-like list of lists\n    result_str = \",\".join([f\"[{r:.6f},{e:.6f}]\" for r, e in final_results])\n    print(f\"[{result_str}]\")\n\nsolve()\n```"
        }
    ]
}