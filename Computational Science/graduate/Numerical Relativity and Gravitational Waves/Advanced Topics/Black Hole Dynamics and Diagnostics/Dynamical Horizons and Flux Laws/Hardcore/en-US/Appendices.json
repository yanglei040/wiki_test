{
    "hands_on_practices": [
        {
            "introduction": "Understanding dynamical horizons begins with mastering their fundamental definition. This practice solidifies the abstract concepts of null expansions by applying them to the ingoing Vaidya spacetime, a key analytical model for an accreting black hole. By explicitly calculating the outgoing and ingoing null expansions, $\\theta_{(\\ell)}$ and $\\theta_{(n)}$, you will directly identify the location of the marginally trapped tube, a foundational skill for any analysis in this field .",
            "id": "3472237",
            "problem": "Consider the spherically symmetric ingoing Vaidya spacetime used in numerical relativity studies of black-hole growth,\n$$\nds^{2} = -\\left(1 - \\frac{2 M(v)}{r}\\right) dv^{2} + 2\\, dv\\, dr + r^{2} d\\Omega^{2},\n$$\nwhere $M(v)$ is a smooth, nondecreasing mass function of advanced time $v$ and $d\\Omega^{2}$ is the line element on the unit two-sphere. Let $S$ be a round two-sphere of constant $v$ and $r$. A marginally trapped tube (MTT) is a hypersurface foliated by such spheres on which the expansion of the future-directed outward null normal vanishes while the expansion of the future-directed inward null normal is negative.\n\nStarting from fundamental definitions appropriate to dynamical horizons:\n- The null normals $\\ell^{a}$ and $n^{a}$ are future-directed, orthogonal to $S$, and normalized by $\\ell^{a} n_{a} = -1$.\n- The expansion $\\theta_{(k)}$ of a null normal $k^{a}$ is defined as the fractional rate of change of the area of $S$ along $k^{a}$.\n\nDerive the explicit expressions for $\\theta_{(\\ell)}$ and $\\theta_{(n)}$ in terms of $r$ and $M(v)$, and then evaluate them on the hypersurface $r = 2 M(v)$. Clearly state the pair $\\left(\\theta_{(\\ell)}\\big|_{r=2M(v)},\\, \\theta_{(n)}\\big|_{r=2M(v)}\\right)$ and use this to identify the MTT at $r=2M(v)$.\n\nExpress your final answer in geometric units with $G = c = 1$. Your final answer must be the ordered pair of the two evaluated expansions, presented as a single row matrix. No rounding is required.",
            "solution": "The problem requires the derivation of the null expansions for the ingoing Vaidya spacetime and their evaluation on the hypersurface $r = 2M(v)$ to identify it as a marginally trapped tube (MTT).\n\nThe ingoing Vaidya metric is given in advanced Eddington-Finkelstein-like coordinates $(v, r, \\theta, \\phi)$ as\n$$\nds^{2} = -\\left(1 - \\frac{2 M(v)}{r}\\right) dv^{2} + 2\\, dv\\, dr + r^{2} d\\Omega^{2}\n$$\nwhere $d\\Omega^{2} = d\\theta^2 + \\sin^2\\theta \\, d\\phi^2$. The covariant metric tensor components $g_{ab}$ can be read directly from the line element:\n$g_{vv} = -\\left(1 - \\frac{2M(v)}{r}\\right)$\n$g_{vr} = g_{rv} = 1$\n$g_{\\theta\\theta} = r^2$\n$g_{\\phi\\phi} = r^2 \\sin^2\\theta$\nAll other components are zero.\n\nTo find the null normal vectors, we first need the contravariant metric tensor $g^{ab}$, which is the inverse of $g_{ab}$. The block corresponding to the $(v, r)$ coordinates is $\\begin{pmatrix} g_{vv}  g_{vr} \\\\ g_{rv}  g_{rr} \\end{pmatrix} = \\begin{pmatrix} -(1 - 2M(v)/r)  1 \\\\ 1  0 \\end{pmatrix}$. Its inverse is $\\begin{pmatrix} 0  1 \\\\ 1  1 - 2M(v)/r \\end{pmatrix}$. The angular part is diagonal and easily inverted. Thus, the non-zero components of $g^{ab}$ are:\n$g^{vr} = g^{rv} = 1$\n$g^{rr} = 1 - \\frac{2M(v)}{r}$\n$g^{\\theta\\theta} = \\frac{1}{r^2}$\n$g^{\\phi\\phi} = \\frac{1}{r^2 \\sin^2\\theta}$\n\nThe surface $S$ is a 2-sphere of constant $v$ and $r$. Its tangent space is spanned by $\\frac{\\partial}{\\partial\\theta}$ and $\\frac{\\partial}{\\partial\\phi}$. The null normals $\\ell^a$ and $n^a$ must be orthogonal to $S$. Due to the block-diagonal structure of the metric, any vector with only $(v, r)$ components is orthogonal to any vector in the tangent space of $S$. So we seek null vectors of the form $k^a = (k^v, k^r, 0, 0)$. The null condition is $g_{ab} k^a k^b = 0$.\n$$\ng_{vv}(k^v)^2 + 2 g_{vr} k^v k^r + g_{rr}(k^r)^2 = 0\n$$\n$$\n-\\left(1 - \\frac{2M(v)}{r}\\right)(k^v)^2 + 2 k^v k^r = 0\n$$\n$$\nk^v \\left[ 2k^r - \\left(1 - \\frac{2M(v)}{r}\\right)k^v \\right] = 0\n$$\nThis equation yields two families of null directions:\n1. $k^v = 0$: This implies $k^a$ is proportional to $(0, 1, 0, 0)$. This vector, $\\frac{\\partial}{\\partial r}$, is tangent to the null hypersurfaces of constant $v$. It represents ingoing light rays. To be inward pointing (decreasing $r$), its $r$-component must be negative. This is our inward null normal, $n^a$.\n2. $2k^r = \\left(1 - \\frac{2M(v)}{r}\\right)k^v$: This gives a vector proportional to $\\left(1, \\frac{1}{2}\\left(1 - \\frac{2M(v)}{r}\\right), 0, 0\\right)$. The radial component is positive for $r > 2M(v)$, indicating an outward direction. This is our outward null normal, $\\ell^a$.\n\nBoth vectors must be future-directed. In this coordinate system, since $v$ is advanced time, a vector $k^a$ is future-directed if its $v$-component is positive, or in the limiting case where $k^v=0$, if it is tangent to a future null cone. For $\\ell^a$, we can choose a scaling where $\\ell^v > 0$. For $n^a$, we have $n^v=0$; contracting with the covariant future-pointing vector $dv = (1,0,0,0)_a$, we find $n^a (dv)_a = n^v = 0$, so it lies on the boundary. We can verify it is future-directed by checking its contraction with a timelike vector, e.g., for an observer with four-velocity $T^a \\propto (\\partial/\\partial v)^a$, the condition $g_{ab}k^a T^b  0$ must hold. For $n^a \\propto (0,-1,0,0)$, we have $g_{ab} n^a T^b \\propto g_{vr}n^r = -1  0$. So both are future-directed.\n\nWe now fix the scaling of the null vectors $\\ell^a$ and $n^a$ using the normalization $\\ell^a n_a = -1$ and a canonical choice. A standard choice is to select one of the vectors to be tangent to an affinely parameterized null geodesic congruence. Let's analyze $n^a \\propto (0, -1, 0, 0)$. The geodesic equation for an affinely parameterized geodesic with tangent $k^a$ is $k^b \\nabla_b k^a = 0$. For $n^a = C_n(0, -1, 0, 0) = (0, -C_n, 0, 0)$, the acceleration is $n^b\\nabla_b n^a = n^r\\nabla_r n^a = -C_n (\\partial_r n^a + \\Gamma^a_{rb}n^b) = -C_n \\Gamma^a_{rr} n^r$. The Christoffel symbol component $\\Gamma^a_{rr}$ is given by $\\Gamma^\\lambda_{rr} = g^{\\lambda\\sigma}\\partial_r g_{r\\sigma}$. Since all components of $g_{r\\sigma}$ (namely, $g_{rv}=1$, $g_{rr}=0$, etc.) are independent of $r$, $\\Gamma^a_{rr}=0$. Thus, $n^b \\nabla_b n^a = 0$. We can make the canonical choice $C_n=1$, so $n^a=(0,-1,0,0)$ is affinely parameterized.\n\nWith $n^a = (0, -1, 0, 0)$, we find its covariant form $n_a = g_{ab} n^b$.\n$n_v = g_{vv}n^v + g_{vr}n^r = (1)(-1) = -1$.\n$n_r = g_{rv}n^v + g_{rr}n^r = 0$.\nSo, $n_a = (-1, 0, 0, 0)$.\n\nNow we set $\\ell^a = C_\\ell \\left(1, \\frac{1}{2}\\left(1 - \\frac{2M(v)}{r}\\right), 0, 0\\right)$ and use the normalization condition:\n$\\ell^a n_a = \\ell^v n_v = C_\\ell(1)(-1) = -C_\\ell = -1$, which implies $C_\\ell = 1$.\nThus, our canonically normalized null vectors are:\n$$\n\\ell^a = \\left(1, \\frac{1}{2}\\left(1 - \\frac{2M(v)}{r}\\right), 0, 0\\right)\n$$\n$$\nn^a = \\left(0, -1, 0, 0\\right)\n$$\n\nThe expansion $\\theta_{(k)}$ of a null vector field $k^a$ is the fractional rate of change of the area $A$ of the surface $S$. The area of the sphere $S$ of radius $r$ is $A = 4\\pi r^2$.\n$$\n\\theta_{(k)} = \\frac{1}{A} \\mathcal{L}_k A = \\frac{1}{4\\pi r^2} \\mathcal{L}_k (4\\pi r^2) = \\frac{1}{r^2} k^a \\partial_a (r^2) = \\frac{1}{r^2} (2r k^a \\partial_a r) = \\frac{2}{r} k^r\n$$\nUsing this formula, we can compute the expansions for $\\ell^a$ and $n^a$.\nFor the outward null normal $\\ell^a$, its radial component is $\\ell^r = \\frac{1}{2}\\left(1 - \\frac{2M(v)}{r}\\right)$. The expansion is:\n$$\n\\theta_{(\\ell)} = \\frac{2}{r} \\ell^r = \\frac{2}{r} \\cdot \\frac{1}{2}\\left(1 - \\frac{2M(v)}{r}\\right) = \\frac{1}{r}\\left(1 - \\frac{2M(v)}{r}\\right)\n$$\nFor the inward null normal $n^a$, its radial component is $n^r = -1$. The expansion is:\n$$\n\\theta_{(n)} = \\frac{2}{r} n^r = \\frac{2}{r}(-1) = -\\frac{2}{r}\n$$\n\nFinally, we evaluate these expansions on the hypersurface defined by $r=2M(v)$.\n$$\n\\theta_{(\\ell)}\\bigg|_{r=2M(v)} = \\frac{1}{2M(v)}\\left(1 - \\frac{2M(v)}{2M(v)}\\right) = \\frac{1}{2M(v)}(1 - 1) = 0\n$$\n$$\n\\theta_{(n)}\\bigg|_{r=2M(v)} = -\\frac{2}{2M(v)} = -\\frac{1}{M(v)}\n$$\nThe condition for a marginally trapped tube is that it is foliated by surfaces on which the outward null expansion vanishes ($\\theta_{(\\ell)}=0$) and the inward null expansion is negative ($\\theta_{(n)}0$). Since $M(v)$ is a nondecreasing mass function, we assume $M(v)0$, so $\\theta_{(n)}  0$. Our results confirm that the hypersurface $r=2M(v)$ is indeed a marginally trapped tube (specifically, a marginally outer trapped tube, which is a type of dynamical horizon).\n\nThe ordered pair of the two evaluated expansions is $\\left(0, -\\frac{1}{M(v)}\\right)$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0  -\\frac{1}{M(v)} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "With the geometric definitions established, we can explore the profound physical laws that govern a dynamical horizon's evolution. This thought experiment connects the horizon's geometry to the matter flowing across it, using the Raychaudhuri equation and Einstein's field equations. You will analyze how a violation of the Null Energy Condition (NEC), a phenomenon predicted by quantum field theory in curved spacetime, affects the horizon's causal nature and its area, providing a direct link between fundamental theory and black hole thermodynamics .",
            "id": "3472241",
            "problem": "Consider a spherically symmetric collapse spacetime in which a compact, ingoing null shell carrying negative energy density is localized in an interval of advanced time $v \\in (v_{1}, v_{2})$ near the outer marginally trapped region. Outside this interval, the spacetime satisfies the Null Energy Condition (NEC). Let $\\mathcal{S}_{v}$ be a foliation by closed, marginally outer trapped surfaces (MOTS) with outward and inward future-directed null normals $\\ell^{a}$ and $n^{a}$ normalized by $\\ell^{a} n_{a} = -1$, such that on each $\\mathcal{S}_{v}$ one has $\\theta_{(\\ell)} = 0$ and $\\theta_{(n)}  0$. Assume spherical symmetry so that the shear of the outgoing congruence vanishes, $\\sigma^{2}_{(\\ell)} = 0$, and the twist is zero. Suppose further that during the interval $v \\in (v_{1}, v_{2})$ the ingoing null energy density satisfies $T_{ab} \\ell^{a} \\ell^{b}  0$ on and just outside the MOTS, while outside this interval $T_{ab} \\ell^{a} \\ell^{b} \\ge 0$.\n\nLet the marginally trapped tube (MTT) be the three-surface generated by the foliation $\\{\\mathcal{S}_{v}\\}$, and let $h^{a}$ denote the future-directed vector field tangent to the MTT and orthogonal to each $\\mathcal{S}_{v}$. Decompose $h^{a}$ along the null normals as $h^{a} = \\ell^{a} - C\\, n^{a}$ for some scalar $C$ defined on the MTT. The sign of $C$ determines the signature of the MTT via $h^{a} h_{a} = 2 C$.\n\nUsing only the null Raychaudhuri equation, Einstein’s field equations relating $R_{ab} \\ell^{a} \\ell^{b}$ to $T_{ab} \\ell^{a} \\ell^{b}$, and the defining properties of a future outer MOTS, analyze the effect of the localized NEC violation on the signs of $\\mathcal{L}_{\\ell} \\theta_{(\\ell)}$ and $\\mathcal{L}_{n} \\theta_{(\\ell)}$ on the MTT during $v \\in (v_{1}, v_{2})$. From these signs, deduce the sign of $C$ in this interval and determine whether the MTT segment is spacelike, null, or timelike. Finally, infer the sign of the area change of the cross-sections $\\mathcal{S}_{v}$ along $h^{a}$ during the interval $v \\in (v_{1}, v_{2})$.\n\nSelect the option that correctly states the conclusions for the interval $v \\in (v_{1}, v_{2})$.\n\nA. With $T_{ab} \\ell^{a} \\ell^{b}  0$ localized near the horizon and $\\mathcal{L}_{n} \\theta_{(\\ell)}  0$ (future outer condition), one has $\\mathcal{L}_{\\ell} \\theta_{(\\ell)}  0$, hence $C  0$, so the MTT segment is timelike and the area of $\\mathcal{S}_{v}$ decreases along $h^{a}$.\n\nB. With $T_{ab} \\ell^{a} \\ell^{b}  0$ localized near the horizon and $\\mathcal{L}_{n} \\theta_{(\\ell)}  0$, one has $\\mathcal{L}_{\\ell} \\theta_{(\\ell)}  0$, hence $C  0$, so the MTT segment is spacelike and the area of $\\mathcal{S}_{v}$ increases along $h^{a}$.\n\nC. With $T_{ab} \\ell^{a} \\ell^{b}  0$ localized near the horizon and $\\mathcal{L}_{n} \\theta_{(\\ell)}  0$, one has $\\mathcal{L}_{\\ell} \\theta_{(\\ell)} = 0$, hence $C = 0$, so the MTT segment is null (isolated) and the area of $\\mathcal{S}_{v}$ is constant along $h^{a}$.\n\nD. Regardless of the sign of $T_{ab} \\ell^{a} \\ell^{b}$, the sign of $\\mathcal{L}_{n} \\theta_{(\\ell)}$ does not affect the signature of the MTT, so $C$ cannot be inferred from these data.",
            "solution": "The problem statement will first be validated for scientific soundness, consistency, and completeness.\n\n### Step 1: Extract Givens\n-   **Spacetime and Geometry**: Spherically symmetric collapse spacetime containing a foliation of closed, marginally outer trapped surfaces (MOTS), denoted $\\mathcal{S}_{v}$. The 3-surface generated by this foliation is the marginally trapped tube (MTT).\n-   **Null Normals**: $\\ell^{a}$ (outward) and $n^{a}$ (inward) are future-directed null normal vectors to $\\mathcal{S}_{v}$, normalized such that $\\ell^{a} n_{a} = -1$.\n-   **MOTS Conditions**: On each surface $\\mathcal{S}_{v}$, the expansion of the outward null congruence is zero ($\\theta_{(\\ell)} = 0$) and the expansion of the inward null congruence is negative ($\\theta_{(n)}  0$).\n-   **Symmetry Conditions**: Due to spherical symmetry, the shear of the outgoing congruence is zero ($\\sigma^{2}_{(\\ell)} = 0$) and the twist is zero.\n-   **Matter Content and Energy Conditions**:\n    -   In the interval of advanced time $v \\in (v_{1}, v_{2})$, an ingoing null shell carries negative energy density, such that $T_{ab} \\ell^{a} \\ell^{b}  0$ on and near the MOTS.\n    -   Outside this interval, the Null Energy Condition (NEC) holds, $T_{ab} \\ell^{a} \\ell^{b} \\ge 0$.\n-   **MTT Tangent Vector**: $h^{a}$ is a future-directed vector field tangent to the MTT and orthogonal to each $\\mathcal{S}_{v}$. It is decomposed as $h^{a} = \\ell^{a} - C\\, n^{a}$, where $C$ is a scalar function on the MTT.\n-   **MTT Signature**: The causal nature of the MTT is determined by the sign of $C$ through the relation $h^{a} h_{a} = 2 C$.\n-   **Future Outer Condition**: The problem refers to a \"future outer MOTS\". This is a standard stability condition in the theory of dynamical horizons, which implies a specific sign for the derivative of $\\theta_{(\\ell)}$ in the inward null direction.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is formulated within the established framework of general relativity, specifically the theory of dynamical horizons and trapped surfaces.\n-   **Scientifically Grounded**: All concepts—MOTS, MTT, Raychaudhuri equation, Einstein's field equations (EFE), and the Null Energy Condition (NEC)—are standard in modern gravitational physics. The scenario of NEC violation is physically motivated by semi-classical effects like Hawking radiation. The problem is scientifically sound.\n-   **Well-Posed**: The problem provides sufficient information and clear objectives. The givens are adequate to uniquely determine the signs of the quantities in question.\n-   **Objective**: The language is technical and precise, free from subjective or ambiguous statements.\n-   **Completeness and Consistency**: The problem statement is self-contained and its conditions are mutually consistent. The setup describes a well-studied physical scenario (an evaporating black hole model).\n\n### Step 3: Verdict and Action\nThe problem statement is valid. A rigorous solution can be derived from the provided information and fundamental principles.\n\n### Derivation\nThe solution proceeds by applying the null Raychaudhuri equation and the Einstein Field Equations to the given geometric setup.\n\n1.  **Analyze $\\mathcal{L}_{\\ell} \\theta_{(\\ell)}$**:\n    The evolution of the expansion $\\theta_{(\\ell)}$ along the outgoing null congruence generated by $\\ell^a$ is governed by the null Raychaudhuri equation:\n    $$ \\mathcal{L}_{\\ell} \\theta_{(\\ell)} = -\\frac{1}{2}\\theta_{(\\ell)}^2 - \\sigma_{ab}^{(\\ell)} \\sigma^{(\\ell)ab} + \\omega_{ab}^{(\\ell)} \\omega^{(\\ell)ab} - R_{ab} \\ell^a \\ell^b $$\n    where $\\mathcal{L}_{\\ell}$ is the Lie derivative along $\\ell^a$.\n    We apply the conditions given in the problem on the MOTS $\\mathcal{S}_v$:\n    -   Marginally trapped condition: $\\theta_{(\\ell)} = 0$.\n    -   Spherical symmetry implies zero shear and twist: $\\sigma_{ab}^{(\\ell)} = 0$ and $\\omega_{ab}^{(\\ell)} = 0$.\n    Substituting these into the Raychaudhuri equation simplifies it to:\n    $$ \\mathcal{L}_{\\ell} \\theta_{(\\ell)} = -R_{ab} \\ell^a \\ell^b $$\n    Next, we use the Einstein Field Equations, $G_{ab} = R_{ab} - \\frac{1}{2} R g_{ab} = 8 \\pi T_{ab}$ (in units where $G=c=1$). This can be rewritten as $R_{ab} = 8 \\pi (T_{ab} - \\frac{1}{2} T g_{ab})$. Contracting with $\\ell^a \\ell^b$ and using the fact that $\\ell^a$ is a null vector ($g_{ab}\\ell^a\\ell^b=0$), we get:\n    $$ R_{ab} \\ell^a \\ell^b = 8 \\pi (T_{ab} \\ell^a \\ell^b - \\frac{1}{2} T g_{ab} \\ell^a \\ell^b) = 8 \\pi T_{ab} \\ell^a \\ell^b $$\n    Combining these results yields a direct relation between the matter content and the geometry:\n    $$ \\mathcal{L}_{\\ell} \\theta_{(\\ell)} = -8 \\pi T_{ab} \\ell^a \\ell^b $$\n    In the interval $v \\in (v_{1}, v_{2})$, the problem states that the NEC is violated such that $T_{ab} \\ell^a \\ell^b  0$. Since $-8\\pi$ is a negative constant, we can determine the sign of $\\mathcal{L}_{\\ell} \\theta_{(\\ell)}$:\n    $$ \\mathcal{L}_{\\ell} \\theta_{(\\ell)} = (-8\\pi) \\times (T_{ab} \\ell^a \\ell^b  0)  0 $$\n    So, in the specified interval, $\\mathcal{L}_{\\ell} \\theta_{(\\ell)}  0$.\n\n2.  **Determine the sign of $C$ and the MTT signature**:\n    The vector $h^a = \\ell^a - C n^a$ is tangent to the MTT. By definition, the condition $\\theta_{(\\ell)} = 0$ holds for all surfaces $\\mathcal{S}_v$ that constitute the MTT. Therefore, the derivative of $\\theta_{(\\ell)}$ along any direction tangent to the MTT must be zero. In particular, the Lie derivative along $h^a$ must vanish:\n    $$ \\mathcal{L}_h \\theta_{(\\ell)} = 0 $$\n    Using the decomposition of $h^a$:\n    $$ \\mathcal{L}_h \\theta_{(\\ell)} = \\mathcal{L}_{\\ell^a - C n^a} \\theta_{(\\ell)} = \\mathcal{L}_{\\ell} \\theta_{(\\ell)} - C \\mathcal{L}_{n} \\theta_{(\\ell)} = 0 $$\n    This gives us an expression for the scalar $C$:\n    $$ C = \\frac{\\mathcal{L}_{\\ell} \\theta_{(\\ell)}}{\\mathcal{L}_{n} \\theta_{(\\ell)}} $$\n    The numerator is positive, as shown above. The denominator's sign comes from the \"future outer MOTS\" condition. A future outer trapping horizon (a type of dynamical horizon) is defined by the stability condition $\\mathcal{L}_{n} \\theta_{(\\ell)}  0$. This means that moving infinitesimally along the inward null direction $n^a$ from the MOTS (where $\\theta_{(\\ell)}=0$) leads to a region where $\\theta_{(\\ell)}$ is negative, i.e., the surfaces become strictly trapped.\n    With $\\mathcal{L}_{\\ell} \\theta_{(\\ell)}  0$ and $\\mathcal{L}_{n} \\theta_{(\\ell)}  0$, the sign of $C$ is:\n    $$ C = \\frac{(+)}{(-)}  0 $$\n    The causal nature (signature) of the MTT segment is given by $h^a h_a = 2C$. Since $C  0$, we have $h^a h_a  0$. A non-zero vector with a negative squared norm is **timelike**. Thus, the MTT segment for $v \\in (v_{1}, v_{2})$ is timelike.\n\n3.  **Determine the area change**:\n    The rate of change of the area $A$ of the cross-sections $\\mathcal{S}_v$ along the vector field $h^a$ is given by $\\mathcal{L}_h A$. Due to spherical symmetry, the area change can be expressed in terms of the expansions:\n    $$ \\mathcal{L}_h A = A \\left( \\theta_{(\\ell)} - C \\theta_{(n)} \\right) $$\n    On the MOTS, we have $\\theta_{(\\ell)} = 0$, so the expression simplifies to:\n    $$ \\mathcal{L}_h A = - C \\theta_{(n)} A $$\n    We can determine the sign of this expression:\n    -   We found $C  0$, which implies $-C  0$.\n    -   The problem states the surfaces are trapped, which means $\\theta_{(n)}  0$.\n    -   The area $A$ is intrinsically positive, $A  0$.\n    Combining these signs:\n    $$ \\mathcal{L}_h A = (-C) \\times (\\theta_{(n)}) \\times (A) = (+) \\times (-) \\times (+)  0 $$\n    Therefore, the area of the MOTS cross-sections **decreases** along the vector $h^a$ during the interval $v \\in (v_{1}, v_{2})$. This corresponds to the physical picture of an evaporating black hole.\n\n### Option-by-Option Analysis\n\n*   **A. With $T_{ab} \\ell^{a} \\ell^{b}  0$ localized near the horizon and $\\mathcal{L}_{n} \\theta_{(\\ell)}  0$ (future outer condition), one has $\\mathcal{L}_{\\ell} \\theta_{(\\ell)}  0$, hence $C  0$, so the MTT segment is timelike and the area of $\\mathcal{S}_{v}$ decreases along $h^{a}$.**\n    This statement perfectly matches all the conclusions derived from first principles:\n    -   $\\mathcal{L}_{\\ell} \\theta_{(\\ell)}  0$ is correct.\n    -   $C  0$ is correct.\n    -   The MTT segment being timelike is correct.\n    -   The area decreasing along $h^a$ is correct.\n    Verdict: **Correct**.\n\n*   **B. With $T_{ab} \\ell^{a} \\ell^{b}  0$ localized near the horizon and $\\mathcal{L}_{n} \\theta_{(\\ell)}  0$, one has $\\mathcal{L}_{\\ell} \\theta_{(\\ell)}  0$, hence $C  0$, so the MTT segment is spacelike and the area of $\\mathcal{S}_{v}$ increases along $h^{a}$.**\n    This option correctly identifies that $\\mathcal{L}_{\\ell} \\theta_{(\\ell)}  0$. However, it incorrectly deduces that $C  0$. Given $\\mathcal{L}_{n} \\theta_{(\\ell)}  0$, $C$ must be negative. Consequently, the claims that the MTT is spacelike and that the area increases are also incorrect.\n    Verdict: **Incorrect**.\n\n*   **C. With $T_{ab} \\ell^{a} \\ell^{b}  0$ localized near the horizon and $\\mathcal{L}_{n} \\theta_{(\\ell)}  0$, one has $\\mathcal{L}_{\\ell} \\theta_{(\\ell)} = 0$, hence $C = 0$, so the MTT segment is null (isolated) and the area of $\\mathcal{S}_{v}$ is constant along $h^{a}$.**\n    This option incorrectly states that $\\mathcal{L}_{\\ell} \\theta_{(\\ell)} = 0$. This would only be true if $T_{ab} \\ell^a \\ell^b = 0$, which contradicts the premise of NEC violation. All subsequent conclusions are based on this false premise.\n    Verdict: **Incorrect**.\n\n*   **D. Regardless of the sign of $T_{ab} \\ell^{a} \\ell^{b}$, the sign of $\\mathcal{L}_{n} \\theta_{(\\ell)}$ does not affect the signature of the MTT, so $C$ cannot be inferred from these data.**\n    This statement is fundamentally incorrect. The derivation shows that $C = \\mathcalL_{\\ell} \\theta_{(\\ell)} / \\mathcal{L}_{n} \\theta_{(\\ell)}$. The sign of the denominator, $\\mathcal{L}_{n} \\theta_{(\\ell)}$, is crucial in determining the sign of $C$, and therefore the signature of the MTT. The sign of $C$ can be and was inferred from the data.\n    Verdict: **Incorrect**.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "The theoretical framework of dynamical horizons and their associated flux laws finds its ultimate test in numerical simulations. This computational exercise bridges the gap between analytical theory and practice by tasking you with verifying the instantaneous first law of black hole mechanics. By implementing and comparing two different numerical methods for calculating the energy flux, you will gain hands-on experience with the kind of verification procedures that are essential for validating complex numerical relativity codes and extracting physical results from them .",
            "id": "3472226",
            "problem": "You are tasked with testing the instantaneous first-law balance on a future outer trapping horizon by comparing two time-local rates constructed from independent definitions. Work in geometric units with $G=c=1$. All angles are in radians. Implement a program that, for each provided case, computes two functions of the foliation parameter $v$: (i) the product $Q_1(v) = \\left(\\kappa(v)/8\\pi\\right)\\, dA/dv$ using a numerical derivative of the area $A(v)$, and (ii) the rate $Q_2(v) = dE_{\\mathrm{H}}/dv$ obtained from flux integrals defined below. Then, for each case, return the maximum absolute mismatch $\\max_v |Q_1(v)-Q_2(v)|$ over the prescribed $v$-grid.\n\nBase your work only on the following fundamental definitions and facts:\n- The cross-section area of a spherical surface of areal radius $R(v)$ is $A(v)=4\\pi R(v)^2$.\n- The surface gravity along the horizon foliation is given as a prescribed function $v\\mapsto \\kappa(v)$.\n- The instantaneous energy accumulation rate along the horizon is defined by the flux integral\n  $$\\frac{dE_{\\mathrm{H}}}{dv}(v) = \\int_{S_v} \\mu(\\theta,\\phi;v)\\, dS + \\frac{1}{16\\pi}\\int_{S_v} \\|\\sigma\\|^2(\\theta,\\phi;v)\\, dS,$$\n  where $\\mu(\\theta,\\phi;v)$ is the matter energy density $\\mu=T_{ab}\\,\\ell^a n^b$, $\\|\\sigma\\|^2(\\theta,\\phi;v)$ is the squared norm of the shear of the outgoing null normal, and the area element on the spherical cross-section is $dS = R(v)^2 \\sin\\theta\\, d\\theta\\, d\\phi$.\n- The numerical derivative $dA/dv$ must be computed from samples $A(v_i)$ using a second-order central difference at interior points and a first-order one-sided difference at the endpoints.\n\nYour program must compute the above quantities for the following three cases. In all cases, use the same angular quadrature rule: a tensor-product midpoint rule on a spherical grid with $N_\\theta=64$ polar samples and $N_\\phi=96$ azimuthal samples. That is, let $\\Delta\\theta=\\pi/N_\\theta$, $\\Delta\\phi=2\\pi/N_\\phi$, and sample $\\theta_i = (i+\\tfrac{1}{2})\\Delta\\theta$ for $i=0,\\dots,N_\\theta-1$ and $\\phi_j = (j+\\tfrac{1}{2})\\Delta\\phi$ for $j=0,\\dots,N_\\phi-1$. Approximate integrals by weighted sums with weights $R(v)^2 \\sin\\theta_i \\Delta\\theta \\Delta\\phi$.\n\nIn every case, the angular dependence of the matter and gravitational-wave flux densities is prescribed via positive shape functions with unit average over the sphere. Specifically, define raw shapes\n$$G_0(\\theta,\\phi;v) = \\left[1 + a_2(v) P_2(\\cos\\theta) + a_3(v) P_3(\\cos\\theta) + a_4(v) P_4(\\cos\\theta) + b(v)\\,\\sin(m\\phi)\\,\\sin^2\\theta\\right]^2,$$\n$$H_0(\\theta,\\phi;v) = \\left[1 + c_1(v)\\cos\\theta + c_2(v)\\,\\sin^2\\theta\\cos(m'\\phi)\\right]^2,$$\nwith Legendre polynomials $P_2(x)=\\tfrac{1}{2}(3x^2-1)$, $P_3(x)=\\tfrac{1}{2}(5x^3-3x)$, and $P_4(x)=\\tfrac{1}{8}(35x^4-30x^2+3)$. Normalize these to unit average over the sphere using the numerical quadrature described above:\n$$g(\\theta,\\phi;v) = \\frac{G_0(\\theta,\\phi;v)}{\\langle G_0\\rangle(v)}, \\quad h(\\theta,\\phi;v) = \\frac{H_0(\\theta,\\phi;v)}{\\langle H_0\\rangle(v)},$$\nwhere $\\langle X\\rangle(v) = \\frac{1}{A(v)}\\int_{S_v} X(\\theta,\\phi;v)\\, dS$.\n\nFor each case, the matter and gravitational-wave densities are then\n$$\\mu(\\theta,\\phi;v) = M_0(v)\\, h(\\theta,\\phi;v), \\qquad \\|\\sigma\\|^2(\\theta,\\phi;v) = S_0(v)\\, g(\\theta,\\phi;v),$$\nwith $M_0(v)$ and $S_0(v)$ prescribed functions below.\n\nCase 1 (vacuum, strong distortions):\n- Foliation parameter grid: $v\\in[0,10]$ sampled uniformly at $N_v=33$ points.\n- Areal radius: $R(v) = 5.0 + 0.4 v + 0.7 \\exp\\!\\left(-\\tfrac{1}{2}(v-6)^2\\right) + 0.05 \\sin(2.2 v)$, so $A(v)=4\\pi R(v)^2$.\n- Surface gravity: $\\kappa(v) = 0.2 + 0.05 \\cos(0.6 v)$.\n- Matter fraction: $p(v) = 0$.\n- Coefficients: $a_2(v)=0.9\\,\\mathrm{sech}\\!\\left(0.5\\,(v-6)\\right)$, $a_3(v)=0.5\\,\\tanh\\!\\left(0.3\\,(v-4)\\right)$, $a_4(v)=0.4\\,\\sin(1.7 v)$, $b(v)=0.8\\,\\sin(0.4 v)$, $m=3$; for $H_0$, set $c_1(v)=0.3\\,\\sin(0.9 v)$, $c_2(v)=0.2\\,\\cos(1.1 v)$, $m'=2$ (these do not affect the vacuum integral but must be constructed as specified).\n- Amplitudes: Let $A'(v)$ denote the exact derivative of $A(v)$ with respect to $v$ obtained analytically from $R(v)$. Define the total desired flux level $F_{\\mathrm{tot}}(v) = \\left(\\kappa(v)/8\\pi\\right) A'(v)$. Then set $M_0(v)=p(v)\\,F_{\\mathrm{tot}}(v)/A(v)=0$, and $S_0(v) = 16\\pi\\,[1-p(v)]\\,F_{\\mathrm{tot}}(v)/A(v) = 16\\pi\\,F_{\\mathrm{tot}}(v)/A(v)$.\n\nCase 2 (mixed matter and gravitational-wave flux, boundary-sensitive):\n- Foliation parameter grid: $v\\in[0,3]$ sampled uniformly at $N_v=41$ points.\n- Areal radius: $R(v) = 3.0 + 0.7 v + 0.12 \\sin(3.3 v) + 0.1 \\exp\\!\\left(-(v-1.5)^2\\right)$, so $A(v)=4\\pi R(v)^2$.\n- Surface gravity: $\\kappa(v) = 0.35 - 0.1\\, v/(1+v)$.\n- Matter fraction: $p(v) = 0.5 + 0.3 \\sin(v)$.\n- Coefficients: $a_2(v)=0.6\\,\\cos(0.7 v)$, $a_3(v)=0.4\\,\\sin(1.1 v)$, $a_4(v)=0.5\\,\\tanh\\!\\left(0.5 (v-1.5)\\right)$, $b(v)=0.5\\,\\cos(0.8 v)$, $m=4$; for $H_0$, $c_1(v)=0.4\\,\\cos(1.3 v)$, $c_2(v)=0.35\\,\\sin(1.7 v)$, $m'=3$.\n- Amplitudes: With $A'(v)$ the exact derivative corresponding to $R(v)$, define $F_{\\mathrm{tot}}(v) = \\left(\\kappa(v)/8\\pi\\right) A'(v)$, then $M_0(v)=p(v)\\,F_{\\mathrm{tot}}(v)/A(v)$, and $S_0(v)=16\\pi\\,[1-p(v)]\\,F_{\\mathrm{tot}}(v)/A(v)$.\n\nCase 3 (small surface gravity, strong driving):\n- Foliation parameter grid: $v\\in[0,5]$ sampled uniformly at $N_v=37$ points.\n- Areal radius: $R(v) = 10.0 + 1.5 v + 0.15 \\sin(4.5 v) + 0.3 \\exp\\!\\left(-0.3\\,(v-2.5)^2\\right)$, so $A(v)=4\\pi R(v)^2$.\n- Surface gravity: $\\kappa(v) = 0.05 + 0.02 \\cos(1.8 v)$.\n- Matter fraction: $p(v) = 0.2 + 0.2 \\sin(0.7 v)$.\n- Coefficients: $a_2(v)=0.7\\,\\mathrm{sech}\\!\\left(0.4\\,(v-2.5)\\right)$, $a_3(v)=0.5\\,\\cos(1.2 v)$, $a_4(v)=0.6\\,\\sin(1.9 v)$, $b(v)=0.7\\,\\sin(0.9 v)$, $m=5$; for $H_0$, $c_1(v)=0.25\\,\\sin(0.8 v)$, $c_2(v)=0.3\\,\\cos(1.4 v)$, $m'=4$.\n- Amplitudes: With $A'(v)$ the exact derivative corresponding to $R(v)$, define $F_{\\mathrm{tot}}(v) = \\left(\\kappa(v)/8\\pi\\right) A'(v)$, then $M_0(v)=p(v)\\,F_{\\mathrm{tot}}(v)/A(v)$, and $S_0(v)=16\\pi\\,[1-p(v)]\\,F_{\\mathrm{tot}}(v)/A(v)$.\n\nImplementation requirements:\n- For each case, compute $Q_1(v_i) = \\left(\\kappa(v_i)/8\\pi\\right) \\left.dA/dv\\right|_{v_i}$ using the specified finite differences on the sampled $A(v_i)$ values.\n- For each case, compute $Q_2(v_i)$ by numerically integrating the flux densities with the prescribed quadrature to evaluate the two integrals in the definition of $dE_{\\mathrm{H}}/dv(v)$.\n- For each case, compute the single scalar\n  $$\\mathrm{mismatch} = \\max_i \\left| Q_1(v_i) - Q_2(v_i) \\right|,$$\n  reported as a floating-point number in geometric units (no unit symbol in the output; numbers are pure in $G=c=1$ units).\n- Your program should produce a single line of output containing the results for the three cases as a comma-separated list enclosed in square brackets, for example $[x_1,x_2,x_3]$, where each $x_k$ is the mismatch for case $k$.\n\nTest suite coverage rationale:\n- Case $1$ exercises a vacuum, shear-dominated regime with strongly time-dependent angular structure.\n- Case $2$ includes a nonzero matter flux and requires correct handling of boundary finite differences at the endpoints of the $v$-grid.\n- Case $3$ probes small surface gravity with strong driving, ensuring numerical stability when $A'(v)$ is large and $\\kappa(v)$ is small.\n\nAll numerical values must be reported in geometric units with $G=c=1$ as specified, with angles in radians. The output must be a single line in the exact format $[x_1,x_2,x_3]$.",
            "solution": "The user has provided a computational problem situated in the field of numerical relativity, concerning the verification of the first law of mechanics for a future outer trapping horizon (FOTH), also known as a dynamical horizon. The problem is well-posed, scientifically grounded, and contains all necessary information to proceed with a unique, verifiable solution. It represents a numerical verification task where a physical law is tested by comparing two quantities, one of which is computed via numerical differentiation and the other via numerical integration, with the problem setup designed such that any discrepancy arises primarily from the truncation error of the numerical derivative.\n\nThe core of the problem is to compute and compare two rates of change for each of three specified scenarios. Let $v$ be a parameter foliating a sequence of spherical cross-sections of the horizon.\n\nThe first quantity, $Q_1(v)$, is an approximation of the energy change rate based on the horizon's area expansion. It is defined as:\n$$Q_1(v) = \\frac{\\kappa(v)}{8\\pi} \\frac{dA}{dv}$$\nHere, $\\kappa(v)$ is the given surface gravity, and $A(v) = 4\\pi R(v)^2$ is the horizon's cross-sectional area, with $R(v)$ being the specified areal radius. The derivative $dA/dv$ is computed numerically from a discrete set of samples $A(v_i)$ on a uniform grid $v_i$. As per the problem specification, a second-order central difference scheme is used for interior points of the grid, and a first-order one-sided difference is used at the two endpoints. This can be efficiently implemented using `numpy.gradient` with `edge_order=1`.\n\nThe second quantity, $Q_2(v)$, represents the rate of energy accumulation, defined as the total flux of matter and gravitational waves crossing the horizon. Its definition is given by the surface integral:\n$$Q_2(v) = \\frac{dE_{\\mathrm{H}}}{dv}(v) = \\int_{S_v} \\mu(\\theta,\\phi;v)\\, dS + \\frac{1}{16\\pi}\\int_{S_v} \\|\\sigma\\|^2(\\theta,\\phi;v)\\, dS$$\nwhere $\\mu$ is the matter energy density and $\\|\\sigma\\|^2$ is the squared norm of the shear of the outgoing null normal, representing gravitational wave energy flux. The integration is performed over the spherical cross-section $S_v$ with area element $dS = R(v)^2 \\sin\\theta\\, d\\theta\\, d\\phi$.\n\nThe problem provides detailed prescriptions for the flux densities $\\mu$ and $\\|\\sigma\\|^2$. They are constructed from amplitude functions $M_0(v)$ and $S_0(v)$ and normalized angular shape functions $g(\\theta,\\phi;v)$ and $h(\\theta,\\phi;v)$:\n$$\\mu(\\theta,\\phi;v) = M_0(v)\\, h(\\theta,\\phi;v), \\qquad \\|\\sigma\\|^2(\\theta,\\phi;v) = S_0(v)\\, g(\\theta,\\phi;v)$$\nThe shape functions $g$ and $h$ are derived from raw shapes $G_0$ and $H_0$ by normalizing them to have a unit average over the sphere. The average is defined as $\\langle X\\rangle(v) = \\frac{1}{A(v)}\\int_{S_v} X dS$. The integrals required for both the normalization and the final calculation of $Q_2(v)$ are to be computed numerically using a tensor-product midpoint rule on a specified spherical grid $(\\theta_i, \\phi_j)$.\n\nA crucial aspect of the problem's design is how the amplitudes $M_0(v)$ and $S_0(v)$ are defined. They depend on a total flux $F_{\\mathrm{tot}}(v) = (\\kappa(v)/8\\pi) A'(v)$, where $A'(v)$ is the **exact analytical** derivative of the area function $A(v)$. The amplitudes are then set as $M_0(v) = p(v)F_{\\mathrm{tot}}(v)/A(v)$ and $S_0(v) = 16\\pi[1-p(v)]F_{\\mathrm{tot}}(v)/A(v)$, where $p(v)$ is a given matter fraction. By substituting these into the definition of $Q_2(v)$ and using the fact that the normalized shape functions integrate to the area $A(v)$ (i.e., $\\int_S g dS = \\int_S h dS = A(v)$), we find:\n$$Q_2(v) = M_0(v)A(v) + \\frac{1}{16\\pi}S_0(v)A(v) = p(v)F_{\\mathrm{tot}}(v) + [1-p(v)]F_{\\mathrm{tot}}(v) = F_{\\mathrm{tot}}(v)$$\nTherefore, $Q_2(v)$ is analytically identical to $(\\kappa(v)/8\\pi)A'_{\\text{exact}}(v)$.\n\nThe final task is to compute the maximum absolute mismatch between the two numerically computed quantities:\n$$\\mathrm{mismatch} = \\max_i | Q_1(v_i) - Q_2(v_i) |$$\nThis mismatch primarily quantifies the error introduced by the finite-difference approximation of $dA/dv$ in $Q_1(v)$ compared to the value of $Q_2(v)$, which is constructed to be numerically very close to the exact analytical expression. Any minor deviation in the calculation of $Q_2$ will be due to the floating-point precision of the angular quadrature, which is expected to be much smaller than the derivative's truncation error given the fine angular grid.\n\nThe algorithm proceeds as follows for each case:\n1.  Define all case-specific functions ($R(v)$, $R'(v)$, $\\kappa(v)$, etc.) and parameters.\n2.  Generate the uniform time grid $v_i$.\n3.  Calculate the area $A(v_i)$ at each grid point.\n4.  Compute the numerical derivative $(dA/dv)_i$ using `numpy.gradient` and subsequently calculate the array $Q_1(v_i)$.\n5.  Set up the angular quadrature grid $(\\theta_i, \\phi_j)$ and associated weights.\n6.  Iterate through each time step $v_i$:\n    a.  Compute the angular shape functions $G_0$ and $H_0$ on the angular grid.\n    b.  Numerically compute their averages $\\langle G_0 \\rangle$ and $\\langle H_0 \\rangle$ and normalize them to get $g$ and $h$.\n    c.  Calculate the analytical derivative $A'(v_i) = 8\\pi R(v_i) R'(v_i)$.\n    d.  Determine the amplitudes $M_0(v_i)$ and $S_0(v_i)$.\n    e.  Construct the flux densities $\\mu$ and $\\|\\sigma\\|^2$ on the angular grid.\n    f.  Numerically integrate the fluxes to find $Q_2(v_i)$.\n7.  Compute the maximum absolute difference between the $Q_1$ and $Q_2$ arrays.\n\nThis procedure is repeated for all three cases to obtain the final list of mismatch values.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the maximum mismatch between two calculations of horizon energy flux\n    for three distinct test cases in numerical relativity.\n    \"\"\"\n\n    def P2(x):\n        return 0.5 * (3 * x**2 - 1)\n\n    def P3(x):\n        return 0.5 * (5 * x**3 - 3 * x)\n\n    def P4(x):\n        return 0.125 * (35 * x**4 - 30 * x**2 + 3)\n\n    def sech(x):\n        return 1.0 / np.cosh(x)\n\n    # Define the three cases with all their specific parameters and functions.\n    test_cases = [\n        # Case 1: Vacuum, strong distortions\n        {\n            \"v_range\": [0, 10], \"N_v\": 33,\n            \"R\": lambda v: 5.0 + 0.4 * v + 0.7 * np.exp(-0.5 * (v - 6)**2) + 0.05 * np.sin(2.2 * v),\n            \"R_prime\": lambda v: 0.4 - 0.7 * (v - 6) * np.exp(-0.5 * (v - 6)**2) + 0.05 * 2.2 * np.cos(2.2 * v),\n            \"kappa\": lambda v: 0.2 + 0.05 * np.cos(0.6 * v),\n            \"p\": lambda v: 0.0,\n            \"a2\": lambda v: 0.9 * sech(0.5 * (v - 6)),\n            \"a3\": lambda v: 0.5 * np.tanh(0.3 * (v - 4)),\n            \"a4\": lambda v: 0.4 * np.sin(1.7 * v),\n            \"b\": lambda v: 0.8 * np.sin(0.4 * v), \"m\": 3,\n            \"c1\": lambda v: 0.3 * np.sin(0.9 * v),\n            \"c2\": lambda v: 0.2 * np.cos(1.1 * v), \"m_prime\": 2,\n        },\n        # Case 2: Mixed flux, boundary-sensitive\n        {\n            \"v_range\": [0, 3], \"N_v\": 41,\n            \"R\": lambda v: 3.0 + 0.7 * v + 0.12 * np.sin(3.3 * v) + 0.1 * np.exp(-(v - 1.5)**2),\n            \"R_prime\": lambda v: 0.7 + 0.12 * 3.3 * np.cos(3.3 * v) - 0.2 * (v - 1.5) * np.exp(-(v - 1.5)**2),\n            \"kappa\": lambda v: 0.35 - 0.1 * v / (1 + v),\n            \"p\": lambda v: 0.5 + 0.3 * np.sin(v),\n            \"a2\": lambda v: 0.6 * np.cos(0.7 * v),\n            \"a3\": lambda v: 0.4 * np.sin(1.1 * v),\n            \"a4\": lambda v: 0.5 * np.tanh(0.5 * (v - 1.5)),\n            \"b\": lambda v: 0.5 * np.cos(0.8 * v), \"m\": 4,\n            \"c1\": lambda v: 0.4 * np.cos(1.3 * v),\n            \"c2\": lambda v: 0.35 * np.sin(1.7 * v), \"m_prime\": 3,\n        },\n        # Case 3: Small surface gravity, strong driving\n        {\n            \"v_range\": [0, 5], \"N_v\": 37,\n            \"R\": lambda v: 10.0 + 1.5 * v + 0.15 * np.sin(4.5 * v) + 0.3 * np.exp(-0.3 * (v - 2.5)**2),\n            \"R_prime\": lambda v: 1.5 + 0.15 * 4.5 * np.cos(4.5 * v) - 0.18 * (v - 2.5) * np.exp(-0.3 * (v - 2.5)**2),\n            \"kappa\": lambda v: 0.05 + 0.02 * np.cos(1.8 * v),\n            \"p\": lambda v: 0.2 + 0.2 * np.sin(0.7 * v),\n            \"a2\": lambda v: 0.7 * sech(0.4 * (v - 2.5)),\n            \"a3\": lambda v: 0.5 * np.cos(1.2 * v),\n            \"a4\": lambda v: 0.6 * np.sin(1.9 * v),\n            \"b\": lambda v: 0.7 * np.sin(0.9 * v), \"m\": 5,\n            \"c1\": lambda v: 0.25 * np.sin(0.8 * v),\n            \"c2\": lambda v: 0.3 * np.cos(1.4 * v), \"m_prime\": 4,\n        }\n    ]\n\n    def solve_case(params):\n        # 1. Setup grids\n        v_grid = np.linspace(params[\"v_range\"][0], params[\"v_range\"][1], params[\"N_v\"])\n        dv = v_grid[1] - v_grid[0]\n        \n        N_theta, N_phi = 64, 96\n        d_theta = np.pi / N_theta\n        d_phi = 2 * np.pi / N_phi\n        theta = (np.arange(N_theta) + 0.5) * d_theta\n        phi = (np.arange(N_phi) + 0.5) * d_phi\n        THETA, PHI = np.meshgrid(theta, phi, indexing='ij')\n\n        # 2. Compute Q1(v)\n        R_v = params[\"R\"](v_grid)\n        A_v = 4 * np.pi * R_v**2\n        kappa_v = params[\"kappa\"](v_grid)\n        \n        dA_dv_numerical = np.gradient(A_v, dv, edge_order=1)\n        Q1 = (kappa_v / (8 * np.pi)) * dA_dv_numerical\n\n        # 3. Compute Q2(v)\n        Q2 = np.zeros_like(v_grid)\n        \n        costheta = np.cos(THETA)\n        sintheta = np.sin(THETA)\n        P2_grid = P2(costheta)\n        P3_grid = P3(costheta)\n        P4_grid = P4(costheta)\n        d_area_element = sintheta * d_theta * d_phi\n\n        for i, v in enumerate(v_grid):\n            # Evaluate coefficients at current v\n            a2, a3, a4, b = params[\"a2\"](v), params[\"a3\"](v), params[\"a4\"](v), params[\"b\"](v)\n            c1, c2 = params[\"c1\"](v), params[\"c2\"](v)\n            m, m_prime = params[\"m\"], params[\"m_prime\"]\n\n            # Compute raw shape functions G0, H0\n            G0 = (1 + a2*P2_grid + a3*P3_grid + a4*P4_grid + b*np.sin(m*PHI)*sintheta**2)**2\n            H0 = (1 + c1*costheta + c2*(sintheta**2)*np.cos(m_prime*PHI))**2\n\n            # Compute normalization factors\n            avg_G0 = (1 / (4 * np.pi)) * np.sum(G0 * d_area_element)\n            avg_H0 = (1 / (4 * np.pi)) * np.sum(H0 * d_area_element)\n            \n            # Normalized shape functions\n            g = G0 / avg_G0\n            h = H0 / avg_H0\n\n            # Compute flux amplitudes M0, S0\n            R_i = R_v[i]\n            # A_i = A_v[i]\n            # using R_i simplifies the expression below and avoids re-accessing A_v array\n            A_i = 4 * np.pi * R_i**2\n            \n            Rp_i = params[\"R_prime\"](v)\n            A_prime_exact = 8 * np.pi * R_i * Rp_i\n            kappa_i = kappa_v[i]\n            p_i = params[\"p\"](v)\n\n            F_tot = (kappa_i / (8 * np.pi)) * A_prime_exact\n            M0 = p_i * F_tot / A_i\n            S0 = 16 * np.pi * (1 - p_i) * F_tot / A_i\n\n            # Construct flux densities on the grid\n            mu = M0 * h\n            sigma_sq = S0 * g\n            \n            # Compute flux integrals for Q2\n            integral_mu_dS = np.sum(mu * R_i**2 * d_area_element)\n            integral_sigma_sq_dS = np.sum(sigma_sq * R_i**2 * d_area_element)\n            \n            Q2[i] = integral_mu_dS + (1 / (16 * np.pi)) * integral_sigma_sq_dS\n            \n        # 4. Compute mismatch\n        mismatch = np.max(np.abs(Q1 - Q2))\n        return mismatch\n\n    results = [solve_case(case) for case in test_cases]\n    \n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        }
    ]
}