{
    "hands_on_practices": [
        {
            "introduction": "有效单体（EOB）模型的核心思想之一是通过“重整”技术，将后牛顿（PN）理论的微扰展开式转化为在强引力场中更有效和精确的形式。这项练习将引导你完成EOB校准的第一步：通过将一个简化的EOB引力波能量通量形式与已知的PN展开式进行泰勒展开匹配，从而确定EOB模型中的校准系数。通过这项实践，你将亲手揭示EOB参数与基础PN理论之间的直接联系，理解模型构建的理论基石。",
            "id": "3472667",
            "problem": "考虑一个无自旋的致密双星系统，其分量质量为 $m_{1}$ 和 $m_{2}$，总质量为 $M \\equiv m_{1}+m_{2}$，约化质量为 $\\mu \\equiv m_{1} m_{2}/M$，对称质量比为 $\\nu \\equiv \\mu/M \\in (0,1/4]$。该双星系统处于一个轨道角频率为 $\\Omega$ 的准圆形轨道上。在几何单位制中进行计算，其中 $G=c=1$。\n\n1) 从无穷远处辐射的引力波功率的远场横向无迹质量四极辐射公式出发，\n$$\n\\mathcal{F} \\equiv -\\frac{dE}{dt} = \\frac{1}{5}\\,\\Big\\langle \\dddot{I}_{ij}\\,\\dddot{I}_{ij} \\Big\\rangle,\n$$\n其中 $I_{ij}$ 是源的牛顿无迹质量四极矩，尖括号表示在几个轨道周期上的平均值。将该双星系统建模为在牛顿圆周运动中的两个质点，并推导在无穷远处作为轨道频率 $\\Omega$ 的函数的领头阶引力波能量流 $\\mathcal{F}_{\\mathrm{N}}(\\Omega;M,\\nu)$。使用牛顿圆周轨道关系式，并定义规范不变的速度参数 $v \\equiv (M\\Omega)^{1/3}$。\n\n2) 在有效单体 (EOB) 模型中，考虑一个简单的重整能流拟设\n$$\n\\mathcal{F}_{\\mathrm{EOB}}(\\Omega;\\alpha,\\beta) = \\mathcal{F}_{\\mathrm{N}}(\\Omega)\\,\\exp\\!\\big(\\alpha\\,v^{2}+\\beta\\,v^{3}\\big),\n$$\n其中常数 $(\\alpha,\\beta)$ 待标定。将 $\\mathcal{F}_{\\mathrm{EOB}}/\\mathcal{F}_{\\mathrm{N}}$ 的泰勒展开式与经过充分检验的、适用于圆形轨道上无自旋双星系统的后牛顿 (PN) 展开式在相对阶 $v^{2}$ 和 $v^{3}$ 上进行匹配：\n$$\n\\frac{\\mathcal{F}}{\\mathcal{F}_{\\mathrm{N}}} = 1 + C_{2}(\\nu)\\,v^{2} + C_{3}\\,v^{3} + \\mathcal{O}(v^{4}),\n$$\n其中已知系数为\n$$\nC_{2}(\\nu) = -\\frac{1247}{336} - \\frac{35}{12}\\,\\nu, \\qquad C_{3} = 4\\pi.\n$$\n用 $\\nu$ 和已知常数表示 $(\\alpha,\\beta)$。\n\n3) 计算你的表达式中 $\\alpha$ 在等质量值 $\\nu = 1/4$ 时的数值，并给出四舍五入到四位有效数字的结果。你的最终答案应表示为一个纯数（无量纲）。",
            "solution": "该问题经验证具有科学依据、良定、客观且自洽。这是引力波理论领域的标准练习，将按所述进行求解。\n\n### 第一部分：牛顿引力波能流的推导\n\n我们首先将致密双星系统建模为两个质点 $m_{1}$ 和 $m_{2}$，它们在 $x-y$ 平面内作圆周轨道运动。总质量为 $M = m_{1}+m_{2}$，约化质量为 $\\mu = m_{1}m_{2}/M$，对称质量比为 $\\nu = \\mu/M$。在质心系中，它们的位置是 $\\vec{r}_{1} = (m_{2}/M)\\vec{r}$ 和 $\\vec{r}_{2} = -(m_{1}/M)\\vec{r}$，其中 $\\vec{r} = \\vec{r}_{1}-\\vec{r}_{2}$ 是分离矢量。对于一个轨道角频率为 $\\Omega$、分离距离为 $r$ 的圆形轨道，$\\vec{r}$ 的分量为 $x(t) = r\\cos(\\Omega t)$，$y(t) = r\\sin(\\Omega t)$ 和 $z(t)=0$。\n\n质量四极矩张量由 $Q_{ij} = \\sum_{A=1,2} m_{A} x_{A,i} x_{A,j}$ 给出。代入质心位置，我们得到：\n$$\nQ_{ij} = m_{1} \\left(\\frac{m_{2}}{M} x_{i}\\right) \\left(\\frac{m_{2}}{M} x_{j}\\right) + m_{2} \\left(-\\frac{m_{1}}{M} x_{i}\\right) \\left(-\\frac{m_{1}}{M} x_{j}\\right) = \\left( \\frac{m_{1}m_{2}^{2} + m_{2}m_{1}^{2}}{M^{2}} \\right) x_{i}x_{j}\n$$\n$$\nQ_{ij} = \\frac{m_{1}m_{2}(m_{1}+m_{2})}{M^{2}} x_{i}x_{j} = \\frac{\\mu M}{M} x_{i}x_{j} = \\mu x_{i}x_{j}\n$$\n问题需要的是无迹质量四极矩 $I_{ij}$。功率公式 $\\mathcal{F} = \\frac{1}{5}\\langle \\dddot{I}_{ij}\\dddot{I}_{ij} \\rangle$ 中使用的定义指的是四极矩的横向无迹 (TT) 投影。然而，一个标准结果简化了计算：辐射功率可以用源的四极矩的无迹部分来计算，即 $\\mathcal{I}_{ij} = Q_{ij} - \\frac{1}{3}\\delta_{ij}Q_{kk}$。引力波功率为 $\\mathcal{F} = \\frac{1}{5}\\langle \\dddot{\\mathcal{I}}_{ij}\\dddot{\\mathcal{I}}_{ij} \\rangle$。\n迹为 $Q_{kk} = \\sum_{k} Q_{kk} = \\mu (x^{2}+y^{2}+z^{2}) = \\mu r^{2}$。对于圆形轨道，$r$ 是常数，所以迹 $Q_{kk}$ 也是常数。因此，它的三阶时间导数为零，即 $\\dddot{Q}_{kk}=0$。这意味着 $\\dddot{\\mathcal{I}}_{ij} = \\dddot{Q}_{ij}$。因此我们可以计算 $\\langle \\dddot{Q}_{ij}\\dddot{Q}_{ij} \\rangle$。\n\n$Q_{ij}$ 的分量为：\n$$\nQ_{xx} = \\mu r^{2} \\cos^{2}(\\Omega t) = \\frac{1}{2}\\mu r^{2}(1 + \\cos(2\\Omega t))\n$$\n$$\nQ_{yy} = \\mu r^{2} \\sin^{2}(\\Omega t) = \\frac{1}{2}\\mu r^{2}(1 - \\cos(2\\Omega t))\n$$\n$$\nQ_{xy} = \\mu r^{2} \\cos(\\Omega t)\\sin(\\Omega t) = \\frac{1}{2}\\mu r^{2}\\sin(2\\Omega t)\n$$\n所有其他分量（$Q_{zz}$、$Q_{xz}$、$Q_{yz}$）均为零。取三阶时间导数：\n$$\n\\dddot{Q}_{xx} = \\frac{1}{2}\\mu r^{2} \\frac{d^{3}}{dt^{3}}\\cos(2\\Omega t) = \\frac{1}{2}\\mu r^{2} (2\\Omega)^{3}\\sin(2\\Omega t) = 4\\mu r^{2}\\Omega^{3}\\sin(2\\Omega t)\n$$\n$$\n\\dddot{Q}_{yy} = -\\frac{1}{2}\\mu r^{2} \\frac{d^{3}}{dt^{3}}\\cos(2\\Omega t) = -4\\mu r^{2}\\Omega^{3}\\sin(2\\Omega t)\n$$\n$$\n\\dddot{Q}_{xy} = \\frac{1}{2}\\mu r^{2} \\frac{d^{3}}{dt^{3}}\\sin(2\\Omega t) = \\frac{1}{2}\\mu r^{2} (-(2\\Omega)^{3})\\cos(2\\Omega t) = -4\\mu r^{2}\\Omega^{3}\\cos(2\\Omega t)\n$$\n平方和为 $\\dddot{Q}_{ij}\\dddot{Q}_{ij} = \\sum_{i,j=1}^{3} (\\dddot{Q}_{ij})^{2} = (\\dddot{Q}_{xx})^{2} + (\\dddot{Q}_{yy})^{2} + 2(\\dddot{Q}_{xy})^{2}$：\n$$\n\\dddot{Q}_{ij}\\dddot{Q}_{ij} = (16\\mu^{2}r^{4}\\Omega^{6}\\sin^{2}(2\\Omega t)) + (16\\mu^{2}r^{4}\\Omega^{6}\\sin^{2}(2\\Omega t)) + 2(16\\mu^{2}r^{4}\\Omega^{6}\\cos^{2}(2\\Omega t))\n$$\n$$\n= 32\\mu^{2}r^{4}\\Omega^{6}(\\sin^{2}(2\\Omega t) + \\cos^{2}(2\\Omega t)) = 32\\mu^{2}r^{4}\\Omega^{6}\n$$\n这个结果是常数，所以它的时间平均值就是它本身。辐射功率为：\n$$\n\\mathcal{F}_{\\mathrm{N}} = \\frac{1}{5} \\langle \\dddot{I}_{ij}\\dddot{I}_{ij} \\rangle = \\frac{1}{5} (32\\mu^{2}r^{4}\\Omega^{6}) = \\frac{32}{5}\\mu^{2}r^{4}\\Omega^{6}\n$$\n为了用 $M$、$\\nu$ 和 $\\Omega$ 表示这个结果，我们使用牛顿圆周轨道的开普勒第三定律。在几何单位制中（$G=1$），引力与向心力的平衡给出 $\\mu \\Omega^{2} r = \\frac{M\\mu}{r^{2}}$，简化为 $\\Omega^{2} r^{3} = M$。因此，$r = (M/\\Omega^{2})^{1/3}$。\n将此代入能流的表达式：\n$$\n\\mathcal{F}_{\\mathrm{N}} = \\frac{32}{5}\\mu^{2}\\left(\\frac{M}{\\Omega^{2}}\\right)^{4/3}\\Omega^{6} = \\frac{32}{5}\\mu^{2}M^{4/3}\\Omega^{-8/3}\\Omega^{6} = \\frac{32}{5}\\mu^{2}M^{4/3}\\Omega^{10/3}\n$$\n最后，使用 $\\mu = \\nu M$，我们得到所需的牛顿能流表达式：\n$$\n\\mathcal{F}_{\\mathrm{N}}(\\Omega; M, \\nu) = \\frac{32}{5}(\\nu M)^{2}M^{4/3}\\Omega^{10/3} = \\frac{32}{5}\\nu^{2}M^{10/3}\\Omega^{10/3} = \\frac{32}{5}\\nu^{2}(M\\Omega)^{10/3}\n$$\n\n### 第二部分：EOB 参数的标定\n\n给定 EOB 能流拟设 $\\mathcal{F}_{\\mathrm{EOB}} = \\mathcal{F}_{\\mathrm{N}}\\,\\exp(\\alpha\\,v^{2}+\\beta\\,v^{3})$ 和后牛顿 (PN) 展开 $\\mathcal{F}/\\mathcal{F}_{\\mathrm{N}} = 1 + C_{2}(\\nu)\\,v^{2} + C_{3}\\,v^{3} + \\mathcal{O}(v^{4})$。任务是通过将 EOB 模型的泰勒展开与 PN 展开在 $v^2$ 和 $v^3$ 阶上进行匹配来确定标定参数 $(\\alpha, \\beta)$。\n\n我们展开 EOB 能流比中的指数函数：\n$$\n\\frac{\\mathcal{F}_{\\mathrm{EOB}}}{\\mathcal{F}_{\\mathrm{N}}} = \\exp(\\alpha\\,v^{2}+\\beta\\,v^{3})\n$$\n使用指数函数的泰勒级数 $\\exp(x) = 1 + x + x^{2}/2! + \\dots$，其中 $x = \\alpha v^{2} + \\beta v^{3}$：\n$$\n\\exp(\\alpha\\,v^{2}+\\beta\\,v^{3}) = 1 + (\\alpha v^{2} + \\beta v^{3}) + \\frac{1}{2}(\\alpha v^{2} + \\beta v^{3})^{2} + \\mathcal{O}(v^{6})\n$$\n展开并保留到 $v^{3}$ 阶的项：\n$$\n= 1 + \\alpha v^{2} + \\beta v^{3} + \\mathcal{O}(v^{4})\n$$\n现在我们将此展开式的系数与给定的 PN 展开式的系数逐项等同起来。\n$$\n1 + \\alpha v^{2} + \\beta v^{3} + \\mathcal{O}(v^{4}) = 1 + C_{2}(\\nu)\\,v^{2} + C_{3}\\,v^{3} + \\mathcal{O}(v^{4})\n$$\n通过比较 $v$ 的幂次系数：\n- 对于 $v^{2}$：$\\alpha = C_{2}(\\nu)$\n- 对于 $v^{3}$：$\\beta = C_{3}$\n\n代入给定的 $C_{2}(\\nu)$ 和 $C_{3}$ 表达式：\n$$\n\\alpha = -\\frac{1247}{336} - \\frac{35}{12}\\,\\nu\n$$\n$$\n\\beta = 4\\pi\n$$\n这些就是标定参数 $(\\alpha, \\beta)$ 的表达式。\n\n### 第三部分：$\\alpha$ 的数值计算\n\n我们需要计算在等质量点 $\\nu = 1/4$ 处 $\\alpha$ 的表达式的值。\n$$\n\\alpha\\left(\\nu=\\frac{1}{4}\\right) = -\\frac{1247}{336} - \\frac{35}{12}\\left(\\frac{1}{4}\\right)\n$$\n$$\n= -\\frac{1247}{336} - \\frac{35}{48}\n$$\n为了合并分数，我们找到一个公分母，即 $336$，因为 $336 = 7 \\times 48$。\n$$\n\\alpha\\left(\\frac{1}{4}\\right) = -\\frac{1247}{336} - \\frac{35 \\times 7}{48 \\times 7} = -\\frac{1247}{336} - \\frac{245}{336}\n$$\n$$\n= -\\frac{1247 + 245}{336} = -\\frac{1492}{336}\n$$\n我们通过将分子和分母除以它们的最大公约数 $4$ 来化简分数。\n$$\n\\alpha\\left(\\frac{1}{4}\\right) = -\\frac{1492 \\div 4}{336 \\div 4} = -\\frac{373}{84}\n$$\n最后，我们计算数值并四舍五入到四位有效数字：\n$$\n\\alpha\\left(\\frac{1}{4}\\right) = -\\frac{373}{84} \\approx -4.44047619...\n$$\n四舍五入到四位有效数字得到 $-4.440$。",
            "answer": "$$\\boxed{-4.440}$$"
        },
        {
            "introduction": "一个强大的EOB模型不仅要能重现后牛顿展开式，还必须在特定极限下精确回归到广义相对论的精确解。这项练习聚焦于一个关键的物理约束：测试质量极限（test-mass limit），即当质量比$\\nu \\to 0$时，EOB动力学必须退化为测试粒子在史瓦西时空中的测地线运动。你将通过强制要求EOB有效势在$u=1/6$处重现史瓦西时空的最内稳定圆轨道（ISCO）的位置，来推导校准系数之间必须满足的代数关系。此练习突显了如何将广义相对论的基本物理原则融入EOB模型构建中，以确保其物理一致性。",
            "id": "3472716",
            "problem": "考虑用于双黑洞的无自旋有效单体（EOB）势 $A(u;\\nu)$，其中 $u \\equiv M/r$ 且 $\\nu$ 是对称质量比。在检验质量极限 $\\nu \\to 0$ 下，与史瓦西时空中的测地线运动保持一致性要求圆轨道结构必须被重现。假设在检验质量极限下的 EOB 势通过引入标定系数，被建模为史瓦西势的一个小形变，\n$$\nA(u;\\nu{=}0) = 1 - 2 u + \\alpha\\, u^{3} + \\beta\\, u^{4} + \\gamma\\, u^{5} + \\mathcal{O}(u^{6}),\n$$\n其中 $|\\alpha|,|\\beta|,|\\gamma|$ 假定为小量，且 $\\alpha,\\beta,\\gamma$ 与 $u$ 无关。\n\n使用球对称有效度规中的圆赤道测地线条件和定义最内稳定圆轨道（ISCO）的临界稳定条件，施加在检验质量极限下 ISCO 发生在史瓦西值 $u_{\\mathrm{ISCO}} = 1/6$ 处的约束。在小标定系数 $\\alpha,\\beta,\\gamma$ 上一致地计算到线性阶。\n\n推导由 $u_{\\mathrm{ISCO}} = 1/6$ 施加在 $(\\alpha,\\beta,\\gamma)$ 上的线性约束，然后将 $\\alpha$ 表示为 $\\beta$ 和 $\\gamma$ 的函数。你的最终答案必须是关于 $\\alpha(\\beta,\\gamma)$ 的一个无单位的闭式解析表达式。不要引入任何数值近似；请给出精确的有理系数。",
            "solution": "用户要求我通过施加在检验质量极限（$\\nu \\to 0$）下最内稳定圆轨道（ISCO）位于已知的史瓦西值 $u_{\\mathrm{ISCO}} = 1/6$ 这一条件，来推导有效单体（EOB）标定系数 $(\\alpha, \\beta, \\gamma)$ 上的一个线性约束。\n\n### 第 1 步：圆轨道和 ISCO 的形式理论\n\n对于静态球对称时空中的一个检验粒子，其径向运动由一个有效势决定。EOB 形式理论使用一个有效度规来模拟动力学，其 $g_{tt}$ 分量由 $-A(r)$ 给出。对于一个具有比角动量 $L$ 的粒子，有效势的平方为 $V_{\\mathrm{eff}}^2(r) = A(r) \\left(1 + \\frac{L^2}{r^2}\\right)$。\n\n圆轨道存在于有效势取极值的半径 $r$ 处，即 $\\frac{d(V_{\\mathrm{eff}}^2)}{dr} = 0$。\nISCO 对应于临界稳定条件，此时轨道处于有效势的拐点处，即 $\\frac{d^2(V_{\\mathrm{eff}}^2)}{dr^2} = 0$。\n\n通过同时求解这两个方程，可以推导出 ISCO 半径 $r_{\\mathrm{ISCO}}$ 的一个组合条件，该过程消去了比角动量 $L$。这得到了关于 $A(r)$ 的如下微分方程，它必须在 $r=r_{\\mathrm{ISCO}}$ 处被满足：\n$$\n2r (A'(r))^2 - 3A(r)A'(r) - rA(r)A''(r) = 0\n$$\n其中撇号表示对 $r$ 的导数。\n\n### 第 2 步：将 ISCO 条件变换到变量 $u$\n\n该问题是使用变量 $u \\equiv M/r$ 来表述的，其中 $M$ 是总质量。我们必须将 ISCO 条件转换为一个关于 $u$ 的方程。关于 $r$ 的导数可以使用链式法则表示为关于 $u$ 的导数：\n$r = M/u$\n$\\frac{d}{dr} = \\frac{du}{dr} \\frac{d}{du} = \\left(-\\frac{M}{r^2}\\right) \\frac{d}{du} = -\\frac{u^2}{M} \\frac{d}{du}$\n\n令 $A_u \\equiv \\frac{dA}{du}$ 和 $A_{uu} \\equiv \\frac{d^2A}{du^2}$。\n$A$ 关于 $r$ 的一阶和二阶导数是：\n$A'(r) = -\\frac{u^2}{M} A_u$\n$A''(r) = \\frac{d}{dr} \\left(-\\frac{u^2}{M} A_u\\right) = -\\frac{u^2}{M} \\frac{d}{du} \\left(-\\frac{u^2}{M} A_u\\right) = \\frac{u^2}{M} \\left(\\frac{2u}{M} A_u + \\frac{u^2}{M} A_{uu}\\right) = \\frac{2u^3}{M^2} A_u + \\frac{u^4}{M^2} A_{uu}$\n\n将这些代入 ISCO 条件：\n$$\n2\\left(\\frac{M}{u}\\right) \\left(-\\frac{u^2}{M} A_u\\right)^2 - 3A \\left(-\\frac{u^2}{M} A_u\\right) - \\left(\\frac{M}{u}\\right) A \\left(\\frac{2u^3}{M^2} A_u + \\frac{u^4}{M^2} A_{uu}\\right) = 0\n$$\n化简各项：\n$$\n2\\frac{M}{u} \\frac{u^4}{M^2} A_u^2 + 3A \\frac{u^2}{M} A_u - \\frac{M}{u} A \\frac{u^3}{M^2} (2A_u + u A_{uu}) = 0\n$$\n$$\n\\frac{2u^3}{M} A_u^2 + \\frac{3u^2}{M} A A_u - \\frac{u^2}{M} A (2A_u + u A_{uu}) = 0\n$$\n乘以 $M/u^2$（对于 $u \\neq 0$）：\n$$\n2u A_u^2 + 3A A_u - A (2A_u + u A_{uu}) = 0\n$$\n这可化简为最终以 $u$ 表示的 ISCO 条件：\n$$\nC(u) \\equiv 2u (A_u)^2 + A A_u - u A A_{uu} = 0\n$$\n\n### 第 3 步：将条件应用于 EOB 势\n\n在检验质量极限下，给定的 EOB 势为：\n$$\nA(u) = 1 - 2u + \\alpha u^3 + \\beta u^4 + \\gamma u^5 + \\mathcal{O}(u^6)\n$$\n我们在小系数 $\\alpha, \\beta, \\gamma$ 的线性阶上进行计算。我们将 $A(u)$ 表示为史瓦西部分 $A_S(u) = 1-2u$ 和一个小微扰 $\\delta A(u) = \\alpha u^3 + \\beta u^4 + \\gamma u^5$ 的和。\n\n其导数为：\n$A_u = -2 + 3\\alpha u^2 + 4\\beta u^3 + 5\\gamma u^4 \\equiv A_{S,u} + \\delta A_u$\n$A_{uu} = 6\\alpha u + 12\\beta u^2 + 20\\gamma u^3 \\equiv A_{S,uu} + \\delta A_{uu} = \\delta A_{uu}$ (因为 $A_{S,uu}=0$)。\n\n我们将这些代入 ISCO 条件 $C(u)=0$ 并进行线性化。\n$A_u^2 = (A_{S,u} + \\delta A_u)^2 = A_{S,u}^2 + 2A_{S,u}\\delta A_u + \\mathcal{O}(\\alpha^2, \\dots) \\approx (-2)^2 + 2(-2)\\delta A_u = 4 - 4\\delta A_u$\n$A A_u = (A_S + \\delta A)(A_{S,u} + \\delta A_u) \\approx A_S A_{S,u} + A_S\\delta A_u + \\delta A A_{S,u}$\n$uAA_{uu} = u(A_S + \\delta A)(\\delta A_{uu}) \\approx u A_S \\delta A_{uu}$\n\nISCO 条件 $C(u)=0$ 变为：\n$$\n2u(4 - 4\\delta A_u) + (A_S(-2) + A_S\\delta A_u + \\delta A(-2)) - u A_S \\delta A_{uu} = 0\n$$\n按 $(\\alpha, \\beta, \\gamma)$ 的零阶和一阶项分组：\n零阶部分，$C_0(u)$：\n$$\nC_0(u) = 8u - 2A_S = 8u - 2(1 - 2u) = 12u - 2\n$$\n对于史瓦西时空，ISCO 位于 $C_0(u)=0$ 处，这给出 $12u-2=0 \\implies u=1/6$。这是正确的。\n\n一阶部分，$\\delta C(u)$：\n$$\n\\delta C(u) = -8u \\delta A_u + A_S \\delta A_u - 2\\delta A - u A_S \\delta A_{uu} = 0\n$$\n$$\n\\delta C(u) = (A_S - 8u)\\delta A_u - 2\\delta A - uA_S\\delta A_{uu} = 0\n$$\n我们必须在史瓦西 ISCO 位置 $u_0 = 1/6$ 处施加这个条件。\n在 $u_0=1/6$ 处：\n$A_S(u_0) = 1 - 2(1/6) = 1 - 1/3 = 2/3$。\n$A_S(u_0) - 8u_0 = 2/3 - 8/6 = 2/3 - 4/3 = -2/3$。\n\n条件变为：\n$$\n-\\frac{2}{3}\\delta A_u(u_0) - 2\\delta A(u_0) - u_0\\left(\\frac{2}{3}\\right)\\delta A_{uu}(u_0) = 0\n$$\n代入微扰的表达式：\n$\\delta A(u_0) = \\alpha u_0^3 + \\beta u_0^4 + \\gamma u_0^5$\n$\\delta A_u(u_0) = 3\\alpha u_0^2 + 4\\beta u_0^3 + 5\\gamma u_0^4$\n$\\delta A_{uu}(u_0) = 6\\alpha u_0 + 12\\beta u_0^2 + 20\\gamma u_0^3$\n\n$$\n-\\frac{2}{3}(3\\alpha u_0^2 + 4\\beta u_0^3 + \\dots) - 2(\\alpha u_0^3 + \\beta u_0^4 + \\dots) - \\frac{2}{3}u_0(6\\alpha u_0 + 12\\beta u_0^2 + \\dots) = 0\n$$\n我们收集 $\\alpha, \\beta, \\gamma$ 的系数。\n\n$\\alpha$ 的系数：\n$$\n-\\frac{2}{3}(3u_0^2) - 2u_0^3 - \\frac{2}{3}u_0(6u_0) = -2u_0^2 - 2u_0^3 - 4u_0^2 = -6u_0^2 - 2u_0^3\n$$\n代入 $u_0=1/6$： $-6(1/36) - 2(1/216) = -1/6 - 1/108 = -18/108 - 1/108 = -19/108$。\n\n$\\beta$ 的系数：\n$$\n-\\frac{2}{3}(4u_0^3) - 2u_0^4 - \\frac{2}{3}u_0(12u_0^2) = -\\frac{8}{3}u_0^3 - 2u_0^4 - 8u_0^3 = -\\frac{32}{3}u_0^3 - 2u_0^4\n$$\n代入 $u_0=1/6$： $-\\frac{32}{3}(1/216) - 2(1/1296) = -\\frac{32}{648} - \\frac{2}{1296} = -\\frac{64}{1296} - \\frac{2}{1296} = -\\frac{66}{1296} = -\\frac{11}{216}$。\n\n$\\gamma$ 的系数：\n$$\n-\\frac{2}{3}(5u_0^4) - 2u_0^5 - \\frac{2}{3}u_0(20u_0^3) = -\\frac{10}{3}u_0^4 - 2u_0^5 - \\frac{40}{3}u_0^4 = -\\frac{50}{3}u_0^4 - 2u_0^5\n$$\n代入 $u_0=1/6$： $-\\frac{50}{3}(1/1296) - 2(1/7776) = -\\frac{50}{3888} - \\frac{2}{7776} = -\\frac{100}{7776} - \\frac{2}{7776} = -\\frac{102}{7776} = -\\frac{17}{1296}$。\n\n### 第 4 步：最终推导\n\n$(\\alpha, \\beta, \\gamma)$ 上的线性约束为：\n$$\n\\alpha \\left(-\\frac{19}{108}\\right) + \\beta \\left(-\\frac{11}{216}\\right) + \\gamma \\left(-\\frac{17}{1296}\\right) = 0\n$$\n将整个方程乘以 $-1296$ 以消去分母：\n$1296 = 12 \\times 108 = 6 \\times 216$。\n$$\n\\alpha \\left(\\frac{19}{108} \\times 1296\\right) + \\beta \\left(\\frac{11}{216} \\times 1296\\right) + \\gamma \\left(\\frac{17}{1296} \\times 1296\\right) = 0\n$$\n$$\n\\alpha(19 \\times 12) + \\beta(11 \\times 6) + \\gamma(17) = 0\n$$\n$$\n228\\alpha + 66\\beta + 17\\gamma = 0\n$$\n求解 $\\alpha$ 作为 $\\beta$ 和 $\\gamma$ 的函数：\n$$\n228\\alpha = -66\\beta - 17\\gamma\n$$\n$$\n\\alpha = -\\frac{66}{228}\\beta - \\frac{17}{228}\\gamma\n$$\n化简有理系数：\n$$\n\\frac{66}{228} = \\frac{33}{114} = \\frac{11}{38}\n$$\n分数 $\\frac{17}{228}$ 是不可约的，因为 17 是素数且 $228 = 2^2 \\times 3 \\times 19$。\n因此，$\\alpha$ 的最终表达式是：\n$$\n\\alpha = -\\frac{11}{38}\\beta - \\frac{17}{228}\\gamma\n$$",
            "answer": "$$\n\\boxed{\\alpha = -\\frac{11}{38}\\beta - \\frac{17}{228}\\gamma}\n$$"
        },
        {
            "introduction": "在理论约束被施加后，EOB模型中剩余的自由参数需要通过与高精度的数值相对论（NR）模拟数据进行拟合来最终确定。这个过程本质上是一个统计参数估计问题，而正确处理数据的不确定性是成功的关键。这项练习将引导你深入了解贝叶斯推断在EOB校准中的应用，并重点比较两种不同的噪声模型假设：一种是假设所有数据点具有相同误差（homoscedastic），另一种是更真实地考虑每个NR数据点具有其自身误差（heteroscedastic）。通过这项计算实践，你将量化地看到，采用更符合物理实际的噪声模型将如何显著影响参数的后验分布，从而理解严谨统计方法在构建精确引力波模型中的核心作用。",
            "id": "3472659",
            "problem": "您将进行一项在数值相对论 (NR) 和引力波背景下，针对有效单体 (EOB) 模型的校准任务。其目标是通过在线性化模型下拟合受 NR 启发的残差来校准 EOB 参数中的微小偏移，并研究与同方差拟合相比，将 NR 误差棒作为异方差噪声纳入似然函数会如何改变 EOB 参数的后验分布。\n\n假设校准设置如下。令 $n$ 为受 NR 启发的残差数据点的数量，令 $k$ 为待校准的 EOB 参数偏移的数量。令 $\\boldsymbol{\\theta} \\in \\mathbb{R}^k$ 表示相对于参考 EOB 模型的小参数偏移，令 $\\mathbf{y} \\in \\mathbb{R}^n$ 表示用于衡量 EOB 参考模型与 NR 派生的摘要量（例如，跨不同构型聚合的相位差异或失配）之间差异的残差。令 $\\mathbf{X} \\in \\mathbb{R}^{n \\times k}$ 为由残差对参考点附近 $\\boldsymbol{\\theta}$ 的线性化敏感度构建的设计矩阵，因此线性化模型为\n$$\n\\mathbf{y} \\approx \\mathbf{X}\\boldsymbol{\\theta} + \\boldsymbol{\\varepsilon},\n$$\n其中 $\\boldsymbol{\\varepsilon}$ 是一个随机噪声项。\n\n考虑 $\\boldsymbol{\\varepsilon}$ 的两种似然函数形式：\n- 受 NR 误差棒启发的异方差高斯噪声，$\\boldsymbol{\\varepsilon} \\sim \\mathcal{N}(\\mathbf{0}, \\boldsymbol{\\Sigma})$，其对角协方差为 $\\boldsymbol{\\Sigma} = \\mathrm{diag}(\\sigma_1^2, \\dots, \\sigma_n^2)$。\n- 具有恒定方差的同方差高斯噪声，$\\boldsymbol{\\varepsilon} \\sim \\mathcal{N}(\\mathbf{0}, \\sigma^2 \\mathbf{I}_n)$。\n\n假设参数服从高斯先验分布，$\\boldsymbol{\\theta} \\sim \\mathcal{N}(\\boldsymbol{\\mu}_0, \\boldsymbol{\\Sigma}_0)$，其中 $\\boldsymbol{\\Sigma}_0$ 是对称正定矩阵。\n\n从 Bayes 定理和上述线性高斯模型假设出发，推导异方差情况下的后验分布 $p(\\boldsymbol{\\theta} \\mid \\mathbf{y}, \\mathbf{X}, \\boldsymbol{\\Sigma}, \\boldsymbol{\\mu}_0, \\boldsymbol{\\Sigma}_0)$ 和同方差情况下的后验分布 $p(\\boldsymbol{\\theta} \\mid \\mathbf{y}, \\mathbf{X}, \\sigma^2, \\boldsymbol{\\mu}_0, \\boldsymbol{\\Sigma}_0)$。然后实现一个程序，对下面提供的每个测试用例，计算异方差和同方差后验分布之间的以下三个定量比较：\n1. 后验均值之差的欧几里得范数，即 $||\\boldsymbol{\\mu}_{\\text{het}} - \\boldsymbol{\\mu}_{\\text{hom}}||_2$。\n2. 后验协方差矩阵行列式的比值，即 $\\det(\\boldsymbol{\\Sigma}_{\\text{het}})/\\det(\\boldsymbol{\\Sigma}_{\\text{hom}})$。\n3. 两个多元正态后验分布之间的对称化 Kullback–Leibler 散度，即 $\\mathrm{KL}(\\mathcal{N}_{\\text{het}} \\,\\|\\, \\mathcal{N}_{\\text{hom}}) + \\mathrm{KL}(\\mathcal{N}_{\\text{hom}} \\,\\|\\, \\mathcal{N}_{\\text{het}})$。\n\n所有量都是无量纲的，不需要物理单位。不涉及角度。最终输出必须是十进制浮点数。\n\n使用以下测试套件。每个测试用例由 $(\\mathbf{X}, \\mathbf{y}, \\boldsymbol{\\sigma}^2, \\boldsymbol{\\mu}_0, \\boldsymbol{\\Sigma}_0, \\sigma^2)$ 指定，其中 $\\boldsymbol{\\sigma}^2$ 表示异方差方差的向量，$\\sigma^2$ 是同方差方差。\n\n- 测试用例 1 (理想路径，中等异方差性):\n  - $n=6, k=2$,\n  - $\\mathbf{X} = \\begin{bmatrix} 0.8  -0.1 \\\\ 1.2  0.0 \\\\ 0.5  0.3 \\\\ 1.5  -0.2 \\\\ 0.9  0.4 \\\\ 1.1  -0.3 \\end{bmatrix}$,\n  - $\\mathbf{y} = \\begin{bmatrix} -0.020 \\\\ 0.010 \\\\ 0.005 \\\\ -0.030 \\\\ 0.012 \\\\ -0.015 \\end{bmatrix}$,\n  - $\\boldsymbol{\\sigma}^2 = \\begin{bmatrix} 1.0\\times 10^{-4} \\\\ 2.0\\times 10^{-4} \\\\ 1.5\\times 10^{-4} \\\\ 1.0\\times 10^{-4} \\\\ 2.5\\times 10^{-4} \\\\ 1.8\\times 10^{-4} \\end{bmatrix}$,\n  - $\\boldsymbol{\\mu}_0 = \\begin{bmatrix} 0.0 \\\\ 0.0 \\end{bmatrix}$,\n  - $\\boldsymbol{\\Sigma}_0 = \\mathrm{diag}(0.05^2, 0.05^2)$,\n  - $\\sigma^2 = \\mathrm{mean}(\\boldsymbol{\\sigma}^2)$。\n- 测试用例 2 (边界条件，接近同方差):\n  - $n=5, k=2$,\n  - $\\mathbf{X} = \\begin{bmatrix} 0.7  0.2 \\\\ 0.9  -0.1 \\\\ 1.1  0.0 \\\\ 1.3  0.3 \\\\ 0.8  -0.2 \\end{bmatrix}$,\n  - $\\mathbf{y} = \\begin{bmatrix} 0.006 \\\\ -0.012 \\\\ 0.008 \\\\ 0.002 \\\\ -0.009 \\end{bmatrix}$,\n  - $\\boldsymbol{\\sigma}^2 = \\begin{bmatrix} 2.0\\times 10^{-4} \\\\ 2.0\\times 10^{-4} \\\\ 2.0\\times 10^{-4} \\\\ 2.0\\times 10^{-4} \\\\ 2.0\\times 10^{-4} \\end{bmatrix}$,\n  - $\\boldsymbol{\\mu}_0 = \\begin{bmatrix} 0.0 \\\\ 0.0 \\end{bmatrix}$,\n  - $\\boldsymbol{\\Sigma}_0 = \\mathrm{diag}(0.05^2, 0.05^2)$,\n  - $\\sigma^2 = 2.0\\times 10^{-4}$。\n- 测试用例 3 (边缘情况，一个极其精确的数据点):\n  - $n=6, k=2$,\n  - $\\mathbf{X} = \\begin{bmatrix} 1.4  0.1 \\\\ 0.6  -0.2 \\\\ 1.0  0.2 \\\\ 0.7  0.0 \\\\ 1.2  -0.3 \\\\ 0.9  0.4 \\end{bmatrix}$,\n  - $\\mathbf{y} = \\begin{bmatrix} 0.015 \\\\ -0.010 \\\\ 0.005 \\\\ 0.000 \\\\ -0.020 \\\\ 0.010 \\end{bmatrix}$,\n  - $\\boldsymbol{\\sigma}^2 = \\begin{bmatrix} 1.0\\times 10^{-6} \\\\ 3.0\\times 10^{-4} \\\\ 3.0\\times 10^{-4} \\\\ 3.0\\times 10^{-4} \\\\ 3.0\\times 10^{-4} \\\\ 3.0\\times 10^{-4} \\end{bmatrix}$,\n  - $\\boldsymbol{\\mu}_0 = \\begin{bmatrix} 0.0 \\\\ 0.0 \\end{bmatrix}$,\n  - $\\boldsymbol{\\Sigma}_0 = \\mathrm{diag}(0.05^2, 0.05^2)$,\n  - $\\sigma^2 = \\mathrm{mean}(\\boldsymbol{\\sigma}^2)$。\n- 测试用例 4 (边缘情况，两个高度不确定的数据点):\n  - $n=6, k=2$,\n  - $\\mathbf{X} = \\begin{bmatrix} 0.5  0.5 \\\\ 1.0  -0.4 \\\\ 0.8  0.1 \\\\ 1.3  -0.1 \\\\ 0.6  0.3 \\\\ 1.1  -0.2 \\end{bmatrix}$,\n  - $\\mathbf{y} = \\begin{bmatrix} -0.005 \\\\ 0.020 \\\\ -0.010 \\\\ 0.015 \\\\ -0.004 \\\\ 0.008 \\end{bmatrix}$,\n  - $\\boldsymbol{\\sigma}^2 = \\begin{bmatrix} 2.0\\times 10^{-4} \\\\ 1.0\\times 10^{-2} \\\\ 2.0\\times 10^{-4} \\\\ 1.0\\times 10^{-2} \\\\ 2.5\\times 10^{-4} \\\\ 2.0\\times 10^{-4} \\end{bmatrix}$,\n  - $\\boldsymbol{\\mu}_0 = \\begin{bmatrix} 0.0 \\\\ 0.0 \\end{bmatrix}$,\n  - $\\boldsymbol{\\Sigma}_0 = \\mathrm{diag}(0.05^2, 0.05^2)$,\n  - $\\sigma^2 = \\mathrm{mean}(\\boldsymbol{\\sigma}^2)$。\n\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果。对于每个测试用例，按此顺序输出三个十进制浮点数：$||\\boldsymbol{\\mu}_{\\text{het}} - \\boldsymbol{\\mu}_{\\text{hom}}||_2$、$\\det(\\boldsymbol{\\Sigma}_{\\text{het}})/\\det(\\boldsymbol{\\Sigma}_{\\text{hom}})$ 和对称化 Kullback–Leibler 散度。将这四个测试用例的三元组连接成一个扁平列表，总共得到十二个浮点数。例如，最终的输出格式必须是\n$$\n[\\text{case1\\_norm},\\text{case1\\_det\\_ratio},\\text{case1\\_KL\\_sym},\\text{case2\\_norm},\\dots,\\text{case4\\_KL\\_sym}].\n$$",
            "solution": "目标是推导在两种不同噪声模型（异方差和同方差）下有效单体 (EOB) 参数偏移 $\\boldsymbol{\\theta}$ 的后验分布，然后计算比较这两个后验分布的定量指标。推导从 Bayes 定理开始，该定理指出给定数据下参数的后验概率与似然函数和先验概率的乘积成正比：\n$$\np(\\boldsymbol{\\theta} \\mid \\mathbf{y}) \\propto p(\\mathbf{y} \\mid \\boldsymbol{\\theta}) p(\\boldsymbol{\\theta})\n$$\n问题定义了一个线性模型 $\\mathbf{y} = \\mathbf{X}\\boldsymbol{\\theta} + \\boldsymbol{\\varepsilon}$、噪声项 $\\boldsymbol{\\varepsilon}$ 的高斯似然函数以及参数 $\\boldsymbol{\\theta}$ 的高斯先验分布。由于高斯似然函数的共轭先验是高斯分布，因此得到的后验分布也将是高斯分布，即 $\\boldsymbol{\\theta} \\mid \\mathbf{y} \\sim \\mathcal{N}(\\boldsymbol{\\mu}_{\\text{post}}, \\boldsymbol{\\Sigma}_{\\text{post}})$。我们可以通过分析后验概率密度函数的指数部分来确定后验均值 $\\boldsymbol{\\mu}_{\\text{post}}$ 和协方差 $\\boldsymbol{\\Sigma}_{\\text{post}}$。\n\n$\\boldsymbol{\\theta} \\in \\mathbb{R}^k$ 的先验分布为 $\\boldsymbol{\\theta} \\sim \\mathcal{N}(\\boldsymbol{\\mu}_0, \\boldsymbol{\\Sigma}_0)$，因此其概率密度函数为：\n$$\np(\\boldsymbol{\\theta}) \\propto \\exp\\left( -\\frac{1}{2} (\\boldsymbol{\\theta} - \\boldsymbol{\\mu}_0)^T \\boldsymbol{\\Sigma}_0^{-1} (\\boldsymbol{\\theta} - \\boldsymbol{\\mu}_0) \\right)\n$$\n似然函数 $p(\\mathbf{y} \\mid \\boldsymbol{\\theta})$ 取决于噪声 $\\boldsymbol{\\varepsilon}$ 的模型。一般地，对于 $\\boldsymbol{\\varepsilon} \\sim \\mathcal{N}(\\mathbf{0}, \\mathbf{C})$，似然函数为：\n$$\np(\\mathbf{y} \\mid \\boldsymbol{\\theta}) \\propto \\exp\\left( -\\frac{1}{2} (\\mathbf{y} - \\mathbf{X}\\boldsymbol{\\theta})^T \\mathbf{C}^{-1} (\\mathbf{y} - \\mathbf{X}\\boldsymbol{\\theta}) \\right)\n$$\n因此，对数后验与指数之和成正比：\n$$\n\\log p(\\boldsymbol{\\theta} \\mid \\mathbf{y}) = -\\frac{1}{2} \\left[ (\\mathbf{y} - \\mathbf{X}\\boldsymbol{\\theta})^T \\mathbf{C}^{-1} (\\mathbf{y} - \\mathbf{X}\\boldsymbol{\\theta}) + (\\boldsymbol{\\theta} - \\boldsymbol{\\mu}_0)^T \\boldsymbol{\\Sigma}_0^{-1} (\\boldsymbol{\\theta} - \\boldsymbol{\\mu}_0) \\right] + \\text{const.}\n$$\n我们展开二次型并对包含 $\\boldsymbol{\\theta}$ 的项进行分组：\n$$\n\\begin{aligned}\n\\text{Exponent} = - \\frac{1}{2} \\left[ \\mathbf{y}^T\\mathbf{C}^{-1}\\mathbf{y} - 2\\boldsymbol{\\theta}^T\\mathbf{X}^T\\mathbf{C}^{-1}\\mathbf{y} + \\boldsymbol{\\theta}^T\\mathbf{X}^T\\mathbf{C}^{-1}\\mathbf{X}\\boldsymbol{\\theta} \\right. \\\\\n \\qquad \\left. + \\boldsymbol{\\theta}^T\\boldsymbol{\\Sigma}_0^{-1}\\boldsymbol{\\theta} - 2\\boldsymbol{\\theta}^T\\boldsymbol{\\Sigma}_0^{-1}\\boldsymbol{\\mu}_0 + \\boldsymbol{\\mu}_0^T\\boldsymbol{\\Sigma}_0^{-1}\\boldsymbol{\\mu}_0 \\right] \\\\\n= - \\frac{1}{2} \\left[ \\boldsymbol{\\theta}^T(\\mathbf{X}^T\\mathbf{C}^{-1}\\mathbf{X} + \\boldsymbol{\\Sigma}_0^{-1})\\boldsymbol{\\theta} - 2\\boldsymbol{\\theta}^T(\\mathbf{X}^T\\mathbf{C}^{-1}\\mathbf{y} + \\boldsymbol{\\Sigma}_0^{-1}\\boldsymbol{\\mu}_0) \\right] + \\text{const.}\n\\end{aligned}\n$$\n通过配方法，我们可以将其与多元高斯分布 $\\mathcal{N}(\\boldsymbol{\\mu}_{\\text{post}}, \\boldsymbol{\\Sigma}_{\\text{post}})$ 的指数形式 $-\\frac{1}{2}(\\boldsymbol{\\theta} - \\boldsymbol{\\mu}_{\\text{post}})^T \\boldsymbol{\\Sigma}_{\\text{post}}^{-1} (\\boldsymbol{\\theta} - \\boldsymbol{\\mu}_{\\text{post}})$ 相匹配。比较 $\\boldsymbol{\\theta}$ 的二次项和线性项，我们便可确定后验精度矩阵 $\\boldsymbol{\\Sigma}_{\\text{post}}^{-1}$ 和均值 $\\boldsymbol{\\mu}_{\\text{post}}$。\n\n后验精度矩阵为：\n$$\n\\boldsymbol{\\Sigma}_{\\text{post}}^{-1} = \\mathbf{X}^T\\mathbf{C}^{-1}\\mathbf{X} + \\boldsymbol{\\Sigma}_0^{-1}\n$$\n后验协方差矩阵是其逆矩阵：\n$$\n\\boldsymbol{\\Sigma}_{\\text{post}} = (\\mathbf{X}^T\\mathbf{C}^{-1}\\mathbf{X} + \\boldsymbol{\\Sigma}_0^{-1})^{-1}\n$$\n后验均值由 $\\boldsymbol{\\Sigma}_{\\text{post}}^{-1}\\boldsymbol{\\mu}_{\\text{post}} = \\mathbf{X}^T\\mathbf{C}^{-1}\\mathbf{y} + \\boldsymbol{\\Sigma}_0^{-1}\\boldsymbol{\\mu}_0$ 给出：\n$$\n\\boldsymbol{\\mu}_{\\text{post}} = \\boldsymbol{\\Sigma}_{\\text{post}} (\\mathbf{X}^T\\mathbf{C}^{-1}\\mathbf{y} + \\boldsymbol{\\Sigma}_0^{-1}\\boldsymbol{\\mu}_0)\n$$\n\n现在我们将这些一般结果应用于两个具体情况。\n\n**1. 异方差后验**\n噪声协方差为 $\\mathbf{C} = \\boldsymbol{\\Sigma} = \\mathrm{diag}(\\sigma_1^2, \\dots, \\sigma_n^2)$。其逆矩阵为 $\\boldsymbol{\\Sigma}^{-1} = \\mathrm{diag}(1/\\sigma_1^2, \\dots, 1/\\sigma_n^2)$。\n后验协方差矩阵 $\\boldsymbol{\\Sigma}_{\\text{het}}$ 为：\n$$\n\\boldsymbol{\\Sigma}_{\\text{het}} = (\\mathbf{X}^T \\boldsymbol{\\Sigma}^{-1} \\mathbf{X} + \\boldsymbol{\\Sigma}_0^{-1})^{-1}\n$$\n后验均值 $\\boldsymbol{\\mu}_{\\text{het}}$ 为：\n$$\n\\boldsymbol{\\mu}_{\\text{het}} = \\boldsymbol{\\Sigma}_{\\text{het}} (\\mathbf{X}^T \\boldsymbol{\\Sigma}^{-1} \\mathbf{y} + \\boldsymbol{\\Sigma}_0^{-1} \\boldsymbol{\\mu}_0)\n$$\n后验分布为 $\\mathcal{N}_{\\text{het}} = \\mathcal{N}(\\boldsymbol{\\mu}_{\\text{het}}, \\boldsymbol{\\Sigma}_{\\text{het}})$。\n\n**2. 同方差后验**\n噪声协方差为 $\\mathbf{C} = \\sigma^2 \\mathbf{I}_n$，其中 $\\mathbf{I}_n$ 是 $n \\times n$ 的单位矩阵。其逆矩阵为 $\\mathbf{C}^{-1} = \\frac{1}{\\sigma^2}\\mathbf{I}_n$。\n后验协方差矩阵 $\\boldsymbol{\\Sigma}_{\\text{hom}}$ 为：\n$$\n\\boldsymbol{\\Sigma}_{\\text{hom}} = \\left(\\frac{1}{\\sigma^2}\\mathbf{X}^T \\mathbf{X} + \\boldsymbol{\\Sigma}_0^{-1}\\right)^{-1}\n$$\n后验均值 $\\boldsymbol{\\mu}_{\\text{hom}}$ 为：\n$$\n\\boldsymbol{\\mu}_{\\text{hom}} = \\boldsymbol{\\Sigma}_{\\text{hom}} \\left(\\frac{1}{\\sigma^2}\\mathbf{X}^T \\mathbf{y} + \\boldsymbol{\\Sigma}_0^{-1} \\boldsymbol{\\mu}_0\\right)\n$$\n后验分布为 $\\mathcal{N}_{\\text{hom}} = \\mathcal{N}(\\boldsymbol{\\mu}_{\\text{hom}}, \\boldsymbol{\\Sigma}_{\\text{hom}})$。\n\n**比较指标**\n推导出后验均值和协方差后，我们定义三个比较指标。\n1.  **后验均值之差的欧几里得范数：**\n    $$\n    ||\\boldsymbol{\\mu}_{\\text{het}} - \\boldsymbol{\\mu}_{\\text{hom}}||_2 = \\sqrt{ (\\boldsymbol{\\mu}_{\\text{het}} - \\boldsymbol{\\mu}_{\\text{hom}})^T (\\boldsymbol{\\mu}_{\\text{het}} - \\boldsymbol{\\mu}_{\\text{hom}}) }\n    $$\n2.  **后验协方差矩阵行列式的比值：**\n    $$\n    \\frac{\\det(\\boldsymbol{\\Sigma}_{\\text{het}})}{\\det(\\boldsymbol{\\Sigma}_{\\text{hom}})}\n    $$\n3.  **对称化 Kullback–Leibler 散度：** 对于维度为 $k$ 的两个多元正态分布 $\\mathcal{N}_1 = \\mathcal{N}(\\boldsymbol{\\mu}_1, \\boldsymbol{\\Sigma}_1)$ 和 $\\mathcal{N}_2 = \\mathcal{N}(\\boldsymbol{\\mu}_2, \\boldsymbol{\\Sigma}_2)$，KL 散度为\n    $$\n    \\mathrm{KL}(\\mathcal{N}_1 \\,\\|\\, \\mathcal{N}_2) = \\frac{1}{2} \\left[ \\log\\left(\\frac{\\det \\boldsymbol{\\Sigma}_2}{\\det \\boldsymbol{\\Sigma}_1}\\right) - k + \\mathrm{Tr}(\\boldsymbol{\\Sigma}_2^{-1} \\boldsymbol{\\Sigma}_1) + (\\boldsymbol{\\mu}_2 - \\boldsymbol{\\mu}_1)^T \\boldsymbol{\\Sigma}_2^{-1} (\\boldsymbol{\\mu}_2 - \\boldsymbol{\\mu}_1) \\right]\n    $$\n    对称化 KL 散度为 $\\mathrm{KL}(\\mathcal{N}_{\\text{het}} \\,\\|\\, \\mathcal{N}_{\\text{hom}}) + \\mathrm{KL}(\\mathcal{N}_{\\text{hom}} \\,\\|\\, \\mathcal{N}_{\\text{het}})$。经过代数简化后，得到：\n    $$\n    \\frac{1}{2} \\left[ \\mathrm{Tr}(\\boldsymbol{\\Sigma}_{\\text{het}}^{-1}\\boldsymbol{\\Sigma}_{\\text{hom}} + \\boldsymbol{\\Sigma}_{\\text{hom}}^{-1}\\boldsymbol{\\Sigma}_{\\text{het}} - 2\\mathbf{I}_k) + (\\boldsymbol{\\mu}_{\\text{het}} - \\boldsymbol{\\mu}_{\\text{hom}})^T (\\boldsymbol{\\Sigma}_{\\text{het}}^{-1} + \\boldsymbol{\\Sigma}_{\\text{hom}}^{-1}) (\\boldsymbol{\\mu}_{\\text{het}} - \\boldsymbol{\\mu}_{\\text{hom}}) \\right]\n    $$\n程序实现将为每个测试用例计算这些量。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the EOB calibration problem for the given test cases.\n    \"\"\"\n    \n    def compute_posterior_comparison(X, y, sigma_het_sq, mu0, Sigma0, sigma_hom_sq):\n        \"\"\"\n        Calculates the posterior distributions for heteroscedastic and homoscedastic\n        models and computes the three comparison metrics.\n        \"\"\"\n        n, k = X.shape\n\n        y = y.reshape(-1, 1)\n        sigma_het_sq = sigma_het_sq.reshape(-1, 1)\n        mu0 = mu0.reshape(-1, 1)\n\n        Sigma0_inv = np.linalg.inv(Sigma0)\n\n        # 1. Heteroscedastic Posterior Calculation\n        W_het = 1.0 / sigma_het_sq.flatten()\n        X_T_S_inv_X_het = X.T * W_het @ X\n        X_T_S_inv_y_het = X.T @ (W_het * y.flatten())\n        X_T_S_inv_y_het = X_T_S_inv_y_het.reshape(-1, 1)\n\n        Sigma_post_het_inv = X_T_S_inv_X_het + Sigma0_inv\n        Sigma_post_het = np.linalg.inv(Sigma_post_het_inv)\n        mu_post_het = Sigma_post_het @ (X_T_S_inv_y_het + Sigma0_inv @ mu0)\n\n        # 2. Homoscedastic Posterior Calculation\n        const_inv_var_hom = 1.0 / sigma_hom_sq\n        Sigma_post_hom_inv = const_inv_var_hom * (X.T @ X) + Sigma0_inv\n        Sigma_post_hom = np.linalg.inv(Sigma_post_hom_inv)\n        mu_post_hom = Sigma_post_hom @ (const_inv_var_hom * (X.T @ y) + Sigma0_inv @ mu0)\n\n        # 3. Compute Comparison Metrics\n        delta_mu = mu_post_het - mu_post_hom\n        norm_diff = np.linalg.norm(delta_mu)\n\n        det_het = np.linalg.det(Sigma_post_het)\n        det_hom = np.linalg.det(Sigma_post_hom)\n        det_ratio = det_het / det_hom\n\n        trace_term = np.trace(Sigma_post_hom_inv @ Sigma_post_het + Sigma_post_het_inv @ Sigma_post_hom - 2 * np.eye(k))\n        mahalanobis_term = delta_mu.T @ (Sigma_post_het_inv + Sigma_post_hom_inv) @ delta_mu\n        kl_sym = 0.5 * (trace_term + mahalanobis_term.item())\n\n        return (norm_diff, det_ratio, kl_sym)\n\n    test_cases = [\n        {\n            \"X\": np.array([[0.8, -0.1], [1.2, 0.0], [0.5, 0.3], [1.5, -0.2], [0.9, 0.4], [1.1, -0.3]]),\n            \"y\": np.array([-0.020, 0.010, 0.005, -0.030, 0.012, -0.015]),\n            \"sigma_het_sq\": np.array([1.0e-4, 2.0e-4, 1.5e-4, 1.0e-4, 2.5e-4, 1.8e-4]),\n            \"mu0\": np.array([0.0, 0.0]),\n            \"Sigma0\": np.diag([0.05**2, 0.05**2]),\n            \"sigma_hom_sq\": np.mean(np.array([1.0e-4, 2.0e-4, 1.5e-4, 1.0e-4, 2.5e-4, 1.8e-4]))\n        },\n        {\n            \"X\": np.array([[0.7, 0.2], [0.9, -0.1], [1.1, 0.0], [1.3, 0.3], [0.8, -0.2]]),\n            \"y\": np.array([0.006, -0.012, 0.008, 0.002, -0.009]),\n            \"sigma_het_sq\": np.array([2.0e-4, 2.0e-4, 2.0e-4, 2.0e-4, 2.0e-4]),\n            \"mu0\": np.array([0.0, 0.0]),\n            \"Sigma0\": np.diag([0.05**2, 0.05**2]),\n            \"sigma_hom_sq\": 2.0e-4\n        },\n        {\n            \"X\": np.array([[1.4, 0.1], [0.6, -0.2], [1.0, 0.2], [0.7, 0.0], [1.2, -0.3], [0.9, 0.4]]),\n            \"y\": np.array([0.015, -0.010, 0.005, 0.000, -0.020, 0.010]),\n            \"sigma_het_sq\": np.array([1.0e-6, 3.0e-4, 3.0e-4, 3.0e-4, 3.0e-4, 3.0e-4]),\n            \"mu0\": np.array([0.0, 0.0]),\n            \"Sigma0\": np.diag([0.05**2, 0.05**2]),\n            \"sigma_hom_sq\": np.mean(np.array([1.0e-6, 3.0e-4, 3.0e-4, 3.0e-4, 3.0e-4, 3.0e-4]))\n        },\n        {\n            \"X\": np.array([[0.5, 0.5], [1.0, -0.4], [0.8, 0.1], [1.3, -0.1], [0.6, 0.3], [1.1, -0.2]]),\n            \"y\": np.array([-0.005, 0.020, -0.010, 0.015, -0.004, 0.008]),\n            \"sigma_het_sq\": np.array([2.0e-4, 1.0e-2, 2.0e-4, 1.0e-2, 2.5e-4, 2.0e-4]),\n            \"mu0\": np.array([0.0, 0.0]),\n            \"Sigma0\": np.diag([0.05**2, 0.05**2]),\n            \"sigma_hom_sq\": np.mean(np.array([2.0e-4, 1.0e-2, 2.0e-4, 1.0e-2, 2.5e-4, 2.0e-4]))\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        norm_diff, det_ratio, kl_sym = compute_posterior_comparison(\n            case[\"X\"],\n            case[\"y\"],\n            case[\"sigma_het_sq\"],\n            case[\"mu0\"],\n            case[\"Sigma0\"],\n            case[\"sigma_hom_sq\"]\n        )\n        results.extend([norm_diff, det_ratio, kl_sym])\n\n    print(f\"[{','.join(f'{x:.12f}' for x in results)}]\")\n\nsolve()\n```"
        }
    ]
}