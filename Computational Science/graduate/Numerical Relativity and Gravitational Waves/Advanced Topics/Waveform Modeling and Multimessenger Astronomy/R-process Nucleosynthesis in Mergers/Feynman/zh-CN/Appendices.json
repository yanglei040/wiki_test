{
    "hands_on_practices": [
        {
            "introduction": "r-过程核合成始于致密天体并合事件中物质的动态抛射。这个练习将引导你分析一个关键的初始条件：当中子星被黑洞的引力撕裂时，它是否发生在离黑洞足够远的地方，从而使物质能够逃逸而不是被直接吞噬。通过计算决定这一结果的临界黑洞自旋 ，你将体验到如何结合牛顿引力的潮汐效应和广义相对论的轨道动力学来评估并合事件产生r-过程元素的潜力。",
            "id": "3484898",
            "problem": "在黑洞的 Kerr 时空中，一个黑洞-中子星双星系统在其旋近晚期被建模，假设其轨道为准圆形、赤道、顺行轨道。考虑一个引力质量为 $M_{\\mathrm{BH}}$、无量纲自旋参数 $a_{\\ast}$ 与轨道角动量对齐的黑洞（BH），以及一个引力质量为 $M_{\\mathrm{NS}}$、周长半径为 $R_{\\mathrm{NS}}$ 的中子星（NS）。在最简单的牛顿估算中，当中子星两端的黑洞引力加速度差的大小等于中子星自身的表面引力时，中子星发生潮汐瓦解。将中子星视为一个自引力流体，并将黑洞视为潮汐场的点质量源。在这些假设下，仅使用引力加速度及其径向梯度的定义，通过将跨越该星体的领头阶潮汐加速度与中子星表面引力相等，来推导出潮汐瓦解半径 $r_{t}$。\n\n为了能够抛射出动力学上显著的物质并形成吸积盘，从而触发快中子俘获过程（r-过程）的核合成，潮汐瓦解必须发生在 Kerr 黑洞的最内稳定圆轨道（ISCO）之外。设 $r_{\\mathrm{ISCO}}(a_{\\ast})$ 表示 Kerr 度规中的顺行赤道 ISCO 半径。通过用黑洞的引力半径对长度进行归一化，在几何单位制下比较轨道半径。具体来说，比较无量纲量 $\\hat{r}_{t} \\equiv r_{t} c^{2}/(G M_{\\mathrm{BH}})$ 与 Kerr 函数 $\\hat{r}_{\\mathrm{ISCO}}(a_{\\ast}) \\equiv r_{\\mathrm{ISCO}}(a_{\\ast}) c^{2}/(G M_{\\mathrm{BH}})$。在 ISCO 之外发生瓦解的阈值由条件 $\\hat{r}_{t} = \\hat{r}_{\\mathrm{ISCO}}(a_{\\ast}^{\\mathrm{crit}})$ 设定，该条件定义了临界自旋 $a_{\\ast}^{\\mathrm{crit}}$。\n\n假设以下符合物理实际的参数：$M_{\\mathrm{BH}} = 7.0\\,M_{\\odot}$，$M_{\\mathrm{NS}} = 1.40\\,M_{\\odot}$，以及 $R_{\\mathrm{NS}} = 12.0\\,\\mathrm{km}$。使用太阳质量长度标度 $G M_{\\odot}/c^{2} = 1.476625\\,\\mathrm{km}$。你可以假设在 Kerr 度规中使用顺行赤道 ISCO 半径 $\\hat{r}_{\\mathrm{ISCO}}(a_{\\ast})$ 的标准广义相对论表达式。\n\n对于给定的系统，计算临界自旋 $a_{\\ast}^{\\mathrm{crit}}$，使得 $\\hat{r}_{t} = \\hat{r}_{\\mathrm{ISCO}}(a_{\\ast}^{\\mathrm{crit}})$。将你的答案四舍五入到四位有效数字。最终答案必须表示为一个无单位的数。",
            "solution": "该问题是适定的，且有科学依据，其基础是用于潮汐估算的牛顿引力基本原理和用于致密天体附近轨道动力学的广义相对论。所有提供的参数都符合物理实际，并且足以得到唯一解。\n\n核心任务是对于给定的黑洞-中子星（BH-NS）系统，求出黑洞的临界无量纲自旋参数 $a_{\\ast}^{\\mathrm{crit}}$。该临界自旋由潮汐瓦解半径 $r_t$ 恰好等于最内稳定圆轨道（ISCO）半径 $r_{\\mathrm{ISCO}}$ 的条件定义。问题指定了潮汐瓦解的简化牛顿模型和 Kerr 度规中顺行赤道轨道 ISCO 半径的标准广义相对论公式。该条件用无量纲半径表示，并通过黑洞的引力半径归一化：$\\hat{r}_{t} = \\hat{r}_{\\mathrm{ISCO}}(a_{\\ast}^{\\mathrm{crit}})$。\n\n首先，我们在给定假设下推导潮汐瓦解半径 $r_t$。我们将黑洞建模为点质量 $M_{\\mathrm{BH}}$，将中子星建模为质量为 $M_{\\mathrm{NS}}$、半径为 $R_{\\mathrm{NS}}$ 的自引力流体。黑洞在距离 $r$ 处产生的引力加速度由牛顿公式给出：\n$$a_{\\mathrm{BH}}(r) = \\frac{G M_{\\mathrm{BH}}}{r^2}$$\n问题指出，当黑洞在中子星两端的引力加速度差等于中子星自身的表面引力时，潮汐瓦解发生。“跨越该星体的领头阶潮汐加速度”被解释为中子星中心与其表面之间，沿着连接两个天体的直线上的加速度差。对于在轨道距离 $r$ 处，从中子星中心的一个小位移 $R_{\\mathrm{NS}}$，这个潮汐加速度可以用泰勒级数的第一项来近似：\n$$\\Delta a_{\\mathrm{tidal}} \\approx R_{\\mathrm{NS}} \\left| \\frac{d a_{\\mathrm{BH}}}{dr} \\right| = R_{\\mathrm{NS}} \\left| \\frac{d}{dr} \\left( \\frac{G M_{\\mathrm{BH}}}{r^2} \\right) \\right| = R_{\\mathrm{NS}} \\left| -\\frac{2 G M_{\\mathrm{BH}}}{r^3} \\right| = \\frac{2 G M_{\\mathrm{BH}} R_{\\mathrm{NS}}}{r^3}$$\n将中子星束缚在一起的表面引力为：\n$$g_{\\mathrm{NS}} = \\frac{G M_{\\mathrm{NS}}}{R_{\\mathrm{NS}}^2}$$\n当这两个加速度相等时，潮汐瓦解在半径 $r_t$ 处发生：\n$$\\frac{2 G M_{\\mathrm{BH}} R_{\\mathrm{NS}}}{r_t^3} = \\frac{G M_{\\mathrm{NS}}}{R_{\\mathrm{NS}}^2}$$\n求解 $r_t$，我们得到：\n$$r_t^3 = \\frac{2 M_{\\mathrm{BH}} R_{\\mathrm{NS}}^3}{M_{\\mathrm{NS}}}$$\n$$r_t = R_{\\mathrm{NS}} \\left( \\frac{2 M_{\\mathrm{BH}}}{M_{\\mathrm{NS}}} \\right)^{1/3}$$\n这是洛希极限的简化形式。\n\n接下来，我们计算无量纲潮汐瓦解半径 $\\hat{r}_t = r_t c^2 / (G M_{\\mathrm{BH}})$。我们代入给定的物理参数：$M_{\\mathrm{BH}} = 7.0\\,M_{\\odot}$，$M_{\\mathrm{NS}} = 1.40\\,M_{\\odot}$，以及 $R_{\\mathrm{NS}} = 12.0\\,\\mathrm{km}$。质量比为 $q = M_{\\mathrm{BH}}/M_{\\mathrm{NS}} = 7.0/1.40 = 5$。\n$$r_t = (12.0\\,\\mathrm{km}) \\left( 2 \\times 5 \\right)^{1/3} = 12.0 \\times 10^{1/3}\\,\\mathrm{km}$$\n为了使其无量纲化，我们将其除以黑洞的引力半径 $R_g = G M_{\\mathrm{BH}}/c^2$。我们使用给定的转换因子 $G M_{\\odot}/c^2 = 1.476625\\,\\mathrm{km}$。\n$$ \\frac{G M_{\\mathrm{BH}}}{c^2} = M_{\\mathrm{BH}} \\left(\\frac{G}{c^2}\\right) = (7.0\\,M_{\\odot}) \\left(\\frac{G}{c^2}\\right) = 7.0 \\left(\\frac{G M_{\\odot}}{c^2}\\right) = 7.0 \\times 1.476625\\,\\mathrm{km} = 10.336375\\,\\mathrm{km} $$\n现在我们可以计算 $\\hat{r}_t$：\n$$\\hat{r}_t = \\frac{r_t}{G M_{\\mathrm{BH}}/c^2} = \\frac{12.0 \\times 10^{1/3}\\,\\mathrm{km}}{10.336375\\,\\mathrm{km}} \\approx 2.50143$$\n\n最后一步是利用条件 $\\hat{r}_{\\mathrm{ISCO}}(a_{\\ast}^{\\mathrm{crit}}) = \\hat{r}_t$ 求解临界自旋 $a_{\\ast}^{\\mathrm{crit}}$。Kerr 度规中顺行赤道 ISCO 的无量纲半径由下式给出：\n$$\\hat{r}_{\\mathrm{ISCO}}(a_{\\ast}) = 3 + Z_2 - \\sqrt{(3-Z_1)(3+Z_1+2Z_2)}$$\n其中\n$$Z_1 = 1 + (1-a_{\\ast}^2)^{1/3} \\left[ (1+a_{\\ast})^{1/3} + (1-a_{\\ast})^{1/3} \\right]$$\n$$Z_2 = \\sqrt{3a_{\\ast}^2 + Z_1^2}$$\n我们必须求解方程 $\\hat{r}_{\\mathrm{ISCO}}(a_{\\ast}^{\\mathrm{crit}}) = 2.50143$。这是一个高度非线性的方程，必须进行数值求解。对于顺行轨道（$a_{\\ast} \\ge 0$），函数 $\\hat{r}_{\\mathrm{ISCO}}(a_{\\ast})$ 是单调的，从 $\\hat{r}_{\\mathrm{ISCO}}(0)=6$ (Schwarzschild) 递减到 $\\hat{r}_{\\mathrm{ISCO}}(1)=1$ (极大 Kerr)。由于我们的目标值 $\\hat{r}_t \\approx 2.50143$ 位于此范围内，因此存在一个唯一的解 $a_{\\ast}^{\\mathrm{crit}} \\in (0,1)$。\n\n我们可以通过数值迭代来求解。例如，测试 $a_{\\ast} = 0.8$ 得出 $\\hat{r}_{\\mathrm{ISCO}}(0.8) \\approx 2.906$，测试 $a_{\\ast} = 0.9$ 得出 $\\hat{r}_{\\mathrm{ISCO}}(0.9) \\approx 2.321$。这将解限定在 $a_{\\ast}=0.8$ 和 $a_{\\ast}=0.9$ 之间。需要进行更精细的数值搜索（例如，使用二分法或 Newton-Raphson 方法）。\n\n让我们测试此范围内的某个值，例如 $a_{\\ast} = 0.8718$:\n对于 $a_{\\ast}=0.8718$:\n$a_{\\ast}^2 \\approx 0.760035$\n$1-a_{\\ast}^2 \\approx 0.239965$\n$1+a_{\\ast} = 1.8718$\n$1-a_{\\ast} = 0.1282$\n$Z_1 = 1 + (0.239965)^{1/3} \\left[ (1.8718)^{1/3} + (0.1282)^{1/3} \\right] \\approx 1 + (0.62139) \\left[ 1.23227 + 0.50424 \\right] \\approx 2.07886$\n$Z_2 = \\sqrt{3(0.760035) + (2.07886)^2} \\approx \\sqrt{2.28011 + 4.32169} \\approx 2.56939$\n$\\hat{r}_{\\mathrm{ISCO}}(0.8718) = 3 + 2.56939 - \\sqrt{(3-2.07886)(3+2.07886+2 \\times 2.56939)} \\approx 5.56939 - \\sqrt{(0.92114)(10.21764)} \\approx 5.56939 - \\sqrt{9.4121} \\approx 5.56939 - 3.06792 \\approx 2.50147$\n这个值 $\\hat{r}_{\\mathrm{ISCO}}(0.8718) \\approx 2.50147$ 与我们计算出的 $\\hat{r}_t \\approx 2.50143$ 非常吻合。差异可以忽略不计。\n\n因此，临界自旋值，四舍五入到四位有效数字，是 $0.8718$。",
            "answer": "$$\\boxed{0.8718}$$"
        },
        {
            "introduction": "数值相对论模拟产生了大量的流体“示踪粒子”数据，但并非所有物质都能成功逃逸。这个实践的核心任务是从这些数据中精确识别出引力未束缚的物质，因为只有这部分物质才能对r-过程核合成和千新星辐射做出贡献。通过应用和比较两种不同的未束缚判据——测地线判据 ($u_t < -1$) 和更完备的伯努利判据 ($h u_t < -1$) ，你将亲手实践天体物理学家分析模拟数据的基本方法，并理解热能在决定物质最终命运中的重要作用。",
            "id": "3484886",
            "problem": "给定代表了数值相对论（NR）模拟的致密天体并合后流出物中物质元素的离散示踪粒子数据。在广义相对论（GR）中，一个常见的任务是根据从静态时空中的基本守恒定律推导出的两个判据来确定流体元是否在引力上是非束缚的：一个是测地线判据，另一个是流体动力学伯努利判据。从核天体物理学的角度，你必须估算这些不同的非束缚判据如何改变预测的非束缚质量以及与快中子俘获（r过程）核合成相关的成分代理。\n\n基本理论：\n- 在具有类时Killing矢量的静态时空中，四维速度的协变时间分量 $u_t$ 与试探粒子的单位静质量守恒能量相关。对于弹道（无压）运动，如果一个元素在无穷远处的比能超过1（在光速 $c$ 等于 $1$ 的单位制中），则该元素是非束缚的，这产生了测地线非束缚条件 $u_t < -1$。\n- 对于压强和内能很重要的绝热相对论性流体，相对论性伯努利常数意味着 $h u_t$ 的近似守恒，其中 $h$ 是比焓。在这种情况下，如果一个流体元满足 $h u_t < -1$，则认为它是非束缚的。\n- 比焓定义为 $h = 1 + \\epsilon + p/\\rho$，其中 $\\epsilon$ 是比内能，$p$ 是压强，$\\rho$ 是静质量密度。所有量都在 $c=G=1$ 的相对论单位制中测量。\n\n定义与任务：\n- 对于每个示踪粒子 $i$，给定一个元组 $(m_i, u_{t,i}, \\epsilon_i, p_i, \\rho_i, Y_{e,i})$，其中 $m_i$ 是以太阳质量为单位的静质量权重，$u_{t,i}$ 是四维速度的协变时间分量，$\\epsilon_i$ 是比内能，$p_i$ 是压强，$\\rho_i$ 是静质量密度，$Y_{e,i}$ 是电子分数。比焓为 $h_i = 1 + \\epsilon_i + p_i/\\rho_i$。\n- 必须为每个示踪粒子计算两个非束缚标志：\n  - 测地线判据：$u_{t,i} < -1$。\n  - 伯努利判据：$h_i u_{t,i} < -1$。\n  不等式是严格的；如果等式成立，则将示踪粒子视为束缚的。\n- 对于每个判据 $C \\in \\{\\mathrm{geodesic}, \\mathrm{Bernoulli}\\}$，计算：\n  1. 总非束缚质量 $M^{(C)}_{\\mathrm{unb}} = \\sum_{i \\in U_C} m_i$，单位为太阳质量，其中 $U_C$ 是被判据 $C$ 标记为非束缚的索引集合。\n  2. 质量加权平均电子分数 $\\langle Y_e \\rangle^{(C)} = \\left(\\sum_{i \\in U_C} m_i Y_{e,i}\\right) \\Big/ \\left(\\sum_{i \\in U_C} m_i\\right)$。如果 $\\sum_{i \\in U_C} m_i = 0$，则定义 $\\langle Y_e \\rangle^{(C)} = 0$。\n  3. 镧系元素生成质量分数代理 $f_{\\mathrm{lan}}^{(C)}$，定义为 $M^{(C)}_{\\mathrm{unb}}$ 中满足 $Y_{e,i} < Y_e^{\\mathrm{lan}}$ 的质量部分，其中 $Y_e^{\\mathrm{lan}} = 0.25$。如果 $\\sum_{i \\in U_C} m_i = 0$，则定义 $f_{\\mathrm{lan}}^{(C)} = 0$。\n- 同时计算质量差 $\\Delta M = M^{(\\mathrm{Bernoulli})}_{\\mathrm{unb}} - M^{(\\mathrm{geodesic})}_{\\mathrm{unb}}$。\n\n物理单位与数值约定：\n- 所有质量必须以太阳质量 $M_\\odot$ 表示。\n- 使用 $c=G=1$ 的自然单位制。\n- 数值输出必须四舍五入到六位小数。\n\n测试组：\n- 对于下面的每个数据集，示踪粒子列表是一个形式为 $(m_i, u_{t,i}, \\epsilon_i, p_i, \\rho_i, Y_{e,i})$ 的元组列表。所有数字都采用LaTeX格式。你的程序必须为每个数据集独立计算这些指标。\n\n数据集A（两种判据结果不同的顺利路径）：\n- 示踪粒子：\n  - $(2\\times 10^{-5},\\,-0.95,\\,0.6,\\,0.3,\\,1.0,\\,0.20)$\n  - $(1\\times 10^{-5},\\,-1.02,\\,0.1,\\,0.05,\\,1.0,\\,0.30)$\n  - $(5\\times 10^{-6},\\,-0.99,\\,0.8,\\,0.4,\\,1.0,\\,0.18)$\n  - $(3\\times 10^{-5},\\,-1.10,\\,0.0,\\,0.0,\\,1.0,\\,0.27)$\n  - $(8\\times 10^{-6},\\,-0.92,\\,0.2,\\,0.1,\\,1.0,\\,0.40)$\n  - $(1.5\\times 10^{-5},\\,-0.88,\\,0.05,\\,0.05,\\,1.0,\\,0.50)$\n  - $(4\\times 10^{-6},\\,-1.005,\\,0.3,\\,0.2,\\,1.0,\\,0.22)$\n  - $(6\\times 10^{-6},\\,-0.97,\\,0.6,\\,0.5,\\,1.0,\\,0.24)$\n\n数据集B（边界及近边界行为）：\n- 示踪粒子：\n  - $(1\\times 10^{-5},\\,-1.0,\\,0.0,\\,0.0,\\,1.0,\\,0.25)$\n  - $(1.5\\times 10^{-5},\\,-0.909,\\,0.05,\\,0.05,\\,1.0,\\,0.24)$\n  - $(2\\times 10^{-5},\\,-1.001,\\,0.0,\\,0.0,\\,1.0,\\,0.30)$\n  - $(8\\times 10^{-6},\\,-0.95,\\,0.7,\\,0.3,\\,1.0,\\,0.10)$\n  - $(5\\times 10^{-6},\\,-0.85,\\,0.2,\\,0.1,\\,1.0,\\,0.35)$\n  - $(4\\times 10^{-6},\\,-0.8,\\,0.0,\\,0.0,\\,1.0,\\,0.50)$\n\n数据集C（无非束缚喷出物的边缘情况）：\n- 示踪粒子：\n  - $(1\\times 10^{-5},\\,-0.95,\\,0.02,\\,0.01,\\,1.0,\\,0.20)$\n  - $(2\\times 10^{-5},\\,-0.97,\\,0.0,\\,0.0,\\,1.0,\\,0.28)$\n  - $(1.2\\times 10^{-5},\\,-0.92,\\,0.03,\\,0.02,\\,1.0,\\,0.22)$\n  - $(8\\times 10^{-6},\\,-0.88,\\,0.10,\\,0.0,\\,1.0,\\,0.40)$\n  - $(5\\times 10^{-6},\\,-0.80,\\,0.0,\\,0.0,\\,1.0,\\,0.18)$\n\n要求的最终输出格式：\n- 对于每个数据集，生成一个列表 $[M^{(\\mathrm{geod})}_{\\mathrm{unb}}, M^{(\\mathrm{bern})}_{\\mathrm{unb}}, \\Delta M, \\langle Y_e \\rangle^{(\\mathrm{geod})}, \\langle Y_e \\rangle^{(\\mathrm{bern})}, f_{\\mathrm{lan}}^{(\\mathrm{geod})}, f_{\\mathrm{lan}}^{(\\mathrm{bern})}]$，其中所有浮点数都四舍五入到六位小数。\n- 你的程序应生成单行输出，其中包含所有数据集的结果，形式为这些按数据集排列的列表的逗号分隔列表，并用方括号括起来，例如：$[[\\dots],[\\dots],[\\dots]]$。",
            "solution": "所述问题在科学上是合理的、内容是独立的且定义是明确的。它提出了数值相对论和相对论天体物理学领域的一个标准分析任务，特别是关于致密双星并合的流出物性质的分析。其物理原理、定义和计算任务清晰，并基于已有文献。因此，我们可以着手解决。\n\n问题的核心是区分两种用于识别引力非束缚物质的判据，并量化这一选择对与r过程核合成相关的天体物理可观测量的影响。这些判据源于广义相对论中的基本守恒定律。\n\n首先，我们建立理论基础。在静态时空中（对于并合后晚期的环境来说，这是一个合理的近似），存在一个类时Killing矢量场，通常表示为 $\\xi^{\\mu}$。在远离中心天体的标准坐标系中，该矢量为 $\\xi^{\\mu} = (1, 0, 0, 0)$。粒子或流体元的四维动量为 $p^{\\mu} = m_0 u^{\\mu}$，其中 $m_0$ 是静质量，$u^{\\mu}$ 是四维速度。沿着试探粒子的世界线，量 $E = -p_{\\mu}\\xi^{\\mu}$ 是守恒的。因此，比能（单位静质量的能量）为 $e = -u_{\\mu}\\xi^{\\mu}$。在我们选择的坐标中，这简化为 $e = -u_t$，其中 $u_t$ 是四维速度的协变时间分量。为了使粒子能够逃逸到无穷远并具有非负动能，其比能必须大于1（在 $c=1$ 的单位制中）。这导致条件 $e > 1$，或 $-u_t > 1$，这等价于**测地线非束缚判据**：\n$$\nu_t < -1\n$$\n该判据适用于“试探粒子”或“弹道”喷出物，其中压强和热能可以忽略不计。\n\n然而，从并合事件中喷射出的物质是高温、高密度的流体。总能量包括来自静质量、内能（热能）和压强力做功的贡献。对于绝热相对论性流体，从相对论性欧拉方程导出的一个更普适的守恒量与相对论性伯努利方程有关。沿流体流线近似守恒的量是 $h u_t$，其中 $h$ 是比焓。比焓定义为：\n$$\nh = 1 + \\epsilon + \\frac{p}{\\rho}\n$$\n这里，$\\epsilon$ 是比内能，$p$ 是流体压强，$\\rho$ 是静质量密度。$\\epsilon$ 项考虑了热能，$p/\\rho$ 项考虑了压强的“势能”。为了使流体元成为非束缚的，其包括这些贡献在内的总比能必须在无穷远处超过1。这给出了**流体动力学或伯努利非束缚判据**：\n$$\nh u_t < -1\n$$\n由于 $\\epsilon$、$p$ 和 $\\rho$ 是非负的，比焓 $h \\ge 1$。因此，如果一个流体元根据测地线判据是非束缚的（$u_t < -1$），那么它根据伯努利判据也自动是非束缚的（$h u_t \\le u_t < -1$）。反之则不成立；一个流体元可以是测地线束缚的（$u_t \\ge -1$），但具有足够的热能和压强能，通过伯努利判据变为非束缚的。这就是为什么我们预期 $M^{(\\mathrm{Bernoulli})}_{\\mathrm{unb}} \\ge M^{(\\mathrm{geodesic})}_{\\mathrm{unb}}$。\n\n该问题要求我们为一组给定的示踪粒子计算几个量，每个粒子代表一个质量为 $m_i$ 的流体元。对于每个判据 $C \\in \\{\\mathrm{geodesic}, \\mathrm{Bernoulli}\\}$，我们必须计算：\n1.  总非束缚质量，$M^{(C)}_{\\mathrm{unb}} = \\sum_{i \\in U_C} m_i$，其中 $U_C$ 是满足判据 $C$ 的示踪粒子集合。\n2.  质量加权平均电子分数 $\\langle Y_e \\rangle^{(C)}$，它是最终核合成丰度模式的一个代理。其计算公式为 $\\langle Y_e \\rangle^{(C)} = (\\sum_{i \\in U_C} m_i Y_{e,i}) / M^{(C)}_{\\mathrm{unb}}$。\n3.  产生镧系元素的物质的质量分数代理 $f_{\\mathrm{lan}}^{(C)}$。这是非束缚质量中电子分数 $Y_{e,i}$ 低于阈值 $Y_e^{\\mathrm{lan}} = 0.25$ 的部分，因为产生最重的r过程元素（镧系元素和锕系元素）需要非常富中子的条件（$Y_e < 0.25$）。其计算公式为 $f_{\\mathrm{lan}}^{(C)} = (\\sum_{i \\in U_C, Y_{e,i} < Y_e^{\\mathrm{lan}}} m_i) / M^{(C)}_{\\mathrm{unb}}$。\n\n计算步骤如下：\n1.  对于每个数据集，为测地线和伯努利两种判据分别初始化总非束缚质量、质量加权的 $Y_e$ 分子以及产生镧系元素的质量的累加器。所有累加器均初始化为 $0$。\n2.  遍历每个示踪粒子 $i$ 及其属性 $(m_i, u_{t,i}, \\epsilon_i, p_i, \\rho_i, Y_{e,i})$。\n3.  对于每个示踪粒子，评估两个非束缚判据。问题指定了严格不等式。\n    a. **测地线判据**：检查是否 $u_{t,i} < -1$。如果为真，则该示踪粒子是测地线非束缚的。\n    b. **伯努利判据**：首先计算比焓 $h_i = 1 + \\epsilon_i + p_i/\\rho_i$。然后，检查是否 $h_i u_{t,i} < -1$。如果为真，则该示踪粒子根据伯努利判据是非束缚的。\n4.  如果一个示踪粒子被发现是测地线非束缚的，则其质量 $m_i$ 被加到 $M^{(\\mathrm{geodesic})}_{\\mathrm{unb}}$ 中，乘积 $m_i Y_{e,i}$ 被加到相应的 $Y_e$ 分子中，并且如果 $Y_{e,i} < 0.25$，其质量 $m_i$ 也被加到测地线判据的镧系元素质量累加器中。\n5.  对伯努利判据独立地遵循相同的程序。\n6.  处理完一个数据集中的所有示踪粒子后，计算最终的量。对于每个判据 $C$：\n    a. 如果 $M^{(C)}_{\\mathrm{unb}} > 0$，则通过将累加的总和除以 $M^{(C)}_{\\mathrm{unb}}$ 来计算 $\\langle Y_e \\rangle^{(C)}$ 和 $f_{\\mathrm{lan}}^{(C)}$。\n    b. 如果 $M^{(C)}_{\\mathrm{unb}} = 0$，则 $\\langle Y_e \\rangle^{(C)}$ 和 $f_{\\mathrm{lan}}^{(C)}$ 都定义为 $0$。\n7.  计算非束缚质量的差异：$\\Delta M = M^{(\\mathrm{Bernoulli})}_{\\mathrm{unb}} - M^{(\\mathrm{geodesic})}_{\\mathrm{unb}}$。\n8.  收集这七个值（$M^{(\\mathrm{geod})}_{\\mathrm{unb}}, M^{(\\mathrm{bern})}_{\\mathrm{unb}}, \\Delta M, \\langle Y_e \\rangle^{(\\mathrm{geod})}, \\langle Y_e \\rangle^{(\\mathrm{bern})}, f_{\\mathrm{lan}}^{(\\mathrm{geod})}, f_{\\mathrm{lan}}^{(\\mathrm{bern})}$），将每个值四舍五入到六位小数，并按要求格式化。对所有提供的数据集重复此过程。",
            "answer": "```python\nimport numpy as np\n# from scipy import ... # Not required for this problem.\n\ndef solve():\n    \"\"\"\n    Processes tracer data from numerical relativity simulations to\n    calculate unbound mass and composition proxies based on two\n    different unboundness criteria.\n    \"\"\"\n    datasets = [\n        # Dataset A\n        [\n            (2e-5, -0.95, 0.6, 0.3, 1.0, 0.20),\n            (1e-5, -1.02, 0.1, 0.05, 1.0, 0.30),\n            (5e-6, -0.99, 0.8, 0.4, 1.0, 0.18),\n            (3e-5, -1.10, 0.0, 0.0, 1.0, 0.27),\n            (8e-6, -0.92, 0.2, 0.1, 1.0, 0.40),\n            (1.5e-5, -0.88, 0.05, 0.05, 1.0, 0.50),\n            (4e-6, -1.005, 0.3, 0.2, 1.0, 0.22),\n            (6e-6, -0.97, 0.6, 0.5, 1.0, 0.24),\n        ],\n        # Dataset B\n        [\n            (1e-5, -1.0, 0.0, 0.0, 1.0, 0.25),\n            (1.5e-5, -0.909, 0.05, 0.05, 1.0, 0.24),\n            (2e-5, -1.001, 0.0, 0.0, 1.0, 0.30),\n            (8e-6, -0.95, 0.7, 0.3, 1.0, 0.10),\n            (5e-6, -0.85, 0.2, 0.1, 1.0, 0.35),\n            (4e-6, -0.8, 0.0, 0.0, 1.0, 0.50),\n        ],\n        # Dataset C\n        [\n            (1e-5, -0.95, 0.02, 0.01, 1.0, 0.20),\n            (2e-5, -0.97, 0.0, 0.0, 1.0, 0.28),\n            (1.2e-5, -0.92, 0.03, 0.02, 1.0, 0.22),\n            (8e-6, -0.88, 0.10, 0.0, 1.0, 0.40),\n            (5e-6, -0.80, 0.0, 0.0, 1.0, 0.18),\n        ],\n    ]\n\n    Y_e_lan_threshold = 0.25\n    all_results = []\n\n    for tracers in datasets:\n        # Initialize accumulators for geodesic criterion\n        m_unb_geod = 0.0\n        m_ye_num_geod = 0.0\n        m_lan_geod = 0.0\n\n        # Initialize accumulators for Bernoulli criterion\n        m_unb_bern = 0.0\n        m_ye_num_bern = 0.0\n        m_lan_bern = 0.0\n\n        for m_i, u_t_i, eps_i, p_i, rho_i, Ye_i in tracers:\n            # Geodesic unbound criterion: u_t  -1\n            if u_t_i  -1.0:\n                m_unb_geod += m_i\n                m_ye_num_geod += m_i * Ye_i\n                if Ye_i  Y_e_lan_threshold:\n                    m_lan_geod += m_i\n\n            # Bernoulli unbound criterion: h * u_t  -1\n            h_i = 1.0 + eps_i + p_i / rho_i\n            if h_i * u_t_i  -1.0:\n                m_unb_bern += m_i\n                m_ye_num_bern += m_i * Ye_i\n                if Ye_i  Y_e_lan_threshold:\n                    m_lan_bern += m_i\n\n        # --- Final calculations for the dataset ---\n\n        # Geodesic metrics\n        if m_unb_geod > 0:\n            avg_Ye_geod = m_ye_num_geod / m_unb_geod\n            f_lan_geod = m_lan_geod / m_unb_geod\n        else:\n            avg_Ye_geod = 0.0\n            f_lan_geod = 0.0\n\n        # Bernoulli metrics\n        if m_unb_bern > 0:\n            avg_Ye_bern = m_ye_num_bern / m_unb_bern\n            f_lan_bern = m_lan_bern / m_unb_bern\n        else:\n            avg_Ye_bern = 0.0\n            f_lan_bern = 0.0\n        \n        # Mass difference\n        delta_M = m_unb_bern - m_unb_geod\n\n        dataset_results = [\n            m_unb_geod,\n            m_unb_bern,\n            delta_M,\n            avg_Ye_geod,\n            avg_Ye_bern,\n            f_lan_geod,\n            f_lan_bern,\n        ]\n        all_results.append(dataset_results)\n\n    # Format the final output string according to the specification\n    formatted_dataset_strings = []\n    for res_list in all_results:\n        # Format each number to 6 decimal places as a fixed-point string\n        formatted_numbers = [f\"{num:.6f}\" for num in res_list]\n        formatted_dataset_strings.append(f\"[{','.join(formatted_numbers)}]\")\n    \n    final_output_string = f\"[{','.join(formatted_dataset_strings)}]\"\n    print(final_output_string)\n\nsolve()\n```"
        },
        {
            "introduction": "在确定了未束缚抛射物的属性后，最后一步是预测它将合成哪些元素。本练习将通过一个简化的“单区”模型，让你体验如何将示踪粒子记录的热力学历史转化为核合成的最终产物 。你将实现一个模型，该模型利用粒子的电子分数 ($Y_e$)、熵 ($S$) 和膨胀时间尺度 ($\\tau_{\\mathrm{exp}}$) 等关键参数，通过一个简化的中子俘获反应网络，最终计算出r-过程产生的平均原子质量数，从而架起从宏观动力学到微观核物理的桥梁。",
            "id": "3484914",
            "problem": "给定一个简化的、用于并合后r-过程核合成的第一性原理模型，该模型追踪一次数值相对论 (NR) 模拟中单个示踪粒子的热力学历史。示踪粒子是一个拉格朗日流体元，它随流体被动平流，并记录其路径上的热力学量。在单区近似中，粒子的密度历史可被建模为同系膨胀，其指数剖面由体积元的连续性方程导出：如果特征膨胀时标为 $\\tau_{\\mathrm{exp}}$，则密度为 $\\rho(t) = \\rho_0 \\exp(-t / \\tau_{\\mathrm{exp}})$，其中 $\\rho_0$ 是初始密度。对于辐射主导状态下、每重子熵 $S$（以玻尔兹曼常数 $k_B$ 为单位）恒定的绝热膨胀，温度的标度关系为 $T(t) \\propto \\rho(t)^{1/3}$，这意味着对于给定的初始温度 $T_0$，有 $T(t) = T_0 \\exp(-t / (3 \\tau_{\\mathrm{exp}}))$。\n\n假设r-过程可近似为中子俘获到预先存在的种子核上。设 $Y_n(t)$ 为每重子中子数分数，$Y_s$ 为每重子种子核数分数。在这个玩具模型中，$Y_s$ 在中子俘获阶段被视为常数（带电粒子冻结已产生种子核），而 $Y_n(t)$ 根据质量作用俘获定律演化：\n$$\n\\frac{d Y_n}{d t} = - \\lambda(t) \\, Y_n(t) \\, Y_s,\n$$\n其中 $\\lambda(t)$ 是每个种子核的有效中子俘获率，其形式被认为是与温度相关的\n$$\n\\lambda(t) = \\lambda_0 \\left(\\frac{T(t)}{T_0}\\right)^{\\nu}.\n$$\n假设 $\\nu = 1$（线性温度标度）。当温度下降到阈值 $T_{\\mathrm{thr}}$ 以下时，俘获阶段在时间 $t_{\\mathrm{end}}$ 结束，定义为 $T(t_{\\mathrm{end}}) = T_{\\mathrm{thr}}$。如果 $T_{\\mathrm{thr}} \\ge T_0$，则 $t_{\\mathrm{end}} = 0$（没有发生俘获）。\n\n初始的每重子种子核数分数参数化为\n$$\nY_s = k_{\\mathrm{seed}} \\, \\frac{\\max(0, \\, 0.5 - Y_e)}{S / S_0},\n$$\n其中 $Y_e$ 是示踪粒子的电子分数，$S$ 是以 $k_B$ 为单位的每重子熵，$S_0$ 是一个参考熵，$k_{\\mathrm{seed}}$ 是一个无量纲标度常数。该参数化反映了较高的熵会抑制种子核的形成，而较低的 $Y_e$（更富中子的物质）有利于种子核的形成。带电粒子冻结后，可供种子核俘获的初始每重子中子数分数由重子收支近似得出\n$$\nY_{n,0} = \\max\\left(0, \\, 1 - Y_e - A_{\\mathrm{seed}} \\, Y_s\\right),\n$$\n其中 $A_{\\mathrm{seed}}$ 是种子核的平均质量数。从 $t=0$ 到 $t=t_{\\mathrm{end}}$，该俘获定律产生一个解析解：\n$$\nY_n(t_{\\mathrm{end}}) = Y_{n,0} \\, \\exp\\left[- Y_s \\int_0^{t_{\\mathrm{end}}} \\lambda_0 \\exp\\left(-\\frac{t}{3 \\tau_{\\mathrm{exp}}}\\right) dt \\right],\n$$\n其中\n$$\nt_{\\mathrm{end}} = 3 \\, \\tau_{\\mathrm{exp}} \\, \\ln\\left(\\frac{T_0}{T_{\\mathrm{thr}}}\\right) \\quad \\text{for} \\quad T_{\\mathrm{thr}}  T_0,\n$$\n以及\n$$\n\\int_0^{t_{\\mathrm{end}}} \\lambda_0 \\exp\\left(-\\frac{t}{3 \\tau_{\\mathrm{exp}}}\\right) dt = \\lambda_0 \\, \\frac{1 - \\exp\\left(-\\frac{t_{\\mathrm{end}}}{3 \\tau_{\\mathrm{exp}}}\\right)}{1/(3 \\tau_{\\mathrm{exp}})}.\n$$\n通过将被俘获的中子分配到种子核上，可以估算平均最终质量数：\n$$\nA_{\\mathrm{final}} = \n\\begin{cases}\nA_{\\mathrm{seed}} + \\dfrac{Y_{n,0} - Y_n(t_{\\mathrm{end}})}{Y_s},  \\text{if } Y_s  \\epsilon, \\\\\n0,  \\text{if } Y_s \\le \\epsilon,\n\\end{cases}\n$$\n其中 $\\epsilon$ 是一个小阈值，用于在有效没有种子核时避免除以零。为了在没有完整的裂变循环网络的情况下强制物理合理性，将结果上限设为 $A_{\\mathrm{cap}}$：\n$$\nA_{\\mathrm{final}} \\leftarrow \\min\\left(A_{\\mathrm{final}}, A_{\\mathrm{cap}}\\right).\n$$\n该模型通过使用示踪粒子的 $(Y_e, S, \\rho(t), T(t))$ 历史来驱动简化的中子俘获计算，从而与数值相对论模拟中的示踪方法论联系起来。\n\n您的任务是实现一个程序，根据上述模型为每个测试用例计算 $A_{\\mathrm{final}}$。对所有测试用例统一使用以下常量：\n- $S_0 = 10$（参考熵，单位为 $k_B$），\n- $k_{\\mathrm{seed}} = 0.01$（无量纲），\n- $\\nu = 1$，\n- $\\epsilon = 10^{-12}$，\n- $A_{\\mathrm{cap}} = 250$。\n\n每个测试用例指定元组 $(Y_e, S, \\tau_{\\mathrm{exp}}, \\rho_0, T_0, T_{\\mathrm{thr}}, \\lambda_0, A_{\\mathrm{seed}})$，单位如下：\n- $Y_e$ 和 $S$ 是无量纲的（$S$ 以每重子 $k_B$ 为单位），\n- $\\tau_{\\mathrm{exp}}$ 单位为秒，\n- $\\rho_0$ 单位为 $\\mathrm{g\\,cm^{-3}}$（通过指数定律隐式使用；它在定义 $T(t)$ 的比率中被抵消），\n- $T_0$ 和 $T_{\\mathrm{thr}}$ 单位为吉开尔文（写作 $\\mathrm{GK}$），\n- $\\lambda_0$ 单位为 $\\mathrm{s^{-1}}$，\n- $A_{\\mathrm{seed}}$ 是无量纲的。\n\n请完全按照规定（包括上限）实现计算，并为每个测试用例返回平均最终质量数 $A_{\\mathrm{final}}$。测试套件包含以下五个用例：\n1. $(Y_e, S, \\tau_{\\mathrm{exp}}, \\rho_0, T_0, T_{\\mathrm{thr}}, \\lambda_0, A_{\\mathrm{seed}}) = (0.05, 10, 0.005, 10^{11}, 6, 1, 10000, 90)$,\n2. $(Y_e, S, \\tau_{\\mathrm{exp}}, \\rho_0, T_0, T_{\\mathrm{thr}}, \\lambda_0, A_{\\mathrm{seed}}) = (0.25, 30, 0.05, 10^{10}, 6, 1.5, 5000, 90)$,\n3. $(Y_e, S, \\tau_{\\mathrm{exp}}, \\rho_0, T_0, T_{\\mathrm{thr}}, \\lambda_0, A_{\\mathrm{seed}}) = (0.45, 20, 0.02, 5 \\times 10^{10}, 5, 1.2, 3000, 90)$,\n4. $(Y_e, S, \\tau_{\\mathrm{exp}}, \\rho_0, T_0, T_{\\mathrm{thr}}, \\lambda_0, A_{\\mathrm{seed}}) = (0.20, 100, 0.01, 10^{11}, 6, 1, 8000, 90)$,\n5. $(Y_e, S, \\tau_{\\mathrm{exp}}, \\rho_0, T_0, T_{\\mathrm{thr}}, \\lambda_0, A_{\\mathrm{seed}}) = (0.10, 20, 0.01, 10^{11}, 1, 1, 5000, 90)$。\n\n上面列出的所有数值输入都采用指定的单位，并且必须如此处理。每个测试用例的输出是一个表示 $A_{\\mathrm{final}}$ 的浮点数，该值是无量纲的。您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表，每个浮点数四舍五入到三位小数，例如 $[90.000,140.123, \\dots]$。",
            "solution": "在尝试任何解决方案之前，该问题都经过了严格的验证过程。\n\n### 第一步：提取已知条件\n\n所提供的模型由以下方程和参数定义：\n\n**热力学演化：**\n- 密度：$\\rho(t) = \\rho_0 \\exp(-t / \\tau_{\\mathrm{exp}})$\n- 温度：$T(t) = T_0 \\exp(-t / (3 \\tau_{\\mathrm{exp}}))$\n\n**中子俘获动力学：**\n- 中子数分数的变化率：$\\frac{d Y_n}{d t} = - \\lambda(t) \\, Y_n(t) \\, Y_s$\n- 与温度相关的俘获率：$\\lambda(t) = \\lambda_0 \\left(\\frac{T(t)}{T_0}\\right)^{\\nu}$，其中 $\\nu = 1$。\n\n**初始条件与参数化：**\n- 初始种子核数分数：$Y_s = k_{\\mathrm{seed}} \\, \\frac{\\max(0, \\, 0.5 - Y_e)}{S / S_0}$\n- 初始中子数分数：$Y_{n,0} = \\max\\left(0, \\, 1 - Y_e - A_{\\mathrm{seed}} \\, Y_s\\right)$\n\n**俘获阶段终点与解：**\n- 俘获结束时间 $t_{\\mathrm{end}}$ 由 $T(t_{\\mathrm{end}}) = T_{\\mathrm{thr}}$ 定义。\n- 对于 $T_{\\mathrm{thr}}  T_0$，有 $t_{\\mathrm{end}} = 3 \\, \\tau_{\\mathrm{exp}} \\, \\ln\\left(\\frac{T_0}{T_{\\mathrm{thr}}}\\right)$。\n- 对于 $T_{\\mathrm{thr}} \\ge T_0$，有 $t_{\\mathrm{end}} = 0$。\n- 最终中子分数：$Y_n(t_{\\mathrm{end}}) = Y_{n,0} \\, \\exp\\left[- Y_s \\int_0^{t_{\\mathrm{end}}} \\lambda_0 \\exp\\left(-\\frac{t}{3 \\tau_{\\mathrm{exp}}}\\right) dt \\right]$\n- 该定积分给定为：$\\int_0^{t_{\\mathrm{end}}} \\lambda_0 \\exp\\left(-\\frac{t}{3 \\tau_{\\mathrm{exp}}}\\right) dt = \\lambda_0 \\, \\frac{1 - \\exp\\left(-\\frac{t_{\\mathrm{end}}}{3 \\tau_{\\mathrm{exp}}}\\right)}{1/(3 \\tau_{\\mathrm{exp}})}$\n\n**最终质量数计算：**\n- 对于 $Y_s  \\epsilon$，有 $A_{\\mathrm{final}} = A_{\\mathrm{seed}} + \\dfrac{Y_{n,0} - Y_n(t_{\\mathrm{end}})}{Y_s}$。\n- 对于 $Y_s \\le \\epsilon$，有 $A_{\\mathrm{final}} = 0$。\n- 设置上限：$A_{\\mathrm{final}} \\leftarrow \\min\\left(A_{\\mathrm{final}}, A_{\\mathrm{cap}}\\right)$。\n\n**常量：**\n- $S_0 = 10$\n- $k_{\\mathrm{seed}} = 0.01$\n- $\\nu = 1$\n- $\\epsilon = 10^{-12}$\n- $A_{\\mathrm{cap}} = 250$\n\n**测试用例（$(Y_e, S, \\tau_{\\mathrm{exp}}, \\rho_0, T_0, T_{\\mathrm{thr}}, \\lambda_0, A_{\\mathrm{seed}})$ 的元组）：**\n1. $(0.05, 10, 0.005, 10^{11}, 6, 1, 10000, 90)$\n2. $(0.25, 30, 0.05, 10^{10}, 6, 1.5, 5000, 90)$\n3. $(0.45, 20, 0.02, 5 \\times 10^{10}, 5, 1.2, 3000, 90)$\n4. $(0.20, 100, 0.01, 10^{11}, 6, 1, 8000, 90)$\n5. $(0.10, 20, 0.01, 10^{11}, 1, 1, 5000, 90)$\n\n### 第二步：使用提取的已知条件进行验证\n\n根据所需标准对问题进行评估。\n- **科学基础扎实：** 该问题提出了一个简化的、用于r-过程核合成的单区模型。这是核天体物理学中一个标准的教学和研究工具。物理参数化，例如种子核形成对电子分数 $Y_e$ 和熵 $S$ 的依赖性，以及中子俘获的质量作用定律，都基于已建立的物理原理。这是对底层物理的简化，而非违背。\n- **提法恰当：** 该问题提供了一套完整的、顺序的方程和条件，可以从一组给定的输入参数中计算出唯一的 $A_{\\mathrm{final}}$ 值。边缘情况，例如没有种子核形成（$Y_s \\le \\epsilon$）或初始温度过低无法进行俘获（$T_0 \\le T_{\\mathrm{thr}}$），都已明确定义。\n- **客观性：** 问题以精确、定量且无偏见的科学语言陈述。\n- **完整性与一致性：** 提供了所有必要的常量和公式。变量 $\\rho_0$ 被提及，但正确地指出计算中不需要它，因为温度演化仅取决于比率 $T(t)/T_0$。所提供的反应率时间积分公式已经过验证且正确无误。逻辑流程一致，没有矛盾。\n- **合理性：** 测试用例的输入参数对于中子星并合的抛射物是物理上合理的。\n\n### 第三步：结论与行动\n\n该问题被判定为**有效**。它是一个自洽、科学上连贯且提法恰当的计算问题。将据此开发解决方案。\n\n解决方案的流程是为每个测试用例实现问题陈述中定义的计算序列。\n\n**1. 计算初始种子核分数 ($Y_s$)**\n对于每个测试用例，根据电子分数 $Y_e$ 和每重子熵 $S$ 计算初始种子核数分数 $Y_s$。公式为：\n$$\nY_s = k_{\\mathrm{seed}} \\, \\frac{\\max(0, \\, 0.5 - Y_e)}{S / S_0}\n$$\n项 $\\max(0, 0.5 - Y_e)$ 反映了只有在富中子条件（$Y_e  0.5$）下才会形成大量种子核。分母 $S/S_0$ 模拟了高熵对复杂原子核形成的抑制作用。如果计算出的 $Y_s$ 小于或等于阈值 $\\epsilon = 10^{-12}$，则种子核丰度可忽略不计。在这种情况下，根据问题规则将 $A_{\\mathrm{final}}$ 设置为 $0$，并且该用例无需进行进一步计算。\n\n**2. 计算初始中子分数 ($Y_{n,0}$)**\n如果 $Y_s > \\epsilon$，则继续。可用于俘获的初始中子数分数 $Y_{n,0}$ 由总重子收支确定。假设所有重子要么是自由中子，要么被束缚在种子核中，我们有：\n$$\nY_{n,0} = \\max\\left(0, \\, 1 - Y_e - A_{\\mathrm{seed}} \\, Y_s\\right)\n$$\n在这里，$1$ 代表总重子数分数，$Y_e$ 近似于质子分数（因为电荷中性要求 $Y_p = Y_e$），而 $A_{\\mathrm{seed}} Y_s$ 代表锁定在种子核中的总重子分数。\n\n**3. 确定中子俘获持续时间**\n假设当中子俘获过程的温度下降到阈值 $T_{\\mathrm{thr}}$ 时，该过程停止。首先，我们将初始温度 $T_0$ 与 $T_{\\mathrm{thr}}$ 进行比较。\n- 如果 $T_0 \\le T_{\\mathrm{thr}}$，温度已经处于或低于俘获阈值。因此，没有俘获发生，俘获持续时间 $t_{\\mathrm{end}}$ 为 $0$，最终质量数 $A_{\\mathrm{final}}$ 就是初始种子核质量数 $A_{\\mathrm{seed}}$。\n- 如果 $T_0 > T_{\\mathrm{thr}}$，俘获阶段会持续有限的时间 $t_{\\mathrm{end}}$。通过求解 $T(t_{\\mathrm{end}}) = T_{\\mathrm{thr}}$ 来找到该持续时间：\n$$\nT_{\\mathrm{thr}} = T_0 \\exp\\left(-\\frac{t_{\\mathrm{end}}}{3 \\tau_{\\mathrm{exp}}}\\right) \\implies t_{\\mathrm{end}} = 3 \\tau_{\\mathrm{exp}} \\ln\\left(\\frac{T_0}{T_{\\mathrm{thr}}}\\right)\n$$\n\n**4. 计算积分反应项**\n最终中子分数 $Y_n(t_{\\mathrm{end}})$ 取决于俘获率的时间积分的指数。设此积分为 $I$：\n$$\nI = \\int_0^{t_{\\mathrm{end}}} \\lambda(t) dt = \\int_0^{t_{\\mathrm{end}}} \\lambda_0 \\left(\\frac{T(t)}{T_0}\\right) dt = \\int_0^{t_{\\mathrm{end}}} \\lambda_0 \\exp\\left(-\\frac{t}{3 \\tau_{\\mathrm{exp}}}\\right) dt\n$$\n提供了该积分的计算。一个更直接的计算使用关系式 $\\exp(-t_{\\mathrm{end}} / (3 \\tau_{\\mathrm{exp}})) = T_{\\mathrm{thr}} / T_0$：\n$$\nI = \\lambda_0 \\left[ -3 \\tau_{\\mathrm{exp}} \\exp\\left(-\\frac{t}{3 \\tau_{\\mathrm{exp}}}\\right) \\right]_0^{t_{\\mathrm{end}}} = 3 \\tau_{\\mathrm{exp}} \\lambda_0 \\left(1 - \\exp\\left(-\\frac{t_{\\mathrm{end}}}{3 \\tau_{\\mathrm{exp}}}\\right)\\right) = 3 \\tau_{\\mathrm{exp}} \\lambda_0 \\left(1 - \\frac{T_{\\mathrm{thr}}}{T_0}\\right)\n$$\n这种简化形式在数值上是稳健的，并用于计算。\n\n**5. 计算最终中子分数 ($Y_n(t_{\\mathrm{end}})$)**\n利用积分速率 $I$，通过求解 $Y_n$ 的微分方程来找到最终中子分数：\n$$\nY_n(t_{\\mathrm{end}}) = Y_{n,0} \\exp(-Y_s \\cdot I)\n$$\n\n**6. 计算最终平均质量数 ($A_{\\mathrm{final}}$)**\n最终平均质量数是初始种子核质量数 $A_{\\mathrm{seed}}$，加上每个种子核平均俘获的中子数。被俘获的中子总数分数为 $Y_{n,0} - Y_n(t_{\\mathrm{end}})$。将这些中子分配到 $Y_s$ 个种子核上，得到：\n$$\nA_{\\mathrm{final}} = A_{\\mathrm{seed}} + \\frac{Y_{n,0} - Y_n(t_{\\mathrm{end}})}{Y_s}\n$$\n此表达式仅在 $Y_s > \\epsilon$ 时有效。\n\n**7. 应用上限**\n为了考虑像裂变这样未包含在此简单模型中但会限制重核增长的物理过程，最终质量数被限制在 $A_{\\mathrm{cap}} = 250$：\n$$\nA_{\\mathrm{final}} \\leftarrow \\min(A_{\\mathrm{final}}, A_{\\mathrm{cap}})\n$$\n这样就完成了一个测试用例的计算。对所有提供的用例重复此过程。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the final average mass number for r-process nucleosynthesis\n    in a simplified one-zone model for several test cases.\n    \"\"\"\n\n    # Define the constants from the problem statement.\n    S0 = 10.0           # Reference entropy in units of k_B\n    k_seed = 0.01       # Dimensionless seed formation scaling constant\n    epsilon = 1e-12     # Small threshold for seed fraction\n    A_cap = 250.0       # Maximum plausible final mass number\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (Ye, S, tau_exp, rho0, T0, T_thr, lambda0, A_seed)\n    # rho0 is not used in the calculation.\n    test_cases = [\n        (0.05, 10.0, 0.005, 1e11, 6.0, 1.0, 10000.0, 90.0),\n        (0.25, 30.0, 0.05, 1e10, 6.0, 1.5, 5000.0, 90.0),\n        (0.45, 20.0, 0.02, 5e10, 5.0, 1.2, 3000.0, 90.0),\n        (0.20, 100.0, 0.01, 1e11, 6.0, 1.0, 8000.0, 90.0),\n        (0.10, 20.0, 0.01, 1e11, 1.0, 1.0, 5000.0, 90.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        Ye, S, tau_exp, _, T0, T_thr, lambda0, A_seed = case\n\n        # Step 1: Calculate the initial seed number fraction, Y_s.\n        # This parameterization models seed suppression at high entropy (S)\n        # and preference for neutron-rich conditions (low Ye).\n        Ys = k_seed * np.max([0.0, 0.5 - Ye]) / (S / S0)\n\n        # Step 2: Handle cases with negligible seeds.\n        if Ys = epsilon:\n            A_final = 0.0\n            results.append(A_final)\n            continue\n\n        # Step 3: Calculate the initial neutron number fraction, Yn0.\n        # This is the baryon budget available for neutron capture.\n        Yn0 = np.max([0.0, 1.0 - Ye - A_seed * Ys])\n        \n        # If there are no initial neutrons, no captures can occur.\n        if Yn0 = 0.0:\n            A_final = A_seed\n            results.append(A_final)\n            continue\n            \n        # Step 4: Determine the duration of the neutron capture phase.\n        # If T0 = T_thr, no capture occurs.\n        if T0 = T_thr:\n            A_final = A_seed\n        else:\n            # Step 5: Calculate the integrated reaction term, I.\n            # The simplified form I = 3 * tau_exp * lambda0 * (1 - T_thr / T0) is used.\n            # This follows directly from the given integral and temperature evolution.\n            integrated_rate_term = 3.0 * tau_exp * lambda0 * (1.0 - T_thr / T0)\n\n            # Step 6: Calculate the final neutron fraction, Yn(t_end).\n            # This is the solution to the mass-action capture law.\n            Yn_tend = Yn0 * np.exp(-Ys * integrated_rate_term)\n\n            # Step 7: Calculate the average final mass number.\n            # This distributes the captured neutrons (Yn0 - Yn_tend) over the seeds (Ys).\n            A_final = A_seed + (Yn0 - Yn_tend) / Ys\n\n        # Step 8: Apply the upper cap to the final mass number.\n        # This enforces a physical limit not captured by the simple model (e.g., fission).\n        A_final = np.min([A_final, A_cap])\n        results.append(A_final)\n\n    # Final print statement in the exact required format.\n    # The output is a comma-separated list of floats rounded to three decimal places,\n    # enclosed in square brackets.\n    formatted_results = [f\"{r:.3f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}