{
    "hands_on_practices": [
        {
            "introduction": "本实践是一项基础的数值验证练习。您需要在一个引力波时空中直接对两条相邻的测地线进行积分，并将其真实分离与描述分离矢量 $\\xi^\\mu$ 演化的线性化测地线偏离方程的预测进行比较。这项练习将巩固您对测地线偏离方程的理解，即它是描述邻近物体相对运动的一种强大而精确的近似方法 。",
            "id": "3492025",
            "problem": "必须编写一个程序，对以 Brinkmann 坐标表示的平面引力波时空，进行测地线方程和测地偏离方程的数值积分。时空线元为\n$$\nds^2 = -2\\,du\\,dv + dx^2 + dy^2 + g_{uu}(u,x,y)\\,du^2,\n$$\n其中\n$$\ng_{uu}(u,x,y) = H(u)\\,(x^2 - y^2).\n$$\n此处 $u$ 是沿零测地线的仿射参数，$v$ 是共轭零坐标，$(x,y)$ 是横向空间坐标。平面波的波形由以下函数指定\n$$\nH(u) = A\\,\\exp\\!\\left(-\\frac{(u-u_0)^2}{2\\,\\sigma^2}\\right)\\,\\cos\\!\\left(\\omega\\,(u-u_0)\\right),\n$$\n其中 $A$ 是振幅，$\\omega$ 是角频率，$\\sigma$ 是高斯包络的宽度，$u_0$ 是脉冲中心。角度必须以弧度为单位。\n\n从以下基本出发点开始：\n- 测地线方程，\n$$\n\\frac{d^2 x^\\mu}{d\\lambda^2} + \\Gamma^\\mu_{\\ \\alpha\\beta}\\,\\frac{d x^\\alpha}{d\\lambda}\\,\\frac{d x^\\beta}{d\\lambda} = 0,\n$$\n- 以度规 $g_{\\mu\\nu}$ 定义的 Christoffel 符号，\n$$\n\\Gamma^\\mu_{\\ \\alpha\\beta} = \\frac{1}{2} g^{\\mu\\gamma}\\left( \\partial_\\alpha g_{\\beta\\gamma} + \\partial_\\beta g_{\\alpha\\gamma} - \\partial_\\gamma g_{\\alpha\\beta} \\right),\n$$\n- 对于沿切向量为 $u^\\mu$ 的参考测地线的偏离矢量 $\\xi^\\mu$ 的测地偏离方程，\n$$\n\\frac{D^2 \\xi^\\mu}{d\\lambda^2} = - R^\\mu_{\\ \\nu\\rho\\sigma}\\,u^\\nu\\,\\xi^\\rho\\,u^\\sigma,\n$$\n当选择仿射参数 $\\lambda$ 等于 $u$ 时，推导测地线横向坐标 $x(u)$ 和 $y(u)$ 的常微分方程 (ODE)，并推导沿同一参考测地线的偏离矢量横向分量 $\\xi^x(u)$ 和 $\\xi^y(u)$ 的常微分方程。所有量均为无量纲量，不涉及物理单位。\n\n用 Python 实现一个数值求解器，该求解器：\n1. 积分一条参考测地线，初始条件为\n$$\nu_{\\mathrm{start}} = 0,\\quad u_{\\mathrm{end}} = 2,\\quad x(0) = x_0,\\quad y(0) = y_0,\\quad \\frac{dx}{du}(0) = v_{x0},\\quad \\frac{dy}{du}(0) = v_{y0}.\n$$\n2. 积分一条相邻测地线，初始条件为\n$$\nx(0) = x_0 + \\delta x_0,\\quad y(0) = y_0 + \\delta y_0,\\quad \\frac{dx}{du}(0) = v_{x0},\\quad \\frac{dy}{du}(0) = v_{y0}.\n$$\n3. 积分横向偏离矢量的测地偏离方程，初始条件为\n$$\n\\xi^x(0) = \\delta x_0,\\quad \\xi^y(0) = \\delta y_0,\\quad \\frac{d\\xi^x}{du}(0) = 0,\\quad \\frac{d\\xi^y}{du}(0) = 0.\n$$\n\n对于所有测试用例，使用共同的初始值\n$$\nx_0 = 0.1,\\quad y_0 = 0.05,\\quad v_{x0} = 0,\\quad v_{y0} = 0,\\quad \\delta x_0 = 10^{-4},\\quad \\delta y_0 = -2\\times 10^{-4}.\n$$\n\n对每个测试用例，在积分到 $u_{\\mathrm{end}}$ 后，计算两条测地线的实际分离矢量与测地偏离方程预测的偏离矢量之差的欧几里得范数，\n$$\n\\varepsilon = \\sqrt{\\left[(x_{\\mathrm{nbr}} - x_{\\mathrm{ref}}) - \\xi^x\\right]^2 + \\left[(y_{\\mathrm{nbr}} - y_{\\mathrm{ref}}) - \\xi^y\\right]^2}\\Bigg|_{u=u_{\\mathrm{end}}},\n$$\n并将 $\\varepsilon$ 以浮点数形式报告。\n\n测试套件：\n- 案例 1：$A = 0.2$, $\\omega = 6$, $\\sigma = 0.3$, $u_0 = 1.0$。\n- 案例 2：$A = 0$, $\\omega = 6$, $\\sigma = 0.3$, $u_0 = 1.0$。\n- 案例 3：$A = 0.1$, $\\omega = 30$, $\\sigma = 0.2$, $u_0 = 1.0$。\n- 案例 4：$A = 0.5$, $\\omega = 10$, $\\sigma = 0.1$, $u_0 = 1.0$。\n\n您的程序应产生单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如 $[r_1,r_2,r_3,r_4]$），其中每个 $r_i$ 是为相应测试用例计算出的 $\\varepsilon$。角度必须按弧度处理。不允许外部输入，程序必须按原样运行。",
            "solution": "我们从广义相对论的基本几何框架开始。测地线 $x^\\mu(\\lambda)$ 使固有时程取极值，并满足测地线方程，\n$$\n\\frac{d^2 x^\\mu}{d\\lambda^2} + \\Gamma^\\mu_{\\ \\alpha\\beta}(x)\\,\\frac{d x^\\alpha}{d\\lambda}\\,\\frac{d x^\\beta}{d\\lambda} = 0,\n$$\n其中 $\\Gamma^\\mu_{\\ \\alpha\\beta}$ 是由度规 $g_{\\mu\\nu}$ 通过以下方式构造的 Christoffel 符号\n$$\n\\Gamma^\\mu_{\\ \\alpha\\beta} = \\frac{1}{2} g^{\\mu\\gamma}\\left( \\partial_\\alpha g_{\\beta\\gamma} + \\partial_\\beta g_{\\alpha\\gamma} - \\partial_\\gamma g_{\\alpha\\beta} \\right).\n$$\n相邻测地线的偏离由偏离矢量 $\\xi^\\mu$ 的测地偏离方程所控制，\n$$\n\\frac{D^2 \\xi^\\mu}{d\\lambda^2} = - R^\\mu_{\\ \\nu\\rho\\sigma}\\,u^\\nu\\,\\xi^\\rho\\,u^\\sigma,\n$$\n其中 $u^\\mu = \\frac{dx^\\mu}{d\\lambda}$ 是参考测地线的切向量，$R^\\mu_{\\ \\nu\\rho\\sigma}$ 是黎曼曲率张量。\n\n给定 Brinkmann 形式的平面波度规，\n$$\nds^2 = -2\\,du\\,dv + dx^2 + dy^2 + g_{uu}(u,x,y)\\,du^2, \\quad g_{uu}(u,x,y) = H(u)\\,(x^2 - y^2).\n$$\n非零的度规分量为 $g_{uv} = g_{vu} = -1$，$g_{xx} = 1$，$g_{yy} = 1$，以及 $g_{uu} = H(u)\\,(x^2 - y^2)$。$\\{u,v\\}$ 子空间中的逆度规是通过对 $2\\times 2$ 分块矩阵求逆得到的\n$$\n\\begin{pmatrix}\ng_{uu}  -1 \\\\\n-1  0\n\\end{pmatrix},\n$$\n这得到 $g^{uu} = 0$，$g^{uv} = g^{vu} = -1$，以及 $g^{vv} = -g_{uu}$。在横向方向上，$g^{xx} = 1$ 且 $g^{yy} = 1$。\n\n我们选择仿射参数 $\\lambda = u$，即我们用坐标 $u$ 来参数化测地线。这意味着 $\\frac{du}{d\\lambda} = 1$。横向坐标 $x$ 和 $y$ 的测地线方程简化为\n$$\n\\frac{d^2 x}{du^2} + \\Gamma^x_{\\ uu} = 0, \\qquad \\frac{d^2 y}{du^2} + \\Gamma^y_{\\ uu} = 0,\n$$\n因为唯一非零的二次速度项涉及对 $u$ 的导数。指标为 $(x;u,u)$ 和 $(y;u,u)$ 的 Christoffel 符号为\n$$\n\\Gamma^x_{\\ uu} = \\frac{1}{2} g^{x\\gamma}\\left( \\partial_u g_{u\\gamma} + \\partial_u g_{\\gamma u} - \\partial_\\gamma g_{uu} \\right) = -\\frac{1}{2}\\,\\partial_x g_{uu},\n$$\n$$\n\\Gamma^y_{\\ uu} = -\\frac{1}{2}\\,\\partial_y g_{uu},\n$$\n因为 $g_{u\\gamma}$ 与 $u$ 无关，且 $g^{x\\gamma}$ 选取 $\\gamma=x$，而 $g^{y\\gamma}$ 选取 $\\gamma=y$。根据 $g_{uu} = H(u)\\,(x^2 - y^2)$，\n$$\n\\partial_x g_{uu} = 2 H(u)\\,x, \\qquad \\partial_y g_{uu} = - 2 H(u)\\,y.\n$$\n因此，\n$$\n\\Gamma^x_{\\ uu} = - H(u)\\,x, \\qquad \\Gamma^y_{\\ uu} = + H(u)\\,y,\n$$\n横向测地线方程变为线性常微分方程\n$$\n\\frac{d^2 x}{du^2} = H(u)\\,x, \\qquad \\frac{d^2 y}{du^2} = - H(u)\\,y.\n$$\n这些是含时线性二阶常微分方程，类似于参数振子方程，在两个偏振方向上符号相反，这是平面引力波中加偏振的一个众所周知的潮汐特征。\n\n对于测地偏离方程，我们需要在 $u$ 方向上有两个指标的黎曼曲率分量。对于 Brinkmann 平面波，\n$$\nR_{uiuj} = -\\frac{1}{2}\\,\\partial_i \\partial_j g_{uu},\n$$\n其中 $i,j$ 遍历横向指标 $x,y$。使用 $g_{uu} = H(u)\\,(x^2 - y^2)$，我们发现\n$$\n\\partial_x \\partial_x g_{uu} = 2 H(u), \\quad \\partial_y \\partial_y g_{uu} = -2 H(u), \\quad \\partial_x \\partial_y g_{uu} = 0,\n$$\n因此\n$$\nR_{uxux} = - H(u), \\qquad R_{uyuy} = + H(u), \\qquad R_{uxuy} = R_{uyux} = 0.\n$$\n用 $g^{xx} = g^{yy} = 1$ 提升第一个横向指标，得到\n$$\nR^x_{\\ u x u} = R_{x u x u} = R_{uxux} = - H(u), \\qquad R^y_{\\ u y u} = R_{uyuy} = + H(u).\n$$\n采用测地偏离方程的标准符号约定，\n$$\n\\frac{D^2 \\xi^\\mu}{d\\lambda^2} = - R^\\mu_{\\ \\nu\\rho\\sigma}\\,u^\\nu\\,\\xi^\\rho\\,u^\\sigma,\n$$\n并在我们的参数化中取 $u^\\mu$ 只有 $u$ 分量等于 $1$，则偏离方程的横向分量变为\n$$\n\\frac{d^2 \\xi^x}{du^2} = - R^x_{\\ u x u}\\,\\xi^x = + H(u)\\,\\xi^x,\n$$\n$$\n\\frac{d^2 \\xi^y}{du^2} = - R^y_{\\ u y u}\\,\\xi^y = - H(u)\\,\\xi^y.\n$$\n这些方程与横向测地线方程的线性化差分完全匹配，这是意料之中的，因为横向测地线方程在 $(x,y)$ 上是线性的。因此，对于两条具有微小初始分离和相等初始横向速度的相邻测地线，偏离矢量 $\\xi^i(u)$ 在所有 $u$ 处都等于实际分离矢量 $(x_{\\mathrm{nbr}}(u) - x_{\\mathrm{ref}}(u),\\,y_{\\mathrm{nbr}}(u) - y_{\\mathrm{ref}}(u))$，差异仅在于数值积分误差。\n\n算法设计：\n- 定义带有参数 $(A,\\omega,\\sigma,u_0)$ 的波形 $H(u)$：\n$$\nH(u) = A\\,\\exp\\!\\left(-\\frac{(u-u_0)^2}{2\\,\\sigma^2}\\right)\\,\\cos\\!\\left(\\omega\\,(u-u_0)\\right),\n$$\n角度以弧度为单位。\n- 实现状态矢量 $\\mathbf{s} = (x, v_x, y, v_y)$ 的横向测地线 ODE 系统，\n$$\n\\frac{d}{du}\\begin{pmatrix} x \\\\ v_x \\\\ y \\\\ v_y \\end{pmatrix} =\n\\begin{pmatrix}\nv_x \\\\ H(u)\\,x \\\\ v_y \\\\ - H(u)\\,y\n\\end{pmatrix}.\n$$\n- 实现横向测地偏离 ODE，其状态矢量为 $\\boldsymbol{\\xi} = (\\xi^x, \\dot{\\xi}^x, \\xi^y, \\dot{\\xi}^y)$，\n$$\n\\frac{d}{du}\\begin{pmatrix} \\xi^x \\\\ \\dot{\\xi}^x \\\\ \\xi^y \\\\ \\dot{\\xi}^y \\end{pmatrix} =\n\\begin{pmatrix}\n\\dot{\\xi}^x \\\\ H(u)\\,\\xi^x \\\\ \\dot{\\xi}^y \\\\ - H(u)\\,\\xi^y\n\\end{pmatrix}.\n$$\n- 使用高精度显式求解器，在 $u \\in [u_{\\mathrm{start}}, u_{\\mathrm{end}}]$ 区间上积分参考测地线、相邻测地线（初始位置移动了 $(\\delta x_0,\\delta y_0)$，初始速度相同）和初始时间导数为零的偏离矢量。\n- 在 $u = u_{\\mathrm{end}}$ 处，计算误差范数\n$$\n\\varepsilon = \\left\\| \\left( x_{\\mathrm{nbr}} - x_{\\mathrm{ref}} - \\xi^x,\\, y_{\\mathrm{nbr}} - y_{\\mathrm{ref}} - \\xi^y \\right) \\right\\|.\n$$\n- 对每个测试用例重复此过程，并以单行形式输出列表 $[\\varepsilon_1,\\varepsilon_2,\\varepsilon_3,\\varepsilon_4]$。\n\n数值考虑：\n- 横向系统是线性的，但可能表现出参数放大（对于沿 $x$ 方向的 $H(u) > 0$），对于适中的 $A$ 和有限支撑的 $\\sigma$，该过程是数值稳定的。\n- 使用高阶非刚性积分器（如显式8阶方法）和严格的容差，以确保数值误差远小于物理效应的量级；将相对和绝对容差设置为较小的值，以便高保真地比较偏离和实际分离。\n- 在计算余弦时，角度必须按弧度处理。\n\n该设计确保了科学真实性，以及从度规到 Christoffel 符号、测地线方程和测地偏离方程的有原则的推导，并定义了清晰、可测试的数值输出。",
            "answer": "```python\n# Numerical integration of geodesics and geodesic deviation in a Brinkmann plane wave spacetime\n# Environment: Python 3.12, numpy 1.23.5, scipy 1.11.4\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef H_profile(u, A, omega, sigma, u0):\n    \"\"\"Plane wave profile H(u) = A * exp(-((u-u0)^2)/(2*sigma^2)) * cos(omega*(u-u0)).\n    Angles in radians.\"\"\"\n    return A * np.exp(-((u - u0) ** 2) / (2.0 * sigma ** 2)) * np.cos(omega * (u - u0))\n\ndef geodesic_rhs(u, state, A, omega, sigma, u0):\n    \"\"\"RHS for transverse geodesic equations in Brinkmann coordinates.\n    state = [x, vx, y, vy]; dots are derivatives w.r.t. u.\"\"\"\n    x, vx, y, vy = state\n    Hu = H_profile(u, A, omega, sigma, u0)\n    dxdu = vx\n    dvxdu = Hu * x\n    dydu = vy\n    dvydu = -Hu * y\n    return [dxdu, dvxdu, dydu, dvydu]\n\ndef deviation_rhs(u, xi_state, A, omega, sigma, u0):\n    \"\"\"RHS for geodesic deviation equations in transverse directions.\n    xi_state = [xi_x, dxi_x, xi_y, dxi_y].\"\"\"\n    xi_x, dxi_x, xi_y, dxi_y = xi_state\n    Hu = H_profile(u, A, omega, sigma, u0)\n    dxi_x_du = dxi_x\n    ddxi_x_du = Hu * xi_x\n    dxi_y_du = dxi_y\n    ddxi_y_du = -Hu * xi_y\n    return [dxi_x_du, ddxi_x_du, dxi_y_du, ddxi_y_du]\n\ndef integrate_case(params, u_start, u_end, x0, y0, vx0, vy0, dx0, dy0):\n    \"\"\"Integrate reference geodesic, neighbor geodesic, and deviation vector; return final error norm.\"\"\"\n    A, omega, sigma, u0 = params\n\n    # Initial states\n    ref_init = [x0, vx0, y0, vy0]\n    nbr_init = [x0 + dx0, vx0, y0 + dy0, vy0]\n    xi_init = [dx0, 0.0, dy0, 0.0]\n\n    # Integration tolerances and method\n    method = 'DOP853'\n    rtol = 1e-12\n    atol = 1e-15\n\n    # Integrate reference geodesic\n    sol_ref = solve_ivp(\n        geodesic_rhs, (u_start, u_end), ref_init,\n        args=(A, omega, sigma, u0), method=method, rtol=rtol, atol=atol\n    )\n    # Integrate neighbor geodesic\n    sol_nbr = solve_ivp(\n        geodesic_rhs, (u_start, u_end), nbr_init,\n        args=(A, omega, sigma, u0), method=method, rtol=rtol, atol=atol\n    )\n    # Integrate deviation\n    sol_xi = solve_ivp(\n        deviation_rhs, (u_start, u_end), xi_init,\n        args=(A, omega, sigma, u0), method=method, rtol=rtol, atol=atol\n    )\n\n    # Extract final values at u_end\n    x_ref, y_ref = sol_ref.y[0, -1], sol_ref.y[2, -1]\n    x_nbr, y_nbr = sol_nbr.y[0, -1], sol_nbr.y[2, -1]\n    xi_x, xi_y = sol_xi.y[0, -1], sol_xi.y[2, -1]\n\n    # Compute error norm\n    err_x = (x_nbr - x_ref) - xi_x\n    err_y = (y_nbr - y_ref) - xi_y\n    err_norm = np.sqrt(err_x * err_x + err_y * err_y)\n    return float(err_norm)\n\ndef solve():\n    # Common initial conditions\n    u_start = 0.0\n    u_end = 2.0\n    x0 = 0.1\n    y0 = 0.05\n    vx0 = 0.0\n    vy0 = 0.0\n    dx0 = 1e-4\n    dy0 = -2e-4\n\n    # Test cases: (A, omega, sigma, u0)\n    test_cases = [\n        (0.2, 6.0, 0.3, 1.0),   # Case 1: moderate amplitude, moderate frequency\n        (0.0, 6.0, 0.3, 1.0),   # Case 2: zero amplitude (boundary case)\n        (0.1, 30.0, 0.2, 1.0),  # Case 3: high frequency\n        (0.5, 10.0, 0.1, 1.0),  # Case 4: short, strong pulse\n    ]\n\n    results = []\n    for params in test_cases:\n        err = integrate_case(params, u_start, u_end, x0, y0, vx0, vy0, dx0, dy0)\n        results.append(err)\n\n    # Final output in the exact required format\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        },
        {
            "introduction": "在验证了测地线偏离方程的有效性之后，本实践将深入探讨曲率的物理意义。通过分析黎曼张量电性部分 $E_{ij}$ 的特征值和特征向量，您将定量地描述引力潮汐力如何拉伸和压缩一组测试粒子。这项练习将抽象的数学分量与直观且可观测的引力效应直接联系起来 。",
            "id": "3492033",
            "problem": "您需要设计并实现一种数值方法，用于沿一条类时测地线构建与给定类时四维速度 $u^\\mu$ 正交的雅可比场，并将所得的偏移场投影到曲率电性部分的特征方向上。该方法必须基于第一性原理，并适用于广义相对论 (GR) 中物理上合理的引力波环境。目标是通过解释曲率张量电性部分的特征值谱来量化潮汐拉伸或压缩。所有计算都必须使用一致的单位表示，距离以米为单位，时间以秒为单位。角度必须以弧度指定。\n\n从以下基本基础开始：\n- 测地线偏移方程（也称为雅可比方程）：\n  $$\\frac{D^2 \\xi^\\mu}{D\\tau^2} = - R^\\mu{}_{\\nu\\alpha\\beta}\\,u^\\nu\\,\\xi^\\alpha\\,u^\\beta,$$\n  其中 $\\xi^\\mu$ 是偏移（雅可比）场， $u^\\mu$ 是参考类时测地线的四维速度， $R^\\mu{}_{\\nu\\alpha\\beta}$ 是黎曼曲率张量， $\\tau$ 是沿测地线的固有时。\n- 在参考测地线的瞬时局域静止参考系（费米标准参考系）中，对于 $u^\\mu=(1,0,0,0)$，任何与 $u^\\mu$ 正交的雅可比场的空间分量 $\\xi^i$ 满足\n  $$\\frac{d^2 \\xi^i}{d\\tau^2} + E^i{}_j(\\tau)\\,\\xi^j = 0,$$\n  其中 $E_{ij}(\\tau) = R_{i0j0}(\\tau)$ 是黎曼张量的电性部分。在真空中，这等于韦尔张量（韦尔曲率）$C_{i0j0}$ 的电性部分。\n- 对于一个沿 $z$ 方向传播的弱平面横向无迹引力波，局域静止参考系中的空间度规微扰 $h_{ij}^{\\text{TT}}(\\tau)$ 可取为\n  $$h_{ij}^{\\text{TT}}(\\tau) = h_+(\\tau)\\left(\\hat{x}_i \\hat{x}_j - \\hat{y}_i \\hat{y}_j\\right) + h_\\times(\\tau)\\left(\\hat{x}_i \\hat{y}_j + \\hat{y}_i \\hat{x}_j\\right),$$\n  其中 $h_+(\\tau)$ 和 $h_\\times(\\tau)$ 分别是“+”偏振和“×”偏振。在这种情况下，曲率和度规微扰之间一个经过充分检验的关系是\n  $$E_{ij}(\\tau) = -\\tfrac{1}{2}\\,\\frac{d^2}{d\\tau^2} h_{ij}^{\\text{TT}}(\\tau).$$\n\n您的程序必须：\n- 为具有以下特征的单色引力波构建 $E_{ij}(\\tau)$：\n  $$h_+(\\tau) = A_+ \\cos(\\omega \\tau), \\quad h_\\times(\\tau) = A_\\times \\cos(\\omega \\tau + \\phi),$$\n  其中 $A_+$ 和 $A_\\times$ 是无量纲振幅，$\\omega$ 是角频率（单位为 $\\text{rad}/\\text{s}$），$\\phi$ 是相位（单位为弧度）。根据上述关系，电性部分满足\n  $$E_{ij}(\\tau) = -\\tfrac{1}{2}\\,\\frac{d^2}{d\\tau^2} h_{ij}^{\\text{TT}}(\\tau).$$\n  确保 $E_{ij}(\\tau)$ 被构建为一个作用于空间矢量的对称、无迹的 $3\\times 3$ 矩阵。\n- 给定初始条件 $\\xi^i(0)$（单位为米，与 $u^\\mu$ 正交）和 $\\dot{\\xi}^i(0)$（单位为米/秒），对空间分量 $\\xi^i(\\tau)$ 的雅可比方程进行数值积分：\n  $$\\ddot{\\xi}^i(\\tau) + E^i{}_j(\\tau)\\,\\xi^j(\\tau) = 0$$\n  使用固有时 $\\tau$（单位为秒）。点号表示对 $\\tau$ 的导数。\n- 在最终固有时 $\\tau=T$（单位为秒）时，计算 $E_{ij}(T)$ 的特征值分解：\n  $$E_{ij}(T)\\,e^{(k)}_j = \\lambda_k\\,e^{(k)}_i,$$\n  其中 $e^{(k)}_i$ 是标准正交特征向量，$\\lambda_k$ 是实数特征值（单位为 $\\text{s}^{-2}$）。将特征值按升序排序，并使对应的特征向量与特征值保持一致的排序。\n- 将最终偏移矢量 $\\xi^i(T)$ 投影到特征基上：\n  $$p_k = e^{(k)}_i\\,\\xi^i(T),$$\n  使得 $p_k$ 是 $\\xi^i(T)$ 沿特征方向 $e^{(k)}_i$ 的分量。以米为单位报告每个 $p_k$。\n- 通过计算负特征值的数量来提供一个可解释的潮汐特征：\n  $$N_{\\text{stretch}} = \\#\\{k \\mid \\lambda_k  0\\},$$\n  其中负的 $\\lambda_k$ 表示沿 $e^{(k)}_i$ 的瞬时潮汐拉伸，而正的 $\\lambda_k$ 表示压缩。\n\n物理单位：\n- 所有距离以米报告，时间以秒报告，角频率以 $\\text{rad}/\\text{s}$ 报告，特征值以 $\\text{s}^{-2}$ 报告。角度必须以弧度提供。\n- 所有输出必须是数字；不要输出任何单位文本。\n\n测试套件：\n为以下4个测试用例实现您的程序。每个用例都指定为一个元组 $(\\omega, A_+, A_\\times, \\phi, T, \\xi^i(0), \\dot{\\xi}^i(0))$，单位和约定如上所述。\n\n- 用例1（正常路径，混合偏振）：\n  - $\\omega = 200.0$\n  - $A_+ = 1.2\\times 10^{-21}$\n  - $A_\\times = 0.8\\times 10^{-21}$\n  - $\\phi = 0.7$\n  - $T = 0.05$\n  - $\\xi^i(0) = [1000.0,\\, 500.0,\\, 0.0]$\n  - $\\dot{\\xi}^i(0) = [0.0,\\, 0.0,\\, 0.0]$\n- 用例2（边界情况，曲率为零）：\n  - $\\omega = 150.0$\n  - $A_+ = 0.0$\n  - $A_\\times = 0.0$\n  - $\\phi = 0.0$\n  - $T = 0.1$\n  - $\\xi^i(0) = [0.0,\\, 2.0,\\, 3.0]$\n  - $\\dot{\\xi}^i(0) = [0.0,\\, 0.1,\\, -0.2]$\n- 用例3（纯“+”偏振，对齐的初始分离）：\n  - $\\omega = 400.0$\n  - $A_+ = 2.0\\times 10^{-21}$\n  - $A_\\times = 0.0$\n  - $\\phi = 0.0$\n  - $T = 0.02$\n  - $\\xi^i(0) = [1.0,\\, 0.0,\\, 0.0]$\n  - $\\dot{\\xi}^i(0) = [0.0,\\, 0.0,\\, 0.0]$\n- 用例4（纯“×”偏振，旋转的特征方向）：\n  - $\\omega = 300.0$\n  - $A_+ = 0.0$\n  - $A_\\times = 1.0\\times 10^{-21}$\n  - $\\phi = \\pi/3$\n  - $T = 0.03$\n  - $\\xi^i(0) = [0.0,\\, 1.0,\\, 0.0]$\n  - $\\dot{\\xi}^i(0) = [0.0,\\, 0.0,\\, 0.0]$\n\n每个测试用例的必需输出：\n- 一个列表，包含3个排序后的特征值 $\\lambda_k(T)$（单位为 $\\text{s}^{-2}$）、3个投影 $p_k$（单位为米）以及整数 $N_{\\text{stretch}}$：\n  $$[\\lambda_1,\\,\\lambda_2,\\,\\lambda_3,\\,p_1,\\,p_2,\\,p_3,\\,N_{\\text{stretch}}].$$\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含所有4个测试用例的结果，格式为逗号分隔的 Python 风格列表的列表，例如：\n  $$\\texttt{[[\\lambda_1,\\lambda_2,\\lambda_3,p_1,p_2,p_3,N],[...],[...],[...]]}.$$\n- 不要打印任何附加文本。\n\n您的程序必须是自包含的，并且不得要求任何输入。它必须使用一个稳健的数值积分器。结果必须在使用标准双精度浮点运算时是可复现的。通过仅演化初始数据与 $u^\\mu$ 正交（即 $\\xi^0=0$）的空间分量 $\\xi^i(\\tau)$，确保雅可比场保持与 $u^\\mu$ 正交。数值构造应反映物理过程：特征值谱编码了瞬时潮汐压缩（正特征值）和拉伸（负特征值）。",
            "solution": "该问题要求在弱平面单色引力波存在的情况下，对检验质量的测地线偏移方程进行数值求解。目标是确定最终的偏移矢量，并将其投影到由黎曼张量电性部分表征的瞬时潮汐场的特征方向上。\n\n### 基于原理的设计\n\n该解决方案基于广义相对论的原理，特别是通过测地线偏移方程对潮汐力的描述。\n\n1.  **定义潮汐场 ($E_{ij}$):**\n    对于沿 z 方向传播的弱平面引力波，在横向无迹（TT）规范中，度规微扰由 $h_{ij}^{\\text{TT}}(\\tau)$ 给出。问题指定了单色波，其中微扰张量的非零分量为：\n    $$h_{11}^{\\text{TT}}(\\tau) = -h_{22}^{\\text{TT}}(\\tau) = h_+(\\tau) = A_+ \\cos(\\omega \\tau)$$\n    $$h_{12}^{\\text{TT}}(\\tau) = h_{21}^{\\text{TT}}(\\tau) = h_\\times(\\tau) = A_\\times \\cos(\\omega \\tau + \\phi)$$\n    分量 $h_{i3}^{\\text{TT}}$ 和 $h_{3i}^{\\text{TT}}$ 为零。以矩阵形式表示：\n    $$h_{ij}^{\\text{TT}}(\\tau) = \\begin{pmatrix} A_+ \\cos(\\omega \\tau)  A_\\times \\cos(\\omega \\tau + \\phi)  0 \\\\ A_\\times \\cos(\\omega \\tau + \\phi)  -A_+ \\cos(\\omega \\tau)  0 \\\\ 0  0  0 \\end{pmatrix}$$\n    黎曼张量的电性部分 $E_{ij}(\\tau)$ 描述了类时测地线上观察者局域静止参考系中的潮汐力，它与度规微扰的二阶时间导数相关：\n    $$E_{ij}(\\tau) = -\\frac{1}{2} \\frac{d^2}{d\\tau^2} h_{ij}^{\\text{TT}}(\\tau)$$\n    对 $h_{ij}^{\\text{TT}}(\\tau)$ 关于固有时 $\\tau$ 求二阶导数，我们得到：\n    $$\\frac{d^2}{d\\tau^2} h_+(\\tau) = -A_+ \\omega^2 \\cos(\\omega \\tau)$$\n    $$\\frac{d^2}{d\\tau^2} h_\\times(\\tau) = -A_\\times \\omega^2 \\cos(\\omega \\tau + \\phi)$$\n    将这些代入 $E_{ij}(\\tau)$ 的表达式中，我们得到潮汐张量的显式形式：\n    $$E_{ij}(\\tau) = \\frac{\\omega^2}{2} \\begin{pmatrix} A_+ \\cos(\\omega \\tau)  A_\\times \\cos(\\omega \\tau + \\phi)  0 \\\\ A_\\times \\cos(\\omega \\tau + \\phi)  -A_+ \\cos(\\omega \\tau)  0 \\\\ 0  0  0 \\end{pmatrix}$$\n    这个 $3 \\times 3$ 矩阵是对称的（$E_{ij}=E_{ji}$）且无迹的（$\\text{Tr}(E) = E_{11} + E_{22} + E_{33} = 0$），这与真空中引力波产生的潮汐力的性质一致。其单位为 $\\text{s}^{-2}$。\n\n2.  **测地线偏移方程的数值积分：**\n    在观察者的局域静止参考系中，其中 $u^\\mu = (1,0,0,0)$，空间分离矢量 $\\xi^i(\\tau)$ 的测地线偏移方程简化为：\n    $$\\frac{d^2 \\xi^i}{d\\tau^2} + E^i{}_j(\\tau)\\,\\xi^j(\\tau) = 0$$\n    由于我们处于一个局域标准正交系中，我们可以使用欧几里得度规来提升和降低空间指标，因此 $E^i{}_j(\\tau) = E_{ij}(\\tau)$。该方程变成一个包含三个耦合二阶线性常微分方程（ODEs）的系统：\n    $$\\ddot{\\vec{\\xi}}(\\tau) = -E(\\tau) \\vec{\\xi}(\\tau)$$\n    其中 $\\vec{\\xi}$ 是列向量 $(\\xi^1, \\xi^2, \\xi^3)^T$，$\\ddot{\\vec{\\xi}}$ 是其关于 $\\tau$ 的二阶导数，而 $E(\\tau)$ 是矩阵 $E_{ij}(\\tau)$。\n    为了进行数值求解，我们将该系统转换为一组六个一阶常微分方程。我们定义一个6维状态向量 $Y(\\tau)$：\n    $$Y(\\tau) = \\begin{pmatrix} \\vec{\\xi}(\\tau) \\\\ \\dot{\\vec{\\xi}}(\\tau) \\end{pmatrix} = \\begin{pmatrix} \\xi^1 \\\\ \\xi^2 \\\\ \\xi^3 \\\\ \\dot{\\xi}^1 \\\\ \\dot{\\xi}^2 \\\\ \\dot{\\xi}^3 \\end{pmatrix}$$\n    那么一阶系统为：\n    $$\\frac{dY}{d\\tau} = \\begin{pmatrix} \\dot{\\vec{\\xi}}(\\tau) \\\\ \\ddot{\\vec{\\xi}}(\\tau) \\end{pmatrix} = \\begin{pmatrix} \\dot{\\vec{\\xi}}(\\tau) \\\\ -E(\\tau) \\vec{\\xi}(\\tau) \\end{pmatrix} = \\begin{pmatrix} 0  I \\\\ -E(\\tau)  0 \\end{pmatrix} Y(\\tau)$$\n    其中 $I$ 是 $3 \\times 3$ 单位矩阵。该系统可以使用标准的数值常微分方程求解器（如 Runge-Kutta 方法）从 $\\tau=0$ 积分到 $\\tau=T$。积分需要偏移矢量 $\\vec{\\xi}(0)$ 及其速度 $\\dot{\\vec{\\xi}}(0)$ 的初始条件。`scipy.integrate.solve_ivp` 函数非常适合此任务。\n\n3.  **通过特征值分解进行物理解释：**\n    在最终时刻 $\\tau=T$，潮汐张量 $E_{ij}(T)$ 代表瞬时潮汐力。这些力的物理性质通过其特征值分解揭示出来：\n    $$E_{ij}(T) e^{(k)}_j = \\lambda_k e^{(k)}_i$$\n    三个实数特征值 $\\lambda_k$（单位为 $\\text{s}^{-2}$）及其对应的标准正交特征向量 $\\vec{e}^{(k)}$ 定义了潮汐场的主轴。\n    - 如果 $\\lambda_k > 0$，潮汐加速度 $\\ddot{\\xi}^i$ 在方向 $\\vec{e}^{(k)}$ 上有一个与 $\\xi^i$ 相反的分量，表示 **压缩**。\n    - 如果 $\\lambda_k  0$，潮汐加速度在方向 $\\vec{e}^{(k)}$ 上有一个与 $\\xi^i$ 相同的分量，表示 **拉伸**。\n    - 如果 $\\lambda_k = 0$，则沿该主轴没有潮汐力。\n    负特征值的数量 $N_{\\text{stretch}}$ 提供了瞬时拉伸方向的直接计数。我们使用 `numpy.linalg.eigh` 进行特征值分解，该函数针对对称矩阵进行了优化，并返回排序后的实数特征值及其对应的标准正交特征向量。\n\n4.  **向特征方向投影：**\n    为了量化最终偏移矢量 $\\vec{\\xi}(T)$ 在那一刻与潮汐场主轴的对齐程度，我们将 $\\vec{\\xi}(T)$ 投影到标准正交特征基 $\\{\\vec{e}^{(k)}\\}$ 上：\n    $$p_k = \\vec{e}^{(k)} \\cdot \\vec{\\xi}(T) = e^{(k)}_i \\xi^i(T)$$\n    所得的标量 $p_k$（单位为米）是最终偏移矢量沿每个主轴的分量。\n\n### 实现摘要\n程序遍历每个测试用例。对于每个用例：\n1.  它根据给定的引力波参数定义矩阵 $E_{ij}(\\tau)$ 的函数。\n2.  它为6维状态向量 $Y(\\tau)$ 建立一阶常微分方程系统。\n3.  它使用 `scipy.integrate.solve_ivp`，利用提供的初始条件 $\\vec{\\xi}(0)$ 和 $\\dot{\\vec{\\xi}}(0)$，将系统从 $\\tau=0$ 积分到 $\\tau=T$。对于零振幅波的特殊情况进行解析处理，以避免不必要的数值计算。\n4.  在 $\\tau=T$ 时，它计算矩阵 $E_{ij}(T)$ 并执行特征值分解，以找到排序后的特征值 $\\lambda_k$ 和特征向量 $\\vec{e}^{(k)}$。\n5.  它计算最终偏移矢量 $\\vec{\\xi}(T)$ 在特征向量上的投影 $p_k$。\n6.  它计算负特征值的数量 $N_{\\text{stretch}}$。\n7.  每个用例的结果 $[\\lambda_1, \\lambda_2, \\lambda_3, p_1, p_2, p_3, N_{\\text{stretch}}]$ 被收集并以指定的列表的列表格式打印。\n所有单位均按规定处理：时间以秒 ($s$) 为单位，距离以米 ($m$) 为单位，频率以弧度/秒 ($\\text{rad/s}$) 为单位。",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Solves the geodesic deviation problem for given gravitational wave parameters.\n    \"\"\"\n    \n    # Test cases: (omega, A_plus, A_cross, phi, T, xi0, xi_dot0)\n    test_cases = [\n        # Case 1\n        (200.0, 1.2e-21, 0.8e-21, 0.7, 0.05, [1000.0, 500.0, 0.0], [0.0, 0.0, 0.0]),\n        # Case 2\n        (150.0, 0.0, 0.0, 0.0, 0.1, [0.0, 2.0, 3.0], [0.0, 0.1, -0.2]),\n        # Case 3\n        (400.0, 2.0e-21, 0.0, 0.0, 0.02, [1.0, 0.0, 0.0], [0.0, 0.0, 0.0]),\n        # Case 4\n        (300.0, 0.0, 1.0e-21, np.pi/3, 0.03, [0.0, 1.0, 0.0], [0.0, 0.0, 0.0])\n    ]\n\n    results = []\n\n    for case in test_cases:\n        omega, A_plus, A_cross, phi, T, xi0_list, xi_dot0_list = case\n        \n        xi0 = np.array(xi0_list, dtype=np.float64)\n        xi_dot0 = np.array(xi_dot0_list, dtype=np.float64)\n\n        def get_E(tau, w, Ap, Ac, p):\n            \"\"\"Computes the electric part of the Riemann tensor E_ij.\"\"\"\n            cos_plus = np.cos(w * tau)\n            cos_cross = np.cos(w * tau + p)\n            \n            c1 = Ap * cos_plus\n            c2 = Ac * cos_cross\n            \n            E = (w**2 / 2.0) * np.array([\n                [c1, c2, 0.0],\n                [c2, -c1, 0.0],\n                [0.0, 0.0, 0.0]\n            ], dtype=np.float64)\n            return E\n\n        # Handle the trivial case (no gravitational wave) analytically\n        if A_plus == 0.0 and A_cross == 0.0:\n            # E_ij is always zero, so d^2(xi)/dtau^2 = 0\n            # xi(T) = xi(0) + xi_dot(0) * T\n            xi_T = xi0 + xi_dot0 * T\n            E_T = np.zeros((3, 3), dtype=np.float64)\n        else:\n            def ode_system(tau, y):\n                \"\"\"Defines the 6D first-order ODE system for geodesic deviation.\"\"\"\n                # y = [xi_x, xi_y, xi_z, v_x, v_y, v_z]\n                xi = y[0:3]\n                d_xi_dt = y[3:6]\n                \n                E_matrix = get_E(tau, omega, A_plus, A_cross, phi)\n                d_v_dt = -E_matrix @ xi\n                \n                return np.concatenate((d_xi_dt, d_v_dt))\n\n            # Set up initial conditions for the 6D state vector\n            y0 = np.concatenate((xi0, xi_dot0))\n\n            # Numerically integrate the ODE system\n            sol = solve_ivp(\n                ode_system,\n                [0, T],\n                y0,\n                t_eval=[T],\n                method='RK45', \n                rtol=1e-12,\n                atol=1e-12\n            )\n            \n            # Extract final state\n            y_final = sol.y[:, -1]\n            xi_T = y_final[0:3]\n            \n            # Compute E_ij at the final time T\n            E_T = get_E(T, omega, A_plus, A_cross, phi)\n\n        # Eigenvalue decomposition of E_ij(T)\n        # np.linalg.eigh returns eigenvalues in ascending order for symmetric matrices\n        lambdas, e_vecs = np.linalg.eigh(E_T)\n\n        # Project final deviation vector xi(T) onto the eigenbasis\n        # e_vecs are columns, so e_vecs.T @ xi_T gives the projections\n        projections = e_vecs.T @ xi_T\n        \n        # Count the number of negative eigenvalues (stretching directions)\n        n_stretch = np.sum(lambdas  0)\n\n        # Assemble results for the current case\n        case_result = lambdas.tolist() + projections.tolist() + [int(n_stretch)]\n        results.append(case_result)\n\n    # Format output as a Python-style list of lists string\n    output_str_parts = []\n    for res_list in results:\n        list_str = \"[\" + \",\".join(map(str, res_list)) + \"]\"\n        output_str_parts.append(list_str)\n        \n    final_output = \"[\" + \",\".join(output_str_parts) + \"]\"\n    print(final_output)\n\nsolve()\n```"
        },
        {
            "introduction": "最后的实践将我们的理解置于更广阔的背景中，通过对比广义相对论和牛顿引力的预测。您将为相对论和牛顿潮汐力在各种物理情景下建立模型，从而确定两种理论在何处吻合，以及更重要的，在何处出现分歧，例如在引力波的情况下。这种对比分析对于领会广义相对论的独特预测至关重要 。",
            "id": "3492002",
            "problem": "要求您设计并实现一个程序，在与数值相对论（NR）相关的弱场情况下，比较由外尔张量的电性部分驱动的测地线偏差方程与由标量引力势的黑塞矩阵驱动的牛顿潮汐近似所预测的分离演化。该比较必须通过潮汐矩阵 $E_{ij}(t)$ 的范数以及预测的分离向量 $\\xi^i(t)$ 随时间的偏差来量化。您的程序必须为一套小型的物理上一致的场景测试套件生成结果，并将它们聚合为单一指定的输出格式。\n\n从以下基本定义和定律开始：\n\n- 对于切向量为 $u^\\mu$、分离向量为 $\\xi^\\mu$ 的类时测地线汇，其测地线偏差方程为\n$$\n\\frac{D^2 \\xi^\\mu}{d\\tau^2} = - R^\\mu{}_{\\alpha\\beta\\gamma}\\,u^\\alpha\\,\\xi^\\beta\\,u^\\gamma,\n$$\n其中 $R^\\mu{}_{\\alpha\\beta\\gamma}$ 是黎曼曲率张量，$\\tau$ 是固有时。在一个适用于静态观测者的局部标准正交系中，其中 $u^\\mu = (1,0,0,0)$ 并且在弱场近似的主导阶下 $\\tau$ 与坐标时 $t$ 一致，空间分量满足\n$$\n\\frac{d^2 \\xi^i}{dt^2} = - E^i{}_{\\,j}(t)\\,\\xi^j,\n$$\n其中 $E_{ij}(t) = R_{i0j0}(t)$ 是外尔张量的电性部分。\n\n- 在牛顿引力中，标量引力势 $\\Phi(\\mathbf{x}, t)$ 通过其空间黑塞矩阵决定潮汐加速度，\n$$\n\\frac{d^2 \\xi^i}{dt^2} = - \\partial_i \\partial_j \\Phi(\\mathbf{x}, t)\\,\\xi^j,\n$$\n该矩阵沿着参考世界线求值。在一个由半径 $r$ 处的点质量 $M$ 产生的静态、球对称弱场构型中，局部潮汐矩阵等于\n$$\nT_{ij} = \\partial_i \\partial_j \\Phi = \\mathrm{diag}\\!\\left( \\frac{2GM}{r^3}, -\\frac{GM}{r^3}, -\\frac{GM}{r^3} \\right),\n$$\n在一个x轴为径向的标准正交三轴架中。这里 $G$ 是牛顿引力常数。\n\n- 对于一个在横向无迹（TT）规范下沿z方向传播、具有+偏振应变 $h_+(t) = h_0 \\cos(\\omega t)$ 的平面线性偏振引力波，电性部分的非零分量为\n$$\nE_{xx}(t) = -\\frac{1}{2}\\ddot{h}_+(t) = \\frac{1}{2} h_0 \\omega^2 \\cos(\\omega t),\\quad E_{yy}(t) = -E_{xx}(t),\\quad E_{zz}(t)=0,\n$$\n且所有非对角分量在主导阶下为零。\n\n您的程序必须：\n\n1. 实现通用系统\n$$\n\\frac{d}{dt}\\begin{pmatrix} \\xi^i \\\\ v^i \\end{pmatrix} =\n\\begin{pmatrix}\nv^i \\\\\n- E^i{}_{\\,j}(t)\\,\\xi^j\n\\end{pmatrix},\n$$\n用于广义相对论（GR）的预测，其中 $v^i = d\\xi^i/dt$，以及使用 $T_{ij}(t) = \\partial_i \\partial_j \\Phi(\\mathbf{x}, t)$ 代替 $E_{ij}(t)$ 的相应牛顿理论预测。\n\n2. 对于测试套件中的每个场景，使用相同的初始条件，在指定的时间间隔内对两个系统进行积分。使用国际单位制（SI单位）：位置单位为米（m），时间单位为秒（s），质量单位为千克（kg），角频率单位为弧度/秒（rad/s）。角度和角频率必须以弧度处理。\n\n3. 通过计算以下量来量化比较：\n   - GR潮汐矩阵的Frobenius范数随时间的上确界，\n     $$\n     \\|E(t)\\|_F = \\sqrt{\\sum_{i,j} E_{ij}^2(t)},\\qquad \\|E\\|_{F,\\max} = \\sup_{t \\in [0,T]} \\|E(t)\\|_F.\n     $$\n   - 最终时刻的相对偏差，\n     $$\n     \\delta_{\\mathrm{final}} = \\frac{\\|\\xi_{\\mathrm{GR}}(T) - \\xi_{\\mathrm{Newt}}(T)\\|_2}{\\max\\big(\\|\\xi_{\\mathrm{GR}}(T)\\|_2,\\,\\epsilon_{\\mathrm{floor}}\\big)},\n     $$\n     其中 $\\|\\cdot\\|_2$ 是欧几里得范数，$T$ 是最终时间，$\\epsilon_{\\mathrm{floor}}$ 是一个小的正数以防止除以零。\n   - 失效时间 $t_{\\mathrm{break}}$，定义为最早满足以下条件的 $t \\in [0,T]$：\n     $$\n     \\|\\xi_{\\mathrm{GR}}(t) - \\xi_{\\mathrm{Newt}}(t)\\|_2 \\ge \\varepsilon\\,\\|\\xi_{\\mathrm{GR}}(t)\\|_2,\n     $$\n     其中无量纲容差 $\\varepsilon$ 在下面指定。如果此条件从未满足，则报告 $t_{\\mathrm{break}}$ 为 $-1.0$。\n\n4. 为每个测试案例生成一个结果列表，其中包含 $[\\|E\\|_{F,\\max},\\,\\delta_{\\mathrm{final}},\\,t_{\\mathrm{break}}]$（在适用时使用SI单位），并将每个案例的列表聚合为单行输出，形式为用方括号括起来的逗号分隔列表。\n\n使用以下测试套件，旨在探测不同方面，包括静态弱场中的一致性、波主导真空中的失效情况以及边界情况：\n\n- 案例A（静态点质量，理想路径）：位于点质量 $M = 5.0\\times 10^{30}$ kg 外部，固定半径 $r = 2.0\\times 10^{8}$ m 处的弱场区域。取径向沿x轴的局部标准正交系，因此\n$$\nE_{ij} = \\mathrm{diag}\\!\\left( \\frac{2GM}{r^3}, -\\frac{GM}{r^3}, -\\frac{GM}{r^3} \\right),\\quad T_{ij} = E_{ij}.\n$$\n从初始分离 $\\xi(0) = (1.0,\\,0.5,\\,0.0)$ m 和初始相对速度 $v(0) = (0.0,\\,0.0,\\,0.0)$ m/s 开始，积分 $T = 1.0$ s。\n\n- 案例B（平面引力波+偏振，真空中的失效情况）：一个单色平面引力波，+偏振振幅为 $h_0 = 1.0\\times 10^{-18}$，角频率为 $\\omega = 6.28\\times 10^{2}$ rad/s，因此\n$$\nE_{xx}(t)=\\tfrac{1}{2} h_0 \\omega^2 \\cos(\\omega t),\\quad E_{yy}(t)=-E_{xx}(t),\\quad E_{zz}(t)=0.\n$$\n局部真空中没有牛顿物质源，因此取 $\\Phi = 0$ 和 $T_{ij}(t) = 0$。从 $\\xi(0) = (1.0,\\,0.0,\\,0.0)$ m 和 $v(0) = (0.0,\\,0.0,\\,0.0)$ m/s 开始，积分 $T = 1.0\\times 10^{3}$ s。\n\n- 案例C（引力波，对齐的分离，边界情况）：与案例B具有相同的 $h_0$ 和 $\\omega$，但初始分离与传播方向对齐，其中 $E_{zz}(t) = 0$，即 $\\xi(0) = (0.0,\\,0.0,\\,1.0)$ m 和 $v(0) = (0.0,\\,0.0,\\,0.0)$ m/s。使用 $T_{ij}(t)=0$ 积分 $T = 1.0\\times 10^{3}$ s。\n\n- 案例D（零场，边界条件）：没有曲率，也没有牛顿潮汐场，$E_{ij}(t)=0$ 且 $T_{ij}(t)=0$ 对所有 $t$ 成立。从 $\\xi(0) = (1.0,\\,1.0,\\,1.0)$ m 和 $v(0) = (0.0,\\,0.0,\\,0.0)$ m/s 开始，积分 $T = 1.0\\times 10^{1}$ s。\n\n使用常数 $G = 6.674\\times 10^{-11}$ m$^3$ kg$^{-1}$ s$^{-2}$，并将失效容差设为 $\\varepsilon = 1.0\\times 10^{-6}$。为 $\\delta_{\\mathrm{final}}$ 的分母选择一个小的下限值 $\\epsilon_{\\mathrm{floor}} = 1.0\\times 10^{-15}$ m。\n\n您的程序应生成单行输出，其中包含每个案例的结果，形式为由方括号括起来的、由逗号分隔的三元素列表，例如 $[[a,b,c],[d,e,f],\\dots]$，其中每个元素 $a,b,c,\\dots$ 是一个浮点数（在适用时使用SI单位）。",
            "solution": "该问题要求比较两种不同物理理论——弱场极限下的广义相对论（GR）和牛顿引力——预测的两个邻近测地线之间分离向量 $\\xi^i(t)$ 的演化。该比较需要对一套四个不同的物理场景进行数值计算。\n\n其基本原理是对二阶常微分方程（ODE）组进行数值积分。对于这两种理论，控制方程的形式均为：\n$$\n\\frac{d^2 \\xi^i}{dt^2} = - K^i{}_{\\,j}(t)\\,\\xi^j\n$$\n其中 $K_{ij}(t)$ 是一个 $3 \\times 3$ 的时变潮汐矩阵。对于GR的预测，这个矩阵是外尔张量的电性部分，$K_{ij}(t) = E_{ij}(t) = R_{i0j0}(t)$。对于牛顿理论的预测，它是引力势的黑塞矩阵，$K_{ij}(t) = T_{ij}(t) = \\partial_i\\partial_j\\Phi$。\n\n为了数值求解该系统，我们首先将二阶ODE转换为一阶ODE系统。我们定义一个由分离向量 $\\xi^i(t)$ 及其一阶时间导数（相对速度 $v^i(t) = d\\xi^i/dt$）组成的状态向量 $y(t)$。对于一个三维空间问题，状态向量是一个六分量向量：\n$$\ny(t) = \\begin{pmatrix} \\xi^1(t) \\\\ \\xi^2(t) \\\\ \\xi^3(t) \\\\ v^1(t) \\\\ v^2(t) \\\\ v^3(t) \\end{pmatrix}\n$$\n一阶系统则由下式给出：\n$$\n\\frac{d}{dt}y(t) = \\frac{d}{dt}\\begin{pmatrix} \\xi^i \\\\ v^i \\end{pmatrix} = \\begin{pmatrix} v^i \\\\ -K^i{}_{\\,j}(t)\\,\\xi^j \\end{pmatrix} = F(t, y(t))\n$$\n该系统可以从一组初始条件 $y(0) = (\\xi^i(0), v^i(0))^T$ 开始，在时间区间 $[0, T]$ 上使用标准的数值ODE求解器进行积分。实现将使用 `scipy.integrate` 库中的 `solve_ivp` 函数，该函数为求解初值问题提供了鲁棒的自适应算法。对于四个测试案例中的每一个，我们将定义矩阵 $E_{ij}(t)$ 和 $T_{ij}(t)$ 的具体形式、初始条件 $\\xi(0)$ 和 $v(0)$ 以及总积分时间 $T$。每个案例将进行两次独立的积分：一次使用 $E_{ij}(t)$ 进行GR预测，另一次使用 $T_{ij}(t)$ 进行牛顿预测。\n\n这四个案例旨在测试两种理论的对应关系和差异：\n- **案例A（静态点质量）：** 在这里，$E_{ij}$ 和 $T_{ij}$ 是相同的常数矩阵，代表了GR在潮汐力方面简化为牛顿引力的弱场极限。我们预期解 $\\xi_{\\mathrm{GR}}(t)$ 和 $\\xi_{\\mathrm{Newt}}(t)$ 在数值精度范围内是相同的。\n$E_{ij} = T_{ij} = \\mathrm{diag}(2GM/r^3, -GM/r^3, -GM/r^3)$，其中 $G = 6.674\\times 10^{-11}$ m$^3$ kg$^{-1}$ s$^{-2}$，$M = 5.0\\times 10^{30}$ kg，$r = 2.0\\times 10^{8}$ m。\n\n- **案例B（平面引力波）：** 该场景模拟了一个纯粹的GR效应，没有牛顿理论的对应物。$E_{ij}(t)$ 是时变的，描述了+偏振引力波的潮汐力，而 $T_{ij}(t)=0$。我们预期解会发散。\n$E_{xx}(t) = -E_{yy}(t) = \\frac{1}{2} h_0 \\omega^2 \\cos(\\omega t)$，其中 $h_0 = 1.0\\times 10^{-18}$，$\\omega = 6.28\\times 10^{2}$ rad/s。\n\n- **案例C（引力波，对齐的分离）：** 这是一个边界情况，其中初始分离向量与引力波的传播方向对齐。由于引力波是横波，不应感受到潮汐力，我们预期 $\\xi_{\\mathrm{GR}}(t)$ 和 $\\xi_{\\mathrm{Newt}}(t)$ 会一致。\n\n- **案例D（零场）：** 一个平凡情况，其中 $E_{ij}=0$ 和 $T_{ij}=0$，用作积分器的健全性检查。两种理论都预测没有加速度，因此分离向量应根据其初始速度演化。\n\n在获得每个案例的数值解 $\\xi_{\\mathrm{GR}}(t)$ 和 $\\xi_{\\mathrm{Newt}}(t)$ 之后，我们将计算三个指定的度量指标。为了精确计算依赖于连续时间演化的量，如上确界范数和失效时间，我们将利用 `solve_ivp` 的 `dense_output=True` 特性。这提供了一个可以在积分区间内任何点进行评估的插值解。将使用一个密集的时间点网格来进行这些评估。\n\n1.  **最大Frobenius范数 $\\|E\\|_{F,\\max}$**：在时间网格的每个点上计算矩阵 $E(t)$ 的Frobenius范数。这些值的最大值被作为结果。\n    $$\n    \\|E(t)\\|_F = \\sqrt{\\sum_{i,j=1}^3 E_{ij}(t)^2} \\qquad \\|E\\|_{F,\\max} = \\sup_{t \\in [0,T]} \\|E(t)\\|_F\n    $$\n2.  **最终时刻相对偏差 $\\delta_{\\mathrm{final}}$**：该度量量化了在积分时间 $T$ 结束时两个预测之间的累积差异。它使用最终状态向量 $\\xi_{\\mathrm{GR}}(T)$ 和 $\\xi_{\\mathrm{Newt}}(T)$ 进行计算。一个下限值 $\\epsilon_{\\mathrm{floor}} = 1.0\\times 10^{-15}$ m 可防止被近零范数除。\n    $$\n    \\delta_{\\mathrm{final}} = \\frac{\\|\\xi_{\\mathrm{GR}}(T) - \\xi_{\\mathrm{Newt}}(T)\\|_2}{\\max\\big(\\|\\xi_{\\mathrm{GR}}(T)\\|_2, \\epsilon_{\\mathrm{floor}}\\big)}\n    $$\n3.  **失效时间 $t_{\\mathrm{break}}$**：这是两个分离向量之间的瞬时相对差异首次超过给定容差 $\\varepsilon = 1.0\\times 10^{-6}$ 的最早时间 $t$。我们在评估时间网格的每个点上检查该条件。如果条件从未满足，则报告 $t_{\\mathrm{break}}$ 为 $-1.0$。\n    $$\n    \\|\\xi_{\\mathrm{GR}}(t) - \\xi_{\\mathrm{Newt}}(t)\\|_2 \\ge \\varepsilon\\,\\|\\xi_{\\mathrm{GR}}(t)\\|_2\n    $$\n\n最终的实现将系统地处理每个案例，计算这三个度量指标，并按规定将结果格式化为单个列表之列表。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\n# Global constants as defined in the problem\nG_CONST = 6.674e-11  # m^3 kg^-1 s^-2\nEPSILON_BREAKDOWN = 1.0e-6\nEPSILON_FLOOR = 1.0e-15\n\ndef ode_system(t, y, K_func):\n    \"\"\"\n    Defines the first-order ODE system dy/dt = F(t, y).\n    y is a 6-element state vector [xi_x, xi_y, xi_z, v_x, v_y, v_z].\n    K_func(t) returns the 3x3 tidal matrix K_ij at time t.\n    \"\"\"\n    xi = y[:3]\n    v = y[3:]\n    K_matrix = K_func(t)\n    acceleration = -K_matrix @ xi\n    return np.concatenate((v, acceleration))\n\ndef solve_case(E_func, T_func, xi0, v0, T_final):\n    \"\"\"\n    Solves a single test case for both GR and Newtonian models and computes metrics.\n    \"\"\"\n    y0 = np.concatenate((xi0, v0))\n    t_span = (0, T_final)\n    \n    # Use a sufficient number of points for accurate post-processing.\n    # The number of oscillations in case B/C is T*omega/(2pi) ~ 1e3 * 628 / 6.28 = 1e5\n    # A grid with ~20 points per oscillation is good, so ~2e6 points.\n    # However, to keep computation time reasonable, we use a slightly coarser grid.\n    # Dense output from solve_ivp ensures accuracy between grid points.\n    num_eval_points = 20001 \n    t_eval = np.linspace(0, T_final, num_eval_points)\n\n    # High-precision solver settings\n    solver_args = {'dense_output': True, 'method': 'RK45', 'atol': 1e-12, 'rtol': 1e-9}\n\n    # Solve for General Relativity\n    sol_gr = solve_ivp(lambda t, y: ode_system(t, y, E_func), t_span, y0, **solver_args)\n    y_gr = sol_gr.sol(t_eval)\n    xi_gr = y_gr[:3, :]\n\n    # Solve for Newtonian gravity\n    sol_newt = solve_ivp(lambda t, y: ode_system(t, y, T_func), t_span, y0, **solver_args)\n    y_newt = sol_newt.sol(t_eval)\n    xi_newt = y_newt[:3, :]\n\n    # --- Metric 1: Maximum Frobenius norm of E(t) ---\n    E_values = np.array([E_func(t) for t in t_eval])\n    frobenius_norms = np.linalg.norm(E_values, ord='fro', axis=(1, 2))\n    E_F_max = np.max(frobenius_norms) if frobenius_norms.size > 0 else 0.0\n\n    # --- Metric 2: Final-time relative deviation ---\n    xi_gr_final = xi_gr[:, -1]\n    xi_newt_final = xi_newt[:, -1]\n    numerator = np.linalg.norm(xi_gr_final - xi_newt_final)\n    denominator = max(np.linalg.norm(xi_gr_final), EPSILON_FLOOR)\n    delta_final = numerator / denominator\n\n    # --- Metric 3: Breakdown time ---\n    diff_norm = np.linalg.norm(xi_gr - xi_newt, axis=0)\n    xi_gr_norm = np.linalg.norm(xi_gr, axis=0)\n    # Avoid division by zero, though not expected in these cases\n    # xi_gr_norm is positive for all test cases.\n    breakdown_condition = diff_norm >= EPSILON_BREAKDOWN * xi_gr_norm\n    breakdown_indices = np.where(breakdown_condition)[0]\n    \n    t_break = t_eval[breakdown_indices[0]] if breakdown_indices.size > 0 else -1.0\n    \n    return [E_F_max, delta_final, t_break]\n\ndef solve():\n    # Define the test cases from the problem statement.\n    \n    # Case A: Static point mass\n    M_A = 5.0e30\n    r_A = 2.0e8\n    c1_A = (2 * G_CONST * M_A) / (r_A**3)\n    c2_A = (-G_CONST * M_A) / (r_A**3)\n    K_A = np.diag([c1_A, c2_A, c2_A])\n    case_A = {\n        'E_func': lambda t: K_A,\n        'T_func': lambda t: K_A,\n        'xi0': np.array([1.0, 0.5, 0.0]),\n        'v0': np.array([0.0, 0.0, 0.0]),\n        'T_final': 1.0\n    }\n\n    # Case B: Plane gravitational wave\n    h0_B = 1.0e-18\n    omega_B = 6.28e2\n    A_B = 0.5 * h0_B * omega_B**2\n    def E_func_B(t):\n        val = A_B * np.cos(omega_B * t)\n        return np.array([[val, 0, 0], [0, -val, 0], [0, 0, 0]])\n    \n    T_func_zero = lambda t: np.zeros((3, 3))\n    \n    case_B = {\n        'E_func': E_func_B,\n        'T_func': T_func_zero,\n        'xi0': np.array([1.0, 0.0, 0.0]),\n        'v0': np.array([0.0, 0.0, 0.0]),\n        'T_final': 1.0e3\n    }\n    \n    # Case C: Gravitational wave, aligned separation\n    case_C = {\n        'E_func': E_func_B, # Same wave as B\n        'T_func': T_func_zero,\n        'xi0': np.array([0.0, 0.0, 1.0]),\n        'v0': np.array([0.0, 0.0, 0.0]),\n        'T_final': 1.0e3\n    }\n\n    # Case D: Null field\n    case_D = {\n        'E_func': T_func_zero,\n        'T_func': T_func_zero,\n        'xi0': np.array([1.0, 1.0, 1.0]),\n        'v0': np.array([0.0, 0.0, 0.0]),\n        'T_final': 1.0e1\n    }\n    \n    test_cases = [case_A, case_B, case_C, case_D]\n    \n    results = []\n    for case_params in test_cases:\n        result = solve_case(**case_params)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # The default str() for a list includes spaces, which we remove for a compact representation.\n    # The problem example `print` suggests spaces might be ok, but we follow the format `[[a,b,c],[d,e,f]]` more strictly.\n    formatted_results = ','.join([str(res).replace(' ', '') for res in results])\n    print(f\"[{formatted_results}]\")\n\nsolve()\n\n```"
        }
    ]
}