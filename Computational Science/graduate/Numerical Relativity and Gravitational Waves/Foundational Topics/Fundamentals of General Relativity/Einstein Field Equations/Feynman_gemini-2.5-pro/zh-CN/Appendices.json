{
    "hands_on_practices": [
        {
            "introduction": "在模拟双黑洞等系统的演化之前，我们需要明确其在初始时刻的状态。然而，与物理学的许多其他领域不同，我们不能随意选择初始构型。爱因斯坦方程施加了严格的*约束方程*，初始数据必须满足这些方程。\n\n本练习将指导你学习共形方法，这是一种求解这些约束方程的强大技术。你将看到，通过巧妙地选择变量和规范条件，如何将一个复杂的非线性问题转化为求解我们所熟悉的拉普拉斯方程，从而使我们能够构建包含多个黑洞的有效初始数据 ()。",
            "id": "3472990",
            "problem": "考虑爱因斯坦场方程 (EFE) 的 Arnowitt–Deser–Misner (ADM) $3+1$ 分解，其中时空被类空超曲面叶状化，这些超曲面具有诱导3-度规 $\\gamma_{ij}$、单位法向量 $n^{a}$ 和外曲率 $K_{ij}$，其迹为 $K = \\gamma^{ij} K_{ij}$。由 $n^{a}$ 测量的能量密度为 $\\rho := n^{a} n^{b} T_{ab}$。使用高斯-科达齐关系，以3-标量曲率 $R[\\gamma]$、外曲率和 $\\rho$ 来表示每个超曲面上的哈密顿约束。然后，实施极大切片条件 $K=0$ 并假设时间对称初始数据（意味着该切片在时间反演下对称），以简化一般情况和真空情况下的哈密顿约束。\n\n接下来，对3-度规采用形式为 $\\gamma_{ij} = \\psi^{4} \\delta_{ij}$ 的共形平坦拟设，其中 $\\delta_{ij}$ 是笛卡尔坐标系中的欧几里得度规，$\\psi$ 是一个正常数标量场（共形因子）。从 $\\gamma_{ij}$ 的列维-奇维塔联络和曲率的定义出发，计算 $R[\\gamma]$ 关于 $\\psi$ 及其相对于 $\\delta_{ij}$ 的导数的表达式，并利用你简化的哈密顿约束，得到在真空、时间对称、极大切片初始数据条件下 $\\psi$ 的控制方程。\n\n通过要求当 $r \\to \\infty$ 时 $\\psi \\to 1$ 来施加渐近平坦条件，并考虑一个真空构型，该构型代表两个质量参数为 $m$ 的相同、无自旋的黑洞穿刺点，它们位于 $z$ 轴上的 $(0,0,a)$ 和 $(0,0,-a)$ 位置。假设共形因子在穿刺点之外是调和的，并且在每个穿刺点附近与各向同性史瓦西渐近行为一致，确定共形因子在原点 $(0,0,0)$ 的值。\n\n将你的最终答案表示为单个闭式符号表达式。不需要四舍五入，共形因子是无量纲的，因此无需指定单位。你的答案必须是一个计算结果。",
            "solution": "该问题要求在广义相对论的 Arnowitt–Deser–Misner (ADM) $3+1$ 形式主义框架内进行多步推导和计算。\n\n首先，我们验证问题陈述的有效性。\n\n### 步骤1：提取给定条件\n- 框架：爱因斯坦场方程 (EFE) 的 Arnowitt–Deser–Misner (ADM) $3+1$ 分解。\n- 时空叶状化：类空超曲面。\n- 诱导3-度规：$\\gamma_{ij}$。\n- 单位法向量：$n^{a}$。\n- 外曲率：$K_{ij}$。\n- 外曲率的迹：$K = \\gamma^{ij} K_{ij}$。\n- 能量密度：$\\rho := n^{a} n^{b} T_{ab}$。\n- 任务1：使用高斯-科达齐关系推导哈密顿约束。\n- 条件1：极大切片，$K=0$。\n- 条件2：时间对称初始数据。\n- 任务2：在这些条件下简化哈密顿约束。\n- 3-度规的拟设：$\\gamma_{ij} = \\psi^{4} \\delta_{ij}$，其中 $\\delta_{ij}$ 是欧几里得度规，$\\psi  0$ 是共形因子。\n- 任务3：以 $\\psi$ 表示3-标量曲率 $R[\\gamma]$。\n- 任务4：推导在真空、时间对称、极大切片初始数据条件下 $\\psi$ 的控制方程。\n- 边界条件：渐近平坦，当 $r \\to \\infty$ 时 $\\psi \\to 1$。\n- 构型：两个质量参数为 $m$ 的相同、无自旋的黑洞穿刺点。\n- 穿刺点位置：$(0,0,a)$ 和 $(0,0,-a)$。\n- 物理假设：共形因子 $\\psi$ 在穿刺点之外是调和的，并且在每个穿刺点附近与各向同性史瓦西渐近行为一致。\n- 最终任务：确定 $\\psi$ 在原点 $(0,0,0)$ 的值。\n\n### 步骤2：使用提取的给定条件进行验证\n- **科学基础：** 该问题完全基于广义相对论的既定原理，特别是 ADM 形式主义和为黑洞系统构建初始数据的共形方法（Bowen-York 初始数据）。所有概念都是该领域的标准概念。\n- **良态问题：** 该问题被构造为一系列逻辑推导，最终导向一个具体的计算。所有必要的信息、条件和假设都已提供，以得出一个唯一且有意义的解。\n- **客观性：** 该问题使用来自物理学和数学的精确、标准且无偏见的术语进行陈述。\n\n该问题没有科学缺陷、矛盾或歧义。它是理论相对论和数值相对论中一个标准的、非平凡的问题。\n\n### 步骤3：结论与行动\n问题有效。我将继续进行详细求解。\n\n### 哈密顿约束的推导\n\n爱因斯坦场方程 (EFE) 为 $G_{ab} = R_{ab} - \\frac{1}{2}g_{ab} R = 8\\pi T_{ab}$，其中我们使用几何化单位制，令 $G=c=1$。哈密顿约束是通过将 EFE 投影到类空超曲面的法向方向上得到的，即与 $n^a n^b$ 进行缩并。\n$$G_{ab} n^a n^b = 8\\pi T_{ab} n^a n^b$$\n根据定义，右边的项是 $8\\pi\\rho$。\n爱因斯坦张量的缩并 $G_{ab}n^a n^b$ 可以通过高斯-科达齐方程与3-切片的内曲率和外曲率联系起来。具体来说，4维标量曲率 $^{(4)}R$ 和3维标量曲率 $R \\equiv R[\\gamma]$ 的高斯-科达齐关系为：\n$$^{(4)}R = R + K_{ij}K^{ij} - K^2 - 2 \\nabla_a (n^b \\nabla_b n^a - K n^a)$$\n投影 $G_{ab} n^a n^b$ 可以被证明产生以下恒等式：\n$$G_{ab} n^a n^b = \\frac{1}{2}(R + K^2 - K_{ij}K^{ij})$$\n将此式与能量密度项相等，我们得到哈密顿约束：\n$$R + K^2 - K_{ij}K^{ij} = 16\\pi\\rho$$\n\n### 哈密顿约束的简化\n\n问题指定了两个条件：极大切片 ($K=0$) 和时间对称初始数据。时间对称初始数据意味着切片代表了时间反演对称的瞬间。物理上，这意味着此时刻所有的“速度”都为零。外曲率 $K_{ij}$ 与3-度规的时间导数（或“速度”）有关，因此时间对称性意味着 $K_{ij}=0$。\n如果 $K_{ij}=0$，那么它的迹 $K=\\gamma^{ij}K_{ij}$ 也为零，因此极大切片条件自动满足。将 $K_{ij}=0$ 和 $K=0$ 代入哈密顿约束，我们得到：\n$$R = 16\\pi\\rho$$\n问题进一步要求我们考虑真空构型，这意味着应力-能量张量 $T_{ab}$ 为零，因此能量密度 $\\rho=0$。因此，对于真空、时间对称的初始数据，简化的哈密顿约束为：\n$$R = 0$$\n\n### 共形度规的标量曲率\n\n我们被给予3-度规的共形平坦拟设：$\\gamma_{ij} = \\psi^4 \\delta_{ij}$。我们需要以 $\\psi$ 表示该度规的里奇标量 $R$。对于 $\\gamma_{ij} = \\psi^{N}\\delta_{ij}$，里奇标量与拉普拉斯算子的关系为 $R = -N(n-1+N/4)\\psi^{N-2}\\nabla^2\\psi - ...$。对于 $n=3$ 和 $N=4$，我们有 $R = -8\\psi^{-5}\\nabla^2\\psi$。\n我们通过变换公式验证。在 $n=3$ 维中，共形变换 $\\gamma_{ij} = \\Omega^2 \\eta_{ij}$ 下里奇标量变化的一般公式是：\n$$R[\\gamma] = \\Omega^{-2}(R[\\eta] - 2(n-1)\\nabla^2_{\\eta}\\ln\\Omega - (n-2)(n-1)|\\nabla_{\\eta}\\ln\\Omega|^2)$$\n在我们的例子中，基础度规 $\\eta_{ij}$ 是平坦的欧几里得度规 $\\delta_{ij}$，所以其里奇标量 $R[\\delta_{ij}]=0$。共形缩放因子是 $\\Omega = \\psi^2$。因此 $\\ln\\Omega = 2\\ln\\psi$。梯度 $\\nabla_{\\eta}$ 和拉普拉斯算子 $\\nabla^2_{\\eta}$ 是平坦欧几里得空间中的标准算子，我们将其表示为 $\\nabla$ 和 $\\nabla^2$。\n代入 $n=3$：\n$$R[\\gamma] = \\psi^{-4}(0 - 4\\nabla^2(2\\ln\\psi) - 2|\\nabla(2\\ln\\psi)|^2)$$\n$$R = \\psi^{-4}(-8\\nabla^2(\\ln\\psi) - 8|\\nabla\\ln\\psi|^2)$$\n使用 $\\nabla(\\ln\\psi) = \\psi^{-1}\\nabla\\psi$ 和 $\\nabla^2(\\ln\\psi) = \\nabla\\cdot(\\psi^{-1}\\nabla\\psi) = -\\psi^{-2}|\\nabla\\psi|^2 + \\psi^{-1}\\nabla^2\\psi$。\n$$R = \\psi^{-4}[-8(-\\psi^{-2}|\\nabla\\psi|^2 + \\psi^{-1}\\nabla^2\\psi) - 8(\\psi^{-1}\\nabla\\psi)^2]$$\n$$R = \\psi^{-4}[8\\psi^{-2}|\\nabla\\psi|^2 - 8\\psi^{-1}\\nabla^2\\psi - 8\\psi^{-2}|\\nabla\\psi|^2]$$\n$$R = -8\\psi^{-5}\\nabla^2\\psi$$\n这个结果是正确的。\n\n### 共形因子的控制方程\n\n我们将这个 $R$ 的表达式代入简化的哈密顿约束 $R=0$ 中：\n$$-8\\psi^{-5}\\nabla^2\\psi = 0$$\n由于 $\\psi$ 是一个正常数标量场，$\\psi0$，我们可以除以 $-8\\psi^{-5}$ 来获得共形因子的控制方程：\n$$\\nabla^2\\psi = 0$$\n这是三维平坦空间中的拉普拉斯方程。这意味着对于由共形平坦度规指定的真空、时间对称初始数据，共形因子必须是 $\\mathbb{R}^3$ 上的调和函数，除了在任何源或穿刺点处。\n\n### 双黑洞穿刺点的解\n\n问题描述了两个相同的、无自旋的黑洞穿刺点的构型。对于位于原点、质量参数为 $m$ 的单个穿刺点，史瓦西度规在各向同性坐标下的空间部分是 $\\gamma_{ij} = (1 + \\frac{m}{2r})^4 \\delta_{ij}$，其中 $r$ 是距原点的欧几里得距离。将其与我们的拟设 $\\gamma_{ij} = \\psi^4 \\delta_{ij}$ 进行比较，我们确定单个穿刺点的共形因子为 $\\psi(r) = 1 + \\frac{m}{2r}$。该解在 $r \\neq 0$ 时满足 $\\nabla^2\\psi=0$，并满足当 $r \\to \\infty$ 时 $\\psi \\to 1$ 的渐近平坦条件。\n\n控制方程 $\\nabla^2\\psi = 0$ 是线性的。因此，对于多穿刺点系统，解是单个穿刺点解的线性叠加。我们有两个质量参数为 $m$ 的相同穿刺点，位于位置 $\\vec{p}_1 = (0,0,a)$ 和 $\\vec{p}_2 = (0,0,-a)$。在任意点 $\\vec{x}=(x,y,z)$ 的共形因子 $\\psi$ 由以下和式给出：\n$$\\psi(\\vec{x}) = 1 + \\frac{m}{2|\\vec{x} - \\vec{p}_1|} + \\frac{m}{2|\\vec{x} - \\vec{p}_2|}$$\n常数 $1$ 确保满足渐近平坦条件。代入坐标：\n$$\\psi(x,y,z) = 1 + \\frac{m}{2\\sqrt{x^2 + y^2 + (z-a)^2}} + \\frac{m}{2\\sqrt{x^2 + y^2 + (z+a)^2}}$$\n\n### 共形因子在原点的值\n\n我们被要求计算 $\\psi$ 在原点的值，即在 $\\vec{x} = (0,0,0)$ 处。\n$$\\psi(0,0,0) = 1 + \\frac{m}{2\\sqrt{0^2 + 0^2 + (0-a)^2}} + \\frac{m}{2\\sqrt{0^2 + 0^2 + (0+a)^2}}$$\n$$\\psi(0,0,0) = 1 + \\frac{m}{2\\sqrt{(-a)^2}} + \\frac{m}{2\\sqrt{a^2}}$$\n假设 $a$ 是一个正的距离参数，则 $\\sqrt{a^2}=a$。\n$$\\psi(0,0,0) = 1 + \\frac{m}{2a} + \\frac{m}{2a}$$\n$$\\psi(0,0,0) = 1 + \\frac{2m}{2a}$$\n$$\\psi(0,0,0) = 1 + \\frac{m}{a}$$\n这是两个黑洞穿刺点中点的共形因子的值。",
            "answer": "$$\n\\boxed{1 + \\frac{m}{a}}\n$$"
        },
        {
            "introduction": "数值相对论的模拟在有限的计算网格上进行，但我们模拟的时空通常是无限的。这产生了一个人为的外部边界。诸如引力波之类的出射物理信号会从这个边界反射回计算区域，从而污染模拟结果。\n\n本练习将演示如何分析和设计一种“吸收”边界条件，以最大程度地减少这些虚假反射。通过将出射辐射建模为一个简单的标量波，你将推导一种常见边界条件下的反射系数，并找到实现最大吸收的最优参数选择 ()。这是从模拟中获得有物理意义结果的一项关键技能。",
            "id": "3473021",
            "problem": "考虑广义相对论（GR）的渐近平坦真空极限，其中闵可夫斯基背景上的线性化度规微扰 $h_{\\mu\\nu}$ 满足洛伦兹规范下的简化爱因斯坦方程，这是一组耦合双曲型偏微分方程（PDE）。在波区，与微扰相关的每个规范不变主函数（例如，对于固定的多极，Regge–Wheeler 函数或 Zerilli 函数）都遵循平直时空标量波方程\n$$\n\\partial_{t}^{2}\\psi - c^{2}\\nabla^{2}\\psi = 0,\n$$\n其波速等于光速 $c$。在数值相对论（NR）中，计算区域在有限的外边界半径 $r=R$ 处被截断。为了减少出射引力辐射在该边界处的伪反射，通常会施加一个索末菲（Sommerfeld）型吸收边界条件。\n\n假设远区主函数 $\\psi(t,r)$ 由一个角频率为 $\\omega$ 的单色四极引力波模式主导，其径向依赖性渐近衰减为 $1/r$。在外边界附近，将 $\\psi$ 建模为出射和入射球面波的叠加，\n$$\n\\psi(t,r) = \\frac{A}{r}\\exp\\!\\big(-\\mathrm{i}\\,\\omega(t - r/c)\\big) + \\frac{B}{r}\\exp\\!\\big(-\\mathrm{i}\\,\\omega(t + r/c)\\big),\n$$\n其中复振幅分别为 $A$（出射）和 $B$（入射）。定义复反射系数为 $\\rho = B/A$。\n\n在 $r=R$ 处，施加单参数索末菲型边界条件\n$$\n\\left.\\big(\\partial_{t}\\psi + c\\,\\partial_{r}\\psi + \\gamma\\,\\frac{c}{R}\\,\\psi\\big)\\right|_{r=R} = 0,\n$$\n其中 $\\gamma$ 是一个待定的无量纲实数参数。\n\n从第一性原理和上述模型出发，推导该边界条件所蕴含的反射系数 $\\rho(\\gamma,\\omega,R,c)$，然后确定对于任意的 $\\omega$ 和 $R$ 能使 $|\\rho|$ 最小化的 $\\gamma$ 值。将最优的 $\\gamma$ 表示为一个无量纲实数。无需四舍五入，最终值中不应包含单位。",
            "solution": "该问题是有效的，因为它具有科学依据、良定且客观。我们着手进行推导。\n\n在 $r=R$ 的外边界附近，主函数 $\\psi(t,r)$ 被给定为出射球面波和入射球面波的叠加：\n$$\n\\psi(t,r) = \\frac{A}{r}\\exp(-\\mathrm{i}\\,\\omega(t - r/c)) + \\frac{B}{r}\\exp(-\\mathrm{i}\\,\\omega(t + r/c))\n$$\n其中 $A$ 和 $B$ 分别是出射波和入射波的复振幅。我们可以将 $\\psi(t,r)$ 写成两个分量之和，$\\psi_{\\text{out}}(t,r)$ 和 $\\psi_{\\text{in}}(t,r)$：\n$$\n\\psi_{\\text{out}}(t,r) = \\frac{A}{r}\\exp(-\\mathrm{i}\\,\\omega(t - r/c))\n$$\n$$\n\\psi_{\\text{in}}(t,r) = \\frac{B}{r}\\exp(-\\mathrm{i}\\,\\omega(t + r/c))\n$$\n\n吸收边界条件施加于 $r=R$ 处：\n$$\n\\left.\\big(\\partial_{t}\\psi + c\\,\\partial_{r}\\psi + \\gamma\\,\\frac{c}{R}\\,\\psi\\big)\\right|_{r=R} = 0\n$$\n我们定义一个线性算子 $\\mathcal{L} \\equiv \\partial_{t} + c\\,\\partial_{r} + \\gamma\\,\\frac{c}{R}$。边界条件即为 $\\mathcal{L}[\\psi]|_{r=R} = 0$。根据线性性质，$\\mathcal{L}[\\psi] = \\mathcal{L}[\\psi_{\\text{out}}] + \\mathcal{L}[\\psi_{\\text{in}}]$。我们将计算 $\\mathcal{L}$ 对每个分量的作用。\n\n首先，我们为形式为 $\\phi(t,r) = \\frac{C}{r}\\exp(-\\mathrm{i}\\,\\omega(t \\mp r/c))$ 的一般球面波分量计算必要的偏导数。\n关于时间 $t$ 的偏导数为：\n$$\n\\partial_{t}\\phi = \\frac{C}{r} (-\\mathrm{i}\\,\\omega) \\exp(-\\mathrm{i}\\,\\omega(t \\mp r/c)) = -\\mathrm{i}\\,\\omega\\,\\phi\n$$\n关于径向坐标 $r$ 的偏导数使用乘法法则求得：\n$$\n\\partial_{r}\\phi = C \\left( -\\frac{1}{r^2} \\right) \\exp(-\\mathrm{i}\\,\\omega(t \\mp r/c)) + \\frac{C}{r} \\left( -\\mathrm{i}\\,\\omega \\left( \\mp \\frac{1}{c} \\right) \\right) \\exp(-\\mathrm{i}\\,\\omega(t \\mp r/c))\n$$\n$$\n\\partial_{r}\\phi = \\left( -\\frac{1}{r} \\pm \\frac{\\mathrm{i}\\,\\omega}{c} \\right) \\phi\n$$\n\n现在，我们将算子 $\\mathcal{L}$ 应用于出射分量 $\\psi_{\\text{out}}$，此时我们使用上标符号（相位中为 $-r/c$）：\n$$\n\\mathcal{L}[\\psi_{\\text{out}}] = \\partial_{t}\\psi_{\\text{out}} + c\\,\\partial_{r}\\psi_{\\text{out}} + \\gamma\\,\\frac{c}{R}\\,\\psi_{\\text{out}}\n$$\n$$\n\\mathcal{L}[\\psi_{\\text{out}}] = -\\mathrm{i}\\,\\omega\\,\\psi_{\\text{out}} + c\\left( -\\frac{1}{r} + \\frac{\\mathrm{i}\\,\\omega}{c} \\right) \\psi_{\\text{out}} + \\gamma\\,\\frac{c}{R}\\,\\psi_{\\text{out}}\n$$\n$$\n\\mathcal{L}[\\psi_{\\text{out}}] = (-\\mathrm{i}\\,\\omega - \\frac{c}{r} + \\mathrm{i}\\,\\omega)\\psi_{\\text{out}} + \\gamma\\,\\frac{c}{R}\\,\\psi_{\\text{out}} = -\\frac{c}{r}\\psi_{\\text{out}} + \\gamma\\,\\frac{c}{R}\\,\\psi_{\\text{out}}\n$$\n在边界 $r=R$ 处求值：\n$$\n\\left.\\mathcal{L}[\\psi_{\\text{out}}]\\right|_{r=R} = -\\frac{c}{R}\\psi_{\\text{out}}(t,R) + \\gamma\\,\\frac{c}{R}\\psi_{\\text{out}}(t,R) = (\\gamma-1)\\frac{c}{R}\\psi_{\\text{out}}(t,R)\n$$\n\n接下来，我们将 $\\mathcal{L}$ 应用于入射分量 $\\psi_{\\text{in}}$，此时我们使用下标符号（相位中为 $+r/c$）：\n$$\n\\mathcal{L}[\\psi_{\\text{in}}] = \\partial_{t}\\psi_{\\text{in}} + c\\,\\partial_{r}\\psi_{\\text{in}} + \\gamma\\,\\frac{c}{R}\\,\\psi_{\\text{in}}\n$$\n$$\n\\mathcal{L}[\\psi_{\\text{in}}] = -\\mathrm{i}\\,\\omega\\,\\psi_{\\text{in}} + c\\left( -\\frac{1}{r} - \\frac{\\mathrm{i}\\,\\omega}{c} \\right) \\psi_{\\text{in}} + \\gamma\\,\\frac{c}{R}\\,\\psi_{\\text{in}}\n$$\n$$\n\\mathcal{L}[\\psi_{\\text{in}}] = (-\\mathrm{i}\\,\\omega - \\frac{c}{r} - \\mathrm{i}\\,\\omega)\\psi_{\\text{in}} + \\gamma\\,\\frac{c}{R}\\,\\psi_{\\text{in}} = (-2\\mathrm{i}\\,\\omega - \\frac{c}{r})\\psi_{\\text{in}} + \\gamma\\,\\frac{c}{R}\\,\\psi_{\\text{in}}\n$$\n在边界 $r=R$ 处求值：\n$$\n\\left.\\mathcal{L}[\\psi_{\\text{in}}]\\right|_{r=R} = (-2\\mathrm{i}\\,\\omega - \\frac{c}{R})\\psi_{\\text{in}}(t,R) + \\gamma\\,\\frac{c}{R}\\psi_{\\text{in}}(t,R) = \\left( (\\gamma-1)\\frac{c}{R} - 2\\mathrm{i}\\,\\omega \\right)\\psi_{\\text{in}}(t,R)\n$$\n\n边界条件 $\\mathcal{L}[\\psi]|_{r=R} = 0$ 变为：\n$$\n(\\gamma-1)\\frac{c}{R}\\psi_{\\text{out}}(t,R) + \\left( (\\gamma-1)\\frac{c}{R} - 2\\mathrm{i}\\,\\omega \\right)\\psi_{\\text{in}}(t,R) = 0\n$$\n代入 $\\psi_{\\text{out}}(t,R)$ 和 $\\psi_{\\text{in}}(t,R)$ 的表达式：\n$$\n(\\gamma-1)\\frac{c}{R} \\frac{A}{R}\\exp(-\\mathrm{i}\\,\\omega(t - R/c)) + \\left( (\\gamma-1)\\frac{c}{R} - 2\\mathrm{i}\\,\\omega \\right) \\frac{B}{R}\\exp(-\\mathrm{i}\\,\\omega(t + R/c)) = 0\n$$\n我们可以消去公因子 $\\frac{1}{R}\\exp(-\\mathrm{i}\\,\\omega t)$:\n$$\n(\\gamma-1)\\frac{c}{R} A \\exp(\\mathrm{i}\\,\\omega R/c) + \\left( (\\gamma-1)\\frac{c}{R} - 2\\mathrm{i}\\,\\omega \\right) B \\exp(-\\mathrm{i}\\,\\omega R/c) = 0\n$$\n现在，我们求解反射系数 $\\rho = B/A$：\n$$\nB \\left( (\\gamma-1)\\frac{c}{R} - 2\\mathrm{i}\\,\\omega \\right) \\exp(-\\mathrm{i}\\,\\omega R/c) = - A (\\gamma-1)\\frac{c}{R} \\exp(\\mathrm{i}\\,\\omega R/c)\n$$\n$$\n\\rho = \\frac{B}{A} = - \\frac{(\\gamma-1)\\frac{c}{R}}{(\\gamma-1)\\frac{c}{R} - 2\\mathrm{i}\\,\\omega} \\frac{\\exp(\\mathrm{i}\\,\\omega R/c)}{\\exp(-\\mathrm{i}\\,\\omega R/c)}\n$$\n$$\n\\rho = - \\frac{(\\gamma-1)\\frac{c}{R}}{(\\gamma-1)\\frac{c}{R} - 2\\mathrm{i}\\,\\omega} \\exp(2\\mathrm{i}\\,\\omega R/c)\n$$\n这就是反射系数 $\\rho(\\gamma,\\omega,R,c)$。\n\n下一步是找到使反射系数的模 $|\\rho|$ 最小化的 $\\gamma$ 值。\n$$\n|\\rho| = \\left| - \\frac{(\\gamma-1)\\frac{c}{R}}{(\\gamma-1)\\frac{c}{R} - 2\\mathrm{i}\\,\\omega} \\exp(2\\mathrm{i}\\,\\omega R/c) \\right|\n$$\n因为 $|\\exp(2\\mathrm{i}\\,\\omega R/c)|=1$，所以模为：\n$$\n|\\rho| = \\frac{\\left|(\\gamma-1)\\frac{c}{R}\\right|}{\\left|(\\gamma-1)\\frac{c}{R} - 2\\mathrm{i}\\,\\omega\\right|}\n$$\n复数 $z = x + \\mathrm{i}y$ 的模为 $|z|=\\sqrt{x^2+y^2}$。\n$$\n|\\rho| = \\frac{|\\gamma-1| \\frac{c}{R}}{\\sqrt{\\left((\\gamma-1)\\frac{c}{R}\\right)^2 + (-2\\omega)^2}} = \\frac{|\\gamma-1|}{\\sqrt{(\\gamma-1)^2 + (2\\omega R/c)^2}}\n$$\n我们希望对于任意非零的 $\\omega$ 和 $R$，关于 $\\gamma$ 最小化 $|\\rho|$ 的表达式。令 $x = \\gamma-1$ 且 $K = 2\\omega R/c$。由于 $\\omega  0$（对于波）且 $R  0$，我们有 $K  0$。需要最小化的函数是：\n$$\nf(x) = \\frac{|x|}{\\sqrt{x^2 + K^2}}\n$$\n分母 $\\sqrt{x^2 + K^2}$ 恒为正。分子 $|x|$ 恒为非负。\n分子的最小值为 $0$，在 $x=0$ 时取得。\n在 $x=0$ 时，函数值为 $f(0) = \\frac{0}{\\sqrt{0^2 + K^2}} = \\frac{0}{K} = 0$。\n由于 $|\\rho|$ 必须为非负，这是绝对最小值。\n最小值在 $x=0$ 时达到，这对应于 $\\gamma-1=0$。\n因此，$\\gamma$ 的最优值为：\n$$\n\\gamma = 1\n$$\n正如所要求的，这个 $\\gamma$ 值是一个无量纲实数，并且与 $\\omega$ 和 $R$ 无关。对于任何 $\\omega \\neq 0$ 的波，选择 $\\gamma=1$ 会导致 $|\\rho|=0$，意味着在此模型下实现了完美吸收。",
            "answer": "$$\n\\boxed{1}\n$$"
        },
        {
            "introduction": "爱因斯坦方程的原始ADM表述虽然在数学上很优美，但在长期模拟中却极易出现数值不稳定性。BSSN表述通过共形分解重构了这些方程，被证明要稳健得多，使得黑洞并合等里程碑式的模拟成为可能。\n\n在这个编程实践练习中，你将探究BSSN表述成功的关键原因之一。通过实现一个简化的代理模型，你将直接比较“朴素”的演化方法与受BSSN启发的、强制实施共形约束的方法，并量化后者在处理物质中的激波等尖锐特征时如何提高稳定性 ()。",
            "id": "3473053",
            "problem": "要求您设计并实现一个受控数值实验，该实验基于爱因斯坦场方程，旨在探究在应力-能量张量存在间断的情况下，Baumgarte–Shapiro–Shibata–Nakamura (BSSN) 形式体系中的共形重缩放是否能改善激波捕捉的数值稳定性。目标是将问题简化为一个忠实、低维的代理偏微分方程和两种分别体现未重缩放度规变量与共形重缩放变量的形式体系。您的程序必须比较这两种形式体系的稳定性诊断量，并针对给定测试套件中的每个测试用例，判断共形重缩放是否有助于提高稳定性。\n\n基本和建模假设：\n- 从几何单位制（光速 $c=1$ 且牛顿引力常数 $G=1$）下的爱因斯坦场方程 $G_{\\mu\\nu}=8\\pi T_{\\mu\\nu}$ 出发，并采用 BSSN (Baumgarte–Shapiro–Shibata–Nakamura) 分解，将空间度规分解为一个共形因子和一个单位行列式的共形度规。在 BSSN 形式体系中，通过 $\\gamma_{ij}=e^{4\\phi}\\tilde{\\gamma}_{ij}$（其中 $\\det \\tilde{\\gamma}_{ij}=1$）引入共形因子，同时还引入外曲率的迹 $K$ 和无迹共形外曲率 $\\tilde{A}_{ij}$。物质的影响通过 $T_{\\mu\\nu}$ 的投影出现在曲率分量的演化方程中。\n- 考虑围绕闵可夫斯基时空的线性化一维动力学，重点关注体积模式和度规部分的一个代表性自由度。在这种情况下，带有 $T_{\\mu\\nu}$ 间断的物质会在投影后的方程中引入间断的源项。为了分离共形重缩放在激波捕捉下对稳定性的影响，将动力学简化为一个关于标量场 $u(x,t)$（代表由体积自由度主导的度规模式）及其速度 $v(x,t)=\\partial_t u(x,t)$ 的受迫波动代理系统：\n$$\n\\partial_t u(x,t) = v(x,t), \\quad \\partial_t v(x,t) = c^2 \\partial_x^2 u(x,t) + s(x),\n$$\n其中 $c=1$，间断源 $s(x)$ 模拟 $T_{\\mu\\nu}$ 分量（例如能量密度或应力）的跳跃。通过在 $v$ 方程中添加一个小的`人工粘性`项 $+\\nu \\partial_x^2 v(x,t)$ 来近似激波捕捉，这是数值相对论中一种标准的数值稳定化技术。\n\n共形重缩放代理：\n- BSSN 共形重缩放的核心特征是通过对 $\\tilde{\\gamma}_{ij}$ 施加单位行列式约束来移除空间体积自由度，这会抑制零波数（空间均匀）模式。为了在代理模型中模拟这一点，定义两种形式体系：\n  1. 未重缩放形式体系：按原样演化系统。\n  2. 共形重缩放形式体系：在每个显式龙格-库塔子步之后，将 $u$ 和 $v$ 的空间平均值投影出去，强制满足\n  $$\n  \\langle u(\\cdot,t)\\rangle = \\frac{1}{L}\\int_0^L u(x,t)\\,dx = 0, \\quad \\langle v(\\cdot,t)\\rangle = 0,\n  $$\n  这通过移除零波数分量，在代理模型的层面上模拟了 BSSN 约束 $\\det\\tilde{\\gamma}_{ij}=1$。\n\n定义域、初始数据和源项：\n- 考虑具有周期性边界条件的空间定义域 $x\\in[0,1]$，且 $L=1$。\n- 使用初始数据 $u(x,0)=0$ 和 $v(x,0)=0$。\n- 间断源是一个亥维赛德阶跃函数：\n$$\ns(x) = A\\, H(x-0.5),\n$$\n其中 $H(\\cdot)$ 是亥维赛德函数，$A$ 是一个实数振幅参数。这模拟了 $T_{\\mu\\nu}$ 在 $x=0.5$ 处的一个间断。\n\n离散化与时间积分：\n- 用 $N$ 个均匀间隔的网格点对空间进行离散化，间距为 $\\Delta x = 1/N$。\n- 在周期性边界条件下，使用二阶中心差分来近似 $\\partial_x^2$。\n- 使用库朗-弗里德里希斯-列维数 $\\mathrm{CFL}$ 来设置时间步长 $\\Delta t = \\mathrm{CFL}\\,\\Delta x/c$，其中 $c=1$。\n- 使用一个三阶段强保稳龙格-库塔积分器演化到最终时间 $T=2.0$。在每个子步之后，仅在共形重缩放形式体系中应用共形投影（移除空间平均值）。在两种形式体系中应用相同的人工粘性系数 $\\nu$。\n\n诊断量与决策规则：\n- 设 $u_{\\mathrm{U}}(x,T)$ 和 $u_{\\mathrm{R}}(x,T)$ 分别表示未重缩放和重缩放运行得到的最终场。定义以下诊断量：\n  1. 间断点附近的局部总变差。设 $j_0=\\lfloor 0.5/\\Delta x\\rfloor$ 为最接近跳跃点的网格索引。对于半径为 $W=\\lfloor N/20\\rfloor$ 的窗口，定义\n  $$\n  \\mathrm{TV}(u) = \\sum_{k=-W}^{W-1} \\left|u\\big(x_{j_0+k+1},T\\big) - u\\big(x_{j_0+k},T\\big)\\right|.\n  $$\n  2. 通过离散拉普拉斯算子代理的高频成分，\n  $$\n  \\mathrm{HF}(u) = \\left(\\frac{1}{N}\\sum_{j=0}^{N-1}\\left[\\Delta_x u(x_j,T)\\right]^2\\right)^{1/2},\n  $$\n  其中 $\\Delta_x$ 是离散二阶差分算子。\n- 使用容差 $\\tau=0.01$，当且仅当满足以下条件时，判定共形重缩放有助于稳定性：\n  - 两次运行均未出现数值失败（没有非有限值），并且\n  - 重缩放的诊断量不比未重缩放的差一个相对容差以上，且至少有一个在容差范围内严格更优：\n  $$\n  \\left(\\mathrm{TV}(u_{\\mathrm{R}})\\le (1+\\tau)\\,\\mathrm{TV}(u_{\\mathrm{U}})\\right)\\ \\wedge\\ \\left(\\mathrm{HF}(u_{\\mathrm{R}})\\le (1+\\tau)\\,\\mathrm{HF}(u_{\\mathrm{U}})\\right)\\ \\wedge\\ \\left(\\mathrm{TV}(u_{\\mathrm{R}})  \\mathrm{TV}(u_{\\mathrm{U}})\\ \\vee\\ \\mathrm{HF}(u_{\\mathrm{R}})  \\mathrm{HF}(u_{\\mathrm{U}})\\right).\n  $$\n\n要求的单位约定：\n- 全程使用几何单位制，其中 $c=1$ 且 $G=1$。所有报告的诊断量均为无量纲。无需打印任何物理单位。\n\n测试套件：\n- 您的程序必须评估以下测试用例，每个用例指定为一个元组 $(N,\\mathrm{CFL},A,\\nu)$：\n  1. $(N,\\mathrm{CFL},A,\\nu) = (256,\\,0.4,\\,1.0,\\,10^{-3})$，\n  2. $(N,\\mathrm{CFL},A,\\nu) = (64,\\,0.9,\\,1.0,\\,2\\times 10^{-3})$，\n  3. $(N,\\mathrm{CFL},A,\\nu) = (128,\\,0.6,\\,5.0,\\,10^{-3})$，\n  4. $(N,\\mathrm{CFL},A,\\nu) = (128,\\,0.6,\\,0.0,\\,10^{-3})$。\n这些用例共同探究了一个平衡的“理想路径”、一个接近库朗极限的粗网格情况、一个强间断情况以及一个无间断的基线情况。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，按测试套件的顺序排列结果，其中每个条目都是一个布尔值，指示根据上述规则共形重缩放是否有助于稳定性。例如，一个有效的输出如下所示\n$$\n[\\mathrm{True},\\mathrm{False},\\mathrm{True},\\mathrm{True}].\n$$\n不应打印任何其他文本。",
            "solution": "该问题要求设计并实现一个数值实验，以研究在存在间断的情况下，共形重缩放（爱因斯坦场方程的 Baumgarte–Shapiro–Shibata–Nakamura (BSSN) 形式体系的一个关键特征）对数值稳定性的作用。该研究使用一个简化的一维代理模型进行。\n\n问题的基础是爱因斯坦场方程 $G_{\\mu\\nu}=8\\pi T_{\\mu\\nu}$，其中假设使用几何单位制 ($G=c=1$)。BSSN 形式体系引入了空间度规的共形分解 $\\gamma_{ij} = e^{4\\phi}\\tilde{\\gamma}_{ij}$，并带有约束条件，即共形度规 $\\tilde{\\gamma}_{ij}$ 的行列式为单位值，$\\det \\tilde{\\gamma}_{ij}=1$。这个约束对数值解的稳定性至关重要。应力-能量张量 $T_{\\mu\\nu}$ 中的间断（例如中子星表面的间断）在度规和曲率分量的演化方程中表现为间断的源项。\n\n为了研究在处理此类间断时 BSSN 共形约束对稳定性的影响，我们将完整系统的复杂性降低到一个一维代理受迫波动方程。状态由一个标量场 $u(x,t)$（代表一个度规自由度）及其时间导数 $v(x,t) = \\partial_t u(x,t)$ 描述。动力学由以下系统控制：\n$$\n\\partial_t u(x,t) = v(x,t)\n$$\n$$\n\\partial_t v(x,t) = \\partial_x^2 u(x,t) + s(x) + \\nu \\partial_x^2 v(x,t)\n$$\n在这里，我们设置波速为 $c=1$。在定义域 $x \\in [0,1]$ 上的一个静态、间断的源项 $s(x) = A\\,H(x-0.5)$ 模拟了物质源 $T_{\\mu\\nu}$ 中的一个激波。项 $\\nu \\partial_x^2 v(x,t)$ 是一个人工粘性项，是一种用于耗散高频数值噪音和在激波附近正则化解的标准技术。\n\n实验的核心是比较两种形式体系：\n1.  **未重缩放形式体系**：系统按上述方式演化。源项的空间平均值 $\\langle s \\rangle = \\int_0^1 s(x)dx / \\int_0^1 dx$ 驱动状态变量的空间平均值。具体来说，$\\partial_t \\langle v \\rangle = \\langle s \\rangle$，导致 $\\langle v \\rangle$ 无界线性增长，$\\langle u \\rangle$ 二次增长。这会污染数值解。\n2.  **共形重缩放形式体系**：该形式体系模拟了 BSSN 约束 $\\det\\tilde{\\gamma}_{ij}=1$。该约束移除了空间体积模式，该模式对应于零波数（空间平均）分量。在我们的代理模型中，这是通过在每个时间积分子步后显式地投影出状态变量的空间平均值来实现的。对于一个场 $f(x,t)$，投影为 $f \\to f - \\langle f \\rangle$，其中 $\\langle f \\rangle = L^{-1}\\int_0^L f(x,t)dx$。这在整个演化过程中强制 $\\langle u \\rangle = 0$ 和 $\\langle v \\rangle = 0$。\n\n数值实现过程如下：\n空间定义域 $x \\in [0,1]$ 使用 $N$ 个均匀间隔的网格点进行离散化，网格间距为 $\\Delta x = 1/N$。二阶空间导数 $\\partial_x^2$ 使用带周期性边界条件的二阶中心有限差分算子来近似：\n$$\n(\\partial_x^2 f)_j \\approx \\frac{f_{j+1} - 2 f_j + f_{j-1}}{(\\Delta x)^2}\n$$\n其中 $f_j = f(x_j)$，索引对 $N$ 取模。\n\n从 $t=0$ 到 $T=2.0$ 的时间演化是使用一个三阶段、三阶强保稳龙格-库塔 (SSP-RK3) 方法进行的。对于一个常微分方程组 $\\dot{\\mathbf{y}} = \\mathcal{L}(\\mathbf{y})$，其中 $\\mathbf{y} = (u,v)^T$，从时间 $t_n$ 到 $t_{n+1}=t_n+\\Delta t$ 的更新为：\n$$\n\\begin{aligned}\n\\mathbf{y}^{(1)} = \\mathbf{y}_n + \\Delta t \\, \\mathcal{L}(\\mathbf{y}_n) \\\\\n\\mathbf{y}^{(2)} = \\frac{3}{4}\\mathbf{y}_n + \\frac{1}{4}\\mathbf{y}^{(1)} + \\frac{1}{4}\\Delta t \\, \\mathcal{L}(\\mathbf{y}^{(1)}) \\\\\n\\mathbf{y}_{n+1} = \\frac{1}{3}\\mathbf{y}_n + \\frac{2}{3}\\mathbf{y}^{(2)} + \\frac{2}{3}\\Delta t \\, \\mathcal{L}(\\mathbf{y}^{(2)})\n\\end{aligned}\n$$\n在共形重缩放形式体系中，投影操作 $(\\mathbf{y} \\to \\mathbf{y} - \\langle\\mathbf{y}\\rangle)$ 在这三个阶段（$\\mathbf{y}^{(1)}$、$\\mathbf{y}^{(2)}$ 和 $\\mathbf{y}_{n+1}$）中的每一个之后应用于状态向量。时间步长 $\\Delta t$ 由库朗-弗里德里希斯-列维 (CFL) 条件 $\\Delta t = \\mathrm{CFL}\\,\\Delta x$ 决定。\n\n为评估稳定性，对最终解 $u(x,T)$ 计算两个诊断量：\n1.  **总变差 ($\\mathrm{TV}$)**：这测量了在 $x=0.5$ 处间断点附近的振荡。它是在以间断点为中心的 $2W$ 个网格点的窗口上计算的：\n    $$\n    \\mathrm{TV}(u) = \\sum_{k=-W}^{W-1} \\left|u(x_{j_0+k+1},T) - u(x_{j_0+k},T)\\right|\n    $$\n    其中 $j_0=\\lfloor 0.5/\\Delta x\\rfloor$ 且 $W=\\lfloor N/20\\rfloor$。较低的 $\\mathrm{TV}$ 值表明对伪振荡的抑制效果更好。\n2.  **高频成分 ($\\mathrm{HF}$)**：这量化了整个定义域上的网格尺度噪音。它被定义为离散二阶差分算子 $\\Delta_x u_j = u_{j+1} - 2u_j + u_{j-1}$ 的均方根：\n    $$\n    \\mathrm{HF}(u) = \\left(\\frac{1}{N}\\sum_{j=0}^{N-1}\\left[\\Delta_x u(x_j,T)\\right]^2\\right)^{1/2}\n    $$\n    较低的 $\\mathrm{HF}$ 值表示解更平滑、噪音更少。\n\n基于未重缩放 ($u_U$) 和重缩放 ($u_R$) 解的这些诊断量，来决定共形重缩放是否有助于稳定性。给定容差 $\\tau=0.01$，当且仅当两次运行都无数值失败地完成，重缩放运行的诊断量不显著差于未重缩放的运行，且至少有一个诊断量严格更优时，重缩放被认为是有益的：\n$$\n\\left(\\mathrm{TV}(u_{\\mathrm{R}})\\le (1+\\tau)\\,\\mathrm{TV}(u_{\\mathrm{U}})\\right)\\ \\wedge\\ \\left(\\mathrm{HF}(u_{\\mathrm{R}})\\le (1+\\tau)\\,\\mathrm{HF}(u_{\\mathrm{U}})\\right)\\ \\wedge\\ \\left(\\mathrm{TV}(u_{\\mathrm{R}})  \\mathrm{TV}(u_{\\mathrm{U}})\\ \\vee\\ \\mathrm{HF}(u_{\\mathrm{R}})  \\mathrm{HF}(u_{\\mathrm{U}})\\right)\n$$\n此程序应用于所提供的测试套件中的每个案例。对于源振幅 $A=0$ 的基线情况，预计两种形式体系都将产生平凡解 $u=0$，导致所有诊断量均为零，并且决策为 `False`，因为不可能有严格的改进。对于 $A \\neq 0$ 的情况，在重缩放形式体系中移除增长的平均模式有望提高解的质量，从而导致决策为 `True`。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the numerical experiment and print the results.\n    \"\"\"\n\n    def d2(f, dx):\n        \"\"\"\n        Computes the second-order centered finite difference approximation of the\n        second derivative with periodic boundary conditions.\n        f: The function values on the grid (numpy array).\n        dx: The grid spacing.\n        \"\"\"\n        return (np.roll(f, -1) - 2 * f + np.roll(f, 1)) / (dx**2)\n\n    def project(u, v):\n        \"\"\"\n        Projects out the spatial mean from the state variables u and v.\n        \"\"\"\n        u_proj = u - np.mean(u)\n        v_proj = v - np.mean(v)\n        return u_proj, v_proj\n\n    def run_simulation(N, CFL, A, nu, apply_rescaling):\n        \"\"\"\n        Runs a single simulation for a given set of parameters.\n        \"\"\"\n        L = 1.0\n        T_final = 2.0\n        dx = L / N\n        dt = CFL * dx  # c=1\n\n        # Adjust dt to hit T_final exactly\n        if dt > 0:\n            num_steps = int(np.ceil(T_final / dt))\n            dt = T_final / num_steps\n        else: # Handle CFL=0 case\n            num_steps = 1\n\n        x = np.linspace(0, L, N, endpoint=False)\n        \n        # Initialize fields\n        u = np.zeros(N, dtype=np.float64)\n        v = np.zeros(N, dtype=np.float64)\n        \n        # Source term: A * Heaviside(x - 0.5)\n        s = A * (x >= 0.5).astype(np.float64)\n        \n        # Time evolution loop using SSP-RK3\n        for _ in range(num_steps):\n            # State at step n: (u, v)\n            \n            # Substep 1\n            u_rhs1 = v\n            v_rhs1 = d2(u, dx) + s + nu * d2(v, dx)\n            u1 = u + dt * u_rhs1\n            v1 = v + dt * v_rhs1\n            if apply_rescaling:\n                u1, v1 = project(u1, v1)\n            \n            # Substep 2\n            u_rhs2 = v1\n            v_rhs2 = d2(u1, dx) + s + nu * d2(v1, dx)\n            u2 = 0.75 * u + 0.25 * u1 + 0.25 * dt * u_rhs2\n            v2 = 0.75 * v + 0.25 * v1 + 0.25 * dt * v_rhs2\n            if apply_rescaling:\n                u2, v2 = project(u2, v2)\n                \n            # Substep 3 (final update)\n            u_rhs3 = v2\n            v_rhs3 = d2(u2, dx) + s + nu * d2(v2, dx)\n            u_next = (1./3.) * u + (2./3.) * u2 + (2./3.) * dt * u_rhs3\n            v_next = (1./3.) * v + (2./3.) * v2 + (2./3.) * dt * v_rhs3\n            if apply_rescaling:\n                u_next, v_next = project(u_next, v_next)\n                \n            u, v = u_next, v_next\n            \n            # Check for numerical failure\n            if not (np.all(np.isfinite(u)) and np.all(np.isfinite(v))):\n                break\n\n        return u, v\n\n    def calculate_tv(u, N, dx):\n        \"\"\"\n        Calculates the Total Variation diagnostic.\n        \"\"\"\n        j0 = int(0.5 / dx)\n        W = int(N / 20)\n        \n        tv_sum = 0.0\n        for k in range(-W, W):\n            idx1 = (j0 + k) % N\n            idx2 = (j0 + k + 1) % N\n            tv_sum += np.abs(u[idx2] - u[idx1])\n        return tv_sum\n\n    def calculate_hf(u, N, dx):\n        \"\"\"\n        Calculates the High-Frequency content diagnostic.\n        \"\"\"\n        # The problem defines Delta_x as the discrete second-difference operator,\n        # which is d2(u, dx) * dx**2\n        second_diff = d2(u, dx) * (dx**2)\n        hf_val = np.sqrt(np.mean(second_diff**2))\n        return hf_val\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (256, 0.4, 1.0, 1e-3),\n        (64, 0.9, 1.0, 2e-3),\n        (128, 0.6, 5.0, 1e-3),\n        (128, 0.6, 0.0, 1e-3)\n    ]\n\n    results = []\n    tau = 0.01\n\n    for case in test_cases:\n        N, CFL, A, nu = case\n        dx = 1.0 / N\n        \n        # Unrescaled run\n        u_U, v_U = run_simulation(N, CFL, A, nu, apply_rescaling=False)\n        if not np.all(np.isfinite(u_U)):\n            results.append(False)\n            continue\n            \n        # Rescaled run\n        u_R, v_R = run_simulation(N, CFL, A, nu, apply_rescaling=True)\n        if not np.all(np.isfinite(u_R)):\n            results.append(False)\n            continue\n            \n        # Calculate diagnostics\n        tv_U = calculate_tv(u_U, N, dx)\n        hf_U = calculate_hf(u_U, N, dx)\n        \n        tv_R = calculate_tv(u_R, N, dx)\n        hf_R = calculate_hf(u_R, N, dx)\n        \n        # Apply the decision rule\n        # Rescaled is not worse than unrescaled by more than tolerance\n        cond_not_worse_tv = tv_R = (1 + tau) * tv_U\n        cond_not_worse_hf = hf_R = (1 + tau) * hf_U\n        \n        # At least one is strictly better\n        cond_strictly_better = (tv_R  tv_U) or (hf_R  hf_U)\n        \n        is_aided = cond_not_worse_tv and cond_not_worse_hf and cond_strictly_better\n        results.append(is_aided)\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}