{
    "hands_on_practices": [
        {
            "introduction": "掌握 $3+1$ 分解的关键在于动手实践。我们的第一个练习将从最基础的例子——平直的闵可夫斯基时空——开始，这是验证和理解整个形式体系的逻辑起点。通过计算这种最简单情况下的感应度规 $\\gamma_{ij}$ 和外曲率 $K_{ij}$，您将验证该理论的自洽性，并为这两个核心张量的物理意义建立起坚实的直观理解 。",
            "id": "3492251",
            "problem": "考虑在全局惯性坐标 $(t,x,y,z)$ 下的闵可夫斯基时空，其线元为 $ds^{2}=-dt^{2}+dx^{2}+dy^{2}+dz^{2}$。在 $G=c=1$ 的几何单位制下，使用超曲面 $t=\\text{const}$ 进行 $(3+1)$ 分解，其中衰减函数 $\\alpha=1$ 且移位向量 $\\beta^{i}=0$。从 Arnowitt-Deser-Misner (ADM) 形式体系中适用于 $(3+1)$ 分解的协变定义出发，即每个切片上的诱导空间度规是时空度规的拉回，并且外曲率是指向未来的单位法向量对切片协变导数的负空间投影，计算在 $t=\\text{const}$ 切片上的诱导空间度规 $\\gamma_{ij}$ 和外曲率 $K_{ij}$ 的具体分量。然后，仅使用 $(3+1)$ 形式下的标准真空爱因斯坦约束方程，论证为何这些数据平凡地满足哈密顿约束和动量约束。最后，报告在这些切片上计算的真空哈密顿约束标量 $\\mathcal{H}$ 的值。将最终答案表示为一个不带单位的实数。",
            "solution": "该问题要求对闵可夫斯基时空进行 $(3+1)$ 分解，以计算特定切片的诱导空间度规 $\\gamma_{ij}$ 和外曲率 $K_{ij}$，然后验证这些量满足真空爱因斯坦约束方程。\n\n该时空是闵可夫斯基时空，在全局惯性坐标 $(t, x, y, z)$ 下的线元描述为：\n$$ds^2 = g_{\\mu\\nu} dx^\\mu dx^\\nu = -dt^2 + dx^2 + dy^2 + dz^2$$\n时空度规张量 $g_{\\mu\\nu}$ 及其逆 $g^{\\mu\\nu}$ 为：\n$$g_{\\mu\\nu} = \\eta_{\\mu\\nu} = \\begin{pmatrix} -1  0  0  0 \\\\ 0  1  0  0 \\\\ 0  0  1  0 \\\\ 0  0  0  1 \\end{pmatrix}, \\quad g^{\\mu\\nu} = \\eta^{\\mu\\nu} = \\begin{pmatrix} -1  0  0  0 \\\\ 0  1  0  0 \\\\ 0  0  1  0 \\\\ 0  0  0  1 \\end{pmatrix}$$\n时空被一族由 $t = \\text{const}$ 定义的类空超曲面 $\\Sigma_t$ 所叶化。指向未来的单位法向量场 $n^\\mu$ 对此分解至关重要。标量函数 $t$ 的梯度为 $\\nabla_\\mu t = \\delta_\\mu^0 = (1, 0, 0, 0)$。协变法向量 $n_\\mu$ 通过 $n_\\mu = -\\alpha \\nabla_\\mu t$ 与此梯度相关。给定衰减函数 $\\alpha=1$，我们有：\n$$n_\\mu = -1 \\cdot \\delta_\\mu^0 = (-1, 0, 0, 0)$$\n我们可以验证该向量是归一化的，即 $n_\\mu n^\\mu = -1$。通过度规提升指标可以找到其逆变分量：\n$$n^\\mu = g^{\\mu\\nu} n_\\nu = \\eta^{\\mu\\nu} n_\\nu = \\eta^{00} n_0 = (-1)(-1) = 1$$\n所以，$n^\\mu = (1, 0, 0, 0)$。由于 $n^0  0$，该向量指向未来。移位向量 $\\beta^i$ 给定为 $\\beta^i = 0$。\n\n首先，我们计算诱导空间度规 $\\gamma_{ij}$。超曲面上的诱导度规张量是四维时空度规在切片上的投影，定义为：\n$$\\gamma_{\\mu\\nu} = g_{\\mu\\nu} + n_\\mu n_\\nu$$\n代入 $g_{\\mu\\nu}$ 和 $n_\\mu$ 的分量：\n$$\\gamma_{00} = g_{00} + n_0 n_0 = -1 + (-1)(-1) = -1 + 1 = 0$$\n$$\\gamma_{0i} = g_{0i} + n_0 n_i = 0 + (-1)(0) = 0$$\n$$\\gamma_{i0} = g_{i0} + n_i n_0 = 0 + (0)(-1) = 0$$\n$$\\gamma_{ij} = g_{ij} + n_i n_j = \\delta_{ij} + (0)(0) = \\delta_{ij}$$\n这里，指标 $i, j$ 的取值范围为 1 到 3 (代表空间坐标 $x, y, z$)，$\\delta_{ij}$ 是克罗内克 $\\delta$。完整的投影张量为：\n$$\\gamma_{\\mu\\nu} = \\begin{pmatrix} 0  0  0  0 \\\\ 0  1  0  0 \\\\ 0  0  1  0 \\\\ 0  0  0  1 \\end{pmatrix}$$\n诱导空间度规 $\\gamma_{ij}$ 由 $\\gamma_{\\mu\\nu}$ 的空间分量组成。因此：\n$$\\gamma_{ij} = \\delta_{ij} = \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix}$$\n这是平直三维欧几里得空间的度规，正如对闵可夫斯基时空的空间切片所预期的那样。\n\n接下来，我们计算外曲率 $K_{ij}$。问题将其定义为指向未来的单位法向量的协变导数的负空间投影。完整的外曲率张量由 $K_{\\mu\\nu} = -\\gamma_\\mu^\\alpha \\nabla_\\alpha n_\\nu$ 给出，其中 $\\gamma_\\mu^\\alpha = \\delta_\\mu^\\alpha + n^\\alpha n_\\mu$ 是投影算子。分量 $K_{ij}$ 是该张量的空间分量。\n协变导数为 $\\nabla_\\alpha n_\\nu = \\partial_\\alpha n_\\nu - \\Gamma^\\lambda_{\\alpha\\nu} n_\\lambda$。在具有全局惯性坐标的闵可夫斯基时空中，所有度规分量都是常数。因此，所有的第一类和第二类克里斯托费尔符号都为零：$\\Gamma^\\lambda_{\\alpha\\nu} = 0$。\n协变导数简化为偏导数：\n$$\\nabla_\\alpha n_\\nu = \\partial_\\alpha n_\\nu$$\n向量场 $n_\\nu = (-1, 0, 0, 0)$ 在整个时空中是恒定的。因此，它对任何坐标的偏导数都为零：\n$$\\partial_\\alpha n_\\nu = 0$$\n这立即意味着外曲率张量处处为零：\n$$K_{\\mu\\nu} = 0$$\n因此，空间分量 $K_{ij}$ 也为零：\n$$K_{ij} = 0$$\n这个结果表明 $t=\\text{const}$ 超曲面是“平坦地”嵌入在平直的四维时空中的。\n\n现在，我们必须论证为什么这个初始数据集 $(\\gamma_{ij}, K_{ij})$ 平凡地满足真空爱因斯坦约束方程。真空约束是哈密顿约束和动量约束。\n\n哈密顿约束为：\n$$\\mathcal{H} \\equiv R^{(3)} + (\\text{Tr}(K))^2 - K_{ij}K^{ij} = 0$$\n这里，$R^{(3)}$ 是三维度规 $\\gamma_{ij}$ 的里奇标量，$\\text{Tr}(K) = \\gamma^{ij}K_{ij}$ 是外曲率的迹，$K_{ij}K^{ij} = K_{ij}\\gamma^{ik}\\gamma^{jl}K_{kl}$。\n让我们用我们计算出的数据来评估每一项：\n1. 诱导度规是 $\\gamma_{ij} = \\delta_{ij}$，这是平直欧几里得 3 维空间的度规。对于这个平直度规，黎曼曲率张量为零。因此，其里奇张量和里奇标量也为零。于是，$R^{(3)} = 0$。\n2. 外曲率 $K_{ij} = 0$。这意味着它的迹为零，$\\text{Tr}(K) = 0$，二次项 $K_{ij}K^{ij}$ 也为零。\n将这些代入哈密顿约束方程，得到：\n$$\\mathcal{H} = 0 + (0)^2 - 0 = 0$$\n哈密顿约束被平凡地满足了。\n\n动量（或微分同胚）约束为：\n$$\\mathcal{M}_i \\equiv D_j K^j_i - D_i (\\text{Tr}(K)) = 0$$\n这里，$D_j$ 是与三维度规 $\\gamma_{ij}$ 相容的协变导数算子。\n让我们评估这些项：\n1. 由于 $K_{ij} = 0$，其混合指标形式 $K^j_i = \\gamma^{jk}K_{ki}$ 也为零。\n2. 迹 $\\text{Tr}(K)$ 也为零。\n动量约束方程变为：\n$$\\mathcal{M}_i = D_j(0) - D_i(0) = 0 - 0 = 0$$\n零张量的协变导数为零。因此，动量约束也被平凡地满足了。\n\n对于这种简单切片下的平直闵可夫斯基时空的初始数据 $(\\gamma_{ij}=\\delta_{ij}, K_{ij}=0)$，是真空爱因斯坦约束方程的平凡解。\n\n最后，问题要求在这些切片上计算的真空哈密顿约束标量 $\\mathcal{H}$ 的值。正如在哈密顿约束的分析中所展示的：\n$$\\mathcal{H} = R^{(3)} + (\\text{Tr}(K))^2 - K_{ij}K^{ij} = 0 + 0 - 0 = 0$$\n哈密顿约束标量的值为 $0$。",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "在掌握了平直时空之后，下一个逻辑步骤是研究静态的弯曲时空。本练习将分析史瓦西黑洞，这是广义相对论中一个标志性的解。此练习旨在阐明空间切片的内蕴曲率（由三维里奇标量 $R^{(3)}$ 描述）与外曲率 $K_{ij}$ 之间的区别，并展示一个弯曲的空间如何能以时间对称的方式（即 $K_{ij}=0$）嵌入到四维时空中 。",
            "id": "3492243",
            "problem": "考虑史瓦西坐标（曲率坐标）下的史瓦西时空，其线元为\n$$\nds^{2} = -\\left(1 - \\frac{2M}{r}\\right) dt^{2} + \\left(1 - \\frac{2M}{r}\\right)^{-1} dr^{2} + r^{2}\\left(d\\theta^{2} + \\sin^{2}\\theta\\, d\\phi^{2}\\right),\n$$\n其中 $M$ 是质量参数，并使用 $G=c=1$ 的几何单位制。使用 Arnowitt–Deser–Misner (ADM) $3+1$分解，找出退失函数 $\\alpha$ 和移动向量 $\\beta^{i}$，并计算在 $t=\\text{const}$ 切片上的诱导空间 $3$-度规 $\\gamma_{ij}$。根据 ADM 形式中外在曲率 $K_{ij}$ 的基本定义，判断这些切片是否为时间对称的初始数据。然后，从第一性原理（列维-奇维塔联络和里奇曲率的定义）出发，计算你找到的 $t=\\text{const}$ 空间度规的三维里奇标量 $R^{(3)}$，并检验真空哈密顿约束\n$$\nR^{(3)} + K^{2} - K_{ij}K^{ij} = 16\\pi \\rho,\n$$\n其中 $K \\equiv \\gamma^{ij}K_{ij}$，$\\rho$ 是垂直于切片的观测者测量的能量密度。假设真空 $\\rho=0$。报告这些切片上 $R^{(3)}$ 的精确值作为你的最终答案。不需要四舍五入，最终答案框中不应包含单位。",
            "solution": "此问题要求我们对史瓦西时空进行 $3+1$ 分解，并计算其几何量。\n时空度规的一般ADM形式为\n$$ds^{2} = -(\\alpha^{2} - \\beta_{i}\\beta^{i})dt^{2} + 2\\beta_{i}dx^{i}dt + \\gamma_{ij}dx^{i}dx^{j}$$\n其中 $\\alpha$ 是退失函数，$\\beta^{i}$ 是移动向量，$\\gamma_{ij}$ 是空间切片上的 $3$-度规。指标 $i, j$ 遍历空间坐标，在此例中为 $(r, \\theta, \\phi)$。\n\n给定的史瓦西度规是\n$$ds^{2} = -\\left(1 - \\frac{2M}{r}\\right) dt^{2} + \\left(1 - \\frac{2M}{r}\\right)^{-1} dr^{2} + r^{2}d\\theta^{2} + r^{2}\\sin^{2}\\theta\\, d\\phi^{2}$$\n通过将史瓦西度规与一般ADM形式进行比较，我们可以确定各个ADM量。空间坐标为 $x^1=r, x^2=\\theta, x^3=\\phi$。\n度规的非对角项 $g_{ti}$ 对应于 $\\beta_i$。在史瓦西坐标下，这些项均为零，因此协变移动向量 $\\beta_i = 0$，其逆变分量 $\\beta^i$ 也为零。\n\n对角项 $g_{tt}$ 由 $g_{tt} = -(\\alpha^2 - \\beta_i \\beta^i)$ 给出。由于 $\\beta_i=0$，我们有 $g_{tt} = -\\alpha^2$。\n与给定的度规比较，\n$$-\\alpha^2 = -\\left(1 - \\frac{2M}{r}\\right) \\implies \\alpha = \\sqrt{1 - \\frac{2M}{r}}$$\n度规的空间部分 $g_{ij}$ 对应于诱导 $3$-度规 $\\gamma_{ij}$。因此，$\\gamma_{ij}$ 的非零分量为：\n$$\\gamma_{rr} = \\left(1 - \\frac{2M}{r}\\right)^{-1}, \\quad \\gamma_{\\theta\\theta} = r^{2}, \\quad \\gamma_{\\phi\\phi} = r^{2}\\sin^{2}\\theta$$\n\n接下来，我们计算外在曲率 $K_{ij}$。其一般定义为 $K_{ij} = -\\frac{1}{2\\alpha}(\\partial_t \\gamma_{ij} - D_i \\beta_j - D_j \\beta_i)$，其中 $D_i$ 是与 $3$-度规 $\\gamma_{ij}$ 相容的协变导数。\n史瓦西度规是静态的，意味着其分量不依赖于时间坐标 $t$。因此，$\\partial_t \\gamma_{ij} = 0$。我们还确定了移动向量为零，$\\beta_i=0$。\n将这些代入 $K_{ij}$ 的定义中：\n$$K_{ij} = -\\frac{1}{2\\alpha}(0 - 0 - 0) = 0$$\n外在曲率张量的所有分量都为零。如果一个空间切片的外在曲率为零，则它被定义为时间对称的。因此，史瓦西时空的 $t=\\text{const}$ 切片是时间对称的。\n\n最后的任务是计算空间度规 $\\gamma_{ij}$ 的三维里奇标量 $R^{(3)}$。对于球对称度规，可以通过标准公式计算里奇张量 $R^{(3)}_{ij}$ 的分量。对于 $\\gamma_{ij}$，我们有：\n$$R^{(3)}_{rr} = -\\frac{2M}{r^3(1-2M/r)}$$\n$$R^{(3)}_{\\theta\\theta} = \\frac{M}{r}$$\n$$R^{(3)}_{\\phi\\phi} = R^{(3)}_{\\theta\\theta} \\sin^2\\theta = \\frac{M}{r}\\sin^2\\theta$$\n里奇标量由 $R^{(3)} = \\gamma^{ij} R^{(3)}_{ij} = \\gamma^{rr}R^{(3)}_{rr} + \\gamma^{\\theta\\theta}R^{(3)}_{\\theta\\theta} + \\gamma^{\\phi\\phi}R^{(3)}_{\\phi\\phi}$ 给出。\n逆度规 $\\gamma^{ij}$ 的非零分量为：\n$$\\gamma^{rr} = 1-\\frac{2M}{r}, \\quad \\gamma^{\\theta\\theta} = \\frac{1}{r^2}, \\quad \\gamma^{\\phi\\phi} = \\frac{1}{r^2\\sin^2\\theta}$$\n将各分量代入：\n$$R^{(3)} = \\left(1-\\frac{2M}{r}\\right) \\left(-\\frac{2M}{r^3(1-2M/r)}\\right) + \\frac{1}{r^2}\\left(\\frac{M}{r}\\right) + \\frac{1}{r^2\\sin^2\\theta}\\left(\\frac{M}{r}\\sin^2\\theta\\right)$$\n$$R^{(3)} = -\\frac{2M}{r^3} + \\frac{M}{r^3} + \\frac{M}{r^3} = 0$$\n空间切片的里奇标量为零。这意味着史瓦西几何的 $t=\\text{const}$ 空间超曲面是里奇平坦的，尽管它不是内蕴平坦的（其完整的黎曼曲率张量非零）。\n\n最后，我们检验真空哈密顿约束：$R^{(3)} + K^2 - K_{ij}K^{ij} = 16\\pi \\rho$。\n在真空条件下，能量密度 $\\rho=0$，方程右边为 $0$。\n在方程左边，我们计算出 $R^{(3)}=0$。我们还发现外在曲率 $K_{ij}=0$，这意味着它的迹 $K = \\gamma^{ij}K_{ij} = 0$ 且二次项 $K_{ij}K^{ij} = 0$。\n哈密顿约束变为 $0 + 0^2 - 0 = 0$，该约束得到满足。这为我们计算 $R^{(3)}$ 提供了一个有力的一致性检验。\n\n问题要求报告 $R^{(3)}$ 的精确值。我们的计算表明它为零。",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "最后的练习将解析理论与数值相对论的实际应用联系起来，解决为黑洞并合等动态现象构造初始数据的核心挑战。本练习采用 Bowen-York 形式体系来构建一个带有线动量的黑洞的初始数据，并介绍了处理奇点的“穿刺”（puncture）技术和相应的正则化方法。通过计算和评估哈密顿及动量约束的违反程度，您将直接体验到数值模拟中评估初始数据质量的关键步骤 。",
            "id": "3492261",
            "problem": "考虑一个单一的、时间对称的黑洞穿刺初始数据集，在几何单位制中 $G = c = 1$。使用时空的 $3+1$ 分解，其中诱导三维引力场为 $\\gamma_{ij}$，外在曲率为 $K_{ij}$。假设在初始时刻为共形平坦和极大切片，因此空间里奇标量为 $R=0$，外在曲率的迹为 $K \\equiv \\gamma^{ij} K_{ij} = 0$。在原点放置一个穿刺点，并赋予其一个沿 $z$ 轴的非零线性动量。在一个覆盖 $[-L,L]^3$ 的均匀立方网格上进行计算，每个维度有 $N$ 个点，使用单元中心坐标（以使网格避开精确的穿刺点），并对空间导数使用中心有限差分。\n\n从 $3+1$ 形式和共形横向无迹方法出发，使用经过充分检验的 Bowen–York 构造来获得与沿 $z$ 轴携带线性动量的单个穿刺点相关的无迹外在曲率。在共形平坦背景和 $K=0$ 的初始时刻，采用得到的 $K_{ij}$ 场作为数据来评估约束。实现对穿刺奇点的两种处理方法：\n- 正则化：将 $K_{ij}$ 乘以一个平滑窗函数 $f(r;\\epsilon)$，该函数在 $r=0$ 处为零，并在远离穿刺点处趋近于 $1$，其中 $f(r;\\epsilon) = \\frac{r^2}{r^2 + \\epsilon^2}$，平滑尺度 $\\epsilon  0$。\n- 切除：保持 $K_{ij}$ 不变，但在汇总残差时排除 $r  r_{\\mathrm{exc}}$ 的网格点。\n\n使用约束的定义，\n$$\\mathcal{H} \\equiv R + K^2 - K_{ij} K^{ij}, \\quad \\mathcal{M}^i \\equiv D_j \\left( K^{ij} - \\gamma^{ij} K \\right),$$\n并在 $R=0$、$K=0$ 且 $\\gamma_{ij} = \\delta_{ij}$ 的假设下（因此 $D_j$ 简化为 $\\partial_j$，指标的升降通过 $\\delta_{ij}$ 完成），在网格上计算：\n- 哈密顿约束残差 $\\mathcal{H}$。\n- 动量约束残差向量 $\\mathcal{M}^i$。\n\n通过在选定网格点上的均方根值来汇总这些残差，\n$$\\mathrm{RMS}_{\\mathcal{H}} = \\sqrt{\\frac{1}{\\mathcal{N}} \\sum_{\\mathrm{mask}} \\left(\\mathcal{H}\\right)^2}, \\quad \\mathrm{RMS}_{\\mathcal{M}} = \\sqrt{\\frac{1}{\\mathcal{N}} \\sum_{\\mathrm{mask}} \\left(\\mathcal{M}^x\\right)^2 + \\left(\\mathcal{M}^y\\right)^2 + \\left(\\mathcal{M}^z\\right)^2},$$\n其中求和遍历由掩码包含的网格点（正则化情况下为所有点，或切除情况下仅为 $r \\ge r_{\\mathrm{exc}}$ 的点），$\\mathcal{N}$ 是包含点的数量。在几何单位制中，所有量都是无量纲的。对任何与角度相关的量隐式使用弧度。\n\n数值实现以下域和离散化：\n- $L = 1$ 和一个偶数整数 $N$，以使单元中心网格避开 $r=0$；使用 $N=48$。\n- 线性动量大小 $P$ 是无量纲的，并设定了 $K_{ij}$ 的尺度。\n- 空间导数使用中心有限差分，均匀间距为 $\\Delta x = \\Delta y = \\Delta z$。\n\n你的程序必须计算以下测试套件，每个案例产生一对 $[\\mathrm{RMS}_{\\mathcal{H}},\\mathrm{RMS}_{\\mathcal{M}}]$：\n1. 正则化，$\\epsilon = 0.05 L$，$r_{\\mathrm{exc}} = 0$，$P = 0.1$。\n2. 更强的正则化，$\\epsilon = 0.20 L$，$r_{\\mathrm{exc}} = 0$，$P = 0.1$。\n3. 切除， $r_{\\mathrm{exc}} = 0.10 L$，$\\epsilon = 0$，$P = 0.1$。\n4. 基线一致性检查，$P = 0$，正则化 $\\epsilon = 0.05 L$ 且 $r_{\\mathrm{exc}} = 0$。\n\n你的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，每个测试案例按上述顺序报告为一个包含两个浮点数的列表（例如，\"[[h1,m1],[h2,m2],[h3,m3],[h4,m4]]\"）。",
            "solution": "此问题要求对代表单个运动黑洞的近似初始数据集进行数值计算，以评估其对爱因斯坦约束方程的违背程度。该计算在广义相对论的 $3+1$ 分解框架内进行。\n\n**1. 爱因斯坦约束方程**\n在 $3+1$ 形式中，爱因斯坦场方程分为演化方程和约束方程。后者必须由选定空间切片上的初始数据满足。它们是哈密顿约束 $\\mathcal{H}=0$ 和动量约束 $\\mathcal{M}^i=0$。问题指定了一系列简化假设：极大切片 ($K=0$)、共形平坦 ($R=0$)，且背景度规为平直的 $\\gamma_{ij} = \\delta_{ij}$。在这些条件下，约束方程显著简化为：\n$$\n\\mathcal{H} = -K_{ij}K_{ij}\n$$\n$$\n\\mathcal{M}^i = \\partial_j K_{ij}\n$$\n其中 $K_{ij}K_{ij} = \\sum_{i,j=1}^3 (K_{ij})^2$。\n\n**2. Bowen-York 外在曲率**\nBowen-York 解为具有线性和角动量的黑洞提供了外在曲率。对于在平坦背景上、位于原点且线性动量为 $\\mathbf{P} = (0, 0, P)$ 的单个穿刺点，无迹外在曲率 $K_{ij}$ 的解析表达式为：\n$$\nK_{ij} = \\frac{3}{2r^2} \\left[ P_i n_j + P_j n_i - (\\delta_{ij} - n_i n_j) (P_k n^k) \\right]\n$$\n其中 $x_i = (x, y, z)$，$r = \\sqrt{x^2+y^2+z^2}$ 是距原点的坐标距离，$n_i = x_i/r$ 是径向单位向量，$P_i = (0,0,P)$。解析上，该场在除奇点 $r=0$ 外的任何地方都满足动量约束 $\\partial_j K_{ij} = 0$。然而，它不满足哈密顿约束，因为 $K_{ij}K_{ij} \\neq 0$。这是预料之中的，因为一个精确的解需要一个非平凡的共形因子 $\\psi \\neq 1$，而本问题忽略了这一点。我们的任务是数值化地量化这些约束违背。\n\n**3. 数值实现**\n我们将域 $[-L, L]^3$（其中 $L=1$）离散化到一个均匀的单元中心网格上，每个方向有 $N=48$ 个点。该网格结构自然地避开了 $r=0$ 处的奇点。在每个网格点上，我们使用上述公式计算 $K_{ij}$ 的分量，并根据测试案例处理 $r=0$ 的奇点：\n- **正则化**：将 $K_{ij}$ 的每个分量乘以一个平滑函数 $f(r;\\epsilon) = \\frac{r^2}{r^2 + \\epsilon^2}$。\n- **切除**：使用解析的 $K_{ij}$，但创建一个掩码以从最终误差求和中排除切除半径 $r_{\\mathrm{exc}}$ 内的点。\n\n一旦准备好 $K_{ij}$ 场，我们就可以计算约束残差。哈密顿残差 $\\mathcal{H}$ 在每个网格点上通过代数方法计算。动量残差向量 $\\mathcal{M}^i$ 使用二阶中心有限差分计算空间导数。最后，使用均方根 (RMS) 范数对局部约束违背进行汇总，得到两个全局度量 $\\mathrm{RMS}_{\\mathcal{H}}$ 和 $\\mathrm{RMS}_{\\mathcal{M}}$。\n\n$P=0$ 的基线情况是一个重要的一致性检查。在这种情况下，所有 $K_{ij}$ 分量都恒为零，因此 $\\mathcal{H}$ 和 $\\mathcal{M}^i$ 在所有点上都必须精确为零，其 RMS 值也为零。\n\n以下 Python 代码实现了此过程，并计算了指定测试案例的约束残差。\n\n```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes Hamiltonian and Momentum constraint residuals for Bowen-York initial data.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: Regularization\n        {'method': 'regularization', 'epsilon': 0.05, 'r_exc': 0.0, 'P': 0.1},\n        # Case 2: Stronger Regularization\n        {'method': 'regularization', 'epsilon': 0.20, 'r_exc': 0.0, 'P': 0.1},\n        # Case 3: Excision\n        {'method': 'excision', 'epsilon': 0.0, 'r_exc': 0.10, 'P': 0.1},\n        # Case 4: Baseline Consistency Check\n        {'method': 'regularization', 'epsilon': 0.05, 'r_exc': 0.0, 'P': 0.0},\n    ]\n\n    L = 1.0\n    N = 48\n    \n    # Grid setup: cell-centered grid\n    dx = 2.0 * L / N\n    coords = np.linspace(-L + 0.5 * dx, L - 0.5 * dx, N)\n    # Use 'ij' indexing to match axis order: 0->x, 1->y, 2->z\n    X, Y, Z = np.meshgrid(coords, coords, coords, indexing='ij')\n\n    R = np.sqrt(X**2 + Y**2 + Z**2)\n\n    results = []\n    for case in test_cases:\n        P = case['P']\n        epsilon = case['epsilon'] * L\n        r_exc = case['r_exc'] * L\n        \n        if P == 0:\n            results.append([0.0, 0.0])\n            continue\n\n        r_safe = np.maximum(R, 1e-16)\n        r2 = r_safe**2\n        r3 = r_safe**3\n        r5 = r_safe**5\n        \n        pre_factor = 3.0 * P / 2.0\n        \n        term_z_r3 = Z / r3\n        term_z2_r2 = Z**2 / r2\n        \n        K_xx = pre_factor * term_z_r3 * (X**2 / r2 - 1.0)\n        K_yy = pre_factor * term_z_r3 * (Y**2 / r2 - 1.0)\n        K_zz = pre_factor * term_z_r3 * (term_z2_r2 + 1.0)\n        K_xy = pre_factor * X * Y * Z / r5\n        K_xz = pre_factor * X / r3 * (term_z2_r2 + 1.0)\n        K_yz = pre_factor * Y / r3 * (term_z2_r2 + 1.0)\n\n        if case['method'] == 'regularization':\n            reg_factor = r2 / (r2 + epsilon**2)\n            K_xx *= reg_factor\n            K_yy *= reg_factor\n            K_zz *= reg_factor\n            K_xy *= reg_factor\n            K_xz *= reg_factor\n            K_yz *= reg_factor\n\n        H = - (K_xx**2 + K_yy**2 + K_zz**2 + 2 * K_xy**2 + 2 * K_xz**2 + 2 * K_yz**2)\n        \n        dKxx_dx = np.gradient(K_xx, dx, axis=0)\n        dKxy_dy = np.gradient(K_xy, dx, axis=1)\n        dKxz_dz = np.gradient(K_xz, dx, axis=2)\n        M_x = dKxx_dx + dKxy_dy + dKxz_dz\n\n        dKyx_dx = np.gradient(K_xy, dx, axis=0)\n        dKyy_dy = np.gradient(K_yy, dx, axis=1)\n        dKyz_dz = np.gradient(K_yz, dx, axis=2)\n        M_y = dKyx_dx + dKyy_dy + dKyz_dz\n\n        dKzx_dx = np.gradient(K_xz, dx, axis=0)\n        dKzy_dy = np.gradient(K_yz, dx, axis=1)\n        dKzz_dz = np.gradient(K_zz, dx, axis=2)\n        M_z = dKzx_dx + dKzy_dy + dKzz_dz\n\n        mask = R >= r_exc\n        num_points = np.sum(mask)\n\n        H_sq_masked = H[mask]**2\n        rms_H = np.sqrt(np.sum(H_sq_masked) / num_points)\n\n        M_sq_mag = M_x**2 + M_y**2 + M_z**2\n        M_sq_mag_masked = M_sq_mag[mask]\n        rms_M = np.sqrt(np.sum(M_sq_mag_masked) / num_points)\n\n        results.append([rms_H, rms_M])\n\n    case_strings = []\n    for res_pair in results:\n        case_strings.append(f\"[{res_pair[0]},{res_pair[1]}]\")\n    return f\"[{','.join(case_strings)}]\"\n\n# The function is called to generate the final string for the answer.\nfinal_answer = solve()\n```",
            "answer": "[[0.00768994770281699,0.08805218706307374],[0.0016467389475171744,0.06373801267812165],[0.009028447820120287,1.0186712396155688e-15],[0.0,0.0]]"
        }
    ]
}