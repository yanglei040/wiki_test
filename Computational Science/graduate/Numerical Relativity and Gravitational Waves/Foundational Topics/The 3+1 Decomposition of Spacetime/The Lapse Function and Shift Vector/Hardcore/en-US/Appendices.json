{
    "hands_on_practices": [
        {
            "introduction": "To begin our hands-on exploration, we must first master the fundamental mechanics of the $3+1$ decomposition. This initial practice  provides a concrete exercise in dissecting a given four-dimensional spacetime metric, $g_{\\mu\\nu}$, to extract its constituent parts: the lapse function $\\alpha$, the shift vector $\\beta^i$, and the induced spatial metric $\\gamma_{ij}$. By working through this process for a flat spacetime described in rotating coordinates, you will solidify your understanding of how the geometry of the time-slicing defines these crucial quantities.",
            "id": "3492634",
            "problem": "Consider a $(3+1)$ decomposition in the Arnowitt–Deser–Misner (ADM) formalism of General Relativity for a spacetime with coordinates $(t,r,\\phi,z)$ adapted to the foliation by hypersurfaces of constant $t$. Let the spacetime metric be the flat Minkowski metric expressed in uniformly rotating cylindrical coordinates with angular velocity $\\Omega$, obtained from inertial cylindrical coordinates $(t,r,\\phi',z)$ by the transformation $\\phi'=\\phi+\\Omega t$. In these coordinates the line element is\n$$\nds^{2} = -\\left(1 - \\Omega^{2} r^{2}\\right)\\, dt^{2} + 2\\,\\Omega r^{2}\\, dt\\, d\\phi + dr^{2} + r^{2} d\\phi^{2} + dz^{2},\n$$\nwhere $r \\ge 0$, $z \\in \\mathbb{R}$, and $\\phi \\in [0,2\\pi)$, and assume $r\\,\\Omega  1$ so that the coordinate time $t$ is timelike. Let $t^{\\mu}$ denote the coordinate time basis vector field $t^{\\mu} = (\\partial/\\partial t)^{\\mu}$.\n\nStarting from first principles, namely: the definition of the unit normal $n^{\\mu}$ to the hypersurfaces $t=\\text{const}$ via $n_{\\mu} \\propto \\nabla_{\\mu} t$ normalized by $g^{\\mu\\nu} n_{\\mu} n_{\\nu} = -1$, the induced spatial metric $\\gamma_{\\mu\\nu} = g_{\\mu\\nu} + n_{\\mu} n_{\\nu}$ pulled back to the hypersurface, and the kinematical decomposition $t^{\\mu} = \\alpha n^{\\mu} + \\beta^{\\mu}$ with $\\beta^{\\mu}$ tangent to the hypersurface ($n_{\\mu}\\beta^{\\mu}=0$), compute the induced spatial metric components $\\gamma_{ij}$, the lapse function $\\alpha$, and the shift vector components $\\beta^{i}$ for the slices $t=\\text{const}$ in the given rotating coordinate system.\n\nReport your final result as a row matrix in the order\n$$\n\\left(\\alpha,\\ \\beta^{r},\\ \\beta^{\\phi},\\ \\beta^{z},\\ \\gamma_{rr},\\ \\gamma_{r\\phi},\\ \\gamma_{rz},\\ \\gamma_{\\phi\\phi},\\ \\gamma_{\\phi z},\\ \\gamma_{zz}\\right).\n$$\nExpress your answer in terms of $r$ and $\\Omega$ as needed. No rounding is required. Do not include units in your final reported matrix.",
            "solution": "The problem requires the computation of the lapse function $\\alpha$, the shift vector components $\\beta^i$, and the induced spatial metric components $\\gamma_{ij}$ for a given spacetime metric using the Arnowitt–Deser–Misner (ADM) formalism. The spacetime is flat Minkowski space described in uniformly rotating cylindrical coordinates.\n\nThe line element is given by:\n$$ds^{2} = -\\left(1 - \\Omega^{2} r^{2}\\right)\\, dt^{2} + 2\\,\\Omega r^{2}\\, dt\\, d\\phi + dr^{2} + r^{2} d\\phi^{2} + dz^{2}$$\nThe coordinates are $(x^0, x^1, x^2, x^3) = (t, r, \\phi, z)$. The components of the covariant metric tensor $g_{\\mu\\nu}$ are read directly from the line element. Note that the coefficient of $dt d\\phi$ is $2 g_{t\\phi}$.\n$$\ng_{\\mu\\nu} = \\begin{pmatrix}\ng_{tt}  g_{tr}  g_{t\\phi}  g_{tz} \\\\\ng_{rt}  g_{rr}  g_{r\\phi}  g_{rz} \\\\\ng_{\\phi t}  g_{\\phi r}  g_{\\phi\\phi}  g_{\\phi z} \\\\\ng_{zt}  g_{zr}  g_{z\\phi}  g_{zz}\n\\end{pmatrix} = \\begin{pmatrix}\n-(1-\\Omega^2 r^2)  0  \\Omega r^2  0 \\\\\n0  1  0  0 \\\\\n\\Omega r^2  0  r^2  0 \\\\\n0  0  0  1\n\\end{pmatrix}\n$$\nThe problem is defined on hypersurfaces of constant time $t$. The coordinate time basis vector is $t^\\mu = (\\partial/\\partial t)^\\mu$, so its components are $t^\\mu = (1, 0, 0, 0)$. The fundamental quantities of the ADM formalism are derived from the decomposition of this vector field with respect to the geometry of the foliation.\n\nFirst, we compute the contravariant metric tensor $g^{\\mu\\nu}$ by finding the inverse of $g_{\\mu\\nu}$. The metric is block-diagonal with a non-trivial $2 \\times 2$ block in the $(t, \\phi)$ sector. The inverse of the submatrix\n$$\n\\begin{pmatrix} g_{tt}  g_{t\\phi} \\\\ g_{\\phi t}  g_{\\phi\\phi} \\end{pmatrix} = \\begin{pmatrix} -(1-\\Omega^2 r^2)  \\Omega r^2 \\\\ \\Omega r^2  r^2 \\end{pmatrix}\n$$\nhas a determinant $\\det = -(1-\\Omega^2 r^2)(r^2) - (\\Omega r^2)^2 = -r^2 + \\Omega^2 r^4 - \\Omega^2 r^4 = -r^2$.\nThe inverse submatrix is:\n$$\n\\begin{pmatrix} g^{tt}  g^{t\\phi} \\\\ g^{\\phi t}  g^{\\phi\\phi} \\end{pmatrix} = \\frac{1}{-r^2} \\begin{pmatrix} r^2  -\\Omega r^2 \\\\ -\\Omega r^2  -(1-\\Omega^2 r^2) \\end{pmatrix} = \\begin{pmatrix} -1  \\Omega \\\\ \\Omega  \\frac{1-\\Omega^2 r^2}{r^2} \\end{pmatrix}\n$$\nThe remaining components $g^{rr}$ and $g^{zz}$ are simply the inverses of $g_{rr}=1$ and $g_{zz}=1$. Thus, the full inverse metric is:\n$$\ng^{\\mu\\nu} = \\begin{pmatrix}\n-1  0  \\Omega  0 \\\\\n0  1  0  0 \\\\\n\\Omega  0  \\frac{1}{r^2} - \\Omega^2  0 \\\\\n0  0  0  1\n\\end{pmatrix}\n$$\nThe covector normal to the $t=\\text{const}$ hypersurfaces is proportional to the gradient of the time coordinate, $\\nabla_\\mu t = \\delta_\\mu^t = (1, 0, 0, 0)$. We can write the unit normal covector as $n_\\mu = K \\nabla_\\mu t$ for some normalization factor $K$. The normalization condition is $g^{\\mu\\nu} n_\\mu n_\\nu = -1$:\n$$ g^{\\mu\\nu} (K \\delta_\\mu^t) (K \\delta_\\nu^t) = K^2 g^{00} = -1 $$\nUsing the calculated $g^{00} = -1$, we get $K^2(-1) = -1$, which implies $K = \\pm 1$. By convention, a future-pointing normal vector $n^\\mu$ must have a positive time component ($n^0 > 0$). The contravariant normal is $n^\\mu = g^{\\mu\\nu}n_\\nu = K g^{\\mu\\nu}\\delta_\\nu^t = K g^{\\mu t}$. From our inverse metric calculation, $g^{\\mu t} = (-1, 0, \\Omega, 0)$. To ensure $n^0 = K(-1) > 0$, we must choose the normalization factor $K=-1$.\nTherefore, the future-pointing normal covector is $n_\\mu = -1 \\cdot \\nabla_\\mu t = (-1, 0, 0, 0)$.\n\nThe lapse function $\\alpha$ is defined by the relation $n_\\mu t^\\mu = -\\alpha$.\n$$-\\alpha = n_t t^t + n_r t^r + n_\\phi t^\\phi + n_z t^z = (-1)(1) + (0)(0) + (0)(0) + (0)(0) = -1$$\nThus, the lapse function is $\\alpha=1$.\n\nThe shift vector field $\\beta^\\mu$ is defined by the decomposition of the time evolution vector: $t^\\mu = \\alpha n^\\mu + \\beta^\\mu$.\nThe contravariant normal vector is $n^\\mu = g^{\\mu\\nu}n_\\nu = -g^{\\mu 0} = -(-1, 0, \\Omega, 0) = (1, 0, -\\Omega, 0)$.\nThe shift vector is purely spatial, meaning it is tangent to the hypersurface, $n_\\mu\\beta^\\mu=0$, which implies $\\beta^t=0$.\nFrom the decomposition, we solve for $\\beta^\\mu$:\n$$\\beta^\\mu = t^\\mu - \\alpha n^\\mu = (1, 0, 0, 0) - (1) \\cdot (1, 0, -\\Omega, 0) = (0, 0, \\Omega, 0)$$\nThe components of the shift vector $\\beta^i$ are the spatial components of $\\beta^\\mu$:\n$$\\beta^r = 0, \\quad \\beta^\\phi = \\Omega, \\quad \\beta^z = 0$$\n\nThe induced spatial metric on the hypersurfaces is given by $\\gamma_{\\mu\\nu} = g_{\\mu\\nu} + n_\\mu n_\\nu$. The components $\\gamma_{ij}$ are the spatial components of this tensor. For $i,j \\in \\{r, \\phi, z\\}$, we have:\n$$\\gamma_{ij} = g_{ij} + n_i n_j$$\nSince we found $n_\\mu = (-1, 0, 0, 0)$, the spatial components $n_i$ are all zero ($n_r=0, n_\\phi=0, n_z=0$).\nTherefore, the induced metric components are identical to the spatial components of the 4D metric tensor:\n$$\\gamma_{ij} = g_{ij}$$\nFrom the matrix for $g_{\\mu\\nu}$, we read off these components:\n$$\n\\gamma_{ij} = \\begin{pmatrix}\n\\gamma_{rr}  \\gamma_{r\\phi}  \\gamma_{rz} \\\\\n\\gamma_{\\phi r}  \\gamma_{\\phi\\phi}  \\gamma_{\\phi z} \\\\\n\\gamma_{zr}  \\gamma_{z\\phi}  \\gamma_{zz}\n\\end{pmatrix} = \\begin{pmatrix}\ng_{rr}  g_{r\\phi}  g_{rz} \\\\\ng_{\\phi r}  g_{\\phi\\phi}  g_{\\phi z} \\\\\ng_{zr}  g_{z\\phi}  g_{zz}\n\\end{pmatrix} = \\begin{pmatrix}\n1  0  0 \\\\\n0  r^2  0 \\\\\n0  0  1\n\\end{pmatrix}\n$$\nThe individual components are:\n$\\gamma_{rr} = 1$\n$\\gamma_{r\\phi} = 0$\n$\\gamma_{rz} = 0$\n$\\gamma_{\\phi\\phi} = r^2$\n$\\gamma_{\\phi z} = 0$\n$\\gamma_{zz} = 1$\n\nCombining these results in the specified order $(\\alpha, \\beta^{r}, \\beta^{\\phi}, \\beta^{z}, \\gamma_{rr}, \\gamma_{r\\phi}, \\gamma_{rz}, \\gamma_{\\phi\\phi}, \\gamma_{\\phi z}, \\gamma_{zz})$ gives the final answer.\n$$\n\\left(1,\\ 0,\\ \\Omega,\\ 0,\\ 1,\\ 0,\\ 0,\\ r^{2},\\ 0,\\ 1\\right)\n$$",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 1  0  \\Omega  0  1  0  0  r^2  0  1 \\end{pmatrix} } $$"
        },
        {
            "introduction": "Having practiced decomposing a metric, we now turn to the inverse problem: identifying the lapse and shift inherent in a given metric, a common task when analyzing numerical simulation output. This exercise  goes a step further by revealing a profound feature of general relativity: gauge freedom. By applying a small coordinate transformation (a diffeomorphism), you will directly observe how the reconstructed lapse and shift change, demonstrating that they are not unique physical quantities but rather tools whose choice is up to us.",
            "id": "3492610",
            "problem": "You are given a spacetime metric $g_{\\mu\\nu}$ at a single event in a coordinate chart adapted to a $3+1$ decomposition. The $3+1$ decomposition introduces the lapse function $\\alpha$, the shift vector $\\beta^i$, and the spatial metric $\\gamma_{ij}$, related to the line element by the relation\n$$\nds^2 = -\\alpha^2 dt^2 + \\gamma_{ij} \\left(dx^i + \\beta^i dt\\right)\\left(dx^j + \\beta^j dt\\right).\n$$\nThe inverse problem asks: given $g_{\\mu\\nu}$, reconstruct $\\alpha$ and $\\beta^i$. Then analyze the impact of a small diffeomorphism (a coordinate transformation) on the reconstructed $\\alpha$ and $\\beta^i$ and discuss the ensuing non-uniqueness.\n\nFundamental base and assumptions:\n- Work in geometrized units where $c = G = 1$ (dimensionless units).\n- Assume the metric signature $(-,+,+,+)$, and that the decomposition is well-defined at the event (i.e., the spatial block of the metric is positive definite and $g_{00}  0$).\n- Consider a small diffeomorphism defined by $t' = t + \\epsilon(\\vec{x})$ and $x'^i = x^i$, with $\\epsilon$ small and smooth, and evaluate its effect at the event using the spatial gradient $\\partial_i \\epsilon$.\n\nTask:\n- For each test case metric $g_{\\mu\\nu}$ listed below, reconstruct $\\alpha$ and $\\beta^i$ at the event.\n- Apply the small diffeomorphism to first order in $\\epsilon$ to obtain the transformed metric components $g'_{\\mu\\nu}$ at the event, using only $\\partial_i \\epsilon$ and neglecting terms of order $(\\partial \\epsilon)^2$ and higher.\n- Reconstruct $\\alpha'$ and $\\beta'^i$ from the transformed metric $g'_{\\mu\\nu}$.\n- Analyze non-uniqueness by reporting whether $\\alpha'$ and $\\beta'^i$ differ from $\\alpha$ and $\\beta^i$ beyond numerical tolerance, demonstrating the gauge freedom under small diffeomorphisms.\n- Verify that the determinant of the metric remains invariant under the small diffeomorphism to first order by checking $\\det(g') \\approx \\det(g)$ within a specified tolerance.\n\nNumerical tolerances:\n- Determinant invariance tolerance: if $\\left|\\det(g') - \\det(g)\\right| \\leq 10^{-12}$, consider the determinant invariant.\n- Non-uniqueness tolerance: if $\\left|\\alpha' - \\alpha\\right|  10^{-12}$ or $\\|\\beta' - \\beta\\|_2  10^{-12}$, consider the lapse/shift to be changed under the diffeomorphism.\n\nTest suite (all values in geometrized units):\n- Test case $1$ (Minkowski spacetime in standard coordinates):\n  - $g_{00} = -1$, $g_{0i} = 0$ for $i \\in \\{1,2,3\\}$, $g_{ij} = \\delta_{ij}$.\n  - Spatial gradient: $\\partial_i \\epsilon = \\left[1\\times 10^{-3}, -2\\times 10^{-3}, 1.5\\times 10^{-3}\\right]$.\n- Test case $2$ (Minkowski spacetime with a uniform shift):\n  - Shift $\\beta^i = \\left[0.3, -0.2, 0.1\\right]$, lapse $\\alpha = 1$, spatial metric $\\gamma_{ij} = \\delta_{ij}$.\n  - From these, construct $g_{00} = -1 + \\beta^i \\beta^j \\delta_{ij}$, $g_{0i} = \\delta_{ij} \\beta^j$, $g_{ij} = \\delta_{ij}$.\n  - Spatial gradient: $\\partial_i \\epsilon = \\left[2\\times 10^{-3}, 0, -1\\times 10^{-3}\\right]$.\n- Test case $3$ (Linearized gravitational wave in Transverse-Traceless gauge, plus polarization):\n  - Amplitude $h = 1\\times 10^{-2}$ at the event with phase chosen such that $h$ is as stated.\n  - $g_{00} = -1$, $g_{0i} = 0$, $g_{ij} = \\mathrm{diag}\\left(1 + h, 1 - h, 1\\right)$.\n  - Spatial gradient: $\\partial_i \\epsilon = \\left[1\\times 10^{-3}, 1\\times 10^{-3}, 0\\right]$.\n- Test case $4$ (Schwarzschild spacetime in isotropic coordinates at radius $r = 10 M$ with $M = 1$):\n  - Define $\\phi = 1 + \\frac{M}{2r} = 1 + \\frac{1}{20} = 1.05$.\n  - $g_{00} = -\\left(\\frac{1 - \\frac{M}{2r}}{1 + \\frac{M}{2r}}\\right)^2 = -\\left(\\frac{0.95}{1.05}\\right)^2$, $g_{0i} = 0$, $g_{ij} = \\phi^4 \\delta_{ij}$.\n  - Spatial gradient: $\\partial_i \\epsilon = \\left[5\\times 10^{-4}, -5\\times 10^{-4}, 2.5\\times 10^{-4}\\right]$.\n- Test case $5$ (Edge case: Minkowski spacetime with a uniform shift but no diffeomorphism):\n  - Same $g_{\\mu\\nu}$ as Test case $2$.\n  - Spatial gradient: $\\partial_i \\epsilon = \\left[0, 0, 0\\right]$.\n\nOutput specification:\n- For each test case, your program must compute and return the following four items:\n  - The reconstructed $\\alpha$ from $g_{\\mu\\nu}$, rounded to six decimals.\n  - The reconstructed $\\alpha'$ from $g'_{\\mu\\nu}$, rounded to six decimals.\n  - A boolean for determinant invariance: $True$ if $\\left|\\det(g') - \\det(g)\\right| \\leq 10^{-12}$ else $False$.\n  - A boolean for non-uniqueness: $True$ if $\\left|\\alpha' - \\alpha\\right|  10^{-12}$ or $\\|\\beta' - \\beta\\|_2  10^{-12}$ else $False$.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $\\left[\\text{result}_1,\\text{result}_2,\\text{result}_3\\right]$), where the list is formed by concatenating the four items for Test case $1$, then the four items for Test case $2$, and so on through Test case $5$.",
            "solution": "The problem is well-posed, scientifically grounded in the principles of general relativity and its $3+1$ (ADM) decomposition, and provides a complete set of data and definitions for a rigorous solution. The task is to reconstruct the lapse function $\\alpha$ and shift vector $\\beta^i$ from a given spacetime metric $g_{\\mu\\nu}$, and then analyze how these quantities change under a specific small coordinate transformation (a diffeomorphism). This serves as a demonstration of the gauge freedom inherent in the description of spacetime. The problem is valid.\n\nThe solution proceeds in three main stages for each test case:\n1.  Reconstruction of the initial lapse and shift $(\\alpha, \\beta^i)$ from the given metric $g_{\\mu\\nu}$.\n2.  Calculation of the transformed metric $g'_{\\mu\\nu}$ under the specified small diffeomorphism.\n3.  Reconstruction of the transformed lapse and shift $(\\alpha', \\beta'^i)$ from $g'_{\\mu\\nu}$ and comparison with the initial values.\n\n**1. Reconstruction of Lapse and Shift from the Metric**\n\nThe line element in the $3+1$ decomposition is given by\n$$\nds^2 = g_{\\mu\\nu}dx^\\mu dx^\\nu = -\\alpha^2 dt^2 + \\gamma_{ij} (dx^i + \\beta^i dt)(dx^j + \\beta^j dt)\n$$\nExpanding the right-hand side and matching coefficients with $g_{\\mu\\nu}dx^\\mu dx^\\nu$ yields the components of the spacetime metric in terms of the ADM variables $(\\alpha, \\beta^i, \\gamma_{ij})$:\n$$\ng_{00} = -\\alpha^2 + \\beta_k \\beta^k \\quad , \\quad g_{0i} = \\beta_i \\quad , \\quad g_{ij} = \\gamma_{ij}\n$$\nwhere $\\beta_i = \\gamma_{ij}\\beta^j$.\n\nTo perform the inverse operation—reconstructing $(\\alpha, \\beta^i, \\gamma_{ij})$ from $g_{\\mu\\nu}$—we can use the components of the inverse metric $g^{\\mu\\nu}$. The normal vector to the spatial hypersurface $t=\\text{const}$ is $n_\\mu = (-\\alpha, 0, 0, 0)$, and its contravariant form is $n^\\mu = g^{\\mu\\nu} n_\\nu = (-\\alpha g^{\\mu 0})$. The normalization condition $n_\\mu n^\\mu = -1$ gives $(-\\alpha)(-\\alpha g^{00}) = -1$, which leads to $g^{00} = -1/\\alpha^2$. From this, we can directly find the lapse function:\n$$\n\\alpha = \\frac{1}{\\sqrt{-g^{00}}}\n$$\nThe components of the contravariant normal vector are also given by $n^\\mu = (1/\\alpha, -\\beta^i/\\alpha)$. Comparing this with $n^\\mu = (-\\alpha g^{\\mu 0})$, we find for the spatial components $(\\mu=i)$:\n$$\n-\\frac{\\beta^i}{\\alpha} = -\\alpha g^{i0} \\implies \\beta^i = \\alpha^2 g^{i0}\n$$\nSubstituting the expression for $\\alpha^2$, we obtain the shift vector:\n$$\n\\beta^i = \\frac{-1}{g^{00}} g^{0i}\n$$\nThe reconstruction algorithm is therefore:\n1.  Given $g_{\\mu\\nu}$, compute its inverse $g^{\\mu\\nu}$.\n2.  Extract $g^{00}$ and $g^{0i}$.\n3.  Calculate $\\alpha$ and $\\beta^i$ using the formulas above.\n\n**2. Metric Transformation under a Small Diffeomorphism**\n\nThe problem specifies a small diffeomorphism corresponding to a shift in the time coordinate:\n$$\nt' = t + \\epsilon(\\vec{x}) \\quad, \\quad x'^i = x^i\n$$\nThe metric tensor transforms according to the rule for a rank-$(0,2)$ tensor. We can find the transformed components $g'_{\\mu\\nu}$ by enforcing the invariance of the line element, $ds^2 = g_{\\mu\\nu}dx^\\mu dx^\\nu = g'_{\\alpha\\beta}dx'^\\alpha dx'^\\beta$. Taking differentials of the transformation equations:\n$$\ndt' = dt + \\partial_i \\epsilon\\, dx^i \\quad, \\quad dx'^i = dx^i\n$$\nWe substitute $dx^\\mu$ in terms of $dx'^\\alpha$ into the original line element expression and identify the new metric components. However, it is more straightforward to express $dx'^\\alpha$ in terms of $dx^\\mu$ and compare the resulting quadratic form with $g_{\\mu\\nu}dx^\\mu dx^\\nu$. To first order in the small quantity $\\partial_i \\epsilon$, this yields the following transformation rules for the metric components at the event:\n$$\ng'_{00} = g_{00}\n$$\n$$\ng'_{0i} = g_{0i} - g_{00} \\partial_i \\epsilon\n$$\n$$\ng'_{ij} = g_{ij} - (g_{0i} \\partial_j \\epsilon + g_{0j} \\partial_i \\epsilon)\n$$\nThese relationships are equivalent to the first-order change in the metric given by the Lie derivative with respect to the vector field $\\xi^\\mu = (\\epsilon, 0, 0, 0)$, i.e., $\\delta g_{\\mu\\nu} = \\mathcal{L}_\\xi g_{\\mu\\nu}$, evaluated at a point where $\\epsilon=0$ but its gradient is non-zero.\n\n**3. Analysis of Non-Uniqueness and Determinant Invariance**\n\nAfter computing the transformed metric $g'_{\\mu\\nu}$ using the rules above, we apply the same reconstruction algorithm described in Section 1 to find the new lapse $\\alpha'$ and shift $\\beta'^i$.\n\nThe non-uniqueness is established by comparing the reconstructed values before and after the transformation. If either the lapse or the shift changes by more than the specified numerical tolerance, it demonstrates that the $3+1$ decomposition is not unique but depends on the choice of coordinate system (it is \"gauge-dependent\").\n$$\n\\text{Non-Unique if } |\\alpha' - \\alpha|  10^{-12} \\text{ or } \\|\\beta' - \\beta\\|_2  10^{-12}\n$$\n\nThe determinant of the metric transforms as $\\det(g') = (\\det(J))^{-2} \\det(g)$, where $J$ is the Jacobian of the coordinate transformation. For the given transformation, the Jacobian determinant is $\\det(\\partial x'^\\alpha / \\partial x^\\beta) = 1$. This implies that $\\det(g') = \\det(g)$ should hold exactly. Since we use a first-order approximation for the transformation of the metric components, we verify this property computationally by checking if the absolute difference of the determinants is within a small tolerance.\n$$\n\\text{Det. Invariant if } |\\det(g') - \\det(g)| \\leq 10^{-12}\n$$\n\nThe implementation will apply this three-stage process to each test case.\nFor Test Case 2 and 5, where the initial metric is defined via ADM variables, we first construct the metric $g_{\\mu\\nu}$ using $g_{00} = -\\alpha^2 + \\gamma_{ij}\\beta^i\\beta^j$, $g_{0i} = \\gamma_{ij}\\beta^j$, and $g_{ij} = \\gamma_{ij}$.\nThe entire procedure will be automated in the provided Python code.",
            "answer": "```python\nimport numpy as np\n\ndef construct_g_from_adm(alpha, beta_vec, gamma_mat):\n    \"\"\"Constructs the 4D metric g_munu from ADM variables.\"\"\"\n    g = np.zeros((4, 4))\n    beta_vec = np.array(beta_vec)\n    gamma_mat = np.array(gamma_mat)\n    \n    beta_down = gamma_mat @ beta_vec\n    beta_sq = beta_vec @ beta_down\n    \n    g[0, 0] = -alpha**2 + beta_sq\n    g[0, 1:] = beta_down\n    g[1:, 0] = beta_down\n    g[1:, 1:] = gamma_mat\n    \n    return g\n\ndef reconstruct_adm(g):\n    \"\"\"Reconstructs alpha and beta from the 4D metric g_munu.\"\"\"\n    try:\n        g_inv = np.linalg.inv(g)\n    except np.linalg.LinAlgError:\n        return np.nan, np.array([np.nan, np.nan, np.nan])\n\n    g00_inv = g_inv[0, 0]\n    g0i_inv = g_inv[0, 1:]\n    \n    if g00_inv = 0:\n        return np.nan, np.array([np.nan, np.nan, np.nan])\n\n    alpha = (-g00_inv)**(-0.5)\n    beta = -g0i_inv / g00_inv\n    \n    return alpha, beta\n\ndef transform_metric(g, grad_eps):\n    \"\"\"Applies the small diffeomorphism to the metric g_munu.\"\"\"\n    g_prime = np.zeros((4, 4))\n    grad_eps = np.array(grad_eps)\n    \n    g00 = g[0, 0]\n    g0i = g[0, 1:]\n    gij = g[1:, 1:]\n    \n    # g'_00 = g_00\n    g_prime[0, 0] = g00\n    \n    # g'_0i = g_0i - g_00 * grad_eps\n    gp_0i = g0i - g00 * grad_eps\n    g_prime[0, 1:] = gp_0i\n    g_prime[1:, 0] = gp_0i\n    \n    # g'_ij = g_ij - (g_0i * grad_eps_j + g_0j * grad_eps_i)\n    gp_ij = gij - (np.outer(g0i, grad_eps) + np.outer(grad_eps, g0i))\n    g_prime[1:, 1:] = gp_ij\n    \n    return g_prime\n\ndef solve():\n    \"\"\"\n    Main function to process all test cases and print results.\n    \"\"\"\n    \n    # Define test cases\n    test_cases = [\n        # Case 1: Minkowski\n        {\n            \"g_mu_nu\": np.array([[-1., 0., 0., 0.],\n                                 [0., 1., 0., 0.],\n                                 [0., 0., 1., 0.],\n                                 [0., 0., 0., 1.]]),\n            \"grad_eps\": [1e-3, -2e-3, 1.5e-3]\n        },\n        # Case 2: Minkowski with shift\n        {\n            \"g_mu_nu\": construct_g_from_adm(alpha=1.0, beta_vec=[0.3, -0.2, 0.1], gamma_mat=np.identity(3)),\n            \"grad_eps\": [2e-3, 0., -1e-3]\n        },\n        # Case 3: Linearized GW\n        {\n            \"g_mu_nu\": np.array([[-1.0, 0., 0., 0.],\n                                 [0., 1.01, 0., 0.],\n                                 [0., 0., 0.99, 0.],\n                                 [0., 0., 0., 1.0]]),\n            \"grad_eps\": [1e-3, 1e-3, 0.]\n        },\n        # Case 4: Schwarzschild in isotropic coordinates\n        {\n            \"g_mu_nu\": {\n                'g00': -((1 - 1./20.) / (1 + 1./20.))**2,\n                 'gij_diag': (1 + 1./20.)**4\n            },\n            \"grad_eps\": [5e-4, -5e-4, 2.5e-4]\n        },\n        # Case 5: Edge case (Minkowski with shift, no diffeomorphism)\n        {\n            \"g_mu_nu\": construct_g_from_adm(alpha=1.0, beta_vec=[0.3, -0.2, 0.1], gamma_mat=np.identity(3)),\n            \"grad_eps\": [0., 0., 0.]\n        }\n    ]\n    \n    # Special handling for case 4 construction\n    g_case4_data = test_cases[3][\"g_mu_nu\"]\n    g_case4 = np.diag([g_case4_data['g00'], \n                       g_case4_data['gij_diag'], \n                       g_case4_data['gij_diag'], \n                       g_case4_data['gij_diag']])\n    test_cases[3][\"g_mu_nu\"] = g_case4\n\n    # Tolerances\n    det_tol = 1e-12\n    non_unique_tol = 1e-12\n    \n    results = []\n    \n    for case in test_cases:\n        g = case[\"g_mu_nu\"]\n        grad_eps = case[\"grad_eps\"]\n        \n        # 1. Reconstruct initial alpha, beta\n        alpha, beta = reconstruct_adm(g)\n        \n        # 2. Transform the metric\n        g_prime = transform_metric(g, grad_eps)\n        \n        # 3. Reconstruct transformed alpha', beta'\n        alpha_prime, beta_prime = reconstruct_adm(g_prime)\n        \n        # 4. Analyze non-uniqueness and determinant invariance\n        det_g = np.linalg.det(g)\n        det_g_prime = np.linalg.det(g_prime)\n        \n        det_invariant = abs(det_g_prime - det_g) = det_tol\n        \n        alpha_diff = abs(alpha_prime - alpha)\n        beta_diff_norm = np.linalg.norm(beta_prime - beta)\n        non_unique = (alpha_diff  non_unique_tol) or (beta_diff_norm  non_unique_tol)\n        \n        # Append results for this case\n        results.extend([\n            f\"{alpha:.6f}\",\n            f\"{alpha_prime:.6f}\",\n            str(det_invariant),\n            str(non_unique)\n        ])\n\n    formatted_results = [r.replace('True', 'True').replace('False', 'False') for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "The freedom to choose our gauge, as demonstrated in the previous exercise, is not just a mathematical curiosity; it is the key to performing stable, long-term numerical simulations. This final practice  delves into the practical consequences of gauge choices by modeling how constraint violations evolve under different conditions for the lapse $\\alpha$ and shift $\\beta^i$. You will use a simplified model to quantify how \"good\" gauge choices, like those in the Bona-Massó and Gamma-driver families, actively damp constraint violations and are therefore essential for modeling phenomena like black hole mergers.",
            "id": "3492624",
            "problem": "You are asked to model and quantify the growth of constraint violations in a one-dimensional nonlinear gauge wave test within the ADM $3+1$ decomposition, focusing on how the choice of lapse function $\\alpha$ and shift vector $\\beta^{i}$ affects this growth. The Hamiltonian constraint $\\mathcal{H}$ and the momentum constraint $\\mathcal{M}_{i}$ should be understood in the context of the Arnowitt-Deser-Misner (ADM) formalism and widely used formulations such as Baumgarte-Shapiro-Shibata-Nakamura (BSSN) and Covariant Conformal Z4 (CCZ4). You must work from first principles and standard, broadly accepted facts. Do not assume or use any target formulas that short-circuit the derivation.\n\nAssumptions:\n- Consider a one-dimensional periodic domain $x \\in [0,L)$ with $L$ constant. The background spacetime is a nonlinear gauge wave, i.e., Minkowski spacetime in a nontrivial coordinate gauge, so that in the continuum the Einstein constraints are satisfied exactly.\n- Focus on small constraint violations induced by discretization and poor gauge control. Linearize the constraint propagation about the exact background. For either the Hamiltonian constraint $\\mathcal{H}$ or the component $\\mathcal{M}_{x}$ of the momentum constraint, approximate the leading-order evolution of a small constraint violation $c(x,t)$ by a constant-coefficient linear advection-diffusion-reaction Partial Differential Equation (PDE):\n$$\n\\partial_{t} c = - v\\,\\partial_{x} c + \\sigma\\, c + \\nu\\, \\partial_{x}^{2} c,\n$$\nwhere $v$ is an effective advection speed inherited from the shift vector $\\beta^{x}$, $\\nu \\ge 0$ is an effective diffusive coefficient capturing constraint-damping and numerical dissipation, and $\\sigma$ is an effective reaction rate that aggregates destabilizing or stabilizing couplings induced by the gauge choice for the lapse $\\alpha$ and shift $\\beta^{i}$ and by formulation-dependent constraint damping. Assume periodic boundary conditions. All quantities are dimensionless.\n- Define the $L^{2}$-norm on the domain by $\\lVert c(\\cdot,t)\\rVert_{2} = \\left(\\int_{0}^{L} c(x,t)^{2}\\,dx\\right)^{1/2}$ and the growth factor $G(t) = \\lVert c(\\cdot,t)\\rVert_{2} / \\lVert c(\\cdot,0)\\rVert_{2}$ for $\\lVert c(\\cdot,0)\\rVert_{2} \\neq 0$. If $\\lVert c(\\cdot,0)\\rVert_{2} = 0$, define the reported growth factor to be $0.0$.\n\nTasks:\n- Starting from the $3+1$ split and the notion that the Hamiltonian and momentum constraints are elliptic relations that must be preserved by the evolution equations, justify the linear advection-diffusion-reaction model above for small violations on a smooth background. Explain how the shift $\\beta^{x}$ provides an advection term, how Bona-Massó-type slicing conditions for the lapse and Gamma-driver conditions for the shift can be interpreted as modifying the coefficients $(\\sigma,\\nu)$, and why the periodic boundary condition is appropriate for the nonlinear gauge wave test.\n- Derive, without relying on any pre-given shortcut formulas, a method to compute the time evolution of the $L^{2}$-norm of $c(x,t)$ on the periodic domain for single Fourier-mode initial data $c(x,0) = \\varepsilon \\sin\\left(2\\pi m x / L\\right)$ with mode index $m \\in \\mathbb{Z}^{+}$ and amplitude $\\varepsilon$. Your derivation must make explicit use of the linear differential operator properties on a periodic domain, and it must identify the role played by each coefficient $(v,\\sigma,\\nu)$ in determining $G(t)$.\n- Based on your derivation, propose concrete, widely used gauge modifications to the lapse and shift that can be interpreted as making $\\sigma$ negative and $\\nu$ positive in the effective model, thus reducing growth. For example, discuss Bona-Massó $1+\\log$ slicing for $\\alpha$ and the hyperbolic Gamma-driver for $\\beta^{i}$, and qualitatively connect their parameters to $(\\sigma,\\nu)$ in the model.\n\nComputation requirements:\n- Implement a program that computes the Hamiltonian and momentum constraint growth factors for the following test suite. Each test case provides $(L,m,\\varepsilon,v,\\sigma_{\\mathcal{H}},\\nu_{\\mathcal{H}},\\sigma_{\\mathcal{M}},\\nu_{\\mathcal{M}},T)$, where $T$ is the final time at which the growth factor is to be reported. All quantities are dimensionless:\n    1. Poor gauge (geodesic-like slicing, frozen shift): $L = 1$, $m = 1$, $\\varepsilon = 10^{-6}$, $v = 0$, $\\sigma_{\\mathcal{H}} = 0.15$, $\\nu_{\\mathcal{H}} = 0.00005$, $\\sigma_{\\mathcal{M}} = 0.10$, $\\nu_{\\mathcal{M}} = 0.00005$, $T = 10$.\n    2. Poor gauge with constant nonzero shift: $L = 1$, $m = 1$, $\\varepsilon = 10^{-6}$, $v = 0.5$, $\\sigma_{\\mathcal{H}} = 0.10$, $\\nu_{\\mathcal{H}} = 0.00005$, $\\sigma_{\\mathcal{M}} = 0.08$, $\\nu_{\\mathcal{M}} = 0.00005$, $T = 10$.\n    3. Improved gauge ($1+\\log$ slicing and Gamma-driver shift, mild damping): $L = 1$, $m = 1$, $\\varepsilon = 10^{-6}$, $v = 0$, $\\sigma_{\\mathcal{H}} = -0.05$, $\\nu_{\\mathcal{H}} = 0.005$, $\\sigma_{\\mathcal{M}} = -0.08$, $\\nu_{\\mathcal{M}} = 0.005$, $T = 10$.\n    4. Improved gauge with nonzero shift (advection plus stronger damping): $L = 1$, $m = 1$, $\\varepsilon = 10^{-6}$, $v = 0.8$, $\\sigma_{\\mathcal{H}} = -0.10$, $\\nu_{\\mathcal{H}} = 0.005$, $\\sigma_{\\mathcal{M}} = -0.12$, $\\nu_{\\mathcal{M}} = 0.005$, $T = 10$.\n    5. Edge case with zero initial constraint violation: $L = 1$, $m = 1$, $\\varepsilon = 0$, $v = 0.3$, $\\sigma_{\\mathcal{H}} = 0.05$, $\\nu_{\\mathcal{H}} = 0.001$, $\\sigma_{\\mathcal{M}} = 0.02$, $\\nu_{\\mathcal{M}} = 0.001$, $T = 10$. By definition, report $0.0$ for both Hamiltonian and momentum growth factors.\n    6. High-wavenumber edge case (strong dissipation dominates): $L = 1$, $m = 16$, $\\varepsilon = 10^{-6}$, $v = 0.2$, $\\sigma_{\\mathcal{H}} = 0.05$, $\\nu_{\\mathcal{H}} = 0.001$, $\\sigma_{\\mathcal{M}} = 0.03$, $\\nu_{\\mathcal{M}} = 0.001$, $T = 10$.\n- Your program must compute, for each test case, an ordered pair of floats $(G_{\\mathcal{H}}, G_{\\mathcal{M}})$, where $G_{\\mathcal{H}}$ is the Hamiltonian constraint growth factor and $G_{\\mathcal{M}}$ is the momentum constraint growth factor at time $T$.\n- Angle units do not apply. No physical units are used; all variables are dimensionless.\n- Final output format: Your program should produce a single line of output containing the results as a list of two-element lists, in the order of the test suite, with each float rounded to six decimal places, for example:\n$[[G_{\\mathcal{H},1},G_{\\mathcal{M},1}],[G_{\\mathcal{H},2},G_{\\mathcal{M},2}],\\dots]$.",
            "solution": "The problem statement is evaluated to be valid. It is scientifically grounded in the principles of numerical relativity and the $3+1$ decomposition of Einstein's equations. The problem is well-posed, providing a linear partial differential equation with constant coefficients, a clear initial condition, and periodic boundary conditions, which constitutes a solvable initial-boundary value problem. The parameters and objectives are defined with sufficient precision, and the task requires a combination of theoretical justification, mathematical derivation, and computational implementation, all of which are standard practices in computational physics.\n\n### Justification of the Model PDE\n\nThe evolution of spacetime in the Arnowitt-Deser-Misner (ADM) $3+1$ formalism is governed by a set of evolution equations for the spatial metric $\\gamma_{ij}$ and the extrinsic curvature $K_{ij}$, subject to the Hamiltonian constraint $\\mathcal{H}=0$ and the momentum constraints $\\mathcal{M}_{i}=0$. In the continuum, if the constraints are satisfied on an initial time slice, the evolution equations guarantee they are satisfied for all time. However, in numerical simulations, discretization error and the choice of gauge (the lapse function $\\alpha$ and shift vector $\\beta^i$) can lead to the growth of constraint violations.\n\nLet $C$ represent either the Hamiltonian constraint $\\mathcal{H}$ or a component of the momentum constraint, say $\\mathcal{M}_x$. The time evolution of the constraints can be schematically written as $\\partial_t C = L(C, \\phi)$, where $L$ is a complex differential operator that depends on the spacetime fields $\\phi = \\{\\gamma_{ij}, K_{ij}, \\alpha, \\beta^i\\}$ and the constraints $C$ themselves.\n\nThe problem considers a nonlinear gauge wave, which is an exact solution to the vacuum Einstein equations, corresponding to Minkowski spacetime in a non-trivial gauge. In this background, the constraints are identically zero, $C_{bg} = 0$. We are interested in the evolution of a small constraint violation, $c(x,t)$, which arises from numerical error. We can linearize the constraint evolution equation around the exact background solution:\n$$\n\\partial_t c \\approx \\delta(\\partial_t C)|_{C=0} = \\left.\\frac{\\delta L}{\\delta C}\\right|_{C=0} c\n$$\nThe operator $\\delta L/\\delta C$ is a linear differential operator whose coefficients depend on the background solution and the chosen gauge. In one spatial dimension $x$, for a smooth background, this operator can be approximated by a general constant-coefficient linear operator. The model given,\n$$\n\\partial_{t} c = - v\\,\\partial_{x} c + \\sigma\\, c + \\nu\\, \\partial_{x}^{2} c\n$$\nrepresents the leading-order terms of this linearization.\n\n*   **Advection Term ($-v\\,\\partial_x c$):** The time derivative in the $3+1$ split is a combination of the derivative normal to the spatial hypersurface, controlled by the lapse $\\alpha$, and a \"drag\" along the hypersurface, controlled by the shift $\\beta^i$. The time derivative of a scalar field $c$ as measured by an observer moving along the time coordinate lines is $\\partial_t c = \\alpha (\\text{normal derivative}) + \\mathcal{L}_{\\beta} c$, where $\\mathcal{L}_{\\beta}$ is the Lie derivative along the shift vector. For a scalar, $\\mathcal{L}_{\\beta} c = \\beta^i \\partial_i c$. In one dimension, this is $\\beta^x \\partial_x c$. This term directly advects the scalar field $c$ with the coordinate velocity defined by the shift. Thus, the advection speed $v$ in the model is directly identified with $-\\beta^x$ (the sign is a matter of convention).\n\n*   **Reaction Term ($\\sigma\\,c$):** This term arises from parts of the linearized operator that are algebraic in the constraint $c$. These terms are critically dependent on the gauge choice, particularly the evolution equation for the lapse $\\alpha$. For example, with \"geodesic slicing,\" where observers follow geodesics normal to the slicing, it is known that constraint violations can grow exponentially. This corresponds to a positive reaction rate, $\\sigma > 0$. Dynamically-adjusted slicing conditions, such as the Bona-Massó family (e.g., \"$1+\\log$\" slicing), define an evolution equation for $\\alpha$ that couples to the trace of the extrinsic curvature, $K$. Since $K$ is related to the Hamiltonian constraint $\\mathcal{H}$, this coupling creates a feedback mechanism. A growing $\\mathcal{H}$ alters $K$, which in turn drives $\\alpha$ in a way that counteracts the growth, effectively making $\\sigma$ negative and stabilizing the evolution.\n\n*   **Diffusion Term ($\\nu\\,\\partial_x^2 c$):** Second-order derivative terms, $\\partial_x^2 c$, can arise naturally from the curvature terms in the constraint evolution equations. More significantly, modern numerical relativity formulations like BSSN and CCZ4 often include explicit \"constraint-damping\" terms. These are terms added by hand to the evolution equations that are proportional to spatial derivatives of the constraints (e.g., of the form $\\nabla_i C$). When linearized, these terms manifest as a diffusion term $\\nu \\nabla^2 c$, which in one dimension is $\\nu \\partial_x^2 c$. A positive coefficient $\\nu > 0$ damps high-wavenumber (short-wavelength) constraint violations, which are often the most problematic numerically. This term also models the effect of numerical dissipation inherent in many finite-difference schemes.\n\n*   **Periodic Boundary Conditions:** The nonlinear gauge wave is a solution where the metric components are periodic functions of a traveling-wave coordinate, e.g., $f(x-t)$. Therefore, a computational domain with periodic boundary conditions is the natural and physically appropriate choice for simulating such a wave and analyzing perturbations upon it.\n\n### Derivation of the Growth Factor $G(t)$\n\nWe need to solve the PDE $\\partial_{t} c = - v\\,\\partial_{x} c + \\sigma\\, c + \\nu\\, \\partial_{x}^{2} c$ on the periodic domain $x \\in [0,L)$ with the single Fourier mode initial condition $c(x,0) = \\varepsilon \\sin(k x)$, where $k = 2\\pi m / L$ for an integer mode index $m \\ge 1$.\n\nSince the PDE is linear with constant coefficients on a periodic domain, we can use Fourier analysis. The eigenfunctions of the spatial differential operators $\\partial_x$ and $\\partial_x^2$ on this domain are the complex exponentials $e^{i k_n x}$ with wavenumbers $k_n = 2\\pi n / L$ for $n \\in \\mathbb{Z}$.\nLet's consider a single complex Fourier mode as our ansatz for the solution: $c(x,t) = \\hat{c}(t) e^{ikx}$. Substituting this into the PDE yields an ordinary differential equation (ODE) for the time-dependent amplitude $\\hat{c}(t)$:\n$$\n\\frac{d\\hat{c}(t)}{dt} e^{ikx} = -v \\hat{c}(t) (ik) e^{ikx} + \\sigma \\hat{c}(t) e^{ikx} + \\nu \\hat{c}(t) (ik)^2 e^{ikx}\n$$\nDividing by $e^{ikx}$, we get:\n$$\n\\frac{d\\hat{c}(t)}{dt} = (-ikv + \\sigma - \\nu k^2) \\hat{c}(t)\n$$\nThis is a first-order linear ODE with the solution:\n$$\n\\hat{c}(t) = \\hat{c}(0) \\exp\\left((\\sigma - \\nu k^2 - ikv)t\\right)\n$$\nThe initial condition is $c(x,0) = \\varepsilon \\sin(kx)$. We can write this using Euler's formula:\n$$\nc(x,0) = \\varepsilon \\left(\\frac{e^{ikx} - e^{-ikx}}{2i}\\right) = \\left(\\frac{\\varepsilon}{2i}\\right) e^{ikx} + \\left(\\frac{-\\varepsilon}{2i}\\right) e^{-ikx}\n$$\nThis shows that the initial condition is a superposition of two complex Fourier modes with wavenumbers $k$ and $-k$. The initial amplitudes are $\\hat{c}_{k}(0) = \\varepsilon / (2i)$ and $\\hat{c}_{-k}(0) = -\\varepsilon / (2i)$. By linearity, the solution at time $t$ is the superposition of the evolved modes:\n$$\nc(x,t) = \\hat{c}_{k}(t) e^{ikx} + \\hat{c}_{-k}(t) e^{-ikx}\n$$\nThe amplitude for the mode with wavenumber $-k$ evolves as:\n$$\n\\hat{c}_{-k}(t) = \\hat{c}_{-k}(0) \\exp\\left((\\sigma - \\nu (-k)^2 - i(-k)v)t\\right) = \\hat{c}_{-k}(0) \\exp\\left((\\sigma - \\nu k^2 + ikv)t\\right)\n$$\nSubstituting the initial amplitudes and the evolution factors:\n$$\nc(x,t) = \\frac{\\varepsilon}{2i} e^{(\\sigma - \\nu k^2 - ikv)t} e^{ikx} - \\frac{\\varepsilon}{2i} e^{(\\sigma - \\nu k^2 + ikv)t} e^{-ikx}\n$$\n$$\nc(x,t) = \\frac{\\varepsilon}{2i} e^{(\\sigma - \\nu k^2)t} \\left( e^{i(kx - kvt)} - e^{-i(kx - kvt)} \\right)\n$$\n$$\nc(x,t) = \\varepsilon e^{(\\sigma - \\nu k^2)t} \\sin(k(x-vt))\n$$\nThe solution is a sinusoidal wave whose amplitude evolves exponentially with a rate $(\\sigma - \\nu k^2)$ and which advects with speed $v$.\n\nNow we compute the $L^2$-norm, $\\lVert c(\\cdot,t)\\rVert_{2} = \\left(\\int_{0}^{L} c(x,t)^{2}\\,dx\\right)^{1/2}$.\n$$\n\\lVert c(\\cdot,t)\\rVert_{2}^2 = \\int_{0}^{L} \\left( \\varepsilon e^{(\\sigma - \\nu k^2)t} \\sin(k(x-vt)) \\right)^2 dx\n$$\n$$\n\\lVert c(\\cdot,t)\\rVert_{2}^2 = \\varepsilon^2 e^{2(\\sigma - \\nu k^2)t} \\int_{0}^{L} \\sin^2(k(x-vt)) dx\n$$\nThe integral of $\\sin^2$ over an integer number of periods is $L/2$. Since $k = 2\\pi m/L$, the integrand $\\sin^2(\\frac{2\\pi m}{L}(x-vt))$ completes $m$ full periods over the domain $[0,L)$, so the value of the integral is indeed $L/2$.\n$$\n\\lVert c(\\cdot,t)\\rVert_{2}^2 = \\varepsilon^2 e^{2(\\sigma - \\nu k^2)t} \\frac{L}{2}\n$$\nTaking the square root, assuming $\\varepsilon > 0$:\n$$\n\\lVert c(\\cdot,t)\\rVert_{2} = \\varepsilon e^{(\\sigma - \\nu k^2)t} \\sqrt{\\frac{L}{2}}\n$$\nThe initial norm is $\\lVert c(\\cdot,0)\\rVert_{2} = \\varepsilon \\sqrt{L/2}$. The growth factor $G(t)$ is the ratio:\n$$\nG(t) = \\frac{\\lVert c(\\cdot,t)\\rVert_{2}}{\\lVert c(\\cdot,0)\\rVert_{2}} = \\frac{\\varepsilon e^{(\\sigma - \\nu k^2)t} \\sqrt{L/2}}{\\varepsilon \\sqrt{L/2}} = e^{(\\sigma - \\nu k^2)t}\n$$\nSubstituting $k = 2\\pi m / L$:\n$$\nG(t) = \\exp\\left(\\left(\\sigma - \\nu \\left(\\frac{2\\pi m}{L}\\right)^2\\right)t\\right)\n$$\nThis is the final expression for the growth factor. Note that the advection speed $v$ does not affect the growth of the $L^2$-norm, as the norm is invariant under spatial translation. If $\\varepsilon=0$, the initial norm is $0$, and the solution remains $c(x,t)=0$, so the growth factor is correctly defined as $0.0$.\n\n### Gauge Conditions for Stability\n\nThe goal of \"good\" gauge choices is to ensure that constraint violations do not grow; ideally, they should be damped away. In the context of our model, this means engineering the full system such that the effective coefficients for the constraints satisfy $\\sigma  0$ and $\\nu > 0$.\n\n*   **Lapse Condition ($1+\\log$ Slicing):** The $1+\\log$ slicing condition is a member of the Bona-Massó family of slicing conditions. A common form is $\\partial_t \\alpha = -\\alpha^2 f(\\alpha) K + \\beta^i \\partial_i \\alpha$, with a popular choice being $f(\\alpha)=2/\\alpha$. The key is the term containing $K$, the trace of the extrinsic curvature. The Hamiltonian constraint $\\mathcal{H}$ is algebraically related to $K$ (e.g., $\\mathcal{H} = R + K^2 - K_{ij}K^{ij} - 16\\pi\\rho$). When $\\mathcal{H}$ deviates from zero, $K$ also deviates from its \"on-shell\" value. The slicing condition couples this deviation back into the evolution of the lapse $\\alpha$. This feedback is specifically designed to be negative feedback: a growing constraint violation drives the lapse in such a way as to counteract that growth. This forces the constraint to obey a wave-like equation rather than an exponentially growing one, which in our effective model corresponds to contributing a negative term to $\\sigma_{\\mathcal{H}}$, promoting stability.\n\n*   **Shift Condition (Gamma-driver):** The shift vector $\\beta^i$ controls coordinate drift. A static shift or simple choices can lead to instabilities in the momentum constraint $\\mathcal{M}_i$. The \"Gamma-driver\" shift conditions are a set of dynamical evolution equations for $\\beta^i$. A typical form is $\\partial_t \\beta^i = B^i$ and $\\partial_t B^i = \\frac{3}{4}\\partial_t \\tilde{\\Gamma}^i - \\eta B^i$, where $\\tilde{\\Gamma}^i$ are the conformal connection functions (essentially spatial derivatives of the metric) and $\\eta$ is a damping parameter. The source term $\\tilde{\\Gamma}^i$ is closely related to the momentum constraints $\\mathcal{M}_i$. When $\\mathcal{M}_i$ is non-zero, it acts as a source for the evolution of the shift. The shift then dynamically adjusts to drive $\\tilde{\\Gamma}^i$ (and thus $\\mathcal{M}_i$) back towards zero. This turns the constraint evolution into a damped hyperbolic system. This corresponds to making $\\sigma_{\\mathcal{M}}$ negative and can also be interpreted as contributing to the diffusive/damping term $\\nu_{\\mathcal{M}}$.\n\nIn summary, modern \"live\" gauge conditions are designed to transform the constraint subsystem from an ill-posed or unstable one into a well-posed, stable, damped hyperbolic system. This is achieved by introducing terms in the gauge evolution equations that provide negative feedback, translating to $\\sigma  0$ and $\\nu  0$ in the effective model.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the Hamiltonian and momentum constraint growth factors for a\n    series of test cases based on a linearized 1D constraint evolution model.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (L, m, ε, v, σ_H, ν_H, σ_M, ν_M, T)\n    test_cases = [\n        # 1. Poor gauge (geodesic-like slicing, frozen shift)\n        (1.0, 1, 1e-6, 0.0, 0.15, 0.00005, 0.10, 0.00005, 10.0),\n        # 2. Poor gauge with constant nonzero shift\n        (1.0, 1, 1e-6, 0.5, 0.10, 0.00005, 0.08, 0.00005, 10.0),\n        # 3. Improved gauge (1+log slicing and Gamma-driver shift, mild damping)\n        (1.0, 1, 1e-6, 0.0, -0.05, 0.005, -0.08, 0.005, 10.0),\n        # 4. Improved gauge with nonzero shift (advection plus stronger damping)\n        (1.0, 1, 1e-6, 0.8, -0.10, 0.005, -0.12, 0.005, 10.0),\n        # 5. Edge case with zero initial constraint violation\n        (1.0, 1, 0.0, 0.3, 0.05, 0.001, 0.02, 0.001, 10.0),\n        # 6. High-wavenumber edge case (strong dissipation dominates)\n        (1.0, 16, 1e-6, 0.2, 0.05, 0.001, 0.03, 0.001, 10.0),\n    ]\n\n    all_results_formatted = []\n    \n    for case in test_cases:\n        L, m, epsilon, v, sigma_H, nu_H, sigma_M, nu_M, T = case\n\n        # Handle the special case of zero initial violation as per problem description.\n        if epsilon == 0.0:\n            G_H = 0.0\n            G_M = 0.0\n        else:\n            # The derived growth factor G(t) = exp((σ - ν * k^2) * t)\n            # where k = 2 * pi * m / L.\n            \n            # Calculate the square of the wavenumber k.\n            k_squared = (2 * np.pi * m / L)**2\n\n            # Calculate the growth factor for the Hamiltonian constraint.\n            exponent_H = (sigma_H - nu_H * k_squared) * T\n            G_H = np.exp(exponent_H)\n\n            # Calculate the growth factor for the momentum constraint.\n            exponent_M = (sigma_M - nu_M * k_squared) * T\n            G_M = np.exp(exponent_M)\n\n        # Format the result pair as a string '[val1,val2]'\n        formatted_pair = f\"[{G_H:.6f},{G_M:.6f}]\"\n        all_results_formatted.append(formatted_pair)\n\n    # Final print statement in the exact required format.\n    # Joins the formatted strings and wraps them in an outer list bracket.\n    print(f\"[{','.join(all_results_formatted)}]\")\n\nsolve()\n\n```"
        }
    ]
}