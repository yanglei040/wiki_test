{
    "hands_on_practices": [
        {
            "introduction": "贝叶斯校准的基础在于理解先验知识如何被数据更新。这个练习提供了一个最简化模型的直接解析分析，让你能直观地理解这个过程。通过探究先验确定性（方差）如何影响最终的后验分布，我们可以为先验信念和实验证据之间的相互作用建立起坚实的直觉。",
            "id": "3544172",
            "problem": "考虑对有效场论 (EFT) 中核子-核子势的接触相互作用中出现的单个无量纲低能常数 $\\,\\theta\\,$ 进行贝叶斯校准。假设单个由模拟器预测的可观测量（例如结合能残差）被建模为对 $\\,\\theta\\,$ 的线性响应，并带有加性高斯噪声：\n$$\ny \\mid \\theta \\sim \\mathcal{N}(a\\,\\theta,\\ \\sigma^{2}),\n$$\n其中 $\\,y\\,$ 是观测到的残差，$\\,a\\,$ 是来自线性化模拟器的已知灵敏度系数，$\\,\\sigma^{2}\\,$ 是模拟器和实验不确定性组合的已知方差。$\\,\\theta\\,$ 的先验是高斯分布，\n$$\n\\theta \\sim \\mathcal{N}(\\mu_{0},\\ \\tau^{2}),\n$$\n其先验均值 $\\,\\mu_{0}\\,$ 和先验方差 $\\,\\tau^{2}\\,$ 已知。在此次校准中，所有量 $\\,\\theta,\\ \\mu_{0},\\ a,\\ y\\,$ 都被视为无量纲。\n\n您将比较两个仅在先验宽度上有所不同的校准：一个使用先验方差 $\\,\\tau_{1}^{2}\\,$，另一个使用 $\\,\\tau_{2}^{2}\\,$，两者共享相同的先验均值 $\\,\\mu_{0}\\,$。从贝叶斯定理以及高斯似然和高斯先验的定义出发，推导每种情况下的后验分布，然后计算：\n\n1. 将先验方差从 $\\,\\tau_{1}^{2}\\,$ 更改为 $\\,\\tau_{2}^{2}\\,$ 引起的后验均值的确切偏移：\n$$\n\\Delta \\mu_{\\mathrm{post}} \\equiv \\mu_{\\mathrm{post}}(\\tau_{2}^{2}) - \\mu_{\\mathrm{post}}(\\tau_{1}^{2}).\n$$\n\n2. 后验方差的确切比率：\n$$\n\\rho \\equiv \\frac{\\tau_{\\mathrm{post}}^{2}(\\tau_{2}^{2})}{\\tau_{\\mathrm{post}}^{2}(\\tau_{1}^{2})}.\n$$\n\n将 $\\,\\Delta \\mu_{\\mathrm{post}}\\,$ 和 $\\,\\rho\\,$ 表示为 $\\,\\mu_{0},\\,a,\\,y,\\,\\sigma,\\,\\tau_{1}^{2},\\,\\tau_{2}^{2}\\,$ 的闭式解析函数。不需要进行数值计算。请以单个行向量的形式提供您的最终答案，按顺序包含 $\\,\\Delta \\mu_{\\mathrm{post}}\\,$ 和 $\\,\\rho\\,$。由于在此设置中 $\\,\\theta\\,$ 和所有相关量都是无量纲的，因此不需要物理单位。不需要四舍五入；请给出精确的解析表达式。",
            "solution": "这个问题提得很好且有科学依据，它基于使用共轭先验的贝叶斯推断的标准原则。任务是当参数 $\\,\\theta\\,$ 的高斯先验方差发生变化时，推导其后验均值的变化和后验方差的比率。\n\n首先，我们必须推导 $\\,\\theta\\,$ 的后验分布的一般形式。根据贝叶斯定理，后验概率密度函数 (PDF) $p(\\theta \\mid y)$ 正比于似然函数 $p(y \\mid \\theta)$ 和先验概率密度函数 $p(\\theta)$ 的乘积：\n$$\np(\\theta \\mid y) \\propto p(y \\mid \\theta) \\, p(\\theta)\n$$\n问题陈述似然函数是高斯分布：\n$$\np(y \\mid \\theta) = \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left( -\\frac{(y - a\\theta)^2}{2\\sigma^2} \\right)\n$$\n并且 $\\,\\theta\\,$ 的先验也是高斯分布：\n$$\np(\\theta) = \\frac{1}{\\sqrt{2\\pi\\tau^2}} \\exp\\left( -\\frac{(\\theta - \\mu_0)^2}{2\\tau^2} \\right)\n$$\n将这两个分布相乘，并舍去常数归一化因子，我们得到未归一化的后验分布：\n$$\np(\\theta \\mid y) \\propto \\exp\\left( -\\frac{(y - a\\theta)^2}{2\\sigma^2} \\right) \\exp\\left( -\\frac{(\\theta - \\mu_0)^2}{2\\tau^2} \\right)\n$$\n$$\np(\\theta \\mid y) \\propto \\exp\\left( -\\frac{1}{2} \\left[ \\frac{(y - a\\theta)^2}{\\sigma^2} + \\frac{(\\theta - \\mu_0)^2}{\\tau^2} \\right] \\right)\n$$\n为了确定后验分布的形式，我们在指数中对 $\\,\\theta\\,$ 进行配方。令方括号中的项为 $\\,Q(\\theta)\\,$：\n$$\nQ(\\theta) = \\frac{y^2 - 2ay\\theta + a^2\\theta^2}{\\sigma^2} + \\frac{\\theta^2 - 2\\mu_0\\theta + \\mu_0^2}{\\tau^2}\n$$\n我们收集包含 $\\,\\theta^2\\,$ 和 $\\,\\theta\\,$ 的项：\n$$\nQ(\\theta) = \\theta^2 \\left( \\frac{a^2}{\\sigma^2} + \\frac{1}{\\tau^2} \\right) - 2\\theta \\left( \\frac{ay}{\\sigma^2} + \\frac{\\mu_0}{\\tau^2} \\right) + \\mathrm{const.}\n$$\n其中“const.”包含不依赖于 $\\,\\theta\\,$ 的项。 $\\,\\theta\\,$ 的后验分布是形式为 $\\,\\mathcal{N}(\\mu_{\\mathrm{post}}, \\tau_{\\mathrm{post}}^2)\\,$ 的高斯分布，其概率密度函数正比于 $\\,\\exp\\left( -\\frac{(\\theta - \\mu_{\\mathrm{post}})^2}{2\\tau_{\\mathrm{post}}^2} \\right)\\,$。指数可以写为：\n$$\n-\\frac{1}{2\\tau_{\\mathrm{post}}^2} (\\theta^2 - 2\\mu_{\\mathrm{post}}\\theta + \\mu_{\\mathrm{post}}^2) = -\\frac{1}{2} \\left[ \\theta^2 \\left(\\frac{1}{\\tau_{\\mathrm{post}}^2}\\right) - 2\\theta \\left(\\frac{\\mu_{\\mathrm{post}}}{\\tau_{\\mathrm{post}}^2}\\right) + \\mathrm{const.} \\right]\n$$\n通过比较 $\\,Q(\\theta)\\,$ 和标准高斯形式中 $\\,\\theta^2\\,$ 项的系数，我们确定了后验方差的倒数，即后验精度：\n$$\n\\frac{1}{\\tau_{\\mathrm{post}}^2} = \\frac{a^2}{\\sigma^2} + \\frac{1}{\\tau^2} = \\frac{a^2\\tau^2 + \\sigma^2}{\\sigma^2\\tau^2}\n$$\n由此，后验方差 $\\,\\tau_{\\mathrm{post}}^2\\,$ 为：\n$$\n\\tau_{\\mathrm{post}}^2 = \\frac{\\sigma^2\\tau^2}{a^2\\tau^2 + \\sigma^2}\n$$\n通过比较 $\\,\\theta\\,$ 项的系数，我们找到后验均值 $\\,\\mu_{\\mathrm{post}}\\,$：\n$$\n\\frac{\\mu_{\\mathrm{post}}}{\\tau_{\\mathrm{post}}^2} = \\frac{ay}{\\sigma^2} + \\frac{\\mu_0}{\\tau^2}\n$$\n$$\n\\mu_{\\mathrm{post}} = \\tau_{\\mathrm{post}}^2 \\left( \\frac{ay}{\\sigma^2} + \\frac{\\mu_0}{\\tau^2} \\right) = \\left( \\frac{\\sigma^2\\tau^2}{a^2\\tau^2 + \\sigma^2} \\right) \\left( \\frac{ay\\tau^2 + \\mu_0\\sigma^2}{\\sigma^2\\tau^2} \\right)\n$$\n$$\n\\mu_{\\mathrm{post}} = \\frac{ay\\tau^2 + \\mu_0\\sigma^2}{a^2\\tau^2 + \\sigma^2}\n$$\n现在我们将这些一般性结果应用于两个指定的情况。\n\n情况 1：先验方差 $\\,\\tau_1^2\\,$。\n$$\n\\mu_{\\mathrm{post}}(\\tau_1^2) = \\frac{ay\\tau_1^2 + \\mu_0\\sigma^2}{a^2\\tau_1^2 + \\sigma^2}\n$$\n$$\n\\tau_{\\mathrm{post}}^2(\\tau_1^2) = \\frac{\\sigma^2\\tau_1^2}{a^2\\tau_1^2 + \\sigma^2}\n$$\n\n情况 2：先验方差 $\\,\\tau_2^2\\,$。\n$$\n\\mu_{\\mathrm{post}}(\\tau_2^2) = \\frac{ay\\tau_2^2 + \\mu_0\\sigma^2}{a^2\\tau_2^2 + \\sigma^2}\n$$\n$$\n\\tau_{\\mathrm{post}}^2(\\tau_2^2) = \\frac{\\sigma^2\\tau_2^2}{a^2\\tau_2^2 + \\sigma^2}\n$$\n\n1.  计算后验均值的偏移，$\\,\\Delta \\mu_{\\mathrm{post}} = \\mu_{\\mathrm{post}}(\\tau_2^2) - \\mu_{\\mathrm{post}}(\\tau_1^2)\\,$：\n$$\n\\Delta \\mu_{\\mathrm{post}} = \\frac{ay\\tau_2^2 + \\mu_0\\sigma^2}{a^2\\tau_2^2 + \\sigma^2} - \\frac{ay\\tau_1^2 + \\mu_0\\sigma^2}{a^2\\tau_1^2 + \\sigma^2}\n$$\n我们求一个公分母：\n$$\n\\Delta \\mu_{\\mathrm{post}} = \\frac{(ay\\tau_2^2 + \\mu_0\\sigma^2)(a^2\\tau_1^2 + \\sigma^2) - (ay\\tau_1^2 + \\mu_0\\sigma^2)(a^2\\tau_2^2 + \\sigma^2)}{(a^2\\tau_1^2 + \\sigma^2)(a^2\\tau_2^2 + \\sigma^2)}\n$$\n展开分子：\n$$\n(a^3y\\tau_1^2\\tau_2^2 + ay\\sigma^2\\tau_2^2 + a^2\\mu_0\\sigma^2\\tau_1^2 + \\mu_0\\sigma^4) - (a^3y\\tau_1^2\\tau_2^2 + ay\\sigma^2\\tau_1^2 + a^2\\mu_0\\sigma^2\\tau_2^2 + \\mu_0\\sigma^4)\n$$\n项 $\\,a^3y\\tau_1^2\\tau_2^2\\,$ 和 $\\,\\mu_0\\sigma^4\\,$ 被消去。我们剩下：\n$$\nay\\sigma^2\\tau_2^2 + a^2\\mu_0\\sigma^2\\tau_1^2 - ay\\sigma^2\\tau_1^2 - a^2\\mu_0\\sigma^2\\tau_2^2 = ay\\sigma^2(\\tau_2^2 - \\tau_1^2) - a^2\\mu_0\\sigma^2(\\tau_2^2 - \\tau_1^2)\n$$\n提出公因式得到：\n$$\na\\sigma^2(y - a\\mu_0)(\\tau_2^2 - \\tau_1^2)\n$$\n因此，后验均值的偏移为：\n$$\n\\Delta \\mu_{\\mathrm{post}} = \\frac{a\\sigma^2(y - a\\mu_0)(\\tau_2^2 - \\tau_1^2)}{(a^2\\tau_1^2 + \\sigma^2)(a^2\\tau_2^2 + \\sigma^2)}\n$$\n\n2.  计算后验方差的比率，$\\,\\rho = \\frac{\\tau_{\\mathrm{post}}^2(\\tau_2^2)}{\\tau_{\\mathrm{post}}^2(\\tau_1^2)}\\,$：\n$$\n\\rho = \\frac{\\frac{\\sigma^2\\tau_2^2}{a^2\\tau_2^2 + \\sigma^2}}{\\frac{\\sigma^2\\tau_1^2}{a^2\\tau_1^2 + \\sigma^2}}\n$$\n每个分数中分子里的 $\\,\\sigma^2\\,$ 项被消去：\n$$\n\\rho = \\frac{\\tau_2^2}{a^2\\tau_2^2 + \\sigma^2} \\cdot \\frac{a^2\\tau_1^2 + \\sigma^2}{\\tau_1^2}\n$$\n重新整理得到比率的最终表达式：\n$$\n\\rho = \\frac{\\tau_2^2(a^2\\tau_1^2 + \\sigma^2)}{\\tau_1^2(a^2\\tau_2^2 + \\sigma^2)}\n$$\n所求的两个量 $\\,\\Delta \\mu_{\\mathrm{post}}\\,$ 和 $\\,\\rho\\,$ 现在已表示为给定参数的闭式解析函数。最终答案以行向量的形式呈现。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{a\\sigma^2(y - a\\mu_0)(\\tau_2^2 - \\tau_1^2)}{(a^2\\tau_1^2 + \\sigma^2)(a^2\\tau_2^2 + \\sigma^2)}  \\frac{\\tau_2^2 (a^2\\tau_1^2 + \\sigma^2)}{\\tau_1^2 (a^2\\tau_2^2 + \\sigma^2)} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在掌握了基础之后，我们将从理想化的模型转向更贴近现实世界的场景，在这些场景中，物理参数通常受到约束，例如必须为正值。本练习探讨如何通过使用截断后验分布来正式地整合这些约束。掌握这项技术对于确保我们的统计模型尊重底层物理原理至关重要。",
            "id": "3544135",
            "problem": "考虑在手征有效场论 (Chiral Effective Field Theory, EFT) 中，对核子-核子势中的单个相互作用强度参数 $\\theta$ 进行贝叶斯校准。假设一个计算模型 $M(\\theta)$ 预测一个低能可观测量向量，并且数据向量 $d$ 由一个高斯似然函数建模，该似然函数包含加性模型差异和测量噪声。在工作点附近对 $M(\\theta)$ 进行线性化并使用扩散先验的条件下，$\\theta$ 的后验密度可以很好地近似为一个均值为 $\\mu$、方差为 $\\sigma^{2}$ 的高斯分布，但物理学施加了正性约束 $\\theta>0$，因为 $\\theta$ 代表相互作用中一个严格为正的短程调节器振幅。因此，得到的后验分布被截断到半条直线上：\n$$\np(\\theta\\mid d)\\propto \\mathcal{N}(\\mu,\\sigma^{2})\\,\\mathbf{1}_{\\{\\theta>0\\}},\n$$\n其中 $\\mathcal{N}(\\mu,\\sigma^{2})$ 表示均值为 $\\mu$、方差为 $\\sigma^{2}$ 的高斯密度，$\\mathbf{1}_{\\{\\theta>0\\}}$ 强制施加物理约束。\n\n从贝叶斯定理和高斯概率密度函数的定义出发，推导并计算：\n1. 使 $p(\\theta\\mid d)$ 成为 $(0,\\infty)$ 上的正常概率密度所需的归一化常数 $Z=\\int_{0}^{\\infty}\\mathcal{N}(\\mu,\\sigma^{2})\\,\\mathrm{d}\\theta$。\n2. 截断后验均值 $\\mathbb{E}[\\theta\\mid d,\\theta>0]$。\n\n将两个结果都以 $\\mu$、$\\sigma$、标准正态概率密度函数 $\\phi(x)$ 和标准正态累积分布函数 $\\Phi(x)$ 的封闭形式表示。不要为 $\\mu$ 或 $\\sigma$ 假设任何数值。你的最终答案必须是单个解析表达式；将两个量一起呈现在一个单行矩阵中。无需四舍五入，最终答案中不应报告任何物理单位。",
            "solution": "该问题要求推导截断正态分布的归一化常数和后验均值。问题陈述在科学上是合理的、适定的和客观的。它在核物理中贝叶斯参数估计的有效物理背景下，提出了一个标准的统计计算。我们进行推导。\n\n参数 $\\theta$ 的未归一化后验密度被给出为与高斯密度成正比，但限制在正半直线 $\\theta > 0$上。令 $\\mathcal{N}(\\theta; \\mu, \\sigma^2)$ 表示均值为 $\\mu$、方差为 $\\sigma^2$ 的正态分布的概率密度函数 (PDF)。\n$$\n\\mathcal{N}(\\theta; \\mu, \\sigma^2) = \\frac{1}{\\sigma\\sqrt{2\\pi}} \\exp\\left(-\\frac{(\\theta-\\mu)^2}{2\\sigma^2}\\right)\n$$\n未归一化的后验为 $p_{\\text{un}}(\\theta) = \\mathcal{N}(\\theta; \\mu, \\sigma^2)$（对于 $\\theta > 0$），否则为0。归一化后的后验为 $p(\\theta \\mid d) = \\frac{1}{Z} p_{\\text{un}}(\\theta)$，其中 $Z$ 是归一化常数。\n\n**1. 归一化常数 $Z$ 的推导**\n\n归一化常数 $Z$ 是未归一化密度在其支撑域 $(0, \\infty)$ 上的积分。\n$$\nZ = \\int_{0}^{\\infty} \\mathcal{N}(\\theta; \\mu, \\sigma^2) \\, \\mathrm{d}\\theta = \\int_{0}^{\\infty} \\frac{1}{\\sigma\\sqrt{2\\pi}} \\exp\\left(-\\frac{(\\theta-\\mu)^2}{2\\sigma^2}\\right) \\, \\mathrm{d}\\theta\n$$\n为了计算这个积分，我们进行变量替换以标准化正态分布。令 $x = \\frac{\\theta - \\mu}{\\sigma}$。这意味着 $\\mathrm{d}x = \\frac{1}{\\sigma}\\mathrm{d}\\theta$，所以 $\\mathrm{d}\\theta = \\sigma \\mathrm{d}x$。积分限也必须变换：\n- 当 $\\theta = 0$ 时，下限变为 $x = \\frac{0 - \\mu}{\\sigma} = -\\frac{\\mu}{\\sigma}$。\n- 当 $\\theta \\to \\infty$ 时，上限变为 $x \\to \\infty$。\n\n将这些代入 $Z$ 的积分中：\n$$\nZ = \\int_{-\\mu/\\sigma}^{\\infty} \\frac{1}{\\sigma\\sqrt{2\\pi}} \\exp\\left(-\\frac{x^2}{2}\\right) (\\sigma \\, \\mathrm{d}x) = \\int_{-\\mu/\\sigma}^{\\infty} \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{x^2}{2}\\right) \\, \\mathrm{d}x\n$$\n被积函数是标准正态分布的PDF，记作 $\\phi(x) = \\frac{1}{\\sqrt{2\\pi}} \\exp(-\\frac{x^2}{2})$。\n$$\nZ = \\int_{-\\mu/\\sigma}^{\\infty} \\phi(x) \\, \\mathrm{d}x\n$$\n这个积分表示一个标准正态随机变量大于 $-\\frac{\\mu}{\\sigma}$ 的概率。它可以用标准正态累积分布函数 (CDF) $\\Phi(z) = \\int_{-\\infty}^{z} \\phi(x) \\, \\mathrm{d}x$ 来表示。\n在 $[a, \\infty)$ 上的积分由 $1 - \\Phi(a)$ 给出。因此，当 $a = -\\frac{\\mu}{\\sigma}$ 时：\n$$\nZ = 1 - \\Phi\\left(-\\frac{\\mu}{\\sigma}\\right)\n$$\n利用标准正态累积分布函数的对称性 $\\Phi(-z) = 1 - \\Phi(z)$，我们可以简化此表达式：\n$$\nZ = 1 - \\left(1 - \\Phi\\left(\\frac{\\mu}{\\sigma}\\right)\\right) = \\Phi\\left(\\frac{\\mu}{\\sigma}\\right)\n$$\n这是第一个要求的结果。\n\n**2. 截断后验均值 $\\mathbb{E}[\\theta\\mid d,\\theta>0]$ 的推导**\n\n后验均值，我们记作 $\\mathbb{E}[\\theta]$，是 $\\theta$ 关于归一化后验密度 $p(\\theta \\mid d)$ 的期望值。\n$$\n\\mathbb{E}[\\theta] = \\int_{0}^{\\infty} \\theta \\cdot p(\\theta \\mid d) \\, \\mathrm{d}\\theta = \\frac{1}{Z} \\int_{0}^{\\infty} \\theta \\cdot \\mathcal{N}(\\theta; \\mu, \\sigma^2) \\, \\mathrm{d}\\theta\n$$\n我们来计算分子中的积分，记作 $I_{\\text{num}}$：\n$$\nI_{\\text{num}} = \\int_{0}^{\\infty} \\theta \\frac{1}{\\sigma\\sqrt{2\\pi}} \\exp\\left(-\\frac{(\\theta-\\mu)^2}{2\\sigma^2}\\right) \\, \\mathrm{d}\\theta\n$$\n使用相同的变量替换，$x = \\frac{\\theta - \\mu}{\\sigma}$，这意味着 $\\theta = \\sigma x + \\mu$，以及相同的积分限：\n$$\nI_{\\text{num}} = \\int_{-\\mu/\\sigma}^{\\infty} (\\sigma x + \\mu) \\frac{1}{\\sigma\\sqrt{2\\pi}} \\exp\\left(-\\frac{x^2}{2}\\right) (\\sigma \\, \\mathrm{d}x) = \\int_{-\\mu/\\sigma}^{\\infty} (\\sigma x + \\mu) \\phi(x) \\, \\mathrm{d}x\n$$\n我们可以将这个积分分成两部分：\n$$\nI_{\\text{num}} = \\sigma \\int_{-\\mu/\\sigma}^{\\infty} x \\phi(x) \\, \\mathrm{d}x + \\mu \\int_{-\\mu/\\sigma}^{\\infty} \\phi(x) \\, \\mathrm{d}x\n$$\n第二个积分正是我们为计算归一化常数 $Z = \\Phi(\\frac{\\mu}{\\sigma})$ 时所计算的那个。所以，第二项是 $\\mu Z = \\mu \\Phi(\\frac{\\mu}{\\sigma})$。\n\n对于第一个积分，我们注意到标准正态概率密度函数的导数是 $\\frac{\\mathrm{d}\\phi(x)}{\\mathrm{d}x} = -x \\phi(x)$。因此，$x \\phi(x)$ 的原函数是 $-\\phi(x)$。\n$$\n\\int_{-\\mu/\\sigma}^{\\infty} x \\phi(x) \\, \\mathrm{d}x = \\left[-\\phi(x)\\right]_{-\\mu/\\sigma}^{\\infty} = \\lim_{b \\to \\infty} (-\\phi(b)) - \\left(-\\phi\\left(-\\frac{\\mu}{\\sigma}\\right)\\right)\n$$\n由于 $\\lim_{b \\to \\infty} \\phi(b) = 0$，极限项消失。由于标准正态概率密度函数的偶对称性，$\\phi(-z) = \\phi(z)$。\n$$\n\\int_{-\\mu/\\sigma}^{\\infty} x \\phi(x) \\, \\mathrm{d}x = \\phi\\left(-\\frac{\\mu}{\\sigma}\\right) = \\phi\\left(\\frac{\\mu}{\\sigma}\\right)\n$$\n将此代回 $I_{\\text{num}}$ 的表达式中：\n$$\nI_{\\text{num}} = \\sigma \\phi\\left(\\frac{\\mu}{\\sigma}\\right) + \\mu \\Phi\\left(\\frac{\\mu}{\\sigma}\\right)\n$$\n最后，后验均值为 $\\mathbb{E}[\\theta] = \\frac{I_{\\text{num}}}{Z}$：\n$$\n\\mathbb{E}[\\theta] = \\frac{\\sigma \\phi\\left(\\frac{\\mu}{\\sigma}\\right) + \\mu \\Phi\\left(\\frac{\\mu}{\\sigma}\\right)}{\\Phi\\left(\\frac{\\mu}{\\sigma}\\right)} = \\mu + \\sigma \\frac{\\phi\\left(\\frac{\\mu}{\\sigma}\\right)}{\\Phi\\left(\\frac{\\mu}{\\sigma}\\right)}\n$$\n这是第二个要求的结果。我们按照要求，将两个结果 $Z$ 和 $\\mathbb{E}[\\theta]$ 一起呈现在一个行矩阵中。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\Phi\\left(\\frac{\\mu}{\\sigma}\\right)  \\mu + \\sigma \\frac{\\phi\\left(\\frac{\\mu}{\\sigma}\\right)}{\\Phi\\left(\\frac{\\mu}{\\sigma}\\right)} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在基本概念和技巧之上，我们现在转向任何现实校准中的一个关键方面：评估参数的可辨识性。本练习引入了费雪信息矩阵（Fisher Information Matrix），这是一个强大的工具，用于诊断我们的数据究竟能够约束哪些参数组合。通过推导和计算这个矩阵，你将学会在运行昂贵的校准计算之前，如何量化实验的信息含量并发现模型中潜在的“马虎”方向。",
            "id": "3544124",
            "problem": "在核相互作用参数的贝叶斯校准中，考虑一个模型预测向量 $f(\\theta) \\in \\mathbb{R}^{n}$，它代表了 $n$ 个可观测量，是 $p$ 个参数 $\\theta \\in \\mathbb{R}^{p}$ 的函数。假设数据模型假定存在加性高斯噪声，其均值为零，协方差 $C \\in \\mathbb{R}^{n \\times n}$ 已知且为正定，并且似然函数也相应地构建。在一个名义点 $\\theta_{0}$ 附近，通过 $f(\\theta) \\approx f(\\theta_{0}) + J(\\theta - \\theta_{0})$ 将模型线性化，其中 $J \\in \\mathbb{R}^{n \\times p}$ 是雅可比矩阵，其元素 $J_{i\\alpha} = \\partial f_{i} / \\partial \\theta_{\\alpha}$ 在 $\\theta_{0}$ 处计算。\n\n任务 A：从高斯似然函数出发，并根据费雪信息矩阵 $F$ 定义为负对数似然函数的海森矩阵的期望，推导出线性化模型的费雪信息矩阵，用 $J$ 和 $C$ 表示。您的推导必须从高斯分布误差的似然函数的基本定义和费雪信息的基本定义开始，并且不得假定任何预先给出的 $F$ 的封闭形式。\n\n任务 B：根据您的推导，解释 $F$ 的特征值如何量化 $\\theta$ 的分量在 $\\theta_{0}$ 附近的局部可辨识性，即 $\\theta$ 中的小扰动是否会产生相对于噪声水平而言可区分的模型预测变化。\n\n任务 C：对于一个具体的校准问题，其中 $p = 2$ 个无量纲相互作用参数校准到 $n = 3$ 个无量纲可观测量（通过适当的归一化构建，使得所有雅可比矩阵元素都为无量纲，且 $C$ 是无量纲误差的协方差），假设在 $\\theta_{0}$ 处的雅可比矩阵和观测误差协方差为\n$$\nJ \\;=\\; \\begin{pmatrix}\n0.8  -0.2 \\\\\n0.5  0.3 \\\\\n-0.1  0.6\n\\end{pmatrix},\n\\qquad\nC \\;=\\; \\operatorname{diag}\\!\\big(0.04,\\, 0.01,\\, 0.09\\big).\n$$\n计算此线性化模型的费雪信息矩阵，然后计算定义为 $\\det(F)$ 的 D-最优性度量。提供 $\\det(F)$ 的最终数值，四舍五入到四位有效数字。由于参数和可观测量已经无量纲化，所要求的数值答案是无量纲的。最终答案必须是指定的单个实数。",
            "solution": "该问题在科学上基于统计推断和计算物理学，是有效的；问题陈述适定，包含所有必要信息，并且表述客观。我们开始解答。\n\n该问题分为三个任务。我们将依次解决它们。\n\n### 任务 A：费雪信息矩阵的推导\n\n目标是为具有高斯噪声的线性化模型推导费雪信息矩阵 $F$。$F$ 的定义是负对数似然函数的海森矩阵的期望。\n\n令数据向量为 $d \\in \\mathbb{R}^{n}$。数据模型由 $d = f(\\theta) + \\epsilon$ 给出，其中 $\\theta \\in \\mathbb{R}^{p}$ 是参数向量，$\\epsilon$ 是一个随机噪声向量。问题指出噪声是高斯的，均值为零，协方差矩阵 $C \\in \\mathbb{R}^{n \\times n}$ 已知且为正定。因此，$\\epsilon \\sim \\mathcal{N}(0, C)$。\n\n在给定参数 $\\theta$ 的情况下，数据 $d$ 的概率密度，即似然函数 $\\mathcal{L}(\\theta|d)$，由多元高斯分布给出：\n$$\n\\mathcal{L}(\\theta|d) = p(d|\\theta) = \\frac{1}{\\sqrt{(2\\pi)^{n} \\det(C)}} \\exp\\left( -\\frac{1}{2} (d - f(\\theta))^{T} C^{-1} (d - f(\\theta)) \\right)\n$$\n对数似然函数 $\\ln\\mathcal{L}(\\theta|d)$ 为：\n$$\n\\ln\\mathcal{L}(\\theta|d) = -\\frac{n}{2} \\ln(2\\pi) - \\frac{1}{2} \\ln(\\det(C)) - \\frac{1}{2} (d - f(\\theta))^{T} C^{-1} (d - f(\\theta))\n$$\n负对数似然函数，我们记为 $\\mathcal{NLL}(\\theta)$，是通过对上述表达式取负得到的。不依赖于 $\\theta$ 的项可以归为一个常数。\n$$\n\\mathcal{NLL}(\\theta) = \\text{const} + \\frac{1}{2} (d - f(\\theta))^{T} C^{-1} (d - f(\\theta))\n$$\n问题指定在名义点 $\\theta_{0}$ 附近使用 $f(\\theta)$ 的线性化模型：\n$$\nf(\\theta) \\approx f(\\theta_{0}) + J(\\theta - \\theta_{0})\n$$\n其中 $J$ 是在 $\\theta_{0}$ 处计算的雅可比矩阵。将此代入 $\\mathcal{NLL}(\\theta)$ 的表达式中：\n$$\nd - f(\\theta) \\approx d - [f(\\theta_{0}) + J(\\theta - \\theta_{0})] = [d - f(\\theta_{0})] - J(\\theta - \\theta_{0})\n$$\n令名义点处的残差为 $r_{0} = d - f(\\theta_{0})$。那么，$d - f(\\theta) \\approx r_{0} - J(\\theta - \\theta_{0})$。\n线性化模型的负对数似然函数为：\n$$\n\\mathcal{NLL}(\\theta) \\approx \\text{const} + \\frac{1}{2} (r_{0} - J(\\theta - \\theta_{0}))^{T} C^{-1} (r_{0} - J(\\theta - \\theta_{0}))\n$$\n费雪信息矩阵 $F$ 是一个 $p \\times p$ 矩阵，其元素为 $F_{\\alpha\\beta} = E_d \\left[ \\frac{\\partial^2 \\mathcal{NLL}}{\\partial \\theta_{\\alpha} \\partial \\theta_{\\beta}} \\right]$。首先，我们计算 $\\mathcal{NLL}(\\theta)$ 的海森矩阵 $H_{\\mathcal{NLL}}$。为此，我们先求梯度 $\\nabla_{\\theta} \\mathcal{NLL}$。\n令 $v(\\theta) = r_{0} - J(\\theta - \\theta_{0})$。二次项为 $\\frac{1}{2} v(\\theta)^{T} C^{-1} v(\\theta)$。这个二次型关于分量 $\\theta_{\\alpha}$ 的导数为：\n$$\n\\frac{\\partial}{\\partial \\theta_{\\alpha}} \\left( \\frac{1}{2} v^{T} C^{-1} v \\right) = \\left( \\frac{\\partial v}{\\partial \\theta_{\\alpha}} \\right)^{T} C^{-1} v\n$$\n向量 $v(\\theta)$ 关于 $\\theta_{\\alpha}$ 的偏导数是 $v$ 关于 $\\theta$ 的雅可比矩阵的第 $\\alpha$ 列，即 $-J$。所以，$\\frac{\\partial v_i}{\\partial \\theta_\\alpha} = -J_{i\\alpha}$。这意味着导数向量是 $-J$ 的第 $\\alpha$ 列，记为 $(-J)_{:,\\alpha}$。\n$$\n\\left( \\frac{\\partial v}{\\partial \\theta_{\\alpha}} \\right) = (-J)_{:,\\alpha}\n$$\n因此梯度分量是：\n$$\n\\frac{\\partial \\mathcal{NLL}}{\\partial \\theta_{\\alpha}} = ((-J)_{:,\\alpha})^{T} C^{-1} v = ((-J)^{T}C^{-1}v)_{\\alpha}\n$$\n完整的梯度向量是：\n$$\n\\nabla_{\\theta} \\mathcal{NLL} = (-J)^{T} C^{-1} v(\\theta) = -J^{T} C^{-1} (r_{0} - J(\\theta - \\theta_{0}))\n$$\n现在我们通过对梯度关于 $\\theta_{\\beta}$ 求导来计算海森矩阵：\n$$\n\\frac{\\partial^2 \\mathcal{NLL}}{\\partial \\theta_{\\beta} \\partial \\theta_{\\alpha}} = \\frac{\\partial}{\\partial \\theta_{\\beta}} \\left[ -J^{T} C^{-1} r_{0} + J^{T} C^{-1} J (\\theta - \\theta_{0}) \\right]_{\\alpha}\n$$\n项 $-J^{T} C^{-1} r_{0}$ 关于 $\\theta$ 是常数。第二项是矩阵 $J^{T} C^{-1} J$ 乘以向量 $(\\theta - \\theta_{0})$。\n$$\n\\frac{\\partial}{\\partial \\theta_{\\beta}} \\left[ \\sum_{\\gamma=1}^{p} (J^{T} C^{-1} J)_{\\alpha\\gamma} (\\theta_{\\gamma} - (\\theta_{0})_{\\gamma}) \\right] = (J^{T} C^{-1} J)_{\\alpha\\beta}\n$$\n这对所有的 $\\alpha, \\beta$ 都成立。因此，海森矩阵是：\n$$\nH_{\\mathcal{NLL}}(\\theta) = J^{T} C^{-1} J\n$$\n线性化模型的一个关键特征是其海森矩阵是常数，既不依赖于 $\\theta$ 也不依赖于数据 $d$（$d$ 包含在 $r_0$ 中）。\n最后一步是对数据 $d$ 取期望。由于海森矩阵不依赖于 $d$，期望就是该矩阵本身。\n$$\nF = E_d[H_{\\mathcal{NLL}}(\\theta)] = E_d[J^{T} C^{-1} J] = J^{T} C^{-1} J\n$$\n至此完成了任务 A 的推导。\n\n### 任务 B：F 特征值的解释\n\n费雪信息矩阵 $F = J^{T} C^{-1} J$ 量化了可观测量数据提供的关于未知参数 $\\theta$ 的信息量。$F$ 的特征值就此信息提供了关于参数可辨识性的具体几何解释。\n\n考虑参数在名义点 $\\theta_{0}$ 附近的一个小扰动 $\\delta\\theta$。这会导致模型预测发生变化，$\\delta f = f(\\theta_0 + \\delta\\theta) - f(\\theta_0) \\approx J \\delta\\theta$。这一变化的显著性必须相对于观测噪声进行评估，而观测噪声由协方差矩阵 $C$ 表征。马氏距离的平方 $\\delta f^{T} C^{-1} \\delta f$ 衡量了在数据空间中，由逆协方差加权后，变化量 $\\delta f$ 与原点之间的距离的平方。它是一个无量纲的度量，衡量了变化量 $\\delta f$ 与典型噪声涨落的可区分程度。\n\n我们可以通过考虑二次型 $\\delta\\theta^{T} F \\delta\\theta$ 将其与 $F$ 直接联系起来：\n$$\n\\delta\\theta^{T} F \\delta\\theta = \\delta\\theta^{T} (J^{T} C^{-1} J) \\delta\\theta = (J \\delta\\theta)^{T} C^{-1} (J \\delta\\theta) = \\delta f^{T} C^{-1} \\delta f\n$$\n这表明 $\\delta\\theta^{T} F \\delta\\theta$ 正是模型输出变化的统计“距离”或可区分性的平方。\n\n现在，设 $F$ 的特征分解为 $F = V \\Lambda V^{T}$，其中 $V$ 是一个正交矩阵，其列 $v_k$ 是 $F$ 的特征向量，$\\Lambda$ 是由相应特征值 $\\lambda_k$ 构成的对角矩阵。特征向量 $\\{v_k\\}$ 构成了参数空间的一个标准正交基。\n\n如果我们选择一个沿着特定特征向量的扰动 $\\delta\\theta = \\epsilon v_k$（其中 $\\epsilon$ 是一个很小的量值），可区分性度量变为：\n$$\n\\delta\\theta^{T} F \\delta\\theta = (\\epsilon v_k)^{T} F (\\epsilon v_k) = \\epsilon^{2} v_k^{T} F v_k = \\epsilon^{2} v_k^{T} (\\lambda_k v_k) = \\epsilon^{2} \\lambda_k \\|v_k\\|^2 = \\epsilon^{2} \\lambda_k\n$$\n因此，特征值 $\\lambda_k$ 是参数沿特征向量 $v_k$ 方向单位平方扰动所引起的模型输出变化的可区分性。\n- **大的特征值 $\\lambda_k$** 意味着即使由 $v_k$ 定义的参数组合发生微小扰动，也会导致模型预测产生大的、统计上显著的变化。称该参数组合被数据“刚性”或**良好辨识**。数据对这个方向的变化是敏感的。\n- **小的特征值 $\\lambda_k$** 意味着即使由 $v_k$ 定义的参数组合发生较大扰动，也只会在模型预测中产生微小的、统计上不显著的变化，这种变化很难与噪声区分开来。称该参数组合是“马虎的”或**辨识不良的**。数据几乎不能提供信息来约束这个参数组合。\n\n总之，$F$ 的特征值量化了不同参数线性组合的局部可辨识性，而特征向量定义了这些组合的方向。特征值谱揭示了参数敏感性的一个层级结构。\n\n### 任务 C：数值计算\n\n给定雅可比矩阵 $J$ 和协方差矩阵 $C$：\n$$\nJ = \\begin{pmatrix}\n0.8  -0.2 \\\\\n0.5  0.3 \\\\\n-0.1  0.6\n\\end{pmatrix},\n\\qquad\nC = \\begin{pmatrix}\n0.04  0  0 \\\\\n0  0.01  0 \\\\\n0  0  0.09\n\\end{pmatrix}\n$$\n首先，我们计算协方差矩阵的逆 $C^{-1}$。由于 $C$ 是对角矩阵，$C^{-1}$ 也是对角矩阵，其对角元素是 $C$ 对角元素的倒数。\n$$\nC^{-1} = \\begin{pmatrix}\n1/0.04  0  0 \\\\\n0  1/0.01  0 \\\\\n0  0  1/0.09\n\\end{pmatrix} = \\begin{pmatrix}\n25  0  0 \\\\\n0  100  0 \\\\\n0  0  100/9\n\\end{pmatrix}\n$$\n接下来，我们使用任务 A 中的公式 $F = J^{T} C^{-1} J$ 计算费雪信息矩阵。\n$J$ 的转置是：\n$$\nJ^{T} = \\begin{pmatrix}\n0.8  0.5  -0.1 \\\\\n-0.2  0.3  0.6\n\\end{pmatrix}\n$$\n我们首先计算乘积 $J^{T} C^{-1}$：\n$$\nJ^{T} C^{-1} = \\begin{pmatrix}\n0.8  0.5  -0.1 \\\\\n-0.2  0.3  0.6\n\\end{pmatrix}\n\\begin{pmatrix}\n25  0  0 \\\\\n0  100  0 \\\\\n0  0  100/9\n\\end{pmatrix}\n= \\begin{pmatrix}\n(0.8)(25)  (0.5)(100)  (-0.1)(100/9) \\\\\n(-0.2)(25)  (0.3)(100)  (0.6)(100/9)\n\\end{pmatrix}\n$$\n$$\nJ^{T} C^{-1} = \\begin{pmatrix}\n20  50  -10/9 \\\\\n-5  30  60/9\n\\end{pmatrix} = \\begin{pmatrix}\n20  50  -10/9 \\\\\n-5  30  20/3\n\\end{pmatrix}\n$$\n现在我们将此结果乘以 $J$ 以得到 $F$：\n$$\nF = (J^{T} C^{-1}) J = \\begin{pmatrix}\n20  50  -10/9 \\\\\n-5  30  20/3\n\\end{pmatrix}\n\\begin{pmatrix}\n0.8  -0.2 \\\\\n0.5  0.3 \\\\\n-0.1  0.6\n\\end{pmatrix}\n$$\n$2 \\times 2$ 矩阵 $F$ 的元素是：\n$$\nF_{11} = (20)(0.8) + (50)(0.5) + (-10/9)(-0.1) = 16 + 25 + 1/9 = 41 + 1/9 = \\frac{369}{9} + \\frac{1}{9} = \\frac{370}{9}\n$$\n$$\nF_{12} = (20)(-0.2) + (50)(0.3) + (-10/9)(0.6) = -4 + 15 - 6/9 = 11 - 2/3 = \\frac{33}{3} - \\frac{2}{3} = \\frac{31}{3}\n$$\n$$\nF_{21} = (-5)(0.8) + (30)(0.5) + (20/3)(-0.1) = -4 + 15 - 2/3 = 11 - 2/3 = \\frac{31}{3}\n$$\n正如费雪矩阵所预期的，$F_{12} = F_{21}$。\n$$\nF_{22} = (-5)(-0.2) + (30)(0.3) + (20/3)(0.6) = 1 + 9 + 12/3 = 10 + 4 = 14\n$$\n所以，费雪信息矩阵是：\n$$\nF = \\begin{pmatrix}\n370/9  31/3 \\\\\n31/3  14\n\\end{pmatrix}\n$$\nD-最优性度量是 $F$ 的行列式 $\\det(F)$。\n$$\n\\det(F) = F_{11} F_{22} - F_{12} F_{21} = \\left(\\frac{370}{9}\\right)(14) - \\left(\\frac{31}{3}\\right)^2\n$$\n$$\n\\det(F) = \\frac{370 \\times 14}{9} - \\frac{31^2}{9} = \\frac{5180}{9} - \\frac{961}{9} = \\frac{5180 - 961}{9} = \\frac{4219}{9}\n$$\n为了得到最终的数值，我们进行除法运算：\n$$\n\\det(F) = \\frac{4219}{9} \\approx 468.777...\n$$\n四舍五入到四位有效数字，我们得到 $468.8$。",
            "answer": "$$\n\\boxed{468.8}\n$$"
        }
    ]
}