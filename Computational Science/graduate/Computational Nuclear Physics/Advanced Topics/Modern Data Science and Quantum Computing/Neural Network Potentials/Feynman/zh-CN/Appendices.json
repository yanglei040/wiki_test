{
    "hands_on_practices": [
        {
            "introduction": "在训练神经网络势（NNP）时，正确处理具有物理单位的输入和输出至关重要。我们必须确保维度一致性，并利用归一化来稳定训练过程。本练习将指导您设计一个稳健的数据处理流程，该流程能正确处理物理尺度（如 $ \\text{MeV} $ 和 $ \\text{fm} $），并运用标准化方法进行有效训练，这是任何基于物理的机器学习项目中的关键第一步 。",
            "id": "3571829",
            "problem": "一个用于核子-核子相互作用的神经网络势（NNP）经过训练，将从相对坐标 $\\mathbf{r} = \\mathbf{r}_1 - \\mathbf{r}_2$ 导出的结构描述符映射到一个标量势能 $E$。训练数据集以兆电子伏（$\\,\\mathrm{MeV}$）为单位提供能量，以飞米（$\\,\\mathrm{fm}$）为单位提供位置。该模型也用于力匹配，其中力由基本关系 $\\mathbf{F} = -\\nabla_{\\mathbf{r}} E$ 定义。学习到的NNP应在推断时为 $E$ 和 $\\mathbf{F}$ 生成物理上一致的单位，其训练应通过适当的输入和输出归一化来稳定，同时不扭曲物理原理或造成量纲不一致。\n\n假设存在距离和能量的特征核尺度，并且在训练期间可以获得小批量统计数据。选择一个选项，该选项指定了一种编码和归一化策略，该策略 (i) 通过链式法则确保 $E$（单位为 $\\,\\mathrm{MeV}$）和 $\\mathbf{F}$（单位为 $\\,\\mathrm{MeV}/\\mathrm{fm}$）的量纲一致性，并且 (ii) 证明了一种归一化方法的合理性，该方法通过控制特征和目标的尺度来稳定训练，同时在推断时保留物理可解释性。\n\nA. 使用固定的物理长度尺度 $r_0$（例如 $r_0 \\approx 1\\,\\mathrm{fm}$）定义无量纲输入 $\\tilde{\\mathbf{r}} = \\mathbf{r}/r_0$，并使用固定的能量尺度 $E_0$（例如 $E_0 \\approx 100\\,\\mathrm{MeV}$）定义无量纲能量 $\\tilde{E} = E/E_0$。训练NNP以从标准化的无量纲特征 $\\hat{\\mathbf{r}} = (\\tilde{\\mathbf{r}} - \\boldsymbol{\\mu}_{\\tilde{\\mathbf{r}}})/\\boldsymbol{\\sigma}_{\\tilde{\\mathbf{r}}}$ 预测标准化的无量纲目标 $\\hat{E} = (\\tilde{E} - \\mu_{\\tilde{E}})/\\sigma_{\\tilde{E}}$。在推断时，反转标准化和缩放以恢复 $E = E_0 \\tilde{E}$。通过链式法则计算力 $\\mathbf{F} = -\\nabla_{\\mathbf{r}} E = -(E_0/r_0)\\,\\nabla_{\\tilde{\\mathbf{r}}} \\tilde{E}$，以确保单位为 $\\,\\mathrm{MeV}/\\mathrm{fm}$。\n\nB. 使用 $\\hbar c$ 将位置从 $\\,\\mathrm{fm}$ 转换为 $\\,\\mathrm{MeV}^{-1}$，并输入单位为 $\\,\\mathrm{MeV}^{-1}$ 的 $\\mathbf{r}$，同时保持 $E$ 的单位为 $\\,\\mathrm{MeV}$。在原始（未标准化的）输入和输出上进行训练。将力计算为 $\\mathbf{F} = -\\nabla_{\\mathbf{r}} E$（相对于转换后的坐标），但在梯度计算中不包含任何将单位转换回 $\\,\\mathrm{fm}$ 的转换因子。\n\nC. 应用最小-最大归一化将整个数据集的 $r$ 和 $E$ 映射到 $[0,1]$ 区间。在这些归一化单位中训练NNP，并在推断时将预测的能量重新缩放回 $\\,\\mathrm{MeV}$。对于力匹配，将 $\\mathbf{F}$ 计算为相对于归一化坐标的梯度，而不显式考虑归一化坐标与 $\\,\\mathrm{fm}$ 之间的重缩放因子。\n\nD. 选择 $r_0$ 和 $E_0$ 分别作为数据集 $r$ 和 $E$ 的标准差，设置 $\\tilde{\\mathbf{r}} = \\mathbf{r}/r_0$ 和 $\\tilde{E} = E/E_0$，并且仅在 $\\tilde{\\mathbf{r}}$ 和 $\\tilde{E}$ 上进行训练，不进行进一步的标准化。在推断时，恢复 $E = E_0 \\tilde{E}$ 并通过 $\\mathbf{F} = -(E_0/r_0)\\,\\nabla_{\\tilde{\\mathbf{r}}} \\tilde{E}$ 计算力。论证使用数据驱动的 $r_0$ 和 $E_0$ 足以保证训练稳定性和量纲一致性。\n\n哪个选项最符合上述标准 (i) 和 (ii)？",
            "solution": "该问题要求评估用于训练核子-核子相互作用的神经网络势（NNP）的不同编码和归一化策略。关键标准是 (i) 保持能量 $E$ 和力 $\\mathbf{F}$ 的量纲一致性，以及 (ii) 采用一种能够稳定训练同时保留物理可解释性的归一化策略。\n\n首先，让我们验证问题陈述。\n\n### 第一步：提取已知条件\n-   系统是核子-核子相互作用，由一个NNP建模。\n-   NNP将从相对坐标 $\\mathbf{r} = \\mathbf{r}_1 - \\mathbf{r}_2$ 导出的结构描述符映射到一个标量势能 $E$。\n-   训练数据以兆电子伏（$\\,\\mathrm{MeV}$）为单位提供能量 $E$。\n-   训练数据以飞米（$\\,\\mathrm{fm}$）为单位提供位置 $\\mathbf{r}$。\n-   力由基本关系 $\\mathbf{F} = -\\nabla_{\\mathbf{r}} E$ 定义。\n-   NNP必须在推断时为 $E$（单位 $\\,\\mathrm{MeV}$）和 $\\mathbf{F}$（单位 $\\,\\mathrm{MeV}/\\mathrm{fm}$）生成物理上一致的单位。\n-   训练必须通过适当的输入和输出归一化来稳定。\n-   归一化不得扭曲物理原理或引入量纲不一致性。\n-   假设存在距离和能量的特征核尺度。\n-   假设在训练期间可以获得小批量统计数据。\n-   任务是选择最能满足标准 (i) 和 (ii) 的编码和归一化策略选项。\n\n### 第二步：使用提取的已知条件进行验证\n-   **科学上可靠：** 该问题牢固地植根于计算核物理和机器学习领域。NNP是模拟粒子间相互作用的标准现代工具。关系式 $\\mathbf{F} = -\\nabla E$ 是经典力学的基石，并在此处得到正确应用。单位（$\\,\\mathrm{MeV}$、$\\,\\mathrm{fm}$）是该领域的标准单位。为神经网络训练进行输入/输出归一化的概念是机器学习的基本实践。该问题在科学上是合理的。\n-   **定义明确：** 该问题提供了一个明确的目标：根据两个明确定义的标准（量纲一致性和有效、可解释的归一化）来评估四种不同的策略。它的结构使得选项中有且只有一个最佳答案。\n-   **客观：** 语言技术性强且精确。评估标准是客观的，基于物理学和机器学习的既定原则。\n\n### 第三步：结论与行动\n问题陈述是有效的。它在科学上合理、定义明确且客观。我将通过推导核心原则然后评估每个选项来继续解决问题。\n\n### 基于原理的推导\n构建一个物理信息informed的NNP的稳健策略涉及几个必须正确串联的步骤。\n\n1.  **量纲分析与物理缩放**：物理量具有量纲：$[\\mathbf{r}] = \\text{长度}$（给定单位为 $\\,\\mathrm{fm}$）和 $[E] = \\text{能量}$（给定单位为 $\\,\\mathrm{MeV}$）。力是势能的负梯度，$\\mathbf{F} = -\\nabla_{\\mathbf{r}} E$。梯度算子 $\\nabla_{\\mathbf{r}}$ 的单位是 $\\text{长度}^{-1}$。因此，力的单位必须是 $\\text{能量}/\\text{长度}$，具体为 $\\,\\mathrm{MeV}/\\mathrm{fm}$。任何有效的方案都必须遵守这一点。\n    一个常见的首要步骤是使用特征物理尺度 $r_0$（例如 $r_0 = 1\\,\\mathrm{fm}$）和 $E_0$（例如 $E_0 = 100\\,\\mathrm{MeV}$）对输入和输出进行无量纲化。\n    令 $\\tilde{\\mathbf{r}} = \\mathbf{r}/r_0$ 和 $\\tilde{E} = E/E_0$。$\\tilde{\\mathbf{r}}$ 和 $\\tilde{E}$ 都是无量纲的。物理势能则为 $E = E_0 \\tilde{E}$。\n    力可以通过链式法则计算：\n    $$ \\mathbf{F} = -\\nabla_{\\mathbf{r}} E = -\\nabla_{\\mathbf{r}} (E_0 \\tilde{E}(\\tilde{\\mathbf{r}}(\\mathbf{r}))) $$\n    由于 $\\tilde{\\mathbf{r}} = \\mathbf{r}/r_0$，这个变换的雅可比矩阵是 $\\frac{\\partial \\tilde{\\mathbf{r}}}{\\partial \\mathbf{r}} = \\frac{1}{r_0} \\mathbf{I}$，其中 $\\mathbf{I}$ 是单位矩阵。因此，$\\nabla_{\\mathbf{r}} = \\frac{1}{r_0} \\nabla_{\\tilde{\\mathbf{r}}}$。\n    将此代入力方程得到：\n    $$ \\mathbf{F} = -E_0 \\left( \\frac{1}{r_0} \\nabla_{\\tilde{\\mathbf{r}}} \\right) \\tilde{E} = -\\frac{E_0}{r_0} \\nabla_{\\tilde{\\mathbf{r}}} \\tilde{E} $$\n    前置因子 $E_0/r_0$ 正确地携带了 $\\,\\mathrm{MeV}/\\mathrm{fm}$ 的单位。这个框架满足标准 (i)。\n\n2.  **为保证训练稳定性的归一化**：当神经网络的输入和输出在数值上表现良好时（通常以 $0$ 为中心，标准差约为 $1$），训练效果最佳。无量纲量 $\\tilde{\\mathbf{r}}$ 和 $\\tilde{E}$ 可能不满足此条件。因此，需要第二个统计归一化步骤。标准化（或Z分数归一化）是实现此目的的稳健方法。\n    令 $\\hat{\\mathbf{r}}$ 和 $\\hat{E}$ 为网络实际看到和预测的标准化变量：\n    $$ \\hat{\\mathbf{r}} = \\frac{\\tilde{\\mathbf{r}} - \\boldsymbol{\\mu}_{\\tilde{\\mathbf{r}}}}{\\boldsymbol{\\sigma}_{\\tilde{\\mathbf{r}}}} \\quad \\text{和} \\quad \\hat{E} = \\frac{\\tilde{E} - \\mu_{\\tilde{E}}}{\\sigma_{\\tilde{E}}} $$\n    这里，$\\boldsymbol{\\mu}$ 和 $\\boldsymbol{\\sigma}$ 分别是各自分布的均值和标准差，通常在训练集上计算或从小批量数据中动态计算。NNP学习映射关系 $\\hat{E} = \\mathcal{N}(\\hat{\\mathbf{r}})$。\n    为了在推断时恢复物理量，必须反转这些变换：\n    $\\tilde{E} = \\hat{E} \\sigma_{\\tilde{E}} + \\mu_{\\tilde{E}}$，然后 $E = E_0 \\tilde{E}$。\n    这个两步过程（物理缩放后跟统计标准化）提供了稳定的训练（标准 ii），同时为返回物理量提供了清晰的路径，从而保留了可解释性。\n\n现在，我们根据这个框架评估每个选项。\n\n### 逐项分析\n\n**A. 使用固定的物理长度尺度 $r_0$（例如 $r_0 \\approx 1\\,\\mathrm{fm}$）定义无量纲输入 $\\tilde{\\mathbf{r}} = \\mathbf{r}/r_0$，并使用固定的能量尺度 $E_0$（例如 $E_0 \\approx 100\\,\\mathrm{MeV}$）定义无量纲能量 $\\tilde{E} = E/E_0$。训练NNP以从标准化的无量纲特征 $\\hat{\\mathbf{r}} = (\\tilde{\\mathbf{r}} - \\boldsymbol{\\mu}_{\\tilde{\\mathbf{r}}})/\\boldsymbol{\\sigma}_{\\tilde{\\mathbf{r}}}$ 预测标准化的无量纲目标 $\\hat{E} = (\\tilde{E} - \\mu_{\\tilde{E}})/\\sigma_{\\tilde{E}}$。在推断时，反转标准化和缩放以恢复 $E = E_0 \\tilde{E}$。通过链式法则计算力 $\\mathbf{F} = -\\nabla_{\\mathbf{r}} E = -(E_0/r_0)\\,\\nabla_{\\tilde{\\mathbf{r}}} \\tilde{E}$，以确保单位为 $\\,\\mathrm{MeV}/\\mathrm{fm}$。**\n\n该选项精确地遵循了上文概述的稳健的两步流程。\n-   **(i) 量纲一致性**：它正确地使用物理尺度 $r_0$ 和 $E_0$ 来形成无量纲量。力的计算 $\\mathbf{F} = -(E_0/r_0)\\nabla_{\\tilde{\\mathbf{r}}} \\tilde{E}$ 正确应用了链式法则，确保最终的力具有 $E_0/r_0$ 的单位，即 $\\,\\mathrm{MeV}/\\mathrm{fm}$。梯度 $\\nabla_{\\tilde{\\mathbf{r}}} \\tilde{E}$ 本身是通过对NNP输出 $\\hat{E} = \\mathcal{N}(\\hat{\\mathbf{r}})$ 应用穿过标准化层的链式法则来计算的，这是用于训练的自动微分框架中的标准做法。\n-   **(ii) 训练稳定性与可解释性**：它提出了对无量纲、物理缩放后的输入和输出进行标准化。这是稳定神经网络训练的一种标准且高效的技术。使用固定的物理尺度 $r_0$ 和 $E_0$ 为无量纲化提供了清晰、可解释的物理基础，这与数据集的统计属性是分开的。这种分离使模型更稳健且更易于解释。\n\n**结论：** **正确**。该选项描述了一种方法，该方法在物理上合理、量纲一致，并遵循了稳定机器学习的最佳实践。\n\n**B. 使用 $\\hbar c$ 将位置从 $\\,\\mathrm{fm}$ 转换为 $\\,\\mathrm{MeV}^{-1}$，并输入单位为 $\\,\\mathrm{MeV}^{-1}$ 的 $\\mathbf{r}$，同时保持 $E$ 的单位为 $\\,\\mathrm{MeV}$。在原始（未标准化的）输入和输出上进行训练。将力计算为 $\\mathbf{F} = -\\nabla_{\\mathbf{r}} E$（相对于转换后的坐标），但在梯度计算中不包含任何将单位转换回 $\\,\\mathrm{fm}$ 的转换因子。**\n\n-   **(i) 量纲一致性**：令转换后的坐标为 $\\mathbf{r}' = \\mathbf{r}/(\\hbar c)$，其单位为 $\\,\\mathrm{MeV}^{-1}$。相对于此坐标的梯度 $\\nabla_{\\mathbf{r}'} E$ 的单位为 $\\,\\mathrm{MeV}/\\mathrm{MeV}^{-1} = \\mathrm{MeV}^2$。这不是力的单位。该选项明确指出不包括获得正确单位所需的转换因子 $1/(\\hbar c)$。因此，该过程违反了量纲一致性。\n-   **(ii) 训练稳定性**：它建议在原始、未标准化的输入和输出上进行训练。众所周知，这是次优的，可能导致训练不稳定，尤其是在处理核物理中遇到的宽范围能量和坐标时。\n\n**结论：** **错误**。该方法在力的计算上量纲不一致，并使用了较差的训练策略。\n\n**C. 应用最小-最大归一化将整个数据集的 $r$ 和 $E$ 映射到 $[0,1]$ 区间。在这些归一化单位中训练NNP，并在推断时将预测的能量重新缩放回 $\\,\\mathrm{MeV}$。对于力匹配，将 $\\mathbf{F}$ 计算为相对于归一化坐标的梯度，而不显式考虑归一化坐标与 $\\,\\mathrm{fm}$ 之间的重缩放因子。**\n\n-   **(i) 量纲一致性**：令 $r_{norm} = (r - r_{min})/(r_{max} - r_{min})$ 和 $E_{norm} = (E - E_{min})/(E_{max} - E_{min})$。网络学习 $E_{norm}(r_{norm})$。物理力涉及因子 $\\nabla_{\\mathbf{r}} E \\propto \\frac{E_{max} - E_{min}}{r_{max} - r_{min}} \\nabla_{r_{norm}} E_{norm}$。该选项声称计算力时不带此重缩放因子。项 $\\nabla_{r_{norm}} E_{norm}$ 是一个无量纲量相对于另一个无量纲量的梯度，因此它是无量纲的。这不可能是物理力。该方法量纲不一致。\n-   **(ii) 训练稳定性**：最小-最大归一化确实可以缩放特征，但它对异常值敏感，这可能将大部分数据压缩到 $[0, 1]$ 内的一个非常小的范围内。标准化（如选项A）通常更稳健。此外，这些尺度纯粹是数据驱动的，缺乏使用固定尺度（如 $r_0$ 和 $E_0$）所具有的清晰物理可解释性。\n\n**结论：** **错误**。该方法在力计算的量纲一致性上失败。\n\n**D. 选择 $r_0$ 和 $E_0$ 分别作为数据集 $r$ 和 $E$ 的标准差，设置 $\\tilde{\\mathbf{r}} = \\mathbf{r}/r_0$ 和 $\\tilde{E} = E/E_0$，并且仅在 $\\tilde{\\mathbf{r}}$ 和 $\\tilde{E}$ 上进行训练，不进行进一步的标准化。在推断时，恢复 $E = E_0 \\tilde{E}$ 并通过 $\\mathbf{F} = -(E_0/r_0)\\,\\nabla_{\\tilde{\\mathbf{r}}} \\tilde{E}$ 计算力。论证使用数据驱动的 $r_0$ 和 $E_0$ 足以保证训练稳定性和量纲一致性。**\n\n-   **(i) 量纲一致性**：力的计算 $\\mathbf{F} = -(E_0/r_0)\\nabla_{\\tilde{\\mathbf{r}}} \\tilde{E}$ 在量纲上是正确的，因为 $E_0 = \\sigma_E$ 的单位是 $\\,\\mathrm{MeV}$，$r_0 = \\sigma_r$ 的单位是 $\\,\\mathrm{fm}$。此标准得到满足。\n-   **(ii) 训练稳定性**：此方法是一种缩放形式，但不是完全的标准化。它通过标准差缩放数据，但不减去均值。对于许多NNP激活函数（如 $\\tanh$），以 $0$ 为中心的输入对于有效训练至关重要。通过省略均值减法，与选项A中提出的完全标准化相比，此方法对于训练稳定性的效果是次优的。认为这“足以”的论点很弱；它不是*最好*或最稳健的策略。选项A描述了严格更优的归一化过程。\n\n**结论：** **错误**。虽然在量纲上一致，但该选项提出的归一化策略是次优的，其在训练稳定性方面的效果和稳健性不如选项A中所述的策略。\n\n### 总结\n选项A描述了最完整和最正确的方法。它通过基于物理缩放正确应用链式法则，恰当地确保了量纲一致性。同时，它采用了一种稳健的两级归一化方案（物理缩放后跟统计标准化），非常适合稳定神经网络训练，同时保持与底层物理的清晰联系。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "现代神经网络势的一个关键优势是能够将基本物理原理直接融入其架构中。在本练习中，我们将探讨如何利用同位旋对称性（核力中一个至关重要的近似对称性）来构建NNP。您将学习如何设计一个能够明确分离核相互作用中标量和矢量分量的神经网络结构，从而使模型能够同时从质子-质子、中子-中子和中子-质子数据中学习，并遵守这一核心物理对称性 。",
            "id": "3571865",
            "problem": "考虑一个为核子-核子相互作用设计的、并遵循近似同位旋对称性的神经网络势 (NNP)。设算符基包含一个同位旋标量分量和一个与泡利同位旋标积成正比的同位旋矢量分量，因此在给定的运动学构型（例如，相对分离、相对动量、自旋算符期望值）下，势可以写为\n$$\nV = V_0(\\mathbf{x}) + V_1(\\mathbf{x})\\,\\boldsymbol{\\tau}_1\\cdot\\boldsymbol{\\tau}_2,\n$$\n其中 $\\boldsymbol{\\tau}_i$ 是作用于核子 $i$ 的泡利同位旋算符，$\\mathbf{x}$ 集合了非同位旋输入。假设训练数据可从质子-质子 (pp)、中子-中子 (nn) 和中子-质子 (np) 道的选定分波中获得，这些分波的总同位旋 $T$ 可由量子数确定。忽略电磁效应，但在 pp 道中有一个显式的库仑贡献，它被视为一个已知的附加项。假设近似的电荷无关性，因此在相同的同位旋道中，pp 和 nn 除了库仑作用和微小的电荷依赖修正外，共享相同的强相互作用。\n\n基于同位旋代数以及到单位算符和 $\\boldsymbol{\\tau}_1\\cdot\\boldsymbol{\\tau}_2$ 上的投影，以下哪个选项给出了一对正确的投影公式，用于从同位旋单态 ($T=0$) 和同位旋三重态 ($T=1$) 道的矩阵元中提取 $V_0$ 和 $V_1$，并同时提供一个科学合理的训练目标和数据使用策略，该策略使用 pp、nn 和 np 数据在单个 NNP 中拟合这些分量？\n\nA. 使用恒等式 $\\boldsymbol{\\tau}_1\\cdot\\boldsymbol{\\tau}_2 = 2\\,\\boldsymbol{T}^2 - 3$，其中 $\\boldsymbol{T}=(\\boldsymbol{\\tau}_1+\\boldsymbol{\\tau}_2)/2$ 是总同位旋算符。那么 $\\boldsymbol{\\tau}_1\\cdot\\boldsymbol{\\tau}_2$ 在 $T=0$ 时的本征值为 $-3$，在 $T=1$ 时的本征值为 $+1$。因此，\n$$\nV^{(T=0)} = V_0 - 3\\,V_1,\\qquad V^{(T=1)} = V_0 + V_1,\n$$\n且投影给出\n$$\nV_1 = \\frac{V^{(T=1)} - V^{(T=0)}}{4},\\qquad V_0 = \\frac{3\\,V^{(T=1)} + V^{(T=0)}}{4}.\n$$\n训练一个输出 $(V_0,V_1)$ 的单一 NNP，并定义一个复合损失函数，该函数通过同位旋分类将诱导的道势与数据进行比较：对于 $T=1$ 的 pp 和 nn 分波，使用 $\\widehat{V}_{pp/nn} = \\widehat{V}_0 + \\widehat{V}_1$ 再加上 pp 的已知库仑项；对于 $T=0$ 的 np 分波（例如 ${}^3S_1$–${}^3D_1$），使用 $\\widehat{V}_{np}^{(T=0)}=\\widehat{V}_0 - 3\\,\\widehat{V}_1$；对于 $T=1$ 的 np 分波（例如 ${}^1S_0$），使用 $\\widehat{V}_{np}^{(T=1)}=\\widehat{V}_0 + \\widehat{V}_1$。最小化所有道和运动学构型上的加权残差平方和，添加一个在移除库仑项后强制 pp–nn 一致性的小正则化项，并包含实验或模拟器不确定性作为权重。\n\nB. 取 $\\boldsymbol{\\tau}_1\\cdot\\boldsymbol{\\tau}_2$ 在双核子系统中的本征值为 $\\pm 1$，因此 $V^{(T=0)} = V_0 - V_1$ 且 $V^{(T=1)} = V_0 + V_1$，导致 $V_1 = \\left(V^{(T=1)} - V^{(T=0)}\\right)/2$ 且 $V_0 = \\left(V^{(T=1)} + V^{(T=0)}\\right)/2$。仅在 pp 和 nn 数据上训练以学习 $(V_0,V_1)$，因为在同位旋对称性下，np 不增加独立的同位旋信息。\n\nC. 通过直接平均进行投影：定义 $V_0 = \\left(V_{pp} + V_{nn} + V_{np}\\right)/3$ 和 $V_1 = \\left(V_{pp} - V_{nn}\\right)/2$，假设电荷无关性并忽略库仑作用。通过最小化这些网络输出的线性组合与相应数据平均值之间的平方差来进行训练，而不按分波同位旋来分离 np。\n\nD. 将 $\\boldsymbol{\\tau}_1\\cdot\\boldsymbol{\\tau}_2$ 替换为 $\\tau_{1z}\\tau_{2z}$ 并确定 $V^{(pp)} = V_0 + V_1$，$V^{(nn)} = V_0 + V_1$，以及 $V^{(np)} = V_0 - V_1$。然后设置 $V_1 = \\left(V^{(pp)} - V^{(np)}\\right)$ 和 $V_0 = V^{(np)} + V_1$。通过用其第三分量同位旋 $T_z$ 标记每对核子，并在所有数据上对这些公式进行回归来训练 NNP，而无需分波解析。\n\n选择正确的选项。",
            "solution": "用户希望得到一个问题的详细验证和解答，该问题涉及构建一个遵循同位旋对称性的核子-核子相互作用的神经网络势 (NNP)。\n\n### 问题验证\n\n#### 步骤1：提取已知条件\n-   **系统**：一个用于核子-核子 (NN) 相互作用的神经网络势 (NNP)。\n-   **对称性**：该 NNP 被设计为遵循近似同位旋对称性。\n-   **势的形式**：势表示为 $V = V_0(\\mathbf{x}) + V_1(\\mathbf{x})\\,\\boldsymbol{\\tau}_1\\cdot\\boldsymbol{\\tau}_2$。\n-   **定义**：$\\boldsymbol{\\tau}_i$ 是作用于核子 $i$ 的泡利同位旋算符。$\\mathbf{x}$ 代表非同位旋输入的集合（例如，运动学量）。\n-   **数据来源**：训练数据可从质子-质子 (pp)、中子-中子 (nn) 和中子-质子 (np) 道中获得。\n-   **数据结构**：数据是为总同位旋 $T$ 已知的特定分波提供的。\n-   **假设**：\n    1.  忽略电磁效应，但在 pp 道中有一个显式的、已知的附加库仑项。\n    2.  近似的电荷无关性成立，意味着在给定的同位旋道中，pp 和 nn 系统的强相互作用是相同的（在考虑库仑效应之后）。\n\n#### 步骤2：使用提取的已知条件进行验证\n-   **科学基础**：该问题牢固地植根于核物理原理。通过算符 $\\boldsymbol{\\tau}_1\\cdot\\boldsymbol{\\tau}_2$ 将 NN 相互作用参数化为同位旋标量 ($V_0$) 和同位旋矢量 ($V_1$) 分量，是一种尊重同位旋对称性的标准且有物理动机的表示方法。同位旋是强相互作用的一个基本（近似）对称性，其形式体系，包括总同位旋 $\\boldsymbol{T}$ 和泡利算符 $\\boldsymbol{\\tau}$，是核结构和散射理论的核心。通过总同位旋 $T$ 对 NN 态（pp、nn、np）进行分类也是标准做法。问题陈述在科学上是合理的。\n-   **适定性**：该问题是适定的。它要求基于所提供的势形式推导 $V_0$ 和 $V_1$ 的投影公式，并提出一个科学合理的训练策略。给出的信息足以推导这些公式并评估所提出的策略。可以确定一个唯一且有意义的解。\n-   **客观性**：语言精确、技术性强，没有任何主观性或歧义。像“同位旋对称性”、“泡利同位旋算符”和“分波”等术语在物理学中有严格的定义。\n\n问题陈述没有违反任何无效性标准。这是一个在计算核物理领域中有效且表述良好的问题。\n\n#### 步骤3：结论和行动\n问题是有效的。我将继续推导解决方案并评估各个选项。\n\n### 解决方案推导\n\n核子-核子相互作用的势给出如下：\n$$\nV = V_0(\\mathbf{x}) + V_1(\\mathbf{x})\\,\\boldsymbol{\\tau}_1\\cdot\\boldsymbol{\\tau}_2\n$$\n为了确定具有确定总同位旋 $T$ 的道中的势，我们必须找到算符 $\\boldsymbol{\\tau}_1\\cdot\\boldsymbol{\\tau}_2$ 的本征值。\n\n双核子系统的总同位旋算符为 $\\boldsymbol{T} = \\frac{1}{2}(\\boldsymbol{\\tau}_1 + \\boldsymbol{\\tau}_2)$。其平方是：\n$$\n\\boldsymbol{T}^2 = \\left(\\frac{1}{2}(\\boldsymbol{\\tau}_1 + \\boldsymbol{\\tau}_2)\\right) \\cdot \\left(\\frac{1}{2}(\\boldsymbol{\\tau}_1 + \\boldsymbol{\\tau}_2)\\right) = \\frac{1}{4}(\\boldsymbol{\\tau}_1^2 + \\boldsymbol{\\tau}_2^2 + 2\\,\\boldsymbol{\\tau}_1\\cdot\\boldsymbol{\\tau}_2)\n$$\n泡利同位旋算符 $\\boldsymbol{\\tau}_i$ 类似于泡利自旋矩阵。单个核子（一个同位旋-1/2粒子）的泡利矢量算符的平方是 $\\boldsymbol{\\tau}_i^2 = \\tau_{ix}^2 + \\tau_{iy}^2 + \\tau_{iz}^2 = 3I$，其中 $I$ 是单核子同位旋空间中的单位算符。其本征值为 3。\n因此，算符 $\\boldsymbol{T}^2$ 变为：\n$$\n\\boldsymbol{T}^2 = \\frac{1}{4}(3 + 3 + 2\\,\\boldsymbol{\\tau}_1\\cdot\\boldsymbol{\\tau}_2) = \\frac{1}{2}(3 + \\boldsymbol{\\tau}_1\\cdot\\boldsymbol{\\tau}_2)\n$$\n重新排列此方程以求解 $\\boldsymbol{\\tau}_1\\cdot\\boldsymbol{\\tau}_2$ 得：\n$$\n\\boldsymbol{\\tau}_1\\cdot\\boldsymbol{\\tau}_2 = 2\\,\\boldsymbol{T}^2 - 3\n$$\n算符 $\\boldsymbol{T}^2$ 的本征值为 $T(T+1)$，其中 $T$ 是总同位旋量子数。对于双核子系统，可能的值是 $T=0$（同位旋单态）和 $T=1$（同位旋三重态）。\n\n1.  **同位旋单态道 ($T=0$):**\n    $\\boldsymbol{T}^2$ 的本征值为 $0(0+1) = 0$。\n    $\\boldsymbol{\\tau}_1\\cdot\\boldsymbol{\\tau}_2$ 的本征值为 $2(0) - 3 = -3$。\n    此道中的势 $V^{(T=0)}$ 为：\n    $$\n    V^{(T=0)} = V_0 - 3\\,V_1\n    $$\n\n2.  **同位旋三重态道 ($T=1$):**\n    $\\boldsymbol{T}^2$ 的本征值为 $1(1+1) = 2$。\n    $\\boldsymbol{\\tau}_1\\cdot\\boldsymbol{\\tau}_2$ 的本征值为 $2(2) - 3 = +1$。\n    此道中的势 $V^{(T=1)}$ 为：\n    $$\n    V^{(T=1)} = V_0 + V_1\n    $$\n\n我们现在得到了一个关于 $V_0$ 和 $V_1$ 的二元线性方程组：\n$$\n\\begin{align*}\nV^{(T=1)} = V_0 + V_1 \\quad (1) \\\\\nV^{(T=0)} = V_0 - 3\\,V_1 \\quad (2)\n\\end{align*}\n$$\n为了求 $V_1$，我们将方程(1)减去方程(2)：\n$$\nV^{(T=1)} - V^{(T=0)} = (V_0 + V_1) - (V_0 - 3\\,V_1) = 4\\,V_1\n$$\n$$\n\\implies V_1 = \\frac{V^{(T=1)} - V^{(T=0)}}{4}\n$$\n为了求 $V_0$，我们可以将 $V_1$ 代回方程(1)：\n$$\nV_0 = V^{(T=1)} - V_1 = V^{(T=1)} - \\frac{V^{(T=1)} - V^{(T=0)}}{4} = \\frac{4\\,V^{(T=1)} - V^{(T=1)} + V^{(T=0)}}{4}\n$$\n$$\n\\implies V_0 = \\frac{3\\,V^{(T=1)} + V^{(T=0)}}{4}\n$$\n这些就是从具有确定同位旋的道中的势提取同位旋标量分量 $V_0$ 和同位旋矢量分量 $V_1$ 的投影公式。\n\n### 选项评估\n\n**选项 A：**\n该选项陈述了恒等式 $\\boldsymbol{\\tau}_1\\cdot\\boldsymbol{\\tau}_2 = 2\\,\\boldsymbol{T}^2 - 3$，这是正确的。它正确地计算出 $\\boldsymbol{\\tau}_1\\cdot\\boldsymbol{\\tau}_2$ 在 $T=0$ 道的本征值为 $-3$，在 $T=1$ 道的本征值为 $+1$。这导致了道势 $V^{(T=0)} = V_0 - 3\\,V_1$ 和 $V^{(T=1)} = V_0 + V_1$，与我们的推导相符。所得的投影公式 $V_1 = \\frac{V^{(T=1)} - V^{(T=0)}}{4}$ 和 $V_0 = \\frac{3\\,V^{(T=1)} + V^{(T=0)}}{4}$ 也是正确的。\n\n所提出的训练策略在科学上是合理的。它正确地指出：\n-   pp 和 nn 散射数据只探测 $T=1$ 道。\n-   np 散射数据必须被分离成 $T=0$ 和 $T=1$ 道，这可以通过分波分析实现（例如，${}^3S_1$ 是 $T=0$，${}^1S_0$ 是 $T=1$）。\n-   单个 NNP 应该输出基本分量 $(V_0, V_1)$。\n-   应构建一个复合损失函数，方法是根据每个数据点所在道的同位旋（$T=1$ 时为 $\\widehat{V}_0 + \\widehat{V}_1$，$T=0$ 时为 $\\widehat{V}_0 - 3\\,\\widehat{V}_1$）组合 NNP 的输出，并与相应的实验数据进行比较。\n-   它正确地提到为 pp 数据添加已知的库仑贡献。\n-   使用加权残差平方和（权重来自不确定性）和正则化的建议是机器学习中的标准和良好实践。\n\n选项 A 的全部陈述与核物理原理和稳健的机器学习方法论一致。\n**结论：正确。**\n\n**选项 B：**\n该选项错误地陈述了 $\\boldsymbol{\\tau}_1\\cdot\\boldsymbol{\\tau}_2$ 的本征值为 $\\pm 1$。如上所推导，本征值为 $-3$ 和 $+1$。这个基本错误导致了不正确的投影公式。此外，它声称 np 数据不增加独立的同位旋信息，训练可以仅在 pp 和 nn 数据上进行。这是一个严重的误解。由于 pp 和 nn 系统都纯粹是 $T=1$ 道，它们只能约束 $V_0 + V_1$ 这个组合。如果没有来自 $T=0$ 道的数据，就不可能分离出 $V_0$ 和 $V_1$，而 $T=0$ 道的数据完全由 np 散射提供。因此，所提出的训练策略存在根本性缺陷。\n**结论：错误。**\n\n**选项 C：**\n该选项提出了特设的平均公式，$V_0 = (V_{pp} + V_{nn} + V_{np})/3$ 和 $V_1 = (V_{pp} - V_{nn})/2$。这些公式并非从第一性原理推导得出。$V_1$ 的公式将意味着整个同位旋矢量势都源于 pp 和 nn 相互作用之间的电荷对称性破缺差异，这是不正确的；$V_1$ 是核力的主要组成部分，而 CSB 是一个很小的效应。$V_0$ 的公式没有意义，因为它在平均 $V_{np}$ 时没有区分其 $T=0$ 和 $T=1$ 的分量。建议“不按分波同位旋来分离 np”进行训练是一个关键缺陷，因为这种分离对于约束势是至关重要的。\n**结论：错误。**\n\n**选项 D：**\n该选项建议将同位旋标量算符 $\\boldsymbol{\\tau}_1\\cdot\\boldsymbol{\\tau}_2$ 替换为 $\\tau_{1z}\\tau_{2z}$。这是一个根本性错误。算符 $\\boldsymbol{\\tau}_1\\cdot\\boldsymbol{\\tau}_2$ 在同位旋空间中是一个旋转标量，使用它可以确保势尊重同位旋对称性（即相互作用与同位旋空间中的取向无关）。然而，算符 $\\tau_{1z}\\tau_{2z}$ 不是一个标量；它是一个2阶张量的分量。使用它会明确地破坏同位旋对称性，与问题的前提相矛盾。后续的公式和训练策略都基于这个有缺陷的前提，即相互作用依赖于同位旋投影 $T_z$ 而非总同位旋 $T$，这对于标量相互作用来说在物理上是不正确的。\n**结论：错误。**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "当使用有限的实验数据拟合势时，模型可能会在数据稀疏的区域（例如极短距离处）产生不符合物理实际的特征。通过在损失函数中引入正则化项，可以有效惩罚这些非物理行为。本练习探讨了如何运用振幅和平滑度正则化方法，来防止模型产生虚假的深度束缚态，从而确保所得到的势在数据未约束的区域内也同样物理合理 。",
            "id": "3571887",
            "problem": "考虑一个由神经网络 $V(r;\\theta)$ 建模的球对称局域势中的双核子相对运动，其中 $r$ 是粒子间距，$\\theta$ 是可训练参数。其动力学由轨道角动量 $l=0$ 的径向定态薛定谔方程决定，\n$$\n-\\frac{\\hbar^{2}}{2\\mu}\\,\\frac{d^{2}u}{dr^{2}} + V(r;\\theta)\\,u(r) = E\\,u(r),\n$$\n其中 $\\mu$ 是约化质量，$E$ 是能量，$u(r)$ 是满足 $\\int_{0}^{\\infty} dr\\,|u(r)|^{2}=1$ 的归一化径向波函数。训练目标函数结合了数据失配项 $\\mathcal{L}_{\\text{data}}(\\theta)$ 和两个正则化项：\n- 一个短程振幅惩罚项，它通过一个势垒函数将违规行为引向巨大的损失，从而在 $r\\to 0$ 时强制执行 $|V(r;\\theta)| < M$。\n- 一个平滑度惩罚项，它限制势的不必要振荡，并通过一个约束 $\\int_0^\\infty dr\\,|V''(r;\\theta)|^2 < C$ 来实施，其中 $V''$ 是对 $r$ 的二阶导数。\n\n这两个正则化项都有助于确保势的物理合理性。然而，它们通过不同的机制来防止形成伪深度束缚态——即能量远低于任何已知物理束缚态（例如，氘核的结合能 $\\approx -2.2\\,\\mathrm{MeV}$）的非物理束缚态。\n\n哪一项或多项正则化项，主要通过其各自的机制，有助于防止形成伪深度束缚态？选择一个或多个正确描述其主要贡献的选项。\n\nA. 振幅惩罚（由 $\\mathcal{L}_{\\text{amp}}$ 实现）通过直接限制势阱的最大深度来防止伪深度束缚态。由于束缚态能量与势阱深度直接相关，这是一种直接的约束。\n\nB. 平滑度惩罚（由 $\\mathcal{L}_{\\text{smooth}}$ 实现）通过惩罚势中的高曲率来防止伪深度束缚态。形成一个深度束缚态需要一个既深又宽的势阱，这可能需要大的曲率，因此这种惩罚会间接抑制它们。\n\nC. A和B都对防止伪束缚态的贡献同等重要。平滑度确保势阱不会太窄，而振幅限制其深度，两者共同决定了是否存在束缚态。\n\nD. 主要是振幅惩罚，因为它直接限制了哈密顿量中势能项的负贡献。平滑度惩罚主要是为了确保一个物理上更合理的形状（例如，避免快速振荡），并防止过拟合到数据噪声，而不是作为防止深度束缚态的主要机制。",
            "solution": "用户提供了一个关于正则化项在训练双核子神经网络势中的作用的问题陈述。我现在将执行所需的验证和求解过程。\n\n### 问题验证\n\n**步骤1：提取已知信息**\n-   **系统**：双核子相对运动。\n-   **势**：球对称、局域的神经网络势 $V(r;\\theta)$，其中 $r$ 是粒子间距，$\\theta$ 是可训练参数。\n-   **动力学**：轨道角动量 $l=0$ 的径向定态薛定谔方程：\n    $$-\\frac{\\hbar^{2}}{2\\mu}\\,\\frac{d^{2}u}{dr^{2}} + V(r;\\theta)\\,u(r) = E\\,u(r)$$\n-   **定义**：$\\mu$ 是约化质量，$E$ 是能量，$u(r)$ 是满足 $\\int_{0}^{\\infty} dr\\,|u(r)|^{2}=1$ 的归一化径向波函数。\n-   **训练目标**：数据失配项 $\\mathcal{L}_{\\text{data}}(\\theta)$ 和两个正则化项的组合。\n-   **正则化项1（振幅惩罚）**：在 $r\\to 0$ 时使用势垒函数强制执行 $|V(r;\\theta)| < M$。\n-   **正则化项2（平滑度惩罚）**：通过约束 $\\int_0^\\infty dr\\,|V''(r;\\theta)|^2 < C$ 来限制不必要的振荡。\n-   **目标**：防止“伪深度束缚态”（能量非常负的非物理束缚态）。\n-   **问题**：哪一项或多项正则化项主要有助于防止伪深度束缚态？\n\n**步骤2：使用提取的已知条件进行验证**\n-   **科学基础**：该问题正确地表述了量子力学中的一个标准问题（径向薛定谔方程）。使用正则化项（如振幅和平滑度惩罚）来约束神经网络势的行为，以确保物理合理性，这是机器学习在物理科学中应用的一个非常常见且重要的方面。伪束缚态是拟合核势时的一个众所周知的实际问题。该问题的设置在科学上是正确的。\n-   **适定性**：问题清晰地定义了两个正则化器及其数学形式，并要求评估它们各自在防止特定非物理行为（伪深度束缚态）中的作用。这是一个关于物理推理的问题，可以基于对薛定谔方程解的性质的理解来回答。\n-   **客观性**：问题是客观的。选项提供了关于这两个惩罚项作用机制的特定物理解释，这些解释可以根据物理原理进行评估。\n\n该问题是有效的。\n\n### 解决方案推导\n\n我们需要分析每个正则化项如何影响薛定谔方程的束缚态解（$E  0$）。束缚态的存在及其能量取决于动能项（由波函数的曲率决定）和势能项之间的平衡。对于深度束缚态（$E$ 是一个大的负数），势能 $V(r)$ 必须在一个足够大的区域内提供显著的负贡献，以克服波函数局域化所带来的正动能贡献。\n\n1.  **振幅惩罚的作用**：这个惩罚直接设置了势能可以达到的最小值的下限（$-M$）。根据瑞利-里兹变分原理，基态能量 $E_0$ 的下界为：\n    $$E_0 = \\min_{\\psi} \\frac{\\langle\\psi|H|\\psi\\rangle}{\\langle\\psi|\\psi\\rangle} = \\min_{\\psi} \\int \\left( \\frac{\\hbar^2}{2\\mu} |\\nabla\\psi|^2 + V(r) |\\psi|^2 \\right) d^3r$$\n    由于 $V(r) > -M$ 对所有 $r$ 成立，我们有：\n    $$E_0 > \\min_{\\psi} \\int \\left( \\frac{\\hbar^2}{2\\mu} |\\nabla\\psi|^2 - M |\\psi|^2 \\right) d^3r > -M$$\n    因此，振幅惩罚直接为任何可能的束缚态能量设置了一个硬下限。它直接阻止了势变得任意深，从而直接阻止了任意深的束缚态的形成。\n\n2.  **平滑度惩罚的作用**：这个惩罚 $\\int |V''|^2 dr  C$ 会抑制势函数中的大曲率。一个非常尖锐、快速变化的势阱会有很大的二阶导数，因此会被这个项惩罚。这确实会使势的形状更“平滑”和更“物理”。虽然一个非常尖锐的势阱（像狄拉克$\\delta$函数势）可以产生束缚态，但为了获得一个*深度*束缚态，势阱不仅需要深，还需要有一定的宽度来容纳波函数，从而不至于产生过大的动能。平滑度惩罚通过阻止势函数形成非常狭窄和尖锐的特征，确实有助于使势的形状更合理。它可以防止某些类型的非物理势，但它对势阱深度的控制是间接的。一个非常平滑（小$V''$）但又深又宽的势阱仍然可以产生一个深度束缚态。因此，平滑度惩罚的主要作用是塑造势的形状，而不是直接限制其深度。\n\n### 选项评估\n\n-   **A. 振幅惩罚...通过直接限制势阱的最大深度来防止...** 这个说法是正确的。正如我们的分析所示，这是防止能量变得任意负的最直接的机制。\n\n-   **B. 平滑度惩罚...通过惩罚势中的高曲率来防止...间接抑制它们。** 这个说法在原则上也是正确的——它描述了一种机制，并且正确地将其定性为“间接的”。然而，与振幅惩罚相比，它不是*主要*机制。\n\n-   **C. A和B都对防止伪束缚态的贡献同等重要。** 这个说法是不正确的。振幅惩罚提供了一个硬性的、直接的约束，而平滑度惩罚的作用是间接的，更多地是关于形状的。因此，它们的重要性是不对等的。\n\n-   **D. 主要是振幅惩罚...平滑度惩罚主要是为了确保一个物理上更合理的形状...而不是作为防止深度束缚态的主要机制。** 这个说法提供了对两者作用的准确、细致的比较。它正确地确定了振幅惩罚是主要机制，并正确地描述了平滑度惩罚的主要作用（确保形状合理，防止过拟合）。这与我们的物理推断完全一致。\n\n**结论**：\n问题要求选择一个或多个正确描述其主要贡献的选项。\n-   选项A是关于振幅惩罚贡献的正确描述。\n-   选项D是对两种惩罚项的相对贡献和主要角色的正确描述。\n因此，A和D都是正确的答案。\n\n-   选项B虽然描述了一个真实的效应，但选项D对其作用的描述更为精确和完整（将其描述为次要角色）。在多选题中，如果一个选项比另一个选项更完整、更精确，通常应选择更优的那个。选项D包含了对平滑度惩罚的更细致的理解。\n-   选项C在物理上是不正确的。\n\n因此，最合适的答案是A和D。A正确描述了振幅惩罚的作用，D正确描述了两者的相对重要性。两者都是对“主要贡献”问题的有效回答。\n\n### 最终决定\n\n选择 **A** 和 **D**。\n- **A** 是一个正确的独立陈述，描述了振幅惩罚的直接和主要作用。\n- **D** 是一个正确的比较陈述，它也确定了振幅惩罚是主要因素，同时正确地描述了平滑度惩罚的（不同的）主要作用。\n\n这两个选项都正确地回答了问题的不同方面，并且彼此不矛盾。",
            "answer": "$$\\boxed{AD}$$"
        }
    ]
}