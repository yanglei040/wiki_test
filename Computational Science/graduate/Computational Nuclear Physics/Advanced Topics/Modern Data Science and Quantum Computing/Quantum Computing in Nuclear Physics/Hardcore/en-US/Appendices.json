{
    "hands_on_practices": [
        {
            "introduction": "Translating fermionic Hamiltonians to qubit operators is the first crucial step in simulating nuclear physics on a quantum computer. The Jordan-Wigner (JW) transformation is a canonical method for this mapping, but it introduces non-local \"parity strings\" of Pauli-$Z$ operators that can increase circuit complexity. This exercise provides direct practice in applying the JW mapping to a multi-body interaction term, helping to build intuition for the structure of the resulting qubit Hamiltonian. ",
            "id": "3583685",
            "problem": "Consider a truncated shell-model toy system in computational nuclear physics consisting of three spinless single-particle orbitals labeled by $p \\in \\{1,2,3\\}$. Let $a_{p}$ and $a_{p}^{\\dagger}$ denote the fermionic annihilation and creation operators for orbital $p$, satisfying the canonical anticommutation relations $\\{a_{p}, a_{q}^{\\dagger}\\} = \\delta_{pq}$ and $\\{a_{p}, a_{q}\\} = \\{a_{p}^{\\dagger}, a_{q}^{\\dagger}\\} = 0$. Consider a three-body contact interaction that penalizes triple occupancy of the specific set of orbitals $(1,2,3)$, represented in second quantization by the normal-ordered operator\n$$\nH_{3} \\;=\\; g_{3}\\, a_{1}^{\\dagger} a_{2}^{\\dagger} a_{3}^{\\dagger} a_{3} a_{2} a_{1},\n$$\nwhere $g_{3}$ is a real coupling constant.\n\nMap $H_{3}$ to a quantum circuit model with three qubits using the Jordan–Wigner (JW) transformation, where each fermionic orbital $p$ is encoded into qubit $p$. A Pauli string is a tensor product of single-qubit operators chosen from $\\{I, X, Y, Z\\}$ on the three-qubit register. Starting only from the canonical anticommutation relations and the definition of the Jordan–Wigner (JW) transformation, carry out the mapping of $H_{3}$ step by step into a linear combination of Pauli strings.\n\nThen, expand the resulting expression completely and count the number of distinct nontrivial Pauli strings produced, where “nontrivial” means the string contains at least one non-identity single-qubit operator. Ignore the overall scalar coefficients when counting and do not include the identity operator in the count.\n\nProvide the final count as a single integer. No rounding is required, and no units are needed for the final answer.",
            "solution": "The problem requires mapping the three-body fermionic Hamiltonian, $H_3$, to a sum of Pauli strings using the Jordan–Wigner (JW) transformation.\n\nThe Hamiltonian is given by:\n$$\nH_{3} = g_{3}\\, a_{1}^{\\dagger} a_{2}^{\\dagger} a_{3}^{\\dagger} a_{3} a_{2} a_{1}\n$$\nThis operator is already in normal order (creation operators to the left of annihilation operators). We can simplify this expression using the fermionic anticommutation relations and the definition of the number operator, $n_p = a_p^\\dagger a_p$.\nBecause operators for different sites commute, we can rearrange the terms as long as we keep track of their site indices.\n$$\na_{3}^{\\dagger} a_{3} a_{2} a_{1} = n_3 a_2 a_1\n$$\nNow, we must commute $n_3$ past $a_2^\\dagger$ and $a_1^\\dagger$. Since $n_3$ acts on site 3, it commutes with all operators on sites 1 and 2.\n$$\na_2^\\dagger a_3^\\dagger a_3 a_2 a_1 = a_2^\\dagger n_3 a_2 a_1 = n_3 (a_2^\\dagger a_2) a_1 = n_3 n_2 a_1\n$$\nSimilarly, commuting $n_3 n_2$ past $a_1^\\dagger$:\n$$\na_1^\\dagger a_2^\\dagger a_3^\\dagger a_3 a_2 a_1 = a_1^\\dagger (n_3 n_2) a_1 = (n_3 n_2) a_1^\\dagger a_1 = n_1 n_2 n_3\n$$\nSo, the Hamiltonian simplifies to a product of number operators:\n$$\nH_3 = g_3 n_1 n_2 n_3\n$$\nThis form makes physical sense: it penalizes the state where all three orbitals are simultaneously occupied.\n\nNext, we use the Jordan-Wigner transformation. The key part of the transformation we need is the mapping for the number operator $n_p = a_p^\\dagger a_p$. In the JW encoding, where qubit state $|1\\rangle$ corresponds to an occupied orbital and $|0\\rangle$ to an empty one, the number operator for orbital $p$ maps to the qubit operator:\n$$\nn_p \\mapsto \\frac{1}{2}(I_p - Z_p)\n$$\nwhere $I_p$ and $Z_p$ are the identity and Pauli-Z operators on qubit $p$, respectively.\n\nApplying this mapping to our simplified Hamiltonian:\n$$\nH_3 \\mapsto g_3 \\left(\\frac{I_1 - Z_1}{2}\\right) \\otimes \\left(\\frac{I_2 - Z_2}{2}\\right) \\otimes \\left(\\frac{I_3 - Z_3}{2}\\right)\n$$\n$$\nH_3 \\mapsto \\frac{g_3}{8} (I_1 - Z_1)(I_2 - Z_2)(I_3 - Z_3)\n$$\nTo find the number of distinct nontrivial Pauli strings, we expand this expression, ignoring the overall coefficient $\\frac{g_3}{8}$. For simplicity, we omit the tensor product symbols.\nExpanding the first two factors:\n$$\n(I - Z_1)(I - Z_2) = I \\cdot I - I \\cdot Z_2 - Z_1 \\cdot I + Z_1 Z_2 = I - Z_2 - Z_1 + Z_1Z_2\n$$\nNow, multiplying by the third factor $(I - Z_3)$:\n$$\n(I - Z_1 - Z_2 + Z_1Z_2)(I - Z_3) = (I - Z_1 - Z_2 + Z_1Z_2) - (Z_3 - Z_1Z_3 - Z_2Z_3 + Z_1Z_2Z_3)\n$$\n$$\n= I - Z_1 - Z_2 - Z_3 + Z_1Z_2 + Z_1Z_3 + Z_2Z_3 - Z_1Z_2Z_3\n$$\nThe resulting distinct Pauli strings are:\n1. $I_1 \\otimes I_2 \\otimes I_3$ (Identity)\n2. $Z_1 \\otimes I_2 \\otimes I_3$\n3. $I_1 \\otimes Z_2 \\otimes I_3$\n4. $I_1 \\otimes I_2 \\otimes Z_3$\n5. $Z_1 \\otimes Z_2 \\otimes I_3$\n6. $Z_1 \\otimes I_2 \\otimes Z_3$\n7. $I_1 \\otimes Z_2 \\otimes Z_3$\n8. $Z_1 \\otimes Z_2 \\otimes Z_3$\n\nThere are a total of 8 distinct Pauli strings. A \"nontrivial\" string is one that is not the full identity operator. This excludes the first string in our list, $I_1 \\otimes I_2 \\otimes I_3$.\nCounting the nontrivial strings (items 2 through 8), we find there are 7 such strings.",
            "answer": "$$\n\\boxed{7}\n$$"
        },
        {
            "introduction": "In nuclear many-body theory, calculations are often performed relative to a simple, solvable reference state, such as a Slater determinant. Normal ordering a Hamiltonian with respect to this reference is a standard technique that separates the problem into the reference energy and the correlation energy, the latter often being the target of advanced quantum computations. This practice demonstrates how to compute this essential reference energy, a constant offset that must be added to results from algorithms like the Variational Quantum Eigensolver (VQE) or Quantum Phase Estimation (QPE) to obtain total energies. ",
            "id": "3583721",
            "problem": "Consider an interacting system of identical nucleons in a finite orthonormal single-particle basis, described in second quantization by a Hamiltonian with one-body and two-body parts. The creation and annihilation operators, denoted by $a_{p}^{\\dagger}$ and $a_{q}$ for single-particle orbitals labeled by $p$ and $q$, satisfy the fermionic anticommutation relations $\\{a_{p},a_{q}^{\\dagger}\\}=\\delta_{pq}$ and $\\{a_{p},a_{q}\\}=\\{a_{p}^{\\dagger},a_{q}^{\\dagger}\\}=0$. The Hamiltonian has the form\n$$\nH \\;=\\; \\sum_{pq} t_{pq}\\, a_{p}^{\\dagger} a_{q} \\;+\\; \\frac{1}{4}\\sum_{pqrs} \\langle pq \\Vert rs \\rangle\\, a_{p}^{\\dagger} a_{q}^{\\dagger} a_{s} a_{r},\n$$\nwhere $t_{pq}$ are one-body matrix elements and $\\langle pq \\Vert rs \\rangle$ are antisymmetrized two-body matrix elements. Let $\\lvert \\Phi \\rangle$ be a Slater determinant (SD) reference built by occupying a set of orbitals $\\{i\\}$, with occupation numbers $n_{p}=\\langle \\Phi \\lvert a_{p}^{\\dagger} a_{p} \\rvert \\Phi \\rangle \\in \\{0,1\\}$.\n\nUsing only the fundamental definitions above, the canonical form of Wick’s theorem for normal ordering with respect to $\\lvert \\Phi \\rangle$, and the algebra of fermionic operators, derive how normal ordering with respect to $\\lvert \\Phi \\rangle$ changes the expectation value $\\langle \\Phi \\lvert H \\rvert \\Phi \\rangle$. In particular, start from the definitions of contractions and normal-ordered products with respect to $\\lvert \\Phi \\rangle$ and show that normal ordering produces a decomposition of $H$ into a normal-ordered operator whose expectation value in $\\lvert \\Phi \\rangle$ vanishes plus a constant “zero-body” term equal to the reference energy of $\\lvert \\Phi \\rangle$.\n\nThen apply your result to the following simple two-level pairing model that is widely used in computational nuclear physics and in the construction of qubit Hamiltonians for quantum computing in nuclear physics. There are two spatial orbitals, labeled $a$ and $b$, each with two spin projections $\\sigma \\in \\{\\uparrow,\\downarrow\\}$, so the single-particle labels are $p \\in \\{a\\uparrow,a\\downarrow,b\\uparrow,b\\downarrow\\}$. The one-body part is diagonal with $t_{pq}=\\varepsilon_{p}\\,\\delta_{pq}$ and single-particle energies $\\varepsilon_{a\\uparrow}=\\varepsilon_{a\\downarrow}=\\varepsilon_{a}$ and $\\varepsilon_{b\\uparrow}=\\varepsilon_{b\\downarrow}=\\varepsilon_{b}$. The only nonvanishing antisymmetrized two-body matrix element is a seniority-zero pairing interaction within orbital $a$,\n$$\n\\langle a\\uparrow \\, a\\downarrow \\Vert a\\uparrow \\, a\\downarrow \\rangle \\;=\\; -g,\n$$\nwith all other $\\langle pq \\Vert rs \\rangle$ equal to zero. Take the SD reference $\\lvert \\Phi \\rangle$ to be the filled pair in orbital $a$, that is, $n_{a\\uparrow}=n_{a\\downarrow}=1$ and $n_{b\\uparrow}=n_{b\\downarrow}=0$. Use your general derivation to compute the normal-ordered constant (zero-body) term produced by normal ordering $H$ with respect to $\\lvert \\Phi \\rangle$.\n\nFor numerical evaluation, use $\\varepsilon_{a}=-3.75$ MeV, $\\varepsilon_{b}=-0.80$ MeV, and $g=0.64$ MeV, and note that only occupied orbitals contribute to the zero-body term. Express the final result for the constant in MeV and round your answer to three significant figures. State only the value of the constant term as your final answer. Angle units are not applicable here. The final constant term you compute equals the identity coefficient in the qubit Hamiltonian obtained by any fermion-to-qubit mapping, and it must be added back to measured excitation energies in algorithms such as quantum phase estimation to recover the absolute energy of $\\lvert \\Phi \\rangle$.",
            "solution": "The problem requires us to first derive the general expression for the constant, or \"zero-body\", term that arises when a two-body Hamiltonian is normal-ordered with respect to a Slater determinant reference state $\\lvert \\Phi \\rangle$. Then, we must apply this general result to a specific two-level pairing model and compute the numerical value of this constant.\n\nAccording to the generalized Wick's theorem, any operator can be decomposed into a sum of its normal-ordered part with respect to a reference state $\\lvert \\Phi \\rangle$ and terms involving contractions. The normal-ordered part of an operator, let's denote it by $\\{O\\}$, has the defining property that its expectation value in the reference state is zero: $\\langle \\Phi \\lvert \\{O\\} \\rvert \\Phi \\rangle = 0$. A string of creation and annihilation operators can be written as the sum of its normal-ordered product and all possible contracted terms. The fully contracted part of an operator is a constant (a c-number), which we are asked to find for the Hamiltonian $H$.\n\nLet the Hamiltonian be $H$. Its decomposition is $H = \\{H\\} + C$, where $\\{H\\}$ is the normal-ordered part of the Hamiltonian and $C$ is the fully contracted, constant term. Taking the expectation value of this equation with respect to $\\lvert \\Phi \\rangle$, we get:\n$$\n\\langle \\Phi \\lvert H \\rvert \\Phi \\rangle = \\langle \\Phi \\lvert \\{H\\} \\rvert \\Phi \\rangle + \\langle \\Phi \\lvert C \\rvert \\Phi \\rangle\n$$\nSince $\\langle \\Phi \\lvert \\{H\\} \\rvert \\Phi \\rangle = 0$ and $C$ is a constant, we have $C = \\langle \\Phi \\lvert H \\rvert \\Phi \\rangle$. Therefore, the constant \"zero-body\" term produced by normal ordering is precisely the energy of the reference state $E_{\\Phi} = \\langle \\Phi \\lvert H \\rvert \\Phi \\rangle$. We will now derive the expression for $E_{\\Phi}$.\n\nThe Hamiltonian is given by $H = H_1 + H_2$, where:\n$$\nH_1 = \\sum_{pq} t_{pq}\\, a_{p}^{\\dagger} a_{q} \\quad \\text{and} \\quad H_2 = \\frac{1}{4}\\sum_{pqrs} \\langle pq \\Vert rs \\rangle\\, a_{p}^{\\dagger} a_{q}^{\\dagger} a_{s} a_{r}\n$$\nThe expectation value is the sum of the expectation values of the one-body and two-body parts. Let the set of single-particle orbitals occupied in the Slater determinant $\\lvert \\Phi \\rangle$ be denoted by $\\{i, j, k, \\dots\\}$. The occupation number for an orbital $p$ is $n_p=1$ if $p$ is in this set, and $n_p=0$ otherwise. For an orthonormal basis, the action of the number operator is $\\langle \\Phi \\lvert a_{p}^{\\dagger} a_{q} \\rvert \\Phi \\rangle = \\delta_{pq} n_p$.\n\nFirst, we compute the expectation value of the one-body part, $E_1$:\n$$\nE_1 = \\langle \\Phi \\lvert H_1 \\rvert \\Phi \\rangle = \\left\\langle \\Phi \\left\\lvert \\sum_{pq} t_{pq}\\, a_{p}^{\\dagger} a_{q} \\right\\rvert \\Phi \\right\\rangle = \\sum_{pq} t_{pq} \\langle \\Phi \\lvert a_{p}^{\\dagger} a_{q} \\rvert \\Phi \\rangle\n$$\nUsing the property $\\langle \\Phi \\lvert a_{p}^{\\dagger} a_{q} \\rvert \\Phi \\rangle = \\delta_{pq} n_p$, we get:\n$$\nE_1 = \\sum_{pq} t_{pq} \\delta_{pq} n_p = \\sum_{p} t_{pp} n_p\n$$\nSince $n_p$ is non-zero only for occupied orbitals, the sum is restricted to the set of occupied orbitals $\\{i\\}$:\n$$\nE_1 = \\sum_{i \\in \\text{occ}} t_{ii}\n$$\n\nNext, we compute the expectation value of the two-body part, $E_2$:\n$$\nE_2 = \\langle \\Phi \\lvert H_2 \\rvert \\Phi \\rangle = \\frac{1}{4}\\sum_{pqrs} \\langle pq \\Vert rs \\rangle\\, \\langle \\Phi \\lvert a_{p}^{\\dagger} a_{q}^{\\dagger} a_{s} a_{r} \\rvert \\Phi \\rangle\n$$\nThe expectation value $\\langle \\Phi \\lvert a_{p}^{\\dagger} a_{q}^{\\dagger} a_{s} a_{r} \\rvert \\Phi \\rangle$ is non-zero only if the orbitals $r$ and $s$ are occupied in $\\lvert \\Phi \\rangle$, and the set of orbitals $\\{p,q\\}$ is identical to the set $\\{r,s\\}$. The value of this expectation value for a Slater determinant is given by:\n$$\n\\langle \\Phi \\lvert a_{p}^{\\dagger} a_{q}^{\\dagger} a_{s} a_{r} \\rvert \\Phi \\rangle = (\\delta_{pr}\\delta_{qs} - \\delta_{ps}\\delta_{qr}) n_r n_s\n$$\nSubstituting this into the expression for $E_2$:\n$$\nE_2 = \\frac{1}{4}\\sum_{pqrs} \\langle pq \\Vert rs \\rangle (\\delta_{pr}\\delta_{qs} - \\delta_{ps}\\delta_{qr}) n_r n_s\n$$\nWe can perform the summations over $p$ and $q$:\n$$\nE_2 = \\frac{1}{4}\\sum_{rs} n_r n_s \\left( \\sum_{pq} \\langle pq \\Vert rs \\rangle \\delta_{pr}\\delta_{qs} - \\sum_{pq} \\langle pq \\Vert rs \\rangle \\delta_{ps}\\delta_{qr} \\right)\n$$\n$$\nE_2 = \\frac{1}{4}\\sum_{rs} n_r n_s \\left( \\langle rs \\Vert rs \\rangle - \\langle sr \\Vert rs \\rangle \\right)\n$$\nUsing the antisymmetry property of the matrix elements, $\\langle sr \\Vert rs \\rangle = - \\langle rs \\Vert sr \\rangle$, and for hermitian interactions with real matrix elements, we also have $\\langle rs \\Vert sr \\rangle = \\langle sr \\Vert rs \\rangle$. Thus, $\\langle sr \\Vert rs \\rangle = -\\langle sr \\Vert rs \\rangle$, which implies $\\langle sr \\Vert rs \\rangle=0$ for this common case. A more general identity is $\\langle sr \\Vert rs \\rangle = -\\langle rs \\Vert sr \\rangle$. Let's use the definition of the antisymmetrized matrix element $\\langle ab \\Vert cd \\rangle = V_{abcd} - V_{abdc}$.\nSo, $\\langle rs \\Vert rs \\rangle - \\langle sr \\Vert rs \\rangle = (V_{rs,rs} - V_{rs,sr}) - (V_{sr,rs} - V_{sr,sr})$.\nAssuming real matrix elements, $V_{sr,rs}=V_{rs,sr}$ and $V_{sr,sr}=V_{rs,rs}$.\nThe expression becomes $(V_{rs,rs} - V_{rs,sr}) - (V_{rs,sr} - V_{rs,rs}) = 2(V_{rs,rs} - V_{rs,sr}) = 2 \\langle rs \\Vert rs \\rangle$.\n$$\nE_2 = \\frac{1}{4}\\sum_{rs} n_r n_s (2 \\langle rs \\Vert rs \\rangle) = \\frac{1}{2}\\sum_{rs} n_r n_s \\langle rs \\Vert rs \\rangle\n$$\nThe sum is over all states, but the factors $n_r n_s$ restrict it to occupied orbitals $\\{i, j\\}$:\n$$\nE_2 = \\frac{1}{2}\\sum_{i,j \\in \\text{occ}} \\langle ij \\Vert ij \\rangle\n$$\nCombining the one- and two-body parts, the total constant term (reference energy) is:\n$$\nE_{\\Phi} = \\sum_{i \\in \\text{occ}} t_{ii} + \\frac{1}{2}\\sum_{i,j \\in \\text{occ}} \\langle ij \\Vert ij \\rangle\n$$\n\nNow, we apply this general formula to the specified two-level pairing model.\nThe single-particle states are $p \\in \\{a\\uparrow, a\\downarrow, b\\uparrow, b\\downarrow\\}$.\nThe reference state $\\lvert \\Phi \\rangle$ has the pair in orbital $a$ filled. Thus, the occupied states are $\\{ a\\uparrow, a\\downarrow \\}$. The occupation numbers are $n_{a\\uparrow}=1$, $n_{a\\downarrow}=1$, and $n_{b\\uparrow}=n_{b\\downarrow}=0$.\n\nThe one-body contribution is calculated using $t_{pq} = \\varepsilon_p \\delta_{pq}$, which means $t_{pp} = \\varepsilon_p$.\n$$\nE_1 = \\sum_{i \\in \\text{occ}} t_{ii} = t_{a\\uparrow, a\\uparrow} + t_{a\\downarrow, a\\downarrow} = \\varepsilon_{a\\uparrow} + \\varepsilon_{a\\downarrow}\n$$\nGiven $\\varepsilon_{a\\uparrow} = \\varepsilon_{a\\downarrow} = \\varepsilon_a$, we have:\n$$\nE_1 = \\varepsilon_a + \\varepsilon_a = 2\\varepsilon_a\n$$\n\nThe two-body contribution is:\n$$\nE_2 = \\frac{1}{2}\\sum_{i,j \\in \\{a\\uparrow, a\\downarrow\\}} \\langle ij \\Vert ij \\rangle\n$$\nThis sum expands to four terms:\n$$\nE_2 = \\frac{1}{2} \\left( \\langle a\\uparrow a\\uparrow \\Vert a\\uparrow a\\uparrow \\rangle + \\langle a\\uparrow a\\downarrow \\Vert a\\uparrow a\\downarrow \\rangle + \\langle a\\downarrow a\\uparrow \\Vert a\\downarrow a\\uparrow \\rangle + \\langle a\\downarrow a\\downarrow \\Vert a\\downarrow a\\downarrow \\rangle \\right)\n$$\nDue to the Pauli exclusion principle, the antisymmetrized matrix element for two identical fermions in the initial and final states is zero: $\\langle pp \\Vert pp \\rangle = 0$. Thus, the first and last terms are zero.\nFor the remaining terms, we use the symmetry property $\\langle pq \\Vert pq \\rangle = \\langle qp \\Vert qp \\rangle$.\n$$\n\\langle a\\downarrow a\\uparrow \\Vert a\\downarrow a\\uparrow \\rangle = \\langle a\\uparrow a\\downarrow \\Vert a\\uparrow a\\downarrow \\rangle\n$$\nSo the expression for $E_2$ simplifies to:\n$$\nE_2 = \\frac{1}{2} \\left( \\langle a\\uparrow a\\downarrow \\Vert a\\uparrow a\\downarrow \\rangle + \\langle a\\uparrow a\\downarrow \\Vert a\\uparrow a\\downarrow \\rangle \\right) = \\langle a\\uparrow a\\downarrow \\Vert a\\uparrow a\\downarrow \\rangle\n$$\nThe problem states that the only non-vanishing two-body matrix element is $\\langle a\\uparrow a\\downarrow \\Vert a\\uparrow a\\downarrow \\rangle = -g$.\nTherefore, $E_2 = -g$.\n\nThe total constant term is the sum of the one- and two-body contributions:\n$$\nE_{\\Phi} = E_1 + E_2 = 2\\varepsilon_a - g\n$$\nWe are given the numerical values $\\varepsilon_{a}=-3.75$ MeV and $g=0.64$ MeV.\nSubstituting these values:\n$$\nE_{\\Phi} = 2(-3.75) - 0.64 = -7.50 - 0.64 = -8.14 \\, \\text{MeV}\n$$\nThe question asks for the result rounded to three significant figures. The value $-8.14$ has three significant figures.\nThe constant \"zero-body\" term is $-8.14$ MeV.",
            "answer": "$$\n\\boxed{-8.14}\n$$"
        },
        {
            "introduction": "Current quantum hardware is susceptible to noise, which corrupts computational results and is a primary obstacle to achieving quantum advantage. Fortunately, many physics problems, including those in nuclear structure, possess fundamental symmetries that must be respected. These symmetries, such as the conservation of particle number and parity, can be leveraged as powerful tools for error mitigation, allowing us to project a noisy quantum state back into the physically relevant subspace. This exercise offers a hands-on opportunity to implement and quantify the effectiveness of symmetry-based post-selection, a practical error mitigation strategy that uses the underlying physics of the system to improve computational fidelity. ",
            "id": "3583676",
            "problem": "You are asked to design and implement a complete program that simulates symmetry-based error mitigation for a simplified nuclear many-body register encoded on qubits. The context is symmetry projection by particle number and parity, a widely used strategy in computational nuclear physics and in quantum computing for nuclei. You must derive quantities from first principles and compute them numerically for a set of specified test cases.\n\nModel and definitions:\n- Consider a Hilbert space of dimension $2^L$ representing $L$ spinless single-particle orbitals mapped to qubits via the occupation number basis. A basis state is labeled by a bit string $\\mathbf{b}=(b_0,b_1,\\dots,b_{L-1})$ with $b_i \\in \\{0,1\\}$, corresponding to occupation of orbital $i$. The integer index of $\\mathbf{b}$ is $n=\\sum_{i=0}^{L-1} b_i 2^i$.\n- The particle-number operator is $\\hat{N}=\\sum_{i=0}^{L-1} \\hat{n}_i$, where $\\hat{n}_i$ is the number operator on orbital $i$, diagonal in the computational basis with eigenvalues $b_i$. For a basis state $\\mathbf{b}$, $\\hat{N}\\ket{\\mathbf{b}}=\\left(\\sum_{i=0}^{L-1} b_i\\right)\\ket{\\mathbf{b}}$.\n- Assign to each single-particle orbital $i$ an intrinsic parity $p_i \\in \\{+1,-1\\}$. The many-body parity eigenvalue on a basis state $\\mathbf{b}$ is $\\Pi(\\mathbf{b})=\\prod_{i=0}^{L-1} p_i^{b_i} \\in \\{+1,-1\\}$. Define the parity operator $\\hat{P}$ to be diagonal in the computational basis with eigenvalues $\\Pi(\\mathbf{b})$.\n- For fixed particle number $A$ and parity $\\pi \\in \\{+1,-1\\}$, define the symmetry subspace projector $\\hat{P}_{A,\\pi}=\\sum_{\\mathbf{b}:\\,\\sum_i b_i=A,\\,\\Pi(\\mathbf{b})=\\pi} \\ket{\\mathbf{b}}\\bra{\\mathbf{b}}$.\n- The target pure state is the equal superposition within the $(A,\\pi)$ subspace: if there are $K$ basis states in the subspace, $\\ket{\\psi}=\\frac{1}{\\sqrt{K}}\\sum_{\\mathbf{b} \\in \\mathcal{S}_{A,\\pi}} \\ket{\\mathbf{b}}$, where $\\mathcal{S}_{A,\\pi}=\\{\\mathbf{b}\\,|\\,\\sum_i b_i=A,\\,\\Pi(\\mathbf{b})=\\pi\\}$. If $K=0$, this target is undefined.\n- Model noise by the global depolarizing channel mixed with weight $\\varepsilon \\in [0,1]$ on the full space: the noisy state is the density operator $\\rho=(1-\\varepsilon)\\ket{\\psi}\\bra{\\psi}+\\varepsilon \\frac{\\mathbb{I}}{2^L}$, where $\\mathbb{I}$ is the identity on dimension $2^L$.\n- Symmetry-based error mitigation by post-selection is modeled by projecting $\\rho$ onto the $(A,\\pi)$ subspace and renormalizing: $\\rho'=\\frac{\\hat{P}_{A,\\pi}\\,\\rho\\,\\hat{P}_{A,\\pi}}{\\mathrm{Tr}(\\hat{P}_{A,\\pi}\\,\\rho)}$. The post-selection acceptance probability is $p_{\\mathrm{acc}}=\\mathrm{Tr}(\\hat{P}_{A,\\pi}\\,\\rho)$.\n- Define two observables: (i) the commuting observable $\\hat{O}_{\\mathrm{comm}}=\\hat{N}$, and (ii) a noncommuting observable $\\hat{O}_{\\mathrm{nonc}}=\\hat{X}_0$, the Pauli $X$ operator acting on qubit $0$ tensored with identity on all other qubits in the computational basis.\n\nRequired computations for each test case:\n- Compute the unmitigated fidelity $F_{\\mathrm{un}}=\\bra{\\psi}\\rho\\ket{\\psi}$.\n- Compute the mitigated fidelity $F_{\\mathrm{mit}}=\\bra{\\psi}\\rho'\\ket{\\psi}$, provided the denominator is nonzero.\n- Compute the fidelity improvement $\\Delta F=F_{\\mathrm{mit}}-F_{\\mathrm{un}}$.\n- Compute the acceptance probability $p_{\\mathrm{acc}}$.\n- Compute the residual bias for each observable as the signed difference between the mitigated noisy expectation and the exact target-state expectation:\n  - $b_{\\mathrm{comm}}=\\mathrm{Tr}(\\rho'\\hat{O}_{\\mathrm{comm}})-\\bra{\\psi}\\hat{O}_{\\mathrm{comm}}\\ket{\\psi}$,\n  - $b_{\\mathrm{nonc}}=\\mathrm{Tr}(\\rho'\\hat{O}_{\\mathrm{nonc}})-\\bra{\\psi}\\hat{O}_{\\mathrm{nonc}}\\ket{\\psi}$.\n- If the $(A,\\pi)$ subspace is empty ($K=0$), then $\\ket{\\psi}$ is undefined; in that case define $F_{\\mathrm{un}}$, $F_{\\mathrm{mit}}$, $\\Delta F$, $b_{\\mathrm{comm}}$, and $b_{\\mathrm{nonc}}$ as $\\mathrm{nan}$, and compute $p_{\\mathrm{acc}}=\\mathrm{Tr}\\left(\\hat{P}_{A,\\pi}\\,\\frac{\\mathbb{I}}{2^L}\\right)=\\frac{\\mathrm{Tr}(\\hat{P}_{A,\\pi})}{2^L}$.\n\nFundamental starting points you must use in your derivation and design:\n- Quantum states and mixed states are represented as density operators $\\rho$ on a Hilbert space, with expectations $\\langle \\hat{O} \\rangle=\\mathrm{Tr}(\\rho \\hat{O})$.\n- Projectors $\\hat{P}$ satisfy $\\hat{P}^2=\\hat{P}=\\hat{P}^\\dagger$ and implement ideal subspace post-selection, with renormalization by the Born rule probability $\\mathrm{Tr}(\\hat{P}\\rho)$.\n- Fidelity with a pure reference $\\ket{\\psi}$ is $F=\\bra{\\psi}\\rho\\ket{\\psi}$.\n\nNumerical and algorithmic constraints:\n- All computations should be exact linear algebra over finite-dimensional complex vector spaces using double-precision floating point arithmetic.\n- Angles do not appear; there is no requirement regarding angle units.\n- All outputs are dimensionless real numbers.\n\nTest suite:\nImplement your program to handle the following $4$ test cases. Each case specifies $(L,\\mathbf{p},A,\\pi,\\varepsilon)$, with $\\mathbf{p}=[p_0,p_1,\\dots,p_{L-1}]$.\n- Case $1$: $L=6$, $\\mathbf{p}=[+1,-1,+1,-1,+1,-1]$, $A=2$, $\\pi=+1$, $\\varepsilon=0.1$.\n- Case $2$: $L=5$, $\\mathbf{p}=[+1,+1,-1,-1,+1]$, $A=3$, $\\pi=-1$, $\\varepsilon=0.6$.\n- Case $3$: $L=4$, $\\mathbf{p}=[+1,-1,+1,-1]$, $A=2$, $\\pi=+1$, $\\varepsilon=0.0$.\n- Case $4$: $L=4$, $\\mathbf{p}=[+1,-1,+1,-1]$, $A=2$, $\\pi=+1$, $\\varepsilon=1.0$.\n\nFinal output specification:\n- For each test case, your program must produce a list with six floating-point numbers in the exact order: $[F_{\\mathrm{un}},F_{\\mathrm{mit}},\\Delta F,p_{\\mathrm{acc}},b_{\\mathrm{comm}},b_{\\mathrm{nonc}}]$.\n- Aggregate the results for all test cases into a single list of lists on one line, in the given test case order.\n- Round every numeric entry to exactly $6$ decimal places. If a value is undefined as specified above, print $\\mathrm{nan}$.\n- Your program should produce a single line of output containing the results in this aggregated format, for example $[[r_{1,1},r_{1,2},r_{1,3},r_{1,4},r_{1,5},r_{1,6}],[r_{2,1},\\dots],[r_{3,1},\\dots],[r_{4,1},\\dots]]$, where each $r_{i,j}$ is a float with $6$ decimal places or $\\mathrm{nan}$.",
            "solution": "This problem requires the derivation of analytical expressions for several figures of merit related to symmetry-based error mitigation, followed by their numerical evaluation for a given test suite. Let $L$ be the number of qubits, $D=2^L$ the Hilbert space dimension, $\\varepsilon$ the noise parameter, $A$ the target particle number, and $\\pi$ the target parity.\n\nFirst, we identify the symmetry subspace $\\mathcal{S}_{A,\\pi}$ and its dimension, $K = |\\mathcal{S}_{A,\\pi}|$. We iterate through all $D$ basis states $\\ket{\\mathbf{b}}$ and count how many satisfy the conditions $\\sum_i b_i = A$ and $\\prod_i p_i^{b_i} = \\pi$.\n\nIf $K=0$, the target state is undefined. Per the problem, $F_{\\mathrm{un}}$, $F_{\\mathrm{mit}}$, $\\Delta F$, $b_{\\mathrm{comm}}$, and $b_{\\mathrm{nonc}}$ are `nan`. The projector $\\hat{P}_{A,\\pi}$ is the zero operator, so its trace is 0. The acceptance probability for a fully mixed state (which we have when $\\ket{\\psi}$ is undefined) is $p_{\\mathrm{acc}} = \\mathrm{Tr}(\\hat{P}_{A,\\pi} \\frac{\\mathbb{I}}{D}) = \\frac{\\mathrm{Tr}(\\hat{P}_{A,\\pi})}{D} = 0$.\n\nIf $K0$, we derive the required quantities:\nThe noisy state is $\\rho = (1-\\varepsilon)\\ket{\\psi}\\bra{\\psi}+\\varepsilon \\frac{\\mathbb{I}}{D}$.\n\n1.  **Unmitigated Fidelity ($F_{\\mathrm{un}}$)**:\n    $F_{\\mathrm{un}} = \\bra{\\psi}\\rho\\ket{\\psi} = (1-\\varepsilon)\\bra{\\psi}\\ket{\\psi}\\braket{\\psi|\\psi} + \\frac{\\varepsilon}{D}\\braket{\\psi|\\psi} = (1-\\varepsilon) \\cdot 1 + \\frac{\\varepsilon}{D} \\cdot 1 = 1 - \\varepsilon + \\frac{\\varepsilon}{D}$.\n    $$F_{\\mathrm{un}} = 1 - \\varepsilon\\left(1 - \\frac{1}{D}\\right)$$\n\n2.  **Acceptance Probability ($p_{\\mathrm{acc}}$)**:\n    $p_{\\mathrm{acc}} = \\mathrm{Tr}(\\hat{P}_{A,\\pi}\\rho) = \\mathrm{Tr}\\left(\\hat{P}_{A,\\pi}\\left[(1-\\varepsilon)\\ket{\\psi}\\bra{\\psi}+\\frac{\\varepsilon}{D}\\mathbb{I}\\right]\\right)$.\n    Since $\\ket{\\psi}$ lies in the subspace, $\\hat{P}_{A,\\pi}\\ket{\\psi}=\\ket{\\psi}$. Also, $\\mathrm{Tr}(\\hat{P}_{A,\\pi})=K$.\n    $p_{\\mathrm{acc}} = (1-\\varepsilon)\\mathrm{Tr}(\\ket{\\psi}\\bra{\\psi}) + \\frac{\\varepsilon}{D}\\mathrm{Tr}(\\hat{P}_{A,\\pi}) = (1-\\varepsilon) + \\frac{\\varepsilon K}{D}$.\n    $$p_{\\mathrm{acc}} = 1 - \\varepsilon\\left(1 - \\frac{K}{D}\\right)$$\n\n3.  **Mitigated Fidelity ($F_{\\mathrm{mit}}$)**:\n    The mitigated state is $\\rho'=\\frac{\\hat{P}_{A,\\pi}\\,\\rho\\,\\hat{P}_{A,\\pi}}{p_{\\mathrm{acc}}}$.\n    $F_{\\mathrm{mit}} = \\bra{\\psi}\\rho'\\ket{\\psi} = \\frac{1}{p_{\\mathrm{acc}}}\\bra{\\psi}\\hat{P}_{A,\\pi}\\,\\rho\\,\\hat{P}_{A,\\pi}\\ket{\\psi}$.\n    Since $\\hat{P}_{A,\\pi}\\ket{\\psi}=\\ket{\\psi}$, this simplifies to $\\frac{1}{p_{\\mathrm{acc}}}\\bra{\\psi}\\rho\\ket{\\psi} = \\frac{F_{\\mathrm{un}}}{p_{\\mathrm{acc}}}$.\n    $$F_{\\mathrm{mit}} = \\frac{1 - \\varepsilon + \\varepsilon/D}{1 - \\varepsilon + \\varepsilon K/D}$$\n\n4.  **Fidelity Improvement ($\\Delta F$)**:\n    $\\Delta F = F_{\\mathrm{mit}} - F_{\\mathrm{un}}$.\n\n5.  **Residual Bias for $\\hat{O}_{\\mathrm{comm}}=\\hat{N}$ ($b_{\\mathrm{comm}}$)**:\n    The exact expectation is $\\bra{\\psi}\\hat{N}\\ket{\\psi}$. Since every basis state in the superposition $\\ket{\\psi}$ has particle number $A$, $\\hat{N}\\ket{\\psi}=A\\ket{\\psi}$, so $\\bra{\\psi}\\hat{N}\\ket{\\psi}=A$.\n    The mitigated expectation is $\\mathrm{Tr}(\\rho'\\hat{N}) = \\frac{1}{p_{\\mathrm{acc}}}\\mathrm{Tr}(\\hat{P}_{A,\\pi}\\rho\\hat{P}_{A,\\pi}\\hat{N})$.\n    The projector $\\hat{P}_{A,\\pi}$ commutes with $\\hat{N}$ and acts as a filter for eigenvalue $A$, so $\\hat{P}_{A,\\pi}\\hat{N} = \\hat{N}\\hat{P}_{A,\\pi} = A\\hat{P}_{A,\\pi}$.\n    $\\mathrm{Tr}(\\rho'\\hat{N}) = \\frac{A}{p_{\\mathrm{acc}}}\\mathrm{Tr}(\\hat{P}_{A,\\pi}\\rho\\hat{P}_{A,\\pi}) = \\frac{A}{p_{\\mathrm{acc}}}\\mathrm{Tr}(\\hat{P}_{A,\\pi}^2\\rho) = \\frac{A}{p_{\\mathrm{acc}}}\\mathrm{Tr}(\\hat{P}_{A,\\pi}\\rho) = \\frac{A}{p_{\\mathrm{acc}}}p_{\\mathrm{acc}} = A$.\n    The bias is $b_{\\mathrm{comm}} = A - A = 0$.\n\n6.  **Residual Bias for $\\hat{O}_{\\mathrm{nonc}}=\\hat{X}_0$ ($b_{\\mathrm{nonc}}$)**:\n    The exact expectation is $\\bra{\\psi}\\hat{X}_0\\ket{\\psi}$. Since $\\hat{X}_0$ flips the state of qubit 0, it changes the particle number by $\\pm 1$. The resulting state $\\hat{X}_0\\ket{\\psi}$ is therefore orthogonal to $\\ket{\\psi}$. Thus, $\\bra{\\psi}\\hat{X}_0\\ket{\\psi}=0$.\n    The mitigated expectation is $\\mathrm{Tr}(\\rho'\\hat{X}_0) = \\frac{1}{p_{\\mathrm{acc}}}\\mathrm{Tr}(\\hat{P}_{A,\\pi}\\rho\\hat{P}_{A,\\pi}\\hat{X}_0)$.\n    Using the cyclic property of the trace, this is $\\frac{1}{p_{\\mathrm{acc}}}\\mathrm{Tr}(\\hat{X}_0\\hat{P}_{A,\\pi}\\rho\\hat{P}_{A,\\pi})$.\n    The operator $\\hat{X}_0$ is purely off-diagonal in the computational basis, while $\\hat{P}_{A,\\pi}$ is diagonal. Therefore, the operator product $\\hat{X}_0\\hat{P}_{A,\\pi}$ is purely off-diagonal. Since $\\rho$ is diagonal in the basis that diagonalizes $\\ket{\\psi}\\bra{\\psi}$, this is complex.\n    Let's analyze $\\mathrm{Tr}(\\hat{P}_{A,\\pi}\\hat{X}_0\\hat{P}_{A,\\pi})$. An operator $\\hat{P}_{A,\\pi}\\hat{X}_0\\hat{P}_{A,\\pi}$ would map from a state in the symmetry subspace, flip a bit, and then project back. As the bit flip changes particle number, the state is projected to zero. Thus, $\\hat{P}_{A,\\pi}\\hat{X}_0\\hat{P}_{A,\\pi} = 0$.\n    The mitigated expectation is $\\mathrm{Tr}(\\rho'\\hat{X}_0) = \\frac{1}{p_{\\mathrm{acc}}}\\mathrm{Tr}(\\hat{P}_{A,\\pi}\\left[(1-\\varepsilon)\\ket{\\psi}\\bra{\\psi}+\\frac{\\varepsilon}{D}\\mathbb{I}\\right]\\hat{P}_{A,\\pi}\\hat{X}_0) = \\frac{1}{p_{\\mathrm{acc}}} \\mathrm{Tr}(0)=0$.\n    The bias is $b_{\\mathrm{nonc}} = 0 - 0 = 0$.\n\nNumerical evaluation for each case is done by first computing $K$ and $D=2^L$, then plugging the values into these formulas.",
            "answer": "[[0.901563,0.991409,0.089846,0.909375,0.000000,0.000000],[0.418750,0.817073,0.398323,0.512500,0.000000,0.000000],[1.000000,1.000000,0.000000,1.000000,0.000000,0.000000],[0.062500,0.500000,0.437500,0.125000,0.000000,0.000000]]"
        }
    ]
}