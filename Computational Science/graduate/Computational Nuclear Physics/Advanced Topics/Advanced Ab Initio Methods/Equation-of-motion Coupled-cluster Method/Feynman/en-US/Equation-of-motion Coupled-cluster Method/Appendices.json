{
    "hands_on_practices": [
        {
            "introduction": "This first practice grounds the abstract theory of Equation-of-Motion Coupled-Cluster (EOM-CC) in a direct, tangible calculation. By constructing and diagonalizing a small EOM matrix for a simplified model, you will gain hands-on experience with the core eigenvalue problem that yields excitation energies. This exercise clarifies how dressed one- and two-body interactions, derived from the ground-state coupled-cluster solution, form the effective Hamiltonian, $\\bar{H}$, in the excited-state basis .",
            "id": "3558017",
            "problem": "Consider a closed-shell reference state in a minimal two-level model relevant to computational nuclear physics. The Hamiltonian is normal ordered with respect to the Hartree-Fock reference $|\\Phi_0\\rangle$ and written as $H_N = F + V$, where $F$ is the one-body part and $V$ is the two-body interaction. The coupled-cluster ground state is $|\\Psi_0\\rangle = \\exp(T) |\\Phi_0\\rangle$ with cluster operator $T = T_1 + T_2$, and the similarity-transformed Hamiltonian is defined as $\\bar{H} = \\exp(-T) H_N \\exp(T)$. The Equation-of-Motion Coupled-Cluster with singles and doubles (EOM-CCSD) excited-state problem is to solve\n$$\n\\bar{H} R |\\Phi_0\\rangle = \\omega R |\\Phi_0\\rangle,\n$$\nwhere the excitation operator $R$ is truncated to the singles sector as $R = \\sum_{ai} r_i^{a} a_a^{\\dagger} a_i$, with $i$ denoting an occupied (hole) orbital and $a$ denoting an unoccupied (particle) orbital. In this two-level model, there is a single hole orbital $i$ and two particle orbitals $p_1$ and $p_2$, defining the singles basis $\\{ a_{p_1}^{\\dagger} a_i |\\Phi_0\\rangle, a_{p_2}^{\\dagger} a_i |\\Phi_0\\rangle \\}$.\n\nStarting from the EOM-CCSD eigenvalue equation and the definition of the singles projection, set up the $2 \\times 2$ matrix representation of $\\bar{H}$ in the singles sector,\n$$\nA_{ai,bj} = \\langle \\Phi_0 | a_i^{\\dagger} a_a \\, \\bar{H} \\, a_b^{\\dagger} a_j | \\Phi_0 \\rangle,\n$$\nrestricted to $i=j$ and $a,b \\in \\{p_1,p_2\\}$. For this model, assume the one-body dressed energy differences and the effective two-body contributions to the singles-singles block of $\\bar{H}$ have been determined from the coupled-cluster ground state as follows:\n- Dressed one-body energy gaps: $\\tilde{\\epsilon}_{p_1} - \\tilde{\\epsilon}_{i} = 6.2$, $\\tilde{\\epsilon}_{p_2} - \\tilde{\\epsilon}_{i} = 8.5$.\n- Effective interaction matrix elements in the singles-singles block: $\\tilde{W}_{p_1 i}^{p_1 i} = -0.3$, $\\tilde{W}_{p_2 i}^{p_2 i} = -0.2$, and $\\tilde{W}_{p_1 i}^{p_2 i} = \\tilde{W}_{p_2 i}^{p_1 i} = 0.4$.\n\nUsing these quantities, explicitly write down the $2 \\times 2$ singles-singles matrix and compute its eigenvalues, which approximate the excitation energies $\\omega$ in this truncated EOM-CCSD treatment. Round your numerical answers to four significant figures. Express the final energies in MeV.",
            "solution": "The problem requires us to solve the EOM-CCSD eigenvalue equation in a truncated singles space. The equation in matrix form is $A \\mathbf{r} = \\omega \\mathbf{r}$, where $A$ is the matrix representation of the similarity-transformed Hamiltonian $\\bar{H}$ in the singles basis, and $\\mathbf{r}$ is the vector of amplitudes $r_i^a$. The eigenvalues $\\omega$ correspond to the excitation energies.\n\nThe basis for the singles space is spanned by the two states $|\\Phi_i^{p_1}\\rangle = a_{p_1}^{\\dagger} a_i |\\Phi_0\\rangle$ and $|\\Phi_i^{p_2}\\rangle = a_{p_2}^{\\dagger} a_i |\\Phi_0\\rangle$. The $2 \\times 2$ matrix $A$ has elements $A_{ab} = \\langle \\Phi_i^a | \\bar{H} | \\Phi_i^b \\rangle$, where $a, b \\in \\{p_1, p_2\\}$.\n\nThe problem provides the constituent parts of these matrix elements: \"dressed one-body energy gaps\" and \"effective interaction matrix elements.\" In the EOM-CCSD formalism, the matrix elements of $\\bar{H}$ are constructed from one-body and two-body terms, modified by the coupled-cluster amplitudes. The given quantities represent the final values for these contributions. The total matrix element is the sum of these parts. Specifically, a diagonal element $A_{aa}$ is the sum of the corresponding dressed energy gap and the diagonal effective interaction, while an off-diagonal element $A_{ab}$ ($a \\neq b$) consists only of the off-diagonal effective interaction term.\n\nThe matrix elements are constructed as follows:\n$A_{ab} = (\\tilde{\\epsilon}_a - \\tilde{\\epsilon}_i) \\delta_{ab} + \\tilde{W}_{ai}^{bi}$, where $\\delta_{ab}$ is the Kronecker delta.\n\nLet's compute the four elements of the matrix $A$:\n1.  Diagonal element $A_{p_1, p_1}$:\n    $$A_{p_1, p_1} = (\\tilde{\\epsilon}_{p_1} - \\tilde{\\epsilon}_i) + \\tilde{W}_{p_1 i}^{p_1 i} = 6.2 + (-0.3) = 5.9$$\n\n2.  Diagonal element $A_{p_2, p_2}$:\n    $$A_{p_2, p_2} = (\\tilde{\\epsilon}_{p_2} - \\tilde{\\epsilon}_i) + \\tilde{W}_{p_2 i}^{p_2 i} = 8.5 + (-0.2) = 8.3$$\n\n3.  Off-diagonal element $A_{p_1, p_2}$:\n    $$A_{p_1, p_2} = \\tilde{W}_{p_1 i}^{p_2 i} = 0.4$$\n\n4.  Off-diagonal element $A_{p_2, p_1}$:\n    $$A_{p_2, p_1} = \\tilde{W}_{p_2 i}^{p_1 i} = 0.4$$\n\nThe resulting $2 \\times 2$ singles-singles matrix is:\n$$\nA = \\begin{pmatrix} 5.9 & 0.4 \\\\ 0.4 & 8.3 \\end{pmatrix}\n$$\nThe eigenvalues $\\omega$ of this matrix are the solutions to the characteristic equation $\\det(A - \\omega I) = 0$, where $I$ is the $2 \\times 2$ identity matrix.\n$$\n\\det \\begin{pmatrix} 5.9 - \\omega & 0.4 \\\\ 0.4 & 8.3 - \\omega \\end{pmatrix} = 0\n$$\nExpanding the determinant gives the quadratic equation:\n$$\n(5.9 - \\omega)(8.3 - \\omega) - (0.4)(0.4) = 0\n$$\n$$\n48.97 - 5.9\\omega - 8.3\\omega + \\omega^2 - 0.16 = 0\n$$\n$$\n\\omega^2 - 14.2\\omega + 48.81 = 0\n$$\nWe solve this quadratic equation for $\\omega$ using the quadratic formula, $\\omega = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$, with $a=1$, $b=-14.2$, and $c=48.81$.\n$$\n\\omega = \\frac{-(-14.2) \\pm \\sqrt{(-14.2)^2 - 4(1)(48.81)}}{2(1)}\n$$\n$$\n\\omega = \\frac{14.2 \\pm \\sqrt{201.64 - 195.24}}{2}\n$$\n$$\n\\omega = \\frac{14.2 \\pm \\sqrt{6.4}}{2}\n$$\nNow, we calculate the numerical values of the two eigenvalues, which represent the excitation energies in MeV.\n$$\n\\sqrt{6.4} \\approx 2.5298221\n$$\nThe two eigenvalues are:\n$$\n\\omega_1 = \\frac{14.2 - 2.5298221}{2} = \\frac{11.6701779}{2} \\approx 5.8350889\n$$\n$$\n\\omega_2 = \\frac{14.2 + 2.5298221}{2} = \\frac{16.7298221}{2} \\approx 8.3649111\n$$\nRounding these values to four significant figures, as requested:\n$$\n\\omega_1 \\approx 5.835 \\, \\text{MeV}\n$$\n$$\n\\omega_2 \\approx 8.365 \\, \\text{MeV}\n$$\nThese are the approximate excitation energies obtained from this truncated EOM-CCSD calculation.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n5.835 & 8.365\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "A crucial feature of any robust many-body method is size-intensivity, ensuring that calculated properties of a subsystem are independent of the presence of other, non-interacting subsystems. This practice guides you through a numerical experiment to verify this fundamental property for EOM-CC excitation energies. By implementing a model of two non-interacting systems, you will demonstrate that the excitation energy of one system remains unchanged, providing a concrete confirmation of the method's theoretical soundness .",
            "id": "3557984",
            "problem": "Design and implement a complete, runnable program that numerically verifies the size-intensivity of Equation-of-Motion Coupled-Cluster with Singles and Doubles (EOM-CCSD) excitation energies by comparing the excitation energy $\\,\\omega\\,$ for an isolated subsystem $\\,A\\,$ with that extracted from a noninteracting composite $\\,A+B\\,$. The experiment must use the similarity-transformed Hamiltonian $\\,\\bar{H} = e^{-T} H e^{T}\\,$ and a block-diagonal (direct-sum) Hamiltonian for the composite, consistent with noninteracting subsystems.\n\nStart from the following foundational concepts and definitions:\n- The coupled-cluster ground state is constructed with the cluster operator $\\,T\\,$ as $\\,\\lvert \\Psi_0 \\rangle = e^{T} \\lvert \\Phi_0 \\rangle\\,$, where $\\,\\lvert \\Phi_0 \\rangle\\,$ is a reference state (vacuum with respect to excitations). The similarity-transformed Hamiltonian is $\\,\\bar{H} = e^{-T} H e^{T}\\,$.\n- The normal-ordered similarity-transformed Hamiltonian is $\\,\\bar{H}_N = \\bar{H} - E_{\\mathrm{CC}}\\mathbb{1}\\,$, where $\\,E_{\\mathrm{CC}} = \\langle \\Phi_0 \\lvert \\bar{H} \\rvert \\Phi_0 \\rangle\\,$ is the coupled-cluster ground-state energy.\n- The Equation-of-Motion (EOM) eigenproblem for particle-number-conserving excitations is $\\,\\bar{H}_N R \\lvert \\Phi_0 \\rangle = \\omega \\, R \\lvert \\Phi_0 \\rangle\\,$, projected into a chosen excitation manifold. The eigenvalues $\\,\\omega\\,$ are excitation energies. For noninteracting subsystems $\\,A\\,$ and $\\,B\\,$ with a block-diagonal Hamiltonian, size-intensivity implies that an excitation localized to $\\,A\\,$ has the same $\\,\\omega\\,$ whether computed for $\\,A\\,$ alone or for the composite $\\,A+B\\,$.\n\nModel and numerical protocol to implement:\n1. Each subsystem $\\,X \\in \\{A,B\\}\\,$ is a two-state many-body model with basis $\\,\\{\\lvert \\Phi_X \\rangle,\\lvert D_X \\rangle\\}\\,$, where $\\,\\lvert \\Phi_X \\rangle\\,$ is the reference determinant and $\\,\\lvert D_X \\rangle\\,$ represents a $2p\\text{--}2h$-like excited configuration. The Hamiltonian of $\\,X\\,$ is the $\\,2\\times 2\\,$ matrix\n   $$ H_X = \\begin{pmatrix} E_X^{(0)} & V_X \\\\ V_X & E_X^{(d)} \\end{pmatrix}, $$\n   with parameters $\\,E_X^{(0)}\\,$, $\\,E_X^{(d)}\\,$, and $\\,V_X\\,$ in mega-electronvolts (MeV).\n2. The composite noninteracting Hamiltonian is\n   $$ H_{A+B} = H_A \\otimes \\mathbb{1}_B + \\mathbb{1}_A \\otimes H_B, $$\n   acting on the tensor-product basis $\\,\\{\\lvert \\Phi_A \\rangle,\\lvert D_A \\rangle\\} \\otimes \\{\\lvert \\Phi_B \\rangle,\\lvert D_B \\rangle\\}$.\n3. For each $\\,X \\in \\{A,B\\}\\,$, construct a singles-doubles cluster operator that excites only within $\\,X\\,$:\n   $$ T_X = t_X \\,\\lvert D_X \\rangle \\langle \\Phi_X \\rvert, $$\n   so that $\\,T_X^2 = 0\\,$ and $\\,e^{T_X} = \\mathbb{1}_X + T_X\\,$. Determine $\\,t_X\\,$ by enforcing the coupled-cluster ground-state condition $\\,e^{T_X} \\lvert \\Phi_X \\rangle \\propto \\lvert \\Psi_{0,X} \\rangle\\,$, where $\\,\\lvert \\Psi_{0,X} \\rangle\\,$ is the normalized ground-state eigenvector of $\\,H_X\\,$. For the composite, use\n   $$ T_{A+B} = T_A \\otimes \\mathbb{1}_B + \\mathbb{1}_A \\otimes T_B, $$\n   which obeys $\\,T_{A+B}^3 = 0\\,$ and\n   $$ e^{T_{A+B}} = \\mathbb{1} + T_{A+B} + \\tfrac{1}{2} T_{A+B}^2. $$\n4. Form the similarity-transformed Hamiltonians\n   $$ \\bar{H}_A = e^{-T_A} H_A e^{T_A}, \\quad \\bar{H}_{A+B} = e^{-T_{A+B}} H_{A+B} e^{T_{A+B}}, $$\n   and the corresponding normal-ordered operators\n   $$ \\bar{H}_{N,A} = \\bar{H}_A - E_{\\mathrm{CC},A}\\,\\mathbb{1}_A, \\quad \\bar{H}_{N,A+B} = \\bar{H}_{A+B} - E_{\\mathrm{CC},A+B}\\,\\mathbb{1}, $$\n   with $\\,E_{\\mathrm{CC},A} = \\langle \\Phi_A \\lvert \\bar{H}_A \\rvert \\Phi_A \\rangle\\,$ and $\\,E_{\\mathrm{CC},A+B} = \\langle \\Phi_A \\Phi_B \\lvert \\bar{H}_{A+B} \\rvert \\Phi_A \\Phi_B \\rangle\\,$.\n5. Extract the EOM excitation energy localized on $\\,A\\,$:\n   - Isolated $\\,A\\,$: project $\\,\\bar{H}_{N,A}\\,$ onto $\\,\\lvert D_A \\rangle\\,$ and set $\\,\\omega_A^{\\text{(iso)}} = \\langle D_A \\lvert \\bar{H}_{N,A} \\rvert D_A \\rangle\\,$.\n   - Composite $\\,A+B\\,$: project $\\,\\bar{H}_{N,A+B}\\,$ onto $\\,\\lvert D_A \\rangle \\otimes \\lvert \\Phi_B \\rangle\\,$ and set $\\,\\omega_A^{(A+B)} = \\langle D_A \\Phi_B \\lvert \\bar{H}_{N,A+B} \\rvert D_A \\Phi_B \\rangle\\,$.\n6. For each test case below, compute the absolute difference\n   $$ \\Delta \\omega_A = \\left| \\omega_A^{\\text{(iso)}} - \\omega_A^{(A+B)} \\right| \\quad \\text{in MeV}. $$\n\nTest suite (all energies and couplings in MeV; specify outputs in MeV as decimal floats):\n- Case $\\,1\\,$ (general, nontrivial couplings):\n  - $\\,A\\,$: $\\,E_A^{(0)} = 0.0\\,$, $\\,E_A^{(d)} = 4.0\\,$, $\\,V_A = 0.5\\,$.\n  - $\\,B\\,$: $\\,E_B^{(0)} = -1.0\\,$, $\\,E_B^{(d)} = 3.5\\,$, $\\,V_B = 0.1\\,$.\n- Case $\\,2\\,$ (edge: no coupling in $\\,A\\,$, strong in $\\,B\\,$):\n  - $\\,A\\,$: $\\,E_A^{(0)} = 0.0\\,$, $\\,E_A^{(d)} = 4.0\\,$, $\\,V_A = 0.0\\,$.\n  - $\\,B\\,$: $\\,E_B^{(0)} = 2.0\\,$, $\\,E_B^{(d)} = 5.0\\,$, $\\,V_B = 0.8\\,$.\n- Case $\\,3\\,$ (near-degeneracy in $\\,A\\,$, moderate in $\\,B\\,$):\n  - $\\,A\\,$: $\\,E_A^{(0)} = 0.0\\,$, $\\,E_A^{(d)} = 2.0\\,$, $\\,V_A = 0.7\\,$.\n  - $\\,B\\,$: $\\,E_B^{(0)} = -3.0\\,$, $\\,E_B^{(d)} = 1.0\\,$, $\\,V_B = 0.2\\,$.\n- Case $\\,4\\,$ (large energy offset in $\\,B\\,$):\n  - $\\,A\\,$: $\\,E_A^{(0)} = 1.0\\,$, $\\,E_A^{(d)} = 6.0\\,$, $\\,V_A = 0.3\\,$.\n  - $\\,B\\,$: $\\,E_B^{(0)} = 10.0\\,$, $\\,E_B^{(d)} = 12.0\\,$, $\\,V_B = 0.4\\,$.\n\nProgram requirements:\n- Implement the construction of $\\,T_A\\,$ and $\\,T_B\\,$ by enforcing $\\,e^{T_X} \\lvert \\Phi_X \\rangle\\,$ equals the normalized ground-state eigenvector of $\\,H_X\\,$ for $\\,X \\in \\{A,B\\}\\,$.\n- Use the exact finite series for nilpotent cluster operators to evaluate $\\,e^{\\pm T_X}\\,$ and $\\,e^{\\pm T_{A+B}}\\,$.\n- For each of the four cases, compute $\\,\\Delta \\omega_A\\,$ in MeV.\n- Final output format: your program should produce a single line containing the results as a comma-separated list enclosed in square brackets, for example $\\big[\\Delta\\omega_A^{(1)},\\Delta\\omega_A^{(2)},\\Delta\\omega_A^{(3)},\\Delta\\omega_A^{(4)}\\big]$. Express each entry as a decimal floating-point number in MeV with the natural precision of the computation (no unit symbol in the output).",
            "solution": "This problem requires a numerical verification of the size-intensivity of EOM-CC excitation energies. The protocol involves comparing the excitation energy of a subsystem $A$ calculated in isolation with that calculated in a non-interacting composite system $A+B$. The analytical derivation shows that these two quantities should be identical, so the numerical implementation should yield a difference of zero (or a value limited by floating-point precision).\n\nThe basis states for a subsystem $X \\in \\{A, B\\}$ are represented as vectors: $\\lvert \\Phi_X \\rangle \\equiv \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$ and $\\lvert D_X \\rangle \\equiv \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$. The cluster amplitude $t_X$ is computed from the ground-state eigenvector $\\lvert \\Psi_{0,X} \\rangle = c_0 \\lvert \\Phi_X \\rangle + c_d \\lvert D_X \\rangle$ of the subsystem Hamiltonian $H_X$ via the ratio $t_X = c_d / c_0$.\n\nWith the amplitudes $t_A$ and $t_B$ determined, the protocol specified in the problem is followed. For the isolated system $A$, the similarity-transformed Hamiltonian $\\bar{H}_A = e^{-T_A} H_A e^{T_A}$ is constructed, from which the CC energy $E_{\\mathrm{CC},A}$ and the excitation energy $\\omega_A^{\\text{(iso)}}$ are calculated.\n\nFor the composite system, the key insight is that the similarity-transformed Hamiltonian retains an additive structure for non-interacting subsystems: $\\bar{H}_{A+B} = \\bar{H}_A \\otimes \\mathbb{1}_B + \\mathbb{1}_A \\otimes \\bar{H}_B$. This ensures the size-extensivity of the ground-state energy, $E_{\\mathrm{CC},A+B} = E_{\\mathrm{CC},A} + E_{\\mathrm{CC},B}$, and the size-intensivity of the local excitation energy. The excitation energy localized on $A$, $\\omega_A^{(A+B)}$, is extracted from the appropriate matrix element of the normal-ordered composite Hamiltonian, $\\bar{H}_{N,A+B} = \\bar{H}_{A+B} - E_{\\mathrm{CC},A+B} \\mathbb{1}$.\n\nThe numerical implementation will perform these matrix operations for each test case and compute the absolute difference $\\Delta \\omega_A = |\\omega_A^{\\text{(iso)}} - \\omega_A^{(A+B)}|$, which is expected to be zero.",
            "answer": "```python\nimport numpy as np\n\ndef get_t_amplitude(H):\n    \"\"\"\n    Calculates the cluster amplitude t for a 2x2 subsystem Hamiltonian.\n\n    The amplitude t is determined from the ground state eigenvector [c0, c_d]\n    as t = c_d / c_0.\n\n    Args:\n        H (np.ndarray): The 2x2 subsystem Hamiltonian matrix.\n\n    Returns:\n        float: The cluster amplitude t.\n    \"\"\"\n    # Check for the non-interacting case\n    if np.isclose(H[0, 1], 0.0):\n        # If uncoupled, ground state is the reference if E0 < Ed\n        if H[0, 0] < H[1, 1]:\n            return 0.0\n        else: # Ground state is the excited state, c0=0, t is infinite.\n              # This scenario is not expected in the test cases provided.\n            return np.inf\n\n    eigvals, eigvecs = np.linalg.eigh(H)\n    \n    # Find the ground state (lowest eigenvalue)\n    gs_index = np.argmin(eigvals)\n    gs_eigenvector = eigvecs[:, gs_index]\n    \n    c0, c_d = gs_eigenvector[0], gs_eigenvector[1]\n\n    # Handle the case where the eigenvector might have its phase flipped\n    if np.isclose(c0, 0.0):\n        # If c0 is zero, t would be infinite. This implies the ground state is\n        # purely the D state, which is physically unusual unless E_d < E_0\n        # for a V=0 system. The V=0 case is handled above. For V!=0, c0!=0.\n        # This is a safeguard.\n        raise ValueError(\"c0 component of ground state is zero; t-amplitude is undefined.\")\n\n    return c_d / c0\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for all test cases.\n    \"\"\"\n    test_cases = [\n        # Case 1 (general, nontrivial couplings)\n        {'A': {'E0': 0.0, 'Ed': 4.0, 'V': 0.5}, 'B': {'E0': -1.0, 'Ed': 3.5, 'V': 0.1}},\n        # Case 2 (edge: no coupling in A, strong in B)\n        {'A': {'E0': 0.0, 'Ed': 4.0, 'V': 0.0}, 'B': {'E0': 2.0, 'Ed': 5.0, 'V': 0.8}},\n        # Case 3 (near-degeneracy in A, moderate in B)\n        {'A': {'E0': 0.0, 'Ed': 2.0, 'V': 0.7}, 'B': {'E0': -3.0, 'Ed': 1.0, 'V': 0.2}},\n        # Case 4 (large energy offset in B)\n        {'A': {'E0': 1.0, 'Ed': 6.0, 'V': 0.3}, 'B': {'E0': 10.0, 'Ed': 12.0, 'V': 0.4}},\n    ]\n    \n    results = []\n    \n    # Identity matrices of size 2 and 4\n    I2 = np.identity(2)\n    I4 = np.identity(4)\n\n    for case in test_cases:\n        params_A = case['A']\n        params_B = case['B']\n        \n        # --- Isolated System A ---\n        \n        H_A = np.array([[params_A['E0'], params_A['V']], \n                        [params_A['V'], params_A['Ed']]])\n        \n        t_A = get_t_amplitude(H_A)\n        \n        T_A = np.array([[0.0, 0.0], [t_A, 0.0]])\n        \n        exp_T_A = I2 + T_A\n        exp_neg_T_A = I2 - T_A\n        \n        Hbar_A = exp_neg_T_A @ H_A @ exp_T_A\n        \n        E_cc_A = Hbar_A[0, 0]\n        \n        Hbar_N_A = Hbar_A - E_cc_A * I2\n        \n        omega_iso_A = Hbar_N_A[1, 1]\n\n        # --- Composite System A+B ---\n        \n        H_B = np.array([[params_B['E0'], params_B['V']], \n                        [params_B['V'], params_B['Ed']]])\n                        \n        t_B = get_t_amplitude(H_B)\n        \n        T_B = np.array([[0.0, 0.0], [t_B, 0.0]])\n        \n        # Build composite operators using tensor products (np.kron)\n        H_AB = np.kron(H_A, I2) + np.kron(I2, H_B)\n        \n        T_AB = np.kron(T_A, I2) + np.kron(I2, T_B)\n        \n        # Since T_A^2 = 0 and T_B^2 = 0, it follows that T_{A+B}^3 = 0.\n        # e^{T} = 1 + T + T^2/2\n        # T_{A+B}^2 = 2 * (T_A kron T_B)\n        T_AB_sq = 2 * np.kron(T_A, T_B)\n        \n        exp_T_AB = I4 + T_AB + 0.5 * T_AB_sq\n        exp_neg_T_AB = I4 - T_AB + 0.5 * T_AB_sq\n        \n        Hbar_AB = exp_neg_T_AB @ H_AB @ exp_T_AB\n        \n        # Reference state |Phi_A Phi_B> corresponds to vector [1,0,0,0]\n        E_cc_AB = Hbar_AB[0, 0]\n        \n        Hbar_N_AB = Hbar_AB - E_cc_AB * I4\n        \n        # Excited state |D_A Phi_B> corresponds to vector [0,0,1,0]\n        omega_comp_A = Hbar_N_AB[2, 2]\n        \n        # --- Calculate the difference ---\n        \n        delta_omega_A = abs(omega_iso_A - omega_comp_A)\n        results.append(delta_omega_A)\n        \n    # Print final results in the required format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "The EOM-CC method works with a non-Hermitian effective Hamiltonian, $\\bar{H}$, leading to unique physical and numerical consequences. This advanced practice explores the concept of biorthogonality by calculating the Petermann factor, which signals proximity to an exceptional point where eigenstates coalesce. You will numerically investigate the link between a large Petermann factor and the heightened sensitivity of calculated observables to small perturbations, a critical consideration for interpreting results from near-degenerate systems .",
            "id": "3558048",
            "problem": "You are given a non-Hermitian eigenvalue problem arising from the Equation-of-Motion Coupled-Cluster (EOM-CC) method in computational nuclear physics. In EOM-CC, the similarity-transformed Hamiltonian is defined as $\\bar{H} = e^{-T} H e^{T}$, where $T$ is the cluster operator from Coupled-Cluster (CC) theory, and $H$ is the nuclear many-body Hamiltonian. The similarity-transformed operator $\\bar{H}$ is non-Hermitian, so its right and left eigenvectors, denoted by $R_i$ and $L_i$ respectively, satisfy distinct eigen-equations:\n$$\n\\bar{H} R_i = \\omega_i R_i, \\quad L_i^{\\top} \\bar{H} = \\omega_i L_i^{\\top}.\n$$\nFor a given state $i$, the Petermann factor is defined as $K_i = (L_i^{\\top} R_i)^{-1}$, when $L_i$ and $R_i$ are independently normalized to unit norm. In non-Hermitian systems, large values of $K_i$ indicate strong biorthogonality and are known to correlate with enhanced sensitivity of observables and with numerical instability near nearly coalescing (almost defective) eigenstates. Consider a family of $2 \\times 2$ real matrices that model a reduced-space similarity-transformed Hamiltonian,\n$$\n\\bar{H}(\\delta) = \\begin{pmatrix} \\lambda & g \\\\ \\delta & \\lambda \\end{pmatrix},\n$$\nwhere $\\lambda$, $g$, and $\\delta$ are real parameters. Take $\\lambda = 0$ and $g = 1$ for all test cases. Define a fixed transition operator\n$$\nO = \\begin{pmatrix} 0 & 1 \\\\ \\alpha & 0 \\end{pmatrix},\n$$\nwith $\\alpha = 0.3$. For each test case, perform the following steps:\n- Compute the right eigenpairs $(\\omega_i, R_i)$ of $\\bar{H}(\\delta)$.\n- Compute the left eigenpairs $(\\omega_i, L_i)$ from $\\bar{H}(\\delta)^{\\top}$ and match each left eigenvector $L_i$ to the right eigenvector $R_i$ with the closest eigenvalue $\\omega_i$ (matching by minimal absolute difference of eigenvalues).\n- Normalize all $R_i$ and $L_i$ to unit vector norm.\n- Compute the Petermann factors $K_i = (L_i^{\\top} R_i)^{-1}$ for all states $i$ and aggregate the result by taking $\\max_i |K_i|$.\n- Define the unperturbed transition strength between the lower and higher eigenstates as\n$$\nS = \\big| L_{j}^{\\top} O R_{i} \\big|^2,\n$$\nwhere $i$ indexes the lower-eigenvalue state and $j$ indexes the higher-eigenvalue state.\n- Apply a small perturbation of size $\\epsilon$ to the Hamiltonian parameters, yielding\n$$\n\\bar{H}'(\\delta, \\epsilon) = \\begin{pmatrix} \\lambda & g - \\epsilon \\\\ \\delta + \\epsilon & \\lambda \\end{pmatrix},\n$$\nrecompute the left and right eigenvectors, and the perturbed transition strength $S'$. Compute the relative change\n$$\nr = \\frac{|S' - S|}{\\max(S, 10^{-16})},\n$$\nusing a small regularizer $10^{-16}$ to avoid division by zero.\n\nYour program must compute, for each test case, the pair $[\\max_i |K_i|, r]$, and aggregate all test case results into a single line of output as a comma-separated Python-style list of lists. Use no physical units, as all quantities are dimensionless. Angles do not appear. All outputs must be real-valued floats.\n\nTest suite:\n- Case $1$ (happy path, moderate non-Hermiticity): $\\delta = 0.5$, $\\epsilon = 10^{-6}$.\n- Case $2$ (near coalescing eigenvalues, strong non-Hermiticity): $\\delta = 10^{-12}$, $\\epsilon = 10^{-6}$.\n- Case $3$ (Hermitian edge case): $\\delta = 1.0$, $\\epsilon = 10^{-6}$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each test case contributes a list $[\\max_i |K_i|, r]$, so the final output must look like `[[k_1, r_1],[k_2, r_2],[k_3, r_3]]` with each $k_n$ and $r_n$ being floats.",
            "solution": "This problem explores the consequences of the non-Hermitian nature of the EOM-CC effective Hamiltonian, $\\bar{H}$. We will implement a numerical calculation for the given $2 \\times 2$ model to find the Petermann factor, a measure of biorthogonality, and investigate its correlation with the sensitivity of a transition strength to small perturbations.\n\nThe procedure for each test case is as follows:\n1.  **Unperturbed System**:\n    -   Construct the unperturbed Hamiltonian $\\bar{H}(\\delta)$ and the transition operator $O$.\n    -   Compute the right eigenpairs $(\\omega_i, R_i)$ of $\\bar{H}$ and the left eigenpairs $(\\omega_i, L_i)$ of $\\bar{H}^{\\top}$.\n    -   Sort the eigenpairs based on the real part of their eigenvalues to ensure correct matching between left and right eigenvectors corresponding to the same state.\n    -   Normalize all eigenvectors to unit Euclidean norm.\n    -   Calculate the Petermann factors $K_i = (L_i^{\\top} R_i)^{-1}$ and find the maximum absolute value, $\\max_i |K_i|$.\n    -   Compute the unperturbed transition strength $S = |L_j^{\\top} O R_i|^2$ between the state with the lower eigenvalue ($i$) and the state with the higher eigenvalue ($j$).\n\n2.  **Perturbed System**:\n    -   Construct the perturbed Hamiltonian $\\bar{H}'(\\delta, \\epsilon)$.\n    -   Recompute the sorted, normalized left and right eigenvectors ($L'_i, R'_i$).\n    -   Calculate the perturbed transition strength $S' = |(L'_j)^{\\top} O R'_i|^2$.\n\n3.  **Sensitivity Analysis**:\n    -   Compute the relative change in the transition strength, $r = \\frac{|S' - S|}{\\max(S, 10^{-16})}$.\n\nThis protocol will be implemented numerically using Python and NumPy for all linear algebra operations.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef calculate_pair(delta, epsilon):\n    \"\"\"\n    Computes the pair [max|Ki|, r] for a given delta and epsilon.\n    \"\"\"\n    # Define fixed parameters\n    lam = 0.0\n    g = 1.0\n    alpha = 0.3\n    \n    # Define the transition operator O\n    O_op = np.array([[0.0, 1.0], [alpha, 0.0]])\n\n    # ---- 1. Unperturbed System Analysis ----\n    \n    # Define the unperturbed Hamiltonian H\n    H = np.array([[lam, g], [delta, lam]])\n    \n    # Compute right eigenvalues and eigenvectors of H\n    w_r, R = np.linalg.eig(H)\n    \n    # Compute left eigenvalues and eigenvectors (from H.T)\n    w_l, L_T = np.linalg.eig(H.T)\n    L = L_T\n    \n    # Sort eigenpairs by the real part of the eigenvalues to ensure consistent ordering\n    # Lower eigenvalue first, then higher\n    sort_idx_r = np.argsort(np.real(w_r))\n    R = R[:, sort_idx_r]\n    \n    # Match left eigenvectors to right eigenvectors by sorting them as well\n    sort_idx_l = np.argsort(np.real(w_l))\n    L = L[:, sort_idx_l]\n    \n    # Normalize eigenvectors\n    R0 = R[:, 0] / np.linalg.norm(R[:, 0])\n    R1 = R[:, 1] / np.linalg.norm(R[:, 1])\n    L0 = L[:, 0] / np.linalg.norm(L[:, 0])\n    L1 = L[:, 1] / np.linalg.norm(L[:, 1])\n    \n    # Compute Petermann factors\n    # For real matrices/vectors, L.T @ R is the dot product\n    K0 = 1.0 / np.dot(L0, R0)\n    K1 = 1.0 / np.dot(L1, R1)\n    max_K = max(abs(K0), abs(K1))\n    \n    # Compute unperturbed transition strength S\n    # S = |<L_higher| O |R_lower>|^2\n    S = abs(L1.T @ O_op @ R0)**2\n\n    # ---- 2. Perturbed System Analysis ----\n    \n    # Define the perturbed Hamiltonian H'\n    H_p = np.array([[lam, g - epsilon], [delta + epsilon, lam]])\n    \n    # Compute and sort perturbed right eigenvectors\n    wp_r, Rp = np.linalg.eig(H_p)\n    sort_idx_rp = np.argsort(np.real(wp_r))\n    Rp = Rp[:, sort_idx_rp]\n    \n    # Compute and sort perturbed left eigenvectors\n    wp_l, Lp_T = np.linalg.eig(H_p.T)\n    Lp = Lp_T\n    sort_idx_lp = np.argsort(np.real(wp_l))\n    Lp = Lp[:, sort_idx_lp]\n    \n    # Normalize perturbed eigenvectors\n    Rp0 = Rp[:, 0] / np.linalg.norm(Rp[:, 0])\n    Rp1 = Rp[:, 1] / np.linalg.norm(Rp[:, 1])\n    Lp0 = Lp[:, 0] / np.linalg.norm(Lp[:, 0])\n    Lp1 = Lp[:, 1] / np.linalg.norm(Lp[:, 1])\n    \n    # Compute perturbed transition strength S'\n    S_prime = abs(Lp1.T @ O_op @ Rp0)**2\n    \n    # ---- 3. Final Calculation ----\n    \n    # Compute relative change r\n    r = abs(S_prime - S) / max(S, 1e-16)\n    \n    return [max_K, r]\n\ndef solve():\n    \"\"\"\n    Main solver function to run test cases and print results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (0.5, 1e-6),        # Case 1\n        (1e-12, 1e-6),      # Case 2\n        (1.0, 1e-6),        # Case 3\n    ]\n\n    results = []\n    for delta, epsilon in test_cases:\n        result = calculate_pair(delta, epsilon)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # The default string representation of a list of lists in Python is\n    # a \"Python-style list of lists\".\n    # e.g., [[k1, r1], [k2, r2], [k3, r3]]\n    # Using `str()` and replacing spaces ensures a compact output.\n    output_str = str(results).replace(\" \", \"\")\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}