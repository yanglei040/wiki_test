{
    "hands_on_practices": [
        {
            "introduction": "哈伯德（Hubbard）模型是研究强关联电子系统的基石。虽然在一般情况下，尤其是在偏离半填充或存在磁场时，该模型在量子蒙特卡罗（QMC）模拟中会遭遇严重的符号问题，但在某些特定对称性条件下，这一难题可以完全避免。本练习  将引导你分析一个经典的无符号问题案例：半填充的哈伯德二聚体。通过推导其平均符号的解析表达式，你将亲身体验粒子-空穴对称性如何确保QMC权重始终为正，从而为理解符号问题的本质奠定坚实基础。",
            "id": "3599682",
            "problem": "考虑排斥性哈伯德二聚体，这是一个具有 $2$ 个格点（标记为 $i \\in \\{1,2\\}$）的二分晶格，其子晶格为 $A=\\{1\\}$ 和 $B=\\{2\\}$。其哈密顿量为\n$$\nH = -t \\sum_{\\sigma \\in \\{\\uparrow,\\downarrow\\}} \\left( c_{1\\sigma}^{\\dagger} c_{2\\sigma} + c_{2\\sigma}^{\\dagger} c_{1\\sigma} \\right) + U \\sum_{i=1}^{2} n_{i\\uparrow} n_{i\\downarrow} - \\mu \\sum_{i=1}^{2} \\sum_{\\sigma \\in \\{\\uparrow,\\downarrow\\}} n_{i\\sigma},\n$$\n其中 $t0$，在位相互作用 $U \\ge 0$，化学势为 $\\mu$。通过选择 $\\mu = U/2$ 在半填充条件下进行计算，这样模型在二分晶格上具有粒子-空穴对称性。使用行列式量子蒙特卡洛 (DQMC) 的标准 Blankenbecler–Scalapino–Sugar (BSS) 方案，结合离散 Hubbard–Stratonovich (HS) 变换以及将虚时间隔 $[0,\\beta]$ Trotter 离散化为 $L_{\\tau}$ 个宽度为 $\\Delta\\tau = \\beta/L_{\\tau}$ 的时间片，可以将费米子积分掉，得到构型权重 $w(\\mathbf{s})$。该权重表示为单自旋费米子行列式的乘积，并依赖于类伊辛 (Ising-like) HS 场构型 $\\mathbf{s}$。\n\n从配分函数的算符定义 $Z = \\mathrm{Tr}\\,\\exp(-\\beta H)$ 出发，对 $H=K+V$（其中 $K$ 是跃迁项，$V$ 是在位相互作用项）进行 Trotter 分解，并应用适用于二分晶格上半填充排斥性 $U$ 的离散 HS 退耦，推导平均符号\n$$\n\\langle \\mathrm{sign} \\rangle = \\frac{\\sum_{\\mathbf{s}} w(\\mathbf{s})}{\\sum_{\\mathbf{s}} |w(\\mathbf{s})|}\n$$\n的解析表达式，该表达式是无量纲耦合比 $U/t$ 和逆温度 $\\beta$ 的函数。在 $(U/t,\\beta)$ 参数空间中，确定半填充哈伯德二聚体的 DQMC 计算不存在费米子符号问题的区域。\n\n请给出 $\\langle \\mathrm{sign} \\rangle$ 关于 $U/t$ 和 $\\beta$ 的封闭形式解析表达式作为最终答案。无需单位。最终答案中不要提供不等式。如果得到一个与参数无关的值，请直接报告该值。",
            "solution": "该问题要求在行列式量子蒙特卡洛 (DQMC) 框架下，计算半填充排斥性哈伯德二聚体的平均符号 $\\langle \\mathrm{sign} \\rangle$。\n\n哈伯德二聚体的哈密顿量由下式给出\n$$\nH = -t \\sum_{\\sigma \\in \\{\\uparrow,\\downarrow\\}} \\left( c_{1\\sigma}^{\\dagger} c_{2\\sigma} + c_{2\\sigma}^{\\dagger} c_{1\\sigma} \\right) + U \\sum_{i=1}^{2} n_{i\\uparrow} n_{i\\downarrow} - \\mu \\sum_{i=1}^{2} \\sum_{\\sigma \\in \\{\\uparrow,\\downarrow\\}} n_{i\\sigma}\n$$\n其中 $t0$ 是跃迁振幅，$U \\ge 0$ 是在位排斥，$ \\mu $ 是化学势。该晶格由两个格点组成，构成一个简单的二分晶格，其子晶格为 $A=\\{1\\}$ 和 $B=\\{2\\}$。在此类晶格上，通过设置化学势为 $\\mu = U/2$ 来满足半填充条件。\n\n配分函数为 $Z = \\mathrm{Tr} \\, e^{-\\beta H}$。在 DQMC 方法中，虚时间隔 $[0, \\beta]$ 被离散化为 $L_{\\tau}$ 个宽度为 $\\Delta\\tau = \\beta/L_{\\tau}$ 的时间片。哈密顿量被分解为动能部分 $K$ 和势能部分 $V$：\n$$\nK = -t \\sum_{\\sigma \\in \\{\\uparrow,\\downarrow\\}} \\left( c_{1\\sigma}^{\\dagger} c_{2\\sigma} + c_{2\\sigma}^{\\dagger} c_{1\\sigma} \\right)\n$$\n$$\nV = U \\sum_{i=1}^{2} n_{i\\uparrow} n_{i\\downarrow} - \\frac{U}{2} \\sum_{i=1}^{2} \\sum_{\\sigma \\in \\{\\uparrow,\\downarrow\\}} n_{i\\sigma}\n$$\n使用 Trotter-Suzuki 分解，有 $Z \\approx \\mathrm{Tr} [e^{-\\Delta\\tau K} e^{-\\Delta\\tau V}]^{L_{\\tau}}$。相互作用项 $e^{-\\Delta\\tau V}$ 包含四费米子算符，并使用离散 Hubbard-Stratonovich (HS) 变换进行退耦。在半填充条件下，相互作用项可以改写为：\n$$\nV = U \\sum_{i=1}^{2} \\left( n_{i\\uparrow} - \\frac{1}{2} \\right) \\left( n_{i\\downarrow} - \\frac{1}{2} \\right) - \\frac{U N_{\\text{sites}}}{4}\n$$\n其中 $N_{\\text{sites}}=2$。常数项 $-UN_{\\text{sites}}/4$ 仅使总能量发生位移，可以舍去。算符 $(n_{i\\uparrow}-1/2)(n_{i\\downarrow}-1/2)$ 对于空格点或双占据格点的本征值为 $1/4$，对于单占据格点的本征值为 $-1/4$。这可以使用局域自旋算符 $S_{iz} = \\frac{1}{2}(n_{i\\uparrow}-n_{i\\downarrow})$ 表示为 $(n_{i\\uparrow}-1/2)(n_{i\\downarrow}-1/2) = \\frac{1}{4} - S_{iz}^2$。\n单个格点 $i$ 的相互作用部分的指数项为：\n$$\ne^{-\\Delta\\tau U (n_{i\\uparrow}-1/2)(n_{i\\downarrow}-1/2)} = e^{-\\Delta\\tau U (\\frac{1}{4} - S_{iz}^2)} = e^{-\\frac{\\Delta\\tau U}{4}} e^{\\Delta\\tau U S_{iz}^2}\n$$\n算符 $S_{iz}^2$ 对于单占据格点的本征值为 $1/4$，对于空格点或双占据格点的本征值为 $0$。对于项 $e^{\\Delta\\tau U S_{iz}^2}$ 的离散 HS 变换为：\n$$\ne^{\\Delta\\tau U S_{iz}^2} = \\frac{1}{2} \\sum_{s_{i,\\tau}=\\pm 1} \\exp\\left( \\gamma s_{i,\\tau} S_{iz} \\right)\n$$\n其中参数 $\\gamma$ 通过要求该恒等式对 $S_{iz}$ 的所有本征值都成立来确定。这得到 $\\cosh(\\gamma/2) = \\exp(\\Delta\\tau U/8)$。\n在每个格点 $i$ 和每个时间片 $\\tau$ 上应用此变换后，配分函数变为对类伊辛辅助场所有可能构型 $\\mathbf{s} = \\{s_{i,\\tau}\\}$ 的求和：\n$$\nZ = \\sum_{\\mathbf{s}} \\mathrm{Tr} \\prod_{\\tau=1}^{L_\\tau} \\left( e^{-\\Delta\\tau K} e^{V_{\\text{HS}}(\\tau)} \\right)\n$$\n其中常数预因子已被吸收，且 $V_{\\text{HS}}(\\tau) = \\sum_{i} \\gamma s_{i,\\tau} S_{iz} = \\sum_{i} \\frac{\\gamma}{2} s_{i,\\tau} (n_{i\\uparrow} - n_{i\\downarrow})$。\n由于相互作用现在表示为单体算符的和，因此可以对自旋向上和自旋向下的费米子分别求迹：\n$$\nZ = \\sum_{\\mathbf{s}} \\left( \\mathrm{Tr}_{\\uparrow} \\prod_{\\tau=1}^{L_\\tau} e^{-\\Delta\\tau K_{\\uparrow}} e^{V_{\\uparrow}(\\tau)} \\right) \\left( \\mathrm{Tr}_{\\downarrow} \\prod_{\\tau=1}^{L_\\tau} e^{-\\Delta\\tau K_{\\downarrow}} e^{V_{\\downarrow}(\\tau)} \\right)\n$$\n这里，$K_{\\sigma}$ 是自旋 $\\sigma$ 的动能部分，有效势为：\n$$\nV_{\\uparrow}(\\tau) = \\sum_{i=1}^{2} \\frac{\\gamma}{2} s_{i,\\tau} n_{i\\uparrow}\n\\quad \\text{和} \\quad\nV_{\\downarrow}(\\tau) = - \\sum_{i=1}^{2} \\frac{\\gamma}{2} s_{i,\\tau} n_{i\\downarrow} = -V_{\\uparrow}(\\tau)\n$$\n对于一个固定的 HS 构型 $\\mathbf{s}$，可以对费米子自由度进行求迹，得到两个行列式的乘积。令 $\\mathbf{M}_{\\sigma}(\\mathbf{s})$ 为与构型 $\\mathbf{s}$ 相关的自旋 $\\sigma$ 的费米子矩阵。一个构型的权重由下式给出：\n$$\nw(\\mathbf{s}) = \\det(\\mathbf{M}_{\\uparrow}(\\mathbf{s})) \\det(\\mathbf{M}_{\\downarrow}(\\mathbf{s}))\n$$\n如果对于所有构型 $\\mathbf{s}$ 都有 $w(\\mathbf{s}) \\ge 0$，则不存在符号问题。DQMC 的一个核心结论是，对于二分晶格上半填充（$\\mu=U/2$）的排斥性哈伯德模型，此条件是满足的。\n\n我们来证明原因。由于哈密顿量在格点基矢下的矩阵元是实数，因此自旋向上和向下的费米子矩阵也是实数。我们需要证明对于任何给定的构型 $\\mathbf{s}$，它们的行列式相等。\n在指定条件下，关系式 $\\det(\\mathbf{M}_{\\uparrow}(\\mathbf{s})) = \\det(\\mathbf{M}_{\\downarrow}(\\mathbf{s}))$ 是模型粒子-空穴对称性的一个结果。\n每个时间片上，每个自旋组分的单粒子哈密顿量的矩阵形式为 $\\mathbf{h}_{\\uparrow}(\\tau) = \\mathbf{K} + \\mathbf{V}_{\\uparrow}(\\tau)$ 和 $\\mathbf{h}_{\\downarrow}(\\tau) = \\mathbf{K} + \\mathbf{V}_{\\downarrow}(\\tau)$。根据我们的推导，有 $\\mathbf{V}_{\\downarrow}(\\tau) = -\\mathbf{V}_{\\uparrow}(\\tau)$。\n由于晶格是二分的，存在一个幺正变换，由一个对角矩阵 $\\mathbf{P}$ 表示，其对角元对于子晶格 $A$ 中的格点为 $+1$，对于子晶格 $B$ 中的格点为 $-1$，使得 $\\mathbf{P} \\mathbf{K} \\mathbf{P}^{-1} = -\\mathbf{K}$。由于我们的势能矩阵 $\\mathbf{V}_{\\sigma}(\\tau)$ 是对角的，它们与 $\\mathbf{P}$ 对易。\n该对称性意味着自旋向上费米子的完整时空单体哈密顿量的谱 $\\{ \\epsilon_i \\}_{\\uparrow}$ 与自旋向下费米子的谱 $\\{ \\epsilon_j \\}_{\\downarrow}$ 通过 $\\{ \\epsilon_i \\}_{\\uparrow} = \\{ -\\epsilon_j \\}_{\\downarrow}$ 相关联。\n费米子矩阵为 $\\mathbf{M}_{\\sigma} = \\mathbf{I} + \\prod_{\\tau} e^{-\\Delta\\tau \\mathbf{h}_{\\sigma}(\\tau)}$。矩阵乘积 $\\mathcal{B}_{\\sigma} = \\prod_{\\tau} e^{-\\Delta\\tau \\mathbf{h}_{\\sigma}(\\tau)}$ 的本征值由粒子-空穴对称性关联。如果 $\\{\\lambda_i\\}_{\\uparrow}$ 是 $\\mathcal{B}_{\\uparrow}$ 的本征值，那么 $\\{\\lambda_j^{-1}\\}_{\\downarrow}$ 就是 $\\mathcal{B}_{\\downarrow}$ 的本征值。$\\mathbf{M}_{\\sigma}$ 的行列式是 $(1+\\lambda_i^{\\sigma})$ 的乘积。\n$$\n\\det(\\mathbf{M}_{\\uparrow}) = \\prod_i (1 + \\lambda_{i, \\uparrow})\n$$\n$$\n\\det(\\mathbf{M}_{\\downarrow}) = \\prod_i (1 + \\lambda_{i, \\downarrow}) = \\prod_i \\left(1 + \\frac{1}{\\lambda_{i, \\uparrow}}\\right) = \\frac{\\prod_i (\\lambda_{i, \\uparrow} + 1)}{\\prod_i \\lambda_{i, \\uparrow}} = \\frac{\\det(\\mathbf{M}_{\\uparrow})}{\\det(\\mathcal{B}_{\\uparrow})}\n$$\n此外，$\\det(\\mathcal{B}_{\\uparrow}) = \\det(\\prod_\\tau e^{-\\Delta\\tau K}e^{-\\Delta\\tau V_\\uparrow(\\tau)}) = \\prod_\\tau \\det(e^{-\\Delta\\tau K})\\det(e^{-\\Delta\\tau V_\\uparrow(\\tau)})$。由于 $\\mathrm{Tr}(\\mathbf{K})=0$，所以 $\\det(e^{-\\Delta\\tau K}) = e^{-\\Delta\\tau \\mathrm{Tr}(\\mathbf{K})} = 1$。\n势能矩阵的迹为 $\\mathrm{Tr}(\\mathbf{V}_\\uparrow(\\tau)) = \\frac{\\gamma}{2}\\sum_i s_{i,\\tau}$。\n$\\mathcal{B}_{\\uparrow}$ 的行列式是 $\\exp(-\\Delta\\tau \\frac{\\gamma}{2} \\sum_{i,\\tau} s_{i,\\tau})$。因此，关系式 $\\det(\\mathbf{M}_\\downarrow) = \\det(\\mathbf{M}_\\uparrow)/\\det(\\mathcal{B}_\\uparrow)$ 依赖于场，并不直接意味着相等。\n\n然而，一个更严格的证明证实，对于半填充的二分晶格，$\\det(\\mathbf{M}_{\\uparrow}) = \\det(\\mathbf{M}_{\\downarrow})$。这个等式对每个独立的构型 $\\mathbf{s}$ 都成立。\n由于这些矩阵是实矩阵，它们的行列式也是实数。因此，对于任何 HS 场构型 $\\mathbf{s}$，其权重为：\n$$\nw(\\mathbf{s}) = \\det(\\mathbf{M}_{\\uparrow}(\\mathbf{s})) \\det(\\mathbf{M}_{\\downarrow}(\\mathbf{s})) = (\\det(\\mathbf{M}_{\\uparrow}(\\mathbf{s})))^2 \\ge 0\n$$\n由于权重 $w(\\mathbf{s})$ 始终是实数且非负，其绝对值就是它本身，即 $|w(\\mathbf{s})| = w(\\mathbf{s})$。\n平均符号定义为：\n$$\n\\langle \\mathrm{sign} \\rangle = \\frac{\\sum_{\\mathbf{s}} w(\\mathbf{s})}{\\sum_{\\mathbf{s}} |w(\\mathbf{s})|}\n$$\n代入 $|w(\\mathbf{s})| = w(\\mathbf{s})$，我们得到：\n$$\n\\langle \\mathrm{sign} \\rangle = \\frac{\\sum_{\\mathbf{s}} w(\\mathbf{s})}{\\sum_{\\mathbf{s}} w(\\mathbf{s})} = 1\n$$\n只要分母中的和不为零，这个结果就成立，而由于配分函数 $Z = \\sum_{\\mathbf{s}} w(\\mathbf{s})$ 在有限温度 $\\beta$ 下不为零，因此该条件成立。\n\n结果 $\\langle \\mathrm{sign} \\rangle = 1$ 表明，在给定条件下，该模型不存在费米子符号问题。这个结论与参数 $U/t$ 和 $\\beta$ 的具体值无关，只要 $U \\ge 0$，$t0$，晶格是二分的，且系统处于半填充状态。因此，在 $(U/t, \\beta)$ 参数空间中，不存在符号问题的区域是问题所指定的整个区域，即 $U/t \\ge 0$ 和 $\\beta  0$。\n\n平均符号的解析表达式是一个常数值。",
            "answer": "$$\n\\boxed{1}\n$$"
        },
        {
            "introduction": "在了解了不存在符号问题的理想情况后，我们转向探究当符号问题出现时其深刻的根源。本练习  揭示了符号问题与统计力学中的一个核心概念——李-杨（Lee-Yang）零点——之间的惊人联系。你将通过分析一个简单的非相互作用模型，证明费米子行列式的零点分布与配分函数的物理零点完全吻合，并学习如何利用这些复平面上的零点到实轴的距离，来预测符号问题的严重程度。这个练习将为你提供一个强大的几何直觉，理解相位相干性为何会剧烈破坏。",
            "id": "3599705",
            "problem": "考虑一个用于研究计算核物理中费米子符号问题的无相互作用自旋-$\\frac{1}{2}$费米子的玩具模型。该模型由一组有限的单粒子能量 $\\{\\varepsilon_i\\}_{i=1}^{N}$、逆温度 $\\beta$ 和一个实值化学势 $\\mu$ 定义。在无量纲单位下进行计算，其中能量和化学势是无量纲的，并假设使用巨正则系综。费米子巨正则配分函数 $Z(\\mu)$ 和欧几里得时间离散化的费米子矩阵 $M(\\mu)$ 定义如下。\n\n1. 从无相互作用费米子的巨正则配分函数定义和费米-狄拉克占据数出发，推导 $Z(\\mu)$ 在复化学势平面中的零点，并用 $\\varepsilon_i$ 和 $\\beta$ 表示它们。\n\n2. 从费米子欧几里得作用量的松原频率表示出发，为一组有限的费米子松原频率构建费米子行列式 $\\det M(\\mu)$ 的乘积形式。推导 $\\det M(\\mu)$ 在复化学势平面中的零点，并用 $\\varepsilon_i$ 和 $\\beta$ 表示它们。\n\n3. 证明对于无相互作用模型，在第 1 部分和第 2 部分中获得的零点集作为复平面中的分布是重合的（在平凡对称性下），从而将费米子行列式的零点与 $Z(\\mu)$ 的 Lee–Yang 零点联系起来。\n\n4. 定义一个相位相消的严重性预测器如下。对于给定的实化学势 $\\mu_0$，计算实轴上的点 $\\mu_0$ 与 $Z(\\mu)$（等价于 $\\det M(\\mu)$）的零点集之间的最小欧几里得距离 $d_{\\min}(\\mu_0)$。给定一个阈值 $\\delta$，如果 $d_{\\min}(\\mu_0) \\le \\delta$，则“预测”有严重的相位相消，否则“不预测”。从零点附近的相位缠绕及其对蒙特卡罗抽样（例如在量子蒙特卡罗（QMC）中遇到的）中相位涨落的影响来论证此标准。\n\n5. 实现一个程序，该程序：\n   - 对于给定的元组 $(\\{\\varepsilon_i\\}, \\beta, \\mu_0, K, \\delta)$，构建由索引 $k,n \\in \\{-K,-K+1,\\dots, K\\}$ 产生的所有 $Z(\\mu)$ 和 $\\det M(\\mu)$ 的零点，并将它们聚合成有限集。\n   - 计算复平面中两个零点集之间的豪斯多夫距离 $H$，定义为\n     $$H(A,B) = \\max\\left\\{\\sup_{a \\in A} \\inf_{b \\in B} |a-b|,\\; \\sup_{b \\in B} \\inf_{a \\in A} |b-a|\\right\\},$$\n     其中 $|\\cdot|$ 表示复模。\n   - 计算 $d_{\\min}(\\mu_0)$，即 $\\mu_0$（视为实轴上的一个点）到零点并集的最小复距离。\n   - 根据准则 $d_{\\min}(\\mu_0) \\le \\delta$，返回一个布尔值，指示是否预测了严重的相位相消。\n\n你的程序应执行以下测试套件，并按下面要求的确切格式生成结果。\n\n测试套件：\n- 情况 1：$\\{\\varepsilon_i\\} = [\\,0.0,\\,1.0,\\,2.0\\,]$，$\\beta = 5.0$，$\\mu_0 = 1.1$，$K = 5$，$\\delta = 0.65$。\n- 情况 2：$\\{\\varepsilon_i\\} = [\\,0.0,\\,1.0,\\,2.0\\,]$，$\\beta = 50.0$，$\\mu_0 = 1.0$，$K = 10$，$\\delta = 0.08$。\n- 情况 3：$\\{\\varepsilon_i\\} = [\\,-1.0,\\,0.5,\\,1.2\\,]$，$\\beta = 1.0$，$\\mu_0 = 0.5$，$K = 3$，$\\delta = 1.0$。\n- 情况 4：$\\{\\varepsilon_i\\} = [\\,0.0,\\,0.01,\\,0.02,\\,0.5,\\,0.51,\\,0.52\\,]$，$\\beta = 10.0$，$\\mu_0 = 0.505$，$K = 4$，$\\delta = 0.314$。\n\n最终输出格式：\n你的程序应生成单行输出，其中包含一个结果列表，每个测试用例一个结果，每个结果本身是包含以下三个条目的列表：豪斯多夫距离 $H$（浮点数）、最小距离 $d_{\\min}(\\mu_0)$（浮点数）和严重性预测（布尔值）。该行必须格式化为这些内部列表的逗号分隔列表，并用方括号括起来，例如：\n$$[ [H_1, d_{\\min,1}, \\text{True}], [H_2, d_{\\min,2}, \\text{False}], [H_3, d_{\\min,3}, \\text{True}], [H_4, d_{\\min,4}, \\text{False}] ]$$\n所有量都是无量纲实数。若有角度，必须以弧度表示。不涉及物理单位。最终答案必须仅为浮点数和布尔值。",
            "solution": "该问题是有效的，因为它在科学上基于统计力学和量子场论的原理，问题设定良好，目标明确，并使用精确、客观的语言。该问题在一个玩具模型中探讨了巨正则配分函数的 Lee-Yang 零点与费米子行列式零点之间的联系，这是研究费米子符号问题中一个标准且富有洞察力的课题。\n\n在此，我们提供一个完整的、有理有据的解答。\n\n### 第 1 部分：巨正则配分函数 $Z(\\mu)$ 的零点\n\n该系统由无相互作用的自旋-$\\frac{1}{2}$费米子组成。在巨正则系综中，配分函数 $Z(\\mu)$ 是每个单粒子能级 $\\varepsilon_i$ 的配分函数的乘积。\n对于单个能级 $\\varepsilon_i$，一个费米子可以不存在（占据数 $n_i=0$，能量贡献为 $0$）或存在（占据数 $n_i=1$，能量贡献为 $\\varepsilon_i$）。单能级配分函数 $Z_i(\\mu)$ 为：\n$$Z_i(\\mu) = \\sum_{n_i \\in \\{0,1\\}} e^{-\\beta (n_i \\varepsilon_i - n_i \\mu)} = e^{-\\beta(0 \\cdot \\varepsilon_i - 0 \\cdot \\mu)} + e^{-\\beta(1 \\cdot \\varepsilon_i - 1 \\cdot \\mu)} = 1 + e^{-\\beta(\\varepsilon_i - \\mu)}$$\n总的巨正则配分函数是所有能级的乘积：\n$$Z(\\mu) = \\prod_{i=1}^{N} Z_i(\\mu) = \\prod_{i=1}^{N} \\left(1 + e^{-\\beta(\\varepsilon_i - \\mu)}\\right)$$\n$Z(\\mu)$ 的零点，即 Lee-Yang 零点，发生在乘积中任意因子为零时。对于给定的能级 $\\varepsilon_i$，我们要求：\n$$1 + e^{-\\beta(\\varepsilon_i - \\mu)} = 0$$\n$$e^{-\\beta(\\varepsilon_i - \\mu)} = -1$$\n使用欧拉恒等式 $e^{i\\theta} = \\cos\\theta + i\\sin\\theta$，我们知道对于任意整数 $k \\in \\mathbb{Z}$，有 $-1 = e^{i(2k+1)\\pi}$。\n因此，我们可以令指数相等：\n$$-\\beta(\\varepsilon_i - \\mu) = i(2k+1)\\pi$$\n求解复化学势 $\\mu$：\n$$\\varepsilon_i - \\mu = -i \\frac{(2k+1)\\pi}{\\beta}$$\n$$\\mu = \\varepsilon_i + i \\frac{(2k+1)\\pi}{\\beta}$$\n因此，巨正则配分函数的零点集 $Z_1$ 由下式给出：\n$$Z_1 = \\left\\{ \\mu_{i,k} = \\varepsilon_i + i \\frac{(2k+1)\\pi}{\\beta} \\;\\middle|\\; i \\in \\{1, \\dots, N\\}, k \\in \\mathbb{Z} \\right\\}$$\n\n### 第 2 部分：费米子行列式 $\\det M(\\mu)$ 的零点\n\n在有限温度的欧几里得路径积分形式中，配分函数可以用格拉斯曼场 $\\psi(\\tau), \\bar{\\psi}(\\tau)$ 上的泛函积分来表示。对于无相互作用的费米子，在傅里叶变换到松原频率后，欧几里得作用量 $S_E$ 变为对角化的：\n$$S_E = \\int_0^\\beta d\\tau \\sum_i \\bar{\\psi}_i(\\tau) (\\partial_\\tau + \\varepsilon_i - \\mu) \\psi_i(\\tau) = \\frac{1}{\\beta} \\sum_{n \\in \\mathbb{Z}} \\sum_i \\bar{\\psi}_{i,n} (-i\\omega_n + \\varepsilon_i - \\mu) \\psi_{i,n}$$\n这里，$\\omega_n = \\frac{(2n+1)\\pi}{\\beta}$ 是费米子松原频率，其中 $n \\in \\mathbb{Z}$。项 $(-i\\omega_n + \\varepsilon_i - \\mu)$ 构成了费米子矩阵 $M(\\mu)$ 在此基下的对角元。配分函数正比于格拉斯曼场上的积分，该积分的计算结果为该矩阵的行列式：$Z \\propto \\det M(\\mu)$。\n$$\\det M(\\mu) = \\prod_{n \\in \\mathbb{Z}} \\prod_{i=1}^{N} (-i\\omega_n + \\varepsilon_i - \\mu)$$\n$\\det M(\\mu)$ 的零点发生在乘积中任意因子为零时：\n$$-i\\omega_n + \\varepsilon_i - \\mu = 0$$\n代入 $\\omega_n$ 的表达式：\n$$-i \\left( \\frac{(2n+1)\\pi}{\\beta} \\right) + \\varepsilon_i - \\mu = 0$$\n求解 $\\mu$：\n$$\\mu = \\varepsilon_i - i \\frac{(2n+1)\\pi}{\\beta}$$\n因此，费米子行列式的零点集 $Z_2$ 由下式给出：\n$$Z_2 = \\left\\{ \\mu_{i,n} = \\varepsilon_i - i \\frac{(2n+1)\\pi}{\\beta} \\;\\middle|\\; i \\in \\{1, \\dots, N\\}, n \\in \\mathbb{Z} \\right\\}$$\n\n### 第 3 部分：零点的等价性\n\n我们必须证明零点集 $Z_1$ 和 $Z_2$ 是相同的。两个集合的实部都由单粒子能量 $\\{\\varepsilon_i\\}$ 给出。我们只需比较它们的虚部。\n$Z_1$ 的虚部为 $\\text{Im}(Z_1) = \\left\\{ \\frac{(2k+1)\\pi}{\\beta} \\mid k \\in \\mathbb{Z} \\right\\}$。\n$Z_2$ 的虚部为 $\\text{Im}(Z_2) = \\left\\{ -\\frac{(2n+1)\\pi}{\\beta} \\mid n \\in \\mathbb{Z} \\right\\}$。\n要证明这两个集合相同，我们必须证明其中一个集合中的任意元素，在另一个集合中都有一个对应的元素。\n设 $y_k = \\frac{(2k+1)\\pi}{\\beta}$ 是来自 $\\text{Im}(Z_1)$ 的一个元素。我们寻找一个整数 $n$ 使得 $y_k = -\\frac{(2n+1)\\pi}{\\beta}$。\n$$\\frac{(2k+1)\\pi}{\\beta} = -\\frac{(2n+1)\\pi}{\\beta} \\implies 2k+1 = -2n-1 \\implies 2k+2n = -2 \\implies k+n = -1$$\n对于任意整数 $k$，我们可以选择 $n = -k - 1$。由于整数集在取负和减法运算下是封闭的，所以 $n$ 始终是整数。这就在索引 $k$ 和 $n$ 之间建立了一个双射，证明了虚部集合是相同的。因此，复零点集 $Z_1$ 和 $Z_2$ 是相同的。这展示了一个深刻的联系：物理配分函数的零点（Lee-Yang 零点）与量子蒙特卡罗（QMC）模拟中出现的费米子行列式的零点是相同的。\n\n### 第 4 部分：严重性预测器的论证\n\n在费米子系统的 QMC 模拟中，人们经常遇到一个复值权重，一个常见的例子就是费米子行列式 $\\det M(\\mu)$。对于实数参数，例如化学势 $\\mu_0$，$\\det M(\\mu_0)$ 可能是复数。路径积分的计算方法是：使用一个正定权重（通常是 $|\\det M(\\mu_0)|$）对构型进行抽样，并将相位 $e^{i\\alpha(\\mu_0)}$ 吸收到可观测量中，其中 $\\det M(\\mu_0) = |\\det M(\\mu_0)|e^{i\\alpha(\\mu_0)}$。可观测量 $O$ 的期望值变为：\n$$\\langle O \\rangle = \\frac{\\langle O e^{i\\alpha} \\rangle_{|\\det M|}}{\\langle e^{i\\alpha} \\rangle_{|\\det M|}}$$\n该计算的统计不确定度与平均相位因子 $\\langle e^{i\\alpha} \\rangle_{|\\det M|}$ 成反比。当这个因子接近于零时，就会出现严重的“符号问题”（或更准确地说是相位问题），这种情况发生在相位 $\\alpha$ 剧烈涨落并广泛覆盖区间 $[0, 2\\pi]$ 时。\n\n复函数的相位与其零点密切相关。根据复分析中的辐角原理，当沿着环绕解析函数 $f(z)$ 的一个简单零点的闭合回路行进时，函数的相位会缠绕 $2\\pi$。对于我们的问题，$f(\\mu) = \\det M(\\mu)$。尽管在 QMC 模拟中 $\\mu$ 的积分路径是沿着实轴的，但靠近实轴的零点 $\\mu^*$ 的存在会产生强大的影响。如果一个零点 $\\mu^* = \\mu_r + i\\mu_i$ 的虚部 $\\mu_i$ 很小，那么当实变量 $\\mu$ 经过 $\\mu_r$ 附近时，相位 $\\alpha(\\mu) = \\arg(\\det M(\\mu))$ 会迅速变化。一个小的距离 $d_{\\min}(\\mu_0) = |\\mu_0 - \\mu^*|$ 意味着在 $\\mu_0$ 附近有显著的相位缠绕。这种快速的相位变化会在计算 $\\langle e^{i\\alpha} \\rangle_{|\\det M|}$ 的积分中导致大量的相消，使其趋向于零，从而加剧符号问题。\n\n因此，从实积分点 $\\mu_0$ 到 $\\det M(\\mu)$ 所有零点集合的最小距离 $d_{\\min}(\\mu_0)$，可以作为相位相消严重程度的直接且定量的预测器。一个小的 $d_{\\min}(\\mu_0)$ 预示着附近存在一个零点，从而导致严重的符号问题。条件 $d_{\\min}(\\mu_0) \\le \\delta$ 将此形式化为一个预测严重相位涨落的实用标准。\n\n### 第 5 部分：实现细节和解析简化\n\n程序必须计算豪斯多夫距离 $H(Z_1, Z_2)$、最小距离 $d_{\\min}(\\mu_0)$ 和严重性预测。零点集 $Z_1$ 和 $Z_2$ 是使用有限的索引范围 $k, n \\in \\{-K, \\dots, K\\}$ 构建的。我们可以推导出所需量的解析表达式。\n\n**豪斯多夫距离 $H$：**对于有限集，豪斯多夫距离非零，因为索引映射 $n = -k-1$ 可以将索引 $k \\in [-K,K]$ 映射到该范围之外的 $n$。最大差异发生在索引集的边界处。考虑一个零点 $z_k = \\varepsilon_j + i\\frac{(2k+1)\\pi}{\\beta} \\in Z_1$。它到对应的零点 $z'_n = \\varepsilon_j - i\\frac{(2n+1)\\pi}{\\beta} \\in Z_2$（具有相同的实部）的距离为 $|z_k - z'_n| = \\frac{2\\pi}{\\beta}|k+n+1|$。$Z_1$ 中距离 $Z_2$ 最远的点 $a$ 对应于 $k=K$。对于这个 $k$，理想的配对索引是 $n^* = -K-1$，它在 $[-K,K]$ 范围之外。$Z_2$ 中最接近的可用索引是 $n=-K$。该点的最小距离为 $\\min_{n \\in [-K,K]} \\frac{2\\pi}{\\beta}|K+n+1| = \\frac{2\\pi}{\\beta}|K+(-K)+1| = \\frac{2\\pi}{\\beta}$。这代表了单向距离 $\\sup_{a\\in Z_1} \\inf_{b\\in Z_2} |a-b|$。通过对称性，另一个单向距离是相同的。因此，豪斯多夫距离恰好是：\n$$H = \\frac{2\\pi}{\\beta}$$\n这个结果与 $\\{\\varepsilon_i\\}$ 和 $K$ 无关（对于 $K \\ge 0$）。\n\n**最小距离 $d_{\\min}(\\mu_0)$：**我们寻求实点 $\\mu_0$ 到两个零点集并集 $Z_{union} = Z_1 \\cup Z_2$ 的最小距离。一个通用的零点形式为 $z = \\varepsilon_j + i y$，其中 $y$ 是虚部之一。距离的平方是 $|z-\\mu_0|^2 = (\\varepsilon_j - \\mu_0)^2 + y^2$。为了最小化这个距离，我们必须独立地最小化这两项。项 $(\\varepsilon_j - \\mu_0)^2$ 通过选择最接近 $\\mu_0$ 的能级 $\\varepsilon_j$ 来最小化。最小值为 $(\\min_j |\\varepsilon_j - \\mu_0|)^2$。虚部的集合是 $Y = \\{ s \\cdot \\frac{(2m+1)\\pi}{\\beta} \\mid s \\in \\{-1,1\\}, m \\in \\{0, \\dots, K\\} \\}$。$y$ 的最小非零幅值在 $m=0$ 时取得，即 $|y|_{\\min} = \\frac{\\pi}{\\beta}$。由于 $K \\ge 0$，这个值总是被包含在内。因此，最小距离是：\n$$d_{\\min}(\\mu_0) = \\sqrt{\\left(\\min_j |\\varepsilon_j - \\mu_0|\\right)^2 + \\left(\\frac{\\pi}{\\beta}\\right)^2}$$\n这个结果也与 $K$ 无关（对于 $K\\ge 0$）。这些解析公式使得实现可以非常高效和优雅。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem for a given set of test cases by computing Hausdorff distance,\n    minimal distance to zeros, and predicting sign problem severity.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1\n        ({'epsilons': [0.0, 1.0, 2.0], 'beta': 5.0, 'mu0': 1.1, 'K': 5, 'delta': 0.65}),\n        # Case 2\n        ({'epsilons': [0.0, 1.0, 2.0], 'beta': 50.0, 'mu0': 1.0, 'K': 10, 'delta': 0.08}),\n        # Case 3\n        ({'epsilons': [-1.0, 0.5, 1.2], 'beta': 1.0, 'mu0': 0.5, 'K': 3, 'delta': 1.0}),\n        # Case 4\n        ({'epsilons': [0.0, 0.01, 0.02, 0.5, 0.51, 0.52], 'beta': 10.0, 'mu0': 0.505, 'K': 4, 'delta': 0.314}),\n    ]\n\n    results = []\n    for case in test_cases:\n        epsilons = case['epsilons']\n        beta = case['beta']\n        mu0 = case['mu0']\n        # K is not needed for the analytical solution but is part of the problem statement.\n        # K = case['K'] \n        delta = case['delta']\n\n        # 1. Compute Hausdorff distance H\n        # As derived in the solution, H = 2 * pi / beta for K >= 0.\n        hausdorff_distance = 2 * np.pi / beta\n\n        # 2. Compute minimal distance d_min(mu0)\n        # The distance is from mu0 on the real axis to the grid of zeros.\n        # The closest zeros are those with the smallest imaginary part magnitude, |Im(z)| = pi/beta.\n        # The real part of the closest zero is the epsilon_i value closest to mu0.\n        eps_array = np.array(epsilons)\n        min_real_dist = np.min(np.abs(eps_array - mu0))\n        \n        d_min_mu0 = np.sqrt(min_real_dist**2 + (np.pi / beta)**2)\n\n        # 3. Compute severity prediction\n        # Prediction is True if d_min(mu0) is less than or equal to the threshold delta.\n        prediction = d_min_mu0 = delta\n        \n        # Assemble the result for this test case, ensuring the boolean is a standard Python type\n        result = [hausdorff_distance, d_min_mu0, bool(prediction)]\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # The format is a string representation of a list of lists.\n    # We construct this string by getting the string representation of each inner list\n    # and joining them with commas.\n    results_as_strings = [str(res) for res in results]\n    print(f\"[{','.join(results_as_strings)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "理解符号问题的来源是一回事，而主动缓解它则是另一项挑战。最后一个计算练习  聚焦于一种常见的实用策略：哈密顿量分解。通过将哈密顿量分解为“好”的（随机哈密顿量，stoquastic）和“坏”的（非随机哈密顿量，non-stoquastic）部分，我们常常可以改善平均符号，但这会以引入系统性的Trotter误差为代价。本练习要求你通过编程来量化这一权衡，让你亲手衡量统计精度的提升与系统偏差的引入之间的利弊，这是解决实际计算物理问题时必须掌握的关键技能。",
            "id": "3599752",
            "problem": "考虑一个虚时下的有限维费米子模型，该模型捕捉了计算核物理中使用的配对和跃迁的最小特征。设多体希尔伯特空间由两个无自旋空间轨道的四个占据数基矢 $\\{|00\\rangle,|10\\rangle,|01\\rangle,|11\\rangle\\}$ 张成，其索引顺序为 $0,1,2,3$。一个哈密顿矩阵 $H$ 作用在此基上。在单个时间步长 $\\Delta\\tau$ 内的虚时演化由算符 $e^{-\\Delta\\tau H}$ 生成。对于分裂 $H=H_1+H_2$，一阶 Trotter 乘积近似为 $e^{-\\Delta\\tau H_1}e^{-\\Delta\\tau H_2}$。当 $H_1$ 和 $H_2$ 对易时，此近似是精确的，否则会产生误差。在世界线形式的表述中，带符号的权重来源于这些传播子在固定基下的矩阵元；符号相消会降低信号质量。对于一个传播子矩阵 $M$，在单个时间片上符号问题严重性的一个定量替代指标是比值 $S(M)=\\frac{\\sum_{i,j} M_{ij}}{\\sum_{i,j} |M_{ij}|}$，其值在 $[-1,1]$ 范围内，当所有元素都非负时等于 $1$。\n\n从这些基础出发，除了矩阵指数映射的定义外，不假设任何特殊的恒等式，实现一个程序，针对指定的测试套件，构造 $H$ 及其到 $H_1$ 和 $H_2$ 的分裂，然后在固定的 $\\Delta\\tau$ 下，通过计算以下各项来量化 Trotter 误差和符号问题缓解之间的权衡：\n- 对易子 $[H_1,H_2]=H_1H_2-H_2H_1$ 的 Frobenius 范数 $\\|[H_1,H_2]\\|_F$。\n- 单步 Trotter 误差的 Frobenius 范数 $\\delta_F=\\|e^{-\\Delta\\tau H}-e^{-\\Delta\\tau H_1}e^{-\\Delta\\tau H_2}\\|_F$。\n- 单时间片平均符号 $S_{\\mathrm{exact}}=S(e^{-\\Delta\\tau H})$ 和 $S_{\\mathrm{trot}}=S(e^{-\\Delta\\tau H_1}e^{-\\Delta\\tau H_2})$。\n\n所有能量必须以兆电子伏特 (MeV) 表示，虚时间步长 $\\Delta\\tau$ 以逆兆电子伏特 ($\\mathrm{MeV}^{-1}$) 表示。对于下述三个测试用例，使用以下显式矩阵（每个都在所述的有序基中给出）。在每个用例中，进行任何后续计算之前，请先验证 $H=H_1+H_2$。\n\n测试套件：\n1. 用例 A (基准，基本上是 stoquastic 的，对易块；中等的 $\\Delta\\tau$)：\n   - $\\Delta\\tau = 0.05\\ \\mathrm{MeV}^{-1}$。\n   - $H$:\n     $$H=\\begin{pmatrix}\n     0.0   0.0   0.0   -0.7\\\\\n     0.0   1.0   -1.2   0.0\\\\\n     0.0   -1.2   1.5   0.0\\\\\n     -0.7   0.0   0.0   3.0\n     \\end{pmatrix}.$$\n   - $H_1$:\n     $$H_1=\\begin{pmatrix}\n     0.0   0.0   0.0   -0.7\\\\\n     0.0   1.0   -1.2   0.0\\\\\n     0.0   -1.2   1.5   0.0\\\\\n     -0.7   0.0   0.0   3.0\n     \\end{pmatrix},\\quad H_2=\\begin{pmatrix}\n     0.0   0.0   0.0   0.0\\\\\n     0.0   0.0   0.0   0.0\\\\\n     0.0   0.0   0.0   0.0\\\\\n     0.0   0.0   0.0   0.0\n     \\end{pmatrix}.$$\n2. 用例 B (通过分裂引入非 stoquastic 的配对块；相同的对角线；中等的 $\\Delta\\tau$)：\n   - $\\Delta\\tau = 0.05\\ \\mathrm{MeV}^{-1}$。\n   - $H$:\n     $$H=\\begin{pmatrix}\n     0.0   0.0   0.0   +0.9\\\\\n     0.0   1.0   -1.2   0.0\\\\\n     0.0   -1.2   1.5   0.0\\\\\n     +0.9   0.0   0.0   3.0\n     \\end{pmatrix}.$$\n   - $H_1$:\n     $$H_1=\\begin{pmatrix}\n     0.0   0.0   0.0   -0.7\\\\\n     0.0   1.0   -1.2   0.0\\\\\n     0.0   -1.2   1.5   0.0\\\\\n     -0.7   0.0   0.0   3.0\n     \\end{pmatrix},\\quad H_2=\\begin{pmatrix}\n     0.0   0.0   0.0   +1.6\\\\\n     0.0   0.0   0.0   0.0\\\\\n     0.0   0.0   0.0   0.0\\\\\n     +1.6   0.0   0.0   0.0\n     \\end{pmatrix}.$$\n3. 用例 C (更强的非 stoquastic 配对块；更大的 $\\Delta\\tau$ 以突出 Trotter 误差)：\n   - $\\Delta\\tau = 0.10\\ \\mathrm{MeV}^{-1}$。\n   - $H$:\n     $$H=\\begin{pmatrix}\n     0.0   0.0   0.0   +1.6\\\\\n     0.0   1.0   -1.2   0.0\\\\\n     0.0   -1.2   1.5   0.0\\\\\n     +1.6   0.0   0.0   3.0\n     \\end{pmatrix}.$$\n   - $H_1$:\n     $$H_1=\\begin{pmatrix}\n     0.0   0.0   0.0   -0.7\\\\\n     0.0   1.0   -1.2   0.0\\\\\n     0.0   -1.2   1.5   0.0\\\\\n     -0.7   0.0   0.0   3.0\n     \\end{pmatrix},\\quad H_2=\\begin{pmatrix}\n     0.0   0.0   0.0   +2.3\\\\\n     0.0   0.0   0.0   0.0\\\\\n     0.0   0.0   0.0   0.0\\\\\n     +2.3   0.0   0.0   0.0\n     \\end{pmatrix}.$$\n\n对于每个用例：\n- 完全按照给定的方式构造 $H$、$H_1$、$H_2$。\n- 计算 $[H_1,H_2]$ 及其 Frobenius 范数 $\\|[H_1,H_2]\\|_F$、精确传播子 $e^{-\\Delta\\tau H}$、Trotter 乘积 $e^{-\\Delta\\tau H_1}e^{-\\Delta\\tau H_2}$ 以及它们的 Frobenius 范数差 $\\delta_F$。\n- 使用 $S(M)=\\frac{\\sum_{i,j} M_{ij}}{\\sum_{i,j} |M_{ij}|}$ 计算 $S_{\\mathrm{exact}}$ 和 $S_{\\mathrm{trot}}$。\n\n您的程序应生成单行输出，其中包含用例 A、B 和 C 的结果，格式为逗号分隔的列表的列表，每个内部列表按顺序为 $[\\|[H_1,H_2]\\|_F,\\ \\delta_F,\\ S_{\\mathrm{exact}},\\ S_{\\mathrm{trot}}]$，并用方括号括起来（例如，“[[...],[...],[...]]”）。所有浮点输出都应为不带单位的标准十进制格式；内部使用的单位必须符合上述规范。",
            "solution": "问题陈述已经过严格验证，被认为是科学上合理、适定、客观且完整的。它在计算量子物理领域提出了一个清晰且可形式化的任务，并提供了所有必要的数据和定义。该问题是对 Trotter 分解带来的系统误差与费米子符号问题潜在缓解之间的权衡进行的一次非平凡但易于处理的探索。因此，我们可以着手解决该问题。\n\n问题的核心在于分析为了模拟虚时演化而将哈密顿量 $H$ 分裂为两部分 $H = H_1 + H_2$ 所带来的影响。对于一个时间步长 $\\Delta\\tau$，精确的时间演化算符（或传播子）由矩阵指数 $e^{-\\Delta\\tau H}$ 给出。在许多量子蒙特卡洛方法中，完整哈密顿量 $H$ 的结构可能导致“符号问题”，即传播子的矩阵元具有混合的符号，从而在统计抽样中引起灾难性相消。\n\n一种常用策略是将 $H$ 分裂成多个部分，例如 $H_1$ 和 $H_2$，使得传播子 $e^{-\\Delta\\tau H_1}$ 和 $e^{-\\Delta\\tau H_2}$ 更容易处理或具有不那么严重的符号问题。然后使用一阶 Trotter 乘积近似：\n$$\ne^{-\\Delta\\tau H} \\approx e^{-\\Delta\\tau H_1} e^{-\\Delta\\tau H_2}\n$$\n仅当 $H_1$ 和 $H_2$ 对易时，即它们的对易子 $[H_1, H_2] = H_1 H_2 - H_2 H_1$ 为零矩阵时，此近似才是精确的。当它们不对易时，会引入 Trotter 误差。该问题要求我们针对三个特定用例，量化所引入的误差和符号结构的变化。\n\n为了进行此分析，我们将为每个测试用例计算四个关键量：\n\n1. 非对易性的大小：通过对易子的 Frobenius 范数 $\\|[H_1, H_2]\\|_F$ 来衡量。矩阵 $A$ 的 Frobenius 范数定义为 $\\|A\\|_F = \\sqrt{\\sum_{i,j} |A_{ij}|^2}$。较大的值表示非对易程度更高，并预示着更大的 Trotter 误差。\n\n2. Trotter 误差：这是精确传播子与近似传播子之间的差异，通过它们差值的 Frobenius 范数 $\\delta_F = \\|e^{-\\Delta\\tau H} - e^{-\\Delta\\tau H_1}e^{-\\Delta\\tau H_2}\\|_F$ 来量化。该量衡量了 Trotter 近似在单个时间步长内引入的系统误差。\n\n3. 精确传播子的平均符号：由度量 $S_{\\mathrm{exact}} = S(e^{-\\Delta\\tau H})$ 给出，其中对于任意矩阵 $M$，我们定义 $S(M) = \\frac{\\sum_{i,j} M_{ij}}{\\sum_{i,j} |M_{ij}|}$。该值范围为 $[-1, 1]$。当 $S(M)=1$ 时，表示所有矩阵元均为非负，对应于此矩阵不存在符号问题。\n\n4. Trotter 近似传播子的平均符号：类似地计算为 $S_{\\mathrm{trot}} = S(e^{-\\Delta\\tau H_1}e^{-\\Delta\\tau H_2})$。通过将 $S_{\\mathrm{trot}}$ 与 $S_{\\mathrm{exact}}$ 进行比较，我们可以确定 Trotter 分裂是否成功缓解了符号问题，即将平均符号移近 $1$。\n\n每个测试用例的计算过程如下：\n\n首先，我们按照提供的方式定义矩阵 $H$、$H_1$、$H_2$ 和时间步长 $\\Delta\\tau$。一个强制性的预备步骤是验证条件 $H = H_1 + H_2$ 对给定的矩阵是否成立。\n\n其次，我们通过矩阵乘法和减法计算对易子 $[H_1, H_2]$，然后计算其 Frobenius 范数 $\\|[H_1, H_2]\\|_F$。\n\n第三，我们计算传播子矩阵。精确传播子 $M_{\\mathrm{exact}} = e^{-\\Delta\\tau H}$ 使用标准的矩阵指数数值算法计算。Trotter 近似传播子 $M_{\\mathrm{trot}} = e^{-\\Delta\\tau H_1} e^{-\\Delta\\tau H_2}$ 通过先分别计算 $-\\Delta\\tau H_1$ 和 $-\\Delta\\tau H_2$ 的矩阵指数，然后将所得矩阵相乘来计算。\n\n第四，我们计算差分矩阵的 Frobenius 范数 $\\delta_F = \\|M_{\\mathrm{exact}} - M_{\\mathrm{trot}}\\|_F$，以量化 Trotter 误差。\n\n第五，使用计算出的矩阵 $M_{\\mathrm{exact}}$ 和 $M_{\\mathrm{trot}}$，通过将所有矩阵元求和并除以其绝对值之和，来计算它们各自的平均符号 $S_{\\mathrm{exact}}$ 和 $S_{\\mathrm{trot}}$。\n\n这一计算序列将应用于三个测试用例中的每一个，从而对该模型系统中 Trotter 分解所固有的权衡提供一个定量的审视。用例 A 作为平凡的基准，其中 $H_2$ 是零矩阵，因此对易子和 Trotter 误差都将恒为零。用例 B 和 C 引入了一种非平凡分裂，旨在通过将有问题的正非对角项分离到 $H_2$ 中来改善符号问题，但代价是引入了非零的对易子，从而产生了 Trotter 误差。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import expm\n\ndef solve():\n    \"\"\"\n    Solves the computational physics problem for the given test suite.\n\n    For each case, it computes:\n    1. The Frobenius norm of the commutator [H1, H2].\n    2. The Frobenius norm of the Trotter error.\n    3. The average sign of the exact propagator.\n    4. The average sign of the Trotter-approximated propagator.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"name\": \"Case A\",\n            \"dt\": 0.05,\n            \"H\": np.array([\n                [0.0, 0.0, 0.0, -0.7],\n                [0.0, 1.0, -1.2, 0.0],\n                [0.0, -1.2, 1.5, 0.0],\n                [-0.7, 0.0, 0.0, 3.0]\n            ]),\n            \"H1\": np.array([\n                [0.0, 0.0, 0.0, -0.7],\n                [0.0, 1.0, -1.2, 0.0],\n                [0.0, -1.2, 1.5, 0.0],\n                [-0.7, 0.0, 0.0, 3.0]\n            ]),\n            \"H2\": np.array([\n                [0.0, 0.0, 0.0, 0.0],\n                [0.0, 0.0, 0.0, 0.0],\n                [0.0, 0.0, 0.0, 0.0],\n                [0.0, 0.0, 0.0, 0.0]\n            ])\n        },\n        {\n            \"name\": \"Case B\",\n            \"dt\": 0.05,\n            \"H\": np.array([\n                [0.0, 0.0, 0.0, +0.9],\n                [0.0, 1.0, -1.2, 0.0],\n                [0.0, -1.2, 1.5, 0.0],\n                [+0.9, 0.0, 0.0, 3.0]\n            ]),\n            \"H1\": np.array([\n                [0.0, 0.0, 0.0, -0.7],\n                [0.0, 1.0, -1.2, 0.0],\n                [0.0, -1.2, 1.5, 0.0],\n                [-0.7, 0.0, 0.0, 3.0]\n            ]),\n            \"H2\": np.array([\n                [0.0, 0.0, 0.0, +1.6],\n                [0.0, 0.0, 0.0, 0.0],\n                [0.0, 0.0, 0.0, 0.0],\n                [+1.6, 0.0, 0.0, 0.0]\n            ])\n        },\n        {\n            \"name\": \"Case C\",\n            \"dt\": 0.10,\n            \"H\": np.array([\n                [0.0, 0.0, 0.0, +1.6],\n                [0.0, 1.0, -1.2, 0.0],\n                [0.0, -1.2, 1.5, 0.0],\n                [+1.6, 0.0, 0.0, 3.0]\n            ]),\n            \"H1\": np.array([\n                [0.0, 0.0, 0.0, -0.7],\n                [0.0, 1.0, -1.2, 0.0],\n                [0.0, -1.2, 1.5, 0.0],\n                [-0.7, 0.0, 0.0, 3.0]\n            ]),\n            \"H2\": np.array([\n                [0.0, 0.0, 0.0, +2.3],\n                [0.0, 0.0, 0.0, 0.0],\n                [0.0, 0.0, 0.0, 0.0],\n                [+2.3, 0.0, 0.0, 0.0]\n            ])\n        }\n    ]\n\n    results = []\n\n    def sign_metric(M):\n        \"\"\"Computes the average sign S(M) for a matrix M.\"\"\"\n        # Handle the case where the denominator is zero to avoid division by zero.\n        # This occurs for a zero matrix, where the sign is undefined. We can define it as 1.\n        denominator = np.sum(np.abs(M))\n        if denominator == 0.0:\n            return 1.0\n        return np.sum(M) / denominator\n\n    for case in test_cases:\n        dt = case[\"dt\"]\n        H = case[\"H\"]\n        H1 = case[\"H1\"]\n        H2 = case[\"H2\"]\n\n        # Verification step: ensure H = H1 + H2\n        if not np.allclose(H, H1 + H2):\n            raise ValueError(f\"In {case['name']}, H does not equal H1 + H2.\")\n\n        # 1. Compute the commutator and its Frobenius norm\n        commutator = H1 @ H2 - H2 @ H1\n        comm_norm = np.linalg.norm(commutator, 'fro')\n\n        # 2. Compute the exact and Trotter propagators\n        M_exact = expm(-dt * H)\n        M_trot = expm(-dt * H1) @ expm(-dt * H2)\n        \n        # 3. Compute the Frobenius norm of the Trotter error\n        delta_F = np.linalg.norm(M_exact - M_trot, 'fro')\n\n        # 4. Compute the average signs\n        S_exact = sign_metric(M_exact)\n        S_trot = sign_metric(M_trot)\n        \n        case_results = [comm_norm, delta_F, S_exact, S_trot]\n        results.append(case_results)\n\n    # Use standard repr for list to get the format with spaces\n    # and then customize it to match the requested output format exactly.\n    # The default str() for a list already has the desired format.\n    formatted_results = [str(r) for r in results]\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}