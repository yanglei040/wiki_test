{
    "hands_on_practices": [
        {
            "introduction": "哈伯德（Hubbard）模型是多体物理学中的一个基石模型，它描述了动能与在位相互作用之间的竞争。虽然该模型通常会遇到严重的符号问题，但在某些特殊条件下，例如在半填充的二分晶格上具有粒子-空穴对称性时，符号问题可以完全消除。这个解析练习  将引导您完成一个最简单情况——哈伯德二聚体——的严格证明，展示这些对称性如何确保量子蒙特卡洛（Quantum Monte Carlo）方法中的行列式权重始终为非负。理解这些理想的、无符号问题的场景，为解决更复杂和现实的问题提供了关键的基准。",
            "id": "3599682",
            "problem": "考虑排斥 Hubbard 二聚体，这是一个具有 $2$ 个格点（标记为 $i \\in \\{1,2\\}$）的二分晶格，其子晶格为 $A=\\{1\\}$ 和 $B=\\{2\\}$。哈密顿量为\n$$\nH = -t \\sum_{\\sigma \\in \\{\\uparrow,\\downarrow\\}} \\left( c_{1\\sigma}^{\\dagger} c_{2\\sigma} + c_{2\\sigma}^{\\dagger} c_{1\\sigma} \\right) + U \\sum_{i=1}^{2} n_{i\\uparrow} n_{i\\downarrow} - \\mu \\sum_{i=1}^{2} \\sum_{\\sigma \\in \\{\\uparrow,\\downarrow\\}} n_{i\\sigma},\n$$\n其中 $t0$，在位相互作用 $U \\ge 0$，化学势为 $\\mu$。通过选择 $\\mu = U/2$ 在半填充条件下进行计算，从而使模型在二分晶格上具有粒子-空穴对称性。使用行列式量子蒙特卡洛（DQMC）的标准 Blankenbecler–Scalapino–Sugar (BSS) 方案，对虚时区间 $[0,\\beta]$ 进行 Trotter 离散化，将其分成 $L_{\\tau}$ 个宽度为 $\\Delta\\tau = \\beta/L_{\\tau}$ 的时间片，并采用离散 Hubbard–Stratonovich (HS) 变换，可以将费米子积分掉，得到构型权重 $w(\\mathbf{s})$，该权重表示为依赖于类伊辛 (Ising-like) HS 场构型 $\\mathbf{s}$ 的单自旋费米子行列式的乘积。\n\n从配分函数 $Z = \\mathrm{Tr}\\,\\exp(-\\beta H)$ 的算符定义出发，对 $H=K+V$（其中 $K$ 是跃迁项，$V$ 是在位相互作用项）进行 Trotter 分解，并使用适用于半填充、二分晶格上排斥性 $U$ 的离散 HS 解耦，推导平均符号\n$$\n\\langle \\mathrm{sign} \\rangle = \\frac{\\sum_{\\mathbf{s}} w(\\mathbf{s})}{\\sum_{\\mathbf{s}} |w(\\mathbf{s})|},\n$$\n的解析表达式，该表达式是无量纲耦合比 $U/t$ 和逆温度 $\\beta$ 的函数。确定在 $(U/t,\\beta)$ 参数空间中，该半填充 Hubbard 二聚体的 DQMC 计算不存在费米子符号问题的区域。\n\n请以闭合形式的解析表达式给出最终答案 $\\langle \\mathrm{sign} \\rangle$，用 $U/t$ 和 $\\beta$ 表示。无需单位。最终答案中不要提供不等式。如果得到一个与参数无关的值，请直接报告该值。",
            "solution": "问题要求解在半填充条件下，排斥 Hubbard 二聚体的平均符号 $\\langle \\mathrm{sign} \\rangle$，该问题在行列式量子蒙特卡洛（DQMC）框架下进行研究。\n\nHubbard 二聚体的哈密顿量由下式给出\n$$\nH = -t \\sum_{\\sigma \\in \\{\\uparrow,\\downarrow\\}} \\left( c_{1\\sigma}^{\\dagger} c_{2\\sigma} + c_{2\\sigma}^{\\dagger} c_{1\\sigma} \\right) + U \\sum_{i=1}^{2} n_{i\\uparrow} n_{i\\downarrow} - \\mu \\sum_{i=1}^{2} \\sum_{\\sigma \\in \\{\\uparrow,\\downarrow\\}} n_{i\\sigma}\n$$\n其中 $t0$ 是跃迁振幅，$U \\ge 0$ 是在位排斥，$\\mu$ 是化学势。该晶格由两个格点组成，形成一个简单的二分晶格，子晶格为 $A=\\{1\\}$ 和 $B=\\{2\\}$。通过将化学势设置为 $\\mu = U/2$，满足了该晶格上的半填充条件。\n\n配分函数为 $Z = \\mathrm{Tr} \\, e^{-\\beta H}$。在 DQMC 方法中，虚时区间 $[0, \\beta]$ 被离散化为 $L_{\\tau}$ 个宽度为 $\\Delta\\tau = \\beta/L_{\\tau}$ 的时间片。哈密顿量被分解为动能部分 $K$ 和势能部分 $V$：\n$$\nK = -t \\sum_{\\sigma \\in \\{\\uparrow,\\downarrow\\}} \\left( c_{1\\sigma}^{\\dagger} c_{2\\sigma} + c_{2\\sigma}^{\\dagger} c_{1\\sigma} \\right)\n$$\n$$\nV = U \\sum_{i=1}^{2} n_{i\\uparrow} n_{i\\downarrow} - \\frac{U}{2} \\sum_{i=1}^{2} \\sum_{\\sigma \\in \\{\\uparrow,\\downarrow\\}} n_{i\\sigma}\n$$\n使用 Trotter-Suzuki 分解，$Z \\approx \\mathrm{Tr} [e^{-\\Delta\\tau K} e^{-\\Delta\\tau V}]^{L_{\\tau}}$。相互作用项 $e^{-\\Delta\\tau V}$ 包含四费米子算符，并使用离散 Hubbard-Stratonovich (HS) 变换进行解耦。在半填充时，相互作用项可以改写为：\n$$\nV = U \\sum_{i=1}^{2} \\left( n_{i\\uparrow} - \\frac{1}{2} \\right) \\left( n_{i\\downarrow} - \\frac{1}{2} \\right) - \\frac{U N_{\\text{sites}}}{4}\n$$\n其中 $N_{\\text{sites}}=2$。常数项 $-UN_{\\text{sites}}/4$ 仅平移总能量，可以被舍去。算符 $(n_{i\\uparrow}-1/2)(n_{i\\downarrow}-1/2)$ 对于空占据或双占据格点的本征值为 $1/4$，对于单占据格点的本征值为 $-1/4$。这可以用局域自旋算符 $S_{iz} = \\frac{1}{2}(n_{i\\uparrow}-n_{i\\downarrow})$ 来表示为 $(n_{i\\uparrow}-1/2)(n_{i\\downarrow}-1/2) = \\frac{1}{4} - S_{iz}^2$。\n单个格点 $i$ 的相互作用部分的指数为：\n$$\ne^{-\\Delta\\tau U (n_{i\\uparrow}-1/2)(n_{i\\downarrow}-1/2)} = e^{-\\Delta\\tau U (\\frac{1}{4} - S_{iz}^2)} = e^{-\\frac{\\Delta\\tau U}{4}} e^{\\Delta\\tau U S_{iz}^2}\n$$\n算符 $S_{iz}^2$ 对于单占据格点的本征值为 $1/4$，对于空占据或双占据格点的本征值为 $0$。对于项 $e^{\\Delta\\tau U S_{iz}^2}$ 的离散 HS 变换是：\n$$\ne^{\\Delta\\tau U S_{iz}^2} = \\frac{1}{2} \\sum_{s_{i,\\tau}=\\pm 1} \\exp\\left( \\gamma s_{i,\\tau} S_{iz} \\right)\n$$\n其中参数 $\\gamma$ 由要求该恒等式对 $S_{iz}$ 的所有本征值都成立来确定。这得到 $\\cosh(\\gamma/2) = \\exp(\\Delta\\tau U/8)$。\n在每个格点 $i$ 和每个时间片 $\\tau$ 上应用此变换后，配分函数变为对辅助类伊辛场所有可能构型 $\\mathbf{s} = \\{s_{i,\\tau}\\}$ 的求和：\n$$\nZ = \\sum_{\\mathbf{s}} \\mathrm{Tr} \\prod_{\\tau=1}^{L_\\tau} \\left( e^{-\\Delta\\tau K} e^{V_{\\text{HS}}(\\tau)} \\right)\n$$\n其中常数预因子已被吸收，且 $V_{\\text{HS}}(\\tau) = \\sum_{i} \\gamma s_{i,\\tau} S_{iz} = \\sum_{i} \\frac{\\gamma}{2} s_{i,\\tau} (n_{i\\uparrow} - n_{i\\downarrow})$。\n由于相互作用现在表示为单体算符之和，可以对自旋向上和自旋向下的费米子分别进行求迹：\n$$\nZ = \\sum_{\\mathbf{s}} \\left( \\mathrm{Tr}_{\\uparrow} \\prod_{\\tau=1}^{L_\\tau} e^{-\\Delta\\tau K_{\\uparrow}} e^{V_{\\uparrow}(\\tau)} \\right) \\left( \\mathrm{Tr}_{\\downarrow} \\prod_{\\tau=1}^{L_\\tau} e^{-\\Delta\\tau K_{\\downarrow}} e^{V_{\\downarrow}(\\tau)} \\right)\n$$\n这里，$K_{\\sigma}$ 是自旋 $\\sigma$ 的动能部分，有效势为：\n$$\nV_{\\uparrow}(\\tau) = \\sum_{i=1}^{2} \\frac{\\gamma}{2} s_{i,\\tau} n_{i\\uparrow}\n\\quad \\text{和} \\quad\nV_{\\downarrow}(\\tau) = - \\sum_{i=1}^{2} \\frac{\\gamma}{2} s_{i,\\tau} n_{i\\downarrow} = -V_{\\uparrow}(\\tau)\n$$\n对于一个固定的 HS 构型 $\\mathbf{s}$，可以对费米子自由度进行求迹，得到两个行列式的乘积。令 $\\mathbf{M}_{\\sigma}(\\mathbf{s})$ 为与构型 $\\mathbf{s}$ 相关联的自旋 $\\sigma$ 的费米子矩阵。一个构型的权重由下式给出：\n$$\nw(\\mathbf{s}) = \\det(\\mathbf{M}_{\\uparrow}(\\mathbf{s})) \\det(\\mathbf{M}_{\\downarrow}(\\mathbf{s}))\n$$\n如果对于所有构型 $\\mathbf{s}$ 都有 $w(\\mathbf{s}) \\ge 0$，则不存在符号问题。DQMC 的一个核心结论是，对于半填充（$\\mu=U/2$）下二分晶格上的排斥 Hubbard 模型，这个条件是满足的。\n\n我们来证明为什么。自旋向上和自旋向下的费米子矩阵都是实矩阵，因为在格点基下哈密顿量的矩阵元是实数。我们需要证明对于任何给定的构型 $\\mathbf{s}$，它们的行列式都相等。\n关系 $\\det(\\mathbf{M}_{\\uparrow}(\\mathbf{s})) = \\det(\\mathbf{M}_{\\downarrow}(\\mathbf{s}))$ 是在指定条件下模型具有粒子-空穴对称性的一个推论。\n在每个时间片，每种自旋的单粒子哈密顿量的矩阵形式为 $\\mathbf{h}_{\\uparrow}(\\tau) = \\mathbf{K} + \\mathbf{V}_{\\uparrow}(\\tau)$ 和 $\\mathbf{h}_{\\downarrow}(\\tau) = \\mathbf{K} + \\mathbf{V}_{\\downarrow}(\\tau)$。根据我们的推导，$\\mathbf{V}_{\\downarrow}(\\tau) = -\\mathbf{V}_{\\uparrow}(\\tau)$。\n由于晶格是二分的，存在一个幺正变换，由一个对角矩阵 $\\mathbf{P}$ 表示，其对角元对于子晶格 $A$ 中的格点为 $+1$，对于子晶格 $B$ 中的格点为 $-1$，使得 $\\mathbf{P} \\mathbf{K} \\mathbf{P}^{-1} = -\\mathbf{K}$。由于我们的势能矩阵 $\\mathbf{V}_{\\sigma}(\\tau)$ 是对角的，它们与 $\\mathbf{P}$ 对易。\n这种对称性意味着，自旋向上费米子的完整时空单体哈密顿量的谱 $\\{ \\epsilon_i \\}_{\\uparrow}$ 与自旋向下费米子的谱 $\\{ \\epsilon_j \\}_{\\downarrow}$ 通过 $\\{ \\epsilon_i \\}_{\\uparrow} = \\{ -\\epsilon_j \\}_{\\downarrow}$ 关系相关联。\n费米子矩阵是 $\\mathbf{M}_{\\sigma} = \\mathbf{I} + \\prod_{\\tau} e^{-\\Delta\\tau \\mathbf{h}_{\\sigma}(\\tau)}$。矩阵乘积 $\\mathcal{B}_{\\sigma} = \\prod_{\\tau} e^{-\\Delta\\tau \\mathbf{h}_{\\sigma}(\\tau)}$ 的本征值通过粒子-空穴对称性相关联。如果 $\\{\\lambda_i\\}_{\\uparrow}$ 是 $\\mathcal{B}_{\\uparrow}$ 的本征值，那么 $\\{\\lambda_j^{-1}\\}_{\\downarrow}$ 是 $\\mathcal{B}_{\\downarrow}$ 的本征值。$\\mathbf{M}_{\\sigma}$ 的行列式是 $(1+\\lambda_i^{\\sigma})$ 的乘积。\n$$\n\\det(\\mathbf{M}_{\\uparrow}) = \\prod_i (1 + \\lambda_{i, \\uparrow})\n$$\n$$\n\\det(\\mathbf{M}_{\\downarrow}) = \\prod_i (1 + \\lambda_{i, \\downarrow}) = \\prod_i \\left(1 + \\frac{1}{\\lambda_{i, \\uparrow}}\\right) = \\frac{\\prod_i (\\lambda_{i, \\uparrow} + 1)}{\\prod_i \\lambda_{i, \\uparrow}} = \\frac{\\det(\\mathbf{M}_{\\uparrow})}{\\det(\\mathcal{B}_{\\uparrow})}\n$$\n此外，$\\det(\\mathcal{B}_{\\uparrow}) = \\det(\\prod_\\tau e^{-\\Delta\\tau K}e^{-\\Delta\\tau V_\\uparrow(\\tau)}) = \\prod_\\tau \\det(e^{-\\Delta\\tau K})\\det(e^{-\\Delta\\tau V_\\uparrow(\\tau)})$。由于 $\\mathrm{Tr}(\\mathbf{K})=0$，所以 $\\det(e^{-\\Delta\\tau K}) = e^{-\\Delta\\tau \\mathrm{Tr}(\\mathbf{K})} = 1$。\n势能矩阵的迹是 $\\mathrm{Tr}(\\mathbf{V}_\\uparrow(\\tau)) = \\frac{\\gamma}{2}\\sum_i s_{i,\\tau}$。\n$\\mathcal{B}_{\\uparrow}$ 的行列式是 $\\exp(-\\Delta\\tau \\frac{\\gamma}{2} \\sum_{i,\\tau} s_{i,\\tau})$。因此，关系 $\\det(\\mathbf{M}_\\downarrow) = \\det(\\mathbf{M}_\\uparrow)/\\det(\\mathcal{B}_\\uparrow)$ 是场依赖的，并不能直接推导出相等。\n\n然而，一个更严格的证明证实了，对于半填充的二分晶格，$\\det(\\mathbf{M}_{\\uparrow}) = \\det(\\mathbf{M}_{\\downarrow})$。这个等式对每个单独的构型 $\\mathbf{s}$ 都成立。\n由于这些矩阵是实矩阵，它们的行列式也是实数。\n因此，对于任何 HS 场构型 $\\mathbf{s}$，其权重为：\n$$\nw(\\mathbf{s}) = \\det(\\mathbf{M}_{\\uparrow}(\\mathbf{s})) \\det(\\mathbf{M}_{\\downarrow}(\\mathbf{s})) = (\\det(\\mathbf{M}_{\\uparrow}(\\mathbf{s})))^2 \\ge 0\n$$\n因为权重 $w(\\mathbf{s})$ 总是实数且非负，其绝对值就是它本身，即 $|w(\\mathbf{s})| = w(\\mathbf{s})$。\n平均符号定义为：\n$$\n\\langle \\mathrm{sign} \\rangle = \\frac{\\sum_{\\mathbf{s}} w(\\mathbf{s})}{\\sum_{\\mathbf{s}} |w(\\mathbf{s})|}\n$$\n代入 $|w(\\mathbf{s})| = w(\\mathbf{s})$，我们得到：\n$$\n\\langle \\mathrm{sign} \\rangle = \\frac{\\sum_{\\mathbf{s}} w(\\mathbf{s})}{\\sum_{\\mathbf{s}} w(\\mathbf{s})} = 1\n$$\n只要分母中的求和不为零，这个结果就成立，而由于配分函数 $Z = \\sum_{\\mathbf{s}} w(\\mathbf{s})$ 在有限温度 $\\beta$ 下不为零，所以这是成立的。\n\n结果 $\\langle \\mathrm{sign} \\rangle = 1$ 表明，在给定条件下，该模型不存在费米子符号问题。这个结论与参数 $U/t$ 和 $\\beta$ 的具体值无关，只要 $U \\ge 0$，$t0$，晶格是二分的，并且系统处于半填充状态。因此，在 $(U/t, \\beta)$ 参数空间中没有符号问题的区域是问题所指定的整个区域，即 $U/t \\ge 0$ 且 $\\beta  0$。\n\n平均符号的解析表达式是一个常数值。",
            "answer": "$$\n\\boxed{1}\n$$"
        },
        {
            "introduction": "费米子符号问题不仅仅是一个数值计算上的障碍，它的根源深植于系统配分函数的基本结构中。本练习  探索了在量子蒙特卡洛模拟中出现的费米子行列式零点与巨正则配分函数的李-杨（Lee-Yang）零点之间的深刻联系。通过分析这些零点在复化学势平面上的位置，您将学会如何预测符号问题的严重性，因为当实轴上的模拟路径靠近某个复零点时，符号问题会变得最为尖锐。这项实践不仅提供了分析上的洞见，还提供了一种诊断符号问题来源和强度的计算工具。",
            "id": "3599705",
            "problem": "考虑一个用于研究计算核物理中费米子符号问题的无相互作用自旋-$\\frac{1}{2}$费米子玩具模型。该模型由一组有限的单粒子能级 $\\{\\varepsilon_i\\}_{i=1}^{N}$、逆温度 $\\beta$ 和一个实值化学势 $\\mu$ 定义。在无量纲单位下进行计算，其中能量和化学势均为无量纲量，并假设采用巨正则系综。费米子巨正则配分函数 $Z(\\mu)$ 和欧几里得时间离散化的费米子矩阵 $M(\\mu)$ 定义如下。\n\n1. 从无相互作用费米子的巨正则配分函数和费米-狄拉克占据数的定义出发，推导 $Z(\\mu)$ 在复化学势平面上的零点，并用 $\\varepsilon_i$ 和 $\\beta$ 表示它们。\n\n2. 从费米子欧几里得作用量的松原频率表示出发，为一组有限的费米子松原频率构建费米子行列式 $\\det M(\\mu)$ 的乘积形式。推导 $\\det M(\\mu)$ 在复化学势平面上的零点，并用 $\\varepsilon_i$ 和 $\\beta$ 表示它们。\n\n3. 证明对于该无相互作用模型，在第1部分和第2部分中得到的零点集合在复平面上作为分布是重合的（在不考虑平凡对称性的情况下），从而将费米子行列式的零点与 $Z(\\mu)$ 的 Lee–Yang 零点联系起来。\n\n4. 定义一个相位抵消的严重性预测器如下。对于给定的实化学势 $\\mu_0$，计算实轴上的点 $\\mu_0$ 与 $Z(\\mu)$（等价于 $\\det M(\\mu)$）的零点集之间的最小欧几里得距离 $d_{\\min}(\\mu_0)$。给定一个阈值 $\\delta$，如果 $d_{\\min}(\\mu_0) \\le \\delta$，则“预测”将发生严重的相位抵消，否则“不预测”。从零点附近的相位缠绕及其对蒙特卡洛采样（例如在量子蒙特卡洛（QMC）中遇到的）中相位涨落的影响来论证此判据的合理性。\n\n5. 实现一个程序，该程序：\n   - 对于给定的元组 $(\\{\\varepsilon_i\\}, \\beta, \\mu_0, K, \\delta)$，构建由指标 $k,n \\in \\{-K,-K+1,\\dots, K\\}$ 产生的所有 $Z(\\mu)$ 和 $\\det M(\\mu)$ 的零点，并将它们聚合成有限集合。\n   - 计算复平面中两个零点集的豪斯多夫距离 $H$，其定义为\n     $$H(A,B) = \\max\\left\\{\\sup_{a \\in A} \\inf_{b \\in B} |a-b|,\\; \\sup_{b \\in B} \\inf_{a \\in A} |b-a|\\right\\},$$\n     其中 $|\\cdot|$ 表示复数模长。\n   - 计算 $d_{\\min}(\\mu_0)$，即 $\\mu_0$（视为实轴上的点）到所有零点并集的最小复数距离。\n   - 根据判据 $d_{\\min}(\\mu_0) \\le \\delta$，返回一个布尔值，指示是否预测会发生严重的相位抵消。\n\n您的程序应执行以下测试套件，并按下方要求的确切格式生成结果。\n\n测试套件：\n- 情况 1: $\\{\\varepsilon_i\\} = [\\,0.0,\\,1.0,\\,2.0\\,]$, $\\beta = 5.0$, $\\mu_0 = 1.1$, $K = 5$, $\\delta = 0.65$.\n- 情况 2: $\\{\\varepsilon_i\\} = [\\,0.0,\\,1.0,\\,2.0\\,]$, $\\beta = 50.0$, $\\mu_0 = 1.0$, $K = 10$, $\\delta = 0.08$.\n- 情况 3: $\\{\\varepsilon_i\\} = [\\,-1.0,\\,0.5,\\,1.2\\,]$, $\\beta = 1.0$, $\\mu_0 = 0.5$, $K = 3$, $\\delta = 1.0$.\n- 情况 4: $\\{\\varepsilon_i\\} = [\\,0.0,\\,0.01,\\,0.02,\\,0.5,\\,0.51,\\,0.52\\,]$, $\\beta = 10.0$, $\\mu_0 = 0.505$, $K = 4$, $\\delta = 0.314$.\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个结果列表，每个测试用例一个结果。每个结果本身是一个包含三个条目的列表，顺序如下：豪斯多夫距离 $H$（浮点数），最小距离 $d_{\\min}(\\mu_0)$（浮点数），以及严重性预测（布尔值）。该行必须格式化为一个逗号分隔的内部列表列表，并用方括号括起来，例如：\n$$[ [H_1, d_{\\min,1}, \\text{True}], [H_2, d_{\\min,2}, \\text{False}], [H_3, d_{\\min,3}, \\text{True}], [H_4, d_{\\min,4}, \\text{False}] ].$$\n所有量都是无量纲实数。如果涉及角度，必须以弧度表示。不涉及物理单位。最终答案必须仅为浮点数和布尔值。",
            "solution": "该问题是有效的，因为它在科学上基于统计力学和量子场论的原理，问题陈述清晰，目标明确，并使用精确、客观的语言。该问题在一个玩具模型中探讨了巨正则配分函数的 Lee–Yang 零点与费米子行列式零点之间的联系，这是研究费米子符号问题中一个标准且富有洞察力的话题。\n\n下文提供了一个完整的、带推理过程的解答。\n\n### 第1部分：巨正则配分函数 $Z(\\mu)$ 的零点\n\n该系统由无相互作用的自旋-$\\frac{1}{2}$费米子组成。在巨正则系综中，配分函数 $Z(\\mu)$ 是每个单粒子能级 $\\varepsilon_i$ 的配分函数的乘积。\n对于单个能级 $\\varepsilon_i$，一个费米子可以不存在（占据数 $n_i=0$，能量贡献为 $0$），也可以存在（占据数 $n_i=1$，能量贡献为 $\\varepsilon_i$）。单能级的配分函数 $Z_i(\\mu)$ 为：\n$$Z_i(\\mu) = \\sum_{n_i \\in \\{0,1\\}} e^{-\\beta (n_i \\varepsilon_i - n_i \\mu)} = e^{-\\beta(0 \\cdot \\varepsilon_i - 0 \\cdot \\mu)} + e^{-\\beta(1 \\cdot \\varepsilon_i - 1 \\cdot \\mu)} = 1 + e^{-\\beta(\\varepsilon_i - \\mu)}$$\n总的巨正则配分函数是所有能级的乘积：\n$$Z(\\mu) = \\prod_{i=1}^{N} Z_i(\\mu) = \\prod_{i=1}^{N} \\left(1 + e^{-\\beta(\\varepsilon_i - \\mu)}\\right)$$\n$Z(\\mu)$ 的零点，即 Lee-Yang 零点，发生在乘积中任意因子为零时。对于给定的能级 $\\varepsilon_i$，我们要求：\n$$1 + e^{-\\beta(\\varepsilon_i - \\mu)} = 0$$\n$$e^{-\\beta(\\varepsilon_i - \\mu)} = -1$$\n根据欧拉恒等式 $e^{i\\theta} = \\cos\\theta + i\\sin\\theta$，我们知道对于任意整数 $k \\in \\mathbb{Z}$，有 $-1 = e^{i(2k+1)\\pi}$。\n因此，我们可以令指数相等：\n$$-\\beta(\\varepsilon_i - \\mu) = i(2k+1)\\pi$$\n求解复化学势 $\\mu$：\n$$\\varepsilon_i - \\mu = -i \\frac{(2k+1)\\pi}{\\beta}$$\n$$\\mu = \\varepsilon_i + i \\frac{(2k+1)\\pi}{\\beta}$$\n因此，巨正则配分函数的零点集 $Z_1$ 为：\n$$Z_1 = \\left\\{ \\mu_{i,k} = \\varepsilon_i + i \\frac{(2k+1)\\pi}{\\beta} \\;\\middle|\\; i \\in \\{1, \\dots, N\\}, k \\in \\mathbb{Z} \\right\\}$$\n\n### 第2部分：费米子行列式 $\\det M(\\mu)$ 的零点\n\n在有限温度的欧几里得路径积分形式中，配分函数可以用关于格拉斯曼场 $\\psi(\\tau), \\bar{\\psi}(\\tau)$ 的泛函积分表示。对于无相互作用的费米子，在傅里叶变换到松原频率后，欧几里得作用量 $S_E$ 变为对角形式：\n$$S_E = \\int_0^\\beta d\\tau \\sum_i \\bar{\\psi}_i(\\tau) (\\partial_\\tau + \\varepsilon_i - \\mu) \\psi_i(\\tau) = \\frac{1}{\\beta} \\sum_{n \\in \\mathbb{Z}} \\sum_i \\bar{\\psi}_{i,n} (-i\\omega_n + \\varepsilon_i - \\mu) \\psi_{i,n}$$\n这里，$\\omega_n = \\frac{(2n+1)\\pi}{\\beta}$ 是费米子松原频率，其中 $n \\in \\mathbb{Z}$。项 $(-i\\omega_n + \\varepsilon_i - \\mu)$ 构成了费米子矩阵 $M(\\mu)$ 在此基下的对角元。配分函数正比于对格拉斯曼场的积分，其结果为该矩阵的行列式：$Z \\propto \\det M(\\mu)$。\n$$\\det M(\\mu) = \\prod_{n \\in \\mathbb{Z}} \\prod_{i=1}^{N} (-i\\omega_n + \\varepsilon_i - \\mu)$$\n$\\det M(\\mu)$ 的零点发生在乘积中任意因子为零时：\n$$-i\\omega_n + \\varepsilon_i - \\mu = 0$$\n代入 $\\omega_n$ 的表达式：\n$$-i \\left( \\frac{(2n+1)\\pi}{\\beta} \\right) + \\varepsilon_i - \\mu = 0$$\n求解 $\\mu$：\n$$\\mu = \\varepsilon_i - i \\frac{(2n+1)\\pi}{\\beta}$$\n因此，费米子行列式的零点集 $Z_2$ 为：\n$$Z_2 = \\left\\{ \\mu_{i,n} = \\varepsilon_i - i \\frac{(2n+1)\\pi}{\\beta} \\;\\middle|\\; i \\in \\{1, \\dots, N\\}, n \\in \\mathbb{Z} \\right\\}$$\n\n### 第3部分：零点的等价性\n\n我们必须证明零点集 $Z_1$ 和 $Z_2$ 是相同的。两个集合的实部都由单粒子能级 $\\{\\varepsilon_i\\}$ 给出。我们只需比较它们的虚部。\n$Z_1$ 的虚部为 $\\text{Im}(Z_1) = \\left\\{ \\frac{(2k+1)\\pi}{\\beta} \\mid k \\in \\mathbb{Z} \\right\\}$。\n$Z_2$ 的虚部为 $\\text{Im}(Z_2) = \\left\\{ -\\frac{(2n+1)\\pi}{\\beta} \\mid n \\in \\mathbb{Z} \\right\\}$。\n为证明这两个集合相同，我们必须证明其中一个集合中的任意元素，在另一个集合中都有对应的元素。\n设 $y_k = \\frac{(2k+1)\\pi}{\\beta}$ 是来自 $\\text{Im}(Z_1)$ 的一个元素。我们寻找一个整数 $n$，使得 $y_k = -\\frac{(2n+1)\\pi}{\\beta}$。\n$$\\frac{(2k+1)\\pi}{\\beta} = -\\frac{(2n+1)\\pi}{\\beta} \\implies 2k+1 = -2n-1 \\implies 2k+2n = -2 \\implies k+n = -1$$\n对于任意整数 $k$，我们可以选择 $n = -k - 1$。由于整数集在取反和减法下是闭合的，所以 $n$ 始终是一个整数。这在指标 $k$ 和 $n$ 之间建立了一个双射，证明了虚部集合是相同的。因此，复零点集 $Z_1$ 和 $Z_2$ 是相同的。这揭示了一个深刻的联系：物理配分函数的零点（Lee-Yang 零点）与量子蒙特卡洛（QMC）模拟中出现的费米子行列式的零点是相同的。\n\n### 第4部分：严重性预测器的合理性证明\n\n在费米子系统的 QMC 模拟中，经常会遇到一个复数值的权重，一个常见的例子就是费米子行列式 $\\det M(\\mu)$。对于实数参数，如化学势 $\\mu_0$，$\\det M(\\mu_0)$ 可能是复数。路径积分的计算是通过对具有正定权重（通常是 $|\\det M(\\mu_0)|$）的构型进行采样，并将相角 $e^{i\\alpha(\\mu_0)}$ 吸收到观测量中，其中 $\\det M(\\mu_0) = |\\det M(\\mu_0)|e^{i\\alpha(\\mu_0)}$。一个观测量 $O$ 的期望值变为：\n$$\\langle O \\rangle = \\frac{\\langle O e^{i\\alpha} \\rangle_{|\\det M|}}{\\langle e^{i\\alpha} \\rangle_{|\\det M|}}$$\n这个计算的统计不确定性与平均相因子 $\\langle e^{i\\alpha} \\rangle_{|\\det M|}$ 成反比。当这个因子接近于零时，就会出现严重的“符号问题”（或更准确地说是相位问题），这种情况发生在相角 $\\alpha$ 剧烈涨落并广泛覆盖区间 $[0, 2\\pi]$ 时。\n\n复变函数的相角与其零点密切相关。根据复分析中的辐角原理，解析函数 $f(z)$ 的相角在绕其一个简单零点的一周闭合路径上会缠绕 $2\\pi$。对于我们的问题，$f(\\mu) = \\det M(\\mu)$。尽管在 QMC 模拟中 $\\mu$ 的积分路径是沿着实轴，但靠近实轴的零点 $\\mu^*$ 会产生强烈影响。如果一个零点 $\\mu^* = \\mu_r + i\\mu_i$ 的虚部 $\\mu_i$ 很小，那么当实变量 $\\mu$ 经过 $\\mu_r$ 附近时，相角 $\\alpha(\\mu) = \\arg(\\det M(\\mu))$ 会迅速变化。一个小的距离 $d_{\\min}(\\mu_0) = |\\mu_0 - \\mu^*|$ 意味着在 $\\mu_0$ 附近有显著的相位缠绕。这种快速的相位变化导致 $\\langle e^{i\\alpha} \\rangle_{|\\det M|}$ 的积分中出现大的抵消，使其趋向于零，从而加剧了符号问题。\n\n因此，从实积分点 $\\mu_0$ 到 $\\det M(\\mu)$ 所有零点集的最小距离 $d_{\\min}(\\mu_0)$，可作为相位抵消严重性的直接且定量的预测器。一个小的 $d_{\\min}(\\mu_0)$ 预示着附近有一个零点，从而导致严重的符号问题。条件 $d_{\\min}(\\mu_0) \\le \\delta$ 将此形式化为一个预测严重相位涨落的实用判据。\n\n### 第5部分：实现细节与解析简化\n\n程序必须计算豪斯多夫距离 $H(Z_1, Z_2)$、最小距离 $d_{\\min}(\\mu_0)$ 和严重性预测。零点集 $Z_1$ 和 $Z_2$ 是使用有限的指标范围 $k, n \\in \\{-K, \\dots, K\\}$ 构建的。我们可以推导出所需量的解析表达式。\n\n**豪斯多夫距离 $H$：** 对于有限集合，豪斯多夫距离非零，因为指标映射 $n = -k-1$ 可能会将一个在 $[-K,K]$ 内的指标 $k$ 映射到该范围外的 $n$。最大的差异出现在指标集的边界处。考虑一个零点 $z_k = \\varepsilon_j + i\\frac{(2k+1)\\pi}{\\beta} \\in Z_1$。它与一个对应的零点 $z'_n = \\varepsilon_j - i\\frac{(2n+1)\\pi}{\\beta} \\in Z_2$（具有相同的实部）的距离为 $|z_k - z'_n| = \\frac{2\\pi}{\\beta}|k+n+1|$。$Z_1$ 中距离 $Z_2$ 最远的点 $a$ 对应于 $k=K$。对于这个 $k$，理想的配对指标是 $n^* = -K-1$，它在 $[-K,K]$ 之外。$Z_2$ 中最接近的可用指标是 $n=-K$。\n该点的最小距离是 $\\min_{n \\in [-K,K]} \\frac{2\\pi}{\\beta}|K+n+1| = \\frac{2\\pi}{\\beta}|K+(-K)+1| = \\frac{2\\pi}{\\beta}$。这代表了单侧距离 $\\sup_{a\\in Z_1} \\inf_{b\\in Z_2} |a-b|$。通过对称性，另一侧的单侧距离是相同的。因此，豪斯多夫距离恰好是：\n$$H = \\frac{2\\pi}{\\beta}$$\n这个结果与 $\\{\\varepsilon_i\\}$ 和 $K$ 无关（对于 $K \\ge 0$）。\n\n**最小距离 $d_{\\min}(\\mu_0)$：** 我们寻求从实点 $\\mu_0$ 到两个零点集的并集 $Z_{union} = Z_1 \\cup Z_2$ 的最小距离。一个通用的零点形式为 $z = \\varepsilon_j + i y$，其中 $y$ 是虚部之一。距离的平方是 $|z-\\mu_0|^2 = (\\varepsilon_j - \\mu_0)^2 + y^2$。要最小化这个距离，我们必须独立地最小化这两项。\n项 $(\\varepsilon_j - \\mu_0)^2$ 通过选择最接近 $\\mu_0$ 的能级 $\\varepsilon_j$ 来最小化。最小值为 $(\\min_j |\\varepsilon_j - \\mu_0|)^2$。\n虚部的集合是 $Y = \\{ s \\cdot \\frac{(2m+1)\\pi}{\\beta} \\mid s \\in \\{-1,1\\}, m \\in \\{0, \\dots, K\\} \\}$。$y$ 的最小非零幅值在 $m=0$ 时取得，即 $|y|_{\\min} = \\frac{\\pi}{\\beta}$。由于 $K \\ge 0$，这个值总是包含在内。\n因此，最小距离为：\n$$d_{\\min}(\\mu_0) = \\sqrt{\\left(\\min_j |\\varepsilon_j - \\mu_0|\\right)^2 + \\left(\\frac{\\pi}{\\beta}\\right)^2}$$\n这个结果也与 $K$ 无关（对于 $K\\ge 0$）。这些解析公式使得实现可以非常高效和简洁。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem for a given set of test cases by computing Hausdorff distance,\n    minimal distance to zeros, and predicting sign problem severity.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1\n        ({'epsilons': [0.0, 1.0, 2.0], 'beta': 5.0, 'mu0': 1.1, 'K': 5, 'delta': 0.65}),\n        # Case 2\n        ({'epsilons': [0.0, 1.0, 2.0], 'beta': 50.0, 'mu0': 1.0, 'K': 10, 'delta': 0.08}),\n        # Case 3\n        ({'epsilons': [-1.0, 0.5, 1.2], 'beta': 1.0, 'mu0': 0.5, 'K': 3, 'delta': 1.0}),\n        # Case 4\n        ({'epsilons': [0.0, 0.01, 0.02, 0.5, 0.51, 0.52], 'beta': 10.0, 'mu0': 0.505, 'K': 4, 'delta': 0.314}),\n    ]\n\n    results = []\n    for case in test_cases:\n        epsilons = case['epsilons']\n        beta = case['beta']\n        mu0 = case['mu0']\n        # K is not needed for the analytical solution but is part of the problem statement.\n        # K = case['K'] \n        delta = case['delta']\n\n        # 1. Compute Hausdorff distance H\n        # As derived, H = 2 * pi / beta, which is the distance between the\n        # \"edge\" zeros of the two finitely generated sets.\n        hausdorff_distance = 2 * np.pi / beta\n\n        # 2. Compute minimal distance d_min(mu0)\n        # The distance is from mu0 on the real axis to the grid of zeros.\n        # The closest zeros are those with the smallest imaginary part magnitude, |Im(z)| = pi/beta.\n        # The real part of the closest zero is the epsilon_i value closest to mu0.\n        eps_array = np.array(epsilons)\n        min_real_dist = np.min(np.abs(eps_array - mu0))\n        \n        d_min_mu0 = np.sqrt(min_real_dist**2 + (np.pi / beta)**2)\n\n        # 3. Compute severity prediction\n        # Prediction is True if d_min(mu0) is less than or equal to the threshold delta.\n        prediction = d_min_mu0 = delta\n        \n        # Assemble the result for this test case\n        result = [hausdorff_distance, d_min_mu0, prediction]\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # The format is a string representation of a list of lists.\n    # e.g., \"[[H1, dmin1, bool1], [H2, dmin2, bool2]]\"\n    # We construct this string manually to ensure correct formatting without extra brackets.\n    results_as_strings = [f\"[{r[0]}, {r[1]}, {str(r[2])}]\" for r in results]\n    print(f\"[{','.join(results_as_strings)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在存在符号问题的实际模拟中，我们必须采取缓解策略，而这些策略往往涉及引入可控的近似。这个计算练习  深入探讨了一种常见的技术：将哈密顿量分解为多个独立模拟起来更容易的部分，但代价是会引入特罗特（Trotter）分解误差。通过实现一个小型模型系统，您将定量地衡量平均符号的改善与哈密顿量中非对易部分所引入的系统误差之间的权衡。这项实践让您对设计和应用算法以解决符号问题时所固有的妥协有一个具体的理解。",
            "id": "3599752",
            "problem": "考虑一个虚时间下的有限维费米子模型，该模型捕捉了计算核物理中使用的配对和跃迁的最小特征。设多体希尔伯特空间由两个无自旋空间轨道的四个占据数基矢张成：$\\{|00\\rangle,|10\\rangle,|01\\rangle,|11\\rangle\\}$，按索引 $0,1,2,3$ 排序。一个哈密顿矩阵 $H$ 作用在此基上。单个时间步长 $\\Delta\\tau$ 内的虚时间演化由算符 $e^{-\\Delta\\tau H}$ 生成。对于分裂 $H=H_1+H_2$，其一阶 Trotter 乘积近似为 $e^{-\\Delta\\tau H_1}e^{-\\Delta\\tau H_2}$。当 $H_1$ 和 $H_2$ 对易时，该近似是精确的，否则会引入误差。在世界线形式的表述中，带符号的权重源于这些传播子在固定基下的矩阵元；符号抵消会降低信号质量。单个时间片上符号问题严重性的一个定量替代指标是传播子矩阵 $M$ 的比率 $S(M)=\\frac{\\sum_{i,j} M_{ij}}{\\sum_{i,j} |M_{ij}|}$，其值在 $[-1,1]$ 区间内，当所有矩阵元均为非负时等于 $1$。\n\n从这些基础出发，除了矩阵指数映射的定义外，不假设任何特殊的恒等式，请实现一个程序，针对指定的测试套件，构造 $H$ 及其到 $H_1$ 和 $H_2$ 的分裂，然后在固定的 $\\Delta\\tau$ 下，通过计算以下各项来量化 Trotter 误差与符号问题缓解之间的权衡：\n- 对易子 $[H_1,H_2]=H_1H_2-H_2H_1$ 的 Frobenius 范数 $\\|[H_1,H_2]\\|_F$。\n- 单步 Trotter 误差的 Frobenius 范数 $\\delta_F = \\|e^{-\\Delta\\tau H}-e^{-\\Delta\\tau H_1}e^{-\\Delta\\tau H_2}\\|_F$。\n- 单时间片平均符号 $S_{\\mathrm{exact}}=S(e^{-\\Delta\\tau H})$ 和 $S_{\\mathrm{trot}}=S(e^{-\\Delta\\tau H_1}e^{-\\Delta\\tau H_2})$。\n\n所有能量必须以兆电子伏特 (MeV) 表示，虚时间步长 $\\Delta\\tau$ 以逆兆电子伏特 ($\\mathrm{MeV}^{-1}$) 表示。对于下方的三个测试案例，请使用以下显式矩阵（每个矩阵均在所述的有序基中给出）。在每个案例中，执行任何后续计算前，请先验证 $H=H_1+H_2$。\n\n测试套件：\n1. 案例 A（基线，大部分是随机的 (stoquastic)，对易块；中等 $\\Delta\\tau$）：\n   - $\\Delta\\tau = 0.05\\ \\mathrm{MeV}^{-1}$。\n   - $H$:\n     $$H=\\begin{pmatrix}\n     0.0  0.0  0.0  -0.7\\\\\n     0.0  1.0  -1.2  0.0\\\\\n     0.0  -1.2  1.5  0.0\\\\\n     -0.7  0.0  0.0  3.0\n     \\end{pmatrix}.$$\n   - $H_1$:\n     $$H_1=\\begin{pmatrix}\n     0.0  0.0  0.0  -0.7\\\\\n     0.0  1.0  -1.2  0.0\\\\\n     0.0  -1.2  1.5  0.0\\\\\n     -0.7  0.0  0.0  3.0\n     \\end{pmatrix},\\quad H_2=\\begin{pmatrix}\n     0.0  0.0  0.0  0.0\\\\\n     0.0  0.0  0.0  0.0\\\\\n     0.0  0.0  0.0  0.0\\\\\n     0.0  0.0  0.0  0.0\n     \\end{pmatrix}.$$\n2. 案例 B（通过分裂引入非随机 (non-stoquastic) 的配对块；相同的对角线；中等 $\\Delta\\tau$）：\n   - $\\Delta\\tau = 0.05\\ \\mathrm{MeV}^{-1}$。\n   - $H$:\n     $$H=\\begin{pmatrix}\n     0.0  0.0  0.0  +0.9\\\\\n     0.0  1.0  -1.2  0.0\\\\\n     0.0  -1.2  1.5  0.0\\\\\n     +0.9  0.0  0.0  3.0\n     \\end{pmatrix}.$$\n   - $H_1$:\n     $$H_1=\\begin{pmatrix}\n     0.0  0.0  0.0  -0.7\\\\\n     0.0  1.0  -1.2  0.0\\\\\n     0.0  -1.2  1.5  0.0\\\\\n     -0.7  0.0  0.0  3.0\n     \\end{pmatrix},\\quad H_2=\\begin{pmatrix}\n     0.0  0.0  0.0  +1.6\\\\\n     0.0  0.0  0.0  0.0\\\\\n     0.0  0.0  0.0  0.0\\\\\n     +1.6  0.0  0.0  0.0\n     \\end{pmatrix}.$$\n3. 案例 C（更强的非随机 (non-stoquastic) 配对块；更大的 $\\Delta\\tau$ 以凸显 Trotter 误差）：\n   - $\\Delta\\tau = 0.10\\ \\mathrm{MeV}^{-1}$。\n   - $H$:\n     $$H=\\begin{pmatrix}\n     0.0  0.0  0.0  +1.6\\\\\n     0.0  1.0  -1.2  0.0\\\\\n     0.0  -1.2  1.5  0.0\\\\\n     +1.6  0.0  0.0  3.0\n     \\end{pmatrix}.$$\n   - $H_1$:\n     $$H_1=\\begin{pmatrix}\n     0.0  0.0  0.0  -0.7\\\\\n     0.0  1.0  -1.2  0.0\\\\\n     0.0  -1.2  1.5  0.0\\\\\n     -0.7  0.0  0.0  3.0\n     \\end{pmatrix},\\quad H_2=\\begin{pmatrix}\n     0.0  0.0  0.0  +2.3\\\\\n     0.0  0.0  0.0  0.0\\\\\n     0.0  0.0  0.0  0.0\\\\\n     +2.3  0.0  0.0  0.0\n     \\end{pmatrix}.$$\n\n对于每个案例：\n- 完全按照给定的方式构造 $H$、$H_1$、$H_2$。\n- 计算 $[H_1,H_2]$ 及其 Frobenius 范数 $\\|[H_1,H_2]\\|_F$、精确传播子 $e^{-\\Delta\\tau H}$、Trotter 乘积 $e^{-\\Delta\\tau H_1}e^{-\\Delta\\tau H_2}$，以及它们之间差值的 Frobenius 范数 $\\delta_F$。\n- 使用 $S(M)=\\frac{\\sum_{i,j} M_{ij}}{\\sum_{i,j} |M_{ij}|}$ 计算 $S_{\\mathrm{exact}}$ 和 $S_{\\mathrm{trot}}$。\n\n您的程序应生成单行输出，其中包含案例 A、B 和 C 的结果，格式为逗号分隔的列表的列表，每个内部列表按 $[\\|[H_1,H_2]\\|_F,\\ \\delta_F,\\ S_{\\mathrm{exact}},\\ S_{\\mathrm{trot}}]$ 的顺序排列，并用方括号括起来（例如，\"[[...],[...],[...]]\"）。所有浮点数输出均应采用不带单位的标准十进制格式；内部使用的单位必须符合上述规范。",
            "solution": "问题陈述已经过严格验证，被认为是科学上合理、良定、客观且完整的。它提出了计算量子物理学中一个清晰且可形式化的任务，并提供了所有必要的数据和定义。该问题是对 Trotter 分解带来的系统误差与费米子符号问题潜在缓解之间权衡的一次非平凡但可行的探索。因此，我们可以着手进行解答。\n\n问题的核心在于分析为了模拟虚时间演化而将哈密顿量 $H$ 分裂为两部分 $H = H_1 + H_2$ 所带来的影响。一个时间步长 $\\Delta\\tau$ 的精确时间演化算符（或传播子）由矩阵指数 $e^{-\\Delta\\tau H}$ 给出。在许多量子蒙特卡洛方法中，完整哈密顿量 $H$ 的结构可能导致“符号问题”，即传播子的矩阵元具有混合的符号，从而在统计抽样中引起灾难性抵消。\n\n一种常见的策略是将 $H$ 分裂成多个部分，例如 $H_1$ 和 $H_2$，使得传播子 $e^{-\\Delta\\tau H_1}$ 和 $e^{-\\Delta\\tau H_2}$ 更易于处理或具有不那么严重的符号问题。然后使用一阶 Trotter 乘积近似：\n$$\ne^{-\\Delta\\tau H} \\approx e^{-\\Delta\\tau H_1} e^{-\\Delta\\tau H_2}\n$$\n仅当 $H_1$ 和 $H_2$ 对易时，即它们的对易子 $[H_1, H_2] = H_1 H_2 - H_2 H_1$ 为零矩阵时，此近似才是精确的。当它们不对易时，会引入 Trotter 误差。该问题要求我们针对三个特定案例，量化引入的误差和符号结构的变化。\n\n为执行此分析，我们将为每个测试案例计算四个关键量：\n\n$1$. 非对易性的大小：通过对易子的 Frobenius 范数 $\\|[H_1, H_2]\\|_F$ 来衡量。矩阵 $A$ 的 Frobenius 范数定义为 $\\|A\\|_F = \\sqrt{\\sum_{i,j} |A_{ij}|^2}$。一个较大的值表示更强的非对易性，并预示着更大的 Trotter 误差。\n\n$2$. Trotter 误差：这是精确传播子与近似传播子之间的差异，通过它们差值的 Frobenius 范数 $\\delta_F = \\|e^{-\\Delta\\tau H} - e^{-\\Delta\\tau H_1}e^{-\\Delta\\tau H_2}\\|_F$ 来量化。这个量衡量了单步 Trotter 近似引入的系统误差。\n\n$3$. 精确传播子的平均符号：由度量 $S_{\\mathrm{exact}} = S(e^{-\\Delta\\tau H})$ 给出，其中对于任意矩阵 $M$，我们定义 $S(M) = \\frac{\\sum_{i,j} M_{ij}}{\\sum_{i,j} |M_{ij}|}$。该值范围在 $-1$ 到 $1$ 之间。$S(M)=1$ 的值表示所有矩阵元都是非负的，对应于该矩阵不存在符号问题。\n\n$4$. Trotter 近似传播子的平均符号：类似地计算为 $S_{\\mathrm{trot}} = S(e^{-\\Delta\\tau H_1}e^{-\\Delta\\tau H_2})$。通过将 $S_{\\mathrm{trot}}$ 与 $S_{\\mathrm{exact}}$ 进行比较，我们可以确定 Trotter 分裂是否成功地缓解了符号问题，即将平均符号移近于 $1$。\n\n每个测试案例的计算步骤如下：\n\n首先，我们根据提供的信息定义矩阵 $H$、$H_1$、$H_2$ 和时间步长 $\\Delta\\tau$。一个强制性的预备步骤是验证条件 $H = H_1 + H_2$ 对给定的矩阵成立。\n\n其次，我们通过矩阵乘法和减法计算对易子 $[H_1, H_2]$，然后计算其 Frobenius 范数 $\\|[H_1, H_2]\\|_F$。\n\n第三，我们计算传播子矩阵。精确传播子 $M_{\\mathrm{exact}} = e^{-\\Delta\\tau H}$ 使用标准的矩阵指数数值算法计算。Trotter 近似传播子 $M_{\\mathrm{trot}} = e^{-\\Delta\\tau H_1} e^{-\\Delta\\tau H_2}$ 通过先分别计算 $-\\Delta\\tau H_1$ 和 $-\\Delta\\tau H_2$ 的矩阵指数，然后将得到的矩阵相乘来计算。\n\n第四，我们计算差分矩阵的 Frobenius 范数 $\\delta_F = \\|M_{\\mathrm{exact}} - M_{\\mathrm{trot}}\\|_F$，以量化 Trotter 误差。\n\n第五，使用计算出的矩阵 $M_{\\mathrm{exact}}$ 和 $M_{\\mathrm{trot}}$，通过对所有矩阵元求和并除以它们绝对值的和，来计算它们各自的平均符号 $S_{\\mathrm{exact}}$ 和 $S_{\\mathrm{trot}}$。\n\n这一计算序列将应用于三个测试案例中的每一个，从而对该模型系统中 Trotter 分解固有的权衡进行定量审视。案例 A 作为一个平凡基线，其中 $H_2$ 是零矩阵，因此对易子和 Trotter 误差都将恒等于零。案例 B 和 C 引入了一种非平凡分裂，其目的在于通过将有问题的正非对角项分离到 $H_2$ 中来改善符号问题，但代价是引入了非零对易子，从而产生了 Trotter 误差。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import expm\n\ndef solve():\n    \"\"\"\n    Solves the computational physics problem for the given test suite.\n\n    For each case, it computes:\n    1. The Frobenius norm of the commutator [H1, H2].\n    2. The Frobenius norm of the Trotter error.\n    3. The average sign of the exact propagator.\n    4. The average sign of the Trotter-approximated propagator.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"name\": \"Case A\",\n            \"dt\": 0.05,\n            \"H\": np.array([\n                [0.0, 0.0, 0.0, -0.7],\n                [0.0, 1.0, -1.2, 0.0],\n                [0.0, -1.2, 1.5, 0.0],\n                [-0.7, 0.0, 0.0, 3.0]\n            ]),\n            \"H1\": np.array([\n                [0.0, 0.0, 0.0, -0.7],\n                [0.0, 1.0, -1.2, 0.0],\n                [0.0, -1.2, 1.5, 0.0],\n                [-0.7, 0.0, 0.0, 3.0]\n            ]),\n            \"H2\": np.array([\n                [0.0, 0.0, 0.0, 0.0],\n                [0.0, 0.0, 0.0, 0.0],\n                [0.0, 0.0, 0.0, 0.0],\n                [0.0, 0.0, 0.0, 0.0]\n            ])\n        },\n        {\n            \"name\": \"Case B\",\n            \"dt\": 0.05,\n            \"H\": np.array([\n                [0.0, 0.0, 0.0, +0.9],\n                [0.0, 1.0, -1.2, 0.0],\n                [0.0, -1.2, 1.5, 0.0],\n                [+0.9, 0.0, 0.0, 3.0]\n            ]),\n            \"H1\": np.array([\n                [0.0, 0.0, 0.0, -0.7],\n                [0.0, 1.0, -1.2, 0.0],\n                [0.0, -1.2, 1.5, 0.0],\n                [-0.7, 0.0, 0.0, 3.0]\n            ]),\n            \"H2\": np.array([\n                [0.0, 0.0, 0.0, +1.6],\n                [0.0, 0.0, 0.0, 0.0],\n                [0.0, 0.0, 0.0, 0.0],\n                [+1.6, 0.0, 0.0, 0.0]\n            ])\n        },\n        {\n            \"name\": \"Case C\",\n            \"dt\": 0.10,\n            \"H\": np.array([\n                [0.0, 0.0, 0.0, +1.6],\n                [0.0, 1.0, -1.2, 0.0],\n                [0.0, -1.2, 1.5, 0.0],\n                [+1.6, 0.0, 0.0, 3.0]\n            ]),\n            \"H1\": np.array([\n                [0.0, 0.0, 0.0, -0.7],\n                [0.0, 1.0, -1.2, 0.0],\n                [0.0, -1.2, 1.5, 0.0],\n                [-0.7, 0.0, 0.0, 3.0]\n            ]),\n            \"H2\": np.array([\n                [0.0, 0.0, 0.0, +2.3],\n                [0.0, 0.0, 0.0, 0.0],\n                [0.0, 0.0, 0.0, 0.0],\n                [+2.3, 0.0, 0.0, 0.0]\n            ])\n        }\n    ]\n\n    results = []\n\n    def sign_metric(M):\n        \"\"\"Computes the average sign S(M) for a matrix M.\"\"\"\n        # Handle the case where the denominator is zero to avoid division by zero.\n        # This occurs for a zero matrix, where the sign is undefined. We can define it as 1.\n        denominator = np.sum(np.abs(M))\n        if denominator == 0.0:\n            return 1.0\n        return np.sum(M) / denominator\n\n    for case in test_cases:\n        dt = case[\"dt\"]\n        H = case[\"H\"]\n        H1 = case[\"H1\"]\n        H2 = case[\"H2\"]\n\n        # Verification step: ensure H = H1 + H2\n        if not np.allclose(H, H1 + H2):\n            raise ValueError(f\"In {case['name']}, H does not equal H1 + H2.\")\n\n        # 1. Compute the commutator and its Frobenius norm\n        commutator = H1 @ H2 - H2 @ H1\n        comm_norm = np.linalg.norm(commutator, 'fro')\n\n        # 2. Compute the exact and Trotter propagators\n        M_exact = expm(-dt * H)\n        M_trot = expm(-dt * H1) @ expm(-dt * H2)\n        \n        # 3. Compute the Frobenius norm of the Trotter error\n        delta_F = np.linalg.norm(M_exact - M_trot, 'fro')\n\n        # 4. Compute the average signs\n        S_exact = sign_metric(M_exact)\n        S_trot = sign_metric(M_trot)\n        \n        case_results = [comm_norm, delta_F, S_exact, S_trot]\n        results.append(case_results)\n\n    # Use standard repr for list to get the format with spaces\n    # and then customize it to match the requested output format exactly.\n    # The default str() for a list already has the desired format.\n    formatted_results = [f\"[{r[0]}, {r[1]}, {r[2]}, {r[3]}]\" for r in results]\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}