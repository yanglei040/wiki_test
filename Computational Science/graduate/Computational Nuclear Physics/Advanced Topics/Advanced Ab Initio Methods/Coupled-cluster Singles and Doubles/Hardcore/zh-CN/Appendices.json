{
    "hands_on_practices": [
        {
            "introduction": "在深入研究耦合簇理论的计算细节之前，首先必须掌握其核心的代数结构。本练习  将引导你通过威克定理（Wick's theorem）来理解为何在多体哈密顿量中使用正规序（normal ordering）是至关重要的，并让你亲自探究耦合簇算符与哈密顿量的对易子会生成何种秩的算符。这不仅是推导耦合簇振幅方程的基础，也为理解该理论的连通图展开（connected-diagram expansion）提供了关键的洞察。",
            "id": "3553610",
            "problem": "考虑一个由正交归一的单粒子轨道构成的闭壳层原子核参考Slater行列式 $|\\Phi\\rangle$，这些轨道构成一个活性单粒子基。设二次量子化形式的核多体哈密顿量包含至多二体相互作用，并以任意算符顺序写为\n$$\n\\hat{H} \\equiv \\sum_{pq} t_{pq}\\, a_{p}^{\\dagger} a_{q} \\;+\\; \\frac{1}{4}\\sum_{pqrs} \\bar{v}_{pqrs}\\, a_{p}^{\\dagger} a_{q}^{\\dagger} a_{s} a_{r},\n$$\n其中 $a_{p}^{\\dagger}$ 和 $a_{q}$ 是产生和湮灭算符，$t_{pq}$ 是单体矩阵元，而 $\\bar{v}_{pqrs}$ 是反对称化的二体矩阵元。相对于参考态 $|\\Phi\\rangle$ 的正规序通过Wick定理定义，该定义与由 $|\\Phi\\rangle$ 的单体密度矩阵所隐含的缩并相关。\n\n您将在耦合簇单双激发（CCSD）的框架内进行计算，其中簇算符在单激发和双激发处截断，\n$$\n\\hat{T} \\equiv \\hat{T}_{1} + \\hat{T}_{2}, \\quad \\hat{T}_{1} = \\sum_{ai} t_{i}^{a}\\, a_{a}^{\\dagger} a_{i}, \\quad \\hat{T}_{2} = \\frac{1}{4}\\sum_{abij} t_{ij}^{ab}\\, a_{a}^{\\dagger} a_{b}^{\\dagger} a_{j} a_{i},\n$$\n其中指标 $i,j,\\ldots$ 表示在 $|\\Phi\\rangle$ 中被占据的轨道，而 $a,b,\\ldots$ 表示未被占据的（虚）轨道。\n\n任务：\n1. 使用相对于 $|\\Phi\\rangle$ 的Wick定理和正规序的定义，论证将 $\\hat{H}$ 分解为相对于 $|\\Phi\\rangle$ 的正规序零体、单体和二体部分的合理性，并从物理上解释为何这种正规序在采用CCSD的核多体计算中具有优势。\n2. 将正规序算符 $\\hat{O}$ 的粒子秩 $r(\\hat{O})$ 定义为其任意单项式中的产生算符数量（该数量等于湮灭算符的数量）。根据此定义，并使用Wick定理所隐含的连通缩并计数法，确定由正规序哈密顿量的单体部分 $\\hat{H}_{1}$ 和二体部分 $\\hat{H}_{2}$ 与 $\\hat{T}_{1}$ 和 $\\hat{T}_{2}$ 构成的下列对易子和双对易子所生成的最大粒子秩：\n$$\n[\\hat{H}_{1}, \\hat{T}_{1}],\\; [\\hat{H}_{1}, \\hat{T}_{2}],\\; [\\hat{H}_{2}, \\hat{T}_{1}],\\; [\\hat{H}_{2}, \\hat{T}_{2}],\n$$\n和\n$$\n[[\\hat{H}_{1}, \\hat{T}_{1}], \\hat{T}_{1}],\\; [[\\hat{H}_{1}, \\hat{T}_{1}], \\hat{T}_{2}],\\; [[\\hat{H}_{1}, \\hat{T}_{2}], \\hat{T}_{1}],\\; [[\\hat{H}_{1}, \\hat{T}_{2}], \\hat{T}_{2}],\n$$\n$$\n[[\\hat{H}_{2}, \\hat{T}_{1}], \\hat{T}_{1}],\\; [[\\hat{H}_{2}, \\hat{T}_{1}], \\hat{T}_{2}],\\; [[\\hat{H}_{2}, \\hat{T}_{2}], \\hat{T}_{1}],\\; [[\\hat{H}_{2}, \\hat{T}_{2}], \\hat{T}_{2}].\n$$\n将您的最终答案表示为一个单行矩阵，其 $12$ 个元素是上述对易子按所列顺序的最大粒子秩。无需单位。答案必须是只产生整数的计算，无需四舍五入。",
            "solution": "这个问题包含两个与核多体理论中的耦合簇单双激发（CCSD）形式论相关的任务。第一个任务是论证哈密顿量正规序的合理性并解释其效用。第二个任务是确定一系列涉及正规序哈密顿量分量和簇算符的对易子的最大粒子秩。\n\n**任务1：正规序哈密顿量及其在CCSD中的优势**\n\n核多体哈密顿量最初以任意算符顺序给出：\n$$\n\\hat{H} \\equiv \\sum_{pq} t_{pq}\\, a_{p}^{\\dagger} a_{q} \\;+\\; \\frac{1}{4}\\sum_{pqrs} \\bar{v}_{pqrs}\\, a_{p}^{\\dagger} a_{q}^{\\dagger} a_{s} a_{r}\n$$\n其中 $p,q,r,s$ 构成一个完备的正交归一单粒子基。相对于参考Slater行列式 $|\\Phi\\rangle$ 的正规序是将任意产生和湮灭算符的乘积重写为一系列项之和的过程，其中每一项都是一个c-数（一个标量）乘以一个正规序的算符乘积。如果所有产生算符都位于所有湮灭算符的左侧，则称算符的乘积处于正规序，记为 $\\{\\ldots\\}$。\n\n这种重写是通过广义Wick定理实现的，该定理指出，任意算符串等于其正规序乘积加上对所有可能的单次、双次及更高阶缩并的求和。两个算符的缩并是它们在参考态中的期望值，这是一个c-数。对于由已占据轨道（指标 $i,j,\\dots$）构成的Slater行列式参考态 $|\\Phi\\rangle$，唯一非零的基本缩并是：\n$$\n\\overline{a_{p}^{\\dagger} a_{q}} = \\langle \\Phi | a_{p}^{\\dagger} a_{q} | \\Phi \\rangle = \\rho_{qp}\n$$\n其中 $\\rho_{qp}$ 是参考态单体密度矩阵的一个元素。如果 $p, q$ 都是已占据轨道，则 $\\rho_{qp} = \\delta_{qp}$，否则为 $0$。\n\n将Wick定理应用于 $\\hat{H}$，可系统地将其分解为正规序分量：\n$1$. **单体项：**\n$$\na_{p}^{\\dagger} a_{q} = \\{a_{p}^{\\dagger} a_{q}\\} + \\overline{a_{p}^{\\dagger} a_{q}} = \\{a_{p}^{\\dagger} a_{q}\\} + \\rho_{qp}\n$$\n对 $p, q$ 求和得到：\n$$\n\\sum_{pq} t_{pq} a_{p}^{\\dagger} a_{q} = \\sum_{pq} t_{pq} \\{a_{p}^{\\dagger} a_{q}\\} + \\sum_{pq} t_{pq} \\rho_{qp} = \\sum_{pq} t_{pq} \\{a_{p}^{\\dagger} a_{q}\\} + \\sum_{i} t_{ii}\n$$\n第一项是一个正规序的单体算符。第二项 $\\sum_{i} t_{ii}$ 是一个标量（一个零体算符）。\n\n$2$. **二体项：**\n乘积 $a_{p}^{\\dagger} a_{q}^{\\dagger} a_{s} a_{r}$ 分解如下：\n$$\na_{p}^{\\dagger} a_{q}^{\\dagger} a_{s} a_{r} = \\{a_{p}^{\\dagger} a_{q}^{\\dagger} a_{s} a_{r}\\} + \\sum_{\\text{1-contractions}} + \\sum_{\\text{2-contractions}}\n$$\n单缩并项在对所有指标求和后，产生一个正规序的单体算符。例如，像 $\\overline{a_p^\\dagger a_r} \\{a_q^\\dagger a_s\\} = \\rho_{rp} \\{a_q^\\dagger a_s\\}$ 这样的项对单体部分有贡献。双缩并项产生一个标量。例如，$(\\overline{a_p^\\dagger a_r}\\overline{a_q^\\dagger a_s} - \\overline{a_p^\\dagger a_s}\\overline{a_q^\\dagger a_r}) = (\\rho_{rp}\\rho_{sq} - \\rho_{sp}\\rho_{rq})$ 对零体部分有贡献。\n\n收集所有具有相同数量未缩并算符（即相同粒子秩）的项，哈密顿量可以写成正规序形式：\n$$\n\\hat{H} = H_{0} + \\hat{H}_{1} + \\hat{H}_{2}\n$$\n其中：\n- $H_{0} = \\langle \\Phi | \\hat{H} | \\Phi \\rangle$ 是标量参考能量（零体部分）。\n- $\\hat{H}_{1} = \\sum_{pq} f_{pq} \\{a_{p}^{\\dagger} a_{q}\\}$ 是正规序单体部分，其中 $f_{pq}$ 是Fock矩阵元，包含了来自 $t_{pq}$ 和 $\\bar{v}_{pqrs}$ 缩并的贡献。\n- $\\hat{H}_{2} = \\frac{1}{4} \\sum_{pqrs} \\bar{v}_{pqrs} \\{a_{p}^{\\dagger} a_{q}^{\\dagger} a_{s} a_{r}\\}$ 是正规序二体部分（因为 $\\bar{v}$ 是反对称的，其内部的缩并不会存在）。\n\n这种正规序在CCSD计算中的**物理优势**是深远的：\n首先，它将总能量分离为参考能量 $H_0$ 和关联能。问题简化为从正规序哈密顿量 $\\hat{H}_N = \\hat{H}_1 + \\hat{H}_2$ 中寻找关联能。\n其次，也是最重要的一点，参考态 $|\\Phi\\rangle$ 对于正规序算符来说充当了真正的真空，这意味着任何非标量的正规序算符相对于 $|\\Phi\\rangle$ 的期望值都为零。例如，$\\langle \\Phi | \\{a_{p}^{\\dagger} a_{q}\\} | \\Phi \\rangle = 0$。簇算符 $\\hat{T}_1$ 和 $\\hat{T}_2$ 本身被定义为正规序的粒子-空穴激发算符。这个性质极大地简化了耦合簇方程。核心的CC能量和振幅方程是通过对相似变换后的哈密顿量 $\\bar{H} = e^{-\\hat{T}} \\hat{H} e^{\\hat{T}}$ 进行投影得到的：\n$$\nE_{\\text{corr}} = \\langle \\Phi | \\bar{H}_N | \\Phi \\rangle = \\langle \\Phi | (\\hat{H}_N e^{\\hat{T}})_C | \\Phi \\rangle\n$$\n$$\n0 = \\langle \\Phi_{\\mu} | \\bar{H}_N | \\Phi \\rangle = \\langle \\Phi_{\\mu} | (\\hat{H}_N e^{\\hat{T}})_C | \\Phi \\rangle\n$$\n其中 $|\\Phi_{\\mu}\\rangle$ 是激发行列式，下标 $C$ 表示只有连通图（项）有贡献。正是正规序的使用确保了关联图定理的成立，从而导出了仅含连通项的展开。使用Wick定理计算右侧的矩阵元被大大简化，因为任何未完全缩并的项（即，结果不是标量）都会消失，这极大地减少了需要计算的项数，并确保了尺度广延性。\n\n**任务2：对易子的最大粒子秩**\n\n正规序算符 $\\hat{O}$ 的粒子秩 $r(\\hat{O})$ 是它包含的产生算符的数量。所涉及的算符具有以下秩：\n- $\\hat{H}_{1}$：单体算符，$r(\\hat{H}_{1}) = 1$。\n- $\\hat{H}_{2}$：二体算符，$r(\\hat{H}_{2}) = 2$。\n- $\\hat{T}_{1}$：单粒子-单空穴（$1p1h$）激发算符，$r(\\hat{T}_{1}) = 1$。\n- $\\hat{T}_{2}$：双粒子-双空穴（$2p2h$）激发算符，$r(\\hat{T}_{2}) = 2$。\n\n两个正规序算符 $\\hat{A}$ 和 $\\hat{B}$ 的对易子可以使用Wick定理进行评估。乘积 $\\hat{A}\\hat{B}$ 是正规序乘积 $\\{\\hat{A}\\hat{B}\\}$ 与带有一个或多个 $\\hat{A}$ 和 $\\hat{B}$ 之间算符缩并的项之和。由于 $\\{\\hat{A}\\hat{B}\\} = \\{\\hat{B}\\hat{A}\\}$（因为两个算符都含有偶数个费米子），这些部分在对易子 $[\\hat{A}, \\hat{B}] = \\hat{A}\\hat{B} - \\hat{B}\\hat{A}$ 中相互抵消。结果是源于至少一次缩并的项之和。\n\n单次缩并会使产生算符的总数减一，湮灭算符的总数减一，从而使粒子秩减一。所得算符的最大可能秩对应于产生非零结果所需的最小连接数。对于指定的“连通缩并计数法”：\n- 单一对易子 $[\\hat{A}, \\hat{B}]$ 的最大粒子秩由带一次缩并的项生成。其秩为 $r([\\hat{A}, \\hat{B}])_{\\text{max}} = r(\\hat{A}) + r(\\hat{B}) - 1$。\n- 双对易子 $[[\\hat{A}, \\hat{B}], \\hat{C}]$ 的最大粒子秩由所有三个算符都连通的项生成，这至少需要两次缩并。其秩为 $r([[\\hat{A}, \\hat{B}], \\hat{C}])_{\\text{max}} = r(\\hat{A}) + r(\\hat{B}) + r(\\hat{C}) - 2$。\n\n使用这些规则，我们计算每个指定对易子的最大粒子秩。\n\n**单对易子：**\n$1$. $[\\hat{H}_{1}, \\hat{T}_{1}]$: $r(\\hat{H}_{1}) + r(\\hat{T}_{1}) - 1 = 1 + 1 - 1 = 1$。\n$2$. $[\\hat{H}_{1}, \\hat{T}_{2}]$: $r(\\hat{H}_{1}) + r(\\hat{T}_{2}) - 1 = 1 + 2 - 1 = 2$。\n$3$. $[\\hat{H}_{2}, \\hat{T}_{1}]$: $r(\\hat{H}_{2}) + r(\\hat{T}_{1}) - 1 = 2 + 1 - 1 = 2$。\n$4$. $[\\hat{H}_{2}, \\hat{T}_{2}]$: $r(\\hat{H}_{2}) + r(\\hat{T}_{2}) - 1 = 2 + 2 - 1 = 3$。\n\n**双对易子：**\n$5$. $[[\\hat{H}_{1}, \\hat{T}_{1}], \\hat{T}_{1}]$: $r(\\hat{H}_{1}) + r(\\hat{T}_{1}) + r(\\hat{T}_{1}) - 2 = 1 + 1 + 1 - 2 = 1$。\n$6$. $[[\\hat{H}_{1}, \\hat{T}_{1}], \\hat{T}_{2}]$: $r(\\hat{H}_{1}) + r(\\hat{T}_{1}) + r(\\hat{T}_{2}) - 2 = 1 + 1 + 2 - 2 = 2$。\n$7$. $[[\\hat{H}_{1}, \\hat{T}_{2}], \\hat{T}_{1}]$: $r(\\hat{H}_{1}) + r(\\hat{T}_{2}) + r(\\hat{T}_{1}) - 2 = 1 + 2 + 1 - 2 = 2$。\n$8$. $[[\\hat{H}_{1}, \\hat{T}_{2}], \\hat{T}_{2}]$: $r(\\hat{H}_{1}) + r(\\hat{T}_{2}) + r(\\hat{T}_{2}) - 2 = 1 + 2 + 2 - 2 = 3$。\n$9$. $[[\\hat{H}_{2}, \\hat{T}_{1}], \\hat{T}_{1}]$: $r(\\hat{H}_{2}) + r(\\hat{T}_{1}) + r(\\hat{T}_{1}) - 2 = 2 + 1 + 1 - 2 = 2$。\n$10$. $[[\\hat{H}_{2}, \\hat{T}_{1}], \\hat{T}_{2}]$: $r(\\hat{H}_{2}) + r(\\hat{T}_{1}) + r(\\hat{T}_{2}) - 2 = 2 + 1 + 2 - 2 = 3$。\n$11$. $[[\\hat{H}_{2}, \\hat{T}_{2}], \\hat{T}_{1}]$: $r(\\hat{H}_{2}) + r(\\hat{T}_{2}) + r(\\hat{T}_{1}) - 2 = 2 + 2 + 1 - 2 = 3$。\n$12$. $[[\\hat{H}_{2}, \\hat{T}_{2}], \\hat{T}_{2}]$: $r(\\hat{H}_{2}) + r(\\hat{T}_{2}) + r(\\hat{T}_{2}) - 2 = 2 + 2 + 2 - 2 = 4$。\n\n这 $12$ 个对易子的最大粒子秩序列为 $\\{1, 2, 2, 3, 1, 2, 2, 3, 2, 3, 3, 4\\}$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1  2  2  3  1  2  2  3  2  3  3  4\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "掌握了耦合簇理论的代数基础后，下一步是思考如何高效地实现这些复杂的方程。直接计算耦合簇单双激发（CCSD）的剩余方程会导致极高的计算成本，限制了其在较大核体系中的应用。本练习  介绍了一种关键的优化技术——构造中间量（intermediates），通过预先计算和存储特定的算符组合，可以有效地分解计算步骤，从而显著降低算法的标度行为（scaling behavior）。",
            "id": "3553631",
            "problem": "考虑一个在自洽平均场计算得到的单粒子基中描述的闭壳层原子核。多体哈密顿量相对于平均场斯莱特行列式参考态进行正规排序，并包含单体和反对称化的双体部分。设反对称化的双体矩阵元表示为 $\\langle pq||rs\\rangle$，其中 $p,q,r,s$ 标记广义的单粒子态。在截断至单激发和双激发的耦合簇方法（Coupled-Cluster Singles and Doubles, CCSD）中，簇算符为 $T=T_{1}+T_{2}$，其中 $T_{1}=\\sum_{i,a}t_{i}^{a}a_{a}^{\\dagger}a_{i}$ 且 $T_{2}=\\frac{1}{4}\\sum_{i,j,a,b}t_{ij}^{ab}a_{a}^{\\dagger}a_{b}^{\\dagger}a_{j}a_{i}$，其中索引 $i,j,k,\\dots$ 表示占据轨道，而 $a,b,c,\\dots$ 表示未占据轨道。\n\n相似变换后的哈密顿量为 $\\bar{H}=\\exp(-T)H\\exp(T)$，双激发余量 $R_{ij}^{ab}$ 通过将 $\\bar{H}$ 投影到双激发行列式上获得，$R_{ij}^{ab}=\\langle \\Phi_{ij}^{ab}|\\bar{H}|\\Phi_{0}\\rangle$，其中 $|\\Phi_{0}\\rangle$ 是参考态，且 $|\\Phi_{ij}^{ab}\\rangle=a_{a}^{\\dagger}a_{b}^{\\dagger}a_{j}a_{i}|\\Phi_{0}\\rangle$。\n\n- 任务1：从 $\\bar{H}$ 的 Baker–Campbell–Hausdorff 展开式和 CCSD 截斷出发，通过收集所有由反对称化的双体相互作用 $\\langle pq||rs\\rangle$ 与单激发振幅 $t_{i}^{a}$ 的单次收缩形成的对双激发余量的贡献，构建一个标准的双体“缀饰相互作用”中间量 $W_{ij}^{ab}$。明确写出 $W_{ij}^{ab}$ 的表达式，直到并包括单激发振幅 $t_{i}^{a}$ 的线性阶，在需要时使用排列反对称化算符 $P(ij)$ 和 $P(ab)$ 来强制占据和非占索引对的反对称性。\n\n- 任务2：使用任务1中的中间量 $W_{ij}^{ab}$，将双激发余量 $R_{ij}^{ab}$ 中包含这些线性于单激发的双体贡献的部分，完全用 $W_{ij}^{ab}$ 来重写，在余量表达式中不含任何对占据或非占索引的显式内部求和。\n\n- 任务3：令 $n_{o}$ 为占据单粒子态的数量，$n_{v}$ 为非占单粒子态的数量。通过计算索引循环，确定以两种方式计算所有 $\\{i,j,a,b\\}$ 的 $R_{ij}^{ab}$ 中此线性于单激发的双体贡献所需的主要阶计算标度（以大$\\mathcal{O}$表示法）：(i) 当通过在 $R_{ij}^{ab}$ 中直接对每个四元组 $(i,j,a,b)$ 进行内部求和来天真地计算时，以及 (ii) 当使用任务1中预先计算的 $W_{ij}^{ab}$ 进行计算时。将情况 (ii) 的简化标度作为最终答案。\n\n将您的最终标度以大$\\mathcal{O}$表示法表示为单个解析表达式。不需要进行数值评估。",
            "solution": "此问题要求在耦合簇单双激发（CCSD）振幅方程中推导和分析特定项。任务涉及使用二次量子化、图解概念以及计算复杂性分析进行代数操作。\n\n### 问题验证\n问题陈述具有科学依据，提法恰当且客观。它基于标准的、无争议的耦合簇理论，这是计算量子物理和化学中的一种基本方法。所有变量、算符和目标都使用该领域的标准术语定义。任务具体，并导向一个唯一的、可验证的解。此问题被判定为**有效**。\n\n### 任务1：中间量 $W_{ij}^{ab}$ 的构建\n\n双激发余量 $R_{ij}^{ab}$ 由 $R_{ij}^{ab} = \\langle \\Phi_{ij}^{ab} | \\bar{H} | \\Phi_0 \\rangle$ 给出，其中 $\\bar{H} = \\exp(-T)H\\exp(T)$ 且 $|\\Phi_0\\rangle$ 是参考斯莱特行列式。所要求的对 $R_{ij}^{ab}$ 的贡献是那些单激发振幅 $t_k^c$ 的线性项，且涉及哈密顿量的双体相互作用部分 $V_N$。这些项源于 Baker-Campbell-Hausdorff (BCH) 展开式中 $V_N$ 与单激发簇算符 $T_1$ 的单次对易子：\n$$\n\\bar{H} = H + [H, T] + \\frac{1}{2}[[H, T], T] + \\dots\n$$\n$\\bar{H}$ 中包含 $T_1$ 线性项并涉及 $V_N$ 的相关部分是 $[V_N, T_1]$。因此，对余量的贡献是 $\\langle \\Phi_{ij}^{ab} | [V_N, T_1] | \\Phi_0 \\rangle$。\n\n由于 $V_N$ 是一个粒子数守恒的双体算符（在其正规排序形式中，它最多能改变两个粒子和两个空穴），$V_N|\\Phi_0\\rangle$ 最多包含双激发行列式。算符 $T_1 = \\sum_{k,c} t_k^c a_c^\\dagger a_k$ 在向左作用时是一个退激发算符。因此，项 $\\langle \\Phi_{ij}^{ab} | T_1 V_N | \\Phi_0 \\rangle$ 为零，因为 $T_1$ 无法将一个最多有两次激发的状态退激发到一个特定的四次激发状态（相对于被 $\\langle \\Phi_{ij}^{ab} |$ 湮灭的状态）。\n\n我们剩下需要计算 $\\langle \\Phi_{ij}^{ab} | V_N T_1 | \\Phi_0 \\rangle$。\n$$\n\\langle \\Phi_{ij}^{ab} | V_N T_1 | \\Phi_0 \\rangle = \\sum_{k,c} t_k^c \\langle \\Phi_{ij}^{ab} | V_N | \\Phi_k^c \\rangle\n$$\n其中 $|\\Phi_k^c \\rangle = a_c^\\dagger a_k |\\Phi_0\\rangle$。使用威克定理或图解技术计算矩阵元 $\\langle \\Phi_{ij}^{ab} | V_N | \\Phi_k^c \\rangle$ 会产生四种类型的非零贡献，这对应于通过双体相互作用顶点 $V_N$ 连接外部线 $\\{i, j, a, b\\}$ 和 $\\{k, c\\}$。这些是CCSD双激发振幅方程中的标准项：\n\n1.  来自相互作用的 $V_{hvvv}$ 部分（一个空穴，三个粒子）的贡献：$\\sum_c t_i^c \\langle cj || ab \\rangle$。关于占据指数 $i$ 和 $j$ 进行反对称化后，得到 $P(ij) \\sum_c t_i^c \\langle cj || ab \\rangle = \\sum_c t_i^c \\langle cj || ab \\rangle - \\sum_c t_j^c \\langle ci || ab \\rangle$。\n2.  来自相互作用的 $V_{ohho}$ 部分（一个粒子，三个空穴）的贡献：$-\\sum_k t_k^a \\langle ik || jb \\rangle$。关于非占指数 $a$ 和 $b$ 进行反对称化后，得到 $-P(ab) \\sum_k t_k^a \\langle ik || jb \\rangle = - \\sum_k t_k^a \\langle ik || jb \\rangle + \\sum_k t_k^b \\langle ik || ja \\rangle$。\n\n排列算符 $P(pq)$ 定义为 $P(pq)f(p,q) = f(p,q) - f(q,p)$。\n\n“缀饰相互作用”中间量 $W_{ij}^{ab}$ 是通过收集所有这些贡献形成的：\n$$\nW_{ij}^{ab} = P(ij) \\sum_c t_i^c \\langle cj || ab \\rangle - P(ab) \\sum_k t_k^a \\langle ik || jb \\rangle\n$$\n展开排列算符得到四个不同的项：\n$$\nW_{ij}^{ab} = \\left( \\sum_c t_i^c \\langle cj || ab \\rangle - \\sum_c t_j^c \\langle ci || ab \\rangle \\right) - \\left( \\sum_k t_k^a \\langle ik || jb \\rangle - \\sum_k t_k^b \\langle ik || ja \\rangle \\right)\n$$\n\n### 任务2：重写余量贡献\n\n任务1将中间量 $W_{ij}^{ab}$ 定义为所有线性于 $T_1$ 的双体贡献的集合，这些贡献作用于双激发余量。任务2要求将余量的这一部分（我们表示为 $\\Delta R_{ij}^{ab}(V, T_1)$）用 $W_{ij}^{ab}$ 来表示。根据任务1中的构建，这是一个直接的替换。$W_{ij}^{ab}$ 的表达式已经包含了对空穴指数 $k$ 和粒子指数 $c$ 的内部求和。通过预先计算整个 $W_{ij}^{ab}$ 张量，它对完整余量 $R_{ij}^{ab}$ 的贡献仅仅是一个加法。\n$$\n\\Delta R_{ij}^{ab}(V, T_1) = W_{ij}^{ab}\n$$\n这种表述满足了余量表达式本身不包含显式内部求和的要求，因为这些求和已经包含在中间量 $W_{ij}^{ab}$ 的定义和计算中。\n\n### 任务3：计算标度分析\n\n令 $n_o$ 为占据态的数量，$n_v$ 为非占态的数量。计算标度通过计算浮点运算的次数来估计，这由直接实现中的嵌套循环数决定。\n\n**(i) 天真计算：**\n在天真计算中，对每个特定余量元素 $R_{ij}^{ab}$ 的贡献是通过对 $n_o^2 n_v^2$ 个四元组 $(i,j,a,b)$中的每一个直接执行对 $k$ 和 $c$ 的求和来计算的。\n\n*   考虑项 $\\sum_c t_i^c \\langle cj || ab \\rangle$：对于每个 $(i,j,a,b)$，这需要对 $n_v$ 个元素求和。在所有余量中，这类项（包括置换部分）的总成本与 $n_o^2 \\times n_v^2 \\times n_v = n_o^2 n_v^3$ 成正比。\n*   考虑项 $\\sum_k t_k^a \\langle ik || jb \\rangle$：对于每个 $(i,j,a,b)$，这需要对 $n_o$ 个元素求和。在所有余量中，这类项（包括置换部分）的总成本与 $n_o^2 \\times n_v^2 \\times n_o = n_o^3 n_v^2$ 成正比。\n\n天真计算的总标度是这些成本之和，由最昂贵的步骤主导：\n$$\n\\mathcal{O}_{\\text{naive}} = \\mathcal{O}(n_o^2 n_v^3 + n_o^3 n_v^2)\n$$\n\n**(ii) 使用预计算的中间量 $W_{ij}^{ab}$ 进行计算：**\n这种方法意味着一个两阶段过程。首先，计算并存储整个张量 $W_{ij}^{ab}$。其次，使用这个预计算的张量来更新完整的余量张量 $R_{ij}^{ab}$。\n\n1.  **$W_{ij}^{ab}$ 的计算：** 计算 $W_{ij}^{ab}$ 张量所有元素的成本与天真计算的成本相同，因为它涉及完全相同的求和：$\\mathcal{O}(n_o^2 n_v^3 + n_o^3 n_v^2)$。\n2.  **$W_{ij}^{ab}$ 的使用：** 一旦 $W_{ij}^{ab}$ 完全计算完毕，“计算”对余量的贡献就仅仅意味着将 $W_{ij}^{ab}$ 的元素加到 $R_{ij}^{ab}$ 的相应元素上。这是一个张量加法：$R \\leftarrow R + W$。此操作需要对所有四个指数 $i, j, a, b$ 进行一次循环，没有内部求和。\n\n第二步的成本由张量的大小决定，即 $n_o^2 n_v^2$。\n\n问题要求的是“情况 (ii) 的简化标度”。这个措辞被理解为要求给出通过预计算中间量而简化的那部分算法的标度。虽然整个过程的成本由 $W_{ij}^{ab}$ 的计算主导，但*使用*预计算的中间量来组装最终余量的步骤，其标度相比于天真的、一体化的计算有所降低。这个简化的标度对应于最终张量加法的成本。\n\n从预计算的中间量组装余量的简化标度是：\n$$\n\\mathcal{O}_{\\text{reduced}} = \\mathcal{O}(n_o^2 n_v^2)\n$$\n这是最后更新步骤的标度，它显著低于对每个余量元素直接、未分解地计算贡献的标度。",
            "answer": "$$\n\\boxed{\\mathcal{O}(n_o^2 n_v^2)}\n$$"
        },
        {
            "introduction": "理论计算的最终目标之一是与实验测量进行比较，从而检验我们对物理规律的理解。本练习  将展示如何将耦合簇理论的计算结果与真实的物理可观测量联系起来。你将学习如何利用从CCSD计算中获得的单体密度矩阵，结合必要的物理修正（如质心运动、核子有限大小等），来计算一个基本且重要的核性质——电荷半径。",
            "id": "3553638",
            "problem": "给你一个公式化任务，该任务坚实地植根于应用于耦合簇单双激发（CCSD）的原子核结构多体理论。从基本定义和经过充分检验的公式出发，设计并实现一个算法，该算法利用谐振子单粒子基中的 CCSD 单体质子密度来计算核电荷半径。你的程序必须为一小组测试用例输出以飞米（fm）为单位的电荷半径。\n\n从以下基本依据开始。\n\n- 均方电荷半径定义为内禀电荷密度算符的基态期望值。对于一个质子数为 $Z$，中子数为 $N$，质量数为 $A = Z + N$ 的原子核，其均方电荷半径为\n$$\nr_{\\mathrm{ch}}^2 \\equiv \\frac{1}{Z}\\sum_{i \\in p} \\left\\langle \\left(\\mathbf{r}_i - \\mathbf{R}_{\\mathrm{cm}}\\right)^2 \\right\\rangle + \\Delta_{\\mathrm{em}},\n$$\n其中 $\\mathbf{R}_{\\mathrm{cm}}$ 是所有 $A$ 个核子的质心坐标算符，而 $\\Delta_{\\mathrm{em}}$ 汇集了电磁和相对论有效算符的贡献。\n\n- 在耦合簇单双激发（CCSD）中，单体算符 $\\hat{O}$ 的期望值由 CCSD 单体密度矩阵 $\\gamma$ 与该算符在所选单粒子基中的单体矩阵表示 $O$ 的乘积的迹给出，\n$$\n\\langle \\hat{O} \\rangle = \\mathrm{Tr}\\left(\\gamma \\, O\\right).\n$$\n对于实验室坐标系中的点质子均方半径，这给出\n$$\nr_{pp,\\mathrm{lab}}^2 = \\frac{1}{Z}\\mathrm{Tr}\\left(\\gamma^{(p)} \\, R^2\\right),\n$$\n其中 $\\gamma^{(p)}$ 是质子部分的 CCSD 单体密度矩阵，而 $R^2$ 是算符 $\\hat{r}^{\\,2}$ 在该基中的单体矩阵。\n\n- 在振子长度为 $b$ 的谐振子基中，假设基态可以分解为一个内禀部分和一个 $0s$ 质心部分，质心均方半径的期望值为\n$$\n\\left\\langle R_{\\mathrm{cm}}^2 \\right\\rangle = \\frac{3 b^2}{2 A}.\n$$\n使用此公式从 $r_{pp,\\mathrm{lab}}^2$ 获得内禀点质子均方半径 $r_{pp}^2$。\n\n- 所需的电磁和相对论修正包括主要的质子有限大小修正 $R_p^2$、乘以因子 $N/Z$ 的中子均方电荷半径 $R_n^2$、达尔文-福尔迪项 $r_{\\mathrm{DF}}^2$ 以及自旋-轨道修正 $r_{\\mathrm{SO}}^2$。这些修正定义了\n$$\n\\Delta_{\\mathrm{em}} = R_p^2 + \\frac{N}{Z} R_n^2 + r_{\\mathrm{DF}}^2 + r_{\\mathrm{SO}}^2.\n$$\n\n你的任务是为以下每个测试用例计算以飞米为单位的电荷半径 $r_{\\mathrm{ch}}$，仅使用上述物理上合理的出发点，不作任何其他假设。在所有情况下，单体密度矩阵 $\\gamma^{(p)}$ 是厄米矩阵，其迹等于 $Z$。单体算符矩阵 $R^2$ 是实对称矩阵，其元素单位为 $\\mathrm{fm}^2$。谐振子长度 $b$ 的单位是 $\\mathrm{fm}$，且 $R_p^2$、$R_n^2$、$r_{\\mathrm{DF}}^2$ 和 $r_{\\mathrm{SO}}^2$ 的单位是 $\\mathrm{fm}^2$。每个用例的最终答案必须是以 $\\mathrm{fm}$ 为单位的电荷半径 $r_{\\mathrm{ch}}$，四舍五入到 $6$ 位小数。\n\n需要实现的测试套件：\n\n- 用例 1：\n  - $A = 16$, $Z = 8$, $N = 8$, $b = 1.76$。\n  - $\\gamma^{(p)} = \\begin{bmatrix} 6.8  0.1 \\\\ 0.1  1.2 \\end{bmatrix}$。\n  - $R^2 = \\begin{bmatrix} 5.0  0.2 \\\\ 0.2  7.0 \\end{bmatrix}$。\n  - $R_p^2 = 0.770$, $R_n^2 = -0.1161$, $r_{\\mathrm{DF}}^2 = 0.033$, $r_{\\mathrm{SO}}^2 = -0.080$。\n\n- 用例 2：\n  - $A = 40$, $Z = 20$, $N = 20$, $b = 1.97$。\n  - $\\gamma^{(p)} = \\begin{bmatrix} 10.0  0.2  0.0 \\\\ 0.2  8.5  0.1 \\\\ 0.0  0.1  1.5 \\end{bmatrix}$。\n  - $R^2 = \\begin{bmatrix} 5.5  0.1  0.0 \\\\ 0.1  8.0  0.2 \\\\ 0.0  0.2  10.5 \\end{bmatrix}$。\n  - $R_p^2 = 0.770$, $R_n^2 = -0.1161$, $r_{\\mathrm{DF}}^2 = 0.033$, $r_{\\mathrm{SO}}^2 = -0.050$。\n\n- 用例 3：\n  - $A = 4$, $Z = 2$, $N = 2$, $b = 1.40$。\n  - $\\gamma^{(p)} = \\begin{bmatrix} 2.0 \\end{bmatrix}$。\n  - $R^2 = \\begin{bmatrix} 2.94 \\end{bmatrix}$。\n  - $R_p^2 = 0.770$, $R_n^2 = -0.1161$, $r_{\\mathrm{DF}}^2 = 0.033$, $r_{\\mathrm{SO}}^2 = 0.000$。\n\n- 用例 4：\n  - $A = 48$, $Z = 20$, $N = 28$, $b = 2.00$。\n  - $\\gamma^{(p)} = \\begin{bmatrix} 15.5  -0.3 \\\\ -0.3  4.5 \\end{bmatrix}$。\n  - $R^2 = \\begin{bmatrix} 5.6  0.15 \\\\ 0.15  9.5 \\end{bmatrix}$。\n  - $R_p^2 = 0.770$, $R_n^2 = -0.1161$, $r_{\\mathrm{DF}}^2 = 0.033$, $r_{\\mathrm{SO}}^2 = -0.060$。\n\n实现和输出要求：\n\n- 对每个用例，根据上述基本定义计算以 $\\mathrm{fm}$ 为单位的电荷半径 $r_{\\mathrm{ch}}$。仅使用给定的数据和标准的线性代数运算。\n- 你的程序必须生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，例如 $[x_1,x_2,x_3,x_4]$，其中每个 $x_i$ 是用例 $i$ 的电荷半径（单位为 $\\mathrm{fm}$），四舍五入到 $6$ 位小数。",
            "solution": "该问题是有效的，因为它科学地基于原子核多体理论的原理，特别是耦合簇理论，并为计算核电荷半径提供了一套适定、客观和完整的数据与定义。所有提供的方程和常数在计算核物理领域都是标准的。\n\n目标是为几个测试用例计算核电荷半径 $r_{\\mathrm{ch}}$。计算过程是通过确定均方电荷半径 $r_{\\mathrm{ch}}^2$ 来进行的，然后通过取其平方根得到 $r_{\\mathrm{ch}}$。\n\n均方电荷半径定义为内禀点质子均方半径（此处表示为 $r_{pp}^2$）与一组电磁和相对论修正 $\\Delta_{\\mathrm{em}}$ 的和：\n$$\nr_{\\mathrm{ch}}^2 = r_{pp}^2 + \\Delta_{\\mathrm{em}}\n$$\n其中 $r_{pp}^2 = \\frac{1}{Z}\\sum_{i \\in p} \\left\\langle \\left(\\mathbf{r}_i - \\mathbf{R}_{\\mathrm{cm}}\\right)^2 \\right\\rangle$。计算 $r_{\\mathrm{ch}}^2$ 的算法可以分解为以下步骤：\n\n1.  **计算实验室坐标系中的点质子均方半径 ($r_{pp,\\mathrm{lab}}^2$)**：\n    在实验室坐标系中，半径平方算符的期望值是使用给定的耦合簇单双激发（CCSD）单体质子密度矩阵 $\\gamma^{(p)}$ 和位置平方算符的矩阵表示 $R^2$ 来计算的。公式为：\n    $$\n    r_{pp,\\mathrm{lab}}^2 = \\frac{1}{Z}\\mathrm{Tr}\\left(\\gamma^{(p)} R^2\\right)\n    $$\n    其中 $Z$ 是质子数，$\\mathrm{Tr}(M)$ 表示矩阵 $M$ 的迹。矩阵乘积 $\\gamma^{(p)} R^2$ 的迹计算为 $\\sum_i \\sum_j (\\gamma^{(p)})_{ij} (R^2)_{ji}$。\n\n2.  **计算质心（CM）贡献 ($\\langle R_{\\mathrm{cm}}^2 \\rangle$)**：\n    质心的运动对实验室坐标系中的半径有贡献。为了获得内禀半径，必须移除这种效应。使用为谐振子基提供的公式，质心坐标平方的期望值为：\n    $$\n    \\left\\langle R_{\\mathrm{cm}}^2 \\right\\rangle = \\frac{3 b^2}{2 A}\n    $$\n    其中 $b$ 是谐振子长度，$A$ 是核子总数。\n\n3.  **计算内禀点质子均方半径 ($r_{pp}^2$)**：\n    内禀半径是通过从实验室坐标系半径中减去质心贡献得到的。当使用不能分离质心坐标和内禀坐标的基组时，这种修正是核结构计算中的标准程序。\n    $$\n    r_{pp}^2 = r_{pp,\\mathrm{lab}}^2 - \\left\\langle R_{\\mathrm{cm}}^2 \\right\\rangle\n    $$\n\n4.  **计算电磁和相对论修正 ($\\Delta_{\\mathrm{em}}$)**：\n    测量的电荷半径并不仅仅由点状质子的空间分布决定。其他几种效应也有贡献，这些效应被收集在 $\\Delta_{\\mathrm{em}}$ 项中。其中包括质子的有限大小（$R_p^2$）、中子的电荷分布（$R_n^2$），以及相对论效应，即达尔文-福尔迪（$r_{\\mathrm{DF}}^2$）和自旋-轨道（$r_{\\mathrm{SO}}^2$）项。总修正由以下公式给出：\n    $$\n    \\Delta_{\\mathrm{em}} = R_p^2 + \\frac{N}{Z} R_n^2 + r_{\\mathrm{DF}}^2 + r_{\\mathrm{SO}}^2\n    $$\n    其中 $N$ 是中子数。\n\n5.  **计算最终电荷半径 ($r_{\\mathrm{ch}}$)**：\n    通过将内禀点质子均方半径和各项修正相加，我们得到总的均方电荷半径：\n    $$\n    r_{\\mathrm{ch}}^2 = r_{pp}^2 + \\Delta_{\\mathrm{em}} = \\left( \\frac{1}{Z}\\mathrm{Tr}\\left(\\gamma^{(p)} R^2\\right) - \\frac{3 b^2}{2 A} \\right) + \\left( R_p^2 + \\frac{N}{Z} R_n^2 + r_{\\mathrm{DF}}^2 + r_{\\mathrm{SO}}^2 \\right)\n    $$\n    电荷半径是该值的平方根：\n    $$\n    r_{\\mathrm{ch}} = \\sqrt{r_{\\mathrm{ch}}^2}\n    $$\n将此计算序列应用于每个测试用例，使用所提供的数据。每个用例的最终结果四舍五入到 $6$ 位小数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the nuclear charge radius from CCSD one-body proton densities\n    in a harmonic-oscillator single-particle basis for a set of test cases.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"A\": 16, \"Z\": 8, \"N\": 8, \"b\": 1.76,\n            \"gamma_p\": np.array([[6.8, 0.1], [0.1, 1.2]]),\n            \"R2\": np.array([[5.0, 0.2], [0.2, 7.0]]),\n            \"R_p_sq\": 0.770, \"R_n_sq\": -0.1161, \"r_DF_sq\": 0.033, \"r_SO_sq\": -0.080,\n        },\n        {\n            \"A\": 40, \"Z\": 20, \"N\": 20, \"b\": 1.97,\n            \"gamma_p\": np.array([[10.0, 0.2, 0.0], [0.2, 8.5, 0.1], [0.0, 0.1, 1.5]]),\n            \"R2\": np.array([[5.5, 0.1, 0.0], [0.1, 8.0, 0.2], [0.0, 0.2, 10.5]]),\n            \"R_p_sq\": 0.770, \"R_n_sq\": -0.1161, \"r_DF_sq\": 0.033, \"r_SO_sq\": -0.050,\n        },\n        {\n            \"A\": 4, \"Z\": 2, \"N\": 2, \"b\": 1.40,\n            \"gamma_p\": np.array([[2.0]]),\n            \"R2\": np.array([[2.94]]),\n            \"R_p_sq\": 0.770, \"R_n_sq\": -0.1161, \"r_DF_sq\": 0.033, \"r_SO_sq\": 0.000,\n        },\n        {\n            \"A\": 48, \"Z\": 20, \"N\": 28, \"b\": 2.00,\n            \"gamma_p\": np.array([[15.5, -0.3], [-0.3, 4.5]]),\n            \"R2\": np.array([[5.6, 0.15], [0.15, 9.5]]),\n            \"R_p_sq\": 0.770, \"R_n_sq\": -0.1161, \"r_DF_sq\": 0.033, \"r_SO_sq\": -0.060,\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        # Unpack variables for clarity\n        A, Z, N = case[\"A\"], case[\"Z\"], case[\"N\"]\n        b = case[\"b\"]\n        gamma_p = case[\"gamma_p\"]\n        R2 = case[\"R2\"]\n        R_p_sq, R_n_sq, r_DF_sq, r_SO_sq = case[\"R_p_sq\"], case[\"R_n_sq\"], case[\"r_DF_sq\"], case[\"r_SO_sq\"]\n\n        # Step 1: Calculate the lab-frame point-proton mean-square radius\n        # Tr(gamma * R^2) can be calculated as Tr(gamma @ R2)\n        tr_gamma_R2 = np.trace(gamma_p @ R2)\n        r_pp_lab_sq = tr_gamma_R2 / Z\n\n        # Step 2: Calculate the center-of-mass contribution\n        r_cm_sq = (3 * b**2) / (2 * A)\n\n        # Step 3: Calculate the intrinsic point-proton mean-square radius\n        r_pp_sq = r_pp_lab_sq - r_cm_sq\n\n        # Step 4: Calculate the electromagnetic and relativistic corrections\n        delta_em = R_p_sq + (N / Z) * R_n_sq + r_DF_sq + r_SO_sq\n\n        # Step 5: Calculate the total mean-square charge radius and the charge radius\n        r_ch_sq = r_pp_sq + delta_em\n        r_ch = np.sqrt(r_ch_sq)\n        \n        # Append the result rounded to 6 decimal places\n        results.append(round(r_ch, 6))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}