{
    "hands_on_practices": [
        {
            "introduction": "复共振能量 $E = E_r - i\\Gamma/2$ 的虚部是如何决定一个量子态寿命的？本练习将引导你从第一性原理出发，利用复标度方法 (Complex Scaling Method, CSM) 中的谱形变技术，严格推导出指数衰减定律。通过这个过程，你将深刻理解复能量极点与物理衰减现象之间的直接联系，这是掌握该方法的核心。",
            "id": "3596818",
            "problem": "一个约化质量为 $\\mu$ 的单中子在一个支持s波共振的短程球对称核光学势 $V(r)$ 中运动。在复数标度方法（CSM）中，我们应用一个旋转角为 $\\theta \\in (0,\\theta_{\\max})$ 的非幺正伸缩变换 $U(\\theta)$，使得 $r \\mapsto r \\exp(i\\theta)$，旋转后的哈密顿量为 $H_{\\theta} = U(\\theta) H U^{-1}(\\theta)$。已知对于这样的短程势 $V(r)$，$H_{\\theta}$ 的连续谱在复能量平面中旋转了 $2\\theta$ 角，而任何因旋转而暴露出来的共振极点 $E \\in \\mathbb{C}$（其中 $E = E_{r} - i \\Gamma/2$）在扇形区域 $0\\theta\\theta_{\\max}$ 内保持 $\\theta$-不变，并表现为一个具有平方可积的右本征矢 $\\psi_{\\theta}$ 和相应左本征矢 $\\tilde{\\psi}_{\\theta}$ 的分立本征值，它们被双正交归一化为 $\\langle \\tilde{\\psi}_{\\theta} | \\psi_{\\theta} \\rangle = 1$。\n\n考虑一个初始态 $|\\Psi(0)\\rangle$，它被制备成由这个单共振主导，即在复数标度后，其在共振本征态上的投影 $c = \\langle \\tilde{\\psi}_{\\theta} | \\Psi_{\\theta}(0) \\rangle$ 为 $c=1$，并且非共振连续谱分量在中等时间的“指数衰变窗口”内可以忽略不计。时间演化由哈密顿量 $H$ 生成，即 $|\\Psi(t)\\rangle = \\exp(-iHt/\\hbar)|\\Psi(0)\\rangle$，存活振幅为 $A(t) = \\langle \\Psi(0) | \\Psi(t) \\rangle$。\n\n仅从上述关于CSM和共振极点的定义和事实出发，并且不援引任何预先给定的衰变定律，完成以下任务：\n\n1. 利用CSM谱形变和复能量平面中的围道形变，分离出共振极点对 $t0$ 时的 $A(t)$ 的贡献，从而获得用 $E = E_{r} - i \\Gamma/2$ 表示的 $A(t)$ 的闭合形式表达式。\n\n2. 从这个 $A(t)$ 出发，显式地计算存活概率 $|A(t)|^{2}$，用 $\\Gamma$ 和 $\\hbar$ 表示。\n\n3. 超出孤立极点近似，在同一CSM框架内，解释三维空间中物理阈值 $E=0$ 处旋转后连续谱的分支点如何改变存活振幅的长时间行为。假设s波主导，并且阈值附近的谱密度遵循 Wigner 阈值定律，确定由分支切割产生的 $A(t)$ 长时间尾部的主导幂律指数。你可以保留所有前因子为符号形式，但必须从第一性原理证明该幂律。\n\n评分时，只报告在第2项中获得的存活概率的最终闭合形式表达式。在报告的最终答案中不要包含任何单位。如果你决定近似任何常数，你必须提供确切的符号形式而不是四舍五入的数字，并且此问题不需要四舍五入的说明。",
            "solution": "该问题被认定为有效，因为它科学地基于量子力学和复数标度方法（CSM）的原理，是良定的，并以客观、正式的方式呈现。它没有违反任何无效性标准。因此，我们可以着手解决。\n\n按照题目要求，解答分为三部分呈现。\n\n### 第1部分：存活振幅 $A(t)$ 的推导\n\n初始态 $|\\Psi(0)\\rangle$ 的存活振幅 $A(t)$ 定义为时间演化后的态 $|\\Psi(t)\\rangle = \\exp(-iHt/\\hbar)|\\Psi(0)\\rangle$ 在初始态上的投影：\n$$A(t) = \\langle \\Psi(0) | \\Psi(t) \\rangle = \\langle \\Psi(0) | \\exp(-iHt/\\hbar) | \\Psi(0) \\rangle$$\n其中 $H$ 是系统的哈密顿量，$\\hbar$ 是约化普朗克常数。对于 $t0$，时间演化算符可以通过在复能量平面中对预解算符 $(E-H)^{-1}$ 进行围道积分来表示：\n$$\\exp(-iHt/\\hbar) = \\frac{1}{2\\pi i} \\int_{C} \\exp(-iEt/\\hbar) (E-H)^{-1} dE$$\n积分围道 $C$ 从 $-\\infty+i\\eta$ 到 $+\\infty+i\\eta$，其中 $\\eta0$ 为一无穷小量，即恰好在位于正实轴上的 $H$ 的连续谱的上方。\n\n将此代入 $A(t)$ 的表达式中：\n$$A(t) = \\frac{1}{2\\pi i} \\int_{C} \\exp(-iEt/\\hbar) \\langle \\Psi(0) | (E-H)^{-1} | \\Psi(0) \\rangle dE$$\n复数标度方法（CSM）采用一个非幺正变换 $U(\\theta)$，将坐标按 $r \\mapsto r\\exp(i\\theta)$ 进行标度。该方法的一个关键性质是，对于合适的态，预解算符的矩阵元在此变换下是不变的：\n$$\\langle \\Psi(0) | (E-H)^{-1} | \\Psi(0) \\rangle = \\langle \\Psi_{\\theta}(0) | (E-H_{\\theta})^{-1} | \\Psi_{\\theta}(0) \\rangle$$\n其中 $|\\Psi_{\\theta}(0)\\rangle = U(\\theta)|\\Psi(0)\\rangle$ 且 $H_{\\theta} = U(\\theta)HU^{-1}(\\theta)$ 是旋转后的哈密顿量。于是存活振幅为：\n$$A(t) = \\frac{1}{2\\pi i} \\int_{C} \\exp(-iEt/\\hbar) \\langle \\Psi_{\\theta}(0) | (E-H_{\\theta})^{-1} | \\Psi_{\\theta}(0) \\rangle dE$$\n$H_{\\theta}$ 的谱由 $H$ 的连续谱旋转 $-2\\theta$ 角进入复能量平面的下半平面（沿着射线 $[0, \\infty \\cdot \\exp(-2i\\theta) ]$）以及与共振对应的分立复数本征值组成。其中一个这样的共振极点位于 $E_{res} = E_r - i\\Gamma/2$，它在原始实轴和旋转后连续谱之间的扇形区域中被暴露出来。\n\n对于 $t0$，当 $E$ 的虚部趋于 $-\\infty$ 时，因子 $\\exp(-iEt/\\hbar)$呈指数衰减。这允许我们将积分围道 $C$ 向下形变到下半平面。当我们将围道从其在实轴上方的原始路径变形越过共振极点 $E_{res}$ 时，我们会拾取其留数的贡献。新的围道 $C'$ 可以沿着旋转后的连续谱。根据柯西留数定理，沿原始围道的积分等于沿新围道的积分加上任何穿过的极点的留数贡献之和。\n$$\\int_C \\dots = \\int_{C'} \\dots + 2\\pi i \\sum \\text{Residues}$$\n因此，存活振幅分为两部分：\n$$A(t) = A_{\\text{res}}(t) + A_{\\text{cont}}(t)$$\n其中 $A_{\\text{res}}(t)$ 是来自共振极点的贡献，而 $A_{\\text{cont}}(t)$ 是来自背景连续谱的贡献（即沿 $C'$ 的积分）。题目要求我们首先分离出共振极点的贡献，也就是 $A_{\\text{res}}(t)$。\n\n预解算符 $(E-H_{\\theta})^{-1}$ 在分立本征值的能量处有一个单极点。对于位于 $E_{res}$ 的共振，其对预解算符的贡献由到相应的双正交本征态上的投影算符给出：\n$$(E-H_{\\theta})^{-1} \\approx \\frac{|\\psi_{\\theta}\\rangle \\langle \\tilde{\\psi}_{\\theta}|}{E - E_{res}} + \\text{regular terms}$$\n这里， $|\\psi_{\\theta}\\rangle$ 和 $\\langle \\tilde{\\psi}_{\\theta}|$ 是共振的右本征矢和左本征矢，满足 $H_{\\theta}|\\psi_{\\theta}\\rangle = E_{res}|\\psi_{\\theta}\\rangle$ 和 $\\langle \\tilde{\\psi}_{\\theta}|H_{\\theta} = E_{res}\\langle \\tilde{\\psi}_{\\theta}|$，并具有双正交归一性 $\\langle \\tilde{\\psi}_{\\theta} | \\psi_{\\theta} \\rangle = 1$。被积函数在 $E=E_{res}$ 处的留数是：\n$$\\text{Res}_{E=E_{res}} = \\exp(-iE_{res}t/\\hbar) \\langle \\Psi_{\\theta}(0) | \\left( \\text{Res}_{E=E_{res}} (E-H_{\\theta})^{-1} \\right) | \\Psi_{\\theta}(0) \\rangle$$\n$$\\text{Res}_{E=E_{res}} = \\exp(-iE_{res}t/\\hbar) \\langle \\Psi_{\\theta}(0) | \\psi_{\\theta} \\rangle \\langle \\tilde{\\psi}_{\\theta} | \\Psi_{\\theta}(0) \\rangle$$\n极点对振幅的贡献于是为：\n$$A_{\\text{res}}(t) = \\frac{1}{2\\pi i} \\times (2\\pi i \\times \\text{Res}_{E=E_{res}}) = \\exp(-iE_{res}t/\\hbar) \\langle \\Psi_{\\theta}(0) | \\psi_{\\theta} \\rangle \\langle \\tilde{\\psi}_{\\theta} | \\Psi_{\\theta}(0) \\rangle$$\n题目说明，初始态被制备成其在共振本征态上的投影为 $c = \\langle \\tilde{\\psi}_{\\theta} | \\Psi_{\\theta}(0) \\rangle = 1$。此外，物理初始态 $|\\Psi(0)\\rangle$ 是归一化的，所以 $\\langle \\Psi(0) | \\Psi(0) \\rangle = 1$，这意味着 $A(0)=1$。忽略连续谱分量的近似（这在指数衰变窗口内是有效的）意味着 $A(t) \\approx A_{\\text{res}}(t)$。将此应用于 $t=0$：\n$$A(0) = 1 \\approx A_{\\text{res}}(0) = \\exp(0) \\langle \\Psi_{\\theta}(0) | \\psi_{\\theta} \\rangle \\langle \\tilde{\\psi}_{\\theta} | \\Psi_{\\theta}(0) \\rangle = \\langle \\Psi_{\\theta}(0) | \\psi_{\\theta} \\rangle \\times 1$$\n这意味着我们必须有 $\\langle \\Psi_{\\theta}(0) | \\psi_{\\theta} \\rangle = 1$。这与状态 $|\\Psi_{\\theta}(0)\\rangle$ 可由共振本征态本身很好地近似的假设是一致的，即 $|\\Psi_{\\theta}(0)\\rangle \\approx |\\psi_{\\theta}\\rangle$。\n\n当指数前系数中的两个因子都为1时，在孤立极点近似下，存活振幅为：\n$$A(t) = \\exp(-iE_{res}t/\\hbar)$$\n代入 $E_{res} = E_r - i\\Gamma/2$：\n$$A(t) = \\exp\\left(-i(E_r - i\\Gamma/2)t/\\hbar\\right) = \\exp(-iE_r t/\\hbar) \\exp(-(\\Gamma/2)t/\\hbar)$$\n\n### 第2部分：存活概率 $|A(t)|^2$ 的计算\n\n存活概率是存活振幅的模的平方，$P(t) = |A(t)|^2$。使用第1部分中得到的 $A(t)$ 表达式：\n$$|A(t)|^2 = A(t)^* A(t) = \\left( \\exp(-iE_r t/\\hbar) \\exp(-(\\Gamma t)/(2\\hbar)) \\right)^* \\left( \\exp(-iE_r t/\\hbar) \\exp(-(\\Gamma t)/(2\\hbar)) \\right)$$\n由于 $E_r$、$\\Gamma$、$t$ 和 $\\hbar$ 都是实数，所以 $A(t)$ 的复共轭是：\n$$A(t)^* = \\exp(+iE_r t/\\hbar) \\exp(-(\\Gamma t)/(2\\hbar))$$\n将 $A(t)^*$ 和 $A(t)$ 相乘：\n$$|A(t)|^2 = \\left( \\exp(+iE_r t/\\hbar) \\exp(-(\\Gamma t)/(2\\hbar)) \\right) \\left( \\exp(-iE_r t/\\hbar) \\exp(-(\\Gamma t)/(2\\hbar)) \\right)$$\n$$|A(t)|^2 = \\exp\\left(\\frac{+iE_r t}{\\hbar} - \\frac{iE_r t}{\\hbar}\\right) \\exp\\left(-\\frac{\\Gamma t}{2\\hbar} - \\frac{\\Gamma t}{2\\hbar}\\right)$$\n$$|A(t)|^2 = \\exp(0) \\exp\\left(-\\frac{2\\Gamma t}{2\\hbar}\\right) = \\exp\\left(-\\frac{\\Gamma t}{\\hbar}\\right)$$\n这就是著名的指数衰变定律，其中寿命 $\\tau$ 为 $\\hbar/\\Gamma$。\n\n### 第3部分：长时间行为和幂律尾\n\n超出孤立极点近似， $A(t)$ 的长时间行为由连续谱贡献 $A_{\\text{cont}}(t)$ 决定，该贡献来自于沿旋转后分支切割的积分。当 $t \\to \\infty$ 时，该积分的行为由被积函数在分支点 $E=0$ 附近的部分主导，因为沿积分路径更远点的贡献会因更快速的振荡而抵消。\n\n$A(t)$ 的积分可以写成初始态谱密度的形式，$\\rho(E) = \\frac{1}{\\pi}\\text{Im}\\langle \\Psi(0) | (E-H+i\\eta)^{-1} | \\Psi(0) \\rangle$：\n$$A(t) = \\int_0^\\infty \\rho(E) \\exp(-iEt/\\hbar) dE$$\n题目指定假设s波（$l=0$）主导。根据短程势的 Wigner 阈值定律，阈值能量 $E=0$ 附近的谱密度由相空间体积决定。对于一个在坐标空间中局域化的态，其在低能下的动量分量大致是常数，因此当 $k \\to 0$ 时 $|\\Psi(k)\\rangle$ 是有限的。到能量本征态上的投影涉及到态密度。在三维空间中，态密度正比于 $k^2 \\frac{dk}{dE}$。由于 $E=\\hbar^2k^2/(2\\mu)$，我们有 $k \\propto \\sqrt{E}$ 且 $dk/dE \\propto 1/\\sqrt{E}$。因此，态密度正比于 $(E) \\times (E^{-1/2}) = E^{1/2}$。所以，阈值附近s波分量的谱密度 $\\rho(E)$ 的行为如下：\n$$\\rho(E) \\propto E^{1/2} \\quad \\text{for } E \\to 0^+$$\n存活振幅的长时间行为则由该阈值行为的傅里叶变换决定：\n$$A_{\\text{tail}}(t) \\approx C \\int_0^\\epsilon \\exp(-iEt/\\hbar) E^{1/2} dE$$\n其中 $C$ 是一个常数，$\\epsilon$ 是一个小的能量尺度。我们可以通过替换 $u = Et/\\hbar$ 来分析其时间依赖性，这得到 $E=u\\hbar/t$ 和 $dE = (\\hbar/t)du$：\n$$A_{\\text{tail}}(t) \\approx C \\int_0^{\\epsilon t/\\hbar} \\exp(-iu) (u\\hbar/t)^{1/2} (\\hbar/t)du$$\n$$A_{\\text{tail}}(t) \\approx C (\\hbar/t)^{3/2} \\int_0^{\\epsilon t/\\hbar} u^{1/2} \\exp(-iu) du$$\n当 $t\\to\\infty$ 时，积分的上限可以扩展到 $\\infty$，积分收敛到一个复常数值（与伽马函数 $\\Gamma(3/2)\\exp(-i3\\pi/4)$ 有关）。主导的时间依赖性在于前因子：\n$$A(t) \\propto t^{-3/2} \\quad \\text{for } t \\to \\infty$$\n因此，存活振幅长时间尾部的主导幂律指数是 $-3/2$。这种非指数衰变源于 $E=0$ 处连续谱阈值的贡献。CSM框架通过表明完整的时间演化是孤立极点引起的指数衰变和分支切割积分引起的幂律衰变之和，从而解释了这一现象。",
            "answer": "$$\n\\boxed{\\exp\\left(-\\frac{\\Gamma t}{\\hbar}\\right)}\n$$"
        },
        {
            "introduction": "在实际的数值计算中，对复标度哈密顿量进行对角化会产生大量复数本征值，我们该如何从中识别出真正的共振态？本练习聚焦于这一关键的诊断任务，通过考察本征值随基组大小 $N$ 变化的稳定性，你将学会区分物理上稳定的共振态和那些随计算参数漂移的、非物理的离散连续谱伪影。掌握这种稳定性分析是应用复标度方法解决实际问题的必备技能。",
            "id": "3596830",
            "problem": "考虑一个单通道核哈密顿算符 $H$，描述一个约化质量为 $\\mu$ 的粒子在短程中心势 $V(r)$ 中运动，该算符作用于平方可积函数 $\\psi(r) \\in \\mathcal{L}^{2}(\\mathbb{R}^{+})$。复数标度变换 $r \\mapsto r e^{i\\theta}$ 通过相似变换定义了非厄米算符 $H_{\\theta}$。在该变换下，$H$ 在正实轴上的连续谱被旋转到复能量平面的下半平面，旋转角度为 $2\\theta$，而束缚态则保留在实轴上。根据 Aguilar–Balslev–Combes (ABC) 定理，对于某个范围内的 $\\theta$（该范围能暴露极点但不会穿过 $V(r)$ 的其他奇点），复能量为 $E_{\\text{res}} = E_{r} - i\\Gamma/2$ 且 $\\Gamma > 0$ 的真共振态（Gamow 态）会表现为 $H_{\\theta}$ 的孤立的、与 $\\theta$ 无关的本征值。\n\n在计算环境中，我们在一个维度为 $N$ 的 $\\mathcal{L}^{2}$ 基中近似 $H_{\\theta}$，并通过 Galerkin 投影计算其离散谱 $\\{E_{j}^{(N)}(\\theta)\\}$。在 ABC 定理的有效窗口内，对于一个固定的标度角 $\\theta$，我们需要寻找一种实用的稳定化方案，通过分析当 $N$ 变化时 $E_{j}^{(N)}(\\theta)$ 的行为，来区分真正的共振态与非共振的离散化连续谱态。\n\n哪个选项正确地描述了一种在固定 $\\theta$ 下可行的稳定化方法，以及在 $E(N)$ 行为中用于识别共振态与非共振离散化连续谱态的相应诊断特征？\n\nA. 在固定 $\\theta$下，增加 $N$ 并选择那些本征值 $E_{j}^{(N)}(\\theta)$，使其满足：当 $N \\to \\infty$ 时，其实部 $\\operatorname{Re}E_{j}^{(N)}$ 趋近散射阈值，而其虚部 $\\operatorname{Im}E_{j}^{(N)}$ 趋于 $0$。这些是共振态；任何其模随 $N$ 增大的本征值都是离散化连续谱态。\n\nB. 在固定 $\\theta$ 下，增加 $N$ 并将那些随着 $N$ 增长而在复平面上沿着辐角为 $-2\\theta$ 的直线漂移的 $E_{j}^{(N)}(\\theta)$ 识别为共振态，因为这种运动遵循旋转后的分支切割；不沿此线移动的本征值是离散化连续谱的人为产物。\n\nC. 在固定 $\\theta$ 下，增加 $N$ 并在一系列 $N_{1}, N_{2}, \\cdots$ 上监测 $E_{j}^{(N)}(\\theta)$。将那些形成 $N$-平台的本征值归类为共振态：对于足够大的 $N$，其实部 $\\operatorname{Re}E_{j}^{(N)}$ 和虚部 $\\operatorname{Im}E_{j}^{(N)}$ 都只随 $N$ 发生微弱变化，并且该复能量保持孤立，远离旋转后的连续谱射线。将那些表现出明显的、依赖于 $N$ 的漂移，并且沿着辐角为 $-2\\theta$ 的射线变得密集的本征值归类为离散化连续谱态。\n\nD. 在固定 $\\theta$ 下，增加 $N$ 并选择那些其模 $\\lvert E_{j}^{(N)}(\\theta)\\rvert$ 随 $N$ 增长最快（在 $\\lvert E\\rvert$ 对 $N$ 的图中斜率最大）的本征值为共振态，因为快速增长表明局域化；缓慢变化的本征值对应于非共振连续谱。\n\nE. 保持 $N$ 固定并改变 $\\theta$；将那些随着 $\\theta$ 的变化而沿着辐角为 $-2\\theta$ 的旋转连续谱线移动的本征值归类为共振态，并将那些保持与 $\\theta$ 无关的本征值归类为非共振态。这提供了一种在固定 $\\theta$ 下关于 $N$ 的稳定化方法。",
            "solution": "用户希望我扮演一位严谨细致的理工科教授，解决一个关于计算核物理中复数标度法的问题。\n\n### **问题验证**\n\n**第一步：提取已知条件**\n\n*   **哈密顿算符：** 一个单通道核哈密顿算符 $H$，用于描述一个约化质量为 $\\mu$ 的粒子在短程中心势 $V(r)$ 中的运动。\n*   **函数空间：** 平方可积函数 $\\psi(r) \\in \\mathcal{L}^{2}(\\mathbb{R}^{+})$。\n*   **变换：** 复数标度变换 $r \\mapsto r e^{i\\theta}$，通过相似变换定义了非厄米算符 $H_{\\theta}$。\n*   **$H_{\\theta}$ 的谱：**\n    *   $H$ 在正实轴上的连续谱被旋转到复能量平面的下半平面，旋转角度为 $2\\theta$。\n    *   束缚态保留在实轴上。\n*   **Aguilar–Balslev–Combes (ABC) 定理：** 复能量为 $E_{\\text{res}} = E_{r} - i\\Gamma/2$（$\\Gamma > 0$）的真共振态，在适当的 $\\theta$ 范围内，表现为 $H_{\\theta}$ 的孤立的、与 $\\theta$ 无关的本征值。\n*   **计算方法：** 在一个维度为 $N$ 的 $\\mathcal{L}^{2}$ 基中近似 $H_{\\theta}$，并通过 Galerkin 投影计算其离散谱 $\\{E_{j}^{(N)}(\\theta)\\}$。\n*   **问题：** 在一个固定的标度角 $\\theta$ 下，通过分析当 $N$ 变化时 $E_{j}^{(N)}(\\theta)$ 的行为，确定一个正确的、能区分真共振态和非共振离散化连续谱态的实用稳定化方案。\n\n**第二步：使用已知条件进行验证**\n\n*   **科学依据：** 该问题陈述在科学上是合理的。它准确地描述了复数标度法，也称为 Aguilar–Balslev–Combes (ABC) 方法，这是一种在量子力学中用于理论和计算研究共振态的严谨且广泛使用的方法。关于相似变换、连续谱的旋转、将共振态识别为孤立的复数本征值，以及在有限 $\\mathcal{L}^{2}$ 基中使用 Galerkin 投影的描述，都是该理论中标准且正确的内容。\n*   **良构性：** 这个问题是良构的。它要求一个特定的计算特征，用于区分在一个标准数值计算过程中出现的两种类型的本征值。根据基组大小区分共振本征值和离散化连续谱本征值的行为，是该方法实际应用的基石。基于该方法的原理，存在一个清晰且唯一的答案。\n*   **客观性：** 该问题以精确、客观、技术性的语言陈述，没有歧义或主观论断。\n\n**第三步：结论与行动**\n\n该问题陈述是有效的。它在科学上合理、良构且客观。我将继续推导解答。\n\n### **解题推导**\n\n问题的核心在于理解有限基近似如何影响复数标度哈密顿算符 $H_{\\theta}$ 的谱。算符 $H_{\\theta}$ 有两种我们感兴趣的谱特征：旋转后的连续谱和孤立的共振本征值。\n\n1.  **共振本征值：** ABC 定理指出，共振对应于*精确*哈密顿算符 $H_{\\theta}$ 的一个孤立的、与 $\\theta$ 无关的本征值。该方法之所以有效，其物理原因是复数标度变换 $r \\to r e^{i\\theta}$ 将渐近发散的 Gamow 态波函数 $\\psi_{\\text{res}}(r) \\sim e^{ik_{\\text{res}}r}$（其中 $k_{\\text{res}}$ 为复数）转换为一个指数衰减的函数（对于满足 $\\operatorname{Im}(k_{\\text{res}}e^{i\\theta}) > 0$ 的一系列 $\\theta$）。这个变换后的波函数变得平方可积，即 $\\psi_{\\text{res}}(re^{i\\theta}) \\in \\mathcal{L}^2$。\n    因为共振波函数现在在坐标空间中变得有效局域化，所以它可以被一个足够大但有限的、维度为 $N$ 的 $\\mathcal{L}^{2}$ 基组准确地表示。在使用 Galerkin 投影的计算环境中，当我们增加基组大小 $N$ 时，对这个局域化状态的近似会得到改善。因此，相应的离散本征值 $E_{\\text{res}}^{(N)}(\\theta)$ 将收敛到真实的共振能量 $E_{\\text{res}}$。这种收敛表现为一种稳定化：对于足以覆盖波函数重要部分的足够大的 $N$，进一步增加 $N$ 只会对 $E_{\\text{res}}^{(N)}(\\theta)$ 产生非常小的改变。在复平面上绘制随 $N$ 增加的本征值，会揭示一个趋于固定的点，形成所谓的“$N$-平台”。\n\n2.  **离散化连续谱态：** 原始哈密顿算符 $H$ 的连续谱位于实轴 $[0, \\infty)$ 上。复数标度变换将这个连续谱旋转成复平面中一条从原点出发、角度为 $-2\\theta$ 的射线。当我们在一个大小为 $N$ 的有限基中离散化问题时，我们实际上是施加了边界条件，或者说将系统“置于一个箱子中”，其有效尺寸与 $N$ 相关。这个过程用一组离散的本征值替代了连续的谱线。这些本征值 $\\{E_{j}^{(N)}(\\theta)\\}$ 是对连续谱的近似。\n    与共振态不同，连续谱态不是局域化的。它们的波函数延伸到无穷远。因此，它们在有限基中的表示对基的大小 $N$ 高度敏感。随着 $N$ 的增加，有效箱尺寸增大，会发生两件事：(i) 单个离散态的能量 $E_{j}^{(N)}(\\theta)$ 会显著改变（它们在复平面上“漂移”），(ii) 这些态的密度沿着旋转后的连续谱线增加。在复数谱的图中，随着 $N$ 的增加，这些态会表现为沿着辐角为 $-2\\theta$ 的射线移动并变得更加密集的“一串珠子”。\n\n**推导结论：**\n在固定 $\\theta$ 下的稳定化方案依赖于区分收敛（关于 $N$ 的稳定性）和漂移。随着 $N$ 的增加，共振本征值将收敛到复平面中一个远离旋转连续谱的固定点。而一个离散化连续谱本征值则会漂移，通常沿着角度为 $-2\\theta$ 的射线移动，并且不会收敛到一个孤立的点。\n\n### **逐项分析**\n\n**A. 在固定 $\\theta$下，增加 $N$ 并选择那些本征值 $E_{j}^{(N)}(\\theta)$，使其满足：当 $N \\to \\infty$ 时，其实部 $\\operatorname{Re}E_{j}^{(N)}$ 趋近散射阈值，而其虚部 $\\operatorname{Im}E_{j}^{(N)}$ 趋于 $0$。这些是共振态；任何其模随 $N$ 增大的本征值都是离散化连续谱态。**\n*   **分析：** 这是不正确的。共振由复能量 $E_{\\text{res}} = E_r - i\\Gamma/2$ 定义，其中宽度 $\\Gamma > 0$。共振本征值通常不会趋近于散射阈值（$E=0$），其虚部也不会趋于零。在极限 $\\theta \\to 0$ 时，趋近实轴的是连续谱态，而不是在固定 $\\theta > 0$ 时的共振态。该描述从根本上是错误的。\n*   **结论：** 不正确。\n\n**B. 在固定 $\\theta$ 下，增加 $N$ 并将那些随着 $N$ 增长而在复平面上沿着辐角为 $-2\\theta$ 的直线漂移的 $E_{j}^{(N)}(\\theta)$ 识别为共振态，因为这种运动遵循旋转后的分支切割；不沿此线移动的本征值是离散化连续谱的人为产物。**\n*   **分析：** 这个描述与正确的行为正好相反。沿着辐角为 $-2\\theta$ 的直线漂移的本征值是离散化的**连续谱**态，因为这条线代表了旋转后的连续谱。共振本征值是通过其**稳定性**和与这条线的**隔离**来识别的。\n*   **结论：** 不正确。\n\n**C. 在固定 $\\theta$ 下，增加 $N$ 并在一系列 $N_{1}, N_{2}, \\cdots$ 上监测 $E_{j}^{(N)}(\\theta)$。将那些形成 $N$-平台的本征值归类为共振态：对于足够大的 $N$，其实部 $\\operatorname{Re}E_{j}^{(N)}$ 和虚部 $\\operatorname{Im}E_{j}^{(N)}$ 都只随 $N$ 发生微弱变化，并且该复能量保持孤立，远离旋转后的连续谱射线。将那些表现出明显的、依赖于 $N$ 的漂移，并且沿着辐角为 $-2\\theta$ 的射线变得密集的本征值归类为离散化连续谱态。**\n*   **分析：** 这个陈述准确地描述了关于基组大小 $N$ 的稳定化方法。它正确地将共振的特征识别为收敛到一个稳定的复能量（一个“$N$-平台”），这是由于其波函数在复数标度下的有效局域化。它也正确地描述了非共振的离散化连续谱态的行为，即由于其非局域性，它们会漂移并沿着旋转后的连续谱线变得密集。\n*   **结论：** 正确。\n\n**D. 在固定 $\\theta$ 下，增加 $N$ 并选择那些其模 $\\lvert E_{j}^{(N)}(\\theta)\\rvert$ 随 $N$ 增长最快（在 $\\lvert E\\rvert$ 对 $N$ 的图中斜率最大）的本征值为共振态，因为快速增长表明局域化；缓慢变化的本征值对应于非共振连续谱。**\n*   **分析：** 这是不正确的，并且颠倒了逻辑。随 $N$ 快速变化是离散化连续谱态的特征，这些态对基组大小很敏感。缓慢变化（收敛）是共振的特征，因为一旦 $N$ 足够大，其局域化的波函数可以被基组很好地表示。声稱快速增长表明局域化在物理上是反的。\n*   **结论：** 不正确。\n\n**E. 保持 $N$ 固定并改变 $\\theta$；将那些随着 $\\theta$ 的变化而沿着辐角为 $-2\\theta$ 的旋转连续谱线移动的本征值归类为共振态，并将那些保持与 $\\theta$ 无关的本征值归类为非共振态。这提供了一种在固定 $\\theta$ 下关于 $N$ 的稳定化方法。**\n*   **分析：** 这个选项描述的是“$\\theta$-轨迹”法，即在固定 $N$ 的情况下改变 $\\theta$。在该方法中，连续谱态跟随旋转（随 $\\theta$ 移动），而共振态保持静止（与 $\\theta$ 无关），这与选项中的陈述正好相反。更重要的是，问题明确要求一个在**固定 $\\theta$** 下、**改变 $N$** 的方案。这个选项描述了一个不同的方案（并且描述得不正确），然后荒谬地声称它是一种“在固定 $\\theta$ 下关于 $N$ 的稳定化方法”。它未能回答所提出的问题。\n*   **结论：** 不正确。",
            "answer": "$$\\boxed{C}$$"
        },
        {
            "introduction": "理论的最终检验在于实践。本练习将引导你完成一个完整的复标度方法计算流程，从推导矩阵元到编写代码并验证结果。你将在谐振子基中构建哈密顿量矩阵，并通过一系列精心设计的数值测试来检验方法的关键特性，例如束缚态能量的 $\\theta$ 不变性以及连续谱的旋转。这个全面的实践将理论知识转化为可运行的物理模型，为你解决更复杂问题提供坚实基础。",
            "id": "3596801",
            "problem": "你的任务是在谐振子基中实现一维哈密顿量的复标度方法，以研究计算核物理中与共振相关的谱性质。在整个工作中，使用无量纲单位，其中 $\\hbar^2/(2\\mu)=1$，因此动能算符为 $T = -\\dfrac{d^2}{dr^2}$。复标度哈密顿量定义为\n$$\nH_\\theta \\equiv e^{-2 i \\theta} T + V\\!\\left(r e^{i \\theta}\\right),\n$$\n其中 $\\theta$ 是以弧度为单位的实数角度。\n\n使用振子长度为 $b0$ 的一维谐振子基函数标准正交集 $\\{\\phi_n(r;b)\\}_{n=0}^{N-1}$，\n$$\n\\phi_n(r;b) = \\frac{1}{\\sqrt{b}}\\;\\frac{1}{\\pi^{1/4}\\sqrt{2^n n!}}\\;H_n\\!\\left(\\frac{r}{b}\\right)\\exp\\!\\left(-\\frac{r^2}{2 b^2}\\right),\n$$\n其中 $H_n$ 是物理学家厄米多项式。在此基中，$H_\\theta$ 的矩阵元为\n$$\n\\left(H_\\theta\\right)_{nm} = e^{-2 i \\theta}\\, T_{nm}(b) + V^{(\\theta)}_{nm}(b),\n$$\n其中动能算符矩阵元 $T_{nm}(b)$ 和复标度势矩阵元 $V^{(\\theta)}_{nm}(b)$ 定义为\n$$\nT_{nm}(b) = \\int_{-\\infty}^{\\infty} \\phi_n(r;b)\\left(-\\frac{d^2}{dr^2}\\right)\\phi_m(r;b)\\;dr,\n\\qquad\nV^{(\\theta)}_{nm}(b) = \\int_{-\\infty}^{\\infty} \\phi_n(r;b)\\, V\\!\\left(r e^{i \\theta}\\right)\\, \\phi_m(r;b)\\;dr.\n$$\n\n从无量纲变量 $u=r/b$ 下的标准谐振子恒等式出发，\n$$\n\\left(-\\frac{d^2}{du^2} + u^2\\right)h_n(u) = (2n+1)h_n(u), \\quad h_n(u) \\equiv \\frac{1}{\\pi^{1/4}\\sqrt{2^n n!}}\\,H_n(u)\\,e^{-u^2/2},\n$$\n推导一个稀疏的闭式表达式 $T_{nm}(b)$，该表达式仅将 $n$ 与 $m$、$m\\pm 2$ 耦合。然后，将 $V^{(\\theta)}_{nm}(b)$ 改写为一个关于 $u=r/b$ 的积分，其带有适用于高斯-厄米求积的高斯权重 $e^{-u^2}$，\n$$\nV^{(\\theta)}_{nm}(b) = \\frac{1}{\\sqrt{\\pi}\\sqrt{2^{n+m} n!\\, m!}}\\int_{-\\infty}^{\\infty}\\!du\\; e^{-u^2}\\, H_n(u)\\,H_m(u)\\, V\\!\\left(b\\,u\\,e^{i\\theta}\\right).\n$$\n\n实现一个程序，该程序：\n1. 使用你推导的稀疏公式构建 $T_{nm}(b)$。\n2. 使用高斯-厄米求积法计算 $V^{(\\theta)}_{nm}(b)$，并使用足够的节点以精确积分厄米多项式与复标度势的乘积。\n3. 构造复对称矩阵 $H_\\theta$ 并计算其所有本征值。\n\n采用高斯吸引势\n$$\nV(r) = -V_0 \\exp\\!\\left[-\\left(\\frac{r}{a}\\right)^2\\right],\n$$\n其中 $V_00$ 且 $a0$。所有量均为无量纲。角度必须以弧度为单位。\n\n你的程序应运行以下测试套件，并汇总所要求的定量诊断结果：\n\n- 测试 1 (束缚态 $\\theta$ 不变性)：当 $V_0=8.0$, $a=1.0$, $b=1.1$, $N=40$ 时，计算 $\\theta=0.15$ 和 $\\theta=0.35$ 时的最低本征值（实部最小的那个）。以浮点数形式输出它们差值的绝对值。\n\n- 测试 2 ($N$ 收敛性)：当 $V_0=8.0$, $a=1.0$, $b=1.1$, $\\theta=0.25$ 时，计算 $N=20$ 和 $N=40$ 时的最低本征值。以浮点数形式输出它们差值的绝对值。\n\n- 测试 3 ($b$ 收敛性)：当 $V_0=8.0$, $a=1.0$, $N=40$, $\\theta=0.25$ 时，计算 $b\\in\\{0.9,\\,1.1,\\,1.3\\}$ 时的最低本征值。以浮点数形式输出这三个本征值之间的最大两两绝对差值。\n\n- 测试 4 (连续谱旋转)：当 $V_0=0.0$ (零势)，$b=1.0$, $N=30$ 时，计算 $\\theta=0.30$ 时的本征值。对于所有模大于 $10^{-6}$ 的本征值，计算它们的复数辐角，取其平均值，并以浮点数形式返回该平均值与 $-2\\theta$ (以弧度为单位) 之间的绝对差值。\n\n- 测试 5 (复对称性)：当 $V_0=8.0$, $a=1.0$, $b=1.0$, $N=25$, $\\theta=0.25$ 时，构造 $H_\\theta$ 并以浮点数形式输出弗罗贝尼乌斯范数 $\\|H_\\theta - H_\\theta^{\\mathsf{T}}\\|_F$。\n\n所有输出都应表示为无量纲浮点数。你的程序应生成单行输出，其中包含用方括号括起来的、以逗号分隔的结果列表（例如，“[r1,r2,r3,r4,r5]”）。无需用户输入；请使用上述指定的参数。通过为每种情况选择足够数量的高斯-厄米节点，确保数值稳定性和合理的精度。",
            "solution": "这个问题在科学上和数学上都是适定的。它涉及应用复标度方法——一种计算量子力学中的标准技术——来寻找由高斯势描述的一维系统的共振和束缚态性质。这个问题是自洽的，提供了所有必要的定义、参数和一组明确的计算目标。我将继续进行求解。\n\n解题过程分为两个主要阶段：首先，动能矩阵元的解析推导；其次，构造并对角化复标度哈密顿矩阵的数值算法设计。\n\n在指定的无量纲单位中，动能算符是 $T = -d^2/dr^2$。我们需要求解其在一维谐振子（HO）基 $\\{\\phi_n(r;b)\\}_{n=0}^{N-1}$ 中的矩阵元 $T_{nm}(b)$。\n基函数由 $\\phi_n(r;b) = \\frac{1}{\\sqrt{b}} h_n(u)$ 给出，其中 $u = r/b$ 是一个无量纲坐标，$h_n(u)$ 是标准的标准正交谐振子波函数，\n$$\nh_n(u) = \\frac{1}{\\pi^{1/4}\\sqrt{2^n n!}} H_n(u) e^{-u^2/2}.\n$$\n矩阵元由积分定义\n$$\nT_{nm}(b) = \\int_{-\\infty}^{\\infty} \\phi_n(r;b)\\left(-\\frac{d^2}{dr^2}\\right)\\phi_m(r;b)\\;dr.\n$$\n我们进行从 $r$ 到 $u=r/b$ 的变量替换。这意味着 $dr = b\\,du$，并且微分算符变换为 $\\frac{d}{dr} = \\frac{1}{b}\\frac{d}{du}$，从而得到 $\\frac{d^2}{dr^2} = \\frac{1}{b^2}\\frac{d^2}{du^2}$。将这些代入积分中得到：\n$$\nT_{nm}(b) = \\int_{-\\infty}^{\\infty} \\left(\\frac{1}{\\sqrt{b}}h_n(u)\\right) \\left(-\\frac{1}{b^2}\\frac{d^2}{du^2}\\right) \\left(\\frac{1}{\\sqrt{b}}h_m(u)\\right) (b\\,du) = \\frac{1}{b^2} \\int_{-\\infty}^{\\infty} h_n(u) \\left(-\\frac{d^2}{du^2}\\right) h_m(u)\\;du.\n$$\n问题给出了无量纲谐振子的薛定谔方程：\n$$\n\\left(-\\frac{d^2}{du^2} + u^2\\right)h_m(u) = (2m+1)h_m(u).\n$$\n我们可以重新整理它以表达动能部分：$-\\frac{d^2}{du^2}h_m(u) = \\left((2m+1) - u^2\\right)h_m(u)$。\n将此代入 $T_{nm}(b)$ 的表达式中：\n$$\nT_{nm}(b) = \\frac{1}{b^2} \\int_{-\\infty}^{\\infty} h_n(u) \\left((2m+1) - u^2\\right) h_m(u)\\;du = \\frac{1}{b^2} \\left( (2m+1) \\int_{-\\infty}^{\\infty} h_n(u)h_m(u)\\;du - \\int_{-\\infty}^{\\infty} h_n(u) u^2 h_m(u)\\;du \\right).\n$$\n第一个积分就是标准正交条件，$\\int h_n(u)h_m(u)\\;du = \\delta_{nm}$。第二个积分表示算符 $u^2$ 的矩阵元，记为 $\\langle n|u^2|m\\rangle$。\n因此，$T_{nm}(b) = \\frac{1}{b^2} \\left( (2m+1)\\delta_{nm} - \\langle n|u^2|m\\rangle \\right)$。\n\n$u^2$ 的矩阵元是量子谐振子中的标准结果。用下降算符（$a$）和上升算符（$a^\\dagger$）表示，$u = \\frac{1}{\\sqrt{2}}(a+a^\\dagger)$，这给出 $u^2 = \\frac{1}{2}(a^2 + (a^\\dagger)^2 + 2a^\\dagger a + 1)$。矩阵元为：\n$$\n\\langle n|u^2|m\\rangle = \\frac{1}{2}\\left( \\sqrt{m(m-1)}\\,\\delta_{n,m-2} + \\sqrt{(m+1)(m+2)}\\,\\delta_{n,m+2} + (2m+1)\\,\\delta_{n,m} \\right).\n$$\n将此代入 $T_{nm}(b)$ 的表达式中：\n对于对角元（$n=m$）：\n$$\nT_{mm}(b) = \\frac{1}{b^2} \\left( (2m+1) - \\langle m|u^2|m\\rangle \\right) = \\frac{1}{b^2} \\left( (2m+1) - \\frac{1}{2}(2m+1) \\right) = \\frac{2m+1}{2b^2} = \\frac{m+1/2}{b^2}.\n$$\n对于非对角元，只有 $n=m\\pm 2$ 的项不为零。\n对于 $n=m-2$：\n$$\nT_{m-2,m}(b) = \\frac{1}{b^2} (0 - \\langle m-2|u^2|m\\rangle) = -\\frac{1}{b^2} \\left( \\frac{1}{2}\\sqrt{m(m-1)} \\right) = -\\frac{\\sqrt{m(m-1)}}{2b^2}.\n$$\n根据对称性（$T_{nm}=T_{mn}$），矩阵元 $T_{m,m-2}(b)$ 是相同的。该矩阵是稀疏的五对角矩阵（主对角线以及在 $\\pm 2$ 位置的对角线）。我们可以总结一个 $N \\times N$ 矩阵（索引 $n,m$ 从 $0$ 到 $N-1$）的矩阵元：\n$$\nT_{nm}(b) = \\frac{1}{b^2} \\begin{cases}\nn+1/2  \\text{if } n=m \\\\\n-\\frac{1}{2}\\sqrt{(n+1)(n+2)}  \\text{if } m=n+2 \\\\\n-\\frac{1}{2}\\sqrt{n(n-1)}  \\text{if } m=n-2 \\\\\n0  \\text{otherwise}\n\\end{cases}\n$$\n这个表达式用于构建动能矩阵 $T$。\n\n复标度哈密顿矩阵为 $H_\\theta = e^{-2 i \\theta}\\, T + V^{(\\theta)}$。动能部分 $T$ 使用上面推导的稀疏公式构建。势能部分 $V^{(\\theta)}$ 需要数值积分。\n\n复标度势的矩阵元由下式给出：\n$$\nV^{(\\theta)}_{nm}(b) = \\frac{1}{\\sqrt{\\pi}\\sqrt{2^{n+m} n!\\, m!}}\\int_{-\\infty}^{\\infty} e^{-u^2}\\, H_n(u)\\,H_m(u)\\, V(b\\,u\\,e^{i\\theta})\\,du.\n$$\n这个积分的形式非常适合高斯-厄米求积，该方法近似计算 $\\int_{-\\infty}^{\\infty} e^{-x^2} f(x)\\,dx \\approx \\sum_{k=1}^K w_k f(x_k)$，其中 $x_k$ 和 $w_k$ 是求积的横坐标和权重。在我们的例子中，函数 $f(u)$ 是：\n$$\nf_{nm}(u) = C_{nm}\\, H_n(u)\\,H_m(u)\\, V(b\\,u\\,e^{i\\theta}), \\quad \\text{with} \\quad C_{nm} = \\frac{1}{\\sqrt{\\pi}\\sqrt{2^{n+m} n!\\, m!}}.\n$$\n势函数为 $V(r) = -V_0 \\exp[-(r/a)^2]$。在复标度坐标 $r = b\\,u\\,e^{i\\theta}$ 处求值，它变为：\n$$\nV(b\\,u\\,e^{i\\theta}) = -V_0 \\exp\\left[-\\left(\\frac{b\\,u\\,e^{i\\theta}}{a}\\right)^2\\right] = -V_0 \\exp\\left[-\\left(\\frac{b\\,u}{a}\\right)^2 e^{2i\\theta}\\right].\n$$\n算法流程如下：\n1. 选择求积点数 $K$。选择 $K=150$，这个值对于测试中使用的最大基底大小 $N=40$ 已经足够，因为它可以精确积分最高 $2K-1=299$ 次的多项式，远超过厄米多项式带来的最高多项式次数 $2(N-1)=78$。\n2. 获取高斯-厄米横坐标 $x_k$ 和权重 $w_k$，其中 $k=1, \\dots, K$。\n3. 预先计算在主循环中保持不变的值：对于 $n=0, \\dots, N-1$ 的 $\\log(n!)$；对于所有 $n$ 和 $k$ 的厄米多项式 $H_n(x_k)$；对于所有 $k$ 的势能值 $V(b\\,x_k\\,e^{i\\theta})$。\n4. 通过从 $0$ 到 $N-1$ 遍历索引 $n$ 和 $m$ 来构建 $N \\times N$ 矩阵 $V^{(\\theta)}$。对于每对 $(n,m)$，计算常数 $C_{nm}$ 并评估求积和：\n$$\nV^{(\\theta)}_{nm}(b) \\approx C_{nm} \\sum_{k=1}^K w_k\\, H_n(x_k)\\,H_m(x_k)\\, V(b\\,x_k\\,e^{i\\theta}).\n$$\n由于被积函数关于 $n$ 和 $m$ 是对称的，因此得到的矩阵 $V^{(\\theta)}$ 是复对称的，即 $V^{(\\theta)}_{nm} = V^{(\\theta)}_{mn}$。利用此性质，只计算矩阵的上三角（或下三角）部分。\n5. 构造完整的哈密顿矩阵 $H_\\theta = e^{-2i\\theta} T + V^{(\\theta)}$。注意，由于 $T$ 是实对称的，$V^{(\\theta)}$ 是复对称的，所以 $H_\\theta$ 也是复对称的（$H_\\theta = H_\\theta^{\\mathsf{T}}$）。\n6. 使用标准的数值线性代数库例程计算得到的稠密复对称矩阵 $H_\\theta$ 的本征值。\n\n将此过程应用于问题中描述的五个测试用例，得到指定的定量结果。对于测试1、2和3，最低本征值被确定为实部最小的那个。对于测试4，分析了连续谱本征值的辐角。对于测试5，验证了所构造矩阵的复对称性质。",
            "answer": "```python\nimport numpy as np\nfrom scipy.special import roots_hermite, eval_hermite, gammaln\n\ndef get_hamiltonian(V0, a, b, N, theta):\n    \"\"\"\n    Constructs the complex-scaled Hamiltonian matrix H_theta.\n\n    Args:\n        V0 (float): Potential depth.\n        a (float): Potential width parameter.\n        b (float): Harmonic oscillator length parameter.\n        N (int): Basis size (number of HO functions).\n        theta (float): Scaling angle in radians.\n\n    Returns:\n        np.ndarray: The N x N complex-scaled Hamiltonian matrix.\n    \"\"\"\n    # K: Number of Gauss-Hermite quadrature points. Chosen to be large enough\n    # for the largest basis size N=40 in the tests.\n    K = 150\n\n    # 1. Construct the kinetic energy matrix T\n    T = np.zeros((N, N), dtype=np.float64)\n    for n in range(N):\n        T[n, n] = (n + 0.5) / b**2\n        if n + 2  N:\n            val = -0.5 * np.sqrt((n + 1) * (n + 2)) / b**2\n            T[n, n + 2] = val\n            T[n + 2, n] = val\n\n    # 2. Construct the complex-scaled potential matrix V_theta\n    V_theta = np.zeros((N, N), dtype=np.complex128)\n    if not np.isclose(V0, 0.0):\n        # Quadrature points and weights for integral with e^(-x^2) weight\n        x_k, w_k = roots_hermite(K)\n        \n        # Precompute values for efficiency\n        # Hermite polynomials H_n(x_k) for n=0..N-1 and all k=1..K\n        H_vals = np.array([eval_hermite(n, x_k) for n in range(N)])\n        \n        # Logarithm of factorials log(n!) for n=0..N-1\n        log_fact = np.array([gammaln(n + 1) for n in range(N)])\n        \n        # Potential evaluated at complex-scaled quadrature points\n        V_at_points = -V0 * np.exp(-((b * x_k * np.exp(1j * theta)) / a)**2)\n        \n        for n in range(N):\n            for m in range(n, N):\n                # Normalization constant from the HO basis functions\n                log_norm = -0.5 * np.log(np.pi) - 0.5 * (n + m) * np.log(2) - 0.5 * (log_fact[n] + log_fact[m])\n                norm_factor = np.exp(log_norm)\n                \n                # Integrand evaluated at quadrature points (f(x_k) part)\n                integrand = H_vals[n, :] * H_vals[m, :] * V_at_points\n                \n                # Perform quadrature: sum(w_k * f(x_k))\n                integral_val = np.sum(w_k * integrand)\n                \n                val = norm_factor * integral_val\n                V_theta[n, m] = val\n                if n != m:\n                    V_theta[m, n] = val  # Matrix is complex-symmetric\n\n    # 3. Assemble the full Hamiltonian: H_theta = exp(-2i*theta)*T + V_theta\n    H_theta = np.exp(-2j * theta) * T.astype(np.complex128) + V_theta\n    \n    return H_theta\n\ndef solve():\n    \"\"\"\n    Executes the five test cases specified in the problem statement.\n    \"\"\"\n    results = []\n\n    # Test 1: Bound-state theta-invariance\n    V0, a, b, N = 8.0, 1.0, 1.1, 40\n    theta1, theta2 = 0.15, 0.35\n    H1 = get_hamiltonian(V0, a, b, N, theta1)\n    eigs1 = np.linalg.eigvals(H1)\n    lowest1 = eigs1[np.argmin(eigs1.real)]\n    H2 = get_hamiltonian(V0, a, b, N, theta2)\n    eigs2 = np.linalg.eigvals(H2)\n    lowest2 = eigs2[np.argmin(eigs2.real)]\n    results.append(np.abs(lowest1 - lowest2))\n\n    # Test 2: Convergence with N\n    V0, a, b, theta = 8.0, 1.0, 1.1, 0.25\n    N1, N2 = 20, 40\n    H1 = get_hamiltonian(V0, a, b, N1, theta)\n    eigs1 = np.linalg.eigvals(H1)\n    lowest1 = eigs1[np.argmin(eigs1.real)]\n    H2 = get_hamiltonian(V0, a, b, N2, theta)\n    eigs2 = np.linalg.eigvals(H2)\n    lowest2 = eigs2[np.argmin(eigs2.real)]\n    results.append(np.abs(lowest1 - lowest2))\n    \n    # Test 3: Convergence with b\n    V0, a, N, theta = 8.0, 1.0, 40, 0.25\n    b_vals = [0.9, 1.1, 1.3]\n    lowest_eigs = []\n    for b_val in b_vals:\n        H = get_hamiltonian(V0, a, b_val, N, theta)\n        eigs = np.linalg.eigvals(H)\n        lowest_eigs.append(eigs[np.argmin(eigs.real)])\n    max_diff = max(np.abs(lowest_eigs[0] - lowest_eigs[1]),\n                   np.abs(lowest_eigs[0] - lowest_eigs[2]),\n                   np.abs(lowest_eigs[1] - lowest_eigs[2]))\n    results.append(max_diff)\n\n    # Test 4: Continuum rotation\n    V0, b, N, theta = 0.0, 1.0, 30, 0.30\n    H = get_hamiltonian(V0, 1.0, b, N, theta)  # 'a' is a dummy parameter here\n    eigs = np.linalg.eigvals(H)\n    filtered_eigs = eigs[np.abs(eigs) > 1e-6]\n    args = np.angle(filtered_eigs)\n    avg_arg = np.mean(args)\n    target_arg = -2 * theta\n    results.append(np.abs(avg_arg - target_arg))\n\n    # Test 5: Complex symmetry\n    V0, a, b, N, theta = 8.0, 1.0, 1.0, 25, 0.25\n    H = get_hamiltonian(V0, a, b, N, theta)\n    norm_diff = np.linalg.norm(H - H.T, 'fro')\n    results.append(norm_diff)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        }
    ]
}