{
    "hands_on_practices": [
        {
            "introduction": "This practice introduces the Tassie model in its most transparent form, using the idealized scenario of a nucleus with a sharp, incompressible surface. By analytically deriving the transition density $\\delta\\rho_L(\\boldsymbol{r})$ and the form factor $F_L(q)$, you will gain a fundamental understanding of how collective surface oscillations are described within this hydrodynamic picture. This exercise () lays the essential groundwork for tackling more realistic, and computationally intensive, descriptions of giant resonances.",
            "id": "3607963",
            "problem": "Consider an isoscalar electric giant resonance of multipolarity $L \\geq 1$ in a spherical nucleus modeled by a sharp-surface ground-state density $\\rho_{0}(r)=\\rho_{0}\\,\\Theta(R-r)$, where $\\Theta$ is the Heaviside step function, $\\rho_{0}$ is a constant bulk density, and $R=r_{0} A^{1/3}$ with $r_{0}$ a constant and $A$ the mass number. Adopt the Tassie picture of an incompressible, irrotational surface oscillation described by a displacement field $\\boldsymbol{\\xi}(\\boldsymbol{r})=\\nabla\\left[\\alpha\\, r^{L} Y_{LM}(\\Omega)\\right]$ inside the nucleus, with $\\nabla\\cdot\\boldsymbol{\\xi}=0$ in the nuclear interior. Choose the amplitude parameter $\\alpha$ such that the radial surface displacement is $\\xi_{r}(R,\\Omega)=\\beta_{L}\\,R\\,Y_{LM}(\\Omega)$, where $\\beta_{L}$ is a dimensionless amplitude and $Y_{LM}(\\Omega)$ are the spherical harmonics normalized by $\\int d\\Omega\\,Y_{LM}^{*}(\\Omega)Y_{LM}(\\Omega)=1$.\n\nWorking to first order in the oscillation amplitude, use the linearized continuity equation $\\delta\\rho(\\boldsymbol{r})=-\\nabla\\cdot\\left[\\rho_{0}(r)\\,\\boldsymbol{\\xi}(\\boldsymbol{r})\\right]$ to:\n\n1) Derive the transition density $\\delta\\rho_{L}(\\boldsymbol{r})$ in distributional form for this sharp-surface Tassie model.\n\n2) Define the $L$th-multipole form factor as the spherical multipole projection of the three-dimensional Fourier-Bessel transform,\n$$\nF_{L}(q)\\equiv \\int d^{3}r\\, j_{L}(q r)\\,Y_{LM}^{*}(\\Omega)\\,\\delta\\rho_{L}(\\boldsymbol{r}),\n$$\nwhere $j_{L}$ is the spherical Bessel function of the first kind. Derive a closed-form expression for $F_{L}(q)$.\n\n3) In the long-wavelength limit $qR\\ll 1$, expand $j_{L}(x)$ to leading order and, using $R=r_{0}A^{1/3}$, extract the explicit $A$-dependence of the leading term of $F_{L}(q)$. \n\nProvide as your final answer a single closed-form analytic expression for the leading-order small-$q$ form of $F_{L}(q)$ in terms of the symbols $\\rho_{0}$, $\\beta_{L}$, $r_{0}$, $A$, $L$, and $q$, using compact standard constants (for example, double factorials) where appropriate. Do not include units in the final expression.",
            "solution": "The problem concerns small-amplitude surface oscillations of a spherical, sharp-surface nucleus within the Tassie model. The fundamental base consists of the linearized continuity equation for the transition density, the incompressibility condition in the interior, and the specification of the sharp-surface density and irrotational displacement field.\n\nFirst, recall the linearized continuity equation for the transition density,\n$$\n\\delta\\rho(\\boldsymbol{r})=-\\nabla\\cdot\\left[\\rho_{0}(r)\\,\\boldsymbol{\\xi}(\\boldsymbol{r})\\right].\n$$\nWe have $\\rho_{0}(r)=\\rho_{0}\\,\\Theta(R-r)$, so $\\nabla\\rho_{0}(r)=-\\rho_{0}\\,\\delta(r-R)\\,\\hat{\\boldsymbol{r}}$, where $\\delta(r-R)$ is the Dirac delta distribution and $\\hat{\\boldsymbol{r}}$ is the radial unit vector. Using the product rule,\n$$\n\\delta\\rho(\\boldsymbol{r})=-\\left[\\boldsymbol{\\xi}(\\boldsymbol{r})\\cdot\\nabla\\rho_{0}(r) + \\rho_{0}(r)\\,\\nabla\\cdot\\boldsymbol{\\xi}(\\boldsymbol{r})\\right].\n$$\nInside the nucleus the flow is incompressible, so $\\nabla\\cdot\\boldsymbol{\\xi}=0$ for $r<R$. Because $\\rho_{0}(r)=0$ for $r>R$, the only nonvanishing contribution away from $r<R$ is at the surface through $\\nabla\\rho_{0}(r)$. Thus,\n$$\n\\delta\\rho(\\boldsymbol{r})= -\\boldsymbol{\\xi}(\\boldsymbol{r})\\cdot\\left[-\\rho_{0}\\,\\delta(r-R)\\,\\hat{\\boldsymbol{r}}\\right] = \\rho_{0}\\,\\delta(r-R)\\,\\xi_{r}(R,\\Omega),\n$$\nwhere $\\xi_{r}(R,\\Omega)$ is the radial component of the displacement at the surface. By the problem’s definition of the amplitude, $\\xi_{r}(R,\\Omega)=\\beta_{L}\\,R\\,Y_{LM}(\\Omega)$. Therefore, the Tassie transition density for a sharp surface is purely a surface term,\n$$\n\\delta\\rho_{L}(\\boldsymbol{r}) = \\rho_{0}\\,\\beta_{L}\\,R\\,\\delta(r-R)\\,Y_{LM}(\\Omega).\n$$\n\nNext, compute the multipole form factor,\n$$\nF_{L}(q)=\\int d^{3}r\\, j_{L}(q r)\\,Y_{LM}^{*}(\\Omega)\\,\\delta\\rho_{L}(\\boldsymbol{r}).\n$$\nInsert the expression for $\\delta\\rho_{L}(\\boldsymbol{r})$ and use spherical coordinates $d^{3}r=r^{2}\\,dr\\,d\\Omega$:\n$$\nF_{L}(q)=\\rho_{0}\\,\\beta_{L}\\,R\\int_{0}^{\\infty} dr\\,r^{2}\\, j_{L}(q r)\\,\\delta(r-R)\\int d\\Omega\\,Y_{LM}^{*}(\\Omega)\\,Y_{LM}(\\Omega).\n$$\nWith the normalization $\\int d\\Omega\\,Y_{LM}^{*}(\\Omega)Y_{LM}(\\Omega)=1$, the angular integral equals $1$. The radial integral is evaluated using the delta distribution,\n$$\n\\int_{0}^{\\infty} dr\\,r^{2}\\, j_{L}(q r)\\,\\delta(r-R)=R^{2}\\,j_{L}(qR).\n$$\nThus,\n$$\nF_{L}(q)=\\rho_{0}\\,\\beta_{L}\\,R^{3}\\,j_{L}(qR).\n$$\n\nFinally, consider the long-wavelength limit $qR\\ll 1$. The small-argument expansion of the spherical Bessel function of order $L$ is\n$$\nj_{L}(x)=\\frac{x^{L}}{(2L+1)!!}+\\mathcal{O}\\!\\left(x^{L+2}\\right),\n$$\nwhere $(2L+1)!!=(2L+1)(2L-1)\\cdots 3\\cdot 1$. Keeping only the leading term,\n$$\nF_{L}(q)\\approx \\rho_{0}\\,\\beta_{L}\\,R^{3}\\,\\frac{(qR)^{L}}{(2L+1)!!} = \\frac{\\rho_{0}\\,\\beta_{L}}{(2L+1)!!}\\,R^{L+3}\\,q^{L}.\n$$\nUsing $R=r_{0}\\,A^{1/3}$ gives\n$$\nR^{L+3}=\\left(r_{0}\\,A^{1/3}\\right)^{L+3}=r_{0}^{\\,L+3}\\,A^{(L+3)/3}.\n$$\nTherefore, the leading-order small-$q$ form factor and its explicit $A$-scaling are\n$$\nF_{L}(q)\\approx \\frac{\\rho_{0}\\,\\beta_{L}\\,r_{0}^{\\,L+3}}{(2L+1)!!}\\,A^{(L+3)/3}\\,q^{L}.\n$$\nThis expression embodies the comparison with $A^{1/3}$ via the power $(L+3)/3$ and shows how the form factor scales with nuclear size at fixed $q$ in the long-wavelength limit.",
            "answer": "$$\\boxed{\\frac{\\rho_{0}\\,\\beta_{L}\\,r_{0}^{\\,L+3}}{(2L+1)!!}\\,A^{(L+3)/3}\\,q^{L}}$$"
        },
        {
            "introduction": "Building on the theoretical foundations, this practice bridges the gap between the model and experimental reality by focusing on a key observable: the reduced electric quadrupole transition probability, $B(E2)$. You will derive and then computationally implement expressions for $B(E2)$ for both the idealized sharp-surface model and a more realistic nucleus with a diffuse surface. This comparative exercise () provides direct, quantitative insight into how physical refinements like surface diffuseness impact predictions for nuclear collective excitations.",
            "id": "3607986",
            "problem": "You will implement and compare two computational predictions for the reduced electric quadrupole transition probability $B(E2)$ in a mid-mass nucleus, based on the Tassie model for giant resonances. Specifically, you will compare a sharp-surface approximation against a finite-diffuseness treatment. The goal is to derive from first principles and then code the expressions for $B(E2)$ using a physically consistent charge density, demonstrate the numerical differences induced by the finite surface diffuseness, and report the results for a small test suite.\n\nStart from the following fundamental base:\n- Continuity of mass and charge, together with a small-amplitude surface displacement field for an irrotational, incompressible flow (the Tassie model for giant resonances). Let the nuclear surface displacement be $\\delta R(\\Omega) = \\Delta Y_{2\\mu}(\\Omega)$, where $\\Delta$ is a small amplitude with units of length and $Y_{2\\mu}(\\Omega)$ are Condon-Shortley normalized spherical harmonics satisfying $\\int |Y_{\\ell m}(\\Omega)|^2 \\, d\\Omega = 1$.\n- For a spherically symmetric equilibrium proton density $\\rho_p(r)$, the first-order transition density is $\\delta \\rho_p(r,\\Omega) = -\\delta R(\\Omega)\\, \\frac{d\\rho_p(r)}{dr}$.\n- The electric multipole operator is $T_{2\\mu} = e \\int r^2 Y_{2\\mu}(\\Omega)\\, \\rho_p(r,\\Omega)\\, d^3r$, where $e$ is the elementary charge, and the reduced transition probability for an electric quadrupole is $B(E2; 0^+ \\rightarrow 2^+) = \\left\\langle 2 \\left\\| T_2 \\right\\| 0 \\right\\rangle^2$. By the Wigner-Eckart theorem and the normalization of the spherical harmonics, for an initial state with total angular momentum $J_i=0$, $B(E2) = (2\\cdot 2 + 1)\\, | \\langle 2\\mu | T_{2\\mu} | 0 \\rangle |^2 = 5\\, |M(E2)|^2$, where $M(E2)$ is the single-component matrix element.\n\nDerive from this base, without introducing any shortcut formulas, the expressions you will implement:\n- In the sharp-surface Tassie approximation, use a constant proton density inside a sphere of radius $R$ and zero outside, i.e., $\\rho_p(r) = \\rho_0 \\, \\Theta(R - r)$, where $\\Theta$ is the Heaviside step function and $\\rho_0$ is determined by the constraint $\\int \\rho_p(\\mathbf{r})\\, d^3 r = Z$. Express $R$ in terms of the mass number $A$ by $R = r_0 A^{1/3}$ with $r_0$ a constant. Use the derived $M(E2)$ to compute $B(E2)$.\n- In the finite-diffuseness case, use a Two-Parameter Fermi (2pF) distribution for the proton density, $\\rho_p(r) = \\rho_0 \\left[1 + \\exp\\left(\\frac{r - c}{a}\\right)\\right]^{-1}$, with $c$ the half-density radius, $a$ the surface diffuseness, and $\\rho_0$ fixed by the normalization $\\int \\rho_p(\\mathbf{r})\\, d^3 r = Z$. Use the derived $M(E2)$ to compute $B(E2)$.\n\nImplementation details and constraints:\n- Carry out all derivations first and then implement them in code. You may use numerical integration for the finite-diffuseness case (for example, integrate from $r=0$ to $r \\to \\infty$), ensuring proper normalization of $\\rho_0$ by enforcing $4\\pi \\int_0^\\infty \\rho_p(r)\\, r^2\\, dr = Z$. For the sharp-surface case, use the exact normalization for $\\rho_0$ and the exact integral implied by the step density.\n- For all calculations, express your final $B(E2)$ values in units of $e^2\\, \\mathrm{fm}^4$. Treat $e$ as a unit factor, i.e., set $e=1$, so the numerical outputs are in $e^2\\, \\mathrm{fm}^4$. Round each reported float to six decimal places.\n\nTest suite:\n- Use the following three test cases, all for a mid-mass nucleus with $A=120$ and $Z=50$:\n    1. $(A=120, Z=50, r_0=1.2\\, \\mathrm{fm}, a=0.05\\, \\mathrm{fm}, \\Delta=0.1\\, \\mathrm{fm})$\n    2. $(A=120, Z=50, r_0=1.2\\, \\mathrm{fm}, a=0.5\\, \\mathrm{fm}, \\Delta=0.1\\, \\mathrm{fm})$\n    3. $(A=120, Z=50, r_0=1.2\\, \\mathrm{fm}, a=0.9\\, \\mathrm{fm}, \\Delta=0.1\\, \\mathrm{fm})$\n- For the finite-diffuseness radius parameter, set $c = r_0 A^{1/3}$.\n\nRequired final output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order $[B_{\\mathrm{sharp}}^{(1)}, B_{\\mathrm{fd}}^{(1)}, \\mathrm{ratio}^{(1)}, B_{\\mathrm{sharp}}^{(2)}, B_{\\mathrm{fd}}^{(2)}, \\mathrm{ratio}^{(2)}, B_{\\mathrm{sharp}}^{(3)}, B_{\\mathrm{fd}}^{(3)}, \\mathrm{ratio}^{(3)}]$, where $B_{\\mathrm{sharp}}^{(i)}$ is the sharp-surface result in $e^2\\, \\mathrm{fm}^4$, $B_{\\mathrm{fd}}^{(i)}$ is the finite-diffuseness result in $e^2\\, \\mathrm{fm}^4$, and $\\mathrm{ratio}^{(i)} = B_{\\mathrm{fd}}^{(i)} / B_{\\mathrm{sharp}}^{(i)}$ is dimensionless. Each number must be rounded to six decimal places.",
            "solution": "The problem requires the derivation and implementation of expressions for the reduced electric quadrupole transition probability, $B(E2)$, within the Tassie model, for two different nuclear proton density distributions: a sharp-surface uniform sphere and a finite-diffuseness Two-Parameter Fermi (2pF) distribution. The entire derivation will be performed from the given first principles.\n\nThe reduced transition probability for a $0^+ \\to 2^+$ transition is given as $B(E2) = 5 |M(E2)|^2$, where $M(E2)$ is the single-component transition matrix element. This matrix element is calculated by integrating the electric quadrupole operator over the transition proton density $\\delta\\rho_p(r, \\Omega)$.\nThe operator component is $e r^2 Y_{2\\mu}^*(\\Omega)$ and the transition density is $\\delta\\rho_p(r, \\Omega) = -\\Delta Y_{2\\mu}(\\Omega) \\frac{d\\rho_p(r)}{dr}$, where $\\rho_p(r)$ is the spherically symmetric ground-state proton density.\n\nThe matrix element is thus:\n$$ M(E2) = \\int e r^2 Y_{2\\mu}^*(\\Omega) \\delta\\rho_p(r, \\Omega) d^3r $$\nSubstituting the expression for $\\delta\\rho_p$ and using $d^3r = r^2 dr d\\Omega$:\n$$ M(E2) = \\int_0^\\infty \\int_{\\Omega} e r^2 Y_{2\\mu}^*(\\Omega) \\left(-\\Delta Y_{2\\mu}(\\Omega) \\frac{d\\rho_p(r)}{dr}\\right) r^2 dr d\\Omega $$\nWe can separate the radial and angular integrals:\n$$ M(E2) = -e\\Delta \\left( \\int_0^\\infty r^4 \\frac{d\\rho_p(r)}{dr} dr \\right) \\left( \\int_{\\Omega} Y_{2\\mu}^*(\\Omega) Y_{2\\mu}(\\Omega) d\\Omega \\right) $$\nGiven the Condon-Shortley normalization $\\int |Y_{2\\mu}(\\Omega)|^2 d\\Omega = 1$, the angular integral is unity.\n$$ M(E2) = -e\\Delta \\int_0^\\infty r^4 \\frac{d\\rho_p(r)}{dr} dr $$\nTo simplify this expression and improve its numerical stability, we use integration by parts on the radial integral. Let $u = r^4$ and $dv = \\frac{d\\rho_p(r)}{dr} dr$. Then $du = 4r^3 dr$ and $v = \\rho_p(r)$.\n$$ \\int_0^\\infty r^4 \\frac{d\\rho_p(r)}{dr} dr = \\left[ r^4 \\rho_p(r) \\right]_0^\\infty - \\int_0^\\infty 4r^3 \\rho_p(r) dr $$\nThe boundary term $[r^4 \\rho_p(r)]_0^\\infty$ evaluates to zero. At $r=0$, it is zero. As $r \\to \\infty$, the nuclear density $\\rho_p(r)$ decays exponentially, which is much faster than the growth of any polynomial $r^4$, so the term is also zero.\nThus, the matrix element simplifies to:\n$$ M(E2) = -e\\Delta \\left( -4 \\int_0^\\infty r^3 \\rho_p(r) dr \\right) = 4e\\Delta \\int_0^\\infty r^3 \\rho_p(r) dr $$\nThe reduced transition probability is then:\n$$ B(E2) = 5 |M(E2)|^2 = 5 \\left( 4e\\Delta \\int_0^\\infty r^3 \\rho_p(r) dr \\right)^2 = 80 (e\\Delta)^2 \\left( \\int_0^\\infty r^3 \\rho_p(r) dr \\right)^2 $$\nAs per the problem, we set the elementary charge $e=1$. Let's define the third radial moment of the density as $J_3 = \\int_0^\\infty r^3 \\rho_p(r) dr$.\n$$ B(E2) = 80 \\Delta^2 J_3^2 $$\nWe now apply this general formula to the two specified density models.\n\n**1. Sharp-Surface Model**\nThe proton density is $\\rho_p(r) = \\rho_0 \\Theta(R-r)$, where $R = r_0 A^{1/3}$ and $\\Theta$ is the Heaviside step function. The normalization constant $\\rho_0$ is found by requiring the volume integral of the density to be the proton number, $Z$.\n$$ Z = \\int \\rho_p(r) d^3r = 4\\pi \\int_0^\\infty \\rho_p(r) r^2 dr = 4\\pi \\int_0^R \\rho_0 r^2 dr = 4\\pi \\rho_0 \\frac{R^3}{3} $$\nThis gives $\\rho_0 = \\frac{3Z}{4\\pi R^3}$.\nNow we compute the moment $J_3$:\n$$ J_3^{\\text{sharp}} = \\int_0^\\infty r^3 \\rho_p(r) dr = \\int_0^R r^3 \\rho_0 dr = \\rho_0 \\frac{R^4}{4} $$\nSubstituting the expression for $\\rho_0$:\n$$ J_3^{\\text{sharp}} = \\left( \\frac{3Z}{4\\pi R^3} \\right) \\frac{R^4}{4} = \\frac{3ZR}{16\\pi} $$\nFinally, we obtain the analytical expression for $B(E2)$ in the sharp-surface model:\n$$ B(E2)_{\\text{sharp}} = 80 \\Delta^2 (J_3^{\\text{sharp}})^2 = 80 \\Delta^2 \\left( \\frac{3ZR}{16\\pi} \\right)^2 = 80 \\Delta^2 \\frac{9Z^2 R^2}{256\\pi^2} $$\n$$ B(E2)_{\\text{sharp}} = \\frac{5 \\times 16 \\times 9}{16 \\times 16} \\frac{\\Delta^2 Z^2 R^2}{\\pi^2} = \\frac{45 \\Delta^2 Z^2 R^2}{16\\pi^2} $$\nUsing $R = r_0 A^{1/3}$, we get:\n$$ B(E2)_{\\text{sharp}} = \\frac{45 \\Delta^2 Z^2 r_0^2 A^{2/3}}{16\\pi^2} $$\n\n**2. Finite-Diffuseness Model**\nThe proton density is given by the 2pF distribution: $\\rho_p(r) = \\rho_0 \\left[1 + \\exp\\left(\\frac{r-c}{a}\\right)\\right]^{-1}$, with $ c = r_0 A^{1/3}$.\nThe normalization constant $\\rho_0$ must be determined numerically. Let's define the un-normalized moments $K_n$:\n$$ K_n = \\int_0^\\infty \\frac{r^n}{1 + \\exp\\left(\\frac{r-c}{a}\\right)} dr $$\nThe normalization condition is $Z = 4\\pi \\int_0^\\infty \\rho_p(r) r^2 dr = 4\\pi \\rho_0 K_2$, which gives:\n$$ \\rho_0 = \\frac{Z}{4\\pi K_2} $$\nThe third moment $J_3$ is:\n$$ J_3^{\\text{fd}} = \\int_0^\\infty r^3 \\rho_p(r) dr = \\rho_0 \\int_0^\\infty \\frac{r^3}{1 + \\exp\\left(\\frac{r-c}{a}\\right)} dr = \\rho_0 K_3 $$\nSubstituting for $\\rho_0$:\n$$ J_3^{\\text{fd}} = \\left( \\frac{Z}{4\\pi K_2} \\right) K_3 = \\frac{Z}{4\\pi} \\frac{K_3}{K_2} $$\nThe $B(E2)$ value is then:\n$$ B(E2)_{\\text{fd}} = 80 \\Delta^2 (J_3^{\\text{fd}})^2 = 80 \\Delta^2 \\left( \\frac{Z K_3}{4\\pi K_2} \\right)^2 = \\frac{80 Z^2 \\Delta^2}{16\\pi^2} \\left( \\frac{K_3}{K_2} \\right)^2 $$\n$$ B(E2)_{\\text{fd}} = \\frac{5 Z^2 \\Delta^2}{\\pi^2} \\left( \\frac{K_3}{K_2} \\right)^2 $$\nThe integrals $K_2$ and $K_3$ do not have simple analytical solutions and must be computed numerically. The implementation will use numerical quadrature to evaluate these integrals for each test case.\n\n**Summary of Computational Formulae**\nFor all calculations, we use $e=1$.\n- **Sharp-Surface**:\n  $$ B(E2)_{\\text{sharp}} = \\frac{45 \\Delta^2 Z^2 r_0^2 A^{2/3}}{16\\pi^2} $$\n  Units: With $\\Delta$ and $r_0$ in fm, the result is in $e^2 \\text{fm}^4$.\n- **Finite-Diffuseness**:\n  $$ B(E2)_{\\text{fd}} = \\frac{5 Z^2 \\Delta^2}{\\pi^2} \\left( \\frac{K_3}{K_2} \\right)^2 $$\n  where $K_n = \\int_0^\\infty \\frac{r^n}{1 + \\exp\\left(\\frac{r - r_0 A^{1/3}}{a}\\right)} dr$.\n  The integrals $K_2$ and $K_3$ are evaluated numerically.\n\nThese formulae will now be implemented to solve for the given test suite.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import integrate\n\ndef solve():\n    \"\"\"\n    Calculates and compares B(E2) transition probabilities for a mid-mass nucleus\n    using the Tassie model with sharp-surface and finite-diffuseness (2pF)\n    proton density distributions.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {'A': 120, 'Z': 50, 'r0': 1.2, 'a': 0.05, 'Delta': 0.1},\n        {'A': 120, 'Z': 50, 'r0': 1.2, 'a': 0.5, 'Delta': 0.1},\n        {'A': 120, 'Z': 50, 'r0': 1.2, 'a': 0.9, 'Delta': 0.1},\n    ]\n\n    results = []\n\n    for params in test_cases:\n        A = params['A']\n        Z = params['Z']\n        r0 = params['r0']\n        a = params['a']\n        Delta = params['Delta']\n\n        # Principle: The reduced transition probability B(E2) is derived from\n        # the Tassie model, leading to distinct formulae for sharp and diffuse\n        # nuclear surfaces. We implement these derived formulae.\n\n        # --- Sharp-Surface Model Calculation ---\n        # This is an analytical formula derived in the solution.\n        # B_sharp = (45 * Delta^2 * Z^2 * r0^2 * A^(2/3)) / (16 * pi^2)\n        # It's independent of the diffuseness 'a', so it's the same for all cases.\n        b_sharp = (45.0 / (16.0 * np.pi**2)) * Delta**2 * Z**2 * r0**2 * A**(2.0/3.0)\n\n        # --- Finite-Diffuseness (2pF) Model Calculation ---\n        # The half-density radius c is set to the equivalent sharp radius.\n        c = r0 * A**(1.0/3.0)\n\n        # Principle: B(E2)_fd is proportional to the square of a ratio of\n        # moments of the 2pF density distribution, K_3 / K_2.\n        # These moments K_n = integral[r^n / (1 + exp((r-c)/a))]dr must be\n        # computed numerically.\n        \n        # Integrand for the K_2 moment of the 2pF distribution shape\n        def integrand_k2(r, c_val, a_val):\n            return r**2 / (1.0 + np.exp((r - c_val) / a_val))\n\n        # Integrand for the K_3 moment of the 2pF distribution shape\n        def integrand_k3(r, c_val, a_val):\n            return r**3 / (1.0 + np.exp((r - c_val) / a_val))\n\n        # Perform numerical integration using SciPy's quad function.\n        # The integration is from 0 to infinity.\n        k2_val, k2_err = integrate.quad(integrand_k2, 0, np.inf, args=(c, a))\n        k3_val, k3_err = integrate.quad(integrand_k3, 0, np.inf, args=(c, a))\n        \n        # Calculate B(E2) using the derived formula for the 2pF model.\n        # B_fd = (5 * Z^2 * Delta^2 / pi^2) * (K_3 / K_2)^2\n        if k2_val == 0:\n            # This case is physically not expected but included for robustness.\n            b_fd = 0.0\n        else:\n            b_fd = (5.0 * Z**2 * Delta**2 / np.pi**2) * (k3_val / k2_val)**2\n\n        # --- Ratio Calculation ---\n        # The ratio compares the effect of surface diffuseness to the sharp-surface\n        # approximation.\n        if b_sharp == 0:\n            ratio = 0.0\n        else:\n            ratio = b_fd / b_sharp\n\n        results.extend([b_sharp, b_fd, ratio])\n\n    # Final print statement in the exact required format.\n    # Each value is rounded to six decimal places.\n    formatted_results = [f\"{x:.6f}\" for x in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "A central task in computational physics is not just to produce numbers, but to ensure their accuracy and reliability. This practice focuses on the crucial step of numerical validation within the context of the Tassie model. You will investigate the convergence of a key radial integral, $I_\\lambda[\\rho_0]$, by testing its independence from the underlying mesh spacing and comparing the converged result against the known analytical benchmark for a sharp-surface nucleus (). This exercise develops essential skills for verifying the robustness of your computational models.",
            "id": "3608014",
            "problem": "You are asked to implement a numerical validation of mesh-spacing independence for a radial integral associated with the Tassie model for isoscalar giant resonances. The goal is to demonstrate that the computed quantity converges as the radial mesh spacing is refined, and to compare the converged value against an analytic sharp-surface benchmark.\n\nBackground and definitions:\n- Consider a spherically symmetric equilibrium density profile $\\rho_0(r)$ for a nucleus. In the Tassie model, the transition density for an isoscalar multipole of order $\\lambda$ is obtained from the linearized continuity equation using a displacement field proportional to the gradient of a solid harmonic, leading to a radial transition density of the form\n$$\n\\delta \\rho_\\lambda(r) = - \\lambda\\, r^{\\lambda - 1}\\, \\frac{d \\rho_0(r)}{dr}.\n$$\n- Define the radial integral of interest\n$$\nI_\\lambda[\\rho_0] \\equiv \\int_0^\\infty dr\\, r^{\\lambda + 2}\\, \\delta \\rho_\\lambda(r).\n$$\n- In the analytic sharp-surface limit, take $\\rho_0(r) = \\rho_c\\, \\Theta(R - r)$, where $\\Theta$ is the Heaviside function, $\\rho_c$ is the central density, and $R$ is the sharp nuclear radius. In this case, the benchmark value is\n$$\nI_\\lambda^{\\mathrm{sharp}} = \\lambda\\, \\rho_c\\, R^{2\\lambda + 1}.\n$$\n- For a numerically tractable and physically realistic profile, use a two-parameter Fermi function (also known as a Woods–Saxon form for density),\n$$\n\\rho_0(r) = \\frac{\\rho_c}{1 + \\exp\\!\\left(\\frac{r - R}{a}\\right)},\n$$\nwith diffuseness parameter $a > 0$ controlling the surface thickness. Its derivative $d \\rho_0 / dr$ is to be evaluated analytically.\n\nTasks:\n1. Implement a function that, given integers $\\lambda \\ge 1$, real parameters $R > 0$, $a > 0$, $\\rho_c > 0$, a radial cutoff $r_{\\max} > 0$, and a mesh spacing $h > 0$ (all lengths in femtometers (fm), densities in $\\mathrm{fm}^{-3}$), computes the numerical approximation to\n$$\nI_\\lambda^{(h)} = \\int_0^{r_{\\max}} dr\\, r^{\\lambda + 2}\\, \\delta \\rho_\\lambda(r)\n$$\nwith $\\delta \\rho_\\lambda(r) = - \\lambda r^{\\lambda - 1} \\frac{d \\rho_0}{dr}$ using the composite trapezoidal rule on a uniform mesh of spacing $h$. Use the analytic derivative of the Fermi function.\n2. For a given list of mesh spacings $\\{h_i\\}$, compute the relative dispersion with respect to the finest mesh $h_{\\min}$,\n$$\nD = \\max_i \\frac{\\left| I_\\lambda^{(h_i)} - I_\\lambda^{(h_{\\min})} \\right|}{\\left| I_\\lambda^{(h_{\\min})} \\right|}.\n$$\n3. Compute the relative deviation from the analytic sharp-surface benchmark using the finest mesh,\n$$\nE = \\frac{I_\\lambda^{(h_{\\min})} - I_\\lambda^{\\mathrm{sharp}}}{I_\\lambda^{\\mathrm{sharp}}}.\n$$\n4. For each test case defined below, return the pair $[D, E]$ as floating-point numbers.\n\nNumerical and physical units:\n- All length parameters ($r$, $R$, $a$, $r_{\\max}$, and $h$) are in femtometers (fm).\n- The density $\\rho_c$ is in $\\mathrm{fm}^{-3}$.\n- The integral $I_\\lambda$ has units that depend on $\\lambda$; however, you are only asked to report dimensionless relative quantities $D$ and $E$.\n- Angles do not appear in this problem and require no specification.\n- Do not express any result as a percentage; use decimal fractions.\n\nTest suite:\nImplement your program to compute results for the following parameter sets. Each parameter set is specified as a tuple $(\\lambda, R, a, \\rho_c, r_{\\max}, \\{h_i\\})$:\n\n- Case A (general, smooth surface): $(2,\\ 6.5,\\ 0.55,\\ 0.16,\\ 20.0,\\ [0.4,\\ 0.2,\\ 0.1])$.\n- Case B (moderately sharp surface): $(3,\\ 7.0,\\ 0.20,\\ 0.16,\\ 25.0,\\ [0.5,\\ 0.25,\\ 0.125])$.\n- Case C (very sharp surface; edge case for resolution): $(3,\\ 5.0,\\ 0.05,\\ 0.16,\\ 15.0,\\ [0.2,\\ 0.1,\\ 0.05])$.\n\nImplementation requirements:\n- Your program must produce a single line of output containing the results for the three cases as a comma-separated list of lists, each inner list containing two floating-point numbers $[D, E]$ for the corresponding case, enclosed in a single pair of square brackets, for example:\n\"[ [D_A,E_A], [D_B,E_B], [D_C,E_C] ]\"\n- Use numerically stable vectorized operations for evaluating the density derivative and the integral.\n- Choose $r_{\\max}$ sufficiently large to ensure the contribution beyond $r_{\\max}$ is negligible for the given $a$ and $R$ values.\n- No user input is required; all parameters are hard-coded as specified above.\n\nYour task is to write a complete and runnable program that performs these computations and prints the results in the exact specified format.",
            "solution": "The problem requires a numerical validation of a radial integral derived from the Tassie model of nuclear giant resonances. This involves three main computational tasks:\n1.  Numerically computing the integral $I_\\lambda^{(h)}$ for various mesh spacings $h$ using the composite trapezoidal rule.\n2.  Quantifying the convergence of the numerical integral as the mesh is refined by calculating the relative dispersion $D$.\n3.  Comparing the converged numerical result with an analytic sharp-surface benchmark $I_\\lambda^{\\mathrm{sharp}}$ by calculating the relative deviation $E$.\n\nThe process is broken down into the following steps:\n\n1.  **Formulation of the Integrand**\n    The integral of interest is defined as $I_\\lambda[\\rho_0] \\equiv \\int_0^\\infty dr\\, r^{\\lambda + 2}\\, \\delta \\rho_\\lambda(r)$, which for numerical computation is truncated at a sufficiently large radius $r_{\\max}$:\n    $$\n    I_\\lambda^{(h)} = \\int_0^{r_{\\max}} dr\\, r^{\\lambda + 2}\\, \\delta \\rho_\\lambda(r)\n    $$\n    The transition density $\\delta \\rho_\\lambda(r)$ is given by:\n    $$\n    \\delta \\rho_\\lambda(r) = - \\lambda\\, r^{\\lambda - 1}\\, \\frac{d \\rho_0(r)}{dr}\n    $$\n    Substituting this into the integral, the integrand $f(r)$ becomes:\n    $$\n    f(r) = r^{\\lambda + 2} \\left( - \\lambda\\, r^{\\lambda - 1}\\, \\frac{d \\rho_0(r)}{dr} \\right) = - \\lambda\\, r^{2\\lambda + 1}\\, \\frac{d \\rho_0(r)}{dr}\n    $$\n    The equilibrium density $\\rho_0(r)$ is modeled by a two-parameter Fermi function:\n    $$\n    \\rho_0(r) = \\frac{\\rho_c}{1 + \\exp\\!\\left(\\frac{r - R}{a}\\right)}\n    $$\n    where $R$ is the half-density radius, $a$ is the diffuseness parameter, and $\\rho_c$ is the central density. The problem requires using the analytic derivative of this function. Using the chain rule, we find:\n    $$\n    \\frac{d \\rho_0(r)}{dr} = - \\frac{\\rho_c}{a} \\frac{\\exp\\left(\\frac{r - R}{a}\\right)}{\\left[1 + \\exp\\left(\\frac{r - R}{a}\\right)\\right]^2}\n    $$\n    For enhanced numerical stability, this expression can be rewritten using the hyperbolic secant function, $\\text{sech}(x) = 2 / (e^x + e^{-x})$:\n    $$\n    \\frac{d \\rho_0(r)}{dr} = - \\frac{\\rho_c}{4a} \\frac{1}{\\cosh^2\\left(\\frac{r - R}{2a}\\right)} = - \\frac{\\rho_c}{4a} \\text{sech}^2\\left(\\frac{r - R}{2a}\\right)\n    $$\n    Substituting this stable form into the expression for the integrand $f(r)$ yields:\n    $$\n    f(r) = - \\lambda\\, r^{2\\lambda + 1} \\left( - \\frac{\\rho_c}{4a} \\text{sech}^2\\left(\\frac{r - R}{2a}\\right) \\right) = \\frac{\\lambda \\rho_c}{4a} r^{2\\lambda + 1} \\text{sech}^2\\left(\\frac{r - R}{2a}\\right)\n    $$\n    This is the final expression for the function to be integrated. Since $\\lambda \\ge 1$, the term $r^{2\\lambda+1}$ ensures that $f(0)=0$.\n\n2.  **Numerical Integration**\n    The integral $I_\\lambda^{(h)}$ is computed using the composite trapezoidal rule on a uniform radial grid. A grid of points $r_i$ is generated from $r_0=0$ to $r_N=r_{\\max}$ with a constant step size $h$. The integral is approximated as:\n    $$\n    I_\\lambda^{(h)} \\approx h \\left[ \\frac{f(r_0) + f(r_N)}{2} + \\sum_{i=1}^{N-1} f(r_i) \\right]\n    $$\n    This procedure is implemented efficiently using vectorized operations in Python with NumPy, specifically the `numpy.trapz` function, which takes an array of function values and the corresponding coordinates.\n\n3.  **Calculation of Convergence and Deviation Metrics**\n    For each test case, a list of mesh spacings $\\{h_i\\}$ is provided. The following quantities are calculated:\n    \n    *   **Relative Dispersion ($D$)**: This metric quantifies the convergence of the numerical result. It is the maximum relative difference between the integral computed with any mesh spacing $h_i$ and the integral computed with the finest mesh, $h_{\\min} = \\min(\\{h_i\\})$. Let $I_\\lambda^{(h_{\\min})}$ be the integral value for the finest mesh.\n        $$\n        D = \\max_i \\frac{\\left| I_\\lambda^{(h_i)} - I_\\lambda^{(h_{\\min})} \\right|}{\\left| I_\\lambda^{(h_{\\min})} \\right|}\n        $$\n\n    *   **Relative Deviation from Benchmark ($E$)**: This metric compares the most accurate numerical result ($I_\\lambda^{(h_{\\min})}$) to the analytic result for a sharp-surface nucleus, $I_\\lambda^{\\mathrm{sharp}}$. A small value of $E$ indicates that the Fermi-function-based result is close to the idealized sharp-surface limit, which is expected for small diffuseness $a$.\n        $$\n        I_\\lambda^{\\mathrm{sharp}} = \\lambda\\, \\rho_c\\, R^{2\\lambda + 1}\n        $$\n        $$\n        E = \\frac{I_\\lambda^{(h_{\\min})} - I_\\lambda^{\\mathrm{sharp}}}{I_\\lambda^{\\mathrm{sharp}}}\n        $$\n\n4.  **Algorithmic Implementation**\n    The solution is structured as a Python program that iterates through the provided test cases. For each case, specified by the tuple $(\\lambda, R, a, \\rho_c, r_{\\max}, \\{h_i\\})$:\n    a. A loop is executed over the mesh spacings $\\{h_i\\}$ to compute and store each $I_\\lambda^{(h_i)}$.\n    b. Inside the loop, a radial grid is constructed, the integrand $f(r)$ is evaluated at each grid point, and `numpy.trapz` is called to perform the integration.\n    c. After all integrals are computed for the case, $h_{\\min}$ and $I_\\lambda^{(h_{\\min})}$ are identified.\n    d. The value of $D$ is computed by finding the maximum relative difference.\n    e. The benchmark value $I_\\lambda^{\\mathrm{sharp}}$ is calculated.\n    f. The value of $E$ is computed using $I_\\lambda^{(h_{\\min})}$ and $I_\\lambda^{\\mathrm{sharp}}$.\n    g. The resulting pair $[D, E]$ is stored.\n    \n    After processing all cases, the collected list of pairs is formatted into the specified string format `[[D_A,E_A],[D_B,E_B],[D_C,E_C]]` and printed to standard output.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes numerical validation metrics for the Tassie model integral.\n\n    This program validates the mesh-spacing independence of a radial integral\n    from the Tassie model for giant resonances. It computes the integral for\n    a Fermi-function density profile using the trapezoidal rule for several\n    mesh spacings. It then calculates the relative dispersion (D) to check for\n    convergence and the relative deviation (E) from an analytic sharp-surface\n    benchmark.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (lambda, R, a, rho_c, r_max, h_values)\n    test_cases = [\n        # Case A (general, smooth surface)\n        (2, 6.5, 0.55, 0.16, 20.0, [0.4, 0.2, 0.1]),\n        # Case B (moderately sharp surface)\n        (3, 7.0, 0.20, 0.16, 25.0, [0.5, 0.25, 0.125]),\n        # Case C (very sharp surface; edge case for resolution)\n        (3, 5.0, 0.05, 0.16, 15.0, [0.2, 0.1, 0.05]),\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        _lambda, R, a, rho_c, r_max, h_values = case\n\n        integral_results = {}\n\n        # 1. Compute the numerical integral for each mesh spacing h\n        for h in h_values:\n            # Create a uniform radial mesh from 0 to r_max with spacing h.\n            # Using np.linspace ensures the endpoint r_max is included and\n            # avoids floating point inaccuracies with np.arange.\n            num_points = int(round(r_max / h)) + 1\n            r = np.linspace(0.0, r_max, num_points)\n\n            # Evaluate the integrand.\n            # The integrand is f(r) = (lambda * rho_c / (4*a)) * r**(2*lambda+1) * sech^2((r-R)/(2*a))\n            # This form is numerically stable.\n            # sech(x) = 1/cosh(x)\n            \n            # Handle potential r=0 and power of 0 issues for generality, although not for this problem's parameters.\n            # For r=0, r**(positive) is 0, so integrand is 0.\n            r_power_term = np.power(r, 2 * _lambda + 1)\n            \n            cosh_arg = (r - R) / (2 * a)\n            cosh_val = np.cosh(cosh_arg)\n            sech_sq_val = np.power(cosh_val, -2)\n\n            integrand = (_lambda * rho_c / (4 * a)) * r_power_term * sech_sq_val\n\n            # Compute the integral using the composite trapezoidal rule.\n            integral_val = np.trapz(integrand, r)\n            integral_results[h] = integral_val\n\n        # 2. Compute the relative dispersion D\n        h_min = min(h_values)\n        I_h_min = integral_results[h_min]\n\n        if np.abs(I_h_min) == 0.0:\n            # This case should not occur with the given parameters.\n            # If I_h_min is 0, D is 0 if all other integrals are also 0,\n            # otherwise it's infinite. We assume it's well-behaved.\n            D = 0.0\n            for h in h_values:\n                if np.abs(integral_results[h]) > 0.0:\n                    D = np.inf\n                    break\n        else:\n            relative_diffs = [np.abs(val - I_h_min) / np.abs(I_h_min) for val in integral_results.values()]\n            D = max(relative_diffs)\n\n        # 3. Compute the relative deviation E from the sharp-surface benchmark\n        # I_sharp = lambda * rho_c * R**(2*lambda + 1)\n        I_sharp = _lambda * rho_c * np.power(R, 2 * _lambda + 1)\n\n        if I_sharp == 0.0:\n            E = np.nan # Should not happen\n        else:\n            E = (I_h_min - I_sharp) / I_sharp\n        \n        all_results.append([D, E])\n\n    # 4. Format the final output string as specified.\n    # e.g., \"[[D_A,E_A],[D_B,E_B],[D_C,E_C]]\" with no spaces.\n    inner_strings = [f\"[{d},{e}]\" for d, e in all_results]\n    final_output_str = f\"[{','.join(inner_strings)}]\"\n    \n    print(final_output_str)\n\nsolve()\n```"
        }
    ]
}