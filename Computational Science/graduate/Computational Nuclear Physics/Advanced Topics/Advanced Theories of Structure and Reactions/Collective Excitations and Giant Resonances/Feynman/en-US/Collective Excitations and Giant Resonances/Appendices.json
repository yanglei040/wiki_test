{
    "hands_on_practices": [
        {
            "introduction": "This first practice grounds our study in the analytical foundations of collective motion. You will explore the famous Thomas-Reiche-Kuhn (TRK) sum rule, a cornerstone for understanding electromagnetic transitions, and its enhancement by nuclear interactions. By performing the derivation that connects this enhancement to the nucleon effective mass, you will gain a deep, first-principles understanding of how the in-medium properties of nucleons govern the collective response of the nucleus .",
            "id": "3549862",
            "problem": "Consider a nucleus described within a locally gauge-invariant Skyrme Energy Density Functional (EDF), restricted to the time-even sector and to second order in spatial gradients. Let the single-particle dynamics be characterized by an isoscalar effective mass field $m^{*}(\\mathbf{r})$ such that the mean-field kinetic operator reads $-\\nabla \\cdot \\left(\\frac{\\hbar^{2}}{2 m^{*}(\\mathbf{r})} \\nabla \\right)$. The energy-weighted sum rule $m_{1}$ for a one-body operator $\\hat{F}$ is defined by the double commutator\n$$\nm_{1}(\\hat{F}) \\equiv \\frac{1}{2} \\langle 0 | [\\hat{F}, [\\hat{H}, \\hat{F}]] | 0 \\rangle,\n$$\nwhere $\\hat{H}$ is the self-consistent Hartree-Fock Hamiltonian obtained from the Skyrme EDF and $|0\\rangle$ is the Hartree-Fock ground state. Assume the Skyrme EDF strictly respects local gauge (Galilean) invariance so that the continuity equation is satisfied for the total density and, separately, for proton and neutron densities.\n\nStarting from these foundations, and without introducing any phenomenological sum-rule shortcuts, perform the following:\n\n1. For a general local isoscalar one-body operator of the form $\\hat{F}_{\\mathrm{IS}} = \\sum_{i} f(\\mathbf{r}_{i})$, use the continuity equation and the commutator structure to determine whether the energy-weighted sum $m_{1}(\\hat{F}_{\\mathrm{IS}})$ depends on the isoscalar effective mass $m^{*}(\\mathbf{r})$ or only on the bare nucleon mass $m$. Your analysis should be valid for arbitrary smooth $f(\\mathbf{r})$ and a realistic, finite nucleus ground-state density $\\rho(\\mathbf{r})$.\n\n2. For the isovector electric dipole operator corrected for center-of-mass motion, $\\hat{F}_{\\mathrm{IV}} = \\sum_{p} z_{p} - \\frac{Z}{A} \\sum_{i} z_{i}$ (equivalently, proportional to the proton-neutron center separation), derive the structure of $m_{1}(\\hat{F}_{\\mathrm{IV}})$ by evaluating the double commutator and identifying the contribution from the velocity-dependent parts of the Skyrme EDF. Show that the energy-weighted sum can be written as the Thomas-Reiche-Kuhn (TRK) value multiplied by an enhancement factor $1+\\kappa$, where $\\kappa$ arises from the isovector current/kinetic couplings of the functional.\n\n3. Connect the enhancement factor $\\kappa$ to the effective mass in the isovector channel $m_{v}^{*}$ by analyzing the proton-neutron continuity equations and the corresponding inertia of the isovector current. Then, under the simplifying assumption appropriate to symmetric nuclear matter and to Skyrme parameterizations where $m_{v}^{*} \\approx m^{*}$, express the enhancement factor $\\kappa$ in closed form solely in terms of the isoscalar effective mass ratio $m^{*}/m$.\n\nYour final answer must be a single closed-form analytic expression for $\\kappa$ in terms of $m^{*}/m$. No numerical evaluation is required.",
            "solution": "The problem asks for an analysis of energy-weighted sum rules (EWSRs) within the framework of a Skyrme Energy Density Functional (EDF), focusing on the role of effective mass. We must first validate the problem statement, which is found to be scientifically sound, well-posed, and a standard theoretical exercise in nuclear structure physics. We proceed with the solution, addressing each of the three parts in sequence.\n\nThe energy-weighted sum rule $m_1$ for a one-body operator $\\hat{F}$ is defined by the double commutator with the Hamiltonian $\\hat{H}$:\n$$\nm_{1}(\\hat{F}) \\equiv \\frac{1}{2} \\langle 0 | [\\hat{F}, [\\hat{H}, \\hat{F}]] | 0 \\rangle\n$$\nwhere $|0\\rangle$ is the Hartree-Fock ground state.\n\n**Part 1: Isoscalar Sum Rule**\n\nFor a general local isoscalar one-body operator of the form $\\hat{F}_{\\mathrm{IS}} = \\sum_{i} f(\\mathbf{r}_{i})$, we evaluate the sum rule. We can write $\\hat{F}_{\\mathrm{IS}}$ as an integral over the particle density operator $\\hat{\\rho}(\\mathbf{r}) = \\sum_i \\delta(\\mathbf{r}-\\mathbf{r}_i)$:\n$$\n\\hat{F}_{\\mathrm{IS}} = \\int f(\\mathbf{r}) \\hat{\\rho}(\\mathbf{r}) d^3r\n$$\nThe evaluation of the sum rule is greatly simplified by using the continuity equation, which the problem states is satisfied due to the local gauge (Galilean) invariance of the EDF. The continuity equation in operator form is given by the Heisenberg equation of motion for the density operator:\n$$\n[\\hat{H}, \\hat{\\rho}(\\mathbf{r})] = -i\\hbar \\nabla \\cdot \\hat{\\mathbf{j}}(\\mathbf{r})\n$$\nwhere $\\hat{\\mathbf{j}}(\\mathbf{r})$ is the total particle current operator. A fundamental consequence of Galilean invariance is that the particle current operator is related to the momentum density operator via the bare nucleon mass $m$, irrespective of the potential terms that lead to an effective mass in the mean-field description. The isoscalar current operator is:\n$$\n\\hat{\\mathbf{j}}(\\mathbf{r}) = \\frac{1}{m} \\sum_{i} \\frac{1}{2} \\{ \\hat{\\mathbf{p}}_i, \\delta(\\mathbf{r}-\\mathbf{r}_i) \\}\n$$\nUsing this, we compute the inner commutator:\n$$\n[\\hat{H}, \\hat{F}_{\\mathrm{IS}}] = \\int f(\\mathbf{r}) [\\hat{H}, \\hat{\\rho}(\\mathbf{r})] d^3r = -i\\hbar \\int f(\\mathbf{r}) (\\nabla \\cdot \\hat{\\mathbf{j}}(\\mathbf{r})) d^3r\n$$\nIntegrating by parts and assuming boundary terms at infinity vanish, we obtain:\n$$\n[\\hat{H}, \\hat{F}_{\\mathrm{IS}}] = i\\hbar \\int (\\nabla f(\\mathbf{r})) \\cdot \\hat{\\mathbf{j}}(\\mathbf{r}) d^3r\n$$\nNow, we evaluate the outer commutator. The operator $\\hat{F}_{\\mathrm{IS}}$ is a function of coordinates only, while $\\hat{\\mathbf{j}}(\\mathbf{r})$ is linear in momentum. Their commutator is a c-number multiplied by the density operator.\n$$\n[\\hat{F}_{\\mathrm{IS}}, \\hat{\\mathbf{j}}(\\mathbf{r}')] = \\left[ \\sum_i f(\\mathbf{r}_i), \\frac{1}{2m} \\sum_j \\{ \\hat{\\mathbf{p}}_j, \\delta(\\mathbf{r}'-\\mathbf{r}_j) \\} \\right] = \\frac{1}{m} \\sum_i [f(\\mathbf{r}_i), \\hat{\\mathbf{p}}_i] \\delta(\\mathbf{r}'-\\mathbf{r}_i)\n$$\nUsing the canonical commutation relation $[f(\\mathbf{r}_i), \\hat{\\mathbf{p}}_i] = i\\hbar \\nabla_i f(\\mathbf{r}_i)$, we get:\n$$\n[\\hat{F}_{\\mathrm{IS}}, \\hat{\\mathbf{j}}(\\mathbf{r}')] = \\frac{i\\hbar}{m} \\sum_i (\\nabla_i f(\\mathbf{r}_i)) \\delta(\\mathbf{r}'-\\mathbf{r}_i) = \\frac{i\\hbar}{m} (\\nabla' f(\\mathbf{r}')) \\hat{\\rho}(\\mathbf{r}')\n$$\nSubstituting this back into the double commutator:\n$$\n[\\hat{F}_{\\mathrm{IS}}, [\\hat{H}, \\hat{F}_{\\mathrm{IS}}]] = i\\hbar \\int (\\nabla f(\\mathbf{r})) \\cdot [\\hat{F}_{\\mathrm{IS}}, \\hat{\\mathbf{j}}(\\mathbf{r})] d^3r = i\\hbar \\int (\\nabla f(\\mathbf{r})) \\cdot \\left( \\frac{i\\hbar}{m} (\\nabla f(\\mathbf{r})) \\hat{\\rho}(\\mathbf{r}) \\right) d^3r = -\\frac{\\hbar^2}{m} \\int |\\nabla f(\\mathbf{r})|^2 \\hat{\\rho}(\\mathbf{r}) d^3r\n$$\nFinally, we take the expectation value in the ground state $|0\\rangle$, where $\\langle 0 | \\hat{\\rho}(\\mathbf{r}) | 0 \\rangle = \\rho_0(\\mathbf{r})$ is the ground-state density.\n$$\nm_1(\\hat{F}_{\\mathrm{IS}}) = \\frac{1}{2} \\left\\langle 0 \\left| -\\frac{\\hbar^2}{m} \\int |\\nabla f(\\mathbf{r})|^2 \\hat{\\rho}(\\mathbf{r}) d^3r \\right| 0 \\right\\rangle = \\frac{\\hbar^2}{2m} \\int |\\nabla f(\\mathbf{r})|^2 \\rho_0(\\mathbf{r}) d^3r\n$$\nThe sum rule for the local isoscalar operator $\\hat{F}_{\\mathrm{IS}}$ depends only on the bare nucleon mass $m$ and not on the isoscalar effective mass $m^*(\\mathbf{r})$. This is a direct consequence of Galilean invariance, which dictates the form of the conserved particle current.\n\n**Part 2: Isovector Dipole Sum Rule**\n\nWe consider the isovector electric dipole operator corrected for center-of-mass motion, $\\hat{F}_{\\mathrm{IV}} = \\sum_{p} z_{p} - \\frac{Z}{A} \\sum_{i} z_{i}$. This can be rewritten as $\\hat{F}_{\\mathrm{IV}} = \\frac{N}{A} \\sum_p z_p - \\frac{Z}{A} \\sum_n z_n$. The sum rule is composed of two parts: one from the kinetic energy operator $\\hat{T} = \\sum_i \\hat{\\mathbf{p}}_i^2/(2m)$, and one from the potential energy operator $\\hat{V}$.\n$$\nm_{1}(\\hat{F}_{\\mathrm{IV}}) = \\frac{1}{2} \\langle 0 | [\\hat{F}_{\\mathrm{IV}}, [\\hat{T}, \\hat{F}_{\\mathrm{IV}}]] | 0 \\rangle + \\frac{1}{2} \\langle 0 | [\\hat{F}_{\\mathrm{IV}}, [\\hat{V}, \\hat{F}_{\\mathrm{IV}}]] | 0 \\rangle\n$$\nThe first term is the model-independent Thomas-Reiche-Kuhn (TRK) sum rule value. Let $q_i$ be the \"dipole charge\" ($N/A$ for protons, $-Z/A$ for neutrons), so $\\hat{F}_{\\mathrm{IV}} = \\sum_i q_i z_i$. The kinetic part of the double commutator is:\n$$\n[\\hat{F}_{\\mathrm{IV}}, [\\hat{T}, \\hat{F}_{\\mathrm{IV}}]] = \\left[\\sum_j q_j z_j, \\left[\\sum_k \\frac{p_{z,k}^2}{2m}, \\sum_l q_l z_l\\right]\\right] = \\left[\\sum_j q_j z_j, \\sum_k q_k \\frac{-i\\hbar p_{z,k}}{m}\\right] = \\sum_k q_k^2 \\frac{-i\\hbar}{m} [z_k, p_{z,k}] = \\frac{\\hbar^2}{m} \\sum_k q_k^2\n$$\nThe sum of charges squared is $\\sum_k q_k^2 = Z(N/A)^2 + N(-Z/A)^2 = \\frac{ZN^2+NZ^2}{A^2} = \\frac{ZN(N+Z)}{A^2} = \\frac{NZ}{A}$.\nThus, the TRK part is:\n$$\nm_{1, \\mathrm{TRK}} = \\frac{1}{2} \\frac{\\hbar^2}{m} \\frac{NZ}{A}\n$$\nThe second term, involving the potential $\\hat{V}$, arises because the nuclear interaction contains momentum-dependent exchange terms (velocity-dependent forces). These terms do not commute with the isovector operator $\\hat{F}_{\\mathrm{IV}}$. This contribution is known as the enhancement factor, $\\kappa$.\n$$\n\\frac{1}{2} \\langle 0 | [\\hat{F}_{\\mathrm{IV}}, [\\hat{V}, \\hat{F}_{\\mathrm{IV}}]] | 0 \\rangle = \\kappa \\cdot m_{1, \\mathrm{TRK}}\n$$\nTherefore, the total energy-weighted sum is $m_1(\\hat{F}_{\\mathrm{IV}}) = m_{1, \\mathrm{TRK}} (1+\\kappa)$. The factor $\\kappa$ encapsulates the effects of the velocity-dependent and isovector-sensitive parts of the nuclear interaction, which are also responsible for the emergence of effective masses in the mean field.\n\n**Part 3: Enhancement Factor and Effective Mass**\n\nThe problem asks to connect $\\kappa$ to the isovector effective mass $m_v^*$ by considering the inertia of the isovector current. The EWSR can be generically understood as being inversely proportional to the inertia of the collective mode being excited.\n$$\nm_1(\\hat{F}) = \\frac{\\hbar^2}{2 M_{\\mathrm{eff}}}\n$$\nwhere $M_{\\mathrm{eff}}$ is the effective inertia associated with the operator $\\hat{F}$.\nFor the isovector dipole mode, the relevant motion is the oscillation of protons against neutrons. The operator $\\hat{F}_{\\mathrm{IV}}$ generates this motion. The TRK sum rule corresponds to the case where the inertia is given by the bare mass $m$. The inertia for this mode is $M_{\\mathrm{IV, bare}} \\propto m$.\nThe presence of velocity-dependent nuclear forces modifies this inertia. The effective inertia, $M_{\\mathrm{IV, eff}}$, is determined by the full dynamics, including these forces. The very definition of the effective mass for a given mode is the mass that describes its inertial properties. For the isovector mode, this is the isovector effective mass, $m_v^*$. Therefore, the effective inertia is proportional to this mass: $M_{\\mathrm{IV, eff}} \\propto m_v^*$.\n\nThe enhancement of the sum rule is the ratio of the bare inertia to the effective inertia:\n$$\n1+\\kappa = \\frac{m_1(\\hat{F}_{\\mathrm{IV}})}{m_{1, \\mathrm{TRK}}} = \\frac{\\hbar^2/(2M_{\\mathrm{IV, eff}})}{\\hbar^2/(2M_{\\mathrm{IV, bare}})} = \\frac{M_{\\mathrm{IV, bare}}}{M_{\\mathrm{IV, eff}}}\n$$\nSince the inertias are proportional to the respective masses ($m$ and $m_v^*$), we have:\n$$\n1+\\kappa = \\frac{m}{m_v^*}\n$$\nThis provides the direct connection between the enhancement factor $\\kappa$ and the isovector effective mass $m_v^*$ requested by the problem.\n\nFinally, we apply the simplifying assumption that $m_v^* \\approx m^*$, which is appropriate for symmetric nuclear matter and a common feature of many Skyrme parameterizations. By substituting $m_v^*$ with the isoscalar effective mass $m^*$, we obtain the expression for $\\kappa$:\n$$\n1+\\kappa = \\frac{m}{m^*}\n$$\nFrom this, we solve for $\\kappa$:\n$$\n\\kappa = \\frac{m}{m^*} - 1\n$$\nThis final expression relates the enhancement of the isovector dipole sum rule to the isoscalar effective mass, under the specified assumptions.",
            "answer": "$$\n\\boxed{\\frac{m}{m^{\\ast}} - 1}\n$$"
        },
        {
            "introduction": "Moving from pure theory to a tangible computational model, this exercise demonstrates the physical consequences of gauge invariance in the Random Phase Approximation (RPA). You will implement a schematic RPA calculation and selectively \"switch off\" the time-odd parts of the nuclear interaction, which are intrinsically linked to nuclear currents. This allows you to directly observe how these crucial terms, required for a self-consistent description, affect the centroid energies of giant resonances .",
            "id": "3549905",
            "problem": "You are tasked to implement a self-consistent linear response computation, in a schematic but physically grounded Random Phase Approximation (RPA), to quantify the impact of switching off selected time-odd channels in a nuclear Energy Density Functional (EDF) on the centroid energies of the Isovector Giant Dipole Resonance (IVGDR) and the Isoscalar Giant Quadrupole Resonance (ISGQR). The program must be a complete, runnable Python script that uses first-principles linear response and a single particle-hole collective mode approximation. Your implementation must compute the centroid energies from an RPA eigenfrequency, with and without the specified time-odd current contributions, and return the shifts in the centroid energies caused by switching off the specified time-odd channels. The final numerical answers must be expressed in mega-electron-volts (MeV), rounded to three decimal places.\n\nBegin from the following foundational bases and definitions:\n- Time-Dependent Hartree-Fock (TDHF) linearization and the equation-of-motion approach yield the RPA description of small-amplitude collective excitations. In a single collective mode approximation, the RPA eigenfrequency $\\,\\omega\\,$ is the centroid energy of that mode in units of energy (electron-volts), and satisfies a quadratic equation determined by the generalized stiffness (time-even mean-field and residual interaction) and the dynamical self-consistent current coupling (time-odd residual interaction).\n- The canonical commutation relations and the continuity equation impose constraints linking time-even velocity-dependent terms and time-odd current terms; these constraints embody gauge invariance. When time-odd contributions are switched off inconsistently, the centroid energies depart from the self-consistent values.\n\nModel and quantities to be used:\n- Consider a nucleus characterized by mass number $\\,A\\,$, proton number $\\,Z\\,$, and neutron number $\\,N\\,$. Use a spherical equivalent nuclear radius $\\,R = r_0 A^{1/3}\\,$ with $\\,r_0 = 1.2\\,\\mathrm{fm}\\,$. The mean-field produces unperturbed particle-hole energies $\\,\\varepsilon_{\\mathrm{IV}}\\,$ and $\\,\\varepsilon_{\\mathrm{IS}}\\,$ for the isovector dipole and isoscalar quadrupole channels, respectively (given in MeV).\n- Two channels of the EDF residual interaction are used in the schematic RPA:\n  1. Time-even channel with coupling constants $\\,g^{\\mathrm{TE}}_{\\mathrm{IV}}\\,$ and $\\,g^{\\mathrm{TE}}_{\\mathrm{IS}}\\,$ (in $\\mathrm{MeV}\\cdot\\mathrm{fm}$).\n  2. Time-odd channel with coupling constants $\\,g^{\\mathrm{TO}}_{\\mathrm{IV}}\\,$ and $\\,g^{\\mathrm{TO}}_{\\mathrm{IS}}\\,$ (in $\\mathrm{MeV}\\cdot\\mathrm{fm}$).\n- For each mode $\\,X\\in\\{\\mathrm{IV},\\mathrm{IS}\\}\\,$, define a dimensionless normalized collective form factor $\\,s_X(A,Z,N)\\,$ which scales with the corresponding transition matrix element and nuclear size. For scientific realism and numerical stability across nuclei, use the following normalized scalings:\n  - Isovector dipole: $\\,s_{\\mathrm{IV}}(A,Z,N) = \\dfrac{\\sqrt{N Z / A}}{R}\\,$.\n  - Isoscalar quadrupole: $\\,s_{\\mathrm{IS}}(A) = \\dfrac{\\sqrt{A}}{R}\\,$.\n- In the single-mode RPA, the generalized stiffness is increased by the time-even residual interaction contribution and the dynamical coupling is provided by the time-odd current contribution. Switching off selected time-odd channels means setting the corresponding time-odd coupling to zero while keeping the time-even channel unchanged.\n\nComputation steps your program must implement:\n1. For each test case, compute the radius $\\,R\\,$ and the form factors $\\,s_{\\mathrm{IV}}\\,$ and $\\,s_{\\mathrm{IS}}\\,$ using the formulas above.\n2. For each mode $\\,X\\,$, build the schematic RPA matrix characterized by a diagonal element $\\,A_X = \\varepsilon_X + g^{\\mathrm{TE}}_X\\, s_X\\,$ and an off-diagonal element $\\,B_X = g^{\\mathrm{TO}}_X\\, s_X\\,$, both in $\\mathrm{MeV}$.\n3. Compute the self-consistent centroid energy (full EDF) $\\,E^{\\mathrm{full}}_X = \\sqrt{A_X^2 - B_X^2}\\,$ in $\\mathrm{MeV}$.\n4. Compute the centroid energy with the selected time-odd channel switched off, $\\,E^{\\mathrm{off}}_X = \\sqrt{A_X^2 - \\tilde{B}_X^2}\\,$, where $\\,\\tilde{B}_X = 0\\,$ if that channel is switched off for mode $\\,X\\,$; otherwise $\\,\\tilde{B}_X = B_X\\,$.\n5. Quantify the impact as the energy shift $\\,\\Delta E_X = E^{\\mathrm{off}}_X - E^{\\mathrm{full}}_X\\,$ in $\\mathrm{MeV}$, rounded to three decimal places.\n\nAngle units are not applicable. The final output must be a single line containing a comma-separated list enclosed in square brackets with the shifts for each test case in the order specified below. All energies must be expressed in $\\mathrm{MeV}$.\n\nTest suite:\n- Use the following four parameter sets. For each case, the last two boolean entries indicate whether the time-odd channel is switched off in the isovector (IV) and isoscalar (IS) mode, respectively. The entries are $(A,Z,N,\\varepsilon_{\\mathrm{IV}},\\varepsilon_{\\mathrm{IS}},g^{\\mathrm{TE}}_{\\mathrm{IV}},g^{\\mathrm{TO}}_{\\mathrm{IV}},g^{\\mathrm{TE}}_{\\mathrm{IS}},g^{\\mathrm{TO}}_{\\mathrm{IS}},\\mathrm{off\\_IV},\\mathrm{off\\_IS})$.\n\n1. $(208,82,126,11.0,12.0,3.0,2.2,1.5,1.2,\\mathrm{True},\\mathrm{True})$\n2. $(120,50,70,10.8,11.6,2.8,2.0,1.3,1.1,\\mathrm{True},\\mathrm{False})$\n3. $(40,20,20,12.0,11.0,2.0,1.8,1.0,0.8,\\mathrm{True},\\mathrm{True})$\n4. $(208,82,126,11.0,12.0,3.0,3.8,1.5,2.5,\\mathrm{False},\\mathrm{True})$\n\nRequired final output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The list must contain eight entries in this exact order: $[\\Delta E_{\\mathrm{IV},1},\\Delta E_{\\mathrm{IS},1},\\Delta E_{\\mathrm{IV},2},\\Delta E_{\\mathrm{IS},2},\\Delta E_{\\mathrm{IV},3},\\Delta E_{\\mathrm{IS},3},\\Delta E_{\\mathrm{IV},4},\\Delta E_{\\mathrm{IS},4}]$, where each $\\,\\Delta E\\,$ is in $\\mathrm{MeV}$ rounded to three decimal places.",
            "solution": "The problem is valid as it is scientifically grounded in the Random Phase Approximation (RPA) of nuclear physics, well-posed with a complete set of parameters and clear, unambiguous formulae, and computationally feasible. The objective is to quantify the energy shift of giant resonances when time-odd components of the nuclear energy density functional are artificially removed, which is a standard procedure in theoretical nuclear structure physics to assess the importance of specific interaction terms.\n\nThe solution proceeds by first establishing the theoretical framework based on the provided schematic RPA model and then implementing the computational steps for each test case.\n\nThe centroid energy of a collective excitation mode $X$, where $X$ is either the Isovector Giant Dipole Resonance ($\\mathrm{IV}$) or the Isoscalar Giant Quadrupole Resonance ($\\mathrm{IS}$), is given by the RPA eigenfrequency $\\omega_X$. In the single collective mode approximation, this energy is calculated as:\n$$\nE_X = \\omega_X = \\sqrt{A_X^2 - B_X^2}\n$$\nwhere all energies are expressed in units of mega-electron-volts ($\\mathrm{MeV}$). The terms $A_X$ and $B_X$ represent the effects of the residual interaction in the particle-hole channel.\n\nThe diagonal element $A_X$ is determined by the unperturbed particle-hole energy $\\varepsilon_X$ and the time-even (TE) part of the residual interaction:\n$$\nA_X = \\varepsilon_X + g^{\\mathrm{TE}}_X s_X\n$$\nHere, $g^{\\mathrm{TE}}_X$ is the time-even coupling constant (in $\\mathrm{MeV}\\cdot\\mathrm{fm}$), and $s_X$ is a dimensionless normalized collective form factor. Physically, $A_X$ contributes to the overall stiffness of the system against the collective deformation.\n\nThe off-diagonal element $B_X$ arises from the time-odd (TO) part of the residual interaction, which is related to nuclear currents and provides the dynamical coupling in the RPA equations:\n$$\nB_X = g^{\\mathrm{TO}}_X s_X\n$$\nHere, $g^{\\mathrm{TO}}_X$ is the time-odd coupling constant (in $\\mathrm{MeV}\\cdot\\mathrm{fm}$). The condition for a stable ground state, leading to a real-valued energy $E_X$, is $A_X^2 \\ge B_X^2$.\n\nThe form factors $s_X$ are calculated based on the nuclear properties: mass number $A$, proton number $Z$, and neutron number $N$. The nuclear radius $R$ is first computed using the liquid-drop model formula:\n$$\nR = r_0 A^{1/3}, \\quad \\text{with } r_0 = 1.2\\,\\mathrm{fm}\n$$\nThe form factors for the two modes are then:\n$$\ns_{\\mathrm{IV}}(A,Z,N) = \\frac{\\sqrt{N Z / A}}{R} \\quad (\\text{in fm}^{-1})\n$$\n$$\ns_{\\mathrm{IS}}(A) = \\frac{\\sqrt{A}}{R} \\quad (\\text{in fm}^{-1})\n$$\n\nThe problem requires calculating the shift in centroid energy, $\\Delta E_X$, when the time-odd channel for a given mode $X$ is switched off. This is a computational experiment to probe the physical impact of these terms.\n\nThe self-consistent centroid energy, with all interaction channels active, is denoted as $E^{\\mathrm{full}}_X$:\n$$\nE^{\\mathrm{full}}_X = \\sqrt{A_X^2 - B_X^2}\n$$\nWhen the time-odd channel for mode $X$ is switched off, the corresponding coupling constant $g^{\\mathrm{TO}}_X$ is set to zero. This results in a modified off-diagonal element $\\tilde{B}_X = 0$. The new centroid energy, $E^{\\mathrm{off}}_X$, is:\n$$\nE^{\\mathrm{off}}_X = \\sqrt{A_X^2 - \\tilde{B}_X^2}\n$$\nIf the channel is switched off, $\\tilde{B}_X = 0$, and the energy simplifies to $E^{\\mathrm{off}}_X = \\sqrt{A_X^2} = |A_X|$. As the parameters are chosen such that $A_X > 0$, this becomes $E^{\\mathrm{off}}_X = A_X$. If the channel is not switched off, then $\\tilde{B}_X = B_X$, and $E^{\\mathrm{off}}_X = E^{\\mathrm{full}}_X$.\n\nThe energy shift, which quantifies the impact of this modification, is defined as:\n$$\n\\Delta E_X = E^{\\mathrm{off}}_X - E^{\\mathrm{full}}_X\n$$\nIf the time-odd channel is active, $\\Delta E_X = 0$. If it is switched off, the shift will be $\\Delta E_X = A_X - \\sqrt{A_X^2 - B_X^2}$.\n\nThe computational procedure for each test case is as follows:\n1.  Given the parameters $(A,Z,N,\\varepsilon_{\\mathrm{IV}},\\varepsilon_{\\mathrm{IS}},g^{\\mathrm{TE}}_{\\mathrm{IV}},g^{\\mathrm{TO}}_{\\mathrm{IV}},g^{\\mathrm{TE}}_{\\mathrm{IS}},g^{\\mathrm{TO}}_{\\mathrm{IS}},\\mathrm{off\\_IV},\\mathrm{off\\_IS})$.\n2.  Calculate the nuclear radius $R$.\n3.  Calculate the form factors $s_{\\mathrm{IV}}$ and $s_{\\mathrm{IS}}$.\n4.  For the isovector mode ($\\mathrm{IV}$):\n    a. Determine if the time-odd channel is switched off from the $\\mathrm{off\\_IV}$ flag.\n    b. If not, the shift $\\Delta E_{\\mathrm{IV}}$ is $0$.\n    c. If yes, calculate $A_{\\mathrm{IV}} = \\varepsilon_{\\mathrm{IV}} + g^{\\mathrm{TE}}_{\\mathrm{IV}} s_{\\mathrm{IV}}$ and $B_{\\mathrm{IV}} = g^{\\mathrm{TO}}_{\\mathrm{IV}} s_{\\mathrm{IV}}$.\n    d. Compute the shift $\\Delta E_{\\mathrm{IV}} = A_{\\mathrm{IV}} - \\sqrt{A_{\\mathrm{IV}}^2 - B_{\\mathrm{IV}}^2}$.\n5.  For the isoscalar mode ($\\mathrm{IS}$):\n    a. Determine if the time-odd channel is switched off from the $\\mathrm{off\\_IS}$ flag.\n    b. If not, the shift $\\Delta E_{\\mathrm{IS}}$ is $0$.\n    c. If yes, calculate $A_{\\mathrm{IS}} = \\varepsilon_{\\mathrm{IS}} + g^{\\mathrm{TE}}_{\\mathrm{IS}} s_{\\mathrm{IS}}$ and $B_{\\mathrm{IS}} = g^{\\mathrm{TO}}_{\\mathrm{IS}} s_{\\mathrm{IS}}$.\n    d. Compute the shift $\\Delta E_{\\mathrm{IS}} = A_{\\mathrm{IS}} - \\sqrt{A_{\\mathrm{IS}}^2 - B_{\\mathrm{IS}}^2}$.\n6.  Round the final shifts $\\Delta E_{\\mathrm{IV}}$ and $\\Delta E_{\\mathrm{IS}}$ to three decimal places.\n7.  Collect all results from all test cases into a single list in the specified order.\n\nThis structured procedure is implemented in the provided Python script to solve for the given test suite.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the centroid energy shifts for giant resonances based on a schematic\n    Random Phase Approximation (RPA) model.\n    \"\"\"\n\n    # Constant for nuclear radius calculation\n    r0 = 1.2  # in fm\n\n    # Test suite:\n    # (A, Z, N, eps_IV, eps_IS, g_TE_IV, g_TO_IV, g_TE_IS, g_TO_IS, off_IV, off_IS)\n    test_cases = [\n        (208, 82, 126, 11.0, 12.0, 3.0, 2.2, 1.5, 1.2, True, True),\n        (120, 50, 70, 10.8, 11.6, 2.8, 2.0, 1.3, 1.1, True, False),\n        (40, 20, 20, 12.0, 11.0, 2.0, 1.8, 1.0, 0.8, True, True),\n        (208, 82, 126, 11.0, 12.0, 3.0, 3.8, 1.5, 2.5, False, True),\n    ]\n\n    results = []\n\n    for case in test_cases:\n        A, Z, N, eps_iv, eps_is, g_te_iv, g_to_iv, g_te_is, g_to_is, off_iv, off_is = case\n\n        # Step 1: Compute the radius R\n        R = r0 * np.cbrt(A)\n\n        # --- Isovector Mode (IV) Calculation ---\n\n        if not off_iv:\n            delta_e_iv = 0.0\n        else:\n            # Step 2: Compute form factor s_IV\n            s_iv = np.sqrt(N * Z / A) / R\n\n            # Step 3: Build RPA matrix elements A_IV and B_IV\n            A_iv = eps_iv + g_te_iv * s_iv\n            B_iv = g_to_iv * s_iv\n\n            # Steps 4 and 5: Compute energies and shift\n            # E_full = sqrt(A_iv^2 - B_iv^2)\n            # E_off = A_iv (since tilde_B_iv = 0 and A_iv > 0)\n            # Delta_E = E_off - E_full\n            if A_iv**2  B_iv**2:\n                # This case indicates an instability and should not occur with the given parameters\n                # but is handled for robustness.\n                delta_e_iv = np.nan\n            else:\n                e_full_iv = np.sqrt(A_iv**2 - B_iv**2)\n                e_off_iv = A_iv\n                delta_e_iv = e_off_iv - e_full_iv\n\n        # --- Isoscalar Mode (IS) Calculation ---\n\n        if not off_is:\n            delta_e_is = 0.0\n        else:\n            # Step 2: Compute form factor s_IS\n            s_is = np.sqrt(A) / R\n\n            # Step 3: Build RPA matrix elements A_IS and B_IS\n            A_is = eps_is + g_te_is * s_is\n            B_is = g_to_is * s_is\n\n            # Steps 4 and 5: Compute energies and shift\n            if A_is**2  B_is**2:\n                delta_e_is = np.nan \n            else:\n                e_full_is = np.sqrt(A_is**2 - B_is**2)\n                e_off_is = A_is\n                delta_e_is = e_off_is - e_full_is\n        \n        # Round and append results as formatted strings\n        results.append(f\"{delta_e_iv:.3f}\")\n        results.append(f\"{delta_e_is:.3f}\")\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Realistic nuclear structure calculations often face immense computational challenges due to the vast size of the configuration space. This practice introduces a powerful technique to overcome this obstacle: the separable Quasiparticle RPA (QRPA), which is a workhorse of modern nuclear theory. By implementing this method and benchmarking its results against exact sum-rule estimators, you will not only learn a practical computational tool but also explore the subtle effects of ground-state correlations on nuclear observables .",
            "id": "3549830",
            "problem": "Consider a schematic Quasiparticle Random Phase Approximation (QRPA) model for collective excitations with a separable multipole residual interaction that enables extremely large-dimensional calculations. The computational task is to construct the QRPA matrices for a separable interaction and to benchmark centroid and sum-rule fidelity against full self-consistent calculations, in both small-dimensional explicit diagonalizations and a very large-dimensional limit where explicit diagonalization is infeasible.\n\nStart from the following well-tested bases:\n- Linear response theory and the QRPA eigenvalue problem for charge-conserving modes.\n- The definition of the non-energy-weighted sum rule (NEWSR), the energy-weighted sum rule (EWSR), and the centroid of a strength distribution.\n\nModel and definitions:\n- There are $N$ two-quasiparticle configurations labeled by $k \\in \\{0, 1, \\dots, N-1\\}$ with two-quasiparticle energies $2E_k$ (expressed in $\\mathrm{MeV}$).\n- A multipole transition operator is represented by a real coupling vector with components $f_k$ (dimensionless).\n- The residual interaction is separable and is represented at the QRPA level by the matrices\n$$\nA_{kk'} = 2E_k\\,\\delta_{kk'} + \\kappa\\, f_k f_{k'}, \\quad\nB_{kk'} = \\kappa\\, f_k f_{k'},\n$$\nwhere $\\kappa$ is a real coupling constant (expressed in $\\mathrm{MeV}$), and $\\delta_{kk'}$ is the Kronecker delta.\n- The QRPA matrix is the $2N \\times 2N$ block matrix\n$$\n\\mathcal{M} = \\begin{pmatrix}\nA  B\\\\\n- B  - A\n\\end{pmatrix}.\n$$\n- Positive-norm QRPA eigenmodes are obtained from the eigenvalue problem $\\mathcal{M} \\begin{pmatrix} X_i \\\\ Y_i \\end{pmatrix} = \\omega_i \\begin{pmatrix} X_i \\\\ Y_i \\end{pmatrix}$, where $(X_i, Y_i)$ are real vectors and $\\omega_i  0$ are excitation energies (in $\\mathrm{MeV}$). Enforce the QRPA normalization $X_i^\\mathsf{T} X_i - Y_i^\\mathsf{T} Y_i = 1$.\n- The transition strength to the multipole operator for mode $i$ is defined by\n$$\nS_i = \\left| \\sum_{k=0}^{N-1} f_k \\left( X_{ki} + Y_{ki} \\right) \\right|^2,\n$$\nwhich is dimensionless.\n- The non-energy-weighted sum rule is $m_0 = \\sum_i S_i$ (dimensionless).\n- The energy-weighted sum rule is $m_1 = \\sum_i \\omega_i S_i$ (expressed in $\\mathrm{MeV}$).\n- The centroid is defined as $C = m_1/m_0$ (expressed in $\\mathrm{MeV}$).\n- Define the sum-rule estimators without explicit diagonalization by\n$$\nm_0^{\\mathrm{(sr)}} = \\sum_{k=0}^{N-1} f_k^2,\\quad\nm_1^{\\mathrm{(sr)}} = \\sum_{k=0}^{N-1} (2E_k)\\, f_k^2,\\quad\nC^{\\mathrm{(sr)}} = \\frac{m_1^{\\mathrm{(sr)}}}{m_0^{\\mathrm{(sr)}}}.\n$$\n\nTasks:\n1. For finite $N$, explicitly construct $A$, $B$, and $\\mathcal{M}$, solve the QRPA eigenproblem, normalize $(X_i, Y_i)$ to satisfy $X_i^\\mathsf{T} X_i - Y_i^\\mathsf{T} Y_i = 1$, and compute $m_0$, $m_1$, and $C$ by summing over all positive-norm modes with real positive excitation energies.\n2. Compute the sum-rule estimators $m_0^{\\mathrm{(sr)}}$, $m_1^{\\mathrm{(sr)}}$, and $C^{\\mathrm{(sr)}}$ directly from $\\{2E_k\\}$ and $\\{f_k\\}$.\n3. Benchmark fidelity by reporting absolute differences $\\Delta m_0 = |m_0 - m_0^{\\mathrm{(sr)}}|$, $\\Delta m_1 = |m_1 - m_1^{\\mathrm{(sr)}}|$, and $\\Delta C = |C - C^{\\mathrm{(sr)}}|$.\n\nPhysical units:\n- Energies $2E_k$, $\\omega_i$, $m_1$, and $C$ must be expressed in $\\mathrm{MeV}$.\n- $m_0$ and $S_i$ are dimensionless.\n\nAngle unit:\n- All trigonometric functions use arguments in radians.\n\nTest suite:\n- Case 1 (general case): $N = 20$, $2E_k = 30 + 5 \\cos\\!\\left( \\frac{2\\pi k}{N} \\right)$ in $\\mathrm{MeV}$, $f_k = \\sin\\!\\left( \\frac{\\pi (k+1)}{N+1} \\right)$ rescaled so that $\\sum_k f_k^2 = 1$ (dimensionless), $\\kappa = 0.8$ in $\\mathrm{MeV}$.\n- Case 2 (boundary condition, vanishing residual): $N = 10$, $2E_k = 25 + 3 \\cos\\!\\left( \\frac{2\\pi k}{N} \\right)$ in $\\mathrm{MeV}$, $f_k = \\sin\\!\\left( \\frac{2\\pi (k+1)}{N+1} \\right)$ rescaled so that $\\sum_k f_k^2 = 1$ (dimensionless), $\\kappa = 0$ in $\\mathrm{MeV}$.\n- Case 3 (large-dimensional limit): $N = 10^6$, $2E_k = 20$ in $\\mathrm{MeV}$ for all $k$, $f_k = 1/\\sqrt{N}$ so that $\\sum_k f_k^2 = 1$ (dimensionless), $\\kappa = 1.5$ in $\\mathrm{MeV}$. In this case, do not construct or diagonalize $\\mathcal{M}$; report only the sum-rule centroid $C^{\\mathrm{(sr)}}$.\n\nRequired final output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets in the following order:\n  1. $\\Delta m_0$ for Case 1 (dimensionless),\n  2. $\\Delta m_1$ for Case 1 (in $\\mathrm{MeV}$),\n  3. $\\Delta C$ for Case 1 (in $\\mathrm{MeV}$),\n  4. $\\Delta m_0$ for Case 2 (dimensionless),\n  5. $\\Delta m_1$ for Case 2 (in $\\mathrm{MeV}$),\n  6. $\\Delta C$ for Case 2 (in $\\mathrm{MeV}$),\n  7. $C^{\\mathrm{(sr)}}$ for Case 3 (in $\\mathrm{MeV}$).\n\nAll results should be real numbers. The single line must contain precisely seven values in the order above.",
            "solution": "The problem requires a validation of sum-rule estimators against a full Quasiparticle Random Phase Approximation (QRPA) calculation for a schematic model with a separable interaction. This is a standard procedure in computational nuclear physics to assess the quality of approximations that avoid computationally expensive matrix diagonalizations. The solution involves two main components: the direct calculation of sum-rule estimators and the full numerical solution of the QRPA eigenvalue problem.\n\nThe theoretical framework is based on the QRPA equations for a system of $N$ two-quasiparticle configurations. The energies of these unperturbed configurations are given by $\\{2E_k\\}$. The residual interaction is of a separable multipole-multipole form, which simplifies the QRPA matrices $A$ and $B$ as follows:\n$$\nA_{kk'} = 2E_k\\,\\delta_{kk'} + \\kappa\\, f_k f_{k'}, \\quad\nB_{kk'} = \\kappa\\, f_k f_{k'}\n$$\nHere, $\\{f_k\\}$ represents the coupling strengths of the quasiparticle pairs to the collective multipole operator, and $\\kappa$ is the interaction strength. The full QRPA problem is encapsulated in the $2N \\times 2N$ non-Hermitian matrix eigenvalue problem:\n$$\n\\mathcal{M} \\begin{pmatrix} X_i \\\\ Y_i \\end{pmatrix} = \n\\begin{pmatrix} A  B\\\\ -B  -A \\end{pmatrix} \n\\begin{pmatrix} X_i \\\\ Y_i \\end{pmatrix} = \n\\omega_i \\begin{pmatrix} X_i \\\\ Y_i \\end{pmatrix}\n$$\nwhere $\\omega_i$ are the excitation energies and $(X_i, Y_i)$ are the forward and backward QRPA amplitudes for the $i$-th excited state.\n\n**1. Sum-Rule Estimators**\n\nThe sum-rule estimators, denoted with a superscript $(\\text{sr})$, are calculated without solving the QRPA eigenvalue problem. They are based on properties of the unperturbed ground state. The non-energy-weighted sum rule (NEWSR) and energy-weighted sum rule (EWSR) estimators are defined as:\n$$\nm_0^{\\mathrm{(sr)}} = \\sum_{k=0}^{N-1} f_k^2\n$$\n$$\nm_1^{\\mathrm{(sr)}} = \\sum_{k=0}^{N-1} (2E_k)\\, f_k^2\n$$\nThe centroid estimator is the ratio of these two quantities:\n$$\nC^{\\mathrm{(sr)}} = \\frac{m_1^{\\mathrm{(sr)}}}{m_0^{\\mathrm{(sr)}}}\n$$\nFor the test cases, the vector $\\{f_k\\}$ is normalized such that $\\sum_k f_k^2 = 1$, which simplifies the NEWSR estimator to $m_0^{\\mathrm{(sr)}} = 1$.\n\n**2. Full QRPA Calculation**\n\nFor a definitive calculation, the QRPA matrix $\\mathcal{M}$ is constructed and its eigenvalue problem is solved numerically. This yields $2N$ eigenvalues and eigenvectors. The physical solutions correspond to real, positive excitation energies $\\omega_i > 0$.\n\nA critical step is the normalization of the QRPA eigenvectors. A standard numerical eigensolver typically returns eigenvectors $\\mathbf{v}'_i = (X'_i, Y'_i)^T$ normalized to Euclidean unity, i.e., $(\\mathbf{v}'_i)^\\dagger \\mathbf{v}'_i = 1$. However, the physical normalization for a QRPA eigenvector is based on the metric $\\Sigma_3 = \\text{diag}(I, -I)$, and for a positive-norm state is given by:\n$$\nX_i^\\mathsf{T} X_i - Y_i^\\mathsf{T} Y_i = 1\n$$\nThis condition ensures the state corresponds to a physical boson excitation. Therefore, each eigenvector $\\mathbf{v}'_i$ from the eigensolver must be checked. Let $N_i = (X'_i)^\\dagger X'_i - (Y'_i)^\\dagger Y'_i$. If $N_i > 0$, the mode has a positive norm, and the correctly normalized amplitudes are obtained by rescaling: $(X_i, Y_i) = (X'_i, Y'_i) / \\sqrt{N_i}$. Modes with $N_i \\le 0$ are unphysical and are excluded from the sum rule calculations.\n\nThe transition strength $S_i$ for each physical mode $i$ is then calculated using the normalized amplitudes:\n$$\nS_i = \\left| \\sum_{k=0}^{N-1} f_k \\left( X_{ki} + Y_{ki} \\right) \\right|^2\n$$\nThe sum rules are computed by summing over all physical modes (real $\\omega_i > 0$ and positive norm):\n$$\nm_0 = \\sum_i S_i, \\quad m_1 = \\sum_i \\omega_i S_i\n$$\nThe centroid is $C = m_1 / m_0$. Finally, the fidelity of the sum-rule estimators is quantified by the absolute differences: $\\Delta m_0 = |m_0 - m_0^{\\mathrm{(sr)}}|$, $\\Delta m_1 = |m_1 - m_1^{\\mathrm{(sr)}}|$, and $\\Delta C = |C - C^{\\mathrm{(sr)}}|$.\n\n**3. Analysis of Test Cases**\n\n- **Case 1 ($N=20, \\kappa=0.8\\,\\mathrm{MeV}$):** This is a general case where the residual interaction is active. The full numerical procedure described above is applied. The QRPA matrix $\\mathcal{M}$ is a $40 \\times 40$ matrix. We expect non-zero deviations $\\Delta m_0$, $\\Delta m_1$, and $\\Delta C$, as the QRPA correlations renormalize the strength distribution and its moments.\n\n- **Case 2 ($N=10, \\kappa=0\\,\\mathrm{MeV}$):** This case corresponds to a vanishing residual interaction. The matrices $A$ and $B$ become $A_{kk'} = 2E_k\\,\\delta_{kk'}$ and $B_{kk'} = 0$. The QRPA matrix $\\mathcal{M}$ becomes block-diagonal. The eigenvalue problem decouples, yielding positive-energy solutions $\\omega_k = 2E_k$ with eigenvectors $(X_k, Y_k) = (\\mathbf{e}_k, \\mathbf{0})$, where $\\mathbf{e}_k$ is the $k$-th unit vector. These solutions are already normalized, $X_k^\\mathsf{T}X_k - Y_k^\\mathsf{T}Y_k = 1$. The strength for each mode is $S_k = |f_k|^2$. Consequently, the sum rules are $m_0 = \\sum_k f_k^2 = m_0^{\\mathrm{(sr)}}$ and $m_1 = \\sum_k (2E_k) f_k^2 = m_1^{\\mathrm{(sr)}}$. Therefore, we analytically predict $\\Delta m_0=0$, $\\Delta m_1=0$, and $\\Delta C=0$. This serves as an excellent validation for the correctness of the numerical implementation.\n\n- **Case 3 ($N=10^6, \\kappa=1.5\\,\\mathrm{MeV}$):** The dimension $N=10^6$ makes the diagonalization of the $2 \\times 10^6 \\times 2 \\times 10^6$ matrix $\\mathcal{M}$ computationally infeasible with standard direct methods. The problem correctly requests only the sum-rule estimator for the centroid, $C^{\\mathrm{(sr)}}$. Given $2E_k = 20\\,\\mathrm{MeV}$ for all $k$ and $f_k = 1/\\sqrt{N}$, the calculation is straightforward:\n$$\nm_0^{\\mathrm{(sr)}} = \\sum_{k=0}^{N-1} \\left(\\frac{1}{\\sqrt{N}}\\right)^2 = \\sum_{k=0}^{N-1} \\frac{1}{N} = 1\n$$\n$$\nm_1^{\\mathrm{(sr)}} = \\sum_{k=0}^{N-1} (20\\,\\mathrm{MeV}) \\left(\\frac{1}{\\sqrt{N}}\\right)^2 = \\frac{20}{N} \\sum_{k=0}^{N-1} 1 = 20\\,\\mathrm{MeV}\n$$\n$$\nC^{\\mathrm{(sr)}} = \\frac{20\\,\\mathrm{MeV}}{1} = 20\\,\\mathrm{MeV}\n$$\n\nThe implementation will follow this logic, using `numpy` for array operations and `scipy.linalg.eig` for the eigenvalue decomposition.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import linalg\n\ndef compute_qrpa_deltas(N, E2k_values, f_k_vector, kappa):\n    \"\"\"\n    Constructs and solves the QRPA problem for a separable interaction,\n    and computes the difference between full results and sum-rule estimators.\n\n    Args:\n        N (int): Number of two-quasiparticle configurations.\n        E2k_values (np.ndarray): Array of two-quasiparticle energies (2E_k).\n        f_k_vector (np.ndarray): Normalized coupling vector (f_k).\n        kappa (float): Residual interaction strength.\n\n    Returns:\n        tuple: A tuple containing (delta_m0, delta_m1, delta_c).\n    \"\"\"\n    # 1. Calculate sum-rule estimators\n    # The f_k vector is pre-normalized, so sum(f_k**2) is 1.\n    m0_sr = 1.0\n    m1_sr = np.sum(E2k_values * f_k_vector**2)\n    # Avoid division by zero, though not expected here\n    C_sr = m1_sr / m0_sr if not np.isclose(m0_sr, 0.0) else 0.0\n\n    # 2. Construct and solve the full QRPA problem\n    A = np.diag(E2k_values) + kappa * np.outer(f_k_vector, f_k_vector)\n    B = kappa * np.outer(f_k_vector, f_k_vector)\n    M = np.block([[A, B], [-B, -A]])\n\n    omega_all, eigvecs_all = linalg.eig(M)\n\n    m0_diag = 0.0\n    m1_diag = 0.0\n    \n    tol = 1e-9  # Tolerance for floating point comparisons\n\n    for i in range(2 * N):\n        omega = omega_all[i]\n        \n        # Filter for physical solutions: real, positive energy\n        if omega.real = tol or np.abs(omega.imag) > tol:\n            continue\n\n        v = eigvecs_all[:, i]\n        X = v[:N]\n        Y = v[N:]\n\n        # Calculate the QRPA norm of the eigenvector\n        # Using np.vdot handles complex conjugation: vdot(a,b) = a*.T @ b\n        norm_val = (np.vdot(X, X) - np.vdot(Y, Y)).real\n        \n        # Filter for positive-norm modes\n        if norm_val = tol:\n            continue\n            \n        # Renormalize the eigenvector to have QRPA norm of +1\n        renorm_factor = np.sqrt(norm_val)\n        X_norm = X / renorm_factor\n        Y_norm = Y / renorm_factor\n        \n        # Calculate transition strength S_i\n        strength_sum_term = np.sum(f_k_vector * (X_norm + Y_norm))\n        S_i = np.abs(strength_sum_term)**2\n        \n        # Accumulate sum rules from diagonalized results\n        m0_diag += S_i\n        m1_diag += omega.real * S_i\n\n    # Calculate centroid from diagonalized results\n    if np.isclose(m0_diag, 0.0):\n       C_diag = 0.0 if np.isclose(m1_diag, 0.0) else np.inf\n    else:\n       C_diag = m1_diag / m0_diag\n       \n    # 3. Compute absolute differences\n    delta_m0 = np.abs(m0_diag - m0_sr)\n    delta_m1 = np.abs(m1_diag - m1_sr)\n    delta_c = np.abs(C_diag - C_sr)\n    \n    return delta_m0, delta_m1, delta_c\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for all test cases.\n    \"\"\"\n    results = []\n\n    # Case 1: General case\n    N1 = 20\n    kappa1 = 0.8\n    k1 = np.arange(N1)\n    E2k1 = 30.0 + 5.0 * np.cos(2.0 * np.pi * k1 / N1)\n    fk1_unscaled = np.sin(np.pi * (k1 + 1.0) / (N1 + 1.0))\n    fk1_norm = np.linalg.norm(fk1_unscaled)\n    fk1 = fk1_unscaled / fk1_norm\n    \n    deltas1 = compute_qrpa_deltas(N1, E2k1, fk1, kappa1)\n    results.extend(deltas1)\n    \n    # Case 2: Boundary condition, vanishing residual interaction\n    N2 = 10\n    kappa2 = 0.0\n    k2 = np.arange(N2)\n    E2k2 = 25.0 + 3.0 * np.cos(2.0 * np.pi * k2 / N2)\n    fk2_unscaled = np.sin(2.0 * np.pi * (k2 + 1.0) / (N2 + 1.0))\n    fk2_norm = np.linalg.norm(fk2_unscaled)\n    fk2 = fk2_unscaled / fk2_norm\n\n    deltas2 = compute_qrpa_deltas(N2, E2k2, fk2, kappa2)\n    results.extend(deltas2)\n\n    # Case 3: Large-dimensional limit, sum-rule estimator only\n    # As derived in the solution text, C_sr = 20.0 MeV.\n    # m0_sr = sum((1/sqrt(N))^2) = N * (1/N) = 1\n    # m1_sr = sum(20 * (1/sqrt(N))^2) = 20 * N * (1/N) = 20\n    # C_sr = m1_sr / m0_sr = 20.0 / 1.0 = 20.0\n    C_sr3 = 20.0\n    results.append(C_sr3)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}