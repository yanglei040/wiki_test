{
    "hands_on_practices": [
        {
            "introduction": "理解集体激发始于掌握和规则的概念。第一个实践练习将超越简单的定义，深入探讨基本原理与可观测量之间的深刻联系。通过这个推导，你将看到伽利略不变性如何决定了同位旋标量能量加权和规则的形式，使其独立于有效质量，而同位旋矢量和规则则会因速度依赖的核力而增强，这一现象可以直接通过有效质量来量化。",
            "id": "3549862",
            "problem": "考虑一个在局域规范不变的 Skyrme 能量密度泛函 (EDF) 框架内描述的原子核，该描述限于时间偶分区和空间梯度的二阶项。设单粒子动力学由同位旋标量有效质量场 $m^{*}(\\mathbf{r})$ 表征，使得平均场动能算符为 $-\\nabla \\cdot \\left(\\frac{\\hbar^{2}}{2 m^{*}(\\mathbf{r})} \\nabla \\right)$。对于一个单体算符 $\\hat{F}$，其能量加权求和规则 $m_{1}$ 由双对易子定义为\n$$\nm_{1}(\\hat{F}) \\equiv \\frac{1}{2} \\langle 0 | [\\hat{F}, [\\hat{H}, \\hat{F}]] | 0 \\rangle,\n$$\n其中 $\\hat{H}$ 是从 Skyrme EDF 得到的自洽 Hartree-Fock 哈密顿量，而 $|0\\rangle$ 是 Hartree-Fock 基态。假设 Skyrme EDF 严格遵守局域规范 (伽利略) 不变性，从而使得总密度以及质子和中子密度分别满足连续性方程。\n\n从这些基础出发，并且不引入任何唯象的求和规则快捷方法，请执行以下操作：\n\n1. 对于形式为 $\\hat{F}_{\\mathrm{IS}} = \\sum_{i} f(\\mathbf{r}_{i})$ 的通用局域同位旋标量单体算符，利用连续性方程和对易子结构，判断能量加权和 $m_{1}(\\hat{F}_{\\mathrm{IS}})$ 是依赖于同位旋标量有效质量 $m^{*}(\\mathbf{r})$ 还是仅依赖于裸核子质量 $m$。您的分析应对于任意光滑函数 $f(\\mathbf{r})$ 和现实的、有限核的基态密度 $\\rho(\\mathbf{r})$ 均有效。\n\n2. 对于经过质心运动修正的同位旋矢量电偶极算符 $\\hat{F}_{\\mathrm{IV}} = \\sum_{p} z_{p} - \\frac{Z}{A} \\sum_{i} z_{i}$ (等价于与质子-中子中心分离成正比)，通过计算双对易子并识别来自 Skyrme EDF 中依赖于速度部分的贡献，来推导 $m_{1}(\\hat{F}_{\\mathrm{IV}})$ 的结构。证明能量加权和可以写成 Thomas-Reiche-Kuhn (TRK) 值乘以一个增强因子 $1+\\kappa$，其中 $\\kappa$ 源于泛函的同位旋矢量流/动能耦合。\n\n3. 通过分析质子-中子连续性方程以及相应的同位旋矢量流的惯量，将增强因子 $\\kappa$ 与同位旋矢量道中的有效质量 $m_{v}^{*}$ 联系起来。然后，在适用于对称核物质以及 $m_{v}^{*} \\approx m^{*}$ 的 Skyrme 参数化方案的简化假设下，将增强因子 $\\kappa$ 表示为仅含同位旋标量有效质量比 $m^{*}/m$ 的闭合形式。\n\n你的最终答案必须是 $\\kappa$ 关于 $m^{*}/m$ 的单一闭合形式解析表达式。无需进行数值计算。",
            "solution": "该问题要求在 Skyrme 能量密度泛函 (EDF) 框架内分析能量加权求和规则 (EWSRs)，重点关注有效质量的作用。我们必须首先验证问题陈述，经确认，该问题陈述在科学上是合理的、良定的，并且是核结构物理学中的一个标准理论练习。我们接下来按顺序解决这三个部分。\n\n对于一个单体算符 $\\hat{F}$，其能量加权求和规则 $m_1$ 由其与哈密顿量 $\\hat{H}$ 的双对易子定义为：\n$$\nm_{1}(\\hat{F}) \\equiv \\frac{1}{2} \\langle 0 | [\\hat{F}, [\\hat{H}, \\hat{F}]] | 0 \\rangle\n$$\n其中 $|0\\rangle$ 是 Hartree-Fock 基态。\n\n**第一部分：同位旋标量求和规则**\n\n对于形式为 $\\hat{F}_{\\mathrm{IS}} = \\sum_{i} f(\\mathbf{r}_{i})$ 的通用局域同位旋标量单体算符，我们来计算其求和规则。我们可以将 $\\hat{F}_{\\mathrm{IS}}$ 写成对粒子数密度算符 $\\hat{\\rho}(\\mathbf{r}) = \\sum_i \\delta(\\mathbf{r}-\\mathbf{r}_i)$ 的积分：\n$$\n\\hat{F}_{\\mathrm{IS}} = \\int f(\\mathbf{r}) \\hat{\\rho}(\\mathbf{r}) d^3r\n$$\n使用连续性方程可以大大简化求和规则的计算，根据问题陈述，由于 EDF 的局域规范 (伽利略) 不变性，连续性方程是满足的。密度算符的连续性方程以算符形式由 Heisenberg 运动方程给出：\n$$\n[\\hat{H}, \\hat{\\rho}(\\mathbf{r})] = -i\\hbar \\nabla \\cdot \\hat{\\mathbf{j}}(\\mathbf{r})\n$$\n其中 $\\hat{\\mathbf{j}}(\\mathbf{r})$ 是总粒子流算符。伽利略不变性的一个基本推论是，粒子流算符通过裸核子质量 $m$ 与动量密度算符相关，而与平均场描述中导致有效质量的势能项无关。同位旋标量流算符为：\n$$\n\\hat{\\mathbf{j}}(\\mathbf{r}) = \\frac{1}{m} \\sum_{i} \\frac{1}{2} \\{ \\hat{\\mathbf{p}}_i, \\delta(\\mathbf{r}-\\mathbf{r}_i) \\}\n$$\n利用此关系，我们计算内对易子：\n$$\n[\\hat{H}, \\hat{F}_{\\mathrm{IS}}] = \\int f(\\mathbf{r}) [\\hat{H}, \\hat{\\rho}(\\mathbf{r})] d^3r = -i\\hbar \\int f(\\mathbf{r}) (\\nabla \\cdot \\hat{\\mathbf{j}}(\\mathbf{r})) d^3r\n$$\n使用分部积分法并假设无穷远处的边界项为零，我们得到：\n$$\n[\\hat{H}, \\hat{F}_{\\mathrm{IS}}] = i\\hbar \\int (\\nabla f(\\mathbf{r})) \\cdot \\hat{\\mathbf{j}}(\\mathbf{r}) d^3r\n$$\n现在，我们计算外对易子。算符 $\\hat{F}_{\\mathrm{IS}}$ 仅是坐标的函数，而 $\\hat{\\mathbf{j}}(\\mathbf{r})$ 是动量的一次线性函数。它们的对易子是一个 c-数乘以密度算符。\n$$\n[\\hat{F}_{\\mathrm{IS}}, \\hat{\\mathbf{j}}(\\mathbf{r}')] = \\left[ \\sum_i f(\\mathbf{r}_i), \\frac{1}{2m} \\sum_j \\{ \\hat{\\mathbf{p}}_j, \\delta(\\mathbf{r}'-\\mathbf{r}_j) \\} \\right] = \\frac{1}{m} \\sum_i [f(\\mathbf{r}_i), \\hat{\\mathbf{p}}_i] \\delta(\\mathbf{r}'-\\mathbf{r}_i)\n$$\n使用正则对易关系 $[f(\\mathbf{r}_i), \\hat{\\mathbf{p}}_i] = i\\hbar \\nabla_i f(\\mathbf{r}_i)$，我们得到：\n$$\n[\\hat{F}_{\\mathrm{IS}}, \\hat{\\mathbf{j}}(\\mathbf{r}')] = \\frac{i\\hbar}{m} \\sum_i (\\nabla_i f(\\mathbf{r}_i)) \\delta(\\mathbf{r}'-\\mathbf{r}_i) = \\frac{i\\hbar}{m} (\\nabla' f(\\mathbf{r}')) \\hat{\\rho}(\\mathbf{r}')\n$$\n将此结果代回双对易子：\n$$\n[\\hat{F}_{\\mathrm{IS}}, [\\hat{H}, \\hat{F}_{\\mathrm{IS}}]] = i\\hbar \\int (\\nabla f(\\mathbf{r})) \\cdot [\\hat{F}_{\\mathrm{IS}}, \\hat{\\mathbf{j}}(\\mathbf{r})] d^3r = i\\hbar \\int (\\nabla f(\\mathbf{r})) \\cdot \\left( \\frac{i\\hbar}{m} (\\nabla f(\\mathbf{r})) \\hat{\\rho}(\\mathbf{r}) \\right) d^3r = -\\frac{\\hbar^2}{m} \\int |\\nabla f(\\mathbf{r})|^2 \\hat{\\rho}(\\mathbf{r}) d^3r\n$$\n最后，我们取其在基态 $|0\\rangle$ 下的期望值，其中 $\\langle 0 | \\hat{\\rho}(\\mathbf{r}) | 0 \\rangle = \\rho_0(\\mathbf{r})$ 是基态密度。\n$$\nm_1(\\hat{F}_{\\mathrm{IS}}) = \\frac{1}{2} \\left\\langle 0 \\left| -\\frac{\\hbar^2}{m} \\int |\\nabla f(\\mathbf{r})|^2 \\hat{\\rho}(\\mathbf{r}) d^3r \\right| 0 \\right\\rangle = \\frac{\\hbar^2}{2m} \\int |\\nabla f(\\mathbf{r})|^2 \\rho_0(\\mathbf{r}) d^3r\n$$\n局域同位旋标量算符 $\\hat{F}_{\\mathrm{IS}}$ 的求和规则仅依赖于裸核子质量 $m$，而不依赖于同位旋标量有效质量 $m^*(\\mathbf{r})$。这是伽利略不变性的直接结果，伽利略不变性决定了守恒粒子流的形式。\n\n**第二部分：同位旋矢量偶极求和规则**\n\n我们考虑经过质心运动修正的同位旋矢量电偶极算符 $\\hat{F}_{\\mathrm{IV}} = \\sum_{p} z_{p} - \\frac{Z}{A} \\sum_{i} z_{i}$。这可以改写为 $\\hat{F}_{\\mathrm{IV}} = \\frac{N}{A} \\sum_p z_p - \\frac{Z}{A} \\sum_n z_n$。该求和规则由两部分组成：一部分来自能量算符 $\\hat{T} = \\sum_i \\hat{\\mathbf{p}}_i^2/(2m)$，另一部分来自势能算符 $\\hat{V}$。\n$$\nm_{1}(\\hat{F}_{\\mathrm{IV}}) = \\frac{1}{2} \\langle 0 | [\\hat{F}_{\\mathrm{IV}}, [\\hat{T}, \\hat{F}_{\\mathrm{IV}}]] | 0 \\rangle + \\frac{1}{2} \\langle 0 | [\\hat{F}_{\\mathrm{IV}}, [\\hat{V}, \\hat{F}_{\\mathrm{IV}}]] | 0 \\rangle\n$$\n第一项是不依赖模型的 Thomas-Reiche-Kuhn (TRK) 求和规则值。令 $q_i$ 为“偶极荷” (对质子为 $N/A$，对中子为 $-Z/A$)，则 $\\hat{F}_{\\mathrm{IV}} = \\sum_i q_i z_i$。双对易子的动能部分是：\n$$\n[\\hat{F}_{\\mathrm{IV}}, [\\hat{T}, \\hat{F}_{\\mathrm{IV}}]] = \\left[\\sum_j q_j z_j, \\left[\\sum_k \\frac{p_{z,k}^2}{2m}, \\sum_l q_l z_l\\right]\\right] = \\left[\\sum_j q_j z_j, \\sum_k q_k \\frac{-i\\hbar p_{z,k}}{m}\\right] = \\sum_k q_k^2 \\frac{-i\\hbar}{m} [z_k, p_{z,k}] = \\frac{\\hbar^2}{m} \\sum_k q_k^2\n$$\n荷的平方和为 $\\sum_k q_k^2 = Z(N/A)^2 + N(-Z/A)^2 = \\frac{ZN^2+NZ^2}{A^2} = \\frac{ZN(N+Z)}{A^2} = \\frac{NZ}{A}$。\n因此，TRK 部分为：\n$$\nm_{1, \\mathrm{TRK}} = \\frac{1}{2} \\frac{\\hbar^2}{m} \\frac{NZ}{A}\n$$\n第二项涉及势能 $\\hat{V}$，它的出现是因为核相互作用包含依赖动量的交换项 (即依赖速度的力)。这些项与同位旋矢量算符 $\\hat{F}_{\\mathrm{IV}}$ 不对易。这一贡献被称为增强因子 $\\kappa$。\n$$\n\\frac{1}{2} \\langle 0 | [\\hat{F}_{\\mathrm{IV}}, [\\hat{V}, \\hat{F}_{\\mathrm{IV}}]] | 0 \\rangle = \\kappa \\cdot m_{1, \\mathrm{TRK}}\n$$\n因此，总能量加权和为 $m_1(\\hat{F}_{\\mathrm{IV}}) = m_{1, \\mathrm{TRK}} (1+\\kappa)$。因子 $\\kappa$ 概括了核相互作用中依赖速度和对同位旋矢量敏感部分的影响，这些部分也导致了平均场中有效质量的出现。\n\n**第三部分：增强因子与有效质量**\n\n问题要求通过考虑同位旋矢量流的惯量，将 $\\kappa$ 与同位旋矢量有效质量 $m_v^*$ 联系起来。EWSR 通常可以理解为与被激发的集体模式的惯量成反比。\n$$\nm_1(\\hat{F}) = \\frac{\\hbar^2}{2 M_{\\mathrm{eff}}}\n$$\n其中 $M_{\\mathrm{eff}}$ 是与算符 $\\hat{F}$ 相关联的有效惯量。\n对于同位旋矢量偶极模式，相关的运动是质子相对于中子的振荡。算符 $\\hat{F}_{\\mathrm{IV}}$ 产生这种运动。TRK 求和规则对应于惯量由裸质量 $m$ 给出的情况。此模式的惯量为 $M_{\\mathrm{IV, bare}} \\propto m$。\n依赖速度的核力的存在修正了这个惯量。有效惯量 $M_{\\mathrm{IV, eff}}$ 由包括这些力在内的全套动力学决定。对于一个给定模式，有效质量的定义正是描述其惯性性质的质量。对于同位旋矢量模式，这个质量就是同位旋矢量有效质量 $m_v^*$。因此，有效惯量与该质量成正比：$M_{\\mathrm{IV, eff}} \\propto m_v^*$。\n\n求和规则的增强是裸惯量与有效惯量之比：\n$$\n1+\\kappa = \\frac{m_1(\\hat{F}_{\\mathrm{IV}})}{m_{1, \\mathrm{TRK}}} = \\frac{\\hbar^2/(2M_{\\mathrm{IV, eff}})}{\\hbar^2/(2M_{\\mathrm{IV, bare}})} = \\frac{M_{\\mathrm{IV, bare}}}{M_{\\mathrm{IV, eff}}}\n$$\n由于惯量与各自的质量 ($m$ 和 $m_v^*$) 成正比，我们有：\n$$\n1+\\kappa = \\frac{m}{m_v^*}\n$$\n这就给出了问题所要求的增强因子 $\\kappa$ 和同位旋矢量有效质量 $m_v^*$ 之间的直接联系。\n\n最后，我们应用简化假设 $m_v^* \\approx m^*$，这对于对称核物质是合适的，并且是许多 Skyrme 参数化方案的一个共同特征。通过用同位旋标量有效质量 $m^*$ 替代 $m_v^*$，我们得到 $\\kappa$ 的表达式：\n$$\n1+\\kappa = \\frac{m}{m^*}\n$$\n由此，我们解出 $\\kappa$：\n$$\n\\kappa = \\frac{m}{m^*} - 1\n$$\n这个最终表达式在指定的假设下，将同位旋矢量偶极求和规则的增强与同位旋标量有效质量联系起来。",
            "answer": "$$\n\\boxed{\\frac{m}{m^{\\ast}} - 1}\n$$"
        },
        {
            "introduction": "理论推导（如前一个练习所示）需要通过计算来赋予生命力。本练习使用一个示意性的随机相近似（RPA）模型，来展示核能量密度泛函的不同组分如何影响集体共振的能量。通过在计算中“关闭”与核流和伽利略不变性密切相关的时间奇数相互作用通道，你将直接量化它们在确定巨共振最终位置中的关键作用。",
            "id": "3549905",
            "problem": "您的任务是，在一个概略但有物理基础的随机相位近似 (RPA) 中，实现一个自洽线性响应计算，以量化在原子核能量密度泛函 (EDF) 中关闭选定的时间奇通道对同位旋矢量巨偶极共振 (IVGDR) 和同位旋标量巨四极共振 (ISGQR) 的质心能量的影响。该程序必须是一个完整、可运行的 Python 脚本，使用第一性原理线性响应和单粒子-空穴集体模近似。您的实现必须根据 RPA 本征频率计算包含和不包含指定的时间奇流贡献时的质心能量，并返回因关闭指定的时间奇通道而引起的质心能量移动。最终数值答案必须以兆电子伏特 (MeV) 为单位表示，并四舍五入到三位小数。\n\n从以下基本依据和定义开始：\n- 含时 Hartree-Fock (TDHF) 线性化和运动方程方法得出了小振幅集体激发的 RPA 描述。在单集体模近似中，RPA 本征频率 $\\,\\omega\\,$ 是该模式以能量单位（电子伏特）表示的质心能量，它满足一个由广义刚度（时间偶平均场和剩余相互作用）和动力学自洽流耦合（时间奇剩余相互作用）决定的二次方程。\n- 正则对易关系和连续性方程施加了约束，将与速度相关的时间偶项和时间奇流项联系起来；这些约束体现了规范不变性。当非自洽地关闭时间奇贡献时，质心能量会偏离自洽值。\n\n使用的模型和物理量：\n- 考虑一个由质量数 $\\,A\\,$、质子数 $\\,Z\\,$ 和中子数 $\\,N\\,$ 表征的原子核。使用等效球形核半径 $\\,R = r_0 A^{1/3}\\,$，其中 $\\,r_0 = 1.2\\,\\mathrm{fm}\\,$。平均场为同位旋矢量偶极和同位旋标量四极通道分别产生未微扰的粒子-空穴能量 $\\,\\varepsilon_{\\mathrm{IV}}\\,$ 和 $\\,\\varepsilon_{\\mathrm{IS}}\\,$（以 MeV 为单位）。\n- 在概略 RPA 中使用 EDF 剩余相互作用的两个通道：\n  1. 时间偶通道，耦合常数为 $\\,g^{\\mathrm{TE}}_{\\mathrm{IV}}\\,$ 和 $\\,g^{\\mathrm{TE}}_{\\mathrm{IS}}\\,$（单位为 $\\mathrm{MeV}\\cdot\\mathrm{fm}$）。\n  2. 时间奇通道，耦合常数为 $\\,g^{\\mathrm{TO}}_{\\mathrm{IV}}\\,$ 和 $\\,g^{\\mathrm{TO}}_{\\mathrm{IS}}\\,$（单位为 $\\mathrm{MeV}\\cdot\\mathrm{fm}$）。\n- 对于每个模式 $\\,X\\in\\{\\mathrm{IV},\\mathrm{IS}\\}\\,$，定义一个无量纲的归一化集体形状因子 $\\,s_X(A,Z,N)\\,$，它与相应的跃迁矩阵元和核尺寸成比例。为保证科学真实性和在不同原子核间的数值稳定性，请使用以下归一化标度关系：\n  - 同位旋矢量偶极：$\\,s_{\\mathrm{IV}}(A,Z,N) = \\dfrac{\\sqrt{N Z / A}}{R}\\,$。\n  - 同位旋标量四极：$\\,s_{\\mathrm{IS}}(A) = \\dfrac{\\sqrt{A}}{R}\\,$。\n- 在单模 RPA 中，广义刚度因时间偶剩余相互作用的贡献而增加，而动力学耦合由时间奇流的贡献提供。关闭选定的时间奇通道意味着将相应的时间奇耦合设置为零，同时保持时间偶通道不变。\n\n您的程序必须实现的计算步骤：\n1. 对每个测试用例，使用上述公式计算半径 $\\,R\\,$ 和形状因子 $\\,s_{\\mathrm{IV}}\\,$ 与 $\\,s_{\\mathrm{IS}}\\,$。\n2. 对每个模式 $\\,X\\,$，构建概略 RPA 矩阵，其特征为对角元 $\\,A_X = \\varepsilon_X + g^{\\mathrm{TE}}_X\\, s_X\\,$ 和非对角元 $\\,B_X = g^{\\mathrm{TO}}_X\\, s_X\\,$，两者单位均为 MeV。\n3. 计算自洽质心能量（完整 EDF）$\\,E^{\\mathrm{full}}_X = \\sqrt{A_X^2 - B_X^2}\\,$，单位为 MeV。\n4. 计算关闭选定时间奇通道后的质心能量 $\\,E^{\\mathrm{off}}_X = \\sqrt{A_X^2 - \\tilde{B}_X^2}\\,$，其中如果模式 $\\,X\\,$ 的该通道被关闭，则 $\\,\\tilde{B}_X = 0\\,$；否则 $\\,\\tilde{B}_X = B_X\\,$。\n5. 将影响量化为能量移动 $\\,\\Delta E_X = E^{\\mathrm{off}}_X - E^{\\mathrm{full}}_X\\,$，单位为 MeV，四舍五入到三位小数。\n\n角度单位不适用。最终输出必须是单行，包含一个方括号括起来的逗号分隔列表，其中包含按以下顺序排列的每个测试用例的能量移动。所有能量都必须以 MeV 表示。\n\n测试套件：\n- 使用以下四个参数集。对于每个用例，最后两个布尔条目分别指示同位旋矢量 (IV) 和同位旋标量 (IS) 模式中的时间奇通道是否关闭。条目为 $(A,Z,N,\\varepsilon_{\\mathrm{IV}},\\varepsilon_{\\mathrm{IS}},g^{\\mathrm{TE}}_{\\mathrm{IV}},g^{\\mathrm{TO}}_{\\mathrm{IV}},g^{\\mathrm{TE}}_{\\mathrm{IS}},g^{\\mathrm{TO}}_{\\mathrm{IS}},\\mathrm{off\\_IV},\\mathrm{off\\_IS})$。\n\n1. $(208,82,126,11.0,12.0,3.0,2.2,1.5,1.2,\\mathrm{True},\\mathrm{True})$\n2. $(120,50,70,10.8,11.6,2.8,2.0,1.3,1.1,\\mathrm{True},\\mathrm{False})$\n3. $(40,20,20,12.0,11.0,2.0,1.8,1.0,0.8,\\mathrm{True},\\mathrm{True})$\n4. $(208,82,126,11.0,12.0,3.0,3.8,1.5,2.5,\\mathrm{False},\\mathrm{True})$\n\n要求的最终输出格式：\n- 您的程序应生成单行输出，包含一个方括号括起来的逗号分隔列表。该列表必须完全按此顺序包含八个条目：$[\\Delta E_{\\mathrm{IV},1},\\Delta E_{\\mathrm{IS},1},\\Delta E_{\\mathrm{IV},2},\\Delta E_{\\mathrm{IS},2},\\Delta E_{\\mathrm{IV},3},\\Delta E_{\\mathrm{IS},3},\\Delta E_{\\mathrm{IV},4},\\Delta E_{\\mathrm{IS},4}]$，其中每个 $\\,\\Delta E\\,$ 的单位为 MeV，并四舍五入到三位小数。",
            "solution": "该问题是有效的，因为它在核物理的随机相位近似 (RPA) 中具有科学依据，其参数集完整、公式清晰无歧义，因此是良定的，并且在计算上是可行的。其目标是量化当原子核能量密度泛函的时间奇分量被人为移除时巨共振的能量移动，这是理论核结构物理中评估特定相互作用项重要性的标准程序。\n\n解决方案首先基于所提供的概略 RPA 模型建立理论框架，然后为每个测试用例实现计算步骤。\n\n集体激发模式 $X$ 的质心能量由 RPA 本征频率 $\\omega_X$ 给出，其中 $X$ 是同位旋矢量巨偶极共振 ($\\mathrm{IV}$) 或同位旋标量巨四极共振 ($\\mathrm{IS}$)。在单集体模近似中，该能量计算如下：\n$$\nE_X = \\omega_X = \\sqrt{A_X^2 - B_X^2}\n$$\n其中所有能量都以兆电子伏特 ($\\mathrm{MeV}$) 为单位表示。项 $A_X$ 和 $B_X$ 代表了粒子-空穴通道中剩余相互作用的影响。\n\n对角元 $A_X$ 由未微扰的粒子-空穴能量 $\\varepsilon_X$ 和剩余相互作用的时间偶 (TE) 部分决定：\n$$\nA_X = \\varepsilon_X + g^{\\mathrm{TE}}_X s_X\n$$\n此处，$g^{\\mathrm{TE}}_X$ 是时间偶耦合常数（单位为 $\\mathrm{MeV}\\cdot\\mathrm{fm}$），$s_X$ 是无量纲的归一化集体形状因子。在物理上，$A_X$ 贡献了系统抵抗集体形变的整体刚度。\n\n非对角元 $B_X$ 源于剩余相互作用的时间奇 (TO) 部分，它与核流相关，并在 RPA 方程中提供动力学耦合：\n$$\nB_X = g^{\\mathrm{TO}}_X s_X\n$$\n此处，$g^{\\mathrm{TO}}_X$ 是时间奇耦合常数（单位为 $\\mathrm{MeV}\\cdot\\mathrm{fm}$）。导致实值能量 $E_X$ 的稳定基态的条件是 $A_X^2 \\ge B_X^2$。\n\n形状因子 $s_X$ 基于原子核的性质计算：质量数 $A$、质子数 $Z$ 和中子数 $N$。首先使用液滴模型公式计算核半径 $R$：\n$$\nR = r_0 A^{1/3}, \\quad \\text{with } r_0 = 1.2\\,\\mathrm{fm}\n$$\n两种模式的形状因子则为：\n$$\ns_{\\mathrm{IV}}(A,Z,N) = \\frac{\\sqrt{N Z / A}}{R} \\quad (\\text{in fm}^{-1})\n$$\n$$\ns_{\\mathrm{IS}}(A) = \\frac{\\sqrt{A}}{R} \\quad (\\text{in fm}^{-1})\n$$\n\n问题要求计算当给定模式 $X$ 的时间奇通道被关闭时，质心能量的移动 $\\Delta E_X$。这是一个用于探究这些项的物理影响的计算实验。\n\n当所有相互作用通道都激活时，自洽质心能量表示为 $E^{\\mathrm{full}}_X$：\n$$\nE^{\\mathrm{full}}_X = \\sqrt{A_X^2 - B_X^2}\n$$\n当模式 $X$ 的时间奇通道被关闭时，相应的耦合常数 $g^{\\mathrm{TO}}_X$ 被设置为零。这导致修改后的非对角元 $\\tilde{B}_X = 0$。新的质心能量 $E^{\\mathrm{off}}_X$ 为：\n$$\nE^{\\mathrm{off}}_X = \\sqrt{A_X^2 - \\tilde{B}_X^2}\n$$\n如果通道被关闭，则 $\\tilde{B}_X = 0$，能量简化为 $E^{\\mathrm{off}}_X = |A_X|$。由于参数的选择使得 $A_X > 0$，这变为 $E^{\\mathrm{off}}_X = A_X$。如果通道未被关闭，则 $\\tilde{B}_X = B_X$，且 $E^{\\mathrm{off}}_X = E^{\\mathrm{full}}_X$。\n\n量化此修改影响的能量移动定义为：\n$$\n\\Delta E_X = E^{\\mathrm{off}}_X - E^{\\mathrm{full}}_X\n$$\n如果时间奇通道是激活的，则 $\\Delta E_X = 0$。如果它被关闭，能量移动将是 $\\Delta E_X = A_X - \\sqrt{A_X^2 - B_X^2}$。\n\n每个测试用例的计算流程如下：\n1.  给定参数 $(A,Z,N,\\varepsilon_{\\mathrm{IV}},\\varepsilon_{\\mathrm{IS}},g^{\\mathrm{TE}}_{\\mathrm{IV}},g^{\\mathrm{TO}}_{\\mathrm{IV}},g^{\\mathrm{TE}}_{\\mathrm{IS}},g^{\\mathrm{TO}}_{\\mathrm{IS}},\\mathrm{off\\_IV},\\mathrm{off\\_IS})$。\n2.  计算核半径 $R$。\n3.  计算形状因子 $s_{\\mathrm{IV}}$ 和 $s_{\\mathrm{IS}}$。\n4.  对于同位旋矢量模式 ($\\mathrm{IV}$):\n    a. 从 $\\mathrm{off\\_IV}$ 标志确定时间奇通道是否关闭。\n    b. 如果不是，则移动 $\\Delta E_{\\mathrm{IV}}$ 为 $0$。\n    c. 如果是，则计算 $A_{\\mathrm{IV}} = \\varepsilon_{\\mathrm{IV}} + g^{\\mathrm{TE}}_{\\mathrm{IV}} s_{\\mathrm{IV}}$ 和 $B_{\\mathrm{IV}} = g^{\\mathrm{TO}}_{\\mathrm{IV}} s_{\\mathrm{IV}}$。\n    d. 计算移动 $\\Delta E_{\\mathrm{IV}} = A_{\\mathrm{IV}} - \\sqrt{A_{\\mathrm{IV}}^2 - B_{\\mathrm{IV}}^2}$。\n5.  对于同位旋标量模式 ($\\mathrm{IS}$):\n    a. 从 $\\mathrm{off\\_IS}$ 标志确定时间奇通道是否关闭。\n    b. 如果不是，则移动 $\\Delta E_{\\mathrm{IS}}$ 为 $0$。\n    c. 如果是，则计算 $A_{\\mathrm{IS}} = \\varepsilon_{\\mathrm{IS}} + g^{\\mathrm{TE}}_{\\mathrm{IS}} s_{\\mathrm{IS}}$ 和 $B_{\\mathrm{IS}} = g^{\\mathrm{TO}}_{\\mathrm{IS}} s_{\\mathrm{IS}}$。\n    d. 计算移动 $\\Delta E_{\\mathrm{IS}} = A_{\\mathrm{IS}} - \\sqrt{A_{\\mathrm{IS}}^2 - B_{\\mathrm{IS}}^2}$。\n6.  将最终的移动 $\\Delta E_{\\mathrm{IV}}$ 和 $\\Delta E_{\\mathrm{IS}}$ 四舍五入到三位小数。\n7.  将所有测试用例的所有结果按指定顺序收集到单个列表中。\n\n提供的 Python 脚本中实现了这个结构化流程，以解决给定的测试套件。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the centroid energy shifts for giant resonances based on a schematic\n    Random Phase Approximation (RPA) model.\n    \"\"\"\n\n    # Constant for nuclear radius calculation\n    r0 = 1.2  # in fm\n\n    # Test suite:\n    # (A, Z, N, eps_IV, eps_IS, g_TE_IV, g_TO_IV, g_TE_IS, g_TO_IS, off_IV, off_IS)\n    test_cases = [\n        (208, 82, 126, 11.0, 12.0, 3.0, 2.2, 1.5, 1.2, True, True),\n        (120, 50, 70, 10.8, 11.6, 2.8, 2.0, 1.3, 1.1, True, False),\n        (40, 20, 20, 12.0, 11.0, 2.0, 1.8, 1.0, 0.8, True, True),\n        (208, 82, 126, 11.0, 12.0, 3.0, 3.8, 1.5, 2.5, False, True),\n    ]\n\n    results = []\n\n    for case in test_cases:\n        A, Z, N, eps_iv, eps_is, g_te_iv, g_to_iv, g_te_is, g_to_is, off_iv, off_is = case\n\n        # Step 1: Compute the radius R\n        R = r0 * np.cbrt(A)\n\n        # --- Isovector Mode (IV) Calculation ---\n\n        if not off_iv:\n            delta_e_iv = 0.0\n        else:\n            # Step 2: Compute form factor s_IV\n            s_iv = np.sqrt(N * Z / A) / R\n\n            # Step 3: Build RPA matrix elements A_IV and B_IV\n            A_iv = eps_iv + g_te_iv * s_iv\n            B_iv = g_to_iv * s_iv\n\n            # Step 4  5: Compute energies and shift\n            # E_full = sqrt(A_iv^2 - B_iv^2)\n            # E_off = A_iv (since tilde_B_iv = 0 and A_iv > 0)\n            # Delta_E = E_off - E_full\n            if A_iv**2  B_iv**2:\n                # This case indicates an instability and should not occur with the given parameters\n                # but is handled for robustness.\n                delta_e_iv = np.nan\n            else:\n                e_full_iv = np.sqrt(A_iv**2 - B_iv**2)\n                e_off_iv = A_iv\n                delta_e_iv = e_off_iv - e_full_iv\n\n        # --- Isoscalar Mode (IS) Calculation ---\n\n        if not off_is:\n            delta_e_is = 0.0\n        else:\n            # Step 2: Compute form factor s_IS\n            s_is = np.sqrt(A) / R\n\n            # Step 3: Build RPA matrix elements A_IS and B_IS\n            A_is = eps_is + g_te_is * s_is\n            B_is = g_to_is * s_is\n\n            # Step 4  5: Compute energies and shift\n            if A_is**2  B_is**2:\n                delta_e_is = np.nan \n            else:\n                e_full_is = np.sqrt(A_is**2 - B_is**2)\n                e_off_is = A_is\n                delta_e_is = e_off_is - e_full_is\n        \n        # Round and append results as formatted strings\n        results.append(f\"{delta_e_iv:.3f}\")\n        results.append(f\"{delta_e_is:.3f}\")\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "当我们将计算扩展到现实的原子核时，RPA问题的维度会成为一个主要的计算障碍。最后一个实践练习介绍了一种处理此类大规模计算的关键策略：使用可分离相互作用。你将实现一个准粒子RPA（QRPA）模型，并将完全对角化的结果与强大的和规则估计量进行基准比较，后者可以在完全不解本征值问题的情况下近似计算集体性质。这个练习展示了在现代计算科学中至关重要的、在计算成本和准确性之间的权衡。",
            "id": "3549830",
            "problem": "考虑一个用于集体激发的示意性准粒子随机相近似（QRPA）模型，该模型具有一个可分离的多极剩余相互作用，能够进行极大维度的计算。计算任务是为可分离相互作用构建QRPA矩阵，并通过与完全自洽计算进行比较，来检验质心和求和规则的保真度。这包括小维度下的显式对角化，以及显式对角化不可行的极大维度极限情况。\n\n从以下经过充分检验的基础出发：\n- 线性响应理论和电荷守恒模式的QRPA本征值问题。\n- 非能量加权求和规则（NEWSR）、能量加权求和规则（EWSR）以及强度分布质心的定义。\n\n模型与定义：\n- 存在 $N$ 个双准粒子组态，由 $k \\in \\{0, 1, \\dots, N-1\\}$ 标记，其双准粒子能量为 $2E_k$（单位为 $\\mathrm{MeV}$）。\n- 一个多极跃迁算符由一个实耦合矢量表示，其分量为 $f_k$（无量纲）。\n- 剩余相互作用是可分离的，在QRPA水平上由以下矩阵表示\n$$\nA_{kk'} = 2E_k\\,\\delta_{kk'} + \\kappa\\, f_k f_{k'}, \\quad\nB_{kk'} = \\kappa\\, f_k f_{k'},\n$$\n其中 $\\kappa$ 是一个实耦合常数（单位为 $\\mathrm{MeV}$），$\\delta_{kk'}$ 是克罗内克δ函数。\n- QRPA矩阵是 $2N \\times 2N$ 的分块矩阵\n$$\n\\mathcal{M} = \\begin{pmatrix}\nA  B\\\\\n- B  - A\n\\end{pmatrix}.\n$$\n- 正模QRPA本征模式通过求解本征值问题 $\\mathcal{M} \\begin{pmatrix} X_i \\\\ Y_i \\end{pmatrix} = \\omega_i \\begin{pmatrix} X_i \\\\ Y_i \\end{pmatrix}$ 获得，其中 $(X_i, Y_i)$ 是实矢量，$\\omega_i  0$ 是激发能（单位为 $\\mathrm{MeV}$）。需强制执行QRPA归一化条件 $X_i^\\mathsf{T} X_i - Y_i^\\mathsf{T} Y_i = 1$。\n- 模式 $i$ 对于多极算符的跃迁强度定义为\n$$\nS_i = \\left| \\sum_{k=0}^{N-1} f_k \\left( X_{ki} + Y_{ki} \\right) \\right|^2,\n$$\n此为无量纲量。\n- 非能量加权求和规则为 $m_0 = \\sum_i S_i$（无量纲）。\n- 能量加权求和规则为 $m_1 = \\sum_i \\omega_i S_i$（单位为 $\\mathrm{MeV}$）。\n- 质心定义为 $C = m_1/m_0$（单位为 $\\mathrm{MeV}$）。\n- 在不进行显式对角化的情况下，将求和规则估计量定义为\n$$\nm_0^{\\mathrm{(sr)}} = \\sum_{k=0}^{N-1} f_k^2,\\quad\nm_1^{\\mathrm{(sr)}} = \\sum_{k=0}^{N-1} (2E_k)\\, f_k^2,\\quad\nC^{\\mathrm{(sr)}} = \\frac{m_1^{\\mathrm{(sr)}}}{m_0^{\\mathrm{(sr)}}}.\n$$\n\n任务：\n1. 对于有限的 $N$，显式构建 $A$、$B$ 和 $\\mathcal{M}$，求解QRPA本征问题，将 $(X_i, Y_i)$ 归一化以满足 $X_i^\\mathsf{T} X_i - Y_i^\\mathsf{T} Y_i = 1$，并通过对所有具有实正激发能的正模模式求和来计算 $m_0$、$m_1$ 和 $C$。\n2. 直接从 $\\{2E_k\\}$ 和 $\\{f_k\\}$ 计算求和规则估计量 $m_0^{\\mathrm{(sr)}}$、$m_1^{\\mathrm{(sr)}}$ 和 $C^{\\mathrm{(sr)}}$。\n3. 通过报告绝对差值 $\\Delta m_0 = |m_0 - m_0^{\\mathrm{(sr)}}|$、$\\Delta m_1 = |m_1 - m_1^{\\mathrm{(sr)}}|$ 和 $\\Delta C = |C - C^{\\mathrm{(sr)}}|$ 来检验保真度。\n\n物理单位：\n- 能量 $2E_k$、$\\omega_i$、$m_1$ 和 $C$ 必须以 $\\mathrm{MeV}$ 为单位表示。\n- $m_0$ 和 $S_i$ 是无量纲的。\n\n角度单位：\n- 所有三角函数的参数均使用弧度。\n\n测试集：\n- 情况1（一般情况）：$N = 20$， $2E_k = 30 + 5 \\cos\\!\\left( \\frac{2\\pi k}{N} \\right)$ 单位为 $\\mathrm{MeV}$，$f_k = \\sin\\!\\left( \\frac{\\pi (k+1)}{N+1} \\right)$ 重新缩放以使 $\\sum_k f_k^2 = 1$（无量纲），$\\kappa = 0.8$ 单位为 $\\mathrm{MeV}$。\n- 情况2（边界条件，剩余相互作用为零）：$N = 10$， $2E_k = 25 + 3 \\cos\\!\\left( \\frac{2\\pi k}{N} \\right)$ 单位为 $\\mathrm{MeV}$，$f_k = \\sin\\!\\left( \\frac{2\\pi (k+1)}{N+1} \\right)$ 重新缩放以使 $\\sum_k f_k^2 = 1$（无量纲），$\\kappa = 0$ 单位为 $\\mathrm{MeV}$。\n- 情况3（大维度极限）：$N = 10^6$，所有 $k$ 的 $2E_k = 20$ 单位为 $\\mathrm{MeV}$，$f_k = 1/\\sqrt{N}$ 以使 $\\sum_k f_k^2 = 1$（无量纲），$\\kappa = 1.5$ 单位为 $\\mathrm{MeV}$。在此情况下，不要构建或对角化 $\\mathcal{M}$；仅报告求和规则质心 $C^{\\mathrm{(sr)}}$。\n\n要求的最终输出格式：\n- 你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，结果按以下顺序排列：\n  1. 情况1的 $\\Delta m_0$（无量纲），\n  2. 情况1的 $\\Delta m_1$（单位为 $\\mathrm{MeV}$），\n  3. 情况1的 $\\Delta C$（单位为 $\\mathrm{MeV}$），\n  4. 情况2的 $\\Delta m_0$（无量纲），\n  5. 情况2的 $\\Delta m_1$（单位为 $\\mathrm{MeV}$），\n  6. 情况2的 $\\Delta C$（单位为 $\\mathrm{MeV}$），\n  7. 情况3的 $C^{\\mathrm{(sr)}}$（单位为 $\\mathrm{MeV}$）。\n\n所有结果都应为实数。该单行必须严格按照上述顺序包含七个值。",
            "solution": "该问题要求针对一个具有可分离相互作用的示意性模型，通过与完整的准粒子随机相近似（QRPA）计算进行对比，来验证求和规则估计量的有效性。在计算核物理中，这是一个标准程序，用于评估那些避免了计算成本高昂的矩阵对角化的近似方法的质量。解决方案包含两个主要部分：直接计算求和规则估计量，以及对QRPA本征值问题进行完整的数值求解。\n\n其理论框架基于一个包含 $N$ 个双准粒子组态的系统的QRPA方程。这些未受扰动的组态的能量由 $\\{2E_k\\}$ 给出。剩余相互作用具有可分离的多极-多极形式，这将QRPA矩阵 $A$ 和 $B$ 简化如下：\n$$\nA_{kk'} = 2E_k\\,\\delta_{kk'} + \\kappa\\, f_k f_{k'}, \\quad\nB_{kk'} = \\kappa\\, f_k f_{k'}\n$$\n在这里，$\\{f_k\\}$ 代表准粒子对与集体多极算符的耦合强度，而 $\\kappa$ 是相互作用强度。完整的QRPA问题被封装在 $2N \\times 2N$ 的非厄米矩阵本征值问题中：\n$$\n\\mathcal{M} \\begin{pmatrix} X_i \\\\ Y_i \\end{pmatrix} = \n\\begin{pmatrix} A   B\\\\ -B  -A \\end{pmatrix} \n\\begin{pmatrix} X_i \\\\ Y_i \\end{pmatrix} = \n\\omega_i \\begin{pmatrix} X_i \\\\ Y_i \\end{pmatrix}\n$$\n其中 $\\omega_i$ 是激发能，$(X_i, Y_i)$ 是第 $i$ 个激发态的前向和后向QRPA振幅。\n\n**1. 求和规则估计量**\n\n求和规则估计量，用上标 $(\\text{sr})$ 表示，其计算无需求解QRPA本征值问题。它们基于未受扰动基态的性质。非能量加权求和规则（NEWSR）和能量加权求和规则（EWSR）的估计量定义为：\n$$\nm_0^{\\mathrm{(sr)}} = \\sum_{k=0}^{N-1} f_k^2\n$$\n$$\nm_1^{\\mathrm{(sr)}} = \\sum_{k=0}^{N-1} (2E_k)\\, f_k^2\n$$\n质心估计量是这两个量的比值：\n$$\nC^{\\mathrm{(sr)}} = \\frac{m_1^{\\mathrm{(sr)}}}{m_0^{\\mathrm{(sr)}}}\n$$\n对于测试用例，矢量 $\\{f_k\\}$ 被归一化，使得 $\\sum_k f_k^2 = 1$，这将NEWSR估计量简化为 $m_0^{\\mathrm{(sr)}} = 1$。\n\n**2. 完整的QRPA计算**\n\n为了进行确定性的计算，需要构建QRPA矩阵 $\\mathcal{M}$ 并数值求解其本征值问题。这将产生 $2N$ 个本征值和本征矢量。物理上有意义的解对应于实的、正的激发能 $\\omega_i  0$。\n\n一个关键步骤是QRPA本征矢量的归一化。标准的数值本征求解器通常返回欧几里得范数为1的本征矢量 $\\mathbf{v}'_i = (X'_i, Y'_i)^T$，即 $(\\mathbf{v}'_i)^\\dagger \\mathbf{v}'_i = 1$。然而，QRPA本征矢量的物理归一化是基于度规 $\\Sigma_3 = \\text{diag}(I, -I)$，对于一个正模态，其归一化条件由下式给出：\n$$\nX_i^\\mathsf{T} X_i - Y_i^\\mathsf{T} Y_i = 1\n$$\n此条件确保了该状态对应于一个物理的玻色子激发。因此，必须检查从本征求解器获得的每个本征矢量 $\\mathbf{v}'_i$。设 $N_i = (X'_i)^\\dagger X'_i - (Y'_i)^\\dagger Y'_i$。如果 $N_i  0$，则该模式具有正的模，通过重新缩放可获得正确归一化的振幅：$(X_i, Y_i) = (X'_i, Y'_i) / \\sqrt{N_i}$。模为 $N_i \\le 0$ 的模式是非物理的，应从求和规则的计算中排除。\n\n然后，使用归一化后的振幅计算每个物理模式 $i$ 的跃迁强度 $S_i$：\n$$\nS_i = \\left| \\sum_{k=0}^{N-1} f_k \\left( X_{ki} + Y_{ki} \\right) \\right|^2\n$$\n通过对所有物理模式（实的 $\\omega_i  0$ 且为正模）求和来计算求和规则：\n$$\nm_0 = \\sum_i S_i, \\quad m_1 = \\sum_i \\omega_i S_i\n$$\n质心为 $C = m_1 / m_0$。最后，通过绝对差值来量化求和规则估计量的保真度：$\\Delta m_0 = |m_0 - m_0^{\\mathrm{(sr)}}|$、$\\Delta m_1 = |m_1 - m_1^{\\mathrm{(sr)}}|$ 和 $\\Delta C = |C - C^{\\mathrm{(sr)}}|$。\n\n**3. 测试用例分析**\n\n- **情况1 ($N=20, \\kappa=0.8\\,\\mathrm{MeV}$):** 这是一个剩余相互作用起作用的一般情况。应用上述完整的数值计算流程。QRPA矩阵 $\\mathcal{M}$ 是一个 $40 \\times 40$ 的矩阵。我们预期偏差 $\\Delta m_0$、$\\Delta m_1$ 和 $\\Delta C$ 不为零，因为QRPA关联会重整化强度分布及其矩。\n\n- **情况2 ($N=10, \\kappa=0\\,\\mathrm{MeV}$):** 此情况对应于剩余相互作用为零。矩阵 $A$ 和 $B$ 变为 $A_{kk'} = 2E_k\\,\\delta_{kk'}$ 和 $B_{kk'} = 0$。QRPA矩阵 $\\mathcal{M}$ 变为块对角矩阵。本征值问题解耦，产生正能量解 $\\omega_k = 2E_k$ 其本征矢量为 $(X_k, Y_k) = (\\mathbf{e}_k, \\mathbf{0})$，其中 $\\mathbf{e}_k$ 是第 $k$ 个单位矢量。这些解已经是归一化的，$X_k^\\mathsf{T}X_k - Y_k^\\mathsf{T}Y_k = 1$。每个模式的强度为 $S_k = |f_k|^2$。因此，求和规则为 $m_0 = \\sum_k f_k^2 = m_0^{\\mathrm{(sr)}}$ 和 $m_1 = \\sum_k (2E_k) f_k^2 = m_1^{\\mathrm{(sr)}}$。因此，我们解析地预测 $\\Delta m_0=0$、$\\Delta m_1=0$ 和 $\\Delta C=0$。这可以作为检验数值实现正确性的一个极好的验证。\n\n- **情况3 ($N=10^6, \\kappa=1.5\\,\\mathrm{MeV}$):** 维度 $N=10^6$ 使得用标准直接方法对角化 $2 \\times 10^6 \\times 2 \\times 10^6$ 矩阵 $\\mathcal{M}$ 在计算上是不可行的。该问题正确地只要求计算质心的求和规则估计量 $C^{\\mathrm{(sr)}}$。给定所有 $k$ 的 $2E_k = 20\\,\\mathrm{MeV}$ 和 $f_k = 1/\\sqrt{N}$，计算过程非常直接：\n$$\nm_0^{\\mathrm{(sr)}} = \\sum_{k=0}^{N-1} \\left(\\frac{1}{\\sqrt{N}}\\right)^2 = \\sum_{k=0}^{N-1} \\frac{1}{N} = 1\n$$\n$$\nm_1^{\\mathrm{(sr)}} = \\sum_{k=0}^{N-1} (20\\,\\mathrm{MeV}) \\left(\\frac{1}{\\sqrt{N}}\\right)^2 = \\frac{20}{N} \\sum_{k=0}^{N-1} 1 = 20\\,\\mathrm{MeV}\n$$\n$$\nC^{\\mathrm{(sr)}} = \\frac{20\\,\\mathrm{MeV}}{1} = 20\\,\\mathrm{MeV}\n$$\n\n实现将遵循这一逻辑，使用 `numpy`进行数组操作，并使用`scipy.linalg.eig`进行本征值分解。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import linalg\n\ndef compute_qrpa_deltas(N, E2k_values, f_k_vector, kappa):\n    \"\"\"\n    Constructs and solves the QRPA problem for a separable interaction,\n    and computes the difference between full results and sum-rule estimators.\n\n    Args:\n        N (int): Number of two-quasiparticle configurations.\n        E2k_values (np.ndarray): Array of two-quasiparticle energies (2E_k).\n        f_k_vector (np.ndarray): Normalized coupling vector (f_k).\n        kappa (float): Residual interaction strength.\n\n    Returns:\n        tuple: A tuple containing (delta_m0, delta_m1, delta_c).\n    \"\"\"\n    # 1. Calculate sum-rule estimators\n    # The f_k vector is pre-normalized, so sum(f_k**2) is 1.\n    m0_sr = 1.0\n    m1_sr = np.sum(E2k_values * f_k_vector**2)\n    # Avoid division by zero, though not expected here\n    C_sr = m1_sr / m0_sr if not np.isclose(m0_sr, 0.0) else 0.0\n\n    # 2. Construct and solve the full QRPA problem\n    A = np.diag(E2k_values) + kappa * np.outer(f_k_vector, f_k_vector)\n    B = kappa * np.outer(f_k_vector, f_k_vector)\n    M = np.block([[A, B], [-B, -A]])\n\n    omega_all, eigvecs_all = linalg.eig(M)\n\n    m0_diag = 0.0\n    m1_diag = 0.0\n    \n    tol = 1e-9  # Tolerance for floating point comparisons\n\n    for i in range(2 * N):\n        omega = omega_all[i]\n        \n        # Filter for physical solutions: real, positive energy\n        if omega.real = tol or np.abs(omega.imag) > tol:\n            continue\n\n        v = eigvecs_all[:, i]\n        X = v[:N]\n        Y = v[N:]\n\n        # Calculate the QRPA norm of the eigenvector\n        # Using np.vdot handles complex conjugation: vdot(a,b) = a*.T @ b\n        norm_val = (np.vdot(X, X) - np.vdot(Y, Y)).real\n        \n        # Filter for positive-norm modes\n        if norm_val = tol:\n            continue\n            \n        # Renormalize the eigenvector to have QRPA norm of +1\n        renorm_factor = np.sqrt(norm_val)\n        X_norm = X / renorm_factor\n        Y_norm = Y / renorm_factor\n        \n        # Calculate transition strength S_i\n        strength_sum_term = np.sum(f_k_vector * (X_norm + Y_norm))\n        S_i = np.abs(strength_sum_term)**2\n        \n        # Accumulate sum rules from diagonalized results\n        m0_diag += S_i\n        m1_diag += omega.real * S_i\n\n    # Calculate centroid from diagonalized results\n    if np.isclose(m0_diag, 0.0):\n       C_diag = 0.0 if np.isclose(m1_diag, 0.0) else np.inf\n    else:\n       C_diag = m1_diag / m0_diag\n       \n    # 3. Compute absolute differences\n    delta_m0 = np.abs(m0_diag - m0_sr)\n    delta_m1 = np.abs(m1_diag - m1_sr)\n    delta_c = np.abs(C_diag - C_sr)\n    \n    return delta_m0, delta_m1, delta_c\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for all test cases.\n    \"\"\"\n    results = []\n\n    # Case 1: General case\n    N1 = 20\n    kappa1 = 0.8\n    k1 = np.arange(N1)\n    E2k1 = 30.0 + 5.0 * np.cos(2.0 * np.pi * k1 / N1)\n    fk1_unscaled = np.sin(np.pi * (k1 + 1.0) / (N1 + 1.0))\n    fk1_norm = np.linalg.norm(fk1_unscaled)\n    fk1 = fk1_unscaled / fk1_norm\n    \n    deltas1 = compute_qrpa_deltas(N1, E2k1, fk1, kappa1)\n    results.extend(deltas1)\n    \n    # Case 2: Boundary condition, vanishing residual interaction\n    N2 = 10\n    kappa2 = 0.0\n    k2 = np.arange(N2)\n    E2k2 = 25.0 + 3.0 * np.cos(2.0 * np.pi * k2 / N2)\n    fk2_unscaled = np.sin(2.0 * np.pi * (k2 + 1.0) / (N2 + 1.0))\n    fk2_norm = np.linalg.norm(fk2_unscaled)\n    fk2 = fk2_unscaled / fk2_norm\n\n    deltas2 = compute_qrpa_deltas(N2, E2k2, fk2, kappa2)\n    results.extend(deltas2)\n\n    # Case 3: Large-dimensional limit, sum-rule estimator only\n    # As derived in the solution text, C_sr = 20.0 MeV.\n    # m0_sr = sum((1/sqrt(N))^2) = N * (1/N) = 1\n    # m1_sr = sum(20 * (1/sqrt(N))^2) = 20 * N * (1/N) = 20\n    # C_sr = m1_sr / m0_sr = 20.0 / 1.0 = 20.0\n    C_sr3 = 20.0\n    results.append(C_sr3)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}