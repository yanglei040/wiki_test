{
    "hands_on_practices": [
        {
            "introduction": "这个首个实践练习将深入探讨巨共振的理论核心：能权求和规则 (Energy-Weighted Sum Rule, EWSR)。通过使用二次对易子形式从第一性原理出发进行推导，你将揭示同位旋矢量巨偶极共振的增强因子 $\\kappa$（一个关键的可观测量）与核子有效质量 $m^{\\ast}$（编码了核力的速度依赖性）之间的深刻联系。本练习旨在巩固对宏观集体性质如何从能量密度泛函所描述的微观动力学中涌现的理解。",
            "id": "3549862",
            "problem": "考虑一个在局域规范不变的 Skyrme 能量密度泛函 (EDF) 框架内描述的原子核，并限制在时间偶部分和空间梯度的二阶。设单粒子动力学由一个同位旋标量有效质量场 $m^{*}(\\mathbf{r})$ 表征，使得平均场动能算符为 $-\\nabla \\cdot \\left(\\frac{\\hbar^{2}}{2 m^{*}(\\mathbf{r})} \\nabla \\right)$。对于一个单体算符 $\\hat{F}$，其能量加权求和规则 $m_{1}$ 由二重对易子定义\n$$\nm_{1}(\\hat{F}) \\equiv \\frac{1}{2} \\langle 0 | [\\hat{F}, [\\hat{H}, \\hat{F}]] | 0 \\rangle,\n$$\n其中 $\\hat{H}$ 是从 Skyrme EDF 得到的自洽 Hartree-Fock 哈密顿量，而 $|0\\rangle$ 是 Hartree-Fock 基态。假设 Skyrme EDF 严格遵守局域规范（伽利略）不变性，从而使得连续性方程对总密度以及分别对质子和中子密度都成立。\n\n从这些基础出发，并且不引入任何唯象的求和规则捷径，执行以下操作：\n\n1. 对于形式为 $\\hat{F}_{\\mathrm{IS}} = \\sum_{i} f(\\mathbf{r}_{i})$ 的普遍局域同位旋标量单体算符，利用连续性方程和对易子结构来判断能量加权和 $m_{1}(\\hat{F}_{\\mathrm{IS}})$ 是依赖于同位旋标量有效质量 $m^{*}(\\mathbf{r})$ 还是仅依赖于裸核子质量 $m$。你的分析应对任意光滑的 $f(\\mathbf{r})$ 和现实的、有限原子核的基态密度 $\\rho(\\mathbf{r})$ 均有效。\n\n2. 对于经过质心运动修正的同位旋矢量电偶极算符 $\\hat{F}_{\\mathrm{IV}} = \\sum_{p} z_{p} - \\frac{Z}{A} \\sum_{i} z_{i}$（等效地，与质子-中子中心分离成正比），通过计算二重对易子并识别来自 Skyrme EDF 速度依赖部分的贡献，来推导 $m_{1}(\\hat{F}_{\\mathrm{IV}})$ 的结构。证明该能量加权和可以写为 Thomas-Reiche-Kuhn (TRK) 值乘以一个增强因子 $1+\\kappa$ 的形式，其中 $\\kappa$ 源于泛函的同位旋矢量流/动能耦合。\n\n3. 通过分析质子-中子连续性方程以及对应的同位旋矢量流的惯量，将增强因子 $\\kappa$ 与同位旋矢量道中的有效质量 $m_{v}^{*}$ 联系起来。然后，在适用于对称核物质和 $m_{v}^{*} \\approx m^{*}$ 的 Skyrme 参数化方案的简化假设下，仅用同位旋标量有效质量比 $m^{*}/m$ 来以闭合形式表示增强因子 $\\kappa$。\n\n你的最终答案必须是关于 $\\kappa$ 的、仅用 $m^{*}/m$ 表示的单个闭合形式的解析表达式。无需进行数值计算。",
            "solution": "该问题要求在 Skyrme 能量密度泛函 (EDF) 的框架内分析能量加权求和规则 (EWSRs)，重点关注有效质量的作用。我们必须首先验证问题陈述，该陈述在科学上是合理的、提法恰当，并且是原子核结构物理中的一个标准理论练习。我们按顺序对三个部分进行解答。\n\n对于一个单体算符 $\\hat{F}$，其能量加权求和规则 $m_1$ 由其与哈密顿量 $\\hat{H}$ 的二重对易子定义：\n$$\nm_{1}(\\hat{F}) \\equiv \\frac{1}{2} \\langle 0 | [\\hat{F}, [\\hat{H}, \\hat{F}]] | 0 \\rangle\n$$\n其中 $|0\\rangle$ 是 Hartree-Fock 基态。\n\n**第一部分：同位旋标量求和规则**\n\n对于形式为 $\\hat{F}_{\\mathrm{IS}} = \\sum_{i} f(\\mathbf{r}_{i})$ 的普遍局域同位旋标量单体算符，我们计算其求和规则。我们可以将 $\\hat{F}_{\\mathrm{IS}}$ 写成对粒子数密度算符 $\\hat{\\rho}(\\mathbf{r}) = \\sum_i \\delta(\\mathbf{r}-\\mathbf{r}_i)$ 的积分：\n$$\n\\hat{F}_{\\mathrm{IS}} = \\int f(\\mathbf{r}) \\hat{\\rho}(\\mathbf{r}) d^3r\n$$\n使用连续性方程可以大大简化求和规则的计算，根据题设，由于 EDF 的局域规范（伽利略）不变性，连续性方程是成立的。算符形式的连续性方程由密度算符的 Heisenberg 运动方程给出：\n$$\n[\\hat{H}, \\hat{\\rho}(\\mathbf{r})] = -i\\hbar \\nabla \\cdot \\hat{\\mathbf{j}}(\\mathbf{r})\n$$\n其中 $\\hat{\\mathbf{j}}(\\mathbf{r})$ 是总粒子流算符。伽利略不变性的一个基本推论是，粒子流算符通过裸核子质量 $m$ 与动量密度算符相关联，而与平均场描述中导致有效质量的势能项无关。同位旋标量流算符为：\n$$\n\\hat{\\mathbf{j}}(\\mathbf{r}) = \\frac{1}{m} \\sum_{i} \\frac{1}{2} \\{ \\hat{\\mathbf{p}}_i, \\delta(\\mathbf{r}-\\mathbf{r}_i) \\}\n$$\n利用此关系，我们计算内层对易子：\n$$\n[\\hat{H}, \\hat{F}_{\\mathrm{IS}}] = \\int f(\\mathbf{r}) [\\hat{H}, \\hat{\\rho}(\\mathbf{r})] d^3r = -i\\hbar \\int f(\\mathbf{r}) (\\nabla \\cdot \\hat{\\mathbf{j}}(\\mathbf{r})) d^3r\n$$\n使用分部积分法，并假设无穷远处的边界项为零，我们得到：\n$$\n[\\hat{H}, \\hat{F}_{\\mathrm{IS}}] = i\\hbar \\int (\\nabla f(\\mathbf{r})) \\cdot \\hat{\\mathbf{j}}(\\mathbf{r}) d^3r\n$$\n现在，我们计算外层对易子。算符 $\\hat{F}_{\\mathrm{IS}}$ 仅是坐标的函数，而 $\\hat{\\mathbf{j}}(\\mathbf{r})$ 对动量是线性的。它们的对易子是一个 c-数乘以密度算符。\n$$\n[\\hat{F}_{\\mathrm{IS}}, \\hat{\\mathbf{j}}(\\mathbf{r}')] = \\left[ \\sum_i f(\\mathbf{r}_i), \\frac{1}{2m} \\sum_j \\{ \\hat{\\mathbf{p}}_j, \\delta(\\mathbf{r}'-\\mathbf{r}_j) \\} \\right] = \\frac{1}{m} \\sum_i [f(\\mathbf{r}_i), \\hat{\\mathbf{p}}_i] \\delta(\\mathbf{r}'-\\mathbf{r}_i)\n$$\n使用正则对易关系 $[f(\\mathbf{r}_i), \\hat{\\mathbf{p}}_i] = i\\hbar \\nabla_i f(\\mathbf{r}_i)$，我们得到：\n$$\n[\\hat{F}_{\\mathrm{IS}}, \\hat{\\mathbf{j}}(\\mathbf{r}')] = \\frac{i\\hbar}{m} \\sum_i (\\nabla_i f(\\mathbf{r}_i)) \\delta(\\mathbf{r}'-\\mathbf{r}_i) = \\frac{i\\hbar}{m} (\\nabla' f(\\mathbf{r}')) \\hat{\\rho}(\\mathbf{r}')\n$$\n将此结果代回二重对易子：\n$$\n[\\hat{F}_{\\mathrm{IS}}, [\\hat{H}, \\hat{F}_{\\mathrm{IS}}]] = i\\hbar \\int (\\nabla f(\\mathbf{r})) \\cdot [\\hat{F}_{\\mathrm{IS}}, \\hat{\\mathbf{j}}(\\mathbf{r})] d^3r = i\\hbar \\int (\\nabla f(\\mathbf{r})) \\cdot \\left( \\frac{i\\hbar}{m} (\\nabla f(\\mathbf{r})) \\hat{\\rho}(\\mathbf{r}) \\right) d^3r = -\\frac{\\hbar^2}{m} \\int |\\nabla f(\\mathbf{r})|^2 \\hat{\\rho}(\\mathbf{r}) d^3r\n$$\n最后，我们在基态 $|0\\rangle$ 中取期望值，其中 $\\langle 0 | \\hat{\\rho}(\\mathbf{r}) | 0 \\rangle = \\rho_0(\\mathbf{r})$ 是基态密度。\n$$\nm_1(\\hat{F}_{\\mathrm{IS}}) = \\frac{1}{2} \\left\\langle 0 \\left| -\\frac{\\hbar^2}{m} \\int |\\nabla f(\\mathbf{r})|^2 \\hat{\\rho}(\\mathbf{r}) d^3r \\right| 0 \\right\\rangle = \\frac{\\hbar^2}{2m} \\int |\\nabla f(\\mathbf{r})|^2 \\rho_0(\\mathbf{r}) d^3r\n$$\n局域同位旋标量算符 $\\hat{F}_{\\mathrm{IS}}$ 的求和规则仅依赖于裸核子质量 $m$，而不依赖于同位旋标量有效质量 $m^*(\\mathbf{r})$。这是伽利略不变性的直接结果，该不变性决定了守恒粒子流的形式。\n\n**第二部分：同位旋矢量偶极求和规则**\n\n我们考虑经过质心运动修正的同位旋矢量电偶极算符 $\\hat{F}_{\\mathrm{IV}} = \\sum_{p} z_{p} - \\frac{Z}{A} \\sum_{i} z_{i}$。这可以重写为 $\\hat{F}_{\\mathrm{IV}} = \\frac{N}{A} \\sum_p z_p - \\frac{Z}{A} \\sum_n z_n$。该求和规则由两部分组成：一部分来自运动能算符 $\\hat{T} = \\sum_i \\hat{\\mathbf{p}}_i^2/(2m)$，另一部分来自势能算符 $\\hat{V}$。\n$$\nm_{1}(\\hat{F}_{\\mathrm{IV}}) = \\frac{1}{2} \\langle 0 | [\\hat{F}_{\\mathrm{IV}}, [\\hat{T}, \\hat{F}_{\\mathrm{IV}}]] | 0 \\rangle + \\frac{1}{2} \\langle 0 | [\\hat{F}_{\\mathrm{IV}}, [\\hat{V}, \\hat{F}_{\\mathrm{IV}}]] | 0 \\rangle\n$$\n第一项是模型无关的 Thomas-Reiche-Kuhn (TRK) 求和规则值。令 $q_i$ 为“偶极荷”（对质子为 $N/A$，对中子为 $-Z/A$），则 $\\hat{F}_{\\mathrm{IV}} = \\sum_i q_i z_i$。二重对易子的动能部分为：\n$$\n[\\hat{F}_{\\mathrm{IV}}, [\\hat{T}, \\hat{F}_{\\mathrm{IV}}]] = \\left[\\sum_j q_j z_j, \\left[\\sum_k \\frac{p_{z,k}^2}{2m}, \\sum_l q_l z_l\\right]\\right] = \\left[\\sum_j q_j z_j, \\sum_k q_k \\frac{-i\\hbar p_{z,k}}{m}\\right] = \\sum_k q_k^2 \\frac{-i\\hbar}{m} [z_k, p_{z,k}] = \\frac{\\hbar^2}{m} \\sum_k q_k^2\n$$\n荷的平方和为 $\\sum_k q_k^2 = Z(N/A)^2 + N(-Z/A)^2 = \\frac{ZN^2+NZ^2}{A^2} = \\frac{ZN(N+Z)}{A^2} = \\frac{NZ}{A}$。\n因此，TRK 部分为：\n$$\nm_{1, \\mathrm{TRK}} = \\frac{1}{2} \\frac{\\hbar^2}{m} \\frac{NZ}{A}\n$$\n第二项涉及势能 $\\hat{V}$，其出现是因为核相互作用包含动量依赖的交换项（速度依赖力）。这些项与同位旋矢量算符 $\\hat{F}_{\\mathrm{IV}}$ 不对易。这个贡献被称为增强因子 $\\kappa$。\n$$\n\\frac{1}{2} \\langle 0 | [\\hat{F}_{\\mathrm{IV}}, [\\hat{V}, \\hat{F}_{\\mathrm{IV}}]] | 0 \\rangle = \\kappa \\cdot m_{1, \\mathrm{TRK}}\n$$\n因此，总能量加权和为 $m_1(\\hat{F}_{\\mathrm{IV}}) = m_{1, \\mathrm{TRK}} (1+\\kappa)$。因子 $\\kappa$ 包含了核相互作用中速度依赖和同位旋敏感部分的影响，这些部分也导致了平均场中有效质量的出现。\n\n**第三部分：增强因子和有效质量**\n\n问题要求通过考虑同位旋矢量流的惯量，将 $\\kappa$ 与同位旋矢量有效质量 $m_v^*$ 联系起来。EWSR 可以普遍地理解为与被激发的集体模式的惯量成反比。\n$$\nm_1(\\hat{F}) = \\frac{\\hbar^2}{2 M_{\\mathrm{eff}}}\n$$\n其中 $M_{\\mathrm{eff}}$ 是与算符 $\\hat{F}$ 相关的有效惯量。\n对于同位旋矢量偶极模式，相关的运动是质子相对于中子的振荡。算符 $\\hat{F}_{\\mathrm{IV}}$ 产生这种运动。TRK 求和规则对应于惯量由裸质量 $m$ 给出的情况。此模式的惯量为 $M_{\\mathrm{IV, bare}} \\propto m$。\n速度依赖的核力的存在会修正这个惯量。有效惯量 $M_{\\mathrm{IV, eff}}$ 由包括这些力在内的全动力学决定。对于一个给定模式，有效质量的定义本身就是描述其惯性性质的质量。对于同位旋矢量模式，这个质量就是同位旋矢量有效质量 $m_v^*$。因此，有效惯量与该质量成正比：$M_{\\mathrm{IV, eff}} \\propto m_v^*$。\n\n求和规则的增强是裸惯量与有效惯量的比值：\n$$\n1+\\kappa = \\frac{m_1(\\hat{F}_{\\mathrm{IV}})}{m_{1, \\mathrm{TRK}}} = \\frac{\\hbar^2/(2M_{\\mathrm{IV, eff}})}{\\hbar^2/(2M_{\\mathrm{IV, bare}})} = \\frac{M_{\\mathrm{IV, bare}}}{M_{\\mathrm{IV, eff}}}\n$$\n由于惯量与各自的质量（$m$ 和 $m_v^*$）成正比，我们有：\n$$\n1+\\kappa = \\frac{m}{m_v^*}\n$$\n这就提供了问题所要求的增强因子 $\\kappa$ 和同位旋矢量有效质量 $m_v^*$ 之间的直接联系。\n\n最后，我们应用简化假设 $m_v^* \\approx m^*$，这对于对称核物质是合适的，并且是许多 Skyrme 参数化方案的一个共同特征。通过用同位旋标量有效质量 $m^*$ 替换 $m_v^*$，我们得到 $\\kappa$ 的表达式：\n$$\n1+\\kappa = \\frac{m}{m^*}\n$$\n由此，我们解出 $\\kappa$：\n$$\n\\kappa = \\frac{m}{m^*} - 1\n$$\n在指定的假设下，这个最终表达式将同位旋矢量偶极求和规则的增强与同位旋标量有效质量联系起来。",
            "answer": "$$\n\\boxed{\\frac{m}{m^{\\ast}} - 1}\n$$"
        },
        {
            "introduction": "在求和规则理论理解的基础上，本实践练习将过渡到一个模拟实验分析的计算情境。你将为一个偶极强度函数实现一个具有物理动机的模型，并对其进行数值积分，以检验托马斯-赖歇-库恩 (Thomas-Reiche-Kuhn, TRK) 求和规则的饱和情况。这项动手练习对于培养谱数据建模和量化在给定能量范围内捕获了多少总集体强度的能力至关重要，这是核物理研究中的一项常见任务。",
            "id": "3549914",
            "problem": "您的任务是通过将能量加权强度分布积分到一个有限的最大能量，并量化连续谱尾部中缺失的强度，来数值检验同位旋矢量电偶极响应的Thomas–Reiche–Kuhn (TRK) 能量加权求和规则饱和度。请从以下基础出发：对于一个厄米激发算符，其能量加权求和规则定义为谱强度分布的一阶矩。对于一个中子数为 $N$、质子数为 $Z$、质量数为 $A$ 的原子核中的同位旋矢量电偶极算符，TRK能量加权求和规则由下式给出：\n$$\nm_1^{\\mathrm{TRK}} = \\frac{9\\hbar^2}{8\\pi m_N}\\frac{NZ}{A},\n$$\n其中 $m_N$ 是核子质量。使用数值常数 $\\hbar^2/m_N = 41.47106\\,\\mathrm{MeV}\\cdot\\mathrm{fm}^2$。量 $m_1$ 是谱函数的能量加权积分：\n$$\nm_1(E_{\\max}) = \\int_0^{E_{\\max}} \\omega\\, S(\\omega)\\, d\\omega,\n$$\n其中 $S(\\omega)$ 是作为激发能 $\\omega$ 的函数的偶极强度分布。\n\n将强度分布 $S(\\omega)$ 建模为巨偶极共振组分和连续谱尾部组分的叠加：\n$$\nS(\\omega) = A_G\\, L(\\omega;\\omega_0,\\Gamma,\\omega_{cL}) + A_T\\, T(\\omega;\\omega_0,\\alpha,\\omega_c),\n$$\n其形状函数在 $\\omega \\ge 0$ 上定义为\n$$\nL(\\omega;\\omega_0,\\Gamma,\\omega_{cL}) = \\frac{1}{\\pi}\\,\\frac{\\Gamma}{(\\omega-\\omega_0)^2 + \\Gamma^2}\\, \\exp\\!\\left(-\\frac{\\omega}{\\omega_{cL}}\\right),\n$$\n$$\nT(\\omega;\\omega_0,\\alpha,\\omega_c) = \\frac{1}{\\omega_0}\\left(\\frac{\\omega}{\\omega_0}\\right)^{\\alpha}\\, \\exp\\!\\left(-\\frac{\\omega}{\\omega_c}\\right).\n$$\n此处，$\\omega_0$ 是巨共振的质心能量（单位 $\\mathrm{MeV}$），$\\Gamma$ 是其宽度（单位 $\\mathrm{MeV}$），$\\omega_{cL}$ 是共振的高能截断参数（单位 $\\mathrm{MeV}$），$\\alpha$ 是一个控制尾部低能区上升的非负实数参数，$\\omega_c$ 是连续谱尾部的衰减尺度（单位 $\\mathrm{MeV}$）。假设由 $S(\\omega)$ 承载的总能量加权和相对于TRK值增强了一个因子 $(1+\\kappa)$，其中 $\\kappa \\ge 0$：\n$$\nm_1^{\\mathrm{tot}} = (1+\\kappa)\\, m_1^{\\mathrm{TRK}}.\n$$\n\n通过强制要求巨共振组分承载 $m_1^{\\mathrm{tot}}$ 的 $f_G$ 部分，而尾部组分承载剩余的 $(1-f_G)$ 部分，来确定振幅 $A_G$ 和 $A_T$：\n$$\nA_G = \\frac{f_G\\, m_1^{\\mathrm{tot}}}{\\displaystyle \\int_0^{\\infty} \\omega\\, L(\\omega;\\omega_0,\\Gamma,\\omega_{cL})\\, d\\omega}, \\quad A_T = \\frac{(1-f_G)\\, m_1^{\\mathrm{tot}}}{\\displaystyle \\int_0^{\\infty} \\omega\\, T(\\omega;\\omega_0,\\alpha,\\omega_c)\\, d\\omega}.\n$$\n所有积分均是对以 $\\mathrm{MeV}$ 为单位的 $\\omega$ 进行，所得的 $m_1$ 值的单位是 $\\mathrm{e}^2\\cdot\\mathrm{fm}^2\\cdot\\mathrm{MeV}$；然而，本任务要求输出的是无量纲的比率或分数，并且必须以纯小数形式报告。\n\n对于下方的每个测试用例，您必须：\n- 根据给定的 $N$、$Z$ 和 $A$ 计算 $m_1^{\\mathrm{TRK}}$。\n- 计算 $m_1^{\\mathrm{tot}} = (1+\\kappa)\\, m_1^{\\mathrm{TRK}}$。\n- 根据上述归一化条件确定 $A_G$ 和 $A_T$，使用数值积分计算所需的能量加权积分。\n- 对于每个用例给定的 $E_{\\max}$，数值计算 $m_1(E_{\\max}) = \\int_0^{E_{\\max}} \\omega S(\\omega)\\, d\\omega$。\n- 以小数形式报告TRK饱和度分数 $F = m_1(E_{\\max})/m_1^{\\mathrm{TRK}}$。\n- 将 $E_{\\max}$ 以上连续谱尾部中缺失的强度量化为以下分数\n$$\nM_{\\mathrm{tail}} = \\frac{\\displaystyle \\int_{E_{\\max}}^{\\infty} \\omega\\, A_T\\, T(\\omega;\\omega_0,\\alpha,\\omega_c)\\, d\\omega}{\\displaystyle \\int_0^{\\infty} \\omega\\, A_T\\, T(\\omega;\\omega_0,\\alpha,\\omega_c)\\, d\\omega},\n$$\n该值是无量纲的，必须以小数形式报告。\n\n物理单位：所有能量 $\\omega$、$\\omega_0$、$\\Gamma$、$\\omega_c$ 和 $\\omega_{cL}$ 的单位均为 $\\mathrm{MeV}$。程序必须输出所要求的比率 $F$ 和 $M_{\\mathrm{tail}}$，作为不带任何单位符号的纯小数。\n\n角度单位不适用。\n\n百分比必须以小数形式表示，不得使用百分号。\n\n设计一个数值稳定的算法来计算所需的积分，使用一个鲁棒的数值积分器处理反常积分，并通过模型定义中提供的指数截断来确保收敛。为确保通用性和可复现性，不要硬编码任何解析积分；相反，所有积分都应以数值方式执行。\n\n测试套件：\n使用以下参数集，每个参数集以元组 $(N,Z,A,\\omega_0,\\Gamma,\\alpha,\\omega_c,\\omega_{cL},\\kappa,f_G,E_{\\max})$ 的形式给出。\n- 用例1（正常路径，重核）：$(126,82,208,13.5,3.8,2.0,50.0,80.0,0.20,0.90,100.0)$。\n- 用例2（中等质量核）：$(70,50,120,15.5,4.5,2.5,60.0,90.0,0.10,0.85,100.0)$。\n- 用例3（轻核，无增强）：$(8,8,16,22.0,7.5,3.0,70.0,100.0,0.00,0.80,100.0)$。\n- 用例4（低 $E_{\\max}$ 的边界条件）：$(126,82,208,13.5,3.8,2.0,50.0,80.0,0.20,0.90,25.0)$。\n- 用例5（慢衰减尾部的边缘情况）：$(40,28,68,17.0,5.5,1.0,80.0,120.0,0.15,0.70,100.0)$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含所有测试用例的结果，形式为一个用方括号括起来的逗号分隔列表。每个测试用例的结果本身必须是一个双元素列表 $[F, M_{\\mathrm{tail}}]$，其中两个条目均为小数。例如，三个用例的输出应如下所示：\n$$\n[[F_1,M_{\\mathrm{tail},1}],[F_2,M_{\\mathrm{tail},2}],[F_3,M_{\\mathrm{tail},3}]].\n$$\n您的程序必须在单行中精确计算并打印出\n$[[F_1,M_{\\mathrm{tail},1}],[F_2,M_{\\mathrm{tail},2}],\\dots,[F_5,M_{\\mathrm{tail},5}]]$\n，不带任何附加文本。",
            "solution": "所述问题在科学上是合理的、提法恰当，并包含了获得唯一数值解所需的所有信息。它基于核物理的既定原理，特别是集体激发理论和能量加权求和规则的应用。谱强度分布的唯象模型是该领域中一种标准且具有物理动机的方法。因此，该问题被认为是**有效的**，下面提供了解决方案。\n\n### 1. 理论框架与模型详述\n\n核心概念是Thomas–Reiche–Kuhn (TRK) 能量加权求和规则 (EWSR)，它为原子核中电偶极激发总强度提供了一个基准。该问题将谱强度分布的一阶矩 $m_1$ 的TRK值定义为：\n$$\nm_1^{\\mathrm{TRK}} = \\frac{9\\hbar^2}{8\\pi m_N}\\frac{NZ}{A}\n$$\n其中 $N$、$Z$ 和 $A$ 分别是原子核的中子数、质子数和质量数。物理常数 $\\hbar^2/m_N$ 被提供为 $41.47106\\,\\mathrm{MeV}\\cdot\\mathrm{fm}^2$。这个值 $m_1^{\\mathrm{TRK}}$ 作为基本参考，用于与计算出的积分强度进行比较。\n\n谱强度分布 $S(\\omega)$ 描述了在能量 $\\omega$ 处发生激发的概率，它被建模为一个双组分函数：\n$$\nS(\\omega) = A_G\\, L(\\omega;\\omega_0,\\Gamma,\\omega_{cL}) + A_T\\, T(\\omega;\\omega_0,\\alpha,\\omega_c)\n$$\n第一项代表巨偶极共振 (GDR)，即质子相对于中子的集体振荡。其形状 $L(\\omega)$ 是一个带有高能指数截断的修正洛伦兹函数：\n$$\nL(\\omega;\\omega_0,\\Gamma,\\omega_{cL}) = \\frac{1}{\\pi}\\,\\frac{\\Gamma}{(\\omega-\\omega_0)^2 + \\Gamma^2}\\, \\exp\\!\\left(-\\frac{\\omega}{\\omega_{cL}}\\right)\n$$\n此处，$\\omega_0$ 是共振的质心能量，$\\Gamma$ 是其宽度，$\\omega_{cL}$ 是截断的能量尺度。\n\n第二项代表在更高能量处的连续谱，或称“尾部”激发，它源于诸如准氘核效应等机制。其形状 $T(\\omega)$ 被建模为一个带指数衰减的幂律：\n$$\nT(\\omega;\\omega_0,\\alpha,\\omega_c) = \\frac{1}{\\omega_0}\\left(\\frac{\\omega}{\\omega_0}\\right)^{\\alpha}\\, \\exp\\!\\left(-\\frac{\\omega}{\\omega_c}\\right)\n$$\n此处，$\\alpha$ 控制低能区的上升，$\\omega_c$ 是特征衰减能量。\n\n总能量加权和 $m_1^{\\mathrm{tot}}$ 假定相对于TRK值被一个因子 $(1+\\kappa)$ 增强，以解释介子效应和其他亚核子效应：\n$$\nm_1^{\\mathrm{tot}} = \\int_0^{\\infty} \\omega\\, S(\\omega)\\, d\\omega = (1+\\kappa)\\, m_1^{\\mathrm{TRK}}\n$$\n振幅 $A_G$ 和 $A_T$ 通过划分这个总强度来确定。GDR被分配了 $f_G$ 的份额，尾部被分配了剩余的 $(1-f_G)$ 份额。这导致了以下归一化条件：\n$$\nA_G = \\frac{f_G\\, m_1^{\\mathrm{tot}}}{I_G}, \\quad \\text{其中} \\quad I_G = \\int_0^{\\infty} \\omega\\, L(\\omega;\\omega_0,\\Gamma,\\omega_{cL})\\, d\\omega\n$$\n$$\nA_T = \\frac{(1-f_G)\\, m_1^{\\mathrm{tot}}}{I_T}, \\quad \\text{其中} \\quad I_T = \\int_0^{\\infty} \\omega\\, T(\\omega;\\omega_0,\\alpha,\\omega_c)\\, d\\omega\n$$\n$L(\\omega)$ 和 $T(\\omega)$ 中指数截断的存在确保了归一化积分 $I_G$ 和 $I_T$ 的收敛，使它们适合进行数值计算。\n\n### 2. 数值求解的算法流程\n\n解决方案需要对每个测试用例进行逐步计算。该算法使用Python和 `SciPy` 库来实现鲁棒的数值积分。\n\n**步骤1：计算基本求和规则**\n对于每个由 $(N, Z, A)$ 定义的原子核，计算参考的TRK求和规则值 $m_1^{\\mathrm{TRK}}$。随后，使用给定的增强因子 $\\kappa$ 计算总的增强求和规则 $m_1^{\\mathrm{tot}}$。\n\n**步骤2：确定振幅 $A_G$ 和 $A_T$**\n此步骤涉及数值计算归一化积分 $I_G = \\int_0^{\\infty} \\omega L(\\omega) d\\omega$ 和 $I_T = \\int_0^{\\infty} \\omega T(\\omega) d\\omega$。这些反常积分使用 `scipy.integrate.quad` 函数计算。在确定 $I_G$ 和 $I_T$ 后，使用 $m_1^{\\mathrm{tot}}$ 和分数 $f_G$ 根据它们的定义计算振幅 $A_G$ 和 $A_T$。\n\n**步骤3：评估积分强度 $m_1(E_{\\max})$**\n能量加权强度从 $\\omega=0$ 积分到指定的最大能量 $E_{\\max}$：\n$$\nm_1(E_{\\max}) = \\int_0^{E_{\\max}} \\omega\\, S(\\omega)\\, d\\omega = \\int_0^{E_{\\max}} \\omega\\, \\left[A_G\\, L(\\omega) + A_T\\, T(\\omega)\\right] d\\omega\n$$\n这个定积分也通过 `scipy.integrate.quad` 进行数值计算。\n\n**步骤4：计算饱和度分数 $F$**\n饱和度分数 $F$ 量化了直到能量 $E_{\\max}$ 的激发耗尽了多少TRK求和规则。它通过简单的比率计算得出：\n$$\nF = \\frac{m_1(E_{\\max})}{m_1^{\\mathrm{TRK}}}\n$$\n\n**步骤5：计算缺失的尾部分数 $M_{\\mathrm{tail}}$**\n这个量度量了连续谱尾部的能量加权强度中位于 $E_{\\max}$ 之外的部分。其定义为：\n$$\nM_{\\mathrm{tail}} = \\frac{\\displaystyle \\int_{E_{\\max}}^{\\infty} \\omega\\, A_T\\, T(\\omega)\\, d\\omega}{\\displaystyle \\int_0^{\\infty} \\omega\\, A_T\\, T(\\omega)\\, d\\omega}\n$$\n常数振幅 $A_T$ 可以消去，从而将计算简化为涉及能量加权形状函数 $\\omega T(\\omega)$ 的积分之比：\n$$\nM_{\\mathrm{tail}} = \\frac{\\displaystyle \\int_{E_{\\max}}^{\\infty} \\omega\\, T(\\omega)\\, d\\omega}{\\displaystyle \\int_0^{\\infty} \\omega\\, T(\\omega)\\, d\\omega} = \\frac{I_{T, \\mathrm{tail}}}{I_T}\n$$\n分母 $I_T$ 是在步骤2中计算的归一化积分。分子 $I_{T, \\mathrm{tail}}$ 是一个新的从 $E_{\\max}$ 到 $\\infty$ 的反常积分，也通过数值方法计算。\n\n这个完整的流程被封装在一个程序中，该程序遍历所提供的测试用例，为每个用例计算数值对 $[F, M_{\\mathrm{tail}}]$，并将所有结果格式化为所需的单行输出。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import integrate\n\ndef solve():\n    \"\"\"\n    Solves the computational nuclear physics problem for a suite of test cases.\n    \"\"\"\n\n    # Physical constant provided in the problem statement\n    HBAR2_OVER_M_N = 41.47106  # MeV * fm^2\n\n    # Define the shape functions for the spectral strength distribution\n    def L_func(w, w0, Gamma, wcL):\n        \"\"\"\n        Modified Lorentzian shape function for the Giant Dipole Resonance.\n        \"\"\"\n        if w  0: return 0.0\n        lorentzian = (1.0 / np.pi) * Gamma / ((w - w0)**2 + Gamma**2)\n        cutoff = np.exp(-w / wcL)\n        return lorentzian * cutoff\n\n    def T_func(w, w0, alpha, wc):\n        \"\"\"\n        Power-law and exponential shape function for the continuum tail.\n        \"\"\"\n        if w = 0: return 0.0\n        ratio_term = (w / w0)**alpha\n        return (1.0 / w0) * ratio_term * np.exp(-w / wc)\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (N,   Z,  A,   w0,   Gamma, alpha, wc,   wcL,   kappa, fG,   Emax)\n        (126, 82, 208, 13.5, 3.8,  2.0,  50.0, 80.0,  0.20,  0.90, 100.0), # Case 1\n        (70,  50, 120, 15.5, 4.5,  2.5,  60.0, 90.0,  0.10,  0.85, 100.0), # Case 2\n        (8,   8,  16,  22.0, 7.5,  3.0,  70.0, 100.0, 0.00,  0.80, 100.0), # Case 3\n        (126, 82, 208, 13.5, 3.8,  2.0,  50.0, 80.0,  0.20,  0.90, 25.0),  # Case 4\n        (40,  28, 68,  17.0, 5.5,  1.0,  80.0, 120.0, 0.15,  0.70, 100.0)  # Case 5\n    ]\n\n    results = []\n    for case in test_cases:\n        N, Z, A, w0, Gamma, alpha, wc, wcL, kappa, fG, Emax = case\n\n        # Step 1: Compute the TRK sum rule value and the total enhanced sum rule\n        m1_trk = (9.0 / (8.0 * np.pi)) * HBAR2_OVER_M_N * (N * Z) / A\n        m1_tot = (1.0 + kappa) * m1_trk\n\n        # Step 2: Determine amplitudes A_G and A_T by computing normalization integrals\n        integrand_G_norm = lambda w: w * L_func(w, w0, Gamma, wcL)\n        integrand_T_norm = lambda w: w * T_func(w, w0, alpha, wc)\n\n        # Numerically integrate to get the normalization factors I_G and I_T\n        I_G, _ = integrate.quad(integrand_G_norm, 0, np.inf)\n        I_T, _ = integrate.quad(integrand_T_norm, 0, np.inf)\n        \n        A_G = (fG * m1_tot) / I_G\n        A_T = ((1.0 - fG) * m1_tot) / I_T\n\n        # Step 3: Evaluate the integrated strength m1(Emax)\n        def integrand_full_ew(w):\n            \"\"\"Integrand for the total energy-weighted strength.\"\"\"\n            gdr_part = A_G * L_func(w, w0, Gamma, wcL)\n            tail_part = A_T * T_func(w, w0, alpha, wc)\n            return w * (gdr_part + tail_part)\n        \n        m1_Emax, _ = integrate.quad(integrand_full_ew, 0, Emax)\n\n        # Step 4: Calculate the saturation fraction F\n        F = m1_Emax / m1_trk\n\n        # Step 5: Calculate the missing tail fraction M_tail\n        # The denominator I_T is already computed. Compute the numerator.\n        I_T_tail, _ = integrate.quad(integrand_T_norm, Emax, np.inf)\n        M_tail = I_T_tail / I_T\n\n        results.append([F, M_tail])\n\n    # Final print statement in the exact required format.\n    # The str() representation of a list of lists is almost correct, just remove spaces.\n    print(str(results).replace(\" \", \"\"))\n\nsolve()\n```"
        },
        {
            "introduction": "最后一个实践练习为了解集体激发的微观引擎——随机相近似 (Random Phase Approximation, RPA) ——提供了一个窗口。通过实现一个简化的RPA模型，你将进行一次计算实验，直接观察核相互作用中的时间奇数项对巨共振能量的影响。本练习阐明了自洽性和规范不变性的关键作用，展示了忽略特定的速度依赖相互作用如何导致非物理的结果，并强调了它们在精确描述核动力学中的重要性。",
            "id": "3549905",
            "problem": "您的任务是在一个示意性但有物理基础的随机相位近似 (RPA) 中，实现一个自洽线性响应计算，以量化在原子核能量密度泛函 (EDF) 中关闭选定的时间奇道对同位旋矢量巨偶极共振 (IVGDR) 和同位旋标量巨四极共振 (ISGQR) 重心能量的影响。程序必须是一个完整、可运行的 Python 脚本，使用第一性原理线性响应和单粒子-空穴集体模式近似。您的实现必须从一个 RPA 本征频率计算重心能量，分别在有和没有指定的时间奇流贡献的情况下进行计算，并返回因关闭指定时间奇道而引起的重心能量偏移。最终的数值答案必须以兆电子伏特 (MeV) 表示，并四舍五入到三位小数。\n\n从以下基本依据和定义开始：\n- 含时Hartree-Fock (TDHF) 线性化和运动方程方法得出了小振幅集体激发的 RPA 描述。在单集体模式近似中，RPA 本征频率 $\\,\\omega\\,$ 是该模式以能量单位（电子伏特）表示的重心能量，并满足一个由广义刚度（时间偶平均场和剩余相互作用）和动态自洽流耦合（时间奇剩余相互作用）决定的二次方程。\n- 正则对易关系和连续性方程施加了约束，将时间偶的速度相关项和时间奇的流项联系起来；这些约束体现了规范不变性。当时间奇贡献被不一致地关闭时，重心能量会偏离自洽值。\n\n使用的模型和量：\n- 考虑一个由质量数 $\\,A\\,$、质子数 $\\,Z\\,$ 和中子数 $\\,N\\,$ 表征的原子核。使用球形等效核半径 $\\,R = r_0 A^{1/3}\\,$，其中 $\\,r_0 = 1.2\\,\\mathrm{fm}\\,$。平均场为同位旋矢量偶极和同位旋标量四极道分别产生未微扰的粒子-空穴能量 $\\,\\varepsilon_{\\mathrm{IV}}\\,$ 和 $\\,\\varepsilon_{\\mathrm{IS}}\\,$（单位为 MeV）。\n- 在示意性 RPA 中使用了 EDF 剩余相互作用的两个道：\n  1. 时间偶道，耦合常数为 $\\,g^{\\mathrm{TE}}_{\\mathrm{IV}}\\,$ 和 $\\,g^{\\mathrm{TE}}_{\\mathrm{IS}}\\,$（单位为 $\\mathrm{MeV}\\cdot\\mathrm{fm}$）。\n  2. 时间奇道，耦合常数为 $\\,g^{\\mathrm{TO}}_{\\mathrm{IV}}\\,$ 和 $\\,g^{\\mathrm{TO}}_{\\mathrm{IS}}\\,$（单位为 $\\mathrm{MeV}\\cdot\\mathrm{fm}$）。\n- 对于每种模式 $\\,X\\in\\{\\mathrm{IV},\\mathrm{IS}\\}\\,$，定义一个无量纲归一化集体形状因子 $\\,s_X(A,Z,N)\\,$，它与相应的跃迁矩阵元和原子核尺寸成比例。为了在不同原子核间保持科学真实性和数值稳定性，使用以下归一化标度关系：\n  - 同位旋矢量偶极：$\\,s_{\\mathrm{IV}}(A,Z,N) = \\dfrac{\\sqrt{N Z / A}}{R}\\,$。\n  - 同位旋标量四极：$\\,s_{\\mathrm{IS}}(A) = \\dfrac{\\sqrt{A}}{R}\\,$。\n- 在单模式 RPA 中，广义刚度因时间偶剩余相互作用的贡献而增加，而动态耦合由时间奇流贡献提供。关闭选定的时间奇道意味着将相应的时间奇耦合设置为零，同时保持时间偶道不变。\n\n您的程序必须实现的计算步骤：\n1. 对于每个测试用例，使用上述公式计算半径 $\\,R\\,$ 以及形状因子 $\\,s_{\\mathrm{IV}}\\,$ 和 $\\,s_{\\mathrm{IS}}\\,$。\n2. 对于每种模式 $\\,X\\,$，构建示意性 RPA 矩阵，其特征为对角元 $\\,A_X = \\varepsilon_X + g^{\\mathrm{TE}}_X\\, s_X\\,$ 和非对角元 $\\,B_X = g^{\\mathrm{TO}}_X\\, s_X\\,$, 两者单位均为 $\\mathrm{MeV}$。\n3. 计算自洽重心能量（完整 EDF）$\\,E^{\\mathrm{full}}_X = \\sqrt{A_X^2 - B_X^2}\\,$，单位为 $\\mathrm{MeV}$。\n4. 计算关闭选定时间奇道后的重心能量 $\\,E^{\\mathrm{off}}_X = \\sqrt{A_X^2 - \\tilde{B}_X^2}\\,$, 其中如果模式 $\\,X\\,$ 的该道被关闭，则 $\\,\\tilde{B}_X = 0\\,$；否则 $\\,\\tilde{B}_X = B_X\\,$。\n5. 将影响量化为能量偏移 $\\,\\Delta E_X = E^{\\mathrm{off}}_X - E^{\\mathrm{full}}_X\\,$，单位为 $\\mathrm{MeV}$，四舍五入到三位小数。\n\n角度单位不适用。最终输出必须是单行，包含一个用方括号括起来的逗号分隔列表，其中包含每个测试用例的能量偏移，顺序如下文所述。所有能量都必须以 $\\mathrm{MeV}$ 表示。\n\n测试套件：\n- 使用以下四组参数。对于每个用例，最后两个布尔值条目分别指示同位旋矢量 (IV) 和同位旋标量 (IS) 模式中的时间奇道是否被关闭。条目为 $(A,Z,N,\\varepsilon_{\\mathrm{IV}},\\varepsilon_{\\mathrm{IS}},g^{\\mathrm{TE}}_{\\mathrm{IV}},g^{\\mathrm{TO}}_{\\mathrm{IV}},g^{\\mathrm{TE}}_{\\mathrm{IS}},g^{\\mathrm{TO}}_{\\mathrm{IS}},\\mathrm{off\\_IV},\\mathrm{off\\_IS})$。\n\n1. $(208,82,126,11.0,12.0,3.0,2.2,1.5,1.2,\\mathrm{True},\\mathrm{True})$\n2. $(120,50,70,10.8,11.6,2.8,2.0,1.3,1.1,\\mathrm{True},\\mathrm{False})$\n3. $(40,20,20,12.0,11.0,2.0,1.8,1.0,0.8,\\mathrm{True},\\mathrm{True})$\n4. $(208,82,126,11.0,12.0,3.0,3.8,1.5,2.5,\\mathrm{False},\\mathrm{True})$\n\n最终所需输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果。该列表必须按此确切顺序包含八个条目：$[\\Delta E_{\\mathrm{IV},1},\\Delta E_{\\mathrm{IS},1},\\Delta E_{\\mathrm{IV},2},\\Delta E_{\\mathrm{IS},2},\\Delta E_{\\mathrm{IV},3},\\Delta E_{\\mathrm{IS},3},\\Delta E_{\\mathrm{IV},4},\\Delta E_{\\mathrm{IS},4}]$，其中每个 $\\,\\Delta E\\,$ 的单位为 $\\mathrm{MeV}$，并四舍五入到三位小数。",
            "solution": "该问题是有效的，因为它在科学上基于原子核物理的随机相位近似 (RPA)，问题设定良好，具有完整的参数集和清晰明确的公式，并且在计算上是可行的。其目标是量化当原子核能量密度泛函的时间奇分量被人为移除时巨共振的能量偏移，这是理论核结构物理中评估特定相互作用项重要性的标准程序。\n\n解决方案首先基于所提供的示意性 RPA 模型建立理论框架，然后为每个测试用例实施计算步骤。\n\n集体激发模式 $X$ 的重心能量由 RPA 本征频率 $\\omega_X$ 给出，其中 $X$ 是同位旋矢量巨偶极共振 ($\\mathrm{IV}$) 或同位旋标量巨四极共振 ($\\mathrm{IS}$)。在单集体模式近似中，该能量计算如下：\n$$\nE_X = \\omega_X = \\sqrt{A_X^2 - B_X^2}\n$$\n其中所有能量均以兆电子伏特 ($\\mathrm{MeV}$) 为单位表示。$A_X$ 和 $B_X$ 项代表了粒子-空穴道中剩余相互作用的影响。\n\n对角元 $A_X$ 由未微扰的粒子-空穴能量 $\\varepsilon_X$ 和剩余相互作用的时间偶 (TE) 部分确定：\n$$\nA_X = \\varepsilon_X + g^{\\mathrm{TE}}_X s_X\n$$\n这里，$g^{\\mathrm{TE}}_X$ 是时间偶耦合常数（单位为 $\\mathrm{MeV}\\cdot\\mathrm{fm}$），$s_X$ 是一个无量纲归一化集体形状因子。在物理上，$A_X$ 对系统抵抗集体形变的整体刚度有贡献。\n\n非对角元 $B_X$ 源于剩余相互作用的时间奇 (TO) 部分，该部分与核流相关，并在 RPA 方程中提供动态耦合：\n$$\nB_X = g^{\\mathrm{TO}}_X s_X\n$$\n这里，$g^{\\mathrm{TO}}_X$ 是时间奇耦合常数（单位为 $\\mathrm{MeV}\\cdot\\mathrm{fm}$）。导致实值能量 $E_X$ 的稳定基态条件是 $A_X^2 \\ge B_X^2$。\n\n形状因子 $s_X$ 基于原子核性质计算：质量数 $A$、质子数 $Z$ 和中子数 $N$。首先使用液滴模型公式计算核半径 $R$：\n$$\nR = r_0 A^{1/3}, \\quad \\text{with } r_0 = 1.2\\,\\mathrm{fm}\n$$\n两种模式的形状因子则为：\n$$\ns_{\\mathrm{IV}}(A,Z,N) = \\frac{\\sqrt{N Z / A}}{R} \\quad (\\text{in fm}^{-1})\n$$\n$$\ns_{\\mathrm{IS}}(A) = \\frac{\\sqrt{A}}{R} \\quad (\\text{in fm}^{-1})\n$$\n\n问题要求计算当给定模式 $X$ 的时间奇道被关闭时，重心能量的偏移 $\\Delta E_X$。这是一个用于探究这些项物理影响的计算实验。\n\n在所有相互作用道都激活的情况下，自洽重心能量表示为 $E^{\\mathrm{full}}_X$：\n$$\nE^{\\mathrm{full}}_X = \\sqrt{A_X^2 - B_X^2}\n$$\n当模式 $X$ 的时间奇道被关闭时，相应的耦合常数 $g^{\\mathrm{TO}}_X$ 被设置为零。这导致一个修正的非对角元 $\\tilde{B}_X = 0$。新的重心能量 $E^{\\mathrm{off}}_X$ 为：\n$$\nE^{\\mathrm{off}}_X = \\sqrt{A_X^2 - \\tilde{B}_X^2}\n$$\n如果该道被关闭，则 $\\tilde{B}_X = 0$，能量简化为 $E^{\\mathrm{off}}_X = \\sqrt{A_X^2} = |A_X|$。由于参数的选择使得 $A_X  0$，这变为 $E^{\\mathrm{off}}_X = A_X$。如果该道未被关闭，则 $\\tilde{B}_X = B_X$，且 $E^{\\mathrm{off}}_X = E^{\\mathrm{full}}_X$。\n\n量化此修改影响的能量偏移定义为：\n$$\n\\Delta E_X = E^{\\mathrm{off}}_X - E^{\\mathrm{full}}_X\n$$\n如果时间奇道是激活的，则 $\\Delta E_X = 0$。如果它被关闭，偏移将是 $\\Delta E_X = A_X - \\sqrt{A_X^2 - B_X^2}$。\n\n每个测试用例的计算过程如下：\n1.  给定参数 $(A,Z,N,\\varepsilon_{\\mathrm{IV}},\\varepsilon_{\\mathrm{IS}},g^{\\mathrm{TE}}_{\\mathrm{IV}},g^{\\mathrm{TO}}_{\\mathrm{IV}},g^{\\mathrm{TE}}_{\\mathrm{IS}},g^{\\mathrm{TO}}_{\\mathrm{IS}},\\mathrm{off\\_IV},\\mathrm{off\\_IS})$。\n2.  计算核半径 $R$。\n3.  计算形状因子 $s_{\\mathrm{IV}}$ 和 $s_{\\mathrm{IS}}$。\n4.  对于同位旋矢量模式 ($\\mathrm{IV}$)：\n    a. 根据 $\\mathrm{off\\_IV}$ 标志确定时间奇道是否被关闭。\n    b. 如果未关闭，偏移 $\\Delta E_{\\mathrm{IV}}$ 为 $0$。\n    c. 如果已关闭，计算 $A_{\\mathrm{IV}} = \\varepsilon_{\\mathrm{IV}} + g^{\\mathrm{TE}}_{\\mathrm{IV}} s_{\\mathrm{IV}}$ 和 $B_{\\mathrm{IV}} = g^{\\mathrm{TO}}_{\\mathrm{IV}} s_{\\mathrm{IV}}$。\n    d. 计算偏移 $\\Delta E_{\\mathrm{IV}} = A_{\\mathrm{IV}} - \\sqrt{A_{\\mathrm{IV}}^2 - B_{\\mathrm{IV}}^2}$。\n5.  对于同位旋标量模式 ($\\mathrm{IS}$)：\n    a. 根据 $\\mathrm{off\\_IS}$ 标志确定时间奇道是否被关闭。\n    b. 如果未关闭，偏移 $\\Delta E_{\\mathrm{IS}}$ 为 $0$。\n    c. 如果已关闭，计算 $A_{\\mathrm{IS}} = \\varepsilon_{\\mathrm{IS}} + g^{\\mathrm{TE}}_{\\mathrm{IS}} s_{\\mathrm{IS}}$ 和 $B_{\\mathrm{IS}} = g^{\\mathrm{TO}}_{\\mathrm{IS}} s_{\\mathrm{IS}}$。\n    d. 计算偏移 $\\Delta E_{\\mathrm{IS}} = A_{\\mathrm{IS}} - \\sqrt{A_{\\mathrm{IS}}^2 - B_{\\mathrm{IS}}^2}$。\n6.  将最终的偏移 $\\Delta E_{\\mathrm{IV}}$ 和 $\\Delta E_{\\mathrm{IS}}$ 四舍五入到三位小数。\n7.  将所有测试用例的所有结果按指定顺序收集到一个列表中。\n\n这个结构化的过程在提供的 Python 脚本中实现，以求解给定的测试套件。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the centroid energy shifts for giant resonances based on a schematic\n    Random Phase Approximation (RPA) model.\n    \"\"\"\n\n    # Constant for nuclear radius calculation\n    r0 = 1.2  # in fm\n\n    # Test suite:\n    # (A, Z, N, eps_IV, eps_IS, g_TE_IV, g_TO_IV, g_TE_IS, g_TO_IS, off_IV, off_IS)\n    test_cases = [\n        (208, 82, 126, 11.0, 12.0, 3.0, 2.2, 1.5, 1.2, True, True),\n        (120, 50, 70, 10.8, 11.6, 2.8, 2.0, 1.3, 1.1, True, False),\n        (40, 20, 20, 12.0, 11.0, 2.0, 1.8, 1.0, 0.8, True, True),\n        (208, 82, 126, 11.0, 12.0, 3.0, 3.8, 1.5, 2.5, False, True),\n    ]\n\n    results = []\n\n    for case in test_cases:\n        A, Z, N, eps_iv, eps_is, g_te_iv, g_to_iv, g_te_is, g_to_is, off_iv, off_is = case\n\n        # Step 1: Compute the radius R\n        R = r0 * np.cbrt(A)\n\n        # --- Isovector Mode (IV) Calculation ---\n\n        if not off_iv:\n            delta_e_iv = 0.0\n        else:\n            # Step 2: Compute form factor s_IV\n            s_iv = np.sqrt(N * Z / A) / R\n\n            # Step 3: Build RPA matrix elements A_IV and B_IV\n            A_iv = eps_iv + g_te_iv * s_iv\n            B_iv = g_to_iv * s_iv\n\n            # Step 4  5: Compute energies and shift\n            # E_full = sqrt(A_iv^2 - B_iv^2)\n            # E_off = A_iv (since tilde_B_iv = 0 and A_iv > 0)\n            # Delta_E = E_off - E_full\n            if A_iv**2  B_iv**2:\n                # This case indicates an instability and should not occur with the given parameters\n                # but is handled for robustness.\n                delta_e_iv = np.nan\n            else:\n                e_full_iv = np.sqrt(A_iv**2 - B_iv**2)\n                e_off_iv = A_iv\n                delta_e_iv = e_off_iv - e_full_iv\n\n        # --- Isoscalar Mode (IS) Calculation ---\n\n        if not off_is:\n            delta_e_is = 0.0\n        else:\n            # Step 2: Compute form factor s_IS\n            s_is = np.sqrt(A) / R\n\n            # Step 3: Build RPA matrix elements A_IS and B_IS\n            A_is = eps_is + g_te_is * s_is\n            B_is = g_to_is * s_is\n\n            # Step 4  5: Compute energies and shift\n            if A_is**2  B_is**2:\n                delta_e_is = np.nan \n            else:\n                e_full_is = np.sqrt(A_is**2 - B_is**2)\n                e_off_is = A_is\n                delta_e_is = e_off_is - e_full_is\n        \n        # Round and append results as formatted strings\n        results.append(f\"{delta_e_iv:.3f}\")\n        results.append(f\"{delta_e_is:.3f}\")\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}