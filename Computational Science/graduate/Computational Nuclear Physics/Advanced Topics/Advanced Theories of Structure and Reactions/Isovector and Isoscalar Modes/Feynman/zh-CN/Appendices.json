{
    "hands_on_practices": [
        {
            "introduction": "核理论计算（如随机相位近似，RPA）通常会产生大量的离散激发态及其相应的跃迁强度。为了从这些详细的光谱信息中提取出简洁而富有物理意义的整体特性，我们计算强度函数的能量矩，即“求和规则”。本练习将指导您完成一个基本的数据处理任务：从给定的离散核激发谱中计算非能量加权 ($m_0$)、能量加权 ($m_1$) 和逆能量加权 ($m_{-1}$) 的求和规则，并由此确定质心能量等关键物理量 。",
            "id": "3566376",
            "problem": "考虑一个在用随机相位近似 (RPA) 处理的非相对论 Skyrme 能量密度泛函 (EDF) 框架中的同位旋标量单极算符 $F = \\sum_{i=1}^{A} r_i^2$。在线性响应理论中，激发谱由具有正能量 $E_n > 0$ 和跃迁强度 $B_n = \\left|\\langle n | F | 0 \\rangle \\right|^2$ 的分立 RPA 模式来表征。相关的强度函数为 $S_F(E) = \\sum_{n} B_n \\, \\delta(E - E_n)$，能量矩（求和规则）对任意实数 $k$ 定义为 $m_k = \\int_0^\\infty E^k \\, S_F(E) \\, dE$。非能量加权、能量加权和逆能量加权求和规则分别对应于 $m_0$、$m_1$ 和 $m_{-1}$。质心能量定义为 $E_c = m_1/m_0$，约束能量定义为 $E_{\\text{con}} = \\sqrt{m_1/m_{-1}}$。\n\n从上述强度函数和能量矩的基本定义出发，用有限组模式能量 $E_n$ 和强度 $B_n$ 推导出 $m_0$、$m_1$ 和 $m_{-1}$ 的离散表达式。然后实现一个算法，为几个测试用例计算 $m_0$、$m_1$、$m_{-1}$、质心能量 $E_c$ 和约束能量 $E_{\\text{con}}$。您的算法必须仅使用离散数据 $\\{(E_n, B_n)\\}$，并且不得假定任何特定于某个 Skyrme 参数化的闭合形式表达式。\n\n科学和数值要求：\n- 每个能量 $E_n$ 必须为严格正值，并以 $\\mathrm{MeV}$ 为单位。\n- 每个强度 $B_n$ 必须为非负值，并以 $\\mathrm{fm}^4$ 为单位。\n- 求和规则的单位为：$m_0$ 的单位是 $\\mathrm{fm}^4$，$m_1$ 的单位是 $\\mathrm{MeV}\\cdot\\mathrm{fm}^4$，$m_{-1}$ 的单位是 $\\mathrm{fm}^4/\\mathrm{MeV}$。\n- 质心能量 $E_c$ 和约束能量 $E_{\\text{con}}$ 必须以 $\\mathrm{MeV}$ 为单位。\n- 所有输出必须四舍五入到六位小数。\n\n测试套件：\n- 案例 $1$ (重核中典型的多峰巨单极共振): $E = [10.5, 13.8, 15.6]$ $\\mathrm{MeV}$, $B = [200.0, 600.0, 250.0]$ $\\mathrm{fm}^4$。\n- 案例 $2$ (单个尖锐模式): $E = [14.0]$ $\\mathrm{MeV}$, $B = [1000.0]$ $\\mathrm{fm}^4$。\n- 案例 $3$ (与低能态的混合): $E = [0.5, 17.0, 22.0]$ $\\mathrm{MeV}$, $B = [1.0, 800.0, 150.0]$ $\\mathrm{fm}^4$。\n- 案例 $4$ (用于测试数值稳定性的较小强度): $E = [12.345, 23.456, 34.567]$ $\\mathrm{MeV}$, $B = [0.001, 0.002, 0.003]$ $\\mathrm{fm}^4$。\n\n您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表形式的结果，每个测试用例对应一个内部列表，格式为 $[m_0, m_1, m_{-1}, E_c, E_{\\text{con}}]$，使用指定的单位并四舍五入到六位小数。例如，总输出应类似于 $[[x_{11},x_{12},x_{13},x_{14},x_{15}],[x_{21},x_{22},x_{23},x_{24},x_{25}],\\dots]$，不含任何额外文本。",
            "solution": "问题陈述的评估如下。\n\n### 步骤 1：提取已知条件\n- **算符**：同位旋标量单极算符 $F = \\sum_{i=1}^{A} r_i^2$。\n- **框架**：采用随机相位近似 (RPA) 的非相对论 Skyrme 能量密度泛函 (EDF)。\n- **激发谱**：具有能量 $E_n > 0$ 和跃迁强度 $B_n = \\left|\\langle n | F | 0 \\rangle \\right|^2$ 的分立 RPA 模式。\n- **强度函数**：$S_F(E) = \\sum_{n} B_n \\, \\delta(E - E_n)$。\n- **能量矩 (求和规则)**：$m_k = \\int_0^\\infty E^k \\, S_F(E) \\, dE$ 对任意实数 $k$ 成立。\n- **特定矩**：$m_0$ (非能量加权)，$m_1$ (能量加权)，$m_{-1}$ (逆能量加权)。\n- **派生量**：质心能量 $E_c = m_1/m_0$，约束能量 $E_{\\text{con}} = \\sqrt{m_1/m_{-1}}$。\n- **任务**：从有限模式集 $\\{(E_n, B_n)\\}$ 推导 $m_0$、$m_1$、$m_{-1}$ 的离散表达式。实现一个算法来计算 $m_0$、$m_1$、$m_{-1}$、$E_c$ 和 $E_{\\text{con}}$。\n- **数值要求**：\n    - $E_n > 0$，单位为 $\\mathrm{MeV}$。\n    - $B_n \\ge 0$，单位为 $\\mathrm{fm}^4$。\n    - $m_0$ 的单位：$\\mathrm{fm}^4$。\n    - $m_1$ 的单位：$\\mathrm{MeV}\\cdot\\mathrm{fm}^4$。\n    - $m_{-1}$ 的单位：$\\mathrm{fm}^4/\\mathrm{MeV}$。\n    - $E_c$、$E_{\\text{con}}$ 的单位：$\\mathrm{MeV}$。\n    - 输出必须四舍五入到六位小数。\n- **测试套件**：\n    - 案例 1：$E = [10.5, 13.8, 15.6]$ $\\mathrm{MeV}$, $B = [200.0, 600.0, 250.0]$ $\\mathrm{fm}^4$。\n    - 案例 2：$E = [14.0]$ $\\mathrm{MeV}$, $B = [1000.0]$ $\\mathrm{fm}^4$。\n    - 案例 3：$E = [0.5, 17.0, 22.0]$ $\\mathrm{MeV}$, $B = [1.0, 800.0, 150.0]$ $\\mathrm{fm}^4$。\n    - 案例 4：$E = [12.345, 23.456, 34.567]$ $\\mathrm{MeV}$, $B = [0.001, 0.002, 0.003]$ $\\mathrm{fm}^4$。\n\n### 步骤 2：使用提取的已知条件进行验证\n1.  **有科学依据**：该问题植根于标准的核结构理论。同位旋标量单极算符、强度函数、RPA 和求和规则的定义在核巨共振的背景下都是标准且正确的。所涉及物理量的单位也是正确的。\n2.  **适定的**：问题定义清晰。它要求从连续定义推导离散公式，并将其应用于特定的数值数据。输入数据是有限的分立模式集合 $\\{(E_n, B_n)\\}$，而所需的输出（$m_0, m_1, m_{-1}, E_c, E_{\\text{con}}$）由这些输入和所提供的定义唯一确定。约束条件 $E_n > 0$ 和 $B_n \\ge 0$ 确保了这些物理量是适定且具有物理意义的。\n3.  **客观的**：问题以精确、正式的语言陈述，没有任何主观性或歧义。\n4.  **无其他缺陷**：问题是可形式化的、自洽的，并且测试数据在物理上是合理的。它要求应用基本定义，这在计算背景下是一项有效且不平凡的任务。\n\n### 步骤 3：结论与行动\n该问题有效。将提供完整的解决方案。\n\n### 推导与算法设计\n\n起点是强度函数 $S_F(E)$ 的 $k$ 阶能量矩的定义：\n$$\nm_k = \\int_0^\\infty E^k \\, S_F(E) \\, dE\n$$\n对于离散谱，强度函数由关于 Dirac delta 函数的求和给出：\n$$\nS_F(E) = \\sum_{n=1}^{N} B_n \\, \\delta(E - E_n)\n$$\n其中 $N$ 是分立模式的有限数量，$E_n$ 是第 $n$ 个模式的能量，$B_n$ 是其跃迁强度。\n\n通过将 $S_F(E)$ 的表达式代入 $m_k$ 的积分中，我们得到：\n$$\nm_k = \\int_0^\\infty E^k \\left( \\sum_{n=1}^{N} B_n \\, \\delta(E - E_n) \\right) dE\n$$\n由于求和是针对有限数量的模式，我们可以交换求和与积分的顺序：\n$$\nm_k = \\sum_{n=1}^{N} B_n \\int_0^\\infty E^k \\, \\delta(E - E_n) \\, dE\n$$\n使用 Dirac delta 函数的筛选性质，即 $\\int f(x) \\delta(x-a) dx = f(a)$，该积分的计算结果为 $E_n^k$。条件 $E_n > 0$ 确保积分域 $[0, \\infty)$ 包含所有模式能量。\n因此，$k$ 阶矩的离散公式为：\n$$\nm_k = \\sum_{n=1}^{N} B_n E_n^k\n$$\n\n从这个通用结果，我们可以推导出所需特定矩的表达式：\n1.  **非能量加权求和规则 ($m_0$)**：对于 $k=0$，我们有 $E_n^0 = 1$。\n    $$\n    m_0 = \\sum_{n=1}^{N} B_n E_n^0 = \\sum_{n=1}^{N} B_n\n    $$\n2.  **能量加权求和规则 ($m_1$)**：对于 $k=1$，我们有 $E_n^1 = E_n$。\n    $$\n    m_1 = \\sum_{n=1}^{N} B_n E_n^1 = \\sum_{n=1}^{N} B_n E_n\n    $$\n3.  **逆能量加权求和规则 ($m_{-1}$)**：对于 $k=-1$，我们有 $E_n^{-1} = 1/E_n$。\n    $$\n    m_{-1} = \\sum_{n=1}^{N} B_n E_n^{-1} = \\sum_{n=1}^{N} \\frac{B_n}{E_n}\n    $$\n    该表达式是适定的，因为问题规定所有模式能量 $E_n$ 都是严格为正的 ($E_n > 0$)。\n\n接下来，我们使用质心能量和约束能量的定义来推导它们的离散表达式。\n1.  **质心能量 ($E_c$)**：\n    $$\n    E_c = \\frac{m_1}{m_0} = \\frac{\\sum_{n=1}^{N} B_n E_n}{\\sum_{n=1}^{N} B_n}\n    $$\n    对于给定的测试用例，强度 $B_n$ 是非负的且不全为零，因此分母 $m_0$ 是严格为正的。\n2.  **约束能量 ($E_{\\text{con}}$)**：\n    $$\n    E_{\\text{con}} = \\sqrt{\\frac{m_1}{m_{-1}}} = \\sqrt{\\frac{\\sum_{n=1}^{N} B_n E_n}{\\sum_{n=1}^{N} \\frac{B_n}{E_n}}}\n    $$\n    由于 $B_n \\ge 0$ 且 $E_n > 0$，分子 $m_1$ 和分母 $m_{-1}$ 都是非负的。对于任何非平凡谱（其中至少有一个 $B_n > 0$），两者都将是严格为正的，从而确保平方根的参数是适定且为正的。\n\n### 计算算法\n该算法将按如下方式处理每个测试用例：\n1.  输入：模式能量列表 $E = [E_1, E_2, \\dots, E_N]$ 和对应的跃迁强度列表 $B = [B_1, B_2, \\dots, B_N]$。\n2.  将三个变量初始化为 $0.0$：`sum_m0`、`sum_m1`、`sum_m_minus_1`。\n3.  从 $n=1$ 迭代到 $N$：\n    a. 设 $E_n$ 为当前模式的能量，$B_n$ 为其强度。\n    b. 通过加上 $B_n$ 来更新 `sum_m0`。\n    c. 通过加上 $B_n \\times E_n$ 来更新 `sum_m1`。\n    d. 通过加上 $B_n / E_n$ 来更新 `sum_m_minus_1`。\n4.  循环结束后，这些变量保存了矩的值：$m_0 = \\text{sum\\_m0}$，$m_1 = \\text{sum\\_m1}$ 和 $m_{-1} = \\text{sum\\_m\\_minus\\_1}$。\n5.  计算质心能量：$E_c = m_1 / m_0$。\n6.  计算约束能量：$E_{\\text{con}} = \\sqrt{m_1 / m_{-1}}$。\n7.  收集五个结果：$[m_0, m_1, m_{-1}, E_c, E_{\\text{con}}]$。\n8.  将这五个值分别四舍五入到六位小数。\n9.  存储四舍五入后的结果。\n10. 对所有测试用例重复此过程，并将最终输出格式化为列表的列表。\n使用像 NumPy 这样的库进行向量化计算对于此任务非常高效。能量数组 $E$ 和强度数组 $B$ 允许通过逐元素操作和最终的求和归约来计算总和。\n- $m_0 = \\text{sum}(B)$\n- $m_1 = \\text{sum}(E \\times B)$\n- $m_{-1} = \\text{sum}(B / E)$\n这种方法将在最终代码中实现。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nimport math\n\ndef solve():\n    \"\"\"\n    Computes sum rules and derived energies for nuclear excitation spectra.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (typical multi-peak giant monopole resonance)\n        {'E': [10.5, 13.8, 15.6], 'B': [200.0, 600.0, 250.0]},\n        # Case 2 (single sharp mode)\n        {'E': [14.0], 'B': [1000.0]},\n        # Case 3 (mixture with a low-energy state)\n        {'E': [0.5, 17.0, 22.0], 'B': [1.0, 800.0, 150.0]},\n        # Case 4 (small strengths)\n        {'E': [12.345, 23.456, 34.567], 'B': [0.001, 0.002, 0.003]},\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        # Convert lists to NumPy arrays for vectorized calculations\n        E = np.array(case['E'])\n        B = np.array(case['B'])\n\n        # Calculate the moments m_0, m_1, and m_{-1}\n        # m_k = sum(B_n * E_n^k)\n        \n        # k = 0: m_0 = sum(B_n)\n        m0 = np.sum(B)\n        \n        # k = 1: m_1 = sum(B_n * E_n)\n        m1 = np.sum(B * E)\n        \n        # k = -1: m_{-1} = sum(B_n / E_n)\n        # The problem guarantees E_n > 0, so no division by zero.\n        m_minus_1 = np.sum(B / E)\n        \n        # Check for m0 being zero to avoid division by zero for Ec.\n        # Although not expected from the problem's test data.\n        if m0 == 0:\n            # If total strength is zero, all strengths are zero, so m1 is also zero.\n            # Ec is indeterminate (0/0), but 0 is a reasonable assignment.\n            Ec = 0.0\n        else:\n            # Centroid energy: Ec = m_1 / m_0\n            Ec = m1 / m0\n\n        # Check for m_minus_1 being zero for Econ.\n        if m_minus_1 == 0:\n            # If m_minus_1 is 0, m1 must also be 0.\n            # Econ is indeterminate, assigned 0.\n            Econ = 0.0\n        else:\n            # Constrained energy: Econ = sqrt(m_1 / m_{-1})\n            # The argument to sqrt is non-negative as m1 and m_minus_1 are sums\n            # of products/ratios of non-negative numbers.\n            Econ = math.sqrt(m1 / m_minus_1)\n        \n        # Round all results to six decimal places\n        case_results = [\n            round(m0, 6),\n            round(m1, 6),\n            round(m_minus_1, 6),\n            round(Ec, 6),\n            round(Econ, 6)\n        ]\n        \n        results.append(case_results)\n\n    # Format the final output string as a list of lists without spaces.\n    # The default string representation of a list of lists is '[[], [], ...]',\n    # but it includes spaces. We remove them for the exact format.\n    output_str = str(results).replace(\" \", \"\")\n    \n    # Final print statement in the exact required format.\n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "在多体计算中，一个核心挑战是确保我们的数值模型能遵守系统的基本对称性，例如平移不变性。当离散化或其他近似破坏了这种连续对称性时，模型的光谱中就会出现非物理的“赝模”（spurious modes），例如对应于原子核整体平移的零能戈德斯通模被人为地赋予了非零能量。本练习通过一个简化的可解模型，让您亲手验证随着数值精度的提高，这种对称性破缺和相关的赝模效应是如何被系统性地抑制的 。",
            "id": "3566318",
            "problem": "考虑在长波流体动力学极限下，一个均匀、自束缚的核滴的小振幅、一维、等标量压缩振荡。该模型由区间 $ x \\in [0,1] $ 上的线性波动方程 $ \\rho \\,\\partial_t^2 u(x,t) = C \\,\\partial_x^2 u(x,t) $ 描述，其中 $ \\rho $ 是一个恒定的质量密度，$ C $ 是一个恒定的压缩模量，$ u(x,t) $ 是位移场。自由表面边界条件要求应力为零，在此模型中意味着 $ \\partial_x u(0,t) = \\partial_x u(1,t) = 0 $。平移不变性保证了一个本征频率为 $ \\omega = 0 $ 的戈德斯通模 $ u(x,t) = \\text{constant} $，并且等标量电偶极 ($ E1 $) 强度应该被这个赝平移模完全耗尽，使得在非零频率处没有强度。\n\n您将通过一个包含消失边界微扰的受控离散化方法，来验证对精确平移不变性的趋近。将区间离散为 $ N $ 个均匀间隔的格点，索引为 $ i = 0,1,\\ldots,N-1 $，并用内部的对称三点模板和边界处的单侧条件来近似空间二阶导数。令离散刚度矩阵 $ K \\in \\mathbb{R}^{N \\times N} $ 表示作用在位移向量 $ \\mathbf{u} \\in \\mathbb{R}^N $ 上的离散算子。使用以下构造方法：\n- 对于内部索引 $ i = 1,2,\\ldots,N-2 $，设置 $ K_{i,i} = 2 $，$ K_{i,i-1} = -1 $ 和 $ K_{i,i+1} = -1 $。\n- 对于左边界，设置 $ K_{0,0} = 1 + \\varepsilon(N) $ 和 $ K_{0,1} = -1 $。\n- 对于右边界，设置 $ K_{N-1,N-1} = 1 + \\varepsilon(N) $ 和 $ K_{N-1,N-2} = -1 $。\n- 所有其他条目均为零。\n\n微扰 $ \\varepsilon(N) $ 是一个小的、依赖于 $ N $ 的边界项，用于模拟随着数值精度提高而消失的精确平移不变性的残余数值违反。对于此问题，取 $ \\varepsilon(N) = N^{-2} $。在无量纲单位下工作，其中 $ \\rho = 1 $ 和 $ C = 1 $，因此离散广义本征问题简化为标准对称本征值问题 $ K \\mathbf{v}_\\nu = \\omega_\\nu^2 \\,\\mathbf{v}_\\nu $，质量矩阵等于单位矩阵。离散等标量 $ E1 $ 算子（忽略一个不相关的乘法常数）由向量 $ \\mathbf{f} = (1,1,\\ldots,1)^\\top \\in \\mathbb{R}^N $ 表示，该向量测量等标量通道中的质心位移。\n\n您的任务是：\n1. 对于每个指定的 $ N $，按上述方法构造 $ K(N) $ 并求解 $ K \\mathbf{v}_\\nu = \\omega_\\nu^2 \\,\\mathbf{v}_\\nu $，以获得本征频率 $ \\omega_\\nu \\ge 0 $ 和在 $ \\mathbb{R}^N $ 中使用标准欧几里得内积的标准正交本征向量 $ \\mathbf{v}_\\nu $。\n2. 识别最小的本征频率 $ \\omega_0(N) = \\min_\\nu \\omega_\\nu $，它对应于赝平移模。将 $ \\omega_0(N) $ 作为浮点数报告。\n3. 量化等标量 $ E1 $ 强度泄漏到非零频率模中的程度。定义一个本征模 $ \\nu $ 携带的总等标量振幅为 $ A_\\nu = \\mathbf{v}_\\nu \\cdot \\mathbf{f} $。根据完备性，总离散等标量 $ E1 $ 强度与 $ \\sum_\\nu A_\\nu^2 = \\lVert \\mathbf{f} \\rVert^2 = N $ 成正比。因此，泄漏到非零模中的强度为 $ S_{\\text{leak}}(N) = \\frac{1}{N} \\sum_{\\nu:\\,\\omega_\\nu > 0} A_\\nu^2 = 1 - \\frac{A_0^2}{N} $，其中 $ A_0 $ 是最低频率模上的振幅。将 $ S_{\\text{leak}}(N) $ 作为浮点数报告。如果平移不变性得到恢复，那么随着 $ N $ 的增加，$ \\omega_0(N) $ 和 $ S_{\\text{leak}}(N) $ 都应趋近于 $ 0 $。\n\n数值细节：\n- 使用双精度线性代数，并根据欧几里得范数对本征向量进行标准正交化。需要按非递减的 $ \\omega_\\nu^2 $ 对本征对进行排序以识别 $ \\omega_0(N) $。\n- 为确保不同 $ N $ 之间的一致比较，请将 $ \\omega_0(N) $ 和 $ S_{\\text{leak}}(N) $ 四舍五入到八位小数。\n\n测试套件：\n- 使用以下 $ N $ 值：$ N \\in \\{8,16,32,64,128\\} $。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个逗号分隔的对列表形式的结果，每个测试用例一对，不含空格。每对必须是 $ [\\omega_0(N),S_{\\text{leak}}(N)] $ 的形式，两个数字都四舍五入到八位小数。整个输出必须用方括号括起来。例如，预期的格式是 $ [[a_1,b_1],[a_2,b_2],\\ldots] $，行中任何地方都没有空格。\n\n此问题中所有量均为无量纲。答案必须按指定以无量纲单位表示，每个浮点数四舍五入到八位小数。最终输出必须与上述格式完全匹配。",
            "solution": "### 第 1 步：提取已知条件\n问题提供了以下信息：\n- **控制方程**：$ \\rho \\,\\partial_t^2 u(x,t) = C \\,\\partial_x^2 u(x,t) $，适用于 $x \\in [0,1]$。\n- **物理常数**：质量密度 $ \\rho = 1 $，压缩模量 $ C = 1 $（无量纲单位）。\n- **边界条件**：自由表面、零应力边界条件 $ \\partial_x u(0,t) = \\partial_x u(1,t) = 0 $。\n- **离散化**：区间被离散为 $ N $ 个点，索引为 $ i = 0,1,\\ldots,N-1 $。\n- **刚度矩阵 $K$**：一个 $ N \\times N $ 的矩阵，由其非零元素定义：\n    - 对于内部索引 $ i \\in \\{1,2,\\ldots,N-2\\} $：$ K_{i,i} = 2 $，$ K_{i,i-1} = -1 $，$ K_{i,i+1} = -1 $。\n    - 对于左边界 ($ i=0 $): $ K_{0,0} = 1 + \\varepsilon(N) $，$ K_{0,1} = -1 $。\n    - 对于右边界 ($ i=N-1 $): $ K_{N-1,N-1} = 1 + \\varepsilon(N) $，$ K_{N-1,N-2} = -1 $。\n- **边界微扰**：$ \\varepsilon(N) = N^{-2} $。\n- **本征问题**：$ K \\mathbf{v}_\\nu = \\omega_\\nu^2 \\,\\mathbf{v}_\\nu $，其中 $ \\mathbf{v}_\\nu $ 是标准正交本征向量，$ \\omega_\\nu \\ge 0 $ 是本征频率。\n- **等标量 E1 算子**：由向量 $ \\mathbf{f} = (1,1,\\ldots,1)^\\top \\in \\mathbb{R}^N $ 表示。\n- **待计算量**：\n    1.  最小本征频率，$ \\omega_0(N) = \\min_\\nu \\omega_\\nu $。\n    2.  等标量 $ E1 $ 强度的泄漏，$ S_{\\text{leak}}(N) = 1 - \\frac{A_0^2}{N} $，其中 $ A_\\nu = \\mathbf{v}_\\nu \\cdot \\mathbf{f} $，$ A_0 $ 对应于频率为 $ \\omega_0(N) $ 的模式。\n- **数值细节**：使用双精度浮点算术。本征对按非递减的 $ \\omega_\\nu^2 $ 排序。结果 $ \\omega_0(N) $ 和 $ S_{\\text{leak}}(N) $ 必须四舍五入到八位小数。\n- **测试套件**：$ N \\in \\{8, 16, 32, 64, 128\\} $。\n- **输出格式**：单行逗号分隔的 $ [\\omega_0(N),S_{\\text{leak}}(N)] $ 对列表，用外方括号括起来，不含空格。例如：$ [[a_1,b_1],[a_2,b_2]] $。\n\n### 第 2 步：使用提取的已知条件进行验证\n根据提取的已知条件对问题进行严格审查。\n- **科学基础扎实**：该问题使用了一个简化但物理学中标准的模型——流体动力学极限下的线性波动方程。本征模、由连续对称性破缺（平移不变性）产生的戈德斯通模以及强度函数等概念是多体物理学（包括核物理）的基石。离散化方案是一种标准的有限差分方法。该公式在科学上是合理的。\n- **适定的**：核心任务是构造一个特定的、明确定义的实对称矩阵 $ K $，并计算其本征值和本征向量。这是数值线性代数中一个适定的问题。$ K $ 的对称性保证了实数本征值和一组完备的标准正交本征向量，确保了数值部分存在唯一且稳定的解。\n- **客观的**：问题以精确的数学和算法术语陈述。所有量（$ K, \\varepsilon(N), \\mathbf{f}, \\omega_0, S_{\\text{leak}} $）都有明确的定义。任务是客观且可验证的。\n- **完备性与一致性**：问题提供了构建矩阵 $ K $、定义算子 $ \\mathbf{f} $ 以及计算所需量 $ \\omega_0(N) $ 和 $ S_{\\text{leak}}(N) $ 的所有必要信息。测试套件的参数已明确列出。没有内部矛盾。\n- **现实性**：该模型是一个简化模型，但分析离散模型如何近似连续对称性的数值任务是计算物理学中一个常见且现实的问题。\n\n### 第 3 步：结论与行动\n该问题科学基础扎实、适定、客观且自洽。未检测到任何缺陷。因此，该问题被判定为**有效**。我们继续进行求解。\n\n### 基于原理的设计\n该问题要求对一个离散化的一维波动方程进行数值分析，该方程模拟了一个简化的核滴中的振荡。重点是最低频率模式的属性，该模式对应于连续系统的平移戈德斯通模。\n\n离散位移向量 $ \\mathbf{u}(t) \\in \\mathbb{R}^N $ 的运动方程是 $ \\partial_t^2 \\mathbf{u}(t) = -K \\mathbf{u}(t) $，假设单位质量矩阵如题所述。寻求 $ \\mathbf{u}(t) = \\mathbf{v} e^{-i\\omega t} $ 形式的简正模解，可得到标准对称本征值问题 $ K \\mathbf{v} = \\omega^2 \\mathbf{v} $。\n\n刚度矩阵 $ K \\in \\mathbb{R}^{N \\times N} $ 是负二阶空间导数算子 $ -\\partial_x^2 $ 在特定边界条件下的离散表示。对于给定的网格大小 $ N $，其构造遵循所提供的规则。该矩阵是实对称的，这是一个关键属性。这保证了其本征值 $ \\lambda_\\nu = \\omega_\\nu^2 $ 是实数且非负的（因为 $ K $ 是半正定的，并且通过 $ \\varepsilon > 0 $ 的微扰使其变为正定），并且其本征向量 $ \\mathbf{v}_\\nu $ 构成 $ \\mathbb{R}^N $ 的一个标准正交基。\n\n对于测试套件中的每个 $ N $ 值，算法如下：\n1.  **构造矩阵 $ K(N) $**：初始化一个 $ N \\times N $ 的矩阵。主对角线设置为 $ 2 $，第一副对角线设置为 $ -1 $，这代表了二阶导数的标准三点有限差分模板。然后根据给定规则调整边界元素：$ K_{0,0} $ 和 $ K_{N-1, N-1} $ 设置为 $ 1 + \\varepsilon(N) $，其中 $ \\varepsilon(N) = N^{-2} $。\n\n2.  **求解本征问题**：数值求解本征值问题 $ K \\mathbf{v}_\\nu = \\omega_\\nu^2 \\mathbf{v}_\\nu $。使用一个鲁棒的方法来完成此任务，例如 `numpy.linalg.eigh` 中实现的方法。该函数非常理想，因为它针对对称矩阵进行了优化，并返回按非递减顺序排序的本征值以及作为矩阵列的相应标准正交本征向量。\n\n3.  **计算 $ \\omega_0(N) $**：返回的最小本征值是 $ \\lambda_0 = \\omega_0^2 $。然后计算最低本征频率为 $ \\omega_0(N) = \\sqrt{\\lambda_0} $。相应的本征向量 $ \\mathbf{v}_0 $ 是求解器返回的本征向量矩阵的第一列。\n\n4.  **计算 $ S_{\\text{leak}}(N) $**：量化等标量 $ E1 $ 强度泄漏到非赝模中的程度。\n    - 离散等标量算子由 $ \\mathbf{f} = (1,1,\\ldots,1)^\\top $ 给出。\n    - 通过将 $ \\mathbf{f} $ 投影到相应的本征向量上，计算最低模式的振幅：$ A_0 = \\mathbf{v}_0 \\cdot \\mathbf{f} $。\n    - 然后使用给定的公式计算泄漏：$ S_{\\text{leak}}(N) = 1 - \\frac{A_0^2}{N} $。\n\n量 $ \\omega_0(N) $ 和 $ S_{\\text{leak}}(N) $ 衡量了离散化和显式边界微扰 $ \\varepsilon(N) $ 破坏平移对称性的程度。在完美连续统的极限下或对于 $ \\varepsilon=0 $，人们会发现 $ \\omega_0 = 0 $ 和 $ S_{\\text{leak}} = 0 $。数值计算将展示随着 $ N $ 增加，系统向此理想极限收敛的情况。最终结果按规定格式化为八位小数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the numerical problem for a series of grid sizes N.\n    For each N, it constructs the stiffness matrix K, solves the eigenproblem,\n    and calculates the lowest eigenfrequency and the E1 strength leakage.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [8, 16, 32, 64, 128]\n\n    # List to store the results for each test case.\n    results = []\n\n    for N in test_cases:\n        # Define the boundary perturbation.\n        epsilon = float(N)**-2\n\n        # Construct the stiffness matrix K.\n        # Initialize with the standard 3-point stencil for the 2nd derivative.\n        K = (np.diag(2 * np.ones(N), 0) -\n             np.diag(np.ones(N - 1), 1) -\n             np.diag(np.ones(N - 1), -1))\n\n        # Apply the boundary conditions and the epsilon perturbation.\n        K[0, 0] = 1.0 + epsilon\n        K[N - 1, N - 1] = 1.0 + epsilon\n\n        # Solve the symmetric eigenvalue problem K*v = (w^2)*v.\n        # numpy.linalg.eigh is suitable for symmetric matrices and returns\n        # sorted eigenvalues and orthonormal eigenvectors.\n        eigenvalues_sq, eigenvectors = np.linalg.eigh(K)\n\n        # The smallest eigenvalue corresponds to omega_0^2.\n        omega_0_sq = eigenvalues_sq[0]\n        # The eigenfrequency is the square root. The eigenvalue is non-negative.\n        omega_0 = np.sqrt(omega_0_sq)\n\n        # The corresponding eigenvector v_0 is the first column.\n        v_0 = eigenvectors[:, 0]\n\n        # Define the discrete isoscalar E1 operator f.\n        f = np.ones(N)\n\n        # Calculate the amplitude A_0 on the lowest-frequency mode.\n        A_0 = np.dot(v_0, f)\n        \n        # Calculate the leakage of E1 strength into nonzero-frequency modes.\n        # The total strength is norm(f)^2 = N.\n        S_leak = 1.0 - (A_0**2) / N\n\n        # Store the calculated pair of values.\n        results.append((omega_0, S_leak))\n\n    # Format the final output string exactly as specified.\n    # Each number is rounded to eight decimal places.\n    # The output is a list of pairs, with no spaces.\n    # e.g., [[val1,val2],[val3,val4]]\n    pair_strings = [f\"[{w:.8f},{s:.8f}]\" for w, s in results]\n    final_output = f\"[{','.join(pair_strings)}]\"\n    \n    # Final print statement in the exact required format.\n    print(final_output)\n\nsolve()\n\n```"
        },
        {
            "introduction": "掌握了分析和验证光谱的基本技能后，我们现在可以将其应用于一个更高级的研究场景：通过模型间的比较来诊断物理效应。本练习将指导您区分电偶极 ($E1$) 响应中的同位旋标量 (isoscalar) 和同位旋矢量 (isovector) 成分，并比较一个“第一性原理”(ab initio) 计算和一个简化的能量密度泛函 (EDF) 模型的预测。通过精心设计的数值实验，您将学习如何识别出由于 EDF 模型中缺少关键的同位旋矢量三体力等物理成分而导致的特定偏差 。",
            "id": "3566329",
            "problem": "您的任务是设计并实现一个数值程序，该程序使用简化的线性响应框架来模拟中等质量核中的电偶极（$E1$）响应，区分同位旋矢量和同位旋标量模式，并比较基于手征有效场论（EFT）相互作用的从头耦合簇（CC）计算与能量密度泛函（EDF）计算得到的强度。目标是通过分析相对积分 $E1$ 强度，识别出与 EDF 中缺失的同位旋矢量三体力贡献相符的缺陷。\n\n从以下基本依据和定义开始：\n\n- 在线性响应区域内，对于一个由基态 $\\lvert \\Psi_0 \\rangle$ 和位于激发能 $\\{ \\omega_k \\}$ 的离散激发态 $\\{ \\lvert \\Psi_k \\rangle \\}$ 所描述的原子核，算符 $\\hat{O}$ 的强度函数为\n$$\nS_{\\hat{O}}(\\omega) = \\sum_{k} \\left| \\langle \\Psi_0 \\lvert \\hat{O} \\rvert \\Psi_k \\rangle \\right|^2 \\, \\delta(\\omega - \\omega_k).\n$$\n在宽度为 $\\Gamma$ 的洛伦兹展宽下，狄拉克 $\\delta$ 函数被替换为\n$$\nL(\\omega; \\omega_k, \\Gamma) = \\frac{1}{\\pi}\\frac{\\Gamma}{(\\omega-\\omega_k)^2 + \\Gamma^2},\n$$\n并且在所有 $\\omega$ 上的能量积分强度保持为\n$$\n\\int_{0}^{\\infty} S_{\\hat{O}}(\\omega)\\, d\\omega = \\sum_{k} \\left| \\langle \\Psi_0 \\lvert \\hat{O} \\rvert \\Psi_k \\rangle \\right|^2,\n$$\n与 $\\Gamma$ 无关。\n\n- 考虑通过质子 ($p$) 和中子 ($n$) 的贡献分解为同位旋矢量和同位旋标量模式的电偶极 ($E1$) 算符。设 $Z$ 为质子数，$N$ 为中子数，$A = Z + N$ 为质量数。对于每个分立模式 $k$，为您提供了经过质心修正的有效质子和中子偶极振幅积分 $D_{p,k}$ 和 $D_{n,k}$，单位为飞米（$\\mathrm{fm}$）。在这个简化模型中，同位旋矢量 $E1$ 矩阵元定义为\n$$\nM_{\\mathrm{IV},k} = e_p^{\\mathrm{IV}}\\, D_{p,k} + e_n^{\\mathrm{IV}}\\, D_{n,k},\n$$\n其中有效电荷为\n$$\ne_p^{\\mathrm{IV}} = \\frac{N}{A}, \\quad e_n^{\\mathrm{IV}} = -\\frac{Z}{A}.\n$$\n同位旋标量 $E1$ 矩阵元（在此分立模型中代表压缩 $E1$ 的代理）定义为\n$$\nM_{\\mathrm{IS},k} = D_{p,k} + D_{n,k}.\n$$\n相应的分立强度为\n$$\nB_{\\mathrm{IV},k} = \\left| M_{\\mathrm{IV},k} \\right|^2, \\quad B_{\\mathrm{IS},k} = \\left| M_{\\mathrm{IS},k} \\right|^2,\n$$\n积分强度为\n$$\nS_{\\mathrm{IV}} = \\sum_{k} B_{\\mathrm{IV},k}, \\quad S_{\\mathrm{IS}} = \\sum_{k} B_{\\mathrm{IS},k}.\n$$\n所有强度必须以 $e^2\\,\\mathrm{fm}^2$ 为单位表示。能量必须以兆电子伏特（$\\mathrm{MeV}$）处理。角度不涉及此问题。\n\n- CC 和 EDF 预测之间的比较将针对积分强度 $S_{\\mathrm{IV}}$ 和 $S_{\\mathrm{IS}}$ 进行。为了模拟缺少同位旋矢量三体力项的 EDF，通过一个混合规则为每个模式 $k$ 定义其质子和中子振幅积分\n$$\nD^{\\mathrm{EDF}}_{p,k} = (1-f)\\,D^{\\mathrm{CC}}_{p,k} + f\\,D^{\\mathrm{CC}}_{n,k}, \\quad\nD^{\\mathrm{EDF}}_{n,k} = (1-f)\\,D^{\\mathrm{CC}}_{n,k} + f\\,D^{\\mathrm{CC}}_{p,k},\n$$\n其中 $f \\in [0, 0.5]$ 是一个量化同位旋矢量淬灭的无量纲混合因子。这种混合降低了质子-中子对比度，并选择性地抑制了同位旋矢量强度，同时保持同位旋标量和 $D_{p,k}+D_{n,k}$ 不变。\n\n- 定义诊断量：\n    1. 同位旋矢量相对偏差\n    $$\n    r_{\\mathrm{IV}} = \\begin{cases}\n    \\dfrac{S^{\\mathrm{CC}}_{\\mathrm{IV}}}{S^{\\mathrm{EDF}}_{\\mathrm{IV}}} - 1,  \\text{if } S^{\\mathrm{EDF}}_{\\mathrm{IV}} > 0,\\\\\n    0,  \\text{if } S^{\\mathrm{EDF}}_{\\mathrm{IV}} = 0,\n    \\end{cases}\n    $$\n    2. 同位旋标量相对偏差\n    $$\n    r_{\\mathrm{IS}} = \\begin{cases}\n    \\dfrac{S^{\\mathrm{CC}}_{\\mathrm{IS}}}{S^{\\mathrm{EDF}}_{\\mathrm{IS}}} - 1,  \\text{if } S^{\\mathrm{EDF}}_{\\mathrm{IS}} > 0,\\\\\n    0,  \\text{if } S^{\\mathrm{EDF}}_{\\mathrm{IS}} = 0.\n    \\end{cases}\n    $$\n    3. 一个用于指示 EDF 是否缺失同位旋矢量三体力项的布尔指示符，\n    $$\n    \\text{missing\\_IV\\_3body} = \\begin{cases}\n    \\text{True},  \\text{if } r_{\\mathrm{IV}} > \\tau_{\\mathrm{IV}} \\text{ and } \\left| r_{\\mathrm{IS}} \\right| \\le \\tau_{\\mathrm{IS}},\\\\\n    \\text{False},  \\text{otherwise},\n    \\end{cases}\n    $$\n    阈值为 $\\tau_{\\mathrm{IV}} = 0.10$ 和 $\\tau_{\\mathrm{IS}} = 0.05$。\n\n您的程序必须为以下测试套件实现上述逻辑。对于每种情况，将宽度视为 $\\Gamma = 1.0\\,\\mathrm{MeV}$（此选择不影响积分强度，但提供了物理真实性）。\n\n测试套件（所有能量单位为 $\\mathrm{MeV}$，所有 $D$ 值单位为 $\\mathrm{fm}$）：\n\n- 情况 1（中等质量核）：$Z=28$, $N=32$, $A=60$, $f=0.15$。CC 激发和振幅：\n    - $\\omega = [9.0,\\, 15.5,\\, 23.0]$,\n    - $D^{\\mathrm{CC}}_{p} = [1.6,\\, 0.8,\\, 0.5]$,\n    - $D^{\\mathrm{CC}}_{n} = [-0.4,\\, 0.6,\\, 0.2]$.\n\n- 情况 2（对称核边界条件）：$Z=20$, $N=20$, $A=40$, $f=0.0$。CC 激发和振幅：\n    - $\\omega = [10.0,\\, 18.0]$,\n    - $D^{\\mathrm{CC}}_{p} = [0.3,\\, 0.5]$,\n    - $D^{\\mathrm{CC}}_{n} = [0.3,\\, 0.5]$.\n\n- 情况 3（重核，更强的淬灭）：$Z=50$, $N=70$, $A=120$, $f=0.30$。CC 激发和振幅：\n    - $\\omega = [8.0,\\, 12.5,\\, 17.0,\\, 25.0]$,\n    - $D^{\\mathrm{CC}}_{p} = [2.0,\\, 1.5,\\, 1.1,\\, 0.6]$,\n    - $D^{\\mathrm{CC}}_{n} = [0.2,\\, 0.9,\\, 0.8,\\, 0.1]$.\n\n- 情况 4（振幅消失的边界情况）：$Z=14$, $N=14$, $A=28$, $f=0.0$。CC 激发和振幅：\n    - $\\omega = [20.0]$,\n    - $D^{\\mathrm{CC}}_{p} = [0.0]$,\n    - $D^{\\mathrm{CC}}_{n} = [0.0]$.\n\n任务：\n\n1. 对于每种情况，使用上述混合规则和给定的 $f$ 构建 EDF 振幅。\n2. 计算 $S^{\\mathrm{CC}}_{\\mathrm{IV}}$、$S^{\\mathrm{EDF}}_{\\mathrm{IV}}$、$S^{\\mathrm{CC}}_{\\mathrm{IS}}$ 和 $S^{\\mathrm{EDF}}_{\\mathrm{IS}}$，单位为 $e^2\\,\\mathrm{fm}^2$。\n3. 使用阈值 $\\tau_{\\mathrm{IV}} = 0.10$ 和 $\\tau_{\\mathrm{IS}} = 0.05$ 计算 $r_{\\mathrm{IV}}$ 和布尔值 $\\text{missing\\_IV\\_3body}$。当 $r_{\\mathrm{IV}}$ 或 $r_{\\mathrm{IS}}$ 中的分母为零时，将相应的比率定义为 $0$。\n4. 将每个 $r_{\\mathrm{IV}}$ 表示为四舍五入到六位小数的浮点数。最终输出必须是单行，包含一个用方括号括起来的逗号分隔列表，由每种情况的交替条目组成：$[r_{\\mathrm{IV},1}, \\text{missing\\_IV\\_3body}_1, r_{\\mathrm{IV},2}, \\text{missing\\_IV\\_3body}_2, \\dots]$。\n\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果（例如，“[result1,result2,result3]”）。",
            "solution": "该问题要求设计并实现一个数值程序，用于计算和比较原子核的电偶极（$E1$）响应，并将其分解为同位旋矢量和同位旋标量分量。比较是在一个基准的从头耦合簇（CC）计算和一个简化的能量密度泛函（EDF）模型之间进行的。目标是通过评估一组诊断量，识别出 EDF 模型中一个特定的缺陷，该缺陷被假定源于缺失的同位旋矢量三体力贡献。\n\n解决方案将通过以下步骤制定：首先，规范化所有必要量的计算；然后，概述单个测试用例的算法流程；最后，在一个处理整个测试套件的程序中实现此流程。\n\n首先，我们确立核心量。原子核由其质子数 $Z$、中子数 $N$ 和质量数 $A = Z+N$ 定义。对于一个给定的原子核，基本输入是分立的激发能 $\\{\\omega_k\\}$ 以及相应的经过质心修正的质子和中子偶极振幅积分 $\\{D_{p,k}\\}$ 和 $\\{D_{n,k}\\}$。这些量由一个参考的 CC 计算提供，并用上标 'CC' 表示。\n\n分析的关键在于 $E1$ 响应的同位旋矢量（IV）和同位旋标量（IS）分解。对于一个给定的分立跃迁 $k$，同位旋矢量矩阵元由下式给出\n$$\nM_{\\mathrm{IV},k} = e_p^{\\mathrm{IV}}\\, D_{p,k} + e_n^{\\mathrm{IV}}\\, D_{n,k},\n$$\n其中同位旋矢量有效电荷为 $e_p^{\\mathrm{IV}} = N/A$ 和 $e_n^{\\mathrm{IV}} = -Z/A$。这可以更紧凑地重写为\n$$\nM_{\\mathrm{IV},k} = \\frac{N}{A} D_{p,k} - \\frac{Z}{A} D_{n,k} = \\frac{1}{A}(N D_{p,k} - Z D_{n,k}).\n$$\n同位旋标量矩阵元，作为压缩运动的代理，定义为质子和中子振幅之和：\n$$\nM_{\\mathrm{IS},k} = D_{p,k} + D_{n,k}.\n$$\n同位旋矢量和同位旋标量模式的积分强度是所有分立态 $k$ 上矩阵元平方的和：\n$$\nS_{\\mathrm{IV}} = \\sum_{k} |M_{\\mathrm{IV},k}|^2, \\quad S_{\\mathrm{IS}} = \\sum_{k} |M_{\\mathrm{IS},k}|^2.\n$$\n这些公式适用于 CC 参考计算和 EDF 模型计算，只需代入各自的偶极振幅即可。强度的单位是 $e^2\\,\\mathrm{fm}^2$。正如问题中所述，激发能 $\\omega_k$ 和展宽宽度 $\\Gamma$ 不参与积分强度的计算。\n\n接下来，我们建立 CC 和 EDF 模型之间的关系。EDF 模型的振幅是通过一个由因子 $f \\in [0, 0.5]$ 参数化的混合规则从 CC 振幅派生出来的：\n$$\nD^{\\mathrm{EDF}}_{p,k} = (1-f)\\,D^{\\mathrm{CC}}_{p,k} + f\\,D^{\\mathrm{CC}}_{n,k},\n$$\n$$\nD^{\\mathrm{EDF}}_{n,k} = (1-f)\\,D^{\\mathrm{CC}}_{n,k} + f\\,D^{\\mathrm{CC}}_{p,k}.\n$$\n这种混合模拟了质子-中子差异的淬灭。我们现在必须确定这种混合对同位旋矢量和同位旋标量强度的影响。\n\n对于同位旋标量分量，模式 $k$ 的 EDF 矩阵元为：\n$$\nM^{\\mathrm{EDF}}_{\\mathrm{IS},k} = D^{\\mathrm{EDF}}_{p,k} + D^{\\mathrm{EDF}}_{n,k} = \\left((1-f)D^{\\mathrm{CC}}_{p,k} + fD^{\\mathrm{CC}}_{n,k}\\right) + \\left((1-f)D^{\\mathrm{CC}}_{n,k} + fD^{\\mathrm{CC}}_{p,k}\\right)\n$$\n$$\nM^{\\mathrm{EDF}}_{\\mathrm{IS},k} = (1-f+f)D^{\\mathrm{CC}}_{p,k} + (f+1-f)D^{\\mathrm{CC}}_{n,k} = D^{\\mathrm{CC}}_{p,k} + D^{\\mathrm{CC}}_{n,k} = M^{\\mathrm{CC}}_{\\mathrm{IS},k}.\n$$\n由于每个模式 $k$ 的矩阵元都相同，因此积分同位旋标量强度在此变换下是不变的：$S^{\\mathrm{EDF}}_{\\mathrm{IS}} = S^{\\mathrm{CC}}_{\\mathrm{IS}}$。\n\n对于同位旋矢量分量，EDF 矩阵元为：\n$$\nM^{\\mathrm{EDF}}_{\\mathrm{IV},k} = \\frac{1}{A}(N D^{\\mathrm{EDF}}_{p,k} - Z D^{\\mathrm{EDF}}_{n,k}).\n$$\n代入混合规则：\n$$\nM^{\\mathrm{EDF}}_{\\mathrm{IV},k} = \\frac{1}{A} \\left( N\\left[(1-f)D^{\\mathrm{CC}}_{p,k} + fD^{\\mathrm{CC}}_{n,k}\\right] - Z\\left[(1-f)D^{\\mathrm{CC}}_{n,k} + fD^{\\mathrm{CC}}_{p,k}\\right] \\right)\n$$\n$$\nM^{\\mathrm{EDF}}_{\\mathrm{IV},k} = \\frac{1}{A} \\left( [N(1-f) - Zf]D^{\\mathrm{CC}}_{p,k} + [Nf - Z(1-f)]D^{\\mathrm{CC}}_{n,k} \\right)\n$$\n$$\nM^{\\mathrm{EDF}}_{\\mathrm{IV},k} = \\frac{1}{A} \\left( [N - (N+Z)f]D^{\\mathrm{CC}}_{p,k} + [-Z + (N+Z)f]D^{\\mathrm{CC}}_{n,k} \\right)\n$$\n使用 $A=N+Z$：\n$$\nM^{\\mathrm{EDF}}_{\\mathrm{IV},k} = \\frac{1}{A} \\left( (N - Af)D^{\\mathrm{CC}}_{p,k} + (-Z + Af)D^{\\mathrm{CC}}_{n,k} \\right)\n$$\n$$\nM^{\\mathrm{EDF}}_{\\mathrm{IV},k} = \\frac{1}{A}(N D^{\\mathrm{CC}}_{p,k} - Z D^{\\mathrm{CC}}_{n,k}) - \\frac{Af}{A}(D^{\\mathrm{CC}}_{p,k} - D^{\\mathrm{CC}}_{n,k})\n$$\n$$\nM^{\\mathrm{EDF}}_{\\mathrm{IV},k} = M^{\\mathrm{CC}}_{\\mathrm{IV},k} - f(D^{\\mathrm{CC}}_{p,k} - D^{\\mathrm{CC}}_{n,k}).\n$$\n这个简化的表达式揭示了混合引入了一个与 $f$ 以及质子和中子振幅之差成正比的项，这直接修改了同位旋矢量矩阵元。\n\n现在可以计算诊断量了。同位旋标量相对偏差为：\n$$\nr_{\\mathrm{IS}} = \\begin{cases} \\dfrac{S^{\\mathrm{CC}}_{\\mathrm{IS}}}{S^{\\mathrm{EDF}}_{\\mathrm{IS}}} - 1,  \\text{if } S^{\\mathrm{EDF}}_{\\mathrm{IS}} > 0,\\\\ 0,  \\text{if } S^{\\mathrm{EDF}}_{\\mathrm{IS}} = 0. \\end{cases}\n$$\n因为我们证明了 $S^{\\mathrm{EDF}}_{\\mathrm{IS}} = S^{\\mathrm{CC}}_{\\mathrm{IS}}$，如果 $S^{\\mathrm{EDF}}_{\\mathrm{IS}} > 0$，则比值为 $1$，使得 $r_{\\mathrm{IS}} = 1 - 1 = 0$。如果 $S^{\\mathrm{EDF}}_{\\mathrm{IS}} = 0$，$r_{\\mathrm{IS}}$ 定义为 $0$。因此，$r_{\\mathrm{IS}}$ 始终为 $0$。\n\n同位旋矢量相对偏差为：\n$$\nr_{\\mathrm{IV}} = \\begin{cases} \\dfrac{S^{\\mathrm{CC}}_{\\mathrm{IV}}}{S^{\\mathrm{EDF}}_{\\mathrm{IV}}} - 1,  \\text{if } S^{\\mathrm{EDF}}_{\\mathrm{IV}} > 0,\\\\ 0,  \\text{if } S^{\\mathrm{EDF}}_{\\mathrm{IV}} = 0. \\end{cases}\n$$\n用于指示缺失同位旋矢量三体力项的布尔指示符是：\n$$\n\\text{missing\\_IV\\_3body} = \\begin{cases} \\text{True},  \\text{if } r_{\\mathrm{IV}} > \\tau_{\\mathrm{IV}} \\text{ and } \\left| r_{\\mathrm{IS}} \\right| \\le \\tau_{\\mathrm{IS}},\\\\ \\text{False},  \\text{otherwise}, \\end{cases}\n$$\n给定阈值为 $\\tau_{\\mathrm{IV}} = 0.10$ 和 $\\tau_{\\mathrm{IS}} = 0.05$。由于 $|r_{\\mathrm{IS}}| = 0$ 且 $0 \\le 0.05$，第二个条件始终为真。该判据简化为：当且仅当 $r_{\\mathrm{IV}} > 0.10$ 时，$\\text{missing\\_IV\\_3body} = \\text{True}$。\n\n每个测试用例的算法流程如下：\n1.  接收输入 $Z, N, f$ 以及 CC 振幅数组 $D^{\\mathrm{CC}}_{p}$ 和 $D^{\\mathrm{CC}}_{n}$。\n2.  计算 $A = Z+N$。\n3.  使用数组上的矢量运算，计算所有模式 $k$ 的 CC 矩阵元：\n    -   $M^{\\mathrm{CC}}_{\\mathrm{IV}} = (1/A) \\cdot (N \\cdot D^{\\mathrm{CC}}_{p} - Z \\cdot D^{\\mathrm{CC}}_{n})$\n4.  计算积分 CC 同位旋矢量强度：\n    -   $S^{\\mathrm{CC}}_{\\mathrm{IV}} = \\sum |M^{\\mathrm{CC}}_{\\mathrm{IV}}|^2$\n5.  使用简化表达式，计算所有模式 $k$ 的 EDF 矩阵元：\n    -   $M^{\\mathrm{EDF}}_{\\mathrm{IV}} = M^{\\mathrm{CC}}_{\\mathrm{IV}} - f \\cdot (D^{\\mathrm{CC}}_{p} - D^{\\mathrm{CC}}_{n})$\n6.  计算积分 EDF 同位旋矢量强度：\n    -   $S^{\\mathrm{EDF}}_{\\mathrm{IV}} = \\sum |M^{\\mathrm{EDF}}_{\\mathrm{IV}}|^2$\n7.  根据提供的条件定义计算 $r_{\\mathrm{IV}}$，检查 $S^{\\mathrm{EDF}}_{\\mathrm{IV}}$ 是否为零。\n8.  通过将计算出的 $r_{\\mathrm{IV}}$ 与阈值 $\\tau_{\\mathrm{IV}}=0.10$ 进行比较，确定 $\\text{missing\\_IV\\_3body}$ 的布尔值。\n9.  存储并格式化得到的 $r_{\\mathrm{IV}}$（四舍五入到六位小数）和布尔值。\n\n此流程将在一个迭代处理所提供测试套件的循环中实现。`numpy` 库是高效、准确地执行所需矢量化计算的理想选择。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the computational nuclear physics problem for a suite of test cases.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (medium-mass nucleus)\n        {\n            \"Z\": 28, \"N\": 32, \"f\": 0.15,\n            \"D_cc_p\": np.array([1.6, 0.8, 0.5]),\n            \"D_cc_n\": np.array([-0.4, 0.6, 0.2])\n        },\n        # Case 2 (symmetric nucleus boundary condition)\n        {\n            \"Z\": 20, \"N\": 20, \"f\": 0.0,\n            \"D_cc_p\": np.array([0.3, 0.5]),\n            \"D_cc_n\": np.array([0.3, 0.5])\n        },\n        # Case 3 (heavy nucleus, stronger quenching)\n        {\n            \"Z\": 50, \"N\": 70, \"f\": 0.30,\n            \"D_cc_p\": np.array([2.0, 1.5, 1.1, 0.6]),\n            \"D_cc_n\": np.array([0.2, 0.9, 0.8, 0.1])\n        },\n        # Case 4 (edge case with vanishing amplitudes)\n        {\n            \"Z\": 14, \"N\": 14, \"f\": 0.0,\n            \"D_cc_p\": np.array([0.0]),\n            \"D_cc_n\": np.array([0.0])\n        }\n    ]\n\n    # Diagnostic thresholds\n    tau_IV = 0.10\n    tau_IS = 0.05\n\n    results = []\n    \n    for case in test_cases:\n        Z = case[\"Z\"]\n        N = case[\"N\"]\n        f = case[\"f\"]\n        D_cc_p = case[\"D_cc_p\"]\n        D_cc_n = case[\"D_cc_n\"]\n        \n        A = Z + N\n\n        # --- Coupled Cluster (CC) Calculations ---\n        \n        # Isovector matrix elements for CC\n        # M_IV,k = (N/A)*D_p,k - (Z/A)*D_n,k\n        M_cc_iv_k = (1/A) * (N * D_cc_p - Z * D_cc_n)\n        \n        # Integrated isovector strength for CC\n        # S_IV = sum(|M_IV,k|^2)\n        S_cc_iv = np.sum(np.square(np.abs(M_cc_iv_k)))\n\n        # Isoscalar matrix elements for CC\n        # M_IS,k = D_p,k + D_n,k\n        # This is not strictly needed for the simplified logic but good for completeness\n        M_cc_is_k = D_cc_p + D_cc_n\n        S_cc_is = np.sum(np.square(np.abs(M_cc_is_k)))\n\n        # --- Energy Density Functional (EDF) Calculations ---\n\n        # The mixing rule preserves the isoscalar sum, so S_edf_is = S_cc_is.\n        S_edf_is = S_cc_is\n\n        # Use the derived simplified formula for EDF isovector matrix elements:\n        # M_EDF_IV,k = M_CC_IV,k - f * (D_CC_p,k - D_CC_n,k)\n        M_edf_iv_k = M_cc_iv_k - f * (D_cc_p - D_cc_n)\n\n        # Integrated isovector strength for EDF\n        S_edf_iv = np.sum(np.square(np.abs(M_edf_iv_k)))\n        \n        # --- Diagnostic Calculations ---\n        \n        # Isovector relative deviation\n        if S_edf_iv > 0:\n            r_iv = S_cc_iv / S_edf_iv - 1\n        else:\n            r_iv = 0.0\n\n        # Isoscalar relative deviation is always 0 due to the mixing rule's nature.\n        if S_edf_is > 0:\n            r_is = S_cc_is / S_edf_is - 1\n        else:\n            r_is = 0.0 # which is always 0\n\n        # Boolean indicator for missing isovector three-body term\n        # The condition |r_is| = tau_IS is always true because r_is is 0.\n        is_missing_iv_3body = r_iv > tau_IV\n        \n        # Append results for this case\n        results.append(f\"{r_iv:.6f}\")\n        results.append(str(is_missing_iv_3body))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}