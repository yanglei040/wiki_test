{
    "hands_on_practices": [
        {
            "introduction": "This first practice establishes the computational foundation for calculating $\\log ft$ values. You will implement the phase-space integral for allowed beta decays, focusing on critical numerical techniques to handle low-energy decays where the integration domain becomes small and the integrand is stiff. Mastering these methods  is essential for building robust and accurate beta-decay analysis tools.",
            "id": "3547408",
            "problem": "You are tasked with implementing a computational routine to evaluate comparative half-life quantities for allowed beta-minus decay, specifically to compute base-ten logarithms of the product of the statistical rate function and the partial half-life (commonly referred to as the \"log-ft\" value). Your program must address numerical stiffness arising in low endpoint-energy decays and must produce numerically stable outputs across a diverse test suite.\n\nStarting from Fermi’s Golden Rule and the allowed approximation, the decay rate can be expressed as a product of a nuclear-structure factor and a lepton phase-space factor. The comparative half-life isolates the phase-space component. In dimensionless electron-energy units scaled by the electron rest energy (that is, $W \\equiv E_{e}/(m_{e} c^{2})$), define the endpoint $W_{0}$ by $W_{0} = 1 + Q/(m_{e} c^{2})$, where $Q$ is the $Q$-value. For an allowed transition (shape factor equal to unity), the statistical rate function $f$ is given by the lepton phase-space integral\n$$\nf(Z,Q) = \\int_{1}^{W_{0}} F(Z,W)\\, p\\, W\\, (W_{0} - W)^{2} \\, dW,\n$$\nwhere $p = \\sqrt{W^{2}-1}$ is the electron momentum in units of $m_{e} c$, and $F(Z,W)$ is the Coulomb correction (Fermi function) for beta-minus emission off a daughter nucleus of charge $Z$. To model the Coulomb distortion, use the well-tested approximation\n$$\nF(Z,W) \\approx \\frac{2\\pi \\eta}{1 - e^{-2\\pi \\eta}}, \\quad \\eta \\equiv \\frac{\\alpha Z W}{p},\n$$\nwhere $\\alpha$ is the fine-structure constant and $e$ is the base of the natural logarithm. Implement this expression in a numerically stable way, especially in the regime of small $p$, by evaluating the combination $p\\,F(Z,W)$ directly to avoid loss of significance due to cancellation. Use the electron rest energy $m_{e} c^{2}$ in kiloelectron-volt as $m_{e} c^{2} = 510.99895\\,\\text{keV}$ and the fine-structure constant $\\alpha = 1/137.035999084$.\n\nGiven the statistical rate function $f$ and the half-life $t_{1/2}$, define the comparative half-life as $f\\,t_{1/2}/b$, where $b$ is the branching fraction for the transition written as a pure decimal between $0$ and $1$. Your task is to compute\n$$\n\\log_{10}\\!\\left( f(Z,Q)\\,\\frac{t_{1/2}}{b} \\right).\n$$\nYou must design the computation to be robust for low $Q$ near the electron rest-energy threshold, where the integration domain $[1,W_{0}]$ becomes very small and the integrand becomes numerically stiff. To this end, you must perform a variable transformation that maps the integral to a fixed interval and isolates small scale factors analytically, and you must implement the evaluation of $p\\,F(Z,W)$ using an algebraically equivalent but numerically stable form that remains finite as $p \\to 0^{+}$.\n\nImplement the following requirements precisely:\n- Use the change of variables $W = 1 + (W_{0}-1)\\,x$ with $x \\in [0,1]$ so that\n$$\nf(Z,Q) = (W_{0}-1)^{3}\\int_{0}^{1} \\left[ p(W)\\,F(Z,W) \\right]\\, W\\, (1-x)^{2}\\, dx,\n$$\nwith $W = 1 + (W_{0}-1)\\,x$ and $p(W) = \\sqrt{W^{2}-1}$, thereby regularizing the integral over a fixed domain and capturing the smallness of $(W_{0}-1)$ analytically.\n- Evaluate $p(W)\\,F(Z,W)$ using\n$$\np(W)\\,F(Z,W) = \\frac{2\\pi\\,\\alpha\\,Z\\,W}{1 - \\exp\\!\\left(-2\\pi\\,\\alpha\\,Z\\,W/p(W)\\right)},\n$$\nand use a numerically stable implementation of the denominator via the function $\\operatorname{expm1}$ for small arguments. In the special case $Z=0$, set $F(Z,W)=1$ so that $p(W)\\,F(Z,W)=p(W)$.\n- Treat all $Q$-values in kiloelectron-volt (keV), all half-lives in seconds, and branching fractions as dimensionless decimals. The output must be $\\log_{10}(f\\,t_{1/2}/b)$ with no unit.\n- Use double-precision floating-point arithmetic. Your numerical integration must be accurate to at least approximately a relative tolerance of $10^{-9}$ for typical cases; handle near-threshold cases with appropriate absolute tolerances.\n\nTest suite. Your program must compute the outputs for the following five cases:\n- Case A (typical allowed, moderate $Z$): $Z = 20$, $Q = 3000.0\\,\\text{keV}$, $t_{1/2} = 10.0\\,\\text{s}$, $b = 1.0$.\n- Case B (low $Q$ allowed, tritium-like): $Z = 1$, $Q = 18.6\\,\\text{keV}$, $t_{1/2} = 3.888\\times 10^{8}\\,\\text{s}$, $b = 1.0$.\n- Case C (low $Q$ stress test, toy allowed): $Z = 30$, $Q = 100.0\\,\\text{keV}$, $t_{1/2} = 1.0\\times 10^{6}\\,\\text{s}$, $b = 1.0$.\n- Case D (near-threshold stiffness, toy allowed): $Z = 50$, $Q = 1.0\\,\\text{keV}$, $t_{1/2} = 1.0\\times 10^{12}\\,\\text{s}$, $b = 1.0$.\n- Case E (high $Z$ Coulomb effect): $Z = 82$, $Q = 1000.0\\,\\text{keV}$, $t_{1/2} = 1.0\\times 10^{4}\\,\\text{s}$, $b = 0.5$.\n\nFinal output specification:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the same order as the cases above. Each value must be rounded to six decimal places. For example, an output with three values should look like $[4.321000,5.432100,6.543210]$.",
            "solution": "The problem is valid. It presents a well-posed, scientifically grounded computational task in nuclear physics. All necessary physical quantities, constants, and computational constraints are clearly defined and self-consistent. The problem addresses a genuine numerical challenge—the evaluation of the beta decay phase-space integral, particularly in the low-energy regime—and specifies standard, appropriate techniques to ensure a stable and accurate solution.\n\nThe goal is to compute the logarithm of the comparative half-life, or the log-ft value, defined as $\\log_{10}(f t_{1/2}/b)$. The core of the problem is the calculation of the statistical rate function, $f(Z, Q)$, which represents the integrated phase space available to the emitted electron and antineutrino, modulated by the Coulomb interaction between the electron and the daughter nucleus.\n\nThe statistical rate function for an allowed beta-minus decay is given by the integral:\n$$\nf(Z,Q) = \\int_{1}^{W_{0}} F(Z,W)\\, p\\, W\\, (W_{0} - W)^{2} \\, dW\n$$\nHere, all energy-related quantities are made dimensionless by scaling with the electron rest energy, $m_e c^2 \\approx 510.99895\\,\\text{keV}$. The electron's total energy is $W$, its momentum is $p = \\sqrt{W^2 - 1}$, and its maximum possible energy (the endpoint) is $W_0 = 1 + Q/(m_e c^2)$, where $Q$ is the decay energy. The function $F(Z,W)$ is the Fermi function, which corrects for the Coulomb distortion of the electron's wavefunction by the daughter nucleus of charge $Z$. A common and accurate approximation for $F(Z,W)$ is used:\n$$\nF(Z,W) \\approx \\frac{2\\pi \\eta}{1 - e^{-2\\pi \\eta}}, \\quad \\text{where} \\quad \\eta = \\frac{\\alpha Z W}{p}\n$$\nand $\\alpha \\approx 1/137.035999084$ is the fine-structure constant.\n\nTwo primary numerical challenges arise in evaluating this integral:\n1.  **Shrinking Integration Domain**: For low $Q$-values, the endpoint $W_0$ is very close to $1$, making the integration interval $[1, W_0]$ extremely small. This can lead to a loss of precision in standard numerical integration routines. To mitigate this, a change of variables is employed: $W = 1 + (W_0 - 1)x$. This maps the shrinking interval $[1, W_0]$ to the fixed interval $[0, 1]$ for the new integration variable $x$. The differential becomes $dW = (W_0 - 1)dx$, and the kinetic energy term becomes $(W_0 - W)^2 = (W_0 - 1)^2 (1 - x)^2$. The smallness of the phase space is then captured analytically by a pre-factor of $(W_0 - 1)^3$, leading to the regularized integral:\n    $$\n    f(Z,Q) = (W_{0}-1)^{3}\\int_{0}^{1} \\left[ p(W)\\,F(Z,W) \\right]\\, W\\, (1-x)^{2}\\, dx\n    $$\n2.  **Numerical Stability of the Integrand**: The evaluation of the term $p F(Z,W)$ can be unstable. As $W \\to 1$ (or $x \\to 0$), the momentum $p \\to 0$, causing the term $\\eta$ in the Fermi function to diverge. To avoid a division-by-zero error and maintain accuracy, the product $p F(Z,W)$ is algebraically rearranged into a stable form:\n    $$\n    p(W)\\,F(Z,W) = p(W) \\frac{2\\pi \\frac{\\alpha Z W}{p(W)}}{1 - \\exp\\left(-2\\pi \\frac{\\alpha Z W}{p(W)}\\right)} = \\frac{2\\pi\\alpha Z W}{1 - \\exp\\left(-2\\pi\\alpha Z W / p(W)\\right)}\n    $$\n    In the limit $p \\to 0$, this expression correctly and stably approaches the finite value $2\\pi\\alpha Z W$. Furthermore, for large $p$, the argument of the exponential, $y = 2\\pi\\alpha Z W / p$, can become small. Direct computation of $1 - e^{-y}$ can then suffer from catastrophic cancellation. This is resolved by using the library function $\\operatorname{expm1}(x)$, which accurately computes $e^x - 1$ for small $|x|$. The denominator is computed as $-(\\exp(-y) - 1) = -\\operatorname{expm1}(-y)$.\n\nThe computational procedure is as follows:\n1.  Define the physical constants $m_e c^2$ and $\\alpha$.\n2.  For each test case $(Z, Q, t_{1/2}, b)$, calculate the dimensionless endpoint energy $W_0$.\n3.  Define an integrand function of the variable $x$ based on the transformed integral. This function calculates $W(x)$, the momentum $p(W)$, and the term $p(W)F(Z,W)$ using the numerically stable methods described above. It correctly handles the special case $Z=0$ and the limit $x=0$ ($p=0$).\n4.  Use a high-precision numerical quadrature routine (`scipy.integrate.quad`) to evaluate the integral of this function over the interval $[0, 1]$. Appropriate absolute and relative error tolerances ($epsabs=10^{-15}$, $epsrel=10^{-10}$) are set to ensure accuracy, especially for near-threshold cases where the integral's value is small.\n5.  Calculate the final statistical rate function $f(Z,Q)$ by multiplying the integral result by $(W_0 - 1)^3$.\n6.  Compute the ft-value by multiplying $f(Z,Q)$ with the partial half-life $t_{1/2}/b$.\n7.  Take the base-10 logarithm of the result, $\\log_{10}(ft)$, and format it to six decimal places.\n\nThis methodology implements all requirements, providing a robust and accurate calculation of the log-ft values across a range of physical scenarios.",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import quad\nfrom scipy.special import expm1\n\ndef solve():\n    \"\"\"\n    Calculates and prints log-ft values for a set of beta-minus decay test cases.\n    \"\"\"\n    # Define physical constants as specified in the problem statement.\n    M_E_C2_KEV = 510.99895\n    ALPHA = 1.0 / 137.035999084\n\n    def integrand_func(x, Z, W0):\n        \"\"\"\n        Computes the value of the integrand for the transformed phase-space integral.\n        The integration variable is x, which ranges from 0 to 1.\n        \n        Args:\n            x (float): The integration variable.\n            Z (int): The charge of the daughter nucleus.\n            W0 (float): The dimensionless endpoint energy.\n        \n        Returns:\n            float: The value of the integrand at x.\n        \"\"\"\n        # At the upper integration limit x=1, the (1-x)^2 term makes the integrand zero.\n        if x == 1.0:\n            return 0.0\n\n        # Apply the change of variables: W(x) = 1 + (W0 - 1) * x\n        delta_W = W0 - 1.0\n        W = 1.0 + delta_W * x\n\n        # Handle the lower integration limit x=0 where momentum p=0.\n        if x == 0.0:\n            if Z == 0:\n                # If there's no Coulomb interaction, the integrand is zero at p=0.\n                return 0.0\n            # The limiting value of p*F(Z,W) as p->0 is 2*pi*alpha*Z*W.\n            # At x=0, W=1.\n            pF_limit = 2.0 * np.pi * ALPHA * Z\n            # The full integrand is pF * W * (1-x)^2.\n            return pF_limit * 1.0 * (1.0)**2\n\n        # For x > 0:\n        # Calculate electron momentum p = sqrt(W^2 - 1) using a numerically stable form.\n        p_squared = (W - 1.0) * (W + 1.0)\n        p = np.sqrt(p_squared)\n\n        # Calculate the product p * F(Z, W) using the specified numerically stable expression.\n        if Z == 0:\n            p_times_F = p\n        else:\n            # For 1 - exp(-y), use -expm1(-y) to maintain precision when y is small.\n            # y = 2*pi*alpha*Z*W / p\n            numerator = 2.0 * np.pi * ALPHA * Z * W\n            arg_exp = -numerator / p\n            denominator = -expm1(arg_exp)\n            p_times_F = numerator / denominator\n        \n        # The full integrand expression is [p*F] * W * (1-x)^2.\n        return p_times_F * W * (1.0 - x)**2\n\n    def calculate_log_ft(Z, Q, t_half, b):\n        \"\"\"\n        Calculates the log-ft value for a single beta decay case.\n        \"\"\"\n        # Beta decay is energetically forbidden if Q <= 0.\n        if Q <= 0:\n            return np.nan\n\n        # Dimensionless endpoint energy.\n        W0 = 1.0 + Q / M_E_C2_KEV\n        delta_W = W0 - 1.0\n        \n        # Numerically evaluate the transformed integral.\n        integral_val, _ = quad(\n            integrand_func,\n            0,\n            1,\n            args=(Z, W0),\n            epsabs=1e-15,  # Small absolute tolerance for near-threshold cases.\n            epsrel=1e-10   # High relative tolerance for accuracy.\n        )\n        \n        # Calculate the statistical rate function f(Z,Q) = (W0 - 1)^3 * Integral.\n        f_val = (delta_W**3) * integral_val\n        \n        # The branching fraction must be positive.\n        if b <= 0:\n            return np.nan\n        \n        # The ft value is f * t_partial, where t_partial = t_half / b.\n        ft_value = f_val * (t_half / b)\n        \n        # The log is only defined for positive ft values.\n        if ft_value <= 0:\n            return np.nan\n            \n        return np.log10(ft_value)\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (Z_daughter, Q_keV, t_half_s, branching_fraction)\n        (20, 3000.0, 10.0, 1.0),      # Case A\n        (1, 18.6, 3.888e8, 1.0),      # Case B\n        (30, 100.0, 1.0e6, 1.0),      # Case C\n        (50, 1.0, 1.0e12, 1.0),       # Case D\n        (82, 1000.0, 1.0e4, 0.5),     # Case E\n    ]\n    \n    results = []\n    for case in test_cases:\n        Z, Q, t_half, b = case\n        log_ft = calculate_log_ft(Z, Q, t_half, b)\n        results.append(f\"{log_ft:.6f}\")\n        \n    # Print the results in the specified format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Building upon the basics of allowed decays, this exercise expands our framework to include unique forbidden transitions. You will implement energy-dependent \"shape factors\" that modify the beta spectrum, reflecting the different nuclear physics governing these decays. This practice  demonstrates how the phase-space integral is adapted to capture the distinct spectral shapes of transitions involving changes in nuclear parity and angular momentum.",
            "id": "3547481",
            "problem": "You are tasked with implementing a program that computes base-10 logarithms of comparative half-lives, commonly referred to as log-ft values, for beta decay transitions treated as unique forbidden transitions within computational nuclear physics. The calculation must begin from the Fermi theory of beta decay and proceed by deriving a dimensionless phase-space integral appropriate for unique forbidden transitions, then combining it with a partial half-life to obtain the final quantity. All mathematical entities must be expressed consistently in terms of the electron rest mass energy and the fine-structure constant, and the program must produce numerically stable results across a scientifically meaningful test suite.\n\nStart from the following fundamentals. The beta decay spectral rate per electron total energy $W$ (in units of the electron rest mass energy $m_e c^2$) is given by\n$$\n\\frac{d\\lambda}{dW} \\propto p \\, W \\, (W_0 - W)^2 \\, F(Z, W)\\, C(W),\n$$\nwhere $p$ is the electron momentum in units of $m_e c$, $W$ is the electron total energy in units of $m_e c^2$, $W_0$ is the endpoint energy also in units of $m_e c^2$, $Z$ is the atomic number of the daughter nucleus, $F(Z,W)$ is the Fermi function accounting for Coulomb distortion of the outgoing electron wavefunction, and $C(W)$ is the shape factor determined by the nuclear transition type. The electron momentum is $p = \\sqrt{W^2 - 1}$, and for a nearly massless antineutrino the neutrino momentum is taken as $q = W_0 - W$. The endpoint is $W_0 = 1 + Q/(m_e c^2)$, with $Q$ the beta decay $Q$-value in megaelectronvolts.\n\nThe comparative half-life employs the dimensionless phase-space factor $f$ defined by the integral\n$$\nf(Z, Q; \\text{type}) = \\int_{W=1}^{W_0} p \\, W \\, (W_0 - W)^2 \\, F(Z, W) \\, C(W; \\text{type}) \\, dW.\n$$\nThe base-10 log-ft value is then\n$$\n\\log_{10} f t = \\log_{10} \\left( f(Z, Q; \\text{type}) \\times t_p \\right),\n$$\nwith the partial half-life $t_p$ related to the total half-life $t_{1/2}$ and branching ratio $B$ by $t_p = t_{1/2}/B$. The quantity $\\log_{10} f t$ is dimensionless, but $t_{1/2}$ and $t_p$ must be supplied in seconds, and $Q$ must be supplied in megaelectronvolts. The branching ratio $B$ must be supplied as a decimal fraction.\n\nFor the Fermi function, use the widely adopted approximation\n$$\nF(Z, W) = \\frac{2\\pi \\eta}{1 - e^{-2\\pi \\eta}}, \\quad \\eta = \\alpha Z \\frac{W}{p},\n$$\nwhere $\\alpha$ is the fine-structure constant. This approximation is appropriate for beta-minus decay ignoring finite-size and screening corrections, which is acceptable for the present computational exercise.\n\nTreat the following transition types and associated shape factors:\n- Allowed transitions ($\\text{type} = \\text{U0}$) with\n$$\nC(W; \\text{U0}) = 1.\n$$\n- Unique first-forbidden transitions ($\\text{type} = \\text{U1}$) with\n$$\nC(W; \\text{U1}) = p^2 + q^2.\n$$\n- Unique second-forbidden transitions ($\\text{type} = \\text{U2}$) with\n$$\nC(W; \\text{U2}) = p^4 + \\frac{10}{3} p^2 q^2 + q^4.\n$$\n\nImplement numerical integration of $f(Z, Q; \\text{type})$ over $W \\in [1, W_0]$ using robust quadrature. Ensure numerical stability at the boundaries $W = 1$ (where $p \\to 0$) and $W = W_0$ (where $q \\to 0$), and ensure the Coulomb factor is handled stably when $p$ is small. The program must compute $\\log_{10} f t$ for a test suite of scientifically plausible cases and print the results.\n\nConstants and units to use:\n- Electron rest mass energy $m_e c^2 = 0.51099895 \\, \\text{MeV}$.\n- Fine-structure constant $\\alpha = 1/137.035999084$.\n- All half-lives $t_{1/2}$ in seconds, all branching ratios $B$ as decimal fractions, and all $Q$ values in megaelectronvolts.\n\nTest suite parameter values:\n- Case $1$ (general unique first-forbidden, moderate $Z$ and $Q$): $Z = 26$, $A = 59$, $Q = 1.823 \\, \\text{MeV}$, $t_{1/2} = 44.5 \\, \\text{s}$, $B = 0.85$, $\\text{type} = \\text{U1}$.\n- Case $2$ (boundary low-$Q$ unique first-forbidden, high $Z$): $Z = 50$, $A = 115$, $Q = 0.120 \\, \\text{MeV}$, $t_{1/2} = 3.0 \\times 10^{7} \\, \\text{s}$, $B = 1.0$, $\\text{type} = \\text{U1}$.\n- Case $3$ (unique second-forbidden, high $Z$): $Z = 82$, $A = 214$, $Q = 2.000 \\, \\text{MeV}$, $t_{1/2} = 1.0 \\times 10^{5} \\, \\text{s}$, $B = 0.6$, $\\text{type} = \\text{U2}$.\n- Case $4$ (allowed for comparison, low $Z$): $Z = 8$, $A = 14$, $Q = 3.000 \\, \\text{MeV}$, $t_{1/2} = 70.0 \\, \\text{s}$, $B = 1.0$, $\\text{type} = \\text{U0}$.\n\nYour program must produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with each entry the computed $\\log_{10} f t$ for the corresponding case, rounded to six decimal places, in the order listed above. For example, it should print a string of the form $[\\ell_1,\\ell_2,\\ell_3,\\ell_4]$, where each $\\ell_i$ is a float with six digits after the decimal point.",
            "solution": "The computation of comparative half-lives for beta decay is grounded in Fermi’s theory, wherein the differential decay rate $\\frac{d\\lambda}{dW}$ depends on the available phase space and on the lepton wavefunctions distorted by the Coulomb field of the daughter nucleus. The foundational expression,\n$$\n\\frac{d\\lambda}{dW} \\propto p \\, W \\, (W_0 - W)^2 \\, F(Z, W)\\, C(W),\n$$\nderives from the Fermi Golden Rule and the relativistic treatment of outgoing leptons. Here $W$ is the electron total energy in units of $m_e c^2$, $p = \\sqrt{W^2 - 1}$ is the electron momentum in units of $m_e c$, and $q = W_0 - W$ is the neutrino momentum under the approximation of a negligible neutrino mass. The endpoint $W_0 = 1 + Q/(m_e c^2)$ follows directly from energy conservation, with $Q$ the beta decay energy in megaelectronvolts.\n\nThe dimensionless phase-space integral\n$$\nf(Z, Q; \\text{type}) = \\int_{1}^{W_0} p \\, W \\, (W_0 - W)^2 \\, F(Z, W)\\, C(W; \\text{type}) \\, dW\n$$\ncollects the kinematic and Coulomb effects as well as the spectral distortion due to the nuclear transition operator. The Fermi function $F(Z, W)$ embodies the Coulomb attraction of the emitted electron to the daughter nucleus. While exact treatments involve solutions to the Dirac equation with finite-size corrections, a widely used and stable approximation suitable for computational purposes is\n$$\nF(Z, W) = \\frac{2\\pi \\eta}{1 - e^{-2\\pi \\eta}}, \\quad \\eta = \\alpha Z \\frac{W}{p},\n$$\nwhere $\\alpha$ is the fine-structure constant. Near the threshold $W \\to 1$, $p \\to 0$, and $\\eta$ grows large such that $F \\approx 2\\pi \\eta$; then the product $p F \\approx 2\\pi \\alpha Z W$ remains finite, ensuring numerically well-behaved integrals.\n\nThe spectral shape factor $C(W)$ depends on the nuclear transition type. For allowed transitions, the lepton pair carries no orbital angular momentum and one finds $C(W; \\text{U0}) = 1$. For unique forbidden transitions, a single nuclear operator of rank equal to the degree of forbiddenness governs the spectrum; the shape factor becomes a polynomial in $p^2$ and $q^2$ with coefficients fixed by angular momentum coupling and relativistic current structure. For the first unique forbidden transition one obtains\n$$\nC(W; \\text{U1}) = p^2 + q^2,\n$$\nwhile for the second unique forbidden transition the shape factor is\n$$\nC(W; \\text{U2}) = p^4 + \\frac{10}{3} p^2 q^2 + q^4.\n$$\nThese expressions follow from the multipole expansion of the weak interaction Hamiltonian, imposing that the lepton system carries orbital angular momentum matching the nuclear operator rank and coupling consistently to the overall spin transfer.\n\nThe comparative half-life is constructed by combining the kinematic integral with the partial half-life $t_p = t_{1/2}/B$, where $t_{1/2}$ is the total half-life in seconds and $B$ is the branching ratio supplied as a decimal fraction. The conventional quantity\n$$\n\\log_{10} f t = \\log_{10} \\left( f(Z, Q; \\text{type}) \\times t_p \\right)\n$$\nis dimensionless. Although in a full theory $t_p$ also depends on the squared nuclear matrix element and coupling constants, the definition of $\\log_{10} f t$ purposefully isolates the kinematic integral, facilitating empirical comparison across transitions.\n\nAlgorithmic design:\n- Define constants $m_e c^2 = 0.51099895 \\, \\text{MeV}$ and $\\alpha = 1/137.035999084$.\n- For given $Z$, $Q$, and transition type, compute $W_0 = 1 + Q/(m_e c^2)$.\n- Implement the integrand $I(W) = p \\, W \\, (W_0 - W)^2 \\, F(Z, W) \\, C(W; \\text{type})$ with $p = \\sqrt{W^2 - 1}$ and $q = W_0 - W$.\n- Implement $F(Z,W)$ as $F = \\frac{2\\pi \\eta}{1 - e^{-2\\pi \\eta}}$ with $\\eta = \\alpha Z \\frac{W}{p}$. To avoid division by zero when $p$ is extremely small, clamp $p$ by replacing it with $p_\\epsilon = \\max(p, \\epsilon)$ in the evaluation of $\\eta$, where $\\epsilon$ is a small positive number such as $\\epsilon = 10^{-12}$. This preserves the correct limiting behavior because $p F$ remains finite.\n- Numerically integrate $I(W)$ over $W \\in [1, W_0]$ using adaptive quadrature with appropriate absolute and relative tolerances. The integrand vanishes at $W = W_0$ due to the $(W_0 - W)^2$ factor; near $W = 1$ the integrand remains finite as argued above.\n- Compute $t_p = t_{1/2}/B$ in seconds and then $\\log_{10} f t$ with base-$10$ logarithm.\n- Apply rounding to six decimal places for final output.\n\nTest suite considerations:\n- Case $1$ tests a general unique first-forbidden transition with moderate $Z$ and $Q$.\n- Case $2$ tests the boundary of low $Q$, where the phase space is severely limited, and checks numerical stability at a short integration range with substantial Coulomb distortion.\n- Case $3$ tests a unique second-forbidden transition at high $Z$, exercising the polynomial shape factor and Coulomb enhancement.\n- Case $4$ provides an allowed transition for comparison to validate that the code reduces to the canonical allowed spectrum shape when $C(W) = 1$.\n\nThe program will compute and print the results as a single line in the format $[\\ell_1,\\ell_2,\\ell_3,\\ell_4]$, where each $\\ell_i$ is the computed $\\log_{10} f t$ for the corresponding case, rounded to six decimal places, ensuring a concise and testable output.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\n\n# Constants\nME_MEV = 0.51099895  # electron rest mass energy in MeV\nALPHA = 1.0 / 137.035999084  # fine-structure constant\n\ndef fermi_function(Z: float, W: float, p: float) -> float:\n    \"\"\"\n    Coulomb Fermi function approximation:\n    F(Z, W) = 2*pi*eta / (1 - exp(-2*pi*eta)), eta = alpha*Z*W/p\n    Uses a small-clamp for p in eta to avoid division by zero at threshold.\n    \"\"\"\n    p_eff = max(p, 1e-12)\n    eta = ALPHA * Z * W / p_eff\n    # For large eta, exp(-2*pi*eta) underflows to 0, which is fine.\n    denom = 1.0 - np.exp(-2.0 * np.pi * eta)\n    # Avoid potential numerical issue if denom is 0 (should not happen for eta > 0)\n    if denom == 0.0:\n        return 2.0 * np.pi * eta\n    return (2.0 * np.pi * eta) / denom\n\ndef shape_factor(W: float, W0: float, p: float, transition_type: str) -> float:\n    \"\"\"\n    Shape factor C(W) for specified transition type:\n    - U0: Allowed, C = 1\n    - U1: Unique first-forbidden, C = p^2 + q^2\n    - U2: Unique second-forbidden, C = p^4 + (10/3) p^2 q^2 + q^4\n    \"\"\"\n    q = W0 - W\n    if transition_type == 'U0':\n        return 1.0\n    elif transition_type == 'U1':\n        return p**2 + q**2\n    elif transition_type == 'U2':\n        return p**4 + (10.0/3.0) * (p**2) * (q**2) + q**4\n    else:\n        raise ValueError(f\"Unsupported transition type: {transition_type}\")\n\ndef phase_space_integral(Z: float, Q_mev: float, transition_type: str) -> float:\n    \"\"\"\n    Compute the dimensionless phase-space factor f(Z, Q; type):\n    f = ∫_{W=1}^{W0} p W (W0 - W)^2 F(Z,W) C(W;type) dW\n    \"\"\"\n    W0 = 1.0 + Q_mev / ME_MEV\n\n    def integrand(W: float) -> float:\n        p = np.sqrt(max(W*W - 1.0, 0.0))\n        q = W0 - W\n        F = fermi_function(Z, W, p)\n        C = shape_factor(W, W0, p, transition_type)\n        return p * W * (q**2) * F * C\n\n    # Integrate with adaptive quadrature. Handle narrow ranges robustly.\n    result, err = quad(integrand, 1.0, W0, epsabs=1e-10, epsrel=1e-8, limit=200)\n    return result\n\ndef logft(Z: float, Q_mev: float, t_half_s: float, branch: float, transition_type: str) -> float:\n    \"\"\"\n    Compute log10(ft) = log10( f(Z,Q;type) * t_p ), t_p = t_half / branch\n    \"\"\"\n    f_val = phase_space_integral(Z, Q_mev, transition_type)\n    t_p = t_half_s / branch\n    # Avoid log of zero if somehow f_val is numerically zero (should not occur for Q>0).\n    ft = max(f_val * t_p, np.finfo(float).tiny)\n    return float(np.log10(ft))\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each tuple: (Z, A, Q [MeV], t_half [s], branch [decimal], transition_type)\n    test_cases = [\n        (26, 59, 1.823, 44.5, 0.85, 'U1'),     # Case 1\n        (50, 115, 0.120, 3.0e7, 1.0, 'U1'),    # Case 2\n        (82, 214, 2.000, 1.0e5, 0.6, 'U2'),    # Case 3\n        (8, 14, 3.000, 70.0, 1.0, 'U0'),       # Case 4\n    ]\n\n    results = []\n    for Z, A, Q_mev, t_half_s, branch, transition_type in test_cases:\n        val = logft(float(Z), float(Q_mev), float(t_half_s), float(branch), transition_type)\n        # Round to six decimal places\n        results.append(f\"{val:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        },
        {
            "introduction": "In this advanced practice, we refine our physical model by scrutinizing the Coulomb correction itself. You will implement a high-precision Fermi function derived from relativistic Dirac wavefunctions and compare its results to the standard non-relativistic approximation. This exercise  highlights the importance of model fidelity and quantifies the impact of relativistic effects on the final $\\log ft$ value, a key consideration in precision studies.",
            "id": "3547446",
            "problem": "Implement a complete and runnable program that computes, to high numerical precision, the statistical rate function (also called the phase-space factor) for nuclear beta decay,\n$$\nf = \\int_{1}^{W_0} p\\,W\\,(W_0 - W)^2\\,F(Z,W)\\,C(W)\\,dW,\n$$\nwhere $W$ is the total charged-lepton energy in units of the electron rest energy $m_e c^2$, $p=\\sqrt{W^2-1}$ is the charged-lepton momentum in the same units, $W_0$ is the endpoint total energy in units of $m_e c^2$, $Z$ is the daughter nuclear charge, $F(Z,W)$ is the Coulomb function that accounts for the distortion of the lepton wavefunction by the nuclear field, and $C(W)$ is the shape factor. Assume allowed transitions so that $C(W)=1$. The goal is to:\n- Compute $f$ using a relativistic Coulomb function $F(Z,W)$ derived from exact Dirac wavefunctions evaluated at the nuclear radius (point-nucleus Coulomb-Dirac solution with finite-size normalization at a sharp-sphere radius).\n- Compute $f$ again using the textbook nonrelativistic Fermi (Gamow) function.\n- Quantify the impact on the comparative half-life quantity $\\log ft$ by reporting $\\Delta \\log ft = \\log_{10} f_{\\mathrm{Dirac}} - \\log_{10} f_{\\mathrm{Gamow}}$, where the partial half-life $t$ cancels in the difference.\n\nFoundational base you must use:\n- Start from Fermi’s Golden Rule for beta decay and the definition of the statistical rate function $f$ as given by the integral above.\n- Use the relativistic Coulomb functions obtained from Dirac wavefunctions in a point-Coulomb field, evaluated at the nuclear radius. You must implement the exact closed-form expression implied by the Dirac-Coulomb solution in terms of the fine-structure constant and Gamma functions, without introducing phenomenological fit formulas.\n- Use the textbook nonrelativistic Gamow factor for the comparison $F(Z,W)$.\n\nDefinitions, units, and constants to be used:\n- Take $W$ and $W_0$ to be dimensionless, in units of $m_e c^2$. The momentum is $p=\\sqrt{W^2-1}$, dimensionless.\n- For beta minus decay ($\\beta^-$), the Coulomb parameter has attractive sign; for beta plus decay ($\\beta^+$), the sign reverses. Use the daughter charge $Z$ in the Coulomb factor.\n- Use the fine-structure constant $\\alpha = 1/137.035999084$.\n- Use a sharp-sphere nuclear radius $R = r_0 A^{1/3}$ with $r_0 = 1.2\\,\\mathrm{fm}$. Convert $R$ to dimensionless units by dividing by the electron Compton wavelength $\\lambda_C \\approx 386.1592676\\,\\mathrm{fm}$ so that $R$ is used in the Dirac-Coulomb factor in units of the electron Compton wavelength.\n- Assume $C(W)=1$ for all energies $W$.\n\nHigh-precision numerical requirements:\n- Evaluate the integral for $f$ with absolute tolerance below $10^{-12}$ and relative tolerance below $10^{-9}$.\n- Ensure numerical stability near the threshold $W \\to 1$ and for large $Z$.\n- The functions $F(Z,W)$ for the Dirac case and for the Gamow case must be implemented in a numerically stable way across the integration domain.\n\nTest suite to implement and compute:\n- Each test case is a tuple $(Z,A,W_0,\\mathrm{polarity})$ where $\\mathrm{polarity}$ is either $\\beta^-$ or $\\beta^+$, and $C(W)=1$.\n- Use the following scientifically reasonable and diverse cases:\n    1. $(Z,A,W_0,\\mathrm{polarity}) = (26,60,4.0,\\beta^-)$\n    2. $(Z,A,W_0,\\mathrm{polarity}) = (82,214,2.5,\\beta^-)$\n    3. $(Z,A,W_0,\\mathrm{polarity}) = (28,58,2.2,\\beta^+)$\n    4. $(Z,A,W_0,\\mathrm{polarity}) = (8,16,1.1,\\beta^-)$\n    5. $(Z,A,W_0,\\mathrm{polarity}) = (20,40,10.0,\\beta^-)$\n\nFor each test case, compute:\n- $f_{\\mathrm{Dirac}}$, using the relativistic Coulomb function from Dirac wavefunctions.\n- $f_{\\mathrm{Gamow}}$, using the textbook nonrelativistic Gamow factor.\n- $\\Delta \\log ft = \\log_{10} f_{\\mathrm{Dirac}} - \\log_{10} f_{\\mathrm{Gamow}}$.\n\nFinal output format:\n- Your program must produce a single line of output containing the results as a comma-separated list of triplets enclosed in square brackets, one triplet per test case, in the same order as specified, where each triplet is itself a square-bracketed, comma-separated list $[f_{\\mathrm{Dirac}},f_{\\mathrm{Gamow}},\\Delta \\log ft]$.\n- All floats must be rendered with exactly eight digits after the decimal point.\n- For example, your output must look like\n$$\n[[x_1,y_1,z_1],[x_2,y_2,z_2],[x_3,y_3,z_3],[x_4,y_4,z_4],[x_5,y_5,z_5]]\n$$\nwith no extra whitespace or text.\n\nScientific realism and constraints:\n- All computations must be performed using the definitions above. The statistical rate function $f$ is dimensionless; report all values as pure numbers without units.\n- The program must be self-contained, must not read any input, and must use the provided test suite verbatim.",
            "solution": "The problem requires the computation of the statistical rate function, or phase-space factor, $f$, for nuclear beta decay for a set of test cases. This computation must be performed using two different models for the Coulomb correction function, $F(Z,W)$: a sophisticated relativistic model based on Dirac wavefunctions and a simpler non-relativistic Gamow factor. The goal is to quantify the difference in the resulting comparative half-life, $\\log ft$, arising from these two models.\n\nThe statistical rate function $f$ is defined by the integral:\n$$\nf = \\int_{1}^{W_0} p\\,W\\,(W_0 - W)^2\\,F(Z,W)\\,C(W)\\,dW\n$$\nThe components of the integrand are defined as follows:\n- $W$ is the total energy of the emitted lepton ($\\beta^-$ or $\\beta^+$) in units of the electron rest mass energy, $m_e c^2$.\n- $W_0$ is the maximum possible energy for the lepton, also in units of $m_e c^2$. It is determined by the $Q$-value of the decay.\n- $p = \\sqrt{W^2-1}$ is the lepton's momentum, in units of $m_e c$.\n- $Z$ is the charge number of the daughter nucleus.\n- $F(Z,W)$ is the Coulomb function (or Fermi function), which corrects for the distortion of the lepton's wavefunction by the Coulomb field of the daughter nucleus.\n- $C(W)$ is the shape factor, which depends on the nuclear matrix elements. For allowed transitions, as assumed here, $C(W)=1$.\n\nThe integral for $f$ runs from the minimum possible lepton energy ($W=1$, corresponding to zero kinetic energy) to the maximum energy ($W=W_0$). The evaluation will be performed using numerical quadrature.\n\nThe core of the problem lies in implementing the two specified forms of $F(Z,W)$.\n\n**1. The Non-relativistic Gamow Factor, $F_{\\mathrm{Gamow}}(Z,W)$**\n\nThis is the textbook approximation for the Coulomb correction, derived in non-relativistic quantum mechanics. It is given by:\n$$\nF_{\\mathrm{Gamow}}(Z,W) = \\frac{2\\pi\\eta}{1 - e^{-2\\pi\\eta}}\n$$\nwhere $\\eta$ is the Sommerfeld parameter, defined as:\n$$\n\\eta = \\frac{Z_{\\mathrm{eff}}\\alpha W}{p} = \\frac{Z_{\\mathrm{eff}}\\alpha W}{\\sqrt{W^2-1}}\n$$\n- $\\alpha \\approx 1/137.036$ is the fine-structure constant.\n- $Z_{\\mathrm{eff}}$ is the effective charge experienced by the lepton. For $\\beta^-$ decay (electron emission), the Coulomb force is attractive, so we use the daughter charge, $Z_{\\mathrm{eff}}=Z$. For $\\beta^+$ decay (positron emission), the force is repulsive, so we use $Z_{\\mathrm{eff}}=-Z$.\n\nA key numerical consideration is the behavior of this function. As $W \\to 1$, $p \\to 0$, causing $|\\eta| \\to \\infty$.\n- For $\\beta^-$ decay ($Z_{\\mathrm{eff}}>0$), $\\eta \\to +\\infty$. In this limit, $e^{-2\\pi\\eta} \\to 0$ and $F_{\\mathrm{Gamow}} \\approx 2\\pi\\eta \\propto 1/p$. The integrand term $p \\cdot F_{\\mathrm{Gamow}}$ thus approaches a finite constant.\n- For $\\beta^+$ decay ($Z_{\\mathrm{eff}}<0$), $\\eta \\to -\\infty$. In this limit, $F_{\\mathrm{Gamow}} \\approx -2\\pi\\eta \\, e^{2\\pi\\eta}$, which rapidly approaches $0$. The integrand is zero at $W=1$.\nFor $\\eta \\to 0$ (which would occur if $Z=0$), a Taylor expansion shows $F_{\\mathrm{Gamow}} \\to 1$.\n\n**2. The Relativistic Dirac-Coulomb Factor, $F_{\\mathrm{Dirac}}(Z,W)$**\n\nThis provides a much more accurate description by using solutions to the Dirac equation for a lepton in a Coulomb potential. The problem specifies a standard formulation that includes a correction for the finite size of the nucleus by evaluating the wavefunction solutions at the nuclear surface. The expression is:\n$$\nF_{\\mathrm{Dirac}}(Z,W) = 2(1+\\gamma_1) (2pR')^{2(\\gamma_1-1)} \\frac{|\\Gamma(\\gamma_1 + i y)|^2}{(\\Gamma(2\\gamma_1 + 1))^2} e^{\\pi y}\n$$\nThe parameters in this formula are:\n- $y = \\eta = \\frac{Z_{\\mathrm{eff}}\\alpha W}{p}$.\n- $\\gamma_1 = \\sqrt{1 - (\\alpha Z)^2}$. Here, $Z$ is the magnitude of the daughter charge. This parameter is real for all known nuclei ($Z \\le 118$).\n- $R'$ is the nuclear radius in dimensionless units, obtained by dividing the physical radius $R$ by the electron Compton wavelength, $\\lambda_C \\approx 386.159\\,\\mathrm{fm}$. The physical radius $R$ is calculated using the sharp-sphere model: $R = r_0 A^{1/3}$, with $r_0 = 1.2\\,\\mathrm{fm}$ and $A$ being the mass number of the daughter nucleus.\n- $\\Gamma(z)$ is the complex Gamma function. The term $|\\Gamma(\\gamma_1 + i y)|^2$ requires evaluation of the Gamma function for a complex argument.\n\nThe numerical behavior of $F_{\\mathrm{Dirac}}$ as $W \\to 1$ ($p \\to 0$) is crucial. Since $\\gamma_1 < 1$, the exponent $2(\\gamma_1-1)$ is negative. The term $(2pR')^{2(\\gamma_1-1)}$ diverges as $p \\to 0$. Using the asymptotic behavior of the complex Gamma function, $|\\Gamma(x+iy)|^2 \\approx 2\\pi |y|^{2x-1}e^{-\\pi|y|}$ for large $|y|$, it can be shown that $F_{\\mathrm{Dirac}} \\propto 1/p$. Similar to the Gamow case, the factor of $p$ in the integrand cancels this singularity, leading to a finite value at the integration boundary $W=1$. This ensures the integral is well-behaved and can be computed accurately with a standard numerical quadrature library such as `scipy.integrate.quad`.\n\n**3. Algorithmic Implementation and Calculation**\n\nThe solution will be implemented in Python using the `numpy` and `scipy` libraries. The overall algorithm is as follows:\n1. Define the physical constants: $\\alpha$, $r_0$, $\\lambda_C$.\n2. For each test case $(Z, A, W_0, \\mathrm{polarity})$:\n   a. Determine $Z_{\\mathrm{eff}}$ based on the decay polarity.\n   b. Define two integrand functions, one using $F_{\\mathrm{Gamow}}$ and the other using $F_{\\mathrm{Dirac}}$. These functions take $W$ as the integration variable and the case parameters ($Z, A, W_0$, etc.) as arguments.\n   c. Use `scipy.integrate.quad` to compute the integral for $f_{\\mathrm{Gamow}}$ from $W=1$ to $W=W_0$. The specified high precision tolerances (`epsabs=1e-12`, `epsrel=1e-9`) will be used.\n   d. Similarly, compute the integral for $f_{\\mathrm{Dirac}}$. The implementation of $F_{\\mathrm{Dirac}}$ requires `scipy.special.gamma` for complex arguments.\n   e. Compute the final quantity $\\Delta \\log ft = \\log_{10}(f_{\\mathrm{Dirac}}) - \\log_{10}(f_{\\mathrm{Gamow}})$. This quantity is a direct measure of the relativistic and finite-size effects on the extracted $ft$ value.\n3. Collate the computed triplets $[f_{\\mathrm{Dirac}}, f_{\\mathrm{Gamow}}, \\Delta \\log ft]$ for all test cases.\n4. Format the final results into a single string as specified: a list of triplets, with each number formatted to eight decimal places, and print it to standard output.\nThis structured approach ensures that all physical and numerical requirements of the problem are met, yielding a precise and verifiable result.",
            "answer": "```python\nimport numpy as np\nfrom scipy import integrate\nfrom scipy import special\n\n# Set up constants based on the problem statement.\nALPHA = 1 / 137.035999084\nR0_FM = 1.2\nLAMBDA_C_FM = 386.1592676\n\ndef F_gamow(W, Z_eff):\n    \"\"\"\n    Computes the non-relativistic Gamow factor.\n    \"\"\"\n    # For Z_eff = 0, F should be 1. The formula handles this limit.\n    if Z_eff == 0:\n        return 1.0\n\n    # The integrand p * F has a finite limit at W=1, so we do not need special handling here,\n    # as scipy.integrate.quad can handle integrable singularities at endpoints.\n    # We must avoid division by zero if W=1 is ever passed directly.\n    if W == 1.0:\n        return np.inf if Z_eff > 0 else 0.0\n\n    p = np.sqrt(W**2 - 1)\n    if p == 0:\n        return np.inf if Z_eff > 0 else 0.0\n\n    eta = Z_eff * ALPHA * W / p\n    x = 2 * np.pi * eta\n\n    # For small x, use Taylor series expansion to avoid 0/0.\n    # x / (1 - exp(-x)) -> 1 + x/2 + ...\n    if abs(x) < 1e-8:\n        return 1.0\n    \n    # Standard formula\n    return x / (1 - np.exp(-x))\n\ndef F_dirac(W, Z_daughter, Z_eff, A):\n    \"\"\"\n    Computes the relativistic Dirac-Coulomb factor.\n    \"\"\"\n    if Z_daughter == 0:\n        return 1.0\n\n    # The integrand p * F has a finite limit at W=1.\n    if W == 1.0:\n        return np.inf\n\n    p = np.sqrt(W**2 - 1)\n    if p == 0:\n        return np.inf\n\n    # Dimensionless nuclear radius\n    R_prime = (R0_FM * A**(1/3)) / LAMBDA_C_FM\n    \n    az_sq = (ALPHA * Z_daughter)**2\n    # This check is for robustness; not expected for test cases.\n    if az_sq >= 1.0:\n      raise ValueError(\"Invalid Z: (alpha*Z)^2 >= 1\")\n    gamma1 = np.sqrt(1.0 - az_sq)\n    \n    # Sommerfeld-like parameter for the Dirac case\n    y = Z_eff * ALPHA * W / p\n\n    # Evaluate the components of the F_dirac formula\n    term1 = 2 * (1 + gamma1)\n    term2 = (2 * p * R_prime)**(2 * (gamma1 - 1))\n    \n    # Gamma function terms. scipy.special.gamma handles complex args.\n    g_complex_arg = gamma1 + 1j * y\n    g_complex = special.gamma(g_complex_arg)\n    abs_g_sq = np.real(g_complex)**2 + np.imag(g_complex)**2\n    \n    g_real_arg = 2 * gamma1 + 1\n    g_real = special.gamma(g_real_arg)\n    \n    term3 = abs_g_sq / (g_real**2)\n    term4 = np.exp(np.pi * y)\n    \n    return term1 * term2 * term3 * term4\n\ndef solve():\n    \"\"\"\n    Main solver function to compute and print results for all test cases.\n    \"\"\"\n    # Test suite as specified in the problem statement\n    test_cases = [\n        # (Z_daughter, A_daughter, W0, polarity)\n        (26, 60, 4.0, 'beta-'),\n        (82, 214, 2.5, 'beta-'),\n        (28, 58, 2.2, 'beta+'),\n        (8, 16, 1.1, 'beta-'),\n        (20, 40, 10.0, 'beta-'),\n    ]\n\n    results = []\n    \n    # Numerical integration tolerances\n    epsabs = 1e-12\n    epsrel = 1e-9\n\n    for case in test_cases:\n        Z_daughter, A, W0, polarity = case\n        Z_eff = Z_daughter if polarity == 'beta-' else -Z_daughter\n\n        # Integrand using the Gamow factor\n        def integrand_gamow(W, Z_eff, W0):\n            if W <= 1.0 or W >= W0: return 0.0\n            p = np.sqrt(W**2 - 1)\n            F = F_gamow(W, Z_eff)\n            return p * W * (W0 - W)**2 * F\n        \n        # Integrand using the Dirac factor\n        def integrand_dirac(W, Z_daughter, Z_eff, A, W0):\n            if W <= 1.0 or W >= W0: return 0.0\n            p = np.sqrt(W**2 - 1)\n            F = F_dirac(W, Z_daughter, Z_eff, A)\n            return p * W * (W0 - W)**2 * F\n\n        # Perform numerical integration for both models\n        f_gamow, _ = integrate.quad(integrand_gamow, 1, W0, args=(Z_eff, W0), epsabs=epsabs, epsrel=epsrel)\n        f_dirac, _ = integrate.quad(integrand_dirac, 1, W0, args=(Z_daughter, Z_eff, A, W0), epsabs=epsabs, epsrel=epsrel)\n        \n        # Calculate the difference in log(ft)\n        delta_log_ft = np.log10(f_dirac) - np.log10(f_gamow)\n        \n        results.append([f_dirac, f_gamow, delta_log_ft])\n        \n    # Format the output as per the problem specification\n    results_as_strings = [\n        f\"[{res[0]:.8f},{res[1]:.8f},{res[2]:.8f}]\" for res in results\n    ]\n    \n    print(f\"[{','.join(results_as_strings)}]\")\n\nsolve()\n```"
        }
    ]
}