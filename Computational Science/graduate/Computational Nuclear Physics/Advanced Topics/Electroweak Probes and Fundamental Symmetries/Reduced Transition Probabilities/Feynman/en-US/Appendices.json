{
    "hands_on_practices": [
        {
            "introduction": "This first practice connects the macroscopic concept of a nuclear transition density to the observable reduced transition probability, $B(E\\lambda)$. You will derive the fundamental integral relationship that links the multipole operator to a radial transition density, $\\delta\\rho_\\lambda(r)$, and then implement a numerical solution to compute the transition strength . This exercise provides a foundational understanding of how the collective redistribution of charge during a nuclear excitation determines its electromagnetic strength and introduces robust numerical quadrature methods for the types of integrals encountered in nuclear theory.",
            "id": "3585886",
            "problem": "You are given a computational task rooted in electromagnetic transitions in atomic nuclei. Start from the definition of the electric multipole operator and the reduced matrix element to establish how the reduced transition probability for an electric multipole of order $\\lambda$, denoted $B(E\\lambda)$, can be expressed in terms of a radial transition density. Treat the nuclear system as spherically symmetric and focus on the scalar (radial) content of the transition density. From first principles, derive the expression that isolates the purely radial contribution by integrating over the angles, and show that the numerical evaluation of the reduced transition probability amounts to computing a single radial integral of the transition density weighted by an appropriate power of the radius.\n\nYou must then implement a program to numerically evaluate the reduced transition probability $B(E\\lambda)$ for a set of prescribed test cases by performing the required radial integral over $r \\in [0,\\infty)$. The transition density $\\delta\\rho_\\lambda(r)$ has the physical dimension of $\\text{fm}^{-3}$, and the integral must be performed over the radial coordinate $r$ expressed in $\\text{fm}$. The resulting $B(E\\lambda)$ must be expressed in units of $e^2\\,\\text{fm}^{2\\lambda}$, with the understanding that the numerical values reported are in $\\text{fm}^{2\\lambda}$ and the factor $e^2$ is implicit. Angles, if any appear in intermediate derivations, must be in radians and fully integrated out in the radial reduction. Your numerical outputs must be reported as floats, and your program must produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[x_1,x_2,x_3]$).\n\nYour implementation must address the numerical quadrature over an infinite interval and the weight $r^{\\lambda+2}$ multiplying the transition density. Discuss, in your solution, algorithmic choices for numerical quadrature that are robust for decaying, slowly decaying, and mildly oscillatory transition densities, including potential cancellation errors and step-size control. You must ensure scientific realism by choosing physically plausible functions for $\\delta\\rho_\\lambda(r)$ that are regular at the origin and integrable at infinity.\n\nTest Suite:\nEvaluate $B(E\\lambda)$ for the following four cases. For each case, use the specified parameters. All radii $r$ are in $\\text{fm}$; any wavenumber $k$ is in $\\text{fm}^{-1}$.\n\n- Case A (general, decaying density): $\\lambda=2$, $\\delta\\rho_\\lambda(r) = \\rho_0 \\exp(-r/a)$ with $\\rho_0 = 0.02$ and $a = 1.2$.\n- Case B (boundary condition with $\\lambda=0$): $\\lambda=0$, $\\delta\\rho_\\lambda(r) = \\rho_0 \\exp(-r/a)$ with $\\rho_0 = 0.02$ and $a = 1.2$.\n- Case C (oscillatory, damped density): $\\lambda=3$, $\\delta\\rho_\\lambda(r) = \\rho_0 j_0(k r)\\exp(-r/R)$ with $\\rho_0 = 0.01$, $k = 1.0$, and $R=5.0$, where $j_0(x)$ is the spherical Bessel function $j_0(x)=\\sin(x)/x$ with $j_0(0)=1$.\n- Case D (slowly decaying algebraic tail): $\\lambda=1$, $\\delta\\rho_\\lambda(r) = \\rho_0 \\left(1+(r/R)^6\\right)^{-1}$ with $\\rho_0 = 0.03$ and $R=3.0$.\n\nFor each case, your program must compute the quantity obtained by the radial integral over $r$ and then square its absolute value to produce $B(E\\lambda)$, reported as a float in $\\text{fm}^{2\\lambda}$. Your program may use any scientifically sound numerical quadrature method suitable for $[0,\\infty)$ that ensures convergence with controlled error tolerances. The final output must be a single line showing the four results in order A, B, C, D, formatted as $[B_A,B_B,B_C,B_D]$, with each $B$ a float.\n\nYour derivation must begin from the following foundations:\n- The electric multipole operator of rank $\\lambda$ built from the charge density.\n- The reduced matrix element definition and the Wigner–Eckart theorem to separate angular and radial contributions.\n- The definition of the radial transition density consistent with spherical symmetry and regularity at the origin.\n\nDo not quote or assume any pre-derived target formula for $B(E\\lambda)$; derive it from these bases. Then implement the computational evaluation faithful to the derived radial integral. Explicitly state and justify your numerical quadrature strategy and discuss possible numerical issues, such as behavior near $r=0$, the infinite upper limit, oscillatory integrands, cancellation, and adaptive tolerance selection.\n\nYour program must produce only the single line in the required format. No other text should be printed. The numerical outputs must be floats representing $B(E\\lambda)$ in $\\text{fm}^{2\\lambda}$.",
            "solution": "The problem requires the derivation of the formula for the reduced electric transition probability, $B(E\\lambda)$, in terms of a radial transition density, and its subsequent numerical evaluation for several test cases. The derivation must start from fundamental definitions in nuclear physics.\n\n### Derivation of the $B(E\\lambda)$ Formula\n\nThe reduced transition probability $B(E\\lambda)$ quantifies the likelihood of a nucleus undergoing an electromagnetic transition of electric character and multipolarity $\\lambda$ between an initial state $|J_i M_i\\rangle$ and a final state $|J_f M_f\\rangle$.\n\n1.  **Electric Multipole Operator**: The process is driven by the interaction of the electromagnetic field with the nuclear charge distribution. In the long-wavelength approximation, this interaction is described by a set of multipole operators. The electric multipole operator of rank $\\lambda$ and projection $\\mu$, $\\hat{O}(E\\lambda, \\mu)$, is defined in terms of the nuclear charge density operator, $\\hat{\\rho}(\\vec{r})$:\n    $$\n    \\hat{O}(E\\lambda, \\mu) = \\int \\hat{\\rho}(\\vec{r}) r^\\lambda Y_{\\lambda\\mu}(\\hat{r}) \\, d^3r\n    $$\n    Here, $\\vec{r}$ is the position vector from the center of the nucleus, $r=|\\vec{r}|$, $\\hat{r}=\\vec{r}/r$, and $Y_{\\lambda\\mu}(\\hat{r})$ are the spherical harmonics. The operator is expressed in units of charge times length$^\\lambda$ (e.g., $e \\cdot \\text{fm}^\\lambda$).\n\n2.  **Reduced Transition Probability and the Wigner-Eckart Theorem**: The strength of the transition is independent of the magnetic substate orientations. The reduced transition probability, $B(E\\lambda)$, captures this intrinsic strength. For a transition from an initial state of total angular momentum $J_i$ to a final state $J_f$, it is defined as:\n    $$\n    B(E\\lambda; J_i \\to J_f) = \\frac{1}{2J_i+1} |\\langle J_f || \\hat{O}(E\\lambda) || J_i \\rangle|^2\n    $$\n    This definition utilizes the reduced matrix element, $\\langle J_f || \\hat{O}(E\\lambda) || J_i \\rangle$, which contains the dynamics of the transition, separated from the geometric aspects by the Wigner-Eckart theorem. The charge $e$ is implicitly included in the operator, so the units of $B(E\\lambda)$ are $e^2 \\cdot \\text{fm}^{2\\lambda}$.\n\n3.  **Introduction of the Radial Transition Density**: The core of the problem is to relate the reduced matrix element to a radial integral. The matrix element of the operator $\\hat{O}(E\\lambda, \\mu)$ is:\n    $$\n    \\langle J_f M_f | \\hat{O}(E\\lambda, \\mu) | J_i M_i \\rangle = \\int \\langle J_f M_f | \\hat{\\rho}(\\vec{r}) | J_i M_i \\rangle r^\\lambda Y_{\\lambda\\mu}(\\hat{r}) \\, d^3r\n    $$\n    The term $\\langle J_f M_f | \\hat{\\rho}(\\vec{r}) | J_i M_i \\rangle$ is the transition charge density, $\\rho_{tr}(\\vec{r})$. In a spherically symmetric system, this density can be expanded in a basis of spherical harmonics. For a transition of a definite multipolarity $\\lambda$ connecting states $|J_i\\rangle$ and $|J_f\\rangle$, the transition density's angular structure is determined by the coupling of these angular momenta. The radial dependence is encapsulated in a function known as the radial transition density.\n    \n    The problem provides a single radial function, $\\delta\\rho_\\lambda(r)$, which is defined as the radial part of the transition density specific to multipolarity $\\lambda$. This is a standard practice in nuclear models, where $\\delta\\rho_\\lambda(r)$ is defined such that the reduced matrix element of the multipole operator is given directly by the following radial integral:\n    $$\n    \\langle J_f || \\hat{O}(E\\lambda) || J_i \\rangle = \\int_0^\\infty \\delta\\rho_\\lambda(r) r^\\lambda r^2 \\, dr = \\int_0^\\infty \\delta\\rho_\\lambda(r) r^{\\lambda+2} \\, dr\n    $$\n    This relation arises from formally carrying out the angular integration in the expression for the matrix element, which projects out the component of the correct multipolarity. The Wigner-Eckart theorem and properties of spherical tensor products ensure that for a given transition, only one such radial integral contributes.\n\n4.  **Final Expression for Numerical Computation**: Combining the definition of $B(E\\lambda)$ with the integral form of the reduced matrix element, we have:\n    $$\n    B(E\\lambda; J_i \\to J_f) = \\frac{1}{2J_i+1} \\left| \\int_0^\\infty \\delta\\rho_\\lambda(r) r^{\\lambda+2} \\, dr \\right|^2\n    $$\n    The problem simplifies the context by asking for the evaluation of the squared absolute value of the radial integral itself, implying that the geometric factor $(2J_i+1)^{-1}$ is either unity (e.g., for transitions from a $J_i=0$ state) or is conceptually absorbed into the definition of the quantity being computed. Therefore, the quantity to be calculated is:\n    $$\n    B(E\\lambda) = \\left| \\int_0^\\infty \\delta\\rho_\\lambda(r) r^{\\lambda+2} \\, dr \\right|^2\n    $$\n    The units are checked to be consistent: $\\delta\\rho_\\lambda(r)$ has units of $\\text{fm}^{-3}$, and $r$ is in $\\text{fm}$. The integrand, $\\delta\\rho_\\lambda(r) r^{\\lambda+2}$, has units of $\\text{fm}^{-3} \\cdot \\text{fm}^{\\lambda+2} = \\text{fm}^{\\lambda-1}$. The integral over $dr$ yields a result in $\\text{fm}^{\\lambda-1} \\cdot \\text{fm} = \\text{fm}^{\\lambda}$. Squaring this result gives units of $\\text{fm}^{2\\lambda}$, which matches the numerical part of the required units $e^2\\,\\text{fm}^{2\\lambda}$.\n\n### Numerical Quadrature Strategy\n\nThe task reduces to computing the integral $I_\\lambda = \\int_0^\\infty \\delta\\rho_\\lambda(r) r^{\\lambda+2} \\, dr$ for each specified case. We will use the `scipy.integrate.quad` function, a robust numerical quadrature routine based on the QUADPACK library.\n\n1.  **Infinite Interval**: The `quad` function natively supports infinite integration limits. It employs a variable transformation to map the interval $[0, \\infty)$ to a finite one, typically $[0, 1)$, e.g., via $r = t/(1-t)$. Standard adaptive quadrature techniques (like Gauss-Kronrod) are then applied to the transformed integral. This approach is effective for integrands that decay sufficiently fast as $r \\to \\infty$, a condition met by all test cases.\n2.  **Integrand Behavior**:\n    -   **Near $r=0$**: For all cases, the provided transition densities $\\delta\\rho_\\lambda(r)$ are regular (finite) at $r=0$. The overall integrand is of the form $\\delta\\rho_\\lambda(r) r^{\\lambda+2}$. Since $\\lambda \\geq 0$ for all cases, the term $r^{\\lambda+2}$ ensures that the integrand smoothly goes to zero as $r \\to 0$, posing no numerical difficulty.\n    -   **As $r \\to \\infty$**:\n        -   Cases A and B have exponential decay, $\\exp(-r/a)$, which is handled very efficiently by `quad`.\n        -   Case C includes a damped oscillatory term, $j_0(kr)\\exp(-r/R)$. The exponential damping ensures the oscillations die out, preventing issues with convergence. The adaptive nature of `quad` will automatically increase the density of evaluation points in the oscillatory region to maintain accuracy. While there is a potential for cancellation error if the positive and negative lobes of the integrand are nearly equal, the strong damping makes this unlikely to be a significant problem.\n        -   Case D has an algebraic (power-law) tail, $(1+(r/R)^6)^{-1} \\sim r^{-6}$. The integrand behaves as $r^{-6} \\cdot r^{1+2} = r^{-3}$ for large $r$. Since the exponent is less than $-1$, the integral converges, and `quad`'s algorithm for infinite intervals is well-suited for this type of decay.\n3.  **Accuracy and Error Control**: The `quad` function provides adaptive subdivision of the integration interval to achieve specified absolute and relative error tolerances (`atol` and `rtol`). We will rely on the default tolerances, which are generally sufficient for the precision required in typical physics problems. The function also returns an estimate of the absolute error, which could be used to verify the quality of the result.\n\nThis strategy is robust and applicable to all the varied forms of transition densities provided in the test suite.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\nfrom scipy.special import spherical_jn\n\ndef solve():\n    \"\"\"\n    Derives and computes the reduced transition probability B(Eλ)\n    for a set of test cases based on a radial transition density.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a dictionary with parameters for lambda and the transition density.\n    test_cases = [\n        {\n            \"case_id\": \"A\",\n            \"lambda\": 2,\n            \"density_func\": lambda r, p: p['rho0'] * np.exp(-r / p['a']),\n            \"params\": {\"rho0\": 0.02, \"a\": 1.2}\n        },\n        {\n            \"case_id\": \"B\",\n            \"lambda\": 0,\n            \"density_func\": lambda r, p: p['rho0'] * np.exp(-r / p['a']),\n            \"params\": {\"rho0\": 0.02, \"a\": 1.2}\n        },\n        {\n            \"case_id\": \"C\",\n            \"lambda\": 3,\n            \"density_func\": lambda r, p: p['rho0'] * spherical_jn(0, p['k'] * r) * np.exp(-r / p['R']),\n            \"params\": {\"rho0\": 0.01, \"k\": 1.0, \"R\": 5.0} \n        },\n        {\n            \"case_id\": \"D\",\n            \"lambda\": 1,\n            \"density_func\": lambda r, p: p['rho0'] / (1 + (r / p['R'])**6),\n            \"params\": {\"rho0\": 0.03, \"R\": 3.0}\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        lam = case[\"lambda\"]\n        density_func = case[\"density_func\"]\n        params = case[\"params\"]\n\n        # The integrand for the radial integral is δρ_λ(r) * r^(λ+2)\n        integrand = lambda r: density_func(r, params) * (r**(lam + 2))\n\n        # Perform the numerical quadrature over r from 0 to infinity.\n        # quad returns a tuple (integral_value, estimated_error).\n        # We only need the integral value.\n        radial_integral_val, _ = quad(integrand, 0, np.inf)\n\n        # The reduced transition probability B(Eλ) is the square of the\n        # absolute value of this radial integral.\n        # The units are implicitly e^2 fm^(2λ).\n        b_e_lambda = np.abs(radial_integral_val)**2\n        \n        results.append(b_e_lambda)\n\n    # Final print statement in the exact required format.\n    # The output format is a single line with a comma-separated list of floats\n    # enclosed in square brackets.\n    print(f\"[{','.join(f'{r:.7f}' for r in results)}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "Building on the concept of transition strength, this exercise delves into the microscopic origins of nuclear transitions within the configuration-interaction shell model. You will derive and implement the procedure for calculating $B(E2)$ values from their fundamental building blocks: One-Body Transition Densities (OBTDs) and single-particle matrix elements, scaled by effective charges to account for model space truncations . This practice is central to understanding how complex many-body observables are computationally assembled and interpreted in modern nuclear structure calculations.",
            "id": "3585971",
            "problem": "Consider a nonrelativistic nuclear many-body system described within the configuration-interaction shell model. The electric quadrupole transition operator of rank $L$ between many-body states is built from one-body operators acting on single-nucleon orbitals, differentiated by proton and neutron subspaces and scaled by effective charges to account for missing correlations. In a computational setting, the reduced transition probability for an electric multipole transition of rank $L$ between an initial state with angular momentum $J_i$ and a final state with angular momentum $J_f$ is defined in terms of a many-body reduced matrix element, and the latter can be assembled from one-body building blocks and effective charges. Your task is to derive, from first principles, how to compute the reduced transition probability $B(EL; J_i \\rightarrow J_f)$ using the Wigner–Eckart theorem, second quantization with one-body operators, and a decomposition of the many-body reduced matrix element in terms of One-Body Transition Densities (OBTDs) and single-particle reduced matrix elements, then implement the resulting expression in code to evaluate a specified test suite.\n\nUse the following fundamental starting points only:\n- The Wigner–Eckart theorem for spherical tensor operators of rank $L$ acting between angular momentum eigenstates.\n- The definition of a reduced transition probability $B(EL; J_i \\rightarrow J_f)$ in terms of reduced matrix elements.\n- The structure of one-body operators in second quantization and their action on many-body states.\n- The concept of effective charges $e_p$ and $e_n$ entering the definition of the electric multipole operator as proton and neutron weighted sums, respectively.\n\nYou must not assume or use any pre-quoted final computational formulae that explicitly express $B(EL)$ in terms of the quantities below; instead, you must derive the computational expression starting from the fundamental principles listed above.\n\nIn the provided computational model, the inputs are:\n- The initial and final angular momenta $J_i$ and $J_f$.\n- The operator rank $L$, here fixed to the electric quadrupole case $L = 2$.\n- The proton effective charge $e_p$ and the neutron effective charge $e_n$ (dimensionless multipliers).\n- For protons and neutrons separately, lists of terms. Each term consists of an OBTD value and a corresponding single-particle reduced matrix element of the electric multipole operator of rank $L$, already including angular-momentum reduction on the single-particle space. An OBTD is a scalar coefficient that encodes the many-body structure change due to creating a particle in one orbital and annihilating it in another, reduced to rank $L$. The single-particle reduced matrix element associated to a term is given in units of $\\mathrm{fm}^L$, here $\\mathrm{fm}^2$ for $L=2$.\n\nThe output you must produce is the reduced transition probability values $B(E2; J_i \\rightarrow J_f)$, in units of $e^2\\,\\mathrm{fm}^4$, for each of the following test cases. Each test case is fully specified by:\n- $J_i$, $J_f$\n- $e_p$, $e_n$\n- A list of proton terms $\\{(\\text{OBTD}_p^{(k)}, \\text{SPME}_p^{(k)})\\}$ where each single-particle reduced matrix element $\\text{SPME}$ is in $\\mathrm{fm}^2$.\n- A list of neutron terms $\\{(\\text{OBTD}_n^{(k)}, \\text{SPME}_n^{(k)})\\}$ where each single-particle reduced matrix element $\\text{SPME}$ is in $\\mathrm{fm}^2$.\n\nCompute $B(E2)$ for the following five cases, ensuring numerical stability and correct handling of signs:\n\n- Case $1$ (single-species, single-term proton-only):\n  - $J_i = 2$, $J_f = 0$, $L = 2$\n  - $e_p = 1.5$, $e_n = 0.5$\n  - Proton terms: $\\{(0.8, 5.0)\\}$\n  - Neutron terms: $\\{\\}$\n\n- Case $2$ (both species, multi-term):\n  - $J_i = 4$, $J_f = 2$, $L = 2$\n  - $e_p = 1.5$, $e_n = 0.5$\n  - Proton terms: $\\{(0.25, 6.0), (0.10, 4.0)\\}$\n  - Neutron terms: $\\{(0.40, 5.0), (0.15, 3.0)\\}$\n\n- Case $3$ (destructive interference via signs):\n  - $J_i = 2$, $J_f = 2$, $L = 2$\n  - $e_p = 1.5$, $e_n = 0.5$\n  - Proton terms: $\\{(0.50, 7.0), (0.20, -2.0)\\}$\n  - Neutron terms: $\\{(-0.80, 6.0)\\}$\n\n- Case $4$ (boundary with zero One-Body Transition Densities):\n  - $J_i = 6$, $J_f = 4$, $L = 2$\n  - $e_p = 1.5$, $e_n = 0.5$\n  - Proton terms: $\\{(0.0, 10.0), (0.0, -7.0)\\}$\n  - Neutron terms: $\\{\\}$\n\n- Case $5$ (boundary with $J_i = 0$ so the statistical factor is unity):\n  - $J_i = 0$, $J_f = 2$, $L = 2$\n  - $e_p = 1.5$, $e_n = 0.5$\n  - Proton terms: $\\{(-0.30, 8.0)\\}$\n  - Neutron terms: $\\{(0.20, 6.0)\\}$\n\nRequirements:\n- Derive the computational expression for $B(E2; J_i \\rightarrow J_f)$ from the fundamental principles listed above, explicitly showing the steps connecting the one-body operator structure, One-Body Transition Densities, and effective charges to the many-body reduced matrix element.\n- Implement the derived expression as a complete, runnable program that evaluates all five cases.\n- Express each final result in units of $e^2\\,\\mathrm{fm}^4$, rounded to exactly $6$ decimal places.\n- Final Output Format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, $\\left[\\text{result}_1,\\text{result}_2,\\text{result}_3\\right]$).",
            "solution": "The problem requires the derivation and implementation of a formula for the reduced transition probability, $B(E2; J_i \\rightarrow J_f)$, in the context of the nuclear shell model. The derivation must begin from fundamental principles: the definition of $B(EL)$, the Wigner–Eckart theorem, the second-quantized form of one-body operators, and the concept of effective charges.\n\nLet the initial and final many-body nuclear states be denoted by $|\\Psi_i\\rangle = |\\alpha_i J_i M_i\\rangle$ and $|\\Psi_f\\rangle = |\\alpha_f J_f M_f\\rangle$, respectively, where $J$ is the total angular momentum, $M$ is its projection, and $\\alpha$ represents all other quantum numbers.\n\n**Step 1: Definition of the Reduced Transition Probability**\n\nThe reduced transition probability, $B(EL; J_i \\rightarrow J_f)$, for a transition of multipolarity $L$ initiated by the electric multipole operator $\\hat{O}(EL)$, is defined as:\n$$ B(EL; J_i \\rightarrow J_f) = \\frac{1}{2J_i + 1} |\\langle \\Psi_f || \\hat{O}(EL) || \\Psi_i \\rangle|^2 $$\nHere, $\\langle \\Psi_f || \\hat{O}(EL) || \\Psi_i \\rangle$ is the many-body reduced matrix element (MBRME) of the operator. Its value is independent of the magnetic quantum numbers $M_i$ and $M_f$ by the Wigner–Eckart theorem. The factor $(2J_i + 1)^{-1}$ represents an average over the possible initial states. For this problem, the multipolarity is fixed to the electric quadrupole case, so $L=2$.\n\n**Step 2: Structure of the Electric Quadrupole Operator**\n\nThe electric quadrupole operator, $\\hat{O}(E2M)$, is a one-body operator, meaning it is a sum of operators acting on individual nucleons:\n$$ \\hat{O}(E2M) = \\sum_{k=1}^{A} \\hat{o}_k(E2M) $$\nwhere $A$ is the total number of nucleons. To account for core polarization and other correlations not included in the model space, effective charges, $e_p$ and $e_n$, are introduced. These are dimensionless multipliers. The operator is thus separated into proton and neutron contributions:\n$$ \\hat{O}(E2M) = e_p \\sum_{k \\in \\text{protons}} \\hat{o}_k(E2M) + e_n \\sum_{k \\in \\text{neutrons}} \\hat{o}_k(E2M) $$\nwhere the operator $\\hat{o}_k(E2M)$ is typically proportional to $r_k^2 Y_{2M}(\\hat{r}_k)$. The elementary charge $e$ is conventionally absorbed into the final unit of $B(E2)$, which is $e^2\\,\\mathrm{fm}^4$.\n\n**Step 3: The Many-Body Reduced Matrix Element**\n\nDue to the linear structure of the operator, the MBRME can also be written as a sum of proton and neutron contributions:\n$$ \\langle \\Psi_f || \\hat{O}(E2) || \\Psi_i \\rangle = e_p \\langle \\Psi_f || \\hat{O}_p(E2) || \\Psi_i \\rangle + e_n \\langle \\Psi_f || \\hat{O}_n(E2) || \\Psi_i \\rangle $$\nwhere $\\hat{O}_p(E2)$ and $\\hat{O}_n(E2)$ represent the sums over only protons and only neutrons, respectively.\n\nThe key insight of the shell model is to express these many-body matrix elements in terms of more fundamental quantities. The MBRME of any one-body operator can be expanded as a sum over all possible single-particle transitions. Let the single-particle orbitals be denoted by indices like $\\alpha$ and $\\beta$. For the proton part, this expansion is:\n$$ \\langle \\Psi_f || \\hat{O}_p(E2) || \\Psi_i \\rangle = \\sum_{\\alpha, \\beta} \\text{OBTD}_{p, \\alpha\\beta} \\cdot \\langle \\alpha || \\hat{o}(E2) || \\beta \\rangle_p $$\nIn this expression:\n- $\\langle \\alpha || \\hat{o}(E2) || \\beta \\rangle_p$ is the single-particle reduced matrix element (SPME) for a proton transition from orbital $\\beta$ to orbital $\\alpha$. This quantity depends only on the single-particle wavefunctions and the operator form.\n- $\\text{OBTD}_{p, \\alpha\\beta}$ is the One-Body Transition Density for protons. This scalar quantity contains all the complex many-body information about the transition, essentially giving the amplitude for the system to change from $|\\Psi_i\\rangle$ to $|\\Psi_f\\rangle$ via the specific single-particle jump from $\\beta$ to $\\alpha$. In second quantization, the OBTD is the MBRME of a coupled creation-annihilation operator pair, $(\\hat{a}^\\dagger_\\alpha \\otimes \\tilde{a}_\\beta)^{(L=2)}$.\n\nThe problem provides the inputs not as a full set of orbitals $(\\alpha, \\beta)$, but as pre-calculated lists of non-zero contributing terms, where each term $k$ is a pair $(\\text{OBTD}^{(k)}, \\text{SPME}^{(k)})$. This simplifies the sum. Let's denote the sum for protons as $S_p$ and for neutrons as $S_n$:\n$$ S_p = \\sum_{k} \\text{OBTD}_{p}^{(k)} \\cdot \\text{SPME}_{p}^{(k)} $$\n$$ S_n = \\sum_{j} \\text{OBTD}_{n}^{(j)} \\cdot \\text{SPME}_{n}^{(j)} $$\nThe units of $S_p$ and $S_n$ are $\\mathrm{fm}^2$, as the OBTDs are dimensionless and the SPMEs are given in $\\mathrm{fm}^2$.\n\nThe total MBRME (without the charge unit $e$) is the coherent sum of the proton and neutron amplitudes, scaled by their respective effective charges:\n$$ M = \\langle \\Psi_f || \\hat{O}(E2) || \\Psi_i \\rangle = e_p S_p + e_n S_n $$\nThe value of $M$ is a real number in units of $\\mathrm{fm}^2$.\n\n**Step 4: Final Computational Formula**\n\nSubstituting the expression for the MBRME back into the definition of $B(E2)$ gives the final computational formula. The MBRME is $M$ in units of $\\mathrm{fm}^2$, and its full physical value is $e \\cdot M$.\n$$ B(E2; J_i \\rightarrow J_f) = \\frac{1}{2J_i + 1} |e \\cdot M|^2 = \\frac{M^2}{2J_i+1} $$\nThe final units are $e^2\\,\\mathrm{fm}^4$ as required. The derived formula to be implemented is:\n$$ B(E2; J_i \\rightarrow J_f) = \\frac{1}{2J_i + 1} \\left( e_p \\sum_{k} (\\text{OBTD}_{p}^{(k)} \\cdot \\text{SPME}_{p}^{(k)}) + e_n \\sum_{j} (\\text{OBTD}_{n}^{(j)} \\cdot \\text{SPME}_{n}^{(j)}) \\right)^2 $$\nThis expression is a direct consequence of the fundamental principles outlined and is ready for numerical implementation. The calculation for each test case involves summing the products within the proton and neutron lists, scaling by effective charges, adding these two contributions, squaring the result, and finally dividing by the statistical factor $(2J_i + 1)$. A special case is when the initial state has $J_i=0$, for which the statistical factor is $(2 \\cdot 0 + 1) = 1$. The squaring operation ensures that the final result is non-negative, as required for a probability.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and calculates the reduced transition probability B(E2) for a set of test cases\n    within the nuclear shell model framework.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"name\": \"Case 1\",\n            \"Ji\": 2, \"Jf\": 0, \"L\": 2,\n            \"ep\": 1.5, \"en\": 0.5,\n            \"proton_terms\": [(0.8, 5.0)],\n            \"neutron_terms\": []\n        },\n        {\n            \"name\": \"Case 2\",\n            \"Ji\": 4, \"Jf\": 2, \"L\": 2,\n            \"ep\": 1.5, \"en\": 0.5,\n            \"proton_terms\": [(0.25, 6.0), (0.10, 4.0)],\n            \"neutron_terms\": [(0.40, 5.0), (0.15, 3.0)]\n        },\n        {\n            \"name\": \"Case 3\",\n            \"Ji\": 2, \"Jf\": 2, \"L\": 2,\n            \"ep\": 1.5, \"en\": 0.5,\n            \"proton_terms\": [(0.50, 7.0), (0.20, -2.0)],\n            \"neutron_terms\": [(-0.80, 6.0)]\n        },\n        {\n            \"name\": \"Case 4\",\n            \"Ji\": 6, \"Jf\": 4, \"L\": 2,\n            \"ep\": 1.5, \"en\": 0.5,\n            \"proton_terms\": [(0.0, 10.0), (0.0, -7.0)],\n            \"neutron_terms\": []\n        },\n        {\n            \"name\": \"Case 5\",\n            \"Ji\": 0, \"Jf\": 2, \"L\": 2,\n            \"ep\": 1.5, \"en\": 0.5,\n            \"proton_terms\": [(-0.30, 8.0)],\n            \"neutron_terms\": [(0.20, 6.0)]\n        }\n    ]\n\n    results = []\n    \n    # The derived computational formula for B(E2) is:\n    # B(E2) = (1 / (2*Ji + 1)) * (ep * sum(OBTD_p * SPME_p) + en * sum(OBTD_n * SPME_n))^2\n\n    for case in test_cases:\n        # Calculate the sum of (OBTD * SPME) for protons\n        sum_p = 0.0\n        for obtd_p, spme_p in case[\"proton_terms\"]:\n            sum_p += obtd_p * spme_p\n\n        # Calculate the sum of (OBTD * SPME) for neutrons\n        sum_n = 0.0\n        for obtd_n, spme_n in case[\"neutron_terms\"]:\n            sum_n += obtd_n * spme_n\n\n        # Calculate the total many-body transition amplitude M\n        # M = ep * S_p + en * S_n\n        total_amplitude = case[\"ep\"] * sum_p + case[\"en\"] * sum_n\n\n        # Retrieve the initial angular momentum Ji\n        Ji = case[\"Ji\"]\n        \n        # Calculate the statistical factor. Handle Ji=0 case correctly, though algebra is the same.\n        if 2 * Ji + 1 == 0:\n            # This case is physically impossible for non-zero J, but as a safeguard.\n            b_e2 = 0.0\n        else:\n            statistical_factor = 1.0 / (2 * Ji + 1)\n            # Calculate B(E2)\n            b_e2 = statistical_factor * (total_amplitude ** 2)\n\n        results.append(b_e2)\n\n    # Format results to 6 decimal places and create the final output string.\n    formatted_results = [f\"{r:.6f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "This final practice explores the profound role of fundamental symmetries in governing nuclear transitions. You will implement the angular momentum and parity selection rules for electric dipole ($E1$) transitions and then investigate the fascinating case of parity violation, where weak-interaction-induced mixing of states can enable an otherwise forbidden transition . By calculating the strength of such an induced transition, you will gain a practical appreciation for how precise measurements of transition probabilities can probe physics beyond pure electromagnetism.",
            "id": "3585982",
            "problem": "Consider an electric dipole transition in a nucleus treated within a spherical-tensor formalism. The electric dipole operator is a rank-one spherical tensor, denoted by $T^{(E1)}$, and has odd parity. The reduced transition probability from an initial state to a final state is defined by the standard nuclear structure convention as a function of the reduced matrix element of the operator. The global physical requirements for electric multipole radiation of rank $L$ are: angular momentum coupling governed by spherical tensor algebra and parity transformation properties of the operator. For electric dipole radiation ($L=1$), angular momentum coupling is restricted by the triangle inequality for spherical tensors and the parity property of the operator. In addition, the rank-one tensor does not connect states with $J_i=0$ and $J_f=0$.\n\nWe introduce weak interaction-induced parity violation that mixes basis states of the same total angular momentum and opposite parity. Let the physical initial and final states be\n$$\n|\\tilde{i}\\rangle = |i\\rangle + \\alpha_i |i'\\rangle, \\quad |\\tilde{f}\\rangle = |f\\rangle + \\alpha_f |f'\\rangle,\n$$\nwhere $|i\\rangle$ has angular momentum $J_i$ and parity $\\pi_i$, $|i'\\rangle$ has the same angular momentum $J_i$ and parity $-\\pi_i$, and similarly $|f\\rangle$ has angular momentum $J_f$ and parity $\\pi_f$, while $|f'\\rangle$ has the same $J_f$ and parity $-\\pi_f$. The mixing amplitudes $\\alpha_i$ and $\\alpha_f$ are small, dimensionless quantities produced by the weak interaction matrix elements $V_i$ and $V_f$ with nearby opposite-parity states, and energy spacings $\\Delta_i$ and $\\Delta_f$. In a first-order two-state mixing model, \n$$\n\\alpha_i = \\frac{V_i}{\\Delta_i}, \\quad \\alpha_f = \\frac{V_f}{\\Delta_f}.\n$$\n\nUsing the general properties of spherical tensors and parity, the total reduced matrix element connecting the physical states to first order in the mixing amplitudes is\n$$\n\\langle \\tilde{f} \\| T^{(E1)} \\| \\tilde{i} \\rangle \\approx \\langle f \\| T^{(E1)} \\| i \\rangle + \\alpha_i \\langle f \\| T^{(E1)} \\| i' \\rangle + \\alpha_f \\langle f' \\| T^{(E1)} \\| i \\rangle,\n$$\nwith each term subject to the tensor coupling constraints for a rank-one operator and the parity transformation property of $T^{(E1)}$. Specifically:\n- Angular momentum selection rule: the reduced matrix element of a rank-one spherical tensor is only nonzero if $J_f \\in \\{J_i-1, J_i, J_i+1\\}$, and the case $J_i=J_f=0$ is excluded for rank one.\n- Parity selection rule for electric dipole: since $T^{(E1)}$ has odd intrinsic parity, the reduced matrix element between basis states is only nonzero if $\\pi_f = -\\pi_i$ for the pair of states connected by the operator in that term.\n\nThe reduced transition probability for electric dipole radiation is\n$$\nB(E1; J_i \\to J_f) = \\frac{1}{2J_i+1}\\left|\\langle \\tilde{f} \\| T^{(E1)} \\| \\tilde{i} \\rangle \\right|^2,\n$$\nwhere the operator rank is one and the matrix element is built from the sum above, constrained term-by-term by the selection rules. All reduced matrix elements $\\langle \\cdot \\| T^{(E1)} \\| \\cdot \\rangle$ are provided in units of $e \\cdot \\mathrm{fm}$, so $B(E1)$ must be expressed in $e^2 \\mathrm{fm}^2$.\n\nImplement a program that computes $B(E1)$ under these rules for the following test suite. Each test case is defined by the tuple of parameters:\n- $(J_i, \\pi_i, J_f, \\pi_f)$: quantum numbers of the primary initial and final states, with $\\pi \\in \\{+1,-1\\}$ denoting parity.\n- $M_{fi}$: the reduced matrix element $\\langle f \\| T^{(E1)} \\| i \\rangle$ in $e \\cdot \\mathrm{fm}$.\n- $(J_i', \\pi_i')$ and $(J_f', \\pi_f')$: quantum numbers of the opposite-parity partner states for the initial and final configurations.\n- $M_{fi'}$: the reduced matrix element $\\langle f \\| T^{(E1)} \\| i' \\rangle$ in $e \\cdot \\mathrm{fm}$.\n- $M_{f'i}$: the reduced matrix element $\\langle f' \\| T^{(E1)} \\| i \\rangle$ in $e \\cdot \\mathrm{fm}$.\n- $(V_i, \\Delta_i)$ and $(V_f, \\Delta_f)$: weak mixing matrix element and energy spacing in $\\mathrm{MeV}$ for the initial and final mixing amplitudes.\n\nFor each test case, the program must:\n- Compute $\\alpha_i = V_i / \\Delta_i$ and $\\alpha_f = V_f / \\Delta_f$.\n- Construct the physical reduced matrix element by summing the allowed contributions, where each contribution is included only if both the angular momentum and parity constraints are satisfied for the pair of states in that term.\n- Enforce the angular momentum rule for rank one and exclude the $J_i=J_f=0$ case in all terms.\n- Compute $B(E1)$ using the physical reduced matrix element and express the final answer in $e^2 \\mathrm{fm}^2$.\n\nUse the following scientifically consistent test suite:\n- Test 1 (allowed $E1$ with $\\Delta J = 1$ and opposite parity):\n  $J_i=2$, $\\pi_i=+1$; $J_f=1$, $\\pi_f=-1$; $M_{fi}=0.800$; $J_i'=2$, $\\pi_i'=-1$; $J_f'=1$, $\\pi_f'=+1$; $M_{fi'}=0.000$; $M_{f'i}=0.000$; $V_i=0.000\\,\\mathrm{MeV}$, $\\Delta_i=1.000\\,\\mathrm{MeV}$; $V_f=0.000\\,\\mathrm{MeV}$, $\\Delta_f=1.000\\,\\mathrm{MeV}$.\n- Test 2 (allowed $E1$ with $\\Delta J = 0$ and opposite parity):\n  $J_i=1$, $\\pi_i=+1$; $J_f=1$, $\\pi_f=-1$; $M_{fi}=0.300$; $J_i'=1$, $\\pi_i'=-1$; $J_f'=1$, $\\pi_f'=+1$; $M_{fi'}=0.000$; $M_{f'i}=0.000$; $V_i=0.000\\,\\mathrm{MeV}$, $\\Delta_i=1.000\\,\\mathrm{MeV}$; $V_f=0.000\\,\\mathrm{MeV}$, $\\Delta_f=1.000\\,\\mathrm{MeV}$.\n- Test 3 (forbidden by angular momentum: $\\Delta J = 2$ for rank-one):\n  $J_i=2$, $\\pi_i=+1$; $J_f=0$, $\\pi_f=-1$; $M_{fi}=1.000$; $J_i'=2$, $\\pi_i'=-1$; $J_f'=0$, $\\pi_f'=+1$; $M_{fi'}=0.000$; $M_{f'i}=0.000$; $V_i=0.000\\,\\mathrm{MeV}$, $\\Delta_i=1.000\\,\\mathrm{MeV}$; $V_f=0.000\\,\\mathrm{MeV}$, $\\Delta_f=1.000\\,\\mathrm{MeV}$.\n- Test 4 (same parity initial and final, induced $E1$ through mixing):\n  $J_i=2$, $\\pi_i=+1$; $J_f=1$, $\\pi_f=+1$; $M_{fi}=0.000$; $J_i'=2$, $\\pi_i'=-1$; $J_f'=1$, $\\pi_f'=-1$; $M_{fi'}=0.400$; $M_{f'i}=-0.200$; $V_i=2.0\\times 10^{-6}\\,\\mathrm{MeV}$, $\\Delta_i=1.000\\,\\mathrm{MeV}$; $V_f=5.0\\times 10^{-6}\\,\\mathrm{MeV}$, $\\Delta_f=1.000\\,\\mathrm{MeV}$.\n- Test 5 (excluded $J_i=J_f=0$ case even with opposite parity and mixing present):\n  $J_i=0$, $\\pi_i=+1$; $J_f=0$, $\\pi_f=-1$; $M_{fi}=0.500$; $J_i'=0$, $\\pi_i'=-1$; $J_f'=0$, $\\pi_f'=+1$; $M_{fi'}=0.700$; $M_{f'i}=-0.600$; $V_i=1.0\\times 10^{-6}\\,\\mathrm{MeV}$, $\\Delta_i=1.000\\,\\mathrm{MeV}$; $V_f=1.0\\times 10^{-6}\\,\\mathrm{MeV}$, $\\Delta_f=1.000\\,\\mathrm{MeV}$.\n\nAll reduced matrix elements are in $e \\cdot \\mathrm{fm}$ and all weak interaction parameters are in $\\mathrm{MeV}$. Express the final reduced transition probabilities $B(E1)$ in $e^2 \\mathrm{fm}^2$. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[r_1,r_2,r_3,r_4,r_5]$). Use decimal notation, and you may use scientific notation where appropriate. Round each result to twelve significant digits to ensure numerical clarity.",
            "solution": "The user wants me to solve a computational nuclear physics problem.\n\n### Step 1: Extract Givens\nThe problem asks to compute the reduced transition probability $B(E1)$ for an electric dipole transition between nuclear states that exhibit parity mixing due to the weak interaction.\n\nThe physical states are given by:\n$|\\tilde{i}\\rangle = |i\\rangle + \\alpha_i |i'\\rangle$\n$|\\tilde{f}\\rangle = |f\\rangle + \\alpha_f |f'\\rangle$\n\nThe state $|i\\rangle$ has quantum numbers $(J_i, \\pi_i)$.\nThe state $|i'\\rangle$ has quantum numbers $(J_i', \\pi_i')$ which are explicitly given, but are consistent with $(J_i, -\\pi_i)$.\nThe state $|f\\rangle$ has quantum numbers $(J_f, \\pi_f)$.\nThe state $|f'\\rangle$ has quantum numbers $(J_f', \\pi_f')$ which are explicitly given, but are consistent with $(J_f, -\\pi_f)$.\n\nThe mixing amplitudes are defined as:\n$\\alpha_i = \\frac{V_i}{\\Delta_i}$\n$\\alpha_f = \\frac{V_f}{\\Delta_f}$\n\nThe total reduced matrix element, to first order, is:\n$\\langle \\tilde{f} \\| T^{(E1)} \\| \\tilde{i} \\rangle \\approx \\langle f \\| T^{(E1)} \\| i \\rangle + \\alpha_i \\langle f \\| T^{(E1)} \\| i' \\rangle + \\alpha_f \\langle f' \\| T^{(E1)} \\| i \\rangle$\n\nThe reduced transition probability is:\n$B(E1; J_i \\to J_f) = \\frac{1}{2J_i+1}\\left|\\langle \\tilde{f} \\| T^{(E1)} \\| \\tilde{i} \\rangle \\right|^2$\n\nSelection Rules for the electric dipole operator $T^{(E1)}$ (rank $L=1$, odd parity):\n1.  **Angular Momentum Selection Rule**: A reduced matrix element $\\langle J_f, \\pi_f \\| T^{(1)} \\| J_i, \\pi_i \\rangle$ is non-zero only if $|J_i - J_f| \\le 1 \\le J_i + J_f$. This is equivalent to $J_f \\in \\{J_i-1, J_i, J_i+1\\}$. Additionally, transitions between states with $J_i=0$ and $J_f=0$ are forbidden.\n2.  **Parity Selection Rule**: A reduced matrix element $\\langle J_f, \\pi_f \\| T^{(E1)} \\| J_i, \\pi_i \\rangle$ is non-zero only if the parities of the initial and final states are opposite, i.e., $\\pi_f = -\\pi_i$.\n\nThe provided data for the five test cases consists of tuples with the following structure:\n$(J_i, \\pi_i, J_f, \\pi_f, M_{fi}, J_i', \\pi_i', J_f', \\pi_f', M_{fi'}, M_{f'i}, V_i, \\Delta_i, V_f, \\Delta_f)$\nwhere $M_{fi} = \\langle f \\| T^{(E1)} \\| i \\rangle$, $M_{fi'} = \\langle f \\| T^{(E1)} \\| i' \\rangle$, and $M_{f'i} = \\langle f' \\| T^{(E1)} \\| i \\rangle$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, well-posed, and objective. It is based on standard principles of quantum mechanics and nuclear structure theory, specifically the treatment of electromagnetic transitions and parity non-conservation. The formulas, selection rules, and definitions are all correct and standard in the field. The provided data is complete and consistent for each test case. There are no contradictions, ambiguities, or unrealistic assumptions. The problem is a straightforward but detailed computational task based on these principles.\n\n### Step 3: Verdict and Action\nThe problem is valid. A solution will be provided.\n\n### Principle-Based Solution Design\nThe problem requires the calculation of the reduced transition probability, $B(E1)$, for an electric dipole ($E1$) transition between an initial physical state $|\\tilde{i}\\rangle$ and a final physical state $|\\tilde{f}\\rangle$. These states are superpositions of basis states with opposite parities, a consequence of weak interaction-induced parity violation.\n\nThe first step is to construct the total reduced matrix element for the $E1$ operator, $T^{(E1)}$, between the physical states. To first order in the small mixing amplitudes $\\alpha_i$ and $\\alpha_f$, this is given by:\n$$\nM_{total} = \\langle \\tilde{f} \\| T^{(E1)} \\| \\tilde{i} \\rangle \\approx \\langle f \\| T^{(E1)} \\| i \\rangle + \\alpha_i \\langle f \\| T^{(E1)} \\| i' \\rangle + \\alpha_f \\langle f' \\| T^{(E1)} \\| i \\rangle\n$$\nThe calculation of $M_{total}$ involves summing three distinct contributions, where the provided values are $M_{fi} = \\langle f \\| T^{(E1)} \\| i \\rangle$, $M_{fi'} = \\langle f \\| T^{(E1)} \\| i' \\rangle$, and $M_{f'i} = \\langle f' \\| T^{(E1)} \\| i \\rangle$. The mixing amplitudes are $\\alpha_i = V_i/\\Delta_i$ and $\\alpha_f = V_f/\\Delta_f$.\n\nEach of these three terms is non-zero only if it satisfies the fundamental selection rules for a rank-$1$ spherical tensor operator with odd parity ($E1$ operator):\n1.  **Angular Momentum Rule**: For a transition between an initial state of angular momentum $J_{initial}$ and a final state of angular momentum $J_{final}$, the condition $|J_{initial} - J_{final}| \\le 1$ must be met. Furthermore, the case where $J_{initial}=0$ and $J_{final}=0$ is strictly forbidden for any rank-$1$ operator.\n2.  **Parity Rule**: The operator $T^{(E1)}$ has odd intrinsic parity. Therefore, it can only connect states of opposite parity. For a transition from a state with parity $\\pi_{initial}$ to one with parity $\\pi_{final}$, the condition $\\pi_{final} = -\\pi_{initial}$ must be satisfied.\n\nThe computational procedure is to evaluate each of the three terms in the expression for $M_{total}$ separately, including each term in the sum only if it satisfies both the angular momentum and parity selection rules.\n\nLet's denote a function `is_allowed(J_init, p_init, J_fin, p_fin)` which returns true if a transition is allowed and false otherwise. This function implements the two rules:\n- `is_allowed` is true if and only if ($|J_{init} - J_{fin}| \\le 1$ AND NOT ($J_{init}=0$ AND $J_{fin}=0$)) AND ($\\pi_{fin} = -\\pi_{init}$).\n\nThe total reduced matrix element is thus constructed as follows:\n$M_{total} = 0$\n- **Term 1**: If `is_allowed`($J_i, \\pi_i, J_f, \\pi_f$) is true, add $M_{fi}$ to $M_{total}$.\n- **Term 2**: If `is_allowed`($J_i', \\pi_i', J_f, \\pi_f$) is true, add $\\alpha_i \\cdot M_{fi'}$ to $M_{total}$.\n- **Term 3**: If `is_allowed`($J_i, \\pi_i, J_f', \\pi_f'$) is true, add $\\alpha_f \\cdot M_{f'i}$ to $M_{total}$.\n\nOnce $M_{total}$ is computed in units of $e \\cdot \\mathrm{fm}$, the reduced transition probability $B(E1)$ is calculated using its definition:\n$$\nB(E1; J_i \\to J_f) = \\frac{1}{2J_i+1} |M_{total}|^2\n$$\nThe resulting $B(E1)$ value will have units of $e^2 \\mathrm{fm}^2$. The factor $(2J_i+1)^{-1}$ correctly averages over the initial magnetic substates and is non-singular as $J_i \\ge 0$. The implementation will apply this logic to each test case provided.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the reduced transition probability B(E1) for electric dipole\n    transitions between parity-mixed nuclear states.\n    \"\"\"\n\n    # Test cases defined by the tuple of parameters:\n    # (Ji, pi, Jf, pf, M_fi, Ji', pi', Jf', pf', M_fi_prime, M_f_prime_i, \n    #  Vi, delta_i, Vf, delta_f)\n    test_cases = [\n        # Test 1 (allowed E1 with Delta J = 1 and opposite parity)\n        (2, +1, 1, -1, 0.800, 2, -1, 1, +1, 0.000, 0.000, 0.000, 1.000, 0.000, 1.000),\n        # Test 2 (allowed E1 with Delta J = 0 and opposite parity)\n        (1, +1, 1, -1, 0.300, 1, -1, 1, +1, 0.000, 0.000, 0.000, 1.000, 0.000, 1.000),\n        # Test 3 (forbidden by angular momentum: Delta J = 2 for rank-one)\n        (2, +1, 0, -1, 1.000, 2, -1, 0, +1, 0.000, 0.000, 0.000, 1.000, 0.000, 1.000),\n        # Test 4 (same parity initial and final, induced E1 through mixing)\n        (2, +1, 1, +1, 0.000, 2, -1, 1, -1, 0.400, -0.200, 2.0e-6, 1.000, 5.0e-6, 1.000),\n        # Test 5 (excluded J=0 to J=0 case even with mixing)\n        (0, +1, 0, -1, 0.500, 0, -1, 0, +1, 0.700, -0.600, 1.0e-6, 1.000, 1.0e-6, 1.000),\n    ]\n\n    results = []\n\n    def is_allowed(j_initial, p_initial, j_final, p_final):\n        \"\"\"\n        Checks if a transition is allowed by E1 selection rules.\n        \"\"\"\n        # Angular momentum selection rule for a rank-1 operator\n        am_allowed = abs(j_initial - j_final) <= 1 and not (j_initial == 0 and j_final == 0)\n        \n        # Parity selection rule for an E1 operator (odd parity)\n        parity_allowed = p_final == -p_initial\n        \n        return am_allowed and parity_allowed\n\n    for case in test_cases:\n        (j_i, p_i, j_f, p_f, m_fi, j_i_prime, p_i_prime, j_f_prime, p_f_prime, \n         m_fi_prime, m_f_prime_i, v_i, delta_i, v_f, delta_f) = case\n\n        # Calculate mixing amplitudes\n        alpha_i = v_i / delta_i if delta_i != 0 else 0\n        alpha_f = v_f / delta_f if delta_f != 0 else 0\n\n        # Calculate total reduced matrix element\n        m_total = 0.0\n\n        # Term 1: <f || T(E1) || i>\n        if is_allowed(j_i, p_i, j_f, p_f):\n            m_total += m_fi\n\n        # Term 2: alpha_i * <f || T(E1) || i'>\n        if is_allowed(j_i_prime, p_i_prime, j_f, p_f):\n            m_total += alpha_i * m_fi_prime\n\n        # Term 3: alpha_f * <f' || T(E1) || i>\n        if is_allowed(j_i, p_i, j_f_prime, p_f_prime):\n            m_total += alpha_f * m_f_prime_i\n\n        # Calculate B(E1)\n        if (2 * j_i + 1) > 0:\n            b_e1 = (1 / (2 * j_i + 1)) * (m_total**2)\n        else: # Should not happen for physical J >= 0\n            b_e1 = 0.0\n\n        # Format result to 12 significant digits in scientific notation\n        results.append(\"{:.11e}\".format(b_e1))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}