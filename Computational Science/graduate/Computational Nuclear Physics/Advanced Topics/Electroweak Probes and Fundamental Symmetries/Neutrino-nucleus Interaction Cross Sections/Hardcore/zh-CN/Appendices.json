{
    "hands_on_practices": [
        {
            "introduction": "中微子-原子核相互作用的截面不仅取决于潜在的动力学，还受到可用相空间（phase space）的严格限制。本练习通过一个简化的准弹性散射模型，旨在阐明一个基本的运动学效应：出射轻子的质量如何直接抑制反应的可用相空间，从而影响总截面。通过计算电子中微子和缪子中微子反应截面的比率，您将亲手量化这种由质量引起的相空间抑制效应。",
            "id": "3572485",
            "problem": "考虑电子中微子和μ子中微子在碳核上的带电流准弹性 (CCQE) 散射，该过程在低能情况下使用平面波脉冲近似进行建模。具体来说，研究发生在碳核内束缚中子上的过程 $\\nu_{\\ell} + n \\to \\ell^{-} + p$，其中 $\\ell$ 表示电子或μ子。假设初始束缚中子处于静止状态，并由有效质量 $M_{n}^{*} = M_{n} - \\varepsilon_{B}$ 描述，其中恒定的分离能 $\\varepsilon_{B}$ 用来考虑核结合效应。忽略末态相互作用和库仑效应，并假设在这些运动学条件下，强子跃迁矩阵元与轻子味道无关。设中微子的实验室能量为 $E_{\\nu} \\le 300\\,\\text{MeV}$；在本问题中，你将在 $E_{\\nu} = 300\\,\\text{MeV}$ 处进行计算。\n\n从费米黄金定则和二体能量动量守恒出发，通过末态轻子质量 $m_{\\ell}$ 对可用二体相空间的影响，建立总 CCQE 截面关于 $m_{\\ell}$ 的领头阶（以核子质量的倒数为展开）依赖关系。使用这个关系来定义在固定 $E_{\\nu}$ 下的相空间抑制因子，\n$$\nS(E_{\\nu}) \\equiv \\frac{\\sigma(\\nu_{\\mu})}{\\sigma(\\nu_{e})}\\,,\n$$\n该因子在上述近似下纯粹由 $m_{\\mu}$ 和 $m_{e}$ 之间的差异引起。\n\n取数值输入为\n$$\nM_{n} = 939.565\\,\\text{MeV}, \\quad M_{p} = 938.272\\,\\text{MeV}, \\quad m_{e} = 0.511\\,\\text{MeV}, \\quad m_{\\mu} = 105.658\\,\\text{MeV}, \\quad \\varepsilon_{B} = 25\\,\\text{MeV}.\n$$\n对于运动学，将传递给轻子的主要能量视为\n$$\nE_{\\ell} \\approx E_{\\nu} - \\Delta_{Q}, \\quad \\text{with} \\quad \\Delta_{Q} \\equiv M_{p} - M_{n} + \\varepsilon_{B},\n$$\n这与重重子极限和小动量转移相一致。在这些假设下，用闭合形式表示 $S(E_{\\nu})$ 并在 $E_{\\nu} = 300\\,\\text{MeV}$ 处计算其值。\n\n将最终数值答案四舍五入到四位有效数字。将最终结果表示为一个纯数（无量纲）。",
            "solution": "用户想要找到相空间抑制因子，该因子定义为在一系列简化假设下，μ子中微子和电子中微子在碳核上的总带电流准弹性 (CCQE) 散射截面之比。\n\n### 步骤1：提取已知条件\n- **过程**: 带电流准弹性 (CCQE) 散射，作用于束缚中子：$\\nu_{\\ell} + n \\to \\ell^{-} + p$，其中 $\\ell \\in \\{e, \\mu\\}$。\n- **模型**: 平面波脉冲近似。\n- **初始态**: 束缚中子，由有效质量 $M_{n}^{*} = M_{n} - \\varepsilon_{B}$ 描述，初始时处于静止。\n- **近似**:\n    - 忽略末态相互作用 (FSI)。\n    - 忽略库仑效应。\n    - 强子跃迁矩阵元与轻子味道（$\\ell=e$ 或 $\\ell=\\mu$）无关。\n- **运动学条件**: 中微子实验室能量 $E_{\\nu} = 300\\,\\text{MeV}$。\n- **运动学近似**: 末态轻子能量由 $E_{\\ell} \\approx E_{\\nu} - \\Delta_{Q}$ 给出，其中 $\\Delta_{Q} \\equiv M_{p} - M_{n} + \\varepsilon_{B}$。\n- **定义**: 相空间抑制因子为 $S(E_{\\nu}) \\equiv \\frac{\\sigma(\\nu_{\\mu})}{\\sigma(\\nu_{e})}$。\n- **数值**:\n    - 中子质量: $M_{n} = 939.565\\,\\text{MeV}$\n    - 质子质量: $M_{p} = 938.272\\,\\text{MeV}$\n    - 电子质量: $m_{e} = 0.511\\,\\text{MeV}$\n    - μ子质量: $m_{\\mu} = 105.658\\,\\text{MeV}$\n    - 中子分离能: $\\varepsilon_{B} = 25\\,\\text{MeV}$\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学依据**: 该问题描述了 CCQE 中微子-原子核散射，这是核物理和粒子物理中的一个基本过程。所引用的理论框架——费米黄金定则、二体相空间和脉冲近似——是标准的。对束缚核子使用有效质量是一种常见的唯象方法（例如，在费米气体模型的背景下）。所有近似都明确说明，是该主题简化教学处理中的典型做法。粒子质量和分离能的数值在物理上是现实的。该问题在科学上是合理的。\n- **良态问题**: 问题要求一个具体、可计算的量 $S(E_{\\nu})$。它提供了所有必要的数据和一套清晰的物理近似来定义计算。目标明确。\n- **客观性**: 问题以精确、技术性的语言陈述，没有主观性或偏见。\n- **结论**: 该问题是有效的。它是一个基于既定原理和标准近似的、定义明确的物理问题。\n\n### 步骤3：判断与行动\n问题是有效的。将提供完整的解答。\n\n### 求解过程\n散射过程的微分截面由费米黄金定则给出。对于过程 $\\nu_{\\ell} + n \\to \\ell^{-} + p$，总截面 $\\sigma(\\nu_{\\ell})$ 是通过对末态相空间上的微分截面进行积分得到的：\n$$\n\\sigma(\\nu_{\\ell}) = \\int |\\mathcal{M}_{\\ell}|^2 d\\Phi_{\\ell}\n$$\n其中 $|\\mathcal{M}_{\\ell}|^2$ 是轻子味道为 $\\ell$ 的跃迁矩阵元的平方，$d\\Phi_{\\ell}$ 是末态 $(\\ell^{-}, p)$ 的二体洛伦兹不变相空间元。\n\n问题指出强子跃迁矩阵元与轻子味道无关。这意味着如果我们对自旋和角度依赖性进行积分，矩阵元剩下的运动学部分也与味道无关。作为一阶近似，我们视 $|\\mathcal{M}_e|^2 \\approx |\\mathcal{M}_\\mu|^2 \\approx |\\mathcal{M}|^2$ 为一个常数因子，它不依赖于电子和μ子末态之间有差异的那些运动学变量。\n\n抑制因子 $S(E_{\\nu})$ 是总截面之比：\n$$\nS(E_{\\nu}) = \\frac{\\sigma(\\nu_{\\mu})}{\\sigma(\\nu_{e})} = \\frac{\\int |\\mathcal{M}_{\\mu}|^2 d\\Phi_{\\mu}}{\\int |\\mathcal{M}_{e}|^2 d\\Phi_{e}} \\approx \\frac{\\int d\\Phi_{\\mu}}{\\int d\\Phi_{e}} = \\frac{\\Phi_{\\text{total}}(\\mu)}{\\Phi_{\\text{total}}(e)}\n$$\n因此，截面之比由末态可用相空间体积之比决定。\n\n问题为运动学提供了一个关键的简化：出射轻子的能量被近似为一个恒定值，$E_{\\ell} \\approx E_{\\nu} - \\Delta_{Q}$。这个近似与重重子极限一致，在重重子极限中，反冲质子的动能被忽略。在此近似下，电子和μ子末态的轻子能量 $E_{\\ell}$ 是相同的。让我们将这个固定能量表示为 $E'_{\\ell} = E_{\\nu} - \\Delta_{Q}$。\n\n对于固定的末态轻子能量，我们不对 $E_{\\ell}$ 的一个范围进行积分。相反，“可用二体相空间”的概念指的是在这个特定运动学点上的相空间密度。质量为 $m_{\\ell}$、能量为 $E_{\\ell}$ 的自由粒子的态密度正比于其能量和动量大小的乘积，即 $E_{\\ell} |\\vec{k}_{\\ell}|$。因子 $|\\vec{k}_{\\ell}|$ 来自相空间体积元 $|\\vec{k}_{\\ell}|^2 d|\\vec{k}_{\\ell}|$，而雅可比行列式 $d|\\vec{k}_{\\ell}|/dE_{\\ell} = E_{\\ell}/|\\vec{k}_{\\ell}|$ 给出 $E_{\\ell}$ 因子。因此，我们可以近似认为总截面正比于这个因子：\n$$\n\\sigma(\\nu_{\\ell}) \\propto E_{\\ell} |\\vec{k}_{\\ell}|\n$$\n这假设了截面中所有其他的运动学因子都近似与味道无关。\n\n轻子动量的大小 $|\\vec{k}_{\\ell}|$ 由相对论能量-动量关系决定：$|\\vec{k}_{\\ell}| = \\sqrt{E_{\\ell}^2 - m_{\\ell}^2}$。\n\n使用我们的近似 $E_{e} = E_{\\mu} = E'_{\\ell}$，抑制因子成为末态轻子动量之比：\n$$\nS(E_{\\nu}) = \\frac{E'_{\\ell} |\\vec{k}_{\\mu}|}{E'_{\\ell} |\\vec{k}_{e}|} = \\frac{|\\vec{k}_{\\mu}|}{|\\vec{k}_{e}|} = \\frac{\\sqrt{(E'_{\\ell})^2 - m_{\\mu}^2}}{\\sqrt{(E'_{\\ell})^2 - m_{e}^2}}\n$$\n代入 $E'_{\\ell} = E_{\\nu} - \\Delta_Q$ 得到抑制因子的最终闭合形式表达式：\n$$\nS(E_{\\nu}) = \\sqrt{\\frac{(E_{\\nu} - \\Delta_Q)^2 - m_{\\mu}^2}{(E_{\\nu} - \\Delta_Q)^2 - m_{e}^2}}\n$$\n其中 $\\Delta_Q = M_{p} - M_{n} + \\varepsilon_{B}$。\n\n现在，我们使用给定的数值来计算这个表达式。\n首先，计算能量转移 $\\Delta_Q$：\n$$\n\\Delta_Q = M_{p} - M_{n} + \\varepsilon_{B} = 938.272\\,\\text{MeV} - 939.565\\,\\text{MeV} + 25\\,\\text{MeV} = 23.707\\,\\text{MeV}\n$$\n接下来，对于给定的中微子能量 $E_{\\nu} = 300\\,\\text{MeV}$，计算末态轻子能量 $E'_{\\ell}$：\n$$\nE'_{\\ell} = E_{\\nu} - \\Delta_Q = 300\\,\\text{MeV} - 23.707\\,\\text{MeV} = 276.293\\,\\text{MeV}\n$$\n该反应在运动学上是允许的，因为 $E'_{\\ell}  m_{\\mu}$ ($276.293\\,\\text{MeV}  105.658\\,\\text{MeV}$)。\n\n现在，我们计算μ子和电子的动量平方：\n$$\n|\\vec{k}_{\\mu}|^2 = (E'_{\\ell})^2 - m_{\\mu}^2 = (276.293\\,\\text{MeV})^2 - (105.658\\,\\text{MeV})^2\n$$\n$$\n|\\vec{k}_{\\mu}|^2 = 76337.817449\\,\\text{MeV}^2 - 11163.606564\\,\\text{MeV}^2 = 65174.210885\\,\\text{MeV}^2\n$$\n$$\n|\\vec{k}_{e}|^2 = (E'_{\\ell})^2 - m_{e}^2 = (276.293\\,\\text{MeV})^2 - (0.511\\,\\text{MeV})^2\n$$\n$$\n|\\vec{k}_{e}|^2 = 76337.817449\\,\\text{MeV}^2 - 0.261121\\,\\text{MeV}^2 = 76337.556328\\,\\text{MeV}^2\n$$\n最后，我们计算抑制因子 $S(E_{\\nu})$：\n$$\nS(300\\,\\text{MeV}) = \\sqrt{\\frac{65174.210885}{76337.556328}} = \\sqrt{0.85377033...} \\approx 0.92399693\n$$\n四舍五入到四位有效数字，我们得到 $0.9240$。",
            "answer": "$$\n\\boxed{0.9240}\n$$"
        },
        {
            "introduction": "相对论费米气体（Relativistic Fermi Gas, RFG）模型是描述包容性中微子-原子核散射的一个基础工具，它将原子核近似为一个由无相互作用的费米子组成的体系。然而，在将该模型付诸计算实践时，一个常见且关键的挑战是处理响应函数积分中的可积奇点（integrable singularities）。本练习将引导您分析这些奇点的来源，并通过巧妙的变量替换来“正则化”积分，从而实现稳定高效的数值计算，这是计算核物理中的一项核心数值技术。",
            "id": "3572502",
            "problem": "考虑一个相对论费米气体（RFG）的包容性准弹性响应，该气体用于描述中微子在自旋饱和原子核上的散射。该原子核被建模为一个半径等于费米动量 $k_F$ 的均匀费米球。在自然单位制中，光速 $c$ 设为1，定义核子质量为 $m$，使用三维动量转移大小 $q$ 和能量转移 $\\omega$。包容性标量相空间因子（在冲量近似下与前向散射振幅的虚部成正比）可以写成以下受能量守恒约束的六维积分，这里忽略了一个总的耦合常数：\n$$\nI(\\omega,q;k_F) \\equiv \\int_{|\\mathbf{p}|\\le k_F} d^3p \\ \\delta\\!\\left(\\omega + E(\\mathbf{p}) - E(\\mathbf{p}+\\mathbf{q})\\right),\n$$\n其中 $E(\\mathbf{p}) \\equiv \\sqrt{|\\mathbf{p}|^2 + m^2}$ 且 $E(\\mathbf{p}+\\mathbf{q}) \\equiv \\sqrt{|\\mathbf{p}+\\mathbf{q}|^2 + m^2}$。将 $z$ 轴与 $\\mathbf{q}$ 对齐，并记 $x\\equiv \\cos\\theta$，其中 $\\theta$ 是 $\\mathbf{p}$ 和 $\\mathbf{q}$ 之间的夹角。在 $\\mathbf{p}$ 空间中使用球坐标，积分简化为\n$$\nI(\\omega,q;k_F) \\equiv 2\\pi \\int_{-1}^{1} dx \\int_{0}^{k_F} dp \\ p^2 \\ \\delta\\!\\left(g(p,x)\\right),\n$$\n其中\n$$\ng(p,x) \\equiv \\omega + \\sqrt{p^2 + m^2} - \\sqrt{p^2 + q^2 + 2pqx + m^2}.\n$$\ndelta函数将 $(p,x)$ 定义域限制在矩形 $p\\in[0,k_F]$ 和 $x\\in[-1,1]$ 内的曲线 $g(p,x) = 0$ 上。一种标准的计算方法是利用恒等式 $\\delta(g(p,x)) = \\sum_{i} \\delta(p - p_i(x)) \\left|\\partial g/\\partial p\\vert_{p_i(x)}\\right|^{-1}$ 来消除delta函数，其中 $p_i(x)$ 是 $g(p,x) = 0$ 在 $[0,k_F]$ 内的实根。这会得到一个形式如下的一维积分\n$$\nI(\\omega,q;k_F) = 2\\pi \\int_{-1}^{1} dx \\ \\sum_{i} \\frac{p_i(x)^2}{\\left|\\partial g/\\partial p\\vert_{p_i(x)}\\right|},\n$$\n其中\n$$\n\\frac{\\partial g}{\\partial p}(p,x) = \\frac{p}{\\sqrt{p^2+m^2}} - \\frac{p+qx}{\\sqrt{p^2 + q^2 + 2pqx + m^2}}.\n$$\n在 $x$ 的运动学端点附近，允许的根 $p_i(x)$ 可以趋近边界 $p=k_F$，这会导致 $\\left|\\partial g/\\partial p\\vert_{p_i(x)}\\right|$ 变小，并且被积函数在 $x$ 中出现可积的平方根发散（例如，当曲线 $g(p,x)=0$ 在 $x=\\pm 1$ 处与边界相切时）。这会导致对 $x$ 的标准求积法出现数值不稳定性。\n\n你的任务是：\n\n1) 从上述定义和狄拉克delta函数 $\\delta(\\cdot)$ 的基本性质出发，解释为何 $I(\\omega,q;k_F)$ 的一维表示是有效的，并指出当 $g(p,x)=0$ 的解与边界 $p=k_F$ 相切时，在运动学边缘 $x=\\pm 1$ 处可积奇异行为的潜在来源。\n\n2) 提出一种变量代换，以正则化被积函数在边缘处的行为，从而实现高效稳定的求积。通过在 $x=\\pm 1$ 附近的局部渐近分析来证明你的选择是合理的，并展示变换的雅可比行列式如何消除平方根发散。变量代换必须用 $x$ 和一个新的角度变量明确表示，并且角度单位必须指定为弧度。\n\n3) 实现以下计算实验，以展示在运动学边缘附近数值稳定性和效率的提升。对于下面的每个测试案例：\n   - 用三种方法计算 $I(\\omega,q;k_F)$：\n     a) 直接在 $x\\in[-1,1]$ 上使用 $N=16$ 个节点进行朴素的高斯-勒让德求积。\n     b) 在将变量从 $x$ 变换到 $[0,\\pi]$ 中的角度变量后，使用 $N=16$ 个节点进行正则化的高斯-勒让德求积，确保正确地包含了雅可比行列式。\n     c) 使用自适应求积法对正则化后的积分进行计算，以获得高精度参考值，绝对公差要求严格为 $10^{-9}$。\n   - 为了数值稳健性，在 $[0,k_F]$ 内寻找 $g(p,x)=0$ 的根 $p_*(x)$ 时，对每个 $x$ 使用区间法来定位它；如果不存在根，则在该 $x$ 处的贡献为零。使用在根处求得的导数 $\\partial g/\\partial p$ 来计算雅可比因子。如果 $|\\partial g/\\partial p|$ 变得极小（在自然单位制中低于 $10^{-12}$），将其大小限制在 $10^{-12}$ 以避免浮点溢出，同时保留其可积性。\n   - 对于每个测试案例，报告朴素求积的绝对误差与正则化求积的绝对误差之比（一个无量纲数），两者均相对于高精度参考值进行测量。即，\n     $$\n     \\mathcal{R} \\equiv \\frac{\\left|I_{\\text{naive}} - I_{\\text{ref}}\\right|}{\\left|I_{\\text{reg}} - I_{\\text{ref}}\\right|}.\n     $$\n\n使用以下物理上真实的常数和测试组。所有能量和动量都以兆电子伏特 (MeV) 为单位处理，并隐含 $c=1$：\n- $m = 939$ MeV,\n- $k_F = 250$ MeV,\n- $q = 600$ MeV.\n\n通过以下公式定义在边界 $p=k_F$ 和 $x=\\pm 1$ 处的运动学边缘能量转移\n$$\n\\omega_{\\pm}(q,k_F) \\equiv \\sqrt{(q \\pm k_F)^2 + m^2} - \\sqrt{k_F^2 + m^2}.\n$$\n构建三个测试案例：\n- 案例1 (中心): $\\omega = \\tfrac{1}{2}\\left(\\omega_{-} + \\omega_{+}\\right)$.\n- 案例2 (靠近下边缘): $\\omega = \\omega_{-} + \\Delta\\omega$ 其中 $\\Delta\\omega = 0.2$ MeV.\n- 案例3 (靠近上边缘): $\\omega = \\omega_{+} - \\Delta\\omega$ 其中 $\\Delta\\omega = 0.2$ MeV.\n\n角度单位：在你的变量代换中引入的所有角度变量必须以弧度表示。\n\n最终输出格式规范：\n- 你的程序应生成单行输出，其中包含上述测试案例的三个比率 $\\mathcal{R}$，格式为逗号分隔的列表，并用方括号括起来，例如 $[\\mathcal{R}_1,\\mathcal{R}_2,\\mathcal{R}_3]$。\n- 每个 $\\mathcal{R}$ 都是一个无量纲的浮点数。输出行中不应出现任何物理单位符号。",
            "solution": "该问题是有效的，因为它在科学上基于核物理的相对论费米气体模型，数学上是适定的、客观的，并包含了唯一解所需的所有信息。我们按步骤进行求解。\n\n### 任务1：一维积分表示的有效性与奇异性分析\n\n起点是包容性准弹性响应的六维相空间积分，在均匀费米球和 $z$ 轴与动量转移 $\\mathbf{q}$ 对齐的假设下，该积分简化为：\n$$\nI(\\omega,q;k_F) = \\int_{|\\mathbf{p}|\\le k_F} d^3p \\ \\delta\\!\\left(\\omega + E(\\mathbf{p}) - E(\\mathbf{p}+\\mathbf{q})\\right)\n$$\n为了得到所给的二维积分，我们将体积元 $d^3p$ 用球坐标表示，其中 $\\mathbf{p}$ 的大小为 $p$，相对于 $\\mathbf{q}$ 的极角为 $\\theta$，方位角为 $\\phi$。体积元为 $d^3p = p^2 \\sin\\theta \\,dp \\,d\\theta \\,d\\phi$。由于坐标系的选择，delta函数的参数与 $\\phi$无关。对 $\\phi$ 从 $0$到 $2\\pi$ 积分得到一个因子 $2\\pi$。然后我们进行变量代换，从 $\\theta$ 换为 $x \\equiv \\cos\\theta$。微分变为 $dx = -\\sin\\theta \\,d\\theta$。$\\theta \\in [0, \\pi]$ 的积分范围映射到 $x \\in [1, -1]$。将 $x$ 的积分限反转为 $[-1, 1]$ 会抵消负号。因此积分为：\n$$\nI(\\omega,q;k_F) = 2\\pi \\int_{-1}^{1} dx \\int_{0}^{k_F} dp \\ p^2 \\ \\delta\\!\\left(g(p,x)\\right)\n$$\n其中 $g(p,x) \\equiv \\omega + \\sqrt{p^2 + m^2} - \\sqrt{p^2 + q^2 + 2pqx + m^2}$。\n\n为得到一维表示，我们对动量大小 $p$ 进行积分。这可以通过狄拉克delta函数的筛选性质来实现，该性质指出，对于一个函数 $f(y)$ 和一个具有简单根 $y_i$ 的函数 $h(y)$，\n$$\n\\int dy \\ f(y) \\delta(h(y)) = \\sum_i \\frac{f(y_i)}{|h'(y_i)|}\n$$\n其中求和遍及 $h(y)=0$ 在积分域内的所有根 $y_i$。在我们的例子中，积分变量是 $p$，函数是 $f(p) = p^2$，delta函数的参数是 $h(p) = g(p,x)$，其中 $x$ 被视为参数。导数 $h'(p)$ 是 $\\frac{\\partial g}{\\partial p}$。$p$ 的积分域是 $[0, k_F]$。因此，对于每个 $x$ 值，我们找到 $g(p,x)=0$ 的根 $p_i(x)$。对 $p$ 的积分计算结果为：\n$$\n\\int_{0}^{k_F} dp \\ p^2 \\ \\delta(g(p,x)) = \\sum_{i} \\frac{p_i(x)^2}{\\left|\\frac{\\partial g}{\\partial p}\\vert_{p=p_i(x)}\\right|}\n$$\n求和遍及所有满足 $0 \\le p_i(x) \\le k_F$ 的根 $p_i(x)$。将此结果代回 $I(\\omega,q;k_F)$ 的表达式中，即得到所述的一维积分表示：\n$$\nI(\\omega,q;k_F) = 2\\pi \\int_{-1}^{1} dx \\ \\sum_{i} \\frac{p_i(x)^2}{\\left|\\frac{\\partial g}{\\partial p}\\vert_{p_i(x)}\\right|}\n$$\n该表示在狄拉克delta函数的标准性质下是有效的。\n\n可积奇异行为的来源是分母 $\\left|\\frac{\\partial g}{\\partial p}\\right|$ 趋近于零。这发生在点 $(p,x)$ 处，此时由能量守恒约束 $g(p,x)=0$ 定义的曲线在 $(x,p)$ 平面中变为垂直，即 $\\frac{dp}{dx}$ 为无穷大。根据应用于 $g(p(x), x) = 0$ 的隐函数定理，我们有 $\\frac{\\partial g}{\\partial p}\\frac{dp}{dx} + \\frac{\\partial g}{\\partial x} = 0$，这给出 $\\frac{dp}{dx} = -\\frac{\\partial g/\\partial x}{\\partial g/\\partial p}$。因此，导数 $\\frac{dp}{dx}$ 为无穷大的充要条件是 $\\frac{\\partial g}{\\partial p} = 0$。\n\n让我们分析在运动学边缘附近被积函数的行为，例如，当根曲线 $p(x)$ 在某个 $x=x_0$ (其中 $x_0$ 通常为 $\\pm 1$)处与边界 $p=k_F$ 相切时。在这个切点 $(k_F, x_0)$，必须同时满足 $g(k_F, x_0) = 0$ 和 $\\frac{\\partial g}{\\partial p}\\vert_{(k_F, x_0)} = 0$。我们可以围绕此点对 $g(p,x)$ 进行局部泰勒展开。对于 $p$ 接近 $k_F$ 且 $x$ 接近 $x_0$：\n$$\ng(p,x) \\approx g(k_F,x_0) + (p-k_F)\\frac{\\partial g}{\\partial p}\\bigg|_{(k_F,x_0)} + (x-x_0)\\frac{\\partial g}{\\partial x}\\bigg|_{(k_F,x_0)} + \\frac{1}{2}(p-k_F)^2\\frac{\\partial^2 g}{\\partial p^2}\\bigg|_{(k_F,x_0)} + \\dots\n$$\n由于在切点处前两项为零，对于解曲线上的一个点 $(p(x), x)$，有 $g(p(x),x)=0$，这意味着：\n$$\n(x-x_0)\\frac{\\partial g}{\\partial x}\\bigg|_{(k_F,x_0)} + \\frac{1}{2}(p(x)-k_F)^2\\frac{\\partial^2 g}{\\partial p^2}\\bigg|_{(k_F,x_0)} \\approx 0\n$$\n假设二阶导数和关于 $x$ 的偏导数非零，我们发现：\n$$\n(p(x)-k_F)^2 \\propto (x_0-x) \\implies |p(x)-k_F| \\propto \\sqrt{|x_0-x|}\n$$\n这表明根 $p(x)$ 与边界 $k_F$ 的距离与 $x$ 与边缘 $x_0$ 的距离的平方根成正比。现在，我们考察分母 $\\frac{\\partial g}{\\partial p}$ 在此点附近的行为。将 $\\frac{\\partial g}{\\partial p}$ 在 $(k_F, x_0)$ 附近进行泰勒展开得到：\n$$\n\\frac{\\partial g}{\\partial p}\\bigg|_{(p(x),x)} \\approx \\frac{\\partial g}{\\partial p}\\bigg|_{(k_F,x_0)} + (p(x)-k_F)\\frac{\\partial^2 g}{\\partial p^2}\\bigg|_{(k_F,x_0)} \\approx (p(x)-k_F)\\frac{\\partial^2 g}{\\partial p^2}\\bigg|_{(k_F,x_0)}\n$$\n因此，分母的大小的行为如下：\n$$\n\\left|\\frac{\\partial g}{\\partial p}\\right| \\propto |p(x)-k_F| \\propto \\sqrt{|x_0-x|}\n$$\n被积函数与 $1/\\left|\\frac{\\partial g}{\\partial p}\\right|$ 成正比，因此当 $x \\to x_0$ 時，它表现出形如 $1/\\sqrt{|x_0-x|}$ 的平方根发散。这种奇异性是可积的，但对像高斯-勒让德这类为光滑、类多项式函数设计的标准数值求积方案构成了重大挑战。\n\n### 任务2：正则化变量代换\n\n为了处理积分域 $x \\in [-1, 1]$ 端点的可積平方根奇异性，我们提出一种变量代换。任务1的分析表明，在 $x=1$ 附近存在 $(1-x)^{-1/2}$ 类型的奇异性，在 $x=-1$ 附近存在 $(1+x)^{-1/2}$ 类型的奇异性。针对此类端点奇异性，一个高效的代换是：\n$$\nx = \\cos(\\theta)\n$$\n其中新的积分变量 $\\theta$ 是以弧度为单位的角度。当 $x$ 从 $-1$ 变化到 $1$ 时，$\\theta$ 从 $\\pi$ 变化到 $0$。微分为 $dx = -\\sin(\\theta) \\, d\\theta$。\n\n积分变换如下：\n$$\nI(\\omega,q;k_F) = 2\\pi \\int_{-1}^{1} dx \\ f(x) \\longrightarrow 2\\pi \\int_{\\pi}^{0} d\\theta \\ (-\\sin\\theta) \\ f(\\cos\\theta) = 2\\pi \\int_{0}^{\\pi} d\\theta \\ \\sin(\\theta) f(\\cos\\theta)\n$$\n其中 $f(x) = \\sum_{i} \\frac{p_i(x)^2}{\\left|\\partial g/\\partial p\\vert_{p_i(x)}\\right|}$。需要计算的新积分为：\n$$\nI(\\omega,q;k_F) = 2\\pi \\int_{0}^{\\pi} d\\theta \\ \\sin(\\theta) \\sum_{i} \\frac{p_i(\\cos\\theta)^2}{\\left|\\frac{\\partial g}{\\partial p}\\vert_{(p_i(\\cos\\theta),\\cos\\theta)}\\right|}\n$$\n让我们通过展示变换的雅可比行列式 $\\sin(\\theta)$ 如何消除奇异性来证明此选择的合理性。\n在运动学上边缘附近，$x \\to 1^-$，对应于 $\\theta \\to 0^+$。对于小的 $\\theta$，我们有 $1-x = 1 - \\cos\\theta \\approx \\frac{\\theta^2}{2}$。被积函数 $f(x)$ 的奇异部分行为类似于 $(1-x)^{-1/2} \\approx (\\frac{\\theta^2}{2})^{-1/2} = \\frac{\\sqrt{2}}{\\theta}$。雅可比行列式为 $\\sin\\theta \\approx \\theta$。变换后被积函数中的乘积为 $(\\frac{\\sqrt{2}}{\\theta}) \\times \\theta = \\sqrt{2}$，它在 $\\theta=0$ 处是有限且行为良好的。\n\n在运动学下边缘附近，$x \\to -1^+$，对应于 $\\theta \\to \\pi^-$。令 $\\phi = \\pi - \\theta$，则 $\\phi \\to 0^+$。我们有 $1+x = 1 + \\cos\\theta = 1 + \\cos(\\pi-\\phi) = 1 - \\cos\\phi \\approx \\frac{\\phi^2}{2}$。被积函数 $f(x)$ 的奇异部分行为类似于 $(1+x)^{-1/2} \\approx (\\frac{\\phi^2}{2})^{-1/2} = \\frac{\\sqrt{2}}{\\phi}$。在 $\\theta=\\pi$ 附近的雅可比行列式为 $\\sin\\theta = \\sin(\\pi-\\phi) = \\sin\\phi \\approx \\phi$。乘积为 $(\\frac{\\sqrt{2}}{\\phi}) \\times \\phi = \\sqrt{2}$，它在 $\\theta=\\pi$ 处也是有限且行为良好的。\n\n这种变量代換将原始的关于 $x$ 的奇异被积函数转换为在区间 $[0, \\pi]$ 上关于 $\\theta$ 的光滑、正则函数。这个正则化后的被积函数现在非常适合使用标准数值求积方法（如高斯-勒让德）进行高效、稳定的求值。\n\n### 任务3：计算实验实现\n\n对于每个测试案例，实现将包括三个主要部分：\n1.  **高精度参考值 ($I_{\\text{ref}}$)**：我们将使用正则化公式（在 $\\theta \\in [0, \\pi]$ 上积分），通过高精度自适应求积程序（`scipy.integrate.quad`）和 $10^{-9}$ 的严格绝对公差来计算积分。此结果将作为“基准真相”。\n2.  **朴素求积 ($I_{\\text{naive}}$)**：我们将使用 $x$ 在 $[-1, 1]$ 上的原始公式计算积分。将使用固定的 $N=16$ 点高斯-勒让德求积。由于未处理的奇异性，预计此方法在边缘情况下表现不佳。\n3.  **正则化求积 ($I_{\\text{reg}}$)**：我们将使用 $\\theta$ 在 $[0, \\pi]$ 上的正则化公式计算积分。将使用固定的 $N=16$ 点高斯-勒让德求积。预计此方法将比朴素方法准确得多。\n\n对于每个求积点，必须在 $[0, k_F]$ 内找到 $g(p,x)=0$ 的根 $p_i(x)$。这将在检查区间内是否存在根（通过检查 $g(p,x)$ 在 $p=0$ 和 $p=k_F$ 处的符号）之后，使用一个稳健的区间法（`scipy.optimize.brentq`）来完成。分母 $|\\partial g/\\partial p|$ 将被限制在 $10^{-12}$ 以防止浮点溢出。最后，将按规定为每个测试案例计算误差比 $\\mathcal{R}$。",
            "answer": "```python\nimport numpy as np\nfrom scipy import integrate, optimize\nfrom numpy.polynomial.legendre import leggauss\n\ndef solve():\n    \"\"\"\n    Validates the problem and implements the computational experiment for\n    neutrino-nucleus scattering response function calculation.\n    \"\"\"\n    # Physical constants in MeV\n    M_N = 939.0  # Nucleon mass\n    K_F = 250.0  # Fermi momentum\n    Q_MAG = 600.0 # Momentum transfer magnitude\n\n    # Numerical parameters\n    N_NODES = 16\n    TOL_REF = 1e-9\n    DGDP_CLAMP = 1e-12\n\n    def E_p(p, m):\n        \"\"\"Relativistic energy.\"\"\"\n        return np.sqrt(p**2 + m**2)\n\n    def g_func(p, x, omega, q, m):\n        \"\"\"Energy conservation constraint function g(p,x) = 0.\"\"\"\n        _E_p = E_p(p, m)\n        _E_p_plus_q = np.sqrt(p**2 + q**2 + 2 * p * q * x + m**2)\n        return omega + _E_p - _E_p_plus_q\n\n    def dg_dp_func(p, x, q, m):\n        \"\"\"Partial derivative of g with respect to p.\"\"\"\n        if p == 0:\n            # Handle the limit p-0 to avoid 0/0\n            _E_p_val = m\n            p_over_E_p = 0\n        else:\n            _E_p_val = E_p(p, m)\n            p_over_E_p = p / _E_p_val\n        \n        # Denominator in second term can't be zero since p, q  0 and m^2  0\n        _E_p_plus_q_val = np.sqrt(p**2 + q**2 + 2 * p * q * x + m**2)\n        return p_over_E_p - (p + q * x) / _E_p_plus_q_val\n\n    def get_integrand_value(x, omega, q, m, k_f):\n        \"\"\"\n        Calculates the value of the integrand p^2/|dg/dp| for a given x.\n        This involves finding the root of g(p,x)=0.\n        \"\"\"\n        # Define g for the current x and omega\n        g_p = lambda p: g_func(p, x, omega, q, m)\n        \n        try:\n            # Check for a root in the interval [0, k_f]\n            # If g(0) and g(k_f) have the same sign, brentq will fail.\n            # This indicates no root (or an even number of roots, typically none for this physics).\n            val_at_0 = g_p(0)\n            val_at_k_f = g_p(k_f)\n            if val_at_0 * val_at_k_f = 0:\n                return 0.0\n            \n            p_root = optimize.brentq(g_p, 0, k_f)\n        except ValueError:\n            # No root found in the bracket\n            return 0.0\n\n        dg_dp_val = dg_dp_func(p_root, x, q, m)\n        \n        # Clamp the absolute value of the derivative to avoid overflow\n        abs_dg_dp = max(abs(dg_dp_val), DGDP_CLAMP)\n        \n        return p_root**2 / abs_dg_dp\n\n    # Define integrands for different methods\n    def integrand_naive(x, omega, q, m, k_f):\n        return get_integrand_value(x, omega, q, m, k_f)\n\n    def integrand_regularized(theta, omega, q, m, k_f):\n        x = np.cos(theta)\n        # Jacobian from x=cos(theta) change of variables\n        jacobian = np.sin(theta)\n        return get_integrand_value(x, omega, q, m, k_f) * jacobian\n\n    # Define kinematic edge energies\n    def omega_pm(q, k_f, m):\n        e_kf = E_p(k_f, m)\n        omega_minus = E_p(q - k_f, m) - e_kf\n        omega_plus = E_p(q + k_f, m) - e_kf\n        return omega_minus, omega_plus\n\n    omega_minus, omega_plus = omega_pm(Q_MAG, K_F, M_N)\n    delta_omega = 0.2\n\n    test_cases = [\n        0.5 * (omega_minus + omega_plus),  # Case 1: Central\n        omega_minus + delta_omega,         # Case 2: Near lower edge\n        omega_plus - delta_omega,          # Case 3: Near upper edge\n    ]\n\n    results = []\n    \n    # Get Gauss-Legendre nodes and weights for [-1, 1]\n    gl_nodes, gl_weights = leggauss(N_NODES)\n\n    for omega in test_cases:\n        args = (omega, Q_MAG, M_N, K_F)\n\n        # a) Naive quadrature calculation\n        integral_naive_sum = sum(w * integrand_naive(x, *args) for x, w in zip(gl_nodes, gl_weights))\n        I_naive = 2.0 * np.pi * integral_naive_sum\n\n        # b) Regularized quadrature calculation\n        # Transform GL quadrature from u in [-1,1] to theta in [0,pi]\n        # theta = (pi/2)(u+1) - d(theta) = (pi/2)du\n        theta_nodes = 0.5 * np.pi * (gl_nodes + 1.0)\n        integral_reg_sum = sum(w * integrand_regularized(th, *args) for th, w in zip(theta_nodes, gl_weights))\n        I_reg = 2.0 * np.pi * (0.5 * np.pi) * integral_reg_sum\n\n        # c) High-accuracy reference calculation\n        ref_result, _ = integrate.quad(integrand_regularized, 0, np.pi, args=args, epsabs=TOL_REF, limit=200)\n        I_ref = 2.0 * np.pi * ref_result\n\n        # Calculate errors and the ratio\n        err_naive = abs(I_naive - I_ref)\n        err_reg = abs(I_reg - I_ref)\n\n        # Handle the case where the regularized method is perfectly accurate\n        if err_reg  1e-15: # effectively zero\n             if err_naive  1e-15:\n                 ratio = 1.0 # Both are perfect\n             else:\n                 ratio = np.inf # Regularized is perfect, naive is not\n        else:\n             ratio = err_naive / err_reg\n        results.append(ratio)\n\n    print(f\"[{','.join(f'{r:.6f}' for r in results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "现代中微子散射模型通常将包容性截面（inclusive cross section）分解为多个反应道的贡献之和，例如准弹性（Quasi-Elastic, QE）散射和更复杂的双粒子-双空穴（2-particle-2-hole, 2p2h）激发。理论模型中的不确定性，尤其是对那些难以从第一性原理计算的贡献（如2p2h）的建模，是当前研究的重点。本练习要求您构建一个包含QE和2p2h贡献的包容性截面玩具模型，并系统地研究截面对介子交换流（meson-exchange current）模型中一个关键参数——$\\pi$介子形状因子截止参数（pion form factor cutoff）$\\Lambda_\\pi$——的敏感性。",
            "id": "3572496",
            "problem": "考虑在中微子能量为 $E_\\nu$ 时，发生在自旋饱和、同位旋标量靶上的带电流包容性中微子-原子核散射。每个核子的总包容性截面 $\\sigma_{\\text{inc}}(E_\\nu;\\Lambda_\\pi)$ 可以建模为一个准弹性部分和一个双粒子-双空穴 (2p2h) 介子交换流部分之和。本题旨在通过将 π 介子形状因子截止 $\\Lambda_\\pi$ 的变化传播到 2p2h 强度中，探究并量化包容性截面如何响应这种变化。\n\n起点与假设：\n- 包容性截面由轻子张量和强子张量的缩并在允许的运动学范围内积分确定。在一个因子分解模型中，可将不同机制视为可加的：$\\sigma_{\\text{inc}} = \\sigma_{\\text{QE}} + \\sigma_{\\text{2p2h}}$，其中 $\\sigma_{\\text{QE}}$ 是准弹性贡献，$\\sigma_{\\text{2p2h}}$ 是导致双核子发射的介子交换流贡献。\n- 将费米耦合常数 $G_F$ 和卡比博角因子 $\\cos\\theta_C$ 视为已知且固定，并假设四动量转移平方的近似上限为 $Q^2_{\\max} \\approx 2 m_N E_\\nu$，其中 $m_N$ 是核子质量。这为此模型中的运动学积分提供了有限的积分范围。\n- 对于准弹性部分，使用矢量质量 $M_V$ 和轴向质量 $M_A$ 以及轴向电荷 $g_A(0)$ 的偶极形式对核子矢量和轴矢量形状因子的平方进行建模。在此简化的能量平均模型中，将准弹性强度近似为在 $Q^2 \\in [0,Q^2_{\\max}]$ 上的加权积分。\n- 对于双粒子-双空穴部分，假设横向介子交换流响应受到截止为 $\\Lambda_\\pi$ 的 π 介子形状因子和一个平滑的运动学权重的调制。设 π 介子形状因子为 $Q^2$ 的单极形式，并假设能量依赖性通过一个在高 $E_\\nu$ 时饱和的平滑因子引入。\n\n定义和参数：\n- 设 $G_F$ 为费米耦合常数（单位 $\\mathrm{GeV}^{-2}$），$\\cos\\theta_C$ 为卡比博角的余弦， $m_N$ 为核子质量（单位 $\\mathrm{GeV}$）。\n- 定义从 $\\mathrm{GeV}^{-2}$ 到 $\\mathrm{cm}^2$ 的转换系数 $C_{\\mathrm{conv}}$。\n- 准弹性贡献建模为\n$$\n\\sigma_{\\text{QE}}(E_\\nu) = S_0 \\, G_F^2 \\cos^2\\theta_C \\, E_\\nu \\, m_N \\, \\mathcal{I}_{\\text{QE}}(Q^2_{\\max}),\n$$\n其中 $S_0$ 是一个无量纲的缩放常数，且\n$$\n\\mathcal{I}_{\\text{QE}}(Q^2_{\\max}) = \\int_{0}^{Q^2_{\\max}} \\left[ \\left(\\frac{1}{1 + \\frac{Q^2}{M_V^2}}\\right)^4 + g_A(0)^2 \\left(\\frac{1}{1 + \\frac{Q^2}{M_A^2}}\\right)^4 \\right] \\, dQ^2.\n$$\n- 双粒子-双空穴贡献建模为\n$$\n\\sigma_{\\text{2p2h}}(E_\\nu;\\Lambda_\\pi) = S_1 \\, G_F^2 \\cos^2\\theta_C \\, E_\\nu \\, m_N \\, \\frac{E_\\nu}{E_\\nu + E_0} \\, \\mathcal{I}_{\\text{2p2h}}(Q^2_{\\max};\\Lambda_\\pi),\n$$\n其中 $S_1$ 是一个无量纲的缩放常数，$E_0$ 是一个平滑的能量尺度，且\n$$\n\\mathcal{I}_{\\text{2p2h}}(Q^2_{\\max};\\Lambda_\\pi) = \\int_{0}^{Q^2_{\\max}} \\exp\\!\\left(-\\frac{Q^2}{\\beta}\\right) \\left(\\frac{\\Lambda_\\pi^2}{\\Lambda_\\pi^2 + Q^2}\\right)^2 \\, dQ^2.\n$$\n- π 介子形状因子为 $F_\\pi(Q^2;\\Lambda_\\pi) = \\frac{\\Lambda_\\pi^2}{\\Lambda_\\pi^2 + Q^2}$，它以平方形式进入 2p2h 的被积函数，以表示受截止抑制的低 $Q^2$ π 介子交换的主导地位。\n\n任务：\n- 实现一个程序，使用上述定义计算 $\\sigma_{\\text{QE}}(E_\\nu)$ 和 $\\sigma_{\\text{2p2h}}(E_\\nu;\\Lambda_\\pi)$，然后构成每个核子的包容性截面：\n$$\n\\sigma_{\\text{inc}}(E_\\nu;\\Lambda_\\pi) = \\sigma_{\\text{QE}}(E_\\nu) + \\sigma_{\\text{2p2h}}(E_\\nu;\\Lambda_\\pi).\n$$\n- 使用以下常数：\n    - $G_F = 1.1663787 \\times 10^{-5}$ 单位 $\\mathrm{GeV}^{-2}$，\n    - $\\cos\\theta_C = 0.97420$，\n    - $m_N = 0.939$ 单位 $\\mathrm{GeV}$，\n    - $C_{\\mathrm{conv}} = 0.389379 \\times 10^{-27}$ 单位 $\\mathrm{cm}^2/\\mathrm{GeV}^{-2}$，\n    - $M_V = 0.84$ 单位 $\\mathrm{GeV}$，\n    - $M_A = 1.03$ 单位 $\\mathrm{GeV}$，\n    - $g_A(0) = 1.267$，\n    - $E_0 = 0.2$ 单位 $\\mathrm{GeV}$，\n    - $\\beta = 0.6$ 单位 $\\mathrm{GeV}^2$，\n    - $S_0 = 0.2$，\n    - $S_1 = 0.08$。\n- 程序必须以 $10^{-38} \\, \\mathrm{cm}^2$ 每核子为单位表示最终截面。也就是说，将计算出的 $\\mathrm{cm}^2$ 截面除以 $10^{-38}$，以产生代表以 $10^{-38} \\, \\mathrm{cm}^2$ 为单位的截面的无量纲数。\n- 为量化灵敏度，定义一个参考截止 $\\Lambda_\\pi^{\\mathrm{ref}} = 1.0$ GeV 并计算比值\n$$\n\\mathcal{S}(E_\\nu,\\Lambda_\\pi) = \\frac{\\sigma_{\\text{inc}}(E_\\nu;\\Lambda_\\pi)}{\\sigma_{\\text{inc}}(E_\\nu;\\Lambda_\\pi^{\\mathrm{ref}})}.\n$$\n\n测试套件：\n- 使用中微子能量 $E_\\nu \\in \\{0.3, 0.6, 1.0, 2.0\\}$ GeV。\n- 使用 π 介子截止值 $\\Lambda_\\pi \\in \\{0.6, 0.8, 1.0, 1.2, 1.4\\}$ GeV。\n- 从这些集合中构成所有的 $(E_\\nu,\\Lambda_\\pi)$ 组合（共 20 个测试用例），为每个组合计算 $\\mathcal{S}(E_\\nu,\\Lambda_\\pi)$，并汇总结果。\n\n最终输出规格：\n您的程序应生成单行输出，其中包含 20 个灵敏度比率，其顺序为：按升序迭代 $E_\\nu$，并对每个 $E_\\nu$ 按升序迭代 $\\Lambda_\\pi$。该行必须是方括号括起来的逗号分隔列表（例如 $\\texttt{[result1,result2,\\dots]}$）。不应打印任何其他文本。",
            "solution": "出发点是将包容性截面分解为对强子张量有贡献的可加机制。在带電流中微子-原子核散射中，一种常用的因子分解方法是考虑准弹性（单核子敲出）通道和双粒子-双空穴介子交换流通道，因此可以写出\n$$\n\\sigma_{\\text{inc}}(E_\\nu;\\Lambda_\\pi) = \\sigma_{\\text{QE}}(E_\\nu) + \\sigma_{\\text{2p2h}}(E_\\nu;\\Lambda_\\pi).\n$$\n这种分离与在包容性可观测量中将不同的多体响应视为非相干处理是一致的，其基础是双微分截面的一般表达式，\n$$\n\\frac{d^2 \\sigma}{d\\Omega \\, dE'} = \\frac{G_F^2 \\cos^2\\theta_C}{4\\pi^2} \\, k' E' \\sum_{i} v_i(E_\\nu, E', \\theta) R_i(q,\\omega),\n$$\n其中 $R_i$ 是依赖于能量转移 $\\omega$ 和三动量转移 $q$ 的核响应函数，而 $v_i$ 是由轻子张量决定的运动学系数。通过对末态轻子运动学进行积分，可以构成每个响应通道的能量平均强度。在一个专注于对 π 介子截止的参数敏感性的简化模型中，很自然地将详细的角相空间和多体动力学吸收到具有物理动机的形状因子的 $Q^2$ 领头阶积分中。\n\n对于准弹性部分，占主導地位的核子形状因子由偶极子建模。将矢量偶极质量记为 $M_V$，轴向偶极质量记为 $M_A$，零动量转移时的轴向电荷记为 $g_A(0)$，则形状因子的平方可取为\n$$\n|F_V(Q^2)|^2 \\approx \\left(\\frac{1}{1 + \\frac{Q^2}{M_V^2}}\\right)^4, \\qquad |F_A(Q^2)|^2 \\approx g_A(0)^2 \\left(\\frac{1}{1 + \\frac{Q^2}{M_A^2}}\\right)^4.\n$$\n我们接着定义能量平均的准弹性强度为\n$$\n\\mathcal{I}_{\\text{QE}}(Q^2_{\\max}) = \\int_{0}^{Q^2_{\\max}} \\left[ \\left(\\frac{1}{1 + \\frac{Q^2}{M_V^2}}\\right)^4 + g_A(0)^2 \\left(\\frac{1}{1 + \\frac{Q^2}{M_A^2}}\\right)^4 \\right] \\, dQ^2,\n$$\n其中上限 $Q^2_{\\max} \\approx 2 m_N E_\\nu$ 捕捉了在静止核子上进行固定靶散射的近似运动学范围。这个积分可以通过代换 $x = Q^2/M^2$ 并使用以下公式来解析地计算\n$$\n\\int \\frac{dx}{(1+x)^4} = -\\frac{1}{3 (1+x)^3} + \\text{constant},\n$$\n得到闭合形式\n$$\n\\int_{0}^{Q^2_{\\max}} \\left(\\frac{1}{1 + \\frac{Q^2}{M^2}}\\right)^4 \\, dQ^2 = \\frac{M^2}{3} \\left[ 1 - \\frac{1}{\\left(1 + \\frac{Q^2_{\\max}}{M^2}\\right)^3} \\right].\n$$\n将此应用于矢量和轴向部分可得\n$$\n\\mathcal{I}_{\\text{QE}}(Q^2_{\\max}) = \\frac{M_V^2}{3} \\left[ 1 - \\left(1 + \\frac{Q^2_{\\max}}{M_V^2}\\right)^{-3} \\right] + g_A(0)^2 \\frac{M_A^2}{3} \\left[ 1 - \\left(1 + \\frac{Q^2_{\\max}}{M_A^2}\\right)^{-3} \\right].\n$$\n准弹性截面按以下方式缩放\n$$\n\\sigma_{\\text{QE}}(E_\\nu) = S_0 \\, G_F^2 \\cos^2\\theta_C \\, E_\\nu \\, m_N \\, \\mathcal{I}_{\\text{QE}}(Q^2_{\\max}),\n$$\n其中 $S_0$ 经过调整以表示被省略的运动学和核效应，同时确保其量级符合实际。\n\n对于双粒子-双空穴介子交换流部分，响应主要是横向的，并涉及 π 介子交换，其强度受到一个以截止 $\\Lambda_\\pi$ 为特征的 π 介子形状因子的调制。一种广泛使用的单极形式是\n$$\nF_\\pi(Q^2;\\Lambda_\\pi) = \\frac{\\Lambda_\\pi^2}{\\Lambda_\\pi^2 + Q^2},\n$$\n使得 $|F_\\pi|^2$ 抑制了大的 $Q^2$ 贡献。为了表示平滑的相空间和多核子关联，使用一个运动学权重，该权重会指数式地抑制大的 $Q^2$，并随中微子能量的增加趋于一个常数，\n$$\n\\mathcal{I}_{\\text{2p2h}}(Q^2_{\\max};\\Lambda_\\pi) = \\int_{0}^{Q^2_{\\max}} \\exp\\!\\left(-\\frac{Q^2}{\\beta}\\right) \\left(\\frac{\\Lambda_\\pi^2}{\\Lambda_\\pi^2 + Q^2}\\right)^2 \\, dQ^2,\n$$\n其中正数 $\\beta$ 控制 $Q^2$ 的衰减。能量依赖性通过因子 $\\frac{E_\\nu}{E_\\nu+E_0}$ 进入，该因子会平滑饱和，其中 $E_0$ 是一个标度参数。于是 2p2h 截面为\n$$\n\\sigma_{\\text{2p2h}}(E_\\nu;\\Lambda_\\pi) = S_1 \\, G_F^2 \\cos^2\\theta_C \\, E_\\nu \\, m_N \\, \\frac{E_\\nu}{E_\\nu+E_0} \\, \\mathcal{I}_{\\text{2p2h}}(Q^2_{\\max};\\Lambda_\\pi),\n$$\n其中 $S_1$ 设定了在参考截止值下介子交换流的总强度。\n\n单位处理：\n按书写形式，这些因子产生的截面单位为 $\\mathrm{GeV}^{-2}$。要转换为 $\\mathrm{cm}^2$，需乘以将 $\\mathrm{GeV}^{-2}$ 转换为 $\\mathrm{cm}^2$ 的因子 $C_{\\mathrm{conv}}$，\n$$\n\\sigma_{\\mathrm{cm^2}} = \\sigma_{\\mathrm{GeV}^{-2}} \\times C_{\\mathrm{conv}},\n$$\n然后除以 $10^{-38}$ 以 $10^{-38} \\, \\mathrm{cm}^2$ 为单位表示。\n\n灵敏度度量：\n为量化改变 $\\Lambda_\\pi$ 的效应，固定一个参考截止 $\\Lambda_\\pi^{\\mathrm{ref}} = 1.0 \\, \\mathrm{GeV}$ 并定义\n$$\n\\mathcal{S}(E_\\nu,\\Lambda_\\pi) = \\frac{\\sigma_{\\text{QE}}(E_\\nu) + \\sigma_{\\text{2p2h}}(E_\\nu;\\Lambda_\\pi)}{\\sigma_{\\text{QE}}(E_\\nu) + \\sigma_{\\text{2p2h}}(E_\\nu;\\Lambda_\\pi^{\\mathrm{ref}})}.\n$$\n该比率是无量纲的，在 $\\Lambda_\\pi = \\Lambda_\\pi^{\\mathrm{ref}}$ 时等于 1，并且分离出了由 π 介子截止通过 2p2h 通道传播而引起的包容性强度的变化。\n\n算法步骤：\n- 对每个测试能量 $E_\\nu$，计算 $Q^2_{\\max} = 2 m_N E_\\nu$。\n- 使用偶极积分的闭合形式表达式，以 $(M_V, M_A, g_A(0))$ 计算 $\\mathcal{I}_{\\text{QE}}(Q^2_{\\max})$。\n- 使用给定的 $S_0$ 和常数计算 $\\sigma_{\\text{QE}}(E_\\nu)$，转换为 $\\mathrm{cm}^2$，然后再转换为 $10^{-38} \\, \\mathrm{cm}^2$ 单位。\n- 对测试集中的每个 $\\Lambda_\\pi$，在 $Q^2 \\in [0,Q^2_{\\max}]$ 上数值计算 $\\mathcal{I}_{\\text{2p2h}}(Q^2_{\\max};\\Lambda_\\pi)$，使用稳定的求积方法，如对平滑被积函数适用的具有相对容差的自适应积分。\n- 使用给定的 $S_1$ 计算 $\\sigma_{\\text{2p2h}}(E_\\nu;\\Lambda_\\pi)$，如上转换单位，然后构成 $\\sigma_{\\text{inc}}(E_\\nu;\\Lambda_\\pi) = \\sigma_{\\text{QE}}(E_\\nu) + \\sigma_{\\text{2p2h}}(E_\\nu;\\Lambda_\\pi)$。\n- 在 $\\Lambda_\\pi^{\\mathrm{ref}} = 1.0 \\, \\mathrm{GeV}$ 处计算参考截面 $\\sigma_{\\text{inc}}(E_\\nu;\\Lambda_\\pi^{\\mathrm{ref}})$，并为每个测试用例构成 $\\mathcal{S}(E_\\nu,\\Lambda_\\pi)$。\n- 按要求的顺序汇总 20 个灵敏度比率，并将它们打印为方括号括起来的单个逗号分隔列表。\n\n覆盖范围与边界情况：\n- 测试能量 $E_\\nu \\in \\{0.3, 0.6, 1.0, 2.0\\}$ 探测了与加速器中微子相关的低、中、高能区。在低 $E_\\nu$ 时，准弹性部分占主导，$\\mathcal{S}$ 保持接近 1，因为 2p2h 部分占比很小。随着 $E_\\nu$ 增加，2p2h 强度通过因子 $\\frac{E_\\nu}{E_\\nu+E_0}$ 增长，对 $\\Lambda_\\pi$ 的灵敏度也随之增加。\n- 截止值集合 $\\Lambda_\\pi \\in \\{0.6, 0.8, 1.0, 1.2, 1.4\\} \\, \\mathrm{GeV}$ 涵盖了核模型中使用的合理范围，用于测试 π 介子介导流中的抑制/增强效应。\n- 数值积分是良态的，因为被積函數在有限区间上平滑、严格为正且快速衰减；采用适度容差的自适应求积法可产生稳定的结果。\n\n最终程序实现了这些步骤，遵守单位规范，并以规定的格式输出所需的灵敏度比率。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\n\n# Physical constants and model parameters\nG_F = 1.1663787e-5          # GeV^-2\ncos_theta_C = 0.97420       # dimensionless\nm_N = 0.939                 # GeV\nGEV2_TO_CM2 = 0.389379e-27  # cm^2 / GeV^-2\n\n# Nucleon form factor parameters\nM_V = 0.84                  # GeV\nM_A = 1.03                  # GeV\ngA0 = 1.267                 # axial charge\n\n# 2p2h model parameters\nE0 = 0.2                    # GeV\nbeta = 0.6                  # GeV^2\n\n# Scaling constants to set realistic magnitudes\nS0 = 0.2                    # QE strength scale (dimensionless)\nS1 = 0.08                   # 2p2h strength scale (dimensionless)\n\n# Reference cutoff\nLambda_pi_ref = 1.0         # GeV\n\ndef Q2_max(E_nu):\n    \"\"\"Approximate upper limit of Q^2 for fixed-target scattering: Q^2_max ≈ 2 m_N E_nu.\"\"\"\n    return 2.0 * m_N * E_nu\n\ndef dipole_integral(Q2m, M):\n    \"\"\"\n    Closed-form integral of [1 / (1 + Q^2 / M^2)]^4 dQ^2 from 0 to Q2m:\n    = (M^2 / 3) * [1 - (1 + Q2m / M^2)^(-3)]\n    \"\"\"\n    return (M**2 / 3.0) * (1.0 - (1.0 + Q2m / M**2)**(-3.0))\n\ndef sigma_QE_1e38(E_nu):\n    \"\"\"\n    Compute QE cross section per nucleon in units of 1e-38 cm^2 using the simplified model.\n    \"\"\"\n    Q2m = Q2_max(E_nu)\n    I_V = dipole_integral(Q2m, M_V)\n    I_A = dipole_integral(Q2m, M_A)\n    I_QE = I_V + (gA0**2) * I_A  # dimensionless integral in GeV^2 units\n    sigma_gevm2 = S0 * (G_F**2) * (cos_theta_C**2) * E_nu * m_N * I_QE\n    sigma_cm2 = sigma_gevm2 * GEV2_TO_CM2\n    return sigma_cm2 / 1e-38\n\ndef F_pi_squared(Q2, Lambda_pi):\n    \"\"\"Pion form factor squared (monopole squared) as a function of Q2 and cutoff Lambda_pi.\"\"\"\n    return (Lambda_pi**2 / (Lambda_pi**2 + Q2))**2\n\ndef two_p_two_h_integrand(Q2, Lambda_pi):\n    \"\"\"Integrand for the 2p2h Q^2 integral.\"\"\"\n    return np.exp(-Q2 / beta) * F_pi_squared(Q2, Lambda_pi)\n\ndef sigma_2p2h_1e38(E_nu, Lambda_pi):\n    \"\"\"\n    Compute 2p2h cross section per nucleon in units of 1e-38 cm^2 using the simplified model.\n    \"\"\"\n    Q2m = Q2_max(E_nu)\n    I_2p2h, _ = quad(two_p_two_h_integrand, 0.0, Q2m, args=(Lambda_pi,), epsrel=1e-7, epsabs=0.0, limit=200)\n    energy_factor = E_nu / (E_nu + E0)\n    sigma_gevm2 = S1 * (G_F**2) * (cos_theta_C**2) * E_nu * m_N * energy_factor * I_2p2h\n    sigma_cm2 = sigma_gevm2 * GEV2_TO_CM2\n    return sigma_cm2 / 1e-38\n\ndef sigma_inc_1e38(E_nu, Lambda_pi):\n    \"\"\"Inclusive cross section (QE + 2p2h) in units of 1e-38 cm^2.\"\"\"\n    return sigma_QE_1e38(E_nu) + sigma_2p2h_1e38(E_nu, Lambda_pi)\n\ndef solve():\n    # Define the test cases from the problem statement.\n    E_nu_values = [0.3, 0.6, 1.0, 2.0]         # GeV\n    Lambda_pi_values = [0.6, 0.8, 1.0, 1.2, 1.4]  # GeV\n\n    results = []\n    for E in E_nu_values:\n        sigma_ref = sigma_inc_1e38(E, Lambda_pi_ref)\n        for L in Lambda_pi_values:\n            sigma_cur = sigma_inc_1e38(E, L)\n            sensitivity = sigma_cur / sigma_ref\n            results.append(sensitivity)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}