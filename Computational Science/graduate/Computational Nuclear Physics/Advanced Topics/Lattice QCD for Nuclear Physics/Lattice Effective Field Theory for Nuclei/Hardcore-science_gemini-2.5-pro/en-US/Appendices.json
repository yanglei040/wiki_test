{
    "hands_on_practices": [
        {
            "introduction": "Before simulating complex nuclei, we must understand the properties of the lattice itself. This first exercise explores the most fundamental consequence of replacing continuous space with a discrete grid: the breaking of rotational symmetry. By deriving the energy-momentum relationship, or dispersion relation, for a single free particle, you will directly calculate how the lattice distorts physical laws and see why correcting for these artifacts is a central theme in lattice calculations .",
            "id": "3567125",
            "problem": "Consider low-energy nuclear dynamics formulated within Effective Field Theory (EFT) on a three-dimensional cubic spatial lattice with lattice spacing $a$ and Periodic Boundary Conditions (PBC). Work in the one-nucleon sector where interactions are absent and the dynamics are governed by the nonrelativistic kinetic energy operator. The continuum free-particle Hamiltonian is given by $H = -(\\hbar^{2}/2m)\\nabla^{2}$, where $m$ is the nucleon mass and $\\hbar$ is Planck’s constant divided by $2\\pi$. On the lattice, the kinetic term is defined by a discrete Laplacian constructed to be accurate to order $\\mathcal{O}(a^{2})$ and to respect cubic symmetry. \n\nStarting from the Taylor expansion of $f(\\mathbf{r} \\pm a\\hat{\\mathbf{e}}_{i})$ about $f(\\mathbf{r})$ and the requirement that the discrete Laplacian approximate the continuum Laplacian $\\nabla^{2}$ with truncation error $\\mathcal{O}(a^{2})$, construct the seven-point stencil for the lattice Laplacian in three dimensions, and hence the corresponding lattice kinetic operator. Using this lattice operator, derive the single-particle dispersion relation $E(\\mathbf{k})$ for a plane-wave eigenstate $\\psi(\\mathbf{r}) = \\exp(i\\mathbf{k}\\cdot\\mathbf{r})$ of lattice momentum $\\mathbf{k}$.\n\nTo quantify rotational symmetry breaking induced by the lattice discretization, consider two momenta with the same magnitude $|\\mathbf{k}| = k$: one along a coordinate axis, $\\mathbf{k}_{\\text{ax}} = (k, 0, 0)$, and one along the body diagonal, $\\mathbf{k}_{\\text{bd}} = (k/\\sqrt{3}, k/\\sqrt{3}, k/\\sqrt{3})$. Define the dimensionless anisotropy measure\n$$\nR(x) = \\frac{E(\\mathbf{k}_{\\text{ax}}) - E(\\mathbf{k}_{\\text{bd}})}{E_{\\text{cont}}(k)},\n$$\nwhere $x = k a$ and $E_{\\text{cont}}(k) = \\hbar^{2}k^{2}/(2m)$ is the continuum dispersion. Derive a closed-form expression for $R(x)$ and its small-$x$ series expansion about $x=0$. Report, as your final answer, the leading-order coefficient $c$ in the expansion $R(x) = c\\,x^{2} + \\mathcal{O}(x^{4})$. Express the final answer as a unitless exact number; no rounding is required.",
            "solution": "The problem statement is validated as scientifically grounded, well-posed, and self-contained. It describes a standard problem in lattice field theory concerning the discretization of a kinetic energy operator and the analysis of the resulting artifacts, specifically the breaking of rotational symmetry. We may proceed with the solution.\n\nThe first step is to construct the discrete lattice Laplacian, denoted $\\nabla^2_{\\text{lat}}$, which approximates the continuum Laplacian $\\nabla^2$ with a truncation error of order $\\mathcal{O}(a^2)$, where $a$ is the lattice spacing. We consider a scalar function $f(\\mathbf{r})$ on the lattice, where $\\mathbf{r}$ represents a point on the cubic grid. For any of the three spatial directions, indexed by $i \\in \\{1, 2, 3\\}$, we perform a Taylor series expansion of $f$ at neighboring sites $\\mathbf{r} \\pm a\\hat{\\mathbf{e}}_i$ around the point $\\mathbf{r}$, where $\\hat{\\mathbf{e}}_i$ is the unit vector along the $i$-th axis.\nThe expansions are:\n$$f(\\mathbf{r} + a\\hat{\\mathbf{e}}_i) = f(\\mathbf{r}) + a \\frac{\\partial f}{\\partial r_i} + \\frac{a^2}{2!} \\frac{\\partial^2 f}{\\partial r_i^2} + \\frac{a^3}{3!} \\frac{\\partial^3 f}{\\partial r_i^3} + \\frac{a^4}{4!} \\frac{\\partial^4 f}{\\partial r_i^4} + \\mathcal{O}(a^5)$$\n$$f(\\mathbf{r} - a\\hat{\\mathbf{e}}_i) = f(\\mathbf{r}) - a \\frac{\\partial f}{\\partial r_i} + \\frac{a^2}{2!} \\frac{\\partial^2 f}{\\partial r_i^2} - \\frac{a^3}{3!} \\frac{\\partial^3 f}{\\partial r_i^3} + \\frac{a^4}{4!} \\frac{\\partial^4 f}{\\partial r_i^4} - \\mathcal{O}(a^5)$$\nAdding these two equations eliminates terms with odd powers of $a$:\n$$f(\\mathbf{r} + a\\hat{\\mathbf{e}}_i) + f(\\mathbf{r} - a\\hat{\\mathbf{e}}_i) = 2f(\\mathbf{r}) + a^2 \\frac{\\partial^2 f}{\\partial r_i^2} + \\frac{a^4}{12} \\frac{\\partial^4 f}{\\partial r_i^4} + \\mathcal{O}(a^6)$$\nRearranging this to solve for the second partial derivative gives the central difference formula:\n$$\\frac{\\partial^2 f}{\\partial r_i^2} = \\frac{1}{a^2} \\left[ f(\\mathbf{r} + a\\hat{\\mathbf{e}}_i) + f(\\mathbf{r} - a\\hat{\\mathbf{e}}_i) - 2f(\\mathbf{r}) \\right] - \\frac{a^2}{12} \\frac{\\partial^4 f}{\\partial r_i^4} + \\mathcal{O}(a^4)$$\nThe leading error term is proportional to $a^2$, so this form provides an approximation to $\\frac{\\partial^2 f}{\\partial r_i^2}$ that is accurate to order $\\mathcal{O}(a^2)$. To construct the three-dimensional Laplacian, $\\nabla^2 = \\sum_{i=1}^3 \\frac{\\partial^2}{\\partial r_i^2}$, we sum the central difference expressions for $i=1, 2, 3$:\n$$\\nabla^2 f(\\mathbf{r}) = \\frac{1}{a^2} \\sum_{i=1}^3 \\left[ f(\\mathbf{r} + a\\hat{\\mathbf{e}}_i) + f(\\mathbf{r} - a\\hat{\\mathbf{e}}_i) - 2f(\\mathbf{r}) \\right] + \\mathcal{O}(a^2)$$\nThe lattice Laplacian operator, $\\nabla^2_{\\text{lat}}$, is defined by dropping the error terms:\n$$\\nabla^2_{\\text{lat}} f(\\mathbf{r}) = \\frac{1}{a^2} \\left( \\sum_{i=1}^3 \\left[ f(\\mathbf{r} + a\\hat{\\mathbf{e}}_i) + f(\\mathbf{r} - a\\hat{\\mathbf{e}}_i) \\right] - 6f(\\mathbf{r}) \\right)$$\nThis operator uses the function values at the central point $\\mathbf{r}$ and its six nearest neighbors, thus constituting the required seven-point stencil.\n\nThe nonrelativistic kinetic energy operator on the lattice, $H_{\\text{lat}}$, is obtained by substituting $\\nabla^2_{\\text{lat}}$ into the continuum expression $H = -(\\hbar^2/2m)\\nabla^2$:\n$$H_{\\text{lat}} = -\\frac{\\hbar^2}{2m} \\nabla^2_{\\text{lat}} = -\\frac{\\hbar^2}{2ma^2} \\left( \\sum_{i=1}^3 \\left[ T_i^+ + T_i^- \\right] - 6 \\right)$$\nwhere $T_i^{\\pm}$ are translation operators such that $T_i^{\\pm} f(\\mathbf{r}) = f(\\mathbf{r} \\pm a\\hat{\\mathbf{e}}_i)$.\n\nNext, we derive the single-particle dispersion relation $E(\\mathbf{k})$ by finding the eigenvalues of $H_{\\text{lat}}$ for a plane-wave state $\\psi(\\mathbf{r}) = \\exp(i\\mathbf{k}\\cdot\\mathbf{r})$. Applying the translation operators to this state yields:\n$$T_i^{\\pm} \\psi(\\mathbf{r}) = \\exp(i\\mathbf{k}\\cdot(\\mathbf{r} \\pm a\\hat{\\mathbf{e}}_i)) = \\exp(i\\mathbf{k}\\cdot\\mathbf{r}) \\exp(\\pm i a k_i) = \\psi(\\mathbf{r}) \\exp(\\pm i a k_i)$$\nThe action of the Hamiltonian on the plane wave is therefore:\n$$H_{\\text{lat}} \\psi(\\mathbf{r}) = -\\frac{\\hbar^2}{2ma^2} \\left( \\sum_{i=1}^3 \\left[ \\exp(i a k_i) + \\exp(-i a k_i) \\right] - 6 \\right) \\psi(\\mathbf{r})$$\nUsing the identity $2\\cos\\theta = e^{i\\theta} + e^{-i\\theta}$, we simplify the expression in the parenthesis:\n$$H_{\\text{lat}} \\psi(\\mathbf{r}) = -\\frac{\\hbar^2}{2ma^2} \\left( \\sum_{i=1}^3 2\\cos(a k_i) - 6 \\right) \\psi(\\mathbf{r}) = \\frac{\\hbar^2}{ma^2} \\left( 3 - \\sum_{i=1}^3 \\cos(a k_i) \\right) \\psi(\\mathbf{r})$$\nThe eigenvalue is the energy $E(\\mathbf{k})$. Using the identity $1 - \\cos\\theta = 2\\sin^2(\\theta/2)$:\n$$E(\\mathbf{k}) = \\frac{\\hbar^2}{ma^2} \\sum_{i=1}^3 \\left(1 - \\cos(a k_i)\\right) = \\frac{2\\hbar^2}{ma^2} \\sum_{i=1}^3 \\sin^2\\left(\\frac{a k_i}{2}\\right)$$\nThis is the lattice dispersion relation.\n\nNow, we evaluate this for the two specified momentum vectors, $\\mathbf{k}_{\\text{ax}} = (k, 0, 0)$ and $\\mathbf{k}_{\\text{bd}} = (k/\\sqrt{3}, k/\\sqrt{3}, k/\\sqrt{3})$, where $|\\mathbf{k}_{\\text{ax}}| = |\\mathbf{k}_{\\text{bd}}| = k$.\nFor the axial momentum $\\mathbf{k}_{\\text{ax}}$, the components are $k_1=k$, $k_2=0$, $k_3=0$:\n$$E(\\mathbf{k}_{\\text{ax}}) = \\frac{2\\hbar^2}{ma^2} \\left[ \\sin^2\\left(\\frac{ak}{2}\\right) + \\sin^2(0) + \\sin^2(0) \\right] = \\frac{2\\hbar^2}{ma^2} \\sin^2\\left(\\frac{ak}{2}\\right)$$\nFor the body-diagonal momentum $\\mathbf{k}_{\\text{bd}}$, the components are $k_1=k_2=k_3=k/\\sqrt{3}$:\n$$E(\\mathbf{k}_{\\text{bd}}) = \\frac{2\\hbar^2}{ma^2} \\sum_{i=1}^3 \\sin^2\\left(\\frac{ak}{2\\sqrt{3}}\\right) = \\frac{6\\hbar^2}{ma^2} \\sin^2\\left(\\frac{ak}{2\\sqrt{3}}\\right)$$\nThe anisotropy measure $R(x)$ is defined with $x=ka$ and the continuum energy $E_{\\text{cont}}(k) = \\hbar^2 k^2/(2m) = \\hbar^2 x^2/(2ma^2)$.\n$$R(x) = \\frac{E(\\mathbf{k}_{\\text{ax}}) - E(\\mathbf{k}_{\\text{bd}})}{E_{\\text{cont}}(k)} = \\frac{\\frac{2\\hbar^2}{ma^2} \\sin^2\\left(\\frac{x}{2}\\right) - \\frac{6\\hbar^2}{ma^2} \\sin^2\\left(\\frac{x}{2\\sqrt{3}}\\right)}{\\frac{\\hbar^2 x^2}{2ma^2}}$$\nSimplifying this expression, we obtain the closed form for $R(x)$:\n$$R(x) = \\frac{4}{x^2} \\sin^2\\left(\\frac{x}{2}\\right) - \\frac{12}{x^2} \\sin^2\\left(\\frac{x}{2\\sqrt{3}}\\right) = \\frac{4}{x^2} \\left[ \\sin^2\\left(\\frac{x}{2}\\right) - 3\\sin^2\\left(\\frac{x}{2\\sqrt{3}}\\right) \\right]$$\nTo find the leading-order behavior for small $x$, we expand the sine-squared terms. The Taylor series for $\\sin^2(u)$ around $u=0$ is $\\sin^2(u) = (u - u^3/6 + \\dots)^2 = u^2 - u^4/3 + \\mathcal{O}(u^6)$.\nFor the first term, with $u=x/2$:\n$$\\sin^2\\left(\\frac{x}{2}\\right) = \\left(\\frac{x}{2}\\right)^2 - \\frac{1}{3}\\left(\\frac{x}{2}\\right)^4 + \\mathcal{O}(x^6) = \\frac{x^2}{4} - \\frac{x^4}{48} + \\mathcal{O}(x^6)$$\nFor the second term, with $u=x/(2\\sqrt{3})$:\n$$3\\sin^2\\left(\\frac{x}{2\\sqrt{3}}\\right) = 3\\left[ \\left(\\frac{x}{2\\sqrt{3}}\\right)^2 - \\frac{1}{3}\\left(\\frac{x}{2\\sqrt{3}}\\right)^4 + \\mathcal{O}(x^6) \\right] = 3\\left[ \\frac{x^2}{12} - \\frac{x^4}{3 \\cdot 144} + \\mathcal{O}(x^6) \\right] = \\frac{x^2}{4} - \\frac{x^4}{144} + \\mathcal{O}(x^6)$$\nThe difference is:\n$$\\sin^2\\left(\\frac{x}{2}\\right) - 3\\sin^2\\left(\\frac{x}{2\\sqrt{3}}\\right) = \\left(\\frac{x^2}{4} - \\frac{x^4}{48}\\right) - \\left(\\frac{x^2}{4} - \\frac{x^4}{144}\\right) + \\mathcal{O}(x^6) = \\left(-\\frac{1}{48} + \\frac{1}{144}\\right)x^4 + \\mathcal{O}(x^6)$$\n$$= \\frac{-3+1}{144}x^4 + \\mathcal{O}(x^6) = -\\frac{2}{144}x^4 + \\mathcal{O}(x^6) = -\\frac{1}{72}x^4 + \\mathcal{O}(x^6)$$\nFinally, we substitute this back into the expression for $R(x)$:\n$$R(x) = \\frac{4}{x^2} \\left[ -\\frac{1}{72}x^4 + \\mathcal{O}(x^6) \\right] = -\\frac{4}{72}x^2 + \\mathcal{O}(x^4) = -\\frac{1}{18}x^2 + \\mathcal{O}(x^4)$$\nThe problem asks for the coefficient $c$ in the expansion $R(x) = c\\,x^2 + \\mathcal{O}(x^4)$. By comparison, we find $c = -1/18$.",
            "answer": "$$\\boxed{-\\frac{1}{18}}$$"
        },
        {
            "introduction": "Simulating interactions between nucleons on the lattice is a complex many-body problem, often tackled with Quantum Monte Carlo (QMC) methods using auxiliary fields. This practice dives into the heart of the simulation by tasking you with implementing the Metropolis-Hastings update step, the very engine that drives the sampling of field configurations. You will learn to efficiently compute the acceptance probability by handling the fermion determinant ratio with the matrix determinant lemma, a critical and universally applied technique in fermionic QMC .",
            "id": "3567111",
            "problem": "Consider a one-dimensional spatial lattice with periodic boundary conditions and a single Euclidean time slice used in Lattice Effective Field Theory (EFT) for nuclei. Spin-$\\frac{1}{2}$ nucleons with an attractive contact interaction are decoupled using the Hubbard–Stratonovich (HS) transformation with a continuous Gaussian auxiliary field. The auxiliary field is denoted $\\mathbf{s} = (s_0, s_1, \\dots, s_{L-1})$, where $L$ is the number of lattice sites, and the Gaussian measure of the HS field induces an action of the form $S_{\\mathrm{aux}}[\\mathbf{s}] = \\sum_{i=0}^{L-1} \\frac{s_i^2}{2\\sigma^2}$, where $\\sigma^2$ is the variance of the Gaussian.\n\nOn this single time slice, define the fermion matrix $M[\\mathbf{s}] \\in \\mathbb{R}^{L \\times L}$ by\n$$\nM[\\mathbf{s}] \\equiv I + \\alpha \\Delta + \\lambda\\,\\mathrm{diag}(\\mathbf{s}),\n$$\nwhere $I$ is the $L \\times L$ identity, $\\alpha  0$ is a kinetic coupling, $\\lambda$ is the strength of the coupling to the auxiliary field, and $\\Delta$ is the one-dimensional discrete Laplacian with periodic boundary conditions:\n$$\n\\Delta_{ij} =\n\\begin{cases}\n2  \\text{if } i=j, \\\\\n-1  \\text{if } j = i+1 \\mod L, \\\\\n-1  \\text{if } j = i-1 \\mod L, \\\\\n0  \\text{otherwise}.\n\\end{cases}\n$$\nAssume $N_f$ degenerate fermion species (for example, $N_f = 2$ for spin-up and spin-down with identical matrices), so that the total fermion weight factor is $\\big(\\det M[\\mathbf{s}]\\big)^{N_f}$.\n\nYou will implement a local Metropolis–Hastings proposal (Metropolis–Hastings (MH)) that changes the auxiliary field only at a single site $i$, proposing\n$$\ns_i' = s_i + \\delta,\n$$\nwith all other $s_j$ unchanged, where the proposal mechanism is symmetric around $s_i$ (for example, a Gaussian centered at $s_i$). The acceptance probability must be derived from first principles, beginning at the Euclidean path integral representation with the HS transformation, and using valid, general linear algebraic identities (such as the matrix determinant lemma) appropriate for a rank-$1$ update to $M[\\mathbf{s}]$ induced by the local change of $s_i$. Express the acceptance probability in terms of the local change in the auxiliary-field action and the ratio of fermion determinants, ensuring the final expression is valid for general $N_f$ and avoids computing determinants explicitly.\n\nAlgorithmic requirements for the implementation:\n- You must build $M[\\mathbf{s}]$ exactly as defined above.\n- You must avoid computing a full matrix inverse or any determinants. Instead, compute only the required scalar component of the fermion Green’s function $G \\equiv M[\\mathbf{s}]^{-1}$ by solving a single linear system $M[\\mathbf{s}]\\,\\mathbf{x} = \\mathbf{e}_i$, where $\\mathbf{e}_i$ is the unit vector at site $i$. Use this to express the determinant ratio resulting from the local update.\n- The acceptance probability must be expressed in terms of $N_f$, $\\sigma^2$, $\\lambda$, $\\delta$, and the relevant scalar from $G$.\n\nYour program must implement the above and evaluate the acceptance probability for each of the following test cases. Indexing is zero-based. Where trigonometric functions appear, angles must be in radians.\n\nTest suite (each case defines $(L,\\alpha,\\lambda,N_f,\\sigma,\\mathbf{s},i,\\delta)$):\n1. Happy path case:\n   - $L = 6$, $\\alpha = 0.15$, $\\lambda = 0.6$, $N_f = 2$, $\\sigma = 1.0$, $\\mathbf{s} = [0.1,-0.05,0.2,-0.1,0.0,0.05]$, $i = 3$, $\\delta = 0.1$.\n2. Boundary kinetic case ($\\alpha = 0$):\n   - $L = 6$, $\\alpha = 0.0$, $\\lambda = 0.7$, $N_f = 2$, $\\sigma = 1.0$, $\\mathbf{s} = [0.2,0.2,0.2,0.2,0.2,0.2]$, $i = 2$, $\\delta = -0.05$.\n3. Single-flavor case with periodic boundary:\n   - $L = 8$, $\\alpha = 0.05$, $\\lambda = 1.0$, $N_f = 1$, $\\sigma = 1.0$, $\\mathbf{s}$ given by $s_j = 0.1 \\cos\\!\\left(\\frac{2\\pi j}{L}\\right)$ for $j \\in \\{0,\\dots,7\\}$, $i = 7$, $\\delta = 0.2$.\n4. Zero update case:\n   - $L = 4$, $\\alpha = 0.2$, $\\lambda = 0.3$, $N_f = 2$, $\\sigma = 1.0$, $\\mathbf{s} = [0.05,-0.05,0.03,-0.02]$, $i = 1$, $\\delta = 0.0$.\n5. Strong auxiliary penalty case:\n   - $L = 10$, $\\alpha = 0.1$, $\\lambda = 0.9$, $N_f = 2$, $\\sigma = 0.5$, $\\mathbf{s} = [0.1,-0.05,0.08,-0.02,0.03,0.05,-0.04,0.06,-0.01,0.02]$, $i = 5$, $\\delta = -0.4$.\n\nOutput specification:\n- For each test case, compute the acceptance probability as a float.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with each floating-point number rounded to six decimal places (for example, $[x_1,x_2,x_3,x_4,x_5]$ where each $x_k$ is rounded to six decimals).\n\nYour solution must begin with the Euclidean path integral and the Hubbard–Stratonovich transformation as the fundamental base, derive the acceptance probability using the ratio of fermion determinants for the local proposal, and then implement the algorithmic steps above to produce the required outputs.",
            "solution": "The problem is valid. It presents a well-posed and scientifically grounded scenario within computational nuclear physics, specifically Lattice Effective Field Theory. It requests the derivation and implementation of the Metropolis-Hastings acceptance probability for a local update to an auxiliary field. The provided parameters and definitions are clear, consistent, and sufficient to obtain a unique and meaningful solution. While the general problem description states $\\alpha  0$, one test case uses $\\alpha = 0$. This is interpreted as exploring a valid physical limit (the static limit) and does not render the problem mathematically or physically inconsistent. We may now proceed with the solution.\n\nThe theoretical framework begins with the Euclidean path integral representation of the partition function $Z$. After integrating out the fermion fields and performing a Hubbard–Stratonovich (HS) transformation to decouple the nucleon-nucleon interaction, the partition function is expressed as an integral over the auxiliary field configurations $\\mathbf{s} = (s_0, s_1, \\dots, s_{L-1})$:\n$$\nZ = \\int \\mathcal{D}\\mathbf{s} \\, e^{-S_{\\mathrm{aux}}[\\mathbf{s}]} \\left(\\det M[\\mathbf{s}]\\right)^{N_f}\n$$\nwhere $S_{\\mathrm{aux}}[\\mathbf{s}] = \\sum_{i=0}^{L-1} \\frac{s_i^2}{2\\sigma^2}$ is the Gaussian action for the auxiliary field, $M[\\mathbf{s}]$ is the fermion matrix, and $N_f$ is the number of degenerate fermion flavors. The expression\n$$\nP(\\mathbf{s}) \\propto e^{-S_{\\mathrm{aux}}[\\mathbf{s}]} \\left(\\det M[\\mathbf{s}]\\right)^{N_f}\n$$\ndefines the equilibrium probability distribution for the configurations $\\mathbf{s}$. We use the Metropolis–Hastings algorithm to generate a Markov chain of configurations that samples this distribution.\n\nFor a symmetric proposal distribution, where the probability of proposing a move from $\\mathbf{s}$ to $\\mathbf{s'}$ is the same as proposing the reverse move, $g(\\mathbf{s} | \\mathbf{s'}) = g(\\mathbf{s'} | \\mathbf{s})$, the acceptance probability $A(\\mathbf{s} \\to \\mathbf{s'})$ simplifies to:\n$$\nA(\\mathbf{s} \\to \\mathbf{s'}) = \\min\\left(1, \\frac{P(\\mathbf{s'})}{P(\\mathbf{s})}\\right)\n$$\nThe core of the problem is to compute the ratio $R = P(\\mathbf{s'})/P(\\mathbf{s})$. We can separate this ratio into two factors: one from the auxiliary field action and one from the fermion determinant.\n$$\nR = \\frac{e^{-S_{\\mathrm{aux}}[\\mathbf{s'}]} \\left(\\det M[\\mathbf{s'}]\\right)^{N_f}}{e^{-S_{\\mathrm{aux}}[\\mathbf{s}]} \\left(\\det M[\\mathbf{s}]\\right)^{N_f}} = e^{-\\left(S_{\\mathrm{aux}}[\\mathbf{s'}] - S_{\\mathrm{aux}}[\\mathbf{s}]\\right)} \\left(\\frac{\\det M[\\mathbf{s'}]}{\\det M[\\mathbf{s}]}\\right)^{N_f}\n$$\nThe proposal is a local update at a single site $i$: $s_i' = s_i + \\delta$, while $s_j'=s_j$ for $j \\neq i$.\n\nFirst, we calculate the change in the auxiliary action, $\\Delta S_{\\mathrm{aux}} = S_{\\mathrm{aux}}[\\mathbf{s'}] - S_{\\mathrm{aux}}[\\mathbf{s}]$.\n$$\nS_{\\mathrm{aux}}[\\mathbf{s'}] = \\left(\\sum_{j \\neq i} \\frac{s_j^2}{2\\sigma^2}\\right) + \\frac{(s_i + \\delta)^2}{2\\sigma^2} = S_{\\mathrm{aux}}[\\mathbf{s}] - \\frac{s_i^2}{2\\sigma^2} + \\frac{s_i^2 + 2s_i\\delta + \\delta^2}{2\\sigma^2}\n$$\nThus, the change in the action is:\n$$\n\\Delta S_{\\mathrm{aux}} = \\frac{2s_i\\delta + \\delta^2}{2\\sigma^2}\n$$\nThe first factor in the ratio $R$ is $e^{-\\Delta S_{\\mathrm{aux}}}$.\n\nSecond, we address the ratio of fermion determinants. The local update to $s_i$ induces a change in the fermion matrix $M[\\mathbf{s}] = I + \\alpha \\Delta + \\lambda\\,\\mathrm{diag}(\\mathbf{s})$. The new matrix is:\n$$\nM[\\mathbf{s'}] = I + \\alpha \\Delta + \\lambda\\,\\mathrm{diag}(s_0, \\dots, s_i + \\delta, \\dots, s_{L-1}) = M[\\mathbf{s}] + \\lambda \\delta \\, \\mathbf{e}_i \\mathbf{e}_i^T\n$$\nwhere $\\mathbf{e}_i$ is the standard basis column vector with a $1$ at index $i$ and zeros elsewhere. This is a rank-$1$ update of the form $A' = A + \\mathbf{u}\\mathbf{v}^T$, with $A=M[\\mathbf{s}]$, $\\mathbf{u} = \\lambda\\delta\\,\\mathbf{e}_i$, and $\\mathbf{v} = \\mathbf{e}_i$.\n\nWe apply the matrix determinant lemma, which states $\\det(A + \\mathbf{u}\\mathbf{v}^T) = (1 + \\mathbf{v}^T A^{-1} \\mathbf{u})\\det(A)$.\n$$\n\\det M[\\mathbf{s'}] = \\left(1 + \\mathbf{e}_i^T (M[\\mathbf{s}])^{-1} (\\lambda\\delta\\,\\mathbf{e}_i)\\right) \\det M[\\mathbf{s}]\n$$\nLet $G[\\mathbf{s}] \\equiv (M[\\mathbf{s}])^{-1}$ be the fermion Green's function (propagator). The term $\\mathbf{e}_i^T G[\\mathbf{s}] \\mathbf{e}_i$ is precisely the diagonal element $G_{ii}[\\mathbf{s}]$. The determinant ratio is therefore:\n$$\n\\frac{\\det M[\\mathbf{s'}]}{\\det M[\\mathbf{s}]} = 1 + \\lambda\\delta\\,G_{ii}[\\mathbf{s}]\n$$\nThis elegant result avoids the computationally prohibitive task of calculating determinants directly.\n\nCombining the two parts, the full ratio $R$ is:\n$$\nR = e^{-\\frac{2s_i\\delta + \\delta^2}{2\\sigma^2}} \\left(1 + \\lambda\\delta\\,G_{ii}[\\mathbf{s}]\\right)^{N_f}\n$$\nIf the term $1 + \\lambda\\delta\\,G_{ii}[\\mathbf{s}]$ is negative, it indicates that the proposed move crosses a singularity of the fermion matrix, leading to a change in the sign of the determinant. In a standard Metropolis-Hastings implementation for a probability distribution (which must be non-negative), such a move would be rejected. Thus, if $R  0$, the acceptance probability is $0$. The final acceptance probability is:\n$$\nA(\\mathbf{s} \\to \\mathbf{s'}) = \\min(1, \\max(0, R))\n$$\nAs per the problem's requirements, we do not compute the full inverse matrix $G[\\mathbf{s}]$. Instead, to find the single element $G_{ii}[\\mathbf{s}]$, we solve the linear system of equations $M[\\mathbf{s}]\\,\\mathbf{x} = \\mathbf{e}_i$. The solution vector $\\mathbf{x}$ is the $i$-th column of $G[\\mathbf{s}]$. The required element is then the $i$-th component of this vector: $G_{ii}[\\mathbf{s}] = x_i$.\n\nThe algorithm for each test case is as follows:\n1.  Construct the $L \\times L$ matrix $M[\\mathbf{s}] = I + \\alpha\\Delta + \\lambda\\,\\mathrm{diag}(\\mathbf{s})$ using the given parameters. The discrete Laplacian $\\Delta$ has elements $\\Delta_{jj}=2$, $\\Delta_{j, j\\pm 1 \\pmod L} = -1$.\n2.  Define the column vector $\\mathbf{e}_i$.\n3.  Solve the linear system $M[\\mathbf{s}]\\,\\mathbf{x} = \\mathbf{e}_i$ for $\\mathbf{x}$.\n4.  Extract the required Green's function element $G_{ii}[\\mathbf{s}] = x_i$.\n5.  Calculate the action change $\\Delta S_{\\mathrm{aux}} = (2s_i\\delta + \\delta^2)/(2\\sigma^2)$.\n6.  Calculate the ratio $R = \\exp(-\\Delta S_{\\mathrm{aux}}) \\times (1 + \\lambda\\delta\\,G_{ii}[\\mathbf{s}])^{N_f}$.\n7.  Compute the acceptance probability $A = \\min(1, \\max(0, R))$.\n\nThis procedure is now implemented for the provided test suite.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import solve\n\ndef solve_problem():\n    \"\"\"\n    Solves the problem for all test cases and prints the results.\n    \"\"\"\n\n    def construct_fermion_matrix(L, alpha, lam, s_vec):\n        \"\"\"Constructs the fermion matrix M[s].\"\"\"\n        # Initialize with the identity matrix part\n        M = np.identity(L)\n\n        # Add the kinetic term (alpha * Delta)\n        # The 1D Laplacian with periodic boundary conditions\n        if alpha != 0:\n            laplacian = np.zeros((L, L))\n            for i in range(L):\n                laplacian[i, i] = 2\n                laplacian[i, (i + 1) % L] = -1\n                laplacian[i, (i - 1 + L) % L] = -1\n            M += alpha * laplacian\n        \n        # Add the auxiliary field coupling term (lambda * diag(s))\n        M += lam * np.diag(s_vec)\n        \n        return M\n\n    def calculate_acceptance_prob(L, alpha, lam, Nf, sigma, s_vec, i, delta):\n        \"\"\"\n        Calculates the Metropolis-Hastings acceptance probability for a local update.\n        \"\"\"\n        # Handle the trivial case where there is no change.\n        if delta == 0.0:\n            return 1.0\n\n        #  1. Construct the fermion matrix M[s] for the current configuration.\n        M = construct_fermion_matrix(L, alpha, lam, s_vec)\n        \n        #  2. Solve for the required element of the Green's function, G_ii.\n        #  This is done by solving the linear system M*x = e_i.\n        e_i = np.zeros(L)\n        e_i[i] = 1.0\n        \n        try:\n            # The solution vector x is the i-th column of the inverse of M.\n            x = solve(M, e_i, assume_a='gen') \n        except np.linalg.LinAlgError:\n            # If the matrix is singular, the determinant is zero.\n            # The update would result in a det ratio of infinity or be ill-defined.\n            # Such moves are rejected.\n            return 0.0\n\n        # The required element G_ii is the i-th component of the solution vector.\n        G_ii = x[i]\n        \n        #  3. Calculate the ratio R = P(s') / P(s).\n        #  Change in the auxiliary field action.\n        s_i = s_vec[i]\n        delta_S_aux = (2 * s_i * delta + delta**2) / (2 * sigma**2)\n        \n        #  Ratio of fermion determinants.\n        det_ratio_term = 1 + lam * delta * G_ii\n        \n        # If the determinant ratio is negative, it implies a sign problem.\n        # A move from a positive-weight state to a negative-weight state is rejected.\n        if det_ratio_term  0:\n            return 0.0\n            \n        # Full ratio R\n        R = np.exp(-delta_S_aux) * (det_ratio_term ** Nf)\n\n        #  4. The acceptance probability is min(1, R).\n        # We must also ensure R is not negative, though handled above.\n        A = min(1.0, R)\n        \n        return A\n\n    test_cases = [\n        # 1. Happy path case\n        (6, 0.15, 0.6, 2, 1.0, np.array([0.1, -0.05, 0.2, -0.1, 0.0, 0.05]), 3, 0.1),\n        # 2. Boundary kinetic case (alpha = 0)\n        (6, 0.0, 0.7, 2, 1.0, np.array([0.2, 0.2, 0.2, 0.2, 0.2, 0.2]), 2, -0.05),\n        # 3. Single-flavor case with periodic boundary\n        (8, 0.05, 1.0, 1, 1.0, 0.1 * np.cos(2 * np.pi * np.arange(8) / 8), 7, 0.2),\n        # 4. Zero update case\n        (4, 0.2, 0.3, 2, 1.0, np.array([0.05, -0.05, 0.03, -0.02]), 1, 0.0),\n        # 5. Strong auxiliary penalty case\n        (10, 0.1, 0.9, 2, 0.5, np.array([0.1, -0.05, 0.08, -0.02, 0.03, 0.05, -0.04, 0.06, -0.01, 0.02]), 5, -0.4)\n    ]\n    \n    results = []\n    for case in test_cases:\n        L, alpha, lam, Nf, sigma, s_vec, i, delta = case\n        prob = calculate_acceptance_prob(L, alpha, lam, Nf, sigma, s_vec, i, delta)\n        results.append(prob)\n        \n    # Format the final output string\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve_problem()\n```"
        },
        {
            "introduction": "The primary obstacle in Monte Carlo simulations of many-fermion systems is the notorious \"sign problem,\" which can render calculations exponentially difficult. This final practice confronts this challenge by exploring its deep connection to the underlying symmetries of the nuclear force, specifically the approximate Wigner $SU(4)$ symmetry. You will develop and apply a model that quantifies the severity of the sign problem, providing insight into how physical symmetries can be leveraged to tame this computational beast .",
            "id": "3567137",
            "problem": "Consider a nonrelativistic nuclear system in lattice effective field theory on a cubic spatial lattice with periodic boundary conditions and imaginary-time extent. The lattice path integral with an auxiliary field introduces a complex fermion determinant. In Auxiliary Field Quantum Monte Carlo (AFQMC), the sign problem manifests as oscillations in the complex phase of this determinant. Near the Wigner Special Unitary group in four dimensions ($SU(4)$) symmetry, the sign problem is empirically and theoretically reduced. Introduce a mixing parameter $\\lambda \\in [0,1]$ that interpolates between the $SU(4)$-symmetric Hamiltonian at $\\lambda=1$ and the full physical Hamiltonian at $\\lambda=0$. The particle number density is $\\rho = N/L^3$ in lattice units, where $L$ is the number of lattice sites in each spatial dimension, and the imaginary-time extent is denoted by $\\beta$ in lattice time-step units. Angles (phases) are measured in radians.\n\nYou are tasked with quantifying the reduction of the sign problem by computing the phase-quenched reweighting factor, defined as the ratio of the full partition function to the phase-quenched partition function, as a function of $\\lambda$ and $\\rho$. Start from the AFQMC path integral representation of the partition function, the definition of the phase-quenched ensemble, and the cumulant expansion for the complex phase of the fermion determinant. Use only fundamental laws and well-tested facts: path integral factorization into magnitude and phase, the definition of the phase-quenched expectation value, time-reversal symmetry properties at zero chemical potential for isospin-symmetric systems, extensivity of fluctuations for sums of weakly correlated local contributions, and the central limit theorem for sums of many weakly dependent random variables.\n\nYour tasks are:\n1) Derive, from first principles and these assumptions, a closed-form expression for the phase-quenched reweighting factor in terms of the cumulants of the phase and specialize it to the Gaussian-cumulant approximation implied by the central limit theorem. Explain why near $\\lambda=1$ the leading dependence on the distance to the $SU(4)$-symmetric point is quadratic in $(1-\\lambda)$, and why the variance of the phase scales linearly with the space-time volume and with the density $\\rho$.\n2) Parameterize the leading-order phase-variance as an extensive quantity with a single dimensionless low-energy constant $\\alpha$ multiplying the appropriate factors. Take $\\alpha$ as a given calibration constant. Using this parameterization, provide an explicit algorithm to compute the reweighting factor for arbitrary inputs $(\\lambda,\\rho,L,\\beta)$ in lattice units.\n3) Implement this algorithm as a complete program that produces the reweighting factor for the following test suite. Use lattice units with spatial lattice spacing $a=1$ and imaginary-time step $\\Delta \\tau = 1$, so $L$, $\\beta$, and $\\rho$ are dimensionless. Use the fixed parameters $L=4$, $\\beta=6$, and $\\alpha=0.05$. The test suite consists of the following $(\\lambda,\\rho)$ pairs:\n   - $(1.0,\\,0.10)$\n   - $(0.0,\\,0.10)$\n   - $(0.5,\\,0.10)$\n   - $(0.25,\\,0.00)$\n   - $(0.25,\\,0.30)$\n   - $(0.80,\\,0.50)$\n\nOutput requirements:\n- Your program must compute the phase-quenched reweighting factor for each pair as a floating-point value.\n- Express the final results as dimensionless floats rounded to exactly $6$ digits after the decimal point.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[r_1,r_2,\\dots]$), in the same order as the test suite above.",
            "solution": "The problem R-0193 is a valid problem in computational nuclear physics. It is scientifically grounded in the principles of lattice Quantum Monte Carlo simulations, well-posed with a clear objective and sufficient information, and uses objective, formal language. The problem requires the derivation and application of a formula for the phase-quenched reweighting factor in Auxiliary Field Quantum Monte Carlo (AFQMC) simulations, based on fundamental principles and standard approximations. We will proceed with the solution.\n\nThe solution is divided into two main parts as requested: first, a derivation of the required expression from first principles, and second, the parameterization and application of this expression to compute the reweighting factor for a given set of test cases.\n\n**1. Derivation of the Reweighting Factor**\n\nThe partition function $Z$ of a nuclear system in the AFQMC path integral formalism is given by an integral over auxiliary field configurations $s$:\n$$ Z = \\int \\mathcal{D}s \\, \\det[M(s)] $$\nwhere $M(s)$ is the fermion matrix for a given auxiliary field configuration $s$. In general, the fermion determinant $\\det[M(s)]$ is a complex number. The sign problem arises from the oscillatory nature of this complex value. We can factorize the determinant into its magnitude and phase:\n$$ \\det[M(s)] = |\\det[M(s)]| e^{i\\theta(s)} $$\nwhere $\\theta(s)$ is the complex phase of the determinant for configuration $s$. The partition function can then be written as:\n$$ Z = \\int \\mathcal{D}s \\, |\\det[M(s)]| e^{i\\theta(s)} $$\nThe phase-quenched partition function, $Z_{PQ}$, is defined by setting the phase to zero, effectively ignoring the sign problem:\n$$ Z_{PQ} = \\int \\mathcal{D}s \\, |\\det[M(s)]| $$\nThe integrand $|\\det[M(s)]|$ is real and non-negative, and can be interpreted as a probability weight for Monte Carlo sampling. The ensemble defined by these weights is called the phase-quenched ensemble.\n\nThe phase-quenched reweighting factor, which we denote as $R$, is the ratio of the full partition function to the phase-quenched one. This factor measures the average value of the phase factor $e^{i\\theta}$ over the phase-quenched ensemble:\n$$ R = \\frac{Z}{Z_{PQ}} = \\frac{\\int \\mathcal{D}s \\, |\\det[M(s)]| e^{i\\theta(s)}}{\\int \\mathcal{D}s \\, |\\det[M(s)]|} \\equiv \\langle e^{i\\theta} \\rangle_{PQ} $$\nTo evaluate this expectation value, we use the cumulant expansion for the expectation value of an exponential of a random variable $i\\theta$:\n$$ \\langle e^{i\\theta} \\rangle_{PQ} = \\exp\\left( \\sum_{n=1}^{\\infty} \\frac{(i)^n}{n!} \\kappa_n(\\theta) \\right) $$\nwhere $\\kappa_n(\\theta)$ is the $n$-th cumulant of the phase $\\theta$ evaluated in the phase-quenched ensemble. The first two cumulants are the mean, $\\kappa_1 = \\langle \\theta \\rangle_{PQ}$, and the variance, $\\kappa_2 = \\sigma^2_\\theta = \\langle \\theta^2 \\rangle_{PQ} - (\\langle \\theta \\rangle_{PQ})^2$.\n\nThe problem specifies an isospin-symmetric system at zero chemical potential, which possesses time-reversal symmetry. This symmetry implies that for any auxiliary field configuration $s$ with phase $\\theta(s)$, there is a corresponding time-reversed configuration $s'$ with phase $-\\theta(s')$ that has the same weight $|\\det[M(s)]|=|\\det[M(s')]|$. Consequently, the probability distribution of the phase $\\theta$ in the phase-quenched ensemble is symmetric, $P(\\theta) = P(-\\theta)$. This symmetry forces all odd moments, and therefore all odd cumulants, to be zero: $\\kappa_n(\\theta) = 0$ for all odd $n$. The cumulant expansion thus simplifies to:\n$$ R = \\exp\\left( \\frac{i^2}{2!} \\kappa_2(\\theta) + \\frac{i^4}{4!} \\kappa_4(\\theta) + \\dots \\right) = \\exp\\left( -\\frac{1}{2}\\kappa_2(\\theta) + \\frac{1}{24}\\kappa_4(\\theta) - \\dots \\right) $$\nThe problem invokes the central limit theorem. The total phase $\\theta$ of the system is an extensive quantity that can be viewed as the sum of many weakly correlated local contributions over the space-time volume. According to the central limit theorem, the distribution of such a sum tends towards a Gaussian distribution. A key property of the Gaussian distribution is that all its cumulants beyond the second are zero, i.e., $\\kappa_n = 0$ for $n > 2$. Adopting this \"Gaussian-cumulant approximation\", we retain only the leading term in the expansion:\n$$ R \\approx \\exp\\left( -\\frac{1}{2}\\kappa_2(\\theta) \\right) = \\exp\\left( -\\frac{1}{2}\\sigma^2_\\theta \\right) $$\nThis provides the requested closed-form expression for the reweighting factor in terms of the variance of the phase, $\\sigma^2_\\theta$.\n\nNext, we analyze the dependence of $\\sigma^2_\\theta$ on the physical parameters.\n\nAt $\\lambda=1$, the system has Wigner $SU(4)$ symmetry. In this limit, the fermion determinant is known to be real and non-negative, meaning the phase $\\theta(s)$ is identically zero for all configurations. Consequently, the variance of the phase is zero: $\\sigma^2_\\theta(\\lambda=1)=0$. The deviation from this symmetric point is controlled by the $SU(4)$-breaking terms in the Hamiltonian, which are proportional to $(1-\\lambda)$. For small perturbations, the resulting phase $\\theta(s)$ is expected to be linear in the strength of the perturbation, so $\\theta(s) \\propto (1-\\lambda)$. Since time-reversal symmetry ensures $\\langle \\theta \\rangle_{PQ} = 0$, the variance is $\\sigma^2_\\theta = \\langle \\theta^2 \\rangle_{PQ}$. Therefore, the leading-order dependence near the symmetric point is quadratic:\n$$ \\sigma^2_\\theta(\\lambda) \\propto (1-\\lambda)^2 \\quad \\text{for } \\lambda \\to 1 $$\nThe assumption of extensivity implies that the variance of the total phase, being the sum of contributions from across the space-time volume $V_{ST} = L^3\\beta$, scales linearly with this volume:\n$$ \\sigma^2_\\theta \\propto L^3\\beta $$\nFinally, the sign problem is a consequence of fermion interactions. In the vacuum, where the particle density $\\rho=N/L^3=0$, there are no fermions and thus no sign problem, so $\\sigma^2_\\theta(\\rho=0)=0$. For low densities, the severity of the sign problem is expected to scale with the number of particles, and therefore linearly with the density $\\rho$.\n$$ \\sigma^2_\\theta \\propto \\rho $$\n\n**2. Algorithm and Implementation**\n\nCombining these scaling behaviors, we can construct a physically motivated parameterization for the phase variance. We introduce a single dimensionless low-energy constant $\\alpha$ to capture the overall strength of the phase fluctuations which depends on the details of the nuclear interaction.\n$$ \\sigma^2_\\theta(\\lambda, \\rho, L, \\beta) = \\alpha (1-\\lambda)^2 \\rho L^3 \\beta $$\nThis expression correctly reflects the quadratic dependence on the deviation from $SU(4)$ symmetry, and linear scaling with both density and space-time volume.\n\nThe algorithm to compute the reweighting factor $R$ for a given set of inputs $(\\lambda, \\rho, L, \\beta)$ and the calibrated constant $\\alpha$ is as follows:\n1.  Receive input parameters: $\\lambda$, $\\rho$, $L$, $\\beta$, and $\\alpha$.\n2.  Calculate the phase variance $\\sigma^2_\\theta$ using the formula: $\\sigma^2_\\theta = \\alpha \\cdot (1-\\lambda)^2 \\cdot \\rho \\cdot L^3 \\cdot \\beta$.\n3.  Calculate the reweighting factor $R$ using the Gaussian approximation: $R = \\exp(-\\frac{1}{2} \\sigma^2_\\theta)$.\n4.  Return the value of $R$.\n\nWe now apply this algorithm to the specified test suite with the fixed parameters $L=4$, $\\beta=6$, and $\\alpha=0.05$. The space-time volume is $V_{ST} = L^3 \\beta = 4^3 \\times 6 = 384$. The formula for the reweighting factor becomes:\n$$ R(\\lambda, \\rho) = \\exp\\left( -\\frac{1}{2} \\cdot 0.05 \\cdot (1-\\lambda)^2 \\cdot \\rho \\cdot 384 \\right) = \\exp\\left( -9.6 \\cdot (1-\\lambda)^2 \\cdot \\rho \\right) $$\n\nThe calculations for each test case are:\n- Case 1: $(\\lambda, \\rho) = (1.0, 0.10)$\n  $$ R = \\exp\\left(-9.6 \\cdot (1-1.0)^2 \\cdot 0.10\\right) = \\exp(0) = 1.0 $$\n- Case 2: $(\\lambda, \\rho) = (0.0, 0.10)$\n  $$ R = \\exp\\left(-9.6 \\cdot (1-0.0)^2 \\cdot 0.10\\right) = \\exp(-0.96) \\approx 0.382893 $$\n- Case 3: $(\\lambda, \\rho) = (0.5, 0.10)$\n  $$ R = \\exp\\left(-9.6 \\cdot (1-0.5)^2 \\cdot 0.10\\right) = \\exp(-9.6 \\cdot 0.25 \\cdot 0.10) = \\exp(-0.24) \\approx 0.786628 $$\n- Case 4: $(\\lambda, \\rho) = (0.25, 0.00)$\n  $$ R = \\exp\\left(-9.6 \\cdot (1-0.25)^2 \\cdot 0.00\\right) = \\exp(0) = 1.0 $$\n- Case 5: $(\\lambda, \\rho) = (0.25, 0.30)$\n  $$ R = \\exp\\left(-9.6 \\cdot (1-0.25)^2 \\cdot 0.30\\right) = \\exp(-9.6 \\cdot 0.5625 \\cdot 0.30) = \\exp(-1.62) \\approx 0.197900 $$\n- Case 6: $(\\lambda, \\rho) = (0.80, 0.50)$\n  $$ R = \\exp\\left(-9.6 \\cdot (1-0.80)^2 \\cdot 0.50\\right) = \\exp(-9.6 \\cdot 0.04 \\cdot 0.50) = \\exp(-0.192) \\approx 0.825298 $$\n\nThese results will be generated by the provided Python program.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the phase-quenched reweighting factor for a series of test cases\n    in lattice effective field theory for nuclei.\n    \"\"\"\n\n    # Fixed parameters from the problem statement\n    L = 4       # Number of lattice sites in each spatial dimension\n    beta = 6    # Imaginary-time extent in lattice units\n    alpha = 0.05 # Dimensionless low-energy constant\n\n    # Test suite of (lambda, rho) pairs\n    test_cases = [\n        (1.0, 0.10),\n        (0.0, 0.10),\n        (0.5, 0.10),\n        (0.25, 0.00),\n        (0.25, 0.30),\n        (0.80, 0.50),\n    ]\n\n    results = []\n    \n    # Calculate the constant part of the exponent for efficiency\n    # Exponent = -1/2 * sigma^2_theta\n    # sigma^2_theta = alpha * (1-lambda)^2 * rho * L^3 * beta\n    # Exponent = -1/2 * alpha * L^3 * beta * (1-lambda)^2 * rho\n    exponent_coeff = -0.5 * alpha * (L**3) * beta\n\n    for case in test_cases:\n        lambda_mix, rho = case\n\n        # The phase variance sigma^2_theta is parameterized as:\n        # sigma_sq = alpha * (1 - lambda)^2 * rho * L^3 * beta\n        # The reweighting factor R is exp(-1/2 * sigma_sq)\n        \n        # We can write the exponent directly as:\n        exponent = exponent_coeff * (1.0 - lambda_mix)**2 * rho\n        \n        # Calculate the reweighting factor\n        reweighting_factor = np.exp(exponent)\n        \n        results.append(reweighting_factor)\n\n    # Format the results to 6 decimal places as strings\n    formatted_results = [f\"{r:.6f}\" for r in results]\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}