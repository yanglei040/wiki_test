{
    "hands_on_practices": [
        {
            "introduction": "This first practice is a foundational exercise in moving from the continuous theory to a numerical implementation. You will discretize the Bethe-Goldstone integral equation for a separable potential, transforming it into a system of linear equations that can be solved numerically. This hands-on process of building and verifying a solver is a crucial first step in computational many-body physics, and the use of a separable potential provides a valuable internal consistency check to ensure your implementation is correct .",
            "id": "3545576",
            "problem": "You are asked to implement a fully self-contained program that constructs a discretized matrix representation of the Bethe-Goldstone equation for the in-medium interaction (the in-medium $G$-matrix) for symmetric nuclear matter at zero total pair momentum. Your task is to start from first principles appropriate to computational nuclear physics and derive the discrete linear system that arises from a quadrature approximation, then implement and evaluate it numerically. You must use a physically plausible single-particle spectrum and a simple but nontrivial separable interaction to enable an internal consistency check. All momenta must be expressed in $\\mathrm{fm}^{-1}$, all energies in $\\mathrm{MeV}$, and angles in radians.\n\nBegin from the standard physical starting point for Brueckner-Hartree-Fock (BHF) theory: the Bethe-Goldstone equation for the in-medium two-body reaction matrix $G$, which in the $S$-wave, zero total momentum approximation can be written as a one-dimensional integral equation in the relative momentum $k$. Adopt the conventional normalization for partial waves in which the three-dimensional integral becomes a factor times an integral in $q \\in [0,\\Lambda]$ over $q^{2}\\,\\mathrm{d}q$, where $\\Lambda$ is a finite momentum cutoff. The intermediate-state Pauli operator must be taken in the angle-average and for zero total momentum reduce to a step function $Q(q,k_{F})=\\Theta(q-k_{F})$, where $k_{F}$ is the Fermi momentum. The single-particle energy must be taken to be the free kinetic spectrum $\\epsilon(q)=\\frac{\\hbar^{2}}{2m_{N}}\\,q^{2}$ with $\\frac{\\hbar^{2}}{2m_{N}}=20.735\\,\\mathrm{MeV}\\cdot\\mathrm{fm}^{2}$. The starting energy is a complex quantity of the form $\\omega + i\\,\\eta$ with real $\\omega$ and a small positive regulator $\\eta$ (with units of $\\mathrm{MeV}$) that implements the causal prescription and regularizes the energy denominator.\n\nUse the rank-$1$ separable Yamaguchi potential in momentum space,\n$$\nV(k,k')=-\\lambda\\,g(k)\\,g(k')\\,,\\qquad g(k)=\\frac{1}{k^{2}+\\beta^{2}}\\,,\n$$\nwith $\\lambda>0$ and range parameter $\\beta>0$. In the $S$-wave and zero center-of-mass momentum, the in-medium Bethe-Goldstone equation becomes a one-dimensional integral equation in $q$ for each pair $(k,k')$, involving the kernel $V(k,q)$, the Pauli factor $Q(q,k_{F})$, and the propagator denominator $\\left[\\omega-2\\,\\epsilon(q)\\right]^{-1}$. Your code must discretize the $q$-integral on a finite momentum interval $[0,\\Lambda]$ using a Gaussian quadrature with $N$ nodes and weights $\\{(q_{i},w_{i})\\}_{i=1}^{N}$. To evaluate the $G$-matrix at a specific on-shell momentum $k_{0}$, you must augment the quadrature grid by including $k_{0}$ as an additional collocation point with zero quadrature weight so that it does not alter the integral but does produce $G(k_{0},k')$ through the same linear system. In all expressions, carry the conventional $S$-wave factor explicitly as\n$$\n\\frac{2}{\\pi}\\int_{0}^{\\Lambda} q^{2}\\,\\mathrm{d}q \\,\\cdots \\, .\n$$\n\nNumerically, you must treat the energy denominator\n$$\n\\omega-\\epsilon_{p_{1}}-\\epsilon_{p_{2}}=\\omega-2\\,\\epsilon(q)=\\omega - 2 \\times 20.735\\,q^{2}\\,,\n$$\nby adding the small imaginary regulator so that the denominator is $\\omega-2\\,\\epsilon(q)+i\\,\\eta$ with $\\eta \\ge 0$. The Pauli operator $Q(q,k_{F})$ must be implemented as a sharp step function $Q(q,k_{F})=1$ if $q>k_{F}$ and $Q(q,k_{F})=0$ otherwise. You must formulate the discretized equation as a linear algebra problem on the combined grid $\\{k_{0}\\}\\cup\\{q_{i}\\}_{i=1}^{N}$ and solve for the full matrix $G(k_{a},k_{b};\\omega)$ at those grid points. Then extract the on-shell element $G(k_{0},k_{0};\\omega)$.\n\nTo verify correctness and to assess the numerical treatment of the energy denominator, compute in parallel the closed-form solution that exists for rank-$1$ separable potentials by reducing the Bethe-Goldstone equation to a scalar equation for a strength parameter and then reconstructing the on-shell $G$-matrix element. Use the same quadrature rule and Pauli operator in the scalar equation so that discrepancies reflect only the consistency of your discretization and linear algebra.\n\nTest suite and parameters. For each case below, the input parameters are $(k_{F},k_{0},\\Lambda,N,\\beta,\\lambda,\\omega,\\eta)$, in the stated units. Use exactly these four cases in this order:\n- Case A (free-space, on-shell): $k_{F}=0.0\\,\\mathrm{fm}^{-1}$, $k_{0}=1.0\\,\\mathrm{fm}^{-1}$, $\\Lambda=8.0\\,\\mathrm{fm}^{-1}$, $N=120$, $\\beta=1.4\\,\\mathrm{fm}^{-1}$, $\\lambda=200.0\\,\\mathrm{MeV}\\cdot\\mathrm{fm}^{3}$, $\\omega=2\\times 20.735\\times k_{0}^{2}\\,\\mathrm{MeV}$, $\\eta=1.0\\,\\mathrm{MeV}$.\n- Case B (normal density, on-shell above $k_{F}$): $k_{F}=1.3\\,\\mathrm{fm}^{-1}$, $k_{0}=1.6\\,\\mathrm{fm}^{-1}$, $\\Lambda=8.0\\,\\mathrm{fm}^{-1}$, $N=120$, $\\beta=1.4\\,\\mathrm{fm}^{-1}$, $\\lambda=200.0\\,\\mathrm{MeV}\\cdot\\mathrm{fm}^{3}$, $\\omega=2\\times 20.735\\times k_{0}^{2}\\,\\mathrm{MeV}$, $\\eta=1.0\\,\\mathrm{MeV}$.\n- Case C (near Fermi surface, on-shell just above $k_{F}$): $k_{F}=1.3\\,\\mathrm{fm}^{-1}$, $k_{0}=1.31\\,\\mathrm{fm}^{-1}$, $\\Lambda=8.0\\,\\mathrm{fm}^{-1}$, $N=120$, $\\beta=1.4\\,\\mathrm{fm}^{-1}$, $\\lambda=200.0\\,\\mathrm{MeV}\\cdot\\mathrm{fm}^{3}$, $\\omega=2\\times 20.735\\times k_{0}^{2}\\,\\mathrm{MeV}$, $\\eta=0.5\\,\\mathrm{MeV}$.\n- Case D (off-shell below threshold, free-space): $k_{F}=0.0\\,\\mathrm{fm}^{-1}$, $k_{0}=0.5\\,\\mathrm{fm}^{-1}$, $\\Lambda=8.0\\,\\mathrm{fm}^{-1}$, $N=120$, $\\beta=1.4\\,\\mathrm{fm}^{-1}$, $\\lambda=200.0\\,\\mathrm{MeV}\\cdot\\mathrm{fm}^{3}$, $\\omega=-20.0\\,\\mathrm{MeV}$, $\\eta=0.0\\,\\mathrm{MeV}$.\n\nYour program must, for each case, do the following:\n- Assemble the discretized matrix equation on the combined grid with $k_{0}$ as an additional collocation point of zero quadrature weight and solve for the full $G$-matrix.\n- Extract the on-shell element $G(k_{0},k_{0};\\omega)$.\n- Independently compute the corresponding on-shell element implied by the closed-form separable reduction using the same quadrature and Pauli operator.\n- Return the absolute discrepancies between the two complex numbers’ real and imaginary parts, i.e., $|\\Re G_{\\mathrm{matrix}}-\\Re G_{\\mathrm{sep}}|$ and $|\\Im G_{\\mathrm{matrix}}-\\Im G_{\\mathrm{sep}}|$, expressed in $\\mathrm{MeV}\\cdot\\mathrm{fm}^{3}$.\n\nFinal output format. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, ordered as\n$\\big[$discrepancy for Case A real part, discrepancy for Case A imaginary part, discrepancy for Case B real part, discrepancy for Case B imaginary part, discrepancy for Case C real part, discrepancy for Case C imaginary part, discrepancy for Case D real part, discrepancy for Case D imaginary part$\\big]$.",
            "solution": "The user requires a numerical solution and verification for the Bethe-Goldstone equation in the context of Brueckner-Hartree-Fock theory for nuclear matter. The problem is validated as scientifically grounded, well-posed, and internally consistent. It represents a standard, albeit simplified, problem in computational nuclear physics.\n\n### 1. Problem Formulation\n\nThe starting point is the Bethe-Goldstone equation for the in-medium reaction matrix, $G$, for two nucleons interacting in symmetric nuclear matter with zero total momentum. In the $S$-wave channel, this is a one-dimensional integral equation:\n$$\nG(k, k'; \\omega) = V(k, k') + \\frac{2}{\\pi} \\int_{0}^{\\Lambda} q^2 dq \\, V(k, q) \\frac{Q(q, k_F)}{\\omega + i\\eta - 2\\epsilon(q)} G(q, k'; \\omega)\n$$\nwhere:\n- $k$ and $k'$ are the initial and final relative momenta.\n- $V(k, k')$ is the nucleon-nucleon interaction in the $S$-wave channel.\n- The integral is over intermediate relative momenta $q$ up to a cutoff $\\Lambda$. The factor $\\frac{2}{\\pi}$ is a specified normalization convention.\n- $Q(q, k_F) = \\Theta(q - k_F)$ is the angle-averaged Pauli exclusion operator, which restricts intermediate states to be above the Fermi momentum $k_F$. It is $1$ for $q > k_F$ and $0$ otherwise.\n- $\\epsilon(q) = \\frac{\\hbar^2 q^2}{2m_N}$ is the single-particle energy of a free nucleon with mass $m_N$. The constant is given as $\\frac{\\hbar^2}{2m_N} = 20.735\\,\\mathrm{MeV}\\cdot\\mathrm{fm}^2$.\n- $\\omega + i\\eta$ is the complex starting energy, with $\\omega$ being the real energy and $\\eta > 0$ a small positive regulator ensuring the correct causal boundary conditions and preventing singularities in the energy denominator.\n\nThe interaction is a rank-$1$ separable Yamaguchi potential:\n$$\nV(k, k') = -\\lambda g(k) g(k') \\quad \\text{with} \\quad g(k) = \\frac{1}{k^2 + \\beta^2}\n$$\nwhere $\\lambda$ is the strength and $\\beta$ is related to the range of the interaction.\n\n### 2. Numerical Discretization and Matrix Formulation\n\nTo solve the integral equation numerically, we discretize the integral over $q \\in [0, \\Lambda]$ using an $N$-point Gaussian quadrature rule. Let the quadrature nodes be $\\{q_i\\}_{i=1}^N$ and the corresponding weights be $\\{w_i\\}_{i=1}^N$. The integral is approximated as:\n$$\n\\int_{0}^{\\Lambda} f(q) dq \\approx \\sum_{i=1}^{N} w_i f(q_i)\n$$\nThe problem requires us to evaluate the $G$-matrix at a specific momentum $k_0$. We augment the set of quadrature nodes with $k_0$ to form a combined grid of collocation points, $P = \\{p_a\\}_{a=0}^N$, where $p_0 = k_0$ and $p_a = q_a$ for $a=1, \\dots, N$. The point $k_0$ is assigned a zero quadrature weight.\n\nThe discretized Bethe-Goldstone equation becomes a system of linear equations for the values of the $G$-matrix at the grid points, $G_{ab} = G(p_a, p_b)$:\n$$\nG(p_a, p_b) = V(p_a, p_b) + \\frac{2}{\\pi} \\sum_{i=1}^{N} w_i q_i^2 V(p_a, q_i) \\frac{Q(q_i, k_F)}{\\omega + i\\eta - 2\\epsilon(q_i)} G(q_i, p_b)\n$$\nRecognizing that $q_i=p_i$ and $G(q_i, p_b)=G_{ib}$, we can write this as a matrix equation. Let us define a matrix $\\mathbf{C}$ of size $(N+1) \\times (N+1)$:\n$$\nC_{ai} = \n\\begin{cases}\n    \\frac{2}{\\pi} w_i q_i^2 V(p_a, q_i) \\frac{Q(q_i, k_F)}{\\omega + i\\eta - 2\\epsilon(q_i)} & \\text{for } i \\in \\{1, \\dots, N\\} \\\\\n    0 & \\text{for } i = 0\n\\end{cases}\n$$\nThe equation for the matrix $\\mathbf{G}$ (with elements $G_{ab}$) in terms of matrix $\\mathbf{V}$ (with elements $V_{ab}$) is:\n$$\n\\mathbf{G} = \\mathbf{V} + \\mathbf{C} \\mathbf{G} \\implies (\\mathbf{I} - \\mathbf{C})\\mathbf{G} = \\mathbf{V}\n$$\nwhere $\\mathbf{I}$ is the identity matrix. The solution is formally $\\mathbf{G} = (\\mathbf{I} - \\mathbf{C})^{-1} \\mathbf{V}$.\n\nSince the potential is separable, $\\mathbf{V}$ is a rank-1 matrix: $V_{ab} = -\\lambda g(p_a) g(p_b)$, which can be written as $\\mathbf{V} = -\\lambda \\vec{g} \\vec{g}^T$, where $\\vec{g}$ is a column vector with elements $g_a = g(p_a)$.\nThe solution for $\\mathbf{G}$ is then $\\mathbf{G} = -\\lambda (\\mathbf{I} - \\mathbf{C})^{-1} (\\vec{g} \\vec{g}^T)$.\nTo find the required element $G_{00} = G(k_0, k_0)$, we can solve the linear system $(\\mathbf{I} - \\mathbf{C})\\vec{y} = \\vec{g}$ for the vector $\\vec{y}$. The solution vector is $\\vec{y} = (\\mathbf{I} - \\mathbf{C})^{-1}\\vec{g}$, and the full $G$-matrix is then $\\mathbf{G} = -\\lambda \\vec{y} \\vec{g}^T$.\nThe specific element we need is $G_{00} = -\\lambda y_0 g_0$, where $y_0$ is the first component of $\\vec{y}$ and $g_0 = g(p_0) = g(k_0)$. This approach avoids constructing the full inverse and is computationally more efficient.\n\n### 3. Closed-Form Separable Reduction\n\nA key feature of a rank-$1$ separable potential is that the integral equation can be solved analytically, reducing it to a scalar algebraic equation. We substitute $V(k, k') = -\\lambda g(k) g(k')$ into the Bethe-Goldstone equation. The structure of the equation implies that $G(k, k')$ must also be separable, so we make the ansatz $G(k, k') = \\tau(\\omega) g(k) g(k')$. Substituting this and canceling $g(k)$ and $g(k')$ yields a scalar equation for the function $\\tau(\\omega)$:\n$$\n\\tau(\\omega) = -\\lambda + \\frac{2}{\\pi} \\int_0^\\Lambda q^2 dq \\, [-\\lambda g(q)] \\frac{Q(q, k_F)}{\\omega' - 2\\epsilon(q)} [\\tau(\\omega) g(q)]\n$$\n$$\n\\tau(\\omega) = -\\lambda - \\lambda \\tau(\\omega) \\left[ \\frac{2}{\\pi} \\int_0^\\Lambda q^2 dq \\frac{g(q)^2 Q(q, k_F)}{\\omega' - 2\\epsilon(q)} \\right]\n$$\nLet's define the loop integral $I(\\omega')$:\n$$\nI(\\omega') = \\frac{2}{\\pi} \\int_0^\\Lambda q^2 dq \\frac{g(q)^2 Q(q, k_F)}{\\omega' - 2\\epsilon(q)}\n$$\nThen $\\tau(\\omega) = -\\lambda / (1 + \\lambda I(\\omega'))$. The G-matrix is thus:\n$$\nG(k, k'; \\omega) = \\frac{-\\lambda g(k) g(k')}{1 + \\lambda I(\\omega')}\n$$\nFor verification, we compute the integral $I(\\omega')$ using the same Gaussian quadrature rule as in the matrix method:\n$$\nI(\\omega') \\approx \\frac{2}{\\pi} \\sum_{i=1}^{N} w_i q_i^2 \\frac{g(q_i)^2 Q(q_i, k_F)}{\\omega' - 2\\epsilon(q_i)}\n$$\nThe on-shell element $G(k_0, k_0; \\omega)$ is then calculated directly from this formula.\n\n### 4. Consistency Check\n\nThe problem is designed such that the matrix method and the separable reduction method are two different numerical routes to the same underlying analytical solution. As derived analytically in the thought process, both methods yield the same expression: $G(k_0, k_0) = \\frac{-\\lambda g(k_0)^2}{1+\\lambda I(\\omega')}$. Therefore, when implemented numerically using the same quadrature scheme, the results from both methods should be identical up to floating-point precision. The requested discrepancies, $|\\Re G_{\\mathrm{matrix}}-\\Re G_{\\mathrm{sep}}|$ and $|\\Im G_{\\mathrm{matrix}}-\\Im G_{\\mathrm{sep}}|$, serve as a stringent test of the correctness and consistency of the implementation of the discretized linear algebra problem.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import roots_legendre\n\ndef solve():\n    \"\"\"\n    Main driver function to solve the problem for all specified test cases.\n    \"\"\"\n    # Test suite parameters:\n    # (k_F, k_0, Lambda, N, beta, lambda, omega, eta)\n    HBARC2_2M = 20.735  # MeV*fm^2\n\n    test_cases = [\n        # Case A (free-space, on-shell)\n        (0.0, 1.0, 8.0, 120, 1.4, 200.0, 2 * HBARC2_2M * 1.0**2, 1.0),\n        # Case B (normal density, on-shell above k_F)\n        (1.3, 1.6, 8.0, 120, 1.4, 200.0, 2 * HBARC2_2M * 1.6**2, 1.0),\n        # Case C (near Fermi surface, on-shell just above k_F)\n        (1.3, 1.31, 8.0, 120, 1.4, 200.0, 2 * HBARC2_2M * 1.31**2, 0.5),\n        # Case D (off-shell below threshold, free-space)\n        (0.0, 0.5, 8.0, 120, 1.4, 200.0, -20.0, 0.0),\n    ]\n\n    results = []\n    for case_params in test_cases:\n        d_real, d_imag = solve_case(*case_params)\n        results.append(f\"{d_real:.15e}\")\n        results.append(f\"{d_imag:.15e}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\ndef solve_case(kF, k0, Lambda, N, beta, lam, omega, eta):\n    \"\"\"\n    Solves the Bethe-Goldstone equation for a single set of parameters\n    using both the matrix inversion method and the separable reduction,\n    and returns the discrepancies between them.\n    \"\"\"\n    # Physical constant\n    HBARC2_2M = 20.735  # MeV*fm^2\n\n    # 1. Setup Grid and Quadrature\n    # Get N Gauss-Legendre quadrature points (x) and weights (w_prime) for [-1, 1]\n    x_nodes, w_prime = roots_legendre(N)\n    \n    # Map nodes and weights to the integration interval [0, Lambda]\n    q_nodes = Lambda * (x_nodes + 1.0) / 2.0\n    w_nodes = Lambda * w_prime / 2.0\n\n    # The full momentum grid consists of k0 and the quadrature nodes.\n    # p_grid[0] = k0, p_grid[1:] = q_nodes\n    p_grid = np.concatenate(([k0], q_nodes))\n    \n    # 2. Define Physical Quantities\n    def g_form_factor(k_val):\n        return 1.0 / (k_val**2 + beta**2)\n\n    def energy_spectrum(k_val):\n        return HBARC2_2M * k_val**2\n    \n    # Evaluate quantities on the grids\n    epsilon_q = energy_spectrum(q_nodes)\n    g_p = g_form_factor(p_grid)\n    g_q = g_form_factor(q_nodes)\n    \n    # Pauli operator Q(q, kF) = 1 if q > kF, else 0\n    Q_q = (q_nodes > kF).astype(np.float64)\n\n    # Complex starting energy\n    omega_c = complex(omega, eta)\n    \n    # Propagator denominator for all quadrature points\n    propagator_denom = omega_c - 2.0 * epsilon_q\n\n    # 3. Matrix Method for G(k0, k0)\n    # The discretized B-G equation is (I - C)G = V.\n    # For a separable potential, this leads to solving (I - C)y = g_vec,\n    # and then G_00 = -lam * y_0 * g_0.\n\n    # Construct the matrix C of size (N+1) x (N+1)\n    C = np.zeros((N + 1, N + 1), dtype=np.complex128)\n    \n    # Common part of the kernel for all quadrature points\n    kernel_integrand_base = (2.0 / np.pi) * w_nodes * q_nodes**2 * Q_q / propagator_denom\n    \n    # The matrix C's columns for i=1..N are constructed. C's first column (i=0) is zero.\n    for a in range(N + 1):  # Loop over rows of C (momentum p_a)\n        # V(p_a, q_i) = -lam * g(p_a) * g(q_i)\n        # C_{a,i} for i=1..N involves V(p_a, q_{i-1}) in 0-based indexing\n        V_pa_qi = -lam * g_p[a] * g_q\n        C[a, 1:] = kernel_integrand_base * V_pa_qi\n\n    # Form the matrix M = I - C for the linear system M*y = g_vec\n    M = np.identity(N + 1, dtype=np.complex128) - C\n    \n    # The vector g_vec has components g(p_a)\n    g_vec = g_p.astype(np.complex128)\n    \n    # Solve the linear system M*y = g_vec\n    y = np.linalg.solve(M, g_vec)\n    \n    # Calculate G_matrix(k0, k0) which corresponds to G_00\n    G_matrix = -lam * g_p[0] * y[0]\n\n    # 4. Separable Reduction Method for G(k0, k0)\n    # G(k,k') = V(k,k') / (1 + lam*I)\n    # where I = (2/pi) * integral_q [ q^2 * g(q)^2 * Q(q) / (omega' - 2*eps(q)) ]\n    \n    # Evaluate the loop integral I using the same quadrature rule\n    integrand_I = (2.0 / np.pi) * q_nodes**2 * g_q**2 * Q_q / propagator_denom\n    I_val = np.sum(w_nodes * integrand_I)\n    \n    # Calculate G_sep(k0, k0)\n    G_sep = (-lam * g_p[0]**2) / (1.0 + lam * I_val)\n\n    # 5. Compute and return the absolute discrepancies\n    d_real = np.abs(G_matrix.real - G_sep.real)\n    d_imag = np.abs(G_matrix.imag - G_sep.imag)\n\n    return d_real, d_imag\n\nif __name__ == '__main__':\n    solve()\n\n```"
        },
        {
            "introduction": "The in-medium interaction described by the G-matrix is not independent of the medium itself; it is intrinsically linked through the Pauli operator and, crucially, the single-particle energy spectrum $\\epsilon(k)$ in the propagator. This practice explores this dependence by calculating the on-shell G-matrix for several physically motivated models of $\\epsilon(k)$, including a free spectrum, an effective mass approximation, and a momentum-dependent potential. By quantifying the sensitivity of the G-matrix to these choices, you will gain practical insight into the concept of self-consistency that underpins Brueckner-Hartree-Fock theory .",
            "id": "3594986",
            "problem": "Consider infinite, isotropic nuclear matter where two-nucleon scattering in the presence of a filled Fermi sea is described by the Bethe–Goldstone equation. Work in momentum space with relative momentum magnitude denoted by $k$ and use the angle-averaged Pauli blocking approximation so that intermediate relative momenta above the Fermi momentum are unblocked. Let the two-body interaction be a rank-1 separable potential in momentum space of the form $V(k,k')=-\\lambda\\,g(k)\\,g(k')$, where $g(k)=1/\\bigl(1+(k/\\beta)^2\\bigr)$ and $\\lambda$ is a positive constant. Adopt units where momenta are in $\\mathrm{fm}^{-1}$ and energies in $\\mathrm{MeV}$, with the kinetic energy coefficient given by $\\hbar^2/(2m)=20.735\\,\\mathrm{MeV\\,fm^2}$. The single-particle energy $\\epsilon(k)$ enters the energy denominator and will be varied to test sensitivity. Use the following three models for $\\epsilon(k)$: (i) free spectrum $\\epsilon_{\\mathrm{free}}(k)=\\bigl(\\hbar^2/(2m)\\bigr)\\,k^2$, (ii) effective-mass plus constant mean field $\\epsilon_{\\mathrm{eff}}(k)=\\bigl(\\hbar^2/(2m)\\bigr)\\,(m/m^*)\\,k^2+U_0$ with effective-mass ratio $m^*/m$, and (iii) momentum-dependent mean field $\\epsilon_{\\mathrm{mom}}(k)=\\bigl(\\hbar^2/(2m)\\bigr)\\,k^2-U_0/\\bigl(1+(k/k_c)^2\\bigr)$. For each model, take the starting energy to be on-shell, namely $\\omega=2\\,\\epsilon(k_0)$ with a specified on-shell relative momentum $k_0>k_F$, where $k_F$ is the Fermi momentum. To ensure numerical stability, regularize the energy denominator by including a small positive imaginary regulator $i\\eta$ in the denominator, and truncate the momentum integral at an ultraviolet cutoff $q_{\\max}$.\n\nStarting from the Bethe–Goldstone equation and the stated approximations, derive a numerically computable expression for the real part of the on-shell, $S$-wave, angle-averaged in-medium interaction $G(k_0,k_0;\\omega)$ for the rank-1 separable potential. Then implement a program that, for each parameter set in the test suite, computes:\n- The real part of $G_{\\mathrm{free}}(k_0,k_0;2\\,\\epsilon_{\\mathrm{free}}(k_0))$,\n- The real part of $G_{\\mathrm{eff}}(k_0,k_0;2\\,\\epsilon_{\\mathrm{eff}}(k_0))$,\n- The real part of $G_{\\mathrm{mom}}(k_0,k_0;2\\,\\epsilon_{\\mathrm{mom}}(k_0))$,\nand outputs the two dimensionless sensitivity measures\n- $r_{\\mathrm{eff}}=\\operatorname{Re}\\,G_{\\mathrm{eff}}/\\operatorname{Re}\\,G_{\\mathrm{free}}$,\n- $r_{\\mathrm{mom}}=\\operatorname{Re}\\,G_{\\mathrm{mom}}/\\operatorname{Re}\\,G_{\\mathrm{free}}$,\nrounded to six decimal places.\n\nAll integrals must be evaluated with $q$ in $\\mathrm{fm}^{-1}$ and energies in $\\mathrm{MeV}$. Angles are already integrated out by the angle-average, so no angle unit is required. The required outputs are pure numbers without units. Your program must evaluate the following test suite, which specifies $(k_F,k_0,\\beta,\\lambda,m^*/m,U_0,U_0^{(\\mathrm{mom})},k_c,\\eta,q_{\\max})$ as:\n- Test $1$: $(0.4,0.8,1.6,350.0,0.9,-20.0,40.0,1.7,1.0\\times 10^{-3},8.0)$,\n- Test $2$: $(1.33,1.5,1.8,400.0,0.7,-50.0,60.0,1.5,2.0\\times 10^{-3},8.0)$,\n- Test $3$: $(1.8,2.0,1.4,300.0,0.6,-70.0,80.0,1.2,5.0\\times 10^{-3},8.0)$,\n- Test $4$: $(0.0,0.2,1.6,350.0,1.0,0.0,0.0,1.5,1.0\\times 10^{-4},8.0)$.\n\nFor each test, compute $r_{\\mathrm{eff}}$ and $r_{\\mathrm{mom}}$ as defined above. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets and flattened across all tests in the given order, namely $[r_{\\mathrm{eff}}^{(1)},r_{\\mathrm{mom}}^{(1)},r_{\\mathrm{eff}}^{(2)},r_{\\mathrm{mom}}^{(2)},r_{\\mathrm{eff}}^{(3)},r_{\\mathrm{mom}}^{(3)},r_{\\mathrm{eff}}^{(4)},r_{\\mathrm{mom}}^{(4)}]$, with each entry rounded to six decimal places.",
            "solution": "The problem requires the derivation and computation of the on-shell, $S$-wave, in-medium two-nucleon interaction, or $G$-matrix, for a rank-1 separable potential under the angle-averaged Pauli blocking approximation. We will first derive the analytical expression for the real part of the $G$-matrix and then outline the numerical procedure for its evaluation.\n\nThe Bethe-Goldstone equation for the $G$-matrix operator is given by\n$$ G(\\omega) = V + V \\frac{Q}{\\omega - H_0 + i\\eta} G(\\omega) $$\nwhere $V$ is the two-nucleon potential, $H_0$ is the unperturbed two-particle Hamiltonian, $\\omega$ is the starting energy, $Q$ is the Pauli blocking operator, and $i\\eta$ is a small positive imaginary regulator ($\\eta \\to 0^+$).\n\nWe work in the relative momentum representation. For the $S$-wave ($l=0$) partial wave, the Bethe-Goldstone equation becomes an integral equation:\n$$ G_0(k, k'; \\omega) = V_0(k, k') + \\frac{1}{2\\pi^2} \\int_0^\\infty q^2 dq \\, V_0(k, q) \\frac{Q(q)}{\\omega - 2\\epsilon(q) + i\\eta} G_0(q, k'; \\omega) $$\nThe factor $1/(2\\pi^2)$ comes from the standard normalization for partial-wave Lippmann-Schwinger type equations in three dimensions.\n\nThe problem provides a rank-$1$ separable potential, which for the $S$-wave is\n$$ V_0(k, k') = -\\lambda g(k) g(k') $$\nwhere $g(k) = 1/\\bigl(1+(k/\\beta)^2\\bigr)$. The separable nature of the potential suggests a solution of the form\n$$ G_0(k, k'; \\omega) = \\mathcal{T}(\\omega) g(k) g(k') $$\nSubstituting the ansatz for $G_0$ and the form of $V_0$ into the integral equation:\n$$ \\mathcal{T}(\\omega) g(k) g(k') = -\\lambda g(k) g(k') + \\frac{1}{2\\pi^2} \\int_0^\\infty q^2 dq \\, \\left( -\\lambda g(k) g(q) \\right) \\frac{Q(q)}{\\omega - 2\\epsilon(q) + i\\eta} \\left( \\mathcal{T}(\\omega) g(q) g(k') \\right) $$\nDividing by $g(k)g(k')$ (which is non-zero for finite momenta), we can solve for the reaction matrix $\\mathcal{T}(\\omega)$:\n$$ \\mathcal{T}(\\omega) = -\\lambda - \\mathcal{T}(\\omega) \\frac{\\lambda}{2\\pi^2} \\int_0^\\infty q^2 dq \\, [g(q)]^2 \\frac{Q(q)}{\\omega - 2\\epsilon(q) + i\\eta} $$\n$$ \\mathcal{T}(\\omega) \\left[ 1 + \\frac{\\lambda}{2\\pi^2} \\int_0^\\infty q^2 dq \\, \\frac{[g(q)]^2 Q(q)}{\\omega - 2\\epsilon(q) + i\\eta} \\right] = -\\lambda $$\n$$ \\mathcal{T}(\\omega) = \\frac{-\\lambda}{1 + \\frac{\\lambda}{2\\pi^2} \\int_0^\\infty q^2 dq \\, \\frac{[g(q)]^2 Q(q)}{\\omega - 2\\epsilon(q) + i\\eta}} $$\nThe full $S$-wave $G$-matrix element is then\n$$ G_0(k, k'; \\omega) = \\frac{-\\lambda g(k) g(k')}{1 + \\frac{\\lambda}{2\\pi^2} \\int_0^\\infty q^2 dq \\, \\frac{[g(q)]^2 Q(q)}{\\omega - 2\\epsilon(q) + i\\eta}} $$\nThe problem specifies the angle-averaged Pauli operator, where intermediate states are blocked if their relative momentum $q$ is below the Fermi momentum $k_F$. Thus, $Q(q) = 1$ for $q > k_F$ and $Q(q) = 0$ for $q  k_F$. The momentum integral is also truncated at an ultraviolet cutoff $q_{\\max}$. This restricts the integral's range to $[k_F, q_{\\max}]$. We are interested in the on-shell matrix element $G_0(k_0, k_0; \\omega)$ where the starting energy is $\\omega = 2\\epsilon(k_0)$.\n$$ G_0(k_0, k_0; 2\\epsilon(k_0)) = \\frac{-\\lambda [g(k_0)]^2}{1 + \\frac{\\lambda}{2\\pi^2} \\int_{k_F}^{q_{\\max}} dq \\, \\frac{q^2 [g(q)]^2}{2\\epsilon(k_0) - 2\\epsilon(q) + i\\eta}} $$\nTo find the real part of this complex-valued expression, let us define the complex integral $I$ as\n$$ I = \\int_{k_F}^{q_{\\max}} dq \\, \\frac{q^2 [g(q)]^2}{2\\epsilon(k_0) - 2\\epsilon(q) + i\\eta} $$\nWe can separate the integrand's denominator into real and imaginary parts:\n$$ \\frac{1}{A(q) + i\\eta} = \\frac{A(q) - i\\eta}{A(q)^2 + \\eta^2}, \\quad \\text{where } A(q) = 2\\epsilon(k_0) - 2\\epsilon(q) $$\nThe integral $I$ can be written as $I = I_R + iI_I$, where\n$$ I_R = \\int_{k_F}^{q_{\\max}} dq \\, q^2 [g(q)]^2 \\frac{2\\epsilon(k_0) - 2\\epsilon(q)}{(2\\epsilon(k_0) - 2\\epsilon(q))^2 + \\eta^2} $$\n$$ I_I = -\\int_{k_F}^{q_{\\max}} dq \\, q^2 [g(q)]^2 \\frac{\\eta}{(2\\epsilon(k_0) - 2\\epsilon(q))^2 + \\eta^2} $$\nThe on-shell $G$-matrix element is then\n$$ G_0(k_0, k_0; \\omega) = \\frac{-\\lambda [g(k_0)]^2}{1 + \\frac{\\lambda}{2\\pi^2}(I_R + iI_I)} = \\frac{-\\lambda [g(k_0)]^2}{\\left(1 + \\frac{\\lambda}{2\\pi^2}I_R\\right) + i\\left(\\frac{\\lambda}{2\\pi^2}I_I\\right)} $$\nThe real part of $G_0(k_0, k_0; \\omega)$, which we denote $\\operatorname{Re} G$, is obtained by multiplying the numerator and denominator by the complex conjugate of the denominator:\n$$ \\operatorname{Re} G = \\frac{-\\lambda [g(k_0)]^2 \\left(1 + \\frac{\\lambda}{2\\pi^2}I_R\\right)}{\\left(1 + \\frac{\\lambda}{2\\pi^2}I_R\\right)^2 + \\left(\\frac{\\lambda}{2\\pi^2}I_I\\right)^2} $$\nThis expression can be numerically computed. For each parameter set, we must calculate this quantity for three different models of the single-particle energy $\\epsilon(k)$:\n1.  Free spectrum: $\\epsilon_{\\mathrm{free}}(k) = (\\hbar^2/2m) k^2$.\n2.  Effective mass: $\\epsilon_{\\mathrm{eff}}(k) = (\\hbar^2/2m)(m/m^*)k^2 + U_0$.\n3.  Momentum-dependent mean field: $\\epsilon_{\\mathrm{mom}}(k) = (\\hbar^2/2m)k^2 - U_0^{(\\mathrm{mom})}/\\bigl(1+(k/k_c)^2\\bigr)$.\n\nFor each model, we set the on-shell energy $\\omega$ to $2\\epsilon(k_0)$, where $\\epsilon$ is the respective single-particle energy model. The calculation proceeds by numerically evaluating the definite integrals $I_R$ and $I_I$ using a standard quadrature method, then substituting the results into the expression for $\\operatorname{Re} G$. Finally, we compute the required sensitivity ratios $r_{\\mathrm{eff}}=\\operatorname{Re}\\,G_{\\mathrm{eff}}/\\operatorname{Re}\\,G_{\\mathrm{free}}$ and $r_{\\mathrm{mom}}=\\operatorname{Re}\\,G_{\\mathrm{mom}}/\\operatorname{Re}\\,G_{\\mathrm{free}}$.\n\nThe provided parameters are: kinetic energy coefficient $\\hbar^2/(2m) = 20.735\\,\\mathrm{MeV\\,fm^2}$, potential form factor $g(k) = 1/\\bigl(1+(k/\\beta)^2\\bigr)$, and the test suite specifying $(k_F,k_0,\\beta,\\lambda,m^*/m,U_0,U_0^{(\\mathrm{mom})},k_c,\\eta,q_{\\max})$. The implementation will define a function that takes these parameters and the energy model type as input, computes $\\operatorname{Re} G$, and then the main program will call this function for each model and test case to compute the final ratios.\nFor Test case 4, note that $k_F=0.0$, $m^*/m=1.0$, $U_0=0.0$, and $U_0^{(\\mathrm{mom})}=0.0$. This implies that for this specific case, $\\epsilon_{\\mathrm{free}}(k) = \\epsilon_{\\mathrm{eff}}(k) = \\epsilon_{\\mathrm{mom}}(k)$, and the integral is over $[0, q_{\\max}]$. Consequently, $\\operatorname{Re}G_{\\mathrm{free}} = \\operatorname{Re}G_{\\mathrm{eff}} = \\operatorname{Re}G_{\\mathrm{mom}}$, leading to the expectation that $r_{\\mathrm{eff}} = 1.0$ and $r_{\\mathrm{mom}} = 1.0$. This serves as a validation for the correctness of the implementation.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Computes sensitivity measures for the Bethe-Goldstone G-matrix with a separable potential.\n    \"\"\"\n    # Define the constant from the problem statement.\n    HBAR2_OVER_2M = 20.735  # MeV fm^2\n\n    # Define the test cases from the problem statement.\n    # (k_F, k_0, beta, lam, m_ratio, U0_eff, U0_mom, k_c, eta, q_max)\n    test_cases = [\n        (0.4, 0.8, 1.6, 350.0, 0.9, -20.0, 40.0, 1.7, 1.0e-3, 8.0),\n        (1.33, 1.5, 1.8, 400.0, 0.7, -50.0, 60.0, 1.5, 2.0e-3, 8.0),\n        (1.8, 2.0, 1.4, 300.0, 0.6, -70.0, 80.0, 1.2, 5.0e-3, 8.0),\n        (0.0, 0.2, 1.6, 350.0, 1.0, 0.0, 0.0, 1.5, 1.0e-4, 8.0),\n    ]\n\n    results = []\n\n    def g_potential_form_factor(k, beta):\n        \"\"\"Calculates the potential form factor g(k).\"\"\"\n        return 1.0 / (1.0 + (k / beta)**2)\n\n    def compute_re_g(params, model_type):\n        \"\"\"\n        Computes the real part of the on-shell G-matrix for a given energy model.\n        \"\"\"\n        k_F, k_0, beta, lam, m_ratio, U0_eff, U0_mom, k_c, eta, q_max = params\n\n        # Define the single-particle energy function epsilon(k) based on the model\n        if model_type == 'free':\n            epsilon = lambda k: HBAR2_OVER_2M * k**2\n        elif model_type == 'eff_mass':\n            epsilon = lambda k: HBAR2_OVER_2M * (1.0 / m_ratio) * k**2 + U0_eff\n        elif model_type == 'mom_dep':\n            epsilon = lambda k: HBAR2_OVER_2M * k**2 - U0_mom / (1.0 + (k / k_c)**2)\n        else:\n            raise ValueError(\"Invalid model type provided.\")\n\n        # On-shell starting energy\n        omega = 2.0 * epsilon(k_0)\n\n        # Common part of the integrand numerator, f(q) = q^2 * [g(q)]^2\n        f_q = lambda q: q**2 * g_potential_form_factor(q, beta)**2\n        \n        # Energy denominator term, A(q) = omega - 2*epsilon(q)\n        A_q = lambda q: omega - 2.0 * epsilon(q)\n\n        # Integrand for the real part of the complex integral I\n        integrand_R = lambda q: f_q(q) * A_q(q) / (A_q(q)**2 + eta**2)\n        \n        # Integrand for the imaginary part of the complex integral I\n        integrand_I = lambda q: -f_q(q) * eta / (A_q(q)**2 + eta**2)\n\n        # Perform numerical integration to get I_R and I_I\n        I_R, _ = quad(integrand_R, k_F, q_max)\n        I_I, _ = quad(integrand_I, k_F, q_max)\n\n        # Factor multiplying the integral in the G-matrix denominator\n        integral_term_factor = lam / (2.0 * np.pi**2)\n        \n        # Real and imaginary parts of the G-matrix denominator\n        denom_real = 1.0 + integral_term_factor * I_R\n        denom_imag = integral_term_factor * I_I\n        \n        # G-matrix numerator\n        g_k0_squared = g_potential_form_factor(k_0, beta)**2\n        numerator = -lam * g_k0_squared\n        \n        # Calculate the real part of the G-matrix\n        re_G = (numerator * denom_real) / (denom_real**2 + denom_imag**2)\n        \n        return re_G\n\n    for case in test_cases:\n        # Calculate Re(G) for each of the three models\n        re_g_free = compute_re_g(case, 'free')\n        re_g_eff = compute_re_g(case, 'eff_mass')\n        re_g_mom = compute_re_g(case, 'mom_dep')\n\n        # Calculate the dimensionless sensitivity measures\n        # A check for re_g_free being close to zero is prudent in general,\n        # but for the given parameters, it's not expected to be an issue.\n        r_eff = re_g_eff / re_g_free\n        r_mom = re_g_mom / re_g_free\n\n        results.append(r_eff)\n        results.append(r_mom)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{x:.6f}' for x in results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Realistic nuclear forces possess a complex structure that goes beyond simple central potentials, including critical spin-dependent components like the spin-orbit interaction. This final exercise applies the Bethe-Goldstone formalism to a non-central force, demonstrating how to incorporate the necessary spin and angular momentum algebra for the triplet P-wave ($^3P_J$) channels. By isolating the spin-orbit contribution, you will compute the resulting energy splittings between the $J=0, 1, 2$ states, directly connecting the abstract theory to tangible spectroscopic observables .",
            "id": "3594974",
            "problem": "Consider symmetric infinite nuclear matter at zero temperature with total two-nucleon center-of-mass momentum constrained to zero. Start from the Bethe–Goldstone equation for the in-medium reaction matrix in operator form, relating the in-medium interaction to the bare nucleon–nucleon interaction, the Pauli projector that enforces the exclusion principle, and the noninteracting two-particle propagator. Specialize to the triplet P-wave channels with orbital angular momentum $L=1$ and spin $S=1$, that is, the $^3P_J$ channels with total angular momentum $J\\in\\{0,1,2\\}$.\n\nIsolate only the spin–orbit piece of the interaction, modeled as a rank-1 separable form in the $P$-wave,\n$$\nV_{LS}^{(J)}(k,k') \\equiv C_{LS}\\,\\langle \\mathbf{L}\\cdot\\mathbf{S}\\rangle_{(L=1,S=1;J)} \\, g(k)\\, g(k') \\,,\n$$\nwith $g(k)\\equiv k\\,\\exp\\!\\left[-(k/\\beta)^2\\right]$, where $k$ and $k'$ are relative momenta in $\\mathrm{fm}^{-1}$, $C_{LS}$ is a real coupling constant, and $\\langle \\mathbf{L}\\cdot\\mathbf{S}\\rangle_{(L,S;J)}$ is the standard expectation value in the coupled partial-wave basis. Assume a free single-particle spectrum and the angle-averaged Pauli projector at total momentum $K=0$, so that in the relative-momentum representation the Pauli blocking is a sharp lower limit on the radial momentum integral at the Fermi momentum $k_F$.\n\nYour tasks are:\n\n1) From the operator Bethe–Goldstone equation and the separable ansatz above, reduce the problem in each fixed $J$ channel to a scalar algebraic equation for a reduced in-medium amplitude that depends on the starting energy $\\omega$ and a single Pauli-blocked loop integral. Express the loop integral as a one-dimensional momentum integral with the correct three-dimensional measure and Pauli lower limit, and express the on-shell in-medium reaction matrix element $G^{(J)}(k_0,k_0;\\omega)$ at an external relative momentum $k_0$ in terms of this reduced amplitude and the form factor $g(k_0)$.\n\n2) Use the exact angular-momentum identity for the spin–orbit operator in a definite $(L,S,J)$ channel to relate the $J$-dependence solely to the number $\\langle \\mathbf{L}\\cdot\\mathbf{S}\\rangle_{(1,1;J)}$. Do not assume any additional $J$-dependence beyond this expectation value.\n\n3) Working in units where energies are in mega–electron-volts (MeV) and momenta are in inverse femtometers ($\\mathrm{fm}^{-1}$), take the free relative kinetic energy of two equal-mass nucleons to be $e(k)=\\alpha\\,k^2$ with $\\alpha\\equiv \\hbar^2/m_N = 41.471\\,\\mathrm{MeV\\,fm}^2$. Use the free two-particle propagator with starting energy $\\omega$ and the $K=0$ angle-averaged Pauli projector, i.e., only integrate over $k\\ge k_F$. Introduce a sharp ultraviolet cutoff $\\Lambda$ on the relative momentum integral. Treat the starting energy $\\omega$ as real and strictly negative so that no on-shell singularities occur; compute the real-valued in-medium reaction matrix elements.\n\n4) Implement a program that, for each parameter set in the test suite below, computes five real numbers:\n- the three real on-shell spin–orbit contributions to the in-medium reaction matrix $G^{(J)}(k_0,k_0;\\omega)$ in the $^3P_J$ channels for $J=0,1,2$, and\n- the two splittings $\\Delta_{21}\\equiv \\operatorname{Re}G^{(J=2)} - \\operatorname{Re}G^{(J=1)}$ and $\\Delta_{10}\\equiv \\operatorname{Re}G^{(J=1)} - \\operatorname{Re}G^{(J=0)}$.\nAll five quantities must be expressed in $\\mathrm{MeV\\cdot fm}^3$ and reported as floating-point numbers.\n\nUse the following conventions and inputs:\n- The loop integral must use the three-dimensional momentum measure with angle averaging, i.e., a factor of $1/(2\\pi^2)$ multiplying a one-dimensional integral over $k\\in[k_{\\min},\\Lambda]$ with $k_{\\min}\\equiv \\max(k_F,0)$.\n- The two-particle energy denominator is $\\omega - e(k) = \\omega - \\alpha k^2$.\n- The form factor is $g(k)=k\\,\\exp\\!\\left[-(k/\\beta)^2\\right]$.\n- The expectation value is $\\langle \\mathbf{L}\\cdot\\mathbf{S}\\rangle_{(1,1;J)}=\\frac{1}{2}\\left[J(J+1)-L(L+1)-S(S+1)\\right]$ with $L=S=1$.\n- Treat all inputs as exact within the program; do not round intermediate quantities.\n\nTest suite (each case is a tuple $(k_F,\\omega,\\Lambda,\\beta,C_{LS},k_0)$ with the specified units):\n- Case A: $(\\,1.3\\ \\mathrm{fm}^{-1},\\ -20.0\\ \\mathrm{MeV},\\ 6.0\\ \\mathrm{fm}^{-1},\\ 2.0\\ \\mathrm{fm}^{-1},\\ -200.0\\ \\mathrm{MeV\\cdot fm}^5,\\ 1.3\\ \\mathrm{fm}^{-1}\\,)$.\n- Case B: $(\\,0.0\\ \\mathrm{fm}^{-1},\\ -5.0\\ \\mathrm{MeV},\\ 6.0\\ \\mathrm{fm}^{-1},\\ 2.0\\ \\mathrm{fm}^{-1},\\ -200.0\\ \\mathrm{MeV\\cdot fm}^5,\\ 1.0\\ \\mathrm{fm}^{-1}\\,)$.\n- Case C: $(\\,2.0\\ \\mathrm{fm}^{-1},\\ -40.0\\ \\mathrm{MeV},\\ 6.0\\ \\mathrm{fm}^{-1},\\ 2.0\\ \\mathrm{fm}^{-1},\\ -200.0\\ \\mathrm{MeV\\cdot fm}^5,\\ 2.0\\ \\mathrm{fm}^{-1}\\,)$.\n\nFinal output format:\n- Your program should produce a single line of output containing a list of three inner lists, one per test case, in the order A, B, C.\n- Each inner list must have five entries in the exact order $[\\,\\operatorname{Re}G^{(J=0)},\\ \\operatorname{Re}G^{(J=1)},\\ \\operatorname{Re}G^{(J=2)},\\ \\Delta_{21},\\ \\Delta_{10}\\,]$, with all values in $\\mathrm{MeV\\cdot fm}^3$.\n- The outer list and all inner lists must be printed with square brackets, and numbers must be separated by commas without additional text. For example: $[[x_{A,0},x_{A,1},x_{A,2},x_{A,3},x_{A,4}],[x_{B,0},\\dots],[x_{C,0},\\dots]]$.",
            "solution": "The user has provided a problem in computational nuclear physics that requires the derivation and numerical solution of the Bethe-Goldstone equation for a simplified, separable spin-orbit interaction in symmetric nuclear matter.\n\n### Step 1: Extract Givens\n- **Physical System**: Symmetric infinite nuclear matter at zero temperature, total two-nucleon center-of-mass momentum $K=0$.\n- **Equation of Motion**: Bethe–Goldstone equation.\n- **Partial Waves**: Triplet P-wave channels, $L=1$, $S=1$, yielding total angular momenta $J \\in \\{0, 1, 2\\}$, denoted as $^3P_J$.\n- **Interaction Model**: A rank-1 separable spin–orbit potential, $V_{LS}^{(J)}(k,k') \\equiv C_{LS}\\,\\langle \\mathbf{L}\\cdot\\mathbf{S}\\rangle_{(L=1,S=1;J)} \\, g(k)\\, g(k')$.\n- **Form Factor**: $g(k) \\equiv k\\,\\exp\\!\\left[-(k/\\beta)^2\\right]$, where $k$ and $k'$ are relative momenta in $\\mathrm{fm}^{-1}$.\n- **Physics Model**: Free single-particle spectrum and an angle-averaged Pauli projector, which imposes a sharp lower limit $k_F$ on the intermediate relative momentum integral. An additional sharp ultraviolet cutoff $\\Lambda$ is imposed.\n- **Energy Spectrum**: The free relative kinetic energy of two nucleons is $e(k)=\\alpha\\,k^2$, with $\\alpha \\equiv \\hbar^2/m_N = 41.471\\,\\mathrm{MeV\\,fm}^2$. The two-particle energy denominator is $\\omega - e(k) = \\omega - \\alpha k^2$, where $\\omega$ is a real, strictly negative starting energy.\n- **Momentum Integration**: The loop integral uses a three-dimensional measure with angle averaging, $\\frac{1}{2\\pi^2}\\int_{k_{\\min}}^{\\Lambda} k^2 dk$, with $k_{\\min} \\equiv \\max(k_F,0)$.\n- **Angular Momentum Coupling**: The expectation value of the spin-orbit operator is given by $\\langle \\mathbf{L}\\cdot\\mathbf{S}\\rangle_{(1,1;J)}=\\frac{1}{2}\\left[J(J+1)-L(L+1)-S(S+1)\\right]$ for $L=S=1$.\n- **Task**: Compute the real on-shell in-medium reaction matrix elements $G^{(J)}(k_0,k_0;\\omega)$ for $J=0,1,2$, and the energy splittings $\\Delta_{21}\\equiv \\operatorname{Re}G^{(J=2)} - \\operatorname{Re}G^{(J=1)}$ and $\\Delta_{10}\\equiv \\operatorname{Re}G^{(J=1)} - \\operatorname{Re}G^{(J=0)}$. All values are to be in units of $\\mathrm{MeV\\cdot fm}^3$.\n- **Test Cases**:\n    - A: $(k_F,\\omega,\\Lambda,\\beta,C_{LS},k_0) = (1.3, -20.0, 6.0, 2.0, -200.0, 1.3)$ in units of $\\mathrm{fm}^{-1}, \\mathrm{MeV}, \\mathrm{fm}^{-1}, \\mathrm{fm}^{-1}, \\mathrm{MeV\\cdot fm}^5, \\mathrm{fm}^{-1}$.\n    - B: $(k_F,\\omega,\\Lambda,\\beta,C_{LS},k_0) = (0.0, -5.0, 6.0, 2.0, -200.0, 1.0)$.\n    - C: $(k_F,\\omega,\\Lambda,\\beta,C_{LS},k_0) = (2.0, -40.0, 6.0, 2.0, -200.0, 2.0)$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, employing the Bethe-Goldstone equation, which is a standard tool in nuclear many-body theory. The use of a separable potential is a well-established and valid approximation for solving such integral equations. The physical parameters, including the constant $\\alpha$, Fermi momenta, and interaction strength, are within ranges typical for nuclear physics calculations. The problem is well-posed, providing all necessary definitions, constants, and data for a unique solution. The language is objective and unambiguous. The units are internally consistent: the interaction $V^{(J)}(k,k')$ has units of $(\\mathrm{MeV\\cdot fm}^5) \\cdot (\\mathrm{fm}^{-1}) \\cdot (\\mathrm{fm}^{-1}) = \\mathrm{MeV\\cdot fm}^3$, which corresponds to Energy $\\times$ Volume, the correct units for a momentum-space potential matrix element. The requested output is also in these units. The problem passes all validation criteria.\n\n### Step 3: Verdict and Action\nThe problem is valid. I will now proceed with the solution.\n\n### Principle-Based Solution\n\nThe starting point is the Bethe-Goldstone equation for the in-medium reaction matrix $G$, which sums all two-particle ladder diagrams in the nuclear medium. In a specific partial-wave channel, identified by total angular momentum $J$, it takes the form of an integral equation in the relative momentum representation:\n$$\nG^{(J)}(k, k'; \\omega) = V^{(J)}(k, k') + \\int_0^\\infty \\frac{p^2 dp}{2\\pi^2} V^{(J)}(k, p) \\frac{Q(p)}{\\omega - H_0(p)} G^{(J)}(p, k'; \\omega)\n$$\nHere, $V^{(J)}$ is the bare nucleon-nucleon interaction, $Q(p)$ is the Pauli exclusion principle operator, and the denominator contains the starting energy $\\omega$ and the non-interacting two-particle Hamiltonian $H_0(p)$.\n\nThe problem specifies the following:\n1. The bare interaction is a rank-1 separable spin-orbit potential: $V_{LS}^{(J)}(k,k') = C_{LS_J} g(k) g(k')$, where $C_{LS_J} \\equiv C_{LS} \\langle \\mathbf{L}\\cdot\\mathbf{S} \\rangle_{(1,1;J)}$ and the form factor is $g(k) = k e^{-(k/\\beta)^2}$.\n2. The angle-averaged Pauli projector for zero total momentum ($K=0$) restricts intermediate state momenta to be above the Fermi momentum, $p \\ge k_F$. With the given UV cutoff $\\Lambda$, the integration domain is $p \\in [k_F, \\Lambda]$. This effectively means $Q(p) = \\theta(p - k_F)\\theta(\\Lambda - p)$.\n3. The intermediate-state energy is that of two free particles, $H_0(p) = e(p) = \\alpha p^2$.\n\nSubstituting these into the Bethe-Goldstone equation gives:\n$$\nG^{(J)}(k, k'; \\omega) = C_{LS_J} g(k) g(k') + \\int_{k_F}^{\\Lambda} \\frac{p^2 dp}{2\\pi^2} \\left[ C_{LS_J} g(k) g(p) \\right] \\frac{1}{\\omega - \\alpha p^2} G^{(J)}(p, k'; \\omega)\n$$\nDue to the separable nature of the potential, the solution for $G^{(J)}$ must also be separable. We make the ansatz:\n$$\nG^{(J)}(k, k'; \\omega) = \\tau_J(\\omega) g(k) g(k')\n$$\nwhere $\\tau_J(\\omega)$ is a reduced, momentum-independent amplitude for channel $J$ at starting energy $\\omega$. Substituting this ansatz into the integral equation:\n$$\n\\tau_J(\\omega) g(k) g(k') = C_{LS_J} g(k) g(k') + C_{LS_J} g(k) \\left[ \\int_{k_F}^{\\Lambda} \\frac{p^2 dp}{2\\pi^2} \\frac{g(p)^2}{\\omega - \\alpha p^2} \\right] \\tau_J(\\omega) g(k')\n$$\nAssuming $g(k)g(k') \\neq 0$, we can divide it out to obtain a scalar algebraic equation for $\\tau_J(\\omega)$:\n$$\n\\tau_J(\\omega) = C_{LS_J} + C_{LS_J} \\tau_J(\\omega) I(\\omega, k_F, \\Lambda)\n$$\nwhere the Pauli-blocked loop integral $I(\\omega, k_F, \\Lambda)$ is defined as:\n$$\nI(\\omega, k_F, \\Lambda) \\equiv \\frac{1}{2\\pi^2} \\int_{k_F}^{\\Lambda} \\frac{p^2 [g(p)]^2}{\\omega - \\alpha p^2} dp = \\frac{1}{2\\pi^2} \\int_{k_F}^{\\Lambda} \\frac{p^4 e^{-2(p/\\beta)^2}}{\\omega - \\alpha p^2} dp\n$$\nNote that the problem defines the lower integration limit as $k_{\\min} = \\max(k_F,0)$, which is handled by setting the lower bound to $k_F$ since $k_F \\ge 0$ in all cases. The starting energy $\\omega$ is strictly negative, so the denominator $\\omega - \\alpha p^2$ is always negative and never zero, ensuring the integral is real and well-defined.\n\nSolving the algebraic equation for the reduced amplitude $\\tau_J(\\omega)$:\n$$\n\\tau_J(\\omega) \\left[ 1 - C_{LS_J} I(\\omega, k_F, \\Lambda) \\right] = C_{LS_J} \\implies \\tau_J(\\omega) = \\frac{C_{LS_J}}{1 - C_{LS_J} I(\\omega, k_F, \\Lambda)}\n$$\nThe on-shell reaction matrix element at an external relative momentum $k_0$ is then given by:\n$$\nG^{(J)}(k_0, k_0; \\omega) = \\tau_J(\\omega) [g(k_0)]^2 = \\frac{C_{LS_J} [g(k_0)]^2}{1 - C_{LS_J} I(\\omega, k_F, \\Lambda)}\n$$\nThis expression provides the required matrix elements.\n\nThe channel-dependence is governed by $C_{LS_J}$, which contains the spin-orbit expectation value. For the $^3P_J$ states ($L=1, S=1$):\n$$\n\\langle \\mathbf{L}\\cdot\\mathbf{S}\\rangle_{(1,1;J)} = \\frac{1}{2}[J(J+1) - L(L+1) - S(S+1)] = \\frac{1}{2}[J(J+1) - 2 - 2] = \\frac{1}{2}[J(J+1) - 4]\n$$\nThis yields the specific values:\n- $J=0$: $\\langle \\mathbf{L}\\cdot\\mathbf{S}\\rangle_0 = \\frac{1}{2}[0 - 4] = -2$\n- $J=1$: $\\langle \\mathbf{L}\\cdot\\mathbf{S}\\rangle_1 = \\frac{1}{2}[2 - 4] = -1$\n- $J=2$: $\\langle \\mathbf{L}\\cdot\\mathbf{S}\\rangle_2 = \\frac{1}{2}[6 - 4] = +1$\n\nThus, the coupling constants for each channel are:\n- $C_{LS, J=0} = -2 C_{LS}$\n- $C_{LS, J=1} = -1 C_{LS}$\n- $C_{LS, J=2} = +1 C_{LS}$\n\nThe computational procedure is as follows:\n1. For each test case, retrieve the parameters $(k_F, \\omega, \\Lambda, \\beta, C_{LS}, k_0)$.\n2. Numerically evaluate the common loop integral $I(\\omega, k_F, \\Lambda)$ using a standard quadrature method.\n3. Calculate the common factor $[g(k_0)]^2 = (k_0 e^{-(k_0/\\beta)^2})^2$.\n4. For each channel $J \\in \\{0, 1, 2\\}$:\n    a. Determine the channel coupling $C_{LS_J}$.\n    b. Compute $G^{(J)}(k_0, k_0; \\omega)$ using the derived formula.\n5. Calculate the splittings $\\Delta_{21} = G^{(J=2)} - G^{(J=1)}$ and $\\Delta_{10} = G^{(J=1)} - G^{(J=0)}$.\n6. Collate the five results $[G^{(J=0)}, G^{(J=1)}, G^{(J=2)}, \\Delta_{21}, \\Delta_{10}]$ for the current test case.\n7. Repeat for all test cases and format the final output as a list of lists.",
            "answer": "```python\nimport numpy as np\nfrom scipy import integrate\n\ndef solve():\n    \"\"\"\n    Solves the Bethe-Goldstone equation for a separable spin-orbit potential\n    in nuclear matter for the specified test cases.\n    \"\"\"\n    \n    # Constant alpha = hbar^2/m_N in MeV*fm^2\n    ALPHA = 41.471\n\n    # Test suite from the problem statement.\n    # Each case is a tuple (k_F, omega, Lambda, beta, C_LS, k_0) with units:\n    # (fm^-1, MeV, fm^-1, fm^-1, MeV*fm^5, fm^-1)\n    test_cases = [\n        (1.3, -20.0, 6.0, 2.0, -200.0, 1.3),  # Case A\n        (0.0, -5.0, 6.0, 2.0, -200.0, 1.0),   # Case B\n        (2.0, -40.0, 6.0, 2.0, -200.0, 2.0),   # Case C\n    ]\n\n    def calculate_g_matrix_for_case(params):\n        \"\"\"\n        Calculates the G-matrix elements and splittings for a single parameter set.\n        \"\"\"\n        k_F, omega, Lambda, beta, C_LS, k_0 = params\n\n        # Define the integrand for the loop integral calculation\n        # The integrand is p^4 * exp(-2*(p/beta)^2) / (omega - alpha*p^2)\n        def integrand_for_quad(p):\n            return p**4 * np.exp(-2.0 * (p / beta)**2) / (omega - ALPHA * p**2)\n\n        # Numerically compute the loop integral using scipy.integrate.quad\n        # The integration range is [k_min, Lambda] where k_min = max(k_F, 0)\n        # The full loop integral includes the 1/(2*pi^2) factor from the 3D measure\n        k_min = max(k_F, 0.0)\n        integral_val, _ = integrate.quad(integrand_for_quad, k_min, Lambda)\n        loop_integral_I = integral_val / (2.0 * np.pi**2)\n\n        # Calculate the form factor squared at the on-shell point k_0\n        g_k0_sq = (k_0 * np.exp(-(k_0 / beta)**2))**2\n\n        G_values = {}\n        # Iterate over the three J channels in the 3P partial wave (L=1, S=1)\n        # J_vals = (0, 1, 2)\n        L = 1.0\n        S = 1.0\n        for J_val in [0.0, 1.0, 2.0]:\n            # Calculate the expectation value of L.S\n            ls_exp_val = 0.5 * (J_val * (J_val + 1.0) - L * (L + 1.0) - S * (S + 1.0))\n            \n            # Determine the channel-specific coupling constant C_LS_J\n            C_LS_J = C_LS * ls_exp_val\n            \n            # Calculate the G-matrix element for the channel J\n            denominator = 1.0 - C_LS_J * loop_integral_I\n            if abs(denominator)  1e-15: # Avoid division by zero\n                # This case indicates a pole, which should not happen for the given parameters\n                # As omega is strictly negative. But it is good practice to check.\n                G_J = np.inf\n            else:\n                numerator = C_LS_J * g_k0_sq\n                G_J = numerator / denominator\n            \n            G_values[int(J_val)] = G_J\n\n        G0 = G_values[0]\n        G1 = G_values[1]\n        G2 = G_values[2]\n\n        # Calculate the splittings\n        delta_21 = G2 - G1\n        delta_10 = G1 - G0\n\n        return [G0, G1, G2, delta_21, delta_10]\n\n    # Process all test cases\n    results = [calculate_g_matrix_for_case(case) for case in test_cases]\n\n    # Format the output string as specified: [[r1_1, r1_2, ...],[r2_1, r2_2, ...]]\n    formatted_inner_lists = [f\"[{','.join(map(str, row))}]\" for row in results]\n    final_output_string = f\"[{','.join(formatted_inner_lists)}]\"\n    \n    print(final_output_string)\n\nsolve()\n```"
        }
    ]
}