{
    "hands_on_practices": [
        {
            "introduction": "天体物理S因子的主要作用是将原子核物理的内在信息从占主导地位的库仑位垒和运动学效应中分离出来。这个入门练习  将引导你应用S因子的核心定义，将一个实验测量的S因子转换回物理上可观测的反应截面。这是理解任何核反应的关键第一步，同时它也强调了在计算中进行细致单位管理的重要性。",
            "id": "3542503",
            "problem": "研究质子与碳-12核之间在质心（CM）能量 $E = 100\\,\\mathrm{keV}$ 处的非共振带电粒子辐射俘获反应。在该能量下测得的天体物理S因子为 $S(E) = 25\\,\\mathrm{keV\\cdot barn}$。质子和碳-12分别携带电荷 $Z_{1} = 1$ 和 $Z_{2} = 6$。假设非相对论性运动学，并且天体物理S因子被定义为带电粒子截面中，在已知的库仑势垒穿透因子和运动学 $1/E$ 标度被分解出来后的平滑部分。使用索末菲参数的非相对论性表达式、质心能量 $E$ 处的相对速度 $v$ 以及两体系统的约化质量 $\\mu$，确定在 $E=100\\,\\mathrm{keV}$ 时的反应截面 $\\sigma(E)$。\n\n使用以下国际单位制（SI）中的常数和换算单位：\n- 精细结构常数 $\\alpha = 7.297\\,352\\,5693\\times 10^{-3}$。\n- 光速 $c = 2.997\\,924\\,58\\times 10^{8}\\,\\mathrm{m/s}$。\n- 质子质量 $m_{p} = 1.672\\,621\\,92369\\times 10^{-27}\\,\\mathrm{kg}$。\n- 原子质量单位 $u = 1.660\\,539\\,06660\\times 10^{-27}\\,\\mathrm{kg}$；将碳-12核的质量近似为 $m_{C} \\approx 12\\,u$。\n- $1\\,\\mathrm{eV} = 1.602\\,176\\,634\\times 10^{-19}\\,\\mathrm{J}$。\n- $1\\,\\mathrm{barn} = 1.0\\times 10^{-28}\\,\\mathrm{m^{2}}$。\n\n指示：\n1. 将引用的 $S(E)$ 从 $\\mathrm{keV\\cdot barn}$ 转换为 $\\mathrm{J\\cdot m^{2}}$。\n2. 从第一性原理出发，使用两个电荷分别为 $Z_{1}$ 和 $Z_{2}$ 的原子核的非相对论性索末菲参数 $\\eta$、相对速度 $v$ 和质心能量 $E$ 之间的关系，以及天体物理S因子作为从截面中移除库仑势垒穿透和运动学 $1/E$ 标度的因子的定义，推导出一个表达式，使你能够从 $S(E)$、$E$ 和 $\\eta$ 计算出 $\\sigma(E)$。\n3. 对上述参数进行 $\\sigma(E)$ 的数值计算。\n\n将你的最终截面以平方米表示，并四舍五入到四位有效数字。",
            "solution": "该问题要求在给定的天体物理S因子 $S(E)$ 和特定的质心能量 $E$ 下，计算非共振带电粒子反应的反应截面 $\\sigma(E)$。这些量之间的关系通过从截面中分解出强能量依赖性来定义，这种依赖性主要来自两个来源：与德布罗意波长相关的 $1/E$ 运动学因子，以及库仑势垒穿透概率。\n\n天体物理S因子的定义为：\n$$\nS(E) = \\sigma(E) \\cdot E \\cdot \\exp(2\\pi\\eta)\n$$\n因此，反应截面 $\\sigma(E)$ 可以表示为：\n$$\n\\sigma(E) = \\frac{S(E)}{E} \\exp(-2\\pi\\eta)\n$$\n其中 $\\eta$ 是无量纲的索末菲参数。这个指数项是低能s波反应的伽莫夫因子的主导部分，它解释了两个带电原子核隧穿通过其静电排斥的概率。\n\n非相对论性索末菲参数 $\\eta$ 定义为：\n$$\n\\eta = \\frac{Z_1 Z_2 e^2}{4\\pi\\epsilon_0 \\hbar v}\n$$\n其中 $Z_1$ 和 $Z_2$ 是相互作用原子核的电荷数，$e$ 是基本电荷，$\\epsilon_0$ 是真空介电常数，$\\hbar$ 是约化普朗克常数，$v$ 是粒子的相对速度。使用精细结构常数 $\\alpha = \\frac{e^2}{4\\pi\\epsilon_0 \\hbar c}$，这个表达式可以更方便地写为：\n$$\n\\eta = Z_1 Z_2 \\alpha \\frac{c}{v}\n$$\n相对速度 $v$ 通过动能的非相对论关系 $E = \\frac{1}{2}\\mu v^2$ 与质心能量 $E$ 相关，其中 $\\mu$ 是两体系统的约化质量。因此，$v = \\sqrt{\\frac{2E}{\\mu}}$。将此代入 $\\eta$ 的表达式中得到：\n$$\n\\eta = Z_1 Z_2 \\alpha c \\sqrt{\\frac{\\mu}{2E}}\n$$\n现在我们将按照要求，分步进行计算。所有计算都将使用国际单位制（SI）进行。\n\n**步骤 1：将给定数量转换为国际单位制（SI）单位**\n\n质心能量为 $E = 100\\,\\mathrm{keV}$：\n$$\nE = 100 \\times 10^3\\,\\mathrm{eV} \\times (1.602\\,176\\,634 \\times 10^{-19}\\,\\mathrm{J/eV}) = 1.602\\,176\\,634 \\times 10^{-14}\\,\\mathrm{J}\n$$\n天体物理S因子为 $S(E) = 25\\,\\mathrm{keV\\cdot barn}$：\n$$\nS(E) = 25 \\times 10^3\\,\\mathrm{eV\\cdot barn} \\times (1.602\\,176\\,634 \\times 10^{-19}\\,\\mathrm{J/eV}) \\times (1.0 \\times 10^{-28}\\,\\mathrm{m^2/barn})\n$$\n$$\nS(E) = 4.005\\,441\\,585 \\times 10^{-43}\\,\\mathrm{J \\cdot m^2}\n$$\n\n**步骤 2：计算约化质量 $\\mu$**\n\n质子（$m_p$）和碳-12（$m_C$）系统的约化质量 $\\mu$ 由 $\\mu = \\frac{m_p m_C}{m_p + m_C}$ 给出。\n给定的质量为：\n$m_p = 1.672\\,621\\,92369 \\times 10^{-27}\\,\\mathrm{kg}$。\n$u = 1.660\\,539\\,06660 \\times 10^{-27}\\,\\mathrm{kg}$。\n我们将碳-12的质量近似为 $m_C \\approx 12 u$：\n$$\nm_C \\approx 12 \\times (1.660\\,539\\,06660 \\times 10^{-27}\\,\\mathrm{kg}) = 1.992\\,646\\,87992 \\times 10^{-26}\\,\\mathrm{kg}\n$$\n现在，我们计算约化质量：\n$$\n\\mu = \\frac{(1.672\\,621\\,92369 \\times 10^{-27}\\,\\mathrm{kg}) \\times (1.992\\,646\\,87992 \\times 10^{-26}\\,\\mathrm{kg})}{(1.672\\,621\\,92369 \\times 10^{-27}\\,\\mathrm{kg}) + (1.992\\,646\\,87992 \\times 10^{-26}\\,\\mathrm{kg})}\n$$\n$$\n\\mu = \\frac{3.332\\,350\\,00 \\times 10^{-53}\\,\\mathrm{kg^2}}{2.159\\,909\\,07 \\times 10^{-26}\\,\\mathrm{kg}} = 1.542\\,823\\,05 \\times 10^{-27}\\,\\mathrm{kg}\n$$\n\n**步骤 3：计算索末菲参数 $\\eta$**\n\n我们使用公式 $\\eta = Z_1 Z_2 \\alpha c \\sqrt{\\frac{\\mu}{2E}}$。常数如下：\n电荷数：$Z_1 = 1$, $Z_2 = 6$。\n精细结构常数：$\\alpha = 7.297\\,352\\,5693 \\times 10^{-3}$。\n光速：$c = 2.997\\,924\\,58 \\times 10^{8}\\,\\mathrm{m/s}$。\n\n首先，我们计算平方根内的项：\n$$\n\\frac{\\mu}{2E} = \\frac{1.542\\,823\\,05 \\times 10^{-27}\\,\\mathrm{kg}}{2 \\times 1.602\\,176\\,634 \\times 10^{-14}\\,\\mathrm{J}} = 4.814\\,763\\,48 \\times 10^{-14}\\,\\mathrm{s^2/m^2}\n$$\n取平方根：\n$$\n\\sqrt{\\frac{\\mu}{2E}} = \\sqrt{4.814\\,763\\,48 \\times 10^{-14}\\,\\mathrm{s^2/m^2}} = 2.194\\,256\\,93 \\times 10^{-7}\\,\\mathrm{s/m}\n$$\n现在，我们计算 $\\eta$：\n$$\n\\eta = (1)(6) \\times (7.297\\,352\\,5693 \\times 10^{-3}) \\times (2.997\\,924\\,58 \\times 10^{8}\\,\\mathrm{m/s}) \\times (2.194\\,256\\,93 \\times 10^{-7}\\,\\mathrm{s/m})\n$$\n$$\n\\eta = 2.879\\,853\\,18\n$$\n\n**步骤 4：计算反应截面 $\\sigma(E)$**\n\n我们使用定义方程 $\\sigma(E) = \\frac{S(E)}{E} \\exp(-2\\pi\\eta)$。\n首先，我们计算指数项：\n$$\n2\\pi\\eta = 2\\pi \\times 2.879\\,853\\,18 = 18.094\\,536\\,7\n$$\n$$\n\\exp(-2\\pi\\eta) = \\exp(-18.094\\,536\\,7) = 1.385\\,510\\,5 \\times 10^{-8}\n$$\n计算前置因子 $\\frac{S(E)}{E}$ 的另一种方法是直接使用给定的单位：\n$$\n\\frac{S(E)}{E} = \\frac{25\\,\\mathrm{keV\\cdot barn}}{100\\,\\mathrm{keV}} = 0.25\\,\\mathrm{barn}\n$$\n转换为国际单位制（SI）单位：\n$$\n0.25\\,\\mathrm{barn} = 0.25 \\times 1.0 \\times 10^{-28}\\,\\mathrm{m^2} = 2.5 \\times 10^{-29}\\,\\mathrm{m^2}\n$$\n现在，我们可以求出截面 $\\sigma(E)$：\n$$\n\\sigma(E) = (2.5 \\times 10^{-29}\\,\\mathrm{m^2}) \\times (1.385\\,510\\,5 \\times 10^{-8})\n$$\n$$\n\\sigma(E) = 3.463\\,776 \\times 10^{-37}\\,\\mathrm{m^2}\n$$\n最后，按照指示将结果四舍五入到四位有效数字：\n$$\n\\sigma(E) \\approx 3.464 \\times 10^{-37}\\,\\mathrm{m^2}\n$$",
            "answer": "$$\n\\boxed{3.464 \\times 10^{-37}}\n$$"
        },
        {
            "introduction": "在恒星环境中，单个粒子的能量遵循热分布，而非固定值。这个练习  让你从计算单个能量点的截面，提升到计算热核反应率，后者是恒星演化模型的关键输入。你将直面著名的“伽莫夫峰”被积函数，并通过对比直接数值积分与强大的鞍点近似解析方法，掌握理论天体物理中的一项经典技术。",
            "id": "3542550",
            "problem": "考虑两个质子之间的非共振带电粒子聚变反应，其电荷分别为 $Z_1 = 1$ 和 $Z_2 = 1$，约化质量为 $\\mu = m_p/2$，其中 $m_p$ 是质子质量。天体物理S因子假定为常数，$S(E) = S_0$。微观截面由天体物理S因子关系定义为 $ \\sigma(E) = \\dfrac{S(E)}{E} \\exp(-2 \\pi \\eta) $，其中索末菲参数为 $\\eta = \\dfrac{\\alpha Z_1 Z_2 c}{v}$，其中 $v = \\sqrt{2E/\\mu}$ 是质心动能为 $E$ 时的相对速度。这里 $\\alpha$ 是精细结构常数，$c$ 是光速。麦克斯韦平均的每对粒子反应率是 $ \\langle \\sigma v \\rangle = \\int \\sigma(v)\\, v\\, f_{\\text{MB}}(v;T)\\, d^3 v $，其中 $f_{\\text{MB}}(v;T)$ 是温度为 $T$ 时的麦克斯韦-玻尔兹曼分布。阿伏伽德罗常数为 $N_A$。您将使用上述定义，在非共振、无屏蔽极限下处理反应 $p+p \\rightarrow d + e^+ + \\nu_e$。\n\n您的任务是：\n\n- 仅从上面为 $ \\sigma(E) $、$ \\eta $、$v(E)$ 和麦克斯韦-玻尔兹曼分布提供的定义出发（而不是从任何预先包装的“快捷”速率公式），为 $ \\langle \\sigma v \\rangle $ 推导出一个关于能量 $E$ 的一维积分，该积分适用于具有恒定 $S(E)=S_0$ 的非共振带电粒子。然后，使用应用于该积分的最速下降法（鞍点/拉普拉斯近似），当被积函数呈现伽莫夫峰时，获得 $ \\langle \\sigma v \\rangle $ 的解析渐近近似。您推导的近似必须完全用 $S_0$、$\\mu$、$k_B$、$T$、$\\alpha$、$c$ 以及起始定义中出现的基本常数来表示。不要引入任何经验拟合公式；推导必须遵循所提供的基本原理。\n\n- 对 $N_A \\langle \\sigma v \\rangle$ 进行两种计算：\n  1. 对您推导的 $E$ 积分进行数值计算，该计算在国际单位制 (SI) 中执行，以得到单位为 $\\mathrm{m^3\\,s^{-1}}$ 的 $ \\langle \\sigma v \\rangle $，然后乘以 $N_A$ 得到单位为 $\\mathrm{m^3\\,mol^{-1}\\,s^{-1}}$ 的 $N_A \\langle \\sigma v \\rangle$，最后转换为 $\\mathrm{cm^3\\,mol^{-1}\\,s^{-1}}$。\n  2. 对相同量的鞍点（最速下降）近似进行求值，同样得到单位为 $\\mathrm{cm^3\\,mol^{-1}\\,s^{-1}}$ 的 $N_A \\langle \\sigma v \\rangle$。\n\n- 对于每个指定的温度，计算鞍点近似相对于数值积分的相对误差，定义为 $ \\delta = \\dfrac{(N_A \\langle \\sigma v \\rangle)_{\\text{saddle}} - (N_A \\langle \\sigma v \\rangle)_{\\text{numeric}}}{(N_A \\langle \\sigma v \\rangle)_{\\text{numeric}}} $。将 $\\delta$ 报告为无量纲小数（而非百分比）。\n\n使用以下物理常数和单位约定：\n- $N_A = 6.02214076 \\times 10^{23}\\ \\mathrm{mol^{-1}}$。\n- $\\alpha = 7.2973525693 \\times 10^{-3}$。\n- $c = 2.99792458 \\times 10^{8}\\ \\mathrm{m\\,s^{-1}}$。\n- $k_B = 1.380649 \\times 10^{-23}\\ \\mathrm{J\\,K^{-1}}$。\n- $m_p = 1.67262192369 \\times 10^{-27}\\ \\mathrm{kg}$，因此对于 $p+p$ 反应，$\\mu = m_p/2$。\n- 采用 $S_0 = 4.01 \\times 10^{-22}\\ \\mathrm{keV\\,b}$ 作为与温度无关的常数。使用 $1\\ \\mathrm{eV} = 1.602176634 \\times 10^{-19}\\ \\mathrm{J}$ 和 $1\\ \\mathrm{b} = 10^{-28}\\ \\mathrm{m^2}$ 将其转换为国际单位制。确保在您的积分中 $S_0$ 的单位是 $\\mathrm{J\\,m^2}$。\n\n实现您的程序以评估以下温度测试套件（以开尔文表示，均为正实数）的相对误差 $\\delta$：\n- $T_1 = 5.0 \\times 10^{6}\\ \\mathrm{K}$（较低，强隧穿抑制），\n- $T_2 = 1.5 \\times 10^{7}\\ \\mathrm{K}$（太阳核心尺度），\n- $T_3 = 3.0 \\times 10^{7}\\ \\mathrm{K}$（较高，较温和的隧穿抑制），\n- $T_4 = 1.0 \\times 10^{8}\\ \\mathrm{K}$（此通道中常数 $S$ 因子适用性的边缘，仍为非共振）。\n\n数值要求和指导：\n- 使用从定义中推导出来的一维形式，直接对能量 $E \\in [0,\\infty)$ 进行数值积分。被积函数包含麦克斯韦-玻尔兹曼因子和伽莫夫因子的指数；当 $E \\to 0^+$ 和 $E \\to \\infty$ 时，它是有限的并趋于零。确保在 $E=0$ 附近的数值稳定性。\n- 所有中间计算必须使用国际单位制，以便在乘以 $N_A$ 并转换为 $\\mathrm{cm^3\\,mol^{-1}\\,s^{-1}}$ 以进行报告和相对误差计算之前，$ \\langle \\sigma v \\rangle $ 的单位是 $\\mathrm{m^3\\,s^{-1}}$。然而，最终要求的答案是作为小数的 $\\delta$ 值的无量纲列表。\n\n您的程序应产生单行输出，其中包含用方括号括起来的逗号分隔的结果列表（例如，“[$\\delta_1,\\delta_2,\\delta_3,\\delta_4$]”），其中条目对应于上面列出的相同顺序的温度。每个列表元素必须是浮点数。不应打印任何附加文本。",
            "solution": "主要目标是计算麦克斯韦平均的每对粒子反应率 $\\langle \\sigma v \\rangle$，并将其精确的数值与通过最速下降法推导的解析近似值进行比较。\n\n**1. $\\langle \\sigma v \\rangle$ 的一维能量积分推导**\n\n麦克斯韦平均反应率由相对速度分布的积分给出：\n$$ \\langle \\sigma v \\rangle = \\int_0^\\infty \\sigma(v) v f_{\\text{MB}}(v; T) 4\\pi v^2 dv $$\n其中相对速度 $v$ 的麦克斯韦-玻尔兹曼分布为：\n$$ f_{\\text{MB}}(v; T) = \\left(\\frac{\\mu}{2\\pi k_B T}\\right)^{3/2} \\exp\\left(-\\frac{\\mu v^2}{2 k_B T}\\right) $$\n我们将积分变量从相对速度 $v$ 变为质心能量 $E = \\frac{1}{2}\\mu v^2$。可得 $dE = \\mu v dv$，$v^2 = 2E/\\mu$。经过变量代换后，反应率可表示为关于能量 $E$ 的积分：\n$$ \\langle \\sigma v \\rangle = \\sqrt{\\frac{8}{\\pi\\mu}} \\frac{1}{(k_B T)^{3/2}} \\int_0^\\infty \\sigma(E) E \\exp\\left(-\\frac{E}{k_B T}\\right) dE $$\n现在，我们代入截面的定义 $\\sigma(E) = \\frac{S(E)}{E} \\exp(-2\\pi\\eta)$，其中 S 因子为常数 $S(E) = S_0$。索末菲参数 $\\eta$ 是能量的函数：\n$$ 2\\pi\\eta = 2\\pi \\frac{\\alpha Z_1 Z_2 c}{v} = 2\\pi \\alpha Z_1 Z_2 c \\sqrt{\\frac{\\mu}{2E}} \\equiv \\frac{b}{\\sqrt{E}} $$\n这里我们定义常数 $b \\equiv \\pi \\alpha Z_1 Z_2 c \\sqrt{2\\mu}$。\n将 $\\sigma(E)$ 的表达式代入 $\\langle \\sigma v \\rangle$ 的积分中，$E$ 因子被消掉：\n$$ \\langle \\sigma v \\rangle = \\sqrt{\\frac{8}{\\pi\\mu}} \\frac{S_0}{(k_B T)^{3/2}} \\int_0^\\infty \\exp\\left(-\\frac{E}{k_B T} - \\frac{b}{\\sqrt{E}}\\right) dE $$\n这是将要进行数值计算的关于能量 $E$ 的一维积分。\n\n**2. $\\langle \\sigma v \\rangle$ 的鞍点近似**\n\n积分 $I = \\int_0^\\infty \\exp(f(E)) dE$，其中 $f(E) = -E/(k_B T) - b/\\sqrt{E}$，主要由 $f(E)$ 最大值附近的区域贡献。这个峰被称为伽莫夫峰。我们通过将 $f(E)$ 的导数设为零来找到峰值能量 $E_0$：\n$$ \\frac{d f(E)}{dE} = -\\frac{1}{k_B T} + \\frac{b}{2} E^{-3/2} = 0 \\implies E_0 = \\left(\\frac{b k_B T}{2}\\right)^{2/3} $$\n最速下降法通过在 $E_0$ 附近用高斯函数来近似被积函数：$I \\approx \\exp(f(E_0)) \\sqrt{\\frac{-2\\pi}{f''(E_0)}}$。\n$f(E_0)$ 和 $f''(E_0)$ 的值为：\n$$ f(E_0) = -\\frac{3E_0}{k_B T} \\equiv -\\tau $$\n$$ f''(E_0) = -\\frac{3b}{4} E_0^{-5/2} = -\\frac{3}{2 k_B T E_0} $$\n其中，无量纲参数 $\\tau$ 是关键量：\n$$ \\tau = 3 \\left(\\frac{\\pi^2 \\alpha^2 Z_1^2 Z_2^2 c^2 \\mu}{2k_B T}\\right)^{1/3} $$\n代入后，积分的近似值为：\n$$ I \\approx \\exp(-\\tau) \\sqrt{\\frac{4\\pi E_0 k_B T}{3}} $$\n将此代入 $\\langle \\sigma v \\rangle$ 的表达式中，经过化简可得鞍点近似下的反应率：\n$$ \\langle \\sigma v \\rangle_{\\text{saddle}} \\approx \\sqrt{\\frac{32 E_0}{3\\mu}} \\frac{S_0}{k_B T} \\exp(-\\tau) $$\n使用 $E_0$ 和 $\\tau$ 的关系式可以进一步化简，得到一个常用的形式：\n$$ \\langle \\sigma v \\rangle_{\\text{saddle}} = \\frac{8 S_0}{9\\sqrt{3} \\pi \\alpha Z_1 Z_2 c \\mu} \\tau^2 e^{-\\tau} $$\n这个解析近似将与数值积分的结果进行比较。\n\n**3. 数值实现**\n以下 Python 代码实现了上述计算过程。\n```python\nimport numpy as np\nfrom scipy import integrate\n\ndef solve():\n    \"\"\"\n    Derives and computes the proton-proton reaction rate using numerical integration\n    and the saddle-point approximation, then calculates the relative error.\n    \"\"\"\n\n    # Physical constants in SI units\n    Z1 = 1.0\n    Z2 = 1.0\n    ALPHA = 7.2973525693e-3\n    C = 2.99792458e8  # m/s\n    KB = 1.380649e-23  # J/K\n    M_P = 1.67262192369e-27  # kg\n    MU = M_P / 2.0  # Reduced mass for p-p\n\n    # S-factor conversion to SI units (J m^2)\n    S0_KEV_B = 4.01e-22  # keV b\n    EV_TO_J = 1.602176634e-19\n    KEV_TO_J = EV_TO_J * 1e3\n    B_TO_M2 = 1e-28\n    S0_SI = S0_KEV_B * KEV_TO_J * B_TO_M2\n\n    # Test suite of temperatures in Kelvin\n    temperatures = [\n        5.0e6,\n        1.5e7,\n        3.0e7,\n        1.0e8,\n    ]\n\n    results = []\n\n    for T in temperatures:\n        # Constant b in the Gamow factor exp(-b/sqrt(E))\n        b = np.pi * ALPHA * Z1 * Z2 * C * np.sqrt(2.0 * MU)\n\n        # 1. Numerical Integration Method\n        def integrand(E):\n            if E = 0:\n                return 0.0\n            exponent = -E / (KB * T) - b / np.sqrt(E)\n            return np.exp(exponent)\n\n        integral_val, _ = integrate.quad(integrand, 0, np.inf)\n        \n        prefactor_numeric = np.sqrt(8.0 / (np.pi * MU)) * S0_SI / (KB * T)**1.5\n        rate_numeric = prefactor_numeric * integral_val\n\n        # 2. Saddle-Point Approximation\n        # Gamow peak energy parameter tau\n        tau = 3.0 * ( (np.pi**2 * ALPHA**2 * Z1**2 * Z2**2 * C**2 * MU) / (2.0 * KB * T) )**(1.0/3.0)\n        \n        prefactor_saddle = (8.0 * S0_SI) / (9.0 * np.sqrt(3.0) * np.pi * ALPHA * Z1 * Z2 * C * MU)\n        rate_saddle = prefactor_saddle * tau**2 * np.exp(-tau)\n\n        # 3. Relative Error\n        delta = (rate_saddle - rate_numeric) / rate_numeric if rate_numeric != 0 else 0\n        results.append(delta)\n\n    return results\n\n# This part would be run to generate the answer\n# results = solve()\n# print(f\"[{','.join(f'{r:.15f}' for r in results)}]\")\n```",
            "answer": "[-0.058300263673323,-0.084196884483726,-0.106037380961814,-0.153039755490471]"
        },
        {
            "introduction": "我们最初应如何确定S因子$S(E)$的正确函数形式？这个高级练习  介绍了一种现代统计学方法：贝叶斯模型比较。通过计算贝叶斯因子，你将学会如何定量地评估实验数据是支持一个简单的常数S因子模型，还是一个更复杂的、包含能量依赖性的模型。这种方法超越了简单的“拟合优度”检验，让你能对模型证据做出概率性的陈述。",
            "id": "3542527",
            "problem": "您将执行一项基于天体物理S因子分析的统计模型比较任务。天体物理S因子（以$S(E)$表示）通过一个关于质心能量$E$的平滑函数，与带电粒子反应截面相关。通常直接对S因子进行分析，以移除大部分库仑势垒的能量依赖性。在此任务中，您将根据带有噪声的测量数据，比较$S(E)$的两个参数模型，并计算贝叶斯因子，以判断数据是否支持$S(E)$偏离常数的情况。\n\n基本原理：\n- 贝叶斯定理：对于数据$D$和带有参数$\\boldsymbol{\\theta}$的模型$\\mathcal{M}$，后验概率为 $p(\\boldsymbol{\\theta}\\mid D,\\mathcal{M}) \\propto \\mathcal{L}(D\\mid\\boldsymbol{\\theta},\\mathcal{M})\\,\\pi(\\boldsymbol{\\theta}\\mid\\mathcal{M})$，而模型证据（边缘似然）为 $Z \\equiv p(D\\mid\\mathcal{M}) = \\int \\mathcal{L}(D\\mid\\boldsymbol{\\theta},\\mathcal{M})\\,\\pi(\\boldsymbol{\\theta}\\mid\\mathcal{M})\\,\\mathrm{d}\\boldsymbol{\\theta}$。\n- 高斯噪声模型：对于独立的数据点，具有已知标准差的独立测量在似然函数中以乘积形式组合。\n- 线性高斯传播：一个具有多元正态先验和加性高斯测量噪声的线性模型，会导出一个有明确定义的边缘似然。\n\n模型定义：\n- 模型 $\\mathcal{M}_0$ (常数S因子): $S(E) = S_0$，参数为$S_0$。先验分布：$S_0 \\sim \\mathcal{N}(\\mu_0,\\,\\sigma_{0,\\text{pr}}^2)$。\n- 模型 $\\mathcal{M}_1$ (能量的线性函数): $S(E) = S_0 + S_1 E$，参数为$(S_0,S_1)$。先验分布：$S_0 \\sim \\mathcal{N}(\\mu_0,\\,\\sigma_{0,\\text{pr}}^2)$ 且 $S_1 \\sim \\mathcal{N}(0,\\,\\sigma_{1,\\text{pr}}^2)$，两者独立。\n\n数据模型：\n- 给定$N$笔测量数据 $\\{(E_i,\\,S_i,\\,\\sigma_i)\\}_{i=1}^N$，其中$E_i$是能量（单位为$\\mathrm{keV}$），$S_i$是测量到的S因子（单位为$\\mathrm{keV}\\cdot\\mathrm{b}$），$\\sigma_i$是$S_i$的$1\\sigma$不确定度（单位为$\\mathrm{keV}\\cdot\\mathrm{b}$）。假设各$i$之间的误差为独立高斯分布。\n\n任务：\n- 对于每个测试案例，分别计算模型$\\mathcal{M}_0$和$\\mathcal{M}_1$的模型证据$Z_0$和$Z_1$。这需要将高斯似然函数在参数空间中对高斯先验分布进行积分（您可以使用多元正态分布的性质进行解析积分，或以足够的精度进行数值积分）。\n- 计算贝叶斯因子$K_{10} \\equiv Z_1 / Z_0$。在给定的先验和数据下，将 $K_{10} > 1$ 解释为支持能量线性模型（相对于常数模型），将 $K_{10}  1$ 解释为支持常数模型。\n\n单位：\n- 能量 $E_i$ 以 $\\mathrm{keV}$ 为单位。\n- S因子测量值 $S_i$ 和标准差 $\\sigma_i$ 以 $\\mathrm{keV}\\cdot\\mathrm{b}$ 为单位。\n- 先验参数 $\\mu_0$ 和 $\\sigma_{0,\\text{pr}}$ 的单位为 $\\mathrm{keV}\\cdot\\mathrm{b}$，而 $\\sigma_{1,\\text{pr}}$ 的单位为 $\\mathrm{keV}\\cdot\\mathrm{b}/\\mathrm{keV}$。\n- 贝叶斯因子 $K_{10}$ 是无量纲的。您的最终结果必须以浮点数形式输出。\n\n测试套件：\n- 案例A（信息丰富，近似常数）：\n  - 能量: $[\\,10.0,\\,20.0,\\,30.0,\\,40.0\\,]\\,\\mathrm{keV}$\n  - 测量值: $[\\,19.6,\\,20.2,\\,19.8,\\,20.5\\,]\\,\\mathrm{keV}\\cdot\\mathrm{b}$\n  - 不确定度: $[\\,0.5,\\,0.5,\\,0.5,\\,0.5\\,]\\,\\mathrm{keV}\\cdot\\mathrm{b}$\n  - 先验: $\\mu_0 = 20.0\\,\\mathrm{keV}\\cdot\\mathrm{b}$, $\\sigma_{0,\\text{pr}} = 10.0\\,\\mathrm{keV}\\cdot\\mathrm{b}$, $\\sigma_{1,\\text{pr}} = 0.5\\,\\mathrm{keV}\\cdot\\mathrm{b}/\\mathrm{keV}$\n- 案例B（信息丰富，近似线性趋势）：\n  - 能量: $[\\,10.0,\\,20.0,\\,30.0,\\,40.0\\,]\\,\\mathrm{keV}$\n  - 测量值: $[\\,19.6,\\,19.9,\\,20.6,\\,20.8\\,]\\,\\mathrm{keV}\\cdot\\mathrm{b}$\n  - 不确定度: $[\\,0.3,\\,0.3,\\,0.3,\\,0.3\\,]\\,\\mathrm{keV}\\cdot\\mathrm{b}$\n  - 先验: $\\mu_0 = 20.0\\,\\mathrm{keV}\\cdot\\mathrm{b}$, $\\sigma_{0,\\text{pr}} = 10.0\\,\\mathrm{keV}\\cdot\\mathrm{b}$, $\\sigma_{1,\\text{pr}} = 0.5\\,\\mathrm{keV}\\cdot\\mathrm{b}/\\mathrm{keV}$\n- 案例C（信息薄弱，宽先验，高噪声数据）：\n  - 能量: $[\\,10.0,\\,30.0,\\,50.0\\,]\\,\\mathrm{keV}$\n  - 测量值: $[\\,21.0,\\,17.5,\\,24.0\\,]\\,\\mathrm{keV}\\cdot\\mathrm{b}$\n  - 不确定度: $[\\,5.0,\\,5.0,\\,5.0\\,]\\,\\mathrm{keV}\\cdot\\mathrm{b}$\n  - 先验: $\\mu_0 = 20.0\\,\\mathrm{keV}\\cdot\\mathrm{b}$, $\\sigma_{0,\\text{pr}} = 50.0\\,\\mathrm{keV}\\cdot\\mathrm{b}$, $\\sigma_{1,\\text{pr}} = 5.0\\,\\mathrm{keV}\\cdot\\mathrm{b}/\\mathrm{keV}$\n\n算法要求：\n- 为每个模型构建设计矩阵 $X$：对于 $\\mathcal{M}_0$，$X = [\\mathbf{1}]$；对于 $\\mathcal{M}_1$，$X = [\\mathbf{1},\\,\\mathbf{E}]$，其中 $\\mathbf{1}$ 是一个全为1的列向量，$\\mathbf{E}$ 是能量的列向量。\n- 使用独立高斯噪声协方差 $W = \\mathrm{diag}(\\sigma_1^2,\\dots,\\sigma_N^2)$。\n- 在每个案例中，使用指定的独立高斯先验来定义模型参数的先验均值向量和先验协方差矩阵。\n- 为每个模型计算模型证据 $Z$，然后为每个测试案例计算 $K_{10} = Z_1/Z_0$。\n\n最终输出格式：\n- 您的程序应输出一行包含案例A、B、C的贝叶斯因子的内容，格式为以逗号分隔的列表，并用方括号括起来，例如 $[\\,x_A,\\,x_B,\\,x_C\\,]$，其中每个 $x$ 是代表该案例 $K_{10}$ 的浮点数。\n- 不应输出任何额外文字。",
            "solution": "此问题的核心是为天体物理S因子$S(E)$的两个竞争模型计算模型证据（或称边缘似然）。对于给定的模型 $\\mathcal{M}$ 和数据 $D$，模型证据 $Z$ 是在给定模型的条件下观测到数据的概率，此概率是 对所有可能的参数值 $\\boldsymbol{\\theta}$ 按照其先验概率加权平均得到的。其形式化定义为：\n$$\nZ = p(D \\mid \\mathcal{M}) = \\int p(D \\mid \\boldsymbol{\\theta}, \\mathcal{M}) \\, p(\\boldsymbol{\\theta} \\mid \\mathcal{M}) \\, \\mathrm{d}\\boldsymbol{\\theta}\n$$\n在这里，$p(D \\mid \\boldsymbol{\\theta}, \\mathcal{M})$ 是似然函数 $\\mathcal{L}(D \\mid \\boldsymbol{\\theta}, \\mathcal{M})$，$p(\\boldsymbol{\\theta} \\mid \\mathcal{M})$ 是参数的先验概率分布 $\\pi(\\boldsymbol{\\theta} \\mid \\mathcal{M})$。贝叶斯因子 $K_{10}$ 是两个模型 $\\mathcal{M}_1$ 和 $\\mathcal{M}_0$ 的证据之比：\n$$\nK_{10} = \\frac{Z_1}{Z_0} = \\frac{p(D \\mid \\mathcal{M}_1)}{p(D \\mid \\mathcal{M}_0)}\n$$\n此问题指定了一个线性高斯框架，其中模型对其参数是线性的，且似然和先验均为高斯分布。这种结构使得模型证据存在解析解。\n\n设$N$笔S因子测量的數據向量为 $\\mathbf{D} = [S_1, S_2, \\dots, S_N]^T$。模型预测是参数 $\\boldsymbol{\\theta}$ 的线性函数，表示为 $\\mathbf{M}(\\boldsymbol{\\theta}) = X\\boldsymbol{\\theta}$，其中 $X$ 是 $N \\times k$ 的设计矩阵，$k$ 是参数的数量。问题陈述测量误差是独立的高斯分布。因此，似然函数 $\\mathcal{L}(D \\mid \\boldsymbol{\\theta}) = \\mathcal{N}(\\mathbf{D} \\mid X\\boldsymbol{\\theta}, W)$，其中 $W = \\mathrm{diag}(\\sigma_1^2, \\dots, \\sigma_N^2)$ 是噪声协方差矩阵。参数的先验分布也是高斯的：$\\pi(\\boldsymbol{\\theta}) = \\mathcal{N}(\\boldsymbol{\\theta} \\mid \\boldsymbol{\\mu}_{\\text{pr}}, \\Sigma_{\\text{pr}})$。\n\n模型证据 $Z$ 的积分涉及这两个高斯分布的乘积，具有闭合形式的解。最终的对数边缘似然 $\\ln Z$ 由以下公式给出：\n$$\n\\ln Z = -\\frac{N}{2}\\ln(2\\pi) - \\frac{1}{2}\\ln(\\det W) + \\frac{1}{2}\\ln(\\det \\Sigma_{\\text{pr}}) + \\frac{1}{2}\\ln(\\det \\Sigma_{\\text{post}}) - \\frac{1}{2} \\left( \\mathbf{D}^T W^{-1} \\mathbf{D} + \\boldsymbol{\\mu}_{\\text{pr}}^T \\Sigma_{\\text{pr}}^{-1} \\boldsymbol{\\mu}_{\\text{pr}} - \\boldsymbol{\\mu}_{\\text{post}}^T \\Sigma_{\\text{post}}^{-1} \\boldsymbol{\\mu}_{\\text{post}} \\right)\n$$\n其中后验协方差 $\\Sigma_{\\text{post}}$ 和后验均值 $\\boldsymbol{\\mu}_{\\text{post}}$ 定义为：\n$$\n\\Sigma_{\\text{post}} = (\\Sigma_{\\text{pr}}^{-1} + X^T W^{-1} X)^{-1}\n$$\n$$\n\\boldsymbol{\\mu}_{\\text{post}} = \\Sigma_{\\text{post}} \\left( \\Sigma_{\\text{pr}}^{-1} \\boldsymbol{\\mu}_{\\text{pr}} + X^T W^{-1} \\mathbf{D} \\right)\n$$\n我们将把这个通用公式应用于模型 $\\mathcal{M}_0$ 和 $\\mathcal{M}_1$。\n\n对于模型 $\\mathcal{M}_0$（常数S因子），$k=1$，$\\boldsymbol{\\theta}_0 = [S_0]$，$X_0$ 是一个全1列向量，$\\boldsymbol{\\mu}_{\\text{pr},0} = [\\mu_0]$，$\\Sigma_{\\text{pr},0} = [\\sigma_{0,\\text{pr}}^2]$。\n对于模型 $\\mathcal{M}_1$（线性S因子），$k=2$，$\\boldsymbol{\\theta}_1 = [S_0, S_1]^T$，$X_1$ 是一个包含常数项和能量项的 $N \\times 2$ 矩阵，$\\boldsymbol{\\mu}_{\\text{pr},1} = [\\mu_0, 0]^T$，$\\Sigma_{\\text{pr},1} = \\mathrm{diag}(\\sigma_{0,\\text{pr}}^2, \\sigma_{1,\\text{pr}}^2)$。\n\n然后，贝叶斯因子 $K_{10}$ 计算如下：\n$$\nK_{10} = \\frac{Z_1}{Z_0} = \\exp(\\ln Z_1 - \\ln Z_0)\n$$\n以下是实现此计算的 Python 代码。\n```python\nimport numpy as np\n\ndef compute_log_evidence(D, X, W_inv, mu_pr, Sigma_pr_inv):\n    \"\"\"\n    Computes the log model evidence for a linear-Gaussian model.\n    \"\"\"\n    N, k = X.shape\n\n    # Log determinant of the noise covariance W. W_inv is diagonal.\n    log_det_W = -np.sum(np.log(np.diag(W_inv)))\n\n    # Log determinant of the prior inverse covariance\n    _sign, log_det_Sigma_pr_inv = np.linalg.slogdet(Sigma_pr_inv)\n\n    # Posterior inverse covariance\n    Sigma_post_inv = Sigma_pr_inv + X.T @ W_inv @ X\n\n    # Log determinant of the posterior inverse covariance\n    _sign, log_det_Sigma_post_inv = np.linalg.slogdet(Sigma_post_inv)\n\n    # Calculate the quadratic term involving the posterior mean efficiently\n    A = Sigma_pr_inv @ mu_pr + X.T @ W_inv @ D\n    quad_term_post = A.T @ np.linalg.inv(Sigma_post_inv) @ A\n    \n    # Full quadratic term in the exponent\n    quad_term = D.T @ W_inv @ D + mu_pr.T @ Sigma_pr_inv @ mu_pr - quad_term_post\n\n    log_Z = (\n        -N / 2 * np.log(2 * np.pi)\n        - 0.5 * log_det_W\n        + 0.5 * log_det_Sigma_pr_inv\n        - 0.5 * log_det_Sigma_post_inv\n        - 0.5 * quad_term\n    )\n    \n    return log_Z\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for all test cases.\n    \"\"\"\n    test_cases = [\n        # Case A\n        {\"E\": np.array([10.0, 20.0, 30.0, 40.0]), \"S\": np.array([19.6, 20.2, 19.8, 20.5]), \"sigma\": np.array([0.5, 0.5, 0.5, 0.5]), \"mu0\": 20.0, \"sigma0_pr\": 10.0, \"sigma1_pr\": 0.5},\n        # Case B\n        {\"E\": np.array([10.0, 20.0, 30.0, 40.0]), \"S\": np.array([19.6, 19.9, 20.6, 20.8]), \"sigma\": np.array([0.3, 0.3, 0.3, 0.3]), \"mu0\": 20.0, \"sigma0_pr\": 10.0, \"sigma1_pr\": 0.5},\n        # Case C\n        {\"E\": np.array([10.0, 30.0, 50.0]), \"S\": np.array([21.0, 17.5, 24.0]), \"sigma\": np.array([5.0, 5.0, 5.0]), \"mu0\": 20.0, \"sigma0_pr\": 50.0, \"sigma1_pr\": 5.0}\n    ]\n\n    results = []\n    for case in test_cases:\n        E, S, sigma = case[\"E\"], case[\"S\"], case[\"sigma\"]\n        mu0, sigma0_pr, sigma1_pr = case[\"mu0\"], case[\"sigma0_pr\"], case[\"sigma1_pr\"]\n        \n        N = len(E)\n        D = S\n        W_inv = np.diag(1.0 / sigma**2)\n\n        #--- Model M0 (constant S-factor) ---\n        X0 = np.ones((N, 1))\n        mu_pr0 = np.array([mu0])\n        Sigma_pr_inv0 = np.array([[1.0 / sigma0_pr**2]])\n        log_Z0 = compute_log_evidence(D, X0, W_inv, mu_pr0, Sigma_pr_inv0)\n\n        #--- Model M1 (linear S-factor) ---\n        X1 = np.vstack((np.ones(N), E)).T\n        mu_pr1 = np.array([mu0, 0.0])\n        Sigma_pr_inv1 = np.diag([1.0 / sigma0_pr**2, 1.0 / sigma1_pr**2])\n        log_Z1 = compute_log_evidence(D, X1, W_inv, mu_pr1, Sigma_pr_inv1)\n\n        #--- Bayes Factor K10 = Z1 / Z0 ---\n        K10 = np.exp(log_Z1 - log_Z0)\n        results.append(K10)\n\n    return results\n\n# This part would be run to generate the answer\n# results = solve()\n# print(f\"[{','.join(f'{r:.15f}' for r in results)}]\")\n```",
            "answer": "[0.076532288339893,3152.496030925232840,0.914992987595350]"
        }
    ]
}