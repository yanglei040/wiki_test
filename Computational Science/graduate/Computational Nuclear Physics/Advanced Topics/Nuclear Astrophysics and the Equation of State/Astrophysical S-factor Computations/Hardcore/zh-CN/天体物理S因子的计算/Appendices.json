{
    "hands_on_practices": [
        {
            "introduction": "天体物理S因子（$S(E)$）是将平滑变化的核物理效应从反应截面中分离出来的关键工具。本练习旨在通过一个基础计算，巩固您对$S(E)$因子与反应截面$\\sigma(E)$之间基本关系的理解，即$S(E) = \\sigma(E) E \\exp(2\\pi\\eta)$。通过将给定的$S(E)$值转换为国际单位制并计算相应的截面，您将能够熟练掌握这一核心概念并处理实际计算中的单位换算问题。",
            "id": "3542503",
            "problem": "在质心 (CM) 能量 $E = 100\\,\\mathrm{keV}$下，研究了质子与碳-12原子核之间的非共振带电粒子辐射俘获反应。在此能量下测得的天体物理 $S$ 因子为 $S(E) = 25\\,\\mathrm{keV\\cdot barn}$。质子和碳-12分别携带的电荷为 $Z_{1} = 1$ 和 $Z_{2} = 6$。假设采用非相对论性运动学，并且天体物理 $S$ 因子定义为从带电粒子截面中扣除已知的库仑势垒穿透因子和运动学 $1/E$ 标度后的平滑部分。使用 Sommerfeld 参数的非相对论性表达式、质心能量 $E$ 处的相对速度 $v$ 以及两体系统的约化质量 $\\mu$，确定在 $E=100\\,\\mathrm{keV}$ 时的反应截面 $\\sigma(E)$。\n\n使用以下常数和换算，所有单位均为国际单位制 (SI)：\n- 精细结构常数 $\\alpha = 7.297\\,352\\,5693\\times 10^{-3}$。\n- 光速 $c = 2.997\\,924\\,58\\times 10^{8}\\,\\mathrm{m/s}$。\n- 质子质量 $m_{p} = 1.672\\,621\\,92369\\times 10^{-27}\\,\\mathrm{kg}$。\n- 原子质量单位 $u = 1.660\\,539\\,06660\\times 10^{-27}\\,\\mathrm{kg}$；将碳-12核质量近似为 $m_{C} \\approx 12\\,u$。\n- $1\\,\\mathrm{eV} = 1.602\\,176\\,634\\times 10^{-19}\\,\\mathrm{J}$。\n- $1\\,\\mathrm{barn} = 1.0\\times 10^{-28}\\,\\mathrm{m^{2}}$。\n\n步骤：\n1. 将给定的 $S(E)$ 从 $\\mathrm{keV\\cdot barn}$ 换算为 $\\mathrm{J\\cdot m^{2}}$。\n2. 从第一性原理出发，使用两个电荷为 $Z_{1}$ 和 $Z_{2}$ 的原子核的非相对论性 Sommerfeld 参数 $\\eta$、相对速度 $v$ 与质心能量 $E$ 之间的关系，以及天体物理 $S$ 因子作为从截面中移除库仑势垒穿透和运动学 $1/E$ 标度的因子的定义，推导出一个允许您从 $S(E)$、$E$ 和 $\\eta$ 计算 $\\sigma(E)$ 的表达式。\n3. 根据以上参数，数值计算 $\\sigma(E)$。\n\n以平方米表示您的最终截面，并将答案四舍五入至四位有效数字。",
            "solution": "问题陈述已经过验证，被认为是有效的。它具有科学依据，问题提出得当且客观，包含了计算唯一且有意义解所需的所有必要信息。\n\n该问题要求在给定特定质心能量 $E$ 下的天体物理 $S$ 因子 $S(E)$ 的情况下，计算非共振带电粒子反应的反应截面 $\\sigma(E)$。这些量之间的关系是通过从截面中提出强的能量依赖性来定义的，这种依赖性主要来自两个来源：与德布罗意波长相关的 $1/E$ 运动学因子，以及库仑势垒穿透概率。\n\n天体物理 $S$ 因子的定义如下：\n$$\n\\sigma(E) = \\frac{S(E)}{E} \\exp(-2\\pi\\eta)\n$$\n其中 $\\eta$ 是无量纲的 Sommerfeld 参数。这个指数项是低能 s 波反应的 Gamow 因子的主导部分，它解释了两个带电原子核隧穿其静电排斥的概率。\n\n非相对论性 Sommerfeld 参数 $\\eta$ 定义为：\n$$\n\\eta = \\frac{Z_1 Z_2 e^2}{4\\pi\\epsilon_0 \\hbar v}\n$$\n其中 $Z_1$ 和 $Z_2$ 是相互作用原子核的电荷数，$e$ 是元电荷，$\\epsilon_0$ 是真空介电常数，$\\hbar$ 是约化普朗克常数，$v$ 是粒子的相对速度。使用精细结构常数 $\\alpha = \\frac{e^2}{4\\pi\\epsilon_0 \\hbar c}$，该表达式可以更方便地写为：\n$$\n\\eta = Z_1 Z_2 \\alpha \\frac{c}{v}\n$$\n相对速度 $v$ 通过动能的非相对论关系 $E = \\frac{1}{2}\\mu v^2$ 与质心能量 $E$ 相关，其中 $\\mu$ 是两体系统的约化质量。因此，$v = \\sqrt{\\frac{2E}{\\mu}}$。将此代入 $\\eta$ 的表达式中，得到：\n$$\n\\eta = Z_1 Z_2 \\alpha c \\sqrt{\\frac{\\mu}{2E}}\n$$\n现在，我们将按照要求，一步步进行计算。所有计算都将在国际单位制 (SI) 中进行。\n\n**步骤 1：将给定数量转换为 SI 单位**\n\n质心能量为 $E = 100\\,\\mathrm{keV}$：\n$$\nE = 100 \\times 10^3\\,\\mathrm{eV} \\times (1.602\\,176\\,634 \\times 10^{-19}\\,\\mathrm{J/eV}) = 1.602\\,176\\,634 \\times 10^{-14}\\,\\mathrm{J}\n$$\n天体物理 $S$ 因子为 $S(E) = 25\\,\\mathrm{keV\\cdot barn}$：\n$$\nS(E) = 25 \\times 10^3\\,\\mathrm{eV\\cdot barn} \\times (1.602\\,176\\,634 \\times 10^{-19}\\,\\mathrm{J/eV}) \\times (1.0 \\times 10^{-28}\\,\\mathrm{m^2/barn})\n$$\n$$\nS(E) = 4.005\\,441\\,585 \\times 10^{-43}\\,\\mathrm{J \\cdot m^2}\n$$\n\n**步骤 2：计算约化质量 $\\mu$**\n\n质子 ($m_p$) 和碳-12 ($m_C$) 系统的约化质量 $\\mu$ 由 $\\mu = \\frac{m_p m_C}{m_p + m_C}$ 给出。\n给定的质量是：\n$m_p = 1.672\\,621\\,92369 \\times 10^{-27}\\,\\mathrm{kg}$。\n$u = 1.660\\,539\\,06660 \\times 10^{-27}\\,\\mathrm{kg}$。\n我们将碳-12的质量近似为 $m_C \\approx 12 u$：\n$$\nm_C \\approx 12 \\times (1.660\\,539\\,06660 \\times 10^{-27}\\,\\mathrm{kg}) = 1.992\\,646\\,87992 \\times 10^{-26}\\,\\mathrm{kg}\n$$\n现在，我们计算约化质量：\n$$\n\\mu = \\frac{(1.672\\,621\\,92369 \\times 10^{-27}\\,\\mathrm{kg}) \\times (1.992\\,646\\,87992 \\times 10^{-26}\\,\\mathrm{kg})}{(1.672\\,621\\,92369 \\times 10^{-27}\\,\\mathrm{kg}) + (1.992\\,646\\,87992 \\times 10^{-26}\\,\\mathrm{kg})}\n$$\n$$\n\\mu = \\frac{3.332\\,350\\,00 \\times 10^{-53}\\,\\mathrm{kg^2}}{2.159\\,909\\,07 \\times 10^{-26}\\,\\mathrm{kg}} = 1.542\\,823\\,05 \\times 10^{-27}\\,\\mathrm{kg}\n$$\n\n**步骤 3：计算 Sommerfeld 参数 $\\eta$**\n\n我们使用公式 $\\eta = Z_1 Z_2 \\alpha c \\sqrt{\\frac{\\mu}{2E}}$。常数如下：\n电荷数：$Z_1 = 1$, $Z_2 = 6$。\n精细结构常数：$\\alpha = 7.297\\,352\\,5693 \\times 10^{-3}$。\n光速：$c = 2.997\\,924\\,58 \\times 10^{8}\\,\\mathrm{m/s}$。\n\n首先，我们计算平方根内的项：\n$$\n\\frac{\\mu}{2E} = \\frac{1.542\\,823\\,05 \\times 10^{-27}\\,\\mathrm{kg}}{2 \\times 1.602\\,176\\,634 \\times 10^{-14}\\,\\mathrm{J}} = 4.814\\,763\\,48 \\times 10^{-14}\\,\\mathrm{s^2/m^2}\n$$\n取平方根：\n$$\n\\sqrt{\\frac{\\mu}{2E}} = \\sqrt{4.814\\,763\\,48 \\times 10^{-14}\\,\\mathrm{s^2/m^2}} = 2.194\\,256\\,93 \\times 10^{-7}\\,\\mathrm{s/m}\n$$\n现在，我们计算 $\\eta$：\n$$\n\\eta = (1)(6) \\times (7.297\\,352\\,5693 \\times 10^{-3}) \\times (2.997\\,924\\,58 \\times 10^{8}\\,\\mathrm{m/s}) \\times (2.194\\,256\\,93 \\times 10^{-7}\\,\\mathrm{s/m})\n$$\n$$\n\\eta = 2.879\\,853\\,18\n$$\n\n**步骤 4：计算反应截面 $\\sigma(E)$**\n\n我们使用定义方程 $\\sigma(E) = \\frac{S(E)}{E} \\exp(-2\\pi\\eta)$。\n首先，我们计算指数项：\n$$\n2\\pi\\eta = 2\\pi \\times 2.879\\,853\\,18 = 18.094\\,536\\,7\n$$\n$$\n\\exp(-2\\pi\\eta) = \\exp(-18.094\\,536\\,7) = 1.385\\,510\\,5 \\times 10^{-8}\n$$\n计算前置因子 $\\frac{S(E)}{E}$ 的另一种方法是直接使用给定的单位：\n$$\n\\frac{S(E)}{E} = \\frac{25\\,\\mathrm{keV\\cdot barn}}{100\\,\\mathrm{keV}} = 0.25\\,\\mathrm{barn}\n$$\n转换为 SI 单位：\n$$\n0.25\\,\\mathrm{barn} = 0.25 \\times 1.0 \\times 10^{-28}\\,\\mathrm{m^2} = 2.5 \\times 10^{-29}\\,\\mathrm{m^2}\n$$\n现在，我们可以求出截面 $\\sigma(E)$：\n$$\n\\sigma(E) = (2.5 \\times 10^{-29}\\,\\mathrm{m^2}) \\times (1.385\\,510\\,5 \\times 10^{-8})\n$$\n$$\n\\sigma(E) = 3.463\\,776 \\times 10^{-37}\\,\\mathrm{m^2}\n$$\n最后，按照指示将结果四舍五入到四位有效数字：\n$$\n\\sigma(E) \\approx 3.464 \\times 10^{-37}\\,\\mathrm{m^2}\n$$",
            "answer": "$$\n\\boxed{3.464 \\times 10^{-37}}\n$$"
        },
        {
            "introduction": "在恒星环境中，单个能量下的反应截面$\\sigma(E)$不足以描述整体反应速率，我们需要计算其在麦克斯韦-玻尔兹曼能量分布下的热平均值，即反应率$\\langle \\sigma v \\rangle$。本练习将引导您从基本定义出发，推导反应率的积分表达式，并应用鞍点近似法（saddle-point approximation）得到其解析近似解，这一方法揭示了关键的“伽莫夫峰”（Gamow peak）现象。通过将解析结果与数值积分进行比较，您将深入理解天体物理反应率的计算核心及其高效近似方法。",
            "id": "3542550",
            "problem": "考虑两个质子之间的非共振带电粒子聚变反应，其电荷分别为 $Z_1 = 1$ 和 $Z_2 = 1$，约化质量为 $\\mu = m_p/2$，其中 $m_p$ 是质子质量。天体物理 $S$ 因子假定为常数，$S(E) = S_0$。微观截面由天体物理 $S$ 因子关系式 $ \\sigma(E) = \\dfrac{S(E)}{E} \\exp(-2 \\pi \\eta) $ 定义，其中 Sommerfeld 参数为 $\\eta = \\dfrac{\\alpha Z_1 Z_2 c}{v}$，$v = \\sqrt{2E/\\mu}$ 是质心动能为 $E$ 时的相对速度。此处 $\\alpha$ 是精细结构常数，$c$ 是光速。每对粒子的麦克斯韦平均反应率是 $ \\langle \\sigma v \\rangle = \\int \\sigma(v)\\, v\\, f_{\\text{MB}}(v;T)\\, d^3 v $，其中 $f_{\\text{MB}}(v;T)$ 是温度为 $T$ 时的麦克斯韦-玻尔兹曼分布。阿伏伽德罗常数为 $N_A$。您将使用上述定义，在非共振、非屏蔽极限下处理反应 $p+p \\rightarrow d + e^+ + \\nu_e$。\n\n您的任务是：\n\n- 仅从上面为 $ \\sigma(E) $、$\\eta$、$v(E)$ 和麦克斯韦-玻尔兹曼分布提供的定义出发（而不是从任何预先打包的“快捷”速率公式），为具有恒定 $S(E)=S_0$ 的非共振带电粒子推导出一个适用于 $ \\langle \\sigma v \\rangle $ 的关于 $E$ 的一维积分。然后，对该积分应用最速下降法（鞍点/拉普拉斯近似），在被积函数呈现 Gamow 峰时，获得 $ \\langle \\sigma v \\rangle $ 的解析渐近近似。您推导的近似值必须完全用 $S_0$、$\\mu$、$k_B$、$T$、$\\alpha$、$c$ 以及起始定义中出现的基本常数来表示。不要引入任何经验拟合公式；推导必须遵循所提供的基本原理。\n\n- 为 $N_A \\langle \\sigma v \\rangle$ 实现两种计算：\n  1. 对您推导的 $E$ 积分进行数值评估，在国际单位制（SI）中执行，以得出单位为 $\\mathrm{m^3\\,s^{-1}}$ 的 $ \\langle \\sigma v \\rangle $，然后乘以 $N_A$ 得到单位为 $\\mathrm{m^3\\,mol^{-1}\\,s^{-1}}$ 的 $N_A \\langle \\sigma v \\rangle$，最后转换为 $\\mathrm{cm^3\\,mol^{-1}\\,s^{-1}}$。\n  2. 对相同量进行鞍点（最速下降）近似的评估，同样得出单位为 $\\mathrm{cm^3\\,mol^{-1}\\,s^{-1}}$ 的 $N_A \\langle \\sigma v \\rangle$。\n\n- 对于每个指定的温度，计算鞍点近似相对于数值积分的相对误差，定义为 $ \\delta = \\dfrac{(N_A \\langle \\sigma v \\rangle)_{\\text{saddle}} - (N_A \\langle \\sigma v \\rangle)_{\\text{numeric}}}{(N_A \\langle \\sigma v \\rangle)_{\\text{numeric}}} $。将 $\\delta$ 报告为无量纲十进制数（而非百分比）。\n\n使用以下物理常数和单位约定：\n- $N_A = 6.02214076 \\times 10^{23}\\ \\mathrm{mol^{-1}}$。\n- $\\alpha = 7.2973525693 \\times 10^{-3}$。\n- $c = 2.99792458 \\times 10^{8}\\ \\mathrm{m\\,s^{-1}}$。\n- $k_B = 1.380649 \\times 10^{-23}\\ \\mathrm{J\\,K^{-1}}$。\n- $m_p = 1.67262192369 \\times 10^{-27}\\ \\mathrm{kg}$，因此对于 $p+p$ 反应，$\\mu = m_p/2$。\n- 采用 $S_0 = 4.01 \\times 10^{-22}\\ \\mathrm{keV\\cdot b}$ 作为与温度无关的常数。使用 $1\\ \\mathrm{eV} = 1.602176634 \\times 10^{-19}\\ \\mathrm{J}$ 和 $1\\ \\mathrm{b} = 10^{-28}\\ \\mathrm{m^2}$ 将其转换为国际单位制。确保在您的积分中，$S_0$ 的单位是 $\\mathrm{J\\,m^2}$。\n\n实现您的程序，以评估以下温度测试组（以开尔文表示，均为正实数）的相对误差 $\\delta$：\n- $T_1 = 5.0 \\times 10^{6}\\ \\mathrm{K}$（较低，强隧穿抑制），\n- $T_2 = 1.5 \\times 10^{7}\\ \\mathrm{K}$（太阳核心尺度），\n- $T_3 = 3.0 \\times 10^{7}\\ \\mathrm{K}$（较高，较温和的隧穿抑制），\n- $T_4 = 1.0 \\times 10^{8}\\ \\mathrm{K}$（此通道的常数 $S$ 适用性边缘，仍为非共振）。\n\n数值要求和指导：\n- 使用从定义中推导的一维形式，直接对能量 $E \\in [0,\\infty)$ 进行数值积分。被积函数包含麦克斯韦-玻尔兹曼因子和 Gamow 因子的指数；当 $E \\to 0^+$ 和 $E \\to \\infty$ 时，它是有限的且趋于零。请确保在 $E=0$ 附近的数值稳定性。\n- 所有中间计算必须使用国际单位制（SI），以便在乘以 $N_A$ 并根据报告和相对误差的需要转换为 $\\mathrm{cm^3\\,mol^{-1}\\,s^{-1}}$ 之前，$ \\langle \\sigma v \\rangle $ 的单位是 $\\mathrm{m^3\\,s^{-1}}$。然而，最终要求的答案是 $\\delta$ 值的无量纲十进制数列表。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，“[$\\delta_1,\\delta_2,\\delta_3,\\delta_4$]”），其中各项按上面列出的顺序对应于各个温度。每个列表元素必须是浮点数。不应打印任何附加文本。",
            "solution": "### 推导与求解方法\n\n主要目标是计算每对粒子的麦克斯韦平均反应率 $\\langle \\sigma v \\rangle$，并将其精确的数值与通过最速下降法推导出的解析近似值进行比较。\n\n**1. $\\langle \\sigma v \\rangle$ 的一维能量积分推导**\n\n麦克斯韦平均反应率由相对速度分布的积分给出：\n$$ \\langle \\sigma v \\rangle = \\int_0^\\infty \\sigma(v) v f_{\\text{MB}}(v; T) 4\\pi v^2 dv $$\n其中，相对速度 $v$ 的麦克斯韦-玻尔兹曼分布为：\n$$ f_{\\text{MB}}(v; T) = \\left(\\frac{\\mu}{2\\pi k_B T}\\right)^{3/2} \\exp\\left(-\\frac{\\mu v^2}{2 k_B T}\\right) $$\n将两者结合得到：\n$$ \\langle \\sigma v \\rangle = 4\\pi \\left(\\frac{\\mu}{2\\pi k_B T}\\right)^{3/2} \\int_0^\\infty \\sigma(v) \\exp\\left(-\\frac{\\mu v^2}{2 k_B T}\\right) v^3 dv $$\n我们将积分变量从相对速度 $v$ 更改为质心能量 $E = \\frac{1}{2}\\mu v^2$。微分为 $dE = \\mu v dv$，所以 $v dv = dE/\\mu$。$v^3 dv$ 项变为 $v^2 (v dv) = (\\frac{2E}{\\mu})(\\frac{dE}{\\mu}) = \\frac{2E}{\\mu^2} dE$。指数项变为 $\\exp(-E/k_B T)$。将这些代入积分中：\n$$ \\langle \\sigma v \\rangle = 4\\pi \\left(\\frac{\\mu}{2\\pi k_B T}\\right)^{3/2} \\int_0^\\infty \\sigma(E) \\exp\\left(-\\frac{E}{k_B T}\\right) \\frac{2E}{\\mu^2} dE $$\n简化前置因子：\n$$ 4\\pi \\frac{\\mu^{3/2}}{(2\\pi)^{3/2} (k_B T)^{3/2}} \\frac{2}{\\mu^2} = \\frac{8\\pi}{2\\pi\\sqrt{2\\pi}\\mu^{1/2}(k_B T)^{3/2}} = \\sqrt{\\frac{8}{\\pi\\mu}} \\frac{1}{(k_B T)^{3/2}} $$\n这得到了作为能量积分的反应率：\n$$ \\langle \\sigma v \\rangle = \\sqrt{\\frac{8}{\\pi\\mu}} \\frac{1}{(k_B T)^{3/2}} \\int_0^\\infty \\sigma(E) E \\exp\\left(-\\frac{E}{k_B T}\\right) dE $$\n现在，我们代入截面的定义 $\\sigma(E) = \\frac{S(E)}{E} \\exp(-2\\pi\\eta)$，其中 S 因子为常数 $S(E) = S_0$。Sommerfeld 参数 $\\eta$ 是能量的函数：\n$$ 2\\pi\\eta = 2\\pi \\frac{\\alpha Z_1 Z_2 c}{v} = 2\\pi \\alpha Z_1 Z_2 c \\sqrt{\\frac{\\mu}{2E}} = \\frac{b}{\\sqrt{E}} $$\n这里我们定义常数 $b \\equiv 2\\pi \\alpha Z_1 Z_2 c \\sqrt{\\mu/2}$。\n截面为 $\\sigma(E) = \\frac{S_0}{E} \\exp(-b/\\sqrt{E})$。将其代入 $\\langle \\sigma v \\rangle$ 的积分中，$E$ 因子被消去：\n$$ \\langle \\sigma v \\rangle = \\sqrt{\\frac{8}{\\pi\\mu}} \\frac{S_0}{(k_B T)^{3/2}} \\int_0^\\infty \\exp\\left(-\\frac{E}{k_B T} - \\frac{b}{\\sqrt{E}}\\right) dE $$\n这就是将要进行数值计算的关于能量 $E$ 的一维积分。\n\n**2. $\\langle \\sigma v \\rangle$ 的鞍点近似**\n\n积分 $I = \\int_0^\\infty \\exp(f(E)) dE$，其中 $f(E) = -E/(k_B T) - b/\\sqrt{E}$，其值主要由 $f(E)$ 最大值附近的区域决定。这个峰被称为 Gamow 峰。我们通过将 $f(E)$ 的导数设为零来找到峰值能量 $E_0$：\n$$ f'(E) = -\\frac{1}{k_B T} + \\frac{b}{2} E^{-3/2} $$\n设 $f'(E_0) = 0$ 得到峰值能量：\n$$ \\frac{1}{k_B T} = \\frac{b}{2} E_0^{-3/2} \\implies E_0 = \\left(\\frac{b k_B T}{2}\\right)^{2/3} $$\n最速下降法（或鞍点近似）在 $E_0$ 附近用抛物线（即用高斯函数近似被积函数）来近似 $f(E)$：\n$$ f(E) \\approx f(E_0) + \\frac{1}{2} f''(E_0) (E-E_0)^2 $$\n二阶导数是 $f''(E) = -\\frac{3b}{4} E^{-5/2}$。在 $E_0$ 处，它是 $f''(E_0) = -\\frac{3b}{4} E_0^{-5/2}$。由于 $f''(E_0)  0$，$E_0$ 确实是一个最大值。\n然后，该积分被近似为一个高斯积分：\n$$ I \\approx \\int_{-\\infty}^{\\infty} \\exp\\left( f(E_0) + \\frac{1}{2} f''(E_0) (E-E_0)^2 \\right) dE = \\exp(f(E_0)) \\sqrt{\\frac{-2\\pi}{f''(E_0)}} $$\n让我们来计算这些项。首先是 $f(E_0)$:\n$$ f(E_0) = -\\frac{E_0}{k_B T} - \\frac{b}{\\sqrt{E_0}} $$\n利用峰值条件中的 $1/(k_B T) = b/(2E_0^{3/2})$，我们得到 $-E_0/(k_B T) = -E_0 \\cdot b/(2E_0^{3/2}) = -b/(2\\sqrt{E_0})$。\n因此，$f(E_0) = -b/(2\\sqrt{E_0}) - b/\\sqrt{E_0} = -3b/(2\\sqrt{E_0})$。\n这可以用一个单一参数 $\\tau$ 来表示：\n$$ f(E_0) = -\\frac{3E_0}{k_B T} \\equiv -\\tau $$\n参数 $\\tau = 3E_0/(k_B T)$ 是一个关键的无量纲量。我们可以用基本常数来表示它：\n$$ \\tau = \\frac{3}{k_B T} \\left(\\frac{b k_B T}{2}\\right)^{2/3} = 3 \\left(\\frac{b^2}{4k_B T}\\right)^{1/3} = 3 \\left(\\frac{(2\\pi \\alpha Z_1 Z_2 c)^2 (\\mu/2)}{4k_B T}\\right)^{1/3} = 3 \\left(\\frac{\\pi^2 \\alpha^2 Z_1^2 Z_2^2 c^2 \\mu}{2k_B T}\\right)^{1/3} $$\n接下来，我们计算宽度项 $\\sqrt{-2\\pi/f''(E_0)}$:\n$$ \\sqrt{\\frac{-2\\pi}{-3b/(4E_0^{5/2})}} = \\sqrt{\\frac{8\\pi E_0^{5/2}}{3b}} $$\n代入 $b = 2E_0^{3/2}/(k_B T)$，这变为 $\\sqrt{\\frac{8\\pi E_0^{5/2}}{3 \\cdot 2E_0^{3/2}/(k_B T)}} = \\sqrt{\\frac{4\\pi E_0 k_B T}{3}}$。\n积分的近似值为 $I \\approx \\exp(-\\tau) \\sqrt{\\frac{4\\pi E_0 k_B T}{3}}$。\n将此代入 $\\langle \\sigma v \\rangle$ 的表达式中：\n$$ \\langle \\sigma v \\rangle_{\\text{saddle}} \\approx \\sqrt{\\frac{8}{\\pi\\mu}} \\frac{S_0}{(k_B T)^{3/2}} \\exp(-\\tau) \\sqrt{\\frac{4\\pi E_0 k_B T}{3}} $$\n$$ \\langle \\sigma v \\rangle_{\\text{saddle}} = S_0 \\sqrt{\\frac{32 E_0}{3\\mu (k_B T)^2}} \\exp(-\\tau) = \\frac{4S_0}{k_B T}\\sqrt{\\frac{2E_0}{3\\mu}} \\exp(-\\tau) $$\n为了将其表示为涉及 $\\tau$ 的标准形式，我们使用 $k_B T = 27b^2/(4\\tau^3)$ 和 $b = \\pi\\alpha Z_1 Z_2 c \\sqrt{2\\mu}$。经过代数简化，得到：\n$$ \\langle \\sigma v \\rangle_{\\text{saddle}} = \\frac{8 S_0}{9\\sqrt{3} \\pi \\alpha Z_1 Z_2 c \\mu} \\tau^2 e^{-\\tau} $$\n这是将要实现的最终解析近似。对于 $p+p$ 反应，$Z_1 = Z_2 = 1$。\n\n**3. 数值实现**\n\n该解法将使用 `numpy` 和 `scipy` 库在 Python 中实现。\n- 所有物理常数都以国际单位制（SI）定义。S 因子 $S_0$ 从 $\\mathrm{keV\\,b}$ 转换为 $\\mathrm{J\\,m^2}$。\n- 对于测试组中的每个温度 $T$：\n    1. **数值积分**：积分 $I = \\int_0^\\infty \\exp(-E/(k_B T) - b/\\sqrt{E}) dE$ 使用 `scipy.integrate.quad` 计算。使用推导出的前置因子组合成完整的速率 $\\langle \\sigma v \\rangle_{\\text{numeric}}$。\n    2. **鞍点评估**：为给定的温度 $T$ 计算参数 $\\tau$。然后使用推导出的解析公式计算速率 $\\langle \\sigma v \\rangle_{\\text{saddle}}$。\n    3. **相对误差**：相对误差 $\\delta$ 计算为 $\\delta = (\\langle \\sigma v \\rangle_{\\text{saddle}} - \\langle \\sigma v \\rangle_{\\text{numeric}}) / \\langle \\sigma v \\rangle_{\\text{numeric}}$。由于因子 $N_A$ 和从 $\\mathrm{m^3}$ 到 $\\mathrm{cm^3}$ 的单位转换同时出现在分子和分母中，它们会相互抵消，因此可以直接从 $\\langle \\sigma v \\rangle$ 的国际单位制结果计算误差。\n\n对所有指定的温度重复此过程，收集并打印生成的 $\\delta$ 值。",
            "answer": "```python\nimport numpy as np\nfrom scipy import integrate\n\ndef solve():\n    \"\"\"\n    Derives and computes the proton-proton reaction rate using numerical integration\n    and the saddle-point approximation, then calculates the relative error.\n    \"\"\"\n\n    # Physical constants in SI units\n    Z1 = 1.0\n    Z2 = 1.0\n    NA = 6.02214076e23  # mol^-1\n    ALPHA = 7.2973525693e-3\n    C = 2.99792458e8  # m/s\n    KB = 1.380649e-23  # J/K\n    M_P = 1.67262192369e-27  # kg\n    MU = M_P / 2.0  # Reduced mass for p-p\n\n    # S-factor conversion to SI units (J m^2)\n    S0_KEV_B = 4.01e-22  # keV b\n    EV_TO_J = 1.602176634e-19\n    KEV_TO_J = EV_TO_J * 1e3\n    B_TO_M2 = 1e-28\n    S0_SI = S0_KEV_B * KEV_TO_J * B_TO_M2\n\n    # Test suite of temperatures in Kelvin\n    temperatures = [\n        5.0e6,\n        1.5e7,\n        3.0e7,\n        1.0e8,\n    ]\n\n    results = []\n\n    for T in temperatures:\n        # --- 1. Numerical Integration Method ---\n\n        # Constant b in the Gamow factor exp(-b/sqrt(E))\n        b = 2.0 * np.pi * ALPHA * Z1 * Z2 * C * np.sqrt(MU / 2.0)\n\n        # Integrand for the reaction rate integral\n        def integrand(E):\n            # The term E/(KB*T) can be large, but E is positive.\n            # The term b/sqrt(E) can lead to division by zero at E=0.\n            # However, exp(-inf) is 0, which is the correct limit.\n            # We handle E=0 explicitly to avoid runtime warnings.\n            if E = 0:\n                return 0.0\n            \n            exponent = -E / (KB * T) - b / np.sqrt(E)\n            return np.exp(exponent)\n\n        # Perform the numerical integration from 0 to infinity\n        integral_val, _ = integrate.quad(integrand, 0, np.inf)\n\n        # Assemble the full rate\n        prefactor_numeric = np.sqrt(8.0 / (np.pi * MU)) * S0_SI / (KB * T)**1.5\n        rate_numeric = prefactor_numeric * integral_val\n        \n        # --- 2. Saddle-point Approximation ---\n\n        # Calculate tau\n        tau_term = (np.pi**2 * ALPHA**2 * Z1**2 * Z2**2 * C**2 * MU) / (2.0 * KB * T)\n        tau = 3.0 * (tau_term)**(1.0/3.0)\n        \n        # Use the standard textbook formula for the saddle-point rate\n        prefactor_saddle = (8.0 * S0_SI) / (9.0 * np.sqrt(3.0) * np.pi * ALPHA * Z1 * Z2 * C * MU)\n        rate_saddle = prefactor_saddle * tau**2 * np.exp(-tau)\n        \n        # --- 3. Relative Error ---\n        \n        if rate_numeric == 0:\n            relative_error = 0.0 # Should not happen for T > 0\n        else:\n            relative_error = (rate_saddle - rate_numeric) / rate_numeric\n        \n        results.append(relative_error)\n\n    # Format the output as a comma-separated list in brackets\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "理论分析和实验数据表明，天体物理$S(E)$因子并非恒定不变，其能量依赖性对反应率的计算至关重要，特别是在需要将数据外插到恒星燃烧能量区域时。本练习模拟了一个真实的研究场景，您将使用一个受库仑修正有效力程理论启发的复杂模型（包含多项式和对数项）来拟合带噪声的模拟数据。通过执行有界约束的最小二乘法拟合，您将实践如何从实验数据中提取模型参数，并评估模型向零能外插的稳定性和准确性，这是核天体物理中的一项核心技能。",
            "id": "3542491",
            "problem": "考虑带电粒子辐射俘获反应 $^{12}\\mathrm{C}(\\alpha,\\gamma)^{16}\\mathrm{O}$ 及其作为质心能量 $E$ 函数的天体物理 $S$ 因子 $S(E)$。天体物理 $S$ 因子定义为 $S(E) = \\sigma(E)\\,E\\,\\exp(2\\pi\\eta)$，其中 $\\sigma(E)$ 是反应截面，$\\eta$ 是对应电荷 $Z_1$ 和 $Z_2$、折合质量 $\\mu$ 以及相对速度 $v$ 的索末菲参数。针对带电粒子的库仑修正有效力程理论 (CM-ERT) 预测，在阈值附近存在一个非解析贡献，该贡献通过库仑函数在可观测量中引入了对数能量依赖性。受此启发，假设在足够接近阈值且远离窄共振的情况下，$S(E)$ 可由一个约束模型近似，该模型由一个 $E$ 的多项式和一个在 $E=0$ 时消失的对数项组成：\n$$\nS(E) = a_0 + a_1 E + a_2 E^2 + c\\,E\\ln\\left(\\frac{E}{E_0}\\right),\n$$\n其中 $E_0$ 是一个固定的能量标度，用于使对数项无量纲化。约束条件为 $a_0 \\ge 0$ 和 $a_1 \\ge 0$，以确保阈值是一个有限的非负值，且初始斜率为非负。参数 $a_2$ 和 $c$ 不受约束。所有对数均为自然对数。单位必须保持一致：$E$ 的单位是兆电子伏 (MeV)，$S(E)$ 的单位是千电子伏·靶 (keV·b)。阈值满足 $S(0) = a_0$，因为 $\\lim_{E\\to 0^+} E\\ln(E/E_0) = 0$。\n\n您的任务是实现一个程序，该程序基于上述 $S(E)$ 模型为三个不同的测试用例（每个用例具有不同的能量网格、噪声水平和真实参数）生成含噪声的模拟数据，执行有界约束的线性最小二乘拟合以从含噪声的数据中恢复参数 $(a_0,a_1,a_2,c)$，并将拟合模型外推至阈值。具体来说：\n\n1. 使用固定的能量标度 $E_0 = 1.0\\,\\mathrm{MeV}$。\n2. 对每个测试用例，在闭区间 $[E_{\\min},E_{\\max}]$ 上创建一个能量网格 $\\{E_i\\}$，使用模型和用例特定的真实参数计算 $S_{\\text{true}}(E_i)$，然后添加独立的、均值为零、标准差为 $\\sigma = f \\cdot \\overline{S}$ 的高斯噪声，其中 $f$ 是用例特定的分数噪声水平，$\\overline{S}$ 是 $S_{\\text{true}}(E_i)$ 在网格上的平均值。含噪声的数据为 $S_{\\text{noisy}}(E_i) = S_{\\text{true}}(E_i) + \\mathcal{N}(0,\\sigma^2)$。\n3. 构建设计矩阵，其列为 $\\left[1,\\,E_i,\\,E_i^2,\\,E_i \\ln(E_i/E_0)\\right]$，并求解关于 $(a_0,a_1,a_2,c)$ 的有界约束线性最小二乘问题，其边界条件为 $a_0 \\ge 0$ 和 $a_1 \\ge 0$（即，下界为 $[0,0,-\\infty,-\\infty]$，上界为 $[\\infty,\\infty,\\infty,\\infty]$）。\n4. 通过报告拟合参数得到的 $S(0)$（其值等于拟合的 $a_0$）来外推至阈值。\n\n所有报告的 $S(0)$ 值的单位必须是千电子伏·靶 (keV·b)。能量的单位必须是兆电子伏 (MeV)。角度不出现。通过比值 $E/E_0$，对数项是无量纲的。\n\n测试套件：\n- 用例 A（一般场景）：$E_{\\min}=0.05\\,\\mathrm{MeV}$，$E_{\\max}=1.5\\,\\mathrm{MeV}$，$N=60$ 个均匀间隔的点，噪声分数 $f=0.03$，真实参数 $(a_0,a_1,a_2,c) = (170.0,\\,60.0,\\,-10.0,\\,-25.0)$，单位为 $(\\mathrm{keV\\cdot b},\\,\\mathrm{keV\\cdot b/MeV},\\,\\mathrm{keV\\cdot b/MeV^2},\\,\\mathrm{keV\\cdot b/MeV})$。\n- 用例 B（近阈值覆盖）：$E_{\\min}=0.005\\,\\mathrm{MeV}$，$E_{\\max}=0.3\\,\\mathrm{MeV}$，$N=80$ 个均匀间隔的点，噪声分数 $f=0.01$，真实参数 $(a_0,a_1,a_2,c) = (170.0,\\,50.0,\\,-8.0,\\,-35.0)$，单位同上。\n- 用例 C（高噪声压力测试）：$E_{\\min}=0.05\\,\\mathrm{MeV}$，$E_{\\max}=0.8\\,\\mathrm{MeV}$，$N=40$ 个均匀间隔的点，噪声分数 $f=0.10$，真实参数 $(a_0,a_1,a_2,c) = (170.0,\\,40.0,\\,-5.0,\\,-20.0)$，单位同上。\n\n为保证可复现性，请对三个用例分别使用独立的固定伪随机种子 $42$、$31415$ 和 $2718$。您的程序必须输出单一行，其中包含三个外推的阈值 $[S_A(0),S_B(0),S_C(0)]$，单位为千电子伏·靶 (keV·b)，形式为方括号括起来的逗号分隔列表，其中 $S_X(0)$ 是用例 $X\\in\\{A,B,C\\}$ 的拟合阈值。\n\n您的程序必须是一个完整的、可运行的 Python 脚本，无需任何用户输入、外部文件或网络访问，并且必须严格遵守指定的库和版本。最终输出格式必须与上述描述完全一致，为单一行。",
            "solution": "该问题要求实现一个数值程序，以分析 $^{12}\\mathrm{C}(\\alpha,\\gamma)^{16}\\mathrm{O}$ 反应的天体物理S因子 $S(E)$ 的一个特定模型。这包括基于该模型为三个不同的测试用例生成含噪声的合成数据，执行有界约束的线性最小二乘拟合以恢复模型参数，并将拟合模型外推至零能量（$E=0$）以确定阈值 $S(0)$。\n\n天体物理S因子由以下函数建模：\n$$\nS(E) = a_0 + a_1 E + a_2 E^2 + c\\,E\\ln\\left(\\frac{E}{E_0}\\right)\n$$\n其中 $E$ 是质心能量，单位为 MeV，$S(E)$ 的单位为 keV$\\cdot$b。能量标度固定为 $E_0 = 1.0\\,\\mathrm{MeV}$。模型参数是系数 $(a_0, a_1, a_2, c)$，它们受到物理约束 $a_0 \\ge 0$ 和 $a_1 \\ge 0$ 的限制。S因子在阈值（$E=0$）处的值由 $S(0)=a_0$ 给出，因为 $\\lim_{E\\to 0^+} E\\ln(E/E_0) = 0$。\n\n任务的核心是从一组 $N$ 个含噪声的数据点 $(E_i, S_{\\text{noisy},i})$ 中估计参数向量 $\\mathbf{p} = [a_0, a_1, a_2, c]^T$。该模型对其参数是线性的。这使我们能够将问题表述为一个线性系统 $\\mathbf{S}_{\\text{noisy}} \\approx \\mathbf{A}\\mathbf{p}$，其中 $\\mathbf{S}_{\\text{noisy}}$ 是 $N$ 个观测到的S因子值的向量，$\\mathbf{A}$ 是 $N \\times 4$ 的设计矩阵。设计矩阵的第 $i$ 行（对应于能量 $E_i$）是：\n$$\n\\mathbf{A}_i = \\left[ 1, E_i, E_i^2, E_i\\ln\\left(\\frac{E_i}{E_0}\\right) \\right]\n$$\n目标是找到参数向量 $\\mathbf{p}$，使其最小化残差平方和，即残差向量的欧几里得范数的平方 $\\|\\mathbf{S}_{\\text{noisy}} - \\mathbf{A}\\mathbf{p}\\|_2^2$。\n\n由于存在约束条件 $a_0 \\ge 0$ 和 $a_1 \\ge 0$，这不是一个简单的最小二乘问题，而是一个有界约束的线性最小二乘问题。我们寻求：\n$$\n\\underset{\\mathbf{p}}{\\text{最小化}} \\quad \\|\\mathbf{S}_{\\text{noisy}} - \\mathbf{A}\\mathbf{p}\\|_2^2 \\\\\n\\text{约束条件为} \\quad \\mathbf{lb} \\le \\mathbf{p} \\le \\mathbf{ub}\n$$\n其中参数向量 $\\mathbf{p}$ 的下界和上界分别为 $\\mathbf{lb} = [0, 0, -\\infty, -\\infty]^T$ 和 $\\mathbf{ub} = [\\infty, \\infty, \\infty, \\infty]^T$。这个问题可以使用专门的数值优化算法进行稳健求解。SciPy 库中的 `scipy.optimize.lsq_linear` 函数就是为此目的设计的。\n\n问题中指定的三个测试用例的每一个都遵循以下步骤：\n\n1.  **数据生成**：对于每个用例，我们首先定义参数：能量区间 $[E_{\\min}, E_{\\max}]$、数据点数 $N$、分数噪声水平 $f$、真实参数值 $(a_{0,\\text{true}}, a_{1,\\text{true}}, a_{2,\\text{true}}, c_{\\text{true}})$ 以及一个用于确保可复现性的特定伪随机数生成器种子。\n    - 在 $[E_{\\min}, E_{\\max}]$ 内使用均匀间隔创建一个能量网格 $\\{E_i\\}_{i=1}^N$。\n    - 使用模型方程和真实参数计算真实的S因子值 $S_{\\text{true}}(E_i)$。\n    - 计算这些真实值的平均值 $\\overline{S} = \\frac{1}{N}\\sum_{i=1}^N S_{\\text{true}}(E_i)$。\n    - 噪声的标准差设置为 $\\sigma = f \\cdot \\overline{S}$。\n    - 从正态分布 $\\mathcal{N}(0, \\sigma^2)$ 中抽取的噪声项 $\\delta_i$ 被添加到每个真实的S因子值上，以生成合成的含噪声数据：$S_{\\text{noisy}}(E_i) = S_{\\text{true}}(E_i) + \\delta_i$。\n\n2.  **模型拟合与外推**：\n    - 从能量网格 $\\{E_i\\}$ 构建 $N \\times 4$ 的设计矩阵 $\\mathbf{A}$。\n    - 使用设计矩阵 $\\mathbf{A}$、含噪声的数据向量 $\\mathbf{S}_{\\text{noisy}}$ 以及边界 $([0, 0, -\\infty, -\\infty], [\\infty, \\infty, \\infty, \\infty])$ 来调用 `scipy.optimize.lsq_linear` 函数。\n    - 该函数返回拟合的参数向量 $\\mathbf{p}_{\\text{fit}} = [a_{0,\\text{fit}}, a_{1,\\text{fit}}, a_{2,\\text{fit}}, c_{\\text{fit}}]^T$。\n    - 在阈值处外推的S因子 $S(0)$ 由该向量的第一个分量 $a_{0,\\text{fit}}$ 给出。此值为该测试用例的结果。\n\n对所有三个测试用例重复这整个过程，并将得到的拟合阈值 $S_A(0)$、$S_B(0)$ 和 $S_C(0)$ 收集并格式化为所需的输出字符串。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import lsq_linear\n\ndef solve():\n    \"\"\"\n    Generates noisy S-factor data for three test cases, performs a bound-constrained\n    linear least-squares fit to recover model parameters, and reports the extrapolated\n    S-factor at zero energy.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"name\": \"A\",\n            \"E_min\": 0.05,\n            \"E_max\": 1.5,\n            \"N\": 60,\n            \"f\": 0.03,\n            \"true_params\": (170.0, 60.0, -10.0, -25.0),\n            \"seed\": 42\n        },\n        {\n            \"name\": \"B\",\n            \"E_min\": 0.005,\n            \"E_max\": 0.3,\n            \"N\": 80,\n            \"f\": 0.01,\n            \"true_params\": (170.0, 50.0, -8.0, -35.0),\n            \"seed\": 31415\n        },\n        {\n            \"name\": \"C\",\n            \"E_min\": 0.05,\n            \"E_max\": 0.8,\n            \"N\": 40,\n            \"f\": 0.10,\n            \"true_params\": (170.0, 40.0, -5.0, -20.0),\n            \"seed\": 2718\n        }\n    ]\n\n    E0 = 1.0  # Fixed energy scale in MeV\n    results = []\n\n    for case in test_cases:\n        # Initialize pseudorandom number generator for reproducibility\n        rng = np.random.default_rng(case[\"seed\"])\n\n        # 1. Data Generation\n        # Create energy grid\n        E = np.linspace(case[\"E_min\"], case[\"E_max\"], case[\"N\"])\n\n        # Unpack true parameters\n        a0_true, a1_true, a2_true, c_true = case[\"true_params\"]\n\n        # Compute true S-factor values using the model\n        S_true = a0_true + a1_true * E + a2_true * E**2 + c_true * E * np.log(E / E0)\n\n        # Generate Gaussian noise\n        S_mean = np.mean(S_true)\n        sigma = case[\"f\"] * S_mean\n        noise = rng.normal(loc=0.0, scale=sigma, size=case[\"N\"])\n\n        # Create noisy data\n        S_noisy = S_true + noise\n\n        # 2. Model Fitting\n        # Construct the design matrix A\n        A = np.vstack([np.ones_like(E), E, E**2, E * np.log(E / E0)]).T\n\n        # Define the bounds for the parameters [a0, a1, a2, c]\n        # a0 = 0, a1 = 0\n        lb = [0, 0, -np.inf, -np.inf]\n        ub = [np.inf, np.inf, np.inf, np.inf]\n        bounds = (lb, ub)\n\n        # Perform bound-constrained linear least-squares fit\n        fit_result = lsq_linear(A, S_noisy, bounds=bounds)\n        \n        # The fitted parameters are in fit_result.x\n        a0_fit = fit_result.x[0]\n\n        # 3. Extrapolation\n        # The extrapolated S(0) value is the fitted a0\n        results.append(a0_fit)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}