{
    "hands_on_practices": [
        {
            "introduction": "超新星爆发始于一个强大的激波，它从新生的原中子星表面向外传播。然而，当激波穿过恒星的铁核时，它必须消耗巨大的能量来将铁核分解（或称“光致蜕变”）成自由的核子。这项实践旨在通过一个关键的计算，揭示这个能量“水槽”的严重性。通过比较下落物质的动能和铁核的离解能，你将亲手发现为什么仅靠激波自身的能量不足以驱动即时爆炸，从而为理解延迟中微子加热机制的必要性奠定基础。",
            "id": "3570479",
            "problem": "在核塌缩超新星的计算模型中，向铁族原子核传播的吸积激波因核离解而损失能量，这在激波的能量收支中充当了一个能量汇。考虑一个完全由铁-56原子核组成的上游流，在激波处瞬间离解成自由的核子。上游的质量密度为 $\\rho_1 = 10^{10}\\,\\mathrm{g\\,cm^{-3}}$，上游速度为 $v_1 = 2 \\times 10^{9}\\,\\mathrm{cm\\,s^{-1}}$。将上游动能视为非相对论性的。使用以下数据：\n- 每个核子的铁结合能为 $E_b = 8.8\\,\\mathrm{MeV}$。\n- 电子伏特定义 $1\\,\\mathrm{eV} = 1.602176634 \\times 10^{-12}\\,\\mathrm{erg}$。\n- 原子质量单位（核子质量）$m_u = 1.66053906660 \\times 10^{-24}\\,\\mathrm{g}$。\n- 全程使用厘米-克-秒（CGS）单位制。\n\n计算穿过激波时，被铁离解消耗的能量占入射上游单位质量动能的分数。将最终答案表示为不带单位的小数，并四舍五入到三位有效数字。",
            "solution": "首先验证问题的科学合理性、自洽性和良定性。\n\n**步骤1：提取已知条件**\n-   上游介质成分：铁-56原子核（$^{56}\\mathrm{Fe}$）。\n-   上游质量密度：$\\rho_1 = 10^{10}\\,\\mathrm{g\\,cm^{-3}}$。\n-   上游速度：$v_1 = 2 \\times 10^{9}\\,\\mathrm{cm\\,s^{-1}}$。\n-   动能模型：非相对论性。\n-   铁-56的每核子结合能：$E_b = 8.8\\,\\mathrm{MeV}$。\n-   转换常数：$1\\,\\mathrm{eV} = 1.602176634 \\times 10^{-12}\\,\\mathrm{erg}$。\n-   原子质量单位（用作核子质量）：$m_u = 1.66053906660 \\times 10^{-24}\\,\\mathrm{g}$。\n-   任务：计算被铁离解消耗的能量占入射单位质量动能的分数。\n-   输出格式：四舍五入到三位有效数字的小数。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题描述了超新星激波中核离解的能量成本，这是天体物理学中一个标准且关键的过程。所提供的密度、速度和结合能的物理值对于此环境是符合实际的。对于速度 $v_1 = 2 \\times 10^{9}\\,\\mathrm{cm\\,s^{-1}}$（约为 $0.067c$，其中 $c$ 是光速），非相对论性假设是一个合理的近似。问题陈述清晰，为求解提供了所有必要数据，并且不包含科学或逻辑上的矛盾。上游密度 $\\rho_1$ 是背景信息，对于计算所要求的单位质量能量比值不是必需的，但这并不使问题无效。该问题被认定为有效。\n\n**步骤3：进行求解**\n\n目标是计算分数 $f$，其定义为单位质量离解消耗的能量 $\\mathcal{E}_{diss}$ 与单位质量的入射动能 $\\mathcal{K}_1$之比。\n$$\nf = \\frac{\\mathcal{E}_{diss}}{\\mathcal{K}_1}\n$$\n\n首先，我们计算单位质量的入射动能 $\\mathcal{K}_1$。根据非相对论性近似，质量为 $m$ 的物质的动能为 $K_1 = \\frac{1}{2} m v_1^2$。因此，单位质量的动能为：\n$$\n\\mathcal{K}_1 = \\frac{K_1}{m} = \\frac{1}{2} v_1^2\n$$\n代入给定的 $v_1$ 值：\n$$\n\\mathcal{K}_1 = \\frac{1}{2} \\left(2 \\times 10^9\\,\\mathrm{cm\\,s^{-1}}\\right)^2 = \\frac{1}{2} \\left(4 \\times 10^{18}\\,\\mathrm{cm^2\\,s^{-2}}\\right) = 2 \\times 10^{18}\\,\\mathrm{erg\\,g^{-1}}\n$$\n注意，在CGS单位制中，$1\\,\\mathrm{erg} = 1\\,\\mathrm{g\\,cm^2\\,s^{-2}}$。\n\n接下来，我们计算单位质量离解消耗的能量 $\\mathcal{E}_{diss}$。上游物质被指定为铁-56，它会离解成自由的核子。此过程的能量成本由结合能给出。所提供的结合能为每核子 $E_b = 8.8\\,\\mathrm{MeV}$。离解质量为 $m$ 的铁所需的能量是每个核子的这个能量乘以该质量中的核子数。质量 $m$ 中的核子数是 $m/m_{nucleon}$，其中 $m_{nucleon}$ 是单个核子的质量，我们将其近似为 $m_u$。\n因此，单位质量的离解能是每个核子的结合能除以一个核子的质量。\n$$\n\\mathcal{E}_{diss} = \\frac{E_b}{m_u}\n$$\n我们必须将 $E_b$ 的单位从 $\\mathrm{MeV}$ 转换为尔格（erg），以保持在CGS系统中的一致性。\n每个核子的结合能（以尔格为单位）是：\n$$\nE_b = 8.8\\,\\mathrm{MeV} = 8.8 \\times 10^6\\,\\mathrm{eV} \\times \\left(\\frac{1.602176634 \\times 10^{-12}\\,\\mathrm{erg}}{1\\,\\mathrm{eV}}\\right)\n$$\n$$\nE_b = 1.40991543792 \\times 10^{-5}\\,\\mathrm{erg}\n$$\n现在，我们可以使用给定的 $m_u$ 值计算 $\\mathcal{E}_{diss}$：\n$$\n\\mathcal{E}_{diss} = \\frac{1.40991543792 \\times 10^{-5}\\,\\mathrm{erg}}{1.66053906660 \\times 10^{-24}\\,\\mathrm{g}} \\approx 8.4907106 \\times 10^{18}\\,\\mathrm{erg\\,g^{-1}}\n$$\n\n最后，我们通过计算 $\\mathcal{E}_{diss}$ 与 $\\mathcal{K}_1$ 的比值来求得所需的分数 $f$：\n$$\nf = \\frac{\\mathcal{E}_{diss}}{\\mathcal{K}_1} = \\frac{8.4907106 \\times 10^{18}\\,\\mathrm{erg\\,g^{-1}}}{2 \\times 10^{18}\\,\\mathrm{erg\\,g^{-1}}}\n$$\n$$\nf \\approx 4.2453553\n$$\n结果大于1具有深刻的物理意义：下落物质的动能不足以支持其自身的离解。这是超新星模型中吸积激波停滞的主要原因，需要一个额外的能量驱动机制（如中微子加热）才能成功爆炸。\n\n问题要求将答案四舍五入到三位有效数字。\n$$\nf \\approx 4.25\n$$",
            "answer": "$$\n\\boxed{4.25}\n$$"
        },
        {
            "introduction": "在激波因能量损失而停滞后，必须有新的能源来使其“复苏”并驱动最终的爆炸，目前的主流理论是延迟中微子加热机制。这项练习将带你深入该机制的核心，通过计算来量化来自原中子星的中微子如何在激波后的“增益区”沉积能量。你将推导并计算单位质量的加热率以及一个关键的加热时间尺度，从而具体地感受中微子是如何为垂死的激波注入新生命的。",
            "id": "3570457",
            "problem": "考虑一个核心塌缩超新星中，围绕着原中子星（PNS）的增益区内的中微子加热。假设自由流动的电子中微子光度为 $L_{\\nu_e}$，光度加权的平均中微子能量平方为 $\\langle E_{\\nu_e}^2\\rangle$。在光学薄条件下，主要的加热通道是电子中微子在自由中子上的荷电流吸收过程，即 $\\nu_e + n \\rightarrow p + e^{-}$。采用标准的低能荷电流截面近似 $\\sigma_{\\mathrm{abs}}(E_{\\nu}) \\approx \\sigma_0 \\left(E_{\\nu}/\\mathrm{MeV}\\right)^2$，其中 $\\sigma_0 = 9.2\\times 10^{-44}\\,\\mathrm{cm^2}$，并忽略弱磁性、反冲和末态阻塞效应。假设物质是自由核子气体，电子分数为 $Y_e$，因此自由中子分数为 $Y_n = 1 - Y_e$。取重子质量为 $m_b$，包围质量为 $M$。半径 $r$ 处的中微子能流为 $F_{E,\\nu_e} = L_{\\nu_e}/(4\\pi r^2)$。在光学薄极限下进行计算，此时单位质量的能量沉积由吸收系数和能流的乘积给出。\n\n从这些基本原理和中子数密度定义 $n_n = Y_n \\rho/m_b$ 出发，推导比热率 $\\dot{q}$（单位质量的能量沉积率）的表达式，用 $L_{\\nu_e}$、$r$、$Y_n$、$\\langle E_{\\nu_e}^2\\rangle$、$\\sigma_0$ 和 $m_b$ 表示。请仔细论证您使用的任何谱平均方法。然后对以下给定的数值进行 $\\dot{q}$ 的数值计算：\n- $L_{\\nu_e} = 3.0\\times 10^{52}\\,\\mathrm{erg\\,s^{-1}}$，\n- $\\langle E_{\\nu_e}^2\\rangle = (12\\,\\mathrm{MeV})^2$，\n- $r = 150\\,\\mathrm{km}$，\n- $\\rho = 10^9\\,\\mathrm{g\\,cm^{-3}}$，\n- $Y_e = 0.5$ (因此 $Y_n = 0.5$)，\n- $m_b = 1.674\\times 10^{-24}\\,\\mathrm{g}$，\n- $M = 1.4\\,M_{\\odot}$，其中 $M_{\\odot} = 1.98847\\times 10^{33}\\,\\mathrm{g}$，\n- 牛顿引力常数 $G = 6.67430\\times 10^{-8}\\,\\mathrm{cm^3\\,g^{-1}\\,s^{-2}}$。\n\n利用每个重子的引力束缚能 $e_{\\mathrm{bind}} = G M m_b / r$，计算加热时间尺度 $t_{\\mathrm{heat}} = |e_{\\mathrm{bind}}|/\\dot{q}_b$，其中 $\\dot{q}_b$ 是每个重子的加热率。请按以下格式给出您的答案：\n- $\\dot{q}$ 的单位为 $\\mathrm{erg\\,g^{-1}\\,s^{-1}}$，\n- $t_{\\mathrm{heat}}$ 的单位为 $\\mathrm{s}$。\n\n将两个答案都四舍五入到三位有效数字。",
            "solution": "我们从光学薄区域中，由电子中微子在自由中子上的荷电流吸收所引起的单位体积能量沉积开始。单位体积单位时间内吸收的能量为\n$$\n\\dot{Q}_{\\mathrm{vol}} \\;=\\; \\int_{0}^{\\infty} \\mathrm{d}E_{\\nu}\\, E_{\\nu}\\, \\Phi_{\\nu}(E_{\\nu})\\, \\sigma_{\\mathrm{abs}}(E_{\\nu})\\, n_n,\n$$\n其中 $E_{\\nu}$ 是中微子能量，$\\Phi_{\\nu}(E_{\\nu})$ 是微分数量通量（单位面积、单位时间、单位能量内的数量），$\\sigma_{\\mathrm{abs}}(E_{\\nu})$ 是吸收截面，$n_n = Y_n \\rho/m_b$ 是中子数密度。比热率（单位质量）为 $\\dot{q} = \\dot{Q}_{\\mathrm{vol}}/\\rho$，因此\n$$\n\\dot{q} \\;=\\; \\frac{Y_n}{m_b} \\int_{0}^{\\infty} \\mathrm{d}E_{\\nu}\\, E_{\\nu}\\, \\Phi_{\\nu}(E_{\\nu})\\, \\sigma_{\\mathrm{abs}}(E_{\\nu}).\n$$\n\n使用低能截面近似 $\\sigma_{\\mathrm{abs}}(E_{\\nu}) = \\sigma_0 \\left(E_{\\nu}/\\mathrm{MeV}\\right)^2$，我们写出\n$$\n\\dot{q} \\;=\\; \\frac{Y_n}{m_b}\\, \\sigma_0 \\int_{0}^{\\infty} \\mathrm{d}E_{\\nu}\\, E_{\\nu}\\, \\Phi_{\\nu}(E_{\\nu}) \\left(\\frac{E_{\\nu}}{\\mathrm{MeV}}\\right)^2.\n$$\n定义能流为 $F_{E,\\nu_e} = \\int_{0}^{\\infty} \\mathrm{d}E_{\\nu}\\, E_{\\nu}\\, \\Phi_{\\nu}(E_{\\nu}) = L_{\\nu_e}/(4\\pi r^2)$。为了将截面对 $E_{\\nu}^2$ 的依赖性与单个谱参数联系起来，我们引入光度加权的平均能量平方\n$$\n\\langle E_{\\nu_e}^2 \\rangle \\;\\equiv\\; \\frac{\\int_{0}^{\\infty} \\mathrm{d}E_{\\nu}\\, E_{\\nu}^3 \\Phi_{\\nu}(E_{\\nu})}{\\int_{0}^{\\infty} \\mathrm{d}E_{\\nu}\\, E_{\\nu} \\Phi_{\\nu}(E_{\\nu})}.\n$$\n对于截面与 $E_{\\nu}^2$ 成正比且输运的量是能量的过程，这是一个自然的平均值。根据这个定义，\n$$\n\\int_{0}^{\\infty} \\mathrm{d}E_{\\nu}\\, E_{\\nu}^3 \\Phi_{\\nu}(E_{\\nu}) \\;=\\; \\langle E_{\\nu_e}^2 \\rangle \\int_{0}^{\\infty} \\mathrm{d}E_{\\nu}\\, E_{\\nu} \\Phi_{\\nu}(E_{\\nu}) \\;=\\; \\langle E_{\\nu_e}^2 \\rangle\\, F_{E,\\nu_e}.\n$$\n然而，需要注意单位。截面表示为 $\\sigma_0 (E_{\\nu}/\\mathrm{MeV})^2$，其中 $\\sigma_0$ 的单位是 $\\mathrm{cm^2}$。设 $\\alpha \\equiv 1\\,\\mathrm{MeV}$ 用尔格表示，即 $\\alpha = 1.602176634\\times 10^{-6}\\,\\mathrm{erg}$。那么 $(E_{\\nu}/\\mathrm{MeV})^2 = (E_{\\nu}/\\alpha)^2$，并且\n$$\n\\int \\mathrm{d}E_{\\nu}\\, E_{\\nu}\\, \\Phi_{\\nu}(E_{\\nu}) \\left(\\frac{E_{\\nu}}{\\mathrm{MeV}}\\right)^2\n\\;=\\; \\alpha^{-2} \\int \\mathrm{d}E_{\\nu}\\, E_{\\nu}^3 \\Phi_{\\nu}(E_{\\nu})\n\\;=\\; \\alpha^{-2}\\, \\langle E_{\\nu_e}^2 \\rangle_{\\mathrm{erg}}\\, F_{E,\\nu_e},\n$$\n其中 $\\langle E_{\\nu_e}^2 \\rangle_{\\mathrm{erg}}$ 是用尔格为单位计算 $E_{\\nu}$ 时的光度加权平均能量平方。由于 $\\langle E_{\\nu_e}^2 \\rangle_{\\mathrm{erg}} = \\alpha^2 \\langle E_{\\nu_e}^2 \\rangle_{\\mathrm{MeV}}$，$\\alpha$ 因子相互抵消，得到一个简洁的结果\n$$\n\\dot{q} \\;=\\; \\frac{Y_n}{m_b}\\, \\sigma_0\\, \\langle E_{\\nu_e}^2 \\rangle_{\\mathrm{MeV}}\\, F_{E,\\nu_e}\n\\;=\\; \\frac{Y_n}{m_b}\\, \\sigma_0\\, \\langle E_{\\nu_e}^2 \\rangle_{\\mathrm{MeV}}\\, \\frac{L_{\\nu_e}}{4\\pi r^2}.\n$$\n因此，在光学薄极限下，$\\dot{q}$ 与质量密度 $\\rho$ 无关；在除以 $\\rho$ 以获得比率时，来自 $n_n$ 的显式因子 $\\rho$ 被抵消了。\n\n接下来，我们数值计算单位质量的加热率。代入数据：\n- $L_{\\nu_e} = 3.0\\times 10^{52}\\,\\mathrm{erg\\,s^{-1}}$，\n- $r = 150\\,\\mathrm{km} = 1.50\\times 10^{7}\\,\\mathrm{cm}$，\n- $Y_e = 0.5$ 所以 $Y_n = 0.5$，\n- $m_b = 1.674\\times 10^{-24}\\,\\mathrm{g}$，\n- $\\sigma_0 = 9.2\\times 10^{-44}\\,\\mathrm{cm^2}$，\n- $\\langle E_{\\nu_e}^2 \\rangle_{\\mathrm{MeV}} = (12\\,\\mathrm{MeV})^2 = 144\\,\\mathrm{MeV^2}$。\n\n计算能流：\n$$\nF_{E,\\nu_e} \\;=\\; \\frac{L_{\\nu_e}}{4\\pi r^2}\n\\;=\\; \\frac{3.0\\times 10^{52}}{4\\pi\\,(1.50\\times 10^{7})^2}\\,\\mathrm{erg\\,cm^{-2}\\,s^{-1}}\n\\;=\\; \\frac{3.0\\times 10^{52}}{2.827433388\\times 10^{15}}\\,\\mathrm{erg\\,cm^{-2}\\,s^{-1}}\n\\;\\approx\\; 1.06103\\times 10^{37}\\,\\mathrm{erg\\,cm^{-2}\\,s^{-1}}.\n$$\n计算单位质量的有效吸收系数：\n$$\n\\kappa_a \\;=\\; \\frac{Y_n}{m_b}\\,\\sigma_0\\,\\langle E_{\\nu_e}^2\\rangle_{\\mathrm{MeV}}\n\\;=\\; \\frac{0.5}{1.674\\times 10^{-24}} \\times (9.2\\times 10^{-44}) \\times 144 \\;\\mathrm{cm^2\\,g^{-1}}\n\\;\\approx\\; 3.96\\times 10^{-19}\\,\\mathrm{cm^2\\,g^{-1}}.\n$$\n因此，\n$$\n\\dot{q} \\;=\\; \\kappa_a\\, F_{E,\\nu_e}\n\\;\\approx\\; (3.96\\times 10^{-19}) \\times (1.06103\\times 10^{37})\\;\\mathrm{erg\\,g^{-1}\\,s^{-1}}\n\\;\\approx\\; 4.20\\times 10^{18}\\,\\mathrm{erg\\,g^{-1}\\,s^{-1}}.\n$$\n\n对于加热时间尺度，题目将每个重子的引力束缚能定义为 $e_{\\mathrm{bind}} = G M m_b / r$。基于每个重子能量学的加热时间尺度为 $t_{\\mathrm{heat}} = |e_{\\mathrm{bind}}|/\\dot{q}_b$，其中 $\\dot{q}_b$ 是每个重子的加热率。注意到 $\\dot{q}_b = \\dot{q}\\, m_b$ 且 $e_{\\mathrm{bind}} = (G M/r)\\, m_b$，因子 $m_b$ 抵消了，因此时间尺度可以等效地使用单位质量的束缚能 $e_{\\mathrm{bind}}^{\\mathrm{(mass)}} = G M / r$ 来计算：\n$$\nt_{\\mathrm{heat}} \\;=\\; \\frac{G M / r}{\\dot{q}}.\n$$\n现在计算 $G M / r$ 的值，其中 $M = 1.4\\,M_{\\odot}$，$M_{\\odot} = 1.98847\\times 10^{33}\\,\\mathrm{g}$，$G = 6.67430\\times 10^{-8}\\,\\mathrm{cm^3\\,g^{-1}\\,s^{-2}}$，$r = 1.50\\times 10^{7}\\,\\mathrm{cm}$：\n$$\nM \\;=\\; 1.4 \\times 1.98847\\times 10^{33}\\,\\mathrm{g} \\;=\\; 2.783858\\times 10^{33}\\,\\mathrm{g},\n$$\n$$\n\\frac{G M}{r} \\;=\\; \\frac{6.67430\\times 10^{-8}\\times 2.783858\\times 10^{33}}{1.50\\times 10^{7}}\\,\\mathrm{erg\\,g^{-1}}\n\\;\\approx\\; 1.23869\\times 10^{19}\\,\\mathrm{erg\\,g^{-1}}.\n$$\n因此，\n$$\nt_{\\mathrm{heat}} \\;=\\; \\frac{1.23869\\times 10^{19}}{4.20\\times 10^{18}}\\,\\mathrm{s}\n\\;\\approx\\; 2.95\\,\\mathrm{s}.\n$$\n\n总结并按要求四舍五入到三位有效数字：\n- $\\dot{q} \\approx 4.20\\times 10^{18}\\,\\mathrm{erg\\,g^{-1}\\,s^{-1}}$，\n- $t_{\\mathrm{heat}} \\approx 2.95\\,\\mathrm{s}$。\n\n对于给定的半径和光度，这些值对于电子中微子在增益区的加热是物理上合理的，并且比热率中 $\\rho$ 的抵消反映了这是光学薄、吸收主导的状态。",
            "answer": "$$\\boxed{\\begin{pmatrix}4.20\\times 10^{18}  2.95\\end{pmatrix}}$$"
        },
        {
            "introduction": "将物理定律转化为可靠的计算机代码是计算天体物理学的终极挑战之一，其中一个核心要求是数值格式必须严格遵守物理守恒律。此项实践任务是设计并实现一个混合隐式-显式（IMEX）时间步进格式，用于处理刚性的弱相互作用源项，同时确保总轻子数在机器精度内守恒。这个练习不仅能让你掌握处理刚性方程和守恒律的先进数值技术，也直接模拟了构建真实超新星模拟代码所面临的核心问题。",
            "id": "3570423",
            "problem": "您的任务是为与核塌缩超新星相关的电子轻子数演化的一维模型中的刚性弱相互作用源项，设计并实现一个数值守恒的隐式-显式格式。您的目标是构建一个能将总电子轻子数守恒到机器精度的方法，并通过随时间追踪总电子轻子含量的空间积分来验证这种守恒性。所有量都经过无量纲化处理；请将所有最终数值结果表示为无量纲浮点数。\n\n考虑一个长度为 $L$ 的一维周期性区域，将其离散化为 $N$ 个宽度为 $\\Delta x = L/N$ 的均匀有限体积元胞，元胞中心位于 $x_i$。令 $\\rho(x,t)$ 表示质量密度，$Y_e(x,t)$ 表示电子分数（每重子的电子数），$Y_{\\nu_e}(x,t)$ 表示电子中微子分数（每重子的电子中微子数）。速度场 $u(x)$ 是给定的且不随时间变化，代表一种可压缩流入模式。弱相互作用由一个刚性电子俘获源建模，该源将电子轻子数从电子转移到电子中微子而无泄漏，因此局域源项构成一个守恒对。\n\n控制方程的守恒形式为：\n- 连续性方程：$\\partial_t \\rho + \\partial_x (\\rho u) = 0$。\n- 电子分数：$\\partial_t(\\rho Y_e) + \\partial_x(\\rho Y_e u) = - \\rho \\, \\mathcal{R}$。\n- 电子中微子分数：$\\partial_t(\\rho Y_{\\nu_e}) + \\partial_x(\\rho Y_{\\nu_e} u) = + \\rho \\, \\mathcal{R}$。\n\n此处 $\\mathcal{R}$ 是一个刚性相互作用率。假设以下物理上合理但简化的封闭关系：\n- 速度为 $u(x) = - U_0 \\sin(2\\pi x/L)$。\n- 反应率为 $\\mathcal{R} = \\lambda(\\rho)\\, \\big(Y_e - Y_e^{\\mathrm{eq}}(\\rho)\\big)$，其中 $\\lambda(\\rho) = \\lambda_0 \\rho$ 且 $Y_e^{\\mathrm{eq}}(\\rho) = 0.05 + 0.45\\,[1 + (\\rho/5)^2]^{-1}$。\n\n$t=0$ 时的初始条件为：\n- $\\rho(x,0) = 1.0 + 0.1 \\cos(2\\pi x/L)$,\n- $Y_e(x,0) = 0.45 + 0.05 \\sin(2\\pi x/L)$,\n- $Y_{\\nu_e}(x,0) = 10^{-6}$。\n\n所有数值均为无量纲。\n\n设计一个如下的隐式-显式时间步进方法：\n- 使用一阶守恒迎风有限体积法对 $\\rho$、$\\rho Y_e$ 和 $\\rho Y_{\\nu_e}$ 的平流项通量进行离散化，在时间上采用满足 Courant–Friedrichs–Lewy (CFL) 时间步长约束的显式处理。\n- 对刚性源项在每个元胞上使用全隐式更新，以在源项子步中将局域和 $Y_e + Y_{\\nu_e}$ 保持到机器精度。您的推导必须仅从控制方程和反应率的定义出发；不要假设任何预先推导好的更新公式。\n\n令 $\\mathcal{L}(t)$ 表示守恒的总电子轻子含量，其定义为质量加权空间积分\n$$\n\\mathcal{L}(t) = \\int_0^L \\rho(x,t)\\,\\big(Y_e(x,t) + Y_{\\nu_e}(x,t)\\big)\\, dx.\n$$\n在周期性边界条件且无轻子泄漏的情况下，方程意味着 $\\mathcal{L}(t)$ 随时间守恒。您的数值方法必须在由 $\\lambda_0$ 控制的任意刚度下，将 $\\mathcal{L}(t)$ 的守恒性保持在舍入误差范围内。\n\n实现要求：\n- 使用带有周期性边界条件的均匀网格。\n- 使用由 CFL 条件 $\\Delta t = \\mathrm{CFL} \\, \\Delta x / \\max_i |u_{i+\\frac{1}{2}}|$ 给出的时间步长 $\\Delta t$，其中 $u_{i+\\frac{1}{2}}$ 是面 $i+\\frac{1}{2}$ 上的速度，通过在面位置处计算解析解 $u(x)$ 来近似。当 $\\max_i |u_{i+\\frac{1}{2}}| = 0$ 时，将 $\\Delta t$ 设置为一步到达最终时间 $T$ 所需的剩余时间。\n- 对每个守恒场使用一阶 Godunov 迎风格式通量。例如，守恒场 $q$ 通过面 $i+\\frac{1}{2}$ 的通量为 $F_{i+\\frac{1}{2}} = u_{i+\\frac{1}{2}} \\, q^{\\mathrm{up}}_{i+\\frac{1}{2}}$，其中如果 $u_{i+\\frac{1}{2}} \\ge 0$，迎风状态从左元胞选取，否则从右元胞选取。\n- 使用算子分裂：对 $\\rho$、$\\rho Y_e$ 和 $\\rho Y_{\\nu_e}$ 应用显式平流步，然后在每个元胞上对 $Y_e$ 和 $Y_{\\nu_e}$ 局部应用隐式反应步，在源项子步中保持 $\\rho$ 不变。\n\n验证目标：\n- 对每个测试用例，计算初始值 $\\mathcal{L}(0)$ 和最终值 $\\mathcal{L}(T)$。将绝对相对漂移 $|\\mathcal{L}(T) - \\mathcal{L}(0)| / \\mathcal{L}(0)$ 作为浮点数报告。\n\n测试套件：\n提供一个单一程序，运行以下四个测试用例，并按指定顺序在单行中输出四个漂移值。使用 $L=1$。\n- 用例 1（刚性，中等平流）：$N = 256$，$\\mathrm{CFL} = 0.8$， $U_0 = 0.3$， $\\lambda_0 = 10^6$，$T = 1.0$。\n- 用例 2（无反应，仅平流）：$N = 64$，$\\mathrm{CFL} = 0.9$， $U_0 = 0.1$， $\\lambda_0 = 0.0$，$T = 2.0$。\n- 用例 3（粗网格，强流入）：$N = 8$，$\\mathrm{CFL} = 0.5$， $U_0 = 0.9$， $\\lambda_0 = 10^2$，$T = 0.5$。\n- 用例 4（单网格，仅反应）：$N = 1$，$\\mathrm{CFL} = 0.9$， $U_0 = 0.0$， $\\lambda_0 = 10^{12}$，$T = 1.0$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，`[result1,result2,result3,result4]`），每个结果是相应测试用例的绝对相对漂移，表示为无量纲单位的浮点数。",
            "solution": "该问题是有效的，因为它提出了一个适定的、有科学依据的计算物理问题。它是自洽的，清晰地指明了所有必要的方程、参数和数值要求。任务是为一个平流-反应方程组实现一个数值守恒格式，这是科学计算中的一个标准且可验证的问题。\n\n解决方案基于算子分裂方法构建，其中平流和反应过程在独立的子步中处理。这允许针对每个过程的特性使用不同的数值方法：对非刚性平流使用显式方法，对刚性弱相互作用源项使用隐式方法。\n\n一维空间中的控制方程为：\n$$ \\partial_t \\rho + \\partial_x (\\rho u) = 0 $$\n$$ \\partial_t(\\rho Y_e) + \\partial_x(\\rho Y_e u) = - \\rho \\, \\mathcal{R} $$\n$$ \\partial_t(\\rho Y_{\\nu_e}) + \\partial_x(\\rho Y_{\\nu_e} u) = + \\rho \\, \\mathcal{R} $$\n其中 $\\rho$ 是质量密度，$Y_e$ 是电子分数，$Y_{\\nu_e}$ 是电子中微子分数，$u(x) = - U_0 \\sin(2\\pi x/L)$ 是给定的速度场，而 $\\mathcal{R} = \\lambda(\\rho)\\, \\big(Y_e - Y_e^{\\mathrm{eq}}(\\rho)\\big)$ 是反应率。问题指定了 $\\lambda(\\rho) = \\lambda_0 \\rho$。\n\n总电子轻子数含量 $\\mathcal{L}(t)$ 定义为\n$$ \\mathcal{L}(t) = \\int_0^L \\rho(x,t)\\,\\big(Y_e(x,t) + Y_{\\nu_e}(x,t)\\big)\\, dx $$\n将 $\\rho Y_e$ 和 $\\rho Y_{\\nu_e}$ 的方程相加可得\n$$ \\partial_t\\big(\\rho(Y_e + Y_{\\nu_e})\\big) + \\partial_x\\big(\\rho(Y_e + Y_{\\nu_e})u\\big) = 0 $$\n这是关于量 $\\rho(Y_e + Y_{\\nu_e})$ 的一个守恒律。在周期性区域 $[0, L]$ 上积分表明 $d\\mathcal{L}/dt = 0$，意味着 $\\mathcal{L}(t)$ 是一个守恒量。数值格式必须将此性质保持到机器精度。\n\n区域被离散化为 $N$ 个宽度均匀的有限体积元胞，宽度为 $\\Delta x = L/N$。在时间 $t_n$ 时，元胞 $i$（中心在 $x_i$）中量 $q$ 的元胞平均值表示为 $q_i^n$。时间步长为 $\\Delta t$。\n\n从时间 $t_n$ 到 $t_{n+1} = t_n + \\Delta t$ 的整体更新使用算子分裂执行：\n1.  **平流子步（显式）：**\n    首先，我们对所有三个守恒量 $(\\rho, \\rho Y_e, \\rho Y_{\\nu_e})$ 求解方程的平流部分。对于一个一般的守恒量 $q$，方程为 $\\partial_t q + \\partial_x (q u) = 0$。使用一阶迎风有限体积法，从状态 $n$ 到中间状态 $*$ 的更新为：\n    $$ q_i^* = q_i^n - \\frac{\\Delta t}{\\Delta x} \\left( F_{i+1/2} - F_{i-1/2} \\right) $$\n    其中 $F_{i+1/2}$ 是元胞 $i$ 和元胞 $i+1$ 之间面上的数值通量。对于一阶 Godunov 方法，通量由迎风状态决定：\n    $$ F_{i+1/2} = u_{i+1/2} \\, q_{i+1/2}^{\\mathrm{up}} = \\begin{cases} u_{i+1/2} \\, q_i^n  \\text{if } u_{i+1/2} \\ge 0 \\\\ u_{i+1/2} \\, q_{i+1}^n  \\text{if } u_{i+1/2}  0 \\end{cases} $$\n    其中 $u_{i+1/2}$ 是面上的速度。由于通量和的伸缩求和特性以及周期性边界条件，此步骤精确守恒每种量的总量 $\\sum_i q_i \\Delta x$。因此，在平流子步中，总轻子数 $\\sum_i (\\rho Y_e + \\rho Y_{\\nu_e})_i \\Delta x$ 是守恒的。\n\n2.  **反应子步（隐式）：**\n    接下来，我们在每个元胞中局部应用源项，将状态从 $*$ 更新到 $n+1$。在此子步中，$\\rho$ 保持不变，即 $\\rho_i^{n+1} = \\rho_i^*$。反应仅修改 $Y_e$ 和 $Y_{\\nu_e}$。每个元胞 $i$ 的局域常微分方程组为：\n    $$ \\frac{d Y_{e,i}}{dt} = -\\mathcal{R}_i = -\\lambda(\\rho_i^*) \\left( Y_{e,i} - Y_{e,i}^{\\mathrm{eq}}(\\rho_i^*) \\right) $$\n    $$ \\frac{d Y_{\\nu_e,i}}{dt} = +\\mathcal{R}_i = +\\lambda(\\rho_i^*) \\left( Y_{e,i} - Y_{e,i}^{\\mathrm{eq}}(\\rho_i^*) \\right) $$\n    该系统意味着 $\\frac{d}{dt}(Y_{e,i} + Y_{\\nu_e,i}) = 0$，因此在每个元胞内，和 $Y_{e,i} + Y_{\\nu_e,i}$ 必须守恒。\n    为了处理反应率 $\\mathcal{R}$ 的刚性，我们对 $Y_e$ 方程使用全隐式（后向欧拉）离散化。从原始变量 $Y_{e,i}^* = (\\rho Y_e)_i^*/\\rho_i^*$ 开始，更新为：\n    $$ \\frac{Y_{e,i}^{n+1} - Y_{e,i}^*}{\\Delta t} = -\\lambda(\\rho_i^*) \\left( Y_{e,i}^{n+1} - Y_{e,i}^{\\mathrm{eq}}(\\rho_i^*) \\right) $$\n    解出 $Y_{e,i}^{n+1}$ 得到更新公式：\n    $$ Y_{e,i}^{n+1} = \\frac{Y_{e,i}^* + \\Delta t \\, \\lambda_i^* Y_{e,i}^{\\mathrm{eq},*}}{1 + \\Delta t \\, \\lambda_i^*} $$\n    其中 $\\lambda_i^* = \\lambda(\\rho_i^*)$ 且 $Y_{e,i}^{\\mathrm{eq},*} = Y_{e,i}^{\\mathrm{eq}}(\\rho_i^*)$。对于任意刚性参数 $\\lambda_0$ 和时间步长 $\\Delta t$，此格式都是无条件稳定的。\n    为保证守恒性，我们不通过离散化 $Y_{\\nu_e,i}$ 自身的常微分方程来更新它，而是利用守恒性质。$Y_e$ 的变化必须由 $Y_{\\nu_e}$ 的变化来平衡：$\\Delta Y_{\\nu_e,i} = - \\Delta Y_{e,i}$。因此：\n    $$ Y_{\\nu_e,i}^{n+1} = Y_{\\nu_e,i}^* - (Y_{e,i}^{n+1} - Y_{e,i}^*) $$\n    这保证了 $Y_{e,i}^{n+1} + Y_{\\nu_e,i}^{n+1} = Y_{e,i}^* + Y_{\\nu_e,i}^*$ 达到机器精度。\n    那么更新后的守恒量为 $(\\rho Y_e)_i^{n+1} = \\rho_i^{n+1} Y_{e,i}^{n+1}$ 和 $(\\rho Y_{\\nu_e})_i^{n+1} = \\rho_i^{n+1} Y_{\\nu_e,i}^{n+1}$。由于 $\\rho_i^{n+1} = \\rho_i^*$ 且 $(Y_e+Y_{\\nu_e})$ 是守恒的，因此元胞内的量 $(\\rho Y_e + \\rho Y_{\\nu_e})_i$ 在反应步骤中是守恒的。\n\n由于平流和反应子步都守恒总电子轻子数，因此完整的数值格式将 $\\mathcal{L}(t)$ 的守恒性保持在浮点舍入误差范围内。实现过程计算初始值 $\\mathcal{L}(0)$ 和最终值 $\\mathcal{L}(T)$，并报告绝对相对漂移 $|\\mathcal{L}(T) - \\mathcal{L}(0)| / \\mathcal{L}(0)$，预计其大小在机器精度的量级。",
            "answer": "```python\nimport numpy as np\n\ndef advect(q, u_at_faces, dt, dx):\n    \"\"\"\n    Advects a cell-centered quantity q using a first-order upwind scheme.\n\n    Args:\n        q (np.ndarray): Array of the cell-centered quantity, shape (N,).\n        u_at_faces (np.ndarray): Array of velocities at cell faces, shape (N+1,).\n        dt (float): Time step.\n        dx (float): Cell width.\n\n    Returns:\n        np.ndarray: The advected quantity, shape (N,).\n    \"\"\"\n    N = len(q)\n    # Extend q for periodic boundaries to get states at all faces\n    # q_ext[i] is the state to the left of face i (q_{i-1})\n    # q_ext[i+1] is the state to the right of face i (q_i)\n    q_ext = np.concatenate(([q[-1]], q, [q[0]]))\n    \n    # States to the left and right of each of the N+1 faces\n    q_left_states = q_ext[:-1]\n    q_right_states = q_ext[1:]\n    \n    # Calculate fluxes at N+1 faces using the upwind rule\n    fluxes = np.where(u_at_faces = 0, u_at_faces * q_left_states, u_at_faces * q_right_states)\n    \n    # Update cell-centered quantities using fluxes at cell boundaries.\n    # For cell i, the boundaries are face i and face i+1.\n    q_new = q - (dt/dx) * (fluxes[1:] - fluxes[:-1])\n    \n    return q_new\n\ndef run_simulation(N, CFL, U0, lambda0, T, L=1.0):\n    \"\"\"\n    Runs a single simulation case for the advection-reaction system.\n    \"\"\"\n    # 1. Grid setup\n    dx = L / N\n    x_centers = (np.arange(N) + 0.5) * dx\n    x_faces = np.arange(N + 1) * dx\n\n    # 2. Initial conditions\n    rho = 1.0 + 0.1 * np.cos(2 * np.pi * x_centers / L)\n    Ye = 0.45 + 0.05 * np.sin(2 * np.pi * x_centers / L)\n    Ynue = np.full(N, 1e-6)\n    \n    # Conserved variables\n    rhoYe = rho * Ye\n    rhoYnue = rho * Ynue\n\n    # 3. Calculate initial total lepton number\n    L0 = np.sum(rhoYe + rhoYnue) * dx\n\n    # 4. Main time loop\n    t = 0.0\n    while t  T:\n        # Calculate time step from CFL condition\n        u_at_faces = -U0 * np.sin(2 * np.pi * x_faces / L)\n        u_max = np.max(np.abs(u_at_faces))\n        \n        if u_max == 0.0:\n            dt = T - t\n        else:\n            dt = CFL * dx / u_max\n        \n        # Ensure the final time is not overshot\n        if t + dt  T:\n            dt = T - t\n\n        # Substep 1: Advection (Explicit)\n        rho_star = advect(rho, u_at_faces, dt, dx)\n        rhoYe_star = advect(rhoYe, u_at_faces, dt, dx)\n        rhoYnue_star = advect(rhoYnue, u_at_faces, dt, dx)\n\n        # Substep 2: Reaction (Implicit)\n        # Primitives at intermediate state\n        rho_star_safe = np.maximum(rho_star, 1e-100) # Avoid division by zero\n        Ye_star = rhoYe_star / rho_star_safe\n        Ynue_star = rhoYnue_star / rho_star_safe\n\n        # Reaction parameters\n        lambda_val = lambda0 * rho_star\n        Ye_eq = 0.05 + 0.45 / (1.0 + (rho_star / 5.0)**2)\n        \n        # Implicit update for Ye\n        dt_lambda = dt * lambda_val\n        Ye_new = (Ye_star + dt_lambda * Ye_eq) / (1.0 + dt_lambda)\n\n        # Conservative update for Ynue\n        delta_Ye = Ye_new - Ye_star\n        Ynue_new = Ynue_star - delta_Ye\n\n        # Update conserved variables for the next time step\n        rho = rho_star # Density is constant during the reaction step\n        rhoYe = rho * Ye_new\n        rhoYnue = rho * Ynue_new\n\n        # Update time\n        t += dt\n\n    # 5. Calculate final total lepton number\n    LT = np.sum(rhoYe + rhoYnue) * dx\n    \n    # 6. Compute and return absolute relative drift\n    if np.abs(L0)  1e-15:\n        drift = np.abs(LT - L0) / np.abs(L0)\n    else:\n        drift = np.abs(LT - L0)\n      \n    return drift\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print results.\n    \"\"\"\n    test_cases = [\n        # (N, CFL, U0, lambda0, T)\n        (256, 0.8, 0.3, 1e6, 1.0),\n        (64, 0.9, 0.1, 0.0, 2.0),\n        (8, 0.5, 0.9, 1e2, 0.5),\n        (1, 0.9, 0.0, 1e12, 1.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        N, CFL, U0, lambda0, T = case\n        drift = run_simulation(N, CFL, U0, lambda0, T)\n        results.append(drift)\n\n    # Format and print the final output\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}