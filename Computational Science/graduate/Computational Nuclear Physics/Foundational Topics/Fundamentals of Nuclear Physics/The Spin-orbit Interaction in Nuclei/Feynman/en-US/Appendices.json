{
    "hands_on_practices": [
        {
            "introduction": "This exercise establishes a direct link between the theoretical formalism of the spin-orbit potential and measurable experimental data. By applying first-order perturbation theory to the well-known spin-orbit splitting in light nuclei, you will perform a tangible calculation to estimate the interaction's strength parameter. This practice  is invaluable for developing physical intuition and understanding how fundamental parameters in nuclear models are constrained by observation.",
            "id": "3607671",
            "problem": "Consider a mean-field description of a doubly magic nucleus with mass number $A=16$, in which a nucleon moves in a central Woods–Saxon potential and a spin–orbit interaction. The central radial form factor is $f(r) = \\bigl[1+\\exp((r-R)/a)\\bigr]^{-1}$ with nuclear radius $R=r_{0}A^{1/3}$ and diffuseness $a$. The spin–orbit potential is taken in the standard surface-peaked form $U_{\\mathrm{so}}(r) = W_{\\mathrm{so}}\\,\\frac{1}{r}\\frac{d}{dr}f(r)\\,\\mathbf{l}\\cdot\\mathbf{s}$, where $W_{\\mathrm{so}}$ is an effective strength parameter. Assume first-order perturbation theory is valid for the spin–orbit splitting of the $1p$ shell and approximate the radial expectation value of $\\frac{1}{r}\\frac{d}{dr}f(r)$ by its value at the nuclear surface $r=R$. Use the fundamental angular momentum identity $\\mathbf{l}\\cdot\\mathbf{s}=\\frac{1}{2}\\bigl(\\mathbf{j}^{2}-\\mathbf{l}^{2}-\\mathbf{s}^{2}\\bigr)$ for eigenstates of total angular momentum $j$, orbital angular momentum $l$, and spin $s=\\frac{1}{2}$ to connect the spin–orbit energy shift to the observed $j$ dependence.\n\nEmpirically, the $1p_{1/2}$ and $1p_{3/2}$ hole states in $^{15}\\mathrm{N}$ and $^{15}\\mathrm{O}$ (corresponding to removing a nucleon from $^{16}\\mathrm{O}$) exhibit a nearly isospin-symmetric splitting. Take the measured excitation energies of the $3/2^{-}$ hole states relative to the $1/2^{-}$ ground states to be $E_{3/2^{-}}(^{15}\\text{N})=6.324\\,\\text{MeV}$ and $E_{3/2^{-}}(^{15}\\text{O})=6.176\\,\\text{MeV}$, and use their average as the empirical $1p$ spin–orbit splitting magnitude. Use $r_{0}=1.25\\,\\mathrm{fm}$ and $a=0.65\\,\\mathrm{fm}$.\n\nUsing only the elements specified above, estimate the effective spin–orbit strength $W_{\\mathrm{so}}$ that reproduces the observed $1p_{3/2}$–$1p_{1/2}$ splitting in $^{16}\\mathrm{O}$ within this Woods–Saxon model. Express your final answer for $W_{\\mathrm{so}}$ in $\\mathrm{MeV\\,fm^{2}}$ and round to three significant figures.",
            "solution": "The problem requires the estimation of the effective spin–orbit strength parameter, $W_{\\mathrm{so}}$, for a nucleon in a Woods–Saxon potential, based on the observed splitting of the $1p$ shell in $^{16}\\mathrm{O}$. The solution will be derived using first-order perturbation theory and the specific approximations provided.\n\nThe spin–orbit interaction potential is given by $U_{\\mathrm{so}}(r) = W_{\\mathrm{so}}\\,\\frac{1}{r}\\frac{d}{dr}f(r)\\,\\mathbf{l}\\cdot\\mathbf{s}$. In first-order perturbation theory, the energy shift for a nucleon in a single-particle state $|n, l, j, m_j\\rangle$ is the expectation value of this potential:\n$$\n\\Delta E_{nlj} = \\langle nljm_j | U_{\\mathrm{so}} | nljm_j \\rangle\n$$\nSince the potential operator is a product of a radial part and an angular part, and the wavefunction is separable, the expectation value can be written as:\n$$\n\\Delta E_{nlj} = W_{\\mathrm{so}} \\left\\langle \\frac{1}{r}\\frac{d}{dr}f(r) \\right\\rangle_{nl} \\langle \\mathbf{l}\\cdot\\mathbf{s} \\rangle_{lj}\n$$\nThe angular part $\\langle \\mathbf{l}\\cdot\\mathbf{s} \\rangle_{lj}$ can be evaluated using the provided identity $\\mathbf{l}\\cdot\\mathbf{s}=\\frac{1}{2}\\bigl(\\mathbf{j}^{2}-\\mathbf{l}^{2}-\\mathbf{s}^{2}\\bigr)$. For an eigenstate of total angular momentum $j$, orbital angular momentum $l$, and spin $s$, the expectation value is:\n$$\n\\langle \\mathbf{l}\\cdot\\mathbf{s} \\rangle_{lj} = \\frac{1}{2} [j(j+1) - l(l+1) - s(s+1)]\n$$\nWe are considering the $1p$ shell, for which the orbital angular momentum quantum number is $l=1$. As a nucleon is a spin-$1/2$ fermion, its spin quantum number is $s=1/2$. The possible values for the total angular momentum quantum number $j$ are $j=l \\pm s$, which gives $j=3/2$ and $j=1/2$. These correspond to the $1p_{3/2}$ and $1p_{1/2}$ states, respectively.\n\nFor the $1p_{3/2}$ state ($j=3/2$):\n$$\n\\langle \\mathbf{l}\\cdot\\mathbf{s} \\rangle_{j=3/2} = \\frac{1}{2}\\left[\\frac{3}{2}\\left(\\frac{3}{2}+1\\right) - 1(1+1) - \\frac{1}{2}\\left(\\frac{1}{2}+1\\right)\\right] = \\frac{1}{2}\\left[\\frac{15}{4} - 2 - \\frac{3}{4}\\right] = \\frac{1}{2}\\left[\\frac{12}{4} - 2\\right] = \\frac{1}{2}\n$$\nFor the $1p_{1/2}$ state ($j=1/2$):\n$$\n\\langle \\mathbf{l}\\cdot\\mathbf{s} \\rangle_{j=1/2} = \\frac{1}{2}\\left[\\frac{1}{2}\\left(\\frac{1}{2}+1\\right) - 1(1+1) - \\frac{1}{2}\\left(\\frac{1}{2}+1\\right)\\right] = \\frac{1}{2}\\left[\\frac{3}{4} - 2 - \\frac{3}{4}\\right] = -1\n$$\nThe spin–orbit splitting, $\\Delta E_{\\mathrm{so}}$, is the difference in energy between the $1p_{1/2}$ and $1p_{3/2}$ single-particle levels. The empirical data for hole states in $^{15}\\mathrm{N}$ and $^{15}\\mathrm{O}$ show that the $3/2^-$ state has a higher energy than the $1/2^-$ ground state. The energy of a hole state is the negative of the corresponding single-particle binding energy, $E_{\\text{hole}}(nl_j) = -\\epsilon_{nl_j}$. Thus, $E(3/2^- \\text{hole}) > E(1/2^- \\text{hole})$ implies $-\\epsilon_{1p_{3/2}} > -\\epsilon_{1p_{1/2}}$, which means $\\epsilon_{1p_{3/2}}  \\epsilon_{1p_{1/2}}$. The $1p_{3/2}$ single-particle state is more deeply bound. The splitting is therefore $\\Delta E_{\\mathrm{so}} = \\epsilon_{1p_{1/2}} - \\epsilon_{1p_{3/2}}$.\n\nThe theoretical splitting is the difference between the energy shifts:\n$$\n\\Delta E_{\\mathrm{so}} = \\Delta E_{1p_{1/2}} - \\Delta E_{1p_{3/2}} = W_{\\mathrm{so}} \\left\\langle \\frac{1}{r}\\frac{df}{dr} \\right\\rangle_{1p} \\left[ \\langle \\mathbf{l}\\cdot\\mathbf{s} \\rangle_{j=1/2} - \\langle \\mathbf{l}\\cdot\\mathbf{s} \\rangle_{j=3/2} \\right]\n$$\nSubstituting the values for the angular factors:\n$$\n\\Delta E_{\\mathrm{so}} = W_{\\mathrm{so}} \\left\\langle \\frac{1}{r}\\frac{df}{dr} \\right\\rangle_{1p} \\left[ (-1) - \\left(\\frac{1}{2}\\right) \\right] = -\\frac{3}{2} W_{\\mathrm{so}} \\left\\langle \\frac{1}{r}\\frac{df}{dr} \\right\\rangle_{1p}\n$$\nNext, we evaluate the radial part using the approximation that the expectation value is equal to the value of the function at the nuclear surface, $r=R$. The Woods–Saxon form factor is $f(r) = \\bigl[1+\\exp((r-R)/a)\\bigr]^{-1}$. Its derivative with respect to $r$ is:\n$$\n\\frac{d}{dr}f(r) = -\\left[1+\\exp\\left(\\frac{r-R}{a}\\right)\\right]^{-2} \\cdot \\exp\\left(\\frac{r-R}{a}\\right) \\cdot \\frac{1}{a} = -\\frac{1}{a} \\frac{\\exp\\left((r-R)/a\\right)}{\\left[1+\\exp\\left((r-R)/a\\right)\\right]^2}\n$$\nThe radial term is $\\frac{1}{r}\\frac{d}{dr}f(r)$. Evaluating this at $r=R$:\n$$\n\\left. \\frac{1}{r}\\frac{d}{dr}f(r) \\right|_{r=R} = \\frac{1}{R} \\left( -\\frac{1}{a} \\frac{\\exp(0)}{[1+\\exp(0)]^2} \\right) = -\\frac{1}{aR} \\frac{1}{(1+1)^2} = -\\frac{1}{4aR}\n$$\nUsing this approximation, $\\langle \\frac{1}{r}\\frac{df}{dr} \\rangle_{1p} \\approx -\\frac{1}{4aR}$. Substituting this into the expression for the splitting:\n$$\n\\Delta E_{\\mathrm{so}} \\approx -\\frac{3}{2} W_{\\mathrm{so}} \\left( -\\frac{1}{4aR} \\right) = \\frac{3W_{\\mathrm{so}}}{8aR}\n$$\nWe can solve this for $W_{\\mathrm{so}}$:\n$$\nW_{\\mathrm{so}} = \\frac{8aR}{3} \\Delta E_{\\mathrm{so}}\n$$\nNow we use the provided numerical values. The empirical splitting is the average of the two measured excitation energies:\n$$\n\\Delta E_{\\mathrm{so}}^{\\mathrm{exp}} = \\frac{6.324\\,\\mathrm{MeV} + 6.176\\,\\mathrm{MeV}}{2} = \\frac{12.500\\,\\mathrm{MeV}}{2} = 6.250\\,\\mathrm{MeV}\n$$\nThe nuclear radius $R$ is given by $R=r_{0}A^{1/3}$. With $A=16$ and $r_0 = 1.25\\,\\mathrm{fm}$:\n$$\nR = (1.25\\,\\mathrm{fm}) \\cdot (16)^{1/3}\n$$\nThe other parameters are $a=0.65\\,\\mathrm{fm}$. We can now calculate $W_{\\mathrm{so}}$:\n$$\nW_{\\mathrm{so}} = \\frac{8 \\cdot (0.65\\,\\mathrm{fm}) \\cdot (1.25\\,\\mathrm{fm} \\cdot 16^{1/3})}{3} \\cdot (6.250\\,\\mathrm{MeV})\n$$\n$$\nW_{\\mathrm{so}} = \\frac{8 \\cdot 0.65 \\cdot 1.25 \\cdot 6.250}{3} \\cdot 16^{1/3} \\,\\, \\mathrm{MeV\\,fm^2}\n$$\nLet's calculate the numerical prefactor:\n$$\n\\frac{8 \\cdot 0.65 \\cdot 1.25 \\cdot 6.250}{3} = \\frac{5.2 \\cdot 1.25 \\cdot 6.250}{3} = \\frac{6.5 \\cdot 6.250}{3} = \\frac{40.625}{3}\n$$\nNow, including the factor of $16^{1/3}$:\n$$\nW_{\\mathrm{so}} = \\frac{40.625}{3} \\cdot (16)^{1/3} \\,\\, \\mathrm{MeV\\,fm^2} \\approx 13.54167 \\cdot 2.51984 \\,\\, \\mathrm{MeV\\,fm^2} \\approx 34.1229 \\,\\, \\mathrm{MeV\\,fm^2}\n$$\nRounding the result to three significant figures, we obtain the estimated value for the effective spin–orbit strength.\n$$\nW_{\\mathrm{so}} \\approx 34.1\\,\\mathrm{MeV\\,fm^2}\n$$\nThe positive sign for $W_{\\mathrm{so}}$ is required by the given form of the potential $U_{\\mathrm{so}}(r)$ to ensure that the combination $W_{\\mathrm{so}} \\frac{df}{dr}$ is negative, which correctly places the $j=l+1/2$ state at a lower energy.",
            "answer": "$$\n\\boxed{34.1}\n$$"
        },
        {
            "introduction": "Moving from analytical estimates to a full numerical solution, this practice represents a core task in computational nuclear physics. You will implement two standard methods to solve the radial Schrödinger equation that includes the spin-orbit potential, allowing for a precise calculation of energy splittings. This exercise  emphasizes the critical importance of convergence testing, teaching you to assess how numerical choices like grid spacing, box size, and basis truncation impact the accuracy and reliability of your results.",
            "id": "3607694",
            "problem": "You are to implement a computational study of the sensitivity of single-particle spin-orbit splittings in a spherical nucleus to numerical discretization and boundary conditions. The target system is a single nucleon moving in a spherical mean-field potential composed of a central Woods–Saxon term and an empirical spin-orbit term. Your program must compute energy splittings between the doublet with total angular momentum $j=l+\\tfrac{1}{2}$ and $j=l-\\tfrac{1}{2}$ for a fixed orbital angular momentum $l=1$ (the $p$ shell), and must perform convergence tests that exercise grid spacing, box size, and basis truncation sensitivity.\n\nStart from the nonrelativistic radial Schrödinger equation for the reduced radial wave function $u_{nlj}(r)$ in a spherically symmetric mean field,\n$$\n\\left[-\\frac{\\hbar^2}{2m}\\frac{d^2}{dr^2} + \\frac{\\hbar^2}{2m}\\frac{l(l+1)}{r^2} + V_c(r) + V_{\\mathrm{so}}(r)\\,\\langle \\mathbf{l}\\cdot \\mathbf{s}\\rangle_{lj} \\right] u_{nlj}(r) = E_{nlj}\\,u_{nlj}(r),\n$$\nwith boundary conditions $u_{nlj}(0)=0$ and $u_{nlj}(R_{\\max})=0$ in a spherical box of radius $R_{\\max}$. Here $m$ is the nucleon mass, $\\hbar$ is the reduced Planck constant, $l$ is the orbital angular momentum, $j$ is the total angular momentum, and $\\langle \\mathbf{l}\\cdot \\mathbf{s}\\rangle_{lj}$ denotes the eigenvalue of the spin-orbit operator for the given $l$ and $j$:\n$$\n\\langle \\mathbf{l}\\cdot \\mathbf{s}\\rangle_{l,j=l+\\tfrac{1}{2}} = \\frac{l}{2}, \\quad\n\\langle \\mathbf{l}\\cdot \\mathbf{s}\\rangle_{l,j=l-\\tfrac{1}{2}} = -\\frac{l+1}{2},\n$$\nfor spin $s=\\tfrac{1}{2}$. The central Woods–Saxon potential is\n$$\nV_c(r) = -V_0\\,f(r), \\quad f(r)=\\frac{1}{1+\\exp\\left(\\frac{r-R}{a}\\right)},\n$$\nwith radius $R=r_0 A^{1/3}$, mass number $A$, geometrical parameter $r_0$, diffuseness $a$, and depth $V_0  0$. The empirical spin-orbit radial factor is taken as\n$$\nV_{\\mathrm{so}}(r) = W_{\\mathrm{so}}\\,g(r),\\quad g(r)=\\frac{1}{r}\\frac{df}{dr}=-\\frac{1}{a\\,r} f(r)\\left[1-f(r)\\right],\n$$\nwhere $W_{\\mathrm{so}}$ is the spin-orbit strength. Use the standard nuclear kinetic coefficient\n$$\n\\frac{\\hbar^2}{2m} = 20.735\\ \\text{MeV}\\cdot\\text{fm}^2.\n$$\n\nImplement two numerical approaches:\n\n1. A finite-difference discretization on a uniform radial grid $r_i=i\\,h$ for $i=1,\\dots,N$, with step $h=\\frac{R_{\\max}}{N+1}$. Approximate the second derivative by the three-point stencil and enforce Dirichlet boundary conditions at $r=0$ and $r=R_{\\max}$. Construct the Hamiltonian matrix for a fixed $l$ and each $j$ value, and compute the lowest bound-state energy $E_{n=1,l=1,j}$ for each $j$ using a symmetric sparse eigensolver. Define the spin-orbit splitting as\n$$\n\\Delta E = E_{n=1,l=1,j=l-\\tfrac{1}{2}} - E_{n=1,l=1,j=l+\\tfrac{1}{2}}\\ \\ \\text{(in MeV)}.\n$$\n\n2. A Rayleigh–Ritz basis-projection method in the same spherical box: first diagonalize the kinetic-plus-centrifugal operator\n$$\nK = -\\frac{\\hbar^2}{2m}\\frac{d^2}{dr^2} + \\frac{\\hbar^2}{2m}\\frac{l(l+1)}{r^2}\n$$\non the same finite-difference grid and keep the $N_{\\mathrm{basis}}$ lowest eigenvectors as an orthonormal basis $\\{\\phi_\\alpha(r)\\}_{\\alpha=1}^{N_{\\mathrm{basis}}}$. Then project the full Hamiltonian $H=K+V_c(r)+V_{\\mathrm{so}}(r)\\,\\langle \\mathbf{l}\\cdot \\mathbf{s}\\rangle_{lj}$ onto this subspace, diagonalize the resulting $N_{\\mathrm{basis}}\\times N_{\\mathrm{basis}}$ matrix, and extract the lowest energy $E_{n=1,l=1,j}$ for each $j$ to obtain $\\Delta E$.\n\nUse the following physically reasonable parameters: $A=40$, $r_0=1.25\\ \\text{fm}$, so $R=r_0 A^{1/3}$, $a=0.65\\ \\text{fm}$, $V_0=50\\ \\text{MeV}$, and $W_{\\mathrm{so}}=110\\ \\text{MeV}\\cdot\\text{fm}^2$. Fix $l=1$ throughout and measure all energies in $\\text{MeV}$.\n\nDesign convergence tests that exercise:\n\n- Grid spacing sensitivity: vary $N$ with fixed $R_{\\max}$.\n- Box size sensitivity: vary $R_{\\max}$ while keeping a fine grid.\n- Basis truncation sensitivity: vary $N_{\\mathrm{basis}}$ at fixed fine grid and box.\n\nYour program must compute $\\Delta E$ for each of the following test cases and aggregate the results in the specified output format:\n\n- Case $1$ (finite-difference, happy path): method finite-difference, $N=800$, $R_{\\max}=20\\ \\text{fm}$.\n- Case $2$ (finite-difference, coarse grid): method finite-difference, $N=80$, $R_{\\max}=20\\ \\text{fm}$.\n- Case $3$ (finite-difference, small box): method finite-difference, $N=400$, $R_{\\max}=10\\ \\text{fm}$.\n- Case $4$ (finite-difference, large box): method finite-difference, $N=1200$, $R_{\\max}=30\\ \\text{fm}$.\n- Case $5$ (basis projection, very small basis): method basis, $N=800$, $R_{\\max}=20\\ \\text{fm}$, $N_{\\mathrm{basis}}=6$.\n- Case $6$ (basis projection, moderate basis): method basis, $N=800$, $R_{\\max}=20\\ \\text{fm}$, $N_{\\mathrm{basis}}=20$.\n- Case $7$ (basis projection, larger basis): method basis, $N=800$, $R_{\\max}=20\\ \\text{fm}$, $N_{\\mathrm{basis}}=40$.\n\nAngle quantities do not appear; no angle units are needed. Express each computed splitting $\\Delta E$ in $\\text{MeV}$ as a decimal float. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, ordered as $[ \\text{Case 1}, \\text{Case 2}, \\dots, \\text{Case 7} ]$. Round each entry to three decimal places. No input should be read; all parameters are hardcoded from this specification.",
            "solution": "The problem is valid as it presents a well-posed, scientifically grounded exercise in computational nuclear physics. It specifies a clear physical model (the nuclear shell model with Woods-Saxon and spin-orbit potentials), provides all necessary parameters, and defines concrete numerical tasks that are both feasible and standard in the field. The objectives are to implement two recognized numerical methods—the finite-difference method and the basis-projection (Rayleigh-Ritz) method—to solve the radial Schrödinger equation and to study the convergence properties of the solution.\n\nThe core of the problem is to solve the time-independent, one-dimensional radial Schrödinger equation for a nucleon of mass $m$ in a spherically symmetric potential:\n$$\n\\left[-\\frac{\\hbar^2}{2m}\\frac{d^2}{dr^2} + V_{\\mathrm{eff}}(r) \\right] u_{nlj}(r) = E_{nlj}\\,u_{nlj}(r)\n$$\nwhere $u_{nlj}(r)$ is the reduced radial wave function. The effective potential, $V_{\\mathrm{eff}}(r)$, includes the centrifugal term, the central potential $V_c(r)$, and the spin-orbit potential $V_{\\mathrm{so}}(r)$. The equation is solved within a spherical box of radius $R_{\\max}$, imposing Dirichlet boundary conditions $u_{nlj}(0)=0$ and $u_{nlj}(R_{\\max})=0$.\n\nThe effective potential depends on the total angular momentum $j$ through the spin-orbit term:\n$$\nV_{\\mathrm{eff}, lj}(r) = \\frac{\\hbar^2}{2m}\\frac{l(l+1)}{r^2} + V_c(r) + V_{\\mathrm{so}}(r)\\,\\langle \\mathbf{l}\\cdot \\mathbf{s}\\rangle_{lj}\n$$\nThe quantum number for orbital angular momentum is fixed at $l=1$. For a nucleon with spin $s=\\frac{1}{2}$, the total angular momentum $j$ can be $j=l+\\frac{1}{2}=\\frac{3}{2}$ or $j=l-\\frac{1}{2}=\\frac{1}{2}$. The corresponding eigenvalues of the spin-orbit operator $\\mathbf{l}\\cdot\\mathbf{s}$ are:\n$$\n\\langle \\mathbf{l}\\cdot \\mathbf{s}\\rangle_{l=1, j=3/2} = \\frac{l}{2} = \\frac{1}{2}\n$$\n$$\n\\langle \\mathbf{l}\\cdot \\mathbf{s}\\rangle_{l=1, j=1/2} = -\\frac{l+1}{2} = -1\n$$\nThe central and spin-orbit potentials are given by the Woods-Saxon form and its derivative, respectively:\n$$\nV_c(r) = -V_0 f(r) \\quad \\text{and} \\quad V_{\\mathrm{so}}(r) = W_{\\mathrm{so}} \\frac{1}{r} \\frac{df}{dr}\n$$\nwhere $f(r) = [1+\\exp((r-R)/a)]^{-1}$. The parameters $V_0, W_{\\mathrm{so}}, a, R$ are specified, with $R=r_0 A^{1/3}$ for mass number $A=40$.\n\nTo solve this eigenvalue problem numerically, we discretize the radial coordinate on a uniform grid $r_i = i \\cdot h$ for $i=1, \\dots, N$, where $h=R_{\\max}/(N+1)$ is the step size. The wave function $u(r)$ becomes a vector $\\mathbf{u}$ with components $u_i = u(r_i)$. The differential operator is replaced by a finite-difference approximation. Specifically, the second derivative is approximated using a three-point central difference stencil:\n$$\n\\frac{d^2u}{dr^2}\\bigg|_{r_i} \\approx \\frac{u(r_{i+1}) - 2u(r_i) + u(r_{i-1})}{h^2} = \\frac{u_{i+1} - 2u_i - u_{i-1}}{h^2}\n$$\nThe boundary conditions $u(0)=u_0=0$ and $u(R_{\\max})=u_{N+1}=0$ are incorporated into the equations for $i=1$ and $i=N$. This transforms the Schrödinger differential equation into a matrix eigenvalue equation, $\\mathbf{H}\\mathbf{u} = E\\mathbf{u}$.\n\n**Method 1: Finite-Difference Method (FDM)**\nIn the FDM approach, the Hamiltonian operator is directly represented as an $N \\times N$ matrix $\\mathbf{H}$ on the grid. The kinetic energy operator forms a tridiagonal matrix, and the potential energy operator forms a diagonal matrix. The full Hamiltonian matrix $\\mathbf{H}$ is therefore a symmetric, tridiagonal matrix with elements:\n$$\nH_{ii} = \\frac{\\hbar^2}{2m}\\left(\\frac{2}{h^2} + \\frac{l(l+1)}{r_i^2}\\right) + V_{\\mathrm{eff}, lj}(r_i)\n$$\n$$\nH_{i, i\\pm1} = -\\frac{\\hbar^2}{2m}\\frac{1}{h^2}\n$$\nWe construct two such matrices, one for $j=\\frac{3}{2}$ and one for $j=\\frac{1}{2}$, denoted $\\mathbf{H}_{j=3/2}$ and $\\mathbf{H}_{j=1/2}$. The lowest eigenvalue of each matrix corresponds to the ground state energy $E_{n=1,l=1,j}$. These are found using a symmetric sparse eigensolver, specifically `scipy.sparse.linalg.eigsh`, which is efficient for finding a few eigenvalues of large, sparse matrices. The spin-orbit splitting is then computed as $\\Delta E = E_{n=1,l=1,j=1/2} - E_{n=1,l=1,j=3/2}$.\n\n**Method 2: Basis Projection Method (Rayleigh-Ritz)**\nThis method employs the variational principle. We first define a suitable basis of functions and then project the full Hamiltonian onto the subspace spanned by these basis functions. A convenient and systematically improvable basis is formed by the eigenvectors of a simpler, solvable part of the Hamiltonian. Here, we use the eigenvectors of the kinetic-plus-centrifugal operator, $\\mathbf{K} = \\mathbf{T} + \\mathbf{V}_{\\mathrm{centrifugal}}$, discretized on the same grid as in FDM.\n1.  Construct the matrix $\\mathbf{K}$ on the grid. This is a symmetric tridiagonal matrix.\n2.  Diagonalize $\\mathbf{K}$ to obtain its eigenvalues $\\epsilon_\\alpha$ and corresponding eigenvectors $\\{\\vec{\\phi}_\\alpha\\}$. The eigenvectors are discretized wave functions that are solutions to the particle-in-a-box problem with a centrifugal barrier.\n3.  We truncate this basis, keeping the $N_{\\mathrm{basis}}$ eigenvectors corresponding to the lowest kinetic energies. These form an orthonormal basis $\\{\\vec{\\phi}_\\alpha\\}_{\\alpha=1}^{N_{\\mathrm{basis}}}$. Let the matrix of these basis vectors be $\\mathbf{U}$, of size $N \\times N_{\\mathrm{basis}}$.\n4.  The full Hamiltonian matrix is then constructed in this basis. The matrix elements are $H'_{\\alpha\\beta} = \\langle \\phi_\\alpha | H | \\phi_\\beta \\rangle$. Since the basis vectors are eigenvectors of $\\mathbf{K}$, the kinetic part of $\\mathbf{H'}$ is diagonal: $\\langle \\phi_\\alpha | K | \\phi_\\beta \\rangle = \\epsilon_\\alpha \\delta_{\\alpha\\beta}$. The potential part is not diagonal and its matrix elements are computed by projection:\n    $$\n    V'_{\\alpha\\beta} = \\langle \\phi_\\alpha | V_c + V_{\\mathrm{so}}\\langle \\mathbf{l}\\cdot\\mathbf{s}\\rangle | \\phi_\\beta \\rangle = \\sum_{i=1}^N \\phi_\\alpha(r_i) \\left( V_c(r_i) + V_{\\mathrm{so}}(r_i)\\langle \\mathbf{l}\\cdot\\mathbf{s}\\rangle \\right) \\phi_\\beta(r_i)\n    $$\n    In matrix form, if $\\mathbf{V}_{\\mathrm{diag}}$ is a diagonal matrix of potential values on the grid, the projected potential matrix is $\\mathbf{V'} = \\mathbf{U}^T \\mathbf{V}_{\\mathrm{diag}} \\mathbf{U}$.\n5.  The resulting Hamiltonian matrix $\\mathbf{H'}$ is an $N_{\\mathrm{basis}} \\times N_{\\mathrm{basis}}$ dense symmetric matrix. We diagonalize it to find its eigenvalues, the lowest of which approximates the ground state energy.\nThis procedure is performed for both $j=\\frac{3}{2}$ and $j=\\frac{1}{2}$ to obtain the respective energies and the splitting $\\Delta E$. The accuracy of this method is determined by the size of the basis, $N_{\\mathrm{basis}}$.\n\nThe implementation will process seven test cases, varying the numerical parameters ($N, R_{\\max}, N_{\\mathrm{basis}}$) to demonstrate the convergence properties of both methods.",
            "answer": "```python\nimport numpy as np\nfrom scipy.sparse import diags\nfrom scipy.sparse.linalg import eigsh\nfrom scipy.linalg import eigh_tridiagonal, eigh\n\ndef solve_fdm(N, R_max, params):\n    \"\"\"\n    Solves the radial Schrödinger equation using the finite-difference method.\n    \"\"\"\n    C, V0, a, R, Wso, l, ls_vals = params.values()\n\n    h = R_max / (N + 1.0)\n    r = np.arange(1, N + 1) * h\n\n    # Kinetic and centrifugal terms\n    diag_T = C * (2.0 / h**2 + l * (l + 1) / r**2)\n    offdiag_T = -C / h**2 * np.ones(N - 1)\n\n    # Potential terms\n    f_r = 1.0 / (1.0 + np.exp((r - R) / a))\n    Vc_r = -V0 * f_r\n    g_r = -(1.0 / (a * r)) * f_r * (1.0 - f_r)\n    Vso_r = Wso * g_r\n\n    energies = {}\n    for j_str, ls_val in ls_vals.items():\n        V_total_r = Vc_r + Vso_r * ls_val\n        H_diag = diag_T + V_total_r\n        \n        # Using eigsh for sparse symmetric matrices is efficient for finding a few eigenvalues.\n        # We need the one with the smallest (most negative) algebraic value.\n        H_matrix = diags([offdiag_T, H_diag, offdiag_T], [-1, 0, 1], shape=(N, N), format='csr')\n        eigenvalues, _ = eigsh(H_matrix, k=1, which='SA')\n        energies[j_str] = eigenvalues[0]\n\n    delta_E = energies['j_half'] - energies['j_three_halfs']\n    return delta_E\n\ndef solve_basis(N, R_max, N_basis, params):\n    \"\"\"\n    Solves the radial Schrödinger equation using the basis projection method.\n    \"\"\"\n    C, V0, a, R, Wso, l, ls_vals = params.values()\n\n    h = R_max / (N + 1.0)\n    r = np.arange(1, N + 1) * h\n\n    # 1. Construct and diagonalize the kinetic operator K to get the basis.\n    diag_K = C * (2.0 / h**2 + l * (l + 1) / r**2)\n    offdiag_K = -C / h**2 * np.ones(N - 1)\n    \n    # eigh_tridiagonal is highly optimized for this task.\n    K_eigvals, K_eigvecs = eigh_tridiagonal(diag_K, offdiag_K)\n\n    # 2. Truncate the basis. Eigenvalues/vectors are sorted from lowest to highest.\n    basis_kinetic_energies = K_eigvals[:N_basis]\n    basis_vectors = K_eigvecs[:, :N_basis]\n\n    # 3. Construct potential matrices in the new basis.\n    f_r = 1.0 / (1.0 + np.exp((r - R) / a))\n    Vc_r = -V0 * f_r\n    g_r = -(1.0 / (a * r)) * f_r * (1.0 - f_r)\n    Vso_r = Wso * g_r\n\n    # Project potentials onto the basis: V' = U^T * V_diag * U\n    # This is computed efficiently without forming the large diagonal matrix V_diag.\n    V_prime_c = basis_vectors.T @ (Vc_r[:, np.newaxis] * basis_vectors)\n    V_prime_so = basis_vectors.T @ (Vso_r[:, np.newaxis] * basis_vectors)\n\n    energies = {}\n    for j_str, ls_val in ls_vals.items():\n        # 4. Construct the full Hamiltonian H' in the basis.\n        H_prime = np.diag(basis_kinetic_energies) + V_prime_c + V_prime_so * ls_val\n\n        # 5. Diagonalize the small N_basis x N_basis matrix H'.\n        eigenvalues = eigh(H_prime, eigvals_only=True)\n        energies[j_str] = eigenvalues[0]\n\n    delta_E = energies['j_half'] - energies['j_three_halfs']\n    return delta_E\n\ndef solve():\n    \"\"\"\n    Main driver function to run all test cases and print results.\n    \"\"\"\n    # Physical parameters\n    A = 40.0\n    r0 = 1.25  # fm\n    R = r0 * A**(1.0/3.0)\n    a = 0.65  # fm\n    V0 = 50.0  # MeV\n    Wso = 110.0  # MeV fm^2\n    hbar2_over_2m = 20.735  # MeV fm^2\n    l = 1\n    \n    # j = l +/- 1/2 - j=3/2, j=1/2\n    # l.s = l/2 for j=l+1/2, -(l+1)/2 for j=l-1/2\n    ls_vals = {'j_three_halfs': l / 2.0, 'j_half': -(l + 1) / 2.0}\n\n    params = {\n        'hbar2_over_2m': hbar2_over_2m,\n        'V0': V0, 'a': a, 'R': R, 'Wso': Wso,\n        'l': l, 'ls_vals': ls_vals,\n    }\n\n    # Test cases from the problem statement\n    test_cases = [\n        {'method': 'finite-difference', 'N': 800,  'R_max': 20.0}, # Case 1\n        {'method': 'finite-difference', 'N': 80,   'R_max': 20.0}, # Case 2\n        {'method': 'finite-difference', 'N': 400,  'R_max': 10.0}, # Case 3\n        {'method': 'finite-difference', 'N': 1200, 'R_max': 30.0}, # Case 4\n        {'method': 'basis', 'N': 800, 'R_max': 20.0, 'N_basis': 6},  # Case 5\n        {'method': 'basis', 'N': 800, 'R_max': 20.0, 'N_basis': 20}, # Case 6\n        {'method': 'basis', 'N': 800, 'R_max': 20.0, 'N_basis': 40}, # Case 7\n    ]\n\n    results = []\n    for case in test_cases:\n        if case['method'] == 'finite-difference':\n            delta_E = solve_fdm(case['N'], case['R_max'], params)\n        elif case['method'] == 'basis':\n            delta_E = solve_basis(case['N'], case['R_max'], case['N_basis'], params)\n        \n        results.append(f\"{delta_E:.3f}\")\n\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "This final practice bridges nuclear theory with modern statistical methods, a crucial skill set in contemporary physics research. You will construct a simple Bayesian model to calibrate the parameters of the spin-orbit potential, using experimental data on both energy splittings and nuclear charge radii as constraints. This exercise  demonstrates how theoretical models are quantitatively refined and validated against a diverse set of observational data.",
            "id": "3607732",
            "problem": "You are asked to build a computational calibration model for the nuclear spin-orbit interaction within a spherical mean-field description using a Woods–Saxon central potential and a standard spin–orbit coupling term. The goal is to construct an unnormalized Bayesian posterior from a Gaussian likelihood and Gaussian priors, and then evaluate the negative log-posterior for a set of candidate parameter values. The parameters to be calibrated are the spin–orbit strength and the surface diffuseness.\n\nFundamental base and modeling assumptions:\n\n- The central potential is modeled by a Woods–Saxon form with radius parameter $r_{0}$ and surface diffuseness $a$. The nuclear radius is $R(A) = r_{0} A^{1/3}$, where $A$ is the mass number. Use the fixed value $r_{0} = 1.12\\,\\mathrm{fm}$.\n\n- The spin–orbit term leads to a splitting between the $j = \\ell \\pm \\tfrac{1}{2}$ levels, which scales with $\\langle \\mathbf{\\ell}\\cdot\\mathbf{s} \\rangle$ and with the radial gradient of the central potential. In a reduced model, approximate the predicted $j$-splitting for a given orbital angular momentum $\\ell$ in a nucleus of mass number $A$ by\n$$\n\\Delta E_{\\mathrm{pred}}(A,\\ell; W_{0}, a) = c_{\\mathrm{so}}\\, W_{0}\\, \\frac{2\\ell + 1}{a\\, R(A)},\n$$\nwith $c_{\\mathrm{so}} = 0.018$ dimensionless, $W_{0}$ in $\\mathrm{MeV\\,fm^{2}}$, $a$ in $\\mathrm{fm}$, and $R(A)$ in $\\mathrm{fm}$. This relation encodes the proportionality of the spin–orbit splitting to the difference in $\\langle \\mathbf{\\ell}\\cdot\\mathbf{s} \\rangle$ between the $j=\\ell\\pm\\tfrac{1}{2}$ partners and to the surface gradient scale $1/(a\\,R)$.\n\n- The root-mean-square (RMS) charge radius is modeled by the two-parameter Fermi distribution approximation\n$$\nr_{\\mathrm{rms}}(A, a) = \\sqrt{\\frac{3}{5}\\,R(A)^{2} + \\frac{7}{5}\\,(\\pi a)^{2}},\n$$\nwith $R(A) = r_{0} A^{1/3}$ and $r_{0} = 1.12\\,\\mathrm{fm}$. All radii are in $\\mathrm{fm}$.\n\nData to be used in the likelihood:\n\n- Measured $j$-splittings $\\Delta E_{\\mathrm{exp}}$ in $\\mathrm{MeV}$ with standard deviations $\\sigma_{E}$ in $\\mathrm{MeV}$ for three nuclei and orbitals:\n    1. $A = 16$, $\\ell = 1$, $\\Delta E_{\\mathrm{exp}} = 4.88\\,\\mathrm{MeV}$, $\\sigma_{E} = 0.20\\,\\mathrm{MeV}$.\n    2. $A = 40$, $\\ell = 2$, $\\Delta E_{\\mathrm{exp}} = 6.05\\,\\mathrm{MeV}$, $\\sigma_{E} = 0.20\\,\\mathrm{MeV}$.\n    3. $A = 208$, $\\ell = 4$, $\\Delta E_{\\mathrm{exp}} = 6.21\\,\\mathrm{MeV}$, $\\sigma_{E} = 0.30\\,\\mathrm{MeV}$.\n\n- Measured RMS charge radii $r_{\\mathrm{exp}}$ in $\\mathrm{fm}$ with standard deviations $\\sigma_{r}$ in $\\mathrm{fm}$:\n    1. $A = 16$, $r_{\\mathrm{exp}} = 2.80\\,\\mathrm{fm}$, $\\sigma_{r} = 0.02\\,\\mathrm{fm}$.\n    2. $A = 40$, $r_{\\mathrm{exp}} = 3.44\\,\\mathrm{fm}$, $\\sigma_{r} = 0.02\\,\\mathrm{fm}$.\n    3. $A = 208$, $r_{\\mathrm{exp}} = 5.44\\,\\mathrm{fm}$, $\\sigma_{r} = 0.02\\,\\mathrm{fm}$.\n\nLikelihood and prior:\n\n- Assume independent Gaussian errors. The log-likelihood is the sum over all data of the usual Gaussian log-probability terms. Up to an additive constant, the negative log-likelihood is\n$$\n\\mathcal{L}(W_{0}, a) = \\frac{1}{2}\\sum_{i=1}^{3} \\left( \\frac{\\Delta E_{\\mathrm{pred},i}(W_{0}, a) - \\Delta E_{\\mathrm{exp},i}}{\\sigma_{E,i}} \\right)^{2}\n+ \\frac{1}{2}\\sum_{j=1}^{3} \\left( \\frac{r_{\\mathrm{rms},j}(a) - r_{\\mathrm{exp},j}}{\\sigma_{r,j}} \\right)^{2}.\n$$\n\n- Use independent Gaussian priors (unnormalized) on $W_{0}$ and $a$:\n    - $W_{0} \\sim \\mathcal{N}(\\mu_{W_{0}}, \\sigma_{W_{0}}^{2})$ with $\\mu_{W_{0}} = 120.0\\,\\mathrm{MeV\\,fm^{2}}$ and $\\sigma_{W_{0}} = 40.0\\,\\mathrm{MeV\\,fm^{2}}$.\n    - $a \\sim \\mathcal{N}(\\mu_{a}, \\sigma_{a}^{2})$ with $\\mu_{a} = 0.47\\,\\mathrm{fm}$ and $\\sigma_{a} = 0.08\\,\\mathrm{fm}$.\n  Up to an additive constant, the negative log-prior is\n$$\n\\mathcal{P}(W_{0}, a) = \\frac{1}{2}\\left( \\frac{W_{0} - \\mu_{W_{0}}}{\\sigma_{W_{0}}} \\right)^{2} + \\frac{1}{2}\\left( \\frac{a - \\mu_{a}}{\\sigma_{a}} \\right)^{2}.\n$$\n\n- Impose hard-constraint support reflecting physical plausibility: enforce $W_{0}  0$ and $a \\in [0.40, 0.90]$. Outside this domain, define the negative log-posterior to be a large penalty value $10^{9}$.\n\nPosterior objective:\n\n- The unnormalized negative log-posterior to be evaluated is\n$$\n\\mathcal{J}(W_{0}, a) = \\mathcal{L}(W_{0}, a) + \\mathcal{P}(W_{0}, a),\n$$\nsubject to the constraints above.\n\nProgramming task:\n\n- Implement a program that defines functions for $\\Delta E_{\\mathrm{pred}}(A,\\ell; W_{0}, a)$ and $r_{\\mathrm{rms}}(A,a)$, builds $\\mathcal{J}(W_{0}, a)$ from the data and priors, enforces the hard constraints, and evaluates $\\mathcal{J}$ for each parameter pair in the test suite below.\n\nTest suite of parameter pairs $(W_{0}, a)$:\n\n1. $(120.0, 0.47)$\n2. $(80.0, 0.47)$\n3. $(120.0, 0.65)$\n4. $(-50.0, 0.47)$\n5. $(120.0, 0.40)$\n\nAll energies must be treated in $\\mathrm{MeV}$ and all lengths in $\\mathrm{fm}$. The program must produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the same order as the test suite (for example, \"[x1,x2,x3,x4,x5]\"). Each entry must be a floating-point number representing $\\mathcal{J}(W_{0}, a)$ for the corresponding test case. Angles do not appear; no angle unit is required. Percentages do not appear; do not use the percent sign anywhere in the output.",
            "solution": "The problem requires the evaluation of an unnormalized negative log-posterior probability distribution for the parameters of a nuclear spin-orbit interaction model. This is a standard task in Bayesian parameter estimation, where we combine information from experimental data (the likelihood) and prior beliefs about the parameters (the prior) to form a posterior distribution. The objective is to compute the value of this function, denoted $\\mathcal{J}(W_{0}, a)$, for a given set of parameter pairs $(W_{0}, a)$. The parameters to be calibrated are the spin-orbit strength, $W_{0}$, and the nuclear surface diffuseness, $a$.\n\nThe calculation is structured into three principal parts:\n1.  The physical models for the predicted observables: spin-orbit splitting $\\Delta E_{\\mathrm{pred}}$ and root-mean-square (RMS) charge radius $r_{\\mathrm{rms}}$.\n2.  The statistical model, comprising the negative log-likelihood $\\mathcal{L}(W_0, a)$ and the negative log-prior $\\mathcal{P}(W_0, a)$.\n3.  The final objective function $\\mathcal{J}(W_0, a)$, which is the sum of the negative log-likelihood and negative log-prior, subject to physical constraints.\n\nFirst, we define the underlying physical models. The nuclear radius $R(A)$ for a nucleus with mass number $A$ is given by\n$$\nR(A) = r_{0} A^{1/3}\n$$\nwhere the radius parameter is fixed at $r_{0} = 1.12\\,\\mathrm{fm}$.\n\nThe predicted spin-orbit energy splitting, $\\Delta E_{\\mathrm{pred}}$, for an orbital with angular momentum quantum number $\\ell$ in a nucleus of mass number $A$, is modeled by the relation:\n$$\n\\Delta E_{\\mathrm{pred}}(A,\\ell; W_{0}, a) = c_{\\mathrm{so}}\\, W_{0}\\, \\frac{2\\ell + 1}{a\\, R(A)}\n$$\nHere, $c_{\\mathrm{so}} = 0.018$ is a dimensionless constant, $W_{0}$ is the spin-orbit strength in $\\mathrm{MeV\\,fm^{2}}$, and $a$ is the surface diffuseness in $\\mathrm{fm}$.\n\nThe predicted RMS charge radius, $r_{\\mathrm{rms}}$, is given by the two-parameter Fermi distribution approximation:\n$$\nr_{\\mathrm{rms}}(A, a) = \\sqrt{\\frac{3}{5}\\,R(A)^{2} + \\frac{7}{5}\\,(\\pi a)^{2}}\n$$\n\nNext, we construct the statistical components. The problem assumes independent Gaussian errors for all measurements. The negative log-likelihood, $\\mathcal{L}(W_{0}, a)$, quantifies the misfit between model predictions and experimental data. It is the sum of squared residuals, weighted by their respective uncertainties. Given the experimental data for three nuclei, the negative log-likelihood (up to an irrelevant additive constant) is:\n$$\n\\mathcal{L}(W_{0}, a) = \\frac{1}{2}\\sum_{i=1}^{3} \\left( \\frac{\\Delta E_{\\mathrm{pred},i}(W_{0}, a) - \\Delta E_{\\mathrm{exp},i}}{\\sigma_{E,i}} \\right)^{2}\n+ \\frac{1}{2}\\sum_{j=1}^{3} \\left( \\frac{r_{\\mathrm{rms},j}(a) - r_{\\mathrm{exp},j}}{\\sigma_{r,j}} \\right)^{2}\n$$\nThe first sum is over the three energy splitting measurements, and the second sum is over the three RMS radius measurements. Notice that the $\\Delta E_{\\mathrm{pred}}$ term depends on both $W_0$ and $a$, while the $r_{\\mathrm{rms}}$ term depends only on $a$.\n\nThe negative log-prior, $\\mathcal{P}(W_{0}, a)$, encodes our prior knowledge about the parameters. The problem specifies independent Gaussian priors for $W_{0}$ and $a$.\nFor $W_0$, the prior is centered at $\\mu_{W_{0}} = 120.0\\,\\mathrm{MeV\\,fm^{2}}$ with a standard deviation of $\\sigma_{W_{0}} = 40.0\\,\\mathrm{MeV\\,fm^{2}}$.\nFor $a$, the prior is centered at $\\mu_{a} = 0.47\\,\\mathrm{fm}$ with a standard deviation of $\\sigma_{a} = 0.08\\,\\mathrm{fm}$.\nThe corresponding negative log-prior (also up to an additive constant) is:\n$$\n\\mathcal{P}(W_{0}, a) = \\frac{1}{2}\\left( \\frac{W_{0} - \\mu_{W_{0}}}{\\sigma_{W_{0}}} \\right)^{2} + \\frac{1}{2}\\left( \\frac{a - \\mu_{a}}{\\sigma_{a}} \\right)^{2}\n$$\n\nFinally, the unnormalized negative log-posterior, $\\mathcal{J}(W_{0}, a)$, is the sum of the negative log-likelihood and the negative log-prior:\n$$\n\\mathcal{J}(W_{0}, a) = \\mathcal{L}(W_{0}, a) + \\mathcal{P}(W_{0}, a)\n$$\nThis function is evaluated subject to hard constraints reflecting physical plausibility: $W_{0}  0$ and $a \\in [0.40, 0.90]$. If a parameter pair $(W_{0}, a)$ falls outside this allowed domain, the posterior probability is effectively zero, which corresponds to an infinite negative log-posterior. For computational purposes, we assign a large finite penalty value of $10^{9}$ in such cases.\n\nThe algorithmic procedure to evaluate $\\mathcal{J}(W_{0}, a)$ for a given pair of parameters is as follows:\n1.  Accept the input parameters $(W_{0}, a)$.\n2.  Check if the parameters satisfy the constraints $W_{0}  0$ and $0.40 \\le a \\le 0.90$. If not, return the penalty value $10^{9}$.\n3.  If the constraints are met, proceed to calculate the two components of the objective function.\n4.  Calculate the negative log-likelihood $\\mathcal{L}(W_0, a)$:\n    a. Initialize a summation variable for a chi-squared-like quantity, $\\chi^2 = 0$.\n    b. For each of the three energy splitting data points $(A_i, \\ell_i, \\Delta E_{\\mathrm{exp},i}, \\sigma_{E,i})$: calculate $R(A_i)$, then $\\Delta E_{\\mathrm{pred},i}$, and add the squared residual $\\left((\\Delta E_{\\mathrm{pred},i} - \\Delta E_{\\mathrm{exp},i})/\\sigma_{E,i}\\right)^2$ to $\\chi^2$.\n    c. For each of the three RMS radius data points $(A_j, r_{\\mathrm{exp},j}, \\sigma_{r,j})$: calculate $R(A_j)$, then $r_{\\mathrm{rms},j}$, and add the squared residual $\\left((r_{\\mathrm{rms},j} - r_{\\mathrm{exp},j})/\\sigma_{r,j}\\right)^2$ to $\\chi^2$.\n    d. The negative log-likelihood is $\\mathcal{L} = 0.5 \\times \\chi^2$.\n5.  Calculate the negative log-prior $\\mathcal{P}(W_0, a)$:\n    a. Compute the prior term for $W_0$: $P_{W_0} = ((W_0 - \\mu_{W_0}) / \\sigma_{W_0})^2$.\n    b. Compute the prior term for $a$: $P_a = ((a - \\mu_a) / \\sigma_a)^2$.\n    c. The negative log-prior is $\\mathcal{P} = 0.5 \\times (P_{W_0} + P_a)$.\n6.  The final result is the sum $\\mathcal{J} = \\mathcal{L} + \\mathcal{P}$.\n\nThis procedure is then applied to each parameter pair in the provided test suite.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the unnormalized negative log-posterior for a nuclear spin-orbit model\n    for a given set of test parameters.\n    \"\"\"\n\n    # --- Constants and Fixed Parameters ---\n    R0 = 1.12  # fm\n    C_SO = 0.018  # dimensionless\n    PENALTY = 1e9\n\n    # --- Experimental Data ---\n    # Data for j-splittings: [A, l, Delta_E_exp, sigma_E]\n    E_data = np.array([\n        [16, 1, 4.88, 0.20],  # MeV\n        [40, 2, 6.05, 0.20],  # MeV\n        [208, 4, 6.21, 0.30]  # MeV\n    ])\n\n    # Data for RMS charge radii: [A, r_exp, sigma_r]\n    R_data = np.array([\n        [16, 2.80, 0.02],  # fm\n        [40, 3.44, 0.02],  # fm\n        [208, 5.44, 0.02]  # fm\n    ])\n\n    # --- Priors ---\n    # Prior for W0: mean, std\n    MU_W0, SIGMA_W0 = 120.0, 40.0  # MeV*fm^2\n\n    # Prior for a: mean, std\n    MU_A, SIGMA_A = 0.47, 0.08  # fm\n\n    # --- Physical Model Functions ---\n    def nuclear_radius(A):\n        \"\"\"Calculates the nuclear radius R(A).\"\"\"\n        return R0 * np.power(A, 1.0/3.0)\n\n    def delta_E_pred(A, l, W0, a):\n        \"\"\"Calculates the predicted spin-orbit splitting.\"\"\"\n        R_A = nuclear_radius(A)\n        # Handle potential division by zero, although constraints prevent a=0.\n        if a * R_A == 0:\n            return np.inf\n        return C_SO * W0 * (2 * l + 1) / (a * R_A)\n\n    def r_rms_pred(A, a):\n        \"\"\"Calculates the predicted RMS charge radius.\"\"\"\n        R_A = nuclear_radius(A)\n        term1 = (3.0 / 5.0) * R_A**2\n        term2 = (7.0 / 5.0) * (np.pi * a)**2\n        return np.sqrt(term1 + term2)\n\n    # --- Objective Function ---\n    def neg_log_posterior(W0, a):\n        \"\"\"\n        Calculates the unnormalized negative log-posterior J(W0, a).\n        \"\"\"\n        # Step 1: Check hard constraints\n        if not (W0  0 and 0.40 = a = 0.90):\n            return PENALTY\n\n        # Step 2: Calculate negative log-likelihood\n        chi_squared_sum = 0.0\n\n        # Contribution from energy splittings\n        for A, l, E_exp, sigma_E in E_data:\n            E_p = delta_E_pred(A, l, W0, a)\n            chi_squared_sum += ((E_p - E_exp) / sigma_E)**2\n\n        # Contribution from RMS radii\n        for A, r_exp, sigma_r in R_data:\n            r_p = r_rms_pred(A, a)\n            chi_squared_sum += ((r_p - r_exp) / sigma_r)**2\n        \n        neg_log_L = 0.5 * chi_squared_sum\n\n        # Step 3: Calculate negative log-prior\n        prior_term_W0 = ((W0 - MU_W0) / SIGMA_W0)**2\n        prior_term_a = ((a - MU_A) / SIGMA_A)**2\n        neg_log_P = 0.5 * (prior_term_W0 + prior_term_a)\n\n        # Step 4: Return total negative log-posterior\n        return neg_log_L + neg_log_P\n\n    # --- Test Suite Evaluation ---\n    test_cases = [\n        (120.0, 0.47),\n        (80.0, 0.47),\n        (120.0, 0.65),\n        (-50.0, 0.47),\n        (120.0, 0.40)\n    ]\n\n    results = []\n    for W0, a in test_cases:\n        result = neg_log_posterior(W0, a)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}