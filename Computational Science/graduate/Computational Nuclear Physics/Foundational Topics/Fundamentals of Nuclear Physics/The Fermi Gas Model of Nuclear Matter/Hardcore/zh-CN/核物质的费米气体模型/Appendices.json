{
    "hands_on_practices": [
        {
            "introduction": "在深入研究复杂的物理模型之前，掌握该领域的“语言”至关重要，这包括在不同单位制之间进行熟练转换。本练习旨在巩固费米气体模型中的基本关系，同时构建一个稳健的计算工具，用于处理自然单位制和更实用的兆电子伏-费米（$\\mathrm{MeV-fm}$）单位制之间的转换 ()。这是任何严肃的计算核物理工作的基石，能确保我们计算的准确性和物理意义的清晰性。",
            "id": "3599442",
            "problem": "实现一个程序，该程序对理想的无相互作用费米气体核物质模型的自然单位与混合兆电子伏-费米单位之间的单位转换进行基准测试，并验证计算输出的量纲一致性。自然单位的定义是将约化普朗克常数、光速和玻尔兹曼常数设为1，即 $\\hbar=c=k_B=1$。混合兆电子伏-费米单位（MeV-fm）以兆电子伏表示能量和温度，以费米表示长度。您的程序必须使用以下给定的物理常数：约化普朗克常数乘以光速 $\\hbar c = 197.3269804\\,\\mathrm{MeV\\cdot fm}$，以及核子静止质量 $m_N = 939.56542052\\,\\mathrm{MeV}$。由于在自然单位中 $k_B=1$，温度必须通过玻尔兹曼常数作为能量处理，因此温度 $T$ 在两个单位制中都以 $\\mathrm{MeV}$ 为单位。\n\n从相空间计数和经典力学的基本原理出发：\n- 动量空间中的单粒子态计数源于相空间单元体积为 $(2\\pi\\hbar)^3$ 以及动量空间中球体的体积。\n- 零温度下的费米动量 $k_F$ 是通过填充所有单粒子态直至 $k_F$ 来定义的。\n- 数密度 $n$ 是单位体积 $V$ 内的总粒子数。\n- 在非相对论动能极限下，单粒子动能为 $E = p^2/(2m_N)$，其中 $p$ 是动量。\n\n利用这些基本事实，推导、实现并使用所需的关系式来：\n1. 根据给定的费米动量 $k_F$ 和自旋-同位旋简并度 $g$ 计算数密度 $n$。\n2. 根据给定的数密度 $n$ 和 $g$ 计算费米动量 $k_F$。\n3. 根据 $k_F$ 和 $m_N$ 计算零温度费米能 $E_F$。\n4. 根据 $E_F$ 和 $m_N$ 计算 $k_F$。\n5. 对 $n$、$k_F$、$E_F$ 和 $T$ 的所有量进行单位制转换。\n\n您的转换必须从单位定义和常数 $\\hbar c$ 推导得出：\n- 在自然单位中，动量、能量和温度都具有相同的量纲，长度的量纲是能量的倒数。因此，$k_F$ 的单位是 $\\mathrm{MeV}$，$E_F$ 的单位是 $\\mathrm{MeV}$，$T$ 的单位是 $\\mathrm{MeV}$，$n$ 的单位是 $\\mathrm{MeV}^3$。\n- 在 MeV-fm 单位中，$k_F$ 的单位是 $\\mathrm{fm^{-1}}$，$E_F$ 的单位是 $\\mathrm{MeV}$，$T$ 的单位是 $\\mathrm{MeV}$，$n$ 的单位是 $\\mathrm{fm^{-3}}$。\n- 使用 $\\hbar c$ 在长度和能量之间进行转换：$1\\,\\mathrm{fm}^{-1}$ 对应于 $(\\hbar c)\\,\\mathrm{MeV}$，$1\\,\\mathrm{fm}^{-3}$ 对应于 $(\\mathrm{MeV}/\\hbar c)^3$。\n\n量纲一致性验证：\n- 对于每个测试用例，您将获得一个单位制标志、一个在 $n$、$k_F$ 或 $E_F$ 中的已知主要量、一个简并度 $g$ 以及一个以 $\\mathrm{MeV}$ 为单位的温度 $T$。\n- 仅使用上述基本原理，在测试用例的本机单位制中计算出完整的集合 $(n,k_F,E_F,T)$。\n- 将该集合转换为另一单位制，然后再转换回本机单位制。将两个数 $x$ 和 $y$ 的相对偏差定义为\n$$\n\\delta(x,y) \\equiv \\frac{|x-y|}{\\max(1,|x|,|y|)}.\n$$\n- 检查两个条件：(i) 连接 $n$ 和 $k_F$ 的费米气体关系在本机单位制中成立；(ii) 对 $n$、$k_F$、$E_F$ 和 $T$ 中每一个量进行的往返转换偏差都低于容差 $\\epsilon = 10^{-12}$。一个测试用例当且仅当两个条件都满足时才通过。\n\n所有数值输出中使用的单位：数密度 $n$ 以 $\\mathrm{fm^{-3}}$ 或 $\\mathrm{MeV^3}$ 为单位，与所选系统一致；费米动量 $k_F$ 以 $\\mathrm{fm^{-1}}$ 或 $\\mathrm{MeV}$ 为单位，与所选系统一致；费米能 $E_F$ 在两个系统中均以 $\\mathrm{MeV}$ 为单位；温度 $T$ 在两个系统中均以 $\\mathrm{MeV}$ 为单位。\n\n测试套件：\n- 情况1：单位制 MeV-fm，已知主要量 $n = 0.16\\,\\mathrm{fm^{-3}}$，简并度 $g = 4$，温度 $T = 0\\,\\mathrm{MeV}$。\n- 情况2：单位制 MeV-fm，已知主要量 $k_F = 0.05\\,\\mathrm{fm^{-1}}$，简并度 $g = 2$，温度 $T = 5\\,\\mathrm{MeV}$。\n- 情况3：单位制 自然单位，已知主要量 $k_F = 262.444883932\\,\\mathrm{MeV}$，简并度 $g = 4$，温度 $T = 15\\,\\mathrm{MeV}$。该值对应于 $1.33\\,\\mathrm{fm^{-1}}$ 乘以 $\\hbar c$。\n- 情况4：单位制 自然单位，已知主要量 $E_F = 37\\,\\mathrm{MeV}$，简并度 $g = 4$，温度 $T = 1\\,\\mathrm{MeV}$。\n\n您的程序必须：\n- 硬编码上述物理常数和测试套件。\n- 对于每个测试用例，按上述定义计算通过或失败的布尔值。\n- 生成一行输出，包含四个布尔结果，形式为逗号分隔的列表并用方括号括起，例如 `[{\\tt True},{\\tt False},{\\tt True},{\\tt True}]`。\n\n最终打印的输出必须是所描述格式的单行文本。",
            "solution": "该问题要求实现并验证核物质的无相互作用费米气体模型的单位转换。任务涉及推导基本关系式，处理两种不同的单位制（自然单位和MeV-fm单位），并为一组测试用例执行往返转换基准测试。解决方案必须在科学上严谨，在算法上精确。\n\n### 第1部分：费米气体模型的理论框架\n\n我们首先从问题中陈述的原理推导基本方程。该模型假设在零温或非零温下存在一个无相互作用的费米子（核子）气体。\n\n**1.1. 数密度与费米动量**\n\n相空间体积元 $d^3r d^3p$ 内的单粒子态数为 $d^3r d^3p / (2\\pi\\hbar)^3$。对于空间体积为 $V$ 的均匀气体，动量大小不超过 $p$ 的态数是通过对半径为 $p$ 的动量空间球体进行积分得到的：\n$$ N_{states}(p) = \\frac{V}{(2\\pi\\hbar)^3} \\int_0^p 4\\pi p'^2 dp' = \\frac{V \\cdot 4\\pi p^3}{3(2\\pi\\hbar)^3} = \\frac{V p^3}{6\\pi^2\\hbar^3} $$\n核子是费米子，具有一个自旋-同位旋简并因子 $g$。对于对称核物质（质子和中子数量相等，自旋向上和向下），$g=4$。对于纯中子物质，$g=2$。在零温度（$T=0$）下，所有能量低于费米动量 $p_F$ 的态都被填满。因此，总粒子数 $N$ 是 $g$ 乘以能量低于 $p_F$ 的态数：\n$$ N = g \\cdot N_{states}(p_F) = \\frac{g V p_F^3}{6\\pi^2\\hbar^3} $$\n数密度 $n$ 定义为 $n = N/V$。通过代入 $p_F = \\hbar k_F$，其中 $k_F$ 是费米波数（在此上下文中常被称为费米动量），我们得到数密度和费米动量之间的关系：\n$$ n = \\frac{g (\\hbar k_F)^3}{6\\pi^2\\hbar^3} = \\frac{g k_F^3}{6\\pi^2} $$\n只要 $n$ 和 $k_F$ 的单位一致，这个方程在任何单位制下都成立。反转这个关系，我们可以从给定的 $n$ 计算出 $k_F$：\n$$ k_F = \\left( \\frac{6\\pi^2 n}{g} \\right)^{1/3} $$\n\n**1.2. 费米能与费米动量**\n\n问题指定了质量为 $m_N$、动量为 $p$ 的核子动能的非相对论近似：$E = p^2 / (2m_N)$。费米能 $E_F$ 是位于费米面上的核子，即动量为 $p_F = \\hbar k_F$ 的核子的动能。\n$$ E_F = \\frac{p_F^2}{2m_N} = \\frac{(\\hbar k_F)^2}{2m_N} $$\n这个关系允许从 $k_F$ 计算 $E_F$。从 $E_F$ 计算 $k_F$ 的逆关系是：\n$$ k_F = \\frac{\\sqrt{2m_N E_F}}{\\hbar} $$\n温度 $T$ 以能量单位（MeV）给出，这与玻尔兹曼常数 $k_B=1$ 的自然单位约定一致。\n\n### 第2部分：单位制与转换\n\n正确处理单位至关重要。问题定义了两种单位制和转换因子 $\\hbar c = 197.3269804\\,\\mathrm{MeV\\cdot fm}$。我们将此常数表示为 $HC$。核子质量 $m_N$ 以 MeV 为单位给出，代表 $m_N c^2 = 939.56542052\\,\\mathrm{MeV}$。\n\n**2.1. MeV–fm 单位**\n这是一个混合单位制，在核物理计算中很实用。\n-   长度：费米（fm）\n-   能量/温度：兆电子伏（MeV）\n-   数密度 $n$：$\\mathrm{fm^{-3}}$\n-   费米动量 $k_F$：$\\mathrm{fm^{-1}}$\n-   费米能 $E_F$：$\\mathrm{MeV}$\n\n在这个单位制中，$\\hbar$ 不为1。$E_F$ 的公式必须明确包含 $\\hbar$。为了保持正确的量纲，我们将 $\\hbar$ 表示为 $\\hbar c / c$：$\\hbar = \\hbar c / c$。能量方程变为 $E_F = (\\hbar c)^2 k_F^2 / (2 m_N c^2)$。使用 $m_N$ 表示静止能量 $m_N c^2$，实用的公式是：\n$$ E_F = \\frac{(HC)^2 k_F^2}{2 m_N} $$\n相应的逆关系是：\n$$ k_F = \\frac{\\sqrt{2m_N E_F}}{HC} $$\n关系式 $n = g k_F^3 / (6\\pi^2)$ 仍然有效，因为其分量在此单位制中量纲一致。\n\n**2.2. 自然单位**\n在这个单位制中，$\\hbar=c=k_B=1$。所有量（能量、质量、动量、长度的倒数）都用单一单位表示，我们取为 MeV。\n-   长度：$\\mathrm{MeV^{-1}}$\n-   能量/温度：$\\mathrm{MeV}$\n-   数密度 $n$：$\\mathrm{MeV^{3}}$\n-   费米动量 $k_F$：$\\mathrm{MeV}$\n-   费米能 $E_F$：$\\mathrm{MeV}$\n\n由于 $\\hbar=1$，关系式简化为：\n$$ n = \\frac{g k_F^3}{6\\pi^2} $$\n$$ E_F = \\frac{k_F^2}{2m_N} $$\n$$ k_F = \\sqrt{2m_N E_F} $$\n\n**2.3. 转换公式**\n常数 $HC$ 提供了桥梁：$1 = \\frac{HC}{\\mathrm{MeV \\cdot fm}}$，这意味着 $1\\,\\mathrm{fm}^{-1} = HC\\,\\mathrm{MeV}$。\n让 MeV-fm 单位中的量用下标 $M$ 表示，自然单位中的量用下标 $N$ 表示。\n\n-   **动量 ($k_F$)**：\n    $k_{F, M} \\,[\\mathrm{fm}^{-1}]$ 变为 $k_{F, N} \\,[\\mathrm{MeV}]$。转换关系为 $k_{F, N} = k_{F, M} \\cdot HC$。\n-   **数密度 ($n$)**：\n    $n_{M} \\,[\\mathrm{fm}^{-3}]$ 变为 $n_{N} \\,[\\mathrm{MeV^3}]$。由于 $1\\,\\mathrm{fm}^{-3} \\leftrightarrow (HC\\,\\mathrm{MeV})^3$，转换关系为 $n_N = n_M \\cdot (HC)^3$。\n-   **能量 ($E_F$) 和温度 ($T$)**：\n    这些量在两种单位制中都以 MeV 为单位，所以不需要转换：$E_{F, N} = E_{F, M}$ 和 $T_N = T_M$。\n\n### 第3部分：验证算法\n\n对于每个测试用例，我们执行一系列计算来确定一个布尔型的通过/失败结果。\n\n**3.1. 本机单位制下的计算**\n给定一个主要量（$n$、$k_F$ 或 $E_F$），我们计算另外两个量，以在测试用例的本机单位制中建立一个完整的集合 $(n, k_F, E_F, T)$。根据单位制，使用第2.1节或第2.2节的公式。\n\n**3.2. 物理关系验证**\n问题要求检查费米气体关系对于计算出的集合是否成立。这可作为我们计算的自洽性检验。我们验证两个关系：\n1.  $n$ 和 $k_F$ 之间的关系：我们计算一个检查值 $n_{check} = g k_F^3 / (6\\pi^2)$，并验证相对偏差 $\\delta(n, n_{check})$ 小于容差 $\\epsilon = 10^{-12}$。\n2.  $E_F$ 和 $k_F$ 之间的关系：我们使用适合该单位制的公式从 $k_F$ 计算 $E_{F, check}$，并验证 $\\delta(E_F, E_{F, check})  \\epsilon$。\n只有当两个检查都满足时，测试用例才通过此阶段。偏差函数定义为：\n$$ \\delta(x,y) \\equiv \\frac{|x-y|}{\\max(1,|x|,|y|)} $$\n\n**3.3. 往返转换与偏差检查**\n将量集 $(n, k_F, E_F, T)$ 从其本机单位制转换为另一单位制，然后立即转换回来。理论上，这次往返应恢复原始值。浮点运算可能会引入微小的误差。我们检查这些误差是否可以忽略不计。\n1.  **转换**：应用第2.3节的转换公式，将本机集合转换为备用单位制。\n2.  **转换回来**：应用逆转换公式返回到本机单位制。\n3.  **检查偏差**：对于四个量（$n, k_F, E_F, T$）中的每一个，计算原始本机值和往返值之间的相对偏差 $\\delta$。\n只有当所有四个偏差都低于容差 $\\epsilon = 10^{-12}$ 时，测试用例才通过此阶段。\n\n**3.4. 最终裁决**\n一个测试用例当且仅当它同时通过物理关系验证（步骤3.2）和往返转换检查（步骤3.3）时，才会获得 `True` 的最终裁决。否则，裁决为 `False`。程序将对所有测试用例执行此逻辑，并报告布尔结果的列表。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# Physical constants and tolerance as defined in the problem.\nHBAR_C_MEV_FM = 197.3269804  # MeV*fm\nNUCLEON_MASS_MEV = 939.56542052  # MeV\nTOLERANCE = 1e-12\n\ndef delta(x, y):\n    \"\"\"\n    Calculates the relative discrepancy between two numbers x and y.\n    The normalization is max(1, |x|, |y|) to handle values close to zero.\n    \"\"\"\n    return np.abs(x - y) / np.max([1.0, np.abs(x), np.abs(y)])\n\ndef compute_native_set(is_mev_fm, known_var, val, g):\n    \"\"\"\n    Computes the full set of (n, kF, EF) from a single known quantity\n    in the specified native unit system.\n    \"\"\"\n    n, kf, ef = 0.0, 0.0, 0.0\n    pi_squared = np.pi**2\n    \n    if is_mev_fm:  # MeV-fm unit system\n        if known_var == 'n':\n            n = val\n            kf = (6 * pi_squared * n / g)**(1/3)\n            ef = (HBAR_C_MEV_FM * kf)**2 / (2 * NUCLEON_MASS_MEV)\n        elif known_var == 'kF':\n            kf = val\n            n = g * kf**3 / (6 * pi_squared)\n            ef = (HBAR_C_MEV_FM * kf)**2 / (2 * NUCLEON_MASS_MEV)\n        elif known_var == 'eF':\n            ef = val\n            kf = np.sqrt(2 * NUCLEON_MASS_MEV * ef) / HBAR_C_MEV_FM\n            n = g * kf**3 / (6 * pi_squared)\n    else:  # Natural unit system\n        if known_var == 'n':\n            n = val\n            kf = (6 * pi_squared * n / g)**(1/3)\n            ef = kf**2 / (2 * NUCLEON_MASS_MEV)\n        elif known_var == 'kF':\n            kf = val\n            n = g * kf**3 / (6 * pi_squared)\n            ef = kf**2 / (2 * NUCLEON_MASS_MEV)\n        elif known_var == 'eF':\n            ef = val\n            kf = np.sqrt(2 * NUCLEON_MASS_MEV * ef)\n            n = g * kf**3 / (6 * pi_squared)\n            \n    return {'n': n, 'kf': kf, 'ef': ef}\n\ndef verify_relations(state, g, is_mev_fm):\n    \"\"\"\n    Verifies that the fundamental Fermi gas relations hold for the given state.\n    \"\"\"\n    n, kf, ef = state['n'], state['kf'], state['ef']\n    \n    # Check n -> kF relation\n    n_check = g * kf**3 / (6 * np.pi**2)\n    pass_n_kf = delta(n, n_check)  TOLERANCE\n\n    # Check eF -> kF relation, using the appropriate formula for the unit system\n    if is_mev_fm:\n        ef_check = (HBAR_C_MEV_FM * kf)**2 / (2 * NUCLEON_MASS_MEV)\n    else:\n        ef_check = kf**2 / (2 * NUCLEON_MASS_MEV)\n    pass_ef_kf = delta(ef, ef_check)  TOLERANCE\n\n    return pass_n_kf and pass_ef_kf\n    \ndef mevfm_to_natural(state):\n    \"\"\"Converts a state from MeV-fm units to natural units.\"\"\"\n    hc3 = HBAR_C_MEV_FM**3\n    return {\n        'n': state['n'] * hc3,\n        'kf': state['kf'] * HBAR_C_MEV_FM,\n        'ef': state['ef'],\n        't': state['t']\n    }\n\ndef natural_to_mevfm(state):\n    \"\"\"Converts a state from natural units to MeV-fm units.\"\"\"\n    hc3 = HBAR_C_MEV_FM**3\n    return {\n        'n': state['n'] / hc3,\n        'kf': state['kf'] / HBAR_C_MEV_FM,\n        'ef': state['ef'],\n        't': state['t']\n    }\n\ndef verify_roundtrip(native_set, round_trip_set):\n    \"\"\"\n    Checks the discrepancies between an original and a round-trip converted state.\n    \"\"\"\n    d_n = delta(native_set['n'], round_trip_set['n'])\n    d_kf = delta(native_set['kf'], round_trip_set['kf'])\n    d_ef = delta(native_set['ef'], round_trip_set['ef'])\n    d_t = delta(native_set['t'], round_trip_set['t'])\n    \n    return (d_n  TOLERANCE and\n            d_kf  TOLERANCE and\n            d_ef  TOLERANCE and\n            d_t  TOLERANCE)\n\ndef process_case(is_mev_fm, known_var, val, g, T):\n    \"\"\"\n    Runs a single test case through the full validation procedure.\n    \"\"\"\n    # 1. Compute the full set of physical quantities in the native unit system.\n    native_set = compute_native_set(is_mev_fm, known_var, val, g)\n    native_set['t'] = T\n\n    # 2. Verify that the Fermi gas relations hold for the computed set.\n    pass_relations = verify_relations(native_set, g, is_mev_fm)\n\n    # 3. Perform a round-trip conversion and verify negligible discrepancies.\n    if is_mev_fm:\n        converted_set = mevfm_to_natural(native_set)\n        round_trip_set = natural_to_mevfm(converted_set)\n    else:  # is_natural\n        converted_set = natural_to_mevfm(native_set)\n        round_trip_set = mevfm_to_natural(converted_set)\n\n    pass_roundtrip = verify_roundtrip(native_set, round_trip_set)\n    \n    return pass_relations and pass_roundtrip\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (is_mev_fm, known_var, value, degeneracy g, temperature T in MeV)\n        (True, 'n', 0.16, 4, 0.0),            # Case 1\n        (True, 'kF', 0.05, 2, 5.0),           # Case 2\n        (False, 'kF', 262.444883932, 4, 15.0), # Case 3\n        (False, 'eF', 37.0, 4, 1.0)            # Case 4\n    ]\n\n    results = []\n    for case in test_cases:\n        is_mev_fm, known_var, val, g, T = case\n        result = process_case(is_mev_fm, known_var, val, g, T)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # The boolean values are converted to string format 'True' or 'False'.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "掌握了基本工具后，我们将从理想化的单组分气体模型过渡到由中子和质子组成的、更符合实际的核物质图像。本练习引入了同位旋不对称度 $\\delta$ 的概念，并引导您推导和计算动能对称能 $S_{\\mathrm{kin}}$，这是非对称系统中泡利不相容原理的直接体现 ()。这个量对于理解原子核以及中子星中富中子物质的性质至关重要。",
            "id": "3599449",
            "problem": "考虑一个由中子和质子组成的双组分、非相对论费米气体核物质模型，其中裸核子质量相等。设总数密度用 $\\rho$（单位为 $\\mathrm{fm}^{-3}$）表示，同位旋不对称性 $\\delta$ 定义为 $\\delta=(\\rho_n-\\rho_p)/\\rho$，其中 $\\rho_n$ 和 $\\rho_p$ 分别是中子和质子的数密度。假设每个组分的自旋简并度 $g=2$，并忽略相互作用（自由气体）。使用能量单位兆电子伏特（$\\mathrm{MeV}$）和长度单位飞米（$\\mathrm{fm}$），并采用 $\\hbar c = 197.3269804\\,\\mathrm{MeV}\\cdot\\mathrm{fm}$ 和裸核子质量 $m=939.0\\,\\mathrm{MeV}$。设温度 $T$ 以 $\\mathrm{MeV}$ 为单位，因此 $k_B T$ 被吸收到 $T$ 中。\n\n从第一性原理出发，即：\n- 费米子的费米-狄拉克分布函数为 $f(E,\\mu,T)=\\left[1+\\exp\\left((E-\\mu)/T\\right)\\right]^{-1}$，其中化学势为 $\\mu$，温度为 $T$（其零温极限由费米能量处的亥维赛阶跃函数给出），\n- 自由气体在动量空间中的数密度和动能密度的定义，\n推导表达式，以便在给定 $\\rho$ 和 $T$ 的情况下计算每个粒子的总动能 $E/A(\\delta)$。所有量均用波数 $k$（单位为 $\\mathrm{fm}^{-1}$）表示，其中单粒子动能为 $E(k)=\\hbar^2 k^2/(2m)$，且测量由标准态计数设定：\n$$\n\\rho_i(\\mu_i,T)=\\frac{g}{2\\pi^2}\\int_0^{\\infty} k^2\\, f\\!\\left(E(k),\\mu_i,T\\right)\\, dk,\n$$\n$$\n\\varepsilon_i(\\mu_i,T)=\\frac{g}{2\\pi^2}\\int_0^{\\infty} k^2\\, E(k)\\, f\\!\\left(E(k),\\mu_i,T\\right)\\, dk,\n$$\n对于 $i\\in\\{n,p\\}$，每个粒子的总动能为 $E/A(\\delta)=\\left[\\varepsilon_n+\\varepsilon_p\\right]/\\rho$。在零温下，使用分布的零温极限和相应的精确积分。\n\n将动能对称能 $S_{\\mathrm{kin}}(\\rho,T)$ 定义为 $E/A(\\delta)$ 在 $\\delta=0$ 附近展开式中 $\\delta^2$ 项的系数：\n$$\nE/A(\\delta) = E/A(0) + S_{\\mathrm{kin}}(\\rho,T)\\,\\delta^2 + \\mathcal{O}(\\delta^4).\n$$\n您必须通过在 $0$ 附近的一个小的、对称的 $\\delta$ 值网格上计算 $E/A(\\delta)$，并对偶次多项式基 $\\{1,\\delta^2\\}$ 进行最小二乘拟合，以提取二次项系数，从而数值化地确定 $S_{\\mathrm{kin}}(\\rho,T)$。在零温下，从相同的第一性原理出发，解析推导 $S_{\\mathrm{kin}}(\\rho,T)$ 的精确零温极限，并数值验证您的拟合值与解析结果是否一致。\n\n算法说明：\n- 对于给定的总密度 $\\rho$ 和不对称性 $\\delta$，指定 $\\rho_n=\\rho(1+\\delta)/2$ 和 $\\rho_p=\\rho(1-\\delta)/2$。\n- 对于 $T=0$，使用分布的零温极限和对直至费米波数 $k$ 的精确积分来计算 $E/A(\\delta)$。对于 $T0$，对每个组分 $i$，通过数值求解 $\\rho_i(\\mu_i,T)=\\rho_i$ 来确定 $\\mu_i$（使用一个稳健的、单调的求根区间法），然后计算 $\\varepsilon_i(\\mu_i,T)$。\n- 使用对称网格 $\\delta\\in\\{-0.4,-0.2,0.0,0.2,0.4\\}$ 来拟合 $E/A(\\delta)$，并从对 $\\{1,\\delta^2\\}$ 的最小二乘拟合中提取 $\\delta^2$ 的系数作为 $S_{\\mathrm{kin}}(\\rho,T)$。\n- 所有计算出的能量必须以 $\\mathrm{MeV}$ 表示。报告的浮点数应四舍五入到六位小数。\n\n测试套件：\n- 情况 1：$\\rho=0.16\\,\\mathrm{fm}^{-3}$，$T=0\\,\\mathrm{MeV}$；返回拟合的 $S_{\\mathrm{kin}}(\\rho,T)$ 以及一个布尔值，说明其是否在 $10^{-3}\\,\\mathrm{MeV}$ 的绝对容差内与解析推导的零温极限相匹配。\n- 情况 2：$\\rho=0.08\\,\\mathrm{fm}^{-3}$，$T=0\\,\\mathrm{MeV}$；返回拟合的 $S_{\\mathrm{kin}}(\\rho,T)$ 以及一个布尔值，说明其是否在 $10^{-3}\\,\\mathrm{MeV}$ 的绝对容差内与解析推导的零温极限相匹配。\n- 情况 3：$\\rho=0.16\\,\\mathrm{fm}^{-3}$，$T=5\\,\\mathrm{MeV}$；返回拟合的 $S_{\\mathrm{kin}}(\\rho,T)$。\n- 情况 4：$\\rho=0.16\\,\\mathrm{fm}^{-3}$，$T=20\\,\\mathrm{MeV}$；返回拟合的 $S_{\\mathrm{kin}}(\\rho,T)$。\n- 情况 5：$\\rho=10^{-6}\\,\\mathrm{fm}^{-3}$，$T=5\\,\\mathrm{MeV}$；返回拟合的 $S_{\\mathrm{kin}}(\\rho,T)$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的、以逗号分隔的结果列表。该列表必须按顺序包含：情况 1 的浮点数，情况 1 验证的布尔值，情况 2 的浮点数，情况 2 验证的布尔值，情况 3 的浮点数，情况 4 的浮点数，以及情况 5 的浮点数。例如：$[x_1,\\mathrm{True},x_2,\\mathrm{False},x_3,x_4,x_5]$，其中每个 $x_i$ 是一个四舍五入到六位小数并以 $\\mathrm{MeV}$ 表示的浮点数。",
            "solution": "该问题具有科学依据，提法明确，并包含推导唯一解所需的所有信息。我们首先概述非相对论自由费米气体模型的理论框架，然后详细说明零温和有限温度下的计算策略，最后解释提取动能对称能的步骤。\n\n**1. 理论框架：自由费米气体模型**\n\n该系统是一个由质量为 $m$ 的不相互作用的中子（$n$）和质子（$p$）组成的双组分气体。系统的状态由总核子数密度 $\\rho = \\rho_n + \\rho_p$ 和温度 $T$ 决定。中子和质子的相对比例由同位旋不对称性 $\\delta = (\\rho_n - \\rho_p)/\\rho$ 给出，这意味着 $\\rho_n = \\rho(1+\\delta)/2$ 和 $\\rho_p = \\rho(1-\\delta)/2$。\n\n对于波数为 $k$ 的核子，其单粒子动能是非相对论的：\n$$E(k) = \\frac{\\hbar^2 k^2}{2m}$$\n这里我们使用常数 $\\frac{\\hbar^2}{2m} = \\frac{(\\hbar c)^2}{2mc^2}$。给定 $\\hbar c = 197.3269804\\,\\mathrm{MeV}\\cdot\\mathrm{fm}$ 和 $m \\equiv mc^2 = 939.0\\,\\mathrm{MeV}$，该常数约等于 $20.7337\\,\\mathrm{MeV}\\cdot\\mathrm{fm}^2$。\n\n粒子遵循费米-狄拉克分布，该分布给出了能量为 $E$ 的态被占据的概率：\n$$f(E, \\mu, T) = \\frac{1}{1 + \\exp\\left(\\frac{E-\\mu}{T}\\right)}$$\n此处，$\\mu$ 是该粒子种类的化学势， $T$ 是以 $\\mathrm{MeV}$ 为单位的温度。\n\n每个种类 $i \\in \\{n,p\\}$ 的数密度 $\\rho_i$ 和动能密度 $\\varepsilon_i$ 通过对所有动量态积分得到，自旋简并因子为 $g=2$：\n$$ \\rho_i(\\mu_i, T) = \\frac{g}{2\\pi^2} \\int_0^{\\infty} k^2 f(E(k), \\mu_i, T) dk $$\n$$ \\varepsilon_i(\\mu_i, T) = \\frac{g}{2\\pi^2} \\int_0^{\\infty} k^2 E(k) f(E(k), \\mu_i, T) dk $$\n每个粒子的总动能 $E/A$ 是动能密度之和除以总数密度：\n$$ E/A(\\delta) = \\frac{\\varepsilon_n + \\varepsilon_p}{\\rho} $$\n\n**2. 零温情况 ($T=0\\,\\mathrm{MeV}$)**\n\n在零温下，费米-狄拉克分布变为一个亥维赛阶跃函数，$f(E,\\mu,0) = \\Theta(\\mu - E)$，其中化学势 $\\mu(T=0)$ 即为费米能 $E_{F_i}$。积分在费米波数 $k_{F_i}$ 处被截断，其中 $E(k_{F_i}) = E_{F_i}$。\n\n数密度积分变为：\n$$ \\rho_i = \\frac{g}{2\\pi^2} \\int_0^{k_{F_i}} k^2 dk = \\frac{g}{6\\pi^2} k_{F_i}^3 $$\n当 $g=2$ 时，我们有 $\\rho_i = k_{F_i}^3 / (3\\pi^2)$，这给出了费米波数为 $k_{F_i} = (3\\pi^2 \\rho_i)^{1/3}$。\n\n动能密度积分变为：\n$$ \\varepsilon_i = \\frac{g}{2\\pi^2} \\int_0^{k_{F_i}} k^2 \\left(\\frac{\\hbar^2 k^2}{2m}\\right) dk = \\frac{g\\hbar^2}{4\\pi^2 m} \\frac{k_{F_i}^5}{5} $$\n代入 $k_{F_i}$ 和 $g=2$，我们可以用 $\\rho_i$ 来表示 $\\varepsilon_i$：\n$$ \\varepsilon_i = \\frac{\\hbar^2}{10\\pi^2 m} (3\\pi^2 \\rho_i)^{5/3} = \\frac{3\\hbar^2(3\\pi^2)^{2/3}}{10m} \\rho_i^{5/3} $$\n那么，每个粒子的总动能为：\n$$ E/A(\\delta) = \\frac{1}{\\rho} \\left( \\varepsilon_n + \\varepsilon_p \\right) = \\frac{3\\hbar^2(3\\pi^2)^{2/3}}{10m\\rho} \\left[ \\rho_n^{5/3} + \\rho_p^{5/3} \\right] $$\n代入 $\\rho_n = \\rho(1+\\delta)/2$ 和 $\\rho_p = \\rho(1-\\delta)/2$：\n$$ E/A(\\delta) = \\frac{3\\hbar^2(3\\pi^2\\rho)^{2/3}}{10m \\cdot 2^{5/3}} \\left[ (1+\\delta)^{5/3} + (1-\\delta)^{5/3} \\right] $$\n\n动能对称能 $S_{\\mathrm{kin}}$ 是 $E/A(\\delta)$ 在 $\\delta=0$ 附近泰勒展开式中 $\\delta^2$ 的系数。我们展开括号中的项：$(1+x)^p \\approx 1 + px + \\frac{p(p-1)}{2}x^2 + \\dots$。对于 $x=\\pm\\delta$ 和 $p=5/3$：\n$$ (1+\\delta)^{5/3} + (1-\\delta)^{5/3} \\approx \\left(1 + \\frac{5}{3}\\delta + \\frac{10}{9}\\delta^2\\right) + \\left(1 - \\frac{5}{3}\\delta + \\frac{10}{9}\\delta^2\\right) = 2 + \\frac{20}{9}\\delta^2 + \\mathcal{O}(\\delta^4) $$\n将此代入 $E/A(\\delta)$ 的表达式中，得到：\n$$ E/A(\\delta) = E/A(0) \\left(1 + \\frac{5}{9}\\delta^2 + \\dots\\right) \\quad \\text{其中} \\quad E/A(0) = \\frac{3}{5} \\frac{\\hbar^2 k_F^2}{2m} = \\frac{3}{5} E_F(\\rho) $$\n此处 $k_F = (3\\pi^2\\rho/2)^{1/3}$ 是对称核物质（$\\delta=0$）的费米波数。因此，展开式为：\n$$ E/A(\\delta) = \\frac{3}{5}E_F(\\rho) + \\frac{1}{3}E_F(\\rho)\\delta^2 + \\mathcal{O}(\\delta^4) $$\n因此，在 $T=0$ 时动能对称能的解析表达式为：\n$$ S_{\\mathrm{kin}}(\\rho, T=0) = \\frac{1}{3} E_F(\\rho) = \\frac{1}{3} \\frac{\\hbar^2}{2m} \\left(\\frac{3\\pi^2\\rho}{2}\\right)^{2/3} $$\n此公式用于验证数值拟合的值。\n\n**3. 有限温度情况 ($T0\\,\\mathrm{MeV}$)**\n\n在有限温度下，费米-狄拉克分布是一个平滑函数，积分必须进行数值计算。对于给定的 $(\\rho, \\delta, T)$，计算 $E/A(\\delta)$ 的步骤如下：\n1.  计算 $\\rho_n = \\rho(1+\\delta)/2$ 和 $\\rho_p = \\rho(1-\\delta)/2$。\n2.  对于每个种类 $i \\in \\{n, p\\}$，如果 $\\rho_i  0$，通过数值求解非线性方程 $\\rho_i = \\rho_i(\\mu_i, T)$ 来确定化学势 $\\mu_i$。这是一个关于 $\\mu_i$ 的求根问题。由于 $\\rho_i(\\mu_i, T)$ 是 $\\mu_i$ 的单调递增函数，像 Brent 方法这样稳健的求根区间法是合适的。$\\rho_i(\\mu_i,T)$ 的积分使用数值积分程序计算。\n3.  一旦 $\\mu_i$ 已知，动能密度 $\\varepsilon_i = \\varepsilon_i(\\mu_i, T)$ 就通过数值积分其定义表达式来计算。\n4.  然后，每个粒子的总动能计算为 $E/A(\\delta) = (\\varepsilon_n+\\varepsilon_p)/\\rho$。\n\n**4. 对称能的数值提取**\n\n问题要求从展开式 $E/A(\\delta) \\approx E/A(0) + S_{\\mathrm{kin}}(\\rho,T)\\delta^2$ 中确定 $S_{\\mathrm{kin}}(\\rho,T)$。这是一个关于 $\\delta$ 的二次拟合，或者等效地，一个关于 $\\delta^2$ 的线性拟合。\n1.  对于给定的 $(\\rho, T)$，为指定网格 $\\{-0.4, -0.2, 0.0, 0.2, 0.4\\}$ 中的每个 $\\delta_j$ 计算量 $E/A(\\delta_j)$。\n2.  我们对模型 $y_j = c_0 + c_1 x_j$ 进行线性最小二乘拟合，其中自变量为 $x_j = \\delta_j^2$，因变量为 $y_j = E/A(\\delta_j)$。\n3.  这对应于在最小二乘意义上求解线性系统 $A\\mathbf{c} = \\mathbf{b}$，其中 $\\mathbf{b}$ 是计算出的 $E/A(\\delta_j)$ 值的向量，$\\mathbf{c} = [c_0, c_1]^T$ 是待求系数的向量，而 $A$ 是设计矩阵：\n    $$A = \\begin{pmatrix} 1  \\delta_1^2 \\\\ 1  \\delta_2^2 \\\\ \\vdots  \\vdots \\\\ 1  \\delta_5^2 \\end{pmatrix} = \\begin{pmatrix} 1  0.16 \\\\ 1  0.04 \\\\ 1  0.00 \\\\ 1  0.04 \\\\ 1  0.16 \\end{pmatrix}$$\n4.  拟合系数 $c_1$ 是动能对称能 $S_{\\mathrm{kin}}(\\rho,T)$ 的数值估计。\n\n这种综合方法将 $T=0$ 情况的解析推导与 $T0$ 情况的稳健数值策略相结合，最终形成一套明确定义的提取动能对称能的程序。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Solves the Fermi gas model problem for the specified test cases.\n    \"\"\"\n\n    # Constants\n    HBARC = 197.3269804  # MeV fm\n    M_N = 939.0          # MeV (bare nucleon mass as mc^2)\n    HBARC2_2M = HBARC**2 / (2 * M_N) # MeV fm^2\n    G = 2.0              # Spin degeneracy\n    PI = np.pi\n\n    # --- T=0 Analytical Calculations ---\n\n    def s_kin_analytic_t0(rho):\n        \"\"\"Calculates the analytical kinetic symmetry energy at T=0.\"\"\"\n        term1 = HBARC2_2M / 3.0\n        term2 = (3.0 * PI**2 * rho / 2.0)**(2.0/3.0)\n        return term1 * term2\n\n    def get_e_per_a_t0(rho, delta):\n        \"\"\"Calculates the kinetic energy per particle at T=0.\"\"\"\n        rho_n = rho * (1.0 + delta) / 2.0\n        rho_p = rho * (1.0 - delta) / 2.0\n\n        # E/A(delta) = (3/10) * (hbar^2/m) * (3*pi^2)^(2/3) * (rho_n^(5/3)+rho_p^(5/3))/rho\n        constant = (2.0 * HBARC2_2M) * (3.0/10.0) * (3.0 * PI**2)**(2.0/3.0)\n        \n        term_n = rho_n**(5.0/3.0) if rho_n > 0 else 0.0\n        term_p = rho_p**(5.0/3.0) if rho_p > 0 else 0.0\n        \n        e_per_a = constant * (term_n + term_p) / rho if rho > 0 else 0.0\n        return e_per_a\n\n    # --- T>0 Numerical Calculations ---\n\n    # Integrands for number density and energy density\n    def integrand_rho(k, mu, T):\n        arg = (HBARC2_2M * k**2 - mu) / T\n        # Avoid overflow for large positive arguments\n        if arg > 700:\n            return 0.0\n        return k**2 / (1.0 + np.exp(arg))\n\n    def integrand_eps(k, mu, T):\n        arg = (HBARC2_2M * k**2 - mu) / T\n        if arg > 700:\n            return 0.0\n        return HBARC2_2M * k**4 / (1.0 + np.exp(arg))\n\n    # Function to calculate number density for a given chemical potential\n    def calculate_rho(mu, T):\n        integral, _ = quad(integrand_rho, 0, np.inf, args=(mu, T), epsabs=1e-12, epsrel=1e-12)\n        # Prefactor is G / (2*pi^2) = 1/pi^2\n        return (1.0 / PI**2) * integral\n\n    # Root-finding function to determine chemical potential\n    def find_mu(rho_i, T):\n        if rho_i = 1e-20:  # Effectively zero density\n            return -np.inf\n        \n        def root_function(mu):\n            return calculate_rho(mu, T) - rho_i\n        \n        # A robust bracket for mu in MeV\n        mu_min, mu_max = -500.0, 500.0\n        try:\n            mu = brentq(root_function, mu_min, mu_max, xtol=1e-12, rtol=1e-12)\n        except ValueError:\n            # This can happen if the root is outside the bracket, e.g., low density\n            # Let's try to search for the bracket\n             a, b = mu_min, mu_max\n             fa, fb = root_function(a), root_function(b)\n             while fa * fb > 0:\n                 if abs(fa)  abs(fb):\n                     a -= 200\n                     fa = root_function(a)\n                 else:\n                     b += 200\n                     fb = root_function(b)\n             mu = brentq(root_function, a, b, xtol=1e-12, rtol=1e-12)\n        return mu\n\n    # Function to calculate kinetic energy density\n    def calculate_eps(mu, T):\n        if not np.isfinite(mu):\n            return 0.0\n        integral, _ = quad(integrand_eps, 0, np.inf, args=(mu, T), epsabs=1e-12, epsrel=1e-12)\n        return (1.0 / PI**2) * integral\n\n    # Main function to get E/A at T>0\n    def get_e_per_a_t_gt_0(rho, delta, T):\n        rho_n = rho * (1.0 + delta) / 2.0\n        rho_p = rho * (1.0 - delta) / 2.0\n        \n        mu_n = find_mu(rho_n, T)\n        eps_n = calculate_eps(mu_n, T)\n        \n        mu_p = find_mu(rho_p, T)\n        eps_p = calculate_eps(mu_p, T)\n        \n        return (eps_n + eps_p) / rho if rho > 0 else 0.0\n\n    # --- Main Loop for Test Cases ---\n\n    test_cases = [\n        {'rho': 0.16, 'T': 0.0},\n        {'rho': 0.08, 'T': 0.0},\n        {'rho': 0.16, 'T': 5.0},\n        {'rho': 0.16, 'T': 20.0},\n        {'rho': 1e-6, 'T': 5.0},\n    ]\n    \n    delta_grid = np.array([-0.4, -0.2, 0.0, 0.2, 0.4])\n    results = []\n    \n    for case in test_cases:\n        rho = case['rho']\n        T = case['T']\n        \n        e_per_a_values = []\n        for delta in delta_grid:\n            if T == 0.0:\n                e_val = get_e_per_a_t0(rho, delta)\n            else:\n                e_val = get_e_per_a_t_gt_0(rho, delta, T)\n            e_per_a_values.append(e_val)\n            \n        # Least-squares fit to y = c0 + c1*x where x=delta^2\n        delta_sq = delta_grid**2\n        A = np.vstack([np.ones_like(delta_sq), delta_sq]).T\n        b = np.array(e_per_a_values)\n        \n        coeffs, _, _, _ = np.linalg.lstsq(A, b, rcond=None)\n        s_kin_fit = coeffs[1]\n        \n        results.append(f\"{s_kin_fit:.6f}\")\n        \n        if T == 0.0:\n            s_kin_analytic = s_kin_analytic_t0(rho)\n            is_match = np.isclose(s_kin_fit, s_kin_analytic, atol=1e-3)\n            results.append(str(is_match))\n\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "除了能量和密度等宏观性质，我们现在将探索费米气体的微观空间结构。泡利不相容原理禁止相同的费米子占据同一空间位置，这会在每个粒子周围形成一个所谓的“交换关联洞”（exchange hole）。本练习将指导您计算对关联函数 $g(r)$，从而在零温和有限温度下，对这一基本的量子统计效应提供一个直观且定量的理解 ()。",
            "id": "3599407",
            "problem": "考虑一个均匀、无相互作用、自旋-同位旋简并的核子费米气体，其数密度为 $\\rho$（单位为 $\\mathrm{fm}^{-3}$），温度为 $T$（单位为 $\\mathrm{MeV}$），总内禀简并度为 $\\nu$（对于对称核物质，由于自旋 $S=\\tfrac{1}{2}$ 和同位旋 $I=\\tfrac{1}{2}$，$\\nu = 4$）。在非相对论性体系中进行计算，单粒子色散关系为 $\\varepsilon_k = \\hbar^2 k^2/(2 m)$，其中 $m$ 是核子质量，$k$ 是波数（单位为 $\\mathrm{fm}^{-1}$）。使用自然单位制，其中能量单位为 $\\mathrm{MeV}$，长度单位为 $\\mathrm{fm}$，且 $\\hbar c = 197.3269804\\,\\mathrm{MeV\\,fm}$，$m = 939.0\\,\\mathrm{MeV}$；设 $k_{\\mathrm{B}} = 1$ 和 $c = 1$，因此温度 $T$ 和化学势 $\\mu$ 均以 $\\mathrm{MeV}$ 为单位。\n\n定义与目标：\n- 单体动量分布为 $n(k; \\mu, T) = \\left[1 + \\exp\\left(\\tfrac{\\varepsilon_k - \\mu}{T}\\right)\\right]^{-1}$。\n- 数密度为 $\\rho = \\dfrac{\\nu}{(2\\pi)^3} \\int \\mathrm{d}^3 k \\, n(k; \\mu, T) = \\dfrac{\\nu}{2\\pi^2} \\int_0^\\infty \\mathrm{d}k \\, k^2 \\, n(k; \\mu, T)$。\n- 单体密度矩阵为 $\\rho_1(r) = \\dfrac{\\nu}{(2\\pi)^3} \\int \\mathrm{d}^3 k \\, n(k; \\mu, T) \\, e^{i \\mathbf{k}\\cdot\\mathbf{r}} = \\dfrac{\\nu}{2\\pi^2} \\int_0^\\infty \\mathrm{d}k \\, k^2 \\, n(k; \\mu, T) \\, \\dfrac{\\sin(k r)}{k r}$。\n- 归一化单体密度矩阵为 $n(r) = \\rho_1(r)/\\rho$。\n- 自旋-同位旋求和的对关联函数为 $g(r) = 1 - \\dfrac{1}{\\nu}\\, \\left| n(r) \\right|^2$，它反映了反对稱化引起的交换空穴。\n- 在零温极限 $T \\to 0$下，费米波数为 $k_{\\mathrm{F}} = \\left(\\dfrac{6 \\pi^2 \\rho}{\\nu}\\right)^{1/3}$，可得到 Slater 结果，并可将其用作 $T=0$ 时的解析基准。\n\n一个完整程序需要实现的任务：\n1. 根据上述基本定义，通过求解关于 $\\mu$ 的隐式密度方程，确定在给定温度 $T$ 下产生指定密度 $\\rho$ 的化学势 $\\mu$（单位为 $\\mathrm{MeV}$）。\n2. 使用得到的 $n(k;\\mu,T)$，通过对所述的、经角向平均简化的三维傅里叶变换进行数值积分，计算 $n(r)$，然后计算 $g(r)$。\n3. 使用 Slater 结果构建 $g(r)$ 的解析 $T=0$ 基准，并将其与极低温下有限温度 $T$ 的数值计算结果进行比较，量化在 $r$ 网格上的最大绝对偏差。\n4. 报告用于探测不同体系的额外诊断量：中等温度下的化学势、接触值 $g(0)$ 以及在特征距离处的高温值。\n\n数值和物理单位：\n- 在整个计算中，$\\rho$ 的单位为 $\\mathrm{fm}^{-3}$，$T$ 和 $\\mu$ 的单位为 $\\mathrm{MeV}$，$r$ 的单位为 $\\mathrm{fm}$，波数的单位为 $\\mathrm{fm}^{-1}$，能量的单位为 $\\mathrm{MeV}$。所有 $g(r)$ 的值或其差值的输出都是无量纲的。\n\n程序需要评估的测试组：\n- 所有测试的通用参数：$\\rho = 0.16\\,\\mathrm{fm}^{-3}$ 和 $\\nu = 4$。\n- 定义 $k_{\\mathrm{F,0}} = \\left(\\dfrac{6 \\pi^2 \\rho}{\\nu}\\right)^{1/3}$ 和 $r_\\star = \\dfrac{\\pi}{k_{\\mathrm{F,0}}}$。\n- 测试 1（与解析 $T=0$ 结果的低温一致性）：设置 $T = 0.001\\,\\mathrm{MeV}$。在一个包含 $201$ 个均匀间隔点的 $r \\in [0, 8]\\,\\mathrm{fm}$ 网格上，数值计算 $g_{\\mathrm{num}}(r)$ 并根据 $T=0$ 的 Slater 结果计算 $g_{0}(r)$。以浮点数形式输出最大绝对偏差 $\\max_r |g_{\\mathrm{num}}(r) - g_{0}(r)|$（无量綱）。\n- 测试 2（中等温度下的化学势）：设置 $T = 5.0\\,\\mathrm{MeV}$，以浮点数形式输出相应的化学势 $\\mu$（单位为 $\\mathrm{MeV}$）。\n- 测试 3（交换空穴的接触值）：在 $T = 5.0\\,\\mathrm{MeV}$ 条件下，数值计算 $g(0)$，并以浮点数形式输出绝对偏差 $|g(0) - (1 - 1/\\nu)|$（无量綱）。\n- 测试 4（高温下结构的阻尼）：设置 $T = 40.0\\,\\mathrm{MeV}$，数值计算 $g(r_\\star)$。以浮点数形式输出 $g(r_\\star)$（无量綱）。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含按测试 1 到 4 顺序排列的四个结果，格式为一个用方括号括起来的逗号分隔列表，例如 $[x_1,x_2,x_3,x_4]$，其中每个 $x_i$ 是一个符合上述单位要求的浮点数。",
            "solution": "该问题要求对均匀、无相互作用的核子费米气体进行数值分析，这是核物理学中的一个基础模型。主要目标是计算有限温度 $T$下的对关联函数 $g(r)$，并将其与已知的零温解析结果进行比较。这涉及几个计算步骤：确定与给定核子密度 $\\rho$ 相对应的化学势 $\\mu$，然后对定义单体密度矩阵 $\\rho_1(r)$ 的积分进行数值计算，并由此构建 $g(r)$。\n\n首先，我们确定物理和数值常数。单粒子能量由非相对论性色散关系 $\\varepsilon_k = \\frac{\\hbar^2 k^2}{2m}$ 给出，其中 $k$ 是波数，$m$ 是核子质量。使用给定的常数 $\\hbar c = 197.3269804\\,\\mathrm{MeV\\,fm}$ 和 $m = 939.0\\,\\mathrm{MeV}$，并在 $c=1$ 的单位制下工作，动能系数计算为 $\\frac{\\hbar^2}{2m} = \\frac{(\\hbar c)^2}{2m} \\approx 20.7337\\,\\mathrm{MeV\\,fm}^2$。分析是针对固定核子密度 $\\rho = 0.16\\,\\mathrm{fm}^{-3}$ 和总简并度 $\\nu = 4$（对应于对称核物质）进行的。由此，我们定义零温费米波数 $k_{\\mathrm{F,0}} = \\left(\\frac{6 \\pi^2 \\rho}{\\nu}\\right)^{1/3} \\approx 1.3327\\,\\mathrm{fm}^{-1}$。其中一个测试中使用的特征长度标度是 $r_\\star = \\frac{\\pi}{k_{\\mathrm{F,0}}}$。\n\n问题的核心在于以下一组定义：\n动量分布是费米-狄拉克分布，$n(k; \\mu, T) = \\left[1 + \\exp\\left(\\frac{\\varepsilon_k - \\mu}{T}\\right)\\right]^{-1}$。\n数密度 $\\rho$ 通过积分方程与化学势 $\\mu$ 和温度 $T$ 相关联：\n$$\n\\rho = \\frac{\\nu}{2\\pi^2} \\int_0^\\infty \\mathrm{d}k \\, k^2 \\, n(k; \\mu, T)\n$$\n单体密度矩阵 $\\rho_1(r)$ 是动量分布的傅里叶变换：\n$$\n\\rho_1(r) = \\frac{\\nu}{2\\pi^2} \\int_0^\\infty \\mathrm{d}k \\, k^2 \\, n(k; \\mu, T) \\, \\frac{\\sin(k r)}{k r}\n$$\n归一化单体密度矩阵为 $n(r) = \\rho_1(r)/\\rho$，自旋-同位旋求和的对关联函数由下式给出：\n$$\ng(r) = 1 - \\frac{1}{\\nu}\\, |n(r)|^2\n$$\n\n计算过程始于为给定的 $(\\rho, T)$ 对确定化学势 $\\mu$。关于 $\\rho$ 的方程是 $\\mu$ 的一个超越方程。我们定义一个函数 $f(\\mu; T) = \\left(\\frac{\\nu}{2\\pi^2} \\int_0^\\infty \\mathrm{d}k \\, k^2 \\, n(k; \\mu, T)\\right) - \\rho$。所求的 $\\mu$ 是 $f(\\mu; T) = 0$ 的根。由于积分密度是 $\\mu$ 的单调递增函数，因此存在唯一的根。这个根可以通过稳健的数值算法（如 Brent 方法）找到，该方法需要找到一个区间 $[\\mu_a, \\mu_b]$，使得 $f(\\mu_a)$ 和 $f(\\mu_b)$ 异号。$f(\\mu; T)$ 内的积分使用数值积分法进行计算。\n\n一旦确定了 $\\mu$，我们就可以计算任何径向距离 $r \\ge 0$ 处的 $\\rho_1(r)$。定义 $\\rho_1(r)$ 的积分也使用数值积分法进行计算。$\\frac{\\sin(kr)}{kr}$ 项是良态的，当 $r \\to 0$ 时趋近于 $1$。这确保了积分是良定义的，并且对于所有 $r$（包括 $r=0$）都可以稳健地计算。在 $r=0$ 处，$\\rho_1(0)$ 的积分与密度方程中的积分相同，因此根据定义有 $\\rho_1(0) = \\rho$。因此，$n(0) = 1$ 且 $g(0) = 1 - 1/\\nu$。对该恒等式的数值检验可作为对求根和积分过程自洽性的验证。计算出 $\\rho_1(r)$ 后，我们计算 $n(r) = \\rho_1(r)/\\rho$，最后计算 $g(r) = 1 - \\frac{1}{\\nu}n(r)^2$。\n\n为了验证和基准测试，我们使用零温 ($T \\to 0$) 极限下的解析结果，即 Slater 模型。在此极限下，$n(k; \\mu, T)$ 变为亥维赛阶跃函数 $\\Theta(k_{\\mathrm{F,0}} - k)$。于是 $\\rho_1(r)$ 的积分可以解析求解：\n$$\n\\rho_{1,0}(r) = \\frac{\\nu}{2\\pi^2 r} \\int_0^{k_{\\mathrm{F,0}}} \\mathrm{d}k \\, k \\sin(kr) = \\frac{\\nu}{2\\pi^2} \\frac{\\sin(k_{\\mathrm{F,0}} r) - k_{\\mathrm{F,0}} r \\cos(k_{\\mathrm{F,0}} r)}{r^3}\n$$\n使用关系式 $\\rho = \\frac{\\nu k_{\\mathrm{F,0}}^3}{6\\pi^2}$，归一化密度矩阵变为：\n$$\nn_0(r) = \\frac{\\rho_{1,0}(r)}{\\rho} = 3 \\frac{\\sin(k_{\\mathrm{F,0}} r) - k_{\\mathrm{F,0}} r \\cos(k_{\\mathrm{F,0}} r)}{(k_{\\mathrm{F,0}} r)^3}\n$$\n相应的零温对关联函数为 $g_0(r) = 1 - \\frac{1}{\\nu} |n_0(r)|^2$。\n\n程序实现这些步骤以处理四个测试用例：\n1. 对于 $T = 0.001\\,\\mathrm{MeV}$，找到 $\\mu$，并在一个网格上计算 $g_{\\mathrm{num}}(r)$。通过计算最大绝对偏差 $\\max_r |g_{\\mathrm{num}}(r) - g_{0}(r)|$ 将其与解析结果 $g_0(r)$ 进行比较，该偏差预计很小，从而证实有限温度代码的正确性。\n2. 对于中等温度 $T=5.0\\,\\mathrm{MeV}$，计算并报告化学势 $\\mu$，以说明热激发对 $\\mu$ 的影响。\n3. 同样在 $T=5.0\\,\\mathrm{MeV}$下，通过计算 $\\rho_1(0)$ 的积分并使用已求得的 $\\mu$ 来数值计算 $g(0)$。这个数值结果与精确理论值 $1 - 1/\\nu$ 的绝对偏差量化了数值方案的精度。\n4. 在高温 $T=40.0\\,\\mathrm{MeV}$下，计算 $r=r_\\star$ 处的 $g(r)$。这用于探测高温下交换空穴关联（泡利阻塞效应）的阻尼情况。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Solves the computational nuclear physics problem about the Fermi gas model.\n    \"\"\"\n    \n    # Define physical and numerical constants\n    HBARC = 197.3269804      # MeV fm\n    M_N = 939.0              # MeV\n    HBAR2_2M = HBARC**2 / (2.0 * M_N) # MeV fm^2\n\n    # Common parameters from the problem statement\n    RHO = 0.16               # fm^-3\n    NU = 4.0                 # Degeneracy\n\n    # Derived constants\n    KF0 = (6.0 * np.pi**2 * RHO / NU)**(1.0/3.0)\n    R_STAR = np.pi / KF0\n\n    # --- Core Physics Functions ---\n\n    def dispersion(k):\n        \"\"\"Calculates the single-particle energy.\"\"\"\n        return HBAR2_2M * k**2\n\n    def fermi_dist(k, T, mu):\n        \"\"\"Calculates the Fermi-Dirac distribution.\"\"\"\n        energy = dispersion(k)\n        if T == 0:\n            return 1.0 if energy = mu else 0.0\n        # Prevent overflow for large positive arguments\n        arg = (energy - mu) / T\n        if arg > 700:\n            return 0.0\n        return 1.0 / (1.0 + np.exp(arg))\n\n    # --- Functions for finding the Chemical Potential mu ---\n\n    def density_integrand(k, T, mu):\n        \"\"\"Integrand for the number density calculation.\"\"\"\n        return k**2 * fermi_dist(k, T, mu)\n\n    def calculate_density(T, mu):\n        \"\"\"Calculates the number density for a given T and mu.\"\"\"\n        integral, _ = quad(density_integrand, 0, np.inf, args=(T, mu))\n        return (NU / (2.0 * np.pi**2)) * integral\n\n    def density_residual(mu, T, target_rho):\n        \"\"\"Function whose root is the chemical potential mu.\"\"\"\n        return calculate_density(T, mu) - target_rho\n\n    def find_mu(T, target_rho):\n        \"\"\"Finds mu by solving the density equation numerically.\"\"\"\n        # A robust bracketing interval for mu in MeV\n        mu_low = -100.0\n        mu_high = 100.0\n        try:\n            mu = brentq(density_residual, mu_low, mu_high, args=(T, target_rho), xtol=1e-12, rtol=1e-12)\n        except ValueError:\n            raise RuntimeError(f\"Failed to find a root for mu in [{mu_low}, {mu_high}] for T={T} MeV.\")\n        return mu\n\n    # --- Functions for the Pair Correlation Function g(r) ---\n\n    def rho1_integrand(k, r, T, mu):\n        \"\"\"Integrand for the one-body density matrix rho_1(r).\"\"\"\n        # sinc(x) = sin(pi*x)/(pi*x). We have sin(kr)/(kr).\n        # So we use sinc(kr/pi). This handles r=0 safely.\n        return k**2 * fermi_dist(k, T, mu) * np.sinc(k * r / np.pi)\n\n    def calculate_rho1(r, T, mu):\n        \"\"\"Calculates the one-body density matrix rho_1(r).\"\"\"\n        integral, _ = quad(rho1_integrand, 0, np.inf, args=(r, T, mu), epsabs=1e-9, epsrel=1e-9)\n        return (NU / (2.0 * np.pi**2)) * integral\n\n    def calculate_g_r(r, T, mu, target_rho):\n        \"\"\"Calculates the pair correlation function g(r) numerically.\"\"\"\n        rho1_val = calculate_rho1(r, T, mu)\n        n_r = rho1_val / target_rho\n        return 1.0 - (1.0 / NU) * n_r**2\n\n    # --- Analytic Zero-Temperature (Slater) Function ---\n\n    def calculate_g0_r(r, kf):\n        \"\"\"Calculates the analytic T=0 pair correlation function g_0(r).\"\"\"\n        if r  1e-9:\n            # The limit as r -> 0\n            return 1.0 - 1.0 / NU\n        x = kf * r\n        n0_r = 3.0 * (np.sin(x) - x * np.cos(x)) / x**3\n        return 1.0 - (1.0 / NU) * n0_r**2\n\n    results = []\n\n    # --- Test 1: Low-temperature consistency ---\n    T1 = 0.001  # MeV\n    mu1 = find_mu(T1, RHO)\n    r_grid = np.linspace(0, 8, 201)\n    \n    g_num_vals = np.zeros_like(r_grid)\n    g_analytic_vals = np.zeros_like(r_grid)\n\n    for i, r in enumerate(r_grid):\n        g_num_vals[i] = calculate_g_r(r, T1, mu1, RHO)\n        g_analytic_vals[i] = calculate_g0_r(r, KF0)\n        \n    max_deviation = np.max(np.abs(g_num_vals - g_analytic_vals))\n    results.append(max_deviation)\n\n    # --- Test 2: Moderate temperature chemical potential ---\n    T2 = 5.0  # MeV\n    mu2 = find_mu(T2, RHO)\n    results.append(mu2)\n\n    # --- Test 3: Contact value of the exchange hole ---\n    # T=5.0 MeV, mu is mu2 from Test 2\n    g_at_0_numerical = calculate_g_r(0, T2, mu2, RHO)\n    g_at_0_theoretical = 1.0 - 1.0 / NU\n    contact_deviation = np.abs(g_at_0_numerical - g_at_0_theoretical)\n    results.append(contact_deviation)\n\n    # --- Test 4: High-temperature damping of structure ---\n    T4 = 40.0  # MeV\n    mu4 = find_mu(T4, RHO)\n    g_at_rstar = calculate_g_r(R_STAR, T4, mu4, RHO)\n    results.append(g_at_rstar)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}