{
    "hands_on_practices": [
        {
            "introduction": "We begin our hands-on exploration with the most direct approach to discretizing a boundary value problem: the finite difference method. This exercise goes beyond simply applying a formula; it challenges you to analyze the very structure of the resulting linear system. By deriving the eigenvalues of the discretization matrix for a model problem, you will uncover the mathematical reason why finer grids, represented by a smaller grid spacing $h$, lead to increasingly ill-conditioned systems, a fundamental trade-off in computational science .",
            "id": "3545166",
            "problem": "In computational nuclear physics, boundary value problem solvers are often applied to the steady-state one-dimensional ($1\\text{D}$) neutron diffusion model on a slab, where transport and absorption are reduced to diffusion with prescribed vacuum boundaries. Consider the canonical scalar elliptic boundary value problem on the interval $[0,1]$,\n$$\n-u''(x) = f(x), \\quad x \\in [0,1], \\quad u(0) = 0, \\quad u(1) = 0,\n$$\nas the leading-order diffusion operator that appears in such solvers. Discretize the interval with $n$ interior points at $x_i = i h$ for $i = 1,2,\\dots,n$ and grid spacing $h = \\frac{1}{n+1}$, and use the standard second-order central finite difference (Finite Difference (FD)) scheme to obtain the linear system $A \\boldsymbol{u} = \\boldsymbol{f}$, where $A \\in \\mathbb{R}^{n \\times n}$ is the stiffness matrix. The matrix $A$ is symmetric positive definite (Symmetric Positive Definite (SPD)) and tridiagonal Toeplitz with entries\n$$\nA_{ii} = \\frac{2}{h^{2}}, \\quad A_{i,i+1} = A_{i+1,i} = -\\frac{1}{h^{2}}, \\quad i = 1,2,\\dots,n-1.\n$$\nStarting from the definition of the matrix $2$-norm condition number $\\kappa_{2}(A) = \\|A\\|_{2} \\,\\|A^{-1}\\|_{2}$ and the discrete eigenvalue problem $A \\boldsymbol{v} = \\lambda \\boldsymbol{v}$ subject to the homogeneous Dirichlet boundary encoding $\\boldsymbol{v}_0 = \\boldsymbol{v}_{n+1} = \\boldsymbol{0}$, derive the spectrum of $A$ and use it to obtain a closed-form expression for $\\kappa_{2}(A)$ as a function of $n$. Using asymptotic analysis in the limit $h \\to 0$ (equivalently $n \\to \\infty$), justify from first principles that $\\kappa_{2}(A)$ exhibits $O(h^{-2})$ growth and determine the leading-order constant multiplying $h^{-2}$. Express your final answer as a single closed-form analytic expression for $\\kappa_{2}(A)$ in terms of $n$. No rounding is required; the condition number is dimensionless and should be reported without units.",
            "solution": "The problem is subjected to validation.\n\n### Step 1: Extract Givens\n-   **Equation:** $-u''(x) = f(x)$\n-   **Domain:** $x \\in [0,1]$\n-   **Boundary Conditions:** $u(0) = 0$, $u(1) = 0$\n-   **Discretization:** $n$ interior points $x_i = i h$ for $i = 1,2,\\dots,n$\n-   **Grid Spacing:** $h = \\frac{1}{n+1}$\n-   **Scheme:** Second-order central finite difference\n-   **Linear System:** $A \\boldsymbol{u} = \\boldsymbol{f}$\n-   **Matrix Properties:** $A \\in \\mathbb{R}^{n \\times n}$ is symmetric positive definite (SPD) and tridiagonal Toeplitz.\n-   **Matrix Entries:** $A_{ii} = \\frac{2}{h^{2}}$, $A_{i,i+1} = A_{i+1,i} = -\\frac{1}{h^{2}}$ for $i = 1,2,\\dots,n-1$.\n-   **Definition:** $\\kappa_{2}(A) = \\|A\\|_{2} \\,\\|A^{-1}\\|_{2}$\n-   **Eigenvalue Problem:** $A \\boldsymbol{v} = \\lambda \\boldsymbol{v}$ with $\\boldsymbol{v}_0 = \\boldsymbol{v}_{n+1} = 0$.\n-   **Task 1:** Derive the spectrum of $A$ and obtain a closed-form expression for $\\kappa_{2}(A)$ as a function of $n$.\n-   **Task 2:** Perform asymptotic analysis for $h \\to 0$ ($n \\to \\infty$) to show $\\kappa_{2}(A)$ has $O(h^{-2})$ growth and find the leading-order constant.\n-   **Final Answer Format:** A single closed-form analytic expression for $\\kappa_{2}(A)$ in terms of $n$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, well-posed, and objective. It describes the standard finite difference discretization of the one-dimensional Poisson equation, a canonical problem in numerical analysis and a fundamental model in computational physics, including neutron diffusion. All mathematical definitions and properties are stated correctly and consistently. The problem is self-contained, providing all necessary information to derive the solution. There are no contradictions, ambiguities, or scientifically unsound premises.\n\n### Step 3: Verdict and Action\nThe problem is valid. The solution process will now proceed.\n\nThe matrix $A$ is symmetric positive definite (SPD). For any SPD matrix, the matrix $2$-norm, $\\|A\\|_2$, is its largest eigenvalue ($\\lambda_{\\text{max}}$), and the $2$-norm of its inverse, $\\|A^{-1}\\|_2$, is the reciprocal of its smallest eigenvalue ($\\lambda_{\\text{min}}$). The condition number $\\kappa_2(A)$ is therefore given by the ratio of the maximum to the minimum eigenvalue:\n$$\n\\kappa_2(A) = \\|A\\|_2 \\|A^{-1}\\|_2 = \\frac{\\lambda_{\\text{max}}(A)}{\\lambda_{\\text{min}}(A)}\n$$\nTo find $\\kappa_2(A)$, we must first determine the spectrum (the set of all eigenvalues) of the matrix $A$. The eigenvalue problem is $A \\boldsymbol{v} = \\lambda \\boldsymbol{v}$, where $\\boldsymbol{v}$ is an eigenvector and $\\lambda$ is its corresponding eigenvalue.\n\nThe matrix $A$ is given by $A = \\frac{1}{h^2} T$, where $T$ is the tridiagonal Toeplitz matrix:\n$$\nT = \\begin{pmatrix}\n2  -1  0  \\cdots  0 \\\\\n-1  2  -1  \\cdots  0 \\\\\n0  \\ddots  \\ddots  \\ddots  \\vdots \\\\\n\\vdots   -1  2  -1 \\\\\n0  \\cdots  0  -1  2\n\\end{pmatrix} \\in \\mathbb{R}^{n \\times n}\n$$\nThe eigenvalue problem $A \\boldsymbol{v} = \\lambda \\boldsymbol{v}$ can be written as $T\\boldsymbol{v} = (\\lambda h^2) \\boldsymbol{v}$. Let $\\mu = \\lambda h^2$ be an eigenvalue of $T$. The $i$-th component of this equation is:\n$$\n-v_{i-1} + 2v_i - v_{i+1} = \\mu v_i, \\quad i = 1, 2, \\dots, n\n$$\nWe rearrange this into a homogeneous second-order linear difference equation:\n$$\n-v_{i-1} + (2-\\mu)v_i - v_{i+1} = 0\n$$\nThe problem states that the discretization includes the homogeneous Dirichlet boundary conditions, which are encoded as $v_0 = 0$ and $v_{n+1} = 0$. We seek a non-trivial solution for the eigenvector components $v_i$. We use the ansatz $v_i = z^i$ for some complex number $z$. Substituting this into the difference equation yields:\n$$\n-z^{i-1} + (2-\\mu)z^i - z^{i+1} = 0\n$$\nDividing by $z^{i-1}$ (assuming $z \\neq 0$), we obtain the characteristic equation:\n$$\n-1 + (2-\\mu)z - z^2 = 0 \\quad \\implies \\quad z^2 - (2-\\mu)z + 1 = 0\n$$\nThe roots of this quadratic equation are $z_{1,2} = \\frac{(2-\\mu) \\pm \\sqrt{(2-\\mu)^2-4}}{2}$. Since the product of the roots is $z_1 z_2 = 1$, we can denote them by $z$ and $z^{-1}$. Let us set $z = e^{i\\theta}$ for some $\\theta$. The general solution for $v_i$ is a linear combination of the two forms:\n$v_i = C_1 z^i + C_2 z^{-i}$\nApplying the boundary condition $v_0 = 0$:\n$$\nv_0 = C_1 z^0 + C_2 z^{-0} = C_1 + C_2 = 0 \\implies C_2 = -C_1\n$$\nThis simplifies the solution to $v_i = C_1(z^i - z^{-i})$. If we set $z = e^{i\\theta}$, this becomes:\n$v_i = C_1(e^{i\\theta i} - e^{-i\\theta i}) = 2i C_1 \\sin(i\\theta)$\nLet a new constant $C = 2i C_1$. Then the form of the eigenvector components is $v_i = C \\sin(i\\theta)$.\nNow, we apply the second boundary condition, $v_{n+1}=0$:\n$$\nv_{n+1} = C \\sin((n+1)\\theta) = 0\n$$\nFor a non-trivial eigenvector, $C \\neq 0$, so we must have $\\sin((n+1)\\theta) = 0$. This implies $(n+1)\\theta = k\\pi$ for an integer $k$. Thus, the possible values for $\\theta$ are:\n$$\n\\theta_k = \\frac{k\\pi}{n+1}, \\quad k = 1, 2, \\dots, n\n$$\nThe values $k=0$ and $k=n+1$ yield trivial eigenvectors ($v_i=0$ for all $i$), and other integer values of $k$ lead to eigenvectors that are equivalent (up to a sign) to those for $k \\in \\{1, \\dots, n\\}$. So, we have $n$ distinct eigenvectors, whose components are given by:\n$$\n(v_k)_i = \\sin\\left(\\frac{ik\\pi}{n+1}\\right), \\quad i=1, \\dots, n \\quad \\text{for each } k=1, \\dots, n\n$$\nNow we find the eigenvalues $\\mu_k$ corresponding to each eigenvector $v_k$. From the characteristic equation, we have $2-\\mu = z + z^{-1}$. With $z = e^{i\\theta_k}$, this becomes:\n$2-\\mu_k = e^{i\\theta_k} + e^{-i\\theta_k} = 2\\cos(\\theta_k)$\nSolving for $\\mu_k$:\n$\\mu_k = 2 - 2\\cos(\\theta_k) = 4\\sin^2\\left(\\frac{\\theta_k}{2}\\right)$\nSubstituting $\\theta_k = \\frac{k\\pi}{n+1}$:\n$$\n\\mu_k = 4\\sin^2\\left(\\frac{k\\pi}{2(n+1)}\\right), \\quad k = 1, 2, \\dots, n\n$$\nThese are the eigenvalues of the matrix $T$. The eigenvalues $\\lambda_k$ of the original matrix $A = \\frac{1}{h^2}T$ are:\n$$\n\\lambda_k = \\frac{\\mu_k}{h^2} = \\frac{4}{h^2}\\sin^2\\left(\\frac{k\\pi}{2(n+1)}\\right), \\quad k = 1, 2, \\dots, n\n$$\nThe sine function is monotonically increasing on the interval $[0, \\frac{\\pi}{2}]$. The argument $\\frac{k\\pi}{2(n+1)}$ is in this range for all $k \\in \\{1, \\dots, n\\}$, since $\\frac{n\\pi}{2(n+1)}  \\frac{\\pi}{2}$.\nThe minimum eigenvalue $\\lambda_{\\text{min}}$ occurs at $k=1$:\n$$\n\\lambda_{\\text{min}} = \\lambda_1 = \\frac{4}{h^2}\\sin^2\\left(\\frac{\\pi}{2(n+1)}\\right)\n$$\nThe maximum eigenvalue $\\lambda_{\\text{max}}$ occurs at $k=n$:\n$$\n\\lambda_{\\text{max}} = \\lambda_n = \\frac{4}{h^2}\\sin^2\\left(\\frac{n\\pi}{2(n+1)}\\right)\n$$\nNow, we can compute the condition number:\n$$\n\\kappa_2(A) = \\frac{\\lambda_{\\text{max}}}{\\lambda_{\\text{min}}} = \\frac{\\frac{4}{h^2}\\sin^2\\left(\\frac{n\\pi}{2(n+1)}\\right)}{\\frac{4}{h^2}\\sin^2\\left(\\frac{\\pi}{2(n+1)}\\right)} = \\frac{\\sin^2\\left(\\frac{n\\pi}{2(n+1)}\\right)}{\\sin^2\\left(\\frac{\\pi}{2(n+1)}\\right)}\n$$\nUsing the identity $\\sin(x) = \\cos(\\frac{\\pi}{2}-x)$, we can rewrite the numerator:\n$$\n\\sin\\left(\\frac{n\\pi}{2(n+1)}\\right) = \\sin\\left(\\frac{(n+1-1)\\pi}{2(n+1)}\\right) = \\sin\\left(\\frac{\\pi}{2} - \\frac{\\pi}{2(n+1)}\\right) = \\cos\\left(\\frac{\\pi}{2(n+1)}\\right)\n$$\nSubstituting this back into the expression for $\\kappa_2(A)$:\n$$\n\\kappa_2(A) = \\frac{\\cos^2\\left(\\frac{\\pi}{2(n+1)}\\right)}{\\sin^2\\left(\\frac{\\pi}{2(n+1)}\\right)} = \\cot^2\\left(\\frac{\\pi}{2(n+1)}\\right)\n$$\nThis is the closed-form expression for $\\kappa_2(A)$ as a function of $n$.\n\nFor the asymptotic analysis as $h \\to 0$ (which implies $n \\to \\infty$), we consider the argument of the cotangent function, $x = \\frac{\\pi}{2(n+1)}$. As $n \\to \\infty$, $x \\to 0$. We use the small-angle approximation for the cotangent function, which can be derived from the Taylor series of sine and cosine:\n$\\sin(x) = x - O(x^3)$ and $\\cos(x) = 1 - O(x^2)$.\n$$\n\\cot(x) = \\frac{\\cos(x)}{\\sin(x)} \\approx \\frac{1}{x} \\quad \\text{for } x \\ll 1\n$$\nTherefore, for large $n$:\n$$\n\\kappa_2(A) = \\cot^2(x) \\approx \\left(\\frac{1}{x}\\right)^2 = \\frac{1}{x^2} = \\frac{1}{\\left(\\frac{\\pi}{2(n+1)}\\right)^2} = \\frac{4(n+1)^2}{\\pi^2}\n$$\nGiven the definition $h = \\frac{1}{n+1}$, we can express this in terms of $h$:\n$$\n\\kappa_2(A) \\approx \\frac{4(1/h)^2}{\\pi^2} = \\frac{4}{\\pi^2 h^2} = \\frac{4}{\\pi^2} h^{-2}\n$$\nThis justifies from first principles that $\\kappa_2(A)$ exhibits $O(h^{-2})$ growth, and the leading-order constant multiplying $h^{-2}$ is $\\frac{4}{\\pi^2}$. The problem asks for the single closed-form expression for $\\kappa_2(A)$ in terms of $n$, which was derived prior to the asymptotic analysis.",
            "answer": "$$\n\\boxed{\\cot^2\\left(\\frac{\\pi}{2(n+1)}\\right)}\n$$"
        },
        {
            "introduction": "Next, we pivot to a completely different philosophy for solving boundary value problems known as the shooting method. Instead of building a large matrix for the entire domain, this technique cleverly recasts the BVP as an initial value problem and iteratively \"shoots\" to find the correct boundary condition. This practice focuses on a crucial aspect of the method's reliability: its sensitivity to the initial guess, which you will analyze by deriving the variational equation that governs error propagation .",
            "id": "3545163",
            "problem": "Consider steady, one-group neutron diffusion in a homogeneous slab of thickness $L$, with constant diffusion coefficient $D>0$, macroscopic absorption cross section $\\Sigma_{a}>0$, and a prescribed volumetric source $S(x)$, governed by the second-order ordinary differential equation\n$$D\\,\\frac{d^{2}\\phi}{dx^{2}}-\\Sigma_{a}\\,\\phi+S(x)=0\\quad\\text{for }x\\in[0,L].$$\nImpose two-point Dirichlet boundary conditions $\\phi(0)=\\phi_{0}$ and $\\phi(L)=\\phi_{L}$, forming a boundary value problem (BVP). A classical shooting strategy converts this to an initial value problem (IVP) by choosing the initial slope $s=\\phi'(0)$, integrating the IVP to $x=L$, and then defining the boundary residual\n$$R(s)=\\phi(L;s)-\\phi_{L},$$\nwhere $\\phi(x;s)$ denotes the solution obtained by integrating the IVP with initial conditions $\\phi(0)=\\phi_{0}$ and $\\phi'(0)=s$.\n\nStarting from first principles appropriate for boundary value problem solvers in computational nuclear physics, including the governing diffusion equation, linearization, and fundamental solution concepts, derive how a small error $\\delta s$ in the chosen initial slope propagates to the boundary residual at $x=L$. Specifically:\n1. Non-dimensionalize the slab coordinate by $x=L\\hat{x}$, and define the dimensionless parameter $\\kappa^{2}=\\Sigma_{a}L^{2}/D$. Write the dimensionless diffusion BVP on $\\hat{x}\\in[0,1]$ and the corresponding shooting residual $R(s)$.\n2. Derive the variational (sensitivity) equation that governs $\\partial\\phi/\\partial s$ and show how the derivative of the residual with respect to the initial slope, $dR/ds$, can be expressed in terms of the fundamental solutions of the associated homogeneous variational equation.\n3. For the constant-coefficient case given above, evaluate $dR/ds$ explicitly in closed form as a function of $\\kappa$.\n\nYour final answer must be a single closed-form analytic expression for the dimensionless sensitivity $dR/ds$ at $\\hat{x}=1$. No rounding is required. Do not include units in your final expression. Express the final answer exactly.",
            "solution": "The problem asks for the sensitivity of the boundary residual in a shooting method to a small change in the initial slope guess for a one-dimensional, steady-state neutron diffusion equation. The derivation will proceed in three parts as requested: non-dimensionalization, derivation of the variational equation, and explicit evaluation of the sensitivity.\n\nThe governing boundary value problem (BVP) is given by the differential equation\n$$D\\,\\frac{d^{2}\\phi}{dx^{2}}-\\Sigma_{a}\\,\\phi+S(x)=0\\quad\\text{for }x\\in[0,L]$$\nwith Dirichlet boundary conditions $\\phi(0)=\\phi_{0}$ and $\\phi(L)=\\phi_{L}$. The parameters $D$ and $\\Sigma_{a}$ are positive constants. The shooting method converts this BVP into an initial value problem (IVP) by setting $\\phi(0)=\\phi_{0}$ and guessing the initial slope $\\phi'(0)=s$. The resulting solution at the other end of the domain, $\\phi(L;s)$, is used to define a residual function $R(s) = \\phi(L;s) - \\phi_{L}$, which is zero when the correct slope $s$ is found.\n\n**1. Non-dimensionalization**\n\nTo non-dimensionalize the problem, we introduce a dimensionless coordinate $\\hat{x}$ defined by $x=L\\hat{x}$. The domain $x\\in[0,L]$ transforms to $\\hat{x}\\in[0,1]$. We use the chain rule to transform the derivatives:\n$$\\frac{d}{dx} = \\frac{d\\hat{x}}{dx}\\frac{d}{d\\hat{x}} = \\frac{1}{L}\\frac{d}{d\\hat{x}}$$\n$$\\frac{d^{2}}{dx^{2}} = \\frac{d}{dx}\\left(\\frac{1}{L}\\frac{d}{d\\hat{x}}\\right) = \\frac{1}{L^{2}}\\frac{d^{2}}{d\\hat{x}^{2}}$$\nSubstituting these into the diffusion equation gives:\n$$D\\left(\\frac{1}{L^{2}}\\frac{d^{2}\\phi}{d\\hat{x}^{2}}\\right) - \\Sigma_{a}\\phi + S(L\\hat{x}) = 0$$\nMultiplying by $L^{2}/D$ yields:\n$$\\frac{d^{2}\\phi}{d\\hat{x}^{2}} - \\frac{\\Sigma_{a}L^{2}}{D}\\phi + \\frac{L^{2}}{D}S(L\\hat{x}) = 0$$\nUsing the given definition for the dimensionless parameter $\\kappa^{2}=\\Sigma_{a}L^{2}/D$ and defining a dimensionless source term $\\hat{S}(\\hat{x}) = (L^{2}/D)S(L\\hat{x})$, we obtain the dimensionless BVP:\n$$\\frac{d^{2}\\phi}{d\\hat{x}^{2}} - \\kappa^{2}\\phi + \\hat{S}(\\hat{x}) = 0, \\quad \\hat{x}\\in[0,1]$$\nThe boundary conditions remain $\\phi(0)=\\phi_{0}$ and $\\phi(1)=\\phi_{L}$.\n\nFor the shooting method, the dimensional slope is $s = \\frac{d\\phi}{dx}|_{x=0}$. In dimensionless terms, the slope is $\\hat{s} = \\frac{d\\phi}{d\\hat{x}}|_{\\hat{x}=0}$. The two are related by:\n$$\\hat{s} = \\frac{d\\phi}{d\\hat{x}}|_{\\hat{x}=0} = \\left(L\\frac{d\\phi}{dx}\\right)|_{x=0} = Ls$$\nThe residual $R(s) = \\phi(L;s) - \\phi_{L}$ can be expressed as a function of the dimensionless slope $\\hat{s}$ as $\\hat{R}(\\hat{s}) = \\phi(1;\\hat{s}) - \\phi_{L}$.\n\n**2. Variational Equation and Sensitivity Derivative**\n\nWe are asked to find the sensitivity of the residual to the slope, which is the derivative $dR/ds$. The \"dimensionless sensitivity\" is most naturally interpreted as the derivative of the residual with respect to the dimensionless slope, $d\\hat{R}/d\\hat{s}$. The two derivatives are related by the chain rule:\n$$\\frac{dR}{ds} = \\frac{d\\hat{R}}{d\\hat{s}}\\frac{d\\hat{s}}{ds} = \\frac{d\\hat{R}}{d\\hat{s}}\\frac{d(Ls)}{ds} = L\\frac{d\\hat{R}}{d\\hat{s}}$$\nSo the dimensionless sensitivity is $\\frac{1}{L}\\frac{dR}{ds} = \\frac{d\\hat{R}}{d\\hat{s}}$. Let us derive this quantity.\n\nBy definition, $\\frac{d\\hat{R}}{d\\hat{s}} = \\frac{d}{d\\hat{s}}\\left(\\phi(1;\\hat{s}) - \\phi_{L}\\right) = \\frac{\\partial\\phi}{\\partial\\hat{s}}(1;\\hat{s})$.\nLet us define the sensitivity function $\\hat{\\psi}(\\hat{x}) = \\frac{\\partial\\phi}{\\partial\\hat{s}}(\\hat{x};\\hat{s})$. To find the governing equation for $\\hat{\\psi}(\\hat{x})$, we differentiate the dimensionless ODE with respect to $\\hat{s}$:\n$$\\frac{\\partial}{\\partial\\hat{s}}\\left(\\frac{d^{2}\\phi}{d\\hat{x}^{2}} - \\kappa^{2}\\phi + \\hat{S}(\\hat{x})\\right) = \\frac{\\partial}{\\partial\\hat{s}}(0)$$\nSince the order of differentiation can be interchanged and $\\kappa$ and $\\hat{S}(\\hat{x})$ are independent of the slope guess $\\hat{s}$, we get:\n$$\\frac{d^{2}}{d\\hat{x}^{2}}\\left(\\frac{\\partial\\phi}{\\partial\\hat{s}}\\right) - \\kappa^{2}\\left(\\frac{\\partial\\phi}{\\partial\\hat{s}}\\right) = 0$$\nThis yields the variational equation for the sensitivity function $\\hat{\\psi}(\\hat{x})$:\n$$\\frac{d^{2}\\hat{\\psi}}{d\\hat{x}^{2}} - \\kappa^{2}\\hat{\\psi} = 0$$\nThis is a homogeneous linear second-order ODE. To solve it, we need initial conditions. These are found by differentiating the initial conditions of the shooting IVP with respect to $\\hat{s}$:\n\\begin{enumerate}\n    \\item $\\phi(0;\\hat{s}) = \\phi_{0}$. Differentiating with respect to $\\hat{s}$ gives $\\frac{\\partial\\phi}{\\partial\\hat{s}}(0;\\hat{s}) = 0$, so $\\hat{\\psi}(0)=0$.\n    \\item $\\frac{d\\phi}{d\\hat{x}}(0;\\hat{s}) = \\hat{s}$. Differentiating with respect to $\\hat{s}$ gives $\\frac{\\partial}{\\partial\\hat{s}}\\left(\\frac{d\\phi}{d\\hat{x}}(0;\\hat{s})\\right) = 1$. Interchanging derivatives, we get $\\frac{d}{d\\hat{x}}\\left(\\frac{\\partial\\phi}{\\partial\\hat{s}}\\right)(0;\\hat{s}) = 1$, so $\\frac{d\\hat{\\psi}}{d\\hat{x}}(0)=1$.\n\\end{enumerate}\nThe desired dimensionless sensitivity is $d\\hat{R}/d\\hat{s} = \\hat{\\psi}(1)$. The problem asks to relate this to the fundamental solutions of the homogeneous variational equation. If we choose a basis of fundamental solutions $u_1(\\hat{x})$ and $u_2(\\hat{x})$ satisfying the initial conditions $u_1(0)=1, u_1'(0)=0$ and $u_2(0)=0, u_2'(0)=1$, then the solution to the IVP for $\\hat{\\psi}(\\hat{x})$ is $\\hat{\\psi}(\\hat{x}) = \\hat{\\psi}(0)u_1(\\hat{x}) + \\hat{\\psi}'(0)u_2(\\hat{x}) = 0 \\cdot u_1(\\hat{x}) + 1 \\cdot u_2(\\hat{x}) = u_2(\\hat{x})$. Therefore, the dimensionless sensitivity is precisely the value of the second fundamental solution at the boundary, i.e., $d\\hat{R}/d\\hat{s} = u_2(1)$.\n\n**3. Explicit Closed-Form Evaluation**\n\nWe now solve the IVP for $\\hat{\\psi}(\\hat{x})$ to find an explicit expression for the dimensionless sensitivity. The equation is $\\hat{\\psi}'' - \\kappa^{2}\\hat{\\psi} = 0$. The characteristic equation is $r^{2} - \\kappa^{2} = 0$, with roots $r = \\pm\\kappa$. The general solution is conveniently written using hyperbolic functions:\n$$\\hat{\\psi}(\\hat{x}) = C_{1}\\cosh(\\kappa\\hat{x}) + C_{2}\\sinh(\\kappa\\hat{x})$$\nWe apply the initial conditions, $\\hat{\\psi}(0)=0$ and $\\hat{\\psi}'(0)=1$:\n$$\\hat{\\psi}(0) = C_{1}\\cosh(0) + C_{2}\\sinh(0) = C_{1} \\cdot 1 + C_{2} \\cdot 0 = C_{1}$$\nSo, $C_{1}=0$. The solution simplifies to $\\hat{\\psi}(\\hat{x}) = C_{2}\\sinh(\\kappa\\hat{x})$. Now we use the second initial condition on the derivative, $\\hat{\\psi}'(\\hat{x}) = C_{2}\\kappa\\cosh(\\kappa\\hat{x})$:\n$$\\hat{\\psi}'(0) = C_{2}\\kappa\\cosh(0) = C_{2}\\kappa \\cdot 1 = C_{2}\\kappa$$\nWe require $\\hat{\\psi}'(0)=1$, so $C_{2}\\kappa = 1$, which gives $C_{2} = 1/\\kappa$.\n\nThe sensitivity function is therefore:\n$$\\hat{\\psi}(\\hat{x}) = \\frac{\\sinh(\\kappa\\hat{x})}{\\kappa}$$\nThe dimensionless sensitivity is the value of this function at the boundary $\\hat{x}=1$:\n$$\\frac{d\\hat{R}}{d\\hat{s}} = \\hat{\\psi}(1) = \\frac{\\sinh(\\kappa)}{\\kappa}$$\nThis is the final closed-form expression for the dimensionless sensitivity as a function of $\\kappa$. This quantity describes how an error in the initial guess for the dimensionless slope $\\hat{s}$ propagates to the residual at the far boundary $\\hat{x}=1$. For a linear problem like this one, the residual $\\hat{R}$ is a linear function of $\\hat{s}$, and $\\hat{\\psi}(1)$ is the constant slope of this line.",
            "answer": "$$\\boxed{\\frac{\\sinh(\\kappa)}{\\kappa}}$$"
        },
        {
            "introduction": "Our final practice tackles the Finite Element Method (FEM), a powerful and versatile framework that is a cornerstone of modern computational engineering and physics. You will work through the key steps of applying FEM to a one-dimensional neutron diffusion equation, a problem with direct relevance to nuclear reactor physics. This exercise will guide you from deriving the variational (or weak) formulation to assembling the system matrix for a problem with spatially varying coefficients and non-homogeneous boundary conditions, demonstrating the method's robustness and generality .",
            "id": "3545228",
            "problem": "Consider the nondimensional, one-dimensional, steady-state, one-group neutron diffusion boundary value problem on the interval $[0,1]$:\n$$\n-\\frac{d}{dx}\\!\\left(p(x)\\,\\frac{du}{dx}\\right) + q(x)\\,u(x) = s(x),\n$$\nwith Dirichlet boundary conditions $u(0)=\\alpha$ and $u(1)=\\beta$. Here $p(x)$ models the spatially varying diffusion coefficient, $q(x)$ models the spatially varying macroscopic absorption, and $s(x)$ is a volumetric neutron source. Work in nondimensional units.\n\nTasks:\n- Starting from the strong form, derive the weak form using the standard variational framework for second-order linear elliptic operators. Clearly identify the bilinear form and the linear functional and specify the associated function spaces. Define any acronyms on first use (e.g., Finite Element Method (FEM), Partial Differential Equation (PDE)).\n- Introduce a lifting function $l(x)$ that enforces the Dirichlet boundary data, write $u = w + l$ with $w \\in H_0^1(0,1)$, and show how the right-hand side is modified in the weak form.\n- For the FEM with continuous, piecewise-linear shape functions on a generic element $e = [x_i,x_{i+1}]$ of length $h_i = x_{i+1}-x_i$, derive, from first principles, the element stiffness matrix and element load vector in terms of $p(x)$, $q(x)$, $s(x)$, and the lifting $l(x)$:\n  - Express $K^{(e)}_{ab}$ for $a,b \\in \\{i,i+1\\}$ as integrals involving $p(x)$, $q(x)$, and the element shape functions and their derivatives.\n  - Express $f^{(e)}_{a}$ for $a \\in \\{i,i+1\\}$ as integrals involving $s(x)$, $p(x)$, $q(x)$, $l(x)$, and the element shape functions and their derivatives.\n- Specialize to the case\n$$\np(x) = 1 + x,\\qquad q(x) = x,\\qquad s(x) = 1 + x^2,\n$$\nwith Dirichlet data $\\alpha = 0.2$ and $\\beta = 0.6$. Choose the linear lifting $l(x) = \\alpha + (\\beta-\\alpha)\\,x$. Use a uniform mesh with $2$ linear finite elements and nodes at $x_0=0$, $x_1=0.5$, $x_2=1$. Assemble the global system for the single interior unknown and compute the finite element approximation $u_h(x_1)$ exactly.\n\nAnswer form:\n- Provide your final answer as the single scalar value of $u_h(0.5)$.\n- Express the final answer as an exact rational number. Do not include units.",
            "solution": "We begin from the steady-state one-group neutron diffusion Partial Differential Equation (PDE):\n$$\n-\\frac{d}{dx}\\!\\left(p(x)\\,\\frac{du}{dx}\\right) + q(x)\\,u(x) = s(x)\\quad \\text{in } (0,1),\n$$\nwith Dirichlet boundary conditions $u(0)=\\alpha$ and $u(1)=\\beta$. We seek a weak (variational) formulation on the Sobolev space $H^1(0,1)$ with trial functions satisfying the boundary conditions. Let $V := H_0^1(0,1)$ and let test functions $v \\in V$. Multiply the PDE by $v$ and integrate by parts the diffusion term:\n$$\n\\int_0^1 p(x)\\,u'(x)\\,v'(x)\\,dx + \\int_0^1 q(x)\\,u(x)\\,v(x)\\,dx = \\int_0^1 s(x)\\,v(x)\\,dx,\n$$\nwhere the boundary term vanishes because $v(0)=v(1)=0$. Define the bilinear form\n$$\na(u,v) := \\int_0^1 p(x)\\,u'(x)\\,v'(x)\\,dx + \\int_0^1 q(x)\\,u(x)\\,v(x)\\,dx,\n$$\nand the linear functional\n$$\n\\ell(v) := \\int_0^1 s(x)\\,v(x)\\,dx.\n$$\nThe weak problem is: find $u \\in H^1(0,1)$ with $u(0)=\\alpha$, $u(1)=\\beta$ such that\n$$\na(u,v) = \\ell(v)\\quad \\forall v \\in V.\n$$\n\nTo impose Dirichlet boundary data via a lifting function, choose $l \\in H^1(0,1)$ with $l(0)=\\alpha$ and $l(1)=\\beta$, and write $u = w + l$, where $w \\in V$. Substituting into the weak form gives\n$$\na(w+l,v) = \\ell(v)\\quad \\forall v \\in V,\n$$\nhence\n$$\na(w,v) = \\ell(v) - a(l,v) = \\int_0^1 s(x)\\,v(x)\\,dx - \\int_0^1 p(x)\\,l'(x)\\,v'(x)\\,dx - \\int_0^1 q(x)\\,l(x)\\,v(x)\\,dx.\n$$\nThus, the lifting modifies only the right-hand side as\n$$\nf(v) := \\int_0^1 s(x)\\,v(x)\\,dx - \\int_0^1 p(x)\\,l'(x)\\,v'(x)\\,dx - \\int_0^1 q(x)\\,l(x)\\,v(x)\\,dx,\n$$\nwhile the bilinear form $a(\\cdot,\\cdot)$ on $V$ remains unchanged.\n\nFor the Finite Element Method (FEM), consider an element $e=[x_i,x_{i+1}]$ with length $h_i = x_{i+1}-x_i$. Let $\\{N_i,N_{i+1}\\}$ be the element’s linear shape functions, with $N_i(x_i)=1$, $N_i(x_{i+1})=0$, $N_{i+1}(x_i)=0$, $N_{i+1}(x_{i+1})=1$, and $N_i' = -1/h_i$, $N_{i+1}' = 1/h_i$. The element stiffness matrix entries are derived directly from the bilinear form:\n$$\nK^{(e)}_{ab} = \\int_{x_i}^{x_{i+1}} p(x)\\,N_a'(x)\\,N_b'(x)\\,dx + \\int_{x_i}^{x_{i+1}} q(x)\\,N_a(x)\\,N_b(x)\\,dx,\\quad a,b\\in\\{i,i+1\\}.\n$$\nThe element load vector entries, using the lifted right-hand side, are\n$$\nf^{(e)}_{a} = \\int_{x_i}^{x_{i+1}} s(x)\\,N_a(x)\\,dx - \\int_{x_i}^{x_{i+1}} p(x)\\,l'(x)\\,N_a'(x)\\,dx - \\int_{x_i}^{x_{i+1}} q(x)\\,l(x)\\,N_a(x)\\,dx,\\quad a\\in\\{i,i+1\\}.\n$$\nGlobal assembly follows from standard finite element procedures by summing contributions from adjacent elements to shared global degrees of freedom.\n\nNow specialize to\n$$\np(x)=1+x,\\quad q(x)=x,\\quad s(x)=1+x^2,\n$$\nwith Dirichlet data $\\alpha=0.2$ and $\\beta=0.6$. Choose the linear lifting\n$$\nl(x) = \\alpha + (\\beta-\\alpha)\\,x = 0.2 + 0.4\\,x,\n$$\nso $l'(x)=0.4$. Use the uniform mesh with $2$ elements and nodes $x_0=0$, $x_1=0.5$, $x_2=1$. The discrete unknown is the single interior degree of freedom $w_1 \\approx w(x_1)$ associated with the global hat basis function $\\phi_1$. The global stiffness for $w_1$ is\n$$\nK_{11} = \\int_0^1 p(x)\\,(\\phi_1'(x))^2\\,dx + \\int_0^1 q(x)\\,(\\phi_1(x))^2\\,dx.\n$$\nOn $[0,0.5]$, $\\phi_1(x)=2x$ and $\\phi_1'(x)=2$. On $[0.5,1]$, $\\phi_1(x)=2(1-x)$ and $\\phi_1'(x)=-2$.\n\nCompute the diffusion part:\n$$\n\\int_0^{0.5} (1+x)\\,(2)^2 dx = 4\\int_0^{0.5} (1+x)\\,dx = 4\\left(\\frac{5}{8}\\right)=\\frac{5}{2},\n$$\n$$\n\\int_{0.5}^{1} (1+x)\\,( -2)^2 dx = 4\\int_{0.5}^{1} (1+x)\\,dx = 4\\left(\\frac{7}{8}\\right)=\\frac{7}{2}.\n$$\nThus the diffusion contribution sums to $\\frac{5}{2}+\\frac{7}{2}=6$.\n\nCompute the absorption part:\n$$\n\\int_0^{0.5} x\\,(2x)^2\\,dx = \\int_0^{0.5} 4x^3\\,dx = \\left[x^4\\right]_0^{0.5} = \\frac{1}{16},\n$$\n$$\n\\int_{0.5}^{1} x\\,[2(1-x)]^2\\,dx = \\int_{0.5}^{1} 4x(1-2x+x^2)\\,dx = \\frac{5}{48}.\n$$\nThus the absorption contribution is $\\frac{1}{16}+\\frac{5}{48}=\\frac{1}{6}$. Therefore\n$$\nK_{11} = 6 + \\frac{1}{6} = \\frac{37}{6}.\n$$\n\nNext compute the lifted right-hand side for the single test function $\\phi_1$:\n$$\nf_1 = \\int_0^1 s(x)\\,\\phi_1(x)\\,dx - \\int_0^1 p(x)\\,l'(x)\\,\\phi_1'(x)\\,dx - \\int_0^1 q(x)\\,l(x)\\,\\phi_1(x)\\,dx.\n$$\nCompute each term piecewise.\n\nSource term:\nOn $[0,0.5]$, $(1+x^2)\\,(2x) = 2x + 2x^3$ gives\n$$\n\\int_0^{0.5} (2x + 2x^3)\\,dx = \\left[x^2 + \\frac{x^4}{2}\\right]_0^{0.5} = \\frac{1}{4}+\\frac{1}{32} = \\frac{9}{32}.\n$$\nOn $[0.5,1]$, $(1+x^2)\\,2(1-x) = 2 - 2x + 2x^2 - 2x^3$ gives\n$$\n\\int_{0.5}^{1} (2 - 2x + 2x^2 - 2x^3)\\,dx = \\left[2x - x^2 + \\frac{2}{3}x^3 - \\frac{1}{2}x^4\\right]_{0.5}^{1} = \\frac{35}{96}.\n$$\nThus\n$$\n\\int_0^1 s(x)\\,\\phi_1(x)\\,dx = \\frac{9}{32} + \\frac{35}{96} = \\frac{31}{48}.\n$$\n\nLifting–diffusion coupling term:\nSince $l'(x)=0.4=\\frac{2}{5}$ and $\\phi_1'$ is constant on each subinterval,\n$$\n\\int_0^1 p(x)\\,l'(x)\\,\\phi_1'(x)\\,dx = \\frac{2}{5}\\left[2\\int_0^{0.5}(1+x)\\,dx - 2\\int_{0.5}^{1}(1+x)\\,dx\\right]\n= \\frac{2}{5}\\left[2\\cdot\\frac{5}{8} - 2\\cdot\\frac{7}{8}\\right] = -\\frac{1}{5}.\n$$\n\nLifting–absorption coupling term:\nOn $[0,0.5]$, $x\\,l(x)\\,\\phi_1(x) = x\\,(0.2+0.4x)\\,(2x) = 0.4 x^2 + 0.8 x^3$, hence\n$$\n\\int_0^{0.5} \\left(0.4 x^2 + 0.8 x^3\\right)\\,dx = \\frac{1}{60} + \\frac{1}{80} = \\frac{7}{240}.\n$$\nOn $[0.5,1]$, $x\\,l(x)\\,\\phi_1(x) = x\\,(0.2+0.4x)\\,2(1-x) = 0.4 x + 0.4 x^2 - 0.8 x^3$, hence\n$$\n\\int_{0.5}^{1} \\left(0.4 x + 0.4 x^2 - 0.8 x^3\\right)\\,dx \n= \\left[\\frac{1}{5}x^2 + \\frac{2}{15}x^3 - \\frac{1}{5}x^4\\right]_{0.5}^{1} = \\frac{19}{240}.\n$$\nTherefore\n$$\n\\int_0^1 q(x)\\,l(x)\\,\\phi_1(x)\\,dx = \\frac{7}{240} + \\frac{19}{240} = \\frac{13}{120}.\n$$\n\nCollecting the terms,\n$$\nf_1 = \\frac{31}{48} - \\left(-\\frac{1}{5}\\right) - \\frac{13}{120} = \\frac{31}{48} + \\frac{1}{5} - \\frac{13}{120} = \\frac{59}{80}.\n$$\n\nThe discrete equation for the single unknown $w_1$ is\n$$\nK_{11}\\,w_1 = f_1 \\quad \\Longrightarrow \\quad w_1 = \\frac{f_1}{K_{11}} = \\frac{\\frac{59}{80}}{\\frac{37}{6}} = \\frac{177}{1480}.\n$$\nRecover $u_h$ at the interior node by adding the lifting:\n$$\nu_h(0.5) = w_1 + l(0.5) = \\frac{177}{1480} + \\left(0.2 + 0.4\\cdot 0.5\\right) = \\frac{177}{1480} + \\frac{2}{5} = \\frac{177}{1480} + \\frac{592}{1480} = \\frac{769}{1480}.\n$$\nThis is the exact rational value of the finite element approximation at $x=0.5$ with the specified data.",
            "answer": "$$\\boxed{\\frac{769}{1480}}$$"
        }
    ]
}