{
    "hands_on_practices": [
        {
            "introduction": "玻恩近似是求解Lippmann-Schwinger方程最直接的出发点，然而，任何近似的价值都在于了解其适用范围。本练习  提供了一个通过第一性原理推导此有效性判据的实践机会。通过直接比较玻恩级数的前两项，您将亲手得出一个衡量近似误差的无量纲参数，从而深刻理解何时可以信赖玻恩近似，以及何时必须采用更精确的数值方法。",
            "id": "3603440",
            "problem": "考虑两个无自旋核子在非相对论性体系中的弹性散射，该过程由含中心势的定态薛定谔方程描述。设相互作用为汤川形式，$V(r) = -\\alpha \\exp(-\\mu r)/r$，其中 $\\alpha > 0$ 是强度参数，$\\mu > 0$ 决定了作用范围。在动量空间中，过渡矩阵（T-矩阵）满足 Lippmann-Schwinger 方程，\n$$\nT(\\mathbf{k}',\\mathbf{k};E) = V(\\mathbf{k}'-\\mathbf{k}) + \\int \\frac{d^{3}p}{(2\\pi)^{3}} \\, V(\\mathbf{k}'-\\mathbf{p}) \\, G_{0}^{(+)}(E;p) \\, T(\\mathbf{p},\\mathbf{k};E),\n$$\n其中 $G_{0}^{(+)}(E;p) = \\big(E - \\hbar^{2} p^{2}/(2m) + i0\\big)^{-1}$ 是自由预解式，$m$ 是折合质量，$E = \\hbar^{2} k^{2}/(2m)$ 是在壳能量。散射振幅与 T-矩阵的关系为 $f(\\mathbf{k}',\\mathbf{k}) = -\\frac{m}{2\\pi \\hbar^{2}} T(\\mathbf{k}',\\mathbf{k};E)$。\n\n在前向散射（$\\mathbf{k}'=\\mathbf{k}$）和零动量极限 $k \\to 0$ 的情况下，使用 Lippmann-Schwinger 方程构建最高至二阶的玻恩级数，并通过以下比值来估计一阶玻恩近似的相对误差大小\n$$\nR \\equiv \\frac{|f^{(2)}(0)|}{|f^{(1)}(0)|},\n$$\n其中 $f^{(1)}$ 和 $f^{(2)}$ 分别表示对前向振幅的一阶和二阶玻恩贡献。从 Lippmann-Schwinger 方程出发，依据第一性原理推导 $R$，并将您的最终估计表示为由 $m$、$\\alpha$、$\\mu$ 和 $\\hbar$ 构成的单个闭合形式的解析表达式。您的最终答案必须是一个无量纲的解析表达式。不要提供任何数值计算。",
            "solution": "该问题要求计算在零能量下，前向散射振幅的一阶玻恩近似的相对误差。该误差由比值 $R \\equiv |f^{(2)}(0)|/|f^{(1)}(0)|$ 估计，其中 $f^{(1)}$ 和 $f^{(2)}$ 分别是散射振幅的一阶和二阶玻恩近似。计算始于已给出的 T-矩阵的 Lippmann-Schwinger 方程。\n\n过渡矩阵 $T(\\mathbf{k}',\\mathbf{k};E)$ 的 Lippmann-Schwinger 方程为：\n$$\nT(\\mathbf{k}',\\mathbf{k};E) = V(\\mathbf{k}'-\\mathbf{k}) + \\int \\frac{d^{3}p}{(2\\pi)^{3}} \\, V(\\mathbf{k}'-\\mathbf{p}) \\, G_{0}^{(+)}(E;p) \\, T(\\mathbf{p},\\mathbf{k};E)\n$$\n玻恩级数是通过迭代此方程生成的。一阶项，即一阶玻恩近似，由下式给出：\n$$\nT^{(1)}(\\mathbf{k}',\\mathbf{k}) = V(\\mathbf{k}'-\\mathbf{k})\n$$\n二阶项，即二阶玻恩近似，是通过将 $T^{(1)}$ 代入 Lippmann-Schwinger 方程的积分项得到的：\n$$\nT^{(2)}(\\mathbf{k}',\\mathbf{k};E) = \\int \\frac{d^{3}p}{(2\\pi)^{3}} \\, V(\\mathbf{k}'-\\mathbf{p}) \\, G_{0}^{(+)}(E;p) \\, V(\\mathbf{p}-\\mathbf{k})\n$$\n散射振幅 $f(\\mathbf{k}',\\mathbf{k})$ 与 T-矩阵的关系为：\n$$\nf(\\mathbf{k}',\\mathbf{k}) = -\\frac{m}{2\\pi \\hbar^{2}} T(\\mathbf{k}',\\mathbf{k};E)\n$$\n其中 $m$ 是折合质量，$E = \\hbar^{2} k^{2}/(2m)$ 是在壳能量。\n\n首先，我们需要汤川势 $V(r) = -\\alpha \\exp(-\\mu r)/r$ 的动量空间表示。这是它的傅里叶变换 $V(\\mathbf{q})$。\n$$\nV(\\mathbf{q}) = \\int d^{3}r \\, V(r) \\, \\exp(-i \\mathbf{q} \\cdot \\mathbf{r}) = \\int d^{3}r \\, \\left(-\\frac{\\alpha \\exp(-\\mu r)}{r}\\right) \\, \\exp(-i \\mathbf{q} \\cdot \\mathbf{r})\n$$\n该积分为标准积分，其计算结果为：\n$$\nV(\\mathbf{q}) = -\\frac{4\\pi\\alpha}{|\\mathbf{q}|^2 + \\mu^2}\n$$\n\n现在我们计算在零动量极限下，前向散射振幅的一阶玻恩近似。前向散射意味着 $\\mathbf{k}'=\\mathbf{k}$，零动量极限意味着 $k = |\\mathbf{k}| \\to 0$。\n在此极限下，动量转移 $\\mathbf{q} = \\mathbf{k}'-\\mathbf{k} = \\mathbf{0}$。\n$$\nT^{(1)}(0) \\equiv \\lim_{k\\to 0} T^{(1)}(\\mathbf{k},\\mathbf{k}) = V(\\mathbf{0}) = -\\frac{4\\pi\\alpha}{0^2 + \\mu^2} = -\\frac{4\\pi\\alpha}{\\mu^2}\n$$\n相应的一阶散射振幅为：\n$$\nf^{(1)}(0) = -\\frac{m}{2\\pi\\hbar^2} T^{(1)}(0) = -\\frac{m}{2\\pi\\hbar^2} \\left( -\\frac{4\\pi\\alpha}{\\mu^2} \\right) = \\frac{2m\\alpha}{\\hbar^2\\mu^2}\n$$\n\n接下来，我们在相同极限下计算二阶玻恩近似。对于前向散射（$\\mathbf{k}'=\\mathbf{k}$），二阶 T-矩阵为：\n$$\nT^{(2)}(\\mathbf{k},\\mathbf{k};E) = \\int \\frac{d^{3}p}{(2\\pi)^{3}} \\, |V(\\mathbf{p}-\\mathbf{k})|^2 \\, G_{0}^{(+)}(E;p)\n$$\n我们取极限 $k \\to 0$，这意味着 $E \\to 0$。自由预解式 $G_{0}^{(+)}(E;p)$ 由 $(E - \\hbar^2 p^2/(2m) + i0)^{-1}$ 给出。在 $E \\to 0$ 的极限下，它变为：\n$$\nG_{0}^{(+)}(0;p) = \\left(-\\frac{\\hbar^2 p^2}{2m} + i0\\right)^{-1}\n$$\n根据光学定理（$\\text{Im} f(0) \\propto k \\sigma_{\\text{tot}} \\to 0$），前向散射振幅的虚部在零能量时必须为零。这意味着产生 $T^{(2)}$ 虚部的 $i0$ 项的贡献必须为零。因此，我们可以用其主值 $-\\frac{2m}{\\hbar^2 p^2}$ 替换 $G_{0}^{(+)}(0;p)$，因为积分测度 $p^2 dp$ 正则化了 $p=0$ 处的极点。\n因此，在 $k \\to 0$ 的极限下：\n$$\nT^{(2)}(0) = \\int \\frac{d^{3}p}{(2\\pi)^{3}} \\, |V(\\mathbf{p})|^2 \\, \\left(-\\frac{2m}{\\hbar^2 p^2}\\right)\n$$\n代入 $V(\\mathbf{p})$ 的表达式：\n$$\nT^{(2)}(0) = \\int \\frac{d^{3}p}{(2\\pi)^{3}} \\, \\left(-\\frac{4\\pi\\alpha}{p^2+\\mu^2}\\right)^2 \\, \\left(-\\frac{2m}{\\hbar^2 p^2}\\right)\n$$\n积分是在动量空间上进行的。由于被积函数是球对称的，我们可以写出 $d^3 p = 4\\pi p^2 dp$：\n$$\nT^{(2)}(0) = \\frac{4\\pi}{(2\\pi)^3} \\int_0^\\infty p^2 dp \\, \\frac{16\\pi^2\\alpha^2}{(p^2+\\mu^2)^2} \\, \\left(-\\frac{2m}{\\hbar^2 p^2}\\right)\n$$\n通过消去各项（包括 $p^2$）来简化表达式：\n$$\nT^{(2)}(0) = \\frac{4\\pi}{8\\pi^3} (16\\pi^2\\alpha^2) \\left(-\\frac{2m}{\\hbar^2}\\right) \\int_0^\\infty \\frac{dp}{(p^2+\\mu^2)^2}\n$$\n$$\nT^{(2)}(0) = \\frac{1}{2\\pi^2} (-32\\pi^2) \\frac{m\\alpha^2}{\\hbar^2} \\int_0^\\infty \\frac{dp}{(p^2+\\mu^2)^2} = -16 \\frac{m\\alpha^2}{\\hbar^2} \\int_0^\\infty \\frac{dp}{(p^2+\\mu^2)^2}\n$$\n剩余的积分可以通过三角代换来计算。令 $p = \\mu \\tan\\theta$，则 $dp = \\mu \\sec^2\\theta \\, d\\theta$。\n$$\n\\int_0^\\infty \\frac{dp}{(p^2+\\mu^2)^2} = \\int_0^{\\pi/2} \\frac{\\mu\\sec^2\\theta \\, d\\theta}{(\\mu^2\\tan^2\\theta+\\mu^2)^2} = \\int_0^{\\pi/2} \\frac{\\mu\\sec^2\\theta}{\\mu^4\\sec^4\\theta} d\\theta = \\frac{1}{\\mu^3} \\int_0^{\\pi/2} \\cos^2\\theta \\, d\\theta\n$$\n$$\n\\int_0^{\\pi/2} \\cos^2\\theta \\, d\\theta = \\int_0^{\\pi/2} \\frac{1+\\cos(2\\theta)}{2} d\\theta = \\frac{1}{2}\\left[\\theta + \\frac{\\sin(2\\theta)}{2}\\right]_0^{\\pi/2} = \\frac{1}{2}\\left(\\frac{\\pi}{2}\\right) = \\frac{\\pi}{4}\n$$\n所以该积分的计算结果为 $\\frac{\\pi}{4\\mu^3}$。\n将此结果代回到 $T^{(2)}(0)$ 的表达式中：\n$$\nT^{(2)}(0) = -16 \\frac{m\\alpha^2}{\\hbar^2} \\left(\\frac{\\pi}{4\\mu^3}\\right) = -\\frac{4\\pi m \\alpha^2}{\\hbar^2\\mu^3}\n$$\n相应的二阶散射振幅为：\n$$\nf^{(2)}(0) = -\\frac{m}{2\\pi\\hbar^2} T^{(2)}(0) = -\\frac{m}{2\\pi\\hbar^2} \\left(-\\frac{4\\pi m \\alpha^2}{\\hbar^2\\mu^3}\\right) = \\frac{2m^2\\alpha^2}{\\hbar^4\\mu^3}\n$$\n\n最后，我们计算比值 $R$：\n$$\nR = \\frac{|f^{(2)}(0)|}{|f^{(1)}(0)|} = \\frac{\\left|\\frac{2m^2\\alpha^2}{\\hbar^4\\mu^3}\\right|}{\\left|\\frac{2m\\alpha}{\\hbar^2\\mu^2}\\right|}\n$$\n鉴于 $m$、$\\alpha$ 和 $\\mu$ 都是正参数，绝对值可以去掉：\n$$\nR = \\frac{2m^2\\alpha^2}{\\hbar^4\\mu^3} \\cdot \\frac{\\hbar^2\\mu^2}{2m\\alpha} = \\frac{m\\alpha}{\\hbar^2\\mu}\n$$\n该表达式是无量纲的，符合要求。它代表了势的无量纲强度，并作为玻恩级数的展开参数。当 $R \\ll 1$ 时，一阶玻恩近似是可靠的。",
            "answer": "$$\n\\boxed{\\frac{m\\alpha}{\\hbar^2\\mu}}\n$$"
        },
        {
            "introduction": "当势场较强，玻恩近似失效时，我们必须对完整的Lippmann-Schwinger方程进行数值求解。本练习  将指导您使用Nyström离散化方法，这是将积分方程转化为线性代数问题的核心技术。通过采用一个数学上简明的可分离势，该练习使您能专注于掌握数值方法的核心，即如何设置高斯求积、处理复数传播子，并最终获得精确的散射振幅。",
            "id": "3603435",
            "problem": "考虑质心系中的双体散射，该过程由动量空间中的不含时薛定谔方程所描述。用于描述过渡算符的 Lippmann-Schwinger (LS) 方程源于自由哈密顿量的豫解算符，并通过一个无穷小虚数调节子来编码散射边界条件。重点关注球对称的 s 波道，在该波道中，积分方程简化为一个在一维有限动量域上、测度为 $p^2 \\mathrm{d}p$ 的一维动量积分。使用无量纲单位制，其中 $\\hbar = 1$ 且约化质量 $\\mu = 1/2$，因此自由豫解算符通过量 $E - p^2$ 依赖于动能。在积分域上施加一个尖锐动量截断 $\\Lambda$，将所有动量积分限制在 $p \\in [0,\\Lambda]$ 内。\n\n相互作用势采用一阶可分离的 Yamaguchi 形式，\n$$\nV(p,p') = -\\frac{g}{\\left(p^2 + \\beta^2\\right)\\left(p'^2 + \\beta^2\\right)},\n$$\n其中常数 $g > 0$ 且 $\\beta > 0$。对于给定的在壳动量 $k$，其在此单位制下满足色散关系 $E = k^2$，s 波在壳过渡矩阵元记为 $T_0(k,k;E)$。出射边界条件由一个无穷小正调节子 $\\eta$ 强制施加，该调节子进入自由豫解算符中。为了数值稳定性，将 $\\eta$ 取为一个很小但有限的正数。\n\n使用区间 $[0,\\Lambda]$ 上的高斯求积点和权重来近似积分，从而实现 s 波动量空间 Lippmann-Schwinger 积分方程的 Nyström 离散化。您的实现必须：\n- 构建与该积分方程和所选求積方法一致的离散系统。\n- 求解在求积节点处的未知过渡振幅值。\n- 通过将已解出的离散值与求积方法相结合，来表示在 $p=k$ 处求值的积分，从而计算在壳 s 波过渡振幅 $T_0(k,k;E)$。\n\n您必须检验当求积点数量增加时，$\\operatorname{Re}\\, T_0(k,k;E)$ (实部) 的收敛性。使用以下测试套件，其中每个案例指定了 $(N,\\Lambda,k,g,\\beta,\\eta)$，$N$ 是高斯-勒让德求积点的数量，所有量均为无量纲：\n1. $(8,\\,5.0,\\,1.0,\\,1.0,\\,1.3,\\,10^{-6})$,\n2. $(16,\\,5.0,\\,1.0,\\,1.0,\\,1.3,\\,10^{-6})$,\n3. $(32,\\,5.0,\\,1.0,\\,1.0,\\,1.3,\\,10^{-6})$,\n4. $(64,\\,5.0,\\,1.0,\\,1.0,\\,1.3,\\,10^{-6})$,\n5. $(4,\\,5.0,\\,1.0,\\,1.0,\\,1.3,\\,10^{-6})$,\n6. $(16,\\,5.0,\\,4.9,\\,1.0,\\,1.3,\\,10^{-6})$,\n7. $(32,\\,5.0,\\,4.9,\\,1.0,\\,1.3,\\,10^{-6})$,\n8. $(64,\\,5.0,\\,4.9,\\,1.0,\\,1.3,\\,10^{-6})$.\n\n对于每个测试案例，计算在壳 s 波过渡矩阵元 $\\operatorname{Re}\\,T_0(k,k;E)$ 的实部，结果为浮点数。您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，\"[result1,result2,result3]\"），结果顺序与上述测试套件相同。由于在此设置中所有量均为无量綱，因此不应报告任何物理单位。将报告的每个值四舍五入到八位小数。",
            "solution": "用户提供了计算核物理领域的一个有效问题陈述。任务是通过数值求解 Lippmann-Schwinger 方程来计算可分离势的在壳 s 波过渡矩阵元。\n\n过渡算符 $T$ 的 Lippmann-Schwinger (LS) 方程是量子散射理论的基石。其算符形式为：\n$$\nT(E) = V + V G_0(E) T(E)\n$$\n其中 $V$ 是相互作用势，$G_0(E) = (E - H_0 + i\\eta)^{-1}$ 是自由粒子格林函数，或称豫解算符。$H_0$ 是自由哈密顿量，$E$ 是散射能量。无穷小正调节子 $\\eta \\to 0^+$ 强制施加出射波边界条件。\n\n在质心系和动量空间表象中，对于球对称 s 波 ($l=0$) 波道，LS 方程成为一个一维积分方程。根据问题的单位规定（$\\hbar=1$，$2\\mu=1$，因此 $H_0=p^2$）和积分测度（在由截断 $\\Lambda$ 限制的域上为 $p^2 dp$），分波 T 矩阵元 $T_0(p', p; E)$ 的方程为：\n$$\nT_0(p', p; E) = V_0(p', p) + \\int_0^{\\Lambda} q^2 dq \\, V_0(p', q) \\frac{1}{E - q^2 + i\\eta} T_0(q, p; E)\n$$\n此处，$V_0(p',p)$ 是势的 s 波投影。对于所提供的球对称 Yamaguchi 势，$V(p,p') = V_0(p,p')$。该势具有一阶可分离形式：\n$$\nV_0(p', p) = -\\frac{g}{(p'^2 + \\beta^2)(p^2 + \\beta^2)} = -v(p') v(p)\n$$\n其中我们定义形因子 $v(p) = \\sqrt{g} / (p^2 + \\beta^2)$。\n\n势的可分离特性使得方程可以显著简化。我们将 $V_0$ 的形式代入 LS 方程：\n$$\nT_0(p', p; E) = -v(p')v(p) - \\int_0^{\\Lambda} q^2 dq \\, v(p')v(q) \\frac{1}{E - q^2 + i\\eta} T_0(q, p; E)\n$$\n提出因子 $v(p')$，我们观察到 $T_0(p', p; E)$ 也必须在 $p'$ 和 $p$ 上是可分离的。我们可以作出如下拟设：\n$$\nT_0(p', p; E) = -v(p') \\tau(p; E)\n$$\n其中 $\\tau(p; E)$ 是一个未知函数。将此拟设代入 LS 方程得到：\n$$\n-v(p')\\tau(p; E) = -v(p')v(p) - v(p') \\int_0^{\\Lambda} q^2 dq \\, v(q) \\frac{1}{E - q^2 + i\\eta} [-v(q)\\tau(p; E)]\n$$\n假设 $v(p') \\neq 0$，我们可以消去此项。由于 $\\tau(p; E)$ 与积分变量 $q$ 无关，它也可以从积分中提出：\n$$\n\\tau(p; E) = v(p) + \\tau(p; E) \\int_0^{\\Lambda} q^2 dq \\, \\frac{v(q)^2}{E - q^2 + i\\eta}\n$$\n这是一个关于 $\\tau(p; E)$ 的代数方程。我们定义复数值积分 $J(E)$：\n$$\nJ(E) = \\int_0^{\\Lambda} q^2 dq \\, \\frac{v(q)^2}{E - q^2 + i\\eta} = g \\int_0^{\\Lambda} \\frac{q^2}{(q^2 + \\beta^2)^2 (E - q^2 + i\\eta)} dq\n$$\n$\\tau(p; E)$ 的方程变为：\n$$\n\\tau(p; E) = v(p) + \\tau(p; E) J(E)\n$$\n求解 $\\tau(p; E)$:\n$$\n\\tau(p; E) [1 - J(E)] = v(p) \\implies \\tau(p; E) = \\frac{v(p)}{1 - J(E)}\n$$\n这似乎不正确。我们重新检查推导过程。\n$-v(p')\\tau(p;E) = -v(p')v(p) + v(p')\\tau(p;E) \\int_0^{\\Lambda} ...$。\n消去 $-v(p')$ 后，我们得到：$\\tau(p;E) = v(p) - \\tau(p;E) \\int_0^{\\Lambda} ...$。\n因此 $\\tau(p; E) [1 + J(E)] = v(p)$，从而得出：\n$$\n\\tau(p; E) = \\frac{v(p)}{1 + J(E)}\n$$\n将此结果代回 $T_0$ 的拟设中：\n$$\nT_0(p', p; E) = -\\frac{v(p') v(p)}{1 + J(E)}\n$$\n问题被简化为计算积分 $J(E)$。我们的任务是使用 Nyström 方法和高斯-勒让德求积法来数值计算该积分。该积分的形式为 $\\int_0^\\Lambda F(q) dq$。我们使用定义在区间 $[-1, 1]$ 上的 $N$ 个求积点 $x_j$ 和权重 $w_j$。我们将它们映射到区间 $[0, \\Lambda]$：\n$$\np_j = \\frac{\\Lambda}{2}(x_j+1), \\quad W_j = \\frac{\\Lambda}{2} w_j\n$$\n积分 $J(E)$ 随后通过加权和来近似：\n$$\nJ(E) \\approx J_N(E) = \\sum_{j=1}^{N} W_j \\frac{g \\, p_j^2}{(p_j^2 + \\beta^2)^2 (E - p_j^2 + i\\eta)}\n$$\n此处，$J_N(E)$ 是一个复数。我们感兴趣的是在壳 T 矩阵元 $T_0(k, k; E)$，其中在壳条件为 $E = k^2$。因此，我们计算：\n$$\nT_0(k, k; E=k^2) = -\\frac{v(k)^2}{1 + J_N(k^2)} = -\\frac{g / (k^2 + \\beta^2)^2}{1 + J_N(k^2)}\n$$\n对每个测试案例 $(N, \\Lambda, k, g, \\beta, \\eta)$ 的步骤如下：\n1. 设置能量 $E = k^2$。\n2. 为区间 $[-1, 1]$ 生成 $N$ 个高斯-勒让德求积点 $x_j$ 和权重 $w_j$。\n3. 将这些点和权重转换到积分区间 $[0, \\Lambda]$ 以获得 $p_j$ 和 $W_j$。\n4. 使用上述公式计算复数值和 $J_N(E)$。这涉及对 $N$ 个求积点进行循环。\n5. 计算复数值的在壳 T 矩阵元 $T_0(k, k; E)$。\n6. 提取实部 $\\operatorname{Re}\\,T_0(k, k; E)$，并按要求进行四舍五入。\n\n此过程正确地实现了用于可分离势的 Nyström 方法，其中问题被优雅地从求解一个 $N \\times N$ 矩阵系统简化为对一个定义明確的积分进行数值评估。$\\eta$ 的微小有限值通过对格林函数在 $p^2=E$ 处的极点进行正则化，确保了数值稳定性。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the Lippmann-Schwinger equation for the s-wave on-shell T-matrix\n    using Nyström discretization for a Yamaguchi potential.\n    \"\"\"\n    # Test suite: Each tuple is (N, Lambda, k, g, beta, eta)\n    test_cases = [\n        (8, 5.0, 1.0, 1.0, 1.3, 1.0e-6),\n        (16, 5.0, 1.0, 1.0, 1.3, 1.0e-6),\n        (32, 5.0, 1.0, 1.0, 1.3, 1.0e-6),\n        (64, 5.0, 1.0, 1.0, 1.3, 1.0e-6),\n        (4, 5.0, 1.0, 1.0, 1.3, 1.0e-6),\n        (16, 5.0, 4.9, 1.0, 1.3, 1.0e-6),\n        (32, 5.0, 4.9, 1.0, 1.3, 1.0e-6),\n        (64, 5.0, 4.9, 1.0, 1.3, 1.0e-6),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        N, Lambda, k, g, beta, eta = case\n\n        # Step 1: Set on-shell energy\n        E = k**2\n\n        # Step 2: Generate Gauss-Legendre quadrature points and weights for [-1, 1]\n        x, w = np.polynomial.legendre.leggauss(N)\n\n        # Step 3: Map points and weights to the integration interval [0, Lambda]\n        p_j = Lambda / 2.0 * (x + 1.0)\n        W_j = Lambda / 2.0 * w\n\n        # Step 4: Compute the complex-valued integral J(E) numerically\n        # v(p)^2 = g / (p^2 + beta^2)^2\n        v_p_sq = g / (p_j**2 + beta**2)**2\n        \n        # Free resolvent/propagator G_0(E, p_j) = 1 / (E - p_j^2 + i*eta)\n        propagator = 1.0 / (E - p_j**2 + 1j * eta)\n\n        # The integrand for J(E) is p^2 * v(p)^2 * G_0(E, p)\n        integrand = p_j**2 * v_p_sq * propagator\n        \n        # J_N(E) is the weighted sum over quadrature points\n        J_E = np.sum(W_j * integrand)\n\n        # Step 5: Compute the on-shell T-matrix element T_0(k, k; E)\n        # The numerator is -v(k)^2\n        numerator_T_matrix = -g / (k**2 + beta**2)**2\n        \n        # The full T-matrix element\n        T_matrix_on_shell = numerator_T_matrix / (1.0 + J_E)\n        \n        # Step 6: Extract the real part for the result\n        result = T_matrix_on_shell.real\n        results.append(result)\n\n    # Format the final output string as a comma-separated list of floating-point\n    # numbers rounded to eight decimal places, enclosed in square brackets.\n    formatted_results = [f\"{r:.8f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "在数值求解Lippmann-Schwinger方程的过程中，一个普遍存在的关键挑战是如何处理自由传播子中的在壳奇异性。本练习  介绍了一种优雅且极为稳健的技术——围道形变法——来精确地处理这一难题。通过动手实现该方法，并将其结果与基于柯西主值的常规方法进行对比，您将不仅掌握一种专业级的计算技巧，更能深入理解散射计算中处理奇异性的精妙之处。",
            "id": "3603423",
            "problem": "考虑动量空间中的非相对论双体散射，并关注 s-波的分波 Lippmann–Schwinger 方程。积分核包含自由传播子，其分母为 $E - q^2/(2\\mu) + i0$。这在满足 $E = p_0^2/(2\\mu)$ 的在壳动量 $q = p_0$ 处引入了一个奇点。在一阶玻恩近似中，任务简化为计算一个形式如下的标量积分：\n$$\nI(p_0; g,\\beta) = \\int_{0}^{\\infty} \\mathrm{d}q \\; \\frac{q^2 \\, V(q; g,\\beta)}{p_0^2 - q^2 + i0},\n$$\n其中 $V(q; g,\\beta)$ 是一个球对称的动量空间势。为确保确定性和科学真实性，我们使用汤川型势模型：\n$$\nV(q; g,\\beta) = \\frac{g}{q^2 + \\beta^2},\n$$\n其中 $g>0$ 且 $\\beta>0$。由于 $+i0$ 的规定，积分 $I(p_0; g,\\beta)$ 是复值的，其数值计算需要处理在 $q = p_0$ 处的奇异行为。\n\n从基本散射理论和分布恒等式出发，实现并比较两种稳健的数值策略来计算 $I(p_0; g,\\beta)$：\n\n- 策略 A（动量空间围道变形）：通过在复 $q$-平面的下半平面中，以一个半径为 $\\delta>0$ 的半圆形绕道绕过奇点 $q=p_0$，从而使实轴积分路径变形。变形后的围道由三部分组成：实数区间 $[0, p_0-\\delta]$，复平面中由 $\\theta$ 从 $\\pi$ 遍历到 $0$（角度必须是弧度）的参数化半圆弧\n$$\nq(\\theta) = p_0 + \\delta e^{-i\\theta}\n$$\n，以及实数区间 $[p_0+\\delta, Q_{\\max}]$。将积分上限截断在一个有限值 $Q_{\\max} > p_0$，并根据大 $q$ 时的领头渐近行为推导出一个尾部修正项。确保所选方向和半平面与 $+i0$ 规定一致。通过根据大 $q$ 时被积函数的渐近展开来量化截断误差，并证明结果相对于压痕参数 $\\delta$ 是稳定的，以此进行误差控制。\n\n- 策略 B（主值与分布分析）：将积分的实部计算为在实轴上排除奇异区域后的柯西主值积分，并从 $1/(x + i0)$ 的分布恒等式推导出虚部。使用相同的有限截断值 $Q_{\\max}$，并应用基于领头渐近项的相同尾部修正，以确保公平比较。从第一性原理出发证明所有步骤，不使用问题中提供的任何快捷公式。\n\n你的程序必须使用两种策略为指定的测试套件计算 $I(p_0; g,\\beta)$，并报告两个复值结果之间的绝对差（即，对每种情况计算 $|I_{\\mathrm{def}} - I_{\\mathrm{pv}}|$，其中 $I_{\\mathrm{def}}$ 是围道变形的结果，$I_{\\mathrm{pv}}$ 是主值加分布的结果）。角度必须以弧度处理。由于模型是无量纲的，此处不需要物理单位。\n\n实现以下测试套件，其中每个元组为 $(p_0, g, \\beta, \\delta, Q_{\\max})$：\n\n- 情况 1：$(1.5, 1.0, 0.5, 10^{-3}, 50)$。\n- 情况 2：$(4.0, 2.0, 1.0, 5\\times 10^{-4}, 80)$。\n- 情况 3：$(0.8, 0.1, 5.0, 10^{-6}, 40)$。\n- 情况 4：$(20.0, 1.0, 0.1, 10^{-3}, 100)$。\n\n为进行误差控制，请使用严格的求积容差，并提供基于领头渐近项的尾部修正。程序必须是自包含的，并生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，例如 $[r_1,r_2,r_3,r_4]$，其中每个 $r_i$ 是对应测试用例的绝对差 $|I_{\\mathrm{def}} - I_{\\mathrm{pv}}|$ 的浮点数值。角度必须使用弧度，任何地方都不得使用百分比。",
            "solution": "该问题要求对在动量空间中 s-波 Lippmann-Schwinger 方程背景下出现的一个复值积分进行数值计算。该积分由下式给出：\n$$\nI(p_0; g,\\beta) = \\int_{0}^{\\infty} \\mathrm{d}q \\; \\frac{q^2 \\, V(q; g,\\beta)}{p_0^2 - q^2 + i0}\n$$\n其中势能 $V(q; g,\\beta)$ 是一个汤川型模型：\n$$\nV(q; g,\\beta) = \\frac{g}{q^2 + \\beta^2}\n$$\n代入势能后，积分变为：\n$$\nI(p_0; g,\\beta) = g \\int_{0}^{\\infty} \\mathrm{d}q \\; \\frac{q^2}{(p_0^2 - q^2 + i0)(q^2 + \\beta^2)}\n$$\n分母中的项“$i0$”（一个正无穷小量）是费曼规定，它指定了如何处理在 $q = p_0$ 处的奇点。这意味着与自由传播子相关的极点位于复 $q$-平面的上半平面稍上方，具体在 $q = \\sqrt{p_0^2 + i0} \\approx p_0 + i\\epsilon$ 处，其中 $\\epsilon$ 是一个小的正数。因此，沿正实轴 $[0, \\infty)$ 的积分路径恰好从该极点的下方通过。\n\n我们将实现并比较两种严谨的数值策略来计算该积分。作为我们数值方法的检验，我们可以使用留数定理推导出精确的解析解。被积函数是 $q$ 的偶函数，因此我们可以将积分扩展到整个实轴并除以 2。在 $(-\\infty, \\infty)$ 上的积分可以通过在上半平面闭合围道并对极点 $q = p_0+i\\epsilon$ 和 $q = i\\beta$ 处的留数求和来计算。这得到精确结果：\n$$\nI(p_0; g, \\beta) = -\\frac{\\pi g}{2(p_0^2+\\beta^2)}(\\beta + ip_0)\n$$\n我们的数值策略应当收敛到这个值。\n\n### 策略 A：围道变形\n\n此策略通过在复 $q$-平面中变形积分路径来避开奇点。根据柯西积分定理，只要变形路径不穿过任何奇点，积分的值就保持不变。$+i0$ 规定将极点置于上半平面 $q \\approx p_0$ 处，因此我们将路径变形到下半平面。指定的变形路径 $C$ 由三部分组成：\n1.  从 $q=0$ 到 $q=p_0-\\delta$ 的实轴段 $C_1$。\n2.  位于下半平面、以 $p_0$ 为中心、半径为 $\\delta$ 的半圆弧 $C_2$。该圆弧由 $q(\\theta) = p_0 + \\delta e^{-i\\theta}$ 参数化，其中 $\\theta$ 从 $\\pi$ 遍历到 $0$。\n3.  从 $q=p_0+\\delta$ 到一个大但有限的截断值 $Q_{\\max}$ 的实轴段 $C_3$。\n\n积分 $I$ 于是就是这三段上的积分之和，再加上从 $Q_{\\max}$ 到 $\\infty$ 的剩余积分的尾部修正。\n$$\nI_{\\mathrm{def}} = \\int_{C_1} + \\int_{C_2} + \\int_{C_3} + I_{\\mathrm{tail}}\n$$\n设被积函数为 $f(q) = \\frac{g q^2}{(p_0^2 - q^2)(q^2 + \\beta^2)}$。这些积分为：\n-   $I_1 = \\int_{0}^{p_0-\\delta} f(q) \\, \\mathrm{d}q$\n-   $I_2 = \\int_{\\pi}^{0} f(q(\\theta)) \\frac{\\mathrm{d}q}{\\mathrm{d}\\theta} \\, \\mathrm{d}\\theta = \\int_{\\pi}^{0} f(p_0 + \\delta e^{-i\\theta}) (-i\\delta e^{-i\\theta}) \\, \\mathrm{d}\\theta = \\int_{0}^{\\pi} f(p_0 + \\delta e^{-i\\theta}) (i\\delta e^{-i\\theta}) \\, \\mathrm{d}\\theta$。这个积分是复值的，将通过数值积分其​​实部和虚部来计算。\n-   $I_3 = \\int_{p_0+\\delta}^{Q_{\\max}} f(q) \\, \\mathrm{d}q$\n\n对于尾部修正，我们考虑被积函数在大 $q$ 时的渐近行为：\n$$\nf(q) \\approx \\frac{g q^2}{(-q^2)(q^2)} = -\\frac{g}{q^2} \\quad \\text{for } q \\gg p_0, \\beta\n$$\n尾部积分随后由其领头项近似：\n$$\nI_{\\mathrm{tail}} = \\int_{Q_{\\max}}^{\\infty} f(q) \\, \\mathrm{d}q \\approx \\int_{Q_{\\max}}^{\\infty} -\\frac{g}{q^2} \\, \\mathrm{d}q = \\left[ \\frac{g}{q} \\right]_{Q_{\\max}}^{\\infty} = -\\frac{g}{Q_{\\max}}\n$$\n该策略的最终结果是 $I_{\\mathrm{def}} = I_1 + I_2 + I_3 + I_{\\mathrm{tail}}$。\n\n### 策略 B：主值与分布分析\n\n此策略采用 Sokhotski–Plemelj 定理，该定理表述为：\n$$\n\\frac{1}{x \\pm i0} = P\\frac{1}{x} \\mp i\\pi\\delta(x)\n$$\n其中 $P$ 表示柯西主值，$\\delta(x)$ 是狄拉克 delta 函数。将此应用于我们的积分，令 $x = p_0^2 - q^2$：\n$$\nI = \\int_{0}^{\\infty} \\frac{q^2 V(q; g,\\beta)}{p_0^2-q^2+i0} \\, \\mathrm{d}q = P \\int_{0}^{\\infty} \\frac{q^2 V(q; g,\\beta)}{p_0^2-q^2} \\, \\mathrm{d}q - i\\pi \\int_{0}^{\\infty} q^2 V(q; g,\\beta) \\delta(p_0^2-q^2) \\, \\mathrm{d}q\n$$\n$I$ 的实部是主值积分，而虚部由 delta 函数项确定。\n\n对于虚部，我们使用 delta 函数的性质 $\\delta(h(q)) = \\sum_i \\frac{\\delta(q-q_i)}{|h'(q_i)|}$，其中 $q_i$ 是 $h(q)$ 的单根。这里，$h(q)=p_0^2-q^2$ 的根为 $q = \\pm p_0$。由于积分范围是 $[0, \\infty)$，只有根 $q=p_0$ 有贡献。当 $h'(q) = -2q$ 时，我们有 $|h'(p_0)| = 2p_0$。因此，对于 $q>0$，有 $\\delta(p_0^2-q^2) = \\frac{\\delta(q-p_0)}{2p_0}$。\n$$\n\\mathrm{Im}(I) = -\\pi \\int_{0}^{\\infty} \\frac{g q^2}{q^2+\\beta^2} \\frac{\\delta(q-p_0)}{2p_0} \\, \\mathrm{d}q = -\\frac{\\pi}{2p_0} \\left( \\frac{g p_0^2}{p_0^2+\\beta^2} \\right) = -\\frac{\\pi g p_0}{2(p_0^2+\\beta^2)}\n$$\n这为虚部提供了精确的解析表达式。\n\n实部是柯西主值：\n$$\n\\mathrm{Re}(I) = P \\int_{0}^{\\infty} \\frac{g q^2}{(p_0^2-q^2)(q^2+\\beta^2)} \\, \\mathrm{d}q\n$$\n在数值上，这通过对称地排除奇点来计算：\n$$\n\\mathrm{Re}(I) \\approx \\int_{0}^{p_0-\\delta} f(q) \\, \\mathrm{d}q + \\int_{p_0+\\delta}^{Q_{\\max}} f(q) \\, \\mathrm{d}q + I_{\\mathrm{tail}}\n$$\n其中 $f(q)$ 与策略 A 中是相同的实值被积函数，$I_{\\mathrm{tail}}$ 是相同的尾部修正，以确保公平比较。这里的参数 $\\delta$ 对应于与策略 A 中相同的小区间排除。\n\n该策略的最终结果是 $I_{\\mathrm{pv}} = \\mathrm{Re}(I) + i \\mathrm{Im}(I)$。这两种方法在理论上是等价的，因此应该产生数值上接近的结果。量 $|I_{\\mathrm{def}} - I_{\\mathrm{pv}}|$ 衡量了它们的一致性以及数值近似的收敛性。以下程序实现了这两种策略并计算此差异。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Computes a singular integral from scattering theory using two methods\n    and reports the absolute difference between their results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each tuple is (p0, g, beta, delta, Q_max).\n    test_cases = [\n        (1.5, 1.0, 0.5, 1e-3, 50.0),\n        (4.0, 2.0, 1.0, 5e-4, 80.0),\n        (0.8, 0.1, 5.0, 1e-6, 40.0),\n        (20.0, 1.0, 0.1, 1e-3, 100.0),\n    ]\n\n    results = []\n    \n    # Set strict tolerances for numerical quadrature for high accuracy.\n    QUAD_TOL_ABS = 1e-13\n    QUAD_TOL_REL = 1e-13\n\n    for p0, g, beta, delta, Q_max in test_cases:\n        \n        # --- Strategy A: Contour Deformation ---\n\n        # The integrand on the real axis segments.\n        def integrand_real_axis(q, p0, g, beta):\n            return (g * q**2) / ((p0**2 - q**2) * (q**2 + beta**2))\n\n        # Part 1: Integral from 0 to p0 - delta.\n        I1, _ = quad(\n            integrand_real_axis, 0, p0 - delta,\n            args=(p0, g, beta),\n            epsabs=QUAD_TOL_ABS, epsrel=QUAD_TOL_REL\n        )\n\n        # Part 2: Integral over the semicircular arc in the complex plane.\n        # The path is q(theta) = p0 + delta * exp(-i*theta) for theta from pi to 0.\n        # The integral becomes integral_0^pi f(q(theta))*(i*delta*exp(-i*theta)) d(theta).\n        def integrand_arc(theta, p0, g, beta, delta):\n            q_arc = p0 + delta * np.exp(-1j * theta)\n            derivative_term = 1j * delta * np.exp(-1j * theta)\n            numerator = g * q_arc**2\n            denominator = (p0**2 - q_arc**2) * (q_arc**2 + beta**2)\n            if denominator == 0: return np.inf # Avoid division by zero\n            return (numerator / denominator) * derivative_term\n\n        # `quad` integrates real-valued functions, so we split the complex integrand.\n        I2_real, _ = quad(\n            lambda t: integrand_arc(t, p0, g, beta, delta).real, 0, np.pi,\n            epsabs=QUAD_TOL_ABS, epsrel=QUAD_TOL_REL\n        )\n        I2_imag, _ = quad(\n            lambda t: integrand_arc(t, p0, g, beta, delta).imag, 0, np.pi,\n            epsabs=QUAD_TOL_ABS, epsrel=QUAD_TOL_REL\n        )\n        I2 = I2_real + 1j * I2_imag\n\n        # Part 3: Integral from p0 + delta to Q_max.\n        I3, _ = quad(\n            integrand_real_axis, p0 + delta, Q_max,\n            args=(p0, g, beta),\n            epsabs=QUAD_TOL_ABS, epsrel=QUAD_TOL_REL\n        )\n\n        # Part 4: Tail correction based on the leading asymptotic term (-g/q^2).\n        # The integral of -g/q^2 from Q_max to infinity is -g/Q_max.\n        tail = -g / Q_max\n\n        # Total integral for Strategy A.\n        I_def = I1 + I2 + I3 + tail\n\n        # --- Strategy B: Principal Value + Distributional Analysis ---\n\n        # The real part is the Cauchy Principal Value, computed numerically as\n        # the sum of the off-pole real axis integrals plus the tail correction.\n        Re_I_pv = I1 + I3 + tail\n\n        # The imaginary part is derived analytically from the distributional identity.\n        Im_I_pv = -np.pi * g * p0 / (2 * (p0**2 + beta**2))\n        \n        # Total integral for Strategy B.\n        I_pv = Re_I_pv + 1j * Im_I_pv\n\n        # --- Comparison ---\n        # Calculate the absolute difference between the results of the two strategies.\n        abs_diff = np.abs(I_def - I_pv)\n        results.append(abs_diff)\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}