{
    "hands_on_practices": [
        {
            "introduction": "在核反应计算中，核子-核子相互作用的完全复杂性通常使得近似处理成为必要。零程近似是扭曲波玻恩近似（DWBA）计算的基石之一，它虽然简化了六维积分，但也牺牲了一定的物理真实性。本练习将构建一座关键的分析桥梁，通过推导有限程修正因子，让您深入理解简化的零程图像与更真实的有限程相互作用之间的联系 。",
            "id": "3547926",
            "problem": "在单核子转移的畸波玻恩近似（DWBA）的末态形式中，有限程跃迁振幅可以示意性地写为质子-中子相对坐标核与质子-中子相互作用的重叠。设质子-中子相互作用由一个有限程高斯函数建模，\n$$\nV_{pn}(r)=V_{0}\\,\\exp\\!\\big(-r^{2}/\\beta^{2}\\big),\n$$\n其中程参数 $\\beta0$ 且强度为 $V_{0}$。用 $\\mathbf{s}$ 表示质子-中子相对坐标，用 $R(\\mathbf{s})$ 表示在 DWBA 被积函数中与 $V_{pn}(\\mathbf{s})$ 相乘的反应核（该核包含畸波与相关束缚态重叠的乘积）。零程极限对应于在 $\\mathbf{s}=\\mathbf{0}$ 的邻域内 $R(\\mathbf{s})\\to R(\\mathbf{0})$。\n\n从写为关于 $\\mathbf{s}$ 的重叠积分的有限程振幅出发，并仅使用以下假设：\n- $R(\\mathbf{s})$ 在 $\\mathbf{s}=\\mathbf{0}$ 的邻域内是光滑的，并在一个远大于 $\\beta$ 的长度标度上变化，\n- $R(\\mathbf{s})$ 在 $V_{pn}(\\mathbf{s})$ 支集上的主要变化是通过一个复相位，该复相位在 $\\mathbf{s}=\\mathbf{0}$ 处的局域梯度定义了一个实的“局域动量失配”向量 $\\mathbf{K}$，\n\n推导出有限程振幅的因子化形式，表示为零程振幅乘以一个有限程修正因子 $F_{\\mathrm{FR}}(K)$，该因子仅依赖于 $K=|\\mathbf{K}|$ 和相互作用程 $\\beta$。然后，确定通过 $V_{pn}$ 的二阶矩进入重叠积分的有效程参数，其定义为\n$$\nr_{\\mathrm{eff}}^{2}\\equiv \\frac{\\displaystyle\\int_{\\mathbb{R}^{3}} d^{3}s\\, s^{2}\\,V_{pn}(s)}{\\displaystyle\\int_{\\mathbb{R}^{3}} d^{3}s\\, V_{pn}(s)}.\n$$\n\n你的最终答案必须给出：\n1. $F_{\\mathrm{FR}}(K)$ 的闭式解析表达式。\n2. $r_{\\mathrm{eff}}^{2}$ 的闭式解析表达式。\n\n无需进行数值计算，也无需四舍五入。将两个结果表示为符号表达式。如果你同时提供两个结果，请按照答案格式的要求，使用 LaTeX 的 $pmatrix$ 环境将它们写成单行。",
            "solution": "该问题要求推导与单核子转移反应的有限程畸波玻恩近似（DWBA）跃迁振幅相关的两个量。第一个是有限程修正因子 $F_{\\mathrm{FR}}(K)$，第二个是给定质子-中子相互作用的有效程平方参数 $r_{\\mathrm{eff}}^{2}$。\n\n该问题被确认为具有科学依据、适定且自洽。这是核反应理论中的一个标准推导。\n\n我们首先定义有限程跃迁振幅 $T_{\\mathrm{FR}}$。示意性地，它由反应核 $R(\\mathbf{s})$ 与质子-中子相互作用 $V_{pn}(s)$ 在相对坐标 $\\mathbf{s}$ 上的重叠积分给出：\n$$\nT_{\\mathrm{FR}} = \\int_{\\mathbb{R}^{3}} d^{3}s \\, R(\\mathbf{s}) V_{pn}(s)\n$$\n其中 $s = |\\mathbf{s}|$ 且相互作用由以下高斯形式给出：\n$$\nV_{pn}(s) = V_{0} \\exp\\left(-\\frac{s^{2}}{\\beta^{2}}\\right)\n$$\n\n第一个任务是推导有限程修正因子 $F_{\\mathrm{FR}}(K)$。该因子将有限程振幅 $T_{\\mathrm{FR}}$ 与零程振幅 $T_{\\mathrm{ZR}}$ 联系起来。零程近似对应于假设核 $R(\\mathbf{s})$ 在相互作用的短程范围内是常数，即 $R(\\mathbf{s}) \\approx R(\\mathbf{0})$。因此，零程振幅为：\n$$\nT_{\\mathrm{ZR}} = \\int_{\\mathbb{R}^{3}} d^{3}s \\, R(\\mathbf{0}) V_{pn}(s) = R(\\mathbf{0}) \\int_{\\mathbb{R}^{3}} d^{3}s \\, V_{pn}(s)\n$$\n\n该问题为计算 $T_{\\mathrm{FR}}$ 提供了一个更精细的 $R(\\mathbf{s})$ 近似。假设 $R(\\mathbf{s})$ 是光滑的，且其在 $\\mathbf{s}=\\mathbf{0}$ 附近的主要变化是一个复相位。这可以通过使用其相位的泰勒展开式的一阶项来近似 $R(\\mathbf{s})$，从而在数学上表达出来。设 $R(\\mathbf{s}) = |R(\\mathbf{s})|\\exp(i\\phi(\\mathbf{s}))$。$|R(\\mathbf{s})|$ 的光滑性意味着对于小的 $s$，有 $|R(\\mathbf{s})| \\approx |R(\\mathbf{0})|$。相位近似为 $\\phi(\\mathbf{s}) \\approx \\phi(\\mathbf{0}) + \\mathbf{s} \\cdot \\left(\\nabla\\phi\\right)|_{\\mathbf{s}=\\mathbf{0}}$。问题将局域动量失配向量 $\\mathbf{K}$ 定义为此梯度，即 $\\mathbf{K} = \\left(\\nabla\\phi\\right)|_{\\mathbf{s}=\\mathbf{0}}$。因此，我们得到局域动量近似：\n$$\nR(\\mathbf{s}) \\approx R(\\mathbf{0}) \\exp(i\\mathbf{K} \\cdot \\mathbf{s})\n$$\n其中任何常数相位因子 $\\exp(i\\phi(\\mathbf{0}))$ 都已被吸收到复数前置因子 $R(\\mathbf{0})$ 中。\n\n将此近似代入 $T_{\\mathrm{FR}}$ 的表达式中：\n$$\nT_{\\mathrm{FR}} \\approx \\int_{\\mathbb{R}^{3}} d^{3}s \\, \\left[ R(\\mathbf{0}) \\exp(i\\mathbf{K} \\cdot \\mathbf{s}) \\right] \\left[ V_{0} \\exp\\left(-\\frac{s^{2}}{\\beta^{2}}\\right) \\right]\n$$\n$$\nT_{\\mathrm{FR}} \\approx R(\\mathbf{0}) V_{0} \\int_{\\mathbb{R}^{3}} d^{3}s \\, \\exp\\left(i\\mathbf{K} \\cdot \\mathbf{s} - \\frac{s^{2}}{\\beta^{2}}\\right)\n$$\n有限程修正因子 $F_{\\mathrm{FR}}(K)$ 由关系式 $T_{\\mathrm{FR}} = T_{\\mathrm{ZR}} F_{\\mathrm{FR}}(K)$ 定义。因此：\n$$\nF_{\\mathrm{FR}}(K) = \\frac{T_{\\mathrm{FR}}}{T_{\\mathrm{ZR}}} = \\frac{R(\\mathbf{0}) V_{0} \\int d^{3}s \\, \\exp\\left(i\\mathbf{K} \\cdot \\mathbf{s} - s^{2}/\\beta^{2}\\right)}{R(\\mathbf{0}) V_{0} \\int d^{3}s \\, \\exp\\left(-s^{2}/\\beta^{2}\\right)} = \\frac{\\int d^{3}s \\, \\exp\\left(i\\mathbf{K} \\cdot \\mathbf{s} - s^{2}/\\beta^{2}\\right)}{\\int d^{3}s \\, \\exp\\left(-s^{2}/\\beta^{2}\\right)}\n$$\n分母是一个标准的三维高斯积分，我们将其记为 $I_{denom}$。\n$$\nI_{denom} = \\int d^{3}s \\, \\exp\\left(-\\frac{s^{2}}{\\beta^{2}}\\right) = (\\pi \\beta^{2})^{3/2} = \\pi^{3/2} \\beta^{3}\n$$\n分子 $I_{num}$ 是一个高斯函数的傅里叶变换。\n$$\nI_{num} = \\int d^{3}s \\, \\exp\\left(-\\frac{s^{2}}{\\beta^{2}}\\right) \\exp\\left(i\\mathbf{K} \\cdot \\mathbf{s}\\right)\n$$\n为了计算该积分，我们对指数部分进行配方：\n$$\n-\\frac{s^{2}}{\\beta^{2}} + i\\mathbf{K} \\cdot \\mathbf{s} = -\\frac{1}{\\beta^{2}}\\left(s^{2} - i\\beta^{2}\\mathbf{K} \\cdot \\mathbf{s}\\right) = -\\frac{1}{\\beta^{2}}\\left[\\left(\\mathbf{s} - \\frac{i\\beta^{2}\\mathbf{K}}{2}\\right)^{2} + \\frac{\\beta^{4}K^{2}}{4}\\right] = -\\frac{1}{\\beta^{2}}\\left(\\mathbf{s} - \\frac{i\\beta^{2}\\mathbf{K}}{2}\\right)^{2} - \\frac{\\beta^{2}K^{2}}{4}\n$$\n其中 $K = |\\mathbf{K}|$。该积分变为：\n$$\nI_{num} = \\exp\\left(-\\frac{\\beta^{2}K^{2}}{4}\\right) \\int d^{3}s \\, \\exp\\left[-\\frac{1}{\\beta^{2}}\\left(\\mathbf{s} - \\frac{i\\beta^{2}\\mathbf{K}}{2}\\right)^{2}\\right]\n$$\n通过平移积分变量 $\\mathbf{s}' = \\mathbf{s} - \\frac{i\\beta^{2}\\mathbf{K}}{2}$（这是一个到复平面的平移），高斯积分的值保持不变。\n$$\n\\int d^{3}s \\, \\exp\\left[-\\frac{1}{\\beta^{2}}\\left(\\mathbf{s} - \\frac{i\\beta^{2}\\mathbf{K}}{2}\\right)^{2}\\right] = \\int d^{3}s' \\, \\exp\\left(-\\frac{s'^{2}}{\\beta^{2}}\\right) = I_{denom}\n$$\n因此，$I_{num} = I_{denom} \\cdot \\exp\\left(-\\frac{\\beta^{2}K^{2}}{4}\\right)$。修正因子是它们的比值：\n$$\nF_{\\mathrm{FR}}(K) = \\frac{I_{num}}{I_{denom}} = \\exp\\left(-\\frac{\\beta^{2}K^{2}}{4}\\right)\n$$\n\n第二个任务是求出有效程平方参数 $r_{\\mathrm{eff}}^{2}$，其定义为势的二阶矩与其体积分的比值：\n$$\nr_{\\mathrm{eff}}^{2} \\equiv \\frac{\\displaystyle\\int_{\\mathbb{R}^{3}} d^{3}s\\, s^{2}\\,V_{pn}(s)}{\\displaystyle\\int_{\\mathbb{R}^{3}} d^{3}s\\, V_{pn}(s)}\n$$\n代入 $V_{pn}(s) = V_{0}\\exp(-s^{2}/\\beta^{2})$，常数 $V_{0}$ 被消去：\n$$\nr_{\\mathrm{eff}}^{2} = \\frac{\\displaystyle\\int d^{3}s\\, s^{2}\\,\\exp(-s^{2}/\\beta^{2})}{\\displaystyle\\int d^{3}s\\, \\exp(-s^{2}/\\beta^{2})}\n$$\n分母仍然是 $I_{denom} = \\pi^{3/2} \\beta^{3}$。\n分子是 $s^{2}\\exp(-s^{2}/\\beta^{2})$ 的积分。我们在球坐标系下计算它，其中在对角度积分后，有 $d^{3}s = 4\\pi s^{2}ds$。\n$$\nI_{num}' = \\int d^{3}s\\, s^{2}\\,\\exp(-s^{2}/\\beta^{2}) = 4\\pi \\int_{0}^{\\infty} s^{4}\\exp(-s^{2}/\\beta^{2}) ds\n$$\n我们使用标准积分公式 $\\int_{0}^{\\infty} x^{2n} \\exp(-ax^{2}) dx = \\frac{(2n-1)!!}{2^{n+1}}\\sqrt{\\frac{\\pi}{a^{2n+1}}}$。取 $n=2$ 和 $a=1/\\beta^{2}$：\n$$\n\\int_{0}^{\\infty} s^{4}\\exp(-s^{2}/\\beta^{2}) ds = \\frac{3!!}{2^{3}}\\sqrt{\\frac{\\pi}{(1/\\beta^{2})^{5}}} = \\frac{3}{8}\\sqrt{\\pi\\beta^{10}} = \\frac{3\\sqrt{\\pi}}{8}\\beta^{5}\n$$\n所以分子的积分为：\n$$\nI_{num}' = 4\\pi \\left(\\frac{3\\sqrt{\\pi}}{8}\\beta^{5}\\right) = \\frac{3\\pi^{3/2}}{2}\\beta^{5}\n$$\n最后，我们计算 $r_{\\mathrm{eff}}^{2}$ 的比值：\n$$\nr_{\\mathrm{eff}}^{2} = \\frac{I_{num}'}{I_{denom}} = \\frac{\\frac{3\\pi^{3/2}}{2}\\beta^{5}}{\\pi^{3/2}\\beta^{3}} = \\frac{3}{2}\\beta^{2}\n$$\n两个要求的表达式是 $F_{\\mathrm{FR}}(K) = \\exp(-\\frac{\\beta^{2}K^{2}}{4})$ 和 $r_{\\mathrm{eff}}^{2} = \\frac{3}{2}\\beta^{2}$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\exp\\left(-\\frac{K^{2}\\beta^{2}}{4}\\right),  \\frac{3}{2}\\beta^{2}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在先验形式（prior form）的DWBA中，跃迁振幅不仅包含主要的核子-核子相互作用贡献，还包含来自光学势的贡献，后者通常被称为“剩余项”（remnant term）。尽管在计算中常常被忽略，但理解该项的大小对于评估常用近似的有效性至关重要。本计算练习要求您实现一个数值模型来分离并量化这个剩余项，为您提供将DWBA形式论转化为可执行代码的直接实践经验 。",
            "id": "3547961",
            "problem": "考虑在扭曲波玻恩近似 (DWBA) 内的氘核诱发反应中的核子转移，其跃迁振幅定义为 $T=\\langle \\chi_f^{(-)}|V_{tr}|\\phi_b\\,\\chi_i^{(+)}\\rangle$，其中 $V_{tr}$ 是跃迁相互作用，$\\chi_i^{(+)}$ 和 $\\chi_f^{(-)}$ 分别是入射和出射扭曲波，$\\phi_b$ 是转移核子相对于剩余核的束缚态波函数。在标准的先验形式中，写作 $V_{tr}=V_{pn}+U_p-U_d$，其中 $V_{pn}$ 是质子-中子相互作用，$U_p$ 是出射道中的质子光学势，$U_d$ 是入射道中的氘核光学势。剩余项是由 $U_p-U_d$ 对振幅的贡献，记为 $\\Delta T=\\langle \\chi_f^{(-)}|(U_p-U_d)|\\phi_b\\,\\chi_i^{(+)}\\rangle$。从一级玻恩近似和扭曲波的平面波极限出发，将靶核视为无限重，因此约化质量可以很好地由炮弹质量近似。对质子和氘核使用 Woods–Saxon 形式的中心、局域且纯实数的光学势，$U_x(r)=-\\dfrac{V_{0,x}}{1+\\exp\\left(\\dfrac{r-R}{a}\\right)}$，其中 $x\\in\\{p,d\\}$，半径 $R=r_0\\,A^{1/3}$，弥散度为 $a$，深度为 $V_{0,x}$。将束缚态建模为具有类氢归一化的 s-波指数形式，$\\phi_b(r)=\\dfrac{1}{\\sqrt{\\pi}\\,a_b^{3/2}}\\,\\exp\\!\\left(-\\dfrac{r}{a_b}\\right)$。在平面波近似下，对入射和出射平面波的乘积进行角度平均，得到球贝塞尔函数 $j_0(qr)=\\dfrac{\\sin(qr)}{qr}$，其中动量转移为 $q=\\lvert k_i-k_f\\rvert$。在重靶极限下使用非相对论运动学，波数为 $k_i=\\dfrac{\\sqrt{2\\,m_d\\,E_d}}{\\hbar c}$ 和 $k_f=\\dfrac{\\sqrt{2\\,m_p\\,E_p}}{\\hbar c}$，其中 $m_d$ 和 $m_p$ 分别是氘核和质子的静止能量（单位为 $\\mathrm{MeV}$），$E_d$ 和 $E_p$ 是实验室动能（单位为 $\\mathrm{MeV}$），$\\hbar c$ 以 $\\mathrm{MeV\\cdot fm}$ 表示。在这些假设下，剩余振幅简化为径向积分\n$$\n\\Delta T \\;=\\; 4\\pi\\int_0^\\infty r^2\\,j_0(qr)\\,\\big(U_p(r)-U_d(r)\\big)\\,\\phi_b(r)\\,dr,\n$$\n当 $\\phi_b$ 按给定方式归一化时，其单位为 $\\mathrm{MeV\\cdot fm^{3/2}}$。\n\n实现一个程序，该程序根据给定的靶核质量数 $A$、Woods–Saxon 参数 $r_0$ 和 $a$、束缚态长度标度 $a_b$、道能量 $E_d$ 和 $E_p$，以及指定的光学深度 $V_{0,p}$ 和 $V_{0,d}$ 来计算 $\\Delta T$。使用数值积分来计算在 $r\\in[0,R_{\\max}]$ 上的积分，其中 $R_{\\max}$ 足够大，使得被积函数在其之外可以忽略不计。使用球贝塞尔函数 $j_0(qr)=\\dfrac{\\sin(qr)}{qr}$，其极限值为 $j_0(0)=1$。使用的常数为 $\\hbar c=197.3269804\\,\\mathrm{MeV\\cdot fm}$，$m_p=938.2720813\\,\\mathrm{MeV}$ 和 $m_d=1875.61294257\\,\\mathrm{MeV}$。\n\n将计算出的剩余振幅以 $\\mathrm{MeV\\cdot fm^{3/2}}$ 为单位表示，并四舍五入到六位小数。\n\n测试组：\n- 案例 1 (一般情况)：$A=40$，$r_0=1.25\\,\\mathrm{fm}$，$a=0.65\\,\\mathrm{fm}$，$a_b=4.0\\,\\mathrm{fm}$，$V_{0,p}=52.0\\,\\mathrm{MeV}$，$V_{0,d}=90.0\\,\\mathrm{MeV}$，$E_d=15.0\\,\\mathrm{MeV}$，$E_p=8.0\\,\\mathrm{MeV}$。\n- 案例 2 (近阈值能量)：$A=40$，$r_0=1.25\\,\\mathrm{fm}$，$a=0.65\\,\\mathrm{fm}$，$a_b=4.0\\,\\mathrm{fm}$，$V_{0,p}=52.0\\,\\mathrm{MeV}$，$V_{0,d}=90.0\\,\\mathrm{MeV}$，$E_d=5.0\\,\\mathrm{MeV}$，$E_p=5.0\\,\\mathrm{MeV}$。\n- 案例 3 (高入射能量)：$A=40$，$r_0=1.25\\,\\mathrm{fm}$，$a=0.65\\,\\mathrm{fm}$，$a_b=4.0\\,\\mathrm{fm}$，$V_{0,p}=52.0\\,\\mathrm{MeV}$，$V_{0,d}=90.0\\,\\mathrm{MeV}$，$E_d=60.0\\,\\mathrm{MeV}$，$E_p=20.0\\,\\mathrm{MeV}$。\n- 案例 4 (剩余深度差为零)：$A=40$，$r_0=1.25\\,\\mathrm{fm}$，$a=0.65\\,\\mathrm{fm}$，$a_b=4.0\\,\\mathrm{fm}$，$V_{0,p}=90.0\\,\\mathrm{MeV}$，$V_{0,d}=90.0\\,\\mathrm{MeV}$，$E_d=15.0\\,\\mathrm{MeV}$，$E_p=8.0\\,\\mathrm{MeV}$。\n\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如 $\\left[\\mathrm{result1},\\mathrm{result2},\\mathrm{result3},\\mathrm{result4}\\right]$），每个条目都四舍五入到六位小数，并以 $\\mathrm{MeV\\cdot fm^{3/2}}$ 为单位表示。",
            "solution": "该问题是有效的，因为它在计算核物理领域内提出了一个适定的、有科学依据的场景。它是自洽的，所有必需的常数、参数和函数形式都已提供。这些近似虽然简化了问题，但在模型计算中是标准的，并且不违反基本原理。任务是在这些指定的近似下计算 DWBA 跃迁振幅的剩余项 $\\Delta T$。\n\n计算分几步进行：首先，确定运动学量；其次，定义构成被积函数的各个函数；第三，对最终的积分进行数值计算。\n\n剩余项振幅由以下积分给出：\n$$\n\\Delta T = 4\\pi\\int_0^\\infty r^2\\,j_0(qr)\\,\\big(U_p(r)-U_d(r)\\big)\\,\\phi_b(r)\\,dr\n$$\n\n1.  **运动学量**\n\n计算需要几个从给定输入中派生出的中间运动学参数。\n\n-   **核半径 ($R$)**：质子 ($p$) 和氘核 ($d$) 的 Woods-Saxon 势取决于核半径 $R$，该半径由靶核质量数 $A$ 和半径参数 $r_0$ 计算得出。\n    $$\n    R = r_0\\,A^{1/3}\n    $$\n-   **波数 ($k_i, k_f$)**：初始（氘核）和最终（质子）波数由它们各自的实验室动能 ($E_d$, $E_p$) 和静止质量 ($m_d$, $m_p$) 使用非相对论运动学确定。\n    $$\n    k_i = \\frac{\\sqrt{2\\,m_d\\,E_d}}{\\hbar c}\n    $$\n    $$\n    k_f = \\frac{\\sqrt{2\\,m_p\\,E_p}}{\\hbar c}\n    $$\n    提供的常数为 $\\hbar c=197.3269804\\,\\mathrm{MeV\\cdot fm}$，$m_p=938.2720813\\,\\mathrm{MeV}$ 和 $m_d=1875.61294257\\,\\mathrm{MeV}$。\n-   **动量转移 ($q$)**：在平面波和角度平均近似下，问题指定了动量转移的大小为：\n    $$\n    q = |k_i - k_f|\n    $$\n\n2.  **被积函数的组分函数**\n\n被积函数是几个关于径向坐标 $r$ 的函数的乘积。\n\n-   **光学势 ($U_p(r), U_d(r)$)**：质子和氘核的光学势由 Woods-Saxon 形式给出。它们共享相同的半径 $R$ 和弥散度 $a$，但它们的势深 $V_{0,p}$ 和 $V_{0,d}$ 不同。\n    $$\n    U_p(r) = -\\frac{V_{0,p}}{1+\\exp\\left(\\frac{r-R}{a}\\right)}\n    $$\n    $$\n    U_d(r) = -\\frac{V_{0,d}}{1+\\exp\\left(\\frac{r-R}{a}\\right)}\n    $$\n    因此，它们的差为：\n    $$\n    U_p(r) - U_d(r) = \\frac{V_{0,d} - V_{0,p}}{1+\\exp\\left(\\frac{r-R}{a}\\right)}\n    $$\n-   **束缚态波函数 ($\\phi_b(r)$)**：转移的核子由一个简单的归一化指数函数描述，其特征是长度标度 $a_b$。\n    $$\n    \\phi_b(r) = \\frac{1}{\\sqrt{\\pi}\\,a_b^{3/2}}\\,\\exp\\left(-\\frac{r}{a_b}\\right)\n    $$\n-   **球贝塞尔函数 ($j_0(qr)$)**：此函数源于平面波的角度平均。其定义为：\n    $$\n    j_0(z) = \\frac{\\sin(z)}{z}\n    $$\n    对于自变量 $z=qr$，我们有 $j_0(qr) = \\frac{\\sin(qr)}{qr}$。为避免在 $r=0$ 处出现除以零的情况，按规定使用极限值 $j_0(0)=1$。\n\n3.  **组装被积函数并执行积分**\n\n结合所有分量，完整的被积函数为：\n$$\nI(r) = r^2 \\left( \\frac{\\sin(qr)}{qr} \\right) \\left( \\frac{V_{0,d} - V_{0,p}}{1+\\exp\\left(\\frac{r-R}{a}\\right)} \\right) \\left( \\frac{1}{\\sqrt{\\pi}\\,a_b^{3/2}}\\,\\exp\\left(-\\frac{r}{a_b}\\right) \\right)\n$$\n于是剩余振幅为 $\\Delta T = 4\\pi \\int_0^\\infty I(r) dr$。\n\n当 $V_{0,p} = V_{0,d}$ 时（如测试案例 4），会出现一种特殊情况。在这种场景下，对于所有 $r$，$U_p(r) - U_d(r) = 0$，使得被积函数恒等于零。因此，$\\Delta T = 0$，无需进行数值积分。\n\n该积分通过数值方法计算。被积函数是光滑、良态的函数乘积，对于大的 $r$ 会指数衰减（这是由于 Woods-Saxon 分母和束缚态指数函数共同作用的结果）。这确保了在半无限区间 $[0, \\infty)$ 上的积分快速收敛。一个稳健的数值积分程序，例如 `scipy.integrate.quad`，非常适合此任务，因为它可以处理半无限积分域并提供高精度。该算法会将 integrand 定义为一个 Python 函数，并将其传递给 `scipy.integrate.quad`，以计算从 $r=0$到 $r=\\infty$ 的定积分。最终结果是该积分的值乘以因子 $4\\pi$。结果的单位是 $\\mathrm{MeV\\cdot fm^{3/2}}$，这与所涉各量的物理量纲一致。",
            "answer": "```python\nimport numpy as np\nfrom scipy import integrate\n\ndef solve():\n    \"\"\"\n    Computes the remnant term of the DWBA transition amplitude for several test cases.\n    \"\"\"\n    # Define physical constants. All energies are in MeV, lengths in fm.\n    hbar_c = 197.3269804  # MeV * fm\n    m_p = 938.2720813    # MeV/c^2 (numerically MeV)\n    m_d = 1875.61294257  # MeV/c^2 (numerically MeV)\n\n    # Test cases: (A, r0, a, a_b, V0p, V0d, Ed, Ep)\n    test_cases = [\n        (40, 1.25, 0.65, 4.0, 52.0, 90.0, 15.0, 8.0),\n        (40, 1.25, 0.65, 4.0, 52.0, 90.0, 5.0, 5.0),\n        (40, 1.25, 0.65, 4.0, 52.0, 90.0, 60.0, 20.0),\n        (40, 1.25, 0.65, 4.0, 90.0, 90.0, 15.0, 8.0),\n    ]\n\n    results = []\n\n    for case in test_cases:\n        A, r0, a, ab, V0p, V0d, Ed, Ep = case\n\n        # Handle the trivial case where the potential difference is zero.\n        if V0p == V0d:\n            results.append(0.0)\n            continue\n\n        # Step 1: Calculate kinematic quantities\n        R = r0 * (A ** (1.0 / 3.0))\n        k_i = np.sqrt(2 * m_d * Ed) / hbar_c\n        k_f = np.sqrt(2 * m_p * Ep) / hbar_c\n        q = np.abs(k_i - k_f)\n        \n        # Step 2: Define component functions for the integrand\n        \n        def U_diff(r):\n            # U_p(r) - U_d(r)\n            return (V0d - V0p) / (1.0 + np.exp((r - R) / a))\n\n        def phi_b(r):\n            # Normalized s-wave exponential bound-state wavefunction\n            norm = 1.0 / (np.sqrt(np.pi) * (ab ** 1.5))\n            return norm * np.exp(-r / ab)\n\n        def j0(x):\n            # Spherical Bessel function of order 0, j0(x) = sin(x)/x\n            # Use np.sinc which is defined as sin(pi*x)/(pi*x)\n            # j0(z) = sinc(z/pi)\n            if x == 0:\n                return 1.0\n            return np.sin(x) / x\n\n        # Step 3: Define the full integrand for numerical quadrature\n        # Integrand of Delta_T = 4*pi * integral[ I(r) dr ]\n        # I(r) = r^2 * j0(q*r) * (Up(r) - Ud(r)) * phi_b(r)\n        def integrand(r):\n            if r  0:\n                return 0.0\n            \n            # For r=0, the j0 term is 1, but the r^2 term makes the whole thing 0.\n            if r == 0:\n                return 0.0\n\n            return r**2 * j0(q * r) * U_diff(r) * phi_b(r)\n\n        # Step 4: Perform numerical integration from 0 to infinity\n        integral_val, _ = integrate.quad(integrand, 0, np.inf)\n\n        delta_T = 4 * np.pi * integral_val\n        \n        results.append(round(delta_T, 6))\n\n    # Format output as specified\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        },
        {
            "introduction": "DWBA理论的一个深刻特性是其“先验（prior）”和“后验（post）”形式的等价性——如果底层的势模型是自洽的，它们应给出相同的结果。然而，当使用更真实但更复杂的非定域或能量依赖的势时，这种基本对称性可能会被破坏。本项高级练习将指导您建立一个计算模型来探索这些微妙之处，通过数值检验先验-后验等价性的成立条件，并揭示其在实际计算中可能失效的原因 。",
            "id": "3547975",
            "problem": "考虑畸波玻恩近似 (DWBA)，此处其定义为：由求解含光学势的有效单粒子薛定谔方程得到的畸变波所构成的入射道与出射道之间的一阶跃迁振幅。令初始畸变波为 $\\chi_i(\\mathbf{r})$，末态畸变波为 $\\chi_f(\\mathbf{r})$。一般而言，DWBA 存在两种代数上等价的表述形式，称为先验形式和后验形式。在存在定域且不依赖于能量的光学势的情况下，根据标准的分配一致性，这两种形式是相等的。然而，当光学势为非定域或显式依赖于能量时，除非引入额外的一致性条件或修正项，否则这种相等关系可能被破坏。\n\n我们考虑一个简化的、在单一坐标 $R \\in [0,\\infty)$ 上的球对称模型，并采用无量纲单位制，其中 $\\hbar^2/2\\mu = 1$，因此所有物理量均为无量纲。畸变波 $\\chi_i(R)$ 和 $\\chi_f(R)$ 被视为在 $[0,\\infty)$ 上归一化的平方可积函数。光学势可以是定域的 $U(R,E)$（可能依赖于能量），也可以是非定域的 $U(R,R')$。\n\n将 DWBA 跃迁振幅的先验-后验形式之差定义为\n$$\n\\Delta T \\equiv T_{\\text{prior}} - T_{\\text{post}},\n$$\n其中，在此简化模型中，对于定域且不依赖能量的势，存在一个分配恒等式，我们将先验和后验算符写为表示四个分配的光学势 $U_{aA}$、$U_{bB}$、$U_{xA}$、$U_{xB}$ 的组合。此处忽略了转移形状因子，以便仅关注先验-后验算符之差。对于定域势，定义\n$$\n\\Delta T_{\\text{local}}(E_i,E_f) = \\int_0^\\infty dR\\, \\chi_f(R)\\,\\Big[U_{xA}(R,E_i) - U_{xB}(R,E_f) - U_{bB}(R,E_f) + U_{aA}(R,E_i)\\Big]\\,\\chi_i(R).\n$$\n对于非定域势，定义\n$$\n\\Delta T_{\\text{nonlocal}} = \\int_0^\\infty dR \\int_0^\\infty dR'\\, \\chi_f(R)\\,\\Big[U_{xA}(R,R') - U_{xB}(R,R') - U_{bB}(R,R') + U_{aA}(R,R')\\Big]\\,\\chi_i(R').\n$$\n\n在此简化模型中，先验-后验形式相等的条件是：\n- 对于定域且不依赖能量的势，算符恒等式 $U_{xA}(R) - U_{xB}(R) = U_{bB}(R) - U_{aA}(R)$ 在 $R$ 上逐点成立，这意味着对于任何 $\\chi_i$ 和 $\\chi_f$，都有 $\\Delta T_{\\text{local}}=0$。\n- 对于非定域势，算符恒等式 $U_{xA}(R,R') - U_{xB}(R,R') = U_{bB}(R,R') - U_{aA}(R,R')$ 必须作为核函数相等关系成立，以确保对于任何 $\\chi_i$ 和 $\\chi_f$，都有 $\\Delta T_{\\text{nonlocal}}=0$。\n- 对于显式依赖能量的势 $U(R,E)$，要使等式对一般的 $(E_i,E_f)$ 成立，需要其能量依赖关系满足 $U_{xA}(R,E_i) - U_{xB}(R,E_f) = U_{bB}(R,E_f) - U_{aA}(R,E_i)$ 在 $R$ 上逐点成立。如果不满足此条件，先验-后验形式的相等关系通常会被破坏。\n\n你需要实现一个程序，该程序使用在有限区间 $R \\in [0,R_{\\max}]$ 上通过均匀离散化进行数值归一化的高斯型畸变波，为一组测试用例计算 $\\Delta T$。使用\n$$\n\\chi_i(R) = \\mathcal{N}_i \\exp\\big(-\\gamma_i R^2\\big), \\quad \\chi_f(R) = \\mathcal{N}_f \\exp\\big(-\\gamma_f R^2\\big),\n$$\n其中 $\\mathcal{N}_i$ 和 $\\mathcal{N}_f$ 是由 $\\int_0^{R_{\\max}} dR\\, \\chi_i^2(R) = 1$ 和 $\\int_0^{R_{\\max}} dR\\, \\chi_f^2(R) = 1$ 决定的归一化常数。设置 $R_{\\max} = 10$，$\\gamma_i = 0.4$，以及 $\\gamma_f = 0.7$。\n\n对于定域势，使用以下参数形式\n$$\nU_{\\alpha}(R,E) = V_{0,\\alpha}\\,\\exp\\!\\left(-\\frac{R^2}{a_\\alpha^2}\\right) + \\alpha_\\alpha\\,E\\,\\exp\\!\\left(-\\frac{R^2}{b_\\alpha^2}\\right),\n$$\n其中 $\\alpha \\in \\{aA, bB, xA, xB\\}$，$\\alpha_\\alpha$ 是能量依赖系数。对于非定域核函数，使用对称高斯核\n$$\nU_{\\alpha}(R,R') = V_{0,\\alpha}\\,\\exp\\!\\left(-\\frac{R^2 + R'^2}{a_\\alpha^2}\\right)\\exp\\!\\left(-\\frac{(R - R')^2}{b_\\alpha^2}\\right).\n$$\n\n在 $[0,R_{\\max}]$ 上使用包含 $N = 1000$ 个点的均匀网格，并对单重积分和双重积分采用矩形法则来实现数值积分。\n\n测试套件：\n- 案例 1 (定域、不依赖能量、等式成立)：$E_i=10$, $E_f=10$，参数为 $V_{0,aA}=50$, $a_{aA}=2$, $b_{aA}=1.5$, $\\alpha_{aA}=0$；$V_{0,bB}=35$, $a_{bB}=2$, $b_{bB}=1.5$, $\\alpha_{bB}=0$；$V_{0,xA}=35$, $a_{xA}=2$, $b_{xA}=1.5$, $\\alpha_{xA}=0$；$V_{0,xB}=50$, $a_{xB}=2$, $b_{xB}=1.5$, $\\alpha_{xB}=0$。这逐点满足 $U_{xA}(R)-U_{xB}(R)=U_{bB}(R)-U_{aA}(R)$，因此 $\\Delta T_{\\text{local}}$ 的数值计算结果应接近于 $0$。\n- 案例 2 (定域、依赖能量、等式不成立)：$E_i=10$, $E_f=12$，参数为 $V_{0,aA}=40$, $a_{aA}=2$, $b_{aA}=1.5$, $\\alpha_{aA}=0.5$；$V_{0,bB}=35$, $a_{bB}=2$, $b_{bB}=1.5$, $\\alpha_{bB}=0.2$；$V_{0,xA}=35$, $a_{xA}=2$, $b_{xA}=1.5$, $\\alpha_{xA}=0.2$；$V_{0,xB}=40$, $a_{xB}=2$, $b_{xB}=1.5$, $\\alpha_{xB}=0.5$。这不满足 $U_{xA}(R,E_i)-U_{xB}(R,E_f)=U_{bB}(R,E_f)-U_{aA}(R,E_i)$，因此 $\\Delta T_{\\text{local}} \\neq 0$。\n- 案例 3 (非定域、不依赖能量、等式不成立)：$E_i=10$, $E_f=10$，参数为 $V_{0,aA}=40$, $a_{aA}=2$, $b_{aA}=1$；$V_{0,bB}=35$, $a_{bB}=2$, $b_{bB}=1$；$V_{0,xA}=30$, $a_{xA}=2$, $b_{xA}=1$；$V_{0,xB}=25$, $a_{xB}=2$, $b_{xB}=1$。这不满足 $U_{xA}(R,R')-U_{xB}(R,R')=U_{bB}(R,R')-U_{aA}(R,R')$，因此 $\\Delta T_{\\text{nonlocal}} \\neq 0$。\n- 案例 4 (非定域、不依赖能量、等式成立)：$E_i=10$, $E_f=10$，参数为 $V_{0,aA}=40$, $a_{aA}=2$, $b_{aA}=1$；$V_{0,bB}=30$, $a_{bB}=2$, $b_{bB}=1$；$V_{0,xA}=30$, $a_{xA}=2$, $b_{xA}=1$；$V_{0,xB}=40$, $a_{xB}=2$, $b_{xB}=1$。这满足 $U_{xA}(R,R')-U_{xB}(R,R')=U_{bB}(R,R')-U_{aA}(R,R')$，因此 $\\Delta T_{\\text{nonlocal}}$ 的数值计算结果应接近于 $0$。\n\n你的程序必须：\n- 在网格上构建并归一化 $\\chi_i(R)$ 和 $\\chi_f(R)$。\n- 对每个测试用例，使用适当的公式（定域或非定域）计算 $\\Delta T$。\n- 生成单行输出，其中包含四个结果，格式为方括号内的逗号分隔列表，例如 $\\big[$result1,result2,result3,result4$\\big]$。\n\n所有结果都是无量纲实数。以浮点数形式表示输出。除已说明的无量纲约定外，不涉及任何角度或物理单位。",
            "solution": "用户提供了一个定义明确的计算核物理问题，要求计算畸波玻恩近似 (DWBA) 跃迁振幅的先验-后验形式之差 $\\Delta T$。该问题在科学上是合理的，内容是自洽的，并且算法是清晰的。我们将逐步制定解决方案。\n\n核心任务是为两种情况计算 $\\Delta T$：一种是使用定域、可能依赖能量的光学势；另一种是使用非定域、不依赖能量的光学势。计算将在离散网格上进行数值计算。\n\n**1. 离散化与数值积分**\n\n我们的任务是在有限区间 $R \\in [0, R_{\\max}]$（其中 $R_{\\max} = 10$）上进行计算。该区间被离散化为一个包含 $N=1000$ 个点的均匀网格。设网格点为 $R_j$，其中 $j=0, 1, \\dots, N-1$。一个自然的选择是使用 `numpy.linspace` 生成一个等间距序列。\n$$\nR_j = j \\cdot \\Delta R, \\quad \\text{for } j = 0, 1, \\dots, N-1\n$$\n其中网格间距为 $\\Delta R = R_{\\max} / (N-1)$。问题指定了使用矩形法则进行数值积分。因此，单重积分 $\\int_0^{R_{\\max}} f(R) dR$ 可通过以下求和近似：\n$$\n\\int_0^{R_{\\max}} f(R) dR \\approx \\sum_{j=0}^{N-1} f(R_j) \\Delta R\n$$\n类似地，双重积分 $\\int_0^{R_{\\max}} dR \\int_0^{R_{\\max}} dR' G(R,R')$ 可近似为：\n$$\n\\int_0^{R_{\\max}} dR \\int_0^{R_{\\max}} dR' G(R,R') \\approx \\sum_{j=0}^{N-1} \\sum_{k=0}^{N-1} G(R_j, R_k) (\\Delta R)^2\n$$\n\n**2. 波函数归一化**\n\n初始和末态畸变波 $\\chi_i(R)$ 和 $\\chi_f(R)$ 由高斯函数给出：\n$$\n\\chi_k(R) = \\mathcal{N}_k \\exp(-\\gamma_k R^2), \\quad k \\in \\{i, f\\}\n$$\n参数为 $\\gamma_i = 0.4$ 和 $\\gamma_f = 0.7$。归一化常数 $\\mathcal{N}_i$ 和 $\\mathcal{N}_f$ 由波函数在数值网格上归一化的条件确定：\n$$\n\\int_0^{R_{\\max}} |\\chi_k(R)|^2 dR = 1\n$$\n代入函数形式和数值积分法则，我们得到：\n$$\n\\mathcal{N}_k^2 \\int_0^{R_{\\max}} \\exp(-2\\gamma_k R^2) dR \\approx \\mathcal{N}_k^2 \\left( \\sum_{j=0}^{N-1} \\exp(-2\\gamma_k R_j^2) \\Delta R \\right) = 1\n$$\n由此，归一化常数 $\\mathcal{N}_k$ 计算为：\n$$\n\\mathcal{N}_k = \\left( \\Delta R \\sum_{j=0}^{N-1} \\exp(-2\\gamma_k R_j^2) \\right)^{-1/2}\n$$\n我们将计算这些常数，从而得到离散化的波函数 $\\chi_i(R_j)$ 和 $\\chi_f(R_j)$。\n\n**3. 计算定域势的 $\\Delta T$**\n\n对于定域势，先验-后验形式之差由以下积分给出：\n$$\n\\Delta T_{\\text{local}}(E_i,E_f) = \\int_0^\\infty dR\\, \\chi_f(R)\\,\\Big[U_{xA}(R,E_i) - U_{xB}(R,E_f) - U_{bB}(R,E_f) + U_{aA}(R,E_i)\\Big]\\,\\chi_i(R)\n$$\n定域势 $U_\\alpha(R, E)$ 的形式为：\n$$\nU_{\\alpha}(R,E) = V_{0,\\alpha}\\,\\exp\\!\\left(-\\frac{R^2}{a_\\alpha^2}\\right) + \\alpha_\\alpha\\,E\\,\\exp\\!\\left(-\\frac{R^2}{b_\\alpha^2}\\right)\n$$\n让我们将被积函数中的算符项定义为 $\\Delta U_{\\text{local}}(R)$：\n$$\n\\Delta U_{\\text{local}}(R) = U_{xA}(R,E_i) - U_{xB}(R,E_f) - U_{bB}(R,E_f) + U_{aA}(R,E_i)\n$$\n在数值上，我们首先在每个网格点 $R_j$ 上计算函数 $\\chi_i(R_j)$、$\\chi_f(R_j)$ 和 $\\Delta U_{\\text{local}}(R_j)$ 的值。然后，我们使用积分法则计算该积分：\n$$\n\\Delta T_{\\text{local}} \\approx \\sum_{j=0}^{N-1} \\chi_f(R_j) \\Delta U_{\\text{local}}(R_j) \\chi_i(R_j) \\Delta R\n$$\n\n**4. 计算非定域势的 $\\Delta T$**\n\n对于非定域势，先验-后验形式之差涉及一个双重积分：\n$$\n\\Delta T_{\\text{nonlocal}} = \\int_0^\\infty dR \\int_0^\\infty dR'\\, \\chi_f(R)\\,\\Big[U_{xA}(R,R') - U_{xB}(R,R') - U_{bB}(R,R') + U_{aA}(R,R')\\Big]\\,\\chi_i(R')\n$$\n非定域势 $U_\\alpha(R, R')$ 具有对称高斯形式：\n$$\nU_{\\alpha}(R,R') = V_{0,\\alpha}\\,\\exp\\!\\left(-\\frac{R^2 + R'^2}{a_\\alpha^2}\\right)\\exp\\!\\left(-\\frac{(R - R')^2}{b_\\alpha^2}\\right)\n$$\n让我们将算符的核函数定义为 $\\Delta U_{\\text{nonlocal}}(R, R')$：\n$$\n\\Delta U_{\\text{nonlocal}}(R,R') = U_{xA}(R,R') - U_{xB}(R,R') - U_{bB}(R,R') + U_{aA}(R,R')\n$$\n在离散化空间中，波函数变为长度为 $N$ 的向量 $\\boldsymbol{\\chi}_i$ 和 $\\boldsymbol{\\chi}_f$，而核函数变为一个 $N \\times N$ 矩阵 $\\mathbf{\\Delta U}_{\\text{nonlocal}}$，其元素为 $(\\mathbf{\\Delta U}_{\\text{nonlocal}})_{jk} = \\Delta U_{\\text{nonlocal}}(R_j, R_k)$。双重积分变成一个矩阵运算：\n$$\n\\Delta T_{\\text{nonlocal}} \\approx \\sum_{j=0}^{N-1} \\sum_{k=0}^{N-1} \\chi_f(R_j) \\Delta U_{\\text{nonlocal}}(R_j, R_k) \\chi_i(R_k) (\\Delta R)^2\n$$\n这等价于矩阵乘积：\n$$\n\\Delta T_{\\text{nonlocal}} \\approx \\boldsymbol{\\chi}_f^T \\, \\mathbf{\\Delta U}_{\\text{nonlocal}} \\, \\boldsymbol{\\chi}_i \\, (\\Delta R)^2\n$$\n其中 $\\boldsymbol{\\chi}_f^T$ 是列向量 $\\boldsymbol{\\chi}_f$ 的转置。实现过程将涉及构建四个 $N \\times N$ 的势矩阵，将它们组合成 $\\mathbf{\\Delta U}_{\\text{nonlocal}}$，最后执行矩阵-向量乘法。\n\n**5. 测试用例的实现**\n\n程序将被结构化以处理四个指定的测试用例。它将首先设置公共元素（网格、波函数），然后遍历这些用例。根据用例是“定域”还是“非定域”，将遵循上述相应的计算路径。每个势的参数（$V_{0,\\alpha}, a_\\alpha, b_\\alpha, \\alpha_\\alpha$）和能量（$E_i, E_f$）将根据每个用例的问题描述来获取。最终结果将被收集并按指定格式化。\n\n对于先验-后验形式相等的用例（案例 1 和案例 4），算符项 $\\Delta U$ 在解析上应为零。数值计算应产生一个非常接近零的结果，任何偏差都可归因于浮点精度限制。对于等式不成立的用例（案例 2 和案例 3），预计会得到一个非零结果。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the prior-post difference of the DWBA transition amplitude\n    for four test cases, involving local and nonlocal potentials.\n    \"\"\"\n    # --- Global Parameters ---\n    R_max = 10.0\n    N = 1000\n    gamma_i = 0.4\n    gamma_f = 0.7\n\n    # --- Grid Setup ---\n    R, dR = np.linspace(0, R_max, N, retstep=True)\n\n    # --- Helper Functions ---\n    def normalize_wave_function(gamma, R_grid, dr):\n        \"\"\"\n        Numerically normalizes a Gaussian wave function on the grid.\n        \"\"\"\n        unnormalized_wf = np.exp(-gamma * R_grid**2)\n        norm_integral = np.sum(unnormalized_wf**2) * dr\n        norm_constant = 1.0 / np.sqrt(norm_integral)\n        return norm_constant * unnormalized_wf\n\n    def U_local(R_grid, E, V0, a, b_param, alpha):\n        \"\"\"\n        Computes a local, energy-dependent potential on the grid.\n        \"\"\"\n        term1 = V0 * np.exp(-R_grid**2 / a**2)\n        term2 = alpha * E * np.exp(-R_grid**2 / b_param**2)\n        return term1 + term2\n\n    def U_nonlocal(R_grid, V0, a, b_param):\n        \"\"\"\n        Computes a nonlocal potential kernel as a matrix.\n        \"\"\"\n        R_mesh, R_prime_mesh = np.meshgrid(R_grid, R_grid)\n        term1 = np.exp(-(R_mesh**2 + R_prime_mesh**2) / a**2)\n        term2 = np.exp(-(R_mesh - R_prime_mesh)**2 / b_param**2)\n        return V0 * term1 * term2\n\n    # --- Wave Function Calculation ---\n    chi_i = normalize_wave_function(gamma_i, R, dR)\n    chi_f = normalize_wave_function(gamma_f, R, dR)\n\n    # --- Test Suite Definition ---\n    test_cases = [\n        # Case 1 (Local, energy-independent, equality satisfied)\n        {\n            \"type\": \"local\", \"E_i\": 10.0, \"E_f\": 10.0,\n            \"params\": {\n                \"aA\": {\"V0\": 50, \"a\": 2, \"b\": 1.5, \"alpha\": 0},\n                \"bB\": {\"V0\": 35, \"a\": 2, \"b\": 1.5, \"alpha\": 0},\n                \"xA\": {\"V0\": 35, \"a\": 2, \"b\": 1.5, \"alpha\": 0},\n                \"xB\": {\"V0\": 50, \"a\": 2, \"b\": 1.5, \"alpha\": 0},\n            }\n        },\n        # Case 2 (Local, energy-dependent, equality violated)\n        {\n            \"type\": \"local\", \"E_i\": 10.0, \"E_f\": 12.0,\n            \"params\": {\n                \"aA\": {\"V0\": 40, \"a\": 2, \"b\": 1.5, \"alpha\": 0.5},\n                \"bB\": {\"V0\": 35, \"a\": 2, \"b\": 1.5, \"alpha\": 0.2},\n                \"xA\": {\"V0\": 35, \"a\": 2, \"b\": 1.5, \"alpha\": 0.2},\n                \"xB\": {\"V0\": 40, \"a\": 2, \"b\": 1.5, \"alpha\": 0.5},\n            }\n        },\n        # Case 3 (Nonlocal, energy-independent, equality violated)\n        {\n            \"type\": \"nonlocal\",\n            \"params\": {\n                \"aA\": {\"V0\": 40, \"a\": 2, \"b\": 1},\n                \"bB\": {\"V0\": 35, \"a\": 2, \"b\": 1},\n                \"xA\": {\"V0\": 30, \"a\": 2, \"b\": 1},\n                \"xB\": {\"V0\": 25, \"a\": 2, \"b\": 1},\n            }\n        },\n        # Case 4 (Nonlocal, energy-independent, equality satisfied)\n        {\n            \"type\": \"nonlocal\",\n            \"params\": {\n                \"aA\": {\"V0\": 40, \"a\": 2, \"b\": 1},\n                \"bB\": {\"V0\": 30, \"a\": 2, \"b\": 1},\n                \"xA\": {\"V0\": 30, \"a\": 2, \"b\": 1},\n                \"xB\": {\"V0\": 40, \"a\": 2, \"b\": 1},\n            }\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        if case[\"type\"] == \"local\":\n            E_i, E_f = case[\"E_i\"], case[\"E_f\"]\n            p = case[\"params\"]\n            \n            U_aA = U_local(R, E_i, p[\"aA\"][\"V0\"], p[\"aA\"][\"a\"], p[\"aA\"][\"b\"], p[\"aA\"][\"alpha\"])\n            U_bB = U_local(R, E_f, p[\"bB\"][\"V0\"], p[\"bB\"][\"a\"], p[\"bB\"][\"b\"], p[\"bB\"][\"alpha\"])\n            U_xA = U_local(R, E_i, p[\"xA\"][\"V0\"], p[\"xA\"][\"a\"], p[\"xA\"][\"b\"], p[\"xA\"][\"alpha\"])\n            U_xB = U_local(R, E_f, p[\"xB\"][\"V0\"], p[\"xB\"][\"a\"], p[\"xB\"][\"b\"], p[\"xB\"][\"alpha\"])\n            \n            delta_U_local = U_xA - U_xB - U_bB + U_aA\n            integrand = chi_f * delta_U_local * chi_i\n            delta_T = np.sum(integrand) * dR\n            results.append(delta_T)\n\n        elif case[\"type\"] == \"nonlocal\":\n            p = case[\"params\"]\n\n            U_aA_mat = U_nonlocal(R, p[\"aA\"][\"V0\"], p[\"aA\"][\"a\"], p[\"aA\"][\"b\"])\n            U_bB_mat = U_nonlocal(R, p[\"bB\"][\"V0\"], p[\"bB\"][\"a\"], p[\"bB\"][\"b\"])\n            U_xA_mat = U_nonlocal(R, p[\"xA\"][\"V0\"], p[\"xA\"][\"a\"], p[\"xA\"][\"b\"])\n            U_xB_mat = U_nonlocal(R, p[\"xB\"][\"V0\"], p[\"xB\"][\"a\"], p[\"xB\"][\"b\"])\n\n            delta_U_nonlocal = U_xA_mat - U_xB_mat - U_bB_mat + U_aA_mat\n            \n            # Using matrix multiplication for the double summation\n            # result = chi_f^T @ (delta_U @ chi_i) * dR^2\n            delta_T = np.dot(chi_f, np.dot(delta_U_nonlocal, chi_i)) * dR**2\n            results.append(delta_T)\n\n    # --- Final Output ---\n    # Format results without scientific notation for small numbers near zero\n    formatted_results = [f\"{r:.15f}\".rstrip('0').rstrip('.') if abs(r)  1e-12 else \"0.0\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}