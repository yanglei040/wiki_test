{
    "hands_on_practices": [
        {
            "introduction": "The full six-dimensional integral in the Distorted Wave Born Approximation (DWBA) is computationally demanding, making simplifying approximations a crucial part of its practical application. This exercise guides you through a foundational analytical derivation that connects a realistic finite-range interaction to the widely used zero-range approximation. By applying the local momentum approximation, you will derive the finite-range correction factor, gaining crucial insight into the structure of the transition amplitude and the physical meaning of the approximations involved .",
            "id": "3547926",
            "problem": "In the post form of the Distorted Wave Born Approximation (DWBA) for a single-nucleon transfer, the finite-range transition amplitude can be written schematically as an overlap of the proton–neutron relative-coordinate kernel with the proton–neutron interaction. Let the proton–neutron interaction be modeled by a finite-range Gaussian,\n$$\nV_{pn}(r)=V_{0}\\,\\exp\\!\\big(-r^{2}/\\beta^{2}\\big),\n$$\nwith range parameter $\\beta0$ and strength $V_{0}$. Denote by $\\mathbf{s}$ the proton–neutron relative coordinate and by $R(\\mathbf{s})$ the reaction kernel that multiplies $V_{pn}(\\mathbf{s})$ in the DWBA integrand (this kernel contains the product of the distorted waves and the relevant bound-state overlaps). The zero-range limit corresponds to $R(\\mathbf{s})\\to R(\\mathbf{0})$ in the neighborhood of $\\mathbf{s}=\\mathbf{0}$.\n\nStarting from the finite-range amplitude written as the overlap integral over $\\mathbf{s}$, and using only the assumptions that:\n- $R(\\mathbf{s})$ is smooth in a neighborhood of $\\mathbf{s}=\\mathbf{0}$ and varies on a length scale large compared to $\\beta$,\n- the dominant variation of $R(\\mathbf{s})$ over the support of $V_{pn}(\\mathbf{s})$ is through a complex phase whose local gradient at $\\mathbf{s}=\\mathbf{0}$ defines a real “local momentum mismatch” vector $\\mathbf{K}$,\n\nderive a factorized form of the finite-range amplitude in terms of the zero-range amplitude multiplied by a finite-range correction factor $F_{\\mathrm{FR}}(K)$ that depends only on $K=|\\mathbf{K}|$ and the interaction range $\\beta$. Then, identify the effective range parameter that enters the overlap integral through the second moment of $V_{pn}$, defined by\n$$\nr_{\\mathrm{eff}}^{2}\\equiv \\frac{\\displaystyle\\int_{\\mathbb{R}^{3}} d^{3}s\\, s^{2}\\,V_{pn}(s)}{\\displaystyle\\int_{\\mathbb{R}^{3}} d^{3}s\\, V_{pn}(s)}.\n$$\n\nYour final answer must present:\n1. The closed-form analytic expression for $F_{\\mathrm{FR}}(K)$.\n2. The closed-form analytic expression for $r_{\\mathrm{eff}}^{2}$.\n\nNo numerical evaluation is required, and no rounding is needed. Express the two results as symbolic expressions. If you provide both results, write them as a single row using the LaTeX $pmatrix$ environment as specified in the answer format.",
            "solution": "The problem requires the derivation of two quantities related to the finite-range Distorted Wave Born Approximation (DWBA) transition amplitude for a single-nucleon transfer reaction. The first is a finite-range correction factor, $F_{\\mathrm{FR}}(K)$, and the second is an effective range-squared parameter, $r_{\\mathrm{eff}}^{2}$, for the given proton-neutron interaction.\n\nThe problem is validated as scientifically grounded, well-posed, and self-contained. It is a standard derivation in nuclear reaction theory.\n\nLet us begin by defining the finite-range transition amplitude, $T_{\\mathrm{FR}}$. Schematically, it is given by the overlap integral of the reaction kernel $R(\\mathbf{s})$ with the proton-neutron interaction $V_{pn}(s)$ over the relative coordinate $\\mathbf{s}$:\n$$\nT_{\\mathrm{FR}} = \\int_{\\mathbb{R}^{3}} d^{3}s \\, R(\\mathbf{s}) V_{pn}(s)\n$$\nwhere $s = |\\mathbf{s}|$ and the interaction is given by the Gaussian form:\n$$\nV_{pn}(s) = V_{0} \\exp\\left(-\\frac{s^{2}}{\\beta^{2}}\\right)\n$$\n\nThe first task is to derive the finite-range correction factor $F_{\\mathrm{FR}}(K)$. This factor relates the finite-range amplitude $T_{\\mathrm{FR}}$ to the zero-range amplitude $T_{\\mathrm{ZR}}$. The zero-range approximation corresponds to assuming that the kernel $R(\\mathbf{s})$ is constant over the short range of the interaction, i.e., $R(\\mathbf{s}) \\approx R(\\mathbf{0})$. Thus, the zero-range amplitude is:\n$$\nT_{\\mathrm{ZR}} = \\int_{\\mathbb{R}^{3}} d^{3}s \\, R(\\mathbf{0}) V_{pn}(s) = R(\\mathbf{0}) \\int_{\\mathbb{R}^{3}} d^{3}s \\, V_{pn}(s)\n$$\n\nThe problem provides a more refined approximation for $R(\\mathbf{s})$ to be used in the calculation of $T_{\\mathrm{FR}}$. The assumptions are that $R(\\mathbf{s})$ is smooth and that its dominant variation near $\\mathbf{s}=\\mathbf{0}$ is a complex phase. This can be expressed mathematically by approximating $R(\\mathbf{s})$ using the first-order term in the Taylor expansion of its phase. Let $R(\\mathbf{s}) = |R(\\mathbf{s})|\\exp(i\\phi(\\mathbf{s}))$. The smoothness of $|R(\\mathbf{s})|$ implies $|R(\\mathbf{s})| \\approx |R(\\mathbf{0})|$ for small $s$. The phase is approximated as $\\phi(\\mathbf{s}) \\approx \\phi(\\mathbf{0}) + \\mathbf{s} \\cdot \\left(\\nabla\\phi\\right)|_{\\mathbf{s}=\\mathbf{0}}$. The problem defines the local momentum mismatch vector $\\mathbf{K}$ as this gradient, $\\mathbf{K} = \\left(\\nabla\\phi\\right)|_{\\mathbf{s}=\\mathbf{0}}$. Therefore, we have the local momentum approximation:\n$$\nR(\\mathbf{s}) \\approx R(\\mathbf{0}) \\exp(i\\mathbf{K} \\cdot \\mathbf{s})\n$$\nwhere any constant phase factor $\\exp(i\\phi(\\mathbf{0}))$ has been absorbed into the complex prefactor $R(\\mathbf{0})$.\n\nSubstituting this approximation into the expression for $T_{\\mathrm{FR}}$:\n$$\nT_{\\mathrm{FR}} \\approx \\int_{\\mathbb{R}^{3}} d^{3}s \\, \\left[ R(\\mathbf{0}) \\exp(i\\mathbf{K} \\cdot \\mathbf{s}) \\right] \\left[ V_{0} \\exp\\left(-\\frac{s^{2}}{\\beta^{2}}\\right) \\right]\n$$\n$$\nT_{\\mathrm{FR}} \\approx R(\\mathbf{0}) V_{0} \\int_{\\mathbb{R}^{3}} d^{3}s \\, \\exp\\left(i\\mathbf{K} \\cdot \\mathbf{s} - \\frac{s^{2}}{\\beta^{2}}\\right)\n$$\nThe finite-range correction factor $F_{\\mathrm{FR}}(K)$ is defined by the relation $T_{\\mathrm{FR}} = T_{\\mathrm{ZR}} F_{\\mathrm{FR}}(K)$. Therefore:\n$$\nF_{\\mathrm{FR}}(K) = \\frac{T_{\\mathrm{FR}}}{T_{\\mathrm{ZR}}} = \\frac{R(\\mathbf{0}) V_{0} \\int d^{3}s \\, \\exp\\left(i\\mathbf{K} \\cdot \\mathbf{s} - s^{2}/\\beta^{2}\\right)}{R(\\mathbf{0}) V_{0} \\int d^{3}s \\, \\exp\\left(-s^{2}/\\beta^{2}\\right)} = \\frac{\\int d^{3}s \\, \\exp\\left(i\\mathbf{K} \\cdot \\mathbf{s} - s^{2}/\\beta^{2}\\right)}{\\int d^{3}s \\, \\exp\\left(-s^{2}/\\beta^{2}\\right)}\n$$\nThe denominator is a standard 3D Gaussian integral, which we denote as $I_{denom}$.\n$$\nI_{denom} = \\int d^{3}s \\, \\exp\\left(-\\frac{s^{2}}{\\beta^{2}}\\right) = (\\pi \\beta^{2})^{3/2} = \\pi^{3/2} \\beta^{3}\n$$\nThe numerator, $I_{num}$, is the Fourier transform of a Gaussian function.\n$$\nI_{num} = \\int d^{3}s \\, \\exp\\left(-\\frac{s^{2}}{\\beta^{2}}\\right) \\exp\\left(i\\mathbf{K} \\cdot \\mathbf{s}\\right)\n$$\nTo evaluate this, we complete the square in the exponent:\n$$\n-\\frac{s^{2}}{\\beta^{2}} + i\\mathbf{K} \\cdot \\mathbf{s} = -\\frac{1}{\\beta^{2}}\\left(s^{2} - i\\beta^{2}\\mathbf{K} \\cdot \\mathbf{s}\\right) = -\\frac{1}{\\beta^{2}}\\left[\\left(\\mathbf{s} - \\frac{i\\beta^{2}\\mathbf{K}}{2}\\right)^{2} + \\frac{\\beta^{4}K^{2}}{4}\\right] = -\\frac{1}{\\beta^{2}}\\left(\\mathbf{s} - \\frac{i\\beta^{2}\\mathbf{K}}{2}\\right)^{2} - \\frac{\\beta^{2}K^{2}}{4}\n$$\nwhere $K = |\\mathbf{K}|$. The integral becomes:\n$$\nI_{num} = \\exp\\left(-\\frac{\\beta^{2}K^{2}}{4}\\right) \\int d^{3}s \\, \\exp\\left[-\\frac{1}{\\beta^{2}}\\left(\\mathbf{s} - \\frac{i\\beta^{2}\\mathbf{K}}{2}\\right)^{2}\\right]\n$$\nBy shifting the integration variable $\\mathbf{s}' = \\mathbf{s} - \\frac{i\\beta^{2}\\mathbf{K}}{2}$, which is a shift into the complex plane, the value of the Gaussian integral remains unchanged.\n$$\n\\int d^{3}s \\, \\exp\\left[-\\frac{1}{\\beta^{2}}\\left(\\mathbf{s} - \\frac{i\\beta^{2}\\mathbf{K}}{2}\\right)^{2}\\right] = \\int d^{3}s' \\, \\exp\\left(-\\frac{s'^{2}}{\\beta^{2}}\\right) = I_{denom}\n$$\nTherefore, $I_{num} = I_{denom} \\cdot \\exp\\left(-\\frac{\\beta^{2}K^{2}}{4}\\right)$.\nThe correction factor is the ratio:\n$$\nF_{\\mathrm{FR}}(K) = \\frac{I_{num}}{I_{denom}} = \\exp\\left(-\\frac{\\beta^{2}K^{2}}{4}\\right)\n$$\n\nThe second task is to find the effective range-squared parameter $r_{\\mathrm{eff}}^{2}$, defined as the ratio of the second moment of the potential to its volume integral:\n$$\nr_{\\mathrm{eff}}^{2} \\equiv \\frac{\\displaystyle\\int_{\\mathbb{R}^{3}} d^{3}s\\, s^{2}\\,V_{pn}(s)}{\\displaystyle\\int_{\\mathbb{R}^{3}} d^{3}s\\, V_{pn}(s)}\n$$\nSubstituting $V_{pn}(s) = V_{0}\\exp(-s^{2}/\\beta^{2})$, the constant $V_{0}$ cancels:\n$$\nr_{\\mathrm{eff}}^{2} = \\frac{\\displaystyle\\int d^{3}s\\, s^{2}\\,\\exp(-s^{2}/\\beta^{2})}{\\displaystyle\\int d^{3}s\\, \\exp(-s^{2}/\\beta^{2})}\n$$\nThe denominator is again $I_{denom} = \\pi^{3/2} \\beta^{3}$.\nThe numerator is the integral of $s^{2}\\exp(-s^{2}/\\beta^{2})$. We evaluate this in spherical coordinates, where $d^{3}s = 4\\pi s^{2}ds$ after angular integration.\n$$\nI_{num}' = \\int d^{3}s\\, s^{2}\\,\\exp(-s^{2}/\\beta^{2}) = 4\\pi \\int_{0}^{\\infty} s^{4}\\exp(-s^{2}/\\beta^{2}) ds\n$$\nWe use the standard integral formula $\\int_{0}^{\\infty} x^{2n} \\exp(-ax^{2}) dx = \\frac{(2n-1)!!}{2^{n+1}}\\sqrt{\\frac{\\pi}{a^{2n+1}}}$. With $n=2$ and $a=1/\\beta^{2}$:\n$$\n\\int_{0}^{\\infty} s^{4}\\exp(-s^{2}/\\beta^{2}) ds = \\frac{3!!}{2^{3}}\\sqrt{\\frac{\\pi}{(1/\\beta^{2})^{5}}} = \\frac{3}{8}\\sqrt{\\pi\\beta^{10}} = \\frac{3\\sqrt{\\pi}}{8}\\beta^{5}\n$$\nSo the numerator integral is:\n$$\nI_{num}' = 4\\pi \\left(\\frac{3\\sqrt{\\pi}}{8}\\beta^{5}\\right) = \\frac{3\\pi^{3/2}}{2}\\beta^{5}\n$$\nFinally, we compute the ratio for $r_{\\mathrm{eff}}^{2}$:\n$$\nr_{\\mathrm{eff}}^{2} = \\frac{I_{num}'}{I_{denom}} = \\frac{\\frac{3\\pi^{3/2}}{2}\\beta^{5}}{\\pi^{3/2}\\beta^{3}} = \\frac{3}{2}\\beta^{2}\n$$\nThe two required expressions are $F_{\\mathrm{FR}}(K) = \\exp(-\\frac{\\beta^{2}K^{2}}{4})$ and $r_{\\mathrm{eff}}^{2} = \\frac{3}{2}\\beta^{2}$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\exp\\left(-\\frac{K^{2}\\beta^{2}}{4}\\right)  \\frac{3}{2}\\beta^{2}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "When formulating the DWBA amplitude in its \"prior\" form, the transition operator contains not only the direct proton-neutron interaction but also a \"remnant term\" arising from the difference between optical potentials in the entrance and exit channels. This computational practice challenges you to isolate and quantify this remnant term within a simplified but physically representative model . Implementing the numerical quadrature for this term will provide a concrete understanding of how different kinematic conditions and potential choices impact this component of the full transition amplitude.",
            "id": "3547961",
            "problem": "Consider nucleon transfer in a deuteron-induced reaction within the Distorted Wave Born Approximation (DWBA), defined by the transition amplitude $T=\\langle \\chi_f^{(-)}|V_{tr}|\\phi_b\\,\\chi_i^{(+)}\\rangle$, where $V_{tr}$ is the transition interaction, $\\chi_i^{(+)}$ and $\\chi_f^{(-)}$ are incoming and outgoing distorted waves, and $\\phi_b$ is the bound-state wavefunction of the transferred nucleon about the residual nucleus. In the standard prior form, one writes $V_{tr}=V_{pn}+U_p-U_d$, where $V_{pn}$ is the proton-neutron interaction, $U_p$ is the proton optical potential in the exit channel, and $U_d$ is the deuteron optical potential in the entrance channel. The remnant term is the contribution to the amplitude from $U_p-U_d$, denoted by $\\Delta T=\\langle \\chi_f^{(-)}|(U_p-U_d)|\\phi_b\\,\\chi_i^{(+)}\\rangle$. Starting from the first Born approximation and the plane-wave limit for distorted waves, treat the target nucleus as infinitely heavy so that the reduced mass is well approximated by the projectile mass. Use central, local, and purely real optical potentials of Woods–Saxon form for the proton and deuteron, $U_x(r)=-\\dfrac{V_{0,x}}{1+\\exp\\left(\\dfrac{r-R}{a}\\right)}$, with $x\\in\\{p,d\\}$, radius $R=r_0\\,A^{1/3}$, diffuseness $a$, and depth $V_{0,x}$. Model the bound-state as an $s$-wave exponential with hydrogenic normalization, $\\phi_b(r)=\\dfrac{1}{\\sqrt{\\pi}\\,a_b^{3/2}}\\,\\exp\\!\\left(-\\dfrac{r}{a_b}\\right)$. In the plane-wave approximation, angle-averaging the product of incoming and outgoing plane waves yields a spherical Bessel function $j_0(qr)=\\dfrac{\\sin(qr)}{qr}$ with momentum transfer $q=\\lvert k_i-k_f\\rvert$. Using nonrelativistic kinematics in the heavy-target limit, the wave numbers are $k_i=\\dfrac{\\sqrt{2\\,m_d\\,E_d}}{\\hbar c}$ and $k_f=\\dfrac{\\sqrt{2\\,m_p\\,E_p}}{\\hbar c}$, where $m_d$ and $m_p$ are the deuteron and proton rest energies in $\\mathrm{MeV}$, $E_d$ and $E_p$ are the laboratory kinetic energies in $\\mathrm{MeV}$, and $\\hbar c$ is expressed in $\\mathrm{MeV\\cdot fm}$. Under these assumptions, the remnant amplitude reduces to the radial integral\n$$\n\\Delta T \\;=\\; 4\\pi\\int_0^\\infty r^2\\,j_0(qr)\\,\\big(U_p(r)-U_d(r)\\big)\\,\\phi_b(r)\\,dr,\n$$\nwhich has units of $\\mathrm{MeV\\cdot fm^{3/2}}$ when $\\phi_b$ is normalized as given.\n\nImplement a program that computes $\\Delta T$ for a specified target mass number $A$, Woods–Saxon parameters $r_0$ and $a$, bound-state length scale $a_b$, and channel energies $E_d$ and $E_p$, with specified optical depths $V_{0,p}$ and $V_{0,d}$. Use numerical quadrature to evaluate the integral on $r\\in[0,R_{\\max}]$ with $R_{\\max}$ large enough that the integrand is negligible beyond it. Use the spherical Bessel function $j_0(qr)=\\dfrac{\\sin(qr)}{qr}$ with the limiting value $j_0(0)=1$. Constants to use are $\\hbar c=197.3269804\\,\\mathrm{MeV\\cdot fm}$, $m_p=938.2720813\\,\\mathrm{MeV}$, and $m_d=1875.61294257\\,\\mathrm{MeV}$.\n\nExpress the computed remnant amplitudes in $\\mathrm{MeV\\cdot fm^{3/2}}$, rounded to six decimal places.\n\nTest suite:\n- Case $1$ (general case): $A=40$, $r_0=1.25\\,\\mathrm{fm}$, $a=0.65\\,\\mathrm{fm}$, $a_b=4.0\\,\\mathrm{fm}$, $V_{0,p}=52.0\\,\\mathrm{MeV}$, $V_{0,d}=90.0\\,\\mathrm{MeV}$, $E_d=15.0\\,\\mathrm{MeV}$, $E_p=8.0\\,\\mathrm{MeV}$.\n- Case $2$ (near-threshold energies): $A=40$, $r_0=1.25\\,\\mathrm{fm}$, $a=0.65\\,\\mathrm{fm}$, $a_b=4.0\\,\\mathrm{fm}$, $V_{0,p}=52.0\\,\\mathrm{MeV}$, $V_{0,d}=90.0\\,\\mathrm{MeV}$, $E_d=5.0\\,\\mathrm{MeV}$, $E_p=5.0\\,\\mathrm{MeV}$.\n- Case $3$ (high entrance energy): $A=40$, $r_0=1.25\\,\\mathrm{fm}$, $a=0.65\\,\\mathrm{fm}$, $a_b=4.0\\,\\mathrm{fm}$, $V_{0,p}=52.0\\,\\mathrm{MeV}$, $V_{0,d}=90.0\\,\\mathrm{MeV}$, $E_d=60.0\\,\\mathrm{MeV}$, $E_p=20.0\\,\\mathrm{MeV}$.\n- Case $4$ (vanishing remnant depth difference): $A=40$, $r_0=1.25\\,\\mathrm{fm}$, $a=0.65\\,\\mathrm{fm}$, $a_b=4.0\\,\\mathrm{fm}$, $V_{0,p}=90.0\\,\\mathrm{MeV}$, $V_{0,d}=90.0\\,\\mathrm{MeV}$, $E_d=15.0\\,\\mathrm{MeV}$, $E_p=8.0\\,\\mathrm{MeV}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $\\left[\\mathrm{result1},\\mathrm{result2},\\mathrm{result3},\\mathrm{result4}\\right]$), with each entry rounded to six decimal places and expressed in $\\mathrm{MeV\\cdot fm^{3/2}}$.",
            "solution": "The problem is valid as it presents a well-posed, scientifically grounded scenario within the field of computational nuclear physics. It is self-contained, with all necessary constants, parameters, and functional forms provided. The approximations, while simplifying, are standard in model calculations and do not violate fundamental principles. The task is to compute the remnant term of the DWBA transition amplitude, $\\Delta T$, under these specified approximations.\n\nThe calculation proceeds in several steps: first, the determination of kinematic quantities; second, the definition of the functions comprising the integrand; and third, the numerical evaluation of the final integral.\n\nThe remnant term amplitude is given by the integral:\n$$\n\\Delta T = 4\\pi\\int_0^\\infty r^2\\,j_0(qr)\\,\\big(U_p(r)-U_d(r)\\big)\\,\\phi_b(r)\\,dr\n$$\n\n1.  **Kinematic Quantities**\n\nThe calculation requires several intermediate kinematic parameters derived from the given inputs.\n\n-   **Nuclear Radius ($R$)**: The Woods-Saxon potentials for the proton ($p$) and deuteron ($d$) depend on the nuclear radius $R$, which is calculated from the target mass number $A$ and the radius parameter $r_0$.\n    $$\n    R = r_0\\,A^{1/3}\n    $$\n-   **Wavenumbers ($k_i, k_f$)**: The initial (deuteron) and final (proton) wavenumbers are determined from their respective laboratory kinetic energies ($E_d$, $E_p$) and rest masses ($m_d$, $m_p$) using nonrelativistic kinematics.\n    $$\n    k_i = \\frac{\\sqrt{2\\,m_d\\,E_d}}{\\hbar c}\n    $$\n    $$\n    k_f = \\frac{\\sqrt{2\\,m_p\\,E_p}}{\\hbar c}\n    $$\n    The provided constants are $\\hbar c=197.3269804\\,\\mathrm{MeV\\cdot fm}$, $m_p=938.2720813\\,\\mathrm{MeV}$, and $m_d=1875.61294257\\,\\mathrm{MeV}$.\n-   **Momentum Transfer ($q$)**: The problem specifies the magnitude of the momentum transfer, under the plane-wave and angle-averaging approximation, as:\n    $$\n    q = |k_i - k_f|\n    $$\n\n2.  **Component Functions of the Integrand**\n\nThe integrand is a product of several functions of the radial coordinate $r$.\n\n-   **Optical Potentials ($U_p(r), U_d(r)$)**: The proton and deuteron optical potentials are given by the Woods-Saxon form. They share the same radius $R$ and diffuseness $a$, but differ in their potential depths $V_{0,p}$ and $V_{0,d}$.\n    $$\n    U_p(r) = -\\frac{V_{0,p}}{1+\\exp\\left(\\frac{r-R}{a}\\right)}\n    $$\n    $$\n    U_d(r) = -\\frac{V_{0,d}}{1+\\exp\\left(\\frac{r-R}{a}\\right)}\n    $$\n    Therefore, their difference is:\n    $$\n    U_p(r) - U_d(r) = \\frac{V_{0,d} - V_{0,p}}{1+\\exp\\left(\\frac{r-R}{a}\\right)}\n    $$\n-   **Bound-State Wavefunction ($\\phi_b(r)$)**: The transferred nucleon is described by a simple normalized exponential function, characterized by the length scale $a_b$.\n    $$\n    \\phi_b(r) = \\frac{1}{\\sqrt{\\pi}\\,a_b^{3/2}}\\,\\exp\\left(-\\frac{r}{a_b}\\right)\n    $$\n-   **Spherical Bessel Function ($j_0(qr)$)**: This function arises from the angle-averaging of the plane waves. It is defined as:\n    $$\n    j_0(z) = \\frac{\\sin(z)}{z}\n    $$\n    For the argument $z=qr$, we have $j_0(qr) = \\frac{\\sin(qr)}{qr}$. To avoid division by zero at $r=0$, the limiting value $j_0(0)=1$ is used, as specified.\n\n3.  **Assembling the Integrand and Performing the Integration**\n\nCombining all components, the full integrand is:\n$$\nI(r) = r^2 \\left( \\frac{\\sin(qr)}{qr} \\right) \\left( \\frac{V_{0,d} - V_{0,p}}{1+\\exp\\left(\\frac{r-R}{a}\\right)} \\right) \\left( \\frac{1}{\\sqrt{\\pi}\\,a_b^{3/2}}\\,\\exp\\left(-\\frac{r}{a_b}\\right) \\right)\n$$\nThe remnant amplitude is then $\\Delta T = 4\\pi \\int_0^\\infty I(r) dr$.\n\nA special case arises when $V_{0,p} = V_{0,d}$, as in Test Case 4. In this scenario, $U_p(r) - U_d(r) = 0$ for all $r$, making the integrand identically zero. Thus, $\\Delta T = 0$ without the need for numerical integration.\n\nThe integral is evaluated numerically. The integrand is a product of smooth, well-behaved functions that decay exponentially for large $r$ (due to both the Woods-Saxon denominator and the bound-state exponential). This ensures that the integral over the semi-infinite interval $[0, \\infty)$ converges rapidly. A robust numerical quadrature routine, such as `scipy.integrate.quad`, is well-suited for this task, as it can handle semi-infinite integration domains and provides high accuracy. The algorithm will define the integrand as a Python function and pass it to `scipy.integrate.quad` to compute the definite integral from $r=0$ to $r=\\infty$. The final result is the value of this integral multiplied by the factor $4\\pi$. The units of the result are $\\mathrm{MeV\\cdot fm^{3/2}}$, consistent with the physical dimensions of the quantities involved.",
            "answer": "```python\nimport numpy as np\nfrom scipy import integrate\n\ndef solve():\n    \"\"\"\n    Computes the remnant term of the DWBA transition amplitude for several test cases.\n    \"\"\"\n    # Define physical constants. All energies are in MeV, lengths in fm.\n    hbar_c = 197.3269804  # MeV * fm\n    m_p = 938.2720813    # MeV/c^2 (numerically MeV)\n    m_d = 1875.61294257  # MeV/c^2 (numerically MeV)\n\n    # Test cases: (A, r0, a, a_b, V0p, V0d, Ed, Ep)\n    test_cases = [\n        (40, 1.25, 0.65, 4.0, 52.0, 90.0, 15.0, 8.0),\n        (40, 1.25, 0.65, 4.0, 52.0, 90.0, 5.0, 5.0),\n        (40, 1.25, 0.65, 4.0, 52.0, 90.0, 60.0, 20.0),\n        (40, 1.25, 0.65, 4.0, 90.0, 90.0, 15.0, 8.0),\n    ]\n\n    results = []\n\n    for case in test_cases:\n        A, r0, a, ab, V0p, V0d, Ed, Ep = case\n\n        # Handle the trivial case where the potential difference is zero.\n        if V0p == V0d:\n            results.append(0.0)\n            continue\n\n        # Step 1: Calculate kinematic quantities\n        R = r0 * (A ** (1.0 / 3.0))\n        k_i = np.sqrt(2 * m_d * Ed) / hbar_c\n        k_f = np.sqrt(2 * m_p * Ep) / hbar_c\n        q = np.abs(k_i - k_f)\n        \n        # Step 2: Define component functions for the integrand\n        \n        def U_diff(r):\n            # U_p(r) - U_d(r)\n            return (V0d - V0p) / (1.0 + np.exp((r - R) / a))\n\n        def phi_b(r):\n            # Normalized s-wave exponential bound-state wavefunction\n            norm = 1.0 / (np.sqrt(np.pi) * (ab ** 1.5))\n            return norm * np.exp(-r / ab)\n\n        def j0(x):\n            # Spherical Bessel function of order 0, j0(x) = sin(x)/x\n            if x == 0:\n                return 1.0\n            return np.sin(x) / x\n\n        # Step 3: Define the full integrand for numerical quadrature\n        # Integrand of Delta_T = 4*pi * integral[ I(r) dr ]\n        # I(r) = r^2 * j0(q*r) * (Up(r) - Ud(r)) * phi_b(r)\n        def integrand(r):\n            if r  0:\n                return 0.0\n            \n            # For r=0, the j0 term is 1, but the r^2 term makes the whole thing 0.\n            if r == 0:\n                return 0.0\n\n            return r**2 * j0(q * r) * U_diff(r) * phi_b(r)\n\n        # Step 4: Perform numerical integration from 0 to infinity\n        integral_val, _ = integrate.quad(integrand, 0, np.inf)\n\n        delta_T = 4 * np.pi * integral_val\n        \n        results.append(round(delta_T, 6))\n\n    # Format output as specified\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        },
        {
            "introduction": "The DWBA theory can be formulated in two ways, the \"prior\" and \"post\" forms, which are algebraically equivalent under idealized assumptions of local and energy-independent potentials. This advanced computational exercise explores how this crucial equivalence is violated when physically realistic, complex optical potentials—specifically those with non-locality or explicit energy dependence—are introduced . By constructing numerical examples where prior-post equality fails, you will develop a deeper appreciation for the formal consistency of reaction theory and the subtle but important implications of the models used in state-of-the-art computations.",
            "id": "3547975",
            "problem": "Consider the Distorted Wave Born Approximation (DWBA), defined here as the first-order transition amplitude between an entrance channel and an exit channel constructed from distorted waves that solve effective single-particle Schrödinger equations with optical potentials. Let the initial distorted wave be $\\chi_i(\\mathbf{r})$ and the final distorted wave be $\\chi_f(\\mathbf{r})$. In general, DWBA admits two algebraically equivalent formulations called the prior and post forms. In the presence of local and energy-independent optical potentials, these two forms are equal under standard partitioning consistency. However, when the optical potentials are nonlocal or explicitly energy dependent, this equality can be violated unless additional consistency conditions or correction terms are included.\n\nWe consider a reduced, spherically symmetric model in one coordinate $R \\in [0,\\infty)$, working in dimensionless units where $\\hbar^2/2\\mu = 1$, so that all quantities are dimensionless. Distorted waves $\\chi_i(R)$ and $\\chi_f(R)$ are taken as square-integrable functions on $[0,\\infty)$ normalized to unity. Optical potentials may be either local, $U(R,E)$ (possibly energy dependent), or nonlocal, $U(R,R')$.\n\nDefine the prior–post difference of the DWBA transition amplitude as\n$$\n\\Delta T \\equiv T_{\\text{prior}} - T_{\\text{post}},\n$$\nwhere, in this reduced model with a partitioning identity for local, energy-independent potentials, we write the prior and post operators as combinations of optical potentials for the four partitions denoted $U_{aA}$, $U_{bB}$, $U_{xA}$, $U_{xB}$. The transfer form factor is suppressed to focus only on the prior–post operator difference. For local potentials, define\n$$\n\\Delta T_{\\text{local}}(E_i,E_f) = \\int_0^\\infty dR\\, \\chi_f(R)\\,\\Big[U_{xA}(R,E_i) - U_{xB}(R,E_f) - U_{bB}(R,E_f) + U_{aA}(R,E_i)\\Big]\\,\\chi_i(R).\n$$\nFor nonlocal potentials, define\n$$\n\\Delta T_{\\text{nonlocal}} = \\int_0^\\infty dR \\int_0^\\infty dR'\\, \\chi_f(R)\\,\\Big[U_{xA}(R,R') - U_{xB}(R,R') - U_{bB}(R,R') + U_{aA}(R,R')\\Big]\\,\\chi_i(R').\n$$\n\nThe conditions for prior–post equality in this reduced model are:\n- For local and energy-independent potentials, the operator identity $U_{xA}(R) - U_{xB}(R) = U_{bB}(R) - U_{aA}(R)$ holds pointwise in $R$, implying $\\Delta T_{\\text{local}}=0$ for any $\\chi_i$ and $\\chi_f$.\n- For nonlocal potentials, the operator identity $U_{xA}(R,R') - U_{xB}(R,R') = U_{bB}(R,R') - U_{aA}(R,R')$ must hold as a kernel equality to ensure $\\Delta T_{\\text{nonlocal}}=0$ for any $\\chi_i$ and $\\chi_f$.\n- With explicit energy dependence $U(R,E)$, equality for general $(E_i,E_f)$ requires that the energy dependence be arranged so that $U_{xA}(R,E_i) - U_{xB}(R,E_f) = U_{bB}(R,E_f) - U_{aA}(R,E_i)$ pointwise in $R$. If this is not satisfied, the prior–post equality is generally violated.\n\nYou are to implement a program that computes $\\Delta T$ for a set of test cases using numerically normalized Gaussian distorted waves on a finite interval $R \\in [0,R_{\\max}]$ with uniform discretization. Use\n$$\n\\chi_i(R) = \\mathcal{N}_i \\exp\\big(-\\gamma_i R^2\\big), \\quad \\chi_f(R) = \\mathcal{N}_f \\exp\\big(-\\gamma_f R^2\\big),\n$$\nwhere $\\mathcal{N}_i$ and $\\mathcal{N}_f$ are normalization constants determined by $\\int_0^{R_{\\max}} dR\\, \\chi_i^2(R) = 1$ and $\\int_0^{R_{\\max}} dR\\, \\chi_f^2(R) = 1$. Set $R_{\\max} = 10$, $\\gamma_i = 0.4$, and $\\gamma_f = 0.7$.\n\nFor local potentials, use the parametric form\n$$\nU_{\\alpha}(R,E) = V_{0,\\alpha}\\,\\exp\\!\\left(-\\frac{R^2}{a_\\alpha^2}\\right) + \\alpha_\\alpha\\,E\\,\\exp\\!\\left(-\\frac{R^2}{b_\\alpha^2}\\right),\n$$\nwhere $\\alpha \\in \\{aA, bB, xA, xB\\}$ and $\\alpha_\\alpha$ is the energy-dependence coefficient. For nonlocal kernels, use the symmetric Gaussian kernel\n$$\nU_{\\alpha}(R,R') = V_{0,\\alpha}\\,\\exp\\!\\left(-\\frac{R^2 + R'^2}{a_\\alpha^2}\\right)\\exp\\!\\left(-\\frac{(R - R')^2}{b_\\alpha^2}\\right).\n$$\n\nImplement numerical quadrature using a uniform grid with $N = 1000$ points on $[0,R_{\\max}]$ and the rectangle rule for both single and double integrals.\n\nTest Suite:\n- Case 1 (Local, energy-independent, equality satisfied): $E_i=10$, $E_f=10$, with $V_{0,aA}=50$, $a_{aA}=2$, $b_{aA}=1.5$, $\\alpha_{aA}=0$; $V_{0,bB}=35$, $a_{bB}=2$, $b_{bB}=1.5$, $\\alpha_{bB}=0$; $V_{0,xA}=35$, $a_{xA}=2$, $b_{xA}=1.5$, $\\alpha_{xA}=0$; $V_{0,xB}=50$, $a_{xB}=2$, $b_{xB}=1.5$, $\\alpha_{xB}=0$. This satisfies $U_{xA}(R)-U_{xB}(R)=U_{bB}(R)-U_{aA}(R)$ pointwise, so $\\Delta T_{\\text{local}}$ should be numerically near $0$.\n- Case 2 (Local, energy-dependent, equality violated): $E_i=10$, $E_f=12$, with $V_{0,aA}=40$, $a_{aA}=2$, $b_{aA}=1.5$, $\\alpha_{aA}=0.5$; $V_{0,bB}=35$, $a_{bB}=2$, $b_{bB}=1.5$, $\\alpha_{bB}=0.2$; $V_{0,xA}=35$, $a_{xA}=2$, $b_{xA}=1.5$, $\\alpha_{xA}=0.2$; $V_{0,xB}=40$, $a_{xB}=2$, $b_{xB}=1.5$, $\\alpha_{xB}=0.5$. This violates $U_{xA}(R,E_i)-U_{xB}(R,E_f)=U_{bB}(R,E_f)-U_{aA}(R,E_i)$, so $\\Delta T_{\\text{local}} \\neq 0$.\n- Case 3 (Nonlocal, energy-independent, equality violated): $E_i=10$, $E_f=10$, with $V_{0,aA}=40$, $a_{aA}=2$, $b_{aA}=1$; $V_{0,bB}=35$, $a_{bB}=2$, $b_{bB}=1$; $V_{0,xA}=30$, $a_{xA}=2$, $b_{xA}=1$; $V_{0,xB}=25$, $a_{xB}=2$, $b_{xB}=1$. This violates $U_{xA}(R,R')-U_{xB}(R,R')=U_{bB}(R,R')-U_{aA}(R,R')$, so $\\Delta T_{\\text{nonlocal}} \\neq 0$.\n- Case 4 (Nonlocal, energy-independent, equality satisfied): $E_i=10$, $E_f=10$, with $V_{0,aA}=40$, $a_{aA}=2$, $b_{aA}=1$; $V_{0,bB}=30$, $a_{bB}=2$, $b_{bB}=1$; $V_{0,xA}=30$, $a_{xA}=2$, $b_{xA}=1$; $V_{0,xB}=40$, $a_{xB}=2$, $b_{xB}=1$. This satisfies $U_{xA}(R,R')-U_{xB}(R,R')=U_{bB}(R,R')-U_{aA}(R,R')$, so $\\Delta T_{\\text{nonlocal}}$ should be numerically near $0$.\n\nYour program must:\n- Construct and normalize $\\chi_i(R)$ and $\\chi_f(R)$ on the grid.\n- For each test case, compute $\\Delta T$ using the appropriate formula (local or nonlocal).\n- Produce a single line of output containing the four results as a comma-separated list enclosed in square brackets, for example, $\\big[$result1,result2,result3,result4$\\big]$.\n\nAll results are dimensionless real numbers. Express outputs as floating-point numbers. No angles or physical units beyond the stated dimensionless conventions are involved.",
            "solution": "The user has provided a well-posed problem in computational nuclear physics, requiring the calculation of the prior-post difference of the Distorted Wave Born Approximation (DWBA) transition amplitude, $\\Delta T$. The problem is validated as scientifically sound, self-contained, and algorithmically clear. We shall proceed with formulating a step-by-step solution.\n\nThe core task is to compute $\\Delta T$ for two scenarios: one with local, possibly energy-dependent optical potentials, and another with nonlocal, energy-independent optical potentials. The calculations will be performed numerically on a discrete grid.\n\n**1. Discretization and Numerical Quadrature**\n\nWe are tasked with performing calculations on a finite interval $R \\in [0, R_{\\max}]$, where $R_{\\max} = 10$. This interval is discretized into a uniform grid of $N=1000$ points. Let the grid points be $R_j$ for $j=0, 1, \\dots, N-1$. A natural choice for these points is an evenly spaced sequence generated by `numpy.linspace`.\n$$\nR_j = j \\cdot \\Delta R, \\quad \\text{for } j = 0, 1, \\dots, N-1\n$$\nwhere the grid spacing is $\\Delta R = R_{\\max} / (N-1)$. The problem specifies the rectangle rule for numerical integration. A single integral $\\int_0^{R_{\\max}} f(R) dR$ is thus approximated by the sum:\n$$\n\\int_0^{R_{\\max}} f(R) dR \\approx \\sum_{j=0}^{N-1} f(R_j) \\Delta R\n$$\nSimilarly, a double integral $\\int_0^{R_{\\max}} dR \\int_0^{R_{\\max}} dR' G(R,R')$ is approximated as:\n$$\n\\int_0^{R_{\\max}} dR \\int_0^{R_{\\max}} dR' G(R,R') \\approx \\sum_{j=0}^{N-1} \\sum_{k=0}^{N-1} G(R_j, R_k) (\\Delta R)^2\n$$\n\n**2. Wave Function Normalization**\n\nThe initial and final distorted waves, $\\chi_i(R)$ and $\\chi_f(R)$, are given by Gaussian functions:\n$$\n\\chi_k(R) = \\mathcal{N}_k \\exp(-\\gamma_k R^2), \\quad k \\in \\{i, f\\}\n$$\nwith parameters $\\gamma_i = 0.4$ and $\\gamma_f = 0.7$. The normalization constants $\\mathcal{N}_i$ and $\\mathcal{N}_f$ are determined by the condition that the wave functions are normalized to unity on the numerical grid:\n$$\n\\int_0^{R_{\\max}} |\\chi_k(R)|^2 dR = 1\n$$\nSubstituting the functional form and the numerical quadrature rule, we have:\n$$\n\\mathcal{N}_k^2 \\int_0^{R_{\\max}} \\exp(-2\\gamma_k R^2) dR \\approx \\mathcal{N}_k^2 \\left( \\sum_{j=0}^{N-1} \\exp(-2\\gamma_k R_j^2) \\Delta R \\right) = 1\n$$\nFrom this, the normalization constant $\\mathcal{N}_k$ is calculated as:\n$$\n\\mathcal{N}_k = \\left( \\Delta R \\sum_{j=0}^{N-1} \\exp(-2\\gamma_k R_j^2) \\right)^{-1/2}\n$$\nWe will compute these constants and thereby obtain the discretized wave functions $\\chi_i(R_j)$ and $\\chi_f(R_j)$.\n\n**3. Calculation of $\\Delta T$ for Local Potentials**\n\nFor local potentials, the prior-post difference is given by the integral:\n$$\n\\Delta T_{\\text{local}}(E_i,E_f) = \\int_0^\\infty dR\\, \\chi_f(R)\\,\\Big[U_{xA}(R,E_i) - U_{xB}(R,E_f) - U_{bB}(R,E_f) + U_{aA}(R,E_i)\\Big]\\,\\chi_i(R)\n$$\nThe local potentials $U_\\alpha(R, E)$ have the form:\n$$\nU_{\\alpha}(R,E) = V_{0,\\alpha}\\,\\exp\\!\\left(-\\frac{R^2}{a_\\alpha^2}\\right) + \\alpha_\\alpha\\,E\\,\\exp\\!\\left(-\\frac{R^2}{b_\\alpha^2}\\right)\n$$\nLet us define the operator term in the integrand as $\\Delta U_{\\text{local}}(R)$:\n$$\n\\Delta U_{\\text{local}}(R) = U_{xA}(R,E_i) - U_{xB}(R,E_f) - U_{bB}(R,E_f) + U_{aA}(R,E_i)\n$$\nNumerically, we first evaluate the functions $\\chi_i(R_j)$, $\\chi_f(R_j)$, and $\\Delta U_{\\text{local}}(R_j)$ at each grid point $R_j$. Then, we compute the integral using our quadrature rule:\n$$\n\\Delta T_{\\text{local}} \\approx \\sum_{j=0}^{N-1} \\chi_f(R_j) \\Delta U_{\\text{local}}(R_j) \\chi_i(R_j) \\Delta R\n$$\n\n**4. Calculation of $\\Delta T$ for Nonlocal Potentials**\n\nFor nonlocal potentials, the prior-post difference involves a double integral:\n$$\n\\Delta T_{\\text{nonlocal}} = \\int_0^\\infty dR \\int_0^\\infty dR'\\, \\chi_f(R)\\,\\Big[U_{xA}(R,R') - U_{xB}(R,R') - U_{bB}(R,R') + U_{aA}(R,R')\\Big]\\,\\chi_i(R')\n$$\nThe nonlocal potentials $U_\\alpha(R, R')$ have the symmetric Gaussian form:\n$$\nU_{\\alpha}(R,R') = V_{0,\\alpha}\\,\\exp\\!\\left(-\\frac{R^2 + R'^2}{a_\\alpha^2}\\right)\\exp\\!\\left(-\\frac{(R - R')^2}{b_\\alpha^2}\\right)\n$$\nLet us define the kernel of the operator as $\\Delta U_{\\text{nonlocal}}(R, R')$:\n$$\n\\Delta U_{\\text{nonlocal}}(R,R') = U_{xA}(R,R') - U_{xB}(R,R') - U_{bB}(R,R') + U_{aA}(R,R')\n$$\nIn the discretized space, the wave functions become vectors $\\boldsymbol{\\chi}_i$ and $\\boldsymbol{\\chi}_f$ of length $N$, and the kernel becomes an $N \\times N$ matrix $\\mathbf{\\Delta U}_{\\text{nonlocal}}$ with entries $(\\mathbf{\\Delta U}_{\\text{nonlocal}})_{jk} = \\Delta U_{\\text{nonlocal}}(R_j, R_k)$. The double integral becomes a matrix operation:\n$$\n\\Delta T_{\\text{nonlocal}} \\approx \\sum_{j=0}^{N-1} \\sum_{k=0}^{N-1} \\chi_f(R_j) \\Delta U_{\\text{nonlocal}}(R_j, R_k) \\chi_i(R_k) (\\Delta R)^2\n$$\nThis is equivalent to the matrix product:\n$$\n\\Delta T_{\\text{nonlocal}} \\approx \\boldsymbol{\\chi}_f^T \\, \\mathbf{\\Delta U}_{\\text{nonlocal}} \\, \\boldsymbol{\\chi}_i \\, (\\Delta R)^2\n$$\nwhere $\\boldsymbol{\\chi}_f^T$ is the transpose of the column vector $\\boldsymbol{\\chi}_f$. The implementation will involve constructing the four $N \\times N$ potential matrices, combining them to form $\\mathbf{\\Delta U}_{\\text{nonlocal}}$, and finally performing the matrix-vector multiplications.\n\n**5. Implementation for Test Cases**\n\nThe program will be structured to handle the four specified test cases. It will first set up the common elements (grid, wave functions) and then iterate through the cases. Based on whether a case is 'local' or 'nonlocal', the corresponding calculation path described above will be followed. The parameters for each potential ($V_{0,\\alpha}, a_\\alpha, b_\\alpha, \\alpha_\\alpha$) and energies ($E_i, E_f$) will be taken from the problem description for each case. The final results will be collected and formatted as specified.\n\nFor the cases where prior-post equality holds (Case 1 and Case 4), the operator term $\\Delta U$ should be analytically zero. The numerical calculation should yield a result very close to zero, with any deviation attributable to floating-point precision limitations. For cases where equality is violated (Case 2 and Case 3), a non-zero result is expected.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the prior-post difference of the DWBA transition amplitude\n    for four test cases, involving local and nonlocal potentials.\n    \"\"\"\n    # --- Global Parameters ---\n    R_max = 10.0\n    N = 1000\n    gamma_i = 0.4\n    gamma_f = 0.7\n\n    # --- Grid Setup ---\n    R, dR = np.linspace(0, R_max, N, retstep=True)\n\n    # --- Helper Functions ---\n    def normalize_wave_function(gamma, R_grid, dr):\n        \"\"\"\n        Numerically normalizes a Gaussian wave function on the grid.\n        \"\"\"\n        unnormalized_wf = np.exp(-gamma * R_grid**2)\n        norm_integral = np.sum(unnormalized_wf**2) * dr\n        norm_constant = 1.0 / np.sqrt(norm_integral)\n        return norm_constant * unnormalized_wf\n\n    def U_local(R_grid, E, V0, a, b_param, alpha):\n        \"\"\"\n        Computes a local, energy-dependent potential on the grid.\n        \"\"\"\n        term1 = V0 * np.exp(-R_grid**2 / a**2)\n        term2 = alpha * E * np.exp(-R_grid**2 / b_param**2)\n        return term1 + term2\n\n    def U_nonlocal(R_grid, V0, a, b_param):\n        \"\"\"\n        Computes a nonlocal potential kernel as a matrix.\n        \"\"\"\n        R_mesh, R_prime_mesh = np.meshgrid(R_grid, R_grid)\n        term1 = np.exp(-(R_mesh**2 + R_prime_mesh**2) / a**2)\n        term2 = np.exp(-(R_mesh - R_prime_mesh)**2 / b_param**2)\n        return V0 * term1 * term2\n\n    # --- Wave Function Calculation ---\n    chi_i = normalize_wave_function(gamma_i, R, dR)\n    chi_f = normalize_wave_function(gamma_f, R, dR)\n\n    # --- Test Suite Definition ---\n    test_cases = [\n        # Case 1 (Local, energy-independent, equality satisfied)\n        {\n            \"type\": \"local\", \"E_i\": 10.0, \"E_f\": 10.0,\n            \"params\": {\n                \"aA\": {\"V0\": 50, \"a\": 2, \"b\": 1.5, \"alpha\": 0},\n                \"bB\": {\"V0\": 35, \"a\": 2, \"b\": 1.5, \"alpha\": 0},\n                \"xA\": {\"V0\": 35, \"a\": 2, \"b\": 1.5, \"alpha\": 0},\n                \"xB\": {\"V0\": 50, \"a\": 2, \"b\": 1.5, \"alpha\": 0},\n            }\n        },\n        # Case 2 (Local, energy-dependent, equality violated)\n        {\n            \"type\": \"local\", \"E_i\": 10.0, \"E_f\": 12.0,\n            \"params\": {\n                \"aA\": {\"V0\": 40, \"a\": 2, \"b\": 1.5, \"alpha\": 0.5},\n                \"bB\": {\"V0\": 35, \"a\": 2, \"b\": 1.5, \"alpha\": 0.2},\n                \"xA\": {\"V0\": 35, \"a\": 2, \"b\": 1.5, \"alpha\": 0.2},\n                \"xB\": {\"V0\": 40, \"a\": 2, \"b\": 1.5, \"alpha\": 0.5},\n            }\n        },\n        # Case 3 (Nonlocal, energy-independent, equality violated)\n        {\n            \"type\": \"nonlocal\",\n            \"params\": {\n                \"aA\": {\"V0\": 40, \"a\": 2, \"b\": 1},\n                \"bB\": {\"V0\": 35, \"a\": 2, \"b\": 1},\n                \"xA\": {\"V0\": 30, \"a\": 2, \"b\": 1},\n                \"xB\": {\"V0\": 25, \"a\": 2, \"b\": 1},\n            }\n        },\n        # Case 4 (Nonlocal, energy-independent, equality satisfied)\n        {\n            \"type\": \"nonlocal\",\n            \"params\": {\n                \"aA\": {\"V0\": 40, \"a\": 2, \"b\": 1},\n                \"bB\": {\"V0\": 30, \"a\": 2, \"b\": 1},\n                \"xA\": {\"V0\": 30, \"a\": 2, \"b\": 1},\n                \"xB\": {\"V0\": 40, \"a\": 2, \"b\": 1},\n            }\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        if case[\"type\"] == \"local\":\n            E_i, E_f = case[\"E_i\"], case[\"E_f\"]\n            p = case[\"params\"]\n            \n            U_aA = U_local(R, E_i, p[\"aA\"][\"V0\"], p[\"aA\"][\"a\"], p[\"aA\"][\"b\"], p[\"aA\"][\"alpha\"])\n            U_bB = U_local(R, E_f, p[\"bB\"][\"V0\"], p[\"bB\"][\"a\"], p[\"bB\"][\"b\"], p[\"bB\"][\"alpha\"])\n            U_xA = U_local(R, E_i, p[\"xA\"][\"V0\"], p[\"xA\"][\"a\"], p[\"xA\"][\"b\"], p[\"xA\"][\"alpha\"])\n            U_xB = U_local(R, E_f, p[\"xB\"][\"V0\"], p[\"xB\"][\"a\"], p[\"xB\"][\"b\"], p[\"xB\"][\"alpha\"])\n            \n            delta_U_local = U_xA - U_xB - U_bB + U_aA\n            integrand = chi_f * delta_U_local * chi_i\n            delta_T = np.sum(integrand) * dR\n            results.append(delta_T)\n\n        elif case[\"type\"] == \"nonlocal\":\n            p = case[\"params\"]\n\n            U_aA_mat = U_nonlocal(R, p[\"aA\"][\"V0\"], p[\"aA\"][\"a\"], p[\"aA\"][\"b\"])\n            U_bB_mat = U_nonlocal(R, p[\"bB\"][\"V0\"], p[\"bB\"][\"a\"], p[\"bB\"][\"b\"])\n            U_xA_mat = U_nonlocal(R, p[\"xA\"][\"V0\"], p[\"xA\"][\"a\"], p[\"xA\"][\"b\"])\n            U_xB_mat = U_nonlocal(R, p[\"xB\"][\"V0\"], p[\"xB\"][\"a\"], p[\"xB\"][\"b\"])\n\n            delta_U_nonlocal = U_xA_mat - U_xB_mat - U_bB_mat + U_aA_mat\n            \n            # Using matrix multiplication for the double summation\n            # result = chi_f^T @ (delta_U @ chi_i) * dR^2\n            delta_T = np.dot(chi_f, np.dot(delta_U_nonlocal, chi_i)) * dR**2\n            results.append(delta_T)\n\n    # --- Final Output ---\n    # Format results without scientific notation for small numbers near zero\n    formatted_results = [f\"{r:.15f}\".rstrip('0').rstrip('.') if abs(r)  1e-12 else \"0.0\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}