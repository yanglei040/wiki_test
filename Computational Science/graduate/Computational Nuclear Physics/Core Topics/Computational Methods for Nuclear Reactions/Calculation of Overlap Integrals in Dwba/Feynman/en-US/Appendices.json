{
    "hands_on_practices": [
        {
            "introduction": "The zero-range approximation has long been a cornerstone of nuclear reaction theory for its ability to simplify complex calculations. This hands-on theoretical exercise guides you through a derivation that connects a more realistic finite-range interaction to its zero-range counterpart, revealing the origin of the finite-range correction factor . By applying the local momentum approximation, you will develop a deeper intuition for how momentum transfer governs finite-range effects and see how the effective range of an interaction is formally defined.",
            "id": "3547926",
            "problem": "In the post form of the Distorted Wave Born Approximation (DWBA) for a single-nucleon transfer, the finite-range transition amplitude can be written schematically as an overlap of the proton–neutron relative-coordinate kernel with the proton–neutron interaction. Let the proton–neutron interaction be modeled by a finite-range Gaussian,\n$$\nV_{pn}(r)=V_{0}\\,\\exp\\!\\big(-r^{2}/\\beta^{2}\\big),\n$$\nwith range parameter $\\beta>0$ and strength $V_{0}$. Denote by $\\mathbf{s}$ the proton–neutron relative coordinate and by $R(\\mathbf{s})$ the reaction kernel that multiplies $V_{pn}(\\mathbf{s})$ in the DWBA integrand (this kernel contains the product of the distorted waves and the relevant bound-state overlaps). The zero-range limit corresponds to $R(\\mathbf{s})\\to R(\\mathbf{0})$ in the neighborhood of $\\mathbf{s}=\\mathbf{0}$.\n\nStarting from the finite-range amplitude written as the overlap integral over $\\mathbf{s}$, and using only the assumptions that:\n- $R(\\mathbf{s})$ is smooth in a neighborhood of $\\mathbf{s}=\\mathbf{0}$ and varies on a length scale large compared to $\\beta$,\n- the dominant variation of $R(\\mathbf{s})$ over the support of $V_{pn}(\\mathbf{s})$ is through a complex phase whose local gradient at $\\mathbf{s}=\\mathbf{0}$ defines a real “local momentum mismatch” vector $\\mathbf{K}$,\n\nderive a factorized form of the finite-range amplitude in terms of the zero-range amplitude multiplied by a finite-range correction factor $F_{\\mathrm{FR}}(K)$ that depends only on $K=|\\mathbf{K}|$ and the interaction range $\\beta$. Then, identify the effective range parameter that enters the overlap integral through the second moment of $V_{pn}$, defined by\n$$\nr_{\\mathrm{eff}}^{2}\\equiv \\frac{\\displaystyle\\int_{\\mathbb{R}^{3}} d^{3}s\\, s^{2}\\,V_{pn}(s)}{\\displaystyle\\int_{\\mathbb{R}^{3}} d^{3}s\\, V_{pn}(s)}.\n$$\n\nYour final answer must present:\n1. The closed-form analytic expression for $F_{\\mathrm{FR}}(K)$.\n2. The closed-form analytic expression for $r_{\\mathrm{eff}}^{2}$.\n\nNo numerical evaluation is required, and no rounding is needed. Express the two results as symbolic expressions. If you provide both results, write them as a single row using the LaTeX $pmatrix$ environment as specified in the answer format.",
            "solution": "The problem requires the derivation of two quantities related to the finite-range Distorted Wave Born Approximation (DWBA) transition amplitude for a single-nucleon transfer reaction. The first is a finite-range correction factor, $F_{\\mathrm{FR}}(K)$, and the second is an effective range-squared parameter, $r_{\\mathrm{eff}}^{2}$, for the given proton-neutron interaction.\n\nThe problem is validated as scientifically grounded, well-posed, and self-contained. It is a standard derivation in nuclear reaction theory.\n\nLet us begin by defining the finite-range transition amplitude, $T_{\\mathrm{FR}}$. Schematically, it is given by the overlap integral of the reaction kernel $R(\\mathbf{s})$ with the proton-neutron interaction $V_{pn}(s)$ over the relative coordinate $\\mathbf{s}$:\n$$\nT_{\\mathrm{FR}} = \\int_{\\mathbb{R}^{3}} d^{3}s \\, R(\\mathbf{s}) V_{pn}(s)\n$$\nwhere $s = |\\mathbf{s}|$ and the interaction is given by the Gaussian form:\n$$\nV_{pn}(s) = V_{0} \\exp\\left(-\\frac{s^{2}}{\\beta^{2}}\\right)\n$$\n\nThe first task is to derive the finite-range correction factor $F_{\\mathrm{FR}}(K)$. This factor relates the finite-range amplitude $T_{\\mathrm{FR}}$ to the zero-range amplitude $T_{\\mathrm{ZR}}$. The zero-range approximation corresponds to assuming that the kernel $R(\\mathbf{s})$ is constant over the short range of the interaction, i.e., $R(\\mathbf{s}) \\approx R(\\mathbf{0})$. Thus, the zero-range amplitude is:\n$$\nT_{\\mathrm{ZR}} = \\int_{\\mathbb{R}^{3}} d^{3}s \\, R(\\mathbf{0}) V_{pn}(s) = R(\\mathbf{0}) \\int_{\\mathbb{R}^{3}} d^{3}s \\, V_{pn}(s)\n$$\n\nThe problem provides a more refined approximation for $R(\\mathbf{s})$ to be used in the calculation of $T_{\\mathrm{FR}}$. The assumptions are that $R(\\mathbf{s})$ is smooth and that its dominant variation near $\\mathbf{s}=\\mathbf{0}$ is a complex phase. This can be expressed mathematically by approximating $R(\\mathbf{s})$ using the first-order term in the Taylor expansion of its phase. Let $R(\\mathbf{s}) = |R(\\mathbf{s})|\\exp(i\\phi(\\mathbf{s}))$. The smoothness of $|R(\\mathbf{s})|$ implies $|R(\\mathbf{s})| \\approx |R(\\mathbf{0})|$ for small $s$. The phase is approximated as $\\phi(\\mathbf{s}) \\approx \\phi(\\mathbf{0}) + \\mathbf{s} \\cdot \\left(\\nabla\\phi\\right)|_{\\mathbf{s}=\\mathbf{0}}$. The problem defines the local momentum mismatch vector $\\mathbf{K}$ as this gradient, $\\mathbf{K} = \\left(\\nabla\\phi\\right)|_{\\mathbf{s}=\\mathbf{0}}$. Therefore, we have the local momentum approximation:\n$$\nR(\\mathbf{s}) \\approx R(\\mathbf{0}) \\exp(i\\mathbf{K} \\cdot \\mathbf{s})\n$$\nwhere any constant phase factor $\\exp(i\\phi(\\mathbf{0}))$ has been absorbed into the complex prefactor $R(\\mathbf{0})$.\n\nSubstituting this approximation into the expression for $T_{\\mathrm{FR}}$:\n$$\nT_{\\mathrm{FR}} \\approx \\int_{\\mathbb{R}^{3}} d^{3}s \\, \\left[ R(\\mathbf{0}) \\exp(i\\mathbf{K} \\cdot \\mathbf{s}) \\right] \\left[ V_{0} \\exp\\left(-\\frac{s^{2}}{\\beta^{2}}\\right) \\right]\n$$\n$$\nT_{\\mathrm{FR}} \\approx R(\\mathbf{0}) V_{0} \\int_{\\mathbb{R}^{3}} d^{3}s \\, \\exp\\left(i\\mathbf{K} \\cdot \\mathbf{s} - \\frac{s^{2}}{\\beta^{2}}\\right)\n$$\nThe finite-range correction factor $F_{\\mathrm{FR}}(K)$ is defined by the relation $T_{\\mathrm{FR}} = T_{\\mathrm{ZR}} F_{\\mathrm{FR}}(K)$. Therefore:\n$$\nF_{\\mathrm{FR}}(K) = \\frac{T_{\\mathrm{FR}}}{T_{\\mathrm{ZR}}} = \\frac{R(\\mathbf{0}) V_{0} \\int d^{3}s \\, \\exp\\left(i\\mathbf{K} \\cdot \\mathbf{s} - s^{2}/\\beta^{2}\\right)}{R(\\mathbf{0}) V_{0} \\int d^{3}s \\, \\exp\\left(-s^{2}/\\beta^{2}\\right)} = \\frac{\\int d^{3}s \\, \\exp\\left(i\\mathbf{K} \\cdot \\mathbf{s} - s^{2}/\\beta^{2}\\right)}{\\int d^{3}s \\, \\exp\\left(-s^{2}/\\beta^{2}\\right)}\n$$\nThe denominator is a standard 3D Gaussian integral, which we denote as $I_{denom}$.\n$$\nI_{denom} = \\int d^{3}s \\, \\exp\\left(-\\frac{s^{2}}{\\beta^{2}}\\right) = (\\pi \\beta^{2})^{3/2} = \\pi^{3/2} \\beta^{3}\n$$\nThe numerator, $I_{num}$, is the Fourier transform of a Gaussian function.\n$$\nI_{num} = \\int d^{3}s \\, \\exp\\left(-\\frac{s^{2}}{\\beta^{2}}\\right) \\exp\\left(i\\mathbf{K} \\cdot \\mathbf{s}\\right)\n$$\nTo evaluate this, we complete the square in the exponent:\n$$\n-\\frac{s^{2}}{\\beta^{2}} + i\\mathbf{K} \\cdot \\mathbf{s} = -\\frac{1}{\\beta^{2}}\\left(s^{2} - i\\beta^{2}\\mathbf{K} \\cdot \\mathbf{s}\\right) = -\\frac{1}{\\beta^{2}}\\left[\\left(\\mathbf{s} - \\frac{i\\beta^{2}\\mathbf{K}}{2}\\right)^{2} + \\frac{\\beta^{4}K^{2}}{4}\\right] = -\\frac{1}{\\beta^{2}}\\left(\\mathbf{s} - \\frac{i\\beta^{2}\\mathbf{K}}{2}\\right)^{2} - \\frac{\\beta^{2}K^{2}}{4}\n$$\nwhere $K = |\\mathbf{K}|$. The integral becomes:\n$$\nI_{num} = \\exp\\left(-\\frac{\\beta^{2}K^{2}}{4}\\right) \\int d^{3}s \\, \\exp\\left[-\\frac{1}{\\beta^{2}}\\left(\\mathbf{s} - \\frac{i\\beta^{2}\\mathbf{K}}{2}\\right)^{2}\\right]\n$$\nBy shifting the integration variable $\\mathbf{s}' = \\mathbf{s} - \\frac{i\\beta^{2}\\mathbf{K}}{2}$, which is a shift into the complex plane, the value of the Gaussian integral remains unchanged.\n$$\n\\int d^{3}s \\, \\exp\\left[-\\frac{1}{\\beta^{2}}\\left(\\mathbf{s} - \\frac{i\\beta^{2}\\mathbf{K}}{2}\\right)^{2}\\right] = \\int d^{3}s' \\, \\exp\\left(-\\frac{s'^{2}}{\\beta^{2}}\\right) = I_{denom}\n$$\nTherefore, $I_{num} = I_{denom} \\cdot \\exp\\left(-\\frac{\\beta^{2}K^{2}}{4}\\right)$.\nThe correction factor is the ratio:\n$$\nF_{\\mathrm{FR}}(K) = \\frac{I_{num}}{I_{denom}} = \\exp\\left(-\\frac{\\beta^{2}K^{2}}{4}\\right)\n$$\n\nThe second task is to find the effective range-squared parameter $r_{\\mathrm{eff}}^{2}$, defined as the ratio of the second moment of the potential to its volume integral:\n$$\nr_{\\mathrm{eff}}^{2} \\equiv \\frac{\\displaystyle\\int_{\\mathbb{R}^{3}} d^{3}s\\, s^{2}\\,V_{pn}(s)}{\\displaystyle\\int_{\\mathbb{R}^{3}} d^{3}s\\, V_{pn}(s)}\n$$\nSubstituting $V_{pn}(s) = V_{0}\\exp(-s^{2}/\\beta^{2})$, the constant $V_{0}$ cancels:\n$$\nr_{\\mathrm{eff}}^{2} = \\frac{\\displaystyle\\int d^{3}s\\, s^{2}\\,\\exp(-s^{2}/\\beta^{2})}{\\displaystyle\\int d^{3}s\\, \\exp(-s^{2}/\\beta^{2})}\n$$\nThe denominator is again $I_{denom} = \\pi^{3/2} \\beta^{3}$.\nThe numerator is the integral of $s^{2}\\exp(-s^{2}/\\beta^{2})$. We evaluate this in spherical coordinates, where $d^{3}s = 4\\pi s^{2}ds$ after angular integration.\n$$\nI_{num}' = \\int d^{3}s\\, s^{2}\\,\\exp(-s^{2}/\\beta^{2}) = 4\\pi \\int_{0}^{\\infty} s^{4}\\exp(-s^{2}/\\beta^{2}) ds\n$$\nWe use the standard integral formula $\\int_{0}^{\\infty} x^{2n} \\exp(-ax^{2}) dx = \\frac{(2n-1)!!}{2^{n+1}}\\sqrt{\\frac{\\pi}{a^{2n+1}}}$. With $n=2$ and $a=1/\\beta^{2}$:\n$$\n\\int_{0}^{\\infty} s^{4}\\exp(-s^{2}/\\beta^{2}) ds = \\frac{3!!}{2^{3}}\\sqrt{\\frac{\\pi}{(1/\\beta^{2})^{5}}} = \\frac{3}{8}\\sqrt{\\pi\\beta^{10}} = \\frac{3\\sqrt{\\pi}}{8}\\beta^{5}\n$$\nSo the numerator integral is:\n$$\nI_{num}' = 4\\pi \\left(\\frac{3\\sqrt{\\pi}}{8}\\beta^{5}\\right) = \\frac{3\\pi^{3/2}}{2}\\beta^{5}\n$$\nFinally, we compute the ratio for $r_{\\mathrm{eff}}^{2}$:\n$$\nr_{\\mathrm{eff}}^{2} = \\frac{I_{num}'}{I_{denom}} = \\frac{\\frac{3\\pi^{3/2}}{2}\\beta^{5}}{\\pi^{3/2}\\beta^{3}} = \\frac{3}{2}\\beta^{2}\n$$\nThe two required expressions are $F_{\\mathrm{FR}}(K) = \\exp(-\\frac{\\beta^{2}K^{2}}{4})$ and $r_{\\mathrm{eff}}^{2} = \\frac{3}{2}\\beta^{2}$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\exp\\left(-\\frac{K^{2}\\beta^{2}}{4}\\right) & \\frac{3}{2}\\beta^{2}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "This exercise provides an opportunity to translate the formal DWBA theory into a functioning computational model. You will write a program to calculate the \"remnant term,\" a contribution to the transition amplitude that arises from the difference between the optical potentials in the entrance and exit channels . This practice delivers valuable experience in numerically handling the standard components of nuclear reaction calculations, such as Woods-Saxon potentials and kinematic factors, and assembling them into a convergent numerical integral.",
            "id": "3547961",
            "problem": "Consider nucleon transfer in a deuteron-induced reaction within the Distorted Wave Born Approximation (DWBA), defined by the transition amplitude $T=\\langle \\chi_f^{(-)}|V_{tr}|\\phi_b\\,\\chi_i^{(+)}\\rangle$, where $V_{tr}$ is the transition interaction, $\\chi_i^{(+)}$ and $\\chi_f^{(-)}$ are incoming and outgoing distorted waves, and $\\phi_b$ is the bound-state wavefunction of the transferred nucleon about the residual nucleus. In the standard prior form, one writes $V_{tr}=V_{pn}+U_p-U_d$, where $V_{pn}$ is the proton-neutron interaction, $U_p$ is the proton optical potential in the exit channel, and $U_d$ is the deuteron optical potential in the entrance channel. The remnant term is the contribution to the amplitude from $U_p-U_d$, denoted by $\\Delta T=\\langle \\chi_f^{(-)}|(U_p-U_d)|\\phi_b\\,\\chi_i^{(+)}\\rangle$. Starting from the first Born approximation and the plane-wave limit for distorted waves, treat the target nucleus as infinitely heavy so that the reduced mass is well approximated by the projectile mass. Use central, local, and purely real optical potentials of Woods–Saxon form for the proton and deuteron, $U_x(r)=-\\dfrac{V_{0,x}}{1+\\exp\\left(\\dfrac{r-R}{a}\\right)}$, with $x\\in\\{p,d\\}$, radius $R=r_0\\,A^{1/3}$, diffuseness $a$, and depth $V_{0,x}$. Model the bound-state as an $s$-wave exponential with hydrogenic normalization, $\\phi_b(r)=\\dfrac{1}{\\sqrt{\\pi}\\,a_b^{3/2}}\\,\\exp\\!\\left(-\\dfrac{r}{a_b}\\right)$. In the plane-wave approximation, angle-averaging the product of incoming and outgoing plane waves yields a spherical Bessel function $j_0(qr)=\\dfrac{\\sin(qr)}{qr}$ with momentum transfer $q=\\lvert k_i-k_f\\rvert$. Using nonrelativistic kinematics in the heavy-target limit, the wave numbers are $k_i=\\dfrac{\\sqrt{2\\,m_d\\,E_d}}{\\hbar c}$ and $k_f=\\dfrac{\\sqrt{2\\,m_p\\,E_p}}{\\hbar c}$, where $m_d$ and $m_p$ are the deuteron and proton rest energies in $\\mathrm{MeV}$, $E_d$ and $E_p$ are the laboratory kinetic energies in $\\mathrm{MeV}$, and $\\hbar c$ is expressed in $\\mathrm{MeV\\cdot fm}$. Under these assumptions, the remnant amplitude reduces to the radial integral\n$$\n\\Delta T \\;=\\; 4\\pi\\int_0^\\infty r^2\\,j_0(qr)\\,\\big(U_p(r)-U_d(r)\\big)\\,\\phi_b(r)\\,dr,\n$$\nwhich has units of $\\mathrm{MeV\\cdot fm^{3/2}}$ when $\\phi_b$ is normalized as given.\n\nImplement a program that computes $\\Delta T$ for a specified target mass number $A$, Woods–Saxon parameters $r_0$ and $a$, bound-state length scale $a_b$, and channel energies $E_d$ and $E_p$, with specified optical depths $V_{0,p}$ and $V_{0,d}$. Use numerical quadrature to evaluate the integral on $r\\in[0,R_{\\max}]$ with $R_{\\max}$ large enough that the integrand is negligible beyond it. Use the spherical Bessel function $j_0(qr)=\\dfrac{\\sin(qr)}{qr}$ with the limiting value $j_0(0)=1$. Constants to use are $\\hbar c=197.3269804\\,\\mathrm{MeV\\cdot fm}$, $m_p=938.2720813\\,\\mathrm{MeV}$, and $m_d=1875.61294257\\,\\mathrm{MeV}$.\n\nExpress the computed remnant amplitudes in $\\mathrm{MeV\\cdot fm^{3/2}}$, rounded to six decimal places.\n\nTest suite:\n- Case $1$ (general case): $A=40$, $r_0=1.25\\,\\mathrm{fm}$, $a=0.65\\,\\mathrm{fm}$, $a_b=4.0\\,\\mathrm{fm}$, $V_{0,p}=52.0\\,\\mathrm{MeV}$, $V_{0,d}=90.0\\,\\mathrm{MeV}$, $E_d=15.0\\,\\mathrm{MeV}$, $E_p=8.0\\,\\mathrm{MeV}$.\n- Case $2$ (near-threshold energies): $A=40$, $r_0=1.25\\,\\mathrm{fm}$, $a=0.65\\,\\mathrm{fm}$, $a_b=4.0\\,\\mathrm{fm}$, $V_{0,p}=52.0\\,\\mathrm{MeV}$, $V_{0,d}=90.0\\,\\mathrm{MeV}$, $E_d=5.0\\,\\mathrm{MeV}$, $E_p=5.0\\,\\mathrm{MeV}$.\n- Case $3$ (high entrance energy): $A=40$, $r_0=1.25\\,\\mathrm{fm}$, $a=0.65\\,\\mathrm{fm}$, $a_b=4.0\\,\\mathrm{fm}$, $V_{0,p}=52.0\\,\\mathrm{MeV}$, $V_{0,d}=90.0\\,\\mathrm{MeV}$, $E_d=60.0\\,\\mathrm{MeV}$, $E_p=20.0\\,\\mathrm{MeV}$.\n- Case $4$ (vanishing remnant depth difference): $A=40$, $r_0=1.25\\,\\mathrm{fm}$, $a=0.65\\,\\mathrm{fm}$, $a_b=4.0\\,\\mathrm{fm}$, $V_{0,p}=90.0\\,\\mathrm{MeV}$, $V_{0,d}=90.0\\,\\mathrm{MeV}$, $E_d=15.0\\,\\mathrm{MeV}$, $E_p=8.0\\,\\mathrm{MeV}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $\\left[\\mathrm{result1},\\mathrm{result2},\\mathrm{result3},\\mathrm{result4}\\right]$), with each entry rounded to six decimal places and expressed in $\\mathrm{MeV\\cdot fm^{3/2}}$.",
            "solution": "The problem is valid as it presents a well-posed, scientifically grounded scenario within the field of computational nuclear physics. It is self-contained, with all necessary constants, parameters, and functional forms provided. The approximations, while simplifying, are standard in model calculations and do not violate fundamental principles. The task is to compute the remnant term of the DWBA transition amplitude, $\\Delta T$, under these specified approximations.\n\nThe calculation proceeds in several steps: first, the determination of kinematic quantities; second, the definition of the functions comprising the integrand; and third, the numerical evaluation of the final integral.\n\nThe remnant term amplitude is given by the integral:\n$$\n\\Delta T = 4\\pi\\int_0^\\infty r^2\\,j_0(qr)\\,\\big(U_p(r)-U_d(r)\\big)\\,\\phi_b(r)\\,dr\n$$\n\n1.  **Kinematic Quantities**\n\nThe calculation requires several intermediate kinematic parameters derived from the given inputs.\n\n-   **Nuclear Radius ($R$)**: The Woods-Saxon potentials for the proton ($p$) and deuteron ($d$) depend on the nuclear radius $R$, which is calculated from the target mass number $A$ and the radius parameter $r_0$.\n    $$\n    R = r_0\\,A^{1/3}\n    $$\n-   **Wavenumbers ($k_i, k_f$)**: The initial (deuteron) and final (proton) wavenumbers are determined from their respective laboratory kinetic energies ($E_d$, $E_p$) and rest masses ($m_d$, $m_p$) using nonrelativistic kinematics.\n    $$\n    k_i = \\frac{\\sqrt{2\\,m_d\\,E_d}}{\\hbar c}\n    $$\n    $$\n    k_f = \\frac{\\sqrt{2\\,m_p\\,E_p}}{\\hbar c}\n    $$\n    The provided constants are $\\hbar c=197.3269804\\,\\mathrm{MeV\\cdot fm}$, $m_p=938.2720813\\,\\mathrm{MeV}$, and $m_d=1875.61294257\\,\\mathrm{MeV}$.\n-   **Momentum Transfer ($q$)**: The problem specifies the magnitude of the momentum transfer, under the plane-wave and angle-averaging approximation, as:\n    $$\n    q = |k_i - k_f|\n    $$\n\n2.  **Component Functions of the Integrand**\n\nThe integrand is a product of several functions of the radial coordinate $r$.\n\n-   **Optical Potentials ($U_p(r), U_d(r)$)**: The proton and deuteron optical potentials are given by the Woods-Saxon form. They share the same radius $R$ and diffuseness $a$, but differ in their potential depths $V_{0,p}$ and $V_{0,d}$.\n    $$\n    U_p(r) = -\\frac{V_{0,p}}{1+\\exp\\left(\\frac{r-R}{a}\\right)}\n    $$\n    $$\n    U_d(r) = -\\frac{V_{0,d}}{1+\\exp\\left(\\frac{r-R}{a}\\right)}\n    $$\n    Therefore, their difference is:\n    $$\n    U_p(r) - U_d(r) = \\frac{V_{0,d} - V_{0,p}}{1+\\exp\\left(\\frac{r-R}{a}\\right)}\n    $$\n-   **Bound-State Wavefunction ($\\phi_b(r)$)**: The transferred nucleon is described by a simple normalized exponential function, characterized by the length scale $a_b$.\n    $$\n    \\phi_b(r) = \\frac{1}{\\sqrt{\\pi}\\,a_b^{3/2}}\\,\\exp\\left(-\\frac{r}{a_b}\\right)\n    $$\n-   **Spherical Bessel Function ($j_0(qr)$)**: This function arises from the angle-averaging of the plane waves. It is defined as:\n    $$\n    j_0(z) = \\frac{\\sin(z)}{z}\n    $$\n    For the argument $z=qr$, we have $j_0(qr) = \\frac{\\sin(qr)}{qr}$. To avoid division by zero at $r=0$, the limiting value $j_0(0)=1$ is used, as specified.\n\n3.  **Assembling the Integrand and Performing the Integration**\n\nCombining all components, the full integrand is:\n$$\nI(r) = r^2 \\left( \\frac{\\sin(qr)}{qr} \\right) \\left( \\frac{V_{0,d} - V_{0,p}}{1+\\exp\\left(\\frac{r-R}{a}\\right)} \\right) \\left( \\frac{1}{\\sqrt{\\pi}\\,a_b^{3/2}}\\,\\exp\\left(-\\frac{r}{a_b}\\right) \\right)\n$$\nThe remnant amplitude is then $\\Delta T = 4\\pi \\int_0^\\infty I(r) dr$.\n\nA special case arises when $V_{0,p} = V_{0,d}$, as in Test Case 4. In this scenario, $U_p(r) - U_d(r) = 0$ for all $r$, making the integrand identically zero. Thus, $\\Delta T = 0$ without the need for numerical integration.\n\nThe integral is evaluated numerically. The integrand is a product of smooth, well-behaved functions that decay exponentially for large $r$ (due to both the Woods-Saxon denominator and the bound-state exponential). This ensures that the integral over the semi-infinite interval $[0, \\infty)$ converges rapidly. A robust numerical quadrature routine, such as `scipy.integrate.quad`, is well-suited for this task, as it can handle semi-infinite integration domains and provides high accuracy. The algorithm will define the integrand as a Python function and pass it to `scipy.integrate.quad` to compute the definite integral from $r=0$ to $r=\\infty$. The final result is the value of this integral multiplied by the factor $4\\pi$. The units of the result are $\\mathrm{MeV\\cdot fm^{3/2}}$, consistent with the physical dimensions of the quantities involved.",
            "answer": "```python\nimport numpy as np\nfrom scipy import integrate\n\ndef solve():\n    \"\"\"\n    Computes the remnant term of the DWBA transition amplitude for several test cases.\n    \"\"\"\n    # Define physical constants. All energies are in MeV, lengths in fm.\n    hbar_c = 197.3269804  # MeV * fm\n    m_p = 938.2720813    # MeV/c^2 (numerically MeV)\n    m_d = 1875.61294257  # MeV/c^2 (numerically MeV)\n\n    # Test cases: (A, r0, a, a_b, V0p, V0d, Ed, Ep)\n    test_cases = [\n        (40, 1.25, 0.65, 4.0, 52.0, 90.0, 15.0, 8.0),\n        (40, 1.25, 0.65, 4.0, 52.0, 90.0, 5.0, 5.0),\n        (40, 1.25, 0.65, 4.0, 52.0, 90.0, 60.0, 20.0),\n        (40, 1.25, 0.65, 4.0, 90.0, 90.0, 15.0, 8.0),\n    ]\n\n    results = []\n\n    for case in test_cases:\n        A, r0, a, ab, V0p, V0d, Ed, Ep = case\n\n        # Handle the trivial case where the potential difference is zero.\n        if V0p == V0d:\n            results.append(0.0)\n            continue\n\n        # Step 1: Calculate kinematic quantities\n        R = r0 * (A ** (1.0 / 3.0))\n        k_i = np.sqrt(2 * m_d * Ed) / hbar_c\n        k_f = np.sqrt(2 * m_p * Ep) / hbar_c\n        q = np.abs(k_i - k_f)\n        \n        # Step 2: Define component functions for the integrand\n        \n        def U_diff(r):\n            # U_p(r) - U_d(r)\n            return (V0d - V0p) / (1.0 + np.exp((r - R) / a))\n\n        def phi_b(r):\n            # Normalized s-wave exponential bound-state wavefunction\n            norm = 1.0 / (np.sqrt(np.pi) * (ab ** 1.5))\n            return norm * np.exp(-r / ab)\n\n        def j0(x):\n            # Spherical Bessel function of order 0, j0(x) = sin(x)/x\n            # Use np.sinc which is defined as sin(pi*x)/(pi*x)\n            # j0(z) = sinc(z/pi)\n            if x == 0:\n                return 1.0\n            return np.sin(x) / x\n\n        # Step 3: Define the full integrand for numerical quadrature\n        # Integrand of Delta_T = 4*pi * integral[ I(r) dr ]\n        # I(r) = r^2 * j0(q*r) * (Up(r) - Ud(r)) * phi_b(r)\n        def integrand(r):\n            if r < 0:\n                return 0.0\n            \n            # For r=0, the j0 term is 1, but the r^2 term makes the whole thing 0.\n            if r == 0:\n                return 0.0\n\n            return r**2 * j0(q * r) * U_diff(r) * phi_b(r)\n\n        # Step 4: Perform numerical integration from 0 to infinity\n        integral_val, _ = integrate.quad(integrand, 0, np.inf)\n\n        delta_T = 4 * np.pi * integral_val\n        \n        results.append(round(delta_T, 6))\n\n    # Format output as specified\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        },
        {
            "introduction": "Beyond simply coding the formulas, a crucial skill in computational physics is anticipating and solving numerical instabilities. This problem confronts a critical challenge in realistic DWBA calculations: the enormous dynamic range of the integrand when dealing with charged particles at high angular momentum, which can defeat naive numerical methods . You are challenged to analyze several advanced computational strategies and select the ones that guarantee a stable and accurate evaluation, thereby engaging with the sophisticated algorithms used in professional nuclear reaction codes.",
            "id": "3547983",
            "problem": "Consider the evaluation of the radial overlap integral arising in the Distorted Wave Born Approximation (DWBA), where the charged-particle distorted wave is represented by a Coulomb function of orbital angular momentum $L$. Let the integral be\n$$\nI_L = \\int_{0}^{R_{\\max}} \\mathrm{d}r\\, r^2\\, F_L(\\eta, k r)\\, u_b(r)\\, v(r),\n$$\nwhere $F_L(\\eta, k r)$ is the regular Coulomb function solving the radial Schrödinger equation with Coulomb potential,\n$$\n\\frac{\\mathrm{d}^2 u}{\\mathrm{d} r^2} + \\left( k^2 - \\frac{2\\eta}{r} - \\frac{L(L+1)}{r^2} \\right) u = 0,\n$$\n$u_b(r)$ is a bound-state radial wave function that satisfies the nuclear mean-field Schrödinger equation and has the asymptotic form $u_b(r) \\sim A\\, e^{-\\kappa r}/r$ for $r \\gg R_N$, and $v(r)$ is a smooth transition form factor localized near the nuclear surface $r \\sim R_N$. Assume a representative case with Sommerfeld parameter $\\eta = 5$, scattering wave number $k = 1\\,\\mathrm{fm}^{-1}$, bound-state decay constant $\\kappa = 0.5\\,\\mathrm{fm}^{-1}$, and integration range $r \\in [0, 50\\,\\mathrm{fm}]$. You must achieve a relative numerical accuracy better than $10^{-8}$ for $I_L$ for angular momenta up to $L=80$.\n\nThe product $F_L(\\eta, k r)\\, u_b(r)$ exhibits a large dynamic range because for fixed $r$ and large $L$, the regular Coulomb function behaves near the origin as $F_L(\\eta, k r) \\propto r^{L+1}$, while $u_b(r)$ decays exponentially for large $r$. For the Coulomb system, two independent solutions $F_L$ and $G_L$ have the Wronskian $W[F_L, G_L] = F_L' G_L - F_L G_L' = 1$. The logarithmic derivative $\\lambda_L(r) \\equiv F_L'(\\eta, k r)/F_L(\\eta, k r)$ obeys the Riccati equation obtained by dividing the Schrödinger equation by $F_L(\\eta, k r)$:\n$$\n\\frac{\\mathrm{d}\\lambda_L}{\\mathrm{d} r} + \\lambda_L^2 + k^2 - \\frac{2\\eta}{r} - \\frac{L(L+1)}{r^2} = 0.\n$$\n\nWhich of the following strategies are appropriate to stabilize and accurately evaluate $I_L$ in the stated regime? Select all that apply.\n\nA. Propagate the logarithmic derivative $\\lambda_L(r)$ by numerically solving the Riccati equation with a stiff-aware integrator, reconstruct a scaled Coulomb function $F_L(\\eta, k r)\\, e^{-\\sigma r}$ from $\\lambda_L(r)$, and simultaneously use a reweighted bound state $\\tilde u_b(r) \\equiv u_b(r)\\, e^{\\sigma r}$ with $\\sigma \\approx \\kappa$ so that the integrand $F_L(\\eta, k r)\\, u_b(r)$ is replaced by $(F_L(\\eta, k r)\\, e^{-\\sigma r})\\, \\tilde u_b(r)$; then perform adaptive quadrature with error control on the reweighted integrand.\n\nB. Compute $F_L(\\eta, k r)$ at each $r$ by naive upward three-term recursion in $L$ starting from $L=0$ in double precision, without any scaling or reweighting, and evaluate $I_L$ directly by standard quadrature.\n\nC. Compute the ratio $R_L(r) \\equiv F_{L+1}(\\eta, k r)/F_L(\\eta, k r)$ via a stable continued-fraction or downward recursion in $L$, reconstruct a scaled $F_L(\\eta, k r)$ up to a normalization set at a reference radius using the Wronskian $W[F_L, G_L] = 1$, and evaluate the integral using a reweighted integrand with an exponential factor $e^{-\\sigma r}$ and compensated summation to control cancellation.\n\nD. Evaluate the outgoing Coulomb function $H_L^{(+)}(\\eta, k r) \\equiv G_L(\\eta, k r) + i\\, F_L(\\eta, k r)$ solely from large-$r$ asymptotic expansions and extend those asymptotics down to $r \\approx 0$; then compute $I_L$ using those asymptotics for all $r$.\n\nE. Replace $F_L(\\eta, k r)$ by the spherical Bessel function $j_L(k r)$ for all $r$ and $L$, thereby eliminating Coulomb-specific growth and using standard recursion for $j_L$ to compute $I_L$.\n\nProvide your reasoning grounded in the differential equation structure and asymptotic behavior of the solutions, and justify the numerical stability or instability of each proposed strategy in the given parameter regime.",
            "solution": "The problem statement poses a well-defined and scientifically sound numerical challenge in computational nuclear physics. It concerns the accurate evaluation of a radial overlap integral that commonly appears in the Distorted Wave Born Approximation (DWBA). The core difficulty lies in the integrand, which is a product of three functions: $r^2$, a regular Coulomb function $F_L(\\eta, k r)$, a bound-state wave function $u_b(r)$, and a form factor $v(r)$. The problem correctly identifies the numerical instability arising from the product $F_L(\\eta, k r) u_b(r)$ over the specified integration range and parameter regime. For large angular momentum $L$ (up to $L=80$), the integration range $r \\in [0, 50\\,\\mathrm{fm}]$ lies entirely within the classically forbidden region, since the classical turning point $r_{tp}$ is given by the positive root of $k^2 - \\frac{2\\eta}{r} - \\frac{L(L+1)}{r^2} = 0$. With $k=1\\,\\mathrm{fm}^{-1}$, $\\eta=5$, and $L=80$, the equation is $1 - \\frac{10}{r} - \\frac{6480}{r^2} = 0$, which yields $r_{tp} \\approx 85.6\\,\\mathrm{fm}$. In this sub-Coulomb region ($r < r_{tp}$), the regular Coulomb function $F_L(\\eta, k r)$ is exponentially increasing with $r$, while the bound-state wave function $u_b(r)$ is exponentially decreasing as $u_b(r) \\sim e^{-\\kappa r}/r$ for large $r$. The product of these two functions results in an integrand with an enormous dynamic range, which presents a severe challenge for standard numerical methods due to the risk of floating-point overflow/underflow and loss of precision. A viable strategy must address this a priori. The problem is valid, and we proceed to analyze each proposed strategy.\n\n### Analysis of Option A\nThis strategy proposes three combined techniques:\n1.  **Propagation of the logarithmic derivative $\\lambda_L(r)$**: The logarithmic derivative, $\\lambda_L(r) = F_L'(\\eta, k r)/F_L(\\eta, k r)$, satisfies a first-order Riccati differential equation. Solving this equation for $\\lambda_L(r)$ is numerically far more stable than solving the second-order Schrödinger equation for $F_L(\\eta, k r)$ itself. This is because $\\lambda_L(r)$ is typically a much smoother function with a smaller dynamic range compared to $F_L(\\eta, k r)$, which grows exponentially in the classically forbidden region. The use of a stiff-aware integrator is appropriate as Riccati equations can exhibit stiffness.\n2.  **Reweighting of the integrand**: This is the crucial step to tame the dynamic range. The identity $F_L(r) u_b(r) = (F_L(r) e^{-\\sigma r}) \\times (u_b(r) e^{\\sigma r})$ is used to split the problematic product into two better-behaved parts. The choice of $\\sigma \\approx \\kappa$ is physically motivated. Since $u_b(r)$ decays approximately as $e^{-\\kappa r}$, the reweighted bound state $\\tilde u_b(r) = u_b(r) e^{\\sigma r}$ becomes a slowly varying function for large $r$. The other part, a scaled Coulomb function $F_L(r) e^{-\\sigma r}$, will have its exponential growth partially tamed by the decaying factor $e^{-\\sigma r}$. The resulting integrand, built from these reweighted parts, will have a much smaller dynamic range.\n3.  **Adaptive quadrature**: Once the integrand has been regularized by reweighting, a standard high-quality adaptive quadrature routine can be applied to compute the integral to the desired high accuracy of $10^{-8}$.\n\nThis comprehensive strategy directly confronts and correctly resolves the principal numerical difficulties of the problem. It is a state-of-the-art approach used in modern nuclear reaction codes.\n**Verdict: Correct**\n\n### Analysis of Option B\nThis strategy suggests a naive computational approach:\n1.  **Upward recursion for $F_L$**: Three-term recurrence relations are common for special functions. However, for both spherical Bessel functions and Coulomb functions, recursion in increasing order of $L$ (upward recursion) is numerically unstable when $L$ is greater than the argument of the function (here, $L \\gtrsim kr$). The problem requires calculations up to $L=80$ over a range where $kr$ goes from $0$ to $50$. For most of the range and for high $L$, we are in the unstable regime ($L > kr$). This method will propagate the minimal solution into the dominant one, yielding completely wrong values for $F_L$.\n2.  **No scaling or reweighting**: This approach completely ignores the fundamental problem of the enormous dynamic range of $F_L(\\eta, kr)$ and the product $F_L(\\eta, kr) u_b(r)$. For $L=80$, $F_L$ near $r=0$ behaves as $r^{81}$, leading to immediate underflow in standard floating-point arithmetic. Near the end of the integration range, its value can be enormous. This guarantees failure.\n3.  **Standard quadrature**: Applying standard quadrature to an integrand with such an extreme dynamic range will fail to produce a meaningful result.\n\nThis strategy is flawed in every aspect and is a textbook example of an unstable numerical method for this problem.\n**Verdict: Incorrect**\n\n### Analysis of Option C\nThis strategy employs an alternative set of robust techniques:\n1.  **Downward recursion for ratios**: The instability of upward recursion in $L$ is overcome by computing the ratio $R_{L-1}(r) \\equiv F_L(r)/F_{L-1}(r)$ using downward recursion (a technique known as Miller's algorithm). Starting from a large $L_{max} \\gg L$ with an arbitrary initial ratio (e.g., $R_{L_{max}-1} = 0$), one iterates the recurrence relation downwards. This process is self-correcting and converges to the correct ratio, stably generating the minimal solution required. This is a standard and stable method for computing special functions in the unstable regime.\n2.  **Reconstruction and normalization**: Once the ratios $R_l(r)$ are known, one can construct $F_L(r)$ via $F_L(r) = F_0(r) \\prod_{l=0}^{L-1} R_l(r)$, where the base function $F_0(r)$ must be computed separately but accurately. The mention of using the Wronskian is a valid concept for normalizing numerical solutions. Scaling the function at a reference radius is also a common and practical approach to manage the magnitude during reconstruction.\n3.  **Reweighting and compensated summation**: Crucially, like strategy A, this method acknowledges the need to reweight the integrand (e.g., with a factor like $e^{-\\sigma r}$) to manage the dynamic range. It also adds the refinement of using compensated summation, an algorithm that reduces numerical error in summing a sequence of floating-point numbers. This attention to detail is appropriate for achieving the high target accuracy of $10^{-8}$.\n\nThis strategy, like A, presents a highly effective and numerically stable plan for solving the problem. It uses a different but equally valid core method (recurrence relations) for computing the Coulomb function compared to strategy A (ODE integration).\n**Verdict: Correct**\n\n### Analysis of Option D\nThis strategy proposes using asymptotic expansions.\nThe outgoing Coulomb function is defined as $H_L^{(+)}(\\eta, kr) = G_L(\\eta, kr) + i F_L(\\eta, kr)$. The large-$r$ asymptotic forms for $F_L$ and $G_L$ are oscillatory (sines and cosines). The fundamental flaw in this strategy is the proposal to \"extend those asymptotics down to $r \\approx 0$\". Asymptotic expansions are, by definition, valid only in a specific limit, in this case for $kr \\rightarrow \\infty$ and $r > r_{tp}$. The entire integration range $r \\in [0, 50\\,\\mathrm{fm}]$ lies in the sub-Coulomb region $r < r_{tp} \\approx 85.6\\,\\mathrm{fm}$, where the character of the wave function is exponentially growing, not oscillatory. Near the origin, $F_L(\\eta, kr)$ behaves as $(kr)^{L+1}$. The asymptotic sine/cosine form is utterly different from this power-law behavior. Using the large-$r$ oscillatory expansion in the small-$r$ exponential/power-law region is a fundamental mathematical error and will produce results that are orders of magnitude incorrect.\n**Verdict: Incorrect**\n\n### Analysis of Option E\nThis strategy proposes to replace the Coulomb function $F_L(\\eta, kr)$ with the spherical Bessel function $j_L(kr)$.\n$F_L(\\eta, kr)$ is the solution to the radial Schrödinger equation with a Coulomb potential term $-2\\eta/r$. The spherical Bessel function $j_L(kr)$ is the solution to the same equation but with $\\eta=0$, i.e., for an uncharged particle. The problem is explicitly defined for a charged particle with a non-zero Sommerfeld parameter $\\eta=5$. The Coulomb potential is a long-range interaction that fundamentally alters the wave function's behavior, especially at large distances and for high $L$. Replacing $F_L$ with $j_L$ is not a numerical strategy for solving the given problem; it is an arbitrary modification of the problem's physics. It amounts to calculating the integral for a neutral particle interaction instead of the specified charged-particle interaction. The results would be physically meaningless for the stated problem.\n**Verdict: Incorrect**",
            "answer": "$$\\boxed{A, C}$$"
        }
    ]
}