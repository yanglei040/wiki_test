{
    "hands_on_practices": [
        {
            "introduction": "In quantum scattering theory, the complex-valued scattering matrix ($S$-matrix) contains all information about the outcome of a collision. This exercise provides a fundamental hands-on calculation connecting the abstract $S$-matrix to physically measurable quantities. By applying the principle of flux conservation (unitarity), you will compute the transmission coefficient $T_l$ and its contribution to the reaction cross section from a given $S$-matrix element, a crucial step in interpreting the results of optical model calculations .",
            "id": "3548631",
            "problem": "In the optical-model description of nucleon–nucleus scattering, the partial-wave scattering matrix (scattering matrix, S-matrix) for angular momentum $l$ at energy $E$ can be written as $S_{l}(E)=\\eta_{l}(E)\\exp\\!\\big(2 i \\delta_{l}(E)\\big)$, where $0 \\le \\eta_{l}(E) \\le 1$ encodes inelasticity and $\\delta_{l}(E)$ is a real phase shift. The transmission coefficient $T_{l}(E)$ represents the probability for reaction (non-elastic processes) in the $l$th partial wave and is constrained by flux conservation. The contribution of a single partial wave $l$ to the reaction cross section $\\Delta \\sigma_{\\text{reac}}$ depends on $T_{l}(E)$ and the wave number $k$.\n\nA numerical computation for a complex optical potential yields $S_{l}(E)=0.7\\,\\exp(2 i \\tau)$ at wave number $k=1.0\\ \\text{fm}^{-1}$ for $l=2$, where $\\tau$ is a real number. Starting from the standard partial-wave unitarity and flux-conservation principles, determine the transmission coefficient $T_{l}(E)$ for this partial wave and the corresponding single-partial-wave contribution $\\Delta \\sigma_{\\text{reac}}$ to the reaction cross section. Express $\\Delta \\sigma_{\\text{reac}}$ in millibarns, using $1\\ \\text{barn}=100\\ \\text{fm}^{2}$ and $1\\ \\text{millibarn}=10^{-3}\\ \\text{barn}$. Round the reaction cross section contribution to four significant figures. Provide your final result as two values: $T_{l}(E)$ and $\\Delta \\sigma_{\\text{reac}}$ in millibarns.",
            "solution": "The problem is validated as scientifically grounded, well-posed, and objective. It presents a standard calculation within the framework of quantum scattering theory and the nuclear optical model. All provided information is consistent and sufficient for a unique solution.\n\nThe problem asks for the calculation of two quantities for a specific partial wave: the transmission coefficient $T_{l}(E)$ and the contribution to the reaction cross section $\\Delta \\sigma_{\\text{reac}}$. We are given the partial-wave scattering matrix element $S_{l}(E)$ for angular momentum $l=2$ at a wave number $k=1.0\\ \\text{fm}^{-1}$.\n\nThe scattering matrix element is given in its general form as $S_{l}(E)=\\eta_{l}(E)\\exp\\!\\big(2 i \\delta_{l}(E)\\big)$, where $\\eta_{l}(E)$ is the inelasticity parameter and $\\delta_{l}(E)$ is the real phase shift. The value provided by a numerical computation is $S_{l=2}(E)=0.7\\,\\exp(2 i \\tau)$, where $\\tau$ is a real number. By comparing the general form with the given value, we can identify the inelasticity parameter for this specific partial wave and energy:\n$$\n\\eta_{l=2}(E) = |S_{l=2}(E)| = |0.7\\,\\exp(2 i \\tau)| = 0.7\n$$\nThe condition $0 \\le \\eta_{l}(E) \\le 1$ is satisfied, as $0 \\le 0.7 \\le 1$. An inelasticity parameter less than $1$ signifies that there is flux loss from the elastic channel, which corresponds to the occurrence of reactions (non-elastic processes).\n\nThe transmission coefficient, $T_{l}(E)$, represents the probability that an incident particle in the partial wave $l$ will undergo a reaction. From the principle of flux conservation (unitarity of the S-matrix), the total probability for an incident particle must be unity. The particle can either scatter elastically or react. The probability of elastic scattering for a given partial wave is given by $|S_{l}(E)|^2$. Therefore, the probability of reaction must be the remaining fraction:\n$$\nT_{l}(E) = 1 - |S_{l}(E)|^2\n$$\nUsing the relationship $|S_{l}(E)| = \\eta_{l}(E)$, this can be written as:\n$$\nT_{l}(E) = 1 - \\eta_{l}(E)^2\n$$\nFor the given partial wave $l=2$, we have $\\eta_{l=2}(E) = 0.7$. Substituting this value into the equation for the transmission coefficient:\n$$\nT_{l=2}(E) = 1 - (0.7)^2 = 1 - 0.49 = 0.51\n$$\nThis is the first required quantity.\n\nThe second required quantity is the contribution of this single partial wave to the total reaction cross section, denoted as $\\Delta \\sigma_{\\text{reac}}$. The standard formula for the partial-wave reaction cross section is:\n$$\n\\Delta \\sigma_{\\text{reac}} = \\sigma_{\\text{reac}, l} = \\frac{\\pi}{k^2} (2l+1) T_{l}(E)\n$$\nWe are given the wave number $k=1.0\\ \\text{fm}^{-1}$, the angular momentum quantum number $l=2$, and we have just calculated the transmission coefficient $T_{l=2}(E) = 0.51$. Substituting these values into the formula:\n$$\n\\Delta \\sigma_{\\text{reac}} = \\frac{\\pi}{(1.0\\ \\text{fm}^{-1})^2} (2(2)+1) (0.51)\n$$\n$$\n\\Delta \\sigma_{\\text{reac}} = \\frac{\\pi}{1.0\\ \\text{fm}^{-2}} (5) (0.51)\n$$\n$$\n\\Delta \\sigma_{\\text{reac}} = 2.55 \\pi\\ \\text{fm}^2\n$$\nNow, we must convert this result into the requested units of millibarns (mb). The conversion factors are given:\n$1\\ \\text{barn} = 100\\ \\text{fm}^2$\n$1\\ \\text{millibarn} = 10^{-3}\\ \\text{barn}$\n\nFrom these, we can derive the direct conversion between $\\text{fm}^2$ and $\\text{mb}$:\n$$\n1\\ \\text{mb} = 10^{-3} \\times (100\\ \\text{fm}^2) = 10^{-1}\\ \\text{fm}^2 = 0.1\\ \\text{fm}^2\n$$\nTherefore, to convert from $\\text{fm}^2$ to $\\text{mb}$, we must multiply by a factor of $10$:\n$$\n1\\ \\text{fm}^2 = 10\\ \\text{mb}\n$$\nApplying this conversion to our result for $\\Delta \\sigma_{\\text{reac}}$:\n$$\n\\Delta \\sigma_{\\text{reac}} = (2.55 \\pi\\ \\text{fm}^2) \\times \\left(\\frac{10\\ \\text{mb}}{1\\ \\text{fm}^2}\\right) = 25.5 \\pi\\ \\text{mb}\n$$\nCalculating the numerical value:\n$$\n\\Delta \\sigma_{\\text{reac}} \\approx 25.5 \\times 3.14159265... \\text{ mb} \\approx 80.110612... \\text{ mb}\n$$\nThe problem requires this value to be rounded to four significant figures. The first four significant figures are $8$, $0$, $1$, and $1$. The fifth digit is $0$, so we do not round up.\n$$\n\\Delta \\sigma_{\\text{reac}} \\approx 80.11\\ \\text{mb}\n$$\nThe two final values are $T_{l=2}(E) = 0.51$ and $\\Delta \\sigma_{\\text{reac}} = 80.11\\ \\text{mb}$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0.51  80.11 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "The low-energy behavior of reaction cross sections is often governed by universal threshold laws, but these laws are modified by long-range interactions. This practice moves from numerical application to analytical derivation, exploring how a long-range polarization potential affects neutron-nucleus scattering at low energies. This exercise will deepen your understanding of quantum reflection and how the asymptotic form of a potential dictates the energy dependence of the transmission coefficient, moving beyond simple barrier models .",
            "id": "3548673",
            "problem": "A neutron of reduced mass $\\mu$ scatters elastically from a heavy nucleus. At sufficiently large separation $r$ beyond a microscopic radius $r_{0}$, the interaction is dominated by a long-range polarization potential $V(r)=-\\alpha/(2 r^{4})$, where $\\alpha0$ is a constant characterizing the effective electric polarizability coupling for the neutron–nucleus system. Consider partial-wave scattering described by the radial Schrödinger equation for the reduced radial wave function $u_{\\ell}(r)$,\n$$\n-\\frac{\\hbar^{2}}{2\\mu}\\frac{d^{2}u_{\\ell}}{dr^{2}}+\\left[\\frac{\\hbar^{2}\\ell(\\ell+1)}{2\\mu r^{2}}-\\frac{\\alpha}{2 r^{4}}\\right]u_{\\ell}(r)=E\\,u_{\\ell}(r),\n$$\nwith collision energy $E0$ and wave number $k=\\sqrt{2\\mu E}/\\hbar$. Assume the short-range region $rr_{0}$ is fully absorbing, so the transmission coefficient $T_{\\ell}(E)$ can be defined as the fraction of incoming probability flux at large $r$ that reaches $r=r_{0}$.\n\nStarting from the above equation and using first-principles reasoning appropriate to long-range potentials, analyze the threshold behavior ($E\\to 0^{+}$) of $T_{\\ell}(E)$ for the polarization tail $V(r)=-\\alpha/(2 r^{4})$ to verify the implications of Wigner threshold laws and quantum reflection. In particular, derive the leading-order analytic expression for the $s$-wave ($\\ell=0$) transmission coefficient $T_{0}(E)$ in the limit $E\\to 0^{+}$, expressed solely in terms of $E$, $\\mu$, $\\hbar$, and $\\alpha$.\n\nYour final answer must be a single closed-form analytic expression for $T_{0}(E)$, dimensionless, with no numerical substitution. If any approximation is invoked, it must be systematically justified from the governing equation. No rounding is required. State any intermediate scalings you use for general $\\ell$ to justify consistency with Wigner threshold behavior, but provide only the explicit leading-order expression for $T_{0}(E)$ as your final answer.",
            "solution": "The problem asks for the leading-order analytic expression for the s-wave ($\\ell=0$) transmission coefficient $T_{0}(E)$ in the low-energy limit ($E\\to 0^{+}$) for a neutron scattering from a nucleus, where the long-range interaction is described by the polarization potential $V(r) = -\\alpha/(2r^4)$.\n\nFirst, we establish the governing equation and the physical context. The radial Schrödinger equation for the s-wave ($\\ell=0$) reduced radial wave function $u_0(r)$ is:\n$$\n-\\frac{\\hbar^{2}}{2\\mu}\\frac{d^{2}u_{0}}{dr^{2}} - \\frac{\\alpha}{2 r^{4}}u_{0}(r)=E u_{0}(r)\n$$\nThis can be rewritten in a standard form:\n$$\n\\frac{d^{2}u_{0}}{dr^{2}} + \\left(\\frac{2\\mu E}{\\hbar^2} + \\frac{\\mu\\alpha}{\\hbar^2 r^4}\\right)u_{0}(r) = 0\n$$\nLet us define the wave number $k = \\sqrt{2\\mu E}/\\hbar$ and a characteristic length scale $\\gamma = \\sqrt{\\mu\\alpha}/\\hbar$. The parameter $\\gamma$ has units of length, and $\\gamma  0$ since $\\mu  0$ and $\\alpha  0$. The equation becomes:\n$$\n\\frac{d^{2}u_{0}}{dr^{2}} + \\left(k^2 + \\frac{\\gamma^2}{r^4}\\right)u_{0}(r) = 0\n$$\nThe problem specifies a fully absorbing boundary condition at a short-range radius $r=r_0$. The transmission coefficient $T_0(E)$ is the fraction of the incoming flux from $r\\to\\infty$ that is absorbed at $r_0$. This can be expressed in terms of the s-wave scattering matrix element $S_0$ as $T_0(E) = 1 - |S_0|^2$. Our task is to determine $S_0$ in the low-energy limit, $k \\to 0$.\n\nThe potential $V(r) \\propto -1/r^4$ is a long-range potential. For such potentials, the standard Wigner threshold laws, derived for short-range potentials, are modified. For s-waves, the Wigner law predicts $T_0 \\propto E^{1/2} \\propto k$. While the power law for $k$ turns out to be correct, the coefficient is determined by the long-range nature of the potential, specifically through a phenomenon known as quantum reflection.\n\nFor $\\ell  0$, the effective potential includes a centrifugal barrier, $V_{\\text{eff}}(r) = \\frac{\\hbar^2\\ell(\\ell+1)}{2\\mu r^2} - \\frac{\\alpha}{2r^4}$. This potential has a barrier maximum. At low energies ($E \\to 0$), transmission is suppressed by tunneling through this barrier, leading to a threshold behavior where $T_\\ell(E)$ vanishes much faster than for $\\ell=0$.\n\nFor s-waves ($\\ell=0$), there is no centrifugal barrier. The potential is purely attractive. Classically, a particle with energy $E0$ would always reach the origin (or $r_0$). Quantum mechanically, however, the potential varies rapidly on the scale of the local de Broglie wavelength in a certain region of $r$, causing reflection. This quantum reflection determines the scattering properties at low energy.\n\nThe reflection coefficient $|R_0|^2 = |S_0|^2$ can be calculated using semiclassical (WKB) methods. The standard WKB approximation fails where the potential varies too rapidly, but a more sophisticated analysis involving complex turning points yields a reliable result. The equation for $u_0(r)$ has four complex turning points in the complex $r$-plane, determined by $k^2 + \\gamma^2/r^4=0$, which gives $r^4 = -\\gamma^2/k^2$. The reflection amplitude is determined by the analytic continuation of the wavefunction into the complex plane.\n\nThe well-established result from such semiclassical analysis for the reflection probability off a $-1/r^4$ potential is:\n$$\n|S_0(k)|^2 = \\exp(-4k\\gamma)\n$$\nThis formula is valid in the low-energy regime ($k\\gamma \\ll 1$). This reasoning is a first-principle approach within the established theory of long-range potentials.\n\nUsing this result, we can find the transmission coefficient $T_0(E)$:\n$$\nT_0(E) = 1 - |S_0(k)|^2 = 1 - \\exp(-4k\\gamma)\n$$\nThe problem asks for the leading-order analytic expression for $T_0(E)$ in the limit $E \\to 0^+$, which corresponds to $k \\to 0$. We can expand the exponential for small values of the argument ($x \\ll 1 \\implies e^{-x} \\approx 1-x$):\n$$\nT_0(E) \\approx 1 - (1 - 4k\\gamma) = 4k\\gamma\n$$\nThis gives the leading-order threshold behavior. Now, we substitute the definitions of $k$ and $\\gamma$ in terms of the given physical parameters $E$, $\\mu$, $\\hbar$, and $\\alpha$.\n$k = \\frac{\\sqrt{2\\mu E}}{\\hbar}$\n$\\gamma = \\frac{\\sqrt{\\mu\\alpha}}{\\hbar}$\nSubstituting these into our expression for $T_0(E)$:\n$$\nT_0(E) = 4 \\left( \\frac{\\sqrt{2\\mu E}}{\\hbar} \\right) \\left( \\frac{\\sqrt{\\mu\\alpha}}{\\hbar} \\right)\n$$\n$$\nT_0(E) = \\frac{4\\sqrt{2\\mu E \\cdot \\mu\\alpha}}{\\hbar^2} = \\frac{4\\sqrt{2\\mu^2 E\\alpha}}{\\hbar^2}\n$$\nSimplifying this expression, we get the final result:\n$$\nT_0(E) = \\frac{4\\mu\\sqrt{2E\\alpha}}{\\hbar^2}\n$$\nThis expression is dimensionless, as required for a transmission coefficient. It shows that for a $-1/r^4$ potential, the s-wave transmission coefficient is proportional to $k$, or $\\sqrt{E}$, consistent with the Wigner threshold law's power dependence, but with a coefficient determined by the specifics of the long-range interaction.",
            "answer": "$$\\boxed{\\frac{4\\mu\\sqrt{2E\\alpha}}{\\hbar^2}}$$"
        },
        {
            "introduction": "Calculating the transmission coefficient for a realistic, continuous, and complex nuclear potential requires a robust numerical solver. This coding practice tasks you with implementing the transfer-matrix method, a powerful but numerically challenging technique. You will confront the exponential growth of evanescent wave components, which can corrupt results, and implement a stabilization scheme using QR decomposition to ensure a reliable solution . This exercise builds an essential skill for tackling practical problems in computational quantum physics.",
            "id": "3548698",
            "problem": "Consider one-dimensional stationary scattering of a proton of mass $m_p$ from a finite slab of nuclear matter modeled by a complex optical potential. The proton is incident from the left ($x  0$) on a region $0 \\le x \\le L$ in which the potential is spatially varying and complex, and then exits into free space ($x  L$). Use the time-independent Schrödinger equation in one dimension,\n$$\n-\\frac{\\hbar^2}{2 m_p} \\frac{d^2 \\psi(x)}{dx^2} + U(x)\\,\\psi(x) = E\\,\\psi(x),\n$$\nwhere $E$ is the laboratory-frame kinetic energy, $U(x)$ is the complex nuclear optical potential, and $\\psi(x)$ is the wavefunction. Adopt natural units where $c = 1$ and use $\\hbar c$ explicitly, with all energies in $\\mathrm{MeV}$ and all lengths in $\\mathrm{fm}$. The slab potential is a repulsive-real and absorptive-imaginary Woods–Saxon form,\n$$\nU(x) = \\frac{V_0}{1 + \\exp\\!\\left(\\frac{x - L/2}{a}\\right)} - i\\,\\frac{W_0}{1 + \\exp\\!\\left(\\frac{x - L/2}{a}\\right)},\n$$\nwith $V_0 > 0$ and $W_0 > 0$. This form emulates an effective repulsive barrier (e.g., Coulombic contribution for a proton) together with absorptive nuclear loss in the interaction region.\n\nApproximate $U(x)$ by piecewise-constant slices: partition the interval $[0,L]$ into $N$ uniform slices, each of thickness $d = L/N$. In each slice $j$ with midpoint $x_j$, take $U_j = U(x_j)$ to be constant. Let the left and right asymptotic regions ($x0$ and $xL$) have $U(x)=0$. Define the complex local wave number\n$$\nk_j = \\sqrt{\\frac{2 m_p \\left(E - U_j\\right)}{\\hbar^2}},\n$$\nand in the asymptotic regions $k_0 = k_R = \\sqrt{\\frac{2 m_p E}{\\hbar^2}}$, using the principal branch of the complex square root for $k_j$.\n\nImplement the transfer-matrix formalism that enforces continuity of $\\psi(x)$ and $d\\psi/dx$ at each slice interface. For a piecewise-constant segment of thickness $d$ and wave number $k$, there is a propagation matrix, and for each interface from wave number $k_{\\mathrm{in}}$ to $k_{\\mathrm{out}}$, there is an interface matching matrix. By multiplying these $2\\times 2$ matrices across all slices and interfaces, obtain the total transfer matrix that maps the incident and reflected amplitudes on the left to the transmitted and incoming-from-the-right amplitudes on the right. From the total transfer matrix, compute the transmission coefficient $T(E)$ defined as the ratio of transmitted to incident flux, expressed as a dimensionless decimal number.\n\nYour program must compute $T(E)$ for three test energies using two algorithms:\n- A naive algorithm that forms the full transfer matrix by direct left-to-right multiplication of the $2\\times 2$ matrices.\n- A stabilized algorithm that uses repeated orthonormalization via the $QR$ decomposition at each multiplication step to prevent numerical overflow due to evanescent growth, followed by a carefully rescaled reconstruction of the full transfer matrix.\n\nDemonstrate numerical instability due to evanescent growth and its mitigation by $QR$ stabilization by computing both the naive and stabilized transmission coefficients for each energy. Use the following fixed physical and numerical parameters:\n- $m_p = 938.2720813~\\mathrm{MeV}$,\n- $\\hbar c = 197.3269804~\\mathrm{MeV\\,fm}$,\n- $L = 20.0~\\mathrm{fm}$,\n- $a = 0.6~\\mathrm{fm}$,\n- $V_0 = 40.0~\\mathrm{MeV}$,\n- $W_0 = 20.0~\\mathrm{MeV}$,\n- $N = 800$ (so $d = L/N$).\n\nUse the following test suite of incident energies, all in $\\mathrm{MeV}$:\n- $E_1 = 5.0$ (strongly sub-barrier with significant absorption),\n- $E_2 = 40.0$ (near the top of the repulsive barrier),\n- $E_3 = 200.0$ (well above the barrier).\n\nFor each energy $E_i$, compute two floats: the naive transmission coefficient and the stabilized transmission coefficient. Your program should produce a single line of output containing the six results as a comma-separated list enclosed in square brackets, in the order\n$$\n[T_{\\mathrm{naive}}(E_1), T_{\\mathrm{stab}}(E_1), T_{\\mathrm{naive}}(E_2), T_{\\mathrm{stab}}(E_2), T_{\\mathrm{naive}}(E_3), T_{\\mathrm{stab}}(E_3)].\n$$\nAll numbers must be dimensionless decimals. Angles in any intermediate exponentials must be treated in radians. Ensure scientific realism in the implementation and use complex arithmetic consistently throughout.",
            "solution": "The user-provided problem is a valid and well-posed exercise in computational quantum mechanics, specifically focusing on one-dimensional scattering through a complex optical potential. It requires the implementation of the transfer-matrix method to solve the time-independent Schrödinger equation and highlights the critical numerical issue of evanescent wave instability, which is addressed via a QR stabilization algorithm. All physical parameters, numerical specifications, and theoretical models are scientifically sound and standard within the field of nuclear physics.\n\nThe solution proceeds by first establishing the theoretical framework of the transfer-matrix method for a piecewise-constant potential. Subsequently, two computational algorithms are developed: a naive, direct multiplication approach and a numerically stabilized approach using QR decomposition.\n\n### Theoretical Framework\n\nThe problem is governed by the one-dimensional time-independent Schrödinger equation:\n$$\n-\\frac{\\hbar^2}{2 m_p} \\frac{d^2 \\psi(x)}{dx^2} + U(x)\\,\\psi(x) = E\\,\\psi(x)\n$$\nThis can be rearranged into the form of a simple harmonic oscillator equation for each region of constant potential:\n$$\n\\frac{d^2 \\psi(x)}{dx^2} + k^2 \\psi(x) = 0\n$$\nwhere $k$ is the complex wave number, defined as:\n$$\nk(x) = \\sqrt{\\frac{2 m_p (E - U(x))}{\\hbar^2}} = \\sqrt{\\frac{2 m_p (E - U(x))}{(\\hbar c)^2}}\n$$\nWe use the constant factor $\\alpha = 2 m_p / (\\hbar c)^2 \\approx 0.0482936~\\mathrm{MeV}^{-1}\\mathrm{fm}^{-2}$ for convenience. The potential $U(x)$ is discretized into $N$ slices of thickness $d=L/N$. In the $j$-th slice ($j \\in \\{1, \\dots, N\\}$), the potential is constant, $U_j = U(x_j)$, where $x_j = (j - 1/2)d$. This results in a constant complex wave number $k_j$ for each slice. In the asymptotic regions $x0$ and $xL$, the potential is $U=0$, and the wave number is $k_0 = \\sqrt{\\alpha E}$, which is real.\n\nFor each slice $j$, the general solution for the wavefunction is a superposition of a forward-propagating wave and a backward-propagating wave:\n$$\n\\psi_j(x) = A_j e^{i k_j (x - x_{j-1})} + B_j e^{-i k_j (x - x_{j-1})}\n$$\nwhere $A_j$ and $B_j$ are complex amplitudes and $x_{j-1} = (j-1)d$ is the left boundary of the slice. The state of the system can be represented by a vector of these amplitudes, $\\mathbf{c}_j = \\begin{pmatrix} A_j \\\\ B_j \\end{pmatrix}$.\n\nThe transfer-matrix method connects the amplitude vectors of adjacent regions by enforcing the continuity of the wavefunction $\\psi(x)$ and its derivative $d\\psi/dx$ at each interface. At an interface $x=x_j$ between a region with wave number $k_j$ and a region with wave number $k_{j+1}$, this continuity condition leads to a matrix relationship:\n$$\n\\begin{pmatrix} A_{j+1} \\\\ B_{j+1} \\end{pmatrix} = T^{(j)} \\begin{pmatrix} A_j \\\\ B_j \\end{pmatrix}\n$$\nThe matrix $T^{(j)}$ is a product of an interface matrix $I_{j+1 \\leftarrow j}$ and a propagation matrix $P'_j$:\n$$\nT^{(j)} = I_{j+1 \\leftarrow j} P'_j = \\frac{1}{2} \\begin{pmatrix} 1+\\frac{k_j}{k_{j+1}}  1-\\frac{k_j}{k_{j+1}} \\\\ 1-\\frac{k_j}{k_{j+1}}  1+\\frac{k_j}{k_{j+1}} \\end{pmatrix} \\begin{pmatrix} e^{ik_j d}  0 \\\\ 0  e^{-ik_j d} \\end{pmatrix}\n$$\nBy composing these matrices across all $N$ slices and the initial interface at $x=0$, we obtain the total transfer matrix $M_{\\text{tot}}$ that relates the amplitudes in the incident region ($x0$) to those in the final transmitted region ($xL$):\n$$\n\\begin{pmatrix} A_{\\text{out}} \\\\ B_{\\text{out}} \\end{pmatrix} = M_{\\text{tot}} \\begin{pmatrix} A_{\\text{in}} \\\\ B_{\\text{in}} \\end{pmatrix} \\quad \\text{where} \\quad M_{\\text{tot}} = T^{(N)} T^{(N-1)} \\cdots T^{(1)} T^{(0)}\n$$\nHere, $T^{(0)}$ is the matrix for the first interface at $x=0$ (which lacks a preceding propagation part), and $T^{(j)}$ for $j \\in \\{1, \\dots, N\\}$ are the matrices for the subsequent slices.\n\nFor a scattering problem, we set the incident amplitude $A_{\\text{in}}=1$ and require no incoming wave from the right, so $B_{\\text{out}}=0$. Let $M_{\\text{tot}} = \\begin{pmatrix} m_{00}  m_{01} \\\\ m_{10}  m_{11} \\end{pmatrix}$. The condition $B_{\\text{out}}=0$ yields $0 = m_{10}(1) + m_{11}B_{\\text{in}}$, from which the reflection amplitude is $B_{\\text{in}} = -m_{10}/m_{11}$. The transmitted amplitude is $A_{\\text{out}} = m_{00}(1) + m_{01}B_{\\text{in}} = (m_{00}m_{11} - m_{01}m_{10})/m_{11} = \\det(M_{\\text{tot}})/m_{11}$. A key property of this formulation is that $\\det(M_{\\text{tot}})=1$, so the transmission amplitude is simply $t = A_{\\text{out}} = 1/m_{11}$.\n\nThe transmission coefficient $T(E)$ is the ratio of the transmitted probability flux to the incident probability flux. For plane waves, this simplifies to $T = |t|^2 = |1/m_{11}|^2$.\n\n### Numerical Algorithms\n\n#### Naive Algorithm\nThis algorithm computes $M_{\\text{tot}}$ by straightforwardly multiplying the sequence of $N+1$ single-step matrices, $T^{(j)}$. While direct, this method is prone to numerical instability. In regions where the energy $E$ is less than the real part of the potential $V(x)$ (a classically forbidden region), the wave number $k_j$ has a significant positive imaginary component, $\\text{Im}(k_j) = \\gamma_j  0$. The propagation matrix $P'_j$ contains a term $e^{-ik_j d} = e^{\\gamma_j d} e^{-i\\text{Re}(k_j)d}$, which grows exponentially. The repeated multiplication of matrices containing these large exponential factors causes one column of the resulting matrix $M_{\\text{tot}}$ to grow much faster than the other. This leads to a numerically singular (ill-conditioned) matrix, where the smaller components are lost due to finite floating-point precision. The calculated value of $m_{11}$ becomes unreliable, often resulting in overflow, underflow, or significant error, rendering the computed transmission coefficient meaningless.\n\n#### Stabilized Algorithm using QR Decomposition\nTo circumvent this instability, we must prevent the matrix columns from diverging in magnitude during the multiplication process. A robust method is to apply QR decomposition at each step. The product $M_{\\text{tot}} = A_N A_{N-1} \\cdots A_0$ is computed iteratively.\nLet the sequence of matrices be $\\{A_j\\}_{j=0}^N$.\n1.  Initialize by decomposing the first matrix: $A_0 = Q_0 R_0$.\n2.  At each subsequent step $j=1, \\dots, N$, compute the intermediate matrix $C_j = A_j Q_{j-1}$.\n3.  Decompose this intermediate matrix: $C_j = Q_j R_j$.\n4.  The total matrix up to this step is $A_j \\cdots A_0 = (A_j Q_{j-1})(R_{j-1} \\cdots R_0) = (Q_j R_j)(R_{j-1} \\cdots R_0) = Q_j (R_j R_{j-1} \\cdots R_0)$.\n\nAfter iterating through all matrices, the final transfer matrix is given by $M_{\\text{tot}} = Q_N R_{\\text{prod}}$, where $R_{\\text{prod}} = R_N R_{N-1} \\cdots R_0$. The $Q_j$ matrices are unitary and thus well-conditioned. The large exponential growth is isolated into the upper-triangular $R_j$ matrices. The product of these $R_j$ matrices can be computed without loss of precision. The final reconstruction $M_{\\text{tot}} = Q_N R_{\\text{prod}}$ is performed only once at the end. While this final step can still involve large numbers, it avoids the compounding loss of precision from repeated multiplications of ill-conditioned matrices. This method provides a numerically stable result for $m_{11}$ and hence for the transmission coefficient $T$.\n\nThe provided Python code implements both algorithms, demonstrating the failure of the naive method and the success of the stabilized QR method, particularly for the low-energy case ($E_1=5.0~\\mathrm{MeV}$) where the wave is strongly evanescent.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import qr\n\ndef solve():\n    # Define the test cases from the problem statement.\n    \n    # Physical and numerical parameters\n    m_p = 938.2720813  # Proton mass in MeV\n    hbar_c = 197.3269804  # h-bar * c in MeV fm\n    L = 20.0  # Slab thickness in fm\n    a = 0.6  # Diffuseness parameter in fm\n    V0 = 40.0  # Real potential strength in MeV\n    W0 = 20.0  # Imaginary potential strength in MeV\n    N = 800   # Number of slices\n    d = L / N # Slice thickness in fm\n\n    # Pre-calculate constant factor for wave number calculation\n    alpha = 2 * m_p / hbar_c**2\n\n    # Test suite of incident energies in MeV\n    energies = [5.0, 40.0, 200.0]\n\n    # Function to define the complex optical potential U(x)\n    def potential(x, L_val, a_val, V0_val, W0_val):\n        return (V0_val - 1j * W0_val) / (1 + np.exp((x - L_val / 2) / a_val))\n\n    # Calculate midpoints of the N slices for potential calculation\n    x_slices = (np.arange(N) + 0.5) * d\n    \n    # Pre-calculate potentials for all slices as they are energy-independent\n    U_slices = potential(x_slices, L, a, V0, W0)\n\n    def get_step_matrices(E, alpha_val, U_slices_val, d_val, N_val):\n        \"\"\"\n        Generates the sequence of transfer matrices for each step.\n        Returns a list of N+1 matrices [T_0, T_1, ..., T_N].\n        \"\"\"\n        # Asymptotic wave number (in regions with U=0)\n        k0 = np.sqrt(alpha_val * E)\n        \n        # Wave numbers inside the slices\n        k_slices = np.sqrt(alpha_val * (E - U_slices_val))\n        \n        # Full array of wave numbers: k_left, k_1, ..., k_N, k_right\n        k_all = np.concatenate(([k0], k_slices, [k0]))\n        \n        matrices = []\n        \n        # T_0: Matrix for the first interface (x=0) from region 0 to slice 1\n        k_prev, k_curr = k_all[0], k_all[1]\n        term = k_prev / k_curr\n        interface_matrix_0 = 0.5 * np.array([\n            [1 + term, 1 - term],\n            [1 - term, 1 + term]\n        ], dtype=np.complex128)\n        matrices.append(interface_matrix_0)\n        \n        # T_1 to T_N: Matrices for prop. through slice j and interface to j+1\n        for i in range(N_val):\n            # Propagate through slice j (k_all[i+1]) and interface to slice j+1 (k_all[i+2])\n            k_prev = k_all[i + 1]\n            k_curr = k_all[i + 2]\n            \n            # Propagation matrix P'_j\n            prop_matrix = np.array([\n                [np.exp(1j * k_prev * d_val), 0],\n                [0, np.exp(-1j * k_prev * d_val)]\n            ], dtype=np.complex128)\n            \n            # Interface matrix I_{j+1 - j}\n            term = k_prev / k_curr\n            interface_matrix = 0.5 * np.array([\n                [1 + term, 1 - term],\n                [1 - term, 1 + term]\n            ], dtype=np.complex128)\n\n            # Combined step matrix T_j = I_{j+1 - j} @ P'_j\n            step_matrix = interface_matrix @ prop_matrix\n            matrices.append(step_matrix)\n            \n        return matrices\n\n    results = []\n    \n    for E in energies:\n        # Get the list of N+1 matrices to be multiplied\n        # M_total = A_N @ ... @ A_1 @ A_0\n        step_matrices = get_step_matrices(E, alpha, U_slices, d, N)\n        \n        # --- Naive Algorithm ---\n        # Direct multiplication M_total = A_N @ ( ... @ (A_1 @ A_0))\n        m_naive = step_matrices[0]\n        for i in range(1, N + 1):\n             m_naive = step_matrices[i] @ m_naive\n        \n        # Calculate transmission coefficient T = 1 / |m_11|^2 (0-indexed)\n        m11_naive = m_naive[1, 1]\n        # Handle potential overflow/underflow where m_11 becomes inf or 0\n        if np.isinf(m11_naive) or m11_naive == 0:\n            t_naive = 0.0\n        else:\n            t_naive = 1.0 / np.abs(m11_naive)**2\n        results.append(t_naive)\n        \n        # --- Stabilized Algorithm (QR Decomposition) ---\n        # M_total = Q_N @ (R_N @ ... @ R_1 @ R_0)\n        \n        # Initialize with the first matrix A_0\n        Q_accum, R_prod = qr(step_matrices[0])\n        \n        # Loop through the remaining matrices A_1 to A_N\n        for i in range(1, N + 1):\n            C = step_matrices[i] @ Q_accum\n            Q_accum, R_step = qr(C)\n            R_prod = R_step @ R_prod\n\n        # Reconstruct the full, stable matrix M_stab = Q_accum @ R_prod\n        m_stab = Q_accum @ R_prod\n        \n        # Calculate transmission coefficient from the stabilized matrix\n        m11_stab = m_stab[1, 1]\n        t_stab = 1.0 / np.abs(m11_stab)**2\n        results.append(t_stab)\n        \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.8e}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}