{
    "hands_on_practices": [
        {
            "introduction": "This first practice explores the fundamental principle of causality as it applies to the optical model potential. The Kramers-Kronig relations provide a profound link between the absorptive part, $\\Im U(E)$, and the refractive part, $\\Re U(E)$, of the potential, ensuring the model is physically consistent across different energies. In this exercise , you will numerically verify this relationship for a model potential, gaining hands-on experience with the Cauchy principal value integrals that are central to dispersion theory.",
            "id": "3605865",
            "problem": "You are to verify the dispersive optical model consistency for elastic scattering by numerically checking the Kramers–Kronig relations between the real and imaginary parts of an energy-dependent optical potential. The verification will be performed for a model optical potential that is analytic in the upper half of the complex energy plane, ensuring causality.\n\nBegin from the fundamental base that a causal response function $U(E)$ is analytic in the upper half-plane, which implies that its real and imaginary parts are linked via the Kramers–Kronig relations. To ensure convergence for functions that do not vanish sufficiently rapidly at infinity, one uses the subtracted dispersion relation at a subtraction point $E_0$:\n$$\n\\Re U(E) - \\Re U(E_0)\n= \\frac{1}{\\pi}\\,\\mathcal{P}\\!\\!\\int_{-\\infty}^{+\\infty} \\Im U(E')\n\\left[\n\\frac{1}{E' - E} - \\frac{1}{E' - E_0}\n\\right]\\,\\mathrm{d}E' ,\n$$\nwhere $\\mathcal{P}$ denotes the Cauchy principal value. In computations, the integral will be approximated over a finite energy window $[E_{\\min}, E_{\\max}]$, which is justified if $\\Im U(E)$ is sufficiently localized so that tails beyond the window are negligible.\n\nFor numerical testing with quantifiable ground truth, use the analytic optical potential model\n$$\nU(E) = \\frac{A}{E - E_c + i\\,\\Gamma},\n$$\nwith $A$ a positive constant with units of $\\mathrm{MeV}^2$, $E_c$ a centroid energy in $\\mathrm{MeV}$, and $\\Gamma$ a width parameter in $\\mathrm{MeV}$. This yields\n$$\n\\Re U(E) = A\\,\\frac{E - E_c}{(E - E_c)^2 + \\Gamma^2},\n\\qquad\n\\Im U(E) = -A\\,\\frac{\\Gamma}{(E - E_c)^2 + \\Gamma^2},\n$$\nboth in $\\mathrm{MeV}$. By analyticity, the above subtracted Kramers–Kronig relation must hold exactly for the infinite limits; numerically, you will check whether it holds to within small error when the principal value integral is truncated to $[E_{\\min},E_{\\max}]$.\n\nYour program must:\n- Implement $\\Im U(E)$ and $\\Re U(E)$ for the analytic model given above.\n- For each test case, evaluate the subtracted dispersion-relation prediction\n$$\nD(E;E_0) \\equiv \\frac{1}{\\pi}\\,\\mathcal{P}\\!\\!\\int_{E_{\\min}}^{E_{\\max}} \\Im U(E')\n\\left[\n\\frac{1}{E' - E} - \\frac{1}{E' - E_0}\n\\right]\\,\\mathrm{d}E'\n$$\nfor a set of energies $E$ inside the integration window, and compare it to the exact difference $\\Re U(E) - \\Re U(E_0)$.\n- Use the Cauchy principal value definition for the integrals at points $E$ and $E_0$.\n- Report, for each test case, the single scalar result equal to the maximum absolute deviation over the provided $E$ grid:\n$$\n\\max_{E\\in \\mathcal{E}} \\left| \\left(\\Re U(E) - \\Re U(E_0)\\right) - D(E;E_0) \\right|,\n$$\nexpressed in $\\mathrm{MeV}$.\n\nAll energies, widths, and potential values must be treated in $\\mathrm{MeV}$. Your final printed outputs must be floats in $\\mathrm{MeV}$.\n\nTest Suite:\n- Case 1 (general case):\n  - $A = 150\\,\\mathrm{MeV}^2$, $E_c = 40\\,\\mathrm{MeV}$, $\\Gamma = 8\\,\\mathrm{MeV}$.\n  - Subtraction point $E_0 = 30\\,\\mathrm{MeV}$.\n  - Integration window $[E_{\\min},E_{\\max}] = [-160\\,\\mathrm{MeV},\\,240\\,\\mathrm{MeV}]$.\n  - Evaluation set $\\mathcal{E} = \\{10,\\,20,\\,30,\\,40,\\,50,\\,60,\\,80\\}\\,\\mathrm{MeV}$.\n- Case 2 (boundary case with $E_0$ equal to one evaluation energy):\n  - $A = 80\\,\\mathrm{MeV}^2$, $E_c = 50\\,\\mathrm{MeV}$, $\\Gamma = 12\\,\\mathrm{MeV}$.\n  - Subtraction point $E_0 = 50\\,\\mathrm{MeV}$.\n  - Integration window $[E_{\\min},E_{\\max}] = [-250\\,\\mathrm{MeV},\\,350\\,\\mathrm{MeV}]$.\n  - Evaluation set $\\mathcal{E} = \\{20,\\,40,\\,50,\\,60,\\,80,\\,100\\}\\,\\mathrm{MeV}$.\n- Case 3 (edge case with very narrow width):\n  - $A = 100\\,\\mathrm{MeV}^2$, $E_c = 10\\,\\mathrm{MeV}$, $\\Gamma = 0.5\\,\\mathrm{MeV}$.\n  - Subtraction point $E_0 = 0\\,\\mathrm{MeV}$.\n  - Integration window $[E_{\\min},E_{\\max}] = [-100\\,\\mathrm{MeV},\\,120\\,\\mathrm{MeV}]$.\n  - Evaluation set $\\mathcal{E} = \\{5,\\,9.5,\\,10.0,\\,10.5,\\,20,\\,40\\}\\,\\mathrm{MeV}$.\n\nFinal Output Format:\n- Your program should produce a single line of output containing the three results as a comma-separated list enclosed in square brackets, in $\\mathrm{MeV}$, each rounded to six decimal places. For example, the output should look like\n$$\n[\\text{result}_1,\\text{result}_2,\\text{result}_3].\n$$",
            "solution": "The problem requires the numerical verification of the subtracted Kramers–Kronig (KK) dispersion relation for a model optical potential, $U(E)$, used in elastic scattering theory. The verification process involves comparing the analytically known real part of the potential against a value computed by integrating its imaginary part.\n\nThe foundational principle is causality. In physics, a response function that is causal (i.e., the effect does not precede the cause) is mathematically represented by a function that is analytic in the upper half of the complex frequency (or energy) plane. A direct consequence of this analyticity, established by Titchmarsh's theorem, is that the real and imaginary parts of the function are not independent but are related by the Kramers–Kronig relations. For an optical potential $U(E)$ that does not vanish sufficiently quickly as $|E| \\to \\infty$, a subtracted form of the dispersion relation is used to ensure convergence of the integral. At a chosen subtraction energy $E_0$, this relation is:\n$$\n\\Re U(E) - \\Re U(E_0) = \\frac{1}{\\pi}\\,\\mathcal{P}\\!\\!\\int_{-\\infty}^{+\\infty} \\Im U(E') \\left[ \\frac{1}{E' - E} - \\frac{1}{E' - E_0} \\right]\\,\\mathrm{d}E'\n$$\nwhere $\\mathcal{P}$ denotes the Cauchy principal value of the integral.\n\nThe problem provides a specific analytic model for the potential, which has a single pole in the lower half-plane, thereby satisfying the causality requirement. The potential is given by:\n$$\nU(E) = \\frac{A}{E - E_c + i\\,\\Gamma}\n$$\nwhere $A$ is a strength parameter in units of $\\mathrm{MeV}^2$, $E_c$ is a resonance energy in $\\mathrm{MeV}$, and $\\Gamma$ is a width parameter in $\\mathrm{MeV}$, with $\\Gamma  0$. The real and imaginary parts of this potential are:\n$$\n\\Re U(E) = A\\,\\frac{E - E_c}{(E - E_c)^2 + \\Gamma^2}\n$$\n$$\n\\Im U(E) = -A\\,\\frac{\\Gamma}{(E - E_c)^2 + \\Gamma^2}\n$$\n\nThe task is to numerically evaluate the right-hand side of the KK relation over a finite integration window $[E_{\\min}, E_{\\max}]$, denoted as $D(E; E_0)$:\n$$\nD(E;E_0) \\equiv \\frac{1}{\\pi}\\,\\mathcal{P}\\!\\!\\int_{E_{\\min}}^{E_{\\max}} \\Im U(E') \\left[ \\frac{1}{E' - E} - \\frac{1}{E' - E_0} \\right]\\,\\mathrm{d}E'\n$$\nand to quantify its deviation from the analytically known left-hand side, $\\Re U(E) - \\Re U(E_0)$. The maximum absolute deviation over a prescribed set of evaluation energies $\\mathcal{E}$ is the final result for each test case.\n\nThe numerical challenge lies in the evaluation of the Cauchy principal value integral. The integrand has singularities at $E' = E$ and $E' = E_0$. The integral for $D(E; E_0)$ can be decomposed into two separate principal value integrals:\n$$\nD(E; E_0) = \\frac{1}{\\pi} \\left( \\mathcal{P}\\!\\!\\int_{E_{\\min}}^{E_{\\max}} \\frac{\\Im U(E')}{E' - E}\\,\\mathrm{d}E' - \\mathcal{P}\\!\\!\\int_{E_{\\min}}^{E_{\\max}} \\frac{\\Im U(E')}{E' - E_0}\\,\\mathrm{d}E' \\right)\n$$\nEach integral is of the form $\\mathcal{P}\\int_a^b \\frac{g(x)}{x-c}\\,\\mathrm{d}x$. Such integrals can be computed robustly using specialized numerical quadrature routines. The `scipy.integrate.quad` function in Python's SciPy library is ideally suited for this, offering a `weight='cauchy'` option that takes the function $g(x)$ and the singularity location $c$ (as `wvar`) as arguments to compute the principal value.\n\nThe overall algorithm proceeds as follows:\n1.  For each test case, the parameters $(A, E_c, \\Gamma)$, the subtraction point $E_0$, the integration window $[E_{\\min}, E_{\\max}]$, and the set of evaluation energies $\\mathcal{E}$ are defined.\n2.  Functions are implemented to compute $\\Re U(E)$ and $\\Im U(E)$ according to their analytic formulas.\n3.  A loop iterates through each evaluation energy $E \\in \\mathcal{E}$.\n4.  Inside the loop, for each $E$:\n    a. The \"exact\" difference, $\\Delta_{\\text{exact}} = \\Re U(E) - \\Re U(E_0)$, is calculated directly.\n    b. The dispersion integral term, $D(E; E_0)$, is computed. If $E = E_0$, the integrand is identically zero, so $D(E_0; E_0) = 0$. Otherwise, the two principal value integrals are computed using `scipy.integrate.quad` with the Cauchy weight, and their difference is scaled by $1/\\pi$.\n    c. The absolute deviation, $|\\Delta_{\\text{exact}} - D(E; E_0)|$, is calculated.\n5.  The maximum of these deviations across all $E \\in \\mathcal{E}$ is found and stored as the result for the test case. The small, non-zero result quantifies the error introduced primarily by truncating the infinite integration range to $[E_{\\min}, E_{\\max}]$, as the model function $\\Im U(E')$ has tails extending to $\\pm\\infty$.\n6.  This procedure is repeated for all three specified test cases, and the results are formatted as requested.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test cases.\n    It verifies the dispersive optical model consistency by checking the\n    Kramers-Kronig relation for a model potential.\n    \"\"\"\n\n    def Re_U(E, A, Ec, Gamma):\n        \"\"\"\n        Calculates the real part of the model optical potential.\n        \n        Args:\n            E (float): Energy in MeV.\n            A (float): Strength parameter in MeV^2.\n            Ec (float): Centroid energy in MeV.\n            Gamma (float): Width parameter in MeV.\n        \n        Returns:\n            float: Real part of the potential in MeV.\n        \"\"\"\n        return A * (E - Ec) / ((E - Ec)**2 + Gamma**2)\n\n    def Im_U(E_prime, A, Ec, Gamma):\n        \"\"\"\n        Calculates the imaginary part of the model optical potential.\n\n        Args:\n            E_prime (float): Integration variable for energy in MeV.\n            A (float): Strength parameter in MeV^2.\n            Ec (float): Centroid energy in MeV.\n            Gamma (float): Width parameter in MeV.\n        \n        Returns:\n            float: Imaginary part of the potential in MeV.\n        \"\"\"\n        return -A * Gamma / ((E_prime - Ec)**2 + Gamma**2)\n\n    def calculate_dispersion_integral(E, E0, Emin, Emax, A, Ec, Gamma):\n        \"\"\"\n        Calculates the subtracted dispersion integral D(E; E0) using a\n        Cauchy principal value numerical integration.\n        D(E;E0) = (1/pi) * P.V. integral[Im_U(E') * (1/(E'-E) - 1/(E'-E0))] dE'\n        \"\"\"\n        # If the evaluation energy is the same as the subtraction point,\n        # the integrand is zero everywhere, so the integral is zero.\n        if E == E0:\n            return 0.0\n\n        # The function passed to quad should be Im_U(E'). The (1/(E'-c)) part\n        # is handled by the 'cauchy' weight.\n        args_for_Im_U = (A, Ec, Gamma)\n\n        # Calculate the first principal value integral, with singularity at E.\n        integral_1, _ = quad(Im_U, Emin, Emax, args=args_for_Im_U, weight='cauchy', wvar=E)\n        \n        # Calculate the second principal value integral, with singularity at E0.\n        integral_2, _ = quad(Im_U, Emin, Emax, args=args_for_Im_U, weight='cauchy', wvar=E0)\n\n        # Combine results according to the dispersion relation formula.\n        D_E_E0 = (1.0 / np.pi) * (integral_1 - integral_2)\n        return D_E_E0\n\n    def solve_case(params):\n        \"\"\"\n        Solves a single test case.\n        \n        Args:\n            params (dict): A dictionary containing all parameters for the case.\n            \n        Returns:\n            float: The maximum absolute deviation in MeV.\n        \"\"\"\n        A = params['A']\n        Ec = params['Ec']\n        Gamma = params['Gamma']\n        E0 = params['E0']\n        Emin, Emax = params['window']\n        E_set = params['E_set']\n        \n        max_deviation = 0.0\n\n        for E_eval in E_set:\n            # Calculate the expected difference from the analytic formula for Re(U).\n            exact_diff = Re_U(E_eval, A, Ec, Gamma) - Re_U(E0, A, Ec, Gamma)\n            \n            # Calculate the difference from the numerical dispersion integral.\n            numerical_D = calculate_dispersion_integral(E_eval, E0, Emin, Emax, A, Ec, Gamma)\n            \n            # Calculate the absolute deviation.\n            deviation = np.abs(exact_diff - numerical_D)\n            \n            # Update the maximum deviation found so far.\n            if deviation > max_deviation:\n                max_deviation = deviation\n                \n        return max_deviation\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"A\": 150.0, \"Ec\": 40.0, \"Gamma\": 8.0,\n            \"E0\": 30.0,\n            \"window\": [-160.0, 240.0],\n            \"E_set\": [10.0, 20.0, 30.0, 40.0, 50.0, 60.0, 80.0]\n        },\n        {\n            \"A\": 80.0, \"Ec\": 50.0, \"Gamma\": 12.0,\n            \"E0\": 50.0,\n            \"window\": [-250.0, 350.0],\n            \"E_set\": [20.0, 40.0, 50.0, 60.0, 80.0, 100.0]\n        },\n        {\n            \"A\": 100.0, \"Ec\": 10.0, \"Gamma\": 0.5,\n            \"E0\": 0.0,\n            \"window\": [-100.0, 120.0],\n            \"E_set\": [5.0, 9.5, 10.0, 10.5, 20.0, 40.0]\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        result = solve_case(case)\n        results.append(result)\n\n    # Format the output as a comma-separated list of floats with 6 decimal places,\n    # enclosed in square brackets.\n    formatted_results = [f\"{r:.6f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Having explored a key theoretical property of the potential, we now turn to the practical challenge of solving the Schrödinger equation itself. The presence of a strong absorptive component in the optical potential introduces numerical instabilities that can derail standard integration methods. This exercise  guides you through analyzing the conditioning of the log-derivative integrator and developing an adaptive step-size strategy to maintain accuracy, a crucial skill for any robust computational physics code.",
            "id": "3605853",
            "problem": "Consider the radial elastic scattering of a nucleon from a nucleus described by the optical model, where the central potential has a real and an absorptive imaginary component. Let the reduced mass be approximated by the nucleon mass so that the ratio $\\hbar^2 / (2\\mu)$ is the constant $20.735$ in units of $\\mathrm{MeV \\cdot fm^2}$. The radial Schrödinger equation for a partial wave with orbital angular momentum $\\ell$ for the reduced radial wave function $u(r)$ is\n$$\n\\frac{d^2 u(r)}{dr^2} + K(r)\\,u(r) = 0,\n$$\nwith\n$$\nK(r) = \\frac{2\\mu E}{\\hbar^2} - \\frac{2\\mu V(r)}{\\hbar^2} - \\frac{\\ell(\\ell+1)}{r^2},\n$$\nwhere $E$ is the laboratory energy in $\\mathrm{MeV}$, $r$ is the radial coordinate in $\\mathrm{fm}$, $\\ell$ is an integer, and $V(r)$ is the complex optical potential in $\\mathrm{MeV}$. Take a Woods–Saxon form for the central potential\n$$\nV(r) = V_{\\mathrm{r}}\\,f(r) + i\\,W\\,f(r), \\quad f(r) = \\frac{1}{1 + \\exp\\left(\\frac{r - R}{a}\\right)},\n$$\nwith $V_{\\mathrm{r}}$ the real depth in $\\mathrm{MeV}$, $W$ the imaginary depth in $\\mathrm{MeV}$ such that absorptive potentials have $W  0$, $R = r_0 A^{1/3}$ the radius in $\\mathrm{fm}$ for mass number $A$, and $a$ the diffuseness in $\\mathrm{fm}$.\n\nDefine the log-derivative $Y(r) = \\frac{u'(r)}{u(r)}$. The log-derivative satisfies the Riccati equation\n$$\n\\frac{dY(r)}{dr} = -K(r) - Y(r)^2.\n$$\nA common numerical approach propagates $Y(r)$ over a small step $h$ by assuming $K(r)$ is constant across the step, which reduces the local equation to $u''(r) + K\\,u(r) = 0$ with constant $K$. Let $\\kappa = \\sqrt{K}$ be the principal square root of $K$. Over one step of size $h$, the exact constant-$K$ update for the log-derivative is a Möbius transform\n$$\nY_{+} = \\frac{Y_{-}\\cos(\\kappa h) - \\kappa \\sin(\\kappa h)}{\\cos(\\kappa h) + \\frac{Y_{-}}{\\kappa}\\sin(\\kappa h)},\n$$\nwhere $Y_{-}$ and $Y_{+}$ are the log-derivative values at the beginning and end of the step, respectively. The sensitivity (conditioning) of the update with respect to $Y_{-}$ is quantified by the magnitude of the derivative $\\left|\\frac{\\partial Y_{+}}{\\partial Y_{-}}\\right|$. Evaluated at the fixed point $Y = +\\,i\\,\\kappa$ corresponding to an outgoing wave, it simplifies to the closed form\n$$\n\\left|\\frac{\\partial Y_{+}}{\\partial Y_{-}}\\right| = \\left|e^{i\\,\\kappa h}\\right|^{-2} = \\exp\\left(2\\,\\mathrm{Im}(\\kappa)\\,h\\right).\n$$\nThis expression shows that strong absorption, which yields $\\mathrm{Im}(\\kappa)  0$, causes an exponential amplification of numerical perturbations over each step, making the propagation increasingly ill-conditioned as $h$ grows. A step-size control mitigation to enforce a conditioning cap $c_{\\max}  1$ is to require\n$$\n\\exp\\left(2\\,\\mathrm{Im}(\\kappa(r))\\,h\\right) \\le c_{\\max}\n\\quad\\Rightarrow\\quad\nh \\le \\frac{\\ln(c_{\\max})}{2\\,\\mathrm{Im}(\\kappa(r))},\n$$\napplied pointwise for each $r$ where $\\mathrm{Im}(\\kappa(r))  0$.\n\nYour task is to implement a program that, for a given set of optical-model parameters and a uniform step size $h$ in $\\mathrm{fm}$, computes the conditioning profile\n$$\nC(r; h) = \\exp\\left(2\\,\\mathrm{Im}(\\kappa(r))\\,h\\right),\n$$\nover a radial interval $[r_{\\min}, r_{\\max}]$, and reports:\n- the maximum conditioning value $C_{\\max}(h) = \\max_{r \\in [r_{\\min}, r_{\\max}]} C(r; h)$ as a floating-point number, and\n- the recommended step size $h_{\\mathrm{rec}}$ in $\\mathrm{fm}$ that guarantees $C(r; h) \\le c_{\\max}$ for all $r \\in [r_{\\min}, r_{\\max}]$, computed by\n$$\nh_{\\mathrm{rec}} = \\min\\left(\\min_{r \\in [r_{\\min}, r_{\\max}],\\,\\mathrm{Im}(\\kappa(r))0} \\frac{\\ln(c_{\\max})}{2\\,\\mathrm{Im}(\\kappa(r))},\\, h_{\\mathrm{cap}}\\right),\n$$\nwhere $h_{\\mathrm{cap}}$ is a user-imposed upper cap in $\\mathrm{fm}$ to ensure resolution of potential variations even in the absence of absorption. Use $h_{\\mathrm{cap}} = 0.5$ in $\\mathrm{fm}$, $r_{\\min} = 0.2$ in $\\mathrm{fm}$, and $r_{\\max} = 15.0$ in $\\mathrm{fm}$. If there is no absorption so that $\\mathrm{Im}(\\kappa(r)) \\approx 0$ for all $r$, then $h_{\\mathrm{rec}} = h_{\\mathrm{cap}}$.\n\nPhysical units must be respected: all energies are in $\\mathrm{MeV}$, all lengths are in $\\mathrm{fm}$, and the step sizes must be reported in $\\mathrm{fm}$. No angles are used. Your program should implement the following test suite of cases and produce the specified outputs:\n- Case $1$ (happy path, moderate absorption): $A = 40$, $E = 50$, $V_{\\mathrm{r}} = 50$, $W = -5$, $\\ell = 0$, $r_0 = 1.25$, $a = 0.65$, $h = 0.05$, $c_{\\max} = 10$.\n- Case $2$ (centrifugal barrier influence): $A = 208$, $E = 30$, $V_{\\mathrm{r}} = 60$, $W = -20$, $\\ell = 6$, $r_0 = 1.25$, $a = 0.65$, $h = 0.05$, $c_{\\max} = 10$.\n- Case $3$ (strong absorption, potential stiffness): $A = 208$, $E = 10$, $V_{\\mathrm{r}} = 50$, $W = -50$, $\\ell = 0$, $r_0 = 1.25$, $a = 0.65$, $h = 0.05$, $c_{\\max} = 10$.\n- Case $4$ (no absorption boundary): $A = 40$, $E = 80$, $V_{\\mathrm{r}} = 40$, $W = 0$, $\\ell = 0$, $r_0 = 1.25$, $a = 0.65$, $h = 0.05$, $c_{\\max} = 10$.\n\nFor each case, compute $C_{\\max}(h)$ and $h_{\\mathrm{rec}}$ as defined above. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets with the pattern\n$$\n[\\;C_{\\max}^{(1)},\\,h_{\\mathrm{rec}}^{(1)},\\,C_{\\max}^{(2)},\\,h_{\\mathrm{rec}}^{(2)},\\,C_{\\max}^{(3)},\\,h_{\\mathrm{rec}}^{(3)},\\,C_{\\max}^{(4)},\\,h_{\\mathrm{rec}}^{(4)}\\;],\n$$\nwhere each entry is a floating-point number in standard decimal notation.",
            "solution": "The problem statement has been validated and is determined to be sound. It is scientifically grounded in the principles of computational nuclear physics, specifically the optical model of elastic scattering. All parameters, definitions, and constraints are well-defined, self-consistent, and physically plausible, rendering the problem well-posed and solvable. We may therefore proceed with the derivation and implementation of the solution.\n\nThe core of the problem is to analyze the numerical conditioning of the integration of the radial Schrödinger equation when using a log-derivative method. The conditioning is related to the imaginary part of the local wave number, $\\kappa(r)$. Our task is to compute two quantities for several parameter sets: the maximum conditioning factor $C_{\\max}(h)$ over a radial interval for a fixed step size $h$, and a recommended step size $h_{\\mathrm{rec}}$ to keep the conditioning below a specified threshold $c_{\\max}$.\n\nThe algorithmic procedure is as follows:\n\nFirst, we define all relevant physical quantities as functions of the radial coordinate, $r$. The constant ratio $\\frac{\\hbar^2}{2\\mu}$ is given as $c_0 = 20.735 \\, \\mathrm{MeV \\cdot fm^2}$.\n\nThe Woods-Saxon form factor, $f(r)$, which describes the shape of the nuclear potential, is given by:\n$$\nf(r) = \\frac{1}{1 + \\exp\\left(\\frac{r - R}{a}\\right)}\n$$\nwhere the nuclear radius $R$ is determined by the mass number $A$ and a radius parameter $r_0$ as $R = r_0 A^{1/3}$. The parameter $a$ is the diffuseness.\n\nThe complex optical potential, $V(r)$, is a sum of a real (refractive) part with depth $V_{\\mathrm{r}}$ and an imaginary (absorptive) part with depth $W$:\n$$\nV(r) = (V_{\\mathrm{r}} + i\\,W) f(r)\n$$\nA negative value of $W$ corresponds to absorption, as is standard in nuclear reaction theory.\n\nFrom the potential, we construct the position-dependent squared wave number, $K(r)$, which appears in the radial Schrödinger equation. Its definition is:\n$$\nK(r) = \\frac{2\\mu E}{\\hbar^2} - \\frac{2\\mu V(r)}{\\hbar^2} - \\frac{\\ell(\\ell+1)}{r^2}\n$$\nUsing the provided constant $c_0$, this becomes:\n$$\nK(r) = \\frac{E - V(r)}{c_0} - \\frac{\\ell(\\ell+1)}{r^2}\n$$\nHere, $E$ is the kinetic energy and the term involving the orbital angular momentum $\\ell$ is the centrifugal potential. $K(r)$ is a complex-valued function.\n\nThe local wave number is then the principal square root of $K(r)$:\n$$\n\\kappa(r) = \\sqrt{K(r)}\n$$\nSince $K(r)$ is complex, $\\kappa(r)$ will also be complex, with $\\kappa(r) = \\mathrm{Re}(\\kappa(r)) + i\\,\\mathrm{Im}(\\kappa(r))$. The imaginary part, $\\mathrm{Im}(\\kappa(r))$, is central to the problem. If $\\mathrm{Im}(\\kappa(r))  0$, the wave function exhibits exponential behavior which, in the context of numerical integration, leads to the amplification of errors.\n\nThe problem defines the conditioning profile $C(r; h)$ for a step size $h$ as:\n$$\nC(r; h) = \\exp\\left(2\\,\\mathrm{Im}(\\kappa(r))\\,h\\right)\n$$\n\nTo find the maximum conditioning factor, $C_{\\max}(h)$, and the recommended step size, $h_{\\mathrm{rec}}$, we must evaluate these functions over the specified radial interval $[r_{\\min}, r_{\\max}] = [0.2, 15.0]$. Since these are continuous functions, we adopt a numerical approach by discretizing the interval into a fine grid of points, $\\{r_j\\}$. We will use a grid of $15000$ points to ensure high resolution.\n\nThe algorithm to compute the required outputs for each test case is as follows:\n\n1.  **Discretize the Domain**: Generate an array of radial points $r_j$ from $r_{\\min} = 0.2 \\, \\mathrm{fm}$ to $r_{\\max} = 15.0 \\, \\mathrm{fm}$.\n2.  **Evaluate Functions on the Grid**: For each point $r_j$ in the grid, compute the sequence of values: $f(r_j)$, $V(r_j)$, $K(r_j)$, and finally $\\kappa(r_j) = \\sqrt{K(r_j)}$. This yields a corresponding grid of complex $\\kappa_j$ values.\n3.  **Compute $C_{\\max}(h)$**:\n    a. Extract the imaginary part of each $\\kappa_j$ value to get an array $\\mathrm{Im}(\\kappa_j)$.\n    b. Calculate the conditioning value at each grid point: $C_j = \\exp\\left(2 \\cdot \\mathrm{Im}(\\kappa_j) \\cdot h\\right)$, using the given step size $h$.\n    c. The maximum conditioning factor is the maximum value in the array of $C_j$: $C_{\\max}(h) = \\max_j \\{C_j\\}$.\n4.  **Compute $h_{\\mathrm{rec}}$**:\n    a. Identify all grid points $r_j$ for which $\\mathrm{Im}(\\kappa_j)$ is greater than zero (within a small numerical tolerance to handle floating-point artifacts).\n    b. If no such points exist (i.e., for a purely real potential where $K(r)$ is always positive), the problem specifies $h_{\\mathrm{rec}} = h_{\\mathrm{cap}}$, where $h_{\\mathrm{cap}} = 0.5 \\, \\mathrm{fm}$.\n    c. If there are points with $\\mathrm{Im}(\\kappa_j)  0$, calculate the local step-size limit for each of these points:\n    $$\n    h_{\\mathrm{lim}, j} = \\frac{\\ln(c_{\\max})}{2\\,\\mathrm{Im}(\\kappa_j)}\n    $$\n    d. Find the minimum of these limits: $h_{\\mathrm{lim}}^{\\min} = \\min_j \\{h_{\\mathrm{lim}, j}\\}$. This value is the most restrictive step-size constraint imposed by the absorptive potential.\n    e. The recommended step size $h_{\\mathrm{rec}}$ is the smaller of this minimum and the global cap, $h_{\\mathrm{cap}}$:\n    $$\n    h_{\\mathrm{rec}} = \\min(h_{\\mathrm{lim}}^{\\min}, h_{\\mathrm{cap}})\n    $$\n\nThis procedure is implemented for each of the four test cases provided, and the resulting pairs of $(C_{\\max}(h), h_{\\mathrm{rec}})$ are collected and formatted as specified.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the conditioning profile and recommended step size for the optical model\n    of elastic scattering as described in the problem statement.\n    \"\"\"\n    # Define the physical constant\n    HBAR2_OVER_2MU = 20.735  # MeV * fm^2\n\n    # Define the test suite of cases\n    # Each case is a tuple: (A, E, V_r, W, l, r_0, a, h, c_max)\n    test_cases = [\n        # Case 1 (happy path, moderate absorption)\n        (40, 50, 50, -5, 0, 1.25, 0.65, 0.05, 10),\n        # Case 2 (centrifugal barrier influence)\n        (208, 30, 60, -20, 6, 1.25, 0.65, 0.05, 10),\n        # Case 3 (strong absorption, potential stiffness)\n        (208, 10, 50, -50, 0, 1.25, 0.65, 0.05, 10),\n        # Case 4 (no absorption boundary)\n        (40, 80, 40, 0, 0, 1.25, 0.65, 0.05, 10),\n    ]\n\n    # Fixed parameters for the calculation\n    R_MIN = 0.2  # fm\n    R_MAX = 15.0  # fm\n    H_CAP = 0.5  # fm\n    NUM_POINTS = 15000  # Number of points in the radial grid\n\n    # Generate the radial grid for numerical evaluation\n    r_grid = np.linspace(R_MIN, R_MAX, NUM_POINTS)\n    \n    # List to store all final results\n    all_results = []\n\n    for case in test_cases:\n        A, E, V_r, W, l, r0, a, h, c_max = case\n\n        # Calculate the nuclear radius a.k.a. R\n        R_nuc = r0 * A**(1/3)\n\n        # Calculate the Woods-Saxon form factor f(r) over the grid\n        f_of_r = 1.0 / (1.0 + np.exp((r_grid - R_nuc) / a))\n\n        # Calculate the complex optical potential V(r)\n        V_of_r = (V_r + 1j * W) * f_of_r\n\n        # Calculate the centrifugal term. r_grid does not contain 0, so this is safe.\n        centrifugal_term = l * (l + 1) / (r_grid**2)\n\n        # Calculate the K(r) function\n        # K(r) = ( E - V(r) ) / (hbar^2/2mu) - l(l+1)/r^2\n        K_of_r = (E - V_of_r) / HBAR2_OVER_2MU - centrifugal_term\n\n        # Calculate kappa(r) = sqrt(K(r)) using the principal square root\n        kappa_of_r = np.sqrt(K_of_r)\n\n        # Extract the imaginary part of kappa(r)\n        im_kappa = np.imag(kappa_of_r)\n        \n        # --- Task 1: Compute C_max(h) ---\n        # C(r; h) = exp(2 * Im(kappa(r)) * h)\n        conditioning_profile = np.exp(2 * im_kappa * h)\n        C_max_val = np.max(conditioning_profile)\n        \n        # --- Task 2: Compute h_rec ---\n        # Find indices where Im(kappa)  0 using a small tolerance\n        pos_im_kappa_indices = np.where(im_kappa > 1e-15)\n        \n        if pos_im_kappa_indices[0].size == 0:\n            # If no absorption, h_rec is capped by the user-defined maximum\n            h_rec_val = H_CAP\n        else:\n            # Filter for positive imaginary parts of kappa\n            im_kappa_positive = im_kappa[pos_im_kappa_indices]\n            \n            # h_allowed = ln(c_max) / (2 * Im(kappa(r)))\n            h_allowed = np.log(c_max) / (2 * im_kappa_positive)\n            \n            # Find the most restrictive (minimum) step size\n            h_min_allowed = np.min(h_allowed)\n            \n            # h_rec is the minimum of the calculated limit and the user cap\n            h_rec_val = min(h_min_allowed, H_CAP)\n            \n        all_results.append(C_max_val)\n        all_results.append(h_rec_val)\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "In our final practice, we move from the phenomenological form of the optical model to a more microscopic foundation. This exercise  asks you to construct a potential that depends explicitly on the nuclear matter density, incorporating modern ideas about how nuclear interactions are modified within the dense medium. By using the Born approximation to compare different scaling hypotheses against synthetic data, you will learn how the optical model serves as a powerful tool to test theories of in-medium effects in nuclear physics.",
            "id": "3605861",
            "problem": "You are to implement a computational test of density-dependent optical potentials for elastic nucleon–nucleus scattering under the first Born approximation, and use it to evaluate Brown–Rho-like scaling across an isotopic chain. The task requires deriving the scattering amplitude from first principles and building a program that compares two scaling hypotheses against synthetic elastic-scattering reference data that are internally generated from a specified model.\n\nStart from the following fundamental base:\n\n- The elastic scattering amplitude in the first Born approximation is, for a spherically symmetric local optical potential $U(r)$,\n$$\nf(\\theta) \\;=\\; - \\frac{2 \\mu}{\\hbar^2} \\int_{0}^{\\infty} r^2 \\, U(r) \\, j_0\\!\\left(q r\\right)\\,dr\n\\;=\\; - \\frac{2 \\mu}{\\hbar^2} \\cdot \\frac{1}{q}\\int_{0}^{\\infty} r \\, U(r) \\, \\sin\\!\\left(q r\\right) \\, dr,\n$$\nwhere $j_0(x)$ is the spherical Bessel function of order $0$, $q = 2 k \\sin(\\theta/2)$ is the momentum transfer, $k$ is the center-of-mass wave number, $\\mu$ is the reduced mass, and $\\theta$ is the scattering angle.\n\n- The differential elastic cross section is\n$$\n\\frac{d\\sigma}{d\\Omega}(\\theta) \\;=\\; \\left| f(\\theta) \\right|^2.\n$$\n\n- Use non-relativistic two-body kinematics for a nucleon projectile of mass $m_N$ scattering from a stationary target nucleus of mass number $A$:\n$$\n\\mu \\;=\\; \\frac{m_{N}\\, A}{1 + A}, \\qquad E_{\\mathrm{cm}} \\;=\\; E_{\\mathrm{lab}} \\cdot \\frac{A}{1 + A}, \\qquad\nk \\;=\\; \\frac{\\sqrt{2 \\mu E_{\\mathrm{cm}}}}{\\hbar c}.\n$$\nAdopt natural units with $c = 1$, but keep $\\hbar c$ explicit to convert between length and momentum-energy units.\n\n- The nuclear density is modeled by a two-parameter Fermi distribution (also known as a Woods–Saxon density):\n$$\n\\rho(r) \\;=\\; \\frac{\\rho_0}{1 + \\exp\\!\\left(\\frac{r - R}{a}\\right)},\n$$\nwith $R = r_0 A^{1/3}$ and $\\rho_0$ the saturation density. The dimensionless average density fraction that will be used for scaling is defined by\n$$\n\\eta_A \\;\\equiv\\; \\frac{\\displaystyle \\int_{0}^{\\infty} 4\\pi r^2 \\,\\rho(r)^2\\,dr}{\\rho_0 \\displaystyle \\int_{0}^{\\infty} 4\\pi r^2 \\,\\rho(r)\\,dr}.\n$$\n\n- The complex, density-dependent optical potential is taken as\n$$\nU(r) \\;=\\; \\left[ V_0 \\, \\Bigl(1 - C \\,\\eta_A\\Bigr)\\right] \\left(\\frac{\\rho(r)}{\\rho_0}\\right)^{\\alpha} \\;+\\; i \\left[ W_0 \\, \\Bigl(1 - C \\,\\eta_A\\Bigr)\\right] \\left(\\frac{\\rho(r)}{\\rho_0}\\right)^{\\beta},\n$$\nwhere $V_0$ and $W_0$ are real constants, $\\alpha$ and $\\beta$ are density exponents, and $C$ is a Brown–Rho-like scaling coefficient. The dimensionless coefficient $C$ encodes a Brown–Rho-inspired linear-in-density modification of in-medium couplings through $\\left(1 - C \\,\\eta_A\\right)$.\n\n- The reference elastic-scattering data for benchmarking is to be generated internally by the same model with a known “reference” scaling $C_{\\mathrm{ref}}$ and with a fixed uncertainty model. Use a relative uncertainty of $5\\%$ on the reference differential cross section values at each angle. For a model prediction $\\sigma_{\\mathrm{mod}}(\\theta)$ and reference value $\\sigma_{\\mathrm{ref}}(\\theta)$ with uncertainty $\\delta(\\theta) = 0.05 \\, \\sigma_{\\mathrm{ref}}(\\theta)$, define\n$$\n\\chi^2 \\;=\\; \\sum_{i} \\left(\\frac{\\sigma_{\\mathrm{mod}}(\\theta_i) - \\sigma_{\\mathrm{ref}}(\\theta_i)}{\\delta(\\theta_i)}\\right)^2, \\qquad\n\\tilde{\\chi}^2 \\;=\\; \\frac{\\chi^2}{N_{\\mathrm{data}}},\n$$\nwhere $N_{\\mathrm{data}}$ is the number of angles in the given test.\n\nYour program must implement the above model and carry out the following tasks.\n\nConstants to use:\n- Planck constant times speed of light: $\\hbar c = 197.3269804\\,\\mathrm{MeV\\,fm}$.\n- Nucleon mass: $m_N = 938.92\\,\\mathrm{MeV}$.\n- Nuclear saturation density: $\\rho_0 = 0.16\\,\\mathrm{fm^{-3}}$.\n- Optical potential parameters: $V_0 = -40.0\\,\\mathrm{MeV}$, $W_0 = -10.0\\,\\mathrm{MeV}$.\n- Geometric parameters: $r_0 = 1.25\\,\\mathrm{fm}$, $a = 0.55\\,\\mathrm{fm}$.\n\nAngles must be interpreted in degrees, but all computations must be performed in radians, and all distances in $\\mathrm{fm}$ and energies in $\\mathrm{MeV}$. The output differential cross sections must be in $\\mathrm{fm^2/sr}$, but the final reported quantities are dimensionless reduced chi-squared differences, so no unit conversion is required at output.\n\nTest suite (four cases). For each case, the “reference” differential cross sections are generated by the same model using $C_{\\mathrm{ref}} = 0.15$. You must then compute the reduced chi-squared $\\tilde{\\chi}^2$ for the two hypotheses $C = 0.00$ and $C = 0.25$, and report the difference\n$$\n\\Delta \\tilde{\\chi}^2 \\;\\equiv\\; \\tilde{\\chi}^2\\bigl(C=0.00\\bigr) \\;-\\; \\tilde{\\chi}^2\\bigl(C=0.25\\bigr)\n$$\nfor each case.\n\n- Case $1$ (happy path): $A = 40$, $E_{\\mathrm{lab}} = 65.0\\,\\mathrm{MeV}$, exponents $\\alpha = 1.0$, $\\beta = 1.0$, angles $\\theta \\in \\{10, 20, 30, 40, 60\\}$ degrees.\n- Case $2$ (parameter variation): $A = 48$, $E_{\\mathrm{lab}} = 65.0\\,\\mathrm{MeV}$, exponents $\\alpha = 1.5$, $\\beta = 1.0$, angles $\\theta \\in \\{10, 20, 30, 40, 60\\}$ degrees.\n- Case $3$ (heavier target and forward angles): $A = 208$, $E_{\\mathrm{lab}} = 80.0\\,\\mathrm{MeV}$, exponents $\\alpha = 1.0$, $\\beta = 1.5$, angles $\\theta \\in \\{5, 10, 20, 30, 40, 60\\}$ degrees.\n- Case $4$ (lighter target, broader angles as an edge case): $A = 16$, $E_{\\mathrm{lab}} = 100.0\\,\\mathrm{MeV}$, exponents $\\alpha = 1.0$, $\\beta = 1.0$, angles $\\theta \\in \\{10, 30, 50, 70\\}$ degrees.\n\nAlgorithmic specifications and numerical requirements:\n- Evaluate $\\eta_A$ exactly as defined, by computing the required integrals numerically from $r = 0$ to $r \\to \\infty$. Use integration limits and tolerances adequate to achieve stable values to at least $6$ significant digits.\n- Evaluate the Born amplitude integral by treating real and imaginary parts separately and using the oscillatory $\\sin(q r)$ form. Ensure stable numerical handling for values of $q$ corresponding to the specified angles and energies.\n- For each test case, internally generate the reference differential cross sections using the above model with $C_{\\mathrm{ref}} = 0.15$, and the exact same $\\alpha$, $\\beta$, $A$, $E_{\\mathrm{lab}}$, and angle set specified for that case. Then compute $\\tilde{\\chi}^2$ for the two hypotheses $C = 0.00$ and $C = 0.25$, and finally compute $\\Delta \\tilde{\\chi}^2$ as defined above.\n\nFinal output specification:\n- Your program should produce a single line of output containing the four results as a comma-separated list enclosed in square brackets, with each value rounded to exactly six decimal places, for example, `[x_1,x_2,x_3,x_4]`. The entries must be the four values of $\\Delta \\tilde{\\chi}^2$ corresponding to Cases $1$ through $4$ in order. The values are dimensionless.\n\nEnsure your implementation is fully self-contained, uses no external input, and adheres to the numerical and physical units specified above. All angles in the input sets are given in degrees and must be internally converted to radians before use. The answers must be consistent with the model equations and the constants provided here. The program must be general in the sense that it follows unambiguously from these definitions and parameters; do not hard-code any precomputed cross sections.",
            "solution": "The problem requires the implementation of a computational model for nucleon-nucleus elastic scattering to test a hypothesis related to density-dependent optical potentials. The validation process confirms that the problem statement is scientifically grounded, well-posed, and contains all necessary information. It is based on established principles of nuclear reaction theory, specifically the first Born approximation for scattering from a complex optical potential. The parameters, constants, and kinematic relations are standard within the field. Therefore, the problem is valid and a solution will be constructed.\n\nThe solution involves a multi-step calculation for each of the four test cases. The objective is to compute a quantity, $\\Delta \\tilde{\\chi}^2$, which quantifies the difference in goodness-of-fit between two theoretical hypotheses ($C=0.00$ and $C=0.25$) against a set of synthetic reference data. This reference data is itself generated from the same model using a known \"true\" parameter, $C_{\\mathrm{ref}}=0.15$.\n\nThe calculational workflow proceeds as follows:\n\n1.  **Kinematic and Static Parameter Calculation:**\n    For each test case, defined by the projectile laboratory energy $E_{\\mathrm{lab}}$ and the target mass number $A$, we first compute several derived quantities.\n    - The nuclear radius is determined from the geometric parameter $r_0=1.25\\,\\mathrm{fm}$ via $R = r_0 A^{1/3}$.\n    - Non-relativistic two-body kinematics yield the reduced mass $\\mu = \\frac{m_N A}{1+A}$, the center-of-mass energy $E_{\\mathrm{cm}} = E_{\\mathrm{lab}} \\frac{A}{1+A}$, and the center-of-mass wave number $k = \\frac{\\sqrt{2 \\mu E_{\\mathrm{cm}}}}{\\hbar c}$. Here, $m_N = 938.92\\,\\mathrm{MeV}$ is the nucleon mass and $\\hbar c = 197.3269804\\,\\mathrm{MeV\\,fm}$ is the Planck constant-speed of light product. It is crucial to handle units consistently; masses and energies are in $\\mathrm{MeV}$, and distances are in $\\mathrm{fm}$. The derived wave number $k$ is in $\\mathrm{fm}^{-1}$.\n\n2.  **Nuclear Density and Scaling Factor $\\eta_A$:**\n    The nuclear matter distribution is modeled by a Woods–Saxon density profile, $\\rho(r) = \\rho_0 / (1 + \\exp((r - R)/a))$, with saturation density $\\rho_0 = 0.16\\,\\mathrm{fm^{-3}}$ and diffuseness $a = 0.55\\,\\mathrm{fm}$.\n    The dimensionless scaling coefficient $\\eta_A$ is a key component of the potential model. It is defined as a ratio of integrals over the density profile:\n    $$\n    \\eta_A \\equiv \\frac{\\displaystyle \\int_{0}^{\\infty} 4\\pi r^2 \\,\\rho(r)^2\\,dr}{\\rho_0 \\displaystyle \\int_{0}^{\\infty} 4\\pi r^2 \\,\\rho(r)\\,dr}\n    $$\n    These two integrals, representing a mean-square density moment and a term proportional to the total nucleon number, are computed numerically for each mass number $A$. High-precision numerical quadrature is used for this step, integrating from $r=0$ to $r=\\infty$.\n\n3.  **Optical Potential and Scattering Amplitude:**\n    The complex optical potential $U(r)$ is the core of the dynamic model. Its form is given as:\n    $$\n    U(r; C) = \\left[ V_0 (1 - C \\eta_A)\\right] \\left(\\frac{\\rho(r)}{\\rho_0}\\right)^{\\alpha} + i \\left[ W_0 (1 - C \\eta_A)\\right] \\left(\\frac{\\rho(r)}{\\rho_0}\\right)^{\\beta}\n    $$\n    where $V_0 = -40.0\\,\\mathrm{MeV}$ and $W_0 = -10.0\\,\\mathrm{MeV}$ are the potential depths, $\\alpha$ and $\\beta$ are density exponents specific to each case, and $C$ is the scaling parameter under investigation.\n\n    The scattering amplitude $f(\\theta)$ in the first Born approximation is calculated via the Fourier transform of this potential. The specified formula is:\n    $$\n    f(\\theta; C) = - \\frac{2 \\mu}{\\hbar^2 q}\\int_{0}^{\\infty} r \\, U(r; C) \\, \\sin(q r) \\, dr\n    $$\n    Here, the momentum transfer $q = 2k \\sin(\\theta/2)$ depends on the scattering angle $\\theta$. To perform this calculation, the integral is separated into real and imaginary parts corresponding to the real and imaginary parts of $U(r; C)$. Numerical integration is again employed to evaluate these oscillatory integrals for each angle specified in a test case. The prefactor $\\frac{2\\mu}{\\hbar^2}$ is evaluated as $\\frac{2\\mu}{(\\hbar c)^2}$ to ensure correct units of $\\mathrm{fm}^{-1}\\mathrm{MeV}^{-1}$. The resulting amplitude $f(\\theta)$ has units of length ($\\mathrm{fm}$).\n\n4.  **Differential Cross Section and $\\chi^2$ Analysis:**\n    The differential cross section, which represents the probability of scattering into a given solid angle, is given by the squared modulus of the scattering amplitude:\n    $$\n    \\frac{d\\sigma}{d\\Omega}(\\theta; C) = \\left| f(\\theta; C) \\right|^2\n    $$\n    The units are area per steradian, $\\mathrm{fm^2/sr}$. For each test case, this entire procedure is executed three times:\n    a.  First, with $C = C_{\\mathrm{ref}} = 0.15$ to generate the vector of synthetic reference cross sections, $\\sigma_{\\mathrm{ref}}(\\theta_i)$.\n    b.  Second, with the hypothesis $C = 0.00$ to generate the model predictions $\\sigma_{\\mathrm{mod}}(\\theta_i; C=0.00)$.\n    c.  Third, with the hypothesis $C = 0.25$ to generate $\\sigma_{\\mathrm{mod}}(\\theta_i; C=0.25)$.\n\n    A relative uncertainty of $5\\%$ is assumed for the reference data, so $\\delta(\\theta_i) = 0.05 \\, \\sigma_{\\mathrm{ref}}(\\theta_i)$. The reduced chi-squared, $\\tilde{\\chi}^2$, is then computed for each hypothesis:\n    $$\n    \\tilde{\\chi}^2(C) = \\frac{1}{N_{\\mathrm{data}}} \\sum_{i} \\left(\\frac{\\sigma_{\\mathrm{mod}}(\\theta_i; C) - \\sigma_{\\mathrm{ref}}(\\theta_i)}{\\delta(\\theta_i)}\\right)^2\n    $$\n    where $N_{\\mathrm{data}}$ is the number of angular data points.\n\n5.  **Final Result:**\n    The final reported quantity for each case is the difference between the reduced chi-squared values of the two hypotheses:\n    $$\n    \\Delta \\tilde{\\chi}^2 = \\tilde{\\chi}^2(C=0.00) - \\tilde{\\chi}^2(C=0.25)\n    $$\n    This value provides a quantitative measure of how much better the hypothesis $C=0.25$ fits the reference data compared to the hypothesis $C=0.00$. The procedure is repeated for all four test cases, and the resulting values of $\\Delta \\tilde{\\chi}^2$ are collected.",
            "answer": "```python\nimport numpy as np\nfrom scipy import integrate\n\ndef solve():\n    \"\"\"\n    Implements a computational test of density-dependent optical potentials for\n    elastic nucleon–nucleus scattering under the first Born approximation, as\n    specified in the problem description.\n    \"\"\"\n\n    # Global constants as per the problem statement\n    HBARC = 197.3269804      # MeV fm\n    M_N = 938.92             # MeV (interpreted as mass in energy units)\n    RHO_0 = 0.16             # fm^-3\n    V_0 = -40.0              # MeV\n    W_0 = -10.0              # MeV\n    R0 = 1.25                # fm\n    A_DIFF = 0.55            # fm (diffuseness parameter 'a')\n    \n    # Test cases: (mass_number, E_lab, alpha, beta, angles_deg)\n    test_cases = [\n        (40.0, 65.0, 1.0, 1.0, [10, 20, 30, 40, 60]),\n        (48.0, 65.0, 1.5, 1.0, [10, 20, 30, 40, 60]),\n        (208.0, 80.0, 1.0, 1.5, [5, 10, 20, 30, 40, 60]),\n        (16.0, 100.0, 1.0, 1.0, [10, 30, 50, 70]),\n    ]\n    \n    results = []\n\n    for mass_number, e_lab, alpha, beta, angles_deg in test_cases:\n        \n        # 1. Calculate derived kinematic and static parameters for the case\n        R_nucleus = R0 * mass_number**(1.0/3.0)\n        mu = M_N * mass_number / (1.0 + mass_number)\n        e_cm = e_lab * mass_number / (1.0 + mass_number)\n        k_wavenum = np.sqrt(2.0 * mu * e_cm) / HBARC\n\n        # 2. Define density function and calculate eta_A\n        def rho(r):\n            if r  0: return 0.0 # Guard for numerical stability\n            return RHO_0 / (1.0 + np.exp((r - R_nucleus) / A_DIFF))\n        \n        def eta_num_integrand(r):\n            rho_val = rho(r)\n            return 4.0 * np.pi * r**2 * rho_val**2\n        \n        def eta_den_integrand(r):\n            return 4.0 * np.pi * r**2 * rho(r)\n\n        eta_num_integral, _ = integrate.quad(eta_num_integrand, 0, np.inf)\n        eta_den_integral_part, _ = integrate.quad(eta_den_integrand, 0, np.inf)\n        \n        eta_A = eta_num_integral / (RHO_0 * eta_den_integral_part)\n        \n        # 3. Define a function to compute cross sections for a given C_val\n        def get_cross_sections(C_val):\n            \n            def U_real(r):\n                # Real part of the optical potential\n                return V_0 * (1.0 - C_val * eta_A) * (rho(r) / RHO_0)**alpha\n\n            def U_imag(r):\n                # Imaginary part of the optical potential\n                return W_0 * (1.0 - C_val * eta_A) * (rho(r) / RHO_0)**beta\n            \n            cross_sections = []\n            for angle_deg in angles_deg:\n                angle_rad = np.deg2rad(angle_deg)\n                \n                # Momentum transfer q. Handle theta=0 case separately.\n                if angle_rad == 0.0:\n                    q = 0.0\n                else:\n                    q = 2.0 * k_wavenum * np.sin(angle_rad / 2.0)\n                \n                # Born amplitude formula is different for q=0 vs q!=0\n                if q == 0.0:\n                    # Use j0 form: f = -2*mu/hbar^2 * Int[r^2*U(r)*j0(q*r)*dr]. j0(0)=1\n                    def f_integrand_real(r): return r**2 * U_real(r)\n                    def f_integrand_imag(r): return r**2 * U_imag(r)\n                    \n                    integral_real, _ = integrate.quad(f_integrand_real, 0, np.inf)\n                    integral_imag, _ = integrate.quad(f_integrand_imag, 0, np.inf)\n                    \n                    prefactor = -2.0 * mu / (HBARC**2)\n                    f_real = prefactor * integral_real\n                    f_imag = prefactor * integral_imag\n                else:\n                    # Use sin(qr)/q form: f = -2*mu/(hbar^2*q) * Int[r*U(r)*sin(q*r)*dr]\n                    def f_integrand_real(r): return r * U_real(r) * np.sin(q * r)\n                    def f_integrand_imag(r): return r * U_imag(r) * np.sin(q * r)\n                \n                    integral_real, _ = integrate.quad(f_integrand_real, 0, np.inf)\n                    integral_imag, _ = integrate.quad(f_integrand_imag, 0, np.inf)\n                    \n                    prefactor = -2.0 * mu / (HBARC**2 * q)\n                    f_real = prefactor * integral_real\n                    f_imag = prefactor * integral_imag\n                \n                dsig_dOmega = f_real**2 + f_imag**2\n                cross_sections.append(dsig_dOmega)\n            \n            return np.array(cross_sections)\n            \n        # 4. Generate reference data and compute chi-squared for hypotheses\n        C_ref = 0.15\n        sigma_ref = get_cross_sections(C_ref)\n        delta_sigma = 0.05 * sigma_ref\n        \n        # Hypothesis C=0.00\n        C1 = 0.00\n        sigma_mod1 = get_cross_sections(C1)\n        chi2_1 = np.sum(((sigma_mod1 - sigma_ref) / delta_sigma)**2)\n        chi2_tilde_1 = chi2_1 / len(angles_deg)\n        \n        # Hypothesis C=0.25\n        C2 = 0.25\n        sigma_mod2 = get_cross_sections(C2)\n        chi2_2 = np.sum(((sigma_mod2 - sigma_ref) / delta_sigma)**2)\n        chi2_tilde_2 = chi2_2 / len(angles_deg)\n        \n        # 5. Calculate the final result for the case\n        delta_chi2_tilde = chi2_tilde_1 - chi2_tilde_2\n        results.append(delta_chi2_tilde)\n\n    # 6. Final output in the specified format\n    print(f\"[{','.join(f'{r:.6f}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}