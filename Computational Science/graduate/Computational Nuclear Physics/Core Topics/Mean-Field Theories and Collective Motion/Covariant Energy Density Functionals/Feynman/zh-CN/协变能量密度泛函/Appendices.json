{
    "hands_on_practices": [
        {
            "introduction": "协变能量密度泛函理论的核心在于求解一组非线性的自洽方程。本练习将指导你实现一个求解相对论平均场方程的核心迭代算法，并让你掌握在实践中对于确保收敛至关重要的混合与预处理等数值技术。通过这个练习 ，你将为更复杂的核结构计算打下坚实的计算基础。",
            "id": "3554475",
            "problem": "您需要为一个简化的协变平均场模型实现并分析一个自洽非线性不动点求解器，该模型基于协变能量密度泛函（CEDF）框架和相对论平均场（RMF）近似。计算任务是在给定的重子密度下，使用阻尼对角预处理迭代方法，求解自洽的标量有效质量，并量化在一系列轴向四极形变下的收敛性和稳定性。该问题完全以数学和算法术语提出，您必须全程遵守物理上一致的单位。\n\n基本基础包括以下在RMF近似下对冷的、均匀的、同位旋对称核物质广为接受的关系式：\n1. 重子密度由 $ \\rho_{B} = \\dfrac{\\gamma\\,k_{F}^{3}}{6\\pi^{2}} $ 给出，其中 $ \\gamma $ 是自旋-同位旋简并度，$ k_{F} $ 是费米动量。\n2. 标量密度由下式给出\n$$\n\\rho_{S}(m^{\\ast},k_{F}) = \\dfrac{\\gamma}{2\\pi^{2}} \\int_{0}^{k_{F}} \\dfrac{p^{2}\\,m^{\\ast}}{\\sqrt{p^{2} + m^{\\ast 2}}}\\,dp,\n$$\n其中 $ m^{\\ast} $ 是有效狄拉克质量，单位为逆费米。\n3. 自洽标量质量关系（Hartree水平，局域密度近似）为\n$$\nm^{\\ast} = m - C_{S}\\,\\rho_{S}(m^{\\ast},k_{F}),\n$$\n其中 $ m $ 是裸质量，单位为逆费米，$ C_{S} $ 是标量耦合常数组合 $ g_{S}^{2}/m_{S}^{2} $，单位为平方费米。\n4. 矢量势由下式给出\n$$\nv_{0} = C_{V}\\,\\rho_{B},\n$$\n其中 $ C_{V} = g_{V}^{2}/m_{V}^{2} $，单位为平方费米。\n5. 在自然单位制中，化学势（单粒子费米能）为\n$$\n\\mu = \\sqrt{k_{F}^{2} + m^{\\ast 2}} + v_{0}.\n$$\n\n您必须使用自然单位制，令 $ \\hbar = c = 1 $，保持动量和质量的单位为逆费米，密度的单位为逆立方费米（即 $ \\mathrm{fm}^{-3} $）。当以兆电子伏特报告任何类能量的量时，使用 $ \\hbar c = 197.3269804\\,\\mathrm{MeV\\,fm} $进行转换。\n\n$ m^{\\ast} $ 的非线性方程需要使用阻尼对角预处理不动点更新方法进行迭代求解\n$$\nm^{\\ast}_{n+1} = m^{\\ast}_{n} - \\alpha\\,P(m^{\\ast}_{n})\\,r(m^{\\ast}_{n}),\n$$\n其中 $ r(m^{\\ast}) = m^{\\ast} - m + C_{S}\\,\\rho_{S}(m^{\\ast},k_{F}) $ 是残差，$ \\alpha \\in (0,1] $ 是混合参数，$ P(m^{\\ast}) $ 是基于线性化的对角预处理器。残差的雅可比导数为\n$$\nJ(m^{\\ast}) = \\dfrac{dr}{dm^{\\ast}} = 1 + C_{S}\\,\\dfrac{d\\rho_{S}}{dm^{\\ast}},\n$$\n其中\n$$\n\\dfrac{d\\rho_{S}}{dm^{\\ast}} = \\dfrac{\\gamma}{2\\pi^{2}} \\int_{0}^{k_{F}} p^{2} \\left(\\dfrac{1}{\\sqrt{p^{2} + m^{\\ast 2}}} - \\dfrac{m^{\\ast 2}}{\\left(p^{2} + m^{\\ast 2}\\right)^{3/2}}\\right) dp.\n$$\n当启用预处理时，设置对角预处理器为 $ P(m^{\\ast}) = 1/J(m^{\\ast}) $；当禁用预处理时，设置 $ P(m^{\\ast}) = 1 $。\n\n使用绝对残差容差和相对变化容差共同定义收敛。设 $ |r(m^{\\ast})| $ 的绝对容差为 $ \\varepsilon_{\\mathrm{abs}} = 10^{-8}\\,\\mathrm{fm}^{-1} $，$ |m^{\\ast}_{n+1} - m^{\\ast}_{n}|/|m^{\\ast}_{n}| $ 的相对变化容差为 $ \\varepsilon_{\\mathrm{rel}} = 10^{-8} $。当两个标准都满足或达到最大迭代次数 $ N_{\\max} = 100 $ 时，求解器应停止。迭代稳定性可以通过局域谱半径因子来量化\n$$\n\\sigma = \\left|1 - \\alpha\\,P(m^{\\ast})\\,J(m^{\\ast})\\right|,\n$$\n该值在最后一次迭代时计算；如果 $ \\sigma < 1 $，则迭代是线性稳定的。\n\n为了在局域密度近似（LDA）下模拟跨轴向四极形变的形变效应，使用密度模型\n$$\n\\rho_{B}(\\beta_{2}) = \\rho_{0}\\,\\left(1 - c\\,\\beta_{2}^{2}\\right),\n$$\n其中 $ \\rho_{0} = 0.16\\,\\mathrm{fm}^{-3} $，$ c = 0.8 $，这提供了一个科学上合理的、随形变参数 $ \\beta_{2} $ 大小增加而局部密度单调减少的模型。\n\n使用的参数：\n- 裸核子质量：$ M = 939\\,\\mathrm{MeV} $，通过 $ m = M/(\\hbar c) $ 转换为逆费米。\n- 简并度：$ \\gamma = 4 $。\n- 标量耦合组合：$ C_{S} = 11.0\\,\\mathrm{fm}^{2} $。\n- 矢量耦合组合：$ C_{V} = 7.0\\,\\mathrm{fm}^{2} $。\n- 自然单位转换：$ \\hbar c = 197.3269804\\,\\mathrm{MeV\\,fm} $。\n\n您的程序必须实现：\n1. 计算 $ k_{F}(\\rho_{B}) = \\left(\\dfrac{6\\pi^{2}\\rho_{B}}{\\gamma}\\right)^{1/3} $。\n2. 对 $ \\rho_{S}(m^{\\ast},k_{F}) $ 和 $ \\dfrac{d\\rho_{S}}{dm^{\\ast}}(m^{\\ast},k_{F}) $ 进行数值积分。\n3. 具有指定混合和可选预处理的迭代求解器。\n4. 通过 $ \\sigma $ 进行收敛检测和稳定性量化。\n5. 报告有效质量比 $ M^{\\ast}/M $，其中 $ M^{\\ast} = m^{\\ast}\\,(\\hbar c) $。\n\n以 $ \\mathrm{MeV} $ 表示任何类能量的输出。以 $ \\mathrm{fm}^{-3} $ 表示密度。此问题中不出现角度。任何分数都应以小数形式提供。\n\n测试套件：\n评估求解器在以下四个测试用例下的表现，每个用例由一个元组 $ (\\beta_{2}, \\alpha, \\text{preconditioning}) $ 指定：\n1. $ (\\beta_{2} = 0.0, \\alpha = 0.7, \\text{preconditioning} = \\text{True}) $\n2. $ (\\beta_{2} = 0.3, \\alpha = 0.2, \\text{preconditioning} = \\text{True}) $\n3. $ (\\beta_{2} = -0.3, \\alpha = 1.0, \\text{preconditioning} = \\text{False}) $\n4. $ (\\beta_{2} = 0.6, \\alpha = 0.7, \\text{preconditioning} = \\text{True}) $\n\n对于每个测试用例，您的程序必须输出一个包含以下五个条目的列表：\n- 收敛状态（布尔值），\n- 迭代次数（整数），\n- 有效质量比 $ M^{\\ast}/M $（浮点数），\n- 稳定性状态（布尔值，指示 $ \\sigma < 1 $），\n- 谱半径因子 $ \\sigma $（浮点数）。\n\n最终输出格式：\n您的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表，其中每个测试用例的结果本身是按上述顺序排列的列表。例如，输出必须看起来像 $ [\\,[\\ldots],\\,[\\ldots],\\,[\\ldots],\\,[\\ldots]\\,] $。",
            "solution": "该问题设定在协变能量密度泛函（CEDF）框架内，并对冷的、均匀的核物质使用相对论平均场（RMF）近似。目标是纯粹基于已建立的公式，为标量有效质量 $ m^{\\ast} $ 构建一个自洽的迭代求解器。\n\n基本关系：\n- 在均匀物质中，重子密度 $ \\rho_{B} $ 和费米动量 $ k_{F} $ 满足 $ \\rho_{B} = \\dfrac{\\gamma\\,k_{F}^{3}}{6\\pi^{2}} $，这是在三维空间中用简并度 $ \\gamma $ 填充平面波态直至 $ k_{F} $ 的直接结果。求解 $ k_{F} $ 得到 $ k_{F} = \\left(\\dfrac{6\\pi^{2}\\rho_{B}}{\\gamma}\\right)^{1/3} $。\n- 标量密度 $ \\rho_{S} $ 源于占据态中标量双线性算符的期望值。在动量空间中，对于零温均匀物质，在自然单位制 $ \\hbar = c = 1 $ 下，它由 $ \\rho_{S}(m^{\\ast},k_{F}) = \\dfrac{\\gamma}{2\\pi^{2}} \\int_{0}^{k_{F}} \\dfrac{p^{2}\\,m^{\\ast}}{\\sqrt{p^{2} + m^{\\ast 2}}}\\,dp $ 给出。这个公式经过了充分检验，是RMF的Hartree近似的基础。\n- 平均场自洽性将有效质量等同于其裸质量减去标量场的贡献：$ m^{\\ast} = m - C_{S}\\,\\rho_{S}(m^{\\ast},k_{F}) $，其中 $ C_{S} = g_{S}^{2}/m_{S}^{2} $，单位为平方费米。这表达了单粒子动力学与介质产生的场之间的平衡。\n\n算法设计：\n1. 对于给定的轴向四极形变参数 $ \\beta_{2} $，将局部重子密度定义为 $ \\rho_{B}(\\beta_{2}) = \\rho_{0}\\,(1 - c\\,\\beta_{2}^{2}) $，其中 $ \\rho_{0} = 0.16\\,\\mathrm{fm}^{-3} $，$ c = 0.8 $。这个受局域密度近似（LDA）启发的简单模型反映了由于形变导致中心密度降低，同时保持了物理上的合理性。\n2. 计算 $ k_{F} = \\left(\\dfrac{6\\pi^{2}\\rho_{B}}{\\gamma}\\right)^{1/3} $，确保单位为逆费米。\n3. 构建非线性残差 $ r(m^{\\ast}) = m^{\\ast} - m + C_{S}\\,\\rho_{S}(m^{\\ast},k_{F}) $。该残差的根即为 $ m^{\\ast} $ 的自洽解。\n4. 实现标量密度的数值积分：\n   - $ \\rho_{S}(m^{\\ast},k_{F}) = \\dfrac{\\gamma}{2\\pi^{2}} \\int_{0}^{k_{F}} \\dfrac{p^{2}\\,m^{\\ast}}{\\sqrt{p^{2} + m^{\\ast 2}}}\\,dp $，\n   使用自适应积分法和适当的容差来处理 $ p = 0 $ 附近的可积行为。\n5. 对于对角预处理，通过对 $ r $ 求导来计算雅可比导数 $ J(m^{\\ast}) $：\n   - $ J(m^{\\ast}) = 1 + C_{S}\\,\\dfrac{d\\rho_{S}}{dm^{\\ast}} $，\n   标量密度的导数通过下式获得\n   - $ \\dfrac{d\\rho_{S}}{dm^{\\ast}} = \\dfrac{\\gamma}{2\\pi^{2}} \\int_{0}^{k_{F}} p^{2}\\left(\\dfrac{1}{\\sqrt{p^{2} + m^{\\ast 2}}} - \\dfrac{m^{\\ast 2}}{\\left(p^{2} + m^{\\ast 2}\\right)^{3/2}}\\right)dp $。\n   启用时，对角预处理器为 $ P(m^{\\ast}) = 1/J(m^{\\ast}) $；否则 $ P(m^{\\ast}) = 1 $。\n6. 使用阻尼不动点更新：\n   - $ m^{\\ast}_{n+1} = m^{\\ast}_{n} - \\alpha\\,P(m^{\\ast}_{n})\\,r(m^{\\ast}_{n}) $，\n   其中 $ \\alpha $ 是混合参数，控制步长，从而控制迭代的阻尼。\n7. 收敛标准有两方面：\n   - 绝对残差容差 $ |r(m^{\\ast})| \\le \\varepsilon_{\\mathrm{abs}} $，其中 $ \\varepsilon_{\\mathrm{abs}} = 10^{-8}\\,\\mathrm{fm}^{-1} $，\n   - 相对变化容差 $ \\left|m^{\\ast}_{n+1} - m^{\\ast}_{n}\\right|/\\left|m^{\\ast}_{n}\\right| \\le \\varepsilon_{\\mathrm{rel}} $，其中 $ \\varepsilon_{\\mathrm{rel}} = 10^{-8} $。\n   当两者都满足或达到最大迭代次数 $ N_{\\max} = 100 $ 时，迭代停止。\n8. 稳定性量化：\n   - 在不动点 $ m^{\\ast}_{\\star} $ 附近的线性化迭代具有放大因子 $ \\lambda = 1 - \\alpha\\,P(m^{\\ast}_{\\star})\\,J(m^{\\ast}_{\\star}) $，\n   - 谱半径因子 $ \\sigma = |\\lambda| $ 指示稳定性；如果 $ \\sigma < 1 $，迭代是线性稳定的。\n   此度量在最后一次迭代时计算，以提供关于所选 $ \\alpha $ 和预处理是否存在的稳健性诊断。\n\n物理单位与输出：\n- 通过 $ m = M/(\\hbar c) $ 将 $ M = 939\\,\\mathrm{MeV} $ 转换为逆费米，其中 $ \\hbar c = 197.3269804\\,\\mathrm{MeV\\,fm} $。\n- 求解后，报告 $ M^{\\ast}/M = (m^{\\ast}\\,\\hbar c)/M $，作为一个无量纲浮点数。\n- 矢量势 $ v_{0} = C_{V}\\,\\rho_{B} $ 和化学势 $ \\mu = \\sqrt{k_{F}^{2} + m^{\\ast 2}} + v_{0} $ 是可计算的，但最终输出中不需要。\n\n测试套件覆盖原理：\n- $ (\\beta_{2} = 0.0, \\alpha = 0.7, \\text{preconditioning} = \\text{True}) $: 一个典型的、在正常核密度附近表现良好的情况，用于测试“理想路径”。\n- $ (\\beta_{2} = 0.3, \\alpha = 0.2, \\text{preconditioning} = \\text{True}) $: 小的混合参数，以评估在阻尼下缓慢但稳定的收敛。\n- $ (\\beta_{2} = -0.3, \\alpha = 1.0, \\text{preconditioning} = \\text{False}) $: 无预处理的高混合参数，以探测潜在的不稳定性和收敛敏感性。\n- $ (\\beta_{2} = 0.6, \\alpha = 0.7, \\text{preconditioning} = \\text{True}) $: 较大的形变和降低的密度，以测试在更宽参数范围内的稳健性。\n\n最终输出格式：\n您的程序必须打印单行，包含一个用方括号括起来的逗号分隔列表，其中每个元素本身是一个列表，按顺序包含：收敛状态（布尔值）、迭代次数（整数）、有效质量比 $ M^{\\ast}/M $（浮点数）、稳定性状态（布尔值）和谱半径因子 $ \\sigma $（浮点数）。因此，输出将所有测试用例的结果聚合成一行，格式为 $ [\\,[\\cdot],\\,[\\cdot],\\,[\\cdot],\\,[\\cdot]\\,] $。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\n\n# Constants in natural units and physical parameters\nHC_MEV_FM = 197.3269804  # hbar*c in MeV*fm\nM_MEV = 939.0            # nucleon mass in MeV\nm_fm_inv = M_MEV / HC_MEV_FM  # bare mass in 1/fm\n\ngamma = 4.0              # spin-isospin degeneracy\nCS_fm2 = 11.0            # scalar coupling combination g_s^2/m_s^2 in fm^2\nCV_fm2 = 7.0             # vector coupling combination g_v^2/m_v^2 in fm^2\n\nrho0 = 0.16              # saturation density in fm^-3\nc_def = 0.8              # deformation density reduction coefficient\n\n# Convergence parameters\nEPS_ABS = 1e-8           # absolute residual tolerance in 1/fm\nEPS_REL = 1e-8           # relative change tolerance (dimensionless)\nMAX_ITER = 100           # maximum iterations\n\ndef kF_from_rho(rhoB: float) -> float:\n    \"\"\"Compute Fermi momentum k_F (1/fm) from baryon density rho_B (1/fm^3).\"\"\"\n    return ((6.0 * np.pi**2 * rhoB) / gamma) ** (1.0 / 3.0)\n\ndef rhoS(mstar: float, kF: float) -> float:\n    \"\"\"Compute scalar density rho_S (1/fm^3) for given m* (1/fm) and k_F (1/fm).\"\"\"\n    # Integrand: p^2 * m* / sqrt(p^2 + m*^2)\n    def integrand(p):\n        return (p**2) * (mstar) / np.sqrt(p**2 + mstar**2)\n    val, _ = quad(integrand, 0.0, kF, epsabs=1e-10, epsrel=1e-10, limit=200)\n    return (gamma / (2.0 * np.pi**2)) * val\n\ndef drhoS_dm(mstar: float, kF: float) -> float:\n    \"\"\"Compute derivative d rho_S / d m* (1/fm^2) at given m* and k_F.\"\"\"\n    # Integrand: p^2 * (1/E - m*^2 / E^3)\n    def integrand(p):\n        E = np.sqrt(p**2 + mstar**2)\n        return p**2 * (1.0 / E - (mstar**2) / (E**3))\n    val, _ = quad(integrand, 0.0, kF, epsabs=1e-10, epsrel=1e-10, limit=200)\n    return (gamma / (2.0 * np.pi**2)) * val\n\ndef residual(mstar: float, m_bare: float, kF: float) -> float:\n    \"\"\"Residual r(m*) = m* - m + C_S * rho_S(m*, kF). Units: 1/fm.\"\"\"\n    return mstar - m_bare + CS_fm2 * rhoS(mstar, kF)\n\ndef jacobian(mstar: float, kF: float) -> float:\n    \"\"\"Jacobian dr/dm* = 1 + C_S * d rho_S / d m*. Dimensionless.\"\"\"\n    return 1.0 + CS_fm2 * drhoS_dm(mstar, kF)\n\ndef vector_potential(rhoB: float) -> float:\n    \"\"\"Vector potential v0 in 1/fm.\"\"\"\n    return CV_fm2 * rhoB\n\ndef solve_case(beta2: float, alpha: float, use_precond: bool):\n    \"\"\"Solve for m* given beta2, mixing alpha, and preconditioning flag.\"\"\"\n    # Local density model\n    rhoB = rho0 * (1.0 - c_def * (beta2 ** 2))\n    kF = kF_from_rho(rhoB)\n\n    # Initial guess: start from bare mass\n    mstar = m_fm_inv\n    converged = False\n    iterations = 0\n\n    # Iteration\n    for it in range(1, MAX_ITER + 1):\n        r = residual(mstar, m_fm_inv, kF)\n        J = jacobian(mstar, kF)\n        P = (1.0 / J) if use_precond else 1.0\n\n        # Update with mixing and (optional) preconditioning\n        m_next = mstar - alpha * P * r\n\n        # Check convergence criteria\n        abs_ok = abs(r) = EPS_ABS\n        rel_ok = abs(m_next - mstar) / max(abs(mstar), 1e-16) = EPS_REL\n\n        iterations = it\n        mstar = m_next\n\n        if abs_ok and rel_ok:\n            converged = True\n            break\n\n    # Compute stability measure at last iterate\n    J_final = jacobian(mstar, kF)\n    P_final = (1.0 / J_final) if use_precond else 1.0\n    spectral_radius = abs(1.0 - alpha * P_final * J_final)\n    is_stable = spectral_radius  1.0\n\n    # Effective mass ratio M*/M\n    Mstar_M_ratio = (mstar * HC_MEV_FM) / M_MEV\n\n    return [converged, iterations, float(Mstar_M_ratio), is_stable, float(spectral_radius)]\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (0.0, 0.7, True),\n        (0.3, 0.2, True),\n        (-0.3, 1.0, False),\n        (0.6, 0.7, True),\n    ]\n\n    results = []\n    for beta2, alpha, precond in test_cases:\n        result = solve_case(beta2, alpha, precond)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # Print as a single comma-separated list of lists enclosed in square brackets.\n    def format_elem(elem):\n        if isinstance(elem, list):\n            return \"[\" + \",\".join(format_elem(x) for x in elem) + \"]\"\n        elif isinstance(elem, bool):\n            return \"True\" if elem else \"False\"\n        else:\n            return str(elem)\n\n    print(\"[\" + \",\".join(format_elem(r) for r in results) + \"]\")\n\nsolve()\n```"
        },
        {
            "introduction": "理解协变能量密度泛函的一个重要方面是它如何与更传统的非相对论模型（如Skyrme泛函）相联系。在此练习  中，你将通过对一个简单的协变点耦合泛函进行非相对论展开，来揭示非相对论模型中关键项（如自旋轨道势）的相对论起源。这有助于加深你对核力有效理论的统一认识。",
            "id": "3554423",
            "problem": "考虑哈特里（Hartree，无福克交换）近似中的协变点耦合能量密度泛函（Energy Density Functional, EDF），该泛函具有同位旋标量-标量、同位旋标量-矢量和同位旋矢量-矢量接触通道。质量为 $m$ 的核子场 $\\psi$ 的拉格朗日密度为\n$$\n\\mathcal{L} \\;=\\; \\bar{\\psi}\\big(i\\gamma^{\\mu}\\partial_{\\mu} - m\\big)\\psi \\;-\\; \\frac{1}{2}\\alpha_{S}\\big(\\bar{\\psi}\\psi\\big)^{2} \\;-\\; \\frac{1}{2}\\alpha_{V}\\big(\\bar{\\psi}\\gamma_{\\mu}\\psi\\big)\\big(\\bar{\\psi}\\gamma^{\\mu}\\psi\\big) \\;-\\; \\frac{1}{2}\\alpha_{TV}\\big(\\bar{\\psi}\\gamma_{\\mu}\\vec{\\tau}\\psi\\big)\\cdot\\big(\\bar{\\psi}\\gamma^{\\mu}\\vec{\\tau}\\psi\\big),\n$$\n其中 $\\alpha_{S}$ 是同位旋标量-标量耦合，$\\alpha_{V}$ 是同位旋标量-矢量耦合，$\\alpha_{TV}$ 是同位旋矢量-矢量耦合。在静态系统和平均场水平上，核子受到一个洛伦兹标量场 $S$ 和一个类时矢量场 $V^{0}_{q}$ 的作用，\n$$\nS \\;=\\; \\alpha_{S}\\,\\rho_{S}, \\qquad V^{0}_{q} \\;=\\; \\alpha_{V}\\,\\rho \\;+\\; \\alpha_{TV}\\,t_{q}\\,\\rho_{1},\n$$\n其中 $q\\in\\{n,p\\}$ 标记中子和质子，$t_{n}=+1$，$t_{p}=-1$，同位旋标量（重子）密度为 $\\rho=\\rho_{n}+\\rho_{p}$，同位旋矢量密度为 $\\rho_{1}=\\rho_{n}-\\rho_{p}$，标量密度为 $\\rho_{S}=\\langle\\bar{\\psi}\\psi\\rangle$。假设系统是时间反演不变且缓慢变化的，因此空间矢量流为零且梯度很小。在梯度展开和 $|S|/m$ 的领头阶进行计算，并在分母中用 $m$ 替换 $m^{\\ast}=m+S$。\n\n1) 从背景场 $S$ 和 $V^{0}_{q}$ 中的狄拉克（Dirac）方程出发，进行福迪-沃特海森（Foldy–Wouthuysen, FW）约化至 $1/m^{2}$ 阶，并提取该阶的单粒子非相对论哈密顿量。证明同位旋为 $q$ 的核子的自旋-轨道算符在梯度和 $|S|/m$ 的领头阶，并在此阶使用 $\\rho_{S}\\approx \\rho$ 时，其形式为\n$$\n\\hat{H}_{\\mathrm{so}}^{(q)} \\;=\\; \\frac{1}{4m^{2}}\\Big[\\nabla\\big(V^{0}_{q}-S\\big)\\times\\hat{\\mathbf{p}}\\Big]\\cdot\\boldsymbol{\\sigma},\n$$\n在梯度和 $|S|/m$ 的领头阶，并在此阶使用近似 $\\rho_{S}\\approx \\rho$。\n\n2) 在标准的非相对论斯格明（Skyrme）型能量密度泛函中，能量密度的时间偶自旋-轨道部分和张量部分写为\n$$\n\\mathcal{E}_{\\mathrm{so}} \\;=\\; -\\sum_{t=0,1} C_{t}^{\\nabla J}\\,\\rho_{t}\\,\\nabla\\cdot\\mathbf{J}_{t}, \n\\qquad\n\\mathcal{E}_{T} \\;=\\; \\sum_{t=0,1} C_{t}^{J}\\,\\mathbf{J}_{t}^{2},\n$$\n其中同位旋标量密度 $\\rho_{0}=\\rho_{n}+\\rho_{p}$ 和同位旋矢量密度 $\\rho_{1}=\\rho_{n}-\\rho_{p}$，相应的自旋-轨道（自旋流）密度为 $\\mathbf{J}_{0}=\\mathbf{J}_{n}+\\mathbf{J}_{p}$ 和 $\\mathbf{J}_{1}=\\mathbf{J}_{n}-\\mathbf{J}_{p}$。通过泛函变分，核子种类 $q$ 的单粒子自旋-轨道场为\n$$\n\\mathbf{W}_{q} \\;=\\; 2\\,C_{0}^{\\nabla J}\\,\\nabla\\rho \\;+\\; 2\\,t_{q}\\,C_{1}^{\\nabla J}\\,\\nabla\\rho_{1},\n$$\n由此得到的单粒子自旋-轨道算符为\n$$\n\\hat{H}_{\\mathrm{so}}^{(q)} \\;=\\; \\frac{1}{2}\\Big[\\mathbf{W}_{q}\\times\\hat{\\mathbf{p}}\\Big]\\cdot\\boldsymbol{\\sigma}\n\\;=\\; \\Big[C_{0}^{\\nabla J}\\,\\nabla\\rho \\;+\\; t_{q}\\,C_{1}^{\\nabla J}\\,\\nabla\\rho_{1}\\Big]\\times\\hat{\\mathbf{p}}\\cdot\\boldsymbol{\\sigma}.\n$$\n\n3) 通过将第1部分中协变FW约化得到的自旋-轨道算符与第2部分中的斯格明自旋-轨道算符进行比较，确定斯格明自旋-轨道耦合常数 $C_{0}^{\\nabla J}$ 和 $C_{1}^{\\nabla J}$ 与协变耦合 $\\alpha_{S}$、$\\alpha_{V}$、$\\alpha_{TV}$ 以及核子质量 $m$ 之间的显式映射关系。在所述假设和指定阶数下，同时确定由此协变点耦合EDF生成的斯格明张量耦合 $C_{0}^{J}$ 和 $C_{1}^{J}$。将您的最终结果清晰地表述为一个 $1\\times 4$ 的行矩阵\n$$\n\\big(C_{0}^{\\nabla J}\\;\\; C_{1}^{\\nabla J}\\;\\; C_{0}^{J}\\;\\; C_{1}^{J}\\big).\n$$\n\n请以精确的符号表达式给出您的最终答案；不需要数值或四舍五入。定义您引入的任何符号，并在首次使用时写出首字母缩略词的全称，例如能量密度泛函（Energy Density Functional, EDF）和福迪-沃特海森（Foldy–Wouthuysen, FW）。",
            "solution": "该问题要求通过从一个母协变点耦合能量密度泛函（EDF）进行映射，来确定非相对论斯格明（Skyrme）型能量密度泛函（EDF）的特定耦合常数。解答过程遵循问题陈述中列出的三个逻辑步骤。首字母缩略词将在首次使用时定义，例如福迪-沃特海森（Foldy-Wouthuysen, FW）。\n\n第1部分：非相对论自旋-轨道算符的推导。\n\n出发点是问题中给出的质量为 $m$ 的核子场 $\\psi$ 的相对论拉格朗日密度：\n$$\n\\mathcal{L} \\;=\\; \\bar{\\psi}\\big(i\\gamma^{\\mu}\\partial_{\\mu} - m\\big)\\psi \\;-\\; \\frac{1}{2}\\alpha_{S}\\big(\\bar{\\psi}\\psi\\big)^{2} \\;-\\; \\frac{1}{2}\\alpha_{V}\\big(\\bar{\\psi}\\gamma_{\\mu}\\psi\\big)\\big(\\bar{\\psi}\\gamma^{\\mu}\\psi\\big) \\;-\\; \\frac{1}{2}\\alpha_{TV}\\big(\\bar{\\psi}\\gamma_{\\mu}\\vec{\\tau}\\psi\\big)\\cdot\\big(\\bar{\\psi}\\gamma^{\\mu}\\vec{\\tau}\\psi\\big)\n$$\n在静态、时间反演不变系统的哈特里（Hartree，平均场）近似中，多体自能被局域的、依赖于密度的势所取代。从该拉格朗日量推导出的同位旋为 $q$（其中 $q \\in \\{n,p\\}$）的单个核子的运动方程是狄拉克（Dirac）方程：\n$$\n\\big[i\\gamma^{\\mu}\\partial_{\\mu} - m - \\Sigma^{(q)}\\big]\\psi_q = 0\n$$\n自能 $\\Sigma^{(q)}$ 是通过相互作用能量密度的泛函变分得到的。对于给定的拉格朗日量，自能由洛伦兹标量部分 $S$ 和类时洛伦兹矢量部分 $V_q^0$ 组成：\n$$\n\\Sigma^{(q)} = S - \\gamma^{0}V_{q}^{0}\n$$\n其中 $S = \\alpha_{S}\\rho_{S}$ 且 $V_{q}^{0} = \\alpha_{V}\\rho + \\alpha_{TV}t_{q}\\rho_{1}$。这些密度分别是标量密度 $\\rho_{S} = \\langle\\bar{\\psi}\\psi\\rangle$、重子密度 $\\rho = \\langle\\psi^{\\dagger}\\psi\\rangle$ 和同位旋矢量密度 $\\rho_{1} = \\rho_n - \\rho_p$。在具有时间反演不变性的静态系统中，矢量自能的空间分量为零。\n狄拉克方程可以写成哈密顿形式 $i\\partial_t \\psi_q = \\hat{H}_{D}^{(q)}\\psi_q$，其单粒子狄拉克哈密顿量为：\n$$\n\\hat{H}_{D}^{(q)} = \\vec{\\alpha} \\cdot \\hat{\\mathbf{p}} + \\beta (m+S) + V_{q}^{0}\n$$\n这里我们使用了 $\\gamma^0 = \\beta$、$\\vec{\\gamma} = \\beta\\vec{\\alpha}$ 和 $\\hat{\\mathbf{p}} = -i\\vec{\\nabla}$。标量场 $S$ 与质量项耦合，定义了一个有效质量 $m^{\\ast} = m+S$。\n\n为了获得非相对论哈密顿量，我们对 $\\hat{H}_{D}^{(q)}$ 进行福迪-沃特海森（FW）约化。对于这种形式的狄拉克哈密顿量，FW变换展开到 $1/m^2$ 阶的标准结果给出了一个自旋-轨道项，形式如下：\n$$\n\\hat{H}_{\\mathrm{so}} = \\frac{1}{4(m+S)^2} \\Big[\\vec{\\nabla}V_{q}^{0} \\times \\hat{\\mathbf{p}}\\Big]\\cdot\\boldsymbol{\\sigma} - \\frac{1}{4(m+S)^2} \\Big[\\vec{\\nabla}S \\times \\hat{\\mathbf{p}}\\Big]\\cdot\\boldsymbol{\\sigma}\n$$\n问题指明，我们在 $|S|/m$ 的领头阶进行计算，并在分母中用裸质量 $m$ 替换有效质量 $m^\\ast = m+S$。应用这个近似，我们得到：\n$$\n\\hat{H}_{\\mathrm{so}}^{(q)} \\approx \\frac{1}{4m^2} \\Big[\\vec{\\nabla}V_{q}^{0} \\times \\hat{\\mathbf{p}}\\Big]\\cdot\\boldsymbol{\\sigma} - \\frac{1}{4m^2} \\Big[\\vec{\\nabla}S \\times \\hat{\\mathbf{p}}\\Big]\\cdot\\boldsymbol{\\sigma}\n$$\n合并各项，我们得到问题陈述中所要求的形式：\n$$\n\\hat{H}_{\\mathrm{so}}^{(q)} = \\frac{1}{4m^{2}}\\Big[\\nabla\\big(V^{0}_{q}-S\\big)\\times\\hat{\\mathbf{p}}\\Big]\\cdot\\boldsymbol{\\sigma}\n$$\n这完成了第1部分所要求的证明。\n\n第2和第3部分：与斯格明EDF的比较及耦合常数的确定。\n\n为了将此结果与斯格明参数化进行比较，我们首先用重子密度和同位旋矢量密度来表示场 $V_q^0$ 和 $S$。问题陈述中要求在所考虑的阶数上使用近似 $\\rho_{S} \\approx \\rho$。这个近似是合理的，因为领头阶非相对论约化给出了 $\\rho_S = \\rho - O(p^2/m^2)$。\n据此，标量场为 $S \\approx \\alpha_S \\rho$。自旋-轨道势的梯度变为：\n$$\n\\nabla(V_q^0 - S) \\approx \\nabla(\\alpha_V \\rho + \\alpha_{TV} t_q \\rho_1 - \\alpha_S \\rho) = (\\alpha_V - \\alpha_S)\\nabla\\rho + \\alpha_{TV} t_q \\nabla\\rho_1\n$$\n将此代入我们的自旋-轨道哈密顿量表达式中，得到：\n$$\n\\hat{H}_{\\mathrm{so}}^{(q)} = \\frac{1}{4m^2} \\Big[ \\big( (\\alpha_V - \\alpha_S)\\nabla\\rho + \\alpha_{TV}t_q\\nabla\\rho_1 \\big) \\times \\hat{\\mathbf{p}} \\Big]\\cdot\\boldsymbol{\\sigma}\n$$\n这可以重新排列以突出密度梯度的系数：\n$$\n\\hat{H}_{\\mathrm{so}}^{(q)} = \\left[ \\frac{\\alpha_V - \\alpha_S}{4m^2}\\nabla\\rho + t_q \\frac{\\alpha_{TV}}{4m^2}\\nabla\\rho_1 \\right] \\times \\hat{\\mathbf{p}} \\cdot \\boldsymbol{\\sigma}\n$$\n现在，我们将其与问题第2部分中给出的、来自一个通用斯格明EDF的单粒子自旋-轨道算符进行比较：\n$$\n\\hat{H}_{\\mathrm{so}}^{(q)} = \\Big[C_{0}^{\\nabla J}\\,\\nabla\\rho \\;+\\; t_{q}\\,C_{1}^{\\nabla J}\\,\\nabla\\rho_{1}\\Big]\\times\\hat{\\mathbf{p}}\\cdot\\boldsymbol{\\sigma}\n$$\n通过令相应项（$\\nabla\\rho$ 和 $t_q\\nabla\\rho_1$）的系数相等，我们找到了斯格明自旋-轨道耦合常数的映射关系：\n$$\nC_{0}^{\\nabla J} = \\frac{\\alpha_V - \\alpha_S}{4m^2} \\qquad \\text{和} \\qquad C_{1}^{\\nabla J} = \\frac{\\alpha_{TV}}{4m^2}\n$$\n接下来，我们必须确定斯格明张量耦合 $C_0^J$ 和 $C_1^J$，它们是能量密度中自旋流项 $\\mathcal{E}_T = \\sum_{t=0,1} C_t^J \\mathbf{J}_t^2$ 的系数。这些项依赖于自旋流密度 $\\mathbf{J}_q$。\n在非相对论框架中，这类项通常源于涉及自旋算符的相互作用。在相对论框架中，我们必须在哈特里近似下审视所提供的拉格朗日量。相互作用项包含标量-标量和矢量-矢量类型的四费米子顶点。矢量部分为 $\\big(\\bar{\\psi}\\gamma_{\\mu}\\psi\\big)\\big(\\bar{\\psi}\\gamma^{\\mu}\\psi\\big) = (\\bar{\\psi}\\gamma_0\\psi)^2 - (\\bar{\\psi}\\vec{\\gamma}\\psi)^2$。\n在静态、时间反演不变系统的哈特里平均场理论中，算符被其期望值所取代。重子密度 $\\rho = \\langle\\bar{\\psi}\\gamma_0\\psi\\rangle$ 的期望值非零，但空间矢量流（重子流）$\\vec{j} = \\langle\\bar{\\psi}\\vec{\\gamma}\\psi\\rangle$ 的期望值为零。同样的道理也适用于同位旋矢量流。\n因此，在哈特里水平上，相互作用拉格朗日量中涉及空间矢量流的项，例如 $(\\bar{\\psi}\\vec{\\gamma}\\psi)^2$ 和 $(\\bar{\\psi}\\vec{\\gamma}\\vec{\\tau}\\psi)^2$，对能量密度没有贡献。自旋流密度 $\\mathbf{J}$ 与相对论赝矢量流空间部分的非相对论极限有关，但所提供的拉格朗日量不包含基本的赝矢量或张量耦合。上面推导出的自旋-轨道相互作用纯粹源于狄拉克粒子在标量和矢量势中的相对论运动学，而非来自显式的自旋依赖相互作用顶点。\n由于所指定的协变模型在哈特里水平上不会在能量密度中生成任何关于自旋流密度 $\\mathbf{J}$ 的二次项，因此相应的斯格明耦合必须为零。\n因此，我们得出结论：\n$$\nC_{0}^{J} = 0 \\qquad \\text{和} \\qquad C_{1}^{J} = 0\n$$\n综合所有四个结果，我们可以将最终答案写成所要求的 $1 \\times 4$ 行矩阵。\n$$\n\\big(C_{0}^{\\nabla J}\\;\\; C_{1}^{\\nabla J}\\;\\; C_{0}^{J}\\;\\; C_{1}^{J}\\big) = \\left(\\frac{\\alpha_V - \\alpha_S}{4m^2} \\;\\; \\frac{\\alpha_{TV}}{4m^2} \\;\\; 0 \\;\\; 0\\right)\n$$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{\\alpha_{V} - \\alpha_{S}}{4m^{2}}  \\frac{\\alpha_{TV}}{4m^{2}}  0  0 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在平均场图像之外，对关联是描述开壳核性质的关键。本练习  将引导你处理在对能计算中引入的非物理截断能，并实现一个重整化方案，以确保诸如分离能和半径等物理可观测量不依赖于此截断能。这个实践将向你展示如何通过消除模型中非物理参数的依赖性，来获得有意义的物理预测。",
            "id": "3554465",
            "problem": "考虑一个简化的、球对称的协变能量密度泛函对偶偶核的描述，其中对关联通过 Bardeen–Cooper–Schrieffer (BCS) 方法处理，该方法使用由能量截断调节的零程相互作用。单粒子谱被视为一组固定的离散能级，具有能量 $\\{\\epsilon_k\\}$、壳层简并度 $\\{g_k\\}$ 和各能级特定的半径平方 $\\{r_k^2\\}$，所有这些都与对截断无关。对作用仅在化学势周围宽度为 $2\\Lambda$ 的能量窗口内起作用，并且运行的对强度 $G(\\Lambda)$ 可能依赖于 $\\Lambda$。$k$ 能级的占据几率为 $v_k^2$，准粒子能量为 $E_k = \\sqrt{(\\epsilon_k - \\mu)^2 + \\Delta^2}$，其中 $\\mu$ 是化学势，$\\Delta$ 是对能隙。BCS 数方程为\n$$\nN \\;=\\; \\sum_{k} g_k \\, v_k^2, \\quad v_k^2 \\;=\\; \\frac{1}{2}\\left(1 - \\frac{\\epsilon_k - \\mu}{E_k}\\right),\n$$\n以及带有尖锐能量截断的 BCS 能隙方程为\n$$\n\\frac{1}{G(\\Lambda)} \\;=\\; \\sum_{k: \\, |\\epsilon_k - \\mu| \\le \\Lambda} \\frac{g_k}{2\\,E_k}.\n$$\n我们考虑平均场近似下的双中子分离能 $S_{2n}$，其值为化学势的两倍，\n$$\nS_{2n} \\;\\approx\\; 2\\,\\mu,\n$$\n以及由占据数定义的物质均方根半径，\n$$\n\\langle r^2 \\rangle \\;=\\; \\frac{\\sum_k g_k \\, v_k^2 \\, r_k^2}{N}, \\qquad r_{\\mathrm{rms}} \\;=\\; \\sqrt{\\langle r^2 \\rangle}.\n$$\n\n您的任务是研究由 $S_{2n}$ 量化的滴线预测以及半径对对截断 $\\Lambda$ 的敏感性，并实现一个重整化方案，该方案在 $\\Lambda$ 变化时保持 $S_{2n}$ 和 $r_{\\mathrm{rms}}$ 不变。重整化方案必须通过适当地运行 $G(\\Lambda)$ 来强制一个固定的目标能隙 $\\Delta_0$，而 $\\mu$ 由数方程确定。相反，非重整化方案将 $G$ 固定在一个在指定参考截断下确定的参考值。\n\n使用以下离散谱和参数，这些参数对所有测试用例都是通用的：\n- 由 $k=0,1,\\dots,49$ 索引的能级，能量以 $\\mathrm{MeV}$ 为单位，由 $\\epsilon_k = -25 + k$ 给出。\n- 所有 $k$ 的简并度 $g_k = 2$。\n- 半径平方以 $\\mathrm{fm}^2$ 为单位，由 $r_k^2 = 9.0 + 0.04\\,(\\epsilon_k + 25)$ 给出。\n\n定义以下算法和可观测量：\n- 针对给定原子核 $(N)$ 和截断 $\\Lambda$ 的重整化方案：\n  1. 强制固定目标能隙 $\\Delta = \\Delta_0$ (以 $\\mathrm{MeV}$ 为单位)。\n  2. 从此 $\\Delta$ 处的 BCS 数方程确定 $\\mu$。\n  3. 从此 $\\mu$ 和 $\\Delta$ 处的能隙方程计算 $G(\\Lambda)$。\n  4. 计算 $S_{2n} = 2\\mu$ (以 $\\mathrm{MeV}$ 为单位) 和 $r_{\\mathrm{rms}}$ (以 $\\mathrm{fm}$ 为单位)。\n- 针对给定原子核 $(N)$ 和截断 $\\Lambda$ 的非重整化方案：\n  1. 将 $G$ 固定为参考值 $G_{\\mathrm{ref}}$，该值是在强制 $\\Delta = \\Delta_0$ 时为参考原子核 $N_{\\mathrm{ref}}$ 在参考截断 $\\Lambda_{\\mathrm{ref}}$ 处获得的。\n  2. 对于目标原子核 $(N)$ 和选定的 $\\Lambda$，联立求解 BCS 数方程和能隙方程以得到 $(\\mu, \\Delta)$。\n  3. 计算 $S_{2n} = 2\\mu$ 和 $r_{\\mathrm{rms}}$。\n\n使用以下数值：\n- 目标能隙 $\\Delta_0 = 1.2$ $\\mathrm{MeV}$。\n- 参考截断 $\\Lambda_{\\mathrm{ref}} = 20$ $\\mathrm{MeV}$。\n- 参考原子核 $N_{\\mathrm{ref}} = 52$。\n- 截断集合 $\\Lambda \\in \\{5, 10, 20\\}$ $\\mathrm{MeV}$。\n\n由中子数定义的测试组原子核：\n- 情况 A: $N = 44$ (中间，“理想路径”)。\n- 情况 B: $N = 52$ (参考原子核，一致性检查)。\n- 情况 C: $N = 60$ (接近边缘，占据数更大，更敏感)。\n\n对于每个测试用例原子核和集合中的每个截断，计算重整化和非重整化的可观测量。对于每种方案，计算截断集合中相对于该原子核在参考截断 $\\Lambda_{\\mathrm{ref}}$ 处的值的最大绝对偏差：\n- $\\max_{\\Lambda \\in \\{5,10,20\\}} |S_{2n}(\\Lambda) - S_{2n}(\\Lambda_{\\mathrm{ref}})|$，以 $\\mathrm{MeV}$ 为单位。\n- $\\max_{\\Lambda \\in \\{5,10,20\\}} |r_{\\mathrm{rms}}(\\Lambda) - r_{\\mathrm{rms}}(\\Lambda_{\\mathrm{ref}})|$，以 $\\mathrm{fm}$ 为单位。\n\n您的程序必须生成单行输出，其中包含十二个浮点数，以逗号分隔的列表形式并用方括号括起来，顺序如下：\n- 情况 A 的重整化方案偏差：$[dS_{2n}^{\\mathrm{ren}}(A), d r_{\\mathrm{rms}}^{\\mathrm{ren}}(A)]$，\n- 情况 B 的重整化方案偏差：$[dS_{2n}^{\\mathrm{ren}}(B), d r_{\\mathrm{rms}}^{\\mathrm{ren}}(B)]$，\n- 情况 C 的重整化方案偏差：$[dS_{2n}^{\\mathrm{ren}}(C), d r_{\\mathrm{rms}}^{\\mathrm{ren}}(C)]$，\n- 情况 A 的非重整化方案偏差：$[dS_{2n}^{\\mathrm{unren}}(A), d r_{\\mathrm{rms}}^{\\mathrm{unren}}(A)]$，\n- 情况 B 的非重整化方案偏差：$[dS_{2n}^{\\mathrm{unren}}(B), d r_{\\mathrm{rms}}^{\\mathrm{unren}}(B)]$，\n- 情况 C 的非重整化方案偏差：$[dS_{2n}^{\\mathrm{unren}}(C), d r_{\\mathrm{rms}}^{\\mathrm{unren}}(C)]$。\n\n角度单位不适用。能量必须以 $\\mathrm{MeV}$ 为单位处理，半径以 $\\mathrm{fm}$ 为单位处理。最终输出必须严格遵守指定的单行格式。设计您的代码以稳健地求解非线性方程，确保给定测试组的数值稳定性，并处理在小截断下能隙方程可能变得刚性的边界条件。不允许外部输入；所有数据必须在程序中定义。",
            "solution": "用户提供了一个关于 Bardeen–Cooper–Schrieffer (BCS) 对关联模型的计算核物理问题。该问题已根据所需标准进行了验证。\n\n### 步骤 1：提取给定信息\n- **模型框架**：用于偶偶核的球对称协变能量密度泛函。对通过BCS方法处理，使用零程相互作用和尖锐能量截断 $\\Lambda$。\n- **单粒子谱**：一组固定的、由 $k \\in \\{0, 1, \\dots, 49\\}$ 索引的离散能级。\n    - 能量：$\\epsilon_k = -25 + k$（单位 MeV）。\n    - 简并度：所有 $k$ 的 $g_k = 2$。\n    - 半径平方：$r_k^2 = 9.0 + 0.04(\\epsilon_k + 25)$（单位 fm²）。\n- **BCS 方程**：\n    - 准粒子能量：$E_k = \\sqrt{(\\epsilon_k - \\mu)^2 + \\Delta^2}$。\n    - 占据几率：$v_k^2 = \\frac{1}{2}\\left(1 - \\frac{\\epsilon_k - \\mu}{E_k}\\right)$。\n    - 数方程：$N = \\sum_{k} g_k v_k^2$。\n    - 能隙方程：$\\frac{1}{G(\\Lambda)} = \\sum_{k: |\\epsilon_k - \\mu| \\le \\Lambda} \\frac{g_k}{2 E_k}$。\n- **可观测量**：\n    - 双中子分离能：$S_{2n} = 2\\mu$。\n    - 均方根半径：$r_{\\mathrm{rms}} = \\sqrt{\\langle r^2 \\rangle}$，其中 $\\langle r^2 \\rangle = \\frac{\\sum_k g_k v_k^2 r_k^2}{N}$。\n- **方案**：\n    - **重整化**：对于给定的原子核 ($N$) 和截断 ($\\Lambda$)：\n        1. 将对能隙固定在目标值 $\\Delta = \\Delta_0$。\n        2. 从数方程确定化学势 $\\mu$。\n        3. 对强度 $G(\\Lambda)$ 随后由能隙方程隐式定义，但不用来确定可观测量。\n        4. 计算 $S_{2n}$ 和 $r_{\\mathrm{rms}}$。\n    - **非重整化**：对于给定的原子核 ($N$) 和截断 ($\\Lambda$)：\n        1. 将对强度固定为参考值 $G_{\\mathrm{ref}}$。\n        2. $G_{\\mathrm{ref}}$ 是通过对参考原子核 $N_{\\mathrm{ref}}$ 在参考截断 $\\Lambda_{\\mathrm{ref}}$ 处强制 $\\Delta = \\Delta_0$ 来确定的。\n        3. 联立求解数方程和能隙方程以得到 $(\\mu, \\Delta)$。\n        4. 计算 $S_{2n}$ 和 $r_{\\mathrm{rms}}$。\n- **数值参数**：\n    - 目标能隙：$\\Delta_0 = 1.2$ MeV。\n    - 参考截断：$\\Lambda_{\\mathrm{ref}} = 20$ MeV。\n    - 参考原子核：$N_{\\mathrm{ref}} = 52$。\n    - 用于分析的截断集合：$\\Lambda \\in \\{5, 10, 20\\}$ MeV。\n- **测试用例**：中子数为 $N \\in \\{44, 52, 60\\}$ 的原子核。\n- **任务**：对于每个方案和每个测试用例原子核，计算 $S_{2n}$ 和 $r_{\\mathrm{rms}}$ 在整个截断集合中相对于在参考截断 $\\Lambda_{\\mathrm{ref}}$ 处获得的值的最大绝对偏差。\n\n### 步骤 2：使用提取的给定信息进行验证\n1.  **科学基础**：该问题是 BCS 理论在核结构物理学中的一个标准（尽管简化了）的应用。对、截断和重整化的概念是该领域的核心。该模型建立在公认的原理之上。\n2.  **适定性**：该问题在数学上是适定的。BCS 数方程 $N(\\mu) = \\sum_k g_k v_k^2$ 定义了 $\\mu$ 的单调递增函数，确保在其他参数固定时 $\\mu$ 有唯一解。关于 $(\\mu, \\Delta)$ 的耦合方程组是物理学中一个标准的非线性系统，可以可靠地找到其数值解。该问题的结构旨在产生唯一且有意义的解。\n3.  **客观性**：所有术语都经过了精确的数学定义。该问题不含主观或模棱两可的语言。\n4.  **科学或事实上的不健全性**：不存在违规之处。使用 $S_{2n} = 2\\mu$ 是问题上下文中的一个指定约定，与分析 $S_{2n}$ 变号的滴线相一致。\n5.  **非形式化或不相关**：该问题可直接形式化为计算算法，并且与指定的物理领域高度相关。\n6.  **不完整或矛盾的设置**：提供了所有必要的数据和定义。两种方案都得到了明确的规定，并且互不矛盾。\n7.  **不切实际或不可行**：对于此类模型，数值参数是合理的。中子数和能级在研究中等质量原子核的合理物理范围内。\n8.  **不适定或结构不良**：该问题结构良好，没有表现出任何不适定问题的特征，如循环论证或歧义。\n\n### 步骤 3：结论与行动\n该问题是**有效的**。将开发一个计算解决方案。\n\n### 解决方案\n\n目标是在 BCS 模型中实现并比较两种不同的对截断 $\\Lambda$ 处理方法：一种是旨在产生稳定可观测量的重整化方案，另一种是可观测量依赖于截断的非重整化方案。\n\n**模型规格**\n单粒子基由 $50$ 个能级组成，索引为 $k=0, \\dots, 49$。能级 $k$ 的能量为 $\\epsilon_k = -25 + k$ MeV，简并度为 $g_k = 2$。相关的半径平方为 $r_k^2 = 9.0 + 0.04k$ fm$^2$。\n模型的核心在于粒子数 $N$ 和对能隙 $\\Delta$ 的 BCS 方程：\n$$ N = \\sum_{k=0}^{49} g_k \\cdot \\frac{1}{2}\\left(1 - \\frac{\\epsilon_k - \\mu}{\\sqrt{(\\epsilon_k - \\mu)^2 + \\Delta^2}}\\right) $$\n$$ \\frac{1}{G(\\Lambda)} = \\sum_{k: |\\epsilon_k - \\mu| \\le \\Lambda} \\frac{g_k}{2 \\sqrt{(\\epsilon_k - \\mu)^2 + \\Delta^2}} $$\n可观测量，即双中子分离能 $S_{2n}$ 和均方根半径 $r_{\\mathrm{rms}}$，是根据得到的化学势 $\\mu$ 和占据几率 $v_k^2$ 计算的。\n\n**计算策略：重整化方案**\n此方案旨在使主要可观测量独立于截断 $\\Lambda$。\n1.  对于给定的粒子数为 $N$ 的原子核，对能隙被固定为目标值 $\\Delta = \\Delta_0 = 1.2$ MeV。\n2.  化学势 $\\mu$ 通过求解数方程来确定，我们可以将其写成一个求根问题 $f(\\mu) = 0$，其中\n    $$ f(\\mu) = \\left( \\sum_{k=0}^{49} g_k v_k^2(\\mu, \\Delta_0) \\right) - N $$\n    该方程与截断 $\\Lambda$ 无关。因此，对于给定的 $N$，$\\mu$ 的解也与 $\\Lambda$ 无关。这个一维非线性方程使用稳健的 Brent 方法求解。\n3.  由于 $\\mu$ 和 $\\Delta$ 在截断集合 $\\{\\Lambda\\}$ 中是常数，占据几率 $v_k^2$ 也是常数。\n4.  直接结果是，可观测量 $S_{2n} = 2\\mu$ 和 $r_{\\mathrm{rms}} = \\sqrt{\\frac{1}{N}\\sum_k g_k v_k^2 r_k^2}$ 相对于 $\\Lambda$ 是不变的。\n5.  因此，两个可观测量的最大绝对偏差预计为零（在机器精度范围内）。唯一随 $\\Lambda$“运行”的量是对强度 $G(\\Lambda)$，它会进行调整以维持固定的 $\\Delta_0$。\n\n**计算策略：非重整化方案**\n在此方案中，对强度保持不变，物理参数 $(\\mu, \\Delta)$ 随截断 $\\Lambda$ 调整。\n\n1.  **参考对强度计算**：恒定的对强度 $G_{\\mathrm{ref}}$ 只计算一次。我们使用参考原子核 $N_{\\mathrm{ref}} = 52$ 和参考截断 $\\Lambda_{\\mathrm{ref}} = 20$ MeV。\n    a. 我们首先固定 $\\Delta = \\Delta_0 = 1.2$ MeV，并为 $N_{\\mathrm{ref}}$ 求解数方程以找到相应的化学势 $\\mu_{\\mathrm{ref}}$。\n    b. 利用 $\\mu_{\\mathrm{ref}}$ 和 $\\Delta_0$，我们在 $\\Lambda_{\\mathrm{ref}}$ 处评估能隙方程的右侧，以找到 $1/G_{\\mathrm{ref}}$。\n    $$ \\frac{1}{G_{\\mathrm{ref}}} = \\sum_{k: |\\epsilon_k - \\mu_{\\mathrm{ref}}| \\le \\Lambda_{\\mathrm{ref}}} \\frac{g_k}{2 \\sqrt{(\\epsilon_k - \\mu_{\\mathrm{ref}})^2 + \\Delta_0^2}} $$\n\n2.  **耦合方程求解**：对于每个测试原子核 $(N)$ 和每个截断 $(\\Lambda)$，我们固定 $G = G_{\\mathrm{ref}}$ 并求解以下包含两个未知数 $(\\mu, \\Delta)$ 的耦合非线性方程组：\n    $$\n    \\begin{cases}\n    \\sum_k g_k v_k^2(\\mu, \\Delta) - N = 0 \\\\\n    \\left( \\sum_{k: |\\epsilon_k - \\mu| \\le \\Lambda} \\frac{g_k}{2 E_k(\\mu, \\Delta)} \\right) - \\frac{1}{G_{\\mathrm{ref}}} = 0\n    \\end{cases}\n    $$\n    这个 $2 \\times 2$ 系统使用基于 Levenberg-Marquardt 算法的多维求根器进行数值求解。通过首先为给定的 $N$ 求解（更简单的）重整化问题以找到近似的 $\\mu$，然后将其与 $\\Delta_0$ 一起用作起始点 $(\\mu_{\\mathrm{guess}}, \\Delta_0)$，来提供一个稳健的初始猜测。\n3.  因为能隙方程通过求和范围明确地依赖于 $\\Lambda$，所以解对 $(\\mu, \\Delta)$ 将随 $\\Lambda$ 变化。这导致可观测量 $S_{2n}$ 和 $r_{\\mathrm{rms}}$ 具有截断依赖性。\n\n**偏差分析**\n对于每个方案和每个原子核，我们为每个 $\\Lambda \\in \\{5, 10, 20\\}$ MeV 计算可观测量。我们将 $\\Lambda_{\\mathrm{ref}} = 20$ MeV 处的结果确定为该原子核的参考值。\n最终报告的量是在 $\\Lambda \\in \\{5, 10\\}$ MeV 处的值与在 $\\Lambda = 20$ MeV 处的参考值之间的最大绝对差：\n$$ dS_{2n} = \\max_{\\Lambda \\in \\{5, 10, 20\\}} | S_{2n}(\\Lambda) - S_{2n}(\\Lambda_{\\mathrm{ref}}) | $$\n$$ dr_{\\mathrm{rms}} = \\max_{\\Lambda \\in \\{5, 10, 20\\}} | r_{\\mathrm{rms}}(\\Lambda) - r_{\\mathrm{rms}}(\\Lambda_{\\mathrm{ref}}) | $$\n该分析量化了可观测量在非物理截断参数 $\\Lambda$ 变化下的稳定性。正如预测的那样，重整化方案产生零偏差，证明其成功消除了这种伪依赖性。相比之下，非重整化方案表现出非零偏差，突显了其理论上的缺陷。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq, root\n\ndef solve():\n    \"\"\"\n    Solves the nuclear BCS problem to compare renormalized and unrenormalized schemes.\n    \"\"\"\n    \n    # --- Problem Constants and Setup ---\n    DELTA_0 = 1.2  # MeV\n    LAMBDA_REF = 20.0  # MeV\n    N_REF = 52\n    \n    # Single-particle spectrum\n    K_VALUES = np.arange(50)\n    EPSILON = -25.0 + K_VALUES  # MeV\n    G_DEGEN = 2.0 * np.ones_like(EPSILON)\n    R_SQ = 9.0 + 0.04 * K_VALUES  # fm^2\n    \n    # Analysis parameters\n    CUTOFFS = np.array([5.0, 10.0, 20.0])\n    CASES = {'A': 44, 'B': 52, 'C': 60}\n    CASE_ORDER = ['A', 'B', 'C']\n\n    # --- Core Physics Functions ---\n\n    def get_v_sq_and_E(mu, delta, eps):\n        \"\"\"Calculates occupation probabilities v_k^2 and quasiparticle energies E_k.\"\"\"\n        # Add a small epsilon to denominator to prevent division by zero if delta=0\n        # although delta > 0 is expected for physical solutions.\n        E = np.sqrt((eps - mu)**2 + delta**2 + 1e-30)\n        v_sq = 0.5 * (1.0 - (eps - mu) / E)\n        return v_sq, E\n\n    def calculate_observables(mu, delta, N, eps, g, r_sq):\n        \"\"\"Calculates S_2n and r_rms from mu, delta, and N.\"\"\"\n        v_sq, _ = get_v_sq_and_E(mu, delta, eps)\n        s_2n = 2.0 * mu\n        r_sq_mean = np.sum(g * v_sq * r_sq) / N\n        r_rms = np.sqrt(r_sq_mean)\n        return s_2n, r_rms\n\n    # --- Renormalized Scheme ---\n\n    ren_deviations = {}\n    for case_name in CASE_ORDER:\n        N = CASES[case_name]\n        \n        # In the renormalized scheme, mu is found for a fixed Delta_0.\n        # The number equation is independent of Lambda.\n        def number_eq_residual(mu):\n            v_sq, _ = get_v_sq_and_E(mu, DELTA_0, EPSILON)\n            return np.sum(G_DEGEN * v_sq) - N\n            \n        # Find mu. The search interval is robust for the given N values.\n        mu_ren = brentq(number_eq_residual, -30.0, 30.0)\n        \n        # Since mu and delta are constant, observables are constant.\n        s_2n_ren, r_rms_ren = calculate_observables(mu_ren, DELTA_0, N, EPSILON, G_DEGEN, R_SQ)\n        \n        # Deviations are zero by construction.\n        ren_deviations[case_name] = (0.0, 0.0)\n\n    # --- Unrenormalized Scheme ---\n\n    # 1. Calculate G_ref\n    def number_eq_residual_ref(mu):\n        v_sq, _ = get_v_sq_and_E(mu, DELTA_0, EPSILON)\n        return np.sum(G_DEGEN * v_sq) - N_REF\n    \n    mu_ref_for_g = brentq(number_eq_residual_ref, -30.0, 30.0)\n    \n    _, E_ref_for_g = get_v_sq_and_E(mu_ref_for_g, DELTA_0, EPSILON)\n    pairing_window_mask = np.abs(EPSILON - mu_ref_for_g) = LAMBDA_REF\n    \n    inv_g_ref = np.sum((G_DEGEN / (2.0 * E_ref_for_g))[pairing_window_mask])\n\n    # 2. Solve for each case and cutoff\n    unren_results = {}\n    unren_deviations = {}\n\n    for case_name in CASE_ORDER:\n        N = CASES[case_name]\n        unren_results[case_name] = {}\n        \n        # Robust initial guess using the mu from renormalized scheme for this N\n        mu_guess = brentq(lambda mu: np.sum(G_DEGEN * get_v_sq_and_E(mu, DELTA_0, EPSILON)[0]) - N, -30, 30)\n\n        for Lambda in CUTOFFS:\n            def system_equations(x):\n                mu, delta = x[0], x[1]\n                \n                if delta = 0: # Enforce physical gap\n                    return [1e6, 1e6]\n                \n                v_sq, E = get_v_sq_and_E(mu, delta, EPSILON)\n                \n                # Equation 1: Number conservation\n                res1 = np.sum(G_DEGEN * v_sq) - N\n                \n                # Equation 2: Gap equation\n                window_mask = np.abs(EPSILON - mu) = Lambda\n                res2 = np.sum((G_DEGEN / (2.0 * E))[window_mask]) - inv_g_ref\n                \n                return [res1, res2]\n\n            # Solve the 2D system\n            sol = root(system_equations, [mu_guess, DELTA_0], method='lm')\n            mu_unren, delta_unren = sol.x\n            \n            s_2n_unren, r_rms_unren = calculate_observables(\n                mu_unren, delta_unren, N, EPSILON, G_DEGEN, R_SQ)\n            \n            unren_results[case_name][Lambda] = (s_2n_unren, r_rms_unren)\n\n        # 3. Calculate deviations for unrenormalized scheme\n        s2n_ref_val = unren_results[case_name][LAMBDA_REF][0]\n        r_rms_ref_val = unren_results[case_name][LAMBDA_REF][1]\n        \n        max_ds2n = 0.0\n        max_dr_rms = 0.0\n        \n        for Lambda in CUTOFFS:\n            s2n_val, r_rms_val = unren_results[case_name][Lambda]\n            max_ds2n = max(max_ds2n, abs(s2n_val - s2n_ref_val))\n            max_dr_rms = max(max_dr_rms, abs(r_rms_val - r_rms_ref_val))\n        \n        unren_deviations[case_name] = (max_ds2n, max_dr_rms)\n\n    # --- Format and Print Final Output ---\n    final_output = []\n    for case_name in CASE_ORDER:\n        final_output.extend(ren_deviations[case_name])\n    for case_name in CASE_ORDER:\n        final_output.extend(unren_deviations[case_name])\n\n    # The final print statement must produce only the specified single-line format.\n    print(f\"[{','.join(f'{x:.8f}' for x in final_output)}]\")\n\nsolve()\n```"
        }
    ]
}