{
    "hands_on_practices": [
        {
            "introduction": "The Hartree-Fock approximation's power lies in its ability to recast a complex many-body problem into a more manageable set of single-particle equations. At the heart of this transformation are the direct (Hartree) and exchange (Fock) terms, which represent the average effect of two-body interactions. This first practice  provides a foundational, first-principles calculation of these terms for a simple, analytically solvable system, offering a concrete understanding of how the mean field is constructed and how the Pauli principle gives rise to the non-classical exchange interaction.",
            "id": "3601505",
            "problem": "Consider a system of protons treated in the Hartree-Fock (HF) approximation, where the single-particle basis is taken to be the three-dimensional isotropic harmonic oscillator. Let the occupied proton orbitals form a Slater determinant in which the spatial part for both occupied states is the lowest oscillator state with oscillator length $b$, and the spin parts are opposite (one spin-up and one spin-down). The normalized spatial orbital is\n$$\n\\phi_{0s}(\\mathbf{r}) \\;=\\; \\pi^{-3/4}\\,b^{-3/2}\\,\\exp\\!\\left(-\\frac{r^{2}}{2 b^{2}}\\right).\n$$\nAssume the proton-proton interaction is purely the Coulomb interaction,\n$$\n\\hat{V}_{C} \\;=\\; \\sum_{i<j} \\frac{e^{2}}{|\\mathbf{r}_{i}-\\mathbf{r}_{j}|},\n$$\nand neglect any other components such as the strong interaction or finite-size effects of the proton.\n\nStarting from the definition of the Hartree-Fock energy for a two-body interaction and the Slater determinant structure, derive from first principles the Coulomb direct matrix element $J$ and the Coulomb exchange matrix element $K$ between the two occupied proton states. Then, determine the net Coulomb contribution to the HF single-particle mean-field shift $U$ for the spin-up proton due to the presence of the other (spin-down) proton in this configuration, expressed in terms of $J$ and $K$.\n\nFinally, define the dimensionless ratio\n$$\nR \\;=\\; \\frac{U}{e^{2}/b}.\n$$\nCompute $R$ exactly. Your final answer must be the single closed-form analytic value of $R$. Do not evaluate numerically and do not include units in your final answer box. You may assume standard Fourier-transform identities for the Coulomb kernel and Gaussian functions.",
            "solution": "We begin from the Hartree-Fock (HF) energy functional for a system with a two-body interaction. For a Slater determinant built from orthonormal single-particle states $\\{\\varphi_{i}\\}$, the interaction energy can be written as\n$$\nE_{\\text{int}} \\;=\\; \\frac{1}{2}\\sum_{i,j}\\Big(J_{ij}-K_{ij}\\Big),\n$$\nwith the Coulomb direct and exchange matrix elements defined by\n$$\nJ_{ij} \\;=\\; \\iint d^{3}r_{1}\\,d^{3}r_{2}\\;\n|\\varphi_{i}(\\mathbf{r}_{1})|^{2}\\,\\frac{e^{2}}{|\\mathbf{r}_{1}-\\mathbf{r}_{2}|}\\,|\\varphi_{j}(\\mathbf{r}_{2})|^{2},\n$$\n$$\nK_{ij} \\;=\\; \\iint d^{3}r_{1}\\,d^{3}r_{2}\\;\n\\varphi_{i}^{*}(\\mathbf{r}_{1})\\,\\varphi_{j}^{*}(\\mathbf{r}_{2})\\,\\frac{e^{2}}{|\\mathbf{r}_{1}-\\mathbf{r}_{2}|}\\,\\varphi_{i}(\\mathbf{r}_{2})\\,\\varphi_{j}(\\mathbf{r}_{1})\\,\\langle\\chi_{i}|\\chi_{j}\\rangle\\,\\langle\\chi_{j}|\\chi_{i}\\rangle,\n$$\nwhere $\\chi_{i}$ denotes the spin state associated with $\\varphi_{i}$. For the present system, there are two occupied proton states with the same spatial orbital $\\phi_{0s}(\\mathbf{r})$ and opposite spin projections. Denote these single-particle states by\n$$\n\\varphi_{\\uparrow}(\\mathbf{r},\\sigma) \\;=\\; \\phi_{0s}(\\mathbf{r})\\,\\chi_{\\uparrow}(\\sigma), \n\\qquad\n\\varphi_{\\downarrow}(\\mathbf{r},\\sigma) \\;=\\; \\phi_{0s}(\\mathbf{r})\\,\\chi_{\\downarrow}(\\sigma).\n$$\nThe spatial density associated with the orbital is\n$$\n\\rho(\\mathbf{r}) \\;=\\; |\\phi_{0s}(\\mathbf{r})|^{2} \\;=\\; \\pi^{-3/2}\\,b^{-3}\\,\\exp\\!\\left(-\\frac{r^{2}}{b^{2}}\\right).\n$$\n\nDirect matrix element. The Coulomb direct matrix element between these two occupied states is\n$$\nJ \\;\\equiv\\; J_{\\uparrow\\downarrow} \n\\;=\\; \\iint d^{3}r\\,d^{3}r'\\; \\rho(\\mathbf{r})\\,\\frac{e^{2}}{|\\mathbf{r}-\\mathbf{r}'|}\\,\\rho(\\mathbf{r}').\n$$\nThis is the electrostatic interaction energy of two identical normalized Gaussian charge distributions. A convenient route is via the Fourier transform of the Coulomb kernel and the Gaussian density. The Coulomb kernel admits the representation\n$$\n\\frac{1}{|\\mathbf{r}-\\mathbf{r}'|} \\;=\\; \\int \\frac{d^{3}k}{(2\\pi)^{3}}\\,\\frac{4\\pi}{k^{2}}\\,\n\\exp\\!\\big(i\\,\\mathbf{k}\\cdot(\\mathbf{r}-\\mathbf{r}')\\big),\n$$\nand the Fourier transform of the normalized Gaussian density\n$$\n\\rho(\\mathbf{r}) \\;=\\; \\left(\\frac{\\alpha}{\\pi}\\right)^{3/2}\\exp(-\\alpha r^{2}),\n\\qquad \\alpha \\;=\\; \\frac{1}{b^{2}},\n$$\nis\n$$\n\\tilde{\\rho}(\\mathbf{k}) \\;=\\; \\int d^{3}r\\,\\rho(\\mathbf{r})\\,\\exp(i\\mathbf{k}\\cdot\\mathbf{r})\n\\;=\\; \\exp\\!\\left(-\\frac{k^{2}}{4\\alpha}\\right)\n\\;=\\; \\exp\\!\\left(-\\frac{k^{2} b^{2}}{4}\\right).\n$$\nUsing these, the direct matrix element becomes\n$$\nJ \\;=\\; e^{2}\\int \\frac{d^{3}k}{(2\\pi)^{3}}\\,\\frac{4\\pi}{k^{2}}\\,|\\tilde{\\rho}(\\mathbf{k})|^{2}\n\\;=\\; e^{2}\\int \\frac{d^{3}k}{(2\\pi)^{3}}\\,\\frac{4\\pi}{k^{2}}\\,\n\\exp\\!\\left(-\\frac{k^{2} b^{2}}{2}\\right).\n$$\nEvaluating in spherical coordinates,\n$$\nJ \\;=\\; e^{2}\\,\\frac{1}{(2\\pi)^{3}}\\,4\\pi \\int_{0}^{\\infty} dk\\,k^{2}\\,\\frac{4\\pi}{k^{2}}\\,\n\\exp\\!\\left(-\\frac{k^{2} b^{2}}{2}\\right)\n\\;=\\; e^{2}\\,\\frac{16\\pi^{2}}{(2\\pi)^{3}}\n\\int_{0}^{\\infty} dk\\,\\exp\\!\\left(-\\frac{k^{2} b^{2}}{2}\\right).\n$$\nThe Gaussian integral yields\n$$\n\\int_{0}^{\\infty} \\exp\\!\\left(-\\beta k^{2}\\right)\\,dk \\;=\\; \\frac{1}{2}\\sqrt{\\frac{\\pi}{\\beta}},\n\\qquad \\beta \\;=\\; \\frac{b^{2}}{2},\n$$\nso\n$$\n\\int_{0}^{\\infty} \\exp\\!\\left(-\\frac{k^{2} b^{2}}{2}\\right)\\,dk \n\\;=\\; \\frac{1}{2}\\sqrt{\\frac{2\\pi}{b^{2}}}\n\\;=\\; \\frac{1}{\\sqrt{2}}\\,\\frac{\\sqrt{\\pi}}{b}.\n$$\nTherefore,\n$$\nJ \\;=\\; e^{2}\\,\\frac{16\\pi^{2}}{8\\pi^{3}}\\,\\frac{1}{\\sqrt{2}}\\,\\frac{\\sqrt{\\pi}}{b}\n\\;=\\; e^{2}\\,\\frac{2}{\\pi}\\,\\frac{1}{\\sqrt{2}}\\,\\frac{\\sqrt{\\pi}}{b}\n\\;=\\; e^{2}\\,\\sqrt{\\frac{2}{\\pi}}\\,\\frac{1}{b}.\n$$\n\nExchange matrix element. The Coulomb exchange matrix element between the two occupied states includes the spin overlaps,\n$$\nK \\;\\equiv\\; K_{\\uparrow\\downarrow} \\;=\\; \\iint d^{3}r\\,d^{3}r'\\;\n\\phi_{0s}^{*}(\\mathbf{r})\\,\\phi_{0s}^{*}(\\mathbf{r}')\\,\n\\frac{e^{2}}{|\\mathbf{r}-\\mathbf{r}'|}\\,\n\\phi_{0s}(\\mathbf{r}')\\,\\phi_{0s}(\\mathbf{r})\\;\n\\langle\\chi_{\\uparrow}|\\chi_{\\downarrow}\\rangle\\,\\langle\\chi_{\\downarrow}|\\chi_{\\uparrow}\\rangle.\n$$\nBecause the occupied spin states are orthogonal, $\\langle\\chi_{\\uparrow}|\\chi_{\\downarrow}\\rangle \\;=\\; 0$, it follows that\n$$\nK \\;=\\; 0.\n$$\nFor completeness, if both protons had the same spin projection in the same spatial orbital, one would obtain $K \\;=\\; J$ by symmetry of the integrand.\n\nHartree-Fock mean-field contribution. In Hartree-Fock, the single-particle mean-field shift $U$ for one occupied state due to the other occupied state is given by the direct-minus-exchange contribution,\n$$\nU \\;=\\; J - K.\n$$\nIn the present configuration (opposite spins in the same spatial orbital),\n$$\nU \\;=\\; J \\;-\\; 0 \\;=\\; e^{2}\\,\\sqrt{\\frac{2}{\\pi}}\\,\\frac{1}{b}.\n$$\n\nDimensionless ratio. The requested dimensionless ratio is\n$$\nR \\;=\\; \\frac{U}{e^{2}/b} \\;=\\; \\sqrt{\\frac{2}{\\pi}}.\n$$\nThis is an exact closed-form result, requiring no numerical evaluation.",
            "answer": "$$\\boxed{\\sqrt{\\frac{2}{\\pi}}}$$"
        },
        {
            "introduction": "The Hartree-Fock equations are solved iteratively, refining the single-particle orbitals until they are self-consistent with the very mean field they generate. This exercise  explores the mathematical condition for self-consistency, deriving it directly from the variational principle. By defining and computing a residual norm, you will learn the essential practical skill of quantifying how close a numerical solution is to a true stationary point, bridging the gap between formal theory and a working computational algorithm.",
            "id": "3601468",
            "problem": "Consider a closed-shell nuclear system treated in the Hartree-Fock (HF) approximation. Let the many-body Hamiltonian be written as $\\hat{H} = \\sum_{\\alpha} \\hat{t}_{\\alpha} + \\frac{1}{2}\\sum_{\\alpha \\neq \\beta} \\hat{v}_{\\alpha\\beta}$, where $\\hat{t}_{\\alpha}$ is the one-body kinetic plus external mean-field operator and $\\hat{v}_{\\alpha\\beta}$ is an effective two-body interaction. In HF, the energy is minimized over Slater determinants and can be expressed as a functional of the one-body density operator $\\hat{\\gamma}$ (with matrix representation $P$ in an orthonormal single-particle basis) as $E[P]$, with the corresponding Fock operator $F$ obtained from functional differentiation of $E[P]$ with respect to $P$. Assume the orbitals are varied via a unitary transformation $U(\\kappa) = \\exp(\\kappa)$ generated by an anti-Hermitian matrix $\\kappa$ (so that $U^{\\dagger}U = I$), inducing the density change $\\delta P$ consistent with the idempotency constraint $P^{2} = P$.\n\nUsing only these fundamental facts, perform the following:\n\n1. Derive, from first principles of the variational stationarity of $E[P]$ under unitary orbital rotations, the condition that must hold at a stationary HF solution in terms of the commutator of the Fock operator and the density matrix. From your derivation, define the orbital gradient as the matrix that couples occupied-to-virtual rotations and specify its components in the canonical orbital basis where the density is diagonal with eigenvalues $1$ for occupied and $0$ for virtual states.\n\n2. Define a residual norm that quantifies the deviation from stationarity of a numerical HF solution by aggregating the occupied-to-virtual components of the orbital gradient into a single scalar. Be explicit in your choice of norm, and justify it from the variational framework.\n\n3. Consider a numerical HF solution represented in an orthonormal single-particle basis of dimension $4$, with two occupied orbitals (indices $i = 1,2$) and two virtual orbitals (indices $a = 3,4$). In this basis, the density matrix is the projector\n$$\nP = \\begin{pmatrix}\n1 & 0 & 0 & 0 \\\\\n0 & 1 & 0 & 0 \\\\\n0 & 0 & 0 & 0 \\\\\n0 & 0 & 0 & 0\n\\end{pmatrix},\n$$\nand the Fock matrix (in megaelectronvolts) is\n$$\nF = \\begin{pmatrix}\n-12.0 & \\phantom{-}0.30 & \\phantom{-}0.10 & -0.05 \\\\\n\\phantom{-}0.30 & -11.5 & -0.08 & \\phantom{-}0.02 \\\\\n\\phantom{-}0.10 & -0.08 & \\phantom{-}-7.0 & \\phantom{-}0.25 \\\\\n-0.05 & \\phantom{-}0.02 & \\phantom{-}0.25 & \\phantom{-}-6.8\n\\end{pmatrix}.\n$$\nUsing your derived expressions, compute the residual norm for this numerical solution.\n\nExpress the final residual norm in megaelectronvolts (MeV). Round your answer to four significant figures.",
            "solution": "The problem asks for a three-part analysis of a Hartree-Fock (HF) solution: first, to derive the stationarity condition from the variational principle; second, to define a residual norm based on this condition; and third, to compute this norm for a given numerical example.\n\n**Part 1: Derivation of the Stationarity Condition and Definition of the Orbital Gradient**\n\nThe Hartree-Fock energy $E$ is a functional of the one-body density matrix $P$, written as $E[P]$. The Fock matrix $F$ is defined through the first-order variation of the energy with respect to a variation in the density matrix, $\\delta P$:\n$$\n\\delta E = \\mathrm{Tr}(F \\delta P)\n$$\nThe problem states that the orbitals which define the Slater determinant, and thus the density matrix $P$, are varied via a unitary transformation $U(\\kappa) = \\exp(\\kappa)$, where $\\kappa$ is an anti-Hermitian matrix ($\\kappa^{\\dagger} = -\\kappa$). A new density matrix $P'$ is formed by rotating the original one:\n$$\nP' = U P U^{\\dagger}\n$$\nFor an infinitesimal rotation, the unitary operator can be approximated to first order as $U(\\kappa) \\approx I + \\kappa$, where $I$ is the identity matrix. The corresponding variation in the density matrix, $\\delta P = P' - P$, is:\n$$\n\\delta P = (I + \\kappa) P (I + \\kappa)^{\\dagger} - P\n$$\n$$\n\\delta P \\approx (I + \\kappa) P (I - \\kappa) - P = (P + \\kappa P - P \\kappa - \\kappa P \\kappa) - P\n$$\nTo first order in $\\kappa$, the variation is given by the commutator of $\\kappa$ and $P$:\n$$\n\\delta P = \\kappa P - P \\kappa = [\\kappa, P]\n$$\nThis form of variation automatically preserves the trace of the density matrix, $\\mathrm{Tr}(\\delta P) = \\mathrm{Tr}([\\kappa, P]) = 0$, and to first order preserves its idempotency, $P \\delta P + \\delta P P = \\delta P$.\n\nSubstituting this expression for $\\delta P$ into the energy variation formula, we get:\n$$\n\\delta E = \\mathrm{Tr}(F [\\kappa, P])\n$$\nUsing the cyclic property of the trace, $\\mathrm{Tr}(ABC) = \\mathrm{Tr}(BCA)$, we can rewrite this as:\n$$\n\\delta E = \\mathrm{Tr}(F\\kappa P - FP\\kappa) = \\mathrm{Tr}(P F \\kappa - F P \\kappa) = \\mathrm{Tr}((PF - FP)\\kappa) = \\mathrm{Tr}(-[F,P]\\kappa)\n$$\nAt a stationary point, the energy must be extremal, meaning its first-order variation $\\delta E$ must be zero for any allowed orbital variation $\\kappa$. The variations that change the many-body state (i.e., change the space spanned by the occupied orbitals) are those that mix occupied orbitals with virtual (unoccupied) orbitals. Rotations purely within the occupied space or purely within the virtual space do not change the Slater determinant and thus do not change the density matrix $P$. Therefore, the matrix $\\kappa$ must have non-zero elements only in the blocks connecting the occupied and virtual spaces.\n\nThe condition $\\delta E = 0$ for all such variations $\\kappa$ implies that the corresponding matrix elements of the commutator $[F,P]$ must be zero. Let us analyze the components of $[F,P]$ in the canonical basis where $P$ is diagonal. In this basis, occupied orbitals are denoted by indices $i, j, \\dots$ and virtual orbitals by $a, b, \\dots$. The density matrix has elements $P_{pq} = \\delta_{pq}$ if $p,q$ are occupied, and $P_{pq}=0$ otherwise.\nThe elements of the commutator $[F,P] = FP - PF$ are:\n- Occupied-occupied block ($i,j$): $([F,P])_{ij} = \\sum_k (F_{ik}P_{kj} - P_{ik}F_{kj}) = F_{ij} - F_{ij} = 0$.\n- Virtual-virtual block ($a,b$): $([F,P])_{ab} = \\sum_k (F_{ak}P_{kb} - P_{ak}F_{kb}) = 0 - 0 = 0$.\n- Virtual-occupied block ($a,i$): $([F,P])_{ai} = \\sum_k (F_{ak}P_{ki} - P_{ak}F_{ki}) = F_{ai} - 0 = F_{ai}$.\n- Occupied-virtual block ($i,a$): $([F,P])_{ia} = \\sum_k (F_{ik}P_{ka} - P_{ik}F_{ka}) = 0 - F_{ia} = -F_{ia}$.\n\nThus, in the canonical basis, the commutator has the structure:\n$$\n[F,P] = \\begin{pmatrix} 0 & -F_{ia} \\\\ F_{ai} & 0 \\end{pmatrix}\n$$\nThe energy variation is coupled to $\\kappa$ through the off-diagonal blocks of $[F,P]$. For $\\delta E = \\mathrm{Tr}(-[F,P]\\kappa)$ to be zero for any arbitrary occupied-virtual mixing $\\kappa$, the off-diagonal blocks of $[F,P]$ must themselves be zero. This requires $F_{ai} = 0$ for all occupied $i$ and virtual $a$. Since the diagonal blocks are always zero, the stationarity condition is that the entire commutator vanishes:\n$$\n[F, P] = 0\n$$\nThis is the Brillouin-Thouless theorem. It states that at an HF minimum, the Fock matrix has no coupling elements between occupied and virtual orbitals.\n\nThe problem defines the orbital gradient as the matrix coupling occupied-to-virtual rotations. From the above, the components that drive the energy change are precisely the $F_{ai}$ matrix elements. Therefore, we define the orbital gradient as the virtual-occupied block of the Fock matrix in the canonical basis. The components of this gradient are the matrix elements $\\{F_{ai} | i \\in \\text{occupied}, a \\in \\text{virtual}\\}$.\n\n**Part 2: Definition of the Residual Norm**\n\nA numerical HF solution is stationary if and only if all components of the orbital gradient, $F_{ai}$, are zero. Before convergence, these components will be small but non-zero. A residual norm provides a single scalar measure of the deviation from stationarity.\n\nA natural and standard choice is the Frobenius norm of the orbital gradient matrix (the virtual-occupied block of $F$, which we denote $F_{vo}$). The Frobenius norm of a matrix $A$ is given by $\\|A\\|_F = \\sqrt{\\sum_{i,j} |A_{ij}|^2}$. We define the residual norm $R$ as:\n$$\nR = \\left( \\sum_{i \\in \\text{occupied}} \\sum_{a \\in \\text{virtual}} |F_{ai}|^2 \\right)^{1/2}\n$$\nThis choice is justified because the squared norm, $R^2$, is proportional to the squared Euclidean norm of the energy gradient vector in the space of orbital rotation parameters. The gradient of the energy with respect to a rotation between orbital $i$ and orbital $a$ is directly proportional to $F_{ai}$. Thus, $R$ is a measure of the magnitude of the total energy gradient. A value of $R=0$ indicates that the gradient is zero and the solution is stationary.\n\n**Part 3: Calculation of the Residual Norm**\n\nWe are given a numerical HF solution in a $4$-dimensional orthonormal basis.\nThe occupied orbitals are indexed by $i \\in \\{1, 2\\}$.\nThe virtual orbitals are indexed by $a \\in \\{3, 4\\}$.\n\nThe given density matrix $P$ confirms this choice of basis, as it is a projector onto the first two basis states.\n$$\nP = \\begin{pmatrix}\n1 & 0 & 0 & 0 \\\\\n0 & 1 & 0 & 0 \\\\\n0 & 0 & 0 & 0 \\\\\n0 & 0 & 0 & 0\n\\end{pmatrix}\n$$\nThe Fock matrix $F$ is given in megaelectronvolts (MeV) as:\n$$\nF = \\begin{pmatrix}\n-12.0 & \\phantom{-}0.30 & \\phantom{-}0.10 & -0.05 \\\\\n\\phantom{-}0.30 & -11.5 & -0.08 & \\phantom{-}0.02 \\\\\n\\phantom{-}0.10 & -0.08 & \\phantom{-}-7.0 & \\phantom{-}0.25 \\\\\n-0.05 & \\phantom{-}0.02 & \\phantom{-}0.25 & \\phantom{-}-6.8\n\\end{pmatrix}\n$$\nThe components of the orbital gradient are the elements $F_{ai}$, where $a \\in \\{3, 4\\}$ and $i \\in \\{1, 2\\}$. These form the lower-left $2 \\times 2$ sub-block of the Fock matrix:\n$$\nF_{vo} = \\begin{pmatrix} F_{31} & F_{32} \\\\ F_{41} & F_{42} \\end{pmatrix} = \\begin{pmatrix} 0.10 & -0.08 \\\\ -0.05 & \\phantom{-}0.02 \\end{pmatrix}\n$$\nWe now compute the residual norm $R$ using the formula from Part 2. Since the matrix elements are real, $|F_{ai}|^2 = F_{ai}^2$.\n$$\nR = \\sqrt{F_{31}^2 + F_{32}^2 + F_{41}^2 + F_{42}^2}\n$$\nSubstituting the numerical values:\n$$\nR = \\sqrt{(0.10)^2 + (-0.08)^2 + (-0.05)^2 + (0.02)^2}\n$$\n$$\nR = \\sqrt{0.0100 + 0.0064 + 0.0025 + 0.0004}\n$$\n$$\nR = \\sqrt{0.0193}\n$$\n$$\nR \\approx 0.13892443989... \\text{ MeV}\n$$\nRounding the result to four significant figures, we obtain:\n$$\nR \\approx 0.1389 \\text{ MeV}\n$$",
            "answer": "$$\n\\boxed{0.1389}\n$$"
        },
        {
            "introduction": "While the harmonic oscillator basis is computationally convenient for Hartree-Fock calculations, it artificially breaks translational invariance, introducing a non-physical 'spurious' energy from the center-of-mass motion. This final practice  provides a hands-on method to diagnose and quantify this common systematic error. By implementing a simple formula, you will gain a tangible sense of the magnitude of this effect and appreciate the importance of either correcting for it or using methods that preserve fundamental symmetries.",
            "id": "3601475",
            "problem": "You are asked to formalize, derive, and compute the reduction in spurious binding associated with broken translational invariance in Hartree-Fock (HF) calculations that use a harmonic oscillator (HO) single-particle basis for self-bound finite nuclei. The central idea is to enforce exact center-of-mass (c.m.) separation either by explicitly subtracting the c.m. Hamiltonian or by using spaces that preserve exact c.m. factorization, and to quantify, in a mathematically controlled way, how much spurious binding is removed in light $p$-shell systems.\n\nStart from the nonrelativistic $A$-body Hamiltonian written in an HO basis:\n\n$$\n\\hat{H} \\;=\\; \\sum_{i=1}^{A} \\left( \\frac{\\hat{\\mathbf{p}}_i^2}{2m} + \\frac{1}{2} m \\Omega^2 \\hat{\\mathbf{r}}_i^2 \\right) \\;+\\; \\hat{V},\n$$\n\nwhere $m$ is the nucleon mass, $\\Omega$ is the HO frequency, and $\\hat{V}$ is a translationally invariant two-body interaction. The center-of-mass Hamiltonian is\n\n$$\n\\hat{H}_{\\text{c.m.}} \\;=\\; \\frac{\\hat{\\mathbf{P}}^2}{2 A m} \\;+\\; \\frac{1}{2} A m \\Omega^2 \\hat{\\mathbf{R}}^2,\n$$\n\nwith total momentum $\\hat{\\mathbf{P}} = \\sum_{i=1}^A \\hat{\\mathbf{p}}_i$ and center-of-mass coordinate $\\hat{\\mathbf{R}} = \\frac{1}{A} \\sum_{i=1}^A \\hat{\\mathbf{r}}_i$.\n\nUnder the independent-particle approximation of a single Slater determinant (Hartree-Fock), the expectation value of the one-body HO Hamiltonian for an occupied single-particle HO state with total oscillator quanta $N = 2n + \\ell$ is\n\n$$\n\\left\\langle \\frac{\\hat{\\mathbf{p}}^2}{2m} + \\frac{1}{2} m \\Omega^2 \\hat{\\mathbf{r}}^2 \\right\\rangle \\;=\\; \\left(N + \\frac{3}{2}\\right) \\hbar \\Omega.\n$$\n\nIf the occupied HO states are labeled by $i = 1,\\dots,A$ with oscillator quanta $N_i$, a naive one-body-only estimate (i.e., neglecting two-body cross terms proportional to $\\hat{\\mathbf{r}}_i \\cdot \\hat{\\mathbf{r}}_j$ and $\\hat{\\mathbf{p}}_i \\cdot \\hat{\\mathbf{p}}_j$) for the expectation value of $\\hat{H}_{\\text{c.m.}}$ in a Slater determinant is\n\n$$\n\\langle \\hat{H}_{\\text{c.m.}} \\rangle_{\\text{1B}} \\;\\approx\\; \\frac{1}{A} \\sum_{i=1}^{A} \\left(N_i + \\frac{3}{2}\\right) \\hbar \\Omega \\;=\\; \\left( \\frac{N_{\\text{tot}}}{A} + \\frac{3}{2} \\right) \\hbar \\Omega,\n$$\n\nwhere $N_{\\text{tot}} = \\sum_{i=1}^{A} N_i$. In a translationally invariant description with exact center-of-mass factorization (for example, in complete $N \\hbar \\Omega$ spaces), the exact center-of-mass ground state energy is $\\frac{3}{2} \\hbar \\Omega$, so any excess $\\langle \\hat{H}_{\\text{c.m.}} \\rangle - \\frac{3}{2} \\hbar \\Omega$ represents spurious binding when $\\hat{H}_{\\text{c.m.}}$ is not removed.\n\nDefine the spurious binding contribution to the HF energy as\n\n$$\n\\Delta E_{\\text{spur}} \\;=\\; \\langle \\hat{H}_{\\text{c.m.}} \\rangle \\;-\\; \\frac{3}{2} \\hbar \\Omega.\n$$\n\nFor the one-body estimate above, this reduces to the simple, computable expression\n\n$$\n\\Delta E_{\\text{spur}} \\;\\approx\\; \\frac{N_{\\text{tot}}}{A} \\, \\hbar \\Omega.\n$$\n\nSubtracting $\\hat{H}_{\\text{c.m.}}$ in the HF Hamiltonian and adding back $\\frac{3}{2} \\hbar \\Omega$ to maintain the ground-state zero-point c.m. motion lowers the total energy by precisely $\\Delta E_{\\text{spur}}$. Likewise, restricting to spaces with exact center-of-mass factorization eliminates $\\Delta E_{\\text{spur}}$. Therefore, the reduction in spurious binding, in both strategies, is quantified by $\\Delta E_{\\text{spur}}$.\n\nYour task is to implement a program that, for a set of $p$-shell test nuclei treated as HO Slater determinants with specified occupancies, computes the reduction in spurious binding $\\Delta E_{\\text{spur}}$ using the formula above. Treat $\\hbar \\Omega$ as given for each case. The program should output the reductions in $\\text{MeV}$, rounded to three decimal places, for the following test suite:\n\n- Test $1$ (boundary, closed $s$-shell): $A = 4$, occupied oscillator quanta list $[0,0,0,0]$, $\\hbar \\Omega = 20\\,\\text{MeV}$.\n- Test $2$ (onset of $p$-shell): $A = 5$, occupied oscillator quanta list $[0,0,0,0,1]$, $\\hbar \\Omega = 15\\,\\text{MeV}$.\n- Test $3$ (typical $p$-shell, two particles in $p$): $A = 6$, occupied oscillator quanta list $[0,0,0,0,1,1]$, $\\hbar \\Omega = 14\\,\\text{MeV}$.\n- Test $4$ (typical $p$-shell, three particles in $p$): $A = 7$, occupied oscillator quanta list $[0,0,0,0,1,1,1]$, $\\hbar \\Omega = 13\\,\\text{MeV}$.\n- Test $5$ (typical $p$-shell, four particles in $p$): $A = 8$, occupied oscillator quanta list $[0,0,0,0,1,1,1,1]$, $\\hbar \\Omega = 12\\,\\text{MeV}$.\n\nInstructions and requirements:\n- Implement the computation of $\\Delta E_{\\text{spur}} = \\frac{N_{\\text{tot}}}{A} \\, \\hbar \\Omega$ for each test case, where $N_{\\text{tot}} = \\sum_i N_i$.\n- Express all final numerical answers in $\\text{MeV}$, rounded to three decimal places.\n- Final output format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example $[x_1,x_2,x_3,x_4,x_5]$, where each $x_k$ is the rounded $\\Delta E_{\\text{spur}}$ in $\\text{MeV}$ for Test $k$ in the order listed above.",
            "solution": "The problem requires the computation of the reduction in spurious binding energy, denoted $\\Delta E_{\\text{spur}}$, which arises in nuclear Hartree-Fock (HF) calculations when a harmonic oscillator (HO) single-particle basis is employed. This basis, while computationally convenient, introduces an artificial external potential centered at the origin, thereby breaking the translational invariance of the physical system. A consequence of this broken symmetry is that the center-of-mass (c.m.) of the nucleus undergoes spurious oscillatory motion within this potential, contributing a non-physical energy component to the total energy of the system. The task is to quantify this spurious energy for a series of light nuclei using a well-defined one-body approximation.\n\nWe begin with the $A$-body Hamiltonian in an HO basis:\n$$\n\\hat{H} = \\sum_{i=1}^{A} \\hat{h}_{0,i} + \\hat{V} = \\sum_{i=1}^{A} \\left( \\frac{\\hat{\\mathbf{p}}_i^2}{2m} + \\frac{1}{2} m \\Omega^2 \\hat{\\mathbf{r}}_i^2 \\right) + \\hat{V}\n$$\nHere, $\\hat{h}_{0,i}$ is the single-particle HO Hamiltonian for nucleon $i$, $m$ is the nucleon mass, $\\Omega$ is the HO frequency, and $\\hat{V}$ is the translationally invariant two-body interaction. The Hamiltonian $\\hat{H}$ is not translationally invariant due to the $\\sum_i \\hat{\\mathbf{r}}_i^2$ term.\n\nThe spurious energy originates from the center-of-mass part of the one-body HO potential. The c.m. Hamiltonian, which is contained within $\\hat{H}$, is given by:\n$$\n\\hat{H}_{\\text{c.m.}} = \\frac{\\hat{\\mathbf{P}}^2}{2 A m} + \\frac{1}{2} A m \\Omega^2 \\hat{\\mathbf{R}}^2\n$$\nwhere $\\hat{\\mathbf{P}} = \\sum_{i=1}^A \\hat{\\mathbf{p}}_i$ is the total momentum and $\\hat{\\mathbf{R}} = \\frac{1}{A} \\sum_{i=1}^A \\hat{\\mathbf{r}}_i$ is the c.m. coordinate. In a translationally invariant system, the nucleus as a whole should be in the ground state of its c.m. motion. For an HO potential, this ground state has an energy of $\\frac{3}{2}\\hbar\\Omega$. However, in a standard HF calculation with a Slater determinant wavefunction $|\\Phi\\rangle$, the expectation value $\\langle \\Phi | \\hat{H}_{\\text{c.m.}} | \\Phi \\rangle$ is generally greater than this value. The excess energy is the spurious contribution:\n$$\n\\Delta E_{\\text{spur}} = \\langle \\hat{H}_{\\text{c.m.}} \\rangle - \\frac{3}{2} \\hbar\\Omega\n$$\n\nThe problem provides a one-body approximation to estimate $\\langle \\hat{H}_{\\text{c.m.}} \\rangle$. This approximation neglects the two-body cross-terms in $\\hat{\\mathbf{P}}^2$ and $\\hat{\\mathbf{R}}^2$, effectively averaging the single-particle contributions.\nThe total one-body HO energy is $\\sum_i \\langle \\hat{h}_{0,i} \\rangle$. For a single nucleon in an HO state with principal oscillator quantum number $N_i$, the energy is $\\langle \\hat{h}_{0,i} \\rangle = (N_i + \\frac{3}{2})\\hbar\\Omega$. In the one-body estimate, the expectation value of the c.m. Hamiltonian is taken as the average single-particle energy:\n$$\n\\langle \\hat{H}_{\\text{c.m.}} \\rangle_{\\text{1B}} \\approx \\frac{1}{A} \\sum_{i=1}^{A} \\langle \\hat{h}_{0,i} \\rangle = \\frac{1}{A} \\sum_{i=1}^{A} \\left(N_i + \\frac{3}{2}\\right) \\hbar\\Omega\n$$\nSumming over the $A$ occupied states, we get:\n$$\n\\langle \\hat{H}_{\\text{c.m.}} \\rangle_{\\text{1B}} \\approx \\frac{1}{A} \\left( \\left(\\sum_{i=1}^{A} N_i\\right) + \\sum_{i=1}^{A} \\frac{3}{2} \\right) \\hbar\\Omega = \\frac{1}{A} \\left( N_{\\text{tot}} + A \\frac{3}{2} \\right) \\hbar\\Omega = \\left(\\frac{N_{\\text{tot}}}{A} + \\frac{3}{2}\\right)\\hbar\\Omega\n$$\nwhere $N_{\\text{tot}} = \\sum_{i=1}^{A} N_i$ is the total number of oscillator quanta for the occupied states.\n\nSubstituting this approximation into the definition of $\\Delta E_{\\text{spur}}$ yields the formula for our calculation:\n$$\n\\Delta E_{\\text{spur}} \\approx \\left(\\frac{N_{\\text{tot}}}{A} + \\frac{3}{2}\\right)\\hbar\\Omega - \\frac{3}{2} \\hbar\\Omega = \\frac{N_{\\text{tot}}}{A} \\hbar\\Omega\n$$\nThis quantity represents the amount of spurious binding energy that would be removed by explicitly subtracting $\\hat{H}_{\\text{c.m.}}$ from the Hamiltonian or by working in a basis that guarantees c.m. factorization. We apply this formula to each test case.\n\nTest $1$: $A = 4$, occupied quanta $[0,0,0,0]$, $\\hbar\\Omega = 20\\,\\text{MeV}$.\nThe total quanta is $N_{\\text{tot}} = 0 + 0 + 0 + 0 = 0$.\n$$\n\\Delta E_{\\text{spur}} = \\frac{0}{4} \\times 20\\,\\text{MeV} = 0.0\\,\\text{MeV}\n$$\nThis result is exact; for a closed HO shell, the c.m. motion separates exactly, and there is no spurious c.m. energy.\n\nTest $2$: $A = 5$, occupied quanta $[0,0,0,0,1]$, $\\hbar\\Omega = 15\\,\\text{MeV}$.\nThe total quanta is $N_{\\text{tot}} = 0 + 0 + 0 + 0 + 1 = 1$.\n$$\n\\Delta E_{\\text{spur}} = \\frac{1}{5} \\times 15\\,\\text{MeV} = 3.0\\,\\text{MeV}\n$$\n\nTest $3$: $A = 6$, occupied quanta $[0,0,0,0,1,1]$, $\\hbar\\Omega = 14\\,\\text{MeV}$.\nThe total quanta is $N_{\\text{tot}} = 0 + 0 + 0 + 0 + 1 + 1 = 2$.\n$$\n\\Delta E_{\\text{spur}} = \\frac{2}{6} \\times 14\\,\\text{MeV} = \\frac{1}{3} \\times 14\\,\\text{MeV} \\approx 4.666... \\,\\text{MeV}\n$$\nRounded to three decimal places, this is $4.667\\,\\text{MeV}$.\n\nTest $4$: $A = 7$, occupied quanta $[0,0,0,0,1,1,1]$, $\\hbar\\Omega = 13\\,\\text{MeV}$.\nThe total quanta is $N_{\\text{tot}} = 0 + 0 + 0 + 0 + 1 + 1 + 1 = 3$.\n$$\n\\Delta E_{\\text{spur}} = \\frac{3}{7} \\times 13\\,\\text{MeV} = \\frac{39}{7}\\,\\text{MeV} \\approx 5.5714... \\,\\text{MeV}\n$$\nRounded to three decimal places, this is $5.571\\,\\text{MeV}$.\n\nTest $5$: $A = 8$, occupied quanta $[0,0,0,0,1,1,1,1]$, $\\hbar\\Omega = 12\\,\\text{MeV}$.\nThe total quanta is $N_{\\text{tot}} = 0 + 0 + 0 + 0 + 1 + 1 + 1 + 1 = 4$.\n$$\n\\Delta E_{\\text{spur}} = \\frac{4}{8} \\times 12\\,\\text{MeV} = \\frac{1}{2} \\times 12\\,\\text{MeV} = 6.0\\,\\text{MeV}\n$$\n\nThe final results are collected and formatted as requested.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the reduction in spurious binding energy for a set of light nuclei\n    in a harmonic oscillator basis.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (A, quanta_list, hbar_omega_in_MeV)\n    test_cases = [\n        (4, [0, 0, 0, 0], 20),           # Test 1: A=4, He-4 (closed s-shell)\n        (5, [0, 0, 0, 0, 1], 15),       # Test 2: A=5, He-5/Li-5\n        (6, [0, 0, 0, 0, 1, 1], 14),     # Test 3: A=6, Li-6/Be-6\n        (7, [0, 0, 0, 0, 1, 1, 1], 13), # Test 4: A=7, Li-7/Be-7\n        (8, [0, 0, 0, 0, 1, 1, 1, 1], 12)  # Test 5: A=8, Be-8\n    ]\n\n    results = []\n    for case in test_cases:\n        # Unpack the parameters for the current test case.\n        A, quanta_list, hbar_omega = case\n        \n        # Calculate N_tot, the sum of oscillator quanta for all occupied states.\n        # numpy.sum is used for clarity, though standard sum() works as well.\n        N_tot = np.sum(quanta_list)\n        \n        # Calculate the spurious binding contribution using the provided formula:\n        # Delta_E_spur = (N_tot / A) * hbar_omega\n        # This check avoids division by zero, although not expected in this problem.\n        if A > 0:\n            delta_e_spur = (N_tot / A) * hbar_omega\n        else:\n            delta_e_spur = 0.0\n            \n        # Round the result to three decimal places as required.\n        rounded_result = round(delta_e_spur, 3)\n        results.append(rounded_result)\n\n    # Format the final output as a comma-separated list in square brackets.\n    # The map(str, ...) converts each number in the results list to a string.\n    # ','.join(...) then concatenates these strings with a comma.\n    output_string = f\"[{','.join(map(str, results))}]\"\n    \n    # Final print statement in the exact required format.\n    print(output_string)\n\nsolve()\n```"
        }
    ]
}