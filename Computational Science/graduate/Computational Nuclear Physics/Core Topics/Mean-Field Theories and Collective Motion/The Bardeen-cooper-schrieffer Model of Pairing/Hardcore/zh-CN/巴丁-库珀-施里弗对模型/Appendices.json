{
    "hands_on_practices": [
        {
            "introduction": "本章的第一个实践练习将引导你从第一性原理出发，在一个对称的、可解析求解的两能级模型中推导BCS方程的解。这个练习的价值不仅在于掌握BCS形式体系的核心数学推导，还在于通过将其结果与小系统（其中精确对角化可行）的精确解进行比较，从而让你对平均场近似的有效性和局限性有一个具体的、定量的认识。",
            "id": "3594122",
            "problem": "考虑一个对称双能级常数配对模型，用于描述跨越费米能的两个壳模型轨道中的同类核子。相对于化学势，单粒子能级的能量为 $+\\epsilon$ 和 $-\\epsilon$，每个能级的对简并度为 $\\Omega$（即，每个能级包含 $\\Omega$ 个时间反演对轨道）。配对哈密顿量为\n$$\nH \\;=\\; \\sum_{j=\\pm} \\epsilon_{j} \\, N_{j} \\;-\\; G \\sum_{j,l=\\pm} P_{j}^{\\dagger} P_{l},\n$$\n其中 $\\epsilon_{+} = +\\epsilon$、$\\epsilon_{-} = -\\epsilon$，$N_{j}$ 计算能级 $j$ 中的粒子数，而 $P_{j}^{\\dagger} \\equiv \\sum_{m0} c_{j m}^{\\dagger} c_{j \\bar{m}}^{\\dagger}$ 在能级 $j$ 中创建一个对（$c_{j m}^{\\dagger}$ 在能级 $j$ 的单粒子态 $m$ 中创建一个核子，$c_{j \\bar{m}}^{\\dagger}$ 创建其时间反演伴侣）。该体系为对半填充，$N_{\\text{pairs}} = \\Omega$，因此总对容量 $2\\Omega$ 中恰好有一半被占据。\n\n使用 Bardeen-Cooper-Schrieffer (BCS) 变分框架，并设均匀配对强度 $G>0$：\n\n- 从第一性原理出发（从 BCS 变分拟设及其自洽条件开始），推导该对称双能级模型在半填充情况下的 BCS 方程的解析解。特别地，通过对称性确定化学势的值，并获得配对能隙 $\\Delta$ 关于 $\\epsilon$、$G$ 和 $\\Omega$ 的闭合形式表达式。\n\n- 从 $H$ 的 BCS 期望值和能隙自洽关系出发，推导该双能级模型中 BCS 基态能量 $E_{\\text{BCS}}$ 的解析闭合形式表达式，该表达式仅依赖于 $\\epsilon$、$G$ 和 $\\Omega$（不含中间变量 $u_{j}$、$v_{j}$ 或 $\\mu$）。\n\n- 对于 $\\Omega = 1$ 的有限体系，通过在由 $\\{\\,|1\\rangle = P_{-}^{\\dagger} |0\\rangle,\\; |2\\rangle = P_{+}^{\\dagger} |0\\rangle\\,\\}$ 张成的一对子空间中对角化 $H$，计算精确的 seniority-zero 基态能量 $E_{\\text{exact}}$。然后，对于参数值 $\\epsilon = 0.50 \\text{ MeV}$ 和 $G = 0.60 \\text{ MeV}$，计算分数能量误差\n$$\n\\delta \\;=\\; \\frac{E_{\\text{BCS}} - E_{\\text{exact}}}{|E_{\\text{exact}}|},\n$$\n将 $\\delta$ 的最终数值四舍五入到四位有效数字。将最终数字表示为纯小数（不带百分号）。",
            "solution": "在进行求解之前，对问题进行验证。\n\n### 步骤 1：提取已知条件\n- **模型**：同类核子的对称双能级常数配对模型。\n- **单粒子能级**：能量表述为相对于化学势的“$+\\epsilon$”和“$-\\epsilon$”。哈密顿量中给出了 `ε_+ = +ε` 和 `ε_- = -ε`，这澄清了这些是裸单粒子能量。\n- **对简并度**：每个能级 `j` 的对简по为 `Ω`。\n- **哈密顿量**：$H = \\sum_{j=\\pm} \\epsilon_{j} \\, N_{j} - G \\sum_{j,l=\\pm} P_{j}^{\\dagger} P_{l}$。\n- **算符**：$N_{j}$ 是能级 $j$ 的粒子数算符。$P_{j}^{\\dagger} \\equiv \\sum_{m0} c_{j m}^{\\dagger} c_{j \\bar{m}}^{\\dagger}$ 是能级 $j$ 的对产生算符。\n- **配对强度**：$G0$。\n- **占据情况**：该体系为对半填充，$N_{\\text{pairs}} = \\Omega$。\n- **任务 1**：使用 Bardeen-Cooper-Schrieffer (BCS) 框架，推导化学势 $\\mu$ 和配对能隙 $\\Delta$ 关于 $\\epsilon$、$G$ 和 $\\Omega$ 的表达式。\n- **任务 2**：推导 BCS 基态能量 $E_{\\text{BCS}}$ 关于 $\\epsilon$、$G$ 和 $\\Omega$ 的表达式。\n- **任务 3**：对于 $\\Omega = 1$，通过在由 $\\{|1\\rangle = P_{-}^{\\dagger} |0\\rangle,\\; |2\\rangle = P_{+}^{\\dagger} |0\\rangle\\}$ 张成的一对子空间中对角化 $H$，计算精确的 seniority-zero 基态能量 $E_{\\text{exact}}$。\n- **任务 4**：对于参数值 $\\epsilon = 0.50 \\text{ MeV}$ 和 $G = 0.60 \\text{ MeV}$，计算分数能量误差 $\\delta = \\frac{E_{\\text{BCS}} - E_{\\text{exact}}}{|E_{\\text{exact}}|}$，结果四舍五入到四位有效数字。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据**：该问题基于成熟的 BCS 超导理论，并应用于核物理中的标准配对模型。所涉及的哈密顿量和概念是核多体理论的基础。\n- **适定性**：该问题是适定的。它要求进行推导和计算，这些都遵循理论物理中的标准、可解过程（变分最小化、矩阵对角化）。\n- **客观性**：语言客观而精确。\n- **完整性和一致性**：模型被完全指定。短语“相对于化学势”的歧义性通过后续指令“通过对称性确定化学势的值”得以解决，这表明 $\\mu$ 是待定值，而非假定值。半填充条件 $N_{\\text{pairs}} = \\Omega$ 与总对容量 $2\\Omega$ 一致。\n- **真实性**：该模型是一个简化模型，但在教学和研究中作为一个经典范例。所提供的数值在核结构背景下是物理合理的。\n- **平凡性**：该问题不平凡，需要多步推导和计算，考验对 BCS 形式体系及其与精确解关系的扎实理解。\n\n### 步骤 3：结论与行动\n问题被判定为 **有效**。将提供完整解答。\n\n### 双能级模型的 BCS 解\n\nBCS 理论对配对系统的基态采用变分拟设。基态被近似为每个能级 $j$ 的对关联态的乘积：\n$$\n|\\text{BCS}\\rangle = \\prod_{j, m0} (u_j + v_j c_{jm}^{\\dagger} c_{j\\bar{m}}^{\\dagger}) |0\\rangle\n$$\n其中 $u_j$ 和 $v_j$ 是满足归一化条件 $u_j^2 + v_j^2 = 1$ 的实变分参数。参数 $v_j^2$ 表示壳层 $j$ 中的一个对轨道 $(m, \\bar{m})$ 被占据的概率，$u_j^2$ 表示它为空的概率。\n\n为找到最优的 $u_j$ 和 $v_j$，我们最小化巨势算符 $\\hat{K} = H - \\mu N$ 的期望值，其中 $H$ 是哈密顿量，$N = \\sum_j N_j$ 是总粒子数算符，$\\mu$ 是化学势。\n\nBCS 态中粒子数算符和对算符的期望值为：\n$$\n\\langle N_j \\rangle = 2\\Omega v_j^2 \\quad \\text{and} \\quad \\langle P_j^\\dagger \\rangle = \\langle P_j \\rangle = \\Omega u_j v_j\n$$\n$\\langle N_j \\rangle$ 中的因子 $2$ 是因为 $N_j$ 计算的是粒子数而不是对数，并且在能级 $j$ 中有 $\\Omega$ 个对态。\n在平均场近似中，配对项的期望值为 $\\langle \\sum_{j,l} P_j^\\dagger P_l \\rangle \\approx (\\sum_j \\langle P_j^\\dagger \\rangle)(\\sum_l \\langle P_l \\rangle)$。\n巨势的期望值为：\n$$\n\\langle \\hat{K} \\rangle = \\sum_{j=\\pm} \\langle \\epsilon_j N_j - \\mu N_j \\rangle - G \\left( \\sum_{j=\\pm} \\langle P_j^\\dagger \\rangle \\right) \\left( \\sum_{l=\\pm} \\langle P_l \\rangle \\right) \\\\\n= \\sum_{j=\\pm} 2\\Omega (\\epsilon_j - \\mu) v_j^2 - G \\left( \\sum_{j=\\pm} \\Omega u_j v_j \\right)^2\n$$\n配对能隙 $\\Delta$ 由自洽关系 $\\Delta = G \\sum_j \\langle P_j \\rangle = G \\sum_j \\Omega u_j v_j$ 定义。代入此式，我们得到：\n$$\n\\langle \\hat{K} \\rangle = \\sum_{j=\\pm} 2\\Omega (\\epsilon_j - \\mu) v_j^2 - \\frac{\\Delta^2}{G}\n$$\n在 $\\Delta$ 定义的约束下，对 $v_j$ (以及 $u_j = \\sqrt{1-v_j^2}$) 最小化 $\\langle \\hat{K} \\rangle$，得到标准的 BCS 方程：\n$$\nu_j^2 = \\frac{1}{2} \\left(1 + \\frac{\\epsilon_j - \\mu}{E_j}\\right), \\quad v_j^2 = \\frac{1}{2} \\left(1 - \\frac{\\epsilon_j - \\mu}{E_j}\\right), \\quad u_j v_j = \\frac{\\Delta}{2E_j}\n$$\n其中 $E_j = \\sqrt{(\\epsilon_j - \\mu)^2 + \\Delta^2}$ 是能级 $j$ 的准粒子能量。\n\n$\\mu$ 和 $\\Delta$ 的自洽条件是粒子数方程和能隙方程。\n总粒子数为 $N = 2 N_{\\text{pairs}} = 2\\Omega$。\n$$\nN = \\sum_{j=\\pm} \\langle N_j \\rangle = \\sum_{j=\\pm} 2\\Omega v_j^2 = 2\\Omega \\implies \\sum_{j=\\pm} v_j^2 = 1\n$$\n$$\nv_-^2 + v_+^2 = \\frac{1}{2} \\left(1 - \\frac{-\\epsilon - \\mu}{E_-}\\right) + \\frac{1}{2} \\left(1 - \\frac{\\epsilon - \\mu}{E_+}\\right) = 1\n$$\n$$\n1 - \\frac{1}{2} \\left( \\frac{-\\epsilon - \\mu}{E_-} + \\frac{\\epsilon - \\mu}{E_+} \\right) = 1 \\implies \\frac{\\epsilon + \\mu}{E_-} + \\frac{\\epsilon - \\mu}{E_+} = 0\n$$\n其中 $E_- = \\sqrt{(-\\epsilon-\\mu)^2 + \\Delta^2} = \\sqrt{(\\epsilon+\\mu)^2 + \\Delta^2}$ 且 $E_+ = \\sqrt{(\\epsilon-\\mu)^2 + \\Delta^2}$。\n方程变为 $(\\epsilon + \\mu)E_+ = -(\\epsilon - \\mu)E_-$。两边平方：\n$$\n(\\epsilon + \\mu)^2 E_+^2 = (\\epsilon - \\mu)^2 E_-^2 \\\\\n(\\epsilon + \\mu)^2 [(\\epsilon - \\mu)^2 + \\Delta^2] = (\\epsilon - \\mu)^2 [(\\epsilon + \\mu)^2 + \\Delta^2] \\\\\n(\\epsilon + \\mu)^2 \\Delta^2 = (\\epsilon - \\mu)^2 \\Delta^2\n$$\n假设存在非平凡的配对解（$\\Delta \\neq 0$），则必须有 $(\\epsilon + \\mu)^2 = (\\epsilon - \\mu)^2$。这给出两种可能性：$\\epsilon + \\mu = \\epsilon - \\mu$，意味着 $\\mu = 0$；或者 $\\epsilon + \\mu = -(\\epsilon - \\mu)$，意味着 $\\epsilon = 0$。由于 $\\epsilon$ 是给定参数，解为 $\\mu = 0$。由于对称的能级排布和半填充条件，这个结果是符合预期的。\n\n当 $\\mu=0$ 时，能隙方程 $\\Delta = G \\sum_j \\Omega u_j v_j$ 变为：\n$$\n\\Delta = G \\sum_{j=\\pm} \\Omega \\frac{\\Delta}{2E_j} \\implies 1 = \\frac{G\\Omega}{2} \\sum_{j=\\pm} \\frac{1}{E_j}\n$$\n当 $\\mu=0$ 时，$E_j = \\sqrt{\\epsilon_j^2 + \\Delta^2}$。由于 $\\epsilon_-^2 = (-\\epsilon)^2 = \\epsilon^2$ 且 $\\epsilon_+^2 = \\epsilon^2$，两个准粒子能量相等：$E_- = E_+ = \\sqrt{\\epsilon^2 + \\Delta^2}$。\n$$\n1 = \\frac{G\\Omega}{2} \\left( \\frac{1}{\\sqrt{\\epsilon^2 + \\Delta^2}} + \\frac{1}{\\sqrt{\\epsilon^2 + \\Delta^2}} \\right) = \\frac{G\\Omega}{2} \\frac{2}{\\sqrt{\\epsilon^2 + \\Delta^2}} = \\frac{G\\Omega}{\\sqrt{\\epsilon^2 + \\Delta^2}}\n$$\n求解 $\\Delta$：\n$$\n\\sqrt{\\epsilon^2 + \\Delta^2} = G\\Omega \\implies \\epsilon^2 + \\Delta^2 = (G\\Omega)^2 \\implies \\Delta^2 = (G\\Omega)^2 - \\epsilon^2\n$$\n这给出了配对能隙的解析表达式：\n$$\n\\Delta = \\sqrt{(G\\Omega)^2 - \\epsilon^2}\n$$\n该解在 $G\\Omega  \\epsilon$ 时存在。如果 $G\\Omega \\le \\epsilon$，唯一的解是 $\\Delta=0$（正常、非超流态）。\n\n### BCS 基态能量\n\nBCS 基态能量 $E_{\\text{BCS}}$ 是哈密顿量 $H$ 在 BCS 态中的期望值：\n$$\nE_{\\text{BCS}} = \\langle H \\rangle = \\sum_{j=\\pm} \\epsilon_j \\langle N_j \\rangle - G \\left( \\sum_{j=\\pm} \\langle P_j \\rangle \\right)^2 = \\sum_{j=\\pm} 2\\Omega \\epsilon_j v_j^2 - \\frac{\\Delta^2}{G}\n$$\n使用 $\\mu=0$，$v_j^2 = \\frac{1}{2} (1 - \\epsilon_j/E_j)$，其中 $E_j = \\sqrt{\\epsilon_j^2+\\Delta^2}$。\n$$\nE_{\\text{BCS}} = \\sum_{j=\\pm} 2\\Omega \\epsilon_j \\frac{1}{2} \\left(1 - \\frac{\\epsilon_j}{E_j}\\right) - \\frac{\\Delta^2}{G} = \\Omega \\sum_{j=\\pm} \\left( \\epsilon_j - \\frac{\\epsilon_j^2}{E_j} \\right) - \\frac{\\Delta^2}{G}\n$$\n我们来计算这个和：\n$$\n\\sum_{j=\\pm} \\left( \\epsilon_j - \\frac{\\epsilon_j^2}{E_j} \\right) = \\left( \\epsilon_+ - \\frac{\\epsilon_+^2}{E_+} \\right) + \\left( \\epsilon_- - \\frac{\\epsilon_-^2}{E_-} \\right)\n$$\n当 $\\epsilon_+ = \\epsilon$，$\\epsilon_- = -\\epsilon$，且 $E_+ = E_- = \\sqrt{\\epsilon^2+\\Delta^2} = E$ 时：\n$$\n= \\left( \\epsilon - \\frac{\\epsilon^2}{E} \\right) + \\left( -\\epsilon - \\frac{(-\\epsilon)^2}{E} \\right) = \\epsilon - \\frac{\\epsilon^2}{E} -\\epsilon - \\frac{\\epsilon^2}{E} = -\\frac{2\\epsilon^2}{E}\n$$\n将此结果代回 $E_{\\text{BCS}}$ 的表达式：\n$$\nE_{\\text{BCS}} = \\Omega \\left( -\\frac{2\\epsilon^2}{E} \\right) - \\frac{\\Delta^2}{G} = -\\frac{2\\Omega\\epsilon^2}{\\sqrt{\\epsilon^2+\\Delta^2}} - \\frac{\\Delta^2}{G}\n$$\n现在，我们代入能隙方程的结果：$\\sqrt{\\epsilon^2+\\Delta^2} = G\\Omega$ 和 $\\Delta^2 = (G\\Omega)^2 - \\epsilon^2$。\n$$\nE_{\\text{BCS}} = -\\frac{2\\Omega\\epsilon^2}{G\\Omega} - \\frac{(G\\Omega)^2 - \\epsilon^2}{G} = -\\frac{2\\epsilon^2}{G} - \\frac{G^2\\Omega^2 - \\epsilon^2}{G}\n$$\n$$\nE_{\\text{BCS}} = \\frac{-2\\epsilon^2 - G^2\\Omega^2 + \\epsilon^2}{G} = \\frac{-\\epsilon^2 - G^2\\Omega^2}{G} = -\\frac{\\epsilon^2}{G} - G\\Omega^2\n$$\n\n### $\\Omega=1$ 时的精确解与分数误差\n\n对于 $\\Omega = 1$，系统包含 $N_{\\text{pairs}}=1$ 个对。具有一个对的 seniority-zero 态的基为 $\\{|1\\rangle = P_{-}^{\\dagger} |0\\rangle, |2\\rangle = P_{+}^{\\dagger} |0\\rangle\\}$。我们在这个正交归一基中构造哈密顿矩阵。\n哈密顿量为 $H = \\epsilon N_+ - \\epsilon N_- - G(P_+^\\dagger + P_-^\\dagger)(P_+ + P_-)$。\n单粒子部分对基态的作用：\n$$\n(\\epsilon N_+ - \\epsilon N_-) |1\\rangle = -\\epsilon N_- P_-^\\dagger |0\\rangle = -2\\epsilon |1\\rangle\n$$\n$$\n(\\epsilon N_+ - \\epsilon N_-) |2\\rangle = \\epsilon N_+ P_+^\\dagger |0\\rangle = 2\\epsilon |2\\rangle\n$$\n配对部分 $H_p = -G(P_+^\\dagger P_+ + P_-^\\dagger P_- + P_+^\\dagger P_- + P_-^\\dagger P_+)$ 的作用需要计算矩阵元 $\\langle i | H_p | j \\rangle$。对于 $\\Omega=1$，配对算符的 SU(2) 代数提供了对易关系 $[P_j, P_l^\\dagger] = \\delta_{jl}(1-N_j)$。\n$H_{11} = \\langle 1|H|1\\rangle = -2\\epsilon + \\langle 1 | H_p | 1 \\rangle$。\n$\\langle 1 | H_p | 1 \\rangle = \\langle 0 | P_- H_p P_-^\\dagger | 0 \\rangle = -G \\langle 0 | P_-(P_+^\\dagger P_+ + \\dots) P_-^\\dagger | 0 \\rangle$。唯一非零的项来自 $P_-^\\dagger P_-$。\n$\\langle 1|H_p|1\\rangle = -G \\langle 1 | P_-^\\dagger P_- | 1 \\rangle$。使用关系 $P_-|1\\rangle = P_-P_-^\\dagger|0\\rangle = [P_-,P_-^\\dagger]|0\\rangle = (1-N_-)|0\\rangle = |0\\rangle$。因此 $P_-^\\dagger P_-|1\\rangle=P_-^\\dagger|0\\rangle=0$。这是不正确的。玻色子的一般公式不直接适用。\n我们使用作用于 seniority-zero 态的显式规则。配对项 $P_j^\\dagger P_l$ 连接相差一个对的态。\n$\\langle i|H|j \\rangle = \\langle 0 | P_i H P_j^\\dagger | 0 \\rangle$。\n$H_{11} = \\langle 1 | H | 1 \\rangle = \\langle 0 | P_- H P_-^\\dagger | 0 \\rangle = \\langle 0 | P_- (-2\\epsilon P_-^\\dagger) |0\\rangle - G \\sum_{k,l} \\langle 0 | P_- P_k^\\dagger P_l P_-^\\dagger |0\\rangle$。\n$H_{11} = -2\\epsilon \\langle 0 | P_- P_-^\\dagger |0 \\rangle - G \\langle 0| P_- P_-^\\dagger P_- P_-^\\dagger |0\\rangle - G \\langle 0| P_- P_+^\\dagger P_- P_-^\\dagger |0\\rangle$。\n使用 $\\langle 0 | P_i P_j^\\dagger |0 \\rangle = \\delta_{ij}$，$H_{11} = -2\\epsilon - G$。\n$H_{22} = \\langle 2 | H | 2 \\rangle = 2\\epsilon - G \\langle 2 | P_+^\\dagger P_+ | 2 \\rangle = 2\\epsilon - G$。\n$H_{12} = \\langle 1 | H | 2 \\rangle = \\langle 0 | P_- H P_+^\\dagger | 0 \\rangle$。单粒子部分是对角的，因此没有贡献。\n$H_{12} = -G \\sum_{k,l} \\langle 0 | P_- P_k^\\dagger P_l P_+^\\dagger |0\\rangle = -G \\langle 0| P_- P_-^\\dagger P_+ P_+^\\dagger|0\\rangle = -G$。\n根据厄米性，$H_{21} = H_{12}^* = -G$。\n哈密顿矩阵是：\n$$\n\\mathbf{H} = \\begin{pmatrix} -2\\epsilon - G  -G \\\\ -G  2\\epsilon - G \\end{pmatrix}\n$$\n通过 $\\det(\\mathbf{H} - E\\mathbf{I}) = 0$ 求特征值 $E$：\n$$\n(-2\\epsilon - G - E)(2\\epsilon - G - E) - G^2 = 0 \\\\\n(-(G+E) - 2\\epsilon)(-(G+E) + 2\\epsilon) - G^2 = 0 \\\\\n(G+E)^2 - (2\\epsilon)^2 - G^2 = 0 \\\\\n(G+E)^2 = 4\\epsilon^2 + G^2 \\\\\nG+E = \\pm\\sqrt{4\\epsilon^2 + G^2} \\implies E = -G \\pm \\sqrt{4\\epsilon^2 + G^2}\n$$\n精确基态能量是较小的那个特征值：\n$$\nE_{\\text{exact}} = -G - \\sqrt{4\\epsilon^2 + G^2}\n$$\n\n现在，我们计算当 $\\epsilon = 0.50 \\text{ MeV}$、$G = 0.60 \\text{ MeV}$ 和 $\\Omega = 1$ 时的分数误差 $\\delta$。\n\nBCS 能量：\n$$\nE_{\\text{BCS}} = -\\frac{\\epsilon^2}{G} - G\\Omega^2 = -\\frac{(0.50)^2}{0.60} - (0.60)(1)^2 = -\\frac{0.25}{0.60} - 0.60 = -\\frac{5}{12} - 0.60 \\approx -0.416667 - 0.60 = -1.016667 \\text{ MeV}\n$$\n精确能量：\n$$\nE_{\\text{exact}} = -0.60 - \\sqrt{4(0.50)^2 + (0.60)^2} = -0.60 - \\sqrt{4(0.25) + 0.36} = -0.60 - \\sqrt{1.00 + 0.36} = -0.60 - \\sqrt{1.36}\n$$\n$$\nE_{\\text{exact}} \\approx -0.60 - 1.166190 = -1.766190 \\text{ MeV}\n$$\n分数误差 $\\delta$：\n$$\n\\delta = \\frac{E_{\\text{BCS}} - E_{\\text{exact}}}{|E_{\\text{exact}}|} = \\frac{-1.016667 - (-1.766190)}{|-1.766190|} = \\frac{0.749523}{1.766190} \\approx 0.424360\n$$\n四舍五入到四位有效数字，我们得到 $\\delta = 0.4244$。",
            "answer": "$$\n\\boxed{0.4244}\n$$"
        },
        {
            "introduction": "BCS理论的一个核心特征是它在巨正则系综中构建，这导致其基态波函数并不是粒子数算符的本征态。这个练习旨在深入探讨这一概念，你将推导并计算BCS态中的粒子数涨落（或方差）。量化这种粒子数不守恒性对于理解BCS理论应用于原子核等有限系统时的物理含义和潜在修正至关重要。",
            "id": "3594137",
            "problem": "考虑一个适用于中等质量核的有限价空间，该空间由 $K$ 对时间反演的单粒子态 $\\{k,\\bar{k}\\}$（Kramers 简并）张成。巴丁-库珀-施里弗（BCS）态定义为归一化的乘积态\n$$\n|\\Phi\\rangle \\equiv \\prod_{k=1}^{K} \\left(u_{k} + v_{k}\\,a_{k}^{\\dagger}a_{\\bar{k}}^{\\dagger}\\right)|0\\rangle,\n$$\n其中 $a_{k}^{\\dagger}$ 在态 $k$ 上产生一个核子，$a_{\\bar{k}}^{\\dagger}$ 产生其时间反演伴态，且实数 BCS 振幅满足 $u_{k}^{2} + v_{k}^{2} = 1$。粒子数算符为\n$$\n\\hat{N} \\equiv \\sum_{k=1}^{K}\\left(a_{k}^{\\dagger}a_{k} + a_{\\bar{k}}^{\\dagger}a_{\\bar{k}}\\right).\n$$\n仅从这些定义、费米子的正则反对易关系以及乘积态中期望值的标准性质出发，完成以下任务：\n\n1) 推导粒子数方差\n$$\n\\sigma_{N}^{2} \\equiv \\langle \\Phi|\\hat{N}^{2}|\\Phi\\rangle - \\langle \\Phi|\\hat{N}|\\Phi\\rangle^{2}\n$$\n的一个完全用 $\\{u_{k},v_{k}\\}$ 表示的显式表达式。\n\n2) 现在，专门考虑一个示意性的常数能隙平均场，其特征是实数配对能隙 $\\Delta$ 和化学势 $\\mu$，准粒子能量 $E_{k}$ 依赖于单粒子能量偏移 $\\xi_{k} \\equiv \\epsilon_{k} - \\mu$。考虑一个包含 $K = 6$ 个对轨道的模型空间，其能量偏移为\n$$\n\\{\\xi_{k}\\} = \\{-1.5,\\,-1.0,\\,-0.5,\\,+0.5,\\,+1.0,\\,+1.5\\}\\ \\text{MeV},\n$$\n并取 $\\Delta = 0.80\\ \\text{MeV}$ 和 $\\mu = 0\\ \\text{MeV}$。仅使用 $\\{u_{k},v_{k}\\}$、$\\{\\xi_{k}\\}$ 和 $\\{E_{k}\\}$ 之间的标准 BCS 关系，计算该模型空间的方差 $\\sigma_{N}^{2}$。\n\n将你计算的 $\\sigma_{N}^{2}$ 最终结果表示为一个纯数（无量纲），并四舍五入到四位有效数字。最终答案中不要包含单位。",
            "solution": "该问题分为两部分。第一部分要求推导巴丁-库珀-施里弗（BCS）态中粒子数方差 $\\sigma_{N}^{2}$ 的一个通用表达式。第二部分要求对一个特定的模型系统对该方差进行数值计算。\n\n### 第一部分：粒子数方差的推导\n\n粒子数方差定义为 $\\sigma_{N}^{2} \\equiv \\langle \\Phi|\\hat{N}^{2}|\\Phi\\rangle - \\langle \\Phi|\\hat{N}|\\Phi\\rangle^{2}$。我们将分别计算这两项。\n\nBCS 态由 $|\\Phi\\rangle = \\prod_{k=1}^{K} (u_{k} + v_{k}a_{k}^{\\dagger}a_{\\bar{k}}^{\\dagger})|0\\rangle$ 给出。我们将单个对能级 $k$ 的态表示为 $|\\phi_k\\rangle = (u_{k} + v_{k}a_{k}^{\\dagger}a_{\\bar{k}}^{\\dagger})|0\\rangle$。总的态是 $|\\Phi\\rangle = \\prod_{k=1}^{K} |\\phi_k\\rangle$。归一化条件 $u_k^2 + v_k^2 = 1$ 确保每个 $|\\phi_k\\rangle$ 都是归一化的，即 $\\langle\\phi_k|\\phi_k\\rangle = u_k^2 + v_k^2 = 1$，这又确保了总态 $|\\Phi\\rangle$ 是归一化的。\n\n粒子数算符为 $\\hat{N} = \\sum_{j=1}^{K} \\hat{n}_j$，其中 $\\hat{n}_j = a_{j}^{\\dagger}a_{j} + a_{\\bar{j}}^{\\dagger}a_{\\bar{j}}$ 是对能级 $j$ 的粒子数算符。\n\n首先，我们计算总粒子数算符的期望值 $\\langle\\hat{N}\\rangle$。\n$$\n\\langle\\hat{N}\\rangle = \\langle\\Phi|\\sum_{k=1}^{K} \\hat{n}_k |\\Phi\\rangle = \\sum_{k=1}^{K} \\langle\\Phi| \\hat{n}_k |\\Phi\\rangle\n$$\n由于该态是乘积态，且 $\\hat{n}_k$ 只作用于能级 $k$ 内的态，因此可以简化为：\n$$\n\\langle\\hat{n}_k\\rangle = \\langle\\phi_k| \\hat{n}_k |\\phi_k\\rangle = \\langle 0 | (u_{k} + v_{k} a_{\\bar{k}}a_{k}) (a_{k}^{\\dagger}a_{k} + a_{\\bar{k}}^{\\dagger}a_{\\bar{k}}) (u_{k} + v_{k}a_{k}^{\\dagger}a_{\\bar{k}}^{\\dagger})|0\\rangle\n$$\n与左边的真空 bra $\\langle 0|$ 产生非零内积的唯一项是由 $v_k^2$ 交叉项产生的。\n$$\n\\langle\\hat{n}_k\\rangle = v_k^2 \\langle 0 | a_{\\bar{k}}a_{k} (a_{k}^{\\dagger}a_{k} + a_{\\bar{k}}^{\\dagger}a_{\\bar{k}}) a_{k}^{\\dagger}a_{\\bar{k}}^{\\dagger} |0\\rangle\n$$\n态 $a_{k}^{\\dagger}a_{\\bar{k}}^{\\dagger}|0\\rangle$ 是 $a_{k}^{\\dagger}a_{k}$ 的本征态，本征值为 $1$，也是 $a_{\\bar{k}}^{\\dagger}a_{\\bar{k}}$ 的本征态，本征值为 $1$。因此，它是 $\\hat{n}_k$ 的本征态，本征值为 $1+1=2$。\n$$\n\\langle\\hat{n}_k\\rangle = v_k^2 \\langle 0 | a_{\\bar{k}}a_{k} (2) a_{k}^{\\dagger}a_{\\bar{k}}^{\\dagger} |0\\rangle = 2v_k^2 \\langle 0 | a_{\\bar{k}}a_{k} a_{k}^{\\dagger}a_{\\bar{k}}^{\\dagger} |0\\rangle = 2v_k^2\n$$\n总平均粒子数是所有对能级的总和：\n$$\n\\langle\\hat{N}\\rangle = \\sum_{k=1}^{K} 2v_k^2\n$$\n接下来，我们计算 $\\hat{N}^2$ 的期望值。\n$$\n\\langle\\hat{N}^2\\rangle = \\langle\\Phi| \\left(\\sum_{k=1}^{K} \\hat{n}_k\\right)^2 |\\Phi\\rangle = \\langle\\Phi| \\left(\\sum_{k=1}^{K} \\hat{n}_k^2 + \\sum_{k \\neq j} \\hat{n}_k \\hat{n}_j\\right) |\\Phi\\rangle\n$$\n$$\n\\langle\\hat{N}^2\\rangle = \\sum_{k=1}^{K} \\langle\\Phi|\\hat{n}_k^2|\\Phi\\rangle + \\sum_{k \\neq j} \\langle\\Phi|\\hat{n}_k \\hat{n}_j|\\Phi\\rangle\n$$\n由于不同能级 $k$ 和 $j$ 的算符作用于乘积态 $|\\Phi\\rangle$ 的不同、独立的部分，所以乘积的期望值等于期望值的乘积：当 $k \\neq j$ 时，有 $\\langle\\hat{n}_k \\hat{n}_j\\rangle = \\langle\\hat{n}_k\\rangle\\langle\\hat{n}_j\\rangle$。\n$$\n\\langle\\hat{N}^2\\rangle = \\sum_{k=1}^{K} \\langle\\hat{n}_k^2\\rangle + \\sum_{k \\neq j} \\langle\\hat{n}_k\\rangle\\langle\\hat{n}_j\\rangle\n$$\n现在我们计算方差：\n$$\n\\sigma_{N}^{2} = \\langle\\hat{N}^2\\rangle - \\langle\\hat{N}\\rangle^2 = \\left(\\sum_k \\langle\\hat{n}_k^2\\rangle + \\sum_{k \\neq j} \\langle\\hat{n}_k\\rangle\\langle\\hat{n}_j\\rangle\\right) - \\left(\\sum_k \\langle\\hat{n}_k\\rangle\\right)^2\n$$\n和的平方是 $\\left(\\sum_k \\langle\\hat{n}_k\\rangle\\right)^2 = \\sum_k \\langle\\hat{n}_k\\rangle^2 + \\sum_{k \\neq j} \\langle\\hat{n}_k\\rangle\\langle\\hat{n}_j\\rangle$。\n将此代入方差表达式中，交叉项相互抵消：\n$$\n\\sigma_{N}^{2} = \\sum_k \\langle\\hat{n}_k^2\\rangle - \\sum_k \\langle\\hat{n}_k\\rangle^2 = \\sum_k \\left(\\langle\\hat{n}_k^2\\rangle - \\langle\\hat{n}_k\\rangle^2\\right) = \\sum_k \\sigma_{\\hat{n}_k}^2\n$$\n总方差是每个对能级方差的总和。能级 $k$ 的态是具有 $0$ 个粒子（概率为 $u_k^2$）和 $2$ 个粒子（概率为 $v_k^2$）的叠加态。我们可以根据此性质计算 $\\langle\\hat{n}_k^2\\rangle$。\n$$\n\\langle\\hat{n}_k^2\\rangle = (0^2) u_k^2 + (2^2) v_k^2 = 4v_k^2\n$$\n或者，使用算符：$\\hat{n}_k^2 = (a_{k}^{\\dagger}a_{k} + a_{\\bar{k}}^{\\dagger}a_{\\bar{k}})^2 = (a_{k}^{\\dagger}a_{k})^2 + (a_{\\bar{k}}^{\\dagger}a_{\\bar{k}})^2 + 2 a_{k}^{\\dagger}a_{k}a_{\\bar{k}}^{\\dagger}a_{\\bar{k}}$。由于 $a^\\dagger a$ 的本征值为 $0$ 和 $1$，所以 $(a^\\dagger a)^2=a^\\dagger a$。因此 $\\hat{n}_k^2 = \\hat{n}_k + 2 a_{k}^{\\dagger}a_{k}a_{\\bar{k}}^{\\dagger}a_{\\bar{k}}$。最后一项的期望值为 $2v_k^2$，所以 $\\langle\\hat{n}_k^2\\rangle = \\langle\\hat{n}_k\\rangle + 2v_k^2 = 2v_k^2 + 2v_k^2 = 4v_k^2$。\n\n能级 $k$ 的方差为：\n$$\n\\sigma_{\\hat{n}_k}^2 = \\langle\\hat{n}_k^2\\rangle - \\langle\\hat{n}_k\\rangle^2 = 4v_k^2 - (2v_k^2)^2 = 4v_k^2 - 4v_k^4 = 4v_k^2(1 - v_k^2)\n$$\n使用归一化条件 $u_k^2 + v_k^2 = 1$，我们得到 $1 - v_k^2 = u_k^2$。\n$$\n\\sigma_{\\hat{n}_k}^2 = 4u_k^2v_k^2\n$$\n总粒子数方差是所有能级的总和：\n$$\n\\sigma_{N}^{2} = \\sum_{k=1}^{K} 4u_k^2v_k^2\n$$\n这就完成了问题的第一部分。\n\n### 第二部分：数值计算\n\n对于第二部分，我们必须将 BCS 振幅 $\\{u_k, v_k\\}$ 与模型的物理参数联系起来。BCS 理论中的标准关系是：\n$$\nv_k^2 = \\frac{1}{2}\\left(1 - \\frac{\\xi_k}{E_k}\\right) \\quad \\text{and} \\quad u_k^2 = \\frac{1}{2}\\left(1 + \\frac{\\xi_k}{E_k}\\right)\n$$\n其中 $E_k = \\sqrt{\\xi_k^2 + \\Delta^2}$ 是能级 $k$ 的准粒子能量，$\\xi_k = \\epsilon_k - \\mu$ 是相对于化学势 $\\mu$ 的单粒子能量，而 $\\Delta$ 是配对能隙。\n\n我们将这些关系代入 $\\sigma_N^2$ 的表达式中：\n$$\n4u_k^2v_k^2 = 4 \\left[\\frac{1}{2}\\left(1 + \\frac{\\xi_k}{E_k}\\right)\\right] \\left[\\frac{1}{2}\\left(1 - \\frac{\\xi_k}{E_k}\\right)\\right] = \\left(1 - \\frac{\\xi_k^2}{E_k^2}\\right)\n$$\n现在，使用 $E_k^2 = \\xi_k^2 + \\Delta^2$：\n$$\n4u_k^2v_k^2 = 1 - \\frac{\\xi_k^2}{\\xi_k^2 + \\Delta^2} = \\frac{(\\xi_k^2 + \\Delta^2) - \\xi_k^2}{\\xi_k^2 + \\Delta^2} = \\frac{\\Delta^2}{\\xi_k^2 + \\Delta^2}\n$$\n总方差则由以下和式给出：\n$$\n\\sigma_{N}^{2} = \\sum_{k=1}^{K} \\frac{\\Delta^2}{\\xi_k^2 + \\Delta^2}\n$$\n现在我们使用给定的数值：$K = 6$，$\\Delta = 0.80\\ \\text{MeV}$，以及 $\\{\\xi_{k}\\} = \\{-1.5, -1.0, -0.5, +0.5, +1.0, +1.5\\}\\ \\text{MeV}$。\n配对能隙的平方是 $\\Delta^2 = (0.80)^2 = 0.64\\ \\text{MeV}^2$。\n$\\xi_k^2$ 的值为 $\\{2.25, 1.00, 0.25, 0.25, 1.00, 2.25\\}\\ \\text{MeV}^2$。\n$\\sigma_{N}^{2}$ 的和由 $K=6$ 个能级中的每一个的贡献组成。由于对 $\\xi_k^2$ 的依赖性，$\\xi_k = \\pm c$ 的能级贡献相等。\n$$\n\\sigma_N^2 = \\frac{0.64}{(-1.5)^2 + 0.64} + \\frac{0.64}{(-1.0)^2 + 0.64} + \\frac{0.64}{(-0.5)^2 + 0.64} + \\frac{0.64}{(0.5)^2 + 0.64} + \\frac{0.64}{(1.0)^2 + 0.64} + \\frac{0.64}{(1.5)^2 + 0.64}\n$$\n$$\n\\sigma_N^2 = 2 \\left( \\frac{0.64}{1.5^2 + 0.64} + \\frac{0.64}{1.0^2 + 0.64} + \\frac{0.64}{0.5^2 + 0.64} \\right)\n$$\n$$\n\\sigma_N^2 = 2 \\left( \\frac{0.64}{2.25 + 0.64} + \\frac{0.64}{1.00 + 0.64} + \\frac{0.64}{0.25 + 0.64} \\right)\n$$\n$$\n\\sigma_N^2 = 2 \\left( \\frac{0.64}{2.89} + \\frac{0.64}{1.64} + \\frac{0.64}{0.89} \\right)\n$$\n数值计算各项：\n$$\n\\frac{0.64}{2.89} \\approx 0.221453\n$$\n$$\n\\frac{0.64}{1.64} \\approx 0.390244\n$$\n$$\n\\frac{0.64}{0.89} \\approx 0.719101\n$$\n将这些贡献相加并乘以 $2$：\n$$\n\\sigma_N^2 \\approx 2 (0.221453 + 0.390244 + 0.719101) = 2 (1.330798) = 2.661596\n$$\n四舍五入到四位有效数字，我们得到 $\\sigma_N^2 = 2.662$。",
            "answer": "$$\\boxed{2.662}$$"
        },
        {
            "introduction": "在掌握了BCS理论的分析工具后，这个计算实践将带你进入更实际的应用。你将编写一个程序来求解BCS方程，并用它来研究核结构中的一个关键现象：幻数核处配对关联的抑制。通过这个练习，你将把抽象的BCS方程与可观测的结构效应联系起来，并亲眼见证配对强度或跨壳层相互作用如何恢复配对关联。",
            "id": "3594147",
            "problem": "你的任务是编写一个完整、可运行的程序，该程序使用 Bardeen-Cooper-Schrieffer (BCS) 框架，在一个原子核双壳层模型中演示闭合（幻数）壳层处配对关联的抑制，并量化恒定配对强度的小幅增加或包含跨壳层耦合如何恢复非零配对能隙。物理内容必须以数学上明确且单位一致的方式实现，以便仅凭逻辑就足以产生正确的数值输出。\n\n假设一个简化的 Bardeen-Cooper-Schrieffer (BCS) 哈密顿量，其具有大小为 $G$ 的恒定配对相互作用，该相互作用将时间反演对散射到不同的单粒子能级上。考虑一个双壳层模型，其单粒子能量 $\\{\\epsilon_k\\}$ 以兆电子伏特 (MeV) 为单位，对简并度为 $\\{\\Omega_k\\}$ (能级 $k$ 中不同时间反演对的数量)，总粒子数为 $N$。在零温下，BCS 方程为\n$$\n\\Delta = G \\sum_{k} \\Omega_k u_k v_k,\n$$\n$$\nN = 2 \\sum_{k} \\Omega_k v_k^2,\n$$\n其中\n$$\nu_k^2 = \\tfrac{1}{2}\\left(1 + \\frac{\\epsilon_k - \\mu}{E_k}\\right), \\quad\nv_k^2 = \\tfrac{1}{2}\\left(1 - \\frac{\\epsilon_k - \\mu}{E_k}\\right), \\quad\nE_k = \\sqrt{(\\epsilon_k - \\mu)^2 + \\Delta^2},\n$$\n这里 $\\Delta$ 是配对能隙，$\\mu$ 是化学势。对于恒定相互作用，可以消去显式的 $u_k v_k$ 因子，并将能隙方程写成标准形式\n$$\n1 = G \\sum_{k} \\frac{\\Omega_k}{2 E_k}.\n$$\n对于具有大主壳层间隙的双壳层模型中的闭合（幻数）壳层，如果只包含较低的壳层（没有跨壳层矩阵元），则较低的壳层被完全填满，而较高的壳层不在配对空间中；在这种情况下，粒子对不可能跨越壳层间隙进行散射，且唯一的自洽解是 $\\Delta = 0$。\n\n相比之下，当较低和较高的壳层都包含在配对空间中时（包含跨壳层矩阵元），只有当配对强度超过一个由 $\\Delta \\to 0$ 时的线性化能隙方程确定的临界值时，才会出现非平凡解 $\\Delta \\neq 0$。对于一个能量为 $\\epsilon_L = -E_{\\text{gap}}/2$ 和 $\\epsilon_U = +E_{\\text{gap}}/2$、对简并度为 $\\Omega_L$ 和 $\\Omega_U$ 的双能级模型，在幻数 $N = 2 \\Omega_L$ 处，当 $\\Delta = 0$ 时化学势 $\\mu$ 位于能隙中，临界耦合强度为\n$$\nG_c = \\frac{E_{\\text{gap}}}{\\Omega_L + \\Omega_U}.\n$$\n对于 $G \\le G_c$，唯一的解是 $\\Delta = 0$；对于 $G  G_c$，一个有限的 $\\Delta$ 从 $\\Delta$ 和 $\\mu$ 的耦合方程的自洽解中出现。\n\n你的程序必须：\n- 在双壳层模型中实现上述零温 Bardeen-Cooper-Schrieffer (BCS) 方程，并在存在非平凡解时自洽地求解 $\\Delta$ 和 $\\mu$。\n- 当排除上层壳层时（无跨壳层耦合），检测具有大壳层间隙的幻数处的配对抑制。\n- 在两种不同变化下量化非零 $\\Delta$ 的恢复：(i) 在固定 $G$ 的情况下包含跨壳层矩阵元，以及 (ii) 当包含跨壳层耦合时，$G$ 小幅增加并越过临界阈值。\n- 一致地使用兆电子伏特 (MeV) 作为单位，并以 MeV 报告配对能隙。\n\n数值方法要求：\n- 当两个壳层都包含在内时，你必须通过分析 $\\Delta \\to 0$ 时的线性化能隙方程来确定是否存在非平凡解。对于上述双壳层情况，使用能隙中点的化学势 $\\mu = 0$ 来评估线性化判据。如果 $G \\le G_c$，则返回 $\\Delta = 0$。如果 $G  G_c$，则数值求解耦合方程以得到 $\\Delta$ 和 $\\mu$。\n- 当在幻数粒子数下只包含较低壳层时（无跨壳层耦合），返回 $\\Delta = 0$，不要尝试进行数值求解。\n- 对于非平凡解，使用任何适用于非线性系统的稳健数值方法求解 $\\Delta$ 和 $\\mu$ 的耦合方程。最终报告的 $\\Delta$ 必须精确到 $10^{-6}$ MeV 以内。\n\n测试套件：\n使用以下四个测试用例。在每个用例中，能量均以 MeV 为单位，输出必须是以 MeV 为单位的配对能隙 $\\Delta$。粒子数设置为与完全填充的较低壳层相对应的幻数值。\n\n- 测试用例 A (无跨壳层耦合时在幻数处的抑制)：\n  - 仅较低壳层：$\\{\\epsilon_L\\} = \\{-2.0\\}$, $\\{\\Omega_L\\} = \\{8\\}$。\n  - 排除较高壳层。\n  - 主壳层间隙参数供参考：$E_{\\text{gap}} = 4.0$。\n  - 粒子数：$N = 2 \\Omega_L = 16$。\n  - 配对强度：$G = 0.18$。\n  - 预期行为：$\\Delta = 0$。\n\n- 测试用例 B (在固定 $G$ 值下通过包含跨壳层耦合实现恢复)：\n  - 包含两个壳层：$\\{\\epsilon_L,\\epsilon_U\\} = \\{-2.0, +2.0\\}$, $\\{\\Omega_L,\\Omega_U\\} = \\{8, 16\\}$，因此 $E_{\\text{gap}} = 4.0$。\n  - 粒子数：$N = 16$。\n  - 配对强度：$G = 0.18$。\n  - 预期行为：$G > G_c = E_{\\text{gap}}/(\\Omega_L+\\Omega_U) = 4.0/(8+16) = 0.166\\overline{6}$，因此 $\\Delta > 0$。\n\n- 测试用例 C (低于阈值的 $G$ 值与跨壳层耦合)：\n  - 包含两个壳层：$\\{\\epsilon_L,\\epsilon_U\\} = \\{-2.0, +2.0\\}$, $\\{\\Omega_L,\\Omega_U\\} = \\{8, 16\\}$。\n  - 粒子数：$N = 16$。\n  - 配对强度：$G = 0.16$。\n  - 预期行为：$G  G_c$，因此 $\\Delta = 0$。\n\n- 测试用例 D (G 值小幅增加跨越阈值与跨壳层耦合)：\n  - 包含两个壳层：$\\{\\epsilon_L,\\epsilon_U\\} = \\{-2.0, +2.0\\}$, $\\{\\Omega_L,\\Omega_U\\} = \\{8, 16\\}$。\n  - 粒子数：$N = 16$。\n  - 配对强度：$G = 0.17$。\n  - 预期行为：$G$ 以微小幅度大于 $G_c$，因此 $\\Delta > 0$ 但很小。\n\n最终输出要求：\n- 对每个测试用例，计算以 MeV 为单位的配对能隙 $\\Delta$。\n- 将每个 $\\Delta$ 表示为精确到六位小数的浮点数 (MeV)。\n- 你的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表，顺序为 [A, B, C, D]。例如，一个有效的输出格式是\n\"[0.000000,0.123456,0.000000,0.012345]\"。",
            "solution": "该问题要求实现并求解一个双壳层原子核模型的零温 Bardeen-Cooper-Schrieffer (BCS) 方程，以演示和量化配对关联。我们必须在不同的物理条件下求解配对能隙 $\\Delta$ 和化学势 $\\mu$。\n\n控制系统的基本方程是 BCS 能隙方程和粒子数守恒方程。对于一组由 $k$ 索引的单粒子能级，其能量为 $\\epsilon_k$，对简并度为 $\\Omega_k$ (即可占据该能级的对的数量)，方程为：\n$$\n\\frac{1}{G} = \\sum_{k} \\frac{\\Omega_k}{2 E_k} \\quad (\\text{for } \\Delta \\neq 0)\n$$\n$$\nN = \\sum_{k} \\Omega_k \\left(1 - \\frac{\\epsilon_k - \\mu}{E_k}\\right)\n$$\n其中 $G$ 是恒定配对强度，$N$ 是总粒子数，$\\mu$ 是化学势，$E_k$ 是能级 $k$ 的准粒子能量：\n$$\nE_k = \\sqrt{(\\epsilon_k - \\mu)^2 + \\Delta^2}\n$$\n待求解的变量是配对能隙 $\\Delta$ 和化学势 $\\mu$。按照惯例，配对能隙 $\\Delta$ 是一个非负量。\n\n该问题指定了四个测试用例，它们属于不同的物理情景。我们将根据提供的模型参数分析每种情景。\n\n**情景 1：单个填充壳层 (测试用例 A)**\n此用例涉及一个单一壳层，指定为较低壳层 ($L$)，其能量为 $\\epsilon_L = -2.0$ MeV，对简并度为 $\\Omega_L = 8$。粒子数为 $N = 16$。这个数字正好对应于填充该壳层，因为 $N = 2 \\Omega_L = 2 \\times 8 = 16$。较高壳层被明确地从模型空间中排除。\n\n在 BCS 模型中，配对源于粒子对在不同单粒子能级之间的散射。当只有一个壳层存在并且它被完全填满时，没有可用的空态供粒子对散射进入，也没有来自其他能级的粒子对可以散射出去。这种情况被称为“阻塞效应 (blocking)”。配对相互作用变得无效，无法建立配对关联。在这种构型中，BCS 方程的唯一自洽解是平凡解，即配对能隙为零。\n因此，对于测试用例 A，我们得出结论 $\\Delta = 0$ MeV，无需进行数值计算。\n\n**情景 2：幻数处的双壳层模型 (测试用例 B, C, D)**\n这些用例涉及一个具有较低壳层 ($L$) 和较高壳层 ($U$) 的双壳层模型。参数如下：\n-   能量：$\\epsilon_L = -2.0$ MeV, $\\epsilon_U = +2.0$ MeV。主壳层间隙为 $E_{\\text{gap}} = \\epsilon_U - \\epsilon_L = 4.0$ MeV。\n-   简并度：$\\Omega_L = 8$, $\\Omega_U = 16$。\n-   粒子数：$N = 16 = 2 \\Omega_L$。这是一个对应于已填充较低壳层的“幻数”。\n\n在这种情景下，即使较低的壳层被填满，空的较高壳层的存在也为粒子对的散射提供了状态。如果配对强度 $G$ 足够大，能够克服将粒子对激发穿过壳层间隙 $E_{\\text{gap}}$ 所需的能量成本，那么一个非平凡的配对解 ($\\Delta  0$) 就可以存在。\n\n从平凡解 ($\\Delta = 0$) 到非平凡解 ($\\Delta  0$) 的转变发生在一个临界配对强度 $G_c$ 处。为了找到 $G_c$，我们在 $\\Delta \\to 0$ 的极限下分析能隙方程。在此极限下，方程变为：\n$$\n\\frac{1}{G} = \\sum_{k} \\frac{\\Omega_k}{2 |\\epsilon_k - \\mu|}\n$$\n对于对称双能级模型 ($\\epsilon_L = -\\epsilon_U$) 中的特定粒子数 $N = 2 \\Omega_L$，配对开始时的化学势正好位于能隙的中间，即 $\\mu = 0$。代入双壳层模型的参数：\n$$\n\\frac{1}{G_c} = \\frac{\\Omega_L}{2 |\\epsilon_L - 0|} + \\frac{\\Omega_U}{2 |\\epsilon_U - 0|} = \\frac{\\Omega_L}{2 (\\frac{E_{\\text{gap}}}{2})} + \\frac{\\Omega_U}{2 (\\frac{E_{\\text{gap}}}{2})} = \\frac{\\Omega_L + \\Omega_U}{E_{\\text{gap}}}\n$$\n这给出了临界耦合强度：\n$$\nG_c = \\frac{E_{\\text{gap}}}{\\Omega_L + \\Omega_U}\n$$\n对于我们的特定参数，$E_{\\text{gap}} = 4.0$ MeV, $\\Omega_L = 8$, 和 $\\Omega_U = 16$，临界强度为：\n$$\nG_c = \\frac{4.0}{8 + 16} = \\frac{4.0}{24} = \\frac{1}{6} \\approx 0.166667 \\text{ MeV}\n$$\n形式化的条件是：\n-   如果 $G \\le G_c$，唯一的解是平凡解，$\\Delta = 0$。\n-   如果 $G  G_c$，则存在一个非平凡解 $\\Delta  0$，必须通过数值求解耦合的 BCS 方程来找到。\n\n我们现在将此判据应用于其余的测试用例。\n\n**测试用例 C：** $G = 0.16$ MeV。\n由于 $0.16  1/6$，配对强度是亚临界的。因此，$\\Delta = 0$ MeV。\n\n**测试用例 B 和 D：** 分别为 $G = 0.18$ MeV 和 $G = 0.17$ MeV。\n在这两种情况下，配对强度 $G$ 都大于 $G_c \\approx 0.166667$ MeV。因此，存在一个非平凡解 $\\Delta  0$。为了找到它，我们必须求解以下关于两个未知数 $\\Delta$ 和 $\\mu$ 的两个非线性方程组：\n$$\nf_1(\\Delta, \\mu) = \\frac{1}{G} - \\frac{\\Omega_L}{2 \\sqrt{(\\epsilon_L - \\mu)^2 + \\Delta^2}} - \\frac{\\Omega_U}{2 \\sqrt{(\\epsilon_U - \\mu)^2 + \\Delta^2}} = 0\n$$\n$$\nf_2(\\Delta, \\mu) = N - \\Omega_L \\left(1 - \\frac{\\epsilon_L - \\mu}{\\sqrt{(\\epsilon_L - \\mu)^2 + \\Delta^2}}\\right) - \\Omega_U \\left(1 - \\frac{\\epsilon_U - \\mu}{\\sqrt{(\\epsilon_U - \\mu)^2 + \\Delta^2}}\\right) = 0\n$$\n该系统使用数值求根算法求解，例如 Python 中的 `scipy.optimize.root`。为求解器提供一个合适的初始猜测至关重要。由于我们接近临界点，我们预计 $\\Delta$ 会很小，$\\mu$ 会接近 0。一个合理的初始猜测是 $(\\Delta_0, \\mu_0) = (0.1, 0.0)$。求解器迭代地改进这个猜测，直到残差 $f_1$ 和 $f_2$ 同时接近于零，满足最终 $\\Delta$ 的 $10^{-6}$ MeV 的指定容差。\n\n**各用例方法总结：**\n-   **用例 A**：一个填充壳层，无上层壳层。配对被阻塞。结果：$\\Delta = 0.0$。\n-   **用例 B**：双壳层，$G=0.18  G_c$。形成非平凡配对能隙 $\\Delta  0$。结果：数值求解。\n-   **用例 C**：双壳层，$G=0.16  G_c$。配对是亚临界的。结果：$\\Delta = 0.0$。\n-   **用例 D**：双壳层，$G=0.17  G_c$。配对刚刚超临界，形成一个虽小但非零的能隙 $\\Delta  0$。结果：数值求解。\n\n实现将精确地遵循此逻辑，对用例 B 和 D 中所需的数值解使用 `scipy.optimize.root`。",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import root\n\ndef solve():\n    \"\"\"\n    Solves the BCS equations for four test cases representing pairing suppression\n    and restoration in a nuclear two-shell model.\n    \"\"\"\n    \n    test_cases = [\n        # Case A: Lower shell only, magic number\n        {\n            \"name\": \"A\",\n            \"shells\": {\"eps\": np.array([-2.0]), \"omg\": np.array([8])},\n            \"N\": 16,\n            \"G\": 0.18,\n            \"type\": \"one_shell_magic\"\n        },\n        # Case B: Both shells, G > Gc\n        {\n            \"name\": \"B\",\n            \"shells\": {\"eps\": np.array([-2.0, 2.0]), \"omg\": np.array([8, 16])},\n            \"N\": 16,\n            \"G\": 0.18,\n            \"type\": \"two_shell\"\n        },\n        # Case C: Both shells, G  Gc\n        {\n            \"name\": \"C\",\n            \"shells\": {\"eps\": np.array([-2.0, 2.0]), \"omg\": np.array([8, 16])},\n            \"N\": 16,\n            \"G\": 0.16,\n            \"type\": \"two_shell\"\n        },\n        # Case D: Both shells, G slightly > Gc\n        {\n            \"name\": \"D\",\n            \"shells\": {\"eps\": np.array([-2.0, 2.0]), \"omg\": np.array([8, 16])},\n            \"N\": 16,\n            \"G\": 0.17,\n            \"type\": \"two_shell\"\n        }\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        delta_val = 0.0\n        \n        if case[\"type\"] == \"one_shell_magic\":\n            # For a single, completely filled shell, pairing is blocked.\n            # The particle number N = 16 equals 2 * Omega_L = 2 * 8.\n            # The only solution is the trivial one.\n            delta_val = 0.0\n        \n        elif case[\"type\"] == \"two_shell\":\n            eps = case[\"shells\"][\"eps\"]\n            omg = case[\"shells\"][\"omg\"]\n            G = case[\"G\"]\n            N = case[\"N\"]\n            \n            # For a two-shell model at the magic number N=2*Omega_L, a non-trivial\n            # solution exists only if G > Gc.\n            E_gap = eps[1] - eps[0]\n            G_c = E_gap / np.sum(omg)\n            \n            if G = G_c:\n                # Pairing strength is sub-critical.\n                delta_val = 0.0\n            else:\n                # Pairing strength is super-critical. Solve the coupled equations.\n                \n                def bcs_system(variables, G_val, eps_vals, omg_vals, N_val):\n                    \"\"\"\n                    Defines the system of coupled BCS equations to be solved.\n                    variables = [Delta, mu]\n                    \"\"\"\n                    delta, mu = variables[0], variables[1]\n                    \n                    # Ensure Delta is not exactly zero to avoid division by zero,\n                    # although the solver is unlikely to hit it if started from non-zero.\n                    # This also ensures sqrt is well-defined.\n                    safe_delta = max(abs(delta), 1e-12)\n\n                    # Quasiparticle energies\n                    E_k = np.sqrt((eps_vals - mu)**2 + safe_delta**2)\n                    \n                    # Gap equation residual\n                    # 1/G = sum(Omega_k / (2*E_k))\n                    gap_eq_residual = 1.0/G_val - np.sum(omg_vals / (2.0 * E_k))\n                    \n                    # Number equation residual\n                    # N = sum(Omega_k * (1 - (eps_k-mu)/E_k))\n                    num_eq_residual = N_val - np.sum(omg_vals * (1.0 - (eps_vals - mu) / E_k))\n                    \n                    return [gap_eq_residual, num_eq_residual]\n\n                # Initial guess [Delta, mu]. Near the critical point, Delta is small\n                # and mu is close to the mid-gap value (0).\n                initial_guess = [0.1, 0.0]\n                \n                # Solve the system of non-linear equations\n                solution = root(\n                    bcs_system, \n                    initial_guess, \n                    args=(G, eps, omg, N),\n                    method='hybr',\n                    tol=1e-9\n                )\n                \n                if solution.success:\n                    # The pairing gap Delta is conventionally taken as positive.\n                    delta_val = abs(solution.x[0])\n                else:\n                    # This should not happen for the given well-posed problems.\n                    # Fallback indicates solver failure.\n                    delta_val = -1.0 \n\n        results.append(delta_val)\n\n    # Format the results to exactly six decimal places and print.\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}