{
    "hands_on_practices": [
        {
            "introduction": "The first step in applying the Hartree-Fock-Bogoliubov (HFB) theory is to correctly implement the core Bogoliubov transformation itself. This involves constructing and diagonalizing the Bogoliubov-de Gennes (BdG) Hamiltonian, $\\mathcal{H}_{\\text{BdG}}$, to obtain the transformation matrices $U$ and $V$. The following exercise guides you through this fundamental process for a simple one-dimensional model, emphasizing a critical validation step: verifying the orthonormality relations that the matrices $U$ and $V$ must satisfy . Mastering this procedure ensures that your implementation correctly defines quasiparticles that obey fermionic statistics, providing a solid foundation for more complex applications.",
            "id": "3595364",
            "problem": "Consider a discretized one-dimensional nuclear mean-field model in the Hartree–Fock–Bogoliubov framework where pairing correlations are incorporated via the Bogoliubov–de Gennes (BdG) formalism. The canonical fermion operators satisfy the canonical anti-commutation relations $\\{\\hat{c}_i, \\hat{c}_j^\\dagger\\} = \\delta_{ij}$ and $\\{\\hat{c}_i, \\hat{c}_j\\} = \\{\\hat{c}_i^\\dagger, \\hat{c}_j^\\dagger\\} = 0$. In Nambu space, the mean-field Hamiltonian can be represented by a Hermitian BdG matrix that acts on a $2N$-dimensional vector composed of particle and hole components, where $N$ is the number of spatial lattice sites. The BdG Hamiltonian is constructed from a single-particle matrix $h$ of dimension $N \\times N$, and a pairing field matrix $\\Delta$ of dimension $N \\times N$, where both $h$ and $\\Delta$ are real and symmetric. The Bogoliubov transformation maps the original operators $\\hat{c}_i$ and $\\hat{c}_i^\\dagger$ to quasiparticle operators $\\hat{\\gamma}_k$ and $\\hat{\\gamma}_k^\\dagger$ by a linear transformation with matrices $U$ and $V$ whose columns originate from the positive-energy eigenvectors of the BdG Hamiltonian. Preservation of the canonical anti-commutation relations imposes orthonormality constraints on $U$ and $V$ that your program must validate.\n\nStarting from these fundamental definitions, write a program to:\n- Build $h$ and $\\Delta$ for each specified test case.\n- Assemble the BdG Hamiltonian of dimension $2N \\times 2N$ using $h$ and $\\Delta$.\n- Diagonalize the BdG Hamiltonian, select the $N$ eigenvectors associated with strictly positive eigenvalues, and partition each selected eigenvector into particle ($U$) and hole ($V$) components, forming $U \\in \\mathbb{R}^{N \\times N}$ and $V \\in \\mathbb{R}^{N \\times N}$.\n- Validate the Bogoliubov orthonormality constraints by checking that $U^\\dagger U + V^\\dagger V$ equals the identity matrix and that $U^T V + V^T U$ equals the zero matrix, within a numerical tolerance of $10^{-10}$ measured as the maximum absolute entry-wise deviation.\n- For each test case, return a boolean indicating whether both orthonormality constraints hold within the specified tolerance.\n\nUse open boundary conditions for $h$, with nearest-neighbor kinetic hopping and on-site terms. Specifically, for each test case with parameters $(N, t, \\mu, V)$, construct $h$ as follows:\n- $h_{ii} = 2t + V_i - \\mu$ for $i = 0, 1, \\dots, N-1$,\n- $h_{i,i+1} = h_{i+1,i} = -t$ for $i = 0, 1, \\dots, N-2$,\n- all other entries are $0$.\nEnsure that $\\Delta$ is real and symmetric as specified below.\n\nTest Suite:\nProvide four test cases, each specified by $(N, t, \\mu, V, \\Delta)$:\n1. General case with constant pairing:\n   - $N = 8$, $t = 1.0$, $\\mu = 0.2$, $V_i = 0$ for all $i$,\n   - $\\Delta = \\delta_0 I$ with $\\delta_0 = 0.5$.\n2. Spatially correlated pairing with Gaussian profile:\n   - $N = 6$, $t = 1.2$, $\\mu = -0.4$, $V_i = 0$ for all $i$,\n   - $\\Delta_{ij} = \\delta_0 \\exp\\left(-\\dfrac{(i-j)^2}{2\\sigma^2}\\right)$ with $\\delta_0 = 0.3$ and $\\sigma = 1.5$ for $i,j \\in \\{0,1,\\dots,N-1\\}$.\n3. Boundary case with no pairing:\n   - $N = 4$, $t = 0.8$, $\\mu = 0.1$, $V_i = 0$ for all $i$,\n   - $\\Delta = 0$ (the zero matrix).\n4. Small system with weak pairing:\n   - $N = 2$, $t = 1.0$, $\\mu = 0.0$, $V_0 = 0.1$, $V_1 = -0.1$,\n   - $\\Delta = \\delta_0 I$ with $\\delta_0 = 0.2$.\n\nAlgorithmic Requirements:\n- Use exact arithmetic operations and double-precision floating-point types.\n- Use an eigenvalue solver appropriate for real symmetric matrices.\n- When selecting positive-energy eigenvectors, use the strict criterion $E > 0$; assume the given parameters avoid exact zero-energy degeneracies.\n\nOutput Specification:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4]$), where each $\\text{result}_k$ is a boolean corresponding to the $k$-th test case, indicating whether both orthonormality constraints are satisfied within tolerance $10^{-10}$.",
            "solution": "The computational task is grounded in the Hartree–Fock–Bogoliubov mean-field theory, where pairing correlations are incorporated by enlarging the single-particle description to the Nambu space. The basic operators $\\hat{c}_i$ and $\\hat{c}_i^\\dagger$ obey $\\{\\hat{c}_i, \\hat{c}_j^\\dagger\\} = \\delta_{ij}$ and vanish otherwise, which is the canonical fermionic algebra. In the presence of pairing, the mean-field Hamiltonian becomes quadratic and can be expressed in Nambu space as a Hermitian matrix acting on vectors $\\Psi = \\begin{pmatrix} u \\\\ v \\end{pmatrix}$ of length $2N$, where $u \\in \\mathbb{R}^N$ and $v \\in \\mathbb{R}^N$ denote particle and hole components associated with lattice sites.\n\nThe Bogoliubov–de Gennes (BdG) Hamiltonian for real symmetric $h$ and real symmetric $\\Delta$ takes the block form\n$$\n\\mathcal{H}_{\\mathrm{BdG}} = \n\\begin{pmatrix}\nh  \\Delta \\\\\n\\Delta  -h^T\n\\end{pmatrix},\n$$\nwhich is Hermitian (real symmetric) when $h = h^T$ and $\\Delta = \\Delta^T$. Diagonalizing $\\mathcal{H}_{\\mathrm{BdG}}$ yields eigenpairs $(E_k, \\Psi_k)$ satisfying $\\mathcal{H}_{\\mathrm{BdG}} \\Psi_k = E_k \\Psi_k$, with eigenvalues appearing in $\\pm$ pairs due to particle–hole symmetry. Each eigenvector can be partitioned as $\\Psi_k = \\begin{pmatrix} u_k \\\\ v_k \\end{pmatrix}$ with $u_k \\in \\mathbb{R}^N$ and $v_k \\in \\mathbb{R}^N$. For $E_k > 0$, the columns $u_k$ and $v_k$ form the Bogoliubov transformation matrices $U = [u_1, \\dots, u_N]$ and $V = [v_1, \\dots, v_N]$ of dimension $N \\times N$.\n\nThe Bogoliubov transformation maps the original fermion operators to quasiparticle operators via\n$$\n\\hat{\\gamma}_k = \\sum_{i=1}^{N} U_{ik} \\hat{c}_i + V_{ik} \\hat{c}_i^\\dagger,\n\\quad\n\\hat{\\gamma}_k^\\dagger = \\sum_{i=1}^{N} U_{ik} \\hat{c}_i^\\dagger + V_{ik} \\hat{c}_i,\n$$\nwhich must preserve the canonical anti-commutation relations. Preservation imposes the orthonormality constraints\n$$\nU^\\dagger U + V^\\dagger V = I_N,\n\\quad\nU^T V + V^T U = 0_{N \\times N},\n$$\nwhich follow from enforcing $\\{\\hat{\\gamma}_k, \\hat{\\gamma}_{k'}^\\dagger\\} = \\delta_{kk'}$ and $\\{\\hat{\\gamma}_k, \\hat{\\gamma}_{k'}\\} = 0$ for all $k, k'$. These constraints can be derived by direct substitution and using the bilinearity and anti-commutativity properties of fermionic operators.\n\nAlgorithmically, the steps are:\n1. Construct $h$ from the given $N$, $t$, $\\mu$, and $V$ with open boundary conditions. Specifically, for $i = 0, 1, \\dots, N-1$, set $h_{ii} = 2t + V_i - \\mu$ and $h_{i,i+1} = h_{i+1,i} = -t$ for $i = 0, 1, \\dots, N-2$, and set all other entries to $0$. This is the standard finite-difference representation of the kinetic energy plus local potential and chemical potential shift on a one-dimensional grid.\n2. Construct $\\Delta$ according to the test case specification, ensuring $\\Delta$ is real and symmetric:\n   - For constant pairing, use $\\Delta = \\delta_0 I_N$.\n   - For Gaussian spatial correlations, use $\\Delta_{ij} = \\delta_0 \\exp\\left(-\\dfrac{(i-j)^2}{2\\sigma^2}\\right)$ for $i,j \\in \\{0,\\dots,N-1\\}$.\n   - For the no-pairing boundary case, set $\\Delta = 0_{N \\times N}$.\n3. Form the BdG matrix $\\mathcal{H}_{\\mathrm{BdG}}$ of size $2N \\times 2N$ as the block matrix shown above.\n4. Use an eigenvalue solver for real symmetric matrices to compute all eigenpairs $(E_k, \\Psi_k)$. Sort the eigenvalues in ascending order and select the $N$ eigenvectors with strictly positive eigenvalues $E_k > 0$; the test parameters are chosen to avoid exact zero-energy degeneracies.\n5. Partition the selected eigenvectors into particle and hole components to assemble $U$ and $V$ as $N \\times N$ matrices.\n6. Validate the orthonormality constraints by computing:\n   - $R_1 = U^\\dagger U + V^\\dagger V - I_N$,\n   - $R_2 = U^T V + V^T U$,\n   and evaluate the maximum absolute entry-wise deviations $\\max_{i,j} |(R_1)_{ij}|$ and $\\max_{i,j} |(R_2)_{ij}|$. If both deviations are less than or equal to the tolerance $10^{-10}$, declare the test case successful.\n7. Output a single line containing a bracketed comma-separated list of four booleans corresponding to the four test cases, each boolean indicating whether both orthonormality checks passed within the tolerance.\n\nScientific realism is ensured by using a standard tight-binding-like discretization for $h$ and physically plausible symmetric pairing fields $\\Delta$. The program’s results are quantifiable: for each test case, the boolean reflects whether the fundamental orthonormality constraints mandated by the Bogoliubov transformation hold within the numerical tolerance. The test suite covers a general case with uniform pairing, a spatially correlated pairing case, a boundary case with zero pairing, and a small system with weak pairing to probe numerical stability and boundary behavior. The final output is a single line in the required format $[\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4]$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef build_h(N, t, mu, V=None):\n    \"\"\"Construct the single-particle Hamiltonian h with open boundary conditions.\"\"\"\n    h = np.zeros((N, N), dtype=float)\n    for i in range(N):\n        vi = 0.0 if V is None else V[i]\n        h[i, i] = 2.0 * t + vi - mu\n        if i + 1  N:\n            h[i, i + 1] = -t\n            h[i + 1, i] = -t\n    return h\n\ndef build_delta_constant(N, delta0):\n    \"\"\"Construct a constant pairing field: Delta = delta0 * I.\"\"\"\n    return np.eye(N, dtype=float) * delta0\n\ndef build_delta_gaussian(N, delta0, sigma):\n    \"\"\"Construct a Gaussian-correlated pairing field: Delta_ij = delta0 * exp(-(i-j)^2/(2*sigma^2)).\"\"\"\n    idx = np.arange(N)\n    ii, jj = np.meshgrid(idx, idx, indexing='ij')\n    Delta = delta0 * np.exp(-((ii - jj) ** 2) / (2.0 * sigma ** 2))\n    # Ensure exact symmetry in case of floating rounding (though it's symmetric by construction).\n    Delta = 0.5 * (Delta + Delta.T)\n    return Delta\n\ndef build_bdg(h, Delta):\n    \"\"\"Construct the BdG Hamiltonian matrix.\"\"\"\n    upper = np.hstack((h, Delta))\n    lower = np.hstack((Delta, -h.T))\n    H = np.vstack((upper, lower))\n    return H\n\ndef extract_U_V_from_bdg(H, N, eps=1e-12):\n    \"\"\"Diagonalize BdG, select positive-energy eigenvectors, and extract U, V.\"\"\"\n    # eigh for symmetric matrices\n    evals, evecs = np.linalg.eigh(H)\n    # Strictly positive eigenvalues\n    pos_idx = np.where(evals > eps)[0]\n    if len(pos_idx)  N:\n        # As a fallback (should not happen for provided test cases), include zeros if needed.\n        pos_idx = np.where(evals >= 0.0)[0][:N]\n    else:\n        # Take the lowest N positive energies to avoid accidental oversubscription\n        # (in general there should be exactly N)\n        pos_idx = pos_idx[:N]\n    U = evecs[:N, pos_idx]\n    V = evecs[N:, pos_idx]\n    return U, V\n\ndef check_orthonormality(U, V, tol=1e-10):\n    \"\"\"Check U^\\dagger U + V^\\dagger V = I and U^T V + V^T U = 0 within tolerance.\"\"\"\n    N = U.shape[0]\n    I = np.eye(N, dtype=float)\n    # Use conjugates to allow complex generalization; here matrices are real.\n    R1 = U.conj().T @ U + V.conj().T @ V - I\n    R2 = U.T @ V + V.T @ U\n    max_abs_R1 = np.max(np.abs(R1))\n    max_abs_R2 = np.max(np.abs(R2))\n    return (max_abs_R1 = tol) and (max_abs_R2 = tol)\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: N=8, t=1.0, mu=0.2, V_i=0, Delta=0.5*I\n        {\"N\": 8, \"t\": 1.0, \"mu\": 0.2, \"V\": np.zeros(8, dtype=float),\n         \"Delta_fn\": lambda N: build_delta_constant(N, 0.5)},\n        # Case 2: N=6, t=1.2, mu=-0.4, V_i=0, Delta Gaussian with delta0=0.3, sigma=1.5\n        {\"N\": 6, \"t\": 1.2, \"mu\": -0.4, \"V\": np.zeros(6, dtype=float),\n         \"Delta_fn\": lambda N: build_delta_gaussian(N, 0.3, 1.5)},\n        # Case 3: N=4, t=0.8, mu=0.1, V_i=0, Delta=0\n        {\"N\": 4, \"t\": 0.8, \"mu\": 0.1, \"V\": np.zeros(4, dtype=float),\n         \"Delta_fn\": lambda N: np.zeros((N, N), dtype=float)},\n        # Case 4: N=2, t=1.0, mu=0.0, V=[0.1, -0.1], Delta=0.2*I\n        {\"N\": 2, \"t\": 1.0, \"mu\": 0.0, \"V\": np.array([0.1, -0.1], dtype=float),\n         \"Delta_fn\": lambda N: build_delta_constant(N, 0.2)},\n    ]\n\n    results = []\n    for case in test_cases:\n        N = case[\"N\"]\n        t = case[\"t\"]\n        mu = case[\"mu\"]\n        V = case[\"V\"]\n        Delta = case[\"Delta_fn\"](N)\n        h = build_h(N, t, mu, V)\n        H_bdg = build_bdg(h, Delta)\n        U, Vmat = extract_U_V_from_bdg(H_bdg, N)\n        ok = check_orthonormality(U, Vmat, tol=1e-10)\n        results.append(ok)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Once the Bogoliubov transformation is established, the next step is to characterize the many-body state it defines. The HFB ground state, or quasiparticle vacuum, is completely described by its generalized one-body density matrix, $\\mathcal{R}$. This exercise focuses on constructing $\\mathcal{R}$ from the Bogoliubov amplitudes and verifying its fundamental property of idempotency, $\\mathcal{R}^2 = \\mathcal{R}$ . This condition is a direct consequence of the state being a pure quantum state (a projector) and serves as a powerful and non-trivial consistency check in any HFB implementation.",
            "id": "3595314",
            "problem": "You will implement, from first principles, a small-scale Hartree-Fock-Bogoliubov (HFB) computation in a canonical pair basis for a schematic even system. The goal is to build the generalized density matrix $\\mathcal{R}$ associated with a Bogoliubov quasiparticle vacuum and verify numerically that it is idempotent. The one-body field will be modeled by a simplified Skyrme-like single-particle Hamiltonian with a local density-dependent mean-field, and the pairing field will use a density-dependent contact form in the Bardeen–Cooper–Schrieffer (BCS) limit. The implementation should not rely on any pre-existing HFB or BCS formulas that short-circuit the derivation; instead, it must begin from the canonical fermionic anticommutation relations and the definition of the Bogoliubov transformation as a linear canonical transformation that preserves them. From this base, derive how the quasiparticle vacuum determines the normal and anomalous densities and show why the generalized density matrix is a projector.\n\nDefinitions and modeling assumptions to be used as the fundamental base:\n- Canonical fermionic anticommutation relations: $\\{ \\hat{c}_i, \\hat{c}_j^\\dagger \\} = \\delta_{ij}$ and $\\{ \\hat{c}_i, \\hat{c}_j \\} = \\{ \\hat{c}_i^\\dagger, \\hat{c}_j^\\dagger \\} = 0$ for fermionic creation and annihilation operators $\\hat{c}_i^\\dagger$ and $\\hat{c}_i$.\n- A Bogoliubov transformation is a linear change of operators $(\\hat{c}, \\hat{c}^\\dagger) \\mapsto (\\hat{\\beta}, \\hat{\\beta}^\\dagger)$ that preserves the canonical anticommutation relations.\n- The generalized density matrix is defined by the normal and anomalous densities built as quasiparticle vacuum expectation values, and at zero temperature the HFB quasiparticle vacuum implies idempotency of $\\mathcal{R}$.\n\nComputational model to construct the input single-particle Hamiltonian and pairing field:\n- Consider an even number $N$ of single-particle states grouped into $N/2$ time-reversed pairs labeled by $p \\in \\{0, \\dots, N/2 - 1\\}$. Each pair $p$ consists of states $(p,\\bar{p})$ with the same single-particle kinetic energy $\\varepsilon^{\\mathrm{kin}}_p$.\n- Define a Skyrme-like local mean-field shift for each pair $p$ using a simplified density dependence $U_p = t_0 \\rho_p + \\frac{1}{2} t_3 \\rho_p^{\\alpha + 1}$, where $\\rho_p$ is a local proxy for density constructed from an initial Hartree-Fock step-function occupancy: $\\rho_p = w_p \\, \\theta(\\mu - \\varepsilon^{\\mathrm{kin}}_p)$ with weight $w_p \\in [0,1]$ and chemical potential $\\mu$. All quantities are dimensionless.\n- The single-particle Hamiltonian in this canonical pair basis is diagonal with levels $\\varepsilon_p = \\varepsilon^{\\mathrm{kin}}_p + U_p$, duplicated for $(p,\\bar{p})$.\n- Use a density-dependent contact pairing amplitude per pair $p$ of the form $\\Delta_p = |V_0| \\left(1 - \\eta \\, \\rho_p/\\rho_0 \\right)$, with parameters $V_0 \\le 0$, $\\eta \\in [0,1]$, and a reference density $\\rho_0 > 0$; for numerical stability, treat $\\Delta_p \\ge 0$ as a magnitude. In the canonical basis, build the anomalous pairing tensor as an antisymmetric matrix coupling each time-reversed pair: $\\kappa_{p,\\bar{p}} = -\\kappa_{\\bar{p},p}$ with all other elements zero.\n\nTasks to complete:\n- Starting from the canonical anticommutation relations and the definition of a Bogoliubov transformation that preserves them, derive the structure of the generalized density matrix $\\mathcal{R}$ in terms of the normal density $\\rho$ and anomalous density $\\kappa$ for a quasiparticle vacuum at zero temperature. Show that $\\mathcal{R}$ is a projector, i.e., that $\\mathcal{R}^2 = \\mathcal{R}$, when the Bogoliubov transformation is canonical.\n- Specialize to the canonical pair basis with diagonal single-particle Hamiltonian and antisymmetric pairing between time-reversed states. Show how diagonalization of the $2 \\times 2$ HFB block for each pair yields real amplitudes $u_p$ and $v_p$ with $u_p^2 + v_p^2 = 1$ and express $\\rho$ and $\\kappa$ for each pair in terms of these amplitudes without importing any unproven shortcut formulas.\n- Implement a program that, for the given test suite, constructs $\\rho$, $\\kappa$, the $2N \\times 2N$ generalized density matrix\n$$\n\\mathcal{R} \\;=\\; \\begin{pmatrix}\n\\rho  \\kappa \\\\\n-\\kappa^\\ast  \\mathbb{I} - \\rho^\\ast\n\\end{pmatrix},\n$$\nand computes a numerical measure of idempotency violation using the Frobenius norm\n$$\n\\left\\| \\mathcal{R}^2 - \\mathcal{R} \\right\\|_{\\mathrm{F}} \\;=\\; \\sqrt{\\sum_{i,j} \\left| \\left( \\mathcal{R}^2 - \\mathcal{R} \\right)_{ij} \\right|^2 }.\n$$\n- All quantities are dimensionless; no physical units are used in this problem.\n\nAlgorithmic details to implement:\n- For each test case, given $\\{\\varepsilon^{\\mathrm{kin}}_p\\}_{p=0}^{N/2-1}$, $\\{w_p\\}$, $\\mu$, $t_0$, $t_3$, $\\alpha$, $V_0$, $\\eta$, and $\\rho_0$:\n    - Compute $\\rho_p = w_p \\, \\theta(\\mu - \\varepsilon^{\\mathrm{kin}}_p)$ and $U_p = t_0 \\rho_p + \\frac{1}{2} t_3 \\rho_p^{\\alpha + 1}$.\n    - Set $\\varepsilon_p = \\varepsilon^{\\mathrm{kin}}_p + U_p$ and $\\xi_p = \\varepsilon_p - \\mu$.\n    - Compute $\\Delta_p = |V_0| (1 - \\eta \\rho_p/\\rho_0)$ with $\\Delta_p \\ge 0$.\n    - Solve the $2 \\times 2$ HFB pair block to obtain real $u_p$ and $v_p$ with $u_p^2 + v_p^2 = 1$.\n    - Build $\\rho$ as diagonal with entries $v_p^2$ for both states in the pair $(p,\\bar{p})$ and build $\\kappa$ as antisymmetric with $\\kappa_{p,\\bar{p}} = u_p v_p$ and $\\kappa_{\\bar{p},p} = -u_p v_p$.\n    - Assemble $\\mathcal{R}$ and compute $\\left\\|\\mathcal{R}^2 - \\mathcal{R}\\right\\|_{\\mathrm{F}}$.\n\nTest suite to evaluate different facets:\n- Case A (general case with finite pairing):\n    - $N = 4$ (i.e., $N/2 = 2$ pairs),\n    - $\\varepsilon^{\\mathrm{kin}}_p = [-3.0, -1.0]$,\n    - $w_p = [0.9, 0.6]$,\n    - $\\mu = -1.5$,\n    - $t_0 = -2.0$, $t_3 = 1.2$, $\\alpha = 0.5$,\n    - $V_0 = -1.6$, $\\eta = 0.7$, $\\rho_0 = 1.0$.\n- Case B (edge case with zero pairing):\n    - Same as Case A but with $V_0 = 0.0$.\n- Case C (larger system and different density dependence):\n    - $N = 6$ (i.e., $N/2 = 3$ pairs),\n    - $\\varepsilon^{\\mathrm{kin}}_p = [-2.2, -1.2, -0.2]$,\n    - $w_p = [0.5, 0.4, 0.3]$,\n    - $\\mu = -0.8$,\n    - $t_0 = -3.0$, $t_3 = 1.1$, $\\alpha = 1.0$,\n    - $V_0 = -2.0$, $\\eta = 0.5$, $\\rho_0 = 1.0$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results for the three cases as a comma-separated list of floats enclosed in square brackets, for example, $[x_1,x_2,x_3]$, where $x_i = \\left\\|\\mathcal{R}^2 - \\mathcal{R}\\right\\|_{\\mathrm{F}}$ for the corresponding case.",
            "solution": "The problem statement is a valid theoretical and computational exercise in quantum many-body physics, specifically within the Hartree-Fock-Bogoliubov (HFB) framework. It is scientifically grounded, well-posed, objective, and internally consistent. We will proceed with the solution, which consists of two principal parts: a theoretical derivation from first principles as required, followed by a numerical implementation to verify the derived properties.\n\n### Part 1: Theoretical Derivation\n\n#### 1.1 Bogoliubov Transformation and the Generalized Density Matrix\n\nWe begin with the fundamental anticommutation relations for fermionic creation ($\\hat{c}_i^\\dagger$) and annihilation ($\\hat{c}_i$) operators for a set of single-particle states indexed by $i$:\n$$\n\\{ \\hat{c}_i, \\hat{c}_j^\\dagger \\} = \\delta_{ij}, \\quad \\{ \\hat{c}_i, \\hat{c}_j \\} = 0, \\quad \\{ \\hat{c}_i^\\dagger, \\hat{c}_j^\\dagger \\} = 0\n$$\nA Bogoliubov transformation defines a new set of fermionic operators, the quasiparticle operators ($\\hat{\\beta}_k^\\dagger, \\hat{\\beta}_k$), as a linear combination of the original particle operators. For this transformation to be canonical, the quasiparticle operators must satisfy the same anticommutation relations:\n$$\n\\{ \\hat{\\beta}_k, \\hat{\\beta}_l^\\dagger \\} = \\delta_{kl}, \\quad \\{ \\hat{\\beta}_k, \\hat{\\beta}_l \\} = 0, \\quad \\{ \\hat{\\beta}_k^\\dagger, \\hat{\\beta}_l^\\dagger \\} = 0\n$$\nThe general form of this linear transformation can be written as:\n$$\n\\hat{\\beta}_k = \\sum_i (U_{ik}^* \\hat{c}_i + V_{ik}^* \\hat{c}_i^\\dagger)\n$$\nwhere $U$ and $V$ are complex matrices. The inverse transformation expresses the particle operators in terms of quasiparticle operators:\n$$\n\\hat{c}_i = \\sum_k (U_{ik} \\hat{\\beta}_k + V_{ik} \\hat{\\beta}_k^\\dagger)\n$$\nThe HFB ground state at zero temperature, denoted $|\\Phi_0\\rangle$, is defined as the vacuum of the quasiparticles:\n$$\n\\hat{\\beta}_k |\\Phi_0\\rangle = 0 \\quad \\forall k\n$$\nThis implies $\\langle \\Phi_0 | \\hat{\\beta}_k^\\dagger = 0$.\n\nThe properties of the system in the ground state are encoded in the generalized density matrix $\\mathcal{R}$. The components of $\\mathcal{R}$ are the normal density matrix $\\rho$ and the anomalous density matrix (or pairing tensor) $\\kappa$, which are defined as expectation values in the quasiparticle vacuum:\n$$\n\\rho_{ij} = \\langle \\Phi_0 | \\hat{c}_j^\\dagger \\hat{c}_i | \\Phi_0 \\rangle\n$$\n$$\n\\kappa_{ij} = \\langle \\Phi_0 | \\hat{c}_j \\hat{c}_i | \\Phi_0 \\rangle\n$$\nWe can derive expressions for $\\rho$ and $\\kappa$ by substituting the inverse Bogoliubov transformation.\nFor the normal density $\\rho_{ij}$:\n$$\n\\rho_{ij} = \\langle \\Phi_0 | \\left( \\sum_l U_{jl}^* \\hat{\\beta}_l^\\dagger + V_{jl}^* \\hat{\\beta}_l \\right) \\left( \\sum_k U_{ik} \\hat{\\beta}_k + V_{ik} \\hat{\\beta}_k^\\dagger \\right) | \\Phi_0 \\rangle\n$$\nDue to the quasiparticle vacuum condition, the only non-zero contribution comes from terms where a quasiparticle is created by $\\hat{\\beta}_k^\\dagger$ and immediately annihilated by $\\hat{\\beta}_l$. This happens for the term $\\langle\\Phi_0|\\sum_{l,k}V_{jl}^*\\hat{\\beta}_l V_{ik}\\hat{\\beta}_k^\\dagger|\\Phi_0\\rangle$. Using $\\langle \\Phi_0 | \\hat{\\beta}_l \\hat{\\beta}_k^\\dagger | \\Phi_0 \\rangle = \\delta_{lk}$, we find:\n$$\n\\rho_{ij} = \\sum_k V_{ik} V_{jk}^* = (V V^\\dagger)_{ij} \\implies \\rho = V V^\\dagger\n$$\nSimilarly, for the anomalous density $\\kappa_{ij}$:\n$$\n\\kappa_{ij} = \\langle \\Phi_0 | \\left( \\sum_l U_{jl} \\hat{\\beta}_l + V_{jl} \\hat{\\beta}_l^\\dagger \\right) \\left( \\sum_k U_{ik} \\hat{\\beta}_k + V_{ik} \\hat{\\beta}_k^\\dagger \\right) | \\Phi_0 \\rangle\n$$\nThe non-zero term is $\\langle\\Phi_0|\\sum_{l,k}U_{jl}\\hat{\\beta}_l V_{ik}\\hat{\\beta}_k^\\dagger|\\Phi_0\\rangle$. This yields:\n$$\n\\kappa_{ij} = \\sum_k U_{jk} V_{ik} = (V^T U)_{ji} \\implies \\kappa = (V^T U)^T = U^T V\n$$\n\nThe matrices $U$ and $V$ are not arbitrary; they must satisfy conditions that ensure the canonicity of the transformation. These are $U^\\dagger U + V^\\dagger V = \\mathbb{I}$ and $U^T V + V^T U = 0$ (for the case specified where $\\kappa$ is antisymmetric). From the inverse transformation, one also obtains $UU^\\dagger + VV^\\dagger = \\mathbb{I}$ and $UV^T + VU^T = 0$.\n\nThe generalized density matrix is given by:\n$$\n\\mathcal{R} = \\begin{pmatrix} \\rho  \\kappa \\\\ -\\kappa^\\ast  \\mathbb{I} - \\rho^\\ast \\end{pmatrix}\n$$\nTo demonstrate that $\\mathcal{R}$ is a projector, i.e., $\\mathcal{R}^2 = \\mathcal{R}$, we compute its square:\n$$\n\\mathcal{R}^2 = \\begin{pmatrix} \\rho  \\kappa \\\\ -\\kappa^\\ast  \\mathbb{I} - \\rho^\\ast \\end{pmatrix} \\begin{pmatrix} \\rho  \\kappa \\\\ -\\kappa^\\ast  \\mathbb{I} - \\rho^\\ast \\end{pmatrix} = \\begin{pmatrix} \\rho^2 - \\kappa \\kappa^\\ast  \\rho \\kappa + \\kappa(\\mathbb{I} - \\rho^\\ast) \\\\ -\\kappa^\\ast \\rho - (\\mathbb{I} - \\rho^\\ast)\\kappa^\\ast  -\\kappa^\\ast \\kappa + (\\mathbb{I}-\\rho^\\ast)^2 \\end{pmatrix}\n$$\nUsing the relations derived from the canonical conditions (e.g., $UU^\\dagger + VV^\\dagger = \\mathbb{I}$ and $\\kappa = U V^\\dagger$, this can be shown in general). However, specializing to the problem's canonical pair basis provides a simpler and more direct proof.\n\n#### 1.2 Specialization to the Canonical Pair Basis\n\nThe problem defines a canonical basis of time-reversed pairs $(p, \\bar{p})$. For each pair, the Bogoliubov transformation takes the simplified real form:\n$$\n\\hat{\\beta}_p = u_p \\hat{c}_p - v_p \\hat{c}_{\\bar{p}}^\\dagger\n$$\n$$\n\\hat{\\beta}_{\\bar{p}} = u_p \\hat{c}_{\\bar{p}} + v_p \\hat{c}_p^\\dagger\n$$\nwith real coefficients $u_p, v_p$ satisfying $u_p^2 + v_p^2 = 1$. This ensures canonicity. The inverse relations are:\n$$\n\\hat{c}_p = u_p \\hat{\\beta}_p + v_p \\hat{\\beta}_{\\bar{p}}^\\dagger\n$$\n$$\n\\hat{c}_{\\bar{p}} = u_p \\hat{\\beta}_{\\bar{p}} - v_p \\hat{\\beta}_p^\\dagger\n$$\nWe now compute the density matrix elements for this pair in the quasiparticle vacuum. The only non-zero single-particle expectation values are the occupation probabilities:\n$$\n\\rho_{pp} = \\langle \\Phi_0 | \\hat{c}_p^\\dagger \\hat{c}_p | \\Phi_0 \\rangle = \\langle \\Phi_0 | (u_p \\hat{\\beta}_p^\\dagger + v_p \\hat{\\beta}_{\\bar{p}}) (u_p \\hat{\\beta}_p + v_p \\hat{\\beta}_{\\bar{p}}^\\dagger) | \\Phi_0 \\rangle = v_p^2 \\langle \\Phi_0 | \\hat{\\beta}_{\\bar{p}} \\hat{\\beta}_{\\bar{p}}^\\dagger | \\Phi_0 \\rangle = v_p^2\n$$\n$$\n\\rho_{\\bar{p}\\bar{p}} = \\langle \\Phi_0 | \\hat{c}_{\\bar{p}}^\\dagger \\hat{c}_{\\bar{p}} | \\Phi_0 \\rangle = \\langle \\Phi_0 | (u_p \\hat{\\beta}_{\\bar{p}}^\\dagger - v_p \\hat{\\beta}_p) (u_p \\hat{\\beta}_{\\bar{p}} - v_p \\hat{\\beta}_p^\\dagger) | \\Phi_0 \\rangle = v_p^2 \\langle \\Phi_0 | \\hat{\\beta}_p \\hat{\\beta}_p^\\dagger | \\Phi_0 \\rangle = v_p^2\n$$\nAll off-diagonal elements $\\rho_{p\\bar{p}}$ are zero.\nFor the anomalous density:\n$$\n\\kappa_{p\\bar{p}} = \\langle \\Phi_0 | \\hat{c}_{\\bar{p}} \\hat{c}_p | \\Phi_0 \\rangle = \\langle \\Phi_0 | (u_p \\hat{\\beta}_{\\bar{p}} - v_p \\hat{\\beta}_p^\\dagger) (u_p \\hat{\\beta}_p + v_p \\hat{\\beta}_{\\bar{p}}^\\dagger) | \\Phi_0 \\rangle = u_p v_p \\langle \\Phi_0 | \\hat{\\beta}_{\\bar{p}} \\hat{\\beta}_{\\bar{p}}^\\dagger | \\Phi_0 \\rangle = u_p v_p\n$$\nDue to anticommutation, $\\kappa_{\\bar{p}p} = \\langle \\Phi_0 | \\hat{c}_p \\hat{c}_{\\bar{p}} | \\Phi_0 \\rangle = - \\kappa_{p\\bar{p}} = -u_p v_p$. All other elements like $\\kappa_{pp}$ are zero. These results match the construction specified in the problem.\n\nThe coefficients $u_p$ and $v_p$ are determined by solving the HFB equations, which for this simple pair structure reduce to diagonalizing a $2 \\times 2$ matrix representing the BCS problem for the pair:\n$$\n\\begin{pmatrix} \\xi_p  \\Delta_p \\\\ \\Delta_p  -\\xi_p \\end{pmatrix} \\begin{pmatrix} u_p \\\\ -v_p \\end{pmatrix} = E_p \\begin{pmatrix} u_p \\\\ -v_p \\end{pmatrix}\n$$\nThe quasiparticle energy is $E_p = \\sqrt{\\xi_p^2 + \\Delta_p^2}$, and the coefficients are given by:\n$$\nu_p^2 = \\frac{1}{2}\\left(1 + \\frac{\\xi_p}{E_p}\\right), \\quad v_p^2 = \\frac{1}{2}\\left(1 - \\frac{\\xi_p}{E_p}\\right)\n$$\nwhere $E_p$ is taken as the positive root.\n\nThe full matrices $\\rho$ and $\\kappa$ are block-diagonal, consisting of blocks for each pair. The total generalized density matrix $\\mathcal{R}$ is also block-diagonal, composed of $4 \\times 4$ blocks for each pair $p$. For a single pair, in the basis $(p, \\bar{p})$ for particle indices, the $\\mathcal{R}$ block is:\n$$\n\\mathcal{R}^{(p)} = \\begin{pmatrix} \\rho^{(p)}  \\kappa^{(p)} \\\\ -(\\kappa^{(p)})^*  \\mathbb{I} - (\\rho^{(p)})^* \\end{pmatrix} = \\begin{pmatrix} v_p^2  0  0  u_p v_p \\\\ 0  v_p^2  -u_p v_p  0 \\\\ 0  u_p v_p  1-v_p^2  0 \\\\ -u_p v_p  0  0  1-v_p^2 \\end{pmatrix}\n$$\nSince $u_p^2+v_p^2=1$, we have $1-v_p^2 = u_p^2$. The matrix permutes into two independent $2 \\times 2$ blocks:\n$$\n\\text{Block 1: } \\begin{pmatrix} v_p^2  u_p v_p \\\\ u_p v_p  u_p^2 \\end{pmatrix}, \\quad \\text{Block 2: } \\begin{pmatrix} v_p^2  -u_p v_p \\\\ -u_p v_p  u_p^2 \\end{pmatrix}\n$$\nWe can verify idempotency for Block 1:\n$$\n\\begin{pmatrix} v_p^2  u_p v_p \\\\ u_p v_p  u_p^2 \\end{pmatrix}^2 = \\begin{pmatrix} v_p^4+u_p^2v_p^2  u_p v_p^3+u_p^3v_p \\\\ u_p v_p^3+u_p^3v_p  u_p^2v_p^2+u_p^4 \\end{pmatrix} = \\begin{pmatrix} v_p^2(v_p^2+u_p^2)  u_p v_p(v_p^2+u_p^2) \\\\ u_p v_p(v_p^2+u_p^2)  u_p^2(v_p^2+u_p^2) \\end{pmatrix} = \\begin{pmatrix} v_p^2  u_p v_p \\\\ u_p v_p  u_p^2 \\end{pmatrix}\n$$\nThe same holds for Block 2. Since each block of $\\mathcal{R}$ is idempotent, the full matrix $\\mathcal{R}$ is idempotent. The numerical implementation below will verify this property.\n\n### Part 2: Algorithmic Implementation\n\nThe algorithm proceeds as follows for each test case:\n1.  Read the input parameters for the model: $N$, $\\{\\varepsilon^{\\mathrm{kin}}_p\\}$, $\\{w_p\\}$, $\\mu$, $t_0$, $t_3$, $\\alpha$, $V_0$, $\\eta$, $\\rho_0$.\n2.  Iterate through each time-reversed pair $p$ from $0$ to $N/2-1$.\n3.  Calculate the local density proxy $\\rho_p = w_p \\cdot \\theta(\\mu - \\varepsilon^{\\mathrm{kin}}_p)$, where $\\theta$ is the Heaviside step function.\n4.  Compute the mean-field shift $U_p = t_0 \\rho_p + \\frac{1}{2} t_3 \\rho_p^{\\alpha + 1}$.\n5.  Determine the single-particle energy $\\varepsilon_p = \\varepsilon^{\\mathrm{kin}}_p + U_p$ and shift it by the chemical potential to get $\\xi_p = \\varepsilon_p - \\mu$.\n6.  Calculate the pairing gap $\\Delta_p = |V_0| (1 - \\eta \\rho_p / \\rho_0)$.\n7.  Solve for the Bogoliubov amplitudes. First, find the quasiparticle energy $E_p = \\sqrt{\\xi_p^2 + \\Delta_p^2}$. Handle the case $E_p=0$ carefully by setting $\\xi_p/E_p=0$ (corresponding to $v_p^2=0.5$).\n8.  From $E_p$ and $\\xi_p$, compute $v_p^2 = \\frac{1}{2} (1 - \\xi_p/E_p)$ and $u_p v_p = \\Delta_p / (2 E_p)$.\n9.  Construct the $N \\times N$ matrices $\\rho$ and $\\kappa$. For each pair $p$, the corresponding diagonal elements of $\\rho$ are set to $v_p^2$, and the off-diagonal block of $\\kappa$ is populated with $\\pm u_p v_p$.\n10. Assemble the $2N \\times 2N$ generalized density matrix $\\mathcal{R}$.\n11. Compute the squared matrix $\\mathcal{R}^2$ and the difference matrix $\\mathcal{D} = \\mathcal{R}^2 - \\mathcal{R}$.\n12. Calculate the Frobenius norm $\\|\\mathcal{D}\\|_{\\mathrm{F}}$, which quantifies the violation of idempotency. This should be a value close to machine precision zero.",
            "answer": "```python\nimport numpy as np\n\ndef calculate_idempotency_violation(case_params):\n    \"\"\"\n    Performs a small-scale HFB computation and verifies idempotency of the\n    generalized density matrix.\n    \"\"\"\n    N = case_params[\"N\"]\n    eps_kin = np.array(case_params[\"eps_kin_p\"])\n    w_p = np.array(case_params[\"w_p\"])\n    mu = case_params[\"mu\"]\n    t0 = case_params[\"t0\"]\n    t3 = case_params[\"t3\"]\n    alpha = case_params[\"alpha\"]\n    V0 = case_params[\"V0\"]\n    eta = case_params[\"eta\"]\n    rho0 = case_params[\"rho0\"]\n    \n    N_pairs = N // 2\n    \n    vp_sq_vals = np.zeros(N_pairs)\n    up_vp_vals = np.zeros(N_pairs)\n    \n    for p in range(N_pairs):\n        # Step 1: Compute local density proxy\n        theta = 1.0 if mu > eps_kin[p] else 0.0\n        rho_p_val = w_p[p] * theta\n        \n        # Step 2: Compute mean-field shift and s.p. energies\n        Up = t0 * rho_p_val + 0.5 * t3 * rho_p_val**(alpha + 1)\n        eps_p = eps_kin[p] + Up\n        xi_p = eps_p - mu\n        \n        # Step 3: Compute pairing gap\n        Delta_p = np.abs(V0) * (1 - eta * rho_p_val / rho0)\n        \n        # Step 4: Solve for Bogoliubov amplitudes\n        E_p_sq = xi_p**2 + Delta_p**2\n        \n        if E_p_sq  1e-16: # Handle potential division by zero\n            E_p = 0.0\n        else:\n            E_p = np.sqrt(E_p_sq)\n            \n        if E_p == 0.0:\n            # If E_p is zero, xi_p and Delta_p must be zero.\n            # This corresponds to the Fermi level in a non-interacting system.\n            # The occupancy v_p^2 is ill-defined from the formula but physically is 0.5\n            # however the problem is usually set up to avoid this ambiguity.\n            # In the limit xi_p -> 0, v_p^2 -> 0.5.\n            vp_sq = 0.5\n            # Since Delta_p is zero, u_p*v_p is zero.\n            up_vp = 0.0\n        else:\n            vp_sq = 0.5 * (1 - xi_p / E_p)\n            up_vp = Delta_p / (2.0 * E_p)\n            \n        vp_sq_vals[p] = vp_sq\n        up_vp_vals[p] = up_vp\n\n    # Step 5: Build rho and kappa matrices\n    rho = np.zeros((N, N))\n    kappa = np.zeros((N, N))\n    \n    for p in range(N_pairs):\n        i1 = 2 * p\n        i2 = 2 * p + 1\n        \n        # Normal density (diagonal)\n        rho[i1, i1] = vp_sq_vals[p]\n        rho[i2, i2] = vp_sq_vals[p]\n        \n        # Anomalous density (antisymmetric)\n        kappa[i1, i2] = up_vp_vals[p]\n        kappa[i2, i1] = -up_vp_vals[p]\n        \n    # Step 6: Assemble the generalized density matrix R\n    R = np.zeros((2 * N, 2 * N))\n    I_N = np.eye(N)\n    \n    R[:N, :N] = rho\n    R[:N, N:] = kappa\n    R[N:, :N] = -kappa  # kappa is real\n    R[N:, N:] = I_N - rho # rho is real\n    \n    # Step 7: Compute idempotency violation\n    R_squared = R @ R\n    diff = R_squared - R\n    \n    # Use Frobenius norm\n    frob_norm = np.linalg.norm(diff, 'fro')\n    \n    return frob_norm\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    test_cases = [\n        # Case A: General case with finite pairing\n        {\n            \"N\": 4, \"eps_kin_p\": [-3.0, -1.0], \"w_p\": [0.9, 0.6],\n            \"mu\": -1.5, \"t0\": -2.0, \"t3\": 1.2, \"alpha\": 0.5,\n            \"V0\": -1.6, \"eta\": 0.7, \"rho0\": 1.0\n        },\n        # Case B: Edge case with zero pairing\n        {\n            \"N\": 4, \"eps_kin_p\": [-3.0, -1.0], \"w_p\": [0.9, 0.6],\n            \"mu\": -1.5, \"t0\": -2.0, \"t3\": 1.2, \"alpha\": 0.5,\n            \"V0\": 0.0, \"eta\": 0.7, \"rho0\": 1.0\n        },\n        # Case C: Larger system and different density dependence\n        {\n            \"N\": 6, \"eps_kin_p\": [-2.2, -1.2, -0.2], \"w_p\": [0.5, 0.4, 0.3],\n            \"mu\": -0.8, \"t0\": -3.0, \"t3\": 1.1, \"alpha\": 1.0,\n            \"V0\": -2.0, \"eta\": 0.5, \"rho0\": 1.0\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        result = calculate_idempotency_violation(case)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.15e}' for r in results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "The Bogoliubov framework is not merely a mathematical formalism; it is a powerful tool for modeling and understanding complex physical phenomena in quantum many-body systems. This practice problem demonstrates its utility by applying the theory (in the Bardeen-Cooper-Schrieffer, or BCS, limit) to the classic nuclear structure problem of a rotating nucleus . By implementing a cranked BCS model, you will solve for the self-consistent pairing gap and chemical potential as a function of rotational frequency, allowing you to directly observe the physical effect of Coriolis anti-pairing and the evolution of quasiparticle structure across a level crossing. This connects the abstract transformation to tangible physics.",
            "id": "3595326",
            "problem": "Consider a cranked, constant-pairing toy model used in computational nuclear physics to study Coriolis-induced pair breaking. Work at zero temperature and adopt the rotating-frame mean-field approach in which the many-body Hamiltonian is approximated, for a set of discrete single-particle orbitals indexed by $k$, by a Bardeen-Cooper-Schrieffer (BCS) quasiparticle picture with a rotational cranking term. Use units with Planck’s constant $\\hbar$ set to $1$ so that angular frequencies have units of energy. Assume a real, uniform pairing gap $\\Delta(\\omega)$ and a chemical potential $\\lambda(\\omega)$ determined self-consistently for each rotational frequency $\\omega$ by the particle-number constraint. For each orbital $k$, with non-rotating energy $\\epsilon_k^{(0)}$ and aligned angular-momentum projection $j_k$, define the rotating-frame single-particle energy (the routhian) as $\\epsilon_k(\\omega) = \\epsilon_k^{(0)} - \\omega j_k$. The Bardeen-Cooper-Schrieffer (BCS) Bogoliubov amplitudes $u_k(\\omega)$ and $v_k(\\omega)$ must be obtained by diagonalizing the $2 \\times 2$ Bogoliubov-de Gennes matrix for each $k$ and enforcing the number and gap self-consistency equations.\n\nStarting only from these fundamental bases:\n- the definition of the rotating-frame single-particle energies $\\epsilon_k(\\omega) = \\epsilon_k^{(0)} - \\omega j_k$,\n- the Bardeen-Cooper-Schrieffer (BCS) mean-field with a constant pairing interaction of strength $G$ between time-reversed states,\n- the requirement that $\\Delta(\\omega)$ and $\\lambda(\\omega)$ are determined self-consistently at each $\\omega$ by the zero-temperature gap and number equations,\n\nderive the algorithm to compute, for each $\\omega$ in the test suite below, the amplitudes $u_k(\\omega)$ and $v_k(\\omega)$, the pairing gap $\\Delta(\\omega)$, and a quantitative measure of pairing reduction. Ensure that the derivation proceeds from the diagonalization of the $2 \\times 2$ quasiparticle matrix for each $k$ and the associated self-consistency conditions, without invoking any pre-stated shortcut formulas for the target quantities.\n\nPhysical and numerical specifications:\n- Work in energy units of mega-electron-volts, so all energies including $\\epsilon_k^{(0)}$, $\\Delta$, $\\lambda$, and $\\omega$ are in $\\mathrm{MeV}$.\n- The list of orbitals is $k \\in \\{0,1,2,3,4,5\\}$ with $(\\epsilon_k^{(0)} [\\mathrm{MeV}], j_k [\\hbar])$ given by\n  - $k=0: (-3.0, 0.5)$,\n  - $k=1: (-1.0, 1.0)$,\n  - $k=2: (0.2, 0.5)$,\n  - $k=3: (0.8, 3.0)$,\n  - $k=4: (2.0, 1.2)$,\n  - $k=5: (3.0, 0.8)$.\n- Use pairing strength $G = 0.60\\,\\mathrm{MeV}$ and an even particle number $N=6$, so the number constraint is $\\sum_k 2v_k(\\omega)^2 = N$.\n- The test-suite rotational frequencies are $\\omega \\in \\{0.0, 0.24, 0.40, 0.80\\}\\,\\mathrm{MeV}$, chosen to probe a rotationally induced level crossing between $k=2$ and $k=3$ near $\\omega \\approx 0.24\\,\\mathrm{MeV}$, a regime just above the crossing, and a higher-frequency regime with substantial Coriolis anti-pairing.\n- Angles are not used; when computing any angle-related quantity internally, use radians.\n\nTasks:\n- For each $\\omega$, solve self-consistently for $\\Delta(\\omega)$ and $\\lambda(\\omega)$ from the zero-temperature number and gap equations implied by the Bardeen-Cooper-Schrieffer (BCS) mean-field in the rotating frame. Then compute $u_k(\\omega)$ and $v_k(\\omega)$ for all $k$.\n- Quantify the reduction in pairing by the ratio $R(\\omega)=\\Delta(\\omega)/\\Delta(0)$.\n- To characterize the evolution of the Bogoliubov amplitudes at the crossing, also extract $v_{k=2}(\\omega)^2$ and $v_{k=3}(\\omega)^2$ for each $\\omega$.\n\nOutput specification:\n- Express all energies in $\\mathrm{MeV}$ as stated. The final numerical outputs must be rounded to six decimal places.\n- Your program should produce a single line of output containing a list of sublists, one sublist per $\\omega$, where each sublist is of the form $[R(\\omega),v_{2}(\\omega)^2,v_{3}(\\omega)^2]$. All numbers must be floats rounded to six decimal places. For example, the output format must be like $[[r_0,v2_0,v3_0],[r_1,v2_1,v3_1],\\dots]$ with no extra text.\n\nTest suite to implement exactly:\n- Single-particle data as listed above.\n- Pairing strength $G=0.60\\,\\mathrm{MeV}$.\n- Particle number $N=6$.\n- Rotational frequencies $\\omega = 0.0\\,\\mathrm{MeV}, 0.24\\,\\mathrm{MeV}, 0.40\\,\\mathrm{MeV}, 0.80\\,\\mathrm{MeV}$.\n\nYour program must be completely self-contained, take no input, and print only the specified single line.",
            "solution": "The user-provided problem is critically evaluated based on the established validation criteria.\n\n### Step 1: Extract Givens\n- **Model**: Cranked, constant-pairing Bardeen-Cooper-Schrieffer (BCS) model at zero temperature in a rotating mean-field framework.\n- **Routhian Definition**: The rotating-frame single-particle energy (routhian) for orbital $k$ is $\\epsilon_k(\\omega) = \\epsilon_k^{(0)} - \\omega j_k$.\n- **Constants**: Planck's constant $\\hbar=1$. Pairing strength $G = 0.60\\,\\mathrm{MeV}$.\n- **Particle Number**: Total even particle number $N=6$.\n- **Self-Consistency**: The pairing gap $\\Delta(\\omega)$ and chemical potential $\\lambda(\\omega)$ are determined self-consistently at each rotational frequency $\\omega$ via the zero-temperature gap and number equations.\n- **System Basis**: A set of single-particle orbitals indexed by $k \\in \\{0, 1, 2, 3, 4, 5\\}$, each with a non-rotating energy $\\epsilon_k^{(0)}$ and aligned angular-momentum projection $j_k$.\n- **Single-Particle Data**:\n  - $k=0: (\\epsilon_0^{(0)}, j_0) = (-3.0\\,\\mathrm{MeV}, 0.5\\,\\hbar)$\n  - $k=1: (\\epsilon_1^{(0)}, j_1) = (-1.0\\,\\mathrm{MeV}, 1.0\\,\\hbar)$\n  - $k=2: (\\epsilon_2^{(0)}, j_2) = (0.2\\,\\mathrm{MeV}, 0.5\\,\\hbar)$\n  - $k=3: (\\epsilon_3^{(0)}, j_3) = (0.8\\,\\mathrm{MeV}, 3.0\\,\\hbar)$\n  - $k=4: (\\epsilon_4^{(0)}, j_4) = (2.0\\,\\mathrm{MeV}, 1.2\\,\\hbar)$\n  - $k=5: (\\epsilon_5^{(0)}, j_5) = (3.0\\,\\mathrm{MeV}, 0.8\\,\\hbar)$\n- **Number Constraint**: $\\sum_k 2v_k(\\omega)^2 = N$.\n- **Test Frequencies**: $\\omega \\in \\{0.0, 0.24, 0.40, 0.80\\}\\,\\mathrm{MeV}$.\n- **Required Outputs for each $\\omega$**:\n    1. Pairing reduction ratio: $R(\\omega) = \\Delta(\\omega) / \\Delta(0)$.\n    2. Occupation probabilities: $v_2(\\omega)^2$ and $v_3(\\omega)^2$.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientifically Grounded**: The problem is an application of the cranked BCS model, a standard and foundational tool in theoretical nuclear physics for studying rotational properties of atomic nuclei. It is scientifically sound and free of pseudoscience.\n2.  **Well-Posed**: The problem is well-posed. It provides all necessary parameters ($G$, $N$, single-particle spectrum) to solve the BCS equations. The self-consistency requirement leads to a system of non-linear equations that, for the given physical context, typically yields a unique and stable solution for the paired superfluid phase.\n3.  **Objective**: The language is precise, quantitative, and objective. All terms are defined within the standard lexicon of nuclear structure theory.\n4.  **Completeness**: The problem is self-contained. The data for single-particle levels, pairing strength, and particle number are sufficient to perform the calculation.\n5.  **Consistency**: The givens are internally consistent. The units are specified ($\\mathrm{MeV}$, $\\hbar$). The physical scenario (Coriolis-induced pair breaking) aligns with the mathematical formalism (cranked BCS). The level crossing mentioned at $\\omega \\approx 0.24\\,\\mathrm{MeV}$ is verifiable from the provided data: $\\epsilon_2(0.24) = 0.2 - 0.24 \\cdot 0.5 = 0.08\\,\\mathrm{MeV}$ and $\\epsilon_3(0.24) = 0.8 - 0.24 \\cdot 3.0 = 0.08\\,\\mathrm{MeV}$.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\n### Derivation and Algorithmic Design\n\nThe problem requires deriving the algorithm for calculating the Bogoliubov amplitudes ($u_k, v_k$) and self-consistent parameters ($\\Delta, \\lambda$) within the cranked BCS framework.\n\n**1. The Bogoliubov Transformation in the Cranked Frame**\nThe core of the BCS method is the Bogoliubov transformation, which redefines the ground state in terms of independent quasiparticles. In this simplified model, valid at zero temperature, we diagonalize a $2 \\times 2$ matrix for each orbital $k$. A common and effective simplification in cranked BCS, which appears to be implied by the problem's structure, is to construct this matrix using the single-particle routhians $\\epsilon_k(\\omega)$ rather than explicitly handling the time-reversed partner states in the matrix structure. This leads to the Bogoliubov-de Gennes matrix for orbital $k$ in the basis of particle-hole states:\n$$\n\\mathcal{H}_k(\\omega) = \\begin{pmatrix} \\epsilon_k(\\omega) - \\lambda(\\omega)  \\Delta(\\omega) \\\\ \\Delta(\\omega)  -(\\epsilon_k(\\omega) - \\lambda(\\omega)) \\end{pmatrix}\n$$\nHere, $\\epsilon_k(\\omega) = \\epsilon_k^{(0)} - \\omega j_k$ is the single-particle routhian, $\\lambda(\\omega)$ is the chemical potential, and $\\Delta(\\omega)$ is the pairing gap. We assume $\\Delta(\\omega)$ is real and positive.\n\n**2. Quasiparticle Energies and Bogoliubov Amplitudes**\nDiagonalizing $\\mathcal{H}_k(\\omega)$ yields the quasiparticle energies. The eigenvalues are given by $\\pm E_k(\\omega)$, where the positive quasiparticle energy is:\n$$\nE_k(\\omega) = \\sqrt{(\\epsilon_k(\\omega) - \\lambda(\\omega))^2 + \\Delta(\\omega)^2}\n$$\nThe eigenvector corresponding to the eigenvalue $+E_k(\\omega)$ defines the Bogoliubov amplitudes $(u_k, v_k)$. By solving the eigenvector equation $\\mathcal{H}_k(\\omega) \\begin{pmatrix} u_k \\\\ v_k \\end{pmatrix} = E_k(\\omega) \\begin{pmatrix} u_k \\\\ v_k \\end{pmatrix}$ subject to the normalization condition $u_k^2 + v_k^2 = 1$, we derive the standard expressions for the occupation ($v_k^2$) and unoccupation ($u_k^2$) amplitudes:\n$$\nu_k(\\omega)^2 = \\frac{1}{2} \\left( 1 + \\frac{\\epsilon_k(\\omega) - \\lambda(\\omega)}{E_k(\\omega)} \\right)\n$$\n$$\nv_k(\\omega)^2 = \\frac{1}{2} \\left( 1 - \\frac{\\epsilon_k(\\omega) - \\lambda(\\omega)}{E_k(\\omega)} \\right)\n$$\nThe quantity $v_k(\\omega)^2$ represents the probability of finding the pair-state $(k, \\bar{k})$ occupied in the BCS ground state at rotational frequency $\\omega$.\n\n**3. Self-Consistency Equations**\nThe parameters $\\Delta(\\omega)$ and $\\lambda(\\omega)$ are not free parameters but are determined by the properties of the nuclear interaction and the number of particles. They must be solved for self-consistently.\n\n**a. Number Equation:** The total particle number $N$ must be conserved on average. The expectation value of the particle number operator in the BCS ground state is given by the sum of occupation probabilities over all orbitals, accounting for the two particles in each pair $(k, \\bar{k})$.\n$$\nN = \\sum_k 2 v_k(\\omega)^2 = \\sum_k 2 \\cdot \\frac{1}{2} \\left( 1 - \\frac{\\epsilon_k(\\omega) - \\lambda(\\omega)}{E_k(\\omega)} \\right)\n$$\nThis simplifies to the number conservation equation:\n$$\nN = \\sum_k \\left( 1 - \\frac{\\epsilon_k(\\omega) - \\lambda(\\omega)}{\\sqrt{(\\epsilon_k(\\omega) - \\lambda(\\omega))^2 + \\Delta(\\omega)^2}} \\right)\n$$\n\n**b. Gap Equation:** The pairing gap $\\Delta$ arises from the pairing part of the nuclear force. In a BCS model with a constant pairing strength $G$, the gap is defined as $\\Delta = G \\sum_k \\langle \\text{pair} \\rangle_k$. The expectation value of the pair-creation operator for state $k$ is $u_k v_k$.\n$$\n\\Delta(\\omega) = G \\sum_k u_k(\\omega) v_k(\\omega)\n$$\nUsing the derived expressions for $u_k$ and $v_k$, we find $u_k v_k = \\frac{\\Delta}{2 E_k}$. Substituting this into the definition gives:\n$$\n\\Delta(\\omega) = G \\sum_k \\frac{\\Delta(\\omega)}{2 E_k(\\omega)}\n$$\nFor a non-trivial paired solution where $\\Delta(\\omega) > 0$, we can divide by $\\Delta(\\omega)$ to obtain the gap equation:\n$$\n\\frac{2}{G} = \\sum_k \\frac{1}{E_k(\\omega)} = \\sum_k \\frac{1}{\\sqrt{(\\epsilon_k(\\omega) - \\lambda(\\omega))^2 + \\Delta(\\omega)^2}}\n$$\n\n**4. Numerical Solution Algorithm**\nFor each specified rotational frequency $\\omega$, we must find the pair $(\\Delta, \\lambda)$ that simultaneously solves the non-linear number and gap equations. This is a root-finding problem for a system of two equations.\n\nLet us define the functions to be zeroed:\n$$\nF_{\\text{num}}(\\Delta, \\lambda; \\omega) = \\sum_k \\left( 1 - \\frac{\\epsilon_k^{(0)} - \\omega j_k - \\lambda}{\\sqrt{(\\epsilon_k^{(0)} - \\omega j_k - \\lambda)^2 + \\Delta^2}} \\right) - N = 0\n$$\n$$\nF_{\\text{gap}}(\\Delta, \\lambda; \\omega) = \\sum_k \\frac{1}{\\sqrt{(\\epsilon_k^{(0)} - \\omega j_k - \\lambda)^2 + \\Delta^2}} - \\frac{2}{G} = 0\n$$\n\nThe solution procedure is as follows:\n1.  Initialize a list of results.\n2.  Set an initial guess for $(\\Delta, \\lambda)$ at $\\omega=0$. A physically motivated guess for $\\lambda(0)$ is the average energy of the orbitals straddling the Fermi surface for $N/2$ pairs. For $N=6$, this is $3$ pairs, so the levels are $k=0,1,2$. $\\lambda(0)$ is expected to be between $\\epsilon_2^{(0)}=0.2\\,\\mathrm{MeV}$ and $\\epsilon_3^{(0)}=0.8\\,\\mathrm{MeV}$. A reasonable guess for $\\Delta(0)$ is on the order of $1\\,\\mathrm{MeV}$.\n3.  Loop through each $\\omega$ from the test suite:\n    a. Use a numerical root-finder (such as `scipy.optimize.root`) to solve the system $F_{\\text{num}}=0$ and $F_{\\text{gap}}=0$ for $(\\Delta(\\omega), \\lambda(\\omega))$.\n    b. For $\\omega > 0$, the converged solution from the previous, smaller $\\omega$ provides an excellent initial guess, ensuring robustness and efficiency (continuation method).\n    c. After finding $(\\Delta(\\omega), \\lambda(\\omega))$, store $\\Delta(0)$ if $\\omega=0$.\n    d. Calculate the pairing reduction ratio $R(\\omega) = \\Delta(\\omega) / \\Delta(0)$.\n    e. Calculate the required occupation probabilities $v_2(\\omega)^2$ and $v_3(\\omega)^2$ using the converged parameters.\n    f. Append the list $[R(\\omega), v_2(\\omega)^2, v_3(\\omega)^2]$ to the results.\n4.  After the loop, format the results as requested and print the final output. This procedure systematically computes the evolution of nuclear pairing and single-particle structure as a function of rotation.",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import root\n\ndef solve():\n    \"\"\"\n    Solves the cranked BCS problem for a toy model nucleus.\n    \"\"\"\n    \n    # Physical and numerical specifications\n    # Single-particle data: (epsilon_k^0 [MeV], j_k [hbar])\n    sp_data = [\n        (-3.0, 0.5),  # k=0\n        (-1.0, 1.0),  # k=1\n        (0.2, 0.5),   # k=2\n        (0.8, 3.0),   # k=3\n        (2.0, 1.2),   # k=4\n        (3.0, 0.8),   # k=5\n    ]\n    eps0 = np.array([d[0] for d in sp_data])\n    j = np.array([d[1] for d in sp_data])\n    \n    # Pairing strength and particle number\n    G = 0.60  # MeV\n    N = 6.0\n\n    # Test suite of rotational frequencies\n    omega_vals = [0.0, 0.24, 0.40, 0.80] # MeV\n\n    # Store results for all frequencies\n    all_results = []\n    \n    # Store Delta(0) for ratio calculation\n    delta_at_zero = None\n    \n    # Initial guess for the solver [Delta, Lambda]\n    # For omega=0, lambda is roughly between eps0[2] and eps0[3]\n    # A typical Delta is ~1 MeV.\n    initial_guess = np.array([1.0, 0.5]) \n\n    for omega in omega_vals:\n        \n        # Define the system of self-consistency equations for the current omega\n        def bcs_equations(variables):\n            \"\"\"\n            System of BCS equations to be solved for [Delta, Lambda].\n            \n            Args:\n                variables (list or np.ndarray): A list [delta, lamb]\n            \n            Returns:\n                list: The residuals of the [gap_eq, number_eq]\n            \"\"\"\n            delta, lamb = variables\n            \n            # To avoid division by zero if delta -> 0, though not expected here\n            # E_k = sqrt( (eps_k(omega) - lambda)^2 + delta^2 )\n            # Add a small stabilization term inside sqrt for safety.\n            eps_k_omega = eps0 - omega * j\n            ek_prime_sq = (eps_k_omega - lamb)**2\n            \n            # Avoid delta=0 issues, although solver should not go there for a paired solution.\n            delta_sq = delta**2\n            if delta_sq  1e-24:\n                delta_sq = 1e-24\n\n            E_k = np.sqrt(ek_prime_sq + delta_sq)\n            \n            # Gap Equation: 2/G = sum(1 / E_k)\n            gap_eq_residual = np.sum(1.0 / E_k) - 2.0 / G\n            \n            # Number Equation: N = sum(1 - (eps_k(omega) - lambda) / E_k)\n            num_eq_residual = np.sum(1.0 - (eps_k_omega - lamb) / E_k) - N\n            \n            return [gap_eq_residual, num_eq_residual]\n\n        # Solve the system of equations\n        solution = root(bcs_equations, initial_guess, method='hybr', tol=1e-9)\n        \n        if not solution.success:\n            # Handle cases where convergence fails, though not expected for this problem.\n            # For this problem, we can assume it will succeed.\n            # Using NaN as a placeholder for failure.\n            final_delta, final_lambda = np.nan, np.nan\n        else:\n            final_delta, final_lambda = solution.x\n            # Ensure Delta is positive as per convention\n            if final_delta  0:\n                final_delta = -final_delta\n\n        # Update the initial guess for the next omega value (continuation)\n        initial_guess = solution.x\n\n        # Store Delta(0)\n        if omega == 0.0:\n            delta_at_zero = final_delta\n\n        # Calculate required quantities\n        # Ratio R(omega) = Delta(omega) / Delta(0)\n        R_omega = final_delta / delta_at_zero if delta_at_zero is not None else np.nan\n\n        # Occupation probabilities v_k^2 = 0.5 * (1 - (eps_k(omega) - lambda) / E_k)\n        eps_k_omega = eps0 - omega * j\n        ek_prime_sq = (eps_k_omega - final_lambda)**2\n        delta_sq = final_delta**2\n        E_k = np.sqrt(ek_prime_sq + delta_sq)\n        \n        v_k_sq = 0.5 * (1.0 - (eps_k_omega - final_lambda) / E_k)\n        \n        v2_sq = v_k_sq[2]\n        v3_sq = v_k_sq[3]\n\n        # Append results for the current omega, rounded to six decimal places\n        current_results = [\n            round(R_omega, 6),\n            round(v2_sq, 6),\n            round(v3_sq, 6)\n        ]\n        all_results.append(current_results)\n    \n    # The problem asks for a literal list-of-lists format in the string.\n    # The formatting requires floating-point representation, not scientific notation for small numbers.\n    formatted_results = [f\"[{res[0]:.6f},{res[1]:.6f},{res[2]:.6f}]\" for res in all_results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}