{
    "hands_on_practices": [
        {
            "introduction": "我们的第一个练习旨在检验对基本概念的理解。通过将斯特鲁金斯基方法应用于一个高度简化的等间距能谱，我们可以解析地推导出壳修正，并观察“平滑”过程最基本的工作方式。这个练习将阐明离散能量求和 $E$ 与其连续近似 $\\tilde{E}$ 之间的关系。",
            "id": "3593400",
            "problem": "考虑一个计算核物理中的平均场模型，其中单粒子谱是一组示意性的等间距能级，由 $\\,\\epsilon_{i} = i\\,\\hbar\\omega\\,$ 给出，其中 $\\,i = 1, 2, \\dots\\,$，每个能级的简并度为常数 $\\,g\\,$。假设一个闭合壳层恰好占据 $\\,M\\,$ 个能级，因此粒子数为 $\\,N = g\\,M\\,$。Strutinsky壳层修正方法将壳层修正能定义为 $\\,\\delta E = E - \\tilde{E}\\,$，其中 $\\,E\\,$ 是已占据单粒子能量的分立求和，而 $\\,\\tilde{E}\\,$ 是通过用Strutinsky平滑能级密度替换分立能级密度得到的相应平滑能量。请使用以下物理上真实的设定：\n- 平滑核是宽度为 $\\,\\gamma\\,$ 的高斯函数和一个偶数阶 $\\,p \\geq 2\\,$ 的曲率修正多项式，其选择应使能量中至少2次及以下的多项式在平滑后保持不变。\n- 平滑宽度满足 $\\,\\gamma/(\\hbar\\omega) \\gg 1\\,$，因此周期为 $\\,\\hbar\\omega\\,$ 的振荡贡献被指数抑制，平滑能级密度在感兴趣的能量尺度上趋于一个常数平台。\n\n在这些假设下，从第一性原理推导该示意谱的壳层修正 $\\,\\delta E\\,$ 的闭合形式表达式。然后，定性和定量地分析为什么在精确的谐振子对称性下，当单粒子能量为 $\\,\\epsilon_{i}^{\\mathrm{HO}} = (i + \\tfrac{1}{2})\\,\\hbar\\omega\\,$（其中 $\\,i = 0, 1, \\dots\\,$）时，对于一个闭合壳层，在Strutinsky框架内，当 $\\,\\gamma/(\\hbar\\omega) \\gg 1\\,$ 且曲率修正阶数足以保持多项式平均时，壳层修正 $\\,\\delta E\\,$ 趋于零。最后，将示意等间距情况下的壳层修正 $\\,\\delta E\\,$ 与您得到的平滑能量 $\\,\\tilde{E}\\,$ 进行比较。\n\n通过报告一对无量纲量 $\\,\\delta E/(g\\,\\hbar\\omega)\\,$ 和 $\\,\\tilde{E}/(g\\,\\hbar\\omega)\\,$，将您的最终结果表示为一个二元行矩阵。不要代入数值。无需四舍五入。",
            "solution": "该问题要求推导Strutinsky壳层修正能 $\\delta E$，该模型为一个示意性的等间距核单粒子能级模型。此外，它要求分析为什么对于谐振子势，该修正趋于零，并将示意模型的壳层修正 $\\delta E$ 与其平滑能量 $\\tilde{E}$ 进行比较。\n\n首先，我们处理示意模型，其中单粒子能量由 $\\epsilon_{i} = i\\,\\hbar\\omega\\,$ 给出，$\\,i = 1, 2, \\dots\\,$，每个能级的简并度为常数 $g$。通过完全填充最低的 $M$ 个能级形成一个闭合壳层。\n\n总粒子数为 $N = gM$。\n\n总分立能量 $E$ 是所有已占据单粒子态能量的总和：\n$$\nE = \\sum_{i=1}^{M} g\\,\\epsilon_{i} = g \\sum_{i=1}^{M} i\\,\\hbar\\omega\n$$\n使用前 $M$ 个整数求和公式 $\\sum_{i=1}^{M} i = \\frac{M(M+1)}{2}$，我们得到：\n$$\nE = g\\,\\hbar\\omega\\,\\frac{M(M+1)}{2}\n$$\n\n接下来，我们确定平滑能量 $\\tilde{E}$。这需要平滑能级密度 $\\tilde{g}(\\epsilon)$。分立能级密度是一系列狄拉克δ函数：$g_{\\text{discrete}}(\\epsilon) = g \\sum_{i=1}^{\\infty} \\delta(\\epsilon - i\\,\\hbar\\omega)$。在平滑宽度 $\\gamma$ 远大于能级间距 $\\hbar\\omega$（$\\gamma/(\\hbar\\omega) \\gg 1$）的极限下，Strutinsky平滑过程对这个分立分布进行平均。对于均匀间隔的能级，能量达到 $\\epsilon$ 时的平均能级数为 $\\epsilon/(\\hbar\\omega)$。考虑到简并度 $g$，平均态数为 $\\tilde{N}(\\epsilon) = g\\epsilon/(\\hbar\\omega)$。平滑能级密度是其对能量的导数：\n$$\n\\tilde{g}(\\epsilon) = \\frac{d\\tilde{N}(\\epsilon)}{d\\epsilon} = \\frac{g}{\\hbar\\omega}\n$$\n这是一个常数，即一个0次多项式。问题指出，平滑过程保持至少2次的多项式不变，因此对 $\\tilde{g}(\\epsilon)$ 的这种选择是一致的。\n\n平滑能量 $\\tilde{E}$ 是通过将 $\\epsilon\\,\\tilde{g}(\\epsilon)$ 积分到平滑费米能（我们记为 $\\lambda$）来计算的。这个费米能 $\\lambda$ 是通过保持粒子数 $N$ 守恒来确定的：\n$$\nN = \\int_{0}^{\\lambda} \\tilde{g}(\\epsilon)\\,d\\epsilon = \\int_{0}^{\\lambda} \\frac{g}{\\hbar\\omega}\\,d\\epsilon = \\frac{g}{\\hbar\\omega}\\,\\lambda\n$$\n因为 $N=gM$，我们得到平滑费米能为：\n$$\n\\lambda = M\\,\\hbar\\omega\n$$\n现在我们可以计算平滑能量 $\\tilde{E}$：\n$$\n\\tilde{E} = \\int_{0}^{\\lambda} \\epsilon\\,\\tilde{g}(\\epsilon)\\,d\\epsilon = \\int_{0}^{M\\,\\hbar\\omega} \\epsilon\\,\\frac{g}{\\hbar\\omega}\\,d\\epsilon = \\frac{g}{\\hbar\\omega} \\left[ \\frac{\\epsilon^2}{2} \\right]_{0}^{M\\,\\hbar\\omega}\n$$\n$$\n\\tilde{E} = \\frac{g}{\\hbar\\omega} \\frac{(M\\,\\hbar\\omega)^2}{2} = \\frac{g\\,\\hbar\\omega\\,M^2}{2}\n$$\n壳层修正能 $\\delta E$ 定义为分立能量和平滑能量之差：\n$$\n\\delta E = E - \\tilde{E} = g\\,\\hbar\\omega\\,\\frac{M(M+1)}{2} - \\frac{g\\,\\hbar\\omega\\,M^2}{2}\n$$\n$$\n\\delta E = \\frac{g\\,\\hbar\\omega}{2} (M^2 + M - M^2) = \\frac{g\\,\\hbar\\omega\\,M}{2}\n$$\n\n其次，我们分析三维各向同性谐振子（HO）的情况，其单粒子能量为 $\\epsilon_i^{\\mathrm{HO}} = (i + \\tfrac{3}{2})\\hbar\\omega$（使用一个常见的约定）或如题给定的 $\\epsilon_i^{\\mathrm{HO}} = (i + \\tfrac{1}{2})\\hbar\\omega$，其中 $i=0, 1, 2, \\dots$。后者对应于一维谐振子，但该论证对任何维度都成立。我们使用给定的能量 $\\epsilon_i^{\\mathrm{HO}} = (i + \\tfrac{1}{2})\\hbar\\omega$。在三维谐振子中，能级 $i$ 的简并度为 $g_i = (i+1)(i+2)$。Strutinsky方法旨在将总单粒子能量分离为一个平滑变化的部分 $\\tilde{E}$（被认为是液滴模型能量）和一个振荡部分 $\\delta E$（即壳层修正）。\n量子数达到 $I$ 时的平均态数为 $\\tilde{N}(I) = \\sum_{i=0}^I g_i = \\sum_{i=0}^I (i+1)(i+2) = \\frac{(I+1)(I+2)(I+3)}{3}$。用能量 $\\epsilon$ 表示 $I$，$I \\approx \\epsilon/(\\hbar\\omega)$，我们看到 $\\tilde{N}(\\epsilon)$ 是 $\\epsilon$ 的三次多项式。因此，平滑能级密度 $\\tilde{g}(\\epsilon) = d\\tilde{N}(\\epsilon)/d\\epsilon$ 是 $\\epsilon$ 的二次多项式。问题指定平滑过程被构造成保持至少2次的多项式不变。\n由于谐振子势的高度对称性，在壳层闭合处，单粒子能量的精确总和 $E = \\sum g_i \\epsilon_i$ 不是粒子数的振荡函数，而是一个平滑的多项式函数。根据Strutinsky方法的构造，平滑能量 $\\tilde{E}$ 是对 $E$ 的最佳平滑多项式近似。由于对于闭合壳层，$E$ 本身已经是一个平滑的多项式，其次数与 $\\tilde{E}$ 设计用来捕捉的次数相匹配，因此该方法得出 $\\tilde{E} = E$。因此，在纯谐振子势中，闭合壳层的壳层修正 $\\delta E = E - \\tilde{E}$ 必须为零。这种消失是Strutinsky方法的一个关键测试和特征，证实了它能正确地分离出对能量的非平滑、振荡的贡献。\n\n最后，我们将原始示意模型的壳层修正 $\\delta E$ 与平滑能量 $\\tilde{E}$ 进行比较。我们得到：\n$$\n\\delta E = \\frac{g\\,\\hbar\\omega\\,M}{2}\n$$\n$$\n\\tilde{E} = \\frac{g\\,\\hbar\\omega\\,M^2}{2}\n$$\n壳层修正与平滑能量之比为：\n$$\n\\frac{\\delta E}{\\tilde{E}} = \\frac{g\\,\\hbar\\omega\\,M/2}{g\\,\\hbar\\omega\\,M^2/2} = \\frac{1}{M}\n$$\n对于任何相当重的原子核，填充的壳层数 $M$ 很大，因此壳层修正能 $\\delta E$ 是总平滑能量 $\\tilde{E}$ 的一小部分。这与物理图像是一致的，即壳层效应是在液滴模型描述的体能量之上的一个相对较小但至关重要的调制。\n\n问题要求将示意模型的最终结果表示为一对无量纲量 $\\delta E/(g\\,\\hbar\\omega)$ 和 $\\tilde{E}/(g\\,\\hbar\\omega)$。\n$$\n\\frac{\\delta E}{g\\,\\hbar\\omega} = \\frac{g\\,\\hbar\\omega\\,M/2}{g\\,\\hbar\\omega} = \\frac{M}{2}\n$$\n$$\n\\frac{\\tilde{E}}{g\\,\\hbar\\omega} = \\frac{g\\,\\hbar\\omega\\,M^2/2}{g\\,\\hbar\\omega} = \\frac{M^2}{2}\n$$\n这两个结果将以一个二元行矩阵的形式提供。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{M}{2} & \\frac{M^2}{2}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在计算出一个具体值之后，理解壳修正的基本性质至关重要。本练习旨在探究壳修正能量在能量标度变换下的行为，这是对任何物理量的一项关键检验。通过证明其协变性，可以表明斯特鲁金斯基方法确实分离出了总能量中具有物理意义的组分。",
            "id": "3593345",
            "problem": "您正在一个计算核物理程序中为有限单粒子谱实现斯特鲁丁斯基壳层修正方法。设离散的单粒子能量为 $\\{\\epsilon_{i}\\}_{i=1}^{\\infty}$，并设最低的 $N$ 个能级被占据，其中 $N \\in \\mathbb{N}$。采用标准斯特鲁丁斯基平滑方法，该方法具有高斯折叠和 $M$ 阶曲率修正（$M \\in \\mathbb{N}$），其特征为一个核函数 $K_{M}(x)$ 和平滑宽度 $\\gamma > 0$，使得平滑后的能级密度为\n$$\ng_{\\text{sm}}(\\epsilon;\\gamma,M) \\equiv \\sum_{i=1}^{\\infty} \\frac{1}{\\gamma}\\,K_{M}\\!\\left(\\frac{\\epsilon-\\epsilon_{i}}{\\gamma}\\right).\n$$\n假设核函数满足以下基本性质：(i) 归一化 $\\int_{-\\infty}^{\\infty} K_{M}(x)\\,dx = 1$，(ii) 偶性 $K_{M}(-x)=K_{M}(x)$，(iii) 直到 $2M$ 阶的矩抵消，这强制了斯特鲁丁斯基曲率修正，以及 (iv) 标度不变结构，$K_{M}$ 仅通过 $(\\epsilon-\\epsilon_{i})/\\gamma$ 依赖于 $\\epsilon$。对于化学势 $\\lambda$，定义平滑粒子数\n$$\n\\mathcal{N}(\\lambda;\\gamma,M) \\equiv \\int_{-\\infty}^{\\lambda} g_{\\text{sm}}(\\epsilon;\\gamma,M)\\,d\\epsilon,\n$$\n并令 $\\lambda(\\gamma)$ 由粒子数条件 $\\mathcal{N}(\\lambda(\\gamma);\\gamma,M)=N$ 固定。定义平滑能量\n$$\nE_{\\text{sm}}(\\gamma) \\equiv \\int_{-\\infty}^{\\lambda(\\gamma)} \\epsilon\\, g_{\\text{sm}}(\\epsilon;\\gamma,M)\\, d\\epsilon,\n$$\n以及斯特鲁丁斯基壳层修正能量\n$$\nE_{\\text{shell}}(\\gamma) \\equiv \\sum_{i=1}^{N} \\epsilon_{i} - E_{\\text{sm}}(\\gamma).\n$$\n现在考虑单粒子能标的一次仿射变换，\n$$\n\\epsilon \\mapsto \\epsilon' \\equiv a\\,\\epsilon + b,\n$$\n其中 $a>0$ 且 $b \\in \\mathbb{R}$。用相同的占据数构建带撇能谱 $\\{\\epsilon_{i}'\\}$，并使用相同的核函数 $K_{M}$ 但经过重新标度的平滑宽度 $\\gamma' \\equiv a\\,\\gamma$ 来定义带撇的平滑能级密度 $g_{\\text{sm}}'(\\epsilon';\\gamma',M)$。通过带撇的粒子数条件来定义 $\\lambda'(\\gamma')$，并与不带撇的定义类似地定义相应的带撇平滑能量 $E_{\\text{sm}}'(\\gamma')$ 和壳层修正 $E_{\\text{shell}}'(\\gamma')$。\n\n仅从这些定义和所述的核函数性质出发，且不假设 $K_{M}$ 的任何其他具体形式，推导以下表达式的闭式解：\n$$\n\\Delta(a,b,\\gamma) \\equiv E_{\\text{shell}}'(\\gamma') - a\\, E_{\\text{shell}}(\\gamma),\n$$\n并将其尽可能地化简。您的最终答案必须是一个实值常数或一个解析表达式。不需要进行数值计算。请将您的最终答案表述为 $\\Delta(a,b,\\gamma)$ 的显式表达式。不要包含单位。",
            "solution": "用户希望找到 $\\Delta(a,b,\\gamma) \\equiv E_{\\text{shell}}'(\\gamma') - a\\, E_{\\text{shell}}(\\gamma)$ 的闭式表达式。\n\n首先，我们写出壳层修正能量的定义。不带撇的壳层修正由下式给出\n$$\nE_{\\text{shell}}(\\gamma) \\equiv \\sum_{i=1}^{N} \\epsilon_{i} - E_{\\text{sm}}(\\gamma).\n$$\n带撇的壳层修正对于带撇能谱 $\\{\\epsilon_i' = a\\epsilon_i + b\\}$ 和带撇平滑宽度 $\\gamma' = a\\gamma$ 的定义是类似的：\n$$\nE_{\\text{shell}}'(\\gamma') \\equiv \\sum_{i=1}^{N} \\epsilon_{i}' - E_{\\text{sm}}'(\\gamma').\n$$\n现在，将这些定义代入 $\\Delta(a,b,\\gamma)$ 的表达式中：\n$$\n\\Delta(a,b,\\gamma) = \\left( \\sum_{i=1}^{N} \\epsilon_{i}' - E_{\\text{sm}}'(\\gamma') \\right) - a \\left( \\sum_{i=1}^{N} \\epsilon_{i} - E_{\\text{sm}}(\\gamma) \\right).\n$$\n我们来分析对离散的带撇能量的求和。使用仿射变换 $\\epsilon_i' = a\\epsilon_i + b$：\n$$\n\\sum_{i=1}^{N} \\epsilon_{i}' = \\sum_{i=1}^{N} (a\\epsilon_{i} + b) = a \\left( \\sum_{i=1}^{N} \\epsilon_{i} \\right) + \\sum_{i=1}^{N} b = a \\sum_{i=1}^{N} \\epsilon_{i} + N b.\n$$\n将此结果代入 $\\Delta(a,b,\\gamma)$ 的表达式中：\n$$\n\\Delta(a,b,\\gamma) = \\left( a \\sum_{i=1}^{N} \\epsilon_{i} + N b - E_{\\text{sm}}'(\\gamma') \\right) - a \\sum_{i=1}^{N} \\epsilon_{i} + a E_{\\text{sm}}(\\gamma).\n$$\n包含离散能量求和的项相互抵消：\n$$\n\\Delta(a,b,\\gamma) = N b - E_{\\text{sm}}'(\\gamma') + a E_{\\text{sm}}(\\gamma).\n$$\n为了继续推导，我们必须找到带撇平滑能量 $E_{\\text{sm}}'(\\gamma')$ 与不带撇平滑能量 $E_{\\text{sm}}(\\gamma)$ 之间的关系。这需要我们首先关联带撇与不带撇的平滑能级密度，$g_{\\text{sm}}'$ 和 $g_{\\text{sm}}$。\n\n带撇的平滑能级密度定义为：\n$$\ng_{\\text{sm}}'(\\epsilon';\\gamma',M) = \\sum_{i=1}^{\\infty} \\frac{1}{\\gamma'}\\,K_{M}\\!\\left(\\frac{\\epsilon'-\\epsilon_{i}'}{\\gamma'}\\right).\n$$\n代入 $\\gamma' = a\\gamma$ 和 $\\epsilon_i' = a\\epsilon_i + b$：\n$$\ng_{\\text{sm}}'(\\epsilon'; a\\gamma, M) = \\sum_{i=1}^{\\infty} \\frac{1}{a\\gamma}\\,K_{M}\\!\\left(\\frac{\\epsilon' - (a\\epsilon_{i} + b)}{a\\gamma}\\right).\n$$\n我们在能量 $\\epsilon'$ 处计算该表达式，其中 $\\epsilon'$ 对应于变换前的原始能量 $\\epsilon$，即 $\\epsilon' = a\\epsilon + b$。\n$$\ng_{\\text{sm}}'(a\\epsilon+b; a\\gamma, M) = \\sum_{i=1}^{\\infty} \\frac{1}{a\\gamma}\\,K_{M}\\!\\left(\\frac{(a\\epsilon+b) - (a\\epsilon_{i} + b)}{a\\gamma}\\right) = \\sum_{i=1}^{\\infty} \\frac{1}{a\\gamma}\\,K_{M}\\!\\left(\\frac{a(\\epsilon - \\epsilon_{i})}{a\\gamma}\\right).\n$$\n化简后得到：\n$$\ng_{\\text{sm}}'(a\\epsilon+b; a\\gamma, M) = \\frac{1}{a} \\sum_{i=1}^{\\infty} \\frac{1}{\\gamma}\\,K_{M}\\!\\left(\\frac{\\epsilon - \\epsilon_{i}}{\\gamma}\\right) = \\frac{1}{a} g_{\\text{sm}}(\\epsilon;\\gamma,M).\n$$\n这就给出了能级密度之间的关键关系：$g_{\\text{sm}}'(a\\epsilon+b) = \\frac{1}{a} g_{\\text{sm}}(\\epsilon)$。\n\n接下来，我们使用粒子数条件来关联带撇与不带撇的化学势 $\\lambda'(\\gamma')$ 和 $\\lambda(\\gamma)$。不带撇的条件是 $\\mathcal{N}(\\lambda(\\gamma);\\gamma,M) = N$，其中\n$$\n\\mathcal{N}(\\lambda) = \\int_{-\\infty}^{\\lambda} g_{\\text{sm}}(\\epsilon;\\gamma,M)\\,d\\epsilon.\n$$\n带撇的条件是 $\\mathcal{N}'(\\lambda'(\\gamma');\\gamma',M) = N$，其中\n$$\n\\mathcal{N}'(\\lambda') = \\int_{-\\infty}^{\\lambda'} g_{\\text{sm}}'(\\epsilon';\\gamma',M)\\,d\\epsilon'.\n$$\n我们使用变量替换 $\\epsilon' = a\\epsilon + b$ 来变换 $\\mathcal{N}'(\\lambda')$ 的积分。这意味着 $d\\epsilon' = a\\,d\\epsilon$，因为 $a$ 是常数。积分下限保持为 $-\\infty$（因为 $a>0$），而积分上限 $\\lambda'$ 对应于 $\\epsilon = (\\lambda' - b)/a$。\n$$\n\\mathcal{N}'(\\lambda') = \\int_{-\\infty}^{(\\lambda'-b)/a} g_{\\text{sm}}'(a\\epsilon+b; a\\gamma, M) \\, (a\\,d\\epsilon).\n$$\n使用关系式 $g_{\\text{sm}}'(a\\epsilon+b) = \\frac{1}{a} g_{\\text{sm}}(\\epsilon)$，我们得到：\n$$\n\\mathcal{N}'(\\lambda') = \\int_{-\\infty}^{(\\lambda'-b)/a} \\left(\\frac{1}{a} g_{\\text{sm}}(\\epsilon;\\gamma,M)\\right) (a\\,d\\epsilon) = \\int_{-\\infty}^{(\\lambda'-b)/a} g_{\\text{sm}}(\\epsilon;\\gamma,M)\\,d\\epsilon = \\mathcal{N}\\left(\\frac{\\lambda'-b}{a}\\right).\n$$\n粒子数条件是 $\\mathcal{N}'(\\lambda'(\\gamma'))=N$ 和 $\\mathcal{N}(\\lambda(\\gamma))=N$。因此，我们有 $\\mathcal{N}(\\frac{\\lambda'(\\gamma')-b}{a}) = N$。假设平滑粒子数 $\\mathcal{N}$ 是其自变量的严格递增函数（确实如此，因为 $g_{\\text{sm}}$ 是非负的），我们可以令自变量相等：\n$$\n\\frac{\\lambda'(\\gamma')-b}{a} = \\lambda(\\gamma) \\implies \\lambda'(\\gamma') = a\\,\\lambda(\\gamma) + b.\n$$\n化学势与能级遵循相同的仿射变换。\n\n最后，我们可以关联平滑能量。带撇的平滑能量是：\n$$\nE_{\\text{sm}}'(\\gamma') = \\int_{-\\infty}^{\\lambda'(\\gamma')} \\epsilon'\\, g_{\\text{sm}}'(\\epsilon';\\gamma',M)\\, d\\epsilon'.\n$$\n我们应用相同的变量替换 $\\epsilon' = a\\epsilon + b$，所以 $d\\epsilon' = a\\,d\\epsilon$。积分上限 $\\lambda'(\\gamma')$ 在 $\\epsilon$ 坐标系中变为 $\\lambda(\\gamma)$。\n$$\nE_{\\text{sm}}'(\\gamma') = \\int_{-\\infty}^{\\lambda(\\gamma)} (a\\epsilon+b) \\, g_{\\text{sm}}'(a\\epsilon+b; a\\gamma, M) \\, (a\\,d\\epsilon).\n$$\n代入 $g_{\\text{sm}}'(a\\epsilon+b) = \\frac{1}{a} g_{\\text{sm}}(\\epsilon)$：\n$$\nE_{\\text{sm}}'(\\gamma') = \\int_{-\\infty}^{\\lambda(\\gamma)} (a\\epsilon+b) \\left(\\frac{1}{a} g_{\\text{sm}}(\\epsilon;\\gamma,M)\\right) (a\\,d\\epsilon) = \\int_{-\\infty}^{\\lambda(\\gamma)} (a\\epsilon+b) \\, g_{\\text{sm}}(\\epsilon;\\gamma,M) \\, d\\epsilon.\n$$\n我们可以将这个积分分成两部分：\n$$\nE_{\\text{sm}}'(\\gamma') = a \\int_{-\\infty}^{\\lambda(\\gamma)} \\epsilon \\, g_{\\text{sm}}(\\epsilon;\\gamma,M) \\, d\\epsilon + b \\int_{-\\infty}^{\\lambda(\\gamma)} g_{\\text{sm}}(\\epsilon;\\gamma,M) \\, d\\epsilon.\n$$\n第一个积分是不带撇的平滑能量 $E_{\\text{sm}}(\\gamma)$ 的定义。第二个积分是不带撇的平滑粒子数 $\\mathcal{N}(\\lambda(\\gamma);\\gamma,M)$ 的定义，它被约束为 $N$。\n因此，我们得到以下关系：\n$$\nE_{\\text{sm}}'(\\gamma') = a\\,E_{\\text{sm}}(\\gamma) + bN.\n$$\n现在我们将此结果代回到我们关于 $\\Delta(a,b,\\gamma)$ 的表达式中：\n$$\n\\Delta(a,b,\\gamma) = N b - E_{\\text{sm}}'(\\gamma') + a E_{\\text{sm}}(\\gamma) = N b - (a\\,E_{\\text{sm}}(\\gamma) + bN) + a E_{\\text{sm}}(\\gamma).\n$$\n化简表达式表明所有项都相互抵消了：\n$$\n\\Delta(a,b,\\gamma) = N b - a\\,E_{\\text{sm}}(\\gamma) - bN + a E_{\\text{sm}}(\\gamma) = 0.\n$$\n只要所述性质成立，该结果与 $a$、$b$、$\\gamma$、$N$ 以及核函数 $K_M$ 的具体形式无关。这意味着壳层修正能量是协变的，即 $E_{\\text{shell}}'(\\gamma') = a\\,E_{\\text{shell}}(\\gamma)$。",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "最后的练习将理论与计算实践联系起来。斯特鲁金斯基方法的有效性依赖于特定的数值条件，而这些条件在具有稀疏能级的物理系统（如轻核）中可能无法满足。这个编码练习要求您量化这些条件，确定确保平滑过程可靠性所需的最小能级数。",
            "id": "3593409",
            "problem": "你需要编写一个完整、可运行的程序，从第一性原理出发，确定在单粒子谱稀疏的情况下，斯特鲁金斯基平滑法何时对轻核失效。请使用以下植根于斯特鲁金斯基壳层修正法的构造。\n\n基本基础和定义。单粒子能级密度的斯特鲁金斯基平滑法使用一个折叠核，该核是一个宽度为 $\\gamma$ 的高斯函数和一个阶数为 $p$ 的曲率修正多项式的乘积。在标准表述中，该核为\n$$\nf_p(x) \\equiv \\frac{1}{\\sqrt{\\pi}} e^{-x^2} L_p^{1/2}(x^2),\n$$\n其中 $L_p^{1/2}$ 是阶数为 $p$、指数为 $1/2$ 的广义拉盖尔多项式，$x$ 是以 $\\gamma$ 为单位的能量偏差。曲率修正保证了 $f_p(x)$ 的最高达 $2p$ 阶的连续矩能够再现所需的约束条件，\n$$\n\\int_{-\\infty}^{\\infty} x^m f_p(x)\\,dx =\n\\begin{cases}\n1,  m=0, \\\\\n0,  m=2,4,\\dots,2p, \\\\\n\\text{finite},  \\text{otherwise},\n\\end{cases}\n$$\n确保了在保持归一化的同时，移除了最高达 $2p$ 次的光滑多项式趋势。在具有等间距离散能级的计算中，连续积分由一个离散求和（黎曼和）来近似，该求和遍历间距为 $d$ 的能级 $E_i$，且不失一般性地将费米能设为 $E_F=0$。引入无量纲间距 $s \\equiv d/\\gamma$ 和网格点 $x_i \\equiv i s$（其中 $i \\in \\mathbb{Z}$），一个对称的 $2M+1$ 点离散矩为\n$$\nS_m^{(M)}(s,p) \\equiv s \\sum_{i=-M}^{M} x_i^m f_p(x_i).\n$$\n为了获得数值上可靠的斯特鲁金斯基平台，离散矩必须在给定的绝对容差 $\\tau>0$ 内近似精确的矩约束。定义最大矩误差为\n$$\n\\varepsilon_{\\max}(M;s,p) \\equiv \\max\\big\\{ \\, |S_0^{(M)}(s,p)-1|, \\, |S_2^{(M)}(s,p)|, \\, |S_4^{(M)}(s,p)|, \\dots, |S_{2p}^{(M)}(s,p)| \\, \\big\\}.\n$$\n我们称，获得可靠的 $\\gamma$-平台所需的最小对称能级数 $N_{\\min}$ 是满足 $\\varepsilon_{\\max}(M_{\\min};s,p) \\le \\tau$ 的最小奇数 $N_{\\min}=2M_{\\min}+1$。\n\n针对轻核的有限谱约束。由于势阱深度有限，轻核在费米能周围只有少数束缚单粒子能级。通过指定两个非负能量截断值 $E_{\\text{left}}$ 和 $E_{\\text{right}}$（单位为兆电子伏特，MeV）来模拟此限制，它们分别表示费米能左侧和右侧的可用能量范围。对于能级间距 $d$（单位为 MeV），对称地在每一侧可访问的最大能级数为\n$$\nM_{\\text{left}} \\equiv \\left\\lfloor \\frac{E_{\\text{left}}}{d} \\right\\rfloor, \\quad\nM_{\\text{right}} \\equiv \\left\\lfloor \\frac{E_{\\text{right}}}{d} \\right\\rfloor.\n$$\n一个对称的 $2M+1$ 点求和要求 $M \\le \\min(M_{\\text{left}}, M_{\\text{right}})$。如果在该限制下的任何 $M$ 都无法满足 $\\varepsilon_{\\max}(M;s,p) \\le \\tau$，则认为在给定条件下，由于谱稀疏或采样粗糙，$\\gamma$-平台不可靠，此时你必须报告失败。\n\n计算任务。对于下面的每个测试用例，使用以下参数计算 $N_{\\min}$：\n- 单粒子能级间距 $d$（MeV），\n- 平滑宽度 $\\gamma$（MeV），\n- 曲率修正阶数 $p$（一个非负整数），\n- 绝对容差 $\\tau$（无量纲），\n- 可用能量范围 $E_{\\text{left}}$ 和 $E_{\\text{right}}$（MeV）。\n\n需要注意的数值细节：\n- 使用上面给出的 $f_p(x)$ 的精确解析形式，其中包含广义拉盖尔多项式 $L_p^{1/2}$。\n- 使用关于 $i=-M,\\dots,M$ 的离散对称求和，其中 $x_i = i\\, (d/\\gamma)$。\n- 确定满足指定容差的最小 $M$，该容差需涵盖所有最高达 $2p$ 阶的偶数矩。\n- 使用 $M \\le \\min(\\lfloor E_{\\text{left}}/d \\rfloor, \\lfloor E_{\\text{right}}/d \\rfloor)$ 强制执行有限谱约束；如果在该限制下的任何 $M$ 都不满足条件，则声明失败。\n- 若失败，则为该测试用例输出 $-1$。\n- 输出 $N_{\\min}$ 是一个纯计数，因此是无量纲的。\n\n测试套件。使用以下四个参数集来检验不同情况：\n1. 谱密集的理想路径：\n   - $d=0.25$ MeV, $\\gamma=1.2$ MeV, $p=6$, $\\tau=5 \\times 10^{-3}$, $E_{\\text{left}}=20$ MeV, $E_{\\text{right}}=20$ MeV。\n2. 边缘受限的轻核：\n   - $d=0.8$ MeV, $\\gamma=1.2$ MeV, $p=6$, $\\tau=5 \\times 10^{-3}$, $E_{\\text{left}}=4$ MeV, $E_{\\text{right}}=6$ MeV。\n3. 小 $\\gamma$ 的粗糙采样：\n   - $d=1.0$ MeV, $\\gamma=0.6$ MeV, $p=8$, $\\tau=10^{-2}$, $E_{\\text{left}}=6$ MeV, $E_{\\text{right}}=6$ MeV。\n4. 高曲率修正阶数：\n   - $d=0.3$ MeV, $\\gamma=1.2$ MeV, $p=10$, $\\tau=5 \\times 10^{-3}$, $E_{\\text{left}}=8$ MeV, $E_{\\text{right}}=8$ MeV。\n\n最终输出格式。你的程序应生成单行输出，包含四个结果，形式为用方括号括起来的逗号分隔列表（例如，“[n1,n2,n3,n4]”），其中每个 $n_k$ 是测试用例 $k$ 的整数 $N_{\\min}$，如果无法在规定约束下获得可靠的 $\\gamma$-平台，则为 $-1$。不应打印任何额外文本。所有角度均无关；所有能量必须以兆电子伏特（MeV）处理，但最终结果是无量纲的，并且必须是指定的整数。",
            "solution": "该问题要求开发一种数值算法，以确定获得可靠的斯特鲁金斯基能量修正所需的最小单粒子能级数 $N_{\\min}$，同时要受到轻核中可用能谱的物理约束。该问题是适定的，其科学基础植根于计算核物理的原理，并为获得唯一、可验证的解提供了所有必要的定义和参数。\n\n斯特鲁金斯基壳层修正方法的核心是通过平滑离散的单粒子能级密度 $g(E) = \\sum_i \\delta(E-E_i)$ 来获得一个平滑的能级密度 $\\tilde{g}(E)$。这是通过将离散密度与一个核函数进行折叠来实现的。问题将此核函数定义为：\n$$\nf_p(x) = \\frac{1}{\\sqrt{\\pi}} e^{-x^2} L_p^{1/2}(x^2)\n$$\n这里，$x = (E-E')/\\gamma$ 是从中心能量 $E'$ 出发的无量纲能量差，以平滑宽度 $\\gamma$ 为单位。函数 $L_p^{1/2}$ 是阶数为 $p$、指数为 $1/2$ 的广义拉盖尔多项式。包含此多项式是为了进行曲率修正，确保对任何最高达 $2p$ 次的多项式能级密度的平滑重构都是精确的。这一性质在数学上由核函数的矩约束保证：\n$$\n\\int_{-\\infty}^{\\infty} x^m f_p(x)\\,dx =\n\\begin{cases}\n1,  \\text{for } m=0 \\\\\n0,  \\text{for } m=2, 4, \\dots, 2p\n\\end{cases}\n$$\n$m=0$ 的约束确保了归一化（粒子数守恒），而 $m>0$ 的约束确保了平滑多项式趋势的移除。\n\n在数值计算中，连续能谱被一组离散能级 $E_i$ 所取代。为简单起见，问题将能谱模拟为具有均匀间距 $d$ 的无限阶梯。费米能被设为 $E_F=0$。连续积分的矩随后被离散的黎曼和所替代。问题将 $m$ 阶离散对称矩定义为：\n$$\nS_m^{(M)}(s,p) = s \\sum_{i=-M}^{M} x_i^m f_p(x_i)\n$$\n其中 $s = d/\\gamma$ 是无量纲能级间距，$x_i = i s$ 是离散的无量纲能量点。求和遍历费米能周围对称的 $2M+1$ 个能级。\n\n可靠的数值平滑，即所谓的斯特鲁金斯基平台，是在离散矩 $S_m^{(M)}$ 与其理想连续值足够接近时实现的。问题通过定义一个最大矩误差 $\\varepsilon_{\\max}$ 来量化这一点，该误差是所有相关偶数矩中的最大绝对偏差：\n$$\n\\varepsilon_{\\max}(M;s,p) = \\max\\big\\{ \\, |S_0^{(M)}(s,p)-1|, \\, |S_2^{(M)}(s,p)|, \\dots, |S_{2p}^{(M)}(s,p)| \\, \\big\\}\n$$\n可靠性的条件是该误差必须小于或等于预设的绝对容差 $\\tau$，即 $\\varepsilon_{\\max}(M;s,p) \\le \\tau$。所需的最小能级数 $N_{\\min}$ 定义为 $2M_{\\min}+1$，其中 $M_{\\min}$ 是满足此容差条件的最小非负整数 $M$。\n\n一个关键的物理约束，尤其与轻核相关，是核势阱的有限深度。这意味着只有有限数量的束缚单粒子能级。问题通过引入能量截断值 $E_{\\text{left}}$ 和 $E_{\\text{right}}$ 来模拟这一点，它们限制了费米能周围可用能级的范围。在 $E_F=0$ 的左侧和右侧可用的最大能级数分别为：\n$$\nM_{\\text{left}} = \\left\\lfloor \\frac{E_{\\text{left}}}{d} \\right\\rfloor, \\quad M_{\\text{right}} = \\left\\lfloor \\frac{E_{\\text{right}}}{d} \\right\\rfloor\n$$\n由于离散求和必须是对称的，求和指标 $M$ 的有效最大值受限于这两个计数中较小的一个。设 $M_{\\text{max}} = \\min(M_{\\text{left}}, M_{\\text{right}})$。因此，对 $M_{\\min}$ 的搜索被限制在整数范围 $0 \\le M \\le M_{\\text{max}}$ 内。如果在此范围内的任何 $M$ 都无法满足容差条件 $\\varepsilon_{\\max} \\le \\tau$，则表示未能形成可靠的平台，该情况下的结果报告为 $-1$。\n\n对于每个测试用例，算法解法如下：\n1.  读取输入参数：能级间距 $d$、平滑宽度 $\\gamma$、曲率修正阶数 $p$、容差 $\\tau$ 以及能量截断值 $E_{\\text{left}}$ 和 $E_{\\text{right}}$。\n2.  计算无量纲间距 $s = d/\\gamma$。\n3.  计算允许的最大求和指标 $M_{\\text{max}} = \\min(\\lfloor E_{\\text{left}}/d \\rfloor, \\lfloor E_{\\text{right}}/d \\rfloor)$。\n4.  初始化对最小合格指标 $M_{\\min}$ 的搜索。从 $M=0$ 开始迭代，直至并包含 $M_{\\text{max}}$。\n5.  对于每个 $M$ 值：\n    a.  计算离散偶数矩集合 $\\{ S_m^{(M)} \\}_{m=0,2,\\dots,2p}$。可以利用核函数 $f_p(x)=f_p(-x)$ 的对称性和幂次 $x_i^m$ 的形式来优化求和。对于偶数 $m > 0$，求和变为 $S_{m}^{(M)} = 2s \\sum_{i=1}^{M} (is)^m f_p(is)$；对于 $m=0$，$S_{0}^{(M)} = s(f_p(0) + 2\\sum_{i=1}^M f_p(is))$。函数 $f_p(x)$ 使用其定义进行评估，这需要计算广义拉盖尔多项式 $L_p^{1/2}(x^2)$。\n    b.  计算最大矩误差 $\\varepsilon_{\\max}(M;s,p)$。\n    c.  如果 $\\varepsilon_{\\max} \\le \\tau$，则当前值 $M$ 即为 $M_{\\min}$。计算 $N_{\\min} = 2M_{\\min}+1$，记录此结果，并终止对该测试用例的搜索。\n6.  如果循环完成而没有找到任何满足容差的 $M$，则记录结果为 $-1$。\n7.  处理完所有测试用例后，将收集到的结果格式化为指定的输出字符串。这个系统化的过程正确地实现了问题的所有要求。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import eval_genlaguerre\n\ndef solve():\n    \"\"\"\n    Computes the minimal number of levels for a reliable Strutinsky plateau\n    for a series of test cases, considering finite-spectrum constraints.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (d, gamma, p, tau, E_left, E_right)\n        (0.25, 1.2, 6, 5e-3, 20.0, 20.0),  # Happy path\n        (0.8, 1.2, 6, 5e-3, 4.0, 6.0),    # Edge-limited\n        (1.0, 0.6, 8, 1e-2, 6.0, 6.0),    # Coarse sampling\n        (0.3, 1.2, 10, 5e-3, 8.0, 8.0),   # High curvature-correction\n    ]\n\n    results = []\n    for case in test_cases:\n        result = calculate_n_min(*case)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef f_p(x, p):\n    \"\"\"\n    Calculates the Strutinsky smoothing kernel f_p(x).\n    f_p(x) = (1/sqrt(pi)) * exp(-x^2) * L_p^{1/2}(x^2)\n    \"\"\"\n    x_sq = x**2\n    laguerre_poly = eval_genlaguerre(p, 0.5, x_sq)\n    return (1.0 / np.sqrt(np.pi)) * np.exp(-x_sq) * laguerre_poly\n\ndef calculate_n_min(d, gamma, p, tau, e_left, e_right):\n    \"\"\"\n    Calculates N_min for a single test case.\n    Returns N_min or -1 on failure.\n    \"\"\"\n    s = d / gamma\n    m_left = np.floor(e_left / d)\n    m_right = np.floor(e_right / d)\n    m_max = int(min(m_left, m_right))\n\n    # Moments to check are m = 0, 2, 4, ..., 2p\n    moment_orders = list(range(0, 2 * p + 1, 2))\n\n    for M in range(m_max + 1):\n        errors = []\n\n        # Optimization by pre-calculating values for sum from i=1 to M\n        if M > 0:\n            i_vals = np.arange(1, M + 1)\n            x_vals = i_vals * s\n            f_vals = f_p(x_vals, p)\n        \n        # --- Calculate moment S_0 ---\n        f0 = f_p(0, p)\n        # S_0 = s * (f_p(0) + 2 * sum_{i=1 to M} f_p(i*s))\n        if M > 0:\n          sum_f = np.sum(f_vals)\n          s0 = s * (f0 + 2 * sum_f)\n        else: # M=0 case\n          s0 = s * f0\n        errors.append(abs(s0 - 1.0))\n\n        # --- Calculate moments S_m for m > 0 ---\n        for m in moment_orders[1:]:\n            # S_m = 2s * sum_{i=1 to M} (i*s)^m * f_p(i*s)\n            if M > 0:\n                sm = 2 * s * np.sum((x_vals**m) * f_vals)\n            else: # M=0 case\n                sm = 0.0\n            errors.append(abs(sm))\n\n        max_error = max(errors) if errors else 0.0\n\n        if max_error = tau:\n            return 2 * M + 1\n\n    # If loop finishes without finding a suitable M\n    return -1\n\nsolve()\n```"
        }
    ]
}