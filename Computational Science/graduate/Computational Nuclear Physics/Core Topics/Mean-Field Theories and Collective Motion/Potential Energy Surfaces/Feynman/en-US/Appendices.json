{
    "hands_on_practices": [
        {
            "introduction": "Potential energy surfaces are powerful theoretical tools, but their properties ultimately derive from the underlying nuclear forces. This first practice bridges the microscopic and macroscopic worlds by exploring how the surface tension, a key parameter in liquid-drop models of the PES, emerges from a more fundamental Energy Density Functional (EDF). By implementing and perturbing a simplified EDF, you will gain hands-on experience in deriving and quantifying how choices at the microscopic level directly influence the large-scale topology of the nuclear landscape .",
            "id": "3580504",
            "problem": "You are asked to implement a complete, runnable program that quantifies how perturbations in the gradient term of a nuclear Energy Density Functional (EDF) modify the topology of the potential energy surface (PES) for a uniform-density finite nucleus undergoing quadrupole-like deformations. The objective is to anchor the calculation to first principles and well-tested constructs in computational nuclear physics while deriving algorithmic steps from these foundations.\n\nThe fundamental base is the following. Consider an EDF whose local part is a Landau double-well free-energy density for uniform nuclear matter and whose nonlocal part is a gradient term. The three-dimensional energy functional is\n$$\n\\mathcal{E}[\\rho] \\;=\\; \\int d^3 r \\left[ \\frac{C_{\\nabla}}{2}\\,\\lvert \\nabla \\rho(\\mathbf{r}) \\rvert^2 \\;+\\; f(\\rho(\\mathbf{r})) \\right],\n$$\nwhere $C_{\\nabla}$ is the gradient coefficient and $f(\\rho)$ is the bulk free-energy density. We take the bulk term to be\n$$\nf(\\rho) \\;=\\; K\\,\\rho^2 \\left(1 - \\frac{\\rho}{\\rho_0}\\right)^2,\n$$\nwhere $K$ and $\\rho_0$ are constants with $K$ in $\\mathrm{MeV}\\,\\mathrm{fm}^3$ and $\\rho_0$ in $\\mathrm{fm}^{-3}$. This $f(\\rho)$ has two degenerate minima at $\\rho = 0$ (vacuum) and $\\rho = \\rho_0$ (saturated nuclear matter), representing coexistence at zero pressure.\n\nFrom the calculus of variations and mechanical equilibrium across a planar interface, the one-dimensional stationary profile $\\rho(x)$ connecting $\\rho=0$ and $\\rho=\\rho_0$ satisfies the Euler-Lagrange equation with appropriate boundary conditions, and admits a first integral that relates the gradient term to the bulk term. The nuclear surface tension $\\sigma$ is the excess energy per unit area of this interface, defined by the integral of the stationary interface energy density along the normal direction. Your program must obtain $\\sigma$ from this principle, not by assumption.\n\nTo connect the surface tension to finite-nucleus deformation energetics, use the leptodermous liquid-drop approximation. For a uniform-density droplet with fixed volume, the deformation energy is approximated by the surface contribution\n$$\nE_{\\text{def}}(s) \\;=\\; \\sigma\\, S(s),\n$$\nwhere $S(s)$ is the surface area of the deformed shape and $s$ is a dimensionless shape parameter. Constrain the shape to be an axisymmetric spheroid (ellipsoid of revolution) with axes $a = b$ (equatorial) and $c$ (polar), and impose volume conservation equal to that of a sphere of radius $R_0$, i.e., $V = \\frac{4\\pi}{3} R_0^3 = \\frac{4\\pi}{3} a^2 c$. Use the axis ratio $s = c/a$ as the deformation parameter and enforce $a^2 c = R_0^3$, i.e.,\n$$\na \\;=\\; R_0\\, s^{-1/3}, \\qquad c \\;=\\; R_0\\, s^{2/3}.\n$$\nThe spheroidal surface area $S(s)$ is to be computed using standard geometry. For $s > 1$ (prolate, $c > a$) define the eccentricity $e = \\sqrt{1 - \\frac{a^2}{c^2}}$ and use\n$$\nS_{\\text{pro}} \\;=\\; 2\\pi a^2 \\left(1 + \\frac{c}{a e} \\arcsin e \\right).\n$$\nFor $s < 1$ (oblate, $c < a$) define the eccentricity $e = \\sqrt{1 - \\frac{c^2}{a^2}}$ and use\n$$\nS_{\\text{obl}} \\;=\\; 2\\pi a^2 \\left(1 + \\frac{1 - e^2}{e} \\operatorname{artanh} e \\right).\n$$\nFor $s = 1$ (sphere), use\n$$\nS(1) \\;=\\; 4\\pi R_0^2.\n$$\n\nYou will study the dependence of the PES topology on the gradient term by perturbing $C_{\\nabla}$. Let the perturbed gradient coefficient be\n$$\nC_{\\nabla}^{(\\delta)} \\;=\\; C_{\\nabla}\\,(1 + \\delta),\n$$\nwith $\\delta$ a dimensionless perturbation that must satisfy $1+\\delta > 0$ to keep the interface well-defined. The bulk term $f(\\rho)$ and saturation density $\\rho_0$ are held fixed. You must relate changes in PES topology to changes in the effective surface tension $\\sigma$ and hence to deformation energy.\n\nYour program must, for each test case, perform the following tasks:\n\n- Compute the effective surface tension $\\sigma$ in $\\mathrm{MeV}/\\mathrm{fm}^2$ from the stationary planar interface implied by the above functional, expressed in terms of $C_{\\nabla}^{(\\delta)}$, $K$, and $\\rho_0$.\n- Compute the deformation energy differences $\\Delta E_{\\text{pro}} = E_{\\text{def}}(s_{\\text{pro}}) - E_{\\text{def}}(1)$ and $\\Delta E_{\\text{obl}} = E_{\\text{def}}(s_{\\text{obl}}) - E_{\\text{def}}(1)$ in $\\mathrm{MeV}$ at two probe deformations $s_{\\text{pro}} = 1.20$ and $s_{\\text{obl}} = 0.80$.\n- Compute the local quadratic curvature of the PES at $s = 1$ in $\\mathrm{MeV}$ via a central finite-difference second derivative:\n$$\n\\left.\\frac{d^2 E_{\\text{def}}}{d s^2}\\right|_{s=1} \\;\\approx\\; \\frac{E_{\\text{def}}(1+h) - 2\\,E_{\\text{def}}(1) + E_{\\text{def}}(1-h)}{h^2},\n$$\nwith step size $h = 10^{-3}$.\n\nAll energies must be reported in $\\mathrm{MeV}$, all lengths in $\\mathrm{fm}$, and surface tensions in $\\mathrm{MeV}/\\mathrm{fm}^2$. Angles, if any arise during computation, must be in radians.\n\nTest suite (each tuple lists $(C_{\\nabla}, \\delta, R_0, \\rho_0, K)$):\n\n- Case $1$ (happy path): $(60.0, 0.0, 6.7, 0.16, 400.0)$.\n- Case $2$ (increased gradient): $(60.0, 0.50, 6.7, 0.16, 400.0)$.\n- Case $3$ (near-vanishing gradient, edge case): $(60.0, -0.90, 6.7, 0.16, 400.0)$.\n- Case $4$ (different nucleus size): $(60.0, 0.20, 5.5, 0.16, 400.0)$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case contributes a four-element list $[\\sigma, \\Delta E_{\\text{pro}}, \\Delta E_{\\text{obl}}, \\text{curvature}]$. For example, it should look like $[[x_1,y_1,z_1,w_1],[x_2,y_2,z_2,w_2],\\dots]$ with no spaces.",
            "solution": "The problem requires the analysis of a potential energy surface (PES) for a finite nucleus, based on an Energy Density Functional (EDF). The task is to quantify how perturbations to the gradient term of the EDF affect the PES topology. This involves deriving the nuclear surface tension from first principles and then applying it within the leptodermous liquid-drop approximation for a spheroidal nucleus.\n\nThe provided energy functional is\n$$\n\\mathcal{E}[\\rho] = \\int d^3 r \\left[ \\frac{C_{\\nabla}^{(\\delta)}}{2}\\,\\lvert \\nabla \\rho(\\mathbf{r}) \\rvert^2 + f(\\rho(\\mathbf{r})) \\right]\n$$\nwhere the perturbed gradient coefficient is $C_{\\nabla}^{(\\delta)} = C_{\\nabla}(1+\\delta)$, and the bulk energy density is $f(\\rho) = K\\,\\rho^2 (1 - \\rho/\\rho_0)^2$. For dimensional consistency within the integrand, where the energy density must have units of $\\mathrm{MeV}\\,\\mathrm{fm}^{-3}$, and given that $\\rho$ is in $\\mathrm{fm}^{-3}$ and $K$ is in $\\mathrm{MeV}\\,\\mathrm{fm}^3$, the coefficient $C_{\\nabla}$ must have units of $\\mathrm{MeV}\\,\\mathrm{fm}^5$. All calculations will proceed under this necessary assumption. The constraint $1+\\delta > 0$ ensures $C_{\\nabla}^{(\\delta)} > 0$, a requirement for the stability of a uniform phase.\n\nThe core of the problem consists of two main theoretical steps: first, deriving the surface tension $\\sigma$ from the EDF, and second, using $\\sigma$ to construct the deformation energy of a finite nucleus.\n\n**1. Derivation of the Nuclear Surface Tension ($\\sigma$)**\n\nThe surface tension $\\sigma$ is defined as the excess energy per unit area of a stationary planar interface separating two coexisting phases. Here, the phases are the vacuum ($\\rho=0$) and saturated nuclear matter ($\\rho=\\rho_0$). For a one-dimensional profile $\\rho(x)$ along the direction normal to the interface, the energy per unit area is\n$$\n\\sigma = \\int_{-\\infty}^{\\infty} \\left[ \\frac{C_{\\nabla}^{(\\delta)}}{2} \\left(\\frac{d\\rho}{dx}\\right)^2 + f(\\rho(x)) \\right] dx\n$$\nThe stationary profile $\\rho(x)$ that minimizes this energy functional is determined by the Euler-Lagrange equation. Since the integrand, $L(\\rho, \\rho') = \\frac{C_{\\nabla}^{(\\delta)}}{2}(\\rho')^2 + f(\\rho)$, does not depend explicitly on the coordinate $x$, a first integral of motion exists (the Beltrami identity):\n$$\nL - \\rho' \\frac{\\partial L}{\\partial \\rho'} = \\text{constant}\n$$\nSubstituting the expression for $L$ yields:\n$$\n\\left(\\frac{C_{\\nabla}^{(\\delta)}}{2}(\\rho')^2 + f(\\rho)\\right) - \\rho' (C_{\\nabla}^{(\\delta)}\\rho') = -\\frac{C_{\\nabla}^{(\\delta)}}{2}(\\rho')^2 + f(\\rho) = \\text{constant}\n$$\nThe boundary conditions for the interface are $\\rho(x) \\to 0$ as $x \\to -\\infty$ and $\\rho(x) \\to \\rho_0$ as $x \\to +\\infty$. In both limits, the density is uniform, so its derivative $\\rho'$ is zero. Furthermore, the bulk term is constructed such that $f(0) = 0$ and $f(\\rho_0) = 0$. Therefore, the constant of integration must be zero. This gives the crucial equipartition relation for the stationary path:\n$$\nf(\\rho) = \\frac{C_{\\nabla}^{(\\delta)}}{2} \\left(\\frac{d\\rho}{dx}\\right)^2\n$$\nThis relation states that along the an energy-minimizing path, the potential energy density is equal to the gradient energy density. Using this, we can rewrite the integral for $\\sigma$:\n$$\n\\sigma = \\int_{-\\infty}^{\\infty} \\left[f(\\rho) + f(\\rho)\\right] dx = 2 \\int_{-\\infty}^{\\infty} f(\\rho(x)) dx\n$$\nAn alternative, more direct path to the solution is to rearrange the equipartition relation to find $dx = d\\rho / \\rho'$:\n$$\n\\frac{d\\rho}{dx} = \\sqrt{\\frac{2 f(\\rho)}{C_{\\nabla}^{(\\delta)}}} \\implies dx = \\sqrt{\\frac{C_{\\nabla}^{(\\delta)}}{2 f(\\rho)}} d\\rho\n$$\nWe can express $\\sigma$ as an integral over the density $\\rho$ from $0$ to $\\rho_0$.\n$$\n\\sigma = \\int_{-\\infty}^{\\infty} \\sqrt{2 C_{\\nabla}^{(\\delta)} f(\\rho)} \\left(\\frac{d\\rho}{dx}\\right) dx = \\int_{0}^{\\rho_0} \\sqrt{2 C_{\\nabla}^{(\\delta)} f(\\rho)} \\, d\\rho\n$$\nNow, we substitute the specific functional form for $f(\\rho)$:\n$$\nf(\\rho) = K\\,\\rho^2 \\left(1 - \\frac{\\rho}{\\rho_0}\\right)^2\n$$\nFor $\\rho \\in [0, \\rho_0]$, the term $(1 - \\rho/\\rho_0)$ is non-negative, so we can write:\n$$\n\\sqrt{f(\\rho)} = \\sqrt{K} \\, \\rho \\left(1 - \\frac{\\rho}{\\rho_0}\\right)\n$$\nThe integral for $\\sigma$ becomes:\n$$\n\\sigma = \\int_{0}^{\\rho_0} \\sqrt{2 C_{\\nabla}^{(\\delta)} K} \\left( \\rho - \\frac{\\rho^2}{\\rho_0} \\right) d\\rho\n$$\n$$\n\\sigma = \\sqrt{2 C_{\\nabla}^{(\\delta)} K} \\left[ \\frac{\\rho^2}{2} - \\frac{\\rho^3}{3\\rho_0} \\right]_{0}^{\\rho_0} = \\sqrt{2 C_{\\nabla}^{(\\delta)} K} \\left( \\frac{\\rho_0^2}{2} - \\frac{\\rho_0^2}{3} \\right)\n$$\nThis yields the final analytical expression for the surface tension:\n$$\n\\sigma = \\frac{\\rho_0^2}{6} \\sqrt{2 K C_{\\nabla}^{(\\delta)}} = \\frac{\\rho_0^2}{6} \\sqrt{2 K C_{\\nabla} (1+\\delta)}\n$$\n\n**2. Deformation Energy and Potential Energy Surface Analysis**\n\nThe problem uses the leptodermous liquid-drop approximation, where the deformation energy is solely dependent on the change in surface area, with the surface tension $\\sigma$ acting as the constant of proportionality:\n$$\nE_{\\text{def}}(s) = \\sigma S(s)\n$$\nHere, $s=c/a$ is the dimensionless axis ratio of an axisymmetric spheroid with volume conservation $a^2c = R_0^3$. The semi-axes are $a = R_0 s^{-1/3}$ and $c = R_0 s^{2/3}$. The surface area $S(s)$ is given by standard geometric formulas, which depend on whether the shape is prolate ($s>1$), oblate ($s<1$), or spherical ($s=1$).\n\nThe specific calculations required are:\n-   **Deformation energies**: $\\Delta E_{\\text{pro}} = E_{\\text{def}}(s_{\\text{pro}}) - E_{\\text{def}}(1)$ and $\\Delta E_{\\text{obl}} = E_{\\text{def}}(s_{\\text{obl}}) - E_{\\text{def}}(1)$ for $s_{\\text{pro}} = 1.20$ and $s_{\\text{obl}} = 0.80$. These are computed as $\\Delta E = \\sigma (S(s) - S(1))$, where $S(1) = 4\\pi R_0^2$.\n-   **PES curvature at $s=1$**: The local curvature is the second derivative of the deformation energy, evaluated at the spherical point $s=1$. It is calculated using a central finite-difference scheme:\n$$\nC = \\left.\\frac{d^2 E_{\\text{def}}}{d s^2}\\right|_{s=1} \\approx \\frac{E_{\\text{def}}(1+h) - 2E_{\\text{def}}(1) + E_{\\text{def}}(1-h)}{h^2}\n$$\nwith a small step size $h=10^{-3}$. This can be rewritten as:\n$$\nC \\approx \\sigma \\left[ \\frac{S(1+h) - 2S(1) + S(1-h)}{h^2} \\right]\n$$\nwhere $S(1+h)$ is calculated using the prolate formula and $S(1-h)$ using the oblate formula.\n\n**3. Algorithmic Procedure**\n\nFor each given test case tuple $(C_{\\nabla}, \\delta, R_0, \\rho_0, K)$, the algorithm proceeds as follows:\n1.  Compute the perturbed gradient coefficient $C_{\\nabla}^{(\\delta)} = C_{\\nabla}(1+\\delta)$.\n2.  Compute the surface tension $\\sigma$ using the derived formula $\\sigma = \\frac{\\rho_0^2}{6} \\sqrt{2 K C_{\\nabla}^{(\\delta)}}$.\n3.  Implement a function `spheroid_surface_area(s, R0)` that correctly computes the surface area using the provided formulae for prolate ($s>1$), oblate ($s<1$), and spherical ($s=1$) shapes.\n4.  Calculate the required surface areas: $S(1.20)$, $S(0.80)$, and $S(1) = 4\\pi R_0^2$.\n5.  Compute the deformation energy differences: $\\Delta E_{\\text{pro}} = \\sigma (S(1.20) - S(1))$ and $\\Delta E_{\\text{obl}} = \\sigma (S(0.80) - S(1))$.\n6.  For the curvature calculation, compute $S(1+h)$ and $S(1-h)$ with $h=10^{-3}$, and then apply the finite-difference formula to find $C$.\n7.  Collect the four computed values $[\\sigma, \\Delta E_{\\text{pro}}, \\Delta E_{\\text{obl}}, C]$ for the current test case.\n8.  Repeat for all test cases and format the final output as a list of lists.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the nuclear physics problem by calculating surface tension, deformation\n    energies, and PES curvature for a set of test cases.\n    \"\"\"\n\n    test_cases = [\n        # (C_nabla, delta, R0, rho0, K)\n        (60.0, 0.0, 6.7, 0.16, 400.0),\n        (60.0, 0.50, 6.7, 0.16, 400.0),\n        (60.0, -0.90, 6.7, 0.16, 400.0),\n        (60.0, 0.20, 5.5, 0.16, 400.0),\n    ]\n\n    s_pro = 1.20\n    s_obl = 0.80\n    h = 1e-3\n\n    def spheroid_surface_area(s, R0):\n        \"\"\"\n        Calculates the surface area of an axisymmetric spheroid with volume conservation.\n        s: axis ratio c/a\n        R0: radius of the equivalent sphere\n        \"\"\"\n        if s == 1.0:\n            return 4.0 * np.pi * R0**2\n        \n        a = R0 * s**(-1/3)\n        c = R0 * s**(2/3)\n        \n        if s > 1.0:  # Prolate\n            e = np.sqrt(1.0 - (a**2 / c**2))\n            return 2.0 * np.pi * a**2 * (1.0 + (c / (a * e)) * np.arcsin(e))\n        else:  # Oblate (s < 1.0)\n            e = np.sqrt(1.0 - (c**2 / a**2))\n            # Note on formula: (1 - e^2) = s^2 for oblate spheroids\n            return 2.0 * np.pi * a**2 * (1.0 + ((1-e**2) / e) * np.arctanh(e))\n\n    results = []\n    for C_nabla, delta, R0, rho0, K in test_cases:\n        # Validate perturbation parameter\n        if 1.0 + delta <= 0:\n            raise ValueError(\"Invalid perturbation: 1+delta must be positive.\")\n\n        # 1. Compute surface tension sigma\n        C_nabla_delta = C_nabla * (1.0 + delta)\n        sigma = (rho0**2 / 6.0) * np.sqrt(2.0 * K * C_nabla_delta)\n\n        # 2. Compute deformation energy differences\n        S_sphere = spheroid_surface_area(1.0, R0)\n        S_pro = spheroid_surface_area(s_pro, R0)\n        S_obl = spheroid_surface_area(s_obl, R0)\n        \n        delta_E_pro = sigma * (S_pro - S_sphere)\n        delta_E_obl = sigma * (S_obl - S_sphere)\n\n        # 3. Compute PES curvature at s=1\n        S_plus_h = spheroid_surface_area(1.0 + h, R0)\n        S_minus_h = spheroid_surface_area(1.0 - h, R0)\n        \n        S_double_prime = (S_plus_h - 2.0 * S_sphere + S_minus_h) / h**2\n        curvature = sigma * S_double_prime\n        \n        # Store results for this case\n        case_results = [sigma, delta_E_pro, delta_E_obl, curvature]\n        results.append(case_results)\n\n    # Format the final output string\n    str_results = []\n    for res in results:\n        str_results.append(f\"[{','.join(map(str, res))}]\")\n    \n    final_output = f\"[{','.join(str_results)}]\"\n    print(final_output)\n\nsolve()\n```"
        },
        {
            "introduction": "Building on the fundamental connection between energy functionals and surface properties, this exercise focuses on the practical construction of a PES for a specific physical system: an odd-mass nucleus. You will learn how the presence of an unpaired nucleon introduces effects like blocking and quasiparticle alignment, which can dramatically alter the shape and stability of a nucleus. By adding these terms to a baseline even-even potential, you will numerically generate and analyze the PES to quantify how the odd particle influences the nuclear structure in the $(\\beta, \\gamma)$ deformation plane .",
            "id": "3580482",
            "problem": "You are asked to construct and analyze a simplified, yet physically motivated, model of a potential energy surface for an odd-mass nucleus in the collective quadrupole deformation plane parameterized by the magnitude of deformation $ \\beta $ and the triaxiality angle $ \\gamma $. Your program must implement a total energy functional $ E(\\beta,\\gamma) $ composed of a collective even-even baseline, an odd-mass blocking penalty, and a quasiparticle alignment (cranking) contribution, all specified below. The total energy must be evaluated on a fixed grid in the $(\\beta,\\gamma)$ plane, and specific quantitative characteristics of the surface must be extracted.\n\nDefinitions and model specification:\n- The collective even-even baseline energy is a Landau-type expansion in the quadrupole invariants,\n  $$ E_{\\mathrm{coll}}(\\beta,\\gamma) = A\\,\\beta^{2} + B\\,\\beta^{3}\\cos(3\\gamma) + C\\,\\beta^{4} + D\\,\\beta^{6}, $$\n  where $ A $, $ B $, $ C $, and $ D $ are real parameters with $ A>0 $, $ C>0 $, and $ D\\ge 0 $ to ensure stability at large $ \\beta $. The dependence on $ \\gamma $ appears through the standard invariant $ \\cos(3\\gamma) $.\n- The odd-mass blocking penalty is modeled as an isotropic increase in energy due to reduced pairing correlations,\n  $$ \\delta E_{\\mathrm{block}}(\\beta) = P_{0} + P_{2}\\,\\beta^{2}, $$\n  where $ P_{0}\\ge 0 $ and $ P_{2}\\ge 0 $.\n- The quasiparticle alignment (cranking) contribution is modeled at leading order in $ \\beta $ as\n  $$ E_{\\mathrm{align}}(\\beta,\\gamma) = -K\\,\\beta\\,\\cos\\!\\big(3(\\gamma-\\gamma_{0})\\big), $$\n  where $ K\\ge 0 $ sets the alignment strength and $ \\gamma_{0}\\in[0,\\pi/3] $ is a phase that selects the principal axis of alignment in the $(\\beta,\\gamma)$ plane.\n\nThe total energy is\n$$ E(\\beta,\\gamma) = E_{\\mathrm{coll}}(\\beta,\\gamma) + \\delta E_{\\mathrm{block}}(\\beta) + E_{\\mathrm{align}}(\\beta,\\gamma), $$\nto be treated as an energy in megaelectron volts (MeV). The shape variables satisfy $ \\beta\\in[0,\\beta_{\\max}] $ and $ \\gamma\\in[0,\\pi/3] $. All internal computations must use $ \\gamma $ in radians. Any angle reported in the final answer must be expressed in degrees.\n\nGrid, units, and numerical tasks:\n- Use a uniform tensor-product grid with $ N_{\\beta} = 601 $ points for $ \\beta $, linearly spaced on $ [0,\\beta_{\\max}] $ with $ \\beta_{\\max} = 0.6 $, and $ N_{\\gamma} = 361 $ points for $ \\gamma $, linearly spaced on $ [0,\\pi/3] $. Angles are in radians on the grid.\n- For each parameter set in the test suite, compute:\n  $1.$ The global minimum energy $ E_{\\min} $ in MeV over the entire grid and the corresponding angle $ \\gamma_{\\min} $ at that minimum, reported in degrees.\n  $2.$ The axial prolate barrier height $ B_{\\mathrm{prol}} $ in MeV defined as follows: restrict to the prolate axis $ \\gamma=0 $, form the one-dimensional function $ E_{\\mathrm{prol}}(\\beta)=E(\\beta,0) $, identify the index $ i^{\\star} $ at which $ E_{\\mathrm{prol}}(\\beta) $ attains its minimum on the grid, and define the barrier as\n  $$ B_{\\mathrm{prol}} = \\max_{0\\le i\\le i^{\\star}} E_{\\mathrm{prol}}(\\beta_{i}) \\;-\\; E_{\\mathrm{prol}}(\\beta_{i^{\\star}}). $$\n  If $ i^{\\star}=0 $, take $ B_{\\mathrm{prol}} = 0 $.\n  $3.$ The triaxial anisotropy amplitude $ \\mathcal{A} $ in MeV at the prolate-axis minimum deformation $ \\beta_{i^{\\star}} $, defined by\n  $$ \\mathcal{A} = \\max_{\\gamma} E(\\beta_{i^{\\star}},\\gamma) \\;-\\; \\min_{\\gamma} E(\\beta_{i^{\\star}},\\gamma). $$\n\nTest suite:\nImplement the model and compute the requested quantities for the following three parameter sets. All energies are in MeV, and angles for $ \\gamma_{0} $ are in radians.\n- Case $1$ (even-even baseline, no blocking, no alignment): $ A=5.0 $, $ B=-12.0 $, $ C=20.0 $, $ D=50.0 $, $ P_{0}=0.0 $, $ P_{2}=0.0 $, $ K=0.0 $, $ \\gamma_{0}=0.0 $.\n- Case $2$ (blocking only): $ A=5.0 $, $ B=-12.0 $, $ C=20.0 $, $ D=50.0 $, $ P_{0}=0.8 $, $ P_{2}=2.5 $, $ K=0.0 $, $ \\gamma_{0}=0.0 $.\n- Case $3$ (blocking with alignment): $ A=5.0 $, $ B=-12.0 $, $ C=20.0 $, $ D=50.0 $, $ P_{0}=0.8 $, $ P_{2}=2.5 $, $ K=2.0 $, $ \\gamma_{0}=0.17453292519943 $.\n\nFinal output specification:\n- Your program must produce a single line of output containing the results for the three test cases as a list of lists:\n  For each case, output the list $[E_{\\min}, \\gamma_{\\min}^{(\\mathrm{deg})}, B_{\\mathrm{prol}}, \\mathcal{A}]$, where $ E_{\\min} $, $ B_{\\mathrm{prol}} $, and $ \\mathcal{A} $ are floats in MeV, and $ \\gamma_{\\min}^{(\\mathrm{deg})} $ is the angle in degrees. All four numbers for each case must be rounded to $6$ decimal places.\n- The final output line must therefore look like\n  $$ \\big[ [x_{1},y_{1},z_{1},w_{1}], [x_{2},y_{2},z_{2},w_{2}], [x_{3},y_{3},z_{3},w_{3}] \\big], $$\n  where each $ x_{k} $, $ y_{k} $, $ z_{k} $, $ w_{k} $ is a decimal representation with $6$ places after the decimal point and no units in the text string. Angles are in degrees as decimals, and energies are in MeV as decimals.",
            "solution": "The user has provided a valid, well-posed problem in computational nuclear physics. I will proceed with a full solution.\n\nThe problem requires the construction and analysis of a potential energy surface (PES), denoted $E(\\beta, \\gamma)$, for an odd-mass nucleus. The surface is defined in the plane of two collective quadrupole deformation coordinates: the magnitude of deformation, $\\beta$, and the triaxiality angle, $\\gamma$. The total energy functional is a sum of three components: a collective potential for the even-even core, $E_{\\mathrm{coll}}(\\beta, \\gamma)$; a blocking penalty for the odd nucleon, $\\delta E_{\\mathrm{block}}(\\beta)$; and a quasiparticle alignment contribution, $E_{\\mathrm{align}}(\\beta, \\gamma)$.\n\nThe total energy is given by:\n$$ E(\\beta,\\gamma) = E_{\\mathrm{coll}}(\\beta,\\gamma) + \\delta E_{\\mathrm{block}}(\\beta) + E_{\\mathrm{align}}(\\beta,\\gamma) $$\nThe components are specified as:\n\\begin{align*}\nE_{\\mathrm{coll}}(\\beta,\\gamma) &= A\\,\\beta^{2} + B\\,\\beta^{3}\\cos(3\\gamma) + C\\,\\beta^{4} + D\\,\\beta^{6} \\\\\n\\delta E_{\\mathrm{block}}(\\beta) &= P_{0} + P_{2}\\,\\beta^{2} \\\\\nE_{\\mathrm{align}}(\\beta,\\gamma) &= -K\\,\\beta\\,\\cos\\!\\big(3(\\gamma-\\gamma_{0})\\big)\n\\end{align*}\nBy combining these terms, the full energy functional can be written as:\n$$ E(\\beta,\\gamma) = P_{0} -K\\,\\beta\\,\\cos\\!\\big(3(\\gamma-\\gamma_{0})\\big) + (A + P_{2})\\,\\beta^{2} + B\\,\\beta^{3}\\cos(3\\gamma) + C\\,\\beta^{4} + D\\,\\beta^{6} $$\n\nThe solution methodology involves the following steps:\n1.  **Grid Discretization**: The continuous domain $(\\beta, \\gamma) \\in [0, 0.6] \\times [0, \\pi/3]$ is discretized into a uniform tensor-product grid. We define a vector of $\\beta$ values, $\\boldsymbol{\\beta} = \\{\\beta_i\\}$, with $i=0, \\dots, N_{\\beta}-1$, and a vector of $\\gamma$ values, $\\boldsymbol{\\gamma} = \\{\\gamma_j\\}$, with $j=0, \\dots, N_{\\gamma}-1$. The problem specifies $N_{\\beta} = 601$ and $N_{\\gamma} = 361$.\n2.  **Energy Surface Computation**: The total energy $E(\\beta_i, \\gamma_j)$ is computed for each point $(i,j)$ on the grid. This is efficiently accomplished using vectorized numerical libraries by creating 2D meshgrid arrays for $\\beta$ and $\\gamma$, which we denote as $\\mathbf{B}$ and $\\mathbf{\\Gamma}$. The energy $E(\\mathbf{B}, \\mathbf{\\Gamma})$ is then computed element-wise, resulting in a 2D array, $\\mathbf{E}$, where $\\mathbf{E}_{ij} = E(\\beta_i, \\gamma_j)$.\n3.  **Extraction of Observables**: Once the discrete energy surface $\\mathbf{E}$ is computed for a given set of parameters, the requested physical quantities are extracted.\n\n    -   **Global Minimum ($E_{\\min}$, $\\gamma_{\\min}$)**: The global minimum energy, $E_{\\min}$, is found by taking the minimum value in the entire 2D array $\\mathbf{E}$. The indices $(i_{\\min}, j_{\\min})$ of this minimum element are located. The corresponding triaxiality angle is $\\gamma_{\\min} = \\gamma_{j_{\\min}}$, which is then converted from radians to degrees for reporting.\n\n    -   **Prolate Barrier Height ($B_{\\mathrm{prol}}$)**: This quantity is defined along the prolate axis, where $\\gamma=0$. We first extract the 1D energy profile $E_{\\mathrm{prol}}(\\beta_i) = E(\\beta_i, 0)$, which corresponds to the first column of the matrix $\\mathbf{E}$. We then find the index $i^{\\star}$ at which this 1D profile has its minimum, $E_{\\mathrm{prol}}(\\beta_{i^{\\star}})$. The barrier height is the difference between the maximum energy encountered on the path from $\\beta=0$ to $\\beta=\\beta_{i^{\\star}}$ and the minimum energy at $\\beta_{i^{\\star}}$.\n        $$ B_{\\mathrm{prol}} = \\left( \\max_{0 \\le i \\le i^{\\star}} E_{\\mathrm{prol}}(\\beta_i) \\right) - E_{\\mathrm{prol}}(\\beta_{i^{\\star}}) $$\n        A special condition states that if the minimum occurs at $\\beta=0$ (i.e., $i^{\\star}=0$), the barrier is zero.\n\n    -   **Triaxial Anisotropy ($\\mathcal{A}$)**: This quantity measures the energy variation in the $\\gamma$ direction at a specific deformation. The deformation is chosen to be $\\beta_{i^{\\star}}$, the deformation of the prolate minimum found in the previous step. We extract the 1D energy profile $E(\\beta_{i^{\\star}}, \\gamma_j)$ for all $\\gamma_j$ on the grid. This corresponds to the row of matrix $\\mathbf{E}$ at index $i^{\\star}$. The anisotropy $\\mathcal{A}$ is the difference between the maximum and minimum values in this 1D slice.\n        $$ \\mathcal{A} = \\max_j E(\\beta_{i^{\\star}}, \\gamma_j) - \\min_j E(\\beta_{i^{\\star}}, \\gamma_j) $$\n\nThe procedure is implemented in a program that iterates through the three specified parameter-sets, calculating and storing these four observables for each case. The final output is then formatted as a list of lists, with all numerical values rounded to six decimal places as required.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_pes_observables(params, beta_grid, gamma_grid):\n    \"\"\"\n    Computes observables from the potential energy surface for a single parameter set.\n    \"\"\"\n    A, B, C, D, P0, P2, K, g0 = params\n    \n    # Create 2D meshgrid for vectorized computation.\n    # BETA[i, j] = beta_grid[i], GAMMA[i, j] = gamma_grid[j]\n    BETA, GAMMA = np.meshgrid(beta_grid, gamma_grid, indexing='ij')\n\n    # Calculate the three energy components\n    E_coll = (A * BETA**2 \n              + B * BETA**3 * np.cos(3 * GAMMA) \n              + C * BETA**4\n              + D * BETA**6)\n    \n    delta_E_block = P0 + P2 * BETA**2\n    \n    E_align = -K * BETA * np.cos(3 * (GAMMA - g0))\n    \n    # Total energy surface\n    E_surface = E_coll + delta_E_block + E_align\n\n    # 1. Find global minimum energy and corresponding gamma\n    E_min = np.min(E_surface)\n    min_idx_flat = np.argmin(E_surface)\n    i_min, j_min = np.unravel_index(min_idx_flat, E_surface.shape)\n    gamma_min_rad = gamma_grid[j_min]\n    gamma_min_deg = np.rad2deg(gamma_min_rad)\n\n    # 2. Calculate prolate barrier height B_prol\n    # E_prol is the slice at gamma = 0, which is the first column of E_surface\n    E_prol = E_surface[:, 0]\n    i_star = np.argmin(E_prol)\n    \n    B_prol = 0.0\n    if i_star > 0:\n        E_prol_min = E_prol[i_star]\n        # Barrier is max energy on the path from beta=0 to beta=beta_i_star\n        E_max_on_path = np.max(E_prol[:i_star + 1])\n        B_prol = E_max_on_path - E_prol_min\n\n    # 3. Calculate triaxial anisotropy amplitude A at beta_i_star\n    # E_at_beta_istar is the slice at beta = beta_i_star, which is a row of E_surface\n    E_at_beta_istar = E_surface[i_star, :]\n    A_anisotropy = np.max(E_at_beta_istar) - np.min(E_at_beta_istar)\n\n    return E_min, gamma_min_deg, B_prol, A_anisotropy\n\ndef solve():\n    \"\"\"\n    Main function to drive the computation for all test cases and print the final result.\n    \"\"\"\n    # Define the grid\n    beta_max = 0.6\n    N_beta = 601\n    N_gamma = 361\n    beta_grid = np.linspace(0, beta_max, N_beta)\n    gamma_grid = np.linspace(0, np.pi / 3, N_gamma)\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (even-even baseline)\n        (5.0, -12.0, 20.0, 50.0, 0.0, 0.0, 0.0, 0.0),\n        # Case 2 (blocking only)\n        (5.0, -12.0, 20.0, 50.0, 0.8, 2.5, 0.0, 0.0),\n        # Case 3 (blocking with alignment)\n        (5.0, -12.0, 20.0, 50.0, 0.8, 2.5, 2.0, 0.17453292519943),\n    ]\n\n    all_results = []\n    for params in test_cases:\n        result_tuple = compute_pes_observables(params, beta_grid, gamma_grid)\n        all_results.append(list(result_tuple))\n\n    # Format the final output string as a list of lists with 6 decimal places.\n    formatted_cases = []\n    for case_results in all_results:\n        # Format each number in the list to a string with 6 decimal places\n        formatted_nums = [f\"{num:.6f}\" for num in case_results]\n        # Create the string representation of the inner list\n        formatted_cases.append(f\"[{','.join(formatted_nums)}]\")\n    \n    # Create the final string representation of the list of lists\n    final_output_string = f\"[{','.join(formatted_cases)}]\"\n\n    # Final print statement in the exact required format.\n    print(final_output_string)\n\nsolve()\n```"
        },
        {
            "introduction": "A potential energy surface provides the landscape for nuclear dynamics, but to model processes like spontaneous fission, we must also consider the inertia of the collective motion. This concluding practice delves into the quantum mechanical phenomenon of tunneling through a multi-dimensional potential barrier. You will derive the semiclassical Wentzel–Kramers–Brillouin (WKB) action, which depends on both the PES $E(\\mathbf{q})$ and the collective inertia tensor $B_{ij}(\\mathbf{q})$, and implement a numerical calculation to quantify the tunneling action, providing a direct link between the static PES and the dynamic lifetimes of nuclear states .",
            "id": "3580448",
            "problem": "Consider a collective Hamiltonian for large-amplitude nuclear motion on a potential energy surface (PES), where the collective coordinates are the axially symmetric mass quadrupole and octupole deformations $\\mathbf{q} \\equiv (q_{20}, q_{30})$, and the inertia is characterized by the symmetric, positive-definite collective inertia tensor $B_{ij}(\\mathbf{q})$. In the semiclassical tunneling regime, the probability amplitude across a barrier is governed by an action integral. Starting from the semiclassical Wentzel–Kramers–Brillouin (WKB) approximation and the Euclidean (imaginary-time) path integral formulation, derive how the tunneling action accumulated along a parameterized path $\\mathbf{q}(s)$ through the classically forbidden region depends on the PES $E(\\mathbf{q})$, the collective inertia tensor $B_{ij}(\\mathbf{q})$, and the path derivatives $\\mathrm{d}\\mathbf{q}/\\mathrm{d}s$. Clearly state the assumptions required for the derivation to be valid in this context.\n\nThen, implement a program to numerically compute the WKB action along piecewise-linear paths and validate the result against an instanton (saddle-point of the Euclidean action) calculation for a separable quadratic barrier PES. Specifically, consider the two-dimensional PES\n$$\nE(\\mathbf{q}) = V_b - \\frac{1}{2} k_b \\, q_{20}^2 + \\frac{1}{2} k_t \\, q_{30}^2,\n$$\nwith constant, diagonal collective inertia tensor\n$$\nB_{ij}(\\mathbf{q}) = \\begin{pmatrix} B_{20} & 0 \\\\ 0 & B_{30} \\end{pmatrix},\n$$\nand a reference energy $E_0$ below the barrier top $V_b$. Energies $V_b$, $E_0$, and stiffnesses $k_b$, $k_t$ must be treated in megaelectron-volts (MeV), the collective coordinates $(q_{20}, q_{30})$ are dimensionless deformations, and the inertia components are in $\\mathrm{MeV}^{-1}$. The tunneling action is dimensionless.\n\nYour program must:\n- Numerically evaluate the WKB action along a given piecewise-linear path $\\mathbf{q}(s)$ using Gaussian quadrature, where the integrand depends on the local barrier height $E(\\mathbf{q}) - E_0$ and the quadratic form induced by $B_{ij}(\\mathbf{q})$ on $\\mathrm{d}\\mathbf{q}$. The path should be restricted to the classically forbidden region, with endpoints at the classical turning points defined by solving $E(\\mathbf{q}) = E_0$ along the specified path.\n- Analytically evaluate the instanton action for the separable quadratic barrier under the same assumptions, and use it as a validation reference where applicable.\n- Report quantitative comparisons for the following test suite.\n\nTest suite (energies in MeV, inertia in $\\mathrm{MeV}^{-1}$, deformations dimensionless):\n1. General case (straight minimal path along $q_{30}=0$):\n   - $V_b = 6$, $E_0 = 1$, $k_b = 4$, $k_t = 3$, $B_{20} = 10$, $B_{30} = 10$.\n   - Path: $\\mathbf{q}(s)$ is a straight line along $q_{30}=0$ from the inner to outer turning points determined by $E(q_{20},0) = E_0$.\n   - Output the WKB action for this path and the absolute difference to the analytic instanton action.\n2. Anisotropic inertia (straight minimal path along $q_{30}=0$):\n   - $V_b = 6$, $E_0 = 2$, $k_b = 5$, $k_t = 3$, $B_{20} = 4$, $B_{30} = 16$.\n   - Path: $\\mathbf{q}(s)$ along $q_{30}=0$ between turning points given by $E(q_{20},0) = E_0$.\n   - Output the WKB action and the absolute difference to the analytic instanton action.\n3. Curved path penalty (non-minimal straight line with slope in $(q_{20}, q_{30})$ plane):\n   - $V_b = 6$, $E_0 = 1$, $k_b = 4$, $k_t = 8$, $B_{20} = 10$, $B_{30} = 10$.\n   - Path: straight line with $q_{30} = \\beta \\, q_{20}$ for $\\beta = 0.5$, between turning points satisfying $E(q_{20}, \\beta q_{20}) = E_0$.\n   - Output a boolean indicating whether the WKB action along this curved path exceeds the analytic instanton action for the straight path along $q_{30}=0$ under the same $(V_b, E_0, k_b, B_{20})$.\n4. Near-barrier limit (straight minimal path along $q_{30}=0$ with $E_0$ very close to $V_b$):\n   - $V_b = 10$, $E_0 = 9.999$, $k_b = 6$, $k_t = 3$, $B_{20} = 7$, $B_{30} = 7$.\n   - Path: along $q_{30}=0$ between turning points given by $E(q_{20},0) = E_0$.\n   - Output the absolute difference between the WKB action and the analytic instanton action.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3,...]\"). The list entries must be, in order:\n- Test 1 WKB action as a float,\n- Test 1 absolute difference to analytic instanton as a float,\n- Test 2 WKB action as a float,\n- Test 2 absolute difference to analytic instanton as a float,\n- Test 3 comparison boolean,\n- Test 4 absolute difference to analytic instanton as a float.\n\nAll numerical answers must be dimensionless and reported as raw decimal numbers (no percentage signs).",
            "solution": "The problem requires the derivation of the semiclassical Wentzel–Kramers–Brillouin (WKB) action for a particle tunneling through a multi-dimensional potential barrier, described by a collective Hamiltonian. Following the derivation, a numerical implementation must be developed to compute this action for specific paths and parameters, and the results validated against an analytical solution for an instanton path.\n\n### 1. Derivation of the Semiclassical Tunneling Action\n\nThe starting point is the classical Lagrangian for a system described by collective coordinates $\\mathbf{q} \\equiv (q_i)$ with a coordinate-dependent inertia tensor $B_{ij}(\\mathbf{q})$ and a potential energy surface (PES) $E(\\mathbf{q})$.\n$$ L(\\mathbf{q}, \\dot{\\mathbf{q}}) = T - V = \\frac{1}{2} \\sum_{i,j} B_{ij}(\\mathbf{q}) \\dot{q}_i \\dot{q}_j - E(\\mathbf{q}) $$\nwhere $\\dot{q}_i = \\mathrm{d}q_i/\\mathrm{d}t$.\n\nTunneling is a classically forbidden process. The semiclassical description is formulated in Euclidean spacetime by performing a Wick rotation to imaginary time, $\\tau = it$. Consequently, the time derivative becomes $\\mathrm{d}/\\mathrm{d}t = i\\,\\mathrm{d}/\\mathrm{d}\\tau$, and hence $\\dot{q}_i = i\\,\\mathrm{d}q_i/\\mathrm{d}\\tau$. The kinetic energy term transforms as:\n$$ T = \\frac{1}{2} \\sum_{i,j} B_{ij} (i\\,\\frac{\\mathrm{d}q_i}{\\mathrm{d}\\tau})(i\\,\\frac{\\mathrm{d}q_j}{\\mathrm{d}\\tau}) = -\\frac{1}{2} \\sum_{i,j} B_{ij} \\frac{\\mathrm{d}q_i}{\\mathrm{d}\\tau} \\frac{\\mathrm{d}q_j}{\\mathrm{d}\\tau} \\equiv -T_E $$\nThe action integral $\\int L\\,\\mathrm{d}t$ becomes $iS_E$, where $S_E$ is the Euclidean action:\n$$ S_E = \\int L_E \\,\\mathrm{d}\\tau = \\int \\left( T_E + E(\\mathbf{q}) \\right) \\mathrm{d}\\tau $$\nThe system is assumed to tunnel at a constant energy $E_0$. The corresponding Euclidean equations of motion describe a classical particle moving in an inverted potential $V_{inverted} = -E(\\mathbf{q})$ with a conserved total energy of $-E_0$. The conservation of energy in the Euclidean formalism is expressed as:\n$$ H_E = T_E - E(\\mathbf{q}) = -E_0 $$\nThis leads to the fundamental relation valid along the classical trajectory in the forbidden region:\n$$ T_E = \\frac{1}{2} \\sum_{i,j} B_{ij}(\\mathbf{q}) \\frac{\\mathrm{d}q_i}{\\mathrm{d}\\tau} \\frac{\\mathrm{d}q_j}{\\mathrm{d}\\tau} = E(\\mathbf{q}) - E_0 $$\nThis equation is meaningful only in the classically forbidden region where $E(\\mathbf{q}) > E_0$.\n\nThe WKB tunneling action, which appears in the exponent of the tunneling probability $P \\propto e^{-2S/\\hbar}$, is identified with the Euclidean action $S_E$ (with $\\hbar = 1$ for a dimensionless action). We can express $S_E$ in a form that is independent of the time parametrization. Using $T_E = E(\\mathbf{q}) - E_0$ along the path, we can write $S_E = \\int (T_E + E(\\mathbf{q}))\\,\\mathrm{d}\\tau = \\int (E(\\mathbf{q}) - E_0 + E(\\mathbf{q}))\\,\\mathrm{d}\\tau$ which is not the most direct route. Instead, leveraging Maupertuis's principle in the Euclidean space, the action is given by the integral of the Euclidean momentum along the path, $S_E = \\int \\mathbf{p}_E \\cdot \\mathrm{d}\\mathbf{q}$. A more convenient form is obtained by re-parameterizing the path $\\mathbf{q}$ with an arbitrary parameter $s$, such that $\\mathbf{q} = \\mathbf{q}(s)$.\nThe energy conservation equation gives:\n$$ \\frac{1}{2} \\left(\\frac{\\mathrm{d}s}{\\mathrm{d}\\tau}\\right)^2 \\sum_{i,j} B_{ij} \\frac{\\mathrm{d}q_i}{\\mathrm{d}s} \\frac{\\mathrm{d}q_j}{\\mathrm{d}s} = E(\\mathbf{q}(s)) - E_0 $$\nSolving for $\\mathrm{d}\\tau$:\n$$ \\mathrm{d}\\tau = \\mathrm{d}s / \\frac{\\mathrm{d}s}{\\mathrm{d}\\tau} = \\sqrt{\\frac{\\frac{1}{2} \\sum_{i,j} B_{ij} \\frac{\\mathrm{d}q_i}{\\mathrm{d}s} \\frac{\\mathrm{d}q_j}{\\mathrm{d}s}}{E(\\mathbf{q}(s)) - E_0}} \\,\\mathrm{d}s $$\nThe action can be expressed as $S = \\int 2T_E \\,\\mathrm{d}\\tau$. Substituting the expressions for $T_E$ and $\\mathrm{d}\\tau$:\n$$ S[\\mathbf{q}(s)] = \\int_{s_{start}}^{s_{end}} 2 \\left( E(\\mathbf{q}(s)) - E_0 \\right) \\sqrt{\\frac{\\frac{1}{2} \\sum_{i,j} B_{ij} \\frac{\\mathrm{d}q_i}{\\mathrm{d}s} \\frac{\\mathrm{d}q_j}{\\mathrm{d}s}}{E(\\mathbf{q}(s)) - E_0}} \\,\\mathrm{d}s $$\n$$ S[\\mathbf{q}(s)] = \\int_{s_{start}}^{s_{end}} \\sqrt{2 \\left(E(\\mathbf{q}(s)) - E_0\\right) \\left(\\sum_{i,j} B_{ij}(\\mathbf{q}(s)) \\frac{\\mathrm{d}q_i}{\\mathrm{d}s} \\frac{\\mathrm{d}q_j}{\\mathrm{d}s}\\right)} \\,\\mathrm{d}s $$\nThis is the final expression for the WKB tunneling action along an arbitrary parameterized path $\\mathbf{q}(s)$ from a starting point $s_{start}$ to an ending point $s_{end}$, typically the classical turning points where $E(\\mathbf{q}) = E_0$.\n\nThe key assumptions for this derivation are:\n1.  **Semiclassical Approximation**: The potential $E(\\mathbf{q})$ is slowly varying compared to the local de Broglie wavelength of the collective motion.\n2.  **Adiabatic Motion**: The collective degrees of freedom $\\mathbf{q}$ are assumed to be decoupled from intrinsic nucleonic excitations (no dissipation).\n3.  **Validity of the Collective Model**: The nuclear dynamics are well-described by a small number of collective coordinates.\n4.  **Imaginary Time Formalism**: The tunneling amplitude is dominated by a single classical path (the instanton) in imaginary time.\n\n### 2. Analytical Instanton Action for a Separable Quadratic Barrier\n\nThe instanton is the path that minimizes the action functional $S[\\mathbf{q}(s)]$. For the given PES $E(\\mathbf{q}) = V_b - \\frac{1}{2} k_b q_{20}^2 + \\frac{1}{2} k_t q_{30}^2$ and diagonal inertia tensor $B_{ij}$, the action is:\n$$ S = \\int \\sqrt{2 \\left(V_b - E_0 - \\frac{1}{2}k_b q_{20}^2 + \\frac{1}{2}k_t q_{30}^2\\right)\\left(B_{20}\\left(\\frac{\\mathrm{d}q_{20}}{\\mathrm{d}s}\\right)^2 + B_{30}\\left(\\frac{\\mathrm{d}q_{30}}{\\mathrm{d}s}\\right)^2\\right)} \\,\\mathrm{d}s $$\nTo minimize the action, the path must pass through the lowest possible potential energy. The term $\\frac{1}{2}k_t q_{30}^2$ increases the potential energy as $|q_{30}|$ increases. Therefore, the path of least action (the instanton) must lie along the $q_{30}=0$ axis.\nSetting $q_{30}(s)=0$, the action simplifies. We can parameterize the path by $q_{20}$ itself, so $s=q_{20}$:\n$$ S_{inst} = \\int_{q_{20,a}}^{q_{20,b}} \\sqrt{2 \\left(V_b - E_0 - \\frac{1}{2}k_b q_{20}^2\\right) B_{20}} \\,\\mathrm{d}q_{20} $$\nThe classical turning points $q_{20,a}$ and $q_{20,b}$ are found by setting the argument of the square root to zero:\n$$ V_b - E_0 - \\frac{1}{2}k_b q_{20}^2 = 0 \\implies q_{20} = \\pm \\sqrt{\\frac{2(V_b - E_0)}{k_b}} \\equiv \\pm q_{20,m} $$\nThe integral is standard:\n$$ S_{inst} = \\sqrt{2 B_{20}} \\int_{-q_{20,m}}^{q_{20,m}} \\sqrt{(V_b - E_0) - \\frac{k_b}{2} q_{20}^2} \\,\\mathrm{d}q_{20} $$\nThis integral evaluates to $\\frac{\\pi}{2} (V_b - E_0) \\sqrt{2/k_b}$. Combining terms:\n$$ S_{inst} = \\sqrt{2 B_{20}} \\cdot \\frac{\\pi}{2} (V_b - E_0) \\sqrt{\\frac{2}{k_b}} = \\pi (V_b - E_0) \\sqrt{\\frac{B_{20}}{k_b}} $$\nThis is the analytical formula for the instanton action, which serves as a reference for the numerical calculations.\n\n### 3. Numerical Evaluation and Test Cases\n\nFor a generic straight-line path between two turning points $\\mathbf{q}_A$ and $\\mathbf{q}_B$, we use the parameterization $\\mathbf{q}(s) = \\mathbf{q}_A + s(\\mathbf{q}_B - \\mathbf{q}_A)$ for $s \\in [0, 1]$. The path derivative $\\mathrm{d}\\mathbf{q}/\\mathrm{d}s = \\mathbf{q}_B - \\mathbf{q}_A \\equiv \\Delta\\mathbf{q}$ is constant. The action integral becomes:\n$$ S = \\sqrt{B_{20}(\\Delta q_{20})^2 + B_{30}(\\Delta q_{30})^2} \\int_0^1 \\sqrt{2\\left(E(\\mathbf{q}(s)) - E_0\\right)} \\,\\mathrm{d}s $$\nThis one-dimensional integral can be efficiently and accurately computed using Gaussian quadrature.\n\n**Test Case 1 & 2 & 4:** The specified path is along $q_{30}=0$. This is the instanton path. The numerical WKB action calculation should therefore agree with the analytical instanton formula up to numerical precision. The absolute difference is expected to be near zero.\n\n**Test Case 3:** The specified path is $q_{30} = 0.5 q_{20}$, which is not the instanton path. According to the principle of least action, the action along any path other than the instanton must be greater than the instanton action. Thus, we expect the WKB action along this \"curved\" path (so-called because $q_{30} \\neq 0$) to be greater than the analytic instanton action calculated with the same barrier parameters ($V_b, E_0, k_b, B_{20}$). The comparison should yield `True`.\n\nThe program below implements these calculations, using `scipy.integrate.quad` for numerical integration.",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import quad\n\ndef calculate_wkb_action(Vb, E0, kb, kt, B20, B30, path_type, beta=None):\n    \"\"\"\n    Numerically computes the WKB action along a specified straight-line path.\n\n    The path is parameterized by s in [0, 1] from turning point A to B.\n    \"\"\"\n    if Vb - E0 < 0:\n        return 0.0\n\n    if path_type == 'straight':\n        # Path along q30 = 0\n        if kb <= 0: return np.inf\n        \n        q20_m = np.sqrt(2 * (Vb - E0) / kb)\n        qA = np.array([-q20_m, 0.0])\n        qB = np.array([q20_m, 0.0])\n\n    elif path_type == 'curved':\n        # Path along q30 = beta * q20\n        k_eff = kb - kt * beta**2\n        if k_eff <= 0:\n            # No real turning points or path is not under a barrier\n            return np.inf\n        \n        q20_m = np.sqrt(2 * (Vb - E0) / k_eff)\n        qA = np.array([-q20_m, -beta * q20_m])\n        qB = np.array([q20_m, beta * q20_m])\n    else:\n        raise ValueError(\"Unknown path type\")\n\n    delta_q = qB - qA\n    B_metric_term = B20 * delta_q[0]**2 + B30 * delta_q[1]**2\n    if B_metric_term < 0: return np.inf # Should not happen with positive B_ij\n    \n    # Define the integrand for the action integral\n    def integrand(s):\n        q20_s = qA[0] + s * delta_q[0]\n        q30_s = qA[1] + s * delta_q[1]\n        \n        potential_at_s = Vb - 0.5 * kb * q20_s**2 + 0.5 * kt * q30_s**2\n        energy_diff = potential_at_s - E0\n        \n        # Clamp to zero to handle potential floating-point inaccuracies\n        # at the endpoints where energy_diff should be exactly zero.\n        if energy_diff < 0:\n            return 0.0\n            \n        return np.sqrt(2 * energy_diff)\n\n    integral_val, _ = quad(integrand, 0, 1)\n\n    action = np.sqrt(B_metric_term) * integral_val\n    return action\n\ndef calculate_instanton_action(Vb, E0, kb, B20):\n    \"\"\"\n    Analytically computes the instanton action for the separable quadratic barrier.\n    \"\"\"\n    if Vb - E0 < 0 or kb <= 0 or B20 < 0:\n        return 0.0\n    return np.pi * (Vb - E0) * np.sqrt(B20 / kb)\n\ndef solve():\n    # Test suite: (Vb, E0, kb, kt, B20, B30)\n    test_cases = {\n        1: {'params': (6, 1, 4, 3, 10, 10), 'path': 'straight', 'beta': None},\n        2: {'params': (6, 2, 5, 3, 4, 16), 'path': 'straight', 'beta': None},\n        3: {'params': (6, 1, 4, 8, 10, 10), 'path': 'curved', 'beta': 0.5},\n        4: {'params': (10, 9.999, 6, 3, 7, 7), 'path': 'straight', 'beta': None},\n    }\n\n    results = []\n\n    # Test 1\n    case1 = test_cases[1]\n    Vb1, E01, kb1, _, B201, _ = case1['params']\n    wkb1 = calculate_wkb_action(*case1['params'], path_type=case1['path'])\n    inst1 = calculate_instanton_action(Vb1, E01, kb1, B201)\n    diff1 = np.abs(wkb1 - inst1)\n    results.extend([wkb1, diff1])\n\n    # Test 2\n    case2 = test_cases[2]\n    Vb2, E02, kb2, _, B202, _ = case2['params']\n    wkb2 = calculate_wkb_action(*case2['params'], path_type=case2['path'])\n    inst2 = calculate_instanton_action(Vb2, E02, kb2, B202)\n    diff2 = np.abs(wkb2 - inst2)\n    results.extend([wkb2, diff2])\n\n    # Test 3\n    case3 = test_cases[3]\n    Vb3, E03, kb3, _, B203, _ = case3['params']\n    wkb3_curved = calculate_wkb_action(*case3['params'], path_type=case3['path'], beta=case3['beta'])\n    inst3_straight = calculate_instanton_action(Vb3, E03, kb3, B203)\n    comp3 = wkb3_curved > inst3_straight\n    results.append(comp3)\n    \n    # Test 4\n    case4 = test_cases[4]\n    Vb4, E04, kb4, _, B204, _ = case4['params']\n    wkb4 = calculate_wkb_action(*case4['params'], path_type=case4['path'])\n    inst4 = calculate_instanton_action(Vb4, E04, kb4, B204)\n    diff4 = np.abs(wkb4 - inst4)\n    results.append(diff4)\n\n    # Format and print the final output\n    # Boolean must be 'True' or 'False' which str() handles correctly\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}