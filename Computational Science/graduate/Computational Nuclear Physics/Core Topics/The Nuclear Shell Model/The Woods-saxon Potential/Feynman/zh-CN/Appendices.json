{
    "hands_on_practices": [
        {
            "introduction": "这第一个练习是对伍兹-萨克逊势的形状进行直接的数值探索。通过计算其在几个关键径向距离处——核中心、半势半径以及表面区域内某一点——的势值，我们可以对其核心特征获得一个切实的理解：即核内部近似恒定的深度和表面的弥散过渡。这个练习为后续更抽象的概念提供了坚实具体的认知基础。",
            "id": "3608484",
            "problem": "在有限原子核的平均场描述中，中心单粒子势被广泛地用 Woods–Saxon 形式来建模，其函数依赖关系与核密度的双参数费米分布相同。中心势取为\n$$\nV(r) \\equiv -\\frac{V_{0}}{1+\\exp\\!\\left(\\frac{r-R}{a}\\right)},\n$$\n其中 $V_{0}>0$ 是势深，$a$ 是表面弥散度，$R$ 是由经验标度律给出的几何半径参数\n$$\nR \\equiv r_{0} A^{1/3},\n$$\n其中 $A$ 是质量数，$r_{0}$ 是一个飞米量级的常数。从这些定义以及饱和的内部密度和弥散表面的物理图像出发，对于一个重核（$A=208$，$r_{0}=1.25\\,\\mathrm{fm}$，$a=0.65\\,\\mathrm{fm}$，以及 $V_{0}=50\\,\\mathrm{MeV}$），推导出在 $r=0$、$r=R$ 和 $r=R+2a$ 处的 $V(r)$。计算 $V(0)$、$V(R)$ 和 $V(R+2a)$ 的数值。\n\n以 $\\mathrm{MeV}$ 为单位报告你的三个答案，并将每个答案四舍五入到四位有效数字。简要地根据 Woods–Saxon 形式所固有的内部饱和和表面弥散度来解释这三个值。你的最终数值答案必须按 $V(0)$、$V(R)$、$V(R+2a)$ 的顺序排列。",
            "solution": "问题验证如下。\n\n**第一步：提取已知条件**\n已知条件如下：\n-   Woods-Saxon 势形式：$V(r) \\equiv -\\frac{V_{0}}{1+\\exp\\!\\left(\\frac{r-R}{a}\\right)}$\n-   势深：$V_{0} > 0$\n-   表面弥散度：$a$\n-   几何半径参数：$R \\equiv r_{0} A^{1/3}$\n-   质量数：$A = 208$\n-   半径常数：$r_{0}=1.25\\,\\mathrm{fm}$\n-   表面弥散度值：$a=0.65\\,\\mathrm{fm}$\n-   势深值：$V_{0}=50\\,\\mathrm{MeV}$\n任务是计算 $V(0)$、$V(R)$ 和 $V(R+2a)$ 的数值并解释结果。\n\n**第二步：使用提取的已知条件进行验证**\n这个问题是有科学依据的。Woods-Saxon 势是原子核平均场的一个标准且物理上合理的唯象模型，它源于观测到的原子核内部密度饱和和表面弥散的现象。其函数形式、半径参数化 $R = r_{0}A^{1/3}$ 以及为 $V_{0}$、$a$、$r_{0}$ 和 $A$ 提供的具体数值对于像 $^{208}\\mathrm{Pb}$ 这样的重核都是标准且符合实际的。这个问题是适定的，因为它要求在特定点上对一个已定义的函数求值，而这个求值存在唯一解。这个问题也是客观的，用精确的数学和物理术语陈述，没有歧义。问题不存在科学上不合理、不完整或模糊等缺陷。\n\n**第三步：结论与行动**\n问题有效。将提供完整解答。\n\n**解题推导**\n\n目标是使用为重核提供的参数，计算在三个径向距离 $r=0$、$r=R$ 和 $r=R+2a$ 处的势 $V(r)$。\n\n首先，我们计算质量数为 $A=208$ 的原子核的核半径参数 $R$。\n使用给定公式 $R = r_{0} A^{1/3}$ 以及数值 $r_{0}=1.25\\,\\mathrm{fm}$ 和 $A=208$：\n$$\nR = (1.25\\,\\mathrm{fm}) \\times (208)^{1/3}\n$$\n$208$ 的立方根约等于 $5.9252$。\n$$\nR \\approx 1.25 \\times 5.9252 \\,\\mathrm{fm} \\approx 7.4065\\,\\mathrm{fm}\n$$\n在后续的计算中，我们将使用这个 $R$ 值。\n\n接下来，我们在三个指定点上计算势 $V(r)$。\n\n**1. 中心处的势, $V(0)$**\n我们在 Woods-Saxon 公式中设 $r=0$：\n$$\nV(0) = -\\frac{V_{0}}{1+\\exp\\left(\\frac{0-R}{a}\\right)} = -\\frac{V_{0}}{1+\\exp\\left(-\\frac{R}{a}\\right)}\n$$\n让我们计算指数函数的自变量 $-R/a$：\n$$\n-\\frac{R}{a} \\approx -\\frac{7.4065\\,\\mathrm{fm}}{0.65\\,\\mathrm{fm}} \\approx -11.3946\n$$\n由于 $R \\gg a$，这是一个很大的负数。指数项 $\\exp(-R/a)$ 将非常接近于零。\n$$\n\\exp(-11.3946) \\approx 1.1258 \\times 10^{-5}\n$$\n这表明对于一个重核，其中心的势非常接近于全深度 $-V_{0}$。代入数值：\n$$\nV(0) = -\\frac{50\\,\\mathrm{MeV}}{1+\\exp(-11.3946)} \\approx -\\frac{50\\,\\mathrm{MeV}}{1+1.1258 \\times 10^{-5}} \\approx -\\frac{50\\,\\mathrm{MeV}}{1.000011258} \\approx -49.999437\\,\\mathrm{MeV}\n$$\n四舍五入到四位有效数字，我们得到 $V(0) = -50.00\\,\\mathrm{MeV}$。\n\n**2. 半径 $R$ 处的势, $V(R)$**\n我们在 Woods-Saxon 公式中设 $r=R$：\n$$\nV(R) = -\\frac{V_{0}}{1+\\exp\\left(\\frac{R-R}{a}\\right)} = -\\frac{V_{0}}{1+\\exp\\left(\\frac{0}{a}\\right)} = -\\frac{V_{0}}{1+\\exp(0)}\n$$\n由于 $\\exp(0) = 1$，表达式精确地简化为：\n$$\nV(R) = -\\frac{V_{0}}{1+1} = -\\frac{V_{0}}{2}\n$$\n代入数值 $V_{0}=50\\,\\mathrm{MeV}$：\n$$\nV(R) = -\\frac{50\\,\\mathrm{MeV}}{2} = -25\\,\\mathrm{MeV}\n$$\n对于四位有效数字，结果是 $V(R) = -25.00\\,\\mathrm{MeV}$。\n\n**3. $r=R+2a$ 处的势, $V(R+2a)$**\n我们在 Woods-Saxon 公式中设 $r=R+2a$：\n$$\nV(R+2a) = -\\frac{V_{0}}{1+\\exp\\left(\\frac{(R+2a)-R}{a}\\right)} = -\\frac{V_{0}}{1+\\exp\\left(\\frac{2a}{a}\\right)} = -\\frac{V_{0}}{1+\\exp(2)}\n$$\n这个表达式与 $R$ 和 $a$ 的具体值无关，因为它们在指数中被消掉了。代入 $V_{0}=50\\,\\mathrm{MeV}$ 并使用 $e \\approx 2.71828$ 的值：\n$$\nV(R+2a) = -\\frac{50\\,\\mathrm{MeV}}{1+e^2} \\approx -\\frac{50\\,\\mathrm{MeV}}{1+7.389056} = -\\frac{50\\,\\mathrm{MeV}}{8.389056} \\approx -5.9599\\,\\mathrm{MeV}\n$$\n四舍五入到四位有效数字，我们得到 $V(R+2a) = -5.960\\,\\mathrm{MeV}$。\n\n**结果解释**\n\n-   $V(0) \\approx -50.00\\,\\mathrm{MeV}$：原子核中心的势几乎等于最大深度 $-V_{0}$。这反映了核饱和的物理图像，即在重核深处，核密度是恒定的。条件 $R \\gg a$ 确保了势阱有一个平坦的底部，这是饱和核内部的特征。\n\n-   $V(R) = -25.00\\,\\mathrm{MeV}$：在半径 $r=R$ 处的势正好是中心势深的一半。这源于在此背景下半径参数 $R$ 的定义，它对应于“半势半径”。这个点通常被用来定义原子核的有效边界或“表面”。\n\n-   $V(R+2a) \\approx -5.960\\,\\mathrm{MeV}$：这个点位于“表面”区域，在半势半径之外 $2a$ 的距离处。此时势已经下降到其中心值的约 $12\\%$ ($|-5.960|/|-50| \\approx 0.119$)。弥散度参数 $a$ 量化了该表面区域的厚度，在此区域内，势（以及其下的核密度）从其内部值向零过渡。势的快速衰减说明了核表面具有弥散但相对较薄的性质。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -50.00  -25.00  -5.960 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在我们建立起数值直觉之后，这个练习将我们的重点转移到伍兹-萨克逊势的解析性质上。通过引入一个无量纲坐标，我们可以将该势的普适函数形式从其依赖于特定原子核的参数中分离出来。这个强大的技巧让我们能够推导出一个表征核表面势函数陡峭程度的普适无量纲常数，揭示了该模型中蕴含的优美数学特性。",
            "id": "3608553",
            "problem": "在计算核物理中，一个广泛用于描述重核内核子所经历的球对称平均场的模型是伍兹-萨克逊势，其形式由经过充分检验的经验公式给出：\n$$\nV(r)=-\\frac{V_{0}}{1+\\exp\\!\\left(\\frac{r-R}{a}\\right)},\n$$\n其中 $V_{0}>0$ 是势深，$R>0$ 是与核尺寸相关的半径参数，$a>0$ 是控制表面厚度的弥散参数。引入无量纲坐标 $x=(r-R)/a$ 来分析势及其径向导数中各参数的标度关系。\n\n从参数标度的第一性原理和链式法则出发，完成以下任务：\n1. 将 $V(r)$ 改写为关于 $x$ 的函数 $V(x)$，并分离出对 $V_{0}$ 和 $a$ 的依赖关系。\n2. 计算径向导数 $dV/dr$，并将其完全用 $x$、$V_{0}$ 和 $a$ 表示。\n3. 定义无量纲表面斜率参数\n$$\ns \\equiv \\left.\\frac{a}{V_{0}}\\frac{dV}{dr}\\right|_{r=R},\n$$\n并精确计算其值。\n\n最终答案只需给出 $s$ 的精确值。无需四舍五入，且 $s$ 是无量纲量，没有单位。",
            "solution": "该问题要求计算伍兹-萨克逊势的无量纲表面斜率参数 $s$。该过程始于变量替换，然后进行微分，并在一个特定点求值。该问题经确认为自洽、科学上合理且提法明确。\n\n伍兹-萨克逊势由以下表达式给出：\n$$\nV(r)=-\\frac{V_{0}}{1+\\exp\\!\\left(\\frac{r-R}{a}\\right)}\n$$\n其中 $V_{0}$、$R$ 和 $a$ 是正常数，分别代表势深、核半径和表面弥散度。\n\n**第一部分：将 $V(r)$ 用无量纲坐标 $x$ 表示**\n\n根据题目要求，我们引入无量纲坐标 $x$，其定义为：\n$$\nx = \\frac{r-R}{a}\n$$\n将该定义直接代入 $V(r)$ 的表达式，得到势作为 $x$ 的函数：\n$$\nV(x) = -\\frac{V_{0}}{1+\\exp(x)}\n$$\n这种形式将势深 $V_0$ 分离出来作为一个标度因子，而空间依赖性则由关于 $x$ 的普适函数所描述。这完成了第一个任务。\n\n**第二部分：计算径向导数 $dV/dr$**\n\n为了求出径向导数 $\\frac{dV}{dr}$，我们应用链式法则，注意到 $V$ 是 $x$ 的函数，而 $x$ 又是 $r$ 的函数。\n$$\n\\frac{dV}{dr} = \\frac{dV}{dx} \\frac{dx}{dr}\n$$\n首先，我们计算 $x$ 对 $r$ 的导数：\n$$\n\\frac{dx}{dr} = \\frac{d}{dr}\\left(\\frac{r-R}{a}\\right) = \\frac{1}{a}\n$$\n接下来，我们计算 $V$ 对 $x$ 的导数：\n$$\nV(x) = -V_{0} \\left(1+\\exp(x)\\right)^{-1}\n$$\n对 $x$ 使用幂法则和链式法则进行微分：\n$$\n\\frac{dV}{dx} = -V_{0} \\cdot (-1) \\left(1+\\exp(x)\\right)^{-2} \\cdot \\frac{d}{dx}\\left(1+\\exp(x)\\right)\n$$\n$$\n\\frac{dV}{dx} = V_{0} \\left(1+\\exp(x)\\right)^{-2} \\cdot \\exp(x)\n$$\n$$\n\\frac{dV}{dx} = \\frac{V_{0}\\exp(x)}{\\left(1+\\exp(x)\\right)^2}\n$$\n现在，我们将两个导数组合起来求 $\\frac{dV}{dr}$：\n$$\n\\frac{dV}{dr} = \\left(\\frac{V_{0}\\exp(x)}{\\left(1+\\exp(x)\\right)^2}\\right) \\cdot \\left(\\frac{1}{a}\\right) = \\frac{V_{0}}{a}\\frac{\\exp(x)}{\\left(1+\\exp(x)\\right)^2}\n$$\n这个 $\\frac{dV}{dr}$ 的表达式完全由 $x$、$V_{0}$ 和 $a$ 表示，符合第二个任务的要求。\n\n**第三部分：计算无量纲表面斜率参数 $s$**\n\n无量纲表面斜率参数 $s$ 的定义为：\n$$\ns \\equiv \\left.\\frac{a}{V_{0}}\\frac{dV}{dr}\\right|_{r=R}\n$$\n为了计算该值，我们首先需要求出导数 $\\frac{dV}{dr}$ 在特定径向位置 $r=R$ 处的值。在 $r=R$ 处，无量纲坐标 $x$ 的值为：\n$$\nx(R) = \\frac{R-R}{a} = \\frac{0}{a} = 0\n$$\n我们将 $x=0$ 代入 $\\frac{dV}{dr}$ 的表达式：\n$$\n\\left.\\frac{dV}{dr}\\right|_{r=R} = \\frac{V_{0}}{a}\\frac{\\exp(0)}{\\left(1+\\exp(0)\\right)^2}\n$$\n由于 $\\exp(0) = 1$，上式可简化为：\n$$\n\\left.\\frac{dV}{dr}\\right|_{r=R} = \\frac{V_{0}}{a}\\frac{1}{\\left(1+1\\right)^2} = \\frac{V_{0}}{a}\\frac{1}{2^2} = \\frac{V_{0}}{4a}\n$$\n该值表示势的最大斜率，它出现在核半径 $R$ 处。\n\n最后，我们将此结果代入 $s$ 的定义中：\n$$\ns = \\frac{a}{V_{0}} \\left(\\left.\\frac{dV}{dr}\\right|_{r=R}\\right) = \\frac{a}{V_{0}} \\left(\\frac{V_{0}}{4a}\\right)\n$$\n参数 $V_0$ 和 $a$ 消去，得到 $s$ 的精确无量纲值：\n$$\ns = \\frac{1}{4}\n$$\n这个结果表明，伍兹-萨克逊势在核表面的归一化斜率是一个普适常数，与特定原子核的具体参数无关。",
            "answer": "$$\n\\boxed{\\frac{1}{4}}\n$$"
        },
        {
            "introduction": "这最后一个练习是一个综合性实践，它将我们对伍兹-萨克逊势的理解融入到一个真实的计算物理问题中。我们将编写一个程序，求解在这一势场中运动的核子的径向薛定谔方程，以确定其束缚态能量。这项任务需要对哈密顿量进行离散化并求解由此产生的矩阵本征值问题，这些都是计算核物理学家的基本功。",
            "id": "3608501",
            "problem": "你需要编写一个完整、可运行的程序，用于计算在球对称 Woods–Saxon 势中运动的单个核子的束缚态性质，验证约化径向波函数的归一化，同时量化最低本征值对外部边界位置的敏感度。其基本物理原理是，对于一个在中心势中，具有轨道角动量量子数 $l$、约化质量为 $\\mu$ 的单粒子，其约化径向波函数 $u_l(r)$ 所满足的不含时径向薛定谔方程为\n$$\n\\left[-\\frac{\\hbar^2}{2\\mu}\\frac{d^2}{dr^2} + V_{\\text{WS}}(r) + \\frac{\\hbar^2 l(l+1)}{2\\mu r^2}\\right] u_l(r) = E \\, u_l(r),\n$$\n边界条件为 $u_l(0)=0$ 和 $u_l(r\\to\\infty)=0$。Woods–Saxon 势为\n$$\nV_{\\text{WS}}(r) = -\\frac{V_0}{1+\\exp\\left(\\frac{r - R_0}{a}\\right)},\n$$\n其中 $V_0>0$ 是势深，$R_0$ 是半径，$a$ 是弥散度。在本题中，你将使用适用于重核中核子的常数 $c \\equiv \\hbar^2/(2\\mu)$，其单位为兆电子伏飞米平方（$\\text{MeV}\\cdot\\text{fm}^2$）；取 $c = 20.73553\\,\\text{MeV}\\cdot\\text{fm}^2$。所有长度必须以飞米（$\\text{fm}$）为单位，所有能量必须以兆电子伏（$\\text{MeV}$）为单位。在这个一维径向简化中不出现角度，因此不需要角度单位。你必须对约化径向波函数 $u_l(r)$ 强制执行归一化：\n$$\n\\int_{0}^{\\infty} |u_l(r)|^2 \\, dr = 1.\n$$\n在数值计算实践中，定义域被截断为 $[0, R_{\\max}]$，并满足 $u_l(0)=0$ 和 $u_l(R_{\\max})=0$。你必须：\n- 在均匀径向网格上离散化算符，以形成哈密顿量的对称三对角表示，这需要使用二阶有限差分格式或从第一性原理推导出的等效或更高精度的算法。对每个指定的参数集和外边界 $R_{\\max}$，求解最低束缚态本征值 $E<0$ 和相关的本征矢量（即约化径向波函数的采样点）。不要使用任何未从径向薛定谔方程推导出的简便公式。\n- 通过重新缩放离散本征矢量来验证归一化，使得近似 $\\int_0^{R_{\\max}} |u_l(r)|^2 \\, dr$ 的数值积分在数值精度范围内等于 $1$。对于每种情况，报告归一化后与 1 的绝对偏差，结果应为一个非负浮点数。\n- 通过计算使用两个不同外边界 $R_{\\max}^{(1)}$ 和 $R_{\\max}^{(2)}$ 得到的能量之间的绝对差来量化最低本征值对外边界的敏感度，即报告 $|E(R_{\\max}^{(2)}) - E(R_{\\max}^{(1)})|$，单位为 $\\text{MeV}$。\n\n你必须基于以下基本原理实现物理和数值计算：\n- 如上所述的包含离心项的径向形式的不含时薛定谔方程。\n- 如上所述的 Woods–Saxon 中心势。\n- 在均匀网格上对二阶导数进行标准的二阶有限差分离散化，并在 $r=0$ 和 $r=R_{\\max}$ 处使用狄利克雷边界条件。\n- 用于对称三对角本征问题的线性代数，以获得最小的本征值和相应的本征矢量。\n\n你不得使用任何非物理的简便方法，也不得假设任何未从算符离散化推导出的能量本征值公式。\n\n实现你的程序以处理以下包含三种情况的测试套件。在每种情况下，计算两个外边界 $R_{\\max}^{(1)}$ 和 $R_{\\max}^{(2)}$ 的最低束缚态能量，验证每个的归一化，并报告：\n- 两次归一化中与 1 的最大绝对偏差，即 $\\max\\left(\\left|\\int_0^{R_{\\max}^{(1)}} |u_l(r)|^2 dr - 1\\right|,\\left|\\int_0^{R_{\\max}^{(2)}} |u_l(r)|^2 dr - 1\\right|\\right)$，作为一个无量纲的浮点数。\n- 绝对能量差 $|E(R_{\\max}^{(2)}) - E(R_{\\max}^{(1)})|$，单位为 $\\text{MeV}$，作为一个浮点数。\n\n使用以下参数集（所有长度单位为 $\\text{fm}$，能量单位为 $\\text{MeV}$）：\n- 情况 A（一个典型的中等质量核和 s 波）：$V_0 = 50$，$R_0 = 4.27$，$a = 0.65$，$l = 0$，$R_{\\max}^{(1)} = 15$，$R_{\\max}^{(2)} = 25$，对于 $R_{\\max}^{(1)}$ 和 $R_{\\max}^{(2)}$ 均使用 $N = 1800$ 个内部网格点。\n- 情况 B（一个重核和更高的 $l$）：$V_0 = 50$，$R_0 = 7.40$，$a = 0.65$，$l = 3$，$R_{\\max}^{(1)} = 20$，$R_{\\max}^{(2)} = 30$，对于 $R_{\\max}^{(1)}$ 和 $R_{\\max}^{(2)}$ 均使用 $N = 2200$ 个内部网格点。\n- 情况 C（一个近阈值的浅势阱情况）：$V_0 = 40$，$R_0 = 4.50$，$a = 0.70$，$l = 0$，$R_{\\max}^{(1)} = 20$，$R_{\\max}^{(2)} = 30$，对于 $R_{\\max}^{(1)}$ 和 $R_{\\max}^{(2)}$ 均使用 $N = 2200$ 个内部网格点。\n\n数值要求：\n- 在 $(0, R_{\\max})$ 内使用一个包含 $N$ 个内部点的均匀网格，并在 $r=0$ 和 $r=R_{\\max}$ 处使用狄利克雷边界。\n- 使用从 $d^2/dr^2$ 的二阶中心差分推导出的动能算符的对称三对角表示，并将 Woods–Saxon 项和离心项加到对角线上。\n- 使用一个可靠的对称三对角本征求解器来提取最小的本征值和相应的本征矢量。确保你选择的是束缚态（负能量）。如果你的离散化对某个情况只产生正能量，你的程序仍必须完成；对于本测试套件，使用所提供的参数，预期会得到物理上合理的束缚态。\n\n输出规范：\n- 你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。\n- 条目必须按以下顺序排列：对于情况 A，归一化偏差，然后是能量敏感度；对于情况 B，归一化偏差，然后是能量敏感度；对于情况 C，归一化偏差，然后是能量敏感度。总共六个浮点数。\n- 每个浮点数必须以科学记数法打印，小数点后有六位数字。\n- 最后一行必须看起来像 $[x_1,x_2,x_3,x_4,x_5,x_6]$，其中每个 $x_i$ 都是如上指定的浮点数。\n\n所有能量必须以 $\\text{MeV}$ 报告，所有长度以 $\\text{fm}$ 报告，所有归一化积分为无量纲。不允许用户输入；所有参数都如上所述进行硬编码。算法设计必须从前面列出的基本方程开始并由其证明，不得使用本问题陈述提供的简便公式。",
            "solution": "该问题要求对球对称势中单个核子的一维不含时径向薛定谔方程进行数值求解。约化径向波函数 $u_l(r)$ 的控制方程是：\n$$\n\\left[-\\frac{\\hbar^2}{2\\mu}\\frac{d^2}{dr^2} + V_{\\text{eff}, l}(r)\\right] u_l(r) = E \\, u_l(r)\n$$\n其中 $E$ 是能量本征值。有效势 $V_{\\text{eff}, l}(r)$ 是 Woods–Saxon 势 $V_{\\text{WS}}(r)$ 和离心势 $V_{\\text{cent}, l}(r)$ 的和：\n$$\nV_{\\text{eff}, l}(r) = V_{\\text{WS}}(r) + V_{\\text{cent}, l}(r) = -\\frac{V_0}{1+\\exp\\left(\\frac{r - R_0}{a}\\right)} + \\frac{\\hbar^2 l(l+1)}{2\\mu r^2}\n$$\n使用给定的常数 $c \\equiv \\hbar^2/(2\\mu)$，薛定谔方程可以重写为：\n$$\n-c \\frac{d^2u_l(r)}{dr^2} + \\left( V_{\\text{WS}}(r) + c\\frac{l(l+1)}{r^2} \\right) u_l(r) = E \\, u_l(r)\n$$\n束缚态的物理边界条件是 $u_l(0) = 0$ 和 $u_l(r \\to \\infty) = 0$。为了进行数值求解，我们将无限域截断为有限区间 $[0, R_{\\max}]$，并施加狄利克雷边界条件 $u_l(0) = 0$ 和 $u_l(R_{\\max}) = 0$。\n\n数值解的第一步是离散化径向域。我们使用一个有 $N$ 个内部点的均匀网格。设网格区间的总数为 $N+1$。则网格间距为 $h = R_{\\max} / (N+1)$。网格点为 $r_i = i \\cdot h$，其中 $i = 0, 1, \\dots, N+1$。在这些点上的波函数值表示为 $u_i \\equiv u_l(r_i)$。边界条件要求 $u_0 = 0$ 和 $u_{N+1} = 0$。我们需要求解在 $N$ 个内部点 $r_1, \\dots, r_N$ 上的波函数。\n\n二阶导数项 $d^2u_l/dr^2$ 使用二阶中心有限差分公式进行近似：\n$$\n\\frac{d^2u_l}{dr^2}\\bigg|_{r=r_i} \\approx \\frac{u_l(r_{i+1}) - 2u_l(r_i) + u_l(r_{i-1})}{h^2} = \\frac{u_{i+1} - 2u_i + u_{i-1}}{h^2}\n$$\n将此近似代入每个内部网格点 $r_i$（$i = 1, \\dots, N$）的薛定谔方程，得到一个线性代数方程组：\n$$\n-c \\left( \\frac{u_{i+1} - 2u_i + u_{i-1}}{h^2} \\right) + V_{\\text{eff}, l}(r_i) u_i = E u_i\n$$\n重新整理这些项，我们得到：\n$$\n-\\frac{c}{h^2}u_{i-1} + \\left( \\frac{2c}{h^2} + V_{\\text{eff}, l}(r_i) \\right) u_i - \\frac{c}{h^2}u_{i+1} = E u_i\n$$\n这个包含 $N$ 个方程的系统可以写成标准本征值问题的矩阵形式，$\\mathbf{H}\\vec{u} = E\\vec{u}$，其中 $\\vec{u} = (u_1, u_2, \\dots, u_N)^T$ 是内部网格点上波函数值的向量，而 $\\mathbf{H}$ 是离散化的哈密顿矩阵。矩阵 $\\mathbf{H}$ 是一个实对称三对角矩阵。其元素为：\n- 对角元素：\n$$\nH_{ii} = \\frac{2c}{h^2} + V_{\\text{eff}, l}(r_i) = \\frac{2c}{h^2} - \\frac{V_0}{1+\\exp\\left(\\frac{r_i - R_0}{a}\\right)} + c\\frac{l(l+1)}{r_i^2}\n$$\n- 非对角元素（$|i-j|=1$）：\n$$\nH_{i,i+1} = H_{i+1,i} = -\\frac{c}{h^2}\n$$\n所有其他元素均为零。注意，对于 $l=0$，离心项消失。对于 $l>0$，由于我们的内部网格从 $r_1 = h > 0$ 开始，该项是良定义的。\n\n我们求解这个矩阵本征值问题以找到本征值（能级）和本征矢量（波函数）。问题特别要求最低的束缚态，这对应于矩阵 $\\mathbf{H}$ 的最小本征值。专门的数值库为对称三对角矩阵提供了高效的本征求解器，例如 `scipy.linalg.eigh_tridiagonal`。该函数按升序返回本征值，因此第一个本征值就是所求的基态能量 $E$。\n\n相应的本征矢量 $\\vec{v} = (v_1, \\dots, v_N)^T$ 必须根据物理条件 $\\int_0^{R_{\\max}} |u_l(r)|^2 dr = 1$ 进行归一化。数值本征矢量通常以单位 L2 范数返回，即 $\\sum_{i=1}^N v_i^2 = 1$。为了将其与物理归一化联系起来，我们必须对积分进行近似。在网格点 $r_0, \\dots, r_{N+1}$ 上使用梯形法则，并利用边界条件 $u_0 = u_{N+1} = 0$，我们有：\n$$\n\\int_0^{R_{\\max}} |u_l(r)|^2 dr \\approx h \\sum_{i=1}^N |u_i|^2 = 1\n$$\n我们数值计算的状态向量 $\\vec{u}$ 与求解器提供的本征矢量 $\\vec{v}$ 之间的关系是 $\\vec{u} = K\\vec{v}$，其中 $K$ 是一个归一化常数。将其代入积分近似中，得到 $h \\sum_{i=1}^N (K v_i)^2 = K^2 h \\sum_{i=1}^N v_i^2 = 1$。由于 $\\sum_{i=1}^N v_i^2 = 1$，我们发现 $K^2 h = 1$，因此 $K = 1/\\sqrt{h}$。所以，正确归一化的离散波函数是 $u_i = v_i / \\sqrt{h}$。\n\n为了验证归一化，我们在这次缩放后数值计算积分：\n$$\nI_{\\text{norm}} = h \\sum_{i=1}^N u_i^2 = h \\sum_{i=1}^N \\left(\\frac{v_i}{\\sqrt{h}}\\right)^2 = \\sum_{i=1}^N v_i^2\n$$\n与 1 的绝对偏差是 $|I_{\\text{norm}} - 1| = |\\sum_{i=1}^N v_i^2 - 1|$。由于本征求解器返回的本征矢量其 $\\sum_i v_i^2$ 已经非常接近 1，这个偏差预计在机器精度量级。对于每种情况，我们都对 $R_{\\max}^{(1)}$ 和 $R_{\\max}^{(2)}$ 计算这个值，并报告两个偏差中的最大值。\n\n最后，对于每组物理参数，我们对两个不同的外边界 $R_{\\max}^{(1)}$ 和 $R_{\\max}^{(2)}$ 执行整个计算，得到两个基态能量 $E(R_{\\max}^{(1)})$ 和 $E(R_{\\max}^{(2)})$。对边界位置的敏感度由绝对差 $|E(R_{\\max}^{(2)}) - E(R_{\\max}^{(1)})|$ 来量化。对所提供的三种测试情况中的每一种都重复此整个过程。",
            "answer": "```python\nimport numpy as np\nfrom scipy.linalg import eigh_tridiagonal\n\ndef solve():\n    \"\"\"\n    Main function to solve the Woods-Saxon potential problem for all test cases.\n    \"\"\"\n    \n    # Define the physical constant and test cases.\n    # c = hbar^2 / (2*mu) in MeV*fm^2\n    C_CONST = 20.73553\n\n    test_cases = [\n        # Case A: V0, R0, a, l, Rmax1, Rmax2, N\n        (50.0, 4.27, 0.65, 0, 15.0, 25.0, 1800),\n        # Case B: V0, R0, a, l, Rmax1, Rmax2, N\n        (50.0, 7.40, 0.65, 3, 20.0, 30.0, 2200),\n        # Case C: V0, R0, a, l, Rmax1, Rmax2, N\n        (40.0, 4.50, 0.70, 0, 20.0, 30.0, 2200),\n    ]\n\n    results = []\n    \n    for case_params in test_cases:\n        v0, r0, a_diff, l, r_max1, r_max2, n_points = case_params\n\n        # Calculate properties for the first boundary R_max^(1)\n        energy1, norm_dev1 = compute_eigenstate(\n            v0, r0, a_diff, l, r_max1, n_points, C_CONST\n        )\n        \n        # Calculate properties for the second boundary R_max^(2)\n        energy2, norm_dev2 = compute_eigenstate(\n            v0, r0, a_diff, l, r_max2, n_points, C_CONST\n        )\n        \n        # Calculate the required outputs for the case\n        max_norm_deviation = max(norm_dev1, norm_dev2)\n        energy_sensitivity = abs(energy2 - energy1)\n        \n        results.extend([max_norm_deviation, energy_sensitivity])\n        \n    # Format and print the final results as specified.\n    print(f\"[{','.join(['{:.6e}'.format(x) for x in results])}]\")\n\n\ndef compute_eigenstate(v0, r0, a_diff, l, r_max, n_points, c):\n    \"\"\"\n    Solves the radial Schrodinger equation for a given set of parameters.\n\n    Args:\n        v0 (float): Potential depth in MeV.\n        r0 (float): Nuclear radius in fm.\n        a_diff (float): Diffuseness parameter in fm.\n        l (int): Orbital angular momentum quantum number.\n        r_max (float): Outer boundary of the radial grid in fm.\n        n_points (int): Number of interior grid points.\n        c (float): Constant hbar^2 / (2*mu) in MeV*fm^2.\n\n    Returns:\n        tuple: A tuple containing:\n            - E_min (float): The lowest energy eigenvalue in MeV.\n            - norm_deviation (float): The absolute deviation of the eigenvector's\n                                      squared norm from 1.\n    \"\"\"\n    # 1. Set up the radial grid\n    # h is the uniform grid spacing. N interior points mean N+1 intervals.\n    h = r_max / (n_points + 1)\n    # r is the array of interior grid points r_1, r_2, ..., r_N\n    r = np.arange(1, n_points + 1) * h\n    \n    # 2. Define the potential on the grid\n    # Woods-Saxon potential\n    v_ws = -v0 / (1.0 + np.exp((r - r0) / a_diff))\n    \n    # Centrifugal potential. This is safe as r > 0 for all points.\n    if l > 0:\n        v_cent = c * l * (l + 1) / (r**2)\n    else:\n        v_cent = 0.0\n    \n    v_eff = v_ws + v_cent\n\n    # 3. Construct the Hamiltonian matrix elements\n    # The matrix is symmetric and tridiagonal. We only need the diagonal\n    # and the first off-diagonal.\n    \n    # Kinetic energy term contribution to the diagonal\n    kinetic_diag = 2.0 * c / (h**2)\n    \n    # Full diagonal of the Hamiltonian matrix\n    diagonal = kinetic_diag + v_eff\n    \n    # Off-diagonal elements (constant for a uniform grid)\n    off_diagonal = np.full(n_points - 1, -c / (h**2))\n    \n    # 4. Solve the eigenvalue problem\n    # eigh_tridiagonal is a specialized solver for symmetric tridiagonal matrices.\n    # It returns eigenvalues in ascending order and corresponding eigenvectors.\n    eigenvalues, eigenvectors = eigh_tridiagonal(diagonal, off_diagonal)\n\n    # 5. Extract results for the lowest bound state\n    # The lowest eigenvalue is the ground state energy\n    e_min = eigenvalues[0]\n    \n    # The corresponding eigenvector is the first column of the result\n    v_min = eigenvectors[:, 0]\n    \n    # 6. Verify normalization\n    # The solver returns eigenvectors normalized to have a vector L2 norm of 1.\n    # The normalization integral is approx sum(v_i^2), so the deviation\n    # is |sum(v_i^2) - 1|.\n    norm_sq = np.sum(v_min**2)\n    norm_deviation = np.abs(norm_sq - 1.0)\n    \n    return e_min, norm_deviation\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}