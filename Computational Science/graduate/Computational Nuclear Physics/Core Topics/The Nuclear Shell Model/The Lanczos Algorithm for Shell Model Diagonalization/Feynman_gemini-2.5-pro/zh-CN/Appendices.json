{
    "hands_on_practices": [
        {
            "introduction": "在任何大规模计算中，算法的效率都至关重要，Lanczos算法也不例外。在原子核壳模型计算中，其主要计算开销来自于哈密顿量-矢量乘积 $H v$。这项实践将指导您逐步分析单个Lanczos迭代步骤的计算成本，通过推导总浮点运算次数（FLOPs）并识别其中的主导项，您将具体理解为何在壳模型计算中，哈密顿量的两体部分会成为运行时间的主导因素 。",
            "id": "3603207",
            "problem": "您正在实施 Lanczos 算法，以在磁量子数方案（m-方案）中计算一个大型稀疏原子核壳模型哈密顿量的极端本征对。哈密顿量 $H$ 表示为单体和双体部分之和，并通过一个预先计算的、关于斯莱特行列式之间非零耦合的连接列表应用于状态矢量。多体基的维度是 $N$，单体连接数是 $M_{1}$，双体连接数是 $M_{2}$。在累积 $y \\leftarrow H v$ 时，每个连接贡献一次乘法和一次加法，因此 $y \\leftarrow H v$ 的代价是 $2(M_{1} + M_{2})$ 次浮点运算（FLOPs），其中一次浮点运算（FLOP）定义为一次加法或一次乘法。在一次 Lanczos 迭代中，您对 $\\mathbb{R}^{N}$ 中的矢量执行以下步骤：\n(1) $y \\leftarrow H v$，\n(2) $\\alpha \\leftarrow v^{\\top} y$，\n(3) $y \\leftarrow y - \\alpha v - \\beta_{\\mathrm{prev}} v_{\\mathrm{prev}}$，\n(4) $\\beta \\leftarrow \\| y \\|_{2}$，以及\n(5) $v_{\\mathrm{next}} \\leftarrow y / \\beta$。\n假设采用以下 FLOP 模型：每次加法或乘法代价为 $1$ FLOP，每次除法代价为 $d$ FLOPs，每次平方根代价为 $s$ FLOPs。没有重新正交化，也没有重启开销。仅从这些定义和 Lanczos 迭代的标准结构出发，推导一个关于 $M_{1}$、$M_{2}$、$N$、$d$ 和 $s$ 的每次迭代总 FLOP 计数 $C_{\\mathrm{iter}}$ 的闭式解析表达式。然后，在 m-方案实现中双体项占主导地位的假设下，即 $M_{2} \\gg M_{1}$ 和 $M_{2} \\gg N$，将 $C_{\\mathrm{iter}}$ 简化为其主导项。将您的最终答案表示为 $C_{\\mathrm{iter}}$ 的领头阶解析表达式。",
            "solution": "该问题要求推导应用于原子核壳模型哈密顿量的标准 Lanczos 迭代中，每次迭代的总浮点运算（FLOP）次数（记作 $C_{\\mathrm{iter}}$）。随后，在指定的占优条件下，必须将此表达式简化为其主导项。\n\n分析将通过将一次完整的 Lanczos 迭代分解为问题陈述中提供的五个组成步骤来进行。对于每个步骤，我们将根据给定的 FLOP 模型计算浮点运算（加法、乘法、除法、平方根）的次数，其中加法和乘法的代价为 $1$ FLOP，除法的代价为 $d$ FLOPs，平方根的代价为 $s$ FLOPs。所有矢量都在 $\\mathbb{R}^{N}$ 中。\n\n1.  **步骤 1：哈密顿-矢量乘积，$y \\leftarrow H v$**\n    问题陈述指明，将哈密顿量 $H$ 应用于矢量 $v$ 的代价由预计算数据结构中的单体（$M_1$）和双体（$M_2$）连接数决定。每个连接对应一次乘法和一次加法。\n    此步骤的总 FLOP 计数明确给出为：\n    $$C_1 = 2(M_1 + M_2)$$\n\n2.  **步骤 2：点积，$\\alpha \\leftarrow v^{\\top} y$**\n    此步骤计算维度为 $N$ 的两个矢量 $v$ 和 $y$ 的点积。点积定义为 $\\alpha = \\sum_{i=1}^{N} v_i y_i$。此计算涉及 $N$ 次乘法（对于每个项 $v_i y_i$）和 $N-1$ 次加法以对这些乘积求和。\n    此步骤的总 FLOP 计数为：\n    $$C_2 = N + (N-1) = 2N - 1$$\n\n3.  **步骤 3：矢量更新（正交化），$y \\leftarrow y - \\alpha v - \\beta_{\\mathrm{prev}} v_{\\mathrm{prev}}$**\n    此操作通过减去当前和前一个 Lanczos 矢量 $v$ 和 $v_{\\mathrm{prev}}$ 的缩放版本来更新矢量 $y$。此更新是按分量执行的。对于从 $1$ 到 $N$ 的每个分量 $i$，操作为 $y_i \\leftarrow y_i - \\alpha v_i - \\beta_{\\mathrm{prev}} (v_{\\mathrm{prev}})_i$。这需要两次乘法（以计算 $\\alpha v_i$ 和 $\\beta_{\\mathrm{prev}} (v_{\\mathrm{prev}})_i$）和两次减法。由于一次减法代价为 $1$ FLOP，因此 $N$ 个分量的总代价是 $2N$ 次乘法和 $2N$ 次减法。\n    此步骤的总 FLOP 计数为：\n    $$C_3 = 2N + 2N = 4N$$\n\n4.  **步骤 4：矢量范数，$\\beta \\leftarrow \\| y \\|_{2}$**\n    此步骤计算更新后的矢量 $y$ 的欧几里得范数（或 $2$-范数），即 $\\beta = \\sqrt{\\sum_{i=1}^{N} y_i^2}$。计算过程如下：\n    -   计算每个分量的平方 $y_i^2$：$N$ 次乘法。\n    -   对平方求和：$N-1$ 次加法。\n    -   对总和开平方根：1 次平方根运算。\n    此步骤的总 FLOP 计数为：\n    $$C_4 = N + (N-1) + s = 2N - 1 + s$$\n\n5.  **步骤 5：矢量归一化，$v_{\\mathrm{next}} \\leftarrow y / \\beta$**\n    此步骤将矢量 $y$ 归一化以产生下一个 Lanczos 矢量 $v_{\\mathrm{next}}$。该操作包括将矢量 $y$ 的 $N$ 个分量中的每一个都除以标量 $\\beta$。这构成了 $N$ 次独立的除法运算。\n    考虑到每次除法的代价为 $d$ FLOPs，此步骤的总 FLOP 计数为：\n    $$C_5 = N d$$\n\n每次迭代的总 FLOP 计数 $C_{\\mathrm{iter}}$ 是这五个步骤代价的总和：\n$$C_{\\mathrm{iter}} = C_1 + C_2 + C_3 + C_4 + C_5$$\n$$C_{\\mathrm{iter}} = (2(M_1 + M_2)) + (2N - 1) + (4N) + (2N - 1 + s) + (Nd)$$\n合并各项，我们得到闭式解析表达式：\n$$C_{\\mathrm{iter}} = 2M_1 + 2M_2 + 8N + Nd + s - 2$$\n\n问题的第二部分要求在相互作用的双体部分占主导地位的假设下，将此表达式简化为其主导项。这由条件 $M_2 \\gg M_1$ 和 $M_2 \\gg N$ 陈述。这些条件表明 $M_2$ 是表征问题规模的最大参数。我们在 $M_2$ 很大的渐近极限下分析 $C_{\\mathrm{iter}}$ 的行为。\n\n$C_{\\mathrm{iter}}$ 的表达式是几项之和：$2M_2$、$2M_1$、$8N$、$Nd$ 和 $s-2$。\n-   项 $2M_2$ 与 $M_2$ 成正比。\n-   由于 $M_2 \\gg M_1$，项 $2M_1$ 与 $2M_2$ 相比可以忽略不计。\n-   由于 $M_2 \\gg N$，项 $8N$ 与 $2M_2$ 相比可以忽略不计。\n-   由于 $M_2 \\gg N$ 且 $d$ 是一个固定常数，项 $Nd$ 与 $2M_2$ 相比也可以忽略不计。\n-   项 $s-2$ 是一个常数，因此对于大的 $M_2$ 来说可以忽略不计。\n\n形式上，我们可以将 $C_{\\mathrm{iter}}$ 写作：\n$$C_{\\mathrm{iter}} = 2M_2 \\left(1 + \\frac{M_1}{M_2} + \\frac{4N}{M_2} + \\frac{Nd}{2M_2} + \\frac{s-2}{2M_2}\\right)$$\n在 $M_2 \\rightarrow \\infty$ 的极限下，比率 $\\frac{M_1}{M_2}$、$\\frac{N}{M_2}$ 和 $\\frac{1}{M_2}$ 都趋近于零。因此，括号中的表达式趋近于 $1$。$C_{\\mathrm{iter}}$ 表达式中的主导项，或领头阶项，是随问题规模增长最快的那一项，即与 $M_2$ 成正比的项。\n\n因此，每次迭代 FLOP 计数的领头阶解析表达式是：\n$$C_{\\mathrm{iter}} \\approx 2M_2$$\n这个结果反映了一个众所周知的事实，即在大规模壳模型计算中，计算成本绝大部分由哈密顿量双体部分的应用所主导。",
            "answer": "$$\\boxed{2M_2}$$"
        },
        {
            "introduction": "Lanczos算法为哈密顿量的真实本征值和本征矢量提供了近似，即所谓的里兹对（Ritz pairs），一个关键问题是如何评估这些近似的准确性。本练习提供了一个处理小规模Lanczos计算输出的动手实践机会。通过计算所产生的三对角矩阵 $T_k$ 的本征值（即里兹值）并评估相应的残差范数，您将掌握残差范数、最后一个非对角元 $\\beta_k$ 以及Lanczos近似质量之间的基本关系 。",
            "id": "3603131",
            "problem": "在原子核壳模型哈密顿量的大规模对角化中，我们采用兰佐斯 (Lanczos) 算法来构造一个正交归一的克雷洛夫 (Krylov) 基和一个投影的对称三对角矩阵。考虑一个作用在维度为 $N \\gg 4$ 的希尔伯特空间上的实对称哈密顿量 $H$，以及一次从归一化初始向量 $v_1$ 开始的兰佐斯 (Lanczos) 运行，该运行产生了 4 步正交归一的兰佐斯 (Lanczos) 基 $Q_{4} = [v_{1}, v_{2}, v_{3}, v_{4}]$ 和相关的对称三对角矩阵 $T_{4} \\in \\mathbb{R}^{4 \\times 4}$，其对角线元素 $\\alpha_{i}$ 和次/超对角线元素 $\\beta_{i}$ 由三项递推关系确定。设系数指定为\n$$\n\\alpha_{1}=\\alpha_{2}=\\alpha_{3}=\\alpha_{4}=0,\\quad \\beta_{1}=\\beta_{2}=\\beta_{3}=1,\\quad \\beta_{4}=\\frac{1}{100}.\n$$\n因此，\n$$\nT_{4}=\\begin{pmatrix}\n0  1  0  0 \\\\\n1  0  1  0 \\\\\n0  1  0  1 \\\\\n0  0  1  0\n\\end{pmatrix}.\n$$\n从哈密顿量 $H$ 的兰佐斯 (Lanczos) 三项递推关系和兰佐斯 (Lanczos) 向量的正交归一性出发，推导一个里兹 (Ritz) 对 $(\\lambda,y)$ 的残差形式，该里兹对通过对角化 $T_4$ 并通过 $x=Q_{4}y$ 将 $y$ 嵌入回全空间得到。然后，对于给定的 $T_4$：\n- 计算 $T_4$ 的四个特征值和对应的归一化特征向量 $y$。\n- 使用推导出的残差表达式，计算嵌入的里兹 (Ritz) 对的四个残差范数，结果用每个归一化特征向量的最后一个分量 $y_{4}$ 和给定的 $\\beta_{4}=\\frac{1}{100}$ 表示。\n\n将所有特征值和残差范数表示为精确的封闭形式，而非数值近似值。将您的最终答案以一个单行矩阵的形式报告，其中包含按升序排列的四个特征值，后面是按相同顺序排列的四个对应的残差范数。无需单位，也不允许四舍五入。",
            "solution": "本问题要求推导兰佐斯 (Lanczos) 残差范数，并针对从一个特定的 $4 \\times 4$ 三对角矩阵 $T_4$ 中找到的里兹 (Ritz) 对进行求值。\n\n首先，我们推导里兹 (Ritz) 对残差范数的一般表达式。兰佐斯 (Lanczos) 算法通过一个三项递推关系生成一个称为兰佐斯 (Lanczos) 向量的正交归一向量序列 $v_j$。该递推关系通过将哈密顿量 $H$ 应用于每个向量 $v_j$ 并将结果与前两个向量正交化来定义。对于一个实对称哈密顿量 $H$，该递推关系为：\n$$Hv_j = \\beta_{j-1}v_{j-1} + \\alpha_j v_j + \\beta_j v_{j+1}$$\n其中 $v_0=0$，$v_1$ 是一个选定的归一化初始向量，系数 $\\alpha_j$ 和 $\\beta_j$ 由下式给出：\n$$\\alpha_j = v_j^T H v_j$$\n$$\\beta_j = \\| H v_j - \\alpha_j v_j - \\beta_{j-1}v_{j-1} \\|$$\n经过 $k$ 步后，此过程生成一个正交归一基 $Q_k = [v_1, v_2, \\dots, v_k]$ 和一个对角线元素为 $\\alpha_j$、非对角线元素为 $\\beta_j$ 的实对称三对角矩阵 $T_k$。该递推关系可以写成矩阵形式：\n$$HQ_k = Q_k T_k + r_k e_k^T$$\n其中 $r_k = \\beta_k v_{k+1}$ 是 $k$ 步兰佐斯 (Lanczos) 过程的残差向量，而 $e_k$ 是 $\\mathbb{R}^k$ 中的第 $k$ 个标准基向量，即 $e_k = (0, \\dots, 0, 1)^T$。\n\n一个里兹 (Ritz) 对 $(\\lambda, x)$ 是 $H$ 的一个特征对的近似。它是通过对角化投影矩阵 $T_k$ 得到的：\n$$T_k y = \\lambda y$$\n其中 $y$ 是 $T_k$ 的一个归一化特征向量，而 $\\lambda$ 是对应的特征值（里兹值）。里兹 (Ritz) 向量 $x$ 是将 $y$ 投影回全希尔伯特空间的结果：\n$$x = Q_k y$$\n里兹 (Ritz) 对 $(\\lambda, x)$ 的残差定义为 $R = Hx - \\lambda x$。我们要求解其范数 $\\|R\\|$。代入 $x$ 和 $HQ_k$ 的表达式：\n$$R = H(Q_k y) - \\lambda(Q_k y) = (HQ_k)y - Q_k(\\lambda y)$$\n$$R = (Q_k T_k + r_k e_k^T)y - Q_k(T_k y)$$\n使用 $T_k y = \\lambda y$，第二项变为 $Q_k(\\lambda y)$。由于矩阵乘法满足结合律，这等于 $Q_k T_k y$。\n$$R = Q_k T_k y + r_k e_k^T y - Q_k T_k y = r_k e_k^T y$$\n代入 $r_k = \\beta_k v_{k+1}$：\n$$R = (\\beta_k v_{k+1}) (e_k^T y)$$\n项 $e_k^T y$ 是 $e_k$ 和 $y$ 的标量积，它提取了向量 $y$ 的第 $k$ 个分量，记为 $y_k$。\n$$R = \\beta_k y_k v_{k+1}$$\n那么残差的范数是：\n$$\\|R\\| = \\|\\beta_k y_k v_{k+1}\\| = |\\beta_k| |y_k| \\|v_{k+1}\\|$$\n由于兰佐斯 (Lanczos) 向量是正交归一的，所以 $\\|v_{k+1}\\|=1$。因此，残差范数由下式给出：\n$$\\|R\\| = |\\beta_k| |y_k|$$\n对于本问题，$k=4$，所以给定里兹 (Ritz) 对的残差范数为 $\\|R\\| = |\\beta_4| |y_4|$。\n\n接下来，我们必须找到给定矩阵 $T_4$ 的特征值和特征向量：\n$$T_4 = \\begin{pmatrix} 0  1  0  0 \\\\ 1  0  1  0 \\\\ 0  1  0  1 \\\\ 0  0  1  0 \\end{pmatrix}$$\n特征多项式是 $P(\\lambda) = \\det(T_4 - \\lambda I)$：\n$$P(\\lambda) = \\det \\begin{pmatrix} -\\lambda  1  0  0 \\\\ 1  -\\lambda  1  0 \\\\ 0  1  -\\lambda  1 \\\\ 0  0  1  -\\lambda \\end{pmatrix}$$\n沿第一行展开：\n$$P(\\lambda) = -\\lambda \\det \\begin{pmatrix} -\\lambda  1  0 \\\\ 1  -\\lambda  1 \\\\ 0  1  -\\lambda \\end{pmatrix} - 1 \\det \\begin{pmatrix} 1  1  0 \\\\ 0  -\\lambda  1 \\\\ 0  1  -\\lambda \\end{pmatrix}$$\n$$P(\\lambda) = -\\lambda(-\\lambda(\\lambda^2-1) - 1(-\\lambda)) - 1(1(\\lambda^2-1))$$\n$$P(\\lambda) = -\\lambda(-\\lambda^3 + 2\\lambda) - (\\lambda^2-1) = \\lambda^4 - 2\\lambda^2 - \\lambda^2 + 1 = \\lambda^4 - 3\\lambda^2 + 1$$\n令 $u = \\lambda^2$。特征方程变为关于 $u$ 的二次方程：$u^2 - 3u + 1 = 0$。\n$u$ 的解是：\n$$u = \\frac{3 \\pm \\sqrt{9-4}}{2} = \\frac{3 \\pm \\sqrt{5}}{2}$$\n所以，$\\lambda^2 = \\frac{3 + \\sqrt{5}}{2}$ 或 $\\lambda^2 = \\frac{3 - \\sqrt{5}}{2}$。\n这些值与黄金比例 $\\phi = \\frac{1+\\sqrt{5}}{2}$ 的平方有关。具体来说，$\\phi^2 = \\frac{3+\\sqrt{5}}{2}$ 且 $(1/\\phi)^2 = (\\frac{\\sqrt{5}-1}{2})^2 = \\frac{3-\\sqrt{5}}{2}$。\n四个特征值是 $\\lambda = \\pm \\phi$ 和 $\\lambda = \\pm 1/\\phi$。\n按升序排列，特征值 $\\lambda_1, \\lambda_2, \\lambda_3, \\lambda_4$ 是：\n$$\\lambda_1 = -\\frac{1+\\sqrt{5}}{2}, \\quad \\lambda_2 = -\\frac{\\sqrt{5}-1}{2} = \\frac{1-\\sqrt{5}}{2}, \\quad \\lambda_3 = \\frac{\\sqrt{5}-1}{2}, \\quad \\lambda_4 = \\frac{1+\\sqrt{5}}{2}$$\n\n现在我们求对应的归一化特征向量 $y$。对于一个特征值 $\\lambda$，其特征向量 $y=(y_1, y_2, y_3, y_4)^T$ 满足 $(T_4-\\lambda I)y=0$。该方程组对于 $j=1,2,3$ 产生递推关系 $y_{j+1} = \\lambda y_j - y_{j-1}$，初始条件为 $y_0=0$ 和 $y_2=\\lambda y_1$。第四个方程 $y_3 - \\lambda y_4 = 0$ 意味着 $y_5 = \\lambda y_4 - y_3 = 0$。未归一化的特征向量的形式是 $y_j = \\sin(j \\theta)$，其中 $\\lambda = 2\\cos\\theta$，边界条件 $y_5=0$ 意味着 $5\\theta = m\\pi$ (其中 $m=1,2,3,4$)。这又导出了我们已经找到的特征值。\n对于一个特征值 $\\lambda$，未归一化特征向量的分量与 $(1, \\lambda, \\lambda^2-1, \\lambda^3-2\\lambda)^T$ 成正比。\n该向量的范数平方为 $S(\\lambda) = 1^2 + \\lambda^2 + (\\lambda^2-1)^2 + (\\lambda^3-2\\lambda)^2$。使用 $\\lambda^4 = 3\\lambda^2 - 1$，这可以简化为 $S(\\lambda) = 2\\lambda^2+2$。\n给定特征向量的归一化常数为 $1/\\sqrt{2\\lambda^2+2}$。\n归一化特征向量的第四个分量是 $y_4 = \\frac{\\lambda^3-2\\lambda}{\\sqrt{2\\lambda^2+2}}$。从方程组可得 $y_4 = y_3/\\lambda = (\\lambda^2-1)y_1/\\lambda$。若设 $y_1=1$, 则 $y_4 = \\lambda-1/\\lambda$。因此， $|y_4|_{norm} = \\frac{|\\lambda-1/\\lambda|}{\\sqrt{2\\lambda^2+2}}$。\n\n对于极值特征值 $\\lambda_1 = -\\phi$ 和 $\\lambda_4 = \\phi$，我们有 $\\lambda^2 = \\phi^2 = \\frac{3+\\sqrt{5}}{2}$。\n$|\\lambda - 1/\\lambda| = |\\pm\\phi - (\\pm 1/\\phi)| = |\\phi-1/\\phi| = 1$。\n范数平方为 $S = 2\\phi^2+2 = 2(\\frac{3+\\sqrt{5}}{2})+2 = 3+\\sqrt{5}+2 = 5+\\sqrt{5}$。\n所以，对于这两个特征值， $|y_4| = \\frac{1}{\\sqrt{5+\\sqrt{5}}}$。\n残差范数为 $\\|R\\| = |\\beta_4||y_4| = \\frac{1}{100} \\frac{1}{\\sqrt{5+\\sqrt{5}}}$。\n\n对于内部特征值 $\\lambda_2 = -1/\\phi$ 和 $\\lambda_3 = 1/\\phi$，我们有 $\\lambda^2 = (1/\\phi)^2 = \\frac{3-\\sqrt{5}}{2}$。\n$|\\lambda - 1/\\lambda| = |\\pm 1/\\phi - (\\pm\\phi)| = |- (\\phi-1/\\phi)| = 1$。\n范数平方为 $S = 2(1/\\phi)^2+2 = 2(\\frac{3-\\sqrt{5}}{2})+2 = 3-\\sqrt{5}+2 = 5-\\sqrt{5}$。\n所以，对于这两个特征值， $|y_4| = \\frac{1}{\\sqrt{5-\\sqrt{5}}}$。\n残差范数为 $\\|R\\| = |\\beta_4||y_4| = \\frac{1}{100} \\frac{1}{\\sqrt{5-\\sqrt{5}}}$。\n\n最终结果按特征值升序排列。\n特征值：\n$\\lambda_1 = -\\frac{1+\\sqrt{5}}{2}$\n$\\lambda_2 = \\frac{1-\\sqrt{5}}{2}$\n$\\lambda_3 = \\frac{\\sqrt{5}-1}{2}$\n$\\lambda_4 = \\frac{1+\\sqrt{5}}{2}$\n\n对应的残差范数：\n对于 $\\lambda_1$: $R_1 = \\frac{1}{100\\sqrt{5+\\sqrt{5}}}$\n对于 $\\lambda_2$: $R_2 = \\frac{1}{100\\sqrt{5-\\sqrt{5}}}$\n对于 $\\lambda_3$: $R_3 = \\frac{1}{100\\sqrt{5-\\sqrt{5}}}$\n对于 $\\lambda_4$: $R_4 = \\frac{1}{100\\sqrt{5+\\sqrt{5}}}$\n这些就是所要求的精确封闭形式表达式。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-\\frac{1+\\sqrt{5}}{2}  \\frac{1-\\sqrt{5}}{2}  \\frac{\\sqrt{5}-1}{2}  \\frac{1+\\sqrt{5}}{2}  \\frac{1}{100\\sqrt{5+\\sqrt{5}}}  \\frac{1}{100\\sqrt{5-\\sqrt{5}}}  \\frac{1}{100\\sqrt{5-\\sqrt{5}}}  \\frac{1}{100\\sqrt{5+\\sqrt{5}}}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在实际的壳模型计算中，基矢维度通常非常巨大，以至于无法在内存中存储完整的Lanczos矢量序列，这使得重启（restart）技术的应用成为必需。这个问题模拟了一个真实世界的情景，您必须在计算资源与物理问题的需求之间做出权衡。您将学习如何通过综合考虑所需计算的能态数量、为保证收敛性而设置的“保护带”（guard band）以及可用的内存预算，来确定一个实际可行的重启窗口大小 。",
            "id": "3603169",
            "problem": "考虑在钙核区使用质子-中子 $pf$ 壳价空间（包含单粒子轨道 $0f_{7/2}$、$0f_{5/2}$、$1p_{3/2}$ 和 $1p_{1/2}$）进行的大规模组态相互作用壳模型计算。该多体哈密顿量在 $M$ 方案基下是厄米且稀疏的，并使用带有厚重启策略的 Lanczos 算法进行对角化，以计算 $k$ 个最低的本征态。\n\n假设以下科学上真实的情景和约束条件：\n- 在固定总投影量子数后，工作基的维度为 $N = 2.4 \\times 10^{7}$。\n- 该算法使用双精度存储，因此每个向量分量占用 $8$ 字节。\n- 厚重启在重启时保留 $w$ 个 Ritz 向量，并需要三个额外的全长工作向量用于递推和再正交化。\n- 内存预算 $M_{\\text{vec}} = 20\\,\\mathrm{GB}$ 专门用于存储这些 Lanczos 向量，在此规模下没有其他数组占用内存。\n- 您的目标是计算 $k = 30$ 个最低本征态。\n- 在具有聚集低能谱的典型 $pf$ 壳空间中，为实现厚重启的稳健收敛，需要在目标 $k$ 之外维持一个由 $g = 20$ 个额外 Ritz 向量组成的保护带，以缓冲近简并或紧密聚集的能态。\n\n从 Lanczos Krylov 子空间和厚重启机制的定义出发，并利用基本的存储核算，确定一个与内存预算和预期收敛行为一致的实际重启窗口大小 $w$。最终答案以 $w$ 的整数值表示。请勿在最终答案中包含单位。",
            "solution": "### 解答\n该问题要求确定厚重启 Lanczos 算法的实际重启窗口大小，记为 $w$。该值必须与预期的收敛行为和可用的内存预算都保持一致。\n\n首先，我们根据问题的物理背景，特别是收敛特性，来确定对 $w$ 的要求。目标是计算 $k=30$ 个最低的本征态。在基于 Lanczos 的方法中，尤其是在处理像 $pf$ 壳中常见的稠密或聚集谱时，有必要计算比所需本征态数量更多的 Ritz 向量，以确保其收敛。这通过包含一个“保护带”来管理。问题指定了一个由 $g=20$ 个额外 Ritz 向量组成的保护带。因此，为了确保稳健收敛，在重启过程中应保留的 Ritz 向量数量是所需本征态数量与保护带之和。这就定义了实际的重启窗口大小 $w$：\n$$ w = k + g $$\n代入给定值：\n$$ w = 30 + 20 = 50 $$\n这个值 $w=50$ 代表了由计算的收敛要求决定的重启窗口大小。\n\n接下来，我们必须验证这个选择是否与指定的内存预算一致。Lanczos 向量消耗的总内存不能超过分配的预算 $M_{\\text{vec}} = 20\\,\\mathrm{GB}$。\n\n必须同时保存在内存中的全长向量总数 $n_{\\text{vec}}$，由重启时保留的 $w$ 个 Ritz 向量和算法所需的三个额外工作向量组成。\n$$ n_{\\text{vec}} = w + 3 $$\n对于我们提出的 $w=50$，向量的数量为：\n$$ n_{\\text{vec}} = 50 + 3 = 53 $$\n\n存储单个全长向量所需的内存 $S_{\\text{vec}}$ 由基维度 $N$ 和每个分量的存储大小决定。计算使用双精度，即每个分量 $8$ 字节。\n$$ S_{\\text{vec}} = N \\times (\\text{bytes per component}) $$\n$$ S_{\\text{vec}} = (2.4 \\times 10^{7}) \\times 8\\,\\text{bytes} = 1.92 \\times 10^{8}\\,\\text{bytes} $$\n\n所需的总内存 $M_{\\text{req}}$ 是向量数量与每个向量大小的乘积。\n$$ M_{\\text{req}} = n_{\\text{vec}} \\times S_{\\text{vec}} $$\n$$ M_{\\text{req}} = 53 \\times (1.92 \\times 10^{8}\\,\\text{bytes}) = 101.76 \\times 10^{8}\\,\\text{bytes} = 1.0176 \\times 10^{10}\\,\\text{bytes} $$\n\n现在，必须将此所需内存与可用预算 $M_{\\text{vec}} = 20\\,\\mathrm{GB}$进行比较。我们将使用标准国际单位制（SI）的定义，其中 $1\\,\\mathrm{GB} = 10^{9}\\,\\text{bytes}$。\n$$ M_{\\text{vec}} = 20 \\times 10^{9}\\,\\text{bytes} = 2.0 \\times 10^{10}\\,\\text{bytes} $$\n\n我们现在可以检查 $w=50$ 的内存需求是否在预算范围内：\n$$ M_{\\text{req}} = 1.0176 \\times 10^{10}\\,\\text{bytes} $$\n$$ M_{\\text{vec}} = 2.0 \\times 10^{10}\\,\\text{bytes} $$\n由于 $1.0176 \\times 10^{10}  2.0 \\times 10^{10}$，所需内存远在分配的预算之内。\n\n该问题要求确定一个实际的重启窗口大小 $w$。收敛行为建议 $w=50$。我们的存储核算证实，在给定的内存约束下，这个选择是可行的。因此，重启窗口大小的实际且一致的值是 $w=50$。",
            "answer": "$$\\boxed{50}$$"
        }
    ]
}