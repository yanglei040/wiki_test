{
    "hands_on_practices": [
        {
            "introduction": "To truly understand model space truncations, we must first grasp the concept of an effective Hamiltonian. This exercise guides you through the fundamental derivation in a simple two-level system, demystifying where the energy-dependent interaction comes from. By explicitly comparing the exact result with a truncated, energy-independent approximation, you will gain a concrete understanding of the error introduced by the most basic form of truncation .",
            "id": "3570129",
            "problem": "Consider a two-level toy Hamiltonian in a basis $\\{|p\\rangle, |q\\rangle\\}$ with projection operators $P = |p\\rangle\\langle p|$ and $Q = |q\\rangle\\langle q|$, where $P$ has dimension $1$ and $Q$ has dimension $1$. The full Hamiltonian in this basis is\n$$\nH \\equiv \\begin{pmatrix}\n\\epsilon_{p} & v \\\\\nv & \\epsilon_{q}\n\\end{pmatrix},\n$$\nwith parameters $\\epsilon_{p} = 0\\,\\mathrm{MeV}$, $\\epsilon_{q} = 10\\,\\mathrm{MeV}$, and $v = 2\\,\\mathrm{MeV}$. Starting from the time-independent Schrödinger equation $H|\\Psi\\rangle = E|\\Psi\\rangle$ and the fundamental projection operator identities $P + Q = \\mathbb{1}$, $P^{2} = P$, $Q^{2} = Q$, and $PQ = QP = 0$, derive the energy-dependent effective Hamiltonian $H_{\\text{eff}}(E)$ acting in the $P$-space that reproduces the exact $P$-space component of the eigenvalue problem. Use this $H_{\\text{eff}}(E)$ to obtain the corresponding $P$-space eigenvalue associated with the lower-energy exact solution.\n\nThen, to illustrate the effect of truncation, define a truncated, energy-independent $P$-space Hamiltonian by replacing the energy $E$ in $H_{\\text{eff}}(E)$ with the unperturbed $P$-space energy $\\epsilon_{p}$, and compute the approximate truncated $P$-space eigenvalue. Compare the exact lower eigenvalue of the full Hamiltonian with this truncated $P$-space eigenvalue by computing the absolute difference between them.\n\nExpress the final absolute difference in mega-electronvolts (MeV). Round your answer to six significant figures.",
            "solution": "The problem requires the derivation of an energy-dependent effective Hamiltonian, its application to find an exact eigenvalue, the calculation of an approximate eigenvalue from a truncated version of this Hamiltonian, and finally, the computation of the absolute difference between these two eigenvalues.\n\nFirst, we validate the problem statement.\n\n### Step 1: Extract Givens\n- Basis: $\\{|p\\rangle, |q\\rangle\\}$.\n- Projection operators: $P = |p\\rangle\\langle p|$, $Q = |q\\rangle\\langle q|$.\n- Dimension of $P$-space: $1$.\n- Dimension of $Q$-space: $1$.\n- Full Hamiltonian matrix: $H \\equiv \\begin{pmatrix} \\epsilon_{p} & v \\\\ v & \\epsilon_{q} \\end{pmatrix}$.\n- Hamiltonian parameters: $\\epsilon_{p} = 0\\,\\mathrm{MeV}$, $\\epsilon_{q} = 10\\,\\mathrm{MeV}$, $v = 2\\,\\mathrm{MeV}$.\n- Governing equation: Time-independent Schrödinger equation, $H|\\Psi\\rangle = E|\\Psi\\rangle$.\n- Projection operator identities: $P + Q = \\mathbb{1}$, $P^2 = P$, $Q^2 = Q$, $PQ = QP = 0$.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded:** The problem is based on the well-established Feshbach projection formalism used to derive effective Hamiltonians in quantum mechanics and many-body theory, particularly in nuclear physics. It is a standard textbook example.\n- **Well-Posed:** The problem is clearly stated, provides all necessary data, and asks for a specific, computable result. A unique solution exists.\n- **Objective:** The language is formal and unambiguous.\n\n### Step 3: Verdict and Action\nThe problem is valid. We proceed with the solution.\n\nThe starting point is the time-independent Schrödinger equation for a state $|\\Psi\\rangle$ with energy eigenvalue $E$:\n$$H|\\Psi\\rangle = E|\\Psi\\rangle$$\nWe use the completeness relation $\\mathbb{1} = P+Q$ to decompose the state vector $|\\Psi\\rangle$ into its components in the $P$-space and the $Q$-space: $|\\Psi\\rangle = \\mathbb{1}|\\Psi\\rangle = (P+Q)|\\Psi\\rangle = P|\\Psi\\rangle + Q|\\Psi\\rangle$. Let's denote $|\\Psi_P\\rangle = P|\\Psi\\rangle$ and $|\\Psi_Q\\rangle = Q|\\Psi\\rangle$.\n\nWe can write the Schrödinger equation as two coupled equations by projecting onto the $P$ and $Q$ subspaces:\n$$\nP(H(P+Q)|\\Psi\\rangle) = E(P|\\Psi\\rangle) \\implies PHP|\\Psi_P\\rangle + PHQ|\\Psi_Q\\rangle = E|\\Psi_P\\rangle\n$$\n$$\nQ(H(P+Q)|\\Psi\\rangle) = E(Q|\\Psi\\rangle) \\implies QHP|\\Psi_P\\rangle + QHQ|\\Psi_Q\\rangle = E|\\Psi_Q\\rangle\n$$\nFrom the second equation, we solve for $|\\Psi_Q\\rangle$:\n$$\n(E\\mathbb{1}_Q - QHQ)|\\Psi_Q\\rangle = QHP|\\Psi_P\\rangle\n$$\n$$\n|\\Psi_Q\\rangle = (E\\mathbb{1}_Q - QHQ)^{-1} QHP|\\Psi_P\\rangle\n$$\nHere, $\\mathbb{1}_Q$ is the identity operator in the $Q$-space. The inverse $(E\\mathbb{1}_Q - QHQ)^{-1}$ is well-defined as long as $E$ is not an eigenvalue of the $Q$-space Hamiltonian $QHQ$.\n\nNext, we substitute this expression for $|\\Psi_Q\\rangle$ back into the first equation:\n$$\nPHP|\\Psi_P\\rangle + PHQ\\left((E\\mathbb{1}_Q - QHQ)^{-1} QHP\\right)|\\Psi_P\\rangle = E|\\Psi_P\\rangle\n$$\nThis can be written as an effective eigenvalue problem entirely within the $P$-space:\n$$\nH_{\\text{eff}}(E)|\\Psi_P\\rangle = E|\\Psi_P\\rangle\n$$\nwhere the energy-dependent effective Hamiltonian, $H_{\\text{eff}}(E)$, is defined as:\n$$\nH_{\\text{eff}}(E) = PHP + PHQ(E\\mathbb{1}_Q - QHQ)^{-1}QHP\n$$\nIn the provided basis, the $P$-space is spanned by $|p\\rangle$ and the $Q$-space by $|q\\rangle$. The operators become scalars (or $1 \\times 1$ matrices):\n- $PHP \\to \\langle p|H|p\\rangle = \\epsilon_p$\n- $QHQ \\to \\langle q|H|q\\rangle = \\epsilon_q$\n- $PHQ \\to \\langle p|H|q\\rangle = v$\n- $QHP \\to \\langle q|H|p\\rangle = v$\n\nThus, the scalar form of the effective Hamiltonian is:\n$$\nH_{\\text{eff}}(E) = \\epsilon_p + v \\frac{1}{E - \\epsilon_q} v = \\epsilon_p + \\frac{v^2}{E - \\epsilon_q}\n$$\nThe exact eigenvalues of the full Hamiltonian $H$ are the values of $E$ that satisfy the self-consistent condition $H_{\\text{eff}}(E) = E$:\n$$\nE = \\epsilon_p + \\frac{v^2}{E - \\epsilon_q}\n$$\nRearranging this equation gives a quadratic equation for $E$:\n$$\nE(E - \\epsilon_q) = \\epsilon_p(E - \\epsilon_q) + v^2\n$$\n$$\nE^2 - E\\epsilon_q - E\\epsilon_p + \\epsilon_p\\epsilon_q - v^2 = 0\n$$\n$$\nE^2 - (\\epsilon_p + \\epsilon_q)E + (\\epsilon_p\\epsilon_q - v^2) = 0\n$$\nThis is the characteristic equation of the original matrix $H$. We solve for $E$ using the quadratic formula:\n$$\nE = \\frac{(\\epsilon_p + \\epsilon_q) \\pm \\sqrt{(\\epsilon_p + \\epsilon_q)^2 - 4(\\epsilon_p\\epsilon_q - v^2)}}{2} = \\frac{\\epsilon_p + \\epsilon_q}{2} \\pm \\frac{\\sqrt{(\\epsilon_p - \\epsilon_q)^2 + 4v^2}}{2}\n$$\nThe problem asks for the eigenvalue associated with the lower-energy solution, which we denote $E_{\\text{exact,low}}$:\n$$\nE_{\\text{exact,low}} = \\frac{\\epsilon_p + \\epsilon_q}{2} - \\frac{1}{2}\\sqrt{(\\epsilon_p - \\epsilon_q)^2 + 4v^2}\n$$\nSubstituting the given values $\\epsilon_p = 0\\,\\mathrm{MeV}$, $\\epsilon_q = 10\\,\\mathrm{MeV}$, and $v = 2\\,\\mathrm{MeV}$:\n$$\nE_{\\text{exact,low}} = \\frac{0 + 10}{2} - \\frac{1}{2}\\sqrt{(0 - 10)^2 + 4(2^2)} = 5 - \\frac{1}{2}\\sqrt{100 + 16} = 5 - \\frac{\\sqrt{116}}{2}\n$$\nSince $\\sqrt{116} = \\sqrt{4 \\times 29} = 2\\sqrt{29}$, we have:\n$$\nE_{\\text{exact,low}} = 5 - \\sqrt{29}\\,\\mathrm{MeV}\n$$\nNext, we define the truncated, energy-independent Hamiltonian $H_{\\text{trunc}}$ by replacing $E$ in the denominator of $H_{\\text{eff}}(E)$ with the unperturbed $P$-space energy, $\\omega = \\epsilon_p$.\n$$\nH_{\\text{trunc}} = H_{\\text{eff}}(E=\\epsilon_p) = \\epsilon_p + \\frac{v^2}{\\epsilon_p - \\epsilon_q}\n$$\nThe eigenvalue of this truncated Hamiltonian, $E_{\\text{trunc}}$, is simply its scalar value:\n$$\nE_{\\text{trunc}} = \\epsilon_p + \\frac{v^2}{\\epsilon_p - \\epsilon_q}\n$$\nThis corresponds to the second-order perturbation theory correction to the energy $\\epsilon_p$. Substituting the given values:\n$$\nE_{\\text{trunc}} = 0 + \\frac{2^2}{0 - 10} = \\frac{4}{-10} = -0.4\\,\\mathrm{MeV}\n$$\nFinally, we compute the absolute difference $\\Delta E$ between the exact lower eigenvalue and the truncated eigenvalue:\n$$\n\\Delta E = |E_{\\text{exact,low}} - E_{\\text{trunc}}| = |(5 - \\sqrt{29}) - (-0.4)| = |5.4 - \\sqrt{29}|\\,\\mathrm{MeV}\n$$\nTo obtain the numerical value, we use $\\sqrt{29} \\approx 5.385164807$.\n$$\n\\Delta E = |5.4 - 5.385164807| = 0.014835193\\,\\mathrm{MeV}\n$$\nRounding this result to six significant figures gives $0.0148352$.",
            "answer": "$$\n\\boxed{0.0148352}\n$$"
        },
        {
            "introduction": "Moving from theory to practice, we confront a common artifact of truncations in nuclear many-body calculations: spurious center-of-mass (CM) motion. When using a harmonic oscillator basis, a naive truncation can break the factorization of the wavefunction, causing the nucleus to spuriously \"slosh around\" within the computational box. This exercise tasks you with deriving and implementing a standard diagnostic to quantify this contamination, providing a crucial tool for assessing the quality of computational results .",
            "id": "3570101",
            "problem": "A translationally invariant nuclear many-body Hamiltonian built in a single-particle Harmonic Oscillator (HO) basis has a natural separation into intrinsic and center-of-mass (CM) motion when the model space is complete with respect to total HO quanta. In a truncated model space that does not preserve this completeness, eigenstates may acquire admixtures of CM excitations, producing spurious contributions. A well-defined diagnostic can be constructed using the expectation value of the CM Hamiltonian to quantify the degree of CM contamination in both ground and excited states obtained from truncated calculations. The goal is to derive, implement, and test such a diagnostic starting from first principles.\n\nFundamental basis and definitions:\n- Consider a system of $A$ nucleons, each of mass $m$, described in a HO single-particle basis of frequency $\\Omega$, with reduced Planck constant $\\hbar$. The CM position and momentum operators are $\\mathbf{R}_{\\text{cm}} = \\frac{1}{A}\\sum_{i=1}^{A} \\mathbf{r}_i$ and $\\mathbf{P}_{\\text{cm}} = \\sum_{i=1}^{A} \\mathbf{p}_i$, respectively.\n- The CM Hamiltonian is\n$$\nH_{\\text{cm}} = \\frac{\\mathbf{P}_{\\text{cm}}^2}{2 A m} + \\frac{1}{2} A m \\Omega^2 \\mathbf{R}_{\\text{cm}}^2,\n$$\nwhose spectrum in $d$ spatial dimensions is that of a $d$-dimensional HO:\n$$\nE_{\\text{cm}}(n) = \\left(n + \\frac{d}{2}\\right)\\hbar \\Omega, \\quad n \\in \\{0,1,2,\\dots\\}.\n$$\n- For a translationally invariant intrinsic Hamiltonian $H_{\\text{int}}$ that depends only on relative coordinates and momenta, one has $[H_{\\text{int}}, H_{\\text{cm}}]=0$ in a complete HO space. Physical eigenstates then factorize as a CM Gaussian ground state times an intrinsic state, yielding the CM ground-state expectation value $\\langle H_{\\text{cm}}\\rangle = \\frac{d}{2}\\hbar \\Omega$ independent of the intrinsic excitation. In truncated spaces that do not preserve CM-invariance of total quanta, this factorization may be broken.\n\nTask:\n- Starting from the definitions above and the orthonormality of HO eigenstates, derive a dimensionless diagnostic that quantifies CM contamination of a computed eigenstate in terms of its CM excitations. The diagnostic must:\n  1. Be a nonnegative scalar that equals $0$ for perfectly factorized states with CM in the HO ground state.\n  2. Increase monotonically with the admixture of CM excitations.\n  3. Be computable from the probabilities $\\{p_n\\}_{n=0}^{N}$ of finding the CM in HO quanta $n$ extracted from the (truncated) eigenstate, with $\\sum_{n=0}^{N} p_n = 1$ after normalization.\n- Implement an algorithm that, given $d$, $\\hbar \\Omega$ (expressed in megaelectronvolts, abbreviated MeV), and a finite list of nonnegative weights $\\{p_n\\}_{n=0}^{N}$ (not necessarily normalized), returns:\n  1. The CM expectation value $\\langle H_{\\text{cm}}\\rangle$ in MeV.\n  2. The dimensionless contamination diagnostic defined as item $1$ of this task normalized by $\\hbar \\Omega$ so that it is unitless.\n  3. A boolean flag indicating whether the contamination is acceptable for practical purposes, where you must adopt the threshold $\\tau = 0.05$ for acceptability.\n- You must renormalize $\\{p_n\\}$ to satisfy $\\sum_n p_n = 1$ if the provided weights do not already sum to $1$. If $\\sum_n p_n = 0$, treat the input as invalid.\n\nScientific realism and constraints:\n- Assume $d = 3$ spatial dimensions, consistent with physical nuclei.\n- The diagnostic should apply equally to ground and excited intrinsic states; a purely intrinsic excitation without CM excitation is not contaminated and should produce the same CM expectation value as the ground state.\n- Express all energy outputs for $\\langle H_{\\text{cm}}\\rangle$ in MeV, rounded to $6$ decimal places. Express the diagnostic as a decimal rounded to $6$ decimal places. The boolean flag must be exact.\n\nTest suite:\nEvaluate the algorithm for the following parameter sets, which collectively test the happy path, boundary conditions, and edge cases. For each case, use $d=3$ and the specified $\\hbar\\Omega$ and CM weight list $\\{p_n\\}$:\n- Case $1$ (complete decoupling, ground state): $\\hbar\\Omega = 20$ MeV, $p_0 = 1.0$.\n- Case $2$ (mild contamination, ground state): $\\hbar\\Omega = 20$ MeV, $p_0 = 0.9$, $p_1 = 0.1$.\n- Case $3$ (moderate contamination, excited intrinsic state): $\\hbar\\Omega = 14$ MeV, $p_0 = 0.7$, $p_2 = 0.3$.\n- Case $4$ (unnormalized input, boundary check): $\\hbar\\Omega = 20$ MeV, $p_0 = 0.95$, $p_1 = 0.10$.\n- Case $5$ (equal mixture of CM ground and first excited quanta): $\\hbar\\Omega = 20$ MeV, $p_0 = 0.5$, $p_1 = 0.5$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated Python-style list of lists. Each inner list must be ordered as $[\\langle H_{\\text{cm}}\\rangle~\\text{(MeV)}, \\text{diagnostic}, \\text{boolean}]$, for the test cases in the order given above. For example, a valid output format is\n$[[30.000000,0.000000,True],[\\dots],\\dots]$.",
            "solution": "The problem requires the derivation and implementation of a diagnostic for center-of-mass (CM) contamination in truncated nuclear many-body calculations. The solution proceeds in two stages: first, the derivation of the necessary formulae from first principles; second, the algorithmic implementation for the specified test cases.\n\n**Part 1: Derivation of the Diagnostic and Expectation Value**\n\nA computed eigenstate of a nuclear system from a truncated harmonic oscillator (HO) basis can be viewed as a mixed state with respect to its CM motion. We are given that the probability of finding the CM of the system in the $n$-th excited state of a CM HO Hamiltonian is $p_n$. The set of probabilities $\\{p_n\\}_{n=0}^{N}$ completely characterizes the CM state for the purpose of this analysis. The total probability must be unity, so we enforce the normalization condition $\\sum_{n=0}^{N} p_n = 1$. If the provided weights do not sum to $1$, they must be normalized.\n\nThe CM Hamiltonian is given as:\n$$\nH_{\\text{cm}} = \\frac{\\mathbf{P}_{\\text{cm}}^2}{2 A m} + \\frac{1}{2} A m \\Omega^2 \\mathbf{R}_{\\text{cm}}^2\n$$\nIts energy eigenvalues in $d$ spatial dimensions are:\n$$\nE_{\\text{cm}}(n) = \\left(n + \\frac{d}{2}\\right)\\hbar \\Omega, \\quad n \\in \\{0, 1, 2, \\dots\\}\n$$\nwhere $n$ is the principal quantum number of the CM HO.\n\nThe expectation value of the CM Hamiltonian, $\\langle H_{\\text{cm}}\\rangle$, for a state described by the probabilities $\\{p_n\\}$ is the weighted average of the energy eigenvalues:\n$$\n\\langle H_{\\text{cm}}\\rangle = \\sum_{n=0}^{N} p_n E_{\\text{cm}}(n)\n$$\nSubstituting the expression for $E_{\\text{cm}}(n)$:\n$$\n\\langle H_{\\text{cm}}\\rangle = \\sum_{n=0}^{N} p_n \\left(n + \\frac{d}{2}\\right)\\hbar \\Omega\n$$\nThis can be expanded as:\n$$\n\\langle H_{\\text{cm}}\\rangle = \\hbar \\Omega \\sum_{n=0}^{N} n p_n + \\frac{d}{2}\\hbar \\Omega \\sum_{n=0}^{N} p_n\n$$\nUsing the normalization condition $\\sum_{n=0}^{N} p_n = 1$, the expression simplifies to:\n$$\n\\langle H_{\\text{cm}}\\rangle = \\hbar \\Omega \\left( \\sum_{n=0}^{N} n p_n + \\frac{d}{2} \\right)\n$$\nThis formula allows the computation of the CM energy expectation value given the probabilities $\\{p_n\\}$.\n\nNext, we derive the dimensionless diagnostic for CM contamination. A state is considered free of contamination if its CM motion is purely in the ground state. This corresponds to the probability distribution $p_0=1$ and $p_n=0$ for all $n > 0$. For such a pure state, the CM energy is the ground-state energy, $\\langle H_{\\text{cm}}\\rangle_{\\text{pure}}$:\n$$\n\\langle H_{\\text{cm}}\\rangle_{\\text{pure}} = E_{\\text{cm}}(0) = \\left(0 + \\frac{d}{2}\\right)\\hbar \\Omega = \\frac{d}{2}\\hbar \\Omega\n$$\nContamination is the presence of components with $n>0$. A natural measure of this contamination is the excess energy in the CM motion above its ground-state minimum. We define this excess energy, $\\Delta E_{\\text{cm}}$, as:\n$$\n\\Delta E_{\\text{cm}} = \\langle H_{\\text{cm}}\\rangle - \\langle H_{\\text{cm}}\\rangle_{\\text{pure}}\n$$\nSubstituting the derived expressions:\n$$\n\\Delta E_{\\text{cm}} = \\left[ \\hbar \\Omega \\left( \\sum_{n=0}^{N} n p_n + \\frac{d}{2} \\right) \\right] - \\left[ \\frac{d}{2}\\hbar \\Omega \\right] = \\hbar \\Omega \\sum_{n=0}^{N} n p_n\n$$\nThis quantity, $\\Delta E_{\\text{cm}}$, satisfies the requirements for a contamination measure:\n1.  It is non-negative, since $\\hbar\\Omega > 0$, $n \\ge 0$, and $p_n \\ge 0$.\n2.  It equals $0$ for a pure state where $p_0=1$ and $p_n=0$ for $n>0$, as the sum $\\sum n p_n$ becomes $0$.\n3.  It increases monotonically as probability weight is shifted to higher $n$ states.\n\nThe problem requires a dimensionless diagnostic, which can be obtained by normalizing the excess energy by the characteristic energy scale of the CM excitations, which is $\\hbar\\Omega$. We define the dimensionless diagnostic, denoted $\\mathcal{C}$, as:\n$$\n\\mathcal{C} = \\frac{\\Delta E_{\\text{cm}}}{\\hbar \\Omega} = \\frac{\\hbar \\Omega \\sum_{n=0}^{N} n p_n}{\\hbar \\Omega} = \\sum_{n=0}^{N} n p_n\n$$\nThis diagnostic $\\mathcal{C}$ is simply the expectation value of the CM principal quantum number, $\\langle n \\rangle$. It is a non-negative scalar, is $0$ for a pure CM ground state, and increases with the admixture of excited CM quanta.\n\n**Part 2: Algorithm and Implementation**\n\nThe algorithm to be implemented takes as input the number of dimensions $d$, the HO energy $\\hbar\\Omega$ in MeV, and a list of weights $\\{p_n\\}_{n=0}^{N}$. For this problem, we are given $d=3$.\n\n1.  **Input Processing**: Given the list of weights $\\{p_n\\}$, first compute their sum, $S = \\sum_n p_n$.\n    *   If $S=0$, the input is invalid.\n    *   If $S \\ne 1$, renormalize each weight: $p_n' = p_n / S$. Otherwise, use the weights as is.\n\n2.  **Diagnostic Calculation**: Using the (normalized) weights, compute the dimensionless diagnostic $\\mathcal{C}$:\n    $$\n    \\mathcal{C} = \\sum_{n=0}^{N} n p_n\n    $$\n\n3.  **Expectation Value Calculation**: Compute the CM expectation value $\\langle H_{\\text{cm}}\\rangle$ in MeV using the previously computed $\\mathcal{C}$ and $d=3$:\n    $$\n    \\langle H_{\\text{cm}}\\rangle = \\hbar\\Omega \\left( \\mathcal{C} + \\frac{3}{2} \\right)\n    $$\n\n4.  **Acceptability Check**: Compare the diagnostic $\\mathcal{C}$ against the given threshold $\\tau = 0.05$. The contamination is acceptable if $\\mathcal{C} \\le \\tau$. This yields a boolean flag.\n\n5.  **Output Formatting**:\n    *   The value of $\\langle H_{\\text{cm}}\\rangle$ is rounded to $6$ decimal places.\n    *   The value of $\\mathcal{C}$ is rounded to $6$ decimal places.\n    *   The final result for each test case is a list: $[\\langle H_{\\text{cm}}\\rangle, \\mathcal{C}, \\text{boolean flag}]$.\n\nThis procedure is applied to each test case provided in the problem statement.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives, implements, and tests a diagnostic for center-of-mass (CM)\n    contamination in truncated nuclear model space calculations.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (h_bar_omega in MeV, list of p_n weights)\n    test_cases = [\n        (20.0, [1.0]),                      # Case 1\n        (20.0, [0.9, 0.1]),                 # Case 2\n        (14.0, [0.7, 0.0, 0.3]),            # Case 3\n        (20.0, [0.95, 0.10]),               # Case 4\n        (20.0, [0.5, 0.5])                  # Case 5\n    ]\n    \n    # Static parameters from the problem description\n    d = 3.0\n    acceptability_threshold = 0.05\n\n    results = []\n    for h_bar_omega, p_weights in test_cases:\n        # Convert weights to a numpy array for vectorized operations\n        p_weights_arr = np.array(p_weights, dtype=float)\n        \n        # --- Step 1: Input Processing ---\n        # Calculate the sum of weights\n        s = np.sum(p_weights_arr)\n        \n        # If sum is 0, the input is invalid as per the problem statement.\n        if s == 0:\n            # Although the test suite doesn't include this case,\n            # a robust implementation should handle it.\n            # We will raise an error as the problem implies it's invalid.\n            raise ValueError(f\"Invalid input: sum of p_weights is 0 for case with h_bar_omega={h_bar_omega}\")\n            \n        # Renormalize the weights if their sum is not 1\n        normalized_p = p_weights_arr / s\n        \n        # --- Step 2: Diagnostic Calculation ---\n        # Create an array of quantum numbers n = 0, 1, 2, ...\n        n_vals = np.arange(len(normalized_p))\n        \n        # Calculate the dimensionless diagnostic C = sum(n * p_n)\n        diagnostic_c = np.sum(n_vals * normalized_p)\n        \n        # --- Step 3: Expectation Value Calculation ---\n        # Calculate <H_cm> = h_bar_omega * (C + d / 2.0)\n        h_cm_exp_val = h_bar_omega * (diagnostic_c + d / 2.0)\n        \n        # --- Step 4: Acceptability Check ---\n        # The contamination is acceptable if C <= threshold\n        is_acceptable = diagnostic_c <= acceptability_threshold\n        \n        # --- Step 5: Output Formatting ---\n        # Round energy and diagnostic to 6 decimal places.\n        # Format into a string representation of a list for the final output.\n        formatted_hcm = f\"{h_cm_exp_val:.6f}\"\n        formatted_diag = f\"{diagnostic_c:.6f}\"\n        \n        # The string representation of a boolean in Python is \"True\" or \"False\",\n        # which is the correct format for the output.\n        result_string = f\"[{formatted_hcm},{formatted_diag},{is_acceptable}]\"\n        results.append(result_string)\n\n    # Final print statement in the exact required format.\n    # The output should be a single string that looks like a list of lists.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "The sheer size of the full Hilbert space makes naive truncations impractical for many nuclei, motivating more sophisticated approaches. This practice introduces the powerful concept of importance truncation, a cornerstone of modern *ab initio* methods like the No-Core Shell Model (NCSM). You will implement a prototype that uses a perturbative measure to select the most relevant basis states, allowing you to explore the trade-off between computational cost and the systematic bias introduced by the truncation threshold .",
            "id": "3570124",
            "problem": "You are asked to implement a simplified, self-contained prototype of importance-truncated No-Core Shell Model (IT-NCSM) using second-order Many-Body Perturbation Theory (MBPT) amplitude estimates as the importance measure for selecting basis states. You will work with a toy Hamiltonian that captures the key computational features of a truncated model space in nuclear structure calculations and allows controlled numerical experiments on bias versus full-space results as a function of a threshold parameter. You must also quantify the predictive uncertainty of a bias-versus-threshold model using $K$-fold cross-validation across different harmonic oscillator frequencies $\\hbar\\Omega$.\n\nThe computational setup is as follows.\n\n- Model space: A reference basis state $\\lvert \\Phi_{0} \\rangle$ (index $0$) and a set of excited basis states $\\{ \\lvert \\Phi_{n} \\rangle \\}_{n=1}^{N_{\\max}}$ with non-interacting excitation energies $E_{n}^{(0)} = E_{0}^{(0)} + n \\hbar\\Omega$ where $E_{0}^{(0)} = 0$. The total Hamiltonian is a star-coupled matrix in this basis with the structure\n  $$\n  H_{00} = E_{0}^{(0)} = 0, \\quad H_{nn} = n \\hbar\\Omega \\,\\,\\, \\text{for} \\,\\,\\, 1 \\le n \\le N_{\\max}, \\quad H_{0n} = H_{n0} = V_{n},\n  $$\n  and $H_{nm} = 0$ for $n \\neq m$, $n,m \\ge 1$. The couplings are chosen as $V_{n} = g \\, e^{-\\alpha n} \\sqrt{n}$ with fixed constants $g$ and $\\alpha$.\n\n- Importance measure: From second-order Rayleigh-Schrödinger Many-Body Perturbation Theory (MBPT), the amplitude estimate for the component of $\\lvert \\Psi \\rangle$ in $\\lvert \\Phi_{n} \\rangle$ obtained when starting from the reference state is\n  $$\n  \\kappa_{n} = -\\frac{\\langle \\Phi_{n} \\lvert \\hat{H} \\rvert \\Phi_{0} \\rangle}{E_{n}^{(0)} - E_{0}^{(0)}} = -\\frac{V_{n}}{n \\hbar\\Omega}.\n  $$\n  The importance-truncated space consists of $\\lvert \\Phi_{0} \\rangle$ plus all $\\lvert \\Phi_{n} \\rangle$ with $\\lvert \\kappa_{n} \\rvert \\ge \\kappa_{\\min}$ for a chosen threshold $\\kappa_{\\min}$.\n\n- Variational principle and bias: The ground-state energy $E_{\\text{full}}$ obtained by exact diagonalization of the full Hamiltonian in the complete space of dimension $(N_{\\max}+1)$ is the minimum Rayleigh-Ritz variational value in that space. The ground-state energy $E_{\\text{trunc}}(\\kappa_{\\min})$ obtained by diagonalization in the truncated subspace satisfies $E_{\\text{trunc}}(\\kappa_{\\min}) \\ge E_{\\text{full}}$, and the bias is defined as\n  $$\n  \\Delta E(\\kappa_{\\min}) = E_{\\text{trunc}}(\\kappa_{\\min}) - E_{\\text{full}} \\ge 0.\n  $$\n\n- Uncertainty quantification via cross-validation: To quantify the predictive uncertainty of a simple regression model for $\\Delta E(\\kappa_{\\min})$ across $\\hbar\\Omega$ values, use $K$-fold cross-validation over a discrete set of $\\hbar\\Omega$ values. In each fold, with one $\\hbar\\Omega$ value held-out as validation data, fit a polynomial regression of degree $2$ that maps $\\kappa_{\\min}$ to the average bias across the training $\\hbar\\Omega$ values, then evaluate the root-mean-square error (RMSE) of predicted versus actual bias across the $\\kappa_{\\min}$ grid on the held-out $\\hbar\\Omega$. Average the RMSE across folds to obtain a single uncertainty metric.\n\nYou must derive all steps you implement from the Schrödinger equation, the Rayleigh-Ritz variational principle, and second-order Rayleigh-Schrödinger Many-Body Perturbation Theory. The numerical problem below is fully specified and requires your program to produce deterministic results.\n\nConstants and parameters for this problem:\n\n- Use $N_{\\max} = 12$, $g = -8.0$ $\\mathrm{MeV}$, $\\alpha = 0.3$ (dimensionless), and the list of oscillator frequencies $\\hbar\\Omega \\in \\{ 10, 12, 14, 16 \\}$ $\\mathrm{MeV}$.\n\n- Build the $(N_{\\max}+1)\\times(N_{\\max}+1)$ Hamiltonian as defined above for each $\\hbar\\Omega$.\n\n- For a given $\\kappa_{\\min}$, compute the importance-truncated subspace by including the reference state and all excited states with $\\lvert \\kappa_{n} \\rvert \\ge \\kappa_{\\min}$, and then diagonalize the truncated Hamiltonian to obtain $E_{\\text{trunc}}(\\kappa_{\\min})$.\n\n- Compute the bias $\\Delta E(\\kappa_{\\min})$ in $\\mathrm{MeV}$.\n\n- For cross-validation, set $K = 4$ folds corresponding to leaving out one $\\hbar\\Omega$ at a time from $\\{ 10, 12, 14, 16 \\}$ $\\mathrm{MeV}$. On each training set, fit a degree-$2$ polynomial $p(\\kappa_{\\min})$ to the average bias across the training $\\hbar\\Omega$ values at the grid $\\kappa_{\\min} \\in \\{ 0.05, 0.10, 0.50, 1.00 \\}$ (dimensionless). Then, on the held-out $\\hbar\\Omega$, compute the RMSE between $p(\\kappa_{\\min})$ and the actual $\\Delta E(\\kappa_{\\min})$ evaluated at the same $\\kappa_{\\min}$ grid. Average the RMSE across folds to obtain a single float (in $\\mathrm{MeV}$) as the uncertainty metric.\n\nTest suite and required outputs:\n\n- You must implement the above algorithm and compute the following five results, all derived from the specified constants and procedures:\n\n  1. The bias $\\Delta E(\\kappa_{\\min})$ in $\\mathrm{MeV}$ for $\\hbar\\Omega = 14$ $\\mathrm{MeV}$ at $\\kappa_{\\min} = 0.10$.\n\n  2. The bias $\\Delta E(\\kappa_{\\min})$ in $\\mathrm{MeV}$ for $\\hbar\\Omega = 12$ $\\mathrm{MeV}$ at $\\kappa_{\\min} = 0.00$. This is the boundary case where the truncated space equals the full space; the correct value is expected to be numerically equal to $0$ (within machine precision it should evaluate exactly to $0.0$ in this model).\n\n  3. The bias $\\Delta E(\\kappa_{\\min})$ in $\\mathrm{MeV}$ for $\\hbar\\Omega = 16$ $\\mathrm{MeV}$ at $\\kappa_{\\min} = 1.00$.\n\n  4. A boolean indicating whether, for $\\hbar\\Omega = 10$ $\\mathrm{MeV}$, the sequence $\\{ \\Delta E(\\kappa_{\\min}) \\}$ is non-decreasing when $\\kappa_{\\min}$ ranges over the grid $\\{ 0.00, 0.05, 0.10, 0.50, 1.00 \\}$. This tests the monotonicity implied by the Rayleigh-Ritz variational principle under nested subspaces.\n\n  5. The cross-validated uncertainty metric: the averaged $K$-fold RMSE in $\\mathrm{MeV}$ as defined above.\n\n- Final output format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets with no spaces, in the order specified above, for example, $[r_{1},r_{2},r_{3},r_{4},r_{5}]$, where $r_{1}$, $r_{2}$, and $r_{3}$ are floats in $\\mathrm{MeV}$, $r_{4}$ is a boolean, and $r_{5}$ is a float in $\\mathrm{MeV}$.\n\nAngle units are not applicable. All energies must be treated and reported in $\\mathrm{MeV}$. All thresholds $\\kappa_{\\min}$ are dimensionless.\n\nYour final answer must be a complete, runnable program that computes these five outputs from first principles as defined and prints them in the exact required single-line format. No user input is allowed; all values are fixed as specified above.",
            "solution": "We begin from the time-independent Schrödinger equation $\\hat{H} \\lvert \\Psi \\rangle = E \\lvert \\Psi \\rangle$ and the Rayleigh-Ritz variational principle, which guarantees that the ground-state energy obtained by diagonalizing $\\hat{H}$ in any subspace is an upper bound to the exact ground-state energy obtained in the full space. For a set of orthonormal basis states $\\{ \\lvert \\Phi_{i} \\rangle \\}$, building the Hamiltonian matrix $H_{ij} = \\langle \\Phi_{i} \\lvert \\hat{H} \\rvert \\Phi_{j} \\rangle$ and diagonalizing yields approximate eigenvalues $E$ and corresponding eigenvectors, with the lowest eigenvalue serving as a variational approximation to the ground-state energy.\n\nTo connect with the importance-truncation concept, we use the second-order Rayleigh-Schrödinger Many-Body Perturbation Theory (MBPT) amplitude estimate for the component of the exact ground state $\\lvert \\Psi \\rangle$ in an excited configuration $\\lvert \\Phi_{n} \\rangle$ when starting from the reference configuration $\\lvert \\Phi_{0} \\rangle$. For a Hamiltonian with unperturbed energies $E_{n}^{(0)}$ and interaction matrix elements $V_{n} = \\langle \\Phi_{n} \\lvert \\hat{H} \\rvert \\Phi_{0} \\rangle$, the perturbative amplitude is\n$$\n\\kappa_{n} = - \\frac{\\langle \\Phi_{n} \\lvert \\hat{H} \\rvert \\Phi_{0} \\rangle}{E_{n}^{(0)} - E_{0}^{(0)}} = -\\frac{V_{n}}{E_{n}^{(0)} - E_{0}^{(0)}}.\n$$\nIn our toy model, $E_{0}^{(0)} = 0$ and $E_{n}^{(0)} = n \\hbar\\Omega$, so\n$$\n\\kappa_{n} = -\\frac{V_{n}}{n \\hbar\\Omega}, \\quad V_{n} = g \\, e^{-\\alpha n} \\sqrt{n}.\n$$\nThe importance-truncated No-Core Shell Model selects a subspace consisting of the reference state plus those excited basis states with $\\lvert \\kappa_{n} \\rvert \\ge \\kappa_{\\min}$ for a chosen threshold $\\kappa_{\\min}$. This subspace is then used for a Rayleigh-Ritz diagonalization of the Hamiltonian, yielding a truncated ground-state energy $E_{\\text{trunc}}(\\kappa_{\\min})$. The full-space ground-state energy $E_{\\text{full}}$ is obtained by diagonalizing the Hamiltonian in the entire basis with dimension $N_{\\max}+1$.\n\nBy the variational principle, for any nested sequence of subspaces, the ground-state energies satisfy $E_{\\text{trunc}}(\\kappa_{\\min,1}) \\le E_{\\text{trunc}}(\\kappa_{\\min,2})$ whenever the truncated subspace for $\\kappa_{\\min,2}$ is a subset of that for $\\kappa_{\\min,1}$. In our construction, as $\\kappa_{\\min}$ increases, fewer states meet the criterion $\\lvert \\kappa_{n} \\rvert \\ge \\kappa_{\\min}$, so the subspace shrinks monotonically. Consequently,\n$$\n\\Delta E(\\kappa_{\\min}) \\equiv E_{\\text{trunc}}(\\kappa_{\\min}) - E_{\\text{full}} \\ge 0,\n$$\nand $\\Delta E(\\kappa_{\\min})$ is a non-decreasing function of $\\kappa_{\\min}$ along any monotone grid of thresholds. At the boundary $\\kappa_{\\min} = 0$, the truncated space equals the full space, implying $\\Delta E(0) = 0$.\n\nAlgorithmic design:\n\n1. Fix model parameters $N_{\\max} = 12$, $g = -8.0$ $\\mathrm{MeV}$, $\\alpha = 0.3$, and $\\hbar\\Omega \\in \\{ 10, 12, 14, 16 \\}$ $\\mathrm{MeV}$. For each $\\hbar\\Omega$, construct the Hamiltonian matrix $H$ in the basis $\\{ \\lvert \\Phi_{0} \\rangle, \\lvert \\Phi_{1} \\rangle, \\dots, \\lvert \\Phi_{N_{\\max}} \\rangle \\}$:\n   - Set $H_{00} = 0$.\n   - For $n \\in \\{1,\\dots,N_{\\max}\\}$, set $H_{nn} = n \\hbar\\Omega$.\n   - For $n \\in \\{1,\\dots,N_{\\max}\\}$, compute $V_{n} = g \\, e^{-\\alpha n} \\sqrt{n}$ and set $H_{0n} = H_{n0} = V_{n}$.\n   - Set $H_{nm} = 0$ for $n \\neq m$, $n,m \\ge 1$.\n\n2. Compute the full-space ground-state energy $E_{\\text{full}}$ by diagonalizing $H$.\n\n3. For a given $\\kappa_{\\min}$, compute $\\kappa_{n} = -V_{n}/(n \\hbar\\Omega)$ for $n \\in \\{1,\\dots,N_{\\max}\\}$. Form the truncated index set $\\mathcal{I}(\\kappa_{\\min}) = \\{ 0 \\} \\cup \\{ n \\in \\{1,\\dots,N_{\\max}\\} \\, \\lvert \\, \\lvert \\kappa_{n} \\rvert \\ge \\kappa_{\\min} \\}$. Build the submatrix $H^{\\text{(trunc)}}$ by restricting $H$ to rows and columns in $\\mathcal{I}(\\kappa_{\\min})$. Diagonalize $H^{\\text{(trunc)}}$ and take its lowest eigenvalue as $E_{\\text{trunc}}(\\kappa_{\\min})$.\n\n4. The bias is $\\Delta E(\\kappa_{\\min}) = E_{\\text{trunc}}(\\kappa_{\\min}) - E_{\\text{full}}$. This quantity is in $\\mathrm{MeV}$.\n\n5. For uncertainty quantification via cross-validation, set $K = 4$ folds corresponding to leaving out each $\\hbar\\Omega$ in turn. Define the threshold grid for regression as $\\kappa_{\\min} \\in \\{ 0.05, 0.10, 0.50, 1.00 \\}$. In each fold:\n   - For each threshold in the grid, compute $\\Delta E(\\kappa_{\\min})$ on the training set of $\\hbar\\Omega$ values (the three not held out). Average across training $\\hbar\\Omega$ to obtain $\\overline{\\Delta E}(\\kappa_{\\min})$.\n   - Fit a degree-$2$ polynomial $p(\\kappa_{\\min})$ to $(\\kappa_{\\min}, \\overline{\\Delta E}(\\kappa_{\\min}))$ by least squares.\n   - On the held-out $\\hbar\\Omega$, evaluate the actual $\\Delta E(\\kappa_{\\min})$ at the same thresholds and compute the root-mean-square error $\\mathrm{RMSE} = \\sqrt{ \\frac{1}{M} \\sum_{j=1}^{M} \\left( p(\\kappa_{\\min}^{(j)}) - \\Delta E(\\kappa_{\\min}^{(j)}) \\right)^{2} }$ with $M = 4$. Record this RMSE in $\\mathrm{MeV}$.\n   - Average the RMSE values across all $K = 4$ folds to obtain a single uncertainty metric in $\\mathrm{MeV}$.\n\n6. For the monotonicity check at $\\hbar\\Omega = 10$ $\\mathrm{MeV}$ on the threshold grid $\\{ 0.00, 0.05, 0.10, 0.50, 1.00 \\}$, compute the list $\\{ \\Delta E(\\kappa_{\\min}) \\}$ and verify that it is non-decreasing by checking $\\Delta E(\\kappa_{\\min}^{(j+1)}) - \\Delta E(\\kappa_{\\min}^{(j)}) \\ge 0$ for all adjacent pairs.\n\nOutputs:\n\n- Compute and return the following, in order:\n  1. $\\Delta E(0.10)$ for $\\hbar\\Omega = 14$ $\\mathrm{MeV}$.\n  2. $\\Delta E(0.00)$ for $\\hbar\\Omega = 12$ $\\mathrm{MeV}$.\n  3. $\\Delta E(1.00)$ for $\\hbar\\Omega = 16$ $\\mathrm{MeV}$.\n  4. The monotonicity boolean for $\\hbar\\Omega = 10$ $\\mathrm{MeV}$ on $\\kappa_{\\min} \\in \\{ 0.00, 0.05, 0.10, 0.50, 1.00 \\}$.\n  5. The averaged $K$-fold RMSE in $\\mathrm{MeV}$.\n\nThe final program must print a single line in the exact format $[r_{1},r_{2},r_{3},r_{4},r_{5}]$, where $r_{1}$, $r_{2}$, and $r_{3}$ are floats in $\\mathrm{MeV}$, $r_{4}$ is a boolean, and $r_{5}$ is a float in $\\mathrm{MeV}$. No user input is permitted, and all values are as specified.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Execution environment: Python 3.12, numpy 1.23.5, scipy 1.11.4 (not used).\nimport numpy as np\n\ndef build_hamiltonian(hbar_omega, Nmax, g, alpha):\n    \"\"\"\n    Build the (Nmax+1) x (Nmax+1) star-coupled Hamiltonian matrix H.\n    Basis ordering: [ref, n=1, n=2, ..., n=Nmax]\n    H_00 = 0\n    H_nn = n * hbar_omega for n>=1\n    H_0n = H_n0 = V_n = g * exp(-alpha*n) * sqrt(n)\n    All excited-excited off-diagonals are zero.\n    \"\"\"\n    dim = Nmax + 1\n    H = np.zeros((dim, dim), dtype=float)\n    # Diagonals\n    # H[0,0] = 0.0  # already zero\n    for n in range(1, dim):\n        H[n, n] = n * hbar_omega\n        v_n = g * np.exp(-alpha * n) * np.sqrt(n)\n        H[0, n] = v_n\n        H[n, 0] = v_n\n    return H\n\ndef mbpt_kappa_values(hbar_omega, Nmax, g, alpha):\n    \"\"\"\n    Compute second-order MBPT importance amplitudes kappa_n = -V_n / (n*hbar_omega) for n=1..Nmax.\n    \"\"\"\n    kappas = []\n    for n in range(1, Nmax + 1):\n        v_n = g * np.exp(-alpha * n) * np.sqrt(n)\n        denom = n * hbar_omega\n        kappa_n = -v_n / denom\n        kappas.append(kappa_n)\n    return np.array(kappas)\n\ndef truncated_indices(kappas, kappa_min):\n    \"\"\"\n    Determine indices to keep in truncated space.\n    Always include index 0 (reference).\n    Include n where |kappa_n| >= kappa_min.\n    Maps to matrix indices [0, 1..Nmax].\n    \"\"\"\n    kept = [0]\n    for i, kv in enumerate(kappas, start=1):\n        if abs(kv) >= kappa_min:\n            kept.append(i)\n    return np.array(kept, dtype=int)\n\ndef ground_state_energy(H):\n    \"\"\"\n    Compute the smallest eigenvalue (ground-state energy) of symmetric H.\n    \"\"\"\n    evals = np.linalg.eigvalsh(H)\n    return float(evals[0])\n\ndef bias_for(hbar_omega, kappa_min, Nmax, g, alpha):\n    \"\"\"\n    Compute bias DeltaE = E_trunc(kappa_min) - E_full at given hbar_omega.\n    \"\"\"\n    H = build_hamiltonian(hbar_omega, Nmax, g, alpha)\n    E_full = ground_state_energy(H)\n    kappas = mbpt_kappa_values(hbar_omega, Nmax, g, alpha)\n    idx = truncated_indices(kappas, kappa_min)\n    H_trunc = H[np.ix_(idx, idx)]\n    E_trunc = ground_state_energy(H_trunc)\n    return E_trunc - E_full\n\ndef monotone_non_decreasing(values, atol=1e-12):\n    \"\"\"\n    Check if the sequence is non-decreasing within a numerical tolerance.\n    \"\"\"\n    diffs = np.diff(values)\n    return bool(np.all(diffs >= -atol))\n\ndef kfold_cv_rmse(hbar_omegas, kappa_grid, Nmax, g, alpha, poly_degree=2):\n    \"\"\"\n    Perform K-fold (leave-one-omega-out) cross-validation.\n    For each fold:\n      - Train: compute average bias across training omegas at each kappa in kappa_grid\n               and fit a polynomial of given degree mapping kappa -> avg_bias.\n      - Validate: compute RMSE of predicted vs actual bias across kappa_grid on held-out omega.\n    Return the average RMSE across folds.\n    \"\"\"\n    rmses = []\n    for i in range(len(hbar_omegas)):\n        # validation omega\n        omega_val = hbar_omegas[i]\n        # training omegas\n        omegas_train = [hbar_omegas[j] for j in range(len(hbar_omegas)) if j != i]\n        # Compute avg bias over training set for each kappa\n        avg_bias_train = []\n        for kappa in kappa_grid:\n            biases = [bias_for(om, kappa, Nmax, g, alpha) for om in omegas_train]\n            avg_bias_train.append(np.mean(biases))\n        avg_bias_train = np.array(avg_bias_train)\n        # Fit polynomial p(kappa) to (kappa_grid, avg_bias_train)\n        coeffs = np.polyfit(kappa_grid, avg_bias_train, deg=poly_degree)\n        # Predict on validation omega\n        y_pred = np.polyval(coeffs, kappa_grid)\n        y_true = np.array([bias_for(omega_val, kappa, Nmax, g, alpha) for kappa in kappa_grid])\n        rmse = float(np.sqrt(np.mean((y_pred - y_true) ** 2)))\n        rmses.append(rmse)\n    return float(np.mean(rmses))\n\ndef solve():\n    # Fixed model parameters\n    Nmax = 12\n    g = -8.0  # MeV\n    alpha = 0.3  # dimensionless\n    hbar_omegas = [10.0, 12.0, 14.0, 16.0]  # MeV\n\n    # Test cases\n    # 1) Bias for hbarOmega=14, kappa_min=0.10\n    r1 = bias_for(14.0, 0.10, Nmax, g, alpha)\n\n    # 2) Bias for hbarOmega=12, kappa_min=0.00 (should be exactly 0.0 in this model)\n    r2 = bias_for(12.0, 0.00, Nmax, g, alpha)\n\n    # 3) Bias for hbarOmega=16, kappa_min=1.00\n    r3 = bias_for(16.0, 1.00, Nmax, g, alpha)\n\n    # 4) Monotonicity boolean for hbarOmega=10, kappas [0.00, 0.05, 0.10, 0.50, 1.00]\n    kappa_grid_mono = [0.00, 0.05, 0.10, 0.50, 1.00]\n    biases_mono = [bias_for(10.0, km, Nmax, g, alpha) for km in kappa_grid_mono]\n    r4 = monotone_non_decreasing(biases_mono)\n\n    # 5) K-fold CV uncertainty: degree-2 polynomial fit, kappa_grid excluding 0.0\n    kappa_grid_cv = [0.05, 0.10, 0.50, 1.00]\n    r5 = kfold_cv_rmse(hbar_omegas, kappa_grid_cv, Nmax, g, alpha, poly_degree=2)\n\n    results = [r1, r2, r3, r4, r5]\n    # Print single-line output in required format without spaces\n    # Ensure booleans and floats are represented naturally\n    print(\"[\" + \",\".join(map(str, results)) + \"]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}