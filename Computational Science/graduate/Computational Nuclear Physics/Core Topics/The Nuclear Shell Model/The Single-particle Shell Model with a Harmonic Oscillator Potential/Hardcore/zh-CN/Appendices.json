{
    "hands_on_practices": [
        {
            "introduction": "掌握任何物理模型的第一步都是理解其基本构成。谐振子壳模型的基础是三维各向同性谐振子势中的单核子量子态。这项练习将通过手动枚举给定主壳层$N$中的所有量子态，来巩固你对径向量子数$n$、轨道角动量$\\ell$和总角动量$j$之间关系的理解。",
            "id": "3607427",
            "problem": "考虑角频率为 $\\omega$ 的三维各向同性谐振子 (3D IHO) 势中核子的单粒子壳模型。谐振子量子数定义为 $N = 2n + \\ell$，其中 $n$ 是径向节点数（一个非负整数），$\\ell$ 是轨道角动量。每个核子具有内禀自旋 $s = \\tfrac{1}{2}$，总角动量 $j$ 由 $\\ell$ 和 $s$ 耦合产生。一个态的空间宇称由 $\\pi = (-1)^{\\ell}$ 决定。对于 $N=2$ 的主壳层，列举出所有允许的 $(n,\\ell,j)$ 态及其宇称。利用角动量耦合和态计数的第一性原理，计算当包含自旋简并时，$N=2$ 壳层中不同单粒子态的总数。将最终答案表示为一个无单位的精确整数。",
            "solution": "出发点是单粒子壳模型中三维各向同性谐振子 (3D IHO) 的结构，其中主壳层量子数是 $N = 2n + \\ell$，且 $n \\in \\{0,1,2,\\dots\\}$，$\\ell \\in \\{0,1,2,\\dots\\}$。对于给定的 $N$，允许的 $(n,\\ell)$ 对是满足 $2n + \\ell = N$ 的那些。空间波函数的宇称由 $\\pi = (-1)^{\\ell}$ 给出。核子带有自旋 $s = \\tfrac{1}{2}$，总角动量 $j$ 是通过角动量耦合得到的，即\n$$\nj \\in \\left\\{\\, \\ell - \\tfrac{1}{2},\\, \\ell + \\tfrac{1}{2} \\,\\right\\},\n$$\n受限于 $j \\ge 0$，且对于 $\\ell=0$ 的特殊情况，只得到 $j=\\tfrac{1}{2}$。每个具有给定 $j$ 的能级由于投影 $m_{j} \\in \\{-j,-j+1,\\dots,j\\}$ 而有 $(2j+1)$ 个磁亚态，并且这 $(2j+1)$ 个态隐含地考虑了自旋简并，因为 $j$ 已经反映了 $\\ell$ 与 $s$ 的耦合。\n\n我们通过求解非负整数解 $2n + \\ell = 2$ 来列举 $N=2$ 时允许的 $(n,\\ell)$：\n- 如果 $\\ell=0$，则 $2n=2 \\Rightarrow n=1$。这给出 $(n,\\ell) = (1,0)$。\n- 如果 $\\ell=1$，则 $2n=1 \\Rightarrow n=\\tfrac{1}{2}$，这是不允许的。\n- 如果 $\\ell=2$，则 $2n=0 \\Rightarrow n=0$。这给出 $(n,\\ell) = (0,2)$。\n- 如果 $\\ell \\ge 3$，则 $\\ell  2$ 导致 $2n = 2 - \\ell  0$，这是不可能的。\n\n因此，对于 $N=2$，唯一允许的对是 $(n,\\ell) = (1,0)$ 和 $(n,\\ell) = (0,2)$。\n\n接下来，确定可能的 $j$ 值和宇称：\n1. 对于 $(n,\\ell) = (1,0)$:\n   - 宇称为 $\\pi = (-1)^{0} = +1$ (正宇称)。\n   - 当 $\\ell=0$ 和 $s=\\tfrac{1}{2}$ 时，唯一的总角动量是 $j = \\tfrac{1}{2}$。\n   - 这个轨道通常标记为 $2s_{1/2}$（其中径向节点数 $n=1$ 表示谐振子中的第二个s波）。\n\n2. 对于 $(n,\\ell) = (0,2)$:\n   - 宇称为 $\\pi = (-1)^{2} = +1$ (正宇称)。\n   - 当 $\\ell=2$ 和 $s=\\tfrac{1}{2}$ 时，允许的总角动量为 $j = \\tfrac{3}{2}$ 和 $j = \\tfrac{5}{2}$。\n   - 这些轨道通常标记为 $1d_{3/2}$ 和 $1d_{5/2}$（其中径向节点数 $n=0$ 表示谐振子中的第一个d波）。\n\n现在我们通过对 $N=2$ 壳层中所有不同 $j$ 值的磁亚态数 $(2j+1)$ 求和，来计算包含自旋简并的单粒子态的数量：\n- 对于 $2s_{1/2}$：$2j+1 = 2 \\cdot \\tfrac{1}{2} + 1 = 2$。\n- 对于 $1d_{3/2}$：$2j+1 = 2 \\cdot \\tfrac{3}{2} + 1 = 4$。\n- 对于 $1d_{5/2}$：$2j+1 = 2 \\cdot \\tfrac{5}{2} + 1 = 6$。\n\n将这些加起来，\n$$\n2 + 4 + 6 = 12.\n$$\n\n作为一个基于三维各向同性谐振子已知结构的一致性检验，第 $N$ 个壳层的空间简并度（不包括自旋）是\n$$\ng_{N}^{\\text{space}} = \\frac{(N+1)(N+2)}{2}.\n$$\n对于 $N=2$，这给出 $g_{2}^{\\text{space}} = \\frac{(3)(4)}{2} = 6$。包含自旋 $\\tfrac{1}{2}$ 的两个自旋投影使这个数字翻倍至 $12$，这与通过显式角动量耦合得到的对 $(2j+1)$ 的求和结果相匹配。\n\n因此，在 $N=2$ 壳层中，包括自旋简并在内的单粒子态总数为 $12$。",
            "answer": "$$\\boxed{12}$$"
        },
        {
            "introduction": "简单的谐振子势能级具有高度的简并，这与实验观测到的原子核能谱不符。为了构建一个更真实的模型，引入关键的自旋-轨道耦合项至关重要。在这个计算实践中，你将亲手实现自旋-轨道相互作用，并通过数值对角化得到精确解，并将其与微扰理论的一阶修正结果进行比较，从而深入理解其物理效应。",
            "id": "3607470",
            "problem": "考虑一个在三维 (3D) 各向同性谐振子势中的自旋-$\\tfrac{1}{2}$ 核子，该模型在单粒子壳模型中进行建模。未微扰哈密顿量由 $H_{0}=\\dfrac{\\mathbf{p}^{2}}{2m}+\\dfrac{1}{2}m\\omega^{2}r^{2}$ 给出，其本征态由径向量子数 $n\\in\\{0,1,2,\\dots\\}$、轨道角动量 $\\ell\\in\\{0,1,2,\\dots\\}$ 及其投影 $m_{\\ell}\\in\\{-\\ell,-\\ell+1,\\dots,\\ell\\}$ 标记。自旋算符对应于自旋 $s=\\tfrac{1}{2}$，其投影为 $m_{s}\\in\\{-\\tfrac{1}{2},\\tfrac{1}{2}\\}$。使用自然单位制，其中 $\\hbar=1$、$m=1$ 和 $\\omega=1$，因此能量以 $\\hbar\\omega$ 为单位表示且无量纲。在这些单位中，未微扰能量为 $E_{0}(n,\\ell)=2n+\\ell+\\tfrac{3}{2}$。\n\n添加一个弱的自旋-轨道相互作用作为微扰 $V_{\\text{so}}=\\lambda\\,\\mathbf{L}\\cdot\\mathbf{S}$，其中 $\\lambda$ 是以 $\\hbar\\omega$ 为单位测量的实标量耦合参数。总哈密顿量为 $H=H_{0}+\\lambda\\,\\mathbf{L}\\cdot\\mathbf{S}$。对于固定的 $(n,\\ell)$，所关注的希尔伯特空间分解为由 $\\{|\\,\\ell,m_{\\ell}\\rangle\\}$ 张成的轨道子空间与由 $\\{|\\,s=\\tfrac{1}{2},m_{s}\\rangle\\}$ 张成的自旋子空间的张量积，总维度为 $2(2\\ell+1)$。\n\n任务：\n- 从第一性原理出发，以标准角动量代数和一级不含时微扰理论为基础，推导具有确定总角动量 $j$ 的态的一阶微扰能量移动 $\\Delta E_{n\\ell j}$ 的解析表达式。当 $\\ell\\ge 1$ 时，$j\\in\\{\\ell-\\tfrac{1}{2},\\ell+\\tfrac{1}{2}\\}$；当 $\\ell=0$ 时，$j=\\tfrac{1}{2}$。不要假定任何预先推导的“快捷”表达式；从角动量算符及其对易关系的核心定义开始。\n- 通过在非耦合基 $\\{|\\,\\ell,m_{\\ell}\\rangle\\otimes|\\,\\tfrac{1}{2},m_{s}\\rangle\\}$ 中，利用升降算符的作用和选择定则，构造 $\\mathbf{L}\\cdot\\mathbf{S}$ 的矩阵，并将 $E_{0}(n,\\ell)$ 加到对角线上，从而实现哈密顿量 $H$ 在 $(n,\\ell)$ 块内的精确数值对角化。具体来说，使用升降算符 $L_{\\pm}$ 和 $S_{\\pm}$ 的恒等式：\n  - $L_{\\pm}|\\,\\ell,m_{\\ell}\\rangle=\\sqrt{\\ell(\\ell+1)-m_{\\ell}(m_{\\ell}\\pm 1)}\\,|\\,\\ell,m_{\\ell}\\pm 1\\rangle$,\n  - $S_{\\pm}|\\,\\tfrac{1}{2},m_{s}\\rangle=\\sqrt{\\tfrac{1}{2}(\\tfrac{1}{2}+1)-m_{s}(m_{s}\\pm 1)}\\,|\\,\\tfrac{1}{2},m_{s}\\pm 1\\rangle$,\n  并在此基中构造 $\\mathbf{L}\\cdot\\mathbf{S}=L_{z}S_{z}+\\tfrac{1}{2}(L_{+}S_{-}+L_{-}S_{+})$。\n- 对于每个指定的参数集 $(n,\\ell,\\lambda)$，计算：\n  - 通过数值对角化得到的 $H$ 的精确本征值的排序列表，以及\n  - 考虑简并度 $2j+1$，对 $(n,\\ell)$ 块中所有态的一阶微扰预测值的排序列表。\n- 对于每个参数集，计算这两个列表之间的最大绝对偏差（作为单个标量），即排序后的能量列表的相应条目之间的最大绝对差值。以 $\\hbar\\omega$ 为单位报告此偏差。\n\n使用以下参数值测试套件来评估不同情况（包括小 $\\lambda$、零分裂、负 $\\lambda$ 和较大耦合）：\n- 案例 1：$(n,\\ell,\\lambda)=(0,1,0.0)$,\n- 案例 2：$(n,\\ell,\\lambda)=(0,0,0.2)$,\n- 案例 3：$(n,\\ell,\\lambda)=(0,1,0.5)$,\n- 案例 4：$(n,\\ell,\\lambda)=(0,3,-0.3)$,\n- 案例 5：$(n,\\ell,\\lambda)=(2,2,1.0)$,\n- 案例 6：$(n,\\ell,\\lambda)=(4,5,0.75)$.\n\n您的程序必须按上述顺序为每个案例计算数值对角化结果与 $(n,\\ell)$ 块内一阶微扰预测之间的最大绝对偏差（以 $\\hbar\\omega$ 为单位）的单个浮点数。您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表的结果（例如，$[x_{1},x_{2},\\dots,x_{6}]$）。所有能量和偏差都必须以 $\\hbar\\omega$ 为单位表示（无量纲）。不允许用户输入；程序必须按原样运行并打印最终结果行。如果内部出现任何角度，必须以弧度为单位；但是，无需报告任何角度。",
            "solution": "该问题要求分析在三维各向同性谐振子势中，具有自旋-轨道相互作用 $V_{\\text{so}}=\\lambda\\,\\mathbf{L}\\cdot\\mathbf{S}$ 的自旋-1/2核子的单粒子壳模型。我们的任务是解析地推导一阶能量移动，并将其与在简并的 $(n,\\ell)$ 流形内通过数值对角化哈密顿量得到的精确本征值进行比较。整个分析在自然单位制（$\\hbar=1$、$m=1$ 和 $\\omega=1$）中进行。\n\n### 1. 一阶能量移动的解析推导\n\n未微扰哈密顿量 $H_{0}=\\dfrac{\\mathbf{p}^{2}}{2m}+\\dfrac{1}{2}m\\omega^{2}r^{2}$ 对给定的径向量子数 $n$ 和轨道角动量 $\\ell$ 具有本征值 $E_{0}(n,\\ell)=2n+\\ell+\\tfrac{3}{2}$。对于固定的 $(n,\\ell)$ 对，所有对应于不同投影 $m_{\\ell}$ 和 $m_s$ 的 $2(2\\ell+1)$ 个态都是简并的。我们引入微扰 $V_{\\text{so}}=\\lambda\\,\\mathbf{L}\\cdot\\mathbf{S}$。根据简并微扰理论，一阶能量修正是构建在此简并子空间内的微扰矩阵的本征值。\n\n找到这些本征值的一个便捷方法是切换到能将 $V_{\\text{so}}$ 对角化的基。所谓的“好”基矢是总角动量 $\\mathbf{J} = \\mathbf{L} + \\mathbf{S}$ 的本征态，记为 $|\\ell, s; j, m_j\\rangle$。为了说明为何该基能将微扰对角化，我们将 $\\mathbf{L}\\cdot\\mathbf{S}$ 用守恒量 $\\mathbf{J}^2$、$\\mathbf{L}^2$ 和 $\\mathbf{S}^2$ 来表示。\n\n我们从定义 $\\mathbf{J} = \\mathbf{L} + \\mathbf{S}$ 出发。对这个矢量算符求平方得到：\n$$\n\\mathbf{J}^2 = \\mathbf{J} \\cdot \\mathbf{J} = (\\mathbf{L} + \\mathbf{S}) \\cdot (\\mathbf{L} + \\mathbf{S}) = \\mathbf{L}^2 + \\mathbf{S}^2 + \\mathbf{L}\\cdot\\mathbf{S} + \\mathbf{S}\\cdot\\mathbf{L}\n$$\n轨道角动量算符 $\\mathbf{L}$ 作用于波函数的空间部分，而自旋算符 $\\mathbf{S}$ 作用于内部自旋部分。因此，它们作用于不同的希尔伯特空间，其分量相互对易：$[L_i, S_k] = 0$，其中 $i,k \\in \\{x,y,z\\}$。这意味着 $\\mathbf{L}\\cdot\\mathbf{S} = \\sum_i L_iS_i = \\sum_i S_iL_i = \\mathbf{S}\\cdot\\mathbf{L}$。$\\mathbf{J}^2$ 的表达式简化为：\n$$\n\\mathbf{J}^2 = \\mathbf{L}^2 + \\mathbf{S}^2 + 2\\mathbf{L}\\cdot\\mathbf{S}\n$$\n重新整理此方程，得到自旋-轨道算符的标准表达式：\n$$\n\\mathbf{L}\\cdot\\mathbf{S} = \\frac{1}{2} (\\mathbf{J}^2 - \\mathbf{L}^2 - \\mathbf{S}^2)\n$$\n根据定义，态 $|\\ell, s; j, m_j\\rangle$ 是 $\\mathbf{J}^2$（本征值为 $j(j+1)$）、$\\mathbf{L}^2$（本征值为 $\\ell(\\ell+1)$）和 $\\mathbf{S}^2$（本征值为 $s(s+1)$）的共同本征态。因此，将算符 $\\mathbf{L}\\cdot\\mathbf{S}$ 作用于这些态会得到该态本身的一个标量倍：\n$$\n\\mathbf{L}\\cdot\\mathbf{S} |\\ell, s; j, m_j\\rangle = \\frac{1}{2} [j(j+1) - \\ell(\\ell+1) - s(s+1)] |\\ell, s; j, m_j\\rangle\n$$\n一阶能量移动 $\\Delta E_{n\\ell j}$ 是微扰 $V_{\\text{so}}$ 在此基下的期望值，它就是 $\\lambda$ 乘以 $\\mathbf{L}\\cdot\\mathbf{S}$ 的本征值：\n$$\n\\Delta E_{n\\ell j} = \\lambda \\frac{1}{2} [j(j+1) - \\ell(\\ell+1) - s(s+1)]\n$$\n对于自旋-1/2的核子，$s=1/2$，因此 $s(s+1) = 3/4$。对于给定的 $\\ell$，总角动量的可能值为 $j=\\ell \\pm 1/2$（如果 $\\ell \\ge 1$）或 $j=1/2$（如果 $\\ell=0$）。\n\n情况 1：$\\ell \\ge 1$\n- 对于 $j = \\ell + 1/2$：\n$$\n\\Delta E_{n\\ell, j=\\ell+1/2} = \\frac{\\lambda}{2} \\left[ \\left(\\ell+\\frac{1}{2}\\right)\\left(\\ell+\\frac{3}{2}\\right) - \\ell(\\ell+1) - \\frac{3}{4} \\right] = \\frac{\\lambda}{2} \\left[ \\ell^2 + 2\\ell + \\frac{3}{4} - \\ell^2 - \\ell - \\frac{3}{4} \\right] = \\frac{\\lambda\\ell}{2}\n$$\n该能级的简并度为 $2j+1 = 2(\\ell+1/2)+1 = 2\\ell+2$。\n\n- 对于 $j = \\ell - 1/2$：\n$$\n\\Delta E_{n\\ell, j=\\ell-1/2} = \\frac{\\lambda}{2} \\left[ \\left(\\ell-\\frac{1}{2}\\right)\\left(\\ell+\\frac{1}{2}\\right) - \\ell(\\ell+1) - \\frac{3}{4} \\right] = \\frac{\\lambda}{2} \\left[ \\ell^2 - \\frac{1}{4} - \\ell^2 - \\ell - \\frac{3}{4} \\right] = -\\frac{\\lambda(\\ell+1)}{2}\n$$\n该能级的简并度为 $2j+1 = 2(\\ell-1/2)+1 = 2\\ell$。\n\n情况 2：$\\ell = 0$\n- 在此情况下，$\\mathbf{L}=0$，因此 $\\mathbf{L}\\cdot\\mathbf{S}=0$。$j$ 的唯一可能值为 $s=1/2$。能量移动为 $\\Delta E_{n,0,1/2} = 0$。简并度为 $2j+1=2$。\n\n总的一阶微扰能级为 $E_{n\\ell j}^{(1)} = E_0(n,\\ell) + \\Delta E_{n\\ell j}$。\n\n### 2. 数值对角化\n\n问题要求在 $(n,\\ell)$ 子空间内对总哈密顿量 $H = H_0 + V_{\\text{so}}$ 进行精确对角化。由于在此子空间中 $H_0$ 是单位算符的常数标量倍（$E_0(n,\\ell)I$），我们只需构建微扰 $V_{\\text{so}} = \\lambda \\mathbf{L}\\cdot\\mathbf{S}$ 的矩阵，然后将其本征值加上 $E_0(n,\\ell)$。\n\n我们在非耦合基 $\\{|\\ell, m_\\ell\\rangle \\otimes |s, m_s\\rangle\\}$ 中构建矩阵，为方便起见对其进行排序。该空间的总维度为 $D=2(2\\ell+1)$。我们使用表达式 $\\mathbf{L}\\cdot\\mathbf{S} = L_z S_z + \\frac{1}{2}(L_+ S_- + L_- S_+)$。矩阵元为 $\\langle \\ell, m'_\\ell; s, m'_s | \\mathbf{L}\\cdot\\mathbf{S} | \\ell, m_\\ell; s, m_s \\rangle$。\n\n- **对角元 ($L_z S_z$)：**\n此项在非耦合基中是对角的。\n$$\n\\langle m'_\\ell, m'_s | L_z S_z | m_\\ell, m_s \\rangle = m_\\ell m_s \\, \\delta_{m'_\\ell, m_\\ell} \\delta_{m'_s, m_s}\n$$\n\n- **非对角元 ($L_+ S_-$ 和 $L_- S_+$)：**\n这些项连接了不同的基态。\n$L_+ S_-$ 算符将 $|m_\\ell, m_s=1/2\\rangle$ 连接到 $|m_\\ell+1, m_s=-1/2\\rangle$：\n$$\n\\frac{1}{2}\\langle m_\\ell+1, -1/2 | L_+ S_- | m_\\ell, 1/2 \\rangle = \\frac{1}{2} \\sqrt{\\ell(\\ell+1)-m_\\ell(m_\\ell+1)}\n$$\n$L_- S_+$ 算符将 $|m_\\ell, m_s=-1/2\\rangle$ 连接到 $|m_\\ell-1, m_s=1/2\\rangle$：\n$$\n\\frac{1}{2}\\langle m_\\ell-1, 1/2 | L_- S_+ | m_\\ell, -1/2 \\rangle = \\frac{1}{2} \\sqrt{\\ell(\\ell+1)-m_\\ell(m_\\ell-1)}\n$$\n非对角项的所有其他矩阵元都为零。完整的哈密顿矩阵为 $H_{matrix} = E_0(n,\\ell)I + \\lambda (\\mathbf{L}\\cdot\\mathbf{S})_{matrix}$。\n\n### 3. 比较与基本原理\n\n“一阶微扰预测”是通过应用简并微扰理论得到的。该理论规定，正确的一阶能量移动是限制在简并子空间内的微扰矩阵的本征值。第1节中的解析推导是通过使用一个能将微扰对角化的基来找到这些本征值的方法。第2节中的数值对角化是直接构建并对角化这同一个微扰矩阵。\n\n因此，这两种方法在数学上是等价的。通过数值对角化获得的“$H$ 的精确本征值”和“一阶微扰预测”应该是相同的。任何观察到的偏差都将归因于浮点数的数值精度限制。因此，该问题可作为对量子力学算符和对角化程序正确实现的严格验证。对于所有测试用例，最大绝对偏差预计都接近于零。\n\n算法如下：\n1. 对于每个参数集 $(n, \\ell, \\lambda)$，计算未微扰能量 $E_0(n,\\ell)$。\n2. 使用 $j=\\ell\\pm 1/2$ 的解析公式，构建一阶微扰能量列表，同时考虑每个能级的 $(2j+1)$ 简并度。对此列表进行排序。\n3. 在非耦合基中，使用升降算符恒等式，构建完整哈密顿量 $H$ 的 $2(2\\ell+1) \\times 2(2\\ell+1)$ 矩阵。\n4. 对该矩阵进行数值对角化以找到其本征值。`numpy.linalg.eigvalsh` 适用于厄米矩阵，并返回排序后的实数本征值。\n5. 计算步骤2和步骤4中得到的已排序能量列表之间的逐元素绝对差。最终结果是这些差值的最大值。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# Execution environment details:\n# language: Python\n# version: 3.12\n# libraries:\n#     - name: numpy, version: 1.23.5\n#     - name: scipy, version: 1.11.4 (not used)\n\ndef _solve_case(n: int, l: int, lam: float) -> float:\n    \"\"\"\n    Computes the maximum absolute deviation between analytical and numerical\n    energy eigenvalues for a single set of parameters (n, l, lambda).\n\n    Args:\n        n: The radial quantum number.\n        l: The orbital angular momentum quantum number.\n        lam: The spin-orbit coupling parameter.\n\n    Returns:\n        The maximum absolute deviation between the two sets of energies.\n    \"\"\"\n    # Unperturbed energy for the (n, l) shell in units of hbar*omega\n    E0 = 2 * n + l + 1.5\n\n    # --- 1. First-Order Perturbative Calculation ---\n    # According to degenerate perturbation theory, the first-order corrections\n    # are the eigenvalues of the perturbation V_so within the degenerate subspace.\n    # These are found analytically using the coupled basis |l,s;j,mj>.\n    pert_energies = []\n    if l == 0:\n        # For l=0, L=0, so L.S=0. The energy shift is zero.\n        # The total angular momentum j can only be s=1/2. \n        # The multiplicity is 2j+1 = 2.\n        pert_energies.extend([E0] * 2)\n    else:\n        # For l > 0, j can be j_plus = l + 1/2 and j_minus = l - 1/2.\n        \n        # Case j = l + 1/2:\n        # Delta_E = lambda * l / 2\n        e_plus = E0 + lam * l / 2.0\n        mult_plus = int(2 * (l + 0.5) + 1)\n        pert_energies.extend([e_plus] * mult_plus)\n\n        # Case j = l - 1/2:\n        # Delta_E = -lambda * (l + 1) / 2\n        e_minus = E0 - lam * (l + 1) / 2.0\n        mult_minus = int(2 * (l - 0.5) + 1)\n        pert_energies.extend([e_minus] * mult_minus)\n    \n    # The list of perturbative energies must be sorted for comparison.\n    pert_energies = np.array(sorted(pert_energies))\n\n    # --- 2. Exact Numerical Diagonalization ---\n    # The dimension of the Hilbert space for fixed (l, s=1/2)\n    dim = 2 * (2 * l + 1)\n    \n    # The Hamiltonian matrix H = E0*I + lambda * (L.S)_matrix.\n    # We construct the matrix for L.S in the uncoupled basis |l, ml> |s, ms>.\n    \n    # Create the basis states and a mapping from state to index for convenience.\n    basis_states = []\n    state_to_idx = {}\n    m_s_vals = [-0.5, 0.5]\n    idx = 0\n    # Order basis states by m_l first, then m_s\n    for ml in range(-l, l + 1):\n        for ms in m_s_vals:\n            state = (ml, ms)\n            basis_states.append(state)\n            state_to_idx[state] = idx\n            idx += 1\n            \n    # Matrix for L.S operator. It is real and symmetric.\n    L_dot_S_matrix = np.zeros((dim, dim), dtype=np.float64)\n\n    for k_col, state_ket in enumerate(basis_states):\n        ml_ket, ms_ket = state_ket\n        \n        # Diagonal part: Lz * Sz\n        L_dot_S_matrix[k_col, k_col] += ml_ket * ms_ket\n        \n        # Off-diagonal part: 0.5 * (L+S- + L-S+)\n        # S- acts on spin up (ms=0.5), turning it to spin down (ms=-0.5). Coeff=1.\n        # S+ acts on spin down (ms=-0.5), turning it to spin up (ms=0.5). Coeff=1.\n        \n        # L+S- term (acts on ket |ml, 0.5>)\n        if ms_ket == 0.5 and ml_ket  l:\n            # Target \"bra\" state is |ml+1, -0.5>\n            state_bra = (ml_ket + 1, -0.5)\n            k_row = state_to_idx[state_bra]\n            # Matrix element of L+\n            coeff_L_plus = np.sqrt(l * (l + 1) - ml_ket * (ml_ket + 1))\n            L_dot_S_matrix[k_row, k_col] += 0.5 * coeff_L_plus\n            # Add symmetric element\n            L_dot_S_matrix[k_col, k_row] += 0.5 * coeff_L_plus\n            \n        # L-S+ term (acts on ket |ml, -0.5>)\n        # This is automatically handled by the symmetric property L_dot_S_matrix[k_col, k_row]\n        # if we iterate through all k_row and k_col. A more direct construction ensures we only add once.\n        # Let's verify the term L-S+\n        if ms_ket == -0.5 and ml_ket > -l:\n            state_bra = (ml_ket - 1, 0.5)\n            k_row = state_to_idx[state_bra]\n            coeff_L_minus = np.sqrt(l*(l+1) - ml_ket * (ml_ket-1))\n            # this is already filled by the symmetric element of L+S-\n            pass\n            \n    # The full Hamiltonian matrix\n    H_matrix = E0 * np.identity(dim) + lam * L_dot_S_matrix\n\n    # Find eigenvalues. np.linalg.eigvalsh is used for Hermitian matrices\n    # and returns sorted real eigenvalues.\n    exact_energies = np.linalg.eigvalsh(H_matrix)\n    \n    # --- 3. Compute Deviation ---\n    # Calculate the maximum absolute difference between the sorted lists of energies.\n    deviation = np.max(np.abs(exact_energies - pert_energies))\n    \n    return deviation\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print the results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (n, l, lambda)\n        (0, 1, 0.0),\n        (0, 0, 0.2),\n        (0, 1, 0.5),\n        (0, 3, -0.3),\n        (2, 2, 1.0),\n        (4, 5, 0.75),\n    ]\n\n    results = []\n    for case in test_cases:\n        n, l, lam = case\n        result = _solve_case(n, l, lam)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "当我们使用独立的单粒子态来构建多体核系统时，会引入一个棘手的问题：整个原子核质心的虚假运动。这项练习将引导你解决这个问题，通过推导和实现必要的质心运动校正，计算出原子核真实的“内禀”尺寸（均方根半径），从而将理论模型与实验可观测量联系起来。",
            "id": "3607452",
            "problem": "考虑一个由 $A$ 个质量为 $m$ 的非相对论性核子组成的系统，它们在一个球对称的三维谐振子（HO）平均场势中独立运动。单粒子哈密顿量为 $H_{\\text{sp}} = \\frac{\\mathbf{p}^2}{2m} + \\frac{1}{2} m \\omega^2 \\mathbf{r}^2$，多体哈密顿量是独立的单粒子哈密顿量之和。单粒子态由谐振子量子数 $(n,\\ell)$ 及其主壳层量子数 $N = 2n + \\ell$ 来表征。均方根（RMS）半径由均方半径 $\\langle r^2 \\rangle$ 定义为 $\\sqrt{\\langle r^2 \\rangle}$。\n\n当人们在不移除质心（COM）运动的情况下，通过单粒子密度的朴素求和来计算诸如 $\\langle r^2 \\rangle$ 之类的可观测量时，会出现质心赝运动。在谐振子平均场图像中，如果所有核子共用一个振子长度参数 $b = \\sqrt{\\hbar/(m \\omega)}$，那么多体动力学可以分离为质心部分和内禀部分。每个核子的内禀均方根半径必须排除质心运动。\n\n仅从谐振子哈密顿量、质心坐标 $\\mathbf{R}_{\\text{cm}} = \\frac{1}{A} \\sum_{i=1}^A \\mathbf{r}_i$ 和内禀坐标 $\\boldsymbol{\\rho}_i = \\mathbf{r}_i - \\mathbf{R}_{\\text{cm}}$ 的定义以及均方根半径的定义出发，推导用于计算以下各项的表达式：\n- 每个核子的朴素均方物质半径 $\\langle r^2 \\rangle_{\\text{naive}}$，通过对所有已占据态的单粒子 $\\langle r^2 \\rangle$ 进行平均得到；\n- 每个核子的质心修正的内禀均方物质半径 $\\langle r^2 \\rangle_{\\text{intr}}$，它从 $\\langle r^2 \\rangle_{\\text{naive}}$ 中移除了质心贡献。\n\n然后，你必须实现一个程序，针对指定的测试用例，计算朴素均方根半径 $\\sqrt{\\langle r^2 \\rangle_{\\text{naive}}}$、质心修正的内禀均方根半径 $\\sqrt{\\langle r^2 \\rangle_{\\text{intr}}}$，以及它们之间的绝对差 $\\Delta = \\sqrt{\\langle r^2 \\rangle_{\\text{naive}}} - \\sqrt{\\langle r^2 \\rangle_{\\text{intr}}}$。假设所有已占据态共用一个振子长度 $b$。将所有均方根半径和差值以飞米（fm）为单位表示为浮点数。\n\n使用以下测试套件，其中每个案例由核子总数 $A$、以飞米（fm）为单位的振子长度 $b$ 以及谐振子主壳层 $N$ 的占据数指定（其中占据数是占据该壳层的核子总数，包括质子和中子两种核素以及两种自旋方向）：\n\n- 案例 1（边界条件，单粒子）：$A = 1$，$b = 1.70\\,\\text{fm}$，占据数 $\\{N=0:1\\}$。\n- 案例 2（两种核素的 $N=0$ 壳层闭合）：$A = 4$，$b = 1.70\\,\\text{fm}$，占据数 $\\{N=0:4\\}$。\n- 案例 3（两种核素的 $N=0,1$ 壳层闭合）：$A = 16$，$b = 1.65\\,\\text{fm}$，占据数 $\\{N=0:4,\\,N=1:12\\}$。\n- 案例 4（两种核素的 $N=0,1,2$ 壳层闭合）：$A = 40$，$b = 1.90\\,\\text{fm}$，占据数 $\\{N=0:4,\\,N=1:12,\\,N=2:24\\}$。\n- 案例 5（两种核素的 $N=0,1,2,3,4$ 壳层闭合）：$A = 140$，$b = 2.00\\,\\text{fm}$，占据数 $\\{N=0:4,\\,N=1:12,\\,N=2:24,\\,N=3:40,\\,N=4:60\\}$。\n\n你的程序必须验证每个案例中占据数之和等于 $A$。对于每个案例，计算：\n- $\\sqrt{\\langle r^2 \\rangle_{\\text{naive}}}$（以 fm 为单位），\n- $\\sqrt{\\langle r^2 \\rangle_{\\text{intr}}}$（以 fm 为单位），\n- $\\Delta$（以 fm 为单位）。\n\n最终输出格式：你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，每个测试用例按上述顺序贡献三个数字。对于五个案例，这将产生一个包含十五个浮点数的扁平列表：$[\\text{case1\\_naive},\\text{case1\\_intr},\\text{case1\\_delta},\\text{case2\\_naive},\\ldots,\\text{case5\\_delta}]$。",
            "solution": "问题陈述已经过分析，被认为是有效的。它具有科学依据，问题明确，客观且内部一致。\n\n### 1. 理论推导\n\n目标是为一个在公共三维谐振子（HO）势中运动的 $A$ 个独立核子系统，推导出每个核子的朴素均方物质半径 $\\langle r^2 \\rangle_{\\text{naive}}$ 和质心（COM）修正的内禀均方物质半径 $\\langle r^2 \\rangle_{\\text{intr}}$ 的表达式。\n\n#### 1.1. $\\mathbf{r}^2$ 的单粒子期望值\n\n质量为 $m$ 的核子在角频率为 $\\omega$ 的谐振子势中的单粒子哈密顿量为：\n$$\nH_{\\text{sp}} = \\frac{\\mathbf{p}^2}{2m} + \\frac{1}{2} m \\omega^2 \\mathbf{r}^2 = T + V\n$$\n该哈密顿量的能量本征值仅依赖于主壳层量子数 $N = 2n + \\ell$，其中 $n$ 是径向量子数，$\\ell$ 是轨道角动量量子数。壳层 $N$ 中一个态的能量为：\n$$\nE_N = \\left(N + \\frac{3}{2}\\right) \\hbar \\omega\n$$\n根据维里定理，对于形式为 $V \\propto r^k$ 的势，动能期望值 $\\langle T \\rangle$ 和势能期望值 $\\langle V \\rangle$ 之间的关系为 $2\\langle T \\rangle = k\\langle V \\rangle$。对于谐振子，势与 $r^2$ 成正比，因此 $k=2$，这意味着 $\\langle T \\rangle = \\langle V \\rangle$。\n\n一个态的总能量是动能和势能期望值之和，$E_N = \\langle T \\rangle + \\langle V \\rangle$。因此，我们有 $E_N = 2\\langle V \\rangle$。代入势能的表达式：\n$$\nE_N = 2 \\left\\langle \\frac{1}{2} m \\omega^2 \\mathbf{r}^2 \\right\\rangle = m \\omega^2 \\langle \\mathbf{r}^2 \\rangle\n$$\n求解对应于主壳层 $N$ 的态中单个粒子的半径平方期望值 $\\langle \\mathbf{r}^2 \\rangle_N$：\n$$\n\\langle \\mathbf{r}^2 \\rangle_N = \\frac{E_N}{m \\omega^2} = \\frac{(N + 3/2)\\hbar\\omega}{m \\omega^2} = \\left(N + \\frac{3}{2}\\right) \\frac{\\hbar}{m\\omega}\n$$\n问题将振子长度参数定义为 $b = \\sqrt{\\hbar/(m \\omega)}$，这意味着 $b^2 = \\hbar/(m\\omega)$。将其代入 $\\langle \\mathbf{r}^2 \\rangle_N$ 的表达式中，得到：\n$$\n\\langle \\mathbf{r}^2 \\rangle_N = \\left(N + \\frac{3}{2}\\right) b^2\n$$\n\n#### 1.2. 朴素均方半径\n\n朴素均方物质半径是通过对所有 $A$ 个已占据核子态的单粒子期望值 $\\langle \\mathbf{r}^2 \\rangle_N$ 进行平均计算得出的。系统总半径平方的算符是 $\\sum_{i=1}^A \\mathbf{r}_i^2$。在独立粒子模型中，其期望值是单粒子期望值的总和：$\\langle \\sum_{i=1}^A \\mathbf{r}_i^2 \\rangle = \\sum_{i \\in \\text{occ}} \\langle \\mathbf{r}^2 \\rangle_i$。\n\n每个核子的均方半径是这个总值除以 $A$：\n$$\n\\langle r^2 \\rangle_{\\text{naive}} = \\frac{1}{A} \\sum_{i \\in \\text{occ}} \\langle \\mathbf{r}^2 \\rangle_i\n$$\n设 $d_N$ 为占据主壳层 $N$ 中状态的核子数。总和可以按壳层分组：\n$$\n\\langle r^2 \\rangle_{\\text{naive}} = \\frac{1}{A} \\sum_{N} d_N \\langle \\mathbf{r}^2 \\rangle_N = \\frac{1}{A} \\sum_{N} d_N \\left(N + \\frac{3}{2}\\right) b^2\n$$\n这就是朴素均方半径的公式。朴素均方根（RMS）半径是 $\\sqrt{\\langle r^2 \\rangle_{\\text{naive}}}$。\n\n#### 1.3. 内禀均方半径（质心修正）\n\n核子位置 $\\mathbf{r}_i$ 可以用质心坐标 $\\mathbf{R}_{\\text{cm}}$ 和内禀坐标 $\\boldsymbol{\\rho}_i$ 来表示：\n$$\n\\mathbf{R}_{\\text{cm}} = \\frac{1}{A} \\sum_{i=1}^A \\mathbf{r}_i \\quad \\text{和} \\quad \\boldsymbol{\\rho}_i = \\mathbf{r}_i - \\mathbf{R}_{\\text{cm}}\n$$\n粒子坐标的平方和可以与内禀坐标和质心坐标相关联。我们从 $\\mathbf{r}_i = \\boldsymbol{\\rho}_i + \\mathbf{R}_{\\text{cm}}$ 开始，并对所有粒子求和：\n$$\n\\sum_{i=1}^A \\mathbf{r}_i^2 = \\sum_{i=1}^A (\\boldsymbol{\\rho}_i + \\mathbf{R}_{\\text{cm}})^2 = \\sum_{i=1}^A (\\boldsymbol{\\rho}_i^2 + 2\\boldsymbol{\\rho}_i \\cdot \\mathbf{R}_{\\text{cm}} + \\mathbf{R}_{\\text{cm}}^2) = \\left(\\sum_{i=1}^A \\boldsymbol{\\rho}_i^2\\right) + 2\\mathbf{R}_{\\text{cm}} \\cdot \\left(\\sum_{i=1}^A \\boldsymbol{\\rho}_i\\right) + A\\mathbf{R}_{\\text{cm}}^2\n$$\n根据内禀坐标的定义，它们的和为零：$\\sum_{i=1}^A \\boldsymbol{\\rho}_i = \\sum_{i=1}^A (\\mathbf{r}_i - \\mathbf{R}_{\\text{cm}}) = A\\mathbf{R}_{\\text{cm}} - A\\mathbf{R}_{\\text{cm}} = 0$。因此，交叉项消失，我们得到基本关系：\n$$\n\\sum_{i=1}^A \\mathbf{r}_i^2 = \\sum_{i=1}^A \\boldsymbol{\\rho}_i^2 + A\\mathbf{R}_{\\text{cm}}^2\n$$\n取该算符方程的期望值：\n$$\n\\left\\langle \\sum_{i=1}^A \\mathbf{r}_i^2 \\right\\rangle = \\left\\langle \\sum_{i=1}^A \\boldsymbol{\\rho}_i^2 \\right\\rangle + \\left\\langle A\\mathbf{R}_{\\text{cm}}^2 \\right\\rangle\n$$\n在公共谐振子势中 $A$ 个独立核子的总哈密顿量可以精确地分离为描述质心运动的部分和描述内禀运动的部分：$H = H_{\\text{cm}} + H_{\\text{intr}}$。质心哈密顿量与一个质量为 $Am$ 的单粒子在相同振子势中的哈密顿量相同：\n$$\nH_{\\text{cm}} = \\frac{\\mathbf{P}_{\\text{cm}}^2}{2(Am)} + \\frac{1}{2}(Am)\\omega^2 \\mathbf{R}_{\\text{cm}}^2\n$$\n其中 $\\mathbf{P}_{\\text{cm}} = \\sum_i \\mathbf{p}_i$。多体系统的基态对应于质心处于其自身的基态，即一个 $N=0$ 态。该态的能量为 $E_{\\text{cm},0} = (3/2)\\hbar\\omega$。使用与单粒子情况相同的维里定理逻辑，质心势能的期望值是其总能量的一半：\n$$\n\\left\\langle \\frac{1}{2}(Am)\\omega^2 \\mathbf{R}_{\\text{cm}}^2 \\right\\rangle = \\frac{1}{2} E_{\\text{cm},0} = \\frac{1}{2} \\left(\\frac{3}{2}\\hbar\\omega\\right) = \\frac{3}{4}\\hbar\\omega\n$$\n由此，我们求出期望值 $\\langle \\mathbf{R}_{\\text{cm}}^2 \\rangle$：\n$$\n\\langle \\mathbf{R}_{\\text{cm}}^2 \\rangle = \\frac{3\\hbar\\omega}{2(Am)\\omega^2} = \\frac{3}{2A} \\frac{\\hbar}{m\\omega} = \\frac{3}{2A} b^2\n$$\n将此代回期望值方程：\n$$\nA \\langle r^2 \\rangle_{\\text{naive}} = A \\langle r^2 \\rangle_{\\text{intr}} + A \\left( \\frac{3}{2A} b^2 \\right) = A \\langle r^2 \\rangle_{\\text{intr}} + \\frac{3}{2} b^2\n$$\n两边同除以 $A$，我们得到每个核子的均方半径之间的关系：\n$$\n\\langle r^2 \\rangle_{\\text{naive}} = \\langle r^2 \\rangle_{\\text{intr}} + \\frac{3}{2A} b^2\n$$\n求解内禀均方半径，得到所需的修正公式：\n$$\n\\langle r^2 \\rangle_{\\text{intr}} = \\langle r^2 \\rangle_{\\text{naive}} - \\frac{3}{2A} b^2\n$$\n内禀均方根半径为 $\\sqrt{\\langle r^2 \\rangle_{\\text{intr}}}$。\n\n### 2. 算法设计\n\n程序将为提供的每个测试用例实现推导出的公式。\n\n1.  **输入数据**：测试用例包括核子总数 $A$、以飞米（fm）为单位的振子长度 $b$ 和一个占据数字典 $\\{N: d_N, \\ldots\\}$，其中 $d_N$ 是主壳层 $N$ 中的核子数。\n\n2.  **验证**：对于每个测试用例，程序将首先验证占据数之和是否等于给定的核子数 $A$，即 $\\sum_N d_N = A$。\n\n3.  **朴素半径的计算**：\n    a.  对所有提供的占据数计算总和 $S = \\sum_N d_N (N + 3/2)$。\n    b.  使用公式 $\\langle r^2 \\rangle_{\\text{naive}} = \\frac{S}{A} b^2$ 计算朴素均方半径。\n    c.  计算朴素均方根半径：$R_{\\text{naive}} = \\sqrt{\\langle r^2 \\rangle_{\\text{naive}}}$。\n\n4.  **内禀半径的计算**：\n    a.  使用修正公式计算内禀均方半径：$\\langle r^2 \\rangle_{\\text{intr}} = \\langle r^2 \\rangle_{\\text{naive}} - \\frac{3 b^2}{2 A}$。\n    b.  计算内禀均方根半径：$R_{\\text{intr}} = \\sqrt{\\langle r^2 \\rangle_{\\text{intr}}}$。\n\n5.  **差值计算**：计算绝对差 $\\Delta = R_{\\text{naive}} - R_{\\text{intr}}$。\n\n6.  **输出**：每个测试用例的三个计算值（$R_{\\text{naive}}$、$R_{\\text{intr}}$、$\\Delta$）将被收集到一个单一的扁平列表中。该列表将被格式化为所需的、用方括号括起来的逗号分隔字符串。\n\n此过程将应用于所有五个测试用例以生成最终输出。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the naive and intrinsic RMS radii for nuclei in the harmonic oscillator shell model.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (A, b, occupations_dict)\n    # A: total number of nucleons\n    # b: oscillator length in fm\n    # occupations_dict: {major_shell_N: nucleon_count_d_N}\n    test_cases = [\n        (1, 1.70, {0: 1}),\n        (4, 1.70, {0: 4}),\n        (16, 1.65, {0: 4, 1: 12}),\n        (40, 1.90, {0: 4, 1: 12, 2: 24}),\n        (140, 2.00, {0: 4, 1: 12, 2: 24, 3: 40, 4: 60})\n    ]\n\n    results = []\n    \n    for A, b, occupations in test_cases:\n        # Step 1: Verify that the sum of occupation numbers equals A.\n        if sum(occupations.values()) != A:\n            raise ValueError(f\"Inconsistent data for A={A}: sum of occupations is {sum(occupations.values())}\")\n        \n        # Step 2: Calculate the sum S = sum[d_N * (N + 3/2)] over all shells.\n        s_val = 0.0\n        for N, d_N in occupations.items():\n            s_val += d_N * (N + 1.5)\n            \n        b_squared = b**2\n        \n        # Step 3: Calculate the naive mean-square radius per nucleon.\n        mean_sq_naive = (s_val / A) * b_squared\n        rms_naive = np.sqrt(mean_sq_naive)\n        \n        # Step 4: Calculate the intrinsic mean-square radius.\n        mean_sq_intr = mean_sq_naive - (1.5 / A) * b_squared\n        # Handle potential floating point inaccuracies leading to small negative numbers\n        if mean_sq_intr  0:\n            rms_intr = 0.0\n        else:\n            rms_intr = np.sqrt(mean_sq_intr)\n        \n        # Step 5: Calculate the difference.\n        delta = rms_naive - rms_intr\n        \n        # Append the three results to the list\n        results.append(rms_naive)\n        results.append(rms_intr)\n        results.append(delta)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}