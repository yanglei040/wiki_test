{
    "hands_on_practices": [
        {
            "introduction": "手性有效场论的一个核心优势是其能够系统性地估算理论本身的不确定性，即所谓的“截断误差”。这个练习提供了一个具体的“信封背面”式计算，将幂次计数（power counting）的抽象概念转化为对可观测量误差的实际估计。通过这个实践，你将亲身体会到如何利用典型的动量尺度 $Q$ 和破缺尺度 $\\Lambda_{\\chi}$ 来量化我们理论的预测精度。",
            "id": "3549489",
            "problem": "在用于核子-核子 (NN) 相互作用的手征有效场论 (EFT) 中，系统性截断误差源于将可观测量按一个小的无量纲标度比率的幂次展开。该估算的基本依据是标度分离：由典型软标度 $Q$ 主导的低能物理和由破缺标度 $\\Lambda_{\\chi}$ 概括的高能物理。小参数是 $x$，定义为 $x=Q/\\Lambda_{\\chi}$，且 EFT 幂次计数规则表明，更高阶的贡献会随着 $x$ 幂次的增加而被压低。假设系数为自然大小（数量级为1），且次次次领头阶 (N3LO) 修正相对于领头阶 (LO) 的标度关系为 $x^{4}$，请估算在典型软标度 $Q=200\\ \\mathrm{MeV}$ 和破缺标度 $\\Lambda_{\\chi}=1\\ \\mathrm{GeV}$ 条件下，N3LO 修正的分数大小。然后，将此分数估算值转化为一个 NN 可观测量预期的截断误差，其中氘核结合能的 LO 预测值为 $B_{\\mathrm{LO}}=2.20\\ \\mathrm{MeV}$。以 $\\mathrm{MeV}$ 为单位表示最终的截断误差，并将答案四舍五入至四位有效数字。",
            "solution": "对问题陈述进行验证。\n\n**步骤 1：提取已知条件**\n- 无量纲展开参数为 $x = Q/\\Lambda_{\\chi}$。\n- $Q$ 是典型软标度。\n- $\\Lambda_{\\chi}$ 是破缺标度。\n- 次次次领头阶 (N3LO) 修正相对于领头阶 (LO) 的标度关系为 $x^{4}$。\n- 软标度的值为 $Q = 200 \\ \\mathrm{MeV}$。\n- 破缺标度的值为 $\\Lambda_{\\chi} = 1 \\ \\mathrm{GeV}$。\n- 氘核结合能的 LO 预测值为 $B_{\\mathrm{LO}} = 2.20 \\ \\mathrm{MeV}$。\n- 截断误差的最终答案必须以 $\\mathrm{MeV}$ 为单位，并四舍五入至四位有效数字。\n\n**步骤 2：使用提取的已知条件进行验证**\n- **科学依据充分**：该问题基于手征有效场论 (EFT) 的完善原理，这是现代核物理的基石。幂次计数方案 ($x = Q/\\Lambda_{\\chi}$)、高阶项的标度关系以及软标度 ($Q$) 和破缺标度 ($\\Lambda_{\\chi}$) 的取值都是标准的并具有物理动机。给定的 LO 氘核结合能是一个符合实际的值。该问题在根本上是合理的。\n- **提法恰当**：该问题提供了所有必要信息和一个明确的目标：基于所提供的模型计算一个具体的数值。存在唯一解。\n- **客观性**：语言精确、技术性强，没有任何主观或模糊的术语。\n- **完备性和一致性**：问题是自洽的。所有需要的数据（$Q$, $\\Lambda_{\\chi}$, $B_{\\mathrm{LO}}$, 标度幂次）都已提供。没有内部矛盾。单位需要转换，但彼此一致（$\\mathrm{MeV}$ 和 $\\mathrm{GeV}$）。\n\n**步骤 3：结论与行动**\n该问题被认为是**有效的**，因为它科学依据充分、提法恰当且内部一致。将提供解答。\n\n问题的核心是估算 N3LO 修正对一个可观测量的贡献大小，该大小可作为前一阶 EFT 展开的截断误差的代理。\n\n首先，我们计算无量纲展开参数 $x$。给定软标度 $Q = 200 \\ \\mathrm{MeV}$ 和破缺标度 $\\Lambda_{\\chi} = 1 \\ \\mathrm{GeV}$。为了计算它们的比值，我们必须将它们表示为一致的单位。我们将 $\\Lambda_{\\chi}$ 从吉电子伏特 ($\\mathrm{GeV}$) 转换为兆电子伏特 ($\\mathrm{MeV}$)：\n$$\n\\Lambda_{\\chi} = 1 \\ \\mathrm{GeV} = 1000 \\ \\mathrm{MeV}\n$$\n现在我们可以计算 $x$：\n$$\nx = \\frac{Q}{\\Lambda_{\\chi}} = \\frac{200 \\ \\mathrm{MeV}}{1000 \\ \\mathrm{MeV}} = \\frac{2}{10} = 0.2\n$$\n问题陈述 N3LO 修相对于 LO 贡献的标度关系为 $x^{4}$。这意味着 N3LO 修正的分数大小，我们记为 $\\epsilon_{\\mathrm{N3LO}}$，其数量级为 $x^{4}$。假设乘以该因子的无量纲系数的数量级为 1（这是 EFT 中“自然”理论的标准假设），我们可以将分数误差估算为：\n$$\n\\epsilon_{\\mathrm{N3LO}} \\approx x^{4}\n$$\n代入 $x$ 的值：\n$$\n\\epsilon_{\\mathrm{N3LO}} = (0.2)^{4} = \\left(\\frac{1}{5}\\right)^{4} = \\frac{1}{625} = 0.0016\n$$\n截断误差由级数中第一个被忽略项的大小来估算。问题要求我们找出 N3LO 修正的大小，我们记为 $\\delta B_{\\mathrm{N3LO}}$。这可以通过将修正的分数大小乘以可观测量在 LO 的值 $B_{\\mathrm{LO}} = 2.20 \\ \\mathrm{MeV}$ 来得到。\n$$\n\\delta B_{\\mathrm{N3LO}} = \\epsilon_{\\mathrm{N3LO}} \\times B_{\\mathrm{LO}}\n$$\n代入数值：\n$$\n\\delta B_{\\mathrm{N3LO}} = 0.0016 \\times 2.20 \\ \\mathrm{MeV} = 0.00352 \\ \\mathrm{MeV}\n$$\n问题要求最终答案四舍五入至四位有效数字。计算值为 $0.00352 \\ \\mathrm{MeV}$。第一个非零数字是 $3$，这是第一位有效数字。从那里数四位有效数字，我们得到 $3$、$5$、$2$ 和一个末尾的 $0$。\n$$\n\\delta B_{\\mathrm{N3LO}} \\approx 0.003520 \\ \\mathrm{MeV}\n$$\n这个值代表了 N3LO 对氘核结合能贡献的预期大小，并作为 N2LO 计算的截断误差的标准估算。",
            "answer": "$$\n\\boxed{0.003520}\n$$"
        },
        {
            "introduction": "有效场论中的低能常数（LECs）吸收了短程物理的复杂细节，其数值需要通过拟合实验数据来确定。这个计算练习将指导你探索一个核心概念：重整化。你将通过数值求解Lippmann-Schwinger方程来拟合一个$P$波相互作用的低能常数，并验证该常数如何随截断尺度 $\\Lambda$ 变化，从而验证理论的自洽性。",
            "id": "3549517",
            "problem": "考虑在手征有效场论的领头阶 (LO) 下，三重态 $P$ 波道 $^{3}P_{0}$ 和 $^{3}P_{2}$ 中的双核子散射。领头阶 (LO) 指的是幂次计数展开中的最低阶，而低能常数 (LEC) 指的是乘以短程接触相互作用的系数。在一个计算设置中，通过可分离形式 $V(k',k) = C \\, g(k') g(k)$ 来对动量空间中的 $P$ 波接触相互作用进行建模，其中 $C$ 是该波道的 LEC，$g(k)$ 是一个依赖于调节子的形状因子，该因子编码了紫外行为。\n\n使用以下调节子族，它们代表了核有效场论中常用的非定域、类定域和半定域正则化策略：\n- 非定域调节子：$g_{\\mathrm{NL}}(k;\\Lambda) = k \\exp\\!\\left(-\\left(\\frac{k}{\\Lambda}\\right)^{4}\\right)$。\n- 类定域调节子：$g_{\\mathrm{L}}(k;\\Lambda) = k \\left(\\frac{\\Lambda^{2}}{\\Lambda^{2}+k^{2}}\\right)^{2}$。\n- 半定域调节子：$g_{\\mathrm{SL}}(k;\\Lambda) = k \\exp\\!\\left(-\\left(\\frac{k}{\\Lambda}\\right)^{2}\\right) \\left(\\frac{\\Lambda^{2}}{\\Lambda^{2}+k^{2}}\\right)$。\n\n约化质量为 $\\mu$，轨道角动量为 $l$ 的在壳分波振幅满足分波形式的 Lippmann–Schwinger 方程以及与散射振幅的标准关系。对于 $P$ 波 ($l=1$)，相移的低能行为由 $k^{3} \\cot \\delta_{1}(k) = -\\frac{1}{a_{1}} + \\frac{1}{2} r_{1} k^{2} + \\cdots$ 定义，其中 $a_{1}$ 是散射体积，$r_{1}$ 是 $P$ 波有效程参数。分波 $T$ 矩阵 $T_{1}(k,k;E)$ 通过标准的非相对论散射关系与相移相关联，并且在低能极限 $k \\to 0$ 时，满足 $T_{1}(k,k;E) \\sim -\\frac{2\\pi}{\\mu} k^{2} a_{1}$。\n\n从 $P$ 波道中可分离势的 Lippmann–Schwinger 方程和上述低能关系出发，从第一性原理推导如何确定 LEC $C(\\Lambda)$，使得对于每种调节子选择，在零能量下都能再现给定的目标 $P$ 波散射体积 $a_{1}$。实现一个数值程序来计算进入零能量 Lippmann–Schwinger 方程的圈图积分，并通过施加与指定 $a_{1}$ 的匹配条件来拟合可变截断 $\\Lambda$ 下的 $C(\\Lambda)$。\n\n采用自然单位制，其中 $\\hbar = c = 1$，取约化质量为 $\\mu = \\frac{1}{2}$（无量纲），并将所有动量和逆长度视为无量纲。散射体积 $a_{1}$ 于是以逆动量立方的无量纲单位表示。程序必须使用在 $[0,\\infty)$ 上的数值稳定的求积法来实现对 $k$ 的积分，该积分在一个足够大的上限处截断，以保证给定调节子的收敛性。使用一个在所有调节子形式下都合理的单一一致截断策略。\n\n为了诊断幂次计数的一致性，评估在一系列 $\\Lambda$ 值上拟合出的 LEC $C(\\Lambda)$ 的截断流，并从 $\\log |C(\\Lambda)|$ 对 $\\log \\Lambda$ 的最小二乘拟合中提取标度指数 $s$。在重整化群的意义上，对于纯 $P$ 波接触相互作用，预期的领头标度行为是在大 $\\Lambda$ 时 $|C(\\Lambda)| \\propto \\Lambda^{-3}$。通过检查 $|s + 3| \\le \\tau$（其中 $\\tau$ 是一个容差）来定义一个用于一致性诊断的布尔值。\n\n你的程序必须为以下测试用例套件计算斜率 $s$ 和一致性布尔值，每个用例由调节子类型、一个波道及其目标散射体积 $a_{1}$，以及一个截断值 $\\Lambda$ 的列表指定：\n- 用例 1：调节子 $g_{\\mathrm{NL}}$，波道 $^{3}P_{0}$，目标 $a_{1} = -0.35$，$\\Lambda$ 值为 $[1.5, 2.0, 2.5, 3.0, 3.5]$。\n- 用例 2：调节子 $g_{\\mathrm{L}}$，波道 $^{3}P_{2}$，目标 $a_{1} = 0.20$，$\\Lambda$ 值为 $[4.0, 5.0, 7.5, 10.0]$。\n- 用例 3：调节子 $g_{\\mathrm{SL}}$，波道 $^{3}P_{0}$，目标 $a_{1} = -0.35$，$\\Lambda$ 值为 $[2.0, 4.0, 8.0, 16.0]$。\n- 用例 4：调节子 $g_{\\mathrm{NL}}$，波道 $^{3}P_{2}$，目标 $a_{1} = 0.20$，$\\Lambda$ 值为 $[0.75, 1.0, 1.25, 1.5]$。\n- 用例 5：调节子 $g_{\\mathrm{L}}$，波道 $^{3}P_{0}$，目标 $a_{1} = -0.35$，$\\Lambda$ 值为 $[8.0, 12.0, 16.0, 20.0]$。\n\n使用容差 $\\tau = 0.25$。你的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表，每个用例的结果是一个双元素列表 $[s, b]$，其中 $s$ 是一个浮点数，$b$ 是布尔诊断值。例如，输出格式必须为 $[[s_{1},b_{1}],[s_{2},b_{2}],\\ldots,[s_{5},b_{5}]]$ 的形式，不含任何额外文本。输出中不应出现任何物理单位。",
            "solution": "所陈述的问题是有效的。其科学基础在于非相对论量子散射理论和手征有效场论的原理，问题是良定的，有足够的信息来推导唯一解，并且以客观、精确的语言表述。因此，我们可以着手求解。\n\n求解过程分两个阶段。首先，我们推导低能常数 (LEC) $C$ 和 P 波散射体积 $a_1$ 之间的解析关系。其次，我们概述计算不同截断 $\\Lambda$ 下的 $C(\\Lambda)$、拟合其标度行为并评估其与理论预期一致性的数值步骤。\n\n**1. 低能常数 $C(\\Lambda)$ 的推导**\n\n出发点是描述散射过程的离壳 $T$ 矩阵的分波 Lippmann-Schwinger (LS) 方程 $T_l(p', p; E)$。在核物理中常用的一种归一化方案中，该方程写作：\n$$\nT_l(p', p; E) = V_l(p', p) + \\frac{2}{\\pi} \\int_0^\\infty dq \\, q^2 \\, V_l(p', q) \\, \\frac{1}{k^2 - q^2 + i\\epsilon} \\, T_l(q, p; E)\n$$\n这里，$l$ 是轨道角动量，$p$ 和 $p'$ 是初始和末端相对动量，$q$ 是圈图动量。能量通过 $E = k^2/(2\\mu)$ 与在壳动量 $k$ 相关，其中 $\\mu$ 是约化质量。问题指定了自然单位制 ($\\hbar=1$) 和 $\\mu = 1/2$，因此 $E=k^2$。势 $V_l(p', p)$ 是分波投影的相互作用。\n\n对于 $P$ 波道 ($l=1$)，问题指定了一个可分离接触相互作用，形式如下：\n$$\nV_1(p', p) = C \\, g(p') \\, g(p)\n$$\n其中 $C$ 是待确定的 LEC，$g(p)$ 是一个依赖于截断 $\\Lambda$ 的调节函数。将此可分离形式代入 LS 方程得到：\n$$\nT_1(p', p; k^2) = C g(p') g(p) + \\frac{2}{\\pi} \\int_0^\\infty dq \\, q^2 \\, C g(p') g(q) \\, \\frac{1}{k^2 - q^2 + i\\epsilon} \\, T_1(q, p; k^2)\n$$\n该方程的结构意味着 $T$ 矩阵也必须是可分离的，形式为 $T_1(p', p; k^2) = \\tau(k) g(p') g(p)$。代入此拟设：\n$$\n\\tau(k) g(p') g(p) = C g(p') g(p) + C g(p') \\left( \\frac{2}{\\pi} \\int_0^\\infty dq \\, q^2 \\, \\frac{g(q) \\tau(k) g(q) g(p)}{k^2-q^2+i\\epsilon} \\right)\n$$\n两边除以公因子 $g(p') g(p)$，我们得到一个关于 $\\tau(k)$ 的代数方程：\n$$\n\\tau(k) = C + C \\tau(k) \\, I(k)\n$$\n其中 $I(k)$ 是圈图积分：\n$$\nI(k) = \\frac{2}{\\pi} \\int_0^\\infty dq \\, q^2 \\, \\frac{[g(q)]^2}{k^2 - q^2 + i\\epsilon}\n$$\n解出 $\\tau(k)$：\n$$\n\\tau(k) = \\frac{C}{1 - C I(k)}\n$$\n通过设置 $p' = p = k$ 得到在壳 $T$ 矩阵：\n$$\nT_1(k, k; k^2) = \\tau(k) [g(k)]^2 = \\frac{C [g(k)]^2}{1 - C I(k)}\n$$\n我们关心的是零能极限 ($k \\to 0$)，以便将其与散射体积 $a_1$ 联系起来。在此极限下，传播子的虚部消失，主值积分得以简化。圈图积分变为：\n$$\nI(k \\to 0) = I(0) = \\frac{2}{\\pi} \\mathcal{P} \\int_0^\\infty dq \\, q^2 \\, \\frac{[g(q)]^2}{-q^2} = -\\frac{2}{\\pi} \\int_0^\\infty dq \\, [g(q;\\Lambda)]^2\n$$\n我们将这个依赖于调节子的积分定义为：\n$$\nI_0(\\Lambda) = \\int_0^\\infty [g(q;\\Lambda)]^2 dq\n$$\n因此，$I(0) = -\\frac{2}{\\pi} I_0(\\Lambda)$。所提供的调节子形式 $g(k;\\Lambda)$ 都具有当 $k \\to 0$ 时 $g(k;\\Lambda) \\sim k$ 的性质。因此，分子 $[g(k)]^2 \\sim k^2$。低能极限下的在壳 $T$ 矩阵为：\n$$\nT_1(k, k; k^2 \\to 0) \\approx \\frac{C k^2}{1 - C \\left(-\\frac{2}{\\pi} I_0(\\Lambda)\\right)} = \\frac{C k^2}{1 + \\frac{2C}{\\pi} I_0(\\Lambda)}\n$$\n问题给出了低能关系 $T_{1}(k,k;E) \\sim -\\frac{2\\pi}{\\mu} k^{2} a_{1}$。当 $\\mu=1/2$ 时，这变为 $T_{1} \\sim -4\\pi k^{2} a_{1}$。将 $T$ 矩阵的两个表达式相等，并消去非零因子 $k^2$：\n$$\n-4\\pi a_{1} = \\frac{C}{1 + \\frac{2C}{\\pi} I_0(\\Lambda)}\n$$\n此方程建立了理论参数 $C$ 和可观测量 $a_1$ 之间的匹配条件。现在我们求解 $C$ 作为 $\\Lambda$ 和 $a_1$ 的函数：\n$$\n-4\\pi a_{1} \\left(1 + \\frac{2C}{\\pi} I_0(\\Lambda)\\right) = C\n$$\n$$\n-4\\pi a_{1} = C + 8 a_{1} C I_0(\\Lambda) = C(1 + 8 a_{1} I_0(\\Lambda))\n$$\n最终，我们得到为再现散射体积 $a_1$ 所需的 LEC 表达式：\n$$\nC(\\Lambda) = \\frac{-4\\pi a_{1}}{1 + 8 a_{1} I_0(\\Lambda)}\n$$\n\n**2. 数值与解析步骤**\n\n对每个测试用例，解决问题的算法如下：\n1.  **选择调节子**：从集合 $\\{g_{\\mathrm{NL}}, g_{\\mathrm{L}}, g_{\\mathrm{SL}}\\}$ 中选择指定的调节函数 $g(k;\\Lambda)$。\n2.  **计算 LEC**：对于给定列表中的每个截断值 $\\Lambda$：\n    a.  **数值积分**：计算积分 $I_0(\\Lambda) = \\int_0^\\infty [g(q;\\Lambda)]^2 dq$。被积函数是良态的，在 $q \\to \\infty$ 时迅速衰减，使其适合标准的数值求积例程。我们将使用 `scipy.integrate.quad` 在定义域 $[0, \\infty)$ 上进行计算，这是对此类定积分的稳健方法。\n    b.  **LEC 计算**：将计算出的 $I_0(\\Lambda)$ 值和给定的目标散射体积 $a_1$ 代入推导出的公式，以找到对应的 LEC 值 $C(\\Lambda)$。\n3.  **拟合标度指数**：计算出数据点对 $(\\Lambda_i, C(\\Lambda_i))$ 的集合后，我们分析 $C(\\Lambda)$ 随 $\\Lambda$ 的标度行为。预期的幂次计数行为是 $|C(\\Lambda)| \\propto \\Lambda^{-3}$，这意味着在双对数图中存在线性关系：\n    $$\n    \\log|C(\\Lambda)| = s \\log\\Lambda + \\text{const.}\n    $$\n    标度指数 $s$ 是这条线的斜率。我们对数据点集 $\\{(\\log\\Lambda_i, \\log|C(\\Lambda_i)|)\\}$ 进行线性最小二乘回归来提取斜率 $s$。`scipy.stats.linregress` 函数非常适合此任务。\n4.  **幂次计数一致性检验**：理论预期是 $s=-3$。我们定义一个布尔诊断值 $b$ 来检查数值确定的斜率 $s$ 是否在给定容差 $\\tau=0.25$ 内与此预期一致。条件是：\n    $$\n    b = (|s + 3| \\le \\tau)\n    $$\n5.  **生成输出**：每个用例的最终结果是数据对 $[s, b]$，由浮点数斜率和布尔诊断值组成。将这些结果汇总并格式化为指定的字符串表示。",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import quad\nfrom scipy.stats import linregress\n\ndef solve():\n    \"\"\"\n    Computes the scaling exponent for P-wave contact interaction LECs in chiral EFT.\n    \"\"\"\n\n    # Tolerance for the consistency check\n    TOLERANCE_TAU = 0.25\n\n    # --- Regulator function definitions ---\n    def g_nl(k, Lambda):\n        \"\"\"Nonlocal regulator form factor.\"\"\"\n        ratio = k / Lambda\n        return k * np.exp(-ratio**4)\n\n    def g_l(k, Lambda):\n        \"\"\"Local-like regulator form factor.\"\"\"\n        ratio_sq = (k / Lambda)**2\n        return k * (1.0 / (1.0 + ratio_sq))**2\n\n    def g_sl(k, Lambda):\n        \"\"\"Semilocal regulator form factor.\"\"\"\n        ratio_sq = (k / Lambda)**2\n        return k * np.exp(-ratio_sq) * (1.0 / (1.0 + ratio_sq))\n\n    # --- Integrands for the loop integral I_0 ---\n    # The integrand is g(r, Lambda)^2\n    def integrand_nl(r, Lambda):\n        return g_nl(r, Lambda)**2\n\n    def integrand_l(r, Lambda):\n        return g_l(r, Lambda)**2\n\n    def integrand_sl(r, Lambda):\n        return g_sl(r, Lambda)**2\n\n    # Map regulator names to their corresponding integrand functions\n    REGULATORS = {\n        'g_NL': integrand_nl,\n        'g_L': integrand_l,\n        'g_SL': integrand_sl\n    }\n\n    # --- Test suite definition ---\n    test_cases = [\n        {'regulator': 'g_NL', 'channel': '3P0', 'a1': -0.35, 'lambdas': [1.5, 2.0, 2.5, 3.0, 3.5]},\n        {'regulator': 'g_L', 'channel': '3P2', 'a1': 0.20, 'lambdas': [4.0, 5.0, 7.5, 10.0]},\n        {'regulator': 'g_SL', 'channel': '3P0', 'a1': -0.35, 'lambdas': [2.0, 4.0, 8.0, 16.0]},\n        {'regulator': 'g_NL', 'channel': '3P2', 'a1': 0.20, 'lambdas': [0.75, 1.0, 1.25, 1.5]},\n        {'regulator': 'g_L', 'channel': '3P0', 'a1': -0.35, 'lambdas': [8.0, 12.0, 16.0, 20.0]}\n    ]\n\n    def calculate_c(a1, Lambda, integrand_func):\n        \"\"\"\n        Calculates the LEC C(Lambda) for a given a1 and Lambda.\n        \"\"\"\n        # I_0(Lambda) = integral from 0 to inf of [g(r, Lambda)]^2 dr\n        # The quad function returns a tuple (result, error_estimate)\n        i0, _ = quad(integrand_func, 0, np.inf, args=(Lambda,))\n        \n        # C(Lambda) = -4*pi*a1 / (1 + 8*a1*I_0)\n        numerator = -4.0 * np.pi * a1\n        denominator = 1.0 + 8.0 * a1 * i0\n        \n        if np.isclose(denominator, 0):\n            # Pole corresponds to infinite scattering volume, not expected here.\n            return np.nan\n            \n        return numerator / denominator\n\n    results = []\n    for case in test_cases:\n        regulator_key = case['regulator']\n        a1 = case['a1']\n        lambdas = np.array(case['lambdas'])\n        \n        integrand_func = REGULATORS[regulator_key]\n        \n        log_lambdas = []\n        log_abs_cs = []\n        \n        for L in lambdas:\n            C_val = calculate_c(a1, L, integrand_func)\n            if not np.isnan(C_val):\n                log_lambdas.append(np.log(L))\n                log_abs_cs.append(np.log(np.abs(C_val)))\n        \n        # Perform linear regression to find the slope s\n        if len(log_lambdas) > 1:\n            lin_reg_result = linregress(log_lambdas, log_abs_cs)\n            slope_s = lin_reg_result.slope\n        else:\n            # Not enough points to determine a slope\n            slope_s = np.nan\n        \n        # P-wave power-counting consistency check\n        is_consistent = np.abs(slope_s + 3.0) <= TOLERANCE_TAU\n        \n        results.append([slope_s, is_consistent])\n\n    # Format the final output string exactly as specified\n    output_parts = []\n    for s, b in results:\n        # Convert boolean to lowercase 'true'/'false' for consistent output\n        b_str = 'true' if b else 'false'\n        output_parts.append(f\"[{s},{b_str}]\")\n    \n    final_output_string = f\"[{','.join(output_parts)}]\"\n    print(final_output_string)\n\nsolve()\n```"
        },
        {
            "introduction": "在真实的研究场景中，我们需要同时拟合多个低能常数以描述跨越不同分波和能量的大量实验数据。这个高级实践将引导你进入现代核物理参数估计的前沿领域：贝叶斯推断。你将学习如何构建一个包含实验误差和理论截断误差的复杂统计模型，对核力的低能常数进行全局拟合，并得到它们的后验分布和不确定性。",
            "id": "3549505",
            "problem": "要求您实现一个基于核相互作用的手征有效场论的计算核物理分析。具体来说，您必须使用相关似然，对跨越多个分波的相移数据，在次领头阶（NLO）上对核子-核子接触项低能常数进行全局拟合，并计算包含截断不确定度的后验分布。该分析必须从已确立的基本原理出发，以数学上精确的方式进行。\n\n推导的基础必须是：\n- 将后验分布与似然和先验的乘积联系起来的贝叶斯定理。\n- 带协方差数据的相关高斯似然，其中总协方差是实验协方差和理论截断不确定度协方差之和。\n- 假设在 NLO 上，相移关于跨多个分波的低能常数是一个线性模型。\n\n模型表示必须遵循以下设置：\n- 考虑四个分波：自旋单态s波 $^{1}\\!S_{0}$、自旋三重态s波 $^{3}\\!S_{1}$、自旋单态p波 $^{1}\\!P_{1}$ 和自旋三重态p波 $^{3}\\!P_{0}$。\n- 设实验室动能为 $E \\in \\{5,10,25,50\\}\\,\\mathrm{MeV}$，并使用 $p(E) = \\sqrt{m_N E / 2}/(\\hbar c)$ 计算质心动量 $p$（单位为 $\\mathrm{fm}^{-1}$），其中 $m_N = 938.92\\,\\mathrm{MeV}$ 且 $\\hbar c = 197.327\\,\\mathrm{MeV\\,fm}$。\n- 定义展开参数 $Q(E) = p(E)/\\Lambda_b$，其中 $\\Lambda_b$ 是破缺标度（单位为 $\\mathrm{fm}^{-1}$）。\n- 对相移（单位为弧度）使用参数线性的模型：\n  - 对于 $^{1}\\!S_{0}$：$\\delta_{^{1}\\!S_{0}}(E) = \\theta_1 + \\theta_2 Q(E)^2$。\n  - 对于 $^{3}\\!S_{1}$：$\\delta_{^{3}\\!S_{1}}(E) = \\theta_3 + \\theta_4 Q(E)^2$。\n  - 对于 $^{1}\\!P_{1}$：$\\delta_{^{1}\\!P_{1}}(E) = \\theta_5 Q(E)^2$。\n  - 对于 $^{3}\\!P_{0}$：$\\delta_{^{3}\\!P_{0}}(E) = \\theta_6 Q(E)^2$。\n- 假设参数矢量 $\\boldsymbol{\\theta} \\in \\mathbb{R}^6$ 服从均值为零、对角协方差为 $\\Sigma_{\\mathrm{prior}} = \\mathrm{diag}(s_\\theta^2,\\dots,s_\\theta^2)$ 的高斯自然性先验。\n\n实验数据规格：\n- 在能量 $E \\in \\{5,10,25,50\\}\\,\\mathrm{MeV}$ 下，每个分波观测到的相移数据（单位为弧度）由下式给出：\n  - $^{1}\\!S_{0}$: $\\{\\;0.195844,\\;0.190963,\\;0.175844,\\;0.149863\\;\\}$。\n  - $^{3}\\!S_{1}$: $\\{\\;0.047859,\\;0.044993,\\;0.035884,\\;0.019973\\;\\}$。\n  - $^{1}\\!P_{1}$: $\\{\\;0.003227,\\;0.005729,\\;0.012652,\\;0.023618\\;\\}$。\n  - $^{3}\\!P_{0}$: $\\{\\;0.000543,\\;0.000361,\\;-0.000732,\\;-0.003202\\;\\}$。\n- 实验测量不确定度对于s波（$^{1}\\!S_{0}$ 和 $^{3}\\!S_{1}$）为 $\\sigma_{\\mathrm{exp},S} = 0.002\\,\\mathrm{rad}$，对于p波（$^{1}\\!P_{1}$ 和 $^{3}\\!P_{0}$）为 $\\sigma_{\\mathrm{exp},P} = 0.003\\,\\mathrm{rad}$。\n- 实验协方差在每个分波内部呈块相关，根据相关系数 $r_{\\mathrm{exp}}$ 对该块内所有非对角元素对进行关联，而不同分波之间无关联；即，对于每个具有 $N_E$ 个能量点的分波块，定义\n  $$\\Sigma_{\\mathrm{exp,block}} = \\sigma_{\\mathrm{exp}}^2 \\left[(1-r_{\\mathrm{exp}}) I_{N_E} + r_{\\mathrm{exp}} \\mathbf{1}\\mathbf{1}^\\top\\right],$$\n  其中 $I_{N_E}$ 是大小为 $N_E$ 的单位矩阵，$\\mathbf{1}$ 是长度为 $N_E$ 的全一向量。\n\n理论截断不确定度模型：\n- 将每个数据点在 NLO 的截断不确定度的标准差建模为 $\\sigma_{\\mathrm{th}}(E) = \\bar c \\, Q(E)^2$，其中 $\\bar c$ 是一个常数振幅参数（单位为弧度）。\n- 通过核函数 $K(E_i,E_j) = \\exp\\left(-\\frac{|p(E_i) - p(E_j)|}{\\lambda_{\\mathrm{th}}}\\right)$ 施加能量间的相关性，其中 $\\lambda_{\\mathrm{th}}$ 是一个相关长度（单位为 $\\mathrm{fm}^{-1}$）。\n- 通过因子 $\\rho_{\\mathrm{pw}}$ 施加分波间的相关性：对于相同的分波为 $1$，对于不同的分波为 $\\rho_{\\mathrm{pw}}$。\n- 理论协方差则为\n  $$\\left[\\Sigma_{\\mathrm{th}}\\right]_{ij} = \\sigma_{\\mathrm{th}}(E_i)\\,\\sigma_{\\mathrm{th}}(E_j)\\,K(E_i,E_j)\\,\\chi_{\\mathrm{pw}}(i,j),$$\n  其中，如果 $i$ 和 $j$ 属于同一分波，则 $\\chi_{\\mathrm{pw}}(i,j) = 1$，否则 $\\chi_{\\mathrm{pw}}(i,j) = \\rho_{\\mathrm{pw}}$。\n\n似然：\n- 设 $\\mathbf{y} \\in \\mathbb{R}^{N}$ 是跨波和能量串联而成的相移数据向量，设 $A \\in \\mathbb{R}^{N \\times 6}$ 是由上述模型基函数构成的设计矩阵。相关高斯似然为\n  $$\\mathcal{L}(\\mathbf{y} \\mid \\boldsymbol{\\theta}) \\propto \\exp\\left(-\\tfrac{1}{2}(\\mathbf{y} - A\\boldsymbol{\\theta})^\\top \\Sigma^{-1} (\\mathbf{y} - A\\boldsymbol{\\theta})\\right),$$\n  其中 $\\Sigma = \\Sigma_{\\mathrm{exp}} + \\Sigma_{\\mathrm{th}}$ 是总协方差。\n\n您的任务：\n- 在上述线性-高斯假设下，使用指定的似然和先验，推导并实现 $\\boldsymbol{\\theta}$ 的后验分布。\n- 计算后验均值向量和后验标准差（后验协方差对角线元素的平方根）。\n- 使用上面提供的能量值和相移数据（弧度）。\n- 确保所有内部计算使用弧度和单位为 $\\mathrm{fm}^{-1}$ 的动量，并且展开参数 $Q$ 是无量纲的。\n\n测试套件：\n- 对以下三组参数集实施分析，每组定义一个测试用例：\n  1. Case A (基线): $\\Lambda_b = 3.0\\,\\mathrm{fm}^{-1}$, $\\lambda_{\\mathrm{th}} = 0.3\\,\\mathrm{fm}^{-1}$, $\\rho_{\\mathrm{pw}} = 0.2$, $\\bar c = 0.1\\,\\mathrm{rad}$, $s_\\theta = 1.0$, $r_{\\mathrm{exp},S} = 0.3$, $r_{\\mathrm{exp},P} = 0.2$。\n  2. Case B (小 $Q$ 和弱理论相关性): $\\Lambda_b = 5.0\\,\\mathrm{fm}^{-1}$, $\\lambda_{\\mathrm{th}} = 0.1\\,\\mathrm{fm}^{-1}$, $\\rho_{\\mathrm{pw}} = 0.1$, $\\bar c = 0.08\\,\\mathrm{rad}$, $s_\\theta = 2.0$, $r_{\\mathrm{exp},S} = 0.2$, $r_{\\mathrm{exp},P} = 0.1$。\n  3. Case C (强实验相关性): $\\Lambda_b = 2.5\\,\\mathrm{fm}^{-1}$, $\\lambda_{\\mathrm{th}} = 0.5\\,\\mathrm{fm}^{-1}$, $\\rho_{\\mathrm{pw}} = 0.4$, $\\bar c = 0.12\\,\\mathrm{rad}$, $s_\\theta = 0.5$, $r_{\\mathrm{exp},S} = 0.9$, $r_{\\mathrm{exp},P} = 0.8$。\n\n最终输出格式：\n- 您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表的结果。对于每个测试用例，输出一个包含12个浮点数的列表，其中包含 $\\theta_1,\\dots,\\theta_6$ 的后验均值，后跟其后验标准差。因此，最终输出必须是一个包含三个列表的列表：\n  $$\\big[\\,[\\mu_1,\\mu_2,\\mu_3,\\mu_4,\\mu_5,\\mu_6,\\sigma_1,\\sigma_2,\\sigma_3,\\sigma_4,\\sigma_5,\\sigma_6],\\,\\text{case B},\\,\\text{case C}\\,\\big],$$\n  其中所有数字都是无单位的，并代表以弧度为单位的角度（相移），以保证模型的一致性。最终的打印语句必须匹配此确切格式，不得包含任何附加文本。",
            "solution": "该问题要求进行贝叶斯分析，以确定六个低能常数（由向量 $\\boldsymbol{\\theta} \\in \\mathbb{R}^6$ 表示）的后验分布，使用的是核子-核子散射相移数据。该分析基于一个线性高斯模型，这使得后验分布的解析推导成为可能。\n\n根据贝叶斯定理，给定观测数据 $\\mathbf{y}$ 的参数 $\\boldsymbol{\\theta}$ 的后验概率分布与给定参数的数据似然 $\\mathcal{L}(\\mathbf{y} \\mid \\boldsymbol{\\theta})$ 和参数的先验分布 $p(\\boldsymbol{\\theta})$ 的乘积成正比：\n$$\np(\\boldsymbol{\\theta} \\mid \\mathbf{y}) \\propto \\mathcal{L}(\\mathbf{y} \\mid \\boldsymbol{\\theta}) \\, p(\\boldsymbol{\\theta})\n$$\n\n问题详细说明了相移的线性模型 $\\boldsymbol{\\delta}_{\\mathrm{model}}$ 是 $\\boldsymbol{\\theta}$ 的函数，可以用矩阵表示法表示为：\n$$\n\\boldsymbol{\\delta}_{\\mathrm{model}}(\\boldsymbol{\\theta}) = A \\boldsymbol{\\theta}\n$$\n在此方程中，$\\mathbf{y}$ 是包含 $N=16$ 个测量相移的向量，而 $A$ 是一个 $N \\times 6$ 的设计矩阵，它编码了相移对参数 $\\theta_j$ 的函数依赖性。\n\n似然 $\\mathcal{L}(\\mathbf{y} \\mid \\boldsymbol{\\theta})$ 被定义为一个以模型预测 $A\\boldsymbol{\\theta}$ 为中心的相关多元高斯分布：\n$$\n\\mathcal{L}(\\mathbf{y} \\mid \\boldsymbol{\\theta}) \\propto \\exp\\left(-\\frac{1}{2}(\\mathbf{y} - A\\boldsymbol{\\theta})^\\top \\Sigma^{-1} (\\mathbf{y} - A\\boldsymbol{\\theta})\\right)\n$$\n总协方差矩阵 $\\Sigma$ 是实验协方差矩阵 $\\Sigma_{\\mathrm{exp}}$ 和理论截断不确定度协方差矩阵 $\\Sigma_{\\mathrm{th}}$ 的和，即 $\\Sigma = \\Sigma_{\\mathrm{exp}} + \\Sigma_{\\mathrm{th}}$。\n\n$\\boldsymbol{\\theta}$ 的先验分布也被指定为高斯分布，其均值为零，对角协方差矩阵为 $\\Sigma_{\\mathrm{prior}} = s_\\theta^2 I_6$，其中 $I_6$ 是 $6 \\times 6$ 的单位矩阵：\n$$\np(\\boldsymbol{\\theta}) \\propto \\exp\\left(-\\frac{1}{2} \\boldsymbol{\\theta}^\\top \\Sigma_{\\mathrm{prior}}^{-1} \\boldsymbol{\\theta}\\right)\n$$\n\n结合似然和先验，后验分布的指数部分（负对数后验，不计常数项）成为似然和先验指数部分之和：\n$$\n\\chi^2(\\boldsymbol{\\theta}) = (\\mathbf{y} - A\\boldsymbol{\\theta})^\\top \\Sigma^{-1} (\\mathbf{y} - A\\boldsymbol{\\theta}) + \\boldsymbol{\\theta}^\\top \\Sigma_{\\mathrm{prior}}^{-1} \\boldsymbol{\\theta}\n$$\n展开第一项得到：\n$$\n\\chi^2(\\boldsymbol{\\theta}) = \\mathbf{y}^\\top \\Sigma^{-1} \\mathbf{y} - 2\\mathbf{y}^\\top \\Sigma^{-1} A \\boldsymbol{\\theta} + \\boldsymbol{\\theta}^\\top A^\\top \\Sigma^{-1} A \\boldsymbol{\\theta} + \\boldsymbol{\\theta}^\\top \\Sigma_{\\mathrm{prior}}^{-1} \\boldsymbol{\\theta}\n$$\n我们可以收集 $\\boldsymbol{\\theta}$ 的二次项和线性项：\n$$\n\\chi^2(\\boldsymbol{\\theta}) = \\boldsymbol{\\theta}^\\top (A^\\top \\Sigma^{-1} A + \\Sigma_{\\mathrm{prior}}^{-1}) \\boldsymbol{\\theta} - 2(\\mathbf{y}^\\top \\Sigma^{-1} A) \\boldsymbol{\\theta} + \\text{const.}\n$$\n$\\boldsymbol{\\theta}$ 的这种二次形式意味着后验分布 $p(\\boldsymbol{\\theta} \\mid \\mathbf{y})$ 也是一个多元高斯分布。通过配方并将其与高斯分布的标准指数形式 $- \\frac{1}{2}(\\boldsymbol{\\theta}-\\boldsymbol{\\mu}_{\\mathrm{post}})^\\top \\Sigma_{\\mathrm{post}}^{-1}(\\boldsymbol{\\theta}-\\boldsymbol{\\mu}_{\\mathrm{post}})$ 进行比较，我们可以确定后验均值 $\\boldsymbol{\\mu}_{\\mathrm{post}}$ 和后验协方差 $\\Sigma_{\\mathrm{post}}$。后验协方差的逆是：\n$$\n\\Sigma_{\\mathrm{post}}^{-1} = A^\\top \\Sigma^{-1} A + \\Sigma_{\\mathrm{prior}}^{-1}\n$$\n因此，后验协方差矩阵是：\n$$\n\\Sigma_{\\mathrm{post}} = \\left( A^\\top \\Sigma^{-1} A + \\Sigma_{\\mathrm{prior}}^{-1} \\right)^{-1}\n$$\n然后可以找到后验均值为：\n$$\n\\boldsymbol{\\mu}_{\\mathrm{post}} = \\Sigma_{\\mathrm{post}} (A^\\top \\Sigma^{-1} \\mathbf{y})\n$$\n任务是计算 $\\boldsymbol{\\mu}_{\\mathrm{post}}$ 和后验标准差。后者是 $\\Sigma_{\\mathrm{post}}$ 对角线元素的平方根：$\\sigma_k = \\sqrt{[\\Sigma_{\\mathrm{post}}]_{kk}}$。\n\n实现需要仔细构建矩阵 $A$、$\\Sigma_{\\mathrm{exp}}$ 和 $\\Sigma_{\\mathrm{th}}$。\n\n首先，我们确定运动学变量。对应于实验室动能 $E$ 的质心动量 $p$（单位 $\\mathrm{fm}^{-1}$）是 $p(E) = \\sqrt{m_N E / 2}/(\\hbar c)$，使用 $m_N = 938.92\\,\\mathrm{MeV}$ 和 $\\hbar c = 197.327\\,\\mathrm{MeV\\,fm}$。无量纲的展开参数是 $Q(E) = p(E)/\\Lambda_b$。数据是为能量 $E \\in \\{5, 10, 25, 50\\}\\,\\mathrm{MeV}$ 提供的。\n\n数据向量 $\\mathbf{y} \\in \\mathbb{R}^{16}$ 是通过串联四个分波的相移数据构建的：$^{1}\\!S_{0}$、$^{3}\\!S_{1}$、$^{1}\\!P_{1}$ 和 $^{3}\\!P_{0}$，按此顺序。\n\n$16 \\times 6$ 的设计矩阵 $A$ 是根据指定的相移线性模型构建的。设四个能量由 $k=0,1,2,3$ 索引。\n- 对于 $^{1}\\!S_{0}$ 通道（行 $0-3$），模型是 $\\theta_1 + \\theta_2 Q(E_k)^2$。$A$ 中对应的行是 $[1, Q(E_k)^2, 0, 0, 0, 0]$。\n- 对于 $^{3}\\!S_{1}$ （行 $4-7$），模型是 $\\theta_3 + \\theta_4 Q(E_k)^2$。行是 $[0, 0, 1, Q(E_k)^2, 0, 0]$。\n- 对于 $^{1}\\!P_{1}$ （行 $8-11$），模型是 $\\theta_5 Q(E_k)^2$。行是 $[0, 0, 0, 0, Q(E_k)^2, 0]$。\n- 对于 $^{3}\\!P_{0}$ （行 $12-15$），模型是 $\\theta_6 Q(E_k)^2$。行是 $[0, 0, 0, 0, 0, Q(E_k)^2]$。\n\n实验协方差矩阵 $\\Sigma_{\\mathrm{exp}}$ 是一个 $16 \\times 16$ 的块对角矩阵，由四个 $4 \\times 4$ 的块组成，每个分波一个。\n- 对于s波（$^{1}\\!S_{0}$, $^{3}\\!S_{1}$），块是 $\\Sigma_{\\mathrm{exp,block}} = \\sigma_{\\mathrm{exp},S}^2 \\left[(1-r_{\\mathrm{exp},S}) I_4 + r_{\\mathrm{exp},S} \\mathbf{1}\\mathbf{1}^\\top\\right]$，其中 $\\sigma_{\\mathrm{exp},S} = 0.002\\,\\mathrm{rad}$。\n- 对于p波（$^{1}\\!P_{1}$, $^{3}\\!P_{0}$），块是 $\\Sigma_{\\mathrm{exp,block}} = \\sigma_{\\mathrm{exp},P}^2 \\left[(1-r_{\\mathrm{exp},P}) I_4 + r_{\\mathrm{exp},P} \\mathbf{1}\\mathbf{1}^\\top\\right]$，其中 $\\sigma_{\\mathrm{exp},P} = 0.003\\,\\mathrm{rad}$。\n\n理论协方差矩阵 $\\Sigma_{\\mathrm{th}}$ 是一个密集的 $16 \\times 16$ 矩阵，其元素由下式给出：\n$$\n\\left[\\Sigma_{\\mathrm{th}}\\right]_{ij} = \\sigma_{\\mathrm{th}}(E_i)\\,\\sigma_{\\mathrm{th}}(E_j)\\,K(E_i,E_j)\\,\\chi_{\\mathrm{pw}}(i,j)\n$$\n其中 $i, j$ 是从 $0$ 到 $15$ 的全局索引。其组成项为：\n- 截断误差的标准差：$\\sigma_{\\mathrm{th}}(E_k) = \\bar c \\, Q(E_k)^2$。\n- 能量相关核：$K(E_i,E_j) = \\exp\\left(-\\frac{|p(E_i) - p(E_j)|}{\\lambda_{\\mathrm{th}}}\\right)$。\n- 分波相关因子 $\\chi_{\\mathrm{pw}}(i,j)$，如果数据点 $i$ 和 $j$ 属于同一分波（即 $\\lfloor i/4 \\rfloor = \\lfloor j/4 \\rfloor$），则其值为 $1$，否则为 $\\rho_{\\mathrm{pw}}$。\n\n在构建完所有矩阵后，我们计算总协方差 $\\Sigma = \\Sigma_{\\mathrm{exp}} + \\Sigma_{\\mathrm{th}}$ 并求其逆 $\\Sigma^{-1}$。先验协方差的逆是 $\\Sigma_{\\mathrm{prior}}^{-1} = (1/s_\\theta^2)I_6$。然后将这些分量用于推导出的解析公式，以计算后验均值向量 $\\boldsymbol{\\mu}_{\\mathrm{post}}$ 和后验标准差 $\\sigma_k$。对指定的三个测试用例中的每一个都执行这整个过程。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to orchestrate the analysis for all test cases.\n    \"\"\"\n    \n    # Global problem constants and data\n    M_N = 938.92  # MeV\n    HBAR_C = 197.327  # MeV fm\n    ENERGIES = np.array([5., 10., 25., 50.])  # MeV\n    DATA_PHASESHIFTS = np.array([\n        # 1S0\n        0.195844, 0.190963, 0.175844, 0.149863,\n        # 3S1\n        0.047859, 0.044993, 0.035884, 0.019973,\n        # 1P1\n        0.003227, 0.005729, 0.012652, 0.023618,\n        # 3P0\n        0.000543, 0.000361, -0.000732, -0.003202,\n    ])\n    SIGMA_EXP_S = 0.002  # rad\n    SIGMA_EXP_P = 0.003  # rad\n    NUM_ENERGIES = len(ENERGIES)\n    NUM_PARAMS = 6\n    NUM_DATA = len(DATA_PHASESHIFTS)\n\n    def solve_case(case_params):\n        \"\"\"\n        Solves for the posterior mean and std dev for one set of hyperparameters.\n        \"\"\"\n        lambda_b, lambda_th, rho_pw, c_bar, s_theta, r_exp_s, r_exp_p = case_params\n\n        # Step 1: Calculate kinematic variables (momentum p and expansion param Q)\n        p_vals = np.sqrt(M_N * ENERGIES / 2.0) / HBAR_C  # units of fm^-1\n        q_vals = p_vals / lambda_b\n        \n        p_vec = np.tile(p_vals, 4)\n        q_vec = np.tile(q_vals, 4)\n        \n        # Step 2: Construct the design matrix A (16x6)\n        A = np.zeros((NUM_DATA, NUM_PARAMS))\n        q2_vals = q_vals**2\n        \n        A[0:NUM_ENERGIES, 0] = 1.0\n        A[0:NUM_ENERGIES, 1] = q2_vals\n        \n        A[NUM_ENERGIES:2*NUM_ENERGIES, 2] = 1.0\n        A[NUM_ENERGIES:2*NUM_ENERGIES, 3] = q2_vals\n        \n        A[2*NUM_ENERGIES:3*NUM_ENERGIES, 4] = q2_vals\n        \n        A[3*NUM_ENERGIES:4*NUM_ENERGIES, 5] = q2_vals\n        \n        # Step 3: Construct the experimental covariance matrix Sigma_exp (16x16)\n        Sigma_exp = np.zeros((NUM_DATA, NUM_DATA))\n        ones_ne = np.ones((NUM_ENERGIES, NUM_ENERGIES))\n        eye_ne = np.eye(NUM_ENERGIES)\n        \n        block_S = SIGMA_EXP_S**2 * ((1 - r_exp_s) * eye_ne + r_exp_s * ones_ne)\n        block_P = SIGMA_EXP_P**2 * ((1 - r_exp_p) * eye_ne + r_exp_p * ones_ne)\n        \n        Sigma_exp[0:NUM_ENERGIES, 0:NUM_ENERGIES] = block_S\n        Sigma_exp[NUM_ENERGIES:2*NUM_ENERGIES, NUM_ENERGIES:2*NUM_ENERGIES] = block_S\n        Sigma_exp[2*NUM_ENERGIES:3*NUM_ENERGIES, 2*NUM_ENERGIES:3*NUM_ENERGIES] = block_P\n        Sigma_exp[3*NUM_ENERGIES:4*NUM_ENERGIES, 3*NUM_ENERGIES:4*NUM_ENERGIES] = block_P\n\n        # Step 4: Construct the theoretical covariance matrix Sigma_th (16x16)\n        sigma_th_vec = c_bar * q_vec**2\n        \n        p_dist_matrix = np.abs(p_vec[:, np.newaxis] - p_vec)\n        K_matrix = np.exp(-p_dist_matrix / lambda_th)\n        \n        wave_indices = np.repeat(np.arange(4), NUM_ENERGIES)\n        chi_pw_matrix = np.where(wave_indices[:, np.newaxis] == wave_indices, 1.0, rho_pw)\n        \n        sigma_th_outer = np.outer(sigma_th_vec, sigma_th_vec)\n        \n        Sigma_th = sigma_th_outer * K_matrix * chi_pw_matrix\n\n        # Step 5: Compute total covariance, its inverse, and prior inverse\n        Sigma_total = Sigma_exp + Sigma_th\n        Sigma_prior_inv = np.eye(NUM_PARAMS) / s_theta**2\n        \n        # Step 6: Calculate posterior mean and covariance\n        Sigma_total_inv = np.linalg.inv(Sigma_total)\n        \n        At_S_inv_A = A.T @ Sigma_total_inv @ A\n        Sigma_post = np.linalg.inv(At_S_inv_A + Sigma_prior_inv)\n        \n        At_S_inv_y = A.T @ Sigma_total_inv @ DATA_PHASESHIFTS\n        mu_post = Sigma_post @ At_S_inv_y\n        \n        std_post = np.sqrt(np.diag(Sigma_post))\n        \n        return mu_post.tolist() + std_post.tolist()\n\n    # Parameter sets for the three test cases\n    # (Lambda_b, lambda_th, rho_pw, c_bar, s_theta, r_exp_S, r_exp_P)\n    test_cases = [\n        (3.0, 0.3, 0.2, 0.1, 1.0, 0.3, 0.2),  # Case A\n        (5.0, 0.1, 0.1, 0.08, 2.0, 0.2, 0.1),  # Case B\n        (2.5, 0.5, 0.4, 0.12, 0.5, 0.9, 0.8),  # Case C\n    ]\n\n    results = []\n    for case in test_cases:\n        result = solve_case(case)\n        results.append(result)\n\n    # Print the results in the required single-line format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}