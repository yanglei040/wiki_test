{
    "hands_on_practices": [
        {
            "introduction": "这个练习旨在通过一个精确可解的玩具模型——$\\delta$-壳层势，来巩固您对有效程展开参数的理解。您将通过求解薛定谔方程，并将解与低能散射的渐进行为相匹配，从而从第一性原理推导出散射长度 $a$ 和有效程 $r_e$。这项实践将理论定义与具体的势散射计算联系起来，是掌握低能有效理论方法的关键一步。",
            "id": "3556974",
            "problem": "考虑中心势 $V(r)=\\lambda\\,\\delta(r-R)$ 中的低能 $s$ 波核子-核子散射，其中 $r$ 是粒子间距，$R0$ 是一个固定的力程参数，$\\lambda$ 是一个实耦合常数，$\\mu$ 是双体约化质量，$\\hbar$ 是约化普朗克常数。在三维空间中进行计算，并假设弹性散射，波数为 $k0$，能量为 $E=\\hbar^{2}k^{2}/(2\\mu)$。约化径向波函数 $u(r)$ 的 $s$ 波径向薛定谔方程为\n$$\n-\\frac{\\hbar^{2}}{2\\mu}\\,u''(r)+V(r)\\,u(r)=\\frac{\\hbar^{2}k^{2}}{2\\mu}\\,u(r),\n$$\n其中 $u(0)=0$ 且在无穷远处有通常的散射边界条件。$u'(r)$ 穿过 $\\delta$ 壳层的不连续性由势确定，且波函数在 $r=R$ 处是连续的。通过将内部解与外部自由解匹配来定义 $s$ 波相移 $\\delta_{0}(k)$，并采用有效程展开 (ERE)，\n$$\nk\\cot\\delta_{0}(k)=-\\frac{1}{a}+\\frac{r_{e}}{2}\\,k^{2}+O(k^{4}),\n$$\n来定义散射长度 $a$ 和有效程 $r_{e}$。\n\n任务：\n1. 从径向薛定谔方程和由 $V(r)=\\lambda\\,\\delta(r-R)$ 暗示的边界条件出发，推导 $k\\cot\\delta_{0}(k)$ 关于 $k$、$R$、$\\mu$、$\\hbar$ 和 $\\lambda$ 的精确表达式。\n2. 使用系统性的小 $k$ 展开，提取散射长度 $a$ 和有效程 $r_{e}$ 的闭合形式解析表达式。\n3. 概述一种计算策略，通过对径向方程进行积分并在 $r=R$ 处施加跳跃条件来生成小 $k$ 的数值相移 $\\delta_{0}(k)$，然后将 $k\\cot\\delta_{0}(k)$ 拟合到 ERE 以恢复 $a$ 和 $r_{e}$。请明确说明您使用的任何假设以及 $\\delta_{0}(k)$ 的角度单位。\n4. 讨论在参数空间 $(\\lambda,R)$ 中，散射长度 $a$ 何时发散，以及 $\\lambda$ 的符号如何定性地影响 $a$ 和 $r_{e}$。\n\n将您的最终答案表示为关于 $R$、$\\lambda$、$\\mu$ 和 $\\hbar$ 的 $(a,r_{e})$ 对的符号闭合形式解析表达式。不要代入数值，不要四舍五入，也不要在最终表达式中附加单位。您讨论中引用的任何角度都必须以弧度为单位。",
            "solution": "所述问题具有科学依据、提法恰当、客观，并包含唯一解所需的所有必要信息。径向薛定谔方程、$\\delta$壳层势和有效程展开是量子散射理论中的标准概念。因此，该问题被认为是有效的，并提供了解决方案。\n\n四个任务按顺序解决。\n\n1. 推导 $k\\cot\\delta_{0}(k)$ 的精确表达式\n约化径向波函数 $u(r)$ 的 $s$ 波径向薛定谔方程由以下公式给出：\n$$\n-\\frac{\\hbar^{2}}{2\\mu}\\,u''(r)+\\lambda\\,\\delta(r-R)\\,u(r)=\\frac{\\hbar^{2}k^{2}}{2\\mu}\\,u(r).\n$$\n这可以改写为 $u''(r) + k^2 u(r) = \\frac{2\\mu\\lambda}{\\hbar^2} \\delta(r-R) u(r)$。\n对于 $r \\neq R$，势为零，方程简化为自由粒子方程 $u''(r) + k^2 u(r) = 0$。\n\n在内部区域，$0  r  R$，解必须满足边界条件 $u(0)=0$。这导致解的形式为：\n$$\nu_{I}(r) = A \\sin(kr)\n$$\n其中 $A$ 为某个归一化常数。\n\n在外部区域，$r  R$，解必须采用散射波的形式，对于 $s$ 波，这用相移 $\\delta_{0}(k)$ 表示：\n$$\nu_{II}(r) = F \\sin(kr + \\delta_{0}(k))\n$$\n其中 $F$ 为某个常数。\n\n波函数 $u(r)$ 在 $r=R$ 处必须连续，要求 $u_I(R) = u_{II}(R)$。导数 $u'(r)$ 是不连续的。将薛定谔方程在一个无穷小区间 $[R-\\epsilon, R+\\epsilon]$ 上积分，得到导数的跳跃条件：\n$$\n\\lim_{\\epsilon\\to 0} [u'(R+\\epsilon) - u'(R-\\epsilon)] = \\frac{2\\mu\\lambda}{\\hbar^2} u(R)\n$$\n我们定义常数 $\\gamma = \\frac{2\\mu\\lambda}{\\hbar^2}$。在 $r=R$ 处的连接条件是：\n$$\nu_I(R) = u_{II}(R)\n$$\n$$\nu'_{II}(R) - u'_{I}(R) = \\gamma u_I(R)\n$$\n求解 $\\delta_0(k)$ 的一种系统方法是使用对数导数 $\\mathcal{L}(r) = u'(r)/u(r)$。跳跃条件变为 $\\mathcal{L}_{II}(R) - \\mathcal{L}_{I}(R) = \\gamma$。\n从每个区域的解中，我们发现：\n$$\n\\mathcal{L}_I(r) = \\frac{A k \\cos(kr)}{A \\sin(kr)} = k \\cot(kr)\n$$\n$$\n\\mathcal{L}_{II}(r) = \\frac{F k \\cos(kr+\\delta_0)}{F \\sin(kr+\\delta_0)} = k \\cot(kr+\\delta_0)\n$$\n将这些代入 $r=R$ 处的跳跃条件：\n$$\nk \\cot(kR+\\delta_0) - k \\cot(kR) = \\gamma\n$$\n使用三角恒等式 $\\cot(x+y) = \\frac{\\cot(x)\\cot(y)-1}{\\cot(x)+\\cot(y)}$，我们可以求解 $\\cot(\\delta_0)$。一种更直接的代数操作如下：\n$$\nk \\frac{\\cot(kR)\\cot(\\delta_0)-1}{\\cot(kR)+\\cot(\\delta_0)} - k\\cot(kR) = \\gamma\n$$\n两边乘以 $\\cot(kR)+\\cot(\\delta_0)$ 得到：\n$$\nk(\\cot(kR)\\cot(\\delta_0)-1) - k\\cot(kR)(\\cot(kR)+\\cot(\\delta_0)) = \\gamma(\\cot(kR)+\\cot(\\delta_0))\n$$\n$$\nk\\cot(kR)\\cot(\\delta_0) - k - k\\cot^2(kR) - k\\cot(kR)\\cot(\\delta_0) = \\gamma\\cot(kR) + \\gamma\\cot(\\delta_0)\n$$\n$$\n-k(1+\\cot^2(kR)) = \\gamma(\\cot(kR) + \\cot(\\delta_0))\n$$\n使用恒等式 $1+\\cot^2(x) = \\csc^2(x) = 1/\\sin^2(x)$：\n$$\n-\\frac{k}{\\sin^2(kR)} = \\gamma(\\cot(kR) + \\cot(\\delta_0))\n$$\n求解 $\\cot(\\delta_0)$ 得到 $\\cot(\\delta_0) = -\\cot(kR) - \\frac{k}{\\gamma \\sin^2(kR)}$。两边乘以 $k$，我们得到精确表达式：\n$$\nk\\cot\\delta_0(k) = -k\\cot(kR) - \\frac{k^2}{\\gamma \\sin^2(kR)}\n$$\n\n2. 提取 $a$ 和 $r_{e}$ 的解析表达式\n我们对 $k\\cot\\delta_0(k)$ 的精确表达式进行低能（小 $k$）展开，并将其与有效程展开 (ERE) $k\\cot\\delta_{0}(k)=-\\frac{1}{a}+\\frac{r_{e}}{2}\\,k^{2}+O(k^{4})$ 进行匹配。我们使用小 $x$ 的级数展开：\n$\\cot(x) = \\frac{1}{x} - \\frac{x}{3} - \\frac{x^3}{45} - \\dots$\n$\\frac{1}{\\sin^2(x)} = \\frac{1}{x^2} + \\frac{1}{3} + \\frac{x^2}{15} + \\dots$\n令 $x=kR$。第一项的展开是：\n$$\n-k\\cot(kR) = -k \\left( \\frac{1}{kR} - \\frac{kR}{3} + O(k^3) \\right) = -\\frac{1}{R} + \\frac{R}{3}k^2 + O(k^4)\n$$\n第二项的展开是：\n$$\n-\\frac{k^2}{\\gamma \\sin^2(kR)} = -\\frac{k^2}{\\gamma} \\left( \\frac{1}{(kR)^2} + \\frac{1}{3} + O(k^2) \\right) = -\\frac{1}{\\gamma R^2} - \\frac{1}{3\\gamma}k^2 + O(k^4)\n$$\n合并两项得到 $k\\cot\\delta_0(k)$ 的展开：\n$$\nk\\cot\\delta_0(k) = \\left(-\\frac{1}{R} - \\frac{1}{\\gamma R^2}\\right) + k^2\\left(\\frac{R}{3} - \\frac{1}{3\\gamma}\\right) + O(k^4)\n$$\n与 ERE 比较，我们确定系数。\n常数项给出散射长度 $a$：\n$$\n-\\frac{1}{a} = -\\frac{1}{R} - \\frac{1}{\\gamma R^2} = -\\frac{\\gamma R + 1}{\\gamma R^2} \\implies a = \\frac{\\gamma R^2}{1+\\gamma R}\n$$\n$k^2$ 项给出有效程 $r_e$：\n$$\n\\frac{r_e}{2} = \\frac{R}{3} - \\frac{1}{3\\gamma} = \\frac{\\gamma R - 1}{3\\gamma} \\implies r_e = \\frac{2}{3} \\left(R - \\frac{1}{\\gamma}\\right) = \\frac{2R}{3} - \\frac{2}{3\\gamma}\n$$\n代入 $\\gamma = \\frac{2\\mu\\lambda}{\\hbar^2}$，我们得到用问题参数表示的表达式：\n$$\na = \\frac{2\\mu\\lambda R^2}{\\hbar^2 + 2\\mu\\lambda R}\n$$\n$$\nr_e = \\frac{2R}{3} - \\frac{\\hbar^2}{3\\mu\\lambda}\n$$\n\n3. 计算策略概述\n寻找 $a$ 和 $r_e$ 的数值策略包括为一系列小的波数 $k$ 计算相移 $\\delta_0(k)$，然后将结果拟合到 ERE。所有角度都必须以弧度处理。\n1.  **数值积分**：对于一组小值中的每个 $k_i$，使用例如四阶龙格-库塔算法数值求解径向方程 $u''(r) = -k_i^2 u(r)$ (对于 $r \\neq R$)。\n    a.  **内部解**：从一个小的 $r_0  0$ 处开始积分，初始条件为 $u(r_0) = \\sin(k_i r_0)$ 和 $u'(r_0) = k_i \\cos(k_i r_0)$。向外积分到 $r=R$，得到 $u_I(R)$ 和 $u'_I(R)$。\n    b.  **跳跃条件**：应用跳跃条件以获得外部区域的初始值：$u_{II}(R) = u_I(R)$ 和 $u'_{II}(R) = u'_I(R) + \\gamma u_I(R)$。\n    c.  **外部解**：从 $r=R$ 积分到一个大半径 $r_{max}$，远至渐近区域，其中 $r_{max} \\gg R$。这给出数值 $u_{num}(r_{max})$ 和 $u'_{num}(r_{max})$。\n2.  **相移提取**：在 $r_{max}$ 处，数值解必须匹配渐近形式 $F \\sin(k_i r + \\delta_0)$。相移 $\\delta_0(k_i)$ 可以通过以下关系提取：\n    $$ \\delta_0(k_i) = \\arctan\\left(\\frac{k_i u_{num}(r_{max})}{u'_{num}(r_{max})}\\right) - k_i r_{max} $$\n    应使用反正切函数的主值，这与低能散射中 $\\delta_0$ 很小的情况一致。\n3.  **拟合**：为每个 $k_i$ 计算量 $y_i = k_i \\cot(\\delta_0(k_i))$。使用线性模型 $y = c + mx$ 对数据点 $(x_i, y_i) = (k_i^2, y_i)$ 进行线性最小二乘拟合。\n4.  **参数恢复**：然后从拟合结果中恢复散射参数：$a = -1/c$ 和 $r_e = 2m$。\n该方法假设数值积分是准确的，$r_{max}$ 足够大，并且所选的 $k_i$ 范围足够小，可以忽略 $O(k^4)$ 项。\n\n4. 关于散射长度 $a$ 的讨论\n散射长度为 $a = \\frac{2\\mu\\lambda R^2}{\\hbar^2 + 2\\mu\\lambda R}$。其行为由参数 $\\lambda$ 和 $R$ 决定。\n一个关键特征是 $a$ 的发散，这发生在分母为零时：$\\hbar^2 + 2\\mu\\lambda R = 0$。这发生在特定的吸引耦合强度 $\\lambda_c = -\\frac{\\hbar^2}{2\\mu R}$。这个条件标志着一个零能束缚态的形成。\n\n情况 I：排斥势 ($\\lambda  0$)。\n项 $2\\mu\\lambda R$ 是正的。$a$ 的分子和分母都是正的，所以 $a0$。当 $\\lambda \\to 0^+$ 时，$a \\to 0$。当 $\\lambda \\to \\infty$ 时，$a \\to \\frac{2\\mu\\lambda R^2}{2\\mu\\lambda R} = R$。这是硬球极限。因此，对于任何这种形式的排斥势，$0  a  R$。有效程 $r_e = \\frac{2R}{3} - \\frac{\\hbar^2}{3\\mu\\lambda}$ 在 $\\lambda \\to \\infty$ 时接近硬球值 $\\frac{2R}{3}$。\n\n情况 II：吸引势 ($\\lambda  0$)。\n项 $2\\mu\\lambda R$ 是负的。\n- 如果 $|\\lambda|  |\\lambda_c|$，则 $\\hbar^2 + 2\\mu\\lambda R  0$。由于分子是负的，$a  0$。这对应于无法形成束缚态的弱吸引力。\n- 如果 $|\\lambda| > |\\lambda_c|$，则 $\\hbar^2 + 2\\mu\\lambda R  0$。现在分子和分母都是负的，所以 $a  0$。这表明吸引力足够强，可以支持至少一个束缚态。\n- 如果 $|\\lambda| = |\\lambda_c|$，$a$ 发散。\n当 $\\lambda \\to -\\infty$ 时，$a \\to R$，再次达到势为无限吸引的硬球极限。有效程 $r_e = \\frac{2R}{3} - \\frac{\\hbar^2}{3\\mu\\lambda}$ 对于 $\\lambda0$ 总是正的，并且在 $\\lambda \\to -\\infty$ 时接近 $\\frac{2R}{3}$。当 $\\lambda \\to 0^-$ 时，它发散到 $+\\infty$。\n总之，对于吸引势，散射长度的符号和大小揭示了关于束缚态存在的关键信息。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{2\\mu\\lambda R^2}{\\hbar^2 + 2\\mu\\lambda R}  \\frac{2R}{3} - \\frac{\\hbar^2}{3\\mu\\lambda} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在掌握了散射长度和有效程之后，这个练习将引导您探索有效程展开中的更高阶项——形状参数 $P$。您将在一个特定的物理情境下，即方势阱恰好束缚一个零能态（导致散射长度发散），来计算形状参数。这项练习能加深您对有效程展开在“幺正极限”附近如何工作的理解，并锻炼您处理复杂级数展开的分析能力。",
            "id": "403215",
            "problem": "对低能核子-核子散射数据的分析通常使用s波（$l=0$）相移$\\delta_0$的有效程展开。对于质心系中给定的动能$E$，波数为$k = \\sqrt{2\\mu E}/\\hbar$，其中$\\mu$是双核子系统的折合质量。有效程展开由下式给出：\n$$k \\cot \\delta_0(k) = -\\frac{1}{a} + \\frac{1}{2} r_0 k^2 - P r_0^3 k^4 + O(k^6)$$\n此处，$a$是散射长度，$r_0$是有效程，$P$是无量纲形状参数。\n\n考虑一个用于描述自旋单态（$^1S_0$）道中核子-核子相互作用的简单模型，该模型由一个吸引方势阱描述：\n$$V(r) = \\begin{cases} -V_0  r \\le R \\\\ 0  r  R \\end{cases}$$\n其中$V_0  0$是势阱深度，$R$是势阱力程。对于此势，其强度由参数$K_0 = \\sqrt{2\\mu V_0/\\hbar^2}$定义。\n\n假设势参数$V_0$和$R$经过调节，满足条件$K_0 R = \\pi/2$。这个特定条件对应于势刚好足够强以支持一个零能束缚态的情况，这导致无穷大的散射长度（$a \\to \\infty$）。\n\n你的任务是计算此特定势的形状参数$P$的值。请用一个只包含数字和像$\\pi$这样的数学常数的闭式解析表达式来表示你的答案。",
            "solution": "1.  深度为$V_0$、力程为$R$的方势阱的s波相移的精确表达式，可以通过在$r=R$处匹配对数导数得到。可以求得\n$$\nk\\cot\\delta_0(k)\n=\\frac{k^2+k\\,q\\cot(qR)\\,\\cot(kR)}{k\\cot(kR)-q\\cot(qR)},\n\\qquad\nq=\\sqrt{K_0^2+k^2},\\;K_0=\\sqrt{2\\mu V_0/\\hbar^2}\\,. \n$$\n\n2.  施加调节条件$K_0R=\\pi/2$，此时$a\\to\\infty$。将所有量按$k$的幂次展开到$O(k^4)$阶：\n\\begin{align*}\nq=K_0+\\frac{k^2}{2K_0}-\\frac{k^4}{8K_0^3}+O(k^6),\\\\\n\\cot(qR)=\\cot\\!\\Bigl(\\tfrac\\pi2+\\Delta\\Bigr)\n=-\\tan\\Delta\n=-\\Bigl(\\Delta+\\tfrac{\\Delta^3}{3}\\Bigr)+O(\\Delta^5),\n\\quad \\Delta=R\\Bigl(\\tfrac{k^2}{2K_0}-\\tfrac{k^4}{8K_0^3}\\Bigr),\n\\end{align*}\n这给出\n$$\nq\\cot(qR)\n=-\\frac R2\\,k^2-\\frac{R}{8K_0^2}\\,k^4+O(k^6),\n\\qquad\nk\\cot(kR)\n=\\frac1R-\\frac{R}{3}\\,k^2-\\frac{R^3}{45}\\,k^4+O(k^6).\n$$\n\n3.  代入精确公式并进行泰勒展开，\n$$\nk\\cot\\delta_0(k)\n=\\frac{\\tfrac12k^2+\\bigl(\\tfrac{R^2}{6}-\\tfrac1{8K_0^2}\\bigr)k^4+O(k^6)}\n{\\tfrac1R+\\tfrac{R}{6}k^2+\\bigl(\\tfrac{R}{8K_0^2}-\\tfrac{R^3}{45}\\bigr)k^4+O(k^6)}.\n$$\n将此写为\n$$\nk\\cot\\delta_0(k)\n=\\frac{r_0}{2}\\,k^2\\,-\\,P\\,r_0^3\\,k^4+O(k^6),\n$$\n可以确定\n$$\n\\frac{r_0}{2}=\\frac{R}{2}\\quad\\Longrightarrow\\quad r_0=R,\n$$\n以及\n$$\n-P\\,R^3\n=\\frac{R^3}{12}-\\frac{R}{8K_0^2}.\n$$\n\n4.  最后使用$K_0R=\\pi/2\\implies1/K_0^2=4R^2/\\pi^2$：\n$$\n-P\\,R^3\n=R^3\\Bigl(\\tfrac1{12}-\\tfrac1{2\\pi^2}\\Bigr)\n\\;\\Longrightarrow\\;\nP=\\frac1{2\\pi^2}-\\frac1{12}\n=\\frac{6-\\pi^2}{12\\pi^2}\\,. \n$$",
            "answer": "$$\\boxed{\\frac{6-\\pi^2}{12\\pi^2}}$$"
        },
        {
            "introduction": "这项实践将理论分析推向了真实的计算物理应用，专注于带电粒子散射，例如质子-质子散射。您将学习如何处理由库仑相互作用引入的复杂性，并实现库仑修正的有效程函数。通过生成模拟数据并进行数值拟合，您将亲手从相移中提取出库仑修正的散射长度 $a_c$ 和有效程 $r_{e,c}$，这完美地模拟了分析实验数据的过程。",
            "id": "3556941",
            "problem": "要求您实现一个计算程序，用于构建低能质子-质子散射在自旋单态S波道中的库仑修正有效程函数，并提取库仑修正的散射长度和有效程。该推导和算法必须基于散射理论的第一性原理和标准特殊函数，从叠加在长程库仑势上的短程强相互作用出发。最终程序必须生成与低能正演模型一致的合成强相互作用相移数据，然后通过在小动量下拟合库仑修正的有效程函数，数值提取库仑修正的散射长度和有效程。\n\n您必须使用的基本出发点是：\n- 在存在库仑势的情况下，质子-质子散射存在S波相移 $\\,\\delta_c(k)\\,$，其中 $k$ 是质心动量。\n- 通过精细结构常数和约化质量定义的排斥性库仑势的索末菲参数 $\\,\\eta\\,$。\n- 作为带电粒子散射中库仑波函数归一化的伽莫夫穿透因子。\n- 双伽玛函数（伽玛函数的对数导数）及其在库仑波函数解析分析中的出现。\n- 关于短程相互作用的一个基本事实是中性系统的有效程展开 $\\,k \\cot \\delta = -1/a + \\tfrac{1}{2} r_e k^2 + \\mathcal{O}(k^4)\\,$，由此可以构建一个库仑修正的解析有效程函数。\n\n您的任务：\n1. 在一致的自然单位制中，为带电S波散射实现以下要素：\n   - 精细结构常数 $\\,\\alpha\\,$，其值为 $\\,\\alpha = 1/137.035999084\\,$。\n   - 质子质量 $\\,m_p = 938.2720813\\,\\mathrm{MeV}\\,$ 和转换因子 $\\,\\hbar c = 197.3269804\\,\\mathrm{MeV\\,fm}\\,$。使用这些值，通过 $\\,\\mu = \\tfrac{m_p}{2\\,\\hbar c}\\,$ 计算质子-质子系统的约化质量 $\\,\\mu\\,$，单位为逆费米 ($\\,\\mathrm{fm}^{-1}$)。\n   - 对于每个动量 $\\,k\\,$（以 $\\,\\mathrm{fm}^{-1}$ 表示），计算索末菲参数 $\\,\\eta = \\alpha \\mu / k\\,$。\n   - 伽莫夫穿透因子 $\\,C_\\eta^2\\,$ 作为一个关于 $\\,\\eta\\,$ 的函数的数值稳定表达式。\n   - 一个由双伽玛函数构建的复值辅助函数 $\\,H(\\eta)\\,$，及其对应的实部 $\\,h(\\eta)\\,$。\n2. 使用 $\\,k\\,$, $\\,\\delta_c(k)\\,$, $\\,C_\\eta^2\\,$ 和 $\\,h(\\eta)\\,$ 定义库仑修正的有效程函数 $\\,K_c(k^2)\\,$，使其对于排斥性库仑加短程强相互作用在 $\\,k=0\\,$ 处是解析的。您的实现必须通过 $\\,C_\\eta^2\\,$ 和 $\\,h(\\eta)\\,$ 正确地包含库仑效应，以便 $\\,K_c(k^2)\\,$ 具有一个由库仑修正的散射长度 $\\,a_c\\,$ 和有效程 $\\,r_{e,c}\\,$ 表征的低能展开。\n3. 使用一个与在 $\\,k^2\\,$ 项后截断的库仑修正有效程展开内部一致的正演模型，生成合成的S波强相互作用相移 $\\,\\delta_c(k)\\,$，并在指定时可选地包含形状参数项 $\\,P_c k^4\\,$。该正演模型必须通过反转您对 $\\,K_c(k^2)\\,$ 的定义，从目标 $\\,K_c(k^2)\\,$ 构建每个 $\\,k\\,$ 处的 $\\,\\delta_c(k)\\,$。角度必须以弧度表示。\n4. 根据生成的 $\\,\\delta_c(k)\\,$ 数据，使用您的实现重构每个 $\\,k\\,$ 处的 $\\,K_c(k^2)\\,$，并在低动量区域对 $\\,K_c\\,$ 与 $\\,k^2\\,$ 进行线性回归，以提取 $\\,a_c\\,$ 和 $\\,r_{e,c}\\,$。利用 $\\,K_c(k^2)\\,$ 低能展开的常数项和斜率确定 $\\,a_c\\,$ 和 $\\,r_{e,c}\\,$ 的关系。将 $\\,a_c\\,$ 和 $\\,r_{e,c}\\,$ 以费米 ($\\,\\mathrm{fm}\\,$) 表示。\n5. 生成指定测试套件的最终输出，将每个案例提取的 $\\,a_c\\,$ 和 $\\,r_{e,c}\\,$ 汇总到一个列表中，并将报告的每个值四舍五入到三位小数。\n\n单位和数值约定：\n- 在动力学计算中使用 $\\,\\hbar = c = 1\\,$ 的自然单位制，在需要时通过 $\\,\\hbar c\\,$ 进行显式转换。\n- 动量 $\\,k\\,$ 必须以 $\\,\\mathrm{fm}^{-1}$ 为单位。\n- 约化质量 $\\,\\mu\\,$ 必须以 $\\,\\mathrm{fm}^{-1}$ 为单位计算。\n- 角度 $\\,\\delta_c\\,$ 必须以弧度为单位。\n- 提取的 $\\,a_c\\,$ 和 $\\,r_{e,c}\\,$ 必须以 $\\,\\mathrm{fm}\\,$ 为单位，并在最终输出中四舍五入到三位小数。\n\n测试套件：\n- 案例 1（正常路径，极低动量）：\n  - 目标参数：$\\,a_c = -7.82\\,\\mathrm{fm}\\,$, $\\,r_{e,c} = 2.79\\,\\mathrm{fm}\\,$, $\\,P_c = 0\\,\\mathrm{fm}^3\\,$。\n  - 动量：$\\,k \\in \\{0.01, 0.02, 0.03, 0.05, 0.08\\}\\,\\mathrm{fm}^{-1}$。\n- 案例 2（边界情况，极端低动量以考验大 $\\,\\eta$ 时的数值稳定性）：\n  - 目标参数：$\\,a_c = -7.82\\,\\mathrm{fm}\\,$, $\\,r_{e,c} = 2.79\\,\\mathrm{fm}\\,$, $\\,P_c = 0\\,\\mathrm{fm}^3\\,$。\n  - 动量：$\\,k \\in \\{0.005, 0.0075, 0.01, 0.012\\}\\,\\mathrm{fm}^{-1}$。\n- 案例 3（曲率情况，具有非零形状参数）：\n  - 目标参数：$\\,a_c = -5.00\\,\\mathrm{fm}\\,$, $\\,r_{e,c} = 3.00\\,\\mathrm{fm}\\,$, $\\,P_c = 1.00\\,\\mathrm{fm}^3\\,$。\n  - 动量：$\\,k \\in \\{0.05, 0.10, 0.15, 0.20\\}\\,\\mathrm{fm}^{-1}$。\n\n要求的最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的、逗号分隔的结果列表。该列表必须包含案例1提取的 $\\,a_c\\,$ 和 $\\,r_{e,c}\\,$，然后是案例2的，接着是案例3的，每个值都四舍五入到三位小数。例如：\"[a1,r1,a2,r2,a3,r3]\"，其中每个\"a\"和\"r\"都是以费米为单位、保留三位小数的浮点数。",
            "solution": "这个问题是有效的，因为它科学地基于低能量子散射理论的原理，提法明确、目标清晰，并提供了一套完整且一致的数据和约束。这些任务描述了核理论中一个标准的、尽管并非微不足道的计算物理练习。\n\n解决方案首先为质子-质子散射建立理论框架，该框架涉及叠加在长程排斥库仑势上的短程强核相互作用。分析的核心是库仑修正的有效程展开。\n\n**1. 理论框架：库仑修正的有效程展开**\n\n对于由S波（轨道角动量 $\\ell=0$）主导的低能散射，相互作用由相移 $\\delta$ 表征。对于中性粒子，S波的有效程展开由下式给出：\n$$ k \\cot \\delta = -\\frac{1}{a} + \\frac{1}{2} r_e k^2 + \\mathcal{O}(k^4) $$\n其中 $k$ 是质心动量，$a$ 是散射长度，$r_e$ 是有效程。对于短程势，此表达式在 $k^2$ 上是解析的。\n\n对于带电粒子，如质子-质子散射，长程库仑势显著地改变了散射波函数。对于 $k \\cot\\delta_c$（其中 $\\delta_c$ 是在库仑场存在下的核相移）的简单展开在 $k=0$ 处不再是解析的。为了吸收库仑奇点，我们构建了一个修正函数 $K_c(k^2)$，从而得到一个在 $k^2$ 上再次解析并容许一个类似于中性情况的幂级数展开的函数。\n\n这个库仑修正的有效程函数的定义是：\n$$ K_c(k^2) \\equiv k C_\\eta^2(k) \\cot\\delta_c(k) + 2k\\eta h(\\eta) $$\n该函数具有所需的低能展开：\n$$ K_c(k^2) = -\\frac{1}{a_c} + \\frac{1}{2} r_{e,c} k^2 + P_c k^4 + \\mathcal{O}(k^6) $$\n其中 $a_c$ 和 $r_{e,c}$ 分别是库仑修正的散射长度和有效程，$P_c$ 是一个形状参数。$K_c(k^2)$ 定义中的各项均基于基本常数和标准特殊函数。\n\n**2. 物理常数和函数**\n\n该实现需要几个关键要素：\n\n- **物理常数**：精细结构常数 $\\alpha = 1/137.035999084$，质子质量 $m_p = 938.2720813\\,\\mathrm{MeV}$，以及转换因子 $\\hbar c = 197.3269804\\,\\mathrm{MeV\\,fm}$。\n- **约化质量**：对于质子-质子系统，约化质量 $\\mu$ 为 $\\mu = m_p / 2$。以所需的单位 $\\mathrm{fm}^{-1}$ 表示，即 $\\mu = \\frac{m_p}{2\\hbar c}$。\n- **索末菲参数 ($\\eta$)**：这个无量纲参数量化了库仑相互作用相对于动能的强度。对于排斥势，其表达式为：\n$$ \\eta(k) = \\frac{e^2}{4\\pi\\epsilon_0 \\hbar v} = \\frac{\\alpha c}{v} = \\frac{\\alpha \\mu c^2}{\\hbar c k} = \\frac{\\alpha \\mu}{k} $$\n其中 $v$ 是相对速度。在我们选择的单位中，$k$ 以 $\\mathrm{fm}^{-1}$ 为单位，$\\mu$ 以 $\\mathrm{fm}^{-1}$ 为单位。\n- **伽莫夫穿透因子 ($C_\\eta^2$)**：该因子描述了由于排斥性库仑势垒导致波函数在原点处的概率抑制。对于 $\\eta  0$：\n$$ C_\\eta^2 = \\frac{2\\pi\\eta}{e^{2\\pi\\eta}-1} $$\n为了保证数值稳定性，特别是在 $\\eta \\to \\infty$（即 $k \\to 0$）时，使用 `expm1(x)` 函数，它计算 $e^x-1$。\n- **辅助库仑函数 ($h(\\eta)$)**：此函数源于正则库仑波函数的解析结构。它通过双伽玛函数 $\\psi(z) = \\Gamma'(z)/\\Gamma(z)$ 定义为：\n$$ h(\\eta) = \\frac{1}{2}\\left[\\psi(i\\eta) + \\psi(-i\\eta)\\right] - \\ln\\eta = \\mathrm{Re}[\\psi(i\\eta)] - \\ln\\eta $$\n此函数可使用提供复数参数双伽玛函数的标准科学库来计算。\n\n**3. 算法流程**\n\n该问题通过两个主要阶段解决：生成合成数据，然后对其进行拟合以提取底层参数。\n\n**阶段 I：合成数据生成（正演模型）**\n目标是从一组已知的“真实”有效程参数（$a_c^{\\text{true}}$、$r_{e,c}^{\\text{true}}$、$P_c^{\\text{true}}$）生成真实的相移数据 $\\delta_c(k)$。\n\n1.  对于指定测试集中的每个动量 $k_i$，计算其对应的 $k_i^2$。\n2.  使用以下展开式计算有效程函数的真实值 $K_{c}^{\\text{true}}(k_i^2)$：\n    $$ K_{c}^{\\text{true}}(k_i^2) = -\\frac{1}{a_c^{\\text{true}}} + \\frac{1}{2} r_{e,c}^{\\text{true}} k_i^2 + P_c^{\\text{true}} k_i^4 $$\n3.  计算相关的库仑函数：$\\eta_i = \\eta(k_i)$、$C_{\\eta_i}^2$ 和 $h(\\eta_i)$。\n4.  反转 $K_c(k^2)$ 的定义以求解 $\\cot\\delta_c(k_i)$：\n    $$ \\cot\\delta_c(k_i) = \\frac{K_{c}^{\\text{true}}(k_i^2) - 2k_i\\eta_i h(\\eta_i)}{k_i C_{\\eta_i}^2} $$\n5.  最后，获得以弧度为单位的相移：$\\delta_c(k_i) = \\mathrm{arccot}(\\cot\\delta_c(k_i))$。这可以实现为 $\\arctan(1/x)$。\n\n**阶段 II：参数提取（反演问题）**\n有了合成数据对 $(k_i, \\delta_c(k_i))$，任务就是恢复有效程参数。\n\n1.  对于每个数据对，根据其定义计算有效程函数的“测量”值 $K_{c}^{\\text{meas}}(k_i^2)$：\n    $$ K_{c}^{\\text{meas}}(k_i^2) = k_i C_{\\eta_i}^2(k_i) \\cot\\delta_c(k_i) + 2k_i\\eta_i h(\\eta_i) $$\n    其中 $\\cot\\delta_c(k_i) = 1/\\tan\\delta_c(k_i)$。\n2.  此过程产生一组点 $(X_i, Y_i) = (k_i^2, K_{c}^{\\text{meas}}(k_i^2))$。\n3.  对这些点进行线性回归，将它们拟合到模型 $Y = mX + c$。这对应于在 $k^2$ 项处截断有效程展开。使用最小二乘法找到最拟合数据的斜率 $m$ 和截距 $c$。\n4.  通过将拟合结果与理论展开 $K_c(k^2) \\approx -\\frac{1}{a_c} + \\frac{1}{2} r_{e,c} k^2$进行比较，确定提取的参数 $a_c$ 和 $r_{e,c}$：\n    - 截距 $c$ 对应于常数项：$c = -1/a_c \\implies a_c = -1/c$。\n    - 斜率 $m$ 对应于 $k^2$ 的系数：$m = \\frac{1}{2} r_{e,c} \\implies r_{e,c} = 2m$。\n\n对所提供的三个测试案例中的每一个都重复此过程。对于包含非零形状参数 $P_c$ 的案例3，线性拟合是一个近似值。因此，提取出的 $a_c$ 和 $r_{e,c}$ 值将与“真实”输入值略有不同，这展示了在拟合中忽略高阶项的系统性效应。最终结果按要求四舍五入到三位小数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import psi\n\ndef solve():\n    \"\"\"\n    Implements the full procedure to generate synthetic proton-proton scattering data\n    and extract the Coulomb-modified effective range parameters.\n    \"\"\"\n\n    # Define physical constants as per the problem statement\n    ALPHA = 1 / 137.035999084\n    M_P_MEV = 938.2720813\n    HBAR_C_MEV_FM = 197.3269804\n\n    # Calculate reduced mass in fm^-1\n    MU_FM_INV = M_P_MEV / (2 * HBAR_C_MEV_FM)\n\n    def calculate_coulomb_functions(k_fm_inv):\n        \"\"\"\n        Calculates the Sommerfeld parameter, Gamow factor, and h(eta) function.\n        \n        Args:\n            k_fm_inv (np.ndarray): Array of momenta in fm^-1.\n            \n        Returns:\n            tuple: (eta, c_eta_sq, h_eta) as numpy arrays.\n        \"\"\"\n        # Ensure k is not zero to avoid division by zero in eta calculation.\n        # The limit k-0 is handled by the asymptotic behavior of the functions.\n        k_safe = np.where(k_fm_inv == 0, 1e-12, k_fm_inv)\n        \n        # Sommerfeld parameter (dimensionless)\n        eta = ALPHA * MU_FM_INV / k_safe\n        \n        # Gamow penetration factor C_eta^2 = 2*pi*eta / (exp(2*pi*eta) - 1)\n        # Use np.expm1 for numerical stability with large arguments.\n        two_pi_eta = 2 * np.pi * eta\n        c_eta_sq = np.divide(two_pi_eta, np.expm1(two_pi_eta), \n                             out=np.zeros_like(two_pi_eta), \n                             where=np.expm1(two_pi_eta) != 0)\n\n        # h(eta) = Re[psi(i*eta)] - log(eta)\n        # scipy.special.psi computes the digamma function.\n        h_eta = psi(1j * eta).real - np.log(eta)\n        \n        return eta, c_eta_sq, h_eta\n\n    def generate_phase_shifts(ks, ac_true, rec_true, pc_true):\n        \"\"\"\n        Generates synthetic S-wave phase shifts using a forward model based on the\n        Coulomb-modified effective range expansion.\n        \n        Args:\n            ks (list): List of momenta in fm^-1.\n            ac_true (float): True Coulomb-modified scattering length in fm.\n            rec_true (float): True Coulomb-modified effective range in fm.\n            pc_true (float): True shape parameter in fm^3.\n            \n        Returns:\n            np.ndarray: Array of phase shifts delta_c in radians.\n        \"\"\"\n        ks_arr = np.array(ks)\n        k_sq = ks_arr**2\n        \n        eta, c_eta_sq, h_eta = calculate_coulomb_functions(ks_arr)\n        \n        # Calculate the \"true\" effective range function K_c(k^2) from parameters\n        kc_true = -1/ac_true + 0.5 * rec_true * k_sq + pc_true * k_sq**2\n        \n        # Invert the definition of K_c to find cot(delta_c)\n        # K_c = k*C_eta^2*cot(delta_c) + 2*k*eta*h(eta)\n        numerator = kc_true - 2 * ks_arr * eta * h_eta\n        denominator = ks_arr * c_eta_sq\n        cot_delta_c = np.divide(numerator, denominator, \n                                out=np.full_like(numerator, np.inf), \n                                where=denominator != 0)\n        \n        # Phase shift delta_c = arccot(x) = arctan(1/x)\n        delta_c = np.arctan(1 / cot_delta_c)\n        \n        return delta_c\n\n    def extract_parameters(ks, delta_c):\n        \"\"\"\n        Reconstructs the effective range function from phase shifts and performs a\n        linear fit to extract the scattering length and effective range.\n        \n        Args:\n            ks (list): List of momenta in fm^-1.\n            delta_c (np.ndarray): Array of phase shifts in radians.\n            \n        Returns:\n            tuple: (ac_fit, rec_fit) extracted parameters in fm.\n        \"\"\"\n        ks_arr = np.array(ks)\n        k_sq = ks_arr**2\n        \n        eta, c_eta_sq, h_eta = calculate_coulomb_functions(ks_arr)\n        \n        cot_delta_c = 1 / np.tan(delta_c)\n        \n        # Reconstruct K_c(k^2) from the \"measured\" phase shifts\n        kc_meas = ks_arr * c_eta_sq * cot_delta_c + 2 * ks_arr * eta * h_eta\n        \n        # Perform linear regression: K_c vs k^2. Model: y = m*x + c\n        # np.polyfit(x, y, 1) returns [m, c] for a fit of degree 1.\n        m, c = np.polyfit(k_sq, kc_meas, 1)\n        \n        # Extract parameters from fit coefficients:\n        # Intercept c = -1/a_c  =  a_c = -1/c\n        # Slope m = (1/2)*r_e,c  =  r_e,c = 2*m\n        ac_fit = -1 / c\n        rec_fit = 2 * m\n        \n        return ac_fit, rec_fit\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (happy path, very low momenta)\n        {'params': {'ac_true': -7.82, 'rec_true': 2.79, 'pc_true': 0.0},\n         'ks': [0.01, 0.02, 0.03, 0.05, 0.08]},\n        # Case 2 (edge case, extremely low momenta)\n        {'params': {'ac_true': -7.82, 'rec_true': 2.79, 'pc_true': 0.0},\n         'ks': [0.005, 0.0075, 0.01, 0.012]},\n        # Case 3 (curvature case with non-zero shape parameter)\n        {'params': {'ac_true': -5.00, 'rec_true': 3.00, 'pc_true': 1.00},\n         'ks': [0.05, 0.10, 0.15, 0.20]}\n    ]\n\n    results = []\n    for case in test_cases:\n        p = case['params']\n        ks = case['ks']\n        \n        # 1. Generate synthetic phase shifts from true parameters\n        delta_c_data = generate_phase_shifts(ks, p['ac_true'], p['rec_true'], p['pc_true'])\n        \n        # 2. Extract parameters by fitting the generated data\n        ac_extracted, rec_extracted = extract_parameters(ks, delta_c_data)\n        \n        # 3. Append rounded results to the final list\n        results.append(round(ac_extracted, 3))\n        results.append(round(rec_extracted, 3))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}