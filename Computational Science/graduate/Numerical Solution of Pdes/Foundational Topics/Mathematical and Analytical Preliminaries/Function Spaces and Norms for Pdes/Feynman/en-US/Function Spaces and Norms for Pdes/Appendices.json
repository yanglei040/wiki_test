{
    "hands_on_practices": [
        {
            "introduction": "Understanding function spaces begins with a firm grasp of their norms. This first practice moves beyond abstract definitions by asking you to compute the $H^1$ norm and seminorm for a simple, familiar function. By carrying out this calculation , you will gain direct, hands-on experience with how the norm quantifies both the overall size of a function and the magnitude of its derivatives, a crucial distinction in the analysis of PDEs.",
            "id": "3397294",
            "problem": "Consider the Sobolev space $H^{1}(0,1)$ associated with the interval $(0,1)$, arising in the weak formulation of linear elliptic partial differential equations (PDEs). Let $u(x)=\\sin(\\pi x)$ for $x\\in(0,1)$. Using only the foundational definitions of the Lebesgue space $L^{2}(0,1)$ norm, the weak derivative, the $H^{1}(0,1)$ seminorm, and the $H^{1}(0,1)$ norm, compute the $H^{1}(0,1)$ seminorm and the $H^{1}(0,1)$ norm of $u$. Then compare their magnitudes by forming the ratio of the seminorm to the norm. Report your result as the row vector $\\big(|u|_{H^{1}(0,1)},\\ \\|u\\|_{H^{1}(0,1)},\\ |u|_{H^{1}(0,1)}/\\|u\\|_{H^{1}(0,1)}\\big)$. Express your answer in exact analytic form with no rounding.",
            "solution": "The problem is well-posed, scientifically grounded, and provides all necessary information for a unique solution. The concepts involved—Sobolev spaces, norms, and weak derivatives—are standard in the mathematical analysis of partial differential equations. We may therefore proceed with the solution.\n\nThe problem asks for the computation of the $H^{1}(0,1)$ seminorm, the $H^{1}(0,1)$ norm, and their ratio for the function $u(x) = \\sin(\\pi x)$ on the domain $\\Omega = (0,1)$. We will proceed by using the foundational definitions as stipulated.\n\nFirst, let us recall the definitions. The Sobolev space $H^{1}(\\Omega)$ is the space of functions $v$ in the Lebesgue space $L^{2}(\\Omega)$ whose weak first derivatives are also in $L^{2}(\\Omega)$. For our one-dimensional domain $\\Omega=(0,1)$, this is written as $H^{1}(0,1) = \\{v \\in L^{2}(0,1) \\mid v' \\in L^{2}(0,1)\\}$.\n\nThe $L^{2}(0,1)$ norm of a function $v$ is defined as:\n$$ \\|v\\|_{L^{2}(0,1)} = \\left( \\int_{0}^{1} |v(x)|^{2} \\,dx \\right)^{1/2} $$\n\nThe weak derivative $v'$ of a function $v \\in L^{2}(0,1)$ is a function that satisfies the relation:\n$$ \\int_{0}^{1} v'(x) \\phi(x) \\,dx = - \\int_{0}^{1} v(x) \\phi'(x) \\,dx $$\nfor all test functions $\\phi \\in C_{c}^{\\infty}(0,1)$ (infinitely differentiable functions with compact support in $(0,1)$).\nFor the given function $u(x) = \\sin(\\pi x)$, which is continuously differentiable on the entire real line, its weak derivative coincides with its classical derivative. The classical derivative is $u'(x) = \\pi \\cos(\\pi x)$. Since both $u(x)$ and $u'(x)$ are continuous and bounded functions on the closed interval $[0,1]$, they are square-integrable, i.e., $u \\in L^{2}(0,1)$ and $u' \\in L^{2}(0,1)$. Therefore, $u(x) = \\sin(\\pi x)$ is an element of the Sobolev space $H^{1}(0,1)$.\n\nThe $H^{1}(0,1)$ seminorm, denoted $|v|_{H^{1}(0,1)}$, is the $L^{2}$ norm of the weak derivative:\n$$ |v|_{H^{1}(0,1)} = \\|v'\\|_{L^{2}(0,1)} = \\left( \\int_{0}^{1} |v'(x)|^{2} \\,dx \\right)^{1/2} $$\nThe $H^{1}(0,1)$ norm, denoted $\\|v\\|_{H^{1}(0,1)}$, is defined by:\n$$ \\|v\\|_{H^{1}(0,1)} = \\left( \\|v\\|_{L^{2}(0,1)}^{2} + |v|_{H^{1}(0,1)}^{2} \\right)^{1/2} = \\left( \\int_{0}^{1} |v(x)|^{2} \\,dx + \\int_{0}^{1} |v'(x)|^{2} \\,dx \\right)^{1/2} $$\n\nNow, we compute these quantities for $u(x) = \\sin(\\pi x)$.\n\nFirst, we compute the squared $L^{2}$ norm of $u(x)$:\n$$ \\|u\\|_{L^{2}(0,1)}^{2} = \\int_{0}^{1} (\\sin(\\pi x))^{2} \\,dx $$\nUsing the trigonometric identity $\\sin^{2}(\\theta) = \\frac{1 - \\cos(2\\theta)}{2}$, we get:\n$$ \\|u\\|_{L^{2}(0,1)}^{2} = \\int_{0}^{1} \\frac{1 - \\cos(2\\pi x)}{2} \\,dx = \\frac{1}{2} \\left[ x - \\frac{\\sin(2\\pi x)}{2\\pi} \\right]_{0}^{1} $$\n$$ = \\frac{1}{2} \\left( \\left(1 - \\frac{\\sin(2\\pi)}{2\\pi}\\right) - \\left(0 - \\frac{\\sin(0)}{2\\pi}\\right) \\right) = \\frac{1}{2} ( (1 - 0) - (0 - 0) ) = \\frac{1}{2} $$\n\nNext, we compute the squared $H^{1}$ seminorm, which is the squared $L^{2}$ norm of the derivative $u'(x) = \\pi \\cos(\\pi x)$:\n$$ |u|_{H^{1}(0,1)}^{2} = \\|u'\\|_{L^{2}(0,1)}^{2} = \\int_{0}^{1} (\\pi \\cos(\\pi x))^{2} \\,dx = \\pi^{2} \\int_{0}^{1} \\cos^{2}(\\pi x) \\,dx $$\nUsing the trigonometric identity $\\cos^{2}(\\theta) = \\frac{1 + \\cos(2\\theta)}{2}$, we get:\n$$ |u|_{H^{1}(0,1)}^{2} = \\pi^{2} \\int_{0}^{1} \\frac{1 + \\cos(2\\pi x)}{2} \\,dx = \\frac{\\pi^{2}}{2} \\left[ x + \\frac{\\sin(2\\pi x)}{2\\pi} \\right]_{0}^{1} $$\n$$ = \\frac{\\pi^{2}}{2} \\left( \\left(1 + \\frac{\\sin(2\\pi)}{2\\pi}\\right) - \\left(0 + \\frac{\\sin(0)}{2\\pi}\\right) \\right) = \\frac{\\pi^{2}}{2} ( (1 + 0) - (0 + 0) ) = \\frac{\\pi^{2}}{2} $$\nFrom this, we find the seminorm:\n$$ |u|_{H^{1}(0,1)} = \\sqrt{\\frac{\\pi^{2}}{2}} = \\frac{\\pi}{\\sqrt{2}} $$\n\nNow, we compute the $H^{1}$ norm. We use the squared norms we have already calculated:\n$$ \\|u\\|_{H^{1}(0,1)}^{2} = \\|u\\|_{L^{2}(0,1)}^{2} + |u|_{H^{1}(0,1)}^{2} = \\frac{1}{2} + \\frac{\\pi^{2}}{2} = \\frac{1+\\pi^{2}}{2} $$\nTaking the square root gives the norm:\n$$ \\|u\\|_{H^{1}(0,1)} = \\sqrt{\\frac{1+\\pi^{2}}{2}} = \\frac{\\sqrt{1+\\pi^{2}}}{\\sqrt{2}} $$\n\nFinally, we compute the ratio of the seminorm to the norm:\n$$ \\frac{|u|_{H^{1}(0,1)}}{\\|u\\|_{H^{1}(0,1)}} = \\frac{\\left(\\frac{\\pi}{\\sqrt{2}}\\right)}{\\left(\\frac{\\sqrt{1+\\pi^{2}}}{\\sqrt{2}}\\right)} = \\frac{\\pi}{\\sqrt{1+\\pi^{2}}} $$\n\nThe problem requests the result as the row vector $\\big(|u|_{H^{1}(0,1)}, \\|u\\|_{H^{1}(0,1)}, |u|_{H^{1}(0,1)}/\\|u\\|_{H^{1}(0,1)}\\big)$. Substituting our computed values, we get:\n$$ \\left( \\frac{\\pi}{\\sqrt{2}}, \\frac{\\sqrt{1+\\pi^{2}}}{\\sqrt{2}}, \\frac{\\pi}{\\sqrt{1+\\pi^{2}}} \\right) $$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{\\pi}{\\sqrt{2}} & \\frac{\\sqrt{1+\\pi^{2}}}{\\sqrt{2}} & \\frac{\\pi}{\\sqrt{1+\\pi^{2}}}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "In numerical methods like the Finite Element Method, analysis is often simplified by mapping each element of a mesh to a standard reference element. This practice explores the consequences of such mappings, requiring you to derive how the $H^1$ seminorm scales with the element size $h$ . This scaling analysis is the key to deriving the fundamental 'inverse inequality,' which provides an upper bound on the derivative of a polynomial in terms of the polynomial itself and is indispensable for proving the stability of numerical schemes.",
            "id": "3397300",
            "problem": "Let $\\hat K \\subset \\mathbb{R}^{d}$ be a fixed reference element with nonempty interior and unit diameter, and let $K \\subset \\mathbb{R}^{d}$ be a physical element obtained from $\\hat K$ by an affine map $F:\\hat K \\to K$ of the form $x = F(\\hat x) = B \\hat x + b$, where $B \\in \\mathbb{R}^{d \\times d}$ is invertible and $b \\in \\mathbb{R}^{d}$. Denote the diameter of $K$ by $h = \\operatorname{diam}(K) = \\sup_{x,y \\in K} |x - y|$. For $v \\in H^{1}(K)$ define $\\hat v \\in H^{1}(\\hat K)$ by $\\hat v(\\hat x) = v(F(\\hat x))$. Recall that for any measurable function $g$ and any invertible affine map $F$, the change-of-variables formula states $\\int_{K} g(x)\\,dx = \\int_{\\hat K} g(F(\\hat x))\\,|\\det B|\\,d\\hat x$, and the chain rule for gradients gives $\\nabla_{\\hat x} \\hat v(\\hat x) = B^{T} \\nabla_{x} v(F(\\hat x))$.\n\nAssume a shape-regular family of affine maps in the following sense: there exist positive constants $c_{\\min}$ and $c_{\\max}$, independent of $K$ and $h$, such that $c_{\\min}\\,h \\le \\|B\\| \\le c_{\\max}\\,h$ and $c_{\\min}\\,h^{d} \\le |\\det B| \\le c_{\\max}\\,h^{d}$, where $\\|\\cdot\\|$ is the operator norm induced by the Euclidean norm. Let $|\\cdot|_{H^{1}(D)}$ denote the $H^{1}$ seminorm on a domain $D$, i.e., $|w|_{H^{1}(D)} := \\|\\nabla w\\|_{L^{2}(D)}$.\n\nTask A. Starting only from the stated change-of-variables and chain-rule facts, derive the explicit $h$-dependence of the scaling of the $H^{1}$ seminorm under the affine map, in the sense that there exists a shape constant $C_{\\mathrm{sr}} \\ge 1$, independent of $h$, such that\n$$\nC_{\\mathrm{sr}}^{-1}\\,S(h,d)\\,|\\hat v|_{H^{1}(\\hat K)} \\le |v|_{H^{1}(K)} \\le C_{\\mathrm{sr}}\\,S(h,d)\\,|\\hat v|_{H^{1}(\\hat K)}.\n$$\nIdentify $S(h,d)$ as a single expression in terms of $h$ and $d$.\n\nTask B. Let $V_{h}(K)$ be the image under $F$ of a fixed polynomial space $V(\\hat K)$ consisting of all polynomials on $\\hat K$ of total degree at most $p$, with $p$ fixed independently of $h$. Using only the finite-dimensional norm equivalence on $V(\\hat K)$ and your result from Task A, deduce the inverse inequality\n$$\n\\|\\nabla v_{h}\\|_{L^{2}(K)} \\le C\\,h^{-1}\\,\\|v_{h}\\|_{L^{2}(K)} \\quad \\text{for all } v_{h} \\in V_{h}(K),\n$$\nwith a constant $C$ independent of $h$.\n\nAnswer specification: Your final answer must be the single closed-form expression you found for $S(h,d)$ in Task A. No units are required, and no rounding is necessary. Express your answer as a function of $h$ and $d$ only.",
            "solution": "The user has provided a problem asking for the derivation of a scaling law for the $H^{1}$ seminorm under an affine mapping and a subsequent deduction of a finite element inverse inequality.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n\n*   Reference element: $\\hat K \\subset \\mathbb{R}^{d}$, nonempty interior, $\\operatorname{diam}(\\hat K) = 1$.\n*   Physical element: $K \\subset \\mathbb{R}^{d}$, $\\operatorname{diam}(K) = h$.\n*   Affine map: $F:\\hat K \\to K$, $x = F(\\hat x) = B \\hat x + b$, with $B \\in \\mathbb{R}^{d \\times d}$ invertible and $b \\in \\mathbb{R}^{d}$.\n*   Function mapping: For $v \\in H^{1}(K)$, $\\hat v \\in H^{1}(\\hat K)$ is defined by $\\hat v(\\hat x) = v(F(\\hat x))$.\n*   Change of variables: $\\int_{K} g(x)\\,dx = \\int_{\\hat K} g(F(\\hat x))\\,|\\det B|\\,d\\hat x$.\n*   Chain rule: $\\nabla_{\\hat x} \\hat v(\\hat x) = B^{T} \\nabla_{x} v(F(\\hat x))$.\n*   Shape-regularity assumption: There exist positive constants $c_{\\min}$ and $c_{\\max}$ independent of $K$ and $h$ such that:\n    1.  $c_{\\min}\\,h \\le \\|B\\| \\le c_{\\max}\\,h$, where $\\|\\cdot\\|$ is the operator norm.\n    2.  $c_{\\min}\\,h^{d} \\le |\\det B| \\le c_{\\max}\\,h^{d}$.\n*   $H^1$ seminorm definition: $|w|_{H^{1}(D)} := \\|\\nabla w\\|_{L^{2}(D)} = \\left(\\int_{D} |\\nabla w(y)|^2 dy\\right)^{1/2}$.\n*   Task A goal: Find $S(h,d)$ in the relation $C_{\\mathrm{sr}}^{-1}\\,S(h,d)\\,|\\hat v|_{H^{1}(\\hat K)} \\le |v|_{H^{1}(K)} \\le C_{\\mathrm{sr}}\\,S(h,d)\\,|\\hat v|_{H^{1}(\\hat K)}$.\n*   Task B setup: $V(\\hat K)$ is the space of polynomials of total degree at most $p$. $V_{h}(K)$ is the image of $V(\\hat K)$ under the mapping $F$.\n*   Task B goal: Deduce the inverse inequality $\\|\\nabla v_{h}\\|_{L^{2}(K)} \\le C\\,h^{-1}\\,\\|v_{h}\\|_{L^{2}(K)}$ for all $v_{h} \\in V_{h}(K)$.\n\n**Step 2: Validate Using Extracted Givens**\n\nThe problem statement is a standard exercise in the mathematical theory of the finite element method.\n*   **Scientifically Grounded**: The problem is based on fundamental principles of linear algebra, multivariate calculus (change of variables, chain rule), and functional analysis ($L^2$ and Sobolev spaces). The concept of shape-regularity and derivation of scaling laws are central to the convergence analysis of finite element methods. The problem is mathematically and scientifically sound.\n*   **Well-Posed**: The problem is clearly stated with all necessary definitions and assumptions. As shown in the solution derivation, the provided assumptions are sufficient to arrive at a unique scaling factor $S(h,d)$ and to prove the inverse inequality. The problem is not under- or over-specified.\n*   **Objective**: The language is precise and mathematical, free of any subjectivity or ambiguity.\n\nThe problem does not violate any of the invalidity criteria. All terms are standard or explicitly defined. The assumptions are self-consistent and sufficient for the tasks.\n\n**Step 3: Verdict and Action**\n\nThe problem is **valid**. I will proceed with the solution.\n\n### Solution\n\nThe solution is divided into two parts as requested by the problem statement.\n\n**Task A: Scaling of the $H^{1}$ Seminorm**\n\nThe goal is to find the scaling factor $S(h,d)$ that relates the $H^{1}$ seminorm of a function $v$ on the physical element $K$ to the seminorm of the corresponding function $\\hat{v}$ on the reference element $\\hat{K}$.\n\nThe square of the $H^{1}$ seminorm of $v$ on $K$ is defined as:\n$$\n|v|_{H^{1}(K)}^{2} = \\int_{K} |\\nabla_{x} v(x)|^{2} dx\n$$\nWe apply the given change-of-variables formula with $g(x) = |\\nabla_{x} v(x)|^{2}$.\n$$\n|v|_{H^{1}(K)}^{2} = \\int_{\\hat K} |\\nabla_{x} v(F(\\hat x))|^{2} |\\det B| \\,d\\hat x\n$$\nNext, we use the given chain rule $\\nabla_{\\hat x} \\hat v(\\hat x) = B^{T} \\nabla_{x} v(F(\\hat x))$. Since $B$ is invertible, so is $B^T$. We can write:\n$$\n\\nabla_{x} v(F(\\hat x)) = (B^{T})^{-1} \\nabla_{\\hat x} \\hat v(\\hat x)\n$$\nSubstituting this into the integral expression gives:\n$$\n|v|_{H^{1}(K)}^{2} = \\int_{\\hat K} |(B^{T})^{-1} \\nabla_{\\hat x} \\hat v(\\hat x)|^{2} |\\det B| \\,d\\hat x\n$$\nLet the vector field $\\hat w(\\hat x) = \\nabla_{\\hat x} \\hat v(\\hat x)$. The squared norm is the dot product:\n$$\n|(B^{T})^{-1} \\hat w|^{2} = ((B^{T})^{-1} \\hat w) \\cdot ((B^{T})^{-1} \\hat w) = \\hat w^{T} (B^{T})^{-T} (B^{T})^{-1} \\hat w = \\hat w^{T} (B^{-1}) (B^{T})^{-1} \\hat w = \\hat w^{T} (B B^{T})^{-1} \\hat w\n$$\nThe matrix $(B B^{T})^{-1}$ is symmetric and positive definite. The expression $\\hat w^{T} (B B^{T})^{-1} \\hat w$ can be bounded by the minimum and maximum eigenvalues of $(B B^{T})^{-1}$. The eigenvalues of $B B^{T}$ are the squares of the singular values of $B$, denoted by $\\sigma_i(B)^{2}$. Thus, the eigenvalues of $(B B^{T})^{-1}$ are $1/\\sigma_i(B)^{2}$.\nLet $\\sigma_{\\min}(B)$ and $\\sigma_{\\max}(B)$ be the minimum and maximum singular values of $B$. Then the minimum and maximum eigenvalues of $(B B^{T})^{-1}$ are $1/\\sigma_{\\max}(B)^{2}$ and $1/\\sigma_{\\min}(B)^{2}$, respectively.\nWe know that the operator norm is $\\|B\\| = \\sigma_{\\max}(B)$ and $\\|B^{-1}\\| = 1/\\sigma_{\\min}(B)$. Therefore, the Rayleigh quotient is bounded as:\n$$\n\\frac{1}{\\|B\\|^{2}} |\\hat w|^{2} \\le \\hat w^{T} (B B^{T})^{-1} \\hat w \\le \\|B^{-1}\\|^{2} |\\hat w|^{2}\n$$\nApplying these bounds to our integral expression, we get two inequalities.\n\nFor the upper bound:\n$$\n|v|_{H^{1}(K)}^{2} \\le \\int_{\\hat K} \\|B^{-1}\\|^{2} |\\nabla_{\\hat x} \\hat v(\\hat x)|^{2} |\\det B| \\,d\\hat x = \\|B^{-1}\\|^{2} |\\det B| \\int_{\\hat K} |\\nabla_{\\hat x} \\hat v(\\hat x)|^{2} \\,d\\hat x = \\|B^{-1}\\|^{2} |\\det B| |\\hat v|_{H^{1}(\\hat K)}^{2}\n$$\nFor the lower bound:\n$$\n|v|_{H^{1}(K)}^{2} \\ge \\int_{\\hat K} \\frac{1}{\\|B\\|^{2}} |\\nabla_{\\hat x} \\hat v(\\hat x)|^{2} |\\det B| \\,d\\hat x = \\frac{|\\det B|}{\\|B\\|^{2}} \\int_{\\hat K} |\\nabla_{\\hat x} \\hat v(\\hat x)|^{2} \\,d\\hat x = \\frac{|\\det B|}{\\|B\\|^{2}} |\\hat v|_{H^{1}(\\hat K)}^{2}\n$$\nNow, we use the shape-regularity assumptions. First, we must bound $\\|B^{-1}\\|$. From the properties of singular values, $\\|B^{-1}\\| = 1/\\sigma_{\\min}(B)$. The determinant is the product of singular values, $|\\det B| = \\prod_{i=1}^d \\sigma_i(B)$. Thus, $|\\det B| \\le \\sigma_{\\min}(B) (\\sigma_{\\max}(B))^{d-1} = \\sigma_{\\min}(B) \\|B\\|^{d-1}$. This yields $\\sigma_{\\min}(B) \\ge \\frac{|\\det B|}{\\|B\\|^{d-1}}$. Therefore:\n$$\n\\|B^{-1}\\| = \\frac{1}{\\sigma_{\\min}(B)} \\le \\frac{\\|B\\|^{d-1}}{|\\det B|}\n$$\nUsing the given assumptions $c_{\\min}\\,h \\le \\|B\\| \\le c_{\\max}\\,h$ and $c_{\\min}\\,h^{d} \\le |\\det B| \\le c_{\\max}\\,h^{d}$:\n$$\n\\|B^{-1}\\| \\le \\frac{(c_{\\max}h)^{d-1}}{c_{\\min}h^{d}} = \\frac{c_{\\max}^{d-1}}{c_{\\min}} h^{-1}\n$$\nNow we can bound the terms in our inequalities.\nFor the upper bound on $|v|_{H^{1}(K)}$:\n$$\n|v|_{H^{1}(K)}^{2} \\le \\|B^{-1}\\|^{2} |\\det B| |\\hat v|_{H^{1}(\\hat K)}^{2} \\le \\left(\\frac{c_{\\max}^{d-1}}{c_{\\min}} h^{-1}\\right)^{2} (c_{\\max}h^{d}) |\\hat v|_{H^{1}(\\hat K)}^{2} = \\frac{c_{\\max}^{2d-2+1}}{c_{\\min}^{2}} h^{-2+d} |\\hat v|_{H^{1}(\\hat K)}^{2} = \\frac{c_{\\max}^{2d-1}}{c_{\\min}^{2}} h^{d-2} |\\hat v|_{H^{1}(\\hat K)}^{2}\n$$\nFor the lower bound on $|v|_{H^{1}(K)}$:\n$$\n|v|_{H^{1}(K)}^{2} \\ge \\frac{|\\det B|}{\\|B\\|^{2}} |\\hat v|_{H^{1}(\\hat K)}^{2} \\ge \\frac{c_{\\min}h^{d}}{(c_{\\max}h)^{2}} |\\hat v|_{H^{1}(\\hat K)}^{2} = \\frac{c_{\\min}}{c_{\\max}^{2}} h^{d-2} |\\hat v|_{H^{1}(\\hat K)}^{2}\n$$\nTaking the square root of both inequalities, we obtain:\n$$\n\\sqrt{\\frac{c_{\\min}}{c_{\\max}^{2}}} h^{\\frac{d-2}{2}} |\\hat v|_{H^{1}(\\hat K)} \\le |v|_{H^{1}(K)} \\le \\sqrt{\\frac{c_{\\max}^{2d-1}}{c_{\\min}^{2}}} h^{\\frac{d-2}{2}} |\\hat v|_{H^{1}(\\hat K)}\n$$\nThis is of the form $C_{\\mathrm{sr}}^{-1}\\,S(h,d)\\,|\\hat v|_{H^{1}(\\hat K)} \\le |v|_{H^{1}(K)} \\le C_{\\mathrm{sr}}\\,S(h,d)\\,|\\hat v|_{H^{1}(\\hat K)}$ where the shape constant $C_{\\mathrm{sr}}$ depends on $c_{\\min}$, $c_{\\max}$, and $d$, but not on $h$. The scaling factor $S(h,d)$ is identified as:\n$$\nS(h,d) = h^{\\frac{d-2}{2}}\n$$\n\n**Task B: Inverse Inequality**\n\nWe want to derive the inverse inequality $\\|\\nabla v_{h}\\|_{L^{2}(K)} \\le C\\,h^{-1}\\,\\|v_{h}\\|_{L^{2}(K)}$ for $v_h \\in V_h(K)$. This is equivalent to $|v_h|_{H^1(K)} \\le C h^{-1} \\|v_h\\|_{L^2(K)}$.\nLet $v_h \\in V_h(K)$. Then there exists a polynomial $\\hat{v}_h \\in V(\\hat{K})$ of degree at most $p$ such that $v_h(x) = \\hat{v}_h(\\hat{x})$ for $x = F(\\hat{x})$.\n\n1.  **Relate $|v_h|_{H^1(K)}$ to $|\\hat{v}_h|_{H^1(\\hat K)}$**: From Task A, we have the upper bound:\n    $$\n    |v_h|_{H^1(K)} \\le C_1 h^{\\frac{d-2}{2}} |\\hat{v}_h|_{H^1(\\hat K)}\n    $$\n    where $C_1 = \\sqrt{c_{\\max}^{2d-1}/c_{\\min}^{2}}$ is a constant independent of $h$.\n\n2.  **Relate $\\|\\hat{v}_h\\|_{H^1(\\hat K)}$ to $\\|\\hat{v}_h\\|_{L^2(\\hat K)}$**: The space $V(\\hat{K})$ is a finite-dimensional vector space. On a finite-dimensional space, all norms are equivalent. The operator $\\nabla: V(\\hat K) \\to [V(\\hat K)]^{d}$ is a linear map between finite-dimensional spaces, and is therefore bounded. This implies the existence of a constant $C_{\\text{equiv}}$, depending only on the space $V(\\hat K)$ (i.e., on $p$ and the geometry of $\\hat K$), such that for any $\\hat{v}_h \\in V(\\hat K)$:\n    $$\n    |\\hat{v}_h|_{H^1(\\hat K)} = \\|\\nabla \\hat{v}_h\\|_{L^2(\\hat K)} \\le C_{\\text{equiv}} \\|\\hat{v}_h\\|_{L^2(\\hat K)}\n    $$\n\n3.  **Relate $\\|\\hat{v}_h\\|_{L^2(\\hat K)}$ to $\\|v_h\\|_{L^2(K)}$**: We analyze the scaling of the $L^2$ norm.\n    $$\n    \\|v_h\\|_{L^2(K)}^2 = \\int_K |v_h(x)|^2 dx = \\int_{\\hat K} |v_h(F(\\hat x))|^2 |\\det B| d\\hat x = \\int_{\\hat K} |\\hat{v}_h(\\hat x)|^2 |\\det B| d\\hat x\n    $$\n    Using the lower bound for the determinant, $|\\det B| \\ge c_{\\min}h^d$:\n    $$\n    \\|v_h\\|_{L^2(K)}^2 \\ge c_{\\min}h^d \\int_{\\hat K} |\\hat{v}_h(\\hat x)|^2 d\\hat x = c_{\\min}h^d \\|\\hat{v}_h\\|_{L^2(\\hat K)}^2\n    $$\n    Taking the square root and rearranging gives:\n    $$\n    \\|\\hat{v}_h\\|_{L^2(\\hat K)} \\le \\frac{1}{\\sqrt{c_{\\min}} h^{d/2}} \\|v_h\\|_{L^2(K)}\n    $$\n\n4.  **Combine the inequalities**:\n    Starting from the result of Step 1:\n    $$\n    |v_h|_{H^1(K)} \\le C_1 h^{\\frac{d-2}{2}} |\\hat{v}_h|_{H^1(\\hat K)}\n    $$\n    Using the norm equivalence from Step 2:\n    $$\n    |v_h|_{H^1(K)} \\le C_1 h^{\\frac{d-2}{2}} (C_{\\text{equiv}} \\|\\hat{v}_h\\|_{L^2(\\hat K)})\n    $$\n    Finally, using the scaling from Step 3:\n    $$\n    |v_h|_{H^1(K)} \\le C_1 C_{\\text{equiv}} h^{\\frac{d-2}{2}} \\left( \\frac{1}{\\sqrt{c_{\\min}} h^{d/2}} \\|v_h\\|_{L^2(K)} \\right)\n    $$\n    Simplifying the expression:\n    $$\n    |v_h|_{H^1(K)} \\le \\left(\\frac{C_1 C_{\\text{equiv}}}{\\sqrt{c_{\\min}}}\\right) h^{\\frac{d-2}{2} - \\frac{d}{2}} \\|v_h\\|_{L^2(K)} = \\left(\\frac{C_1 C_{\\text{equiv}}}{\\sqrt{c_{\\min}}}\\right) h^{-1} \\|v_h\\|_{L^2(K)}\n    $$\n    Letting $C = \\frac{C_1 C_{\\text{equiv}}}{\\sqrt{c_{\\min}}}$, we have a constant independent of $h$, and we obtain the desired inverse inequality:\n    $$\n    \\|\\nabla v_{h}\\|_{L^{2}(K)} \\le C\\,h^{-1}\\,\\|v_{h}\\|_{L^{2}(K)}\n    $$\nThe final answer required is the expression for $S(h,d)$ from Task A.",
            "answer": "$$\\boxed{h^{\\frac{d-2}{2}}}$$"
        },
        {
            "introduction": "A theoretical result gains profound meaning when its predictions can be tested and verified. This final practice bridges the gap between analysis and computation by tasking you with numerically confirming the inverse inequality derived previously . By implementing the underlying mathematical structures as a generalized eigenvalue problem, you will not only verify the predicted scaling with element size $h_K$ and polynomial degree $p$, but also develop a practical understanding of how these abstract constants are measured and what they signify for the robustness of $hp$-adaptive methods.",
            "id": "3397263",
            "problem": "Consider a one-dimensional element $K \\subset \\mathbb{R}$ of length $h_K > 0$ with an affine map from the reference interval $[-1,1]$ given by $x = x_c + \\frac{h_K}{2}\\xi$, where $x_c \\in \\mathbb{R}$ is the element center and $\\xi \\in [-1,1]$ is the reference coordinate. Let $\\mathbb{P}_p(K)$ denote the space of polynomials of degree at most $p \\in \\mathbb{N}$ restricted to $K$. For $v_h \\in \\mathbb{P}_p(K)$, define the square-integrable norm (the $L^2$ norm) and the gradient norm over $K$ by\n$$\n\\|v_h\\|_{L^2(K)}^2 = \\int_K |v_h(x)|^2 \\, dx, \\qquad \\|\\nabla v_h\\|_{L^2(K)}^2 = \\int_K |v_h'(x)|^2 \\, dx.\n$$\nThe inverse inequality relevant for the Finite Element Method (FEM) and the numerical analysis of Partial Differential Equations (PDEs) asserts the existence of a constant $C$ independent of $h_K$ and $p$ such that\n$$\n\\|\\nabla v_h\\|_{L^2(K)} \\le C \\,\\frac{p^2}{h_K} \\, \\|v_h\\|_{L^2(K)} \\quad \\text{for all } v_h \\in \\mathbb{P}_p(K).\n$$\nYour task is to verify $hp$-robustness numerically by computing, for selected $(p,h_K)$ pairs, the smallest constant $C_{\\mathrm{inv}}(p,h_K)$ such that the inequality holds for all $v_h \\in \\mathbb{P}_p(K)$. This constant is the supremum over nonzero $v_h \\in \\mathbb{P}_p(K)$ of the ratio\n$$\n\\frac{\\|\\nabla v_h\\|_{L^2(K)}}{\\frac{p^2}{h_K}\\|v_h\\|_{L^2(K)}}.\n$$\nIn addition, define the $p$-weighted norm\n$$\n\\|v_h\\|_{p,h_K}^2 := \\|v_h\\|_{L^2(K)}^2 + \\left(\\frac{h_K^2}{p^4}\\right)\\|\\nabla v_h\\|_{L^2(K)}^2,\n$$\nand track the amplification factor\n$$\n\\mathcal{E}_{\\max}(p,h_K) := \\sup_{v_h \\in \\mathbb{P}_p(K)\\setminus\\{0\\}} \\frac{\\|v_h\\|_{p,h_K}}{\\|v_h\\|_{L^2(K)}}.\n$$\nStart from core definitions: the $L^2$ norm on $K$, the polynomial space $\\mathbb{P}_p(K)$, and the affine map from the reference interval. Use the fact that under the affine map $x = x_c + \\frac{h_K}{2}\\xi$, the derivative transforms as $\\frac{d}{dx} = \\frac{2}{h_K}\\frac{d}{d\\xi}$ and the integration measure transforms as $dx = \\frac{h_K}{2}d\\xi$. Construct numerical approximations to the bilinear forms $\\int_K v_h w_h \\, dx$ and $\\int_K v_h' w_h' \\, dx$ on $\\mathbb{P}_p(K)$ using an appropriate polynomial basis on the reference interval and exact or sufficiently accurate Gaussian quadrature, and from these derive the required suprema as computable quantities.\n\nTest Suite:\nCompute the pair $\\left(C_{\\mathrm{inv}}(p,h_K),\\,\\mathcal{E}_{\\max}(p,h_K)\\right)$ for the following parameter values:\n- $(p,h_K) = (\\,1,\\,1.0\\,)$,\n- $(p,h_K) = (\\,3,\\,0.5\\,)$,\n- $(p,h_K) = (\\,5,\\,0.1\\,)$,\n- $(p,h_K) = (\\,8,\\,10^{-3}\\,)$,\n- $(p,h_K) = (\\,10,\\,2.0\\,)$.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list of pairs enclosed in square brackets, for example, $[ [c_1,e_1], [c_2,e_2], \\ldots ]$, where each $c_i$ and $e_i$ are floating-point numbers corresponding to $C_{\\mathrm{inv}}(p,h_K)$ and $\\mathcal{E}_{\\max}(p,h_K)$ for the $i$-th test case. No physical units are involved, and all angles, if any appear, would be in radians, but none are needed here. The answers must be printed exactly in the specified single-line format.",
            "solution": "We begin from the core definitions for square-integrable functions and polynomial finite element spaces on a single one-dimensional element. For an element $K \\subset \\mathbb{R}$ of length $h_K > 0$, the affine map $x = x_c + \\frac{h_K}{2}\\xi$ from the reference interval $[-1,1]$ yields $dx = \\frac{h_K}{2}d\\xi$, and the chain rule gives $\\frac{d}{dx} = \\frac{2}{h_K}\\frac{d}{d\\xi}$. Consequently, for $v_h \\in \\mathbb{P}_p(K)$ associated to a reference polynomial $\\hat{v} \\in \\mathbb{P}_p([-1,1])$, the norms transform as\n$$\n\\|v_h\\|_{L^2(K)}^2 = \\int_K |v_h(x)|^2 \\, dx = \\frac{h_K}{2}\\int_{-1}^{1} |\\hat{v}(\\xi)|^2 \\, d\\xi,\n$$\n$$\n\\|\\nabla v_h\\|_{L^2(K)}^2 = \\int_K |v_h'(x)|^2 \\, dx = \\int_{-1}^{1} \\left|\\frac{2}{h_K}\\hat{v}'(\\xi)\\right|^2 \\frac{h_K}{2}\\, d\\xi = \\frac{2}{h_K}\\int_{-1}^{1} |\\hat{v}'(\\xi)|^2 \\, d\\xi.\n$$\nDefine the reference bilinear forms on $\\mathbb{P}_p([-1,1])$ by\n$$\nm(\\phi,\\psi) = \\int_{-1}^{1} \\phi(\\xi)\\psi(\\xi)\\,d\\xi, \\qquad s(\\phi,\\psi) = \\int_{-1}^{1} \\phi'(\\xi)\\psi'(\\xi)\\,d\\xi.\n$$\nChoose a polynomial basis $\\{\\phi_i\\}_{i=0}^{p}$ for $\\mathbb{P}_p([-1,1])$, for instance the Legendre polynomials of degrees $0$ through $p$. Using Gaussian quadrature of sufficient order (for example, Gauss–Legendre quadrature with a number of points guaranteeing exactness for polynomials up to degree $2p$), we assemble the reference mass and stiffness matrices\n$$\nM_{ij}^{\\mathrm{ref}} = \\int_{-1}^{1} \\phi_i(\\xi)\\phi_j(\\xi)\\,d\\xi, \\qquad S_{ij}^{\\mathrm{ref}} = \\int_{-1}^{1} \\phi_i'(\\xi)\\phi_j'(\\xi)\\,d\\xi.\n$$\nOn the physical element $K$, the corresponding matrices are scaled by the affine map:\n$$\nM^{K} = \\frac{h_K}{2} M^{\\mathrm{ref}}, \\qquad S^{K} = \\frac{2}{h_K} S^{\\mathrm{ref}}.\n$$\nFor a coefficient vector $v \\in \\mathbb{R}^{p+1}$ representing $v_h$, the norms satisfy\n$$\n\\|v_h\\|_{L^2(K)}^2 = v^\\top M^{K} v, \\qquad \\|\\nabla v_h\\|_{L^2(K)}^2 = v^\\top S^{K} v.\n$$\nThe sought inverse inequality constant is\n$$\nC_{\\mathrm{inv}}(p,h_K) = \\sup_{v \\neq 0} \\frac{\\|\\nabla v_h\\|_{L^2(K)}}{\\frac{p^2}{h_K}\\|v_h\\|_{L^2(K)}} = \\sup_{v \\neq 0} \\sqrt{\\frac{v^\\top S^{K} v}{\\left(\\frac{p^4}{h_K^2}\\right) v^\\top M^{K} v}}.\n$$\nThis is the square root of the largest generalized Rayleigh quotient. Using the scaling relationships, we obtain\n$$\n\\frac{v^\\top S^{K} v}{\\left(\\frac{p^4}{h_K^2}\\right) v^\\top M^{K} v}\n= \\frac{\\frac{2}{h_K} v^\\top S^{\\mathrm{ref}} v}{\\left(\\frac{p^4}{h_K^2}\\right) \\frac{h_K}{2} v^\\top M^{\\mathrm{ref}} v}\n= \\frac{4}{p^4} \\cdot \\frac{v^\\top S^{\\mathrm{ref}} v}{v^\\top M^{\\mathrm{ref}} v}.\n$$\nTherefore,\n$$\nC_{\\mathrm{inv}}(p,h_K) = \\frac{2}{p^2}\\sqrt{\\lambda_{\\max}},\n$$\nwhere $\\lambda_{\\max}$ is the largest generalized eigenvalue of the reference problem\n$$\nS^{\\mathrm{ref}} v = \\lambda M^{\\mathrm{ref}} v.\n$$\nThis shows that $C_{\\mathrm{inv}}(p,h_K)$ is independent of $h_K$, confirming the expected $hp$-robustness with respect to mesh size when the right-hand side has the factor $\\frac{p^2}{h_K}$.\n\nNext, consider the $p$-weighted norm\n$$\n\\|v_h\\|_{p,h_K}^2 = v^\\top \\left(M^{K} + \\frac{h_K^2}{p^4} S^{K}\\right) v.\n$$\nThe amplification factor relative to the $L^2$ norm is\n$$\n\\mathcal{E}_{\\max}(p,h_K)^2 = \\sup_{v \\neq 0} \\frac{v^\\top \\left(M^{K} + \\frac{h_K^2}{p^4} S^{K}\\right) v}{v^\\top M^{K} v}\n= 1 + \\frac{h_K^2}{p^4} \\cdot \\lambda_{\\max}(S^{K}, M^{K}),\n$$\nwhere $\\lambda_{\\max}(S^{K}, M^{K})$ denotes the largest generalized eigenvalue of $(S^{K},M^{K})$. Using the affine scaling, the generalized eigenvalues transform as\n$$\nS^{K} v = \\lambda M^{K} v \\quad \\Longleftrightarrow \\quad S^{\\mathrm{ref}} v = \\left(\\frac{\\lambda h_K^2}{4}\\right) M^{\\mathrm{ref}} v,\n$$\nso $\\lambda_{\\max}(S^{K}, M^{K}) = \\frac{4}{h_K^2}\\lambda_{\\max}(S^{\\mathrm{ref}}, M^{\\mathrm{ref}})$. Thus,\n$$\n\\mathcal{E}_{\\max}(p,h_K)^2 = 1 + \\frac{h_K^2}{p^4} \\cdot \\frac{4}{h_K^2} \\lambda_{\\max} = 1 + \\frac{4}{p^4}\\lambda_{\\max}.\n$$\nCombining with the expression for $C_{\\mathrm{inv}}(p,h_K)$ yields\n$$\n\\mathcal{E}_{\\max}(p,h_K) = \\sqrt{1 + C_{\\mathrm{inv}}(p,h_K)^2},\n$$\nwhich is independent of $h_K$ and, for spaces with polynomial degree $p$, remains bounded uniformly in both $h_K$ and $p$ when the inverse inequality employs the factor $\\frac{p^2}{h_K}$.\n\nAlgorithmic design:\n- Choose the Legendre polynomial basis $\\{\\phi_i\\}_{i=0}^p$ on $[-1,1]$.\n- Use Gauss–Legendre quadrature with sufficiently many points (for example, $2p+3$ points) to assemble $M^{\\mathrm{ref}}$ and $S^{\\mathrm{ref}}$ by evaluating $\\phi_i$ and $\\phi_i'$ at the quadrature nodes. This is justified because Gauss–Legendre quadrature of order $n$ is exact for polynomials up to degree $2n-1$; the integrands have degrees at most $2p$ for the mass and $2p-2$ for the stiffness.\n- Compute the largest generalized eigenvalue $\\lambda_{\\max}$ of $(S^{\\mathrm{ref}}, M^{\\mathrm{ref}})$ using a symmetric generalized eigenvalue solver.\n- Evaluate $C_{\\mathrm{inv}}(p,h_K) = \\frac{2}{p^2}\\sqrt{\\lambda_{\\max}}$ and $\\mathcal{E}_{\\max}(p,h_K) = \\sqrt{1 + \\frac{4}{p^4}\\lambda_{\\max}}$, and return these for each test pair $(p,h_K)$.\n\nThe test suite covers a low-degree case $p=1$, moderate degrees and mesh sizes, very small $h_K$ to test mesh-independence explicitly, and a larger degree $p=10$ with a larger element to confirm scaling robustness. The final output aggregates the computed pairs $[C_{\\mathrm{inv}}(p,h_K), \\mathcal{E}_{\\max}(p,h_K)]$ into the specified single-line format.",
            "answer": "```python\nimport numpy as np\nfrom numpy.polynomial.legendre import Legendre, leggauss\nfrom scipy.linalg import eigh\n\ndef assemble_reference_matrices(p: int) -> tuple[np.ndarray, np.ndarray]:\n    \"\"\"\n    Assemble reference mass and stiffness matrices on [-1,1] for the\n    Legendre polynomial basis of degrees 0..p using Gauss-Legendre quadrature.\n    \"\"\"\n    # Number of quadrature points: ensure exactness for degree up to 2p\n    # Gauss-Legendre of order nq is exact up to degree 2nq-1.\n    nq = max(2 * p + 3, 32)\n    xi, w = leggauss(nq)\n\n    # Construct Legendre basis polynomials and their derivatives\n    basis = [Legendre.basis(k) for k in range(p + 1)]\n    dbasis = [b.deriv() for b in basis]\n\n    # Evaluate basis and derivatives at quadrature points\n    Phi = np.vstack([b(xi) for b in basis])  # shape (p+1, nq)\n    dPhi = np.vstack([db(xi) for db in dbasis])  # shape (p+1, nq)\n\n    # Assemble M_ref and S_ref\n    M_ref = np.zeros((p + 1, p + 1))\n    S_ref = np.zeros((p + 1, p + 1))\n\n    # Use vectorized accumulation\n    # M_ij = sum_k w_k * Phi_i(x_k) * Phi_j(x_k)\n    # S_ij = sum_k w_k * dPhi_i(x_k) * dPhi_j(x_k)\n    for i in range(p + 1):\n        for j in range(p + 1):\n            M_ref[i, j] = np.sum(w * Phi[i, :] * Phi[j, :])\n            S_ref[i, j] = np.sum(w * dPhi[i, :] * dPhi[j, :])\n\n    return M_ref, S_ref\n\ndef compute_lambda_max(M_ref: np.ndarray, S_ref: np.ndarray) -> float:\n    \"\"\"\n    Compute the largest generalized eigenvalue of (S_ref, M_ref).\n    \"\"\"\n    # Solve S_ref v = lambda M_ref v for symmetric matrices\n    # eigh returns eigenvalues in ascending order\n    evals = eigh(S_ref, M_ref, eigvals_only=True)\n    # Numerical safety: filter out tiny negatives due to round-off\n    evals = np.real(evals)\n    # Keep only nonnegative (or very small positive) eigenvalues\n    pos_evals = evals[evals > 1e-12]\n    if pos_evals.size == 0:\n        # If all eigenvalues are near zero, return zero\n        return 0.0\n    return float(pos_evals.max())\n\ndef compute_constants(p: int, h: float) -> tuple[float, float]:\n    \"\"\"\n    Compute C_inv(p,h) and E_max(p,h) for given polynomial degree p and element size h.\n    \"\"\"\n    M_ref, S_ref = assemble_reference_matrices(p)\n    lam_max = compute_lambda_max(M_ref, S_ref)\n    # Inverse inequality constant: C_inv = (2/p^2) * sqrt(lam_max)\n    C_inv = (2.0 / (p**2)) * np.sqrt(lam_max)\n    # Weighted norm amplification: E_max = sqrt(1 + (4/p^4) * lam_max) = sqrt(1 + C_inv^2)\n    E_max = np.sqrt(1.0 + C_inv**2)\n    return C_inv, e_max\n\ndef solve():\n    # Define the test cases from the problem statement: (p, h_K)\n    test_cases = [\n        (1, 1.0),\n        (3, 0.5),\n        (5, 0.1),\n        (8, 1e-3),\n        (10, 2.0),\n    ]\n\n    results = []\n    for p, h in test_cases:\n        c_inv, e_max = compute_constants(p, h)\n        results.append([float(c_inv), float(e_max)])\n\n    # Final print statement in the exact required format.\n    # Print as a single list of pairs: [[c1,e1],[c2,e2],...]\n    print(\"[\" + \",\".join(f\"[{r[0]},{r[1]}]\" for r in results) + \"]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}