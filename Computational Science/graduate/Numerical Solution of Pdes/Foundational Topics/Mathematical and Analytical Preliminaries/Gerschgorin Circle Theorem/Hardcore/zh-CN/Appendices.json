{
    "hands_on_practices": [
        {
            "introduction": "盖尔什戈林圆盘定理为我们提供了一种在复平面上快速估计矩阵特征值位置的便捷方法。这个练习将引导你应用该定理的基础知识，不仅要计算基于行的盖尔什戈林圆盘，还要计算基于列的盖尔什戈林圆盘。通过比较这两种方法得到的结果，你将学会如何结合二者以获得对特征值区域更精确的界定，这是进行谱分析时一项至关重要的基本技能。",
            "id": "2193583",
            "problem": "考虑以下 $3 \\times 3$ 实矩阵 $A$：\n$$\nA = \\begin{pmatrix}\n10  0.5  -0.2 \\\\\n0.3  -5  -0.1 \\\\\n-0.4  0.6  2\n\\end{pmatrix}\n$$\n该矩阵的特征值位于复平面 $\\mathbb{C}$ 中。下列哪个集合保证包含矩阵 $A$ 的所有特征值？对于以下选项，设 $D(c, r)$ 表示复平面中的闭圆盘，其圆心为 $c \\in \\mathbb{C}$，半径为 $r \\ge 0$，定义为 $\\{z \\in \\mathbb{C} : |z-c| \\le r\\}$。正确答案可能包含一个或多个选项。\n\nA. 圆盘 $D(10, 0.7)$、$D(-5, 0.4)$ 和 $D(2, 1.0)$ 的并集。\n\nB. 圆盘 $D(10, 0.7)$、$D(-5, 1.1)$ 和 $D(2, 0.3)$ 的并集。\n\nC. 圆盘 $D(10, 1.1)$、$D(-5, 0.3)$ 和 $D(2, 0.7)$ 的并集。\n\nD. 圆盘 $D(10, 0.5)$、$D(-5, 0.3)$ 和 $D(2, 0.6)$ 的并集。\n\nE. 圆盘 $D(0, 10)$、$D(0, 5)$ 和 $D(0, 2)$ 的并集。",
            "solution": "使用盖尔什戈林圆盘定理。对于一个矩阵 $A=(a_{ij})$，其每个特征值 $\\lambda$ 都位于行盖尔什戈林圆盘的并集中\n$$\n\\bigcup_{i=1}^{n} D\\left(a_{ii},\\, R_{i}\\right), \\quad R_{i}=\\sum_{j \\ne i} |a_{ij}|,\n$$\n也位于列盖尔什戈林圆盘的并集中\n$$\n\\bigcup_{j=1}^{n} D\\left(a_{jj},\\, C_{j}\\right), \\quad C_{j}=\\sum_{i \\ne j} |a_{ij}|.\n$$\n\n计算行半径：\n- 第 1 行：$R_{1}=|0.5|+|-0.2|=0.7$，所以是 $D(10,0.7)$。\n- 第 2 行：$R_{2}=|0.3|+|-0.1|=0.4$，所以是 $D(-5,0.4)$。\n- 第 3 行：$R_{3}=|-0.4|+|0.6|=1.0$，所以是 $D(2,1.0)$。\n\n因此，行圆盘的并集是 $D(10,0.7) \\cup D(-5,0.4) \\cup D(2,1.0)$，这与选项 A 匹配。因此 A 保证包含所有特征值。\n\n计算列半径：\n- 第 1 列：$C_{1}=|0.3|+|-0.4|=0.7$，所以是 $D(10,0.7)$。\n- 第 2 列：$C_{2}=|0.5|+|0.6|=1.1$，所以是 $D(-5,1.1)$。\n- 第 3 列：$C_{3}=|-0.2|+|-0.1|=0.3$，所以是 $D(2,0.3)$。\n\n因此，列圆盘的并集是 $D(10,0.7) \\cup D(-5,1.1) \\cup D(2,0.3)$，这与选项 B 匹配。因此 B 也得到保证。\n\n选项 C 和 D 至少缩小了一个精确的盖尔什戈林行圆盘或列圆盘，而没有其他圆盘的重叠来补偿，因此盖尔什戈林定理通常不保证它们。例如，相对于精确的行圆盘，选项 C 和 D 都将圆心为 $2$ 的圆盘半径减小到 $1.0$ 以下，而另外两个圆盘相距很远（圆心距为 $7$ 和 $8$），因此没有基于定理的保证所有特征值都保留在那些较小的并集中。\n\n选项 E 等于 $D(0,10)$（以 $0$ 为圆心的同心圆盘的并集是最大的那个）。要保证这一点，需要一个范数界，但对于诱导范数，我们有 $|\\lambda| \\le \\|A\\|$，且 $\\|A\\|_{\\infty}=\\max_{i} \\sum_{j} |a_{ij}|=10.7$，$\\|A\\|_{1}=\\max_{j} \\sum_{i} |a_{ij}|=10.7$，因此不能保证所有特征值都位于 $D(0,10)$ 内。\n\n因此，选项中能保证的集合是 A 和 B。",
            "answer": "$$\\boxed{AB}$$"
        },
        {
            "introduction": "将理论应用于实践是掌握数值方法的关键。本练习将盖尔什戈林圆盘定理从一个简单的定位工具转变为一个强大的分析武器，用于判断迭代法（如雅可比法和高斯-赛德尔法）的收敛性。你将通过构造一个具体的例子，亲自探索为何对于同一个线性系统，盖尔什戈林圆盘定理能够保证一种方法的收敛性，却无法保证另一种 。这个过程将加深你对数值算法稳定性和效率的理解。",
            "id": "3249204",
            "problem": "要求您构造并分析一个线性系统，在该系统中，一种经典定常迭代法的收敛性可以通过Gershgorin圆盘定理来验证，而对于另一种经典方法，同样的基于Gershgorin的验证却会失败。考虑$2 \\times 2$线性系统族 $A(p,q) x = b$，其中\n- $A(p,q) = \\begin{pmatrix} 1  -p \\\\ -q  1 \\end{pmatrix}$，其中 $p  0$ 且 $q  0$，\n- $b = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$。\n\n从Jacobi迭代和Gauss–Seidel迭代的定义出发（不使用预先记下的快捷公式），推导出该系统的迭代矩阵（用$p$和$q$表示）。然后，仅使用Gershgorin圆盘定理作为您的特征值定位工具，确定$p$和$q$在何种条件下：\n- Gershgorin圆盘定理可以验证Gauss–Seidel迭代的收敛性，\n- 但同样的基于Gershgorin的验证却无法保证Jacobi迭代的收敛性。\n\n给出一组满足这些条件的具体参数$p$和$q$的选择，并保持$b$如上所述。最后，对于您明确选择的$p = \\tfrac{1}{2}$和$q = \\tfrac{8}{5}$：\n- 精确计算Gauss–Seidel迭代矩阵的谱半径。\n\n将您的最终答案表示为一个精确的分数，不要四舍五入。",
            "solution": "该问题要求针对一个给定的线性系统，推导出Jacobi和Gauss-Seidel迭代矩阵，然后使用Gershgorin圆盘定理进行分析，找出在何种条件下可以验证Gauss-Seidel的收敛性，而无法验证Jacobi的收敛性。最后，必须计算一个特定的谱半径。\n\n该线性系统为 $A(p,q) x = b$，矩阵为 $A(p,q) = \\begin{pmatrix} 1  -p \\\\ -q  1 \\end{pmatrix}$，其中 $p  0$ 且 $q  0$。\n\n首先，我们将矩阵 $A$ 分解为其对角部分 ($D$)、严格下三角部分 ($-L$) 和严格上三角部分 ($-U$)，使得 $A = D - L - U$。\n对于给定的矩阵 $A$，我们有：\n$$\nD = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} = I\n$$\n$$\n-L = \\begin{pmatrix} 0  0 \\\\ -q  0 \\end{pmatrix} \\implies L = \\begin{pmatrix} 0  0 \\\\ q  0 \\end{pmatrix}\n$$\n$$\n-U = \\begin{pmatrix} 0  -p \\\\ 0  0 \\end{pmatrix} \\implies U = \\begin{pmatrix} 0  p \\\\ 0  0 \\end{pmatrix}\n$$\n\n求解 $Ax=b$ 的定常迭代法具有一般形式 $x^{(k+1)} = Tx^{(k)} + c$，其中 $T$ 是迭代矩阵。该方法对任意初始猜测收敛的充要条件是迭代矩阵的谱半径 $\\rho(T)$ 小于 $1$。\n\n**Jacobi迭代矩阵的推导**\nJacobi迭代定义为 $Dx^{(k+1)} = (L+U)x^{(k)} + b$。\n这得到 $x^{(k+1)} = D^{-1}(L+U)x^{(k)} + D^{-1}b$。\n因此，Jacobi迭代矩阵 $T_J$ 为 $T_J = D^{-1}(L+U)$。\n由于 $D=I$，其逆矩阵为 $D^{-1}=I$。\n$$\nT_J = I(L+U) = L+U = \\begin{pmatrix} 0  p \\\\ q  0 \\end{pmatrix}\n$$\n\n**Gauss-Seidel迭代矩阵的推导**\nGauss-Seidel迭代定义为 $(D-L)x^{(k+1)} = Ux^{(k)} + b$。\n这得到 $x^{(k+1)} = (D-L)^{-1}Ux^{(k)} + (D-L)^{-1}b$。\n因此，Gauss-Seidel迭代矩阵 $T_{GS}$ 为 $T_{GS} = (D-L)^{-1}U$。\n首先，我们计算 $D-L$ 及其逆矩阵：\n$$\nD-L = \\begin{pmatrix} 1  0 \\\\ -q  1 \\end{pmatrix}\n$$\n逆矩阵为：\n$$\n(D-L)^{-1} = \\frac{1}{(1)(1) - (0)(-q)} \\begin{pmatrix} 1  0 \\\\ -(-q)  1 \\end{pmatrix} = \\begin{pmatrix} 1  0 \\\\ q  1 \\end{pmatrix}\n$$\n现在，我们可以计算 $T_{GS}$：\n$$\nT_{GS} = (D-L)^{-1}U = \\begin{pmatrix} 1  0 \\\\ q  1 \\end{pmatrix} \\begin{pmatrix} 0  p \\\\ 0  0 \\end{pmatrix} = \\begin{pmatrix} (1)(0)+(0)(0)  (1)(p)+(0)(0) \\\\ (q)(0)+(1)(0)  (q)(p)+(1)(0) \\end{pmatrix} = \\begin{pmatrix} 0  p \\\\ 0  pq \\end{pmatrix}\n$$\n\n**Gershgorin圆盘定理与收敛性验证**\nGershgorin定理指出，对于任意 $n \\times n$ 矩阵 $M = (m_{ij})$，其所有特征值都位于复平面上 $n$ 个圆盘的并集之内，其中第 $i$ 个圆盘 $G_i$ 的圆心为 $m_{ii}$，半径为 $R_i = \\sum_{j \\neq i} |m_{ij}|$。\n要使一个迭代法被Gershgorin定理验证为收敛，其所有的Gershgorin圆盘必须完全位于开放单位圆盘 $\\{z \\in \\mathbb{C} : |z|  1\\}$ 内。如果对于每一行 $i$，条件 $|m_{ii}| + R_i  1$ 都成立，则该条件得到满足。\n\n**Jacobi收敛性验证分析**\n对于 $T_J = \\begin{pmatrix} 0  p \\\\ q  0 \\end{pmatrix}$：\n- 第1行：圆心为 $m_{11} = 0$。半径为 $R_1 = |p| = p$（因为 $p0$）。该圆盘的条件为 $|0| + p  1$，简化为 $p  1$。\n- 第2行：圆心为 $m_{22} = 0$。半径为 $R_2 = |q| = q$（因为 $q0$）。该圆盘的条件为 $|0| + q  1$，简化为 $q  1$。\nGershgorin定理验证Jacobi收敛的充要条件是 $p  1$ 且 $q  1$。如果 $p \\geq 1$ 或 $q \\geq 1$，则验证失败。\n\n**Gauss-Seidel收敛性验证分析**\n对于 $T_{GS} = \\begin{pmatrix} 0  p \\\\ 0  pq \\end{pmatrix}$：\n- 第1行：圆心为 $m_{11} = 0$。半径为 $R_1 = |p| = p$。该圆盘的条件为 $|0| + p  1$，即 $p  1$。\n- 第2行：圆心为 $m_{22} = pq$。半径为 $R_2 = |0| = 0$。该圆盘的条件为 $|pq| + 0  1$。由于 $p0$ 且 $q0$，这简化为 $pq  1$。\nGershgorin定理验证Gauss-Seidel收敛的充要条件是 $p  1$ 且 $pq  1$。\n\n**寻找$p$和$q$的条件**\n我们需要找到$p$和$q$的条件，使得：\n1. Gauss-Seidel收敛性得到验证：$p  1$ 且 $pq  1$。\n2. Jacobi收敛性验证失败：$p \\geq 1$ 或 $q \\geq 1$。\n\n结合这些条件，我们需要 ($p  1$ 且 $pq  1$) 且 ($p \\geq 1$ 或 $q \\geq 1$)。\n第一部分的条件 $p  1$ 使得第二部分的 $p \\geq 1$ 不可能成立。因此，条件简化为：\n$p  1$，$pq  1$ 且 $q \\geq 1$。\n\n让我们使用提供的参数 $p = \\frac{1}{2}$ 和 $q = \\frac{8}{5}$ 来验证这些条件。\n- $p = \\frac{1}{2}  1$。此条件满足。\n- $q = \\frac{8}{5} = 1.6 \\geq 1$。此条件满足。\n- $pq = \\left(\\frac{1}{2}\\right)\\left(\\frac{8}{5}\\right) = \\frac{8}{10} = \\frac{4}{5}  1$。此条件满足。\n所选参数确实满足推导出的要求。\n\n**谱半径的计算**\n最后，我们计算特定参数 $p = \\frac{1}{2}$ 和 $q = \\frac{8}{5}$ 下的Gauss-Seidel迭代矩阵的谱半径 $\\rho(T_{GS})$。\n该矩阵为 $T_{GS} = \\begin{pmatrix} 0  p \\\\ 0  pq \\end{pmatrix}$。\n代入数值：\n$$\nT_{GS} = \\begin{pmatrix} 0  \\frac{1}{2} \\\\ 0  \\left(\\frac{1}{2}\\right)\\left(\\frac{8}{5}\\right) \\end{pmatrix} = \\begin{pmatrix} 0  \\frac{1}{2} \\\\ 0  \\frac{4}{5} \\end{pmatrix}\n$$\n由于 $T_{GS}$ 是一个上三角矩阵，其特征值是其对角线上的元素。特征值为 $\\lambda_1 = 0$ 和 $\\lambda_2 = \\frac{4}{5}$。\n谱半径是特征值绝对值的最大值：\n$$\n\\rho(T_{GS}) = \\max(|\\lambda_1|, |\\lambda_2|) = \\max\\left(|0|, \\left|\\frac{4}{5}\\right|\\right) = \\max\\left(0, \\frac{4}{5}\\right) = \\frac{4}{5}\n$$\n该值小于 $1$，证实了对于这些参数，Gauss-Seidel方法确实收敛，这也与Gershgorin分析的验证结果一致。\n最终答案是该谱半径的精确值。",
            "answer": "$$\\boxed{\\frac{4}{5}}$$"
        },
        {
            "introduction": "这个综合性练习将带你走过一个从物理问题到数值解的全过程，完美展示了盖尔什戈林圆盘定理在偏微分方程数值解中的实际应用。你将从一个给定的偏微分方程出发，通过有限体积法进行离散化，从而构建系统矩阵。随后，你将应用盖尔什戈林圆盘定理来分析该矩阵的谱特性，这对于理解数值格式的稳定性和精度至关重要。这个练习是连接抽象理论与具体计算实践的桥梁。",
            "id": "3399655",
            "problem": "考虑在闭区间 $[0,1]$ 上的狄利克雷边界条件 $u(0) = 0$ 和 $u(1) = 0$ 的一维二阶线性椭圆型偏微分方程 $-(k(x)\\, u'(x))' + c(x)\\, u(x) = f(x)$。系数 $k(x)$ 是严格为正的变量，反应系数 $c(x)$ 是非负变量。在非均匀网格上使用保守有限体积离散化，构建对称正定刚度矩阵 $A \\in \\mathbb{R}^{(N-1) \\times (N-1)}$，其元素满足两点通量近似和反应项的中点法则。然后，使用盖尔什戈林圆盘定理（Gerschgorin Circle Theorem）研究精心选择的变系数和网格情况下特征值界的紧致性。\n\n从以下基本定义和事实开始：\n- 节点 $x_i$ 和 $x_{i+1}$ 之间的界面 $x_{i+\\frac{1}{2}}$ 上的两点通量近似为 $F_{i+\\frac{1}{2}} \\approx -\\dfrac{k(x_{i+\\frac{1}{2}})}{x_{i+1}-x_i}\\,(u_{i+1}-u_i)$，其中 $x_{i+\\frac{1}{2}} = \\dfrac{x_i + x_{i+1}}{2}$。\n- 每个控制体上的保守有限体积平衡产生一个关于内部未知数 $\\mathbf{u} \\in \\mathbb{R}^{N-1}$ 的线性系统 $A \\mathbf{u} = \\mathbf{b}$。\n- 盖尔什戈林圆盘定理指出，方阵 $A$ 的每个特征值 $\\lambda$ 至少位于一个圆盘 $D_i = \\{ z \\in \\mathbb{C} : |z - a_{ii}| \\le r_i \\}$ 中，其中 $r_i = \\sum_{j \\ne i} |a_{ij}|$ 是与第 $i$ 行相关的半径。\n\n离散化要求：\n- 令 $N \\in \\mathbb{N}$ 表示加密前的均匀子区间数量。通过 $x_m = \\left(\\dfrac{m}{N}\\right)^\\alpha$ 定义加密网格，其中 $m = 0,1,\\dots,N$，且 $\\alpha  0$ 控制网格加密。内部未知数位于节点 $x_i$，其中 $i = 1,2,\\dots,N-1$。\n- 令 $h_i = \\dfrac{x_{i+1}-x_{i-1}}{2}$ 表示 $x_i$ 周围的局部控制体大小，其中 $i = 1,2,\\dots,N-1$。\n- 定义面电导 $g_{i+\\frac{1}{2}} = \\dfrac{k(x_{i+\\frac{1}{2}})}{x_{i+1}-x_i}$ 和 $g_{i-\\frac{1}{2}} = \\dfrac{k(x_{i-\\frac{1}{2}})}{x_i-x_{i-1}}$。\n- 刚度矩阵的元素则为 $a_{ii} = g_{i+\\frac{1}{2}} + g_{i-\\frac{1}{2}} + c(x_i)\\, h_i$，$a_{i,i+1} = -\\,g_{i+\\frac{1}{2}}$，以及 $a_{i,i-1} = -\\,g_{i-\\frac{1}{2}}$，所有其他元素均为 $0$。当 $k(x)  0$ 且 $c(x) \\ge 0$ 时，这将产生一个对称正定三对角矩阵 $A$。\n\nGerschgorin 分析：\n- 对于每个 $i = 1,2,\\dots,N-1$，令盖尔圆心为 $a_{ii}$，半径为 $r_i = \\sum_{j \\ne i} |a_{ij}| = |a_{i,i-1}| + |a_{i,i+1}|$。\n- 定义特征值 $\\lambda$ 的紧致性度量为 $\\tau(\\lambda) = \\min_{i} \\dfrac{|\\,\\lambda - a_{ii}\\,|}{r_i}$，当满足盖尔圆界时，该值在区间 $[0,1]$ 内。定义所有特征值的最坏情况紧致性为 $T = \\max_{\\lambda \\in \\sigma(A)} \\tau(\\lambda)$，其中 $\\sigma(A)$ 表示 $A$ 的谱。\n- 定义特征值 $\\lambda$ 的隶属度边际为 $\\mu(\\lambda) = \\max_{i} \\left( r_i - |\\,\\lambda - a_{ii}\\,| \\right)$，全局隶属度条件为 $\\min_{\\lambda \\in \\sigma(A)} \\mu(\\lambda) \\ge 0$，该条件验证所有特征值都位于圆盘的并集内。\n\n您的任务：\n1. 实现一个函数，根据给定的 $N$、$\\alpha$、$k(x)$ 和 $c(x)$，按照上述离散化方法构建矩阵 $A$。\n2. 对每个测试用例，计算 $A$ 的所有特征值、盖尔圆心 $a_{ii}$ 和半径 $r_i$。\n3. 计算布尔值的盖尔圆隶属度条件和如上定义的最坏情况紧致性 $T$。\n4. 将所有测试用例的结果汇总到单行输出中，该输出包含一个逗号分隔的用例结果列表，每个用例的结果为列表 $[\\text{membership}, T]$，其中 $\\text{membership}$ 是布尔值，$T$ 是浮点数。\n\n单位要求：\n- 这是一个纯数学问题；没有需要报告的物理单位。不涉及角度，因此不需要指定角度单位。所有数值输出均为无单位的实数。\n\n测试套件：\n使用以下五个测试用例，它们共同探测理想情况下的行为、中等占优、纯扩散、强网格加密以及带加密网格的低分辨率情况：\n- 用例 1：$N = 50$, $\\alpha = 1.0$, $k(x) = 1 + 0.2 \\sin(2 \\pi x)$, $c(x) = 50 \\,\\big(1 + 0.5 \\sin(2 \\pi x)\\big)$。\n- 用例 2：$N = 50$, $\\alpha = 1.0$, $k(x) = 1 + 0.2 \\sin(2 \\pi x)$, $c(x) = 1 \\,\\big(1 + 0.5 \\sin(2 \\pi x)\\big)$。\n- 用例 3：$N = 50$, $\\alpha = 1.0$, $k(x) = 1 + 0.2 \\sin(2 \\pi x)$, $c(x) = 0$。\n- 用例 4：$N = 80$, $\\alpha = 3.0$, $k(x) = 1 + 5 \\exp\\!\\left( -\\left(\\dfrac{x - 0.8}{0.1}\\right)^2 \\right)$, $c(x) = 20 \\,\\big(1 + 0.5 \\sin(2 \\pi x)\\big)$。\n- 用例 5：$N = 30$, $\\alpha = 0.5$, $k(x) = 1 + 0.8 \\exp\\!\\left( -\\left(\\dfrac{x - 0.3}{0.2}\\right)^2 \\right)$, $c(x) = 10 \\,\\big(1 + 0.5 \\sin(2 \\pi x)\\big)$。\n\n最终输出格式：\n您的程序应产生单行输出，包含一个用方括号括起来的逗号分隔的结果列表。每个用例的结果必须表示为一个双元素列表 $[\\text{membership}, T]$，其中 $\\text{membership}$ 是 $True$ 或 $False$，$T$ 是一个实数。例如，两个用例的输出应如下所示：$[[True,0.0123],[True,0.314]]$。",
            "solution": "该问题要求对一维椭圆型偏微分方程的有限体积离散化进行构建和分析，重点关注所得刚度矩阵的谱特性，并通过盖尔圆定理（Gerschgorin Circle Theorem）对其进行表征。验证过程确认了问题陈述在科学上是合理的、自洽的且适定的。所有定义均为数值分析中的标准定义，且测试用例提供了物理上合理且行为良好的系数。因此，我们可以进行形式化的求解。\n\n该过程包括三个主要阶段：\n1.  使用保守有限体积法从连续偏微分方程推导离散代数系统。\n2.  根据指定的网格和系数函数构建刚度矩阵 $A$。\n3.  计算 $A$ 的特征值，并使用盖尔圆定理的度量进行分析。\n\n**1. 有限体积离散化与矩阵构建**\n\n给定的偏微分方程为：\n$$\n-(k(x)\\, u'(x))' + c(x)\\, u(x) = f(x) \\quad \\text{for } x \\in [0, 1]\n$$\n齐次狄利克雷边界条件为 $u(0) = 0$ 和 $u(1) = 0$。\n\n区域 $[0, 1]$ 使用由 $N$ 个子区间和加密参数 $\\alpha  0$ 定义的加密网格进行离散化。网格点为 $x_m = (m/N)^\\alpha$，其中 $m = 0, 1, \\dots, N$。这产生 $N+1$ 个网格点，其中 $x_0=0$ 和 $x_N=1$。解在 $N-1$ 个内部节点 $x_1, x_2, \\dots, x_{N-1}$ 处求解。令 $u_i \\approx u(x_i)$ 为离散近似解。\n\n我们应用有限体积法，将偏微分方程在围绕每个内部节点 $x_i$ 的控制体 $V_i = [x_{i-1/2}, x_{i+1/2}]$ 上积分。控制体界面位于节点之间的中点：$x_{i \\pm 1/2} = (x_i + x_{i \\pm 1})/2$。控制体的大小为 $h_i = x_{i+1/2} - x_{i-1/2} = (x_{i+1}-x_{i-1})/2$。\n\n将偏微分方程在 $V_i$ 上积分得到：\n$$\n\\int_{x_{i-1/2}}^{x_{i+1/2}} \\left( -(k(x)\\, u'(x))' + c(x)\\, u(x) \\right) dx = \\int_{x_{i-1/2}}^{x_{i+1/2}} f(x) dx\n$$\n对通量项 $F(x) = -k(x)u'(x)$ 应用微积分基本定理：\n$$\nF(x_{i+1/2}) - F(x_{i-1/2}) + \\int_{x_{i-1/2}}^{x_{i+1/2}} c(x)\\, u(x) dx = \\int_{x_{i-1/2}}^{x_{i+1/2}} f(x) dx\n$$\n我们对积分和通量进行近似。界面 $x_{i+1/2}$ 处的通量使用两点通量近似：\n$$\nF_{i+1/2} \\equiv F(x_{i+1/2}) \\approx -k(x_{i+1/2}) \\frac{u_{i+1} - u_i}{x_{i+1} - x_i} = -g_{i+1/2} (u_{i+1} - u_i)\n$$\n其中 $g_{i+1/2} = \\frac{k(x_{i+1/2})}{x_{i+1} - x_i}$ 是面电导。$F_{i-1/2}$ 也有类似的表达式。反应项和源项使用中点法则近似：\n$$\n\\int_{x_{i-1/2}}^{x_{i+1/2}} c(x)\\, u(x) dx \\approx c(x_i) u_i h_i\n$$\n$$\n\\int_{x_{i-1/2}}^{x_{i+1/2}} f(x) dx \\approx f(x_i) h_i\n$$\n将这些近似代入平衡方程，得到每个内部节点 $i = 1, \\dots, N-1$ 的离散方程：\n$$\n-g_{i+1/2}(u_{i+1} - u_i) - \\left( -g_{i-1/2}(u_i - u_{i-1}) \\right) + c(x_i) h_i u_i = f(x_i) h_i\n$$\n整理各项，按未知数 $u_{i-1}, u_i, u_{i+1}$ 分组：\n$$\n-g_{i-1/2} u_{i-1} + (g_{i-1/2} + g_{i+1/2} + c(x_i) h_i) u_i - g_{i+1/2} u_{i+1} = f(x_i) h_i\n$$\n这个由 $N-1$ 个线性方程组成的系统可以写成矩阵形式 $A\\mathbf{u} = \\mathbf{b}$，其中 $\\mathbf{u} = [u_1, u_2, \\dots, u_{N-1}]^T$。刚度矩阵 $A \\in \\mathbb{R}^{(N-1) \\times (N-1)}$ 是三对角的。对于 $i, j \\in \\{1, \\dots, N-1\\}$，其元素为：\n$$\nA_{ij} = \\begin{cases}\n    g_{i-1/2} + g_{i+1/2} + c(x_i)h_i  \\text{if } j = i \\\\\n    -g_{i+1/2}  \\text{if } j = i+1 \\\\\n    -g_{i-1/2}  \\text{if } j = i-1 \\\\\n    0  \\text{otherwise}\n\\end{cases}\n$$\n边界条件 $u_0=0$ 和 $u_N=0$ 通过以下方式并入：当 $i=1$ 时，$u_{i-1}$ 项为 $g_{1/2}u_0=0$；当 $i=N-1$ 时，$u_{i+1}$ 项为 $g_{N-1/2}u_N=0$。这与矩阵定义一致。矩阵 $A$ 是对称的，因为 $A_{i,i+1} = -g_{i+1/2}$ 且 $A_{i+1,i} = -g_{(i+1)-1/2} = -g_{i+1/2}$。由于 $k(x)0$ 且 $c(x) \\ge 0$，该矩阵也是弱对角占优和正定的。\n\n**2. Gerschgorin 圆分析**\n\n盖尔圆定理指出，$A$ 的所有特征值都位于复平面上 $N-1$ 个圆盘的并集 $G = \\bigcup_{i=1}^{N-1} D_i$ 中，其中每个圆盘 $D_i$ 以对角元素 $a_{ii}$ 为中心，半径 $r_i$ 等于该行非对角元素绝对值之和。\n对于我们的矩阵 $A$，圆心和半径为：\n-   第 $i$ 行的圆心：$a_{ii} = g_{i-1/2} + g_{i+1/2} + c(x_i)h_i$。\n-   第 $i$ 行的半径：$r_i = \\sum_{j \\ne i} |A_{ij}|$。对于内部行， $r_i = |A_{i,i-1}| + |A_{i,i+1}| = g_{i-1/2} + g_{i+1/2}$。对于 $i=1$，$r_1=|A_{1,2}|=g_{3/2}$。对于 $i=N-1$，$r_{N-1}=|A_{N-1,N-2}|=g_{N-3/2}$。\n（注意：问题文本中的符号 $a_{i,i-1/2}$ 对应于我的 $g_{i-1/2}$。）\n\n问题定义了两个分析度量：\n-   **全局隶属度条件**：这是一个布尔值，指示是否 $\\min_{\\lambda \\in \\sigma(A)} \\mu(\\lambda) \\ge 0$，其中 $\\mu(\\lambda) = \\max_{i} (r_i - |\\lambda - a_{ii}|)$。根据盖尔圆定理，对于任何特征值 $\\lambda$，必须存在至少一个圆盘 $D_j$，使得 $|\\lambda - a_{jj}| \\le r_j$。这意味着 $r_j - |\\lambda - a_{jj}| \\ge 0$。由于 $\\mu(\\lambda)$ 取这些差值在所有 $j$ 上的最大值，它必须是非负的。因此，对于正确的实现，此条件应始终为真，可作为合理性检查。\n-   **最坏情况紧致性 ($T$)**：定义为 $T = \\max_{\\lambda \\in \\sigma(A)} \\tau(\\lambda)$，其中 $\\tau(\\lambda) = \\min_{i} \\frac{|\\lambda - a_{ii}|}{r_i}$。此度量量化了盖尔圆界接近紧确的程度。$T=1$ 表示某个特征值位于盖尔圆区域的边界上，而 $T=0$ 则意味着每个特征值都是某个盖尔圆盘的中心。\n\n**3. 算法实现**\n\n每个测试用例的计算过程如下：\n1.  给定 $N$ 和 $\\alpha$，生成网格点 $x_m = (m/N)^\\alpha$，其中 $m=0, \\dots, N$。\n2.  使用提供的函数 $k(x)$ 和网格间距，计算面电导 $g_{m+1/2}$，其中 $m=0, \\dots, N-1$。\n3.  构建矩阵 $A$ 的主对角线和次/超对角线。\n    -   长度为 $N-1$ 的主对角线 `d` 由电导和反应项 $c(x_i)h_i$ 构建。\n    -   长度为 $N-2$ 的非对角线 `od` 由内部电导的相反数构建。\n4.  由于 $A$ 是实对称矩阵，其所有特征值均为实数。使用针对三对角对称矩阵的专门算法（例如 `scipy.linalg.eigh_tridiagonal`）高效地计算特征值 $\\sigma(A)$。\n5.  确定盖尔圆心（即 `d` 的元素 $a_{ii}$）和半径 $r_i$。\n6.  对于每个特征值 $\\lambda \\in \\sigma(A)$，计算隶属度边际 $\\mu(\\lambda)$ 和紧致性度量 $\\tau(\\lambda)$。\n7.  通过检查所有特征值的最小 $\\mu(\\lambda)$ 是否非负（在小的浮点容差范围内），来确定全局隶属度条件。\n8.  通过找到所有特征值的最大 $\\tau(\\lambda)$ 来确定最坏情况紧致性 $T$。\n9.  存储布尔隶属度结果和 $T$ 的浮点值。\n10. 对所有测试用例重复此过程，并按指定格式化输出。\n\n此过程在最终答案中提供的 Python 代码中实现。为提高效率，使用了向量化的 `NumPy` 操作。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import linalg\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test suite.\n    It iterates through each case, constructs the stiffness matrix,\n    analyzes it using the Gerschgorin Circle Theorem, and prints the results.\n    \"\"\"\n\n    # Define the coefficient functions for the test cases\n    k_funcs = {\n        1: lambda x: 1 + 0.2 * np.sin(2 * np.pi * x),\n        2: lambda x: 1 + 0.2 * np.sin(2 * np.pi * x),\n        3: lambda x: 1 + 0.2 * np.sin(2 * np.pi * x),\n        4: lambda x: 1 + 5 * np.exp(-((x - 0.8) / 0.1)**2),\n        5: lambda x: 1 + 0.8 * np.exp(-((x - 0.3) / 0.2)**2)\n    }\n\n    c_funcs = {\n        1: lambda x: 50 * (1 + 0.5 * np.sin(2 * np.pi * x)),\n        2: lambda x: 1 * (1 + 0.5 * np.sin(2 * np.pi * x)),\n        3: lambda x: 0 * x,  # c(x) = 0\n        4: lambda x: 20 * (1 + 0.5 * np.sin(2 * np.pi * x)),\n        5: lambda x: 10 * (1 + 0.5 * np.sin(2 * np.pi * x))\n    }\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (N, alpha, k_func_id, c_func_id)\n        (50, 1.0, 1, 1),\n        (50, 1.0, 2, 2),\n        (50, 1.0, 3, 3),\n        (80, 3.0, 4, 4),\n        (30, 0.5, 5, 5),\n    ]\n\n    results = []\n    for N, alpha, k_id, c_id in test_cases:\n        result = construct_and_analyze(N, alpha, k_funcs[k_id], c_funcs[c_id])\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # e.g., [[True,0.123],[False,0.456]]\n    result_str = ','.join([f\"[{res[0]},{res[1]}]\" for res in results])\n    print(f\"[{result_str}]\")\n\n\ndef construct_and_analyze(N, alpha, k_func, c_func):\n    \"\"\"\n    Constructs the stiffness matrix A and performs Gerschgorin analysis.\n\n    Args:\n        N (int): Number of subintervals before grading.\n        alpha (float): Mesh grading parameter.\n        k_func (callable): Function k(x).\n        c_func (callable): Function c(x).\n\n    Returns:\n        tuple: A tuple containing the boolean membership condition and the\n               worst-case tightness T.\n    \"\"\"\n    # 1. Generate mesh and related quantities\n    # The matrix size is (N-1)x(N-1) for N-1 interior nodes\n    n_mat = N - 1\n    \n    # Grid points x_m for m = 0, ..., N\n    m_indices = np.arange(N + 1)\n    x = (m_indices / N)**alpha\n    \n    # Interval widths h_m = x_{m+1} - x_m\n    h_intervals = np.diff(x)\n    \n    # Midpoints of intervals for flux evaluation\n    x_mid_interfaces = x[:-1] + h_intervals / 2\n    \n    # 2. Construct matrix diagonals\n    # Face conductances g_{m+1/2}\n    g = k_func(x_mid_interfaces) / h_intervals\n    \n    # Reaction term c(x_i) * h_i evaluated at interior nodes x_1, ..., x_{N-1}\n    # Control volume size h_i = (x_{i+1} - x_{i-1}) / 2\n    h_volumes = (x[2:] - x[:-2]) / 2.0\n    c_term = c_func(x[1:-1]) * h_volumes\n    \n    # Main diagonal a_ii = g_{i-1/2} + g_{i+1/2} + c(x_i)h_i\n    # For node i (1-based), this corresponds to g[i-1] + g[i] (0-based)\n    d_main = g[:-1] + g[1:] + c_term\n    \n    # Off-diagonal a_{i,i+1} = -g_{i+1/2}\n    # For row i (1-based), this is -g[i] (0-based)\n    od_sub_super = -g[1:-1]\n    \n    # 3. Compute eigenvalues\n    # scipy.linalg.eigh_tridiagonal is efficient for symmetric tridiagonal matrices\n    eigenvalues = linalg.eigh_tridiagonal(d_main, od_sub_super, eigvals_only=True)\n    \n    # 4. Gerschgorin analysis\n    # Centers are the diagonal elements\n    centers = d_main\n    \n    # Radii r_i = sum over j!=i of |a_ij|\n    radii = np.zeros(n_mat)\n    # For a tridiagonal matrix, the radius for row i is |a_{i,i-1}| + |a_{i,i+1}|\n    # Note that od_sub_super stores a_{i,i+1} for i=0..n-2\n    # So |od_sub_super[i]| is |a_{i,i+1}|\n    # and |od_sub_super[i-1]| is |a_{i-1,i}| = |a_{i,i-1}| due to symmetry\n    radii[0] = np.abs(od_sub_super[0])\n    radii[1:-1] = np.abs(od_sub_super[:-1]) + np.abs(od_sub_super[1:])\n    radii[-1] = np.abs(od_sub_super[-1])\n\n    # Ensure radii are not zero to avoid division by zero\n    if np.any(radii == 0):\n        # This case is not expected given k(x) > 0 and non-degenerate mesh\n        raise ValueError(\"Gerschgorin radii must be positive.\")\n\n    # Membership margin: mu(lambda) = max_i(r_i - |lambda - a_ii|)\n    # Global membership: min_lambda(mu(lambda)) >= 0\n    all_mu = []\n    for lam in eigenvalues:\n        margins = radii - np.abs(lam - centers)\n        mu_lam = np.max(margins)\n        all_mu.append(mu_lam)\n    \n    # Check with a small tolerance for floating point errors\n    membership = np.min(all_mu) >= -1e-12 \n\n    # Tightness: tau(lambda) = min_i(|lambda - a_ii| / r_i)\n    # Worst-case tightness: T = max_lambda(tau(lambda))\n    all_tau = []\n    for lam in eigenvalues:\n        distances = np.abs(lam - centers) / radii\n        tau_lam = np.min(distances)\n        all_tau.append(tau_lam)\n    \n    T = np.max(all_tau)\n    \n    return [True if membership else False, T]\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}