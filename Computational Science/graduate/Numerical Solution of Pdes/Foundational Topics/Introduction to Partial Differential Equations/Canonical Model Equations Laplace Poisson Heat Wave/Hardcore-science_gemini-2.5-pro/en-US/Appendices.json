{
    "hands_on_practices": [
        {
            "introduction": "Before delving into numerical approximations, it is invaluable to understand the structure of an exact solution to a canonical partial differential equation. This exercise guides you through the classical method of separation of variables to solve the one-dimensional heat equation. By performing this derivation, you will see how the solution is elegantly expressed as a superposition of fundamental spatial modes, each with a distinct exponential decay rate in time, a core concept that any reliable numerical scheme must be able to capture. ",
            "id": "3367932",
            "problem": "Consider the one-dimensional heat conduction governed by the heat equation, derived from conservation of energy and Fourier’s law of heat conduction, on the spatial interval $(0,L)$:\n$$\nu_{t}(x,t) = \\kappa\\, u_{xx}(x,t), \\quad x \\in (0,L), \\ t > 0,\n$$\nwith homogeneous Dirichlet boundary conditions\n$$\nu(0,t) = 0, \\quad u(L,t) = 0, \\quad t > 0,\n$$\nand an initial temperature distribution\n$$\nu(x,0) = f(x), \\quad x \\in (0,L),\n$$\nwhere $\\kappa > 0$ is a constant thermal diffusivity and $f$ is square-integrable on $(0,L)$. Starting from the fundamental definitions and laws (conservation of energy and Fourier’s law) that lead to the heat equation, use separation of variables to derive the spatial eigenvalue problem implied by the boundary conditions, obtain the complete orthogonal eigenbasis on $(0,L)$, and then express the solution $u(x,t)$ as a sine series with time-dependent coefficients exhibiting exponential decay. From this derivation, compute the general expression for the modal decay rate associated with the $n$-th sine mode. Your final reported quantity should be the closed-form analytic expression for the $n$-th modal decay rate as a function of $n$, $L$, and $\\kappa$. No numerical rounding is required, and no physical units should be included in your reported final expression.",
            "solution": "The derivation proceeds by the method of separation of variables.\n\n1.  **Assume a Separable Solution**: We look for non-trivial solutions of the form $u(x,t) = X(x)T(t)$. Substituting this ansatz into the heat equation $u_{t} = \\kappa u_{xx}$ yields:\n    $$X(x)T'(t) = \\kappa X''(x)T(t)$$\n2.  **Separate the Variables**: Rearranging the terms to separate the functions of $x$ and $t$, we get:\n    $$\\frac{T'(t)}{\\kappa T(t)} = \\frac{X''(x)}{X(x)}$$\n    Since the left-hand side depends only on time $t$ and the right-hand side depends only on space $x$, both must be equal to a constant. We denote this separation constant by $-\\lambda$.\n    $$\\frac{T'(t)}{\\kappa T(t)} = \\frac{X''(x)}{X(x)} = -\\lambda$$\n    This separation leads to two ordinary differential equations (ODEs):\n    -   Spatial ODE: $X''(x) + \\lambda X(x) = 0$\n    -   Temporal ODE: $T'(t) + \\lambda \\kappa T(t) = 0$\n3.  **Solve the Spatial Eigenvalue Problem**: The spatial ODE is solved subject to the homogeneous Dirichlet boundary conditions. Since $u(0,t) = X(0)T(t) = 0$ and $u(L,t) = X(L)T(t) = 0$ for all $t>0$, and we seek a non-trivial solution ($T(t) \\not\\equiv 0$), the boundary conditions on $X(x)$ must be $X(0)=0$ and $X(L)=0$.\n    For non-trivial solutions to this boundary value problem, the separation constant $\\lambda$ must be positive. Let $\\lambda = k^2$ where $k > 0$. The general solution to the spatial ODE is:\n    $$X(x) = A \\cos(kx) + B \\sin(kx)$$\n    Applying the boundary conditions:\n    -   $X(0) = A \\cos(0) + B \\sin(0) = A = 0$. The solution simplifies to $X(x) = B \\sin(kx)$.\n    -   $X(L) = B \\sin(kL) = 0$. For a non-trivial solution ($B \\neq 0$), we require $\\sin(kL)=0$. This condition is satisfied when $kL = n\\pi$ for any integer $n = 1, 2, 3, \\ldots$.\n    This gives the discrete set of allowed values for $k$, denoted $k_n = \\frac{n\\pi}{L}$. The corresponding eigenvalues are $\\lambda_n = k_n^2 = \\left(\\frac{n\\pi}{L}\\right)^2$. The eigenfunctions are $X_n(x) = \\sin\\left(\\frac{n\\pi x}{L}\\right)$.\n4.  **Solve the Temporal ODE**: For each eigenvalue $\\lambda_n$, we solve the temporal ODE $T_n'(t) + \\lambda_n \\kappa T_n(t) = 0$. This is a first-order separable ODE with the solution:\n    $$T_n(t) = C_n e^{-\\lambda_n \\kappa t} = C_n \\exp\\left(-\\kappa \\left(\\frac{n\\pi}{L}\\right)^2 t\\right)$$\n    where $C_n$ is a constant determined by the initial conditions.\n5.  **Identify the Modal Decay Rate**: The general solution $u(x,t)$ is a linear superposition of these fundamental solutions:\n    $$u(x,t) = \\sum_{n=1}^{\\infty} C_n \\sin\\left(\\frac{n\\pi x}{L}\\right) \\exp\\left(-\\kappa \\left(\\frac{n\\pi}{L}\\right)^2 t\\right)$$\n    Each term in the series represents a spatial mode whose amplitude decays exponentially in time. The time-dependent part of the $n$-th mode is $e^{-\\gamma_n t}$, where the coefficient $\\gamma_n$ in the exponent is the modal decay rate. By inspection, the decay rate for the $n$-th mode is:\n    $$\\gamma_n = \\kappa \\left(\\frac{n\\pi}{L}\\right)^2 = \\kappa \\frac{n^2 \\pi^2}{L^2}$$\nThis expression quantifies the rate at which the $n$-th spatial mode of the temperature distribution dissipates.",
            "answer": "$$\\boxed{\\kappa \\frac{n^2 \\pi^2}{L^2}}$$"
        },
        {
            "introduction": "A significant challenge in applying finite difference methods is the treatment of boundary conditions on domains with irregular shapes that do not conform to a simple Cartesian grid. This practice introduces the powerful ghost cell method, a technique used to embed a complex boundary within a structured grid. Through the step-by-step derivation of a second-order accurate extrapolation formula, you will gain insight into how to design custom finite difference stencils that accurately impose boundary data, a fundamental skill in developing robust numerical solvers. ",
            "id": "3367999",
            "problem": "Consider the Poisson equation $-\\Delta u = f$ posed on a smooth bounded domain $\\Omega \\subset \\mathbb{R}^{2}$ with Dirichlet boundary condition $u = g$ prescribed on the boundary $\\Gamma = \\partial \\Omega$. You aim to construct a second-order accurate finite-difference discretization on a uniform Cartesian grid of spacing $h$ that embeds the irregular boundary using ghost cells. In the ghost cell method, values of $u$ outside $\\Omega$ are introduced to close stencils near the boundary and are determined so that the interior discretization enforces the Dirichlet boundary condition consistently.\n\nFocus on a single grid line segment that crosses the boundary $\\Gamma$ transversely. Let $\\mathbf{x}_{0}$ denote the ghost grid point outside $\\Omega$, and let $\\mathbf{x}_{1}$ and $\\mathbf{x}_{2}$ denote the first and second interior grid points along the inward normal direction to $\\Gamma$ at the intersection point. Let $\\mathbf{x}_{b}$ be the unique intersection of $\\Gamma$ with the line segment $\\overline{\\mathbf{x}_{0}\\mathbf{x}_{1}}$, and assume the distances along the normal satisfy $|\\mathbf{x}_{1} - \\mathbf{x}_{0}| = h$, $|\\mathbf{x}_{2} - \\mathbf{x}_{1}| = h$, and $|\\mathbf{x}_{b} - \\mathbf{x}_{0}| = \\beta h$ with $0  \\beta  1$.\n\nStarting from the definition of the Dirichlet boundary condition $u(\\mathbf{x}_{b}) = g(\\mathbf{x}_{b})$, and using only well-tested numerical analysis facts (in particular, smoothness of $u$ near $\\mathbf{x}_{b}$ and consistency arguments from polynomial reproduction), derive a second-order accurate formula for the ghost value $u(\\mathbf{x}_{0})$ expressed as a linear combination of $g(\\mathbf{x}_{b})$, $u(\\mathbf{x}_{1})$, and $u(\\mathbf{x}_{2})$ with coefficients depending only on $\\beta$. Your derivation must proceed from first principles by constructing a locally quadratic approximation of $u$ along the boundary-normal coordinate and evaluating it at $\\mathbf{x}_{0}$.\n\nProvide the final analytic expression for $u(\\mathbf{x}_{0})$ in terms of $g(\\mathbf{x}_{b})$, $u(\\mathbf{x}_{1})$, $u(\\mathbf{x}_{2})$, and $\\beta$. No numerical approximation or rounding is required. The answer must be a single closed-form expression.",
            "solution": "The problem statement is well-posed, scientifically grounded, and contains all necessary information to derive the requested formula. It describes a standard and fundamental technique in the numerical solution of partial differential equations for handling irregular domains on a Cartesian grid, known as the ghost cell method or a variant of the immersed boundary method. The problem is therefore valid.\n\nThe objective is to find a second-order accurate expression for the value of the solution $u$ at a ghost point $\\mathbf{x}_{0}$ outside the domain $\\Omega$. This expression will enforce the Dirichlet boundary condition $u(\\mathbf{x}_{b}) = g(\\mathbf{x}_{b})$ at the boundary point $\\mathbf{x}_{b}$. The formula for the ghost value $u(\\mathbf{x}_{0})$ will be a linear combination of the known boundary value $g(\\mathbf{x}_{b})$ and the values at two interior grid points, $u(\\mathbf{x}_{1})$, and $u(\\mathbf{x}_{2})$.\n\nThe problem is essentially one-dimensional along the grid line normal to the boundary $\\Gamma$. Let us define a one-dimensional coordinate $s$ along this line, with its origin at the ghost point $\\mathbf{x}_{0}$. The positions of the relevant points are:\n\\begin{itemize}\n    \\item The ghost point $\\mathbf{x}_{0}$ is at $s_{0} = 0$.\n    \\item The boundary point $\\mathbf{x}_{b}$ is at $s_{b} = \\beta h$.\n    \\item The first interior grid point $\\mathbf{x}_{1}$ is at $s_{1} = h$.\n    \\item The second interior grid point $\\mathbf{x}_{2}$ is at $s_{2} = 2h$.\n\\end{itemize}\nThe problem states that the function $u$ is smooth near the boundary. We are instructed to construct a locally quadratic approximation for $u$ along the coordinate $s$. Let this quadratic polynomial be denoted by $p(s)$. This polynomial is determined by making it pass through the three points where we have information about the solution: at $\\mathbf{x}_{b}$ (where the value is given by the boundary condition), $\\mathbf{x}_{1}$, and $\\mathbf{x}_{2}$. Let us denote the values of the solution at these points as $g(\\mathbf{x}_{b})$, $u(\\mathbf{x}_{1})$, and $u(\\mathbf{x}_{2})$ respectively.\n\nThe unique quadratic polynomial $p(s)$ that passes through the three points $(s_{b}, g(\\mathbf{x}_{b}))$, $(s_{1}, u(\\mathbf{x}_{1}))$, and $(s_{2}, u(\\mathbf{x}_{2}))$ can be expressed using Lagrange interpolation:\n$$p(s) = g(\\mathbf{x}_{b}) L_{b}(s) + u(\\mathbf{x}_{1}) L_{1}(s) + u(\\mathbf{x}_{2}) L_{2}(s)$$\nwhere $L_{b}(s)$, $L_{1}(s)$, and $L_{2}(s)$ are the Lagrange basis polynomials defined as:\n$$L_{b}(s) = \\frac{(s-s_{1})(s-s_{2})}{(s_{b}-s_{1})(s_{b}-s_{2})}$$\n$$L_{1}(s) = \\frac{(s-s_{b})(s-s_{2})}{(s_{1}-s_{b})(s_{1}-s_{2})}$$\n$$L_{2}(s) = \\frac{(s-s_{b})(s-s_{1})}{(s_{2}-s_{b})(s_{2}-s_{1})}$$\nThe value of the solution at the ghost point, $u(\\mathbf{x}_{0})$, is approximated by evaluating this polynomial at $s = s_{0} = 0$. Thus, $u(\\mathbf{x}_{0}) \\approx p(0)$.\n$$u(\\mathbf{x}_{0}) = g(\\mathbf{x}_{b}) L_{b}(0) + u(\\mathbf{x}_{1}) L_{1}(0) + u(\\mathbf{x}_{2}) L_{2}(0)$$\nWe now compute the values of the coefficients $L_{b}(0)$, $L_{1}(0)$, and $L_{2}(0)$.\n\nFirst, for the coefficient of $g(\\mathbf{x}_{b})$:\n$$L_{b}(0) = \\frac{(0-s_{1})(0-s_{2})}{(s_{b}-s_{1})(s_{b}-s_{2})} = \\frac{(-h)(-2h)}{(\\beta h - h)(\\beta h - 2h)} = \\frac{2h^2}{h^2(\\beta-1)(\\beta-2)} = \\frac{2}{(\\beta-1)(\\beta-2)}$$\nSince $0  \\beta  1$, both $(\\beta-1)$ and $(\\beta-2)$ are negative. We can write this as:\n$$L_{b}(0) = \\frac{2}{(1-\\beta)(2-\\beta)}$$\n\nNext, for the coefficient of $u(\\mathbf{x}_{1})$:\n$$L_{1}(0) = \\frac{(0-s_{b})(0-s_{2})}{(s_{1}-s_{b})(s_{1}-s_{2})} = \\frac{(-\\beta h)(-2h)}{(h - \\beta h)(h - 2h)} = \\frac{2\\beta h^2}{h(1-\\beta)(-h)} = -\\frac{2\\beta}{1-\\beta}$$\n\nFinally, for the coefficient of $u(\\mathbf{x}_{2})$:\n$$L_{2}(0) = \\frac{(0-s_{b})(0-s_{1})}{(s_{2}-s_{b})(s_{2}-s_{1})} = \\frac{(-\\beta h)(-h)}{(2h - \\beta h)(2h - h)} = \\frac{\\beta h^2}{h(2-\\beta)h} = \\frac{\\beta}{2-\\beta}$$\n\nCombining these coefficients, we obtain the formula for the ghost value $u(\\mathbf{x}_{0})$:\n$$u(\\mathbf{x}_{0}) = \\frac{2}{(1-\\beta)(2-\\beta)} g(\\mathbf{x}_{b}) - \\frac{2\\beta}{1-\\beta} u(\\mathbf{x}_{1}) + \\frac{\\beta}{2-\\beta} u(\\mathbf{x}_{2})$$\nThis expression provides the value at the ghost point as a linear combination of the boundary value and the first two interior points. The coefficients depend only on $\\beta$, as required. The use of a quadratic approximation ensures that the error in this formula is $O(h^3)$, which, when used in a standard second-order finite-difference stencil for the Laplacian, results in a local truncation error of $O(h)$ at the grid points near the boundary. This is sufficient to maintain overall second-order accuracy for the global solution of the Poisson equation.",
            "answer": "$$\\boxed{\\frac{2}{(1-\\beta)(2-\\beta)} g(\\mathbf{x}_{b}) - \\frac{2\\beta}{1-\\beta} u(\\mathbf{x}_{1}) + \\frac{\\beta}{2-\\beta} u(\\mathbf{x}_{2})}$$"
        },
        {
            "introduction": "While standard methods for the Poisson equation effectively solve for the potential field $u$, the physically crucial flux variable, $\\boldsymbol{\\sigma} = -\\nabla u$, is often recovered through post-processing, which can compromise both accuracy and local conservation. This advanced practice explores a mixed formulation where the flux and potential are treated as independent unknowns and solved for simultaneously. By working with $H(\\mathrm{div})$-conforming elements, you will directly engage with the mathematical framework that allows for the strict enforcement of local conservation laws, a critical feature for high-fidelity simulations in fluid mechanics and other transport-driven fields. ",
            "id": "3367898",
            "problem": "Consider the canonical Poisson equation on a bounded Lipschitz domain $\\Omega \\subset \\mathbb{R}^2$ with outward unit normal $\\boldsymbol{n}$, written in the mixed form by introducing the flux $\\boldsymbol{\\sigma} = -\\nabla u$ (with $u$ interpreted as pressure):\n$$\n\\boldsymbol{\\sigma} + \\nabla u = \\boldsymbol{0} \\quad \\text{in } \\Omega, \\qquad \\nabla \\cdot \\boldsymbol{\\sigma} = f \\quad \\text{in } \\Omega,\n$$\nwith Neumann boundary condition\n$$\n\\boldsymbol{\\sigma} \\cdot \\boldsymbol{n} = g \\quad \\text{on } \\partial \\Omega.\n$$\nAssume the global compatibility condition $\\int_{\\Omega} f\\, \\mathrm{d}\\boldsymbol{x} = \\int_{\\partial \\Omega} g\\, \\mathrm{d}s$ holds, and set the pressure mean to zero to remove the nullspace ambiguity. The mixed weak formulation seeks $\\boldsymbol{\\sigma} \\in H(\\mathrm{div};\\Omega)$ and $u \\in L^2(\\Omega)$ such that local conservation is enforced cellwise.\n\nYour task is to:\n- Start from the fundamental definitions of the Sobolev space $H(\\mathrm{div};\\Omega)$, the divergence operator, and the mixed formulation of the Poisson equation.\n- Design $H(\\mathrm{div})$-conforming lowest-order Raviart–Thomas elements (also known as $\\mathrm{RT}_0$) on a Cartesian partition of the unit square domain $\\Omega = [0,1]^2$ into $N_x \\times N_y$ rectangles, where the $H(\\mathrm{div})$ conformity enforces continuity of the normal flux across inter-element faces.\n- Derive a discrete scheme that enforces exact local conservation of fluxes on each cell, expressed as the equality between the sum of outward normal fluxes through the cell faces and the cellwise integral of the source $f$, under the Neumann boundary prescription $\\boldsymbol{\\sigma}\\cdot \\boldsymbol{n} = g$ on boundary faces.\n- Implement this scheme on orthogonal uniform Cartesian grids for isotropic unit conductivity, which reduces to a cell-centered two-point flux approximation consistent with the mixed $\\mathrm{RT}_0$ method on such grids.\n- Enforce a zero-mean condition for $u$ through an algebraic constraint to ensure uniqueness.\n\nProgram requirements:\n- Implement the described method for the unit square $\\Omega = [0,1]^2$ with uniform spacings $\\Delta x = 1/N_x$, $\\Delta y = 1/N_y$.\n- Use midpoint quadrature to approximate $\\int_{\\text{cell}} f\\,\\mathrm{d}\\boldsymbol{x}$ and exact face-length scaling for the boundary flux contribution $\\int_{\\text{face}} g\\,\\mathrm{d}s$ via $g$ evaluated at the face midpoint times the face length.\n- Assemble a symmetric linear system in the cell pressures with an additional Lagrange multiplier to enforce the zero-mean pressure constraint, solve it, and then compute the cellwise net flux imbalance defined by the absolute value of\n$$\n\\left(\\sum_{\\text{faces of the cell}} \\text{outward flux}\\right) - \\left(\\int_{\\text{cell}} f\\,\\mathrm{d}\\boldsymbol{x}\\right).\n$$\n\nTest suite:\nFor each of the following parameter sets, construct the grid, source $f$, and boundary flux $g$, compute the solution, and report the maximum absolute local conservation residual over all cells as a floating-point number.\n\n- Test Case 1 (happy path with nontrivial boundary flux):\n  - Grid: $N_x = N_y = 8$.\n  - Source: $f(x,y) = 0$.\n  - Boundary flux from a linear pressure $u(x,y) = x + y$ yielding $\\boldsymbol{\\sigma} = -\\nabla u = (-1,-1)$:\n    - Left boundary ($x=0$): $g = 1$.\n    - Right boundary ($x=1$): $g = -1$.\n    - Bottom boundary ($y=0$): $g = 1$.\n    - Top boundary ($y=1$): $g = -1$.\n- Test Case 2 (constant source consistent with uniform boundary flux):\n  - Grid: $N_x = N_y = 16$.\n  - Source: $f(x,y) = 1$ for all $(x,y)$.\n  - Boundary flux: constant $g = 0.25$ on all boundaries, which satisfies $\\int_{\\Omega} f\\,\\mathrm{d}\\boldsymbol{x} = 1$ and $\\int_{\\partial \\Omega} g\\,\\mathrm{d}s = 4 \\times 0.25 = 1$.\n- Test Case 3 (edge case single cell):\n  - Grid: $N_x = N_y = 1$.\n  - Source: $f(x,y) = 0.5$ for all $(x,y)$.\n  - Boundary flux: constant $g = 0.125$ on all boundaries, which satisfies $\\int_{\\Omega} f\\,\\mathrm{d}\\boldsymbol{x} = 0.5$ and $\\int_{\\partial \\Omega} g\\,\\mathrm{d}s = 4 \\times 0.125 = 0.5$.\n\nFinal output specification:\n- Your program should produce a single line of output containing the results of the three test cases as a comma-separated list enclosed in square brackets, in the order given above, i.e., $[\\text{residual}_1,\\text{residual}_2,\\text{residual}_3]$.\n- Each residual must be a floating-point number.",
            "solution": "The user wants to solve the Poisson equation in mixed form using a cell-centered finite volume method, which is equivalent to the lowest-order Raviart-Thomas ($\\mathrm{RT}_0$) mixed finite element method on a uniform Cartesian grid. The solution must enforce local mass conservation and handle the null-space of the pure Neumann problem by enforcing a zero-mean pressure condition.\n\n### 1. Mathematical Formulation\n\nThe governing equations are the mixed form of the Poisson equation on a domain $\\Omega \\subset \\mathbb{R}^2$:\n$$\n\\boldsymbol{\\sigma} + \\nabla u = \\boldsymbol{0} \\quad \\text{in } \\Omega,\n$$\n$$\n\\nabla \\cdot \\boldsymbol{\\sigma} = f \\quad \\text{in } \\Omega.\n$$\nHere, $u$ is the scalar potential (pressure), $\\boldsymbol{\\sigma}$ is the flux vector, and $f$ is a source term. The problem assumes unit isotropic conductivity, which is why the coefficient in front of $\\nabla u$ is $1$. The system is subject to the Neumann boundary condition:\n$$\n\\boldsymbol{\\sigma} \\cdot \\boldsymbol{n} = g \\quad \\text{on } \\partial \\Omega,\n$$\nwhere $\\boldsymbol{n}$ is the outward unit normal to the boundary $\\partial \\Omega$. For a solution to exist, the problem must satisfy the compatibility condition:\n$$\n\\int_{\\Omega} f\\, \\mathrm{d}\\boldsymbol{x} = \\int_{\\partial \\Omega} g\\, \\mathrm{d}s.\n$$\nThis condition states that the total source within the domain must equal the total flux across its boundary.\n\n### 2. Discretization: Cell-Centered Finite Volume Method\n\nWe discretize the domain $\\Omega = [0,1]^2$ into a grid of $N_x \\times N_y$ rectangular cells, indexed by $(i,j)$ for $i \\in \\{0, \\dots, N_x-1\\}$ and $j \\in \\{0, \\dots, N_y-1\\}$. Each cell $K_{i,j}$ has dimensions $\\Delta x = 1/N_x$ and $\\Delta y = 1/N_y$. The pressure $u$ is approximated as a piecewise constant function, with a single value $u_{i,j}$ at the center of each cell $(x_i, y_j)$.\n\nThe core principle of the finite volume method is to enforce conservation locally on each cell. We integrate the divergence equation $\\nabla \\cdot \\boldsymbol{\\sigma} = f$ over a cell $K_{i,j}$:\n$$\n\\int_{K_{i,j}} \\nabla \\cdot \\boldsymbol{\\sigma} \\, \\mathrm{d}\\boldsymbol{x} = \\int_{K_{i,j}} f \\, \\mathrm{d}\\boldsymbol{x}.\n$$\nApplying the Divergence Theorem to the left-hand side transforms the volume integral into a surface integral over the cell's boundary $\\partial K_{i,j}$:\n$$\n\\oint_{\\partial K_{i,j}} \\boldsymbol{\\sigma} \\cdot \\boldsymbol{n}_{K} \\, \\mathrm{d}s = \\int_{K_{i,j}} f \\, \\mathrm{d}\\boldsymbol{x},\n$$\nwhere $\\boldsymbol{n}_{K}$ is the outward normal for cell $K_{i,j}$. The left-hand side represents the total outward flux from the cell, and the right-hand side is the total source within the cell.\n\nThe flux $\\boldsymbol{\\sigma}$ is related to the pressure $u$ by $\\boldsymbol{\\sigma} = -\\nabla u$. We approximate the normal flux across the face between two adjacent cells using a two-point flux approximation. For instance, the flux density in the x-direction across the vertical face between cell $(i,j)$ and $(i+1,j)$ is approximated by:\n$$\n\\sigma_x \\approx - \\frac{u_{i+1,j} - u_{i,j}}{\\Delta x}.\n$$\nThe total flux from cell $(i,j)$ to $(i+1,j)$ is this density multiplied by the face length $\\Delta y$. The term $\\frac{\\Delta y}{\\Delta x}$ is the transmissibility $T_x$ of the face. Similarly, $T_y = \\frac{\\Delta x}{\\Delta y}$ for horizontal faces.\n\nThe conservation equation for an interior cell $(i,j)$ becomes:\n$$\nT_x(u_{i,j} - u_{i+1,j}) + T_x(u_{i,j} - u_{i-1,j}) + T_y(u_{i,j} - u_{i,j+1}) + T_y(u_{i,j} - u_{i,j-1}) = f(x_i, y_j) \\Delta x \\Delta y.\n$$\nThe source integral is approximated using the midpoint rule. This equation relates the pressure in cell $(i,j)$ to that of its four neighbors.\n\nFor a cell on the domain boundary, one or more flux terms are given by the Neumann condition $\\boldsymbol{\\sigma} \\cdot \\boldsymbol{n} = g$. For example, for a cell $(0,j)$ on the left boundary, the outward flux through the left face is $\\int g \\, \\mathrm{d}s \\approx g(0, y_j) \\Delta y$. The conservation equation is modified accordingly.\n\n### 3. Linear System and Uniqueness\n\nAssembling the conservation equations for all $N = N_x N_y$ cells results in a linear system of the form $A\\boldsymbol{u} = \\boldsymbol{b}$, where $\\boldsymbol{u}$ is the vector of unknown cell pressures. The matrix $A$ is symmetric but singular; its null-space is spanned by the vector $\\boldsymbol{1} = (1, 1, \\dots, 1)^T$, reflecting that the pressure is only determined up to an additive constant.\n\nTo obtain a unique solution, we enforce the constraint that the mean pressure is zero. For a uniform grid, this is equivalent to $\\sum_{k=0}^{N-1} u_k = 0$. We incorporate this constraint using a Lagrange multiplier $\\lambda$, which leads to the augmented block matrix system:\n$$\n\\begin{pmatrix} A  \\boldsymbol{1} \\\\ \\boldsymbol{1}^T  0 \\end{pmatrix} \\begin{pmatrix} \\boldsymbol{u} \\\\ \\lambda \\end{pmatrix} = \\begin{pmatrix} \\boldsymbol{b} \\\\ 0 \\end{pmatrix}.\n$$\nThis $(N+1) \\times (N+1)$ system is non-singular and can be solved to find the unique pressure vector $\\boldsymbol{u}$ and the Lagrange multiplier $\\lambda$.\n\n### 4. Local Conservation Residual\n\nThe problem requires calculating the cellwise flux imbalance, or local conservation residual, $R_k$ for each cell $k$:\n$$\nR_k = \\left| \\left(\\sum_{\\text{faces of cell } k} \\text{outward flux}\\right) - \\left(\\int_{\\text{cell } k} f\\,\\mathrm{d}\\boldsymbol{x}\\right) \\right|.\n$$\nThe linear system we constructed, $A\\boldsymbol{u} = \\boldsymbol{b}$, directly represents the conservation laws, i.e., $(\\text{net internal flux}) = (\\text{source}) - (\\text{boundary flux})$. The equation for cell $k$ is precisely $(\\text{Total outward flux})_k = (\\text{Integrated source})_k$. However, the solution $(\\boldsymbol{u}, \\lambda)$ in the augmented system satisfies $A\\boldsymbol{u} + \\boldsymbol{1}\\lambda = \\boldsymbol{b}$, which means $A\\boldsymbol{u} - \\boldsymbol{b} = -\\boldsymbol{1}\\lambda$.\n\nThe vector $A\\boldsymbol{u}-\\boldsymbol{b}$ represents the numerical residuals of the conservation laws. Thus, the residual for each cell $k$ is given by $(A\\boldsymbol{u} - \\boldsymbol{b})_k = -\\lambda$. The absolute local conservation residual is therefore uniform across all cells and is equal to $|\\lambda|$. The maximum residual is simply $|\\lambda|$. The value of $\\lambda$ represents the adjustment needed to satisfy the discrete compatibility condition, which may be non-zero due to numerical quadrature errors. For the given test cases with constant source and boundary data, quadrature is exact and we expect $\\lambda$ to be zero up to machine precision.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    test_cases = [\n        {\n            \"grid\": (8, 8),\n            \"f_func\": lambda x, y: 0.0,\n            \"g_func\": lambda x, y: 1.0 if np.isclose(x, 0.0) or np.isclose(y, 0.0) else -1.0\n        },\n        {\n            \"grid\": (16, 16),\n            \"f_func\": lambda x, y: 1.0,\n            \"g_func\": lambda x, y: 0.25\n        },\n        {\n            \"grid\": (1, 1),\n            \"f_func\": lambda x, y: 0.5,\n            \"g_func\": lambda x, y: 0.125\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        Nx, Ny = case[\"grid\"]\n        f_func = case[\"f_func\"]\n        g_func = case[\"g_func\"]\n        \n        dx = 1.0 / Nx\n        dy = 1.0 / Ny\n        N = Nx * Ny\n        \n        cell_centers_x = np.linspace(dx / 2.0, 1.0 - dx / 2.0, Nx)\n        cell_centers_y = np.linspace(dy / 2.0, 1.0 - dy / 2.0, Ny)\n        \n        # Assemble the N x N matrix A and N x 1 vector b for Au = b\n        A = np.zeros((N, N))\n        b = np.zeros(N)\n\n        T_x = dy / dx  # Transmissibility in x-direction\n        T_y = dx / dy  # Transmissibility in y-direction\n\n        for i in range(Nx):\n            for j in range(Ny):\n                k = i * Ny + j\n                \n                # Right-hand side source term\n                b[k] = f_func(cell_centers_x[i], cell_centers_y[j]) * dx * dy\n                \n                # Flux contributions to matrix A and RHS b\n                # Right face\n                if i  Nx - 1:\n                    kr = (i + 1) * Ny + j\n                    A[k, k] += T_x\n                    A[k, kr] -= T_x\n                else:  # Right boundary\n                    b[k] -= g_func(1.0, cell_centers_y[j]) * dy\n\n                # Left face\n                if i  0:\n                    kl = (i - 1) * Ny + j\n                    A[k, k] += T_x\n                    A[k, kl] -= T_x\n                else:  # Left boundary\n                    b[k] -= g_func(0.0, cell_centers_y[j]) * dy\n                    \n                # Top face\n                if j  Ny - 1:\n                    kt = i * Ny + (j + 1)\n                    A[k, k] += T_y\n                    A[k, kt] -= T_y\n                else:  # Top boundary\n                    b[k] -= g_func(cell_centers_x[i], 1.0) * dx\n\n                # Bottom face\n                if j  0:\n                    kb = i * Ny + (j - 1)\n                    A[k, k] += T_y\n                    A[k, kb] -= T_y\n                else:  # Bottom boundary\n                    b[k] -= g_func(cell_centers_x[i], 0.0) * dx\n\n        # Assemble the augmented (N+1)x(N+1) system\n        M = np.zeros((N + 1, N + 1))\n        rhs_aug = np.zeros(N + 1)\n\n        M[:N, :N] = A\n        M[:N, N] = 1.0  # Lagrange multiplier column (C^T)\n        M[N, :N] = 1.0  # Zero-mean constraint row (C)\n        \n        rhs_aug[:N] = b\n\n        # Solve the augmented system M * sol_aug = rhs_aug\n        sol_aug = np.linalg.solve(M, rhs_aug)\n        \n        # The last element of the solution is the Lagrange multiplier lambda\n        lambda_val = sol_aug[-1]\n        \n        # The maximum absolute local conservation residual is |lambda|\n        results.append(abs(lambda_val))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}