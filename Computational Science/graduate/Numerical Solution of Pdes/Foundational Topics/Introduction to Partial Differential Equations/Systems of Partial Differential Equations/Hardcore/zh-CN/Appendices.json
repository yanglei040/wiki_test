{
    "hands_on_practices": [
        {
            "introduction": "戈杜诺夫（Godunov）类方法的核心是在单元交界面上求解黎曼问题。然而，精确求解器往往非常复杂，尤其对于非线性系统。因此，在实践中我们通常使用近似黎曼求解器。本练习  聚焦于为非线性浅水波方程推导一个最经典和最鲁棒的近似求解器——HLL求解器。这项实践将帮助您建立关于如何近似波结构以及如何根据物理原理构造数值通量的直观理解。",
            "id": "3452354",
            "problem": "考虑无源项的一维浅水方程，其守恒形式写作 $U_{t} + F(U)_{x} = 0$，其中守恒状态量为 $U = (h, hu)^{\\top}$，通量为 $F(U) = \\left( hu, \\, hu^{2} + \\tfrac{1}{2} g h^{2} \\right)^{\\top}$，$h$ 是水深，$u$ 是深度平均速度，$g$ 是重力加速度。在界面 $x=0$ 处的数据间断产生了一个黎曼问题，其左状态为 $U_{L}$（对于 $x0$）和右状态为 $U_{R}$（对于 $x>0$）。浅水方程的雅可比矩阵 $\\partial F / \\partial U$ 的特征值是特征速度 $u \\pm c$，其中 $c = \\sqrt{g h}$ 是重力波速。\n\n你的任务是：\n\n1. 从 $x$–$t$ 平面上的控制体上的守恒律积分形式以及每个边界波的郎肯-雨果尼奥跳跃条件出发，推导 Harten–Lax–van Leer (HLL) 近似黎曼求解器。具体来说，用两个具有恒定速度 $S_{L}$ 和 $S_{R}$ 的波来近似自相似黎曼扇，这两个波界定了一个单一的恒定中间状态 $U^{\\ast}$ 和一个相关的恒定界面通量 $F^{\\ast}$。证明中间状态和通量满足\n$$\nS_{L} \\big( U^{\\ast} - U_{L} \\big) = F^{\\ast} - F(U_{L}), \\qquad\nS_{R} \\big( U_{R} - U^{\\ast} \\big) = F(U_{R}) - F^{\\ast},\n$$\n并利用这些关系以及守恒律，得出一个用 $U_{L}$、$U_{R}$、$F(U_{L})$、$F(U_{R})$、$S_{L}$ 和 $S_{R}$ 表示的 $F^{\\ast}$ 的显式闭式公式。\n\n2. 基于用左右状态值来界定特征速度的方法，为浅水系统证明以下Davis型波速估计的合理性：\n$$\nS_{L} = \\min \\big( u_{L} - c_{L}, \\, u_{R} - c_{R} \\big), \\qquad\nS_{R} = \\max \\big( u_{L} + c_{L}, \\, u_{R} + c_{R} \\big),\n$$\n其中 $c_{K} = \\sqrt{g h_{K}}$，$K \\in \\{L, R\\}$。你的证明应依据双曲结构（特征速度 $u \\pm c$）以及精确黎曼解的所有真实波都必须被包含在近似波扇内的要求。\n\n3. 对于具体的黎曼数据\n$$\ng = 9.81, \\quad h_{L} = 2.0, \\quad u_{L} = 1.5, \\quad h_{R} = 1.0, \\quad u_{R} = 0.0,\n$$\n使用第2部分的Davis波速估计，计算通过 $x=0$ 的HLL数值质量通量（即 $F^{\\ast}$ 的第一个分量）。最终答案以 $\\mathrm{m}^{2} \\, \\mathrm{s}^{-1}$ 为单位，并四舍五入到四位有效数字。",
            "solution": "该问题是有效的，因为它科学地基于双曲守恒律和数值方法的既定理论，特别是浅水方程和Harten-Lax-van Leer (HLL) 近似黎曼求解器。该问题是适定的、客观的，并包含了推导所需公式和计算数值结果的所有必要信息。\n\n### 第1部分：HLL通量公式的推导\n\nHLL近似黎曼求解器简化了黎曼问题的解结构。对于守恒律系统 $U_{t} + F(U)_{x} = 0$，具有初值数据 $U(x,0) = U_L$（对于 $x0$）和 $U(x,0) = U_R$（对于 $x>0$）的黎曼问题的精确解是自相似的，即 $U(x,t) = W(x/t)$。这个解被称为黎曼扇，可能很复杂，涉及激波、稀疏波和接触间断。\n\nHLL近似用一个简化的三状态模型取代了这个复杂的结构。解被假设为分段常数：\n$$\nU(x,t) =\n\\begin{cases}\nU_L  \\text{若 } x/t  S_L \\\\\nU^*  \\text{若 } S_L  x/t  S_R \\\\\nU_R  \\text{若 } x/t > S_R\n\\end{cases}\n$$\n这里，$S_L$ 和 $S_R$ 分别是最左和最右波的速度，它们界定了一个单一的、恒定的中间状态 $U^*$。\n\n我们考虑在 $x$-$t$ 平面上的一个控制体上的守恒律积分形式。对于任何区域 $\\Omega$，根据格林公式可得 $\\iint_{\\Omega} (U_t + F_x) \\,dx\\,dt = \\oint_{\\partial \\Omega} (U\\,dx - F\\,dt) = 0$。\n\n应用郎肯-雨果尼奥跳跃条件，这是该积分形式在以速度 $s$ 移动的间断线上的直接推论，我们得到 $s[U] = [F]$，其中 $[\\cdot]$ 表示穿过间断的跳跃量。\n\nHLL模型有两个间断，一个在 $x=S_L t$ 处，另一个在 $x=S_R t$ 处。HLL（及HLLC）族求解器的一个关键特征是，它们不假设中间区域的通量 $F^*$ 必须等于 $F(U^*)$。相反，它们强制执行定义 $U^*$ 和 $F^*$ 的跳跃条件。\n\n穿过速度为 $S_L$ 的左波，跳跃是从 $U_L$ 到 $U^*$。相应的跳跃条件是：\n$$ S_L (U^* - U_L) = F^* - F(U_L) \\quad (1) $$\n穿过速度为 $S_R$ 的右波，跳跃是从 $U^*$ 到 $U_R$。相应的跳跃条件是：\n$$ S_R (U_R - U^*) = F(U_R) - F^* \\quad (2) $$\n这就是问题要求证明的两个关系。它们是HLL模型的基础关系，类似于郎肯-雨果尼奥条件，定义了中间状态 $U^*$ 及其相关的恒定通量 $F^*$。这些关系的一致性通过在整个波扇上满足积分守恒律来保证。将守恒律在区域 $[S_L T, S_R T]$ 上从 $t=0$ 到 $t=T$ 进行积分并取平均，可以得到一个 $U^*$ 的表达式，该表达式与联立方程(1)和(2)得到的结果一致。\n\n我们的目标是找到中间通量 $F^*$ 的一个显式公式。我们有一个关于两个未知向量 $U^*$ 和 $F^*$ 的两个线性向量方程组。我们可以解这个方程组来消去 $U^*$。\n\n从方程(1)，我们可以写出 $S_L U^* = S_L U_L + F^* - F(U_L)$。\n从方程(2)，我们可以写出 $S_R U^* = S_R U_R - F(U_R) + F^*$。\n\n为了消去 $U^*$，我们将第一个表达式乘以 $S_R$，第二个表达式乘以 $S_L$：\n$$ S_R S_L U^* = S_R(S_L U_L + F^* - F(U_L)) $$\n$$ S_L S_R U^* = S_L(S_R U_R - F(U_R) + F^*) $$\n令等式右边相等：\n$$ S_R S_L U_L + S_R F^* - S_R F(U_L) = S_L S_R U_R - S_L F(U_R) + S_L F^* $$\n现在，我们将包含 $F^*$ 的项收集到一边：\n$$ S_R F^* - S_L F^* = S_L S_R U_R - S_R S_L U_L + S_R F(U_L) - S_L F(U_R) $$\n$$ F^*(S_R - S_L) = S_R F(U_L) - S_L F(U_R) + S_L S_R (U_R - U_L) $$\n假设 $S_R \\neq S_L$，我们可以解出 $F^*$：\n$$ F^* = \\frac{S_R F(U_L) - S_L F(U_R) + S_L S_R (U_R - U_L)}{S_R - S_L} $$\n这就是著名的HLL通量公式，它提供了界面处的数值通量。通量 $F^*$ 对应于有限体积格式中用于黎曼问题所在位置的单元界面的恒定通量 $F_{i+1/2}$。\n\n### 第2部分：Davis型波速估计的合理性证明\n\nHLL求解器的准确性和稳健性关键取决于波速 $S_L$ 和 $S_R$ 的选择。为了使格式具有物理意义， $S_L$ 和 $S_R$ 之间的区域必须包含整个真实的黎曼扇。这意味着 $S_L$ 必须小于或等于精确解中最慢波的速度，而 $S_R$ 必须大于或等于最快波的速度。\n设 $\\lambda_{\\min}$ 和 $\\lambda_{\\max}$ 分别为精确解扇中所有状态下的最小和最大特征速度。那么我们需要：\n$$ S_L \\le \\lambda_{\\min} \\quad \\text{和} \\quad S_R \\ge \\lambda_{\\max} $$\n浅水方程的特征速度为 $\\lambda_{1,2} = u \\pm c$，其中 $c = \\sqrt{gh}$。可能的最慢波速与 $\\lambda_1 = u - c$ 相关，最快波速与 $\\lambda_2 = u + c$ 相关。\n\n在不解出完整的非线性问题的情况下，黎曼扇内的精确状态是未知的。因此，必须仅使用已知的初始数据 $U_L$ 和 $U_R$ 来估计 $S_L$ 和 $S_R$。存在多种估计策略。Davis波速估计(1988)通过取在左右状态下评估的极值特征速度，提供了一个简单而稳健的选择。\n\n精确解中的最小特征速度由在解中所有可能状态下评估的特征速度的最小值作为下界。一个简单实用的估计是假设这个最小值由仅在初始左右状态下评估的最慢特征速度的最小值作为界限。\n因此，最左波速 $S_L$ 的估计为：\n$$ S_L = \\min ( \\lambda_{1}(U_L), \\lambda_{1}(U_R) ) = \\min ( u_L - c_L, u_R - c_R ) $$\n其中 $c_L = \\sqrt{g h_L}$ 和 $c_R = \\sqrt{g h_R}$。\n\n类似地，最右波速 $S_R$ 的估计取为在初始左右状态下评估的最快特征速度的最大值：\n$$ S_R = \\max ( \\lambda_{2}(U_L), \\lambda_{2}(U_R) ) = \\max ( u_L + c_L, u_R + c_R ) $$\n\n这种选择确保了从黎曼扇边界发出的波被包含在HLL扇内。虽然如果真实波速远没有那么极端，这种估计可能会过于耗散，但它保证了稳定性，并防止波从用于更新的计算模板中“泄漏”出去，这对于数值格式来说是一个至关重要的属性。\n\n### 第3部分：HLL质量通量的数值计算\n\n给定以下数据：\n$g = 9.81 \\, \\mathrm{m}/\\mathrm{s}^2$\n左状态：$h_L = 2.0 \\, \\mathrm{m}$, $u_L = 1.5 \\, \\mathrm{m}/\\mathrm{s}$\n右状态：$h_R = 1.0 \\, \\mathrm{m}$, $u_R = 0.0 \\, \\mathrm{m}/\\mathrm{s}$\n\n首先，我们计算左右状态的状态向量 $U$、通量向量 $F$ 和波速 $c$。\n\n**左状态 ($L$):**\n- 水深: $h_L = 2.0$\n- 速度: $u_L = 1.5$\n- 波速: $c_L = \\sqrt{g h_L} = \\sqrt{9.81 \\times 2.0} = \\sqrt{19.62} \\, \\mathrm{m}/\\mathrm{s}$\n- 状态向量: $U_L = \\begin{pmatrix} h_L \\\\ h_L u_L \\end{pmatrix} = \\begin{pmatrix} 2.0 \\\\ 2.0 \\times 1.5 \\end{pmatrix} = \\begin{pmatrix} 2.0 \\\\ 3.0 \\end{pmatrix}$\n- 通量向量: $F(U_L) = \\begin{pmatrix} h_L u_L \\\\ h_L u_L^2 + \\tfrac{1}{2} g h_L^2 \\end{pmatrix} = \\begin{pmatrix} 3.0 \\\\ 2.0 \\times (1.5)^2 + \\tfrac{1}{2}(9.81)(2.0)^2 \\end{pmatrix} = \\begin{pmatrix} 3.0 \\\\ 4.5 + 19.62 \\end{pmatrix} = \\begin{pmatrix} 3.0 \\\\ 24.12 \\end{pmatrix}$\n\n**右状态 ($R$):**\n- 水深: $h_R = 1.0$\n- 速度: $u_R = 0.0$\n- 波速: $c_R = \\sqrt{g h_R} = \\sqrt{9.81 \\times 1.0} = \\sqrt{9.81} \\, \\mathrm{m}/\\mathrm{s}$\n- 状态向量: $U_R = \\begin{pmatrix} h_R \\\\ h_R u_R \\end{pmatrix} = \\begin{pmatrix} 1.0 \\\\ 1.0 \\times 0.0 \\end{pmatrix} = \\begin{pmatrix} 1.0 \\\\ 0.0 \\end{pmatrix}$\n- 通量向量: $F(U_R) = \\begin{pmatrix} h_R u_R \\\\ h_R u_R^2 + \\tfrac{1}{2} g h_R^2 \\end{pmatrix} = \\begin{pmatrix} 0.0 \\\\ 1.0 \\times (0.0)^2 + \\tfrac{1}{2}(9.81)(1.0)^2 \\end{pmatrix} = \\begin{pmatrix} 0.0 \\\\ 4.905 \\end{pmatrix}$\n\n接下来，我们计算Davis波速估计 $S_L$ 和 $S_R$。\n- $u_L - c_L = 1.5 - \\sqrt{19.62} \\approx 1.5 - 4.4294469 = -2.9294469 \\, \\mathrm{m}/\\mathrm{s}$\n- $u_R - c_R = 0.0 - \\sqrt{9.81} \\approx -3.13209195 \\, \\mathrm{m}/\\mathrm{s}$\n- $S_L = \\min(-2.9294469, -3.13209195) = -3.13209195 \\, \\mathrm{m}/\\mathrm{s}$\n- $u_L + c_L = 1.5 + \\sqrt{19.62} \\approx 1.5 + 4.4294469 = 5.9294469 \\, \\mathrm{m}/\\mathrm{s}$\n- $u_R + c_R = 0.0 + \\sqrt{9.81} \\approx 3.13209195 \\, \\mathrm{m}/\\mathrm{s}$\n- $S_R = \\max(5.9294469, 3.13209195) = 5.9294469 \\, \\mathrm{m}/\\mathrm{s}$\n\n我们需要计算HLL数值质量通量，即通量向量 $F^*$ 的第一个分量，记为 $F^*_1$。向量分量为 $U = (U_1, U_2)^{\\top}$ 和 $F = (F_1, F_2)^{\\top}$。\n第一个分量的公式是：\n$$ F^*_1 = \\frac{S_R F_1(U_L) - S_L F_1(U_R) + S_L S_R (U_1(U_R) - U_1(U_L))}{S_R - S_L} $$\n我们有以下数值：\n- $F_1(U_L) = h_L u_L = 3.0$\n- $F_1(U_R) = h_R u_R = 0.0$\n- $U_1(U_L) = h_L = 2.0$\n- $U_1(U_R) = h_R = 1.0$\n- $S_L \\approx -3.13209195$\n- $S_R \\approx 5.9294469$\n\n我们来计算 $F^*_1$ 公式中的各项：\n- $S_R - S_L \\approx 5.9294469 - (-3.13209195) = 9.06153885$\n- 分子：\n  - $S_R F_1(U_L) \\approx 5.9294469 \\times 3.0 = 17.7883407$\n  - $-S_L F_1(U_R) \\approx -(-3.13209195) \\times 0.0 = 0$\n  - $S_L S_R (U_1(U_R) - U_1(U_L)) \\approx (-3.13209195)(5.9294469)(1.0 - 2.0)$\n    $ \\approx (-18.572186) \\times (-1.0) = 18.572186$\n- 分子 $\\approx 17.7883407 + 0 + 18.572186 = 36.3605267$\n\n最后，我们计算 $F^*_1$：\n$$ F^*_1 \\approx \\frac{36.3605267}{9.06153885} \\approx 4.012646 $$\n$hu$ 的单位是 $\\mathrm{m} \\times \\mathrm{m}/\\mathrm{s} = \\mathrm{m}^2/\\mathrm{s}$。问题要求答案四舍五入到四位有效数字。\n\n$F^*_1 \\approx 4.013 \\, \\mathrm{m}^2/\\mathrm{s}$。",
            "answer": "$$\n\\boxed{4.013}\n$$"
        },
        {
            "introduction": "尽管许多物理系统是严格双曲的，但实际问题也可能导致其系数矩阵不可对角化的情况。本练习  深入探讨了这样一个非严格双曲系统，揭示了朴素方法的局限性以及采用感知特征结构方法（eigenstructure-aware approach）的必要性。通过将一个考虑了乔丹（Jordan）链结构的精确求解器与一个简化的求解器进行对比，您将更深刻地体会到偏微分方程系统的数学性质与鲁棒数值方法设计之间的内在联系。",
            "id": "3452289",
            "problem": "考虑向量场 $U(x,t) \\in \\mathbb{R}^2$ 的线性 $2 \\times 2$ 偏微分方程组，\n$$\n\\partial_t U(x,t) + A \\, \\partial_x U(x,t) = \\varepsilon \\, \\partial_{xx} U(x,t),\n$$\n其中 $A \\in \\mathbb{R}^{2 \\times 2}$ 是一个常数矩阵，$\\varepsilon > 0$ 是一个小的粘性参数。在整个问题中，取\n$$\nA = \\begin{pmatrix} a  1 \\\\ 0  a \\end{pmatrix}, \\quad a \\in \\mathbb{R}.\n$$\n该矩阵只有一个代数重数为 2 的特征值 $a$ 且不可对角化；它有一个大小为 2 的 Jordan 块。设初始数据为一个 Riemann 问题\n$$\nU(x,0) = \\begin{cases} U_L,  x  0, \\\\ U_R,  x > 0, \\end{cases}\n$$\n其中 $U_L, U_R \\in \\mathbb{R}^2$ 为常数。记 $U = (u, v)^\\top$。\n\n你的任务是基于第一性原理，为研究生高阶水平设计并比较两种 Riemann 求解器：\n\n1. 从双曲性的定义和 Jordan 分解出发，解释为什么该系统是非严格双曲的，并推导 Jordan 结构如何影响波的分解。构建一个能够感知特征结构 (eigenstructure-aware) 的粘性 Riemann 求解器，该求解器应尊重 Jordan 链结构和消失粘性 (vanishing viscosity) 的特性，并在指定的计算网格和时间 $t$ 上，为给定的 $a$、$\\varepsilon$、$U_L$、$U_R$ 生成解 $U(x,t)$。\n\n2. 构建一个忽略广义特征向量的朴素求解器 (naive solver)，该求解器将分量 $u$ 和 $v$ 均视为独立的标量对流-扩散问题。\n\n3. 使用基本的自相似分析，在指定的最终时间 $t$ 定量计算以下指标：\n   - 朴素求解器计算的 $u$ 分量相对于感知特征结构的粘性求解器结果的相对 $L^2$ 误差，该误差在空间网格上使用标准梯形求积法计算。\n   - $u$ 分量中超出其标量对流-扩散阶梯剖面的“超额质量” (excess mass)，该质量在空间域上积分，并与消失粘性极限下 Jordan 链预测的 $- t [v]$ 进行比较，其中 $[v] = v_R - v_L$。将绝对差作为浮点数报告。\n   - 第二分量的二次熵 $\\eta(v) = \\tfrac{1}{2} v^2$ 从 $t=0$ 到最终时间 $t$ 的变化量，该变化量在空间域上使用梯形求积法积分。由于粘性作用，该值应为非正数；将其作为浮点数报告。\n\n程序必须实现这两种求解器，并为以下每个测试用例（测试套件）计算上述三个量。每个用例都使用均匀的空间网格 $x \\in [-L, L]$，间距为 $\\Delta x$：\n\n- 测试用例 1 (一般情况): $a = 1$, $\\varepsilon = 10^{-2}$, $U_L = (1, 0)^\\top$, $U_R = (0, 1)^\\top$, $t = 0.5$, $L = 1.0$, $\\Delta x = 0.002$。\n- 测试用例 2 (v 分量跳跃为零的边界情况): $a = 1$, $\\varepsilon = 10^{-2}$, $U_L = (1, 0)^\\top$, $U_R = (0, 0)^\\top$, $t = 0.5$, $L = 1.0$, $\\Delta x = 0.002$。\n- 测试用例 3 (粘性极小的边缘情况): $a = 1$, $\\varepsilon = 10^{-4}$, $U_L = (0, 0)^\\top$, $U_R = (1, 1)^\\top$, $t = 0.5$, $L = 1.0$, $\\Delta x = 0.001$。\n\n你的程序应生成单行输出，其中包含三个测试用例的结果。结果是一个由方括号括起来的逗号分隔列表，每个测试用例的结果本身也是一个逗号分隔列表，包含按指定顺序排列的三个浮点数。例如，输出格式必须为：\n$$\n[\\,[r_{1,1},r_{1,2},r_{1,3}],\\,[r_{2,1},r_{2,2},r_{2,3}],\\,[r_{3,1},r_{3,2},r_{3,3}]\\,],\n$$\n打印行中不得包含空格。",
            "solution": "问题陈述经评估有效。它在科学上基于偏微分方程理论，特别是非严格双曲系统与粘性正则化。该问题是适定的、客观的，并提供了构建唯一、可验证解所需的所有必要信息。\n\n### 系统分析与双曲性\n\n控制偏微分方程组由下式给出：\n$$\n\\partial_t U(x,t) + A \\, \\partial_x U(x,t) = \\varepsilon \\, \\partial_{xx} U(x,t)\n$$\n其中 $U = (u, v)^\\top$ 且矩阵 $A$ 为：\n$$\nA = \\begin{pmatrix} a  1 \\\\ 0  a \\end{pmatrix}\n$$\n相应的一阶系统（当 $\\varepsilon = 0$ 时）的双曲性由 $A$ 的特征结构决定。特征方程为 $\\det(A - \\lambda I) = (a - \\lambda)^2 = 0$，它产生一个代数重数为 2 的单特征值 $\\lambda = a$。\n\n为求特征向量，我们求解 $(A - aI)r = 0$：\n$$\n\\begin{pmatrix} 0  1 \\\\ 0  0 \\end{pmatrix} \\begin{pmatrix} r_1 \\\\ r_2 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\n这表示 $r_2 = 0$，因此特征向量的形式为 $c \\cdot (1, 0)^\\top$，其中 $c \\in \\mathbb{R} \\setminus \\{0\\}$。特征空间是一维的，由特征向量 $r^{(1)} = (1, 0)^\\top$ 张成。由于几何重数（1）小于代数重数（2），矩阵 $A$ 不可对角化。如果守恒律方程组的系数矩阵可对角化且特征值均为实数，则该系统是双曲的。由于 $A$ 不可对角化，该系统被归类为 **非严格双曲**。\n\n由于缺少一组完备的特征向量基，需要使用 Jordan 分解。我们寻找一个广义特征向量 $r^{(2)}$，它构成一个 Jordan 链，满足 $(A - aI)r^{(2)} = r^{(1)}$。\n$$\n\\begin{pmatrix} 0  1 \\\\ 0  0 \\end{pmatrix} \\begin{pmatrix} r_{2,1} \\\\ r_{2,2} \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}\n$$\n这得出 $r_{2,2} = 1$。我们可以选择 $r^{(2)} = (0, 1)^\\top$。基向量矩阵 $P = [r^{(1)}, r^{(2)}]$ 是单位矩阵 $I$。Jordan 标准型为 $J = P^{-1}AP = A$。该系统已经处于其 Jordan 标准型。\n\n分量 $u$ 和 $v$ 是与此 Jordan 基对应的特征变量。该系统可以分量形式写为：\n$$\n\\begin{align*}\n\\partial_t u + a \\partial_x u + \\partial_x v = \\varepsilon \\partial_{xx} u \\\\\n\\partial_t v + a \\partial_x v = \\varepsilon \\partial_{xx} v\n\\end{align*}\n$$\nJordan 结构表现为单向耦合：$v$ 的方程是一个标准的标量对流-扩散方程，但它的解通过 $\\partial_x v$ 项，充当了 $u$ 方程的源项。\n\n### 1. 感知特征结构的粘性 Riemann 求解器\n\n该求解器尊重上面推导出的耦合结构。\n\n首先，我们求解 $v(x,t)$。该方程是一个标准的标量对流-扩散方程，其 Riemann 初始数据为当 $x  0$ 时 $v(x,0) = v_L$，当 $x > 0$ 时 $v(x,0) = v_R$。其解析解是众所周知的，可以通过变换到移动坐标系 $\\xi = x - at$ 来找到，这将偏微分方程简化为热方程。解为：\n$$\nv(x,t) = v_L + \\frac{[v]}{2} \\left( 1 + \\text{erf}\\left(\\frac{x-at}{\\sqrt{4\\varepsilon t}}\\right) \\right)\n$$\n其中 $[v] = v_R - v_L$ 是 $v$ 初始数据的跳跃值，$\\text{erf}$ 是误差函数。为简洁起见，我们将此精确解表示为 $v_{exact}(x,t)$。\n\n接下来，我们求解 $u(x,t)$。该方程是一个带强制项的对流-扩散方程：\n$$\n\\partial_t u + a \\partial_x u - \\varepsilon \\partial_{xx} u = -\\partial_x v_{exact}\n$$\n解 $u(x,t)$ 是齐次解 $u_h(x,t)$ 和一个特解 $u_p(x,t)$ 的和。\n齐次部分满足带有初始条件 $u(x,0)$ 的无强制项方程。其解的形式与 $v(x,t)$ 的解相同：\n$$\nu_h(x,t) = u_L + \\frac{[u]}{2} \\left( 1 + \\text{erf}\\left(\\frac{x-at}{\\sqrt{4\\varepsilon t}}\\right) \\right)\n$$\n其中 $[u] = u_R - u_L$。\n\n对于特解 $u_p(x,t)$，我们观察到，受消失粘性极限 ($\\varepsilon \\to 0$) 下解的结构启发，$u_p(x,t) = C t \\, \\partial_x v_{exact}(x,t)$ 形式的解是一个很有希望的拟设 (ansatz)。将此代入 $u$ 的偏微分方程，并利用 $v_{exact}$ 是其自身偏微分方程的解这一事实，我们发现 $C=-1$。因此，一个特解是 $u_p(x,t) = -t \\, \\partial_x v_{exact}(x,t)$。$v_{exact}$ 的导数是：\n$$\n\\partial_x v_{exact}(x,t) = \\frac{[v]}{\\sqrt{4\\pi\\varepsilon t}} e^{-\\frac{(x-at)^2}{4\\varepsilon t}}\n$$\n结合这些部分，完整的感知特征结构的解 $U_{exact} = (u_{exact}, v_{exact})^\\top$ 是：\n$$\nv_{exact}(x,t) = v_L + \\frac{[v]}{2} \\left( 1 + \\text{erf}\\left(\\frac{x-at}{\\sqrt{4\\varepsilon t}}\\right) \\right)\n$$\n$$\nu_{exact}(x,t) = \\left( u_L + \\frac{[u]}{2} \\left( 1 + \\text{erf}\\left(\\frac{x-at}{\\sqrt{4\\varepsilon t}}\\right) \\right) \\right) - \\frac{t [v]}{\\sqrt{4\\pi\\varepsilon t}} e^{-\\frac{(x-at)^2}{4\\varepsilon t}}\n$$\n\n### 2. 朴素求解器\n\n朴素求解器错误地假设系统是完全解耦的，等价于矩阵 $A$ 是一个对角矩阵 $A = aI$。这忽略了 Jordan 块中的非对角元素 1，该元素代表了广义特征向量的影响。系统被处理为：\n$$\n\\begin{align*}\n\\partial_t u + a \\partial_x u = \\varepsilon \\partial_{xx} u \\\\\n\\partial_t v + a \\partial_x v = \\varepsilon \\partial_{xx} v\n\\end{align*}\n$$\n其解表示为 $U_{naive} = (u_{naive}, v_{naive})^\\top$，由两个独立的标量行波解组成：\n$$\nu_{naive}(x,t) = u_L + \\frac{[u]}{2} \\left( 1 + \\text{erf}\\left(\\frac{x-at}{\\sqrt{4\\varepsilon t}}\\right) \\right)\n$$\n$$\nv_{naive}(x,t) = v_L + \\frac{[v]}{2} \\left( 1 + \\text{erf}\\left(\\frac{x-at}{\\sqrt{4\\varepsilon t}}\\right) \\right)\n$$\n注意，$v_{naive}(x,t) = v_{exact}(x,t)$，且 $u_{naive}(x,t) = u_h(x,t)$（来自前一节）。\n\n### 3. 差异的量化\n\n以下量在离散空间网格 $x_j$ 上计算，所有积分均使用梯形求积法。\n\n**I. 朴素求解器对 $u$ 的相对 $L^2$ 误差：**\n该度量量化了因忽略 Jordan 链耦合而产生的误差。\n$$\n\\text{Error} = \\frac{\\|u_{exact} - u_{naive}\\|_{L^2}}{\\|u_{exact}\\|_{L^2}} = \\frac{\\left( \\int_{-L}^L (u_{exact}(x,t) - u_{naive}(x,t))^2 dx \\right)^{1/2}}{\\left( \\int_{-L}^L (u_{exact}(x,t))^2 dx \\right)^{1/2}}\n$$\n差值 $u_{exact} - u_{naive}$ 正是特解部分 $-t \\, \\partial_x v_{exact}$。\n\n**II. $u$ 中的超额质量：**\n在消失粘性极限 ($\\varepsilon \\to 0$)下，双曲系统的解在 $u$ 分量中会产生一个总质量为 $-t[v]$ 的类 Dirac delta 分量。粘性项将其正则化为一个类高斯脉冲。“超额质量”衡量此脉冲的积分强度。它被定义为真实解 $u_{exact}$ 与简单行波剖面 $u_{naive}$ 之差的积分。\n$$\nM_{excess} = \\int_{-L}^L (u_{exact}(x,t) - u_{naive}(x,t)) dx\n$$\n对于无限域，理论预测为 $\\int_{-\\infty}^\\infty (u_{exact} - u_{naive}) dx = -t[v]$。我们报告在 $[-L, L]$ 上数值计算的 $M_{excess}$ 与此预测值之间的绝对差：$|M_{excess} + t[v]|$。\n\n**III. $v$ 的二次熵变：**\n对于标量对流-扩散方程，与解的凸函数相关的总“熵”会被粘性耗散。我们针对二次熵 $\\eta(v) = \\frac{1}{2} v^2$ 来衡量这一点。从 $t=0$ 到最终时刻的总熵变化为：\n$$\n\\Delta S_v = \\int_{-L}^L \\frac{1}{2} v_{exact}(x,t)^2 dx - \\int_{-L}^L \\frac{1}{2} v(x,0)^2 dx\n$$\n初始总熵 $\\int \\frac{1}{2} v(x,0)^2 dx$ 是在离散化的初始阶梯函数剖面上计算的。由于熵平衡方程中的耗散项 $-\\varepsilon \\int (\\partial_x v)^2 dx$，该量保证为非正数。\n\n解的实现涉及根据给定的 $\\Delta x$ 将空间域 $[-L, L]$ 离散化，并在每个网格点上评估 $u_{exact}$、$v_{exact}$ 和 $u_{naive}$ 的解析公式。然后使用梯形法则计算三个指定量的积分。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import erf\n\ndef solve():\n    \"\"\"\n    Implements the solution for the given systems of PDEs problem.\n    It computes three specified metrics for two solvers across three test cases.\n    \"\"\"\n    \n    test_cases = [\n        # Test case 1 (general case)\n        {'a': 1.0, 'eps': 1e-2, 'UL': np.array([1.0, 0.0]), 'UR': np.array([0.0, 1.0]), 't': 0.5, 'L': 1.0, 'dx': 0.002},\n        # Test case 2 (boundary case with zero jump in v)\n        {'a': 1.0, 'eps': 1e-2, 'UL': np.array([1.0, 0.0]), 'UR': np.array([0.0, 0.0]), 't': 0.5, 'L': 1.0, 'dx': 0.002},\n        # Test case 3 (edge case with very small viscosity)\n        {'a': 1.0, 'eps': 1e-4, 'UL': np.array([0.0, 0.0]), 'UR': np.array([1.0, 1.0]), 't': 0.5, 'L': 1.0, 'dx': 0.001},\n    ]\n\n    all_results = []\n\n    for params in test_cases:\n        a = params['a']\n        eps = params['eps']\n        uL, vL = params['UL']\n        uR, vR = params['UR']\n        t = params['t']\n        L = params['L']\n        dx = params['dx']\n\n        # Setup computational grid\n        num_points = int(2 * L / dx) + 1\n        x = np.linspace(-L, L, num_points)\n\n        # Calculate jumps\n        du = uR - uL\n        dv = vR - vL\n\n        # Common terms for the analytical solutions\n        # Prevent division by zero at t=0, although problem specifies t > 0\n        if t == 0: \n            # This case is not in the test suite but is a good practice\n            v_exact = np.where(x  0, vL, vR)\n            u_naive = np.where(x  0, uL, uR)\n            u_exact = u_naive\n            correction_term = np.zeros_like(x)\n        else:\n            sqrt_4_eps_t = np.sqrt(4 * eps * t)\n            arg_erf = (x - a * t) / sqrt_4_eps_t\n            \n            # --- Eigenstructure-aware and Naive Solver Solutions ---\n            \n            # v_exact solution (same for both solvers)\n            v_exact = vL + (dv / 2.0) * (1.0 + erf(arg_erf))\n            \n            # u_naive solution (scalar convection-diffusion)\n            u_naive = uL + (du / 2.0) * (1.0 + erf(arg_erf))\n\n            # Correction term for u_exact due to Jordan structure\n            gauss_term = np.exp(-arg_erf**2) / np.sqrt(np.pi)\n            correction_term = - (t * dv) / sqrt_4_eps_t * gauss_term\n            \n            # u_exact solution (eigenstructure-aware)\n            u_exact = u_naive + correction_term\n            \n        # --- Quantification of Differences ---\n\n        # 1. Relative L2 error of the naive u-component\n        # Numerator: ||u_exact - u_naive||^2 = ||correction_term||^2\n        # Denominator: ||u_exact||^2\n        norm_err_sq = np.trapz(correction_term**2, x)\n        norm_uexact_sq = np.trapz(u_exact**2, x)\n        \n        # Avoid division by zero if u_exact is zero everywhere\n        if norm_uexact_sq  1e-15:\n            rel_l2_error = 0.0\n        else:\n            rel_l2_error = np.sqrt(norm_err_sq / norm_uexact_sq)\n\n        # 2. Excess mass in u\n        # Integral of the difference u_exact - u_naive\n        excess_mass_numerical = np.trapz(correction_term, x)\n        # Theoretical prediction for infinite domain\n        excess_mass_theoretical = -t * dv\n        # Absolute difference between numerical and theoretical\n        excess_mass_diff = np.abs(excess_mass_numerical - excess_mass_theoretical)\n\n        # 3. Change in quadratic entropy of v\n        # Entropy at final time t\n        entropy_t = 0.5 * np.trapz(v_exact**2, x)\n        # Entropy at initial time t=0\n        v_initial = np.where(x  0, vL, vR)\n        entropy_0 = 0.5 * np.trapz(v_initial**2, x)\n        # Change in entropy\n        entropy_change = entropy_t - entropy_0\n        \n        case_results = [rel_l2_error, excess_mass_diff, entropy_change]\n        # Format results for this case into a string '[r1,r2,r3]'\n        all_results.append(f\"[{','.join(f'{r:.12f}' for r in case_results)}]\")\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(all_results)}]\")\n\nsolve()\n```"
        }
    ]
}