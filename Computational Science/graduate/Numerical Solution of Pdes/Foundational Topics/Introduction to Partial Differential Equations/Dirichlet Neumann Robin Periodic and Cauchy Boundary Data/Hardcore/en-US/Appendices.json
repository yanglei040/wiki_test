{
    "hands_on_practices": [
        {
            "introduction": "Before attempting to solve a partial differential equation, it is crucial to determine if a solution even exists for the given data. For problems involving Neumann boundary conditions, this question leads to a fundamental compatibility condition. This exercise guides you through deriving this condition for the Poisson equation, starting from the divergence theorem, and then applying it to a concrete scenario to ensure the well-posedness of a hypothetical problem. ",
            "id": "3378558",
            "problem": "Let $\\Omega \\subset \\mathbb{R}^{2}$ be a bounded domain with $C^{1}$ boundary $\\partial \\Omega$, and let $u:\\overline{\\Omega}\\to \\mathbb{R}$ solve the Poisson Partial Differential Equation (PDE) with Neumann boundary condition\n$$\n\\Delta u = f \\quad \\text{in } \\Omega, \n\\qquad \n\\frac{\\partial u}{\\partial n} = g \\quad \\text{on } \\partial \\Omega,\n$$\nwhere $f \\in L^{1}(\\Omega)$ and $g \\in L^{1}(\\partial \\Omega)$ are given data, and $\\frac{\\partial u}{\\partial n}$ denotes the outward normal derivative. Starting only from the divergence theorem and the definition of the Laplacian as $\\Delta u = \\nabla \\cdot (\\nabla u)$, derive the necessary compatibility condition relating $f$ and $g$ for the existence of a solution.\n\nThen, to connect with numerical practice where solvability is often enforced by shifting the right-hand side by a constant, consider the special case in which $\\Omega$ is the unit disk in $\\mathbb{R}^{2}$, with boundary $\\partial \\Omega$ the unit circle. Suppose the data are of the form\n$$\nf(r,\\theta) = r^{2} + c, \n\\qquad \ng(\\theta) = 3 + 2\\sin(\\theta),\n$$\nwritten in polar coordinates $(r,\\theta)$, with $c \\in \\mathbb{R}$ a constant to be chosen to satisfy the derived compatibility condition. Determine the unique value of $c$ that enforces the compatibility condition on the unit disk. Express your final answer as an exact rational number, with no rounding and no units.",
            "solution": "The problem is divided into two parts. First, we must derive the necessary compatibility condition for the existence of a solution to the Poisson equation with Neumann boundary conditions. Second, we must apply this condition to a specific case on the unit disk to determine the value of a constant $c$.\n\nPart 1: Derivation of the Compatibility Condition\n\nWe are given the Poisson equation with a Neumann boundary condition on a bounded domain $\\Omega \\subset \\mathbb{R}^{2}$ with a $C^{1}$ boundary $\\partial \\Omega$:\n$$\n\\Delta u = f \\quad \\text{in } \\Omega,\n$$\n$$\n\\frac{\\partial u}{\\partial n} = g \\quad \\text{on } \\partial \\Omega.\n$$\nHere, $\\frac{\\partial u}{\\partial n}$ is the outward normal derivative of the solution $u$. The problem requires us to start from the definition of the Laplacian as the divergence of the gradient, $\\Delta u = \\nabla \\cdot (\\nabla u)$, and the divergence theorem.\n\nWe begin by integrating the Poisson equation over the domain $\\Omega$:\n$$\n\\int_{\\Omega} \\Delta u \\, dA = \\int_{\\Omega} f \\, dA.\n$$\nUsing the given definition of the Laplacian, we substitute $\\Delta u = \\nabla \\cdot (\\nabla u)$ into the left-hand side of the equation:\n$$\n\\int_{\\Omega} \\nabla \\cdot (\\nabla u) \\, dA = \\int_{\\Omega} f \\, dA.\n$$\nNow, we apply the divergence theorem to the left-hand side. For a vector field $\\mathbf{F}$ on $\\Omega$, the divergence theorem states:\n$$\n\\int_{\\Omega} \\nabla \\cdot \\mathbf{F} \\, dA = \\oint_{\\partial \\Omega} \\mathbf{F} \\cdot \\mathbf{n} \\, dS,\n$$\nwhere $\\mathbf{n}$ is the outward unit normal vector to the boundary $\\partial \\Omega$ and $dS$ is the element of arc length. In our case, the vector field is the gradient of the solution, $\\mathbf{F} = \\nabla u$.\n\nApplying the theorem, we get:\n$$\n\\int_{\\Omega} \\nabla \\cdot (\\nabla u) \\, dA = \\oint_{\\partial \\Omega} (\\nabla u) \\cdot \\mathbf{n} \\, dS.\n$$\nThe term $(\\nabla u) \\cdot \\mathbf{n}$ is the definition of the directional derivative of $u$ in the direction of the outward normal vector $\\mathbf{n}$, which is precisely the outward normal derivative, $\\frac{\\partial u}{\\partial n}$. Therefore, we can write:\n$$\n\\oint_{\\partial \\Omega} (\\nabla u) \\cdot \\mathbf{n} \\, dS = \\oint_{\\partial \\Omega} \\frac{\\partial u}{\\partial n} \\, dS.\n$$\nWe are given the Neumann boundary condition $\\frac{\\partial u}{\\partial n} = g$ on $\\partial \\Omega$. Substituting this into the boundary integral gives:\n$$\n\\oint_{\\partial \\Omega} \\frac{\\partial u}{\\partial n} \\, dS = \\oint_{\\partial \\Omega} g \\, dS.\n$$\nBy combining these steps, we have equated the integral of $\\Delta u$ over $\\Omega$ with the integral of $g$ over $\\partial \\Omega$. Recalling our initial integrated PDE, we arrive at the necessary compatibility condition:\n$$\n\\int_{\\Omega} f \\, dA = \\oint_{\\partial \\Omega} g \\, dS.\n$$\nThis condition represents a physical balance: the total source $f$ within the domain must equal the total flux $g$ across the boundary for a steady-state solution to exist.\n\nPart 2: Application to a Specific Case\n\nWe are asked to find the value of a constant $c$ that enforces this compatibility condition for a problem defined on the unit disk in $\\mathbb{R}^{2}$.\nThe domain $\\Omega$ is the unit disk, which in polar coordinates $(r, \\theta)$ is described by $0 \\le r \\le 1$ and $0 \\le \\theta  2\\pi$. The boundary $\\partial \\Omega$ is the unit circle, where $r=1$.\n\nThe given data are:\n$$\nf(r,\\theta) = r^{2} + c\n$$\n$$\ng(\\theta) = 3 + 2\\sin(\\theta)\n$$\nWe must evaluate the two integrals in the compatibility condition.\n\nFirst, we compute the left-hand side, $\\int_{\\Omega} f \\, dA$. In polar coordinates, the area element is $dA = r \\, dr \\, d\\theta$.\nThe integral is:\n$$\n\\int_{\\Omega} f \\, dA = \\int_{0}^{2\\pi} \\int_{0}^{1} (r^{2} + c) \\, r \\, dr \\, d\\theta.\n$$\nWe first evaluate the inner integral with respect to $r$:\n$$\n\\int_{0}^{1} (r^{2} + c) r \\, dr = \\int_{0}^{1} (r^{3} + cr) \\, dr = \\left[ \\frac{r^{4}}{4} + \\frac{cr^{2}}{2} \\right]_{0}^{1} = \\left(\\frac{1^{4}}{4} + \\frac{c \\cdot 1^{2}}{2}\\right) - (0) = \\frac{1}{4} + \\frac{c}{2}.\n$$\nNow, we integrate this result with respect to $\\theta$:\n$$\n\\int_{0}^{2\\pi} \\left(\\frac{1}{4} + \\frac{c}{2}\\right) d\\theta = \\left(\\frac{1}{4} + \\frac{c}{2}\\right) \\int_{0}^{2\\pi} d\\theta = \\left(\\frac{1}{4} + \\frac{c}{2}\\right) [\\theta]_{0}^{2\\pi} = \\left(\\frac{1}{4} + \\frac{c}{2}\\right) (2\\pi) = \\frac{\\pi}{2} + c\\pi.\n$$\n\nNext, we compute the right-hand side, $\\oint_{\\partial \\Omega} g \\, dS$. On the boundary $\\partial \\Omega$ (the unit circle, $r=1$), the arc length element is $dS = 1 \\cdot d\\theta = d\\theta$.\nThe integral is:\n$$\n\\oint_{\\partial \\Omega} g \\, dS = \\int_{0}^{2\\pi} g(\\theta) \\, d\\theta = \\int_{0}^{2\\pi} (3 + 2\\sin(\\theta)) \\, d\\theta.\n$$\nWe evaluate this integral:\n$$\n\\int_{0}^{2\\pi} (3 + 2\\sin(\\theta)) \\, d\\theta = \\int_{0}^{2\\pi} 3 \\, d\\theta + \\int_{0}^{2\\pi} 2\\sin(\\theta) \\, d\\theta.\n$$\nThe first term is:\n$$\n\\int_{0}^{2\\pi} 3 \\, d\\theta = [3\\theta]_{0}^{2\\pi} = 3(2\\pi) - 3(0) = 6\\pi.\n$$\nThe second term is:\n$$\n\\int_{0}^{2\\pi} 2\\sin(\\theta) \\, d\\theta = 2 [-\\cos(\\theta)]_{0}^{2\\pi} = -2 (\\cos(2\\pi) - \\cos(0)) = -2 (1 - 1) = 0.\n$$\nSo, the right-hand side evaluates to $6\\pi + 0 = 6\\pi$.\n\nFinally, we enforce the compatibility condition by equating the two results:\n$$\n\\frac{\\pi}{2} + c\\pi = 6\\pi.\n$$\nSince $\\pi \\neq 0$, we can divide the entire equation by $\\pi$:\n$$\n\\frac{1}{2} + c = 6.\n$$\nSolving for $c$, we find:\n$$\nc = 6 - \\frac{1}{2} = \\frac{12}{2} - \\frac{1}{2} = \\frac{11}{2}.\n$$\nThus, the unique value of the constant $c$ that ensures the existence of a solution is $\\frac{11}{2}$.",
            "answer": "$$\\boxed{\\frac{11}{2}}$$"
        },
        {
            "introduction": "Periodic boundary conditions, common in models of crystalline structures or idealized fluid flows, lend themselves to powerful solution techniques based on Fourier analysis. By transforming the problem into the frequency domain, the differential operator becomes diagonal, making the system trivial to solve, provided a solvability condition is met. This practice will allow you to explore this elegant method, derive the eigenvalues of the discrete Laplacian, and understand the solvability condition from a spectral viewpoint. ",
            "id": "3378531",
            "problem": "Consider the linear boundary value problem for the scalar field $u$ on a periodic one-dimensional domain of length $L0$:\n$$-u''(x)=f(x), \\quad x\\in[0,L],$$\nwith periodic boundary conditions $u(x+L)=u(x)$ and $u'(x+L)=u'(x)$. Assume $f$ is square-integrable with period $L$ and $u$ is sought within the class of square-integrable periodic functions.\n\nDiscretize the domain with a uniform grid of $N\\geq 3$ points, $x_{j}=jh$ for $j=0,1,\\dots,N-1$, where $h=L/N$. Use the standard second-order centered finite-difference approximation of the second derivative to obtain the periodic linear system\n$$\\frac{2u_{j}-u_{j+1}-u_{j-1}}{h^{2}}=f_{j}, \\quad j=0,1,\\dots,N-1,$$\nwith periodic indexing $u_{N}\\equiv u_{0}$ and $u_{-1}\\equiv u_{N-1}$, where $f_{j}=f(x_{j})$.\n\nDefine the Discrete Fourier Transform (DFT) and its inverse for grid functions $v=\\{v_{j}\\}_{j=0}^{N-1}$ by\n$$\\widehat{v}_{k}=\\sum_{j=0}^{N-1} v_{j}\\,\\exp\\!\\left(-i\\frac{2\\pi jk}{N}\\right), \\quad k=0,1,\\dots,N-1,$$\nand\n$$v_{j}=\\frac{1}{N}\\sum_{k=0}^{N-1}\\widehat{v}_{k}\\,\\exp\\!\\left(i\\frac{2\\pi jk}{N}\\right), \\quad j=0,1,\\dots,N-1.$$\n\nStarting from the definitions of the finite-difference operator and the Discrete Fourier Transform, do the following:\n- Derive the diagonal action of the discrete operator on Fourier modes and identify the associated eigenvalues.\n- State the solvability condition for the periodic discrete problem in terms of the DFT of $f$, and explain its continuous analogue for the original boundary value problem on $[0,L]$.\n- Construct the mean-zero solution by specifying the treatment of the zero-frequency component.\n\nYour final task is to give a closed-form analytic expression (in terms of $N$, $h$, and the DFT coefficients $\\widehat{f}_{k}$) for the mean-zero discrete solution $u_{j}$, $j=0,1,\\dots,N-1$, obtained via the inverse DFT. Express the final answer as a single analytic expression. No numerical evaluation or rounding is required.",
            "solution": "The analysis of the problem shall proceed in a sequential and logical manner, starting from the diagonalization of the discrete operator, identifying the solvability condition, and finally constructing the unique mean-zero solution.\n\nThe given linear system is the discrete version of the one-dimensional periodic Poisson equation, $-u''(x)=f(x)$. The finite difference approximation for the negative second derivative at each grid point $x_j=jh$ is\n$$ (A\\mathbf{u})_j = \\frac{-u_{j-1} + 2u_j - u_{j+1}}{h^2} = f_j, \\quad j=0,1,\\dots,N-1. $$\nThe vector $\\mathbf{u}$ represents the grid function $\\{u_j\\}_{j=0}^{N-1}$, and the operator $A$ is represented by a circulant matrix due to the periodic indexing $u_{-1}\\equiv u_{N-1}$ and $u_N\\equiv u_0$. The canonical basis for diagonalizing any linear, shift-invariant operator on a periodic domain (i.e., any circulant matrix) is the set of discrete Fourier modes. A Fourier mode for a given wavenumber $k \\in \\{0, 1, \\dots, N-1\\}$ is a vector $\\mathbf{w}^{(k)}$ with components\n$$ w_j^{(k)} = \\exp\\left(i\\frac{2\\pi jk}{N}\\right), \\quad j=0, 1, \\dots, N-1. $$\nWe apply the discrete operator $A$ to this mode to find its corresponding eigenvalue $\\lambda_k$.\n$$ (A\\mathbf{w}^{(k)})_j = \\frac{1}{h^2} \\left[ -w_{j-1}^{(k)} + 2w_j^{(k)} - w_{j+1}^{(k)} \\right] $$\n$$ = \\frac{1}{h^2} \\left[ -\\exp\\left(i\\frac{2\\pi (j-1)k}{N}\\right) + 2\\exp\\left(i\\frac{2\\pi jk}{N}\\right) - \\exp\\left(i\\frac{2\\pi (j+1)k}{N}\\right) \\right] $$\nFactoring out the term $w_j^{(k)} = \\exp\\left(i\\frac{2\\pi jk}{N}\\right)$:\n$$ (A\\mathbf{w}^{(k)})_j = \\frac{1}{h^2} w_j^{(k)} \\left[ -\\exp\\left(-i\\frac{2\\pi k}{N}\\right) + 2 - \\exp\\left(i\\frac{2\\pi k}{N}\\right) \\right] $$\nUsing the identity $2\\cos(\\theta) = \\exp(i\\theta) + \\exp(-i\\theta)$, the expression in the brackets simplifies:\n$$ (A\\mathbf{w}^{(k)})_j = \\frac{1}{h^2} w_j^{(k)} \\left[ 2 - 2\\cos\\left(\\frac{2\\pi k}{N}\\right) \\right] $$\nEmploying the trigonometric identity $1 - \\cos(2\\theta) = 2\\sin^2(\\theta)$, we obtain:\n$$ (A\\mathbf{w}^{(k)})_j = \\frac{2}{h^2} w_j^{(k)} \\left[ 2\\sin^2\\left(\\frac{\\pi k}{N}\\right) \\right] = \\left[ \\frac{4}{h^2}\\sin^2\\left(\\frac{\\pi k}{N}\\right) \\right] w_j^{(k)} $$\nThus, the discrete Fourier modes are indeed the eigenvectors of the discrete operator $A$, and the associated eigenvalues are\n$$ \\lambda_k = \\frac{4}{h^2}\\sin^2\\left(\\frac{\\pi k}{N}\\right), \\quad k=0, 1, \\dots, N-1. $$\n\nTo solve the system $A\\mathbf{u}=\\mathbf{f}$, we transform the equation into the Fourier domain using the Discrete Fourier Transform (DFT). The DFT of a vector $\\mathbf{v}$ yields coefficients $\\widehat{v}_k$. Due to the linearity of the DFT and the fact that the Fourier modes are eigenvectors of $A$, the operation $A\\mathbf{u}$ becomes a simple multiplication in Fourier space:\n$$ \\widehat{(A\\mathbf{u})}_k = \\lambda_k \\widehat{u}_k. $$\nThe full system in the Fourier domain is therefore a set of $N$ decoupled scalar equations:\n$$ \\lambda_k \\widehat{u}_k = \\widehat{f}_k, \\quad k=0, 1, \\dots, N-1. $$\nThe solution for each Fourier coefficient $\\widehat{u}_k$ is found by division: $\\widehat{u}_k = \\widehat{f}_k / \\lambda_k$. This division is possible only if $\\lambda_k \\neq 0$.\n\nLet us examine the eigenvalues $\\lambda_k$. For $k \\in \\{1, 2, \\dots, N-1\\}$, the argument of the sine function, $\\frac{\\pi k}{N}$, lies in the interval $(0, \\pi)$, for which $\\sin(\\frac{\\pi k}{N}) \\neq 0$. Hence, $\\lambda_k > 0$ for $k \\neq 0$.\nHowever, for the zero-frequency mode $k=0$:\n$$ \\lambda_0 = \\frac{4}{h^2}\\sin^2(0) = 0. $$\nThe equation for the $k=0$ mode becomes $0 \\cdot \\widehat{u}_0 = \\widehat{f}_0$.\nFor this algebraic equation to have a solution for $\\widehat{u}_0$, it is necessary that the right-hand side be zero. This gives the **solvability condition** for the discrete problem:\n$$ \\widehat{f}_0 = 0. $$\nBy definition of the DFT, $\\widehat{f}_0 = \\sum_{j=0}^{N-1} f_j$. This means the sum of the values of the source function over the grid must be zero. This is the discrete analogue of the compatibility condition for the continuous problem.\n\nFor the original boundary value problem, $-u''(x) = f(x)$, we can integrate both sides over the domain $[0,L]$:\n$$ -\\int_0^L u''(x) \\,dx = \\int_0^L f(x) \\,dx. $$\nThe fundamental theorem of calculus gives $-\\left[ u'(x) \\right]_0^L = - (u'(L) - u'(0))$. Due to the periodic boundary condition $u'(L)=u'(0)$, the left-hand side vanishes. This yields the continuous solvability condition:\n$$ \\int_0^L f(x) \\,dx = 0. $$\nThis condition states that the average value of the forcing function $f(x)$ over the periodic domain must be zero. The discrete condition $\\sum f_j = 0$ is its direct numerical counterpart.\n\nIf the condition $\\widehat{f}_0 = 0$ is satisfied, the equation for $k=0$ becomes $0 \\cdot \\widehat{u}_0 = 0$, which is satisfied by any value of $\\widehat{u}_0$. This reflects the fact that if $u(x)$ is a solution to the continuous problem, then $u(x)+C$ is also a solution for any arbitrary constant $C$. The coefficient $\\widehat{u}_0 = \\sum_{j=0}^{N-1} u_j$ is proportional to the mean value of the discrete solution. To obtain a unique solution, we must fix this constant. The problem demands the **mean-zero solution**, which corresponds to setting the average value of $u_j$ to zero:\n$$ \\frac{1}{N}\\sum_{j=0}^{N-1} u_j = 0 \\implies \\sum_{j=0}^{N-1} u_j = 0 \\implies \\widehat{u}_0 = 0. $$\nWith this choice, all Fourier coefficients of the solution are uniquely determined:\n$$ \\widehat{u}_k = \\begin{cases} 0  k=0 \\\\ \\frac{\\widehat{f}_k}{\\lambda_k}  k=1, 2, \\dots, N-1 \\end{cases} $$\nSubstituting the expression for $\\lambda_k$:\n$$ \\widehat{u}_k = \\frac{\\widehat{f}_k h^2}{4\\sin^2\\left(\\frac{\\pi k}{N}\\right)}, \\quad k=1, 2, \\dots, N-1. $$\n\nFinally, we reconstruct the solution in physical space, $\\{u_j\\}$, by applying the inverse DFT to the coefficients $\\{\\widehat{u}_k\\}$:\n$$ u_j = \\frac{1}{N} \\sum_{k=0}^{N-1} \\widehat{u}_k \\exp\\left(i\\frac{2\\pi jk}{N}\\right). $$\nWe separate the $k=0$ term from the summation:\n$$ u_j = \\frac{1}{N} \\left( \\widehat{u}_0 \\exp(0) + \\sum_{k=1}^{N-1} \\widehat{u}_k \\exp\\left(i\\frac{2\\pi jk}{N}\\right) \\right). $$\nSubstituting $\\widehat{u}_0=0$ and the expressions for the other $\\widehat{u}_k$ yields the final closed-form expression for the mean-zero solution:\n$$ u_j = \\frac{1}{N} \\sum_{k=1}^{N-1} \\frac{\\widehat{f}_k h^2}{4\\sin^2\\left(\\frac{\\pi k}{N}\\right)} \\exp\\left(i\\frac{2\\pi jk}{N}\\right). $$\nThis can be written more tidily as:\n$$ u_j = \\frac{h^2}{4N} \\sum_{k=1}^{N-1} \\frac{\\widehat{f}_k}{\\sin^2\\left(\\frac{\\pi k}{N}\\right)} \\exp\\left(i\\frac{2\\pi jk}{N}\\right). $$\nThis expression provides the unique, mean-zero solution at each grid point $j$ in terms of the DFT of the forcing function $f$.",
            "answer": "$$\\boxed{\\frac{h^{2}}{4N} \\sum_{k=1}^{N-1} \\frac{\\widehat{f}_{k}}{\\sin^{2}\\left(\\frac{\\pi k}{N}\\right)} \\exp\\left(i\\frac{2\\pi jk}{N}\\right)}$$"
        },
        {
            "introduction": "The Robin boundary condition, $k\\,\\partial_n u + \\alpha\\,u = g$, is versatile but can introduce subtle instabilities depending on the sign of the coefficient $\\alpha$. This computational exercise delves into the critical case where $\\alpha  0$, which can compromise the coercivity of the underlying mathematical formulation and lead to non-physical numerical solutions. Through spectral analysis of the finite element operator, you will diagnose this instability and implement regularization strategies to restore well-posedness to the discrete system. ",
            "id": "3378543",
            "problem": "Consider the one-dimensional, steady diffusion model problem posed on the closed interval $[0,1]$ with a strictly positive constant diffusivity $k0$:\nfind a function $u:[0,1]\\to\\mathbb{R}$ such that\n$-\\,\\dfrac{d}{dx}\\!\\left(k\\,\\dfrac{du}{dx}\\right)=f$ in $(0,1)$, with a Dirichlet boundary condition $u(0)=0$ and a Robin boundary condition at $x=1$ given by $k\\,\\partial_n u(1)+\\alpha\\,u(1)=g$, where $\\partial_n u(1)=u'(1)$.\nAssume $f\\equiv 0$ and $g\\equiv 0$ so that the focus is exclusively on the homogeneous operator associated with the Robin boundary condition. We are interested in the regime $\\alpha0$, which is known to potentially compromise coercivity and well-posedness, and in quantifying the numerical manifestation (discrete spectral instability) and the effect of regularization strategies.\n\nStart from the variational formulation: find $u$ in the Sobolev space $H^1(0,1)$ with the essential boundary condition $u(0)=0$ such that for all test functions $v$ in the same space with $v(0)=0$,\n$\\displaystyle a(u,v) = \\int_0^1 k\\,u'(x)\\,v'(x)\\,dx + \\alpha\\,u(1)\\,v(1) = 0$.\nDiscretize this problem using the standard Galerkin finite element method with continuous, piecewise-linear basis functions on a uniform mesh of $N$ elements of size $h=1/N$.\nLet the unknown vector collect the nodal values at nodes $x_i=i\\,h$ for $i=1,2,\\dots,N$ (the node $i=0$ is eliminated by the essential boundary condition $u(0)=0$).\nThe assembled stiffness matrix $K\\in\\mathbb{R}^{N\\times N}$ has the standard tridiagonal form for piecewise-linear basis functions on a uniform mesh with constant $k$, namely\n$K_{ii}=\\dfrac{2k}{h}$ for $i=1,2,\\dots,N-1$, $K_{NN}=\\dfrac{k}{h}$, and $K_{i,i+1}=K_{i+1,i}=-\\dfrac{k}{h}$ for $i=1,2,\\dots,N-1$.\nThe Robin boundary term contributes an additional rank-one matrix at the last node, leading to the discrete operator\n$A = K + \\alpha\\,e_N e_N^{\\mathsf{T}}$, where $e_N$ is the $N$-th Euclidean basis vector in $\\mathbb{R}^N$.\n\nYour tasks are:\n- Using only the definitions above and the standard properties of the Sobolev space $H^1(0,1)$ and continuous, piecewise-linear finite elements, explain why $\\alpha0$ can break coercivity of the continuous bilinear form and how this manifests in the discrete system as the loss of positive definiteness of $A$.\n- For the given discretization, perform a spectral analysis of $A$ by computing all eigenvalues numerically and determining the smallest eigenvalue, and whether the matrix is symmetric positive definite (all eigenvalues strictly positive).\n- Devise and analyze two regularization strategies, both consistent with a variational viewpoint, that restore discrete coercivity:\n  1) Tikhonov regularization by adding $\\gamma\\,I$ to the operator with a fixed $\\gamma0$,\n  2) boundary stabilization by adding $\\tau\\,e_N e_N^{\\mathsf{T}}$ to the operator with a fixed $\\tau0$.\n  Quantify their effects on the spectrum in each test case.\n\nYou must implement the above using the following finite element assembly rules and parameter choices to build a test suite:\n- Mesh size $h=1/N$ with uniform nodes $x_i=i\\,h$ for $i=0,1,\\dots,N$.\n- Stiffness matrix entries as stated: $K_{ii}=\\dfrac{2k}{h}$ for $i=1,\\dots,N-1$, $K_{NN}=\\dfrac{k}{h}$, and $K_{i,i+1}=K_{i+1,i}=-\\dfrac{k}{h}$ for $i=1,\\dots,N-1$.\n- Robin augmentation $A=K+\\alpha\\,e_N e_N^{\\mathsf{T}}$.\n- Tikhonov parameter $\\gamma=200.0$ and boundary stabilization parameter $\\tau=100.0$.\n\nUse the following four test cases $(N,k,\\alpha)$:\n- Case A (happy path, small negative $\\alpha$): $(N,k,\\alpha)=(50,1.0,-0.2)$.\n- Case B (strongly negative $\\alpha$ leading to instability): $(N,k,\\alpha)=(50,1.0,-60.0)$.\n- Case C (finer mesh with moderately negative $\\alpha$): $(N,k,\\alpha)=(200,1.0,-5.0)$.\n- Case D (borderline natural boundary at $x=1$): $(N,k,\\alpha)=(20,1.0,0.0)$.\n\nFor each case, compute and report the following six quantities:\n- the smallest eigenvalue of $A$,\n- whether $A$ is symmetric positive definite (boolean),\n- the smallest eigenvalue of $A+\\gamma\\,I$,\n- whether $A+\\gamma\\,I$ is symmetric positive definite (boolean),\n- the smallest eigenvalue of $A+\\tau\\,e_N e_N^{\\mathsf{T}}$,\n- whether $A+\\tau\\,e_N e_N^{\\mathsf{T}}$ is symmetric positive definite (boolean).\n\nYour program should produce a single line of output containing these results in order for the four cases A, B, C, D, with each case contributing its six values in the order specified above. Aggregate them into a single, comma-separated list enclosed in square brackets, for example\n$[a_1,b_1,c_1,d_1,e_1,f_1,a_2,b_2,c_2,d_2,e_2,f_2,a_3,b_3,c_3,d_3,e_3,f_3,a_4,b_4,c_4,d_4,e_4,f_4]$,\nwhere $a_j,c_j,e_j$ are floats and $b_j,d_j,f_j$ are booleans. There are no physical units in this problem, and no angles or percentages are involved. You may round floats to six decimal places in the output if desired, but rounding is not required by the problem specification as long as the values are numerically accurate for the given computations.",
            "solution": "We begin from the variational formulation for the homogeneous problem with $f\\equiv 0$ and $g\\equiv 0$. The bilinear form is\n$a(u,v)=\\int_0^1 k\\,u'(x)\\,v'(x)\\,dx + \\alpha\\,u(1)\\,v(1)$\non the space $V=\\{v\\in H^1(0,1):v(0)=0\\}$.\nBy the Lax–Milgram theorem (a fundamental result guaranteeing existence and uniqueness for linear elliptic problems), well-posedness is ensured if $a(\\cdot,\\cdot)$ is continuous and coercive on $V$. Continuity is clear by the Cauchy–Schwarz inequality and the trace continuity $|v(1)|\\le C_{\\mathrm{tr}}\\|v\\|_{H^1(0,1)}$. Coercivity requires the existence of $c0$ such that $a(v,v)\\ge c\\,\\|v\\|_{H^1(0,1)}^2$ for all $v\\in V$.\n\nIn one spatial dimension with $v(0)=0$, the trace at $x=1$ can be bounded directly from the fundamental theorem of calculus and the Cauchy–Schwarz inequality:\n$v(1)=\\int_0^1 v'(x)\\,dx$, hence $|v(1)|\\le \\int_0^1 |v'(x)|\\,dx \\le \\sqrt{1}\\,\\|v'\\|_{L^2(0,1)}=\\|v'\\|_{L^2(0,1)}$.\nTherefore $|v(1)|^2\\le \\|v'\\|_{L^2(0,1)}^2$. Using this, we have for any $v\\in V$,\n$a(v,v)=k\\,\\|v'\\|_{L^2(0,1)}^2 + \\alpha\\,|v(1)|^2 \\ge \\left(k+\\alpha\\right)\\,\\|v'\\|_{L^2(0,1)}^2$.\nThus $a(\\cdot,\\cdot)$ is coercive provided $k+\\alpha0$, that is, provided $\\alpha-k$. When $\\alpha0$ with sufficiently large magnitude such that $\\alpha\\le -k$, coercivity fails. This explains at a fundamental level why negative $\\alpha$ can break well-posedness of the continuous problem.\n\nWe now discretize by the standard finite element method with continuous, piecewise-linear basis functions on a uniform mesh of $N$ elements of size $h=1/N$ and with the essential boundary condition $u(0)=0$ enforced by eliminating the first node. The discrete space $V_h\\subset V$ consists of grid functions $u_h$ determined by their values at the nodes $x_i=i\\,h$ for $i=1,2,\\dots,N$. The global stiffness matrix $K\\in\\mathbb{R}^{N\\times N}$ assembled from the local element matrices $k/h\\begin{bmatrix} 1-1\\\\-11\\end{bmatrix}$ has the entries\n$K_{ii}=\\dfrac{2k}{h}$ for $i=1,2,\\dots,N-1$, $K_{NN}=\\dfrac{k}{h}$, and $K_{i,i+1}=K_{i+1,i}=-\\dfrac{k}{h}$ for $i=1,2,\\dots,N-1$.\nThe Robin boundary term contributes $\\alpha\\,u_h(1)\\,v_h(1)$ which in the nodal basis is exactly $\\alpha$ added to the last diagonal entry. Thus the discrete operator is\n$A=K+\\alpha\\,e_N e_N^{\\mathsf{T}}$.\nThis matrix is symmetric by construction.\n\nThe discrete energy identity mirrors the continuous energy: for any vector $x\\in\\mathbb{R}^N$ representing $u_h$ with $x_i=u_h(x_i)$ and $x_0=0$, one has\n$x^{\\mathsf{T}}Kx = \\sum_{i=1}^N \\int_{x_{i-1}}^{x_i} k\\,(u_h')^2\\,dx = \\sum_{i=1}^N k\\,h\\left(\\frac{x_i-x_{i-1}}{h}\\right)^2 = \\frac{k}{h}\\sum_{i=1}^N (x_i-x_{i-1})^2$.\nTherefore\n$x^{\\mathsf{T}}Ax = \\frac{k}{h}\\sum_{i=1}^N (x_i-x_{i-1})^2 + \\alpha\\,x_N^2$.\nA discrete version of the trace inequality follows from the Cauchy–Schwarz inequality:\n$x_N=\\sum_{i=1}^N (x_i-x_{i-1})$ implies $x_N^2\\le N \\sum_{i=1}^N (x_i-x_{i-1})^2 = \\frac{1}{h}\\sum_{i=1}^N (x_i-x_{i-1})^2$.\nConsequently,\n$x^{\\mathsf{T}}Ax \\ge \\left(\\frac{k}{h}+\\frac{\\alpha}{h}\\right)\\sum_{i=1}^N (x_i-x_{i-1})^2 = \\frac{k+\\alpha}{h}\\sum_{i=1}^N (x_i-x_{i-1})^2$.\nThus, exactly as in the continuous case, discrete coercivity (and hence positive definiteness) is guaranteed when $\\alpha-k$. If $\\alpha\\le -k$, then there exist vectors $x$ for which $x^{\\mathsf{T}}Ax\\le 0$, and indeed the smallest eigenvalue of $A$ becomes nonpositive, i.e., the matrix ceases to be symmetric positive definite and the spectrum intrudes into the negative half-line.\n\nFor spectral analysis, we compute the eigenvalues of $A$ numerically via symmetric eigenvalue routines and examine the smallest eigenvalue, denoted $\\lambda_{\\min}(A)$. The matrix $A$ is symmetric positive definite if and only if $\\lambda_{\\min}(A)0$. To regularize, we implement two strategies:\n1) Tikhonov regularization: replace $A$ by $A_\\gamma=A+\\gamma I$ where $I$ is the identity matrix and $\\gamma0$ is a prescribed parameter. This shifts every eigenvalue by $\\gamma$, so $\\lambda_{\\min}(A_\\gamma)=\\lambda_{\\min}(A)+\\gamma$. Choosing $\\gamma$ sufficiently large restores strict positivity even in the presence of negative $\\lambda_{\\min}(A)$.\n2) Boundary stabilization: replace $A$ by $A_\\tau=A+\\tau\\,e_N e_N^{\\mathsf{T}}$, adding a nonnegative boundary penalty equivalent to augmenting $\\alpha$ by $\\tau$ in the Robin term. This yields $\\lambda_{\\min}(A_\\tau)\\ge \\lambda_{\\min}(A)$ with a lift that primarily affects the modes with significant amplitude at the last node. If $\\tau$ is chosen such that $\\alpha+\\tau-k$, then the discrete coercivity bound above becomes positive, ensuring strict positivity of the spectrum.\n\nAlgorithmic design:\n- For each test case $(N,k,\\alpha)$, assemble $K$ using the tridiagonal structure with the specified entries. Form $A=K+\\alpha\\,e_N e_N^{\\mathsf{T}}$.\n- Compute the spectrum of $A$ by a symmetric eigenvalue solver and record $\\lambda_{\\min}(A)$ and whether it is strictly positive.\n- Form $A_\\gamma=A+\\gamma I$ with $\\gamma=200.0$ and repeat the spectral analysis.\n- Form $A_\\tau=A+\\tau\\,e_N e_N^{\\mathsf{T}}$ with $\\tau=100.0$ and repeat the spectral analysis.\n- For numerical robustness, declare a matrix symmetric positive definite if the smallest eigenvalue exceeds a small tolerance, for example $\\varepsilon=10^{-12}$.\n\nTest suite and expected qualitative outcomes:\n- Case A $(N,k,\\alpha)=(50,1.0,-0.2)$ has $\\alpha-k$ since $-0.2-1.0$, so both the continuous and discrete forms are coercive; we expect $\\lambda_{\\min}(A)0$ and positive definiteness without regularization.\n- Case B $(N,k,\\alpha)=(50,1.0,-60.0)$ violates $\\alpha-k$, so we expect a negative $\\lambda_{\\min}(A)$ and loss of positive definiteness; both regularizations should restore positivity, with $A_\\gamma$ shifting the whole spectrum and $A_\\tau$ effectively replacing $\\alpha$ by $\\alpha+\\tau=40.0$ at the boundary.\n- Case C $(N,k,\\alpha)=(200,1.0,-5.0)$ also violates $\\alpha-k$; we again expect a negative $\\lambda_{\\min}(A)$ corrected by both regularizations.\n- Case D $(N,k,\\alpha)=(20,1.0,0.0)$ corresponds to a Neumann boundary at $x=1$; the discrete operator is symmetric positive definite due to the Dirichlet condition at $x=0$, so $\\lambda_{\\min}(A)0$.\n\nThe final program assembles the matrices, computes the smallest eigenvalues and boolean positive definiteness flags for $A$, $A_\\gamma$, and $A_\\tau$ for each case, and prints all results in a single, comma-separated list enclosed in square brackets in the order prescribed in the problem statement. This design directly tests the interplay between well-posedness, spectral stability, and regularization for negative Robin parameters and verifies numerically the theoretical coercivity threshold linked to $\\alpha-k$.",
            "answer": "```python\nimport numpy as np\n\ndef assemble_stiffness_matrix(N: int, k: float) - np.ndarray:\n    \"\"\"\n    Assemble the N x N finite element stiffness matrix K for -d/dx(k u') on (0,1),\n    with uniform mesh h=1/N, piecewise linear basis, Dirichlet at x=0 enforced,\n    and no Robin yet (pure stiffness).\n    Entries:\n      K_ii = 2k/h for i=1..N-1, K_NN = k/h\n      K_i,i+1 = K_i+1,i = -k/h for i=1..N-1\n    \"\"\"\n    h = 1.0 / N\n    main_diag = np.full(N, 2.0 * k / h)\n    if N = 1:\n        main_diag[-1] = k / h  # last diagonal is k/h\n    off_diag = np.full(N - 1, -k / h)\n    K = np.diag(main_diag)\n    if N  1:\n        K += np.diag(off_diag, k=1)\n        K += np.diag(off_diag, k=-1)\n    return K\n\ndef assemble_operator(N: int, k: float, alpha: float) - np.ndarray:\n    \"\"\"\n    Build A = K + alpha * e_N e_N^T, where e_N is the last unit vector.\n    \"\"\"\n    K = assemble_stiffness_matrix(N, k)\n    A = K.copy()\n    if N = 1:\n        A[-1, -1] += alpha\n    return A\n\ndef spectral_properties(A: np.ndarray, tol: float = 1e-12):\n    \"\"\"\n    Compute the smallest eigenvalue and SPD flag for symmetric matrix A.\n    \"\"\"\n    # Use symmetric eigenvalue solver\n    eigvals = np.linalg.eigvalsh(A)\n    lam_min = float(np.min(eigvals))\n    is_spd = bool(lam_min  tol)\n    return lam_min, is_spd\n\ndef solve():\n    # Test cases: (N, k, alpha)\n    test_cases = [\n        (50, 1.0, -0.2),   # Case A\n        (50, 1.0, -60.0),  # Case B\n        (200, 1.0, -5.0),  # Case C\n        (20, 1.0, 0.0),    # Case D\n    ]\n    gamma = 200.0  # Tikhonov parameter\n    tau = 100.0    # Boundary stabilization parameter\n    tol = 1e-12\n\n    results = []\n    for (N, k, alpha) in test_cases:\n        A = assemble_operator(N, k, alpha)\n        lam_min_A, spd_A = spectral_properties(A, tol=tol)\n\n        # Tikhonov regularization: A + gamma I\n        A_tikh = A + gamma * np.eye(N)\n        lam_min_tikh, spd_tikh = spectral_properties(A_tikh, tol=tol)\n\n        # Boundary stabilization: A + tau e_N e_N^T\n        A_b = A.copy()\n        if N = 1:\n            A_b[-1, -1] += tau\n        lam_min_b, spd_b = spectral_properties(A_b, tol=tol)\n\n        # Optionally round smallest eigenvalues to 6 decimals for concise output\n        results.extend([\n            round(lam_min_A, 6), spd_A,\n            round(lam_min_tikh, 6), spd_tikh,\n            round(lam_min_b, 6), spd_b\n        ])\n\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}