{
    "hands_on_practices": [
        {
            "introduction": "Choosing a numerical scheme involves a critical trade-off between accuracy and stability. This first practice provides a direct comparison of several common methods for the linear advection equation, from simple upwinding to the more complex Lax-Wendroff scheme. By analyzing their local truncation errors and stability properties, you will develop a practical understanding of how these factors determine the overall global error, a fundamental skill in numerical algorithm design .",
            "id": "3373618",
            "problem": "Consider the linear advection partial differential equation $u_t + a u_x = 0$ with constant advection speed $a > 0$ on the periodic domain $x \\in [0, 2\\pi]$, with smooth initial data $u(x, 0) = u_0(x)$ such that all derivatives up to order $4$ are bounded. Let the spatial grid be $x_j = j h$ for integer $j$ and fixed spacing $h = 2\\pi/M$, and the time grid be $t^n = n k$ for integer $n$ and time step $k > 0$. Denote the Courant number by $\\lambda = k/h$, and suppose $T > 0$ is a fixed final time. Throughout, assume zero discrete initial error by initializing $u_j^0 = u_0(x_j)$.\n\nYou are asked to select a numerical time-stepping design for evolving the grid values $u_j^n \\approx u(x_j, t^n)$ from $t^n$ to $t^{n+1}$ under an explicit constraint $k = \\lambda h$ with constant $\\lambda$ chosen to satisfy the Courant–Friedrichs–Lewy (CFL) condition appropriate to each scheme. The four candidate designs are:\n\nA. Forward Euler time with first-order upwind space:\n$u_j^{n+1} = u_j^n - \\lambda a \\left(u_j^n - u_{j-1}^n\\right)$.\n\nB. Forward Euler time with second-order centered space (forward-time centered-space):\n$u_j^{n+1} = u_j^n - \\lambda a \\frac{u_{j+1}^n - u_{j-1}^n}{2}$.\n\nC. Lax–Wendroff (second order in both time and space):\n$u_j^{n+1} = u_j^n - \\lambda a \\frac{u_{j+1}^n - u_{j-1}^n}{2} + \\frac{\\lambda^2 a^2}{2} \\left(u_{j+1}^n - 2 u_j^n + u_{j-1}^n\\right)$.\n\nD. Forward Euler time with second-order centered space and an artificial viscosity term scaled by $\\nu > 0$:\n$u_j^{n+1} = u_j^n - \\lambda a \\frac{u_{j+1}^n - u_{j-1}^n}{2} + \\nu \\lambda \\left(u_{j+1}^n - 2 u_j^n + u_{j-1}^n\\right)$.\n\nYou must decide which design minimizes, as $h \\to 0$, the asymptotic upper bound on the global $L^2$ error at the fixed final time $T$ under the following framework rooted in first principles:\n\n- Consistency is defined by the local truncation error $\\tau_j^n$ obtained by substituting the exact solution into the scheme; $\\tau_j^n \\to 0$ as $k \\to 0$ and $h \\to 0$ indicates consistency.\n- Stability is defined by the existence of a uniform-in-$n$ bound in an appropriate norm for solutions of the homogeneous discrete evolution (e.g., via von Neumann analysis for periodic linear constant-coefficient problems).\n- The error decomposition for linear schemes on periodic grids yields an error evolution of the form $e^{n+1} = G e^n + k \\tau^n$ where $G$ is the discrete evolution operator of the homogeneous scheme, implying under stability that $\\|e^N\\| \\le C \\sum_{n=0}^{N-1} k \\|\\tau^n\\|$ for $N$ such that $N k = T$, with $C$ independent of $h$ and $k$.\n\nAssume that, for each scheme, the CFL condition is enforced by choosing $\\lambda$ so that the scheme is stable. Among designs A–D, which one yields the smallest asymptotic upper bound on the global $L^2$ error at time $T$ as $h \\to 0$ under the coupling $k = \\lambda h$ and the above consistency–stability error decomposition?\n\nChoose one:\n\nA. Design A.\n\nB. Design B.\n\nC. Design C.\n\nD. Design D.",
            "solution": "The user wants to identify which of the four given numerical schemes for the linear advection equation, $u_t + a u_x = 0$, minimizes the asymptotic upper bound on the global $L^2$ error at a fixed final time $T$.\n\nThe problem states a framework for assessing the global error, $\\|e^N\\|$, based on the local truncation error, $\\tau^n$. Specifically, for a stable scheme, the global error at the final time $T=Nk$ is bounded by $\\|e^N\\| \\le C \\sum_{n=0}^{N-1} k \\|\\tau^n\\|$, where $C$ is a constant independent of the mesh sizes $h$ and $k$. Since the number of time steps $N = T/k$, this bound can be expressed as $\\|e^N\\| \\le C k \\cdot N \\cdot \\max_n \\|\\tau^n\\| = C T \\max_n \\|\\tau^n\\|$. Therefore, to minimize the asymptotic upper bound on the global error as $h \\to 0$ with the coupling $k = \\lambda h$, we must find the scheme for which the local truncation error, $\\tau$, vanishes at the highest rate. This is equivalent to finding the scheme with the highest order of accuracy.\n\nThe local truncation error $\\tau_j^n$ for a scheme written in the form $\\mathcal{L}_h(u_j^n) = 0$ is defined by substituting the exact solution $u(x,t)$ into the scheme: $\\tau_j^n = \\mathcal{L}_h(u(x_j, t^n))$. We determine the order of accuracy by finding integers $p$ and $q$ such that $\\tau_j^n = O(h^p) + O(k^q)$. With $k = \\lambda h$, the overall order of the truncation error is $O(h^{\\min(p, q)})$. A higher order implies a faster convergence to the exact solution as $h \\to 0$.\n\nWe will analyze each scheme for its stability and order of accuracy. For the truncation error analysis, we use Taylor series expansions of the exact solution $u(x,t)$ around the point $(x_j, t^n)$. The exact solution satisfies $u_t = -a u_x$, which implies higher-order derivatives such as $u_{tt} = a^2 u_{xx}$ and $u_{ttt} = -a^3 u_{xxx}$. The expansion for the exact solution at the next time step is:\n$$u(x_j, t^{n+1}) = u(x_j, t^n+k) = u - ak u_x + \\frac{a^2k^2}{2} u_{xx} - \\frac{a^3 k^3}{6} u_{xxx} + O(k^4)$$\nAll derivatives are evaluated at $(x_j, t^n)$.\n\nThe local truncation error for a one-step scheme $u_j^{n+1} = \\mathcal{F}(u^n)_j$ is given by $k\\tau_j^n = u(x_j, t^{n+1}) - \\mathcal{F}(u(\\cdot, t^n))_j$.\n\n**A. Forward Euler time with first-order upwind space**\nThe scheme is $u_j^{n+1} = u_j^n - \\lambda a \\left(u_j^n - u_{j-1}^n\\right)$.\nThe right-hand side (RHS) applied to the exact solution is:\n$$ \\mathcal{F}_A(u)_j = u(x_j, t^n) - \\frac{k a}{h} \\left( u(x_j, t^n) - u(x_{j-1}, t^n) \\right) $$\n$$ = u - \\frac{ka}{h} \\left( u - (u - h u_x + \\frac{h^2}{2} u_{xx} - O(h^3)) \\right) $$\n$$ = u - \\frac{ka}{h} \\left( h u_x - \\frac{h^2}{2} u_{xx} + O(h^3) \\right) $$\n$$ = u - ak u_x + \\frac{ak h}{2} u_{xx} + O(kh^2) $$\nThe truncation error is determined by:\n$$ k\\tau_j^n = u(x_j, t^{n+1}) - \\mathcal{F}_A(u)_j = \\left( u - ak u_x + \\frac{a^2k^2}{2} u_{xx} + O(k^3) \\right) - \\left( u - ak u_x + \\frac{akh}{2} u_{xx} + O(kh^2) \\right) $$\n$$ k\\tau_j^n = \\left(\\frac{a^2k^2}{2} - \\frac{akh}{2}\\right) u_{xx} + O(k^3, kh^2) $$\n$$ \\tau_j^n = \\left(\\frac{a^2k}{2} - \\frac{ah}{2}\\right) u_{xx} + O(k^2, h^2) $$\nWith $k = \\lambda h$, this becomes $\\tau_j^n = \\frac{ah}{2} (a\\lambda - 1) u_{xx} + O(h^2)$. The scheme is first-order accurate, $\\tau_j^n = O(h,k) = O(h)$. The global error is therefore $O(h)$. Von Neumann analysis shows this scheme is stable for $0  a\\lambda \\le 1$.\n\n**B. Forward Euler time with second-order centered space (FTCS)**\nThe scheme is $u_j^{n+1} = u_j^n - \\lambda a \\frac{u_{j+1}^n - u_{j-1}^n}{2}$.\nTo check for stability, we perform a von Neumann analysis by substituting $u_j^n = g(\\xi)^n e^{i \\xi x_j}$, where $g(\\xi)$ is the amplification factor for the mode with wavenumber $\\xi$.\n$$ g = 1 - \\frac{\\lambda a}{2} \\left( e^{i \\xi h} - e^{-i \\xi h} \\right) = 1 - i \\lambda a \\sin(\\xi h) $$\nThe magnitude of the amplification factor is:\n$$ |g|^2 = 1^2 + (-\\lambda a \\sin(\\xi h))^2 = 1 + (\\lambda a \\sin(\\xi h))^2 $$\nFor any $\\lambda > 0$, $a > 0$, and $\\xi h$ not a multiple of $\\pi$, we have $|g|^2 > 1$. The scheme is therefore unconditionally unstable for the pure advection equation. As this scheme cannot be stabilized for any choice of $\\lambda > 0$, it is not a viable candidate.\n\n**C. Lax–Wendroff**\nThe scheme is $u_j^{n+1} = u_j^n - \\lambda a \\frac{u_{j+1}^n - u_{j-1}^n}{2} + \\frac{\\lambda^2 a^2}{2} \\left(u_{j+1}^n - 2 u_j^n + u_{j-1}^n\\right)$.\nThis scheme is constructed to be second-order in both time and space. Let's verify the truncation error.\nThe RHS applied to the exact solution is:\n$$ \\mathcal{F}_C(u)_j = u - \\frac{ka}{2h}\\left( (u+hu_x+\\frac{h^2}{2}u_{xx}+\\frac{h^3}{6}u_{xxx}) - (u-hu_x+\\frac{h^2}{2}u_{xx}-\\frac{h^3}{6}u_{xxx}) + O(h^5) \\right) + \\frac{k^2 a^2}{2h^2}\\left( (u+hu_x+\\frac{h^2}{2}u_{xx}) - 2u + (u-hu_x+\\frac{h^2}{2}u_{xx}) + O(h^4) \\right) $$\n$$ \\mathcal{F}_C(u)_j = u - \\frac{ka}{2h}(2hu_x + \\frac{h^3}{3}u_{xxx} + O(h^5)) + \\frac{k^2 a^2}{2h^2}(h^2 u_{xx} + O(h^4)) $$\n$$ \\mathcal{F}_C(u)_j = u - ak u_x + \\frac{k^2 a^2}{2}u_{xx} - \\frac{ak h^2}{6}u_{xxx} + O(kh^4, k^2h^2) $$\nThe truncation error is determined by:\n$$ k\\tau_j^n = u(x_j, t^{n+1}) - \\mathcal{F}_C(u)_j $$\n$$ k\\tau_j^n = \\left( u - ak u_x + \\frac{a^2k^2}{2} u_{xx} - \\frac{a^3 k^3}{6} u_{xxx} + O(k^4) \\right) - \\left( u - ak u_x + \\frac{k^2 a^2}{2}u_{xx} - \\frac{ak h^2}{6}u_{xxx} + O(kh^4, k^2h^2) \\right) $$\n$$ k\\tau_j^n = \\left( \\frac{akh^2}{6} - \\frac{a^3k^3}{6} \\right) u_{xxx} + \\dots $$\n$$ \\tau_j^n = \\left( \\frac{ah^2}{6} - \\frac{a^3k^2}{6} \\right) u_{xxx} + \\dots = O(h^2, k^2) $$\nWith $k = \\lambda h$, this becomes $\\tau_j^n = \\frac{ah^2}{6}(1 - (a\\lambda)^2)u_{xxx} + O(h^3)$. The scheme is second-order accurate, $\\tau_j^n = O(h^2)$. The global error is $O(h^2)$. Von Neumann analysis confirms the scheme is stable for $|a\\lambda| \\le 1$.\n\n**D. Forward Euler time with second-order centered space and an artificial viscosity term**\nThe scheme is $u_j^{n+1} = u_j^n - \\lambda a \\frac{u_{j+1}^n - u_{j-1}^n}{2} + \\nu \\lambda \\left(u_{j+1}^n - 2 u_j^n + u_{j-1}^n\\right)$. This is the FTCS scheme with an added term. The added term is a discrete approximation of $\\nu h k/h \\cdot u_{xx} = \\nu k h u_{xx}$ after multiplying the scheme by $h/k$. The modified PDE this scheme approximates is $u_t + a u_x = \\nu h u_{xx}$.\nLet's find the truncation error:\nThe RHS applied to the exact solution is the sum of the RHS from FTCS and the viscosity term.\n$$ \\mathcal{F}_D(u)_j = (u - ak u_x - \\frac{akh^2}{6} u_{xxx} + \\dots) + \\frac{\\nu k}{h}(h^2 u_{xx} + O(h^4)) $$\n$$ \\mathcal{F}_D(u)_j = u - ak u_x + \\nu kh u_{xx} - \\frac{akh^2}{6}u_{xxx} + \\dots $$\nThe truncation error is determined by:\n$$ k\\tau_j^n = u(x_j, t^{n+1}) - \\mathcal{F}_D(u)_j $$\n$$ k\\tau_j^n = \\left( u - ak u_x + \\frac{a^2k^2}{2} u_{xx} + \\dots \\right) - \\left( u - ak u_x + \\nu kh u_{xx} + \\dots \\right) $$\n$$ k\\tau_j^n = \\left(\\frac{a^2k^2}{2} - \\nu kh \\right) u_{xx} + O(kh^2, k^3) $$\n$$ \\tau_j^n = \\left(\\frac{a^2k}{2} - \\nu h \\right) u_{xx} + O(h^2, k^2) $$\nWith $k = \\lambda h$, this is $\\tau_j^n = h \\left(\\frac{a^2\\lambda}{2} - \\nu \\right) u_{xx} + O(h^2)$.\nSince $\\nu > 0$ is a given constant, this scheme is generally first-order, $\\tau_j^n = O(h)$, unless the special condition $\\nu = a^2\\lambda/2$ is met, which is not assumed. The global error is $O(h)$. The added viscosity term stabilizes the FTCS scheme; stability requires choosing $\\lambda$ such that $\\lambda \\le 1/(2\\nu)$ and $\\lambda a^2 \\le 2\\nu$.\n\n**Conclusion**\n\nLet's compare the orders of the global error for the stable schemes, as $h \\to 0$:\n-   Scheme A: $O(h)$\n-   Scheme B: Unstable, hence not usable.\n-   Scheme C: $O(h^2)$\n-   Scheme D: $O(h)$\n\nThe global error for Scheme C decreases with $h^2$, which is asymptotically much faster than the $O(h)$ decrease for Schemes A and D. Therefore, as $h \\to 0$, Scheme C (Lax-Wendroff) will yield the smallest error.\n\nFinal option-by-option analysis:\n- A. Incorrect. This scheme is first-order, $O(h)$, which is less accurate than scheme C.\n- B. Incorrect. This scheme is unconditionally unstable and cannot produce a meaningful solution.\n- C. Correct. This scheme is second-order, $O(h^2)$, providing the fastest asymptotic error reduction among the choices.\n- D. Incorrect. This scheme is first-order, $O(h)$, which is less accurate than scheme C.\n\nHence, the Lax-Wendroff design is the one that minimizes the asymptotic upper bound on the global error.",
            "answer": "$$\\boxed{C}$$"
        },
        {
            "introduction": "Moving beyond a qualitative comparison of schemes, this exercise challenges you to perform a precise quantitative error analysis. For a model parabolic problem, you will dissect the contributions of spatial and temporal discretization to the global error through a detailed asymptotic expansion. This hands-on calculation of the leading-order error coefficient reveals exactly how local inaccuracies accumulate over time, solidifying the connection between local consistency and global convergence .",
            "id": "3373628",
            "problem": "Consider the linear parabolic partial differential equation (PDE) $u_{t} = -A u$ on the spatial interval $(0,1)$ with homogeneous Dirichlet boundary conditions, where $A = -\\Delta$ is the positive Dirichlet Laplacian. Let the exact initial condition be $u_{0}(x) = \\sin(\\pi x)$. The exact solution satisfies $u(x,t) = a(t)\\sin(\\pi x)$ with a scalar amplitude $a(t)$ solving $a^{\\prime}(t) = -\\lambda a(t)$ and $\\lambda = \\pi^{2}$.\n\nDiscretize space using the standard second-order central difference approximation of $A$ on a uniform grid with spacing $h = \\frac{1}{N+1}$ and $N$ interior points, yielding a symmetric positive semidefinite matrix $A_{h} \\in \\mathbb{R}^{N \\times N}$. Discretize time using backward Euler with step size $k > 0$, so that the fully discrete scheme is $(I + k A_{h}) u_{h}^{n+1} = u_{h}^{n}$ for $n \\geq 0$, with $u_{h}^{0}$ obtained by sampling $u_{0}$ at the grid points. Let $T > 0$ be a fixed final time and $N_{t} = \\frac{T}{k} \\in \\mathbb{N}$ the number of time steps.\n\nStarting from fundamental definitions, perform a consistency-stability error decomposition. Use resolvent-based stability for backward Euler, i.e., analyze the discrete propagator $(I + k A_{h})^{-1}$ via its resolvent properties, and derive the global-in-time error at the grid points as the time $T$ is reached. Focus on the specific initial data $u_{0}(x) = \\sin(\\pi x)$ so that the discrete solution evolves on the grid in the discrete sine mode aligned with the continuous mode. Impose the coupled refinement $k = \\alpha h^{2}$ for a fixed parameter $\\alpha > 0$, and consider the asymptotic regime $h \\to 0$ with $T$ fixed.\n\nYour task is to compute the leading-order coefficient $C(\\alpha, T)$ in the asymptotic expansion of the grid-point amplitude error at time $T$,\n$$\nE(T;h,k) = \\text{(discrete amplitude at time $T$)} - \\text{(exact amplitude at time $T$)} = C(\\alpha,T)\\, h^{2} + \\mathcal{O}(h^{4}),\n$$\nunder the coupling $k = \\alpha h^{2}$. Express the final answer as a closed-form analytic expression in terms of $\\alpha$ and $T$. No rounding is required and no units should be included in your answer.",
            "solution": "The user wants a detailed derivation of the leading-order coefficient in the asymptotic expansion of the grid-point amplitude error for a numerical solution to a linear parabolic partial differential equation.\n\nThe problem is validated as follows:\n- **Givens**:\n    - PDE: $u_{t} = -A u$ for $x \\in (0,1)$, with $A = -\\Delta = -\\partial_{xx}$ (positive Dirichlet Laplacian).\n    - Boundary Conditions (BC): Homogeneous Dirichlet, $u(0,t) = u(1,t) = 0$.\n    - Initial Condition (IC): $u_{0}(x) = \\sin(\\pi x)$.\n    - Exact Solution Form: $u(x,t) = a(t)\\sin(\\pi x)$.\n    - Exact Amplitude ODE: $a^{\\prime}(t) = -\\lambda a(t)$ with $\\lambda = \\pi^{2}$ and $a(0)=1$.\n    - Spatial Discretization: Standard second-order central difference on a uniform grid $x_j=jh$ for $j=1, \\dots, N$, with spacing $h = \\frac{1}{N+1}$. Let the discrete operator be $A_h$.\n    - Time Discretization: Backward Euler with step size $k > 0$.\n    - Fully Discrete Scheme: $(I + k A_{h}) u_{h}^{n+1} = u_{h}^{n}$.\n    - Discrete Initial Condition: $u_{h}^{0}$ is the projection of $u_0(x)$ onto the grid.\n    - Asymptotic Coupling: $k = \\alpha h^{2}$ for fixed $\\alpha > 0$.\n    - Final Time: $T > 0$.\n    - Target Quantity: The coefficient $C(\\alpha, T)$ in the expansion of the amplitude error at time $T$: $E(T;h,k) = \\text{discrete amplitude} - \\text{exact amplitude} = C(\\alpha,T) h^{2} + \\mathcal{O}(h^{4})$.\n- **Validation Verdict**: The problem is scientifically grounded, well-posed, objective, and complete. It is a standard exercise in the numerical analysis of partial differential equations, specifically concerning the analysis of global error by decomposing it into spatial and temporal components (consistency and stability). The problem is valid.\n\nWe proceed with the solution.\n\nFirst, we determine the exact amplitude of the continuous solution. The initial condition $u_{0}(x) = \\sin(\\pi x)$ is the first eigenfunction of the operator $A = -\\partial_{xx}$ on $(0,1)$ with homogeneous Dirichlet boundary conditions. The corresponding eigenvalue is $\\lambda_1 = \\pi^{2}$. The solution to the PDE is therefore $u(x,t) = e^{-\\lambda_1 t} u_0(x) = e^{-\\pi^2 t} \\sin(\\pi x)$. By comparing this to the given form $u(x,t) = a(t)\\sin(\\pi x)$, we identify the exact amplitude function as $a(t) = e^{-\\pi^2 t}$. At the final time $T$, the exact amplitude is $a(T) = \\exp(-\\pi^{2} T)$.\n\nNext, we analyze the discrete problem. The spatial domain is discretized by $N$ interior grid points $x_j = j h$ for $j=1, \\dots, N$, with grid spacing $h = \\frac{1}{N+1}$. The second-order central difference approximation to $A = -\\partial_{xx}$ is the matrix $A_h$, whose action on a grid function $v$ is given by $(A_h v)_j = \\frac{-v_{j-1} + 2v_j - v_{j+1}}{h^2}$. The eigenvectors of this matrix $A_h$ are the discrete sine functions $v_j$ with components $(v_j)_m = \\sin(j \\pi x_m) = \\sin(j \\pi m h)$ for $m=1, \\dots, N$. The initial condition $u_0(x) = \\sin(\\pi x)$ when sampled on the grid gives the vector $u_h^0$ with components $(u_h^0)_m = \\sin(\\pi x_m) = \\sin(\\pi m h)$. This is precisely the first discrete eigenvector $v_1$ of $A_h$.\n\nThe eigenvalue $\\lambda_{1,h}$ of $A_h$ corresponding to the eigenvector $v_1$ is found by applying $A_h$ to $v_1$:\n$$ (A_h v_1)_m = \\frac{-\\sin(\\pi(m-1)h) + 2\\sin(\\pi m h) - \\sin(\\pi(m+1)h)}{h^2} $$\nUsing the trigonometric identity $\\sin(a-b) + \\sin(a+b) = 2\\sin(a)\\cos(b)$, we get\n$$ (A_h v_1)_m = \\frac{2\\sin(\\pi m h) - 2\\sin(\\pi m h)\\cos(\\pi h)}{h^2} = \\left(\\frac{2(1 - \\cos(\\pi h))}{h^2}\\right) \\sin(\\pi m h) $$\nThus, the discrete eigenvalue is $\\lambda_{1,h} = \\frac{2(1 - \\cos(\\pi h))}{h^2}$.\n\nThe fully discrete scheme evolves according to $u_h^{n+1} = (I + k A_h)^{-1} u_h^n$. Since the initial data $u_h^0$ is an eigenvector of $A_h$, the solution at any time step $n$ remains in the direction of this eigenvector:\n$u_h^n = ((I+kA_h)^{-1})^n u_h^0$. The corresponding eigenvalue of the propagator $(I+kA_h)^{-1}$ is $(1+k\\lambda_{1,h})^{-1}$. Therefore, the discrete solution is $u_h^n = (1+k\\lambda_{1,h})^{-n} u_h^0$. The discrete amplitude at time step $n$ is $a_h^n = (1+k\\lambda_{1,h})^{-n}$. At the final time $T$, with $n = N_t = T/k$, the discrete amplitude is $a_h(T) = (1+k\\lambda_{1,h})^{-T/k}$.\n\nTo find the error, we perform an asymptotic analysis for $h \\to 0$. We begin by expanding the discrete eigenvalue $\\lambda_{1,h}$ in powers of $h$. Using the Taylor series for cosine, $\\cos(x) = 1 - \\frac{x^2}{2!} + \\frac{x^4}{4!} - \\mathcal{O}(x^6)$:\n$$ \\lambda_{1,h} = \\frac{2}{h^2} \\left(1 - \\left(1 - \\frac{(\\pi h)^2}{2} + \\frac{(\\pi h)^4}{24} - \\mathcal{O}(h^6)\\right)\\right) = \\frac{2}{h^2} \\left(\\frac{\\pi^2 h^2}{2} - \\frac{\\pi^4 h^4}{24} + \\mathcal{O}(h^6)\\right) $$\n$$ \\lambda_{1,h} = \\pi^2 - \\frac{\\pi^4}{12} h^2 + \\mathcal{O}(h^4) $$\nThis shows that the spatial discretization introduces an error of order $\\mathcal{O}(h^2)$ in the eigenvalue, which is expected for a second-order method.\n\nNow we analyze the discrete amplitude $a_h(T)$. It is convenient to work with the logarithm:\n$$ \\ln(a_h(T)) = \\ln\\left((1+k\\lambda_{1,h})^{-T/k}\\right) = -\\frac{T}{k} \\ln(1+k\\lambda_{1,h}) $$\nUsing the Taylor series for the logarithm, $\\ln(1+x) = x - \\frac{x^2}{2} + \\mathcal{O}(x^3)$:\n$$ \\ln(a_h(T)) = -\\frac{T}{k} \\left( k\\lambda_{1,h} - \\frac{(k\\lambda_{1,h})^2}{2} + \\mathcal{O}(k^3) \\right) = -T\\lambda_{1,h} + \\frac{T}{2}k\\lambda_{1,h}^2 + \\mathcal{O}(T k^2) $$\nNow, we substitute the expansion for $\\lambda_{1,h}$ and the coupled refinement condition $k=\\alpha h^2$:\n$$ \\ln(a_h(T)) = -T\\left(\\pi^2 - \\frac{\\pi^4}{12} h^2 + \\mathcal{O}(h^4)\\right) + \\frac{T}{2}(\\alpha h^2)\\left(\\pi^2 - \\frac{\\pi^4}{12} h^2 + \\mathcal{O}(h^4)\\right)^2 + \\mathcal{O}(h^4) $$\nWe only need to keep terms up to $\\mathcal{O}(h^2)$:\n$$ \\ln(a_h(T)) = -T\\pi^2 + T\\frac{\\pi^4}{12} h^2 + \\frac{T\\alpha h^2}{2}(\\pi^2)^2 + \\mathcal{O}(h^4) $$\n$$ \\ln(a_h(T)) = -T\\pi^2 + \\left(T\\frac{\\pi^4}{12} + T\\frac{\\alpha\\pi^4}{2}\\right)h^2 + \\mathcal{O}(h^4) $$\n$$ \\ln(a_h(T)) = -T\\pi^2 + T\\pi^4\\left(\\frac{1}{12} + \\frac{\\alpha}{2}\\right)h^2 + \\mathcal{O}(h^4) $$\nExponentiating both sides gives the asymptotic expansion for $a_h(T)$:\n$$ a_h(T) = \\exp\\left(-T\\pi^2 + T\\pi^4\\left(\\frac{1}{12} + \\frac{\\alpha}{2}\\right)h^2 + \\mathcal{O}(h^4)\\right) $$\n$$ a_h(T) = \\exp(-T\\pi^2) \\exp\\left(T\\pi^4\\left(\\frac{1}{12} + \\frac{\\alpha}{2}\\right)h^2 + \\mathcal{O}(h^4)\\right) $$\nUsing the expansion $\\exp(x) = 1 + x + \\mathcal{O}(x^2)$ for small $x$:\n$$ a_h(T) = \\exp(-T\\pi^2) \\left[ 1 + T\\pi^4\\left(\\frac{1}{12} + \\frac{\\alpha}{2}\\right)h^2 + \\mathcal{O}(h^4) \\right] $$\nThe amplitude error at time $T$ is $E(T;h,k) = a_h(T) - a(T)$. Since $a(T) = \\exp(-\\pi^2 T)$:\n$$ E(T;h,k) = \\exp(-T\\pi^2)\\left[ 1 + T\\pi^4\\left(\\frac{1}{12} + \\frac{\\alpha}{2}\\right)h^2 + \\mathcal{O}(h^4) \\right] - \\exp(-T\\pi^2) $$\n$$ E(T;h,k) = \\exp(-T\\pi^2) T\\pi^4\\left(\\frac{1}{12} + \\frac{\\alpha}{2}\\right)h^2 + \\mathcal{O}(h^4) $$\nBy comparing this with the required form $E(T;h,k) = C(\\alpha,T) h^{2} + \\mathcal{O}(h^{4})$, we identify the leading-order error coefficient:\n$$ C(\\alpha,T) = \\exp(-T\\pi^2) T\\pi^4\\left(\\frac{1}{12} + \\frac{\\alpha}{2}\\right) $$\nThis expression can be simplified by finding a common denominator:\n$$ C(\\alpha,T) = T\\pi^4\\left(\\frac{1 + 6\\alpha}{12}\\right)\\exp(-T\\pi^2) = \\frac{T \\pi^{4} (1 + 6\\alpha)}{12} \\exp(-\\pi^{2} T) $$\nThis result represents the combined leading-order error from the spatial discretization (the term proportional to $\\frac{1}{12}$) and the temporal discretization (the term proportional to $\\frac{\\alpha}{2}$).",
            "answer": "$$\\boxed{\\frac{T \\pi^{4} (1 + 6\\alpha)}{12} \\exp(-\\pi^{2} T)}$$"
        },
        {
            "introduction": "The powerful framework of consistency and stability is not limited to linear equations. This exercise extends these core concepts to the realm of nonlinear conservation laws, where different analytical tools are required. You will prove stability for a monotone scheme not with Fourier analysis, but through its structural properties, and derive an error bound in the $L^{1}$ norm, a more natural choice for solutions that can develop shocks .",
            "id": "3373599",
            "problem": "Consider the scalar conservation law $u_{t} + f(u)_{x} = 0$ on the real line with a smooth flux $f \\in C^{1}(\\mathbb{R})$. Let $\\Delta x > 0$ be a fixed mesh size and $\\Delta t > 0$ a time step satisfying a Courant–Friedrichs–Lewy (CFL) condition that guarantees monotonicity of the following explicit finite volume method:\n$$\nu_{i}^{n+1} \\;=\\; u_{i}^{n} \\;-\\; \\lambda \\Big(F\\big(u_{i}^{n},u_{i+1}^{n}\\big) \\;-\\; F\\big(u_{i-1}^{n},u_{i}^{n}\\big)\\Big), \\quad \\lambda := \\frac{\\Delta t}{\\Delta x},\n$$\nwhere $F:\\mathbb{R}^{2}\\to\\mathbb{R}$ is a numerical flux function that is consistent with $f$ in the sense that $F(a,a)=f(a)$ for all $a \\in \\mathbb{R}$, and is monotone in the sense that $F$ is nondecreasing in its first argument and nonincreasing in its second argument. Assume that the initial condition is initialized by exact cell averages $u_{i}^{0} = \\frac{1}{\\Delta x}\\int_{x_{i-1/2}}^{x_{i+1/2}} u_{0}(x)\\,dx$ of a bounded variation initial datum $u_{0}\\in BV(\\mathbb{R})$, and let $u(\\cdot,t)$ denote the entropy solution of the conservation law with initial data $u_{0}$.\n\nDefine the cell-average projection of the exact solution by $\\bar{u}_{i}^{n} := \\frac{1}{\\Delta x}\\int_{x_{i-1/2}}^{x_{i+1/2}} u(x,t^{n})\\,dx$, where $t^{n} := n\\Delta t$, and the discrete $L^{1}$-norm by $\\|v^{n}\\|_{1} := \\sum_{i\\in\\mathbb{Z}} |v_{i}^{n}|\\,\\Delta x$ for any grid function $v^{n}$. Let the local residual $\\tau^{n} = \\{\\tau_{i}^{n}\\}_{i\\in\\mathbb{Z}}$ be defined by substituting $\\bar{u}^{n}$ into the scheme:\n$$\n\\tau_{i}^{n} \\;:=\\; \\frac{\\bar{u}_{i}^{n+1}-\\bar{u}_{i}^{n}}{\\Delta t}\n\\;+\\; \\frac{F\\big(\\bar{u}_{i}^{n},\\bar{u}_{i+1}^{n}\\big) \\;-\\; F\\big(\\bar{u}_{i-1}^{n},\\bar{u}_{i}^{n}\\big)}{\\Delta x}.\n$$\n\nTasks:\n1) Using only the definitions above and the monotonicity of $F$, prove that the update operator is nonexpansive in the discrete $L^{1}$-norm for any two inputs $v^{n}$ and $w^{n}$, i.e., $\\|v^{n+1}-w^{n+1}\\|_{1} \\le \\|v^{n}-w^{n}\\|_{1}$. Conclude that the $L^{1}$-stability amplification factor $S$ in the consistency–stability error decomposition is $S=1$.\n\n2) Assume there exists a constant $K>0$ such that for all $n$ with $t^{n} \\le T$ the residual satisfies $\\|\\tau^{n}\\|_{1} \\le K\\,\\Delta x$. Using the result of part 1) and the discrete error equation for $e^{n} := \\bar{u}^{n} - u^{n}$, derive an upper bound on $\\|e^{N}\\|_{1}$ at time $T = N\\Delta t$ in terms of $K$, $T$, and $\\Delta x$, under the assumption $e^{0}=0$.\n\nFinally, specialize your bound to the data $K=3$ and $T=2$, and report the resulting bound as a single closed-form expression in terms of $\\Delta x$. No rounding is required. Express your final answer without units.",
            "solution": "The problem is validated as a well-posed and standard exercise in the numerical analysis of hyperbolic conservation laws. The assumptions are consistent and sufficient for the requested derivations.\n\n**Part 1: Proof of Non-Expansivity and Determination of the Stability Factor $S$**\n\nLet the update operator for the numerical scheme be denoted by $H$, such that for a grid function $v^{n} = \\{v_{i}^{n}\\}_{i\\in\\mathbb{Z}}$, the updated grid function $v^{n+1} = H(v^{n})$ has components\n$$\n(H(v^{n}))_{i} = v_{i}^{n} - \\lambda \\Big(F\\big(v_{i}^{n},v_{i+1}^{n}\\big) - F\\big(v_{i-1}^{n},v_{i}^{n}\\big)\\Big),\n$$\nwhere $\\lambda = \\frac{\\Delta t}{\\Delta x}$. We want to prove that this operator is non-expansive in the discrete $L^{1}$-norm, i.e., for any two grid functions $v^{n}$ and $w^{n}$, we have $\\|H(v^{n})-H(w^{n})\\|_{1} \\le \\|v^{n}-w^{n}\\|_{1}$.\n\nLet $v^{n+1} = H(v^{n})$ and $w^{n+1} = H(w^{n})$. The difference at grid point $i$ is\n$$\nv_{i}^{n+1} - w_{i}^{n+1} = (v_{i}^{n} - w_{i}^{n}) - \\lambda \\Big( \\big(F(v_{i}^{n}, v_{i+1}^{n}) - F(w_{i}^{n}, w_{i+1}^{n})\\big) - \\big(F(v_{i-1}^{n}, v_{i}^{n}) - F(w_{i-1}^{n}, w_{i}^{n})\\big) \\Big).\n$$\nLet $\\delta_{i}^{n} := v_{i}^{n} - w_{i}^{n}$. The expression for the flux difference can be decomposed using the mean value theorem. For the term $F(v_{i}^{n}, v_{i+1}^{n}) - F(w_{i}^{n}, w_{i+1}^{n})$, we have\n$$\nF(v_{i}^{n}, v_{i+1}^{n}) - F(w_{i}^{n}, w_{i+1}^{n}) = \\big(F(v_{i}^{n}, v_{i+1}^{n}) - F(w_{i}^{n}, v_{i+1}^{n})\\big) + \\big(F(w_{i}^{n}, v_{i+1}^{n}) - F(w_{i}^{n}, w_{i+1}^{n})\\big).\n$$\nDue to the monotonicity of $F$ (nondecreasing in the first argument, nonincreasing in the second), we can define coefficients $A_{i+1/2}^{n} \\ge 0$ and $B_{i+1/2}^{n} \\le 0$ such that\n$$\nF(v_{i}^{n}, v_{i+1}^{n}) - F(w_{i}^{n}, w_{i+1}^{n}) = A_{i+1/2}^{n}(v_{i}^{n} - w_{i}^{n}) + B_{i+1/2}^{n}(v_{i+1}^{n} - w_{i+1}^{n}) = A_{i+1/2}^{n}\\delta_{i}^{n} + B_{i+1/2}^{n}\\delta_{i+1}^{n}.\n$$\nSubstituting this into the equation for $\\delta_{i}^{n+1} = v_{i}^{n+1} - w_{i}^{n+1}$:\n$$\n\\delta_{i}^{n+1} = \\delta_{i}^{n} - \\lambda \\big(A_{i+1/2}^{n}\\delta_{i}^{n} + B_{i+1/2}^{n}\\delta_{i+1}^{n}\\big) + \\lambda \\big(A_{i-1/2}^{n}\\delta_{i-1}^{n} + B_{i-1/2}^{n}\\delta_{i}^{n}\\big).\n$$\nRearranging the terms based on the indices of $\\delta^{n}$:\n$$\n\\delta_{i}^{n+1} = \\big(\\lambda A_{i-1/2}^{n}\\big)\\delta_{i-1}^{n} + \\big(1 - \\lambda A_{i+1/2}^{n} + \\lambda B_{i-1/2}^{n}\\big)\\delta_{i}^{n} + \\big(-\\lambda B_{i+1/2}^{n}\\big)\\delta_{i+1}^{n}.\n$$\nLet's denote the coefficients as $C_{i,i-1} = \\lambda A_{i-1/2}^{n}$, $C_{i,i} = 1 - \\lambda A_{i+1/2}^{n} + \\lambda B_{i-1/2}^{n}$, and $C_{i,i+1} = -\\lambda B_{i+1/2}^{n}$.\nThe problem states that the CFL condition ensures the monotonicity of the scheme. A scheme $u_{i}^{n+1} = \\mathcal{H}(u_{i-1}^{n}, u_{i}^{n}, u_{i+1}^{n})$ is monotone if $\\mathcal{H}$ is a non-decreasing function of each of its arguments. This implies that the coefficients $C_{i,j}$ are non-negative.\nIndeed, $A_{i-1/2}^{n} \\ge 0$ implies $C_{i,i-1} \\ge 0$.\n$B_{i+1/2}^{n} \\le 0$ implies $C_{i,i+1} \\ge 0$.\nThe condition $C_{i,i} \\ge 0$ is guaranteed by the CFL condition for monotone schemes.\n\nTaking the absolute value of $\\delta_{i}^{n+1}$ and using the triangle inequality:\n$$\n|\\delta_{i}^{n+1}| \\le |C_{i,i-1}\\delta_{i-1}^{n}| + |C_{i,i}\\delta_{i}^{n}| + |C_{i,i+1}\\delta_{i+1}^{n}|.\n$$\nSince all coefficients $C_{i,j}$ are non-negative:\n$$\n|\\delta_{i}^{n+1}| \\le C_{i,i-1}|\\delta_{i-1}^{n}| + C_{i,i}|\\delta_{i}^{n}| + C_{i,i+1}|\\delta_{i+1}^{n}|.\n$$\nNow, we sum over all $i \\in \\mathbb{Z}$:\n$$\n\\sum_{i\\in\\mathbb{Z}} |\\delta_{i}^{n+1}| \\le \\sum_{i\\in\\mathbb{Z}} \\big(C_{i,i-1}|\\delta_{i-1}^{n}| + C_{i,i}|\\delta_{i}^{n}| + C_{i,i+1}|\\delta_{i+1}^{n}|\\big).\n$$\nWe change the index of summation for each term on the right-hand side to collect terms multiplying $|\\delta_{j}^{n}|$:\n$$\n\\sum_{i\\in\\mathbb{Z}} |\\delta_{i}^{n+1}| \\le \\sum_{j\\in\\mathbb{Z}} \\big( C_{j+1,j} + C_{j,j} + C_{j-1,j} \\big) |\\delta_{j}^{n}|.\n$$\nLet's compute the sum of the coefficients for a given $\\delta_{j}^{n}$. The coefficient of $|\\delta_{j}^{n}|$ arises from the sum on the right for $i=j+1$, $i=j$, and $i=j-1$.\nTerm for $|\\delta_{j}^{n}|$ comes from:\n$i=j$: $C_{j,j}|\\delta_j^n| = (1 - \\lambda A_{j+1/2}^n + \\lambda B_{j-1/2}^n)|\\delta_j^n|$.\n$i=j+1$: $C_{j+1,j}|\\delta_j^n| = (\\lambda A_{(j+1)-1/2}^n)|\\delta_j^n| = (\\lambda A_{j+1/2}^n)|\\delta_j^n|$.\n$i=j-1$: $C_{j-1,j}|\\delta_j^n| = (-\\lambda B_{(j-1)+1/2}^n)|\\delta_j^n| = (-\\lambda B_{j-1/2}^n)|\\delta_j^n|$.\nThe sum of these coefficients is:\n$$\n(1 - \\lambda A_{j+1/2}^{n} + \\lambda B_{j-1/2}^{n}) + (\\lambda A_{j+1/2}^{n}) + (-\\lambda B_{j-1/2}^{n}) = 1.\n$$\nTherefore, we have shown that\n$$\n\\sum_{i\\in\\mathbb{Z}} |\\delta_{i}^{n+1}| \\le \\sum_{j\\in\\mathbb{Z}} |\\delta_{j}^{n}|.\n$$\nMultiplying by $\\Delta x$ yields the desired result:\n$$\n\\|v^{n+1}-w^{n+1}\\|_{1} = \\sum_{i\\in\\mathbb{Z}}|v_{i}^{n+1}-w_{i}^{n+1}|\\Delta x \\le \\sum_{j\\in\\mathbb{Z}}|v_{j}^{n}-w_{j}^{n}|\\Delta x = \\|v^{n}-w^{n}\\|_{1}.\n$$\nThis proves that the operator $H$ is non-expansive in the discrete $L^{1}$-norm. The stability amplification factor $S$ in the error decomposition corresponds to the factor by which the error norm can grow at each step due to the scheme's evolution operator. As we have shown this factor is at most $1$, we conclude that $S=1$.\n\n**Part 2: Error Bound Derivation**\n\nWe are given the definition of the local residual $\\tau_{i}^{n}$:\n$$\n\\tau_{i}^{n} = \\frac{\\bar{u}_{i}^{n+1}-\\bar{u}_{i}^{n}}{\\Delta t} + \\frac{F\\big(\\bar{u}_{i}^{n},\\bar{u}_{i+1}^{n}\\big) - F\\big(\\bar{u}_{i-1}^{n},\\bar{u}_{i}^{n}\\big)}{\\Delta x}.\n$$\nRearranging this equation gives an expression for the evolution of the exact cell averages $\\bar{u}^{n}$:\n$$\n\\bar{u}_{i}^{n+1} = \\bar{u}_{i}^{n} - \\lambda \\Big(F(\\bar{u}_{i}^{n},\\bar{u}_{i+1}^{n}) - F(\\bar{u}_{i-1}^{n},\\bar{u}_{i}^{n})\\Big) - \\Delta t\\,\\tau_{i}^{n}.\n$$\nIn operator notation, this is $\\bar{u}^{n+1} = H(\\bar{u}^{n}) - \\Delta t\\,\\tau^{n}$.\nThe numerical solution $u^{n}$ evolves according to $u^{n+1} = H(u^{n})$.\nThe error is defined as $e^{n} = \\bar{u}^{n} - u^{n}$. Subtracting the equation for $u^{n+1}$ from the one for $\\bar{u}^{n+1}$, we obtain the error evolution equation:\n$$\ne^{n+1} = \\bar{u}^{n+1} - u^{n+1} = \\big(H(\\bar{u}^{n}) - \\Delta t\\,\\tau^{n}\\big) - H(u^{n}) = \\big(H(\\bar{u}^{n}) - H(u^{n})\\big) - \\Delta t\\,\\tau^{n}.\n$$\nWe now take the discrete $L^{1}$-norm of this equation and apply the triangle inequality:\n$$\n\\|e^{n+1}\\|_{1} = \\|(H(\\bar{u}^{n}) - H(u^{n})) - \\Delta t\\,\\tau^{n}\\|_{1} \\le \\|H(\\bar{u}^{n}) - H(u^{n})\\|_{1} + \\|\\Delta t\\,\\tau^{n}\\|_{1}.\n$$\nFrom the result of Part 1, the operator $H$ is non-expansive in the $L^{1}$-norm, so\n$$\n\\|H(\\bar{u}^{n}) - H(u^{n})\\|_{1} \\le \\|\\bar{u}^{n} - u^{n}\\|_{1} = \\|e^{n}\\|_{1}.\n$$\nThe norm of the residual term is $\\|\\Delta t\\,\\tau^{n}\\|_{1} = \\Delta t \\sum_{i} |\\tau_{i}^{n}|\\Delta x = \\Delta t\\|\\tau^{n}\\|_{1}$.\nCombining these results, we get the recurrence relation for the error norm:\n$$\n\\|e^{n+1}\\|_{1} \\le \\|e^{n}\\|_{1} + \\Delta t\\|\\tau^{n}\\|_{1}.\n$$\nWe are given the assumption that $\\|\\tau^{n}\\|_{1} \\le K\\,\\Delta x$ for all $n$ such that $t^{n} \\le T$. Applying this to the recurrence:\n$$\n\\|e^{n+1}\\|_{1} \\le \\|e^{n}\\|_{1} + \\Delta t(K\\,\\Delta x).\n$$\nWe can solve this recurrence by induction. For $n=0$: $\\|e^{1}\\|_{1} \\le \\|e^{0}\\|_{1} + K\\Delta t\\Delta x$. For $n=1$: $\\|e^{2}\\|_{1} \\le \\|e^{1}\\|_{1} + K\\Delta t\\Delta x \\le \\|e^{0}\\|_{1} + 2K\\Delta t\\Delta x$.\nAfter $N$ steps, we have:\n$$\n\\|e^{N}\\|_{1} \\le \\|e^{0}\\|_{1} + \\sum_{n=0}^{N-1} K\\Delta t\\Delta x = \\|e^{0}\\|_{1} + N K \\Delta t \\Delta x.\n$$\nThe problem states that $e^{0}=0$, so $\\|e^{0}\\|_{1}=0$. The bound simplifies to:\n$$\n\\|e^{N}\\|_{1} \\le N \\Delta t K \\Delta x.\n$$\nThe final time is $T=N\\Delta t$. Substituting this into the bound gives:\n$$\n\\|e^{N}\\|_{1} \\le T K \\Delta x.\n$$\nFinally, we specialize this bound using the given data $K=3$ and $T=2$:\n$$\n\\|e^{N}\\|_{1} \\le (2)(3)\\Delta x = 6\\Delta x.\n$$\nThis is the required upper bound on the $L^{1}$-error at time $T=2$.",
            "answer": "$$\\boxed{6\\Delta x}$$"
        }
    ]
}