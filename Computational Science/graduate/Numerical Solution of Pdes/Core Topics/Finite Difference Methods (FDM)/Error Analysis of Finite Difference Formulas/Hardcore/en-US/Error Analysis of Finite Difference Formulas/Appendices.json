{
    "hands_on_practices": [
        {
            "introduction": "The foundation of analyzing and creating finite difference schemes lies in the systematic application of Taylor series. This first exercise guides you through the 'method of undetermined coefficients' to construct a custom formula from scratch. By enforcing accuracy conditions term by term, you will derive a third-order accurate one-sided stencil for the first derivative, a critical tool for handling approximations near domain boundaries where centered stencils are not viable .",
            "id": "3386969",
            "problem": "Consider a smooth function $u(x)$ sampled on a uniform grid with spacing $h0$ at nodes $x_{j}=x_{0}+j h$ for $j \\in \\{0, 1, 2, 3\\}$. You seek a one-sided finite difference formula that approximates the first derivative $u'(x_{0})$ using only the function values $\\{u(x_{0}),u(x_{1}),u(x_{2}),u(x_{3})\\}$. Assume $u$ is sufficiently differentiable so that Taylor series expansions around $x_{0}$ are valid.\n\nStarting from the Taylor series definition of $u(x_{0}+j h)$ about $x_{0}$ and the requirement that a consistent finite difference approximation to $u'(x_{0})$ must match the Taylor expansion term by term, construct coefficients $c_0, c_1, c_2, c_3 \\in \\mathbb{R}$ such that the one-sided stencil\n$$\n\\frac{1}{h}\\sum_{j=0}^{3} c_{j}\\,u(x_{0}+j h)\n$$\nis third-order accurate for $u'(x_{0})$, meaning that the local truncation error is $\\mathcal{O}(h^3)$.\n\nThen, verify the moment conditions up to and including the term involving $u^{(3)}(x_{0})$, and explicitly compute the truncation error constant $C$ defined by the leading term of the local truncation error\n$$\n\\frac{1}{h}\\sum_{j=0}^{3} c_{j}\\,u(x_{0}+j h)-u'(x_{0}) \\;=\\; C\\,h^{3}\\,u^{(4)}(x_{0})\\;+\\;\\mathcal{O}(h^{4}).\n$$\n\nReport your final result as a single row matrix containing the coefficients followed by the truncation error constant in the order $(c_{0},\\,c_{1},\\,c_{2},\\,c_{3},\\,C)$. No rounding is required; provide exact rational values. The answer must be unitless and expressed exactly.",
            "solution": "The problem as stated is scientifically grounded, well-posed, and objective. It presents a standard task in numerical analysis: the derivation of a finite difference formula using the method of undetermined coefficients based on Taylor series expansions. The problem provides all necessary information and constraints to arrive at a unique solution. Therefore, we proceed with the derivation.\n\nWe are tasked with finding coefficients $c_0, c_1, c_2, c_3$ such that the one-sided finite difference formula\n$$\nL[u] = \\frac{1}{h}\\sum_{j=0}^{3} c_{j}\\,u(x_{0}+j h)\n$$\napproximates the first derivative $u'(x_{0})$ with third-order accuracy. This means the local truncation error, $\\tau = L[u] - u'(x_0)$, must be of order $\\mathcal{O}(h^3)$.\n\nTo determine the coefficients, we expand each term $u(x_0 + jh)$ in a Taylor series around the point $x_0$. Assuming $u$ is sufficiently smooth, we have:\n$$\nu(x_0+jh) = u(x_0) + (jh)u'(x_0) + \\frac{(jh)^2}{2!}u''(x_0) + \\frac{(jh)^3}{3!}u'''(x_0) + \\frac{(jh)^4}{4!}u^{(4)}(x_0) + \\mathcal{O}(h^5)\n$$\nSubstituting this expansion into the formula for $L[u]$ gives:\n$$\nL[u] = \\frac{1}{h} \\sum_{j=0}^{3} c_j \\left( u(x_0) + jhu'(x_0) + \\frac{j^2h^2}{2}u''(x_0) + \\frac{j^3h^3}{6}u'''(x_0) + \\frac{j^4h^4}{24}u^{(4)}(x_0) + \\mathcal{O}(h^5) \\right)\n$$\nWe can regroup the terms by the derivatives of $u$ evaluated at $x_0$:\n$$\nL[u] = \\left(\\frac{1}{h}\\sum_{j=0}^{3} c_j\\right) u(x_0) + \\left(\\sum_{j=0}^{3} jc_j\\right) u'(x_0) + \\left(\\frac{h}{2}\\sum_{j=0}^{3} j^2c_j\\right) u''(x_0) + \\left(\\frac{h^2}{6}\\sum_{j=0}^{3} j^3c_j\\right) u'''(x_0) + \\left(\\frac{h^3}{24}\\sum_{j=0}^{3} j^4c_j\\right) u^{(4)}(x_0) + \\mathcal{O}(h^4)\n$$\nFor $L[u]$ to be a consistent approximation of $u'(x_0)$ with a truncation error of $\\mathcal{O}(h^3)$, the coefficients of the derivatives in the expansion of $L[u]$ must match those in the expansion of $u'(x_0)$ itself, which is simply $1 \\cdot u'(x_0)$. Specifically, we require:\n\\begin{enumerate}\n    \\item The coefficient of $u(x_0)$ must be $0$: $\\frac{1}{h}\\sum_{j=0}^{3} c_j = 0 \\implies \\sum_{j=0}^{3} c_j = 0$.\n    \\item The coefficient of $u'(x_0)$ must be $1$: $\\sum_{j=0}^{3} jc_j = 1$.\n    \\item The coefficient of $u''(x_0)$ must be $0$: $\\frac{h}{2}\\sum_{j=0}^{3} j^2c_j = 0 \\implies \\sum_{j=0}^{3} j^2c_j = 0$.\n    \\item The coefficient of $u'''(x_0)$ must be $0$: $\\frac{h^2}{6}\\sum_{j=0}^{3} j^3c_j = 0 \\implies \\sum_{j=0}^{3} j^3c_j = 0$.\n\\end{enumerate}\nThese four conditions constitute the moment conditions required for third-order accuracy and give rise to a system of four linear equations for the four unknown coefficients $c_0, c_1, c_2, c_3$:\n\\begin{align*}\n    1 \\cdot c_0 + 1 \\cdot c_1 + 1 \\cdot c_2 + 1 \\cdot c_3 = 0 \\\\\n    0 \\cdot c_0 + 1 \\cdot c_1 + 2 \\cdot c_2 + 3 \\cdot c_3 = 1 \\\\\n    0^2 \\cdot c_0 + 1^2 \\cdot c_1 + 2^2 \\cdot c_2 + 3^2 \\cdot c_3 = 0 \\\\\n    0^3 \\cdot c_0 + 1^3 \\cdot c_1 + 2^3 \\cdot c_2 + 3^3 \\cdot c_3 = 0\n\\end{align*}\nThe system simplifies to:\n\\begin{align*}\n    c_0 + c_1 + c_2 + c_3 = 0 \\\\\n    c_1 + 2c_2 + 3c_3 = 1 \\\\\n    c_1 + 4c_2 + 9c_3 = 0 \\\\\n    c_1 + 8c_2 + 27c_3 = 0\n\\end{align*}\nWe solve the subsystem for $c_1, c_2, c_3$. Subtracting the second equation from the third and fourth gives:\n\\begin{align*}\n    (c_1 + 4c_2 + 9c_3) - (c_1 + 2c_2 + 3c_3) = 0 - 1 \\implies 2c_2 + 6c_3 = -1 \\\\\n    (c_1 + 8c_2 + 27c_3) - (c_1 + 2c_2 + 3c_3) = 0 - 1 \\implies 6c_2 + 24c_3 = -1\n\\end{align*}\nWe now have a $2 \\times 2$ system for $c_2$ and $c_3$. Multiplying the first of these new equations by $3$ gives $6c_2 + 18c_3 = -3$. Subtracting this from the second equation, $6c_2 + 24c_3 = -1$, yields:\n$$\n(6c_2 + 24c_3) - (6c_2 + 18c_3) = -1 - (-3) \\implies 6c_3 = 2 \\implies c_3 = \\frac{1}{3}\n$$\nSubstituting $c_3 = 1/3$ back into $2c_2 + 6c_3 = -1$:\n$$\n2c_2 + 6\\left(\\frac{1}{3}\\right) = -1 \\implies 2c_2 + 2 = -1 \\implies 2c_2 = -3 \\implies c_2 = -\\frac{3}{2}\n$$\nSubstituting $c_2 = -3/2$ and $c_3 = 1/3$ back into $c_1 + 2c_2 + 3c_3 = 1$:\n$$\nc_1 + 2\\left(-\\frac{3}{2}\\right) + 3\\left(\\frac{1}{3}\\right) = 1 \\implies c_1 - 3 + 1 = 1 \\implies c_1 = 3\n$$\nFinally, we find $c_0$ from the first equation, $c_0 + c_1 + c_2 + c_3 = 0$:\n$$\nc_0 + 3 - \\frac{3}{2} + \\frac{1}{3} = 0 \\implies c_0 + \\frac{18-9+2}{6} = 0 \\implies c_0 + \\frac{11}{6} = 0 \\implies c_0 = -\\frac{11}{6}\n$$\nThus, the coefficients are $c_0 = -11/6$, $c_1 = 3$, $c_2 = -3/2$, and $c_3 = 1/3$. The verification of the moment conditions up to the term involving $u^{(3)}(x_0)$ is inherent in this derivation, as we have explicitly forced them to be satisfied.\n\nNow, we compute the truncation error constant $C$. The local truncation error is $\\tau = L[u] - u'(x_0)$. With the determined coefficients, the terms involving $u(x_0)$, $u'(x_0)$, $u''(x_0)$, and $u'''(x_0)$ are correctly accounted for, so the leading error term is the next term in the Taylor expansion:\n$$\n\\tau = \\left(\\frac{h^3}{24}\\sum_{j=0}^{3} j^4c_j\\right) u^{(4)}(x_0) + \\mathcal{O}(h^4)\n$$\nThe problem defines the truncation error constant $C$ such that $\\tau = C h^3 u^{(4)}(x_0) + \\mathcal{O}(h^4)$. Comparing these two forms, we find:\n$$\nC = \\frac{1}{24}\\sum_{j=0}^{3} j^4c_j\n$$\nWe compute the sum:\n$$\n\\sum_{j=0}^{3} j^4c_j = 0^4 c_0 + 1^4 c_1 + 2^4 c_2 + 3^4 c_3 = c_1 + 16c_2 + 81c_3\n$$\nSubstituting the values of the coefficients:\n$$\n\\sum_{j=0}^{3} j^4c_j = 3 + 16\\left(-\\frac{3}{2}\\right) + 81\\left(\\frac{1}{3}\\right) = 3 - 24 + 27 = 6\n$$\nTherefore, the constant $C$ is:\n$$\nC = \\frac{1}{24}(6) = \\frac{1}{4}\n$$\nThe requested values are the coefficients $c_0, c_1, c_2, c_3$ and the truncation error constant $C$.\n$c_0 = -11/6$\n$c_1 = 3$\n$c_2 = -3/2$\n$c_3 = 1/3$\n$C = 1/4$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -\\frac{11}{6}  3  -\\frac{3}{2}  \\frac{1}{3}  \\frac{1}{4} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "With the ability to construct a formula, we can now analyze and compare different schemes for the same task. This practice focuses on the ubiquitous second-derivative approximation, contrasting the standard second-order central difference with more sophisticated fourth-order explicit and compact implicit methods . By calculating their leading truncation error terms, you will see precisely how higher-order accuracy is achieved and understand the crucial implications for advanced techniques like Richardson extrapolation.",
            "id": "3386971",
            "problem": "Let $u(x)$ be a sufficiently smooth function on an open interval containing a point $x_{i}$, and let $\\{x_{i+k}\\}_{k \\in \\mathbb{Z}}$ be a uniform grid with spacing $h0$, where $x_{i \\pm k} = x_i \\pm k h$. Denote by $u^{(m)}(x)$ the $m$-th derivative of $u$ evaluated at $x$. Consider three symmetric finite difference schemes for approximating the second derivative $u_{xx}(x_{i})$ used in the numerical solution of partial differential equations (PDEs):\n\n1. The standard three-point central difference operator\n$$\nD^{(2)}_{3} u(x_{i}) \\equiv \\frac{u(x_{i+1}) - 2 u(x_{i}) + u(x_{i-1})}{h^{2}}.\n$$\n\n2. A five-point explicit symmetric stencil of the form\n$$\nD^{(2)}_{5} u(x_{i}) \\equiv \\frac{1}{h^{2}}\\big( a\\,u(x_{i-2}) + b\\,u(x_{i-1}) + c\\,u(x_{i}) + b\\,u(x_{i+1}) + a\\,u(x_{i+2}) \\big),\n$$\nwhere the real coefficients $a$, $b$, and $c$ are to be determined by enforcing consistency with $u_{xx}(x_{i})$ and maximizing the formal order of accuracy under symmetry and smoothness assumptions.\n\n3. A fourth-order compact tridiagonal scheme (in the sense of implicit finite differences) that defines a sequence $\\{q_{i}\\}$ intended to approximate $u_{xx}(x_{i})$ via the relation\n$$\n\\alpha\\, q_{i-1} + q_{i} + \\alpha\\, q_{i+1} \\;=\\; \\frac{\\beta}{h^{2}}\\big(u(x_{i+1}) - 2 u(x_{i}) + u(x_{i-1})\\big),\n$$\nwith real constants $\\alpha$ and $\\beta$ chosen so that $q_{i}$ achieves the highest possible formal order under symmetry and smoothness assumptions; $q_{i}$ is then taken as the approximation to $u_{xx}(x_{i})$.\n\nStarting from the Taylor series expansion of $u(x_{i\\pm k})$ about $x_{i}$, derive the leading-order truncation error terms for each scheme. In particular, for each of the three schemes, extract the coefficient multiplying $h^{2} u^{(4)}(x_{i})$ in the local truncation error expansion of the approximate second derivative at $x_{i}$. Express these three leading error constants, in the order listed above, as exact rational numbers. Then, briefly discuss the implications of your results for the feasibility of Richardson extrapolation that targets cancellation of the leading $h^{2}$ error term.\n\nYour final answer must be a single row matrix containing the three constants corresponding to the three schemes, each expressed exactly as a fraction. No rounding is required, and no units are involved.",
            "solution": "The fundamental base for error analysis of finite difference formulas on uniform grids is the Taylor series expansion. For $k\\in\\mathbb{Z}$, expand $u(x_{i\\pm k})$ about $x_{i}$:\n$$\nu(x_{i\\pm k}) \\;=\\; u(x_{i})\n\\;\\pm\\; k h\\,u^{\\prime}(x_{i})\n\\;+\\; \\frac{(k h)^{2}}{2}\\,u^{\\prime\\prime}(x_{i})\n\\;\\pm\\; \\frac{(k h)^{3}}{6}\\,u^{(3)}(x_{i})\n\\;+\\; \\frac{(k h)^{4}}{24}\\,u^{(4)}(x_{i})\n\\;\\pm\\; \\frac{(k h)^{5}}{120}\\,u^{(5)}(x_{i})\n\\;+\\; \\frac{(k h)^{6}}{720}\\,u^{(6)}(x_{i})\n\\;+\\; \\cdots.\n$$\nBy symmetry, odd-order terms cancel in symmetric stencils, and the truncation error can be read off from the even-order terms.\n\nScheme 1 (three-point central difference). Compute\n$$\nD^{(2)}_{3} u(x_{i}) \\;=\\; \\frac{u(x_{i+1}) - 2 u(x_{i}) + u(x_{i-1})}{h^{2}}.\n$$\nUsing the expansions for $k=1$:\n\\begin{align*}\nu(x_{i+1}) + u(x_{i-1})\n= 2 u(x_{i}) + h^{2} u^{\\prime\\prime}(x_{i}) + \\frac{h^{4}}{12} u^{(4)}(x_{i}) + \\frac{h^{6}}{360} u^{(6)}(x_{i}) + \\cdots,\\\\\nu(x_{i+1}) - 2 u(x_{i}) + u(x_{i-1})\n= h^{2} u^{\\prime\\prime}(x_{i}) + \\frac{h^{4}}{12} u^{(4)}(x_{i}) + \\frac{h^{6}}{360} u^{(6)}(x_{i}) + \\cdots,\n\\end{align*}\nso\n$$\nD^{(2)}_{3} u(x_{i}) \\;=\\; u^{\\prime\\prime}(x_{i}) + \\frac{h^{2}}{12} u^{(4)}(x_{i}) + \\frac{h^{4}}{360} u^{(6)}(x_{i}) + \\cdots.\n$$\nThus the leading truncation error is $+\\frac{h^{2}}{12} u^{(4)}(x_{i})$, and the constant multiplying $u^{(4)}(x_{i})$ in the local truncation error is $\\frac{1}{12}$.\n\nScheme 2 (five-point explicit symmetric stencil). Consider\n$$\nD^{(2)}_{5} u(x_{i}) \\;=\\; \\frac{1}{h^{2}}\\big( a\\,u(x_{i-2}) + b\\,u(x_{i-1}) + c\\,u(x_{i}) + b\\,u(x_{i+1}) + a\\,u(x_{i+2}) \\big),\n$$\nwith $a$, $b$, $c$ chosen for fourth-order accuracy. Use the Taylor expansions for $k=1,2$:\n\\begin{align*}\nu(x_{i\\pm 1}) = u(x_{i}) \\pm h u^{\\prime}(x_{i}) + \\frac{h^{2}}{2} u^{\\prime\\prime}(x_{i}) \\pm \\frac{h^{3}}{6} u^{(3)}(x_{i}) + \\frac{h^{4}}{24} u^{(4)}(x_{i}) \\pm \\frac{h^{5}}{120} u^{(5)}(x_{i}) + \\frac{h^{6}}{720} u^{(6)}(x_{i}) + \\cdots,\\\\\nu(x_{i\\pm 2}) = u(x_{i}) \\pm 2 h u^{\\prime}(x_{i}) + \\frac{(2 h)^{2}}{2} u^{\\prime\\prime}(x_{i}) \\pm \\frac{(2 h)^{3}}{6} u^{(3)}(x_{i}) + \\frac{(2 h)^{4}}{24} u^{(4)}(x_{i}) \\pm \\frac{(2 h)^{5}}{120} u^{(5)}(x_{i}) + \\frac{(2 h)^{6}}{720} u^{(6)}(x_{i}) + \\cdots\\\\\n= u(x_{i}) \\pm 2 h u^{\\prime}(x_{i}) + 2 h^{2} u^{\\prime\\prime}(x_{i}) \\pm \\frac{4 h^{3}}{3} u^{(3)}(x_{i}) + \\frac{2 h^{4}}{3} u^{(4)}(x_{i}) \\pm \\frac{4 h^{5}}{15} u^{(5)}(x_{i}) + \\frac{8 h^{6}}{45} u^{(6)}(x_{i}) + \\cdots.\n\\end{align*}\nBy symmetry, the odd terms cancel in $D^{(2)}_{5}$. Collecting even terms, we require consistency conditions so that\n$$\nD^{(2)}_{5} u(x_{i}) \\;=\\; u^{\\prime\\prime}(x_{i}) + \\mathcal{O}(h^{4}).\n$$\nMatching the $u(x_{i})$ term yields the zero-sum condition\n$$\n2 a + 2 b + c \\;=\\; 0.\n$$\nMatching the $u^{\\prime\\prime}(x_{i})$ term yields\n$$\n\\frac{1}{h^{2}}\\left( a \\cdot 2 h^{2} + b \\cdot \\frac{h^{2}}{2} + c \\cdot 0 + b \\cdot \\frac{h^{2}}{2} + a \\cdot 2 h^{2} \\right) \\;=\\; u^{\\prime\\prime}(x_{i})\n\\;\\;\\Longrightarrow\\;\\; 4 a + b \\;=\\; 1.\n$$\nTo achieve fourth-order accuracy, the $u^{(4)}(x_{i})$ term must vanish:\n$$\n\\frac{1}{h^{2}}\\left( a \\cdot \\frac{2 h^{4}}{3} + b \\cdot \\frac{h^{4}}{24} + b \\cdot \\frac{h^{4}}{24} + a \\cdot \\frac{2 h^{4}}{3} \\right) \\;=\\; 0\n\\;\\;\\Longrightarrow\\;\\; \\frac{4}{3} a + \\frac{1}{12} b \\;=\\; 0.\n$$\nSolving the linear system\n$$\n\\begin{cases}\n2 a + 2 b + c = 0,\\\\\n4 a + b = 1,\\\\\n\\frac{4}{3} a + \\frac{1}{12} b = 0,\n\\end{cases}\n$$\nthe third equation gives $b = -16 a$. Substituting into $4 a + b = 1$ yields $4 a - 16 a = 1$, so $-12 a = 1$ and $a = -\\frac{1}{12}$. Then $b = -16 a = \\frac{4}{3}$, and from the zero-sum condition $c = -2 a - 2 b = -2\\left(-\\frac{1}{12}\\right) - 2\\left(\\frac{4}{3}\\right) = \\frac{1}{6} - \\frac{8}{3} = -\\frac{5}{2}$. Therefore\n$$\nD^{(2)}_{5} u(x_{i}) \\;=\\; \\frac{1}{h^{2}}\\left( -\\frac{1}{12} u(x_{i-2}) + \\frac{4}{3} u(x_{i-1}) - \\frac{5}{2} u(x_{i}) + \\frac{4}{3} u(x_{i+1}) - \\frac{1}{12} u(x_{i+2}) \\right).\n$$\nBy construction, the $h^{2} u^{(4)}(x_{i})$ term is zero, so the leading truncation error term involves $h^{4} u^{(6)}(x_{i})$. A direct moment calculation confirms that the $u^{(6)}$ coefficient is $-\\frac{1}{90}$, but for the present question, the coefficient multiplying $h^{2} u^{(4)}(x_{i})$ is $0$.\n\nScheme 3 (fourth-order compact tridiagonal scheme). Define $\\{q_{i}\\}$ by\n$$\n\\alpha\\, q_{i-1} + q_{i} + \\alpha\\, q_{i+1} \\;=\\; \\frac{\\beta}{h^{2}}\\big(u(x_{i+1}) - 2 u(x_{i}) + u(x_{i-1})\\big),\n$$\nand choose $\\alpha$, $\\beta$ to maximize formal order. To determine $\\alpha$ and $\\beta$, replace $q_{i}$ by the exact $u^{\\prime\\prime}(x_{i})$ and impose equality of Taylor series coefficients up to terms of order $h^{2}$. Expand\n\\begin{align*}\nu^{\\prime\\prime}(x_{i\\pm 1}) = u^{\\prime\\prime}(x_{i}) \\pm h\\,u^{(3)}(x_{i}) + \\frac{h^{2}}{2} u^{(4)}(x_{i}) \\pm \\frac{h^{3}}{6} u^{(5)}(x_{i}) + \\frac{h^{4}}{24} u^{(6)}(x_{i}) + \\cdots,\\\\\nu(x_{i+1}) - 2 u(x_{i}) + u(x_{i-1}) = h^{2} u^{\\prime\\prime}(x_{i}) + \\frac{h^{4}}{12} u^{(4)}(x_{i}) + \\frach^{6}}{360} u^{(6)}(x_{i}) + \\cdots.\n\\end{align*}\nThus\n\\begin{align*}\n\\alpha \\big( u^{\\prime\\prime}(x_{i-1}) + u^{\\prime\\prime}(x_{i+1}) \\big) + u^{\\prime\\prime}(x_{i})\n= (2 \\alpha + 1) u^{\\prime\\prime}(x_{i}) + \\alpha h^{2} u^{(4)}(x_{i}) + \\frac{\\alpha h^{4}}{12} u^{(6)}(x_{i}) + \\cdots,\\\\\n\\frac{\\beta}{h^{2}} \\big(u(x_{i+1}) - 2 u(x_{i}) + u(x_{i-1})\\big)\n= \\beta u^{\\prime\\prime}(x_{i}) + \\frac{\\beta h^{2}}{12} u^{(4)}(x_{i}) + \\frac{\\beta h^{4}}{360} u^{(6)}(x_{i}) + \\cdots.\n\\end{align*}\nEquating coefficients up to $h^{2}$ yields\n$$\n2 \\alpha + 1 = \\beta, \\qquad \\alpha = \\frac{\\beta}{12}.\n$$\nSolving gives\n$$\n\\beta = \\frac{6}{5}, \\qquad \\alpha = \\frac{1}{10}.\n$$\nTherefore the compact relation is consistent with $u^{\\prime\\prime}(x_{i})$ with no $h^{2} u^{(4)}(x_{i})$ discrepancy; the leading truncation error in $q_{i}$ is of order $h^{4}$ and hence the coefficient multiplying $h^{2} u^{(4)}(x_{i})$ is $0$. For completeness, one can determine the $h^{4} u^{(6)}(x_{i})$ coefficient in $q_{i}$ by positing $q_{i} = u^{\\prime\\prime}(x_{i}) + c h^{4} u^{(6)}(x_{i}) + \\cdots$, substituting into the compact relation, and matching the $h^{4} u^{(6)}(x_{i})$ terms:\n\\begin{align*}\n\\alpha \\big( q_{i-1} + q_{i+1} \\big) + q_{i}\n= (2\\alpha + 1) u^{\\prime\\prime}(x_{i}) + \\alpha \\frac{h^{2}}{2} u^{(4)}(x_{i}) + \\left( \\frac{\\alpha}{12} + c (2 \\alpha + 1) \\right) h^{4} u^{(6)}(x_{i}) + \\cdots,\\\\\n\\frac{\\beta}{h^{2}} \\big(u(x_{i+1}) - 2 u(x_{i}) + u(x_{i-1})\\big)\n= \\beta u^{\\prime\\prime}(x_{i}) + \\frac{\\beta h^{2}}{12} u^{(4)}(x_{i}) + \\frac{\\beta h^{4}}{360} u^{(6)}(x_{i}) + \\cdots,\n\\end{align*}\nand using the already satisfied lower-order identities, we obtain\n$$\n\\frac{\\alpha}{12} + c(2 \\alpha + 1) = \\frac{\\beta}{360} \\;\\;\\Longrightarrow\\;\\; c = \\frac{\\beta/360 - \\alpha/12}{2 \\alpha + 1} = -\\frac{1}{240}.\n$$\nThis confirms fourth-order behavior and a smaller leading constant than the five-point explicit stencil, but crucially the $h^{2} u^{(4)}(x_{i})$ term is still absent.\n\nCollecting the requested leading error constants multiplying $h^{2} u^{(4)}(x_{i})$ in the three schemes, in the order listed:\n- Three-point central difference: $\\frac{1}{12}$.\n- Five-point explicit symmetric stencil: $0$.\n- Fourth-order compact tridiagonal scheme: $0$.\n\nImplications for Richardson extrapolation. Classical Richardson extrapolation targets cancellation of the leading truncation error term, using solutions computed on grids with spacings $h$ and $\\lambda h$ (often $\\lambda=2$). For $D^{(2)}_{3}$, the leading error is $\\frac{h^{2}}{12} u^{(4)}(x_{i})$, so extrapolation with two grids can eliminate the $\\mathcal{O}(h^{2})$ term and yield a fourth-order approximation. In contrast, both the five-point explicit stencil and the fourth-order compact scheme have no $\\mathcal{O}(h^{2})$ term; their leading errors are $\\mathcal{O}(h^{4})$, so Richardson extrapolation aimed at canceling an $h^{2}$ term provides no benefit. If one were to use higher-order extrapolation to cancel the $\\mathcal{O}(h^{4})$ term, knowledge of the $h^{4} u^{(6)}(x_{i})$ constants (e.g., $-\\frac{1}{90}$ for the five-point explicit stencil and $-\\frac{1}{240}$ for the compact scheme) would be required, but that is beyond the scope of the requested constants for $u^{(4)}(x_{i})$.",
            "answer": "$$\\boxed{\\begin{pmatrix}\\frac{1}{12}  0  0\\end{pmatrix}}$$"
        },
        {
            "introduction": "The true power of understanding truncation error lies in its practical application for solution verification. This final exercise demonstrates how the predictable asymptotic structure of the discretization error can be exploited to estimate its magnitude directly from computed solutions on different grids . Deriving this asymptotic error estimator provides a hands-on introduction to the principles behind Richardson extrapolation and offers a powerful method for assessing the accuracy of a numerical simulation without prior knowledge of the exact solution.",
            "id": "3386972",
            "problem": "Consider the one-dimensional Poisson equation, which is a partial differential equation (PDE), posed on the open interval $(0,1)$ with Dirichlet boundary conditions,\n$$\n-u''(x) = f(x), \\quad x \\in (0,1), \\qquad u(0) = 0, \\quad u(1) = 0.\n$$\nAssume the exact solution is known and given by $u(x) = \\sin(\\pi x)$, so that $f(x) = \\pi^{2} \\sin(\\pi x)$. Let $U_{h}$ denote the numerical solution obtained by the standard second-order centered finite difference method on a uniform grid of spacing $h$, and let $U_{h/2}$ denote the numerical solution on the uniform grid of spacing $h/2$. For each interior coarse-grid node $x_{i} = i h$ with integer $i$, let $x_{2i} = 2 i \\frac{h}{2}$ be the corresponding aligned fine-grid node. \n\nStarting from the fundamental definition of consistency and the Taylor expansion of the centered finite difference approximation of the second derivative, derive an asymptotic error expansion of the form $U_{h}(x_{i}) = u(x_{i}) + C(x_{i}) h^{p} + \\mathcal{O}(h^{p+1})$ for some smooth function $C(x)$ and integer order $p \\geq 1$. Using only the computed solutions $U_{h}$ and $U_{h/2}$, and the assumption that the leading error behaves like $C(x) h^{p}$, derive a formula for an asymptotic error estimator at the fine-grid aligned nodes $x_{2i}$ that approximates $U_{h/2}(x_{2i}) - u(x_{2i})$ without requiring $u$. Then, validate the order $p$ for the given model problem with $u(x) = \\sin(\\pi x)$ by analyzing the discrete operatorâ€™s action on the mode $\\sin(\\pi x)$ and determining the leading-order behavior of the grid function error.\n\nYour final answer must be a single closed-form expression for the estimator in terms of $U_{h}$, $U_{h/2}$, and $p$, together with the validated integer value of $p$ for this model problem. If you provide multiple items, write them as a single row matrix. No rounding is required, and no physical units apply.",
            "solution": "The problem asks for two main results: first, a formula for an asymptotic error estimator based on numerical solutions from two different grid spacings, and second, the validation of the order of convergence $p$ for the given model problem. The derivation will be presented in three parts as structured by the problem statement.\n\nPart 1: Derivation of the Asymptotic Error Expansion and Order $p$\n\nThe problem is the one-dimensional Poisson equation $-u''(x) = f(x)$ on $x \\in (0,1)$ with $u(0)=u(1)=0$. The standard second-order centered finite difference method discretizes this equation on a uniform grid $x_i = ih$ for $i=0, 1, \\dots, N$ where $Nh=1$. The discrete operator is $L_h$, defined by its action on a grid function $V$:\n$$\n(L_h V)_i = -\\frac{V_{i+1} - 2V_i + V_{i-1}}{h^2}\n$$\nThe numerical solution $U_h$ is a grid function satisfying $(L_h U_h)_i = f(x_i)$ for $i=1, \\dots, N-1$, with boundary conditions $U_{h,0}=0$ and $U_{h,N}=0$.\n\nTo derive the form of the asymptotic error expansion, we first determine the local truncation error, $\\tau_h(x_i)$, defined as the residual when the exact solution $u(x)$ is applied to the discrete operator:\n$$\n\\tau_h(x_i) = (L_h u)_i - f(x_i) = (L_h u)_i - (-u''(x_i))\n$$\nWe use Taylor series expansions for $u(x_{i+1}) = u(x_i+h)$ and $u(x_{i-1}) = u(x_i-h)$ around the point $x_i$:\n$$\nu(x_i \\pm h) = u(x_i) \\pm h u'(x_i) + \\frac{h^2}{2} u''(x_i) \\pm \\frac{h^3}{6} u'''(x_i) + \\frac{h^4}{24} u^{(4)}(x_i) \\pm \\frac{h^5}{120} u^{(5)}(x_i) + \\frac{h^6}{720} u^{(6)}(x_i) + \\mathcal{O}(h^7)\n$$\nSumming the expansions for $u(x_i+h)$ and $u(x_i-h)$, the odd-powered terms cancel:\n$$\nu(x_i+h) + u(x_i-h) = 2u(x_i) + h^2 u''(x_i) + \\frac{h^4}{12} u^{(4)}(x_i) + \\frac{h^6}{360} u^{(6)}(x_i) + \\mathcal{O}(h^8)\n$$\nRearranging to find the centered difference approximation for $u''(x_i)$:\n$$\n-\\frac{u(x_i+h) - 2u(x_i) + u(x_i-h)}{h^2} = -u''(x_i) - \\frac{h^2}{12} u^{(4)}(x_i) - \\frac{h^4}{360} u^{(6)}(x_i) + \\mathcal{O}(h^6)\n$$\nThus, the truncation error is:\n$$\n\\tau_h(x_i) = \\left(-u''(x_i) - \\frac{h^2}{12} u^{(4)}(x_i) - \\dots \\right) + u''(x_i) = -\\frac{h^2}{12} u^{(4)}(x_i) - \\frac{h^4}{360} u^{(6)}(x_i) + \\mathcal{O}(h^6)\n$$\nThe error grid function, $e_h(x_i) = u(x_i) - U_h(x_i)$, satisfies the discrete system $L_h e_h = \\tau_h$. For a stable method, the global error $e_h$ has the same order in $h$ as the local truncation error $\\tau_h$. Since the leading term of $\\tau_h$ is $\\mathcal{O}(h^2)$, the global error is also $\\mathcal{O}(h^2)$.\nMore formally, the error can be shown to have an asymptotic expansion in even powers of $h$:\n$$\ne_h(x_i) = u(x_i) - U_h(x_i) = C_1(x_i) h^2 + C_2(x_i) h^4 + \\mathcal{O}(h^6)\n$$\nBy rearranging, we get the expansion for the numerical solution $U_h(x_i)$:\n$$\nU_h(x_i) = u(x_i) - C_1(x_i) h^2 - C_2(x_i) h^4 + \\mathcal{O}(h^6)\n$$\nComparing this to the form given in the problem, $U_{h}(x_{i}) = u(x_{i}) + C(x_{i}) h^{p} + \\mathcal{O}(h^{p+1})$, we identify the leading order of convergence as $p=2$ and the smooth function $C(x)$ as $-C_1(x)$.\n\nPart 2: Derivation of the Asymptotic Error Estimator\n\nGiven the asymptotic error expansion with order $p$, we can write expressions for the numerical solution at a point $x_i$ on the coarse grid (spacing $h$) and at the aligned point $x_{2i}$ on the fine grid (spacing $h/2$). Note that $x_{2i} = 2i(h/2) = ih = x_i$. Let the spatial point be denoted by $x$.\n$$\nU_h(x) = u(x) + C(x) h^p + \\mathcal{O}(h^{p+1}) \\quad (1)\n$$\n$$\nU_{h/2}(x) = u(x) + C(x) \\left(\\frac{h}{2}\\right)^p + \\mathcal{O}(h^{p+1}) = u(x) + C(x) \\frac{h^p}{2^p} + \\mathcal{O}(h^{p+1}) \\quad (2)\n$$\nThe goal is to find an estimator for the error on the fine grid, $E_{h/2}(x) = U_{h/2}(x) - u(x)$, which from equation $(2)$ is approximately $C(x) h^p / 2^p$. We must eliminate the unknown quantities $u(x)$ and $C(x)$ using only the computed solutions $U_h(x)$ and $U_{h/2}(x)$.\n\nSubtracting equation $(2)$ from equation $(1)$:\n$$\nU_h(x) - U_{h/2}(x) = \\left( u(x) + C(x) h^p \\right) - \\left( u(x) + C(x) \\frac{h^p}{2^p} \\right) + \\mathcal{O}(h^{p+1})\n$$\n$$\nU_h(x) - U_{h/2}(x) = C(x)h^p \\left(1 - \\frac{1}{2^p}\\right) + \\mathcal{O}(h^{p+1})\n$$\nWe can solve for the term $C(x)h^p$:\n$$\nC(x)h^p = \\frac{U_h(x) - U_{h/2}(x)}{1 - 2^{-p}} + \\mathcal{O}(h^{p+1}) = \\frac{2^p}{2^p - 1} (U_h(x) - U_{h/2}(x)) + \\mathcal{O}(h^{p+1})\n$$\nThe leading term of the error on the fine grid is $E_{h/2}(x) \\approx C(x) (h/2)^p = C(x)h^p / 2^p$. Substituting the expression for $C(x)h^p$:\n$$\nE_{h/2}(x) \\approx \\frac{1}{2^p} \\left( \\frac{2^p}{2^p - 1} (U_h(x) - U_{h/2}(x)) \\right) = \\frac{U_h(x) - U_{h/2}(x)}{2^p - 1}\n$$\nThus, the asymptotic error estimator, which we denote $\\mathcal{E}_{h/2}$, at the fine-grid aligned nodes $x_{2i}$ is:\n$$\n\\mathcal{E}_{h/2}(x_{2i}) = \\frac{U_h(x_i) - U_{h/2}(x_{2i})}{2^p - 1}\n$$\n\nPart 3: Validation of the Order $p$ for the Model Problem\n\nFor the given model problem, the exact solution is $u(x) = \\sin(\\pi x)$ and the source term is $f(x) = \\pi^2 \\sin(\\pi x)$. The discrete system is $(L_h U_h)_i = \\pi^2 \\sin(\\pi x_i)$. We analyze the action of the discrete operator $L_h$ on the grid function $v_i = \\sin(\\pi x_i) = \\sin(\\pi i h)$.\n$$\n(L_h v)_i = -\\frac{\\sin(\\pi(i+1)h) - 2\\sin(\\pi i h) + \\sin(\\pi(i-1)h)}{h^2}\n$$\nUsing the trigonometric identity $\\sin(A+B)+\\sin(A-B) = 2\\sin(A)\\cos(B)$ with $A = \\pi i h$ and $B = \\pi h$:\n$$\n\\sin(\\pi(i+1)h) + \\sin(\\pi(i-1)h) = 2\\sin(\\pi i h)\\cos(\\pi h)\n$$\nSubstituting this into the expression for $(L_h v)_i$:\n$$\n(L_h v)_i = -\\frac{2\\sin(\\pi i h)\\cos(\\pi h) - 2\\sin(\\pi i h)}{h^2} = \\left(\\frac{2(1-\\cos(\\pi h))}{h^2}\\right) \\sin(\\pi i h)\n$$\nThis shows that $v_i = \\sin(\\pi x_i)$ is an eigenvector of the discrete operator $L_h$ with eigenvalue $\\lambda_h = \\frac{2(1-\\cos(\\pi h))}{h^2}$.\nThe discrete system is $L_h U_h = \\pi^2 v$. Since the right-hand side is an eigenvector, the solution $U_h$ must be a multiple of that eigenvector, i.e., $U_{h,i} = A v_i$ for some constant $A$. Applying $L_h$ to this solution gives $L_h U_{h,i} = A \\lambda_h v_i$.\nEquating this to the right-hand side yields $A \\lambda_h v_i = \\pi^2 v_i$, so $A = \\pi^2 / \\lambda_h$.\nThe exact numerical solution is therefore $U_{h,i} = \\frac{\\pi^2}{\\lambda_h} \\sin(\\pi x_i)$.\n\nThe error is $U_{h,i} - u(x_i) = \\frac{\\pi^2}{\\lambda_h} \\sin(\\pi x_i) - \\sin(\\pi x_i) = \\left(\\frac{\\pi^2}{\\lambda_h} - 1\\right)\\sin(\\pi x_i)$.\nTo find the leading order behavior, we expand $\\lambda_h$ for small $h$ using the Taylor series for $\\cos(\\theta) = 1 - \\frac{\\theta^2}{2!} + \\frac{\\theta^4}{4!} - \\mathcal{O}(\\theta^6)$ with $\\theta = \\pi h$:\n$$\n\\lambda_h = \\frac{2}{h^2}\\left(1 - \\left(1 - \\frac{(\\pi h)^2}{2} + \\frac{(\\pi h)^4}{24} - \\mathcal{O}(h^6)\\right)\\right) = \\frac{2}{h^2}\\left(\\frac{\\pi^2 h^2}{2} - \\frac{\\pi^4 h^4}{24} + \\mathcal{O}(h^6)\\right) = \\pi^2 - \\frac{\\pi^4 h^2}{12} + \\mathcal{O}(h^4)\n$$\nNow we analyze the error coefficient:\n$$\n\\frac{\\pi^2}{\\lambda_h} - 1 = \\frac{\\pi^2}{\\pi^2 - \\frac{\\pi^4 h^2}{12} + \\mathcal{O}(h^4)} - 1 = \\frac{1}{1 - \\frac{\\pi^2 h^2}{12} + \\mathcal{O}(h^4)} - 1\n$$\nUsing the geometric series approximation $(1-z)^{-1} = 1 + z + z^2 + \\dots$ for small $z = \\frac{\\pi^2 h^2}{12} + \\mathcal{O}(h^4)$:\n$$\n\\frac{\\pi^2}{\\lambda_h} - 1 = \\left(1 + \\frac{\\pi^2 h^2}{12} + \\mathcal{O}(h^4)\\right) - 1 = \\frac{\\pi^2 h^2}{12} + \\mathcal{O}(h^4)\n$$\nThe error is therefore:\n$$\nU_h(x_i) - u(x_i) = \\left(\\frac{\\pi^2 h^2}{12} + \\mathcal{O}(h^4)\\right) \\sin(\\pi x_i) = \\left(\\frac{\\pi^2}{12}\\sin(\\pi x_i)\\right)h^2 + \\mathcal{O}(h^4)\n$$\nThis result rigorously validates that for this model problem, the error expansion has a leading term of order $h^2$, confirming that the integer order is $p=2$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{U_h(x_i) - U_{h/2}(x_{2i})}{2^p - 1}  2 \\endpmatrix}}\n$$"
        }
    ]
}