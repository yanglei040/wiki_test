{
    "hands_on_practices": [
        {
            "introduction": "理解任何数值格式的性能，关键在于分析其如何影响不同波长的谐波分量。本练习将引导你通过傅里葉（von Neumann）分析，推导双步Lax-Wendroff格式的放大因子。通过计算数值相速度并量化其与真实速度的差异，你将亲身体会到该格式的色散特性，这是理解Lax-Wendroff解中常见振荡现象的基础。",
            "id": "3414428",
            "problem": "考虑常平流速度 $a0$ 且定义在周期性空间域上的线性平流偏微分方程 (PDE) $u_{t} + a\\,u_{x} = 0$。设空间网格为 $x_{j} = j\\,\\Delta x$，时间层级为 $t^{n} = n\\,\\Delta t$，并定义 Courant–Friedrichs–Lewy (CFL) 数 $\\lambda = \\dfrac{a\\,\\Delta t}{\\Delta x}$。使用两步 Lax–Wendroff (也称为 Richtmyer 两步) 格式离散此偏微分方程：\n- 预测步 (在单元格面上的半个时间步)：$u_{j+\\frac{1}{2}}^{n+\\frac{1}{2}} = \\dfrac{1}{2}\\left(u_{j+1}^{n} + u_{j}^{n}\\right) - \\dfrac{a\\,\\Delta t}{2\\,\\Delta x}\\left(u_{j+1}^{n} - u_{j}^{n}\\right)$,\n- 校正步 (在单元格中心的一个完整时间步)：$u_{j}^{n+1} = u_{j}^{n} - \\dfrac{a\\,\\Delta t}{\\Delta x}\\left(u_{j+\\frac{1}{2}}^{n+\\frac{1}{2}} - u_{j-\\frac{1}{2}}^{n+\\frac{1}{2}}\\right)$。\n\n使用傅里叶 (von Neumann) 模态 ansatz $u_{j}^{n} = \\hat{u}^{n}\\,\\exp(i\\,j\\,\\theta)$，其中无量纲波数 $\\theta \\in (-\\pi,\\pi]$，推导由 $\\hat{u}^{n+1} = G(\\theta,\\lambda)\\,\\hat{u}^{n}$ 定义的放大因子 $G(\\theta,\\lambda)$。然后，采用与精确模态演化 $G_{\\text{exact}} = \\exp(-i\\,a\\,k\\,\\Delta t)$ (其中 $k = \\theta/\\Delta x$) 一致的约定，将数值相速度 $c_{p}(\\theta)$ 定义为\n$$\nc_{p}(\\theta) \\equiv -\\,\\frac{\\Delta x}{\\theta}\\,\\frac{\\Arg\\!\\big(G(\\theta,\\lambda)\\big)}{\\Delta t},\n$$\n其中 $\\Arg$ 是 $(-\\pi,\\pi]$ 上的主辐角。最后，通过无量纲函数量化相对于 $a$ 的相误差\n$$\n\\varepsilon(\\theta,\\lambda) \\equiv \\frac{c_{p}(\\theta)}{a} - 1,\n$$\n并提供一个仅用 $\\theta$ 和 $\\lambda$ 表示的 $\\varepsilon(\\theta,\\lambda)$ 的单一闭式解析表达式，该表达式只使用初等函数和主辐角函数。您的最终答案必须是这个表达式；不要包含任何中间步骤。无需四舍五入，也不应报告单位。假设 $0\\lambda\\leq 1$ 和 $\\theta \\in (-\\pi,\\pi]$。",
            "solution": "问题陈述已经过验证，被认为是科学合理的、适定的和客观的。它提出了一个针对基本偏微分方程的著名数值方法的 von Neumann 稳定性和色散分析的标准练习。所有提供的定义、常数和约束都是自洽和一致的。该问题是有效的，将立即推导出解答。\n\n目标是推导应用于线性平流方程 $u_{t} + a\\,u_{x} = 0$ 的两步 Lax-Wendroff 格式的相对相误差 $\\varepsilon(\\theta,\\lambda)$ 的表达式。推导过程分三个主要阶段进行：首先，确定格式的放大因子 $G(\\theta,\\lambda)$；其次，计算数值相速度 $c_p(\\theta)$；最后，构建相对相误差 $\\varepsilon(\\theta,\\lambda)$ 的公式。\n\n首先，我们将傅里叶模态 ansatz $u_{j}^{n} = \\hat{u}^{n}\\,\\exp(i\\,j\\,\\theta)$ 代入给定数值格式的两个步骤中，以确定放大因子 $G(\\theta,\\lambda)$。\n\n预测步由下式给出：\n$$\nu_{j+\\frac{1}{2}}^{n+\\frac{1}{2}} = \\dfrac{1}{2}\\left(u_{j+1}^{n} + u_{j}^{n}\\right) - \\dfrac{a\\,\\Delta t}{2\\,\\Delta x}\\left(u_{j+1}^{n} - u_{j}^{n}\\right)\n$$\n代入 ansatz 和 CFL 数的定义 $\\lambda = \\frac{a\\,\\Delta t}{\\Delta x}$，我们得到：\n$$\nu_{j+\\frac{1}{2}}^{n+\\frac{1}{2}} = \\dfrac{1}{2}\\left(\\hat{u}^{n}\\,\\exp(i(j+1)\\theta) + \\hat{u}^{n}\\,\\exp(ij\\theta)\\right) - \\dfrac{\\lambda}{2}\\left(\\hat{u}^{n}\\,\\exp(i(j+1)\\theta) - \\hat{u}^{n}\\,\\exp(ij\\theta)\\right)\n$$\n提出公因子 $\\hat{u}^{n}\\,\\exp(ij\\theta)$：\n$$\nu_{j+\\frac{1}{2}}^{n+\\frac{1}{2}} = \\hat{u}^{n}\\,\\exp(ij\\theta) \\left[ \\dfrac{1}{2}\\left(\\exp(i\\theta) + 1\\right) - \\dfrac{\\lambda}{2}\\left(\\exp(i\\theta) - 1\\right) \\right]\n$$\n对于校正步，我们还需要 $u_{j-\\frac{1}{2}}^{n+\\frac{1}{2}}$ 处的值，这可以通过将预测步应用于网格点 $j-1$ 和 $j$ 来找到：\n$$\nu_{j-\\frac{1}{2}}^{n+\\frac{1}{2}} = \\dfrac{1}{2}\\left(u_{j}^{n} + u_{j-1}^{n}\\right) - \\dfrac{\\lambda}{2}\\left(u_{j}^{n} - u_{j-1}^{n}\\right)\n$$\n代入 ansatz 得到：\n$$\nu_{j-\\frac{1}{2}}^{n+\\frac{1}{2}} = \\hat{u}^{n}\\,\\exp(ij\\theta) \\left[ \\dfrac{1}{2}\\left(1 + \\exp(-i\\theta)\\right) - \\dfrac{\\lambda}{2}\\left(1 - \\exp(-i\\theta)\\right) \\right]\n$$\n接下来，我们将这些预测值的表达式代入校正步：\n$$\nu_{j}^{n+1} = u_{j}^{n} - \\lambda\\left(u_{j+\\frac{1}{2}}^{n+\\frac{1}{2}} - u_{j-\\frac{1}{2}}^{n+\\frac{1}{2}}\\right)\n$$\n将 ansatz 代入左侧的 $u_{j}^{n+1} = \\hat{u}^{n+1}\\,\\exp(ij\\theta)$，并将推导出的表达式代入右侧，我们得到：\n$$\n\\hat{u}^{n+1}\\,\\exp(ij\\theta) = \\hat{u}^{n}\\,\\exp(ij\\theta) - \\lambda \\left( \\hat{u}^{n}\\,\\exp(ij\\theta) \\left[ \\dots \\right] - \\hat{u}^{n}\\,\\exp(ij\\theta) \\left[ \\dots \\right] \\right)\n$$\n两边同除以 $\\hat{u}^{n}\\,\\exp(ij\\theta)$ 得到放大因子 $G(\\theta,\\lambda) = \\hat{u}^{n+1}/\\hat{u}^{n}$：\n$$\nG(\\theta,\\lambda) = 1 - \\lambda \\left( \\left[ \\dfrac{1}{2}(\\exp(i\\theta) + 1) - \\dfrac{\\lambda}{2}(\\exp(i\\theta) - 1)\\right] - \\left[ \\dfrac{1}{2}(1 + \\exp(-i\\theta)) - \\dfrac{\\lambda}{2}(1 - \\exp(-i\\theta))\\right] \\right)\n$$\n我们简化大括号内的项：\n$$\n\\left( \\dfrac{1}{2}\\exp(i\\theta) + \\dfrac{1}{2} - \\dfrac{\\lambda}{2}\\exp(i\\theta) + \\dfrac{\\lambda}{2} \\right) - \\left( \\dfrac{1}{2} + \\dfrac{1}{2}\\exp(-i\\theta) - \\dfrac{\\lambda}{2} + \\dfrac{\\lambda}{2}\\exp(-i\\theta) \\right)\n$$\n$$\n= \\dfrac{1-\\lambda}{2}\\exp(i\\theta) + \\dfrac{1+\\lambda}{2} - \\dfrac{1-\\lambda}{2} - \\dfrac{1+\\lambda}{2}\\exp(-i\\theta)\n$$\n$$\n= \\dfrac{1-\\lambda}{2}\\exp(i\\theta) - \\dfrac{1+\\lambda}{2}\\exp(-i\\theta) + \\lambda\n$$\n将此代回 $G$ 的表达式中：\n$$\nG(\\theta,\\lambda) = 1 - \\lambda \\left( \\dfrac{1-\\lambda}{2}\\exp(i\\theta) - \\dfrac{1+\\lambda}{2}\\exp(-i\\theta) + \\lambda \\right)\n$$\n$$\nG(\\theta,\\lambda) = 1 - \\lambda^2 - \\dfrac{\\lambda(1-\\lambda)}{2}\\exp(i\\theta) + \\dfrac{\\lambda(1+\\lambda)}{2}\\exp(-i\\theta)\n$$\n为了求出实部和虚部，我们使用欧拉公式 $\\exp(\\pm i\\theta) = \\cos(\\theta) \\pm i\\sin(\\theta)$。\n$$\n\\operatorname{Re}(G) = 1 - \\lambda^2 - \\dfrac{\\lambda(1-\\lambda)}{2}\\cos(\\theta) + \\dfrac{\\lambda(1+\\lambda)}{2}\\cos(\\theta) = 1 - \\lambda^2 + \\cos(\\theta)\\left[\\dfrac{-\\lambda+\\lambda^2+\\lambda+\\lambda^2}{2}\\right]\n$$\n$$\n\\operatorname{Re}(G) = 1 - \\lambda^2 + \\lambda^2\\cos(\\theta) = 1 - \\lambda^2(1-\\cos(\\theta))\n$$\n使用半角恒等式 $1-\\cos(\\theta) = 2\\sin^2(\\theta/2)$，我们发现：\n$$\n\\operatorname{Re}(G) = 1 - 2\\lambda^2\\sin^2\\left(\\frac{\\theta}{2}\\right)\n$$\n对于虚部：\n$$\n\\operatorname{Im}(G) = - \\dfrac{\\lambda(1-\\lambda)}{2}\\sin(\\theta) - \\dfrac{\\lambda(1+\\lambda)}{2}\\sin(\\theta) = -\\sin(\\theta)\\left[\\dfrac{\\lambda-\\lambda^2+\\lambda+\\lambda^2}{2}\\right]\n$$\n$$\n\\operatorname{Im}(G) = -\\lambda\\sin(\\theta)\n$$\n因此，放大因子为：\n$$\nG(\\theta,\\lambda) = 1 - 2\\lambda^2\\sin^2\\left(\\frac{\\theta}{2}\\right) - i\\lambda\\sin(\\theta)\n$$\n第二阶段是计算数值相速度 $c_p(\\theta)$，其定义为：\n$$\nc_{p}(\\theta) = -\\,\\frac{\\Delta x}{\\theta}\\,\\frac{\\Arg\\!\\big(G(\\theta,\\lambda)\\big)}{\\Delta t}\n$$\n使用关系式 $\\lambda = a\\Delta t / \\Delta x$，可以重新排列为 $\\Delta x/\\Delta t = a/\\lambda$，我们得到：\n$$\nc_{p}(\\theta) = -\\,\\frac{a}{\\lambda\\theta}\\Arg\\!\\big(G(\\theta,\\lambda)\\big)\n$$\n第三个也是最后一个阶段是求相对相误差 $\\varepsilon(\\theta,\\lambda)$：\n$$\n\\varepsilon(\\theta,\\lambda) = \\frac{c_{p}(\\theta)}{a} - 1\n$$\n代入 $c_p(\\theta)$ 的表达式：\n$$\n\\varepsilon(\\theta,\\lambda) = \\frac{1}{a}\\left(-\\,\\frac{a}{\\lambda\\theta}\\Arg\\!\\big(G(\\theta,\\lambda)\\big)\\right) - 1 = -\\frac{1}{\\lambda\\theta}\\Arg\\!\\big(G(\\theta,\\lambda)\\big) - 1\n$$\n最后，我们代入推导出的 $G(\\theta,\\lambda)$ 的表达式，以获得相对相误差的最终答案：\n$$\n\\varepsilon(\\theta,\\lambda) = -\\frac{1}{\\lambda\\theta} \\Arg\\!\\left(1 - 2\\lambda^2\\sin^2\\left(\\frac{\\theta}{2}\\right) - i\\lambda\\sin(\\theta)\\right) - 1\n$$\n此表达式以无量纲参数 $\\theta$ 和 $\\lambda$ 表示，并且仅使用初等函数和主辐角函数 $\\Arg$，符合要求。",
            "answer": "$$\n\\boxed{-\\frac{1}{\\lambda\\theta} \\Arg\\!\\left(1 - 2\\lambda^2\\sin^2\\left(\\frac{\\theta}{2}\\right) - i\\lambda\\sin(\\theta)\\right) - 1}\n$$"
        },
        {
            "introduction": "尽管我们常使用线性平流方程来分析数值格式，但这些格式的真正威力在于求解非线性守恒律。本练习探讨了将稳定性条件（Courant-Friedrichs-Lewy, CFL 条件）推广到非线性情况的关键一步。这要求我们考虑整个求解域上的局部波速，从而确保数值解在复杂流动中保持稳定。",
            "id": "3414458",
            "problem": "考虑标量守恒律 $u_t + f(u)_x = 0$，其通量 $f \\in C^2(\\mathbb{R})$ 是光滑的，该方程通过两步Lax–Wendroff (Richtmyer)格式在均匀网格 $x_j = j \\,\\Delta x$, $t^n = n \\,\\Delta t$ 上进行离散：\n$$\nu_{j+\\frac{1}{2}}^{n+\\frac{1}{2}} = \\frac{1}{2}\\big(u_{j+1}^n + u_j^n\\big) - \\frac{\\Delta t}{2 \\,\\Delta x}\\Big(f(u_{j+1}^n)-f(u_j^n)\\Big),\n$$\n$$\nu_j^{n+1} = u_j^n - \\frac{\\Delta t}{\\Delta x}\\Big(f\\big(u_{j+\\frac{1}{2}}^{n+\\frac{1}{2}}\\big) - f\\big(u_{j-\\frac{1}{2}}^{n+\\frac{1}{2}}\\big)\\Big).\n$$\n从特征线法可知，局部波速即为特征速度 $a(x,t) = f'(u(x,t))$。对于具有恒定速度 $a$ 的线性平流问题，对Lax–Wendroff格式进行von Neumann分析会得到关于Courant数的稳定性限制。在非线性情况下，一种常见的方法是通过在当前状态附近进行线性化来“冻结”系数，然后基于每个时间层的最大局部特征速度来施加稳定性限制。利用此原理，根据空间网格和最大局部特征速度，定义在时间层 $n$ 的非线性Courant–Friedrichs–Lewy (CFL)数，并确定如何选择时间步长 $\\Delta t$，以使格式在空间和时间上一致稳定。\n\n对于定义这样一个非线性CFL数并选择 $\\Delta t$ 以确保两步Lax–Wendroff格式在空间和时间上一致稳定，以下哪些陈述是有效的？\n\nA. 将非线性CFL数 $C^n$ 定义为网格比 $\\Delta t/\\Delta x$ 与时间层 $n$ 上局部特征速度绝对值关于 $j$ 的最大值的乘积，然后通过选择 $\\Delta t^n = \\nu \\,\\Delta x / \\max_j |f'(u_j^n)|$ 来施加一个固定界限 $C^n \\le \\nu$（其中常数 $0  \\nu \\le 1$）。这在每个时间步上产生一个（关于 $j$）一致的稳定性限制，并通过保持相同的 $\\nu$ 来控制所有时间的稳定性。\n\nB. 使用特征速度的空间平均值来定义非线性CFL数，即，在一个包含 $N$ 个单元的网格上，设 $C^n := (\\Delta t/\\Delta x) \\left|\\frac{1}{N}\\sum_j f'(u_j^n)\\right|$，并选择 $\\Delta t^n = \\nu \\,\\Delta x / \\left|\\frac{1}{N}\\sum_j f'(u_j^n)\\right|$（其中固定常数 $0  \\nu \\le 1$）。这种平均处理保证了空间和时间上的一致稳定性，因为局部的大速度会被其他地方的小速度所补偿。\n\nC. 使用特征速度的最小绝对值来定义非线性CFL数，即 $C^n := (\\Delta t/\\Delta x)\\min_j |f'(u_j^n)|$，并选择 $\\Delta t^n = \\nu \\,\\Delta x / \\min_j |f'(u_j^n)|$（其中固定常数 $0  \\nu \\le 1$）。这对于一致稳定性是充分的，因为该格式是中心格式且具有二阶精度。\n\nD. 如果存在一个先验不变范围 $I \\subset \\mathbb{R}$，使得对于所有的 $j$ 和 $n$ 都有 $u_j^n \\in I$，那么可以定义 $a_* := \\sup_{u\\in I} |f'(u)|$ 并选择一个恒定的时间步长 $\\Delta t = \\nu \\,\\Delta x / a_*$（其中固定常数 $0  \\nu \\le 1$），这确保了非线性CFL数在所有时间都以 $\\nu$ 为界，从而在空间和时间上产生一致稳定性。\n\nE. 因为两步Lax–Wendroff格式是二阶的，所以对于光滑通量 $f$，无论 $\\Delta t/\\Delta x$ 的大小如何，它都是无条件稳定的，因此要获得空间和时间上的一致稳定性，无需CFL限制。",
            "solution": "对于双曲型偏微分方程，显式有限差分格式的稳定性由Courant-Friedrichs-Lewy (CFL)条件决定。该条件规定，点 $(x_j, t^{n+1})$ 的数值依赖域必须包含物理依赖域。对于具有恒定速度 $a$ 的线性平流方程 $u_t + a u_x = 0$，Lax-Wendroff格式当且仅当Courant数 $\\nu = |a| \\frac{\\Delta t}{\\Delta x}$ 满足 $\\nu \\le 1$ 时稳定。\n\n对于非线性守恒律 $u_t + f(u)_x = 0$，特征速度 $a(u) = f'(u)$ 不是常数，而是依赖于解 $u$。问题指导我们使用冻结系数的原理。这意味着我们在每个时间步 $t^n$ 将问题局部地看作一系列线性平流问题，其中每个网格点 $x_j$ 的速度由 $a_j^n = f'(u_j^n)$ 给出。\n\n为了确保在从 $t^n$ 到 $t^{n+1}$ 的时间步长内整个空间域的稳定性，时间步长 $\\Delta t$ 必须足够小，以满足在时间 $t^n$ 数值解中存在的最快波速的稳定性条件。局部特征速度的最大绝对值为 $\\max_j |a_j^n| = \\max_j |f'(u_j^n)|$。\n\n因此，必须在每个时间步 $n$ 满足的非线性CFL条件是：\n$$ \\frac{\\Delta t}{\\Delta x} \\max_j |f'(u_j^n)| \\le \\nu_{\\text{max}} $$\n对于Lax-Wendroff格式，线性稳定性分析得出 $\\nu_{\\text{max}} = 1$。在实践中，通常会使用一个安全系数，因此条件写为：\n$$ C^n := \\frac{\\Delta t}{\\Delta x} \\max_j |f'(u_j^n)| \\le \\nu $$\n其中 $C^n$ 是时间层 $n$ 的非线性CFL数，$\\nu$ 是一个选择为 $0  \\nu \\le 1$ 的常数。为了确保所有时间的稳定性，这个条件必须在每个时间步强制执行，这通常导致一个随着解的演化而变化的自适应时间步长 $\\Delta t^n$。\n\n我们现在基于这个原则评估每个选项。\n\n**A. 将非线性CFL数 $C^n$ 定义为网格比 $\\Delta t/\\Delta x$ 与时间层 $n$ 上局部特征速度绝对值关于 $j$ 的最大值的乘积，然后通过选择 $\\Delta t^n = \\nu \\,\\Delta x / \\max_j |f'(u_j^n)|$ 来施加一个固定界限 $C^n \\le \\nu$（其中常数 $0  \\nu \\le 1$）。这在每个时间步上产生一个（关于 $j$）一致的稳定性限制，并通过保持相同的 $\\nu$ 来控制所有时间的稳定性。**\n\n该陈述正确地将非线性CFL数确定为 $C^n = (\\Delta t / \\Delta x) \\max_j |f'(u_j^n)|$。它正确地应用了稳定性由最大波速决定的原则。通过在每个时间层 $n$ 选择时间步长 $\\Delta t^n = \\nu \\,\\Delta x / \\max_j |f'(u_j^n)|$，CFL数恰好变为 $C^n = \\nu$，满足稳定性约束 $C^n \\le \\nu$。这种自适应时间步长策略是确保非线性双曲问题稳定性的标准且有效的方法。对其效果的描述是准确的。\n**结论：正确**\n\n**B. 使用特征速度的空间平均值来定义非线性CFL数，即，在一个包含 $N$ 个单元的网格上，设 $C^n := (\\Delta t/\\Delta x) \\left|\\frac{1}{N}\\sum_j f'(u_j^n)\\right|$，并选择 $\\Delta t^n = \\nu \\,\\Delta x / \\left|\\frac{1}{N}\\sum_j f'(u_j^n)\\right|$（其中固定常数 $0  \\nu \\le 1$）。这种平均处理保证了空间和时间上的一致稳定性，因为局部的大速度会被其他地方的小速度所补偿。**\n\n这种方法有根本性缺陷。稳定性是一个局部条件。如果单一点 $x_j$ 的波传播非常快（即 $|f'(u_j^n)|$ 很大），时间步长 $\\Delta t$ 必须足够小以捕捉这种传播。如果在 $f'(u)$ 中存在显著变化，对整个域的速度进行平均可能会严重低估所需的时间步长限制。一个区域的大局部速度不会被其他地方的小速度“补偿”；它仍然会导致违反依赖域并引起数值不稳定性。\n**结论：不正确**\n\n**C. 使用特征速度的最小绝对值来定义非线性CFL数，即 $C^n := (\\Delta t/\\Delta x)\\min_j |f'(u_j^n)|$，并选择 $\\Delta t^n = \\nu \\,\\Delta x / \\min_j |f'(u_j^n)|$（其中固定常数 $0  \\nu \\le 1$）。这对于一致稳定性是充分的，因为该格式是中心格式且具有二阶精度。**\n\n这与正确的程序相反。使用最小速度来确定时间步长将允许一个过大的 $\\Delta t$（如果存在高速区域），从而导致立即的不稳定性。稳定性总是受限于最快的过程，而不是最慢的。声称这是充分的，因为格式是二阶精度，这是一个不合逻辑的推论；精度属性不保证稳定性，尤其是一个不正确的稳定性准则。\n**结论：不正确**\n\n**D. 如果存在一个先验不变范围 $I \\subset \\mathbb{R}$，使得对于所有的 $j$ 和 $n$ 都有 $u_j^n \\in I$，那么可以定义 $a_* := \\sup_{u\\in I} |f'(u)|$ 并选择一个恒定的时间步长 $\\Delta t = \\nu \\,\\Delta x / a_*$（其中固定常数 $0  \\nu \\le 1$），这确保了非线性CFL数在所有时间都以 $\\nu$ 为界，从而在空间和时间上产生一致稳定性。**\n\n该陈述描述了一种有效但更具限制性的方法。如果解 $u$ 的一个不变集 $I$ 是先验已知的，那么可以找到波速大小的全局上界，$a_* = \\sup_{u \\in I} |f'(u)|$。由于对所有 $j$ 和 $n$ 都有 $u_j^n \\in I$，因此对于所有时间步 $n$，都有 $\\max_j |f'(u_j^n)| \\le a_*$。如果选择一个恒定的时间步长 $\\Delta t = \\nu \\Delta x / a_*$，那么对于任何时间层 $n$，CFL数为：\n$$ C^n = \\frac{\\Delta t}{\\Delta x} \\max_j |f'(u_j^n)| = \\frac{\\nu \\Delta x / a_*}{\\Delta x} \\max_j |f'(u_j^n)| = \\nu \\frac{\\max_j |f'(u_j^n)|}{a_*} $$\n因为 $\\max_j |f'(u_j^n)| \\le a_*$，我们有 $C^n \\le \\nu$。因此，CFL条件对于所有时间都用一个单一的、恒定的时间步长得到满足。当这样的界 $a_*$ 可用时，这是一种正确且通常实用的方法。\n**结论：正确**\n\n**E. 因为两步Lax–Wendroff格式是二阶的，所以对于光滑通量 $f$，无论 $\\Delta t/\\Delta x$ 的大小如何，它都是无条件稳定的，因此要获得空间和时间上的一致稳定性，无需CFL限制。**\n\n该陈述是错误的。精度阶数和稳定性是数值格式的两个不同属性。对于双曲问题，像Lax-Wendroff这样的显式格式是条件稳定的，而非无条件稳定的。无条件稳定性通常是隐式格式的特点。Lax-Wendroff的线性稳定性分析严格证明了它仅在CFL条件 $|a| \\Delta t / \\Delta x \\le 1$ 下稳定。只有当格式稳定时才能达到二阶精度。\n**结论：不正确**\n\n总之，陈述A和D都描述了确保非线性守恒律的Lax-Wendroff格式稳定性的有效方法。陈述A描述了一种自适应时间步长方法，它更通用，而陈述D描述了一种在解的已知不变域这一更严格假设下有效的恒定时间步长方法。",
            "answer": "$$\\boxed{AD}$$"
        },
        {
            "introduction": "最后的练习将理论付诸代码，挑战一个逆向设计问题。你将不再仅仅分析给定网格上的误差，而是要在非均匀网格上实现该格式，并优化网格本身，以最小化特定波包的色散误差。这个练习有力地展示了如何利用计算方法主动提升模拟的保真度。",
            "id": "3414438",
            "problem": "考虑线性平流偏微分方程 (PDE) $u_t + a\\,u_x = 0$，其定义在周期性域 $x \\in [0,L)$ 上，并具有恒定的平流速度 $a \\in \\mathbb{R}$。初始条件是一个窄带波包，中心位于 $x_c$，载波波数为 $k_0$，高斯包络宽度为 $\\sigma$，由 $u(x,0) = \\exp\\!\\big(-d(x;x_c)^2/(2\\sigma^2)\\big)\\,\\cos\\!\\big(k_0\\,d(x;x_c)\\big)$ 给出。其中 $d(x;x_c)$ 是周长为 $L$ 的圆上的周期性距离，定义为 $d(x;x_c) = ((x-x_c) + L/2 \\mod L) - L/2$。根据平移不变性，精确解为 $u(x,t) = u(x - a t, 0)$。需要在非均匀网格上构建和分析两步 Lax-Wendroff (LW) 格式。\n\n您的任务是提出并解决一个逆向设计问题：选择一个非均匀网格 $\\{x_i\\}_{i=0}^{N-1}$，以最小化波包在固定的时间范围 $T$ 内演化后的色散误差。该非均匀网格由一个从均匀计算坐标 $\\xi \\in [0,1)$到$x \\in [0,L)$的光滑单调映射参数化：\n$$\nx(\\xi; \\alpha,\\beta) = L\\left[\\xi + \\frac{\\alpha}{2\\pi}\\sin(2\\pi \\xi) + \\frac{\\beta}{4\\pi}\\sin(4\\pi \\xi)\\right],\n$$\n其中 $\\xi_i = \\frac{i}{N}$，对于 $i=0,\\dots,N-1$。参数 $(\\alpha,\\beta)$ 必须满足 $|\\alpha| + |\\beta|  1$ 以确保单调性。离散节点集为 $x_i = x(\\xi_i;\\alpha,\\beta)$，其在模 $L$ 意义下是严格递增的。\n\n使用以下基于原理的步骤，在该非均匀网格上构建两步 Lax-Wendroff (LW) 格式：\n1. 从 PDE $u_t = -a\\,u_x$ 和中点时间积分公式 $u^{n+1} = u^n + \\Delta t\\,u_t(t^n + \\Delta t/2) + \\mathcal{O}(\\Delta t^3)$ 出发，其中 $u_t$ 通过预估步在时间中点处求值。\n2. 使用通过非均匀节点上的二次插值导出的二阶精度中心差分公式来近似网格节点 $x_i$ 处的空间导数 $u_x$，该公式涉及相邻间距 $h_- = x_i - x_{i-1}$ 和 $h_+ = x_{i+1} - x_i$（在边界处进行周期性环绕处理）。\n3. 在空间和时间上一致地使用周期性边界条件。\n\n将时间 $T$ 时演化后的数值解 $u_i^{n}$ 的色散误差定义为载波的相位误差。该相位误差通过加权最小二乘拟合提取，权重由以 $x_c + a T$ 为中心的确切平移包络给出。具体来说，定义权重 $w_i = \\exp\\!\\big(-d(x_i; x_c + a T)^2/(2\\sigma^2)\\big)$，并通过以下方式计算载波相对于基函数 $\\cos(k_0 x)$ 和 $\\sin(k_0 x)$ 的最佳拟合相位 $\\phi_{\\text{num}}$：\n$$\nC = \\sum_{i=0}^{N-1} w_i\\,u_i(T)\\,\\cos(k_0 x_i),\\quad\nS = \\sum_{i=0}^{N-1} w_i\\,u_i(T)\\,\\sin(k_0 x_i),\\quad\n\\phi_{\\text{num}} = \\operatorname{atan2}(S, C).\n$$\n精确相移为 $\\phi_{\\text{exact}} = k_0 a T$。色散误差是经过环绕处理的绝对相位差，单位为弧度\n$$\n\\varepsilon = \\left|\\left[\\phi_{\\text{num}} - \\phi_{\\text{exact}}\\right]_{\\pi}\\right|,\\quad\n\\text{其中 } \\left[\\theta\\right]_{\\pi} = \\left((\\theta + \\pi) \\bmod 2\\pi\\right) - \\pi.\n$$\n\n逆向设计目标：对于每个测试案例，在满足单调性约束的离散集合 $\\{-0.3,-0.15,0.0,0.15,0.3\\}^2$ 上搜索 $(\\alpha,\\beta)$，并选择使 $\\varepsilon$ 最小化的 $(\\alpha,\\beta)$。\n\n待实现的离散化细节：\n- 在 $[0,L)$ 上使用 $N$ 个点，并对相邻距离进行周期性环绕处理：当 $i>0$ 时，$h_- = x_i - x_{i-1}$；当 $i=0$ 时，$h_- = x_0 - (x_{N-1}-L)$。当 $i  N-1$ 时，$h_+ = x_{i+1} - x_i$；当 $i=N-1$ 时，$h_+ = (x_0+L) - x_{N-1}$。\n- 在非均匀节点 $(x_{i-1}, x_i, x_{i+1})$ 上的二阶中心差分近似由 $(D_x u)_i = c_- u_{i-1} + c_0 u_i + c_+ u_{i+1}$ 给出，其中系数为 $c_- = -\\frac{h_+}{h_-(h_- + h_+)}$, $c_0 = \\frac{h_+ - h_-}{h_- h_+}$, $c_+ = \\frac{h_-}{h_+(h_- + h_+)}$。\n- 格式为：预估步 $u_i^{n+1/2} = u_i^n - \\frac{a\\,\\Delta t}{2}\\,(D_x u^n)_i$；校正步 $u_i^{n+1} = u_i^n - a\\,\\Delta t\\,(D_x u^{n+1/2})_i$。\n- 选择时间步长 $\\Delta t$，使得 Courant 数 $\\lambda = \\frac{|a|\\,\\Delta t}{\\min_i h_i} \\leq 0.9$，其中 $h_i$ 为局部间距。这是通过设置 $\\Delta t = T/N_t$ 来实现的，其中 $N_t = \\lceil T/\\Delta t_{\\max}\\rceil$ 且 $\\Delta t_{\\max} = 0.9\\,\\min_i h_i/|a|$。\n- 在每个测试案例中，通过在 $\\{-0.3,-0.15,0.0,0.15,0.3\\}^2$ 上进行详尽搜索，找到使 $\\varepsilon$ 最小化的 $(\\alpha, \\beta)$。\n- 最终输出必须是一个包含三个列表的列表，格式为 `[[error, alpha, beta], [error, alpha, beta], [error, alpha, beta]]`，其中每个子列表对应于一个测试案例。\n\n测试案例 1：$L=2\\pi, a=1.0, N=64, k_0=8.0, \\sigma=0.3, x_c=0.75 \\times 2\\pi, T=1.0$。\n\n测试案例 2：$L=2\\pi, a=1.0, N=32, k_0=12.0, \\sigma=0.2, x_c=0.5 \\times 2\\pi, T=1.0$。\n\n测试案例 3：$L=2\\pi, a=-0.8, N=48, k_0=10.0, \\sigma=0.25, x_c=0.3 \\times 2\\pi, T=0.7$。",
            "solution": "该问题的解决方案需要直接实现指定的算法来解决逆向设计问题。其整体流程结构如下：\n\n1.  **主循环：** 遍历提供的三个测试案例。\n2.  **逆向设计搜索：** 对每个测试案例，在 $(\\alpha, \\beta)$ 参数的离散集合上执行网格搜索。过滤掉违反单调性约束 $|\\alpha| + |\\beta|  1$ 的参数对。对每个有效的参数对，执行一次完整的数值模拟以计算色散误差 $\\varepsilon$。记录产生最小误差的参数 $(\\alpha, \\beta)$。\n3.  **数值模拟：** 构建一个函数，用于对给定的参数集执行模拟。该函数执行以下步骤：\n    a. **网格生成：** 使用提供的映射函数 $x(\\xi; \\alpha, \\beta)$ 从均匀计算网格 $\\{\\xi_i\\}$ 生成非均匀物理网格 $\\{x_i\\}$。\n    b. **有限差分算子：** 为每个网格点计算二阶非均匀空间导数算子 $(D_x)$ 的系数。通过计算跨越域边界的相邻距离来处理周期性边界条件。\n    c. **初始条件：** 在生成的网格 $\\{x_i\\}$ 上计算初始波包 $u(x,0)$。一个用于计算周期性距离 $d(x;x_c)$ 的辅助函数是必不可少的。\n    d. **时间积分：** 模拟从 $t=0$ 演化到 $t=T$。时间步长 $\\Delta t$ 基于类 CFL 稳定性条件计算，使用整个非均匀网格上的最小网格间距。两步 Lax-Wendroff 格式迭代应用 $N_t$ 步。\n    e. **误差计算：** 在最后一个时间步之后，使用数值解 $u_i(T)$ 来计算色散误差 $\\varepsilon$。这包括计算权重 $w_i$、和 $C$ 和 $S$、数值相位 $\\phi_{\\text{num}}$，并将其与精确相移 $\\phi_{\\text{exact}}$进行比较。\n4.  **输出：** 收集所有测试案例的结果，包括最小化误差 $\\varepsilon$ 和相应的最优参数 $(\\alpha, \\beta)$，并按规定格式化为单个字符串。\n\n该实现将依赖 `numpy` 进行数组操作，这非常适合有限差分格式中涉及的向量化计算。",
            "answer": "```python\nimport numpy as np\n\ndef periodic_dist(pos, center, L):\n    \"\"\"\n    Calculates the signed periodic distance on a circle of circumference L.\n    The distance is from center to pos.\n    \"\"\"\n    dist = pos - center\n    return ((dist + L / 2) % L) - L / 2\n\ndef wrap_pi(theta):\n    \"\"\"Wraps an angle in radians to the interval [-pi, pi].\"\"\"\n    return (theta + np.pi) % (2 * np.pi) - np.pi\n\ndef run_simulation(L, a, N, k0, sigma, xc, T, alpha, beta):\n    \"\"\"\n    Runs one simulation for a given set of physical and grid parameters,\n    and computes the dispersion error.\n    \"\"\"\n    # 1. Grid Generation\n    xi = np.arange(N) / N\n    x = L * (xi + (alpha / (2 * np.pi)) * np.sin(2 * np.pi * xi) + \\\n             (beta / (4 * np.pi)) * np.sin(4 * np.pi * xi))\n\n    # 2. Derivative Operator Setup\n    # Create a padded x array to handle periodic boundary conditions gracefully\n    x_padded = np.concatenate(([x[-1] - L], x, [x[0] + L]))\n    \n    # Spacings for each node i in 0..N-1\n    h_plus = x_padded[2:] - x_padded[1:-1]\n    h_minus = x_padded[1:-1] - x_padded[:-2]\n    \n    # Safeguard against non-monotonic grid\n    if np.any(h_plus = 1e-12) or np.any(h_minus = 1e-12):\n        return float('inf')\n\n    # Derivative coefficients as given in the problem\n    c_plus = h_minus / (h_plus * (h_minus + h_plus))\n    c_minus = -h_plus / (h_minus * (h_minus + h_plus))\n    c_zero = (h_plus - h_minus) / (h_minus * h_plus)\n\n    def Dx(u_vec):\n        \"\"\"Applies the nonuniform finite difference operator for du/dx.\"\"\"\n        u_im1 = np.roll(u_vec, 1)  # u_{i-1} with periodic wrap\n        u_ip1 = np.roll(u_vec, -1) # u_{i+1} with periodic wrap\n        return c_minus * u_im1 + c_zero * u_vec + c_plus * u_ip1\n\n    # 3. Initial Condition\n    d_init = periodic_dist(x, xc, L)\n    u0 = np.exp(-d_init**2 / (2 * sigma**2)) * np.cos(k0 * d_init)\n    \n    # 4. Time Stepping\n    u_final = u0.copy()\n    if abs(a) > 1e-14: # Proceed only if advection occurs\n        min_h = np.min(h_plus)\n        dt_max = 0.9 * min_h / abs(a)\n        \n        Nt = int(np.ceil(T / dt_max)) if T > 0 else 0\n        if Nt == 0 and T > 0: Nt = 1\n\n        if Nt > 0:\n            dt = T / Nt\n            u_n = u0.copy()\n            for _ in range(Nt):\n                # Predictor step to t_{n+1/2}\n                u_half = u_n - (a * dt / 2) * Dx(u_n)\n                # Corrector step to t_{n+1}\n                u_n = u_n - (a * dt) * Dx(u_half)\n            u_final = u_n\n\n    # 5. Dispersion Error Calculation\n    xc_final = (xc + a * T) % L\n    \n    weights = np.exp(-periodic_dist(x, xc_final, L)**2 / (2 * sigma**2))\n    \n    C = np.sum(weights * u_final * np.cos(k0 * x))\n    S = np.sum(weights * u_final * np.sin(k0 * x))\n    \n    phi_num = np.arctan2(S, C)\n    phi_exact = k0 * a * T\n    \n    error = abs(wrap_pi(phi_num - phi_exact))\n    \n    return error\n\ndef solve():\n    \"\"\"\n    Main function to solve the inverse design problem for the given test cases.\n    \"\"\"\n    test_cases = [\n        # L, a, N, k0, sigma, xc, T\n        (2 * np.pi, 1.0, 64, 8.0, 0.3, 0.75 * 2 * np.pi, 1.0),\n        (2 * np.pi, 1.0, 32, 12.0, 0.2, 0.5 * 2 * np.pi, 1.0),\n        (2 * np.pi, -0.8, 48, 10.0, 0.25, 0.3 * 2 * np.pi, 0.7),\n    ]\n\n    param_grid = [-0.3, -0.15, 0.0, 0.15, 0.3]\n    final_results = []\n\n    for case in test_cases:\n        L, a, N, k0, sigma, xc, T = case\n        min_error = float('inf')\n        best_params = (None, None)\n\n        for alpha in param_grid:\n            for beta in param_grid:\n                # Check monotonicity constraint\n                if abs(alpha) + abs(beta) >= 1.0:\n                    continue\n                \n                error = run_simulation(L, a, N, k0, sigma, xc, T, alpha, beta)\n                \n                if error  min_error:\n                    min_error = error\n                    best_params = (alpha, beta)\n        \n        final_results.append([min_error, best_params[0], best_params[1]])\n\n    # Format the final output string as specified\n    output_str = \"[\" + \",\".join(f\"[{e},{a},{b}]\" for e, a, b in final_results) + \"]\"\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}