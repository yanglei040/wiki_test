{
    "hands_on_practices": [
        {
            "introduction": "这个基础练习揭示了弱不稳定性的核心机制。虽然冯·诺依曼稳定性分析通常关注放大因子模大于1（$|g|\\gt 1$）导致的指数增长，但当放大因子多项式存在模为1的重根时，即使在“中性稳定”的情况下，也会出现代数增长。本题构建了一个特定的数值实验，通过精确推导，展示了在这种临界条件下，初始微小误差是如何随时间线性累积的。",
            "id": "3415211",
            "problem": "考虑一维线性平流方程 $u_{t} + a\\,u_{x} = 0$，定义在周期性域上，其中波速 $a \\neq 0$。在空间上使用间距为 $\\Delta x$ 的均匀网格（由 $j \\in \\mathbb{Z}$ 索引）进行离散，在时间上使用步长为 $\\Delta t$ 的时间步（由 $n \\in \\mathbb{Z}$ 索引）进行离散。使用蛙跳时间中心格式\n$$\n\\frac{u_{j}^{n+1} - u_{j}^{n-1}}{2\\,\\Delta t} + a\\,\\frac{u_{j+1}^{n} - u_{j-1}^{n}}{2\\,\\Delta x} = 0,\n$$\n即\n$$\nu_{j}^{n+1} = u_{j}^{n-1} - \\mu\\left(u_{j+1}^{n} - u_{j-1}^{n}\\right),\n\\quad \\text{其中} \\quad \\mu := \\frac{a\\,\\Delta t}{\\Delta x}.\n$$\n采用傅里叶模态 ansatz $u_{j}^{n} = \\widehat{u}^{\\,n}\\,\\exp(i\\,\\kappa\\,j)$，其中波数 $k \\in \\mathbb{R}$，$\\kappa := k\\,\\Delta x \\in [-\\pi,\\pi]$。假设精确算术运算得到 $\\widehat{u}^{\\,n}$ 的增长多项式，并且中性稳定性意味着该多项式的所有相关根 $g$ 均满足 $|g|=1$。\n\n现在，构造一个具体情形，以证明在存在舍入误差的情况下，中性稳定性并不意味着长时间内的误差增长是有界的。为此，选择库朗数 $\\mu = 1$ 和傅里叶波数 $\\kappa = \\pi/2$。在这种情况下，增长多项式有一个重复的单位模根。假设精确解恒为零，但计算出的初始模态振幅被一个微小的舍入失配所污染，建模为\n$$\n\\widehat{u}^{\\,0} = 0, \n\\qquad \n\\widehat{u}^{\\,1} = -\\,i\\,\\varepsilon,\n$$\n其中固定的 $\\varepsilon$ 满足 $0  |\\varepsilon|\\ll 1$，代表启动时舍入误差在该傅里叶模态上的投影。\n\n仅使用上述基本设置和该格式所蕴含的傅里叶模态递推关系，推导出经过 $N$ 个时间步后模态振幅 $\\widehat{u}^{\\,N}$ 的精确闭式表达式，用 $\\varepsilon$ 和 $N$ 表示。你的最终答案必须是单一的解析表达式。不需要进行数值舍入，也不涉及物理单位。",
            "solution": "用户提供了一个关于分析蛙跳时间中心数值格式中弱稳定性的问题陈述。\n\n### 第一步：问题验证\n\n首先对问题进行严格的验证过程。\n\n**提取的已知条件：**\n- **控制方程**：$u_{t} + a\\,u_{x} = 0$，其中 $a \\neq 0$。\n- **离散格式**：蛙跳时间中心格式，$u_{j}^{n+1} = u_{j}^{n-1} - \\mu\\left(u_{j+1}^{n} - u_{j-1}^{n}\\right)$，其中 $\\mu := \\frac{a\\,\\Delta t}{\\Delta x}$。\n- **分析方法**：傅里叶模态 ansatz，$u_{j}^{n} = \\widehat{u}^{\\,n}\\,\\exp(i\\,\\kappa\\,j)$，其中 $\\kappa := k\\,\\Delta x$。\n- **稳定性条件**：中性稳定性定义为增长多项式的所有相关根 $g$ 均满足 $|g|=1$。\n- **具体参数**：库朗数 $\\mu = 1$，归一化波数 $\\kappa = \\pi/2$。\n- **模态振幅的初始条件**：$\\widehat{u}^{\\,0} = 0$ 和 $\\widehat{u}^{\\,1} = -\\,i\\,\\varepsilon$，其中 $0  |\\varepsilon| \\ll 1$。\n- **目标**：推导出 $\\widehat{u}^{\\,N}$ 关于 $\\varepsilon$ 和 $N$ 的闭式表达式。\n\n**验证结论：**\n问题是**有效**的。这是一个来自偏微分方程数值分析领域的、适定的、有科学依据的问题。所有必要信息均已提供，术语精确，并且该设置是用于演示数值格式中弱不稳定性概念的标准设置。该问题未违反任何无效性标准。\n\n### 第二步：推导解答\n\n我们从蛙跳格式所提供的递推关系开始：\n$$\nu_{j}^{n+1} = u_{j}^{n-1} - \\mu\\left(u_{j+1}^{n} - u_{j-1}^{n}\\right)\n$$\n我们将傅里叶模态 ansatz $u_{j}^{n} = \\widehat{u}^{\\,n}\\,\\exp(i\\,\\kappa\\,j)$ 代入此方程：\n$$\n\\widehat{u}^{\\,n+1}\\,\\exp(i\\,\\kappa\\,j) = \\widehat{u}^{\\,n-1}\\,\\exp(i\\,\\kappa\\,j) - \\mu\\left(\\widehat{u}^{\\,n}\\,\\exp(i\\,\\kappa\\,(j+1)) - \\widehat{u}^{\\,n}\\,\\exp(i\\,\\kappa\\,(j-1))\\right)\n$$\n方程两边同除以公因子 $\\exp(i\\,\\kappa\\,j)$，得到模态振幅 $\\widehat{u}^{\\,n}$ 的递推关系：\n$$\n\\widehat{u}^{\\,n+1} = \\widehat{u}^{\\,n-1} - \\mu\\,\\widehat{u}^{\\,n}\\left(\\exp(i\\,\\kappa) - \\exp(-i\\,\\kappa)\\right)\n$$\n使用欧拉恒等式 $\\exp(i\\,\\kappa) - \\exp(-i\\,\\kappa) = 2i\\sin(\\kappa)$，该关系式变为：\n$$\n\\widehat{u}^{\\,n+1} = \\widehat{u}^{\\,n-1} - 2i\\mu\\sin(\\kappa)\\,\\widehat{u}^{\\,n}\n$$\n整理各项，我们得到一个二阶线性齐次常系数递推关系：\n$$\n\\widehat{u}^{\\,n+1} + 2i\\mu\\sin(\\kappa)\\,\\widehat{u}^{\\,n} - \\widehat{u}^{\\,n-1} = 0\n$$\n问题指定了参数 $\\mu = 1$ 和 $\\kappa = \\pi/2$。我们将这些值代入递推关系。由于 $\\sin(\\pi/2) = 1$，系数 $2i\\mu\\sin(\\kappa)$ 变为 $2i(1)(1) = 2i$。此情况下的具体递推关系是：\n$$\n\\widehat{u}^{\\,n+1} + 2i\\,\\widehat{u}^{\\,n} - \\widehat{u}^{\\,n-1} = 0\n$$\n为求解此递推关系，我们通过代入试探解 $\\widehat{u}^{\\,n} = g^n$ 来求其特征多项式的根：\n$$\ng^{n+1} + 2i\\,g^n - g^{n-1} = 0\n$$\n假设 $g \\neq 0$ 并两边同除以 $g^{n-1}$，我们得到增长多项式：\n$$\ng^2 + 2i\\,g - 1 = 0\n$$\n这个二次表达式是一个完全平方：\n$$\n(g + i)^2 = g^2 + 2ig + i^2 = g^2 + 2ig - 1 = 0\n$$\n该多项式有一个重根 $g_{1,2} = -i$。此根的模为 $|-i| = 1$，这证实了问题陈述中关于重复单位模根的说法，该根对应于中性稳定性。\n\n对于具有重根 $g$ 的递推关系，$\\widehat{u}^{\\,n}$ 的通解形式为：\n$$\n\\widehat{u}^{\\,n} = (C_1 + C_2 n) g^n\n$$\n其中 $C_1$ 和 $C_2$ 是由初始条件确定的常数。代入 $g = -i$，我们有：\n$$\n\\widehat{u}^{\\,n} = (C_1 + C_2 n) (-i)^n\n$$\n问题给出了代表微小舍入误差的初始条件：$\\widehat{u}^{\\,0} = 0$ 和 $\\widehat{u}^{\\,1} = -i\\varepsilon$。\n我们应用 $n=0$ 时的条件：\n$$\n\\widehat{u}^{\\,0} = (C_1 + C_2 \\cdot 0) (-i)^0 = C_1 \\cdot 1 = C_1\n$$\n已知 $\\widehat{u}^{\\,0} = 0$，我们得到 $C_1 = 0$。\n\n接着，我们应用 $n=1$ 时的条件：\n$$\n\\widehat{u}^{\\,1} = (C_1 + C_2 \\cdot 1) (-i)^1 = (0 + C_2) (-i) = -i C_2\n$$\n已知 $\\widehat{u}^{\\,1} = -i\\varepsilon$，我们令两表达式相等：\n$$\n-i C_2 = -i\\varepsilon \\implies C_2 = \\varepsilon\n$$\n求出常数 $C_1 = 0$ 和 $C_2 = \\varepsilon$ 后，我们将它们代入通解，以求出在时间步 $n$ 的模态振幅的特解：\n$$\n\\widehat{u}^{\\,n} = (0 + \\varepsilon n) (-i)^n = n \\varepsilon (-i)^n\n$$\n问题要求给出 $N$ 个时间步后 $\\widehat{u}^{\\,N}$ 的表达式。我们只需将 $n$ 替换为 $N$：\n$$\n\\widehat{u}^{\\,N} = N \\varepsilon (-i)^N\n$$\n这个结果表明，模态振幅的大小 $|\\widehat{u}^{\\,N}| = |N \\varepsilon (-i)^N| = N|\\varepsilon|$ 随时间步数 $N$ 线性增长。这种线性增长源于增长多项式中的重复单位模根，是弱不稳定性的标志。尽管根据 $|g|=1$ 准则，该格式是中性稳定的，但一个微小的初始误差会随时间被放大，导致在长时间模拟中精度下降。",
            "answer": "$$\\boxed{N \\varepsilon (-i)^N}$$"
        },
        {
            "introduction": "本练习转向一个实际的编程问题，利用“人造解方法”（Method of Manufactured Solutions）来诊断和处理时间步进格式的内在问题。通过将偏微分方程简化为最简单的形式 $u_t=0$，我们得以将时间积分引入的计算不稳定性和空间离散误差完全分离。学生将亲手实现代码，观察不一致的初值如何激发虚假的计算模态，并测试两种关键的解决方案：确保初值一致性，以及使用时间滤波器进行抑制。",
            "id": "3415291",
            "problem": "考虑在周期性空间域 $x \\in [0,1]$ 上的偏微分方程 (PDE) $u_t = 0$，其人造精确解为不随时间变化的 $u_{\\mathrm{exact}}(x,t) = \\cos(2\\pi x)$。使用应用于 $u_t = 0$ 的蛙跳时间中心格式对时间进行离散，该格式为\n$$\n\\frac{u^{n+1} - u^{n-1}}{2\\,\\Delta t} = 0,\n$$\n因此离散更新为\n$$\nu^{n+1} = u^{n-1}.\n$$\n已知该格式允许一个物理模式 $u^n = u_{\\mathrm{phys}}$ 和一个计算模式 $u^n = (-1)^n u_{\\mathrm{comp}}$。在实际应用中，当初始化不一致时，计算模式可能出现弱不稳定性，表现为时间上的 $(-1)^n$ 振荡。在这个人造解测试中，您将：\n- 演示即使在精确解是稳态的情况下，由于蛙跳格式的启动数据不一致而导致的 $(-1)^n$ 振荡。\n- 设计并评估一个能够消除这种振荡的启动程序。\n- （可选）在使用不一致启动时，应用 Robert–Asselin 时间滤波器来抑制计算模式。\n\n使用具有 $N$ 个点和网格间距 $\\Delta x = 1/N$ 的均匀网格。设时间层 $n=0$ 的初始条件为 $u^0(x_j) = \\cos(2\\pi x_j)$，其中网格点为 $x_j = j\\,\\Delta x$, $j=0,1,\\dots,N-1$。定义以下初始化和传播策略：\n- 不一致启动：设置 $u^1(x_j) = u^0(x_j) + \\varepsilon \\cos(4\\pi x_j)$，其中 $\\varepsilon  0$ 是一个激发计算模式的微小不匹配量，然后使用蛙跳格式 $u^{n+1} = u^{n-1}$ 进行演化。\n- 一致启动：设置 $u^1(x_j) = u^0(x_j)$，确保不激发计算模式，然后使用蛙跳格式 $u^{n+1} = u^{n-1}$ 进行演化。\n- 滤波的不一致启动：设置 $u^1(x_j) = u^0(x_j) + \\varepsilon \\cos(4\\pi x_j)$，使用蛙跳格式 $u^{n+1} = u^{n-1}$ 进行演化，并在每次更新后对中间层应用 Robert–Asselin 时间滤波器\n$$\nu^n \\leftarrow u^n + \\alpha \\left(u^{n+1} - 2 u^n + u^{n-1}\\right),\n$$\n其中 $\\alpha \\in (0,1/2)$ 控制计算模式的阻尼强度。\n\n对于每次运行，将 $n$ 从 $1$ 推进到指定的时间步数 $N_{\\mathrm{steps}}$。在运行结束时，通过最后两个时间层之间交替分量的离散 $L^2$ 范数来量化计算模式的振幅：\n$$\nA_{\\mathrm{comp}} = \\left\\|u^n - u^{n-1}\\right\\|_{L^2} = \\sqrt{\\Delta x \\sum_{j=0}^{N-1} \\left(u^n(x_j) - u^{n-1}(x_j)\\right)^2}.\n$$\n该度量用于分离 $(-1)^n$ 振荡：在无滤波的不一致启动下，$A_{\\mathrm{comp}}$ 保持恒定且等于初始不匹配范数；在一致启动下，$A_{\\mathrm{comp}} = 0$；在滤波的不一致启动下，$A_{\\mathrm{comp}}$ 应随着步数的增加而衰减。\n\n您的程序必须实现上述内容，并评估以下测试套件，每个测试用例指定为一个元组 $(N, \\Delta t, N_{\\mathrm{steps}}, \\varepsilon, \\alpha, \\text{startup})$：\n1. $(128, 0.01, 50, 10^{-2}, 0.0, \\text{\"inconsistent\"})$：演示持续的 $(-1)^n$ 振荡。\n2. $(128, 0.01, 50, 0.0, 0.0, \\text{\"consistent\"})$：演示通过一致启动消除计算模式。\n3. $(128, 0.01, 50, 10^{-2}, 0.1, \\text{\"filtered\"})$：演示通过 Robert–Asselin 滤波器抑制计算模式。\n\n不涉及物理单位。如所示，角度以弧度为单位。对于每个测试用例，计算并返回标量 $A_{\\mathrm{comp}}$ 作为浮点数。您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表（例如，“[result1,result2,result3]”）。",
            "solution": "该问题要求研究蛙跳时间步进格式的特性，特别是它容易产生一个可由不一致的初始化激发的非物理计算模式的倾向。我们将演示这一现象，展示如何通过一致的启动程序来避免它，并说明如何使用 Robert–Asselin 时间滤波器来抑制它。\n\n所考虑的偏微分方程 (PDE) 是在周期域 $x \\in [0, 1]$ 上速度为零的简单平流方程 $u_t = 0$。该偏微分方程的解析解是任何在时间上恒定的函数。问题指定了一个人造精确解 $u_{\\mathrm{exact}}(x,t) = \\cos(2\\pi x)$。\n\n蛙跳时间步进格式是一种二阶精度的时间中心方法。应用于 $u_t = F(u)$，它写作 $\\frac{u^{n+1} - u^{n-1}}{2\\Delta t} = F(u^n)$。对于给定的偏微分方程，$F(u)=0$，因此该格式简化为：\n$$\n\\frac{u^{n+1} - u^{n-1}}{2\\Delta t} = 0\n$$\n这得到了离散更新规则：\n$$\nu^{n+1} = u^{n-1}\n$$\n这是一个三时间层格式，意味着它需要来自前两个时间层 $u^n$ 和 $u^{n-1}$ 的数据来计算下一个时间层 $u^{n+1}$。因此，它需要两个初始数据集 $u^0$ 和 $u^1$ 来开始积分。\n\n递推关系 $u^{n+1} = u^{n-1}$ 的通解可以表示为物理模式和计算模式的线性组合：\n$$\nu^n = A + B(-1)^n\n$$\n其中 $A$ 代表与时间无关的物理解决方案，而 $B(-1)^n$ 是计算模式，它以 $2\\Delta t$ 的周期振荡，是三层格式的数值产物。振幅 $A$ 和 $B$ 由初始条件 $u^0$ 和 $u^1$ 决定：\n$$\nA = \\frac{u^0 + u^1}{2}, \\quad B = \\frac{u^0 - u^1}{2}\n$$\n当且仅当 $u^1 \\neq u^0$ 时，计算模式被激发 ($B \\neq 0$)。这是“不一致启动”程序的基础。\n\n我们将在均匀空间网格 $x_j = j\\Delta x$（其中 $j=0, 1, \\dots, N-1$ 且 $\\Delta x = 1/N$）上实现三种不同的初始化和传播解的策略。\n\n1.  **不一致启动**：我们用 $u^0(x_j) = \\cos(2\\pi x_j)$ 初始化，并在第一个时间步引入一个小的扰动，$u^1(x_j) = u^0(x_j) + \\varepsilon \\cos(4\\pi x_j)$。这使得 $u^1 \\neq u^0$，从而以振幅 $B = -\\frac{\\varepsilon}{2}\\cos(4\\pi x_j)$ 激发计算模式。解随后交替为 $u^{2k} = u^0$ 和 $u^{2k+1} = u^1$。计算模式的度量 $A_{\\mathrm{comp}} = \\|u^n - u^{n-1}\\|$ 对于所有 $n \\geq 1$ 将是恒定的。对于一个偶数的最终步长 $n=N_{\\mathrm{steps}}$，我们有 $u^n = u^0$ 和 $u^{n-1} = u^1$。差值为 $u^n - u^{n-1} = -\\varepsilon \\cos(4\\pi x_j)$。平方 $L^2$ 范数为 $A_{\\mathrm{comp}}^2 = \\Delta x \\sum_{j=0}^{N-1} (\\varepsilon \\cos(4\\pi x_j))^2 = \\varepsilon^2 \\Delta x \\sum_{j=0}^{N-1} \\cos^2(4\\pi j/N)$。当 $N  4$ 时，总和 $\\sum_{j=0}^{N-1} \\cos^2(4\\pi j/N)$ 的值为 $N/2$。因此，$A_{\\mathrm{comp}}^2 = \\varepsilon^2 (1/N) (N/2) = \\varepsilon^2/2$，得出 $A_{\\mathrm{comp}} = \\varepsilon/\\sqrt{2}$。对于 $\\varepsilon = 10^{-2}$，这大约是 $0.007071$。\n\n2.  **一致启动**：我们用 $u^0(x_j) = \\cos(2\\pi x_j)$ 和 $u^1(x_j) = u^0(x_j)$ 初始化。这确保了 $B=0$，因此计算模式永远不会被激发。解在所有时间步中保持恒定，$u^n = u^0$。因此，对于所有 $n$，$u^n - u^{n-1} = 0$，并且 $A_{\\mathrm{comp}}$ 将为 $0$。\n\n3.  **滤波的不一致启动**：初始化与不一致情况相同，激发了计算模式。然而，在时间步进过程中，每次蛙跳更新 $u^{n+1} = u^{n-1}$ 之后，我们对中间时间层应用 Robert–Asselin 时间滤波器：\n    $$\n    u^n \\leftarrow u^n + \\alpha \\left(u^{n+1} - 2 u^n + u^{n-1}\\right)\n    $$\n    该滤波器专门设计用于抑制像 $2\\Delta t$ 计算模式这样的高频振荡。参数 $\\alpha$ 控制阻尼的强度。该滤波器的作用是在每一步减小计算模式的振幅，导致 $A_{\\mathrm{comp}}$ 随时间衰减。\n\n实现将通过为 $u^0$ 和 $u^1$ 设置初始数组来进行。时间演化在一个从 $n=1$ 到 $N_{\\mathrm{steps}}-1$ 的循环中执行。对于滤波情况，参数 $\\alpha$ 非零。对于其他两种情况，可以使用相同的代码路径，设置 $\\alpha=0$，因为这会使滤波器的效果无效。在循环内，我们维护两个状态向量，`u_prev` ($u^{n-1}$) 和 `u_curr` ($u^n$)。一个时间步的算法是：\n1.  计算一个临时的 $u^{n+1}$：`u_next = u_prev`。\n2.  对 $u^n$ 应用滤波器：`u_curr_filtered = u_curr + alpha * (u_next - 2*u_curr + u_prev)`。\n3.  推进状态：新的 `u_prev` 变为 `u_curr_filtered`，新的 `u_curr` 变为 `u_next`。\n\n在 $N_{\\mathrm{steps}}-1$ 次迭代后，循环终止。最终的状态向量是 `u_curr`（代表 $u^{N_{\\mathrm{steps}}}$）和 `u_prev`（代表滤波后的 $u^{N_{\\mathrm{steps}}-1}$）。度量 $A_{\\mathrm{comp}}$ 是使用给定的离散 $L^2$ 范数公式从这些最终向量计算得出的。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef run_simulation(N, dt, N_steps, eps, alpha, startup_type):\n    \"\"\"\n    Runs a single simulation for the leapfrog scheme on u_t=0.\n    \n    Args:\n        N (int): Number of grid points.\n        dt (float): Time step size (not used in the update rule but part of the problem spec).\n        N_steps (int): Total number of time steps to run.\n        eps (float): Perturbation magnitude for inconsistent startup.\n        alpha (float): Robert-Asselin filter coefficient.\n        startup_type (str): Type of startup (\"inconsistent\", \"consistent\", \"filtered\").\n\n    Returns:\n        float: The computed computational mode amplitude A_comp.\n    \"\"\"\n    dx = 1.0 / N\n    # Spatial grid points x_j = j*dx for j=0, ..., N-1\n    x = np.arange(N) * dx\n\n    # Initialize u^0 and u^1\n    # u^0(x_j) = cos(2*pi*x_j)\n    u0 = np.cos(2 * np.pi * x)\n    \n    # u^1(x_j) is based on the startup. For the \"consistent\" case, eps=0.\n    # So a single formula handles all specifications.\n    u1 = u0 + eps * np.cos(4 * np.pi * x)\n\n    # Time-stepping variables.\n    # u_prev will hold u^{n-1} and u_curr will hold u^n.\n    u_prev = u0\n    u_curr = u1\n\n    # Time-stepping loop from n=1 to N_steps-1.\n    # This computes states up to u^{N_steps}.\n    # The filter logic with alpha=0 correctly handles the non-filtered cases.\n    for n in range(1, N_steps):\n        # We have u^{n-1} (u_prev) and u^n (u_curr).\n        \n        # Step 1: Leapfrog update to get u^{n+1}.\n        u_next = u_prev\n        \n        # Step 2: Apply Robert-Asselin filter to the middle time level u^n (u_curr).\n        # u^n_new = u^n + alpha * (u^{n+1} - 2*u^n + u^{n-1})\n        u_curr_filtered = u_curr + alpha * (u_next - 2 * u_curr + u_prev)\n        \n        # Step 3: Advance time levels for the next iteration.\n        # The new previous state (for n+1) is the filtered current state (at n).\n        u_prev = u_curr_filtered\n        # The new current state (for n+1) is the next state.\n        u_curr = u_next\n\n    # After the loop completes, the final time level is n=N_steps.\n    # u_curr now holds the state vector for u^{N_steps}.\n    # u_prev holds the (filtered) state vector for u^{N_steps - 1}.\n    diff = u_curr - u_prev\n    \n    # Calculate the discrete L2 norm of the difference to find A_comp.\n    # A_comp = sqrt(dx * sum(diff^2))\n    A_comp = np.sqrt(dx * np.sum(np.square(diff)))\n    \n    return A_comp\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (N, dt, N_steps, eps, alpha, startup)\n        (128, 0.01, 50, 1e-2, 0.0, \"inconsistent\"),\n        (128, 0.01, 50, 0.0, 0.0, \"consistent\"),\n        (128, 0.01, 50, 1e-2, 0.1, \"filtered\")\n    ]\n\n    results = []\n    for case in test_cases:\n        N, dt, N_steps, eps, alpha, startup = case\n        result = run_simulation(N, dt, N_steps, eps, alpha, startup)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "这项练习模拟了数值建模中的一个高级且常见的校准任务。像Robert-Asselin这样的滤波器是抑制计算模态的有力工具，但其应用并非没有代价，它可能会引入额外的数值误差，例如影响物理模态的相位。本题旨在通过一个具体的权衡过程，指导学生如何标定滤波器参数，从而在有效抑制计算模态的同时，将对物理波传播速度的干扰控制在可接受的范围内。",
            "id": "3415215",
            "problem": "考虑线性平流偏微分方程 (PDE) $u_{t} + c\\,u_{x} = 0$，其中波速 $c0$ 为常数，该方程通过蛙跳时间中心格式和中心空间差分在空间间距为 $\\Delta x$、时间步长为 $\\Delta t$ 的均匀空间网格上进行离散化：\n$$\nu_{j}^{n+1} = u_{j}^{n-1} - 2\\mu\\left(u_{j+1}^{n} - u_{j-1}^{n}\\right), \\quad \\text{其中} \\quad \\mu \\equiv \\frac{c\\,\\Delta t}{2\\,\\Delta x}.\n$$\n为了抑制与蛙跳计算模式相关的弱不稳定性，在每次蛙跳更新后应用 Robert–Asselin (RA) 滤波器：\n$$\nu_{j}^{n} \\leftarrow u_{j}^{n} + \\epsilon\\left(u_{j}^{n+1} - 2u_{j}^{n} + u_{j}^{n-1}\\right),\n$$\n其中 $\\epsilon \\in (0,1/2)$ 是一个待标定的无量纲参数。\n\n通过考虑形如 $u_{j}^{n} = \\widehat{u}\\,\\lambda^{n} \\exp(i j \\theta)$ 的模态进行 von Neumann 傅里叶分析，其中 $\\theta \\in [-\\pi,\\pi]$ 是无量纲波数，$\\lambda$ 是复合的蛙跳加滤波步骤的单步放大因子。使用以下参数值：\n- $c = 0.8$，\n- $\\Delta x = 1$，\n- $\\Delta t = 1$，\n因此 $\\mu = 0.4$。通过要求在 $\\theta = \\pi$ 处的计算模式每个复合时间步长的振幅衰减为 0.9 倍来标定 $\\epsilon$，同时要求由 RA 滤波器对 $\\theta = \\pi/4$ 处的物理模式引入的每个时间步长的附加相位误差不超过 0.007 弧度。\n\n从上述离散更新和滤波器定义出发，推导复合放大关系，确定在 $\\theta = \\pi$ 处计算模式的放大因子，并根据指定的衰减确定 $\\epsilon$。然后，对 $\\epsilon$ 的主阶项推导 RA 引入的物理模式的相位扰动，并在 $\\theta = \\pi/4$ 处计算其值，以验证是否满足相位误差限制。如果推导出的 $\\epsilon$ 违反了相位误差限制，则选择能够使计算模式每步的振幅衰减因子不小于 0.9 且仍然满足相位误差界限的最大 $\\epsilon$。否则，接受由计算模式衰减所确定的值。以无量纲数的形式给出 $\\epsilon$ 的最终值。无需四舍五入。所有角度必须以弧度处理。",
            "solution": "用户希望我解决一个关于线性平流方程的数值分析问题，该问题涉及蛙跳格式和 Robert-Asselin 滤波器。\n\n我的计划如下：\n1.  **验证问题陈述：** 我将提取所有给定信息，并仔细检查其科学合理性、完整性和客观性。鉴于该问题基于标准的数值偏微分方程方法，预期是有效的。\n\n2.  **推导复合放大关系：** 我将按所述对蛙跳加滤波的组合格式进行 von Neumann 分析。这包括将形如 $u_j^n = \\widehat{u} \\lambda^n \\exp(ij\\theta)$ 的傅里叶模态代入离散方程组，以推导放大因子 $\\lambda$ 的特征多项式。该系统是：\n    1.  一个蛙跳步骤，用于从 $u^n$ 和 $u^{n-1}$ 计算 $u^{n+1}$。\n    2.  一个 RA 滤波器步骤，使用 $u^{n+1}$、$u^n$ 和 $u^{n-1}$ 更新 $u^n$ 的值。让我们将滤波后的值表示为 $u_f^n$。\n    3.  计算 $u^{n+2}$ 的下一个蛙跳步骤使用 $u^{n+1}$ 和滤波后的值 $u_f^n$。\n\n3.  **分析计算模式：** 我将把特征多项式应用于波数 $\\theta = \\pi$ 的情况。这将得到此特定波数下物理模式和计算模式的放大因子。利用给定的计算模式衰减要求，我将确定滤波器参数 $\\epsilon$ 的值。\n\n4.  **分析相位误差：** 我将找到特征多项式的物理模式根 $\\lambda_p$。然后，我将推导由滤波器引入的相位扰动 $\\Delta\\phi$ 的表达式，该表达式对 $\\epsilon$ 的主阶项有效。这是有滤波器 ($\\epsilon  0$) 时 $\\lambda_p$ 的相位与无滤波器 ($\\epsilon=0$) 时相位的差值。\n\n5.  **应用约束并确定最终值：** 我将在指定的波数 $\\theta = \\pi/4$ 处评估相位扰动，并使用给定的参数值建立对 $\\epsilon$ 的约束。然后，我将把从计算模式衰减推导出的 $\\epsilon$ 值与此相位误差约束进行比较。根据问题的逻辑，我要么接受 $\\epsilon$ 的初始值，要么选择满足所有条件的最大允许值。\n\n让我们开始正式的推导过程。\n\n### 步骤 1: 提取已知条件\n-   偏微分方程：$u_{t} + c\\,u_{x} = 0$，其中 $c  0$ 为常数。\n-   蛙跳格式：$u_{j}^{n+1} = u_{j}^{n-1} - 2\\mu\\left(u_{j+1}^{n} - u_{j-1}^{n}\\right)$。\n-   类库朗数参数：$\\mu \\equiv \\frac{c\\,\\Delta t}{2\\,\\Delta x}$。\n-   Robert–Asselin (RA) 滤波器：$u_{j}^{n} \\leftarrow u_{j}^{n} + \\epsilon\\left(u_{j}^{n+1} - 2u_{j}^{n} + u_{j}^{n-1}\\right)$，其中 $\\epsilon \\in (0, 1/2)$。\n-   用于分析的傅里叶模态：$u_{j}^{n} = \\widehat{u}\\,\\lambda^{n} \\exp(i j \\theta)$，其中 $\\theta \\in [-\\pi,\\pi]$。\n-   参数值：$c = 0.8$，$\\Delta x = 1$，$\\Delta t = 1$。这意味着 $\\mu = \\frac{0.8 \\times 1}{2 \\times 1} = 0.4$。\n-   约束 1 (计算模式衰减)：在 $\\theta = \\pi$ 处，每个步长计算模式的振幅衰减为 0.9 倍。\n-   约束 2 (相位误差)：在 $\\theta = \\pi/4$ 处，由 RA 滤波器对物理模式引入的每个时间步长的附加相位误差不得超过 0.007 弧度。\n\n### 步骤 2: 使用提取的已知条件进行验证\n问题具有科学依据、良定且客观。\n-   **科学依据：** 该问题涉及数值分析中的一个标准、成熟的课题：偏微分方程有限差分格式的稳定性和准确性。蛙跳格式、其弱不稳定性以及 Robert-Asselin 滤波器都是该领域的经典课题。\n-   **良定性：** 问题提供了一套清晰的方程、参数和两个不同的约束来确定单个参数 $\\epsilon$。在约束冲突时选择 $\\epsilon$ 的逻辑也已指定。其结构表明存在唯一解。\n-   **客观性：** 问题以精确的数学语言陈述，没有歧义或主观陈述。\n\n### 步骤 3: 结论与行动\n问题是 **有效的**。我将继续进行求解。\n\n### 推导与求解\n\n我们分析组合的蛙跳-滤波器格式。从 $(u^{n-1}, u^n)$ 对推进到 $(u^n, u^{n+1})$，再到 $(u^{n+1}, u^{n+2})$ 的过程如下：\n1.  使用标准蛙跳格式更新计算 $u_j^{n+1}$：\n    $u_j^{n+1} = u_j^{n-1} - 2\\mu(u_{j+1}^{n} - u_{j-1}^{n})$\n2.  然后对 $u_j^n$ 的值进行滤波，产生一个新值 $u_{f,j}^n$，用于后续步骤：\n    $u_{f,j}^n = u_j^n + \\epsilon(u_j^{n+1} - 2u_j^n + u_j^{n-1})$\n3.  使用滤波后的值 $u_{f,j}^n$ 计算下一个状态 $u_j^{n+2}$：\n    $u_j^{n+2} = u_{f,j}^n - 2\\mu(u_{j+1}^{n+1} - u_{j-1}^{n+1})$\n\n为了进行 von Neumann 分析，我们将傅里叶模态 $u_j^n = \\widehat{u}^n e^{ij\\theta}$ 代入这些方程。空间差分项变为：\n$u_{j+1}^n - u_{j-1}^n = \\widehat{u}^n e^{ij\\theta}(e^{i\\theta} - e^{-i\\theta}) = \\widehat{u}^n e^{ij\\theta} (2i\\sin\\theta)$。\n\n在傅里叶空间中的方程组变为：\n1.  $\\widehat{u}^{n+1} = \\widehat{u}^{n-1} - 2\\mu (2i\\sin\\theta) \\widehat{u}^n = \\widehat{u}^{n-1} - 4i\\mu\\sin\\theta \\widehat{u}^n$。\n2.  $\\widehat{u}_f^n = \\widehat{u}^n + \\epsilon(\\widehat{u}^{n+1} - 2\\widehat{u}^n + \\widehat{u}^{n-1})$。\n3.  $\\widehat{u}^{n+2} = \\widehat{u}_f^n - 4i\\mu\\sin\\theta \\widehat{u}^{n+1}$。\n\n将 (2) 代入 (3)：\n$\\widehat{u}^{n+2} = [\\widehat{u}^n + \\epsilon(\\widehat{u}^{n+1} - 2\\widehat{u}^n + \\widehat{u}^{n-1})] - 4i\\mu\\sin\\theta \\widehat{u}^{n+1}$。\n\n从 (1) 中，我们用较新的值表示 $\\widehat{u}^{n-1}$：$\\widehat{u}^{n-1} = \\widehat{u}^{n+1} + 4i\\mu\\sin\\theta \\widehat{u}^n$。将此代入 $\\widehat{u}^{n+2}$ 的方程：\n$\\widehat{u}^{n+2} = \\widehat{u}^n + \\epsilon[\\widehat{u}^{n+1} - 2\\widehat{u}^n + (\\widehat{u}^{n+1} + 4i\\mu\\sin\\theta \\widehat{u}^n)] - 4i\\mu\\sin\\theta \\widehat{u}^{n+1}$\n$\\widehat{u}^{n+2} = \\widehat{u}^n + \\epsilon(2\\widehat{u}^{n+1} - 2\\widehat{u}^n + 4i\\mu\\sin\\theta \\widehat{u}^n) - 4i\\mu\\sin\\theta \\widehat{u}^{n+1}$\n\n按 $\\widehat{u}^{n+1}$ 和 $\\widehat{u}^n$ 分组各项：\n$\\widehat{u}^{n+2} = (2\\epsilon - 4i\\mu\\sin\\theta)\\widehat{u}^{n+1} + (1 - 2\\epsilon + 4i\\epsilon\\mu\\sin\\theta)\\widehat{u}^n$。\n\n通过设 $\\widehat{u}^n = \\lambda^n$，我们得到放大因子 $\\lambda$ 的特征多项式：\n$\\lambda^2 - (2\\epsilon - 4i\\mu\\sin\\theta)\\lambda - (1 - 2\\epsilon + 4i\\epsilon\\mu\\sin\\theta) = 0$。\n\n**使用计算模式标定 $\\epsilon$**\n\n我们分析 $\\theta=\\pi$ 的情况。此时，$\\sin\\theta = 0$。特征多项式简化为：\n$\\lambda^2 - 2\\epsilon\\lambda - (1 - 2\\epsilon) = 0$。\n\n根由二次求根公式给出：\n$\\lambda = \\frac{2\\epsilon \\pm \\sqrt{(-2\\epsilon)^2 - 4(1)(-(1-2\\epsilon))}}{2} = \\epsilon \\pm \\sqrt{\\epsilon^2 + 1 - 2\\epsilon} = \\epsilon \\pm \\sqrt{(\\epsilon-1)^2}$。\n因为 $\\epsilon \\in (0, 1/2)$，所以 $\\epsilon-1  0$，因此 $\\sqrt{(\\epsilon-1)^2} = |\\epsilon-1| = 1-\\epsilon$。\n两个根是：\n$\\lambda_1 = \\epsilon + (1-\\epsilon) = 1$ (物理模式)。\n$\\lambda_2 = \\epsilon - (1-\\epsilon) = 2\\epsilon - 1$ (计算模式)。\n\n问题要求计算模式每个步长的衰减因子为 0.9。这意味着其放大因子的模必须为 0.9：\n$|\\lambda_2| = |2\\epsilon - 1| = 0.9$。\n因为 $\\epsilon \\in (0, 1/2)$，$2\\epsilon-1$ 是负数。因此，$|2\\epsilon-1| = -(2\\epsilon-1) = 1-2\\epsilon$。\n$1 - 2\\epsilon = 0.9 \\implies 2\\epsilon = 0.1 \\implies \\epsilon = 0.05$。\n该值在指定的范围 $(0, 1/2)$ 内。\n\n**相位误差分析**\n\n一般特征方程的根是：\n$\\lambda = \\frac{(2\\epsilon - 4i\\mu\\sin\\theta) \\pm \\sqrt{(2\\epsilon - 4i\\mu\\sin\\theta)^2 + 4(1-2\\epsilon+4i\\epsilon\\mu\\sin\\theta)}}{2}$。\n平方根下的项简化为 $4(1 - (2\\mu\\sin\\theta)^2 - (2\\epsilon - \\epsilon^2))$。令 $\\nu = 2\\mu\\sin\\theta$。\n根是 $\\lambda = (\\epsilon - i\\nu) \\pm \\sqrt{1-\\nu^2 - 2\\epsilon + \\epsilon^2}$。\n物理模式是在 $\\nu \\to 0$ 时趋近于 $1$ 的那个。令 $R = \\sqrt{1-\\nu^2-2\\epsilon+\\epsilon^2}$。\n当 $\\nu \\to 0$ 时，$R \\to \\sqrt{(1-\\epsilon)^2} = 1-\\epsilon$。\n根变为 $\\epsilon \\pm (1-\\epsilon)$，即 $1$ 和 $2\\epsilon-1$。因此物理根是 $\\lambda_p = (\\epsilon - i\\nu) + R$。\n\n物理模式的相位是 $\\phi(\\epsilon) = \\arg(\\lambda_p)$。我们关心的是对 $\\epsilon$ 的主阶项而言的附加相位误差 $\\Delta\\phi = \\phi(\\epsilon) - \\phi(0)$。\n对于小的 $\\epsilon$，我们展开 $\\lambda_p$：\n$R = \\sqrt{1-\\nu^2 - (2\\epsilon-\\epsilon^2)} \\approx \\sqrt{1-\\nu^2}\\left(1 - \\frac{2\\epsilon}{1-\\nu^2}\\right)^{1/2} \\approx \\sqrt{1-\\nu^2}\\left(1 - \\frac{\\epsilon}{1-\\nu^2}\\right) = \\sqrt{1-\\nu^2} - \\frac{\\epsilon}{\\sqrt{1-\\nu^2}}$。\n$\\lambda_p(\\epsilon) \\approx (\\epsilon - i\\nu) + \\sqrt{1-\\nu^2} - \\frac{\\epsilon}{\\sqrt{1-\\nu^2}} = \\underbrace{(-i\\nu + \\sqrt{1-\\nu^2})}_{\\lambda_p(0)} + \\epsilon\\left(1 - \\frac{1}{\\sqrt{1-\\nu^2}}\\right)$。\n相位扰动由 $\\Delta\\phi \\approx \\text{Im}\\left(\\frac{\\delta\\lambda_p}{\\lambda_p(0)}\\right)$ 给出，其中 $\\delta\\lambda_p$ 是 $O(\\epsilon)$ 项。\n注意，对于未滤波的蛙跳格式，对于稳定模式（$\\nu^2 \\le 1$），有 $|\\lambda_p(0)|=|\\sqrt{1-\\nu^2} - i\\nu|=1$。\n因此，$\\frac{1}{\\lambda_p(0)} = \\overline{\\lambda_p(0)} = \\sqrt{1-\\nu^2} + i\\nu$。\n$\\Delta\\phi \\approx \\text{Im}\\left[ \\epsilon\\left(1 - \\frac{1}{\\sqrt{1-\\nu^2}}\\right) (\\sqrt{1-\\nu^2} + i\\nu) \\right]$。\n$\\Delta\\phi \\approx \\epsilon\\nu\\left(1 - \\frac{1}{\\sqrt{1-\\nu^2}}\\right)$。\n\n在 $\\theta = \\pi/4$ 处的相位误差约束是 $|\\Delta\\phi| \\le 0.007$。\n首先，我们用给定的参数计算 $\\nu$：$\\mu=0.4$ 和 $\\theta=\\pi/4$。\n$\\nu = 2\\mu\\sin\\theta = 2(0.4)\\sin(\\pi/4) = 0.8 \\frac{\\sqrt{2}}{2} = 0.4\\sqrt{2}$。\n由于 $\\nu^2 = (0.4\\sqrt{2})^2 = 0.32  1$，该格式是稳定的。\n相位误差的模为：\n$|\\Delta\\phi| = \\left|\\epsilon\\nu\\left(1 - \\frac{1}{\\sqrt{1-\\nu^2}}\\right)\\right| = \\epsilon\\nu\\left(\\frac{1}{\\sqrt{1-\\nu^2}} - 1\\right)$。\n括号中的项是 $\\frac{1}{\\sqrt{1-0.32}}-1 = \\frac{1}{\\sqrt{0.68}}-1$。\n我们要求 $|\\Delta\\phi| \\le 0.007$，所以我们找出允许的最大 $\\epsilon$：\n$\\epsilon \\le \\frac{0.007}{\\nu(\\frac{1}{\\sqrt{1-\\nu^2}}-1)} = \\frac{0.007}{0.4\\sqrt{2}(\\frac{1}{\\sqrt{0.68}} - 1)}$。\n让我们评估这个界限：\n$0.4\\sqrt{2} \\approx 0.565685$。\n$\\frac{1}{\\sqrt{0.68}} - 1 \\approx \\frac{1}{0.82462} - 1 \\approx 1.21268 - 1 = 0.21268$。\n$\\epsilon \\le \\frac{0.007}{0.565685 \\times 0.21268} \\approx \\frac{0.007}{0.12032} \\approx 0.058178$。\n\n**关于 $\\epsilon$ 的最终决定**\n\n1.  在 $\\theta=\\pi$ 处的计算模式衰减要求给出 $\\epsilon = 0.05$。\n2.  在 $\\theta=\\pi/4$ 处的相位误差限制要求 $\\epsilon \\le 0.058178...$。\n\n值 $\\epsilon=0.05$ 满足相位误差约束 ($0.05 \\le 0.058178...$)。\n根据问题陈述，“如果推导出的 $\\epsilon$ 违反了相位误差限制，[...] 否则，接受由计算模式衰减所确定的值。”\n由于没有违反，我们接受从计算模式衰减要求推导出的值。\n参数的最终值为 $\\epsilon = 0.05$。\n按照要求，所有角度都以弧度处理。结果是精确小数，无需四舍五入。",
            "answer": "$$\\boxed{0.05}$$"
        }
    ]
}