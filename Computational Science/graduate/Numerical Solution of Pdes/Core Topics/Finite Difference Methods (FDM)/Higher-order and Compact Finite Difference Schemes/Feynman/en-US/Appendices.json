{
    "hands_on_practices": [
        {
            "introduction": "The foundation of any finite difference method is the discrete operator that approximates a derivative. This first exercise  challenges you to build a sixth-order accurate explicit stencil for the first derivative from the ground up. By applying the method of undetermined coefficients with Taylor series, you will directly see how imposing accuracy conditions leads to a unique set of stencil weights, turning a theoretical requirement into a concrete computational tool.",
            "id": "3403002",
            "problem": "Consider a sufficiently smooth function $u(x)$ defined on a uniform grid $x_i = x_0 + i h$ with spacing $h > 0$. You seek an explicit central finite difference approximation for the first derivative $u'(x_i)$ that uses the symmetric seven-point stencil $\\{x_{i-3}, x_{i-2}, x_{i-1}, x_i, x_{i+1}, x_{i+2}, x_{i+3}\\}$. The discrete operator is of the form\n$$\nD_h u(x_i) = \\frac{1}{h} \\sum_{m=-3}^{3} w_m \\, u(x_{i+m}),\n$$\nwhere the weights $w_m$ are independent of $i$ and $h$.\n\nUsing the method of undetermined coefficients and the Taylor expansion of $u(x)$ about $x_i$, impose the following design principles:\n- The stencil is central and explicit, so $w_0 = 0$ and the weights satisfy antisymmetry $w_{-m} = - w_m$ for $m = 1, 2, 3$.\n- The approximation targets sixth-order accuracy, so it must be consistent with $u'(x_i)$ and eliminate all lower-order error terms implied by even-moment contributions in the Taylor series, yielding a truncation error proportional to $h^6$.\n\nStarting from these principles and no additional assumptions, derive the exact rational values of the weights $w_{-3}, w_{-2}, w_{-1}, w_0, w_{1}, w_{2}, w_{3}$ such that $D_h u(x_i)$ approximates $u'(x_i)$ with truncation error $\\mathcal{O}(h^6)$ for analytic $u(x)$. Provide your final answer as the ordered row of coefficients corresponding to $\\{u_{i-3}, u_{i-2}, u_{i-1}, u_i, u_{i+1}, u_{i+2}, u_{i+3}\\}$, expressed as exact rational numbers. No rounding is required. There are no physical units to report.\n\nFor context, this problem is set within the numerical solution of Partial Differential Equations (PDE), focusing on higher-order and compact finite difference schemes.",
            "solution": "The problem statement is evaluated to be valid. It is a well-posed problem in numerical analysis that is scientifically grounded, self-contained, and objective. We can proceed with a formal derivation of the finite difference weights.\n\nThe goal is to find the weights $w_m$ for the seven-point central finite difference approximation of the first derivative $u'(x_i)$:\n$$\nD_h u(x_i) = \\frac{1}{h} \\sum_{m=-3}^{3} w_m \\, u(x_{i+m})\n$$\nThe approximation must have a truncation error of order $\\mathcal{O}(h^6)$. The problem specifies two design principles:\n1.  The operator is explicit and central, implying $w_0 = 0$.\n2.  The weights are antisymmetric, $w_{-m} = -w_m$ for $m=1, 2, 3$.\n\nApplying these principles, the operator simplifies. The sum can be rewritten as:\n$$\nh D_h u(x_i) = w_0 u(x_i) + \\sum_{m=1}^{3} \\left( w_m u(x_{i+m}) + w_{-m} u(x_{i-m}) \\right)\n$$\nUsing $w_0 = 0$ and $w_{-m} = -w_m$:\n$$\nh D_h u(x_i) = \\sum_{m=1}^{3} w_m \\left( u(x_{i+m}) - u(x_{i-m}) \\right)\n$$\nThe unknowns are the three weights $w_1, w_2, w_3$. To determine them, we use the method of undetermined coefficients. This involves expanding the terms $u(x_{i \\pm m})$ in a Taylor series around the point $x_i$, under the assumption that $u(x)$ is sufficiently smooth. Let $u_i^{(k)}$ denote the $k$-th derivative of $u$ at $x_i$, i.e., $u^{(k)}(x_i)$.\n\nThe Taylor expansion for $u(x_i \\pm mh)$ is:\n$$\nu(x_i \\pm mh) = \\sum_{k=0}^{\\infty} \\frac{(\\pm mh)^k}{k!} u_i^{(k)} = u_i \\pm mh u_i' + \\frac{(mh)^2}{2!} u_i'' \\pm \\frac{(mh)^3}{3!} u_i''' + \\dots\n$$\nThe difference term $u(x_{i+m}) - u(x_{i-m})$ becomes:\n$$\nu(x_{i+m}) - u(x_{i-m}) = 2mh u_i' + 2\\frac{(mh)^3}{3!} u_i''' + 2\\frac{(mh)^5}{5!} u_i^{(5)} + 2\\frac{(mh)^7}{7!} u_i^{(7)} + \\mathcal{O}(h^9)\n$$\nNotice that due to the antisymmetry, all terms with even-order derivatives cancel. Substituting this back into the expression for $h D_h u(x_i)$:\n$$\nh D_h u(x_i) = \\sum_{m=1}^{3} w_m \\left( 2mh u_i' + \\frac{m^3 h^3}{3} u_i''' + \\frac{m^5 h^5}{60} u_i^{(5)} + \\frac{m^7 h^7}{2520} u_i^{(7)} + \\dots \\right)\n$$\nDividing by $h$ to get the operator $D_h u(x_i)$:\n$$\nD_h u(x_i) = \\sum_{m=1}^{3} w_m \\left( 2m u_i' + \\frac{m^3 h^2}{3} u_i''' + \\frac{m^5 h^4}{60} u_i^{(5)} + \\frac{m^7 h^6}{2520} u_i^{(7)} + \\mathcal{O}(h^8) \\right)\n$$\nWe can collect terms based on the derivatives of $u$:\n$$\nD_h u(x_i) = u_i' \\left( 2 \\sum_{m=1}^{3} m w_m \\right) + u_i''' \\frac{h^2}{3} \\left( \\sum_{m=1}^{3} m^3 w_m \\right) + u_i^{(5)} \\frac{h^4}{60} \\left( \\sum_{m=1}^{3} m^5 w_m \\right) + u_i^{(7)} \\frac{h^6}{2520} \\left( \\sum_{m=1}^{3} m^7 w_m \\right) + \\mathcal{O}(h^8)\n$$\nFor the operator $D_h u(x_i)$ to be a sixth-order accurate approximation of $u'(x_i)$, the following conditions must be met:\n1.  The coefficient of $u_i'$ must be $1$.\n2.  The coefficients of the $h^2 u_i'''$ and $h^4 u_i^{(5)}$ terms must be $0$.\n\nThis leads to a system of three linear equations for the three unknown weights $w_1, w_2, w_3$:\n$$\n\\begin{cases}\n2 \\sum_{m=1}^{3} m w_m = 1 \\\\\n\\sum_{m=1}^{3} m^3 w_m = 0 \\\\\n\\sum_{m=1}^{3} m^5 w_m = 0\n\\end{cases}\n$$\nWriting this system out explicitly:\n$$\n\\begin{cases}\n2(1 \\cdot w_1 + 2 \\cdot w_2 + 3 \\cdot w_3) = 1 \\\\\n1^3 w_1 + 2^3 w_2 + 3^3 w_3 = 0 \\\\\n1^5 w_1 + 2^5 w_2 + 3^5 w_3 = 0\n\\end{cases}\n\\implies\n\\begin{cases}\nw_1 + 2w_2 + 3w_3 = \\frac{1}{2} & \\text{(Eq. 1)} \\\\\nw_1 + 8w_2 + 27w_3 = 0 & \\text{(Eq. 2)} \\\\\nw_1 + 32w_2 + 243w_3 = 0 & \\text{(Eq. 3)}\n\\end{cases}\n$$\nWe solve this system. First, eliminate $w_1$.\nSubtract (Eq. 2) from (Eq. 3):\n$$\n(32-8)w_2 + (243-27)w_3 = 0 \\implies 24w_2 + 216w_3 = 0\n$$\n$$\nw_2 + 9w_3 = 0 \\implies w_2 = -9w_3 \\quad \\text{(Eq. 4)}\n$$\nSubtract (Eq. 1) from (Eq. 2):\n$$\n(8-2)w_2 + (27-3)w_3 = 0 - \\frac{1}{2} \\implies 6w_2 + 24w_3 = -\\frac{1}{2} \\quad \\text{(Eq. 5)}\n$$\nSubstitute (Eq. 4) into (Eq. 5):\n$$\n6(-9w_3) + 24w_3 = -\\frac{1}{2}\n$$\n$$\n-54w_3 + 24w_3 = -\\frac{1}{2}\n$$\n$$\n-30w_3 = -\\frac{1}{2} \\implies w_3 = \\frac{1}{60}\n$$\nNow, we can find $w_2$ using (Eq. 4):\n$$\nw_2 = -9w_3 = -9 \\left(\\frac{1}{60}\\right) = -\\frac{9}{60} = -\\frac{3}{20}\n$$\nFinally, we find $w_1$ using (Eq. 1):\n$$\nw_1 + 2\\left(-\\frac{3}{20}\\right) + 3\\left(\\frac{1}{60}\\right) = \\frac{1}{2}\n$$\n$$\nw_1 - \\frac{6}{20} + \\frac{3}{60} = \\frac{1}{2}\n$$\n$$\nw_1 - \\frac{3}{10} + \\frac{1}{20} = \\frac{1}{2}\n$$\n$$\nw_1 = \\frac{1}{2} + \\frac{3}{10} - \\frac{1}{20} = \\frac{10}{20} + \\frac{6}{20} - \\frac{1}{20} = \\frac{15}{20} = \\frac{3}{4}\n$$\nSo, the weights are $w_1 = \\frac{3}{4}$, $w_2 = -\\frac{3}{20}$, and $w_3 = \\frac{1}{60}$.\nThe full set of weights $\\{w_m\\}$ for $m \\in \\{-3, \\dots, 3\\}$ is determined by the given principles:\n- $w_0 = 0$\n- $w_1 = \\frac{3}{4}$, $w_{-1} = -w_1 = -\\frac{3}{4}$\n- $w_2 = -\\frac{3}{20}$, $w_{-2} = -w_2 = \\frac{3}{20}$\n- $w_3 = \\frac{1}{60}$, $w_{-3} = -w_3 = -\\frac{1}{60}$\n\nThe problem requests the final answer as the ordered row of coefficients corresponding to $\\{u_{i-3}, u_{i-2}, u_{i-1}, u_i, u_{i+1}, u_{i+2}, u_{i+3}\\}$. This refers to the ordered set of weights $(w_{-3}, w_{-2}, w_{-1}, w_0, w_1, w_2, w_3)$, which are rational numbers independent of $h$ by construction.\n\nThe ordered row of weights is:\n$$\n\\left( -\\frac{1}{60}, \\frac{3}{20}, -\\frac{3}{4}, 0, \\frac{3}{4}, -\\frac{3}{20}, \\frac{1}{60} \\right)\n$$\nThe truncation error is determined by the first non-zero term we neglected. The coefficient is $\\frac{h^6}{2520}\\sum_{m=1}^{3} m^7 w_m$. Let's compute the sum:\n$$\n\\sum_{m=1}^{3} m^7 w_m = 1^7\\left(\\frac{3}{4}\\right) + 2^7\\left(-\\frac{3}{20}\\right) + 3^7\\left(\\frac{1}{60}\\right) = \\frac{3}{4} - 128\\frac{3}{20} + \\frac{2187}{60}\n$$\n$$\n= \\frac{3}{4} - \\frac{96}{5} + \\frac{729}{20} = \\frac{15 - 384 + 729}{20} = \\frac{360}{20} = 18\n$$\nThus, the leading error term is $\\frac{18 h^6}{2520} u_i^{(7)} = \\frac{h^6}{140} u_i^{(7)}$. The truncation error is indeed $\\mathcal{O}(h^6)$, confirming the sixth-order accuracy.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -\\frac{1}{60} & \\frac{3}{20} & -\\frac{3}{4} & 0 & \\frac{3}{4} & -\\frac{3}{20} & \\frac{1}{60} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "Once a scheme is constructed, we must be able to quantify its precision. This practice  focuses on analyzing the local truncation error, the principal measure of a scheme's accuracy. You will dissect a standard fourth-order formula for the second derivative, $u''(x_i)$, and derive its leading error term, revealing how the error depends on the grid spacing $h$ and higher derivatives of the solution.",
            "id": "3403038",
            "problem": "Consider a uniform grid $\\{x_i\\}_{i \\in \\mathbb{Z}}$ with spacing $h>0$ for a sufficiently smooth function $u(x)$ possessing at least six continuous derivatives in a neighborhood of $x_i$. The fourth-order central finite difference approximation to the second derivative at $x_i$ is defined by\n$$\nD^{(2)}_h u(x_i) \\equiv \\frac{-u_{i+2}+16 u_{i+1}-30 u_i+16 u_{i-1}-u_{i-2}}{12 h^2},\n$$\nwhere $u_j \\equiv u(x_j)$ and $x_j = x_i + (j-i) h$. Using the Taylor series expansion about $x_i$ and only first principles valid in numerical analysis, derive the leading term of the local truncation error of $D^{(2)}_h u(x_i)$ when used to approximate $u''(x_i)$, and express it in the form\n$$\n\\mathrm{TE} \\equiv D^{(2)}_h u(x_i) - u''(x_i) = C\\, h^4\\, u^{(6)}(x_i) + \\mathcal{O}(h^6).\n$$\nIdentify the constant $C$ multiplying $h^4 u^{(6)}(x_i)$. Provide your final answer as the single real number $C$.",
            "solution": "The problem requires the derivation of the leading term of the local truncation error for a given fourth-order central finite difference approximation of the second derivative, $u''(x_i)$. The approximation is given by\n$$\nD^{(2)}_h u(x_i) \\equiv \\frac{-u_{i+2}+16 u_{i+1}-30 u_i+16 u_{i-1}-u_{i-2}}{12 h^2}\n$$\nwhere $u_j \\equiv u(x_j)$ and $x_j = x_i + (j-i)h$ for a grid with uniform spacing $h > 0$. The function $u(x)$ is assumed to be sufficiently smooth, possessing at least six continuous derivatives. The local truncation error, $\\mathrm{TE}$, is defined as $\\mathrm{TE} = D^{(2)}_h u(x_i) - u''(x_i)$. We are to find the constant $C$ in the expression $\\mathrm{TE} = C h^4 u^{(6)}(x_i) + \\mathcal{O}(h^6)$.\n\nTo achieve this, we employ Taylor series expansions for each term $u_{i+k}$ in the numerator of the expression for $D^{(2)}_h u(x_i)$ around the point $x_i$. Let $u^{(n)}(x_i)$ denote the $n$-th derivative of $u$ evaluated at $x_i$. Since the expected order of the leading error term is $h^4$, and the operator has a denominator of $h^2$, we must expand the numerator to at least the order of $h^6$ to capture the leading error term. To be rigorous and confirm the order of the next term, we will expand up to terms of order $h^7$.\n\nThe Taylor series expansion of $u(x_i + kh)$ about $x_i$ is:\n$$\nu(x_i+kh) = u(x_i) + (kh)u'(x_i) + \\frac{(kh)^2}{2!}u''(x_i) + \\frac{(kh)^3}{3!}u'''(x_i) + \\frac{(kh)^4}{4!}u^{(4)}(x_i) + \\frac{(kh)^5}{5!}u^{(5)}(x_i) + \\frac{(kh)^6}{6!}u^{(6)}(x_i) + \\mathcal{O}(h^7)\n$$\nWe apply this for $k \\in \\{-2, -1, 1, 2\\}$:\nFor $k=1$:\n$$u_{i+1} = u(x_i) + h u'(x_i) + \\frac{h^2}{2} u''(x_i) + \\frac{h^3}{6} u'''(x_i) + \\frac{h^4}{24} u^{(4)}(x_i) + \\frac{h^5}{120} u^{(5)}(x_i) + \\frac{h^6}{720} u^{(6)}(x_i) + \\mathcal{O}(h^7)$$\nFor $k=-1$:\n$$u_{i-1} = u(x_i) - h u'(x_i) + \\frac{h^2}{2} u''(x_i) - \\frac{h^3}{6} u'''(x_i) + \\frac{h^4}{24} u^{(4)}(x_i) - \\frac{h^5}{120} u^{(5)}(x_i) + \\frac{h^6}{720} u^{(6)}(x_i) - \\mathcal{O}(h^7)$$\nFor $k=2$:\n$$u_{i+2} = u(x_i) + 2h u'(x_i) + \\frac{4h^2}{2} u''(x_i) + \\frac{8h^3}{6} u'''(x_i) + \\frac{16h^4}{24} u^{(4)}(x_i) + \\frac{32h^5}{120} u^{(5)}(x_i) + \\frac{64h^6}{720} u^{(6)}(x_i) + \\mathcal{O}(h^7)$$\nFor $k=-2$:\n$$u_{i-2} = u(x_i) - 2h u'(x_i) + \\frac{4h^2}{2} u''(x_i) - \\frac{8h^3}{6} u'''(x_i) + \\frac{16h^4}{24} u^{(4)}(x_i) - \\frac{32h^5}{120} u^{(5)}(x_i) + \\frac{64h^6}{720} u^{(6)}(x_i) - \\mathcal{O}(h^7)$$\n\nWe now substitute these expansions into the numerator of $D^{(2)}_h u(x_i)$, which we denote by $N$:\n$$\nN = -u_{i+2} + 16u_{i+1} - 30u_i + 16u_{i-1} - u_{i-2}\n$$\nLet's collect coefficients for each derivative of $u(x_i)$:\nCoefficient of $u(x_i)$:\n$$-1 + 16 - 30 + 16 - 1 = 0$$\nCoefficient of $u'(x_i)$:\n$$h(-2 + 16(1) + 16(-1) - (-2)) = h(-2 + 16 - 16 + 2) = 0$$\nCoefficient of $u''(x_i)$:\n$$\\frac{h^2}{2}(-4 + 16(1) + 16(1) - 4) = \\frac{h^2}{2}(24) = 12h^2$$\nCoefficient of $u'''(x_i)$:\n$$\\frac{h^3}{6}(-8 + 16(1) + 16(-1) - (-8)) = \\frac{h^3}{6}(-8 + 16 - 16 + 8) = 0$$\nCoefficient of $u^{(4)}(x_i)$:\n$$\\frac{h^4}{24}(-16 + 16(1) + 16(1) - 16) = \\frac{h^4}{24}(-16 + 16 + 16 - 16) = 0$$\nCoefficient of $u^{(5)}(x_i)$:\n$$\\frac{h^5}{120}(-32 + 16(1) + 16(-1) - (-32)) = \\frac{h^5}{120}(-32 + 16 - 16 + 32) = 0$$\nCoefficient of $u^{(6)}(x_i)$:\n$$\\frac{h^6}{720}(-64 + 16(1) + 16(1) - 64) = \\frac{h^6}{720}(32 - 128) = -\\frac{96}{720}h^6$$\nSimplifying the fraction: $\\frac{96}{720} = \\frac{12 \\times 8}{12 \\times 60} = \\frac{8}{60} = \\frac{2}{15}$.\nSo, the coefficient is $-\\frac{2}{15}h^6$.\n\nThe cancellation of all odd-order derivative terms is due to the symmetry of the stencil coefficients $(-1, 16, -30, 16, -1)$. The cancellation of the $u^{(4)}(x_i)$ term is by design of this specific higher-order formula.\n\nThe numerator $N$ can thus be expressed as:\n$$\nN = 12h^2 u''(x_i) - \\frac{2}{15}h^6 u^{(6)}(x_i) + \\mathcal{O}(h^8)\n$$\nNote that the next non-zero term would involve $u^{(8)}(x_i)$, so the remainder is of order $h^8$.\n\nNow, we substitute this back into the expression for $D^{(2)}_h u(x_i)$:\n$$\nD^{(2)}_h u(x_i) = \\frac{N}{12h^2} = \\frac{1}{12h^2} \\left( 12h^2 u''(x_i) - \\frac{2}{15}h^6 u^{(6)}(x_i) + \\mathcal{O}(h^8) \\right)\n$$\n$$\nD^{(2)}_h u(x_i) = u''(x_i) - \\frac{2}{12 \\times 15} h^4 u^{(6)}(x_i) + \\mathcal{O}(h^6)\n$$\n$$\nD^{(2)}_h u(x_i) = u''(x_i) - \\frac{2}{180} h^4 u^{(6)}(x_i) + \\mathcal{O}(h^6)\n$$\n$$\nD^{(2)}_h u(x_i) = u''(x_i) - \\frac{1}{90} h^4 u^{(6)}(x_i) + \\mathcal{O}(h^6)\n$$\nThe local truncation error $\\mathrm{TE}$ is defined as $\\mathrm{TE} = D^{(2)}_h u(x_i) - u''(x_i)$. Therefore,\n$$\n\\mathrm{TE} = \\left( u''(x_i) - \\frac{1}{90} h^4 u^{(6)}(x_i) + \\mathcal{O}(h^6) \\right) - u''(x_i)\n$$\n$$\n\\mathrm{TE} = -\\frac{1}{90} h^4 u^{(6)}(x_i) + \\mathcal{O}(h^6)\n$$\nBy comparing this result to the specified form $\\mathrm{TE} = C h^4 u^{(6)}(x_i) + \\mathcal{O}(h^6)$, we can identify the constant $C$.\n$$\nC = -\\frac{1}{90}\n$$",
            "answer": "$$\n\\boxed{-\\frac{1}{90}}\n$$"
        },
        {
            "introduction": "Local accuracy is essential, but it does not fully capture how a scheme behaves when simulating time-dependent phenomena like wave propagation. This final exercise  introduces you to dispersion analysis, a powerful technique for evaluating a scheme's spectral fidelity. By examining a compact finite difference scheme applied to the linear advection equation, $u_t + a u_x = 0$, you will derive its modified wavenumber and phase speed error, uncovering how numerical errors cause waves of different frequencies to travel at incorrect speeds.",
            "id": "3403022",
            "problem": "Consider the linear constant-coefficient partial differential equation (PDE) $u_{t} + a\\,u_{x} = 0$ posed on a periodic spatial domain $x \\in [0,L]$ with constant advection speed $a>0$. Discretize the spatial domain with $N$ uniformly spaced grid points $x_{j} = j h$ for $j=0,1,\\dots,N-1$, where $h = L/N$. Let $D u_{j}$ denote a discrete approximation to $u_{x}(x_{j},t)$ obtained by the classical fourth-order tridiagonal central compact finite difference scheme defined implicitly by\n$$\n\\frac{1}{4}\\,D u_{j-1} + D u_{j} + \\frac{1}{4}\\,D u_{j+1} \\;=\\; \\frac{3}{4 h}\\,\\big(u_{j+1} - u_{j-1}\\big).\n$$\nForm the semi-discrete system\n$$\n\\frac{d u_{j}}{d t} + a\\,D u_{j} = 0,\\qquad j=0,1,\\dots,N-1,\n$$\nwith periodic indexing. Using a discrete Fourier mode ansatz $u_{j}(t) = \\hat{u}\\,\\exp\\!\\big(i\\,(k x_{j} + \\omega t)\\big)$, derive the semi-discrete dispersion relation in the form $\\omega(k) = -a\\,\\tilde{k}(k h)$, where $\\tilde{k}(k h)$ is the schemeâ€™s modified wavenumber, and then compute the phase speed error $c_{p}(k) - a$, where the phase speed is defined by $c_{p}(k) = -\\omega(k)/k$. Express your final answer as a single closed-form analytic expression in terms of $a$, $k$, and $h$. No rounding is required, and no physical units should be included in your answer.",
            "solution": "The user wants to find the phase speed error for a semi-discretization of the linear advection equation.\n\n### Step 1: Extract Givens\n-   Partial Differential Equation (PDE): $u_{t} + a\\,u_{x} = 0$\n-   Domain: $x \\in [0,L]$, periodic\n-   Advection speed: $a>0$, constant\n-   Spatial discretization: $x_{j} = j h$ for $j=0,1,\\dots,N-1$, where $h = L/N$.\n-   Compact finite difference scheme for $D u_j \\approx u_x(x_j, t)$:\n    $$\n    \\frac{1}{4}\\,D u_{j-1} + D u_{j} + \\frac{1}{4}\\,D u_{j+1} \\;=\\; \\frac{3}{4 h}\\,\\big(u_{j+1} - u_{j-1}\\big)\n    $$\n-   Semi-discrete system:\n    $$\n    \\frac{d u_{j}}{d t} + a\\,D u_{j} = 0,\\qquad j=0,1,\\dots,N-1\n    $$\n-   Fourier mode ansatz: $u_{j}(t) = \\hat{u}\\,\\exp\\!\\big(i\\,(k x_{j} + \\omega t)\\big)$, where $k$ is the wavenumber and $\\omega$ is the frequency.\n-   Objective 1: Derive the semi-discrete dispersion relation $\\omega(k) = -a\\,\\tilde{k}(k h)$, where $\\tilde{k}$ is the modified wavenumber.\n-   Objective 2: Compute the phase speed error $c_{p}(k) - a$, where the phase speed $c_{p}(k) = -\\omega(k)/k$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, being a standard topic in the numerical analysis of partial differential equations. It is well-posed, with all necessary information provided to perform the required Fourier analysis. The language is objective and precise. The problem is self-contained and free of contradictions or ambiguities. It asks for a standard derivation in the field of computational fluid dynamics and numerical methods.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\n### Derivation of the Solution\nThe core of the analysis is to determine how the discrete spatial derivative operator, $D$, acts on a single Fourier mode. We substitute the provided ansatz, $u_{j}(t) = \\hat{u}\\,\\exp\\!\\big(i\\,(k x_{j} + \\omega t)\\big)$, into the defining equation for the compact scheme. For the spatial part, we can write $u_j = U(t) \\exp(ikx_j)$ where $U(t) = \\hat{u}\\exp(i\\omega t)$. Since the operator $D$ is linear and acts only on the spatial variable, we can expect that applying $D$ to $u_j$ will result in a complex multiple of $u_j$. Let's denote this action as $D u_j = (i\\tilde{k}) u_j$, where $\\tilde{k}$ is the modified wavenumber that we need to find. This implies $D u_{j \\pm 1} = (i \\tilde{k}) u_{j \\pm 1}$.\n\nFirst, let's express the shifted terms $u_{j\\pm1}$ and $D u_{j\\pm1}$ in terms of $u_j$ and $D u_j$ respectively:\n$$\nu_{j\\pm1} = \\hat{u}\\,\\exp\\!\\big(i\\,(k x_{j\\pm1} + \\omega t)\\big) = \\hat{u}\\,\\exp\\!\\big(i\\,(k (j\\pm1)h + \\omega t)\\big) = \\hat{u}\\,\\exp\\!\\big(i\\,(kjh \\pm kh + \\omega t)\\big) = u_j \\exp(\\pm ikh)\n$$\nSimilarly, due to the linearity of the operator $D$, we have:\n$$\nD u_{j\\pm1} = (D u_j) \\exp(\\pm ikh)\n$$\nNow, substitute these relations into the definition of the compact scheme:\n$$\n\\frac{1}{4}\\,(D u_j) \\exp(-ikh) + D u_j + \\frac{1}{4}\\,(D u_j) \\exp(ikh) \\;=\\; \\frac{3}{4 h}\\,\\big(u_j \\exp(ikh) - u_j \\exp(-ikh)\\big)\n$$\nFactor out $D u_j$ from the left-hand side and $u_j$ from the right-hand side:\n$$\n(D u_j) \\left( \\frac{1}{4}\\exp(-ikh) + 1 + \\frac{1}{4}\\exp(ikh) \\right) \\;=\\; u_j \\, \\frac{3}{4 h}\\,\\big(\\exp(ikh) - \\exp(-ikh)\\big)\n$$\nUsing Euler's identities, $\\cos(\\theta) = \\frac{\\exp(i\\theta) + \\exp(-i\\theta)}{2}$ and $\\sin(\\theta) = \\frac{\\exp(i\\theta) - \\exp(-i\\theta)}{2i}$, we can simplify the expressions in the parentheses:\n$$\n\\frac{1}{4}\\exp(-ikh) + 1 + \\frac{1}{4}\\exp(ikh) = 1 + \\frac{1}{2} \\left( \\frac{\\exp(ikh) + \\exp(-ikh)}{2} \\right) = 1 + \\frac{1}{2}\\cos(kh)\n$$\n$$\n\\exp(ikh) - \\exp(-ikh) = 2i\\sin(kh)\n$$\nSubstituting these back into the equation yields:\n$$\n(D u_j) \\left( 1 + \\frac{1}{2}\\cos(kh) \\right) \\;=\\; u_j \\, \\frac{3}{4 h}\\,(2i\\sin(kh))\n$$\n$$\n(D u_j) \\left( \\frac{2+\\cos(kh)}{2} \\right) \\;=\\; u_j \\, \\frac{3i\\sin(kh)}{2h}\n$$\nSolving for $D u_j$:\n$$\nD u_j \\;=\\; u_j \\, \\frac{3i\\sin(kh)}{h(2+\\cos(kh))}\n$$\nFor the exact differential operator $\\frac{\\partial}{\\partial x}$, its action on $\\exp(ikx)$ is multiplication by $ik$. The discrete operator $D$ acts on the discrete mode $\\exp(ikx_j)$ by multiplication with $i\\tilde{k}$. By comparing our result with the form $D u_j = i \\tilde{k} u_j$, we identify the modified wavenumber $\\tilde{k}$ as:\n$$\n\\tilde{k}(k, h) \\;=\\; \\frac{3\\sin(kh)}{h(2+\\cos(kh))}\n$$\nNext, we substitute the ansatz $u_j(t) = \\hat{u}\\,\\exp(i(kx_j + \\omega t))$ into the semi-discrete system $\\frac{du_j}{dt} + a D u_j = 0$.\nThe time derivative is $\\frac{du_j}{dt} = i\\omega u_j$. The spatial term is $a D u_j = a (i\\tilde{k}) u_j$.\nThe semi-discrete system becomes:\n$$\ni\\omega u_j + a(i\\tilde{k}) u_j = 0\n$$\nDividing by $i u_j$ (which is non-zero), we obtain the semi-discrete dispersion relation:\n$$\n\\omega(k) = -a \\tilde{k} = -a \\frac{3\\sin(kh)}{h(2+\\cos(kh))}\n$$\nThe problem defines the numerical phase speed as $c_p(k) = -\\omega(k)/k$. Substituting our expression for $\\omega(k)$:\n$$\nc_p(k) = -\\frac{1}{k} \\left( -a \\frac{3\\sin(kh)}{h(2+\\cos(kh))} \\right) = a \\frac{3\\sin(kh)}{kh(2+\\cos(kh))}\n$$\nFor the exact PDE $u_t + a u_x = 0$, the dispersion relation is $\\omega_{\\text{exact}} = -ak$, which gives an exact phase speed of $c_{\\text{exact}} = -\\omega_{\\text{exact}}/k = a$. The phase speed error is the difference between the numerical phase speed and the exact phase speed, $c_p(k) - a$:\n$$\nc_p(k) - a \\;=\\; a \\frac{3\\sin(kh)}{kh(2+\\cos(kh))} - a\n$$\nFactoring out the constant advection speed $a$:\n$$\nc_p(k) - a \\;=\\; a \\left( \\frac{3\\sin(kh)}{kh(2+\\cos(kh))} - 1 \\right)\n$$\nTo express this as a single fraction, we find a common denominator:\n$$\nc_p(k) - a \\;=\\; a \\left( \\frac{3\\sin(kh) - kh(2+\\cos(kh))}{kh(2+\\cos(kh))} \\right)\n$$\nThis is the final closed-form analytic expression for the phase speed error.",
            "answer": "$$\n\\boxed{a \\left( \\frac{3\\sin(kh) - kh(2+\\cos(kh))}{kh(2+\\cos(kh))} \\right)}\n$$"
        }
    ]
}