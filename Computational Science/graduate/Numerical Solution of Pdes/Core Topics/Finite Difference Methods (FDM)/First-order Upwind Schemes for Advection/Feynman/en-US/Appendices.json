{
    "hands_on_practices": [
        {
            "introduction": "Understanding a numerical method begins with building it from its theoretical foundations. This first practice guides you through the entire process for the first-order upwind scheme, starting from the integral form of the conservation law. By deriving the numerical flux from the local Riemann problem and then implementing the scheme in code, you will gain a concrete understanding of its structure and behavior when applied to both smooth and discontinuous solutions .",
            "id": "3394603",
            "problem": "Consider the linear constant-coefficient advection partial differential equation (PDE) $u_{t} + a\\,u_{x} = 0$ on a one-dimensional periodic domain of length $L$. Starting only from the integral conservation form over a moving control volume and the requirement that the discrete flux must respect upwind information propagation, derive a first-order accurate in space and time, monotone, conservative discretization based on piecewise constant cell averages on a uniform grid with spacing $\\Delta x$ and a forward Euler time discretization with time step $\\Delta t$. Your derivation must justify the choice of the numerical flux at cell interfaces in terms of the local one-dimensional Riemann problem and must produce an explicit update that depends on the sign of the constant advection speed $a$. State a stability condition in terms of the Courant–Friedrichs–Lewy (CFL) number $\\nu = a\\,\\Delta t/\\Delta x$ and explain how it is obtained from the forward Euler discretization and the monotonicity of the spatial operator.\n\nThen, implement a program that:\n- Constructs a uniform grid of $N$ points on $[0,L)$ representing cell centers, with periodic boundary conditions.\n- Initializes $u(x,0)$ from one of several prescribed profiles $u_{0}(x)$.\n- Advances the numerical solution using your first-order upwind scheme until a specified final time $t_{f}$, using a time step $\\Delta t$ determined by a prescribed CFL number and the grid spacing, with the last step reduced so that the total time equals exactly $t_{f}$.\n- Computes the exact solution at time $t_{f}$ as $u(x,t_{f}) = u_{0}\\!\\left(\\operatorname{mod}\\!\\left(x - a\\,t_{f},\\,L\\right)\\right)$, where $\\operatorname{mod}(\\cdot,L)$ returns a value in $[0,L)$, and evaluates it at grid points.\n- Returns the discrete $L^{2}$-error defined by $\\left(\\Delta x \\sum_{i=0}^{N-1} \\left(u^{\\text{num}}_{i}(t_{f}) - u^{\\text{exact}}(x_{i},t_{f})\\right)^{2}\\right)^{1/2}$ as a floating-point number.\n\nYour program must run a fixed test suite of four cases, each specified by $(N, a, L, \\text{CFL}, t_{f}, u_{0})$, and output all four resulting $L^{2}$-errors on a single line as a comma-separated list enclosed in square brackets, with each value rounded to exactly eight digits after the decimal point, for example, $[0.01230000,0.00000000,1.23456789,0.00010000]$.\n\nUse radians for trigonometric functions. There are no physical units in this task.\n\nTest Suite:\n- Case $1$ (smooth wave, positive advection, moderate CFL): $N=400$, $a=1.0$, $L=1.0$, $\\text{CFL}=0.5$, $t_{f}=0.3$, $u_{0}(x) = \\sin(2\\pi x)$.\n- Case $2$ (discontinuous wave, negative advection, near-CFL limit): $N=600$, $a=-0.8$, $L=1.0$, $\\text{CFL}=0.9$, $t_{f}=0.25$, $u_{0}(x) = \\begin{cases}1,  x \\in [0.25,0.75) \\\\ 0,  \\text{otherwise}\\end{cases}$ with periodic extension.\n- Case $3$ (Gaussian pulse, exact-shift edge case): $N=500$, $a=1.0$, $L=1.0$, $\\text{CFL}=1.0$, $t_{f}=1.0$, $u_{0}(x) = \\exp\\!\\left(-100\\,(x - 0.3)^{2}\\right)$.\n- Case $4$ (multimode smooth wave, close to CFL limit): $N=512$, $a=0.5$, $L=1.0$, $\\text{CFL}=0.99$, $t_{f}=0.2$, $u_{0}(x) = \\cos(4\\pi x) + 0.5\\,\\sin(2\\pi x)$.\n\nImplementation requirements:\n- Use periodic boundary conditions for all cases.\n- The numerical update must use the correct upwind direction determined by the sign of $a$.\n- The exact solution evaluation must use the modulo operation to wrap into $[0,L)$.\n- The final print must be a single line containing the four $L^{2}$-errors as described, with no additional output.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[e_{1},e_{2},e_{3},e_{4}]$), where each $e_{k}$ is a floating-point number rounded to eight decimals as specified above.",
            "solution": "We begin from the integral conservation statement for the linear advection equation $u_{t} + a\\,u_{x} = 0$, which can be written as $u_{t} + (f(u))_{x} = 0$ with $f(u) = a\\,u$ and constant $a \\in \\mathbb{R}$. Consider a uniform partition of the domain $[0,L)$ into $N$ cells $I_{i} = [x_{i-1/2}, x_{i+1/2})$ of equal length $\\Delta x = L/N$, with cell centers $x_{i} = (i + 1/2)\\Delta x$ for $i \\in \\{0,\\dots,N-1\\}$. Define the cell average $u_{i}(t) = \\frac{1}{\\Delta x}\\int_{I_{i}} u(x,t)\\,dx$. Integrating $u_{t} + (f(u))_{x} = 0$ over $I_{i}$ and applying the divergence theorem yields\n$$\n\\frac{d}{dt} u_{i}(t) + \\frac{1}{\\Delta x}\\left( f\\!\\left(u(x_{i+1/2}^{-},t)\\right) - f\\!\\left(u(x_{i-1/2}^{+},t)\\right)\\right) = 0,\n$$\nwhere $u(x_{i+1/2}^{-},t)$ and $u(x_{i-1/2}^{+},t)$ denote the traces at the interfaces. In a finite volume method with piecewise constant reconstruction, the interface states are obtained by solving a local Riemann problem at each interface. For linear advection $u_{t} + a\\,u_{x} = 0$, characteristics move with speed $a$. The physically admissible solution at $x_{i+1/2}$ uses upstream information: if $a  0$, the left state $u_{i}$ convects into $I_{i+1}$, while if $a  0$, the right state $u_{i+1}$ convects into $I_{i}$. Therefore, a consistent and monotone numerical flux $F_{i+1/2}$ at the interface is obtained by the upwind (Godunov) flux:\n$$\nF_{i+1/2} =\n\\begin{cases}\na\\,u_{i},  a \\ge 0, \\\\\na\\,u_{i+1},  a  0.\n\\end{cases}\n$$\nThe semi-discrete conservative scheme is then\n$$\n\\frac{d}{dt} u_{i}(t) = -\\frac{1}{\\Delta x}\\left(F_{i+1/2}(t) - F_{i-1/2}(t)\\right).\n$$\nDiscretizing in time with forward Euler over a time step $\\Delta t$ gives\n$$\nu_{i}^{n+1} = u_{i}^{n} - \\frac{\\Delta t}{\\Delta x}\\left(F_{i+1/2}^{n} - F_{i-1/2}^{n}\\right).\n$$\nUsing the upwind flux for constant $a$, this reduces to explicit updates. For $a  0$,\n$$\nu_{i}^{n+1} = u_{i}^{n} - \\nu\\,(u_{i}^{n} - u_{i-1}^{n}), \\quad \\nu = \\frac{a\\,\\Delta t}{\\Delta x},\n$$\nand for $a  0$,\n$$\nu_{i}^{n+1} = u_{i}^{n} - \\nu\\,(u_{i+1}^{n} - u_{i}^{n}), \\quad \\nu = \\frac{a\\,\\Delta t}{\\Delta x}.\n$$\nThese formulas are conservative and monotone under an appropriate stability condition. Because forward Euler applied to a spatially monotone flux-difference operator must preserve convex combinations, stability and monotonicity require that the update coefficients be nonnegative and sum to one. For $a  0$, the update $u_{i}^{n+1} = (1-\\nu)\\,u_{i}^{n} + \\nu\\,u_{i-1}^{n}$ is a convex combination if and only if $0 \\le \\nu \\le 1$. For $a  0$, writing $u_{i}^{n+1} = (1+ \\nu)\\,u_{i}^{n} - \\nu\\,u_{i+1}^{n} = (1-|\\nu|)\\,u_{i}^{n} + |\\nu|\\,u_{i+1}^{n}$ shows convexity if and only if $0 \\le |\\nu| \\le 1$. Thus, the Courant–Friedrichs–Lewy (CFL) condition for stability and monotonicity is\n$$\n|\\nu| = \\left|\\frac{a\\,\\Delta t}{\\Delta x}\\right| \\le 1.\n$$\nThis bound is tight for linear advection with the upwind flux and forward Euler. Under this condition, the method is total variation diminishing (TVD) and $L^{1}$-stable.\n\nThe exact solution of the initial value problem on the periodic interval $[0,L)$ with period $L$ is given by translation along characteristics:\n$$\nu(x,t) = u_{0}\\!\\left(\\operatorname{mod}\\!\\left(x - a\\,t,\\,L\\right)\\right),\n$$\nwhere $\\operatorname{mod}(y,L)$ maps $y$ to its representative in $[0,L)$. On a uniform grid, the exact solution at grid points $x_{i}$ can be obtained by evaluating $u_{0}$ at the shifted positions with periodic wrap-around.\n\nAlgorithmic design for implementation:\n- Choose $N$ and define $\\Delta x = L/N$ and $x_{i} = (i+1/2)\\Delta x$ for $i \\in \\{0,\\dots,N-1\\}$.\n- Initialize $u^{0}_{i} = u_{0}(x_{i})$.\n- Set a nominal time step $\\Delta t_{\\text{nom}} = \\text{CFL}\\,\\Delta x/|a|$ if $a \\ne 0$. Determine the number of full steps $n_{\\text{full}} = \\left\\lfloor t_{f}/\\Delta t_{\\text{nom}}\\right\\rfloor$. March for $n_{\\text{full}}$ steps with $\\Delta t = \\Delta t_{\\text{nom}}$, and, if $t_{f}$ is not an integer multiple of $\\Delta t_{\\text{nom}}$, take one last step with $\\Delta t_{\\text{last}} = t_{f} - n_{\\text{full}}\\Delta t_{\\text{nom}}$. For each step, compute $\\nu = a\\,\\Delta t/\\Delta x$ and apply the upwind update with periodic indices ($u_{-1} \\equiv u_{N-1}$ and $u_{N} \\equiv u_{0}$).\n- Compute the exact solution array $u^{\\text{exact}}_{i} = u_{0}\\!\\left(\\operatorname{mod}\\!\\left(x_{i} - a\\,t_{f},\\,L\\right)\\right)$.\n- Compute the discrete $L^{2}$-error $E = \\left(\\Delta x \\sum_{i=0}^{N-1} (u^{n_{\\text{final}}}_{i} - u^{\\text{exact}}_{i})^{2}\\right)^{1/2}$.\n- Repeat for each test case.\n\nDiscussion of truncation error and numerical diffusion: A modified equation analysis shows that the first-order upwind method for linear advection approximates\n$$\nu_{t} + a\\,u_{x} = \\frac{1}{2}|a|\\,\\Delta x\\,(1 - |\\nu|)\\,u_{xx} + \\mathcal{O}(\\Delta x^{2}, \\Delta t^{2}),\n$$\nrevealing a leading-order artificial diffusion term of magnitude $\\frac{1}{2}|a|\\,\\Delta x\\,(1 - |\\nu|)$, which vanishes at the edge case $|\\nu|=1$. This is consistent with the special case where, for $a0$ and $\\nu=1$, the scheme reduces to a pure shift $u_{i}^{n+1} = u_{i-1}^{n}$, yielding an exact discrete translation on the grid and exact periodicity after a full domain traversal when $t_{f} = L/a$.\n\nThe implementation uses the periodic boundary condition by indexing with modulo $N$ or by vectorized circular shifts. The exact solution and all initial conditions are evaluated using radians for trigonometric functions. The program constructs and runs the specified four cases:\n- Case $1$: $N=400$, $a=1.0$, $L=1.0$, $\\text{CFL}=0.5$, $t_{f}=0.3$, $u_{0}(x)=\\sin(2\\pi x)$.\n- Case $2$: $N=600$, $a=-0.8$, $L=1.0$, $\\text{CFL}=0.9$, $t_{f}=0.25$, $u_{0}(x)=1$ on $[0.25,0.75)$ and $0$ otherwise (periodic).\n- Case $3$: $N=500$, $a=1.0$, $L=1.0$, $\\text{CFL}=1.0$, $t_{f}=1.0$, $u_{0}(x)=\\exp(-100\\,(x-0.3)^{2})$.\n- Case $4$: $N=512$, $a=0.5$, $L=1.0$, $\\text{CFL}=0.99$, $t_{f}=0.2$, $u_{0}(x)=\\cos(4\\pi x) + 0.5\\,\\sin(2\\pi x)$.\n\nFinally, the program prints a single line $[e_{1},e_{2},e_{3},e_{4}]$ with each $e_{k}$ rounded to eight decimals, as required.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef initial_condition(x, kind):\n    # x in [0, L)\n    if kind == \"sine\":\n        return np.sin(2.0 * np.pi * x)\n    elif kind == \"square\":\n        # 1 on [0.25,0.75), 0 otherwise, periodic\n        return np.where((x >= 0.25)  (x  0.75), 1.0, 0.0)\n    elif kind == \"gaussian\":\n        return np.exp(-100.0 * (x - 0.3) ** 2)\n    elif kind == \"mix\":\n        return np.cos(4.0 * np.pi * x) + 0.5 * np.sin(2.0 * np.pi * x)\n    else:\n        raise ValueError(\"Unknown initial condition kind\")\n\ndef exact_solution(x, a, L, t, kind):\n    # periodic wrap of x - a t into [0, L)\n    y = (x - a * t) % L\n    return initial_condition(y, kind)\n\ndef upwind_step(u, a, dt, dx):\n    # Periodic first-order upwind update for constant a\n    nu = a * dt / dx\n    if a > 0:\n        # u_i^{n+1} = u_i^n - nu (u_i^n - u_{i-1}^n)\n        u_im1 = np.roll(u, 1)\n        return u - nu * (u - u_im1)\n    elif a  0:\n        # u_i^{n+1} = u_i^n - nu (u_{i+1}^n - u_i^n); note nu0\n        u_ip1 = np.roll(u, -1)\n        return u - nu * (u_ip1 - u)\n    else:\n        # a == 0, no evolution\n        return u.copy()\n\ndef run_case(N, a, L, CFL, tf, kind):\n    # Build grid\n    dx = L / N\n    # cell centers in [0, L)\n    x = (np.arange(N) + 0.5) * dx\n    # initial condition\n    u = initial_condition(x % L, kind)\n    # if a==0, solution is constant in time\n    if a == 0.0:\n        u_num = u.copy()\n        u_ex = exact_solution(x, a, L, tf, kind)\n        err = np.sqrt(dx * np.sum((u_num - u_ex) ** 2))\n        return err\n    # nominal dt from CFL\n    dt_nom = CFL * dx / abs(a)\n    if dt_nom = 0:\n        raise ValueError(\"Non-positive time step\")\n    n_full = int(np.floor(tf / dt_nom + 1e-15))\n    t = 0.0\n    # march full steps\n    for _ in range(n_full):\n        u = upwind_step(u, a, dt_nom, dx)\n        t += dt_nom\n    # last partial step if needed\n    rem = tf - t\n    if rem > 1e-15:\n        # ensure stability: |a|*rem/dx = CFL (should be = CFL by construction)\n        u = upwind_step(u, a, rem, dx)\n        t += rem\n    # numerical solution at tf\n    u_num = u\n    # exact solution\n    u_ex = exact_solution(x, a, L, tf, kind)\n    # L2 error\n    err = np.sqrt(dx * np.sum((u_num - u_ex) ** 2))\n    return err\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (N, a, L, CFL, tf, kind)\n    test_cases = [\n        (400, 1.0, 1.0, 0.5, 0.3, \"sine\"),\n        (600, -0.8, 1.0, 0.9, 0.25, \"square\"),\n        (500, 1.0, 1.0, 1.0, 1.0, \"gaussian\"),\n        (512, 0.5, 1.0, 0.99, 0.2, \"mix\"),\n    ]\n\n    results = []\n    for case in test_cases:\n        N, a, L, CFL, tf, kind = case\n        err = run_case(N, a, L, CFL, tf, kind)\n        # Round to exactly 8 decimals\n        results.append(f\"{err:.8f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        },
        {
            "introduction": "Numerical solutions often exhibit behaviors not present in the original partial differential equation, such as the artificial smoothing of waves. This exercise introduces you to modified equation analysis, a powerful diagnostic tool that reveals the effective PDE that a scheme actually solves. By deriving and comparing the leading error terms for the upwind and Lax-Friedrichs schemes, you will learn to quantify numerical diffusion and understand its origins .",
            "id": "3394635",
            "problem": "Consider the linear advection partial differential equation (PDE) $u_t + a\\,u_x = 0$ with constant advection speed $a \\in \\mathbb{R}$ on a uniform spatial grid of spacing $\\Delta x  0$ and explicit time stepping with time step $\\Delta t  0$. Let $r := a\\,\\Delta t/\\Delta x$ denote the Courant–Friedrichs–Lewy (CFL) number. Define the first-order upwind scheme by the flux-splitting form\n$$\nu_j^{n+1} \\;=\\; u_j^n \\;-\\; r^+\\,(u_j^n - u_{j-1}^n) \\;-\\; r^-\\,(u_{j+1}^n - u_j^n),\n$$\nwhere $r^+ := \\max(r,0)$ and $r^- := \\min(r,0)$, and define the Lax–Friedrichs (LF) scheme by\n$$\nu_j^{n+1} \\;=\\; \\tfrac{1}{2}\\Big(u_{j+1}^n + u_{j-1}^n\\Big) \\;-\\; \\tfrac{r}{2}\\Big(u_{j+1}^n - u_{j-1}^n\\Big).\n$$\nUsing Taylor expansions in space and time consistent with the governing PDE, derive the leading-order modified equation for each scheme, retaining the lowest-order dissipative and dispersive terms that arise from truncation. Based on your derivations, identify the regimes of the CFL number $r$ in which the two schemes have equivalent leading-order modified equations and the regimes in which their leading dissipation differs, together with the relative strength. Select the single correct statement from the following options.\n\nA. For any $|r|\\le 1$, both modified equations share a leading third-derivative dispersive term proportional to $u_{xxx}$ whose coefficient depends on $r$ and vanishes at $|r|=1$; for $0|r|1$, Lax–Friedrichs has strictly stronger leading diffusion than upwind.\n\nB. For all $|r|\\le 1$, upwind has strictly stronger leading diffusion than Lax–Friedrichs; they are equivalent only at $|r|=0$.\n\nC. At $|r|=1$, the modified equation of Lax–Friedrichs retains a nonzero diffusion term while upwind’s diffusion vanishes; therefore they cannot be equivalent at $|r|=1$.\n\nD. For $|r|1$, both schemes remain stable and Lax–Friedrichs becomes less diffusive than upwind.\n\nE. The leading artificial viscosity coefficients satisfy $\\nu_{\\mathrm{UW}} = \\tfrac{|a|\\Delta x}{2}\\,(1 - |r|)$ and $\\nu_{\\mathrm{LF}} = \\tfrac{\\Delta x^2}{2\\Delta t}\\,(1 - r^2)$, implying equality only at $|r|=1$ and strict inequality $\\nu_{\\mathrm{LF}}\\nu_{\\mathrm{UW}}$ for $0|r|1$.",
            "solution": "The user wants me to analyze and compare the first-order upwind and Lax-Friedrichs schemes for the linear advection equation $u_t + a\\,u_x = 0$.\n\n### **Problem Validation**\n\n**Step 1: Extract Givens**\n-   **PDE**: $u_t + a\\,u_x = 0$ with constant advection speed $a \\in \\mathbb{R}$.\n-   **Discretization**: Uniform spatial grid with spacing $\\Delta x  0$ and explicit time stepping with time step $\\Delta t  0$.\n-   **CFL number**: $r := a\\,\\Delta t/\\Delta x$.\n-   **First-order upwind scheme**: $u_j^{n+1} = u_j^n - r^+\\,(u_j^n - u_{j-1}^n) - r^-\\,(u_{j+1}^n - u_j^n)$, where $r^+ := \\max(r,0)$ and $r^- := \\min(r,0)$.\n-   **Lax–Friedrichs scheme**: $u_j^{n+1} = \\tfrac{1}{2}(u_{j+1}^n + u_{j-1}^n) - \\tfrac{r}{2}(u_{j+1}^n - u_{j-1}^n)$.\n-   **Task**: Derive the leading-order modified equation for each scheme, compare their dissipative and dispersive terms, and select the single correct statement from the options.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem statement is scientifically grounded, well-posed, and objective. It is a standard exercise in the field of numerical analysis for partial differential equations. All terms and schemes are correctly defined and are fundamental concepts in this area. The problem is self-contained and provides all necessary information to perform the requested analysis. There are no contradictions, ambiguities, or factual errors.\n\n**Step 3: Verdict and Action**\nThe problem is valid. I will proceed with the derivation and analysis.\n\n### **Derivation of Modified Equations**\n\nTo derive the modified equation for each scheme, we perform a Taylor series expansion of the scheme's terms around the point $(x_j, t_n)$. Let $u$ denote $u(x_j, t_n)$. We use the principle that the exact solution to the modified equation, when evaluated at the grid points, is identical to the solution of the difference scheme.\n\nWe express the numerical scheme in the operator form $\\frac{u_j^{n+1}-u_j^n}{\\Delta t} = \\mathcal{L}_{\\Delta}(u^n)$. The left-hand side operator is expanded in time and the right-hand side operator is expanded in space.\nThe time-differencing operator expands as:\n$$\n\\frac{u_j^{n+1}-u_j^n}{\\Delta t} = \\frac{e^{\\Delta t \\partial_t} - 1}{\\Delta t} u = \\left(\\partial_t + \\frac{\\Delta t}{2}\\partial_{tt} + \\frac{\\Delta t^2}{6}\\partial_{ttt} + \\dots\\right) u\n$$\nWe then have $\\partial_t u = \\dots$, and we recursively substitute expressions for time derivatives using the modified equation itself, starting with the lowest-order approximation $u_t \\approx -a u_x$. Successive approximations are:\n$u_{tt} = \\partial_t(u_t) \\approx \\partial_t(-a u_x) = -a \\partial_x(u_t) \\approx a^2 u_{xx}$.\n$u_{ttt} = \\partial_t(u_{tt}) \\approx \\partial_t(a^2 u_{xx}) \\approx a^2 \\partial_{xx}(-a u_x) = -a^3 u_{xxx}$.\n\nIf the modified equation is $u_t + a u_x = D u_{xx} + E u_{xxx} + \\dots$, a more accurate substitution for $u_{tt}$ is:\n$u_{tt} = \\partial_t(-a u_x + D u_{xx} + \\dots) = -a u_{xt} + D u_{xxt} + \\dots = -a \\partial_x(-a u_x + \\dots) + D \\partial_{xx}(-a u_x + \\dots) = a^2 u_{xx} - a D u_{xxx} - a D u_{xxx} + \\dots = a^2 u_{xx} - 2a D u_{xxx} + \\dots$.\n\n**1. First-Order Upwind (UW) Scheme**\n\nThe scheme can be written as $\\frac{u_j^{n+1}-u_j^n}{\\Delta t} = -\\frac{a^+}{\\Delta x}(u_j^n - u_{j-1}^n) - \\frac{a^-}{\\Delta x}(u_{j+1}^n - u_j^n)$.\nThe spatial operator is $\\mathcal{L}_{\\Delta}^{UW} = -\\frac{a^+}{\\Delta x}(1-e^{-\\Delta x \\partial_x}) - \\frac{a^-}{\\Delta x}(e^{\\Delta x \\partial_x}-1)$.\nExpanding the exponential operators:\n$\\mathcal{L}_{\\Delta}^{UW} = -\\frac{a^+}{\\Delta x}(\\Delta x \\partial_x - \\frac{\\Delta x^2}{2}\\partial_{xx} + \\frac{\\Delta x^3}{6}\\partial_{xxx} - \\dots) - \\frac{a^-}{\\Delta x}(\\Delta x \\partial_x + \\frac{\\Delta x^2}{2}\\partial_{xx} + \\frac{\\Delta x^3}{6}\\partial_{xxx} + \\dots)$.\nSumming the terms gives:\n$\\mathcal{L}_{\\Delta}^{UW} = -(a^+ + a^-)\\partial_x + \\frac{\\Delta x}{2}(a^+ - a^-)\\partial_{xx} - \\frac{\\Delta x^2}{6}(a^+ + a^-)\\partial_{xxx} + \\dots$.\nUsing $a = a^+ + a^-$ and $|a| = a^+ - a^-$, we get:\n$\\mathcal{L}_{\\Delta}^{UW} = -a\\partial_x + \\frac{|a|\\Delta x}{2}\\partial_{xx} - \\frac{a\\Delta x^2}{6}\\partial_{xxx} + \\dots$.\n\nEquating the time and space operator expansions:\n$\\partial_t u + \\frac{\\Delta t}{2}\\partial_{tt} u + \\dots = -a\\partial_x u + \\frac{|a|\\Delta x}{2}\\partial_{xx} u - \\frac{a\\Delta x^2}{6}\\partial_{xxx} u + \\dots$.\nRearranging for $\\partial_t u$:\n$\\partial_t u + a\\partial_x u = \\left(\\frac{|a|\\Delta x}{2} - \\frac{\\Delta t}{2}\\partial_{tt}\\right)u - \\frac{a\\Delta x^2}{6}\\partial_{xxx} u + \\dots$.\nSubstituting $\\partial_{tt} \\approx a^2\\partial_{xx}$:\n$\\partial_t u + a\\partial_x u = \\left(\\frac{|a|\\Delta x}{2} - \\frac{a^2\\Delta t}{2}\\right)\\partial_{xx} u + \\dots$.\nThe leading-order diffusion coefficient (artificial viscosity) is:\n$D_{\\mathrm{UW}} = \\frac{|a|\\Delta x}{2} - \\frac{a^2\\Delta t}{2} = \\frac{|a|\\Delta x}{2} \\left(1 - \\frac{a^2\\Delta t}{|a|\\Delta x}\\right) = \\frac{|a|\\Delta x}{2} \\left(1 - \\frac{|a|\\Delta t}{\\Delta x}\\right) = \\frac{|a|\\Delta x}{2}(1-|r|)$.\n\nThe problem asks for dissipative and dispersive terms. The coefficient of the third derivative dispersive term, $E_{\\mathrm{UW}}$, is found by retaining more terms:\n$E_{\\mathrm{UW}} u_{xxx} = \\left(-\\frac{a \\Delta x^2}{6} - \\frac{\\Delta t}{2}(-2aD_{\\mathrm{UW}}) - \\frac{\\Delta t^2}{6}(-a^3)\\right) u_{xxx}$.\n$E_{\\mathrm{UW}} = -\\frac{a\\Delta x^2}{6} + a\\Delta t D_{\\mathrm{UW}} + \\frac{a^3\\Delta t^2}{6}$.\nSubstituting $D_{\\mathrm{UW}}$:\n$E_{\\mathrm{UW}} = -\\frac{a\\Delta x^2}{6} + a\\Delta t \\frac{|a|\\Delta x}{2}(1-|r|) + \\frac{a^3\\Delta t^2}{6}$.\nSince $a\\Delta t = r\\Delta x$, $|a|\\Delta t = |r|\\Delta x$, and $\\operatorname{sgn}(a) = \\operatorname{sgn}(r)$:\n$E_{\\mathrm{UW}} = a\\Delta x^2 \\left[-\\frac{1}{6} + \\frac{r}{|a|\\Delta x} \\frac{|a|\\Delta x}{2\\Delta x}(1-|r|) + \\frac{r^2}{6} \\right] = a\\Delta x^2 \\left[-\\frac{1}{6} + \\frac{r}{a}\\frac{|a|}{2}(1-|r|) + \\frac{|r|^2}{6} \\right] = a\\Delta x^2 \\left[-\\frac{1}{6} + \\frac{|r|}{2}(1-|r|) + \\frac{|r|^2}{6} \\right]$.\n$E_{\\mathrm{UW}} = a\\Delta x^2 \\left[\\frac{-1 + 3|r| - 3|r|^2 + |r|^2}{6}\\right] = \\frac{a\\Delta x^2}{6}(-2|r|^2 + 3|r| - 1) = -\\frac{a\\Delta x^2}{6}(2|r|-1)(|r|-1)$.\n\n**2. Lax-Friedrichs (LF) Scheme**\n\nThe scheme is $\\frac{u_j^{n+1}-u_j^n}{\\Delta t} = \\frac{u_{j+1}^n - 2u_j^n + u_{j-1}^n}{2\\Delta t} - \\frac{a}{2\\Delta x}(u_{j+1}^n - u_{j-1}^n)$.\nThe spatial operator is $\\mathcal{L}_{\\Delta}^{LF} = \\frac{e^{\\Delta x \\partial_x} + e^{-\\Delta x \\partial_x} - 2}{2\\Delta t} - \\frac{a}{2\\Delta x}(e^{\\Delta x \\partial_x} - e^{-\\Delta x \\partial_x})$.\nExpanding the terms:\n$e^{\\Delta x\\partial_x} \\pm e^{-\\Delta x\\partial_x} = (1 \\pm \\Delta x\\partial_x + \\frac{\\Delta x^2}{2}\\partial_{xx} \\pm \\dots) \\pm (1 \\mp \\Delta x\\partial_x + \\frac{\\Delta x^2}{2}\\partial_{xx} \\mp \\dots)$.\n$\\mathcal{L}_{\\Delta}^{LF} = \\frac{(2 + \\Delta x^2\\partial_{xx} + \\dots) - 2}{2\\Delta t} - \\frac{a}{2\\Delta x}(2\\Delta x\\partial_x + \\frac{\\Delta x^3}{3}\\partial_{xxx} + \\dots)$.\n$\\mathcal{L}_{\\Delta}^{LF} = \\frac{\\Delta x^2}{2\\Delta t}\\partial_{xx} - a\\partial_x - \\frac{a\\Delta x^2}{6}\\partial_{xxx} + \\dots$.\n\nEquating with the time operator expansion:\n$\\partial_t u + \\frac{\\Delta t}{2}\\partial_{tt} u + \\dots = -a\\partial_x u + \\frac{\\Delta x^2}{2\\Delta t}\\partial_{xx} u - \\frac{a\\Delta x^2}{6}\\partial_{xxx} u + \\dots$.\n$\\partial_t u + a\\partial_x u = \\left(\\frac{\\Delta x^2}{2\\Delta t} - \\frac{\\Delta t}{2}\\partial_{tt}\\right)u - \\frac{a\\Delta x^2}{6}\\partial_{xxx} u + \\dots$.\nUsing $\\partial_{tt} \\approx a^2\\partial_{xx}$:\n$\\partial_t u + a\\partial_x u = \\left(\\frac{\\Delta x^2}{2\\Delta t} - \\frac{a^2\\Delta t}{2}\\right)\\partial_{xx} u + \\dots$.\nThe diffusion coefficient is:\n$D_{\\mathrm{LF}} = \\frac{\\Delta x^2}{2\\Delta t} - \\frac{a^2\\Delta t}{2} = \\frac{\\Delta x^2}{2\\Delta t} \\left(1 - \\frac{a^2\\Delta t^2}{\\Delta x^2}\\right) = \\frac{\\Delta x^2}{2\\Delta t}(1-r^2)$.\n\nThe dispersion coefficient $E_{\\mathrm{LF}}$ is:\n$E_{\\mathrm{LF}} = -\\frac{a\\Delta x^2}{6} + a\\Delta t D_{\\mathrm{LF}} + \\frac{a^3\\Delta t^2}{6}$.\n$E_{\\mathrm{LF}} = -\\frac{a\\Delta x^2}{6} + a\\Delta t \\left(\\frac{\\Delta x^2}{2\\Delta t}(1-r^2)\\right) + \\frac{a^3\\Delta t^2}{6}$.\n$E_{\\mathrm{LF}} = -\\frac{a\\Delta x^2}{6} + \\frac{a\\Delta x^2}{2}(1-r^2) + \\frac{a\\Delta x^2}{6}r^2$.\n$E_{\\mathrm{LF}} = a\\Delta x^2 \\left(-\\frac{1}{6} + \\frac{1}{2} - \\frac{r^2}{2} + \\frac{r^2}{6}\\right) = a\\Delta x^2 \\left(\\frac{1}{3} - \\frac{2r^2}{6}\\right) = \\frac{a\\Delta x^2}{3}(1-r^2)$.\n\n### **Analysis of Options**\n\nWe now evaluate each statement based on the derived coefficients, within the stability region $|r|\\le 1$.\n-   **Diffusion (Artificial Viscosity) Coefficients**:\n    -   $\\nu_{\\mathrm{UW}} = D_{\\mathrm{UW}} = \\frac{|a|\\Delta x}{2}(1-|r|)$.\n    -   $\\nu_{\\mathrm{LF}} = D_{\\mathrm{LF}} = \\frac{\\Delta x^2}{2\\Delta t}(1-r^2)$. This can be rewritten using $|r|=|a|\\Delta t/\\Delta x$ as $\\nu_{\\mathrm{LF}} = \\frac{|a|\\Delta x}{2|r|}(1-r^2)$.\n\n-   **Dispersion Coefficients**:\n    -   $E_{\\mathrm{UW}} = -\\frac{a\\Delta x^2}{6}(2|r|-1)(|r|-1)$.\n    -   $E_{\\mathrm{LF}} = \\frac{a\\Delta x^2}{3}(1-r^2)$.\n\n**A. For any $|r|\\le 1$, both modified equations share a leading third-derivative dispersive term proportional to $u_{xxx}$ whose coefficient depends on $r$ and vanishes at $|r|=1$; for $0|r|1$, Lax–Friedrichs has strictly stronger leading diffusion than upwind.**\nThe phrase \"leading ... dispersive term\" refers to the lowest-order non-zero odd-derivative term. For the upwind scheme, the coefficient $E_{\\mathrm{UW}}$ is zero when $|r|=1$ and $|r|=0.5$. At $|r|=0.5$, the leading dispersive term is not the third derivative, but a higher-order one. For the Lax–Friedrichs scheme, $E_{\\mathrm{LF}}$ is non-zero for $|r|=0.5$. Thus, the two schemes do not \"share a leading third-derivative...term\" for \"any\" $|r|\\le 1$. The universal quantifier \"For any\" makes the first part of the statement false.\nVerdict: **Incorrect**.\n\n**B. For all $|r|\\le 1$, upwind has strictly stronger leading diffusion than Lax–Friedrichs; they are equivalent only at $|r|=0$.**\nLet's compare $\\nu_{\\mathrm{UW}}$ and $\\nu_{\\mathrm{LF}}$ for $0|r|1$.\nThe ratio is $\\frac{\\nu_{\\mathrm{LF}}}{\\nu_{\\mathrm{UW}}} = \\frac{\\frac{|a|\\Delta x}{2|r|}(1-|r|^2)}{\\frac{|a|\\Delta x}{2}(1-|r|)} = \\frac{(1-|r|)(1+|r|)}{|r|(1-|r|)} = \\frac{1+|r|}{|r|} = \\frac{1}{|r|} + 1$.\nFor $0  |r|  1$, we have $\\frac{1}{|r|}  1$, so $\\frac{\\nu_{\\mathrm{LF}}}{\\nu_{\\mathrm{UW}}}  2$. This means $\\nu_{\\mathrm{LF}}  \\nu_{\\mathrm{UW}}$. The statement claims the opposite. Furthermore, at $|r|=0$ (with $a=0$), $\\nu_{\\mathrm{UW}}=0$ while $\\nu_{\\mathrm{LF}}=\\frac{\\Delta x^2}{2\\Delta t}$, so they are not equivalent.\nVerdict: **Incorrect**.\n\n**C. At $|r|=1$, the modified equation of Lax–Friedrichs retains a nonzero diffusion term while upwind’s diffusion vanishes; therefore they cannot be equivalent at $|r|=1$.**\nAt $|r|=1$, the Lax–Friedrichs diffusion coefficient is $\\nu_{\\mathrm{LF}} = \\frac{\\Delta x^2}{2\\Delta t}(1-1^2) = 0$. The statement that it is nonzero is false. In fact, both $\\nu_{\\mathrm{UW}}$ and $\\nu_{\\mathrm{LF}}$ are zero at $|r|=1$.\nVerdict: **Incorrect**.\n\n**D. For $|r|1$, both schemes remain stable and Lax–Friedrichs becomes less diffusive than upwind.**\nThe von Neumann stability analysis for both these explicit schemes shows that they are stable only for $|r| \\le 1$. The premise that they are stable for $|r|1$ is false.\nVerdict: **Incorrect**.\n\n**E. The leading artificial viscosity coefficients satisfy $\\nu_{\\mathrm{UW}} = \\tfrac{|a|\\Delta x}{2}\\,(1 - |r|)$ and $\\nu_{\\mathrm{LF}} = \\tfrac{\\Delta x^2}{2\\Delta t}\\,(1 - r^2)$, implying equality only at $|r|=1$ and strict inequality $\\nu_{\\mathrm{LF}}\\nu_{\\mathrm{UW}}$ for $0|r|1$.**\nThis statement consists of three parts.\n1.  The formulas for the coefficients $\\nu_{\\mathrm{UW}}$ and $\\nu_{\\mathrm{LF}}$ match our derivations perfectly.\n2.  The equality condition: $\\nu_{\\mathrm{UW}} = \\nu_{\\mathrm{LF}}$ requires $\\frac{|a|\\Delta x}{2}(1-|r|) = \\frac{|a|\\Delta x}{2|r|}(1-r^2) = \\frac{|a|\\Delta x}{2|r|}(1-|r|)(1+|r|)$. For $|r| \\in [0,1)$, we can divide by the common non-zero factor to get $1 = \\frac{1+|r|}{|r|}$, which implies $|r| = 1+|r|$, or $0=1$, a contradiction. So there is no equality in $[0,1)$. At $|r|=1$, both coefficients are $0$, so they are equal. Thus, equality holds only at $|r|=1$ within the stability region. This is correct.\n3.  The inequality condition for $0|r|1$: As shown in the analysis of option B, $\\frac{\\nu_{\\mathrm{LF}}}{\\nu_{\\mathrm{UW}}} = \\frac{1}{|r|} + 1  2$. Thus, $\\nu_{\\mathrm{LF}}  \\nu_{\\mathrm{UW}}$ is strictly true for $0|r|1$. This is correct.\nAll parts of this statement are correct.\nVerdict: **Correct**.",
            "answer": "$$\\boxed{E}$$"
        },
        {
            "introduction": "The accuracy of a numerical solution depends on both the spatial and temporal discretizations. This advanced exercise challenges you to couple the upwind spatial operator with a more accurate, two-stage time integration scheme. You will perform a complete stability and phase error analysis to understand the properties of the fully discrete method, culminating in an optimization problem that balances accuracy against the physical constraint of monotonicity .",
            "id": "3394621",
            "problem": "Consider the one-dimensional linear advection equation $u_{t} + a\\,u_{x} = 0$ with constant advection speed $a0$, posed on a uniform grid $x_{j} = j\\,\\Delta x$ with time step $\\Delta t$ and Courant number $\\lambda = a\\,\\Delta t/\\Delta x$. Use the first-order upwind spatial discretization for $a0$, which in semi-discrete form reads $u_{j}'(t) = -\\frac{a}{\\Delta x}\\left(u_{j}(t) - u_{j-1}(t)\\right)$, and couple it in time with the two-stage explicit trapezoidal method (Heun’s method): $u^{(1)} = u^{n} + \\Delta t\\,L\\,u^{n}$, $u^{n+1} = u^{n} + \\frac{\\Delta t}{2}\\left(L\\,u^{n} + L\\,u^{(1)}\\right)$, where $L$ denotes the semi-discrete spatial operator. Assume a smooth initial wave $u(x,0) = \\sin(\\kappa x)$ and analyze the one-step behavior of a single discrete Fourier mode with wavenumber $\\theta = \\kappa\\,\\Delta x$. Starting from the definitions of the spatial symbol and the Runge–Kutta stability function, derive the one-step amplification factor $G(\\theta,\\lambda)$, define the numerical phase $\\varphi_{\\mathrm{num}}(\\theta,\\lambda) = \\arg\\left(G(\\theta,\\lambda)\\right)$, and compare it to the exact continuous phase shift per time step $\\varphi_{\\mathrm{exact}}(\\theta,\\lambda) = -\\lambda\\,\\theta$. Under the assumption of a smooth wave so that $\\theta$ is small, systematically expand $\\varphi_{\\mathrm{num}}(\\theta,\\lambda)$ to leading nonzero order in $\\theta$ and obtain the leading-order phase error as an explicit function of $\\lambda$. Impose discrete monotonicity of the fully discrete scheme by requiring that the update weights on $u_{j}^{n}$, $u_{j-1}^{n}$, $u_{j-2}^{n}$ are nonnegative and sum to one, and deduce the admissible interval for $\\lambda$. Within this admissible interval and excluding the trivial choice $\\lambda=0$, determine the value of $\\lambda$ that minimizes the magnitude of the leading-order phase error, and report that single optimal $\\lambda$ as your final answer. No rounding is required for the final answer, which is dimensionless.",
            "solution": "The user wants me to analyze a fully discrete numerical scheme for the one-dimensional linear advection equation and find an optimal parameter value.\n\n### Step 1: Extract Givens\n-   **PDE**: $u_{t} + a\\,u_{x} = 0$, with constant advection speed $a0$.\n-   **Grid**: Uniform grid $x_{j} = j\\,\\Delta x$, time step $\\Delta t$.\n-   **Courant Number**: $\\lambda = a\\,\\Delta t/\\Delta x$.\n-   **Spatial Discretization (Semi-discrete operator $L$)**: First-order upwind scheme, $L u_{j} = -\\frac{a}{\\Delta x}\\left(u_{j} - u_{j-1}\\right)$.\n-   **Time Discretization (Heun's Method)**: Two-stage explicit Runge-Kutta method.\n    $u^{(1)} = u^{n} + \\Delta t\\,L\\,u^{n}$\n    $u^{n+1} = u^{n} + \\frac{\\Delta t}{2}\\left(L\\,u^{n} + L\\,u^{(1)}\\right)$\n-   **Analysis Mode**: A single discrete Fourier mode, implied form $u_j(t) \\propto e^{i j \\theta}$ with $\\theta = \\kappa \\Delta x$.\n-   **Target Quantities**:\n    -   One-step amplification factor $G(\\theta,\\lambda)$.\n    -   Numerical phase $\\varphi_{\\mathrm{num}}(\\theta,\\lambda) = \\arg\\left(G(\\theta,\\lambda)\\right)$.\n    -   Leading-order phase error for small $\\theta$, comparing $\\varphi_{\\mathrm{num}}$ to the exact phase $\\varphi_{\\mathrm{exact}}(\\theta,\\lambda) = -\\lambda\\,\\theta$.\n-   **Constraints**:\n    -   Discrete monotonicity: Update weights on $u_{j}^{n}$, $u_{j-1}^{n}$, $u_{j-2}^{n}$ are nonnegative and sum to one.\n-   **Objective**:\n    -   Deduce the admissible interval for $\\lambda$ from monotonicity.\n    -   Within this interval (excluding $\\lambda=0$), find the value of $\\lambda$ that minimizes the magnitude of the leading-order phase error.\n\n### Step 2: Validate Using Extracted Givens\n-   **Scientifically Grounded**: The problem is a standard exercise in the von Neumann analysis of finite difference schemes for a fundamental PDE. The concepts (advection equation, upwind differencing, Heun's method, Courant number, amplification factor, phase error, monotonicity) are all core, well-established topics in numerical analysis.\n-   **Well-Posed**: The problem is clearly specified. It asks for a sequence of derivations, each well-defined, culminating in an optimization problem with a clear objective and constraints. A unique solution is expected.\n-   **Objective**: The language is formal and mathematical, with no subjective or ambiguous terms.\n-   **Conclusion**: There are no scientific or logical flaws, inconsistencies, or ambiguities. The problem is self-contained and formalizable.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A full, reasoned solution will be provided.\n\n### Solution Derivation\n\n#### 1. Amplification Factor $G(\\theta,\\lambda)$\n\nThe analysis is performed on a single Fourier mode $u_j^n = (\\hat{u}^n) e^{i j \\theta}$. The amplification factor $G(\\theta, \\lambda)$ is defined by $\\hat{u}^{n+1} = G(\\theta, \\lambda) \\hat{u}^n$. It can be derived by combining the symbol of the spatial operator $L$ with the stability function of the time integration method.\n\nFirst, we find the symbol $\\hat{L}(\\theta)$ of the spatial operator $L$. Applying $L$ to the mode $e^{i j \\theta}$:\n$$L(e^{i j \\theta}) = -\\frac{a}{\\Delta x}\\left(e^{i j \\theta} - e^{i (j-1) \\theta}\\right) = -\\frac{a}{\\Delta x} e^{i j \\theta} \\left(1 - e^{-i \\theta}\\right)$$\nThe symbol is the resulting eigenvalue:\n$$\\hat{L}(\\theta) = -\\frac{a}{\\Delta x}\\left(1 - e^{-i \\theta}\\right)$$\n\nNext, we determine the stability function $R(z)$ for Heun's method applied to the model ODE $y' = \\mu y$. The update is $y^{n+1} = R(z) y^n$ where $z = \\mu \\Delta t$.\nThe stages are:\n$$y^{(1)} = y^n + \\Delta t (\\mu y^n) = (1+z) y^n$$\n$$y^{n+1} = y^n + \\frac{\\Delta t}{2}\\left(\\mu y^n + \\mu y^{(1)}\\right) = y^n + \\frac{z}{2}\\left(y^n + (1+z)y^n\\right) = \\left(1 + \\frac{z}{2} + \\frac{z(1+z)}{2}\\right)y^n$$\n$$y^{n+1} = \\left(1 + z + \\frac{1}{2}z^2\\right)y^n$$\nThe stability function is $R(z) = 1 + z + \\frac{1}{2}z^2$.\n\nThe amplification factor $G$ is obtained by evaluating $R(z)$ at $z = \\Delta t \\hat{L}(\\theta)$:\n$$z = \\Delta t \\left(-\\frac{a}{\\Delta x}\\left(1 - e^{-i \\theta}\\right)\\right) = -\\frac{a \\Delta t}{\\Delta x}\\left(1 - e^{-i \\theta}\\right) = -\\lambda\\left(1 - e^{-i \\theta}\\right)$$\nSubstituting this into $R(z)$, we get the amplification factor:\n$$G(\\theta, \\lambda) = 1 - \\lambda\\left(1 - e^{-i \\theta}\\right) + \\frac{1}{2}\\lambda^2\\left(1 - e^{-i \\theta}\\right)^2$$\n\n#### 2. Leading-Order Phase Error\n\nThe numerical phase is $\\varphi_{\\mathrm{num}}(\\theta,\\lambda) = \\arg\\left(G(\\theta,\\lambda)\\right)$. We analyze its behavior for small $\\theta$ by expanding $G$ in a Taylor series.\nLet's expand the term $1 - e^{-i\\theta}$:\n$$1 - e^{-i\\theta} = 1 - \\left(1 - i\\theta - \\frac{\\theta^2}{2} + \\frac{i\\theta^3}{6} + O(\\theta^4)\\right) = i\\theta + \\frac{\\theta^2}{2} - \\frac{i\\theta^3}{6} + O(\\theta^4)$$\nNow, we expand $z = -\\lambda(1-e^{-i\\theta})$:\n$$z = -\\lambda\\left(i\\theta + \\frac{\\theta^2}{2} - \\frac{i\\theta^3}{6}\\right) + O(\\theta^4) = -i\\lambda\\theta - \\frac{\\lambda}{2}\\theta^2 + \\frac{i\\lambda}{6}\\theta^3 + O(\\theta^4)$$\nAnd $z^2$:\n$$z^2 = \\left(-\\lambda(i\\theta + \\frac{\\theta^2}{2} + \\dots)\\right)^2 = \\lambda^2\\left((i\\theta)^2 + 2(i\\theta)(\\frac{\\theta^2}{2}) + \\dots\\right) = \\lambda^2(-\\theta^2 + i\\theta^3) + O(\\theta^4)$$\nSubstitute these into $G = 1 + z + \\frac{1}{2}z^2$:\n$$G = 1 + \\left(-i\\lambda\\theta - \\frac{\\lambda}{2}\\theta^2 + \\frac{i\\lambda}{6}\\theta^3\\right) + \\frac{1}{2}\\left(\\lambda^2(-\\theta^2 + i\\theta^3)\\right) + O(\\theta^4)$$\nGroup the real and imaginary parts, $G = X + iY$:\n$$X = 1 - \\frac{\\lambda}{2}\\theta^2 - \\frac{\\lambda^2}{2}\\theta^2 + O(\\theta^4) = 1 - \\frac{\\lambda(1+\\lambda)}{2}\\theta^2 + O(\\theta^4)$$\n$$Y = -\\lambda\\theta + \\frac{\\lambda}{6}\\theta^3 + \\frac{\\lambda^2}{2}\\theta^3 + O(\\theta^5) = -\\lambda\\theta + \\frac{\\lambda(1+3\\lambda)}{6}\\theta^3 + O(\\theta^5)$$\nThe numerical phase is related to the tangent, $\\tan(\\varphi_{\\mathrm{num}}) = Y/X$. For small $\\theta$, $X \\approx 1$ and $Y \\approx -\\lambda\\theta$, so $\\varphi_{\\mathrm{num}}$ is small.\n$$\\tan(\\varphi_{\\mathrm{num}}) = \\frac{-\\lambda\\theta + \\frac{\\lambda(1+3\\lambda)}{6}\\theta^3 + O(\\theta^5)}{1 - \\frac{\\lambda(1+\\lambda)}{2}\\theta^2 + O(\\theta^4)}$$\nUsing the geometric series approximation $(1-x)^{-1} \\approx 1+x$:\n$$\\tan(\\varphi_{\\mathrm{num}}) = \\left(-\\lambda\\theta + \\frac{\\lambda(1+3\\lambda)}{6}\\theta^3\\right) \\left(1 + \\frac{\\lambda(1+\\lambda)}{2}\\theta^2\\right) + O(\\theta^5)$$\n$$\\tan(\\varphi_{\\mathrm{num}}) = -\\lambda\\theta + \\left( \\frac{\\lambda(1+3\\lambda)}{6} - \\lambda \\frac{\\lambda(1+\\lambda)}{2} \\right)\\theta^3 + O(\\theta^5)$$\n$$\\tan(\\varphi_{\\mathrm{num}}) = -\\lambda\\theta + \\left( \\frac{\\lambda+3\\lambda^2 - 3\\lambda^2 - 3\\lambda^3}{6} \\right)\\theta^3 + O(\\theta^5) = -\\lambda\\theta + \\frac{\\lambda(1-3\\lambda^2)}{6}\\theta^3 + O(\\theta^5)$$\nNow we relate $\\tan(\\varphi_{\\mathrm{num}})$ back to $\\varphi_{\\mathrm{num}}$ using $\\varphi = \\arctan(\\tan\\varphi)$. Let $\\varphi_{\\mathrm{num}} = -\\lambda\\theta + A\\theta^3 + O(\\theta^5)$. The Taylor series for $\\tan(\\phi)$ is $\\phi + \\phi^3/3 + \\dots$.\n$$\\tan(\\varphi_{\\mathrm{num}}) = (-\\lambda\\theta + A\\theta^3) + \\frac{1}{3}(-\\lambda\\theta)^3 + O(\\theta^5) = -\\lambda\\theta + \\left(A - \\frac{\\lambda^3}{3}\\right)\\theta^3 + O(\\theta^5)$$\nComparing coefficients of $\\theta^3$ in the two expressions for $\\tan(\\varphi_{\\mathrm{num}})$:\n$$A - \\frac{\\lambda^3}{3} = \\frac{\\lambda(1-3\\lambda^2)}{6}$$\n$$A = \\frac{\\lambda-3\\lambda^3}{6} + \\frac{\\lambda^3}{3} = \\frac{\\lambda-3\\lambda^3+2\\lambda^3}{6} = \\frac{\\lambda-\\lambda^3}{6} = \\frac{\\lambda(1-\\lambda^2)}{6}$$\nSo, the numerical phase is:\n$$\\varphi_{\\mathrm{num}}(\\theta, \\lambda) = -\\lambda\\theta + \\frac{\\lambda(1-\\lambda^2)}{6}\\theta^3 + O(\\theta^5)$$\nThe exact phase is $\\varphi_{\\mathrm{exact}}(\\theta, \\lambda) = -\\lambda\\theta$. The phase error is $\\varphi_{\\mathrm{num}} - \\varphi_{\\mathrm{exact}}$. The leading-order phase error is $\\frac{\\lambda(1-\\lambda^2)}{6}\\theta^3$.\n\n#### 3. Monotonicity Condition\n\nWe must find the explicit stencil of the fully-discrete scheme.\n$$u_j^{n+1} = u_j^n + \\frac{\\Delta t}{2}(L u_j^n + L u_j^{(1)})$$\nwhere $u_j^{(1)} = u_j^n + \\Delta t L u_j^n = u_j^n - \\lambda(u_j^n - u_{j-1}^n) = (1-\\lambda)u_j^n + \\lambda u_{j-1}^n$.\nWe need to evaluate $L u_j^{(1)}$:\n$$L u_j^{(1)} = -\\frac{a}{\\Delta x} (u_j^{(1)} - u_{j-1}^{(1)})$$\n$$u_j^{(1)} - u_{j-1}^{(1)} = [(1-\\lambda)u_j^n + \\lambda u_{j-1}^n] - [(1-\\lambda)u_{j-1}^n + \\lambda u_{j-2}^n]$$\n$$u_j^{(1)} - u_{j-1}^{(1)} = (1-\\lambda)u_j^n + (2\\lambda-1)u_{j-1}^n - \\lambda u_{j-2}^n$$\nSo, $\\Delta t L u_j^{(1)} = -\\lambda \\left( (1-\\lambda)u_j^n + (2\\lambda-1)u_{j-1}^n - \\lambda u_{j-2}^n \\right)$.\nThe total update is:\n$$u_j^{n+1} - u_j^n = \\frac{1}{2}\\left[\\Delta t L u_j^n + \\Delta t L u_j^{(1)}\\right]$$\n$$= \\frac{1}{2}\\left[-\\lambda(u_j^n - u_{j-1}^n) - \\lambda \\left( (1-\\lambda)u_j^n + (2\\lambda-1)u_{j-1}^n - \\lambda u_{j-2}^n \\right) \\right]$$\n$$= \\frac{1}{2}\\left[ (-\\lambda - \\lambda(1-\\lambda))u_j^n + (\\lambda - \\lambda(2\\lambda-1))u_{j-1}^n + \\lambda^2 u_{j-2}^n \\right]$$\n$$= \\frac{1}{2}\\left[ (-\\lambda(2-\\lambda))u_j^n + (2\\lambda-2\\lambda^2)u_{j-1}^n + \\lambda^2 u_{j-2}^n \\right]$$\nSo, the scheme is $u_j^{n+1} = C_0 u_j^n + C_1 u_{j-1}^n + C_2 u_{j-2}^n$ with weights:\n$$C_0 = 1 - \\frac{\\lambda(2-\\lambda)}{2} = 1 - \\lambda + \\frac{\\lambda^2}{2}$$\n$$C_1 = \\frac{2\\lambda(1-\\lambda)}{2} = \\lambda - \\lambda^2$$\n$$C_2 = \\frac{\\lambda^2}{2}$$\nFor monotonicity, all coefficients must be non-negative.\n1.  $C_2 = \\frac{\\lambda^2}{2} \\ge 0$. This is true for all real $\\lambda$.\n2.  $C_1 = \\lambda(1-\\lambda) \\ge 0$. Since $\\lambda = a\\Delta t/\\Delta x  0$, this requires $1-\\lambda \\ge 0$, which means $\\lambda \\le 1$. So, $0 \\le \\lambda \\le 1$.\n3.  $C_0 = 1 - \\lambda + \\frac{1}{2}\\lambda^2 \\ge 0$. This is a quadratic in $\\lambda$ with discriminant $\\Delta = (-1)^2 - 4(\\frac{1}{2})(1) = 1-2 = -1  0$. Since the leading coefficient is positive, the quadratic is always positive for all real $\\lambda$.\nThe sum of the weights is $C_0+C_1+C_2 = (1-\\lambda+\\frac{\\lambda^2}{2}) + (\\lambda-\\lambda^2) + \\frac{\\lambda^2}{2} = 1$, as required.\nThe admissible interval for $\\lambda$ that ensures monotonicity is $[0, 1]$.\n\n#### 4. Minimization of Leading-Order Phase Error\n\nWe need to minimize the magnitude of the leading-order phase error coefficient, which is $|E_\\lambda| = |\\frac{\\lambda(1-\\lambda^2)}{6}|$. The optimization is over the admissible interval for $\\lambda$, excluding the trivial choice $\\lambda=0$. So, we want to find:\n$$\\min_{\\lambda \\in (0, 1]} \\left| \\frac{\\lambda(1-\\lambda^2)}{6} \\right|$$\nFor $\\lambda \\in (0, 1]$, both $\\lambda$ and $1-\\lambda^2$ are non-negative. Thus, the absolute value can be removed. We want to minimize the function $f(\\lambda) = \\frac{\\lambda(1-\\lambda^2)}{6}$ for $\\lambda \\in (0, 1]$.\nTo find extrema, we compute the derivative:\n$$f'(\\lambda) = \\frac{d}{d\\lambda}\\left(\\frac{\\lambda - \\lambda^3}{6}\\right) = \\frac{1-3\\lambda^2}{6}$$\nSetting $f'(\\lambda) = 0$ gives $1-3\\lambda^2 = 0$, so $\\lambda^2 = 1/3$. Since $\\lambda0$, the only critical point in the interval is $\\lambda = 1/\\sqrt{3}$.\nLet's analyze the behavior of $f(\\lambda)$ on the interval $(0, 1]$:\n-   At the left boundary (approaching), $\\lim_{\\lambda \\to 0^+} f(\\lambda) = 0$.\n-   At the critical point, $f(1/\\sqrt{3}) = \\frac{(1/\\sqrt{3})(1-1/3)}{6} = \\frac{2}{18\\sqrt{3}} = \\frac{1}{9\\sqrt{3}}  0$.\n-   At the right boundary, $f(1) = \\frac{1(1-1^2)}{6} = 0$.\n\nThe function $f(\\lambda)$ starts at $0$ (for $\\lambda \\to 0^+$), increases to a maximum at $\\lambda=1/\\sqrt{3}$, and then decreases back to $0$ at $\\lambda=1$. The minimum value of $f(\\lambda)$ on the interval $(0, 1]$ is $0$, which is attained at the endpoint $\\lambda=1$.\nTherefore, the value of $\\lambda$ in $(0, 1]$ that minimizes the magnitude of the leading-order phase error is $\\lambda=1$. At this value, the leading-order phase error vanishes completely.",
            "answer": "$$\\boxed{1}$$"
        }
    ]
}