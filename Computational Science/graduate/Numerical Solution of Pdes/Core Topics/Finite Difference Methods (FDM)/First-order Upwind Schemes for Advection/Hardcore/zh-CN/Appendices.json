{
    "hands_on_practices": [
        {
            "introduction": "真正理解一个数值格式的最佳方式是从头开始构建它。这项练习将引导您从积分形式的守恒律出发，通过推导一阶迎风格式，最终编写一个可以工作的Python程序。通过这个过程，您将深化对数值通量、CFL稳定性条件以及如何根据精确解来验证代码正确性等核心概念的理解。",
            "id": "3394603",
            "problem": "考虑长度为 $L$ 的一维周期性域上的线性常系数平流偏微分方程 (PDE) $u_{t} + a\\,u_{x} = 0$。仅从移动控制体上的积分守恒形式以及离散通量必须遵循迎风信息传播的要求出发，推导一个在空间和时间上均为一阶精确、单调、守恒的离散化方法。该方法基于间距为 $\\Delta x$ 的均匀网格上的分段常数单元平均值，并采用步长为 $\\Delta t$ 的前向欧拉时间离散化。您的推导必须根据局部一维黎曼问题来论证单元交界面上数值通量的选择，并且必须得出一个依赖于常数平流速度 $a$ 符号的显式更新格式。以 Courant–Friedrichs–Lewy (CFL) 数 $\\nu = a\\,\\Delta t/\\Delta x$ 的形式陈述稳定性条件，并解释如何从前向欧拉离散化和空间算子的单调性中获得该条件。\n\n然后，实现一个程序，该程序能够：\n- 在 $[0,L)$ 上构建一个由 $N$ 个点组成的均匀网格，这些点代表单元中心，并采用周期性边界条件。\n- 从几个指定的剖面 $u_{0}(x)$ 中选择一个来初始化 $u(x,0)$。\n- 使用您的一阶迎风格式推进数值解，直到达到指定的最终时间 $t_{f}$。时间步长 $\\Delta t$ 由指定的 CFL 数和网格间距确定，并且最后一步的步长会缩短，以确保总时间恰好等于 $t_{f}$。\n- 计算在时间 $t_{f}$ 的精确解 $u(x,t_{f}) = u_{0}\\!\\left(\\operatorname{mod}\\!\\left(x - a\\,t_{f},\\,L\\right)\\right)$，其中 $\\operatorname{mod}(\\cdot,L)$ 返回一个在 $[0,L)$ 内的值，并在网格点上对其进行求值。\n- 返回离散 $L^{2}$-误差，定义为 $\\left(\\Delta x \\sum_{i=0}^{N-1} \\left(u^{\\text{num}}_{i}(t_{f}) - u^{\\text{exact}}(x_{i},t_{f})\\right)^{2}\\right)^{1/2}$，结果为一个浮点数。\n\n您的程序必须运行一个包含四种情况的固定测试套件，每种情况由 $(N, a, L, \\text{CFL}, t_{f}, u_{0})$ 指定，并将所有四个得到的 $L^{2}$-误差在单行上输出为一个逗号分隔的列表，并用方括号括起来，每个值四舍五入到小数点后八位，例如 $[0.01230000,0.00000000,1.23456789,0.00010000]$。\n\n对于三角函数，请使用弧度。本任务中没有物理单位。\n\n测试套件：\n- 情况 1（光滑波，正向平流，中等 CFL）：$N=400$, $a=1.0$, $L=1.0$, $\\text{CFL}=0.5$, $t_{f}=0.3$, $u_{0}(x) = \\sin(2\\pi x)$。\n- 情况 2（间断波，负向平流，接近 CFL 极限）：$N=600$, $a=-0.8$, $L=1.0$, $\\text{CFL}=0.9$, $t_{f}=0.25$, $u_{0}(x) = \\begin{cases}1,  x \\in [0.25,0.75) \\\\ 0,  \\text{其它}\\end{cases}$，带周期性延拓。\n- 情况 3（高斯脉冲，精确平移边界情况）：$N=500$, $a=1.0$, $L=1.0$, $\\text{CFL}=1.0$, $t_{f}=1.0$, $u_{0}(x) = \\exp\\!\\left(-100\\,(x - 0.3)^{2}\\right)$。\n- 情况 4（多模光滑波，接近 CFL 极限）：$N=512$, $a=0.5$, $L=1.0$, $\\text{CFL}=0.99$, $t_{f}=0.2$, $u_{0}(x) = \\cos(4\\pi x) + 0.5\\,\\sin(2\\pi x)$。\n\n实现要求：\n- 对所有情况使用周期性边界条件。\n- 数值更新必须使用由 $a$ 的符号决定的正确迎风方向。\n- 精确解的计算必须使用模运算以包裹到 $[0,L)$ 区间内。\n- 最终打印必须是包含四个 $L^{2}$-误差的单行，格式如上所述，不得有额外输出。\n\n您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表（例如 $[e_{1},e_{2},e_{3},e_{4}]$），其中每个 $e_{k}$ 是一个如上所述四舍五入到八位小数的浮点数。",
            "solution": "我们从线性平流方程 $u_{t} + a\\,u_{x} = 0$ 的积分守恒形式开始，该方程可以写成 $u_{t} + (f(u))_{x} = 0$，其中 $f(u) = a\\,u$ 且 $a \\in \\mathbb{R}$ 为常数。考虑将域 $[0,L)$ 均匀划分为 $N$ 个单元 $I_{i} = [x_{i-1/2}, x_{i+1/2})$，每个单元长度相等，为 $\\Delta x = L/N$，单元中心为 $x_{i} = (i + 1/2)\\Delta x$，其中 $i \\in \\{0,\\dots,N-1\\}$。定义单元平均值 $u_{i}(t) = \\frac{1}{\\Delta x}\\int_{I_{i}} u(x,t)\\,dx$。将 $u_{t} + (f(u))_{x} = 0$ 在 $I_{i}$ 上积分并应用散度定理，得到\n$$\n\\frac{d}{dt} u_{i}(t) + \\frac{1}{\\Delta x}\\left( f\\!\\left(u(x_{i+1/2}^{-},t)\\right) - f\\!\\left(u(x_{i-1/2}^{+},t)\\right)\\right) = 0,\n$$\n其中 $u(x_{i+1/2}^{-},t)$ 和 $u(x_{i-1/2}^{+},t)$ 表示在交界面上的迹。在采用分段常数重构的有限体积法中，交界面上的状态是通过在每个交界面求解局部黎曼问题得到的。对于线性平流 $u_{t} + a\\,u_{x} = 0$，特征线以速度 $a$ 移动。在 $x_{i+1/2}$ 处的物理上可容许的解使用上游信息：如果 $a > 0$，左侧状态 $u_{i}$ 对流进入 $I_{i+1}$；如果 $a  0$，右侧状态 $u_{i+1}$ 对流进入 $I_{i}$。因此，通过迎风 (Godunov) 通量可以得到交界面上一个相容且单调的数值通量 $F_{i+1/2}$：\n$$\nF_{i+1/2} =\n\\begin{cases}\na\\,u_{i},  a \\ge 0, \\\\\na\\,u_{i+1},  a  0.\n\\end{cases}\n$$\n半离散守恒格式则为\n$$\n\\frac{d}{dt} u_{i}(t) = -\\frac{1}{\\Delta x}\\left(F_{i+1/2}(t) - F_{i-1/2}(t)\\right).\n$$\n使用前向欧拉法在时间步长 $\\Delta t$ 上进行时间离散化，得到\n$$\nu_{i}^{n+1} = u_{i}^{n} - \\frac{\\Delta t}{\\Delta x}\\left(F_{i+1/2}^{n} - F_{i-1/2}^{n}\\right).\n$$\n对于常数 $a$，使用迎风通量，这可以简化为显式更新格式。对于 $a > 0$，\n$$\nu_{i}^{n+1} = u_{i}^{n} - \\nu\\,(u_{i}^{n} - u_{i-1}^{n}), \\quad \\nu = \\frac{a\\,\\Delta t}{\\Delta x},\n$$\n对于 $a  0$，\n$$\nu_{i}^{n+1} = u_{i}^{n} - \\nu\\,(u_{i+1}^{n} - u_{i}^{n}), \\quad \\nu = \\frac{a\\,\\Delta t}{\\Delta x}.\n$$\n在适当的稳定性条件下，这些公式是守恒且单调的。因为前向欧拉法应用于空间单调的通量差分算子时必须保持凸组合，所以稳定性和单调性要求更新系数为非负且总和为一。对于 $a > 0$，更新式 $u_{i}^{n+1} = (1-\\nu)\\,u_{i}^{n} + \\nu\\,u_{i-1}^{n}$ 是一个凸组合，当且仅当 $0 \\le \\nu \\le 1$。对于 $a  0$，将更新式写为 $u_{i}^{n+1} = (1+ \\nu)\\,u_{i}^{n} - \\nu\\,u_{i+1}^{n} = (1-|\\nu|)\\,u_{i}^{n} + |\\nu|\\,u_{i+1}^{n}$ 表明其为凸组合，当且仅当 $0 \\le |\\nu| \\le 1$。因此，用于保证稳定性和单调性的 Courant–Friedrichs–Lewy (CFL) 条件为\n$$\n|\\nu| = \\left|\\frac{a\\,\\Delta t}{\\Delta x}\\right| \\le 1.\n$$\n对于采用迎风通量和前向欧拉法的线性平流问题，这个界是紧的。在此条件下，该方法是总变差递减 (TVD) 和 $L^{1}$ 稳定的。\n\n在周期区间 $[0,L)$ 上，周期为 $L$ 的初值问题的精确解由沿特征线的平移给出：\n$$\nu(x,t) = u_{0}\\!\\left(\\operatorname{mod}\\!\\left(x - a\\,t,\\,L\\right)\\right),\n$$\n其中 $\\operatorname{mod}(y,L)$ 将 $y$ 映射到其在 $[0,L)$ 中的代表值。在均匀网格上，网格点 $x_{i}$ 处的精确解可以通过在平移后的位置上对 $u_{0}$ 求值并进行周期性环绕来获得。\n\n实现的算法设计：\n- 选择 $N$ 并定义 $\\Delta x = L/N$ 和 $x_{i} = (i+1/2)\\Delta x$，其中 $i \\in \\{0,\\dots,N-1\\}$。\n- 初始化 $u^{0}_{i} = u_{0}(x_{i})$。\n- 如果 $a \\ne 0$，设置一个名义时间步长 $\\Delta t_{\\text{nom}} = \\text{CFL}\\,\\Delta x/|a|$。确定完整步数 $n_{\\text{full}} = \\left\\lfloor t_{f}/\\Delta t_{\\text{nom}}\\right\\rfloor$。以 $\\Delta t = \\Delta t_{\\text{nom}}$ 推进 $n_{\\text{full}}$ 步，如果 $t_{f}$ 不是 $\\Delta t_{\\text{nom}}$ 的整数倍，则以 $\\Delta t_{\\text{last}} = t_{f} - n_{\\text{full}}\\Delta t_{\\text{nom}}$ 走最后一步。对于每一步，计算 $\\nu = a\\,\\Delta t/\\Delta x$ 并应用带有周期性索引（$u_{-1} \\equiv u_{N-1}$ 和 $u_{N} \\equiv u_{0}$）的迎风更新。\n- 计算精确解数组 $u^{\\text{exact}}_{i} = u_{0}\\!\\left(\\operatorname{mod}\\!\\left(x_{i} - a\\,t_{f},\\,L\\right)\\right)$。\n- 计算离散 $L^{2}$-误差 $E = \\left(\\Delta x \\sum_{i=0}^{N-1} (u^{n_{\\text{final}}}_{i} - u^{\\text{exact}}_{i})^{2}\\right)^{1/2}$。\n- 对每个测试用例重复此过程。\n\n关于截断误差和数值耗散的讨论：修正方程分析表明，用于线性平流的一阶迎风法近似于\n$$\nu_{t} + a\\,u_{x} = \\frac{1}{2}|a|\\,\\Delta x\\,(1 - |\\nu|)\\,u_{xx} + \\mathcal{O}(\\Delta x^{2}, \\Delta t^{2}),\n$$\n揭示了一个主阶人工耗散项，其量值为 $\\frac{1}{2}|a|\\,\\Delta x\\,(1 - |\\nu|)$，该项在边界情况 $|\\nu|=1$ 时消失。这与一种特殊情况相符：当 $a0$ 且 $\\nu=1$ 时，格式简化为一个纯粹的平移 $u_{i}^{n+1} = u_{i-1}^{n}$，在网格上产生精确的离散平移，并且当 $t_{f} = L/a$ 时，在遍历整个域后具有精确的周期性。\n\n实现通过使用模 $N$ 的索引或向量化循环移位来应用周期性边界条件。精确解和所有初始条件在计算三角函数时均使用弧度。程序构建并运行指定的四个案例：\n- 情况 1：$N=400$, $a=1.0$, $L=1.0$, $\\text{CFL}=0.5$, $t_{f}=0.3$, $u_{0}(x)=\\sin(2\\pi x)$。\n- 情况 2：$N=600$, $a=-0.8$, $L=1.0$, $\\text{CFL}=0.9$, $t_{f}=0.25$, $u_{0}(x)=1$ 在 $[0.25,0.75)$ 上，其他地方为 $0$（周期性）。\n- 情况 3：$N=500$, $a=1.0$, $L=1.0$, $\\text{CFL}=1.0$, $t_{f}=1.0$, $u_{0}(x)=\\exp(-100\\,(x-0.3)^{2})$。\n- 情况 4：$N=512$, $a=0.5$, $L=1.0$, $\\text{CFL}=0.99$, $t_{f}=0.2$, $u_{0}(x)=\\cos(4\\pi x) + 0.5\\,\\sin(2\\pi x)$。\n\n最后，程序打印单行 $[e_{1},e_{2},e_{3},e_{4}]$，其中每个 $e_{k}$ 都按要求四舍五入到八位小数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef initial_condition(x, kind):\n    # x in [0, L)\n    if kind == \"sine\":\n        return np.sin(2.0 * np.pi * x)\n    elif kind == \"square\":\n        # 1 on [0.25,0.75), 0 otherwise, periodic\n        return np.where((x = 0.25)  (x  0.75), 1.0, 0.0)\n    elif kind == \"gaussian\":\n        return np.exp(-100.0 * (x - 0.3) ** 2)\n    elif kind == \"mix\":\n        return np.cos(4.0 * np.pi * x) + 0.5 * np.sin(2.0 * np.pi * x)\n    else:\n        raise ValueError(\"Unknown initial condition kind\")\n\ndef exact_solution(x, a, L, t, kind):\n    # periodic wrap of x - a t into [0, L)\n    y = (x - a * t) % L\n    return initial_condition(y, kind)\n\ndef upwind_step(u, a, dt, dx):\n    # Periodic first-order upwind update for constant a\n    nu = a * dt / dx\n    if a > 0:\n        # u_i^{n+1} = u_i^n - nu (u_i^n - u_{i-1}^n)\n        u_im1 = np.roll(u, 1)\n        return u - nu * (u - u_im1)\n    elif a  0:\n        # u_i^{n+1} = u_i^n - nu (u_{i+1}^n - u_i^n); note nu0\n        u_ip1 = np.roll(u, -1)\n        return u - nu * (u_ip1 - u)\n    else:\n        # a == 0, no evolution\n        return u.copy()\n\ndef run_case(N, a, L, CFL, tf, kind):\n    # Build grid\n    dx = L / N\n    # cell centers in [0, L)\n    x = (np.arange(N) + 0.5) * dx\n    # initial condition\n    u = initial_condition(x % L, kind)\n    # if a==0, solution is constant in time\n    if a == 0.0:\n        u_num = u.copy()\n        u_ex = exact_solution(x, a, L, tf, kind)\n        err = np.sqrt(dx * np.sum((u_num - u_ex) ** 2))\n        return err\n    # nominal dt from CFL\n    dt_nom = CFL * dx / abs(a)\n    if dt_nom = 0:\n        raise ValueError(\"Non-positive time step\")\n    n_full = int(np.floor(tf / dt_nom + 1e-15))\n    t = 0.0\n    # march full steps\n    for _ in range(n_full):\n        u = upwind_step(u, a, dt_nom, dx)\n        t += dt_nom\n    # last partial step if needed\n    rem = tf - t\n    if rem > 1e-15:\n        # ensure stability: |a|*rem/dx = CFL (should be  CFL by construction)\n        u = upwind_step(u, a, rem, dx)\n        t += rem\n    # numerical solution at tf\n    u_num = u\n    # exact solution\n    u_ex = exact_solution(x, a, L, tf, kind)\n    # L2 error\n    err = np.sqrt(dx * np.sum((u_num - u_ex) ** 2))\n    return err\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (N, a, L, CFL, tf, kind)\n    test_cases = [\n        (400, 1.0, 1.0, 0.5, 0.3, \"sine\"),\n        (600, -0.8, 1.0, 0.9, 0.25, \"square\"),\n        (500, 1.0, 1.0, 1.0, 1.0, \"gaussian\"),\n        (512, 0.5, 1.0, 0.99, 0.2, \"mix\"),\n    ]\n\n    results = []\n    for case in test_cases:\n        N, a, L, CFL, tf, kind = case\n        err = run_case(N, a, L, CFL, tf, kind)\n        # Round to exactly 8 decimals\n        results.append(f\"{err:.8f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        },
        {
            "introduction": "实现了一个数值格式后，我们自然会问：“这个格式的性能如何？” 这项练习通过将其与另一个经典格式——Lax-Friedrichs格式进行对比来回答这个问题。通过使用修正方程这一强大分析工具，您将能够量化迎风格式固有的数值耗散，并理解为何尽管它很简单，但在许多情况下仍是首选。",
            "id": "3394635",
            "problem": "考虑线性平流偏微分方程 (PDE) $u_t + a\\,u_x = 0$，其中平流速度 $a \\in \\mathbb{R}$ 为常数。该方程在一个空间步长为 $\\Delta x  0$ 的均匀空间网格上，使用时间步长为 $\\Delta t  0$ 的显式时间步进方法求解。令 $r := a\\,\\Delta t/\\Delta x$ 表示 Courant–Friedrichs–Lewy (CFL) 数。定义一阶迎风格式的通量分裂形式为\n$$\nu_j^{n+1} \\;=\\; u_j^n \\;-\\; r^+\\,(u_j^n - u_{j-1}^n) \\;-\\; r^-\\,(u_{j+1}^n - u_j^n),\n$$\n其中 $r^+ := \\max(r,0)$ 且 $r^- := \\min(r,0)$。定义 Lax–Friedrichs (LF) 格式为\n$$\nu_j^{n+1} \\;=\\; \\tfrac{1}{2}\\Big(u_{j+1}^n + u_{j-1}^n\\Big) \\;-\\; \\tfrac{r}{2}\\Big(u_{j+1}^n - u_{j-1}^n\\Big).\n$$\n使用与控制 PDE 一致的时空泰勒展开，推导每种格式的领先阶修正方程，并保留由截断产生的最低阶耗散项和色散项。根据你的推导，确定 CFL 数 $r$ 在哪些区间内两种格式具有等价的领先阶修正方程，在哪些区间内它们的主要耗散不同，并比较其相对强度。从下列选项中选择唯一正确的陈述。\n\nA. 对于任意 $|r|\\le 1$，两种修正方程都有一个与 $u_{xxx}$ 成正比的领先三阶导数色散项，其系数依赖于 $r$ 并在 $|r|=1$ 时为零；对于 $0  |r|  1$，Lax–Friedrichs 格式比迎风格式有更强的领先扩散。\n\nB. 对于所有 $|r|\\le 1$，迎风格式比 Lax–Friedrichs 格式有更强的领先扩散；它们仅在 $|r|=0$ 时等价。\n\nC. 在 $|r|=1$ 时，Lax–Friedrichs 格式的修正方程保留一个非零的扩散项，而迎风格式的扩散项为零；因此它们在 $|r|=1$ 时不可能等价。\n\nD. 对于 $|r|1$，两种格式都保持稳定，且 Lax–Friedrichs 格式的扩散性变得比迎风格式弱。\n\nE. 领先的人工粘性系数满足 $\\nu_{\\mathrm{UW}} = \\tfrac{|a|\\Delta x}{2}\\,(1 - |r|)$ 和 $\\nu_{\\mathrm{LF}} = \\tfrac{\\Delta x^2}{2\\Delta t}\\,(1 - r^2)$，这意味着仅在 $|r|=1$ 时两者相等，而对于 $0  |r|  1$ 有严格不等式 $\\nu_{\\mathrm{LF}}\\nu_{\\mathrm{UW}}$。",
            "solution": "用户要求我分析和比较用于线性平流方程 $u_t + a\\,u_x = 0$ 的一阶迎风格式和 Lax-Friedrichs 格式。\n\n### **问题验证**\n\n**步骤 1：提取已知条件**\n-   **PDE**: $u_t + a\\,u_x = 0$，其中平流速度 $a \\in \\mathbb{R}$ 为常数。\n-   **离散化**: 空间步长为 $\\Delta x  0$ 的均匀空间网格，时间步长为 $\\Delta t  0$ 的显式时间步进。\n-   **CFL 数**: $r := a\\,\\Delta t/\\Delta x$。\n-   **一阶迎风格式**: $u_j^{n+1} = u_j^n - r^+\\,(u_j^n - u_{j-1}^n) - r^-\\,(u_{j+1}^n - u_j^n)$，其中 $r^+ := \\max(r,0)$ 且 $r^- := \\min(r,0)$。\n-   **Lax–Friedrichs 格式**: $u_j^{n+1} = \\tfrac{1}{2}(u_{j+1}^n + u_{j-1}^n) - \\tfrac{r}{2}(u_{j+1}^n - u_{j-1}^n)$。\n-   **任务**: 推导每种格式的领先阶修正方程，比较它们的耗散项和色散项，并从选项中选择唯一正确的陈述。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题陈述在科学上是合理的、适定的和客观的。这是偏微分方程数值分析领域的一个标准练习。所有术语和格式都得到了正确定义，并且是该领域的基本概念。问题是自洽的，并提供了进行所要求分析所需的所有必要信息。没有矛盾、歧义或事实错误。\n\n**步骤 3：结论与行动**\n问题是有效的。我将继续进行推导和分析。\n\n### **修正方程的推导**\n\n为了推导每种格式的修正方程，我们围绕点 $(x_j, t_n)$ 对格式中的各项进行泰勒级数展开。令 $u$ 表示 $u(x_j, t_n)$。我们使用的原理是：修正方程的精确解在网格点上的取值与差分格式的解完全相同。\n\n我们将数值格式表示为算子形式 $\\frac{u_j^{n+1}-u_j^n}{\\Delta t} = \\mathcal{L}_{\\Delta}(u^n)$。左侧算子在时间上展开，右侧算子在空间上展开。\n时间差分算子展开为：\n$$\n\\frac{u_j^{n+1}-u_j^n}{\\Delta t} = \\frac{e^{\\Delta t \\partial_t} - 1}{\\Delta t} u = \\left(\\partial_t + \\frac{\\Delta t}{2}\\partial_{tt} + \\frac{\\Delta t^2}{6}\\partial_{ttt} + \\dots\\right) u\n$$\n然后我们有 $\\partial_t u = \\dots$，我们使用修正方程本身递归地替换时间导数的表达式，从最低阶近似 $u_t \\approx -a u_x$ 开始。逐次近似为：\n$u_{tt} = \\partial_t(u_t) \\approx \\partial_t(-a u_x) = -a \\partial_x(u_t) \\approx a^2 u_{xx}$。\n$u_{ttt} = \\partial_t(u_{tt}) \\approx \\partial_t(a^2 u_{xx}) \\approx a^2 \\partial_{xx}(-a u_x) = -a^3 u_{xxx}$。\n\n如果修正方程是 $u_t + a u_x = D u_{xx} + E u_{xxx} + \\dots$，那么对 $u_{tt}$ 更精确的代换是：\n$u_{tt} = \\partial_t(-a u_x + D u_{xx} + \\dots) = -a u_{xt} + D u_{xxt} + \\dots = -a \\partial_x(-a u_x + \\dots) + D \\partial_{xx}(-a u_x + \\dots) = a^2 u_{xx} - a D u_{xxx} - a D u_{xxx} + \\dots = a^2 u_{xx} - 2a D u_{xxx} + \\dots$。\n\n**1. 一阶迎风 (UW) 格式**\n\n该格式可以写成 $\\frac{u_j^{n+1}-u_j^n}{\\Delta t} = -\\frac{a^+}{\\Delta x}(u_j^n - u_{j-1}^n) - \\frac{a^-}{\\Delta x}(u_{j+1}^n - u_j^n)$。\n空间算子是 $\\mathcal{L}_{\\Delta}^{UW} = -\\frac{a^+}{\\Delta x}(1-e^{-\\Delta x \\partial_x}) - \\frac{a^-}{\\Delta x}(e^{\\Delta x \\partial_x}-1)$。\n展开指数算子：\n$\\mathcal{L}_{\\Delta}^{UW} = -\\frac{a^+}{\\Delta x}(\\Delta x \\partial_x - \\frac{\\Delta x^2}{2}\\partial_{xx} + \\frac{\\Delta x^3}{6}\\partial_{xxx} - \\dots) - \\frac{a^-}{\\Delta x}(\\Delta x \\partial_x + \\frac{\\Delta x^2}{2}\\partial_{xx} + \\frac{\\Delta x^3}{6}\\partial_{xxx} + \\dots)$。\n将各项相加得到：\n$\\mathcal{L}_{\\Delta}^{UW} = -(a^+ + a^-)\\partial_x + \\frac{\\Delta x}{2}(a^+ - a^-)\\partial_{xx} - \\frac{\\Delta x^2}{6}(a^+ + a^-)\\partial_{xxx} + \\dots$。\n使用 $a = a^+ + a^-$ 和 $|a| = a^+ - a^-$，我们得到：\n$\\mathcal{L}_{\\Delta}^{UW} = -a\\partial_x + \\frac{|a|\\Delta x}{2}\\partial_{xx} - \\frac{a\\Delta x^2}{6}\\partial_{xxx} + \\dots$。\n\n令时间和空间算子展开式相等：\n$\\partial_t u + \\frac{\\Delta t}{2}\\partial_{tt} u + \\dots = -a\\partial_x u + \\frac{|a|\\Delta x}{2}\\partial_{xx} u - \\frac{a\\Delta x^2}{6}\\partial_{xxx} u + \\dots$。\n整理得到 $\\partial_t u$ 的表达式：\n$\\partial_t u + a\\partial_x u = \\left(\\frac{|a|\\Delta x}{2} - \\frac{\\Delta t}{2}\\partial_{tt}\\right)u - \\frac{a\\Delta x^2}{6}\\partial_{xxx} u + \\dots$。\n代入 $\\partial_{tt} \\approx a^2\\partial_{xx}$：\n$\\partial_t u + a\\partial_x u = \\left(\\frac{|a|\\Delta x}{2} - \\frac{a^2\\Delta t}{2}\\right)\\partial_{xx} u + \\dots$。\n领先阶扩散系数（人工粘性）为：\n$D_{\\mathrm{UW}} = \\frac{|a|\\Delta x}{2} - \\frac{a^2\\Delta t}{2} = \\frac{|a|\\Delta x}{2} \\left(1 - \\frac{a^2\\Delta t}{|a|\\Delta x}\\right) = \\frac{|a|\\Delta x}{2} \\left(1 - \\frac{|a|\\Delta t}{\\Delta x}\\right) = \\frac{|a|\\Delta x}{2}(1-|r|)$。\n\n问题要求耗散项和色散项。通过保留更多项可以找到三阶导数色散项的系数 $E_{\\mathrm{UW}}$：\n$E_{\\mathrm{UW}} u_{xxx} = \\left(-\\frac{a \\Delta x^2}{6} - \\frac{\\Delta t}{2}(-2aD_{\\mathrm{UW}}) - \\frac{\\Delta t^2}{6}(-a^3)\\right) u_{xxx}$。\n$E_{\\mathrm{UW}} = -\\frac{a\\Delta x^2}{6} + a\\Delta t D_{\\mathrm{UW}} + \\frac{a^3\\Delta t^2}{6}$。\n代入 $D_{\\mathrm{UW}}$：\n$E_{\\mathrm{UW}} = -\\frac{a\\Delta x^2}{6} + a\\Delta t \\frac{|a|\\Delta x}{2}(1-|r|) + \\frac{a^3\\Delta t^2}{6}$。\n由于 $a\\Delta t = r\\Delta x$，$|a|\\Delta t = |r|\\Delta x$ 且 $\\operatorname{sgn}(a) = \\operatorname{sgn}(r)$：\n$E_{\\mathrm{UW}} = a\\Delta x^2 \\left[-\\frac{1}{6} + \\frac{r}{|a|\\Delta x} \\frac{|a|\\Delta x}{2\\Delta x}(1-|r|) + \\frac{r^2}{6} \\right] = a\\Delta x^2 \\left[-\\frac{1}{6} + \\frac{r}{a}\\frac{|a|}{2}(1-|r|) + \\frac{r^2}{6} \\right] = a\\Delta x^2 \\left[-\\frac{1}{6} + \\frac{|r|}{2}(1-|r|) + \\frac{|r|^2}{6} \\right]$。\n$E_{\\mathrm{UW}} = a\\Delta x^2 \\left[\\frac{-1 + 3|r| - 3|r|^2 + |r|^2}{6}\\right] = \\frac{a\\Delta x^2}{6}(-2|r|^2 + 3|r| - 1) = -\\frac{a\\Delta x^2}{6}(2|r|-1)(|r|-1)$。\n\n**2. Lax-Friedrichs (LF) 格式**\n\n该格式为 $\\frac{u_j^{n+1}-u_j^n}{\\Delta t} = \\frac{u_{j+1}^n - 2u_j^n + u_{j-1}^n}{2\\Delta t} - \\frac{a}{2\\Delta x}(u_{j+1}^n - u_{j-1}^n)$。\n空间算子是 $\\mathcal{L}_{\\Delta}^{LF} = \\frac{e^{\\Delta x \\partial_x} + e^{-\\Delta x \\partial_x} - 2}{2\\Delta t} - \\frac{a}{2\\Delta x}(e^{\\Delta x \\partial_x} - e^{-\\Delta x \\partial_x})$。\n展开各项：\n$e^{\\Delta x\\partial_x} \\pm e^{-\\Delta x\\partial_x} = (1 \\pm \\Delta x\\partial_x + \\frac{\\Delta x^2}{2}\\partial_{xx} \\pm \\dots) \\pm (1 \\mp \\Delta x\\partial_x + \\frac{\\Delta x^2}{2}\\partial_{xx} \\mp \\dots)$。\n$\\mathcal{L}_{\\Delta}^{LF} = \\frac{(2 + \\Delta x^2\\partial_{xx} + \\dots) - 2}{2\\Delta t} - \\frac{a}{2\\Delta x}(2\\Delta x\\partial_x + \\frac{\\Delta x^3}{3}\\partial_{xxx} + \\dots)$。\n$\\mathcal{L}_{\\Delta}^{LF} = \\frac{\\Delta x^2}{2\\Delta t}\\partial_{xx} - a\\partial_x - \\frac{a\\Delta x^2}{6}\\partial_{xxx} + \\dots$。\n\n与时间算子展开式相等：\n$\\partial_t u + \\frac{\\Delta t}{2}\\partial_{tt} u + \\dots = -a\\partial_x u + \\frac{\\Delta x^2}{2\\Delta t}\\partial_{xx} u - \\frac{a\\Delta x^2}{6}\\partial_{xxx} u + \\dots$。\n$\\partial_t u + a\\partial_x u = \\left(\\frac{\\Delta x^2}{2\\Delta t} - \\frac{\\Delta t}{2}\\partial_{tt}\\right)u - \\frac{a\\Delta x^2}{6}\\partial_{xxx} u + \\dots$。\n使用 $\\partial_{tt} \\approx a^2\\partial_{xx}$：\n$\\partial_t u + a\\partial_x u = \\left(\\frac{\\Delta x^2}{2\\Delta t} - \\frac{a^2\\Delta t}{2}\\right)\\partial_{xx} u + \\dots$。\n扩散系数为：\n$D_{\\mathrm{LF}} = \\frac{\\Delta x^2}{2\\Delta t} - \\frac{a^2\\Delta t}{2} = \\frac{\\Delta x^2}{2\\Delta t} \\left(1 - \\frac{a^2\\Delta t^2}{\\Delta x^2}\\right) = \\frac{\\Delta x^2}{2\\Delta t}(1-r^2)$。\n\n色散系数 $E_{\\mathrm{LF}}$ 为：\n$E_{\\mathrm{LF}} = -\\frac{a\\Delta x^2}{6} + a\\Delta t D_{\\mathrm{LF}} + \\frac{a^3\\Delta t^2}{6}$。\n$E_{\\mathrm{LF}} = -\\frac{a\\Delta x^2}{6} + a\\Delta t \\left(\\frac{\\Delta x^2}{2\\Delta t}(1-r^2)\\right) + \\frac{a^3\\Delta t^2}{6}$。\n$E_{\\mathrm{LF}} = -\\frac{a\\Delta x^2}{6} + \\frac{a\\Delta x^2}{2}(1-r^2) + \\frac{a\\Delta x^2}{6}r^2$。\n$E_{\\mathrm{LF}} = a\\Delta x^2 \\left(-\\frac{1}{6} + \\frac{1}{2} - \\frac{r^2}{2} + \\frac{r^2}{6}\\right) = a\\Delta x^2 \\left(\\frac{1}{3} - \\frac{2r^2}{6}\\right) = \\frac{a\\Delta x^2}{3}(1-r^2)$。\n\n### **选项分析**\n\n现在我们根据推导出的系数，在稳定区域 $|r|\\le 1$ 内评估每个陈述。\n-   **扩散（人工粘性）系数**：\n    -   $\\nu_{\\mathrm{UW}} = D_{\\mathrm{UW}} = \\frac{|a|\\Delta x}{2}(1-|r|)$。\n    -   $\\nu_{\\mathrm{LF}} = D_{\\mathrm{LF}} = \\frac{\\Delta x^2}{2\\Delta t}(1-r^2)$。这可以利用 $|r|=|a|\\Delta t/\\Delta x$ 重写为 $\\nu_{\\mathrm{LF}} = \\frac{|a|\\Delta x}{2|r|}(1-r^2)$。\n\n-   **色散系数**：\n    -   $E_{\\mathrm{UW}} = -\\frac{a\\Delta x^2}{6}(2|r|-1)(|r|-1)$。\n    -   $E_{\\mathrm{LF}} = \\frac{a\\Delta x^2}{3}(1-r^2)$。\n\n**A. 对于任意 $|r|\\le 1$，两种修正方程都有一个与 $u_{xxx}$ 成正比的领先三阶导数色散项，其系数依赖于 $r$ 并在 $|r|=1$ 时为零；对于 $0  |r|  1$，Lax–Friedrichs 格式比迎风格式有更强的领先扩散。**\n短语“领先...色散项”指的是最低阶的非零奇数阶导数项。对于迎风格式，系数 $E_{\\mathrm{UW}}$ 在 $|r|=1$ 和 $|r|=0.5$ 时为零。在 $|r|=0.5$ 时，领先的色散项不是三阶导数，而是更高阶的项。对于 Lax–Friedrichs 格式，$E_{\\mathrm{LF}}$ 在 $|r|=0.5$ 时不为零。因此，这两种格式并非对于“任意” $|r|\\le 1$ 都“共享一个领先的三阶导数...项”。全称量词“对于任意”使该陈述的第一部分为假。结论：**错误**。\n\n**B. 对于所有 $|r|\\le 1$，迎风格式比 Lax–Friedrichs 格式有更强的领先扩散；它们仅在 $|r|=0$ 时等价。**\n让我们比较在 $0|r|1$ 情况下 $\\nu_{\\mathrm{UW}}$ 和 $\\nu_{\\mathrm{LF}}$ 的大小。它们的比值为 $\\frac{\\nu_{\\mathrm{LF}}}{\\nu_{\\mathrm{UW}}} = \\frac{\\frac{|a|\\Delta x}{2|r|}(1-|r|^2)}{\\frac{|a|\\Delta x}{2}(1-|r|)} = \\frac{(1-|r|)(1+|r|)}{|r|(1-|r|)} = \\frac{1+|r|}{|r|} = \\frac{1}{|r|} + 1$。对于 $0  |r|  1$，我们有 $\\frac{1}{|r|} > 1$，所以 $\\frac{\\nu_{\\mathrm{LF}}}{\\nu_{\\mathrm{UW}}} > 2$。这意味着 $\\nu_{\\mathrm{LF}} > \\nu_{\\mathrm{UW}}$。该陈述声称的恰恰相反。此外，在 $|r|=0$ 时（此时 $a=0$），$\\nu_{\\mathrm{UW}}=0$ 而 $\\nu_{\\mathrm{LF}}=\\frac{\\Delta x^2}{2\\Delta t}$，所以它们不等价。结论：**错误**。\n\n**C. 在 $|r|=1$ 时，Lax–Friedrichs 格式的修正方程保留一个非零的扩散项，而迎风格式的扩散项为零；因此它们在 $|r|=1$ 时不可能等价。**\n在 $|r|=1$ 时，Lax–Friedrichs 格式的扩散系数是 $\\nu_{\\mathrm{LF}} = \\frac{\\Delta x^2}{2\\Delta t}(1-1^2) = 0$。声称它非零的陈述是错误的。事实上，在 $|r|=1$ 时，$\\nu_{\\mathrm{UW}}$ 和 $\\nu_{\\mathrm{LF}}$ 均为零。结论：**错误**。\n\n**D. 对于 $|r|1$，两种格式都保持稳定，且 Lax–Friedrichs 格式的扩散性变得比迎风格式弱。**\n对这两种显式格式的 von Neumann 稳定性分析表明，它们仅在 $|r| \\le 1$ 时稳定。它们在 $|r|1$ 时稳定的前提是错误的。结论：**错误**。\n\n**E. 领先的人工粘性系数满足 $\\nu_{\\mathrm{UW}} = \\tfrac{|a|\\Delta x}{2}\\,(1 - |r|)$ 和 $\\nu_{\\mathrm{LF}} = \\tfrac{\\Delta x^2}{2\\Delta t}\\,(1 - r^2)$，这意味着仅在 $|r|=1$ 时两者相等，而对于 $0  |r|  1$ 有严格不等式 $\\nu_{\\mathrm{LF}}\\nu_{\\mathrm{UW}}$。**\n该陈述包含三个部分。\n1.  系数 $\\nu_{\\mathrm{UW}}$ 和 $\\nu_{\\mathrm{LF}}$ 的公式与我们的推导完全一致。\n2.  相等条件：$\\nu_{\\mathrm{UW}} = \\nu_{\\mathrm{LF}}$ 要求 $\\frac{|a|\\Delta x}{2}(1-|r|) = \\frac{|a|\\Delta x}{2|r|}(1-r^2) = \\frac{|a|\\Delta x}{2|r|}(1-|r|)(1+|r|)$。对于 $|r| \\in [0,1)$，我们可以约去公因子得到 $1 = \\frac{1+|r|}{|r|}$，这意味着 $|r| = 1+|r|$，即 $0=1$，这是一个矛盾。所以在 $[0,1)$ 区间内不存在相等的情况。在 $|r|=1$ 时，两个系数都为 0，所以它们相等。因此，在稳定区域内，仅当 $|r|=1$ 时等式成立。这是正确的。\n3.  对于 $0|r|1$ 的不等式条件：如选项 B 的分析所示，$\\frac{\\nu_{\\mathrm{LF}}}{\\nu_{\\mathrm{UW}}} = \\frac{1}{|r|} + 1 > 2$。因此，对于 $0|r|1$，$\\nu_{\\mathrm{LF}} > \\nu_{\\mathrm{UW}}$ 严格成立。这是正确的。\n该陈述的所有部分都是正确的。\n结论：**正确**。",
            "answer": "$$\\boxed{E}$$"
        },
        {
            "introduction": "一个数值格式的行为会深受边界条件的影响，这是一个深刻而重要的事实。这项练习对比了我们熟悉的周期性边界条件与在物理上更常见的流入/流出边界条件。您将发现边界条件如何改变离散算子的数学结构（从循环矩阵到非正规矩阵），以及这种改变如何影响质量守恒、稳定性和离散系统中波传播的本质。",
            "id": "3394627",
            "problem": "考虑线性平流方程 $u_t + a\\,u_x = 0$，其中波速 $a0$ 为常数。该方程定义在一维区域上，该区域被一个包含 $N$ 个单元的均匀网格离散化，单元宽度为 $\\Delta x$，单元中心为 $x_i$，单元平均值记为 $u_i(t)$。在空间上使用一阶迎风有限体积法（方法线），数值通量为 $F_{i+\\frac{1}{2}} = a\\,u_i$（对于 $a0$）。考虑两种边界设置：(i) 周期性边界条件，以及 (ii) 在 $[0,L]$ 上的入流/出流区域，具有指定的入流 $u(0,t)=g(t)$ 且在 $x=L$ 处无条件。对于时间离散化，也考虑时间步长为 $\\Delta t$ 的前向欧拉法，以及 Courant–Friedrichs–Lewy (CFL) 数 $\\nu = a\\,\\Delta t/\\Delta x$。定义离散总质量为 $M(t) = \\sum_{i=1}^N u_i(t)\\,\\Delta x$。\n\n在上述两种边界设置下，选择所有关于该格式的质量守恒、相误差和离散谱的正确陈述：\n\nA. 在周期性区域上，半离散迎风格式对所有 $t$ 都精确地守恒离散总质量，并且其对于无量纲角 $\\theta \\in [-\\pi,\\pi]$ 的傅里叶模的离散色散关系给出了数值相速度 $c_p(\\theta) = a\\,\\frac{\\sin\\theta}{\\theta}$。\n\nB. 在具有齐次入流 $g(t)\\equiv 0$ 的入流/出流区域上，半离散空间算子是下双对角矩阵，其唯一特征值为 $-a/\\Delta x$，代数重数为 $N$。因此，其齐次演化没有振荡分量（没有相位），并表现出由实负谱控制的衰减；任何明显的波状下游输运都源于非正规的移位结构，而非特征相位。\n\nC. 对于周期性区域上的前向欧拉时间步进，对于角度为 $\\theta$ 的傅里叶模，其单步放大因子对所有 $\\nu \\in (0,1)$ 都满足 $\\lvert G(\\theta)\\rvert = 1$，因此对于该区间内的所有 Courant–Friedrichs–Lewy 数，该方法在时间上是无耗散的。\n\nD. 在入流/出流区域上，当 $\\nu=1$ 时，前向欧拉法简化为内部单元的纯顺风移位 $u_i^{n+1} = u_{i-1}^n$（在左边界施加入流），因此内部输运没有数值扩散；全局放大矩阵是幂零的，谱半径为 $0$，这说明在这个非正规设置中，仅靠特征值不足以表示对流输运。\n\nE. 在周期性区域上，迎风算子的半离散谱完全位于虚轴上，并且任何观察到的阻尼都是边界效应。\n\nF. 在周期性和入流/出流两种情况下，半离散有限体积格式都是守恒的，即 $\\frac{d}{dt}M(t)$ 等于边界数值通量之差；因此，对于周期性边界条件，$M(t)$ 是常数，而对于齐次入流 $g(t)\\equiv 0$，有 $\\frac{d}{dt}M(t) = -a\\,u_N(t)$，也就是说，总质量的变化率等于出流边界处出射数值通量的负值。",
            "solution": "我们从第一性原理出发：守恒律 $u_t + f(u)_x = 0$（其中线性通量为 $f(u)=a\\,u$）的有限体积半离散格式为 $u_i'(t) = -\\frac{1}{\\Delta x}\\big(F_{i+\\frac{1}{2}} - F_{i-\\frac{1}{2}}\\big)$，其中数值通量 $F_{i+\\frac{1}{2}}$ 与 $f$ 相容。对于 $a0$ 的线性平流，一阶迎风通量为 $F_{i+\\frac{1}{2}} = a\\,u_i$。对于内部单元，这得到\n$$\nu_i'(t) \\;=\\; -\\frac{a}{\\Delta x}\\,\\big(u_i(t) - u_{i-1}(t)\\big),\\quad i=1,\\dots,N,\n$$\n其中边界闭合由边界条件类型决定。\n\n质量守恒分析。定义离散质量 $M(t)=\\sum_{i=1}^N u_i(t)\\,\\Delta x$。那么\n$$\n\\frac{d}{dt}M(t) \\;=\\; \\sum_{i=1}^N u_i'(t)\\,\\Delta x \\;=\\; -\\sum_{i=1}^N \\big(F_{i+\\frac{1}{2}} - F_{i-\\frac{1}{2}}\\big) \\;=\\; -\\big(F_{N+\\frac{1}{2}} - F_{\\frac{1}{2}}\\big),\n$$\n这是一个对任何边界闭合都成立的伸缩恒等式。对于周期性边界，两端的数值通量重合，因为 $u_0=u_N$ 和 $u_{N+1}=u_1$，所以 $F_{N+\\frac{1}{2}} = F_{\\frac{1}{2}}$，因此 $M'(t)=0$。对于 $a0$ 的入流/出流区域，$F_{\\frac{1}{2}} = a\\,u_0 = a\\,g(t)$ 且 $F_{N+\\frac{1}{2}} = a\\,u_N(t)$，所以 $M'(t) = -a\\big(u_N(t) - g(t)\\big)$。特别地，对于齐次入流 $g(t)\\equiv 0$，$M'(t) = -a\\,u_N(t)$，这等于在 $x=L$ 处出射数值通量的负值。\n\n周期性区域上的色散和耗散（半离散）。在周期性均匀网格上，半离散算子是循环矩阵，并可被离散傅里叶模 $u_i(t) = \\widehat{u}(t)\\,e^{\\mathrm{i}i\\theta}$（其中 $\\theta \\in [-\\pi,\\pi]$）对角化。代入可得其符号\n$$\n\\mu(\\theta) \\;=\\; -\\frac{a}{\\Delta x}\\,\\big(1 - e^{-\\mathrm{i}\\theta}\\big)\n\\;=\\; -\\frac{a}{\\Delta x}\\,\\big(1 - \\cos\\theta\\big) \\;-\\; \\mathrm{i}\\,\\frac{a}{\\Delta x}\\,\\sin\\theta.\n$$\n因此 $\\mathrm{Re}\\,\\mu(\\theta) = -\\frac{a}{\\Delta x}(1-\\cos\\theta) \\le 0$，等号成立当且仅当 $\\theta=0$；且 $\\mathrm{Im}\\,\\mu(\\theta) = -\\frac{a}{\\Delta x}\\sin\\theta$。每个傅里叶模随时间精确演化的形式是 $\\widehat{u}(t) = \\widehat{u}(0)\\,\\exp\\big(\\mu(\\theta)\\,t\\big)$，所以数值角频率为 $\\omega(\\theta) = \\mathrm{Im}\\,\\mu(\\theta) = -\\frac{a}{\\Delta x}\\sin\\theta$。与连续情况下的 $\\omega = -a\\,k$（其中 $k=\\theta/\\Delta x$）相比较，对应的数值相速度为\n$$\nc_p(\\theta) \\;=\\; \\frac{\\omega(\\theta)}{k} \\;=\\; a\\,\\frac{\\sin\\theta}{\\theta}.\n$$\n这表现出对于 $\\theta\\neq 0$ 的色散相误差（亚特征速度）和源于 $\\mathrm{Re}\\,\\mu(\\theta)  0$ 的耗散误差。\n\n入流/出流区域上的离散谱（半离散）。对于 $a0$ 和齐次入流 $g(t)\\equiv 0$，关于 $u = (u_1,\\dots,u_N)^\\top$ 的空间半离散系统是 $u'(t) = A\\,u(t)$，其中 $A \\in \\mathbb{R}^{N\\times N}$ 是一个下双对角矩阵：\n$$\nA_{i,i} = -\\frac{a}{\\Delta x},\\quad A_{i,i-1} = \\frac{a}{\\Delta x}\\ \\text{for}\\ i=2,\\dots,N,\\quad A_{1,0}\\ \\text{absent due to inflow}.\n$$\n这个矩阵 $A$ 是一个严格下双对角矩阵加上一个常数项为 $-\\frac{a}{\\Delta x}$ 的对角线，因此其特征多项式为 $(\\lambda + \\frac{a}{\\Delta x})^N$，所以其谱为单个实特征值 $-\\frac{a}{\\Delta x}$，代数重数为 $N$。特征值中没有虚部，所以齐次演化没有由特征对编码的振荡分量。然而，$A$ 是非正规的（对于 $N1$ 不可对角化），所以解可以通过类移位结构表现出下游输运，并可能存在瞬态增长因子乘以全局衰减项 $\\exp\\big(-\\frac{a}{\\Delta x}t\\big)$。\n\n周期性区域上的前向欧拉法。将前向欧拉法应用于 $u'(t) = \\mu(\\theta)\\,u(t)$ 可得到放大因子\n$$\nG(\\theta) \\;=\\; 1 + \\Delta t\\,\\mu(\\theta) \\;=\\; 1 - \\nu\\big(1 - e^{-\\mathrm{i}\\theta}\\big) \\;=\\; 1 - \\nu + \\nu e^{-\\mathrm{i}\\theta}.\n$$\n其模满足\n$$\n\\lvert G(\\theta)\\rvert^2 \\;=\\; \\big(1 - \\nu + \\nu\\cos\\theta\\big)^2 + \\big(\\nu\\sin\\theta\\big)^2 \\;=\\; 1 - 2\\nu(1-\\nu)\\big(1 - \\cos\\theta\\big).\n$$\n对于 $\\nu \\in (0,1)$ 和 $\\theta\\neq 0$，有 $1 - \\cos\\theta  0$，所以 $\\lvert G(\\theta)\\rvert  1$。仅在极限情况 $\\theta=0$ 或 $\\nu\\in\\{0,1\\}$ 时，才有 $\\lvert G(\\theta)\\rvert=1$。因此，当 $\\nu \\in (0,1)$ 时，前向欧拉法对所有非零模都是耗散的。\n\n在入流/出流区域上，当 $\\nu=1$ 时的前向欧拉法。对于 $a0$ 的全离散更新格式是\n$$\nu_i^{n+1} \\;=\\; u_i^n - \\nu\\big(u_i^n - u_{i-1}^n\\big) \\;=\\; (1-\\nu)\\,u_i^n + \\nu\\,u_{i-1}^n.\n$$\n当 $\\nu=1$ 时，对于 $i=2,\\dots,N$，这简化为 $u_i^{n+1} = u_{i-1}^n$，其中 $u_1^{n+1}$ 由入流设定。全局放大矩阵是严格次对角移位矩阵（第一分量由入流施加），它在齐次子空间上是幂零的，并且所有特征值都等于 $0$，尽管它每个时间步将内部数据输运一个单元。这再次反映了非正规性：仅靠特征值无法捕捉对流输运。\n\n现在我们评估每个选项：\n\nA. 正确。守恒的伸缩恒等式表明对于周期性边界，$M(t)$ 精确守恒。上面计算的傅里叶符号 $\\mu(\\theta)$ 导出了半离散格式的数值相速度 $c_p(\\theta) = a\\,\\frac{\\sin\\theta}{\\theta}$，该速度由 $\\omega(\\theta) = \\mathrm{Im}\\,\\mu(\\theta)$ 和 $k=\\theta/\\Delta x$ 推得。\n\nB. 正确。对于齐次入流，半离散矩阵有一个代数重数为 $N$ 的单一实特征值 $-\\frac{a}{\\Delta x}$。齐次半群 $e^{At}$ 没有振荡部分（没有虚谱），因此任何下游传播都源于非正规的、类移位结构，而不是特征相位。衰减由实负谱控制，可能因不可对角化而受到多项式项的调制。\n\nC. 不正确。如上所示，对于 $\\nu\\in (0,1)$ 和 $\\theta\\neq 0$，$\\lvert G(\\theta)\\rvert  1$。因此，前向欧拉法对于非零模是耗散的；除非在 $\\theta=0$ 或 $\\nu\\in\\{0,1\\}$ 的特殊情况下，它不是无耗散的。\n\nD. 正确。当 $\\nu=1$ 时，更新是内部的纯移位 $u_i^{n+1} = u_{i-1}^n$，这意味着没有内部数值扩散；放大矩阵是幂零的，谱半径为 $0$，但仍然每个时间步将信息输运一个单元，这例证了在非正规问题中基于特征值的直觉的局限性。\n\nE. 不正确。在周期性区域上，半离散特征值为 $\\mu(\\theta) = -\\frac{a}{\\Delta x}\\big(1 - \\cos\\theta\\big) - \\mathrm{i}\\,\\frac{a}{\\Delta x}\\sin\\theta$，对于 $\\theta\\neq 0$ 其有负实部。因此，谱不位于虚轴上，并且存在独立于边界效应的内在数值阻尼。\n\nF. 正确。半离散格式是守恒的，给出 $\\frac{d}{dt}M(t) = -\\big(F_{N+\\frac{1}{2}} - F_{\\frac{1}{2}}\\big)$。因此对于周期性边界，$M'(t)=0$。对于齐次入流 $g\\equiv 0$，$F_{\\frac{1}{2}}=0$ 且 $F_{N+\\frac{1}{2}}=a\\,u_N(t)$，所以 $\\frac{d}{dt}M(t) = -a\\,u_N(t)$，即总质量的变化率等于出流边界处出射数值通量的负值。",
            "answer": "$$\\boxed{ABDF}$$"
        }
    ]
}