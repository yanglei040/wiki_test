{
    "hands_on_practices": [
        {
            "introduction": "理论学习之后，最好的检验方法莫过于亲自动手计算。本节将指导你完成Lax-Friedrichs格式的第一个实践：模拟一个简单的激波。通过对一个具有激波解的标量黎曼问题（无粘伯格斯方程）进行单步计算，你将直接应用该格式的公式，并将其数值结果与精确解进行对比 。这个练习旨在揭示该格式捕捉间断的基本机制，并让你直观地感受到其固有的数值耗散特性。",
            "id": "3413967",
            "problem": "考虑无粘伯格斯流的标量守恒律（一个一阶非线性偏微分方程），\n$$\nu_{t} + \\left(\\tfrac{1}{2}u^{2}\\right)_{x} = 0,\n$$\n该方程定义在实数轴上，并具有黎曼初值数据\n$$\nu(x,0) = \\begin{cases}\nu_{L},  x  0,\\\\\nu_{R},  x  0,\n\\end{cases}\n$$\n其中左右态分别为 $u_{L}=\\tfrac{3}{2}$ 和 $u_{R}=-\\tfrac{1}{2}$。通量 $f(u)=\\tfrac{1}{2}u^{2}$ 是凸函数。使用均匀有限体积网格，其单元为 $C_{i}=[i\\,\\Delta x,(i+1)\\,\\Delta x]$ 且 $\\Delta x=1$，使得间断位于单元 $C_{-1}$ 和 $C_{0}$ 之间的交界面上。在时间 $t^{0}=0$ 时，通过 $u_{i}^{0}=u_{L}$（对于 $i\\le -1$）和 $u_{i}^{0}=u_{R}$（对于 $i\\ge 0$）来初始化单元平均值。使用标量守恒律的经典 Lax–Friedrichs 中心格式，以 $\\Delta t=\\tfrac{2}{5}$ 的时间步长演化一步。\n\n从有限体积守恒更新和 Lax–Friedrichs 中心数值通量定义出发，推导第一步的更新值 $u_{-1}^{1}$ 和 $u_{0}^{1}$，并根据给定数据计算它们的值。然后，从 Rankine–Hugoniot 跳跃条件出发，确定在时间 $t=\\Delta t$ 时的精确自相似黎曼解，并计算此时单元 $C_{-1}$ 和 $C_{0}$ 内的精确单元平均值。将一个时间步后两个交界面单元上的总绝对误差定义为\n$$\nE \\equiv \\left|u_{-1}^{1} - \\bar{u}_{-1}^{\\mathrm{exact}}(\\Delta t)\\right| + \\left|u_{0}^{1} - \\bar{u}_{0}^{\\mathrm{exact}}(\\Delta t)\\right|.\n$$\n对于上述参数，精确计算 $E$。将最终答案表示为一个无单位的精确分数。",
            "solution": "该问题被评估为有效，因为它是偏微分方程数值分析中的一个明确定义的练习，使用了标准模型（伯格斯方程）、方法（Lax-Friedrichs 格式）和概念（黎曼问题、Rankine-Hugoniot 条件）。它具有科学依据，内容自洽且客观。\n\n求解过程包括三个主要部分：\n1.  使用 Lax-Friedrichs 格式计算一个时间步后单元 $C_{-1}$ 和 $C_{0}$ 中的数值解。\n2.  确定黎曼问题的精确解，并计算同一时刻单元 $C_{-1}$ 和 $C_{0}$ 中的精确单元平均值。\n3.  通过比较数值结果和精确结果来计算总绝对误差 $E$。\n\n**第 1 部分：通过 Lax-Friedrichs 格式求解数值解**\n\n标量守恒律由 $u_{t} + f(u)_{x} = 0$ 给出，其中通量为 $f(u) = \\frac{1}{2}u^{2}$。\n有限体积法使用以下守恒公式更新单元平均值 $u_{i}^{n} \\approx \\frac{1}{\\Delta x}\\int_{C_i} u(x, t^n) dx$：\n$$u_{i}^{n+1} = u_{i}^{n} - \\frac{\\Delta t}{\\Delta x} \\left( F_{i+1/2}^{n} - F_{i-1/2}^{n} \\right)$$\n其中 $F_{i+1/2}^{n}$ 是单元 $C_i$ 和 $C_{i+1}$ 之间的数值通量。\n\n经典 Lax-Friedrichs 中心格式将数值通量定义为：\n$$F_{i+1/2} = \\frac{1}{2} \\left[ f(u_{i}) + f(u_{i+1}) \\right] - \\frac{1}{2} \\frac{\\Delta x}{\\Delta t} \\left( u_{i+1} - u_{i} \\right)$$\n为简便起见，我们省略当前时间步状态的上标 $n$。\n\n给定的参数如下：\n- 左态：$u_{L} = \\frac{3}{2}$\n- 右态：$u_{R} = -\\frac{1}{2}$\n- 单元宽度：$\\Delta x = 1$\n- 时间步长：$\\Delta t = \\frac{2}{5}$\n- 通量函数：$f(u) = \\frac{1}{2}u^{2}$\n\n在 $t^{0}=0$ 时的初始单元平均值被指定为 $u_{i}^{0} = u_{L} = \\frac{3}{2}$（对于 $i \\le -1$）和 $u_{i}^{0} = u_{R} = -\\frac{1}{2}$（对于 $i \\ge 0$）。我们需要计算 $u_{-1}^{1}$ 和 $u_{0}^{1}$。\n\n首先，我们计算在交界面 $i=-3/2$, $i=-1/2$ 和 $i=1/2$ 处所需的数值通量。\n在时间 $t^0$ 时的状态为：$u_{-2}^0 = \\frac{3}{2}$，$u_{-1}^0 = \\frac{3}{2}$，$u_{0}^0 = -\\frac{1}{2}$，$u_{1}^0 = -\\frac{1}{2}$。\n比值 $\\frac{\\Delta x}{\\Delta t} = \\frac{1}{2/5} = \\frac{5}{2}$。\n\n通量 $F_{-3/2}$：该通量位于单元 $C_{-2}$ 和 $C_{-1}$ 之间。\n状态为 $u_{-2}^0 = u_{-1}^0 = \\frac{3}{2}$。由于状态相等，格式必须是一致的，即 $F_{-3/2} = f(u_{L})$。\n$F_{-3/2} = \\frac{1}{2} \\left[ f(\\frac{3}{2}) + f(\\frac{3}{2}) \\right] - \\frac{1}{2} \\frac{5}{2} \\left( \\frac{3}{2} - \\frac{3}{2} \\right) = f(\\frac{3}{2}) = \\frac{1}{2}\\left(\\frac{3}{2}\\right)^{2} = \\frac{9}{8}$。\n\n通量 $F_{1/2}$：该通量位于单元 $C_{0}$ 和 $C_{1}$ 之间。\n状态为 $u_{0}^0 = u_{1}^0 = -\\frac{1}{2}$。通量为 $F_{1/2} = f(u_{R})$。\n$F_{1/2} = \\frac{1}{2} \\left[ f(-\\frac{1}{2}) + f(-\\frac{1}{2}) \\right] - \\frac{1}{2} \\frac{5}{2} \\left( -\\frac{1}{2} - (-\\frac{1}{2}) \\right) = f(-\\frac{1}{2}) = \\frac{1}{2}\\left(-\\frac{1}{2}\\right)^{2} = \\frac{1}{8}$。\n\n通量 $F_{-1/2}$：该通量位于单元 $C_{-1}$ 和 $C_{0}$ 之间，即初始间断所在的位置。\n状态为 $u_{-1}^0 = \\frac{3}{2}$ 和 $u_{0}^0 = -\\frac{1}{2}$。\n$f(u_{-1}^0) = f(\\frac{3}{2}) = \\frac{9}{8}$ 且 $f(u_{0}^0) = f(-\\frac{1}{2}) = \\frac{1}{8}$。\n$$F_{-1/2} = \\frac{1}{2} \\left[ \\frac{9}{8} + \\frac{1}{8} \\right] - \\frac{1}{2} \\frac{5}{2} \\left( -\\frac{1}{2} - \\frac{3}{2} \\right) = \\frac{1}{2} \\left( \\frac{10}{8} \\right) - \\frac{5}{4} \\left( -2 \\right) = \\frac{10}{16} + \\frac{10}{4} = \\frac{5}{8} + \\frac{20}{8} = \\frac{25}{8}$$\n\n现在我们可以计算更新后的单元平均值。\n对于单元 $C_{-1}$：\n$$u_{-1}^{1} = u_{-1}^{0} - \\frac{\\Delta t}{\\Delta x} \\left( F_{-1/2} - F_{-3/2} \\right) = \\frac{3}{2} - \\frac{2/5}{1} \\left( \\frac{25}{8} - \\frac{9}{8} \\right)$$\n$$u_{-1}^{1} = \\frac{3}{2} - \\frac{2}{5} \\left( \\frac{16}{8} \\right) = \\frac{3}{2} - \\frac{2}{5} (2) = \\frac{3}{2} - \\frac{4}{5} = \\frac{15 - 8}{10} = \\frac{7}{10}$$\n\n对于单元 $C_{0}$：\n$$u_{0}^{1} = u_{0}^{0} - \\frac{\\Delta t}{\\Delta x} \\left( F_{1/2} - F_{-1/2} \\right) = -\\frac{1}{2} - \\frac{2/5}{1} \\left( \\frac{1}{8} - \\frac{25}{8} \\right)$$\n$$u_{0}^{1} = -\\frac{1}{2} - \\frac{2}{5} \\left( -\\frac{24}{8} \\right) = -\\frac{1}{2} - \\frac{2}{5} (-3) = -\\frac{1}{2} + \\frac{6}{5} = \\frac{-5 + 12}{10} = \\frac{7}{10}$$\n数值近似解为 $u_{-1}^{1} = \\frac{7}{10}$ 和 $u_{0}^{1} = \\frac{7}{10}$。\n\n**第 2 部分：精确解与单元平均值**\n\n黎曼问题的初始状态为 $u_{L} = \\frac{3}{2}$ 和 $u_{R} = -\\frac{1}{2}$。特征速度由 $f'(u) = u$ 给出。由于 $u_{L}  u_{R}$，特征线相交，解为激波。\n激波速度 $s$ 由 Rankine-Hugoniot 跳跃条件给出：\n$$s = \\frac{f(u_{R}) - f(u_{L})}{u_{R} - u_{L}} = \\frac{\\frac{1}{2}u_{R}^{2} - \\frac{1}{2}u_{L}^{2}}{u_{R} - u_{L}} = \\frac{1}{2} \\frac{(u_{R}-u_{L})(u_{R}+u_{L})}{u_{R}-u_{L}} = \\frac{u_{L}+u_{R}}{2}$$\n代入给定值：\n$$s = \\frac{\\frac{3}{2} - \\frac{1}{2}}{2} = \\frac{1}{2}$$\n激波在 $t=0$ 时从 $x=0$ 开始，以恒定速度 $s=\\frac{1}{2}$ 传播。其在时间 $t$ 的位置是 $x_{s}(t) = st = \\frac{1}{2}t$。\n精确解为：\n$$u(x,t) = \\begin{cases} u_{L} = \\frac{3}{2},  x  x_{s}(t) \\\\ u_{R} = -\\frac{1}{2},  x > x_{s}(t) \\end{cases}$$\n我们需要求出在 $t=\\Delta t = \\frac{2}{5}$ 时的精确单元平均值。此时，激波位置为 $x_{s}(\\Delta t) = \\frac{1}{2} \\cdot \\frac{2}{5} = \\frac{1}{5}$。\n\n因为 $\\Delta x=1$，我们关心的单元是 $C_{-1} = [-1, 0]$ 和 $C_{0} = [0, 1]$。\n单元 $C_{-1}$ 的精确平均值：$\\bar{u}_{-1}^{\\mathrm{exact}}(\\Delta t)$\n对于任意 $x \\in [-1, 0]$，都有 $x  \\frac{1}{5}$。因此，在整个单元 $C_{-1}$ 中，$u(x, \\Delta t) = u_{L} = \\frac{3}{2}$。\n$$\\bar{u}_{-1}^{\\mathrm{exact}}(\\Delta t) = \\frac{1}{\\Delta x} \\int_{-1}^{0} u(x, \\Delta t) \\, dx = \\frac{1}{1} \\int_{-1}^{0} \\frac{3}{2} \\, dx = \\frac{3}{2} [x]_{-1}^{0} = \\frac{3}{2}(0 - (-1)) = \\frac{3}{2}$$\n\n单元 $C_{0}$ 的精确平均值：$\\bar{u}_{0}^{\\mathrm{exact}}(\\Delta t)$\n位于 $x_{s} = \\frac{1}{5}$ 的激波在单元 $C_{0}=[0, 1]$ 内部。该单元被激波所分割。\n- 对于 $x \\in [0, \\frac{1}{5})$，$u(x, \\Delta t) = u_{L} = \\frac{3}{2}$。\n- 对于 $x \\in (\\frac{1}{5}, 1]$，$u(x, \\Delta t) = u_{R} = -\\frac{1}{2}$。\n精确单元平均值为：\n$$\\bar{u}_{0}^{\\mathrm{exact}}(\\Delta t) = \\frac{1}{\\Delta x} \\int_{0}^{1} u(x, \\Delta t) \\, dx = \\int_{0}^{1/5} \\frac{3}{2} \\, dx + \\int_{1/5}^{1} \\left(-\\frac{1}{2}\\right) \\, dx$$\n$$\\bar{u}_{0}^{\\mathrm{exact}}(\\Delta t) = \\frac{3}{2} [x]_{0}^{1/5} - \\frac{1}{2} [x]_{1/5}^{1} = \\frac{3}{2} \\left(\\frac{1}{5}\\right) - \\frac{1}{2} \\left(1 - \\frac{1}{5}\\right)$$\n$$\\bar{u}_{0}^{\\mathrm{exact}}(\\Delta t) = \\frac{3}{10} - \\frac{1}{2} \\left(\\frac{4}{5}\\right) = \\frac{3}{10} - \\frac{4}{10} = -\\frac{1}{10}$$\n\n**第 3 部分：总绝对误差计算**\n\n两个单元上的总绝对误差定义为：\n$$E = \\left|u_{-1}^{1} - \\bar{u}_{-1}^{\\mathrm{exact}}(\\Delta t)\\right| + \\left|u_{0}^{1} - \\bar{u}_{0}^{\\mathrm{exact}}(\\Delta t)\\right|$$\n代入计算出的值：\n- $u_{-1}^{1} = \\frac{7}{10}$\n- $\\bar{u}_{-1}^{\\mathrm{exact}} = \\frac{3}{2} = \\frac{15}{10}$\n- $u_{0}^{1} = \\frac{7}{10}$\n- $\\bar{u}_{0}^{\\mathrm{exact}} = -\\frac{1}{10}$\n\n$$E = \\left|\\frac{7}{10} - \\frac{15}{10}\\right| + \\left|\\frac{7}{10} - \\left(-\\frac{1}{10}\\right)\\right|$$\n$$E = \\left|-\\frac{8}{10}\\right| + \\left|\\frac{7}{10} + \\frac{1}{10}\\right|$$\n$$E = \\frac{8}{10} + \\frac{8}{10} = \\frac{16}{10} = \\frac{8}{5}$$\n总绝对误差是一个精确分数。",
            "answer": "$$\\boxed{\\frac{8}{5}}$$"
        },
        {
            "introduction": "上一个练习直观地展示了Lax-Friedrichs格式的数值耗散效应，即激波被“涂抹”开。为了更深入地理解这一现象，我们需要一个更强大的分析工具。本练习将引导你使用傅里叶（von Neumann）分析方法来研究该格式的耗散特性 。通过推导半离散格式的放大因子，你将能够量化不同空间频率模式的衰减率，从而从理论上解释数值弥散的本质，并估算其对解的影响范围。",
            "id": "3413953",
            "problem": "考虑常数正速度 $a0$ 的线性平流方程 $u_{t} + a\\,u_{x} = 0$，其定义在间距为 $\\Delta x$ 的均匀网格上。令 $u_{j}(t)$ 表示在单元中心 $x_{j}=j\\,\\Delta x$ 处通过保守中心格式得到的半离散近似，该格式使用 Lax–Friedrichs (LF) 数值通量\n$$\nF_{j+\\frac{1}{2}} = \\frac{1}{2}\\left(a\\,u_{j} + a\\,u_{j+1}\\right) - \\frac{1}{2}\\,\\alpha\\left(u_{j+1}-u_{j}\\right),\n$$\n其中 $\\alpha \\ge a$ 是一个常数，其选择是为了给出特征速度的上界。该半离散的线方法系统为\n$$\n\\frac{d u_{j}}{dt} = -\\frac{F_{j+\\frac{1}{2}} - F_{j-\\frac{1}{2}}}{\\Delta x}.\n$$\n1) 使用傅里叶（冯·诺依曼）分析，代入形式为 $u_{j}(t)=\\hat{u}(t)\\,\\exp(i j \\theta)$（其中 $\\theta \\in [-\\pi,\\pi)$）的试探解，推导由 $\\frac{d\\hat{u}}{dt}=\\lambda(\\theta)\\,\\hat{u}$ 定义的精确时间放大率 $\\lambda(\\theta)$。从该表达式出发，基于第一性原理并且不假定任何关于 $\\lambda(\\theta)$ 的已有结果，证明模态阻尼率在 $\\theta \\approx \\pi$ 附近达到最大值。\n\n2) 一个急剧的跳跃间断包含直至最大可分辨波数的傅里叶分量。将“e-折叠涂抹长度”$N_{e}$（以网格单元为单位）定义为：当间断被数值方法平流时，最高波数傅里叶模的振幅下降 $\\exp(-1)$ 倍所经过的单元数。利用第 1 部分的结果，并通过间断在时间 $t = N_{e}\\,\\Delta x / a$ 内平流距离 $N_{e}\\,\\Delta x$ 的行进距离条件来消去时间变量，推导仅用 $a$ 和 $\\alpha$ 表示的 $N_{e}$ 的闭式解析表达式。给出你最终的答案，形式为一个简化的解析表达式。无需数值取整。",
            "solution": "该问题分为两部分。第一部分要求推导给定半离散格式的时间放大率，并分析其阻尼特性。第二部分基于此结果来确定间断的数值涂抹长度尺度。\n\n### 第 1 部分：放大率 $\\lambda(\\theta)$ 的推导与阻尼分析\n\n我们从节点 $x_j$ 处近似值 $u_j$ 的半离散线方法系统开始：\n$$\n\\frac{d u_{j}}{dt} = -\\frac{F_{j+\\frac{1}{2}} - F_{j-\\frac{1}{2}}}{\\Delta x}\n$$\nLax-Friedrichs 数值通量 $F_{j+\\frac{1}{2}}$ 由下式给出：\n$$\nF_{j+\\frac{1}{2}} = \\frac{1}{2}\\left(a\\,u_{j} + a\\,u_{j+1}\\right) - \\frac{1}{2}\\,\\alpha\\left(u_{j+1}-u_{j}\\right)\n$$\n我们可以通过展开通量差 $F_{j+\\frac{1}{2}} - F_{j-\\frac{1}{2}}$ 来表示 $\\frac{d u_{j}}{dt}$ 项。将通量分解为其中心平流部分和耗散部分是很有启发的。\n通量的平流部分为 $F_{j+\\frac{1}{2}}^{adv} = \\frac{1}{2}a(u_{j} + u_{j+1})$。其对右侧的贡献是：\n$$\n-\\frac{1}{\\Delta x} \\left( F_{j+\\frac{1}{2}}^{adv} - F_{j-\\frac{1}{2}}^{adv} \\right) = -\\frac{a}{2\\Delta x} \\left( (u_j + u_{j+1}) - (u_{j-1} + u_j) \\right) = -a \\frac{u_{j+1} - u_{j-1}}{2\\Delta x}\n$$\n这是 $-a\\,u_x$ 的标准二阶中心差分近似。\n\n通量的耗散部分为 $F_{j+\\frac{1}{2}}^{diss} = -\\frac{1}{2}\\alpha(u_{j+1}-u_{j})$。其贡献是：\n$$\n-\\frac{1}{\\Delta x} \\left( F_{j+\\frac{1}{2}}^{diss} - F_{j-\\frac{1}{2}}^{diss} \\right) = -\\frac{1}{\\Delta x} \\left( -\\frac{\\alpha}{2}(u_{j+1}-u_{j}) - \\left(-\\frac{\\alpha}{2}(u_{j}-u_{j-1})\\right) \\right) = \\frac{\\alpha}{2\\Delta x} (u_{j+1} - 2u_j + u_{j-1})\n$$\n这类似于一个二阶空间导数项，这是扩散的特征。\n\n结合这两个部分，半离散方程为：\n$$\n\\frac{d u_{j}}{dt} = -a \\frac{u_{j+1} - u_{j-1}}{2\\Delta x} + \\frac{\\alpha}{2\\Delta x} (u_{j+1} - 2u_j + u_{j-1})\n$$\n\n为了进行傅里叶分析，我们将试探解 $u_j(t)=\\hat{u}(t)\\,\\exp(i j \\theta)$ 代入此方程。空间依赖关系为 $u_{j\\pm 1}(t) = \\hat{u}(t)\\,\\exp(i (j\\pm 1) \\theta) = u_j(t) \\exp(\\pm i\\theta)$。时间导数为 $\\frac{d u_{j}}{dt} = \\frac{d\\hat{u}}{dt}\\exp(i j \\theta)$。\n将这些代入半离散方程得到：\n$$\n\\frac{d\\hat{u}}{dt}\\exp(i j \\theta) = -a \\frac{\\hat{u}\\exp(i(j+1)\\theta) - \\hat{u}\\exp(i(j-1)\\theta)}{2\\Delta x} + \\frac{\\alpha}{2\\Delta x} (\\hat{u}\\exp(i(j+1)\\theta) - 2\\hat{u}\\exp(ij\\theta) + \\hat{u}\\exp(i(j-1)\\theta))\n$$\n两边同除以 $\\hat{u}(t)\\exp(i j \\theta)$，我们得到 $\\frac{1}{\\hat{u}}\\frac{d\\hat{u}}{dt}$ 的方程，根据定义，这正是放大率 $\\lambda(\\theta)$：\n$$\n\\lambda(\\theta) = -a \\frac{\\exp(i\\theta) - \\exp(-i\\theta)}{2\\Delta x} + \\frac{\\alpha}{2\\Delta x} (\\exp(i\\theta) - 2 + \\exp(-i\\theta))\n$$\n使用欧拉恒等式 $\\sin(\\theta) = \\frac{\\exp(i\\theta) - \\exp(-i\\theta)}{2i}$ 和 $\\cos(\\theta) = \\frac{\\exp(i\\theta) + \\exp(-i\\theta)}{2}$，我们可以简化 $\\lambda(\\theta)$ 的表达式。\n第一项变为：\n$$\n-a \\frac{2i\\sin(\\theta)}{2\\Delta x} = -\\frac{ia}{\\Delta x}\\sin(\\theta)\n$$\n第二项包含 $\\exp(i\\theta) - 2 + \\exp(-i\\theta) = 2\\cos(\\theta) - 2 = -2(1-\\cos(\\theta))$。所以第二项是：\n$$\n\\frac{\\alpha}{2\\Delta x} \\left(-2(1-\\cos(\\theta))\\right) = -\\frac{\\alpha}{\\Delta x}(1-\\cos(\\theta))\n$$\n结合这两项，我们得到放大率：\n$$\n\\lambda(\\theta) = -\\frac{\\alpha}{\\Delta x}(1-\\cos(\\theta)) - i\\frac{a}{\\Delta x}\\sin(\\theta)\n$$\n一个模态的阻尼由 $\\lambda(\\theta)$ 的实部 $\\text{Re}(\\lambda(\\theta))$ 控制。一个更负的值意味着更强的阻尼。模态阻尼率可以定义为 $D(\\theta) = -\\text{Re}(\\lambda(\\theta))$。\n从我们得到的 $\\lambda(\\theta)$ 表达式中：\n$$\n\\text{Re}(\\lambda(\\theta)) = -\\frac{\\alpha}{\\Delta x}(1-\\cos(\\theta))\n$$\n因此，阻尼率为：\n$$\nD(\\theta) = \\frac{\\alpha}{\\Delta x}(1-\\cos(\\theta))\n$$\n为了找到阻尼率最大化的位置，我们必须在定义域 $\\theta \\in [-\\pi, \\pi)$ 上找到函数 $f(\\theta) = 1-\\cos(\\theta)$ 的最大值。常数 $\\alpha$ 和 $\\Delta x$ 都是正的。函数 $\\cos(\\theta)$ 的最小值为 $-1$，出现在 $\\theta = \\pm\\pi$ 处。在这些值上，$f(\\theta)$ 达到其最大值：$f(\\pm\\pi) = 1 - (-1) = 2$。\n因此，阻尼率 $D(\\theta)$ 在 $\\theta = \\pm\\pi$ 时最大化。这对应于网格上最高可分辨的波数，代表了网格尺度的振荡（例如，正负交替的模式）。最大阻尼恰好发生在 $\\theta=\\pi$（以及 $\\theta=-\\pi$）处，这与问题陈述中它发生在“$\\theta \\approx \\pi$ 附近”的说法是一致的。\n\n### 第 2 部分：e-折叠涂抹长度 $N_e$ 的推导\n\n一个急剧的跳跃间断由宽谱的傅里叶模组成，包括那些具有最高波数的模。数值格式对间断的涂抹主要是由于这些高波数模的快速阻尼。问题基于最高波数傅里叶模的衰减来定义“e-折叠涂抹长度”$N_e$。\n\n正如在第 1 部分中所确立的，网格上可分辨的最高波数模对应于 $\\theta = \\pi$。该模的振幅 $\\hat{u}_{\\pi}(t)$ 根据常微分方程 $\\frac{d\\hat{u}_{\\pi}}{dt} = \\lambda(\\pi)\\hat{u}_{\\pi}$ 演化。其解为 $\\hat{u}_{\\pi}(t) = \\hat{u}_{\\pi}(0)\\exp(\\lambda(\\pi)t)$。振幅的大小为 $|\\hat{u}_{\\pi}(t)| = |\\hat{u}_{\\pi}(0)|\\exp(\\text{Re}(\\lambda(\\pi))t)$。\n\n我们在 $\\theta = \\pi$ 处计算 $\\lambda(\\theta)$ 的实部：\n$$\n\\text{Re}(\\lambda(\\pi)) = -\\frac{\\alpha}{\\Delta x}(1-\\cos(\\pi)) = -\\frac{\\alpha}{\\Delta x}(1 - (-1)) = -\\frac{2\\alpha}{\\Delta x}\n$$\ne-折叠条件指出振幅下降了 $\\exp(-1)$ 倍。令 $t_e$ 为此衰减所需的时间。\n$$\n\\frac{|\\hat{u}_{\\pi}(t_e)|}{|\\hat{u}_{\\pi}(0)|} = \\exp(\\text{Re}(\\lambda(\\pi))t_e) = \\exp(-1)\n$$\n这意味着 $\\text{Re}(\\lambda(\\pi))t_e = -1$。代入 $\\text{Re}(\\lambda(\\pi))$ 的值：\n$$\n\\left(-\\frac{2\\alpha}{\\Delta x}\\right) t_e = -1 \\implies t_e = \\frac{\\Delta x}{2\\alpha}\n$$\n这是最高波数模的 e-折叠时间。\n\n问题提供了此时间与涂抹长度 $N_e$ 之间的物理联系。假设间断以物理速度 $a$ 平流。时间 $t_e$ 是该特征行进距离 $N_e \\Delta x$ 所需的时间。因此，我们有以下关系：\n$$\nt_e = \\frac{\\text{distance}}{\\text{speed}} = \\frac{N_e \\Delta x}{a}\n$$\n通过将 e-折叠时间 $t_e$ 的两个表达式相等，我们可以解出 $N_e$：\n$$\n\\frac{N_e \\Delta x}{a} = \\frac{\\Delta x}{2\\alpha}\n$$\n我们可以消去两边的 $\\Delta x$ 并重新整理，以找到 $N_e$ 的闭式表达式：\n$$\nN_e = \\frac{a}{2\\alpha}\n$$\n该表达式给出了以网格单元为单位的 e-折叠涂抹长度，用物理平流速度 $a$ 和数值耗散参数 $\\alpha$ 表示。",
            "answer": "$$\\boxed{\\frac{a}{2\\alpha}}$$"
        },
        {
            "introduction": "在通过单步计算和傅里叶分析掌握了Lax-Friedrichs格式的基本行为后，是时候进行一次完整的数值实验了。本练习要求你将理论分析与编程实践相结合，设计并实现一个网格加密研究，以验证该格式的收敛阶 。你将首先通过泰勒展开推导格式的截断误差，预测其理论收敛率，然后编写代码在光滑初值问题上进行模拟，并通过计算一系列不同分辨率网格上的误差来实验性地测量收敛阶。这是数值分析中的一个标准流程，它将抽象的“精度阶”概念与可观测的数值结果紧密联系起来。",
            "id": "3413906",
            "problem": "考虑一维线性平流方程 $u_t + a\\,u_x = 0$，定义在周期域 $x \\in [0,L]$ 上，并具有光滑的周期性初始条件 $u(x,0) = u_0(x)$。使用Lax-Friedrichs中心格式来近似求解。Lax-Friedrichs格式通过将邻近点平均、空间中心差分与时间前向差分相结合，在均匀网格 $x_j = j\\,\\Delta x$ 上以时间步长 $\\Delta t$ 推进网格函数 $u_j^n \\approx u(x_j,t^n)$。通过对网格点数量取模来处理索引，从而施加周期性边界条件。\n\n您的任务是：\n1) 当Courant-Friedrichs-Lewy (CFL) 数 $\\lambda = a\\,\\Delta t/\\Delta x$ 在 $(0,1)$ 区间内保持固定，且当 $\\Delta x \\to 0$ 时有 $\\Delta t \\propto \\Delta x$ 的条件下，利用泰勒展开和局部截断误差的定义，从第一性原理推导Lax-Friedrichs中心格式对此问题的预测收敛率（精度阶）。\n2) 设计并实现一个网格加密研究，该研究在一系列网格 $\\Delta x_k = L/N_k$（其中 $N_{k+1} = 2 N_k$）上计算固定最终时间 $T$ 的解，与精确解 $u(x,T) = u_0(x - a T)$（考虑周期性）进行比较，并测量误差的离散 $L^2$ 范数 $e_k = \\left(\\Delta x_k \\sum_j \\lvert u_j^N - u(x_j,T) \\rvert^2 \\right)^{1/2}$。利用这些误差，通过对 $(\\log \\Delta x_k, \\log e_k)$ 进行直线拟合并取其斜率，计算实验收敛阶。\n3) 陈述您在第1项推导中得到的理论预测收敛率，并使用第2项中的加密研究进行数值验证。\n\n使用以下测试套件。对于每个测试用例，取 $L = 1$，采用周期性边界条件，精确解为 $u(x,T) = u_0(x - a T)$，其中位移对 $L$ 取模。对每个网格，时间步长 $\\Delta t$ 由指定的CFL数确定为 $\\Delta t = \\text{CFL} \\cdot \\Delta x / \\lvert a \\rvert$；如果 $a=0$，则取 $\\Delta t = \\text{CFL} \\cdot \\Delta x$（在这些测试中未使用）。以大小为 $\\Delta t$ 的步长进行时间推进，如果 $T$ 不是 $\\Delta t$ 的整数倍，则使用一个最终的较短步长，以确保总模拟时间恰好为 $T$。对于每个测试用例，使用 $N_k = N_0 \\cdot 2^k$，其中 $k=0,1,2,3$（四个加密级别）。离散 $L^2$ 误差必须在网格节点 $x_j = j\\,\\Delta x$（$j = 0,1,\\dots,N_k-1$）上计算。\n\n测试用例：\n- 用例A：$a = 1$, $T = 0.5$, $\\text{CFL} = 0.9$, $N_0 = 50$, $u_0(x) = \\sin(2\\pi x) + \\tfrac{1}{2}\\sin(4\\pi x)$。\n- 用例B：$a = -2$, $T = 0.25$, $\\text{CFL} = 0.9$, $N_0 = 40$, $u_0(x) = \\cos(2\\pi x)$。\n- 用例C：$a = 0.5$, $T = 1$, $\\text{CFL} = 0.99$, $N_0 = 60$, $u_0(x) = \\sin(2\\pi x) + \\tfrac{1}{4}\\sin(6\\pi x)$。\n\n三角函数中隐式使用的所有角度均为弧度。不涉及物理单位。每个测试用例的数值答案是观测到的实验收敛阶，每个收敛阶表示为一个实数。您的程序应生成单行输出，其中包含三个测试用例的观测收敛阶，格式为方括号内以逗号分隔的列表（例如，$[p_A,p_B,p_C]$）。输出的数字必须是浮点数。\n\n您的实现必须是一个完整、可运行的程序，该程序：\n- 实现上述的带有周期性边界条件的Lax-Friedrichs中心格式。\n- 运行三个测试用例，并为每个用例执行加密研究。\n- 计算离散 $L^2$ 误差，并通过对四个加密级别上的 $\\log e_k$ 与 $\\log \\Delta x_k$ 进行最小二乘线性拟合来获得实验收敛阶。\n- 仅按所述格式打印列表 $[p_A,p_B,p_C]$。",
            "solution": "该问题被评估为有效。它在科学上是合理的、自洽的、适定的，并且直接关系到数值分析中的指定主题。所提供的参数和条件足以确定唯一的解，并且是一致的。\n\n该问题要求一个三部分的回应：Lax-Friedrichs格式收敛率的理论推导、用于测量该速率的数值实验的设计与实现，以及理论与实验结果之间的比较。\n\n### 第1部分：理论收敛阶\n\n一维线性平流方程由下式给出\n$$\nu_t + a\\,u_x = 0\n$$\n其中 $u(x,t)$ 是守恒量，$t$ 是时间，$x$ 是空间坐标，$a$ 是恒定的波速。我们给定一个周期域 $x \\in [0,L]$ 和一个光滑的周期性初始条件 $u(x,0) = u_0(x)$。\n\n对于该方程，在空间步长为 $\\Delta x$、时间步长为 $\\Delta t$ 的均匀网格上，Lax-Friedrichs中心格式由下式给出\n$$\nu_j^{n+1} = \\frac{1}{2}(u_{j+1}^n + u_{j-1}^n) - \\frac{a\\,\\Delta t}{2\\,\\Delta x}(u_{j+1}^n - u_{j-1}^n)\n$$\n其中 $u_j^n$ 是解 $u(x_j, t^n)$ 在网格点 $x_j=j\\,\\Delta x$ 和时间 $t^n=n\\,\\Delta t$ 的数值近似。\n\n为了确定精度阶，我们计算局部截断误差 $\\tau_j^n$。截断误差通过将精确解 $u(x,t)$ 代入有限差分方程并进行适当的归一化来求得。设 $L_{\\Delta t, \\Delta x}$ 为与该格式相关的差分算子：\n$$\nL_{\\Delta t, \\Delta x}(u_j^n) \\equiv \\frac{u_j^{n+1} - \\frac{1}{2}(u_{j+1}^n + u_{j-1}^n)}{\\Delta t} + \\frac{a}{2\\,\\Delta x}(u_{j+1}^n - u_{j-1}^n) = 0\n$$\n局部截断误差 $\\tau_j^n$ 的定义为将此算子应用于点 $(x_j, t^n)$ 处的精确解 $u(x,t)$：\n$$\n\\tau_j^n = L_{\\Delta t, \\Delta x}(u(x_j, t^n))\n$$\n我们使用泰勒级数在点 $(x_j, t^n)$ 附近展开项 $u(x_j, t^{n+1})$、$u(x_{j+1}, t^n)$ 和 $u(x_{j-1}, t^n)$。令 $u$ 及其偏导数 $u_t, u_x, u_{tt}, u_{xx}, \\dots$ 表示它们在 $(x_j, t^n)$ 处的值。\n\n展开式为：\n$$\nu(x_j, t^{n+1}) = u + u_t \\Delta t + \\frac{1}{2} u_{tt} (\\Delta t)^2 + \\frac{1}{6} u_{ttt} (\\Delta t)^3 + O((\\Delta t)^4)\n$$\n$$\nu(x_{j\\pm1}, t^n) = u \\pm u_x \\Delta x + \\frac{1}{2} u_{xx} (\\Delta x)^2 \\pm \\frac{1}{6} u_{xxx} (\\Delta x)^3 + \\frac{1}{24} u_{xxxx} (\\Delta x)^4 + O((\\Delta x)^5)\n$$\n从第二个展开式中，我们推导出格式中空间平均项和差分项的表达式：\n$$\n\\frac{1}{2}(u(x_{j+1}, t^n) + u(x_{j-1}, t^n)) = u + \\frac{1}{2} u_{xx} (\\Delta x)^2 + \\frac{1}{24} u_{xxxx} (\\Delta x)^4 + O((\\Delta x)^6)\n$$\n$$\n\\frac{a}{2\\,\\Delta x}(u(x_{j+1}, t^n) - u(x_{j-1}, t^n)) = \\frac{a}{2\\,\\Delta x}(2u_x \\Delta x + \\frac{1}{3}u_{xxx}(\\Delta x)^3 + O((\\Delta x)^5)) = a\\,u_x + \\frac{a}{6}u_{xxx}(\\Delta x)^2 + O((\\Delta x)^4)\n$$\n现在，我们将这些展开式代入 $\\tau_j^n$ 的表达式中：\n$$\n\\tau_j^n = \\frac{1}{\\Delta t} \\left[ \\left(u + u_t \\Delta t + \\frac{u_{tt}}{2}(\\Delta t)^2 + \\dots\\right) - \\left(u + \\frac{u_{xx}}{2}(\\Delta x)^2 + \\dots\\right) \\right] + \\left(a\\,u_x + \\frac{a u_{xxx}}{6}(\\Delta x)^2 + \\dots\\right)\n$$\n重新整理这些项，我们得到：\n$$\n\\tau_j^n = (u_t + a\\,u_x) + \\frac{u_{tt}}{2}\\Delta t - \\frac{u_{xx}}{2\\Delta t}(\\Delta x)^2 + O((\\Delta t)^2, (\\Delta x)^2)\n$$\n由于 $u(x,t)$ 是偏微分方程的精确解，因此 $(u_t + a\\,u_x)$ 项为零。截断误差的主项是：\n$$\n\\tau_j^n = \\frac{1}{2} u_{tt} \\Delta t - \\frac{1}{2\\Delta t} u_{xx} (\\Delta x)^2 + \\text{H.O.T.}\n$$\n为简化此表达式，我们使用偏微分方程本身来关联时间和空间导数。由于 $u_t = -a\\,u_x$，我们可以对时间求导得到 $u_{tt} = (-a\\,u_x)_t = -a\\,u_{xt} = -a\\,(u_t)_x = -a\\,(-a\\,u_x)_x = a^2 u_{xx}$。将 $u_{tt} = a^2 u_{xx}$ 代入误差表达式：\n$$\n\\tau_j^n = \\frac{1}{2} (a^2 u_{xx}) \\Delta t - \\frac{1}{2\\Delta t} u_{xx} (\\Delta x)^2 + \\text{H.O.T.}\n$$\n$$\n\\tau_j^n = \\frac{u_{xx}}{2\\Delta t} \\left( a^2 (\\Delta t)^2 - (\\Delta x)^2 \\right) + \\text{H.O.T.}\n$$\n令 $\\lambda = a\\,\\Delta t/\\Delta x$ 为问题中定义的Courant数。该表达式变为：\n$$\n\\tau_j^n = \\frac{u_{xx} (\\Delta x)^2}{2\\Delta t} (\\lambda^2 - 1) + \\text{H.O.T.}\n$$\n问题指明，当 $\\Delta x \\to 0$ 时，CFL数 $\\text{CFL} = \\lvert a \\rvert \\Delta t / \\Delta x$ 保持固定。这意味着 $\\Delta t \\propto \\Delta x$。因此，比率 $\\Delta x/\\Delta t$ 是一个常数，局部截断误差的主项是：\n$$\n\\tau_j^n = O(\\Delta x)\n$$\n此外，由于 $\\Delta t \\propto \\Delta x$，误差也是 $O(\\Delta t)$。因此，Lax-Friedrichs格式在空间和时间上都是一阶精度的。根据Lax等价定理，对于一个相容且稳定的格式，全局误差的收敛阶与局部截断误差的阶数相同。由于CFL条件 $\\lvert a \\rvert \\Delta t / \\Delta x  1$ 保证了稳定性，该格式将会收敛。\n\n因此，理论上预测的收敛率为 $p=1$。\n\n### 第2部分：网格加密研究\n\n为了实验性地验证理论收敛阶，我们进行了一项网格加密研究。方法如下：\n1.  对每个测试用例，我们在一系列四个网格上求解问题。网格点数为 $N_k = N_0 \\cdot 2^k$，其中 $k=0, 1, 2, 3$。相应的网格间距为 $\\Delta x_k = L/N_k$。\n2.  每个网格的时间步长 $\\Delta t_k$ 通过固定CFL数来确定，即 $\\Delta t_k = \\text{CFL} \\cdot \\Delta x_k / \\lvert a \\rvert$。\n3.  计算数值解 $u_j^N$ 直至最终时间 $T$。如果 $T$ 不是 $\\Delta t_k$ 的整数倍，则使用一个最终的、更小的时间步长，以确保总模拟时间恰好为 $T$。\n4.  通过将数值解与已知的精确解 $u(x,T) = u_0(x - aT \\pmod L)$ 进行比较，使用离散 $L^2$ 范数来测量误差：\n    $$\n    e_k = \\left( \\Delta x_k \\sum_{j=0}^{N_k-1} | u_j^N(T) - u(x_j, T) |^2 \\right)^{1/2}\n    $$\n5.  如果方法的收敛率为 $p$，则误差预计会按 $e_k \\approx C(\\Delta x_k)^p$ 的规律缩放，其中 $C$ 是某个常数。对该关系式取对数，得到：\n    $$\n    \\log e_k \\approx \\log C + p \\log \\Delta x_k\n    $$\n    这是 $\\log e_k$ 和 $\\log \\Delta x_k$ 之间的线性关系。这条线的斜率就是收敛阶 $p$。\n6.  通过对点集 $\\{(\\log \\Delta x_k, \\log e_k)\\}_{k=0}^3$ 进行最小二乘线性回归，并找出最佳拟合线的斜率，来计算实验收敛阶。\n\n### 第3部分：数值验证\n\n所实现的程序遵循第2部分中描述的设计。它将Lax-Friedrichs格式应用于三个测试用例中的每一个，执行网格加密研究，并计算实验收敛阶。根据第1部分的推导，每个测试用例的实验收敛阶预计约为 $1.0$。程序的最终输出将列出这些计算出的阶数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import linregress\n\ndef lax_friedrichs_step(u, a, dt, dx):\n    \"\"\"\n    Applies one step of the Lax-Friedrichs scheme for u_t + a * u_x = 0.\n    \n    Args:\n        u (np.ndarray): The current solution vector.\n        a (float): The advection speed.\n        dt (float): The time step.\n        dx (float): The spatial step.\n\n    Returns:\n        np.ndarray: The solution vector at the next time step.\n    \"\"\"\n    # Periodic boundary conditions are handled by np.roll\n    u_p1 = np.roll(u, -1)  # u_{j+1}\n    u_m1 = np.roll(u, 1)   # u_{j-1}\n\n    # Lax-Friedrichs update formula\n    u_new = 0.5 * (u_p1 + u_m1) - (a * dt / (2.0 * dx)) * (u_p1 - u_m1)\n    \n    return u_new\n\ndef run_simulation(N, L, a, T, CFL, u0_func):\n    \"\"\"\n    Runs a full simulation for a given grid and parameters.\n    \n    Args:\n        N (int): Number of grid points.\n        L (float): Length of the domain.\n        a (float): Advection speed.\n        T (float): Final time.\n        CFL (float): The CFL number to maintain.\n        u0_func (callable): Function for the initial condition u_0(x).\n\n    Returns:\n        tuple[float, float]: A tuple containing the spatial step dx and the L2 error.\n    \"\"\"\n    dx = L / N\n    x = np.linspace(0, L, N, endpoint=False) # Grid points x_j = j*dx\n    \n    if np.abs(a) > 1e-15:\n        dt = CFL * dx / np.abs(a)\n    else: # Should not happen based on test cases\n        dt = CFL * dx\n\n    u = u0_func(x)\n    \n    current_time = 0.0\n    \n    # Time stepping loop\n    num_steps = int(T / dt)\n    for _ in range(num_steps):\n        u = lax_friedrichs_step(u, a, dt, dx)\n        current_time += dt\n\n    # Final smaller step to reach T exactly\n    final_dt = T - current_time\n    if final_dt > 1e-12:  # Use a small tolerance\n        u = lax_friedrichs_step(u, a, final_dt, dx)\n\n    # Calculate the exact solution at time T\n    # The modulo operator '%' in Python handles periodicity correctly for x in [0,L)\n    u_exact = u0_func((x - a * T) % L)\n    \n    # Compute the discrete L2 error\n    error = np.sqrt(dx * np.sum((u - u_exact)**2))\n    \n    return dx, error\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print the results.\n    \"\"\"\n    test_cases = [\n        # Case A: a=1, T=0.5, CFL=0.9, N0=50, u0=sin(2*pi*x) + 0.5*sin(4*pi*x)\n        {\n            'a': 1.0, 'T': 0.5, 'CFL': 0.9, 'N0': 50, 'L': 1.0,\n            'u0': lambda x: np.sin(2.0 * np.pi * x) + 0.5 * np.sin(4.0 * np.pi * x)\n        },\n        # Case B: a=-2, T=0.25, CFL=0.9, N0=40, u0=cos(2*pi*x)\n        {\n            'a': -2.0, 'T': 0.25, 'CFL': 0.9, 'N0': 40, 'L': 1.0,\n            'u0': lambda x: np.cos(2.0 * np.pi * x)\n        },\n        # Case C: a=0.5, T=1, CFL=0.99, N0=60, u0=sin(2*pi*x) + 0.25*sin(6*pi*x)\n        {\n            'a': 0.5, 'T': 1.0, 'CFL': 0.99, 'N0': 60, 'L': 1.0,\n            'u0': lambda x: np.sin(2.0 * np.pi * x) + 0.25 * np.sin(6.0 * np.pi * x)\n        }\n    ]\n\n    experimental_orders = []\n\n    for case in test_cases:\n        log_dxs = []\n        log_errors = []\n        \n        # Grid refinement loop (4 levels)\n        for k in range(4):\n            N = case['N0'] * (2**k)\n            dx, error = run_simulation(\n                N, case['L'], case['a'], case['T'], case['CFL'], case['u0']\n            )\n            if error > 1e-15: # Avoid log(0)\n                log_dxs.append(np.log(dx))\n                log_errors.append(np.log(error))\n        \n        # Perform linear regression to find the slope (order of convergence)\n        slope, _, _, _, _ = linregress(log_dxs, log_errors)\n        experimental_orders.append(slope)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, experimental_orders))}]\")\n\nsolve()\n```"
        }
    ]
}