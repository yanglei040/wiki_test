{
    "hands_on_practices": [
        {
            "introduction": "Crank-Nicolson方法因其在$L_2$范数下的无条件稳定性而备受青睐。然而，它有一个微妙但重要的缺陷：它不总是能保持解的正性。这个练习通过一个简单的例子揭示了这一特性，这对于解必须保持非负的物理问题（如浓度或概率密度）至关重要 。通过计算正性被破坏的临界时间步长，你将具体理解这一限制，并认识到无条件稳定性并不意味着该方法具备所有理想的定性属性。",
            "id": "3360619",
            "problem": "考虑半离散形式的线性抛物线初值问题 $u^{\\prime}(t)=-A\\,u(t)$，其中 $A\\in\\mathbb{R}^{2\\times 2}$ 是矩阵\n$$\nA=\\begin{pmatrix}\n2  -1\\\\\n-1  2\n\\end{pmatrix}.\n$$\n假设使用步长为 $\\Delta t>0$ 的 Crank-Nicolson 方法（CN方法）进行单步时间推进，将解从 $u^{n}$ 推进到 $u^{n+1}$。正性的概念是按分量定义的：如果向量 $v\\in\\mathbb{R}^{2}$ 的每个分量都满足 $v_{i}\\ge 0$，则该向量为正。\n\n矩阵 $A$ 的非对角元素为非正值，且其逆矩阵为正，因此 $A$ 是标准意义上的非奇异 $M$-矩阵。由 $-A$ 生成的连续半群保持正性。然而，对于某些 $\\Delta t$ 的选择，Crank-Nicolson 方法可能无法保持正性。\n\n从线性系统的 Crank-Nicolson 方法的基本定义和 $M$-矩阵的定义出发，完成以下任务：\n- 对于系统 $u^{\\prime}=-A u$，推导在 Crank-Nicolson 方法下将 $u^{n}$ 映射到 $u^{n+1}$ 的单步线性更新算子。\n- 使用正的初始向量 $u^{n}=e_{1}=(1,0)^{\\top}$，确定使得 $u^{n+1}$ 的第一个分量严格为负的最小正时间步长 $\\Delta t$。\n\n您的最终答案必须是这个最小 $\\Delta t$ 的单个精确表达式。不要四舍五入。",
            "solution": "问题要求找到最小的正时间步长 $\\Delta t$，使得应用于系统 $u^{\\prime}(t) = -A u(t)$ 的 Crank-Nicolson (CN) 方法不再保持正性。具体来说，我们需要从一个正的初始向量 $u^n = e_1$ 出发，找到使解的第一个分量变为负值的临界 $\\Delta t$。\n\n首先，我们推导 Crank-Nicolson 方法的单步线性更新算子。该方法在时间区间 $[t_n, t_{n+1}]$（其中 $t_{n+1} = t_n + \\Delta t$）上对微分方程 $u' = -A u$ 进行如下近似：\n$$ \\frac{u^{n+1} - u^{n}}{\\Delta t} = \\frac{1}{2} \\left( (-A u^{n+1}) + (-A u^{n}) \\right) $$\n其中 $u^n$ 和 $u^{n+1}$ 分别是解在时间 $t_n$ 和 $t_{n+1}$ 的数值近似。\n\n为了找到将 $u^n$ 映射到 $u^{n+1}$ 的更新算子，我们必须求解 $u^{n+1}$：\n$$ u^{n+1} - u^{n} = -\\frac{\\Delta t}{2} A u^{n+1} - \\frac{\\Delta t}{2} A u^{n} $$\n重新整理各项，将含 $u^{n+1}$ 的项移到左边，含 $u^{n}$ 的项移到右边，得到：\n$$ u^{n+1} + \\frac{\\Delta t}{2} A u^{n+1} = u^{n} - \\frac{\\Delta t}{2} A u^{n} $$\n将向量 $u^{n+1}$ 和 $u^{n}$ 因子分解出来：\n$$ \\left(I + \\frac{\\Delta t}{2} A\\right) u^{n+1} = \\left(I - \\frac{\\Delta t}{2} A\\right) u^{n} $$\n其中 $I$ 是 $2 \\times 2$ 的单位矩阵。\n\n求解 $u^{n+1}$，我们得到：\n$$ u^{n+1} = \\left(I + \\frac{\\Delta t}{2} A\\right)^{-1} \\left(I - \\frac{\\Delta t}{2} A\\right) u^{n} $$\n这就定义了单步线性更新算子，或称放大矩阵 $G$：\n$$ G = \\left(I + \\frac{\\Delta t}{2} A\\right)^{-1} \\left(I - \\frac{\\Delta t}{2} A\\right) $$\n\n现在，我们为给定的矩阵 $A = \\begin{pmatrix} 2  -1 \\\\ -1  2 \\end{pmatrix}$ 显式地计算这个算子。我们通过设 $k = \\frac{\\Delta t}{2}$ 来简化符号。由于 $\\Delta t > 0$，我们有 $k > 0$。$G$ 的表达式变为：\n$$ G = (I + kA)^{-1} (I - kA) $$\n首先，我们计算这个表达式中的两个矩阵：\n$$ I+kA = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} + k \\begin{pmatrix} 2  -1 \\\\ -1  2 \\end{pmatrix} = \\begin{pmatrix} 1+2k  -k \\\\ -k  1+2k \\end{pmatrix} $$\n$$ I-kA = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} - k \\begin{pmatrix} 2  -1 \\\\ -1  2 \\end{pmatrix} = \\begin{pmatrix} 1-2k  k \\\\ k  1-2k \\end{pmatrix} $$\n接下来，我们求 $(I+kA)$ 的逆矩阵。其行列式为：\n$$ \\det(I+kA) = (1+2k)(1+2k) - (-k)(-k) = (1+2k)^2 - k^2 = 1+4k+4k^2 - k^2 = 1+4k+3k^2 $$\n对行列式进行因式分解，我们得到 $\\det(I+kA) = (1+k)(1+3k)$。由于 $k > 0$，行列式不为零，因此逆矩阵存在。\n逆矩阵由下式给出：\n$$ (I+kA)^{-1} = \\frac{1}{(1+k)(1+3k)} \\begin{pmatrix} 1+2k  k \\\\ k  1+2k \\end{pmatrix} $$\n现在我们可以计算算子 $G$：\n$$ G = \\frac{1}{(1+k)(1+3k)} \\begin{pmatrix} 1+2k  k \\\\ k  1+2k \\end{pmatrix} \\begin{pmatrix} 1-2k  k \\\\ k  1-2k \\end{pmatrix} $$\n执行矩阵乘法：\n$$ G = \\frac{1}{(1+k)(1+3k)} \\begin{pmatrix} (1+2k)(1-2k)+k^2  (1+2k)k+k(1-2k) \\\\ k(1-2k)+(1+2k)k  k^2+(1+2k)(1-2k) \\end{pmatrix} $$\n$$ G = \\frac{1}{(1+k)(1+3k)} \\begin{pmatrix} 1-4k^2+k^2  k+2k^2+k-2k^2 \\\\ k-2k^2+k+2k^2  k^2+1-4k^2 \\end{pmatrix} $$\n$$ G = \\frac{1}{(1+k)(1+3k)} \\begin{pmatrix} 1-3k^2  2k \\\\ 2k  1-3k^2 \\end{pmatrix} $$\n这就是更新算子的显式形式。\n\n问题要求在给定初始向量 $u^n = e_1 = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$ 的情况下，找到使 $u^{n+1}$ 的第一个分量严格为负的最小 $\\Delta t > 0$。我们计算 $u^{n+1}$：\n$$ u^{n+1} = G u^n = \\frac{1}{(1+k)(1+3k)} \\begin{pmatrix} 1-3k^2  2k \\\\ 2k  1-3k^2 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} $$\n$$ u^{n+1} = \\frac{1}{(1+k)(1+3k)} \\begin{pmatrix} 1-3k^2 \\\\ 2k \\end{pmatrix} $$\n所以 $u^{n+1}$ 的分量是：\n$$ (u^{n+1})_1 = \\frac{1-3k^2}{(1+k)(1+3k)} \\quad \\text{和} \\quad (u^{n+1})_2 = \\frac{2k}{(1+k)(1+3k)} $$\n我们想找到使 $(u^{n+1})_1  0$ 成立的关于 $\\Delta t$ 的条件。\n$$ \\frac{1-3k^2}{(1+k)(1+3k)}  0 $$\n由于 $k = \\Delta t/2 > 0$，分母 $(1+k)(1+3k)$ 总是正的。因此，该不等式成立当且仅当分子为负：\n$$ 1-3k^2  0 $$\n$$ 1  3k^2 $$\n$$ k^2 > \\frac{1}{3} $$\n由于 $k>0$，我们对两边取正平方根：\n$$ k > \\frac{1}{\\sqrt{3}} $$\n现在，我们代回 $k = \\frac{\\Delta t}{2}$：\n$$ \\frac{\\Delta t}{2} > \\frac{1}{\\sqrt{3}} $$\n$$ \\Delta t > \\frac{2}{\\sqrt{3}} $$\n$u^{n+1}$ 的第一个分量在开区间 $(\\frac{2}{\\sqrt{3}}, \\infty)$ 内的任何时间步长 $\\Delta t$ 下都是严格为负的。问题要求的是满足此条件的“最小正时间步长”。这对应于这组值的下确界。在边界值 $\\Delta t = \\frac{2}{\\sqrt{3}}$ 处，第一个分量 $(u^{n+1})_1$ 为零。对于任何比这个值大无穷小量的 $\\Delta t$，该分量都会变为负值。因此，标志着保持正性与违反正性之间界限的临界值就是这个下确界。\n\n失去正性性质的最小正时间步长 $\\Delta t$ 是 $\\frac{2}{\\sqrt{3}}$。这也可以写成分母有理化的形式 $\\frac{2\\sqrt{3}}{3}$。",
            "answer": "$$\\boxed{\\frac{2}{\\sqrt{3}}}$$"
        },
        {
            "introduction": "在数值分析中，我们通常致力于减小误差，但有时可以更进一步，通过巧妙的设计让不同来源的误差项相互抵消。这个练习将引导你探索一种被称为“超收敛”的现象，通过精确地平衡时间和空间离散误差，为特定傅里叶模式实现远超预期的精度 。此实践展示了修正波数分析和详细误差展开的力量，挑战你将离散误差视为可操控的结构项，而不仅仅是需要最小化的对象，从而提供对数值格式设计的更深洞察。",
            "id": "3360618",
            "problem": "考虑一维热方程 $u_{t} = \\nu u_{xx}$，定义在周期性区域 $x \\in [0,L]$上，其中 $\\nu  0$ 是热扩散率。令 $x_{j} = j h$（其中 $j = 0,1,\\dots,M-1$，$h = L/M$）以及 $t_{n} = n \\Delta t$。使用时间上的 Crank-Nicolson (CN) 方法和空间上对 $u_{xx}$ 的标准中心二阶差分近似来离散化 $u_{t} = \\nu u_{xx}$：\n$$\n\\frac{u_{j}^{n+1} - u_{j}^{n}}{\\Delta t} = \\frac{\\nu}{2} \\left( \\frac{u_{j+1}^{n} - 2 u_{j}^{n} + u_{j-1}^{n}}{h^{2}} + \\frac{u_{j+1}^{n+1} - 2 u_{j}^{n+1} + u_{j-1}^{n+1}}{h^{2}} \\right).\n$$\n假设初始条件为单个傅里叶模态 $u(x,0) = \\exp(\\mathrm{i} k_{0} x)$，其波数为 $k_{0} = \\frac{2\\pi m_{0}}{L}$，其中 $m_{0} \\neq 0$ 是一个固定的整数。对于此模态，单个时间步长内的精确连续时间放大为 $\\exp(-\\nu k_{0}^{2} \\Delta t)$。应用于此模态的全离散 CN 格式的放大因子可以用离散拉普拉斯算子的特征值来表示，该特征值依赖于 $h$。\n\n从基本原理出发——线性常系数偏微分方程的傅里叶模态分析、中心二阶差分的修正波数以及 CN 方法的 Padé 近似解释——推导单个时间步长内放大因子对数的主阶组合误差，并设计网格与时间步长的比率，使得对于特定模态 $k_{0}$，主阶空间离散误差与主阶 CN 时间积分误差相消（该模态的超收敛）。明确地，确定无量纲比率 $\\Delta t / h$ 关于 $\\nu$ 和 $k_{0}$ 的唯一闭式表达式，该表达式能实现主阶误差相消。\n\n请将您的最终答案表示为 $\\Delta t / h$ 的单个闭式解析表达式。无需四舍五入，最终表达式中不应包含任何单位。",
            "solution": "问题要求我们找到时间步长 $\\Delta t$ 与空间步长 $h$ 的一个特定比率，使得在使用 Crank-Nicolson (CN) 数值方法求解热方程时，对于单个傅里叶模态解，主阶空间离散误差与主阶时间离散误差相互抵消。\n\n一维热方程由下式给出：\n$$\nu_{t} = \\nu u_{xx}\n$$\n所提供的 Crank-Nicolson 离散格式为：\n$$\n\\frac{u_{j}^{n+1} - u_{j}^{n}}{\\Delta t} = \\frac{\\nu}{2} \\left( \\frac{u_{j+1}^{n} - 2 u_{j}^{n} + u_{j-1}^{n}}{h^{2}} + \\frac{u_{j+1}^{n+1} - 2 u_{j}^{n+1} + u_{j-1}^{n+1}}{h^{2}} \\right)\n$$\n我们分析该格式在单个傅里叶模态 $u(x,t) = \\exp(-\\nu k_{0}^{2} t) \\exp(\\mathrm{i} k_{0} x)$ 上的行为。其空间部分为 $\\exp(\\mathrm{i} k_{0} x)$。其离散对应形式为 $u_{j}^{n} = (G_{num})^{n} \\exp(\\mathrm{i} k_{0} x_{j}) = (G_{num})^{n} \\exp(\\mathrm{i} k_{0} j h)$，其中 $G_{num}$ 是每个时间步长 $\\Delta t$ 的数值放大因子。\n\n我们将这种形式的解代入 CN 格式。\n空间上的有限差分算子 $\\delta_x^2$ 对空间部分的作用如下：\n$$\n\\delta_x^2 u_{j} = u_{j+1} - 2u_{j} + u_{j-1} = \\exp(\\mathrm{i} k_{0} (j+1) h) - 2\\exp(\\mathrm{i} k_{0} j h) + \\exp(\\mathrm{i} k_{0} (j-1) h)\n$$\n$$\n= \\exp(\\mathrm{i} k_{0} j h) \\left( \\exp(\\mathrm{i} k_{0} h) - 2 + \\exp(-\\mathrm{i} k_{0} h) \\right)\n$$\n$$\n= \\exp(\\mathrm{i} k_{0} j h) \\left( 2\\cos(k_{0}h) - 2 \\right) = -4\\sin^{2}\\left(\\frac{k_{0}h}{2}\\right) \\exp(\\mathrm{i} k_{0} j h)\n$$\n因此，离散拉普拉斯算子 $\\frac{\\delta_x^2}{h^2}$ 对该模态的作用是乘以特征值 $\\lambda_{h}(k_{0})$：\n$$\n\\lambda_{h}(k_{0}) = -\\frac{4}{h^{2}}\\sin^{2}\\left(\\frac{k_{0}h}{2}\\right)\n$$\n将 $u_{j}^{n} = (G_{num})^{n} \\exp(\\mathrm{i} k_{0} j h)$ 代入 CN 格式方程，得到：\n$$\n\\frac{(G_{num})^{n+1} - (G_{num})^{n}}{\\Delta t} \\exp(\\mathrm{i} k_{0} j h) = \\frac{\\nu}{2} \\left( (G_{num})^{n} \\lambda_{h}(k_{0}) \\exp(\\mathrm{i} k_{0} j h) + (G_{num})^{n+1} \\lambda_{h}(k_{0}) \\exp(\\mathrm{i} k_{0} j h) \\right)\n$$\n两边同除以 $(G_{num})^{n} \\exp(\\mathrm{i} k_{0} j h)$（假设其不为零），我们得到一个关于 $G_{num}$ 的方程：\n$$\n\\frac{G_{num} - 1}{\\Delta t} = \\frac{\\nu}{2} \\lambda_{h}(k_{0}) (1 + G_{num})\n$$\n求解 $G_{num}$：\n$$\nG_{num} - 1 = \\frac{\\nu \\Delta t \\lambda_{h}(k_{0})}{2} (1 + G_{num})\n$$\n$$\nG_{num}\\left(1 - \\frac{\\nu \\Delta t \\lambda_{h}(k_{0})}{2}\\right) = 1 + \\frac{\\nu \\Delta t \\lambda_{h}(k_{0})}{2}\n$$\n$$\nG_{num} = \\frac{1 + \\frac{1}{2} \\nu \\Delta t \\lambda_{h}(k_{0})}{1 - \\frac{1}{2} \\nu \\Delta t \\lambda_{h}(k_{0})}\n$$\n令 $z_{h} = \\nu \\Delta t \\lambda_{h}(k_{0})$。数值放大因子为 $G_{num} = \\frac{1+z_{h}/2}{1-z_{h}/2}$。这是对 $\\exp(z_h)$ 的 $(1,1)$-Padé 近似。\n\n该问题关注的是放大因子对数的误差。对于连续偏微分方程，一个时间步长 $\\Delta t$ 内的精确放大因子为 $G_{exact} = \\exp(-\\nu k_{0}^{2} \\Delta t)$。精确放大指数为 $\\log(G_{exact}) = -\\nu k_{0}^{2} \\Delta t$。数值放大指数为 $\\log(G_{num})$。误差为 $E = \\log(G_{num}) - \\log(G_{exact})$。\n\n为了找到主阶误差，我们将 $\\log(G_{num})$ 按小参数 $h$ 和 $\\Delta t$ 展开。\n首先，我们使用 $\\sin(x) = x - x^3/6 + \\mathcal{O}(x^5)$ 的泰勒级数，对小 $h$ 展开离散特征值 $\\lambda_{h}(k_{0})$：\n$$\n\\lambda_{h}(k_{0}) = -\\frac{4}{h^{2}}\\left( \\frac{k_{0}h}{2} - \\frac{1}{6}\\left(\\frac{k_{0}h}{2}\\right)^{3} + \\mathcal{O}(h^5) \\right)^{2}\n$$\n$$\n= -\\frac{4}{h^{2}}\\left( \\frac{k_{0}^{2}h^{2}}{4} - 2\\frac{k_{0}h}{2}\\frac{k_{0}^{3}h^{3}}{48} + \\mathcal{O}(h^6) \\right)\n$$\n$$\n= -\\frac{4}{h^{2}}\\left( \\frac{k_{0}^{2}h^{2}}{4} - \\frac{k_{0}^{4}h^{4}}{48} + \\mathcal{O}(h^6) \\right) = -k_{0}^{2} + \\frac{k_{0}^{4}h^{2}}{12} + \\mathcal{O}(h^4)\n$$\n项 $-k_{0}^{2}$ 对应于精确的微分算子 $\\frac{\\partial^2}{\\partial x^2}$，而 $\\frac{k_{0}^{4}h^{2}}{12}$ 是特征值的主阶空间离散误差项。\n\n接下来，我们对小的 $z_{h}$ 展开 $\\log(G_{num})=\\log\\left(\\frac{1+z_{h}/2}{1-z_{h}/2}\\right)$。使用 $\\log(1+x) = x - x^2/2 + x^3/3 - \\dots$：\n$$\n\\log(G_{num}) = \\log(1+z_{h}/2) - \\log(1-z_{h}/2)\n$$\n$$\n= \\left(\\frac{z_{h}}{2} - \\frac{1}{2}\\left(\\frac{z_{h}}{2}\\right)^{2} + \\frac{1}{3}\\left(\\frac{z_{h}}{2}\\right)^{3} - \\dots\\right) - \\left(-\\frac{z_{h}}{2} - \\frac{1}{2}\\left(-\\frac{z_{h}}{2}\\right)^{2} - \\frac{1}{3}\\left(-\\frac{z_{h}}{2}\\right)^{3} - \\dots\\right)\n$$\n$$\n= \\left(\\frac{z_{h}}{2} - \\frac{z_{h}^{2}}{8} + \\frac{z_{h}^{3}}{24} - \\dots\\right) - \\left(-\\frac{z_{h}}{2} - \\frac{z_{h}^{2}}{8} - \\frac{z_{h}^{3}}{24} - \\dots\\right)\n$$\n$$\n\\log(G_{num}) = z_{h} + \\frac{z_{h}^{3}}{12} + \\mathcal{O}(z_{h}^{5})\n$$\n如果数值方法能完美地再现 $\\exp(z_h)$，那么项 $z_{h}$ 将是精确的，但 $\\frac{z_h^3}{12}$ 是 CN 方法在放大因子对数中的主阶时间误差。\n\n现在，我们结合这些展开式。我们将 $\\lambda_h(k_0)$ 的展开式代入 $z_{h}$：\n$$\nz_{h} = \\nu \\Delta t \\lambda_{h}(k_{0}) = \\nu \\Delta t \\left(-k_{0}^{2} + \\frac{k_{0}^{4}h^{2}}{12} + \\mathcal{O}(h^4)\\right)\n$$\n$$\n= -\\nu k_{0}^{2} \\Delta t + \\frac{\\nu k_{0}^{4} h^{2} \\Delta t}{12} + \\mathcal{O}(h^4 \\Delta t)\n$$\n现在我们将此代入 $\\log(G_{num})$ 的展开式。我们只需要保留主阶项。$z_h$ 的最低阶是 $\\mathcal{O}(\\Delta t)$。所以 $z_h^3$ 是 $\\mathcal{O}(\\Delta t^3)$。\n$$\n\\log(G_{num}) = \\left(-\\nu k_{0}^{2} \\Delta t + \\frac{\\nu k_{0}^{4} h^{2} \\Delta t}{12}\\right) + \\frac{1}{12}\\left(-\\nu k_{0}^{2} \\Delta t\\right)^{3} + \\text{H.O.T.}\n$$\n$$\n\\log(G_{num}) = -\\nu k_{0}^{2} \\Delta t + \\frac{\\nu k_{0}^{4} h^{2} \\Delta t}{12} - \\frac{\\nu^{3}k_{0}^{6}\\Delta t^{3}}{12} + \\text{H.O.T.}\n$$\n放大指数的总误差为 $E = \\log(G_{num}) - \\log(G_{exact})$：\n$$\nE = \\left(-\\nu k_{0}^{2} \\Delta t + \\frac{\\nu k_{0}^{4} h^{2} \\Delta t}{12} - \\frac{\\nu^{3}k_{0}^{6}\\Delta t^{3}}{12}\\right) - (-\\nu k_{0}^{2} \\Delta t) + \\text{H.O.T.}\n$$\n$$\nE = \\underbrace{\\frac{\\nu k_{0}^{4} h^{2} \\Delta t}{12}}_{\\text{空间误差}} - \\underbrace{\\frac{\\nu^{3}k_{0}^{6}\\Delta t^{3}}{12}}_{\\text{时间误差}} + \\text{H.O.T.}\n$$\n第一项源于空间离散误差（$\\mathcal{O}(h^2)$），第二项源于 CN 方法的时间离散误差（在格式中为 $\\mathcal{O}(\\Delta t^2)$，在放大指数中表现为 $\\mathcal{O}(\\Delta t^3)$）。\n\n为了实现对模态 $k_{0}$ 主阶误差的抵消，我们必须将这两项之和设为零：\n$$\n\\frac{\\nu k_{0}^{4} h^{2} \\Delta t}{12} - \\frac{\\nu^{3}k_{0}^{6}\\Delta t^{3}}{12} = 0\n$$\n假设 $\\nu, k_{0}, \\Delta t \\neq 0$，我们可以除以公因数：\n$$\n\\nu k_{0}^{4} h^{2} \\Delta t = \\nu^{3} k_{0}^{6} \\Delta t^{3}\n$$\n$$\nh^{2} = \\nu^{2} k_{0}^{2} \\Delta t^{2}\n$$\n对两边取平方根（因为 $h, \\nu, k_0, \\Delta t$ 均为正数）：\n$$\nh = \\nu k_{0} \\Delta t\n$$\n问题要求的是比率 $\\Delta t / h$。重新整理方程可得：\n$$\n\\frac{\\Delta t}{h} = \\frac{1}{\\nu k_{0}}\n$$\n这就是那个唯一的无量纲比率，它使得特定傅里叶模态的主阶空间误差和时间误差相互抵消，从而导致该模态的超收敛。",
            "answer": "$$\n\\boxed{\\frac{1}{\\nu k_{0}}}\n$$"
        },
        {
            "introduction": "将分析从一维推广到多维通常会引入新的复杂性，Crank-Nicolson方法也不例外。本练习将二维热方程作为研究对象，探讨在各向异性网格（即$h_x \\neq h_y$）上，数值解的衰减率如何依赖于波矢量的方向 。通过推导二维放大因子并量化由网格各向异性引起的误差，你将学会分析多维问题中更微妙的数值效应。这对于在复杂几何形状或自适应网格上进行模拟至关重要，因为在这些情况下，网格单元很少是完全各向同性的。",
            "id": "3360636",
            "problem": "考虑在周期性域 $[0,L_{x}]\\times[0,L_{y}]$ 上的二维热方程 $u_{t}=\\nu\\,(u_{xx}+u_{yy})$，其中运动粘度 $\\nu0$。设该域通过一个矩形、均匀、周期性的网格进行离散化，在 $x$ 和 $y$ 方向上分别有 $M_{x}$ 和 $M_{y}$ 个点，间距分别为 $h_{x}=L_{x}/M_{x}$ 和 $h_{y}=L_{y}/M_{y}$。将网格点上的值记为 $u_{j,k}^{n}\\approx u(j\\,h_{x},k\\,h_{y},n\\,\\Delta t)$，其中 $\\Delta t0$ 是时间步长。空间算子是标准的二阶中心差分五点拉普拉斯算子。时间推进采用 Crank–Nicolson (CN) 方法（时间上的梯形法则），该方法应用于通过空间离散化获得的半离散系统。\n\n使用离散傅里叶分析（也称为 von Neumann 分析），其离散傅里叶变换 (DFT) 基为 $\\phi_{j,k}(\\theta_{x},\\theta_{y})=\\exp\\!\\big(i(j\\,\\theta_{x}+k\\,\\theta_{y})\\big)$，其中相角 $\\theta_{x}\\in[-\\pi,\\pi)$ 和 $\\theta_{y}\\in[-\\pi,\\pi)$ 是与网格相关的离散傅里叶波数，完成以下任务：\n\n1. 从 CN 方法作为应用于半离散系统 $u_{t}=\\nu\\,L_{h}u$ 的梯形法则的定义出发，其中 $L_{h}$ 是五点拉普拉斯算子，推导在 $h_{x}\\neq h_{y}$ 的矩形网格上，单个 DFT 模态 $\\phi_{j,k}(\\theta_{x},\\theta_{y})$ 的精确 CN 放大因子 $G(\\theta_{x},\\theta_{y})$。\n\n2. 为量化矩形网格上的各向异性，将单个时间步长内的离散衰减与光滑傅里叶模态的连续衰减进行比较。该傅里叶模态具有物理波数分量 $(k_{x},k_{y})$，满足 $\\theta_{x}=k_{x}h_{x}$ 和 $\\theta_{y}=k_{y}h_{y}$，并定义 $k=\\sqrt{k_{x}^{2}+k_{y}^{2}}$ 以及方向角 $\\psi\\in[0,2\\pi)$，由 $k_{x}=k\\cos\\psi$ 和 $k_{y}=k\\sin\\psi$ 给出。设单个时间步长内的参考连续振幅变化为 $\\exp\\!\\big(-\\nu\\,\\Delta t\\,(k_{x}^{2}+k_{y}^{2})\\big)$，离散振幅变化为 $|G(\\theta_{x},\\theta_{y})|$。对于小波数范围，即 $k\\,h_{x}\\ll 1$ 和 $k\\,h_{y}\\ll 1$，推导每个时间步长衰减率的相对误差的主阶角度依赖性。该相对误差定义为\n$$\nE(\\psi)=\\frac{\\ln|G(\\theta_{x},\\theta_{y})|+\\nu\\,\\Delta t\\,(k_{x}^{2}+k_{y}^{2})}{\\nu\\,\\Delta t\\,(k_{x}^{2}+k_{y}^{2})},\n$$\n并将其表示为关于 $k$、$\\psi$、$h_{x}$ 和 $h_{y}$ 的显式闭式表达式。\n\n请以两个解析表达式的形式提供您的最终答案：精确放大因子 $G(\\theta_{x},\\theta_{y})$ 和如上定义的主阶 $E(\\psi)$。无需进行数值计算；不要四舍五入。最终答案必须不带单位。",
            "solution": "问题陈述已经过验证，被认为是自洽的、有科学依据且适定的。它构成了偏微分方程数值分析中一个标准的、非平凡的练习。推导过程按要求分两部分进行。\n\n第 1 部分：放大因子 $G(\\theta_x, \\theta_y)$ 的推导\n\n二维热方程为 $u_{t}=\\nu\\,(u_{xx}+u_{yy})$。空间导数在间距为 $h_x$ 和 $h_y$ 的网格上使用标准的二阶中心差分五点拉普拉斯算子 $L_h$ 进行离散化。该算子对网格函数 $u_{j,k}$ 的作用是：\n$$\nL_{h}u_{j,k} = \\frac{u_{j+1,k} - 2u_{j,k} + u_{j-1,k}}{h_{x}^{2}} + \\frac{u_{j,k+1} - 2u_{j,k} + u_{j,k-1}}{h_{y}^{2}}\n$$\n这导出了常微分方程的半离散系统 $\\frac{d u}{d t} = \\nu L_h u$。时间积分使用 Crank-Nicolson 方法进行，这是一种对应于梯形法则的隐式方法。对于时间步长 $\\Delta t$，该格式为：\n$$\n\\frac{u^{n+1} - u^{n}}{\\Delta t} = \\frac{\\nu}{2} \\left( L_h u^{n+1} + L_h u^{n} \\right)\n$$\n整理此方程以求解时间步 $n+1$ 处的状态，得到：\n$$\n\\left(I - \\frac{\\nu \\Delta t}{2} L_h \\right) u^{n+1} = \\left(I + \\frac{\\nu \\Delta t}{2} L_h \\right) u^{n}\n$$\n为了进行 von Neumann 稳定性分析，我们考虑单个离散傅里叶模态 $u_{j,k}^{n} = \\hat{u}^{n}(\\theta_x, \\theta_y) \\exp(i(j\\theta_x + k\\theta_y))$ 的演化。放大因子定义为 $G(\\theta_x, \\theta_y) = \\frac{\\hat{u}^{n+1}}{\\hat{u}^{n}}$。我们首先确定与此模态对应的离散拉普拉斯算子 $L_h$ 的特征值。我们将该模态记为 $\\phi_{j,k}$：\n$$\nL_h \\phi_{j,k} = \\left( \\frac{\\exp(i\\theta_x) - 2 + \\exp(-i\\theta_x)}{h_x^2} + \\frac{\\exp(i\\theta_y) - 2 + \\exp(-i\\theta_y)}{h_y^2} \\right) \\phi_{j,k}\n$$\n使用恒等式 $\\exp(i\\alpha) + \\exp(-i\\alpha) = 2\\cos(\\alpha)$，上式变为：\n$$\nL_h \\phi_{j,k} = \\left( \\frac{2\\cos(\\theta_x) - 2}{h_x^2} + \\frac{2\\cos(\\theta_y) - 2}{h_y^2} \\right) \\phi_{j,k}\n$$\n进一步，使用半角恒等式 $2\\cos(\\alpha) - 2 = -4\\sin^2(\\alpha/2)$， $L_h$ 的特征值，记为 $\\hat{L}_h(\\theta_x, \\theta_y)$，是：\n$$\n\\hat{L}_h(\\theta_x, \\theta_y) = -4 \\left( \\frac{\\sin^2(\\theta_x/2)}{h_x^2} + \\frac{\\sin^2(\\theta_y/2)}{h_y^2} \\right)\n$$\n将 $u_{j,k}^{n} = \\hat{u}^{n} \\phi_{j,k}$ 代入整理后的 Crank-Nicolson 格式，算子 $L_h$ 被其特征值 $\\hat{L_h}$ 替换：\n$$\n\\left(1 - \\frac{\\nu \\Delta t}{2} \\hat{L}_h \\right) \\hat{u}^{n+1} = \\left(1 + \\frac{\\nu \\Delta t}{2} \\hat{L}_h \\right) \\hat{u}^{n}\n$$\n放大因子则为：\n$$\nG(\\theta_x, \\theta_y) = \\frac{1 + \\frac{\\nu \\Delta t}{2} \\hat{L}_h}{1 - \\frac{\\nu \\Delta t}{2} \\hat{L}_h}\n$$\n代入 $\\hat{L}_h(\\theta_x, \\theta_y)$ 的表达式：\n$$\nG(\\theta_x, \\theta_y) = \\frac{1 + \\frac{\\nu \\Delta t}{2} \\left[-4 \\left( \\frac{\\sin^2(\\theta_x/2)}{h_x^2} + \\frac{\\sin^2(\\theta_y/2)}{h_y^2} \\right)\\right]}{1 - \\frac{\\nu \\Delta t}{2} \\left[-4 \\left( \\frac{\\sin^2(\\theta_x/2)}{h_x^2} + \\frac{\\sin^2(\\theta_y/2)}{h_y^2} \\right)\\right]} = \\frac{1 - 2\\nu \\Delta t \\left( \\frac{\\sin^2(\\theta_x/2)}{h_x^2} + \\frac{\\sin^2(\\theta_y/2)}{h_y^2} \\right)}{1 + 2\\nu \\Delta t \\left( \\frac{\\sin^2(\\theta_x/2)}{h_x^2} + \\frac{\\sin^2(\\theta_y/2)}{h_y^2} \\right)}\n$$\n这是应用于二维热方程和五点拉普拉斯算子的 Crank-Nicolson 格式的精确放大因子。\n\n第 2 部分：主阶相对误差 $E(\\psi)$\n\n衰减率的相对误差定义为：\n$$\nE(\\psi) = \\frac{\\ln|G(\\theta_{x},\\theta_{y})|+\\nu\\,\\Delta t\\,(k_{x}^{2}+k_{y}^{2})}{\\nu\\,\\Delta t\\,(k_{x}^{2}+k_{y}^{2})}\n$$\n我们在小波数范围分析此表达式，其中 $\\theta_x = k_x h_x \\ll 1$ 和 $\\theta_y = k_y h_y \\ll 1$。令 $X = 2\\nu \\Delta t \\left( \\frac{\\sin^2(\\theta_x/2)}{h_x^2} + \\frac{\\sin^2(\\theta_y/2)}{h_y^2} \\right)$。则 $G = \\frac{1-X}{1+X}$。由于 $\\nu, \\Delta t, h_x, h_y$ 均为正数，因此 $X \\ge 0$，这确保了 $|G| \\le 1$。我们可以写出 $\\ln|G| = \\ln(1-X) - \\ln(1+X)$。\n对于小的 $\\alpha$，$\\sin^2(\\alpha)$ 的泰勒级数是 $\\sin^2(\\alpha) = (\\alpha - \\frac{\\alpha^3}{6} + \\dots)^2 = \\alpha^2 - \\frac{\\alpha^4}{3} + O(\\alpha^6)$。\n将此应用于 $X$ 中的项，其中 $\\theta_x$ 和 $\\theta_y$ 很小：\n$$\n\\sin^2(\\theta_x/2) = \\frac{\\theta_x^2}{4} - \\frac{\\theta_x^4}{48} + O(\\theta_x^6) \\quad \\text{和} \\quad \\sin^2(\\theta_y/2) = \\frac{\\theta_y^2}{4} - \\frac{\\theta_y^4}{48} + O(\\theta_y^6)\n$$\n代入 $\\theta_x = k_x h_x$ 和 $\\theta_y = k_y h_y$：\n$$\nX = 2\\nu \\Delta t \\left[ \\frac{1}{h_x^2}\\left(\\frac{k_x^2 h_x^2}{4} - \\frac{k_x^4 h_x^4}{48}\\right) + \\frac{1}{h_y^2}\\left(\\frac{k_y^2 h_y^2}{4} - \\frac{k_y^4 h_y^4}{48}\\right) + \\dots \\right]\n$$\n$$\nX = 2\\nu \\Delta t \\left[ \\frac{k_x^2}{4} - \\frac{k_x^4 h_x^2}{48} + \\frac{k_y^2}{4} - \\frac{k_y^4 h_y^2}{48} + \\dots \\right]\n$$\n$$\nX = \\frac{\\nu \\Delta t}{2} (k_x^2 + k_y^2) - \\frac{\\nu \\Delta t}{24} (k_x^4 h_x^2 + k_y^4 h_y^2) + O(k^6 h^4)\n$$\n现在我们对小的 $X$ 展开 $\\ln|G|$。$\\ln(1\\pm x)$ 的泰勒级数是 $\\pm x - \\frac{x^2}{2} \\pm \\frac{x^3}{3} - \\dots$。\n$$\n\\ln|G| = \\ln(1-X) - \\ln(1+X) = \\left(-X - \\frac{X^2}{2} - \\dots\\right) - \\left(X - \\frac{X^2}{2} + \\dots\\right) = -2X + O(X^3)\n$$\n代入 $X$ 的展开式：\n$$\n\\ln|G| = -2 \\left[ \\frac{\\nu \\Delta t}{2} (k_x^2 + k_y^2) - \\frac{\\nu \\Delta t}{24} (k_x^4 h_x^2 + k_y^4 h_y^2) + \\dots \\right]\n$$\n$$\n\\ln|G| = -\\nu \\Delta t (k_x^2 + k_y^2) + \\frac{\\nu \\Delta t}{12} (k_x^4 h_x^2 + k_y^4 h_y^2) + \\dots\n$$\n$E(\\psi)$ 的分子是 $\\ln|G| + \\nu \\Delta t (k_x^2+k_y^2)$，其主阶为：\n$$\n\\text{分子} \\approx \\left[-\\nu \\Delta t (k_x^2 + k_y^2) + \\frac{\\nu \\Delta t}{12} (k_x^4 h_x^2 + k_y^4 h_y^2)\\right] + \\nu \\Delta t (k_x^2 + k_y^2) = \\frac{\\nu \\Delta t}{12} (k_x^4 h_x^2 + k_y^4 h_y^2)\n$$\n$E(\\psi)$ 的分母是 $\\nu \\Delta t (k_x^2+k_y^2) = \\nu \\Delta t k^2$。因此，$E(\\psi)$ 的主阶表达式为：\n$$\nE(\\psi) = \\frac{\\frac{\\nu \\Delta t}{12} (k_x^4 h_x^2 + k_y^4 h_y^2)}{\\nu \\Delta t k^2} = \\frac{k_x^4 h_x^2 + k_y^4 h_y^2}{12 k^2}\n$$\n最后，我们用波矢量的大小 $k$ 和角度 $\\psi$ 来表示此式，使用 $k_x = k\\cos\\psi$ 和 $k_y = k\\sin\\psi$：\n$$\nE(\\psi) = \\frac{(k\\cos\\psi)^4 h_x^2 + (k\\sin\\psi)^4 h_y^2}{12 k^2} = \\frac{k^4 \\cos^4\\psi \\, h_x^2 + k^4 \\sin^4\\psi \\, h_y^2}{12 k^2}\n$$\n$$\nE(\\psi) = \\frac{k^2}{12} (h_x^2 \\cos^4\\psi + h_y^2 \\sin^4\\psi)\n$$\n该表达式量化了数值耗散的主阶各向异性。",
            "answer": "$$\n\\boxed{\n\\begin{gathered}\nG(\\theta_x, \\theta_y) = \\frac{1 - 2\\nu \\Delta t \\left( \\frac{\\sin^{2}(\\theta_{x}/2)}{h_{x}^{2}} + \\frac{\\sin^{2}(\\theta_{y}/2)}{h_{y}^{2}} \\right)}{1 + 2\\nu \\Delta t \\left( \\frac{\\sin^{2}(\\theta_{x}/2)}{h_{x}^{2}} + \\frac{\\sin^{2}(\\theta_{y}/2)}{h_{y}^{2}} \\right)} \\\\ \\\\\nE(\\psi) = \\frac{k^{2}}{12} \\left( h_{x}^{2} \\cos^{4}\\psi + h_{y}^{2} \\sin^{4}\\psi \\right)\n\\end{gathered}\n}\n$$"
        }
    ]
}