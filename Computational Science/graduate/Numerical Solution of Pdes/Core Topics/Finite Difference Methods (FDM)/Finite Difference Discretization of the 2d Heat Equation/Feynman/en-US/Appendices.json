{
    "hands_on_practices": [
        {
            "introduction": "The Forward-Time Centered-Space (FTCS) scheme is a natural first step in discretizing parabolic equations like the heat equation. However, its explicit nature imposes a strict condition on the time step size for the solution to remain stable. This exercise  challenges you to derive this critical stability constraint from first principles using von Neumann analysis, specifically for the case of an anisotropic grid where $h_x \\neq h_y$. Mastering this analysis is fundamental to understanding how grid geometry and physical parameters interact to govern the feasibility of an explicit numerical simulation.",
            "id": "3393371",
            "problem": "Consider the constant-coefficient two-dimensional heat equation\n$$\nu_{t}=\\kappa\\left(u_{xx}+u_{yy}\\right),\n$$\nposed on a doubly periodic rectangular domain, where $\\kappa>0$ is the thermal diffusivity. Let the domain be covered by a uniform Cartesian grid with spacings $h_{x}$ and $h_{y}$ in the $x$- and $y$-directions, respectively, and let time be advanced with step $\\Delta t$. Discretize $u_{xx}$ and $u_{yy}$ by standard centered second-order finite differences and advance in time by forward Euler, yielding an explicit update at each interior grid point $(i,j)$ of the form\n$$\nu^{n+1}_{i,j}=u^{n}_{i,j}+\\kappa\\,\\Delta t\\left(\\frac{u^{n}_{i+1,j}-2u^{n}_{i,j}+u^{n}_{i-1,j}}{h_{x}^{2}}+\\frac{u^{n}_{i,j+1}-2u^{n}_{i,j}+u^{n}_{i,j-1}}{h_{y}^{2}}\\right).\n$$\nUsing von Neumann (Fourier) stability analysis from first principles, determine which discrete Fourier mode is the most restrictive for stability when $h_{x}\\neq h_{y}$, and derive the corresponding sharp stability constraint on $\\Delta t$ that ensures no amplification in magnitude of any mode in a single time step. Express your final result as a closed-form analytic expression for the maximum allowable time step $\\Delta t_{\\max}$ in terms of $h_{x}$, $h_{y}$, and $\\kappa$. Express $\\Delta t_{\\max}$ in seconds. No numerical evaluation or rounding is required.",
            "solution": "The problem statement is evaluated for validity.\n\n### Step 1: Extract Givens\n- **Partial Differential Equation**: The constant-coefficient two-dimensional heat equation is $u_{t}=\\kappa\\left(u_{xx}+u_{yy}\\right)$, with $\\kappa>0$.\n- **Domain**: A doubly periodic rectangular domain.\n- **Discretization Parameters**: Uniform Cartesian grid with spacings $h_{x}$ and $h_{y}$ in the $x$- and $y$-directions, respectively. Time is advanced with step $\\Delta t$. It is specified that $h_x \\neq h_y$.\n- **Numerical Scheme**: The spatial derivatives $u_{xx}$ and $u_{yy}$ are discretized using standard centered second-order finite differences. The time integration is performed using the forward Euler method.\n- **Finite Difference Equation**: The resulting explicit update rule is given as:\n$u^{n+1}_{i,j}=u^{n}_{i,j}+\\kappa\\,\\Delta t\\left(\\frac{u^{n}_{i+1,j}-2u^{n}_{i,j}+u^{n}_{i-1,j}}{h_{x}^{2}}+\\frac{u^{n}_{i,j+1}-2u^{n}_{i,j}+u^{n}_{i,j-1}}{h_{y}^{2}}\\right)$.\n- **Analysis Method**: The analysis is to be conducted using von Neumann (Fourier) stability analysis from first principles.\n- **Objective**: Determine the most restrictive Fourier mode for stability and derive the corresponding sharp stability constraint on the maximum allowable time step, $\\Delta t_{\\max}$, in terms of $h_{x}$, $h_{y}$, and $\\kappa$. The result for $\\Delta t_{\\max}$ is to be expressed in seconds.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem is a canonical example in the field of numerical analysis for partial differential equations. The heat equation, the FTCS (Forward-Time Centered-Space) discretization, and von Neumann stability analysis are all standard, well-established concepts. The problem is scientifically and mathematically sound.\n- **Well-Posed**: The problem is well-posed. It provides all necessary information (the PDE, the discretization scheme, the analysis method) to derive a unique and meaningful stability criterion.\n- **Objective**: The problem is stated using precise and unambiguous mathematical language. There are no subjective or opinion-based elements.\n- **Other Flaws**: The problem setup is complete, consistent, realistic (within the context of numerical analysis), and non-trivial. It does not violate any of the criteria for a valid problem. The mention of expressing the final answer in seconds implies that the input parameters $\\kappa$, $h_x$, and $h_y$ should be considered in a consistent set of units (e.g., SI units), such that the resulting time step is naturally in seconds. This does not constitute a flaw.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\n### Solution Derivation\nThe stability of the given finite difference scheme is analyzed using the von Neumann method. This method examines the time evolution of individual Fourier modes of the solution. We consider a single generic Fourier mode on the computational grid $(x_i, y_j) = (i h_x, j h_y)$ of the form:\n$$\nu^n_{i,j} = \\hat{u}^n(k_x, k_y) \\exp(I(k_x x_i + k_y y_j)) = \\hat{u}^n \\exp(I(k_x i h_x + k_y j h_y))\n$$\nwhere $n$ is the time level index, $(i,j)$ are the spatial grid indices, $k_x$ and $k_y$ are the wave numbers in the $x$- and $y$-directions, respectively, $\\hat{u}^n$ is the amplitude of the mode at time level $n$, and $I = \\sqrt{-1}$ is the imaginary unit.\n\nThe amplitude at the next time step, $\\hat{u}^{n+1}$, is related to the current amplitude by the amplification factor $G(k_x, k_y)$:\n$$\n\\hat{u}^{n+1} = G(k_x, k_y) \\hat{u}^n\n$$\nFor the numerical scheme to be stable, the magnitude of the amplification factor must not exceed $1$ for any possible wave numbers, i.e., $|G(k_x, k_y)| \\le 1$.\n\nWe substitute the Fourier mode ansatz into the finite difference equation:\n$$\n\\hat{u}^{n+1} \\exp(I(k_x i h_x + k_y j h_y)) = \\hat{u}^{n} \\exp(I(k_x i h_x + k_y j h_y)) + \\kappa \\Delta t \\left( \\frac{\\hat{u}^n \\left(e^{I k_x (i+1)h_x} - 2e^{I k_x i h_x} + e^{I k_x (i-1)h_x}\\right)e^{I k_y j h_y}}{h_x^2} + \\frac{\\hat{u}^n \\left(e^{I k_y (j+1)h_y} - 2e^{I k_y j h_y} + e^{I k_y (j-1)h_y}\\right)e^{I k_x i h_x}}{h_y^2} \\right)\n$$\nDividing by $\\hat{u}^n \\exp(I(k_x i h_x + k_y j h_y))$ and using $\\hat{u}^{n+1}/\\hat{u}^n = G$, we obtain an expression for the amplification factor:\n$$\nG = 1 + \\kappa \\Delta t \\left( \\frac{e^{I k_x h_x} - 2 + e^{-I k_x h_x}}{h_x^2} + \\frac{e^{I k_y h_y} - 2 + e^{-I k_y h_y}}{h_y^2} \\right)\n$$\nUsing the identity $e^{I\\theta} + e^{-I\\theta} = 2\\cos(\\theta)$, the expression becomes:\n$$\nG = 1 + \\kappa \\Delta t \\left( \\frac{2\\cos(k_x h_x) - 2}{h_x^2} + \\frac{2\\cos(k_y h_y) - 2}{h_y^2} \\right)\n$$\nFactoring out $-2$ and using the half-angle identity $1 - \\cos(\\theta) = 2\\sin^2(\\theta/2)$, we get:\n$$\nG = 1 - 2\\kappa \\Delta t \\left( \\frac{1 - \\cos(k_x h_x)}{h_x^2} + \\frac{1 - \\cos(k_y h_y)}{h_y^2} \\right)\n$$\n$$\nG(k_x, k_y) = 1 - 4\\kappa \\Delta t \\left( \\frac{\\sin^2(k_x h_x / 2)}{h_x^2} + \\frac{\\sin^2(k_y h_y / 2)}{h_y^2} \\right)\n$$\nSince $\\kappa > 0$, $\\Delta t > 0$, and the sine-squared terms are non-negative, the amplification factor $G$ is always real and less than or equal to $1$. The stability condition $|G| \\le 1$ thus simplifies to the single inequality $G \\ge -1$:\n$$\n1 - 4\\kappa \\Delta t \\left( \\frac{\\sin^2(k_x h_x / 2)}{h_x^2} + \\frac{\\sin^2(k_y h_y / 2)}{h_y^2} \\right) \\ge -1\n$$\n$$\n2 \\ge 4\\kappa \\Delta t \\left( \\frac{\\sin^2(k_x h_x / 2)}{h_x^2} + \\frac{\\sin^2(k_y h_y / 2)}{h_y^2} \\right)\n$$\nSolving for $\\Delta t$, we have:\n$$\n\\Delta t \\le \\frac{2}{4\\kappa \\left( \\frac{\\sin^2(k_x h_x / 2)}{h_x^2} + \\frac{\\sin^2(k_y h_y / 2)}{h_y^2} \\right)} = \\frac{1}{2\\kappa \\left( \\frac{\\sin^2(k_x h_x / 2)}{h_x^2} + \\frac{\\sin^2(k_y h_y / 2)}{h_y^2} \\right)}\n$$\nThis inequality must hold for all possible wave numbers $k_x$ and $k_y$. To find the most restrictive constraint on $\\Delta t$, we must find the minimum value of the right-hand side. This occurs when the denominator is at its maximum. The term to be maximized is $\\frac{\\sin^2(k_x h_x / 2)}{h_x^2} + \\frac{\\sin^2(k_y h_y / 2)}{h_y^2}$.\n\nThe maximum value of the function $\\sin^2(\\theta)$ is $1$. This maximum is achieved when we select the wave numbers that maximize both $\\sin^2(k_x h_x/2)$ and $\\sin^2(k_y h_y/2)$ simultaneously. This occurs for the highest frequency modes the grid can resolve, which correspond to:\n$$\nk_x h_x / 2 = \\frac{\\pi}{2} \\implies k_x = \\frac{\\pi}{h_x}\n$$\n$$\nk_y h_y / 2 = \\frac{\\pi}{2} \\implies k_y = \\frac{\\pi}{h_y}\n$$\nThese modes, characterized by alternating signs at adjacent grid points, are the most restrictive for stability. Substituting $\\sin^2(k_x h_x/2) = 1$ and $\\sin^2(k_y h_y/2) = 1$ into the inequality yields the sharp stability bound:\n$$\n\\Delta t \\le \\frac{1}{2\\kappa \\left( \\frac{1}{h_x^2} + \\frac{1}{h_y^2} \\right)}\n$$\nThe maximum allowable time step, $\\Delta t_{\\max}$, is therefore:\n$$\n\\Delta t_{\\max} = \\frac{1}{2\\kappa \\left( \\frac{1}{h_x^2} + \\frac{1}{h_y^2} \\right)}\n$$\nThis expression can be simplified by combining the terms in the denominator:\n$$\n\\Delta t_{\\max} = \\frac{1}{2\\kappa \\left( \\frac{h_y^2 + h_x^2}{h_x^2 h_y^2} \\right)} = \\frac{h_x^2 h_y^2}{2\\kappa (h_x^2 + h_y^2)}\n$$\nThis is the final analytical expression for the maximum stable time step. If the physical quantities $\\kappa$, $h_x$, and $h_y$ are given in SI units (m$^2$/s for $\\kappa$, and m for $h_x$ and $h_y$), then the resulting $\\Delta t_{\\max}$ will have units of seconds, as requested.",
            "answer": "$$\n\\boxed{\\frac{h_{x}^{2} h_{y}^{2}}{2 \\kappa (h_{x}^{2} + h_{y}^{2})}}\n$$"
        },
        {
            "introduction": "Building upon the foundational stability analysis, we now explore how the choice of spatial discretization impacts the overall scheme. While the five-point stencil is standard, other consistent approximations for the Laplacian exist. This practice  invites you to analyze a higher-order nine-point stencil, determine its stability properties, and compare the resulting time step restriction to that of the standard scheme. This comparison illuminates the important trade-offs between the complexity of a stencil and its benefits for numerical stability.",
            "id": "3393357",
            "problem": "Consider the two-dimensional heat equation $u_{t} = \\kappa \\left(u_{xx} + u_{yy}\\right)$ on a uniform infinite lattice with spatial step size $h > 0$ in both directions, where $\\kappa > 0$ is the thermal diffusivity. Use a Forward Euler time discretization $u^{n+1} = u^{n} + \\kappa \\Delta t \\, L u^{n}$ with a spatial discrete Laplacian $L$.\n\nDefine the standard five-point discrete Laplacian $L_{5}$ by\n$$\n\\left(L_{5} u\\right)_{i,j} = \\frac{1}{h^{2}}\\left(u_{i+1,j} + u_{i-1,j} + u_{i,j+1} + u_{i,j-1} - 4 u_{i,j}\\right),\n$$\nand replace it with the following consistent nine-point stencil $L_{9}$:\n$$\n\\left(L_{9} u\\right)_{i,j} = \\frac{1}{6 h^{2}}\\Big(4\\big(u_{i+1,j} + u_{i-1,j} + u_{i,j+1} + u_{i,j-1}\\big) + \\big(u_{i+1,j+1} + u_{i+1,j-1} + u_{i-1,j+1} + u_{i-1,j-1}\\big) - 20 u_{i,j}\\Big).\n$$\n\nUsing von Neumann (Fourier) analysis on the infinite lattice, determine the most negative eigenvalue (i.e., the worst-case Fourier symbol) of $L_{9}$ and derive the corresponding explicit Forward Euler Courant–Friedrichs–Lewy (CFL) stability bound on $\\Delta t$ in terms of $h$ and $\\kappa$. Then compare this bound with the Forward Euler CFL restriction obtained when using $L_{5}$.\n\nExpress your final answer as a single analytical expression or a row matrix containing the new worst-case eigenvalue of $L_{9}$ and the two explicit time-step bounds for $L_{9}$ and $L_{5}$, respectively. No numerical evaluation or rounding is required. Do not include units in your final expression.",
            "solution": "The problem statement is first validated to ensure it is scientifically grounded, well-posed, and objective.\n\n### Step 1: Extract Givens\n- **Partial Differential Equation (PDE)**: The two-dimensional heat equation, $u_{t} = \\kappa \\left(u_{xx} + u_{yy}\\right)$, where $\\kappa > 0$.\n- **Domain**: An infinite uniform lattice with spatial step size $h > 0$ in both the $x$ and $y$ directions.\n- **Time Discretization**: Forward Euler method, $u^{n+1} = u^{n} + \\kappa \\Delta t \\, L u^{n}$, where $\\Delta t$ is the time step.\n- **Discrete Laplacian $L_{5}$**: $\\left(L_{5} u\\right)_{i,j} = \\frac{1}{h^{2}}\\left(u_{i+1,j} + u_{i-1,j} + u_{i,j+1} + u_{i,j-1} - 4 u_{i,j}\\right)$.\n- **Discrete Laplacian $L_{9}$**: $\\left(L_{9} u\\right)_{i,j} = \\frac{1}{6 h^{2}}\\Big(4\\big(u_{i+1,j} + u_{i-1,j} + u_{i,j+1} + u_{i,j-1}\\big) + \\big(u_{i+1,j+1} + u_{i+1,j-1} + u_{i-1,j+1} + u_{i-1,j-1}\\big) - 20 u_{i,j}\\Big)$.\n- **Task**:\n  1. Determine the most negative eigenvalue (worst-case Fourier symbol) of $L_{9}$.\n  2. Derive the Courant–Friedrichs–Lewy (CFL) stability bound for the Forward Euler scheme using $L_{9}$.\n  3. Compare this with the CFL bound for the scheme using $L_{5}$.\n  4. Express the results as a row matrix.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem concerns the numerical stability analysis of a finite difference method for the heat equation, a fundamental and standard topic in numerical analysis and computational physics. The operators $L_5$ and $L_9$ are well-known consistent discretizations of the Laplacian. The methodology, von Neumann stability analysis, is the standard technique for this class of problems. The problem is free of scientific flaws.\n- **Well-Posed**: All necessary information is provided. The operators, the PDE, and the discretization scheme are explicitly defined. The task is clear and leads to a unique, meaningful solution.\n- **Objective**: The problem is stated using precise mathematical language, free of ambiguity or subjective claims.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\n### Solution Derivation\nTo analyze the stability of the finite difference scheme, we employ von Neumann (or Fourier) stability analysis. We consider a single Fourier mode for the solution on the discrete grid $(x_i, y_j) = (ih, jh)$:\n$$\nu_{i,j}^{n} = g^{n} e^{I(k_x x_i + k_y y_j)} = g^{n} e^{I(i \\theta_x + j \\theta_y)}\n$$\nwhere $g$ is the amplification factor per time step, $k_x$ and $k_y$ are the wave numbers, $I = \\sqrt{-1}$ is the imaginary unit, and $\\theta_x = k_x h$ and $\\theta_y = k_y h$ are the dimensionless wave numbers. For stability, the amplification factor must satisfy $|g| \\le 1$ for all possible values of $\\theta_x, \\theta_y \\in [-\\pi, \\pi]$.\n\nThe given Forward Euler time-stepping scheme is:\n$$\nu_{i,j}^{n+1} = u_{i,j}^{n} + \\kappa \\Delta t (L u^n)_{i,j}\n$$\nSubstituting the Fourier mode into this equation, we can find an expression for $g$. The action of the discrete operator $L$ on a Fourier mode is to multiply it by its Fourier symbol (or eigenvalue), denoted by $\\hat{L}(\\theta_x, \\theta_y)$.\n$$\ng^{n+1} e^{I(i\\theta_x+j\\theta_y)} = g^n e^{I(i\\theta_x+j\\theta_y)} + \\kappa \\Delta t \\, g^n \\hat{L}(\\theta_x, \\theta_y) e^{I(i\\theta_x+j\\theta_y)}\n$$\nDividing by $g^n e^{I(i\\theta_x+j\\theta_y)}$ gives the expression for the amplification factor:\n$$\ng = 1 + \\kappa \\Delta t \\hat{L}(\\theta_x, \\theta_y)\n$$\nFor a diffusion operator like the Laplacian, the eigenvalues $\\hat{L}$ are real and non-positive ($\\hat{L} \\le 0$). The stability condition $|g| \\le 1$ becomes:\n$$\n-1 \\le 1 + \\kappa \\Delta t \\hat{L}(\\theta_x, \\theta_y) \\le 1\n$$\nSince $\\kappa > 0$, $\\Delta t > 0$, and $\\hat{L} \\le 0$, the right-hand inequality, $\\kappa \\Delta t \\hat{L} \\le 0$, is always satisfied. The stability is thus governed by the left-hand inequality:\n$$\n-2 \\le \\kappa \\Delta t \\hat{L}(\\theta_x, \\theta_y) \\implies \\Delta t \\le \\frac{-2}{\\kappa \\hat{L}(\\theta_x, \\theta_y)}\n$$\nThis must hold for all modes. The most restrictive condition comes from the most negative (minimum) eigenvalue of $L$, which we denote as $\\hat{L}_{\\min}$.\n$$\n\\Delta t \\le \\frac{-2}{\\kappa \\hat{L}_{\\min}}\n$$\n\n**1. Analysis for the nine-point stencil $L_9$**\n\nFirst, we find the Fourier symbol $\\hat{L}_9(\\theta_x, \\theta_y)$.\nApplying $L_9$ to $u_{i,j} = e^{I(i\\theta_x+j\\theta_y)}$:\nThe shift operation $u_{i+m, j+n}$ corresponds to multiplication by $e^{I(m\\theta_x+n\\theta_y)}$.\n\\begin{align*}\n\\hat{L}_9(\\theta_x, \\theta_y) &= \\frac{1}{6h^2} \\Big[ 4(e^{I\\theta_x} + e^{-I\\theta_x} + e^{I\\theta_y} + e^{-I\\theta_y}) \\\\\n&\\quad + (e^{I(\\theta_x+\\theta_y)} + e^{I(\\theta_x-\\theta_y)} + e^{I(-\\theta_x+\\theta_y)} + e^{I(-\\theta_x-\\theta_y)}) - 20 \\Big]\n\\end{align*}\nUsing the identities $e^{I\\theta} + e^{-I\\theta} = 2\\cos(\\theta)$ and $(e^{I\\theta_x} + e^{-I\\theta_x})(e^{I\\theta_y} + e^{-I\\theta_y}) = 4\\cos(\\theta_x)\\cos(\\theta_y)$, we simplify the expression:\n\\begin{align*}\n\\hat{L}_9(\\theta_x, \\theta_y) &= \\frac{1}{6h^2} \\Big[ 4\\big(2\\cos(\\theta_x) + 2\\cos(\\theta_y)\\big) + 4\\cos(\\theta_x)\\cos(\\theta_y) - 20 \\Big] \\\\\n&= \\frac{1}{6h^2} \\Big[ 8\\cos(\\theta_x) + 8\\cos(\\theta_y) + 4\\cos(\\theta_x)\\cos(\\theta_y) - 20 \\Big] \\\\\n&= \\frac{4}{6h^2} \\Big[ 2\\cos(\\theta_x) + 2\\cos(\\theta_y) + \\cos(\\theta_x)\\cos(\\theta_y) - 5 \\Big] \\\\\n&= \\frac{2}{3h^2} \\Big[ 2\\cos(\\theta_x) + 2\\cos(\\theta_y) + \\cos(\\theta_x)\\cos(\\theta_y) - 5 \\Big]\n\\end{align*}\nTo find the worst-case (most negative) eigenvalue $\\hat{L}_{9, \\min}$, we need to minimize the expression in the brackets over $\\theta_x, \\theta_y \\in [-\\pi, \\pi]$. Let $c_x = \\cos(\\theta_x)$ and $c_y = \\cos(\\theta_y)$, where $c_x, c_y \\in [-1, 1]$. We minimize the function $f(c_x, c_y) = 2c_x + 2c_y + c_x c_y - 5$ on the square $[-1, 1] \\times [-1, 1]$. The extrema of this function must lie on the boundary of the square.\nThe minimum is achieved when $c_x$ and $c_y$ are at their minimum value of $-1$. This corresponds to the highest frequency modes, $\\theta_x = \\pi$ and $\\theta_y = \\pi$.\n$$\n\\min(f) = f(-1, -1) = 2(-1) + 2(-1) + (-1)(-1) - 5 = -2 - 2 + 1 - 5 = -8\n$$\nThe most negative eigenvalue of $L_9$ is therefore:\n$$\n\\hat{L}_{9, \\min} = \\frac{2}{3h^2}(-8) = -\\frac{16}{3h^2}\n$$\nThis is the first requested quantity.\n\nThe corresponding CFL stability bound for the scheme using $L_9$ is:\n$$\n\\Delta t \\le \\frac{-2}{\\kappa \\hat{L}_{9, \\min}} = \\frac{-2}{\\kappa \\left(-\\frac{16}{3h^2}\\right)} = \\frac{6h^2}{16\\kappa} = \\frac{3h^2}{8\\kappa}\n$$\nThis is the second requested quantity.\n\n**2. Analysis for the five-point stencil $L_5$ (for comparison)**\n\nThe Fourier symbol for the standard five-point stencil $L_5$ is:\n\\begin{align*}\n\\hat{L}_5(\\theta_x, \\theta_y) &= \\frac{1}{h^2} \\Big[ e^{I\\theta_x} + e^{-I\\theta_x} + e^{I\\theta_y} + e^{-I\\theta_y} - 4 \\Big] \\\\\n&= \\frac{1}{h^2} \\Big[ 2\\cos(\\theta_x) + 2\\cos(\\theta_y) - 4 \\Big] \\\\\n&= \\frac{2}{h^2} \\Big[ \\cos(\\theta_x) + \\cos(\\theta_y) - 2 \\Big]\n\\end{align*}\nThe minimum value occurs when $\\cos(\\theta_x) = -1$ and $\\cos(\\theta_y) = -1$:\n$$\n\\hat{L}_{5, \\min} = \\frac{2}{h^2}(-1 - 1 - 2) = -\\frac{8}{h^2}\n$$\nThe CFL stability bound for the scheme using $L_5$ is:\n$$\n\\Delta t \\le \\frac{-2}{\\kappa \\hat{L}_{5, \\min}} = \\frac{-2}{\\kappa \\left(-\\frac{8}{h^2}\\right)} = \\frac{2h^2}{8\\kappa} = \\frac{h^2}{4\\kappa}\n$$\nThis is the third requested quantity.\n\n**Comparison of Stability Bounds**\nThe stability bound for $L_9$ is $\\Delta t \\le \\frac{3h^2}{8\\kappa}$, while for $L_5$ it is $\\Delta t \\le \\frac{h^2}{4\\kappa} = \\frac{2h^2}{8\\kappa}$. The nine-point stencil allows for a slightly larger time step, making it computationally more efficient in that regard if the additional stencil computations are not too costly.\n\n**Final Answer Assembly**\nThe problem asks for a row matrix containing:\n1. The worst-case eigenvalue of $L_9$: $-\\frac{16}{3h^2}$\n2. The time-step bound for $L_9$: $\\frac{3h^2}{8\\kappa}$\n3. The time-step bound for $L_5$: $\\frac{h^2}{4\\kappa}$\n\nThe final answer is composed of these three expressions.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -\\frac{16}{3h^{2}} & \\frac{3h^{2}}{8\\kappa} & \\frac{h^{2}}{4\\kappa} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "The stringent stability limits of explicit methods often lead us to implicit schemes, which are typically unconditionally stable. However, \"stable\" does not always mean \"accurate\" or \"physically meaningful,\" especially when dealing with stiff problems that contain rapidly decaying, high-frequency components. This hands-on coding exercise  demonstrates the crucial difference between the Backward Euler and Crank–Nicolson methods in this context. By implementing both, you will witness the superior damping property (L-stability) of Backward Euler, a vital feature for producing smooth, physical solutions in many practical scenarios.",
            "id": "3393393",
            "problem": "Consider the two-dimensional heat equation on the unit square with homogeneous Dirichlet boundary conditions, given by $u_t = \\alpha \\Delta u$ on $\\Omega = (0,1)\\times(0,1)$, with $u=0$ on $\\partial\\Omega$ and initial condition $u(x,y,0) = u_0(x,y)$. Let a uniform Cartesian finite difference (FD) grid be defined using $N$ interior points along each coordinate direction, so the grid spacing is $h = 1/(N+1)$ and the interior grid indices are $i=1,\\dots,N$ and $j=1,\\dots,N$. Let the five-point FD Laplacian be used for the spatial discretization, yielding the semi-discrete system $U'(t) = \\alpha A U(t)$, where $U(t)\\in\\mathbb{R}^{N^2}$ is the vector of interior nodal values and $A\\in\\mathbb{R}^{N^2\\times N^2}$ is the FD Laplacian matrix with homogeneous Dirichlet boundary conditions.\n\nTwo implicit one-step time discretizations are to be contrasted:\n\n- The backward Euler method (also called implicit Euler), which advances $U^0$ to $U^1$ over one step of size $\\Delta t$ via $(I - \\Delta t\\,\\alpha A)\\,U^1 = U^0$.\n\n- The Crank–Nicolson (CN) method, which advances $U^0$ to $U^1$ over one step of size $\\Delta t$ via $(I - \\tfrac{1}{2}\\Delta t\\,\\alpha A)\\,U^1 = (I + \\tfrac{1}{2}\\Delta t\\,\\alpha A)\\,U^0$.\n\nTo isolate and measure the behavior on very stiff components, let the initial condition be chosen as the highest-frequency discrete Dirichlet eigenmode on the FD grid, namely $u^0_{i,j} = \\sin\\!\\big(\\tfrac{i N \\pi}{N+1}\\big)\\,\\sin\\!\\big(\\tfrac{j N \\pi}{N+1}\\big)$ for $i=1,\\dots,N$, $j=1,\\dots,N$, flattened into $U^0\\in\\mathbb{R}^{N^2}$. Denote by $v\\in\\mathbb{R}^{N^2}$ this discrete eigenmode vector. After applying a single time step with each method, define the measured amplification magnitude of the high-frequency component by projection onto $v$:\n$$\nr_{\\mathrm{BE}} = \\left|\\frac{v^\\top U^1_{\\mathrm{BE}}}{v^\\top v}\\right|,\\qquad\nr_{\\mathrm{CN}} = \\left|\\frac{v^\\top U^1_{\\mathrm{CN}}}{v^\\top v}\\right|.\n$$\nThese quantities capture the decay (or lack thereof) of the stiffest mode under each scheme. All quantities are dimensionless.\n\nImplement a program that constructs $A$ using the five-point FD Laplacian with homogeneous Dirichlet boundary conditions, builds the initial eigenmode $v$, performs one time step with both backward Euler and Crank–Nicolson for each test parameter set, and outputs the measured amplification magnitudes $r_{\\mathrm{BE}}$ and $r_{\\mathrm{CN}}$ as specified below.\n\nUse the following test suite, which explores a boundary case and increasingly stiff regimes:\n- Test $1$: $N=64$, $\\alpha=1$, $\\Delta t = 0$.\n- Test $2$: $N=64$, $\\alpha=1$, $\\Delta t = 10^{-4}$.\n- Test $3$: $N=64$, $\\alpha=1$, $\\Delta t = 10^{-3}$.\n- Test $4$: $N=64$, $\\alpha=1$, $\\Delta t = 10^{-2}$.\n\nFor each test, compute $r_{\\mathrm{BE}}$ and $r_{\\mathrm{CN}}$ as defined above. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order $[r_{\\mathrm{BE}}^{(1)}, r_{\\mathrm{CN}}^{(1)}, r_{\\mathrm{BE}}^{(2)}, r_{\\mathrm{CN}}^{(2)}, r_{\\mathrm{BE}}^{(3)}, r_{\\mathrm{CN}}^{(3)}, r_{\\mathrm{BE}}^{(4)}, r_{\\mathrm{CN}}^{(4)}]$, where the superscript denotes the test index. Each entry must be a floating-point number.",
            "solution": "The problem statement has been meticulously validated and is determined to be valid. It is scientifically grounded, well-posed, and objective, presenting a standard problem in the numerical solution of partial differential equations. All necessary data and definitions are provided, and there are no internal contradictions or ambiguities.\n\nThe problem requires a comparison of the Backward Euler (BE) and Crank–Nicolson (CN) time-stepping schemes for the two-dimensional heat equation, $u_t = \\alpha \\Delta u$, on a unit square domain $\\Omega=(0,1)\\times(0,1)$ with homogeneous Dirichlet boundary conditions. The spatial discretization is performed using a five-point finite difference (FD) stencil on a uniform grid with $N$ interior points in each dimension, leading to a grid spacing of $h = 1/(N+1)$. This semi-discretization results in a system of ordinary differential equations (ODEs), $U'(t) = \\alpha A U(t)$, where $U \\in \\mathbb{R}^{N^2}$ is the vector of temperature values at the interior grid nodes, and $A \\in \\mathbb{R}^{N^2\\times N^2}$ is the matrix representation of the FD Laplacian operator.\n\nThe matrix $A$ corresponding to the five-point stencil for the Laplacian $\\Delta$ on a grid with spacing $h$ is given by applying the operator $\\Delta_h u_{i,j} = \\frac{1}{h^2}(u_{i+1,j} + u_{i-1,j} + u_{i,j+1} + u_{i,j-1} - 4u_{i,j})$ at each interior node $(i,j)$ for $i,j \\in \\{1,\\dots,N\\}$. This results in a sparse, symmetric, and negative-definite block-tridiagonal matrix.\n\nThe problem investigates the damping properties of the BE and CN schemes on the stiffest component of the system. This component corresponds to the eigenvector of $A$ with the largest-magnitude (most negative) eigenvalue. For the specified domain and boundary conditions, the discrete eigenvectors are given by $v^{(k,m)}_{i,j} = \\sin(\\frac{ik\\pi}{N+1})\\sin(\\frac{jm\\pi}{N+1})$ with corresponding eigenvalues $\\lambda_{k,m} = \\frac{2}{h^2}\\left(\\cos(\\frac{k\\pi}{N+1}) + \\cos(\\frac{m\\pi}{N+1}) - 2\\right)$ for $k,m \\in \\{1,\\dots,N\\}$. The problem correctly identifies the highest-frequency mode by setting $k=m=N$, and designates the corresponding vectorized eigenvector as $v = U^0$.\n\nWhen the initial condition $U^0$ is an eigenvector $v$ of the matrix $A$ with eigenvalue $\\lambda$, the application of a single time step with a linear, time-invariant scheme simplifies considerably. The solution after one step, $U^1$, remains proportional to the initial eigenvector, i.e., $U^1 = g(\\Delta t, \\alpha, \\lambda) v$, where $g$ is the scalar amplification factor of the numerical scheme.\n\nFor the Backward Euler method, the scheme is $(I - \\Delta t\\,\\alpha A)\\,U^1 = U^0$. Substituting $U^0=v$ and $U^1=g_{BE}v$:\n$(I - \\Delta t\\,\\alpha A)(g_{BE}v) = v$\n$g_{BE}(v - \\Delta t\\,\\alpha Av) = v$\n$g_{BE}(v - \\Delta t\\,\\alpha \\lambda v) = v$\n$g_{BE}(1 - \\Delta t\\,\\alpha \\lambda)v = v$\nThis yields the amplification factor $g_{BE} = (1 - \\Delta t\\,\\alpha \\lambda)^{-1}$. The quantity to be measured, $r_{\\mathrm{BE}}$, is precisely the magnitude of this factor: $r_{\\mathrm{BE}} = |g_{BE}| = |(1 - \\Delta t\\,\\alpha \\lambda)^{-1}|$.\n\nFor the Crank–Nicolson method, the scheme is $(I - \\tfrac{1}{2}\\Delta t\\,\\alpha A)\\,U^1 = (I + \\tfrac{1}{2}\\Delta t\\,\\alpha A)\\,U^0$. Substituting $U^0=v$ and $U^1=g_{CN}v$:\n$(I - \\tfrac{1}{2}\\Delta t\\,\\alpha A)(g_{CN}v) = (I + \\tfrac{1}{2}\\Delta t\\,\\alpha A)v$\n$g_{CN}(v - \\tfrac{1}{2}\\Delta t\\,\\alpha \\lambda v) = (v + \\tfrac{1}{2}\\Delta t\\,\\alpha \\lambda v)$\n$g_{CN}(1 - \\tfrac{1}{2}\\Delta t\\,\\alpha \\lambda)v = (1 + \\tfrac{1}{2}\\Delta t\\,\\alpha \\lambda)v$\nThis yields the amplification factor $g_{CN} = \\frac{1 + \\frac{1}{2}\\Delta t\\,\\alpha \\lambda}{1 - \\frac{1}{2}\\Delta t\\,\\alpha \\lambda}$. The measured quantity is $r_{\\mathrm{CN}} = |g_{CN}| = \\left|\\frac{1 + \\frac{1}{2}\\Delta t\\,\\alpha \\lambda}{1 - \\frac{1}{2}\\Delta t\\,\\alpha \\lambda}\\right|$.\n\nThe implementation will proceed as follows:\n1.  For each test case with parameters $N$, $\\alpha$, and $\\Delta t$, the grid spacing $h=1/(N+1)$ is determined.\n2.  The sparse matrix $A$ of size $N^2 \\times N^2$ is constructed. A computationally efficient way to form this matrix is via the Kronecker sum of two $N \\times N$ 1D Laplacian matrices. The 1D Laplacian stencil matrix is $L_{1D} = \\text{tridiag}(1, -2, 1)$. The 2D Laplacian matrix is then $A = \\frac{1}{h^2}(I \\otimes L_{1D} + L_{1D} \\otimes I)$.\n3.  The initial condition vector $v=U^0$ is constructed by evaluating $u^0_{i,j} = \\sin(\\frac{iN\\pi}{N+1})\\sin(\\frac{jN\\pi}{N+1})$ for $i,j \\in \\{1, \\dots, N\\}$ and flattening the resulting $N \\times N$ array into a vector of length $N^2$.\n4.  For Backward Euler, the linear system $(I - \\Delta t\\,\\alpha A)\\,U^1_{\\mathrm{BE}} = v$ is formed and solved for $U^1_{\\mathrm{BE}}$.\n5.  For Crank-Nicolson, the right-hand side vector $b_{\\mathrm{CN}} = (I + \\tfrac{1}{2}\\Delta t\\,\\alpha A)v$ is computed. Then, the linear system $(I - \\tfrac{1}{2}\\Delta t\\,\\alpha A)\\,U^1_{\\mathrm{CN}} = b_{\\mathrm{CN}}$ is formed and solved for $U^1_{\\mathrm{CN}}$. Sparse linear algebra routines are essential for efficiency.\n6.  The amplification magnitudes are calculated using the specified projection formula:\n    $r_{\\mathrm{BE}} = |\\frac{v^\\top U^1_{\\mathrm{BE}}}{v^\\top v}|$ and $r_{\\mathrm{CN}} = |\\frac{v^\\top U^1_{\\mathrm{CN}}}{v^\\top v}|$.\n7.  The results for all test cases are collected and formatted into a single output line as requested. For the degenerate case $\\Delta t=0$, both methods reduce to $U^1=U^0$, yielding $r_{\\mathrm{BE}}=r_{\\mathrm{CN}}=1$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import sparse\nfrom scipy.sparse.linalg import spsolve\n\ndef solve():\n    \"\"\"\n    Solves the problem of comparing Backward Euler and Crank-Nicolson schemes\n    for the 2D heat equation on its highest-frequency eigenmode.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (N, alpha, dt)\n        (64, 1.0, 0.0),\n        (64, 1.0, 1e-4),\n        (64, 1.0, 1e-3),\n        (64, 1.0, 1e-2),\n    ]\n\n    results = []\n    \n    for N, alpha, dt in test_cases:\n        # 1. Grid and Matrix Setup\n        h = 1.0 / (N + 1)\n        N_sq = N * N\n\n        # Construct the 1D second-derivative stencil matrix\n        main_diag = -2.0 * np.ones(N)\n        off_diag = np.ones(N - 1)\n        T_1D = sparse.diags([off_diag, main_diag, off_diag], [-1, 0, 1], shape=(N, N), format='csc')\n        \n        # Construct the 2D Laplacian matrix A using Kronecker sum\n        # A represents the operator Delta_h = 1/h^2 * (stencil)\n        I_N = sparse.identity(N, format='csc')\n        A = (1.0 / h**2) * (sparse.kron(I_N, T_1D) + sparse.kron(T_1D, I_N))\n        \n        # 2. Initial Condition Vector (Highest-Frequency Eigenmode)\n        i = np.arange(1, N + 1)\n        j = np.arange(1, N + 1)\n        ii, jj = np.meshgrid(i, j, indexing='ij')\n        \n        # u^0_{i,j} = sin(i*N*pi/(N+1)) * sin(j*N*pi/(N+1))\n        arg_factor = N * np.pi / (N + 1)\n        u0_grid = np.sin(ii * arg_factor) * np.sin(jj * arg_factor)\n        \n        # Flatten the 2D grid data into a 1D vector v = U^0\n        v = u0_grid.flatten()\n        \n        # Identity matrix of size N^2 x N^2\n        I_N_sq = sparse.identity(N_sq, format='csc')\n\n        # Handle the case dt = 0 separately for robustness, although the\n        # general formulas below would also work.\n        if dt == 0.0:\n            U1_BE = v\n            U1_CN = v\n        else:\n            # 3. Backward Euler (BE) Step\n            # Solve (I - dt * alpha * A) * U^1_BE = U^0\n            M_BE = I_N_sq - dt * alpha * A\n            U1_BE = spsolve(M_BE, v)\n        \n            # 4. Crank-Nicolson (CN) Step\n            # Solve (I - 0.5 * dt * alpha * A) * U^1_CN = (I + 0.5 * dt * alpha * A) * U^0\n            M_CN_LHS = I_N_sq - 0.5 * dt * alpha * A\n            # Compute RHS = (I + 0.5 * dt * alpha * A) * v\n            # The matrix-vector product is more efficient than forming the RHS matrix\n            RHS_CN = v + (0.5 * dt * alpha) * (A @ v)\n            U1_CN = spsolve(M_CN_LHS, RHS_CN)\n\n        # 5. Compute Amplification Magnitudes\n        # r = |(v^T * U^1) / (v^T * v)|\n        v_dot_v = np.dot(v, v)\n        \n        v_dot_U1_BE = np.dot(v, U1_BE)\n        r_BE = np.abs(v_dot_U1_BE / v_dot_v)\n        \n        v_dot_U1_CN = np.dot(v, U1_CN)\n        r_CN = np.abs(v_dot_U1_CN / v_dot_v)\n        \n        results.extend([r_BE, r_CN])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}