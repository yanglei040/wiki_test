{
    "hands_on_practices": [
        {
            "introduction": "Before diving into mathematical derivations, it is crucial to build an intuition for why the Courant-Friedrichs-Lewy (CFL) condition exists. At its heart, the CFL condition is a statement about causality: a numerical method cannot produce a correct solution at a point in spacetime if it does not use the data that physically influences that point. This exercise  challenges you to connect the abstract structure of a finite difference stencil to the physical concept of the \"domain of dependence,\" exploring what happens when a numerical scheme is blind to the direction of information propagation.",
            "id": "3375543",
            "problem": "Consider the linear advection equation $u_t + a\\,u_x = 0$ with constant wave speed $a>0$ on a uniform grid with spatial step $\\Delta x$ and time step $\\Delta t$. The exact solution propagates along characteristics $x(t) = x_0 + a t$, so the point $(x_i,t_{n+1})$ depends on data along the characteristic that arrives from the left at $(x_i - a \\Delta t, t_n)$. In an explicit finite difference method, the numerical domain of dependence at a single time update is the set of spatial nodes used on the right-hand side of the update formula at time level $t_n$ to produce $u_i^{n+1}$.\n\nUsing only the definitions above and first principles for the linear advection equation and explicit finite difference stencils, identify which option constructs an explicit one-step stencil whose numerical domain of dependence at $(x_i,t_{n+1})$ fails to cover the partial differential equation domain of dependence for $a>0$, and correctly predicts the associated instability mechanism that follows from this mismatch. Let $\\nu := a\\,\\Delta t/\\Delta x$ denote the Courant number.\n\nChoose the single best option.\n\nA. Stencil and mechanism:\nUpdate by forward time and forward (downwind) space,\n$$\nu_i^{n+1} \\;=\\; u_i^n \\;-\\; \\nu\\left(u_{i+1}^n - u_i^n\\right).\n$$\nFor $a>0$ this stencil uses only $x_i$ and $x_{i+1}$ at time $t_n$, so its numerical domain of dependence excludes the upwind node $x_{i-1}$ required by the partial differential equation domain of dependence. A von Neumann analysis yields amplification factor $G(\\theta) = 1 + \\nu\\big(1 - e^{\\mathrm{i}\\theta}\\big)$ with $|G(\\theta)|>1$ for all $\\theta\\neq 0$ whenever $\\nu>0$, implying unconditional linear instability. The modified equation reveals a negative numerical viscosity (anti-diffusion) term proportional to $-\\,\\tfrac{a}{2}\\,(a\\Delta t + \\Delta x)\\,u_{xx}$, so short wavelengths grow fastest.\n\nB. Stencil and mechanism:\nUpdate by forward time and backward (upwind) space,\n$$\nu_i^{n+1} \\;=\\; u_i^n \\;-\\; \\nu\\left(u_i^n - u_{i-1}^n\\right).\n$$\nFor $a>0$ this stencil uses $x_i$ and $x_{i-1}$ at time $t_n$, so its numerical domain of dependence contains the partial differential equation domain of dependence. It is linearly stable under the Courant-Friedrichs-Lewy condition $0\\le \\nu \\le 1$, with numerical diffusion that damps high wavenumbers.\n\nC. Stencil and mechanism:\nUpdate by forward time and centered space,\n$$\nu_i^{n+1} \\;=\\; u_i^n \\;-\\; \\frac{\\nu}{2}\\left(u_{i+1}^n - u_{i-1}^n\\right).\n$$\nFor $a>0$ this stencil uses $x_{i-1}$, $x_i$, and $x_{i+1}$ at time $t_n$, so its numerical domain of dependence includes the partial differential equation domain of dependence. Nevertheless, forward Euler in time applied to a skew-adjoint spatial operator produces $G(\\theta)=1-\\mathrm{i}\\nu\\sin\\theta$ and $|G(\\theta)|>1$ for any $\\theta\\neq 0$, hence unconditional instability due to time-discretization of a purely dispersive operator, not due to a domain-of-dependence mismatch.\n\nD. Stencil and mechanism:\nUpdate by the Lax-Friedrichs method,\n$$\nu_i^{n+1} \\;=\\; \\tfrac{1}{2}\\big(u_{i+1}^n + u_{i-1}^n\\big) \\;-\\; \\frac{\\nu}{2}\\left(u_{i+1}^n - u_{i-1}^n\\right).\n$$\nFor $a>0$ this stencilâ€™s numerical domain of dependence includes the partial differential equation domain of dependence. It is linearly stable provided $|\\nu|\\le 1$ due to added numerical diffusion that controls high wavenumbers.\n\nWhich option is correct?",
            "solution": "The user wants a critical validation of the problem statement, followed by a first-principles derivation of the solution and an evaluation of all provided options.\n\n### Step 1: Extract Givens\n-   **Partial Differential Equation:** Linear advection equation, $u_t + a\\,u_x = 0$.\n-   **Wave Speed:** $a$ is a positive constant ($a>0$).\n-   **Grid:** Uniform grid with spatial step $\\Delta x$ and time step $\\Delta t$.\n-   **Courant Number Definition:** $\\nu := a\\,\\Delta t/\\Delta x$.\n-   **Partial Differential Equation (PDE) Domain of Dependence:** For a point $(x_i, t_{n+1})$, the domain of dependence at the previous time level $t_n$ is the point $(x_i - a \\Delta t, t_n)$. This is derived from the characteristic line $x(t) = x_0 + a t$.\n-   **Numerical Domain of Dependence:** For an explicit finite difference method, this is the set of spatial nodes at time level $t_n$ used to compute the solution $u_i^{n+1}$ at node $x_i$ and time $t_{n+1}$.\n-   **Task:** Identify the option that presents an explicit, one-step stencil for which the numerical domain of dependence at $(x_i,t_{n+1})$ fails to cover the PDE domain of dependence for $a>0$, and that correctly predicts the associated instability mechanism.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientific or Factual Unsoundness:** The problem is based on the linear advection equation and the Courant-Friedrichs-Lewy (CFL) condition, which are fundamental concepts in the numerical analysis of partial differential equations. All definitions and principles are standard and correct. There are no scientific or factual errors.\n2.  **Non-Formalizable or Irrelevant:** The problem is a classic, formalizable problem in applied mathematics and numerical methods. It is directly relevant to the topic of the Courant-Friedrichs-Lewy stability condition.\n3.  **Incomplete or Contradictory Setup:** The problem is self-contained. It provides the PDE, defines all relevant terms ($\\Delta x$, $\\Delta t$, $\\nu$, domains of dependence), and states the objective clearly. There are no contradictions.\n4.  **Unrealistic or Infeasible:** The setup is a standard model problem used to teach and analyze numerical methods. It is neither unrealistic nor infeasible.\n5.  **Ill-Posed or Poorly Structured:** The problem is well-posed. The question is unambiguous and seeks a unique answer from the provided options based on well-established mathematical analysis.\n6.  **Pseudo-Profound, Trivial, or Tautological:** The problem requires a solid understanding of the CFL condition, von Neumann stability analysis, and modified equation analysis. It is a substantive question, not trivial.\n7.  **Outside Scientific Verifiability:** The claims and analyses required are all mathematically verifiable.\n\n### Step 3: Verdict and Action\nThe problem statement is **valid**. It is a clear, correct, and self-contained problem in numerical analysis. I will proceed with the solution derivation.\n\n### Derivation from First Principles\n\nThe governing P.D.E. is the linear advection equation:\n$$u_t + a u_x = 0, \\quad a > 0$$\nThe solution to this equation, $u(x,t)$, is constant along the characteristic curves defined by $\\frac{dx}{dt} = a$. Integrating this gives the characteristic lines $x - at = \\text{constant}$. This means the value of the solution at a point $(x_i, t_{n+1})$ is determined by its value at an earlier time $t_n$ at the point where the characteristic passing through $(x_i, t_{n+1})$ intersects the line $t=t_n$. This point is $(x_i - a(t_{n+1}-t_n), t_n) = (x_i - a \\Delta t, t_n)$. This is the PDE domain of dependence.\n\nUsing the Courant number, $\\nu = a \\Delta t / \\Delta x$, we can express this point's spatial coordinate as $x_i - \\nu \\Delta x$. Since $a>0$, $\\Delta t > 0$, and $\\Delta x > 0$, we have $\\nu > 0$. Therefore, the PDE domain of dependence is located to the left of the grid point $x_i$.\n\nThe Courant-Friedrichs-Lewy (CFL) condition is a necessary (but not always sufficient) condition for the convergence of an explicit finite difference scheme. It states that the numerical domain of dependence of the scheme must contain the PDE's domain of dependence. For a one-dimensional scheme computing $u_i^{n+1}$ from points $u_{i+j}^n$ for $j \\in \\{j_{min}, \\dots, j_{max}\\}$, the numerical domain of dependence is the interval $[x_{i+j_{min}}, x_{i+j_{max}}]$. The CFL condition requires:\n$$x_{i+j_{min}} \\le x_i - a \\Delta t \\le x_{i+j_{max}}$$\n$$x_i + j_{min}\\Delta x \\le x_i - \\nu \\Delta x \\le x_i + j_{max}\\Delta x$$\n$$j_{min} \\le -\\nu \\le j_{max}$$\nSince $\\nu > 0$, this implies that to satisfy the CFL condition, the stencil must use at least one point to the left of or at $x_i$ (i.e., $j_{min} \\le 0$) and the point $x_i - \\nu \\Delta x$ must lie within the span of the stencil points. Specifically, a scheme that only uses points $\\{x_i, x_{i+1}, \\dots\\}$ (i.e., $j_{min} \\ge 0$) will always violate the CFL condition for $a>0$, because $-\\nu < 0$ and $j_{min} \\ge 0$, so $j_{min} \\le -\\nu$ is never satisfied. Such a scheme is called a \"downwind\" scheme and is expected to be unstable.\n\nWe must now analyze each option to see which one describes such a case and accurately explains the consequences.\n\n### Option-by-Option Analysis\n\n**A. Stencil and mechanism: Forward time and forward (downwind) space**\nThe stencil is $u_i^{n+1} = u_i^n - \\nu(u_{i+1}^n - u_i^n)$.\n-   **Domain of Dependence:** This stencil computes $u_i^{n+1}$ using values at $t_n$ from nodes $x_i$ and $x_{i+1}$. The numerical domain of dependence is the set of points $\\{x_i, x_{i+1}\\}$. The PDE domain of dependence is the single point $x_i - a\\Delta t = x_i - \\nu \\Delta x$. Since $a>0$, $\\nu>0$, so this point is to the left of $x_i$. The numerical domain, $[x_i, x_{i+1}]$, does not contain the point $x_i - \\nu \\Delta x$. Thus, the CFL condition is violated for any $\\nu>0$. The option's claim on this point is correct.\n-   **Instability Mechanism (von Neumann Analysis):** We substitute a Fourier mode $u_j^n = G^n e^{\\mathrm{i} j \\theta}$ where $\\theta = k \\Delta x$ into the scheme.\n    $$G^{n+1} e^{\\mathrm{i} i \\theta} = G^n e^{\\mathrm{i} i \\theta} - \\nu(G^n e^{\\mathrm{i} (i+1) \\theta} - G^n e^{\\mathrm{i} i \\theta})$$\n    Dividing by $G^n e^{\\mathrm{i} i \\theta}$ gives the amplification factor $G(\\theta)$:\n    $$G(\\theta) = 1 - \\nu(e^{\\mathrm{i}\\theta} - 1) = 1 - \\nu(\\cos\\theta - 1) - \\mathrm{i}\\nu\\sin\\theta$$\n    The squared magnitude is:\n    $$|G(\\theta)|^2 = (1 - \\nu(\\cos\\theta-1))^2 + (-\\nu\\sin\\theta)^2 = 1 - 2\\nu(\\cos\\theta-1) + \\nu^2(\\cos\\theta-1)^2 + \\nu^2\\sin^2\\theta$$\n    $$|G(\\theta)|^2 = 1 + 2\\nu(1-\\cos\\theta) + \\nu^2(\\cos^2\\theta - 2\\cos\\theta + 1 + \\sin^2\\theta) = 1 + 2\\nu(1-\\cos\\theta) + \\nu^2(2 - 2\\cos\\theta)$$\n    $$|G(\\theta)|^2 = 1 + 2(\\nu + \\nu^2)(1-\\cos\\theta)$$\n    Since $\\nu > 0$ and $1-\\cos\\theta \\ge 0$, we have $|G(\\theta)|^2 \\ge 1$. The magnitude is strictly greater than $1$ for all $\\theta \\neq 2m\\pi$ (i.e., for all non-zero wavenumbers). This proves the scheme is unconditionally unstable for $\\nu>0$. The option's analysis of the amplification factor and its magnitude is correct.\n-   **Instability Mechanism (Modified Equation):** We find the modified equation by Taylor expansion. The scheme is $\\frac{u_i^{n+1}-u_i^n}{\\Delta t} + a\\frac{u_{i+1}^n-u_i^n}{\\Delta x} = 0$.\n    $$ (u_t + \\frac{\\Delta t}{2} u_{tt} + \\dots) + a(u_x + \\frac{\\Delta x}{2} u_{xx} + \\dots) = 0 $$\n    $$ u_t + a u_x = - \\frac{\\Delta t}{2} u_{tt} - \\frac{a \\Delta x}{2} u_{xx} + \\dots $$\n    From the PDE, $u_t \\approx -a u_x$, so $u_{tt} \\approx -a u_{xt} = -a(u_t)_x \\approx -a(-a u_x)_x = a^2 u_{xx}$. Substituting this back:\n    $$ u_t + a u_x = - \\frac{\\Delta t}{2} (a^2 u_{xx}) - \\frac{a \\Delta x}{2} u_{xx} + \\dots = -\\frac{a}{2}(a\\Delta t + \\Delta x) u_{xx} + \\dots $$\n    The leading error term has a coefficient of $D_{num} = -\\frac{a}{2}(a\\Delta t + \\Delta x)$. Since $a>0$, this coefficient is negative. This term acts as an anti-diffusion (or negative viscosity) term, causing exponential growth of short-wavelength components. The option's statement on the modified equation and its interpretation is perfectly correct.\n-   **Verdict:** All parts of this option are correct. It correctly identifies a stencil that fails the CFL domain of dependence condition and correctly explains the resulting instability. **Correct**.\n\n**B. Stencil and mechanism: Forward time and backward (upwind) space**\nThe stencil is $u_i^{n+1} = u_i^n - \\nu(u_i^n - u_{i-1}^n)$.\n-   **Domain of Dependence:** The numerical domain of dependence is $\\{x_{i-1}, x_i\\}$, or the interval $[x_{i-1}, x_i]$. The CFL condition requires $x_{i-1} \\le x_i - \\nu\\Delta x \\le x_i$. This simplifies to $x_i - \\Delta x \\le x_i - \\nu\\Delta x$ and $x_i - \\nu\\Delta x \\le x_i$. The first inequality gives $1 \\ge \\nu$, and the second is always true for $\\nu>0$. So the CFL condition is satisfied if $0 \\le \\nu \\le 1$. The option correctly states that the scheme is stable under this condition and that for this range, the numerical domain contains the PDE domain.\n-   This option describes a scheme that *can* satisfy the CFL condition and is conditionally stable. It does not describe a scheme that *fails* to cover the domain of dependence as its fundamental flaw.\n-   **Verdict:** The statements are factually correct, but they do not answer the question posed. **Incorrect**.\n\n**C. Stencil and mechanism: Forward time and centered space (FTCS)**\nThe stencil is $u_i^{n+1} = u_i^n - \\frac{\\nu}{2}(u_{i+1}^n - u_{i-1}^n)$.\n-   **Domain of Dependence:** The numerical domain is $\\{x_{i-1}, x_i, x_{i+1}\\}$, or $[x_{i-1}, x_{i+1}]$. The CFL condition requires $x_{i-1} \\le x_i - \\nu\\Delta x \\le x_{i+1}$. This is satisfied for $|\\nu| \\le 1$. So for $0 < \\nu \\le 1$, the domain of dependence is covered.\n-   **Instability Mechanism:** The amplification factor is $G(\\theta) = 1 - \\mathrm{i}\\nu\\sin\\theta$. Its magnitude is $|G(\\theta)|^2 = 1 + \\nu^2\\sin^2\\theta$, which is greater than $1$ for any $\\nu>0$ and $\\sin\\theta \\neq 0$. The scheme is unconditionally unstable.\n-   The option correctly identifies this instability but crucially states that it is *not* due to a domain-of-dependence mismatch (at least for $\\nu \\le 1$). The instability arises from applying a forward Euler time-stepping method to a spatially discretized operator with pure imaginary eigenvalues. The question, however, asks for the case where the instability *follows from this mismatch*.\n-   **Verdict:** This option describes an unstable scheme, but a different instability mechanism from the one requested. **Incorrect**.\n\n**D. Stencil and mechanism: Lax-Friedrichs method**\nThe stencil is $u_i^{n+1} = \\tfrac{1}{2}(u_{i+1}^n + u_{i-1}^n) - \\frac{\\nu}{2}(u_{i+1}^n - u_{i-1}^n)$.\n-   **Domain of Dependence:** The numerical domain is $\\{x_{i-1}, x_{i+1}\\}$, or $[x_{i-1}, x_{i+1}]$. As with FTCS, the CFL condition is satisfied for $|\\nu| \\le 1$.\n-   **Stability:** The amplification factor is $G(\\theta) = \\cos\\theta - \\mathrm{i}\\nu\\sin\\theta$. The squared magnitude is $|G(\\theta)|^2 = \\cos^2\\theta + \\nu^2\\sin^2\\theta = 1 + (\\nu^2 - 1)\\sin^2\\theta$. For stability, we need $|G|^2 \\le 1$, which requires $\\nu^2 - 1 \\le 0$, or $|\\nu| \\le 1$. The scheme is conditionally stable.\n-   This option describes a scheme that is conditionally stable and satisfies the CFL condition within its stability range. It does not describe a scheme that fails the domain of dependence condition.\n-   **Verdict:** The statements are factually correct, but this option does not satisfy the criteria of the question. **Incorrect**.\n\n### Conclusion\nOption A is the only option that correctly identifies a finite difference scheme (forward-time, forward-space or \"downwind\") whose numerical domain of dependence fundamentally fails to contain the PDE's domain of dependence for the given problem ($a>0$). It also provides a complete and correct analysis of the resulting unconditional instability, both through von Neumann analysis and the modified equation, identifying anti-diffusion as the mechanism.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "While the domain of dependence provides a physical rationale for stability, a quantitative and sharp stability bound requires a more formal mathematical tool. The von Neumann stability analysis is the standard method for determining the stability of linear finite difference schemes with constant coefficients. This practice  will guide you through the canonical derivation of the CFL condition for the first-order upwind scheme, a fundamental building block for solving hyperbolic equations, by analyzing how the amplitude of Fourier modes evolves in time.",
            "id": "3375615",
            "problem": "Consider the linear advection partial differential equation (PDE) $u_{t} + a\\,u_{x} = 0$ for a constant advection speed $a \\in \\mathbb{R}$ on a uniform spatial grid with spacing $\\Delta x > 0$ and explicit time stepping with step size $\\Delta t > 0$. Discretize $u_{x}$ using the first-order upwind finite-difference approximation consistent with the sign of $a$ (backward difference if $a>0$, forward difference if $a<0$), and discretize $u_{t}$ using forward Euler in time. Assume a spatially periodic setting so that discrete Fourier modes are admissible. Define the Courant-Friedrichs-Lewy (CFL) number $C := a\\,\\Delta t/\\Delta x$. Perform a von Neumann (Fourier) stability analysis of this scheme by considering a discrete Fourier mode $u_{j}^{n} = \\hat{u}^{n}\\exp(i\\theta j)$, where $\\theta \\in \\mathbb{R}$ is the nondimensional wavenumber, and derive the sharp necessary and sufficient stability constraint on $C$ ensuring that the amplification factor has magnitude at most one for all wavenumbers. Finally, express your result as the maximal allowable time step $\\Delta t_{\\max}$ in terms of $a$ and $\\Delta x$. Provide your final answer as a single closed-form analytic expression. No numerical rounding is required.",
            "solution": "The user wants me to solve a problem.\n\n### Step 1: Extract Givens\n- **PDE**: $u_{t} + a\\,u_{x} = 0$, where $a \\in \\mathbb{R}$ is a constant advection speed.\n- **Grid**: Uniform spatial grid with spacing $\\Delta x > 0$.\n- **Time Stepping**: Explicit, with step size $\\Delta t > 0$.\n- **Discretization of $u_t$**: Forward Euler in time, $u_t \\approx \\frac{u_j^{n+1} - u_j^n}{\\Delta t}$.\n- **Discretization of $u_x$**: First-order upwind scheme.\n    - If $a > 0$: Backward difference, $u_x \\approx \\frac{u_j^n - u_{j-1}^n}{\\Delta x}$.\n    - If $a < 0$: Forward difference, $u_x \\approx \\frac{u_{j+1}^n - u_j^n}{\\Delta x}$.\n- **Setting**: Spatially periodic.\n- **Analysis Method**: von Neumann stability analysis using a discrete Fourier mode $u_{j}^{n} = \\hat{u}^{n}\\exp(i\\theta j)$, where $\\theta \\in \\mathbb{R}$.\n- **Definition**: Courant-Friedrichs-Lewy (CFL) number, $C := a\\,\\Delta t/\\Delta x$.\n- **Objective**: Derive the sharp necessary and sufficient stability constraint on $C$ and express the result as the maximal allowable time step $\\Delta t_{\\max}$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically and mathematically sound. It poses a standard, well-defined question in the field of numerical analysis for partial differential equations.\n- **Scientifically Grounded**: The linear advection equation is a fundamental model equation. The first-order upwind scheme and von Neumann stability analysis are standard, well-established techniques. All premises are correct.\n- **Well-Posed**: The problem is clearly stated with all necessary information to derive a unique and meaningful solution. The definitions are precise.\n- **Objective**: The language is formal, objective, and free of bias or subjective claims.\n- **Completeness**: The problem is self-contained and provides all required definitions and conditions. There are no contradictions.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. I will proceed with a full, reasoned solution.\n\nThe linear advection equation is given by\n$$\nu_t + a u_x = 0\n$$\nwhere $u(x,t)$ is the transported quantity, $a$ is the constant advection speed, $t$ is time, and $x$ is the spatial coordinate. We discretize this equation on a uniform grid where $x_j = j\\Delta x$ and $t_n = n\\Delta t$. Let $u_j^n$ denote the numerical approximation of $u(x_j, t_n)$.\n\nThe time derivative $u_t$ is approximated using the forward Euler method:\n$$\nu_t \\approx \\frac{u_j^{n+1} - u_j^n}{\\Delta t}\n$$\nThe spatial derivative $u_x$ is approximated using a first-order upwind scheme, which depends on the sign of the advection speed $a$.\n\n**Case 1: $a > 0$**\nFor positive advection speed, information propagates in the positive $x$ direction. The upwind scheme uses a backward difference for the spatial derivative:\n$$\nu_x \\approx \\frac{u_j^n - u_{j-1}^n}{\\Delta x}\n$$\nSubstituting these approximations into the PDE gives the finite difference equation:\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} + a \\frac{u_j^n - u_{j-1}^n}{\\Delta x} = 0\n$$\nRearranging for $u_j^{n+1}$ and introducing the Courant-Friedrichs-Lewy (CFL) number $C = \\frac{a \\Delta t}{\\Delta x}$, we get:\n$$\nu_j^{n+1} = u_j^n - C (u_j^n - u_{j-1}^n)\n$$\nSince $a > 0$, $\\Delta t > 0$, and $\\Delta x > 0$, we have $C > 0$.\n\nFor the von Neumann stability analysis, we substitute the discrete Fourier mode $u_j^n = \\hat{u}^n \\exp(i\\theta j)$ into the scheme, where $\\theta$ is the non-dimensional wavenumber. The amplitude $\\hat{u}^n$ evolves according to $\\hat{u}^{n+1} = G(\\theta) \\hat{u}^n$, where $G(\\theta)$ is the amplification factor.\n$$\n\\hat{u}^{n+1} \\exp(i\\theta j) = \\hat{u}^n \\exp(i\\theta j) - C (\\hat{u}^n \\exp(i\\theta j) - \\hat{u}^n \\exp(i\\theta (j-1)))\n$$\nDividing by $\\hat{u}^n \\exp(i\\theta j)$ (assuming $\\hat{u}^n \\neq 0$):\n$$\nG(\\theta) = \\frac{\\hat{u}^{n+1}}{\\hat{u}^n} = 1 - C (1 - \\exp(-i\\theta))\n$$\nFor the scheme to be stable, the magnitude of the amplification factor must satisfy $|G(\\theta)| \\le 1$ for all wavenumbers $\\theta \\in \\mathbb{R}$. We analyze the squared magnitude:\n$$\n|G(\\theta)|^2 = |(1 - C) + C \\exp(-i\\theta)|^2 = |(1 - C + C\\cos\\theta) - iC\\sin\\theta|^2\n$$\n$$\n|G(\\theta)|^2 = (1 - C + C\\cos\\theta)^2 + (-C\\sin\\theta)^2\n$$\n$$\n|G(\\theta)|^2 = (1-C)^2 + 2C(1-C)\\cos\\theta + C^2\\cos^2\\theta + C^2\\sin^2\\theta\n$$\n$$\n|G(\\theta)|^2 = 1 - 2C + C^2 + 2C(1-C)\\cos\\theta + C^2(\\cos^2\\theta + \\sin^2\\theta)\n$$\n$$\n|G(\\theta)|^2 = 1 - 2C + 2C^2 + 2C(1-C)\\cos\\theta = 1 - 2C(1-C) + 2C(1-C)\\cos\\theta\n$$\n$$\n|G(\\theta)|^2 = 1 - 2C(1-C)(1-\\cos\\theta)\n$$\nThe stability condition $|G(\\theta)|^2 \\le 1$ implies:\n$$\n1 - 2C(1-C)(1-\\cos\\theta) \\le 1\n$$\n$$\n-2C(1-C)(1-\\cos\\theta) \\le 0\n$$\nSince $(1-\\cos\\theta) \\ge 0$ for all $\\theta$, the inequality simplifies to:\n$$\nC(1-C) \\ge 0\n$$\nGiven that we are in the case $a > 0$, we have $C > 0$. Thus, for the product to be non-negative, we must have $1-C \\ge 0$, which implies $C \\le 1$. The combined stability condition for this case is $0 < C \\le 1$.\n\n**Case 2: $a < 0$**\nFor negative advection speed, information propagates in the negative $x$ direction. The upwind scheme uses a forward difference for the spatial derivative:\n$$\nu_x \\approx \\frac{u_{j+1}^n - u_j^n}{\\Delta x}\n$$\nThe finite difference equation is:\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} + a \\frac{u_{j+1}^n - u_j^n}{\\Delta x} = 0\n$$\n$$\nu_j^{n+1} = u_j^n - C (u_{j+1}^n - u_j^n)\n$$\nSince $a < 0$, we have $C < 0$. Substituting the Fourier mode $u_j^n = \\hat{u}^n \\exp(i\\theta j)$ yields:\n$$\n\\hat{u}^{n+1} \\exp(i\\theta j) = \\hat{u}^n \\exp(i\\theta j) - C (\\hat{u}^n \\exp(i\\theta (j+1)) - \\hat{u}^n \\exp(i\\theta j))\n$$\nDividing by $\\hat{u}^n \\exp(i\\theta j)$:\n$$\nG(\\theta) = \\frac{\\hat{u}^{n+1}}{\\hat{u}^n} = 1 - C (\\exp(i\\theta) - 1)\n$$\nThe squared magnitude is:\n$$\n|G(\\theta)|^2 = |(1+C) - C \\exp(i\\theta)|^2 = |(1+C-C\\cos\\theta) - iC\\sin\\theta|^2\n$$\n$$\n|G(\\theta)|^2 = (1+C-C\\cos\\theta)^2 + (-C\\sin\\theta)^2\n$$\n$$\n|G(\\theta)|^2 = (1+C)^2 - 2C(1+C)\\cos\\theta + C^2\\cos^2\\theta + C^2\\sin^2\\theta\n$$\n$$\n|G(\\theta)|^2 = 1 + 2C + 2C^2 - 2C(1+C)\\cos\\theta = 1 + 2C(1+C)(1-\\cos\\theta)\n$$\nThe stability condition $|G(\\theta)|^2 \\le 1$ implies:\n$$\n1 + 2C(1+C)(1-\\cos\\theta) \\le 1\n$$\n$$\n2C(1+C)(1-\\cos\\theta) \\le 0\n$$\nAs before, since $(1-\\cos\\theta) \\ge 0$, the inequality simplifies to:\n$$\nC(1+C) \\le 0\n$$\nGiven that we are in the case $a < 0$, we have $C < 0$. Thus, for the product to be non-positive, we must have $1+C \\ge 0$, which implies $C \\ge -1$. The combined stability condition for this case is $-1 \\le C < 0$.\n\n**Combined Stability Constraint**\nThe stability condition is $0 < C \\le 1$ when $a>0$, and $-1 \\le C < 0$ when $a<0$. These two conditions can be unified.\nFor $a > 0$, $C = \\frac{a\\Delta t}{\\Delta x} > 0$. The condition $C \\le 1$ becomes $\\frac{a\\Delta t}{\\Delta x} \\le 1$.\nFor $a < 0$, $C = \\frac{a\\Delta t}{\\Delta x} < 0$. The condition $C \\ge -1$ becomes $\\frac{a\\Delta t}{\\Delta x} \\ge -1$, which is equivalent to $-\\frac{a\\Delta t}{\\Delta x} \\le 1$.\nNoting that for $a>0$, $|a| = a$, and for $a<0$, $|a| = -a$, both conditions can be expressed in a single, compact form:\n$$\n\\frac{|a|\\Delta t}{\\Delta x} \\le 1\n$$\nThis is the sharp necessary and sufficient stability constraint for the first-order upwind scheme.\n\n**Maximal Allowable Time Step**\nTo find the maximal allowable time step, $\\Delta t_{\\max}$, we solve the stability inequality for $\\Delta t$. Assuming $a \\neq 0$:\n$$\n\\Delta t \\le \\frac{\\Delta x}{|a|}\n$$\nThe maximal value of $\\Delta t$ that guarantees stability for all wavenumbers is therefore:\n$$\n\\Delta t_{\\max} = \\frac{\\Delta x}{|a|}\n$$\nThis result is the celebrated Courant-Friedrichs-Lewy (CFL) condition for this specific numerical scheme. It states that the time step must be small enough so that the domain of dependence of the numerical scheme contains the domain of dependence of the PDE. In one time step, a fluid particle travels a distance $|a|\\Delta t$, and this must be less than or equal to one grid spacing $\\Delta x$.",
            "answer": "$$\n\\boxed{\\frac{\\Delta x}{|a|}}\n$$"
        },
        {
            "introduction": "The principles of numerical stability are not limited to hyperbolic advection equations. Parabolic equations, such as the heat equation, which model diffusive processes, also have stability constraints for explicit time-stepping schemes, but with a fundamentally different character. This exercise  extends the application of von Neumann analysis to the Forward-Time Central-Space (FTCS) scheme for the heat equation, revealing a diffusive time step restriction where $\\Delta t$ scales with $(\\Delta x)^2$, in stark contrast to the advective scaling of $\\Delta t \\propto \\Delta x$.",
            "id": "3375578",
            "problem": "Consider the one-dimensional heat equation $u_{t} = \\nu\\, u_{xx}$ on an infinite, uniform spatial grid with spacing $\\Delta x$, where $\\nu > 0$ is a constant kinematic viscosity (diffusivity). Discretize in time using the Forward-Time Central-Space (FTCS) scheme on a uniform temporal grid with time step $\\Delta t$. The Courant-Friedrichs-Lewy (CFL) stability condition for linear, constant-coefficient problems can be assessed by von Neumann (Fourier) analysis, which requires that the magnitude of the amplification factor be bounded by unity for all spatial Fourier modes.\n\nStarting from first principles appropriate to numerical solution of partial differential equations, namely the discrete FTCS update for $u_{t} = \\nu\\, u_{xx}$ on a uniform grid and the Fourier mode ansatz used in von Neumann analysis, derive the stability restriction that guarantees bounded growth of all discrete Fourier modes. Then, from this condition, determine the largest permissible time step $\\Delta t_{\\max}$ as a closed-form expression in terms of $\\Delta x$ and $\\nu$. Report your final answer for $\\Delta t_{\\max}$ as a single analytic expression. Do not provide an inequality, and do not include units in your final reported expression.",
            "solution": "We begin with the one-dimensional heat equation $u_{t} = \\nu\\, u_{xx}$, where $\\nu > 0$ is constant. On a uniform spatial grid $x_{j} = j\\,\\Delta x$ and a uniform temporal grid $t^{n} = n\\,\\Delta t$, the Forward-Time Central-Space (FTCS) scheme discretizes the equation as\n$$\n\\frac{u_{j}^{n+1} - u_{j}^{n}}{\\Delta t} = \\nu\\,\\frac{u_{j+1}^{n} - 2 u_{j}^{n} + u_{j-1}^{n}}{(\\Delta x)^{2}}.\n$$\nEquivalently, the explicit update is\n$$\nu_{j}^{n+1} = u_{j}^{n} + r\\left(u_{j+1}^{n} - 2 u_{j}^{n} + u_{j-1}^{n}\\right),\n$$\nwhere we have introduced the nondimensional diffusive number\n$$\nr = \\frac{\\nu\\,\\Delta t}{(\\Delta x)^{2}}.\n$$\n\nTo assess linear stability via von Neumann (Fourier) analysis, we consider the response of the scheme to a single spatial Fourier mode. Assume a solution of the form\n$$\nu_{j}^{n} = \\hat{u}^{n}\\,\\exp\\!\\left(\\mathrm{i}\\,k\\,x_{j}\\right) = \\hat{u}^{n}\\,\\exp\\!\\left(\\mathrm{i}\\,k\\,j\\,\\Delta x\\right),\n$$\nwhere $k \\in \\mathbb{R}$ is the spatial wave number and $\\mathrm{i}$ is the imaginary unit. Substituting this ansatz into the update, we find\n$$\n\\hat{u}^{n+1}\\,\\exp\\!\\left(\\mathrm{i}\\,k\\,j\\,\\Delta x\\right) = \\hat{u}^{n}\\,\\exp\\!\\left(\\mathrm{i}\\,k\\,j\\,\\Delta x\\right) + r\\left[\\hat{u}^{n}\\,\\exp\\!\\left(\\mathrm{i}\\,k\\,(j+1)\\,\\Delta x\\right) - 2 \\hat{u}^{n}\\,\\exp\\!\\left(\\mathrm{i}\\,k\\,j\\,\\Delta x\\right) + \\hat{u}^{n}\\,\\exp\\!\\left(\\mathrm{i}\\,k\\,(j-1)\\,\\Delta x\\right)\\right].\n$$\nCanceling the common factor $\\exp\\!\\left(\\mathrm{i}\\,k\\,j\\,\\Delta x\\right)$ yields the scalar recurrence\n$$\n\\hat{u}^{n+1} = \\hat{u}^{n}\\left[1 + r\\left(\\exp\\!\\left(\\mathrm{i}\\,k\\,\\Delta x\\right) - 2 + \\exp\\!\\left(-\\mathrm{i}\\,k\\,\\Delta x\\right)\\right)\\right].\n$$\nDefine the amplification factor $G(k)$ by $\\hat{u}^{n+1} = G(k)\\,\\hat{u}^{n}$; then\n$$\nG(k) = 1 + r\\left(\\exp\\!\\left(\\mathrm{i}\\,k\\,\\Delta x\\right) - 2 + \\exp\\!\\left(-\\mathrm{i}\\,k\\,\\Delta x\\right)\\right).\n$$\nUsing the identity $\\exp\\!\\left(\\mathrm{i}\\,\\theta\\right) + \\exp\\!\\left(-\\mathrm{i}\\,\\theta\\right) = 2 \\cos\\!\\theta$, we simplify:\n$$\nG(k) = 1 + r\\left(2\\cos\\!\\left(k\\,\\Delta x\\right) - 2\\right) = 1 - 2r\\left(1 - \\cos\\!\\left(k\\,\\Delta x\\right)\\right).\n$$\nRecall the trigonometric identity $1 - \\cos\\!\\theta = 2 \\sin^{2}\\!\\left(\\frac{\\theta}{2}\\right)$, giving\n$$\nG(k) = 1 - 4 r\\,\\sin^{2}\\!\\left(\\frac{k\\,\\Delta x}{2}\\right).\n$$\n\nFor linear constant-coefficient schemes, von Neumann stability requires that the magnitude of the amplification factor not exceed unity for every wave number $k$, i.e.,\n$$\n|G(k)| \\leq 1 \\quad \\text{for all } k \\in \\mathbb{R}.\n$$\nSince $G(k)$ is real here, this reduces to\n$$\n-1 \\leq G(k) \\leq 1 \\quad \\text{for all } k.\n$$\nThe function $\\sin^{2}\\!\\left(\\frac{k\\,\\Delta x}{2}\\right)$ ranges over $[0,1]$ as $k$ varies. The most restrictive bound arises at the extremal values. Evaluate $G$ at $\\sin^{2}\\!\\left(\\frac{k\\,\\Delta x}{2}\\right)=0$ and $1$:\n- At $\\sin^{2}\\!\\left(\\frac{k\\,\\Delta x}{2}\\right)=0$, we have $G = 1$, which satisfies the bound for any $r$.\n- At $\\sin^{2}\\!\\left(\\frac{k\\,\\Delta x}{2}\\right)=1$, we have $G = 1 - 4r$.\n\nStability requires $-1 \\leq 1 - 4r \\leq 1$. The right inequality $1 - 4r \\leq 1$ holds trivially for $r \\geq 0$. The left inequality $-1 \\leq 1 - 4r$ yields\n$$\n-1 \\leq 1 - 4r \\quad \\Longleftrightarrow \\quad -2 \\leq -4r \\quad \\Longleftrightarrow \\quad r \\leq \\frac{1}{2}.\n$$\nAdditionally, for the diffusive equation and explicit FTCS scheme, one also requires $r \\geq 0$ to avoid sign reversal in the discrete diffusion operator. Therefore, the von Neumann stability condition is\n$$\n0 \\leq r \\leq \\frac{1}{2}.\n$$\nRecalling $r = \\frac{\\nu\\,\\Delta t}{(\\Delta x)^{2}}$, the largest permissible explicit time step is\n$$\n\\Delta t_{\\max} = \\frac{(\\Delta x)^{2}}{2\\,\\nu}.\n$$\nThis is the diffusive CFL restriction for the FTCS discretization of the heat equation.",
            "answer": "$$\\boxed{\\frac{(\\Delta x)^{2}}{2 \\nu}}$$"
        }
    ]
}