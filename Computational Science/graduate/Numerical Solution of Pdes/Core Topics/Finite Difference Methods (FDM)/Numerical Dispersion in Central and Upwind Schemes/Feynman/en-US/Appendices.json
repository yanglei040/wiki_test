{
    "hands_on_practices": [
        {
            "introduction": "To understand numerical dispersion, we must first go to its root: the way a discrete difference operator approximates a continuous derivative. This exercise introduces the foundational concept of the \"effective wavenumber,\" denoted as $k^{\\ast}$. By analyzing how a discrete operator acts on a single Fourier mode, we can derive the wavenumber $k^{\\ast}$ that the numerical scheme effectively \"sees,\" which differs from the true wavenumber $k$. Understanding this fundamental mapping from $k$ to $k^{\\ast}$ for basic stencils like central and upwind differences is the first and most critical step toward analyzing and predicting the behavior of any complex numerical method .",
            "id": "3425558",
            "problem": "Consider the one-dimensional linear advection partial differential equation (PDE) $u_{t} + a\\,u_{x} = 0$ with constant velocity $a>0$. Let a uniform grid be defined by $x_{j} = j h$ with grid spacing $h>0$ and grid index $j \\in \\mathbb{Z}$. Define two spatial discretizations for the first derivative $u_{x}$:\n- A second-order central-difference stencil $D_{\\mathrm{c}} u_{j} = \\frac{u_{j+1} - u_{j-1}}{2 h}$.\n- A first-order upwind stencil (appropriate for $a>0$) $D_{\\mathrm{u}} u_{j} = \\frac{u_{j} - u_{j-1}}{h}$.\n\nFor a discrete plane wave $u_{j} = \\hat{u}\\,\\exp(i k x_{j})$ with physical wavenumber $k \\in \\mathbb{R}$ and constant amplitude $\\hat{u} \\in \\mathbb{C}$, define the effective wavenumber mapping $k^{\\ast}(k)$ through the discrete Fourier symbol relation $D u_{j} = i\\,k^{\\ast}(k)\\,u_{j}$, where $D$ denotes either $D_{\\mathrm{c}}$ or $D_{\\mathrm{u}}$. Using the Discrete Fourier Transform (DFT) viewpoint and the above definition of $k^{\\ast}(k)$, do the following:\n1. Derive the exact analytic expression for $k^{\\ast}(k)$ for $D_{\\mathrm{c}}$ and for $D_{\\mathrm{u}}$.\n2. Derive the deviation function $\\Delta(k) = \\frac{k^{\\ast}(k)}{k} - 1$ for $D_{\\mathrm{c}}$ and for $D_{\\mathrm{u}}$.\n3. Based on your expressions, briefly explain how features such as plateaus (regions where $\\frac{d k^{\\ast}}{d k} \\approx 0$ over an interval of $k$) and inflection points in $k^{\\ast}(k)$ are associated with numerical anisotropy when these one-dimensional stencils are applied dimension-by-dimension on a two-dimensional tensor-product grid to approximate directional derivatives.\n\nExpress your final answer symbolically in terms of $k$ and $h$, and present it as a single row matrix with the four entries $k^{\\ast}_{\\mathrm{c}}(k)$, $k^{\\ast}_{\\mathrm{u}}(k)$, $\\Delta_{\\mathrm{c}}(k)$, and $\\Delta_{\\mathrm{u}}(k)$, in that order. No rounding is required; give exact closed-form expressions.",
            "solution": "The problem statement is scientifically grounded, well-posed, and objective. It presents a standard task in the Fourier analysis of finite difference schemes for partial differential equations, a core topic in numerical analysis and computational science. All terms are clearly defined, and the necessary information is provided to derive the requested expressions and provide the conceptual explanation. The problem is valid.\n\nThe solution proceeds in three parts as requested by the problem statement. We analyze the discrete Fourier symbols of the given difference operators to determine the effective wavenumber $k^{\\ast}(k)$ and the deviation function $\\Delta(k)$.\n\n**1. Derivation of Effective Wavenumbers $k^{\\ast}_{\\mathrm{c}}(k)$ and $k^{\\ast}_{\\mathrm{u}}(k)$**\n\nThe effective wavenumber $k^{\\ast}(k)$ is defined by the relation $D u_{j} = i\\,k^{\\ast}(k)\\,u_{j}$ for a discrete plane wave $u_{j} = \\hat{u}\\,\\exp(i k x_{j})$. Substituting $x_j = jh$, we have $u_j = \\hat{u}\\,\\exp(i k j h)$. We apply each difference operator $D$ to this plane wave and solve for $k^{\\ast}(k)$.\n\n**Central-Difference Scheme ($D_{\\mathrm{c}}$):**\nThe second-order central-difference operator is $D_{\\mathrm{c}} u_{j} = \\frac{u_{j+1} - u_{j-1}}{2 h}$. Applying this to the plane wave yields:\n$$\nD_{\\mathrm{c}} u_{j} = \\frac{\\hat{u}\\,\\exp(i k (j+1) h) - \\hat{u}\\,\\exp(i k (j-1) h)}{2 h}\n$$\nWe factor out the term $\\hat{u}\\,\\exp(i k j h)$, which is equal to $u_j$:\n$$\nD_{\\mathrm{c}} u_{j} = \\frac{u_j}{2h} \\left( \\exp(i k h) - \\exp(-i k h) \\right)\n$$\nUsing Euler's identity, $\\sin(\\theta) = \\frac{\\exp(i\\theta) - \\exp(-i\\theta)}{2i}$, we can rewrite the expression in the parenthesis as $2i\\sin(kh)$:\n$$\nD_{\\mathrm{c}} u_{j} = \\frac{u_j}{2h} \\left( 2i\\sin(kh) \\right) = i \\frac{\\sin(kh)}{h} u_j\n$$\nComparing this result with the definition $D_{\\mathrm{c}} u_{j} = i k^{\\ast}_{\\mathrm{c}}(k) u_{j}$, we can directly identify the expression for the effective wavenumber for the central scheme:\n$$\nk^{\\ast}_{\\mathrm{c}}(k) = \\frac{\\sin(kh)}{h}\n$$\nThis effective wavenumber is purely real, which indicates that the second-order central difference scheme is non-dissipative; it only introduces phase (dispersion) errors.\n\n**Upwind Scheme ($D_{\\mathrm{u}}$):**\nThe first-order upwind operator (for $a>0$) is $D_{\\mathrm{u}} u_{j} = \\frac{u_{j} - u_{j-1}}{h}$. Applying this to the plane wave:\n$$\nD_{\\mathrm{u}} u_{j} = \\frac{\\hat{u}\\,\\exp(i k j h) - \\hat{u}\\,\\exp(i k (j-1) h)}{h}\n$$\nAgain, we factor out $u_j = \\hat{u}\\,\\exp(i k j h)$:\n$$\nD_{\\mathrm{u}} u_{j} = \\frac{u_j}{h} \\left( 1 - \\exp(-i k h) \\right)\n$$\nFrom the definition $D_{\\mathrm{u}} u_{j} = i k^{\\ast}_{\\mathrm{u}}(k) u_{j}$, we find that $i k^{\\ast}_{\\mathrm{u}}(k)$ is the Fourier symbol of the operator:\n$$\ni k^{\\ast}_{\\mathrm{u}}(k) = \\frac{1 - \\exp(-i k h)}{h}\n$$\nSolving for $k^{\\ast}_{\\mathrm{u}}(k)$:\n$$\nk^{\\ast}_{\\mathrm{u}}(k) = \\frac{1 - \\exp(-i k h)}{ih}\n$$\nTo express this in terms of real and imaginary parts, we use Euler's identity $\\exp(-ikh) = \\cos(kh) - i\\sin(kh)$:\n$$\nk^{\\ast}_{\\mathrm{u}}(k) = \\frac{1 - (\\cos(kh) - i\\sin(kh))}{ih} = \\frac{1 - \\cos(kh) + i\\sin(kh)}{ih}\n$$\nMultiplying the numerator and denominator by $-i$ (since $1/i = -i$) gives:\n$$\nk^{\\ast}_{\\mathrm{u}}(k) = \\frac{-i(1-\\cos(kh)) -i^2\\sin(kh)}{-i^2h} = \\frac{\\sin(kh) - i(1-\\cos(kh))}{h}\n$$\nThis effective wavenumber is complex. Its real part, $\\mathrm{Re}[k^{\\ast}_{\\mathrm{u}}(k)] = \\frac{\\sin(kh)}{h}$, governs the numerical dispersion (phase error). Its imaginary part, $\\mathrm{Im}[k^{\\ast}_{\\mathrm{u}}(k)] = -\\frac{1-\\cos(kh)}{h}$, governs the numerical dissipation (amplitude error).\n\n**2. Derivation of the Deviation Functions $\\Delta_{\\mathrm{c}}(k)$ and $\\Delta_{\\mathrm{u}}(k)$**\n\nThe deviation function is defined as $\\Delta(k) = \\frac{k^{\\ast}(k)}{k} - 1$. It quantifies the relative error of the effective wavenumber compared to the exact wavenumber.\n\n**Central-Difference Scheme ($\\Delta_{\\mathrm{c}}$):**\n$$\n\\Delta_{\\mathrm{c}}(k) = \\frac{k^{\\ast}_{\\mathrm{c}}(k)}{k} - 1 = \\frac{\\sin(kh)/h}{k} - 1 = \\frac{\\sin(kh)}{kh} - 1\n$$\n\n**Upwind Scheme ($\\Delta_{\\mathrm{u}}$):**\n$$\n\\Delta_{\\mathrm{u}}(k) = \\frac{k^{\\ast}_{\\mathrm{u}}(k)}{k} - 1 = \\frac{(\\sin(kh) - i(1 - \\cos(kh)))/h}{k} - 1 = \\frac{\\sin(kh) - i(1 - \\cos(kh))}{kh} - 1\n$$\n\n**3. Connection between $k^{\\ast}(k)$ Features and 2D Numerical Anisotropy**\n\nNumerical anisotropy arises when the error of a numerical scheme depends on the direction of wave propagation relative to the computational grid. When 1D stencils are applied dimension-by-dimension on a 2D tensor-product grid, the effective wavenumber becomes a vector $\\mathbf{k}^{\\ast} = (k^{\\ast}(k_x), k^{\\ast}(k_y))$, where $k_x$ and $k_y$ are the components of the physical wavenumber vector $\\mathbf{k}$.\n\nThe exact dispersion relation for the advection equation is linear, e.g., $\\omega = \\mathbf{a} \\cdot \\mathbf{k}$. The numerical dispersion relation, $\\omega_{\\mathrm{num}} = \\mathbf{a} \\cdot \\mathbf{k}^{\\ast} = a_x k^{\\ast}(k_x) + a_y k^{\\ast}(k_y)$, is non-linear because $k^{\\ast}(k)$ is a non-linear function of its argument. This non-linearity is the fundamental source of numerical anisotropy, as the error characteristics are not rotationally invariant; they depend on the alignment of $\\mathbf{k}$ with the grid axes.\n\nSpecific features of the 1D $k^{\\ast}(k)$ vs. $k$ curve correspond to severe anisotropic effects:\n\n- **Plateaus:** A plateau in the plot of $\\mathrm{Re}[k^{\\ast}(k)]$ implies that the derivative $\\frac{d}{dk}\\mathrm{Re}[k^{\\ast}(k)]$ is approximately zero. This derivative is proportional to the numerical group velocity. For both the central and upwind schemes, $\\mathrm{Re}[k^{\\ast}(k)] = \\frac{\\sin(kh)}{h}$, which has a plateau (zero derivative) at $kh = \\frac{\\pi}{2}$. For a 2D wave propagating such that one of its wavenumber components (e.g., $k_x$) satisfies $k_x h \\approx \\frac{\\pi}{2}$, the corresponding component of the group velocity will vanish. This causes the wave packet to propagate in an incorrect, grid-aligned direction, a classic manifestation of severe numerical anisotropy.\n\n- **Inflection Points and Extrema:** An inflection point in the $k^{\\ast}(k)$ curve corresponds to an extremum in the group velocity. The most pathological point for the dispersive part of both schemes is at the Nyquist wavenumber, $kh=\\pi$. At this point, $\\mathrm{Re}[k^{\\ast}(\\pi/h)]=0$ and the group velocity is negative, $v_g \\propto \\cos(\\pi)=-1$. This means high-wavenumber components can travel in the wrong direction. In a 2D simulation, if a wave propagates obliquely to the grid, its components $k_x h$ and $k_y h$ might fall into different regions of the dispersion curve. For instance, one component might be in a region of positive group velocity while another is in a region of negative group velocity, leading to a complete disintegration of the wave structure in a highly direction-dependent manner.\n\nIn summary, the non-linear relationship between $k^{\\ast}$ and $k$ is the cause of anisotropy. Plateaus and inflection points are landmarks on the dispersion curve that signal regions of pathological wave propagation behavior (e.g., zero or negative group velocity), which manifest as extreme directional bias in multiple dimensions.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{\\sin(kh)}{h}  \\frac{\\sin(kh) - i(1 - \\cos(kh))}{h}  \\frac{\\sin(kh)}{kh} - 1  \\frac{\\sin(kh) - i(1 - \\cos(kh))}{kh} - 1\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "With the concept of the effective wavenumber established, we now investigate how these inherent errors accumulate over time to shape the entire solution. This practice examines the evolution of a discrete Green's function—the response of the scheme to a single, localized impulse at the initial time. Because an impulse is composed of all possible wavenumbers, its evolution provides a complete picture of the scheme's character, beautifully illustrating the physical consequences of the properties we derived for $k^{\\ast}$. By analyzing the discrete Green's function, you will see how a purely real $k^{\\ast}$ (for the central scheme) leads to non-dissipative, symmetric, and oscillatory tails, while a complex $k^{\\ast}$ (for the upwind scheme) produces a damped and asymmetric response, providing deep physical intuition into the terms \"dispersive\" and \"dissipative\" .",
            "id": "3425564",
            "problem": "Consider the one-dimensional linear advection partial differential equation (PDE) $u_{t} + a\\,u_{x} = 0$ with constant advection speed $a  0$ on the infinite line, and its semi-discrete spatial discretization on a uniform infinite grid with nodes indexed by $j \\in \\mathbb{Z}$ and spacing $\\Delta x  0$. Let $u_{j}(t)$ denote the grid function. Two spatial difference operators are used:\n\n- The centered difference $D_{\\mathrm{c}} u_{j} = \\dfrac{u_{j+1} - u_{j-1}}{2\\,\\Delta x}$.\n- The backward upwind difference $D_{\\mathrm{u}} u_{j} = \\dfrac{u_{j} - u_{j-1}}{\\Delta x}$.\n\nTime is treated continuously (semi-discrete method of lines). The discrete Green’s function $G_{j}^{(s)}(t)$ for scheme $s \\in \\{\\mathrm{c}, \\mathrm{u}\\}$ is defined as the solution to the semi-discrete evolution equation with an impulsive initial condition $u_{j}(0) = \\delta_{j,0}$, where $\\delta_{j,0}$ is the Kronecker delta. Using the Discrete Fourier Transform (DFT), derive the integral representation of $G_{j}^{(\\mathrm{c})}(t)$ and $G_{j}^{(\\mathrm{u})}(t)$ as inverse transforms over the dimensionless discrete wavenumber $\\kappa \\in [-\\pi,\\pi]$ (interpret $\\kappa$ as an angle in radians). Starting from first principles, analyze these integral representations to explain:\n\n- Why the centered scheme produces dispersive oscillatory tails with grid-scale oscillations and symmetric behavior, and\n- Why the upwind scheme produces asymmetric impulse responses with damped oscillatory tails.\n\nBy a stationary-phase or endpoint contribution analysis at large time $t0$, determine the dominant high-frequency contribution governing the tail oscillations of the centered scheme and connect the observed tail wavelength $\\lambda_{\\mathrm{tail}}$ to an effective high-wavenumber $k^{\\ast}$ through $\\lambda_{\\mathrm{tail}} = \\dfrac{2\\pi}{k^{\\ast}}$. Express the final $k^{\\ast}$ as a single closed-form analytic expression in terms of $\\Delta x$. Provide your final answer as the single expression for $k^{\\ast}$, with angles understood in radians. No numerical rounding is required.",
            "solution": "The problem asks for an analysis of the discrete Green's functions for the semi-discretized linear advection equation, $u_t + a u_x = 0$ with $a0$, using a centered difference scheme and a backward upwind scheme. The goal is to explain the qualitative differences in their behavior and to determine the effective wavenumber $k^{\\ast}$ governing the high-frequency tails of the centered scheme.\n\nFirst, we validate the problem statement.\n\n### Step 1: Extract Givens\n- **PDE**: $u_{t} + a\\,u_{x} = 0$, with constant advection speed $a  0$.\n- **Domain**: Infinite line, uniform infinite grid with nodes $j \\in \\mathbb{Z}$ and spacing $\\Delta x  0$.\n- **Grid function**: $u_j(t)$.\n- **Difference Operators**:\n  - Centered: $D_{\\mathrm{c}} u_{j} = \\dfrac{u_{j+1} - u_{j-1}}{2\\,\\Delta x}$.\n  - Backward Upwind: $D_{\\mathrm{u}} u_{j} = \\dfrac{u_{j} - u_{j-1}}{\\Delta x}$.\n- **Semi-discrete Equations**:\n  - Centered: $\\dfrac{du_j}{dt} + a D_{\\mathrm{c}} u_j = 0$.\n  - Upwind: $\\dfrac{du_j}{dt} + a D_{\\mathrm{u}} u_j = 0$.\n- **Green's Function**: $G_{j}^{(s)}(t)$ for scheme $s \\in \\{\\mathrm{c}, \\mathrm{u}\\}$ is the solution for the initial condition $u_{j}(0) = \\delta_{j,0}$.\n- **Analysis Method**: Discrete Fourier Transform (DFT) over the dimensionless wavenumber $\\kappa \\in [-\\pi,\\pi]$.\n- **Tasks**: Derive integral representations for $G_{j}^{(\\mathrm{c})}(t)$ and $G_{j}^{(\\mathrm{u})}(t)$, analyze them to explain the behavior of each scheme, and use a large-time analysis to find the dominant high-frequency wavenumber $k^{\\ast}$ for the centered scheme's tails, where $\\lambda_{\\mathrm{tail}} = \\dfrac{2\\pi}{k^{\\ast}}$.\n- **Final Answer**: A closed-form expression for $k^{\\ast}$ in terms of $\\Delta x$.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientific Groundedness**: The problem is a standard, fundamental topic in the numerical analysis of partial differential equations, specifically the Fourier analysis of finite difference schemes. All concepts—the advection equation, finite differences, numerical dispersion, Green's functions, and Fourier analysis—are well-established in mathematics and computational science.\n- **Well-Posedness**: The problem is well-posed. It provides two standard numerical schemes and a well-defined initial condition (a delta function), for which a unique solution (the Green's function) exists. The analysis requested follows a standard procedure and leads to a uniquely determined quantity, $k^{\\ast}$.\n- **Objectivity**: The language is precise, technical, and free of any subjective or opinion-based statements.\n- **Completeness and Consistency**: The problem is self-contained. All necessary definitions, equations, and conditions are provided. The use of a backward difference for the upwind scheme is consistent with the condition $a  0$.\n- **Other Flaws**: The problem does not exhibit any other flaws such as being unrealistic, ill-structured, trivial, or unverifiable. It is a classic and instructive theoretical problem.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. We proceed with the solution.\n\n### Derivation and Analysis\n\nWe analyze the semi-discrete equations using the Discrete Fourier Transform (DFT). The DFT of a grid function $u_j(t)$ is defined as $\\hat{u}(\\kappa, t) = \\sum_{j=-\\infty}^{\\infty} u_j(t) e^{-ij\\kappa}$, where $\\kappa = k \\Delta x$ is the dimensionless wavenumber. The inverse transform is $u_j(t) = \\frac{1}{2\\pi} \\int_{-\\pi}^{\\pi} \\hat{u}(\\kappa, t) e^{ij\\kappa} d\\kappa$.\n\nThe initial condition $u_j(0) = \\delta_{j,0}$ transforms to $\\hat{u}(\\kappa, 0) = \\sum_{j=-\\infty}^{\\infty} \\delta_{j,0} e^{-ij\\kappa} = e^0 = 1$. The evolution equations for $\\hat{u}(\\kappa, t)$ are obtained by transforming the spatial derivative operators. The transform of a shifted function $u_{j\\pm m}$ is $e^{\\pm i m \\kappa} \\hat{u}(\\kappa)$.\n\n**1. Centered Scheme Analysis**\nThe semi-discrete equation is $\\dfrac{du_j}{dt} = -a D_{\\mathrm{c}} u_j = -a \\dfrac{u_{j+1} - u_{j-1}}{2\\,\\Delta x}$.\nIn Fourier space, this becomes:\n$$\n\\dfrac{d\\hat{u}}{dt} = -a \\dfrac{e^{i\\kappa}\\hat{u} - e^{-i\\kappa}\\hat{u}}{2\\,\\Delta x} = -a \\dfrac{2i\\sin(\\kappa)}{2\\,\\Delta x}\\hat{u} = -i \\dfrac{a \\sin(\\kappa)}{\\Delta x} \\hat{u}\n$$\nThe solution to this ordinary differential equation with initial condition $\\hat{u}(\\kappa,0)=1$ is the Fourier transform of the Green's function, $\\hat{G}^{(\\mathrm{c})}(\\kappa, t)$:\n$$\n\\hat{G}^{(\\mathrm{c})}(\\kappa, t) = \\exp\\left(-i \\frac{at}{\\Delta x} \\sin(\\kappa)\\right)\n$$\nThe Green's function $G_{j}^{(\\mathrm{c})}(t)$ is its inverse Fourier transform:\n$$\nG_{j}^{(\\mathrm{c})}(t) = \\frac{1}{2\\pi} \\int_{-\\pi}^{\\pi} \\exp\\left(-i \\frac{at}{\\Delta x} \\sin(\\kappa)\\right) e^{ij\\kappa} d\\kappa = \\frac{1}{2\\pi} \\int_{-\\pi}^{\\pi} \\exp\\left(i \\left(j\\kappa - \\frac{at}{\\Delta x}\\sin(\\kappa)\\right)\\right) d\\kappa\n$$\nThis is an integral representation of the Bessel function of the first kind, $J_j(z)$, specifically $G_{j}^{(\\mathrm{c})}(t) = J_{j}\\left(\\frac{at}{\\Delta x}\\right)$.\n\n*   **Behavior Analysis**: The amplification factor $|\\hat{G}^{(\\mathrm{c})}(\\kappa, t)| = 1$ for all $\\kappa$. This means the scheme is purely non-dissipative; no energy is lost. The phase speed, however, depends on the wavenumber. The numerical dispersion relation is $\\omega(\\kappa) = \\frac{a}{\\Delta x} \\sin(\\kappa)$. Since the phase speed $c(\\kappa) = \\omega(\\kappa)/(\\kappa/\\Delta x) = a \\frac{\\sin(\\kappa)}{\\kappa}$ is not constant, the scheme is dispersive. An initial impulse spreads out into an oscillatory wave train. The symmetry of the Bessel function envelope, $|J_{-j}(z)|=|J_j(z)|$, means the amplitude of the response is symmetric about the initial impulse location ($j=0$), even as the main peak propagates. This explains the symmetric behavior. The oscillations are the characteristic \"dispersive tails.\"\n\n**2. Upwind Scheme Analysis**\nThe semi-discrete equation is $\\dfrac{du_j}{dt} = -a D_{\\mathrm{u}} u_j = -a \\dfrac{u_j - u_{j-1}}{\\Delta x}$.\nIn Fourier space:\n$$\n\\dfrac{d\\hat{u}}{dt} = -a \\dfrac{\\hat{u} - e^{-i\\kappa}\\hat{u}}{\\Delta x} = -\\frac{a}{\\Delta x}(1 - \\cos(\\kappa) + i\\sin(\\kappa))\\hat{u}\n$$\nThe solution for $\\hat{G}^{(\\mathrm{u})}(\\kappa, t)$ is:\n$$\n\\hat{G}^{(\\mathrm{u})}(\\kappa, t) = \\exp\\left(-\\frac{at}{\\Delta x}(1 - \\cos(\\kappa))\\right) \\exp\\left(-i \\frac{at}{\\Delta x} \\sin(\\kappa)\\right)\n$$\nThe Green's function $G_{j}^{(\\mathrm{u})}(t)$ is its inverse Fourier transform:\n$$\nG_{j}^{(\\mathrm{u})}(t) = \\frac{1}{2\\pi} \\int_{-\\pi}^{\\pi} \\exp\\left(-\\frac{at}{\\Delta x}(1 - e^{-i\\kappa})\\right) e^{ij\\kappa} d\\kappa\n$$\nThis integral can be solved exactly by expanding the exponential $\\exp(\\frac{at}{\\Delta x}e^{-i\\kappa})$ in a power series, yielding the Poisson distribution: $G_{j}^{(\\mathrm{u})}(t) = e^{-at/\\Delta x} \\frac{(at/\\Delta x)^j}{j!}$ for $j \\geq 0$, and $G_{j}^{(\\mathrm{u})}(t)=0$ for $j  0$.\n\n*   **Behavior Analysis**: The amplification factor is $|\\hat{G}^{(\\mathrm{u})}(\\kappa, t)| = \\exp(-\\frac{at}{\\Delta x}(1 - \\cos(\\kappa)))$. Since $1-\\cos(\\kappa) \\ge 0$, the magnitude is always less than or equal to $1$ (and strictly less than $1$ for $\\kappa \\neq 0$). This is numerical dissipation. The damping is strongest at high wavenumbers ($\\kappa = \\pm\\pi$), which suppresses grid-scale oscillations. This is why the scheme has \"damped\" tails. The asymmetry arises because the stencil $(j, j-1)$ is one-sided, making the scheme causal in space for $a0$. The solution can only propagate in the positive $j$ direction, hence $G_j^{(u)}(t)=0$ for $j0$. The response is a skewed bell-shape that travels right, very different from the symmetric oscillatory centered-scheme response.\n\n**3. Tail Analysis of the Centered Scheme**\nThe dispersive nature of the centered scheme is governed by the group velocity, $v_g = \\frac{d\\omega}{dk}$. With $\\omega(k) = \\frac{a}{\\Delta x}\\sin(k\\Delta x)$, the group velocity is:\n$$\nv_g(k) = \\frac{d}{dk}\\left(\\frac{a}{\\Delta x}\\sin(k\\Delta x)\\right) = a \\cos(k\\Delta x)\n$$\nThe velocity of propagation depends on the wavenumber $k$. The main part of the wave packet propagates at the long-wavelength speed, $v_g(0) = a$. The extent of the packet is determined by the extrema of the group velocity. The maximum is $v_{g, \\max}=a$ at $k=0$, and the minimum is $v_{g, \\min}=-a$ at $k = \\pm \\pi/\\Delta x$.\n\nThe minimum group velocity $v_g = -a$ is a spurious artifact of the numerical scheme. It indicates that energy associated with high wavenumbers ($k$ near $\\pm\\pi/\\Delta x$) propagates backwards at speed $a$. This forms the oscillatory upstream tail of the Green's function. The problem asks for the \"dominant high-frequency contribution\" to these tails. This contribution comes from the wavenumbers that travel at this extremal negative velocity. According to the stationary phase method and its extension to caustics (where $d v_g/dk = 0$), the wave structure at the leading/trailing edges of the packet is dominated by the wavenumbers for which the group velocity is extremal.\n\nThe high-frequency tails are thus associated with the wavenumber $k^{\\ast}$ that minimizes the group velocity. This occurs when $\\cos(k^{\\ast} \\Delta x) = -1$. In the principal Brillouin zone $k \\in [-\\pi/\\Delta x, \\pi/\\Delta x]$, this gives:\n$$\nk^{\\ast} \\Delta x = \\pi \\implies k^{\\ast} = \\frac{\\pi}{\\Delta x}\n$$\nThis wavenumber $k^{\\ast}$ corresponds to the highest frequency resolved by the grid. The associated wavelength is $\\lambda_{\\mathrm{tail}} = \\frac{2\\pi}{k^{\\ast}} = 2\\Delta x$. This represents a grid-scale oscillation of the form $e^{ik^{\\ast}x} = e^{i (\\pi/\\Delta x) (j \\Delta x)} = e^{ij\\pi} = (-1)^j$, which alternates sign at every grid point. This is the source of the characteristic high-frequency ripples seen in solutions from the centered difference scheme. This analysis identifies $k^{\\ast}$ as requested.",
            "answer": "$$\n\\boxed{\\frac{\\pi}{\\Delta x}}\n$$"
        },
        {
            "introduction": "We now apply our understanding to a common and practical challenge in computational physics: the simulation of waves with sharp gradients or discontinuities. This exercise focuses on the \"Gibbs phenomenon,\" where dispersive schemes produce spurious, non-physical oscillations near jumps. You will simulate the advection of a sawtooth wave using the dispersive Lax-Wendroff scheme and the dissipative first-order upwind scheme. This hands-on simulation allows you to directly observe and quantify the dispersive overshoot and validate the theoretical prediction that it is caused by high-frequency components traveling faster than the true wave speed—a property encoded in the dispersion relation .",
            "id": "3425583",
            "problem": "Consider the one-dimensional constant-coefficient linear advection equation on a periodic domain,\n$$\n\\partial_t u(x,t) + a\\,\\partial_x u(x,t) = 0,\\quad x\\in[0,1),\\ t\\ge 0,\n$$\nwith advection speed $a0$ and periodic boundary conditions. The initial condition is a zero-mean sawtooth wave given by\n$$\nu(x,0) = s(x) := x - \\lfloor x \\rfloor - \\tfrac{1}{2},\n$$\nwhich has a jump of magnitude $1$ at each integer point. You will numerically evolve this initial condition using two fully discrete finite-difference schemes on a uniform grid with $N_x$ points and periodic boundary conditions:\n\n- A second-order central scheme in the form of the classical Lax–Wendroff update,\n$$\nu_j^{n+1} = u_j^n - \\frac{\\nu}{2}\\left(u_{j+1}^n - u_{j-1}^n\\right) + \\frac{\\nu^2}{2}\\left(u_{j+1}^n - 2u_j^n + u_{j-1}^n\\right),\n$$\n- A first-order upwind scheme,\n$$\nu_j^{n+1} = u_j^n - \\nu\\left(u_j^n - u_{j-1}^n\\right),\n$$\nwhere $u_j^n$ approximates $u(x_j, t^n)$ at $x_j = j\\,\\Delta x$, $t^n = n\\,\\Delta t$, the Courant–Friedrichs–Lewy (CFL) number is $\\nu = a\\,\\Delta t/\\Delta x$, and indices are taken modulo $N_x$ to enforce periodicity.\n\nYour tasks are as follows.\n\n1. Starting from the Fourier-mode ansatz $u_j^n = \\hat{u}\\,\\exp\\!\\left(i(j\\,\\kappa - n\\,\\omega\\,\\Delta t)\\right)$ with discrete wavenumber $\\kappa \\in [0,\\pi]$, define for each scheme the fully discrete dispersion relation in terms of the amplification factor $G(\\kappa)$ satisfying\n$$\ne^{-i\\,\\omega(\\kappa)\\,\\Delta t} = G(\\kappa).\n$$\nFrom this, define the numerical phase $\\theta(\\kappa)$ as the unwrapped argument $\\theta(\\kappa) = -\\mathrm{Arg}\\,G(\\kappa)$ made continuous in $\\kappa$, and the numerical phase speed ratio\n$$\n\\rho(\\kappa) = \\frac{\\omega(\\kappa)}{a\\,k} = \\frac{\\theta(\\kappa)}{\\nu\\,\\kappa},\n$$\nwhere $k = \\kappa/\\Delta x$ is the physical wavenumber. Explain why $\\rho(\\kappa)1$ for some high $\\kappa$ indicates dispersive overshoot relative to the true phase speed.\n\n2. Evolve the sawtooth initial condition to time $T$ using each scheme with a uniform time step $\\Delta t = \\nu\\,\\Delta x/a$, taking $N_t = \\lfloor T/\\Delta t \\rfloor$ steps. Denote the numerical solution at $t^{N_t}$ by $u_j^{N_t}$. Let the advected discontinuity location be $x_\\star = (a\\,N_t\\,\\Delta t)\\ \\mathrm{mod}\\ 1$. Define a small window of $2m+1$ grid points centered at the index $j_\\star = \\mathrm{round}(x_\\star/\\Delta x)$ with $m=6$. Quantify the Gibbs-like overshoot amplitude by\n$$\n\\mathcal{O} = \\max\\big\\{0,\\, \\max_{|j-j_\\star|\\le m} u_j^{N_t} - \\tfrac{1}{2}\\big\\},\n$$\nthat is, the positive excess above the upper plateau level $\\tfrac{1}{2}$ within the window, clipped at zero if no overshoot occurs. Use no physical units; all quantities are nondimensional.\n\n3. Using the discrete dispersion relation of the Lax–Wendroff scheme, define the near-Nyquist dispersive overshoot predictor as\n$$\n\\Pi = \\max_{\\kappa\\in[\\alpha\\pi,\\pi]} \\max\\{0,\\, \\rho(\\kappa) - 1\\},\n$$\nwith $\\alpha = 0.8$. This isolates the high-wavenumber regime where spurious dispersion is most pronounced.\n\nImplement a program that:\n- Constructs the periodic grid, initializes $u(x,0)=s(x)$, advances each scheme to time $T$, computes the overshoot amplitude $\\mathcal{O}$ for each scheme, and computes the predictor $\\Pi$ for Lax–Wendroff using the unwrapped numerical phase $\\theta(\\kappa)$.\n- Uses the following test suite of parameter triples $(N_x,\\nu,T)$ with $a=1$:\n    - Case A: $(N_x,\\nu,T) = (256,\\,0.2,\\,0.2)$,\n    - Case B: $(N_x,\\nu,T) = (256,\\,0.9,\\,0.2)$,\n    - Case C: $(N_x,\\nu,T) = (64,\\,0.5,\\,0.2)$.\n- For each case, returns the triple of floats\n$$\n\\Big[\\ \\mathcal{O}_{\\mathrm{LW}},\\ \\mathcal{O}_{\\mathrm{UP}},\\ \\Pi_{\\mathrm{LW}}\\ \\Big],\n$$\nwhere $\\mathcal{O}_{\\mathrm{LW}}$ is the measured overshoot for Lax–Wendroff, $\\mathcal{O}_{\\mathrm{UP}}$ is the measured overshoot for upwind, and $\\Pi_{\\mathrm{LW}}$ is the predictor computed from the Lax–Wendroff dispersion relation. Round each reported float to $6$ decimal places.\n\nFinal output format:\n- Your program should produce a single line of output containing the results for Cases A, B, and C concatenated in order as a comma-separated list enclosed in square brackets, that is,\n$$\n[\\mathcal{O}_{\\mathrm{LW}}^{(A)},\\ \\mathcal{O}_{\\mathrm{UP}}^{(A)},\\ \\Pi_{\\mathrm{LW}}^{(A)},\\ \\mathcal{O}_{\\mathrm{LW}}^{(B)},\\ \\mathcal{O}_{\\mathrm{UP}}^{(B)},\\ \\Pi_{\\mathrm{LW}}^{(B)},\\ \\mathcal{O}_{\\mathrm{LW}}^{(C)},\\ \\mathcal{O}_{\\mathrm{UP}}^{(C)},\\ \\Pi_{\\mathrm{LW}}^{(C)}],\n$$\nwith no additional text. Each number must be rounded to $6$ decimal places as specified. This design tests a typical case, a near-stability high-Courant case, and a coarser-grid case to probe the dependence of Gibbs-like oscillations on dispersive overshoot near the Nyquist wavenumber.",
            "solution": "The problem is subjected to validation before proceeding to a solution.\n\n### Step 1: Extract Givens\n- **PDE**: One-dimensional constant-coefficient linear advection equation, $\\partial_t u(x,t) + a\\,\\partial_x u(x,t) = 0$, on a periodic domain $x\\in[0,1)$ and $t \\ge 0$.\n- **Advection Speed**: $a0$. For the numerical part, $a=1$.\n- **Initial Condition**: A zero-mean sawtooth wave, $u(x,0) = s(x) := x - \\lfloor x \\rfloor - \\tfrac{1}{2}$.\n- **Numerical Grid**: Uniform grid with $N_x$ points, spacing $\\Delta x = 1/N_x$, grid points $x_j = j\\,\\Delta x$. Time steps are uniform, $\\Delta t$, with $t^n = n\\,\\Delta t$.\n- **CFL Number**: $\\nu = a\\,\\Delta t/\\Delta x$.\n- **Lax-Wendroff (LW) Scheme**: $u_j^{n+1} = u_j^n - \\frac{\\nu}{2}\\left(u_{j+1}^n - u_{j-1}^n\\right) + \\frac{\\nu^2}{2}\\left(u_{j+1}^n - 2u_j^n + u_{j-1}^n\\right)$.\n- **Upwind (UP) Scheme**: $u_j^{n+1} = u_j^n - \\nu\\left(u_j^n - u_{j-1}^n\\right)$ (for $a0$).\n- **Fourier-Mode Ansatz**: $u_j^n = \\hat{u}\\,\\exp\\!\\left(i(j\\,\\kappa - n\\,\\omega\\,\\Delta t)\\right)$ with discrete wavenumber $\\kappa \\in [0,\\pi]$.\n- **Amplification Factor**: $G(\\kappa) = e^{-i\\,\\omega(\\kappa)\\,\\Delta t}$.\n- **Numerical Phase**: $\\theta(\\kappa) = -\\mathrm{Arg}\\,G(\\kappa)$, unwrapped and continuous in $\\kappa$.\n- **Numerical Phase Speed Ratio**: $\\rho(\\kappa) = \\frac{\\omega(\\kappa)}{a\\,k} = \\frac{\\theta(\\kappa)}{\\nu\\,\\kappa}$, where $k = \\kappa/\\Delta x$.\n- **Simulation Time**: Evolve to time $T$, taking $N_t = \\lfloor T/\\Delta t \\rfloor$ steps.\n- **Overshoot Metric ($\\mathcal{O}$)**:\n    - Advected discontinuity location: $x_\\star = (a\\,N_t\\,\\Delta t)\\ \\mathrm{mod}\\ 1$.\n    - Center index: $j_\\star = \\mathrm{round}(x_\\star/\\Delta x)$.\n    - Window half-width: $m=6$.\n    - Overshoot: $\\mathcal{O} = \\max\\big\\{0,\\, \\max_{|j-j_\\star|\\le m} u_j^{N_t} - \\tfrac{1}{2}\\big\\}$.\n- **Dispersive Overshoot Predictor ($\\Pi$)**:\n    - For the Lax-Wendroff scheme only.\n    - High-wavenumber regime: $\\kappa\\in[\\alpha\\pi,\\pi]$ with $\\alpha = 0.8$.\n    - Predictor: $\\Pi = \\max_{\\kappa\\in[\\alpha\\pi,\\pi]} \\max\\{0,\\, \\rho(\\kappa) - 1\\}$.\n- **Test Cases ($a=1$)**:\n    - Case A: $(N_x,\\nu,T) = (256,\\,0.2,\\,0.2)$\n    - Case B: $(N_x,\\nu,T) = (256,\\,0.9,\\,0.2)$\n    - Case C: $(N_x,\\nu,T) = (64,\\,0.5,\\,0.2)$\n- **Required Output**: For each case, a triple of floats $[\\mathcal{O}_{\\mathrm{LW}},\\ \\mathcal{O}_{\\mathrm{UP}},\\ \\Pi_{\\mathrm{LW}}]$ rounded to $6$ decimal places, concatenated into a single list.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is validated against the specified criteria.\n- **Scientifically Grounded**: The problem is centered on the numerical analysis of the linear advection equation, a cornerstone of computational fluid dynamics and hyperbolic PDEs. The chosen schemes (Lax-Wendroff, Upwind) are canonical methods. The analysis of numerical dispersion via Fourier analysis is a standard and rigorous technique. All concepts are well-established within mathematics and numerical science.\n- **Well-Posed**: The problem is well-posed. The PDE with periodic boundary conditions and a given initial condition has a unique solution. The numerical tasks are precisely defined, with all formulas, parameters, and procedures clearly specified, leading to a unique and computable result.\n- **Objective**: The language is formal and objective. All quantities are defined through mathematical formulas, leaving no room for subjective interpretation.\n- **Completeness and Consistency**: The problem is self-contained. All necessary parameters ($a, N_x, \\nu, T, m, \\alpha$) are provided. The definitions are internally consistent. The stability conditions for both schemes ($|\\nu|\\le 1$ for LW, $0 \\le \\nu \\le 1$ for UP) are satisfied by all test cases.\n- **No other flaws**: The problem is not metaphorical, trivial, or unverifiable.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A full solution will be provided.\n\n---\n\n### Part 1: Dispersion Relation and Phase Speed\n\nWe start by deriving the amplification factor $G(\\kappa)$ for each scheme. We substitute the Fourier mode ansatz $u_j^n = G^n(\\kappa) e^{ij\\kappa}$ into the finite difference schemes.\n\n**Lax-Wendroff Scheme**\nSubstituting the ansatz into the LW scheme gives:\n$$\nG(\\kappa)e^{ij\\kappa} = e^{ij\\kappa} - \\frac{\\nu}{2}\\left(e^{i(j+1)\\kappa} - e^{i(j-1)\\kappa}\\right) + \\frac{\\nu^2}{2}\\left(e^{i(j+1)\\kappa} - 2e^{ij\\kappa} + e^{i(j-1)\\kappa}\\right)\n$$\nDividing by $e^{ij\\kappa}$ and using Euler's identities $e^{i\\kappa}-e^{-i\\kappa} = 2i\\sin\\kappa$ and $e^{i\\kappa}+e^{-i\\kappa} = 2\\cos\\kappa$:\n$$\n\\begin{align*}\nG_{\\mathrm{LW}}(\\kappa) = 1 - \\frac{\\nu}{2}(e^{i\\kappa} - e^{-i\\kappa}) + \\frac{\\nu^2}{2}(e^{i\\kappa} - 2 + e^{-i\\kappa}) \\\\\n= 1 - i\\nu\\sin\\kappa + \\frac{\\nu^2}{2}(2\\cos\\kappa - 2) \\\\\n= 1 - \\nu^2(1 - \\cos\\kappa) - i\\nu\\sin\\kappa\n\\end{align*}\n$$\n\n**Upwind Scheme**\nSimilarly, for the first-order upwind scheme (for $a0$):\n$$\nG(\\kappa)e^{ij\\kappa} = e^{ij\\kappa} - \\nu\\left(e^{ij\\kappa} - e^{i(j-1)\\kappa}\\right)\n$$\nDividing by $e^{ij\\kappa}$:\n$$\n\\begin{align*}\nG_{\\mathrm{UP}}(\\kappa) = 1 - \\nu(1 - e^{-i\\kappa}) \\\\\n= 1 - \\nu + \\nu e^{-i\\kappa} \\\\\n= (1 - \\nu + \\nu\\cos\\kappa) - i\\nu\\sin\\kappa\n\\end{align*}\n$$\n\n**Numerical Phase Speed and Dispersive Overshoot**\nThe numerical dispersion relation is given by $\\omega(\\kappa)$, where $e^{-i\\omega(\\kappa)\\Delta t} = G(\\kappa)$. This implies $\\omega(\\kappa) = i\\ln(G(\\kappa))/\\Delta t$. The numerical phase speed is $v_p(\\kappa) = \\omega(\\kappa)/k$, where $k = \\kappa/\\Delta x$ is the physical wavenumber. The exact dispersion relation for the PDE is $\\omega_{\\mathrm{exact}}(k) = ak$, yielding a constant phase speed of $a$.\n\nThe numerical phase speed ratio $\\rho(\\kappa)$ is the ratio of the numerical phase speed to the exact phase speed:\n$$\n\\rho(\\kappa) = \\frac{v_p(\\kappa)}{a} = \\frac{\\omega(\\kappa)}{ak}\n$$\nFrom the definition $e^{-i\\omega\\Delta t} = G(\\kappa)$ and $\\theta(\\kappa) = -\\mathrm{Arg}(G(\\kappa))$, we have $-i\\omega\\Delta t = \\ln|G(\\kappa)| + i\\mathrm{Arg}(G(\\kappa)) = \\ln|G(\\kappa)| - i\\theta(\\kappa)$. Equating imaginary parts, we get $\\omega\\Delta t = \\theta(\\kappa)$. Substituting this into the expression for $\\rho(\\kappa)$:\n$$\n\\rho(\\kappa) = \\frac{\\theta(\\kappa)/\\Delta t}{a(\\kappa/\\Delta x)} = \\frac{\\theta(\\kappa)}{\\kappa(a\\Delta t/\\Delta x)} = \\frac{\\theta(\\kappa)}{\\nu\\kappa}\n$$\nThis matches the definition given in the problem.\n\nA value of $\\rho(\\kappa)  1$ indicates that the numerical solution component with wavenumber $k$ propagates faster than the true wave speed $a$. This is known as a leading phase error. A discontinuity, such as the jump in the sawtooth initial condition, is composed of a wide spectrum of Fourier modes. If high-wavenumber components (large $k$, corresponding to $\\kappa$ near the Nyquist frequency $\\pi$) travel faster than the lower-wavenumber components that constitute the bulk of the wave, they \"run ahead\" of the main profile. The superposition of these fast-moving, high-frequency modes creates spurious oscillations just ahead of the advected discontinuity. This effect is a form of the Gibbs phenomenon, termed dispersive overshoot. The metric $\\mathcal{O}$ is designed to quantify the amplitude of these leading oscillations.\n\n### Part 2  3: Numerical Implementation\nThe solution requires implementing the time evolution for both schemes and then computing the specified metrics.\n\n1.  **Initialization**: For each test case $(N_x, \\nu, T)$ with $a=1$, we define the grid spacing $\\Delta x = 1/N_x$ and time step $\\Delta t = \\nu \\Delta x/a$. The total number of steps is $N_t = \\lfloor T/\\Delta t \\rfloor$. The initial condition $u(x,0) = x - 1/2$ for $x \\in [0,1)$ is discretized on the grid $x_j=j\\Delta x$ as $u_j^0 = j\\Delta x - 1/2$.\n\n2.  **Time Evolution**: We iterate $N_t$ times. In each step, we update the numerical solutions $u_j$ for both schemes using their respective formulas. Periodicity is handled by taking indices modulo $N_x$, which is efficiently implemented using `numpy.roll`.\n\n3.  **Overshoot Calculation ($\\mathcal{O}$)**: After the final time step $t^{N_t}$, we calculate the exact position of the advected discontinuity, $x_\\star = (a N_t \\Delta t) \\pmod 1$. The nearest grid index is $j_\\star = \\mathrm{round}(x_\\star/\\Delta x)$. We find the maximum value of the numerical solution within the window of $2m+1$ points centered at $j_\\star$. The overshoot is the amount by which this maximum exceeds the upper plateau value of $1/2$, clipped at zero.\n    - The first-order upwind scheme is monotone for $\\nu \\in [0,1]$, meaning it does not create new extrema. Since the initial condition is bounded by $[-0.5, 0.5]$, the numerical solution will also remain in this range. Therefore, we expect $\\mathcal{O}_{\\mathrm{UP}} = 0$ for all test cases.\n\n4.  **Predictor Calculation ($\\Pi_{\\mathrm{LW}}$)**: For the Lax-Wendroff scheme, we compute the phase speed ratio $\\rho(\\kappa)$ over a fine discretization of $\\kappa \\in [0, \\pi]$. It is crucial to use `np.unwrap` on the phase $\\theta(\\kappa) = -\\mathrm{Arg}(G(\\kappa))$ to handle the phase jumps that occur when $G(\\kappa)$ crosses the negative real axis in the complex plane (which happens for $\\nu^2  1/2$). We then find the maximum of $\\rho(\\kappa)-1$ over the high-wavenumber range $[\\alpha\\pi, \\pi]$ and clip at zero.\n\nThe following Python code implements this procedure for the specified test cases.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the numerical advection problem for three test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (256, 0.2, 0.2),  # Case A\n        (256, 0.9, 0.2),  # Case B\n        (64, 0.5, 0.2),   # Case C\n    ]\n\n    # Global parameters\n    a = 1.0  # Advection speed\n    m = 6    # Window half-width for overshoot measurement\n    alpha = 0.8 # Lower bound for predictor wavenumber range\n\n    results = []\n    \n    for Nx, nu, T in test_cases:\n        # 1. Setup Grid, Time Step, and Initial Condition\n        dx = 1.0 / Nx\n        dt = nu * dx / a\n        Nt = int(np.floor(T / dt))\n\n        x = np.arange(Nx) * dx\n        u0 = x - np.floor(x) - 0.5\n\n        u_lw = u0.copy()\n        u_up = u0.copy()\n\n        # 2. Time Evolution Loop\n        for _ in range(Nt):\n            # Lax-Wendroff update\n            u_lw_jp1 = np.roll(u_lw, -1)\n            u_lw_jm1 = np.roll(u_lw, 1)\n            u_lw = u_lw - 0.5 * nu * (u_lw_jp1 - u_lw_jm1) + \\\n                   0.5 * nu**2 * (u_lw_jp1 - 2 * u_lw + u_lw_jm1)\n\n            # First-Order Upwind update\n            u_up_jm1 = np.roll(u_up, 1)\n            # The scheme is u_j^{n+1} = u_j^n - nu*(u_j^n - u_{j-1}^n)\n            u_up = (1 - nu) * u_up + nu * u_up_jm1\n\n        # 3. Compute Overshoot Amplitude (O)\n        t_final = Nt * dt\n        x_star = (a * t_final) % 1.0\n        j_star = int(np.round(x_star / dx))\n\n        # Create window of indices around j_star with periodic wrapping\n        window_indices = (j_star - m + np.arange(2 * m + 1)) % Nx\n\n        # Lax-Wendroff overshoot\n        max_val_lw = np.max(u_lw[window_indices])\n        O_lw = max(0.0, max_val_lw - 0.5)\n\n        # Upwind overshoot\n        max_val_up = np.max(u_up[window_indices])\n        O_up = max(0.0, max_val_up - 0.5)\n\n        # 4. Compute Dispersive Overshoot Predictor (Pi) for Lax-Wendroff\n        kappa_pts = 4096\n        kappa = np.linspace(0, np.pi, kappa_pts, endpoint=True)\n\n        # Complex amplification factor for Lax-Wendroff\n        G_lw = 1.0 + nu**2 * (np.cos(kappa) - 1.0) - 1j * nu * np.sin(kappa)\n\n        # Numerical phase (unwrapped)\n        theta_wrapped = -np.angle(G_lw)\n        theta_unwrapped = np.unwrap(theta_wrapped)\n\n        # Numerical phase speed ratio rho(kappa) = theta / (nu * kappa)\n        # Avoid division by zero at kappa=0. Analytically, rho(0)=1.\n        rho = np.ones_like(kappa)\n        non_zero_kappa_mask = kappa > 1e-9\n        kappa_nz = kappa[non_zero_kappa_mask]\n        theta_nz = theta_unwrapped[non_zero_kappa_mask]\n        rho[non_zero_kappa_mask] = theta_nz / (nu * kappa_nz)\n        \n        # Calculate predictor Pi from rho in the high-wavenumber regime\n        predictor_mask = kappa >= alpha * np.pi\n        rho_in_range = rho[predictor_mask]\n        \n        Pi_lw = np.max(np.maximum(0, rho_in_range - 1.0))\n\n        # 5. Store results for the current case, rounded to 6 decimal places\n        results.extend([\n            round(O_lw, 6),\n            round(O_up, 6),\n            round(Pi_lw, 6)\n        ])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}