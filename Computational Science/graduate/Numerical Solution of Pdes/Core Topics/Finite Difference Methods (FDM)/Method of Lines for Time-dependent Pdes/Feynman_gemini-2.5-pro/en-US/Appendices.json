{
    "hands_on_practices": [
        {
            "introduction": "The foundation of the Method of Lines lies in transforming a partial differential equation into a system of ordinary differential equations by discretizing the spatial derivatives. A crucial first step in this process is to quantify the accuracy of our chosen spatial approximation. This practice guides you through the use of Taylor series to derive the local truncation error of the standard second-order central difference formula, a cornerstone of finite difference methods . Mastering this technique provides a rigorous understanding of how the discretization error depends on the grid spacing, which is essential for developing and analyzing numerical schemes.",
            "id": "3420401",
            "problem": "In the method of lines for time-dependent partial differential equations (PDEs), a common approach is to discretize spatial derivatives while keeping time continuous, resulting in a semi-discrete system of ordinary differential equations (ODEs). Consider the spatially one-dimensional heat equation $u_{t}=\\kappa u_{xx}$, where $u=u(x,t)$ is sufficiently smooth in space and time and $\\kappa>0$ is a constant thermal diffusivity. On a uniform spatial grid with spacing $h>0$ and nodes $x_{i}=x_{0}+i h$, the standard second-order central difference operator is used to approximate the second spatial derivative at $x_{i}$ by\n$$\nD^{(2)}_{h}u(x_{i})=\\frac{u(x_{i}+h)-2\\,u(x_{i})+u(x_{i}-h)}{h^{2}}.\n$$\nUsing only the Taylor expansion of a smooth function about a point and the definition of local spatial truncation error as the difference between the discrete spatial operator applied to the exact smooth solution and the exact spatial derivative, derive the leading-order term of the truncation error for this second-order central difference approximation of $u_{xx}$ on a uniform grid. Specifically, assume $u(\\cdot,t)\\in C^{6}$ in space for each fixed $t$ and perform a Taylor expansion about $x=x_{i}$ to determine the exact constant $C$ such that\n$$\nD^{(2)}_{h}u(x_{i})-u_{xx}(x_{i})=C\\,h^{2}\\,u^{(4)}(x_{i})+\\mathcal{O}(h^{4})\n$$\nas $h\\to 0$. Provide your final answer for $C$ as a single exact rational number with no units.",
            "solution": "The problem requires the derivation of the leading-order term of the local truncation error for the standard second-order central difference approximation of the second spatial derivative, $u_{xx}$. The analysis will be performed by applying Taylor's theorem to the function $u(x,t)$ with respect to the spatial variable $x$, holding time $t$ constant. For notational simplicity, we shall write $u(x)$ to denote $u(x,t)$ for a fixed time $t$, and derivatives such as $u_{xx}$ and $u^{(k)}$ are understood to be spatial derivatives, i.e., $u^{(k)}(x) = \\frac{\\partial^k u}{\\partial x^k}(x,t)$.\n\nThe local truncation error, which we denote by $\\tau(x_i)$, is defined as the difference between the discrete operator applied to the exact solution and the exact differential operator it approximates. Specifically,\n$$\n\\tau(x_i) = D^{(2)}_{h}u(x_{i}) - u_{xx}(x_{i})\n$$\nwhere the discrete operator is given by\n$$\nD^{(2)}_{h}u(x_{i})=\\frac{u(x_{i}+h)-2u(x_{i})+u(x_{i}-h)}{h^{2}}.\n$$\nThe problem states that the solution $u$ is sufficiently smooth, specifically that for any fixed time $t$, the function $u(\\cdot, t)$ belongs to the class $C^{6}$ in the spatial variable. This assumption allows us to employ Taylor's theorem to expand $u(x_i+h)$ and $u(x_i-h)$ about the point $x_i$. The Taylor series expansions are:\n$$\nu(x_i+h) = u(x_i) + h u'(x_i) + \\frac{h^2}{2!} u''(x_i) + \\frac{h^3}{3!} u'''(x_i) + \\frac{h^4}{4!} u^{(4)}(x_i) + \\frac{h^5}{5!} u^{(5)}(x_i) + \\mathcal{O}(h^6)\n$$\n$$\nu(x_i-h) = u(x_i) - h u'(x_i) + \\frac{h^2}{2!} u''(x_i) - \\frac{h^3}{3!} u'''(x_i) + \\frac{h^4}{4!} u^{(4)}(x_i) - \\frac{h^5}{5!} u^{(5)}(x_i) + \\mathcal{O}(h^6)\n$$\nHere, $u^{(k)}(x_i)$ denotes the $k$-th derivative of $u$ with respect to $x$ evaluated at $x_i$.\n\nWe substitute these expansions into the numerator of the finite difference operator $D^{(2)}_{h}u(x_{i})$. Let us first sum the two expansions:\n$$\nu(x_i+h) + u(x_i-h) = \\left(u(x_i) + h u'(x_i) + \\frac{h^2}{2} u''(x_i) + \\frac{h^3}{6} u'''(x_i) + \\frac{h^4}{24} u^{(4)}(x_i) + \\dots\\right) + \\left(u(x_i) - h u'(x_i) + \\frac{h^2}{2} u''(x_i) - \\frac{h^3}{6} u'''(x_i) + \\frac{h^4}{24} u^{(4)}(x_i) - \\dots\\right)\n$$\nBy collecting terms of like powers of $h$, we observe that all terms with odd powers of $h$ cancel out:\n$$\nu(x_i+h) + u(x_i-h) = 2u(x_i) + 2\\frac{h^2}{2}u''(x_i) + 2\\frac{h^4}{24}u^{(4)}(x_i) + \\mathcal{O}(h^6)\n$$\n$$\nu(x_i+h) + u(x_i-h) = 2u(x_i) + h^2 u''(x_i) + \\frac{h^4}{12}u^{(4)}(x_i) + \\mathcal{O}(h^6)\n$$\nNow we can form the full numerator of the operator:\n$$\nu(x_i+h) - 2u(x_i) + u(x_i-h) = \\left(2u(x_i) + h^2 u''(x_i) + \\frac{h^4}{12}u^{(4)}(x_i) + \\mathcal{O}(h^6)\\right) - 2u(x_i)\n$$\n$$\nu(x_i+h) - 2u(x_i) + u(x_i-h) = h^2 u''(x_i) + \\frac{h^4}{12}u^{(4)}(x_i) + \\mathcal{O}(h^6)\n$$\nTo obtain the expression for $D^{(2)}_{h}u(x_i)$, we divide this result by $h^2$:\n$$\nD^{(2)}_{h}u(x_i) = \\frac{1}{h^2}\\left(h^2 u''(x_i) + \\frac{h^4}{12}u^{(4)}(x_i) + \\mathcal{O}(h^6)\\right)\n$$\n$$\nD^{(2)}_{h}u(x_i) = u''(x_i) + \\frac{h^2}{12}u^{(4)}(x_i) + \\mathcal{O}(h^4)\n$$\nThe problem uses the notation $u_{xx}(x_i)$ for $u''(x_i)$, so we can write:\n$$\nD^{(2)}_{h}u(x_i) = u_{xx}(x_i) + \\frac{h^2}{12}u^{(4)}(x_i) + \\mathcal{O}(h^4)\n$$\nFinally, we compute the local truncation error by subtracting the exact second derivative, $u_{xx}(x_i)$, from the expression for the discrete operator:\n$$\n\\tau(x_i) = D^{(2)}_{h}u(x_i) - u_{xx}(x_i) = \\left(u_{xx}(x_i) + \\frac{h^2}{12}u^{(4)}(x_i) + \\mathcal{O}(h^4)\\right) - u_{xx}(x_i)\n$$\n$$\n\\tau(x_i) = \\frac{h^2}{12}u^{(4)}(x_i) + \\mathcal{O}(h^4)\n$$\nThe problem asks for the constant $C$ in the expression:\n$$\nD^{(2)}_{h}u(x_{i})-u_{xx}(x_{i})=C\\,h^{2}\\,u^{(4)}(x_{i})+\\mathcal{O}(h^{4})\n$$\nBy comparing our derived result with this target form, we identify the constant $C$ as the coefficient of the $h^2 u^{(4)}(x_i)$ term. Therefore, the value of the constant is:\n$$\nC = \\frac{1}{12}\n$$\nThis is an exact rational number, as required.",
            "answer": "$$\\boxed{\\frac{1}{12}}$$"
        },
        {
            "introduction": "Once a PDE is semi-discretized into a system of ODEs, the next challenge is to solve this system stably and efficiently through time. This practice explores the critical link between the spatial discretization and the stability of the time integration scheme. By analyzing the eigenvalues of the discrete Laplacian for the heat equation, you will derive the famous Courant-Friedrichs-Lewy (CFL) stability condition for the Forward Euler method . This exercise illuminates the concept of stiffness, a common feature of MOL systems, and explains why explicit time-stepping methods can be prohibitively expensive for diffusion problems.",
            "id": "3420393",
            "problem": "Consider the one-dimensional heat equation $u_{t}=\\nu u_{xx}$ on the interval $(0,L)$ for $t>0$ with homogeneous Dirichlet boundary conditions $u(0,t)=0$ and $u(L,t)=0$. Let a uniform spatial grid with $N$ interior points be used, with grid spacing $h=L/(N+1)$ and nodal values $u_{i}(t)\\approx u(x_{i},t)$ at $x_{i}=ih$ for $i=1,2,\\dots,N$. The second spatial derivative is approximated by the standard second-order central difference, yielding the method-of-lines semi-discrete system\n$$\n\\frac{d\\boldsymbol{u}}{dt}=\\nu A\\boldsymbol{u},\n$$\nwhere $\\boldsymbol{u}(t)=(u_{1}(t),\\dots,u_{N}(t))^{\\top}$ and $A$ is the $N\\times N$ tridiagonal matrix corresponding to the discrete Laplacian with homogeneous Dirichlet boundary conditions.\n\nUsing only fundamental properties of linear systems and the explicit Euler method for ordinary differential equations, do the following:\n\n- Compute the full set of eigenvalues of the matrix $A$ as functions of $h$ and $N$.\n- By analyzing stability mode-by-mode for the explicit Euler time discretization applied to the semi-discrete system, deduce a sufficient time step restriction of the form $\\Delta t\\le C\\,h^{2}/\\nu$ that is independent of $N$, and identify the sharp constant $C$ obtainable from this analysis.\n\nProvide your final answer as the numerical value of $C$. No rounding is required. Do not include units in your final answer.",
            "solution": "The problem asks for two main results derived from the method-of-lines discretization of the one-dimensional heat equation, $u_{t}=\\nu u_{xx}$, on the domain $x \\in (0,L)$ with homogeneous Dirichlet boundary conditions $u(0,t)=0$ and $u(L,t)=0$. The discretization uses $N$ interior points $x_i = ih$ for $i=1, 2, \\dots, N$, with a uniform grid spacing $h=L/(N+1)$.\n\nFirst, we determine the eigenvalues of the matrix $A$ from the semi-discrete system $\\frac{d\\boldsymbol{u}}{dt}=\\nu A\\boldsymbol{u}$. The problem states that $A$ is the discrete Laplacian. The standard second-order central difference for $u_{xx}$ at an interior node $x_i$ is:\n$$\nu_{xx}(x_i, t) \\approx \\frac{u(x_{i-1}, t) - 2u(x_i, t) + u(x_{i+1}, t)}{h^2}\n$$\nThe discrete Laplacian matrix $A$ is thus $\\frac{1}{h^2}T$, where $T$ is the $N \\times N$ tridiagonal matrix:\n$$\nT = \\begin{pmatrix} -2 & 1 & 0 & \\cdots & 0 \\\\ 1 & -2 & 1 & & 0 \\\\ 0 & 1 & \\ddots & \\ddots & \\vdots \\\\ \\vdots & & \\ddots & -2 & 1 \\\\ 0 & \\cdots & & 1 & -2 \\end{pmatrix}\n$$\nTo find the eigenvalues of $A$, we first find the eigenvalues of $T$. Let $\\lambda_T$ be an eigenvalue of $T$ and $\\boldsymbol{v}=(v_1, \\dots, v_N)^\\top$ be its corresponding eigenvector. The eigenvalue problem $T\\boldsymbol{v} = \\lambda_T \\boldsymbol{v}$ can be written component-wise as:\n$$\nv_{j-1} - 2v_j + v_{j+1} = \\lambda_T v_j \\quad \\text{for } j=1, \\dots, N,\n$$\nwith the boundary conditions $v_0 = 0$ and $v_{N+1} = 0$. This is a second-order linear homogeneous difference equation. Seeking solutions of the form $v_j = \\sin(j\\theta)$ and substituting into the equation and applying boundary conditions yields the requirement that $\\sin((N+1)\\theta) = 0$. This implies $(N+1)\\theta = k\\pi$ for integers $k=1, 2, \\dots, N$. The eigenvalues of $T$ are then found to be:\n$$\n\\lambda_{T,k} = 2\\cos\\left(\\frac{k\\pi}{N+1}\\right) - 2 = -4\\sin^2\\left(\\frac{k\\pi}{2(N+1)}\\right).\n$$\nThe eigenvalues $\\lambda_k$ of the matrix $A = \\frac{1}{h^2}T$ are therefore:\n$$\n\\lambda_k = -\\frac{4}{h^2}\\sin^2\\left(\\frac{k\\pi}{2(N+1)}\\right) \\quad \\text{for } k=1, 2, \\dots, N.\n$$\nThis completes the first part of the problem.\n\nNext, we analyze the stability of the explicit Euler method applied to the semi-discrete system $\\frac{d\\boldsymbol{u}}{dt}=\\nu A\\boldsymbol{u}$. The time-stepping scheme is:\n$$\n\\boldsymbol{u}^{n+1} = \\boldsymbol{u}^n + \\Delta t (\\nu A \\boldsymbol{u}^n) = (I + \\nu \\Delta t A)\\boldsymbol{u}^n.\n$$\nThe scheme is stable if the spectral radius of the amplification matrix $G = I + \\nu \\Delta t A$ is less than or equal to $1$. The eigenvalues of $G$, denoted by $\\mu_k$, are related to the eigenvalues of $A$ by $\\mu_k = 1 + \\nu \\Delta t \\lambda_k$. The stability condition is $|\\mu_k| \\le 1$ for all $k=1, \\dots, N$.\nSubstituting the expression for $\\lambda_k$:\n$$\n\\mu_k = 1 - \\frac{4\\nu \\Delta t}{h^2}\\sin^2\\left(\\frac{k\\pi}{2(N+1)}\\right).\n$$\nSince $\\nu, \\Delta t, h^2$ are positive, all $\\lambda_k$ are real and negative. Thus, $\\mu_k \\le 1$ is always true. The stability condition reduces to $\\mu_k \\ge -1$:\n$$\n1 - \\frac{4\\nu \\Delta t}{h^2}\\sin^2\\left(\\frac{k\\pi}{2(N+1)}\\right) \\ge -1\n$$\n$$\n\\frac{4\\nu \\Delta t}{h^2}\\sin^2\\left(\\frac{k\\pi}{2(N+1)}\\right) \\le 2\n$$\n$$\n\\Delta t \\le \\frac{2h^2}{4\\nu \\sin^2\\left(\\frac{k\\pi}{2(N+1)}\\right)} = \\frac{h^2}{2\\nu\\sin^2\\left(\\frac{k\\pi}{2(N+1)}\\right)}.\n$$\nThis inequality must hold for all modes, i.e., for all $k=1, \\dots, N$. The most restrictive condition is imposed by the mode that maximizes the term $\\sin^2\\left(\\frac{k\\pi}{2(N+1)}\\right)$ in the denominator. The argument $\\frac{k\\pi}{2(N+1)}$ lies in the interval $(0, \\pi/2)$ for all $k \\in \\{1,\\dots,N\\}$. Since $\\sin(x)$ is increasing on $[0, \\pi/2]$, the maximum value occurs at the largest possible value of $k$, which is $k=N$.\nThis gives the stability condition:\n$$\n\\Delta t \\le \\frac{h^2}{2\\nu\\sin^2\\left(\\frac{N\\pi}{2(N+1)}\\right)}.\n$$\nThe problem asks for a sufficient condition of the form $\\Delta t\\le C\\,h^{2}/\\nu$ where the constant $C$ is independent of $N$. This condition must be valid for all $N \\ge 1$. Therefore, we must have:\n$$\nC \\le \\inf_{N \\ge 1} \\left\\{ \\frac{1}{2\\sin^2\\left(\\frac{N\\pi}{2(N+1)}\\right)} \\right\\}.\n$$\nThe argument of the sine function, $x_N = \\frac{N\\pi}{2(N+1)} = \\frac{\\pi}{2}\\left(1-\\frac{1}{N+1}\\right)$, is a monotonically increasing sequence that converges to $\\pi/2$ from below as $N \\to \\infty$. Since $\\sin^2(x)$ is increasing on $[0, \\pi/2]$, the denominator $2\\sin^2(x_N)$ is an increasing function of $N$. Consequently, the term $\\frac{1}{2\\sin^2(x_N)}$ is a decreasing function of $N$. The infimum is the limit as $N \\to \\infty$:\n$$\n\\inf_{N \\ge 1} \\left\\{ \\frac{1}{2\\sin^2\\left(\\frac{N\\pi}{2(N+1)}\\right)} \\right\\} = \\lim_{N \\to \\infty} \\frac{1}{2\\sin^2\\left(\\frac{N\\pi}{2(N+1)}\\right)} = \\frac{1}{2\\sin^2(\\pi/2)} = \\frac{1}{2(1)^2} = \\frac{1}{2}.\n$$\nThe sharpest (largest) possible constant $C$ that is independent of $N$ is this infimum. Any value $C > 1/2$ would violate the stability condition for a sufficiently large $N$. Thus, the sharp constant is $C = 1/2$.",
            "answer": "$$\n\\boxed{\\frac{1}{2}}\n$$"
        },
        {
            "introduction": "Theoretical analysis of accuracy and stability provides essential predictions about a numerical method's behavior, but these predictions must be confirmed through computational experiments. This practice guides you in designing and implementing a grid refinement study to numerically verify the theoretical convergence rate of your spatial discretization. By leveraging a special initial condition that allows for the exact integration of the semi-discrete system, you can isolate the spatial error and observe how it decreases as the grid is refined . This hands-on exercise is fundamental to building confidence in a numerical simulation and validating that the code works as intended.",
            "id": "3420375",
            "problem": "Consider the one-dimensional heat equation on the closed interval $[0,1]$ with homogeneous Dirichlet boundary conditions and a smooth initial condition. The governing partial differential equation (PDE) is\n$$\n\\frac{\\partial u}{\\partial t}(x,t) = \\alpha \\frac{\\partial^2 u}{\\partial x^2}(x,t), \\quad x \\in (0,1), \\quad t \\ge 0,\n$$\nwith boundary conditions\n$$\nu(0,t) = 0, \\quad u(1,t) = 0,\n$$\nand initial condition\n$$\nu(x,0) = \\sin(\\pi x).\n$$\nAssume the thermal diffusivity parameter is $\\alpha = 1$ in dimensionless units. The exact solution of the PDE under these conditions is\n$$\nu(x,t) = \\sin(\\pi x)\\, e^{-\\pi^2 t}.\n$$\nUsing the method of lines (MOL), discretize only the spatial domain to produce a semi-discrete system of ordinary differential equations. Use a uniform grid of $N$ interior points with spacing $h = \\frac{1}{N+1}$ and second-order centered finite differences to approximate the spatial derivative operator. Denote the resulting discrete Laplacian operator by the matrix $A_h \\in \\mathbb{R}^{N \\times N}$ and the semi-discrete system by\n$$\n\\frac{d \\mathbf{u}(t)}{dt} = A_h \\mathbf{u}(t), \\quad \\mathbf{u}(0) = \\mathbf{u}_0,\n$$\nwhere $\\mathbf{u}(t)$ approximates $u(x_i,t)$ at grid points $x_i = i h$ for $i = 1,2,\\ldots,N$. Integrate this semi-discrete system exactly in time to isolate spatial error; that is, compute\n$$\n\\mathbf{u}(T) = e^{T A_h} \\mathbf{u}_0\n$$\nby leveraging the fact that the chosen initial condition produces a discrete eigenvector under the centered-difference Laplacian for homogeneous Dirichlet boundary conditions. The continuous reference solution at the grid points is\n$$\n\\mathbf{u}_{\\text{ref}}(T)_i = \\sin(\\pi x_i)\\, e^{-\\pi^2 T}.\n$$\nDefine the discrete $L^2$ error at final time $T$ as\n$$\nE_h(T) = \\left( h \\sum_{i=1}^N \\left(\\mathbf{u}(T)_i - \\mathbf{u}_{\\text{ref}}(T)_i\\right)^2 \\right)^{1/2}.\n$$\nYour task is to design and execute a grid refinement study that isolates the spatial discretization error by using the analytically integrated semi-discrete system described above. Derive, justify, and predict the observed convergence rate in $h$ for the discrete $L^2$ error when $N$ is doubled (that is, when $h$ is halved). Then, implement a program that computes the empirical convergence rate between successive grid refinements.\n\nTest suite parameters:\n- Use three final times $T \\in \\{0.1,\\; 1.0,\\; 10.0\\}$.\n- For each $T$, use the sequence of interior grid sizes $N \\in \\{15,\\; 31,\\; 63,\\; 127\\}$ so that the grid spacing halves exactly between successive $N$ values because $h = \\frac{1}{N+1}$.\n- For each $T$, compute the errors $E_{h_k}(T)$ for $k = 1,2,3,4$ and the empirical convergence rates\n$$\np_k = \\frac{\\log\\left(E_{h_k}(T) / E_{h_{k+1}}(T)\\right)}{\\log\\left(h_k / h_{k+1}\\right)}, \\quad k = 1,2,3.\n$$\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The output format must be the list of three lists, one per $T$, where each inner list contains the three empirical convergence rates $p_k$ for that $T$, in the order of successive grid refinements. For example,\n$$\n[ [p_1(T_1), p_2(T_1), p_3(T_1)], [p_1(T_2), p_2(T_2), p_3(T_2)], [p_1(T_3), p_2(T_3), p_3(T_3)] ].\n$$\nAll numerical results must be reported as floating-point values without units.",
            "solution": "The expected convergence rate is 2. The spatial derivative is approximated using a second-order centered finite difference scheme, which has a local truncation error of order $O(h^2)$. Since the semi-discrete system is solved exactly in time, the global error is determined solely by the spatial discretization. For a stable and consistent scheme like this, the global error order matches the local truncation error order. Therefore, the discrete $L^2$ error, $E_h(T)$, is expected to behave as $E_h(T) \\approx C h^2$. The empirical convergence rate $p$, calculated with grid halving ($h_{k+1} = h_k/2$), is thus:\n$$\np_k = \\frac{\\log(E_{h_k} / E_{h_{k+1}})}{\\log(h_k / h_{k+1})} \\approx \\frac{\\log((C h_k^2) / (C (h_k/2)^2))}{\\log(2)} = \\frac{\\log(4)}{\\log(2)} = 2\n$$\nThe numerical implementation follows from the Method of Lines. The PDE $\\frac{\\partial u}{\\partial t} = \\frac{\\partial^2 u}{\\partial x^2}$ is semi-discretized to $\\frac{d\\mathbf{u}(t)}{dt} = A_h \\mathbf{u}(t)$, where $A_h$ is the matrix for the second-order centered difference operator on a grid with spacing $h$. The initial condition $u(x,0) = \\sin(\\pi x)$ corresponds to the first eigenvector of $A_h$. The discrete initial condition is $\\mathbf{u}_0$, with components $(\\mathbf{u}_0)_i = \\sin(\\pi i h)$.\n\nSince $\\mathbf{u}_0$ is an eigenvector of $A_h$ with corresponding eigenvalue $\\lambda_1$, the exact solution of the semi-discrete system is $\\mathbf{u}(T) = e^{T A_h} \\mathbf{u}_0 = e^{T \\lambda_1} \\mathbf{u}_0$. The eigenvalue $\\lambda_1$ of $A_h$ is given by:\n$$\n\\lambda_1 = \\frac{2}{h^2}(\\cos(\\pi h) - 1) = -\\frac{4}{h^2} \\sin^2\\left(\\frac{\\pi h}{2}\\right)\n$$\nThe reference solution at the grid points is $\\mathbf{u}_{\\text{ref}}(T)_i = \\sin(\\pi x_i) e^{-\\pi^2 T}$. The error vector components are $(\\mathbf{u}(T) - \\mathbf{u}_{\\text{ref}}(T))_i = (e^{T \\lambda_1} - e^{-\\pi^2 T})\\sin(\\pi x_i)$. The discrete $L^2$ error is $E_h(T) = \\left( h \\sum_{i=1}^N \\left(\\mathbf{u}(T)_i - \\mathbf{u}_{\\text{ref}}(T)_i\\right)^2 \\right)^{1/2}$. This expression simplifies because $\\sum_{i=1}^N \\sin^2(\\frac{\\pi i}{N+1}) = \\frac{N+1}{2}$, which leads to $h \\sum \\sin^2(\\pi x_i) = \\frac{1}{2}$.\nThe error can then be calculated directly without summation:\n$$\nE_h(T) = \\frac{1}{\\sqrt{2}} |e^{T \\lambda_1} - e^{-\\pi^2 T}|\n$$\nThe numerical procedure involves calculating this error $E_{h_k}(T)$ for the sequence of grid sizes $N_k$, and then using these errors to compute the empirical convergence rates $p_k$. This is repeated for each specified final time $T$.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Performs a grid refinement study for the 1D heat equation using the method of lines\n    with an exact time integrator to isolate spatial discretization error.\n    \"\"\"\n    T_values = [0.1, 1.0, 10.0]\n    N_values = [15, 31, 63, 127]\n\n    all_results = []\n\n    for T in T_values:\n        errors = []\n        for N in N_values:\n            # h: grid spacing\n            h = 1.0 / (N + 1)\n            \n            # Eigenvalue of the discrete Laplacian for the first mode (sin(pi*x))\n            lambda_1 = -4.0 / h**2 * np.sin(np.pi * h / 2.0)**2\n            \n            # The numerical solution uses exp(T*lambda_1) while the exact PDE solution\n            # uses exp(-T*pi^2). The error norm simplifies analytically.\n            error_factor = np.abs(np.exp(T * lambda_1) - np.exp(-T * np.pi**2))\n            \n            # The discrete L2 norm of the spatial error simplifies to this expression\n            error = error_factor / np.sqrt(2.0)\n            \n            errors.append(error)\n\n        # Compute empirical convergence rates\n        # p_k = log(E_k / E_{k+1}) / log(h_k / h_{k+1})\n        # Since h_{k+1} = h_k / 2, the denominator is log(2).\n        rates = []\n        for k in range(len(errors) - 1):\n            if errors[k+1] > 0:\n                rate = np.log(errors[k] / errors[k+1]) / np.log(2.0)\n            else:\n                rate = 0.0 # Should not happen in this problem\n            rates.append(rate)\n        \n        all_results.append(rates)\n\n    # Print the final result in the format: [[rates_T1], [rates_T2], [rates_T3]]\n    print(all_results)\n\nsolve()\n\n```"
        }
    ]
}