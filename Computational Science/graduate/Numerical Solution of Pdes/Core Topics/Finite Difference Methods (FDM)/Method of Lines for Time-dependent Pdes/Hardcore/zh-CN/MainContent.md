## 引言
瞬态[偏微分方程](@entry_id:141332)（PDEs）是描述自然界和工程领域中各种动态过程的基础数学模型，从热量[扩散](@entry_id:141445)、波的传播到[流体运动](@entry_id:182721)，无处不在。然而，直接求解这些同时涉及空间和时间演化的方程往往极其复杂。为了应对这一挑战，数值方法提供了一系列强大的工具，其中，“线方法”（Method of Lines, MOL）因其概念上的清晰性和实施上的灵活性而脱颖而出，成为计算科学中的一个基石性策略。线方法巧妙地将一个复杂的时空耦合问题分解为两个更易于管理的独立步骤：空间离散和时间积分，从而架起了[偏微分方程理论](@entry_id:189232)与成熟的常微分方程（ODE）数值解法之间的桥梁。

尽管其思想直观，但线方法的成功应用依赖于对其中关键环节的深刻理解：如何构造一个忠实反映原物理问题的[半离散系统](@entry_id:754680)？如何处理由此产生的[数值刚性](@entry_id:752836)问题？以及如何在精度、稳定性和计算效率之间做出最佳权衡？本文旨在系统性地回答这些问题，为读者提供一个关于线方法的全面指南。

在接下来的内容中，我们将分三个核心部分展开：第一章“原理与机制”将深入剖析线方法的核心思想，包括[半离散化](@entry_id:163562)过程、离散算子的性质、刚性来源及[误差分析](@entry_id:142477)。第二章“应用与交叉学科联系”将展示线方法如何灵活应用于处理不同类型的PDE、复杂边界条件，并与IMEX、结构保持积分等高级时间积分策略相结合，解决前沿科学问题。最后，在“动手实践”部分，您将通过具体的编程练习，亲手实现和验证线方法的关键概念，将理论知识转化为实践能力。让我们首先从线方法的基本原理出发，开启这段探索之旅。

## 原理与机制

本章旨在深入探讨求解瞬态[偏微分方程](@entry_id:141332)（PDE）的“线方法”（Method of Lines, MOL）的核心原理与内在机制。线方法是一种强大而灵活的策略，其本质在于将一个复杂的[偏微分方程](@entry_id:141332)[问题分解](@entry_id:272624)为两个相对更易于处理的子问题：一个空间离散问题和一个时间演化问题。通过系统地阐释其基本原理、[半离散系统](@entry_id:754680)的构造与性质、[误差分析](@entry_id:142477)以及更深层次的理论，本章将为您构建一个关于线方法的坚实理论框架。

### 基本原理：[半离散化](@entry_id:163562)

线方法的核心思想是将一个或多个空间维度和一个时间维度上的[偏微分方程](@entry_id:141332)，通过仅对空间变量进行离散化，转化为一个只含时间变量的[一阶常微分方程](@entry_id:264241)（ODE）组。这个过程被称为**[半离散化](@entry_id:163562)**（semi-discretization），因为它只处理了一部分[自变量](@entry_id:267118)（空间变量），而保留了另一部分（时间变量）的连续性。

考虑一个一般的瞬态[偏微分方程](@entry_id:141332)，其形式可以写作：
$$
\frac{\partial u(\mathbf{x}, t)}{\partial t} = \mathcal{L}u(\mathbf{x}, t) + \mathcal{N}(u(\mathbf{x}, t))
$$
其中 $u(\mathbf{x}, t)$ 是待求的解，$\mathbf{x}$ 是空间坐标， $t$ 是时间。$\mathcal{L}$ 是一个作用于空间变量的[线性微分算子](@entry_id:174781)（例如[拉普拉斯算子](@entry_id:146319) $\nabla^2$），而 $\mathcal{N}$ 代表[非线性](@entry_id:637147)项。

线方法的实施步骤如下 ：
1.  **[空间离散化](@entry_id:172158)**：首先，我们在空间域 $\Omega$ 上定义一个网格，并选择一个有限维的函数空间 $V_h$ 来逼近真实的[解空间](@entry_id:200470)。这个近似解 $u_h(\mathbf{x}, t)$ 可以表示为一组空间[基函数](@entry_id:170178) $\phi_j(\mathbf{x})$ 和一组仅依赖于时间的未知系数 $U_j(t)$ 的[线性组合](@entry_id:154743)：
    $$
    u_h(\mathbf{x}, t) = \sum_{j=1}^{m} U_j(t) \phi_j(\mathbf{x})
    $$
    这里的 $m$ 是空间离散的自由度总数。

2.  **导出ODE系统**：接下来，我们将近似解 $u_h$ 代入原PDE，并利用某种投影方法（如[伽辽金法](@entry_id:749698)、[配置法](@entry_id:142690)或有限差分法）来消除对空间变量的依赖。例如，在一个伽辽金框架中，我们要求近似解的残差与所有[基函数](@entry_id:170178)正交。这一过程最终会产生一个关于未知系数向量 $U(t) = [U_1(t), \dots, U_m(t)]^T$ 的[一阶常微分方程组](@entry_id:635184)：
    $$
    M_h \frac{dU(t)}{dt} = L_h U(t) + N_h(U(t)) + b_h(t)
    $$
    在这个系统中：
    *   $M_h$ 是**质量矩阵**（mass matrix），通常由[基函数](@entry_id:170178)的[内积](@entry_id:158127)（例如，在[有限元法](@entry_id:749389)中，$M_{ij} = \int_{\Omega} \phi_i \phi_j d\mathbf{x}$）产生。对于[有限差分法](@entry_id:147158)或谱[配置法](@entry_id:142690)，[质量矩阵](@entry_id:177093)通常是单位矩阵 $I$。
    *   $L_h$ 是**[刚度矩阵](@entry_id:178659)**（stiffness matrix），是线性算子 $\mathcal{L}$ 在离散基上的矩阵表示。
    *   $N_h(U(t))$ 是非线性算子 $\mathcal{N}$ 离散化后得到的向量函数。
    *   $b_h(t)$ 是一个向量，包含了边界条件和任何[源项](@entry_id:269111)的贡献。

3.  **标准化**：如果[质量矩阵](@entry_id:177093) $M_h$ 是可逆的（通常如此），我们可以将其移到方程右侧，得到一个[标准形式](@entry_id:153058)的ODE[初值问题](@entry_id:144620)：
    $$
    \frac{dU(t)}{dt} = F(U(t), t), \quad U(0) = U_0
    $$
    其中 $F(U(t), t) = M_h^{-1}(L_h U(t) + N_h(U(t)) + b_h(t))$。

至此，[半离散化](@entry_id:163562)过程完成。我们将一个无限维的PDE问题成功转化为了一个有限维的ODE系统。这个系统的维度 $m$ 取决于空间离散的精细程度。随后，我们可以应用任何成熟的常微分方程[数值积分方法](@entry_id:141406)（如[龙格-库塔法](@entry_id:140014)、[线性多步法](@entry_id:139528)等）来求解这个ODE系统，从而得到解在各个离散点上随时间的演化。这种先空间、后时间的[解耦](@entry_id:637294)策略，是线方法强大功能与广泛应用的基石。

### 构造[半离散系统](@entry_id:754680)

成功应用线方法的前提是构造一个能够忠实反映原PDE性质的[半离散系统](@entry_id:754680)。这不仅涉及选择合适的空间离散格式，还包括如何处理初始条件、理解离散算子的特性以及应对[非线性](@entry_id:637147)等关键问题。

#### [初始条件](@entry_id:152863)的离散化

从连续的初始条件 $u(\mathbf{x}, 0) = u_0(\mathbf{x})$ 得到离散的初始向量 $U(0)$ 是[半离散化](@entry_id:163562)的第一步，而这一步的选择对解的精度至关重要 。不同的空间离散方法对应着不同的初始化策略：

*   **节点采样（Nodal Sampling）**：在节点型方法（如[有限差分法](@entry_id:147158)或谱[配置法](@entry_id:142690)）中，最直接的方式是在网格节点 $x_j$ 上直接采样：$U_j(0) = u_0(x_j)$。这种方法在 $t=0$ 时刻的节点误差为零。然而，从这些离散点重构出的[连续函数](@entry_id:137361) $u_h(x,0)$ 与真实的 $u_0(x)$ 之间存在[插值误差](@entry_id:139425)，其误差阶数由所用重构方法（如分片[线性插值](@entry_id:137092)）的精度决定。

*   **$L^2$ 投影（$L^2$ Projection）**：在伽辽金[有限元法](@entry_id:749389)（FEM）中，更精确的初始化方法是进行 $L^2$ 投影。这需要[求解线性系统](@entry_id:146035) $M U(0) = B$，其中 $B_j = \int_{\Omega} u_0(x) \phi_j(x) dx$。$L^2$ 投影能够在有限元空间 $V_h$ 中给出 $u_0(x)$ 的最佳 $L^2$ 范数逼近。对于使用 $p$ 次多项式的有限元，如果 $u_0$ 足够光滑（例如属于[Sobolev空间](@entry_id:141995) $H^{p+1}$），该投影误差可以达到最优的 $\mathcal{O}(h^{p+1})$ 阶。

*   **单元平均（Cell Averaging）**：在有限体积法（FVM）中，[离散变量](@entry_id:263628) $U_i(t)$ 代表解在控制体 $C_i$ 上的平均值。因此，最自然的初始化方式是计算初始数据在每个单元上的精确平均值：$U_i(0) = \frac{1}{|C_i|} \int_{C_i} u_0(x) dx$。如果为了简便而采用单元[中心点](@entry_id:636820)采样 $U_i(0) = u_0(x_i)$，对于光滑的 $u_0$，这会引入一个与单元平均值相差 $\mathcal{O}(h^2)$ 的初始误差。这个误差虽然对于一个一阶或二阶格式可能是可接受的，但它会成为更[高阶格式](@entry_id:150564)的瓶颈，限制其达到设计精度。

#### 空间算子的性质比较

不同的空间离散方法会产生性质迥异的半离散算子，这些性质（如对称性、守恒性和精度）直接影响着解的长期行为和整体准确性。以一维周期性区域上的热传导方程 $u_t = \kappa u_{xx}$ 为例，我们可以比较几种常见方法的离散算子 $A_h$ ：

*   **中心[有限差分法](@entry_id:147158)（FDM）**：使用标准的[二阶中心差分](@entry_id:170774)近似 $u_{xx}$，得到的离散算子 $A_h$ 是一个实对称的[循环矩阵](@entry_id:143620)。它的所有[特征值](@entry_id:154894)均为非正实数，反映了[扩散过程](@entry_id:170696)的耗散性。此外，矩阵的行和为零，这意味着离散解的总和（或平均值）在时间上是守恒的，这与连续方程 $\int u_t dx = \kappa \int u_{xx} dx = 0$ 的性质一致。该方法的空间[截断误差](@entry_id:140949)为 $\mathcal{O}(h^2)$。

*   **[有限体积法](@entry_id:749372)（FVM）**：对于此特定问题，采用单元中心格式和[两点通量近似](@entry_id:756263)，所得到的离散系统与中心[有限差分法](@entry_id:147158)完全相同。因此，它也共享了对称性、守恒性和二阶精度的所有特性。

*   **[傅里叶谱方法](@entry_id:749538)（Fourier Spectral Method）**：若采用傅里叶-[伽辽金法](@entry_id:749698)，解被表示为傅里叶级数。在[傅里叶基](@entry_id:201167)下，微分算子 $\kappa \partial_{xx}$ 变成[对角算子](@entry_id:262993)，其[特征值](@entry_id:154894)为 $-\kappa k^2$（其中 $k$ 是[波数](@entry_id:172452)）。这使得[半离散系统](@entry_id:754680)成为一组完全解耦的标量ODE。该方法同样精确地保持平均值守恒（对应于 $k=0$ 的模式），并且对于光滑解，它能达到**谱精度**（spectral accuracy），即误差衰减速度快于任何多项式阶。

#### 离散系统的结构

[半离散化](@entry_id:163562)产生的矩阵（如 $M_h$ 和 $L_h$）的结构是决定[计算效率](@entry_id:270255)的关键。幸运的是，对于由局部差分格式（如有限差分、有限元）产生的系统，这些矩阵通常是**稀疏**的。

以[二维热方程](@entry_id:746155) $u_t = \kappa(u_{xx} + u_{yy})$ 在矩形区域上的离散化为例，若采用标准的五点差分格式来近似拉普拉斯算子，并仅考虑 $N_x \times N_y$ 个内部节点，则[半离散系统](@entry_id:754680) $U' = A U$ 的维度为 $N_x N_y$。矩阵 $A$ 的每一行对应一个内部节点，该行中的非零元仅出现在与中心节点自身及其上、下、左、右四个邻居对应的列上。因此，一个内部节点最多贡献5个非零元。考虑到边界节点邻居更少，可以精确计算出矩阵 $A$ 的非零元总数为 $5N_x N_y - 2N_x - 2N_y$ 。这种稀疏性——非零元数量与矩阵维度成线性关系，而非平方关系——是高效存储和求解大规模线方法系统的基础。若采用字典序对节点编号，矩阵 $A$ 还会呈现出特定的块三对角结构。

#### [非线性](@entry_id:637147)问题与雅可比矩阵

当处理[非线性PDE](@entry_id:202123)时，[半离散系统](@entry_id:754680) $U'(t) = F(U(t))$ 也是[非线性](@entry_id:637147)的。这给[时间积分](@entry_id:267413)带来了新的挑战，特别是当使用**[隐式时间积分](@entry_id:171761)法**时。例如，[隐式欧拉法](@entry_id:176177)需要求解如下的[非线性](@entry_id:637147)代数方程组来得到下一时刻的解 $U^{n+1}$：
$$
U^{n+1} = U^n + \Delta t F(U^{n+1})
$$
求解这类方程通常依赖于牛顿法或其变种，而[牛顿法](@entry_id:140116)的核心是计算和求解包含**[雅可比矩阵](@entry_id:264467)** $J(U) = \frac{\partial F}{\partial U}$ 的线性系统。

[雅可比矩阵](@entry_id:264467)的 $ij$ 元定义为 $J_{ij}(U) = \frac{\partial F_i(U)}{\partial U_j}$。与离散算子本身一样，雅可比矩阵的[稀疏性](@entry_id:136793)也由空间离散格式的局部性决定 。如果第 $i$ 个分量 $F_i(U)$ 仅依赖于节点 $i$ 及其最近邻的节点值（例如 $U_{i-1}, U_i, U_{i+1}$），那么雅可比矩阵的第 $i$ 行将只在 $j=i-1, i, i+1$ 这几列上可能有非零元。因此，对于一维最近邻耦合问题，[雅可比矩阵](@entry_id:264467)是三对角的。这种从空间算子的局部性到[雅可比矩阵](@entry_id:264467)[稀疏性](@entry_id:136793)的继承，对于高效实现隐式方法至关重要。

### [半离散系统](@entry_id:754680)的刚性

通过线方法将PDE（特别是抛物型或某些双曲型）[半离散化](@entry_id:163562)后，得到的ODE系统通常具有一个显著特征：**刚性**（stiffness）。[刚性ODE系统](@entry_id:635093)是指系统中包含多个时间尺度，并且这些尺度差异悬殊。在数值求解时，为了维持稳定性，显式积分方法的步长必须由系统中最快的尺度（即衰减最快的模式）决定，即便我们可能只关心慢尺度（变化缓慢的模式）的演化。

[半离散系统](@entry_id:754680)的刚性源于空间离散算子引入的多种空间模式。高频空间模式（在网格尺度上剧烈[振荡](@entry_id:267781)的模式）通常对应着快速衰减的时间尺度，而低频空间模式（大尺度、平滑的模式）则对应着缓慢演变的时间尺度。

我们可以通过[半离散系统](@entry_id:754680)雅可比矩阵的**刚性比**（stiffness ratio）来量化刚性程度，其定义为最大与[最小特征值](@entry_id:177333)模之比：
$$
\kappa = \frac{|\lambda_{\max}|}{|\lambda_{\min}|}
$$
以[一维热方程](@entry_id:175487) $u_t = \nu u_{xx}$ 在 $[0,1]$ 区间上的[半离散化](@entry_id:163562)为例 ，其[雅可比矩阵](@entry_id:264467)为 $J = \nu A_h$，其中 $A_h$ 是[离散拉普拉斯算子](@entry_id:634690)。通过求解特征值问题，我们发现 $A_h$ 的 $N$ 个[特征值](@entry_id:154894)为：
$$
\lambda_k = -\frac{4}{h^2} \sin^2\left(\frac{k\pi}{2(N+1)}\right), \quad k = 1, 2, \dots, N
$$
其中 $h = 1/(N+1)$ 是空间步长。所有[特征值](@entry_id:154894)均为负实数，反映了[扩散](@entry_id:141445)的耗散特性。

*   最小模[特征值](@entry_id:154894)对应 $k=1$（最平滑的模式），其模值 $|\lambda_{\min}| = \frac{4}{h^2} \sin^2(\frac{\pi h}{2}) \approx \frac{4}{h^2} (\frac{\pi h}{2})^2 = \pi^2$。这个时间尺度 $\tau_{\text{slow}} \sim 1/|\lambda_{\min}|$ 是 $\mathcal{O}(1)$ 的，与物理[扩散时间](@entry_id:274894)相符。
*   [最大模](@entry_id:195246)[特征值](@entry_id:154894)对应 $k=N$（[振荡](@entry_id:267781)最剧烈的模式），其模值 $|\lambda_{\max}| = \frac{4}{h^2} \sin^2(\frac{N\pi}{2(N+1)}) = \frac{4}{h^2} \cos^2(\frac{\pi h}{2}) \approx \frac{4}{h^2}$。这个时间尺度 $\tau_{\text{fast}} \sim 1/|\lambda_{\max}|$ 是 $\mathcal{O}(h^2)$ 的。

因此，刚性比为：
$$
\kappa = \frac{|\lambda_{\max}|}{|\lambda_{\min}|} = \cot^2\left(\frac{\pi}{2(N+1)}\right) \approx \frac{4(N+1)^2}{\pi^2} = \mathcal{O}\left(\frac{1}{h^2}\right)
$$
这个结果表明，随着空间网格的加密（$h \to 0$），系统变得越来越刚硬。对于[显式时间积分](@entry_id:165797)法，其[稳定区域](@entry_id:166035)是有限的，稳定性要求时间步长 $\Delta t$ 满足 $|\Delta t \lambda_{\max}| \le C$，即 $\Delta t = \mathcal{O}(h^2)$。这意味着，为了保证[数值稳定性](@entry_id:146550)，时间步长必须随着空间步长的平方而减小，这是一个非常苛刻的限制。理解和处理刚性是线方法应用中的一个核心挑战。

### [误差分析](@entry_id:142477)与精度

线方法将误差来源清晰地分解为空间和时间两个部分，这为系统性的[误差分析](@entry_id:142477)提供了便利。

#### 空间与时间误差的分解

一个完整的线方法求解过程的最终误差，是指全离散解 $U^n$ 与真实[PDE解](@entry_id:166250)在网格点上的投影 $u_h(t^n)$ 之间的差异。这个总误差可以分解为两个主要部分 ：

1.  **空间截断误差（Spatial Truncation Error）**：这是用离散算子 $F_h$ 代替[连续算子](@entry_id:143297) $\mathcal{L}$ 所引入的误差。它量化了真实的[PDE解](@entry_id:166250)在多大程度上不能满足半离散ODE系统。其严格定义为将真实解 $u(t, \cdot)$ 投影到网格上，并代入半离散方程后得到的残差：
    $$
    \tau_h(t) = \frac{d}{dt}(R_h u(t, \cdot)) - F_h(R_h u(t, \cdot), t)
    $$
    其中 $R_h$ 是从连续函数空间到网格[向量空间](@entry_id:151108)的投影或[限制算子](@entry_id:754316)。对于一个 $p$ 阶空间精度的格式，该误差满足 $\| \tau_h(t) \| = \mathcal{O}(h^p)$。在时间积分过程中，这个误差会累积，通常导致一个量级为 $\mathcal{O}(h^p)$ 的空间离散误差。

2.  **时间离散误差（Temporal Discretization Error）**：这是用数值积分法近似求解半离散ODE系统 $U' = F_h(U)$ 所产生的误差。对于一个 $q$ 阶稳定的时间积分法，在有限时间 $[0,T]$ 内，其[全局误差](@entry_id:147874)为 $\mathcal{O}(\Delta t^q)$。

通过[三角不等式](@entry_id:143750)，总误差可以被这两个分量的和所界定：
$$
\| u_h(t^n) - U^n \| \le \| u_h(t^n) - U(t^n) \| + \| U(t^n) - U^n \| \approx C_s h^p + C_t \Delta t^q
$$
其中 $U(t)$ 是半离散ODE的精确解。这个加性误差界是分析和优化线方法性能的理论基础。

#### 平衡误差与效率

为了最高效地利用计算资源，一个理想的策略是让空间误差和时间误差的量级相当，即实现**误差平衡** ：
$$
h^p \approx \Delta t^q \quad \implies \quad \Delta t \approx C h^{p/q}
$$
这个关系给出了在给定空间精度 $p$ 和时间精度 $q$ 下，最优的时间步长与空间步长的缩放关系。

然而，对于[显式时间积分](@entry_id:165797)法，这一理想关系常常受到稳定性条件的制约。如前所述，稳定性（CFL条件）通常要求 $\Delta t \le C_{\text{stab}} h^r$，其中 $r=1$ 对于以[平流](@entry_id:270026)为主的问题，$r=2$ 对于以[扩散](@entry_id:141445)为主的问题。这就导致了理论精度与实际稳定性之间的潜在冲突：

*   **如果 $p/q > r$**：为了平衡精度而需要的步长 $\Delta t \propto h^{p/q}$ 将最终违反稳定性限制 $\Delta t \propto h^r$（因为 $h^{p/q}$ 比 $h^r$ 衰减得慢）。在这种情况下，我们不得不选择满足稳定性的更小的步长 $\Delta t = \Theta(h^r)$。此时，时间误差 $\mathcal{O}(\Delta t^q) = \mathcal{O}(h^{rq})$ 将远小于空间误差 $\mathcal{O}(h^p)$，导致计算资源浪费在过小的时间步长上。这种情况下，我们称误差由**空间误差主导**。

*   **如果 $p/q  r$**：平衡精度所需的步长 $\Delta t$ 在稳定性允许的范围内。我们可以自由选择 $\Delta t = \Theta(h^{p/q})$ 来平衡误差。但如果我们为了方便或其它原因选择了满足稳定性的最大步长 $\Delta t = \Theta(h^r)$，那么时间误差 $\mathcal{O}(h^{rq})$ 将远大于空间误差 $\mathcal{O}(h^p)$。这种情况下，误差由**时间误差主导**。

当面临 $p/q > r$ 的困境时，有两种策略可以恢复误差平衡：
1.  **提高[时间积分](@entry_id:267413)阶数**：增加 $q$，使得新的 $p/q$ 满足 $p/q \le r$。
2.  **采用隐式或稳定化方法**：切换到一个具有更大或[无条件稳定](@entry_id:146281)域的时间积分法（如[隐式欧拉法](@entry_id:176177)或A-稳定的[龙格-库塔法](@entry_id:140014)），从而摆脱苛刻的CFL限制，允许我们根据精度需求自由选择 $\Delta t$。

### 替代方法与深层原理

标准线方法（先空间离散，后时间离散）并非唯一的途径。通过颠倒离散化顺序，我们可以得到所谓的**Rothe方法**或“线方法[转置](@entry_id:142115)”，这不仅提供了另一种求解思路，也为我们理解[数值格式](@entry_id:752822)的内在性质提供了深刻的洞见。

#### Rothe方法：先时间离散

在Rothe方法中，我们首先对时间导数进行离散化。以向后[欧拉法](@entry_id:749108)为例，热方程 $u_t = \nu u_{xx}$ 变为：
$$
\frac{u^{n+1}(x) - u^n(x)}{\Delta t} = \nu u_{xx}^{n+1}(x)
$$
整理后，我们得到一个关于下一时刻解 $u^{n+1}(x)$ 的[二阶常微分方程](@entry_id:204212)边值问题（BVP）：
$$
(I - \Delta t \nu \partial_{xx}) u^{n+1}(x) = u^n(x)
$$
求解原PDE的过程，转变为在每个时间步迭代求解一个形如修正[亥姆霍兹方程](@entry_id:149977)（modified Helmholtz equation）的椭圆型边值问题。

#### [最大值原理](@entry_id:138611)的保持

最大值原理是[抛物型方程](@entry_id:144670)的一个核心物理性质，它保证解在没有源项的情况下不会产生新的极值。一个好的数值格式应该能在离散层面上模拟这个性质。通过比较标准MOL与Rothe方法，我们可以深入理解不同格式对这一原理的保持情况 。

*   **标准MOL下的时间积分**：
    *   **向前欧拉法**：$U^{n+1} = (I + r A_h) U^n$。只有当稳定性条件 $r = \nu \Delta t/h^2 \le 1/2$ 满足时，其更新矩阵的系数才全部非负，从而保证[离散最大值原理](@entry_id:748510)。一旦 $r > 1/2$，就可能出现[数值振荡](@entry_id:163720)，违反该原理。
    *   **向后欧拉法**：$(I - r A_h) U^{n+1} = U^n$。对于任意 $r0$，矩阵 $(I - r A_h)$ 都是一个**[M-矩阵](@entry_id:189121)**。[M-矩阵](@entry_id:189121)的一个关键性质是其逆矩阵的所有元素都非负。因此，$U^{n+1} = (I - r A_h)^{-1} U^n$ 的[更新过程](@entry_id:273573)是一个[正算子](@entry_id:263696)，无条件地保持[离散最大值原理](@entry_id:748510)。
    *   **Crank-Nicolson法**：$(I - \frac{r}{2} A_h) U^{n+1} = (I + \frac{r}{2} A_h) U^n$。虽然该方法在 $L^2$ 范数下[无条件稳定](@entry_id:146281)，但当 $r1$ 时，右端矩阵 $(I + \frac{r}{2} A_h)$ 会出现负的对角元，导致[更新过程](@entry_id:273573)不保持正定性，可能产生违反最大值原理的[数值振荡](@entry_id:163720)。

*   **Rothe方法分析**：
    在Rothe方法中，每一步求解的椭圆型BVP $(I - \Delta t \nu \partial_{xx}) u^{n+1} = u^n$ 自身满足一个强大的[最大值原理](@entry_id:138611)。这意味着，如果 $u^n(x) \ge 0$，那么解 $u^{n+1}(x)$ 也必定非负。因此，只要能精确求解这个BVP，最大值原理就能在每个时间步得到完美保持，不受 $\Delta t$ 大小的限制。

一个令人赞叹的结论是：当我们用中心差分去离散Rothe方法中的椭圆型BVP时，得到的代数系统恰好是 $(I - r A_h) U^{n+1} = U^n$ —— 这与标准MOL结合向后欧拉法得到的系统完全相同！这揭示了一个深刻的联系：向后[欧拉法](@entry_id:749108)之所以在线方法中对[扩散](@entry_id:141445)问题表现出优异的稳定性和定性行为，正是因为它在离散层面上完美地模拟了一个满足最大值原理的、隐式的椭圆型求解过程。这种跨越不同离散化视角的等价性，是理解数值方法内在结构与性质的一把钥匙。