{
    "hands_on_practices": [
        {
            "introduction": "在我们应用任何数值方法之前，理解其误差的来源和性质至关重要。此练习将引导您使用泰勒级数展开这一基本分析工具，来量化中心差分格式在近似二阶导数时引入的局部截断误差 ()。通过这个推导，您将亲手揭示该方法的精度阶数，为后续更复杂的收敛性分析和误差估计奠定坚实的理论基础。",
            "id": "3420401",
            "problem": "在求解瞬态偏微分方程（PDE）的直线法中，一种常用方法是将空间导数离散化，同时保持时间连续，从而得到一个半离散的常微分方程（ODE）组。考虑一维热传导方程 $u_{t}=\\kappa u_{xx}$，其中 $u=u(x,t)$ 在空间和时间上足够光滑，$\\kappa0$ 是一个常数，称为热扩散系数。在一个间距为 $h0$、节点为 $x_{i}=x_{0}+i h$ 的均匀空间网格上，使用标准的二阶中心差分算子来近似 $x_{i}$ 处的二阶空间导数：\n$$\nD^{(2)}_{h}u(x_{i})=\\frac{u(x_{i}+h)-2\\,u(x_{i})+u(x_{i}-h)}{h^{2}}.\n$$\n仅使用光滑函数在某点周围的泰勒展开，以及局部空间截断误差的定义（即作用于精确光滑解的离散空间算子与精确空间导数之差），推导在均匀网格上用此二阶中心差分近似 $u_{xx}$ 的截断误差的主阶项。具体来说，假设对于每个固定的 $t$，函数 $u(\\cdot,t)$ 在空间上属于 $C^{6}$ 类，并通过在 $x=x_{i}$ 处进行泰勒展开来确定精确常数 $C$，使得\n$$\nD^{(2)}_{h}u(x_{i})-u_{xx}(x_{i})=C\\,h^{2}\\,u^{(4)}(x_{i})+\\mathcal{O}(h^{4})\n$$\n当 $h\\to 0$ 时成立。请将 $C$ 的最终答案表示为一个无单位的精确有理数。",
            "solution": "问题要求推导用标准二阶中心差分近似二阶空间导数 $u_{xx}$ 时，其局部截断误差的主阶项。我们将通过对函数 $u(x,t)$ 关于空间变量 $x$ 应用泰勒定理进行分析，并保持时间 $t$ 不变。为简化记法，我们用 $u(x)$ 表示固定时间 $t$ 下的 $u(x,t)$，诸如 $u_{xx}$ 和 $u^{(k)}$ 的导数均被理解为空间导数，即 $u^{(k)}(x) = \\frac{\\partial^k u}{\\partial x^k}(x,t)$。\n\n我们用 $\\tau(x_i)$ 表示局部截断误差，其定义为作用于精确解的离散算子与它所近似的精确微分算子之差。具体来说，\n$$\n\\tau(x_i) = D^{(2)}_{h}u(x_{i}) - u_{xx}(x_{i})\n$$\n其中离散算子由下式给出：\n$$\nD^{(2)}_{h}u(x_{i})=\\frac{u(x_{i}+h)-2u(x_{i})+u(x_{i}-h)}{h^{2}}.\n$$\n问题指出解 $u$ 足够光滑，具体来说，对于任意固定的时间 $t$，函数 $u(\\cdot, t)$ 在空间变量上属于 $C^{6}$ 类。这个假设允许我们使用泰勒定理将 $u(x_i+h)$ 和 $u(x_i-h)$ 在点 $x_i$ 处展开。泰勒级数展开式为：\n$$\nu(x_i+h) = u(x_i) + h u'(x_i) + \\frac{h^2}{2!} u''(x_i) + \\frac{h^3}{3!} u'''(x_i) + \\frac{h^4}{4!} u^{(4)}(x_i) + \\frac{h^5}{5!} u^{(5)}(x_i) + \\mathcal{O}(h^6)\n$$\n$$\nu(x_i-h) = u(x_i) - h u'(x_i) + \\frac{h^2}{2!} u''(x_i) - \\frac{h^3}{3!} u'''(x_i) + \\frac{h^4}{4!} u^{(4)}(x_i) - \\frac{h^5}{5!} u^{(5)}(x_i) + \\mathcal{O}(h^6)\n$$\n这里，$u^{(k)}(x_i)$ 表示 $u$ 关于 $x$ 在 $x_i$ 点的 $k$ 阶导数。\n\n我们将这些展开式代入有限差分算子 $D^{(2)}_{h}u(x_{i})$ 的分子中。首先，我们将这两个展开式相加：\n$$\nu(x_i+h) + u(x_i-h) = \\left(u(x_i) + h u'(x_i) + \\frac{h^2}{2} u''(x_i) + \\frac{h^3}{6} u'''(x_i) + \\frac{h^4}{24} u^{(4)}(x_i) + \\dots\\right) + \\left(u(x_i) - h u'(x_i) + \\frac{h^2}{2} u''(x_i) - \\frac{h^3}{6} u'''(x_i) + \\frac{h^4}{24} u^{(4)}(x_i) - \\dots\\right)\n$$\n通过合并 $h$ 的同次幂项，我们观察到所有 $h$ 的奇数次幂项都相互抵消了：\n$$\nu(x_i+h) + u(x_i-h) = 2u(x_i) + 2\\frac{h^2}{2}u''(x_i) + 2\\frac{h^4}{24}u^{(4)}(x_i) + \\mathcal{O}(h^6)\n$$\n$$\nu(x_i+h) + u(x_i-h) = 2u(x_i) + h^2 u''(x_i) + \\frac{h^4}{12}u^{(4)}(x_i) + \\mathcal{O}(h^6)\n$$\n现在我们可以构建算子的完整分子：\n$$\nu(x_i+h) - 2u(x_i) + u(x_i-h) = \\left(2u(x_i) + h^2 u''(x_i) + \\frac{h^4}{12}u^{(4)}(x_i) + \\mathcal{O}(h^6)\\right) - 2u(x_i)\n$$\n$$\nu(x_i+h) - 2u(x_i) + u(x_i-h) = h^2 u''(x_i) + \\frac{h^4}{12}u^{(4)}(x_i) + \\mathcal{O}(h^6)\n$$\n为了得到 $D^{(2)}_{h}u(x_i)$ 的表达式，我们将此结果除以 $h^2$：\n$$\nD^{(2)}_{h}u(x_i) = \\frac{1}{h^2}\\left(h^2 u''(x_i) + \\frac{h^4}{12}u^{(4)}(x_i) + \\mathcal{O}(h^6)\\right)\n$$\n$$\nD^{(2)}_{h}u(x_i) = u''(x_i) + \\frac{h^2}{12}u^{(4)}(x_i) + \\mathcal{O}(h^4)\n$$\n问题中使用 $u_{xx}(x_i)$ 的记法来表示 $u''(x_i)$，因此我们可以写成：\n$$\nD^{(2)}_{h}u(x_i) = u_{xx}(x_i) + \\frac{h^2}{12}u^{(4)}(x_i) + \\mathcal{O}(h^4)\n$$\n最后，我们通过从离散算子的表达式中减去精确的二阶导数 $u_{xx}(x_i)$ 来计算局部截断误差：\n$$\n\\tau(x_i) = D^{(2)}_{h}u(x_i) - u_{xx}(x_i) = \\left(u_{xx}(x_i) + \\frac{h^2}{12}u^{(4)}(x_i) + \\mathcal{O}(h^4)\\right) - u_{xx}(x_i)\n$$\n$$\n\\tau(x_i) = \\frac{h^2}{12}u^{(4)}(x_i) + \\mathcal{O}(h^4)\n$$\n问题要求表达式中的常数 $C$：\n$$\nD^{(2)}_{h}u(x_{i})-u_{xx}(x_{i})=C\\,h^{2}\\,u^{(4)}(x_{i})+\\mathcal{O}(h^{4})\n$$\n通过将我们推导出的结果与此目标形式进行比较，我们可以确定常数 $C$ 是 $h^2 u^{(4)}(x_i)$ 项的系数。因此，该常数的值为：\n$$\nC = \\frac{1}{12}\n$$\n这是一个精确有理数，符合题目要求。",
            "answer": "$$\\boxed{\\frac{1}{12}}$$"
        },
        {
            "introduction": "将偏微分方程的空间变量离散化，即采用“线方法”(Method of Lines)，会将其转化为一个大型常微分方程组。这个过程会带来一个关键的实际问题：系统往往变得“刚性”(stiff)，从而对显式时间积分方法的稳定性构成严格限制 ()。本练习将通过分析离散拉普拉斯算子的特征值，帮助您推导出显式欧拉法求解热传导方程时必须满足的稳定性条件，从而深刻理解空间步长 $h$ 与时间步长 $\\Delta t$ 之间紧密的制约关系。",
            "id": "3420393",
            "problem": "考虑在区间 $(0,L)$ 上，对于 $t0$ 的一维热方程 $u_{t}=\\nu u_{xx}$，其边界条件为齐次狄利克雷边界条件 $u(0,t)=0$ 和 $u(L,t)=0$。设使用一个包含 $N$ 个内点的均匀空间网格，网格间距为 $h=L/(N+1)$，节点值 $u_{i}(t)\\approx u(x_{i},t)$ 位于 $x_{i}=ih$ 处，其中 $i=1,2,\\dots,N$。空间二阶导数通过标准二阶中心差分进行近似，得到直线法半离散系统\n$$\n\\frac{d\\boldsymbol{u}}{dt}=\\nu A\\boldsymbol{u},\n$$\n其中 $\\boldsymbol{u}(t)=(u_{1}(t),\\dots,u_{N}(t))^{\\top}$，$A$ 是对应于带齐次狄利克雷边界条件的离散拉普拉斯算子的 $N\\times N$ 三对角矩阵。\n\n仅使用线性系统的基本性质和常微分方程的显式欧拉法，完成以下任务：\n\n- 计算矩阵 $A$ 的所有特征值，将其表示为 $h$ 和 $N$ 的函数。\n- 通过对应用于半离散系统的显式欧拉时间离散进行逐模态稳定性分析，推导出一个与 $N$ 无关的、形式为 $\\Delta t\\le C\\,h^{2}/\\nu$ 的充分时间步长限制，并确定可从此分析中获得的精确常数 $C$。\n\n请以 $C$ 的数值形式给出最终答案。无需四舍五入。最终答案中不要包含单位。",
            "solution": "本题要求从一维热方程 $u_{t}=\\nu u_{xx}$ 在区域 $x \\in (0,L)$ 上，带有齐次狄利克雷边界条件 $u(0,t)=0$ 和 $u(L,t)=0$ 的直线法离散中，推导出两个主要结果。该离散方法使用 $N$ 个内点 $x_i = ih$（其中 $i=1, 2, \\dots, N$），均匀网格间距为 $h=L/(N+1)$。\n\n首先，我们从半离散系统 $\\frac{d\\boldsymbol{u}}{dt}=\\nu A\\boldsymbol{u}$ 中确定矩阵 $A$ 的特征值。在内部节点 $x_i$ 处的空间二阶导数 $u_{xx}$ 使用标准二阶中心差分进行近似：\n$$\nu_{xx}(x_i, t) \\approx \\frac{u(x_{i-1}, t) - 2u(x_i, t) + u(x_{i+1}, t)}{h^2}\n$$\n用节点近似值 $u_i(t) \\approx u(x_i, t)$ 替换连续函数 $u(x,t)$，该偏微分方程就变成一个常微分方程组 (ODEs)：\n$$\n\\frac{du_i}{dt} = \\frac{\\nu}{h^2} (u_{i-1}(t) - 2u_i(t) + u_{i+1}(t)) \\quad \\text{for } i=1, \\dots, N.\n$$\n边界条件 $u(0,t)=0$ 和 $u(L,t)=0$ 意味着对于所有 $t$，$u_0(t)=0$ 和 $u_{N+1}(t)=0$。\n这个常微分方程组可以表示为矩阵形式 $\\frac{d\\boldsymbol{u}}{dt} = \\frac{\\nu}{h^2} T \\boldsymbol{u}$，其中 $\\boldsymbol{u}(t) = (u_1(t), \\dots, u_N(t))^\\top$，$T$ 是一个 $N \\times N$ 的三对角矩阵：\n$$\nT = \\begin{pmatrix} -2   1   0   \\cdots   0 \\\\ 1   -2   1     0 \\\\ 0   1   \\ddots  \\ddots   \\vdots \\\\ \\vdots      \\ddots  -2  1 \\\\ 0   \\cdots    1  -2 \\end{pmatrix}\n$$\n根据问题陈述 $\\frac{d\\boldsymbol{u}}{dt}=\\nu A\\boldsymbol{u}$，我们确定 $A = \\frac{1}{h^2}T$。为了求出 $A$ 的特征值，我们首先求出 $T$ 的特征值。设 $\\lambda_T$ 是 $T$ 的一个特征值，$\\boldsymbol{v}=(v_1, \\dots, v_N)^\\top$ 是其对应的特征向量。特征值问题 $T\\boldsymbol{v} = \\lambda_T \\boldsymbol{v}$ 可以按分量写成：\n$$\nv_{j-1} - 2v_j + v_{j+1} = \\lambda_T v_j \\quad \\text{for } j=1, \\dots, N,\n$$\n附带边界条件 $v_0 = 0$ 和 $v_{N+1} = 0$。这是一个二阶线性齐次差分方程：\n$$\nv_{j+1} - (2+\\lambda_T)v_j + v_{j-1} = 0.\n$$\n我们寻找形式为 $v_j = r^j$ 的解。将此拟设代入差分方程，得到特征方程 $r^2 - (2+\\lambda_T)r + 1 = 0$。令 $2+\\lambda_T = 2\\cos(\\theta)$。特征方程变为 $r^2 - 2\\cos(\\theta)r + 1 = 0$，其根为 $r = \\cos(\\theta) \\pm i\\sin(\\theta) = e^{\\pm i\\theta}$。\n$v_j$ 的通解是这些根的线性组合：$v_j = C_1 e^{ij\\theta} + C_2 e^{-ij\\theta} = B_1 \\sin(j\\theta) + B_2 \\cos(j\\theta)$。\n应用边界条件 $v_0=0$ 得到 $B_1 \\sin(0) + B_2 \\cos(0) = B_2 = 0$。因此，特征向量的分量必须是 $v_j = B_1 \\sin(j\\theta)$ 的形式。\n应用另一个边界条件 $v_{N+1}=0$ 得到 $B_1 \\sin((N+1)\\theta) = 0$。对于非平凡特征向量，$B_1 \\neq 0$，这要求 $\\sin((N+1)\\theta)=0$。\n这意味着 $(N+1)\\theta = k\\pi$，其中 $k$ 是一个整数。因此，$\\theta_k = \\frac{k\\pi}{N+1}$。\n$k=1, 2, \\dots, N$ 这些值产生 $N$ 个线性无关的特征向量。其他的整数 $k$ 值要么产生平凡解（$k=0, N+1, \\dots$），要么是线性相关的。特征值 $\\lambda_T$ 通过代入 $2+\\lambda_{T,k} = 2\\cos(\\theta_k)$ 求得：\n$$\n\\lambda_{T,k} = 2\\cos\\left(\\frac{k\\pi}{N+1}\\right) - 2 = -2\\left(1-\\cos\\left(\\frac{k\\pi}{N+1}\\right)\\right) = -4\\sin^2\\left(\\frac{k\\pi}{2(N+1)}\\right).\n$$\n因此，矩阵 $A = \\frac{1}{h^2}T$ 的特征值 $\\lambda_k$ 为：\n$$\n\\lambda_k = -\\frac{4}{h^2}\\sin^2\\left(\\frac{k\\pi}{2(N+1)}\\right) \\quad \\text{for } k=1, 2, \\dots, N.\n$$\n这就完成了问题的第一部分。\n\n接下来，我们分析应用于半离散系统的显式欧拉法的稳定性。时间步进格式为：\n$$\n\\boldsymbol{u}^{n+1} = \\boldsymbol{u}^n + \\Delta t (\\nu A \\boldsymbol{u}^n) = (I + \\nu \\Delta t A)\\boldsymbol{u}^n.\n$$\n如果放大矩阵 $G = I + \\nu \\Delta t A$ 的谱半径小于或等于 1，则该格式是稳定的。$G$ 的特征值（记为 $\\mu_k$）与 $A$ 的特征值通过 $\\mu_k = 1 + \\nu \\Delta t \\lambda_k$ 相关。稳定性条件是对于所有 $k=1, \\dots, N$，都有 $|\\mu_k| \\le 1$。\n代入 $\\lambda_k$ 的表达式：\n$$\n\\mu_k = 1 - \\frac{4\\nu \\Delta t}{h^2}\\sin^2\\left(\\frac{k\\pi}{2(N+1)}\\right).\n$$\n由于 $\\nu  0$，$\\Delta t  0$，且 $h  0$，所有的 $\\lambda_k$ 都是负实数。因此，$\\mu_k \\le 1$ 总是成立。稳定性条件简化为 $\\mu_k \\ge -1$：\n$$\n1 - \\frac{4\\nu \\Delta t}{h^2}\\sin^2\\left(\\frac{k\\pi}{2(N+1)}\\right) \\ge -1\n$$\n$$\n\\frac{4\\nu \\Delta t}{h^2}\\sin^2\\left(\\frac{k\\pi}{2(N+1)}\\right) \\le 2\n$$\n$$\n\\Delta t \\le \\frac{2h^2}{4\\nu \\sin^2\\left(\\frac{k\\pi}{2(N+1)}\\right)} = \\frac{h^2}{2\\nu\\sin^2\\left(\\frac{k\\pi}{2(N+1)}\\right)}.\n$$\n这个不等式必须对所有模态都成立，即对所有 $k=1, \\dots, N$ 成立。最严格的条件是由使分母中的项 $\\sin^2\\left(\\frac{k\\pi}{2(N+1)}\\right)$ 最大化的模态所施加的。对于所有 $k \\in \\{1,\\dots,N\\}$，自变量 $\\frac{k\\pi}{2(N+1)}$ 位于区间 $(0, \\pi/2)$ 内。由于 $\\sin(x)$ 在 $[0, \\pi/2]$ 上是递增的，最大值在 $k$ 取最大可能值时出现，即 $k=N$。\n这给出了对于固定的 $N$ 的充要稳定性条件：\n$$\n\\Delta t \\le \\frac{h^2}{2\\nu\\sin^2\\left(\\frac{N\\pi}{2(N+1)}\\right)}.\n$$\n题目要求一个形式为 $\\Delta t\\le C\\,h^{2}/\\nu$ 的充分条件，其中常数 $C$ 与 $N$ 无关。这个条件必须对所有 $N \\ge 1$ 都有效。因此，我们必须有：\n$$\nC \\frac{h^2}{\\nu} \\le \\frac{h^2}{2\\nu\\sin^2\\left(\\frac{N\\pi}{2(N+1)}\\right)} \\quad \\text{for all } N \\ge 1.\n$$\n这可以简化为：\n$$\nC \\le \\frac{1}{2\\sin^2\\left(\\frac{N\\pi}{2(N+1)}\\right)}.\n$$\n为确保这对所有 $N$ 都成立，$C$ 必须小于或等于右侧表达式在所有 $N \\ge 1$ 上的最小值（下确界）：\n$$\nC \\le \\inf_{N \\ge 1} \\left\\{ \\frac{1}{2\\sin^2\\left(\\frac{N\\pi}{2(N+1)}\\right)} \\right\\}.\n$$\n我们来分析函数 $f(N) = \\frac{1}{2\\sin^2\\left(\\frac{N\\pi}{2(N+1)}\\right)}$。正弦函数的自变量 $x_N = \\frac{N\\pi}{2(N+1)} = \\frac{\\pi}{2}\\left(1-\\frac{1}{N+1}\\right)$ 是一个单调递增序列，当 $N \\to \\infty$ 时从下方收敛到 $\\pi/2$。由于 $\\sin^2(x)$ 在 $[0, \\pi/2]$ 上是递增的，分母 $2\\sin^2(x_N)$ 也是一个关于 $N$ 的单调递增函数。因此，$f(N)$ 是一个关于 $N$ 的单调递减函数。下确界是当 $N \\to \\infty$ 时的极限：\n$$\n\\inf_{N \\ge 1} f(N) = \\lim_{N \\to \\infty} \\frac{1}{2\\sin^2\\left(\\frac{N\\pi}{2(N+1)}\\right)} = \\frac{1}{2\\sin^2\\left(\\lim_{N \\to \\infty}\\frac{N\\pi}{2(N+1)}\\right)} = \\frac{1}{2\\sin^2(\\pi/2)} = \\frac{1}{2(1)^2} = \\frac{1}{2}.\n$$\n与 $N$ 无关的最精确（最大）的可能常数 $C$ 就是这个下确界。任何大于 $1/2$ 的 $C$ 值对于足够大的 $N$ 都会违反稳定性条件。因此，精确常数是 $C = 1/2$。",
            "answer": "$$\n\\boxed{\\frac{1}{2}}\n$$"
        },
        {
            "introduction": "理论分析的正确性最终需要通过数值实验来验证。本练习将指导您完成一次网格加密研究（grid refinement study），这是计算科学中用以验证数值方法收敛阶的黄金准则 ()。您将通过一种巧妙的设计——精确求解半离散系统以完全消除时间积分误差——来精确地测量空间离散误差的收敛速度。这个实践不仅能巩固您对收敛阶的理论认识，还能锻炼您设计和实施严谨数值验证实验的核心能力。",
            "id": "3420375",
            "problem": "考虑在闭区间 $[0,1]$ 上的一维热传导方程，其具有齐次狄利克雷边界条件和光滑的初始条件。其控制偏微分方程（PDE）为\n$$\n\\frac{\\partial u}{\\partial t}(x,t) = \\alpha \\frac{\\partial^2 u}{\\partial x^2}(x,t), \\quad x \\in (0,1), \\quad t \\ge 0,\n$$\n边界条件为\n$$\nu(0,t) = 0, \\quad u(1,t) = 0,\n$$\n初始条件为\n$$\nu(x,0) = \\sin(\\pi x).\n$$\n假设热扩散系数参数在无量纲单位下为 $\\alpha = 1$。在这些条件下，该偏微分方程的精确解为\n$$\nu(x,t) = \\sin(\\pi x)\\, e^{-\\pi^2 t}.\n$$\n使用线方法（MOL），仅对空间域进行离散化，以产生一个常微分方程的半离散系统。使用一个包含 $N$ 个内部点的均匀网格，网格间距为 $h = \\frac{1}{N+1}$，并采用二阶中心有限差分来近似空间导数算子。将得到的离散拉普拉斯算子表示为矩阵 $A_h \\in \\mathbb{R}^{N \\times N}$，半离散系统表示为\n$$\n\\frac{d \\mathbf{u}(t)}{dt} = A_h \\mathbf{u}(t), \\quad \\mathbf{u}(0) = \\mathbf{u}_0,\n$$\n其中 $\\mathbf{u}(t)$ 近似于网格点 $x_i = i h$（对于 $i = 1,2,\\ldots,N$）处的 $u(x_i,t)$。对该半离散系统进行精确的时间积分以分离空间误差；也就是说，计算\n$$\n\\mathbf{u}(T) = e^{T A_h} \\mathbf{u}_0\n$$\n利用所选初始条件在齐次狄利克雷边界条件的中心差分拉普拉斯算子下产生一个离散特征向量这一事实。在网格点处的连续参考解为\n$$\n\\mathbf{u}_{\\text{ref}}(T)_i = \\sin(\\pi x_i)\\, e^{-\\pi^2 T}.\n$$\n将最终时间 $T$ 的离散 $L^2$ 误差定义为\n$$\nE_h(T) = \\left( h \\sum_{i=1}^N \\left(\\mathbf{u}(T)_i - \\mathbf{u}_{\\text{ref}}(T)_i\\right)^2 \\right)^{1/2}.\n$$\n您的任务是设计并执行一项网格加密研究，通过使用上述解析积分的半离散系统来分离空间离散误差。当 $N$ 加倍（即 $h$ 减半）时，推导、论证并预测离散 $L^2$ 误差在 $h$ 上的观测收敛率。然后，实现一个程序，计算连续网格加密之间的经验收敛率。\n\n测试套件参数：\n- 使用三个最终时间 $T \\in \\{0.1,\\; 1.0,\\; 10.0\\}$。\n- 对于每个 $T$，使用内部网格尺寸序列 $N \\in \\{15,\\; 31,\\; 63,\\; 127\\}$，这样在连续的 $N$ 值之间，网格间距会精确减半，因为 $h = \\frac{1}{N+1}$。\n- 对于每个 $T$，计算 $k = 1,2,3,4$ 时的误差 $E_{h_k}(T)$ 和经验收敛率\n$$\np_k = \\frac{\\log\\left(E_{h_k}(T) / E_{h_{k+1}}(T)\\right)}{\\log\\left(h_k / h_{k+1}\\right)}, \\quad k = 1,2,3.\n$$\n\n您的程序应产生单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。输出格式必须是包含三个列表的列表，每个 $T$ 一个，其中每个内部列表包含该 $T$ 的三个经验收敛率 $p_k$，按连续网格加密的顺序排列。例如，\n$$\n[ [p_1(T_1), p_2(T_1), p_3(T_1)], [p_1(T_2), p_2(T_2), p_3(T_2)], [p_1(T_3), p_2(T_3), p_3(T_3)] ].\n$$\n所有数值结果必须以不带单位的浮点值形式报告。",
            "solution": "任务是使用线方法（MOL）对一维热传导方程的数值解进行网格加密研究。其核心思想是通过解析地对所得的常微分方程（ODE）半离散系统进行积分来分离空间离散误差。\n\n首先，我们分析预期的收敛率。空间导数 $\\frac{\\partial^2 u}{\\partial x^2}$ 使用二阶中心有限差分格式进行近似。该近似的局部截断误差为 $O(h^2)$ 阶，其中 $h$ 是空间网格间距。由于问题指明半离散常微分方程组将在时间上精确求解，因此没有时间离散误差。数值解的全局误差因此完全由空间离散化决定。对于一个稳定且一致的格式，全局误差的阶数与局部截断误差的阶数相匹配。因此，我们预期离散 $L^2$ 误差 $E_h(T)$ 的行为类似于 $E_h(T) \\approx C h^2$，其中常数 $C$ 依赖于最终时间 $T$ 和解的性质，但与 $h$ 无关。\n\n经验收敛率 $p$ 是通过比较来自两个不同网格间距 $h_k$ 和 $h_{k+1}$ 的误差来计算的。根据问题，网格被加密，使得 $h_{k+1} = h_k/2$。收敛率由以下公式给出：\n$$\np_k = \\frac{\\log(E_{h_k} / E_{h_{k+1}})}{\\log(h_k / h_{k+1})}\n$$\n代入 $E_h \\approx C h^2$ 和 $h_{k+1} = h_k/2$，我们得到：\n$$\np_k \\approx \\frac{\\log((C h_k^2) / (C (h_k/2)^2))}{\\log(h_k / (h_k/2))} = \\frac{\\log(4)}{\\log(2)} = \\frac{2 \\log(2)}{\\log(2)} = 2\n$$\n预测的收敛率为 $2$。我们的数值实验应得出随着网格加密而趋近于该值的收敛率。\n\n现在，我们详细说明线方法的实现。\n空间域 $[0,1]$ 使用 $N$ 个内部点 $x_i = i h$（$i=1, 2, \\ldots, N$）进行离散化，网格间距为 $h = 1/(N+1)$。在这些点上的函数 $u(x,t)$ 由一个向量 $\\mathbf{u}(t)$ 近似，其中 $\\mathbf{u}(t)_i \\approx u(x_i, t)$。\n偏微分方程为 $\\frac{\\partial u}{\\partial t} = \\alpha \\frac{\\partial^2 u}{\\partial x^2}$，其中 $\\alpha=1$。对二阶导数应用中心有限差分公式，\n$$\n\\frac{\\partial^2 u}{\\partial x^2}\\bigg|_{x=x_i} \\approx \\frac{u(x_{i-1}, t) - 2u(x_i, t) + u(x_{i+1}, t)}{h^2}\n$$\n我们得到关于内部点的常微分方程组：\n$$\n\\frac{d\\mathbf{u}_i(t)}{dt} = \\frac{1}{h^2} (\\mathbf{u}_{i-1}(t) - 2\\mathbf{u}_i(t) + \\mathbf{u}_{i+1}(t)), \\quad i=1, \\ldots, N\n$$\n边界条件 $u(0,t)=0$ 和 $u(1,t)=0$ 意味着 $\\mathbf{u}_0(t)=0$ 和 $\\mathbf{u}_{N+1}(t)=0$。该系统可以写成矩阵形式：\n$$\n\\frac{d\\mathbf{u}(t)}{dt} = A_h \\mathbf{u}(t)\n$$\n其中 $A_h$ 是一个 $N \\times N$ 的三对角矩阵：\n$$\nA_h = \\frac{1}{h^2} \\begin{pmatrix}\n-2  1  0  \\cdots  0 \\\\\n1  -2  1  \\cdots  0 \\\\\n0  \\ddots  \\ddots  \\ddots  0 \\\\\n\\vdots    1  -2  1 \\\\\n0  \\cdots  0  1  -2\n\\end{pmatrix}\n$$\n这个常微分方程组的精确解是 $\\mathbf{u}(T) = e^{T A_h} \\mathbf{u}_0$。直接计算矩阵指数 $e^{T A_h}$ 的计算成本可能很高，并可能引入数值误差。然而，问题通过选择初始条件 $u(x,0) = \\sin(\\pi x)$ 提供了一个关键的简化。相应的离散初始条件向量 $\\mathbf{u}_0$ 的分量为 $(\\mathbf{u}_0)_i = \\sin(\\pi x_i) = \\sin(\\pi i h)$。\n\n这个特定的初始条件向量是矩阵 $A_h$ 的一个特征向量。$A_h$ 的特征向量 $\\mathbf{v}_k$ 和特征值 $\\lambda_k$ 已知为：\n$$\n(\\mathbf{v}_k)_j = \\sin\\left(\\frac{k j \\pi}{N+1}\\right) = \\sin(k \\pi x_j), \\quad k=1, \\ldots, N\n$$\n$$\n\\lambda_k = \\frac{2}{h^2}(\\cos(k \\pi h) - 1) = -\\frac{4}{h^2} \\sin^2\\left(\\frac{k \\pi h}{2}\\right)\n$$\n我们的初始条件 $\\mathbf{u}_0$ 对应于第一个特征向量 $\\mathbf{v}_1$（对于 $k=1$）。由于 $\\mathbf{u}_0 = \\mathbf{v}_1$，矩阵指数的作用显著简化：\n$$\n\\mathbf{u}(T) = e^{T A_h} \\mathbf{u}_0 = e^{T A_h} \\mathbf{v}_1 = e^{T \\lambda_1} \\mathbf{v}_1\n$$\n其中 $\\lambda_1 = -\\frac{4}{h^2} \\sin^2\\left(\\frac{\\pi h}{2}\\right)$。这使我们能够解析地计算数值解向量，而无需构造或对矩阵 $A_h$ 进行指数运算。\n\n误差计算也得到了简化。网格点上的参考解是 $\\mathbf{u}_{\\text{ref}}(T)_i = \\sin(\\pi x_i) e^{-\\pi^2 T}$。误差向量为：\n$$\n(\\mathbf{u}(T) - \\mathbf{u}_{\\text{ref}}(T))_i = (e^{T \\lambda_1} - e^{-\\pi^2 T})\\sin(\\pi x_i)\n$$\n离散 $L^2$ 误差定义为 $E_h(T) = \\left( h \\sum_{i=1}^N \\left(\\mathbf{u}(T)_i - \\mathbf{u}_{\\text{ref}}(T)_i\\right)^2 \\right)^{1/2}$。代入误差向量：\n$$\nE_h(T) = \\left( h \\sum_{i=1}^N \\left[ (e^{T \\lambda_1} - e^{-\\pi^2 T})\\sin(\\pi x_i) \\right]^2 \\right)^{1/2} = |e^{T \\lambda_1} - e^{-\\pi^2 T}| \\left( h \\sum_{i=1}^N \\sin^2(\\pi x_i) \\right)^{1/2}\n$$\n该和式有一个已知的闭式解：$\\sum_{i=1}^N \\sin^2(\\frac{\\pi i}{N+1}) = \\frac{N+1}{2}$。因此，平方根下的项变为：\n$$\nh \\sum_{i=1}^N \\sin^2(\\pi x_i) = \\frac{1}{N+1} \\cdot \\frac{N+1}{2} = \\frac{1}{2}\n$$\n这将误差计算简化为一个单一、简洁的表达式，它仅依赖于 $T$、$h$ 和已知常数，完全避免了求和循环，从而消除了范数计算中的任何求积误差：\n$$\nE_h(T) = \\frac{1}{\\sqrt{2}} |e^{T \\lambda_1} - e^{-\\pi^2 T}|\n$$\n步骤是为给定序列中的每个 $N_k$ 计算此误差 $E_{h_k}(T)$，然后计算经验收敛率 $p_k = \\log_2(E_{h_k}(T) / E_{h_{k+1}}(T))$，其中 $k=1,2,3$。对每个最终时间 $T$ 执行此操作。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Performs a grid refinement study for the 1D heat equation using the method of lines\n    with an exact time integrator to isolate spatial discretization error.\n    \"\"\"\n    T_values = [0.1, 1.0, 10.0]\n    N_values = [15, 31, 63, 127]\n\n    all_results = []\n\n    for T in T_values:\n        errors = []\n        for N in N_values:\n            # h: grid spacing\n            h = 1.0 / (N + 1)\n            \n            # The numerical method uses an exact time integrator on the semi-discrete system.\n            # The initial condition sin(pi*x) is the first discrete eigenvector of the\n            # centered finite-difference Laplacian.\n            # The corresponding eigenvalue lambda_1 of the operator A_h = (1/h^2)*tridiag(1,-2,1)\n            # is given by:\n            lambda_1 = -4.0 / h**2 * np.sin(np.pi * h / 2.0)**2\n            \n            # The numerical solution at the grid points is u_h(T) = exp(T*lambda_1) * u_0.\n            # The exact solution at the grid points is u_ex(T) = exp(-pi^2*T) * u_0.\n            # The L2 error norm can be calculated analytically. The sum term in the norm\n            # S = h * sum_{i=1 to N} (sin(pi*x_i))^2 simplifies to 1/2.\n            # So, E_h(T) = |exp(T*lambda_1) - exp(-pi^2*T)| * sqrt(S).\n            \n            # Factor from the analytical solution of the error norm calculation\n            error_factor = np.abs(np.exp(T * lambda_1) - np.exp(-T * np.pi**2))\n            \n            # The discrete L2 norm simplifies to this expression\n            error = error_factor / np.sqrt(2.0)\n            \n            errors.append(error)\n\n        # Compute empirical convergence rates\n        # p_k = log(E_k / E_{k+1}) / log(h_k / h_{k+1})\n        # Since h_{k+1} = h_k / 2, the denominator is log(2).\n        rates = []\n        for k in range(len(errors) - 1):\n            # Check for zero error to prevent division by zero or log(0)\n            if errors[k] == 0.0 or errors[k+1] == 0.0:\n                # This case shouldn't happen in this problem but is good practice.\n                rate = 0.0 \n            else:\n                rate = np.log(errors[k] / errors[k+1]) / np.log(2.0)\n            rates.append(rate)\n        \n        all_results.append(rates)\n\n    # Format the output string as per the problem specification.\n    # e.g., [[rate1, rate2, rate3], [rate1, rate2, rate3], ... ]\n    # Using str(list) automatically adds spaces, which matches the example format.\n    # Example: str([1.0, 2.0]) -> \"[1.0, 2.0]\"\n    inner_lists_str = [str(rate_list).replace(\" \", \"\") for rate_list in all_results]\n    \n    # Custom formatting to match the exact output format, which has spaces after commas.\n    # Example: \"[[p1, p2, p3], [p1, p2, p3]]\"\n    formatted_results = []\n    for rates in all_results:\n        formatted_rates = \", \".join(f\"{r:.7f}\" for r in rates)\n        # Re-creating a string that looks like a list to have control over spacing\n        formatted_results.append(f\"[{formatted_rates}]\")\n    \n    # The problem description's example format is `[ [p_1, p_2], [p_3, p_4] ]`,\n    # which implies string representation of lists.\n    # `\", \".join(map(str, all_results))` does exactly this.\n    final_output_str = f\"[{', '.join(map(str, all_results))}]\"\n    \n    print(final_output_str)\n\nsolve()\n\n```"
        }
    ]
}