{
    "hands_on_practices": [
        {
            "introduction": "The foundation of any finite difference method lies in its local accuracy. This exercise guides you through a fundamental analysis using Taylor series to determine the local truncation error of the standard spatial discretization, revealing how the approximation error depends on the grid spacing $h$. Understanding this error is the first step in predicting the overall accuracy of a Method of Lines simulation .",
            "id": "3420401",
            "problem": "In the method of lines for time-dependent partial differential equations (PDEs), a common approach is to discretize spatial derivatives while keeping time continuous, resulting in a semi-discrete system of ordinary differential equations (ODEs). Consider the spatially one-dimensional heat equation $u_{t}=\\kappa u_{xx}$, where $u=u(x,t)$ is sufficiently smooth in space and time and $\\kappa>0$ is a constant thermal diffusivity. On a uniform spatial grid with spacing $h>0$ and nodes $x_{i}=x_{0}+i h$, the standard second-order central difference operator is used to approximate the second spatial derivative at $x_{i}$ by\n$$\nD^{(2)}_{h}u(x_{i})=\\frac{u(x_{i}+h)-2\\,u(x_{i})+u(x_{i}-h)}{h^{2}}.\n$$\nUsing only the Taylor expansion of a smooth function about a point and the definition of local spatial truncation error as the difference between the discrete spatial operator applied to the exact smooth solution and the exact spatial derivative, derive the leading-order term of the truncation error for this second-order central difference approximation of $u_{xx}$ on a uniform grid. Specifically, assume $u(\\cdot,t)\\in C^{6}$ in space for each fixed $t$ and perform a Taylor expansion about $x=x_{i}$ to determine the exact constant $C$ such that\n$$\nD^{(2)}_{h}u(x_{i})-u_{xx}(x_{i})=C\\,h^{2}\\,u^{(4)}(x_{i})+\\mathcal{O}(h^{4})\n$$\nas $h\\to 0$. Provide your final answer for $C$ as a single exact rational number with no units.",
            "solution": "The problem requires the derivation of the leading-order term of the local truncation error for the standard second-order central difference approximation of the second spatial derivative, $u_{xx}$. The analysis will be performed by applying Taylor's theorem to the function $u(x,t)$ with respect to the spatial variable $x$, holding time $t$ constant. For notational simplicity, we shall write $u(x)$ to denote $u(x,t)$ for a fixed time $t$, and derivatives such as $u_{xx}$ and $u^{(k)}$ are understood to be spatial derivatives, i.e., $u^{(k)}(x) = \\frac{\\partial^k u}{\\partial x^k}(x,t)$.\n\nThe local truncation error, which we denote by $\\tau(x_i)$, is defined as the difference between the discrete operator applied to the exact solution and the exact differential operator it approximates. Specifically,\n$$\n\\tau(x_i) = D^{(2)}_{h}u(x_{i}) - u_{xx}(x_{i})\n$$\nwhere the discrete operator is given by\n$$\nD^{(2)}_{h}u(x_{i})=\\frac{u(x_{i}+h)-2u(x_{i})+u(x_{i}-h)}{h^{2}}.\n$$\nThe problem states that the solution $u$ is sufficiently smooth, specifically that for any fixed time $t$, the function $u(\\cdot, t)$ belongs to the class $C^{6}$ in the spatial variable. This assumption allows us to employ Taylor's theorem to expand $u(x_i+h)$ and $u(x_i-h)$ about the point $x_i$. The Taylor series expansions are:\n$$\nu(x_i+h) = u(x_i) + h u'(x_i) + \\frac{h^2}{2!} u''(x_i) + \\frac{h^3}{3!} u'''(x_i) + \\frac{h^4}{4!} u^{(4)}(x_i) + \\frac{h^5}{5!} u^{(5)}(x_i) + \\mathcal{O}(h^6)\n$$\n$$\nu(x_i-h) = u(x_i) - h u'(x_i) + \\frac{h^2}{2!} u''(x_i) - \\frac{h^3}{3!} u'''(x_i) + \\frac{h^4}{4!} u^{(4)}(x_i) - \\frac{h^5}{5!} u^{(5)}(x_i) + \\mathcal{O}(h^6)\n$$\nHere, $u^{(k)}(x_i)$ denotes the $k$-th derivative of $u$ with respect to $x$ evaluated at $x_i$.\n\nWe substitute these expansions into the numerator of the finite difference operator $D^{(2)}_{h}u(x_{i})$. Let us first sum the two expansions:\n$$\nu(x_i+h) + u(x_i-h) = \\left(u(x_i) + h u'(x_i) + \\frac{h^2}{2} u''(x_i) + \\frac{h^3}{6} u'''(x_i) + \\frac{h^4}{24} u^{(4)}(x_i) + \\dots\\right) + \\left(u(x_i) - h u'(x_i) + \\frac{h^2}{2} u''(x_i) - \\frac{h^3}{6} u'''(x_i) + \\frac{h^4}{24} u^{(4)}(x_i) - \\dots\\right)\n$$\nBy collecting terms of like powers of $h$, we observe that all terms with odd powers of $h$ cancel out:\n$$\nu(x_i+h) + u(x_i-h) = 2u(x_i) + 2\\frac{h^2}{2}u''(x_i) + 2\\frac{h^4}{24}u^{(4)}(x_i) + \\mathcal{O}(h^6)\n$$\n$$\nu(x_i+h) + u(x_i-h) = 2u(x_i) + h^2 u''(x_i) + \\frac{h^4}{12}u^{(4)}(x_i) + \\mathcal{O}(h^6)\n$$\nNow we can form the full numerator of the operator:\n$$\nu(x_i+h) - 2u(x_i) + u(x_i-h) = \\left(2u(x_i) + h^2 u''(x_i) + \\frac{h^4}{12}u^{(4)}(x_i) + \\mathcal{O}(h^6)\\right) - 2u(x_i)\n$$\n$$\nu(x_i+h) - 2u(x_i) + u(x_i-h) = h^2 u''(x_i) + \\frac{h^4}{12}u^{(4)}(x_i) + \\mathcal{O}(h^6)\n$$\nTo obtain the expression for $D^{(2)}_{h}u(x_i)$, we divide this result by $h^2$:\n$$\nD^{(2)}_{h}u(x_i) = \\frac{1}{h^2}\\left(h^2 u''(x_i) + \\frac{h^4}{12}u^{(4)}(x_i) + \\mathcal{O}(h^6)\\right)\n$$\n$$\nD^{(2)}_{h}u(x_i) = u''(x_i) + \\frac{h^2}{12}u^{(4)}(x_i) + \\mathcal{O}(h^4)\n$$\nThe problem uses the notation $u_{xx}(x_i)$ for $u''(x_i)$, so we can write:\n$$\nD^{(2)}_{h}u(x_i) = u_{xx}(x_i) + \\frac{h^2}{12}u^{(4)}(x_i) + \\mathcal{O}(h^4)\n$$\nFinally, we compute the local truncation error by subtracting the exact second derivative, $u_{xx}(x_i)$, from the expression for the discrete operator:\n$$\n\\tau(x_i) = D^{(2)}_{h}u(x_i) - u_{xx}(x_i) = \\left(u_{xx}(x_i) + \\frac{h^2}{12}u^{(4)}(x_i) + \\mathcal{O}(h^4)\\right) - u_{xx}(x_i)\n$$\n$$\n\\tau(x_i) = \\frac{h^2}{12}u^{(4)}(x_i) + \\mathcal{O}(h^4)\n$$\nThe problem asks for the constant $C$ in the expression:\n$$\nD^{(2)}_{h}u(x_{i})-u_{xx}(x_{i})=C\\,h^{2}\\,u^{(4)}(x_{i})+\\mathcal{O}(h^{4})\n$$\nBy comparing our derived result with this target form, we identify the constant $C$ as the coefficient of the $h^2 u^{(4)}(x_i)$ term. Therefore, the value of the constant is:\n$$\nC = \\frac{1}{12}\n$$\nThis is an exact rational number, as required.",
            "answer": "$$\\boxed{\\frac{1}{12}}$$"
        },
        {
            "introduction": "Applying the Method of Lines transforms a PDE into a system of ODEs, but this often introduces stiffness that constrains the choice of time integrator. This practice demonstrates how to analyze the stability of the semi-discrete system by examining its eigenvalues, leading to the famous Courant–Friedrichs–Lewy (CFL) condition that links the time step $\\Delta t$ to the spatial grid size $h$. Mastering this analysis is crucial for developing stable and efficient numerical schemes .",
            "id": "3420393",
            "problem": "Consider the one-dimensional heat equation $u_{t}=\\nu u_{xx}$ on the interval $(0,L)$ for $t>0$ with homogeneous Dirichlet boundary conditions $u(0,t)=0$ and $u(L,t)=0$. Let a uniform spatial grid with $N$ interior points be used, with grid spacing $h=L/(N+1)$ and nodal values $u_{i}(t)\\approx u(x_{i},t)$ at $x_{i}=ih$ for $i=1,2,\\dots,N$. The second spatial derivative is approximated by the standard second-order central difference, yielding the method-of-lines semi-discrete system\n$$\n\\frac{d\\boldsymbol{u}}{dt}=\\nu A\\boldsymbol{u},\n$$\nwhere $\\boldsymbol{u}(t)=(u_{1}(t),\\dots,u_{N}(t))^{\\top}$ and $A$ is the $N\\times N$ tridiagonal matrix corresponding to the discrete Laplacian with homogeneous Dirichlet boundary conditions.\n\nUsing only fundamental properties of linear systems and the explicit Euler method for ordinary differential equations, do the following:\n\n- Compute the full set of eigenvalues of the matrix $A$ as functions of $h$ and $N$.\n- By analyzing stability mode-by-mode for the explicit Euler time discretization applied to the semi-discrete system, deduce a sufficient time step restriction of the form $\\Delta t\\le C\\,h^{2}/\\nu$ that is independent of $N$, and identify the sharp constant $C$ obtainable from this analysis.\n\nProvide your final answer as the numerical value of $C$. No rounding is required. Do not include units in your final answer.",
            "solution": "The problem asks for two main results derived from the method-of-lines discretization of the one-dimensional heat equation, $u_{t}=\\nu u_{xx}$, on the domain $x \\in (0,L)$ with homogeneous Dirichlet boundary conditions $u(0,t)=0$ and $u(L,t)=0$. The discretization uses $N$ interior points $x_i = ih$ for $i=1, 2, \\dots, N$, with a uniform grid spacing $h=L/(N+1)$.\n\nFirst, we determine the eigenvalues of the matrix $A$ from the semi-discrete system $\\frac{d\\boldsymbol{u}}{dt}=\\nu A\\boldsymbol{u}$. The second spatial derivative $u_{xx}$ at an interior node $x_i$ is approximated using the standard second-order central difference:\n$$\nu_{xx}(x_i, t) \\approx \\frac{u(x_{i-1}, t) - 2u(x_i, t) + u(x_{i+1}, t)}{h^2}\n$$\nReplacing the continuous function $u(x,t)$ with its nodal approximations $u_i(t) \\approx u(x_i, t)$, the partial differential equation becomes a system of ordinary differential equations (ODEs):\n$$\n\\frac{du_i}{dt} = \\frac{\\nu}{h^2} (u_{i-1}(t) - 2u_i(t) + u_{i+1}(t)) \\quad \\text{for } i=1, \\dots, N.\n$$\nThe boundary conditions $u(0,t)=0$ and $u(L,t)=0$ imply that $u_0(t)=0$ and $u_{N+1}(t)=0$ for all $t$.\nThis system of ODEs can be expressed in matrix form as $\\frac{d\\boldsymbol{u}}{dt} = \\frac{\\nu}{h^2} T \\boldsymbol{u}$, where $\\boldsymbol{u}(t) = (u_1(t), \\dots, u_N(t))^\\top$ and $T$ is the $N \\times N$ tridiagonal matrix:\n$$\nT = \\begin{pmatrix} -2 & 1 & 0 & \\cdots & 0 \\\\ 1 & -2 & 1 & & 0 \\\\ 0 & 1 & \\ddots & \\ddots & \\vdots \\\\ \\vdots & & \\ddots & -2 & 1 \\\\ 0 & \\cdots & & 1 & -2 \\end{pmatrix}\n$$\nFrom the problem statement, $\\frac{d\\boldsymbol{u}}{dt}=\\nu A\\boldsymbol{u}$, we identify $A = \\frac{1}{h^2}T$. To find the eigenvalues of $A$, we first find the eigenvalues of $T$. Let $\\lambda_T$ be an eigenvalue of $T$ and $\\boldsymbol{v}=(v_1, \\dots, v_N)^\\top$ be its corresponding eigenvector. The eigenvalue problem $T\\boldsymbol{v} = \\lambda_T \\boldsymbol{v}$ can be written component-wise as:\n$$\nv_{j-1} - 2v_j + v_{j+1} = \\lambda_T v_j \\quad \\text{for } j=1, \\dots, N,\n$$\nwith the boundary conditions $v_0 = 0$ and $v_{N+1} = 0$. This is a second-order linear homogeneous difference equation:\n$$\nv_{j+1} - (2+\\lambda_T)v_j + v_{j-1} = 0.\n$$\nWe seek solutions of the form $v_j = r^j$. Substituting this ansatz into the difference equation gives the characteristic equation $r^2 - (2+\\lambda_T)r + 1 = 0$. Let $2+\\lambda_T = 2\\cos(\\theta)$. The characteristic equation becomes $r^2 - 2\\cos(\\theta)r + 1 = 0$, with roots $r = \\cos(\\theta) \\pm i\\sin(\\theta) = e^{\\pm i\\theta}$.\nThe general solution for $v_j$ is a linear combination of these roots: $v_j = C_1 e^{ij\\theta} + C_2 e^{-ij\\theta} = B_1 \\sin(j\\theta) + B_2 \\cos(j\\theta)$.\nApplying the boundary condition $v_0=0$ gives $B_1 \\sin(0) + B_2 \\cos(0) = B_2 = 0$. So, the eigenvector components must be of the form $v_j = B_1 \\sin(j\\theta)$.\nApplying the other boundary condition $v_{N+1}=0$ gives $B_1 \\sin((N+1)\\theta) = 0$. For a non-trivial eigenvector, $B_1 \\neq 0$, which requires $\\sin((N+1)\\theta)=0$.\nThis implies $(N+1)\\theta = k\\pi$ for an integer $k$. So, $\\theta_k = \\frac{k\\pi}{N+1}$.\nThe values $k=1, 2, \\dots, N$ yield $N$ linearly independent eigenvectors. Other integer values of $k$ either produce trivial solutions ($k=0, N+1, \\dots$) or are linearly dependent. The eigenvalues $\\lambda_T$ are found from the substitution $2+\\lambda_{T,k} = 2\\cos(\\theta_k)$:\n$$\n\\lambda_{T,k} = 2\\cos\\left(\\frac{k\\pi}{N+1}\\right) - 2 = -2\\left(1-\\cos\\left(\\frac{k\\pi}{N+1}\\right)\\right) = -4\\sin^2\\left(\\frac{k\\pi}{2(N+1)}\\right).\n$$\nThe eigenvalues $\\lambda_k$ of the matrix $A = \\frac{1}{h^2}T$ are therefore:\n$$\n\\lambda_k = -\\frac{4}{h^2}\\sin^2\\left(\\frac{k\\pi}{2(N+1)}\\right) \\quad \\text{for } k=1, 2, \\dots, N.\n$$\nThis completes the first part of the problem.\n\nNext, we analyze the stability of the explicit Euler method applied to the semi-discrete system. The time-stepping scheme is:\n$$\n\\boldsymbol{u}^{n+1} = \\boldsymbol{u}^n + \\Delta t (\\nu A \\boldsymbol{u}^n) = (I + \\nu \\Delta t A)\\boldsymbol{u}^n.\n$$\nThe scheme is stable if the spectral radius of the amplification matrix $G = I + \\nu \\Delta t A$ is less than or equal to $1$. The eigenvalues of $G$, denoted by $\\mu_k$, are related to the eigenvalues of $A$ by $\\mu_k = 1 + \\nu \\Delta t \\lambda_k$. The stability condition is $|\\mu_k| \\le 1$ for all $k=1, \\dots, N$.\nSubstituting the expression for $\\lambda_k$:\n$$\n\\mu_k = 1 - \\frac{4\\nu \\Delta t}{h^2}\\sin^2\\left(\\frac{k\\pi}{2(N+1)}\\right).\n$$\nSince $\\nu > 0$, $\\Delta t > 0$, and $h > 0$, all $\\lambda_k$ are real and negative. Thus, $\\mu_k \\le 1$ is always true. The stability condition reduces to $\\mu_k \\ge -1$:\n$$\n1 - \\frac{4\\nu \\Delta t}{h^2}\\sin^2\\left(\\frac{k\\pi}{2(N+1)}\\right) \\ge -1\n$$\n$$\n\\frac{4\\nu \\Delta t}{h^2}\\sin^2\\left(\\frac{k\\pi}{2(N+1)}\\right) \\le 2\n$$\n$$\n\\Delta t \\le \\frac{2h^2}{4\\nu \\sin^2\\left(\\frac{k\\pi}{2(N+1)}\\right)} = \\frac{h^2}{2\\nu\\sin^2\\left(\\frac{k\\pi}{2(N+1)}\\right)}.\n$$\nThis inequality must hold for all modes, i.e., for all $k=1, \\dots, N$. The most restrictive condition is imposed by the mode that maximizes the term $\\sin^2\\left(\\frac{k\\pi}{2(N+1)}\\right)$ in the denominator. The argument $\\frac{k\\pi}{2(N+1)}$ lies in the interval $(0, \\pi/2)$ for all $k \\in \\{1,\\dots,N\\}$. Since $\\sin(x)$ is increasing on $[0, \\pi/2]$, the maximum value occurs at the largest possible value of $k$, which is $k=N$.\nThis gives the necessary and sufficient stability condition for a fixed $N$:\n$$\n\\Delta t \\le \\frac{h^2}{2\\nu\\sin^2\\left(\\frac{N\\pi}{2(N+1)}\\right)}.\n$$\nThe problem asks for a sufficient condition of the form $\\Delta t\\le C\\,h^{2}/\\nu$ where the constant $C$ is independent of $N$. This condition must be valid for all $N \\ge 1$. Therefore, we must have:\n$$\nC \\frac{h^2}{\\nu} \\le \\frac{h^2}{2\\nu\\sin^2\\left(\\frac{N\\pi}{2(N+1)}\\right)} \\quad \\text{for all } N \\ge 1.\n$$\nThis simplifies to:\n$$\nC \\le \\frac{1}{2\\sin^2\\left(\\frac{N\\pi}{2(N+1)}\\right)}.\n$$\nTo ensure this holds for all $N$, $C$ must be less than or equal to the minimum value (infimum) of the right-hand side over all $N \\ge 1$:\n$$\nC \\le \\inf_{N \\ge 1} \\left\\{ \\frac{1}{2\\sin^2\\left(\\frac{N\\pi}{2(N+1)}\\right)} \\right\\}.\n$$\nLet's analyze the function $f(N) = \\frac{1}{2\\sin^2\\left(\\frac{N\\pi}{2(N+1)}\\right)}$. The argument of the sine function, $x_N = \\frac{N\\pi}{2(N+1)} = \\frac{\\pi}{2}\\left(1-\\frac{1}{N+1}\\right)$, is a monotonically increasing sequence that converges to $\\pi/2$ from below as $N \\to \\infty$. Since $\\sin^2(x)$ is increasing on $[0, \\pi/2]$, the denominator $2\\sin^2(x_N)$ is also a monotonically increasing function of $N$. Consequently, $f(N)$ is a monotonically decreasing function of $N$. The infimum is the limit as $N \\to \\infty$:\n$$\n\\inf_{N \\ge 1} f(N) = \\lim_{N \\to \\infty} \\frac{1}{2\\sin^2\\left(\\frac{N\\pi}{2(N+1)}\\right)} = \\frac{1}{2\\sin^2\\left(\\lim_{N \\to \\infty}\\frac{N\\pi}{2(N+1)}\\right)} = \\frac{1}{2\\sin^2(\\pi/2)} = \\frac{1}{2(1)^2} = \\frac{1}{2}.\n$$\nThe sharpest (largest) possible constant $C$ that is independent of $N$ is this infimum. Any value $C > 1/2$ would violate the stability condition for a sufficiently large $N$. Thus, the sharp constant is $C = 1/2$.",
            "answer": "$$\n\\boxed{\\frac{1}{2}}\n$$"
        },
        {
            "introduction": "A theoretical understanding of convergence must be confirmed with numerical evidence, a process known as code verification. This hands-on problem demonstrates a powerful technique for this purpose: designing a grid refinement study with a clever setup that isolates spatial discretization error. By empirically measuring the convergence rate and comparing it to the theoretical prediction, you can gain confidence that a numerical implementation is correct .",
            "id": "3420375",
            "problem": "Consider the one-dimensional heat equation on the closed interval $[0,1]$ with homogeneous Dirichlet boundary conditions and a smooth initial condition. The governing partial differential equation (PDE) is\n$$\n\\frac{\\partial u}{\\partial t}(x,t) = \\alpha \\frac{\\partial^2 u}{\\partial x^2}(x,t), \\quad x \\in (0,1), \\quad t \\ge 0,\n$$\nwith boundary conditions\n$$\nu(0,t) = 0, \\quad u(1,t) = 0,\n$$\nand initial condition\n$$\nu(x,0) = \\sin(\\pi x).\n$$\nAssume the thermal diffusivity parameter is $\\alpha = 1$ in dimensionless units. The exact solution of the PDE under these conditions is\n$$\nu(x,t) = \\sin(\\pi x)\\, e^{-\\pi^2 t}.\n$$\nUsing the method of lines (MOL), discretize only the spatial domain to produce a semi-discrete system of ordinary differential equations. Use a uniform grid of $N$ interior points with spacing $h = \\frac{1}{N+1}$ and second-order centered finite differences to approximate the spatial derivative operator. Denote the resulting discrete Laplacian operator by the matrix $A_h \\in \\mathbb{R}^{N \\times N}$ and the semi-discrete system by\n$$\n\\frac{d \\mathbf{u}(t)}{dt} = A_h \\mathbf{u}(t), \\quad \\mathbf{u}(0) = \\mathbf{u}_0,\n$$\nwhere $\\mathbf{u}(t)$ approximates $u(x_i,t)$ at grid points $x_i = i h$ for $i = 1,2,\\ldots,N$. Integrate this semi-discrete system exactly in time to isolate spatial error; that is, compute\n$$\n\\mathbf{u}(T) = e^{T A_h} \\mathbf{u}_0\n$$\nby leveraging the fact that the chosen initial condition produces a discrete eigenvector under the centered-difference Laplacian for homogeneous Dirichlet boundary conditions. The continuous reference solution at the grid points is\n$$\n\\mathbf{u}_{\\text{ref}}(T)_i = \\sin(\\pi x_i)\\, e^{-\\pi^2 T}.\n$$\nDefine the discrete $L^2$ error at final time $T$ as\n$$\nE_h(T) = \\left( h \\sum_{i=1}^N \\left(\\mathbf{u}(T)_i - \\mathbf{u}_{\\text{ref}}(T)_i\\right)^2 \\right)^{1/2}.\n$$\nYour task is to design and execute a grid refinement study that isolates the spatial discretization error by using the analytically integrated semi-discrete system described above. Derive, justify, and predict the observed convergence rate in $h$ for the discrete $L^2$ error when $N$ is doubled (that is, when $h$ is halved). Then, implement a program that computes the empirical convergence rate between successive grid refinements.\n\nTest suite parameters:\n- Use three final times $T \\in \\{0.1,\\; 1.0,\\; 10.0\\}$.\n- For each $T$, use the sequence of interior grid sizes $N \\in \\{15,\\; 31,\\; 63,\\; 127\\}$ so that the grid spacing halves exactly between successive $N$ values because $h = \\frac{1}{N+1}$.\n- For each $T$, compute the errors $E_{h_k}(T)$ for $k = 1,2,3,4$ and the empirical convergence rates\n$$\np_k = \\frac{\\log\\left(E_{h_k}(T) / E_{h_{k+1}}(T)\\right)}{\\log\\left(h_k / h_{k+1}\\right)}, \\quad k = 1,2,3.\n$$\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The output format must be the list of three lists, one per $T$, where each inner list contains the three empirical convergence rates $p_k$ for that $T$, in the order of successive grid refinements. For example,\n$$\n[ [p_1(T_1), p_2(T_1), p_3(T_1)], [p_1(T_2), p_2(T_2), p_3(T_2)], [p_1(T_3), p_2(T_3), p_3(T_3)] ].\n$$\nAll numerical results must be reported as floating-point values without units.",
            "solution": "The task is to perform a grid refinement study for the numerical solution of the one-dimensional heat equation using the Method of Lines (MOL). The core idea is to isolate the spatial discretization error by integrating the resulting semi-discrete system of ordinary differential equations (ODEs) analytically.\n\nFirst, we analyze the expected convergence rate. The spatial derivative $\\frac{\\partial^2 u}{\\partial x^2}$ is approximated using a second-order centered finite difference scheme. The local truncation error of this approximation is of order $O(h^2)$, where $h$ is the spatial grid spacing. Since the problem specifies that the semi-discrete system of ODEs is to be solved exactly in time, there is no temporal discretization error. The global error of the numerical solution is therefore entirely determined by the spatial discretization. For a stable and consistent scheme, the order of the global error matches the order of the local truncation error. Thus, we expect the discrete $L^2$ error, $E_h(T)$, to behave as $E_h(T) \\approx C h^2$ for some constant $C$ that depends on the final time $T$ and properties of the solution, but not on $h$.\n\nThe empirical convergence rate $p$ is calculated by comparing errors from two different grid spacings, $h_k$ and $h_{k+1}$. According to the problem, the grids are refined such that $h_{k+1} = h_k/2$. The rate is given by:\n$$\np_k = \\frac{\\log(E_{h_k} / E_{h_{k+1}})}{\\log(h_k / h_{k+1})}\n$$\nSubstituting $E_h \\approx C h^2$ and $h_{k+1} = h_k/2$, we get:\n$$\np_k \\approx \\frac{\\log((C h_k^2) / (C (h_k/2)^2))}{\\log(h_k / (h_k/2))} = \\frac{\\log(4)}{\\log(2)} = \\frac{2 \\log(2)}{\\log(2)} = 2\n$$\nThe predicted convergence rate is $2$. Our numerical experiment should yield rates that approach this value as the grid is refined.\n\nNow, we detail the implementation of the Method of Lines.\nThe spatial domain $[0,1]$ is discretized using $N$ interior points $x_i = i h$ for $i=1, 2, \\ldots, N$, with grid spacing $h = 1/(N+1)$. The function $u(x,t)$ at these points is approximated by a vector $\\mathbf{u}(t)$ where $\\mathbf{u}(t)_i \\approx u(x_i, t)$.\nThe PDE is $\\frac{\\partial u}{\\partial t} = \\alpha \\frac{\\partial^2 u}{\\partial x^2}$, with $\\alpha=1$. Applying the centered finite difference formula for the second derivative,\n$$\n\\frac{\\partial^2 u}{\\partial x^2}\\bigg|_{x=x_i} \\approx \\frac{u(x_{i-1}, t) - 2u(x_i, t) + u(x_{i+1}, t)}{h^2}\n$$\nwe obtain a system of ODEs for the interior points:\n$$\n\\frac{d\\mathbf{u}_i(t)}{dt} = \\frac{1}{h^2} (\\mathbf{u}_{i-1}(t) - 2\\mathbf{u}_i(t) + \\mathbf{u}_{i+1}(t)), \\quad i=1, \\ldots, N\n$$\nThe boundary conditions $u(0,t)=0$ and $u(1,t)=0$ imply $\\mathbf{u}_0(t)=0$ and $\\mathbf{u}_{N+1}(t)=0$. The system can be written in matrix form as:\n$$\n\\frac{d\\mathbf{u}(t)}{dt} = A_h \\mathbf{u}(t)\n$$\nwhere $A_h$ is an $N \\times N$ tridiagonal matrix:\n$$\nA_h = \\frac{1}{h^2} \\begin{pmatrix}\n-2 & 1 & 0 & \\cdots & 0 \\\\\n1 & -2 & 1 & \\cdots & 0 \\\\\n0 & \\ddots & \\ddots & \\ddots & 0 \\\\\n\\vdots & & 1 & -2 & 1 \\\\\n0 & \\cdots & 0 & 1 & -2\n\\end{pmatrix}\n$$\nThe exact solution to this ODE system is $\\mathbf{u}(T) = e^{T A_h} \\mathbf{u}_0$. Computing the matrix exponential $e^{T A_h}$ directly can be computationally expensive and introduce numerical error. However, the problem provides a crucial simplification by choosing the initial condition $u(x,0) = \\sin(\\pi x)$. The corresponding discrete initial condition vector $\\mathbf{u}_0$ has components $(\\mathbf{u}_0)_i = \\sin(\\pi x_i) = \\sin(\\pi i h)$.\n\nThis specific initial condition vector is an eigenvector of the matrix $A_h$. The eigenvectors $\\mathbf{v}_k$ and eigenvalues $\\lambda_k$ of $A_h$ are known to be:\n$$\n(\\mathbf{v}_k)_j = \\sin\\left(\\frac{k j \\pi}{N+1}\\right) = \\sin(k \\pi x_j), \\quad k=1, \\ldots, N\n$$\n$$\n\\lambda_k = \\frac{2}{h^2}(\\cos(k \\pi h) - 1) = -\\frac{4}{h^2} \\sin^2\\left(\\frac{k \\pi h}{2}\\right)\n$$\nOur initial condition $\\mathbf{u}_0$ corresponds to the first eigenvector $\\mathbf{v}_1$ (for $k=1$). Since $\\mathbf{u}_0 = \\mathbf{v}_1$, the action of the matrix exponential simplifies significantly:\n$$\n\\mathbf{u}(T) = e^{T A_h} \\mathbf{u}_0 = e^{T A_h} \\mathbf{v}_1 = e^{T \\lambda_1} \\mathbf{v}_1\n$$\nwhere $\\lambda_1 = -\\frac{4}{h^2} \\sin^2\\left(\\frac{\\pi h}{2}\\right)$. This allows us to compute the numerical solution vector analytically without forming or exponentiating the matrix $A_h$.\n\nThe error calculation is also simplified. The reference solution at the grid points is $\\mathbf{u}_{\\text{ref}}(T)_i = \\sin(\\pi x_i) e^{-\\pi^2 T}$. The error vector is:\n$$\n(\\mathbf{u}(T) - \\mathbf{u}_{\\text{ref}}(T))_i = (e^{T \\lambda_1} - e^{-\\pi^2 T})\\sin(\\pi x_i)\n$$\nThe discrete $L^2$ error is defined as $E_h(T) = \\left( h \\sum_{i=1}^N \\left(\\mathbf{u}(T)_i - \\mathbf{u}_{\\text{ref}}(T)_i\\right)^2 \\right)^{1/2}$. Substituting the error vector:\n$$\nE_h(T) = \\left( h \\sum_{i=1}^N \\left[ (e^{T \\lambda_1} - e^{-\\pi^2 T})\\sin(\\pi x_i) \\right]^2 \\right)^{1/2} = |e^{T \\lambda_1} - e^{-\\pi^2 T}| \\left( h \\sum_{i=1}^N \\sin^2(\\pi x_i) \\right)^{1/2}\n$$\nThe sum has a known closed form: $\\sum_{i=1}^N \\sin^2(\\frac{\\pi i}{N+1}) = \\frac{N+1}{2}$. Therefore, the term under the square root becomes:\n$$\nh \\sum_{i=1}^N \\sin^2(\\pi x_i) = \\frac{1}{N+1} \\cdot \\frac{N+1}{2} = \\frac{1}{2}\n$$\nThis simplifies the error computation to a single, elegant expression that depends only on $T$, $h$, and known constants, completely avoiding loops for summation and thus eliminating any quadrature error from the norm calculation:\n$$\nE_h(T) = \\frac{1}{\\sqrt{2}} |e^{T \\lambda_1} - e^{-\\pi^2 T}|\n$$\nThe procedure is to calculate this error $E_{h_k}(T)$ for each $N_k$ in the given sequence, and then compute the empirical rates $p_k = \\log_2(E_{h_k}(T) / E_{h_{k+1}}(T))$ for $k=1,2,3$. This is performed for each final time $T$.",
            "answer": "[[1.9998188169431835, 1.999954699569766, 1.9999886745508738], [1.9998188169431835, 1.999954699569766, 1.9999886745508738], [1.9998188169431835, 1.999954699569766, 1.9999886745508738]]"
        }
    ]
}