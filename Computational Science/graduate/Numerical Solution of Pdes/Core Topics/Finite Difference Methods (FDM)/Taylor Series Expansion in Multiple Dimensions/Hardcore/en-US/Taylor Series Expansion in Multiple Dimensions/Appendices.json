{
    "hands_on_practices": [
        {
            "introduction": "The foundation of the finite difference method lies in the ability to construct accurate approximations for derivatives using function values at discrete grid points. This first practice guides you through this fundamental process from first principles . By systematically applying the multivariate Taylor series, you will derive a compact stencil for the mixed partial derivative $\\frac{\\partial^2 f}{\\partial x \\partial y}$, gaining insight into how specific linear combinations of function values can isolate a desired derivative while canceling out other terms.",
            "id": "3227881",
            "problem": "A smooth scalar field $f(x,y)$ is sampled on a rectangular grid with uniform spacings $\\Delta x$ in the $x$-direction and $\\Delta y$ in the $y$-direction. Grid nodes are located at $(x_i, y_j)$, where $x_i = x_0 + i \\Delta x$ and $y_j = y_0 + j \\Delta y$ for integers $i$ and $j$. You are to approximate the mixed second-order partial derivative $\\frac{\\partial^2 f}{\\partial x \\partial y}$ at the interior node $(x_i, y_j)$ using only the four diagonal neighbor values $f_{i+1,j+1}$, $f_{i+1,j-1}$, $f_{i-1,j+1}$, and $f_{i-1,j-1}$, where $f_{i,j} := f(x_i,y_j)$. Assume $f$ has continuous partial derivatives up to order $4$ in a neighborhood of $(x_i,y_j)$.\n\nStarting from the multivariate Taylor series expansion of $f$ about $(x_i,y_j)$, systematically construct a linear combination of $f$ evaluated at $(x_i \\pm \\Delta x, y_j \\pm \\Delta y)$ that isolates $\\frac{\\partial^2 f}{\\partial x \\partial y}(x_i,y_j)$ and attains second-order accuracy in both $\\Delta x$ and $\\Delta y$. Do not use any pre-memorized stencil formulas; derive the coefficients from first principles.\n\nPresent your final answer as a single closed-form analytic expression involving $f_{i\\pm 1, j\\pm 1}$, $\\Delta x$, and $\\Delta y$. Report only the stencil formula as your final answer.",
            "solution": "We seek a linear combination of the four corner points that approximates $\\frac{\\partial^2 f}{\\partial x \\partial y}$ at $(x_i,y_j)$, which we denote as $f_{xy}$.\n$$ L = A f_{i+1,j+1} + B f_{i+1,j-1} + C f_{i-1,j+1} + D f_{i-1,j-1} $$\nWe write the multivariate Taylor series for each point around $(x_i,y_j)$, using subscript notation for partial derivatives (e.g., $f_x$, $f_y$).\n\\begin{align*}\nf_{i+1,j+1} = f + \\Delta x f_x + \\Delta y f_y + \\frac{\\Delta x^2}{2}f_{xx} + \\Delta x \\Delta y f_{xy} + \\frac{\\Delta y^2}{2}f_{yy} + \\mathcal{O}(\\Delta^3) \\\\\nf_{i+1,j-1} = f + \\Delta x f_x - \\Delta y f_y + \\frac{\\Delta x^2}{2}f_{xx} - \\Delta x \\Delta y f_{xy} + \\frac{\\Delta y^2}{2}f_{yy} + \\mathcal{O}(\\Delta^3) \\\\\nf_{i-1,j+1} = f - \\Delta x f_x + \\Delta y f_y + \\frac{\\Delta x^2}{2}f_{xx} - \\Delta x \\Delta y f_{xy} + \\frac{\\Delta y^2}{2}f_{yy} + \\mathcal{O}(\\Delta^3) \\\\\nf_{i-1,j-1} = f - \\Delta x f_x - \\Delta y f_y + \\frac{\\Delta x^2}{2}f_{xx} + \\Delta x \\Delta y f_{xy} + \\frac{\\Delta y^2}{2}f_{yy} + \\mathcal{O}(\\Delta^3)\n\\end{align*}\nwhere $\\mathcal{O}(\\Delta^3)$ denotes terms of total order three or higher.\n\nTo systematically isolate $f_{xy}$, we form combinations that cancel unwanted terms. We can first form differences along the y-direction for fixed $i+1$ and $i-1$.\n$$ f_{i+1,j+1} - f_{i+1,j-1} = 2\\Delta y f_y + 2\\Delta x \\Delta y f_{xy} + \\mathcal{O}(\\Delta^3) $$\n$$ f_{i-1,j+1} - f_{i-1,j-1} = 2\\Delta y f_y - 2\\Delta x \\Delta y f_{xy} + \\mathcal{O}(\\Delta^3) $$\nNow, we take the difference of these two results. This is equivalent to differencing in the $x$-direction, which cancels the $f_y$ term and reinforces the $f_{xy}$ term.\n$$ (f_{i+1,j+1} - f_{i+1,j-1}) - (f_{i-1,j+1} - f_{i-1,j-1}) = 4\\Delta x \\Delta y f_{xy} + \\mathcal{O}(\\Delta^4) $$\nDue to the symmetry of the stencil, the third-order error terms cancel out, leaving a fourth-order error term. The leading truncation error is $\\mathcal{O}(\\Delta x^2, \\Delta y^2)$, so the scheme is second-order accurate.\n\nTo get the final formula for $f_{xy}$, we divide by the coefficient $4\\Delta x \\Delta y$:\n$$ f_{xy} \\approx \\frac{f_{i+1,j+1} - f_{i+1,j-1} - f_{i-1,j+1} + f_{i-1,j-1}}{4 \\Delta x \\Delta y} $$\nThis is the required stencil formula derived from first principles.",
            "answer": "$$\n\\boxed{\n\\frac{f_{i+1,j+1} - f_{i+1,j-1} - f_{i-1,j+1} + f_{i-1,j-1}}{4 \\Delta x \\Delta y}\n}\n$$"
        },
        {
            "introduction": "Once a stencil is derived, its quality must be rigorously assessed, a task for which Taylor series expansions are the primary analytical tool. This practice moves beyond simple derivation to the analysis and optimization of a more complex numerical operator . By performing a detailed truncation error analysis of the general nine-point Laplacian stencil, you will not only determine its order of accuracy but also explore how to improve its properties, such as achieving rotational invariance by carefully choosing the stencil weights.",
            "id": "3452832",
            "problem": "Consider a uniform Cartesian grid in $\\mathbb{R}^{2}$ with mesh width $h0$ and grid points $(x_{i},y_{j})=(ih,jh)$. Define a nine-point finite-difference operator $L_{h}$ that approximates the Laplacian $\\Delta u = u_{xx}+u_{yy}$ at $(x_{i},y_{j})$ by including the four axial neighbors $(\\pm h,0)$ and $(0,\\pm h)$, the four diagonal neighbors $(\\pm h,\\pm h)$, and the center, with constant weights $w_{1}$ for each axial neighbor, $w_{2}$ for each diagonal neighbor, and $w_{0}$ for the center:\n$$\nL_{h}u(x_{i},y_{j}) \\;=\\; \\frac{1}{h^{2}}\\Bigg[w_{1}\\sum_{(\\alpha,\\beta)\\in\\{(\\pm 1,0),(0,\\pm 1)\\}} u(x_{i}+\\alpha h,y_{j}+\\beta h)\\;+\\;w_{2}\\sum_{(\\alpha,\\beta)\\in\\{(\\pm 1,\\pm 1)\\}} u(x_{i}+\\alpha h,y_{j}+\\beta h)\\;+\\;w_{0}\\,u(x_{i},y_{j})\\Bigg].\n$$\nUsing the two-dimensional Taylor series expansion about $(x_{i},y_{j})$ up to and including terms of order $h^{4}$, perform a truncation error analysis of $L_{h}u-\\Delta u$ under the standard consistency conditions that constants are annihilated and the second-derivative coefficient matches that of $\\Delta u$, namely\n$$\n4w_{1}+4w_{2}+w_{0}=0,\\qquad w_{1}+2w_{2}=1.\n$$\nThen answer the following, starting from these Taylor expansions and without invoking any pre-packaged stencil formulas:\n\n- Compute the consistency order $p$ of $L_{h}$ as an approximation to $\\Delta u$.\n\n- Determine the necessary and sufficient relation between $w_{1}$ and $w_{2}$ so that the leading truncation error at order $h^{2}$ is rotationally invariant (that is, proportional to $\\Delta^{2}u = u_{xxxx}+2u_{xxyy}+u_{yyyy}$), thereby eliminating directional anisotropy up to fourth-order derivatives.\n\n- Under the normalization above, determine the unique triple $(w_{1},w_{2},w_{0})$ that satisfies the rotational-invariance condition and compute the constant $\\kappa$ such that\n$$\nL_{h}u - \\Delta u \\;=\\; \\kappa\\,h^{2}\\,\\Delta^{2}u \\;+\\; \\mathcal{O}(h^{4}).\n$$\n\nGive your final answer as a single row matrix in the order $(p,\\;w_{1},\\;w_{2},\\;w_{0},\\;\\kappa)$. No numerical rounding is required; provide exact values.",
            "solution": "The user has provided a valid problem statement from the field of numerical analysis. I will now proceed with a complete and reasoned solution.\n\nThe objective is to analyze the truncation error of the nine-point finite-difference operator $L_{h}$ that approximates the Laplacian $\\Delta u$. The operator is defined as:\n$$\nL_{h}u(x,y) \\;=\\; \\frac{1}{h^{2}}\\Bigg[w_{1}\\sum_{(\\alpha,\\beta)\\in\\{(\\pm 1,0),(0,\\pm 1)\\}} u(x+\\alpha h,y+\\beta h)\\;+\\;w_{2}\\sum_{(\\alpha,\\beta)\\in\\{(\\pm 1,\\pm 1)\\}} u(x+\\alpha h,y+\\beta h)\\;+\\;w_{0}\\,u(x,y)\\Bigg]\n$$\nwhere $(x,y)$ is a grid point $(x_i, y_j)$. We use the two-dimensional Taylor series expansion of a sufficiently smooth function $u(x,y)$ around the point $(x,y)$. The expansion for $u(x+\\Delta x, y+\\Delta y)$ is given by:\n$$\nu(x+\\Delta x, y+\\Delta y) = \\sum_{n=0}^{\\infty} \\frac{1}{n!} \\left( \\Delta x \\frac{\\partial}{\\partial x} + \\Delta y \\frac{\\partial}{\\partial y} \\right)^n u(x,y)\n$$\nWe need terms up to order a minimum of $h^4$ to analyze the leading truncation error term, which is expected to be $\\mathcal{O}(h^2)$ after dividing by $h^2$. Let partial derivatives be denoted by subscripts, e.g., $u_{x} = \\frac{\\partial u}{\\partial x}$, $u_{xx} = \\frac{\\partial^2 u}{\\partial x^2}$. Let $\\Delta x = \\alpha h$ and $\\Delta y = \\beta h$.\n$$\nu(x+\\alpha h, y+\\beta h) = u + h(\\alpha u_x + \\beta u_y) + \\frac{h^2}{2}(\\alpha^2 u_{xx} + 2\\alpha\\beta u_{xy} + \\beta^2 u_{yy}) + \\frac{h^3}{6}(\\alpha u_x + \\beta u_y)^{(3)}u + \\frac{h^4}{24}(\\alpha u_x + \\beta u_y)^{(4)}u + \\mathcal{O}(h^5)\n$$\nWe compute the sums for the axial and diagonal neighbors separately. Due to the symmetry of the summations over $(\\alpha, \\beta)$, terms with odd powers of $\\alpha$ or $\\beta$ will vanish.\n\nFor the sum over axial neighbors, $(\\alpha,\\beta) \\in \\{(\\pm 1,0), (0,\\pm 1)\\}$:\n$$\n\\sum_{\\text{axial}} u(x+\\alpha h, y+\\beta h) = u(x+h,y) + u(x-h,y) + u(x,y+h) + u(x,y-h)\n$$\nExpanding and summing:\n$$(u + hu_x + \\frac{h^2}{2}u_{xx} + \\frac{h^3}{6}u_{xxx} + \\frac{h^4}{24}u_{xxxx}) + (u - hu_x + \\frac{h^2}{2}u_{xx} - \\frac{h^3}{6}u_{xxx} + \\frac{h^4}{24}u_{xxxx}) + \\mathcal{O}(h^6) \\\\ = 2u + h^2 u_{xx} + \\frac{h^4}{12}u_{xxxx} + \\mathcal{O}(h^6)$$\nBy symmetry, the sum for the $y$-direction is $2u + h^2 u_{yy} + \\frac{h^4}{12}u_{yyyy} + \\mathcal{O}(h^6)$.\nThus, the total sum for the axial neighbors is:\n$$\n\\sum_{\\text{axial}} u = 4u + h^2(u_{xx} + u_{yy}) + \\frac{h^4}{12}(u_{xxxx} + u_{yyyy}) + \\mathcal{O}(h^6)\n$$\n\nFor the sum over diagonal neighbors, $(\\alpha,\\beta) \\in \\{(\\pm 1,\\pm 1)\\}$:\n$$\n\\sum_{\\text{diag}} u(x+\\alpha h, y+\\beta h) = u(x+h,y+h) + u(x-h,y+h) + u(x+h,y-h) + u(x-h,y-h)\n$$\nThe expansion for $u(x+h,y+h)$ includes terms like $h(u_x+u_y)$, $\\frac{h^2}{2}(u_{xx}+2u_{xy}+u_{yy})$, etc. When we sum over the four points, all terms with an odd power of $h$ or odd order derivatives like $u_{xy}$, $u_{xxx}$, $u_{xxy}$ cancel out. We collect the even-powered, even-derivative terms:\n\\begin{itemize}\n    \\item Zeroth-order term: $4u$\n    \\item Second-order term: $4 \\times \\frac{h^2}{2}(u_{xx} + u_{yy}) = 2h^2(u_{xx}+u_{yy})$\n    \\item Fourth-order term: The $(\\alpha u_x + \\beta u_y)^{(4)}$ expansion contains $\\alpha^4 u_{xxxx} + 4\\alpha^3\\beta u_{xxxy} + 6\\alpha^2\\beta^2 u_{xxyy} + \\dots$. For $(\\alpha, \\beta) \\in \\{(\\pm 1, \\pm 1)\\}$, we have $\\alpha^2=1$, $\\beta^2=1$. The sum is:\n    $$ \\frac{h^4}{24} \\sum_{\\alpha,\\beta=\\pm 1} (\\alpha^4 u_{xxxx} + 6\\alpha^2\\beta^2 u_{xxyy} + \\beta^4 u_{yyyy}) = \\frac{h^4}{24} (4u_{xxxx} + 24u_{xxyy} + 4u_{yyyy}) $$\n\\end{itemize}\nSo, the total sum for the diagonal neighbors is:\n$$\n\\sum_{\\text{diag}} u = 4u + 2h^2(u_{xx}+u_{yy}) + \\frac{h^4}{6}(u_{xxxx} + 6u_{xxyy} + u_{yyyy}) + \\mathcal{O}(h^6)\n$$\n\nNow, we substitute these sums into the expression for $L_h u$:\n$$\nL_h u = \\frac{1}{h^2} \\left[ w_1 \\left( 4u + h^2(u_{xx}+u_{yy}) + \\frac{h^4}{12}(u_{xxxx}+u_{yyyy}) \\right) + w_2 \\left( 4u + 2h^2(u_{xx}+u_{yy}) + \\frac{h^4}{6}(u_{xxxx}+6u_{xxyy}+u_{yyyy}) \\right) + w_0 u \\right] + \\mathcal{O}(h^4)\n$$\nGrouping the terms by derivative order:\n$$\nL_h u = \\frac{u}{h^2}(4w_1+4w_2+w_0) + (u_{xx}+u_{yy})(w_1+2w_2) + h^2 \\left[ \\left(\\frac{w_1}{12}+\\frac{w_2}{6}\\right)(u_{xxxx}+u_{yyyy}) + \\frac{6w_2}{6}u_{xxyy} \\right] + \\mathcal{O}(h^4)\n$$\nWe apply the given consistency conditions: $4w_1+4w_2+w_0=0$ and $w_1+2w_2=1$.\nThe first condition ensures that the coefficient of $u/h^2$ is zero. The second condition ensures that the coefficient of $\\Delta u = u_{xx}+u_{yy}$ is one.\nThe expression for $L_h u$ simplifies to:\n$$\nL_h u = \\Delta u + h^2 \\left[ \\frac{w_1+2w_2}{12}(u_{xxxx}+u_{yyyy}) + w_2 u_{xxyy} \\right] + \\mathcal{O}(h^4)\n$$\nSubstituting $w_1+2w_2=1$ again into the error term:\n$$\nL_h u = \\Delta u + h^2 \\left[ \\frac{1}{12}(u_{xxxx}+u_{yyyy}) + w_2 u_{xxyy} \\right] + \\mathcal{O}(h^4)\n$$\nThe truncation error is $T = L_h u - \\Delta u$:\n$$\nT(u) = h^2 \\left[ \\frac{1}{12}(u_{xxxx}+u_{yyyy}) + w_2 u_{xxyy} \\right] + \\mathcal{O}(h^4)\n$$\n\nWith this expression, we can answer the questions.\n\n*   **Consistency Order $p$**:\n    The leading term in the truncation error is of order $h^2$. For the operator to have a higher order of consistency, the coefficient of $h^2$ must be identically zero for any sufficiently smooth function $u$. This would require $\\frac{1}{12}(u_{xxxx}+u_{yyyy}) + w_2 u_{xxyy} = 0$, which is not generally true. For instance, if $u(x,y)=x^4$, the term is $\\frac{1}{12}(24)=2 \\neq 0$. Thus, the consistency order is $p=2$.\n\n*   **Rotational Invariance Condition**:\n    The leading truncation error term is required to be proportional to the biharmonic operator $\\Delta^2 u = u_{xxxx}+2u_{xxyy}+u_{yyyy}$. This means there must exist a constant $\\kappa$ such that:\n    $$\n    h^2 \\left[ \\frac{1}{12}(u_{xxxx}+u_{yyyy}) + w_2 u_{xxyy} \\right] = \\kappa h^2 (u_{xxxx}+2u_{xxyy}+u_{yyyy})\n    $$\n    By comparing the coefficients of the partial derivatives, we obtain a system of equations for $w_2$ and $\\kappa$:\n    \\begin{align*}\n        [u_{xxxx}]:  \\quad \\frac{1}{12} = \\kappa \\\\\n        [u_{yyyy}]:  \\quad \\frac{1}{12} = \\kappa \\\\\n        [u_{xxyy}]:  \\quad w_2 = 2\\kappa\n    \\end{align*}\n    From the first equation, we find $\\kappa = \\frac{1}{12}$. Substituting this into the third equation yields $w_2 = 2 \\left(\\frac{1}{12}\\right) = \\frac{1}{6}$.\n    This gives the required value of $w_2$. The question asks for a relation between $w_1$ and $w_2$. We use the consistency condition $w_1+2w_2=1$. Substituting $w_2=1/6$, we get $w_1 + 2(1/6) = 1$, which gives $w_1 = 1 - 1/3 = 2/3$. The relation between $w_1=2/3$ and $w_2=1/6$ is $w_1 = 4w_2$. This relation is necessary and sufficient.\n\n*   **Unique Triple $(w_1, w_2, w_0)$ and Constant $\\kappa$**:\n    We have a system of three linear equations for the weights:\n    1.  $4w_1 + 4w_2 + w_0 = 0$ (Consistency 1)\n    2.  $w_1 + 2w_2 = 1$ (Consistency 2)\n    3.  $w_1 = 4w_2$ (Rotational Invariance)\n\n    Substitute (3) into (2):\n    $4w_2 + 2w_2 = 1 \\implies 6w_2 = 1 \\implies w_2 = \\frac{1}{6}$.\n    From this, we find $w_1$:\n    $w_1 = 4w_2 = 4\\left(\\frac{1}{6}\\right) = \\frac{4}{6} = \\frac{2}{3}$.\n    Finally, substitute $w_1$ and $w_2$ into (1) to find $w_0$:\n    $4\\left(\\frac{2}{3}\\right) + 4\\left(\\frac{1}{6}\\right) + w_0 = 0 \\implies \\frac{8}{3} + \\frac{4}{6} + w_0 = 0 \\implies \\frac{8}{3} + \\frac{2}{3} + w_0 = 0 \\implies \\frac{10}{3} + w_0 = 0 \\implies w_0 = -\\frac{10}{3}$.\n    The unique triple is $(w_1, w_2, w_0) = \\left(\\frac{2}{3}, \\frac{1}{6}, -\\frac{10}{3}\\right)$.\n\n    The constant $\\kappa$ was determined during the derivation of the rotational invariance condition. From comparing coefficients, we found $\\kappa = \\frac{1}{12}$.\n\n    The resulting truncation error is:\n    $L_h u - \\Delta u = \\frac{1}{12} h^2 (u_{xxxx} + 2u_{xxyy} + u_{yyyy}) + \\mathcal{O}(h^4) = \\frac{1}{12} h^2 \\Delta^2 u + \\mathcal{O}(h^4)$.\n    Thus, $\\kappa = \\frac{1}{12}$.\n\nThe final answer is the row matrix $(p, w_1, w_2, w_0, \\kappa)$.\n$p = 2$\n$w_1 = \\frac{2}{3}$\n$w_2 = \\frac{1}{6}$\n$w_0 = -\\frac{10}{3}$\n$\\kappa = \\frac{1}{12}$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 2  \\frac{2}{3}  \\frac{1}{6}  -\\frac{10}{3}  \\frac{1}{12} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "A significant challenge in solving PDEs on structured grids is the accurate implementation of boundary conditions on domains with curved or oblique boundaries. This exercise tackles this advanced topic, showing how the Taylor series framework can be adapted to non-grid-aligned geometries . You will construct a one-sided, second-order accurate stencil for a Neumann boundary condition by working in a local coordinate system defined by the boundary normal, a powerful technique essential for high-fidelity simulations.",
            "id": "3452735",
            "problem": "Consider a twice continuously differentiable solution $u$ of a second-order linear partial differential equation (PDE) in two space dimensions posed on a smooth domain with a Neumann boundary condition. Let the boundary pass through the point $\\boldsymbol{x}_B = (0,0)$ with unit inward normal $\\boldsymbol{n} = \\frac{1}{\\sqrt{2}}(1,1)$. A uniform Cartesian grid with spacing $h0$ is given, and the three nearest interior grid points lying along the inward normal ray from $\\boldsymbol{x}_B$ are $P_1=(h,h)$, $P_2=(2h,2h)$, and $P_3=(3h,3h)$. Using Taylor series expansion in multiple dimensions projected onto the boundary normal direction, construct a linear combination of the form\n$$\nw_1\\,u(P_1) + w_2\\,u(P_2) + w_3\\,u(P_3)\n$$\nthat provides a second-order accurate approximation to the normal derivative $\\frac{\\partial u}{\\partial n}(\\boldsymbol{x}_B)$.\n\nYour derivation must start from Taylorâ€™s theorem in multiple dimensions and reason in local coordinates aligned with the normal and tangential directions at the boundary point. Enforce the necessary consistency conditions so that the resulting Neumann stencil is second-order accurate in $h$, using only the interior data at $P_1,P_2,P_3$.\n\nAnswer specification: Report only the coefficient $w_2$ multiplying $u(P_2)=u(2h,2h)$ in its simplest closed-form analytic expression as a function of $h$. The final answer must be a single expression. No rounding is required.",
            "solution": "The problem asks us to construct a linear combination of the values of a function $u$ at three interior grid points, $P_1$, $P_2$, and $P_3$, to approximate the normal derivative $\\frac{\\partial u}{\\partial n}$ at a boundary point $\\boldsymbol{x}_B$. The approximation must be second-order accurate in the grid spacing $h$.\n\nThe boundary point is given as $\\boldsymbol{x}_B = (0,0)$, and the unit inward normal is $\\boldsymbol{n} = \\frac{1}{\\sqrt{2}}(1,1)$. The interior grid points are $P_1=(h,h)$, $P_2=(2h,2h)$, and $P_3=(3h,3h)$. These points lie along the ray starting at $\\boldsymbol{x}_B$ in the direction of $\\boldsymbol{n}$. The distances of these points from the boundary point $\\boldsymbol{x}_B$ along the normal direction are:\n$s_1 = \\|P_1 - \\boldsymbol{x}_B\\|_2 = \\|(h,h)\\|_2 = \\sqrt{h^2+h^2} = \\sqrt{2}h$.\n$s_2 = \\|P_2 - \\boldsymbol{x}_B\\|_2 = \\|(2h,2h)\\|_2 = \\sqrt{(2h)^2+(2h)^2} = 2\\sqrt{2}h$.\n$s_3 = \\|P_3 - \\boldsymbol{x}_B\\|_2 = \\|(3h,3h)\\|_2 = \\sqrt{(3h)^2+(3h)^2} = 3\\sqrt{2}h$.\nLet us define a characteristic distance $d = \\sqrt{2}h$. The points are at distances $d$, $2d$, and $3d$ from $\\boldsymbol{x}_B$ along the normal.\n\nThe problem can be simplified by considering the behavior of the function $u$ along the normal line. Let $s$ be the coordinate along the inward normal direction starting from $\\boldsymbol{x}_B$. We can define a one-dimensional function $g(s) = u(\\boldsymbol{x}_B + s\\boldsymbol{n})$. The normal derivative at the boundary is then $g'(0) = \\frac{\\partial u}{\\partial n}(\\boldsymbol{x}_B)$. The values of $u$ at the interior points correspond to $g(d)$, $g(2d)$, and $g(3d)$.\n\nWe are seeking weights $w_1, w_2, w_3$ such that the linear combination\n$$\nL = w_1 u(P_1) + w_2 u(P_2) + w_3 u(P_3) = w_1 g(d) + w_2 g(2d) + w_3 g(3d)\n$$\nis a second-order accurate approximation to $g'(0)$. This means that the truncation error, $L - g'(0)$, must be of order $h^2$, which is equivalent to being of order $d^2$ since $d^2 = 2h^2$.\n\nTo determine the weights, we expand $g(s)$ in a Taylor series around $s=0$. Assuming the solution $u$ is sufficiently smooth, we have:\n$$\ng(s) = g(0) + s g'(0) + \\frac{s^2}{2!} g''(0) + \\frac{s^3}{3!} g'''(0) + \\mathcal{O}(s^4)\n$$\nLet's denote $g(0) = u_B$, $g'(0) = u_n$, $g''(0) = u_{nn}$, etc.\nThe values at the grid points can be expanded as:\n$g(d) = u_B + d u_n + \\frac{d^2}{2} u_{nn} + \\frac{d^3}{6} u_{nnn} + \\mathcal{O}(d^4)$\n$g(2d) = u_B + (2d) u_n + \\frac{(2d)^2}{2} u_{nn} + \\frac{(2d)^3}{6} u_{nnn} + \\mathcal{O}(d^4)$\n$g(3d) = u_B + (3d) u_n + \\frac{(3d)^2}{2} u_{nn} + \\frac{(3d)^3}{6} u_{nnn} + \\mathcal{O}(d^4)$\n\nSubstituting these expansions into the linear combination $L$:\n$$\nL = w_1 \\left( u_B + d u_n + \\frac{d^2}{2} u_{nn} + \\dots \\right) + w_2 \\left( u_B + 2d u_n + \\frac{4d^2}{2} u_{nn} + \\dots \\right) + w_3 \\left( u_B + 3d u_n + \\frac{9d^2}{2} u_{nn} + \\dots \\right)\n$$\nGrouping terms by the derivatives of $u$ at the boundary:\n$$\nL = (w_1 + w_2 + w_3) u_B + d(w_1 + 2w_2 + 3w_3) u_n + \\frac{d^2}{2}(w_1 + 4w_2 + 9w_3) u_{nn} + \\frac{d^3}{6}(w_1 + 8w_2 + 27w_3) u_{nnn} + \\mathcal{O}(d^4)\n$$\nWe require that $L$ approximates $u_n$. The value $u_B = u(\\boldsymbol{x}_B)$ is generally unknown in a Neumann problem. Therefore, its coefficient in the approximation formula must be zero. This gives our first condition:\n$$\n(1) \\quad w_1 + w_2 + w_3 = 0\n$$\nNext, we require the coefficient of $u_n$ to be $1$:\n$$\n(2) \\quad d(w_1 + 2w_2 + 3w_3) = 1\n$$\nWith these two conditions, the approximation is $L = u_n + \\frac{d^2}{2}(w_1 + 4w_2 + 9w_3) u_{nn} + \\mathcal{O}(d^3)$. The weights $w_i$ must scale as $1/d$ from condition $(2)$. Thus, the leading error term involving $u_{nn}$ is of order $d^2 \\cdot (1/d) = d$, which is first-order accuracy ($\\mathcal{O}(h)$).\nTo achieve second-order accuracy ($\\mathcal{O}(h^2)$ or $\\mathcal{O}(d^2)$), the coefficient of the $u_{nn}$ term in the expansion of $L$ must be zero. This gives our third condition:\n$$\n(3) \\quad \\frac{d^2}{2}(w_1 + 4w_2 + 9w_3) = 0 \\implies w_1 + 4w_2 + 9w_3 = 0\n$$\nWith this condition, the leading error term will be from the $u_{nnn}$ term, which is proportional to $d^3 \\cdot (1/d) = d^2 = 2h^2=\\mathcal{O}(h^2)$. This ensures the method is second-order accurate.\n\nWe now have a system of three linear equations for the three weights $w_1, w_2, w_3$:\n$$\n\\begin{cases}\nw_1 + w_2 + w_3 = 0 \\\\\nw_1 + 2w_2 + 3w_3 = \\frac{1}{d} \\\\\nw_1 + 4w_2 + 9w_3 = 0\n\\end{cases}\n$$\nWe are asked to find the coefficient $w_2$. We can solve this system.\nFrom equation $(1)$, $w_1 = -w_2 - w_3$. Substituting this into equations $(2)$ and $(3)$:\nFor $(2)$: $(-w_2 - w_3) + 2w_2 + 3w_3 = \\frac{1}{d} \\implies w_2 + 2w_3 = \\frac{1}{d}$ (A)\nFor $(3)$: $(-w_2 - w_3) + 4w_2 + 9w_3 = 0 \\implies 3w_2 + 8w_3 = 0$ (B)\n\nWe now solve the $2 \\times 2$ system for $w_2$ and $w_3$. From equation (B), we can express $w_3$ in terms of $w_2$:\n$8w_3 = -3w_2 \\implies w_3 = -\\frac{3}{8}w_2$.\n\nSubstitute this expression for $w_3$ into equation (A):\n$w_2 + 2(-\\frac{3}{8}w_2) = \\frac{1}{d}$\n$w_2 - \\frac{6}{8}w_2 = \\frac{1}{d}$\n$w_2 - \\frac{3}{4}w_2 = \\frac{1}{d}$\n$\\frac{1}{4}w_2 = \\frac{1}{d}$\n$w_2 = \\frac{4}{d}$\n\nThe problem asks for $w_2$ as a function of $h$. We substitute $d = \\sqrt{2}h$:\n$w_2 = \\frac{4}{\\sqrt{2}h}$\nTo simplify this expression, we can rationalize the denominator:\n$w_2 = \\frac{4}{\\sqrt{2}h} \\cdot \\frac{\\sqrt{2}}{\\sqrt{2}} = \\frac{4\\sqrt{2}}{2h} = \\frac{2\\sqrt{2}}{h}$.\n\nThis is the coefficient of $u(P_2)$. For completeness, we could also find $w_3 = -\\frac{3}{8}w_2 = -\\frac{3}{8}\\frac{4}{d} = -\\frac{3}{2d}$, and $w_1 = -w_2 - w_3 = -\\frac{4}{d} - (-\\frac{3}{2d}) = (-\\frac{8}{2d} + \\frac{3}{2d}) = -\\frac{5}{2d}$.\nThe full approximation is $\\frac{1}{\\sqrt{2}h} \\left(-\\frac{5}{2}u(P_1) + 4u(P_2) - \\frac{3}{2}u(P_3) \\right)$.\n\nThe required coefficient is $w_2$.",
            "answer": "$$\\boxed{\\frac{2\\sqrt{2}}{h}}$$"
        }
    ]
}