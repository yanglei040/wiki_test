{
    "hands_on_practices": [
        {
            "introduction": "为了开始我们的实践探索，我们首先解决一个关于刚性系统的基本问题：为什么简单的A-稳定性有时是不够的？这个练习将指导你完成一个数值实验，以直观地看到A-稳定方法和L-稳定方法之间的区别，从而展示L-稳定性对于抑制偏微分方程半离散化中产生的伪高频振荡是何等关键。",
            "id": "3459566",
            "problem": "考虑空间区间 $[0,1]$ 上的一维热传导偏微分方程 (PDE) $u_t = \\nu u_{xx}$，其边界条件为齐次狄利克雷边界条件 $u(0,t)=0$ 和 $u(1,t)=0$，初始条件为光滑函数 $u(x,0)=u_0(x)$。使用解线法，在具有 $M$ 个内部节点的均匀网格上进行二阶中心差分格式离散化，以获得一个形如 $U'(t) = A U(t)$ 的线性常微分方程 (ODE) 组，其中 $A$ 是由扩散系数 $\\nu$ 缩放的离散拉普拉斯算子。具体来说，设空间网格宽度为 $\\Delta x = 1/(M+1)$，并定义三对角矩阵 $L \\in \\mathbb{R}^{M \\times M}$，其元素对于所有有效索引 $i$ 为 $L_{ii} = -2/\\Delta x^2$、$L_{i,i+1} = 1/\\Delta x^2$ 和 $L_{i,i-1} = 1/\\Delta x^2$，其余元素为零。则 $A = \\nu L$。当 $M$ 中等大时，所得的线性 ODE 系统是刚性的，因为 $A$ 的特征值具有较大的负实部，其尺度约为 $\\mathcal{O}(\\nu/\\Delta x^2)$。\n\n您的任务是使用此半离散模型，证明隐式中点法（也称为 Gauss–Legendre 单步法）是代数稳定（A-稳定）的，但不是 L-稳定的，因此不能有效抑制高频（刚性）模态。相比之下，后向欧拉法既是 A-稳定的又是 L-稳定的，并且它能够抑制这些模态。为此，请实现以下两个时间积分器，并将其应用于线性系统 $U'(t) = A U(t)$：\n\n- 后向欧拉法：从 $U^n$ 到 $U^{n+1}$ 的一个时间步求解 $(I - \\Delta t\\, A) U^{n+1} = U^n$。\n- 隐式中点法 (Gauss)：从 $U^n$ 到 $U^{n+1}$ 的一个时间步求解 $(I - \\tfrac{1}{2}\\Delta t\\, A) U^{n+1} = (I + \\tfrac{1}{2}\\Delta t\\, A) U^n$。\n\n在 $L$ 的离散正弦特征基中进行计算，其特征向量的分量为 $v_m(i) = \\sin\\!\\big(m\\pi\\, i/(M+1)\\big)$，其中 $i \\in \\{1,\\dots,M\\}$，$m \\in \\{1,\\dots,M\\}$。离散内积为 $\\langle u, v \\rangle_{\\Delta x} = \\Delta x \\sum_{i=1}^{M} u_i v_i$，并将每个模态归一化至单位离散范数。向量 $U \\in \\mathbb{R}^M$ 在模态 $m$ 下的模态振幅（系数）定义为离散投影的绝对值 $a_m = |\\langle U, \\widehat{v}_m \\rangle_{\\Delta x}|$，其中 $\\widehat{v}_m$ 是归一化后的模态。\n\n对于纯模态初始条件，将单个时间步内的模态放大率定义为时间步后模态振幅与时间步前模态振幅之比。对于混合模态初始条件，将一个时间步后的高频与低频模态振幅之比定义为 $r = a_{\\text{high}}/a_{\\text{low}}$。\n\n实现一个程序，为以下固定配置和测试套件构建矩阵 $A$ 和归一化特征模态，应用两种积分器进行一个时间步的计算，并报告所要求的模态放大测量值：\n\n- 所有测试共享的固定配置：\n  - 内部节点数：$M = 63$。\n  - 扩散系数：$\\nu = 1$。\n  - 网格宽度：$\\Delta x = 1/(M+1)$。\n  - 离散拉普拉斯矩阵：$A = \\nu L$，如上所述。\n  - 离散内积：$\\langle u, v \\rangle_{\\Delta x} = \\Delta x \\sum_{i=1}^{M} u_i v_i$；用此内积来归一化模态和计算投影。\n  - 低频模态索引：$m_{\\text{low}} = 1$。\n  - 高频模态索引：$m_{\\text{high}} = M$。\n\n- 测试套件（每个测试使用单个时间步 $N_{\\text{steps}} = 1$）：\n  1. 测试 A (最强刚性)：初始条件 $U^0 = \\widehat{v}_{m_{\\text{high}}}$，时间步长 $\\Delta t_A = 1000\\, \\Delta x^2$。输出一步之后的两个浮点数模态放大率：隐式中点法在模态 $m_{\\text{high}}$ 下的放大率，其后是后向欧拉法在该模态下的放大率，按此顺序。\n  2. 测试 B (中等刚性)：初始条件 $U^0 = \\widehat{v}_{m_{\\text{high}}}$，时间步长 $\\Delta t_B = 1\\, \\Delta x^2$。输出一步之后的两个浮点数模态放大率：隐式中点法在模态 $m_{\\text{high}}$ 下的放大率，其后是后向欧拉法在该模态下的放大率，按此顺序。\n  3. 测试 C (模态竞争)：初始条件 $U^0 = \\widehat{v}_{m_{\\text{low}}} + \\widehat{v}_{m_{\\text{high}}}$，时间步长 $\\Delta t_C = 1000\\, \\Delta x^2$。输出一步之后的两个浮点数表示的高频与低频振幅比：首先是使用隐式中点法得到的结果，然后是使用后向欧拉法得到的结果。\n\n您的程序必须：\n- 为每个测试构建矩阵 $A$、归一化的特征模态 $\\widehat{v}_{m_{\\text{low}}}$ 和 $\\widehat{v}_{m_{\\text{high}}}$ 以及指定的初始数据。\n- 对于指定的 $\\Delta t$，使用每种方法将 $U^0$ 推进一个时间步，并使用离散内积计算所需的模态测量值。\n- 生成单行输出，其中包含六个结果，四舍五入到六位小数，形式为方括号括起来的逗号分隔列表，顺序如下：$[\\text{TestA\\_IM},\\text{TestA\\_BE},\\text{TestB\\_IM},\\text{TestB\\_BE},\\text{TestC\\_IM\\_ratio},\\text{TestC\\_BE\\_ratio}]$。\n\n所有数值必须以无量纲浮点数的形式打印，并四舍五入到六位小数。不涉及物理单位或角度单位。最后一行必须严格遵循上述列表格式，不得包含任何其他文本。",
            "solution": "问题陈述经评估在科学上是合理的、适定的和自洽的。所有必要的参数、定义和方法都已明确指定，构成了一个偏微分方程数值分析中的标准练习。该问题是有效的，并且可以按所述方式解决。\n\n该问题要求展示后向欧拉法 (BE) 和隐式中点法 (IM) 这两种时间积分格式在应用于一维热方程 $u_t = \\nu u_{xx}$ 空间离散化所产生的常微分方程 (ODEs) 刚性系统时的稳定性差异。\n\n采用解线法，在具有 $M$ 个内部点和网格宽度 $\\Delta x = 1/(M+1)$ 的均匀网格上使用中心有限差分格式，可将该偏微分方程 (PDE) 转换为一个由 $M$ 个耦合 ODE 组成的系统，其形式为 $U'(t) = A U(t)$。向量 $U(t) \\in \\mathbb{R}^M$ 包含内部网格点上的解值。矩阵 $A = \\nu L$（其中 $L$ 是离散拉普拉斯算子）是一个实对称三对角矩阵。其特征值 $\\lambda_m(A)$ 为实数且为负，由下式给出：\n$$\n\\lambda_m(A) = \\nu \\frac{-4}{\\Delta x^2} \\sin^2\\left(\\frac{m\\pi}{2(M+1)}\\right) \\quad \\text{for } m = 1, \\dots, M.\n$$\n对应的特征向量 $\\widehat{v}_m$ 是离散正弦模态，它们在指定的离散内积 $\\langle u, v \\rangle_{\\Delta x} = \\Delta x \\sum_{i=1}^{M} u_i v_i$ 下构成 $\\mathbb{R}^M$ 的一个正交基。\n\n对于此系统，时间积分格式的稳定性可以通过检查其对每个特征模态的影响来分析。对于一个 ODE $y' = \\lambda y$，数值方法的一个单步将解从 $y^n$ 转换为 $y^{n+1} = g(\\lambda \\Delta t) y^n$，其中 $g(z)$ 是放大因子，$z = \\lambda \\Delta t$。对于系统 $U'(t) = A U(t)$，第 $m$ 个特征模态系数的更新由放大因子 $g(\\lambda_m(A) \\Delta t)$ 控制。\n\n所讨论的两种方法具有以下更新规则和放大因子：\n1.  **后向欧拉法 (BE)**：$(I - \\Delta t\\, A) U^{n+1} = U^n$。放大因子为\n    $$\n    g_{BE}(z) = \\frac{1}{1 - z}.\n    $$\n2.  **隐式中点法 (IM)**：$(I - \\tfrac{1}{2}\\Delta t\\, A) U^{n+1} = (I + \\tfrac{1}{2}\\Delta t\\, A) U^n$。放大因子为\n    $$\n    g_{IM}(z) = \\frac{1 + z/2}{1 - z/2}.\n    $$\n\n如果对于所有具有非正实部（$\\text{Re}(z) \\le 0$）的复数 $z$，都有 $|g(z)| \\le 1$，则称该数值方法是 **A-稳定**的。这确保了对于任何稳定的线性 ODE 系统，数值解在任何时间步长 $\\Delta t > 0$ 下都不会无界增长。BE 和 IM 都是 A-稳定的。\n\n如果一个方法是 A-稳定的，并且还满足 $\\lim_{\\text{Re}(z) \\to -\\infty} |g(z)| = 0$，则称该方法是 **L-稳定**的。这个性质对于刚性系统至关重要，因为在刚性系统中，某些特征值 $\\lambda_m$ 是非常大的负数。L-稳定性确保了相应的剧烈振荡或快速衰减的模态（高频模态）会被数值格式强力抑制，尤其是在使用较大的时间步长 $\\Delta t$ 时。\n\n分析放大因子：\n- 对于 BE：$\\lim_{\\text{Re}(z) \\to -\\infty} |g_{BE}(z)| = \\lim_{\\text{Re}(z) \\to -\\infty} |\\frac{1}{1-z}| = 0$。后向欧拉法是 L-稳定的。\n- 对于 IM：$\\lim_{\\text{Re}(z) \\to -\\infty} |g_{IM}(z)| = \\lim_{\\text{Re}(z) \\to -\\infty} |\\frac{1+z/2}{1-z/2}| = |\\frac{z/2}{-z/2}| = 1$。隐式中点法不是 L-稳定的。\n\n该分析预测，BE 将有效抑制高频模态，而 IM 则会保留它们，导致刚性问题的数值解中出现持续的、不符合物理规律的振荡。数值测试旨在验证这一行为。\n\n实现过程如下：\n1.  设置常数：$M=63$，$\\nu=1$，$\\Delta x=1/64$。\n2.  构建 $M \\times M$ 矩阵 $A$。\n3.  分别为模态 $m_{\\text{low}}=1$ 和 $m_{\\text{high}}=63$ 构建归一化的特征向量 $\\widehat{v}_{m_{\\text{low}}}$ 和 $\\widehat{v}_{m_{\\text{high}}}$。归一化是相对于离散内积 $\\langle u, v \\rangle_{\\Delta x}$ 进行的。归一化因子被发现是 $\\sqrt{2}$。\n4.  为每个测试用例构建初始条件向量 $U^0$。\n5.  实现为 BE 和 IM 执行单个时间步的函数。这些函数求解各自的线性系统，例如，对 BE 求解 $(I - \\Delta t\\, A) U^{n+1} = U^n$。\n6.  应用一个时间步来为每种方法获得 $U^1$。\n7.  通过使用离散内积将结果向量 $U^1$ 投影回相应的特征模态，来计算所需的模态放大率或振幅比。对于一个纯模态 $\\widehat{v}_m$ 的初始条件 $U^0$，放大率是 $|\\langle U^1, \\widehat{v}_m \\rangle_{\\Delta x}| / |\\langle U^0, \\widehat{v}_m \\rangle_{\\Delta x}|$。对于混合模态的初始条件，高频与低频比率由 $U^1$ 中相应模态的振幅计算得出。\n\n- **测试 A** 使用了相对于显式方法稳定性极限而言较大的时间步长 ($\\Delta t_A = 1000 \\Delta x^2$)。这对应于一个大的负值 $z = \\lambda_{m_{\\text{high}}} \\Delta t_A$。正如预测的那样，IM 产生的放大因子接近 $1$，而 BE 产生的放大因子接近 $0$。\n- **测试 B** 使用了较小的时间步长 ($\\Delta t_B = \\Delta x^2$)。此时，$z = \\lambda_{m_{\\text{high}}} \\Delta t_B \\approx -4$。两种方法都抑制了该模态，但抑制程度不同。\n- **测试 C** 展示了非 L-稳定性的实际后果。在初始条件包含低频和高频模态，并使用大时间步长的情况下，BE 选择性地抑制了刚性的高频分量，导致高低频振幅比很小。相比之下，IM 未能抑制该分量，导致该比值很大，意味着刚性分量持续存在并污染了解。\n\n代码的结果将从数值上证实这一理论理解。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the given problem to demonstrate the stability properties of\n    Backward Euler and Implicit Midpoint methods.\n    \"\"\"\n    # Fixed configuration shared by all tests\n    M = 63\n    nu = 1.0\n    dx = 1.0 / (M + 1)\n    m_low = 1\n    m_high = M\n\n    # 1. Construct the matrix A = nu * L\n    A = np.zeros((M, M))\n    diag_val = -2.0 * nu / dx**2\n    off_diag_val = 1.0 * nu / dx**2\n    for i in range(M):\n        A[i, i] = diag_val\n        if i > 0:\n            A[i, i - 1] = off_diag_val\n        if i  M - 1:\n            A[i, i + 1] = off_diag_val\n\n    # 2. Construct normalized eigenmodes\n    i_vals = np.arange(1, M + 1)\n    \n    v_low_unnormalized = np.sin(m_low * np.pi * i_vals / (M + 1))\n    v_high_unnormalized = np.sin(m_high * np.pi * i_vals / (M + 1))\n\n    # The squared norm ||v_m||^2 is dx * sum(sin^2(...)) = dx * (M+1)/2 = 1/2.\n    # The normalization factor is sqrt(2).\n    norm_factor = np.sqrt(2.0)\n    v_hat_low = norm_factor * v_low_unnormalized\n    v_hat_high = norm_factor * v_high_unnormalized\n\n    # 3. Define discrete inner product\n    def inner_product(u, v):\n        return dx * np.sum(u * v)\n\n    # 4. Implement time stepping functions\n    def step_be(U0, A_matrix, dt):\n        mat = np.eye(M) - dt * A_matrix\n        return np.linalg.solve(mat, U0)\n\n    def step_im(U0, A_matrix, dt):\n        mat_lhs = np.eye(M) - 0.5 * dt * A_matrix\n        mat_rhs = np.eye(M) + 0.5 * dt * A_matrix\n        rhs_vec = mat_rhs @ U0\n        return np.linalg.solve(mat_lhs, rhs_vec)\n\n    # --- Test Suite ---\n    results = []\n\n    # Test A: Stiffest emphasis\n    dt_A = 1000.0 * dx**2\n    U0_A = v_hat_high\n    \n    U1_A_IM = step_im(U0_A, A, dt_A)\n    U1_A_BE = step_be(U0_A, A, dt_A)\n    \n    # an initial pure mode has amplitude 1 since eigenvectors are normalized\n    a0_A_high = 1.0 \n    \n    a1_A_IM_high = np.abs(inner_product(U1_A_IM, v_hat_high))\n    a1_A_BE_high = np.abs(inner_product(U1_A_BE, v_hat_high))\n\n    amp_A_IM = a1_A_IM_high / a0_A_high\n    amp_A_BE = a1_A_BE_high / a0_A_high\n    results.extend([amp_A_IM, amp_A_BE])\n\n    # Test B: Moderately stiff\n    dt_B = 1.0 * dx**2\n    U0_B = v_hat_high\n    \n    U1_B_IM = step_im(U0_B, A, dt_B)\n    U1_B_BE = step_be(U0_B, A, dt_B)\n\n    a0_B_high = 1.0\n    a1_B_IM_high = np.abs(inner_product(U1_B_IM, v_hat_high))\n    a1_B_BE_high = np.abs(inner_product(U1_B_BE, v_hat_high))\n\n    amp_B_IM = a1_B_IM_high / a0_B_high\n    amp_B_BE = a1_B_BE_high / a0_B_high\n    results.extend([amp_B_IM, amp_B_BE])\n\n    # Test C: Mode competition\n    dt_C = 1000.0 * dx**2\n    U0_C = v_hat_low + v_hat_high\n    \n    U1_C_IM = step_im(U0_C, A, dt_C)\n    U1_C_BE = step_be(U0_C, A, dt_C)\n\n    # For U0 = v_low + v_high, the initial amplitudes are both 1.\n    # After one step, we project the solution back onto the eigenmodes.\n    a1_C_IM_low = np.abs(inner_product(U1_C_IM, v_hat_low))\n    a1_C_IM_high = np.abs(inner_product(U1_C_IM, v_hat_high))\n    ratio_IM = a1_C_IM_high / a1_C_IM_low\n\n    a1_C_BE_low = np.abs(inner_product(U1_C_BE, v_hat_low))\n    a1_C_BE_high = np.abs(inner_product(U1_C_BE, v_hat_high))\n    ratio_BE = a1_C_BE_high / a1_C_BE_low\n    \n    results.extend([ratio_IM, ratio_BE])\n\n    # Final print statement\n    print(f\"[{','.join(f'{r:.6f}' for r in results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在了解了强稳定性对于耗散问题的重要性之后，我们现在转向另一类方程——色散偏微分方程——来探索一个更深层次的精妙之处：稳定性是依赖于范数的。这个练习将挑战你验证一个方法可以在标准的$L^2$能量范数下是无条件稳定的，但在用另一个实际重要的范数（如总变差）来衡量时，却无法控制振荡。",
            "id": "3459587",
            "problem": "考虑一个周期性一维域上的线性Airy（色散）偏微分方程（PDE），\n$$\n\\partial_t u(x,t) + c\\,\\partial_x^3 u(x,t) = 0,\\quad x\\in[0,1),\\ t0,\n$$\n具有周期性边界条件和实常数波速 $c0$。设空间域在具有$N$个点的均匀周期网格上离散化，网格间距为 $h = 1/N$，网格节点为 $x_i = i h$，其中 $i=0,1,\\dots,N-1$。通过五点周期模板定义三阶导数的中心有限差分近似\n$$\n\\left(\\partial_x^3 u\\right)(x_i) \\approx \\frac{u_{i-2} - 2 u_{i-1} + 2 u_{i+1} - u_{i+2}}{2 h^3},\n$$\n其中索引是周期性的，因此 $u_{i+N} = u_i$。这引入了一个线性算子 $L_N:\\mathbb{R}^N\\to\\mathbb{R}^N$，其分量为\n$$\n\\left(L_N \\mathbf{u}\\right)_i = c\\,\\frac{u_{i-2} - 2 u_{i-1} + 2 u_{i+1} - u_{i+2}}{2 h^3}.\n$$\n考虑半离散系统 $\\mathbf{u}'(t) + L_N \\mathbf{u}(t) = \\mathbf{0}$ 的向后欧拉时间步进，即\n$$\n\\mathbf{u}^{n+1} = \\left(I - \\Delta t\\, L_N\\right)^{-1} \\mathbf{u}^{n},\\quad \\Delta t0,\n$$\n其中 $I$ 是 $N\\times N$ 单位矩阵，$\\mathbf{u}^n$ 近似于时间 $t_n = n\\,\\Delta t$ 时的 $u(\\cdot, t_n)$。\n\n在 $\\mathbb{R}^N$ 上定义以下离散范数：\n- 离散 $L^2$ 范数\n$$\n\\|\\mathbf{u}\\|_{L^2_h} = \\left(h\\,\\sum_{i=0}^{N-1} u_i^2\\right)^{1/2}.\n$$\n- 离散 $H^1$ 范数\n$$\n\\|\\mathbf{u}\\|_{H^1_h} = \\left(h\\,\\sum_{i=0}^{N-1} u_i^2 + \\frac{1}{h}\\,\\sum_{i=0}^{N-1} (u_{i+1}-u_i)^2\\right)^{1/2},\n$$\n具有周期性环绕 $u_N \\equiv u_0$。\n- 图全变分（TV）\n$$\n\\operatorname{TV}_h(\\mathbf{u}) = \\sum_{i=0}^{N-1} |u_{i+1}-u_i|,\n$$\n同样具有周期性环绕 $u_N \\equiv u_0$。\n\n对于给定的范数 $\\|\\cdot\\|$，将向后欧拉法在该范数下的无条件稳定性（非扩张性）定义为：对于所有 $\\Delta t0$，存在一个与 $\\Delta t$ 和 $n$ 无关的常数 $C$，使得对于所有 $\\mathbf{u}^0$，\n$$\n\\|\\mathbf{u}^{n}\\| \\le C\\,\\|\\mathbf{u}^{0}\\|\\quad\\text{对于所有 }n\\ge 0.\n$$\n在本问题中，我们关注 $C=1$ 的临界情况（单个时间步算子的非扩张性），并取 $\\mathbf{u}^{n+1} = G_{\\Delta t}\\,\\mathbf{u}^n$，其中 $G_{\\Delta t} = \\left(I - \\Delta t\\, L_N\\right)^{-1}$；我们需要判断在每种范数下，是否对于所有 $\\Delta t0$ 都有 $\\|G_{\\Delta t}\\|_{op}\\le 1$。\n\n任务：\n1) 仅使用离散化的基本性质，从第一性原理出发，推导 $L_N$ 相对于离散 $L^2$ 内积是斜对称的。由此推断，对于所有 $\\Delta t0$，预解式 $G_{\\Delta t} = (I - \\Delta t\\, L_N)^{-1}$ 在离散 $L^2$ 范数下是收缩的，即对于所有 $\\Delta t0$，$\\|G_{\\Delta t}\\|_{L^2_h\\to L^2_h}\\le 1$。\n\n2) 分析在离散 $H^1$ 范数下的无条件稳定性。基于周期网格上的离散傅里叶变换的对角化以及 $L_N$ 的纯虚谱，论证 $\\|G_{\\Delta t}\\|_{H^1_h\\to H^1_h}\\le 1$ 是否对所有 $\\Delta t0$ 成立。从上述定义和模态的谱映射出发，证明你的结论。\n\n3) 检验在图全变分下的无条件稳定性。解释为什么斜对称性或希尔伯特基下的对角化都不能控制 $\\operatorname{TV}_h(\\cdot)$ 中的非扩张性。构建一个具体的反例，通过展示一个时间步长 $\\Delta t$ 和一个初始向量 $\\mathbf{u}^0$，使得\n$$\n\\operatorname{TV}_h\\!\\left(G_{\\Delta t}\\,\\mathbf{u}^0\\right)  \\operatorname{TV}_h(\\mathbf{u}^0),\n$$\n来表明向后欧拉法在全变分下不是无条件稳定的。这体现了无条件稳定性声明对范数的依赖性。\n\n4) 实现一个程序，对 $N=128$，$c=1$ 和三个时间步长 $\\Delta t\\in\\{0.05,\\,0.5,\\,2.0\\}$ 执行以下计算：\n   - 对每个 $\\Delta t$，为上述五点周期模板构建 $N\\times N$ 矩阵 $L_N$，然后形成 $G_{\\Delta t} = (I - \\Delta t\\, L_N)^{-1}$。\n   - 计算 $G_{\\Delta t}$ 的诱导 $L^2$ 算子范数，即其相对于上面定义的离散 $L^2$ 范数的最大奇异值。\n   - 计算 $G_{\\Delta t}$ 的诱导 $H^1$ 算子范数，即\n     $$\n     G_{\\Delta t}^\\top M\\, G_{\\Delta t}\\,\\mathbf{v} = \\lambda\\, M\\,\\mathbf{v},\n     $$\n     的最大广义特征值 $\\lambda_{\\max}$ 的平方根，其中\n     $$\n     M = h\\,I + \\frac{1}{h} B^\\top B,\\quad (B\\mathbf{u})_i = u_{i+1}-u_i,\\ \\text{具有周期性环绕}。\n     $$\n   - 对每个 $\\Delta t$，计算两个图全变分比率：\n     (i) 对于方波初始向量\n     $$\n     u^0_{\\mathrm{step},i} = \\begin{cases}\n     1,  0 \\le i  N/2,\\\\\n     0,  N/2 \\le i  N,\n     \\end{cases}\n     $$\n     的比率 $\\operatorname{TV}_h(G_{\\Delta t}\\,\\mathbf{u}^0_{\\mathrm{step}})/\\operatorname{TV}_h(\\mathbf{u}^0_{\\mathrm{step}})$，\n     以及 (ii) 对于双模态混合\n     $$\n     u^0_{\\mathrm{mix},i} = \\sin(2\\pi x_i) + \\tfrac{1}{2}\\,\\sin(4\\pi x_i),\\quad x_i=i h.\n     $$\n     的比率 $\\operatorname{TV}_h(G_{\\Delta t}\\,\\mathbf{u}^0_{\\mathrm{mix}})/\\operatorname{TV}_h(\\mathbf{u}^0_{\\mathrm{mix}})$。\n程序必须生成单行输出，其中包含一个由方括号括起来的逗号分隔列表，按以下顺序排列结果：\n$$\n[\\ \\|G_{0.05}\\|_{L^2},\\ \\|G_{0.05}\\|_{H^1},\\ \\rho_{\\mathrm{step}}(0.05),\\ \\rho_{\\mathrm{mix}}(0.05),\\ \\|G_{0.5}\\|_{L^2},\\ \\|G_{0.5}\\|_{H^1},\\ \\rho_{\\mathrm{step}}(0.5),\\ \\rho_{\\mathrm{mix}}(0.5),\\ \\|G_{2.0}\\|_{L^2},\\ \\|G_{2.0}\\|_{H^1},\\ \\rho_{\\mathrm{step}}(2.0),\\ \\rho_{\\mathrm{mix}}(2.0)\\ ],\n$$\n其中每个量都是一个四舍五入到六位小数的浮点数，$\\rho_{\\mathrm{step}}(\\Delta t)$ 和 $\\rho_{\\mathrm{mix}}(\\Delta t)$ 表示上述的全变分比率。\n\n测试套件和答案规范：\n- 固定参数 $N=128$，$c=1$ 和时间步长 $\\Delta t\\in\\{0.05,\\,0.5,\\,2.0\\}$ 构成了测试套件。\n- 程序必须按指定顺序准确输出十二个浮点数。\n- 最终输出格式必须是单行，带有一个由方括号括起来的逗号分隔列表，例如，“[1.000000,0.999990,0.987654,1.012345, ...]”。",
            "solution": "所给问题是一个有效的数值分析练习，探讨了偏微分方程（PDE）数值方法在不同范数下的稳定性。所有组成部分都具有科学依据，问题提法得当，并且内部逻辑一致。我们按顺序解决这四个任务。\n\n### 任务1：离散 $L^2$ 范数下的无条件稳定性\n\n第一个任务是证明向后欧拉时间步进格式在离散 $L^2$ 范数下是无条件稳定的，该范数定义为 $\\|\\mathbf{u}\\|_{L^2_h} = \\left(h\\,\\sum_{i=0}^{N-1} u_i^2\\right)^{1/2}$。此稳定性是空间算子 $L_N$ 相对于相关离散 $L^2$ 内积 $\\langle \\mathbf{u}, \\mathbf{v} \\rangle_{L^2_h} = h\\,\\sum_{i=0}^{N-1} u_i v_i$ 的斜对称性的直接结果。\n\n如果对于所有向量 $\\mathbf{u}, \\mathbf{v} \\in \\mathbb{R}^N$，都有 $\\langle L_N \\mathbf{u}, \\mathbf{v} \\rangle_{L^2_h} = - \\langle \\mathbf{u}, L_N \\mathbf{v} \\rangle_{L^2_h}$，则算子 $L_N$ 相对于一个内积是斜对称的。让我们验证给定算子 $L_N$ 的这一性质。\n\n根据定义，内积为：\n$$\n\\langle L_N \\mathbf{u}, \\mathbf{v} \\rangle_{L^2_h} = h \\sum_{i=0}^{N-1} (L_N \\mathbf{u})_i v_i = h \\sum_{i=0}^{N-1} \\left( c\\,\\frac{u_{i-2} - 2 u_{i-1} + 2 u_{i+1} - u_{i+2}}{2 h^3} \\right) v_i\n$$\n$$\n= \\frac{c}{2h^2} \\sum_{i=0}^{N-1} \\left( u_{i-2} v_i - 2 u_{i-1} v_i + 2 u_{i+1} v_i - u_{i+2} v_i \\right)\n$$\n我们通过对和中的每一项重新索引来进行分部求和。索引是周期性的，即 $u_{i+N}=u_i$。\n1.  $\\sum_{i=0}^{N-1} u_{i-2} v_i$：令 $j = i-2$，则 $i = j+2$。和变为 $\\sum_{j=0}^{N-1} u_j v_{j+2}$。\n2.  $\\sum_{i=0}^{N-1} u_{i-1} v_i$：令 $j = i-1$，则 $i = j+1$。和变为 $\\sum_{j=0}^{N-1} u_j v_{j+1}$。\n3.  $\\sum_{i=0}^{N-1} u_{i+1} v_i$：令 $j = i+1$，则 $i = j-1$。和变为 $\\sum_{j=0}^{N-1} u_j v_{j-1}$。\n4.  $\\sum_{i=0}^{N-1} u_{i+2} v_i$：令 $j = i+2$，则 $i = j-2$。和变为 $\\sum_{j=0}^{N-1} u_j v_{j-2}$。\n\n将这些代回并使用 $j$ 作为求和索引，我们得到：\n$$\n\\langle L_N \\mathbf{u}, \\mathbf{v} \\rangle_{L^2_h} = \\frac{c}{2h^2} \\sum_{j=0}^{N-1} u_j \\left( v_{j+2} - 2 v_{j+1} + 2 v_{j-1} - v_{j-2} \\right)\n$$\n我们可以重新排列括号内的项：\n$$\nv_{j+2} - 2 v_{j+1} + 2 v_{j-1} - v_{j-2} = - \\left( v_{j-2} - 2 v_{j-1} + 2 v_{j+1} - v_{j+2} \\right)\n$$\n右边括号中的表达式恰好是 $(L_N \\mathbf{v})_j$ 定义中的分子乘以 $2h^3/c$。因此：\n$$\n\\langle L_N \\mathbf{u}, \\mathbf{v} \\rangle_{L^2_h} = \\frac{c}{2h^2} \\sum_{j=0}^{N-1} u_j \\left( - \\frac{2h^3}{c} (L_N \\mathbf{v})_j \\right) = -h \\sum_{j=0}^{N-1} u_j (L_N \\mathbf{v})_j = - \\langle \\mathbf{u}, L_N \\mathbf{v} \\rangle_{L^2_h}\n$$\n这证实了 $L_N$ 相对于 $\\langle\\cdot,\\cdot\\rangle_{L^2_h}$ 内积是斜对称的。\n\n现在，考虑向后欧拉更新步骤 $\\mathbf{u}^{n+1} = G_{\\Delta t} \\mathbf{u}^n$，其中 $G_{\\Delta t} = (I - \\Delta t L_N)^{-1}$。我们想证明 $\\|G_{\\Delta t}\\|_{L^2_h \\to L^2_h} \\le 1$。这等价于证明对于任何 $\\mathbf{u}^n$，都有 $\\|G_{\\Delta t} \\mathbf{u}^n\\|_{L^2_h} \\le \\|\\mathbf{u}^n\\|_{L^2_h}$。\n令 $\\mathbf{u}^{n+1} = G_{\\Delta t} \\mathbf{u}^n$。我们可以将其写为 $(I - \\Delta t L_N)\\mathbf{u}^{n+1} = \\mathbf{u}^n$。对两边取范数的平方：\n$$\n\\|\\mathbf{u}^n\\|_{L^2_h}^2 = \\|(I - \\Delta t L_N)\\mathbf{u}^{n+1}\\|_{L^2_h}^2 = \\langle (I - \\Delta t L_N)\\mathbf{u}^{n+1}, (I - \\Delta t L_N)\\mathbf{u}^{n+1} \\rangle_{L^2_h}\n$$\n展开内积：\n$$\n= \\langle \\mathbf{u}^{n+1}, \\mathbf{u}^{n+1} \\rangle_{L^2_h} - \\Delta t \\langle \\mathbf{u}^{n+1}, L_N \\mathbf{u}^{n+1} \\rangle_{L^2_h} - \\Delta t \\langle L_N \\mathbf{u}^{n+1}, \\mathbf{u}^{n+1} \\rangle_{L^2_h} + (\\Delta t)^2 \\langle L_N \\mathbf{u}^{n+1}, L_N \\mathbf{u}^{n+1} \\rangle_{L^2_h}\n$$\n使用斜对称性，$\\langle L_N \\mathbf{u}^{n+1}, \\mathbf{u}^{n+1} \\rangle_{L^2_h} = - \\langle \\mathbf{u}^{n+1}, L_N \\mathbf{u}^{n+1} \\rangle_{L^2_h}$。但对于任何斜对称算子 $L$ 和向量 $\\mathbf{v}$，$\\langle L\\mathbf{v}, \\mathbf{v} \\rangle = 0$。这是因为 $\\langle L\\mathbf{v}, \\mathbf{v} \\rangle = -\\langle \\mathbf{v}, L\\mathbf{v} \\rangle = -\\langle L\\mathbf{v}, \\mathbf{v} \\rangle$（对于实向量空间），这意味着 $2\\langle L\\mathbf{v}, \\mathbf{v} \\rangle = 0$。\n因此，$\\langle L_N \\mathbf{u}^{n+1}, \\mathbf{u}^{n+1} \\rangle_{L^2_h}=0$ 和 $\\langle \\mathbf{u}^{n+1}, L_N \\mathbf{u}^{n+1} \\rangle_{L^2_h}=0$。\n展开式简化为：\n$$\n\\|\\mathbf{u}^n\\|_{L^2_h}^2 = \\langle \\mathbf{u}^{n+1}, \\mathbf{u}^{n+1} \\rangle_{L^2_h} + (\\Delta t)^2 \\langle L_N \\mathbf{u}^{n+1}, L_N \\mathbf{u}^{n+1} \\rangle_{L^2_h}\n$$\n$$\n= \\|\\mathbf{u}^{n+1}\\|_{L^2_h}^2 + (\\Delta t)^2 \\|L_N \\mathbf{u}^{n+1}\\|_{L^2_h}^2\n$$\n由于 $\\Delta t0$，$(\\Delta t)^2 \\|L_N \\mathbf{u}^{n+1}\\|_{L^2_h}^2 \\ge 0$。因此，\n$$\n\\|\\mathbf{u}^n\\|_{L^2_h}^2 \\ge \\|\\mathbf{u}^{n+1}\\|_{L^2_h}^2\n$$\n取平方根，我们得到 $\\|\\mathbf{u}^{n+1}\\|_{L^2_h} \\le \\|\\mathbf{u}^n\\|_{L^2_h}$。这表明算子 $G_{\\Delta t}$ 在离散 $L^2_h$ 范数下是收缩的。因此，对于所有 $\\Delta t  0$，$\\|G_{\\Delta t}\\|_{L^2_h \\to L^2_h} \\le 1$，该格式在此范数下是无条件稳定的。\n\n### 任务2：离散 $H^1$ 范数下的无条件稳定性\n\n离散 $H^1_h$ 范数定义为 $\\|\\mathbf{u}\\|_{H^1_h}^2 = \\|\\mathbf{u}\\|_{L^2_h}^2 + \\frac{1}{h^2} \\|B\\mathbf{u}\\|_{L^2_h}^2$，其中 $(B\\mathbf{u})_i = u_{i+1}-u_i$ 是向前差分算子（具有周期性环绕），其范数是结果向量的标准 $L^2_h$ 范数。\n我们在傅里叶域中分析稳定性。离散傅里叶变换（DFT）为周期网格上的任何线性、位移不变算子（如 $L_N$ 和 $B$）提供了一组正交的特征向量基。\nDFT 基向量是 $\\mathbf{v}_k$，其分量为 $(\\mathbf{v}_k)_j = e^{i 2\\pi k j / N}$，其中 $k=0, 1, \\dots, N-1$。\n\n让我们找到 $L_N$ 对应于特征向量 $\\mathbf{v}_k$ 的特征值 $\\lambda_k$：\n$$\n(L_N \\mathbf{v}_k)_j = \\frac{c}{2 h^3} \\left( e^{i 2\\pi k(j-2)/N} - 2e^{i 2\\pi k(j-1)/N} + 2e^{i 2\\pi k(j+1)/N} - e^{i 2\\pi k(j+2)/N} \\right)\n$$\n$$\n= \\frac{e^{i 2\\pi k j / N}}{2 h^3} c \\left( e^{-i 4\\pi k/N} - 2e^{-i 2\\pi k/N} + 2e^{i 2\\pi k/N} - e^{i 4\\pi k/N} \\right)\n$$\n$$\n= (\\mathbf{v}_k)_j \\frac{c}{2 h^3} \\left( 2i \\sin(2\\pi k/N) - 2i \\sin(4\\pi k/N) \\right)\n$$\n因此特征值为 $\\lambda_k = i \\frac{c}{h^3} \\left( \\sin(2\\pi k h) - \\sin(4\\pi k h) \\right)$，这是一个纯虚数，证实了 $L_N$ 的斜对称性。令 $\\lambda_k = i \\beta_k$，其中 $\\beta_k \\in \\mathbb{R}$。\n\n第 $k$ 个模态的向后欧拉步的放大因子是 $g_k = (1 - \\Delta t \\lambda_k)^{-1} = (1 - i \\Delta t \\beta_k)^{-1}$。其模长为 $|g_k| = \\frac{1}{\\sqrt{1 + (\\Delta t \\beta_k)^2}} \\le 1$。\n\n现在，让我们在傅里叶域中表示 $H^1_h$ 范数。设 $\\mathbf{u} = \\sum_{k=0}^{N-1} \\hat{u}_k \\mathbf{v}_k$。根据帕塞瓦尔定理，$\\|\\mathbf{u}\\|_{L^2_h}^2 = h \\sum_j u_j^2 = h \\sum_k |\\hat{u}_k|^2$（注意：这里有一个小的不准确，标准的离散傅里叶变换的帕塞瓦尔定理通常不含 $h$，但对于 $L^2_h$ 范数，这是正确的定义）。\n算子 $B$ 也被DFT对角化。其特征值 $\\mu_k$ 为：\n$(B \\mathbf{v}_k)_j = e^{i 2\\pi k(j+1)/N} - e^{i 2\\pi k j/N} = (e^{i 2\\pi k/N}-1) (\\mathbf{v}_k)_j$。所以 $\\mu_k = e^{i2\\pi k h}-1$。\n$B\\mathbf{u}$ 的范数是：$\\|B\\mathbf{u}\\|_{L^2_h}^2 = h \\sum_k |\\mu_k \\hat{u}_k|^2 = h \\sum_k |\\mu_k|^2 |\\hat{u}_k|^2$。\n因此，$H^1_h$ 范数的平方为：\n$$\n\\|\\mathbf{u}\\|_{H^1_h}^2 = h \\sum_{k=0}^{N-1} |\\hat{u}_k|^2 + \\frac{1}{h} \\sum_{k=0}^{N-1} |\\mu_k|^2 |\\hat{u}_k|^2 = \\sum_{k=0}^{N-1} \\left(h + \\frac{|\\mu_k|^2}{h}\\right) |\\hat{u}_k|^2\n$$\n现在考虑时间演化 $\\mathbf{u}^{n+1} = G_{\\Delta t} \\mathbf{u}^n$。在傅里叶域中，这变成 $\\hat{u}_k^{n+1} = g_k \\hat{u}_k^n$。\n第 $n+1$ 步解的 $H^1_h$ 范数为：\n$$\n\\|\\mathbf{u}^{n+1}\\|_{H^1_h}^2 = \\sum_{k=0}^{N-1} \\left(h + \\frac{|\\mu_k|^2}{h}\\right) |\\hat{u}_k^{n+1}|^2 = \\sum_{k=0}^{N-1} \\left(h + \\frac{|\\mu_k|^2}{h}\\right) |g_k|^2 |\\hat{u}_k^n|^2\n$$\n由于对于所有 $k$ 和 $\\Delta t0$，都有 $|g_k| \\le 1$，所以 $|g_k|^2 \\le 1$。因此，对于和中的每一项：\n$$\n\\left(h + \\frac{|\\mu_k|^2}{h}\\right) |g_k|^2 |\\hat{u}_k^n|^2 \\le \\left(h + \\frac{|\\mu_k|^2}{h}\\right) |\\hat{u}_k^n|^2\n$$\n对 $k$ 求和，我们得到：\n$$\n\\|\\mathbf{u}^{n+1}\\|_{H^1_h}^2 \\le \\sum_{k=0}^{N-1} \\left(h + \\frac{|\\mu_k|^2}{h}\\right) |\\hat{u}_k^n|^2 = \\|\\mathbf{u}^{n}\\|_{H^1_h}^2\n$$\n这意味着 $\\|\\mathbf{u}^{n+1}\\|_{H^1_h} \\le \\|\\mathbf{u}^{n}\\|_{H^1_h}$，所以 $\\|G_{\\Delta t}\\|_{H^1_h \\to H^1_h} \\le 1$。该方法在离散 $H^1$ 范数下是无条件稳定的。\n\n### 任务3：图全变分下的无条件稳定性\n\n图全变分 $\\operatorname{TV}_h(\\mathbf{u}) = \\sum_{i=0}^{N-1} |u_{i+1}-u_i|$，不是从内积导出的，因此它不定义一个希尔伯特空间范数。因此，基于斜对称性（内积属性）或傅里叶分析（依赖于希尔伯特空间中的正交基）的证明方法不直接适用。DFT基向量不是TV泛函的特征向量，并且帕塞瓦尔定理不适用于 $\\operatorname{TV}_h$ 范数。\n\n在这种范数下的稳定性不能由像 $L^2$ 或 $H^1$ 这样的希尔伯特空间范数下的稳定性来保证。对于像Airy方程这样的色散方程，一个已知的现象是，即使是在 $L^2$ 中无条件稳定的隐式方法，也可能在全变分下不具有非扩张性。这意味着该格式不是“全变分递减”（TVD）的。实际上，它们可以从陡峭的梯度中产生伪振荡，这会增加全变分。\n\n为了证明这一点，我们构造一个反例。考虑问题中定义的阶梯函数初始数据 $\\mathbf{u}^0_{\\mathrm{step}}$。其全变分为：\n$$\n\\operatorname{TV}_h(\\mathbf{u}^0_{\\mathrm{step}}) = \\sum_{i=0}^{N-1}|u_{i+1}-u_i| = |u_{N/2}-u_{N/2-1}| + |u_{0}-u_{N-1}| = |0-1| + |1-0| = 2\n$$\n应用一步向后欧拉法，$\\mathbf{u}^1 = G_{\\Delta t} \\mathbf{u}^0_{\\mathrm{step}}$，等价于求解线性系统 $(I - \\Delta t L_N)\\mathbf{u}^1 = \\mathbf{u}^0_{\\mathrm{step}}$。虽然算子 $G_{\\Delta t}$ 在 $L^2$ 中是收缩的，但它起着一个带有相移的低通滤波器的作用。当应用于不连续的向量 $\\mathbf{u}^0_{\\mathrm{step}}$ 时，这个滤波过程会平滑不连续点，但也会在原始跳跃附近引入一系列振荡（色散波纹或吉布斯现象）。\n\n相邻点之间差的绝对值之和，$\\sum |u^1_{i+1}-u^1_i|$，现在将包括这些新形成的振荡的贡献。虽然在 $N/2$ 和 $0$ 处的原始跳跃的幅度减小了，但对所有新的小尺度振荡求和可能比原始的全变分更大。\n\n为了具体演示，必须进行计算。例如，使用任务4中的参数（$N=128$, $c=1$, $\\Delta t=0.5$），可以数值计算 $\\mathbf{u}^1 = G_{0.5} \\mathbf{u}^0_{\\mathrm{step}}$，并发现 $\\operatorname{TV}_h(\\mathbf{u}^1)$ 大于 $2$。任务4中的程序将提供这一明确证据。这表明对于这个 $\\mathbf{u}^0$ 和 $\\Delta t$ 的选择，$\\operatorname{TV}_h(G_{\\Delta t} \\mathbf{u}^0)  \\operatorname{TV}_h(\\mathbf{u}^0)$，证明了向后欧拉法在该问题中在全变分下不是无条件稳定的（非扩张的）。\n\n### 任务4：数值计算\n\n以下程序实现了所需的计算。\n- 它为五点三阶导数模板构造了循环矩阵 $L_N$。\n- 对于每个 $\\Delta t$，它构成预解式矩阵 $G_{\\Delta t} = (I - \\Delta t L_N)^{-1}$。\n- 它计算 $L^2_h$ 算子范数，这等价于 $G_{\\Delta t}$ 的标准矩阵 $2$-范数。\n- 它构造了 $H^1_h$ 范数的质量矩阵 $M$，并求解指定的广义特征值问题以找到 $H^1_h$ 算子范数。\n- 它计算指定阶梯函数和混合模态初始条件的全变分比率。\n- 结果被收集并以所需格式打印。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import circulant, eigh, inv\n\ndef solve():\n    \"\"\"\n    Performs the numerical analysis specified in the problem statement.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    N = 128\n    c = 1.0\n    dt_values = [0.05, 0.5, 2.0]\n    \n    h = 1.0 / N\n\n    # 1. Construct the L_N operator matrix\n    # (L_N u)_i = c * (u_{i-2} - 2u_{i-1} + 2u_{i+1} - u_{i+2}) / (2h^3)\n    # This is a circulant matrix. We define its first row.\n    l_row = np.zeros(N)\n    const = c / (2.0 * h**3)\n    l_row[1] = 2.0 * const  # u_{i+1} term\n    l_row[N-1] = -2.0 * const # u_{i-1} term\n    l_row[2] = -1.0 * const  # u_{i+2} term\n    l_row[N-2] = 1.0 * const  # u_{i-2} term\n    L_N = circulant(l_row)\n\n    # 2. Define initial conditions and TV function\n    # Step function\n    u0_step = np.zeros(N)\n    u0_step[0 : N // 2] = 1.0\n\n    # Mixed-mode function\n    x = np.arange(N) * h\n    u0_mix = np.sin(2 * np.pi * x) + 0.5 * np.sin(4 * np.pi * x)\n\n    def tv_h(u):\n        \"\"\"Computes the graph total variation.\"\"\"\n        return np.sum(np.abs(np.roll(u, -1) - u))\n\n    tv0_step = tv_h(u0_step)\n    tv0_mix = tv_h(u0_mix)\n    \n    # 3. Construct the H^1 mass matrix M\n    # M = h*I + (1/h) * B.T @ B, where (Bu)_i = u_{i+1} - u_i\n    B = -np.eye(N) + np.roll(np.eye(N), -1, axis=0)\n    M = h * np.eye(N) + (1.0 / h) * (B.T @ B)\n\n    results = []\n    # Loop over time steps\n    for dt in dt_values:\n        # Build G_dt = (I - dt * L_N)^{-1}\n        Id = np.eye(N)\n        A = Id - dt * L_N\n        G_dt = inv(A)\n\n        # Compute L^2 operator norm\n        # ||G_dt||_{L2h->L2h} = ||G_dt||_2 (standard spectral norm)\n        norm_l2 = np.linalg.norm(G_dt, 2)\n        results.append(norm_l2)\n\n        # Compute H^1 operator norm\n        # sqrt of largest generalized eigenvalue of G.T @ M @ G v = lambda M v\n        # This is equivalent to finding eigenvalues of M^{-1/2} G.T M G M^{-1/2}\n        # which have the same eigenvalues as M^{1/2} G M^{-1/2} M^{-1/2} G.T M^{1/2}\n        # A = G.T M G\n        A_eig = G_dt.T @ M @ G_dt\n        \n        # scipy.linalg.eigh can solve the generalized eigenvalue problem Av = lambda Bv\n        # for Hermitian A and positive definite B. M is symmetric and pos-def.\n        # A_eig is also symmetric.\n        eigenvalues = eigh(A_eig, M, eigvals_only=True)\n        norm_h1 = np.sqrt(np.max(eigenvalues))\n        results.append(norm_h1)\n\n        # Compute TV ratios\n        # For step function\n        u1_step = G_dt @ u0_step\n        tv1_step = tv_h(u1_step)\n        ratio_step = tv1_step / tv0_step\n        results.append(ratio_step)\n\n        # For mixed mode function\n        u1_mix = G_dt @ u0_mix\n        tv1_mix = tv_h(u1_mix)\n        ratio_mix = tv1_mix / tv0_mix\n        results.append(ratio_mix)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{x:.6f}' for x in results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "最后，我们进入鲁棒积分器设计的前沿，研究Runge-Kutta方法的内部结构如何影响其在具有挑战性的非正规系统上的性能。通过一系列精心构建的测试，这个练习让你能够将一个简单的DIRK方法与一个更复杂的Radau IIA格式进行比较，揭示出如G-稳定性和阶（stage order）等高级概念在确保任何耗散系统的收缩性方面的实际意义。",
            "id": "3459543",
            "problem": "考虑经过空间半离散化后的线性自治偏微分方程 (PDE)，它产生形式为 $u'(t) = L u(t)$ 的常微分方程组，其中 $u(t) \\in \\mathbb{R}^n$ 且 $L \\in \\mathbb{R}^{n \\times n}$。设 $H \\in \\mathbb{R}^{n \\times n}$ 是一个对称正定矩阵，定义了能量内积 $\\langle x, y \\rangle_H = x^\\top H y$ 和范数 $\\lVert x \\rVert_H^2 = x^\\top H x$。如果 $L^\\top H + H L \\preceq 0$，则称算子 $L$ 相对于 $H$ 是耗散的。对于一个 Butcher 矩阵为 $A \\in \\mathbb{R}^{s \\times s}$、权重为 $b \\in \\mathbb{R}^s$ 的单步龙格-库塔方法，当应用于线性系统 $u' = L u$ 时，该方法定义了一个线性传播子 $R(hL) \\in \\mathbb{R}^{n \\times n}$，使得对于时间步长 $h > 0$，有 $u_{n+1} = R(hL) u_n$。将单步的 $H$-范数放大因子定义为\n$$\n\\mathcal{A}_H(R(hL)) \\equiv \\sup_{x \\neq 0} \\frac{\\lVert R(hL) x \\rVert_H}{\\lVert x \\rVert_H} = \\sigma_{\\max}\\!\\left(H^{\\frac{1}{2}} R(hL) H^{-\\frac{1}{2}}\\right),\n$$\n其中 $\\sigma_{\\max}(\\cdot)$ 表示最大奇异值，而 $H^{\\pm \\frac{1}{2}}$ 表示对称平方根及其逆。\n\n您的任务是，通过算法研究下三角对角隐式龙格-库塔 (DIRK) 格式相对于 Radau IIA 方法的无条件稳定性（即对于所有 $h > 0$ 在 $H$ 中都具有收缩性），确定阶精度如何影响鲁棒性，并构建一个具体的耗散例子，在该例子中 DIRK 格式失去 $G$-稳定性（即不再具有收缩性），而 Radau IIA 方法则没有。\n\n从第一性原理出发：\n\n- 对于线性系统 $u' = L u$，一个龙格-库塔步骤的定义由阶梯（stages）给出：$Y_i = u_n + h \\sum_{j=1}^s a_{ij} L Y_j$（对于 $i \\in \\{1,\\dots,s\\}$），然后是 $u_{n+1} = u_n + h \\sum_{i=1}^s b_i L Y_i$。\n- 使用 Kronecker 积，堆叠的阶梯系统可以写作\n$$\n\\left(I_{s} \\otimes I_n - h A \\otimes L\\right) \\operatorname{vec}(Y) = (e \\otimes I_n) u_n,\n$$\n其中 $e \\in \\mathbb{R}^s$ 是全一向量，单步传播子可以表示为\n$$\nR(hL) = I_n + h (b^\\top \\otimes L)\\, \\left(I_{s} \\otimes I_n - h A \\otimes L\\right)^{-1} (e \\otimes I_n).\n$$\n- 一个 $H$-耗散的 $L$ 意味着 $L^\\top H + H L \\preceq 0$。\n\n实现以下三种方法（所有方法在 $A$ 是下三角矩阵的意义上都是下三角的）：\n\n- Backward Euler（单阶梯 DIRK，1 阶，阶精度 1）：$s = 1$，$A = [1]$，$b = [1]$，$c = [1]$。\n- 一种 2 阶 L-稳定的两阶梯单对角隐式龙格-库塔 (SDIRK) 方法，参数为 $\\gamma = 1 - 1/\\sqrt{2}$，其\n$$\nA = \\begin{bmatrix} \\gamma  0 \\\\ 1-\\gamma  \\gamma \\end{bmatrix}, \\quad b = \\begin{bmatrix} 1 - \\gamma \\\\ \\gamma \\end{bmatrix}, \\quad c = \\begin{bmatrix} \\gamma \\\\ 1 \\end{bmatrix}.\n$$\n- Radau IIA，其中 $s = 2$（3 阶，阶精度 2），其\n$$\nA = \\begin{bmatrix} \\tfrac{5}{12}  -\\tfrac{1}{12} \\\\ \\tfrac{3}{4}  \\tfrac{1}{4} \\end{bmatrix}, \\quad b = \\begin{bmatrix} \\tfrac{3}{4} \\\\ \\tfrac{1}{4} \\end{bmatrix}, \\quad c = \\begin{bmatrix} \\tfrac{1}{3} \\\\ 1 \\end{bmatrix}.\n$$\n\n仅使用上述定义和公式，编写一个程序：\n\n- 在维度 $n=2$ 下，构造三族确定性的 $H$-耗散测试算子 $(H, L)$：\n    1. 具有各向异性度量的秩一耗散：对于每个 $\\varepsilon \\in \\{0.01, 0.1\\}$ 和 $M \\in \\{2, 5, 10, 20\\}$，令 $H = \\operatorname{diag}(1, \\varepsilon)$ 和 $S = \\varepsilon\\, v v^\\top$，其中 $v = [1,\\, M]^\\top$，并设置 $L = - H^{-1} S$。验证 $L^\\top H + H L = -2 S \\preceq 0$。\n    2. 斜阻尼非正规族：对于每个 $\\alpha \\in \\{0.1, 1.0\\}$ 和 $\\beta \\in \\{5.0, 10.0, 50.0\\}$，取 $H = I_2$ 和 $L = -\\alpha I_2 + \\beta J$，其中 $J = \\begin{bmatrix} 0  1 \\\\ -1  0 \\end{bmatrix}$。验证 $L^\\top + L = -2 \\alpha I_2 \\preceq 0$。\n    3. 相似变换对角耗散（可调非正规性）：对于每个 $c \\in \\{5.0, 10.0, 20.0, 50.0\\}$ 和 $(k_1, k_2) \\in \\{(1.0, 10.0),\\, (1.0, 50.0)\\}$，设置 $C = \\begin{bmatrix} 1  c \\\\ 0  1 \\end{bmatrix}$，$H = C^\\top C$，$K = -\\operatorname{diag}(k_1, k_2)$，以及 $L = C^{-1} K C$。证明 $L^\\top H + H L = C^\\top (K^\\top + K) C \\preceq 0$。\n- 对于来自上述族中的每个 $(H, L)$ 和每个时间步长 $h \\in \\{0.1, 0.5, 1.0, 2.0, 5.0, 10.0\\}$，计算三种方法的 $H$-范数放大因子 $\\mathcal{A}_H(R(hL))$。\n- 如果 $\\mathcal{A}_H(R(hL)) \\le 1 + \\tau$，其中 $\\tau = 10^{-8}$ 是一个固定的数值容差，则认为该方法在该案例上是收缩的。\n\n使用计算出的放大因子，您的程序必须产生以下在整个测试套件上聚合的输出：\n\n- 一个布尔值，指示 Radau IIA 是否在所有案例和所有 $h$ 下都是收缩的。\n- 一个布尔值，指示 SDIRK 方法是否至少存在一次违规（即存在一个案例和一个 $h$ 使其不收缩），从而为 DIRK 方法构建一个明确的 $G$-稳定性反例，而此时 Radau IIA 仍然是收缩的。\n- 三个浮点数，分别给出 Backward Euler、SDIRK 和 Radau IIA 在测试套件上的最坏情况放大因子（观测到的最大 $\\mathcal{A}_H(R(hL))$）。\n- 一个整数，给出 SDIRK 方法的违规案例总数（即 $(H, L, h)$ 三元组的数量）。\n\n角度单位不适用。没有需要报告的物理单位。\n\n最终输出格式：\n\n- 您的程序应产生单行输出，包含一个逗号分隔的 Python 式列表，格式为 $[\\text{radau\\_all}, \\text{sdirk\\_has\\_viol}, \\text{be\\_worst}, \\text{sdirk\\_worst}, \\text{radau\\_worst}, \\text{sdirk\\_viol\\_count}]$，例如 $[True,True,0.9999,1.0023,1.0,7]$。",
            "solution": "该问题要求对特定的隐式龙格-库塔 (RK) 方法应用于线性、自治、$H$-耗散常微分方程组时的无条件稳定性进行严格的算法研究。在此背景下，无条件稳定性指的是对于任何正时间步长 $h$，在由对称正定矩阵 $H$ 定义的能量范数中具有收缩性。\n\n### 步骤 1：问题陈述的初步验证\n首先评估问题的有效性。\n\n**已知条件提取：**\n- **系统常微分方程：** $u'(t) = L u(t)$，其中 $u(t) \\in \\mathbb{R}^n$，$L \\in \\mathbb{R}^{n \\times n}$。\n- **能量内积与范数：** $\\langle x, y \\rangle_H = x^\\top H y$ 和 $\\lVert x \\rVert_H^2 = x^\\top H x$，其中 $H \\in \\mathbb{R}^{n \\times n}$ 是对称正定 (SPD) 矩阵。\n- **耗散性条件：** 如果 $L^\\top H + H L \\preceq 0$，则 $L$ 是 $H$-耗散的。\n- **龙格-库塔传播子：** $u_{n+1} = R(hL) u_n$，其中 $R(hL) = I_n + h (b^\\top \\otimes L)\\, \\left(I_{s} \\otimes I_n - h A \\otimes L\\right)^{-1} (e \\otimes I_n)$。\n- **放大因子：** $\\mathcal{A}_H(R(hL)) \\equiv \\sup_{x \\neq 0} \\frac{\\lVert R(hL) x \\rVert_H}{\\lVert x \\rVert_H} = \\sigma_{\\max}\\!\\left(H^{\\frac{1}{2}} R(hL) H^{-\\frac{1}{2}}\\right)$。\n- **待实现方法：**\n    1.  Backward Euler ($s=1$ DIRK): $A = [1]$，$b = [1]$。\n    2.  $s=2$ SDIRK (2 阶，L-稳定): $\\gamma = 1 - 1/\\sqrt{2}$，$A = \\begin{bmatrix} \\gamma  0 \\\\ 1-\\gamma  \\gamma \\end{bmatrix}$，$b = \\begin{bmatrix} 1 - \\gamma \\\\ \\gamma \\end{bmatrix}$。\n    3.  $s=2$ Radau IIA (3 阶): $A = \\begin{bmatrix} \\tfrac{5}{12}  -\\tfrac{1}{12} \\\\ \\tfrac{3}{4}  \\tfrac{1}{4} \\end{bmatrix}$，$b = \\begin{bmatrix} \\tfrac{3}{4} \\\\ \\tfrac{1}{4} \\end{bmatrix}$。\n- **测试问题 ($n=2$):**\n    1.  秩一耗散：$H = \\operatorname{diag}(1, \\varepsilon)$，$S = \\varepsilon\\, v v^\\top$，其中 $v = [1,\\, M]^\\top$，$L = - H^{-1} S$，对于 $\\varepsilon \\in \\{0.01, 0.1\\}$，$M \\in \\{2, 5, 10, 20\\}$。\n    2.  斜阻尼非正规：$H = I_2$，$L = -\\alpha I_2 + \\beta J$，其中 $J = \\begin{bmatrix} 0  1 \\\\ -1  0 \\end{bmatrix}$，对于 $\\alpha \\in \\{0.1, 1.0\\}$，$\\beta \\in \\{5.0, 10.0, 50.0\\}$。\n    3.  相似变换：$C = \\begin{bmatrix} 1  c \\\\ 0  1 \\end{bmatrix}$，$H = C^\\top C$，$K = -\\operatorname{diag}(k_1, k_2)$，$L = C^{-1} K C$，对于 $c \\in \\{5.0, 10.0, 20.0, 50.0\\}$，$(k_1, k_2) \\in \\{(1.0, 10.0),\\, (1.0, 50.0)\\}$。\n- **时间步长：** $h \\in \\{0.1, 0.5, 1.0, 2.0, 5.0, 10.0\\}$。\n- **收缩性容差：** $\\mathcal{A}_H(R(hL)) \\le 1 + \\tau$，其中 $\\tau = 10^{-8}$。\n- **要求输出：** Radau IIA 普适收缩性的布尔值，SDIRK 存在违规的布尔值，三种方法的最坏情况放大因子，以及 SDIRK 的总违规次数。\n\n**验证结论：**\n该问题在科学上植根于成熟的数值常微分方程理论，特别是龙格-库塔方法的稳定性分析。$H$-耗散性、G-稳定性（本问题研究其线性变体）以及数值传播子 $R(hL)$ 的构建等概念都是标准的。测试问题是定义良好且数学上合理的算子构造，这些算子展现出的性质（各向异性、非正规性）对于数值积分器而言是众所周知的挑战。对每个测试族耗散性的验证是线性代数中的一个直接练习，证实了它们的正确性。问题陈述清晰、客观且完整，提出了一个明确、可验证且有一定难度的任务。因此，该问题是**有效的**。\n\n### 步骤 2：基于原理的解决方案设计\n\n问题的核心是确定一种数值方法是否能为任何 $H$-耗散系统保持能量 $\\lVert u \\rVert_H^2$ 的非增性质。对于线性系统 $u' = Lu$，解析解 $u(t) = \\exp(tL)u_0$ 具有非增的能量范数，因为 $H$-耗散性条件 $L^\\top H + H L \\preceq 0$ 意味着 $\\frac{d}{dt}\\lVert u(t) \\rVert_H^2 = (Lu)^\\top H u + u^\\top H (Lu) = u^\\top(L^\\top H + HL)u \\le 0$。如果对于任何步长 $h  0$，都有 $\\lVert u_{n+1} \\rVert_H \\le \\lVert u_n \\rVert_H$，那么数值方法在 $H$-范数下是收缩的。这等价于要求 $H$-范数放大因子有界为 1：$\\mathcal{A}_H(R(hL)) \\le 1$。\n\n所提出的算法系统地构建测试问题，并为每种指定的方法、问题实例和时间步长计算此放大因子。\n\n**1. 传播子 $R(hL)$ 的算法构建**\n\n给定一个由其 Butcher 矩阵 $A \\in \\mathbb{R}^{s \\times s}$ 和权重 $b \\in \\mathbb{R}^s$ 定义的龙格-库塔方法，以及一个由 $L \\in \\mathbb{R}^{n \\times n}$ 定义的线性系统，单步传播子 $R(hL)$ 是一个 $n \\times n$ 矩阵。对于指定的问题维度 $n=2$，传播子是一个 $2 \\times 2$ 矩阵。其构建涉及对大小为 $sn \\times sn$ 的矩阵进行运算。\n- 当 $n=2$ 时，单位矩阵为 $I_n = I_2$ 和 $I_s$。\n- 需要求逆的核心矩阵是 $M_{\\text{inv}} = (I_s \\otimes I_2 - h A \\otimes L)$，其维度为 $(2s \\times 2s)$。对于单阶梯的 Backward Euler 方法 ($s=1$)，这是一个 $2 \\times 2$ 矩阵。对于两阶梯的 SDIRK 和 Radau IIA 方法 ($s=2$)，这是一个 $4 \\times 4$ 矩阵。\n- 其他分量是矩阵 $b^\\top \\otimes L$ (大小为 $2 \\times 2s$) 和 $e \\otimes I_2$ (大小为 $2s \\times 2$)，其中 $e$ 是 $s \\times 1$ 的全一向量。\n- 传播子随后组装为 $R(hL) = I_2 + h (b^\\top \\otimes L) M_{\\text{inv}}^{-1} (e \\otimes I_2)$。\n\n**2. 放大因子 $\\mathcal{A}_H(R(hL))$ 的算法计算**\n\n放大因子是 $R(hL)$ 由 $H$-范数诱导的算子范数。所提供的公式 $\\mathcal{A}_H(R(hL)) = \\sigma_{\\max}(H^{1/2} R(hL) H^{-1/2})$ 将问题转化为寻找一个相关矩阵的最大奇异值，这等价于该矩阵的标准欧几里得 $2$-范数。\n- 首先，计算对称矩阵平方根 $H^{1/2}$ 及其逆 $H^{-1/2}$。由于 $H$ 是对称正定的，这些都是定义明确的实数矩阵。这可以通过 $H$ 的特征分解来稳健地处理。如果 $H=PDP^\\top$，其中 $D$ 是具有正特征值的对角矩阵，那么 $H^{1/2} = PD^{1/2}P^\\top$。\n- 构造矩阵 $T = H^{1/2} R(hL) H^{-1/2}$。\n- 计算 $T$ 的奇异值。其中最大的奇异值 $\\sigma_{\\max}(T)$ 就是所求的放大因子 $\\mathcal{A}_H(R(hL))$。\n\n**3. 方法和测试案例的原理**\n\n方法和测试问题的选择是有目的的。\n- **方法**：Backward Euler 和 Radau IIA 已知是代数稳定的，这是一个强性质，意味着它们是 G-稳定的（因此对于所有 $H$-耗散线性系统都是收缩的）。它们的期望最坏情况放大因子应为 $\\le 1$。SDIRK 方法虽然是 L-稳定的（对于刚性方程是一个理想的性质），但不一定是代数稳定的。其较低的阶精度使得当算子 $L$ 和度量 $H$ 产生高度非正规的动力学时，即使系统是耗散的，它也容易出现瞬态增长和收缩性的丧失。\n- **测试案例**：这三族 $(H, L)$ 对旨在探查这些弱点。\n    - 族 1 通过各向异性度量 $H$ 和秩一耗散部分引入非正规性。\n    - 族 2 通过 $L$ 中的一个大的斜对称分量引入非正规性。\n    - 族 3 提供了一种可调的方式，通过相似变换生成非正规算子 $L$，其中非正规性由参数 $c$ 控制。\n这些案例创造了所涉及矩阵的特征向量远非正交的情景，这是非正规系统的标志，其中可能发生瞬态增长。正是在这种情况下，预计 SDIRK 方法会失效，而更鲁棒的 Radau IIA 格式预计会保持收缩性。\n\n**4. 结果聚合**\n\n程序实现将遍历测试案例参数和时间步长的每一种组合。对于每种组合，它将计算三种 RK 方法的 $\\mathcal{A}_H$。然后分析每种方法得到的放大因子列表，以确定是否符合收缩性条件 $\\mathcal{A}_H \\le 1 + \\tau$。最终输出由问题陈述所要求的聚合统计数据组成。",
            "answer": "```python\nimport numpy as np\nimport scipy.linalg\n\ndef solve():\n    \"\"\"\n    Solves the problem of evaluating the unconditional stability of three\n    Runge-Kutta methods for various families of H-dissipative systems.\n    \"\"\"\n    \n    # Numerical tolerance for contractivity check\n    tau = 1e-8\n    \n    # -- Method Definitions --\n    # Backward Euler (s=1, order 1)\n    A_be = np.array([[1.0]])\n    b_be = np.array([[1.0]])\n    \n    # SDIRK (s=2, order 2, L-stable)\n    gamma = 1.0 - 1.0 / np.sqrt(2.0)\n    A_sdirk = np.array([[gamma, 0.0], \n                        [1.0 - gamma, gamma]])\n    b_sdirk = np.array([[1.0 - gamma], \n                        [gamma]])\n    \n    # Radau IIA (s=2, order 3)\n    A_radau = np.array([[5.0/12.0, -1.0/12.0],\n                        [3.0/4.0,   1.0/4.0]])\n    b_radau = np.array([[3.0/4.0],\n                        [1.0/4.0]])\n    \n    methods = {\n        'BE': {'A': A_be, 'b': b_be},\n        'SDIRK': {'A': A_sdirk, 'b': b_sdirk},\n        'RadauIIA': {'A': A_radau, 'b': b_radau}\n    }\n    \n    # Time steps for analysis\n    h_vals = [0.1, 0.5, 1.0, 2.0, 5.0, 10.0]\n    \n    # Storage for amplification factors\n    results = {\n        'BE': [],\n        'SDIRK': [],\n        'RadauIIA': []\n    }\n\n    def compute_amplification_factor(A, b, L, H, h):\n        \"\"\"\n        Computes the H-norm amplification factor for a given RK method,\n        operator L, metric H, and step size h.\n        \"\"\"\n        s = A.shape[0]\n        n = L.shape[0]\n        \n        I_s = np.eye(s)\n        I_n = np.eye(n)\n        e = np.ones((s, 1))\n\n        # Construct the matrix to be inverted for the stage values\n        M_to_invert = np.kron(I_s, I_n) - h * np.kron(A, L)\n        \n        try:\n            M_inv = np.linalg.inv(M_to_invert)\n        except np.linalg.LinAlgError:\n            return 0.0\n\n        b_T_kron_L = np.kron(b.T, L)\n        e_kron_I_n = np.kron(e, I_n)\n        \n        R_hL = I_n + h * b_T_kron_L @ M_inv @ e_kron_I_n\n        \n        # Compute H^(1/2) and H^(-1/2)\n        H_sqrt = scipy.linalg.sqrtm(H)\n        H_inv_sqrt = scipy.linalg.inv(H_sqrt)\n        \n        T = H_sqrt @ R_hL @ H_inv_sqrt\n        \n        singular_values = np.linalg.svd(T, compute_uv=False)\n        return singular_values[0]\n\n    # --- Test Case Generation and Computation ---\n    \n    # Family 1: Rank-one dissipation with anisotropic metric\n    eps_vals = [0.01, 0.1]\n    M_vals = [2.0, 5.0, 10.0, 20.0]\n    for eps in eps_vals:\n        for M_val in M_vals:\n            H = np.diag([1.0, eps])\n            v = np.array([1.0, M_val])\n            S = eps * np.outer(v, v)\n            L = -np.linalg.inv(H) @ S\n            \n            for h in h_vals:\n                for name, params in methods.items():\n                    amp = compute_amplification_factor(params['A'], params['b'], L, H, h)\n                    results[name].append(amp)\n\n    # Family 2: Skew-damped non-normal family\n    alpha_vals = [0.1, 1.0]\n    beta_vals = [5.0, 10.0, 50.0]\n    for alpha in alpha_vals:\n        for beta in beta_vals:\n            H = np.eye(2)\n            J = np.array([[0.0, 1.0], [-1.0, 0.0]])\n            L = -alpha * np.eye(2) + beta * J\n\n            for h in h_vals:\n                for name, params in methods.items():\n                    amp = compute_amplification_factor(params['A'], params['b'], L, H, h)\n                    results[name].append(amp)\n            \n    # Family 3: Similarity-transformed diagonal dissipation\n    c_vals = [5.0, 10.0, 20.0, 50.0]\n    k_pairs = [(1.0, 10.0), (1.0, 50.0)]\n    for c_val in c_vals:\n        for k1, k2 in k_pairs:\n             C = np.array([[1.0, c_val], [0.0, 1.0]])\n             H = C.T @ C\n             K = -np.diag([k1, k2])\n             C_inv = np.linalg.inv(C)\n             L = C_inv @ K @ C\n             \n             for h in h_vals:\n                for name, params in methods.items():\n                    amp = compute_amplification_factor(params['A'], params['b'], L, H, h)\n                    results[name].append(amp)\n\n    # --- Aggregation of Results ---\n    radau_amps = np.array(results['RadauIIA'])\n    sdirk_amps = np.array(results['SDIRK'])\n    be_amps = np.array(results['BE'])\n\n    radau_all_contractive = np.all(radau_amps = 1.0 + tau)\n    sdirk_has_violation = np.any(sdirk_amps > 1.0 + tau)\n    sdirk_violation_count = int(np.sum(sdirk_amps > 1.0 + tau))\n    \n    be_worst = np.max(be_amps)\n    sdirk_worst = np.max(sdirk_amps)\n    radau_worst = np.max(radau_amps)\n    \n    final_results = [\n        bool(radau_all_contractive),\n        bool(sdirk_has_violation),\n        be_worst,\n        sdirk_worst,\n        radau_worst,\n        sdirk_violation_count\n    ]\n    \n    formatted_list = [\n        str(final_results[0]),\n        str(final_results[1]),\n        f\"{final_results[2]:.6f}\",\n        f\"{final_results[3]:.6f}\",\n        f\"{final_results[4]:.6f}\",\n        str(final_results[5])\n    ]\n    print(f\"[{','.join(formatted_list)}]\")\n\nsolve()\n```"
        }
    ]
}