{
    "hands_on_practices": [
        {
            "introduction": "Understanding the behavior of physical quantities at material interfaces is fundamental. This first practice invites you to step back from numerical approximation and solve a foundational problem analytically. By deriving the exact solution for a steady-state diffusion problem with a discontinuous coefficient, you will solidify your understanding of the essential interface conditions: continuity of the primary variable and continuity of the physical flux .",
            "id": "3390488",
            "problem": "Consider the steady diffusion equation in one spatial dimension,\n$$-\\frac{d}{dx}\\left(k(x)\\frac{du}{dx}\\right) = 0 \\quad \\text{on} \\quad [0,1],$$\nwhere the diffusivity is piecewise constant,\n$$k(x) = \\begin{cases}\nk_{1}, & x \\in [0,\\alpha],\\\\\nk_{2}, & x \\in [\\alpha,1],\n\\end{cases}$$\nwith $k_{1} > 0$, $k_{2} > 0$, and $\\alpha \\in (0,1)$. Dirichlet boundary conditions are prescribed:\n$$u(0) = U_{0}, \\qquad u(1) = U_{1},$$\nwith $U_{0}, U_{1} \\in \\mathbb{R}$. Starting from the conservation statement for the steady problem, interpret $-k(x)u'(x)$ as the physical flux and use control-volume balance on each subinterval together with interface conditions to enforce both the continuity of the solution and the balance of normal flux across the internal interface at $x=\\alpha$. Derive exact closed-form expressions for the constant physical flux and the interface trace value of the solution at $x=\\alpha$ in terms of $k_{1}$, $k_{2}$, $\\alpha$, $U_{0}$, and $U_{1}$.\n\nProvide your final result as the pair $\\big(u(\\alpha),\\,q\\big)$, where $q$ denotes the constant physical flux defined by $q(x) = -k(x)u'(x)$. Express your answer as exact analytic formulas. No rounding is required, and no units are associated with the quantities. The final answer must be a single row matrix containing the two expressions.",
            "solution": "The problem statement has been validated and is deemed sound. It is scientifically grounded, well-posed, and objective. It presents a classic one-dimensional, steady-state diffusion problem with a piecewise constant coefficient, which is a fundamental model in transport phenomena. All necessary conditions and parameters are provided, and the problem is free of contradictions or ambiguities.\n\nThe governing equation is the steady-state diffusion equation in one dimension,\n$$-\\frac{d}{dx}\\left(k(x)\\frac{du}{dx}\\right) = 0 \\quad \\text{for } x \\in (0,1).$$\nThis equation is the differential form of a conservation law. Let the physical flux be defined as $q(x) = -k(x)u'(x)$. The governing equation can then be written as $\\frac{d}{dx}q(x) = 0$. Integrating this equation with respect to $x$ shows that the flux $q(x)$ must be a constant throughout the domain $[0,1]$. Let us denote this constant flux by $q$. This is the mathematical expression of \"control-volume balance\" for any arbitrary control volume within the domain: the flux entering the volume equals the flux exiting it, as there are no sources or sinks. The continuity of flux across the interface at $x=\\alpha$ is thus automatically enforced by this conclusion.\n\nThe diffusivity $k(x)$ is piecewise constant:\n$$k(x) = \\begin{cases}\nk_{1}, & x \\in [0,\\alpha],\\\\\nk_{2}, & x \\in [\\alpha,1],\n\\end{cases}$$\nwhere $k_{1}>0$, $k_{2}>0$, and $\\alpha \\in (0,1)$. The solution $u(x)$ must satisfy the Dirichlet boundary conditions $u(0) = U_{0}$ and $u(1) = U_{1}$.\n\nWe solve the equation on each subinterval by integrating the relation $q = -k(x)u'(x)$.\n\nFor the first subinterval, $x \\in [0,\\alpha]$, we have $q = -k_{1}u'(x)$. Integrating with respect to $x$ yields:\n$$u'(x) = -\\frac{q}{k_{1}}.$$\nA second integration yields the general solution for $u(x)$ in this region:\n$$u(x) = -\\frac{q}{k_{1}}x + C_{1},$$\nwhere $C_{1}$ is an integration constant.\n\nFor the second subinterval, $x \\in [\\alpha,1]$, we have $q = -k_{2}u'(x)$. Integrating with respect to $x$ yields:\n$$u'(x) = -\\frac{q}{k_{2}}.$$\nA second integration gives the general solution for $u(x)$ in this region:\n$$u(x) = -\\frac{q}{k_{2}}x + C_{2},$$\nwhere $C_{2}$ is another integration constant.\n\nWe have three unknowns: the constant flux $q$, and the integration constants $C_{1}$ and $C_{2}$. We determine these using the two boundary conditions and the condition of solution continuity at the interface $x=\\alpha$.\n\n1.  Apply the boundary condition at $x=0$: $u(0) = U_{0}$.\n    From the solution on the first subinterval, we have $u(0) = -\\frac{q}{k_{1}}(0) + C_{1} = C_{1}$.\n    Thus, $C_{1} = U_{0}$. The solution on $[0,\\alpha]$ is $u(x) = U_{0} - \\frac{q}{k_{1}}x$.\n\n2.  Apply the boundary condition at $x=1$: $u(1) = U_{1}$.\n    From the solution on the second subinterval, we have $u(1) = -\\frac{q}{k_{2}}(1) + C_{2} = U_{1}$.\n    Thus, $C_{2} = U_{1} + \\frac{q}{k_{2}}$. The solution on $[\\alpha,1]$ is $u(x) = -\\frac{q}{k_{2}}x + U_{1} + \\frac{q}{k_{2}} = U_{1} + \\frac{q}{k_{2}}(1-x)$.\n\n3.  Apply the interface condition: continuity of the solution $u(x)$ at $x=\\alpha$.\n    The value of the solution must be the same when approached from the left and from the right. We denote this value as $u(\\alpha)$.\n    $$u(\\alpha) = \\lim_{x\\to\\alpha^{-}} u(x) = \\lim_{x\\to\\alpha^{+}} u(x).$$\n    Using the expressions for $u(x)$ on each subinterval:\n    $$U_{0} - \\frac{q}{k_{1}}\\alpha = U_{1} + \\frac{q}{k_{2}}(1-\\alpha).$$\n    This equation allows us to solve for the constant flux $q$. Rearranging the terms to isolate $q$:\n    $$U_{0} - U_{1} = q\\left(\\frac{\\alpha}{k_{1}} + \\frac{1-\\alpha}{k_{2}}\\right).$$\n    The term in the parentheses can be interpreted as the total resistance to diffusion. Solving for $q$:\n    $$q = \\frac{U_{0} - U_{1}}{\\frac{\\alpha}{k_{1}} + \\frac{1-\\alpha}{k_{2}}}.$$\n    To obtain a single fractional expression, we find a common denominator for the terms in the denominator: $\\frac{\\alpha}{k_{1}} + \\frac{1-\\alpha}{k_{2}} = \\frac{\\alpha k_{2} + (1-\\alpha)k_{1}}{k_{1}k_{2}}$.\n    Substituting this back into the expression for $q$ gives:\n    $$q = \\frac{k_{1}k_{2}(U_{0} - U_{1})}{\\alpha k_{2} + (1-\\alpha)k_{1}}.$$\n\nNow we find the value of the solution at the interface, $u(\\alpha)$. We can use the expression for $u(x)$ from the first subinterval and evaluate it at $x=\\alpha$:\n$$u(\\alpha) = U_{0} - \\frac{q}{k_{1}}\\alpha.$$\nSubstitute the derived expression for $q$:\n$$u(\\alpha) = U_{0} - \\frac{\\alpha}{k_{1}} \\left( \\frac{k_{1}k_{2}(U_{0} - U_{1})}{\\alpha k_{2} + (1-\\alpha)k_{1}} \\right) = U_{0} - \\frac{\\alpha k_{2}(U_{0} - U_{1})}{\\alpha k_{2} + (1-\\alpha)k_{1}}.$$\nTo simplify, we place all terms over a common denominator:\n$$u(\\alpha) = \\frac{U_{0}(\\alpha k_{2} + (1-\\alpha)k_{1}) - \\alpha k_{2}(U_{0} - U_{1})}{\\alpha k_{2} + (1-\\alpha)k_{1}}.$$\nExpanding the numerator:\n$$U_{0}\\alpha k_{2} + U_{0}(1-\\alpha)k_{1} - U_{0}\\alpha k_{2} + U_{1}\\alpha k_{2} = U_{0}(1-\\alpha)k_{1} + U_{1}\\alpha k_{2}.$$\nTherefore, the expression for the interface value $u(\\alpha)$ is:\n$$u(\\alpha) = \\frac{k_{1}(1-\\alpha)U_{0} + k_{2}\\alpha U_{1}}{k_{1}(1-\\alpha) + k_{2}\\alpha}.$$\nThis result is a weighted average of the boundary values $U_{0}$ and $U_{1}$, where the weights depend on the properties ($k_1$, $k_2$) and geometry ($\\alpha$) of the subdomains.\n\nThe problem requires the pair $(u(\\alpha), q)$. The two derived expressions are:\n$$u(\\alpha) = \\frac{k_{1}(1-\\alpha)U_{0} + k_{2}\\alpha U_{1}}{k_{1}(1-\\alpha) + k_{2}\\alpha}, \\qquad q = \\frac{k_{1}k_{2}(U_{0} - U_{1})}{k_{1}(1-\\alpha) + k_{2}\\alpha}.$$\nThese are the final, exact closed-form expressions.",
            "answer": "$$ \\boxed{ \\begin{pmatrix} \\frac{k_{1}(1-\\alpha)U_{0} + k_{2}\\alpha U_{1}}{k_{1}(1-\\alpha) + k_{2}\\alpha} & \\frac{k_{1}k_{2}(U_{0} - U_{1})}{k_{1}(1-\\alpha) + k_{2}\\alpha} \\end{pmatrix} } $$"
        },
        {
            "introduction": "Building on the analytical understanding from the previous exercise, we now transition to the world of numerical discretization. This practice focuses on how to construct a finite volume scheme that correctly honors the physics at a material interface. You will derive the \"transmissibility\" coefficient, which is a practical implementation of the harmonic mean, ensuring that your discrete flux calculation remains physically consistent even when material properties jump between cell centers .",
            "id": "3390480",
            "problem": "Consider the steady one-dimensional diffusion equation, which is a Partial Differential Equation (PDE), given by $-\\frac{d}{dx}\\left(k(x)\\frac{du}{dx}\\right)=0$ on a uniform grid with cell centers at $x_i$ and $x_{i+1}$ separated by a distance $h$. In the Finite Volume Method (FVM), the face flux $q_{i+1/2}$ crossing the interface between these adjacent control volumes must be balanced (equal and opposite when viewed from either side), and the primary unknown $u$ is assumed to be continuous across any internal material interface when there is no interfacial resistance. Let the thermal conductivity be piecewise constant with a jump at an internal interface $\\Gamma$ located between $x_i$ and $x_{i+1}$: specifically, $k(x)=k_L$ for $x_i \\le x  x_\\Gamma$ and $k(x)=k_R$ for $x_\\Gamma  x \\le x_{i+1}$, with $x_\\Gamma = x_i + \\alpha h$. The cross-sectional area is $A=1$.\n\nYou are given $h=1\\,\\mathrm{m}$, $\\alpha=\\frac{2}{5}$, $k_L=4\\,\\mathrm{W/(m\\,K)}$, and $k_R=8\\,\\mathrm{W/(m\\,K)}$. Using conservation of flux at the internal interface and continuity of the primary unknown $u$ at $\\Gamma$, derive from first principles the adjusted two-point face transmissibility coefficient $T_{i+1/2}$ such that the discrete face flux takes the form $q_{i+1/2}=-T_{i+1/2}(u_{i+1}-u_i)$ and enforces flux continuity despite the jump in $k(x)$. Compute the value of $T_{i+1/2}$ for the data provided. Express your final coefficient in $\\mathrm{W/(m^2\\,K)}$. Do not round; provide the exact value.",
            "solution": "The governing equation for steady one-dimensional diffusion is $-\\frac{d}{dx}\\left(k(x)\\frac{du}{dx}\\right)=0$. Let the flux density be defined as $q(x) = -k(x)\\frac{du}{dx}$. The governing equation then simplifies to $\\frac{d}{dx}q(x) = 0$, which implies that the flux density $q(x)$ is constant throughout the interval between the cell centers $x_i$ and $x_{i+1}$. We denote this constant flux by $q_{i+1/2}$.\n\nTo relate the nodal values $u_i = u(x_i)$ and $u_{i+1} = u(x_{i+1})$, we rearrange and integrate the flux definition:\n$$\n\\frac{du}{dx} = -\\frac{q_{i+1/2}}{k(x)}\n$$\nIntegrating from $x_i$ to $x_{i+1}$:\n$$\n\\int_{x_i}^{x_{i+1}} \\frac{du}{dx} dx = u(x_{i+1}) - u(x_i) = u_{i+1} - u_i\n$$\nThe right-hand side becomes:\n$$\nu_{i+1} - u_i = -q_{i+1/2} \\int_{x_i}^{x_{i+1}} \\frac{1}{k(x)} dx\n$$\nThe conductivity $k(x)$ is piecewise constant, so we split the integral at the material interface $x_\\Gamma = x_i + \\alpha h$:\n$$\n\\int_{x_i}^{x_{i+1}} \\frac{1}{k(x)} dx = \\int_{x_i}^{x_\\Gamma} \\frac{1}{k_L} dx + \\int_{x_\\Gamma}^{x_{i+1}} \\frac{1}{k_R} dx\n$$\nThe lengths of the integration sub-intervals are $x_\\Gamma - x_i = \\alpha h$ and $x_{i+1} - x_\\Gamma = (1-\\alpha)h$. The integral, which represents the total thermal resistance, is:\n$$\n\\int_{x_i}^{x_{i+1}} \\frac{1}{k(x)} dx = \\frac{\\alpha h}{k_L} + \\frac{(1-\\alpha)h}{k_R}\n$$\nSubstituting this back, we get:\n$$\nu_{i+1} - u_i = -q_{i+1/2} \\left[ \\frac{\\alpha h}{k_L} + \\frac{(1-\\alpha)h}{k_R} \\right]\n$$\nThe problem asks for the transmissibility coefficient $T_{i+1/2}$ in the form $q_{i+1/2} = -T_{i+1/2}(u_{i+1} - u_i)$. Solving for $q_{i+1/2}$, we have:\n$$\nq_{i+1/2} = - \\frac{1}{\\frac{\\alpha h}{k_L} + \\frac{(1-\\alpha)h}{k_R}} (u_{i+1} - u_i)\n$$\nBy comparing the two forms, we identify the transmissibility coefficient:\n$$\nT_{i+1/2} = \\frac{1}{\\frac{\\alpha h}{k_L} + \\frac{(1-\\alpha)h}{k_R}}\n$$\nThis expression is the harmonic average of the conductivities, weighted by the distances. Now, we insert the given numerical values: $h=1\\,\\mathrm{m}$, $\\alpha=\\frac{2}{5}$, $k_L=4\\,\\mathrm{W/(m\\,K)}$, and $k_R=8\\,\\mathrm{W/(m\\,K)}$.\n$$\nT_{i+1/2} = \\frac{1}{\\frac{(2/5)(1)}{4} + \\frac{(1-2/5)(1)}{8}} = \\frac{1}{\\frac{2/5}{4} + \\frac{3/5}{8}} = \\frac{1}{\\frac{2}{20} + \\frac{3}{40}}\n$$\n$$\nT_{i+1/2} = \\frac{1}{\\frac{1}{10} + \\frac{3}{40}} = \\frac{1}{\\frac{4}{40} + \\frac{3}{40}} = \\frac{1}{\\frac{7}{40}} = \\frac{40}{7}\n$$\nThe value of the adjusted two-point face transmissibility coefficient is $\\frac{40}{7}$ $\\mathrm{W/(m^2\\,K)}$, as the cross-sectional area is given as unity.",
            "answer": "$$\n\\boxed{\\frac{40}{7}}\n$$"
        },
        {
            "introduction": "The principles of flux balance and interface continuity are not limited to diffusion problems. This practice shifts our focus to hyperbolic conservation laws, specifically the linear advection equation. Here, you will discover that the design of the numerical flux must account for the direction of information flow, leading to the development of the essential \"upwind\" flux, a cornerstone for simulating transport phenomena .",
            "id": "3390466",
            "problem": "Consider the one-dimensional scalar conservation law for linear advection, given by the partial differential equation (PDE) $\\partial_{t} u(x,t) + \\partial_{x} f(u(x,t)) = 0$ on the periodic spatial domain $[0,L]$, where the flux function is $f(u) = a u$ with a constant advection speed $a \\in \\mathbb{R}$. Discretize the domain into a finite volume mesh with cells $i$ having interfaces at $x_{i-\\frac{1}{2}}$ and $x_{i+\\frac{1}{2}}$, and cell lengths $\\Delta x_{i} = x_{i+\\frac{1}{2}} - x_{i-\\frac{1}{2}}$. Let $u_{i}^{n}$ denote the cell average of $u$ over cell $i$ at time $t^{n}$, and consider an explicit finite volume method update of the form\n$$\nu_{i}^{n+1} = u_{i}^{n} - \\frac{\\Delta t}{\\Delta x_{i}} \\left( \\hat{f}_{i+\\frac{1}{2}} - \\hat{f}_{i-\\frac{1}{2}} \\right),\n$$\nwhere $\\hat{f}_{i+\\frac{1}{2}}$ is a single-valued numerical flux function at the interface $x_{i+\\frac{1}{2}}$ that enforces face flux balance and interface continuity, meaning that the same value $\\hat{f}_{i+\\frac{1}{2}}$ is used with opposite signs in the updates of the two cells adjacent to the interface. Let $u_{L}$ and $u_{R}$ denote the reconstructed left and right interface states at $x_{i+\\frac{1}{2}}$.\n\nStarting from the fundamental structure of conservation laws and the fact that linear advection transports information along characteristics of speed $a$, derive the upwind numerical flux $\\hat{f}(u_{L},u_{R};a)$ at a single face in terms of $a$, $u_{L}$, and $u_{R}$ that is consistent with the physical flux and respects the interface continuity constraint. Then, using the discrete update above and the periodic boundary condition, verify that the resulting finite volume scheme is conservative in the sense that the discrete $L^{1}$ mass functional $M^{n} = \\sum_{i} \\Delta x_{i} u_{i}^{n}$ is temporally invariant under the update, by invoking face flux balance and interface continuity to justify pairwise cancellation of interface contributions.\n\nYour final answer must be a single closed-form analytic expression for $\\hat{f}(u_{L},u_{R};a)$ as a function of $a$, $u_{L}$, and $u_{R}$. No rounding is required, and no units are involved.",
            "solution": "The starting point is the scalar conservation law $\\partial_{t} u + \\partial_{x} f(u) = 0$ with $f(u) = a u$, where $a \\in \\mathbb{R}$ is constant. For linear advection, characteristics propagate with speed $a$, so information travels from left to right if $a > 0$ and from right to left if $a  0$. In a finite volume method, the numerical flux $\\hat{f}_{i+\\frac{1}{2}}$ at an interface must be consistent with the physical flux and must be single-valued at the face, ensuring interface continuity (the same numerical flux value contributes to the adjacent cells with opposite signs) and face flux balance (flux leaving one cell equals flux entering its neighbor).\n\nTo construct an upwind flux at an interface with left state $u_{L}$ and right state $u_{R}$, we use the direction of propagation determined by the sign of $a$:\n- If $a > 0$, then the wind blows from left to right, so the interface state is taken from the left, and the numerical flux is $\\hat{f} = a u_{L}$.\n- If $a  0$, then the wind blows from right to left, so the interface state is taken from the right, and the numerical flux is $\\hat{f} = a u_{R}$.\n- If $a = 0$, there is no transport and the numerical flux is $\\hat{f} = 0$.\n\nThese cases can be combined into a single analytic expression using the absolute value function. Observe that\n$$\n\\frac{a + |a|}{2} =\n\\begin{cases}\na,  a > 0, \\\\\n0,  a \\le 0,\n\\end{cases}\n\\qquad\n\\frac{a - |a|}{2} =\n\\begin{cases}\n0,  a > 0, \\\\\na,  a \\le 0.\n\\end{cases}\n$$\nTherefore, a unified expression for the upwind numerical flux is\n$$\n\\hat{f}(u_{L},u_{R};a) = \\frac{a + |a|}{2} u_{L} + \\frac{a - |a|}{2} u_{R}.\n$$\nThis expression is consistent with the physical flux $f(u) = a u$ and respects interface continuity, because at each face a single scalar $\\hat{f}_{i+\\frac{1}{2}}$ is computed based on $a$, $u_{L}$, and $u_{R}$, and the same value enters the updates of the two adjacent cells with opposite signs.\n\nNext, we verify the discrete conservation of the $L^{1}$ mass functional $M^{n} = \\sum_{i} \\Delta x_{i} u_{i}^{n}$ under the finite volume update on a periodic mesh. Multiply the update by $\\Delta x_{i}$ and sum over all cells:\n$$\n\\sum_{i} \\Delta x_{i} u_{i}^{n+1} = \\sum_{i} \\Delta x_{i} u_{i}^{n} - \\Delta t \\sum_{i} \\left( \\hat{f}_{i+\\frac{1}{2}} - \\hat{f}_{i-\\frac{1}{2}} \\right).\n$$\nThe sum over fluxes telescopes because each interior interface $x_{i+\\frac{1}{2}}$ appears once with a positive sign in cell $i$ (as $-\\hat{f}_{i+\\frac{1}{2}}$) and once with a negative sign in cell $i+1$ (as $-(-\\hat{f}_{i+\\frac{1}{2}})$), and interface continuity ensures that the same single-valued $\\hat{f}_{i+\\frac{1}{2}}$ is used for both contributions. Hence,\n$$\n\\sum_{i} \\left( \\hat{f}_{i+\\frac{1}{2}} - \\hat{f}_{i-\\frac{1}{2}} \\right) = 0\n$$\non a periodic domain because the first and last terms also cancel due to periodicity. Therefore,\n$$\n\\sum_{i} \\Delta x_{i} u_{i}^{n+1} = \\sum_{i} \\Delta x_{i} u_{i}^{n},\n$$\nwhich shows $M^{n+1} = M^{n}$ for all time steps. This proves that the scheme is conservative in the sense of preserving the discrete $L^{1}$ mass functional, with the cancellation relying on face flux balance and interface continuity at each interface.\n\nCombining these results, the required single closed-form analytic expression for the upwind numerical flux is\n$$\n\\hat{f}(u_{L},u_{R};a) = \\frac{a + |a|}{2} u_{L} + \\frac{a - |a|}{2} u_{R}.\n$$",
            "answer": "$$\\boxed{\\frac{a+|a|}{2}u_{L}+\\frac{a-|a|}{2}u_{R}}$$"
        }
    ]
}