{
    "hands_on_practices": [
        {
            "introduction": "第一个实践是高斯散度定理的基本验证，该定理是有限体积法的基石。通过显式计算给定矢量场穿过一个简单立方控制体所有表面的净通量，你将验证该值精确等于场的散度在该体积上的积分。这个练习强化了体积积分源项与表面净通量之间的等价关系，这是将微分方程转换为单元代数守恒方程的核心思想。",
            "id": "3364056",
            "problem": "在用于三维空间稳态标量守恒律的有限体积法 (FVM) 中，对一个单元的控制体平衡将通量场散度的体积分简化为穿过单元边界的净流出通量。考虑单位立方体控制体积 $V=[0,1]^{3}$，其边界为 $\\partial V$，单位外法向量为 $\\boldsymbol{n}$，光滑通量场为 $\\boldsymbol{F}(x,y,z)=(x^{2},\\,xy,\\,z)$。仅使用积分形式的控制体守恒声明和穿过有向面的外向通量的几何解释，通过计算并求和穿过 V 的六个具有正确法线方向的平面的外向通量，来计算单元内的总生成量，即积分 $\\int_{V}\\nabla\\cdot \\boldsymbol{F}\\,dV$。\n\n将您的最终值表示为精确分数，不得四舍五入。无需单位。在您的推理中，明确定义并使用每个面的外指法向量。",
            "solution": "该问题要求计算在单位立方体控制体积 $V$ 上，给定通量场 $\\boldsymbol{F}$ 的总生成项 $\\int_{V}\\nabla\\cdot \\boldsymbol{F}\\,dV$。根据散度定理（高斯定理），这可以通过计算穿过单元边界 $\\partial V$ 的净流出通量来完成：\n$$ \\int_{V} (\\nabla \\cdot \\boldsymbol{F}) \\, dV = \\oint_{\\partial V} \\boldsymbol{F} \\cdot \\boldsymbol{n} \\, dS $$\n右侧的项表示 $\\boldsymbol{F}$ 穿过曲面 $\\partial V$ 的总外向通量。我们通过求和立方体六个面的贡献来计算该面积分。控制体积为单位立方体 $V = [0,1]^3$，通量场为 $\\boldsymbol{F}(x,y,z) = (x^2, xy, z)$。\n\n边界 $\\partial V$ 的六个面及其对应的外指单位法向量 $\\boldsymbol{n}$ 如下：\n\n1.  **右面 ($x=1$):** 外法向量为 $\\boldsymbol{n}_R = (1, 0, 0)$。在此面上，$\\boldsymbol{F}(1,y,z) = (1, y, z)$。点积为 $\\boldsymbol{F} \\cdot \\boldsymbol{n}_R = 1$。穿过此面的通量为：\n    $$ \\Phi_R = \\int_{0}^{1}\\int_{0}^{1} 1 \\, dy \\, dz = 1 $$\n\n2.  **左面 ($x=0$):** 外法向量为 $\\boldsymbol{n}_L = (-1, 0, 0)$。在此面上，$\\boldsymbol{F}(0,y,z) = (0, 0, z)$。点积为 $\\boldsymbol{F} \\cdot \\boldsymbol{n}_L = 0$。穿过此面的通量为：\n    $$ \\Phi_L = \\int_{0}^{1}\\int_{0}^{1} 0 \\, dy \\, dz = 0 $$\n\n3.  **顶面 ($y=1$):** 外法向量为 $\\boldsymbol{n}_T = (0, 1, 0)$。在此面上，$\\boldsymbol{F}(x,1,z) = (x^2, x, z)$。点积为 $\\boldsymbol{F} \\cdot \\boldsymbol{n}_T = x$。穿过此面的通量为：\n    $$ \\Phi_T = \\int_{0}^{1}\\int_{0}^{1} x \\, dx \\, dz = \\left( \\int_{0}^{1} x \\, dx \\right) \\left( \\int_{0}^{1} 1 \\, dz \\right) = \\left[ \\frac{x^2}{2} \\right]_{0}^{1} \\cdot [z]_0^1 = \\frac{1}{2} $$\n\n4.  **底面 ($y=0$):** 外法向量为 $\\boldsymbol{n}_B = (0, -1, 0)$。在此面上，$\\boldsymbol{F}(x,0,z) = (x^2, 0, z)$。点积为 $\\boldsymbol{F} \\cdot \\boldsymbol{n}_B = 0$。穿过此面的通量为：\n    $$ \\Phi_B = \\int_{0}^{1}\\int_{0}^{1} 0 \\, dx \\, dz = 0 $$\n\n5.  **前面 ($z=1$):** 外法向量为 $\\boldsymbol{n}_F = (0, 0, 1)$。在此面上，$\\boldsymbol{F}(x,y,1) = (x^2, xy, 1)$。点积为 $\\boldsymbol{F} \\cdot \\boldsymbol{n}_F = 1$。穿过此面的通量为：\n    $$ \\Phi_F = \\int_{0}^{1}\\int_{0}^{1} 1 \\, dx \\, dy = 1 $$\n\n6.  **后面 ($z=0$):** 外法向量为 $\\boldsymbol{n}_{Bk} = (0, 0, -1)$。在此面上，$\\boldsymbol{F}(x,y,0) = (x^2, xy, 0)$。点积为 $\\boldsymbol{F} \\cdot \\boldsymbol{n}_{Bk} = 0$。穿过此面的通量为：\n    $$ \\Phi_{Bk} = \\int_{0}^{1}\\int_{0}^{1} 0 \\, dx \\, dy = 0 $$\n\n总生成量是这六个外向通量的总和：\n$$ \\int_{V} (\\nabla \\cdot \\boldsymbol{F}) \\, dV = \\Phi_R + \\Phi_L + \\Phi_T + \\Phi_B + \\Phi_F + \\Phi_{Bk} $$\n代入计算值：\n$$ \\int_{V} (\\nabla \\cdot \\boldsymbol{F}) \\, dV = 1 + 0 + \\frac{1}{2} + 0 + 1 + 0 = 2 + \\frac{1}{2} = \\frac{5}{2} $$\n单元内的总生成量，即计算出的净流出通量，为 $\\frac{5}{2}$。",
            "answer": "$$ \\boxed{\\frac{5}{2}} $$"
        },
        {
            "introduction": "在通量概念的基础上，这个实践将处理物理和工程领域中一个常见且关键的场景：物质在两种不同性质材料的交界面上的输运。你将推导并应用一个两点通量近似（TPFA）公式来计算界面通量，这对于精确模拟具有空间变化的系数（如热导率或电导率）的系统至关重要。此问题展示了在有限体积框架中如何通过施加通量连续性原理来处理材料的非均匀性。",
            "id": "3363983",
            "problem": "考虑一个无量纲一维稳态扩散问题，该问题由偏微分方程 (PDE) $-\\frac{d}{dx}\\left(\\kappa(x)\\frac{du}{dx}\\right)=0$ 在两个相邻有限体积单元的并集上控制。左侧单元为 $C_{L}=[-1,0]$，其分段常数扩散系数为 $\\kappa(x)=\\kappa_{L}=1$；右侧单元为 $C_{R}=[0,1]$，其分段常数扩散系数为 $\\kappa(x)=\\kappa_{R}=4$。单元中心的主变量为 $x=-\\frac{1}{2}$ 处的 $u_{L}=0$ 和 $x=\\frac{1}{2}$ 处的 $u_{R}=1$。公共界面位于 $x=0$ 处，两个单元的宽度均为 $h=1$，因此单元中心到界面的距离为 $d_{L}=d_{R}=\\frac{h}{2}=\\frac{1}{2}$。\n\n应用散度定理于每个单元的守恒方程，并强制施加法向通量在材料界面上连续的物理跳跃条件，推导一个跨越 $x=0$ 的界面通量 $F$ 的两点通量近似 (TPFA) 表达式，该表达式仅用 $\\kappa_{L}$、$\\kappa_{R}$、$u_{L}$、$u_{R}$、$d_{L}$ 和 $d_{R}$ 表示。然后，根据给定数据 $\\kappa_{L}=1$, $\\kappa_{R}=4$, $u_{L}=0$, $u_{R}=1$, $d_{L}=d_{R}=\\frac{1}{2}$ 计算 $F$ 的值。按照界面处单位法向量从 $C_{L}$ 指向 $C_{R}$（即沿 x 轴正方向）的约定，解释 $F$ 的符号。提供 $F$ 的最终值作为您的答案。无需四舍五入，所有量均为无量纲，因此不需要单位。",
            "solution": "一维稳态扩散的控制偏微分方程 (PDE) 如下：\n$$ -\\frac{d}{dx}\\left(\\kappa(x)\\frac{du}{dx}\\right) = 0 $$\n通量 $F(x)$ 定义为 $F(x) = -\\kappa(x)\\frac{du}{dx}$。将通量的定义代入 PDE，得到 $\\frac{dF}{dx} = 0$，这意味着通量 $F(x)$ 在整个区域内是恒定的。\n\n为了推导界面通量的两点通量近似 (TPFA)，我们在每个单元内对通量定义 $F = -\\kappa \\frac{du}{dx}$ 进行积分。设界面 $x=0$ 处的主变量值为 $u_f$。\n\n对于左侧单元 $C_L$，扩散系数为 $\\kappa_L$。从单元中心 $x_L = -\\frac{1}{2}$ 积分到界面 $x=0$：\n$$ \\int_{u_L}^{u_f} du = \\int_{x_L}^{0} \\left(-\\frac{F}{\\kappa_L}\\right) dx \\implies u_f - u_L = -\\frac{F}{\\kappa_L} (0 - x_L) $$\n已知单元中心到界面的距离为 $d_L = |0 - x_L|$，我们有：\n$$ u_f - u_L = -\\frac{F d_L}{\\kappa_L} \\quad (1) $$\n\n对于右侧单元 $C_R$，扩散系数为 $\\kappa_R$。从界面 $x=0$ 积分到单元中心 $x_R = \\frac{1}{2}$：\n$$ \\int_{u_f}^{u_R} du = \\int_{0}^{x_R} \\left(-\\frac{F}{\\kappa_R}\\right) dx \\implies u_R - u_f = -\\frac{F}{\\kappa_R} (x_R - 0) $$\n已知单元中心到界面的距离为 $d_R = |x_R - 0|$，我们有：\n$$ u_R - u_f = -\\frac{F d_R}{\\kappa_R} \\quad (2) $$\n\n我们现在可以通过消去未知的界面值 $u_f$ 来求解 $F$。由方程(1)和(2)分别解出 $u_f$：\n$$ u_f = u_L - \\frac{F d_L}{\\kappa_L} $$\n$$ u_f = u_R + \\frac{F d_R}{\\kappa_R} $$\n令两个 $u_f$ 的表达式相等：\n$$ u_L - \\frac{F d_L}{\\kappa_L} = u_R + \\frac{F d_R}{\\kappa_R} $$\n整理后求解界面通量 $F$：\n$$ u_L - u_R = F \\left( \\frac{d_L}{\\kappa_L} + \\frac{d_R}{\\kappa_R} \\right) $$\n$$ F = \\frac{u_L - u_R}{\\frac{d_L}{\\kappa_L} + \\frac{d_R}{\\kappa_R}} = -\\frac{u_R - u_L}{\\frac{d_L}{\\kappa_L} + \\frac{d_R}{\\kappa_R}} $$\n这个表达式类似于欧姆定律或傅里叶定律，其中通量等于势差除以阻力之和。\n\n现在，我们代入给定的数值：$\\kappa_L = 1$, $\\kappa_R = 4$, $u_L = 0$, $u_R = 1$, $d_L = \\frac{1}{2}$, $d_R = \\frac{1}{2}$。\n$$ F = \\frac{0 - 1}{\\frac{1/2}{1} + \\frac{1/2}{4}} = \\frac{-1}{\\frac{1}{2} + \\frac{1}{8}} $$\n$$ F = \\frac{-1}{\\frac{4}{8} + \\frac{1}{8}} = \\frac{-1}{\\frac{5}{8}} = - \\frac{8}{5} $$\n通量 $F$ 的符号表示其方向。按约定，正通量表示从左到右的流动。计算出的通量为负值，表示净流动方向是从右到左（从 $C_R$ 到 $C_L$），即从高势区域 ($u_R = 1$) 到低势区域 ($u_L = 0$)。",
            "answer": "$$\\boxed{-\\frac{8}{5}}$$"
        },
        {
            "introduction": "一个完整的物理模型需要定义计算区域如何与其周围环境相互作用，这通过边界条件来指定。最后的这个实践聚焦于如何将诺伊曼（Neumann）边界条件（或称指定通量边界条件）整合到有限体积的单元守恒方程中。你将看到边界上的一个物理约束——即一个已知的通量——如何被数学地转化为边界单元代数方程中的一个常数项，这是为整个区域组建最终线性系统的关键一步。",
            "id": "3363998",
            "problem": "考虑一个二维域上具有恒定传导系数的守恒形式的稳态扩散偏微分方程 (PDE)，在左边界 $x=0$ 的邻域内由 $-\\nabla \\cdot (\\kappa \\nabla u) = s$ 给出。设一个单位面积的有限体积控制单元 $V$ 邻接边界 $x=0$，使其左侧面与边界的一段重合且长度为单位长度。采用有限体积法 (FVM) 和散度定理，以面通量的形式推导 $V$ 上的积分平衡方程。设边界 $x=0$ 上的外向单位法向量为 $\\boldsymbol{n} = (-1,0)$，并在该面上施加诺伊曼 (Neumann) 边界条件 $\\partial_{n} u = \\boldsymbol{\\nabla} u \\cdot \\boldsymbol{n} = 1$。假设 $\\kappa = 2$ 为常数，且控制体积的其余面均为内部面，其贡献将以符号形式保留，此处不进行数值计算。\n\n从散度定理和扩散通量的定义出发，将单元平衡表示为面通量之和等于积分源项。然后，分离出诺伊曼边界面的贡献，并将此已知贡献移至单元代数方程的右侧。仅由 $x=0$ 上的诺伊曼边界所致，必须加到该单元右侧项的确切标量值是多少？请以单个无单位实数的形式提供您的答案，不要四舍五入。",
            "solution": "根据有限体积法，我们将控制方程 $-\\nabla \\cdot (\\kappa \\nabla u) = s$ 在控制体积 $V$ 上进行积分：\n$$ \\int_V -\\nabla \\cdot (\\kappa \\nabla u) \\, dV = \\int_V s \\, dV $$\n定义扩散通量向量为 $\\boldsymbol{q} = -\\kappa \\nabla u$。应用散度定理，我们将左侧的体积分转换为边界上的面积分，该面积分可分解为对单元所有面的通量之和：\n$$ \\sum_{f \\in \\partial V} \\int_f \\boldsymbol{q} \\cdot \\boldsymbol{n}_{f} \\, dS = \\int_V s \\, dV $$\n其中 $\\boldsymbol{n}_{f}$ 是从体积 $V$ 指向外部的、针对面 $f$ 的单位法向量。将通量 $\\boldsymbol{q}$ 的定义代回，我们得到单元的积分平衡方程：\n$$ \\sum_{f \\in \\partial V} \\int_f (-\\kappa \\nabla u) \\cdot \\boldsymbol{n}_{f} \\, dS = \\int_V s \\, dV $$\n我们特别关注位于域边界 $x=0$ 上的那个面，记为 $f_{BC}$。该面上的通量为：\n$$ \\Phi_{BC} = \\int_{f_{BC}} (-\\kappa \\nabla u) \\cdot \\boldsymbol{n}_{f_{BC}} \\, dS $$\n对于这个面，控制单元的外法向 $\\boldsymbol{n}_{f_{BC}}$ 与域的外法向 $\\boldsymbol{n}$ 相同，即 $\\boldsymbol{n}_{f_{BC}} = \\boldsymbol{n} = (-1, 0)$。\n因为 $\\kappa=2$ 是常数，我们可以将其从积分中提出：\n$$ \\Phi_{BC} = -2 \\int_{f_{BC}} (\\nabla u \\cdot \\boldsymbol{n}) \\, dS $$\n问题给出了诺伊曼边界条件 $\\nabla u \\cdot \\boldsymbol{n} = 1$。我们将此代入：\n$$ \\Phi_{BC} = -2 \\int_{f_{BC}} (1) \\, dS = -2 \\cdot \\text{Area}(f_{BC}) $$\n该面的长度（在二维中即面积）为 1。因此，边界通量是一个已知的常数值：\n$$ \\Phi_{BC} = -2 \\times 1 = -2 $$\n完整的单元平衡方程可以写成：\n$$ \\Phi_{BC} + \\sum_{f \\in \\text{内部面}} \\Phi_{f} = \\int_V s \\, dV $$\n代入我们计算出的边界通量值：\n$$ -2 + \\sum_{f \\in \\text{内部面}} \\Phi_{f} = \\int_V s \\, dV $$\n在构建最终的代数方程组时，已知的常数项被移到方程的右侧（RHS）。将 $-2$ 移到右侧，我们得到：\n$$ \\sum_{f \\in \\text{内部面}} \\Phi_{f} = \\int_V s \\, dV + 2 $$\n因此，仅由 $x=0$ 处的诺伊曼边界条件所贡献到该单元方程右侧的确切标量值是 2。",
            "answer": "$$\n\\boxed{2}\n$$"
        }
    ]
}