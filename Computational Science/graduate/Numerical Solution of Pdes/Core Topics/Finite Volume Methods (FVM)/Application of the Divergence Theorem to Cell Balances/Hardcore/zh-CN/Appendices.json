{
    "hands_on_practices": [
        {
            "introduction": "散度定理是有限体积法的数学核心。它提供了一个强大的工具，将散度项的体积分转换为控制体表面的通量之和。第一个实践问题提供了一个直接的动手计算，以巩固这一基本概念，要求您通过精确计算一个简单立方单元六个面的外向通量来计算其内部的总生成量。",
            "id": "3364056",
            "problem": "在用于三维空间稳态标量守恒律的有限体积法 (FVM) 中，一个单元上的控制体平衡将通量场散度的体积分简化为穿过该单元边界的净向外通量。考虑一个单位立方体控制体 $V=[0,1]^{3}$，其边界为 $\\partial V$，单位外法向量为 $\\boldsymbol{n}$，光滑通量场为 $\\boldsymbol{F}(x,y,z)=(x^{2},\\,xy,\\,z)$。仅使用守恒的积分形式控制体表述和穿过定向面的向外通量的几何解释，通过计算并求和穿过 $V$ 的六个具有正确法线方向的平面的向外通量，来计算单元内的总生成量，即积分 $\\int_{V}\\nabla\\cdot \\boldsymbol{F}\\,dV$。\n\n将最终值表示为无舍入的精确分数。无需单位。在你的推理中明确定义并使用每个面的向外法向量。",
            "solution": "该问题要求计算在单位立方体控制体 $V$ 上，给定通量场 $\\boldsymbol{F}$ 的总生成项 $\\int_{V}\\nabla\\cdot \\boldsymbol{F}\\,dV$。问题指明，这需要通过计算穿过单元边界 $\\partial V$ 的净向外通量来完成，这是散度定理（也称为高斯定理）的应用。该定理指出，对于定义在具有分片光滑边界 $\\partial V$ 和指向外的单位法向量 $\\boldsymbol{n}$ 的区域 $V$ 上的连续可微向量场 $\\boldsymbol{F}$，以下等式成立：\n$$ \\int_{V} (\\nabla \\cdot \\boldsymbol{F}) \\, dV = \\oint_{\\partial V} \\boldsymbol{F} \\cdot \\boldsymbol{n} \\, dS $$\n等式右侧的项表示 $\\boldsymbol{F}$ 穿过曲面 $\\partial V$ 的总向外通量。在有限体积法的背景下，该等式允许将散度的体积分（表示体积内的源或汇）替换为控制体各面上的通量之和。\n\n控制体是单位立方体 $V = [0,1]^3$，由 $0 \\le x \\le 1$、$0 \\le y \\le 1$ 和 $0 \\le z \\le 1$ 定义。给定的通量场为 $\\boldsymbol{F}(x,y,z) = (x^2, xy, z)$。我们必须通过对立方体六个平面的贡献求和来计算该面积分。\n\n边界 $\\partial V$ 的六个面及其对应的指向外的单位法向量 $\\boldsymbol{n}$ 如下：\n\n1.  **右侧面 ($x=1$):** 该面由 $x=1$，$0 \\le y \\le 1$，$0 \\le z \\le 1$ 定义。向外法向量为 $\\boldsymbol{n}_R = (1, 0, 0)$。在此面上，通量场为 $\\boldsymbol{F}(1,y,z) = (1^2, 1\\cdot y, z) = (1, y, z)$。点积为 $\\boldsymbol{F} \\cdot \\boldsymbol{n}_R = (1, y, z) \\cdot (1, 0, 0) = 1$。穿过此面的通量为：\n    $$ \\Phi_R = \\int_{0}^{1}\\int_{0}^{1} (\\boldsymbol{F} \\cdot \\boldsymbol{n}_R) \\, dy \\, dz = \\int_{0}^{1}\\int_{0}^{1} 1 \\, dy \\, dz = 1 $$\n\n2.  **左侧面 ($x=0$):** 该面由 $x=0$，$0 \\le y \\le 1$，$0 \\le z \\le 1$ 定义。向外法向量为 $\\boldsymbol{n}_L = (-1, 0, 0)$。在此面上，通量场为 $\\boldsymbol{F}(0,y,z) = (0^2, 0\\cdot y, z) = (0, 0, z)$。点积为 $\\boldsymbol{F} \\cdot \\boldsymbol{n}_L = (0, 0, z) \\cdot (-1, 0, 0) = 0$。穿过此面的通量为：\n    $$ \\Phi_L = \\int_{0}^{1}\\int_{0}^{1} (\\boldsymbol{F} \\cdot \\boldsymbol{n}_L) \\, dy \\, dz = \\int_{0}^{1}\\int_{0}^{1} 0 \\, dy \\, dz = 0 $$\n\n3.  **顶面 ($y=1$):** 该面由 $y=1$，$0 \\le x \\le 1$，$0 \\le z \\le 1$ 定义。向外法向量为 $\\boldsymbol{n}_T = (0, 1, 0)$。在此面上，通量场为 $\\boldsymbol{F}(x,1,z) = (x^2, x\\cdot 1, z) = (x^2, x, z)$。点积为 $\\boldsymbol{F} \\cdot \\boldsymbol{n}_T = (x^2, x, z) \\cdot (0, 1, 0) = x$。穿过此面的通量为：\n    $$ \\Phi_T = \\int_{0}^{1}\\int_{0}^{1} (\\boldsymbol{F} \\cdot \\boldsymbol{n}_T) \\, dx \\, dz = \\int_{0}^{1}\\int_{0}^{1} x \\, dx \\, dz = \\left( \\int_{0}^{1} x \\, dx \\right) \\left( \\int_{0}^{1} 1 \\, dz \\right) = \\left[ \\frac{x^2}{2} \\right]_{0}^{1} \\cdot [z]_0^1 = \\frac{1}{2} \\cdot 1 = \\frac{1}{2} $$\n\n4.  **底面 ($y=0$):** 该面由 $y=0$，$0 \\le x \\le 1$，$0 \\le z \\le 1$ 定义。向外法向量为 $\\boldsymbol{n}_B = (0, -1, 0)$。在此面上，通量场为 $\\boldsymbol{F}(x,0,z) = (x^2, x\\cdot 0, z) = (x^2, 0, z)$。点积为 $\\boldsymbol{F} \\cdot \\boldsymbol{n}_B = (x^2, 0, z) \\cdot (0, -1, 0) = 0$。穿过此面的通量为：\n    $$ \\Phi_B = \\int_{0}^{1}\\int_{0}^{1} (\\boldsymbol{F} \\cdot \\boldsymbol{n}_B) \\, dx \\, dz = \\int_{0}^{1}\\int_{0}^{1} 0 \\, dx \\, dz = 0 $$\n\n5.  **前面 ($z=1$):** 该面由 $z=1$，$0 \\le x \\le 1$，$0 \\le y \\le 1$ 定义。向外法向量为 $\\boldsymbol{n}_F = (0, 0, 1)$。在此面上，通量场为 $\\boldsymbol{F}(x,y,1) = (x^2, xy, 1)$。点积为 $\\boldsymbol{F} \\cdot \\boldsymbol{n}_F = (x^2, xy, 1) \\cdot (0, 0, 1) = 1$。穿过此面的通量为：\n    $$ \\Phi_F = \\int_{0}^{1}\\int_{0}^{1} (\\boldsymbol{F} \\cdot \\boldsymbol{n}_F) \\, dx \\, dy = \\int_{0}^{1}\\int_{0}^{1} 1 \\, dx \\, dy = 1 $$\n\n6.  **后面 ($z=0$):** 该面由 $z=0$，$0 \\le x \\le 1$，$0 \\le y \\le 1$ 定义。向外法向量为 $\\boldsymbol{n}_{Bk} = (0, 0, -1)$。在此面上，通量场为 $\\boldsymbol{F}(x,y,0) = (x^2, xy, 0)$。点积为 $\\boldsymbol{F} \\cdot \\boldsymbol{n}_{Bk} = (x^2, xy, 0) \\cdot (0, 0, -1) = 0$。穿过此面的通量为：\n    $$ \\Phi_{Bk} = \\int_{0}^{1}\\int_{0}^{1} (\\boldsymbol{F} \\cdot \\boldsymbol{n}_{Bk}) \\, dx \\, dy = \\int_{0}^{1}\\int_{0}^{1} 0 \\, dx \\, dy = 0 $$\n\n总生成量是这六个向外通量之和：\n$$ \\int_{V} (\\nabla \\cdot \\boldsymbol{F}) \\, dV = \\Phi_R + \\Phi_L + \\Phi_T + \\Phi_B + \\Phi_F + \\Phi_{Bk} $$\n代入计算出的值：\n$$ \\int_{V} (\\nabla \\cdot \\boldsymbol{F}) \\, dV = 1 + 0 + \\frac{1}{2} + 0 + 1 + 0 = 2 + \\frac{1}{2} = \\frac{5}{2} $$\n单元内的总生成量，即计算出的净向外通量，为 $\\frac{5}{2}$。",
            "answer": "$$ \\boxed{\\frac{5}{2}} $$"
        },
        {
            "introduction": "现实世界中的物理系统很少是均匀的；它们通常由具有不同属性的不同材料组成。这给数值模拟带来了一个关键挑战：如何准确地表示物理量在材料界面上的流动。本练习直面这一问题，引导您推导和计算在电导率 $\\kappa$ 发生突变的界面上的通量，这是模拟非均匀介质的一项关键技能。",
            "id": "3363983",
            "problem": "考虑一个无量纲一维稳态扩散问题，该问题由偏微分方程(PDE) $-\\frac{d}{dx}\\left(\\kappa(x)\\frac{du}{dx}\\right)=0$ 在两个相邻有限体积单元的并集上控制。左侧单元为 $C_{L}=[-1,0]$，其分段常数传导率为 $\\kappa(x)=\\kappa_{L}=1$；右侧单元为 $C_{R}=[0,1]$，其分段常数传导率为 $\\kappa(x)=\\kappa_{R}=4$。单元中心的主变量为 $x=-\\frac{1}{2}$ 处的 $u_{L}=0$ 和 $x=\\frac{1}{2}$ 处的 $u_{R}=1$。公共界面位于 $x=0$，两个单元的宽度均为 $h=1$，因此从单元中心到界面的距离为 $d_{L}=d_{R}=\\frac{h}{2}=\\frac{1}{2}$。\n\n利用应用于每个单元平衡的散度定理，并强制施加法向通量在材料界面上连续的物理跳跃条件，推导出一个跨越 $x=0$ 的界面通量 $F$ 的两点通量近似(TPFA)表达式，该表达式仅用 $\\kappa_{L}$、$\\kappa_{R}$、$u_{L}$、$u_{R}$、$d_{L}$ 和 $d_{R}$ 表示。然后，根据给定数据 $\\kappa_{L}=1$、$\\kappa_{R}=4$、$u_{L}=0$、$u_{R}=1$、$d_{L}=d_{R}=\\frac{1}{2}$ 计算 $F$ 的值。根据界面单位法向量从 $C_{L}$ 指向 $C_{R}$（即沿 $x$ 轴正方向）的约定，解释 $F$ 的符号。提供 $F$ 的最终值作为答案。无需四舍五入，所有量均为无量纲，因此不需要单位。",
            "solution": "一维稳态扩散的控制偏微分方程(PDE)如下所示：\n$$ -\\frac{d}{dx}\\left(\\kappa(x)\\frac{du}{dx}\\right) = 0 $$\n通量 $F(x)$ 定义为：\n$$ F(x) = -\\kappa(x)\\frac{du}{dx} $$\n将通量的定义代入偏微分方程，得到：\n$$ \\frac{dF}{dx} = 0 $$\n这意味着只要解 $u(x)$ 和通量是连续的，通量 $F(x)$ 在整个区域内就是恒定的。问题陈述要求在 $x=0$ 的材料界面上强制法向通量连续。因此，我们可以用 $F$ 表示整个区域 $[-1,1]$ 上的恒定通量。\n\n有限体积法的核心是在控制体积上对控制方程进行积分，本例中的控制体积即为单元 $C_L = [-1,0]$ 和 $C_R = [0,1]$。然而，为了推导界面通量的两点通量近似(TPFA)，我们将单元中心值与界面处的值联系起来。这是通过在每个单元内的适当段上对通量定义 $F = -\\kappa \\frac{du}{dx}$ 进行积分来实现的，假设 $\\kappa$ 是分段常数。\n\n对于左侧单元 $C_L$，传导率为 $\\kappa(x) = \\kappa_L = 1$。我们将通量定义从单元中心 $x_L = -\\frac{1}{2}$ 积分到界面 $x=0$。设界面处主变量 $u$ 的值为 $u_f = u(0)$。\n$$ \\int_{x_L}^{0} du = \\int_{x_L}^{0} \\left(-\\frac{F}{\\kappa_L}\\right) dx $$\n$$ u(0) - u(x_L) = -\\frac{F}{\\kappa_L} (0 - x_L) $$\n给定 $u(x_L) = u_L$ 并定义从单元中心到界面的距离为 $d_L = |0 - x_L| = -x_L = \\frac{1}{2}$，我们有：\n$$ u_f - u_L = -\\frac{F d_L}{\\kappa_L} \\quad (1) $$\n\n对于右侧单元 $C_R$，传导率为 $\\kappa(x) = \\kappa_R = 4$。我们将通量定义从界面 $x=0$ 积分到单元中心 $x_R = \\frac{1}{2}$。\n$$ \\int_{0}^{x_R} du = \\int_{0}^{x_R} \\left(-\\frac{F}{\\kappa_R}\\right) dx $$\n$$ u(x_R) - u(0) = -\\frac{F}{\\kappa_R} (x_R - 0) $$\n给定 $u(x_R) = u_R$ 并定义从单元中心到界面的距离为 $d_R = |x_R - 0| = x_R = \\frac{1}{2}$，我们有：\n$$ u_R - u_f = -\\frac{F d_R}{\\kappa_R} \\quad (2) $$\n\n我们现在得到了一个关于两个未知数 $u_f$ 和 $F$ 的二元线性方程组。问题要求用给定量的表达式来表示 $F$。我们可以通过消去未知界面值 $u_f$ 来实现。\n从方程(1)中，我们求解 $u_f$：\n$$ u_f = u_L - \\frac{F d_L}{\\kappa_L} $$\n从方程(2)中，我们也求解 $u_f$：\n$$ u_f = u_R + \\frac{F d_R}{\\kappa_R} $$\n令两个关于 $u_f$ 的表达式相等：\n$$ u_L - \\frac{F d_L}{\\kappa_L} = u_R + \\frac{F d_R}{\\kappa_R} $$\n现在，我们求解界面通量 $F$：\n$$ u_L - u_R = F \\left( \\frac{d_L}{\\kappa_L} + \\frac{d_R}{\\kappa_R} \\right) $$\n$$ F = \\frac{u_L - u_R}{\\frac{d_L}{\\kappa_L} + \\frac{d_R}{\\kappa_R}} $$\n这就是所求的两点通量近似，可以表示为：\n$$ F = -\\frac{u_R - u_L}{\\frac{d_L}{\\kappa_L} + \\frac{d_R}{\\kappa_R}} $$\n这个表达式类似于欧姆定律或傅里叶定律的形式，其中通量等于势差除以电阻之和。\n\n现在，我们代入给定的数值：\n$\\kappa_L = 1$\n$\\kappa_R = 4$\n$u_L = 0$\n$u_R = 1$\n$d_L = \\frac{1}{2}$\n$d_R = \\frac{1}{2}$\n\n$$ F = \\frac{0 - 1}{\\frac{1/2}{1} + \\frac{1/2}{4}} $$\n$$ F = \\frac{-1}{\\frac{1}{2} + \\frac{1}{8}} $$\n为了对分母中的分数求和，我们找到一个公分母，即 $8$：\n$$ F = \\frac{-1}{\\frac{4}{8} + \\frac{1}{8}} $$\n$$ F = \\frac-1}{\\frac{5}{8}} $$\n$$ F = - \\frac{8}{5} $$\n\n通量 $F$ 的符号表示其方向。问题指定界面处的单位法向量从 $C_L$ 指向 $C_R$，即 $x$ 轴正方向。因此，正通量表示从左到右的流动。我们计算出的通量为 $F = -\\frac{8}{5}$，是负值。这表示由 $u$ 代表的量的净流动方向是从右到左（从 $C_R$ 到 $C_L$），即沿 $x$ 轴负方向。这与给定的单元中心值在物理上是一致的，因为右侧单元的势 ($u_R = 1$) 高于左侧单元的势 ($u_L = 0$)，从而驱动流动从高势区流向低势区。",
            "answer": "$$\\boxed{-\\frac{8}{5}}$$"
        },
        {
            "introduction": "在对区域内部进行离散化之后，我们必须通过施加边界条件来处理其边缘。最后一个实践问题演示了如何将指定通量的诺伊曼（Neumann）边界条件整合到有限体积框架中。您将看到这个物理条件如何转化为单元平衡方程中的一个已知数值，这是组建最终待解代数方程组的关键一步。",
            "id": "3363998",
            "problem": "考虑一个二维域上的稳态扩散偏微分方程（PDE），其守恒形式为 $-\\nabla \\cdot (\\kappa \\nabla u) = s$，电导率恒定，方程在左边界 $x=0$ 的邻域内成立。假设一个单位面积的有限体积控制单元 $V$ 邻接边界 $x=0$，其左侧面与边界的一段重合并具有单位长度。采用有限体积法（FVM）和散度定理，以面通量的形式推导 $V$ 上的积分平衡。设边界 $x=0$ 上的外向单位法向量为 $\\boldsymbol{n} = (-1,0)$，并在此面上施加诺伊曼（Neumann）边界条件 $\\partial_{n} u = \\boldsymbol{\\nabla} u \\cdot \\boldsymbol{n} = 1$。假设 $\\kappa = 2$ 为常数，且控制体积的其余面均为内部面，其贡献将以符号形式保留，此处不进行数值计算。\n\n从散度定理和扩散通量的定义出发，将单元平衡表示为等于积分源项的面通量之和。然后，分离出诺伊曼边界面的贡献，并将此已知贡献移至单元代数方程的右侧。仅由 $x=0$ 上的诺伊曼边界所致，必须加到该单元右侧项的确切标量值是多少？请以一个无单位的实数形式提供答案，不要四舍五入。",
            "solution": "控制偏微分方程是守恒形式的稳态扩散方程：\n$$\n-\\nabla \\cdot (\\kappa \\nabla u) = s\n$$\n有限体积法首先将偏微分方程在控制体积 $V$ 上进行积分：\n$$\n\\int_V -\\nabla \\cdot (\\kappa \\nabla u) \\, dV = \\int_V s \\, dV\n$$\n我们定义扩散通量向量为 $\\mathbf{q} = -\\kappa \\nabla u$。方程可以写成：\n$$\n\\int_V \\nabla \\cdot \\mathbf{q} \\, dV = \\int_V s \\, dV\n$$\n散度定理指出，对于一个向量场 $\\mathbf{F}$ 和一个由表面 $\\partial V$ 包围的体积 $V$，以下关系成立：\n$$\n\\int_V \\nabla \\cdot \\mathbf{F} \\, dV = \\oint_{\\partial V} \\mathbf{F} \\cdot \\mathbf{n}_{out} \\, dS\n$$\n其中 $\\mathbf{n}_{out}$ 是表面元素 $dS$ 上指向外部的单位法向量。\n\n将散度定理应用于我们积分后 PDE 的左侧，其中 $\\mathbf{F} = \\mathbf{q} = -\\kappa\\nabla u$，我们得到：\n$$\n\\oint_{\\partial V} (-\\kappa \\nabla u) \\cdot \\mathbf{n}_{out} \\, dS = \\int_V s \\, dV\n$$\n该方程表示控制体积上的积分平衡：通过其边界流出体积的量的净通量等于体积内该量的总源项。\n\n面积分 $\\oint_{\\partial V}$ 被计算为控制体积每个面上的积分之和：\n$$\n\\sum_{f \\in \\text{faces of } V} \\int_f (-\\kappa \\nabla u) \\cdot \\mathbf{n}_{f} \\, dS_f = \\int_V s \\, dV\n$$\n其中 $\\mathbf{n}_{f}$ 是特定面 $f$ 的外向法向量。\n\n我们关心的是位于域边界 $x=0$ 上的面的贡献。我们将这个面称为 $f_{BC}$。对于这个面，从控制体积出发的外向法向量与从域出发的外向法向量相同，即 $\\mathbf{n}_{BC} = \\mathbf{n} = (-1, 0)$。\n\n该边界面对单元平衡的贡献是通量积分：\n$$\n\\text{Flux}_{BC} = \\int_{f_{BC}} (-\\kappa \\nabla u) \\cdot \\mathbf{n}_{BC} \\, dS\n$$\n电导率 $\\kappa$ 是一个常数，所以可以从积分中提出：\n$$\n\\text{Flux}_{BC} = -\\kappa \\int_{f_{BC}} (\\nabla u \\cdot \\mathbf{n}_{BC}) \\, dS\n$$\n问题给出了此面上的诺伊曼（Neumann）边界条件：$\\partial_n u = \\nabla u \\cdot \\mathbf{n} = 1$。由于 $\\mathbf{n}_{BC} = \\mathbf{n}$，我们在面 $f_{BC}$ 的任何位置都有 $\\nabla u \\cdot \\mathbf{n}_{BC} = 1$。我们可以将这个值代入积分中：\n$$\n\\text{Flux}_{BC} = -\\kappa \\int_{f_{BC}} (1) \\, dS = -\\kappa \\int_{f_{BC}} dS\n$$\n积分 $\\int_{f_{BC}} dS$ 表示面 $f_{BC}$ 的面积。在二维问题中，这是面段的长度。问题陈述该面的长度为单位长度，所以其面积（长度）为 $1$。\n$$\n\\int_{f_{BC}} dS = 1\n$$\n将此值以及给定的 $\\kappa=2$ 代入通量表达式中：\n$$\n\\text{Flux}_{BC} = - (2) \\times (1) = -2\n$$\n完整的单元平衡方程为：\n$$\n\\text{Flux}_{BC} + \\sum_{f \\in \\text{interior faces}} \\text{Flux}_{f} = \\int_V s \\, dV\n$$\n代入计算出的 $\\text{Flux}_{BC}$ 值：\n$$\n-2 + \\sum_{f \\in \\text{interior faces}} \\text{Flux}_{f} = \\int_V s \\, dV\n$$\n在有限体积法（FVM）代数系统的标准组装过程中，涉及未知变量 $u$ 的项保留在左侧（LHS），而已知常数项则移至右侧（RHS）。来自诺伊曼（Neumann）边界条件的通量是一个已知的常数。内部面上的通量取决于相邻单元中 $u$ 的未知值，并保留在左侧。将常数项 $-2$ 移到右侧，我们必须在等式两侧加上它的相反数：\n$$\n\\sum_{f \\in \\text{interior faces}} \\text{Flux}_{f} = \\int_V s \\, dV - (-2)\n$$\n$$\n\\sum_{f \\in \\text{interior faces}} \\text{Flux}_{f} = \\int_V s \\, dV + 2\n$$\n仅由诺伊曼（Neumann）边界条件贡献到右侧的值是 $2$。",
            "answer": "$$\n\\boxed{2}\n$$"
        }
    ]
}