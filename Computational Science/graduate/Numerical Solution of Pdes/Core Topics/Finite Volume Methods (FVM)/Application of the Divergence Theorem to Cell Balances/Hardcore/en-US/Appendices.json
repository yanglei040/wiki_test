{
    "hands_on_practices": [
        {
            "introduction": "The divergence theorem is the mathematical heart of the finite volume method, providing a powerful way to convert a volume integral into a surface integral. This first exercise offers a direct, hands-on verification of this principle by relating the total source within a simple cubic cell to the sum of outward fluxes across its six faces . Mastering this equivalence is the first crucial step toward understanding and implementing cell balances for any conservation law.",
            "id": "3364056",
            "problem": "In the Finite Volume Method (FVM) for a stationary scalar conservation law in three space dimensions, the control-volume balance over a cell reduces the volume integral of the divergence of a flux field to the net outward flux across the cell boundary. Consider the unit cube control volume $V=[0,1]^{3}$ with boundary $\\partial V$, outward unit normal $\\boldsymbol{n}$, and the smooth flux field $\\boldsymbol{F}(x,y,z)=(x^{2},\\,xy,\\,z)$. Using only the integral control-volume statement of conservation and the geometric interpretation of outward flux across oriented faces, compute the total production in the cell as the integral $\\int_{V}\\nabla\\cdot \\boldsymbol{F}\\,dV$ by evaluating and summing the outward fluxes across the six planar faces of $V$ with correct normal orientations.\n\nExpress your final value as an exact fraction with no rounding. No units are required. Define and use the outward-pointing normals for each face explicitly in your reasoning.",
            "solution": "The problem requires the computation of the total production term $\\int_{V}\\nabla\\cdot \\boldsymbol{F}\\,dV$ for a given flux field $\\boldsymbol{F}$ over a unit cube control volume $V$. The problem specifies that this is to be done by evaluating the net outward flux across the boundary $\\partial V$ of the cell, which is an application of the Divergence Theorem (also known as Gauss's theorem). The theorem states that for a continuously differentiable vector field $\\boldsymbol{F}$ defined on a region $V$ with a piecewise smooth boundary $\\partial V$ and outward-pointing unit normal vector $\\boldsymbol{n}$, the following equality holds:\n$$ \\int_{V} (\\nabla \\cdot \\boldsymbol{F}) \\, dV = \\oint_{\\partial V} \\boldsymbol{F} \\cdot \\boldsymbol{n} \\, dS $$\nThe term on the right-hand side represents the total outward flux of $\\boldsymbol{F}$ through the surface $\\partial V$. In the context of the Finite Volume Method, this equality allows the volume integral of the divergence (representing sources or sinks within the volume) to be replaced by a sum of fluxes over the faces of the control volume.\n\nThe control volume is the unit cube $V = [0,1]^3$, defined by $0 \\le x \\le 1$, $0 \\le y \\le 1$, and $0 \\le z \\le 1$. The flux field is given as $\\boldsymbol{F}(x,y,z) = (x^2, xy, z)$. We must compute the surface integral by summing the contributions from the six planar faces of the cube.\n\nThe six faces of the boundary $\\partial V$ and their corresponding outward-pointing unit normal vectors $\\boldsymbol{n}$ are:\n\n1.  **Right Face ($x=1$):** This face is defined by $x=1$, $0 \\le y \\le 1$, $0 \\le z \\le 1$. The outward normal vector is $\\boldsymbol{n}_R = (1, 0, 0)$. On this face, the flux field is $\\boldsymbol{F}(1,y,z) = (1^2, 1\\cdot y, z) = (1, y, z)$. The dot product is $\\boldsymbol{F} \\cdot \\boldsymbol{n}_R = (1, y, z) \\cdot (1, 0, 0) = 1$. The flux across this face is:\n    $$ \\Phi_R = \\int_{0}^{1}\\int_{0}^{1} (\\boldsymbol{F} \\cdot \\boldsymbol{n}_R) \\, dy \\, dz = \\int_{0}^{1}\\int_{0}^{1} 1 \\, dy \\, dz = 1 $$\n\n2.  **Left Face ($x=0$):** This face is defined by $x=0$, $0 \\le y \\le 1$, $0 \\le z \\le 1$. The outward normal vector is $\\boldsymbol{n}_L = (-1, 0, 0)$. On this face, the flux field is $\\boldsymbol{F}(0,y,z) = (0^2, 0\\cdot y, z) = (0, 0, z)$. The dot product is $\\boldsymbol{F} \\cdot \\boldsymbol{n}_L = (0, 0, z) \\cdot (-1, 0, 0) = 0$. The flux across this face is:\n    $$ \\Phi_L = \\int_{0}^{1}\\int_{0}^{1} (\\boldsymbol{F} \\cdot \\boldsymbol{n}_L) \\, dy \\, dz = \\int_{0}^{1}\\int_{0}^{1} 0 \\, dy \\, dz = 0 $$\n\n3.  **Top Face ($y=1$):** This face is defined by $y=1$, $0 \\le x \\le 1$, $0 \\le z \\le 1$. The outward normal vector is $\\boldsymbol{n}_T = (0, 1, 0)$. On this face, the flux field is $\\boldsymbol{F}(x,1,z) = (x^2, x\\cdot 1, z) = (x^2, x, z)$. The dot product is $\\boldsymbol{F} \\cdot \\boldsymbol{n}_T = (x^2, x, z) \\cdot (0, 1, 0) = x$. The flux across this face is:\n    $$ \\Phi_T = \\int_{0}^{1}\\int_{0}^{1} (\\boldsymbol{F} \\cdot \\boldsymbol{n}_T) \\, dx \\, dz = \\int_{0}^{1}\\int_{0}^{1} x \\, dx \\, dz = \\left( \\int_{0}^{1} x \\, dx \\right) \\left( \\int_{0}^{1} 1 \\, dz \\right) = \\left[ \\frac{x^2}{2} \\right]_{0}^{1} \\cdot [z]_0^1 = \\frac{1}{2} \\cdot 1 = \\frac{1}{2} $$\n\n4.  **Bottom Face ($y=0$):** This face is defined by $y=0$, $0 \\le x \\le 1$, $0 \\le z \\le 1$. The outward normal vector is $\\boldsymbol{n}_B = (0, -1, 0)$. On this face, the flux field is $\\boldsymbol{F}(x,0,z) = (x^2, x\\cdot 0, z) = (x^2, 0, z)$. The dot product is $\\boldsymbol{F} \\cdot \\boldsymbol{n}_B = (x^2, 0, z) \\cdot (0, -1, 0) = 0$. The flux across this face is:\n    $$ \\Phi_B = \\int_{0}^{1}\\int_{0}^{1} (\\boldsymbol{F} \\cdot \\boldsymbol{n}_B) \\, dx \\, dz = \\int_{0}^{1}\\int_{0}^{1} 0 \\, dx \\, dz = 0 $$\n\n5.  **Front Face ($z=1$):** This face is defined by $z=1$, $0 \\le x \\le 1$, $0 \\le y \\le 1$. The outward normal vector is $\\boldsymbol{n}_F = (0, 0, 1)$. On this face, the flux field is $\\boldsymbol{F}(x,y,1) = (x^2, xy, 1)$. The dot product is $\\boldsymbol{F} \\cdot \\boldsymbol{n}_F = (x^2, xy, 1) \\cdot (0, 0, 1) = 1$. The flux across this face is:\n    $$ \\Phi_F = \\int_{0}^{1}\\int_{0}^{1} (\\boldsymbol{F} \\cdot \\boldsymbol{n}_F) \\, dx \\, dy = \\int_{0}^{1}\\int_{0}^{1} 1 \\, dx \\, dy = 1 $$\n\n6.  **Back Face ($z=0$):** This face is defined by $z=0$, $0 \\le x \\le 1$, $0 \\le y \\le 1$. The outward normal vector is $\\boldsymbol{n}_{Bk} = (0, 0, -1)$. On this face, the flux field is $\\boldsymbol{F}(x,y,0) = (x^2, xy, 0)$. The dot product is $\\boldsymbol{F} \\cdot \\boldsymbol{n}_{Bk} = (x^2, xy, 0) \\cdot (0, 0, -1) = 0$. The flux across this face is:\n    $$ \\Phi_{Bk} = \\int_{0}^{1}\\int_{0}^{1} (\\boldsymbol{F} \\cdot \\boldsymbol{n}_{Bk}) \\, dx \\, dy = \\int_{0}^{1}\\int_{0}^{1} 0 \\, dx \\, dy = 0 $$\n\nThe total production is the sum of these six outward fluxes:\n$$ \\int_{V} (\\nabla \\cdot \\boldsymbol{F}) \\, dV = \\Phi_R + \\Phi_L + \\Phi_T + \\Phi_B + \\Phi_F + \\Phi_{Bk} $$\nSubstituting the computed values:\n$$ \\int_{V} (\\nabla \\cdot \\boldsymbol{F}) \\, dV = 1 + 0 + \\frac{1}{2} + 0 + 1 + 0 = 2 + \\frac{1}{2} = \\frac{5}{2} $$\nThe total production in the cell, computed as the net outward flux, is $\\frac{5}{2}$.",
            "answer": "$$ \\boxed{\\frac{5}{2}} $$"
        },
        {
            "introduction": "Building upon the divergence theorem, we now turn to the physical meaning of the flux vector, $\\boldsymbol{F}$. In many systems, such as heat conduction, flux is determined by a constitutive law relating it to the gradient of a scalar field, like temperature. This practice explores such a relationship for anisotropic diffusion, where material properties vary with direction, and tasks you with calculating the normal flux density—a critical component in the balance equation for any cell face .",
            "id": "3364066",
            "problem": "Consider an anisotropic steady diffusion of a scalar field $u(\\mathbf{x})$ in two spatial dimensions, governed by a Partial Differential Equation (PDE) expressing local conservation: the net rate of diffusive transport of $u$ through the boundary of any control volume vanishes in the absence of sources or sinks. In a Finite Volume Method (FVM) cell, introduce the outward unit normal vector $\\mathbf{n}$ on a particular face and suppose the symmetric positive-definite conductivity tensor is $\\mathbf{K}$. Assume that near this face, the gradient $\\nabla u$ is approximately constant and that the constitutive closure for anisotropic diffusion relates the diffusive flux vector to the gradient via a tensorial law.\n\nStarting from the local conservation statement and the divergence theorem, derive the outward normal diffusive flux density through the face in terms of $\\mathbf{K}$, $\\mathbf{n}$, and $\\nabla u$. Then, evaluate this normal flux density for\n$$\n\\mathbf{K}=\\begin{pmatrix}2&1\\\\1&3\\end{pmatrix},\\quad \\mathbf{n}=\\left(\\tfrac{1}{\\sqrt{2}},\\,\\tfrac{1}{\\sqrt{2}}\\right),\\quad \\nabla u=\\begin{pmatrix}1\\\\-1\\end{pmatrix}.\n$$\nFinally, based on the sign of the outward normal diffusive flux density you compute, explain whether the flux through this face removes $u$ from the cell or adds $u$ to the cell, under the convention that positive outward flux corresponds to removal. Express the numerical value of the outward normal diffusive flux density as an exact quantity with no units. No rounding is required.",
            "solution": "### Derivation and Solution\n\nThe problem begins with the statement of local conservation for a steady-state system with no sources or sinks. For an arbitrary control volume $V$ with boundary $\\partial V$, this is expressed in integral form as the net flux across the boundary being zero:\n$$ \\int_{\\partial V} \\mathbf{J} \\cdot \\mathbf{n} \\, dS = 0 $$\nwhere $\\mathbf{J}$ is the diffusive flux vector and $\\mathbf{n}$ is the outward unit normal to the surface element $dS$.\n\nBy the divergence theorem, the surface integral of the normal component of a vector field is equal to the volume integral of its divergence:\n$$ \\int_{\\partial V} \\mathbf{J} \\cdot \\mathbf{n} \\, dS = \\int_V (\\nabla \\cdot \\mathbf{J}) \\, dV $$\nCombining these two equations yields:\n$$ \\int_V (\\nabla \\cdot \\mathbf{J}) \\, dV = 0 $$\nSince this equality must hold for any arbitrary control volume $V$, the integrand must be zero everywhere (assuming continuity of the fields). This gives the differential form of the conservation law:\n$$ \\nabla \\cdot \\mathbf{J} = 0 $$\nThe problem states that a constitutive law relates the flux vector $\\mathbf{J}$ to the gradient of the scalar field, $\\nabla u$. For anisotropic diffusion, this is given by:\n$$ \\mathbf{J} = -\\mathbf{K} \\nabla u $$\nwhere $\\mathbf{K}$ is the conductivity tensor. The negative sign is a convention indicating that the flux is directed down the gradient of $u$ (i.e., from regions of high concentration/potential to low concentration/potential).\n\nThe quantity of interest is the \"outward normal diffusive flux density\" through a specific face. This is the scalar component of the flux vector $\\mathbf{J}$ in the direction of the outward unit normal $\\mathbf{n}$ of that face. It is given by the dot product:\n$$ J_n = \\mathbf{J} \\cdot \\mathbf{n} $$\nSubstituting the constitutive relation into this expression yields the desired formula for the outward normal diffusive flux density in terms of $\\mathbf{K}$, $\\mathbf{n}$, and $\\nabla u$:\n$$ J_n = (-\\mathbf{K} \\nabla u) \\cdot \\mathbf{n} $$\nThis completes the derivation part of the problem.\n\nNext, we evaluate this expression using the provided data:\n$$ \\mathbf{K} = \\begin{pmatrix} 2 & 1 \\\\ 1 & 3 \\end{pmatrix}, \\quad \\nabla u = \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}, \\quad \\mathbf{n} = \\begin{pmatrix} \\frac{1}{\\sqrt{2}} \\\\ \\frac{1}{\\sqrt{2}} \\end{pmatrix} $$\nFirst, we compute the product $\\mathbf{K} \\nabla u$:\n$$ \\mathbf{K} \\nabla u = \\begin{pmatrix} 2 & 1 \\\\ 1 & 3 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix} = \\begin{pmatrix} (2)(1) + (1)(-1) \\\\ (1)(1) + (3)(-1) \\end{pmatrix} = \\begin{pmatrix} 2 - 1 \\\\ 1 - 3 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ -2 \\end{pmatrix} $$\nThe diffusive flux vector $\\mathbf{J}$ is therefore:\n$$ \\mathbf{J} = -(\\mathbf{K} \\nabla u) = -\\begin{pmatrix} 1 \\\\ -2 \\end{pmatrix} = \\begin{pmatrix} -1 \\\\ 2 \\end{pmatrix} $$\nFinally, we compute the outward normal flux density $J_n$ by taking the dot product of $\\mathbf{J}$ with $\\mathbf{n}$:\n$$ J_n = \\mathbf{J} \\cdot \\mathbf{n} = \\begin{pmatrix} -1 \\\\ 2 \\end{pmatrix} \\cdot \\begin{pmatrix} \\frac{1}{\\sqrt{2}} \\\\ \\frac{1}{\\sqrt{2}} \\end{pmatrix} = (-1)\\left(\\frac{1}{\\sqrt{2}}\\right) + (2)\\left(\\frac{1}{\\sqrt{2}}\\right) = \\frac{-1 + 2}{\\sqrt{2}} = \\frac{1}{\\sqrt{2}} $$\nThe numerical value of the outward normal diffusive flux density is $\\frac{1}{\\sqrt{2}}$.\n\nThe final part of the problem asks for an interpretation based on the sign of this result. The calculated flux density is $J_n = \\frac{1}{\\sqrt{2}}$, which is a positive value. According to the problem's convention, \"positive outward flux corresponds to removal\". Therefore, since $J_n > 0$, the flux through this face is directed out of the FVM cell, signifying a net removal of the quantity $u$ from the cell across this particular face.",
            "answer": "$$\n\\boxed{\\frac{1}{\\sqrt{2}}}\n$$"
        },
        {
            "introduction": "The final step is to assemble the discrete algebraic equations that form the basis of a finite volume simulation from the integral cell balance. This balance, which equates the net flux to the total source, must hold for every cell, including those at the domain boundaries. This exercise demonstrates the practical procedure for incorporating a Neumann boundary condition—a specified flux—into the balance for a boundary cell, showing how this information becomes a known source term in the discrete equation .",
            "id": "3363998",
            "problem": "Consider a steady diffusion Partial Differential Equation (PDE) in conservation form on a two-dimensional domain with constant conductivity, given by $-\\nabla \\cdot (\\kappa \\nabla u) = s$ in a neighborhood of the left boundary $x=0$. Let a single finite volume control cell $V$ of unit area abut the boundary $x=0$, so that its left face coincides with a segment of the boundary and has unit length. Adopt the Finite Volume Method (FVM) with the divergence theorem to derive the integral balance over $V$ in terms of face fluxes. Let the outward unit normal on the boundary $x=0$ be $\\boldsymbol{n} = (-1,0)$, and impose a Neumann boundary condition $\\partial_{n} u = \\boldsymbol{\\nabla} u \\cdot \\boldsymbol{n} = 1$ on that face. Assume $\\kappa = 2$ is constant, and that the remaining faces of the control volume are interior faces whose contributions will be retained symbolically and not evaluated numerically here.\n\nStarting from the divergence theorem and the definition of diffusive flux, express the cell balance as a sum of face fluxes equal to the integrated source. Then, isolate the contribution of the Neumann boundary face and move this known contribution to the right-hand side of the algebraic equation for the cell. What is the exact scalar value that must be added to the right-hand side entry for this cell due solely to the Neumann boundary face on $x=0$? Provide your answer as a single real number with no units. Do not round.",
            "solution": "The solution proceeds by applying the Finite Volume Method to the given PDE over the specified control volume.\n\nThe governing PDE is a steady-state diffusion equation in conservation form:\n$$\n-\\nabla \\cdot (\\kappa \\nabla u) = s\n$$\nThe Finite Volume Method begins by integrating the PDE over the control volume $V$:\n$$\n\\int_V -\\nabla \\cdot (\\kappa \\nabla u) \\, dV = \\int_V s \\, dV\n$$\nWe define the diffusive flux vector as $\\mathbf{q} = -\\kappa \\nabla u$. The equation can be written as:\n$$\n\\int_V \\nabla \\cdot \\mathbf{q} \\, dV = \\int_V s \\, dV\n$$\nThe divergence theorem states that for a vector field $\\mathbf{F}$ and a volume $V$ enclosed by a surface $\\partial V$, the following relation holds:\n$$\n\\int_V \\nabla \\cdot \\mathbf{F} \\, dV = \\oint_{\\partial V} \\mathbf{F} \\cdot \\mathbf{n}_{out} \\, dS\n$$\nwhere $\\mathbf{n}_{out}$ is the outward-pointing unit normal vector on the surface element $dS$.\n\nApplying the divergence theorem to the left-hand side of our integrated PDE with $\\mathbf{F} = \\mathbf{q} = -\\kappa\\nabla u$, we get:\n$$\n\\oint_{\\partial V} (-\\kappa \\nabla u) \\cdot \\mathbf{n}_{out} \\, dS = \\int_V s \\, dV\n$$\nThis equation represents the integral balance over the control volume: the net flux of the quantity out of the volume through its boundary is equal to the total source of the quantity within the volume.\n\nThe surface integral $\\oint_{\\partial V}$ is evaluated as a sum of integrals over each face of the control volume:\n$$\n\\sum_{f \\in \\text{faces of } V} \\int_f (-\\kappa \\nabla u) \\cdot \\mathbf{n}_{f} \\, dS_f = \\int_V s \\, dV\n$$\nwhere $\\mathbf{n}_{f}$ is the outward normal for a specific face $f$.\n\nWe are interested in the contribution from the face lying on the domain boundary $x=0$. Let's call this face $f_{BC}$. For this face, the outward normal from the control volume is given as being the same as the outward normal from the domain, $\\mathbf{n}_{BC} = \\mathbf{n} = (-1, 0)$.\n\nThe contribution from this boundary face to the cell balance is the flux integral:\n$$\n\\text{Flux}_{BC} = \\int_{f_{BC}} (-\\kappa \\nabla u) \\cdot \\mathbf{n}_{BC} \\, dS\n$$\nThe conductivity $\\kappa$ is a constant, so it can be taken outside the integral:\n$$\n\\text{Flux}_{BC} = -\\kappa \\int_{f_{BC}} (\\nabla u \\cdot \\mathbf{n}_{BC}) \\, dS\n$$\nThe problem provides the Neumann boundary condition on this face: $\\partial_n u = \\nabla u \\cdot \\mathbf{n} = 1$. Since $\\mathbf{n}_{BC} = \\mathbf{n}$, we have $\\nabla u \\cdot \\mathbf{n}_{BC} = 1$ everywhere on the face $f_{BC}$. We can substitute this value into the integral:\n$$\n\\text{Flux}_{BC} = -\\kappa \\int_{f_{BC}} (1) \\, dS = -\\kappa \\int_{f_{BC}} dS\n$$\nThe integral $\\int_{f_{BC}} dS$ represents the area of the face $f_{BC}$. In a 2D problem, this is the length of the face segment. The problem states this face has unit length, so its area (length) is $1$.\n$$\n\\int_{f_{BC}} dS = 1\n$$\nSubstituting this and the given value of $\\kappa=2$ into the expression for the flux:\n$$\n\\text{Flux}_{BC} = - (2) \\times (1) = -2\n$$\nThe full cell balance equation is:\n$$\n\\text{Flux}_{BC} + \\sum_{f \\in \\text{interior faces}} \\text{Flux}_{f} = \\int_V s \\, dV\n$$\nSubstituting the calculated value for $\\text{Flux}_{BC}$:\n$$\n-2 + \\sum_{f \\in \\text{interior faces}} \\text{Flux}_{f} = \\int_V s \\, dV\n$$\nIn the standard assembly of the algebraic system for the FVM, terms involving the unknown variable $u$ are kept on the left-hand side (LHS), while known constant terms are moved to the right-hand side (RHS). The flux from the Neumann boundary condition is a known constant. The fluxes on the interior faces depend on the unknown values of $u$ in adjacent cells and are kept on the LHS. Moving the constant term $-2$ to the RHS, we must add its negation to both sides:\n$$\n\\sum_{f \\in \\text{interior faces}} \\text{Flux}_{f} = \\int_V s \\, dV - (-2)\n$$\n$$\n\\sum_{f \\in \\text{interior faces}} \\text{Flux}_{f} = \\int_V s \\, dV + 2\n$$\nThe value added to the right-hand side due solely to the Neumann boundary condition is $2$.",
            "answer": "$$\n\\boxed{2}\n$$"
        }
    ]
}