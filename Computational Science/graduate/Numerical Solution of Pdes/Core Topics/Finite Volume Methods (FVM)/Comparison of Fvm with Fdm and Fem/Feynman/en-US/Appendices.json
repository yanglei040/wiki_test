{
    "hands_on_practices": [
        {
            "introduction": "We begin our exploration by uncovering the deep mathematical structures that connect the Finite Volume and Finite Element methods for diffusion problems. While FVM is built upon the principle of local conservation and FEM upon Galerkin weak formulations, this exercise demonstrates that they can converge to remarkably similar algebraic forms. By deriving a discrete Green's identity , you will reformulate the FVM operator as a sum over mesh faces, providing a direct bridge to the structure of the FEM operator that arises from integration by parts.",
            "id": "3372431",
            "problem": "Consider the scalar diffusion model $- \\nabla \\cdot \\big(\\kappa \\nabla u\\big) = f$ in a bounded Lipschitz domain $\\Omega \\subset \\mathbb{R}^{d}$ with sufficiently smooth diffusion coefficient $\\kappa(x)$ and homogeneous Dirichlet boundary condition $u=0$ on $\\partial \\Omega$. Let $\\mathcal{T}_{h}$ be a conforming polytopal partition of $\\Omega$ into control volumes $K$, and let $\\mathcal{F}$ denote the set of all $(d-1)$-dimensional faces. For any interior face $F$ shared by two neighboring cells $K$ and $L$, write $F=K|L$ and let $n_{K,F}$ be the unit normal vector on $F$ pointing outward from $K$. Assume that for $K \\in \\mathcal{T}_{h}$ and $F \\subset \\partial K$, a consistent two-point flux approximation is adopted:\n$$\n\\Phi_{K,F}(u_{h}) \\approx - \\int_{F} \\kappa \\nabla u \\cdot n_{K,F} \\, \\mathrm{d}s = T_{F} \\, (u_{K} - u_{L}),\n$$\nwhere $T_{F} > 0$ is a symmetric transmissibility associated with $F$, $u_{K}$ and $u_{L}$ are cell-based approximations. Define the Finite Volume Method (FVM) bilinear form for a pair of cellwise constant fields $u_{h}$ and $v_{h}$ by\n$$\na_{h}^{\\mathrm{FVM}}(u_{h},v_{h}) := \\sum_{K \\in \\mathcal{T}_{h}} v_{K} \\sum_{F \\subset \\partial K} \\Phi_{K,F}(u_{h}).\n$$\n\nTasks:\n1) Using local conservation and the divergence theorem as the fundamental base, derive a discrete Green identity showing that the FVM diffusion bilinear form can be re-expressed as a sum over faces of numerical flux times jump of the test function. Your derivation must make explicit the antisymmetry of internal face fluxes and produce an expression of the form\n$$\na_{h}^{\\mathrm{FVM}}(u_{h},v_{h}) = \\sum_{F \\in \\mathcal{F}_{\\mathrm{int}}} T_{F} \\, [u_{h}]_{F} \\, [v_{h}]_{F} \\; + \\; \\text{(boundary-face terms)},\n$$\nwhere $[w]_{F}$ denotes the jump of a cellwise constant field $w$ across an interior face $F$, and $\\mathcal{F}_{\\mathrm{int}}$ is the set of interior faces. Explain the circumstances under which the boundary-face terms vanish.\n\n2) Consider the standard conforming Galerkin Finite Element Method (FEM) with piecewise affine (also called $P^{1}$) trial and test spaces on a matching simplicial mesh, with the exact bilinear form\n$$\na^{\\mathrm{FEM}}(u_{h},v_{h}) := \\int_{\\Omega} \\kappa \\, \\nabla u_{h} \\cdot \\nabla v_{h} \\, \\mathrm{d}x.\n$$\nStarting from the continuous integration by parts formula, show that under exact quadrature the FEM bilinear can be organized as an exact sum over faces of normal flux times trace, which algebraically coincides with the discrete Green identity in Task 1 when $u_{h}$ and $v_{h}$ are piecewise affine and the face-based transmissibility $T_{F}$ is chosen consistently with the exact average of $\\kappa$ on each element adjacent to $F$. Briefly contrast this exactness with the central-difference Finite Difference Method (FDM) on uniform one-dimensional grids.\n\n3) Specialize to one space dimension with domain $[0,1]$. Let $N \\in \\mathbb{N}$ be the number of subintervals and $h := 1/N$. Consider the vertex-centered FVM on the uniform grid with nodes $x_{i} := i h$ for $i=0,1,\\dots,N$ and control volumes $[x_{i-1/2},x_{i+1/2}]$ where $x_{i \\pm 1/2} := x_{i} \\pm h/2$. Define the two-point numerical flux on the interior face at $x_{i+1/2}$ by\n$$\n\\Phi_{i+1/2}(u_{h}) := - \\kappa(x_{i+1/2}) \\, \\frac{u_{i+1} - u_{i}}{h},\n$$\nand define the FVM diffusion bilinear by the discrete Green identity as\n$$\na_{h}^{\\mathrm{FVM}}(u_{h},v_{h}) := \\sum_{i=0}^{N-1} \\kappa(x_{i+1/2}) \\, \\frac{(u_{i+1} - u_{i})(v_{i+1} - v_{i})}{h}.\n$$\nLet the diffusion be affine, $\\kappa(x) := \\kappa_{0} + \\alpha x$ with $\\kappa_{0} > 0$ and real $\\alpha$. Let $I_{h}$ denote the nodal interpolation operator into the space of continuous, piecewise affine functions on the grid. Define $u_{h} := I_{h}(x(1-x))$ and $v_{h} := I_{h}(x(1-x))$. Using exact quadrature for the FEM, compute the quantity\n$$\nD(h) := a_{h}^{\\mathrm{FVM}}(u_{h},v_{h}) - a^{\\mathrm{FEM}}(u_{h},v_{h})\n$$\nin closed form as a function of $\\kappa_{0}$, $\\alpha$, and $h$. Provide your final answer as a single closed-form analytic expression. No rounding is required.",
            "solution": "The problem is validated as being scientifically grounded, well-posed, and objective. It consists of standard derivations and calculations in the field of numerical analysis for partial differential equations.\n\n### Task 1: Derivation of the FVM Discrete Green's Identity\n\nWe begin with the definition of the Finite Volume Method (FVM) bilinear form for cellwise constant fields $u_{h}$ and $v_{h}$:\n$$\na_{h}^{\\mathrm{FVM}}(u_{h},v_{h}) := \\sum_{K \\in \\mathcal{T}_{h}} v_{K} \\sum_{F \\subset \\partial K} \\Phi_{K,F}(u_{h})\n$$\nThe core principle is local conservation, where the sum of fluxes over the boundary of a control volume $K$ is balanced by the source term integrated over $K$. The bilinear form represents the weak formulation of the diffusion operator.\n\nThe fundamental step is to change the order of summation. Instead of summing over cells and then their faces, we sum over all faces in the mesh and then account for the cells sharing each face. The set of all faces $\\mathcal{F}$ can be partitioned into the set of interior faces $\\mathcal{F}_{\\mathrm{int}}$ and the set of boundary faces $\\mathcal{F}_{\\mathrm{bnd}}$.\n$$\na_{h}^{\\mathrm{FVM}}(u_{h},v_{h}) = \\sum_{F \\in \\mathcal{F}} \\sum_{K \\text{ s.t. } F \\subset \\partial K} v_{K} \\, \\Phi_{K,F}(u_{h})\n$$\nFor an interior face $F \\in \\mathcal{F}_{\\mathrm{int}}$, it is shared by exactly two cells, say $K$ and $L$, so we write $F=K|L$. The contribution to the sum from this face is:\n$$\nv_{K} \\Phi_{K,F}(u_{h}) + v_{L} \\Phi_{L,F}(u_{h})\n$$\nThe numerical flux $\\Phi_{K,F}(u_{h})$ approximates the physical flux integral $- \\int_{F} \\kappa \\nabla u \\cdot n_{K,F} \\, \\mathrm{d}s$. A key property of physical flux is antisymmetry with respect to the normal vector. That is, since the outward normal for $L$ on face $F$ is $n_{L,F} = -n_{K,F}$, the flux from $L$ to $K$ is the negative of the flux from $K$ to $L$. A consistent numerical flux must respect this: $\\Phi_{L,F}(u_h) = -\\Phi_{K,F}(u_h)$. Let's verify this with the given two-point flux approximation:\n$$\n\\Phi_{K,F}(u_{h}) = T_{F} \\, (u_{K} - u_{L})\n$$\nBy symmetry of the setup ($F=K|L$ is the same as $F=L|K$ and $T_F$ is associated with the face), the flux from cell $L$ is:\n$$\n\\Phi_{L,F}(u_{h}) = T_{F} \\, (u_{L} - u_{K}) = -T_{F} \\, (u_{K} - u_{L}) = -\\Phi_{K,F}(u_{h})\n$$\nThe property holds. Substituting this into the contribution from face $F$:\n$$\nv_{K} \\Phi_{K,F}(u_{h}) + v_{L} (-\\Phi_{K,F}(u_{h})) = (v_{K} - v_{L}) \\Phi_{K,F}(u_{h})\n$$\nNow, we define the jump of a cellwise constant field $w_h$ across an interior face $F=K|L$. Let us fix a unique normal $n_F$ for each $F \\in \\mathcal{F}_{\\mathrm{int}}$, for instance, by orienting it from the cell with the smaller global index to the larger one. If $n_F = n_{K,F}$, we define the jump as $[w_{h}]_{F} := w_{K} - w_{L}$. The expression for the flux $\\Phi_{K,F}(u_h)$ is consistent with this orientation, so $\\Phi_{K,F}(u_h) = T_F [u_h]_F$. The contribution from the interior face $F$ is then:\n$$\n[v_{h}]_{F} \\, T_{F} \\, [u_{h}]_{F} = T_{F} \\, [u_{h}]_{F} \\, [v_{h}]_{F}\n$$\nSumming over all interior faces, we get the first part of the target expression:\n$$\n\\sum_{F \\in \\mathcal{F}_{\\mathrm{int}}} T_{F} \\, [u_{h}]_{F} \\, [v_{h}]_{F}\n$$\nFor a boundary face $F \\in \\mathcal{F}_{\\mathrm{bnd}}$, it belongs to only one cell, say $K$. The problem specifies a homogeneous Dirichlet boundary condition, $u=0$ on $\\partial\\Omega$. A consistent scheme incorporates this by setting the value of $u$ outside the domain to $0$. So, if we denote $u_L$ as the value in the \"ghost\" cell outside, we have $u_L=0$. The flux is $\\Phi_{K,F}(u_{h}) = T_{F}(u_{K} - 0) = T_{F} u_{K}$. The contribution from all boundary faces is thus:\n$$\n\\sum_{F \\in \\mathcal{F}_{\\mathrm{bnd}}} v_{K(F)} \\, \\Phi_{K(F),F}(u_{h}) = \\sum_{F \\in \\mathcal{F}_{\\mathrm{bnd}}} v_{K(F)} \\, T_{F} \\, u_{K(F)}\n$$\nwhere $K(F)$ is the unique cell in $\\mathcal{T}_h$ that has $F$ as a boundary face. Combining the interior and boundary parts, we arrive at the discrete Green identity:\n$$\na_{h}^{\\mathrm{FVM}}(u_{h},v_{h}) = \\sum_{F \\in \\mathcal{F}_{\\mathrm{int}}} T_{F} \\, [u_{h}]_{F} \\, [v_{h}]_{F} + \\sum_{F \\in \\mathcal{F}_{\\mathrm{bnd}}} v_{K(F)} \\, T_{F} \\, u_{K(F)}\n$$\nThe boundary-face terms vanish under the standard treatment of homogeneous Dirichlet boundary conditions in variational methods. The trial functions $u_h$ and test functions $v_h$ must belong to a discrete space that satisfies these conditions. For a cell-based FVM, this translates to requiring $w_K=0$ if the cell $K$ is \"on the boundary\" (e.g., its cell center lies on $\\partial\\Omega$ or is adjacent to it, depending on the scheme's details). If the test functions $v_h$ are chosen from such a space, then $v_K=0$ for all boundary-adjacent cells, causing the boundary term $\\sum v_{K(F)} T_F u_{K(F)}$ to be identically zero.\n\n### Task 2: Comparison with FEM and FDM\n\nThe bilinear form for the standard conforming Galerkin Finite Element Method (FEM) is:\n$$\na^{\\mathrm{FEM}}(u_{h},v_{h}) := \\int_{\\Omega} \\kappa \\, \\nabla u_{h} \\cdot \\nabla v_{h} \\, \\mathrm{d}x\n$$\nWe can express this as a sum of integrals over the elements (simplices) $K$ of the mesh $\\mathcal{T}_h$:\n$$\na^{\\mathrm{FEM}}(u_{h},v_{h}) = \\sum_{K \\in \\mathcal{T}_h} \\int_{K} \\kappa \\, \\nabla u_{h} \\cdot \\nabla v_{h} \\, \\mathrm{d}x\n$$\nFor $P^1$ (piecewise affine) elements, the gradient of a trial/test function, $\\nabla u_h$ or $\\nabla v_h$, is a constant vector on each element $K$. Thus, we can write:\n$$\na^{\\mathrm{FEM}}(u_{h},v_{h}) = \\sum_{K \\in \\mathcal{T}_h} (\\nabla u_{h}|_K \\cdot \\nabla v_{h}|_K) \\int_{K} \\kappa \\, \\mathrm{d}x\n$$\nThis is a sum over elements. To obtain a sum over faces that resembles the FVM form, let's consider the one-dimensional case for clarity, on a uniform grid $x_i=ih$. The elements are intervals $K_i = [x_i, x_{i+1}]$. On such an interval, $u_h(x)$ is affine, and its derivative is constant: $u_h'(x) = \\frac{u_{i+1} - u_i}{h}$. The bilinear form becomes:\n$$\na^{\\mathrm{FEM}}(u_{h},v_{h}) = \\sum_{i=0}^{N-1} \\int_{x_i}^{x_{i+1}} \\kappa(x) \\left(\\frac{u_{i+1}-u_i}{h}\\right) \\left(\\frac{v_{i+1}-v_i}{h}\\right) \\mathrm{d}x\n$$\n$$\na^{\\mathrm{FEM}}(u_{h},v_{h}) = \\sum_{i=0}^{N-1} \\left( \\frac{1}{h} \\int_{x_i}^{x_{i+1}} \\kappa(x) \\, \\mathrm{d}x \\right) \\frac{(u_{i+1}-u_i)(v_{i+1}-v_i)}{h}\n$$\nThis expression is now an \"exact sum over faces\", where the 'face' is interpreted as the connection between nodes $i$ and $i+1$. It has the same algebraic structure as the FVM discrete Green's identity derived in Task 1, $a_h(u,v) = \\sum T_F [u]_F [v]_F$. In this 1D context, the 'jump' $[u]_F$ corresponds to the difference $(u_{i+1}-u_i)$ (or its negative, which does not matter due to the product), and the transmissibility $T_F$ for the face connecting $i$ and $i+1$ implicitly defined by the FEM formulation is:\n$$\nT_{i,i+1}^{\\mathrm{FEM}} = \\frac{1}{h^2} \\int_{x_i}^{x_{i+1}} \\kappa(x) \\, \\mathrm{d}x\n$$\nThe FVM formulation's transmissibility, on the other hand, is defined by an algebraic approximation, such as $T_F = \\frac{\\kappa(x_F)}{A_F}$ where $x_F$ is a point on the face and $A_F$ is a geometric factor. For the 1D case shown in Task 3, $T_{i+1/2} = \\kappa(x_{i+1/2})/h$. The algebraic coincidence between FVM and FEM occurs if the FVM transmissibility is chosen to match the FEM one, i.e., $T_F$ is based on the integral average of $\\kappa$ over the corresponding element.\n\nIn one dimension on a uniform grid, the central-difference Finite Difference Method (FDM) scheme for $-(\\kappa u')' = f$ at node $x_i$ is $-\\frac{1}{h} [ \\kappa_{i+1/2}\\frac{u_{i+1}-u_i}{h} - \\kappa_{i-1/2}\\frac{u_i-u_{i-1}}{h} ] = f_i$. This is identical to the vertex-centered FVM derived from conservation on control volumes $[x_{i-1/2}, x_{i+1/2}]$. The contrast is that FEM naturally uses an integral average of $\\kappa$ (making it exact for the element-wise average), while FDM/FVM typically uses point values (e.g., at midpoints). The methods coincide if the point value equals the average value, which is true, for instance, if $\\kappa(x)$ is constant or affine on the element.\n\n### Task 3: Computation of the Difference $D(h)$\n\nWe need to compute $D(h) := a_{h}^{\\mathrm{FVM}}(u_{h},v_{h}) - a^{\\mathrm{FEM}}(u_{h},v_{h})$, where $u_h = v_h = I_h(x(1-x))$ and $\\kappa(x) = \\kappa_0 + \\alpha x$. The grid is uniform with step size $h=1/N$.\n\nFirst, we establish the nodal values $u_i$. Since $u_h$ is the nodal interpolant of $u(x)=x(1-x)$, the values at the nodes are simply $u_i = u(x_i)$.\n$$\nu_i = x_i(1-x_i) = (ih)(1-ih) = ih - i^2h^2\n$$\nThe boundary conditions $u_0=0$ and $u_N=0$ are satisfied. We need the difference between adjacent nodal values:\n$$\nu_{i+1} - u_i = \\left((i+1)h - (i+1)^2h^2\\right) - (ih - i^2h^2) \\\\\n= h - h^2((i+1)^2 - i^2) \\\\\n= h - h^2(2i+1)\n$$\nSince $u_h=v_h$, we will compute $a(u_h, u_h)$ for each method.\n\n**1. FVM Bilinear Form Calculation**\nThe problem defines the FVM bilinear form as:\n$$\na_{h}^{\\mathrm{FVM}}(u_{h},u_{h}) = \\sum_{i=0}^{N-1} \\kappa(x_{i+1/2}) \\, \\frac{(u_{i+1} - u_{i})^2}{h}\n$$\nHere, $x_{i+1/2} = x_i + h/2 = (i+1/2)h$. Substituting $\\kappa(x) = \\kappa_0 + \\alpha x$:\n$$\n\\kappa(x_{i+1/2}) = \\kappa_0 + \\alpha (i+1/2)h\n$$\nAnd substituting the expression for $(u_{i+1}-u_i)$:\n$$\na_{h}^{\\mathrm{FVM}}(u_{h},u_{h}) = \\sum_{i=0}^{N-1} (\\kappa_0 + \\alpha (i+1/2)h) \\, \\frac{(h - h^2(2i+1))^2}{h}\n$$\n\n**2. FEM Bilinear Form Calculation**\nThe FEM bilinear form with exact quadrature is:\n$$\na^{\\mathrm{FEM}}(u_{h},u_{h}) = \\int_{0}^{1} \\kappa(x) (u_h'(x))^2 \\, \\mathrm{d}x = \\sum_{i=0}^{N-1} \\int_{x_i}^{x_{i+1}} \\kappa(x) (u_h'(x))^2 \\, \\mathrm{d}x\n$$\nOn the interval $[x_i, x_{i+1}]$, $u_h(x)$ is affine, so its derivative is constant:\n$$\nu_h'(x) = \\frac{u_{i+1}-u_i}{h} = \\frac{h - h^2(2i+1)}{h} = 1 - h(2i+1)\n$$\nSo, we can take the derivative squared outside the integral for each element:\n$$\na^{\\mathrm{FEM}}(u_{h},u_{h}) = \\sum_{i=0}^{N-1} \\left(\\frac{u_{i+1}-u_i}{h}\\right)^2 \\int_{x_i}^{x_{i+1}} \\kappa(x) \\, \\mathrm{d}x\n$$\nWe compute the integral of the affine function $\\kappa(x)$:\n$$\n\\int_{x_i}^{x_{i+1}} (\\kappa_0 + \\alpha x) \\, \\mathrm{d}x = \\left[ \\kappa_0 x + \\frac{\\alpha}{2} x^2 \\right]_{ih}^{(i+1)h} \\\\\n= \\kappa_0 ((i+1)h - ih) + \\frac{\\alpha}{2} (((i+1)h)^2 - (ih)^2) \\\\\n= \\kappa_0 h + \\frac{\\alpha h^2}{2} ((i+1)^2 - i^2) \\\\\n= \\kappa_0 h + \\frac{\\alpha h^2}{2} (2i+1) \\\\\n= h (\\kappa_0 + \\alpha h(i+1/2)) = h \\, \\kappa(x_{i+1/2})\n$$\nThis result demonstrates that for an affine function, its integral over an interval is exactly the interval length times the function value at the midpoint (midpoint quadrature rule is exact for affine functions).\nSubstituting this back into the expression for $a^{\\mathrm{FEM}}$:\n$$\na^{\\mathrm{FEM}}(u_{h},u_{h}) = \\sum_{i=0}^{N-1} \\frac{(u_{i+1}-u_i)^2}{h^2} \\left( h \\, \\kappa(x_{i+1/2}) \\right) \\\\\n= \\sum_{i=0}^{N-1} \\kappa(x_{i+1/2}) \\, \\frac{(u_{i+1}-u_i)^2}{h}\n$$\nThis expression is identical to the one defined for $a_{h}^{\\mathrm{FVM}}(u_{h},u_{h})$.\n\n**3. The Difference $D(h)$**\nSince the expressions for $a_{h}^{\\mathrm{FVM}}(u_{h},u_{h})$ and $a^{\\mathrm{FEM}}(u_{h},u_{h})$ are identical under the given conditions, their difference is zero.\n$$\nD(h) = a_{h}^{\\mathrm{FVM}}(u_{h},v_{h}) - a^{\\mathrm{FEM}}(u_{h},v_{h}) = 0\n$$\nThis specific scenario (uniform 1D grid, P1 FEM vs. vertex-centered FVM, linear $\\kappa$) is a case where the two methods are equivalent.",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "Having established the foundational links between the methods, we now turn to the practical considerations of achieving higher accuracy. This practice moves beyond the basic schemes to compare the computational costs of a higher-order FVM with a standard quadratic ($P_2$) FEM . By methodically counting the degrees of freedom and determining the necessary quadrature rules for each approach, you will gain quantitative insight into their efficiency and implementation complexity, which are crucial factors in selecting a method for a given application.",
            "id": "3372466",
            "problem": "Consider the scalar diffusion equation $-\\nabla\\cdot(k\\nabla u)=f$ on the unit square domain, discretized on a uniform Cartesian mesh of $M\\times M$ congruent square control volumes of side length $h=\\frac{1}{M}$. Assume $k(x,y)$ is a polynomial of total degree at most $1$ (i.e., affine) and $f$ is smooth. You will design a third-order Finite Volume Method (FVM) based on per-cell quadratic reconstruction and face quadrature, and compare its degrees of freedom and quadrature requirements to those of a standard quadratic Lagrange Finite Element Method (FEM) (denoted $P_2$ FEM). Finite Difference Method (FDM) is mentioned for high-level context but is not to be used in any calculation in this problem.\n\nUse the following fundamental definitions and modeling assumptions:\n- In the Finite Volume Method, one stores a single unknown per control volume representing the cell average of $u$ and computes normal diffusive fluxes by integrating $k\\nabla u\\cdot n$ over each face. A third-order accurate reconstruction for $u$ per cell uses a quadratic polynomial, so that $\\nabla u$ is linear in space.\n- To guarantee third-order accuracy in the FVM flux integral over a face segment, the one-dimensional face quadrature must be exact for polynomials up to the degree of the exact integrand induced by the reconstruction and the coefficient $k$. For one-dimensional Gaussâ€“Legendre quadrature with $n$ points, exactness holds for all polynomials up to degree $2n-1$.\n- In the $P_2$ FEM on a conforming triangulation, one uses continuous piecewise-quadratic basis functions on triangles. On each square of the Cartesian mesh, use a consistent diagonal to subdivide the square into two triangles. The number of global $P_2$ degrees of freedom equals the number of unique vertices plus the number of unique edges in the triangulation. The stiffness integral on each triangle involves integrands of the form $k\\,(\\nabla\\varphi_i\\cdot\\nabla\\varphi_j)$, where $\\varphi_i$ and $\\varphi_j$ are $P_2$ basis functions. For affine $k$, and since $\\nabla\\varphi_i$ and $\\nabla\\varphi_j$ are linear polynomials on each triangle, the integrand is a polynomial of total degree $3$. A minimal-degree-exact quadrature rule on triangles that is exact for all polynomials up to degree $3$ requires $4$ points.\n\nTasks:\n- Derive the global number of FVM degrees of freedom and the global number of $P_2$ FEM degrees of freedom on the above mesh, as functions of $M$.\n- Determine the minimal number of one-dimensional quadrature points per face required in the FVM to exactly integrate the face flux integrand induced by quadratic reconstruction and affine $k$, and compute the resulting total number of face quadrature points per square.\n- Determine the minimal number of triangular quadrature points per triangle required in the $P_2$ FEM to exactly integrate the stiffness integrands with affine $k$, and compute the resulting total number of element quadrature points per square.\n- Let $R_{\\mathrm{dof}}(M)$ be the ratio of the global $P_2$ FEM degrees of freedom to the global FVM degrees of freedom. Let $R_{\\mathrm{quad}}$ be the ratio of the total number of quadrature points per square required by the $P_2$ FEM stiffness integration to that required by the FVM face-flux integration. Define the composite ratio $S(M)=R_{\\mathrm{dof}}(M)\\,R_{\\mathrm{quad}}$.\n\nCompute $S(M)$ as a single simplified analytic expression in terms of $M$. Do not include any units. Do not use the Finite Difference Method in any intermediate calculation. Your final answer must be a single closed-form analytic expression.",
            "solution": "The objective is to compute the composite ratio $S(M) = R_{\\mathrm{dof}}(M) R_{\\mathrm{quad}}$, where $R_{\\mathrm{dof}}(M)$ is the ratio of global degrees of freedom (DoFs) for a $P_2$ Finite Element Method (FEM) to a third-order Finite Volume Method (FVM), and $R_{\\mathrm{quad}}$ is the ratio of the total quadrature points per square cell for the two methods. The analysis is performed on a uniform Cartesian mesh of $M \\times M$ squares over the unit domain.\n\nFirst, we determine the number of global degrees of freedom for each method.\n\n**1. Finite Volume Method Degrees of Freedom ($N_{\\mathrm{FVM}}$)**\nAccording to the problem statement, the FVM scheme stores a single unknown per control volume, which represents the cell average of the solution $u$. The domain is discretized into an $M \\times M$ grid of control volumes. Therefore, the total number of degrees of freedom for the FVM is equal to the number of control volumes.\n$$N_{\\mathrm{FVM}} = M \\times M = M^2$$\n\n**2. Finite Element Method Degrees of Freedom ($N_{\\mathrm{FEM}}$)**\nThe method specified is a $P_2$ Lagrange FEM on a conforming triangulation. The triangulation is formed by subdividing each of the $M^2$ squares of the Cartesian mesh with a consistent diagonal. The degrees of freedom for $P_2$ elements are located at the vertices and the midpoints of the edges of each triangular element. The problem states that the number of global DoFs is the sum of the number of unique vertices and unique edges in the triangulation. This is equivalent to counting the total number of unique nodes (vertices and edge midpoints) in the mesh.\n\nLet's count these nodes:\n- **Vertices**: The vertices of the triangulation are the vertices of the underlying $M \\times M$ square grid. A grid of $M \\times M$ squares has $(M+1)$ lines in each direction, hence the number of unique vertices is:\n  $$N_{\\mathrm{vertices}} = (M+1) \\times (M+1) = (M+1)^2$$\n- **Edges and their Midpoints**: The edges of the triangulation consist of the horizontal and vertical edges of the square grid, plus the diagonals introduced to form the triangles.\n  - Number of horizontal edges: There are $(M+1)$ horizontal grid lines, each containing $M$ segments. Total: $M(M+1)$.\n  - Number of vertical edges: There are $(M+1)$ vertical grid lines, each containing $M$ segments. Total: $M(M+1)$.\n  - Number of diagonal edges: Each of the $M^2$ squares is divided by one diagonal. Total: $M^2$.\n  The total number of unique edges in the triangulation is the sum of these counts:\n  $$N_{\\mathrm{edges}} = M(M+1) + M(M+1) + M^2 = 2M^2 + 2M + M^2 = 3M^2 + 2M$$\n- **Total DoFs**: The total number of $P_2$ FEM degrees of freedom is the total number of unique nodes, which is the sum of the number of unique vertices and the number of unique edge midpoints (which equals the number of unique edges).\n  $$N_{\\mathrm{FEM}} = N_{\\mathrm{vertices}} + N_{\\mathrm{edges}} = (M+1)^2 + (3M^2 + 2M)$$\n  $$N_{\\mathrm{FEM}} = (M^2 + 2M + 1) + (3M^2 + 2M) = 4M^2 + 4M + 1$$\n  This expression can be factored as:\n  $$N_{\\mathrm{FEM}} = (2M+1)^2$$\n\nNext, we determine the number of quadrature points required per square cell for each method.\n\n**3. Finite Volume Method Quadrature Points ($Q_{\\mathrm{FVM}}$)**\nThe FVM flux is computed by integrating $k \\nabla u \\cdot n$ over each of the $4$ faces of a square control volume.\n- The coefficient $k$ is an affine polynomial (total degree $1$).\n- The solution $u$ is reconstructed as a quadratic polynomial (degree $2$) within each cell.\n- The gradient, $\\nabla u$, is therefore a vector of linear polynomials (degree $1$).\n- The integrand on a face is the product of $k$ and a component of $\\nabla u$. When restricted to a one-dimensional face (e.g., a line segment where $x$ is constant and $y$ varies), both $k$ and the relevant component of $\\nabla u$ are linear functions of the integration variable.\n- The product of two linear polynomials is a quadratic polynomial (degree $2$).\n- The problem states that an $n$-point one-dimensional Gauss-Legendre quadrature rule is exact for polynomials of degree up to $2n-1$. To be exact for a degree-$2$ polynomial, we require $2n-1 \\ge 2$, which implies $2n \\ge 3$, or $n \\ge 1.5$. The minimal integer number of points is thus $n=2$.\n- Each square control volume has $4$ faces. The total number of quadrature points per square is:\n  $$Q_{\\mathrm{FVM}} = 4 \\text{ faces/square} \\times 2 \\text{ points/face} = 8 \\text{ points/square}$$\n\n**4. Finite Element Method Quadrature Points ($Q_{\\mathrm{FEM}}$)**\nThe FEM stiffness matrix entries are computed by integrating $k \\,(\\nabla\\varphi_i \\cdot \\nabla\\varphi_j)$ over each triangular element, where $\\varphi_i$ and $\\varphi_j$ are $P_2$ basis functions.\n- The basis functions $\\varphi_i, \\varphi_j$ are quadratic polynomials (degree $2$) on each triangle.\n- Their gradients, $\\nabla\\varphi_i, \\nabla\\varphi_j$, are vectors of linear polynomials (degree $1$).\n- The dot product $\\nabla\\varphi_i \\cdot \\nabla\\varphi_j$ is a polynomial of total degree up to $1+1=2$.\n- The coefficient $k$ is an affine polynomial (degree $1$).\n- The integrand, $k \\,(\\nabla\\varphi_i \\cdot \\nabla\\varphi_j)$, is the product of a degree-$1$ polynomial and a degree-$2$ polynomial, resulting in a polynomial of total degree up to $1+2=3$.\n- The problem states that a minimal quadrature rule on a triangle that is exact for polynomials of degree $3$ requires $4$ points.\n- Each square cell is subdivided into $2$ triangles. The total number of quadrature points per square is:\n  $$Q_{\\mathrm{FEM}} = 2 \\text{ triangles/square} \\times 4 \\text{ points/triangle} = 8 \\text{ points/square}$$\n\nFinally, we compute the required ratios and the composite expression $S(M)$.\n\n**5. Ratios and the Composite Expression $S(M)$**\nThe ratio of degrees of freedom is:\n$$R_{\\mathrm{dof}}(M) = \\frac{N_{\\mathrm{FEM}}}{N_{\\mathrm{FVM}}} = \\frac{(2M+1)^2}{M^2} = \\left(\\frac{2M+1}{M}\\right)^2 = \\left(2 + \\frac{1}{M}\\right)^2$$\nThe ratio of quadrature points per square is:\n$$R_{\\mathrm{quad}} = \\frac{Q_{\\mathrm{FEM}}}{Q_{\\mathrm{FVM}}} = \\frac{8}{8} = 1$$\nThe composite ratio $S(M)$ is the product of these two ratios:\n$$S(M) = R_{\\mathrm{dof}}(M) \\cdot R_{\\mathrm{quad}} = \\left(2 + \\frac{1}{M}\\right)^2 \\cdot 1 = \\left(2 + \\frac{1}{M}\\right)^2$$\n\nThis is the final simplified analytic expression for $S(M)$.",
            "answer": "$$\\boxed{\\left(2 + \\frac{1}{M}\\right)^2}$$"
        },
        {
            "introduction": "Our final practice investigates a scenario where the fundamental differences between the methods become critically important: discretization on non-orthogonal, distorted meshes. While conforming FEM formulations maintain their core properties regardless of mesh geometry, simpler FVM schemes can suffer from a loss of consistency. This exercise  challenges you to quantify this \"consistency error\" for a two-point flux FVM on a distorted quadrilateral, revealing why the Galerkin FEM approach naturally preserves key operator properties and highlighting the crucial role of geometric fidelity.",
            "id": "3372497",
            "problem": "Consider the steady diffusion equation with isotropic diffusivity,\n$$-\\nabla \\cdot \\left( k \\nabla u \\right) = 0 \\quad \\text{in } \\Omega,$$\nwith constant $k=1$. Let the computational mesh consist of two adjacent, distorted convex quadrilateral control volumes that share a common internal face. The left control volume has vertices\n$$(0,0), \\ (1,0.1), \\ (1,1.1), \\ (0,1),$$\nand the right control volume has vertices\n$$(1,0.1), \\ (2,0.4), \\ (2,1.2), \\ (1,1.1).$$\nAssume the primary unknown of the Finite Volume Method (FVM) is located at each control-volume center, defined here as the arithmetic mean of its four vertex coordinates. The shared internal face is the straight segment connecting $(1,0.1)$ to $(1,1.1)$, with outward unit normal from the left volume to the right volume given by $\\boldsymbol{n}=(1,0)$ and face length $|\\Gamma|=1$.\n\nLet the exact scalar field be linear,\n$$u(x,y) = 2x - y,$$\nso that the exact gradient is constant. Compare the flux across the shared internal face computed by:\n- The two-point flux approximation of the Finite Volume Method (FVM-TPFA), which takes the face-normal discrete gradient as the difference of the neighboring cell-center values projected onto the face normal and divided by the normal distance between cell centers;\n- The flux obtained by projecting the $P_1$ Finite Element Method (FEM) gradient, understood here as integrating the exact linear gradient over the face, i.e., $\\displaystyle -\\int_{\\Gamma} \\nabla u \\cdot \\boldsymbol{n} \\, \\mathrm{d}s$, which the $P_1$ FEM reproduces exactly for linear fields.\n\n1. Compute the difference\n$$\\Delta F \\equiv F_{\\text{TPFA}} - F_{\\text{FEM}},$$\nusing the geometric data above and $k=1$. Express your final answer exactly as a single simplified fraction.\n\n2. Starting from the definitions of the Galerkin bilinear form and the FVM two-point flux assembly, analyze which approach among the Finite Volume Method (FVM-TPFA), the Finite Difference Method (FDM), and the Finite Element Method (FEM) preserves symmetry and positive definiteness of the discrete operator on such distorted meshes, and explain why. Your analysis must trace back to the underlying variational form (for FEM) and to the transmissibility construction (for FVM-TPFA), and should comment on the role of orthogonality for FDM on structured grids.\n\nYour final answer must be only the exact value of $\\Delta F$ with no units and no rounding.",
            "solution": "We start from the diffusion flux law and the weak form that underlie the discretizations.\n\nThe physical diffusive flux density for constant $k=1$ is\n$$\\boldsymbol{q} = -\\nabla u.$$\nFor a face $\\Gamma$ with unit normal $\\boldsymbol{n}$, the continuous face flux is\n$$F = \\int_{\\Gamma} \\boldsymbol{q} \\cdot \\boldsymbol{n} \\, \\mathrm{d}s = -\\int_{\\Gamma} \\nabla u \\cdot \\boldsymbol{n} \\, \\mathrm{d}s.$$\n\nFor the $P_1$ Finite Element Method (FEM), the Galerkin bilinear form is\n$$a(u,v) = \\int_{\\Omega} \\nabla u \\cdot \\nabla v \\, \\mathrm{d}x,$$\nwhich is symmetric and coercive on $H_0^1(\\Omega)$ for constant positive $k$. When the exact solution $u$ is linear, the $P_1$ FEM shape functions reproduce $\\nabla u$ exactly on each triangle in a triangulation of the quadrilateral mesh (e.g., by splitting each quadrilateral into two triangles), so the face flux obtained by projecting the $P_1$ gradient on $\\Gamma$ equals the exact face flux.\n\nWe now compute the two target fluxes on the specific mesh.\n\n1. Geometry and exact gradient.\n\nThe face $\\Gamma$ connects $(1,0.1)$ to $(1,1.1)$, hence it is vertical, has length $|\\Gamma|=1$, and its unit normal from left to right is $\\boldsymbol{n}=(1,0)$. The exact field is\n$$u(x,y) = 2x - y,$$\nso\n$$\\nabla u = \\begin{pmatrix} 2 \\\\ -1 \\end{pmatrix}.$$\n\nTherefore, the exact face-normal flux (and thus the $P_1$ FEM face flux) is\n$$F_{\\text{FEM}} \\equiv -\\int_{\\Gamma} \\nabla u \\cdot \\boldsymbol{n} \\, \\mathrm{d}s = -\\left( \\nabla u \\cdot \\boldsymbol{n} \\right) |\\Gamma| = -\\left( 2 \\right)\\cdot 1 = -2.$$\n\n2. Finite Volume Method two-point flux across $\\Gamma$.\n\nWe define the control-volume centers as the arithmetic mean of the vertex coordinates.\n\nLeft control volume vertices are $(0,0)$, $(1,0.1)$, $(1,1.1)$, $(0,1)$, hence the left center is\n$$\\boldsymbol{x}_L = \\left( \\frac{0+1+1+0}{4}, \\frac{0+0.1+1.1+1}{4} \\right) = \\left( \\frac{2}{4}, \\frac{2.2}{4} \\right) = \\left( 0.5, \\, 0.55 \\right).$$\n\nRight control volume vertices are $(1,0.1)$, $(2,0.4)$, $(2,1.2)$, $(1,1.1)$, hence the right center is\n$$\\boldsymbol{x}_R = \\left( \\frac{1+2+2+1}{4}, \\frac{0.1+0.4+1.2+1.1}{4} \\right) = \\left( \\frac{6}{4}, \\frac{2.8}{4} \\right) = \\left( 1.5, \\, 0.7 \\right).$$\n\nThe normal distance used by the two-point flux approximation (TPFA) is the projection of the center-to-center vector onto the face normal:\n$$d_n = \\left( \\boldsymbol{x}_R - \\boldsymbol{x}_L \\right) \\cdot \\boldsymbol{n} = \\left( (1.5-0.5), \\, (0.7-0.55) \\right) \\cdot (1,0) = 1.$$\n\nThe cell-centered unknowns are located at $\\boldsymbol{x}_L$ and $\\boldsymbol{x}_R$, so we evaluate $u$ there:\n$$u_L = u(\\boldsymbol{x}_L) = 2 \\cdot 0.5 - 0.55 = 1 - 0.55 = \\frac{9}{20},$$\n$$u_R = u(\\boldsymbol{x}_R) = 2 \\cdot 1.5 - 0.7 = 3 - 0.7 = \\frac{23}{10}.$$\n\nThus the jump in cell-centered values is\n$$u_R - u_L = \\frac{23}{10} - \\frac{9}{20} = \\frac{46 - 9}{20} = \\frac{37}{20}.$$\n\nWith $k=1$ and face length $|\\Gamma|=1$, the TPFA face flux from left to right is\n$$F_{\\text{TPFA}} = - \\frac{u_R - u_L}{d_n} \\, |\\Gamma| = - \\frac{ \\frac{37}{20} }{1} \\cdot 1 = -\\frac{37}{20}.$$\n\n3. Flux difference.\n\nThe requested difference is\n$$\\Delta F \\equiv F_{\\text{TPFA}} - F_{\\text{FEM}} = \\left( -\\frac{37}{20} \\right) - \\left( -2 \\right) = -\\frac{37}{20} + \\frac{40}{20} = \\frac{3}{20}.$$\n\nThis nonzero value arises from the non-orthogonality: the center-to-center vector has a tangential component relative to the face, so the two-point difference $u_R - u_L$ includes tangential variation of $u$ (here proportional to $-1$ times the tangential offset $\\frac{3}{20}$), which is not part of the true normal derivative.\n\n4. Symmetry and positive definiteness analysis for FVM-TPFA, FDM, and FEM.\n\n- Finite Element Method (FEM): The conforming $P_1$ Galerkin method assembles the stiffness matrix $\\boldsymbol{K}$ from the bilinear form\n$$a(u,v) = \\int_{\\Omega} k \\nabla u \\cdot \\nabla v \\, \\mathrm{d}x.$$\nFor constant $k>0$, $a(\\cdot,\\cdot)$ is symmetric and coercive on $H_0^1(\\Omega)$, implying that the assembled discrete operator is symmetric positive definite for Dirichlet boundary conditions, independent of mesh distortion. Moreover, for linear $u$, $P_1$ FEM is exact on each element, as used above.\n\n- Finite Volume Method two-point flux (FVM-TPFA): The TPFA constructs, for each internal face between cells $i$ and $j$, a flux of the form\n$$F_{ij} = -T_{ij} \\left( u_j - u_i \\right),$$\nwith transmissibility $T_{ij} = T_{ji} > 0$ depending on face area, diffusivity, and the normal distance $d_n$. Assembled over the mesh, the resulting matrix has off-diagonal entries $-T_{ij} \\le 0$ and diagonal entries $\\sum_{j} T_{ij} > 0$, yielding a symmetric $M$-matrix. Hence, when TPFA is applied as defined (without non-orthogonal correction terms), the discrete operator is symmetric positive definite provided the mesh connectivity is such that $T_{ij}>0$. However, on distorted non-orthogonal meshes, TPFA is generally inconsistent with the continuous operator (as evidenced by the nonzero $\\Delta F$ above). Remedies that restore consistency (e.g., adding non-orthogonal corrections depending on tangential gradients) typically introduce non-symmetric couplings and can jeopardize symmetry and, in some cases, positive definiteness.\n\n- Finite Difference Method (FDM): On structured, orthogonal grids with central differences for $-\\Delta u$, the discrete operator is symmetric positive definite (a symmetric $M$-matrix) under Dirichlet boundary conditions. On distorted quadrilateral meshes that are not derived from an orthogonal structured grid (e.g., arbitrary convex quadrilaterals), naive finite differences do not apply directly; coordinate-transform-based discretizations or mimetic/finite-volume-like formulations are needed. Without careful construction to mirror the symmetric variational form, symmetry can be lost on distorted meshes.\n\nConclusion: The conforming $P_1$ FEM preserves symmetry and positive definiteness regardless of the mesh distortion. The FVM-TPFA, as a pure two-point scheme, preserves symmetry and positive definiteness but is not consistent on non-orthogonal meshes, leading to a flux error $\\Delta F = \\frac{3}{20}$ in this example; consistency-restoring corrections generally break symmetry. Classical central-difference FDM preserves symmetry and positive definiteness on orthogonal structured grids, but its extension to distorted quadrilateral meshes requires special care to retain these properties.",
            "answer": "$$\\boxed{\\frac{3}{20}}$$"
        }
    ]
}