{
    "hands_on_practices": [
        {
            "introduction": "这个基础练习是理解界面传导模型的基石。我们将从基本的傅里叶定律和连续性原理出发，在有限体积法的框架下，推导跨越两种不同材料界面的热通量的正确表达式。通过这个推导过程，你将亲眼见证加权谐波平均作为等效电导率的表示方式是如何从第一性原理中自然产生的。",
            "id": "3409996",
            "problem": "考虑一个沿x轴的一维空间中的标量温度场 $u(x)$ 的稳态热传导，该过程遵循傅里叶定律，并建立在由矩形控制体组成的笛卡尔有限体积网格上。两个相邻单元，分别表示为 $W$ (西) 和 $E$ (东)，在位置 $x=x_{f}$ 处共享一个内部垂直面。设单元中心位于 $x=x_{W}$ 和 $x=x_{E}$，距离面的距离分别为 $d_{W}=x_{f}-x_{W}$ 和 $d_{E}=x_{E}-x_{f}$。假设热导率为各向同性，且在每个单元内为分段常数，在单元 $W$ 内等于 $k_{W}$，在单元 $E$ 内等于 $k_{E}$。穿过共享面的法向热通量密度 $q_{f}$ 定义为从 $W$ 到 $E$ 的方向为正。\n\n仅从傅里叶定律 $q=-k\\,\\partial u/\\partial x$ 和内部界面上法向热通量的连续性出发，推导一个用 $u_{W}$、$u_{E}$、$d_{W}$、$d_{E}$、$k_{W}$ 和 $k_{E}$ 表示的 $q_{f}$ 的协调离散表达式，并证明为什么得到的界面热导率是以到单元中心的距离 $d_{W}$ 和 $d_{E}$ 为几何权重的调和平均值。\n\n然后，使用以下数据计算 $q_{f}$：\n- 单元宽度 $\\Delta x_{W}=0.6\\,\\mathrm{m}$ 和 $\\Delta x_{E}=0.2\\,\\mathrm{m}$，因此 $d_{W}=\\Delta x_{W}/2$ 和 $d_{E}=\\Delta x_{E}/2$。\n- 热导率 $k_{W}=2.5\\,\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$ 和 $k_{E}=15\\,\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$。\n- 单元中心温度 $u_{W}=400\\,\\mathrm{K}$ 和 $u_{E}=300\\,\\mathrm{K}$。\n\n将 $q_{f}$ 的最终数值四舍五入到四位有效数字。以 $\\mathrm{W}\\,\\mathrm{m}^{-2}$ 为单位表示通量密度。",
            "solution": "问题陈述已经过验证，被认为是合理的。它科学地基于热传导的傅里叶定律，这是物理学和工程学中的一个基本原理。该问题是适定的，提供了推导界面热通量的唯一且有意义的解所需的所有必要定义、常数和边界条件。其语言客观精确，提供的数值在物理上是一致和合理的。因此，将提供一个解答。\n\n主要目标是推导穿过两个相邻控制体 $W$ 和 $E$ 共享的面的法向热通量密度 $q_{f}$ 的离散表达式。推导从一维稳态热传导的傅里叶定律开始：\n$$\nq = -k \\frac{du}{dx}\n$$\n其中 $q$ 是热通量密度，$k$ 是热导率，$u$ 是温度。对于无源介质中的稳态传导，热通量 $q$ 在整个区域内必须是恒定的。设从单元 $W$ 到单元 $E$ 的这个恒定通量表示为 $q_{f}$。\n\n有限体积法将区域离散化，并假设在每个单元内热导率为分段常数。为了求得界面 $x=x_{f}$ 处的通量，我们在与该面相邻的两个半单元上对傅里叶定律进行积分。关键的物理假设是界面处的温度连续性和法向热通量连续性。设界面 $x_f$ 处的温度为 $u_f$。\n\n首先，我们考虑单元中心 $x_W$ 和界面 $x_f$ 之间的区域。在此区域内，热导率为常数 $k=k_W$。我们可以重新排列傅里叶定律并从 $x_W$ 积分到 $x_f$：\n$$\n\\int_{u(x_W)}^{u(x_f)} du = \\int_{x_W}^{x_f} -\\frac{q}{k} dx\n$$\n由于在此区间内 $q=q_f$ (常数) 和 $k=k_W$ (常数)，我们有：\n$$\nu(x_f) - u(x_W) = -\\frac{q_f}{k_W} (x_f - x_W)\n$$\n使用给定的符号，$u_f = u(x_f)$，$u_W = u(x_W)$ 和 $d_W = x_f - x_W$，上式变为：\n$$\nu_f - u_W = -\\frac{q_f d_W}{k_W}\n$$\n这个方程可以重新整理，用单元中心温度 $u_W$ 和通量 $q_f$ 来表示界面温度 $u_f$：\n$$\nu_f = u_W - \\frac{q_f d_W}{k_W}\n$$\n接下来，我们对界面 $x_f$ 和单元中心 $x_E$ 之间的区域执行相同的过程。在此区域内，热导率为常数 $k=k_E$。从 $x_f$ 到 $x_E$ 积分傅里叶定律：\n$$\n\\int_{u(x_f)}^{u(x_E)} du = \\int_{x_f}^{x_E} -\\frac{q}{k} dx\n$$\n当 $q=q_f$ 和 $k=k_E$ 时，积分得到：\n$$\nu(x_E) - u(x_f) = -\\frac{q_f}{k_E} (x_E - x_f)\n$$\n使用符号 $u_E = u(x_E)$ 和 $d_E = x_E - x_f$：\n$$\nu_E - u_f = -\\frac{q_f d_E}{k_E}\n$$\n这为界面温度 $u_f$ 提供了第二个表达式：\n$$\nu_f = u_E + \\frac{q_f d_E}{k_E}\n$$\n现在，我们通过令 $u_f$ 的两个表达式相等来施加界面处的温度连续性条件。这从系统中消除了未知的界面温度。\n$$\nu_W - \\frac{q_f d_W}{k_W} = u_E + \\frac{q_f d_E}{k_E}\n$$\n我们现在可以求解热通量 $q_f$。重新整理各项以合并 $q_f$：\n$$\nu_W - u_E = q_f \\left( \\frac{d_W}{k_W} + \\frac{d_E}{k_E} \\right)\n$$\n最后，面上热通量密度的离散表达式为：\n$$\nq_f = \\frac{u_W - u_E}{\\frac{d_W}{k_W} + \\frac{d_E}{k_E}}\n$$\n这个表达式是协调的，因为如果 $u_W > u_E$，通量 $q_f$ 为正，对应于问题中定义的从 $W$ 到 $E$ 的热流。\n\n为了证明这个公式为什么涉及调和平均，我们可以将我们的结果与傅里叶定律的标准有限差分近似 $q_f = -k_f \\frac{u_E - u_W}{d_W + d_E}$ 进行比较，其中 $k_f$ 是等效界面热导率。\n通过重写我们推导的 $q_f$ 表达式：\n$$\nq_f = - \\frac{u_E - u_W}{\\frac{d_W}{k_W} + \\frac{d_E}{k_E}}\n$$\n比较 $q_f$ 的两种形式，我们可以令温差项 $-(u_E-u_W)$ 的系数相等：\n$$\n\\frac{k_f}{d_W + d_E} = \\frac{1}{\\frac{d_W}{k_W} + \\frac{d_E}{k_E}}\n$$\n求解 $k_f$ 得到：\n$$\nk_f = \\frac{d_W + d_E}{\\frac{d_W}{k_W} + \\frac{d_E}{k_E}}\n$$\n这是热导率 $k_W$ 和 $k_E$ 的加权调和平均的定义，权重分别为距离 $d_W$ 和 $d_E$。这种平均方案自然地源于两个串联热阻的物理模型。厚度为 $\\Delta x$、热导率为 $k$ 的平板的单位面积热阻为 $R' = \\frac{\\Delta x}{k}$。从单元 $W$ 中心到单元 $E$ 中心的总热阻是两部分热阻之和：$R'_{total} = R'_W + R'_E = \\frac{d_W}{k_W} + \\frac{d_E}{k_E}$。热通量是总热阻两端的温差，$q_f = \\frac{\\Delta u}{R'_{total}} = \\frac{u_W - u_E}{R'_{total}}$，这正是我们推导出的表达式。\n\n现在，我们使用给定的数值数据计算 $q_f$：\n- 单元宽度：$\\Delta x_{W}=0.6\\,\\mathrm{m}$ 和 $\\Delta x_{E}=0.2\\,\\mathrm{m}$。\n- 到单元中心的距离：$d_{W}=\\frac{\\Delta x_{W}}{2}=\\frac{0.6}{2}=0.3\\,\\mathrm{m}$ 和 $d_{E}=\\frac{\\Delta x_{E}}{2}=\\frac{0.2}{2}=0.1\\,\\mathrm{m}$。\n- 热导率：$k_{W}=2.5\\,\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$ 和 $k_{E}=15\\,\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$。\n- 单元中心温度：$u_{W}=400\\,\\mathrm{K}$ 和 $u_{E}=300\\,\\mathrm{K}$。\n\n将这些值代入推导出的 $q_f$ 表达式：\n$$\nq_f = \\frac{400 - 300}{\\frac{0.3}{2.5} + \\frac{0.1}{15}}\n$$\n首先，计算分母中的各项：\n$$\n\\frac{d_W}{k_W} = \\frac{0.3}{2.5} = 0.12 \\, \\mathrm{m}^2\\,\\mathrm{K}\\,\\mathrm{W}^{-1}\n$$\n$$\n\\frac{d_E}{k_E} = \\frac{0.1}{15} = \\frac{1}{150} \\approx 0.00666\\overline{6} \\, \\mathrm{m}^2\\,\\mathrm{K}\\,\\mathrm{W}^{-1}\n$$\n分母是这两个热阻之和：\n$$\n\\frac{d_W}{k_W} + \\frac{d_E}{k_E} = 0.12 + \\frac{1}{150} = \\frac{12}{100} + \\frac{1}{150} = \\frac{3}{25} + \\frac{1}{150} = \\frac{18}{150} + \\frac{1}{150} = \\frac{19}{150} \\, \\mathrm{m}^2\\,\\mathrm{K}\\,\\mathrm{W}^{-1}\n$$\n温差为 $\\Delta u = u_W - u_E = 400 - 300 = 100 \\, \\mathrm{K}$。\n现在，我们计算通量密度：\n$$\nq_f = \\frac{100}{\\frac{19}{150}} = \\frac{100 \\times 150}{19} = \\frac{15000}{19} \\, \\mathrm{W}\\,\\mathrm{m}^{-2}\n$$\n进行除法运算：\n$$\nq_f \\approx 789.473684... \\, \\mathrm{W}\\,\\mathrm{m}^{-2}\n$$\n按要求将结果四舍五入到四位有效数字：\n$$\nq_f \\approx 789.5 \\, \\mathrm{W}\\,\\mathrm{m}^{-2}\n$$\n正号表示热通量方向是从单元 $W$ 到单元 $E$，这与单元 $W$ 的温度较高的情况一致。",
            "answer": "$$\n\\boxed{789.5}\n$$"
        },
        {
            "introduction": "理论需要通过实践来验证。这项编程练习要求你实现并比较两种不同的界面模型——物理上一致的谐波平均和直觉上简单的算术平均——来解决一个具有强电导率对比的挑战性问题。通过数值实验，你将直观地看到为什么正确的界面模型对于保证计算的准确性和收敛性至关重要。",
            "id": "3409997",
            "problem": "考虑具有空间变化的各向同性导率的稳态扩散方程，\n$$\n-\\nabla \\cdot \\left(k(\\mathbf{x}) \\nabla u(\\mathbf{x})\\right) = f(\\mathbf{x}) \\quad \\text{in } \\Omega = (0,1)\\times(0,1),\n$$\n服从齐次狄利克雷边界条件，\n$$\nu(\\mathbf{x}) = 0 \\quad \\text{on } \\partial\\Omega.\n$$\n假设将 $\\Omega$ 均匀划分为 $N\\times N$ 个边长为 $h = 1/N$ 的方形控制体，其中标量单元中心未知数 $u_{i,j}$ 被解释为单元 $(i,j)$ 上的单元平均值，对于 $i,j \\in \\{0,\\dots,N-1\\}$。设源项为常数 $f(\\mathbf{x}) \\equiv f_0$，其中 $f_0$ 为指定的标量。导率 $k(\\mathbf{x})$ 在每个单元上是分段常数，形成一个棋盘格模式，由两个正常数 $k_{\\mathrm{high}}$ 和 $k_{\\mathrm{low}}$ 根据单元索引的奇偶性交替出现，即如果 $i+j$ 为偶数，则单元导率 $k_{i,j}$ 等于 $k_{\\mathrm{high}}$；如果 $i+j$ 为奇数，则等于 $k_{\\mathrm{low}}$。这种布置模拟了一个强非均质介质，其不连续界面与网格对齐。\n\n从局部守恒定律和穿过单元面的扩散通量的定义出发，使用两种不同的面导率模型来离散化算子：\n- 一种物理上一致的有限体积离散化方法，它使用一个面心导率。该导率源于一个适用于相邻半单元串联传导的界面模型。对于两个相邻单元之间的内界面，使用该界面模型所蕴含的导率。对于邻近边界的面，将齐次狄利克雷边界条件置于单元面上，并从第一性原理推导正确的面传输率。\n- 一种中心差分格式，它在每个内界面处使用两个单元导率的算术平均值。对于邻近边界的面，处理方式与中心差分模板以及置于单元面上的齐次狄利克雷边界条件保持一致。\n\n在均匀网格上，两种格式都会产生二维的五点模板。组装得到的线性系统\n$$\nA u = b,\n$$\n其中 $u \\in \\mathbb{R}^{N^2}$ 按字典序收集 $\\{u_{i,j}\\}$，$b \\in \\mathbb{R}^{N^2}$ 是离散化的源项。求解此系统以获得两种格式的数值解。\n\n为量化收敛性，将单元中心场 $w_{i,j}$ 的离散 $L^2$ 范数定义为\n$$\n\\|w\\|_{L^2_h} \\coloneqq \\left( \\sum_{i=0}^{N-1} \\sum_{j=0}^{N-1} w_{i,j}^2 \\, h^2 \\right)^{1/2}.\n$$\n由于对于不连续系数场，通常无法获得解析形式的精确解 $u(\\mathbf{x})$，因此我们使用在更精细的网格上为物理上一致的有限体积离散化计算出的参考解。具体来说，使用有限体积格式在 $N_{\\mathrm{ref}} = 128$ 的网格上计算一个参考解，并通过对不重叠的 $s \\times s$ 块进行块平均，将其限制到较粗的网格上，其中 $s = N_{\\mathrm{ref}}/N$ 是一个整数。对于给定的粗网格解 $u^{(N)}$ 和相应的受限参考解 $u^{\\mathrm{ref}\\to N}$，定义误差为\n$$\nE(N) \\coloneqq \\left\\| u^{(N)} - u^{\\mathrm{ref}\\to N} \\right\\|_{L^2_h}.\n$$\n对于每种格式，通过对多个网格尺寸的数据 $\\left\\{ \\left(\\log h, \\log E(N)\\right) \\right\\}$ 进行直线拟合来估计经验收敛阶 $p$，其中 $h = 1/N$。使用线性最小二乘法获得斜率 $p$。\n\n您的任务是实现此基准测试，并针对包含不同导率对比度的一个小型测试套件，为两种格式生成经验收敛阶。使用以下测试套件：\n- 情况1：$k_{\\mathrm{high}} = 10$， $k_{\\mathrm{low}} = 1$， $f_0 = 1$，粗网格尺寸 $N \\in \\{16, 32, 64\\}$。\n- 情况2：$k_{\\mathrm{high}} = 1000$， $k_{\\mathrm{low}} = 1$， $f_0 = 1$，粗网格尺寸 $N \\in \\{16, 32, 64\\}$。\n- 情况3：$k_{\\mathrm{high}} = 1$， $k_{\\mathrm{low}} = 10^{-3}$， $f_0 = 1$，粗网格尺寸 $N \\in \\{16, 32, 64\\}$。\n\n对于每种情况，使用具有物理一致性面导率模型的有限体积格式，在 $N_{\\mathrm{ref}} = 128$ 的细网格上计算一个单一的参考解。然后，对于集合中的每个粗网格，求解两种格式并计算相对于受限参考解的误差。通过对 $\\log E(N)$ 与 $\\log h$ 进行线性回归，估计有限体积格式的收敛阶 $p_{\\mathrm{FV}}$ 和中心差分格式的收敛阶 $p_{\\mathrm{CD}}$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，顺序如下\n$$\n\\left[ p_{\\mathrm{FV}}^{(1)},\\, p_{\\mathrm{CD}}^{(1)},\\, p_{\\mathrm{FV}}^{(2)},\\, p_{\\mathrm{CD}}^{(2)},\\, p_{\\mathrm{FV}}^{(3)},\\, p_{\\mathrm{CD}}^{(3)} \\right],\n$$\n其中上标表示情况索引。每个条目必须是浮点数。\n\n不需要外部输入。此基准测试中的所有物理量都是无量纲的，因此无需报告物理单位。不使用角度。不使用百分比。最终输出必须严格遵守要求的格式。",
            "solution": "我们从稳态扩散的基本守恒原理开始。对于围绕单元中心 $(i,j)$ 且体积为 $|V_{i,j}| = h^2$ 的控制体 $V_{i,j}$，对偏微分方程进行积分可得\n$$\n\\int_{V_{i,j}} -\\nabla \\cdot \\left(k \\nabla u\\right) \\, \\mathrm{d}\\mathbf{x} = \\int_{V_{i,j}} f \\, \\mathrm{d}\\mathbf{x}.\n$$\n根据散度定理，左侧等于穿过该控制体边界的净扩散通量：\n$$\n\\sum_{\\text{faces } F \\subset \\partial V_{i,j}} \\int_{F} \\left( -k \\nabla u \\cdot \\mathbf{n}_F \\right) \\, \\mathrm{d}S = \\int_{V_{i,j}} f \\, \\mathrm{d}\\mathbf{x}.\n$$\n在边长为 $h$ 的均匀笛卡尔网格上，每个内界面的面积为 $h$，相邻单元中心之间的距离为 $h$。通过中心差分来近似穿过两个相邻单元中心之间界面的法向导数，穿过单元 $(i,j)$ 和 $(i',j')$ 之间内界面 $F$ 的扩散通量可以写为\n$$\n\\Phi_F \\approx -k_F \\frac{u_{i',j'} - u_{i,j}}{h} \\cdot h = -k_F(u_{i',j'} - u_{i,j}),\n$$\n其中 $k_F$ 是一个有效的面导率。将其代入积分平衡式，并将两边同除以单元体积 $h^2$，得到标准五点形式的离散方程：\n$$\n\\sum_{\\text{neighbors } (i',j')} \\frac{k_F}{h^2}\\left(u_{i,j} - u_{i',j'}\\right) + \\sum_{\\text{boundary faces}} \\frac{k_{F,\\partial}}{h^2}\\left(u_{i,j} - u_{\\mathrm{bc}}\\right) = f_{i,j}.\n$$\n此处，第二个和式考虑了邻近边界的面。对于直接置于单元面上的齐次狄利克雷边界条件 $u_{\\mathrm{bc}} = 0$，从单元中心到边界的距离是 $h/2$，法向导数的近似变为\n$$\n\\frac{u_{\\mathrm{bc}} - u_{i,j}}{h/2},\n$$\n因此边界面的通量大小为\n$$\n\\Phi_{F,\\partial} \\approx -k_{i,j} \\frac{u_{\\mathrm{bc}} - u_{i,j}}{h/2} \\cdot h = -2 k_{i,j} (u_{\\mathrm{bc}} - u_{i,j}).\n$$\n除以 $h^2$，边界面的传输率为 $T_{F,\\partial} = \\frac{2 k_{i,j}}{h^2}$。\n\n关键的建模选择是内界面的有效面导率 $k_F$。考虑两个相邻单元，其法向导率分别为 $k_L$ 和 $k_R$，并沿一个公共面相邻。将垂直于该面的复合介质建模为两个厚度为 $h/2$ 的层串联，单位面积在法向上的等效电阻为\n$$\nR_{\\mathrm{eq}} = \\frac{h/2}{k_L} + \\frac{h/2}{k_R} = \\frac{h}{2}\\left(\\frac{1}{k_L} + \\frac{1}{k_R}\\right).\n$$\n在距离 $h$ 上产生单位 $u$ 跳跃时，能够产生相同法向通量的等效导率 $k_F$ 满足\n$\\Phi_F = -k_F \\frac{\\Delta u}{h} \\cdot h = -k_F \\Delta u$，\n并通过将其与流经两个半单元的串联通量相等，\n$\\Phi_F = -\\frac{\\Delta u}{R_{\\mathrm{eq}}}$。\n因此，\n$$\nk_F = \\frac{h}{R_{\\mathrm{eq}}} = \\frac{h}{\\frac{h}{2}\\left(\\frac{1}{k_L} + \\frac{1}{k_R}\\right)} = \\frac{2}{\\frac{1}{k_L} + \\frac{1}{k_R}}.\n$$\n这是 $k_L$ 和 $k_R$ 的调和平均值，它源于界面处的基本串联传导模型。在离散通量中使用此 $k_F$ 可得到一个跨越不连续界面的物理上一致的有限体积格式。\n\n相比之下，在非均质介质中常用的中心差分近似通常用算术平均值代替 $k_F$，\n$k_F^{\\mathrm{arith}} = \\frac{k_L + k_R}{2}$，\n这对于均匀的 $k$ 是精确的，但对于急剧跳跃则不一致；它错误地表示了串联传导，并倾向于模糊界面效应，从而导致精度降低和潜在的网格依赖性假象。\n\n对于这两种格式，组装的矩阵 $A$ 都是对称正定的，其对角线元素等于到邻居和边界面的传输率之和，非对角线元素等于连接相邻单元的传输率的负值。右端项 $b$ 使用单元中心的源项 $f_{i,j} = f_0$。\n\n因为对于不连续的棋盘格导率，不存在解析解，我们采用人造参考解的方法，即在 $N_{\\mathrm{ref}} = 128$ 的细网格上使用物理一致的有限体积格式计算一个高分辨率解。为了将粗网格解与此参考解进行比较，我们通过对不重叠的 $s \\times s$ 块进行块平均，将细网格解限制到每个粗网格上，其中 $s = N_{\\mathrm{ref}}/N$ 是一个整数。这种限制操作产生了一个与粗网格单元平均值对齐的粗网格场 $u^{\\mathrm{ref}\\to N}$。\n\n然后我们计算离散 $L^2$ 误差\n$$\nE(N) = \\left( \\sum_{i=0}^{N-1} \\sum_{j=0}^{N-1} \\left(u^{(N)}_{i,j} - u^{\\mathrm{ref}\\to N}_{i,j}\\right)^2 \\, h^2 \\right)^{1/2}.\n$$\n假设对于足够精细的网格，误差模型为渐近的 $E(N) \\approx C h^p$，取对数可得\n$$\n\\log E(N) \\approx \\log C + p \\log h.\n$$\n我们通过对网格尺寸 $N \\in \\{16, 32, 64\\}$ 的 $\\log E(N)$ 与 $\\log h$ 的斜率进行线性最小二乘拟合来估计收敛阶 $p$。\n\n该测试套件探讨了三种对比度：情况1，中等对比度 $k_{\\mathrm{high}} = 10$, $k_{\\mathrm{low}} = 1$；情况2，强对比度 $k_{\\mathrm{high}} = 1000$, $k_{\\mathrm{low}} = 1$；以及情况3，反向对比度，包含一个相对于 $k_{\\mathrm{high}} = 1$ 非常小的导率 $k_{\\mathrm{low}} = 10^{-3}$。在所有情况下，源项均为 $f_0 = 1$。我们期望，物理上一致的有限体积格式在不连续处附近会比使用算术平均的中心差分格式表现出更好的精度和更稳定的收敛行为，尤其是在界面建模至关重要的高对比度情况下。\n\n在算法上，程序为每种情况执行以下步骤：\n- 构建 $N_{\\mathrm{ref}}\\times N_{\\mathrm{ref}}$ 的棋盘格导率场。\n- 组装并求解具有调和面导率的有限体积系统，以获得精细参考解。\n- 对于每个粗网格尺寸 $N \\in \\{16, 32, 64\\}$：\n  - 组装并求解具有调和面导率的有限体积系统。\n  - 组装并求解具有算术面导率的中心差分系统。\n  - 通过块平均将精细参考解限制到粗网格上。\n  - 计算每种格式相对于受限参考解的离散 $L^2$ 误差。\n- 在 $\\log$-$\\log$ 空间中通过线性回归估计收敛阶 $p_{\\mathrm{FV}}$ 和 $p_{\\mathrm{CD}}$。\n\n最后，程序按以下顺序打印包含六个浮点数的单行内容\n$$\n\\left[ p_{\\mathrm{FV}}^{(1)},\\, p_{\\mathrm{CD}}^{(1)},\\, p_{\\mathrm{FV}}^{(2)},\\, p_{\\mathrm{CD}}^{(2)},\\, p_{\\mathrm{FV}}^{(3)},\\, p_{\\mathrm{CD}}^{(3)} \\right].\n$$",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.sparse import lil_matrix, csr_matrix\nfrom scipy.sparse.linalg import spsolve\n\ndef build_checkerboard_k(N: int, k_high: float, k_low: float) -> np.ndarray:\n    \"\"\"\n    Build an N x N checkerboard conductivity field with k_high and k_low alternating\n    by parity of (i + j).\n    \"\"\"\n    k = np.empty((N, N), dtype=float)\n    for i in range(N):\n        for j in range(N):\n            k[i, j] = k_high if ((i + j) % 2 == 0) else k_low\n    return k\n\ndef face_conductivity(k_left: float, k_right: float, scheme: str) -> float:\n    \"\"\"\n    Compute face conductivity between two adjacent cells given their conductivities.\n    scheme: 'harmonic' or 'arithmetic'\n    \"\"\"\n    if scheme == 'harmonic':\n        # Harmonic average: 2 / (1/k_left + 1/k_right)\n        # Guard against division by zero (though k are positive by construction)\n        return 2.0 / (1.0 / k_left + 1.0 / k_right)\n    elif scheme == 'arithmetic':\n        return 0.5 * (k_left + k_right)\n    else:\n        raise ValueError(\"Unknown scheme: {}\".format(scheme))\n\ndef assemble_system(N: int, k: np.ndarray, scheme: str, f0: float) -> tuple:\n    \"\"\"\n    Assemble the sparse linear system A u = b for the variable-coefficient diffusion\n    problem on an N x N cell-centered grid with homogeneous Dirichlet boundary conditions.\n    Interior faces use either harmonic or arithmetic averaging depending on 'scheme'.\n    Boundary faces use a transmissibility of 2*k_cell/h^2 corresponding to a boundary at the face.\n    Returns (A_csr, b) where A_csr is a csr_matrix of size (N^2, N^2) and b is an ndarray of length N^2.\n    \"\"\"\n    h = 1.0 / N\n    # Using LIL for assembly efficiency, then convert to CSR.\n    A = lil_matrix((N * N, N * N), dtype=float)\n    b = np.full(N * N, f0, dtype=float)\n\n    def idx(i: int, j: int) -> int:\n        return i * N + j\n\n    for i in range(N):\n        for j in range(N):\n            p = idx(i, j)\n            diag = 0.0\n            k_ij = k[i, j]\n\n            # Left face (neighbor at j-1 or boundary)\n            if j > 0:\n                k_face = face_conductivity(k_ij, k[i, j - 1], scheme)\n                T = k_face / (h * h)\n                diag += T\n                A[p, idx(i, j - 1)] -= T\n            else:\n                # Boundary at left face: distance h/2\n                T = 2.0 * k_ij / (h * h)\n                diag += T\n                # u_bc = 0, so no RHS contribution needed\n\n            # Right face (neighbor at j+1 or boundary)\n            if j  N - 1:\n                k_face = face_conductivity(k_ij, k[i, j + 1], scheme)\n                T = k_face / (h * h)\n                diag += T\n                A[p, idx(i, j + 1)] -= T\n            else:\n                T = 2.0 * k_ij / (h * h)\n                diag += T\n\n            # Bottom face (neighbor at i-1 or boundary)\n            if i  0:\n                k_face = face_conductivity(k_ij, k[i - 1, j], scheme)\n                T = k_face / (h * h)\n                diag += T\n                A[p, idx(i - 1, j)] -= T\n            else:\n                T = 2.0 * k_ij / (h * h)\n                diag += T\n\n            # Top face (neighbor at i+1 or boundary)\n            if i  N - 1:\n                k_face = face_conductivity(k_ij, k[i + 1, j], scheme)\n                T = k_face / (h * h)\n                diag += T\n                A[p, idx(i + 1, j)] -= T\n            else:\n                T = 2.0 * k_ij / (h * h)\n                diag += T\n\n            A[p, p] += diag\n\n    return csr_matrix(A), b\n\ndef solve_system(A: csr_matrix, b: np.ndarray) - np.ndarray:\n    \"\"\"\n    Solve the sparse linear system A u = b using a direct solver.\n    \"\"\"\n    return spsolve(A, b)\n\ndef restrict_block_average(u_ref: np.ndarray, N_ref: int, N: int) - np.ndarray:\n    \"\"\"\n    Restrict a fine-grid solution u_ref (flattened length N_ref^2) to a coarse grid of size N x N\n    by block averaging over non-overlapping s x s blocks, where s = N_ref // N.\n    Returns a flattened coarse solution of length N^2.\n    \"\"\"\n    s = N_ref // N\n    assert N_ref % N == 0, \"N_ref must be divisible by N for block averaging.\"\n    # Reshape fine solution to 2D\n    u2d = u_ref.reshape(N_ref, N_ref)\n    # Average over s x s blocks\n    u_coarse = np.zeros((N, N), dtype=float)\n    for i in range(N):\n        for j in range(N):\n            block = u2d[i * s:(i + 1) * s, j * s:(j + 1) * s]\n            u_coarse[i, j] = np.mean(block)\n    return u_coarse.ravel()\n\ndef l2_error(u_coarse: np.ndarray, u_ref_coarse: np.ndarray, N: int) - float:\n    \"\"\"\n    Compute the discrete L2 error between u_coarse and restricted reference u_ref_coarse on an N x N grid.\n    \"\"\"\n    h = 1.0 / N\n    diff = u_coarse - u_ref_coarse\n    return np.sqrt(np.sum(diff * diff) * h * h)\n\ndef convergence_rate(N_list: list, err_list: list) - float:\n    \"\"\"\n    Estimate the convergence rate p by linear regression of log(err) versus log(h),\n    where h = 1/N, across the given N_list and err_list.\n    \"\"\"\n    h_list = np.array([1.0 / N for N in N_list], dtype=float)\n    logh = np.log(h_list)\n    loge = np.log(np.array(err_list, dtype=float))\n    # Fit line: loge = a + p * logh\n    p = np.polyfit(logh, loge, 1)[0]\n    return float(p)\n\ndef run_case(k_high: float, k_low: float, f0: float, N_ref: int, N_list: list) - tuple:\n    \"\"\"\n    Run a single test case:\n    - Build checkerboard k on fine grid N_ref.\n    - Solve FV harmonic scheme on fine grid for reference.\n    - For each N in N_list, solve both schemes and compute L2 errors against restricted reference.\n    - Return the estimated convergence rates for FV harmonic and CD arithmetic.\n    \"\"\"\n    # Reference solution on fine grid using FV harmonic\n    k_ref = build_checkerboard_k(N_ref, k_high, k_low)\n    A_ref, b_ref = assemble_system(N_ref, k_ref, scheme='harmonic', f0=f0)\n    u_ref = solve_system(A_ref, b_ref)\n\n    # Collect errors across coarse grids\n    errs_fv = []\n    errs_cd = []\n\n    for N in N_list:\n        # Conductivity on coarse grid\n        kN = build_checkerboard_k(N, k_high, k_low)\n\n        # FV harmonic on coarse grid\n        A_fv, b_fv = assemble_system(N, kN, scheme='harmonic', f0=f0)\n        u_fv = solve_system(A_fv, b_fv)\n\n        # CD arithmetic on coarse grid\n        A_cd, b_cd = assemble_system(N, kN, scheme='arithmetic', f0=f0)\n        u_cd = solve_system(A_cd, b_cd)\n\n        # Restrict reference to coarse grid\n        u_ref_N = restrict_block_average(u_ref, N_ref, N)\n\n        # Errors\n        e_fv = l2_error(u_fv, u_ref_N, N)\n        e_cd = l2_error(u_cd, u_ref_N, N)\n\n        errs_fv.append(e_fv)\n        errs_cd.append(e_cd)\n\n    # Rates via regression\n    rate_fv = convergence_rate(N_list, errs_fv)\n    rate_cd = convergence_rate(N_list, errs_cd)\n\n    return rate_fv, rate_cd\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (k_high, k_low, f0, N_ref, N_list)\n        (10.0, 1.0, 1.0, 128, [16, 32, 64]),\n        (1000.0, 1.0, 1.0, 128, [16, 32, 64]),\n        (1.0, 1e-3, 1.0, 128, [16, 32, 64]),\n    ]\n\n    results = []\n    for k_high, k_low, f0, N_ref, N_list in test_cases:\n        rate_fv, rate_cd = run_case(k_high, k_low, f0, N_ref, N_list)\n        # Append in the specified order\n        results.append(rate_fv)\n        results.append(rate_cd)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        },
        {
            "introduction": "在许多实际问题中，材料界面并不会恰好与我们的计算网格对齐。本练习将引导你探索一种处理任意位置尖锐界面的高级数值技术——鬼点法（Ghost Fluid Method）。你将学习如何通过构造一个“鬼值”来精确地施加界面上的物理通量连续性条件，从而理解谐波平均的核心思想如何推广到更灵活、更强大的数值格式中。",
            "id": "3410015",
            "problem": "考虑一个稳态热传导模型，该模型由标量偏微分方程 (PDE) $-\\nabla \\cdot (\\kappa \\nabla u) = 0$ 控制，定义在一个由两种均质材料组成的区域上，这两种材料被一个清晰的界面 $\\Gamma$ 分隔。假设界面由一个水平集函数 $\\phi$ 表示，该函数是一个有向距离函数：在材料 $\\Omega^{-}$ 中 $\\phi  0$，在材料 $\\Omega^{+}$ 中 $\\phi  0$，单位法向量 $\\boldsymbol{n} = \\nabla \\phi / |\\nabla \\phi|$ 从 $\\Omega^{-}$ 指向 $\\Omega^{+}$。假设在 $\\Gamma$ 上存在完美热接触，且没有界面源或汇，因此温度 $u$ 和法向热通量 $-\\kappa \\nabla u \\cdot \\boldsymbol{n}$ 在 $\\Gamma$ 两侧是连续的。\n\n我们关注一个局部与 $\\boldsymbol{n}$ 对齐的一维法向线段，该线段连接两个网格点 $x_{i}$ 和 $x_{i+1}$，其中 $x_{i}$ 位于 $\\Omega^{-}$ 内，$x_{i+1}$ 位于 $\\Omega^{+}$ 内。假设局部坐标 $x$ 参数化该线段，且 $x$ 沿 $\\boldsymbol{n}$ 方向递增，界面位置 $x_{\\Gamma}$ 严格位于 $x_{i}$ 和 $x_{i+1}$ 之间，沿法线方向的距离为 $d_{-} = |x_{\\Gamma} - x_{i}|$ 和 $d_{+} = |x_{i+1} - x_{\\Gamma}|$。$\\Omega^{-}$ 和 $\\Omega^{+}$ 中的热导率分别为 $\\kappa_{-}$ 和 $\\kappa_{+}$。设 $u_{i}$ 和 $u_{i+1}$ 分别表示 $x_{i}$ 和 $x_{i+1}$ 处的离散温度。设 $u_{\\Gamma}$ 表示界面点 $x_{\\Gamma}$ 处的真实温度。\n\n你需要为鬼点流体法 (GFM) 推导鬼点值，以在离散格式中施加法向通量 $-\\kappa \\nabla u \\cdot \\boldsymbol{n}$ 的连续性。具体来说，构建鬼点值 $u_{i+1}^{G|-}$，它被定义为使用界面条件从 $\\Omega^{-}$ 侧外插到位置 $x_{i+1}$ 处的值，这样在 $x_{i}$ 处的中心有限差分模板就可以完全使用 $\\Omega^{-}$ 的数据来应用。\n\n从基本守恒原理和本构关系（傅里叶定律）出发，按以下步骤进行：\n\n1. 利用法向通量的连续性和 $u$ 的连续性消去 $u_{\\Gamma}$，推导出沿法向线段的离散通量 $q$ 作为 $u_{i}$, $u_{i+1}$, $d_{-}$, $d_{+}$, $\\kappa_{-}$, 和 $\\kappa_{+}$ 的函数。证明该两点通量中的有效热导率是按 $d_{-}$ 和 $d_{+}$ 加权的调和平均值。\n\n2. 推导界面值 $u_{\\Gamma}$ 关于 $u_{i}$, $u_{i+1}$, $d_{-}$, $d_{+}$, $\\kappa_{-}$, 和 $\\kappa_{+}$ 的表达式。\n\n3. 利用界面处 $\\Omega^{-}$ 侧的单边梯度，通过从 $\\Omega^{-}$ 侧跨越界面到 $x_{i+1}$ 的线性外插来构建鬼点值 $u_{i+1}^{G|-}$。将 $u_{i+1}^{G|-}$ 表示为 $u_{i}$, $u_{i+1}$, $d_{-}$, $d_{+}$, $\\kappa_{-}$, 和 $\\kappa_{+}$ 的闭合形式表达式。\n\n现在，使用以下科学上一致的数据计算 $u_{i+1}^{G|-}$ 的值：\n\n- $\\kappa_{-} = 3.2$ (单位 $\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$),\n- $\\kappa_{+} = 0.8$ (单位 $\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$),\n- $u_{i} = 310$ (单位 $\\mathrm{K}$),\n- $u_{i+1} = 340$ (单位 $\\mathrm{K}$),\n- $\\phi(x_{i}) = -3.5 \\times 10^{-4}$ (单位 $\\mathrm{m}$),\n- $\\phi(x_{i+1}) = 6.5 \\times 10^{-4}$ (单位 $\\mathrm{m}$)。\n\n因为 $\\phi$ 是一个有向距离，取 $d_{-} = |\\phi(x_{i})|$ 和 $d_{+} = |\\phi(x_{i+1})|$。用 $\\mathrm{K}$（开尔文）表示最终的鬼点温度 $u_{i+1}^{G|-}$，并将答案四舍五入到四位有效数字。",
            "solution": "经评估，问题陈述有效。其科学依据是稳态热传导原理，数学上是适定的，并且所有术语和数据都以清晰、客观和一致的方式给出。因此，我们可以开始求解。\n\n该问题描述了垂直于两种材料之间界面的一维稳态热传导。控制方程为 $-\\nabla \\cdot (\\kappa \\nabla u) = 0$。在一维情况下，沿着法向坐标 $x$，方程简化为 $-\\frac{d}{dx}\\left(\\kappa \\frac{du}{dx}\\right) = 0$。这意味着由傅里叶定律给出的传导热通量 $q = -\\kappa \\frac{du}{dx}$ 沿坐标 $x$ 是恒定的。完美热接触条件确保了温度 $u$ 和法向通量 $q$ 在界面 $\\Gamma$ 的位置 $x_{\\Gamma}$ 处是连续的。\n\n我们考虑两个线段：第一段从 $x_i$ 到 $x_{\\Gamma}$，位于材料 $\\Omega^{-}$ 中，热导率为 $\\kappa_{-}$；第二段从 $x_{\\Gamma}$ 到 $x_{i+1}$，位于材料 $\\Omega^{+}$ 中，热导率为 $\\kappa_{+}$。这些线段的长度分别为 $d_{-} = x_{\\Gamma} - x_i$ 和 $d_{+} = x_{i+1} - x_{\\Gamma}$。对每个线段上的梯度应用一阶有限差分近似，我们可以用两种方式写出恒定的通量 $q$：\n$$q = -\\kappa_{-} \\frac{u_{\\Gamma} - u_i}{d_{-}} \\quad (1)$$\n$$q = -\\kappa_{+} \\frac{u_{i+1} - u_{\\Gamma}}{d_{+}} \\quad (2)$$\n其中 $u_i$、$u_{\\Gamma}$ 和 $u_{i+1}$ 分别是位置 $x_i$、$x_{\\Gamma}$ 和 $x_{i+1}$ 处的温度。\n\n**1. 离散通量和有效热导率的推导**\n\n为了找到通量 $q$ 作为已知温度 $u_i$ 和 $u_{i+1}$ 的函数，我们必须消去未知的界面温度 $u_{\\Gamma}$。我们可以重新整理方程 $(1)$ 和 $(2)$ 来求解每个线段上的温降：\n$$u_{\\Gamma} - u_i = -\\frac{q d_{-}}{\\kappa_{-}}$$\n$$u_{i+1} - u_{\\Gamma} = -\\frac{q d_{+}}{\\kappa_{+}}$$\n将这两个方程相加可以消去 $u_{\\Gamma}$：\n$$(u_{i+1} - u_{\\Gamma}) + (u_{\\Gamma} - u_i) = -\\frac{q d_{-}}{\\kappa_{-}} - \\frac{q d_{+}}{\\kappa_{+}}$$\n$$u_{i+1} - u_i = -q \\left( \\frac{d_{-}}{\\kappa_{-}} + \\frac{d_{+}}{\\kappa_{+}} \\right)$$\n求解通量 $q$，我们得到：\n$$q = - \\frac{u_{i+1} - u_i}{\\frac{d_{-}}{\\kappa_{-}} + \\frac{d_{+}}{\\kappa_{+}}}$$\n该表达式表示沿法向线段的离散通量。为了解释有效热导率，我们将其与总距离 $h = d_{-} + d_{+}$ 上的标准两点通量形式 $q = -\\kappa_{\\text{eff}} \\frac{u_{i+1} - u_i}{h}$ 进行比较。令两个 $q$ 的表达式相等，得到：\n$$\\kappa_{\\text{eff}} \\frac{u_{i+1} - u_i}{d_{-} + d_{+}} = \\frac{u_{i+1} - u_i}{\\frac{d_{-}}{\\kappa_{-}} + \\frac{d_{+}}{\\kappa_{+}}}$$\n$$\\kappa_{\\text{eff}} = \\frac{d_{-} + d_{+}}{\\frac{d_{-}}{\\kappa_{-}} + \\frac{d_{+}}{\\kappa_{+}}}$$\n$\\kappa_{\\text{eff}}$ 的这个形式正是热导率 $\\kappa_{-}$ 和 $\\kappa_{+}$ 的调和平均值，并由各自的距离 $d_{-}$ 和 $d_{+}$ 加权。\n\n**2. 界面温度 $u_{\\Gamma}$ 的推导**\n\n为了求出界面温度 $u_{\\Gamma}$，我们可以将方程 $(1)$ 重新整理为 $u_{\\Gamma} = u_i - \\frac{q d_{-}}{\\kappa_{-}}$，并代入推导出的 $q$ 的表达式：\n$$u_{\\Gamma} = u_i - \\frac{d_{-}}{\\kappa_{-}} \\left( - \\frac{u_{i+1} - u_i}{\\frac{d_{-}}{\\kappa_{-}} + \\frac{d_{+}}{\\kappa_{+}}} \\right) = u_i + \\frac{\\frac{d_{-}}{\\kappa_{-}}}{\\frac{d_{-}}{\\kappa_{-}} + \\frac{d_{+}}{\\kappa_{+}}} (u_{i+1} - u_i)$$\n在公分母上合并各项：\n$$u_{\\Gamma} = \\frac{u_i \\left(\\frac{d_{-}}{\\kappa_{-}} + \\frac{d_{+}}{\\kappa_{+}}\\right) + u_{i+1} \\frac{d_{-}}{\\kappa_{-}} - u_i \\frac{d_{-}}{\\kappa_{-}}}{\\frac{d_{-}}{\\kappa_{-}} + \\frac{d_{+}}{\\kappa_{+}}} = \\frac{u_i \\frac{d_{+}}{\\kappa_{+}} + u_{i+1} \\frac{d_{-}}{\\kappa_{-}}}{\\frac{d_{-}}{\\kappa_{-}} + \\frac{d_{+}}{\\kappa_{+}}}$$\n为了得到一个更方便的形式，我们将分子和分母同乘以 $\\kappa_{-} \\kappa_{+}$：\n$$u_{\\Gamma} = \\frac{u_i d_{+} \\kappa_{-} + u_{i+1} d_{-} \\kappa_{+}}{d_{-} \\kappa_{+} + d_{+} \\kappa_{-}}$$\n这表明界面温度是相邻温度 $u_i$ 和 $u_{i+1}$ 的加权平均值，权重取决于距离和热导率。\n\n**3. 鬼点值 $u_{i+1}^{G|-}$ 的推导**\n\n鬼点值 $u_{i+1}^{G|-}$ 是通过从 $\\Omega^{-}$ 侧跨越界面线性外插温度分布到位置 $x_{i+1}$ 所得到的温度。界面上 $\\Omega^{-}$ 侧的梯度为 $(\\frac{du}{dx})^{-} = \\frac{u_{\\Gamma} - u_i}{d_{-}}$。因此，到 $x_{i+1}$ 的线性外插为：\n$$u_{i+1}^{G|-} = u_{\\Gamma} + d_{+} \\left( \\frac{du}{dx} \\right)^{-} = u_{\\Gamma} + d_{+} \\frac{u_{\\Gamma} - u_i}{d_{-}}$$\n为了用已知量表示这个值，我们代入第2部分中 $u_{\\Gamma}$ 的表达式。首先，我们求出 $(u_{\\Gamma} - u_i)$ 这一项：\n$$u_{\\Gamma} - u_i = \\frac{u_i d_{+} \\kappa_{-} + u_{i+1} d_{-} \\kappa_{+}}{d_{-} \\kappa_{+} + d_{+} \\kappa_{-}} - u_i = \\frac{u_i d_{+} \\kappa_{-} + u_{i+1} d_{-} \\kappa_{+} - u_i (d_{-} \\kappa_{+} + d_{+} \\kappa_{-})}{d_{-} \\kappa_{+} + d_{+} \\kappa_{-}}$$\n$$u_{\\Gamma} - u_i = \\frac{u_{i+1} d_{-} \\kappa_{+} - u_i d_{-} \\kappa_{+}}{d_{-} \\kappa_{+} + d_{+} \\kappa_{-}} = \\frac{d_{-} \\kappa_{+} (u_{i+1} - u_i)}{d_{-} \\kappa_{+} + d_{+} \\kappa_{-}}$$\n现在，将这个结果和 $u_{\\Gamma}$ 的表达式代入鬼点值的公式中：\n$$u_{i+1}^{G|-} = \\left( \\frac{u_i d_{+} \\kappa_{-} + u_{i+1} d_{-} \\kappa_{+}}{d_{-} \\kappa_{+} + d_{+} \\kappa_{-}} \\right) + \\frac{d_{+}}{d_{-}} \\left( \\frac{d_{-} \\kappa_{+} (u_{i+1} - u_i)}{d_{-} \\kappa_{+} + d_{+} \\kappa_{-}} \\right)$$\n在公分母上合并：\n$$u_{i+1}^{G|-} = \\frac{u_i d_{+} \\kappa_{-} + u_{i+1} d_{-} \\kappa_{+} + d_{+} \\kappa_{+} (u_{i+1} - u_i)}{d_{-} \\kappa_{+} + d_{+} \\kappa_{-}}$$\n$$u_{i+1}^{G|-} = \\frac{u_i d_{+} \\kappa_{-} + u_{i+1} d_{-} \\kappa_{+} + u_{i+1} d_{+} \\kappa_{+} - u_i d_{+} \\kappa_{+}}{d_{-} \\kappa_{+} + d_{+} \\kappa_{-}}$$\n按 $u_i$ 和 $u_{i+1}$ 分组各项，得到最终的闭合形式表达式：\n$$u_{i+1}^{G|-} = \\frac{u_i d_{+} (\\kappa_{-} - \\kappa_{+}) + u_{i+1} \\kappa_{+} (d_{-} + d_{+})}{d_{-} \\kappa_{+} + d_{+} \\kappa_{-}}$$\n\n**数值计算**\n\n我们有以下给定数据：\n- $\\kappa_{-} = 3.2$\n- $\\kappa_{+} = 0.8$\n- $u_{i} = 310$\n- $u_{i+1} = 340$\n- $d_{-} = |\\phi(x_{i})| = |-3.5 \\times 10^{-4}| = 3.5 \\times 10^{-4}$\n- $d_{+} = |\\phi(x_{i+1})| = |6.5 \\times 10^{-4}| = 6.5 \\times 10^{-4}$\n\n我们将这些数值代入推导出的 $u_{i+1}^{G|-}$ 表达式中。\n首先，我们计算分母：\n$$d_{-} \\kappa_{+} + d_{+} \\kappa_{-} = (3.5 \\times 10^{-4})(0.8) + (6.5 \\times 10^{-4})(3.2)$$\n$$= (2.8 \\times 10^{-4}) + (20.8 \\times 10^{-4}) = 23.6 \\times 10^{-4}$$\n接下来，我们计算分子：\n$$u_i d_{+} (\\kappa_{-} - \\kappa_{+}) + u_{i+1} \\kappa_{+} (d_{-} + d_{+})$$\n$$= 310 \\times (6.5 \\times 10^{-4}) \\times (3.2 - 0.8) + 340 \\times (0.8) \\times (3.5 \\times 10^{-4} + 6.5 \\times 10^{-4})$$\n$$= 310 \\times (6.5 \\times 10^{-4}) \\times (2.4) + 340 \\times (0.8) \\times (10 \\times 10^{-4})$$\n$$= 310 \\times (15.6 \\times 10^{-4}) + 272 \\times (1.0 \\times 10^{-3})$$\n$$= (4836 \\times 10^{-4}) + (2720 \\times 10^{-4}) = 7556 \\times 10^{-4}$$\n最后，我们计算比值：\n$$u_{i+1}^{G|-} = \\frac{7556 \\times 10^{-4}}{23.6 \\times 10^{-4}} = \\frac{7556}{23.6} \\approx 320.16949$$\n四舍五入到四位有效数字，鬼点温度为 $320.2 \\, \\mathrm{K}$。",
            "answer": "$$\\boxed{320.2}$$"
        }
    ]
}