{
    "hands_on_practices": [
        {
            "introduction": "A fundamental task in numerical methods is applying boundary conditions correctly. In a cell-centered arrangement, the solution variables live at the center of control volumes, not on the physical boundary itself. This practice  guides you through using linear extrapolation to set ghost cell values, a standard technique to enforce Dirichlet boundary conditions while maintaining a consistent numerical stencil for all interior cells.",
            "id": "3368871",
            "problem": "Consider a one-dimensional domain $[0,L]$ with a uniform cell-centered discretization for solving a Partial Differential Equation (PDE). Let there be $N$ interior cells, so that the grid spacing is $\\Delta x = L/N$. The cell centers are located at $x_{i} = (i-\\tfrac{1}{2})\\Delta x$ for $i=1,\\dots,N$, and two ghost cell centers are placed at $x_{0} = -\\tfrac{1}{2}\\Delta x$ and $x_{N+1} = L + \\tfrac{1}{2}\\Delta x$. You are given Dirichlet boundary conditions $u(0) = \\alpha$ and $u(L) = \\beta$. In a cell-centered finite difference or finite volume scheme, discrete stencils near the boundaries require ghost values $u_{0}$ and $u_{N+1}$. \n\nStarting only from the geometric definition of the cell-centered grid and the Dirichlet boundary data, enforce the boundary conditions by requiring that a linear reconstruction across each boundary matches the given boundary value at the physical boundary while using the adjacent interior cell-center value located at $x=\\Delta x/2$ (left) and $x=L-\\Delta x/2$ (right). Specifically, on the left boundary, use a linear function through $(x_{0},u_{0})$ and $(x_{1},u_{1})$ whose value at $x=0$ equals $\\alpha$; on the right boundary, use a linear function through $(x_{N},u_{N})$ and $(x_{N+1},u_{N+1})$ whose value at $x=L$ equals $\\beta$.\n\nDerive closed-form expressions for the ghost values $u_{0}$ and $u_{N+1}$ in terms of $\\alpha$, $\\beta$, $u_{1}$, and $u_{N}$. Your final answer must be expressed as a single row matrix containing the two ghost values in symbolic form. No numerical evaluation or rounding is required.",
            "solution": "The problem statement has been validated and is deemed to be scientifically grounded, well-posed, objective, and complete. It describes a standard and correct procedure for implementing Dirichlet boundary conditions in a cell-centered finite difference or finite volume scheme. A rigorous solution can be derived from the provided information.\n\nWe are tasked with finding the values of the ghost cell variables, $u_0$ and $u_{N+1}$, by enforcing Dirichlet boundary conditions $u(0) = \\alpha$ and $u(L) = \\beta$. The enforcement is done via linear reconstruction across the boundaries.\n\nFirst, we consider the left boundary at $x=0$. The problem states that we must use a linear function passing through the points $(x_0, u_0)$ and $(x_1, u_1)$ and require that its value at $x=0$ is equal to $\\alpha$. The coordinates of these points are given by the grid definition:\n$x_0 = -\\frac{1}{2}\\Delta x$\n$x_1 = \\frac{1}{2}\\Delta x$\nThe two points are therefore $(-\\frac{1}{2}\\Delta x, u_0)$ and $(\\frac{1}{2}\\Delta x, u_1)$.\n\nA linear function $u(x)$ passing through two points $(x_a, y_a)$ and $(x_b, y_b)$ can be written using the point-slope form:\n$u(x) = y_a + \\frac{y_b - y_a}{x_b - x_a}(x - x_a)$\nSubstituting our points $(x_0, u_0)$ and $(x_1, u_1)$, we get:\n$u(x) = u_0 + \\frac{u_1 - u_0}{x_1 - x_0}(x - x_0)$\nThe difference in the x-coordinates is $x_1 - x_0 = \\frac{1}{2}\\Delta x - (-\\frac{1}{2}\\Delta x) = \\Delta x$.\nSubstituting this and the expression for $x_0$ into the equation gives:\n$u(x) = u_0 + \\frac{u_1 - u_0}{\\Delta x}(x - (-\\frac{1}{2}\\Delta x))$\n$u(x) = u_0 + \\frac{u_1 - u_0}{\\Delta x}(x + \\frac{1}{2}\\Delta x)$\n\nWe now enforce the boundary condition $u(0) = \\alpha$:\n$\\alpha = u(0) = u_0 + \\frac{u_1 - u_0}{\\Delta x}(0 + \\frac{1}{2}\\Delta x)$\n$\\alpha = u_0 + \\frac{u_1 - u_0}{\\Delta x}(\\frac{1}{2}\\Delta x)$\n$\\alpha = u_0 + \\frac{1}{2}(u_1 - u_0)$\n$\\alpha = u_0 + \\frac{1}{2}u_1 - \\frac{1}{2}u_0$\n$\\alpha = \\frac{1}{2}u_0 + \\frac{1}{2}u_1$\nThis equation shows that the value at the boundary is the arithmetic mean of the values at the adjacent ghost and interior cell centers, which is expected since the boundary at $x=0$ is the geometric midpoint of the locations $x_0$ and $x_1$.\n\nTo find the ghost value $u_0$, we solve for it:\n$2\\alpha = u_0 + u_1$\n$u_0 = 2\\alpha - u_1$\n\nNext, we consider the right boundary at $x=L$. The procedure is analogous. We use a linear function passing through the points $(x_N, u_N)$ and $(x_{N+1}, u_{N+1})$, and require its value at $x=L$ to be $\\beta$. The coordinates are:\n$x_N = L - \\frac{1}{2}\\Delta x$\n$x_{N+1} = L + \\frac{1}{2}\\Delta x$\nThe two points are $(L - \\frac{1}{2}\\Delta x, u_N)$ and $(L + \\frac{1}{2}\\Delta x, u_{N+1})$.\n\nUsing the point-slope form of a line with the point $(x_N, u_N)$:\n$u(x) = u_N + \\frac{u_{N+1} - u_N}{x_{N+1} - x_N}(x - x_N)$\nThe difference in the x-coordinates is $x_{N+1} - x_N = (L + \\frac{1}{2}\\Delta x) - (L - \\frac{1}{2}\\Delta x) = \\Delta x$.\nSubstituting this and the expression for $x_N$ into the equation gives:\n$u(x) = u_N + \\frac{u_{N+1} - u_N}{\\Delta x}(x - (L - \\frac{1}{2}\\Delta x))$\n\nWe now enforce the boundary condition $u(L) = \\beta$:\n$\\beta = u(L) = u_N + \\frac{u_{N+1} - u_N}{\\Delta x}(L - (L - \\frac{1}{2}\\Delta x))$\n$\\beta = u_N + \\frac{u_{N+1} - u_N}{\\Delta x}(\\frac{1}{2}\\Delta x)$\n$\\beta = u_N + \\frac{1}{2}(u_{N+1} - u_N)$\n$\\beta = u_N + \\frac{1}{2}u_{N+1} - \\frac{1}{2}u_N$\n$\\beta = \\frac{1}{2}u_N + \\frac{1}{2}u_{N+1}$\nAs before, the value at the boundary is the arithmetic mean of the values at the adjacent interior and ghost cell centers, since $x=L$ is the midpoint of $x_N$ and $x_{N+1}$.\n\nTo find the ghost value $u_{N+1}$, we solve for it:\n$2\\beta = u_N + u_{N+1}$\n$u_{N+1} = 2\\beta - u_N$\n\nThe derived expressions for the ghost values are $u_0 = 2\\alpha - u_1$ and $u_{N+1} = 2\\beta - u_N$. These are expressed in terms of the given boundary values $\\alpha$ and $\\beta$, and the adjacent interior cell values $u_1$ and $u_N$, as required.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2\\alpha - u_1 & 2\\beta - u_N\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Vertex-centered schemes conveniently place nodes directly on the domain boundaries, but this presents a challenge for implementing derivative (Neumann) boundary conditions. This exercise  demonstrates how to use Taylor series expansions to define a \"ghost vertex\" outside the domain. By carefully constructing the ghost value, you can ensure the finite difference approximation of the boundary flux is second-order accurate, a crucial skill for developing reliable numerical models.",
            "id": "3368909",
            "problem": "Consider a one-dimensional Partial Differential Equation (PDE) posed on the interval $[0,L]$ to be discretized by a vertex-centered scheme on a uniform mesh with spacing $h>0$. The vertices are located at $x_j=jh$ for integers $j$, with $x_0=0$ as the boundary vertex. Let $u_j$ denote the discrete approximation to the exact solution $u(x)$ at the vertex $x_j$. To form a second-order accurate interior stencil at $x_0$, introduce a ghost vertex value $u_{-1}$ at $x_{-1}=-h$.\n\nImpose the Neumann boundary condition $u_x(0)=\\gamma$, where $\\gamma$ is a given constant. The discrete boundary flux is to be computed with a boundary-adjacent one-sided difference that uses the ghost vertex to emulate symmetry, namely the two-point formula across the boundary,\n$$\n\\frac{u_1 - u_{-1}}{2h}.\n$$\nDerive, from first principles starting with the definition of the derivative and standard Taylor expansions, an expression for the ghost vertex value $u_{-1}$ in terms of $u_1$, $h$, and $\\gamma$ so that the above one-sided difference at $x_0$ equals $\\gamma$ with second-order accuracy in $h$. Provide your final expression for $u_{-1}$ in closed form. No rounding is required, and no units should be included in the final expression.",
            "solution": "The problem requires the derivation of an expression for a ghost vertex value, $u_{-1}$, used to implement a Neumann boundary condition, $u_x(0) = \\gamma$, in a vertex-centered finite difference scheme. The derivation must start from first principles using Taylor series and ensure that the resulting implementation is second-order accurate.\n\nLet the exact solution to the partial differential equation be denoted by the function $u(x)$. The domain is discretized with a uniform mesh of spacing $h$, where the vertex locations are $x_j = jh$. The boundary is at $x_0 = 0$. The discrete value at a vertex $x_j$ is denoted by $u_j$, which is an approximation to $u(x_j)$. To handle the boundary condition at $x_0=0$, we introduce a ghost vertex at $x_{-1} = -h$ with a corresponding value $u_{-1}$.\n\nThe core of the derivation rests on Taylor's theorem. We expand the function $u(x)$ in a Taylor series around the boundary point $x_0 = 0$. The values of the solution at the neighboring vertices, $x_1 = h$ and the ghost vertex location $x_{-1} = -h$, can be expressed as:\n$$u(h) = u(0) + h u_x(0) + \\frac{h^2}{2!} u_{xx}(0) + \\frac{h^3}{3!} u_{xxx}(0) + \\mathcal{O}(h^4)$$\n$$u(-h) = u(0) - h u_x(0) + \\frac{h^2}{2!} u_{xx}(0) - \\frac{h^3}{3!} u_{xxx}(0) + \\mathcal{O}(h^4)$$\nwhere $u_x(0)$, $u_{xx}(0)$, and $u_{xxx}(0)$ represent the first, second, and third derivatives of $u(x)$ evaluated at $x=0$, respectively.\n\nThe problem specifies that the boundary flux is approximated by the centered-difference-like formula $\\frac{u_1 - u_{-1}}{2h}$. To analyze the accuracy of this formula as an approximation for $u_x(0)$, we examine its local truncation error (LTE). The LTE is found by substituting the exact solution values, $u(x_j)$, into the discrete formula and comparing the result to the exact quantity it is meant to approximate. Here, we analyze the expression $\\frac{u(h) - u(-h)}{2h}$.\n\nBy subtracting the Taylor expansion for $u(-h)$ from the expansion for $u(h)$, we get:\n$$u(h) - u(-h) = \\left( u(0) + h u_x(0) + \\frac{h^2}{2} u_{xx}(0) + \\frac{h^3}{6} u_{xxx}(0) \\right) - \\left( u(0) - h u_x(0) + \\frac{h^2}{2} u_{xx}(0) - \\frac{h^3}{6} u_{xxx}(0) \\right) + \\mathcal{O}(h^5)$$\nTerms with even powers of $h$ cancel out:\n$$u(h) - u(-h) = 2h u_x(0) + \\frac{2h^3}{6} u_{xxx}(0) + \\mathcal{O}(h^5) = 2h u_x(0) + \\frac{h^3}{3} u_{xxx}(0) + \\mathcal{O}(h^5)$$\n\nDividing by $2h$ gives an expression for the centered difference approximation of the derivative:\n$$\\frac{u(h) - u(-h)}{2h} = u_x(0) + \\frac{h^2}{6} u_{xxx}(0) + \\mathcal{O}(h^4)$$\n\nThe local truncation error, $\\tau$, is the difference between the discrete approximation (using exact solution values) and the exact derivative:\n$$\\tau = \\frac{u(h) - u(-h)}{2h} - u_x(0) = \\frac{h^2}{6} u_{xxx}(0) + \\mathcal{O}(h^4)$$\nSince the leading term of the error is proportional to $h^2$, this confirms that the centered difference formula provides a second-order accurate approximation for the first derivative $u_x(0)$.\n\nHaving established the second-order accuracy of the chosen formula, we now use it to define the ghost vertex value $u_{-1}$. The numerical scheme imposes the boundary condition by setting the discrete approximation of the derivative equal to the specified value $\\gamma$. We replace the exact values $u(h)$ and $u(-h)$ with their discrete counterparts $u_1$ and $u_{-1}$. The value $u_{-1}$ is not a direct approximation of $u(-h)$ but is instead defined by the following algebraic relationship that enforces the boundary condition:\n$$\\frac{u_1 - u_{-1}}{2h} = \\gamma$$\nThis equation is the discrete implementation of the Neumann boundary condition $u_x(0) = \\gamma$, and as shown by the LTE analysis, it is a second-order accurate implementation.\n\nThe final step is to solve this equation for the ghost vertex value $u_{-1}$.\nMultiplying by $2h$:\n$$u_1 - u_{-1} = 2h\\gamma$$\nRearranging the terms to isolate $u_{-1}$:\n$$u_{-1} = u_1 - 2h\\gamma$$\nThis expression provides the value for the ghost vertex $u_{-1}$ in terms of the interior vertex value $u_1$, the mesh spacing $h$, and the boundary condition constant $\\gamma$, consistent with a second-order accurate scheme.",
            "answer": "$$\\boxed{u_1 - 2h\\gamma}$$"
        },
        {
            "introduction": "The choice of grid arrangement can have profound implications for the stability and physical realism of a simulation, particularly in fluid dynamics. This problem explores the classic issue of pressure-velocity decoupling that arises in collocated grids, where pressure and velocity are stored at the same locations. By constructing a \"checkerboard\" pressure field, you will analytically demonstrate why a simple collocated scheme fails to detect this spurious mode , whereas a staggered arrangement (like the cell-centered scheme also examined) correctly couples pressure and velocity, preventing non-physical oscillations.",
            "id": "3368859",
            "problem": "Consider the incompressible Stokes equations on the unit square domain with periodic boundary conditions in both directions. The equations are given by the momentum balance $-\\nabla p + \\mu \\Delta \\boldsymbol{u} = \\boldsymbol{0}$ and the incompressibility constraint $\\nabla \\cdot \\boldsymbol{u} = 0$, where $p$ is the pressure, $\\mu$ is the dynamic viscosity, and $\\boldsymbol{u} = (u,v)$ is the velocity. Assume a semi-discrete pressure-to-velocity update arising from a projection-type method: the predicted velocity due to a given pressure field is $\\boldsymbol{u}^{*} = -\\frac{\\Delta t}{\\rho} \\nabla p$, where $\\Delta t$ is a time step and $\\rho$ is the density. Ignore the diffusion term in this predictor stage.\n\nTwo spatial discretizations are considered on a uniform square grid with $N \\times N$ points and mesh spacing $h = \\frac{1}{N}$:\n\n1. A vertex-centered collocated arrangement with $u$, $v$, and $p$ all stored at the vertices $\\{(i,j)\\}_{i,j=0}^{N-1}$. The discrete gradient $\\nabla p$ at a vertex $(i,j)$ is approximated by the standard two-point central differences,\n$$\n\\left(\\frac{\\partial p}{\\partial x}\\right)_{i,j} = \\frac{p_{i+1,j} - p_{i-1,j}}{2h}, \n\\quad \n\\left(\\frac{\\partial p}{\\partial y}\\right)_{i,j} = \\frac{p_{i,j+1} - p_{i,j-1}}{2h}.\n$$\nDefine the face-normal predicted velocities used in the discrete divergence at vertex $(i,j)$ by linear interpolation of the nodal velocities:\n$$\nu^{*}_{i+\\frac{1}{2},j} = \\frac{u^{*}_{i+1,j} + u^{*}_{i,j}}{2}, \n\\quad \nu^{*}_{i-\\frac{1}{2},j} = \\frac{u^{*}_{i,j} + u^{*}_{i-1,j}}{2},\n$$\n$$\nv^{*}_{i,j+\\frac{1}{2}} = \\frac{v^{*}_{i,j+1} + v^{*}_{i,j}}{2}, \n\\quad \nv^{*}_{i,j-\\frac{1}{2}} = \\frac{v^{*}_{i,j} + v^{*}_{i,j-1}}{2}.\n$$\nThe discrete divergence at the vertex $(i,j)$ is then\n$$\n(\\nabla \\cdot \\boldsymbol{u}^{*})_{i,j} = \\frac{u^{*}_{i+\\frac{1}{2},j} - u^{*}_{i-\\frac{1}{2},j}}{h} + \\frac{v^{*}_{i,j+\\frac{1}{2}} - v^{*}_{i,j-\\frac{1}{2}}}{h}.\n$$\n\n2. A cell-centered arrangement with $p$ stored at cell centers $\\{(i,j)\\}_{i,j=0}^{N-1}$ and $u$ and $v$ stored at the corresponding cell faces. The discrete gradient entering the face-normal predicted velocities is taken as a one-cell difference:\n$$\nu^{*}_{i+\\frac{1}{2},j} = -\\frac{\\Delta t}{\\rho} \\frac{p_{i+1,j} - p_{i,j}}{h}, \n\\quad \nv^{*}_{i,j+\\frac{1}{2}} = -\\frac{\\Delta t}{\\rho} \\frac{p_{i,j+1} - p_{i,j}}{h}.\n$$\nThe discrete divergence at the cell center $(i,j)$ is\n$$\n(\\nabla \\cdot \\boldsymbol{u}^{*})_{i,j} = \\frac{u^{*}_{i+\\frac{1}{2},j} - u^{*}_{i-\\frac{1}{2},j}}{h} + \\frac{v^{*}_{i,j+\\frac{1}{2}} - v^{*}_{i,j-\\frac{1}{2}}}{h}.\n$$\n\nConstruct the checkerboard pressure mode as a counterexample for the collocated arrangement:\n- For the vertex-centered collocated case, define $p_{i,j} = p_{0} (-1)^{i+j}$ at the vertices, where $p_{0}$ is a constant amplitude.\n- For the cell-centered case, define $p_{i,j} = p_{0} (-1)^{i+j}$ at the cell centers.\n\nStarting from the fundamental definitions above and without introducing any additional stabilization or filtering, derive the discrete predicted velocity fields and compute the corresponding discrete divergence at a generic location $(i,j)$ for both arrangements under the checkerboard pressure mode. Then, taking the magnitude of each divergence expression and treating $p_{0}$, $\\Delta t$, $\\rho$, and $h$ as symbolic constants, compute the ratio $\\mathcal{R}$ defined as:\n$$\n\\mathcal{R} = \\frac{\\left|(\\nabla \\cdot \\boldsymbol{u}^{*})_{\\text{collocated}}\\right|}{\\left|(\\nabla \\cdot \\boldsymbol{u}^{*})_{\\text{cell-centered}}\\right|}.\n$$\n\nProvide the final answer as a single simplified real number or closed-form analytic expression. No units are required. If you choose to introduce any numerical approximation, round the final answer to four significant figures.",
            "solution": "The objective is to compute the ratio $\\mathcal{R} = \\frac{\\left|(\\nabla \\cdot \\boldsymbol{u}^{*})_{\\text{collocated}}\\right|}{\\left|(\\nabla \\cdot \\boldsymbol{u}^{*})_{\\text{cell-centered}}\\right|}$ for a specified checkerboard pressure mode. This requires deriving the discrete divergence of the predicted velocity field, $(\\nabla \\cdot \\boldsymbol{u}^{*})$, for both the vertex-centered collocated and cell-centered arrangements.\n\nFirst, we analyze the vertex-centered collocated arrangement.\nThe pressure field is defined at the vertices as $p_{i,j} = p_{0} (-1)^{i+j}$, where $p_{0}$ is a constant amplitude. The predicted velocity components at a vertex $(i,j)$ are given by $\\boldsymbol{u}^{*} = -\\frac{\\Delta t}{\\rho} \\nabla p$, where the gradient is approximated by central differences. Let's compute the components of the discrete pressure gradient at vertex $(i,j)$:\nThe $x$-component is:\n$$\n\\left(\\frac{\\partial p}{\\partial x}\\right)_{i,j} = \\frac{p_{i+1,j} - p_{i-1,j}}{2h} = \\frac{p_{0}(-1)^{(i+1)+j} - p_{0}(-1)^{(i-1)+j}}{2h}\n$$\nFactoring out common terms:\n$$\n\\left(\\frac{\\partial p}{\\partial x}\\right)_{i,j} = \\frac{p_{0}(-1)^{i+j}}{2h} \\left( (-1)^{1} - (-1)^{-1} \\right) = \\frac{p_{0}(-1)^{i+j}}{2h} \\left( -1 - (-1) \\right) = 0\n$$\nSimilarly, the $y$-component is:\n$$\n\\left(\\frac{\\partial p}{\\partial y}\\right)_{i,j} = \\frac{p_{i,j+1} - p_{i,j-1}}{2h} = \\frac{p_{0}(-1)^{i+(j+1)} - p_{0}(-1)^{i+(j-1)}}{2h}\n$$\n$$\n\\left(\\frac{\\partial p}{\\partial y}\\right)_{i,j} = \\frac{p_{0}(-1)^{i+j}}{2h} \\left( (-1)^{1} - (-1)^{-1} \\right) = \\frac{p_{0}(-1)^{i+j}}{2h} \\left( -1 - (-1) \\right) = 0\n$$\nSince the discrete pressure gradient is zero everywhere, the predicted velocity components at the vertices are also zero:\n$u^{*}_{i,j} = -\\frac{\\Delta t}{\\rho} \\left(\\frac{\\partial p}{\\partial x}\\right)_{i,j} = 0$\n$v^{*}_{i,j} = -\\frac{\\Delta t}{\\rho} \\left(\\frac{\\partial p}{\\partial y}\\right)_{i,j} = 0$\nThe divergence is computed using velocities at face centers, which are obtained by linear interpolation of the nodal velocities. Since all nodal velocities are zero, the interpolated face-normal velocities are also zero:\n$u^{*}_{i \\pm \\frac{1}{2},j} = 0$ and $v^{*}_{i,j \\pm \\frac{1}{2}} = 0$\nConsequently, the discrete divergence at the vertex $(i,j)$ is identically zero:\n$(\\nabla \\cdot \\boldsymbol{u}^{*})_{\\text{collocated}} = \\frac{u^{*}_{i+\\frac{1}{2},j} - u^{*}_{i-\\frac{1}{2},j}}{h} + \\frac{v^{*}_{i,j+\\frac{1}{2}} - v^{*}_{i,j-\\frac{1}{2}}}{h} = \\frac{0 - 0}{h} + \\frac{0 - 0}{h} = 0$\nThis demonstrates that the collocated arrangement, without stabilization, is completely insensitive to the checkerboard pressure mode.\n\nNext, we analyze the cell-centered arrangement.\nThe pressure field is defined at the cell centers as $p_{i,j} = p_{0} (-1)^{i+j}$. The predicted face-normal velocities are computed directly from pressure differences between adjacent cell centers. Let's compute the velocities on the faces of the cell $(i,j)$:\nThe velocity on the right face of the cell is:\n$$\nu^{*}_{i+\\frac{1}{2},j} = -\\frac{\\Delta t}{\\rho} \\frac{p_{i+1,j} - p_{i,j}}{h} = -\\frac{\\Delta t}{\\rho h} \\left( p_{0}(-1)^{(i+1)+j} - p_{0}(-1)^{i+j} \\right)\n$$\n$$\nu^{*}_{i+\\frac{1}{2},j} = -\\frac{\\Delta t p_{0}}{\\rho h} (-1)^{i+j} ((-1)^{1} - 1) = -\\frac{\\Delta t p_{0}}{\\rho h} (-1)^{i+j} (-2) = \\frac{2 \\Delta t p_{0}}{\\rho h} (-1)^{i+j}\n$$\nThe velocity on the left face of the cell is:\n$$\nu^{*}_{i-\\frac{1}{2},j} = -\\frac{\\Delta t}{\\rho} \\frac{p_{i,j} - p_{i-1,j}}{h} = -\\frac{\\Delta t}{\\rho h} \\left( p_{0}(-1)^{i+j} - p_{0}(-1)^{(i-1)+j} \\right)\n$$\n$$\nu^{*}_{i-\\frac{1}{2},j} = -\\frac{\\Delta t p_{0}}{\\rho h} (-1)^{i+j} (1 - (-1)^{-1}) = -\\frac{\\Delta t p_{0}}{\\rho h} (-1)^{i+j} (2) = -\\frac{2 \\Delta t p_{0}}{\\rho h} (-1)^{i+j}\n$$\nSimilarly, for the horizontal velocities on the top and bottom faces:\n$$\nv^{*}_{i,j+\\frac{1}{2}} = -\\frac{\\Delta t}{\\rho} \\frac{p_{i,j+1} - p_{i,j}}{h} = -\\frac{\\Delta t}{\\rho h} \\left( p_{0}(-1)^{i+(j+1)} - p_{0}(-1)^{i+j} \\right) = \\frac{2 \\Delta t p_{0}}{\\rho h} (-1)^{i+j}\n$$\n$$\nv^{*}_{i,j-\\frac{1}{2}} = -\\frac{\\Delta t}{\\rho} \\frac{p_{i,j} - p_{i,j-1}}{h} = -\\frac{\\Delta t}{\\rho h} \\left( p_{0}(-1)^{i+j} - p_{0}(-1)^{i+(j-1)} \\right) = -\\frac{2 \\Delta t p_{0}}{\\rho h} (-1)^{i+j}\n$$\nNow, we compute the discrete divergence at the cell center $(i,j)$:\n$$\n(\\nabla \\cdot \\boldsymbol{u}^{*})_{\\text{cell-centered}} = \\frac{u^{*}_{i+\\frac{1}{2},j} - u^{*}_{i-\\frac{1}{2},j}}{h} + \\frac{v^{*}_{i,j+\\frac{1}{2}} - v^{*}_{i,j-\\frac{1}{2}}}{h}\n$$\nSubstituting the derived expressions for face velocities:\n$$\n(\\nabla \\cdot \\boldsymbol{u}^{*})_{\\text{cell-centered}} = \\frac{1}{h} \\left( \\frac{2 \\Delta t p_{0}}{\\rho h} (-1)^{i+j} - \\left(-\\frac{2 \\Delta t p_{0}}{\\rho h} (-1)^{i+j}\\right) \\right) + \\frac{1}{h} \\left( \\frac{2 \\Delta t p_{0}}{\\rho h} (-1)^{i+j} - \\left(-\\frac{2 \\Delta t p_{0}}{\\rho h} (-1)^{i+j}\\right) \\right)\n$$\n$$\n(\\nabla \\cdot \\boldsymbol{u}^{*})_{\\text{cell-centered}} = \\frac{1}{h} \\left( \\frac{4 \\Delta t p_{0}}{\\rho h} (-1)^{i+j} \\right) + \\frac{1}{h} \\left( \\frac{4 \\Delta t p_{0}}{\\rho h} (-1)^{i+j} \\right)\n$$\n$$\n(\\nabla \\cdot \\boldsymbol{u}^{*})_{\\text{cell-centered}} = \\frac{8 \\Delta t p_{0}}{\\rho h^2} (-1)^{i+j}\n$$\nThis result is non-zero, indicating that the cell-centered (staggered) arrangement properly couples pressure and velocity for the checkerboard mode.\n\nFinally, we compute the ratio $\\mathcal{R}$.\n$$\n\\mathcal{R} = \\frac{\\left|(\\nabla \\cdot \\boldsymbol{u}^{*})_{\\text{collocated}}\\right|}{\\left|(\\nabla \\cdot \\boldsymbol{u}^{*})_{\\text{cell-centered}}\\right|} = \\frac{|0|}{\\left|\\frac{8 \\Delta t p_{0}}{\\rho h^2} (-1)^{i+j}\\right|}\n$$\nAssuming the physical and numerical constants $p_{0}, \\Delta t, \\rho,$ and $h$ are non-zero, the denominator is non-zero. The magnitude of the denominator is $\\frac{8 |\\Delta t p_{0}|}{\\rho h^2}$ since $\\rho > 0$ and $h > 0$.\n$$\n\\mathcal{R} = \\frac{0}{\\frac{8 |\\Delta t p_{0}|}{\\rho h^2}} = 0\n$$\nThe resulting ratio is exactly $0$.",
            "answer": "$$\\boxed{0}$$"
        }
    ]
}