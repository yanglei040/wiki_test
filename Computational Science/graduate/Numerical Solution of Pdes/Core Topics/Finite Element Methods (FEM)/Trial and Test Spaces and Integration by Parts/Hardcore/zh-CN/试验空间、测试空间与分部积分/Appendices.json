{
    "hands_on_practices": [
        {
            "introduction": "本节的第一个实践旨在为有限元方法提供一个基础性练习。通过对一个简单的一维边值问题应用分部积分，我们将推导出其弱形式。本练习的主要目标是理解这一过程，以及局部支撑多项式基函数的选择，如何直接决定最终刚度矩阵的稀疏结构，而稀疏性是保证计算效率的关键属性 。",
            "id": "3457915",
            "problem": "考虑区间 $\\Omega=(0,1)$ 上的二阶线性边值问题：\n求 $u:\\Omega \\to \\mathbb{R}$ 使得\n$$\n- \\big(a(x)\\,u'(x)\\big)' + c(x)\\,u(x) = f(x) \\quad \\text{for } x \\in (0,1), \\qquad u(0)=0,\\;u(1)=0,\n$$\n其中 $a \\in C^{1}([0,1])$ 对所有 $x \\in [0,1]$ 满足 $a(x)\\ge a_{0}0$，$c \\in L^{\\infty}(0,1)$ 几乎处处满足 $c(x)\\ge 0$，且 $f \\in L^{2}(0,1)$。从加权残量法原理和 Sobolev 空间 $H_{0}^{1}(0,1)$ 的定义出发，通过恰好一次分部积分推导弱形式，并用 $a(x)$、$c(x)$ 和 $f(x)$ 表示双线性形式 $a(\\cdot,\\cdot)$ 和线性泛函 $\\ell(\\cdot)$。\n\n设 $\\mathcal{T}_{h}$ 是将 $(0,1)$ 划分为 $N$ 个长度为 $h=1/N$ 的单元的均匀网格剖分。设 $V_{h} \\subset H_{0}^{1}(0,1)$ 是 $\\mathcal{T}_{h}$ 上多项式次数为 $p \\ge 1$ 的标准 $C^{0}$ 拉格朗日有限元空间，其节点基为 $\\{\\phi_{j}\\}_{j=1}^{n}$，按沿线的坐标递增排序，并设 $W_{h}=V_{h}$，其节点基为 $\\{\\psi_{i}\\}_{i=1}^{n}$，排序相同。使用有限元法（FEM），推导离散线性系统 $A\\boldsymbol{x}=\\boldsymbol{b}$，其各项为\n$$\nA_{ij} = a(\\phi_{j},\\psi_{i}), \\qquad b_{i} = \\ell(\\psi_{i}),\n$$\n通过写出单元贡献并解释如何从局部进行全局组装。\n\n然后，仅根据一维均匀网格上基函数的紧支集和重叠情况，以及分部积分后双线性形式的形式，确定组装后的全局矩阵 $A$ 中非零对角线总数（即，计算主对角线以及所有至少包含一个非零元素的上、下对角线）关于多项式次数 $p$ 的精确闭式表达式。你的最终答案必须是关于 $p$ 的单个符号表达式，不带单位。不需要数值近似或四舍五入。",
            "solution": "该问题要求推导给定边值问题的弱形式和离散系统，然后确定所得有限元矩阵中非零对角线的数量，作为多项式次数 $p$ 的函数。\n\n**第一部分：弱形式的推导**\n\n我们从边值问题的强形式开始：\n求 $u: [0,1] \\to \\mathbb{R}$ 使得\n$$\n- \\big(a(x)\\,u'(x)\\big)' + c(x)\\,u(x) = f(x) \\quad \\text{for } x \\in (0,1),\n$$\n其齐次 Dirichlet 边值条件为 $u(0)=0$ 和 $u(1)=0$。\n\n加权残量法原理要求微分方程的残量 $r(x) = f(x) + (a(x)u'(x))' - c(x)u(x)$ 与一个合适的检验函数空间正交。对于解 $u$ 和检验函数 $v$，包含了齐次边值条件的适当函数空间是 Sobolev 空间 $H_{0}^{1}(0,1)$。该空间由 $L^2(0,1)$ 中的函数组成，其弱导数也在 $L^2(0,1)$ 中，并且在迹的意义上满足边界条件 $u(0)=u(1)=0$。\n\n我们将微分方程乘以任意检验函数 $v \\in H_{0}^{1}(0,1)$，并在定义域 $\\Omega = (0,1)$ 上积分：\n$$\n\\int_{0}^{1} \\left( - \\big(a(x)\\,u'(x)\\big)' + c(x)\\,u(x) \\right) v(x) \\, dx = \\int_{0}^{1} f(x) v(x) \\, dx.\n$$\n我们对涉及二阶导数的项应用分部积分。对于任意函数 $u \\in H^2(0,1)$ 和 $v \\in H^1(0,1)$，分部积分公式为：\n$$\n\\int_{0}^{1} - \\big(a(x)\\,u'(x)\\big)' v(x) \\, dx = - \\Big[ a(x)\\,u'(x)\\,v(x) \\Big]_{0}^{1} + \\int_{0}^{1} a(x)\\,u'(x)\\,v'(x) \\, dx.\n$$\n由于检验函数 $v$ 属于 $H_{0}^{1}(0,1)$，它满足 $v(0)=0$ 和 $v(1)=0$。因此，边界项为零：\n$$\n- \\Big[ a(x)\\,u'(x)\\,v(x) \\Big]_{0}^{1} = - \\big( a(1)\\,u'(1)\\,v(1) - a(0)\\,u'(0)\\,v(0) \\big) = 0.\n$$\n将此代回积分方程得到：\n$$\n\\int_{0}^{1} a(x)\\,u'(x)\\,v'(x) \\, dx + \\int_{0}^{1} c(x)\\,u(x)\\,v(x) \\, dx = \\int_{0}^{1} f(x) v(x) \\, dx.\n$$\n此方程必须对所有 $v \\in H_{0}^{1}(0,1)$ 成立。这就是问题的弱形式。\n\n我们可以将其表示为标准形式：求 $u \\in H_{0}^{1}(0,1)$ 使得\n$$\na(u,v) = \\ell(v) \\quad \\forall v \\in H_{0}^{1}(0,1),\n$$\n其中 $a(\\cdot,\\cdot)$ 是一个双线性形式，$\\ell(\\cdot)$ 是一个线性泛函。通过与推导出的方程进行比较，我们确定：\n双线性形式 $a(\\cdot,\\cdot): H_{0}^{1}(0,1) \\times H_{0}^{1}(0,1) \\to \\mathbb{R}$ 由下式给出：\n$$\na(u,v) = \\int_{0}^{1} \\big( a(x)\\,u'(x)\\,v'(x) + c(x)\\,u(x)\\,v(x) \\big) \\, dx.\n$$\n线性泛函 $\\ell(\\cdot): H_{0}^{1}(0,1) \\to \\mathbb{R}$ 由下式给出：\n$$\n\\ell(v) = \\int_{0}^{1} f(x)\\,v(x) \\, dx.\n$$\n关于 $a(x)$、$c(x)$ 和 $f(x)$ 的条件确保了这些积分是良定义的，并且双线性形式是连续的和强制的，从而根据 Lax-Milgram 定理保证了唯一解的存在。\n\n**第二部分：离散线性系统的推导**\n\n在有限元法（FEM）中，我们在有限维子空间 $V_h \\subset H_{0}^{1}(0,1)$ 中寻求近似解 $u_h$。问题指出，$V_h$ 是在均匀网格 $\\mathcal{T}_h$ 上的连续、分片多项式空间，其次数为 $p \\ge 1$。设 $\\{\\phi_j\\}_{j=1}^{n}$ 是 $V_h$ 的一个节点基。近似解可以写成这些基函数的线性组合：\n$$\nu_h(x) = \\sum_{j=1}^{n} x_j \\phi_j(x),\n$$\n其中 $\\boldsymbol{x} = (x_1, \\dots, x_n)^T$ 是未知系数的向量，这些系数对应于 $u_h$ 在网格内部节点处的值。\n\nGalerkin 方法将试探空间设置为与检验空间相等，即 $W_h=V_h$。离散问题是求 $u_h \\in V_h$ 使得对所有 $v_h \\in V_h$ 都有 $a(u_h, v_h) = \\ell(v_h)$。由于 $V_h$ 由基函数 $\\{\\psi_i\\}_{i=1}^{n}$（与 $\\{\\phi_i\\}_{i=1}^{n}$ 相同）张成，因此只需对每个基函数强制执行此条件：\n$$\na(u_h, \\psi_i) = \\ell(\\psi_i) \\quad \\text{for } i=1, \\dots, n.\n$$\n代入 $u_h$ 的展开式，并利用 $a(\\cdot, \\cdot)$ 在其第一个参数上的线性性，我们得到：\n$$\na\\left(\\sum_{j=1}^{n} x_j \\phi_j, \\psi_i\\right) = \\sum_{j=1}^{n} x_j a(\\phi_j, \\psi_i) = \\ell(\\psi_i) \\quad \\text{for } i=1, \\dots, n.\n$$\n这是一个关于 $n$ 个未知数 $x_j$ 的 $n$ 个线性方程组。我们可以将其写成矩阵形式 $A\\boldsymbol{x} = \\boldsymbol{b}$，其中矩阵 $A$（刚度矩阵）和向量 $\\boldsymbol{b}$（载荷向量）的各项由下式给出：\n$$\nA_{ij} = a(\\phi_j, \\psi_i) = \\int_{0}^{1} \\big( a(x)\\,\\phi_j'(x)\\,\\psi_i'(x) + c(x)\\,\\phi_j(x)\\,\\psi_i(x) \\big) \\, dx,\n$$\n$$\nb_i = \\ell(\\psi_i) = \\int_{0}^{1} f(x)\\,\\psi_i(x) \\, dx.\n$$\n全局矩阵 $A$ 和向量 $\\boldsymbol{b}$ 是由网格 $\\mathcal{T}_h$ 中每个单元 $K_e$ 的局部贡献组装而成的。对于每个单元 $K_e$，使用限制在 $K_e$ 上的积分和局部基函数来计算单元矩阵 $A^e$ 和单元向量 $\\boldsymbol{b}^e$。例如，$(A^e)_{\\alpha\\beta} = \\int_{K_e} (\\dots) dx$。然后，根据属于单元 $K_e$ 的节点的全局索引，将这些局部矩阵/向量的项加到全局矩阵/向量的相应位置。\n\n**第三部分：非零对角线的数量**\n\n全局矩阵 $A$ 的稀疏结构由基函数的支集决定。具体来说，矩阵项 $A_{ij} = a(\\phi_j, \\psi_i)$ 非零，当且仅当基函数 $\\phi_j$ 和 $\\psi_i$（这里 $\\psi_i = \\phi_i$）的支集有重叠。由于拉格朗日基函数的支集是局部的，这意味着 $A_{ij}$ 非零当且仅当节点 $i$ 和节点 $j$ 属于同一个单元。\n\n我们的目标是确定矩阵的半带宽（half-bandwidth）$w$，它定义为 $w = \\max \\{ |i-j| \\mid A_{ij} \\neq 0 \\}$。非零对角线的总数则为 $2w+1$。\n\n我们使用 $C^0$ 拉格朗日有限元，多项式次数为 $p$。在每个单元上，有 $p+1$ 个节点。由于基函数是按节点坐标递增排序进行全局索引的，我们来分析索引之间的最大差值。\n\n考虑任意一个节点 $i$。它所关联的基函数 $\\phi_i$ 只在包含节点 $i$ 的单元上非零。\n1. 如果节点 $i$ 是一个单元的内部节点，那么它只属于这一个单元。它将与该单元上的其他 $p$ 个节点相互作用。这些节点的全局索引是连续的。如果这些索引是 $k, k+1, \\dots, k+p$，那么最大的索引差是 $p$。\n2. 如果节点 $i$ 是一个内部顶点（例如 $x_k$），它被两个相邻的单元（例如 $[x_{k-1}, x_k]$ 和 $[x_k, x_{k+1}]$）共享。因此，它会与这两个单元上的所有其他节点相互作用。\n        \n让我们来确定与一个内部顶点 $i$ 相互作用的节点的索引范围。假设节点按其物理坐标位置从左到右进行全局编号。一个次数为 $p$ 的单元包含 $p+1$ 个节点。\n- 考虑左侧单元 $[x_{k-1}, x_k]$。它包含 $p+1$ 个节点。如果我们将顶点 $i$（位于 $x_k$）的索引设为 $I$，那么该单元中最左侧节点的索引将是 $I-p$。\n- 考虑右侧单元 $[x_k, x_{k+1}]$。它也包含 $p+1$ 个节点。最右侧节点的索引将是 $I+p$。\n        \n因此，节点 $i$（索引为 $I$）会与索引范围从 $I-p$ 到 $I+p$ 的所有节点相互作用，只要这些节点与它共享一个单元。对于行 $I$，非零列的索引 $j$ 满足 $|I-j| \\le p$。\n        \n因此，矩阵的半带宽 $w = \\max |i-j| = p$。\n\n非零对角线的总数是主对角线（1），加上上方的 $p$ 条对角线，再加上下方的 $p$ 条对角线。总数为：\n$$ 1 + p + p = 2p+1 $$",
            "answer": "$$\n\\boxed{2p+1}\n$$"
        },
        {
            "introduction": "现实世界中的应用常常涉及带有曲线边界的区域，这给数值积分带来了挑战。本实践将深入探讨分部积分在此类区域上的实际应用，重点关注由此产生的边界项。你将需要对一个曲线单元执行变量替换，计算几何雅可比行列式，并量化在实践中常用的一种简化方法——用直线近似曲线边界——所引入的误差 。",
            "id": "3457854",
            "problem": "考虑单个曲线有限元子域 $K \\subset \\mathbb{R}^{2}$ 上的标量泊松问题，其一条边界边 $\\Gamma \\subset \\partial K$ 位于半径为 $R0$ 的圆弧上。设 $u \\in H^{1}(K)$ 为试探函数，$v \\in H^{1}(K)$ 为检验函数。假设在 $\\Gamma$ 上有诺伊曼边界条件 $\\kappa \\nabla u \\cdot n = g$，其中 $\\kappa0$ 是常数，$g$ 在 $\\Gamma$ 上足够光滑，并在其余边界边上施加齐次条件。通过分部积分得到的 $K$ 上的弱形式为\n$$\n\\int_{K} \\kappa \\nabla u \\cdot \\nabla v \\, \\mathrm{d}x - \\int_{\\Gamma} g \\, v \\, \\mathrm{d}s = \\int_{K} f \\, v \\, \\mathrm{d}x.\n$$\n设 $F : \\hat{K} \\to K$ 是从参考正方形 $\\hat{K} = [-1,1] \\times [-1,1]$（坐标为 $(\\xi,\\eta)$）到 $K$ 的一个等参数映射。假设参考顶边 $\\hat{e} = \\{ (\\xi,\\eta) \\in \\hat{K} : \\eta = 1, \\, \\xi \\in [-1,1] \\}$ 通过边的限制 $F_{e}(\\xi) = \\left( x(\\xi), y(\\xi) \\right)$ 映射到曲线边界 $\\Gamma$，该限制由一个圆弧参数化给出\n$$\nx(\\xi) = R \\cos\\big(\\theta(\\xi)\\big), \\quad y(\\xi) = R \\sin\\big(\\theta(\\xi)\\big), \\quad \\theta(\\xi) = \\theta_{c} + \\frac{\\Delta \\theta}{2} \\, \\xi,\n$$\n其中 $\\theta_{c} \\in \\mathbb{R}$ 为固定值，张角 $\\Delta \\theta \\in (0,\\pi]$。假设试探和检验空间由标准等参二次映射构造：$K$ 上的离散空间是 $\\hat{K}$ 上的 2 次张量积多项式空间的拉回，在边界边 $\\hat{e}$ 上，边中点基函数限制为 $\\hat{N}_{m}(\\xi) = 1 - \\xi^{2}$。\n\n弱形式中的边界积分在映射 $F$ 下变换为\n$$\n\\int_{\\Gamma} g \\, v \\, \\mathrm{d}s \\;=\\; \\int_{-1}^{1} \\hat{g}(\\xi) \\, \\hat{v}(\\xi) \\, J_{e}(\\xi) \\, \\mathrm{d}\\xi,\n$$\n其中 $\\hat{g}(\\xi) = g\\big(F_{e}(\\xi)\\big)$，$\\hat{v}(\\xi) = v\\big(F_{e}(\\xi)\\big)$，且 $J_{e}(\\xi) = \\left| \\frac{\\partial F_{e}}{\\partial \\xi}(\\xi) \\right|$ 是沿着曲线边的一维雅可比行列式（度量）。在许多数值实现中，度量 $J_{e}(\\xi)$ 是通过将曲线边替换为其直弦来近似的，即通过从 $\\hat{e}$到连接端点 $F_{e}(-1)$ 和 $F_{e}(1)$ 的弦的线性映射，这会导出一个常数的弦雅可比行列式 $J_{\\mathrm{chord}}$。\n\n假设诺伊曼数据在 $\\Gamma$ 上为常数，即 $g \\equiv \\bar{g}$，其中 $\\bar{g} \\in \\mathbb{R}$。考虑一个离散检验函数，其在 $\\Gamma$ 上的限制是边中点基函数 $\\hat{N}_{m}(\\xi) = 1 - \\xi^{2}$ 的拉回。令 $L_{\\mathrm{exact}}$ 表示精确的边界线性泛函贡献，$L_{\\mathrm{approx}}$ 表示通过用弦雅可比行列式近似度量而获得的贡献。定义由度量引起的边界求积误差\n$$\nE \\;=\\; L_{\\mathrm{exact}} \\;-\\; L_{\\mathrm{approx}}.\n$$\n仅使用给定的设定和第一性原理（变量代换和散度定理），以 $\\bar{g}$、$R$ 和 $\\Delta \\theta$ 的形式显式地推导出 $E$ 的闭合形式。假设所有量都是无量纲的。您的最终答案必须是一个单一的闭合形式解析表达式，不含未求值的积分或极限。",
            "solution": "目标是计算由度量引起的边界求积误差 $E$，其定义为精确边界积分贡献 $L_{\\mathrm{exact}}$ 与近似贡献 $L_{\\mathrm{approx}}$ 之间的差。误差由下式给出\n$$\nE = L_{\\mathrm{exact}} - L_{\\mathrm{approx}}\n$$\n问题指明诺伊曼边界数据 $g$ 是一个常数，$g \\equiv \\bar{g}$，并且选择检验函数 $v$，使其在参考边 $\\hat{e} = [-1,1]$ 上的拉回是二次基函数 $\\hat{v}(\\xi) = \\hat{N}_{m}(\\xi) = 1 - \\xi^{2}$。\n\n曲线边界 $\\Gamma$ 上的边界积分变换为参考区间 $[-1,1]$ 上的积分：\n$$\n\\int_{\\Gamma} g \\, v \\, \\mathrm{d}s = \\int_{-1}^{1} g(F_e(\\xi)) \\, v(F_e(\\xi)) \\, J_e(\\xi) \\, \\mathrm{d}\\xi = \\int_{-1}^{1} \\hat{g}(\\xi) \\, \\hat{v}(\\xi) \\, J_e(\\xi) \\, \\mathrm{d}\\xi\n$$\n其中 $J_e(\\xi)$ 是从 $\\hat{e}$ 到 $\\Gamma$ 变换的雅可比行列式。\n\n对于给定的常数 $g = \\bar{g}$ 和指定的拉回检验函数 $\\hat{v}(\\xi) = 1-\\xi^2$，精确和近似的线性泛函为：\n$$\nL_{\\mathrm{exact}} = \\int_{-1}^{1} \\bar{g} (1 - \\xi^{2}) J_e(\\xi) \\, \\mathrm{d}\\xi\n$$\n$$\nL_{\\mathrm{approx}} = \\int_{-1}^{1} \\bar{g} (1 - \\xi^{2}) J_{\\mathrm{chord}} \\, \\mathrm{d}\\xi\n$$\n其中 $J_e(\\xi)$ 是圆弧参数化的精确度量（雅可比行列式），而 $J_{\\mathrm{chord}}$ 是其基于弦长的近似。\n\n首先，我们推导精确度量 $J_e(\\xi)$。弧 $\\Gamma$ 的参数化由 $F_e(\\xi) = (x(\\xi), y(\\xi))$ 给出，其中\n$$\nx(\\xi) = R \\cos\\big(\\theta(\\xi)\\big), \\quad y(\\xi) = R \\sin\\big(\\theta(\\xi)\\big), \\quad \\theta(\\xi) = \\theta_{c} + \\frac{\\Delta \\theta}{2} \\xi\n$$\n映射关于 $\\xi$ 的导数为 $\\frac{\\partial F_e}{\\partial \\xi} = \\left(\\frac{\\mathrm{d}x}{\\mathrm{d}\\xi}, \\frac{\\mathrm{d}y}{\\mathrm{d}\\xi}\\right)$。我们有 $\\frac{\\mathrm{d}\\theta}{\\mathrm{d}\\xi} = \\frac{\\Delta\\theta}{2}$。\n$$\n\\frac{\\mathrm{d}x}{\\mathrm{d}\\xi} = -R \\sin(\\theta(\\xi)) \\frac{\\mathrm{d}\\theta}{\\mathrm{d}\\xi} = -R \\frac{\\Delta\\theta}{2} \\sin(\\theta(\\xi))\n$$\n$$\n\\frac{\\mathrm{d}y}{\\mathrm{d}\\xi} = R \\cos(\\theta(\\xi)) \\frac{\\mathrm{d}\\theta}{\\mathrm{d}\\xi} = R \\frac{\\Delta\\theta}{2} \\cos(\\theta(\\xi))\n$$\n度量 $J_e(\\xi)$ 是该切向量的模长：\n$$\nJ_e(\\xi) = \\left| \\frac{\\partial F_e}{\\partial \\xi} \\right| = \\sqrt{\\left(\\frac{\\mathrm{d}x}{\\mathrm{d}\\xi}\\right)^2 + \\left(\\frac{\\mathrm{d}y}{\\mathrm{d}\\xi}\\right)^2}\n= \\sqrt{\\left(-R \\frac{\\Delta\\theta}{2} \\sin(\\theta(\\xi))\\right)^2 + \\left(R \\frac{\\Delta\\theta}{2} \\cos(\\theta(\\xi))\\right)^2}\n$$\n$$\nJ_e(\\xi) = \\sqrt{R^2 \\left(\\frac{\\Delta\\theta}{2}\\right)^2 \\left(\\sin^2(\\theta(\\xi)) + \\cos^2(\\theta(\\xi))\\right)} = \\sqrt{R^2 \\left(\\frac{\\Delta\\theta}{2}\\right)^2} = \\left| R \\frac{\\Delta\\theta}{2} \\right|\n$$\n给定 $R  0$ 和 $\\Delta\\theta \\in (0, \\pi]$，$J_e(\\xi)$ 是一个正常数：\n$$\nJ_e(\\xi) = R \\frac{\\Delta\\theta}{2}\n$$\n现在我们计算 $L_{\\mathrm{exact}}$：\n$$\nL_{\\mathrm{exact}} = \\int_{-1}^{1} \\bar{g} (1 - \\xi^{2}) \\left(R \\frac{\\Delta\\theta}{2}\\right) \\, \\mathrm{d}\\xi = \\bar{g} R \\frac{\\Delta\\theta}{2} \\int_{-1}^{1} (1 - \\xi^{2}) \\, \\mathrm{d}\\xi\n$$\n积分计算结果为：\n$$\n\\int_{-1}^{1} (1 - \\xi^{2}) \\, \\mathrm{d}\\xi = \\left[\\xi - \\frac{\\xi^3}{3}\\right]_{-1}^{1} = \\left(1 - \\frac{1}{3}\\right) - \\left(-1 - \\frac{(-1)^3}{3}\\right) = \\frac{2}{3} - \\left(-1 + \\frac{1}{3}\\right) = \\frac{2}{3} - \\left(-\\frac{2}{3}\\right) = \\frac{4}{3}\n$$\n将此结果代回得到 $L_{\\mathrm{exact}}$：\n$$\nL_{\\mathrm{exact}} = \\bar{g} R \\frac{\\Delta\\theta}{2} \\cdot \\frac{4}{3} = \\frac{2}{3} \\bar{g} R \\Delta\\theta\n$$\n接下来，我们推导近似的弦雅可比行列式 $J_{\\mathrm{chord}}$。这是由从 $\\hat{e}=[-1,1]$（长度为 2）到连接端点 $F_e(-1)$ 和 $F_e(1)$ 的弦的线性映射导出的。设该弦的长度为 $L_{\\mathrm{chord}}$。\n端点对应的角度为 $\\theta_{-1} = \\theta_c - \\frac{\\Delta\\theta}{2}$ 和 $\\theta_{1} = \\theta_c + \\frac{\\Delta\\theta}{2}$。坐标为 $P_{-1} = (R\\cos\\theta_{-1}, R\\sin\\theta_{-1})$ 和 $P_{1} = (R\\cos\\theta_{1}, R\\sin\\theta_{1})$。\n弦长的平方为：\n$$\nL_{\\mathrm{chord}}^2 = (R\\cos\\theta_{1} - R\\cos\\theta_{-1})^2 + (R\\sin\\theta_{1} - R\\sin\\theta_{-1})^2\n$$\n使用三角恒等式 $\\cos A - \\cos B = -2\\sin\\frac{A+B}{2}\\sin\\frac{A-B}{2}$ 和 $\\sin A - \\sin B = 2\\cos\\frac{A+B}{2}\\sin\\frac{A-B}{2}$，其中 $\\frac{A+B}{2}=\\theta_c$ 和 $\\frac{A-B}{2}=\\frac{\\Delta\\theta}{2}$：\n$$\nL_{\\mathrm{chord}}^2 = R^2 \\left(-2\\sin\\theta_c\\sin\\frac{\\Delta\\theta}{2}\\right)^2 + R^2 \\left(2\\cos\\theta_c\\sin\\frac{\\Delta\\theta}{2}\\right)^2\n$$\n$$\nL_{\\mathrm{chord}}^2 = 4R^2\\sin^2\\left(\\frac{\\Delta\\theta}{2}\\right) \\left(\\sin^2\\theta_c + \\cos^2\\theta_c\\right) = 4R^2\\sin^2\\left(\\frac{\\Delta\\theta}{2}\\right)\n$$\n由于 $\\Delta\\theta \\in (0, \\pi]$，所以 $\\frac{\\Delta\\theta}{2} \\in (0, \\pi/2]$，因此 $\\sin(\\frac{\\Delta\\theta}{2}) \\ge 0$。于是，\n$$\nL_{\\mathrm{chord}} = 2R\\sin\\left(\\frac{\\Delta\\theta}{2}\\right)\n$$\n常数弦雅可比行列式是弦长与参考区间长度的比值：\n$$\nJ_{\\mathrm{chord}} = \\frac{L_{\\mathrm{chord}}}{2} = \\frac{2R\\sin(\\frac{\\Delta\\theta}{2})}{2} = R\\sin\\left(\\frac{\\Delta\\theta}{2}\\right)\n$$\n现在我们计算 $L_{\\mathrm{approx}}$：\n$$\nL_{\\mathrm{approx}} = \\int_{-1}^{1} \\bar{g} (1 - \\xi^{2}) J_{\\mathrm{chord}} \\, \\mathrm{d}\\xi = \\bar{g} R \\sin\\left(\\frac{\\Delta\\theta}{2}\\right) \\int_{-1}^{1} (1 - \\xi^{2}) \\, \\mathrm{d}\\xi\n$$\n使用相同的积分值 $\\frac{4}{3}$：\n$$\nL_{\\mathrm{approx}} = \\bar{g} R \\sin\\left(\\frac{\\Delta\\theta}{2}\\right) \\cdot \\frac{4}{3} = \\frac{4}{3} \\bar{g} R \\sin\\left(\\frac{\\Delta\\theta}{2}\\right)\n$$\n最后，我们计算误差 $E = L_{\\mathrm{exact}} - L_{\\mathrm{approx}}$：\n$$\nE = \\frac{2}{3} \\bar{g} R \\Delta\\theta - \\frac{4}{3} \\bar{g} R \\sin\\left(\\frac{\\Delta\\theta}{2}\\right)\n$$\n提取公因式得到误差的最终表达式：\n$$\nE = \\frac{2}{3} \\bar{g} R \\left( \\Delta\\theta - 2\\sin\\left(\\frac{\\Delta\\theta}{2}\\right) \\right)\n$$",
            "answer": "$$\\boxed{\\frac{2}{3} \\bar{g} R \\left( \\Delta\\theta - 2\\sin\\left(\\frac{\\Delta\\theta}{2}\\right) \\right)}$$"
        },
        {
            "introduction": "分部积分是一种功能强大的工具，其应用可扩展到区域分解等高级公式。在本次实践中，我们将分部积分应用于子区域，以推导出一个使用拉格朗日乘子弱耦合非匹配网格的鞍点问题。你的任务是通过研究 inf-sup 常数来分析此公式的稳定性，这将揭示一个方法的稳健性如何关键地依赖于试验空间和检验空间（特别是乘子空间）的选择 。",
            "id": "3457912",
            "problem": "考虑单位正方形域 $\\Omega = (0,1)\\times(0,1)$ 上的标量泊松问题，其具有齐次狄利克雷边界条件，由偏微分方程(PDE) $-\\Delta u = f$ 在 $\\Omega$ 中和 $u=0$ 在 $\\partial\\Omega$ 上控制。将 $\\Omega$分解为两个不重叠的子域 $\\Omega_1 = (0,1/2)\\times(0,1)$ 和 $\\Omega_2 = (1/2,1)\\times(0,1)$，其界面为 $\\Gamma = \\{1/2\\}\\times(0,1)$。令 $u_1$ 和 $u_2$ 分别表示 $u$ 在 $\\Omega_1$ 和 $\\Omega_2$ 上的限制。利用分别应用于 $\\Omega_1$ 和 $\\Omega_2$ 的分部积分，构建一个鞍点弱问题，其中跨 $\\Gamma$ 的迹的连续性由一个定义在 $\\Gamma$ 上的拉格朗日乘子 $\\lambda$ 弱施加，其界面双线性形式为 $\\int_{\\Gamma} \\lambda\\,(u_1 - u_2)\\,\\mathrm{d}s$ 类型。确定 $u_i$ 的合适试探空间和 $\\lambda$ 的测试空间，并清晰地陈述所得的耦合变分形式。\n\n接下来，考虑一个非匹配网格设置：在 $\\Omega_1$ 上使用网格尺寸为 $h_1 = h$ 的拟一致协调三角剖分和分片线性连续有限元；在 $\\Omega_2$ 上使用网格尺寸为 $h_2 = 2h$ 的拟一致协调三角剖分和分片线性连续有限元。因此，离散函数在 $\\Gamma$ 上的迹是非匹配的。在 $\\Gamma$ 上，定义一个砂浆乘子空间 $M_h$，由在 $\\Gamma$ 的一个段长为 $2h$ 的剖分（匹配较粗的右侧迹网格）上的分片常数函数组成。考虑乘子空间上的两种范数：\n- 第一个选择是 $L^2(\\Gamma)$ 范数，即 $\\|\\lambda_h\\|_{M} = \\|\\lambda_h\\|_{L^2(\\Gamma)}$。\n- 第二个选择是 $H^{-1/2}(\\Gamma)$ 范数，即 $\\|\\lambda_h\\|_{M} = \\|\\lambda_h\\|_{H^{-1/2}(\\Gamma)}$，理解为 $H^{1/2}(\\Gamma)$ 迹空间的对偶范数。\n\n令原始离散空间为 $V_h = V_{1,h}\\times V_{2,h}$，其中 $V_{i,h}\\subset H^1(\\Omega_i)$ 是相应的分片线性协调有限元空间，并为 $V_h$ 配备能量范数 $\\|(u_{1,h},u_{2,h})\\|_V = \\left(\\|\\nabla u_{1,h}\\|_{L^2(\\Omega_1)}^2 + \\|\\nabla u_{2,h}\\|_{L^2(\\Omega_2)}^2\\right)^{1/2}$。定义界面双线性形式 $b(\\lambda_h,(u_{1,h},u_{2,h})) = \\int_{\\Gamma} \\lambda_h\\left(\\gamma u_{1,h} - \\gamma u_{2,h}\\right)\\,\\mathrm{d}s$，其中 $\\gamma$ 表示到 $\\Gamma$ 上的迹算子。\n\n对于每种砂浆范数的选择，通过离散 inf-sup 常数来分析耦合鞍点问题的稳定性\n$$\n\\beta_M(h) \\;=\\; \\inf_{\\lambda_h\\in M_h\\setminus\\{0\\}} \\;\\sup_{(u_{1,h},u_{2,h})\\in V_h\\setminus\\{0\\}} \\;\\frac{b(\\lambda_h,(u_{1,h},u_{2,h}))}{\\|\\lambda_h\\|_{M}\\,\\|(u_{1,h},u_{2,h})\\|_V}\\,.\n$$\n从基本定律和核心定义（分部积分、迹定理、$H^{1/2}(\\Gamma)$ 和 $H^{-1/2}(\\Gamma)$ 的对偶性以及有限元空间的标准性质）出发，推导当 $h\\to 0$ 时，对于两种砂浆范数的选择，$\\beta_M(h)$ 的领阶渐近标度。特别地，确定指数 $\\alpha_{L^2}$ 和 $\\alpha_{H^{-1/2}}$，使得 $\\beta_{L^2}(h) \\approx C\\,h^{\\alpha_{L^2}}$ 和 $\\beta_{H^{-1/2}}(h) \\approx C'\\,h^{\\alpha_{H^{-1/2}}}$，其中 $C$ 和 $C'$ 是与 $h$ 无关的正常数。\n\n你的最终答案必须是指数对，表示为单个行矩阵。不需要四舍五入，也不涉及物理单位。请以其精确的解析形式表示该行矩阵。",
            "solution": "该问题分为两个主要部分：首先，推导在分解域上的泊松问题的鞍点弱形式；其次，对此形式的特定非匹配网格离散化进行稳定性分析。\n\n### 第一部分：连续弱形式\n\n我们从两个子域 $\\Omega_1$ 和 $\\Omega_2$ 上的泊松问题的强形式开始：\n$$\n\\begin{cases}\n-\\Delta u_1 = f  \\text{在 } \\Omega_1, \\\\\n-\\Delta u_2 = f  \\text{在 } \\Omega_2.\n\\end{cases}\n$$\n全局解 $u$ 要求在界面 $\\Gamma$ 上是连续的且具有连续的法向通量，并在外边界 $\\partial\\Omega$ 上满足齐次狄利克雷条件 $u=0$。这对 $u_1$ 和 $u_2$ 转化为以下条件：\n\\begin{enumerate}\n    \\item 边界条件：在 $\\partial\\Omega_1 \\cap \\partial\\Omega$ 上 $u_1=0$，在 $\\partial\\Omega_2 \\cap \\partial\\Omega$ 上 $u_2=0$。\n    \\item 在 $\\Gamma$ 上的界面条件：\n        \\begin{itemize}\n            \\item 解的连续性：$u_1 = u_2$。\n            \\item 法向通量的连续性：$\\frac{\\partial u_1}{\\partial n_1} + \\frac{\\partial u_2}{\\partial n_2} = 0$，其中 $n_1$ 和 $n_2$ 分别是 $\\Omega_1$ 和 $\\Omega_2$ 的外单位法向量。在 $\\Gamma$ 上，我们有 $n_1 = -n_2$。\n        \\end{itemize}\n\\end{enumerate}\n\n为了推导弱形式，我们引入测试函数 $v_1$ 和 $v_2$。我们为试探函数 $(u_1, u_2)$ 和测试函数 $(v_1, v_2)$ 定义函数空间为 $V = V_1 \\times V_2$，其中\n$$ V_i = \\{w \\in H^1(\\Omega_i) \\mid w = 0 \\text{ on } \\partial\\Omega_i \\cap \\partial\\Omega \\}, \\quad \\text{for } i=1,2. $$\n我们将每个子域中的偏微分方程乘以相应的测试函数 $v_i \\in V_i$ 并在 $\\Omega_i$ 上积分。应用分部积分（格林第一恒等式），我们得到：\n$$\n\\int_{\\Omega_1} \\nabla u_1 \\cdot \\nabla v_1 \\, \\mathrm{d}x - \\int_{\\partial\\Omega_1} v_1 \\frac{\\partial u_1}{\\partial n_1} \\, \\mathrm{d}s = \\int_{\\Omega_1} f v_1 \\, \\mathrm{d}x.\n$$\n$$\n\\int_{\\Omega_2} \\nabla u_2 \\cdot \\nabla v_2 \\, \\mathrm{d}x - \\int_{\\partial\\Omega_2} v_2 \\frac{\\partial u_2}{\\partial n_2} \\, \\mathrm{d}s = \\int_{\\Omega_2} f v_2 \\, \\mathrm{d}x.\n$$\n由于在 $\\partial\\Omega_i \\cap \\partial\\Omega$ 上 $v_i=0$，边界积分仅在界面 $\\Gamma$ 上非零。将两个方程相加得到：\n$$\n\\sum_{i=1,2} \\int_{\\Omega_i} \\nabla u_i \\cdot \\nabla v_i \\, \\mathrm{d}x - \\int_{\\Gamma} \\left( v_1 \\frac{\\partial u_1}{\\partial n_1} + v_2 \\frac{\\partial u_2}{\\partial n_2} \\right) \\mathrm{d}s = \\sum_{i=1,2} \\int_{\\Omega_i} f v_i \\, \\mathrm{d}x.\n$$\n通量连续性条件可用于在界面上定义一个单一量，即代表通量的拉格朗日乘子 $\\lambda$。我们定义 $\\lambda = \\frac{\\partial u_1}{\\partial n_1}|_\\Gamma$。根据通量连续性，我们有 $\\frac{\\partial u_2}{\\partial n_2}|_\\Gamma = -\\lambda$。将其代入界面积分得到：\n$$\n\\int_{\\Gamma} \\left(v_1 \\lambda - v_2 \\lambda \\right) \\mathrm{d}s = \\int_{\\Gamma} \\lambda (v_1 - v_2) \\, \\mathrm{d}s.\n$$\n在 $\\Gamma$ 上的连续性条件 $u_1=u_2$ 被弱施加。我们引入一个乘子测试空间 $M$。对于连续问题，乘子 $\\lambda$（代表通量，即法向导数）的合适空间是 $M = H^{-1/2}(\\Gamma)$，即迹空间 $H^{1/2}(\\Gamma)$ 的对偶空间。连续性的弱施加表示为：\n$$\n\\int_{\\Gamma} \\mu (u_1 - u_2) \\, \\mathrm{d}s = 0, \\quad \\forall \\mu \\in M.\n$$\n现在我们组装完整的鞍点问题。令 $u=(u_1, u_2)$ 和 $v=(v_1, v_2)$。定义双线性形式和线性泛函：\n$$\na(u,v) = \\sum_{i=1,2} \\int_{\\Omega_i} \\nabla u_i \\cdot \\nabla v_i \\, \\mathrm{d}x,\n$$\n$$\nb(\\mu, v) = \\int_{\\Gamma} \\mu (\\gamma v_1 - \\gamma v_2) \\, \\mathrm{d}s,\n$$\n$$\nL(v) = \\sum_{i=1,2} \\int_{\\Omega_i} f v_i \\, \\mathrm{d}x.\n$$\n这里，$\\gamma$ 是到 $\\Gamma$ 上的迹算子。问题陈述建议在第一个变分方程中使用带有正号的双线性形式 $b(\\lambda, v)$。这对应于定义 $\\lambda = -\\frac{\\partial u_1}{\\partial n_1}|_\\Gamma$。根据这个约定，系统为：\n求 $(u, \\lambda) \\in V \\times M$ 使得\n$$\n\\begin{cases}\na(u,v) + b(\\lambda,v) = L(v)  \\forall v \\in V, \\\\\nb(\\mu, u) = 0  \\forall \\mu \\in M.\n\\end{cases}\n$$\n这就是耦合变分形式。\n\n### 第二部分：离散稳定性分析\n\n我们现在分析给定离散化的稳定性。离散空间为 $V_h = V_{1,h} \\times V_{2,h}$ 和 $M_h$。稳定性由离散 inf-sup (或 LBB) 常数决定：\n$$\n\\beta_M(h) \\;=\\; \\inf_{\\lambda_h\\in M_h\\setminus\\{0\\}} \\;\\sup_{v_h\\in V_h\\setminus\\{0\\}} \\;\\frac{b(\\lambda_h,v_h)}{\\|\\lambda_h\\|_{M}\\,\\|v_h\\|_V}\\,,\n$$\n其中 $v_h=(v_{1,h}, v_{2,h})$ 且 $\\|v_h\\|_V^2 = \\|\\nabla v_{1,h}\\|_{L^2(\\Omega_1)}^2 + \\|\\nabla v_{2,h}\\|_{L^2(\\Omega_2)}^2$。我们需要针对两种范数 $\\|\\cdot\\|_M$ 的选择，找到 $\\beta_M(h)$ 随 $h$ 变化的标度。\n\n#### 情况1：$H^{-1/2}(\\Gamma)$ 范数\n\n第一个选择是 $\\|\\lambda_h\\|_M = \\|\\lambda_h\\|_{H^{-1/2}(\\Gamma)}$。该范数通过对偶性定义：\n$$\n\\|\\lambda_h\\|_{H^{-1/2}(\\Gamma)} = \\sup_{g \\in H^{1/2}(\\Gamma) \\setminus \\{0\\}} \\frac{\\langle \\lambda_h, g \\rangle_{\\Gamma}}{\\|g\\|_{H^{1/2}(\\Gamma)}},\n$$\n其中 $\\langle\\cdot,\\cdot\\rangle_{\\Gamma}$ 是 $L^2(\\Gamma)$ 内积，表示 $H^{-1/2}(\\Gamma)$ 和 $H^{1/2}(\\Gamma)$ 之间的对偶配对。\n\n所选的离散化方法，即在非匹配网格（$h$ 和 $2h$）上使用分片线性元，在较粗网格（$2h$）上使用分片常数乘子，是稳定的砂浆有限元法的一个标准例子。砂浆方法理论中的一个基本结果（由 Bernardi, Maday, 和 Patera 提出）指出，对于这样的空间选择，离散 inf-sup 常数由一个与网格尺寸 $h$ 无关的正常数从下方有界。也就是说，\n$$\n\\beta_{H^{-1/2}}(h) \\ge \\beta_0  0,\n$$\n对于某个不依赖于 $h$ 的常数 $\\beta_0$。这种一致稳定性是在实践中选择这种特定乘子空间的原因。由于 $\\beta_{H^{-1/2}}(h)$ 由一个正常数从下方有界，其领阶渐近标度为一个常数。\n$$\n\\beta_{H^{-1/2}}(h) \\approx C' h^0.\n$$\n因此，指数为 $\\alpha_{H^{-1/2}} = 0$。\n\n#### 情况2：$L^2(\\Gamma)$ 范数\n\n第二个选择是 $\\|\\lambda_h\\|_M = \\|\\lambda_h\\|_{L^2(\\Gamma)}$。inf-sup 常数为\n$$\n\\beta_{L^2}(h) \\;=\\; \\inf_{\\lambda_h\\in M_h\\setminus\\{0\\}} \\;\\sup_{v_h\\in V_h\\setminus\\{0\\}} \\;\\frac{b(\\lambda_h,v_h)}{\\|\\lambda_h\\|_{L^2(\\Gamma)}\\,\\|v_h\\|_V}\\,.\n$$\n我们可以通过分析离散乘子空间 $M_h$ 上 $L^2(\\Gamma)$ 和 $H^{-1/2}(\\Gamma)$ 范数之间的关系，将 $\\beta_{L^2}(h)$ 与 $\\beta_{H^{-1/2}}(h)$ 联系起来。对于任意 $\\lambda_h \\in M_h$，我们可以写出：\n$$\n\\sup_{v_h\\in V_h} \\frac{b(\\lambda_h,v_h)}{\\|v_h\\|_V} \\ge \\beta_{H^{-1/2}}(h) \\|\\lambda_h\\|_{H^{-1/2}(\\Gamma)} \\ge \\beta_0 \\|\\lambda_h\\|_{H^{-1/2}(\\Gamma)}.\n$$\n将此代入 $\\beta_{L^2}(h)$ 的表达式中：\n$$\n\\beta_{L^2}(h) = \\inf_{\\lambda_h\\in M_h} \\frac{\\sup_{v_h} b(\\lambda_h,v_h)/\\|v_h\\|_V}{\\|\\lambda_h\\|_{L^2(\\Gamma)}} \\ge \\beta_0 \\inf_{\\lambda_h\\in M_h} \\frac{\\|\\lambda_h\\|_{H^{-1/2}(\\Gamma)}}{\\|\\lambda_h\\|_{L^2(\\Gamma)}}.\n$$\n因此，分析转向寻找范数比的下确界的标度。对于定义在尺寸为 $H$ 的拟一致网格上的有限元空间，一个标准的反向不等式成立。$M_h$ 空间由在 $\\Gamma$ 的尺寸为 $H=2h$ 的剖分上的分片常数函数组成。关联 $L^2$ 和 $H^{-1/2}$ 范数的相关反向不等式是：\n$$\n\\|\\lambda_h\\|_{L^2(\\Gamma)} \\le C H^{-1/2} \\|\\lambda_h\\|_{H^{-1/2}(\\Gamma)} \\quad \\forall \\lambda_h \\in M_h.\n$$\n整理这个不等式，我们得到：\n$$\n\\frac{\\|\\lambda_h\\|_{H^{-1/2}(\\Gamma)}}{\\|\\lambda_h\\|_{L^2(\\Gamma)}} \\ge C^{-1} H^{1/2} = C^{-1} (2h)^{1/2}.\n$$\n这个不等式对所有 $\\lambda_h \\in M_h$ 成立，所以 $M_h$ 上的下确界也必须满足此标度：\n$$\n\\inf_{\\lambda_h\\in M_h} \\frac{\\|\\lambda_h\\|_{H^{-1/2}(\\Gamma)}}{\\|\\lambda_h\\|_{L^2(\\Gamma)}} \\ge C' h^{1/2}.\n$$\n这为 inf-sup 常数的标度提供了一个下界：$\\beta_{L^2}(h) \\ge \\beta_0 C' h^{1/2}$。\n\n为了证明此标度是尖锐的，我们必须证明 $\\beta_{L^2}(h) \\le C'' h^{1/2}$。这通常通过构造一个“最坏情况”的乘子函数 $\\lambda_h^* \\in M_h$ 来完成，对于该函数，$v_h$ 上的上确界很小。一个典型的选择是高度振荡的函数，例如在粗剖分（尺寸为$2h$）的相邻段上交替变号的“棋盘”函数。令 $\\lambda_h^*$ 为这样一个函数，并归一化使得 $\\|\\lambda_h^*\\|_{L^2(\\Gamma)}=1$。\n对于这个特定的选择，可以证明\n$$ \\sup_{v_h\\in V_h\\setminus\\{0\\}} \\frac{b(\\lambda_h^*, v_h)}{\\|v_h\\|_V} \\le C'' h^{1/2}. $$\n这个界限源于一种抵消效应。对于这种砂浆设置，一个已知的性质是，对于棋盘乘子 $\\lambda_h^*$，涉及粗网格函数的项会消失：对于 $V_{2,h}$ 的迹空间中的所有 $v_{2,h}$，有 $\\int_\\Gamma \\lambda_h^* v_{2,h}\\,\\mathrm{d}s = 0$。上确界则由项 $\\int_\\Gamma \\lambda_h^* v_{1,h}\\,\\mathrm{d}s$ 决定。网格尺寸的不匹配（$v_{1,h}$ 的 $h$ 与 $\\lambda_h^*$ 的 $2h$）导致该项的阶为 $h^{1/2} \\|\\nabla v_{1,h}\\|_{L^2(\\Omega_1)}$。\n这证实了该标度确实是尖锐的。\n$$\n\\beta_{L^2}(h) \\approx C h^{1/2}.\n$$\n因此，指数为 $\\alpha_{L^2} = 1/2$。\n\n指数对为 $(\\alpha_{L^2}, \\alpha_{H^{-1/2}})$。\n\n最终指数：\n$\\alpha_{L^2} = 1/2$\n$\\alpha_{H^{-1/2}} = 0$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{2}  0\n\\end{pmatrix}\n}\n$$"
        }
    ]
}