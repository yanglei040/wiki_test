{
    "hands_on_practices": [
        {
            "introduction": "我们从最简单的情形开始：三角形单元上的仿射映射。本练习将展示雅可比行列式（对于仿射映射而言是一个常数）如何直接编码单元的方向。我们将看到，调换顶点的顺序会如何反转行列式的符号，以及（至关重要地）这种符号变化如何影响物理量（如跨单元边界的通量）的数值计算。",
            "id": "3361765",
            "problem": "考虑参考三角形 $\\hat{T}$，其顶点为 $\\hat{v}_{1}=(0,0)$、$\\hat{v}_{2}=(1,0)$ 和 $\\hat{v}_{3}=(0,1)$。设 $T$ 为物理三角形，其顶点为 $v_{1}=(0,0)$、$v_{2}=(2,0)$ 和 $v_{3}=(0,1)$。定义标准仿射映射 $F:\\hat{T}\\to T$，将 $\\hat{v}_{i}\\mapsto v_{i}$ (对于 $i\\in\\{1,2,3\\}$)，其中 $F(\\hat{x})=A\\hat{x}+b$，具有常数雅可比矩阵 $A\\in\\mathbb{R}^{2\\times 2}$ 和平移向量 $b\\in\\mathbb{R}^{2}$。使用仿射映射的基本定义，为此映射构造 $A$ 和 $b$，并计算 $\\det A$。\n\n现在定义一个置换映射 $F^{\\pi}:\\hat{T}\\to T$，通过对目标顶点顺序应用换位 $\\pi=(1\\ 2)$，即 $F^{\\pi}$ 将 $\\hat{v}_{1}\\mapsto v_{2}$、$\\hat{v}_{2}\\mapsto v_{1}$ 和 $\\hat{v}_{3}\\mapsto v_{3}$。构造 $A^{\\pi}$ 和 $b^{\\pi}$，并计算 $\\det A^{\\pi}$。\n\n接下来，考虑第二个三角形 $T'$，它与 $T$ 共享 $v_{2}$ 和 $v_{3}$ 之间的物理边 $e$，其第三个顶点为 $w_{3}=(2,1)$。设 $G:\\hat{T}\\to T'$ 为标准仿射映射，其典范序为 $\\hat{v}_{1}\\mapsto v_{2}$、$\\hat{v}_{2}\\mapsto v_{3}$ 和 $\\hat{v}_{3}\\mapsto w_{3}$。对于任何足够光滑的通量 $\\boldsymbol{q}:\\mathbb{R}^{2}\\to\\mathbb{R}^{2}$，根据定义，$T$ 和 $T'$ 在边 $e$ 上的外法线是相反的，因此通量积分满足 $\\int_{e}\\boldsymbol{q}\\cdot \\boldsymbol{n}_{T}\\,\\mathrm{d}s = -\\int_{e}\\boldsymbol{q}\\cdot \\boldsymbol{n}_{T'}\\,\\mathrm{d}s$，其中 $\\boldsymbol{n}_{T}$ 和 $\\boldsymbol{n}_{T'}$ 分别表示从 $T$ 和 $T'$ 指出的单位外法线。\n\n仅使用仿射映射的核心定义和仿射映射下线积分的换元原理，确定乘法符号因子 $s$。这个因子表示：使用置换单元映射 $F^{\\pi}$ 和与 $\\hat{T}$ 上右手定则一致的典范参考边方向为 $T$ 计算的穿过边 $e$ 的通量积分，相对于使用未置换映射 $F$ 获得的符号所发生的变化。换句话说，找到 $s$，使得通过 $F^{\\pi}$ 计算的共享边上的拉回通量积分等于通过 $F$ 计算的相应积分的 $s$ 倍，其中物理外法线相对于 $T$ 是相同的。\n\n将你的最终答案以一个包含两个条目的行矩阵形式报告：$\\det A^{\\pi}$ 的值和符号因子 $s$。不要包含单位。不需要四舍五入；提供精确值。",
            "solution": "该问题被验证为是适定的、有科学依据的，并且基于所提供的定义具有唯一且有意义的解。所有必要的数据都已给出，并且没有内部矛盾。因此，我们可以进行正式求解。\n\n该问题包括三个部分。首先，我们构造标准仿射映射 $F:\\hat{T}\\to T$ 并计算其雅可比矩阵的行列式。其次，我们对置换映射 $F^{\\pi}:\\hat{T}\\to T$ 做同样的操作。第三，我们分析此置换对共享边上通量积分计算的影响。\n\n从具有坐标 $\\hat{\\boldsymbol{x}} = (\\hat{x}_{1}, \\hat{x}_{2})^T$ 的参考空间到具有坐标 $\\boldsymbol{x} = (x_{1}, x_{2})^T$ 的物理空间的仿射映射由关系 $\\boldsymbol{x} = F(\\hat{\\boldsymbol{x}}) = A\\hat{\\boldsymbol{x}} + b$ 定义，其中 $A \\in \\mathbb{R}^{2\\times 2}$ 是一个常数矩阵（映射的雅可比矩阵），$b \\in \\mathbb{R}^{2}$ 是一个常数平移向量。\n\n参考三角形 $\\hat{T}$ 的顶点为 $\\hat{v}_{1}=(0,0)$、$\\hat{v}_{2}=(1,0)$ 和 $\\hat{v}_{3}=(0,1)$。物理三角形 $T$ 的顶点为 $v_{1}=(0,0)$、$v_{2}=(2,0)$ 和 $v_{3}=(0,1)$。\n\n**第1部分：标准映射 $F$ 的构造**\n\n映射 $F$ 由顶点对应关系 $F(\\hat{v}_{i}) = v_{i}$ (对于 $i \\in \\{1, 2, 3\\}$) 定义。我们使用这些条件来确定 $A$ 和 $b$。\n\n$1$。 $F(\\hat{v}_{1}) = v_{1}$：\n$F\\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} = A\\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} + b = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$。\n这立即得出平移向量 $b = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$。\n\n$2$。 $F(\\hat{v}_{2}) = v_{2}$：\n$F\\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = A\\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} + b = \\begin{pmatrix} 2 \\\\ 0 \\end{pmatrix}$。\n由于 $b$ 是零向量，所以 $A\\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 2 \\\\ 0 \\end{pmatrix}$。这个方程指定了矩阵 $A$ 的第一列。\n\n$3$。 $F(\\hat{v}_{3}) = v_{3}$：\n$F\\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} = A\\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} + b = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$。\n类似地，$A\\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$。这个方程指定了 $A$ 的第二列。\n\n综合这些结果，矩阵 $A$ 是 $A = \\begin{pmatrix} 2   0 \\\\ 0   1 \\end{pmatrix}$。\n$A$ 的行列式是 $\\det A = (2)(1) - (0)(0) = 2$。\n\n**第2部分：置换映射 $F^{\\pi}$ 的构造**\n\n置换映射 $F^{\\pi}$ 由顶点对应关系 $\\hat{v}_{1}\\mapsto v_{2}$、$\\hat{v}_{2}\\mapsto v_{1}$ 和 $\\hat{v}_{3}\\mapsto v_{3}$ 定义。设该映射为 $F^{\\pi}(\\hat{\\boldsymbol{x}}) = A^{\\pi}\\hat{\\boldsymbol{x}} + b^{\\pi}$。\n\n$1$。 $F^{\\pi}(\\hat{v}_{1}) = v_{2}$：\n$F^{\\pi}\\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} = A^{\\pi}\\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} + b^{\\pi} = \\begin{pmatrix} 2 \\\\ 0 \\end{pmatrix}$。\n这得出平移向量 $b^{\\pi} = \\begin{pmatrix} 2 \\\\ 0 \\end{pmatrix}$。\n\n$2$。 $F^{\\pi}(\\hat{v}_{2}) = v_{1}$：\n$F^{\\pi}\\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = A^{\\pi}\\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} + b^{\\pi} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$。\n代入 $b^{\\pi}$，我们得到 $A^{\\pi}\\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} + \\begin{pmatrix} 2 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$，这意味着 $A^{\\pi}\\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} -2 \\\\ 0 \\end{pmatrix}$。这是 $A^{\\pi}$ 的第一列。\n\n$3$。 $F^{\\pi}(\\hat{v}_{3}) = v_{3}$：\n$F^{\\pi}\\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} = A^{\\pi}\\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} + b^{\\pi} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$。\n代入 $b^{\\pi}$，我们得到 $A^{\\pi}\\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} + \\begin{pmatrix} 2 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$，这意味着 $A^{\\pi}\\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} -2 \\\\ 1 \\end{pmatrix}$。这是 $A^{\\pi}$ 的第二列。\n\n综合这些结果，矩阵 $A^{\\pi}$ 是 $A^{\\pi} = \\begin{pmatrix} -2   -2 \\\\ 0   1 \\end{pmatrix}$。\n$A^{\\pi}$ 的行列式是 $\\det A^{\\pi} = (-2)(1) - (-2)(0) = -2$。这是我们最终答案的第一个值。\n\n**第3部分：符号因子 $s$ 的确定**\n\n向量场 $\\boldsymbol{q}$ 穿过物理边 $e$ 的通量积分由 $\\int_e \\boldsymbol{q} \\cdot \\boldsymbol{n} \\, ds$ 给出。在有限元方法的背景下，该积分是通过将其映射回参考边 $\\hat{e}$ 来计算的。向量线元 $\\boldsymbol{n} \\, ds$ 的变量变换由 Piola 变换给出：$\\boldsymbol{n} \\, ds = \\det(A) (A^{-1})^T \\hat{\\boldsymbol{n}}_{\\hat{T}} \\, d\\hat{s}$，其中 $\\hat{\\boldsymbol{n}}_{\\hat{T}}$ 是参考边 $\\hat{e}$ 上相对于参考单元 $\\hat{T}$ 的单位外法线。\n\n该积分变换为：\n$$ \\int_e \\boldsymbol{q} \\cdot \\boldsymbol{n} \\, ds = \\int_{\\hat{e}} (\\boldsymbol{q} \\circ F)(\\hat{\\boldsymbol{x}}) \\cdot \\left( \\det(A) (A^{-T}) \\hat{\\boldsymbol{n}}_{\\hat{T}} \\right) d\\hat{s} $$\n所得到的物理法线的方向关键取决于雅可比行列式 $\\det(A)$ 的符号。$\\hat{\\boldsymbol{n}}_{\\hat{T}}$ 的典范定义假设 $\\hat{T}$ 的边界具有逆时针 (CCW) 方向。如果 $\\det(A) > 0$，则映射保持方向，变换后的法线 $\\det(A) A^{-T} \\hat{\\boldsymbol{n}}_{\\hat{T}}$ 指向物理单元 $T$ 的外部。如果 $\\det(A)  0$，则映射反转方向，变换后的法线指向 $T$ 的内部。\n\n我们关注的物理边是连接 $v_{2}=(2,0)$ 和 $v_{3}=(0,1)$ 的 $e$。从标准映射 $v_1 \\to v_2 \\to v_3$ 来看，$T$ 的方向是逆时针的。边 $e$ 上的外法线 $\\boldsymbol{n}_{T}$ 指向 $T$ 的内部以外。沿该边的向量是 $v_3-v_2=(-2,1)$，因此外法线与 $(1,2)$ 成比例。\n\n情况1：未置换映射 $F$。\n物理边 $e=(v_2, v_3)$ 是参考边 $\\hat{e}_{23}=(\\hat{v}_2, \\hat{v}_3)$ 在 $F$ 映射下的像。我们计算出 $\\det A = 2 > 0$。该映射是保向的。因此，标准的计算过程将参考边 $\\hat{e}_{23}$ 上的参考外法线 $\\hat{\\boldsymbol{n}}_{\\hat{T}}$ 映射到物理边 $e$ 上的物理外法线 $\\boldsymbol{n}_{T}$。计算出的通量积分为 $\\int_e \\boldsymbol{q} \\cdot \\boldsymbol{n}_{T} \\, ds$。\n\n情况2：置换映射 $F^{\\pi}$。\n问题指定使用“典范参考边方向”。对于逆时针定向的参考三角形 $\\hat{T}$，典范边为 $\\hat{v}_1 \\to \\hat{v}_2$、$\\hat{v}_2 \\to \\hat{v}_3$ 和 $\\hat{v}_3 \\to \\hat{v}_1$。我们必须找出在 $F^{\\pi}$ 映射下，这些边中哪一个映射到物理边 $e=(v_2, v_3)$。\n$F^{\\pi}(\\hat{v}_1)=v_2$, $F^{\\pi}(\\hat{v}_2)=v_1$, $F^{\\pi}(\\hat{v}_3)=v_3$。\n映射 $F^{\\pi}$ 将参考边 $\\hat{e}_{31}=(\\hat{v}_3, \\hat{v}_1)$ 映射到物理路径 $v_3 \\to v_2$。这对应于边 $e$，但遍历方向相反。\n我们计算出 $\\det A^{\\pi} = -2  0$。该映射是反向的。\n因为该映射是反向的，标准计算过程将参考边 $\\hat{e}_{31}$ 上的参考外法线 $\\hat{\\boldsymbol{n}}_{\\hat{T}}$ 映射到物理边 $e$ 上的物理内法线 $-\\boldsymbol{n}_{T}$。因此，使用映射 $F^{\\pi}$ 计算的通量积分为 $\\int_e \\boldsymbol{q} \\cdot (-\\boldsymbol{n}_{T}) \\, ds = - \\int_e \\boldsymbol{q} \\cdot \\boldsymbol{n}_{T} \\, ds$。\n\n因子 $s$ 是通过 $F^{\\pi}$ 过程计算的积分值与通过 $F$ 过程计算的积分值之比。\n$$ s = \\frac{-\\int_e \\boldsymbol{q} \\cdot \\boldsymbol{n}_{T} \\, ds}{\\int_e \\boldsymbol{q} \\cdot \\boldsymbol{n}_{T} \\, ds} = -1 $$\n符号因子 $s$ 为 $-1$。这是我们最终答案的第二个值。\n\n最终答案要求一个包含 $\\det A^{\\pi}$ 和 $s$ 的行矩阵。",
            "answer": "$$\\boxed{\\begin{pmatrix} -2   -1 \\end{pmatrix}}$$"
        },
        {
            "introduction": "在仿射映射的基础上，我们现在转向更通用、更广泛应用的四边形双线性等参映射。与仿射映射不同，双线性映射的雅可比行列式不是常数，这意味着网格畸变在单个单元内部也可能发生变化。本练习将引导你推导一个任意四边形的雅可比行列式，并找出畸变最严重的位置，从而为网格质量提供一个定量的度量。",
            "id": "3361788",
            "problem": "考虑一个双线性等参映射 $F:\\hat{Q}\\to Q$，它从坐标为 $(\\hat{\\xi},\\hat{\\eta})$ 的参考单元 $\\hat{Q}=[-1,1]^2$ 映射到一个扭曲的凸四边形 $Q\\subset\\mathbb{R}^2$。该四边形的顶点按逆时针顺序列出，分别为 $P_1=(0,0)$、$P_2=(3,0.6)$、$P_3=(3.2,2.4)$ 和 $P_4=(0.4,2.1)$。该映射 $F$ 由标准的双线性等参构造定义，它将参考单元的角点 $(-1,-1)$、$(1,-1)$、$(1,1)$、$(-1,1)$ 分别映射到物理顶点 $P_1$、$P_2$、$P_3$、$P_4$。令 $J(\\hat{\\xi},\\hat{\\eta})$ 表示映射 $F$ 在点 $(\\hat{\\xi},\\hat{\\eta})$ 处的雅可比矩阵。\n\n从双线性等参映射和平面域之间映射的雅可比矩阵的核心定义出发，推导 $\\det J(\\hat{\\xi},\\hat{\\eta})$ 作为 $(\\hat{\\xi},\\hat{\\eta})$ 函数的显式解析表达式。然后，确定在 $\\hat{Q}$ 上 $\\det J$ 取得最小值的点 $(\\hat{\\xi},\\hat{\\eta})\\in\\hat{Q}$，并计算该最小值。简要解释该最小值的位置和大小如何与偏微分方程有限元离散化中的网格畸变相关联。\n\n以包含 $(\\hat{\\xi}_{\\min},\\hat{\\eta}_{\\min},\\min_{\\hat{Q}}\\det J)$ 的单行矩阵形式提供您的最终数值结果，使用精确值。无需四舍五入，不涉及物理单位。",
            "solution": "该问题是适定的且自洽的，提供了定义等参映射并分析其雅可比矩阵所需的所有信息。这些概念在偏微分方程的有限元分析领域是标准的。因此，该问题被验证为科学上合理且可解的。\n\n从参考方形 $\\hat{Q} = [-1, 1]^2$ 到物理四边形 $Q$ 的双线性等参映射 $F: \\hat{Q} \\to Q$ 由形函数 $N_i(\\hat{\\xi}, \\hat{\\eta})$ 和物理顶点坐标 $P_i = (x_i, y_i)$ 定义。该映射由 $F(\\hat{\\xi}, \\hat{\\eta}) = (x(\\hat{\\xi}, \\hat{\\eta}), y(\\hat{\\xi}, \\hat{\\eta})) = \\sum_{i=1}^{4} N_i(\\hat{\\xi}, \\hat{\\eta}) P_i$ 给出。\n\n$\\hat{Q}$ 节点的四个双线性形函数为：\n$N_1(\\hat{\\xi}, \\hat{\\eta}) = \\frac{1}{4}(1-\\hat{\\xi})(1-\\hat{\\eta})$ 对应角点 $(-1, -1)$\n$N_2(\\hat{\\xi}, \\hat{\\eta}) = \\frac{1}{4}(1+\\hat{\\xi})(1-\\hat{\\eta})$ 对应角点 $(1, -1)$\n$N_3(\\hat{\\xi}, \\hat{\\eta}) = \\frac{1}{4}(1+\\hat{\\xi})(1+\\hat{\\eta})$ 对应角点 $(1, 1)$\n$N_4(\\hat{\\xi}, \\hat{\\eta}) = \\frac{1}{4}(1-\\hat{\\xi})(1+\\hat{\\eta})$ 对应角点 $(-1, 1)$\n\n物理顶点为 $P_1=(0,0)$、$P_2=(3,0.6)$、$P_3=(3.2,2.4)$ 和 $P_4=(0.4,2.1)$，它们按给定顺序从参考角点映射而来。我们将非整数坐标表示为精确分数：$P_2=(3, \\frac{3}{5})$、$P_3=(\\frac{16}{5}, \\frac{12}{5})$ 和 $P_4=(\\frac{2}{5}, \\frac{21}{10})$。\n\n坐标函数 $x(\\hat{\\xi}, \\hat{\\eta})$ 和 $y(\\hat{\\xi}, \\hat{\\eta})$ 由以下公式给出：\n$x(\\hat{\\xi}, \\hat{\\eta}) = \\sum_{i=1}^{4} N_i(\\hat{\\xi}, \\hat{\\eta}) x_i = 0 \\cdot N_1 + 3 \\cdot N_2 + \\frac{16}{5} \\cdot N_3 + \\frac{2}{5} \\cdot N_4$\n$y(\\hat{\\xi}, \\hat{\\eta}) = \\sum_{i=1}^{4} N_i(\\hat{\\xi}, \\hat{\\eta}) y_i = 0 \\cdot N_1 + \\frac{3}{5} \\cdot N_2 + \\frac{12}{5} \\cdot N_3 + \\frac{21}{10} \\cdot N_4$\n\n代入形函数并化简可得：\n$x(\\hat{\\xi}, \\hat{\\eta}) = \\frac{1}{4} [3(1+\\hat{\\xi})(1-\\hat{\\eta}) + \\frac{16}{5}(1+\\hat{\\xi})(1+\\hat{\\eta}) + \\frac{2}{5}(1-\\hat{\\xi})(1+\\hat{\\eta})]$\n$x(\\hat{\\xi}, \\hat{\\eta}) = \\frac{1}{20} [15(1+\\hat{\\xi}-\\hat{\\eta}-\\hat{\\xi}\\hat{\\eta}) + 16(1+\\hat{\\xi}+\\hat{\\eta}+\\hat{\\xi}\\hat{\\eta}) + 2(1-\\hat{\\xi}+\\hat{\\eta}-\\hat{\\xi}\\hat{\\eta})]$\n$x(\\hat{\\xi}, \\hat{\\eta}) = \\frac{1}{20} [(15+16+2) + (15+16-2)\\hat{\\xi} + (-15+16+2)\\hat{\\eta} + (-15+16-2)\\hat{\\xi}\\hat{\\eta}]$\n$x(\\hat{\\xi}, \\hat{\\eta}) = \\frac{1}{20} [33 + 29\\hat{\\xi} + 3\\hat{\\eta} - \\hat{\\xi}\\hat{\\eta}]$\n\n$y(\\hat{\\xi}, \\hat{\\eta}) = \\frac{1}{4} [\\frac{3}{5}(1+\\hat{\\xi})(1-\\hat{\\eta}) + \\frac{12}{5}(1+\\hat{\\xi})(1+\\hat{\\eta}) + \\frac{21}{10}(1-\\hat{\\xi})(1+\\hat{\\eta})]$\n$y(\\hat{\\xi}, \\hat{\\eta}) = \\frac{1}{40} [6(1+\\hat{\\xi}-\\hat{\\eta}-\\hat{\\xi}\\hat{\\eta}) + 24(1+\\hat{\\xi}+\\hat{\\eta}+\\hat{\\xi}\\hat{\\eta}) + 21(1-\\hat{\\xi}+\\hat{\\eta}-\\hat{\\xi}\\hat{\\eta})]$\n$y(\\hat{\\xi}, \\hat{\\eta}) = \\frac{1}{40} [(6+24+21) + (6+24-21)\\hat{\\xi} + (-6+24+21)\\hat{\\eta} + (-6+24-21)\\hat{\\xi}\\hat{\\eta}]$\n$y(\\hat{\\xi}, \\hat{\\eta}) = \\frac{1}{40} [51 + 9\\hat{\\xi} + 39\\hat{\\eta} - 3\\hat{\\xi}\\hat{\\eta}]$\n\n映射 $F$ 的雅可比矩阵 $J(\\hat{\\xi}, \\hat{\\eta})$ 由 $J = \\begin{pmatrix} \\partial x/\\partial\\hat{\\xi}   \\partial x/\\partial\\hat{\\eta} \\\\ \\partial y/\\partial\\hat{\\xi}   \\partial y/\\partial\\hat{\\eta} \\end{pmatrix}$ 给出。所需的偏导数是：\n$\\frac{\\partial x}{\\partial \\hat{\\xi}} = \\frac{1}{20}(29 - \\hat{\\eta})$\n$\\frac{\\partial x}{\\partial \\hat{\\eta}} = \\frac{1}{20}(3 - \\hat{\\xi})$\n$\\frac{\\partial y}{\\partial \\hat{\\xi}} = \\frac{1}{40}(9 - 3\\hat{\\eta}) = \\frac{3}{40}(3 - \\hat{\\eta})$\n$\\frac{\\partial y}{\\partial \\hat{\\eta}} = \\frac{1}{40}(39 - 3\\hat{\\xi}) = \\frac{3}{40}(13 - \\hat{\\xi})$\n\n雅可比行列式 $\\det J$ 为：\n$\\det J = \\frac{\\partial x}{\\partial \\hat{\\xi}}\\frac{\\partial y}{\\partial \\hat{\\eta}} - \\frac{\\partial x}{\\partial \\hat{\\eta}}\\frac{\\partial y}{\\partial \\hat{\\xi}}$\n$\\det J = \\left(\\frac{1}{20}(29 - \\hat{\\eta})\\right) \\left(\\frac{3}{40}(13 - \\hat{\\xi})\\right) - \\left(\\frac{1}{20}(3 - \\hat{\\xi})\\right) \\left(\\frac{3}{40}(3 - \\hat{\\eta})\\right)$\n$\\det J = \\frac{3}{800} [(29 - \\hat{\\eta})(13 - \\hat{\\xi}) - (3 - \\hat{\\xi})(3 - \\hat{\\eta})]$\n$\\det J = \\frac{3}{800} [(377 - 29\\hat{\\xi} - 13\\hat{\\eta} + \\hat{\\xi}\\hat{\\eta}) - (9 - 3\\hat{\\xi} - 3\\hat{\\eta} + \\hat{\\xi}\\hat{\\eta})]$\n$\\det J = \\frac{3}{800} [368 - 26\\hat{\\xi} - 10\\hat{\\eta}]$\n可以通过从括号项中提取因子 $2$ 来简化：\n$\\det J(\\hat{\\xi}, \\hat{\\eta}) = \\frac{6}{800} [184 - 13\\hat{\\xi} - 5\\hat{\\eta}] = \\frac{3}{400} (184 - 13\\hat{\\xi} - 5\\hat{\\eta})$\n这就是雅可比行列式的显式解析表达式。\n\n为了在紧致域 $\\hat{Q}=[-1,1]^2$ 上找到 $\\det J$ 的最小值，我们观察到 $\\det J(\\hat{\\xi}, \\hat{\\eta})$ 是 $\\hat{\\xi}$ 和 $\\hat{\\eta}$ 的线性函数。一个在凸多胞体（本例中为方形）上的线性函数必在其定义域的顶点（角点）处取得其最小值和最大值。\n我们想要求 $f(\\hat{\\xi}, \\hat{\\eta}) = \\frac{3}{400} (184 - 13\\hat{\\xi} - 5\\hat{\\eta})$ 的最小值。由于常数因子 $\\frac{3}{400}$ 为正，这等价于求 $g(\\hat{\\xi}, \\hat{\\eta}) = 184 - 13\\hat{\\xi} - 5\\hat{\\eta}$ 的最小值，而这又等价于求 $h(\\hat{\\xi}, \\hat{\\eta}) = 13\\hat{\\xi} + 5\\hat{\\eta}$ 的最大值。\n$h(\\hat{\\xi}, \\hat{\\eta})$ 中 $\\hat{\\xi}$ 和 $\\hat{\\eta}$ 的系数（$13$ 和 $5$）都为正。因此，为了最大化 $h$，我们必须在定义域 $[-1,1]^2$ 内为 $\\hat{\\xi}$ 和 $\\hat{\\eta}$ 选择可能的最大值。这发生在点 $(\\hat{\\xi}_{\\min}, \\hat{\\eta}_{\\min}) = (1, 1)$。\n\n我们现在计算 $\\det J$ 在此点的最小值：\n$\\min_{\\hat{Q}} \\det J = \\det J(1, 1) = \\frac{3}{400} (184 - 13(1) - 5(1))$\n$\\min_{\\hat{Q}} \\det J = \\frac{3}{400} (184 - 18) = \\frac{3}{400} (166)$\n$\\min_{\\hat{Q}} \\det J = \\frac{498}{400} = \\frac{249}{200}$\n\n取得最小值的点是 $(\\hat{\\xi}_{\\min}, \\hat{\\eta}_{\\min}) = (1, 1)$，最小值为 $\\frac{249}{200}$。\n\n与网格畸变关系的简要说明：\n雅可比行列式 $\\det J$ 是从参考单元 $\\hat{Q}$ 到物理单元 $Q$ 的局部面积变化的度量，即 $d x d y = \\det J \\, d\\hat{\\xi} d\\hat{\\eta}$。$\\det J$ 的值接近于零表示物理单元的某个区域相对于参考方形被严重压缩或“压扁”。这种现象是一种网格畸变。位置 $(\\hat{\\xi}_{\\min}, \\hat{\\eta}_{\\min})=(1,1)$ 对应于物理顶点 $P_3$，表明该四边形在此顶点附近畸变最严重。在有限元方法中，数值积分在参考单元上执行，所得表达式通常包含一个因子 $1/\\det J$。一个非常小的 $\\det J$ 值会导致被积函数变得非常大，这会放大数值积分误差，并降低整体解的准确性和稳定性。因此，单元上 $\\det J$ 的最小值是衡量网格质量的关键指标。",
            "answer": "$$\\boxed{\\begin{pmatrix} 1   1   \\frac{249}{200} \\end{pmatrix}}$$"
        },
        {
            "introduction": "当一个四边形单元的畸变严重到出现凹角甚至“缠绕”时，会发生什么？最后一个练习将探讨一种病态但至关重要的情景：映射不再是一一对应的，导致单元内部出现负的雅可比行列式。你将构建这样一个案例，找出其非法区域，并分析其对有限元装配过程造成的深远且有害的后果，从而强调为何保持雅可比行列式为正是该方法有效性的根本。",
            "id": "3361798",
            "problem": "在二维空间中，考虑从具有参数坐标 $(\\xi,\\eta)$ 的参考正方形 $\\hat{K} = [-1,1] \\times [-1,1]$ 到物理四边形 $K$ 的标准等参双线性映射，该四边形的节点按逆时针顺序由以下公式给出\n$$\nP_1 = (0,0),\\quad P_2 = (2,-2),\\quad P_3 = (2,1),\\quad P_4 = (-1, \\tfrac{1}{2}).\n$$\n物理坐标 $(x(\\xi,\\eta),y(\\xi,\\eta))$ 由使用 $\\hat{K}$ 上的四个角点形函数的常规双线性等参插值定义。\n\n任务：\n- 仅使用双线性等参映射和雅可比矩阵的定义，推导 $x(\\xi,\\eta)$ 和 $y(\\xi,\\eta)$ 并计算雅可比行列式 $\\det J(\\xi,\\eta)$ 作为 $(\\xi,\\eta)$ 的显式解析函数。\n- 验证 $K$ 恰好有一个钝内角，并从第一性原理出发（即，使用一个顶点处相邻边的向量及其点积）确定该角。\n- 证明 $\\det J(\\xi,\\eta)$ 在 $\\hat{K}$ 内部（而不仅仅是在边界上）变号。显式确定子集 $\\mathcal{N} \\subset \\hat{K}$，在该子集上 $\\det J(\\xi,\\eta)  0$。\n- 对于带有齐次狄利克雷边界条件的标量泊松方程，定性且严谨地讨论存在 $\\det J  0$ 的区域 $\\mathcal{N}$ 对单元级刚度矩阵有何影响（包括在参考到物理映射下的被积函数符号、矫顽性以及组装后的正定性），以及降阶积分（欠积分）是否可能检测到这种病态问题。\n\n答案规格：作为您的最终答案，报告 $\\hat{K}$ 内部 $\\det J(\\xi,\\eta)  0$ 的区域 $\\mathcal{N}$ 的精确面积。将您的答案表示为既约分数。无需四舍五入。",
            "solution": "该问题被评估为有效。它在科学上基于有限元法的原理，提法良好，具有足够的数据以获得唯一解，并且表述客观。\n\n解答过程按照问题陈述的要求分为四个部分。\n\n**第一部分：等参映射和雅可比行列式的推导**\n\n参考单元是 $(\\xi, \\eta)$ 坐标系中的正方形 $\\hat{K} = [-1,1] \\times [-1,1]$。对应于节点 $\\hat{P}_1(-1,-1)$、$\\hat{P}_2(1,-1)$、$\\hat{P}_3(1,1)$ 和 $\\hat{P}_4(-1,1)$ 的四个标准双线性形函数 $N_i(\\xi, \\eta)$ 是：\n$$\nN_1(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta) \\\\\nN_2(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta) \\\\\nN_3(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta) \\\\\nN_4(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1+\\eta)\n$$\n物理四边形 $K$ 的顶点按逆时针顺序给出为 $P_1 = (0,0)$、$P_2 = (2,-2)$、$P_3 = (2,1)$ 和 $P_4 = (-1, \\frac{1}{2})$。我们将其坐标表示为 $(x_i, y_i)$。\n\n等参映射 $\\mathbf{x}(\\xi,\\eta) = (x(\\xi,\\eta), y(\\xi,\\eta))$ 定义为：\n$$\n\\mathbf{x}(\\xi,\\eta) = \\sum_{i=1}^{4} N_i(\\xi,\\eta) P_i\n$$\n坐标函数 $x(\\xi,\\eta)$ 和 $y(\\xi,\\eta)$ 是：\n$$\nx(\\xi,\\eta) = \\sum_{i=1}^{4} N_i(\\xi,\\eta) x_i = 0 \\cdot N_1 + 2 \\cdot N_2 + 2 \\cdot N_3 - 1 \\cdot N_4 \\\\\ny(\\xi,\\eta) = \\sum_{i=1}^{4} N_i(\\xi,\\eta) y_i = 0 \\cdot N_1 - 2 \\cdot N_2 + 1 \\cdot N_3 + \\frac{1}{2} \\cdot N_4\n$$\n代入 $N_i$ 的表达式并化简：\n对于 $x(\\xi,\\eta)$：\n$$\nx(\\xi,\\eta) = \\frac{2}{4}(1+\\xi)(1-\\eta) + \\frac{2}{4}(1+\\xi)(1+\\eta) - \\frac{1}{4}(1-\\xi)(1+\\eta) \\\\\nx(\\xi,\\eta) = \\frac{1}{4} [2(1+\\xi-\\eta-\\xi\\eta) + 2(1+\\xi+\\eta+\\xi\\eta) - (1-\\xi+\\eta-\\xi\\eta)] \\\\\nx(\\xi,\\eta) = \\frac{1}{4} [(2+2-1) + (2+2+1)\\xi + (-2+2-1)\\eta + (-2+2+1)\\xi\\eta] \\\\\nx(\\xi,\\eta) = \\frac{1}{4} (3 + 5\\xi - \\eta + \\xi\\eta)\n$$\n对于 $y(\\xi,\\eta)$：\n$$\ny(\\xi,\\eta) = \\frac{-2}{4}(1+\\xi)(1-\\eta) + \\frac{1}{4}(1+\\xi)(1+\\eta) + \\frac{1/2}{4}(1-\\xi)(1+\\eta) \\\\\ny(\\xi,\\eta) = \\frac{1}{8} [-4(1+\\xi-\\eta-\\xi\\eta) + 2(1+\\xi+\\eta+\\xi\\eta) + 1(1-\\xi+\\eta-\\xi\\eta)] \\\\\ny(\\xi,\\eta) = \\frac{1}{8} [(-4+2+1) + (-4+2-1)\\xi + (4+2+1)\\eta + (4+2-1)\\xi\\eta] \\\\\ny(\\xi,\\eta) = \\frac{1}{8} (-1 - 3\\xi + 7\\eta + 5\\xi\\eta)\n$$\n变换的雅可比矩阵 $J$ 由下式给出：\n$$\nJ(\\xi,\\eta) = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi}   \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi}   \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix}\n$$\n偏导数是：\n$$\n\\frac{\\partial x}{\\partial \\xi} = \\frac{1}{4}(5+\\eta) \\quad , \\quad \\frac{\\partial x}{\\partial \\eta} = \\frac{1}{4}(-1+\\xi) \\\\\n\\frac{\\partial y}{\\partial \\xi} = \\frac{1}{8}(-3+5\\eta) \\quad , \\quad \\frac{\\partial y}{\\partial \\eta} = \\frac{1}{8}(7+5\\xi)\n$$\n雅可比行列式为 $\\det J = (\\frac{\\partial x}{\\partial \\xi})(\\frac{\\partial y}{\\partial \\eta}) - (\\frac{\\partial x}{\\partial \\eta})(\\frac{\\partial y}{\\partial \\xi})$：\n$$\n\\det J(\\xi,\\eta) = \\frac{1}{4}(5+\\eta) \\frac{1}{8}(7+5\\xi) - \\frac{1}{4}(-1+\\xi) \\frac{1}{8}(-3+5\\eta) \\\\\n\\det J(\\xi,\\eta) = \\frac{1}{32} [ (5+\\eta)(7+5\\xi) - (-1+\\xi)(-3+5\\eta) ] \\\\\n\\det J(\\xi,\\eta) = \\frac{1}{32} [ (35 + 25\\xi + 7\\eta + 5\\xi\\eta) - (3 - 5\\eta - 3\\xi + 5\\xi\\eta) ] \\\\\n\\det J(\\xi,\\eta) = \\frac{1}{32} (35 + 25\\xi + 7\\eta + 5\\xi\\eta - 3 + 5\\eta + 3\\xi - 5\\xi\\eta) \\\\\n\\det J(\\xi,\\eta) = \\frac{1}{32} (32 + 28\\xi + 12\\eta) = 1 + \\frac{28}{32}\\xi + \\frac{12}{32}\\eta\n$$\n因此，雅可比行列式是：\n$$\n\\det J(\\xi,\\eta) = 1 + \\frac{7}{8}\\xi + \\frac{3}{8}\\eta\n$$\n\n**第二部分：钝内角的验证**\n\n一个顶点的内角是钝角，如果从该顶点出发的两条相邻边的向量的点积为负。\n- 在顶点 $P_1 = (0,0)$ 处：相邻顶点是 $P_2 = (2,-2)$ 和 $P_4 = (-1, \\frac{1}{2})$。边向量是 $\\vec{P_1P_2} = (2,-2)$ 和 $\\vec{P_1P_4} = (-1, \\frac{1}{2})$。\n$$ \\vec{P_1P_2} \\cdot \\vec{P_1P_4} = (2)(-1) + (-2)(\\tfrac{1}{2}) = -2 - 1 = -3  0 $$\n$P_1$ 处的内角是钝角。该顶点对应一个凹角或重入角。\n\n- 在顶点 $P_2 = (2,-2)$ 处：相邻顶点是 $P_1$ 和 $P_3 = (2,1)$。边向量是 $\\vec{P_2P_1} = (-2,2)$ 和 $\\vec{P_2P_3} = (0,3)$。\n$$ \\vec{P_2P_1} \\cdot \\vec{P_2P_3} = (-2)(0) + (2)(3) = 6 > 0 $$\n$P_2$ 处的内角是锐角。\n\n- 在顶点 $P_3 = (2,1)$ 处：相邻顶点是 $P_2$ 和 $P_4$。边向量是 $\\vec{P_3P_2} = (0,-3)$ 和 $\\vec{P_3P_4} = (-3, -\\frac{1}{2})$。\n$$ \\vec{P_3P_2} \\cdot \\vec{P_3P_4} = (0)(-3) + (-3)(-\\tfrac{1}{2}) = \\frac{3}{2} > 0 $$\n$P_3$ 处的内角是锐角。\n\n- 在顶点 $P_4 = (-1, \\frac{1}{2})$ 处：相邻顶点是 $P_3$ 和 $P_1$。边向量是 $\\vec{P_4P_3} = (3, \\frac{1}{2})$ 和 $\\vec{P_4P_1} = (1, -\\frac{1}{2})$。\n$$ \\vec{P_4P_3} \\cdot \\vec{P_4P_1} = (3)(1) + (\\tfrac{1}{2})(-\\tfrac{1}{2}) = 3 - \\frac{1}{4} = \\frac{11}{4} > 0 $$\n$P_4$ 处的内角是锐角。\n因此，物理四边形 $K$ 恰好有一个钝内角，位于顶点 $P_1$。\n\n**第三部分：雅可比行列式为负的区域**\n\n我们必须证明 $\\det J(\\xi,\\eta)$ 在 $\\hat{K}$ 内部变号，并找出子集 $\\mathcal{N} = \\{ (\\xi,\\eta) \\in \\hat{K} \\mid \\det J(\\xi,\\eta)  0 \\}$。\n雅可比行列式为 $\\det J(\\xi,\\eta) = 1 + \\frac{7}{8}\\xi + \\frac{3}{8}\\eta$。在参考单元的中心 $(\\xi,\\eta) = (0,0)$ 处，$\\det J(0,0)=1 > 0$。在映射到钝角顶点 $P_1$ 的角点 $\\hat{P}_1 = (-1,-1)$ 处，我们有：\n$$ \\det J(-1,-1) = 1 + \\frac{7}{8}(-1) + \\frac{3}{8}(-1) = 1 - \\frac{7}{8} - \\frac{3}{8} = 1 - \\frac{10}{8} = -\\frac{2}{8} = -\\frac{1}{4}  0 $$\n由于 $\\det J$ 是连续的，并且在 $\\hat{K}$ 内部同时取正值和负值，所以它必须变号。区域 $\\mathcal{N}$ 由不等式定义：\n$$\n1 + \\frac{7}{8}\\xi + \\frac{3}{8}\\eta  0 \\implies 8 + 7\\xi + 3\\eta  0 \\implies 7\\xi + 3\\eta  -8\n$$\n这个不等式定义了一个开半平面。$\\mathcal{N}$ 是这个半平面与正方形 $\\hat{K} = [-1,1] \\times [-1,1]$ 的交集。该区域的边界是直线 $L: 7\\xi + 3\\eta = -8$。我们找出 $L$ 与 $\\hat{K}$ 边界的交点：\n- 对于 $\\xi = -1$：$7(-1) + 3\\eta = -8 \\implies 3\\eta = -1 \\implies \\eta = -1/3$。交点是 $A = (-1, -1/3)$。该点在 $\\hat{K}$ 的左边界上。\n- 对于 $\\eta = -1$：$7\\xi + 3(-1) = -8 \\implies 7\\xi = -5 \\implies \\xi = -5/7$。交点是 $B = (-5/7, -1)$。该点在 $\\hat{K}$ 的下边界上。\n- 对于 $\\xi = 1$：$7(1) + 3\\eta = -8 \\implies 3\\eta = -15 \\implies \\eta = -5$，这超出了范围 $[-1,1]$。\n- 对于 $\\eta = 1$：$7\\xi + 3(1) = -8 \\implies 7\\xi = -11 \\implies \\xi = -11/7$，这超出了范围 $[-1,1]$。\n\n线段 $AB$ 切割了正方形 $\\hat{K}$ 的一个角。区域 $\\mathcal{N}$ 是一个直角三角形，其顶点为 $(-1, -1/3)$、$(-5/7, -1)$ 和角点 $(-1, -1)$。\n这个直角三角形的直角边长度为：\n- 底（沿 $\\eta=-1$）：$|-1 - (-5/7)| = |-2/7| = 2/7$。\n- 高（沿 $\\xi=-1$）：$|-1 - (-1/3)| = |-2/3| = 2/3$。\n区域 $\\mathcal{N}$ 的面积是：\n$$ \\text{Area}(\\mathcal{N}) = \\frac{1}{2} \\times \\text{base} \\times \\text{height} = \\frac{1}{2} \\times \\frac{2}{7} \\times \\frac{2}{3} = \\frac{2}{21} $$\n\n**第四部分：对单元刚度矩阵的影响**\n\n对于标量泊松方程，单元刚度矩阵的分量由基函数梯度在物理单元 $K$ 上的积分给出。这个积分被变换到参考单元 $\\hat{K}$ 上：\n$$\nA^e_{ij} = \\int_K \\nabla\\phi_i \\cdot \\nabla\\phi_j \\, dx dy = \\int_{\\hat{K}} (\\hat{\\nabla}\\hat{\\phi}_i)^T (J^{-1} J^{-T}) (\\hat{\\nabla}\\hat{\\phi}_j) \\det J \\, d\\xi d\\eta\n$$\n其中 $\\phi_i$ 是物理基函数，$\\hat{\\phi}_i = N_i$ 是 $\\hat{K}$ 上的基函数。\n\n- **被积函数符号与矫顽性**：一个有效的映射要求 $\\det J > 0$，以使变换是保向的，并使最终的有限元系统是适定的。先验误差估计和双线性形式的矫顽性依赖于此假设。在区域 $\\mathcal{N}$ 中，$\\det J  0$。这意味着来自该子区域对刚度矩阵积分的贡献是负的。这违反了被积函数核 $(J^{-1}J^{-T})\\det J$ 的局部正定性，并且可能破坏双线性形式的全局矫顽性，而有限元解的存在性和唯一性依赖于此。\n\n- **正定性**：如果来自 $\\mathcal{N}$ 的负贡献足够大，最终的单元刚度矩阵 $A^e$ 可能不是半正定的。组装这样的矩阵可能导致全局刚度矩阵非正定，这意味着离散系统 $AU=F$ 是病态的，并且可能没有唯一解。\n\n- **降阶积分**：双线性单元的标准数值积分使用 $2 \\times 2$ 高斯求积法则，其求积点位于 $(\\xi_q, \\eta_q) = (\\pm 1/\\sqrt{3}, \\pm 1/\\sqrt{3})$。让我们在这些点上评估 $\\det J = \\frac{1}{8}(8 + 7\\xi + 3\\eta)$ 的符号。令 $g=1/\\sqrt{3} \\approx 0.577$。\n$$ 8+7\\xi+3\\eta > 0 \\iff 8 > -7\\xi-3\\eta $$\n在所有四个点处：\n- $(\\xi,\\eta)=(g,g)$: $8+10g > 0$。\n- $(\\xi,\\eta)=(g,-g)$: $8+4g > 0$。\n- $(\\xi,\\eta)=(-g,g)$: $8-4g = 8-4/\\sqrt{3} > 8-4/1.5 > 0$。更精确地，$8 > 4/\\sqrt{3} \\iff 2 > 1/\\sqrt{3} \\iff 4 > 1/3$，这是成立的。\n- $(\\xi,\\eta)=(-g,-g)$: $8-10g = 8-10/\\sqrt{3} > 8-10/1.5 > 0$。更精确地，$8 > 10/\\sqrt{3} \\iff 8\\sqrt{3} > 10 \\iff 64 \\times 3 > 100 \\iff 192 > 100$，这是成立的。\n由于在所有四个标准高斯点上 $\\det J > 0$，求积法则将计算出一个正定的单元刚度矩阵。折叠单元（其中 $\\det J  0$）的病态问题被完全漏掉了。这是对畸变单元使用降阶积分的一个严重缺陷：代码可能无错执行，但所得解是非物理且不正确的，因为它基于一个无效、扭曲的网格单元。负的雅可比行列式表明从 $\\hat{K}$ 到 $K$ 的映射不是一一对应的，而这一一对应性是有效有限元网格的基本要求。",
            "answer": "$$\\boxed{\\frac{2}{21}}$$"
        }
    ]
}