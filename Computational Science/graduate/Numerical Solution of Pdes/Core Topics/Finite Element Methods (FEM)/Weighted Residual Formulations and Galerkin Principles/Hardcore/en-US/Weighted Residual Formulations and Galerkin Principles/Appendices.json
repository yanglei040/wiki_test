{
    "hands_on_practices": [
        {
            "introduction": "The cornerstone of the Finite Element Method (FEM) lies in its ability to transform a continuous partial differential equation into a discrete system of algebraic equations. This first practice guides you through the essential mechanics of this process for the classic one-dimensional Poisson equation. By deriving the element stiffness matrix for simple linear 'hat' functions and assembling them into a global matrix, you will build the core computational structure used in virtually all FEM analyses .",
            "id": "3462571",
            "problem": "Consider the boundary value problem on the open interval $\\Omega=(0,1)$: find $u:\\Omega\\to\\mathbb{R}$ such that $-\\frac{d^{2}u}{dx^{2}}=f$ in $\\Omega$ with homogeneous Dirichlet boundary conditions $u(0)=0$ and $u(1)=0$. Using the weighted residual method and the Galerkin principle, construct a conforming finite element approximation with continuous, piecewise linear (hat) basis functions on a uniform mesh of $N$ subintervals of equal length $h=\\frac{1}{N}$, with nodes $x_{i}=ih$ for $i=0,1,\\dots,N$. \n\nStarting from the weak formulation obtained by integration by parts and the definition of the Sobolev space $H_{0}^{1}(0,1)$, derive the element stiffness matrix on an arbitrary element and assemble the global stiffness matrix explicitly for the $(N-1)\\times(N-1)$ linear system associated with the interior nodes. Then, as a scalar diagnostic that captures the conditioning of the discrete operator, determine the determinant of the resulting global stiffness matrix as a closed-form analytic expression in $N$.\n\nProvide your final answer as a single closed-form expression in $N$. Do not approximate. No units are required.",
            "solution": "The problem statement is a standard exercise in the finite element method for a one-dimensional boundary value problem. It is mathematically and scientifically sound, self-contained, and well-posed. All givens are consistent and sufficient for deriving a unique, meaningful solution. Therefore, the problem is valid.\n\nThe subject problem is to solve the differential equation\n$$\n-\\frac{d^{2}u}{dx^{2}} = f(x) \\quad \\text{for } x \\in \\Omega = (0,1)\n$$\nwith homogeneous Dirichlet boundary conditions $u(0)=0$ and $u(1)=0$.\n\nFirst, we derive the weak formulation. We multiply the equation by a test function $v(x)$ from the Sobolev space $H_{0}^{1}(0,1)$, which is the space of functions that are square-integrable, have square-integrable weak derivatives, and vanish at the boundaries $x=0$ and $x=1$. Integrating over the domain $\\Omega=(0,1)$ yields:\n$$\n\\int_{0}^{1} \\left(-\\frac{d^{2}u}{dx^{2}}\\right) v(x) \\,dx = \\int_{0}^{1} f(x) v(x) \\,dx\n$$\nApplying integration by parts to the left-hand side, we obtain:\n$$\n\\left[-\\frac{du}{dx} v(x)\\right]_{0}^{1} + \\int_{0}^{1} \\frac{du}{dx} \\frac{dv}{dx} \\,dx = \\int_{0}^{1} f(x) v(x) \\,dx\n$$\nSince $v \\in H_{0}^{1}(0,1)$, we have $v(0)=0$ and $v(1)=0$, causing the boundary term to vanish. The weak formulation is thus: Find $u \\in H_{0}^{1}(0,1)$ such that\n$$\na(u,v) = L(v) \\quad \\forall v \\in H_{0}^{1}(0,1)\n$$\nwhere the bilinear form $a(u,v)$ and the linear functional $L(v)$ are defined as:\n$$\na(u,v) = \\int_{0}^{1} \\frac{du}{dx} \\frac{dv}{dx} \\,dx\n$$\n$$\nL(v) = \\int_{0}^{1} f(x) v(x) \\,dx\n$$\nFor the finite element approximation, we discretize the domain $\\Omega=(0,1)$ into $N$ subintervals of equal length $h=\\frac{1}{N}$. The nodes are located at $x_i = ih$ for $i=0, 1, \\dots, N$. We seek an approximate solution $u_h(x)$ in a finite-dimensional subspace $V_h \\subset H_{0}^{1}(0,1)$. The subspace $V_h$ is spanned by continuous, piecewise linear (hat) basis functions $\\phi_i(x)$ for $i=1, \\dots, N-1$. The basis functions $\\phi_0(x)$ and $\\phi_N(x)$ are excluded to enforce the homogeneous boundary conditions.\n\nThe approximate solution is written as a linear combination of these basis functions:\n$$\nu_h(x) = \\sum_{j=1}^{N-1} U_j \\phi_j(x)\n$$\nwhere $U_j$ are the unknown coefficients representing the value of the solution at the interior nodes $x_j$. The basis function $\\phi_j(x)$ is defined by $\\phi_j(x_i) = \\delta_{ij}$ and is given by:\n$$\n\\phi_j(x) = \\begin{cases}\n\\frac{x - x_{j-1}}{h}  \\text{for } x \\in [x_{j-1}, x_j] \\\\\n\\frac{x_{j+1} - x}{h}  \\text{for } x \\in [x_j, x_{j+1}] \\\\\n0  \\text{otherwise}\n\\end{cases}\n$$\nThe derivative of the basis function is a piecewise constant function:\n$$\n\\frac{d\\phi_j}{dx} = \\begin{cases}\n\\frac{1}{h}  \\text{for } x \\in (x_{j-1}, x_j) \\\\\n-\\frac{1}{h}  \\text{for } x \\in (x_j, x_{j+1}) \\\\\n0  \\text{otherwise}\n\\end{cases}\n$$\nAccording to the Galerkin principle, we choose the test functions to be the basis functions themselves, i.e., $v(x) = \\phi_i(x)$ for $i=1, \\dots, N-1$. Substituting the approximation $u_h$ into the weak form gives a system of linear equations $A\\mathbf{U} = \\mathbf{F}$, where the entries of the global stiffness matrix $A$ are $A_{ij} = a(\\phi_j, \\phi_i)$ and the entries of the load vector $\\mathbf{F}$ are $F_i = L(\\phi_i)$.\n\nTo find $A$, we first derive the element stiffness matrix $K^e$ for a generic element $\\Omega_e = [x_k, x_{k+1}]$. On this element, the solution is approximated using local basis functions corresponding to the element's two nodes. In local coordinates, these are the linear functions $N_1(\\xi)=1-\\xi$ and $N_2(\\xi)=\\xi$ where $\\xi=\\frac{x-x_k}{h}$. Their derivatives with respect to $x$ are $\\frac{dN_1}{dx}=-\\frac{1}{h}$ and $\\frac{dN_2}{dx}=\\frac{1}{h}$. The element stiffness matrix entries are $K^e_{ab} = \\int_{x_k}^{x_{k+1}} \\frac{dN_a}{dx} \\frac{dN_b}{dx} dx$ for $a,b \\in \\{1,2\\}$.\n$$\nK^e_{11} = \\int_{x_k}^{x_{k+1}} \\left(-\\frac{1}{h}\\right)\\left(-\\frac{1}{h}\\right) \\,dx = \\frac{1}{h^2} \\int_{x_k}^{x_{k+1}} dx = \\frac{h}{h^2} = \\frac{1}{h}\n$$\n$$\nK^e_{12} = K^e_{21} = \\int_{x_k}^{x_{k+1}} \\left(-\\frac{1}{h}\\right)\\left(\\frac{1}{h}\\right) \\,dx = -\\frac{1}{h^2} \\int_{x_k}^{x_{k+1}} dx = -\\frac{h}{h^2} = -\\frac{1}{h}\n$$\n$$\nK^e_{22} = \\int_{x_k}^{x_{k+1}} \\left(\\frac{1}{h}\\right)\\left(\\frac{1}{h}\\right) \\,dx = \\frac{1}{h^2} \\int_{x_k}^{x_{k+1}} dx = \\frac{h}{h^2} = \\frac{1}{h}\n$$\nThus, the element stiffness matrix is:\n$$\nK^e = \\frac{1}{h} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix}\n$$\nThe global stiffness matrix $A$ is assembled from these element matrices. The size of $A$ is $(N-1) \\times (N-1)$ corresponding to the interior nodes. The entries $A_{ij} = a(\\phi_j, \\phi_i) = \\int_0^1 \\frac{d\\phi_j}{dx}\\frac{d\\phi_i}{dx} dx$.\nThe supports of $\\phi_i$ and $\\phi_j$ are disjoint if $|i-j|  1$, so $A_{ij}=0$ for $|i-j|1$.\nFor the diagonal entries $A_{ii}$:\n$$\nA_{ii} = \\int_{0}^{1} \\left(\\frac{d\\phi_i}{dx}\\right)^2 \\,dx = \\int_{x_{i-1}}^{x_i} \\left(\\frac{1}{h}\\right)^2 \\,dx + \\int_{x_i}^{x_{i+1}} \\left(-\\frac{1}{h}\\right)^2 \\,dx = \\frac{h}{h^2} + \\frac{h}{h^2} = \\frac{2}{h}\n$$\nFor the off-diagonal entries $A_{i,i+1}$:\n$$\nA_{i,i+1} = \\int_{0}^{1} \\frac{d\\phi_{i+1}}{dx}\\frac{d\\phi_i}{dx} \\,dx = \\int_{x_i}^{x_{i+1}} \\left(\\frac{1}{h}\\right)\\left(-\\frac{1}{h}\\right) \\,dx = -\\frac{h}{h^2} = -\\frac{1}{h}\n$$\nBy symmetry, $A_{i+1,i} = A_{i,i+1} = -\\frac{1}{h}$.\nThe global stiffness matrix is a tridiagonal matrix:\n$$\nA = \\frac{1}{h}\n\\begin{pmatrix}\n2  -1  0  \\cdots  0 \\\\\n-1  2  -1  \\cdots  0 \\\\\n0  -1  2  \\cdots  0 \\\\\n\\vdots  \\vdots  \\ddots  \\ddots  \\vdots \\\\\n0  0  \\cdots  -1  2\n\\end{pmatrix}_{(N-1)\\times(N-1)}\n$$\nWe need to find the determinant of this matrix.\n$$\n\\det(A) = \\left(\\frac{1}{h}\\right)^{N-1} \\det(T_{N-1})\n$$\nwhere $T_k$ is the $k \\times k$ tridiagonal matrix with $2$ on the main diagonal and $-1$ on the super- and sub-diagonals. Let $D_k = \\det(T_k)$. We can establish a recurrence relation for $D_k$ by cofactor expansion along the first row:\n$$\nD_k = 2 D_{k-1} - (-1) \\det\n\\begin{pmatrix}\n-1  -1  0  \\cdots \\\\\n0  2  -1  \\cdots \\\\\n0  -1  2  \\cdots \\\\\n\\vdots  \\vdots  \\vdots  \\ddots\n\\end{pmatrix}\n$$\nExpanding the second determinant along its first column yields $-1 \\cdot D_{k-2}$.\nThis gives the recurrence relation:\n$$\nD_k = 2 D_{k-1} - D_{k-2}\n$$\nWe compute the first few terms:\n$D_1 = \\det(T_1) = \\det([2]) = 2$.\n$D_2 = \\det(T_2) = \\det\\begin{pmatrix} 2  -1 \\\\ -1  2 \\end{pmatrix} = 4-1=3$.\nThe sequence $D_k$ follows $D_1=2, D_2=3, D_3 = 2(3)-2 = 4, \\dots$. By induction, we can prove that $D_k=k+1$.\nBase case: $D_1=1+1=2$, which is true.\nInductive step: Assume $D_m=m+1$ for $mk$. Then:\n$D_k = 2D_{k-1} - D_{k-2} = 2((k-1)+1) - ((k-2)+1) = 2k - (k-1) = k+1$.\nThe formula holds for all $k \\ge 1$.\nFor our $(N-1) \\times (N-1)$ matrix, we need $D_{N-1}$:\n$$\nD_{N-1} = (N-1)+1 = N\n$$\nFinally, substituting this back into the expression for $\\det(A)$ and using $h=\\frac{1}{N}$:\n$$\n\\det(A) = \\left(\\frac{1}{h}\\right)^{N-1} D_{N-1} = (N)^{N-1} \\cdot N = N^N\n$$\nThe determinant of the global stiffness matrix is $N^N$.",
            "answer": "$$\\boxed{N^{N}}$$"
        },
        {
            "introduction": "While modern FEM is typically taught starting from the weak (or variational) formulation, it is fundamentally a weighted residual method that can be applied directly to the strong form of the PDE. This exercise provides a crucial theoretical bridge, demonstrating how applying the Galerkin principle to the strong residual and using integration by parts naturally leads to the familiar weak form. Understanding this connection  deepens your insight into why the weak formulation is both powerful and computationally advantageous.",
            "id": "3462644",
            "problem": "Consider the one-dimensional second-order linear elliptic partial differential equation $-\\frac{d}{dx}\\!\\left(a(x)\\,\\frac{d u}{dx}\\right)=f(x)$ posed on the interval $[0,h]$, where $h0$ is the length of a single interior finite element and $a(x)$ is a strictly positive coefficient. Assume that $a(x)$ is differentiable and let $a(x)=a_0+a_1 x$ with constants $a_00$ and $a_1\\in\\mathbb{R}$, and let $f(x)=f_0$ be a constant source. Let $u(x)$ be approximated in the Finite Element Method (FEM) by a linear finite element field $u_h(x)=N_1(x)\\,u_1+N_2(x)\\,u_2$, where the nodal degrees of freedom $u_1,u_2\\in\\mathbb{R}$, and the standard shape functions on $[0,h]$ are $N_1(x)=1-\\frac{x}{h}$ and $N_2(x)=\\frac{x}{h}$. Consider the Galerkin principle, where test (weight) functions $w_h$ are drawn from the same span as the trial space, and define the element-level strong residual as $R_e(u_h)=-\\frac{d}{dx}\\!\\left(a(x)\\,\\frac{d u_h}{dx}\\right)-f(x)$ on the element.\n\nStarting from the foundational definition of the weighted residual method and the calculus identity for integration by parts, do the following:\n\n- Compute the explicit expression for $R_e(u_h)$ on the element $[0,h]$.\n- Evaluate the weighted residual integral $\\int_{0}^{h} N_1(x)\\,R_e(u_h)\\,dx$.\n- Using integration by parts, show how $\\int_{0}^{h} w_h\\,R_e(u_h)\\,dx$ decomposes into a boundary flux term and the bilinear form associated with the weak statement, and hence demonstrate that the resulting stiffness assembly coincides with that obtained from the weak form, up to cancellation of interior boundary terms upon global assembly across elements.\n\nProvide your final answer as the single closed-form analytic expression for $\\int_{0}^{h} N_1(x)\\,R_e(u_h)\\,dx$, expressed in terms of $a_0$, $a_1$, $f_0$, $h$, $u_1$, and $u_2$. No numerical substitution is required. Do not include any units in your final answer.",
            "solution": "The problem requires a three-part analysis based on the weighted residual method for a one-dimensional linear elliptic equation. First, we compute the explicit form of the strong residual for a linear finite element approximation. Second, we evaluate the weighted residual integral using the first shape function as the weight function. Third, we demonstrate the connection between the weighted residual method applied to the strong form and the standard weak (or variational) formulation.\n\nLet the differential equation be given by\n$$-\\frac{d}{dx}\\!\\left(a(x)\\,\\frac{d u}{dx}\\right)=f(x) \\quad \\text{for } x \\in [0,h]$$\nwith $a(x) = a_0 + a_1 x$ and $f(x) = f_0$. The finite element approximation is $u_h(x) = N_1(x)u_1 + N_2(x)u_2$, where the linear shape functions on the element $[0,h]$ are $N_1(x) = 1 - \\frac{x}{h}$ and $N_2(x) = \\frac{x}{h}$.\n\n**Part 1: Compute the explicit expression for the element-level strong residual $R_e(u_h)$**\n\nThe element-level strong residual is defined as $R_e(u_h) = -\\frac{d}{dx}\\!\\left(a(x)\\,\\frac{d u_h}{dx}\\right)-f(x)$. First, we compute the derivative of the approximation $u_h(x)$:\n$$u_h(x) = \\left(1-\\frac{x}{h}\\right)u_1 + \\frac{x}{h}u_2$$\n$$\\frac{d u_h}{dx} = -\\frac{1}{h}u_1 + \\frac{1}{h}u_2 = \\frac{u_2 - u_1}{h}$$\nThe derivative $\\frac{d u_h}{dx}$ is constant over the element. Next, we compute the term $a(x)\\frac{d u_h}{dx}$:\n$$a(x)\\frac{d u_h}{dx} = (a_0 + a_1 x) \\left(\\frac{u_2 - u_1}{h}\\right)$$\nNow we take the derivative of this expression with respect to $x$:\n$$\\frac{d}{dx}\\!\\left(a(x)\\,\\frac{d u_h}{dx}\\right) = \\frac{d}{dx}\\left[ (a_0 + a_1 x) \\left(\\frac{u_2 - u_1}{h}\\right) \\right]$$\nSince $\\frac{u_2 - u_1}{h}$ is a constant, we can factor it out:\n$$\\frac{d}{dx}\\!\\left(a(x)\\,\\frac{d u_h}{dx}\\right) = \\left(\\frac{u_2 - u_1}{h}\\right) \\frac{d}{dx}(a_0 + a_1 x) = \\left(\\frac{u_2 - u_1}{h}\\right) a_1$$\nFinally, we assemble the strong residual $R_e(u_h)$:\n$$R_e(u_h) = -\\frac{d}{dx}\\!\\left(a(x)\\,\\frac{d u_h}{dx}\\right) - f(x) = -a_1\\left(\\frac{u_2 - u_1}{h}\\right) - f_0$$\nThis is the explicit expression for the strong residual on the element. Note that it is constant over the element because the trial function is linear and the coefficient $a(x)$ is linear.\n\n**Part 2: Evaluate the weighted residual integral $\\int_{0}^{h} N_1(x)\\,R_e(u_h)\\,dx$**\n\nThe Galerkin method requires the residual to be orthogonal to the test functions, which are chosen from the same space as the trial functions. Here, we use the test function $w_h(x) = N_1(x) = 1 - \\frac{x}{h}$. We evaluate the integral:\n$$\\int_{0}^{h} N_1(x)\\,R_e(u_h)\\,dx = \\int_{0}^{h} \\left(1 - \\frac{x}{h}\\right) \\left[-a_1\\left(\\frac{u_2 - u_1}{h}\\right) - f_0\\right] dx$$\nThe term containing the residual, $-a_1\\left(\\frac{u_2 - u_1}{h}\\right) - f_0$, is constant with respect to the integration variable $x$. We can therefore move it outside the integral:\n$$= \\left[-a_1\\left(\\frac{u_2 - u_1}{h}\\right) - f_0\\right] \\int_{0}^{h} \\left(1 - \\frac{x}{h}\\right) dx$$\nWe now evaluate the integral of the shape function $N_1(x)$ over the element domain:\n$$\\int_{0}^{h} \\left(1 - \\frac{x}{h}\\right) dx = \\left[x - \\frac{x^2}{2h}\\right]_0^h = \\left(h - \\frac{h^2}{2h}\\right) - (0) = h - \\frac{h}{2} = \\frac{h}{2}$$\nSubstituting this result back, we obtain the final expression for the weighted residual integral:\n$$\\int_{0}^{h} N_1(x)\\,R_e(u_h)\\,dx = \\left[-a_1\\left(\\frac{u_2 - u_1}{h}\\right) - f_0\\right] \\left(\\frac{h}{2}\\right)$$\n$$= -a_1\\left(\\frac{u_2 - u_1}{h}\\right)\\frac{h}{2} - f_0\\frac{h}{2} = -\\frac{a_1}{2}(u_2 - u_1) - \\frac{f_0 h}{2}$$\n$$= \\frac{a_1}{2}(u_1 - u_2) - \\frac{f_0 h}{2}$$\n\n**Part 3: Decomposition into boundary and bilinear terms and relation to the weak form**\n\nWe start from the foundational statement of the weighted residual method for a general test function $w_h(x)$ from the trial space:\n$$\\int_{0}^{h} w_h(x)\\,R_e(u_h)\\,dx = \\int_{0}^{h} w_h(x) \\left[-\\frac{d}{dx}\\!\\left(a(x)\\,\\frac{d u_h}{dx}\\right)-f(x)\\right] dx = 0$$\nThis can be written as:\n$$-\\int_{0}^{h} w_h(x)\\frac{d}{dx}\\!\\left(a(x)\\,\\frac{d u_h}{dx}\\right)dx = \\int_{0}^{h} w_h(x) f(x) dx$$\nWe apply integration by parts to the left-hand side integral, using the formula $\\int v \\, du' = [vu] - \\int v' \\, u$. Let $v = w_h(x)$ and $u' = \\frac{d}{dx}\\!\\left(a(x)\\,\\frac{d u_h}{dx}\\right)$. Then $v' = \\frac{dw_h}{dx}$ and $u = a(x)\\,\\frac{d u_h}{dx}$.\n$$-\\int_{0}^{h} w_h(x)\\frac{d}{dx}\\!\\left(a(x)\\,\\frac{d u_h}{dx}\\right)dx = - \\left( \\left[w_h(x) a(x) \\frac{d u_h}{dx}\\right]_0^h - \\int_0^h \\frac{d w_h}{dx} a(x) \\frac{d u_h}{dx} dx \\right)$$\n$$= \\int_0^h a(x) \\frac{d w_h}{dx} \\frac{d u_h}{dx} dx - \\left[w_h(x) a(x) \\frac{d u_h}{dx}\\right]_0^h$$\nSubstituting this back into the weighted residual equation gives:\n$$\\int_0^h a(x) \\frac{d w_h}{dx} \\frac{d u_h}{dx} dx - \\left[w_h(x) a(x) \\frac{d u_h}{dx}\\right]_0^h = \\int_0^h w_h(x) f(x) dx$$\nThis equation demonstrates the decomposition. We can identify the terms:\n1.  **Bilinear Form:** The term $\\int_0^h a(x) \\frac{d w_h}{dx} \\frac{d u_h}{dx} dx$ is the bilinear form $B(u_h, w_h)$. When the trial and test functions are expanded in terms of basis functions ($u_h = \\sum_j N_j u_j$, $w_h = N_i$), this term yields the element stiffness matrix with entries $K_{ij} = \\int_0^h a(x) \\frac{dN_i}{dx}\\frac{dN_j}{dx}dx$.\n2.  **Boundary Flux Term:** The term $\\left[w_h(x) a(x) \\frac{d u_h}{dx}\\right]_0^h = w_h(h) a(h) \\left.\\frac{du_h}{dx}\\right|_{x=h} - w_h(0) a(0) \\left.\\frac{du_h}{dx}\\right|_{x=0}$ represents the contribution from the element boundaries. The quantity $q_h(x) = -a(x) \\frac{du_h}{dx}$ is the numerical flux.\n3.  **Linear Form:** The term $\\int_0^h w_h(x) f(x) dx$ is the linear form $L(w_h)$, which yields the element load vector $F_i = \\int_0^h N_i(x) f(x) dx$.\n\nThe equation $B(u_h, w_h) = L(w_h) + \\text{boundary terms}$ is precisely the weak form of the problem on the element level. Applying integration by parts to the weighted strong residual is the standard procedure to derive the weak formulation, which is computationally advantageous as it lowers the required order of differentiability for the trial functions.\n\nThe stiffness assembly produced from the weak form is derived directly from the bilinear form $B(u_h, w_h)$. Our derivation shows this bilinear form arises naturally from the weighted strong residual statement after one integration by parts. The crucial point is that upon global assembly of the finite element system, the boundary flux terms for adjacent interior elements cancel out. For a node shared by element $(e)$ and element $(e+1)$, the term from element $(e)$ is $-w_h(x_{node}) q_h(x_{node}^-)$ and from element $(e+1)$ is $+w_h(x_{node}) q_h(x_{node}^+)$. The continuity of flux, $q_h(x_{node}^-) = q_h(x_{node}^+)$, enforced by the weak solution, ensures these terms sum to zero at all interior nodes. Therefore, the stiffness assembly derived from the weak form indeed coincides with that obtained from the strong form, once the boundary terms are properly handled via integration by parts and inter-element cancellation.",
            "answer": "$$\\boxed{\\frac{a_1}{2}(u_1 - u_2) - \\frac{f_0 h}{2}}$$"
        },
        {
            "introduction": "Extending the Galerkin method to time-dependent problems, such as the heat equation, introduces a 'mass matrix' alongside the stiffness matrix. This practice explores a pivotal choice in numerical implementation: using the mathematically rigorous 'consistent' mass matrix versus a simplified 'lumped' diagonal version. By analyzing how this choice affects the eigenvalue spectrum and, consequently, the stability limits of explicit time-stepping schemes, you will gain a practical understanding of the trade-offs between accuracy and computational efficiency in dynamic simulations .",
            "id": "3462580",
            "problem": "Consider the one-dimensional diffusion equation (a parabolic partial differential equation) on the interval $\\left[0,L\\right]$ with homogeneous Dirichlet boundary conditions\n$$\nu_{t}(x,t)-\\alpha\\,u_{xx}(x,t)=0,\\quad x\\in(0,L),\\; t0,\\qquad u(0,t)=u(L,t)=0,\n$$\nwhere $\\alpha0$ is a constant diffusion coefficient. Using the weighted residual methodology with the Galerkin principle (trial and test spaces identical), derive the semi-discrete finite element system based on the Finite Element Method (FEM) with continuous, piecewise linear basis functions on a uniform mesh. Let there be $N$ interior nodes, so the mesh size is $h=L/(N+1)$. This yields a system of ordinary differential equations\n$$\n\\mathbf{M}\\,\\dot{\\mathbf{U}}(t)+\\alpha\\,\\mathbf{K}\\,\\mathbf{U}(t)=\\mathbf{0},\n$$\nwhere $\\mathbf{U}(t)\\in\\mathbb{R}^{N}$ collects the nodal values, $\\mathbf{M}\\in\\mathbb{R}^{N\\times N}$ is the (symmetric, positive definite) mass matrix, and $\\mathbf{K}\\in\\mathbb{R}^{N\\times N}$ is the (symmetric, positive semi-definite) stiffness matrix. The consistent mass matrix arises directly from the Galerkin construction, whereas the lumped mass matrix is obtained by row-sum diagonal approximation of the consistent mass.\n\nUsing the discrete sine basis $\\mathbf{v}^{(j)}$ with components $v^{(j)}_{i}=\\sin\\!\\left(i\\,\\theta_{j}\\right)$ for $i=1,\\dots,N$ and $\\theta_{j}=\\frac{j\\pi}{N+1}$, analyze the generalized eigenvalue problem\n$$\n\\mathbf{K}\\,\\mathbf{v}^{(j)}=\\lambda_{j}\\,\\mathbf{M}\\,\\mathbf{v}^{(j)}\n$$\nfor both the consistent and lumped mass matrices. From first principles, derive closed-form expressions for the spectra $\\{\\lambda_{j}\\}$ in terms of $h$ and $\\theta_{j}$ for both mass treatments. Then, using the forward Euler explicit time-stepping method applied to the semi-discrete system $\\dot{\\mathbf{U}}(t)=-\\alpha\\,\\mathbf{M}^{-1}\\mathbf{K}\\,\\mathbf{U}(t)$, determine the maximum stable time-step $\\Delta t_{\\max}$ in each case via the linear absolute stability condition. Finally, compute the large-$N$ limit of the ratio of these maximum stable time steps,\n$$\n\\lim_{N\\to\\infty}\\frac{\\Delta t_{\\max}^{\\text{lumped}}}{\\Delta t_{\\max}^{\\text{consistent}}},\n$$\nand report this limit as your single final answer. Express your final answer as a dimensionless number. No rounding is required.",
            "solution": "The weak formulation of the governing PDE is obtained by multiplying by a test function $v(x)$ (which vanishes at $x=0$ and $x=L$) and integrating over the domain $[0, L]$.\n$$ \\int_0^L v u_t \\,dx - \\alpha \\int_0^L v u_{xx} \\,dx = 0 $$\nApplying integration by parts to the second term and using the homogeneous Dirichlet boundary conditions yields:\n$$ \\int_0^L v u_t \\,dx + \\alpha \\int_0^L v_x u_x \\,dx = 0 $$\nThe finite element approximation is $u_h(x,t) = \\sum_{j=1}^N U_j(t) \\phi_j(x)$, where $\\phi_j(x)$ are the standard piecewise linear (hat) basis functions on a uniform mesh with nodes $x_i = i h$ for $i=0, \\dots, N+1$. The function $\\phi_j(x)$ is $1$ at node $x_j$ and $0$ at all other nodes.\nThe Galerkin method sets the test functions $v(x)$ to be the basis functions $\\phi_i(x)$ for $i=1, \\dots, N$. Substituting the approximation into the weak form gives the semi-discrete system:\n$$ \\sum_{j=1}^N \\left( \\int_0^L \\phi_i \\phi_j \\,dx \\right) \\dot{U}_j(t) + \\alpha \\sum_{j=1}^N \\left( \\int_0^L \\phi_i' \\phi_j' \\,dx \\right) U_j(t) = 0 $$\nThis is the system $\\mathbf{M}\\,\\dot{\\mathbf{U}}(t)+\\alpha\\,\\mathbf{K}\\,\\mathbf{U}(t)=\\mathbf{0}$, with matrix entries:\nStiffness matrix: $K_{ij} = \\int_0^L \\phi_i' \\phi_j' \\,dx$.\nConsistent Mass matrix: $M_{c,ij} = \\int_0^L \\phi_i \\phi_j \\,dx$.\n\nThe basis functions and their derivatives are:\n$\\phi_j(x) = \\begin{cases} (x-x_{j-1})/h  x \\in [x_{j-1}, x_j] \\\\ (x_{j+1}-x)/h  x \\in [x_j, x_{j+1}] \\\\ 0  \\text{otherwise} \\end{cases}$, and $\\phi_j'(x) = \\begin{cases} 1/h  x \\in (x_{j-1}, x_j) \\\\ -1/h  x \\in (x_j, x_{j+1}) \\\\ 0  \\text{otherwise} \\end{cases}$.\n\nCalculating the integrals yields the well-known tridiagonal matrices:\n$$ K_{ii} = \\int_{x_{i-1}}^{x_i} (1/h)^2 dx + \\int_{x_i}^{x_{i+1}} (-1/h)^2 dx = \\frac{2}{h} $$\n$$ K_{i,i\\pm 1} = \\int_{x_{i-1}}^{x_{i+1}} \\phi_i' \\phi_{i\\pm 1}' dx = -\\frac{1}{h} $$\n$$ M_{c,ii} = \\int_{x_{i-1}}^{x_{i+1}} \\phi_i^2 dx = \\frac{2h}{3} $$\n$$ M_{c,i,i\\pm 1} = \\int_{x_{i-1}}^{x_{i+1}} \\phi_i \\phi_{i\\pm 1} dx = \\frac{h}{6} $$\nThus, the $N \\times N$ matrices are:\n$$ \\mathbf{K} = \\frac{1}{h} \\begin{pmatrix} 2  -1  \\\\ -1  2  -1 \\\\  \\ddots  \\ddots  \\ddots \\\\   -1  2 \\end{pmatrix}, \\quad \\mathbf{M}_c = \\frac{h}{6} \\begin{pmatrix} 4  1  \\\\ 1  4  1 \\\\  \\ddots  \\ddots  \\ddots \\\\   1  4 \\end{pmatrix} $$\nThe lumped mass matrix $\\mathbf{M}_l$ is obtained by summing the rows of $\\mathbf{M}_c$ and placing the sums on the diagonal. For an interior row $i \\in [2, N-1]$, the sum is $h/6 + 4h/6 + h/6 = h$. For the first and last rows ($i=1, N$), the sum is $4h/6 + h/6 = 5h/6$.\n$$ \\mathbf{M}_l = \\text{diag}\\left(\\frac{5h}{6}, h, \\dots, h, \\frac{5h}{6}\\right) $$\nThe generalized eigenvalue problem is $\\mathbf{K}\\mathbf{v}^{(j)} = \\lambda_j \\mathbf{M} \\mathbf{v}^{(j)}$. The eigenvalues $\\lambda_j$ are the eigenvalues of the matrix $\\mathbf{M}^{-1}\\mathbf{K}$.\n\nFirst, we find the eigenvalues of $\\mathbf{K}$ and $\\mathbf{M}_c$ with respect to the basis $\\mathbf{v}^{(j)}$. The $i$-th component of $\\mathbf{K}\\mathbf{v}^{(j)}$ is:\n$$ (\\mathbf{K}\\mathbf{v}^{(j)})_i = \\frac{1}{h}(-v_{i-1}^{(j)} + 2v_i^{(j)} - v_{i+1}^{(j)}) = \\frac{1}{h}(-\\sin((i-1)\\theta_j) + 2\\sin(i\\theta_j) - \\sin((i+1)\\theta_j)) $$\nUsing the identity $\\sin(A-B)+\\sin(A+B) = 2\\sin A\\cos B$, we get:\n$$ (\\mathbf{K}\\mathbf{v}^{(j)})_i = \\frac{1}{h}(2v_i^{(j)} - 2v_i^{(j)}\\cos\\theta_j) = \\frac{2}{h}(1-\\cos\\theta_j)v_i^{(j)} = \\frac{4}{h}\\sin^2\\left(\\frac{\\theta_j}{2}\\right) v_i^{(j)} $$\nSo, $\\mathbf{v}^{(j)}$ are eigenvectors of $\\mathbf{K}$ with eigenvalues $\\mu_j = \\frac{4}{h}\\sin^2(\\frac{\\theta_j}{2})$.\n\nSimilarly, for the consistent mass matrix $\\mathbf{M}_c$:\n$$ (\\mathbf{M}_c\\mathbf{v}^{(j)})_i = \\frac{h}{6}(v_{i-1}^{(j)} + 4v_i^{(j)} + v_{i+1}^{(j)}) = \\frac{h}{6}(2v_i^{(j)}\\cos\\theta_j + 4v_i^{(j)}) = \\frac{h}{3}(2+\\cos\\theta_j)v_i^{(j)} $$\nSo, $\\mathbf{v}^{(j)}$ are eigenvectors of $\\mathbf{M}_c$ with eigenvalues $\\nu_j = \\frac{h}{3}(2+\\cos\\theta_j)$.\n\n**Eigenvalues for the Consistent Mass Case**\nFor $\\mathbf{M}=\\mathbf{M}_c$, the GEP $\\mathbf{K}\\mathbf{v}^{(j)} = \\lambda_j^{\\text{consistent}}\\mathbf{M}_c\\mathbf{v}^{(j)}$ becomes $\\mu_j \\mathbf{v}^{(j)} = \\lambda_j^{\\text{consistent}} \\nu_j \\mathbf{v}^{(j)}$.\n$$ \\lambda_j^{\\text{consistent}} = \\frac{\\mu_j}{\\nu_j} = \\frac{\\frac{4}{h}\\sin^2(\\frac{\\theta_j}{2})}{\\frac{h}{3}(2+\\cos\\theta_j)} = \\frac{12}{h^2}\\frac{\\sin^2(\\frac{\\theta_j}{2})}{2+(1-2\\sin^2(\\frac{\\theta_j}{2}))} = \\frac{12}{h^2}\\frac{\\sin^2(\\frac{\\theta_j}{2})}{3-2\\sin^2(\\frac{\\theta_j}{2})} $$\n\n**Eigenvalues for the Lumped Mass Case**\nFor large $N$, the matrix $\\mathbf{M}_l$ is a rank-2 perturbation of $h\\mathbf{I}$. The maximal eigenvalue of $\\mathbf{M}_l^{-1}\\mathbf{K}$ converges to that of $(h\\mathbf{I})^{-1}\\mathbf{K} = h^{-1}\\mathbf{K}$. We thus analyze the GEP for the simplified lumped system $\\mathbf{M}_l \\approx h\\mathbf{I}$ to find the limiting behavior.\nFor $\\mathbf{M}=h\\mathbf{I}$, the GEP is $\\mathbf{K}\\mathbf{v}^{(j)} = \\lambda_j^{\\text{lumped}}(h\\mathbf{I})\\mathbf{v}^{(j)}$, which gives $\\mu_j \\mathbf{v}^{(j)} = h\\lambda_j^{\\text{lumped}}\\mathbf{v}^{(j)}$.\n$$ \\lambda_j^{\\text{lumped}} = \\frac{\\mu_j}{h} = \\frac{4}{h^2}\\sin^2\\left(\\frac{\\theta_j}{2}\\right) $$\n\n**Stability Analysis**\nThe Forward Euler method applied to $\\dot{\\mathbf{U}} = -\\alpha \\mathbf{M}^{-1}\\mathbf{K} \\mathbf{U}$ is stable if $|1-\\alpha\\Delta t \\lambda_j| \\le 1$ for all eigenvalues $\\lambda_j$ of $\\mathbf{M}^{-1}\\mathbf{K}$. Since $\\mathbf{K}$ is positive semi-definite and $\\mathbf{M}$ is positive definite, $\\lambda_j \\ge 0$. The condition simplifies to $\\alpha\\Delta t \\lambda_j \\le 2$. This must hold for all $j$, so we need $\\Delta t \\le \\frac{2}{\\alpha\\lambda_{\\max}}$, where $\\lambda_{\\max} = \\max_{j} \\lambda_j$. The maximum stable time step is $\\Delta t_{\\max} = \\frac{2}{\\alpha\\lambda_{\\max}}$.\n\nTo find $\\lambda_{\\max}$, we find the maximum of $\\lambda_j$ over $j=1, \\dots, N$.\nThe term $\\sin^2(\\theta_j/2) = \\sin^2(\\frac{j\\pi}{2(N+1)})$ is monotonically increasing for $j \\in [1, N]$.\nThe function $f(s) = s/(3-2s)$ from $\\lambda_j^{\\text{consistent}}$ is also monotonically increasing for $s \\in [0, 1/2]$ since $f'(s)=3/(3-2s)^2>0$.\nTherefore, the maximum eigenvalue in both cases occurs at $j=N$.\nFor $j=N$, $\\theta_N = \\frac{N\\pi}{N+1} = \\pi - \\frac{\\pi}{N+1}$. So $\\sin^2(\\frac{\\theta_N}{2}) = \\sin^2(\\frac{\\pi}{2}-\\frac{\\pi}{2(N+1)}) = \\cos^2(\\frac{\\pi}{2(N+1)})$.\n\nMaximum eigenvalues:\n$$ \\lambda_{\\max}^{\\text{lumped}} = \\frac{4}{h^2}\\cos^2\\left(\\frac{\\pi}{2(N+1)}\\right) $$\n$$ \\lambda_{\\max}^{\\text{consistent}} = \\frac{12}{h^2}\\frac{\\cos^2(\\frac{\\pi}{2(N+1)})}{3-2\\cos^2(\\frac{\\pi}{2(N+1)})} $$\n\nMaximum stable time-steps:\n$$ \\Delta t_{\\max}^{\\text{lumped}} = \\frac{2}{\\alpha\\lambda_{\\max}^{\\text{lumped}}} = \\frac{2h^2}{4\\alpha\\cos^2(\\frac{\\pi}{2(N+1)})} = \\frac{h^2}{2\\alpha\\cos^2(\\frac{\\pi}{2(N+1)})} $$\n$$ \\Delta t_{\\max}^{\\text{consistent}} = \\frac{2}{\\alpha\\lambda_{\\max}^{\\text{consistent}}} = \\frac{2h^2(3-2\\cos^2(\\frac{\\pi}{2(N+1)}))}{12\\alpha\\cos^2(\\frac{\\pi}{2(N+1)})} = \\frac{h^2(3-2\\cos^2(\\frac{\\pi}{2(N+1)}))}{6\\alpha\\cos^2(\\frac{\\pi}{2(N+1)})} $$\n\n**Ratio and Limit**\nThe ratio of the maximum stable time steps is:\n$$ \\frac{\\Delta t_{\\max}^{\\text{lumped}}}{\\Delta t_{\\max}^{\\text{consistent}}} = \\frac{\\frac{h^2}{2\\alpha\\cos^2(\\frac{\\pi}{2(N+1)})}}{\\frac{h^2(3-2\\cos^2(\\frac{\\pi}{2(N+1)}))}{6\\alpha\\cos^2(\\frac{\\pi}{2(N+1)})}} = \\frac{6}{2(3-2\\cos^2(\\frac{\\pi}{2(N+1)}))} = \\frac{3}{3-2\\cos^2(\\frac{\\pi}{2(N+1)})} $$\nWe now compute the limit as $N \\to \\infty$. As $N \\to \\infty$, the argument of the cosine $\\frac{\\pi}{2(N+1)} \\to 0$. Since $\\cos(x) \\to 1$ as $x \\to 0$, we have:\n$$ \\lim_{N\\to\\infty} \\frac{\\Delta t_{\\max}^{\\text{lumped}}}{\\Delta t_{\\max}^{\\text{consistent}}} = \\lim_{N\\to\\infty} \\frac{3}{3-2\\cos^2(\\frac{\\pi}{2(N+1)})} = \\frac{3}{3-2(1)^2} = \\frac{3}{1} = 3 $$\nThis result signifies that for a fine mesh, the explicit time-stepping scheme with a lumped mass matrix allows for a time step that is three times larger than that allowed by the consistent mass matrix.",
            "answer": "$$\\boxed{3}$$"
        }
    ]
}