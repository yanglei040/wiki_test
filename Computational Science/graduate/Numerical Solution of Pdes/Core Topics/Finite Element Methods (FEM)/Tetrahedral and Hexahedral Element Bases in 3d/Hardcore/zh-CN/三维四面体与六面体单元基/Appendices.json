{
    "hands_on_practices": [
        {
            "introduction": "在有限元分析中，我们通过将复杂的物理域离散化为简单的几何单元（如四面体或六面体）来求解偏微分方程。等参映射 (isoparametric mapping) 是连接固定、简单的参考单元与网格中任意形状和方向的物理单元之间的桥梁。此映射的雅可比矩阵 (Jacobian matrix) 及其行列式是保证分析有效性的核心，这个练习将通过计算雅可比行列式来实践评估一个单元映射是否保持方向，这是确保有限元模型物理真实性的关键一步。",
            "id": "3453395",
            "problem": "考虑在有限元法 (FEM) 中用于三维问题的标准线性等参映射，该映射从顶点为 $(0,0,0)$、$(1,0,0)$、$(0,1,0)$、$(0,0,1)$ 的参考四面体 $\\hat{T}$ 映至 $\\mathbb{R}^{3}$ 中的一个物理四面体单元 $T$。该映射定义为 $x(\\boldsymbol{\\xi}) = \\sum_{i=1}^{4} x_{i} \\phi_{i}(\\boldsymbol{\\xi})$，其中 $x_{i} \\in \\mathbb{R}^{3}$ 是物理顶点坐标，$\\{\\phi_{i}\\}_{i=1}^{4}$ 是参考四面体 $\\hat{T}$ 上的线性节点基函数，具体为 $\\phi_{1}(\\boldsymbol{\\xi}) = 1 - \\xi_{1} - \\xi_{2} - \\xi_{3}$，$\\phi_{2}(\\boldsymbol{\\xi}) = \\xi_{1}$，$\\phi_{3}(\\boldsymbol{\\xi}) = \\xi_{2}$ 和 $\\phi_{4}(\\boldsymbol{\\xi}) = \\xi_{3}$。该映射的雅可比矩阵 $J$ 为 $J = \\nabla_{\\boldsymbol{\\xi}} x(\\boldsymbol{\\xi})$，对于此仿射映射，该矩阵是常数矩阵。\n\n设物理四面体 $T$ 的顶点与参考单元的顺序一致，如下所示：\n- $x_{1} = (0,1,2)$，\n- $x_{2} = (2,1,3)$，\n- $x_{3} = (1,4,2)$，\n- $x_{4} = (3,0,5)$。\n\n仅使用等参映射、雅可比矩阵和仿射变换下定向体积缩放的基本定义，计算此映射的行列式 $\\det J$。然后，根据 $\\hat{T}$ 和 $T$ 之间映射的定向一致性和单元反转来解释 $\\det J$ 的符号。请精确给出 $\\det J$ 的最终数值，不要进行四舍五入。您的解释性陈述应在推导过程中以文字形式给出，但只有 $\\det J$ 的值会进行数值评分。",
            "solution": "问题要求计算并解释从参考四面体 $\\hat{T}$ 到物理四面体 $T$ 的线性等参映射的雅可比矩阵的行列式。\n\n首先，我们建立理论框架。从参考坐标系 $\\boldsymbol{\\xi} = (\\xi_1, \\xi_2, \\xi_3)$ 到物理坐标系 $x = (x^{(1)}, x^{(2)}, x^{(3)})$ 的映射由下式给出：\n$$\nx(\\boldsymbol{\\xi}) = \\sum_{i=1}^{4} x_{i} \\phi_{i}(\\boldsymbol{\\xi})\n$$\n其中 $x_i \\in \\mathbb{R}^{3}$ 是物理单元 $T$ 的顶点坐标，$\\{\\phi_i\\}_{i=1}^{4}$ 是参考单元 $\\hat{T}$ 上的线性基函数（或形函数）。参考单元的顶点为 $\\hat{v}_1=(0,0,0)$、$\\hat{v}_2=(1,0,0)$、$\\hat{v}_3=(0,1,0)$ 和 $\\hat{v}_4=(0,0,1)$。给定的形函数为：\n$\\phi_{1}(\\boldsymbol{\\xi}) = 1 - \\xi_{1} - \\xi_{2} - \\xi_{3}$\n$\\phi_{2}(\\boldsymbol{\\xi}) = \\xi_{1}$\n$\\phi_{3}(\\boldsymbol{\\xi}) = \\xi_{2}$\n$\\phi_{4}(\\boldsymbol{\\xi}) = \\xi_{3}$\n\n该映射的雅可比矩阵 $J$ 由其分量 $J_{ij} = \\frac{\\partial x^{(i)}}{\\partial \\xi_j}$ 定义。对于仿射映射，雅可比矩阵是一个常数矩阵。雅可比矩阵的列是向量 $\\frac{\\partial x}{\\partial \\xi_j}$（$j=1, 2, 3$）。我们通过对映射函数求导来计算这些列：\n$$\n\\frac{\\partial x}{\\partial \\xi_j} = \\frac{\\partial}{\\partial \\xi_j} \\left( \\sum_{i=1}^{4} x_{i} \\phi_{i}(\\boldsymbol{\\xi}) \\right) = \\sum_{i=1}^{4} x_{i} \\frac{\\partial \\phi_{i}}{\\partial \\xi_j}\n$$\n我们求出形函数关于参考坐标的偏导数：\n$\\frac{\\partial \\phi_1}{\\partial \\xi_1}=-1$，$\\frac{\\partial \\phi_2}{\\partial \\xi_1}=1$，$\\frac{\\partial \\phi_3}{\\partial \\xi_1}=0$，$\\frac{\\partial \\phi_4}{\\partial \\xi_1}=0$。\n$\\frac{\\partial \\phi_1}{\\partial \\xi_2}=-1$，$\\frac{\\partial \\phi_2}{\\partial \\xi_2}=0$，$\\frac{\\partial \\phi_3}{\\partial \\xi_2}=1$，$\\frac{\\partial \\phi_4}{\\partial \\xi_2}=0$。\n$\\frac{\\partial \\phi_1}{\\partial \\xi_3}=-1$，$\\frac{\\partial \\phi_2}{\\partial \\xi_3}=0$，$\\frac{\\partial \\phi_3}{\\partial \\xi_3}=0$，$\\frac{\\partial \\phi_4}{\\partial \\xi_3}=1$。\n\n使用这些导数，雅可比矩阵的列为：\n第1列：$\\frac{\\partial x}{\\partial \\xi_1} = x_1(-1) + x_2(1) + x_3(0) + x_4(0) = x_2 - x_1$。\n第2列：$\\frac{\\partial x}{\\partial \\xi_2} = x_1(-1) + x_2(0) + x_3(1) + x_4(0) = x_3 - x_1$。\n第3列：$\\frac{\\partial x}{\\partial \\xi_3} = x_1(-1) + x_2(0) + x_3(0) + x_4(1) = x_4 - x_1$。\n\n因此，雅可比矩阵 $J$ 由从物理四面体 $T$ 的顶点 $x_1$ 出发的边向量构成：\n$$\nJ = \\begin{pmatrix} x_2 - x_1  x_3 - x_1  x_4 - x_1 \\end{pmatrix}\n$$\n物理四面体 $T$ 的顶点给定如下：\n$x_1 = (0,1,2)$\n$x_2 = (2,1,3)$\n$x_3 = (1,4,2)$\n$x_4 = (3,0,5)$\n\n我们现在计算构成 $J$ 的列的边向量：\n$e_1 = x_2 - x_1 = (2-0, 1-1, 3-2) = (2, 0, 1)$\n$e_2 = x_3 - x_1 = (1-0, 4-1, 2-2) = (1, 3, 0)$\n$e_3 = x_4 - x_1 = (3-0, 0-1, 5-2) = (3, -1, 3)$\n\n用这些列向量组合成雅可比矩阵：\n$$\nJ = \\begin{pmatrix} 2  1  3 \\\\ 0  3  -1 \\\\ 1  0  3 \\end{pmatrix}\n$$\n接下来，我们计算 $J$ 的行列式。使用Sarrus法则或代数余子式展开：\n$$\n\\det J = (2)(3)(3) + (1)(-1)(1) + (3)(0)(0) - \\left[ (3)(3)(1) + (1)(0)(3) + (2)(-1)(0) \\right]\n$$\n$$\n\\det J = 18 - 1 + 0 - (9 + 0 + 0)\n$$\n$$\n\\det J = 17 - 9 = 8\n$$\n雅可比行列式为 $\\det J = 8$。\n\n最后，我们解释该行列式的符号。雅可比行列式 $\\det J$ 表示参考单元和物理单元之间的局部体积缩放因子。具体来说，参考空间中的一个无穷小体积 $d\\hat{V}$ 根据关系式 $dV = \\det J \\, d\\hat{V}$ 映射到物理空间中的一个无穷小体积 $dV$。\n\n$\\det J$ 的符号对有限元的有效性至关重要：\n- 如果 $\\det J > 0$，则映射是保向的。这意味着局部坐标系的“手性”在参考单元和物理单元中是相同的。例如，$\\hat{T}$ 中的右手基被映射到 $T$ 中的右手基。这是一个非反转的、具有物理意义的单元所要求的条件。\n- 如果 $\\det J  0$，则映射是反向的，这意味着单元被“由内向外翻转”。这对应于网格中的无效或扭曲单元，会在模拟中导致不正确的结果。\n- 如果 $\\det J = 0$，则映射是奇异的。物理单元是退化的，意味着它的体积为零（例如，其四个顶点共面）。这对于三维分析来说也是一个无效单元。\n\n在本问题中，$\\det J = 8$，是一个正值。这表明从参考四面体 $\\hat{T}$ 到物理四面体 $T$ 的映射是保向的。因此，单元 $T$ 是一个有效的、非反转的单元。体积的缩放因子是 $8$；也就是说，物理四面体 $T$ 的体积是参考四面体 $\\hat{T}$ 体积的 $8$ 倍。由于 $\\text{Vol}(\\hat{T}) = 1/6$，物理单元的体积为 $\\text{Vol}(T) = 8 \\times (1/6) = 4/3$。",
            "answer": "$$\\boxed{8}$$"
        },
        {
            "introduction": "在建立了从参考单元到物理单元的有效几何映射之后，下一步是在这些单元上定义用于近似解的函数空间。拉格朗日基函数 (Lagrange basis functions) 因其构造直观而广受欢迎，它们的值在单元的特定节点上为一，在所有其他节点上为零。这个练习将指导您在参考四面体上推导一个二次 ($P_2$) 拉格朗日基函数，从而加深对基于克罗内克 $delta$ ($\\delta$) 性质的节点插值基函数定义的理解。",
            "id": "3453402",
            "problem": "考虑参考四面体 $\\hat T \\subset \\mathbb{R}^3$ 上总次数至多为二次的多项式构成的二次拉格朗日空间 $P_2$。设参考四面体定义为顶点 $\\hat v_1=(0,0,0)$、$\\hat v_2=(1,0,0)$、$\\hat v_3=(0,1,0)$ 和 $\\hat v_4=(0,0,1)$ 的凸包。令 $(\\lambda_1,\\lambda_2,\\lambda_3,\\lambda_4)$ 表示 $\\hat T$ 上的重心坐标，其满足 $\\lambda_i \\ge 0$ 和 $\\lambda_1+\\lambda_2+\\lambda_3+\\lambda_4=1$，并且对于 $(x,y,z)\\in \\hat T$，有 $\\lambda_1=1-x-y-z$、$\\lambda_2=x$、$\\lambda_3=y$ 和 $\\lambda_4=z$。在有限元法 (FEM) 的背景下，$\\hat T$ 上的 $P_2$ 拉格朗日节点基使用由 $\\hat T$ 的4个顶点和6个边中点给出的10个自由度。从基函数在所选节点上满足克罗内克δ条件的拉格朗日插值定义性质出发，列举出 $\\hat T$ 的所有顶点和边中点节点，并推导出在这些节点上满足克罗内克δ条件的相应二次拉格朗日基多项式。最后，以重心坐标的形式，给出与 $\\hat v_2$ 和 $\\hat v_3$ 之间边中点关联的基函数的显式多项式。最终答案必须是此特定基函数的单一闭式表达式。无需数值舍入，也不涉及物理单位。",
            "solution": "目标是确定参考四面体 $\\hat{T}$ 上的一个特定二次拉格朗日基函数。$\\hat{T}$ 上总次数至多为二次的多项式空间，记作 $P_2(\\hat{T})$，是一个维数为 $10$ 的向量空间。该空间的基可以通过定义10个节点变量来确定，这些变量被指定为函数在 $\\hat{T}$ 的4个顶点和6个边中点处的值。由此产生的基函数 $\\phi_j$ 是 $P_2(\\hat{T})$ 中满足克罗内克δ性质 $\\phi_j(\\hat{x}_k) = \\delta_{jk}$ 的唯一多项式，其中 $\\{\\hat{x}_k\\}_{k=1}^{10}$ 是这10个节点的集合。\n\n首先，我们用笛卡尔坐标和重心坐标来识别这些节点。参考四面体 $\\hat{T}$ 是顶点 $\\hat{v}_1=(0,0,0)$、$\\hat{v}_2=(1,0,0)$、$\\hat{v}_3=(0,1,0)$ 和 $\\hat{v}_4=(0,0,1)$ 的凸包。重心坐标 $(\\lambda_1, \\lambda_2, \\lambda_3, \\lambda_4)$ 是与笛卡尔坐标 $(x,y,z)$ 相关的线性多项式，关系为 $\\lambda_1 = 1-x-y-z$、$\\lambda_2=x$、$\\lambda_3=y$ 和 $\\lambda_4=z$。\n\n$P_2$ 拉格朗日元的10个节点是：\n4个顶点：\n- $\\hat{v}_1 = (0,0,0)$，重心坐标为 $(1,0,0,0)$。\n- $\\hat{v}_2 = (1,0,0)$，重心坐标为 $(0,1,0,0)$。\n- $\\hat{v}_3 = (0,1,0)$，重心坐标为 $(0,0,1,0)$。\n- $\\hat{v}_4 = (0,0,1)$，重心坐标为 $(0,0,0,1)$。\n\n6个边中点，$\\hat{v}_{ij} = \\frac{1}{2}(\\hat{v}_i + \\hat{v}_j)$:\n- $\\hat{v}_{12} = (\\frac{1}{2},0,0)$，重心坐标为 $(\\frac{1}{2},\\frac{1}{2},0,0)$。\n- $\\hat{v}_{13} = (0,\\frac{1}{2},0)$，重心坐标为 $(\\frac{1}{2},0,\\frac{1}{2},0)$。\n- $\\hat{v}_{14} = (0,0,\\frac{1}{2})$，重心坐标为 $(\\frac{1}{2},0,0,\\frac{1}{2})$。\n- $\\hat{v}_{23} = (\\frac{1}{2},\\frac{1}{2},0)$，重心坐标为 $(0,\\frac{1}{2},\\frac{1}{2},0)$。\n- $\\hat{v}_{24} = (\\frac{1}{2},0,\\frac{1}{2})$，重心坐标为 $(0,\\frac{1}{2},0,\\frac{1}{2})$。\n- $\\hat{v}_{34} = (0,\\frac{1}{2},\\frac{1}{2})$，重心坐标为 $(0,0,\\frac{1}{2},\\frac{1}{2})$。\n\n我们需要找到与连接 $\\hat{v}_2$ 和 $\\hat{v}_3$ 的边的中点相关联的基函数。我们将此节点表示为 $\\hat{v}_{23}$，其对应的基函数表示为 $\\phi_{23}$。根据拉格朗日基函数的定义，$\\phi_{23}$ 必须满足：\n- $\\phi_{23}(\\hat{v}_{23}) = 1$。\n- 对于所有其他9个节点 $\\hat{x}_k \\neq \\hat{v}_{23}$，$\\phi_{23}(\\hat{x}_k) = 0$。\n\n重心坐标 $\\lambda_i$ 是一个线性多项式，它在顶点 $\\hat{v}_i$ 处等于1，在 $\\hat{v}_i$ 的对面上等于0。$\\hat{v}_2$ 的对面由方程 $\\lambda_2=0$ 定义，包含顶点 $\\hat{v}_1, \\hat{v}_3, \\hat{v}_4$。$\\hat{v}_3$ 的对面由方程 $\\lambda_3=0$ 定义，包含顶点 $\\hat{v}_1, \\hat{v}_2, \\hat{v}_4$。\n\n我们来考察 $\\phi_{23}$ 必須为零的节点集合：\n$\\{\\hat{v}_1, \\hat{v}_2, \\hat{v}_3, \\hat{v}_4, \\hat{v}_{12}, \\hat{v}_{13}, \\hat{v}_{14}, \\hat{v}_{24}, \\hat{v}_{34}\\}$。\n\n这些节点中有相当一部分位于平面 $\\lambda_2=0$ 或 $\\lambda_3=0$ 上。\n- 位于平面 $\\lambda_2=0$ 上的节点： $\\hat{v}_1, \\hat{v}_3, \\hat{v}_4, \\hat{v}_{13}, \\hat{v}_{14}, \\hat{v}_{34}$。\n- 位于平面 $\\lambda_3=0$ 上的节点： $\\hat{v}_1, \\hat{v}_2, \\hat{v}_4, \\hat{v}_{12}, \\hat{v}_{14}, \\hat{v}_{24}$。\n\n这两个节点集合的并集恰好是 $\\phi_{23}$ 必须为零的所有节点的集合。多项式 $\\lambda_2 \\lambda_3$ 是一个二次多项式，它在 $\\lambda_2=0$ 和 $\\lambda_3=0$ 两个平面上都为零。因此，它在所有要求为零的节点处都为零。这表明所求的基函数 $\\phi_{23}$ 与乘积 $\\lambda_2 \\lambda_3$ 成正比。\n我们设 $\\phi_{23} = C \\lambda_2 \\lambda_3$，其中 $C$为某个常数。\n这个函数是一个二次多项式，因此它属于 $P_2(\\hat{T})$。\n\n为了确定常数 $C$，我们使用条件 $\\phi_{23}(\\hat{v}_{23}) = 1$。节点 $\\hat{v}_{23}$ 的重心坐标是 $(0, \\frac{1}{2}, \\frac{1}{2}, 0)$。\n将这些值代入 $\\phi_{23}$ 的表达式中：\n$$\n\\phi_{23}(\\hat{v}_{23}) = C \\left(\\frac{1}{2}\\right) \\left(\\frac{1}{2}\\right) = \\frac{C}{4}\n$$\n令其等于1：\n$$\n\\frac{C}{4} = 1 \\implies C = 4\n$$\n因此，与边中点 $\\hat{v}_{23}$ 相关联的基函数的显式形式是：\n$$\n\\phi_{23} = 4 \\lambda_2 \\lambda_3\n$$\n该函数是二次的，在 $\\hat{v}_{23}$ 处等于1，并且在四面体上的所有其他 $P_2$ 节点处为零，符合要求。\n\n为完整起见，四面体上 $P_2$ 基函数的一般形式为：\n- 对于顶点节点 $\\hat{v}_i$：$\\phi_i = \\lambda_i(2\\lambda_i - 1)$。\n- 对于边中点节点 $\\hat{v}_{ij}$：$\\phi_{ij} = 4\\lambda_i\\lambda_j$。\n我们推导出的 $\\phi_{23}$ 的结果与此通用公式一致。",
            "answer": "$$\n\\boxed{4 \\lambda_2 \\lambda_3}\n$$"
        },
        {
            "introduction": "现在我们已经掌握了单元映射和基函数的概念，接下来我们将把它们结合起来，应用于求解一个实际的偏微分方程。有限元方法的核心步骤是将物理单元上的积分（例如，用于组装刚度矩阵）转换到参考单元上进行计算，因为在参考单元上计算更为简单和标准化。这个练习将通过为一个扩散问题计算局部刚度矩阵中的一个特定项，完整地展示了这一工作流程，融合了雅可比矩阵、基函数梯度和积分变换等关键概念。",
            "id": "3453422",
            "problem": "考虑由二阶线性偏微分方程（PDE）$-\\nabla \\cdot (a(x)\\nabla u)=f$ 给出的三维（$3$D）扩散模型，其定义域被划分为四面体单元。在使用一阶（$\\mathbb{P}_1$）四面体基函数 $\\{N_i\\}$ 的标准伽辽金有限元法（Finite Element Method, FEM）中，与单元 $K$ 相关的局部刚度矩阵项由以下双线性形式定义\n$$\nA_{ij} \\;=\\; \\int_{K} \\nabla N_i(x)\\cdot a(x)\\,\\nabla N_j(x)\\,dx \\;=\\; \\int_{K} \\nabla N_i(x)^{\\top}\\,a(x)\\,\\nabla N_j(x)\\,dx .\n$$\n从链式法则以及从参考四面体 $\\hat{K}$（其顶点为 $\\hat{v}_1=(0,0,0)$, $\\hat{v}_2=(1,0,0)$, $\\hat{v}_3=(0,1,0)$, $\\hat{v}_4=(0,0,1)$）的等参映射的定义出发，写出矩阵项 $A_{ij}$ 关于参考梯度 $\\nabla \\hat{N}_i$ 和单元雅可比矩阵的显式公式。然后，在顶点为\n$$\nv_1=(0,0,0),\\quad v_2=(1,0,0),\\quad v_3=(0,2,0),\\quad v_4=(0,0,3),\n$$\n的物理四面体单元 $K$ 上，计算特定项 $A_{13}$，假设在 $K$ 上有一个由下式给出的常数、对称、正定的扩散张量\n$$\na(x)\\equiv a \\;=\\; \\begin{pmatrix}2  1  0\\\\ 1  3  0\\\\ 0  0  4\\end{pmatrix}.\n$$\n您的推导必须从物理梯度和参考梯度之间的基本链式法则关系开始，并使用单元映射进行积分。您可以使用以下条件：参考单元 $\\hat{K}$ 上的 $\\mathbb{P}_1$ 基函数为 $\\hat{N}_1(\\xi,\\eta,\\zeta)=1-\\xi-\\eta-\\zeta$, $\\hat{N}_2(\\xi,\\eta,\\zeta)=\\xi$, $\\hat{N}_3(\\xi,\\eta,\\zeta)=\\eta$, $\\hat{N}_4(\\xi,\\eta,\\zeta)=\\zeta$，且它们在 $\\hat{K}$ 上具有常数参考梯度。\n\n将 $A_{13}$ 的最终答案表示为精确值。请勿四舍五入。在您的推导纲要中，请清楚地说明到参考单元的映射以及雅可比矩阵如何参与计算。您也可以评论该过程对于三线性（$\\mathbb{Q}_1$）六面体单元有何不同，但唯一需要进行数值计算的量是给定四面体单元的 $A_{13}$。",
            "solution": "主要任务是计算给定四面体单元 $K$ 的局部刚度矩阵的特定项 $A_{13}$。该刚度矩阵项由以下积分定义：\n$$\nA_{ij} = \\int_{K} \\nabla N_i(x)^{\\top}\\,a(x)\\,\\nabla N_j(x)\\,dx\n$$\n此处，$N_i(x)$ 是物理单元 $K$ 上的 $\\mathbb{P}_1$ 基函数，$\\nabla$ 是关于物理坐标 $x=(x,y,z)$ 的梯度，$a(x)$ 是扩散张量。标准的有限元法流程包括将此积分映射到参考单元 $\\hat{K}$ 上，在参考单元上计算会更简单。\n\n**1. 等参映射和雅可比矩阵**\n\n等参映射提供了从参考坐标 $\\hat{x}=(\\xi, \\eta, \\zeta) \\in \\hat{K}$ 到物理坐标 $x=(x,y,z) \\in K$ 的变换。对于线性四面体单元，此映射是仿射的，并使用参考基函数 $\\hat{N}_k$ 和物理单元的顶点 $v_k$ 来定义：\n$$\nx(\\hat{x}) = \\sum_{k=1}^{4} v_k \\hat{N}_k(\\hat{x})\n$$\n给定顶点 $v_1=(0,0,0)$、$v_2=(1,0,0)$、$v_3=(0,2,0)$、$v_4=(0,0,3)$ 和参考基函数 $\\hat{N}_1=1-\\xi-\\eta-\\zeta$、$\\hat{N}_2=\\xi$、$\\hat{N}_3=\\eta$、$\\hat{N}_4=\\zeta$，该映射变为：\n$$\nx(\\xi,\\eta,\\zeta) = (0,0,0)(1-\\xi-\\eta-\\zeta) + (1,0,0)\\xi + (0,2,0)\\eta + (0,0,3)\\zeta = (\\xi, 2\\eta, 3\\zeta)\n$$\n该变换的雅可比矩阵 $J$ 关联了两个坐标系中的微分算子。其定义如下：\n$$\nJ = \\frac{\\partial(x,y,z)}{\\partial(\\xi,\\eta,\\zeta)} = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial x}{\\partial \\eta}  \\frac{\\partial x}{\\partial \\zeta} \\\\ \\frac{\\partial y}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\eta}  \\frac{\\partial y}{\\partial \\zeta} \\\\ \\frac{\\partial z}{\\partial \\xi}  \\frac{\\partial z}{\\partial \\eta}  \\frac{\\partial z}{\\partial \\zeta} \\end{pmatrix}\n$$\n对于映射 $x(\\xi,\\eta,\\zeta) = (\\xi, 2\\eta, 3\\zeta)$，雅可比矩阵是一个常数矩阵：\n$$\nJ = \\begin{pmatrix} 1  0  0 \\\\ 0  2  0 \\\\ 0  0  3 \\end{pmatrix}\n$$\n雅可比矩阵的行列式为 $|J| = \\det(J) = 1 \\cdot 2 \\cdot 3 = 6$。\n\n**2. 梯度和积分的变换**\n\n链式法则关联了物理坐标系和参考坐标系中的梯度。令 $\\nabla_x$ 为关于 $x$ 的梯度，$\\nabla_{\\xi}$ 为关于 $\\hat{x}$ 的梯度。那么，对于一个函数 $f$，我们有 $\\nabla_{\\xi} f = J^{\\top} \\nabla_x f$。我们需要物理梯度 $\\nabla_x N_i$，它可以通过反转此关系得到：\n$$\n\\nabla_x N_i(x) = (J^{-1})^{\\top} \\nabla_{\\xi} \\hat{N}_i(\\hat{x})\n$$\n微分体积元根据 $dx = |J|\\,d\\hat{x}$ 进行变换。\n\n将这些变换代入 $A_{ij}$ 的表达式中：\n$$\nA_{ij} = \\int_{\\hat{K}} \\left((J^{-1})^{\\top} \\nabla_{\\xi} \\hat{N}_i\\right)^{\\top} a \\left((J^{-1})^{\\top} \\nabla_{\\xi} \\hat{N}_j\\right) |J|\\,d\\hat{x}\n$$\n使用属性 $(AB)^{\\top} = B^{\\top}A^{\\top}$，我们得到：\n$$\nA_{ij} = \\int_{\\hat{K}} (\\nabla_{\\xi} \\hat{N}_i)^{\\top} (J^{-1}) a (J^{-1})^{\\top} (\\nabla_{\\xi} \\hat{N}_j) |J|\\,d\\hat{x}\n$$\n这是用参考量表示的 $A_{ij}$ 的显式公式。对于 $\\mathbb{P}_1$ 单元，参考梯度 $\\nabla_{\\xi} \\hat{N}_i$ 是常向量。由于映射是仿射的，$J$ 是一个常数矩阵。题目说明 $a(x)$ 是一个常数张量 $a$。因此，整个被积函数是常数，可以移到积分号外面：\n$$\nA_{ij} = |J| \\left( (\\nabla_{\\xi} \\hat{N}_i)^{\\top} J^{-1} a (J^{-1})^{\\top} \\nabla_{\\xi} \\hat{N}_j \\right) \\int_{\\hat{K}} d\\hat{x}\n$$\n积分 $\\int_{\\hat{K}} d\\hat{x}$ 是参考四面体的体积，即 $\\text{Vol}(\\hat{K})$。顶点 $\\hat{v}_1=(0,0,0), \\hat{v}_2=(1,0,0), \\hat{v}_3=(0,1,0), \\hat{v}_4=(0,0,1)$ 定义了一个体积为 $\\frac{1}{6}$ 的四面体。\n因此，最终的公式是：\n$$\nA_{ij} = |J| \\text{Vol}(\\hat{K}) \\left( (\\nabla_{\\xi} \\hat{N}_i)^{\\top} J^{-1} a (J^{-1})^{\\top} \\nabla_{\\xi} \\hat{N}_j \\right) = \\text{Vol}(K) \\left( (\\nabla_{\\xi} \\hat{N}_i)^{\\top} J^{-1} a (J^{-1})^{\\top} \\nabla_{\\xi} \\hat{N}_j \\right)\n$$\n其中 $\\text{Vol}(K)=|J|\\text{Vol}(\\hat{K}) = 6 \\cdot \\frac{1}{6} = 1$。\n\n**3. $A_{13}$ 的计算**\n\n我们需要为给定的单元和扩散张量计算 $A_{13}$。首先，我们找出必要的组成部分：\n- 物理单元的体积：$\\text{Vol}(K) = 1$。\n- $i=1$ 和 $j=3$ 时的参考梯度：\n  $$\n  \\hat{N}_1 = 1 - \\xi - \\eta - \\zeta \\implies \\nabla_{\\xi} \\hat{N}_1 = \\begin{pmatrix} -1 \\\\ -1 \\\\ -1 \\end{pmatrix}\n  $$\n  $$\n  \\hat{N}_3 = \\eta \\implies \\nabla_{\\xi} \\hat{N}_3 = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}\n  $$\n- 雅可比矩阵的逆矩阵：\n  $$\n  J^{-1} = \\begin{pmatrix} 1  0  0 \\\\ 0  2  0 \\\\ 0  0  3 \\end{pmatrix}^{-1} = \\begin{pmatrix} 1  0  0 \\\\ 0  \\frac{1}{2}  0 \\\\ 0  0  \\frac{1}{3} \\end{pmatrix}\n  $$\n- 扩散张量：\n  $$\n  a = \\begin{pmatrix} 2  1  0 \\\\ 1  3  0 \\\\ 0  0  4 \\end{pmatrix}\n  $$\n现在，我们计算矩阵乘积 $B = J^{-1} a (J^{-1})^{\\top}$。由于 $J^{-1}$ 是对角矩阵，所以 $(J^{-1})^{\\top} = J^{-1}$。\n$$\nB = \\begin{pmatrix} 1  0  0 \\\\ 0  \\frac{1}{2}  0 \\\\ 0  0  \\frac{1}{3} \\end{pmatrix} \\begin{pmatrix} 2  1  0 \\\\ 1  3  0 \\\\ 0  0  4 \\end{pmatrix} \\begin{pmatrix} 1  0  0 \\\\ 0  \\frac{1}{2}  0 \\\\ 0  0  \\frac{1}{3} \\end{pmatrix}\n$$\n$$\nB = \\begin{pmatrix} 2  1  0 \\\\ \\frac{1}{2}  \\frac{3}{2}  0 \\\\ 0  0  \\frac{4}{3} \\end{pmatrix} \\begin{pmatrix} 1  0  0 \\\\ 0  \\frac{1}{2}  0 \\\\ 0  0  \\frac{1}{3} \\end{pmatrix} = \\begin{pmatrix} 2  \\frac{1}{2}  0 \\\\ \\frac{1}{2}  \\frac{3}{4}  0 \\\\ 0  0  \\frac{4}{9} \\end{pmatrix}\n$$\n最后，我们计算 $A_{13} = \\text{Vol}(K) (\\nabla_{\\xi} \\hat{N}_1)^{\\top} B (\\nabla_{\\xi} \\hat{N}_3)$：\n$$\nA_{13} = (1) \\begin{pmatrix} -1  -1  -1 \\end{pmatrix} \\begin{pmatrix} 2  \\frac{1}{2}  0 \\\\ \\frac{1}{2}  \\frac{3}{4}  0 \\\\ 0  0  \\frac{4}{9} \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}\n$$\n首先，将矩阵 $B$ 乘以向量 $\\nabla_{\\xi} \\hat{N}_3$：\n$$\n\\begin{pmatrix} 2  \\frac{1}{2}  0 \\\\ \\frac{1}{2}  \\frac{3}{4}  0 \\\\ 0  0  \\frac{4}{9} \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{2} \\\\ \\frac{3}{4} \\\\ 0 \\end{pmatrix}\n$$\n然后，执行最终的点积运算：\n$$\nA_{13} = \\begin{pmatrix} -1  -1  -1 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{2} \\\\ \\frac{3}{4} \\\\ 0 \\end{pmatrix} = (-1)\\left(\\frac{1}{2}\\right) + (-1)\\left(\\frac{3}{4}\\right) + (-1)(0)\n$$\n$$\nA_{13} = -\\frac{1}{2} - \\frac{3}{4} = -\\frac{2}{4} - \\frac{3}{4} = -\\frac{5}{4}\n$$\n\n**4. 与六面体单元的比较**\n对于三线性（$\\mathbb{Q}_1$）六面体单元，其过程在概念上相似，但在计算上更为复杂。主要区别如下：\n1.  **映射和雅可比矩阵**：等参映射使用 $8$ 个节点和三线性基函数（例如，在参考立方体 $[-1,1]^3$ 上的 $\\hat{N}_i = \\frac{1}{8}(1\\pm\\xi)(1\\pm\\eta)(1\\pm\\zeta)$）。这种映射通常不是仿射的。因此，雅可比矩阵 $J$ 及其行列式 $|J|$ 是参考坐标 $(\\xi,\\eta,\\zeta)$ 的函数，而不是常数。\n2.  **参考梯度**：三线性基函数的梯度 $\\nabla_{\\xi} \\hat{N}_i$ 也不是常向量；其分量是参考坐标的线性函数。\n3.  **积分**：由于被积函数 $ (\\nabla_{\\xi} \\hat{N}_i)^{\\top} J^{-1} a (J^{-1})^{\\top} (\\nabla_{\\xi} \\hat{N}_j) |J| $ 不再是常数，而是 $(\\xi,\\eta,\\zeta)$ 的有理函数，因此必须使用数值求积（例如 $2 \\times 2 \\times 2$ 的高斯求积方案）来计算积分。这与四面体情况形成鲜明对比，在四面体情况下，积分简化为乘以单元的体积。",
            "answer": "$$ \\boxed{-\\frac{5}{4}} $$"
        }
    ]
}