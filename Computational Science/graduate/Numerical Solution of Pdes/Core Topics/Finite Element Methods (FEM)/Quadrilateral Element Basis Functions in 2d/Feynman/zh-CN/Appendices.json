{
    "hands_on_practices": [
        {
            "introduction": "我们的实践始于基函数构建的基础工作。在有限元方法中，高次基函数通常是通过张量积方法，由简单的一维基函数系统地构建而成的。这项练习 () 将指导您从一维二次拉格朗日多项式出发，亲手构造一个双二次 ($Q_2$) 单元的九个基函数。这个过程对于理解张量积空间的结构，以及顶点、边和内部节点各自基函数的独特形式至关重要。",
            "id": "3437518",
            "problem": "考虑参考四边形 $\\hat{K} = [-1,1] \\times [-1,1]$，其等参坐标为 $(\\xi,\\eta)$。在偏微分方程 (PDE) 的数值解法中，$Q_2$ 有限元空间 $\\hat{K}$ 被定义为每个坐标上次数最高为2的多项式的张量积空间。一组节点上的拉格朗日插值基由克罗内克（Kronecker）$\\delta$ 性质来表征：与某个节点相关联的基函数，在该节点上的值为 $1$，在所有其他节点上的值为 $0$。\n\n从一维二次拉格朗日插值在节点 $\\{-1,0,1\\}$ 上的基本定义出发，构建在 $\\hat{K}$ 上的、与以下九个节点相关联的二维张量积拉格朗日基：\n$$\\{(-1,-1),(0,-1),(1,-1),(1,0),(1,1),(0,1),(-1,1),(-1,0),(0,0)\\}.$$\n推导与以下节点相关的基函数的显式多项式公式：\n1) 每个顶点节点，\n2) 每个边中点节点，\n3) 内部节点。\n\n您的推导必须从一维拉格朗日多项式的定义性质和张量积构造开始，并且必须证明所得的二维基在所有九个节点上满足克罗内克 $\\delta$ 性质，并能张成 $Q_2(\\hat{K})$。\n\n最后，提供与节点 $(0,0)$ 相关联的内部基函数的精确解析表达式（闭式形式）。最终答案必须是无单位的单个闭式表达式。",
            "solution": "该问题要求使用张量积方法推导参考方块单元 $\\hat{K} = [-1,1] \\times [-1,1]$ 上的双二次 ($Q_2$) 拉格朗日基函数。推导将从一维二次拉格朗日多项式开始，然后扩展到二维。我们还必须验证所得基函数的基本性质。\n\n$Q_2(\\hat{K})$ 空间是在 $\\hat{K}$ 上，关于每个坐标变量 $\\xi$ 和 $\\eta$ 的次数分别最高为2的所有多项式的集合。一个通用的多项式 $p(\\xi, \\eta) \\in Q_2(\\hat{K})$ 具有以下形式：\n$$p(\\xi, \\eta) = \\sum_{i=0}^{2} \\sum_{j=0}^{2} a_{ij} \\xi^i \\eta^j$$\n这是一个维度为 $3 \\times 3 = 9$ 的向量空间。我们的任务是使用在九个指定节点上的拉格朗日插值法为该空间构造一个基。节点位置由集合 $\\{(\\xi_i, \\eta_j) | i,j \\in \\{0, 1, 2\\}\\}$ 给出，其中 $\\xi$ 方向的节点坐标为 $\\xi_0 = -1, \\xi_1 = 0, \\xi_2 = 1$，$\\eta$ 方向的节点坐标为 $\\eta_0 = -1, \\eta_1 = 0, \\eta_2 = 1$。\n\n**第一步：一维二次拉格朗日基**\n\n首先，我们构造在区间 $[-1,1]$ 上，以 $\\{-1, 0, 1\\}$ 为节点的次数为2的一维拉格朗日基多项式 $L_i(\\xi)$。设节点索引为 $\\xi_0 = -1, \\xi_1 = 0, \\xi_2 = 1$。这些基多项式由克罗内克 $\\delta$ 性质定义：\n$$L_i(\\xi_j) = \\delta_{ij} = \\begin{cases} 1  \\text{if } i=j \\\\ 0  \\text{if } i \\neq j \\end{cases}$$\n其中 $i, j \\in \\{0, 1, 2\\}$。\n\n拉格朗日多项式的一般公式是 $L_i(\\xi) = \\prod_{j=0, j \\neq i}^{2} \\frac{\\xi - \\xi_j}{\\xi_i - \\xi_j}$。对每个基函数应用此公式：\n\n对于节点 $\\xi_0 = -1$：\n$$L_0(\\xi) = \\frac{(\\xi - \\xi_1)(\\xi - \\xi_2)}{(\\xi_0 - \\xi_1)(\\xi_0 - \\xi_2)} = \\frac{(\\xi - 0)(\\xi - 1)}{(-1 - 0)(-1 - 1)} = \\frac{\\xi(\\xi - 1)}{(-1)(-2)} = \\frac{1}{2}(\\xi^2 - \\xi)$$\n\n对于节点 $\\xi_1 = 0$：\n$$L_1(\\xi) = \\frac{(\\xi - \\xi_0)(\\xi - \\xi_2)}{(\\xi_1 - \\xi_0)(\\xi_1 - \\xi_2)} = \\frac{(\\xi - (-1))(\\xi - 1)}{(0 - (-1))(0 - 1)} = \\frac{(\\xi + 1)(\\xi - 1)}{(1)(-1)} = -(\\xi^2 - 1) = 1 - \\xi^2$$\n\n对于节点 $\\xi_2 = 1$：\n$$L_2(\\xi) = \\frac{(\\xi - \\xi_0)(\\xi - \\xi_1)}{(\\xi_2 - \\xi_0)(\\xi_2 - \\xi_1)} = \\frac{(\\xi - (-1))(\\xi - 0)}{(1 - (-1))(1 - 0)} = \\frac{(\\xi + 1)\\xi}{(2)(1)} = \\frac{1}{2}(\\xi^2 + \\xi)$$\n\n这三个多项式 $L_0(\\xi)$, $L_1(\\xi)$ 和 $L_2(\\xi)$ 构成了一维二次多项式空间 $P_2([-1,1])$ 的一个基。\n\n**第二步：二维张量积基**\n\n$\\hat{K}$ 上 $Q_2$ 空间的二维拉格朗日基函数 $N_{ij}(\\xi, \\eta)$ 是通过取一维基函数的所有可能张量积来构造的：\n$$N_{ij}(\\xi, \\eta) = L_i(\\xi) L_j(\\eta) \\quad \\text{for } i, j \\in \\{0, 1, 2\\}$$\n每个函数 $N_{ij}$ 与节点 $(\\xi_i, \\eta_j)$ 相关联。共有 $3 \\times 3 = 9$ 个这样的基函数，对应九个节点。\n\n**第三步：性质验证**\n\n我们必须验证函数集 $\\{N_{ij}\\}$ 构成了 $Q_2(\\hat{K})$ 的一个有效的拉格朗日基。\n\n首先，我们检查克罗内克 $\\delta$ 性质。我们在一个节点 $(\\xi_k, \\eta_l)$ 处计算基函数 $N_{ij}(\\xi, \\eta)$ 的值，其中 $k, l \\in \\{0, 1, 2\\}$：\n$$N_{ij}(\\xi_k, \\eta_l) = L_i(\\xi_k) L_j(\\eta_l)$$\n根据一维拉格朗日多项式的定义，我们知道 $L_i(\\xi_k) = \\delta_{ik}$ 和 $L_j(\\eta_l) = \\delta_{jl}$。因此，\n$$N_{ij}(\\xi_k, \\eta_l) = \\delta_{ik} \\delta_{jl}$$\n该乘积等于 $1$ 当且仅当 $i = k$ 且 $j = l$，这意味着该函数在其自身的节点 $(\\xi_i, \\eta_j)$ 处求值。如果 $i \\neq k$ 或 $j \\neq l$，该乘积为 $0$。这证实了二维基所需的克罗内克 $\\delta$ 性质。\n\n其次，我们证明集合 $\\{N_{ij}\\}$ 张成空间 $Q_2(\\hat{K})$。$Q_2(\\hat{K})$ 空间是9维的。我们的构造得出了9个基函数。每个 $N_{ij}(\\xi, \\eta) = L_i(\\xi) L_j(\\eta)$ 是一个关于 $\\xi$ 的二次多项式和一个关于 $\\eta$ 的二次多项式的乘积，因此它是一个双二次多项式，属于 $Q_2(\\hat{K})$。为了证明它们构成一个基，我们必须证明它们的线性无关性。假设这些函数的线性组合对于所有 $(\\xi, \\eta) \\in \\hat{K}$ 都为零：\n$$\\sum_{i=0}^{2} \\sum_{j=0}^{2} c_{ij} N_{ij}(\\xi, \\eta) = 0$$\n我们可以在九个节点中的任意一个 $(\\xi_k, \\eta_l)$ 处对该方程求值。使用我们刚刚证明的克罗内克 $\\delta$ 性质：\n$$\\sum_{i=0}^{2} \\sum_{j=0}^{2} c_{ij} N_{ij}(\\xi_k, \\eta_l) = \\sum_{i=0}^{2} \\sum_{j=0}^{2} c_{ij} (\\delta_{ik} \\delta_{jl}) = c_{kl} = 0$$\n因为我们可以对 $k, l \\in \\{0, 1, 2\\}$ 的任意选择执行此操作，所以所有系数 $c_{kl}$ 必须为零。这证明了函数 $\\{N_{ij}\\}$ 是线性无关的。由于我们在一个9维空间中有9个线性无关的函数，它们构成了 $Q_2(\\hat{K})$ 的一个基。\n\n**第四步：基函数的显式公式**\n\n我们现在推导基函数的显式公式，按其关联的节点类型分类。\n\n1.  **顶点节点**：这是四个节点 $(\\pm 1, \\pm 1)$，对应于 $i,j \\in \\{0, 2\\}$ 的索引对。\n    *   节点 $(-1, -1) \\equiv (\\xi_0, \\eta_0)$: $N_{00}(\\xi, \\eta) = L_0(\\xi) L_0(\\eta) = \\frac{1}{4}(\\xi^2 - \\xi)(\\eta^2 - \\eta)$。\n    *   节点 $(1, -1) \\equiv (\\xi_2, \\eta_0)$: $N_{20}(\\xi, \\eta) = L_2(\\xi) L_0(\\eta) = \\frac{1}{4}(\\xi^2 + \\xi)(\\eta^2 - \\eta)$。\n    *   节点 $(1, 1) \\equiv (\\xi_2, \\eta_2)$: $N_{22}(\\xi, \\eta) = L_2(\\xi) L_2(\\eta) = \\frac{1}{4}(\\xi^2 + \\xi)(\\eta^2 + \\eta)$。\n    *   节点 $(-1, 1) \\equiv (\\xi_0, \\eta_2)$: $N_{02}(\\xi, \\eta) = L_0(\\xi) L_2(\\eta) = \\frac{1}{4}(\\xi^2 - \\xi)(\\eta^2 + \\eta)$。\n\n2.  **边中点节点**：这是位于边中点的四个节点，$(\\pm 1, 0)$ 和 $(0, \\pm 1)$。一个索引是 $1$，另一个是 $0$ 或 $2$。\n    *   节点 $(0, -1) \\equiv (\\xi_1, \\eta_0)$: $N_{10}(\\xi, \\eta) = L_1(\\xi) L_0(\\eta) = (1 - \\xi^2) \\frac{1}{2}(\\eta^2 - \\eta)$。\n    *   节点 $(1, 0) \\equiv (\\xi_2, \\eta_1)$: $N_{21}(\\xi, \\eta) = L_2(\\xi) L_1(\\eta) = \\frac{1}{2}(\\xi^2 + \\xi)(1 - \\eta^2)$。\n    *   节点 $(0, 1) \\equiv (\\xi_1, \\eta_2)$: $N_{12}(\\xi, \\eta) = L_1(\\xi) L_2(\\eta) = (1 - \\xi^2) \\frac{1}{2}(\\eta^2 + \\eta)$。\n    *   节点 $(-1, 0) \\equiv (\\xi_0, \\eta_1)$: $N_{01}(\\xi, \\eta) = L_0(\\xi) L_1(\\eta) = \\frac{1}{2}(\\xi^2 - \\xi)(1 - \\eta^2)$。\n\n3.  **内部节点**：这是位于单元中心的单个节点 $(0,0)$。\n    *   节点 $(0, 0) \\equiv (\\xi_1, \\eta_1)$: 相应的基函数是 $N_{11}(\\xi, \\eta)$。\n    $$N_{11}(\\xi, \\eta) = L_1(\\xi) L_1(\\eta) = (1 - \\xi^2)(1 - \\eta^2)$$\n\n推导至此完成。问题要求给出内部基函数的具体表达式。根据上述推导，与中心节点 $(0,0)$ 相关的基函数是 $N_{11}(\\xi, \\eta)$。\n\n其显式形式为 $N_{11}(\\xi, \\eta) = (1 - \\xi^2)(1 - \\eta^2) = 1 - \\xi^2 - \\eta^2 + \\xi^2 \\eta^2$。",
            "answer": "- 问题验证通过。 -\n$$\\boxed{(1 - \\xi^2)(1 - \\eta^2)}$$"
        },
        {
            "introduction": "在理解了基函数的构造之后，下一步是学习如何在有限元计算中应用它们。一个核心任务是为物理单元装配单元矩阵，例如质量矩阵或刚度矩阵。这项练习 () 引导您将参考单元上的积分通过等参映射转换到物理单元上，并推导双线性 ($Q_1$) 单元的质量矩阵。通过这个过程，您将清楚地看到单元的几何形状（通过雅可比行列式）如何直接影响最终的离散方程。",
            "id": "3437478",
            "problem": "令 $\\hat{K} := [-1,1] \\times [-1,1]$ 为参考正方形，并令 $\\{\\hat{N}_i\\}_{i=1}^{4}$ 表示与顶点 $\\{(-1,-1),(1,-1),(1,1),(-1,1)\\}$ 相关的双线性拉格朗日基函数，即\n$$\n\\hat{N}_1(\\xi,\\eta) = \\tfrac{1}{4}(1-\\xi)(1-\\eta),\\quad\n\\hat{N}_2(\\xi,\\eta) = \\tfrac{1}{4}(1+\\xi)(1-\\eta),\\quad\n\\hat{N}_3(\\xi,\\eta) = \\tfrac{1}{4}(1+\\xi)(1+\\eta),\\quad\n\\hat{N}_4(\\xi,\\eta) = \\tfrac{1}{4}(1-\\xi)(1+\\eta).\n$$\n考虑一个物理单元 $K$，它是一个顶点为 $\\{x_0, x_0 + a, x_0 + a + b, x_0 + b\\}$ 的平行四边形，其中 $x_0 \\in \\mathbb{R}^2$，$a,b \\in \\mathbb{R}^2$ 是不共线的边向量。令仿射映射 $F : \\hat{K} \\to K$ 由下式给出\n$$\nx(\\xi,\\eta) \\;=\\; x_0 \\;+\\; \\tfrac{1+\\xi}{2}\\,a \\;+\\; \\tfrac{1+\\eta}{2}\\,b,\n$$\n其雅可比矩阵为常数 $J := \\left[\\tfrac{a}{2}\\;\\; \\tfrac{b}{2}\\right] \\in \\mathbb{R}^{2 \\times 2}$ 且 $|\\det J| = \\tfrac{1}{4}|a_x b_y - a_y b_x|$。\n\n从标量 $L^2$ 内积的单元质量矩阵定义出发，\n$$\nM_{ij}(K) \\;=\\; \\int_{K} \\varphi_i(x)\\,\\varphi_j(x)\\,dx,\n$$\n其中 $\\varphi_i := \\hat{N}_i \\circ F^{-1}$，对于 $i \\in \\{1,2,3,4\\}$，执行以下操作：\n\n- 推导参考单元上的显式 $4 \\times 4$ 质量矩阵，\n$$\nM_{ij}(\\hat{K}) \\;=\\; \\int_{\\hat{K}} \\hat{N}_i(\\xi,\\eta)\\,\\hat{N}_j(\\xi,\\eta)\\,d\\xi\\,d\\eta,\n$$\n使用与被积函数多项式次数一致的精确张量积高斯-勒让德求积法。将 $M(\\hat{K})$ 以最简有理数形式逐项表示。\n\n- 通过仿射变量变换，将此结果映射到物理平行四边形 $K$ 上，并获得用 $a$ 和 $b$ 表示的显式 $4 \\times 4$ 质量矩阵 $M(K)$。\n\n- 比较 $M(K)$ 和 $M(\\hat{K})$，并推断它们之间的精确缩放关系。\n\n最后，计算比率\n$$\nR \\;=\\; \\frac{\\det\\!\\big(M(K)\\big)}{\\det\\!\\big(M(\\hat{K})\\big)}\n$$\n作为用 $a = (a_x,a_y)$ 和 $b = (b_x,b_y)$ 的分量表示的闭式解析表达式。请将最终答案表示为单个简化表达式。无需四舍五入，不涉及单位。",
            "solution": "该问题要求推导双线性四边形单元的质量矩阵，并计算物理单元矩阵与参考单元矩阵的行列式之比。该问题是适定的，并且基于有限元方法的标准理论。\n\n首先，我们计算参考单元 $\\hat{K} = [-1,1] \\times [-1,1]$ 上的质量矩阵。其各项定义为：\n$$\nM_{ij}(\\hat{K}) = \\int_{\\hat{K}} \\hat{N}_i(\\xi,\\eta)\\,\\hat{N}_j(\\xi,\\eta)\\,d\\xi\\,d\\eta\n$$\n双线性基函数 $\\{\\hat{N}_i\\}_{i=1}^4$ 由下式给出：\n$$\n\\hat{N}_1(\\xi,\\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta) \\\\\n\\hat{N}_2(\\xi,\\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta) \\\\\n\\hat{N}_3(\\xi,\\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta) \\\\\n\\hat{N}_4(\\xi,\\eta) = \\frac{1}{4}(1-\\xi)(1+\\eta)\n$$\n这些基函数具有张量积结构。我们可以定义一维基函数 $l_1(\\zeta) = 1-\\zeta$ 和 $l_2(\\zeta) = 1+\\zeta$。那么二维基函数就是诸如 $\\hat{N}_1(\\xi,\\eta) = \\frac{1}{4}l_1(\\xi)l_1(\\eta)$ 的乘积。\n\n$M_{ij}(\\hat{K})$ 的积分可以分离为一维积分的乘积。让我们计算在区间 $[-1,1]$ 上的基本一维积分：\n$$\n\\int_{-1}^{1} (1-\\zeta)^2 \\,d\\zeta = \\left[-\\frac{(1-\\zeta)^3}{3}\\right]_{-1}^{1} = 0 - \\left(-\\frac{2^3}{3}\\right) = \\frac{8}{3}\n$$\n$$\n\\int_{-1}^{1} (1+\\zeta)^2 \\,d\\zeta = \\left[\\frac{(1+\\zeta)^3}{3}\\right]_{-1}^{1} = \\frac{2^3}{3} - 0 = \\frac{8}{3}\n$$\n$$\n\\int_{-1}^{1} (1-\\zeta)(1+\\zeta) \\,d\\zeta = \\int_{-1}^{1} (1-\\zeta^2) \\,d\\zeta = \\left[\\zeta - \\frac{\\zeta^3}{3}\\right]_{-1}^{1} = \\left(1-\\frac{1}{3}\\right) - \\left(-1+\\frac{1}{3}\\right) = \\frac{2}{3} - \\left(-\\frac{2}{3}\\right) = \\frac{4}{3}\n$$\n这些积分是精确的。问题要求使用高斯-勒让德求积法。被积函数在每个变量中都是二次多项式，因此两点法则（对于次数最高为 $2 \\times 2 - 1 = 3$ 的多项式是精确的）是足够的。其结果与直接积分相同。\n\n现在我们可以计算矩阵项 $M_{ij}(\\hat{K})$。每个积分中都出现因子 $(\\frac{1}{4})^2 = \\frac{1}{16}$。\n对于对角线项：\n$$\nM_{11}(\\hat{K}) = \\frac{1}{16} \\int_{-1}^{1}(1-\\xi)^2\\,d\\xi \\int_{-1}^{1}(1-\\eta)^2\\,d\\eta = \\frac{1}{16} \\left(\\frac{8}{3}\\right)\\left(\\frac{8}{3}\\right) = \\frac{4}{9}\n$$\n根据基函数和定义域的对称性，所有对角线项都相同：$M_{11}=M_{22}=M_{33}=M_{44}=\\frac{4}{9}$。\n\n对于非对角线项：\n$$\nM_{12}(\\hat{K}) = \\frac{1}{16} \\int_{-1}^{1}(1-\\xi)(1+\\xi)\\,d\\xi \\int_{-1}^{1}(1-\\eta)^2\\,d\\eta = \\frac{1}{16} \\left(\\frac{4}{3}\\right)\\left(\\frac{8}{3}\\right) = \\frac{2}{9}\n$$\n根据对称性，$M_{21} = M_{12} = \\frac{2}{9}$。同样，$M_{23}=M_{32}=M_{34}=M_{43}=M_{41}=M_{14} = \\frac{2}{9}$。\n例如，对于 $M_{14}$：\n$$\nM_{14}(\\hat{K}) = \\frac{1}{16} \\int_{-1}^{1}(1-\\xi)^2\\,d\\xi \\int_{-1}^{1}(1-\\eta)(1+\\eta)\\,d\\eta = \\frac{1}{16} \\left(\\frac{8}{3}\\right)\\left(\\frac{4}{3}\\right) = \\frac{2}{9}\n$$\n最后，我们计算“交叉”项：\n$$\nM_{13}(\\hat{K}) = \\frac{1}{16} \\int_{-1}^{1}(1-\\xi)(1+\\xi)\\,d\\xi \\int_{-1}^{1}(1-\\eta)(1+\\eta)\\,d\\eta = \\frac{1}{16} \\left(\\frac{4}{3}\\right)\\left(\\frac{4}{3}\\right) = \\frac{1}{9}\n$$\n根据对称性，$M_{31} = M_{13} = \\frac{1}{9}$。\n$$\nM_{24}(\\hat{K}) = \\frac{1}{16} \\int_{-1}^{1}(1+\\xi)(1-\\xi)\\,d\\xi \\int_{-1}^{1}(1-\\eta)(1+\\eta)\\,d\\eta = \\frac{1}{16} \\left(\\frac{4}{3}\\right)\\left(\\frac{4}{3}\\right) = \\frac{1}{9}\n$$\n根据对称性，$M_{42} = M_{24} = \\frac{1}{9}$。\n\n将这些项组合起来，参考单元上的质量矩阵是：\n$$\nM(\\hat{K}) = \\frac{1}{9}\n\\begin{pmatrix}\n4 & 2 & 1 & 2 \\\\\n2 & 4 & 2 & 1 \\\\\n1 & 2 & 4 & 2 \\\\\n2 & 1 & 2 & 4\n\\end{pmatrix}\n$$\n接下来，我们推导物理平行四边形 $K$ 上的质量矩阵 $M(K)$。其项由 $M_{ij}(K) = \\int_{K} \\varphi_i(x)\\,\\varphi_j(x)\\,dx$ 给出。我们使用仿射映射 $x = F(\\xi, \\eta)$ 将变量从 $x \\in K$ 变换到 $(\\xi, \\eta) \\in \\hat{K}$。面积微元变换为 $dx = |\\det J|\\,d\\xi\\,d\\eta$，其中 $J$ 是映射 $F$ 的雅可比矩阵。根据定义，物理基函数是 $\\varphi_i = \\hat{N}_i \\circ F^{-1}$，这意味着 $\\varphi_i(x) = \\varphi_i(F(\\xi,\\eta)) = \\hat{N}_i(\\xi,\\eta)$。\n将这些代入积分：\n$$\nM_{ij}(K) = \\int_{\\hat{K}} \\hat{N}_i(\\xi,\\eta)\\,\\hat{N}_j(\\xi,\\eta)\\,|\\det J|\\,d\\xi\\,d\\eta\n$$\n映射 $F$ 是仿射的，所以它的雅可比矩阵 $J$ 是常数。\n$$\nJ = \\frac{\\partial x}{\\partial (\\xi,\\eta)} = \\left[ \\frac{\\partial}{\\partial \\xi}\\left(x_0 + \\tfrac{1+\\xi}{2}a + \\tfrac{1+\\eta}{2}b\\right) \\quad \\frac{\\partial}{\\partial \\eta}\\left(x_0 + \\tfrac{1+\\xi}{2}a + \\tfrac{1+\\eta}{2}b\\right) \\right] = \\left[ \\frac{a}{2} \\quad \\frac{b}{2} \\right]\n$$\n雅可比行列式是：\n$$\n\\det J = \\det \\begin{pmatrix} a_x/2 & b_x/2 \\\\ a_y/2 & b_y/2 \\end{pmatrix} = \\frac{1}{4}(a_x b_y - a_y b_x)\n$$\n由于向量 $a$ 和 $b$ 不共线，$\\det J \\neq 0$。因子 $|\\det J| = \\frac{1}{4}|a_x b_y - a_y b_x|$ 是一个常数标量值，等于平行四边形 $K$ 的面积与参考正方形 $\\hat{K}$ 的面积之比。\n我们可以从积分中提出因子 $|\\det J|$：\n$$\nM_{ij}(K) = |\\det J| \\int_{\\hat{K}} \\hat{N}_i(\\xi,\\eta)\\,\\hat{N}_j(\\xi,\\eta)\\,d\\xi\\,d\\eta = |\\det J| M_{ij}(\\hat{K})\n$$\n这对所有项 $(i,j)$ 都成立，所以矩阵关系是：\n$$\nM(K) = |\\det J| M(\\hat{K}) = \\frac{1}{4}|a_x b_y - a_y b_x| M(\\hat{K})\n$$\n这是物理质量矩阵和参考质量矩阵之间的精确缩放关系。具体来说，$M(K)$ 是：\n$$\nM(K) = \\frac{|a_x b_y - a_y b_x|}{36}\n\\begin{pmatrix}\n4 & 2 & 1 & 2 \\\\\n2 & 4 & 2 & 1 \\\\\n1 & 2 & 4 & 2 \\\\\n2 & 1 & 2 & 4\n\\end{pmatrix}\n$$\n最后，我们计算比率 $R = \\frac{\\det(M(K))}{\\det(M(\\hat{K}))}$。\n使用行列式的性质 $\\det(cA) = c^n \\det(A)$，对于一个 $n \\times n$ 矩阵 $A$ 和一个标量 $c$。这里，$A=M(\\hat{K})$，$c=|\\det J|$，$n=4$：\n$$\n\\det(M(K)) = \\det\\left(|\\det J| M(\\hat{K})\\right) = (|\\det J|)^4 \\det(M(\\hat{K}))\n$$\n因此，比率 $R$ 是：\n$$\nR = \\frac{(|\\det J|)^4 \\det(M(\\hat{K}))}{\\det(M(\\hat{K}))}\n$$\n质量矩阵 $M(\\hat{K})$ 是可逆的（它是对称正定的），所以它的行列式不为零。我们可以从分子和分母中约去 $\\det(M(\\hat{K}))$。\n$$\nR = (|\\det J|)^4\n$$\n代入 $|\\det J|$ 的表达式：\n$$\nR = \\left(\\frac{1}{4}|a_x b_y - a_y b_x|\\right)^4 = \\frac{1}{4^4} |a_x b_y - a_y b_x|^4\n$$\n由于幂是偶数，绝对值是多余的。\n$$\nR = \\frac{1}{256} (a_x b_y - a_y b_x)^4\n$$\n这是比率 $R$ 的最终闭式表达式。",
            "answer": "$$ \\boxed{ \\frac{(a_x b_y - a_y b_x)^4}{256} } $$"
        },
        {
            "introduction": "除了完整的张量积单元外，有限元分析中还常用另一类更经济的“意外” (serendipity) 单元。为了深入理解不同单元家族的设计思想和适用范围，这项练习 () 将通过一个精心设计的函数来对比双二次 ($Q_2$) 单元和二次“意外” ($S_2$) 单元的插值行为。您将发现，正是 $Q_2$ 单元的内部节点（或称“气泡”函数）赋予了它独特的表示能力，而这正是 $S_2$ 单元所不具备的。",
            "id": "3437496",
            "problem": "考虑一个物理正方形 $K = [-1,1] \\times [-1,1]$ 上的单个等参四边形有限元，使用从参考正方形出发的恒等映射，使得参考坐标与物理坐标重合。令 $S_2(K)$ 表示二维二次 serendipity 空间，定义为与 $K$ 的 4 个顶点和 4 个边中点相关联的拉格朗日形函数的生成空间（因此 $S_2(K)$ 的维数为 8），令 $Q_2(K)$ 表示 $K$ 上的完全张量积双二次空间（维数为 9）。分别通过在 $S_2(K)$ 和 $Q_2(K)$ 对应的节点集上施加函数值来定义拉格朗日插值算子 $I_{S_2}: C^0(K) \\to S_2(K)$ 和 $I_{Q_2}: C^0(K) \\to Q_2(K)$。\n\n令目标函数为\n$$\nu(x,y) = \\bigl(1 - x^2\\bigr)\\bigl(1 - y^2\\bigr) \\quad \\text{for } (x,y) \\in K.\n$$\n\n从插值算子和自由度的定义出发，论证在 $K$ 上是否有 $I_{Q_2}u = u$ 和 $I_{S_2}u = 0$，并解释 $Q_2(K)$ 中的内部自由度在此结果中的作用。然后，计算 $S_2$ 插值误差的 $L^2(K)$-范数，\n$$\n\\|u - I_{S_2}u\\|_{L^2(K)} = \\left( \\int_{-1}^{1} \\int_{-1}^{1} \\bigl(u(x,y) - I_{S_2}u(x,y)\\bigr)^2 \\, dx \\, dy \\right)^{1/2},\n$$\n并以单一精确值的形式给出答案。不需要四舍五入。",
            "solution": "此问题在数值分析和有限元方法领域内是适定的且具有科学依据。所有术语都是标准的，前提条件是一致的。我们可以开始求解。\n\n该问题要求分析函数 $u(x,y) = (1 - x^2)(1 - y^2)$ 在正方形域 $K = [-1,1] \\times [-1,1]$ 上使用两个不同多项式空间 $Q_2(K)$ 和 $S_2(K)$ 的插值，然后计算一个插值误差范数。\n\n首先，我们分析在空间 $Q_2(K)$ 中的插值。空间 $Q_2(K)$ 是 $[-1,1]$ 上二次多项式的张量积空间。一个多项式 $p(x,y)$ 属于 $Q_2(K)$ 如果它可以写成\n$$\np(x,y) = \\sum_{i=0}^{2} \\sum_{j=0}^{2} c_{ij} x^i y^j.\n$$\n这个空间的维数是 $(2+1)(2+1) = 9$。拉格朗日插值算子 $I_{Q_2}: C^0(K) \\to Q_2(K)$ 的定义条件是 $I_{Q_2}u$ 在双二次单元的 9 个节点上与 $u$ 一致，这些节点是点 $(x_i, y_j)$，其中 $x_i, y_j \\in \\{-1, 0, 1\\}$。\n待插值的函数是 $u(x,y) = (1 - x^2)(1 - y^2) = 1 - x^2 - y^2 + x^2y^2$。我们可以看到这个函数是单项式 $1$、$x^2$、$y^2$ 和 $x^2y^2$ 的线性组合。所有这些单项式的形式都是 $x^i y^j$，其中 $i \\le 2$ 且 $j \\le 2$。因此，函数 $u(x,y)$ 是空间 $Q_2(K)$ 的一个元素，即 $u \\in Q_2(K)$。\n任何投影或插值算子的一个基本性质是，它可以再现已存在于目标空间中的函数。由于 $I_{Q_2}u$ 是 $Q_2(K)$ 中在 9 个节点处与 $u$ 匹配的唯一多项式，并且 $u$ 本身是 $Q_2(K)$ 中的一个多项式，它自然地匹配其自身的值，因此插值函数必定是函数本身。因此，我们得出结论，在 $K$ 上有 $I_{Q_2}u = u$。\n\n接下来，我们分析在空间 $S_2(K)$ 中的插值。空间 $S_2(K)$ 是 8 维的二次 serendipity 空间。该空间的自由度与正方形 $K$ 的 4 个顶点和 4 个边中点相关联。这 8 个节点是：\n- 顶点：$(\\pm 1, \\pm 1)$\n- 边中点：$(\\pm 1, 0)$ 和 $(0, \\pm 1)$\n插值算子 $I_{S_2}: C^0(K) \\to S_2(K)$ 产生唯一的 $S_2(K)$ 中的多项式 $I_{S_2}u$，它在这 8 个节点处与函数 $u$ 匹配。让我们在这些节点上计算函数 $u(x,y) = (1 - x^2)(1 - y^2)$ 的值。\n对于任何顶点，例如 $(1,1)$，我们有 $x^2=1$ 和 $y^2=1$，所以 $u(1,1) = (1 - 1^2)(1 - 1^2) = 0$。这对所有 4 个顶点 $(\\pm 1, \\pm 1)$ 都成立。\n对于垂直边上的任何边中点，例如 $(1,0)$，我们有 $x^2 = 1$，所以 $u(1,0) = (1 - 1^2)(1 - 0^2) = 0$。这对中点 $(\\pm 1, 0)$ 都成立。\n对于水平边上的任何边中点，例如 $(0,1)$，我们有 $y^2 = 1$，所以 $u(0,1) = (1 - 0^2)(1 - 1^2) = 0$。这对中点 $(0, \\pm 1)$ 都成立。\n因此，函数 $u(x,y)$ 在定义 $S_2(K)$ 空间的所有 8 个节点上都为零。\n插值函数 $I_{S_2}u$ 必须是 $S_2(K)$ 中的一个多项式，在所有 8 个节点上的值都为 0。零函数 $p(x,y) = 0$ 是一个多项式，并且包含在 $S_2(K)$ 中。它显然满足在所有 8 个节点上 $p(x_i, y_i) = 0$ 的条件。根据拉格朗日插值函数的唯一性，必然有 $I_{S_2}u$ 恒等于零函数。因此，我们得出结论，在 $K$ 上有 $I_{S_2}u = 0$。\n\n$Q_2(K)$ 中内部自由度的作用是这一结果的核心。$Q_2(K)$ 空间由单项式 $\\{1, x, y, x^2, xy, y^2, x^2y, xy^2, x^2y^2\\}$ 生成，而 serendipity 空间 $S_2(K)$ 由 $\\{1, x, y, x^2, xy, y^2, x^2y, xy^2\\}$ 生成。在 $Q_2(K)$ 中但不在 $S_2(K)$ 中的单个基函数是 $x^2y^2$。函数 $u(x,y) = 1 - x^2 - y^2 + x^2y^2$ 包含这个 $x^2y^2$ 项，这就是为什么 $u \\in Q_2(K)$ 但 $u \\notin S_2(K)$。\n与 $S_2(K)$ 相比，$Q_2(K)$ 的额外自由度与原点处的内部节点 $(0,0)$ 相关联。与此节点相关的拉格朗日基函数，通常称为“泡泡函数”，必须是 $Q_2(K)$ 中的一个多项式，它在 $(0,0)$ 处等于 1，在其他 8 个节点（这些节点恰好是边界上的 serendipity 节点）处等于 0。函数 $u(x,y) = (1-x^2)(1-y^2)$ 正好具有这些性质：它在整个边界 $\\partial K$ 上为零（其中 $x=\\pm 1$ 或 $y=\\pm 1$），并且它在原点的值为 $u(0,0) = (1-0^2)(1-0^2) = 1$。因此，我们的函数 $u(x,y)$ 正是 $Q_2(K)$ 单元的泡泡基函数。$Q_2$ 插值是精确的，因为函数本身就是一个基函数。$S_2$ 插值为零，因为函数在所有 $S_2$ 节点上都定义为零。内部节点使得 $Q_2(K)$ 能够表示在边界上消失但在内部非零的函数，这是 $S_2(K)$ 所不具备的能力。\n\n最后，我们计算 $S_2$ 插值误差的 $L^2(K)$-范数。误差为 $u - I_{S_2}u$。由于我们已经确定 $I_{S_2}u = 0$，误差就是函数 $u(x,y)$ 本身。我们需要计算 $\\|u\\|_{L^2(K)}$：\n$$\n\\|u - I_{S_2}u\\|_{L^2(K)} = \\|u\\|_{L^2(K)} = \\left( \\int_{-1}^{1} \\int_{-1}^{1} \\bigl(u(x,y)\\bigr)^2 \\, dx \\, dy \\right)^{1/2}.\n$$\n代入 $u(x,y)$ 的表达式：\n$$\n\\|u\\|_{L^2(K)}^2 = \\int_{-1}^{1} \\int_{-1}^{1} \\left[ \\bigl(1 - x^2\\bigr)\\bigl(1 - y^2\\bigr) \\right]^2 \\, dx \\, dy.\n$$\n由于被积函数是 $x$ 和 $y$ 各自函数的乘积，积分可以分离：\n$$\n\\|u\\|_{L^2(K)}^2 = \\left( \\int_{-1}^{1} \\bigl(1 - x^2\\bigr)^2 \\, dx \\right) \\left( \\int_{-1}^{1} \\bigl(1 - y^2\\bigr)^2 \\, dy \\right).\n$$\n这两个积分是相同的。让我们计算其中一个：\n$$\nI = \\int_{-1}^{1} \\bigl(1 - x^2\\bigr)^2 \\, dx = \\int_{-1}^{1} \\bigl(1 - 2x^2 + x^4\\bigr) \\, dx.\n$$\n被积函数是偶函数，所以我们可以简化计算：\n$$\nI = 2 \\int_{0}^{1} \\bigl(1 - 2x^2 + x^4\\bigr) \\, dx = 2 \\left[ x - \\frac{2}{3}x^3 + \\frac{1}{5}x^5 \\right]_{0}^{1}.\n$$\n在积分上下限处计算原函数的值：\n$$\nI = 2 \\left( \\left(1 - \\frac{2}{3} + \\frac{1}{5}\\right) - 0 \\right) = 2 \\left( \\frac{15 - 10 + 3}{15} \\right) = 2 \\left( \\frac{8}{15} \\right) = \\frac{16}{15}.\n$$\n现在，我们可以求出范数的平方：\n$$\n\\|u\\|_{L^2(K)}^2 = I \\cdot I = \\left(\\frac{16}{15}\\right) \\left(\\frac{16}{15}\\right) = \\left(\\frac{16}{15}\\right)^2.\n$$\n$L^2(K)$-范数是这个值的平方根：\n$$\n\\|u - I_{S_2}u\\|_{L^2(K)} = \\sqrt{\\left(\\frac{16}{15}\\right)^2} = \\frac{16}{15}.\n$$",
            "answer": "$$\n\\boxed{\\frac{16}{15}}\n$$"
        }
    ]
}