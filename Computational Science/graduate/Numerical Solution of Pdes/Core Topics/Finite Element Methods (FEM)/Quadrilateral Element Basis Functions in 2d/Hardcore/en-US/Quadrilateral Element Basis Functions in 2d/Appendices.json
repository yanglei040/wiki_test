{
    "hands_on_practices": [
        {
            "introduction": "The foundation of any finite element method lies in its basis functions. This first practice guides you through the construction of the biquadratic, or $Q_2$, Lagrange basis on a reference square element. By starting with simple one-dimensional quadratic polynomials and applying the tensor-product rule, you will derive the full set of nine two-dimensional basis functions and see how they satisfy the fundamental Kronecker delta property .",
            "id": "3437518",
            "problem": "Consider the reference quadrilateral $\\hat{K} = [-1,1] \\times [-1,1]$ with isoparametric coordinates $(\\xi,\\eta)$. In the numerical solution of partial differential equations (PDE), the $Q_2$ finite element space on $\\hat{K}$ is defined as the tensor-product space of polynomials of degree at most $2$ in each coordinate. The Lagrange interpolation basis on a set of nodes is characterized by the Kronecker delta property: a basis function associated with a node evaluates to $1$ at its own node and to $0$ at all other nodes.\n\nStarting from the fundamental definition of one-dimensional quadratic Lagrange interpolation on the nodes $\\{-1,0,1\\}$, construct the two-dimensional tensor-product Lagrange basis on $\\hat{K}$ associated with the nine nodes\n$$\\{(-1,-1),(0,-1),(1,-1),(1,0),(1,1),(0,1),(-1,1),(-1,0),(0,0)\\}.$$\nDerive explicit polynomial formulas for the basis functions associated with:\n1) each vertex node,\n2) each edge-midpoint node,\n3) the interior node.\n\nYour derivation must start from the defining properties of one-dimensional Lagrange polynomials and the tensor-product construction, and must show that the resulting two-dimensional basis satisfies the Kronecker delta property at all nine nodes and spans $Q_2(\\hat{K})$.\n\nFinally, provide the exact analytic expression (in closed form) of the interior basis function associated with the node $(0,0)$. The final answer must be a single closed-form expression with no units.",
            "solution": "The problem requires the derivation of the biquadratic ($Q_2$) Lagrange basis functions on the reference square element $\\hat{K} = [-1,1] \\times [-1,1]$ using a tensor-product approach. The derivation will begin with the one-dimensional quadratic Lagrange polynomials and then extend to two dimensions. We must also verify the fundamental properties of the resulting basis functions.\n\nThe space $Q_2(\\hat{K})$ is the set of all polynomials on $\\hat{K}$ of degree at most $2$ in each coordinate variable $\\xi$ and $\\eta$ separately. A general polynomial $p(\\xi, \\eta) \\in Q_2(\\hat{K})$ has the form\n$$p(\\xi, \\eta) = \\sum_{i=0}^{2} \\sum_{j=0}^{2} a_{ij} \\xi^i \\eta^j$$\nThis is a vector space of dimension $3 \\times 3 = 9$. We are tasked with constructing a basis for this space using Lagrange interpolation on the nine specified nodes. The node locations are given by the set $\\{(\\xi_i, \\eta_j) | i,j \\in \\{0, 1, 2\\}\\}$, where the nodal coordinates are $\\xi_0 = -1$, $\\xi_1 = 0$, $\\xi_2 = 1$ in the $\\xi$-direction and $\\eta_0 = -1$, $\\eta_1 = 0$, $\\eta_2 = 1$ in the $\\eta$-direction.\n\n**Step 1: One-Dimensional Quadratic Lagrange Basis**\n\nFirst, we construct the one-dimensional Lagrange basis polynomials, $L_i(\\xi)$, of degree $2$ on the interval $[-1,1]$ with nodes at $\\{-1, 0, 1\\}$. Let the nodes be indexed as $\\xi_0 = -1$, $\\xi_1 = 0$, and $\\xi_2 = 1$. These basis polynomials are defined by the Kronecker delta property:\n$$L_i(\\xi_j) = \\delta_{ij} = \\begin{cases} 1  \\text{if } i=j \\\\ 0  \\text{if } i \\neq j \\end{cases}$$\nfor $i, j \\in \\{0, 1, 2\\}$.\n\nThe general formula for a Lagrange polynomial is $L_i(\\xi) = \\prod_{j=0, j \\neq i}^{2} \\frac{\\xi - \\xi_j}{\\xi_i - \\xi_j}$. Applying this formula for each basis function:\n\nFor the node $\\xi_0 = -1$:\n$$L_0(\\xi) = \\frac{(\\xi - \\xi_1)(\\xi - \\xi_2)}{(\\xi_0 - \\xi_1)(\\xi_0 - \\xi_2)} = \\frac{(\\xi - 0)(\\xi - 1)}{(-1 - 0)(-1 - 1)} = \\frac{\\xi(\\xi - 1)}{(-1)(-2)} = \\frac{1}{2}(\\xi^2 - \\xi)$$\n\nFor the node $\\xi_1 = 0$:\n$$L_1(\\xi) = \\frac{(\\xi - \\xi_0)(\\xi - \\xi_2)}{(\\xi_1 - \\xi_0)(\\xi_1 - \\xi_2)} = \\frac{(\\xi - (-1))(\\xi - 1)}{(0 - (-1))(0 - 1)} = \\frac{(\\xi + 1)(\\xi - 1)}{(1)(-1)} = -(\\xi^2 - 1) = 1 - \\xi^2$$\n\nFor the node $\\xi_2 = 1$:\n$$L_2(\\xi) = \\frac{(\\xi - \\xi_0)(\\xi - \\xi_1)}{(\\xi_2 - \\xi_0)(\\xi_2 - \\xi_1)} = \\frac{(\\xi - (-1))(\\xi - 0)}{(1 - (-1))(1 - 0)} = \\frac{(\\xi + 1)\\xi}{(2)(1)} = \\frac{1}{2}(\\xi^2 + \\xi)$$\n\nThese three polynomials, $L_0(\\xi)$, $L_1(\\xi)$, and $L_2(\\xi)$, form a basis for the space of one-dimensional quadratic polynomials, $P_2([-1,1])$.\n\n**Step 2: Two-Dimensional Tensor-Product Basis**\n\nThe two-dimensional Lagrange basis functions, $N_{ij}(\\xi, \\eta)$, for the $Q_2$ space on $\\hat{K}$ are constructed by taking all possible tensor products of the one-dimensional basis functions:\n$$N_{ij}(\\xi, \\eta) = L_i(\\xi) L_j(\\eta) \\quad \\text{for } i, j \\in \\{0, 1, 2\\}$$\nEach function $N_{ij}$ is associated with the node $(\\xi_i, \\eta_j)$. There are $3 \\times 3 = 9$ such basis functions, corresponding to the nine nodes.\n\n**Step 3: Verification of Properties**\n\nWe must verify that this set of functions $\\{N_{ij}\\}$ forms a valid Lagrange basis for $Q_2(\\hat{K})$.\n\nFirst, we check the Kronecker delta property. We evaluate the basis function $N_{ij}(\\xi, \\eta)$ at a nodal point $(\\xi_k, \\eta_l)$, where $k, l \\in \\{0, 1, 2\\}$:\n$$N_{ij}(\\xi_k, \\eta_l) = L_i(\\xi_k) L_j(\\eta_l)$$\nFrom the definition of the 1D Lagrange polynomials, we know $L_i(\\xi_k) = \\delta_{ik}$ and $L_j(\\eta_l) = \\delta_{jl}$. Therefore,\n$$N_{ij}(\\xi_k, \\eta_l) = \\delta_{ik} \\delta_{jl}$$\nThis product is equal to $1$ if and only if $i = k$ and $j = l$, meaning the function is evaluated at its own node $(\\xi_i, \\eta_j)$. If either $i \\neq k$ or $j \\neq l$, the product is $0$. This confirms the required Kronecker delta property for the 2D basis.\n\nSecond, we show that the set $\\{N_{ij}\\}$ spans the space $Q_2(\\hat{K})$. The space $Q_2(\\hat{K})$ is $9$-dimensional. Our construction yields $9$ basis functions. Each $N_{ij}(\\xi, \\eta) = L_i(\\xi) L_j(\\eta)$ is a product of a quadratic in $\\xi$ and a quadratic in $\\eta$, so it is a biquadratic polynomial and belongs to $Q_2(\\hat{K})$. To show they form a basis, we must demonstrate their linear independence. Assume a linear combination of these functions is zero for all $(\\xi, \\eta) \\in \\hat{K}$:\n$$\\sum_{i=0}^{2} \\sum_{j=0}^{2} c_{ij} N_{ij}(\\xi, \\eta) = 0$$\nWe can evaluate this equation at any of the nine nodes $(\\xi_k, \\eta_l)$. Using the Kronecker delta property we just proved:\n$$\\sum_{i=0}^{2} \\sum_{j=0}^{2} c_{ij} N_{ij}(\\xi_k, \\eta_l) = \\sum_{i=0}^{2} \\sum_{j=0}^{2} c_{ij} (\\delta_{ik} \\delta_{jl}) = c_{kl} = 0$$\nSince we can do this for any choice of $k, l \\in \\{0, 1, 2\\}$, all coefficients $c_{kl}$ must be zero. This proves that the functions $\\{N_{ij}\\}$ are linearly independent. Since we have $9$ linearly independent functions in a $9$-dimensional space, they form a basis for $Q_2(\\hat{K})$.\n\n**Step 4: Explicit Formulas for Basis Functions**\n\nWe now derive the explicit formulas for the basis functions, categorized by the type of node they are associated with.\n\n1.  **Vertex Nodes**: These are the four nodes $(\\pm 1, \\pm 1)$, corresponding to index pairs $(i,j)$ where $i,j \\in \\{0, 2\\}$.\n    *   Node $(-1, -1) \\equiv (\\xi_0, \\eta_0)$: $N_{00}(\\xi, \\eta) = L_0(\\xi) L_0(\\eta) = \\frac{1}{4}(\\xi^2 - \\xi)(\\eta^2 - \\eta)$.\n    *   Node $(1, -1) \\equiv (\\xi_2, \\eta_0)$: $N_{20}(\\xi, \\eta) = L_2(\\xi) L_0(\\eta) = \\frac{1}{4}(\\xi^2 + \\xi)(\\eta^2 - \\eta)$.\n    *   Node $(1, 1) \\equiv (\\xi_2, \\eta_2)$: $N_{22}(\\xi, \\eta) = L_2(\\xi) L_2(\\eta) = \\frac{1}{4}(\\xi^2 + \\xi)(\\eta^2 + \\eta)$.\n    *   Node $(-1, 1) \\equiv (\\xi_0, \\eta_2)$: $N_{02}(\\xi, \\eta) = L_0(\\xi) L_2(\\eta) = \\frac{1}{4}(\\xi^2 - \\xi)(\\eta^2 + \\eta)$.\n\n2.  **Edge-Midpoint Nodes**: These are the four nodes on the midpoints of the edges, $(\\pm 1, 0)$ and $(0, \\pm 1)$. One index is $1$, while the other is $0$ or $2$.\n    *   Node $(0, -1) \\equiv (\\xi_1, \\eta_0)$: $N_{10}(\\xi, \\eta) = L_1(\\xi) L_0(\\eta) = (1 - \\xi^2) \\frac{1}{2}(\\eta^2 - \\eta)$.\n    *   Node $(1, 0) \\equiv (\\xi_2, \\eta_1)$: $N_{21}(\\xi, \\eta) = L_2(\\xi) L_1(\\eta) = \\frac{1}{2}(\\xi^2 + \\xi)(1 - \\eta^2)$.\n    *   Node $(0, 1) \\equiv (\\xi_1, \\eta_2)$: $N_{12}(\\xi, \\eta) = L_1(\\xi) L_2(\\eta) = (1 - \\xi^2) \\frac{1}{2}(\\eta^2 + \\eta)$.\n    *   Node $(-1, 0) \\equiv (\\xi_0, \\eta_1)$: $N_{01}(\\xi, \\eta) = L_0(\\xi) L_1(\\eta) = \\frac{1}{2}(\\xi^2 - \\xi)(1 - \\eta^2)$.\n\n3.  **Interior Node**: This is the single node at the center of the element, $(0,0)$.\n    *   Node $(0, 0) \\equiv (\\xi_1, \\eta_1)$: The corresponding basis function is $N_{11}(\\xi, \\eta)$.\n    $$N_{11}(\\xi, \\eta) = L_1(\\xi) L_1(\\eta) = (1 - \\xi^2)(1 - \\eta^2)$$\n\nThis completes the derivation. The problem asks for the specific expression for the interior basis function. Based on the derivation above, the basis function associated with the central node $(0,0)$ is $N_{11}(\\xi, \\eta)$.\n\nThe explicit form is $N_{11}(\\xi, \\eta) = (1 - \\xi^2)(1 - \\eta^2) = 1 - \\xi^2 - \\eta^2 + \\xi^2 \\eta^2$.",
            "answer": "$$- Problem validation passed. -$$\n$$\\boxed{(1 - \\xi^2)(1 - \\eta^2)}$$"
        },
        {
            "introduction": "Not all quadrilateral elements are created equal; the choice of polynomial space dictates an element's approximation power. This exercise explores the practical difference between the full tensor-product $Q_2$ space and the \"serendipity\" $S_2$ space, which omits the interior node. By interpolating a carefully chosen function, you will discover the unique role of the interior \"bubble\" function and gain a deeper appreciation for how the degrees of freedom control an element's ability to represent different solution behaviors .",
            "id": "3437496",
            "problem": "Consider a single isoparametric quadrilateral finite element on the physical square $K = [-1,1] \\times [-1,1]$, using the identity mapping from the reference square so that reference and physical coordinates coincide. Let $S_2(K)$ denote the quadratic serendipity space in two dimensions, defined as the span of the Lagrange shape functions associated with the $4$ vertices and $4$ edge midpoints of $K$ (thus $S_2(K)$ has dimension $8$), and let $Q_2(K)$ denote the full tensor-product biquadratic space on $K$ (dimension $9$). Define the Lagrange interpolation operators $I_{S_2}: C^0(K) \\to S_2(K)$ and $I_{Q_2}: C^0(K) \\to Q_2(K)$ by enforcing function values at the corresponding nodal sets for $S_2(K)$ and $Q_2(K)$, respectively.\n\nLet the target function be\n$$\nu(x,y) = \\bigl(1 - x^2\\bigr)\\bigl(1 - y^2\\bigr) \\quad \\text{for } (x,y) \\in K.\n$$\n\nStarting from the definitions of the interpolation operators and the degrees of freedom, justify whether $I_{Q_2}u = u$ and whether $I_{S_2}u = 0$ on $K$, and explain the role of the interior degree of freedom in $Q_2(K)$ for this outcome. Then, compute the $L^2(K)$-norm of the $S_2$ interpolation error,\n$$\n\\|u - I_{S_2}u\\|_{L^2(K)} = \\left( \\int_{-1}^{1} \\int_{-1}^{1} \\bigl(u(x,y) - I_{S_2}u(x,y)\\bigr)^2 \\, dx \\, dy \\right)^{1/2},\n$$\nand give your answer as a single exact value. No rounding is required.",
            "solution": "The problem is well-posed and scientifically grounded within the field of numerical analysis and finite element methods. All terms are standard and the premises are consistent. We may proceed with the solution.\n\nThe problem asks for an analysis of the interpolation of the function $u(x,y) = (1 - x^2)(1 - y^2)$ on the square domain $K = [-1,1] \\times [-1,1]$ using two different polynomial spaces, $Q_2(K)$ and $S_2(K)$, followed by the computation of an interpolation error norm.\n\nFirst, we analyze the interpolation into the space $Q_2(K)$. The space $Q_2(K)$ is the tensor-product space of quadratic polynomials on $[-1,1]$. A polynomial $p(x,y)$ belongs to $Q_2(K)$ if it can be written as\n$$\np(x,y) = \\sum_{i=0}^{2} \\sum_{j=0}^{2} c_{ij} x^i y^j.\n$$\nThe dimension of this space is $(2+1)(2+1) = 9$. The Lagrange interpolation operator $I_{Q_2}: C^0(K) \\to Q_2(K)$ is defined by the condition that $I_{Q_2}u$ agrees with $u$ at the $9$ nodes of the biquadratic element, which are the points $(x_i, y_j)$ where $x_i, y_j \\in \\{-1, 0, 1\\}$.\nThe function to be interpolated is $u(x,y) = (1 - x^2)(1 - y^2) = 1 - x^2 - y^2 + x^2y^2$. We can see that this function is a linear combination of the monomials $1$, $x^2$, $y^2$, and $x^2y^2$. All of these monomials are of the form $x^i y^j$ with $i \\le 2$ and $j \\le 2$. Therefore, the function $u(x,y)$ is an element of the space $Q_2(K)$, i.e., $u \\in Q_2(K)$.\nA fundamental property of any projection or interpolation operator is that it reproduces functions that are already in the target space. Since $I_{Q_2}u$ is the unique polynomial in $Q_2(K)$ that matches $u$ at the $9$ nodal points, and $u$ itself is a polynomial in $Q_2(K)$ that trivially matches its own values, it must be that the interpolant is the function itself. Thus, we conclude that $I_{Q_2}u = u$ on $K$.\n\nNext, we analyze the interpolation into the space $S_2(K)$. The space $S_2(K)$ is the $8$-dimensional quadratic serendipity space. The degrees of freedom for this space are associated with the $4$ vertices and $4$ edge midpoints of the square $K$. These $8$ nodes are:\n- Vertices: $(\\pm 1, \\pm 1)$\n- Edge midpoints: $(\\pm 1, 0)$ and $(0, \\pm 1)$\nThe interpolation operator $I_{S_2}: C^0(K) \\to S_2(K)$ produces the unique polynomial $I_{S_2}u \\in S_2(K)$ that matches the function $u$ at these $8$ nodes. Let's evaluate the function $u(x,y) = (1 - x^2)(1 - y^2)$ at these nodes.\nFor any vertex, such as $(1,1)$, we have $x^2=1$ and $y^2=1$, so $u(1,1) = (1 - 1^2)(1 - 1^2) = 0$. This is true for all $4$ vertices $(\\pm 1, \\pm 1)$.\nFor any edge midpoint on a vertical edge, such as $(1,0)$, we have $x^2 = 1$, so $u(1,0) = (1 - 1^2)(1 - 0^2) = 0$. This is true for the midpoints $(\\pm 1, 0)$.\nFor any edge midpoint on a horizontal edge, such as $(0,1)$, we have $y^2 = 1$, so $u(0,1) = (1 - 0^2)(1 - 1^2) = 0$. This is true for the midpoints $(0, \\pm 1)$.\nTherefore, the function $u(x,y)$ is zero at all $8$ nodal points defining the $S_2(K)$ space.\nThe interpolant $I_{S_2}u$ must be a polynomial in $S_2(K)$ that has a value of $0$ at all $8$ nodes. The zero function, $p(x,y) = 0$, is a polynomial and is contained in $S_2(K)$. It clearly satisfies the condition $p(x_i, y_i) = 0$ at all $8$ nodes. By the uniqueness of the Lagrange interpolant, it must be that $I_{S_2}u$ is identically the zero function. Thus, we conclude that $I_{S_2}u = 0$ on $K$.\n\nThe role of the interior degree of freedom in $Q_2(K)$ is central to this outcome. The space $Q_2(K)$ is spanned by the monomials $\\{1, x, y, x^2, xy, y^2, x^2y, xy^2, x^2y^2\\}$, while the serendipity space $S_2(K)$ is spanned by $\\{1, x, y, x^2, xy, y^2, x^2y, xy^2\\}$. The single basis function that is in $Q_2(K)$ but not $S_2(K)$ is related to the $x^2y^2$ monomial. The function $u(x,y) = 1 - x^2 - y^2 + x^2y^2$ contains this $x^2y^2$ term, which is why $u \\in Q_2(K)$ but $u \\notin S_2(K)$.\nThe extra degree of freedom for $Q_2(K)$ compared to $S_2(K)$ is associated with the interior node at the origin, $(0,0)$. The Lagrange basis function associated with this node, often called the \"bubble function\", must be a polynomial in $Q_2(K)$ that equals $1$ at $(0,0)$ and $0$ at the other $8$ nodes (which are precisely the serendipity nodes on the boundary). The function $u(x,y) = (1-x^2)(1-y^2)$ has exactly these properties: it is zero on the entire boundary $\\partial K$, where $x=\\pm 1$ or $y=\\pm 1$, and its value at the origin is $u(0,0) = (1-0^2)(1-0^2) = 1$. Thus, our function $u(x,y)$ is precisely the bubble basis function for the $Q_2(K)$ element. The $Q_2$ interpolation is exact because the function itself is a basis function. The $S_2$ interpolation is zero because the function is defined to be zero at all $S_2$ nodes. The interior node allows $Q_2(K)$ to represent functions that vanish on the boundary but are non-zero inside, a capability which $S_2(K)$ lacks.\n\nFinally, we compute the $L^2(K)$-norm of the $S_2$ interpolation error. The error is $u - I_{S_2}u$. Since we have established that $I_{S_2}u = 0$, the error is simply the function $u(x,y)$ itself. We need to compute $\\|u\\|_{L^2(K)}$:\n$$\n\\|u - I_{S_2}u\\|_{L^2(K)} = \\|u\\|_{L^2(K)} = \\left( \\int_{-1}^{1} \\int_{-1}^{1} \\bigl(u(x,y)\\bigr)^2 \\, dx \\, dy \\right)^{1/2}.\n$$\nSubstituting the expression for $u(x,y)$:\n$$\n\\|u\\|_{L^2(K)}^2 = \\int_{-1}^{1} \\int_{-1}^{1} \\left[ \\bigl(1 - x^2\\bigr)\\bigl(1 - y^2\\bigr) \\right]^2 \\, dx \\, dy.\n$$\nSince the integrand is a product of functions of $x$ and $y$ separately, the integral can be separated:\n$$\n\\|u\\|_{L^2(K)}^2 = \\left( \\int_{-1}^{1} \\bigl(1 - x^2\\bigr)^2 \\, dx \\right) \\left( \\int_{-1}^{1} \\bigl(1 - y^2\\bigr)^2 \\, dy \\right).\n$$\nThe two integrals are identical. Let's compute one of them:\n$$\nI = \\int_{-1}^{1} \\bigl(1 - x^2\\bigr)^2 \\, dx = \\int_{-1}^{1} \\bigl(1 - 2x^2 + x^4\\bigr) \\, dx.\n$$\nThe integrand is an even function, so we can simplify the computation:\n$$\nI = 2 \\int_{0}^{1} \\bigl(1 - 2x^2 + x^4\\bigr) \\, dx = 2 \\left[ x - \\frac{2}{3}x^3 + \\frac{1}{5}x^5 \\right]_{0}^{1}.\n$$\nEvaluating the antiderivative at the limits:\n$$\nI = 2 \\left( \\left(1 - \\frac{2}{3} + \\frac{1}{5}\\right) - 0 \\right) = 2 \\left( \\frac{15 - 10 + 3}{15} \\right) = 2 \\left( \\frac{8}{15} \\right) = \\frac{16}{15}.\n$$\nNow, we can find the squared norm:\n$$\n\\|u\\|_{L^2(K)}^2 = I \\cdot I = \\left(\\frac{16}{15}\\right) \\left(\\frac{16}{15}\\right) = \\left(\\frac{16}{15}\\right)^2.\n$$\nThe $L^2(K)$-norm is the square root of this value:\n$$\n\\|u - I_{S_2}u\\|_{L^2(K)} = \\sqrt{\\left(\\frac{16}{15}\\right)^2} = \\frac{16}{15}.\n$$",
            "answer": "$$\n\\boxed{\\frac{16}{15}}\n$$"
        },
        {
            "introduction": "To solve a partial differential equation, we must translate abstract basis functions into concrete numerical matrices. This practice focuses on assembling the element mass matrix, a key component in time-dependent or eigenvalue problems, using bilinear ($Q_1$) basis functions. You will apply the isoparametric mapping to transform integrals from a physical parallelogram element back to the reference square, a core technique in finite element programming that demonstrates the power and utility of the reference element concept .",
            "id": "3437478",
            "problem": "Let $\\hat{K} := [-1,1] \\times [-1,1]$ be the reference square and let $\\{\\hat{N}_i\\}_{i=1}^{4}$ denote the bilinear Lagrange basis functions associated with the corners $\\{(-1,-1),(1,-1),(1,1),(-1,1)\\}$, namely\n$$\n\\hat{N}_1(\\xi,\\eta) = \\tfrac{1}{4}(1-\\xi)(1-\\eta),\\quad\n\\hat{N}_2(\\xi,\\eta) = \\tfrac{1}{4}(1+\\xi)(1-\\eta),\\quad\n\\hat{N}_3(\\xi,\\eta) = \\tfrac{1}{4}(1+\\xi)(1+\\eta),\\quad\n\\hat{N}_4(\\xi,\\eta) = \\tfrac{1}{4}(1-\\xi)(1+\\eta).\n$$\nConsider a physical element $K$ that is a parallelogram with vertices $\\{x_0, x_0 + a, x_0 + a + b, x_0 + b\\}$, where $x_0 \\in \\mathbb{R}^2$ and $a,b \\in \\mathbb{R}^2$ are noncollinear edge vectors. Let the affine mapping $F : \\hat{K} \\to K$ be given by\n$$\nx(\\xi,\\eta) \\;=\\; x_0 \\;+\\; \\tfrac{1+\\xi}{2}\\,a \\;+\\; \\tfrac{1+\\eta}{2}\\,b,\n$$\nwith constant Jacobian matrix $J := \\left[\\tfrac{a}{2}\\;\\; \\tfrac{b}{2}\\right] \\in \\mathbb{R}^{2 \\times 2}$ and $|\\det J| = \\tfrac{1}{4}|a_x b_y - a_y b_x|$.\n\nStarting from the definition of the element mass matrix for the scalar $L^2$ inner product,\n$$\nM_{ij}(K) \\;=\\; \\int_{K} \\varphi_i(x)\\,\\varphi_j(x)\\,dx,\n$$\nwhere $\\varphi_i := \\hat{N}_i \\circ F^{-1}$ for $i \\in \\{1,2,3,4\\}$, perform the following:\n\n- Derive the explicit $4 \\times 4$ mass matrix on the reference element,\n$$\nM_{ij}(\\hat{K}) \\;=\\; \\int_{\\hat{K}} \\hat{N}_i(\\xi,\\eta)\\,\\hat{N}_j(\\xi,\\eta)\\,d\\xi\\,d\\eta,\n$$\nusing exact tensor-product Gaussâ€“Legendre quadrature consistent with the polynomial degree of the integrand. Express $M(\\hat{K})$ entrywise in simplest rational form.\n\n- Map this result to the physical parallelogram $K$ via the affine change of variables and obtain the explicit $4 \\times 4$ mass matrix $M(K)$ in terms of $a$ and $b$.\n\n- Compare $M(K)$ to $M(\\hat{K})$ and deduce the exact scaling relationship between them.\n\nFinally, compute the ratio\n$$\nR \\;=\\; \\frac{\\det\\!\\big(M(K)\\big)}{\\det\\!\\big(M(\\hat{K})\\big)}\n$$\nas a closed-form analytic expression in terms of the components of $a = (a_x,a_y)$ and $b = (b_x,b_y)$. Provide your final answer as a single simplified expression. No rounding is required, and no units are involved.",
            "solution": "The problem asks for the derivation of the mass matrix for a bilinear quadrilateral element and the computation of a ratio of determinants between the physical and reference element matrices. The problem is well-posed and grounded in the standard theory of the Finite Element Method.\n\nFirst, we compute the mass matrix on the reference element $\\hat{K} = [-1,1] \\times [-1,1]$. The entries are defined as:\n$$\nM_{ij}(\\hat{K}) = \\int_{\\hat{K}} \\hat{N}_i(\\xi,\\eta)\\,\\hat{N}_j(\\xi,\\eta)\\,d\\xi\\,d\\eta\n$$\nThe bilinear basis functions $\\{\\hat{N}_i\\}_{i=1}^4$ are given by:\n$$\n\\hat{N}_1(\\xi,\\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta) \\\\\n\\hat{N}_2(\\xi,\\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta) \\\\\n\\hat{N}_3(\\xi,\\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta) \\\\\n\\hat{N}_4(\\xi,\\eta) = \\frac{1}{4}(1-\\xi)(1+\\eta)\n$$\nThese basis functions have a tensor-product structure. We can define 1D basis functions $l_1(\\zeta) = 1-\\zeta$ and $l_2(\\zeta) = 1+\\zeta$. Then the 2D basis functions are products like $\\hat{N}_1(\\xi,\\eta) = \\frac{1}{4}l_1(\\xi)l_1(\\eta)$.\n\nThe integral for $M_{ij}(\\hat{K})$ can be separated into products of 1D integrals. Let's compute the fundamental 1D integrals over the interval $[-1,1]$:\n$$\n\\int_{-1}^{1} (1-\\zeta)^2 \\,d\\zeta = \\left[-\\frac{(1-\\zeta)^3}{3}\\right]_{-1}^{1} = 0 - \\left(-\\frac{2^3}{3}\\right) = \\frac{8}{3}\n$$\n$$\n\\int_{-1}^{1} (1+\\zeta)^2 \\,d\\zeta = \\left[\\frac{(1+\\zeta)^3}{3}\\right]_{-1}^{1} = \\frac{2^3}{3} - 0 = \\frac{8}{3}\n$$\n$$\n\\int_{-1}^{1} (1-\\zeta)(1+\\zeta) \\,d\\zeta = \\int_{-1}^{1} (1-\\zeta^2) \\,d\\zeta = \\left[\\zeta - \\frac{\\zeta^3}{3}\\right]_{-1}^{1} = \\left(1-\\frac{1}{3}\\right) - \\left(-1+\\frac{1}{3}\\right) = \\frac{2}{3} - \\left(-\\frac{2}{3}\\right) = \\frac{4}{3}\n$$\nThese integrals are exact. The problem asks to use Gauss-Legendre quadrature. The integrands are quadratic polynomials in each variable, so a 2-point rule (which is exact for polynomials of degree up to $2 \\times 2 - 1 = 3$) is sufficient. The results are identical to direct integration.\n\nNow we can compute the matrix entries $M_{ij}(\\hat{K})$. The factor of $(\\frac{1}{4})^2 = \\frac{1}{16}$ appears in each integral.\nFor the diagonal entries:\n$$\nM_{11}(\\hat{K}) = \\frac{1}{16} \\int_{-1}^{1}(1-\\xi)^2\\,d\\xi \\int_{-1}^{1}(1-\\eta)^2\\,d\\eta = \\frac{1}{16} \\left(\\frac{8}{3}\\right)\\left(\\frac{8}{3}\\right) = \\frac{4}{9}\n$$\nBy symmetry of the basis functions and the domain, all diagonal entries are identical: $M_{11}=M_{22}=M_{33}=M_{44}=\\frac{4}{9}$.\n\nFor the off-diagonal entries:\n$$\nM_{12}(\\hat{K}) = \\frac{1}{16} \\int_{-1}^{1}(1-\\xi)(1+\\xi)\\,d\\xi \\int_{-1}^{1}(1-\\eta)^2\\,d\\eta = \\frac{1}{16} \\left(\\frac{4}{3}\\right)\\left(\\frac{8}{3}\\right) = \\frac{2}{9}\n$$\nBy symmetry, $M_{21} = M_{12} = \\frac{2}{9}$. Also, $M_{23}=M_{32}=M_{34}=M_{43}=M_{41}=M_{14} = \\frac{2}{9}$.\nFor instance, for $M_{14}$:\n$$\nM_{14}(\\hat{K}) = \\frac{1}{16} \\int_{-1}^{1}(1-\\xi)^2\\,d\\xi \\int_{-1}^{1}(1-\\eta)(1+\\eta)\\,d\\eta = \\frac{1}{16} \\left(\\frac{8}{3}\\right)\\left(\\frac{4}{3}\\right) = \\frac{2}{9}\n$$\nFinally, we compute the \"cross\" terms:\n$$\nM_{13}(\\hat{K}) = \\frac{1}{16} \\int_{-1}^{1}(1-\\xi)(1+\\xi)\\,d\\xi \\int_{-1}^{1}(1-\\eta)(1+\\eta)\\,d\\eta = \\frac{1}{16} \\left(\\frac{4}{3}\\right)\\left(\\frac{4}{3}\\right) = \\frac{1}{9}\n$$\nBy symmetry, $M_{31} = M_{13} = \\frac{1}{9}$.\n$$\nM_{24}(\\hat{K}) = \\frac{1}{16} \\int_{-1}^{1}(1+\\xi)(1-\\xi)\\,d\\xi \\int_{-1}^{1}(1-\\eta)(1+\\eta)\\,d\\eta = \\frac{1}{16} \\left(\\frac{4}{3}\\right)\\left(\\frac{4}{3}\\right) = \\frac{1}{9}\n$$\nBy symmetry, $M_{42} = M_{24} = \\frac{1}{9}$.\n\nAssembling these entries, the mass matrix on the reference element is:\n$$\nM(\\hat{K}) = \\frac{1}{9}\n\\begin{pmatrix}\n4  2  1  2 \\\\\n2  4  2  1 \\\\\n1  2  4  2 \\\\\n2  1  2  4\n\\end{pmatrix}\n$$\nNext, we derive the mass matrix $M(K)$ on the physical parallelogram $K$. The entries are given by $M_{ij}(K) = \\int_{K} \\varphi_i(x)\\,\\varphi_j(x)\\,dx$. We use the affine mapping $x = F(\\xi, \\eta)$ to change variables from $x \\in K$ to $(\\xi, \\eta) \\in \\hat{K}$. The differential area element transforms as $dx = |\\det J|\\,d\\xi\\,d\\eta$, where $J$ is the Jacobian matrix of the mapping $F$. By definition, the physical basis functions are $\\varphi_i = \\hat{N}_i \\circ F^{-1}$, which implies $\\varphi_i(x) = \\varphi_i(F(\\xi,\\eta)) = \\hat{N}_i(\\xi,\\eta)$.\nSubstituting these into the integral:\n$$\nM_{ij}(K) = \\int_{\\hat{K}} \\hat{N}_i(\\xi,\\eta)\\,\\hat{N}_j(\\xi,\\eta)\\,|\\det J|\\,d\\xi\\,d\\eta\n$$\nThe mapping $F$ is affine, so its Jacobian matrix $J$ is constant.\n$$\nJ = \\frac{\\partial x}{\\partial (\\xi,\\eta)} = \\left[ \\frac{\\partial}{\\partial \\xi}\\left(x_0 + \\tfrac{1+\\xi}{2}a + \\tfrac{1+\\eta}{2}b\\right) \\quad \\frac{\\partial}{\\partial \\eta}\\left(x_0 + \\tfrac{1+\\xi}{2}a + \\tfrac{1+\\eta}{2}b\\right) \\right] = \\left[ \\frac{a}{2} \\quad \\frac{b}{2} \\right]\n$$\nThe determinant of the Jacobian is:\n$$\n\\det J = \\det \\begin{pmatrix} a_x/2  b_x/2 \\\\ a_y/2  b_y/2 \\end{pmatrix} = \\frac{1}{4}(a_x b_y - a_y b_x)\n$$\nSince the vectors $a$ and $b$ are noncollinear, $\\det J \\neq 0$. The factor $|\\det J| = \\frac{1}{4}|a_x b_y - a_y b_x|$ is a constant scalar value, equal to the ratio of the area of the parallelogram $K$ to the area of the reference square $\\hat{K}$.\nWe can factor $|\\det J|$ out of the integral:\n$$\nM_{ij}(K) = |\\det J| \\int_{\\hat{K}} \\hat{N}_i(\\xi,\\eta)\\,\\hat{N}_j(\\xi,\\eta)\\,d\\xi\\,d\\eta = |\\det J| M_{ij}(\\hat{K})\n$$\nThis holds for all entries $(i,j)$, so the matrix relationship is:\n$$\nM(K) = |\\det J| M(\\hat{K}) = \\frac{1}{4}|a_x b_y - a_y b_x| M(\\hat{K})\n$$\nThis is the exact scaling relationship between the physical and reference mass matrices. explicitly, $M(K)$ is:\n$$\nM(K) = \\frac{|a_x b_y - a_y b_x|}{36}\n\\begin{pmatrix}\n4  2  1  2 \\\\\n2  4  2  1 \\\\\n1  2  4  2 \\\\\n2  1  2  4\n\\end{pmatrix}\n$$\nFinally, we compute the ratio $R = \\frac{\\det(M(K))}{\\det(M(\\hat{K}))}$.\nUsing the property of determinants $\\det(cA) = c^n \\det(A)$ for an $n \\times n$ matrix $A$ and a scalar $c$. Here, $A=M(\\hat{K})$, $c=|\\det J|$, and $n=4$:\n$$\n\\det(M(K)) = \\det\\left(|\\det J| M(\\hat{K})\\right) = (|\\det J|)^4 \\det(M(\\hat{K}))\n$$\nThe ratio $R$ is therefore:\n$$\nR = \\frac{(|\\det J|)^4 \\det(M(\\hat{K}))}{\\det(M(\\hat{K}))}\n$$\nThe mass matrix $M(\\hat{K})$ is invertible (it is symmetric positive definite), so its determinant is non-zero. We can cancel $\\det(M(\\hat{K}))$ from the numerator and denominator.\n$$\nR = (|\\det J|)^4\n$$\nSubstituting the expression for $|\\det J|$:\n$$\nR = \\left(\\frac{1}{4}|a_x b_y - a_y b_x|\\right)^4 = \\frac{1}{4^4} |a_x b_y - a_y b_x|^4\n$$\nSince the power is even, the absolute value is redundant.\n$$\nR = \\frac{1}{256} (a_x b_y - a_y b_x)^4\n$$\nThis is the final closed-form expression for the ratio $R$.",
            "answer": "$$ \\boxed{ \\frac{(a_x b_y - a_y b_x)^4}{256} } $$"
        }
    ]
}