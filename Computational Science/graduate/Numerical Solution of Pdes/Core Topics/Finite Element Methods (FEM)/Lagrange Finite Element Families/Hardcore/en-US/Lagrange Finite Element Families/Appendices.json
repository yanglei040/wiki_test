{
    "hands_on_practices": [
        {
            "introduction": "The concept of a nodal basis function is central to the Lagrange finite element family. This practice challenges you to construct a cubic basis function from first principles, starting with the natural and elegant framework of barycentric coordinates . By deriving its explicit form in Cartesian coordinates, you will solidify your understanding of how these abstract functions are realized as concrete polynomials.",
            "id": "3413665",
            "problem": "Consider the triangular finite element $T \\subset \\mathbb{R}^{2}$ with vertices $\\boldsymbol{v}_{1}=(0,0)$, $\\boldsymbol{v}_{2}=(2,1)$, and $\\boldsymbol{v}_{3}=(1,3)$, used in the standard Lagrange finite element family for discretizing Partial Differential Equations (PDE). Let $\\lambda_{1}$, $\\lambda_{2}$, and $\\lambda_{3}$ denote the barycentric (area) coordinates on $T$, defined by the relations $\\boldsymbol{x}=\\lambda_{1}\\boldsymbol{v}_{1}+\\lambda_{2}\\boldsymbol{v}_{2}+\\lambda_{3}\\boldsymbol{v}_{3}$ and $\\lambda_{1}+\\lambda_{2}+\\lambda_{3}=1$, where $\\boldsymbol{x}=(x,y)\\in T$.\n\nFor the degree-three Lagrange finite element on $T$, the nodal set consists of the three vertices, the six interior edge points corresponding to barycentric pairs $(\\frac{1}{3},\\frac{2}{3})$ and $(\\frac{2}{3},\\frac{1}{3})$ on each edge, and a single interior point with barycentric coordinates $(\\frac{1}{3},\\frac{1}{3},\\frac{1}{3})$. Starting only from the definitions of barycentric coordinates on a simplex and the defining properties of nodal Lagrange interpolation (i.e., a basis function equals $1$ at its associated node and $0$ at all other nodes), derive the unique polynomial $\\varphi_{\\mathrm{int}}\\in \\mathbb{P}_{3}(T)$ (the space of bivariate polynomials of total degree at most $3$ on $T$) that is the nodal basis function associated with the interior node $(\\frac{1}{3},\\frac{1}{3},\\frac{1}{3})$, and express $\\varphi_{\\mathrm{int}}$ explicitly as a single closed-form polynomial in the Cartesian coordinates $(x,y)$.\n\nYour final answer must be a single closed-form analytic expression in $(x,y)$. No rounding is required.",
            "solution": "The problem as stated is scientifically grounded, well-posed, and objective. It represents a standard exercise in the theory of the finite element method. A unique solution exists and can be derived from the provided definitions and conditions.\n\nThe task is to find the nodal basis function $\\varphi_{\\mathrm{int}} \\in \\mathbb{P}_{3}(T)$ associated with the interior node of a cubic Lagrange triangular element. $\\mathbb{P}_{3}(T)$ is the space of bivariate polynomials of total degree at most $3$. The defining property of a nodal basis function is that it equals $1$ at its associated node and $0$ at all other nodes in the nodal set.\n\n**Step 1: Construct the basis function in barycentric coordinates.**\nThe barycentric coordinates $(\\lambda_{1}, \\lambda_{2}, \\lambda_{3})$ are linear functions of the Cartesian coordinates $(x,y)$. A polynomial of degree $k$ in $(\\lambda_1, \\lambda_2, \\lambda_3)$ corresponds to a polynomial of degree $k$ in $(x,y)$, given the constraint $\\lambda_1 + \\lambda_2 + \\lambda_3 = 1$.\n\nThe nodal set for a degree-$3$ Lagrange element consists of $10$ points. These nodes have barycentric coordinates $(\\lambda_1, \\lambda_2, \\lambda_3) = (\\frac{i}{3}, \\frac{j}{3}, \\frac{k}{3})$ where $i,j,k$ are non-negative integers such that $i+j+k=3$.\nThe problem specifies the nodes as:\n- The $3$ vertices: $(1,0,0)$, $(0,1,0)$, $(0,0,1)$.\n- The $6$ edge points: $(\\frac{2}{3}, \\frac{1}{3}, 0)$, $(\\frac{1}{3}, \\frac{2}{3}, 0)$, $(0, \\frac{2}{3}, \\frac{1}{3})$, $(0, \\frac{1}{3}, \\frac{2}{3})$, $(\\frac{1}{3}, 0, \\frac{2}{3})$, $(\\frac{2}{3}, 0, \\frac{1}{3})$.\n- The $1$ interior point: $(\\frac{1}{3}, \\frac{1}{3}, \\frac{1}{3})$.\n\nThe basis function $\\varphi_{\\mathrm{int}}$ must be equal to $0$ at all nodes except for the interior node $(\\frac{1}{3}, \\frac{1}{3}, \\frac{1}{3})$. Notice that all $9$ of these other nodes lie on the boundary of the triangle $T$. The boundary of $T$ is defined by the lines where at least one barycentric coordinate is zero, i.e., the set of points where $\\lambda_{1}\\lambda_{2}\\lambda_{3} = 0$.\n\nSince $\\varphi_{\\mathrm{int}}$ is a polynomial that vanishes on the set where $\\lambda_{1}\\lambda_{2}\\lambda_{3} = 0$, it must be divisible by the polynomial $\\lambda_{1}\\lambda_{2}\\lambda_{3}$. Thus, $\\varphi_{\\mathrm{int}}$ can be written in the form:\n$$ \\varphi_{\\mathrm{int}}(\\lambda_{1}, \\lambda_{2}, \\lambda_{3}) = C \\cdot \\lambda_{1} \\lambda_{2} \\lambda_{3} $$\nfor some constant $C$. The product $\\lambda_{1}\\lambda_{2}\\lambda_{3}$ is a polynomial of degree $3$. Since $\\varphi_{\\mathrm{int}} \\in \\mathbb{P}_{3}(T)$, the factor $C$ must be a constant (a polynomial of degree $0$).\n\nTo determine the constant $C$, we use the condition that $\\varphi_{\\mathrm{int}}=1$ at its associated node, which is the interior node with barycentric coordinates $(\\frac{1}{3}, \\frac{1}{3}, \\frac{1}{3})$.\n$$ \\varphi_{\\mathrm{int}}\\left(\\frac{1}{3}, \\frac{1}{3}, \\frac{1}{3}\\right) = C \\cdot \\left(\\frac{1}{3}\\right) \\cdot \\left(\\frac{1}{3}\\right) \\cdot \\left(\\frac{1}{3}\\right) = 1 $$\n$$ C \\cdot \\frac{1}{27} = 1 \\implies C = 27 $$\nTherefore, the basis function in barycentric coordinates is:\n$$ \\varphi_{\\mathrm{int}}(\\lambda_{1}, \\lambda_{2}, \\lambda_{3}) = 27 \\lambda_{1} \\lambda_{2} \\lambda_{3} $$\n\n**Step 2: Convert barycentric coordinates to Cartesian coordinates.**\nThe relationship between a point $\\boldsymbol{x}=(x,y)$ and its barycentric coordinates $(\\lambda_1, \\lambda_2, \\lambda_3)$ with respect to the vertices $\\boldsymbol{v}_{1}=(0,0)$, $\\boldsymbol{v}_{2}=(2,1)$, and $\\boldsymbol{v}_{3}=(1,3)$ is given by:\n$$ \\boldsymbol{x} = \\lambda_{1}\\boldsymbol{v}_{1} + \\lambda_{2}\\boldsymbol{v}_{2} + \\lambda_{3}\\boldsymbol{v}_{3} $$\n$$ \\lambda_1 + \\lambda_2 + \\lambda_3 = 1 $$\nSubstituting the vertex coordinates:\n$$ \\begin{pmatrix} x \\\\ y \\end{pmatrix} = \\lambda_1 \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} + \\lambda_2 \\begin{pmatrix} 2 \\\\ 1 \\end{pmatrix} + \\lambda_3 \\begin{pmatrix} 1 \\\\ 3 \\end{pmatrix} $$\nThis yields a system of two equations for $\\lambda_2$ and $\\lambda_3$:\n$$ x = 2\\lambda_2 + \\lambda_3 $$\n$$ y = \\lambda_2 + 3\\lambda_3 $$\nWe solve this system. From the second equation, $\\lambda_2 = y - 3\\lambda_3$. Substituting this into the first equation:\n$$ x = 2(y - 3\\lambda_3) + \\lambda_3 = 2y - 6\\lambda_3 + \\lambda_3 = 2y - 5\\lambda_3 $$\n$$ 5\\lambda_3 = 2y - x \\implies \\lambda_3(x,y) = \\frac{1}{5}(2y-x) $$\nNow we find $\\lambda_2$:\n$$ \\lambda_2 = y - 3\\left(\\frac{1}{5}(2y-x)\\right) = y - \\frac{6}{5}y + \\frac{3}{5}x = \\frac{5y-6y}{5} + \\frac{3x}{5} = \\frac{3x-y}{5} $$\nSo, $\\lambda_2(x,y) = \\frac{1}{5}(3x-y)$.\nFinally, we find $\\lambda_1$ using $\\lambda_1 = 1-\\lambda_2-\\lambda_3$:\n$$ \\lambda_1 = 1 - \\frac{1}{5}(3x-y) - \\frac{1}{5}(2y-x) = \\frac{1}{5}(5 - (3x-y) - (2y-x)) $$\n$$ \\lambda_1 = \\frac{1}{5}(5 - 3x + y - 2y + x) = \\frac{1}{5}(5 - 2x - y) $$\nSo, the coordinate transformation is:\n$$ \\lambda_{1}(x,y) = \\frac{1}{5}(5 - 2x - y) $$\n$$ \\lambda_{2}(x,y) = \\frac{1}{5}(3x - y) $$\n$$ \\lambda_{3}(x,y) = \\frac{1}{5}(2y - x) $$\n\n**Step 3: Express $\\varphi_{\\mathrm{int}}$ as a polynomial in $(x,y)$.**\nWe substitute the expressions for $\\lambda_1$, $\\lambda_2$, and $\\lambda_3$ into the barycentric form of $\\varphi_{\\mathrm{int}}$:\n$$ \\varphi_{\\mathrm{int}}(x,y) = 27 \\left( \\frac{1}{5}(5 - 2x - y) \\right) \\left( \\frac{1}{5}(3x - y) \\right) \\left( \\frac{1}{5}(2y - x) \\right) $$\n$$ \\varphi_{\\mathrm{int}}(x,y) = \\frac{27}{125} (5 - 2x - y)(3x - y)(2y - x) $$\nNow, we expand the product of the three linear factors. First, we multiply the last two factors:\n$$ (3x - y)(2y - x) = 6xy - 3x^2 - 2y^2 + xy = -3x^2 + 7xy - 2y^2 $$\nNext, we multiply this result by the first factor, $(5 - 2x - y)$:\n$$ (5 - 2x - y)(-3x^2 + 7xy - 2y^2) = 5(-3x^2 + 7xy - 2y^2) - 2x(-3x^2 + 7xy - 2y^2) - y(-3x^2 + 7xy - 2y^2) $$\n$$ = (-15x^2 + 35xy - 10y^2) + (6x^3 - 14x^2y + 4xy^2) + (3x^2y - 7xy^2 + 2y^3) $$\nWe collect terms by degree and lexicographical order:\n- Cubic terms ($x^3, x^2y, xy^2, y^3$): $6x^3 + (-14+3)x^2y + (4-7)xy^2 + 2y^3 = 6x^3 - 11x^2y - 3xy^2 + 2y^3$\n- Quadratic terms ($x^2, xy, y^2$): $-15x^2 + 35xy - 10y^2$\n- Linear and constant terms: There are none.\n\nCombining all terms, the expanded polynomial is:\n$$ 6x^3 - 11x^2y - 3xy^2 + 2y^3 - 15x^2 + 35xy - 10y^2 $$\nFinally, we multiply by the constant factor $\\frac{27}{125}$ to obtain the expression for $\\varphi_{\\mathrm{int}}(x,y)$.\n\n$$ \\varphi_{\\mathrm{int}}(x,y) = \\frac{27}{125}(6x^3 - 11x^2y - 3xy^2 + 2y^3 - 15x^2 + 35xy - 10y^2) $$\nThis is the unique polynomial in $\\mathbb{P}_{3}(T)$ satisfying the required nodal properties.",
            "answer": "$$\n\\boxed{\\frac{27}{125}(6x^3 - 11x^2y - 3xy^2 + 2y^3 - 15x^2 + 35xy - 10y^2)}\n$$"
        },
        {
            "introduction": "The stability and accuracy of the finite element method are not guaranteed; they depend critically on the quality of the underlying mesh. This exercise focuses on the crucial concept of shape regularity by analyzing a pathological \"sliver\" tetrahedron . By deriving the shape-regularity constant directly from geometric definitions, you will gain a quantitative appreciation for how severe geometric distortion degrades element quality and, consequently, the stability of the interpolation operator.",
            "id": "3413693",
            "problem": "Consider the Linear Lagrange ($P_1$) finite element interpolation operator on tetrahedra for the numerical solution of Partial Differential Equations (PDEs) in the Finite Element Method (FEM). Let $K(\\varepsilon)$ be the tetrahedron in $\\mathbb{R}^{3}$ with vertices $v_{1}=(0,0,0)$, $v_{2}=(1,0,0)$, $v_{3}=(0,1,0)$, and $v_{4}=(1/2,1/2,\\varepsilon)$, where $\\varepsilon \\in (0,1]$. The shape-regularity constant $\\gamma_{K}$ for a tetrahedron $K$ is defined as $\\gamma_{K} = h_{K}/\\rho_{K}$, where $h_{K}$ is the maximum edge length of $K$, and $\\rho_{K}$ is the inradius of $K$ given by $\\rho_{K} = 3|K|/|\\partial K|$, with $|K|$ the volume and $|\\partial K|$ the surface area. \n\nBegin from the geometric definitions of volume, surface area, and inradius for a tetrahedron, and derive the exact symbolic expression of $\\gamma_{K(\\varepsilon)}$ in terms of $\\varepsilon$. Using the standard affine element mapping theory and the scaling of gradients of $P_{1}$ basis functions, argue why the $H^{1}$-seminorm stability constant of the nodal interpolation operator on $K(\\varepsilon)$ must grow proportionally to $\\gamma_{K(\\varepsilon)}$ as $\\varepsilon \\to 0$, and construct a sequence of meshes composed of congruent copies of $K(\\varepsilon)$ with $\\varepsilon$ tending to $0$ to demonstrate degradation of interpolation stability. \n\nFinally, compute the limit \n$$L \\;=\\; \\lim_{\\varepsilon \\to 0} \\varepsilon \\,\\gamma_{K(\\varepsilon)}.$$\nReport $L$ as the final answer. No rounding is required. The answer must be a single real number.",
            "solution": "We start from geometric definitions. For a tetrahedron $K$, the shape-regularity constant is $\\gamma_{K} = h_{K}/\\rho_{K}$, with inradius $\\rho_{K} = 3|K|/|\\partial K|$, where $|K|$ is volume and $|\\partial K|$ is total surface area. For the given tetrahedron $K(\\varepsilon)$ with vertices $v_{1}=(0,0,0)$, $v_{2}=(1,0,0)$, $v_{3}=(0,1,0)$, and $v_{4}=(1/2,1/2,\\varepsilon)$, we compute $|K(\\varepsilon)|$, $|\\partial K(\\varepsilon)|$, and $h_{K(\\varepsilon)}$.\n\nFirst, the base face is the triangle with vertices $v_{1}$, $v_{2}$, $v_{3}$ lying in the plane $z=0$. Its area is \n$$A_{0} \\;=\\; \\frac{1}{2}.$$\nThe height of the tetrahedron with respect to this base is the perpendicular distance of $v_{4}$ to the plane $z=0$, which is $\\varepsilon$. The volume is then\n$$|K(\\varepsilon)| \\;=\\; \\frac{1}{3} A_{0} \\varepsilon \\;=\\; \\frac{\\varepsilon}{6}.$$\n\nNext, compute the areas of the three lateral faces using the cross product formula for triangle area. For a triangle with vertices $p,q,r$, its area is $\\frac{1}{2}\\| (q-p) \\times (r-p) \\|$.\n\n1. Face with vertices $v_{1}$, $v_{2}$, $v_{4}$:\nTake $p=v_{1}$, $q=v_{2}$, and $r=v_{4}$. Then\n$$q-p \\;=\\; (1,0,0), \\qquad r-p \\;=\\; \\left(\\frac{1}{2},\\frac{1}{2},\\varepsilon\\right).$$\nThe cross product is\n$$(q-p) \\times (r-p) \\;=\\; (1,0,0) \\times \\left(\\frac{1}{2},\\frac{1}{2},\\varepsilon\\right) \\;=\\; \\left(0,-\\varepsilon,\\frac{1}{2}\\right),$$\nwith norm\n$$\\left\\| (q-p)\\times(r-p) \\right\\| \\;=\\; \\sqrt{\\varepsilon^{2} + \\left(\\frac{1}{2}\\right)^{2}} \\;=\\; \\sqrt{\\varepsilon^{2} + \\frac{1}{4}}.$$\nHence the area is\n$$A_{12,4} \\;=\\; \\frac{1}{2}\\sqrt{\\varepsilon^{2} + \\frac{1}{4}}.$$\n\n2. Face with vertices $v_{1}$, $v_{3}$, $v_{4}$:\nTake $p=v_{1}$, $q=v_{3}$, $r=v_{4}$, so\n$$q-p \\;=\\; (0,1,0), \\qquad r-p \\;=\\; \\left(\\frac{1}{2},\\frac{1}{2},\\varepsilon\\right).$$\nCross product:\n$$(q-p) \\times (r-p) \\;=\\; (0,1,0) \\times \\left(\\frac{1}{2},\\frac{1}{2},\\varepsilon\\right) \\;=\\; \\left(\\varepsilon,0,-\\frac{1}{2}\\right),$$\nnorm\n$$\\sqrt{\\varepsilon^{2} + \\left(\\frac{1}{2}\\right)^{2}} \\;=\\; \\sqrt{\\varepsilon^{2} + \\frac{1}{4}},$$\narea\n$$A_{13,4} \\;=\\; \\frac{1}{2}\\sqrt{\\varepsilon^{2} + \\frac{1}{4}}.$$\n\n3. Face with vertices $v_{2}$, $v_{3}$, $v_{4}$:\nTake $p=v_{2}$, $q=v_{3}$, $r=v_{4}$, giving\n$$q-p \\;=\\; (-1,1,0), \\qquad r-p \\;=\\; \\left(-\\frac{1}{2},\\frac{1}{2},\\varepsilon\\right).$$\nCross product:\n$$(q-p) \\times (r-p) \\;=\\; (-1,1,0) \\times \\left(-\\frac{1}{2},\\frac{1}{2},\\varepsilon\\right) \\;=\\; \\left(\\varepsilon,\\varepsilon,0\\right),$$\nnorm\n$$\\left\\| (q-p)\\times(r-p) \\right\\| \\;=\\; \\sqrt{\\varepsilon^{2} + \\varepsilon^{2}} \\;=\\; \\varepsilon \\sqrt{2},$$\narea\n$$A_{23,4} \\;=\\; \\frac{1}{2}\\varepsilon \\sqrt{2}.$$\n\nTherefore, the total surface area is\n$$|\\partial K(\\varepsilon)| \\;=\\; A_{0} + A_{12,4} + A_{13,4} + A_{23,4} \\;=\\; \\frac{1}{2} + \\frac{1}{2}\\sqrt{\\varepsilon^{2} + \\frac{1}{4}} + \\frac{1}{2}\\sqrt{\\varepsilon^{2} + \\frac{1}{4}} + \\frac{1}{2}\\varepsilon \\sqrt{2},$$\nwhich simplifies to\n$$|\\partial K(\\varepsilon)| \\;=\\; \\frac{1}{2} + \\sqrt{\\varepsilon^{2} + \\frac{1}{4}} + \\frac{1}{2}\\varepsilon \\sqrt{2}.$$\n\nThe inradius is given by\n$$\\rho_{K(\\varepsilon)} \\;=\\; \\frac{3|K(\\varepsilon)|}{|\\partial K(\\varepsilon)|} \\;=\\; \\frac{3\\left(\\frac{\\varepsilon}{6}\\right)}{\\frac{1}{2} + \\sqrt{\\varepsilon^{2} + \\frac{1}{4}} + \\frac{1}{2}\\varepsilon \\sqrt{2}} \\;=\\; \\frac{\\varepsilon/2}{\\frac{1}{2} + \\sqrt{\\varepsilon^{2} + \\frac{1}{4}} + \\frac{1}{2}\\varepsilon \\sqrt{2}} \\;=\\; \\frac{\\varepsilon}{1 + 2\\sqrt{\\varepsilon^{2} + \\frac{1}{4}} + \\varepsilon \\sqrt{2}}.$$\n\nNext, compute the maximum edge length $h_{K(\\varepsilon)}$. The base edges have lengths $\\|v_{2}-v_{1}\\|=1$, $\\|v_{3}-v_{1}\\|=1$, and $\\|v_{3}-v_{2}\\|=\\sqrt{2}$. The three edges from $v_{4}$ to the base vertices have lengths $\\|v_4-v_1\\|=\\sqrt{1/4+1/4+\\varepsilon^2}$, $\\|v_4-v_2\\|=\\sqrt{1/4+1/4+\\varepsilon^2}$, and $\\|v_4-v_3\\|=\\sqrt{1/4+1/4+\\varepsilon^2}$. All are equal to $\\sqrt{1/2 + \\varepsilon^{2}}$. Since $\\varepsilon \\in (0,1]$, we have $\\sqrt{1/2 + \\varepsilon^{2}} \\leq \\sqrt{1/2+1} = \\sqrt{3/2}  \\sqrt{2}$. Thus,\n$$h_{K(\\varepsilon)} \\;=\\; \\sqrt{2}.$$\n\nTherefore, the shape-regularity constant is\n$$\\gamma_{K(\\varepsilon)} \\;=\\; \\frac{h_{K(\\varepsilon)}}{\\rho_{K(\\varepsilon)}} \\;=\\; \\frac{\\sqrt{2}}{\\frac{\\varepsilon}{1 + 2\\sqrt{\\varepsilon^{2} + \\frac{1}{4}} + \\varepsilon \\sqrt{2}}} \\;=\\; \\frac{\\sqrt{2}\\left(1 + 2\\sqrt{\\varepsilon^{2} + \\frac{1}{4}} + \\varepsilon \\sqrt{2}\\right)}{\\varepsilon}.$$\n\nNow, we connect this geometric quantity to $P_{1}$ interpolation stability. For affine elements, the gradient of the $P_{1}$ nodal basis functions scales with the inverse Jacobian of the affine map from a fixed reference tetrahedron. Standard finite element theory shows that the $H^{1}$-seminorm stability constant of the interpolation operator on an element $K$ is bounded by a constant proportional to its shape-regularity parameter $\\gamma_{K}$. That is, there exists a reference-element-dependent constant $C_{\\mathrm{ref}}$ such that\n$$\\| \\nabla I_{K} u \\|_{L^{2}(K)} \\;\\leq\\; C_{\\mathrm{ref}} \\,\\gamma_{K} \\,\\| \\nabla u \\|_{L^{2}(K)} \\quad \\text{for all sufficiently smooth } u.$$\nAs $\\varepsilon \\to 0$, we see that $\\gamma_{K(\\varepsilon)} \\to \\infty$, specifically as $O(1/\\varepsilon)$. Thus, for the sliver tetrahedron $K(\\varepsilon)$, the stability constant blows up, degrading the quality of the interpolation. A sequence of meshes $\\mathcal{T}_n$ composed of congruent copies of $K(1/n)$ would see its global stability constant grow linearly with $n$, demonstrating severe degradation of interpolation stability.\n\nFinally, we compute the requested limit\n$$L \\;=\\; \\lim_{\\varepsilon \\to 0} \\varepsilon \\,\\gamma_{K(\\varepsilon)} \\;=\\; \\lim_{\\varepsilon \\to 0} \\varepsilon \\cdot \\frac{\\sqrt{2}\\left(1 + 2\\sqrt{\\varepsilon^{2} + \\frac{1}{4}} + \\varepsilon \\sqrt{2}\\right)}{\\varepsilon} \\;=\\; \\sqrt{2} \\left(1 + 2\\sqrt{0 + \\frac{1}{4}} + 0\\right).$$\nSince $\\sqrt{\\frac{1}{4}} = \\frac{1}{2}$, we obtain\n$$L \\;=\\; \\sqrt{2} \\cdot \\left(1 + 2\\left(\\frac{1}{2}\\right)\\right) \\;=\\; \\sqrt{2} \\cdot (1+1) \\;=\\; 2\\sqrt{2}.$$\nThis confirms the linear blow-up rate in $1/\\varepsilon$ with leading coefficient $2\\sqrt{2}$ for this sliver family.",
            "answer": "$$\\boxed{2\\sqrt{2}}$$"
        },
        {
            "introduction": "Moving from the single-element scale to the global system, the algebraic structure of the assembled matrices determines the overall behavior of the numerical scheme. This problem provides a window into these properties by asking you to perform a complete spectral analysis of the $P_1$ mass matrix on a uniform periodic mesh . Discovering the connection between the matrix eigenvectors and discrete Fourier modes reveals the intrinsic filtering properties of the finite element discretization, a deep insight crucial for analyzing time-dependent problems and numerical dispersion.",
            "id": "3413679",
            "problem": "Consider a one-dimensional periodic domain $\\Omega = [0,L]$ with periodic boundary conditions, partitioned into a uniform mesh of $N$ elements of length $h = L/N$. Let $\\{\\phi_{i}\\}_{i=0}^{N-1}$ denote the standard nodal hat functions of the Lagrange family of order one ($P_{1}$) on this mesh, forming a basis of the finite element space of continuous, piecewise linear functions with periodicity $\\phi_{i+N} = \\phi_{i}$. The consistent mass bilinear form is defined by $m(u,v) = \\int_{0}^{L} u(x) v(x) \\,\\mathrm{d}x$ and its matrix representation $\\boldsymbol{M} \\in \\mathbb{R}^{N \\times N}$ in the basis $\\{\\phi_{i}\\}$ has entries $M_{ij} = \\int_{0}^{L} \\phi_{i}(x) \\phi_{j}(x) \\,\\mathrm{d}x$.\n\nStarting from the fundamental definitions of the local shape functions on an element, derive the assembled global structure of $\\boldsymbol{M}$ on the periodic uniform mesh. Characterize the eigenpairs of $\\boldsymbol{M}$ by relating the eigenvectors to discrete Fourier patterns obtained from the Discrete Fourier Transform (DFT). Then, consider the linear spectral filter defined by the matrix exponential $\\boldsymbol{F}_{\\beta} = \\exp(-\\beta \\boldsymbol{M})$ with a positive parameter $\\beta  0$. For a DFT mode of wavenumber $m \\in \\{0,1,\\dots,N-1\\}$, parameterized by the angle $\\theta = \\frac{2\\pi m}{N}$, determine the exact amplification factor (gain) of $\\boldsymbol{F}_{\\beta}$ acting on this mode as a closed-form analytic expression in terms of $h$, $\\beta$, and $\\theta$.\n\nExpress your final answer as a single closed-form expression. No rounding is required.",
            "solution": "The problem asks for the amplification factor of a spectral filter defined by the exponential of the $P_1$ mass matrix on a uniform periodic 1D mesh. This involves deriving the mass matrix, finding its eigenvalues, and then applying the exponential function to those eigenvalues.\n\n**Step 1: Local Mass Matrix Derivation**\nFirst, we compute the mass matrix for a single element of length $h$. Let the element be $[0, h]$. The local linear basis functions (shape functions) are $\\psi_1(\\xi) = 1 - \\xi/h$ and $\\psi_2(\\xi) = \\xi/h$. The entries of the local mass matrix $\\boldsymbol{M}^e$ are $M^e_{ab} = \\int_0^h \\psi_a(\\xi) \\psi_b(\\xi) \\,d\\xi$.\nThe integrals are:\n$M^e_{11} = \\int_0^h (1 - \\xi/h)^2 \\,d\\xi = h \\int_0^1 (1-u)^2 \\,du = h/3$.\n$M^e_{22} = \\int_0^h (\\xi/h)^2 \\,d\\xi = h \\int_0^1 u^2 \\,du = h/3$.\n$M^e_{12} = M^e_{21} = \\int_0^h (1 - \\xi/h)(\\xi/h) \\,d\\xi = h \\int_0^1 u(1-u) \\,du = h(1/2 - 1/3) = h/6$.\nThus, the local mass matrix is:\n$$ \\boldsymbol{M}^e = \\frac{h}{6} \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix} $$\n\n**Step 2: Global Mass Matrix Assembly and Structure**\nWe assemble the global mass matrix $\\boldsymbol{M}$ from the local contributions. Due to the uniform periodic mesh, $\\boldsymbol{M}$ is a symmetric circulant matrix.\nThe diagonal entry $M_{ii}$ gets contributions from the two elements adjacent to node $i$, namely $[x_{i-1}, x_i]$ and $[x_i, x_{i+1}]$. On element $[x_{i-1}, x_i]$, the basis function $\\phi_i$ corresponds to the local shape function $\\psi_2$, contributing $M^e_{22} = h/3$. On element $[x_i, x_{i+1}]$, $\\phi_i$ corresponds to $\\psi_1$, contributing $M^e_{11} = h/3$. Thus, $M_{ii} = h/3 + h/3 = 2h/3$.\nThe off-diagonal entry $M_{i, i+1}$ (and by symmetry $M_{i+1, i}$) gets a contribution only from the element $[x_i, x_{i+1}]$, where $\\phi_i$ and $\\phi_{i+1}$ overlap. This corresponds to the off-diagonal entry of the local matrix, $M^e_{12} = h/6$.\nDue to periodicity, $M_{0, N-1} = M_{N-1, 0} = h/6$.\nThe global mass matrix $\\boldsymbol{M}$ is therefore a symmetric circulant matrix with the first row $(\\frac{2h}{3}, \\frac{h}{6}, 0, \\dots, 0, \\frac{h}{6})$. It can be compactly described by the stencil $\\frac{h}{6}[1, 4, 1]$, since $M_{ii} = 4h/6 = 2h/3$ and $M_{i,i\\pm 1} = h/6$.\n\n**Step 3: Eigenpairs of the Mass Matrix**\nThe eigenvectors of any $N \\times N$ circulant matrix are the discrete Fourier modes. For a wavenumber $m \\in \\{0, 1, \\dots, N-1\\}$, the corresponding eigenvector $\\mathbf{u}_m$ has components $(\\mathbf{u}_m)_j = \\exp(i j \\theta)$ for $j \\in \\{0, 1, \\dots, N-1\\}$, where $\\theta = 2\\pi m / N$.\nTo find the eigenvalue $\\lambda(\\theta)$ associated with this eigenvector, we apply the matrix to it:\n$$ (\\boldsymbol{M} \\mathbf{u}_m)_j = M_{j,j-1} (\\mathbf{u}_m)_{j-1} + M_{jj} (\\mathbf{u}_m)_j + M_{j,j+1} (\\mathbf{u}_m)_{j+1} $$\n$$ (\\boldsymbol{M} \\mathbf{u}_m)_j = \\frac{h}{6} e^{i(j-1)\\theta} + \\frac{4h}{6} e^{ij\\theta} + \\frac{h}{6} e^{i(j+1)\\theta} $$\nFactoring out $e^{ij\\theta} = (\\mathbf{u}_m)_j$:\n$$ (\\boldsymbol{M} \\mathbf{u}_m)_j = e^{ij\\theta} \\left( \\frac{h}{6} e^{-i\\theta} + \\frac{4h}{6} + \\frac{h}{6} e^{i\\theta} \\right) $$\nThe term in the parenthesis is the eigenvalue $\\lambda(\\theta)$:\n$$ \\lambda(\\theta) = \\frac{h}{6} \\left( 4 + (e^{i\\theta} + e^{-i\\theta}) \\right) = \\frac{h}{6} (4 + 2\\cos\\theta) = \\frac{h}{3}(2 + \\cos\\theta) $$\n\n**Step 4: Amplification Factor of the Spectral Filter**\nThe spectral filter is given by $\\boldsymbol{F}_{\\beta} = \\exp(-\\beta \\boldsymbol{M})$. The action of a matrix function $f(\\boldsymbol{A})$ on an eigenvector $\\mathbf{v}$ of $\\boldsymbol{A}$ with eigenvalue $\\lambda$ is $f(\\boldsymbol{A})\\mathbf{v} = f(\\lambda)\\mathbf{v}$.\nHere, $f(x) = \\exp(-\\beta x)$. Therefore, the filter $\\boldsymbol{F}_{\\beta}$ acts on the eigenvector $\\mathbf{u}_m$ by scaling it with an amplification factor (gain) $G(\\theta)$:\n$$ G(\\theta) = \\exp(-\\beta \\lambda(\\theta)) $$\nSubstituting the expression for the eigenvalue $\\lambda(\\theta)$:\n$$ G(\\theta) = \\exp\\left(-\\beta \\left[ \\frac{h}{3}(2 + \\cos\\theta) \\right]\\right) = \\exp\\left(-\\frac{\\beta h}{3}(2 + \\cos\\theta)\\right) $$\nThis is the required closed-form analytic expression for the amplification factor.",
            "answer": "$$\\boxed{\\exp\\left(-\\frac{\\beta h}{3}\\left(2 + \\cos(\\theta)\\right)\\right)}$$"
        }
    ]
}