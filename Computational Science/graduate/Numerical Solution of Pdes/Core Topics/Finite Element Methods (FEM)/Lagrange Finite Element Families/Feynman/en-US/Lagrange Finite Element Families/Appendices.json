{
    "hands_on_practices": [
        {
            "introduction": "The power of the finite element method rests on the systematic construction of polynomial basis functions on simple reference shapes. This exercise provides foundational practice by guiding you through the derivation of a high-order basis function, starting from the elegant framework of barycentric coordinates. By explicitly constructing a cubic Lagrange basis function on a triangle, you will solidify your understanding of the core principles of nodal interpolation and the transformation between barycentric and Cartesian coordinate systems .",
            "id": "3413665",
            "problem": "Consider the triangular finite element $T \\subset \\mathbb{R}^{2}$ with vertices $\\boldsymbol{v}_{1}=(0,0)$, $\\boldsymbol{v}_{2}=(2,1)$, and $\\boldsymbol{v}_{3}=(1,3)$, used in the standard Lagrange finite element family for discretizing Partial Differential Equations (PDE). Let $\\lambda_{1}$, $\\lambda_{2}$, and $\\lambda_{3}$ denote the barycentric (area) coordinates on $T$, defined by the relations $\\boldsymbol{x}=\\lambda_{1}\\boldsymbol{v}_{1}+\\lambda_{2}\\boldsymbol{v}_{2}+\\lambda_{3}\\boldsymbol{v}_{3}$ and $\\lambda_{1}+\\lambda_{2}+\\lambda_{3}=1$, where $\\boldsymbol{x}=(x,y)\\in T$.\n\nFor the degree-three Lagrange finite element on $T$, the nodal set consists of the three vertices, the six interior edge points corresponding to barycentric pairs $(\\frac{1}{3},\\frac{2}{3})$ and $(\\frac{2}{3},\\frac{1}{3})$ on each edge, and a single interior point with barycentric coordinates $(\\frac{1}{3},\\frac{1}{3},\\frac{1}{3})$. Starting only from the definitions of barycentric coordinates on a simplex and the defining properties of nodal Lagrange interpolation (i.e., a basis function equals $1$ at its associated node and $0$ at all other nodes), derive the unique polynomial $\\varphi_{\\mathrm{int}}\\in \\mathbb{P}_{3}(T)$ (the space of bivariate polynomials of total degree at most $3$ on $T$) that is the nodal basis function associated with the interior node $(\\frac{1}{3},\\frac{1}{3},\\frac{1}{3})$, and express $\\varphi_{\\mathrm{int}}$ explicitly as a single closed-form polynomial in the Cartesian coordinates $(x,y)$.\n\nYour final answer must be a single closed-form analytic expression in $(x,y)$. No rounding is required.",
            "solution": "The problem as stated is scientifically grounded, well-posed, and objective. It represents a standard exercise in the theory of the finite element method. A unique solution exists and can be derived from the provided definitions and conditions.\n\nThe task is to find the nodal basis function $\\varphi_{\\mathrm{int}} \\in \\mathbb{P}_{3}(T)$ associated with the interior node of a cubic Lagrange triangular element. $\\mathbb{P}_{3}(T)$ is the space of bivariate polynomials of total degree at most $3$. The defining property of a nodal basis function is that it equals $1$ at its associated node and $0$ at all other nodes in the nodal set.\n\n**Step 1: Construct the basis function in barycentric coordinates.**\nThe barycentric coordinates $(\\lambda_{1}, \\lambda_{2}, \\lambda_{3})$ are linear functions of the Cartesian coordinates $(x,y)$. A polynomial of degree $k$ in $(\\lambda_1, \\lambda_2, \\lambda_3)$ corresponds to a polynomial of degree $k$ in $(x,y)$, given the constraint $\\lambda_1 + \\lambda_2 + \\lambda_3 = 1$.\n\nThe nodal set for a degree-$3$ Lagrange element consists of $10$ points. These nodes have barycentric coordinates $(\\lambda_1, \\lambda_2, \\lambda_3) = (\\frac{i}{3}, \\frac{j}{3}, \\frac{k}{3})$ where $i,j,k$ are non-negative integers such that $i+j+k=3$.\nThe problem specifies the nodes as:\n- The $3$ vertices: $(1,0,0)$, $(0,1,0)$, $(0,0,1)$.\n- The $6$ edge points: $(\\frac{2}{3}, \\frac{1}{3}, 0)$, $(\\frac{1}{3}, \\frac{2}{3}, 0)$, $(0, \\frac{2}{3}, \\frac{1}{3})$, $(0, \\frac{1}{3}, \\frac{2}{3})$, $(\\frac{1}{3}, 0, \\frac{2}{3})$, $(\\frac{2}{3}, 0, \\frac{1}{3})$.\n- The $1$ interior point: $(\\frac{1}{3}, \\frac{1}{3}, \\frac{1}{3})$.\n\nThe basis function $\\varphi_{\\mathrm{int}}$ must be equal to $0$ at all nodes except for the interior node $(\\frac{1}{3}, \\frac{1}{3}, \\frac{1}{3})$. Notice that all $9$ of these other nodes lie on the boundary of the triangle $T$. The boundary of $T$ is defined by the lines where at least one barycentric coordinate is zero, i.e., the set of points where $\\lambda_{1}\\lambda_{2}\\lambda_{3} = 0$.\n\nSince $\\varphi_{\\mathrm{int}}$ is a polynomial that vanishes on the set where $\\lambda_{1}\\lambda_{2}\\lambda_{3} = 0$, it must be divisible by the polynomial $\\lambda_{1}\\lambda_{2}\\lambda_{3}$. Thus, $\\varphi_{\\mathrm{int}}$ can be written in the form:\n$$ \\varphi_{\\mathrm{int}}(\\lambda_{1}, \\lambda_{2}, \\lambda_{3}) = C \\cdot \\lambda_{1} \\lambda_{2} \\lambda_{3} $$\nfor some constant $C$. The product $\\lambda_{1}\\lambda_{2}\\lambda_{3}$ is a polynomial of degree $3$. Since $\\varphi_{\\mathrm{int}} \\in \\mathbb{P}_{3}(T)$, the factor $C$ must be a constant (a polynomial of degree $0$).\n\nTo determine the constant $C$, we use the condition that $\\varphi_{\\mathrm{int}}=1$ at its associated node, which is the interior node with barycentric coordinates $(\\frac{1}{3}, \\frac{1}{3}, \\frac{1}{3})$.\n$$ \\varphi_{\\mathrm{int}}\\left(\\frac{1}{3}, \\frac{1}{3}, \\frac{1}{3}\\right) = C \\cdot \\left(\\frac{1}{3}\\right) \\cdot \\left(\\frac{1}{3}\\right) \\cdot \\left(\\frac{1}{3}\\right) = 1 $$\n$$ C \\cdot \\frac{1}{27} = 1 \\implies C = 27 $$\nTherefore, the basis function in barycentric coordinates is:\n$$ \\varphi_{\\mathrm{int}}(\\lambda_{1}, \\lambda_{2}, \\lambda_{3}) = 27 \\lambda_{1} \\lambda_{2} \\lambda_{3} $$\n\n**Step 2: Convert barycentric coordinates to Cartesian coordinates.**\nThe relationship between a point $\\boldsymbol{x}=(x,y)$ and its barycentric coordinates $(\\lambda_1, \\lambda_2, \\lambda_3)$ with respect to the vertices $\\boldsymbol{v}_{1}=(0,0)$, $\\boldsymbol{v}_{2}=(2,1)$, and $\\boldsymbol{v}_{3}=(1,3)$ is given by:\n$$ \\boldsymbol{x} = \\lambda_{1}\\boldsymbol{v}_{1} + \\lambda_{2}\\boldsymbol{v}_{2} + \\lambda_{3}\\boldsymbol{v}_{3} $$\n$$ \\lambda_1 + \\lambda_2 + \\lambda_3 = 1 $$\nSubstituting the vertex coordinates:\n$$ \\begin{pmatrix} x \\\\ y \\end{pmatrix} = \\lambda_1 \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} + \\lambda_2 \\begin{pmatrix} 2 \\\\ 1 \\end{pmatrix} + \\lambda_3 \\begin{pmatrix} 1 \\\\ 3 \\end{pmatrix} $$\nThis yields a system of two equations for $\\lambda_2$ and $\\lambda_3$:\n$$ x = 2\\lambda_2 + \\lambda_3 $$\n$$ y = \\lambda_2 + 3\\lambda_3 $$\nWe solve this system. From the second equation, $\\lambda_2 = y - 3\\lambda_3$. Substituting this into the first equation:\n$$ x = 2(y - 3\\lambda_3) + \\lambda_3 = 2y - 6\\lambda_3 + \\lambda_3 = 2y - 5\\lambda_3 $$\n$$ 5\\lambda_3 = 2y - x \\implies \\lambda_3(x,y) = \\frac{1}{5}(2y-x) $$\nNow we find $\\lambda_2$:\n$$ \\lambda_2 = y - 3\\left(\\frac{1}{5}(2y-x)\\right) = y - \\frac{6}{5}y + \\frac{3}{5}x = \\frac{5y-6y}{5} + \\frac{3x}{5} = \\frac{3x-y}{5} $$\nSo, $\\lambda_2(x,y) = \\frac{1}{5}(3x-y)$.\nFinally, we find $\\lambda_1$ using $\\lambda_1 = 1-\\lambda_2-\\lambda_3$:\n$$ \\lambda_1 = 1 - \\frac{1}{5}(3x-y) - \\frac{1}{5}(2y-x) = \\frac{1}{5}(5 - (3x-y) - (2y-x)) $$\n$$ \\lambda_1 = \\frac{1}{5}(5 - 3x + y - 2y + x) = \\frac{1}{5}(5 - 2x - y) $$\nSo, the coordinate transformation is:\n$$ \\lambda_{1}(x,y) = \\frac{1}{5}(5 - 2x - y) $$\n$$ \\lambda_{2}(x,y) = \\frac{1}{5}(3x - y) $$\n$$ \\lambda_{3}(x,y) = \\frac{1}{5}(2y - x) $$\n\n**Step 3: Express $\\varphi_{\\mathrm{int}}$ as a polynomial in $(x,y)$.**\nWe substitute the expressions for $\\lambda_1$, $\\lambda_2$, and $\\lambda_3$ into the barycentric form of $\\varphi_{\\mathrm{int}}$:\n$$ \\varphi_{\\mathrm{int}}(x,y) = 27 \\left( \\frac{1}{5}(5 - 2x - y) \\right) \\left( \\frac{1}{5}(3x - y) \\right) \\left( \\frac{1}{5}(2y - x) \\right) $$\n$$ \\varphi_{\\mathrm{int}}(x,y) = \\frac{27}{125} (5 - 2x - y)(3x - y)(2y - x) $$\nNow, we expand the product of the three linear factors. First, we multiply the last two factors:\n$$ (3x - y)(2y - x) = 6xy - 3x^2 - 2y^2 + xy = -3x^2 + 7xy - 2y^2 $$\nNext, we multiply this result by the first factor, $(5 - 2x - y)$:\n$$ (5 - 2x - y)(-3x^2 + 7xy - 2y^2) = 5(-3x^2 + 7xy - 2y^2) - 2x(-3x^2 + 7xy - 2y^2) - y(-3x^2 + 7xy - 2y^2) $$\n$$ = (-15x^2 + 35xy - 10y^2) + (6x^3 - 14x^2y + 4xy^2) + (3x^2y - 7xy^2 + 2y^3) $$\nWe collect terms by degree and lexicographical order:\n- Cubic terms ($x^3, x^2y, xy^2, y^3$): $6x^3 + (-14+3)x^2y + (4-7)xy^2 + 2y^3 = 6x^3 - 11x^2y - 3xy^2 + 2y^3$\n- Quadratic terms ($x^2, xy, y^2$): $-15x^2 + 35xy - 10y^2$\n- Linear and constant terms: There are none.\n\nCombining all terms, the expanded polynomial is:\n$$ 6x^3 - 11x^2y - 3xy^2 + 2y^3 - 15x^2 + 35xy - 10y^2 $$\nFinally, we multiply by the constant factor $\\frac{27}{125}$ to obtain the expression for $\\varphi_{\\mathrm{int}}(x,y)$.\n\n$$ \\varphi_{\\mathrm{int}}(x,y) = \\frac{27}{125}(6x^3 - 11x^2y - 3xy^2 + 2y^3 - 15x^2 + 35xy - 10y^2) $$\nThis is the unique polynomial in $\\mathbb{P}_{3}(T)$ satisfying the required nodal properties.",
            "answer": "$$\n\\boxed{\\frac{27}{125}(6x^3 - 11x^2y - 3xy^2 + 2y^3 - 15x^2 + 35xy - 10y^2)}\n$$"
        },
        {
            "introduction": "Real-world problems often involve complex geometries that cannot be meshed perfectly with straight-sided elements. This practice explores the isoparametric mapping, a powerful technique for mapping reference elements to curved physical elements, and critically examines its impact on numerical stability. By analyzing the interpolation operator and deriving a stability constant, you will gain a deep, quantitative understanding of how element distortion affects the quality of the finite element solution .",
            "id": "3413676",
            "problem": "Consider the reference two-dimensional simplex (reference triangle) $\\hat{T}$ with vertices at $(0,0)$, $(1,0)$, and $(0,1)$. Let $\\lambda_{1}$, $\\lambda_{2}$, and $\\lambda_{3}$ denote the barycentric coordinates on $\\hat{T}$, so that $\\lambda_{1} + \\lambda_{2} + \\lambda_{3} = 1$ and each $\\lambda_{i} \\geq 0$ on $\\hat{T}$. The Lagrange polynomial family of degree $k=2$ (denoted $P_{2}$) has the nodal set consisting of the three vertices and the three edge midpoints. \n\n1) Using only the defining properties of barycentric coordinates and Lagrange interpolation (Kronecker-delta nodal conditions and polynomial degree constraints), construct explicit formulas for:\n- the quadratic Lagrange basis function associated with vertex $1$ (the node where $\\lambda_{1}=1$ and $\\lambda_{2}=\\lambda_{3}=0$), and\n- the quadratic Lagrange basis function associated with the edge midpoint on the edge connecting vertices $1$ and $2$ (the node where $\\lambda_{1}=\\lambda_{2}=\\frac{1}{2}$ and $\\lambda_{3}=0$).\n\n2) Consider a curved physical triangular element $E \\subset \\mathbb{R}^{2}$ obtained via a degree-$2$ isoparametric mapping $F:\\hat{T}\\to E$ constructed with the same $P_{2}$ basis functions, that is, $F(\\hat{x})=\\sum_{a=1}^{6} N_{a}(\\hat{x}) X_{a}$, where $N_{a}$ are the quadratic Lagrange basis functions on $\\hat{T}$ and $X_{a}\\in \\mathbb{R}^{2}$ are the corresponding geometric control points. Let $A(\\hat{x})=\\nabla F(\\hat{x})$ be the Jacobian matrix, and let $J(\\hat{x})=\\det A(\\hat{x})$ denote the Jacobian determinant. For each $\\hat{x}\\in \\hat{T}$, denote by $s_{\\min}(A(\\hat{x}))$ and $s_{\\max}(A(\\hat{x}))$ the smallest and largest singular values of $A(\\hat{x})$, respectively. Assume $F$ is injective on $\\hat{T}$, $A(\\hat{x})$ is nonsingular for all $\\hat{x}\\in \\hat{T}$, and the orientation is preserved, i.e., $J(\\hat{x})>0$ for all $\\hat{x}\\in \\hat{T}$. Define the extrema\n$$\nJ_{-}=\\inf_{\\hat{x}\\in \\hat{T}} J(\\hat{x}),\\quad J_{+}=\\sup_{\\hat{x}\\in \\hat{T}} J(\\hat{x}),\\quad s_{-}=\\inf_{\\hat{x}\\in \\hat{T}} s_{\\min}(A(\\hat{x})),\\quad s_{+}=\\sup_{\\hat{x}\\in \\hat{T}} s_{\\max}(A(\\hat{x})).\n$$\nLet $I_{2}^{\\hat{T}}$ denote the $P_{2}$ nodal interpolation operator on $\\hat{T}$ and $I_{2}^{E}$ the corresponding $P_{2}$ nodal interpolation operator on $E$ defined by pullback through $F$. Using only the chain rule, change-of-variables, and norm equivalence induced by $F$, derive the explicit expression for the least constant $C_{\\mathrm{stab}}$ (depending only on $J_{-}$, $J_{+}$, $s_{-}$, $s_{+}$, and the $H^{1}$-stability constant $C_{\\mathrm{ref}}$ of $I_{2}^{\\hat{T}}$) such that for all $u\\in H^{1}(E)$,\n$$\n|I_{2}^{E} u|_{H^{1}(E)} \\leq C_{\\mathrm{stab}}\\, |u|_{H^{1}(E)}.\n$$\nDiscuss how the sign of $J(\\hat{x})$ and distortion (large variation in $s_{\\min}$, $s_{\\max}$, and $J$) affect the stability, but express your final $C_{\\mathrm{stab}}$ as a single closed-form analytic expression in terms of $C_{\\mathrm{ref}}$, $J_{-}$, $J_{+}$, $s_{-}$, and $s_{+}$.\n\nProvide your final answer as a single row vector containing:\n- the vertex-$1$ basis function,\n- the edge $(1,2)$ midpoint basis function, and\n- the stability constant $C_{\\mathrm{stab}}$.\n\nNo rounding is required, and no units should be included. Your final answer must be a single closed-form analytic expression as specified.",
            "solution": "The problem is evaluated as valid, as it is scientifically grounded in the theory of the finite element method, well-posed, and objective. It contains all necessary information and definitions for a rigorous solution.\n\nThe problem consists of two parts. The first part asks for the construction of two specific quadratic Lagrange basis functions on a reference triangle. The second part requires the derivation of an interpolation stability constant for an isoparametric element.\n\n**Part 1: Construction of Lagrange Basis Functions**\n\nThe reference triangle $\\hat{T}$ has vertices at $(0,0)$, $(1,0)$, and $(0,1)$. The barycentric coordinates $(\\lambda_1, \\lambda_2, \\lambda_3)$ of a point $\\hat{x}=(x, y) \\in \\hat{T}$ are defined by $\\hat{x} = \\lambda_1 (0,0) + \\lambda_2(1,0) + \\lambda_3(0,1)$, which gives $(x,y) = (\\lambda_2, \\lambda_3)$. Along with the property $\\lambda_1 + \\lambda_2 + \\lambda_3 = 1$, we have the explicit relations $\\lambda_2=x$, $\\lambda_3=y$, and $\\lambda_1 = 1-x-y$.\n\nThe nodal set for the quadratic ($P_2$) Lagrange family consists of the three vertices and the three edge midpoints. The barycentric coordinates of these six nodes are:\n- Vertex 1 ($V_1$): $n_1 = (1,0,0)$\n- Vertex 2 ($V_2$): $n_2 = (0,1,0)$\n- Vertex 3 ($V_3$): $n_3 = (0,0,1)$\n- Midpoint of edge 1-2: $n_4 = (1/2, 1/2, 0)$\n- Midpoint of edge 2-3: $n_5 = (0, 1/2, 1/2)$\n- Midpoint of edge 1-3: $n_6 = (1/2, 0, 1/2)$\n\nA Lagrange basis function $N_i$ associated with node $n_i$ is a polynomial of degree $k=2$ that satisfies the Kronecker-delta property: $N_i(n_j) = \\delta_{ij}$, where $\\delta_{ij}$ is $1$ if $i=j$ and $0$ if $i \\neq j$.\n\n**Basis function associated with vertex 1 ($N_1$)**\nThis function, denoted $N_1$, must be a quadratic polynomial satisfying $N_1(n_1) = 1$ and $N_1(n_j) = 0$ for $j \\in \\{2, 3, 4, 5, 6\\}$. To construct such a polynomial, we identify lines that pass through the nodes where $N_1$ must be zero.\n- The nodes $n_2, n_3, n_5$ all lie on the line defined by the equation $\\lambda_1 = 0$.\n- The nodes $n_4, n_6$ all lie on the line defined by the equation $\\lambda_1 = 1/2$.\nA polynomial that is zero at these five nodes can be formed by the product of the linear expressions defining these two lines:\n$$P(\\lambda_1,\\lambda_2,\\lambda_3) = C \\cdot \\lambda_1 \\cdot \\left(\\lambda_1 - \\frac{1}{2}\\right)$$\nThis is a polynomial of degree $2$. The constant $C$ is determined by the condition $N_1(n_1)=1$. At node $n_1$, we have $(\\lambda_1, \\lambda_2, \\lambda_3) = (1,0,0)$.\n$$P(n_1) = C \\cdot 1 \\cdot \\left(1 - \\frac{1}{2}\\right) = \\frac{C}{2}$$\nSetting $P(n_1)=1$ gives $C=2$. Therefore, the basis function is:\n$$N_1 = 2\\lambda_1\\left(\\lambda_1 - \\frac{1}{2}\\right) = \\lambda_1(2\\lambda_1 - 1)$$\n\n**Basis function associated with the edge 1-2 midpoint ($N_4$)**\nThis function, $N_4$, is associated with node $n_4=(1/2, 1/2, 0)$ and must satisfy $N_4(n_4)=1$ and $N_4(n_j)=0$ for $j \\in \\{1, 2, 3, 5, 6\\}$. We again find lines passing through the zero nodes.\n- The nodes $n_2, n_3, n_5$ all lie on the line $\\lambda_1 = 0$.\n- The nodes $n_1, n_3, n_6$ all lie on the line $\\lambda_2 = 0$.\nA quadratic polynomial that is zero at these five nodes can be formed by the product:\n$$P(\\lambda_1,\\lambda_2,\\lambda_3) = C \\cdot \\lambda_1 \\cdot \\lambda_2$$\nThe constant $C$ is determined by the condition $N_4(n_4)=1$. At node $n_4$, we have $(\\lambda_1, \\lambda_2, \\lambda_3) = (1/2, 1/2, 0)$.\n$$P(n_4) = C \\cdot \\frac{1}{2} \\cdot \\frac{1}{2} = \\frac{C}{4}$$\nSetting $P(n_4)=1$ gives $C=4$. Therefore, the basis function is:\n$$N_4 = 4\\lambda_1\\lambda_2$$\n\n**Part 2: Derivation of the Stability Constant**\n\nLet $u \\in H^1(E)$. Its pullback to the reference element is $\\hat{u}(\\hat{x}) = u(F(\\hat{x}))$. The interpolation operators are related by $(I_2^E u) \\circ F = I_2^{\\hat{T}} \\hat{u}$. We want to find the smallest constant $C_{\\mathrm{stab}}$ such that $|I_2^E u|_{H^1(E)} \\leq C_{\\mathrm{stab}} |u|_{H^1(E)}$. The $H^1$-seminorm is given by $|v|_{H^1(\\Omega)}^2 = \\int_\\Omega |\\nabla v|^2 dV$.\n\nWe relate the gradients on $E$ and $\\hat{T}$. For any function $\\hat{v}(\\hat{x}) = v(F(\\hat{x}))$, the chain rule gives $\\nabla_{\\hat{x}}\\hat{v} = (\\nabla_{\\hat{x}}F)^T \\nabla_x v = A^T \\nabla_x v$. Hence, $\\nabla_x v = (A^T)^{-1} \\nabla_{\\hat{x}}\\hat{v}$. The change of variables for integration is $dx = J(\\hat{x}) d\\hat{x}$.\n\nFirst, let's express the seminorm of the interpolated function on $E$:\n$$|I_2^E u|_{H^1(E)}^2 = \\int_E |\\nabla_x (I_2^E u)|^2 dx = \\int_{\\hat{T}} |\\nabla_x ((I_2^E u)\\circ F)|^2 J(\\hat{x}) d\\hat{x}$$\nUsing the gradient relationship with $\\hat{v} = (I_2^E u)\\circ F = I_2^{\\hat{T}} \\hat{u}$:\n$$|I_2^E u|_{H^1(E)}^2 = \\int_{\\hat{T}} |(A^T)^{-1} \\nabla_{\\hat{x}} (I_2^{\\hat{T}}\\hat{u})|^2 J(\\hat{x}) d\\hat{x}$$\nThe squared Euclidean norm of the vector $(A^T)^{-1}w$ is bounded by the squared operator norm of the matrix times $|w|^2$: $|(A^T)^{-1}w|^2 \\leq \\|(A^T)^{-1}\\|^2 |w|^2$. The operator norm of a matrix is its largest singular value. The singular values of $(A^T)^{-1}$ are the reciprocals of those of $A$, so $\\|(A^T)^{-1}\\| = 1/s_{\\min}(A)$.\n$$|I_2^E u|_{H^1(E)}^2 \\leq \\int_{\\hat{T}} \\frac{1}{s_{\\min}(A(\\hat{x}))^2} |\\nabla_{\\hat{x}}(I_2^{\\hat{T}}\\hat{u})|^2 J(\\hat{x}) d\\hat{x}$$\nBounding the terms by their suprema, $J(\\hat{x}) \\leq J_+$ and $1/s_{\\min}(A(\\hat{x})) \\leq 1/s_{-}$:\n$$|I_2^E u|_{H^1(E)}^2 \\leq \\frac{J_{+}}{s_{-}^2} \\int_{\\hat{T}} |\\nabla_{\\hat{x}}(I_2^{\\hat{T}}\\hat{u})|^2 d\\hat{x} = \\frac{J_{+}}{s_{-}^2} |I_2^{\\hat{T}}\\hat{u}|_{H^1(\\hat{T})}^2$$\nUsing the given stability of the reference interpolant, $|I_2^{\\hat{T}}\\hat{u}|_{H^1(\\hat{T})} \\leq C_{\\mathrm{ref}} |\\hat{u}|_{H^1(\\hat{T})}$, we get:\n$$|I_2^E u|_{H^1(E)}^2 \\leq C_{\\mathrm{ref}}^2 \\frac{J_{+}}{s_{-}^2} |\\hat{u}|_{H^1(\\hat{T})}^2$$\n\nNext, we relate $|\\hat{u}|_{H^1(\\hat{T})}^2$ to $|u|_{H^1(E)}^2$. We start with the definition of $|u|_{H^1(E)}^2$:\n$$|u|_{H^1(E)}^2 = \\int_E |\\nabla_x u|^2 dx = \\int_{\\hat{T}} |(A^T)^{-1} \\nabla_{\\hat{x}}\\hat{u}|^2 J(\\hat{x}) d\\hat{x}$$\nTo obtain a lower bound, we use the property that for any vector $w$, $|Mw|^2 \\geq (\\sigma_{\\min}(M))^2 |w|^2$, where $\\sigma_{\\min}(M)$ is the smallest singular value of $M$. The smallest singular value of $(A^T)^{-1}$ is $1/s_{\\max}(A)$.\n$$|(A^T)^{-1} \\nabla_{\\hat{x}}\\hat{u}|^2 \\geq \\frac{1}{s_{\\max}(A(\\hat{x}))^2} |\\nabla_{\\hat{x}}\\hat{u}|^2$$\nSubstituting this into the integral and bounding terms by their infima, $J(\\hat{x}) \\geq J_{-}$ and $1/s_{\\max}(A(\\hat{x})) \\geq 1/s_{+}$:\n$$|u|_{H^1(E)}^2 \\geq \\int_{\\hat{T}} \\frac{J(\\hat{x})}{s_{\\max}(A(\\hat{x}))^2} |\\nabla_{\\hat{x}}\\hat{u}|^2 d\\hat{x} \\geq \\frac{J_{-}}{s_{+}^2} \\int_{\\hat{T}} |\\nabla_{\\hat{x}}\\hat{u}|^2 d\\hat{x} = \\frac{J_{-}}{s_{+}^2} |\\hat{u}|_{H^1(\\hat{T})}^2$$\nRearranging this inequality gives an upper bound for $|\\hat{u}|_{H^1(\\hat{T})}^2$:\n$$|\\hat{u}|_{H^1(\\hat{T})}^2 \\leq \\frac{s_{+}^2}{J_{-}} |u|_{H^1(E)}^2$$\n\nFinally, substituting this result back into the inequality for $|I_2^E u|_{H^1(E)}^2$:\n$$|I_2^E u|_{H^1(E)}^2 \\leq C_{\\mathrm{ref}}^2 \\frac{J_{+}}{s_{-}^2} \\left( \\frac{s_{+}^2}{J_{-}} |u|_{H^1(E)}^2 \\right) = C_{\\mathrm{ref}}^2 \\frac{J_{+} s_{+}^2}{J_{-} s_{-}^2} |u|_{H^1(E)}^2$$\nTaking the square root of both sides yields the stability inequality:\n$$|I_2^E u|_{H^1(E)} \\leq \\left( C_{\\mathrm{ref}} \\frac{s_{+}}{s_{-}} \\sqrt{\\frac{J_{+}}{J_{-}}} \\right) |u|_{H^1(E)}$$\nThe stability constant is therefore $C_{\\mathrm{stab}} = C_{\\mathrm{ref}} \\frac{s_{+}}{s_{-}} \\sqrt{\\frac{J_{+}}{J_{-}}}$.\n\nThe assumption $J(\\hat{x})>0$ is critical. If $J(\\hat{x})$ were to change sign or be zero, $J_{-}$ could be zero or negative, causing $C_{\\mathrm{stab}}$ to become infinite or ill-defined. This reflects a loss of stability for degenerate or inverted elements. The distortion of the element from the reference shape is captured by the ratios $\\frac{s_{+}}{s_{-}}$ and $\\frac{J_{+}}{J_{-}}$. An ideal (affine) mapping has constant $A$ and $J$, so these ratios are $1$. Large ratios, indicating significant stretching, shearing, or size variation, directly increase $C_{\\mathrm{stab}}$, degrading the stability of the interpolation.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\lambda_{1}(2\\lambda_{1}-1) & 4\\lambda_{1}\\lambda_{2} & C_{\\mathrm{ref}} \\frac{s_{+}}{s_{-}} \\sqrt{\\frac{J_{+}}{J_{-}}}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "While single-element analysis is crucial, the ultimate behavior of the finite element method is determined by the properties of the global system assembled from all elements. This practice shifts focus to the spectral analysis of the global mass matrix, which is fundamental for understanding time-dependent simulations and the performance of iterative solvers. By analyzing a uniform periodic mesh, you will connect the discrete finite element operators to Fourier analysis and uncover the method's inherent wave-propagation characteristics .",
            "id": "3413679",
            "problem": "Consider a one-dimensional periodic domain $\\Omega = [0,L]$ with periodic boundary conditions, partitioned into a uniform mesh of $N$ elements of length $h = L/N$. Let $\\{\\phi_{i}\\}_{i=0}^{N-1}$ denote the standard nodal hat functions of the Lagrange family of order one ($P_{1}$) on this mesh, forming a basis of the finite element space of continuous, piecewise linear functions with periodicity $\\phi_{i+N} = \\phi_{i}$. The consistent mass bilinear form is defined by $m(u,v) = \\int_{0}^{L} u(x) v(x) \\,\\mathrm{d}x$ and its matrix representation $\\boldsymbol{M} \\in \\mathbb{R}^{N \\times N}$ in the basis $\\{\\phi_{i}\\}$ has entries $M_{ij} = \\int_{0}^{L} \\phi_{i}(x) \\phi_{j}(x) \\,\\mathrm{d}x$.\n\nStarting from the fundamental definitions of the local shape functions on an element, derive the assembled global structure of $\\boldsymbol{M}$ on the periodic uniform mesh. Characterize the eigenpairs of $\\boldsymbol{M}$ by relating the eigenvectors to discrete Fourier patterns obtained from the Discrete Fourier Transform (DFT). Then, consider the linear spectral filter defined by the matrix exponential $\\boldsymbol{F}_{\\beta} = \\exp(-\\beta \\boldsymbol{M})$ with a positive parameter $\\beta > 0$. For a DFT mode of wavenumber $m \\in \\{0,1,\\dots,N-1\\}$, parameterized by the angle $\\theta = \\frac{2\\pi m}{N}$, determine the exact amplification factor (gain) of $\\boldsymbol{F}_{\\beta}$ acting on this mode as a closed-form analytic expression in terms of $h$, $\\beta$, and $\\theta$.\n\nExpress your final answer as a single closed-form expression. No rounding is required.",
            "solution": "The problem requires the derivation of the amplification factor of the spectral filter $\\boldsymbol{F}_{\\beta} = \\exp(-\\beta \\boldsymbol{M})$. This involves finding the eigenvalues of the global mass matrix $\\boldsymbol{M}$ for $P_1$ elements on a periodic mesh.\n\n**Step 1: Local Mass Matrix**\nFirst, we compute the mass matrix on a reference element of length $h$, typically $[0, h]$. The linear nodal basis functions (shape functions) are $\\psi_1(\\xi) = 1 - \\xi/h$ and $\\psi_2(\\xi) = \\xi/h$ for $\\xi \\in [0, h]$. The local mass matrix $\\boldsymbol{M}^{e} \\in \\mathbb{R}^{2 \\times 2}$ has entries $M^{e}_{ab} = \\int_{0}^{h} \\psi_a(\\xi) \\psi_b(\\xi) \\,d\\xi$. The components are:\n$M^{e}_{11} = \\int_0^h (1 - \\xi/h)^2 \\,d\\xi = h \\int_0^1 (1-u)^2 \\,du = h/3$.\n$M^{e}_{22} = \\int_0^h (\\xi/h)^2 \\,d\\xi = h \\int_0^1 u^2 \\,du = h/3$.\n$M^{e}_{12} = M^{e}_{21} = \\int_0^h (1-\\xi/h)(\\xi/h) \\,d\\xi = h \\int_0^1 u(1-u) \\,du = h/6$.\n\nThe local mass matrix is:\n$$ \\boldsymbol{M}^{e} = \\frac{h}{6} \\begin{pmatrix} 2 & 1 \\\\ 1 & 2 \\end{pmatrix} $$\n\n**Step 2: Global Mass Matrix Assembly**\nThe global mass matrix $\\boldsymbol{M}$ is assembled by summing local contributions. For the nodal basis function $\\phi_i$ at node $x_i$, the diagonal entry $M_{ii} = \\int_0^L \\phi_i^2(x) \\,dx$ gets contributions from the two adjacent elements, $[x_{i-1}, x_i]$ and $[x_i, x_{i+1}]$. Thus, $M_{ii} = M^e_{22} + M^e_{11} = h/3 + h/3 = 2h/3$.\n\nThe off-diagonal entry $M_{i, i+1} = \\int_0^L \\phi_i(x) \\phi_{i+1}(x) \\,dx$ is non-zero only over the element $[x_i, x_{i+1}]$, corresponding to the local entry $M^e_{12} = h/6$. By symmetry, $M_{i, i-1} = h/6$.\n\nDue to periodic boundary conditions, indices are modulo $N$, so $M_{0, N-1} = M_{N-1, 0} = h/6$. The resulting global matrix $\\boldsymbol{M}$ is a symmetric circulant matrix defined by the stencil $\\frac{h}{6}(1, 4, 1)$. Its first row is $(\\frac{4h}{6}, \\frac{h}{6}, 0, \\dots, 0, \\frac{h}{6})$.\n\n**Step 3: Eigenvalues of the Global Mass Matrix**\nThe eigenvectors of an $N \\times N$ circulant matrix with first row $(c_0, c_1, \\dots, c_{N-1})$ are the discrete Fourier vectors $\\mathbf{u}_m$, where $(\\mathbf{u}_m)_j = \\exp(ij\\theta)$ for $\\theta = \\frac{2\\pi m}{N}$ and wavenumber $m \\in \\{0, 1, \\dots, N-1\\}$. The corresponding eigenvalue $\\lambda_m$ is the Discrete Fourier Transform of the first row: $\\lambda_m = \\sum_{k=0}^{N-1} c_k \\exp(ik\\theta)$.\n\nFor our mass matrix $\\boldsymbol{M}$, the non-zero coefficients are $c_0 = 4h/6 = 2h/3$, $c_1 = h/6$, and $c_{N-1} = h/6$. The eigenvalue $\\lambda(\\theta)$ for a mode with angle $\\theta$ is:\n$$ \\lambda(\\theta) = c_0 + c_1 e^{i\\theta} + c_{N-1} e^{i(N-1)\\theta} $$\nUsing $e^{i(N-1)\\theta} = e^{iN\\theta}e^{-i\\theta} = e^{i2\\pi m}e^{-i\\theta} = e^{-i\\theta}$, we get:\n$$ \\lambda(\\theta) = \\frac{2h}{3} + \\frac{h}{6} e^{i\\theta} + \\frac{h}{6} e^{-i\\theta} = \\frac{2h}{3} + \\frac{h}{6} (e^{i\\theta} + e^{-i\\theta}) $$\nUsing Euler's formula, $e^{i\\theta} + e^{-i\\theta} = 2\\cos(\\theta)$, the eigenvalue is:\n$$ \\lambda(\\theta) = \\frac{2h}{3} + \\frac{h}{3}\\cos(\\theta) = \\frac{h}{3}(2 + \\cos(\\theta)) $$\n\n**Step 4: Amplification Factor of the Spectral Filter**\nThe spectral filter is $\\boldsymbol{F}_{\\beta} = \\exp(-\\beta \\boldsymbol{M})$. The action of a matrix function on an eigenvector of $\\boldsymbol{M}$ results in the same eigenvector scaled by the function applied to the corresponding eigenvalue.\n$$ \\boldsymbol{F}_{\\beta} \\mathbf{u}_m = \\exp(-\\beta \\lambda(\\theta)) \\mathbf{u}_m $$\nThe amplification factor (gain) for the mode with angle $\\theta$ is this eigenvalue, $\\exp(-\\beta \\lambda(\\theta))$. Substituting the expression for $\\lambda(\\theta)$:\n$$ \\text{Gain}(\\theta) = \\exp\\left(-\\beta \\left[ \\frac{h}{3}(2 + \\cos(\\theta)) \\right] \\right) = \\exp\\left(-\\frac{\\beta h}{3}(2 + \\cos(\\theta))\\right) $$\nThis is the final closed-form expression for the amplification factor.",
            "answer": "$$\\boxed{\\exp\\left(-\\frac{\\beta h}{3}\\left(2 + \\cos(\\theta)\\right)\\right)}$$"
        }
    ]
}