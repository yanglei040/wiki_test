{
    "hands_on_practices": [
        {
            "introduction": "掌握高阶基函数的关键第一步是理解它们的构造方式。本练习将引导你回归第一性原理，通过求解一个范德蒙德矩阵系统来推导二次拉格朗日基函数。这个过程不仅能加深你对拉格朗日插值定义 $\\ell_i(x_j) = \\delta_{ij}$ 的理解，还能让你熟练掌握将抽象定义转化为具体多项式表达式的核心技能。",
            "id": "3359471",
            "problem": "在用于求解偏微分方程 (PDEs) 的有限元法 (FEM) 背景下，考虑参考区间 $[-1,1]$ 及其节点集 $\\{-1,0,1\\}$。二次 Lagrange 基函数 $\\{\\ell_{-1}(x), \\ell_{0}(x), \\ell_{1}(x)\\}$ 是次数至多为 $2$ 的空间中唯一的多项式，它们在节点 $x_{-1}=-1$、$x_{0}=0$ 和 $x_{1}=1$ 上满足节点 Kronecker-delta 条件 $\\ell_{i}(x_{j})=\\delta_{ij}$。请仅使用基本原理，即 Lagrange 节点基函数的定义以及通过单项式基 $\\{1,x,x^{2}\\}$ 构建并求逆相关的 Vandermonde 矩阵，通过对节点 $\\{-1,0,1\\}$ 的 $3\\times 3$ Vandermonde 矩阵求逆来推导这些多项式的系数向量，并以简化的标准多项式形式明确写出每个基多项式。请将最终答案以包含三个关于 $x$ 的多项式的单行矩阵形式给出。无需四舍五入。",
            "solution": "在尝试求解之前，对问题进行验证。\n\n### 第一步：提取已知条件\n- **定义域：** 参考区间为 $[-1,1]$。\n- **节点：** 节点集为 $\\{x_{-1}, x_{0}, x_{1}\\} = \\{-1, 0, 1\\}$。\n- **基函数：** 我们寻求二次 Lagrange 基函数 $\\{\\ell_{-1}(x), \\ell_{0}(x), \\ell_{1}(x)\\}$。\n- **多项式空间：** 基函数是次数至多为 $2$ 的多项式。\n- **定义属性：** 基函数必须在节点上满足 Kronecker-delta 条件：$\\ell_{i}(x_{j})=\\delta_{ij}$，其中 $i, j \\in \\{-1, 0, 1\\}$。\n- **方法：** 推导必须使用单项式基 $\\{1, x, x^2\\}$ 为给定节点构建 Vandermonde 矩阵，对此矩阵求逆，并使用逆矩阵找到基多项式的系数。\n- **输出：** 最终答案必须是以简化的标准形式明确给出的多项式，并以单行矩阵的形式呈现。\n\n### 第二步：使用提取的已知条件进行验证\n- **科学依据：** 该问题基于数值分析的基本、公认原理，特别是多项式插值理论和有限元法。Lagrange 基函数、单项式基和 Vandermonde 矩阵的概念在数学和工程学中都是标准内容。\n- **适定性：** 该问题是适定的。对于任意一组 $n+1$ 个不同的节点，存在一组唯一的次数至多为 $n$ 的 $n+1$ 个 Lagrange 基多项式。该问题提供了 $3$ 个不同的节点，要求唯一的二次（次数为 $2$）基，并指定了一种有效的构造方法。\n- **客观性：** 该问题以精确、客观的数学语言陈述，没有歧义或主观陈述。\n\n### 第三步：结论与行动\n该问题因其科学上合理、适定且客观而被视为**有效**。将遵循指定的方法推导求解。\n\n### 求解推导\n\n一个一般的二次多项式可以表示为单项式基 $\\{1, x, x^2\\}$ 的线性组合：\n$$p(x) = c_0 \\cdot 1 + c_1 \\cdot x + c_2 \\cdot x^2$$\n我们寻求三个这样的多项式 $\\ell_{-1}(x)$、$\\ell_{0}(x)$ 和 $\\ell_{1}(x)$，其系数向量分别为 $(c_{-1,0}, c_{-1,1}, c_{-1,2})$、$(c_{0,0}, c_{0,1}, c_{0,2})$ 和 $(c_{1,0}, c_{1,1}, c_{1,2})$。\n\nLagrange 基函数的定义属性是 $\\ell_{i}(x_j) = \\delta_{ij}$。对于一个一般的基函数 $\\ell_i(x) = c_{i0} + c_{i1}x + c_{i2}x^2$，在三个节点 $x_{-1}=-1$、$x_0=0$ 和 $x_1=1$ 上求值，为其三个系数得到一个三元线性方程组：\n$$\n\\begin{cases}\nc_{i0} + c_{i1}(x_{-1}) + c_{i2}(x_{-1})^2 = \\delta_{i, -1} \\\\\nc_{i0} + c_{i1}(x_{0}) + c_{i2}(x_{0})^2 = \\delta_{i, 0} \\\\\nc_{i0} + c_{i1}(x_{1}) + c_{i2}(x_{1})^2 = \\delta_{i, 1}\n\\end{cases}\n$$\n代入节点值 $x_{-1}=-1$、$x_0=0$、$x_1=1$：\n$$\n\\begin{cases}\nc_{i0} - c_{i1} + c_{i2} = \\delta_{i, -1} \\\\\nc_{i0} = \\delta_{i, 0} \\\\\nc_{i0} + c_{i1} + c_{i2} = \\delta_{i, 1}\n\\end{cases}\n$$\n该方程组可以写成矩阵形式 $V \\mathbf{c}_i = \\mathbf{d}_i$，其中 $\\mathbf{c}_i = (c_{i0}, c_{i1}, c_{i2})^T$，$\\mathbf{d}_i = (\\delta_{i,-1}, \\delta_{i,0}, \\delta_{i,1})^T$，而 $V$ 是由节点构造的 Vandermonde 矩阵：\n$$V = \\begin{pmatrix} 1 & x_{-1} & x_{-1}^2 \\\\ 1 & x_{0} & x_{0}^2 \\\\ 1 & x_{1} & x_{1}^2 \\end{pmatrix} = \\begin{pmatrix} 1 & -1 & (-1)^2 \\\\ 1 & 0 & 0^2 \\\\ 1 & 1 & 1^2 \\end{pmatrix} = \\begin{pmatrix} 1 & -1 & 1 \\\\ 1 & 0 & 0 \\\\ 1 & 1 & 1 \\end{pmatrix}$$\n对于 $i = -1, 0, 1$，右侧向量是 $\\mathbb{R}^3$ 的标准基向量，尽管由于节点索引的原因，它们的顺序不同：\n$\\mathbf{d}_{-1} = (1,0,0)^T$，$\\mathbf{d}_{0} = (0,1,0)^T$ 和 $\\mathbf{d}_{1} = (0,0,1)^T$。\n\n系数向量 $\\mathbf{c}_i$ 通过求解 $\\mathbf{c}_i = V^{-1}\\mathbf{d}_i$ 得到。这意味着 $\\ell_{-1}(x)$ 的系数向量是 $V^{-1}$ 的第一列，$\\ell_0(x)$ 的系数向量是第二列，而 $\\ell_1(x)$ 的系数向量是第三列。我们的任务简化为求 Vandermonde 矩阵 $V$ 的逆矩阵。\n\n首先，我们通过沿第二行展开来计算 $V$ 的行列式：\n$$\\det(V) = 1 \\cdot (-1)^{2+1} \\det\\begin{pmatrix} -1 & 1 \\\\ 1 & 1 \\end{pmatrix} = -1((-1)(1) - (1)(1)) = -1(-2) = 2$$\n由于 $\\det(V) \\neq 0$，逆矩阵 $V^{-1}$ 存在。我们使用伴随矩阵公式 $V^{-1} = \\frac{1}{\\det(V)}\\text{adj}(V)$ 来求逆。伴随矩阵是代数余子式矩阵的转置。\n\n代数余子式矩阵 $C_{ij} = (-1)^{i+j}M_{ij}$ 是：\n$$\n\\text{cof}(V) = \\begin{pmatrix}\n+\\det\\begin{pmatrix} 0 & 0 \\\\ 1 & 1 \\end{pmatrix} & -\\det\\begin{pmatrix} 1 & 0 \\\\ 1 & 1 \\end{pmatrix} & +\\det\\begin{pmatrix} 1 & 0 \\\\ 1 & 1 \\end{pmatrix} \\\\\n-\\det\\begin{pmatrix} -1 & 1 \\\\ 1 & 1 \\end{pmatrix} & +\\det\\begin{pmatrix} 1 & 1 \\\\ 1 & 1 \\end{pmatrix} & -\\det\\begin{pmatrix} 1 & -1 \\\\ 1 & 1 \\end{pmatrix} \\\\\n+\\det\\begin{pmatrix} -1 & 1 \\\\ 0 & 0 \\end{pmatrix} & -\\det\\begin{pmatrix} 1 & 1 \\\\ 1 & 0 \\end{pmatrix} & +\\det\\begin{pmatrix} 1 & -1 \\\\ 1 & 0 \\end{pmatrix}\n\\end{pmatrix}\n= \\begin{pmatrix}\n0 & -1 & 1 \\\\\n2 & 0 & -2 \\\\\n0 & 1 & 1\n\\end{pmatrix}\n$$\n伴随矩阵是代数余子式矩阵的转置：\n$$\\text{adj}(V) = (\\text{cof}(V))^T = \\begin{pmatrix} 0 & 2 & 0 \\\\ -1 & 0 & 1 \\\\ 1 & -2 & 1 \\end{pmatrix}$$\n逆矩阵是：\n$$V^{-1} = \\frac{1}{2} \\begin{pmatrix} 0 & 2 & 0 \\\\ -1 & 0 & 1 \\\\ 1 & -2 & 1 \\end{pmatrix} = \\begin{pmatrix} 0 & 1 & 0 \\\\ -\\frac{1}{2} & 0 & \\frac{1}{2} \\\\ \\frac{1}{2} & -1 & \\frac{1}{2} \\end{pmatrix}$$\n$V^{-1}$ 的各列包含了多项式的系数 $(c_{i0}, c_{i1}, c_{i2})$。\n第一列给出了 $\\ell_{-1}(x)$ 的系数：\n$$\\begin{pmatrix} c_{-1,0} \\\\ c_{-1,1} \\\\ c_{-1,2} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ -\\frac{1}{2} \\\\ \\frac{1}{2} \\end{pmatrix} \\implies \\ell_{-1}(x) = 0 - \\frac{1}{2}x + \\frac{1}{2}x^2 = \\frac{1}{2}x^2 - \\frac{1}{2}x$$\n第二列给出了 $\\ell_{0}(x)$ 的系数：\n$$\\begin{pmatrix} c_{0,0} \\\\ c_{0,1} \\\\ c_{0,2} \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 0 \\\\ -1 \\end{pmatrix} \\implies \\ell_{0}(x) = 1 + 0x - 1x^2 = 1 - x^2$$\n第三列给出了 $\\ell_{1}(x)$ 的系数：\n$$\\begin{pmatrix} c_{1,0} \\\\ c_{1,1} \\\\ c_{1,2} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ \\frac{1}{2} \\\\ \\frac{1}{2} \\end{pmatrix} \\implies \\ell_{1}(x) = 0 + \\frac{1}{2}x + \\frac{1}{2}x^2 = \\frac{1}{2}x^2 + \\frac{1}{2}x$$\n三个基多项式的简化标准形式为：\n$\\ell_{-1}(x) = \\frac{1}{2}x^2 - \\frac{1}{2}x$\n$\\ell_{0}(x) = -x^2 + 1$\n$\\ell_{1}(x) = \\frac{1}{2}x^2 + \\frac{1}{2}x$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{2}x^2 - \\frac{1}{2}x & 1 - x^2 & \\frac{1}{2}x^2 + \\frac{1}{2}x\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在有限元方法的实际应用中，我们通常需要通过数值积分来计算刚度矩阵和质量矩阵的各项。选择一个足够精确的求积规则是保证计算结果准确性的关键。本练习  聚焦于刚度矩阵的计算，它涉及基函数导数的积分，这将帮助你掌握如何根据被积函数的多项式次数来确定所需的最小高斯求积点数，这是有限元编程实现中的一个核心环节。",
            "id": "3359439",
            "problem": "在用于数值求解一维偏微分方程 (PDE) 的有限元法 (FEM) 中，考虑参考单元 $\\hat{\\Omega} = [-1,1]$ 以及其上的 $p$ 次标准拉格朗日节点基 $\\{\\ell_i(\\hat{x})\\}$。在 $\\hat{\\Omega}$ 上的常系数椭圆算子的局部刚度矩阵项为\n$$\nK_{ij} \\;=\\; \\int_{-1}^{1} \\ell_i'(\\hat{x})\\,\\ell_j'(\\hat{x})\\,d\\hat{x}.\n$$\n假设这些积分使用 $[-1,1]$ 上的 $n$ 点高斯-勒让德求积法计算，其代数精度为 $2n-1$。对于多项式次数 $p=2$ 和 $p=3$（记作 $P_2$ 和 $P_3$），请确定在每种情况下，为使所有基函数索引对 $(i,j)$ 的 $K_{ij}$ 都能被精确积分，所需的最小求积点数 $n$。请将 $P_2$ 和 $P_3$ 的答案按 $p$ 的升序表示为单个行向量。无需舍入，也不涉及物理单位。",
            "solution": "本问题要求确定，对于多项式次数为 $p=2$ 和 $p=3$ 的一维拉格朗日有限元，为精确计算局部刚度矩阵的项 $K_{ij}$ 所需的高斯-勒让德求积点的最小数量 $n$。\n\n参考单元 $\\hat{\\Omega} = [-1,1]$ 上的刚度矩阵项由以下积分给出：\n$$\nK_{ij} = \\int_{-1}^{1} \\ell_i'(\\hat{x})\\,\\ell_j'(\\hat{x})\\,d\\hat{x}\n$$\n此处，$\\{\\ell_i(\\hat{x})\\}$ 是次数为 $p$ 的拉格朗日基函数集。根据定义，每个基函数 $\\ell_i(\\hat{x})$ 都是一个 $p$ 次多项式。\n\n第一步是确定被积函数 $I(\\hat{x}) = \\ell_i'(\\hat{x})\\,\\ell_j'(\\hat{x})$ 的多项式次数。\n一个 $p$ 次多项式的导数是一个 $p-1$ 次多项式。因此，$\\ell_i'(\\hat{x})$ 和 $\\ell_j'(\\hat{x})$ 都是 $p-1$ 次多项式。\n\n两个 $p-1$ 次多项式的乘积是一个 $(p-1) + (p-1) = 2p-2$ 次多项式。因此，被积函数 $I(\\hat{x})$ 是一个 $2p-2$ 次多项式。\n\n题目指出，$n$ 点高斯-勒让德求积法则对于次数最高为 $2n-1$ 的多项式是精确的。为了精确计算 $I(\\hat{x})$ 的积分，求积法则的代数精度必须大于或等于多项式 $I(\\hat{x})$ 的次数。这得出以下不等式：\n$$\n2n-1 \\ge \\deg(I(\\hat{x}))\n$$\n代入被积函数的次数，我们得到：\n$$\n2n-1 \\ge 2p-2\n$$\n为求得最小点数 $n$，我们对 $n$ 求解此不等式：\n$$\n2n \\ge 2p-2+1\n$$\n$$\n2n \\ge 2p-1\n$$\n$$\nn \\ge \\frac{2p-1}{2}\n$$\n$$\nn \\ge p - \\frac{1}{2}\n$$\n由于求积点数 $n$ 必须是整数，因此 $n$ 的最小值是满足此条件的最小整数。这可以通过对右侧取上整得到：\n$$\nn_{min} = \\lceil p - \\frac{1}{2} \\rceil\n$$\n对于任何整数 $p \\ge 1$，这可以简化为 $n_{min} = p$。\n\n现在我们将此一般性结果应用于所要求的两个具体情况。\n\n情况1：$p=2$（二次基函数，$P_2$）\n对于 $p=2$，最小求积点数为：\n$$\nn \\ge 2 - \\frac{1}{2} = 1.5\n$$\n满足此条件的最小整数 $n$ 是 $n=2$。\n或者，被积函数的次数是 $2(2)-2 = 2$。精确性条件是 $2n-1 \\ge 2$，这给出 $2n \\ge 3$，即 $n \\ge 1.5$。最小整数是 $n=2$。\n\n情况2：$p=3$（三次基函数，$P_3$）\n对于 $p=3$，最小求积点数为：\n$$\nn \\ge 3 - \\frac{1}{2} = 2.5\n$$\n满足此条件的最小整数 $n$ 是 $n=3$。\n或者，被积函数的次数是 $2(3)-2 = 4$。精确性条件是 $2n-1 \\ge 4$，这给出 $2n \\ge 5$，即 $n \\ge 2.5$。最小整数是 $n=3$。\n\n$p=2$ 所需的最小求积点数为 $2$，$p=3$ 所需的最小求积点数为 $3$。题目要求将这些答案按 $p$ 的升序表示为单个行向量。顺序是 $(p=2, p=3)$，因此对应的 $n$ 值为 $(2, 3)$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2 & 3\n\\end{pmatrix}\n}\n$$"
        }
    ]
}