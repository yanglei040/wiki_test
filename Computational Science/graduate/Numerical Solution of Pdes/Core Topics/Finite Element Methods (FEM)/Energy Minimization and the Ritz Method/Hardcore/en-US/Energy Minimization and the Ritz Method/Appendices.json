{
    "hands_on_practices": [
        {
            "introduction": "The cornerstone of the Ritz method is the principle of energy minimization. Before developing sophisticated numerical schemes to find the minimizer of an energy functional, it is crucial to build intuition for the functional itself. This first exercise provides a direct, hands-on opportunity to evaluate the energy functional for a simple problem using a single, prescribed trial function, and to interpret its components in terms of physical concepts like internal strain energy and the potential of external forces. ",
            "id": "3384633",
            "problem": "Consider the one-dimensional second-order linear elliptic Partial Differential Equation (PDE) on the open interval $\\Omega=(0,1)$ with homogeneous Dirichlet boundary conditions, $-(a(x) u^{\\prime}(x))^{\\prime}=f(x)$ with $u(0)=0$ and $u(1)=0$, where $a(x)$ is a strictly positive coefficient and $f(x)$ is a given source. The energy minimization principle states that the solution can be characterized as the minimizer of an appropriate energy functional over the Sobolev space $H^{1}_{0}(\\Omega)$.\n\nUsing the energy minimization framework and the Ritz method, perform the following for the specific data $a(x)=1$ and $f(x)=x$:\n1. Starting from the strong form of the PDE and the principle of stationary potential energy, write down the energy functional $J(v)$ to be minimized over $v\\in H^{1}_{0}(\\Omega)$ that corresponds to the given PDE and data, ensuring consistency with the boundary conditions.\n2. Using the single-function trial $u(x)=x(1-x)$, which satisfies $u(0)=u(1)=0$, evaluate $J(u)$ exactly by carrying out all required integrals in closed form.\n3. Briefly interpret the two contributions to $J(u)$ in terms of stored internal energy and external work input, as they arise from the underlying variational structure.\n\nExpress the final value of $J(u)$ as an exact number. No rounding is required.",
            "solution": "The problem requires the application of the energy minimization principle and the Ritz method to a specific one-dimensional boundary value problem. We begin by validating the problem statement.\n\n### Step 1: Extract Givens\n- **PDE:** $-(a(x) u^{\\prime}(x))^{\\prime}=f(x)$\n- **Domain:** $\\Omega=(0,1)$\n- **Boundary Conditions:** $u(0)=0, u(1)=0$ (homogeneous Dirichlet)\n- **Coefficient:** $a(x)$ is a strictly positive function.\n- **Source:** $f(x)$ is a given source function.\n- **Function Space:** The solution lies in the Sobolev space $H^{1}_{0}(\\Omega)$.\n- **Specific Data:** $a(x)=1$ and $f(x)=x$.\n- **Trial Function:** $u(x)=x(1-x)$.\n- **Tasks:** 1. Derive the energy functional $J(v)$. 2. Evaluate $J(u)$ for the given trial function. 3. Interpret the physical meaning of the terms in $J(u)$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically and mathematically sound. It describes the standard variational or energy minimization approach to solving a one-dimensional Poisson equation, a cornerstone of numerical PDE theory and computational mechanics. The provided data ($a(x)=1$, $f(x)=x$) are well-defined. The specified function space $H^{1}_{0}(\\Omega)$ is the correct setting for this problem. The trial function satisfies the required boundary conditions. The problem is self-contained, unambiguous, and well-posed. No flaws are identified.\n\n### Step 3: Verdict and Action\nThe problem is valid. We proceed with the solution.\n\n### Part 1: Derivation of the Energy Functional\n\nThe principle of stationary potential energy states that the solution $u(x)$ to the boundary value problem is the function that minimizes a total energy functional $J(v)$ over the space of admissible functions. An admissible function $v(x)$ must be sufficiently smooth and satisfy the essential boundary conditions, which in this case are $v(0)=0$ and $v(1)=0$. The appropriate function space is $H^{1}_{0}(\\Omega)$, the space of functions with square-integrable first derivatives that are zero at the boundary.\n\nTo find the functional $J(v)$ whose minimizer satisfies the strong form of the PDE, $-(a(x) u^{\\prime}(x))^{\\prime}=f(x)$, we first derive the weak form. We multiply the PDE by an arbitrary test function $v \\in H^{1}_{0}(\\Omega)$ and integrate over the domain $\\Omega=(0,1)$:\n$$ -\\int_{0}^{1} (a(x) u^{\\prime}(x))^{\\prime} v(x) \\,dx = \\int_{0}^{1} f(x) v(x) \\,dx $$\nApplying integration by parts to the left-hand side, we get:\n$$ \\int_{0}^{1} a(x) u^{\\prime}(x) v^{\\prime}(x) \\,dx - \\left[ a(x) u^{\\prime}(x) v(x) \\right]_{0}^{1} = \\int_{0}^{1} f(x) v(x) \\,dx $$\nSince $v \\in H^{1}_{0}(\\Omega)$, we have $v(0)=0$ and $v(1)=0$. Therefore, the boundary term vanishes, leading to the weak form: Find $u \\in H^{1}_{0}(\\Omega)$ such that\n$$ \\int_{0}^{1} a(x) u^{\\prime}(x) v^{\\prime}(x) \\,dx = \\int_{0}^{1} f(x) v(x) \\,dx \\quad \\forall v \\in H^{1}_{0}(\\Omega) $$\nThis equation is the Euler-Lagrange equation for the energy functional $J(v)$ defined as:\n$$ J(v) = \\frac{1}{2} \\int_{0}^{1} a(x) (v^{\\prime}(x))^{2} \\,dx - \\int_{0}^{1} f(x) v(x) \\,dx $$\nFor the specific data given, $a(x)=1$ and $f(x)=x$, the functional to be minimized is:\n$$ J(v) = \\frac{1}{2} \\int_{0}^{1} (v^{\\prime}(x))^{2} \\,dx - \\int_{0}^{1} x v(x) \\,dx $$\n\n### Part 2: Evaluation of the Energy Functional for the Trial Function\n\nThe Ritz method seeks an approximate solution by minimizing the functional $J(v)$ over a finite-dimensional subspace of $H^{1}_{0}(\\Omega)$. In this case, we use a single-function approximation with the trial function $u(x) = x(1-x)$, which can also be written as $u(x) = x - x^{2}$. We first confirm it is an admissible function: $u(0)=0(1-0)=0$ and $u(1)=1(1-1)=0$, so it satisfies the required boundary conditions.\n\nNext, we compute the derivative of the trial function:\n$$ u^{\\prime}(x) = \\frac{d}{dx}(x - x^{2}) = 1 - 2x $$\nNow we evaluate the two integrals in the expression for $J(u)$.\n\nThe first integral is:\n$$ \\int_{0}^{1} (u^{\\prime}(x))^{2} \\,dx = \\int_{0}^{1} (1-2x)^{2} \\,dx = \\int_{0}^{1} (1 - 4x + 4x^{2}) \\,dx $$\n$$ = \\left[ x - 4\\frac{x^{2}}{2} + 4\\frac{x^{3}}{3} \\right]_{0}^{1} = \\left[ x - 2x^{2} + \\frac{4}{3}x^{3} \\right]_{0}^{1} $$\n$$ = \\left( 1 - 2(1)^{2} + \\frac{4}{3}(1)^{3} \\right) - (0) = 1 - 2 + \\frac{4}{3} = -1 + \\frac{4}{3} = \\frac{1}{3} $$\n\nThe second integral is:\n$$ \\int_{0}^{1} x u(x) \\,dx = \\int_{0}^{1} x(x - x^{2}) \\,dx = \\int_{0}^{1} (x^{2} - x^{3}) \\,dx $$\n$$ = \\left[ \\frac{x^{3}}{3} - \\frac{x^{4}}{4} \\right]_{0}^{1} = \\left( \\frac{1^{3}}{3} - \\frac{1^{4}}{4} \\right) - (0) = \\frac{1}{3} - \\frac{1}{4} = \\frac{4-3}{12} = \\frac{1}{12} $$\n\nFinally, we substitute these results into the expression for $J(u)$:\n$$ J(u) = \\frac{1}{2} \\int_{0}^{1} (u^{\\prime}(x))^{2} \\,dx - \\int_{0}^{1} x u(x) \\,dx $$\n$$ J(u) = \\frac{1}{2} \\left( \\frac{1}{3} \\right) - \\left( \\frac{1}{12} \\right) = \\frac{1}{6} - \\frac{1}{12} = \\frac{2}{12} - \\frac{1}{12} = \\frac{1}{12} $$\n\n### Part 3: Interpretation of Contributions\n\nThe energy functional $J(u)$ represents the total potential energy of the physical system described by the PDE. It consists of two terms with distinct physical interpretations.\n\n1.  **Internal Energy:** The first term, $\\frac{1}{2} \\int_{0}^{1} a(x) (u^{\\prime}(x))^{2} \\,dx$, represents the internal strain energy stored in the system due to its deformation. In a mechanical context (e.g., a stretched string or a deflected beam), $u^{\\prime}(x)$ is the strain, and $a(x)$ is related to the material's stiffness. The integrand is the strain energy density, and its integral over the domain gives the total stored internal energy. For our trial function, this value is $\\frac{1}{2} \\times \\frac{1}{3} = \\frac{1}{6}$.\n\n2.  **External Work Potential:** The second term, $-\\int_{0}^{1} f(x) u(x) \\,dx$, represents the potential energy of the external loads. The integral $\\int_{0}^{1} f(x) u(x) \\,dx$ is the work done by the distributed external force $f(x)$ acting through the displacement $u(x)$. The potential of the conservative external force field is the negative of the work done by it. For our trial function, the work done by the external load is $\\frac{1}{12}$, so the external work potential is $-\\frac{1}{12}$.\n\nThe system seeks a stable equilibrium by adopting a configuration $u(x)$ that minimizes the total potential energy $J(u) = (\\text{Internal Energy}) - (\\text{Work Done by External Force})$. The value $J(u) = \\frac{1}{12}$ is the total potential energy of the system for the approximate displacement field $u(x)=x(1-x)$.",
            "answer": "$$\\boxed{\\frac{1}{12}}$$"
        },
        {
            "introduction": "Moving from a single trial function to a finite-dimensional space of functions is the essential step in the Ritz method. This practice bridges the gap between the continuous variational problem and the discrete algebraic system that can be solved on a computer. By using a basis of piecewise linear 'hat' functions—the fundamental building blocks of the Finite Element Method—you will assemble the stiffness matrix and load vector from first principles, providing a clear understanding of how the continuous PDE is transformed into a solvable matrix equation. ",
            "id": "3384616",
            "problem": "Consider the boundary value problem for the one-dimensional Poisson equation on the open interval $\\Omega=(0,1)$ with homogeneous Dirichlet boundary conditions. The associated energy functional is\n$$\n\\mathcal{J}(u)=\\frac{1}{2}\\int_{0}^{1} a\\,|u'(x)|^{2}\\,dx-\\int_{0}^{1} f(x)\\,u(x)\\,dx,\n$$\nwhere $a=1$ and $f(x)=1$. The Ritz method seeks $u_{h}\\in V_{h}\\subset H_{0}^{1}(0,1)$ that minimizes $\\mathcal{J}(u)$ over the finite-dimensional subspace $V_{h}$.\n\nLet the domain be partitioned uniformly into $3$ subintervals by the nodes $x_{0}=0$, $x_{1}=\\frac{1}{3}$, $x_{2}=\\frac{2}{3}$, $x_{3}=1$. Let $\\phi_{1}$ and $\\phi_{2}$ be the nodal hat functions associated with $x_{1}$ and $x_{2}$, respectively, so that $\\phi_{i}(x_{j})=\\delta_{ij}$ for $i,j\\in\\{1,2\\}$ and $\\phi_{i}(0)=\\phi_{i}(1)=0$. Define the trial space $V_{h}=\\mathrm{span}\\{\\phi_{1},\\phi_{2}\\}$ and the Ritz ansatz $u_{h}(x)=c_{1}\\phi_{1}(x)+c_{2}\\phi_{2}(x)$ with unknown coefficients $c_{1}$ and $c_{2}$.\n\nStarting from the energy functional $\\mathcal{J}(u)$ and the definition of $V_{h}$, derive the discrete algebraic system for $(c_{1},c_{2})$ by enforcing the vanishing of the first variation of $\\mathcal{J}$ restricted to $V_{h}$ in the directions of $\\phi_{1}$ and $\\phi_{2}$. Assemble explicitly the resulting stiffness matrix and load vector by evaluating the necessary integrals using the piecewise definitions of $\\phi_{1}$ and $\\phi_{2}$. Then solve the system for $(c_{1},c_{2})$ and report the coefficient vector as a row matrix. Express your final answer in exact form. No rounding is required.",
            "solution": "The problem statement is evaluated for validity.\n\n### Step 1: Extract Givens\n- **Governing Equation**: One-dimensional Poisson equation on the open interval $\\Omega=(0,1)$.\n- **Boundary Conditions**: Homogeneous Dirichlet boundary conditions, $u(0)=0$ and $u(1)=0$.\n- **Energy Functional**: $\\mathcal{J}(u)=\\frac{1}{2}\\int_{0}^{1} a\\,|u'(x)|^{2}\\,dx-\\int_{0}^{1} f(x)\\,u(x)\\,dx$.\n- **Constants**: $a=1$, $f(x)=1$.\n- **Method**: The Ritz method.\n- **Domain Partition**: Uniform partition into $3$ subintervals by nodes $x_{0}=0$, $x_{1}=\\frac{1}{3}$, $x_{2}=\\frac{2}{3}$, $x_{3}=1$. The subinterval length is $h=\\frac{1}{3}$.\n- **Trial Space**: $V_{h}=\\mathrm{span}\\{\\phi_{1},\\phi_{2}\\}$, where $\\phi_{1}$ and $\\phi_{2}$ are the nodal hat functions associated with the interior nodes $x_{1}$ and $x_{2}$, respectively. These basis functions satisfy $\\phi_{i}(x_{j})=\\delta_{ij}$ for $i,j\\in\\{1,2\\}$ and $\\phi_{i}(0)=\\phi_{i}(1)=0$.\n- **Ritz Ansatz**: The approximate solution is $u_{h}(x)=c_{1}\\phi_{1}(x)+c_{2}\\phi_{2}(x)$.\n- **Task**: Derive and solve the discrete algebraic system for the coefficient vector $(c_{1},c_{2})$.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientifically Grounded**: The problem describes the application of the Ritz method, a specific formulation of the finite element method, to a classic boundary value problem (the 1D Poisson equation). The energy functional, the choice of basis functions (piecewise linear \"hat\" functions), and the overall procedure are standard and fundamental concepts in the field of numerical analysis for partial differential equations. The setup is entirely consistent with established mathematical theory.\n2.  **Well-Posed**: The problem is well-posed. The Ritz-Galerkin method applied to this elliptic boundary value problem is guaranteed to yield a unique solution because the bilinear form associated with the operator is coercive and continuous on the Sobolev space $H_{0}^{1}(0,1)$, which ensures the resulting stiffness matrix is symmetric and positive-definite, and therefore invertible.\n3.  **Objective**: The problem is stated in precise, unambiguous mathematical language. All terms are standard and well-defined within the context.\n4.  **Completeness**: All necessary information (the functional, domain, partition, basis functions, and constants) is provided.\n\n### Step 3: Verdict and Action\nThe problem is valid as it is mathematically sound, well-posed, and completely specified. A solution will be derived.\n\nThe Ritz method seeks a function $u_{h} \\in V_{h}$ that minimizes the energy functional $\\mathcal{J}(u)$. Given the ansatz $u_{h}(x)=c_{1}\\phi_{1}(x)+c_{2}\\phi_{2}(x)$, the functional becomes a function of the coefficients $c_{1}$ and $c_{2}$:\n$$\n\\mathcal{J}(c_{1}, c_{2}) = \\frac{1}{2}\\int_{0}^{1} a \\left| c_{1}\\phi_{1}'(x) + c_{2}\\phi_{2}'(x) \\right|^{2} dx - \\int_{0}^{1} f(x) \\left( c_{1}\\phi_{1}(x) + c_{2}\\phi_{2}(x) \\right) dx.\n$$\nThe minimum of this quadratic function is found by setting its partial derivatives with respect to $c_{1}$ and $c_{2}$ to zero:\n$$\n\\frac{\\partial \\mathcal{J}}{\\partial c_{1}} = \\int_{0}^{1} a \\left( c_{1}\\phi_{1}'(x) + c_{2}\\phi_{2}'(x) \\right) \\phi_{1}'(x) dx - \\int_{0}^{1} f(x) \\phi_{1}(x) dx = 0\n$$\n$$\n\\frac{\\partial \\mathcal{J}}{\\partial c_{2}} = \\int_{0}^{1} a \\left( c_{1}\\phi_{1}'(x) + c_{2}\\phi_{2}'(x) \\right) \\phi_{2}'(x) dx - \\int_{0}^{1} f(x) \\phi_{2}(x) dx = 0\n$$\nThis can be written as a linear system $A\\mathbf{c} = \\mathbf{b}$, where $\\mathbf{c} = \\begin{pmatrix} c_{1} \\\\ c_{2} \\end{pmatrix}$, the stiffness matrix $A$ has entries $A_{ij} = \\int_{0}^{1} a \\phi_{j}'(x)\\phi_{i}'(x) dx$, and the load vector $\\mathbf{b}$ has entries $b_{i} = \\int_{0}^{1} f(x) \\phi_{i}(x) dx$.\n\nFirst, we define the basis functions and their derivatives. The mesh spacing is $h = x_{1}-x_{0} = \\frac{1}{3}$.\nThe hat function $\\phi_{1}(x)$ associated with node $x_{1}=\\frac{1}{3}$ is:\n$$\n\\phi_{1}(x) = \\begin{cases} \\frac{x-x_{0}}{x_{1}-x_{0}} = \\frac{x}{1/3} = 3x  x \\in [0, 1/3] \\\\ \\frac{x_{2}-x}{x_{2}-x_{1}} = \\frac{2/3-x}{1/3} = 2 - 3x  x \\in [1/3, 2/3] \\\\ 0  \\text{otherwise} \\end{cases}\n$$\nIts derivative is:\n$$\n\\phi_{1}'(x) = \\begin{cases} 3  x \\in (0, 1/3) \\\\ -3  x \\in (1/3, 2/3) \\\\ 0  \\text{otherwise} \\end{cases}\n$$\nThe hat function $\\phi_{2}(x)$ associated with node $x_{2}=\\frac{2}{3}$ is:\n$$\n\\phi_{2}(x) = \\begin{cases} \\frac{x-x_{1}}{x_{2}-x_{1}} = \\frac{x-1/3}{1/3} = 3x - 1  x \\in [1/3, 2/3] \\\\ \\frac{x_{3}-x}{x_{3}-x_{2}} = \\frac{1-x}{1/3} = 3 - 3x  x \\in [2/3, 1] \\\\ 0  \\text{otherwise} \\end{cases}\n$$\nIts derivative is:\n$$\n\\phi_{2}'(x) = \\begin{cases} 3  x \\in (1/3, 2/3) \\\\ -3  x \\in (2/3, 1) \\\\ 0  \\text{otherwise} \\end{cases}\n$$\nNow, we compute the entries of the stiffness matrix $A$ with $a=1$:\n$$\nA_{11} = \\int_{0}^{1} |\\phi_{1}'(x)|^{2} dx = \\int_{0}^{1/3} (3)^{2} dx + \\int_{1/3}^{2/3} (-3)^{2} dx = 9 \\cdot \\frac{1}{3} + 9 \\cdot \\frac{1}{3} = 3+3 = 6.\n$$\n$$\nA_{22} = \\int_{0}^{1} |\\phi_{2}'(x)|^{2} dx = \\int_{1/3}^{2/3} (3)^{2} dx + \\int_{2/3}^{1} (-3)^{2} dx = 9 \\cdot \\frac{1}{3} + 9 \\cdot \\frac{1}{3} = 3+3 = 6.\n$$\nThe off-diagonal terms are identical by symmetry, $A_{12}=A_{21}$. The product $\\phi_{1}'(x)\\phi_{2}'(x)$ is non-zero only on the interval $(1/3, 2/3)$:\n$$\nA_{12} = \\int_{0}^{1} \\phi_{1}'(x)\\phi_{2}'(x) dx = \\int_{1/3}^{2/3} (-3)(3) dx = \\int_{1/3}^{2/3} -9 dx = -9 \\cdot \\frac{1}{3} = -3.\n$$\nThus, the stiffness matrix is $A = \\begin{pmatrix} 6  -3 \\\\ -3  6 \\end{pmatrix}$.\n\nNext, we compute the entries of the load vector $\\mathbf{b}$ with $f(x)=1$:\n$b_{i} = \\int_{0}^{1} \\phi_{i}(x) dx$. This integral is the area of the triangular hat function, which is $\\frac{1}{2} \\times \\text{base} \\times \\text{height} = \\frac{1}{2} \\times (2h) \\times 1 = h = \\frac{1}{3}$. We verify this by direct integration for $b_1$:\n$$\nb_{1} = \\int_{0}^{1} \\phi_{1}(x) dx = \\int_{0}^{1/3} 3x \\,dx + \\int_{1/3}^{2/3} (2-3x) \\,dx = \\left[\\frac{3x^{2}}{2}\\right]_{0}^{1/3} + \\left[2x-\\frac{3x^{2}}{2}\\right]_{1/3}^{2/3}\n$$\n$$\nb_1 = \\left(\\frac{3}{2}\\frac{1}{9}\\right) + \\left( \\left(\\frac{4}{3}-\\frac{3}{2}\\frac{4}{9}\\right) - \\left(\\frac{2}{3}-\\frac{3}{2}\\frac{1}{9}\\right) \\right) = \\frac{1}{6} + \\left( \\left(\\frac{4}{3}-\\frac{2}{3}\\right) - \\left(\\frac{2}{3}-\\frac{1}{6}\\right) \\right) = \\frac{1}{6} + \\left( \\frac{2}{3} - \\frac{3}{6} \\right) = \\frac{1}{6} + \\frac{1}{6} = \\frac{2}{6} = \\frac{1}{3}.\n$$\nBy symmetry of the domain and basis functions, $b_{2} = \\int_{0}^{1} \\phi_{2}(x) dx = \\frac{1}{3}$.\nThus, the load vector is $\\mathbf{b} = \\begin{pmatrix} 1/3 \\\\ 1/3 \\end{pmatrix}$.\n\nWe now solve the linear system $A\\mathbf{c}=\\mathbf{b}$:\n$$\n\\begin{pmatrix} 6  -3 \\\\ -3  6 \\end{pmatrix} \\begin{pmatrix} c_{1} \\\\ c_{2} \\end{pmatrix} = \\begin{pmatrix} 1/3 \\\\ 1/3 \\end{pmatrix}\n$$\nThis corresponds to the equations:\n1) $6c_{1} - 3c_{2} = \\frac{1}{3}$\n2) $-3c_{1} + 6c_{2} = \\frac{1}{3}$\nBy inspection, the problem's symmetry suggests $c_{1}=c_{2}$. Substituting $c_{1}=c_{2}=c$ into the first equation:\n$6c - 3c = \\frac{1}{3} \\implies 3c = \\frac{1}{3} \\implies c = \\frac{1}{9}$.\nThus, $c_{1} = \\frac{1}{9}$ and $c_{2} = \\frac{1}{9}$.\nAlternatively, using matrix inversion:\n$\\det(A) = (6)(6) - (-3)(-3) = 36-9=27$.\n$A^{-1} = \\frac{1}{27}\\begin{pmatrix} 6  3 \\\\ 3  6 \\end{pmatrix}$.\n$$\n\\mathbf{c} = A^{-1}\\mathbf{b} = \\frac{1}{27}\\begin{pmatrix} 6  3 \\\\ 3  6 \\end{pmatrix} \\begin{pmatrix} 1/3 \\\\ 1/3 \\end{pmatrix} = \\frac{1}{27}\\begin{pmatrix} 6(1/3)+3(1/3) \\\\ 3(1/3)+6(1/3) \\end{pmatrix} = \\frac{1}{27}\\begin{pmatrix} 2+1 \\\\ 1+2 \\end{pmatrix} = \\frac{1}{27}\\begin{pmatrix} 3 \\\\ 3 \\end{pmatrix} = \\begin{pmatrix} 1/9 \\\\ 1/9 \\end{pmatrix}.\n$$\nThe coefficient vector is $(c_{1}, c_{2}) = (1/9, 1/9)$. The problem asks for this to be reported as a row matrix.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix} \\frac{1}{9}  \\frac{1}{9} \\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "A robust numerical method is not only one that provides an answer, but one whose stability and performance characteristics are well understood. After learning to construct the discrete system, we must analyze its properties, particularly as we refine the approximation to achieve higher accuracy. This advanced exercise guides you through the process of deriving the exact eigenvalues of the 1D stiffness matrix, allowing for a rigorous analysis of its condition number and its scaling with respect to the mesh size $h$, a foundational result in the analysis of finite element methods. ",
            "id": "3384581",
            "problem": "Consider the energy functional for a one-dimensional linear elliptic boundary value problem on the unit interval with homogeneous Dirichlet boundary conditions,\n$$\nJ(u)=\\tfrac{1}{2}\\int_{0}^{1} \\big(u'(x)\\big)^{2}\\,dx - \\int_{0}^{1} f(x)\\,u(x)\\,dx,\n$$\nposed over the Sobolev space $H_{0}^{1}(0,1)$. Let $V_{h}\\subset H_{0}^{1}(0,1)$ be the conforming finite-dimensional subspace of continuous, piecewise linear functions on a uniform partition $\\{x_{i}=ih\\}_{i=0}^{n}$ with $h=1/n$ and $u(0)=u(1)=0$. Denote by $\\{\\phi_{i}\\}_{i=1}^{n-1}$ the usual nodal hat basis of $V_{h}$. The Ritz method seeks $u_{h}\\in V_{h}$ minimizing $J$ over $V_{h}$, which leads to the symmetric positive definite linear system $A\\mathbf{u}=\\mathbf{b}$ with entries $A_{ij}=\\int_{0}^{1}\\phi_{i}'(x)\\phi_{j}'(x)\\,dx$.\n\nWorking from first principles and without assuming any special formulas beyond standard properties of trigonometric functions and the definition of the condition number in the Euclidean-induced $2$-norm, do the following:\n\n1. Derive the exact form of the stiffness matrix $A$ for this setting in terms of the mesh size $h$ by evaluating the integrals $\\int_{0}^{1}\\phi_{i}'(x)\\phi_{j}'(x)\\,dx$.\n\n2. Characterize all eigenpairs of $A$ explicitly, and from this characterization obtain an exact, closed-form expression for the $2$-norm condition number $\\kappa_{2}(A)$ as a function of $n$ and $h$.\n\n3. Using your exact expression, determine the leading-order coefficient $C$ in the asymptotic relation $\\kappa_{2}(A)\\sim C\\,h^{-2}$ as $h\\to 0^{+}$, expressed as a single closed-form analytic constant independent of $h$.\n\nYour final answer must be the exact constant $C$ as a closed-form analytic expression (no numerical rounding is required and no units are involved).",
            "solution": "The problem is validated as scientifically grounded, well-posed, and objective. It is a standard problem in the numerical analysis of partial differential equations and contains all necessary information for a unique solution.\n\nThe solution is presented in three parts, as requested by the problem statement.\n\n### Part 1: Derivation of the Stiffness Matrix $A$\n\nThe stiffness matrix $A$ has entries $A_{ij} = \\int_{0}^{1} \\phi_{i}'(x)\\phi_{j}'(x)\\,dx$, where $\\{\\phi_{i}\\}_{i=1}^{n-1}$ is the basis of nodal hat functions for the subspace $V_h$. The uniform partition is given by nodes $x_k = kh$ for $k=0, 1, \\dots, n$, with mesh size $h=1/n$.\n\nA basis function $\\phi_i(x)$ is continuous, piecewise linear, and defined by $\\phi_i(x_j) = \\delta_{ij}$, where $\\delta_{ij}$ is the Kronecker delta. It is non-zero only on the interval $(x_{i-1}, x_{i+1})$. Its explicit form is:\n$$\n\\phi_i(x) =\n\\begin{cases}\n\\frac{x - x_{i-1}}{h}  \\text{for } x \\in [x_{i-1}, x_i] \\\\\n\\frac{x_{i+1} - x}{h}  \\text{for } x \\in [x_i, x_{i+1}] \\\\\n0  \\text{otherwise}\n\\end{cases}\n$$\nThe derivative $\\phi_i'(x)$ is piecewise constant:\n$$\n\\phi_i'(x) =\n\\begin{cases}\n\\frac{1}{h}  \\text{for } x \\in (x_{i-1}, x_i) \\\\\n-\\frac{1}{h}  \\text{for } x \\in (x_i, x_{i+1}) \\\\\n0  \\text{otherwise}\n\\end{cases}\n$$\nWe evaluate the integral for $A_{ij}$ by considering three cases for the indices $i, j \\in \\{1, \\dots, n-1\\}$.\n\n**Case 1: Diagonal entries ($j=i$)**\nThe integrand $(\\phi_i'(x))^2$ is non-zero only on $(x_{i-1}, x_{i+1})$.\n$$\nA_{ii} = \\int_{0}^{1} (\\phi_i'(x))^2\\,dx = \\int_{x_{i-1}}^{x_{i+1}} (\\phi_i'(x))^2\\,dx \\\\\n= \\int_{x_{i-1}}^{x_i} \\left(\\frac{1}{h}\\right)^2\\,dx + \\int_{x_i}^{x_{i+1}} \\left(-\\frac{1}{h}\\right)^2\\,dx \\\\\n= \\frac{1}{h^2} (x_i - x_{i-1}) + \\frac{1}{h^2} (x_{i+1} - x_i) \\\\\n= \\frac{1}{h^2} (h) + \\frac{1}{h^2} (h) = \\frac{1}{h} + \\frac{1}{h} = \\frac{2}{h}\n$$\n\n**Case 2: Off-diagonal entries ($|i-j|=1$)**\nLet's consider $j=i+1$. The product $\\phi_i'(x)\\phi_{i+1}'(x)$ is non-zero only where the supports of the derivatives overlap. The support of $\\phi_i'(x)$ is $(x_{i-1}, x_{i+1})$ and the support of $\\phi_{i+1}'(x)$ is $(x_i, x_{i+2})$. The overlap is the interval $(x_i, x_{i+1})$.\nOn this interval, $\\phi_i'(x) = -1/h$ and $\\phi_{i+1}'(x) = 1/h$.\n$$\nA_{i,i+1} = \\int_{0}^{1} \\phi_i'(x)\\phi_{i+1}'(x)\\,dx = \\int_{x_i}^{x_{i+1}} \\left(-\\frac{1}{h}\\right)\\left(\\frac{1}{h}\\right)\\,dx \\\\\n= -\\frac{1}{h^2} (x_{i+1} - x_i) = -\\frac{1}{h^2} (h) = -\\frac{1}{h}\n$$\nBy symmetry of the integral, $A_{i+1,i} = A_{i,i+1} = -1/h$.\n\n**Case 3: Other entries ($|i-j|1$)**\nIn this case, the supports of $\\phi_i'(x)$ and $\\phi_j'(x)$ are disjoint. Their product is zero everywhere.\n$$\nA_{ij} = \\int_{0}^{1} \\phi_i'(x)\\phi_j'(x)\\,dx = \\int_{0}^{1} 0 \\,dx = 0\n$$\nCombining these results, the $(n-1) \\times (n-1)$ stiffness matrix $A$ is a symmetric, tridiagonal matrix:\n$$\nA = \\frac{1}{h}\n\\begin{pmatrix}\n2  -1  0  \\cdots  0  0 \\\\\n-1  2  -1  \\cdots  0  0 \\\\\n0  -1  2  \\cdots  0  0 \\\\\n\\vdots  \\vdots  \\vdots  \\ddots  \\vdots  \\vdots \\\\\n0  0  0  \\cdots  2  -1 \\\\\n0  0  0  \\cdots  -1  2\n\\end{pmatrix}\n$$\n\n### Part 2: Eigenpairs of $A$ and Condition Number $\\kappa_2(A)$\n\nLet $\\lambda$ be an eigenvalue of $A$ and $\\mathbf{v} = (v_1, v_2, \\dots, v_{n-1})^T$ be the corresponding eigenvector. The eigenvalue problem is $A\\mathbf{v} = \\lambda\\mathbf{v}$. Let $m=n-1$ be the size of the matrix. The $j$-th row of this system is:\n$$\n\\frac{1}{h}(-v_{j-1} + 2v_j - v_{j+1}) = \\lambda v_j, \\quad \\text{for } j=1, \\dots, m,\n$$\nwhere we define $v_0 = 0$ and $v_{m+1} = 0$ to handle the boundary rows consistently. Rearranging, we get a second-order linear homogeneous difference equation:\n$$\n-v_{j-1} + (2 - \\lambda h)v_j - v_{j+1} = 0\n$$\nWe seek a solution of the form $v_j = r^j$. Substituting this into the equation yields the characteristic equation:\n$$\n-r^{j-1} + (2 - \\lambda h)r^j - r^{j+1} = 0 \\implies r^2 - (2 - \\lambda h)r + 1 = 0\n$$\nLet $2 - \\lambda h = 2\\cos\\theta$ for some $\\theta$. The equation becomes $r^2 - 2\\cos\\theta \\, r + 1 = 0$, whose roots are $r = \\exp(\\pm i\\theta)$. The general solution for $v_j$ is a linear combination of these roots:\n$$\nv_j = c_1 \\cos(j\\theta) + c_2 \\sin(j\\theta)\n$$\nWe apply the boundary conditions. The condition $v_0=0$ implies $c_1 \\cos(0) + c_2 \\sin(0) = c_1 = 0$. Thus, the solution must have the form $v_j = c_2 \\sin(j\\theta)$.\nThe second condition $v_{m+1}=v_n=0$ requires $c_2 \\sin((m+1)\\theta) = c_2 \\sin(n\\theta) = 0$. For a non-trivial eigenvector, $c_2 \\neq 0$, so we must have $\\sin(n\\theta) = 0$. This implies $n\\theta = k\\pi$ for an integer $k$.\nThus, $\\theta_k = \\frac{k\\pi}{n}$ for $k=1, 2, \\dots, n-1$. These values of $k$ yield distinct non-trivial eigenvectors.\n\nFrom our substitution $2 - \\lambda h = 2\\cos\\theta$, we find the eigenvalues $\\lambda_k$ corresponding to each $\\theta_k$:\n$$\n\\lambda_k h = 2 - 2\\cos(\\theta_k) = 2 - 2\\cos\\left(\\frac{k\\pi}{n}\\right) = 4\\sin^2\\left(\\frac{k\\pi}{2n}\\right)\n$$\nSo the eigenvalues of $A$ are:\n$$\n\\lambda_k = \\frac{4}{h} \\sin^2\\left(\\frac{k\\pi}{2n}\\right), \\quad k=1, 2, \\dots, n-1\n$$\nThe corresponding unnormalized eigenvectors $\\mathbf{v}^{(k)}$ have components:\n$$\nv_j^{(k)} = \\sin\\left(\\frac{jk\\pi}{n}\\right), \\quad j=1, 2, \\dots, n-1\n$$\nThe $2$-norm condition number $\\kappa_2(A)$ for an SPD matrix is the ratio of its largest to smallest eigenvalue, $\\kappa_2(A) = \\lambda_{max}/\\lambda_{min}$.\nThe function $\\sin^2(x)$ is strictly increasing on $(0, \\pi/2)$. For $k \\in \\{1, \\dots, n-1\\}$, the argument $\\frac{k\\pi}{2n}$ is in $(0, \\pi/2)$.\nThe minimum eigenvalue $\\lambda_{min}$ corresponds to $k=1$:\n$$\n\\lambda_{min} = \\lambda_1 = \\frac{4}{h} \\sin^2\\left(\\frac{\\pi}{2n}\\right)\n$$\nThe maximum eigenvalue $\\lambda_{max}$ corresponds to $k=n-1$:\n$$\n\\lambda_{max} = \\lambda_{n-1} = \\frac{4}{h} \\sin^2\\left(\\frac{(n-1)\\pi}{2n}\\right)\n$$\nUsing the identity $\\sin(\\pi/2 - x) = \\cos(x)$, we simplify $\\lambda_{max}$:\n$$\n\\lambda_{max} = \\frac{4}{h} \\sin^2\\left(\\frac{\\pi}{2} - \\frac{\\pi}{2n}\\right) = \\frac{4}{h} \\cos^2\\left(\\frac{\\pi}{2n}\\right)\n$$\nThe condition number is then:\n$$\n\\kappa_2(A) = \\frac{\\lambda_{max}}{\\lambda_{min}} = \\frac{\\frac{4}{h} \\cos^2\\left(\\frac{\\pi}{2n}\\right)}{\\frac{4}{h} \\sin^2\\left(\\frac{\\pi}{2n}\\right)} = \\frac{\\cos^2\\left(\\frac{\\pi}{2n}\\right)}{\\sin^2\\left(\\frac{\\pi}{2n}\\right)} = \\cot^2\\left(\\frac{\\pi}{2n}\\right)\n$$\nSince $h=1/n$, this can be written as a function of $h$:\n$$\n\\kappa_2(A) = \\cot^2\\left(\\frac{\\pi h}{2}\\right)\n$$\n\n### Part 3: Asymptotic Analysis of $\\kappa_2(A)$\n\nWe need to determine the leading-order coefficient $C$ in the asymptotic relation $\\kappa_2(A) \\sim C h^{-2}$ as $h \\to 0^+$. This is equivalent to finding the limit:\n$$\nC = \\lim_{h\\to 0^+} \\frac{\\kappa_2(A)}{h^{-2}} = \\lim_{h\\to 0^+} h^2 \\kappa_2(A)\n$$\nSubstituting our expression for $\\kappa_2(A)$:\n$$\nC = \\lim_{h\\to 0^+} h^2 \\cot^2\\left(\\frac{\\pi h}{2}\\right)\n$$\nLet $x = \\frac{\\pi h}{2}$. As $h \\to 0^+$, we have $x \\to 0^+$. We can write $h = \\frac{2x}{\\pi}$. The limit becomes:\n$$\nC = \\lim_{x\\to 0^+} \\left(\\frac{2x}{\\pi}\\right)^2 \\cot^2(x) = \\frac{4}{\\pi^2} \\lim_{x\\to 0^+} x^2 \\frac{\\cos^2(x)}{\\sin^2(x)}\n$$\nThis limit can be separated:\n$$\nC = \\frac{4}{\\pi^2} \\left(\\lim_{x\\to 0^+} \\frac{x^2}{\\sin^2(x)}\\right) \\left(\\lim_{x\\to 0^+} \\cos^2(x)\\right)\n$$\nUsing the fundamental trigonometric limit $\\lim_{x\\to 0} \\frac{\\sin x}{x} = 1$, we have:\n$$\n\\lim_{x\\to 0^+} \\frac{x^2}{\\sin^2(x)} = \\left(\\lim_{x\\to 0^+} \\frac{x}{\\sin x}\\right)^2 = 1^2 = 1\n$$\nAnd for the cosine term:\n$$\n\\lim_{x\\to 0^+} \\cos^2(x) = (\\cos(0))^2 = 1^2 = 1\n$$\nSubstituting these values back:\n$$\nC = \\frac{4}{\\pi^2} \\cdot 1 \\cdot 1 = \\frac{4}{\\pi^2}\n$$\nThe leading-order coefficient $C$ is $\\frac{4}{\\pi^2}$.",
            "answer": "$$\\boxed{\\frac{4}{\\pi^2}}$$"
        }
    ]
}