{
    "hands_on_practices": [
        {
            "introduction": "The cornerstone of the Ritz method is the principle that the solution to a boundary value problem minimizes an associated energy functional. Before building complex approximations, it is crucial to develop an intuition for this functional. This first exercise provides a direct, hands-on calculation of the energy for a simple 1D problem using a single, predetermined trial function . By evaluating the integral terms explicitly, you will see how the total energy is composed of the internal strain energy and the work potential of the external load, providing a tangible link between the physics and the mathematics.",
            "id": "3384633",
            "problem": "Consider the one-dimensional second-order linear elliptic Partial Differential Equation (PDE) on the open interval $\\Omega=(0,1)$ with homogeneous Dirichlet boundary conditions,\n$$ -(a(x) u^{\\prime}(x))^{\\prime}=f(x),\\qquad u(0)=0,\\quad u(1)=0, $$\nwhere $a(x)$ is a strictly positive coefficient and $f(x)$ is a given source. The energy minimization principle states that the solution can be characterized as the minimizer of an appropriate energy functional over the Sobolev space $H^{1}_{0}(\\Omega)$.\n\nUsing the energy minimization framework and the Ritz method, perform the following for the specific data $a(x)=1$ and $f(x)=x$:\n1. Starting from the strong form of the PDE and the principle of stationary potential energy, write down the energy functional $J(v)$ to be minimized over $v \\in H^{1}_{0}(\\Omega)$ that corresponds to the given PDE and data, ensuring consistency with the boundary conditions.\n2. Using the single-function trial $u(x)=x(1-x)$, which satisfies $u(0)=u(1)=0$, evaluate $J(u)$ exactly by carrying out all required integrals in closed form.\n3. Briefly interpret the two contributions to $J(u)$ in terms of stored internal energy and external work input, as they arise from the underlying variational structure.\n\nExpress the final value of $J(u)$ as an exact number. No rounding is required.",
            "solution": "The problem requires the application of the energy minimization principle and the Ritz method to a specific one-dimensional boundary value problem. We begin by validating the problem statement.\n\n### Step 1: Extract Givens\n- **PDE:** $-(a(x) u^{\\prime}(x))^{\\prime}=f(x)$\n- **Domain:** $\\Omega=(0,1)$\n- **Boundary Conditions:** $u(0)=0, u(1)=0$ (homogeneous Dirichlet)\n- **Coefficient:** $a(x)$ is a strictly positive function.\n- **Source:** $f(x)$ is a given source function.\n- **Function Space:** The solution lies in the Sobolev space $H^{1}_{0}(\\Omega)$.\n- **Specific Data:** $a(x)=1$ and $f(x)=x$.\n- **Trial Function:** $u(x)=x(1-x)$.\n- **Tasks:** 1. Derive the energy functional $J(v)$. 2. Evaluate $J(u)$ for the given trial function. 3. Interpret the physical meaning of the terms in $J(u)$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically and mathematically sound. It describes the standard variational or energy minimization approach to solving a one-dimensional Poisson equation, a cornerstone of numerical PDE theory and computational mechanics. The provided data ($a(x)=1$, $f(x)=x$) are well-defined. The specified function space $H^{1}_{0}(\\Omega)$ is the correct setting for this problem. The trial function satisfies the required boundary conditions. The problem is self-contained, unambiguous, and well-posed. No flaws are identified.\n\n### Step 3: Verdict and Action\nThe problem is valid. We proceed with the solution.\n\n### Part 1: Derivation of the Energy Functional\n\nThe principle of stationary potential energy states that the solution $u(x)$ to the boundary value problem is the function that minimizes a total energy functional $J(v)$ over the space of admissible functions. An admissible function $v(x)$ must be sufficiently smooth and satisfy the essential boundary conditions, which in this case are $v(0)=0$ and $v(1)=0$. The appropriate function space is $H^{1}_{0}(\\Omega)$, the space of functions with square-integrable first derivatives that are zero at the boundary.\n\nTo find the functional $J(v)$ whose minimizer satisfies the strong form of the PDE, $-(a(x) u^{\\prime}(x))^{\\prime}=f(x)$, we first derive the weak form. We multiply the PDE by an arbitrary test function $v \\in H^{1}_{0}(\\Omega)$ and integrate over the domain $\\Omega=(0,1)$:\n$$ -\\int_{0}^{1} (a(x) u^{\\prime}(x))^{\\prime} v(x) \\,dx = \\int_{0}^{1} f(x) v(x) \\,dx $$\nApplying integration by parts to the left-hand side, we get:\n$$ \\int_{0}^{1} a(x) u^{\\prime}(x) v^{\\prime}(x) \\,dx - \\left[ a(x) u^{\\prime}(x) v(x) \\right]_{0}^{1} = \\int_{0}^{1} f(x) v(x) \\,dx $$\nSince $v \\in H^{1}_{0}(\\Omega)$, we have $v(0)=0$ and $v(1)=0$. Therefore, the boundary term vanishes, leading to the weak form: Find $u \\in H^{1}_{0}(\\Omega)$ such that\n$$ \\int_{0}^{1} a(x) u^{\\prime}(x) v^{\\prime}(x) \\,dx = \\int_{0}^{1} f(x) v(x) \\,dx \\quad \\forall v \\in H^{1}_{0}(\\Omega) $$\nThis equation is the Euler-Lagrange equation for the energy functional $J(v)$ defined as:\n$$ J(v) = \\frac{1}{2} \\int_{0}^{1} a(x) (v^{\\prime}(x))^{2} \\,dx - \\int_{0}^{1} f(x) v(x) \\,dx $$\nFor the specific data given, $a(x)=1$ and $f(x)=x$, the functional to be minimized is:\n$$ J(v) = \\frac{1}{2} \\int_{0}^{1} (v^{\\prime}(x))^{2} \\,dx - \\int_{0}^{1} x v(x) \\,dx $$\n\n### Part 2: Evaluation of the Energy Functional for the Trial Function\n\nThe Ritz method seeks an approximate solution by minimizing the functional $J(v)$ over a finite-dimensional subspace of $H^{1}_{0}(\\Omega)$. In this case, we use a single-function approximation with the trial function $u(x) = x(1-x)$, which can also be written as $u(x) = x - x^{2}$. We first confirm it is an admissible function: $u(0)=0(1-0)=0$ and $u(1)=1(1-1)=0$, so it satisfies the required boundary conditions.\n\nNext, we compute the derivative of the trial function:\n$ u^{\\prime}(x) = \\frac{d}{dx}(x - x^{2}) = 1 - 2x $\nNow we evaluate the two integrals in the expression for $J(u)$.\n\nThe first integral is:\n$$ \\int_{0}^{1} (u^{\\prime}(x))^{2} \\,dx = \\int_{0}^{1} (1-2x)^{2} \\,dx = \\int_{0}^{1} (1 - 4x + 4x^{2}) \\,dx $$\n$$ = \\left[ x - 4\\frac{x^{2}}{2} + 4\\frac{x^{3}}{3} \\right]_{0}^{1} = \\left[ x - 2x^{2} + \\frac{4}{3}x^{3} \\right]_{0}^{1} $$\n$$ = \\left( 1 - 2(1)^{2} + \\frac{4}{3}(1)^{3} \\right) - (0) = 1 - 2 + \\frac{4}{3} = -1 + \\frac{4}{3} = \\frac{1}{3} $$\n\nThe second integral is:\n$$ \\int_{0}^{1} x u(x) \\,dx = \\int_{0}^{1} x(x - x^{2}) \\,dx = \\int_{0}^{1} (x^{2} - x^{3}) \\,dx $$\n$$ = \\left[ \\frac{x^{3}}{3} - \\frac{x^{4}}{4} \\right]_{0}^{1} = \\left( \\frac{1^{3}}{3} - \\frac{1^{4}}{4} \\right) - (0) = \\frac{1}{3} - \\frac{1}{4} = \\frac{4-3}{12} = \\frac{1}{12} $$\n\nFinally, we substitute these results into the expression for $J(u)$:\n$$ J(u) = \\frac{1}{2} \\int_{0}^{1} (u^{\\prime}(x))^{2} \\,dx - \\int_{0}^{1} x u(x) \\,dx $$\n$$ J(u) = \\frac{1}{2} \\left( \\frac{1}{3} \\right) - \\left( \\frac{1}{12} \\right) = \\frac{1}{6} - \\frac{1}{12} = \\frac{2}{12} - \\frac{1}{12} = \\frac{1}{12} $$\n\n### Part 3: Interpretation of Contributions\n\nThe energy functional $J(u)$ represents the total potential energy of the physical system described by the PDE. It consists of two terms with distinct physical interpretations.\n\n1.  **Internal Energy:** The first term, $\\frac{1}{2} \\int_{0}^{1} a(x) (u^{\\prime}(x))^{2} \\,dx$, represents the internal strain energy stored in the system due to its deformation. In a mechanical context (e.g., a stretched string or a deflected beam), $u^{\\prime}(x)$ is the strain, and $a(x)$ is related to the material's stiffness. The integrand is the strain energy density, and its integral over the domain gives the total stored internal energy. For our trial function, this value is $\\frac{1}{2} \\times \\frac{1}{3} = \\frac{1}{6}$.\n\n2.  **External Work Potential:** The second term, $-\\int_{0}^{1} f(x) u(x) \\,dx$, represents the potential energy of the external loads. The integral $\\int_{0}^{1} f(x) u(x) \\,dx$ is the work done by the distributed external force $f(x)$ acting through the displacement $u(x)$. The potential of the conservative external force field is the negative of the work done by it. For our trial function, the work done by the external load is $\\frac{1}{12}$, so the external work potential is $-\\frac{1}{12}$.\n\nThe system seeks a stable equilibrium by adopting a configuration $u(x)$ that minimizes the total potential energy $J(u) = (\\text{Internal Energy}) - (\\text{Work Done by External Force})$. The value $J(u) = \\frac{1}{12}$ is the total potential energy of the system for the approximate displacement field $u(x)=x(1-x)$.",
            "answer": "$$\\boxed{\\frac{1}{12}}$$"
        },
        {
            "introduction": "While evaluating the energy for a single function is insightful, the true power of the Ritz method lies in searching for the best approximation within a flexible, finite-dimensional space. This practice takes the crucial next step by showing how minimizing the energy functional over a space spanned by basis functions transforms the continuous PDE into a system of linear algebraic equations . You will assemble the stiffness matrix and load vector by hand using standard piecewise linear 'hat' functions, revealing the foundational mechanics of the finite element method.",
            "id": "3384616",
            "problem": "Consider the boundary value problem for the one-dimensional Poisson equation on the open interval $\\Omega=(0,1)$ with homogeneous Dirichlet boundary conditions. The associated energy functional is\n$$\n\\mathcal{J}(u)=\\frac{1}{2}\\int_{0}^{1} a\\,|u'(x)|^{2}\\,dx-\\int_{0}^{1} f(x)\\,u(x)\\,dx,\n$$\nwhere $a=1$ and $f(x)=1$. The Ritz method seeks $u_{h} \\in V_{h}\\subset H_{0}^{1}(0,1)$ that minimizes $\\mathcal{J}(u)$ over the finite-dimensional subspace $V_{h}$.\n\nLet the domain be partitioned uniformly into $3$ subintervals by the nodes $x_{0}=0$, $x_{1}=\\frac{1}{3}$, $x_{2}=\\frac{2}{3}$, $x_{3}=1$. Let $\\phi_{1}$ and $\\phi_{2}$ be the nodal hat functions associated with $x_{1}$ and $x_{2}$, respectively, so that $\\phi_{i}(x_{j})=\\delta_{ij}$ for $i,j\\in\\{1,2\\}$ and $\\phi_{i}(0)=\\phi_{i}(1)=0$. Define the trial space $V_{h}=\\mathrm{span}\\{\\phi_{1},\\phi_{2}\\}$ and the Ritz ansatz $u_{h}(x)=c_{1}\\phi_{1}(x)+c_{2}\\phi_{2}(x)$ with unknown coefficients $c_{1}$ and $c_{2}$.\n\nStarting from the energy functional $\\mathcal{J}(u)$ and the definition of $V_{h}$, derive the discrete algebraic system for $(c_{1},c_{2})$ by enforcing the vanishing of the first variation of $\\mathcal{J}$ restricted to $V_{h}$ in the directions of $\\phi_{1}$ and $\\phi_{2}$. Assemble explicitly the resulting stiffness matrix and load vector by evaluating the necessary integrals using the piecewise definitions of $\\phi_{1}$ and $\\phi_{2}$. Then solve the system for $(c_{1},c_{2})$ and report the coefficient vector as a row matrix. Express your final answer in exact form. No rounding is required.",
            "solution": "The problem statement is evaluated for validity.\n\n### Step 1: Extract Givens\n- **Governing Equation**: One-dimensional Poisson equation on the open interval $\\Omega=(0,1)$.\n- **Boundary Conditions**: Homogeneous Dirichlet boundary conditions, $u(0)=0$ and $u(1)=0$.\n- **Energy Functional**: $\\mathcal{J}(u)=\\frac{1}{2}\\int_{0}^{1} a\\,|u'(x)|^{2}\\,dx-\\int_{0}^{1} f(x)\\,u(x)\\,dx$.\n- **Constants**: $a=1$, $f(x)=1$.\n- **Method**: The Ritz method.\n- **Domain Partition**: Uniform partition into $3$ subintervals by nodes $x_{0}=0$, $x_{1}=\\frac{1}{3}$, $x_{2}=\\frac{2}{3}$, $x_{3}=1$. The subinterval length is $h=\\frac{1}{3}$.\n- **Trial Space**: $V_{h}=\\mathrm{span}\\{\\phi_{1},\\phi_{2}\\}$, where $\\phi_{1}$ and $\\phi_{2}$ are the nodal hat functions associated with the interior nodes $x_{1}$ and $x_{2}$, respectively. These basis functions satisfy $\\phi_{i}(x_{j})=\\delta_{ij}$ for $i,j\\in\\{1,2\\}$ and $\\phi_{i}(0)=\\phi_{i}(1)=0$.\n- **Ritz Ansatz**: The approximate solution is $u_{h}(x)=c_{1}\\phi_{1}(x)+c_{2}\\phi_{2}(x)$.\n- **Task**: Derive and solve the discrete algebraic system for the coefficient vector $(c_{1},c_{2})$.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientifically Grounded**: The problem describes the application of the Ritz method, a specific formulation of the finite element method, to a classic boundary value problem (the 1D Poisson equation). The energy functional, the choice of basis functions (piecewise linear \"hat\" functions), and the overall procedure are standard and fundamental concepts in the field of numerical analysis for partial differential equations. The setup is entirely consistent with established mathematical theory.\n2.  **Well-Posed**: The problem is well-posed. The Ritz-Galerkin method applied to this elliptic boundary value problem is guaranteed to yield a unique solution because the bilinear form associated with the operator is coercive and continuous on the Sobolev space $H_{0}^{1}(0,1)$, which ensures the resulting stiffness matrix is symmetric and positive-definite, and therefore invertible.\n3.  **Objective**: The problem is stated in precise, unambiguous mathematical language. All terms are standard and well-defined within the context.\n4.  **Completeness**: All necessary information (the functional, domain, partition, basis functions, and constants) is provided.\n\n### Step 3: Verdict and Action\nThe problem is valid as it is mathematically sound, well-posed, and completely specified. A solution will be derived.\n\nThe Ritz method seeks a function $u_{h} \\in V_{h}$ that minimizes the energy functional $\\mathcal{J}(u)$. Given the ansatz $u_{h}(x)=c_{1}\\phi_{1}(x)+c_{2}\\phi_{2}(x)$, the functional becomes a function of the coefficients $c_{1}$ and $c_{2}$:\n$$\n\\mathcal{J}(c_{1}, c_{2}) = \\frac{1}{2}\\int_{0}^{1} a \\left| c_{1}\\phi_{1}'(x) + c_{2}\\phi_{2}'(x) \\right|^{2} dx - \\int_{0}^{1} f(x) \\left( c_{1}\\phi_{1}(x) + c_{2}\\phi_{2}(x) \\right) dx.\n$$\nThe minimum of this quadratic function is found by setting its partial derivatives with respect to $c_{1}$ and $c_{2}$ to zero:\n$$\n\\frac{\\partial \\mathcal{J}}{\\partial c_{1}} = \\int_{0}^{1} a \\left( c_{1}\\phi_{1}'(x) + c_{2}\\phi_{2}'(x) \\right) \\phi_{1}'(x) dx - \\int_{0}^{1} f(x) \\phi_{1}(x) dx = 0\n$$\n$$\n\\frac{\\partial \\mathcal{J}}{\\partial c_{2}} = \\int_{0}^{1} a \\left( c_{1}\\phi_{1}'(x) + c_{2}\\phi_{2}'(x) \\right) \\phi_{2}'(x) dx - \\int_{0}^{1} f(x) \\phi_{2}(x) dx = 0\n$$\nThis can be written as a linear system $A\\mathbf{c} = \\mathbf{b}$, where $\\mathbf{c} = \\begin{pmatrix} c_{1} \\\\ c_{2} \\end{pmatrix}$, the stiffness matrix $A$ has entries $A_{ij} = \\int_{0}^{1} a \\phi_{j}'(x)\\phi_{i}'(x) dx$, and the load vector $\\mathbf{b}$ has entries $b_{i} = \\int_{0}^{1} f(x) \\phi_{i}(x) dx$.\n\nFirst, we define the basis functions and their derivatives. The mesh spacing is $h = x_{1}-x_{0} = \\frac{1}{3}$.\nThe hat function $\\phi_{1}(x)$ associated with node $x_{1}=\\frac{1}{3}$ is:\n$$\n\\phi_{1}(x) = \\begin{cases} \\frac{x-x_{0}}{x_{1}-x_{0}} = \\frac{x}{1/3} = 3x & x \\in [0, 1/3] \\\\ \\frac{x_{2}-x}{x_{2}-x_{1}} = \\frac{2/3-x}{1/3} = 2 - 3x & x \\in [1/3, 2/3] \\\\ 0 & \\text{otherwise} \\end{cases}\n$$\nIts derivative is:\n$$\n\\phi_{1}'(x) = \\begin{cases} 3 & x \\in (0, 1/3) \\\\ -3 & x \\in (1/3, 2/3) \\\\ 0 & \\text{otherwise} \\end{cases}\n$$\nThe hat function $\\phi_{2}(x)$ associated with node $x_{2}=\\frac{2}{3}$ is:\n$$\n\\phi_{2}(x) = \\begin{cases} \\frac{x-x_{1}}{x_{2}-x_{1}} = \\frac{x-1/3}{1/3} = 3x - 1 & x \\in [1/3, 2/3] \\\\ \\frac{x_{3}-x}{x_{3}-x_{2}} = \\frac{1-x}{1/3} = 3 - 3x & x \\in [2/3, 1] \\\\ 0 & \\text{otherwise} \\end{cases}\n$$\nIts derivative is:\n$$\n\\phi_{2}'(x) = \\begin{cases} 3 & x \\in (1/3, 2/3) \\\\ -3 & x \\in (2/3, 1) \\\\ 0 & \\text{otherwise} \\end{cases}\n$$\nNow, we compute the entries of the stiffness matrix $A$ with $a=1$:\n$A_{11} = \\int_{0}^{1} |\\phi_{1}'(x)|^{2} dx = \\int_{0}^{1/3} (3)^{2} dx + \\int_{1/3}^{2/3} (-3)^{2} dx = 9 \\cdot \\frac{1}{3} + 9 \\cdot \\frac{1}{3} = 3+3 = 6.$\n$A_{22} = \\int_{0}^{1} |\\phi_{2}'(x)|^{2} dx = \\int_{1/3}^{2/3} (3)^{2} dx + \\int_{2/3}^{1} (-3)^{2} dx = 9 \\cdot \\frac{1}{3} + 9 \\cdot \\frac{1}{3} = 3+3 = 6.$\nThe off-diagonal terms are identical by symmetry, $A_{12}=A_{21}$. The product $\\phi_{1}'(x)\\phi_{2}'(x)$ is non-zero only on the interval $(1/3, 2/3)$:\n$A_{12} = \\int_{0}^{1} \\phi_{1}'(x)\\phi_{2}'(x) dx = \\int_{1/3}^{2/3} (-3)(3) dx = \\int_{1/3}^{2/3} -9 dx = -9 \\cdot \\frac{1}{3} = -3.$\nThus, the stiffness matrix is $A = \\begin{pmatrix} 6 & -3 \\\\ -3 & 6 \\end{pmatrix}$.\n\nNext, we compute the entries of the load vector $\\mathbf{b}$ with $f(x)=1$:\n$b_{i} = \\int_{0}^{1} \\phi_{i}(x) dx$. This integral is the area of the triangular hat function, which is $\\frac{1}{2} \\times \\text{base} \\times \\text{height} = \\frac{1}{2} \\times (2h) \\times 1 = h = \\frac{1}{3}$. We verify this by direct integration for $b_1$:\n$$\nb_{1} = \\int_{0}^{1} \\phi_{1}(x) dx = \\int_{0}^{1/3} 3x \\,dx + \\int_{1/3}^{2/3} (2-3x) \\,dx = \\left[\\frac{3x^{2}}{2}\\right]_{0}^{1/3} + \\left[2x-\\frac{3x^{2}}{2}\\right]_{1/3}^{2/3}\n$$\n$b_1 = \\left(\\frac{3}{2}\\frac{1}{9}\\right) + \\left( \\left(\\frac{4}{3}-\\frac{3}{2}\\frac{4}{9}\\right) - \\left(\\frac{2}{3}-\\frac{3}{2}\\frac{1}{9}\\right) \\right) = \\frac{1}{6} + \\left( \\left(\\frac{4}{3}-\\frac{2}{3}\\right) - \\left(\\frac{2}{3}-\\frac{1}{6}\\right) \\right) = \\frac{1}{6} + \\left( \\frac{2}{3} - \\frac{3}{6} \\right) = \\frac{1}{6} + \\frac{1}{6} = \\frac{2}{6} = \\frac{1}{3}.$\nBy symmetry of the domain and basis functions, $b_{2} = \\int_{0}^{1} \\phi_{2}(x) dx = \\frac{1}{3}$.\nThus, the load vector is $\\mathbf{b} = \\begin{pmatrix} 1/3 \\\\ 1/3 \\end{pmatrix}$.\n\nWe now solve the linear system $A\\mathbf{c}=\\mathbf{b}$:\n$$\n\\begin{pmatrix} 6 & -3 \\\\ -3 & 6 \\end{pmatrix} \\begin{pmatrix} c_{1} \\\\ c_{2} \\end{pmatrix} = \\begin{pmatrix} 1/3 \\\\ 1/3 \\end{pmatrix}\n$$\nThis corresponds to the equations:\n1. $6c_{1} - 3c_{2} = \\frac{1}{3}$\n2. $-3c_{1} + 6c_{2} = \\frac{1}{3}$\nBy inspection, the problem's symmetry suggests $c_{1}=c_{2}$. Substituting $c_{1}=c_{2}=c$ into the first equation:\n$6c - 3c = \\frac{1}{3} \\implies 3c = \\frac{1}{3} \\implies c = \\frac{1}{9}$.\nThus, $c_{1} = \\frac{1}{9}$ and $c_{2} = \\frac{1}{9}$.\nAlternatively, using matrix inversion:\n$\\det(A) = (6)(6) - (-3)(-3) = 36-9=27$.\n$A^{-1} = \\frac{1}{27}\\begin{pmatrix} 6 & 3 \\\\ 3 & 6 \\end{pmatrix}$.\n$$\n\\mathbf{c} = A^{-1}\\mathbf{b} = \\frac{1}{27}\\begin{pmatrix} 6 & 3 \\\\ 3 & 6 \\end{pmatrix} \\begin{pmatrix} 1/3 \\\\ 1/3 \\end{pmatrix} = \\frac{1}{27}\\begin{pmatrix} 6(1/3)+3(1/3) \\\\ 3(1/3)+6(1/3) \\end{pmatrix} = \\frac{1}{27}\\begin{pmatrix} 2+1 \\\\ 1+2 \\end{pmatrix} = \\frac{1}{27}\\begin{pmatrix} 3 \\\\ 3 \\end{pmatrix} = \\begin{pmatrix} 1/9 \\\\ 1/9 \\end{pmatrix}.\n$$\nThe coefficient vector is $(c_{1}, c_{2}) = (1/9, 1/9)$. The problem asks for this to be reported as a row matrix.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix} \\frac{1}{9} & \\frac{1}{9} \\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "The energy minimization framework is not limited to solving source problems; it is also a powerful tool for approximating eigenvalues and eigenfunctions via the Rayleigh-Ritz method. This computational exercise extends the principle to a 2D eigenvalue problem by minimizing the Rayleigh quotient, which represents the ratio of potential energy to a kinetic energy analogue . By implementing this method, you will learn to construct the generalized matrix eigenproblem $K\\mathbf{c}=\\lambda M\\mathbf{c}$ using numerical quadrature and observe how enriching the polynomial trial space leads to more accurate approximations of the eigen-spectrum.",
            "id": "3384592",
            "problem": "Consider the symmetric, coercive second-order Partial Differential Equation (PDE) eigenvalue problem on the square domain $\\Omega=(0,1)\\times(0,1)$ with homogeneous Dirichlet boundary conditions. Let the coefficient matrix field be $A(x,y)=\\mathrm{diag}(a_x(x),a_y(y))$ with scalar weights $a_x(x)>0$ and $a_y(y)>0$, and let the density be $\\rho(x,y)>0$. The weak eigenproblem seeks nontrivial $u\\in H_0^1(\\Omega)$ and $\\lambda\\in\\mathbb{R}$ such that\n$$\n\\int_{\\Omega} A(x,y)\\nabla u\\cdot\\nabla v\\,dx\\,dy = \\lambda \\int_{\\Omega} \\rho(x,y)\\,u\\,v\\,dx\\,dy\\quad\\text{for all }v\\in H_0^1(\\Omega),\n$$\nwhich equivalently characterizes eigenpairs through minimization of the Rayleigh quotient\n$$\nR(u)=\\frac{\\int_{\\Omega} A(x,y)\\nabla u\\cdot\\nabla u\\,dx\\,dy}{\\int_{\\Omega} \\rho(x,y)\\,u^2\\,dx\\,dy},\\quad u\\neq 0.\n$$\n\nIn the Ritz method, one restricts to a finite-dimensional trial subspace $V_h\\subset H_0^1(\\Omega)$ and seeks approximate eigenpairs $(\\lambda_h,u_h)$ by minimizing $R(u)$ over $u\\in V_h\\setminus\\{0\\}$, which yields a generalized matrix eigenproblem derived from the bilinear forms\n$$\na(u,v)=\\int_{\\Omega} A(x,y)\\nabla u\\cdot\\nabla v\\,dx\\,dy,\n$$\n$$\nm(u,v)=\\int_{\\Omega} \\rho(x,y)\\,u\\,v\\,dx\\,dy.\n$$\nThis problem asks you to implement the Ritz method for a family of polynomial trial spaces and to quantify how enrichment of the trial space affects clustered eigenvalues, their gaps, and energy level separation.\n\nYou must use the following mathematically and numerically precise setting:\n\n- Domain: $\\Omega=(0,1)\\times(0,1)$.\n- Boundary condition: $u=0$ on $\\partial\\Omega$ (homogeneous Dirichlet).\n- Coefficients: $a_x(x)=1+\\varepsilon_x\\sin(2\\pi x)$, $a_y(y)=1+\\varepsilon_y\\cos(2\\pi y)$, and $\\rho(x,y)=1$.\n- Trial spaces: For a given nonnegative integer degree $p$, let the subspace $V_p$ be spanned by basis functions\n$$\n\\phi_{i,j}(x,y)=b_x(x)\\,b_y(y)\\,x^i\\,y^j,\\quad b_x(x)=x(1-x),\\quad b_y(y)=y(1-y),\n$$\nfor all integer pairs $(i,j)$ such that $i\\ge 0$, $j\\ge 0$, and $i+j\\le p$. These basis functions satisfy the boundary condition by construction. The enrichment is realized by increasing $p$.\n\nYour program must:\n\n1. Construct the stiffness matrix $K\\in\\mathbb{R}^{N\\times N}$ and mass matrix $M\\in\\mathbb{R}^{N\\times N}$ associated with $V_p$ using the bilinear forms $a(\\cdot,\\cdot)$ and $m(\\cdot,\\cdot)$, where $N=\\dim(V_p)$. Perform numerical integration using tensor-product Gaussâ€“Legendre quadrature on $[0,1]$ for each coordinate with at least $120$ points per dimension. Explicitly, the quadrature must be performed with nodes mapped from $[-1,1]$ to $[0,1]$ and the weights scaled by the Jacobian factor.\n2. Solve the generalized symmetric eigenproblem $K\\,\\mathbf{c}=\\lambda\\,M\\,\\mathbf{c}$ and compute the four smallest eigenvalues $\\lambda_1\\le \\lambda_2\\le \\lambda_3\\le \\lambda_4$ associated with the trial space $V_p$ for the given $(\\varepsilon_x,\\varepsilon_y)$.\n3. Treat the pair $(\\lambda_2,\\lambda_3)$ as a potential cluster caused by near-separable modes and anisotropy; compute the following quantitative metrics:\n   - Cluster width $w=\\lambda_3-\\lambda_2$.\n   - Lower separation $s_b=\\lambda_2-\\lambda_1$ (distance from the first level to the cluster).\n   - Upper separation $s_a=\\lambda_4-\\lambda_3$ (distance from the cluster to the next level).\n4. Analyze enrichment by repeating the computation for multiple degrees $p$ and fixed $(\\varepsilon_x,\\varepsilon_y)$, and additionally test the isotropic case $(\\varepsilon_x,\\varepsilon_y)=(0,0)$ to probe exact degeneracy and energy separation.\n\nTest suite specification:\n\n- Use the following five test cases, each defined by $(p,\\varepsilon_x,\\varepsilon_y)$:\n  - Case A: $(2,\\,0.02,\\,0.05)$.\n  - Case B: $(3,\\,0.02,\\,0.05)$.\n  - Case C: $(4,\\,0.02,\\,0.05)$.\n  - Case D: $(6,\\,0.02,\\,0.05)$.\n  - Case E: $(6,\\,0.00,\\,0.00)$.\n\nFinal output format:\n\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the fixed order\n$$\n[w_A, s_{b,A}, s_{a,A},\\; w_B, s_{b,B}, s_{a,B},\\; w_C, s_{b,C}, s_{a,C},\\; w_D, s_{b,D}, s_{a,D},\\; w_E, s_{b,E}, s_{a,E}],\n$$\nwhere each floating-point number is rounded to $8$ decimal places.\n- No other text should be printed.\n- There are no physical units, and numerical angles are not used; all outputs are dimensionless real numbers.",
            "solution": "The problem is validated as scientifically grounded, well-posed, and objective. It is a standard problem in the numerical analysis of partial differential equations (PDEs) and presents a complete and consistent setup for the application of the Ritz method.\n\nThe core task is to approximate the smallest eigenvalues of the elliptic PDE eigenproblem defined by the weak formulation: find a non-trivial function $u \\in H_0^1(\\Omega)$ and a scalar $\\lambda \\in \\mathbb{R}$ such that\n$$\na(u,v) = \\lambda \\, m(u,v) \\quad \\forall v \\in H_0^1(\\Omega),\n$$\nwhere a(u,v) is the energy inner product and m(u,v) is the mass inner product. The domain is the unit square $\\Omega=(0,1) \\times (0,1)$, and the bilinear forms are given by\n$$\na(u,v) = \\int_{\\Omega} A(x,y)\\nabla u \\cdot \\nabla v\\,dx\\,dy = \\int_0^1 \\int_0^1 \\left( a_x(x)\\frac{\\partial u}{\\partial x}\\frac{\\partial v}{\\partial x} + a_y(y)\\frac{\\partial u}{\\partial y}\\frac{\\partial v}{\\partial y} \\right) dx\\,dy\n$$\n$$\nm(u,v) = \\int_{\\Omega} \\rho(x,y)\\,u\\,v\\,dx\\,dy = \\int_0^1 \\int_0^1 u\\,v\\,dx\\,dy,\n$$\nwith coefficients $a_x(x)=1+\\varepsilon_x\\sin(2\\pi x)$, $a_y(y)=1+\\varepsilon_y\\cos(2\\pi y)$, and $\\rho(x,y)=1$. For the given small parameters $\\varepsilon_x$ and $\\varepsilon_y$, the coefficients $a_x(x)$ and $a_y(y)$ are strictly positive, ensuring the operator is elliptic and the bilinear form $a(\\cdot,\\cdot)$ is coercive.\n\nThe Ritz method approximates the solution by restricting the problem to a finite-dimensional trial subspace $V_p \\subset H_0^1(\\Omega)$. An approximate solution $u_h \\in V_p$ is expressed as a linear combination of basis functions $\\{\\phi_k\\}_{k=1}^N$ that span $V_p$:\n$$\nu_h(x,y) = \\sum_{k=1}^N c_k \\phi_k(x,y),\n$$\nwhere $\\mathbf{c} = (c_1, \\dots, c_N)^T$ is a vector of unknown coefficients. Substituting this expansion into the weak formulation and choosing the test functions $v$ to be the basis functions $\\phi_l$ themselves (this is the Galerkin principle), we obtain a generalized matrix eigenvalue problem:\n$$\n\\sum_{k=1}^N a(\\phi_k, \\phi_l) c_k = \\lambda \\sum_{k=1}^N m(\\phi_k, \\phi_l) c_k \\quad \\text{for } l=1, \\dots, N.\n$$\nThis is concisely written as $K\\mathbf{c} = \\lambda M\\mathbf{c}$, where $K$ is the stiffness matrix and $M$ is the mass matrix, with entries:\n$$\nK_{lk} = a(\\phi_k, \\phi_l), \\quad M_{lk} = m(\\phi_k, \\phi_l).\n$$\nThe problem specifies a trial space $V_p$ spanned by polynomials of total degree at most $p$, modified to satisfy the homogeneous Dirichlet boundary conditions. The basis functions are\n$$\n\\phi_{i,j}(x,y) = b_x(x)b_y(y)x^i y^j = (x-x^2)(y-y^2)x^i y^j = (x^{i+1}-x^{i+2})(y^{j+1}-y^{j+2}),\n$$ for non-negative integers $i, j$ such that $i+j \\le p$. The dimension of this space is $N = (p+1)(p+2)/2$. These basis functions have a separable structure, which is a crucial feature for efficient computation. Let $\\phi_{i,j}(x,y) = f_i(x)g_j(y)$, where $f_i(x) = x^{i+1}-x^{i+2}$ and $g_j(y) = y^{j+1}-y^{j+2}$. The gradients are:\n$$\n\\frac{\\partial \\phi_{i,j}}{\\partial x} = f'_i(x) g_j(y) = \\left((i+1)x^i - (i+2)x^{i+1}\\right)(y^{j+1}-y^{j+2})\n$$\n$$\n\\frac{\\partial \\phi_{i,j}}{\\partial y} = f_i(x) g'_j(y) = (x^{i+1}-x^{i+2})\\left((j+1)y^j - (j+2)y^{j+1}\\right)\n$$\nTo construct the matrices $K$ and $M$, we must compute the integrals defining their entries. We employ numerical quadrature, specifically a tensor-product Gauss-Legendre rule with $N_q=120$ points in each dimension, mapped to the interval $[0,1]$.\n\nThe separable nature of the basis functions and the diagonal structure of the coefficient tensor $A(x,y)$ allow for a highly efficient assembly of the matrices. Consider the entry $M_{(i_1,j_1),(i_2,j_2)}$ corresponding to basis functions $\\phi_{i_1,j_1}$ and $\\phi_{i_2,j_2}$:\n$$\nM_{(i_1,j_1),(i_2,j_2)} = \\int_0^1 \\int_0^1 [f_{i_1}(x)g_{j_1}(y)][f_{i_2}(x)g_{j_2}(y)] \\,dx\\,dy = \\left(\\int_0^1 f_{i_1}(x)f_{i_2}(x) dx\\right) \\left(\\int_0^1 g_{j_1}(y)g_{j_2}(y) dy\\right).\n$$\nSimilarly, for the stiffness matrix entry $K_{(i_1,j_1),(i_2,j_2)}$:\n$$\nK_{(i_1,j_1),(i_2,j_2)} = \\int_0^1 \\int_0^1 \\left( a_x(x) \\frac{\\partial \\phi_{i_1,j_1}}{\\partial x} \\frac{\\partial \\phi_{i_2,j_2}}{\\partial x} + a_y(y) \\frac{\\partial \\phi_{i_1,j_1}}{\\partial y} \\frac{\\partial \\phi_{i_2,j_2}}{\\partial y} \\right) dx\\,dy\n$$\n$$\n= \\left(\\int_0^1 a_x(x)f'_{i_1}(x)f'_{i_2}(x)dx\\right)\\left(\\int_0^1 g_{j_1}(y)g_{j_2}(y)dy\\right) + \\left(\\int_0^1 f_{i_1}(x)f_{i_2}(x)dx\\right)\\left(\\int_0^1 a_y(y)g'_{j_1}(y)g'_{j_2}(y)dy\\right).\n$$\nThis reduces the computation of $N^2$ two-dimensional integrals to the computation of a few sets of one-dimensional integrals involving products of the functions $f_i, f'_i, g_j, g'_j$, which are then combined tensorially. Since $f_i$ and $g_i$ are identical functions of their respective variables, the number of unique 1D integral matrices to pre-compute is small.\n\nThe computational procedure for each test case $(p, \\varepsilon_x, \\varepsilon_y)$ is as follows:\n1.  Generate the list of index pairs $(i,j)$ for the basis functions, with $i+j \\le p$.\n2.  Compute the $N_q$ Gauss-Legendre quadrature nodes and weights for the interval $[0,1]$.\n3.  Pre-compute the 1D integral matrices using numerical quadrature. These matrices store the values of integrals like $\\int_0^1 f_{i_1}f_{i_2}dx$, $\\int_0^1 a_x f'_{i_1}f'_{i_2}dx$, etc., for all relevant indices.\n4.  Assemble the $N \\times N$ matrices $K$ and $M$ using the pre-computed 1D integral values and the tensor product structure described above.\n5.  Solve the generalized symmetric eigenvalue problem $K\\mathbf{c} = \\lambda M\\mathbf{c}$ for the four smallest eigenvalues $\\lambda_1 \\le \\lambda_2 \\le \\lambda_3 \\le \\lambda_4$.\n6.  Calculate the required metrics: cluster width $w = \\lambda_3-\\lambda_2$, lower separation $s_b = \\lambda_2-\\lambda_1$, and upper separation $s_a = \\lambda_4-\\lambda_3$.\n\nIncreasing the polynomial degree $p$ enriches the trial space $V_p$, leading to more accurate eigenvalue approximations that converge from above to the true eigenvalues. The test cases allow for observing this convergence and quantifying the effect of anisotropy (controlled by $\\varepsilon_x, \\varepsilon_y$) on the splitting of otherwise degenerate eigenvalues. For the isotropic case ($\\varepsilon_x = \\varepsilon_y = 0$), the underlying PDE is the standard Laplacian eigenvalue problem, which possesses degenerate eigenvalues (e.g., for modes $(1,2)$ and $(2,1)$). The chosen basis space respects the $x \\leftrightarrow y$ symmetry, so we expect the discrete problem to yield an exact degeneracy, i.e., $\\lambda_2 = \\lambda_3$ and $w=0$. When anisotropy is introduced, this degeneracy is broken, resulting in a cluster of two nearby eigenvalues with $w > 0$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import eigh\nfrom scipy.special import roots_legendre\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the specified test cases.\n    \"\"\"\n\n    test_cases = [\n        (2, 0.02, 0.05),  # Case A\n        (3, 0.02, 0.05),  # Case B\n        (4, 0.02, 0.05),  # Case C\n        (6, 0.02, 0.05),  # Case D\n        (6, 0.00, 0.00),  # Case E\n    ]\n\n    results = []\n    \n    # Pre-calculate quadrature rules once\n    n_quad = 120\n    nodes_m11, weights_m11 = roots_legendre(n_quad)\n    quad_nodes = 0.5 * (nodes_m11 + 1)\n    quad_weights = 0.5 * weights_m11\n\n    for p, eps_x, eps_y in test_cases:\n        metrics = compute_eigenvalue_metrics(p, eps_x, eps_y, quad_nodes, quad_weights)\n        results.extend(metrics)\n\n    # Format the final output string\n    formatted_results = [f\"{val:.8f}\" for val in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\ndef compute_eigenvalue_metrics(p, eps_x, eps_y, quad_nodes, quad_weights):\n    \"\"\"\n    Computes eigenvalue metrics for a given configuration (p, eps_x, eps_y).\n    \"\"\"\n    # 1. Generate basis function indices (i, j) for degree p\n    indices = []\n    for total_degree in range(p + 1):\n        for i in range(total_degree + 1):\n            j = total_degree - i\n            indices.append((i, j))\n    N = len(indices)\n    n_quad = len(quad_nodes)\n    \n    # 2. Precompute 1D basis function values and derivatives at quadrature nodes\n    # For a basis function phi_{i,j}(x,y) = f_i(x) * g_j(y)\n    # f_i(x) = x^(i+1) - x^(i+2)\n    # The functions f and g are identical, so we only need one set of evaluations.\n    f_vals = np.zeros((p + 1, n_quad))\n    df_vals = np.zeros((p + 1, n_quad))\n    \n    for i in range(p + 1):\n        f_vals[i, :] = quad_nodes**(i + 1) - quad_nodes**(i + 2)\n        df_vals[i, :] = (i + 1) * quad_nodes**i - (i + 2) * quad_nodes**(i + 1)\n\n    # 3. Precompute 1D integral matrices using numerical quadrature\n    # These are matrices of size (p+1) x (p+1)\n    \n    # Mass component: integral(f_i * f_j dx)\n    Mx = np.dot(f_vals * quad_weights, f_vals.T)\n\n    # Stiffness components\n    # a_x(x) = 1 + eps_x * sin(2*pi*x)\n    # a_y(y) = 1 + eps_y * cos(2*pi*y)\n    a_x_qvals = 1 + eps_x * np.sin(2 * np.pi * quad_nodes)\n    a_y_qvals = 1 + eps_y * np.cos(2 * np.pi * quad_nodes)\n    \n    # Kx_x = integral(a_x * f'_i * f'_j dx)\n    Kx_x = np.dot(df_vals * quad_weights * a_x_qvals, df_vals.T)\n    \n    # Ky_y = integral(a_y * g'_i * g'_j dy), structurally same as Kx_x\n    Ky_y = np.dot(df_vals * quad_weights * a_y_qvals, df_vals.T)\n            \n    # 4. Assemble full N x N stiffness (K) and mass (M) matrices\n    K = np.zeros((N, N))\n    M = np.zeros((N, N))\n    \n    for k1 in range(N):\n        i1, j1 = indices[k1]\n        for k2 in range(k1, N): # Exploit symmetry\n            i2, j2 = indices[k2]\n            \n            # Since g_j has the same functional form as f_j, the 1D mass matrix\n            # for the y-component (My) is identical to Mx.\n            val_M = Mx[i1, i2] * Mx[j1, j2]\n            M[k1, k2] = M[k2, k1] = val_M\n            \n            val_K = Kx_x[i1, i2] * Mx[j1, j2] + Mx[i1, i2] * Ky_y[j1, j2]\n            K[k1, k2] = K[k2, k1] = val_K\n            \n    # 5. Solve the generalized eigenvalue problem K c = lambda M c\n    # We only need the 4 smallest eigenvalues.\n    eigenvalues = eigh(K, M, subset_by_index=[0, 3])[0]\n\n    lambda1, lambda2, lambda3, lambda4 = eigenvalues\n    \n    # 6. Compute quantitative metrics\n    w = lambda3 - lambda2      # Cluster width\n    s_b = lambda2 - lambda1    # Lower separation\n    s_a = lambda4 - lambda3    # Upper separation\n    \n    return w, s_b, s_a\n\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}