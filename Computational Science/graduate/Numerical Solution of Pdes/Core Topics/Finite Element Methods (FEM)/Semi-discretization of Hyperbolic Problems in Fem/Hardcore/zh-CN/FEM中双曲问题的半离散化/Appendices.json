{
    "hands_on_practices": [
        {
            "introduction": "在深入研究更高级的数值方法之前，我们必须掌握其基本原理。本练习将引导您完成为标准连续伽辽金(CG)方法构建局部矩阵的关键步骤，这是将有限元法应用于平流等问题的基础。掌握这些计算细节是理解和实现更复杂格式（如间断伽辽金法）的必要前提。",
            "id": "3441775",
            "problem": "考虑一个二维多边形域上的常系数线性双曲型偏微分方程 (PDE) $u_{t} + \\boldsymbol{c}\\cdot \\nabla u = 0$，其中 $\\boldsymbol{c} = (a,b)$ 是一个常向量。给定一个协调三角剖分，并考虑一个顶点为 $\\boldsymbol{x}_{1} = (x_{1},y_{1})$、$\\boldsymbol{x}_{2} = (x_{2},y_{2})$ 和 $\\boldsymbol{x}_{3} = (x_{3},y_{3})$ 的三角形单元 $K$。假设顶点的标记方式使得下面定义的单元映射是保向的。\n\n您将使用 $K$ 上的连续分片线性 Lagrange 有限元空间 $\\mathbb{P}_{1}$。设参考三角形为 $\\widehat{K} = \\{(\\xi,\\eta)\\,:\\,\\xi \\ge 0,\\ \\eta \\ge 0,\\ \\xi+\\eta \\le 1\\}$，其顶点位于 $(0,0)$、$(1,0)$ 和 $(0,1)$。\n\n任务：\n1) 为 $\\mathbb{P}_{1}$ 构造参考单元 $\\widehat{K}$ 上的典范节点 Lagrange 基函数，并从第一性原理（参考顶点上的插值条件）证明其形式的合理性。\n2) 描述从 $\\widehat{K}$ 到物理单元 $K$ 的仿射且节点精确的等参映射。定义其雅可比矩阵，并对其进行几何解释。\n3) 仅以可微映射的多变量链式法则为基本原理，精确说明基函数的梯度在单元映射下如何变换，并用雅可比矩阵表示 $K$ 上 $\\mathbb{P}_{1}$ 基函数的物理梯度。\n4) 在 $K$ 上对偏微分方程进行标准 Galerkin 半离散化时，局部对流矩阵 $A_{e}$ 的元素为 $(A_{e})_{ij} = \\int_{K} (\\boldsymbol{c}\\cdot \\nabla \\varphi_{j})\\,\\varphi_{i}\\, \\mathrm{d}\\boldsymbol{x}$，其中 $\\{\\varphi_{i}\\}_{i=1}^{3}$ 是与顶点 $\\boldsymbol{x}_{i}$ 相关联的物理 $\\mathbb{P}_{1}$ 基函数。利用第 1) 至 3) 部分的内容，推导特定元素 $(A_{e})_{12}$ 的闭式表达式，该表达式仅用 $a$、$b$ 和顶点坐标 $(x_{1},y_{1})$、$(x_{2},y_{2})$、$(x_{3},y_{3})$ 表示。\n\n将你的最终答案表示为单个闭式解析表达式。无需四舍五入，也无需单位。",
            "solution": "所述问题具有科学依据、是适定的、客观且自洽的。它提出了一个在偏微分方程数值分析领域，特别是针对线性双曲型问题的有限元法 (FEM) 中的标准、多部分推导。所有术语都是标准的，并有明确定义。因此，该问题是有效的，并将提供解答。推导将按照指定的四个任务进行。\n\n控制偏微分方程是线性对流方程 $u_{t} + \\boldsymbol{c}\\cdot \\nabla u = 0$，其中对流速度 $\\boldsymbol{c}=(a,b)$ 是 $\\mathbb{R}^{2}$ 中的一个常向量。我们分析在单个三角形单元 $K$ 上的空间离散化，该单元的顶点为 $\\boldsymbol{x}_{1} = (x_{1},y_{1})$、$\\boldsymbol{x}_{2} = (x_{2},y_{2})$ 和 $\\boldsymbol{x}_{3} = (x_{3},y_{3})$。有限元空间是连续分片线性多项式空间，记为 $\\mathbb{P}_{1}(K)$。\n\n**1) 参考单元上的典范节点基函数**\n\n参考有限元是三角形 $\\widehat{K} = \\{(\\xi,\\eta) \\in \\mathbb{R}^{2} \\,:\\, \\xi \\ge 0,\\ \\eta \\ge 0,\\ \\xi+\\eta \\le 1\\}$，其顶点为 $\\widehat{\\boldsymbol{x}}_{1}=(0,0)$、$\\widehat{\\boldsymbol{x}}_{2}=(1,0)$ 和 $\\widehat{\\boldsymbol{x}}_{3}=(0,1)$。空间 $\\mathbb{P}_{1}(\\widehat{K})$ 中的函数 $\\widehat{\\varphi}(\\xi,\\eta)$ 必须是形如 $\\widehat{\\varphi}(\\xi,\\eta) = C_{1} + C_{2}\\xi + C_{3}\\eta$ 的线性多项式，其中 $C_{1}, C_{2}, C_{3} \\in \\mathbb{R}$ 为常数。\n\n典范节点基函数 $\\{\\widehat{\\varphi}_{i}\\}_{i=1}^{3}$ 由插值（或“节点”）性质 $\\widehat{\\varphi}_{i}(\\widehat{\\boldsymbol{x}}_{j}) = \\delta_{ij}$ 定义，其中 $\\delta_{ij}$ 是克罗内克 δ。我们通过求解一个小型线性方程组来构造每个基函数。\n\n对于 $\\widehat{\\varphi}_{1}(\\xi,\\eta)$:\n- $\\widehat{\\varphi}_{1}(\\widehat{\\boldsymbol{x}}_{1}) = \\widehat{\\varphi}_{1}(0,0) = 1 \\implies C_{1} + C_{2}(0) + C_{3}(0) = 1 \\implies C_{1}=1$.\n- $\\widehat{\\varphi}_{1}(\\widehat{\\boldsymbol{x}}_{2}) = \\widehat{\\varphi}_{1}(1,0) = 0 \\implies C_{1} + C_{2}(1) + C_{3}(0) = 0 \\implies 1+C_{2}=0 \\implies C_{2}=-1$.\n- $\\widehat{\\varphi}_{1}(\\widehat{\\boldsymbol{x}}_{3}) = \\widehat{\\varphi}_{1}(0,1) = 0 \\implies C_{1} + C_{2}(0) + C_{3}(1) = 0 \\implies 1+C_{3}=0 \\implies C_{3}=-1$.\n因此，$\\widehat{\\varphi}_{1}(\\xi,\\eta) = 1 - \\xi - \\eta$。\n\n对于 $\\widehat{\\varphi}_{2}(\\xi,\\eta)$:\n- $\\widehat{\\varphi}_{2}(\\widehat{\\boldsymbol{x}}_{1}) = \\widehat{\\varphi}_{2}(0,0) = 0 \\implies C_{1} = 0$.\n- $\\widehat{\\varphi}_{2}(\\widehat{\\boldsymbol{x}}_{2}) = \\widehat{\\varphi}_{2}(1,0) = 1 \\implies C_{1} + C_{2} = 1 \\implies C_{2}=1$.\n- $\\widehat{\\varphi}_{2}(\\widehat{\\boldsymbol{x}}_{3}) = \\widehat{\\varphi}_{2}(0,1) = 0 \\implies C_{1} + C_{3} = 0 \\implies C_{3}=0$.\n因此，$\\widehat{\\varphi}_{2}(\\xi,\\eta) = \\xi$。\n\n对于 $\\widehat{\\varphi}_{3}(\\xi,\\eta)$:\n- $\\widehat{\\varphi}_{3}(\\widehat{\\boldsymbol{x}}_{1}) = \\widehat{\\varphi}_{3}(0,0) = 0 \\implies C_{1} = 0$.\n- $\\widehat{\\varphi}_{3}(\\widehat{\\boldsymbol{x}}_{2}) = \\widehat{\\varphi}_{3}(1,0) = 0 \\implies C_{1} + C_{2} = 0 \\implies C_{2}=0$.\n- $\\widehat{\\varphi}_{3}(\\widehat{\\boldsymbol{x}}_{3}) = \\widehat{\\varphi}_{3}(0,1) = 1 \\implies C_{1} + C_{3} = 1 \\implies C_{3}=1$.\n因此，$\\widehat{\\varphi}_{3}(\\xi,\\eta) = \\eta$。\n\n这三个函数，$\\widehat{\\varphi}_{1}(\\xi,\\eta)=1-\\xi-\\eta$、$\\widehat{\\varphi}_{2}(\\xi,\\eta)=\\xi$ 和 $\\widehat{\\varphi}_{3}(\\xi,\\eta)=\\eta$，构成了 $\\mathbb{P}_{1}(\\widehat{K})$ 的基。它们也被称为参考单元上的重心坐标。\n\n**2) 等参映射及其雅可比矩阵**\n\n等参映射 $\\boldsymbol{F}: \\widehat{K} \\to K$ 将参考单元中的点 $\\widehat{\\boldsymbol{x}}=(\\xi,\\eta)$ 与物理单元中的点 $\\boldsymbol{x}=(x,y)$ 关联起来。它使用相同的基函数来映射几何形状和表示解。该映射定义为\n$$\n\\boldsymbol{x} = \\boldsymbol{F}(\\widehat{\\boldsymbol{x}}) = \\sum_{i=1}^{3} \\boldsymbol{x}_{i} \\widehat{\\varphi}_{i}(\\widehat{\\boldsymbol{x}})\n$$\n将第 1 部分的基函数代入，我们得到\n$$\n\\boldsymbol{x} = \\boldsymbol{x}_{1}(1-\\xi-\\eta) + \\boldsymbol{x}_{2}\\xi + \\boldsymbol{x}_{3}\\eta\n$$\n这可以重排为一个仿射变换：\n$$\n\\boldsymbol{x} = \\boldsymbol{x}_{1} + (\\boldsymbol{x}_{2}-\\boldsymbol{x}_{1})\\xi + (\\boldsymbol{x}_{3}-\\boldsymbol{x}_{1})\\eta\n$$\n该映射的雅可比矩阵 $J$ 是其一阶偏导数矩阵：\n$$\nJ = \\frac{\\partial \\boldsymbol{x}}{\\partial \\widehat{\\boldsymbol{x}}} = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix}\n$$\n从映射的仿射形式，我们计算偏导数：\n$\\frac{\\partial \\boldsymbol{x}}{\\partial \\xi} = \\boldsymbol{x}_{2} - \\boldsymbol{x}_{1}$ 以及 $\\frac{\\partial \\boldsymbol{x}}{\\partial \\eta} = \\boldsymbol{x}_{3} - \\boldsymbol{x}_{1}$。\n以矩阵形式，这给出了常数雅可比矩阵：\n$$\nJ = \\begin{pmatrix} x_2 - x_1  x_3 - x_1 \\\\ y_2 - y_1  y_3 - y_1 \\end{pmatrix}\n$$\n从几何上看，雅可比矩阵 $J$ 的列向量是构成物理三角形 $K$ 的两条边的向量，具体来说是从顶点 $\\boldsymbol{x}_{1}$ 出发的两条边。雅可比矩阵的行列式 $\\det(J)$ 是三角形 $K$ 有向面积的两倍。问题陈述指明映射是保向的，这意味着 $\\det(J) > 0$。\n\n**3) 梯度的变换**\n\n设 $\\varphi$ 是物理单元 $K$ 上的标量函数，$\\widehat{\\varphi}$ 是其在参考单元 $\\widehat{K}$ 上对应的函数，使得 $\\varphi(\\boldsymbol{x})=\\widehat{\\varphi}(\\boldsymbol{F}^{-1}(\\boldsymbol{x}))$。$\\varphi$ 关于物理坐标 $\\boldsymbol{x}=(x,y)$ 的梯度是 $\\nabla_{\\boldsymbol{x}}\\varphi$，而 $\\widehat{\\varphi}$ 关于参考坐标 $\\widehat{\\boldsymbol{x}}=(\\xi,\\eta)$ 的梯度是 $\\nabla_{\\widehat{\\boldsymbol{x}}}\\widehat{\\varphi}$。\n\n根据多变量链式法则，导数关系如下：\n$$\n\\begin{pmatrix} \\frac{\\partial \\widehat{\\varphi}}{\\partial \\xi} \\\\ \\frac{\\partial \\widehat{\\varphi}}{\\partial \\eta} \\end{pmatrix} = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\xi} \\\\ \\frac{\\partial x}{\\partial \\eta}  \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix} \\begin{pmatrix} \\frac{\\partial \\varphi}{\\partial x} \\\\ \\frac{\\partial \\varphi}{\\partial y} \\end{pmatrix}\n$$\n这正是 $\\nabla_{\\widehat{\\boldsymbol{x}}}\\widehat{\\varphi} = J^{T} \\nabla_{\\boldsymbol{x}}\\varphi$。为了用参考梯度表示物理梯度，我们对此关系求逆：\n$$\n\\nabla_{\\boldsymbol{x}}\\varphi = (J^{T})^{-1} \\nabla_{\\widehat{\\boldsymbol{x}}}\\widehat{\\varphi} = (J^{-1})^{T} \\nabla_{\\widehat{\\boldsymbol{x}}}\\widehat{\\varphi}\n$$\n对于 $K$ 上的 $\\mathbb{P}_{1}$ 基函数 $\\varphi_i$，此公式直接适用。参考基函数 $\\widehat{\\varphi}_i$ 的梯度是常向量：\n$\\nabla_{\\widehat{\\boldsymbol{x}}}\\widehat{\\varphi}_{1} = \\begin{pmatrix} -1 \\\\ -1 \\end{pmatrix}$，\n$\\nabla_{\\widehat{\\boldsymbol{x}}}\\widehat{\\varphi}_{2} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$，\n$\\nabla_{\\widehat{\\boldsymbol{x}}}\\widehat{\\varphi}_{3} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$。\n由于 $J$ 是常数，物理梯度 $\\nabla_{\\boldsymbol{x}}\\varphi_i$ 在单元 $K$ 上也是常向量。\n\n**4) 对流矩阵元素 $(A_{e})_{12}$ 的推导**\n\n局部对流矩阵的元素 $(A_{e})_{12}$ 由以下积分给出：\n$$\n(A_{e})_{12} = \\int_{K} (\\boldsymbol{c}\\cdot \\nabla_{\\boldsymbol{x}} \\varphi_{2})\\,\\varphi_{1}\\, \\mathrm{d}\\boldsymbol{x}\n$$\n我们计算被积函数中的各项。首先，我们使用第 3 部分的变换规则计算物理梯度 $\\nabla_{\\boldsymbol{x}}\\varphi_{2}$。\n$$\n\\nabla_{\\boldsymbol{x}}\\varphi_{2} = (J^{-1})^{T} \\nabla_{\\widehat{\\boldsymbol{x}}}\\widehat{\\varphi}_{2}\n$$\n我们需要雅可比矩阵 $J$ 的逆矩阵。\n$$\nJ^{-1} = \\frac{1}{\\det(J)} \\begin{pmatrix} y_3 - y_1  -(x_3 - x_1) \\\\ -(y_2 - y_1)  x_2 - x_1 \\end{pmatrix}\n$$\n其中 $\\det(J) = (x_2 - x_1)(y_3 - y_1) - (x_3 - x_1)(y_2 - y_1)$。\n逆矩阵的转置是：\n$$\n(J^{-1})^{T} = \\frac{1}{\\det(J)} \\begin{pmatrix} y_3 - y_1  -(y_2 - y_1) \\\\ -(x_3 - x_1)  x_2 - x_1 \\end{pmatrix}\n$$\n代入 $\\nabla_{\\widehat{\\boldsymbol{x}}}\\widehat{\\varphi}_{2} = (1, 0)^{T}$:\n$$\n\\nabla_{\\boldsymbol{x}}\\varphi_{2} = \\frac{1}{\\det(J)} \\begin{pmatrix} y_3 - y_1  -(y_2 - y_1) \\\\ -(x_3 - x_1)  x_2 - x_1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\frac{1}{\\det(J)} \\begin{pmatrix} y_3 - y_1 \\\\ -(x_3 - x_1) \\end{pmatrix}\n$$\n该梯度在 $K$ 上是常数。现在我们计算其与 $\\boldsymbol{c}=(a,b)$ 的点积：\n$$\n\\boldsymbol{c} \\cdot \\nabla_{\\boldsymbol{x}}\\varphi_{2} = \\begin{pmatrix} a \\\\ b \\end{pmatrix} \\cdot \\frac{1}{\\det(J)} \\begin{pmatrix} y_3 - y_1 \\\\ -(x_3 - x_1) \\end{pmatrix} = \\frac{a(y_3 - y_1) - b(x_3 - x_1)}{\\det(J)}\n$$\n由于整个项是常数，可以从积分中提出：\n$$\n(A_{e})_{12} = \\left( \\frac{a(y_3 - y_1) - b(x_3 - x_1)}{\\det(J)} \\right) \\int_{K} \\varphi_{1}\\, \\mathrm{d}\\boldsymbol{x}\n$$\n为计算剩余的积分，我们使用 $\\mathrm{d}\\boldsymbol{x} = \\det(J)\\mathrm{d}\\widehat{\\boldsymbol{x}}$ 换元到参考单元：\n$$\n\\int_{K} \\varphi_{1}\\, \\mathrm{d}\\boldsymbol{x} = \\int_{\\widehat{K}} \\widehat{\\varphi}_{1}(\\widehat{\\boldsymbol{x}})\\, \\det(J) \\, \\mathrm{d}\\widehat{\\boldsymbol{x}} = \\det(J) \\int_{0}^{1}\\int_{0}^{1-\\xi} (1-\\xi-\\eta)\\,\\mathrm{d}\\eta\\,\\mathrm{d}\\xi\n$$\n我们计算关于 $\\eta$ 的内层积分：\n$$\n\\int_{0}^{1-\\xi} (1-\\xi-\\eta)\\,\\mathrm{d}\\eta = \\left[(1-\\xi)\\eta - \\frac{\\eta^2}{2}\\right]_{0}^{1-\\xi} = (1-\\xi)^2 - \\frac{(1-\\xi)^2}{2} = \\frac{1}{2}(1-\\xi)^2\n$$\n现在我们计算关于 $\\xi$ 的外层积分：\n$$\n\\int_{0}^{1} \\frac{1}{2}(1-\\xi)^2\\,\\mathrm{d}\\xi = \\frac{1}{2} \\left[ -\\frac{(1-\\xi)^3}{3} \\right]_{0}^{1} = \\frac{1}{2}\\left(0 - \\left(-\\frac{1}{3}\\right)\\right) = \\frac{1}{6}\n$$\n因此，$\\int_{K} \\varphi_{1}\\, \\mathrm{d}\\boldsymbol{x} = \\frac{1}{6}\\det(J)$。这个结果与通用公式相符，即重心坐标函数在三角形上的积分等于该三角形面积的三分之一，因为 $\\text{Area}(K) = \\frac{1}{2}\\det(J)$。\n\n将此结果代回 $(A_{e})_{12}$ 的表达式中：\n$$\n(A_{e})_{12} = \\left( \\frac{a(y_3 - y_1) - b(x_3 - x_1)}{\\det(J)} \\right) \\left( \\frac{1}{6}\\det(J) \\right)\n$$\n$\\det(J)$ 项相互消去，得到最终的闭式表达式：\n$$\n(A_{e})_{12} = \\frac{1}{6} \\left( a(y_3 - y_1) - b(x_3 - x_1) \\right)\n$$\n正如所要求，该表达式仅取决于对流系数以及顶点 $\\boldsymbol{x}_{1}$ 和 $\\boldsymbol{x}_{3}$ 的坐标。",
            "answer": "$$\n\\boxed{\\frac{a(y_{3} - y_{1}) - b(x_{3} - x_{1})}{6}}\n$$"
        },
        {
            "introduction": "了解了连续伽辽金方法后，我们转向一种强大的替代方案：间断伽辽金(DG)方法。DG方法的一个核心优势是其在单元层面强制执行物理守恒律的能力。本练习通过一个简洁而深刻的解析推导来揭示这一特性，展示了单元内物理量的变化率如何被边界上的数值通量精确地平衡。",
            "id": "3441789",
            "problem": "考虑一维空间中的标量线性平流方程，\n$$\n\\partial_t u(x,t) + a\\,\\partial_x u(x,t) = 0 \\quad \\text{for } x \\in [0,2h],\\ t0,\n$$\n其中平流速度 $a0$ 为常数，并给定流入边界数据 $u(0,t)=g(t)$。将区域划分为包含两个单元 $K_1=[0,h]$ 和 $K_2=[h,2h]$ 的简单网格。令 $u_h(\\cdot,t)$ 为每个单元上次数至多为 1 的多项式空间中的不连续伽辽金 (DG) 半离散近似解。\n\n对线性平流采用标准的迎风数值通量，\n$$\n\\widehat{f}(u^-,u^+) = a\\,u^{\\text{up}}=\n\\begin{cases}\na\\,u^-  \\text{if } a0,\\\\\na\\,u^+  \\text{if } a0,\n\\end{cases}\n$$\n并在 $\\partial K$ 上使用单位外法向量 $n_{K}(x)$，因此在一维情况下，$n_{K_1}(0)=-1$ 且 $n_{K_1}(h)=+1$。单元 $K$ 上的半离散 DG 格式为：求解 $u_h$，使得对于局部多项式空间中的所有测试函数 $v_h$，\n$$\n\\int_{K} \\partial_t u_h\\, v_h\\, dx \\;-\\; \\int_{K} a\\, u_h\\, \\partial_x v_h\\, dx \\;+\\; \\int_{\\partial K} \\widehat{f}\\big(u_h^-,u_h^+\\big)\\, v_h\\, n_{K}\\, ds \\;=\\; 0.\n$$\n\n重点关注左侧单元 $K_1$ 以及 $K_1$ 上的常数测试函数 $v_h \\equiv 1$。定义单元残差\n$$\nR_{K_1}(t) := \\int_{K_1} \\partial_t u_h(x,t)\\, dx,\n$$\n以及穿过边界 $\\partial K_1$ 的净数值通量，\n$$\nB_{K_1}(t) := \\int_{\\partial K_1} \\widehat{f}\\big(u_h^-(x,t),u_h^+(x,t)\\big)\\, n_{K_1}(x)\\, ds.\n$$\n\n从上述半离散 DG 格式和给定的数值通量出发，计算量\n$$\nD(t) := R_{K_1}(t) + B_{K_1}(t)\n$$\n的闭式解，如有需要，可以仅用 $a$ 和 $g(t)$ 表示，并将其完全化简。你的最终答案必须是单个实数或单个闭式解析表达式。无需四舍五入，也无需单位。",
            "solution": "问题要求计算量 $D(t) := R_{K_1}(t) + B_{K_1}(t)$。我们首先对问题陈述进行验证。\n\n### 问题验证\n**步骤 1：提取已知条件**\n- **偏微分方程 (PDE)：** $\\partial_t u(x,t) + a\\,\\partial_x u(x,t) = 0$，对于 $x \\in [0,2h]$, $t0$。\n- **平流速度：** $a0$。\n- **边界条件：** $u(0,t)=g(t)$。\n- **网格：** 单元 $K_1=[0,h]$ 和 $K_2=[h,2h]$。\n- **近似空间：** 每个单元上次数至多为 1 的多项式空间。\n- **数值通量：** $\\widehat{f}(u^-,u^+) = a\\,u^{\\text{up}}$，当 $a0$ 时为 $\\widehat{f}(u^-,u^+) = a\\,u^-$。\n- **$K_1$ 的外法向量：** $n_{K_1}(0)=-1$ 且 $n_{K_1}(h)=+1$。\n- **半离散 DG 格式：** 对于一个单元 $K$ 和一个来自局部多项式空间的测试函数 $v_h$，其格式为：\n    $$\n    \\int_{K} \\partial_t u_h\\, v_h\\, dx \\;-\\; \\int_{K} a\\, u_h\\, \\partial_x v_h\\, dx \\;+\\; \\int_{\\partial K} \\widehat{f}\\big(u_h^-,u_h^+\\big)\\, v_h\\, n_{K}\\, ds \\;=\\; 0.\n    $$\n- **定义：**\n    - 单元残差：$R_{K_1}(t) := \\int_{K_1} \\partial_t u_h(x,t)\\, dx$。\n    - 净数值通量：$B_{K_1}(t) := \\int_{\\partial K_1} \\widehat{f}\\big(u_h^-(x,t),u_h^+(x,t)\\big)\\, n_{K_1}(x)\\, ds$。\n- **待计算量：** $D(t) := R_{K_1}(t) + B_{K_1}(t)$。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题具有科学依据，是使用不连续伽辽金方法进行偏微分方程数值分析的标准练习。它提法恰当，提供了所有必要的定义和方程。语言客观、正式。对于所提出的问题，其设置在内部是一致且完整的。该问题并非无足轻重，因为它要求识别所定义量与控制离散方程之间的关系，从而检验一个基本概念，而非死记硬背的计算。因此，该问题被认定为有效。\n\n**步骤 3：结论与行动**\n问题有效。我们继续进行求解。\n\n### 解答\n解答的基础在于问题陈述中提供的半离散不连续伽辽金 (DG) 格式。该格式对于指定近似空间内的任何测试函数 $v_h$ 的选择都必须成立。\n\n问题指明 $u_h$ 的近似空间由每个单元 $K$ 上次数至多为 1 的多项式组成。测试函数 $v_h$ 的空间是相同的。该空间记为 $\\mathcal{P}^1(K)$，包含所有常数函数。问题引导我们将注意力集中在特定的常数测试函数 $v_h(x) \\equiv 1$ 上，其中 $x \\in K_1$。\n\n单元 $K_1=[0,h]$ 上的半离散 DG 格式为：\n$$\n\\int_{K_1} \\partial_t u_h\\, v_h\\, dx \\;-\\; \\int_{K_1} a\\, u_h\\, \\partial_x v_h\\, dx \\;+\\; \\int_{\\partial K_1} \\widehat{f}\\big(u_h^-,u_h^+\\big)\\, v_h\\, n_{K_1}\\, ds \\;=\\; 0.\n$$\n我们将选定的测试函数 $v_h \\equiv 1$ 代入此方程。让我们逐项分析。\n\n1.  **第一项：** 第一个积分变为：\n    $$\n    \\int_{K_1} \\partial_t u_h(x,t) \\cdot 1 \\, dx.\n    $$\n    根据问题的定义，这正是单元残差 $R_{K_1}(t)$。\n\n2.  **第二项：** 第二个积分涉及测试函数的空间导数 $\\partial_x v_h$：\n    $$\n    -\\int_{K_1} a\\, u_h(x,t)\\, \\partial_x(1)\\, dx.\n    $$\n    由于 $v_h(x) = 1$ 是一个常数函数，其导数为 $\\partial_x v_h = 0$。因此，整个项的计算结果为零：\n    $$\n    -\\int_{K_1} a\\, u_h(x,t) \\cdot 0 \\, dx = 0.\n    $$\n\n3.  **第三项：** 第三个积分是边界项：\n    $$\n    \\int_{\\partial K_1} \\widehat{f}\\big(u_h^-(x,t),u_h^+(x,t)\\big) \\cdot 1 \\cdot n_{K_1}(x)\\, ds.\n    $$\n    根据问题的定义，这正是净数值通量 $B_{K_1}(t)$。\n\n将这些结果代回半离散 DG 格式，我们得到：\n$$\nR_{K_1}(t) - 0 + B_{K_1}(t) = 0,\n$$\n化简为：\n$$\nR_{K_1}(t) + B_{K_1}(t) = 0.\n$$\n问题要求计算量 $D(t)$，其定义为：\n$$\nD(t) := R_{K_1}(t) + B_{K_1}(t).\n$$\n从我们的推导中可以清楚地看出，这个和等于 $0$。\n\n这个结果是 DG 方法定义的直接推论。通过选择一个常数测试函数，该格式简化为一个陈述，即 $u_h$ 的单元平均值的变化率由单元边界处的数值通量来平衡。问题的构造使得待计算量 $D(t)$ 正好是这个局部守恒定律的左侧，根据数值格式的定义，它必须为零。要得出这个结论，并不需要数值通量的具体形式、平流速度 $a$ 的值以及边界数据 $g(t)$。",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "理论在应用于具体的物理问题时会变得最为清晰。本练习探讨了波在两种不同介质界面上的传播问题，这是物理学和工程学中的一个经典场景。通过推导反射和透射系数，我们可以直接比较DG和CG方法的性能，从而理解为何采用迎风格式通量的DG方法能够精确捕捉物理现象，而标准CG方法却会引入数值误差。",
            "id": "3441760",
            "problem": "考虑一维线性声学问题，介质由两个分别占据半直线 $x0$ 和 $x0$ 的均匀无损介质组成。设左侧介质的密度为 $\\rho_{1}$，体积模量为 $\\kappa_{1}$；右侧介质的密度为 $\\rho_{2}$，体积模量为 $\\kappa_{2}$。压力 $p(x,t)$ 和粒子速度 $u(x,t)$ 满足一阶双曲系统\n$$\np_{t} + \\kappa\\,u_{x} = 0,\\qquad u_{t} + \\frac{1}{\\rho}\\,p_{x} = 0,\n$$\n其中，当 $x0$ 时 $(\\rho,\\kappa)=(\\rho_{1},\\kappa_{1})$，当 $x0$ 时 $(\\rho,\\kappa)=(\\rho_{2},\\kappa_{2})$。在每种介质中，定义声速 $c=\\sqrt{\\kappa/\\rho}$ 和特征（声）阻抗 $Z=\\sqrt{\\kappa\\,\\rho}$，从而得到 $c_{j}=\\sqrt{\\kappa_{j}/\\rho_{j}}$ 和 $Z_{j}=\\sqrt{\\kappa_{j}\\rho_{j}}$，其中 $j\\in\\{1,2\\}$。在界面 $x=0$ 处，物理传输条件是压力和速度的连续性。\n\n一个角频率为 $\\omega0$ 的时谐平面波从左侧介质的 $x=-\\infty$ 处入射。在连续问题中，入射波、反射波和透射波假设具有以下形式\n$$\np_{i}(x,t)=P_{i}\\exp\\!\\big(i(\\omega t-k_{1}x)\\big),\\quad p_{r}(x,t)=P_{r}\\exp\\!\\big(i(\\omega t+k_{1}x)\\big),\\quad p_{t}(x,t)=P_{t}\\exp\\!\\big(i(\\omega t-k_{2}x)\\big),\n$$\n其中 $k_{j}=\\omega/c_{j}$ 是介质 $j$ 中的波数。相应的速度振幅 $U_{i}$、$U_{r}$ 和 $U_{t}$ 满足从各介质中的场方程推导出的平面波关系。\n\n现在，在空间上使用有限元法（FEM）进行半离散化，同时保持时间连续（半离散格式）。在界面两侧，使用尺寸为 $h0$ 的均匀网格和次数为 $p\\geq 0$ 的多项式空间：可以是全局连续、次数为 $p$ 的分段多项式构成的连续伽辽金（CG）空间，也可以是次数为 $p$ 的不连续分段多项式构成的间断伽辽金（DG）空间。弱形式施加界面传输条件。对于DG离散化，使用与双曲系统的精确特征分解以及材料阻抗 $Z_{1}$ 和 $Z_{2}$ 一致的迎风数值通量。\n\n定义压力振幅的复反射系数和透射系数为\n$$\nR=\\frac{P_{r}}{P_{i}},\\qquad T=\\frac{P_{t}}{P_{i}}.\n$$\n仅使用控制方程、物理界面条件以及指定通量选择的半离散格式，推导用于确定 $R$ 和 $T$ 的DG半离散化的离散界面关系。证明这些关系与连续平面波匹配条件一致，并因此与连续菲涅尔系数一致，并定性解释在DG情况下，对多项式次数 $p$ 的依赖性是如何以及为何被消除的。将此与CG半离散化进行对比，并从第一性原理出发，严格论证CG中的离散色散关系如何影响局部平面波阻抗比，从而导致对连续菲涅尔系数产生一个依赖于 $h$ 和 $p$ 的扰动，其主阶误差随着网格的加密而消失，消失速率取决于 $p$。\n\n您的最终任务是：仅用材料阻抗 $Z_{1}$ 和 $Z_{2}$ 表示DG半离散反射和透射系数 $(R,T)$，写成一个行向量，给出一个封闭形式的解析表达式。无需进行数值计算。最终答案无需单位。",
            "solution": "首先根据既定标准对问题进行验证。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n- **控制方程：** $p_{t} + \\kappa\\,u_{x} = 0$, $u_{t} + \\frac{1}{\\rho}\\,p_{x} = 0$。\n- **介质：** 介质1位于 $x0$，参数为 $(\\rho_{1},\\kappa_{1})$；介质2位于 $x0$，参数为 $(\\rho_{2},\\kappa_{2})$。\n- **定义：** 声速 $c_{j}=\\sqrt{\\kappa_{j}/\\rho_{j}}$，特征阻抗 $Z_{j}=\\sqrt{\\kappa_{j}\\rho_{j}}$，其中 $j\\in\\{1,2\\}$。\n- **界面条件：** 在 $x=0$ 处压力 $p$ 和速度 $u$ 连续。\n- **波形：**\n  - 入射波： $p_{i}(x,t)=P_{i}\\exp(i(\\omega t-k_{1}x))$。\n  - 反射波： $p_{r}(x,t)=P_{r}\\exp(i(\\omega t+k_{1}x))$。\n  - 透射波： $p_{t}(x,t)=P_{t}\\exp(i(\\omega t-k_{2}x))$。\n  - 波数： $k_{j}=\\omega/c_{j}$。\n- **半离散化：**\n  - 空间上采用有限元法（FEM），时间上连续。\n  - 均匀网格尺寸 $h0$。\n  - 次数为 $p \\geq 0$ 的连续伽辽金（CG）或间断伽辽金（DG）。\n  - DG使用与精确特征分解一致的迎风数值通量。\n- **待求量：** DG半离散化的反射系数 $R=P_{r}/P_{i}$ 和透射系数 $T=P_{t}/P_{i}$。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据：** 问题陈述基于一维线性声学和波传播的基本原理。有限元法（CG和DG）以及特定的数值通量（迎风/黎曼求解器）的使用是偏微分方程数值分析中标准的、成熟的课题。该设定在科学上和数学上都是合理的。\n- **适定性：** 问题定义明确，为进行所要求的推导和比较提供了所有必要的物理和数值参数。它要求一个特定的解析结果和严谨的解释，这在给定的框架内是可以实现的。\n- **客观性：** 语言正式、精确、无歧义，使用了物理学和计算数学的标准术语。\n\n**步骤3：结论与行动**\n问题有效。有必要给出完整解答。\n\n### 求解推导\n\n分析分为三个部分：首先，推导连续情况下的反射和透射系数作为基准；其次，为间断伽辽金（DG）半离散化进行推导；第三，对连续伽辽金（CG）方法进行对比分析。\n\n**1. 连续情况：菲涅尔系数**\n控制方程可以写成向量形式 $\\mathbf{q}_t + \\mathbf{A} \\mathbf{q}_x = \\mathbf{0}$，其中 $\\mathbf{q} = [p, u]^T$ 且 $\\mathbf{A} = \\begin{pmatrix} 0  \\kappa \\\\ 1/\\rho  0 \\end{pmatrix}$。\n对于时谐平面波 $\\mathbf{q}(x,t) = \\mathbf{Q} \\exp(i(\\omega t - kx))$，方程变为 $i\\omega \\mathbf{Q} - ik \\mathbf{A} \\mathbf{Q} = \\mathbf{0}$，或 $\\mathbf{A} \\mathbf{Q} = \\frac{\\omega}{k} \\mathbf{Q} = c \\mathbf{Q}$。这是一个关于 $\\mathbf{A}$ 的特征值问题。$\\mathbf{A}$ 的特征值为 $\\pm\\sqrt{\\kappa/\\rho} = \\pm c$，对应于右行波和左行波。\n\n对于右行波 ($p(x,t) = P \\exp(i(\\omega t - kx))$)，第一个控制方程 $p_t + \\kappa u_x = 0$ 得到 $i\\omega P + \\kappa (-ik) U = 0$，因此 $P = (\\kappa k/\\omega) U = (\\kappa/c) U$。由于 $Z=\\sqrt{\\kappa\\rho}$ 和 $c=\\sqrt{\\kappa/\\rho}$，我们有 $Z = \\kappa/c$。因此，对于右行波，有 $P = ZU$。\n对于左行波 ($p(x,t) = P \\exp(i(\\omega t + kx))$)，我们得到 $i\\omega P + \\kappa (ik) U = 0$，这意味着 $P = -ZU$。\n\n在界面 $x=0$ 处，介质1中的总场是入射波和反射波之和，而介质2中只有透射波。\n$p_1(0,t) = (P_i + P_r) \\exp(i\\omega t)$\n$u_1(0,t) = (U_i + U_r) \\exp(i\\omega t) = (P_i/Z_1 - P_r/Z_1) \\exp(i\\omega t)$\n$p_2(0,t) = P_t \\exp(i\\omega t)$\n$u_2(0,t) = U_t \\exp(i\\omega t) = (P_t/Z_2) \\exp(i\\omega t)$\n\n应用物理界面条件：\n压力连续性： $p_1(0,t) = p_2(0,t) \\implies P_i + P_r = P_t$。\n速度连续性： $u_1(0,t) = u_2(0,t) \\implies \\frac{P_i-P_r}{Z_1} = \\frac{P_t}{Z_2}$。\n\n两边同除以 $P_i$ 并使用定义 $R=P_r/P_i$ 和 $T=P_t/P_i$：\n$1 + R = T$\n$\\frac{1-R}{Z_1} = \\frac{T}{Z_2}$\n\n将第一个方程代入第二个方程，得到 $\\frac{1-R}{Z_1} = \\frac{1+R}{Z_2}$，从而得出 $Z_2(1-R) = Z_1(1+R)$。\n整理得到 $R$： $Z_2 - Z_1 = (Z_1+Z_2)R \\implies R = \\frac{Z_2 - Z_1}{Z_1 + Z_2}$。\n将 $R$ 代回第一个方程： $T = 1+R = 1 + \\frac{Z_2 - Z_1}{Z_1 + Z_2} = \\frac{Z_1+Z_2+Z_2-Z_1}{Z_1+Z_2} = \\frac{2Z_2}{Z_1+Z_2}$。\n这些就是连续菲涅尔系数。\n\n**2. 间断伽辽金（DG）半离散化**\nDG方法通过界面上的数值通量耦合相邻的单元。问题指定了与精确特征分解一致的迎风通量。对于双曲系统，这等同于使用精确的黎曼求解器来计算通量。\n设 $\\mathbf{q}_L$ 和 $\\mathbf{q}_R$ 分别是从左侧 ($x=0^-$) 和右侧 ($x=0^+$) 趋近界面时的状态。由黎曼问题解确定的界面状态 $\\mathbf{q}^* = [p^*, u^*]^T$ 必须满足连接其与左右状态的特征关系。\n特征变量 $w_{\\pm} = p \\pm Zu$ 沿着特征线 $dx/dt = \\mp c$ 传播。\n来自左侧状态 $\\mathbf{q}_L$ 的右行信息决定了界面状态 $\\mathbf{q}^*$ 的右行部分。\n来自右侧状态 $\\mathbf{q}_R$ 的左行信息决定了界面状态 $\\mathbf{q}^*$ 的左行部分。\n这得到了界面条件：\n$p^* + Z_1 u^* = p_L + Z_1 u_L$\n$p^* - Z_2 u^* = p_R - Z_2 u_R$\n\n使用平面波形式表示状态 $\\mathbf{q}_L$ 和 $\\mathbf{q}_R$：\n在 $x=0^-$ 处，$p_L = P_i+P_r$ 且 $u_L = U_i+U_r = (P_i-P_r)/Z_1$。\n在 $x=0^+$ 处，$p_R = P_t$ 且 $u_R = U_t = P_t/Z_2$。没有从右侧入射的波。\n\n将这些代入特征关系式：\n$p_L + Z_1 u_L = (P_i+P_r) + Z_1 \\frac{P_i-P_r}{Z_1} = 2P_i$。\n$p_R - Z_2 u_R = P_t - Z_2 \\frac{P_t}{Z_2} = 0$。\n\n黎曼求解器提供了一个满足以下条件的界面状态 $(p^*, u^*)$：\n$p^* + Z_1 u^* = 2P_i$\n$p^* - Z_2 u^* = 0$\n\n求解该方程组得到 $(p^*, u^*)$：从第二个方程得到 $p^* = Z_2 u^*$。代入第一个方程得到 $Z_2 u^* + Z_1 u^* = 2P_i$，所以 $u^* = \\frac{2P_i}{Z_1+Z_2}$。然后，$p^* = \\frac{2Z_2 P_i}{Z_1+Z_2}$。\nDG方法强制要求两侧的解与此界面状态相匹配。透射波由传播到介质2中的状态决定，所以我们必须有 $P_t = p^*$ 和 $U_t=u^*$。\n这直接给出了透射系数：\n$T = \\frac{P_t}{P_i} = \\frac{p^*}{P_i} = \\frac{2Z_2}{Z_1+Z_2}$。\n\n左侧的总场也必须与界面状态一致，意味着 $p_L = p^*$ 和 $u_L=u^*$。因此，$P_i + P_r = p^*$。\n$P_i + P_r = \\frac{2Z_2 P_i}{Z_1+Z_2}$。\n两边除以 $P_i$：$1+R = \\frac{2Z_2}{Z_1+Z_2}$。\n这给出了反射系数：\n$R = \\frac{2Z_2}{Z_1+Z_2} - 1 = \\frac{2Z_2 - (Z_1+Z_2)}{Z_1+Z_2} = \\frac{Z_2 - Z_1}{Z_1+Z_2}$。\n\n为DG方法推导出的离散系数 $(R,T)$ 与连续菲涅尔系数完全相同。这个结果与网格尺寸 $h$ 和多项式次数 $p$ 无关。这是因为：\n（1）对于线性平流方程，在均匀网格上使用迎风通量的DG半离散化在其色散关系上是超收敛的：数值波数 $k_h$ 与连续波数 $k = \\omega/c$ 完全相等。因此，平面波形式是每个均匀介质内半离散方程的精确解。\n（2）DG界面耦合由数值通量处理，这是一个局部计算，仅依赖于紧邻界面的状态（$\\mathbf{q}_L$, $\\mathbf{q}_R$）和局部材料属性（$Z_1$, $Z_2$）。它不涉及单元的内部结构，因此与 $h$ 和 $p$ 无关。\n因为单元内的波表示是精确的，并且耦合机制是局部的且与基函数无关，所以得到的波振幅关系是精确的。\n\n**3. 与连续伽辽金（CG）半离散化的对比**\n在CG方法中，通过选择全局 $C^0$ 连续的基函数来强加连续性。然而，变分格式耦合了所有自由度，导致离散色散关系中介质 $j$ 的数值波数 $k_{h,j}$ 不等于连续波数 $k_j$。误差 $k_{h,j} - k_j$ 是 $h$、$p$ 和 $\\omega$ 的函数。\n这种数值色散意味着离散系统中的平面波以相速度 $c_h = \\omega/k_h \\neq c$ 传播。这实际上改变了介质的阻抗。数值阻抗变为 $Z_{h,j} = \\kappa_j \\frac{k_{h,j}}{\\omega} = Z_j \\frac{c_j k_{h,j}}{\\omega} = Z_j \\frac{k_{h,j}}{k_j}$。\n对于CG($p$)方法，已知色散误差的形式为 $\\frac{k_{h,j}}{k_j} = 1 + C_p(k_j h)^{2p+2} + O((k_j h)^{2p+4})$。\n离散的反射和透射系数则由连续公式给出，但使用的是数值阻抗 $Z_{h,j}$：\n$R_h = \\frac{Z_{h,2} - Z_{h,1}}{Z_{h,1} + Z_{h,2}}$。\n代入 $Z_{h,j}$ 的展开式表明 $R_h$ 将与连续的 $R$ 不同。\n$R_h - R = \\frac{Z_{h,2} - Z_{h,1}}{Z_{h,1} + Z_{h,2}} - \\frac{Z_2 - Z_1}{Z_1 + Z_2} \\approx \\frac{2Z_1 Z_2}{(Z_1+Z_2)^2} \\left(\\frac{k_{h,2}}{k_2} - \\frac{k_{h,1}}{k_1}\\right)$。\n由于误差项 $\\frac{k_{h,j}}{k_j}-1$ 与 $(k_j h)^{2p+2}$ 成正比，CG的反射系数的主阶误差为 $R_h - R = \\mathcal{O}(h^{2p+2})$。这清楚地表明，离散系数对网格尺寸 $h$ 和多项式次数 $p$ 都有依赖性，与DG得到的精确结果形成鲜明对比。\n\n所要求的最终答案是DG系数 $(R, T)$ 的行向量。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{Z_{2} - Z_{1}}{Z_{1} + Z_{2}}  \\frac{2Z_{2}}{Z_{1} + Z_{2}}\n\\end{pmatrix}\n}\n$$"
        }
    ]
}