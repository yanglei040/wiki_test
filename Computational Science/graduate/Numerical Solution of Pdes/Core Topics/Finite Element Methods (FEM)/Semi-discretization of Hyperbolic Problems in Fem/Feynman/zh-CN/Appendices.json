{
    "hands_on_practices": [
        {
            "introduction": "有限元方法的核心在于将复杂域上的问题分解为在简单、标准化的参考单元上的计算。这个练习将指导您完成有限元方法的基本步骤：在参考单元上构建基函数，建立从参考单元到物理单元的映射，并推导梯度在该映射下的变换规则。掌握这些基本功，是在非结构化网格上实现任何偏微分方程有限元求解器的关键 。",
            "id": "3441775",
            "problem": "考虑在一个二维多边形域上的常系数线性双曲型偏微分方程 (PDE) $u_{t} + \\boldsymbol{c}\\cdot \\nabla u = 0$，其中 $\\boldsymbol{c} = (a,b)$ 是常数。给定一个协调三角剖分，并考虑一个具有顶点 $\\boldsymbol{x}_{1} = (x_{1},y_{1})$、$\\boldsymbol{x}_{2} = (x_{2},y_{2})$ 和 $\\boldsymbol{x}_{3} = (x_{3},y_{3})$ 的单个三角形单元 $K$。假设顶点的标记方式使得下面定义的单元映射是保向的。\n\n您将使用 $K$ 上的连续分片线性 Lagrange 有限元空间 $\\mathbb{P}_{1}$。设参考三角形为 $\\widehat{K} = \\{(\\xi,\\eta)\\,:\\,\\xi \\ge 0,\\ \\eta \\ge 0,\\ \\xi+\\eta \\le 1\\}$，其顶点位于 $(0,0)$、$(1,0)$ 和 $(0,1)$。\n\n任务：\n1) 为 $\\mathbb{P}_{1}$ 在参考单元 $\\widehat{K}$ 上构建典范节点 Lagrange 基函数，并从第一性原理（参考顶点上的插值条件）证明其形式。\n2) 描述从 $\\widehat{K}$ 到物理单元 $K$ 的等参映射，该映射是仿射且节点精确的。定义其雅可比矩阵并对其进行几何解释。\n3) 仅以可微映射的多元链式法则为基本原理，精确说明基函数的梯度在单元映射下如何变换，并用雅可比矩阵表示 $K$ 上 $\\mathbb{P}_{1}$ 基的物理梯度。\n4) 在 $K$ 上对 PDE 进行标准 Galerkin 半离散化时，局部对流矩阵 $A_{e}$ 的元素为 $(A_{e})_{ij} = \\int_{K} (\\boldsymbol{c}\\cdot \\nabla \\varphi_{j})\\,\\varphi_{i}\\, \\mathrm{d}\\boldsymbol{x}$，其中 $\\{\\varphi_{i}\\}_{i=1}^{3}$ 是与顶点 $\\boldsymbol{x}_{i}$ 相关联的物理 $\\mathbb{P}_{1}$ 基函数。使用第 1)–3) 部分的要素，推导特定元素 $(A_{e})_{12}$ 的闭式表达式，该表达式仅用 $a$、$b$ 和顶点坐标 $(x_{1},y_{1})$、$(x_{2},y_{2})$、$(x_{3},y_{3})$ 表示。\n\n将您的最终答案表示为单个闭式解析表达式。无需四舍五入，也无需单位。",
            "solution": "所述问题具有科学依据、适定、客观且自洽。它展示了偏微分方程数值分析领域中一个标准的多部分推导，特别是针对线性双曲问题的有限元方法 (FEM)。所有术语都是标准的且定义明确。因此，该问题是有效的，并将提供一个解答。推导将通过四个指定的任务进行。\n\n控制偏微分方程是线性对流方程 $u_{t} + \\boldsymbol{c}\\cdot \\nabla u = 0$，其中对流速度 $\\boldsymbol{c}=(a,b)$ 是 $\\mathbb{R}^{2}$ 中的一个常向量。我们分析在单个三角形单元 $K$ 上的空间离散化，该单元的顶点为 $\\boldsymbol{x}_{1} = (x_{1},y_{1})$、$\\boldsymbol{x}_{2} = (x_{2},y_{2})$ 和 $\\boldsymbol{x}_{3} = (x_{3},y_{3})$。有限元空间是连续分片线性多项式空间，记为 $\\mathbb{P}_{1}(K)$。\n\n**1) 参考单元上的典范节点基函数**\n\n参考有限元是三角形 $\\widehat{K} = \\{(\\xi,\\eta) \\in \\mathbb{R}^{2} \\,:\\, \\xi \\ge 0,\\ \\eta \\ge 0,\\ \\xi+\\eta \\le 1\\}$，其顶点为 $\\widehat{\\boldsymbol{x}}_{1}=(0,0)$、$\\widehat{\\boldsymbol{x}}_{2}=(1,0)$ 和 $\\widehat{\\boldsymbol{x}}_{3}=(0,1)$。空间 $\\mathbb{P}_{1}(\\widehat{K})$ 中的函数 $\\widehat{\\varphi}(\\xi,\\eta)$ 必须是 $\\widehat{\\varphi}(\\xi,\\eta) = C_{1} + C_{2}\\xi + C_{3}\\eta$ 形式的线性多项式，其中 $C_{1}, C_{2}, C_{3} \\in \\mathbb{R}$ 为某些常数。\n\n典范节点基函数 $\\{\\widehat{\\varphi}_{i}\\}_{i=1}^{3}$ 由插值（或“节点”）性质 $\\widehat{\\varphi}_{i}(\\widehat{\\boldsymbol{x}}_{j}) = \\delta_{ij}$ 定义，其中 $\\delta_{ij}$ 是克罗内克δ。我们通过求解一个小型线性方程组来构建每个基函数。\n\n对于 $\\widehat{\\varphi}_{1}(\\xi,\\eta)$:\n- $\\widehat{\\varphi}_{1}(\\widehat{\\boldsymbol{x}}_{1}) = \\widehat{\\varphi}_{1}(0,0) = 1 \\implies C_{1} + C_{2}(0) + C_{3}(0) = 1 \\implies C_{1}=1$。\n- $\\widehat{\\varphi}_{1}(\\widehat{\\boldsymbol{x}}_{2}) = \\widehat{\\varphi}_{1}(1,0) = 0 \\implies C_{1} + C_{2}(1) + C_{3}(0) = 0 \\implies 1+C_{2}=0 \\implies C_{2}=-1$。\n- $\\widehat{\\varphi}_{1}(\\widehat{\\boldsymbol{x}}_{3}) = \\widehat{\\varphi}_{1}(0,1) = 0 \\implies C_{1} + C_{2}(0) + C_{3}(1) = 0 \\implies 1+C_{3}=0 \\implies C_{3}=-1$。\n因此，$\\widehat{\\varphi}_{1}(\\xi,\\eta) = 1 - \\xi - \\eta$。\n\n对于 $\\widehat{\\varphi}_{2}(\\xi,\\eta)$:\n- $\\widehat{\\varphi}_{2}(\\widehat{\\boldsymbol{x}}_{1}) = \\widehat{\\varphi}_{2}(0,0) = 0 \\implies C_{1} = 0$。\n- $\\widehat{\\varphi}_{2}(\\widehat{\\boldsymbol{x}}_{2}) = \\widehat{\\varphi}_{2}(1,0) = 1 \\implies C_{1} + C_{2} = 1 \\implies C_{2}=1$。\n- $\\widehat{\\varphi}_{2}(\\widehat{\\boldsymbol{x}}_{3}) = \\widehat{\\varphi}_{2}(0,1) = 0 \\implies C_{1} + C_{3} = 0 \\implies C_{3}=0$。\n因此，$\\widehat{\\varphi}_{2}(\\xi,\\eta) = \\xi$。\n\n对于 $\\widehat{\\varphi}_{3}(\\xi,\\eta)$:\n- $\\widehat{\\varphi}_{3}(\\widehat{\\boldsymbol{x}}_{1}) = \\widehat{\\varphi}_{3}(0,0) = 0 \\implies C_{1} = 0$。\n- $\\widehat{\\varphi}_{3}(\\widehat{\\boldsymbol{x}}_{2}) = \\widehat{\\varphi}_{3}(1,0) = 0 \\implies C_{1} + C_{2} = 0 \\implies C_{2}=0$。\n- $\\widehat{\\varphi}_{3}(\\widehat{\\boldsymbol{x}}_{3}) = \\widehat{\\varphi}_{3}(0,1) = 1 \\implies C_{1} + C_{3} = 1 \\implies C_{3}=1$。\n因此，$\\widehat{\\varphi}_{3}(\\xi,\\eta) = \\eta$。\n\n这三个函数，$\\widehat{\\varphi}_{1}(\\xi,\\eta)=1-\\xi-\\eta$、$\\widehat{\\varphi}_{2}(\\xi,\\eta)=\\xi$ 和 $\\widehat{\\varphi}_{3}(\\xi,\\eta)=\\eta$，构成了 $\\mathbb{P}_{1}(\\widehat{K})$ 的基。它们也被称为参考单元上的重心坐标。\n\n**2) 等参映射及其雅可比矩阵**\n\n等参映射 $\\boldsymbol{F}: \\widehat{K} \\to K$ 将参考单元中的点 $\\widehat{\\boldsymbol{x}}=(\\xi,\\eta)$ 关联到物理单元中的点 $\\boldsymbol{x}=(x,y)$。它使用相同的基函数来映射几何形状和表示解。该映射定义为\n$$\n\\boldsymbol{x} = \\boldsymbol{F}(\\widehat{\\boldsymbol{x}}) = \\sum_{i=1}^{3} \\boldsymbol{x}_{i} \\widehat{\\varphi}_{i}(\\widehat{\\boldsymbol{x}})\n$$\n代入第1部分的基函数，我们得到\n$$\n\\boldsymbol{x} = \\boldsymbol{x}_{1}(1-\\xi-\\eta) + \\boldsymbol{x}_{2}\\xi + \\boldsymbol{x}_{3}\\eta\n$$\n这可以重排为一个仿射变换：\n$$\n\\boldsymbol{x} = \\boldsymbol{x}_{1} + (\\boldsymbol{x}_{2}-\\boldsymbol{x}_{1})\\xi + (\\boldsymbol{x}_{3}-\\boldsymbol{x}_{1})\\eta\n$$\n该映射的雅可比矩阵 $J$ 是其一阶偏导数矩阵：\n$$\nJ = \\frac{\\partial \\boldsymbol{x}}{\\partial \\widehat{\\boldsymbol{x}}} = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix}\n$$\n从映射的仿射形式，我们计算偏导数：\n$\\frac{\\partial \\boldsymbol{x}}{\\partial \\xi} = \\boldsymbol{x}_{2} - \\boldsymbol{x}_{1}$ 和 $\\frac{\\partial \\boldsymbol{x}}{\\partial \\eta} = \\boldsymbol{x}_{3} - \\boldsymbol{x}_{1}$。\n以矩阵形式，这给出了常数雅可比矩阵：\n$$\nJ = \\begin{pmatrix} x_2 - x_1  x_3 - x_1 \\\\ y_2 - y_1  y_3 - y_1 \\end{pmatrix}\n$$\n几何上，雅可比矩阵 $J$ 的列是构成物理三角形 $K$ 两条边的向量，具体来说是从顶点 $\\boldsymbol{x}_{1}$ 出发的两条边。雅可比行列式 $\\det(J)$ 是三角形 $K$ 有向面积的两倍。问题陈述指明映射是保向的，这意味着 $\\det(J)  0$。\n\n**3) 梯度的变换**\n\n设 $\\varphi$ 是物理单元 $K$ 上的一个标量函数，$\\widehat{\\varphi}$ 是其在参考单元 $\\widehat{K}$ 上对应的函数，使得 $\\varphi(\\boldsymbol{x})=\\widehat{\\varphi}(\\boldsymbol{F}^{-1}(\\boldsymbol{x}))$。$\\varphi$ 关于物理坐标 $\\boldsymbol{x}=(x,y)$ 的梯度是 $\\nabla_{\\boldsymbol{x}}\\varphi$，$\\widehat{\\varphi}$ 关于参考坐标 $\\widehat{\\boldsymbol{x}}=(\\xi,\\eta)$ 的梯度是 $\\nabla_{\\widehat{\\boldsymbol{x}}}\\widehat{\\varphi}$。\n\n根据多元链式法则，导数关系如下：\n$$\n\\begin{pmatrix} \\frac{\\partial \\widehat{\\varphi}}{\\partial \\xi} \\\\ \\frac{\\partial \\widehat{\\varphi}}{\\partial \\eta} \\end{pmatrix} = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\xi} \\\\ \\frac{\\partial x}{\\partial \\eta}  \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix} \\begin{pmatrix} \\frac{\\partial \\varphi}{\\partial x} \\\\ \\frac{\\partial \\varphi}{\\partial y} \\end{pmatrix}\n$$\n这正是 $\\nabla_{\\widehat{\\boldsymbol{x}}}\\widehat{\\varphi} = J^{T} \\nabla_{\\boldsymbol{x}}\\varphi$。为了用参考梯度表示物理梯度，我们对此关系求逆：\n$$\n\\nabla_{\\boldsymbol{x}}\\varphi = (J^{T})^{-1} \\nabla_{\\widehat{\\boldsymbol{x}}}\\widehat{\\varphi} = (J^{-1})^{T} \\nabla_{\\widehat{\\boldsymbol{x}}}\\widehat{\\varphi}\n$$\n对于 $K$ 上的 $\\mathbb{P}_{1}$ 基函数 $\\varphi_i$，此公式直接适用。参考基函数 $\\widehat{\\varphi}_i$ 的梯度是常向量：\n$\\nabla_{\\widehat{\\boldsymbol{x}}}\\widehat{\\varphi}_{1} = \\begin{pmatrix} -1 \\\\ -1 \\end{pmatrix}$，\n$\\nabla_{\\widehat{\\boldsymbol{x}}}\\widehat{\\varphi}_{2} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$，\n$\\nabla_{\\widehat{\\boldsymbol{x}}}\\widehat{\\varphi}_{3} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$。\n由于 $J$ 是常数，物理梯度 $\\nabla_{\\boldsymbol{x}}\\varphi_i$ 在单元 $K$ 上也是常向量。\n\n**4) 对流矩阵元素 $(A_{e})_{12}$ 的推导**\n\n局部对流矩阵的元素 $(A_{e})_{12}$ 由以下积分给出：\n$$\n(A_{e})_{12} = \\int_{K} (\\boldsymbol{c}\\cdot \\nabla_{\\boldsymbol{x}} \\varphi_{2})\\,\\varphi_{1}\\, \\mathrm{d}\\boldsymbol{x}\n$$\n我们计算被积函数中的各项。首先，我们使用第3部分的变换规则计算物理梯度 $\\nabla_{\\boldsymbol{x}}\\varphi_{2}$。\n$$\n\\nabla_{\\boldsymbol{x}}\\varphi_{2} = (J^{-1})^{T} \\nabla_{\\widehat{\\boldsymbol{x}}}\\widehat{\\varphi}_{2}\n$$\n我们需要雅可比矩阵 $J$ 的逆矩阵。\n$$\nJ^{-1} = \\frac{1}{\\det(J)} \\begin{pmatrix} y_3 - y_1  -(x_3 - x_1) \\\\ -(y_2 - y_1)  x_2 - x_1 \\end{pmatrix}\n$$\n其中 $\\det(J) = (x_2 - x_1)(y_3 - y_1) - (x_3 - x_1)(y_2 - y_1)$。\n逆矩阵的转置是：\n$$\n(J^{-1})^{T} = \\frac{1}{\\det(J)} \\begin{pmatrix} y_3 - y_1  -(y_2 - y_1) \\\\ -(x_3 - x_1)  x_2 - x_1 \\end{pmatrix}\n$$\n代入 $\\nabla_{\\widehat{\\boldsymbol{x}}}\\widehat{\\varphi}_{2} = (1, 0)^{T}$：\n$$\n\\nabla_{\\boldsymbol{x}}\\varphi_{2} = \\frac{1}{\\det(J)} \\begin{pmatrix} y_3 - y_1  -(y_2 - y_1) \\\\ -(x_3 - x_1)  x_2 - x_1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\frac{1}{\\det(J)} \\begin{pmatrix} y_3 - y_1 \\\\ -(x_3 - x_1) \\end{pmatrix}\n$$\n这个梯度在 $K$ 上是常数。现在我们计算与 $\\boldsymbol{c}=(a,b)$ 的点积：\n$$\n\\boldsymbol{c} \\cdot \\nabla_{\\boldsymbol{x}}\\varphi_{2} = \\begin{pmatrix} a \\\\ b \\end{pmatrix} \\cdot \\frac{1}{\\det(J)} \\begin{pmatrix} y_3 - y_1 \\\\ -(x_3 - x_1) \\end{pmatrix} = \\frac{a(y_3 - y_1) - b(x_3 - x_1)}{\\det(J)}\n$$\n由于整个项是常数，可以从积分中提出：\n$$\n(A_{e})_{12} = \\left( \\frac{a(y_3 - y_1) - b(x_3 - x_1)}{\\det(J)} \\right) \\int_{K} \\varphi_{1}\\, \\mathrm{d}\\boldsymbol{x}\n$$\n为了计算剩余的积分，我们使用 $\\mathrm{d}\\boldsymbol{x} = \\det(J)\\mathrm{d}\\widehat{\\boldsymbol{x}}$ 进行变量替换到参考单元：\n$$\n\\int_{K} \\varphi_{1}\\, \\mathrm{d}\\boldsymbol{x} = \\int_{\\widehat{K}} \\widehat{\\varphi}_{1}(\\widehat{\\boldsymbol{x}})\\, \\det(J) \\, \\mathrm{d}\\widehat{\\boldsymbol{x}} = \\det(J) \\int_{0}^{1}\\int_{0}^{1-\\xi} (1-\\xi-\\eta)\\,\\mathrm{d}\\eta\\,\\mathrm{d}\\xi\n$$\n我们计算关于 $\\eta$ 的内层积分：\n$$\n\\int_{0}^{1-\\xi} (1-\\xi-\\eta)\\,\\mathrm{d}\\eta = \\left[(1-\\xi)\\eta - \\frac{\\eta^2}{2}\\right]_{0}^{1-\\xi} = (1-\\xi)^2 - \\frac{(1-\\xi)^2}{2} = \\frac{1}{2}(1-\\xi)^2\n$$\n现在我们计算关于 $\\xi$ 的外层积分：\n$$\n\\int_{0}^{1} \\frac{1}{2}(1-\\xi)^2\\,\\mathrm{d}\\xi = \\frac{1}{2} \\left[ -\\frac{(1-\\xi)^3}{3} \\right]_{0}^{1} = \\frac{1}{2}\\left(0 - \\left(-\\frac{1}{3}\\right)\\right) = \\frac{1}{6}\n$$\n因此，$\\int_{K} \\varphi_{1}\\, \\mathrm{d}\\boldsymbol{x} = \\frac{1}{6}\\det(J)$。此结果对应于通用公式，即重心坐标函数在三角形上的积分等于该三角形面积的三分之一，因为 $\\text{Area}(K) = \\frac{1}{2}\\det(J)$。\n\n将此结果代回 $(A_{e})_{12}$ 的表达式中：\n$$\n(A_{e})_{12} = \\left( \\frac{a(y_3 - y_1) - b(x_3 - x_1)}{\\det(J)} \\right) \\left( \\frac{1}{6}\\det(J) \\right)\n$$\n$\\det(J)$ 项相互抵消，得到最终的闭式表达式：\n$$\n(A_{e})_{12} = \\frac{1}{6} \\left( a(y_3 - y_1) - b(x_3 - x_1) \\right)\n$$\n此表达式仅依赖于对流系数以及顶点 $\\boldsymbol{x}_{1}$ 和 $\\boldsymbol{x}_{3}$ 的坐标，符合要求。",
            "answer": "$$\n\\boxed{\\frac{a(y_{3} - y_{1}) - b(x_{3} - x_{1})}{6}}\n$$"
        },
        {
            "introduction": "对于双曲问题，间断伽辽金 (DG) 方法因其局部守恒性和处理间断的能力而备受青睐。这个练习通过一个简单的设置，揭示了 DG 方法的一个基本性质。通过在 DG 的弱形式中选择一个常数测试函数，您将直接证明单元内解的总变化率精确地由穿过其边界的数值通量来平衡 。",
            "id": "3441789",
            "problem": "考虑一维空间中的标量线性平流方程，\n$$\n\\partial_t u(x,t) + a\\,\\partial_x u(x,t) = 0 \\quad \\text{for } x \\in [0,2h],\\ t0,\n$$\n其中平流速度 $a0$ 为常数，且给定流入边界数据 $u(0,t)=g(t)$。将区域划分为包含两个单元 $K_1=[0,h]$ 和 $K_2=[h,2h]$ 的简单网格。设 $u_h(\\cdot,t)$ 是在每个单元上次数至多为1的多项式空间中的间断伽辽金 (DG) 半离散近似。\n\n采用线性平流的标准迎风数值通量，\n$$\n\\widehat{f}(u^-,u^+) = a\\,u^{\\text{up}}=\n\\begin{cases}\na\\,u^-  \\text{if } a0,\\\\\na\\,u^+  \\text{if } a0,\n\\end{cases}\n$$\n并使用 $\\partial K$ 上的外向单位法向量 $n_{K}(x)$，这样在一维情况下，$n_{K_1}(0)=-1$ 且 $n_{K_1}(h)=+1$。在一个单元 $K$ 上的半离散 DG 格式为：求 $u_h$，使得对于局部多项式空间中的所有检验函数 $v_h$，\n$$\n\\int_{K} \\partial_t u_h\\, v_h\\, dx \\;-\\; \\int_{K} a\\, u_h\\, \\partial_x v_h\\, dx \\;+\\; \\int_{\\partial K} \\widehat{f}\\big(u_h^-,u_h^+\\big)\\, v_h\\, n_{K}\\, ds \\;=\\; 0.\n$$\n\n关注左侧单元 $K_1$ 和 $K_1$ 上的常数检验函数 $v_h \\equiv 1$。定义单元残差\n$$\nR_{K_1}(t) := \\int_{K_1} \\partial_t u_h(x,t)\\, dx,\n$$\n和跨越边界 $\\partial K_1$ 的净数值通量，\n$$\nB_{K_1}(t) := \\int_{\\partial K_1} \\widehat{f}\\big(u_h^-(x,t),u_h^+(x,t)\\big)\\, n_{K_1}(x)\\, ds.\n$$\n\n从上述半离散 DG 格式和给定的数值通量出发，计算量\n$$\nD(t) := R_{K_1}(t) + B_{K_1}(t)\n$$\n的闭式解，如果需要，可以纯粹用 $a$ 和 $g(t)$ 表示，并将其完全化简。你的最终答案必须是单个实数或单个闭式解析表达式。无需四舍五-入，也无需单位。",
            "solution": "问题要求计算量 $D(t) := R_{K_1}(t) + B_{K_1}(t)$。我们首先对问题陈述进行验证。\n\n### 问题验证\n**步骤1：提取已知条件**\n-   **偏微分方程 (PDE):** $\\partial_t u(x,t) + a\\,\\partial_x u(x,t) = 0$，其中 $x \\in [0,2h]$, $t0$。\n-   **平流速度：** $a0$。\n-   **边界条件：** $u(0,t)=g(t)$。\n-   **网格：** 单元 $K_1=[0,h]$ 和 $K_2=[h,2h]$。\n-   **近似空间：** 每个单元上次数至多为1的多项式空间。\n-   **数值通量：** $\\widehat{f}(u^-,u^+) = a\\,u^{\\text{up}}$，当 $a0$ 时为 $\\widehat{f}(u^-,u^+) = a\\,u^-$。\n-   **$K_1$ 的外向法向量：** $n_{K_1}(0)=-1$ 和 $n_{K_1}(h)=+1$。\n-   **半离散DG格式：** 对于一个单元 $K$ 和一个来自局部多项式空间的检验函数 $v_h$，其格式为：\n    $$\n    \\int_{K} \\partial_t u_h\\, v_h\\, dx \\;-\\; \\int_{K} a\\, u_h\\, \\partial_x v_h\\, dx \\;+\\; \\int_{\\partial K} \\widehat{f}\\big(u_h^-,u_h^+\\big)\\, v_h\\, n_{K}\\, ds \\;=\\; 0.\n    $$\n-   **定义：**\n    -   单元残差：$R_{K_1}(t) := \\int_{K_1} \\partial_t u_h(x,t)\\, dx$。\n    -   净数值通量：$B_{K_1}(t) := \\int_{\\partial K_1} \\widehat{f}\\big(u_h^-(x,t),u_h^+(x,t)\\big)\\, n_{K_1}(x)\\, ds$。\n-   **待计算的量：** $D(t) := R_{K_1}(t) + B_{K_1}(t)$。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题具有科学依据，是使用间断伽辽金方法进行偏微分方程数值分析的一个标准练习。它是适定的，提供了所有必要的定义和方程。语言客观、正式。对于所提出的问题，其设置是内部一致且完整的。该问题并非微不足道，因为它需要认识到所定义的量与控制离散方程之间的关系，测试的是一个基本概念，而非死记硬背的计算。因此，该问题被认定为有效。\n\n**步骤3：结论与行动**\n该问题有效。我们继续进行求解。\n\n### 求解\n求解的基础在于问题陈述中提供的半离散间断伽辽金 (DG) 格式。该格式必须对指定近似空间内的任何检验函数 $v_h$ 的选择都成立。\n\n问题指明 $u_h$ 的近似空间由每个单元 $K$ 上次数至多为1的多项式组成。检验函数 $v_h$ 的空间是相同的。这个空间记作 $\\mathcal{P}^1(K)$，包含所有常数函数。问题引导我们关注特定的常数检验函数 $v_h(x) \\equiv 1$，其中 $x \\in K_1$。\n\n在单元 $K_1=[0,h]$ 上的半离散DG格式为：\n$$\n\\int_{K_1} \\partial_t u_h\\, v_h\\, dx \\;-\\; \\int_{K_1} a\\, u_h\\, \\partial_x v_h\\, dx \\;+\\; \\int_{\\partial K_1} \\widehat{f}\\big(u_h^-,u_h^+\\big)\\, v_h\\, n_{K_1}\\, ds \\;=\\; 0.\n$$\n我们将选定的检验函数 $v_h \\equiv 1$ 代入此方程。我们来分别分析每一项。\n\n1.  **第一项：** 第一个积分变为：\n    $$\n    \\int_{K_1} \\partial_t u_h(x,t) \\cdot 1 \\, dx.\n    $$\n    根据问题的定义，这正是单元残差 $R_{K_1}(t)$。\n\n2.  **第二项：** 第二个积分涉及检验函数的空间导数 $\\partial_x v_h$：\n    $$\n    -\\int_{K_1} a\\, u_h(x,t)\\, \\partial_x(1)\\, dx.\n    $$\n    由于 $v_h(x) = 1$ 是一个常数函数，其导数为 $\\partial_x v_h = 0$。因此，这一整项的计算结果为零：\n    $$\n    -\\int_{K_1} a\\, u_h(x,t) \\cdot 0 \\, dx = 0.\n    $$\n\n3.  **第三项：** 第三个积分是边界项：\n    $$\n    \\int_{\\partial K_1} \\widehat{f}\\big(u_h^-(x,t),u_h^+(x,t)\\big) \\cdot 1 \\cdot n_{K_1}(x)\\, ds.\n    $$\n    根据问题的定义，这正是净数值通量 $B_{K_1}(t)$。\n\n将这些结果代回半离散DG格式，我们得到：\n$$\nR_{K_1}(t) - 0 + B_{K_1}(t) = 0,\n$$\n化简后为：\n$$\nR_{K_1}(t) + B_{K_1}(t) = 0.\n$$\n问题要求计算量 $D(t)$，其定义为：\n$$\nD(t) := R_{K_1}(t) + B_{K_1}(t).\n$$\n从我们的推导中可以清楚地看出，这个和等于 $0$。\n\n这个结果是DG方法定义的直接推论。通过选择一个常数检验函数，该格式简化为一个关于 $u_h$ 的单元平均值的变化率被单元边界上的数值通量所平衡的陈述。问题的构造使得待计算的量 $D(t)$ 正好是这个局部守恒律的左侧，根据数值格式的定义，它必须为零。要得出这个结论，并不需要数值通量的具体形式、平流速度 $a$ 的值以及边界数据 $g(t)$。",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "在空间上进行半离散化后，我们得到一个常微分方程组，其时间积分方法的选择对长期仿真的准确性至关重要。波动方程的有限元半离散化会产生一个哈密顿系统，它在物理上对应于能量守恒。这个实践练习通过编码实现，鲜明地对比了保持这种结构的辛积分器（Störmer-Verlet）和通用的非辛积分器（RK4）在长期能量保持上的巨大差异，从而突显了为离散系统选择合适的时间积分方案的重要性 。",
            "id": "3441780",
            "problem": "考虑在单位区间上定义的具有齐次狄利克雷边界条件的一维线性波动方程，采用无量纲变量：寻找一个在 $x \\in [0,1]$ 和 $t \\ge 0$ 上足够光滑的位移场 $u(x,t)$，使得 $u(0,t) = 0$，$u(1,t) = 0$，并且\n$$\n\\frac{\\partial^2 u}{\\partial t^2}(x,t) - \\frac{\\partial^2 u}{\\partial x^2}(x,t) = 0 \\quad \\text{for} \\quad x \\in (0,1), \\ t > 0.\n$$\n采用标准的伽辽金有限元法 (FEM)，在具有 $n$ 个单元的均匀网格上使用连续分段线性基函数，并通过移除边界自由度来施加齐次狄利克雷边界条件。记 $M \\in \\mathbb{R}^{m \\times m}$ 为对称正定质量矩阵，$K \\in \\mathbb{R}^{m \\times m}$ 为对称正定刚度矩阵，$m = n - 1$ 为内部网格节点的数量。节点系数向量 $q(t) \\in \\mathbb{R}^m$ 的半离散系统为\n$$\nM \\ddot{q}(t) + K q(t) = 0,\n$$\n初始条件为 $q(0) = q_0 \\in \\mathbb{R}^m$ 和 $\\dot{q}(0) = v_0 \\in \\mathbb{R}^m$。引入正则动量 $p(t) = M \\dot{q}(t)$ 和离散哈密顿量 (离散能量)\n$$\nH(q,p) = \\frac{1}{2} \\, p^\\top M^{-1} p + \\frac{1}{2} \\, q^\\top K q,\n$$\n从而半离散动力学是哈密顿的：\n$$\n\\dot{q}(t) = M^{-1} p(t), \\qquad \\dot{p}(t) = - K q(t).\n$$\n从波动方程的弱形式和伽辽金投影的定义出发，为具有 $n$ 个单元和线性形函数的均匀网格组装 $M$ 和 $K$。通过在内部节点上对第一个连续模态 $u(x,0) = \\sin(\\pi x)$ 进行采样来设置初始位移，并设置初始速度 $v_0 = 0$。完全使用无量纲量进行计算；此任务中任何地方都不需要物理单位。\n\n实现并比较应用于半离散哈密顿系统的以下两种时间积分器：\n- 一种辛积分器：应用于可分哈密顿量 $H(q,p)$ 的 Störmer–Verlet 格式，定义为\n$$\np_{k+\\frac{1}{2}} = p_k - \\frac{\\Delta t}{2} \\, K q_k, \\quad\nq_{k+1} = q_k + \\Delta t \\, M^{-1} p_{k+\\frac{1}{2}}, \\quad\np_{k+1} = p_{k+\\frac{1}{2}} - \\frac{\\Delta t}{2} \\, K q_{k+1}.\n$$\n- 一种经典非辛积分器：应用于一阶系统 $\\dot{y} = f(y)$ 的显式经典四阶龙格-库塔法（四阶龙格-库塔法，简写为 RK4），其中 $y = (q,p)$ 且 $f(y) = (M^{-1} p, -K q)$。\n\n对于每种方法，在每个时间步 $t_k = k \\Delta t$ 计算离散能量 $H(q_k,p_k)$，并报告在模拟时间窗口内与初始能量相比的最大绝对相对能量偏差，\n$$\n\\max_{0 \\le k \\le N} \\left| \\frac{H(q_k,p_k) - H(q_0,p_0)}{H(q_0,p_0)} \\right|,\n$$\n其中 $N$ 是总时间步数。使用均匀网格（间距 $h=1/n$）上分段线性基函数和齐次狄利克雷边界条件的标准单元级公式来组装 $M$ 和 $K$。您的算法必须利用 $M$ 和 $K$ 的结构，在每个时间步高效地求解形如 $M x = b$ 的线性系统。\n\n使用以下参数集测试套件来探测不同区域。所有量都是无量纲的。对于每种情况，使用指定的单元数 $n$、时间步长 $\\Delta t$ 和最终时间 $T$，并计算 Störmer–Verlet 和 RK4 两种方法的最大绝对相对能量偏差：\n- 情况 1：$n = 50$，$\\Delta t = 0.008$，$T = 20$。\n- 情况 2：$n = 50$，$\\Delta t = 0.009$，$T = 20$。\n- 情况 3：$n = 10$，$\\Delta t = 0.045$，$T = 20$。\n- 情况 4：$n = 200$，$\\Delta t = 0.0015$，$T = 20$。\n\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表。该列表必须按情况 1 到 4 的顺序包含每种情况的数值对 $[\\text{err}_{\\text{SV}}, \\text{err}_{\\text{RK4}}]$，其中 $\\text{err}_{\\text{SV}}$ 是 Störmer–Verlet 方法的最大绝对相对能量偏差，$\\text{err}_{\\text{RK4}}$ 是 RK4 方法的相同量。例如，输出格式应为\n$$\n[ [e_{1,\\text{SV}}, e_{1,\\text{RK4}}], [e_{2,\\text{SV}}, e_{2,\\text{RK4}}], [e_{3,\\text{SV}}, e_{3,\\text{RK4}}], [e_{4,\\text{SV}}, e_{4,\\text{RK4}}] ].\n$$\n只打印这一行；不要打印任何附加文本。",
            "solution": "该问题陈述是偏微分方程数值分析领域中一个有效且适定的练习。它具有科学依据，采用了标准模型（一维波动方程）和数值技术（有限元法、Störmer-Verlet 和 RK4 积分器）。所有必要数据，包括几何参数、物理模型、初始条件、离散化选择和特定测试用例，都已明确给出，没有歧义或矛盾。该问题是自洽的，要求计算一个定义明确的度量（最大相对能量偏差）来比较不同数值格式的定性行为，这是计算科学中一个标准且富有洞察力的任务。因此，我们着手提供一个完整的解法。\n\n问题的核心是求解一维线性波动方程\n$$\n\\frac{\\partial^2 u}{\\partial t^2} - \\frac{\\partial^2 u}{\\partial x^2} = 0, \\quad x \\in (0,1), \\ t  0\n$$\n该方程具有齐次狄利克雷边界条件 $u(0,t) = u(1,t) = 0$。求解过程包括两个主要阶段：空间离散化以获得常微分方程组 (ODEs)，以及对该 ODE 系统的时域积分。\n\n**1. 通过有限元法 (FEM) 进行空间离散化**\n\n我们首先使用伽辽金有限元法将偏微分方程 (PDE) 转化为一个常微分方程组。解 $u(x,t)$ 由一个来自有限维空间 $V_h$ 的函数 $u_h(x,t)$ 逼近。对于本问题，$V_h$ 是定义在区间 $[0,1]$ 的均匀网格上，并在 $x=0$ 和 $x=1$ 处为零的连续分段线性函数空间。\n\n网格由 $n$ 个尺寸均匀的单元组成，大小为 $h=1/n$。节点位于 $x_i = i \\cdot h$ (其中 $i=0, 1, \\dots, n$) 。由于边界条件是齐次的，自由度对应于 $m=n-1$ 个内部节点 ($i=1, \\dots, n-1$)。逼近形式为\n$$\nu_h(x,t) = \\sum_{j=1}^{m} q_j(t) \\phi_j(x)\n$$\n其中 $q_j(t)$ 是表示节点 $x_j$ 处位移的随时间变化的系数，而 $\\phi_j(x)$ 是标准的“帽状”基函数。每个 $\\phi_j(x)$ 都是一个连续的分段线性函数，在节点 $x_j$ 处等于 1，在所有其他节点处等于 0。\n\n伽辽金方法要求 PDE 的残差与基函数正交。在其弱形式下，这导出了半离散系统：\n$$\nM \\ddot{q}(t) + K q(t) = 0\n$$\n其中 $q(t) = [q_1(t), \\dots, q_m(t)]^\\top$ 是节点位移向量。质量矩阵 $M$ 和刚度矩阵 $K$ 是 $m \\times m$ 矩阵，其元素由下式给出：\n$$\nM_{ij} = \\int_0^1 \\phi_i(x) \\phi_j(x) \\, dx\n$$\n$$\nK_{ij} = \\int_0^1 \\frac{d\\phi_i}{dx}(x) \\frac{d\\phi_j}{dx}(x) \\, dx\n$$\n由于基函数的局部支集特性（即，仅当 $|i-j| \\le 1$ 时，$\\phi_i$ 和 $\\phi_j$ 才在重叠区间上非零），这两个矩阵都是对称三对角的。对于间距为 $h$ 的均匀网格，矩阵元素为：\n- **质量矩阵 $M$**：\n  $$\n  M_{ij} = \\begin{cases} \\frac{2h}{3}  \\text{如果 } i=j \\\\ \\frac{h}{6}  \\text{如果 } |i-j|=1 \\\\ 0  \\text{其他情况} \\end{cases}\n  $$\n- **刚度矩阵 $K$**：\n  $$\n  K_{ij} = \\begin{cases} \\frac{2}{h}  \\text{如果 } i=j \\\\ -\\frac{1}{h}  \\text{如果 } |i-j|=1 \\\\ 0  \\text{其他情况} \\end{cases}\n  $$\n对于 $m \\ge 1$，$M$ 和 $K$ 都是对称正定的。它们的三对角结构对计算效率至关重要。\n\n**2. 哈密顿表述**\n\n二阶 ODE 系统 $M\\ddot{q} + K q = 0$ 描述了一个守恒力学系统。它可以被重写为一阶哈密顿系统。我们引入正则动量 $p(t) = M \\dot{q}(t)$。状态向量 $(q,p)$ 的时间演化随后由哈密顿方程控制：\n$$\n\\dot{q} = \\frac{\\partial H}{\\partial p} = M^{-1} p\n$$\n$$\n\\dot{p} = -\\frac{\\partial H}{\\partial q} = -K q\n$$\n哈密顿量 $H(q,p)$ 代表系统的总离散能量，是动能和势能之和：\n$$\nH(q,p) = \\frac{1}{2} \\dot{q}^\\top M \\dot{q} + \\frac{1}{2} q^\\top K q = \\frac{1}{2} p^\\top M^{-1} p + \\frac{1}{2} q^\\top K q\n$$\n对于半离散系统的精确解，该能量 $H$ 是一个守恒量。\n\n**3. 初始条件**\n\n初始位移通过在内部节点 $x_j=jh$（$j=1, \\dots, m$）上对 $u(x,0) = \\sin(\\pi x)$ 进行采样来给出。因此，初始系数向量为\n$$\nq_0 = [\\sin(\\pi h), \\sin(2\\pi h), \\dots, \\sin(m\\pi h)]^\\top\n$$\n初始速度为零，因此 $\\dot{q}(0) = v_0 = 0$。这意味着初始动量也为零：$p(0) = p_0 = M\\dot{q}(0) = 0$。\n初始能量纯粹是势能：\n$$\nH_0 = H(q_0, p_0) = \\frac{1}{2} q_0^\\top K q_0\n$$\n由于 $q_0 \\neq 0$ 且 $K$ 是正定的，所以 $H_0  0$。\n\n**4. 时间积分格式**\n\n我们比较两种从 $(q_0, p_0)$ 开始对哈密顿系统进行时间积分的方法。\n\n**a) Störmer–Verlet (SV) 积分器**\n这是一种辛积分器，意味着它被专门设计用于保持哈密顿系统的几何结构。这一性质带来了出色的长期能量守恒；数值能量不会表现出长期漂移，而是在真实的守恒值附近振荡。该格式定义为：\n$$\n\\begin{aligned}\np_{k+\\frac{1}{2}} = p_k - \\frac{\\Delta t}{2} \\, K q_k \\\\\nq_{k+1} = q_k + \\Delta t \\, M^{-1} p_{k+\\frac{1}{2}} \\\\\np_{k+1} = p_{k+\\frac{1}{2}} - \\frac{\\Delta t}{2} \\, K q_{k+1}\n\\end{aligned}\n$$\n第二步的实现需要求解一个形如 $M x = b$ 的线性系统（其中 $b = p_{k+1/2}$）。由于 $M$ 是三对角的，使用带状矩阵求解器可以在 $O(m)$ 次操作内非常高效地求解，避免了昂贵的 $M^{-1}$ 显式计算。\n\n**b) 经典四阶龙格-库塔 (RK4) 积分器**\nRK4 是一种以其高阶精度而闻名的通用、显式、单步法。对于我们的一阶系统 $\\dot{y} = f(y)$，其中 $y=(q,p)$ 且 $f(y)=(M^{-1}p, -Kq)$，RK4 的更新步骤为：\n$$\n\\begin{aligned}\nk_1 = \\Delta t \\, f(y_k) \\\\\nk_2 = \\Delta t \\, f(y_k + \\frac{1}{2} k_1) \\\\\nk_3 = \\Delta t \\, f(y_k + \\frac{1}{2} k_2) \\\\\nk_4 = \\Delta t \\, f(y_k + k_3) \\\\\ny_{k+1} = y_k + \\frac{1}{6}(k_1 + 2k_2 + 2k_3 + k_4)\n\\end{aligned}\n$$\n每一次函数 $f$ 的求值都需要一次与 $K$ 的矩阵-向量乘积和一次对 $M$ 的线性求解。因此，一个 RK4 步需要四次对 $M$ 的线性求解和四次与 $K$ 的矩阵-向量乘积。尽管其名义精度很高，RK4 并不是辛格式。因此，数值能量不能很好地保持，并预计在长时间模拟中会发生漂移。\n\n**5. 分析与实现**\n\n对于每种方法，模拟从 $t=0$ 运行到 $t=T$。在每个时间步 $t_k=k\\Delta t$，计算离散能量 $H(q_k, p_k)$。项 $p^\\top M^{-1}p$ 可以通过计算 $p^\\top v$ 来高效完成，其中 $v$ 是 $Mv=p$ 的解。整个模拟过程中的最大绝对相对能量偏差为能量守恒提供了一个定量度量：\n$$\n\\max_{0 \\le k \\le N} \\left| \\frac{H_k - H_0}{H_0} \\right|\n$$\n实现将使用带状求解器处理三对角质量矩阵 $M$ 以提高效率。刚度矩阵 $K$ 将以稀疏格式表示，以实现高效的矩阵-向量乘积。代码将针对四个指定的测试用例执行模拟，并报告两种方法的能量偏差。",
            "answer": "```python\nimport numpy as np\nfrom scipy.linalg import solve_banded\nfrom scipy.sparse import diags\n\ndef assemble_matrices(n):\n    \"\"\"\n    Assembles the FEM mass and stiffness matrices for the 1D wave equation.\n\n    Args:\n        n (int): The number of elements.\n\n    Returns:\n        tuple: A tuple containing:\n            - M_banded (np.ndarray): The mass matrix in banded format (3x(n-1)).\n            - K_sparse (scipy.sparse.csr_matrix): The stiffness matrix in sparse CSR format.\n    \"\"\"\n    m = n - 1\n    h = 1.0 / n\n\n    # Mass matrix M in banded format for solve_banded\n    M_banded = np.zeros((3, m))\n    M_banded[0, 1:] = h / 6.0      # Super-diagonal\n    M_banded[1, :] = 4.0 * h / 6.0 # Main diagonal\n    M_banded[2, :-1] = h / 6.0     # Sub-diagonal\n\n    # Stiffness matrix K in sparse format for mat-vec products\n    sub_diag_K = np.full(m - 1, -1.0 / h)\n    main_diag_K = np.full(m, 2.0 / h)\n    K_sparse = diags([sub_diag_K, main_diag_K, sub_diag_K], [-1, 0, 1], shape=(m, m), format='csr')\n\n    return M_banded, K_sparse\n\ndef compute_energy(q, p, M_banded, K_sparse):\n    \"\"\"\n    Computes the discrete Hamiltonian (energy).\n\n    Args:\n        q (np.ndarray): The displacement vector.\n        p (np.ndarray): The momentum vector.\n        M_banded (np.ndarray): The mass matrix in banded format.\n        K_sparse (scipy.sparse.csr_matrix): The stiffness matrix in sparse format.\n\n    Returns:\n        float: The total discrete energy.\n    \"\"\"\n    # Kinetic energy: 0.5 * p^T * M^-1 * p\n    # Let v = M^-1 * p. Solve M*v = p for v. Then energy is 0.5 * p^T * v.\n    v = solve_banded((1, 1), M_banded, p)\n    kinetic_energy = 0.5 * np.dot(p, v)\n\n    # Potential energy: 0.5 * q^T * K * q\n    Kq = K_sparse @ q\n    potential_energy = 0.5 * np.dot(q, Kq)\n\n    return kinetic_energy + potential_energy\n\ndef solve_sv(n, dt, T):\n    \"\"\"\n    Solves the system using the Störmer-Verlet integrator.\n    \"\"\"\n    m = n - 1\n    M_banded, K_sparse = assemble_matrices(n)\n\n    # Initial conditions\n    x_nodes = np.linspace(0, 1, n + 1)[1:-1]\n    q = np.sin(np.pi * x_nodes)\n    p = np.zeros(m)\n\n    initial_energy = compute_energy(q, p, M_banded, K_sparse)\n    if initial_energy == 0:\n        return 0.0\n\n    max_rel_energy_dev = 0.0\n    num_steps = int(round(T / dt))\n\n    for _ in range(num_steps):\n        # Störmer-Verlet steps\n        p_half = p - (dt / 2.0) * (K_sparse @ q)\n        q = q + dt * solve_banded((1, 1), M_banded, p_half)\n        p = p_half - (dt / 2.0) * (K_sparse @ q)\n\n        current_energy = compute_energy(q, p, M_banded, K_sparse)\n        rel_dev = np.abs((current_energy - initial_energy) / initial_energy)\n        if rel_dev > max_rel_energy_dev:\n            max_rel_energy_dev = rel_dev\n\n    return max_rel_energy_dev\n\ndef solve_rk4(n, dt, T):\n    \"\"\"\n    Solves the system using the classical 4th-order Runge-Kutta integrator.\n    \"\"\"\n    m = n - 1\n    M_banded, K_sparse = assemble_matrices(n)\n\n    # Initial conditions\n    x_nodes = np.linspace(0, 1, n + 1)[1:-1]\n    q = np.sin(np.pi * x_nodes)\n    p = np.zeros(m)\n\n    initial_energy = compute_energy(q, p, M_banded, K_sparse)\n    if initial_energy == 0:\n        return 0.0\n\n    max_rel_energy_dev = 0.0\n    num_steps = int(round(T / dt))\n\n    def f(q_in, p_in):\n        f_q = solve_banded((1, 1), M_banded, p_in)\n        f_p = -1.0 * (K_sparse @ q_in)\n        return f_q, f_p\n\n    for _ in range(num_steps):\n        # RK4 stages\n        k1_q, k1_p = f(q, p)\n        \n        q_temp_2 = q + (dt / 2.0) * k1_q\n        p_temp_2 = p + (dt / 2.0) * k1_p\n        k2_q, k2_p = f(q_temp_2, p_temp_2)\n        \n        q_temp_3 = q + (dt / 2.0) * k2_q\n        p_temp_3 = p + (dt / 2.0) * k2_p\n        k3_q, k3_p = f(q_temp_3, p_temp_3)\n        \n        q_temp_4 = q + dt * k3_q\n        p_temp_4 = p + dt * k3_p\n        k4_q, k4_p = f(q_temp_4, p_temp_4)\n\n        # Update\n        q += (dt / 6.0) * (k1_q + 2*k2_q + 2*k3_q + k4_q)\n        p += (dt / 6.0) * (k1_p + 2*k2_p + 2*k3_p + k4_p)\n\n        current_energy = compute_energy(q, p, M_banded, K_sparse)\n        rel_dev = np.abs((current_energy - initial_energy) / initial_energy)\n        if rel_dev > max_rel_energy_dev:\n            max_rel_energy_dev = rel_dev\n            \n    return max_rel_energy_dev\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    test_cases = [\n        # (n, dt, T)\n        (50, 0.008, 20),\n        (50, 0.009, 20),\n        (10, 0.045, 20),\n        (200, 0.0015, 20),\n    ]\n\n    results = []\n    for case in test_cases:\n        n, dt, T = case\n        err_sv = solve_sv(n, dt, T)\n        err_rk4 = solve_rk4(n, dt, T)\n        results.append([err_sv, err_rk4])\n\n    results_str = []\n    for res_pair in results:\n        results_str.append(f\"[{res_pair[0]}, {res_pair[1]}]\")\n    final_output = f\"[{', '.join(results_str)}]\"\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}