{
    "hands_on_practices": [
        {
            "introduction": "Barycentric coordinates form the natural language for describing positions within a triangle, serving as the foundation for linear finite element basis functions. This first practice grounds this abstract concept in a tangible geometric reality. By calculating these coordinates using area ratios, you will develop a fundamental skill and verify the core property that any point inside a triangle can be uniquely expressed as a weighted average of its vertices. ",
            "id": "3458200",
            "problem": "Consider a nondegenerate triangle in two dimensions with vertices $\\boldsymbol{x}_1=(1,2)$, $\\boldsymbol{x}_2=(4,3)$, and $\\boldsymbol{x}_3=(2,7)$. In the linear Lagrange finite element setting within the Finite Element Method (FEM), the barycentric coordinates $\\lambda_1$, $\\lambda_2$, and $\\lambda_3$ of a point $\\boldsymbol{x}=(2.5,3.5)$ with respect to the ordered vertices $\\{\\boldsymbol{x}_1,\\boldsymbol{x}_2,\\boldsymbol{x}_3\\}$ are the unique affine functions satisfying the nodal conditions $\\lambda_i(\\boldsymbol{x}_j)=\\delta_{ij}$ and the partition of unity constraint $\\lambda_1+\\lambda_2+\\lambda_3=1$. Starting only from these defining properties and the fundamental geometric fact that the area of a triangle equals one-half the base times the corresponding height, compute the barycentric coordinates by partitioning the original triangle into the three subtriangles formed by $\\boldsymbol{x}$ and the edges, and verify their correctness by direct substitution into the defining relations (namely, that $\\lambda_1+\\lambda_2+\\lambda_3=1$ and that $\\boldsymbol{x}=\\lambda_1\\boldsymbol{x}_1+\\lambda_2\\boldsymbol{x}_2+\\lambda_3\\boldsymbol{x}_3$). Express your final answer as the row matrix of the three barycentric coordinates in the order $(\\lambda_1,\\lambda_2,\\lambda_3)$. No rounding is required, and no units are involved.",
            "solution": "The problem is first assessed for validity.\n**Step 1: Extract Givens**\n- Vertices of the triangle: $\\boldsymbol{x}_1=(1,2)$, $\\boldsymbol{x}_2=(4,3)$, $\\boldsymbol{x}_3=(2,7)$.\n- The triangle is specified as nondegenerate.\n- A point $\\boldsymbol{x}=(2.5,3.5)$.\n- Barycentric coordinates $\\lambda_1, \\lambda_2, \\lambda_3$ are defined as unique affine functions satisfying:\n  1. Nodal conditions: $\\lambda_i(\\boldsymbol{x}_j)=\\delta_{ij}$.\n  2. Partition of unity: $\\lambda_1+\\lambda_2+\\lambda_3=1$.\n- The computation must be performed by relating the barycentric coordinates to the areas of subtriangles formed by the point $\\boldsymbol{x}$ and the vertices of the main triangle.\n- The fundamental geometric definition of area as one-half base times height is the starting point.\n- The result must be verified by confirming both the partition of unity and the affine combination $\\boldsymbol{x}=\\lambda_1\\boldsymbol{x}_1+\\lambda_2\\boldsymbol{x}_2+\\lambda_3\\boldsymbol{x}_3$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, well-posed, and objective. It presents a standard problem in computational geometry and finite element analysis. All necessary data are provided, and the definitions are consistent with established mathematical principles. The constraint to use the geometric definition of area is a pedagogical one, leading to the standard area-ratio definition of barycentric coordinates. The problem is free of any logical flaws, ambiguities, or contradictions. A quick check of the area of the main triangle using the determinant formula, $\\frac{1}{2} |1(3-7) + 4(7-2) + 2(2-3)| = \\frac{1}{2} |-4 + 20 - 2| = \\frac{14}{2} = 7$, confirms that the area is non-zero, thus the triangle is indeed nondegenerate as stated.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A rigorous solution will be provided.\n\n**Solution Derivation**\nThe barycentric coordinates $(\\lambda_1, \\lambda_2, \\lambda_3)$ of a point $\\boldsymbol{x}$ with respect to the vertices $(\\boldsymbol{x}_1, \\boldsymbol{x}_2, \\boldsymbol{x}_3)$ of a triangle $T$ are given by the ratios of the areas of the subtriangles to the area of the main triangle. Specifically, if $A$ is the area of the triangle $T$ with vertices $\\boldsymbol{x}_1, \\boldsymbol{x}_2, \\boldsymbol{x}_3$, and $A_1, A_2, A_3$ are the areas of the subtriangles with vertices $(\\boldsymbol{x}, \\boldsymbol{x}_2, \\boldsymbol{x}_3)$, $(\\boldsymbol{x}_1, \\boldsymbol{x}, \\boldsymbol{x}_3)$, and $(\\boldsymbol{x}_1, \\boldsymbol{x}_2, \\boldsymbol{x})$ respectively, then the barycentric coordinates are defined as:\n$$ \\lambda_1 = \\frac{A_1}{A}, \\quad \\lambda_2 = \\frac{A_2}{A}, \\quad \\lambda_3 = \\frac{A_3}{A} $$\nThis definition implicitly satisfies the partition of unity, $\\sum \\lambda_i = \\frac{A_1+A_2+A_3}{A} = \\frac{A}{A}=1$, assuming the point $\\boldsymbol{x}$ is inside the triangle $T$.\n\nThe problem requires starting from the geometric definition of area. A computationally efficient method derived from this principle is to use the determinant (or shoelace) formula. The signed area of a triangle with vertices $(x_a, y_a)$, $(x_b, y_b)$, and $(x_c, y_c)$ ordered counter-clockwise is given by:\n$$ \\text{Area} = \\frac{1}{2} \\det \\begin{pmatrix} x_a & y_a & 1 \\\\ x_b & y_b & 1 \\\\ x_c & y_c & 1 \\end{pmatrix} = \\frac{1}{2} [x_a(y_b - y_c) + x_b(y_c - y_a) + x_c(y_a - y_b)] $$\nThis is a direct algebraic formalization of calculating area from vertex coordinates.\n\nThe given vertices are $\\boldsymbol{x}_1=(1,2)$, $\\boldsymbol{x}_2=(4,3)$, and $\\boldsymbol{x}_3=(2,7)$. The point is $\\boldsymbol{x}=(2.5,3.5)$, which can be written as $(\\frac{5}{2}, \\frac{7}{2})$.\n\nFirst, we calculate the total area $A$ of the triangle $T$ defined by $\\boldsymbol{x}_1, \\boldsymbol{x}_2, \\boldsymbol{x}_3$.\n$$ A = \\frac{1}{2} \\left| \\det \\begin{pmatrix} 1 & 2 & 1 \\\\ 4 & 3 & 1 \\\\ 2 & 7 & 1 \\end{pmatrix} \\right| $$\nThe determinant is $1(3 \\cdot 1 - 7 \\cdot 1) - 2(4 \\cdot 1 - 2 \\cdot 1) + 1(4 \\cdot 7 - 2 \\cdot 3) = 1(3-7) - 2(4-2) + 1(28-6) = -4 - 2(2) + 22 = -4-4+22 = 14$.\nSince the determinant is positive, the vertices are ordered counter-clockwise. The area is $A = \\frac{1}{2}(14) = 7$.\n\nNext, we compute the area $A_1$ of the subtriangle with vertices $\\boldsymbol{x}, \\boldsymbol{x}_2, \\boldsymbol{x}_3$.\n$$ A_1 = \\frac{1}{2} \\det \\begin{pmatrix} 2.5 & 3.5 & 1 \\\\ 4 & 3 & 1 \\\\ 2 & 7 & 1 \\end{pmatrix} = \\frac{1}{2} [2.5(3-7) - 3.5(4-2) + 1(28-6)] $$\n$$ A_1 = \\frac{1}{2} [2.5(-4) - 3.5(2) + 22] = \\frac{1}{2}[-10 - 7 + 22] = \\frac{1}{2}(5) = 2.5 = \\frac{5}{2} $$\nTherefore, $\\lambda_1 = \\frac{A_1}{A} = \\frac{2.5}{7} = \\frac{5/2}{7} = \\frac{5}{14}$.\n\nNext, we compute the area $A_2$ of the subtriangle with vertices $\\boldsymbol{x}_1, \\boldsymbol{x}, \\boldsymbol{x}_3$.\n$$ A_2 = \\frac{1}{2} \\det \\begin{pmatrix} 1 & 2 & 1 \\\\ 2.5 & 3.5 & 1 \\\\ 2 & 7 & 1 \\end{pmatrix} = \\frac{1}{2} [1(3.5-7) - 2(2.5-2) + 1(17.5-7)] $$\n$$ A_2 = \\frac{1}{2} [-3.5 - 2(0.5) + 10.5] = \\frac{1}{2}[-3.5 - 1 + 10.5] = \\frac{1}{2}(6) = 3 $$\nTherefore, $\\lambda_2 = \\frac{A_2}{A} = \\frac{3}{7}$.\n\nFinally, we compute the area $A_3$ of the subtriangle with vertices $\\boldsymbol{x}_1, \\boldsymbol{x}_2, \\boldsymbol{x}$.\n$$ A_3 = \\frac{1}{2} \\det \\begin{pmatrix} 1 & 2 & 1 \\\\ 4 & 3 & 1 \\\\ 2.5 & 3.5 & 1 \\end{pmatrix} = \\frac{1}{2} [1(3-3.5) - 2(4-2.5) + 1(14-7.5)] $$\n$$ A_3 = \\frac{1}{2} [-0.5 - 2(1.5) + 6.5] = \\frac{1}{2}[-0.5 - 3 + 6.5] = \\frac{1}{2}(3) = 1.5 = \\frac{3}{2} $$\nTherefore, $\\lambda_3 = \\frac{A_3}{A} = \\frac{1.5}{7} = \\frac{3/2}{7} = \\frac{3}{14}$.\n\nThe computed barycentric coordinates are $(\\lambda_1, \\lambda_2, \\lambda_3) = (\\frac{5}{14}, \\frac{3}{7}, \\frac{3}{14})$.\n\n**Verification**\nWe verify the result against the two conditions given.\n1. Partition of unity:\n$$ \\lambda_1 + \\lambda_2 + \\lambda_3 = \\frac{5}{14} + \\frac{3}{7} + \\frac{3}{14} = \\frac{5}{14} + \\frac{6}{14} + \\frac{3}{14} = \\frac{5+6+3}{14} = \\frac{14}{14} = 1 $$\nThe condition is satisfied.\n\n2. Affine combination:\nWe must check if $\\boldsymbol{x} = \\lambda_1\\boldsymbol{x}_1+\\lambda_2\\boldsymbol{x}_2+\\lambda_3\\boldsymbol{x}_3$.\nThe right-hand side is:\n$$ \\frac{5}{14}(1,2) + \\frac{3}{7}(4,3) + \\frac{3}{14}(2,7) = \\frac{5}{14}(1,2) + \\frac{6}{14}(4,3) + \\frac{3}{14}(2,7) $$\nFor the x-coordinate:\n$$ \\frac{1}{14}(5 \\cdot 1 + 6 \\cdot 4 + 3 \\cdot 2) = \\frac{1}{14}(5 + 24 + 6) = \\frac{35}{14} = \\frac{5}{2} = 2.5 $$\nFor the y-coordinate:\n$$ \\frac{1}{14}(5 \\cdot 2 + 6 \\cdot 3 + 3 \\cdot 7) = \\frac{1}{14}(10 + 18 + 21) = \\frac{49}{14} = \\frac{7}{2} = 3.5 $$\nThe resulting point is $(2.5, 3.5)$, which is equal to the given point $\\boldsymbol{x}$. This condition is also satisfied.\n\nBoth checks confirm the correctness of the calculated barycentric coordinates.\nThe final answer is the set of coordinates $(\\lambda_1, \\lambda_2, \\lambda_3)$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{5}{14} & \\frac{3}{7} & \\frac{3}{14} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "To achieve higher accuracy in finite element analysis, we often move from linear to higher-order polynomial basis functions, such as quadratic ($P_2$) elements. This practice explores the construction of these functions from the building blocks of linear barycentric coordinates. You will verify the defining 'Kronecker delta' property of a quadratic edge basis function, which ensures it equals one at its own node (the edge midpoint) and zero at all other nodes in the element. ",
            "id": "3458251",
            "problem": "Consider a nondegenerate triangle $T \\subset \\mathbb{R}^{2}$ with vertices $\\boldsymbol{x}_{1}$, $\\boldsymbol{x}_{2}$, and $\\boldsymbol{x}_{3}$. Let $\\lambda_{1}$, $\\lambda_{2}$, and $\\lambda_{3}$ denote the barycentric coordinates on $T$, defined as the unique affine functions satisfying $\\lambda_{i}(\\boldsymbol{x}_{j}) = \\delta_{ij}$ for $i,j \\in \\{1,2,3\\}$ and $\\lambda_{1}+\\lambda_{2}+\\lambda_{3}=1$ on $T$, where $\\delta_{ij}$ is the Kronecker delta. In the quadratic Lagrange finite element space on $T$, the six interpolation nodes are the vertices and the midpoints of the edges:\n$$\n\\boldsymbol{x}_{1},\\quad \\boldsymbol{x}_{2},\\quad \\boldsymbol{x}_{3},\\quad \\frac{\\boldsymbol{x}_{1}+\\boldsymbol{x}_{2}}{2},\\quad \\frac{\\boldsymbol{x}_{2}+\\boldsymbol{x}_{3}}{2},\\quad \\frac{\\boldsymbol{x}_{3}+\\boldsymbol{x}_{1}}{2}.\n$$\nDefine the candidate edge basis function associated with the edge $(1,2)$ by $N_{12}(\\boldsymbol{x}) = 4\\,\\lambda_{1}(\\boldsymbol{x})\\,\\lambda_{2}(\\boldsymbol{x})$. Starting from the fundamental definitions of barycentric coordinates and the interpolation nodes above, determine the values of $N_{12}$ at the six nodes, in the order listed. Express your final answer as a single row matrix. No rounding is required.",
            "solution": "The problem requires the evaluation of a candidate quadratic basis function, $N_{12}(\\boldsymbol{x})$, at six specified interpolation nodes on a triangle $T$. The nodes consist of the three vertices $\\boldsymbol{x}_{1}, \\boldsymbol{x}_{2}, \\boldsymbol{x}_{3}$ and the three edge midpoints. The function is defined in terms of the barycentric coordinates $\\lambda_{1}(\\boldsymbol{x})$ and $\\lambda_{2}(\\boldsymbol{x})$ as $N_{12}(\\boldsymbol{x}) = 4\\,\\lambda_{1}(\\boldsymbol{x})\\,\\lambda_{2}(\\boldsymbol{x})$.\n\nThe evaluation relies on two fundamental properties of barycentric coordinates:\n1.  For any vertex $\\boldsymbol{x}_{j}$ of the triangle, the barycentric coordinate function $\\lambda_{i}(\\boldsymbol{x})$ satisfies $\\lambda_{i}(\\boldsymbol{x}_{j}) = \\delta_{ij}$, where $\\delta_{ij}$ is the Kronecker delta. This means $\\lambda_{i}$ is equal to $1$ at vertex $\\boldsymbol{x}_{i}$ and $0$ at all other vertices.\n2.  Barycentric coordinates are affine functions. This implies that for any two points $\\boldsymbol{a}, \\boldsymbol{b}$ and a scalar $t \\in \\mathbb{R}$, $\\lambda_{i}(t\\boldsymbol{a} + (1-t)\\boldsymbol{b}) = t\\lambda_{i}(\\boldsymbol{a}) + (1-t)\\lambda_{i}(\\boldsymbol{b})$.\n\nWe proceed to evaluate $N_{12}(\\boldsymbol{x})$ at each of the six nodes in the specified order.\n\n1.  **At vertex $\\boldsymbol{x}_{1}$**:\n    We use the property $\\lambda_{i}(\\boldsymbol{x}_{j}) = \\delta_{ij}$. The values of the relevant barycentric coordinates are $\\lambda_{1}(\\boldsymbol{x}_{1}) = 1$ and $\\lambda_{2}(\\boldsymbol{x}_{1}) = 0$.\n    Therefore, the value of the function is:\n    $$N_{12}(\\boldsymbol{x}_{1}) = 4\\,\\lambda_{1}(\\boldsymbol{x}_{1})\\,\\lambda_{2}(\\boldsymbol{x}_{1}) = 4 \\cdot 1 \\cdot 0 = 0$$\n\n2.  **At vertex $\\boldsymbol{x}_{2}$**:\n    The values of the barycentric coordinates are $\\lambda_{1}(\\boldsymbol{x}_{2}) = 0$ and $\\lambda_{2}(\\boldsymbol{x}_{2}) = 1$.\n    Therefore, the value of the function is:\n    $$N_{12}(\\boldsymbol{x}_{2}) = 4\\,\\lambda_{1}(\\boldsymbol{x}_{2})\\,\\lambda_{2}(\\boldsymbol{x}_{2}) = 4 \\cdot 0 \\cdot 1 = 0$$\n\n3.  **At vertex $\\boldsymbol{x}_{3}$**:\n    The values of the barycentric coordinates are $\\lambda_{1}(\\boldsymbol{x}_{3}) = 0$ and $\\lambda_{2}(\\boldsymbol{x}_{3}) = 0$.\n    Therefore, the value of the function is:\n    $$N_{12}(\\boldsymbol{x}_{3}) = 4\\,\\lambda_{1}(\\boldsymbol{x}_{3})\\,\\lambda_{2}(\\boldsymbol{x}_{3}) = 4 \\cdot 0 \\cdot 0 = 0$$\n\n4.  **At the midpoint of edge $(1,2)$, $\\boldsymbol{x}_{12} = \\frac{\\boldsymbol{x}_{1}+\\boldsymbol{x}_{2}}{2}$**:\n    We use the affine property of the barycentric coordinates with $t = \\frac{1}{2}$, $\\boldsymbol{a} = \\boldsymbol{x}_{1}$, and $\\boldsymbol{b} = \\boldsymbol{x}_{2}$. For $\\lambda_{1}$:\n    $$\\lambda_{1}(\\boldsymbol{x}_{12}) = \\lambda_{1}\\left(\\frac{1}{2}\\boldsymbol{x}_{1} + \\frac{1}{2}\\boldsymbol{x}_{2}\\right) = \\frac{1}{2}\\lambda_{1}(\\boldsymbol{x}_{1}) + \\frac{1}{2}\\lambda_{1}(\\boldsymbol{x}_{2}) = \\frac{1}{2}(1) + \\frac{1}{2}(0) = \\frac{1}{2}$$\n    For $\\lambda_{2}$:\n    $$\\lambda_{2}(\\boldsymbol{x}_{12}) = \\lambda_{2}\\left(\\frac{1}{2}\\boldsymbol{x}_{1} + \\frac{1}{2}\\boldsymbol{x}_{2}\\right) = \\frac{1}{2}\\lambda_{2}(\\boldsymbol{x}_{1}) + \\frac{1}{2}\\lambda_{2}(\\boldsymbol{x}_{2}) = \\frac{1}{2}(0) + \\frac{1}{2}(1) = \\frac{1}{2}$$\n    Now we can evaluate the function:\n    $$N_{12}(\\boldsymbol{x}_{12}) = 4\\,\\lambda_{1}(\\boldsymbol{x}_{12})\\,\\lambda_{2}(\\boldsymbol{x}_{12}) = 4 \\cdot \\frac{1}{2} \\cdot \\frac{1}{2} = 1$$\n\n5.  **At the midpoint of edge $(2,3)$, $\\boldsymbol{x}_{23} = \\frac{\\boldsymbol{x}_{2}+\\boldsymbol{x}_{3}}{2}$**:\n    Using the affine property with $\\boldsymbol{a} = \\boldsymbol{x}_{2}$ and $\\boldsymbol{b} = \\boldsymbol{x}_{3}$:\n    $$\\lambda_{1}(\\boldsymbol{x}_{23}) = \\frac{1}{2}\\lambda_{1}(\\boldsymbol{x}_{2}) + \\frac{1}{2}\\lambda_{1}(\\boldsymbol{x}_{3}) = \\frac{1}{2}(0) + \\frac{1}{2}(0) = 0$$\n    $$\\lambda_{2}(\\boldsymbol{x}_{23}) = \\frac{1}{2}\\lambda_{2}(\\boldsymbol{x}_{2}) + \\frac{1}{2}\\lambda_{2}(\\boldsymbol{x}_{3}) = \\frac{1}{2}(1) + \\frac{1}{2}(0) = \\frac{1}{2}$$\n    The value of the function is:\n    $$N_{12}(\\boldsymbol{x}_{23}) = 4\\,\\lambda_{1}(\\boldsymbol{x}_{23})\\,\\lambda_{2}(\\boldsymbol{x}_{23}) = 4 \\cdot 0 \\cdot \\frac{1}{2} = 0$$\n\n6.  **At the midpoint of edge $(3,1)$, $\\boldsymbol{x}_{31} = \\frac{\\boldsymbol{x}_{3}+\\boldsymbol{x}_{1}}{2}$**:\n    Using the affine property with $\\boldsymbol{a} = \\boldsymbol{x}_{3}$ and $\\boldsymbol{b} = \\boldsymbol{x}_{1}$:\n    $$\\lambda_{1}(\\boldsymbol{x}_{31}) = \\frac{1}{2}\\lambda_{1}(\\boldsymbol{x}_{3}) + \\frac{1}{2}\\lambda_{1}(\\boldsymbol{x}_{1}) = \\frac{1}{2}(0) + \\frac{1}{2}(1) = \\frac{1}{2}$$\n    $$\\lambda_{2}(\\boldsymbol{x}_{31}) = \\frac{1}{2}\\lambda_{2}(\\boldsymbol{x}_{3}) + \\frac{1}{2}\\lambda_{2}(\\boldsymbol{x}_{1}) = \\frac{1}{2}(0) + \\frac{1}{2}(0) = 0$$\n    The value of the function is:\n    $$N_{12}(\\boldsymbol{x}_{31}) = 4\\,\\lambda_{1}(\\boldsymbol{x}_{31})\\,\\lambda_{2}(\\boldsymbol{x}_{31}) = 4 \\cdot \\frac{1}{2} \\cdot 0 = 0$$\n\nSummarizing the results in the requested order:\n-   $N_{12}(\\boldsymbol{x}_{1}) = 0$\n-   $N_{12}(\\boldsymbol{x}_{2}) = 0$\n-   $N_{12}(\\boldsymbol{x}_{3}) = 0$\n-   $N_{12}(\\frac{\\boldsymbol{x}_{1}+\\boldsymbol{x}_{2}}{2}) = 1$\n-   $N_{12}(\\frac{\\boldsymbol{x}_{2}+\\boldsymbol{x}_{3}}{2}) = 0$\n-   $N_{12}(\\frac{\\boldsymbol{x}_{3}+\\boldsymbol{x}_{1}}{2}) = 0$\n\nThese values form the components of the required row matrix. The function $N_{12}(\\boldsymbol{x})$ is indeed the quadratic Lagrange basis function associated with the midpoint of edge $(1,2)$, as it evaluates to $1$ at that node and $0$ at all other specified nodes.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0 & 0 & 0 & 1 & 0 & 0 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "Not all finite elements enforce strict continuity across their boundaries; nonconforming elements like the Crouzeix–Raviart (CR) element offer unique advantages for certain classes of problems. This practice introduces this alternative formulation, where degrees of freedom are located at edge midpoints rather than vertices. By deriving the linear basis functions on a reference element from first principles, you will gain insight into the construction of non-standard elements and the crucial technique of mapping from a reference to a physical domain. ",
            "id": "3458227",
            "problem": "Consider the Crouzeix–Raviart (CR) nonconforming finite element for two-dimensional triangles used in the numerical solution of partial differential equations (PDEs). The local polynomial space on a single triangle is the space of linear polynomials, and the degrees of freedom are given by pointwise evaluation at the midpoints of the three edges. On the reference triangle $\\hat{T} = \\operatorname{conv}\\{(0,0),(1,0),(0,1)\\}$ with edges $\\hat{e}_{1} = \\operatorname{conv}\\{(0,0),(1,0)\\}$, $\\hat{e}_{2} = \\operatorname{conv}\\{(1,0),(0,1)\\}$, and $\\hat{e}_{3} = \\operatorname{conv}\\{(0,1),(0,0)\\}$, let the edge midpoints be $\\hat{m}_{1} = (1/2,0)$, $\\hat{m}_{2} = (1/2,1/2)$, and $\\hat{m}_{3} = (0,1/2)$. \n\nStarting from the foundational definitions of the CR element and the affine mapping of linear polynomials under a change of coordinates, derive the explicit CR shape functions $\\hat{\\varphi}_{i}(\\hat{x},\\hat{y})$ on $\\hat{T}$ that are linear polynomials satisfying $\\hat{\\varphi}_{i}(\\hat{m}_{i}) = 1$ and $\\hat{\\varphi}_{i}(\\hat{m}_{j}) = 0$ for $j \\neq i$. Then, using a general physical triangle $T = \\operatorname{conv}\\{\\mathbf{x}_{1},\\mathbf{x}_{2},\\mathbf{x}_{3}\\}$ with the affine mapping $F(\\hat{\\mathbf{x}}) = \\mathbf{x}_{1} + B \\hat{\\mathbf{x}}$, where $B = [\\mathbf{x}_{2} - \\mathbf{x}_{1}\\ \\ \\mathbf{x}_{3} - \\mathbf{x}_{1}]$ is the $2 \\times 2$ matrix whose columns are the two edge vectors emanating from $\\mathbf{x}_{1}$, explain how to obtain the corresponding CR shape functions on $T$ and express them in terms of barycentric coordinates $\\lambda_{1}$, $\\lambda_{2}$, $\\lambda_{3}$ on $T$.\n\nYour final answer must be the explicit triple of CR shape functions on the reference triangle $\\hat{T}$ written as a single row matrix. No numerical rounding is required.",
            "solution": "The problem statement is analyzed for validity.\n\n**Step 1: Extract Givens**\n-   **Element Type**: Crouzeix–Raviart (CR) nonconforming finite element for two-dimensional triangles.\n-   **Local Polynomial Space**: Space of linear polynomials ($P_1$) on a single triangle.\n-   **Degrees of Freedom (DOFs)**: Pointwise evaluation at the midpoints of the three edges.\n-   **Reference Triangle**: $\\hat{T} = \\operatorname{conv}\\{(0,0),(1,0),(0,1)\\}$.\n-   **Reference Edges**:\n    -   $\\hat{e}_{1} = \\operatorname{conv}\\{(0,0),(1,0)\\}$\n    -   $\\hat{e}_{2} = \\operatorname{conv}\\{(1,0),(0,1)\\}$\n    -   $\\hat{e}_{3} = \\operatorname{conv}\\{(0,1),(0,0)\\}$\n-   **Reference Edge Midpoints**:\n    -   $\\hat{m}_{1} = (1/2,0)$\n    -   $\\hat{m}_{2} = (1/2,1/2)$\n    -   $\\hat{m}_{3} = (0,1/2)$\n-   **Task 1**: Derive explicit CR shape functions $\\hat{\\varphi}_{i}(\\hat{x},\\hat{y})$ on $\\hat{T}$.\n-   **Conditions for Shape Functions**: $\\hat{\\varphi}_{i}(\\hat{x},\\hat{y})$ are linear polynomials satisfying $\\hat{\\varphi}_{i}(\\hat{m}_{i}) = 1$ and $\\hat{\\varphi}_{i}(\\hat{m}_{j}) = 0$ for $j \\neq i$.\n-   **Task 2**: On a general physical triangle $T = \\operatorname{conv}\\{\\mathbf{x}_{1},\\mathbf{x}_{2},\\mathbf{x}_{3}\\}$ with affine mapping $F(\\hat{\\mathbf{x}}) = \\mathbf{x}_{1} + B \\hat{\\mathbf{x}}$, where $B = [\\mathbf{x}_{2} - \\mathbf{x}_{1}\\ \\ \\mathbf{x}_{3} - \\mathbf{x}_{1}]$, explain how to obtain the corresponding CR shape functions on $T$.\n-   **Task 3**: Express the shape functions on $T$ in terms of barycentric coordinates $\\lambda_{1}$, $\\lambda_{2}$, $\\lambda_{3}$ on $T$.\n\n**Step 2: Validate Using Extracted Givens**\n-   **Scientifically Grounded**: The problem is firmly rooted in the theory of finite element methods, a core topic in numerical analysis for solving partial differential equations. The Crouzeix–Raviart element is a standard, well-documented example of a nonconforming element.\n-   **Well-Posed**: The problem asks for the derivation of basis functions subject to a well-defined set of linear constraints. This leads to a unique and meaningful solution.\n-   **Objective**: The problem is stated using precise mathematical language and definitions, free from ambiguity or subjective content.\n-   The problem is self-contained, consistent, and scientifically sound. It does not violate any of the invalidity criteria.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A full solution will be provided.\n\nThe first task is to derive the explicit form of the Crouzeix–Raviart (CR) shape functions $\\hat{\\varphi}_{i}(\\hat{x}, \\hat{y})$ on the reference triangle $\\hat{T}$. The local function space consists of linear polynomials, so any shape function can be written in the form $\\hat{\\varphi}(\\hat{x}, \\hat{y}) = a\\hat{x} + b\\hat{y} + c$ for some constants $a, b, c \\in \\mathbb{R}$. The coefficients for each shape function $\\hat{\\varphi}_{i}$ are determined by the nodal conditions $\\hat{\\varphi}_{i}(\\hat{m}_j) = \\delta_{ij}$, where $\\delta_{ij}$ is the Kronecker delta.\n\n**Derivation of $\\hat{\\varphi}_{1}(\\hat{x}, \\hat{y})$**\nThe function $\\hat{\\varphi}_{1}(\\hat{x}, \\hat{y}) = a_{1}\\hat{x} + b_{1}\\hat{y} + c_{1}$ must satisfy:\n$1$. $\\hat{\\varphi}_{1}(\\hat{m}_{1}) = \\hat{\\varphi}_{1}(1/2, 0) = 1$\n$2$. $\\hat{\\varphi}_{1}(\\hat{m}_{2}) = \\hat{\\varphi}_{1}(1/2, 1/2) = 0$\n$3$. $\\hat{\\varphi}_{1}(\\hat{m}_{3}) = \\hat{\\varphi}_{1}(0, 1/2) = 0$\n\nThis leads to a system of linear equations:\n$1$. $a_{1}(\\frac{1}{2}) + b_{1}(0) + c_{1} = 1 \\implies \\frac{1}{2}a_{1} + c_{1} = 1$\n$2$. $a_{1}(\\frac{1}{2}) + b_{1}(\\frac{1}{2}) + c_{1} = 0 \\implies \\frac{1}{2}a_{1} + \\frac{1}{2}b_{1} + c_{1} = 0$\n$3$. $a_{1}(0) + b_{1}(\\frac{1}{2}) + c_{1} = 0 \\implies \\frac{1}{2}b_{1} + c_{1} = 0$\n\nFrom equation ($3$), we find $c_{1} = -\\frac{1}{2}b_{1}$. Substituting this into equation ($2$) gives $\\frac{1}{2}a_{1} + \\frac{1}{2}b_{1} - \\frac{1}{2}b_{1} = 0$, which implies $a_{1} = 0$. Substituting $a_{1}=0$ into equation ($1$) yields $c_{1} = 1$. Finally, using $c_{1}=1$ in equation ($3$) gives $\\frac{1}{2}b_{1} + 1 = 0$, so $b_{1} = -2$.\nThus, the first shape function is $\\hat{\\varphi}_{1}(\\hat{x}, \\hat{y}) = 1 - 2\\hat{y}$.\n\n**Derivation of $\\hat{\\varphi}_{2}(\\hat{x}, \\hat{y})$**\nThe function $\\hat{\\varphi}_{2}(\\hat{x}, \\hat{y}) = a_{2}\\hat{x} + b_{2}\\hat{y} + c_{2}$ must satisfy:\n$1$. $\\hat{\\varphi}_{2}(\\hat{m}_{1}) = \\hat{\\varphi}_{2}(1/2, 0) = 0$\n$2$. $\\hat{\\varphi}_{2}(\\hat{m}_{2}) = \\hat{\\varphi}_{2}(1/2, 1/2) = 1$\n$3$. $\\hat{\\varphi}_{2}(\\hat{m}_{3}) = \\hat{\\varphi}_{2}(0, 1/2) = 0$\n\nThis leads to the system:\n$1$. $\\frac{1}{2}a_{2} + c_{2} = 0$\n$2$. $\\frac{1}{2}a_{2} + \\frac{1}{2}b_{2} + c_{2} = 1$\n$3$. $\\frac{1}{2}b_{2} + c_{2} = 0$\n\nFrom ($1$) and ($3$), we have $c_{2} = -\\frac{1}{2}a_{2}$ and $c_{2} = -\\frac{1}{2}b_{2}$, which implies $a_2 = b_2$. Substituting $c_{2} = -\\frac{1}{2}a_{2}$ and $b_2 = a_2$ into equation ($2$) gives $\\frac{1}{2}a_{2} + \\frac{1}{2}a_{2} - \\frac{1}{2}a_{2} = 1$, which simplifies to $\\frac{1}{2}a_{2} = 1$, so $a_{2} = 2$. It follows that $b_{2} = 2$ and $c_{2} = -\\frac{1}{2}(2) = -1$.\nThus, the second shape function is $\\hat{\\varphi}_{2}(\\hat{x}, \\hat{y}) = 2\\hat{x} + 2\\hat{y} - 1$.\n\n**Derivation of $\\hat{\\varphi}_{3}(\\hat{x}, \\hat{y})$**\nThe function $\\hat{\\varphi}_{3}(\\hat{x}, \\hat{y}) = a_{3}\\hat{x} + b_{3}\\hat{y} + c_{3}$ must satisfy:\n$1$. $\\hat{\\varphi}_{3}(\\hat{m}_{1}) = \\hat{\\varphi}_{3}(1/2, 0) = 0$\n$2$. $\\hat{\\varphi}_{3}(\\hat{m}_{2}) = \\hat{\\varphi}_{3}(1/2, 1/2) = 0$\n$3$. $\\hat{\\varphi}_{3}(\\hat{m}_{3}) = \\hat{\\varphi}_{3}(0, 1/2) = 1$\n\nThis leads to the system:\n$1$. $\\frac{1}{2}a_{3} + c_{3} = 0$\n$2$. $\\frac{1}{2}a_{3} + \\frac{1}{2}b_{3} + c_{3} = 0$\n$3$. $\\frac{1}{2}b_{3} + c_{3} = 1$\n\nSubtracting equation ($1$) from equation ($2$) yields $\\frac{1}{2}b_{3} = 0$, so $b_3 = 0$. Substituting $b_3=0$ into equation ($3$) gives $c_3=1$. Substituting $c_3=1$ into equation ($1$) gives $\\frac{1}{2}a_{3} + 1 = 0$, so $a_3 = -2$.\nThus, the third shape function is $\\hat{\\varphi}_{3}(\\hat{x}, \\hat{y}) = 1 - 2\\hat{x}$.\n\n**Transformation to a Physical Triangle $T$**\nThe shape functions $\\varphi_{i}(\\mathbf{x})$ on a general physical triangle $T$ are obtained from the reference shape functions $\\hat{\\varphi}_{i}(\\hat{\\mathbf{x}})$ using the affine mapping $F: \\hat{T} \\to T$. The principle of isoparametric mapping dictates that the physical basis functions are defined by composition with the inverse map $F^{-1}$:\n$$ \\varphi_i(\\mathbf{x}) = \\hat{\\varphi}_i(F^{-1}(\\mathbf{x})) $$\nSince $F$ is an affine map and its inverse $F^{-1}$ is also affine, and since each $\\hat{\\varphi}_i$ is a linear polynomial, the resulting function $\\varphi_i$ is also a linear polynomial on $T$.\nThe affine map $F$ is defined such that it maps the vertices of the reference triangle $\\hat{\\mathbf{v}}_{1}=(0,0)$, $\\hat{\\mathbf{v}}_{2}=(1,0)$, $\\hat{\\mathbf{v}}_{3}=(0,1)$ to the vertices $\\mathbf{x}_{1}, \\mathbf{x}_{2}, \\mathbf{x}_{3}$ of the physical triangle $T$. A crucial property of affine maps is that they preserve convex combinations. Thus, the midpoint $\\hat{\\mathbf{m}}_j$ of a reference edge is mapped to the midpoint $\\mathbf{m}_j$ of the corresponding physical edge. For example, $\\mathbf{m}_1 = F(\\hat{\\mathbf{m}}_1)$.\nThis property ensures that the nodal conditions are satisfied on the physical element:\n$$ \\varphi_{i}(\\mathbf{m}_j) = \\hat{\\varphi}_{i}(F^{-1}(\\mathbf{m}_j)) = \\hat{\\varphi}_{i}(F^{-1}(F(\\hat{\\mathbf{m}}_j))) = \\hat{\\varphi}_{i}(\\hat{\\mathbf{m}}_j) = \\delta_{ij} $$\n\n**Expression in Barycentric Coordinates**\nTo express $\\varphi_{i}$ in terms of the barycentric coordinates $\\lambda_{1}, \\lambda_{2}, \\lambda_{3}$ on $T$, we leverage the fact that barycentric coordinates are preserved under the affine mapping. The barycentric coordinates on the reference triangle $\\hat{T}$ with respect to its vertices $\\hat{\\mathbf{v}}_{1}=(0,0)$, $\\hat{\\mathbf{v}}_{2}=(1,0)$, $\\hat{\\mathbf{v}}_{3}=(0,1)$ are given by:\n$\\hat{\\lambda}_{1} = 1 - \\hat{x} - \\hat{y}$\n$\\hat{\\lambda}_{2} = \\hat{x}$\n$\\hat{\\lambda}_{3} = \\hat{y}$\nThe invariance property means that for any point $\\mathbf{x} = F(\\hat{\\mathbf{x}})$, its barycentric coordinates $(\\lambda_1, \\lambda_2, \\lambda_3)$ on $T$ are identical to the barycentric coordinates $(\\hat{\\lambda}_1, \\hat{\\lambda}_2, \\hat{\\lambda}_3)$ of the pre-image point $\\hat{\\mathbf{x}}$ on $\\hat{T}$. Therefore, we can express the reference coordinates $(\\hat{x}, \\hat{y})$ in terms of the physical barycentric coordinates:\n$\\hat{x} = \\lambda_{2}$\n$\\hat{y} = \\lambda_{3}$\nSubstituting these into the expressions for the reference shape functions gives the shape functions on the physical element $T$ in terms of barycentric coordinates:\n$\\varphi_{1}(\\lambda_1, \\lambda_2, \\lambda_3) = 1 - 2\\lambda_{3}$\n$\\varphi_{2}(\\lambda_1, \\lambda_2, \\lambda_3) = 2\\lambda_{2} + 2\\lambda_{3} - 1$\n$\\varphi_{3}(\\lambda_1, \\lambda_2, \\lambda_3) = 1 - 2\\lambda_{2}$\n\nUsing the property $\\lambda_{1}+\\lambda_{2}+\\lambda_{3}=1$, the expression for $\\varphi_{2}$ can be written more symmetrically as $\\varphi_{2} = 2\\lambda_{2} + 2\\lambda_{3} - (\\lambda_{1}+\\lambda_{2}+\\lambda_{3}) = \\lambda_{2} + \\lambda_{3} - \\lambda_{1}$. This completes the derivation and explanation.\nThe final answer required is the triple of shape functions on the reference triangle.",
            "answer": "$$\\boxed{\\begin{pmatrix} 1 - 2\\hat{y} & 2\\hat{x} + 2\\hat{y} - 1 & 1 - 2\\hat{x} \\end{pmatrix}}$$"
        }
    ]
}