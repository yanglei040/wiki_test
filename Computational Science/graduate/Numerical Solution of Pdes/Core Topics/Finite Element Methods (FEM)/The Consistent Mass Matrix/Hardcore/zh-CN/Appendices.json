{
    "hands_on_practices": [
        {
            "introduction": "在求解瞬态问题时，我们经常需要求解形如 $M\\mathbf{x}=\\mathbf{b}$ 的线性系统，其中 $M$ 是一致质量矩阵。本练习旨在通过分析一个简单的雅可比预条件子，揭示一致质量矩阵一个出色的谱特性。你将通过推导发现，经过适当缩放后，一致质量矩阵的条件数可以由一个与网格尺寸无关的常数界定，从而深入理解为何求解质量矩阵的迭代法如此高效 。",
            "id": "3454404",
            "problem": "设 $\\Omega \\subset \\mathbb{R}^{d}$ 是一个有界 Lipschitz 域，并考虑与 $\\Omega$ 上的协调、拟一致单纯形网格上的连续分片线性 Lagrange 基 $\\{\\phi_{i}\\}_{i=1}^{n}$ 相关联的相容有限元法（FEM）质量矩阵 $M \\in \\mathbb{R}^{n \\times n}$。质量矩阵的元素定义为 $M_{ij} = \\int_{\\Omega} \\phi_{i}(x)\\,\\phi_{j}(x)\\,\\mathrm{d}x$。定义 Jacobi（对角）预条件子 $P = \\mathrm{diag}(M)$，即 $P_{ii} = M_{ii}$ 且当 $i \\neq j$ 时 $P_{ij} = 0$。\n\n从相容质量矩阵的定义出发，并且仅使用单纯形上帽子函数的逐单元属性（不调用目标界的预推导公式），提出基于 Jacobi 缩放的预条件子，并分析预处理算子 $P^{-1}M$（等价于 $P^{-1/2} M P^{-1/2}$）的谱。在拟一致性假设下，通过逐单元分解贡献，并仅使用关于 $d$-单纯形上重心坐标的第一性原理，推导 Rayleigh 商\n$$\nR(v) = \\frac{v^{\\top} M v}{v^{\\top} P v}, \\quad v \\in \\mathbb{R}^{n} \\setminus \\{0\\},\n$$\n的网格无关下界和上界。根据这些界，确定仅依赖于空间维度 $d$ 的最小普适常数 $C(d)$，使得条件数满足\n$$\n\\kappa\\!\\left(P^{-1} M\\right) \\leq C(d),\n$$\n且该常数在拟一致类中独立于网格尺寸和形状正则性参数。\n\n将你的最终答案表示为关于 $d$ 的单个闭式表达式。无需四舍五入。",
            "solution": "该问题陈述有效。这是一个适定、有科学依据的问题，属于偏微分方程数值分析领域，具体涉及有限元法（FEM）矩阵的预处理。所有术语都是标准的且定义精确，并提供了必要的假设（拟一致单纯形网格）。因此，我们可以进行完整解答。\n\n问题要求找到最小的网格无关常数 $C(d)$，使得 Jacobi 预处理的相容质量矩阵的谱条件数 $\\kappa(P^{-1}M)$ 受 $C(d)$ 的约束。矩阵 $M$ 是对称正定（SPD）的。预条件子 $P = \\mathrm{diag}(M)$ 也是对称正定的，因为其对角元 $M_{ii} = \\int_{\\Omega} \\phi_i^2 \\mathrm{d}x$ 严格为正。\n\n预处理矩阵 $P^{-1}M$ 的特征值为实数且为正。它们与对称预处理矩阵 $P^{-1/2}MP^{-1/2}$ 的特征值相同，后者是对称正定的。$P^{-1}M$ 的谱 $\\{\\lambda_k\\}$ 可由 Rayleigh 商刻画：\n$$\n\\lambda_{\\min}(P^{-1}M) = \\min_{v \\in \\mathbb{R}^n \\setminus \\{0\\}} \\frac{v^{\\top} M v}{v^{\\top} P v} \\quad \\text{and} \\quad \\lambda_{\\max}(P^{-1}M) = \\max_{v \\in \\mathbb{R}^n \\setminus \\{0\\}} \\frac{v^{\\top} M v}{v^{\\top} P v}\n$$\n条件数由 $\\kappa(P^{-1}M) = \\frac{\\lambda_{\\max}(P^{-1}M)}{\\lambda_{\\min}(P^{-1}M)}$ 给出。我们的任务是找到该 Rayleigh 商的与网格无关的最紧凑的上界和下界。\n\n设 $v \\in \\mathbb{R}^n$ 为一个系数向量。该向量对应于一个连续分片线性函数 $v_h(x) = \\sum_{i=1}^n v_i \\phi_i(x)$。\nRayleigh 商的分子是：\n$$\nv^{\\top} M v = \\sum_{i,j=1}^n v_i M_{ij} v_j = \\sum_{i,j=1}^n v_i v_j \\int_{\\Omega} \\phi_i(x) \\phi_j(x) \\mathrm{d}x = \\int_{\\Omega} \\left(\\sum_{i=1}^n v_i \\phi_i(x)\\right) \\left(\\sum_{j=1}^n v_j \\phi_j(x)\\right) \\mathrm{d}x = \\int_{\\Omega} v_h(x)^2 \\mathrm{d}x\n$$\n分母是：\n$$\nv^{\\top} P v = \\sum_{i=1}^n v_i^2 P_{ii} = \\sum_{i=1}^n v_i^2 M_{ii} = \\sum_{i=1}^n v_i^2 \\int_{\\Omega} \\phi_i(x)^2 \\mathrm{d}x\n$$\n我们将这些全局积分分解为单纯形网格 $\\mathcal{T}_h$ 中所有单元 $K$ 上的和。设 $\\Omega = \\bigcup_{K \\in \\mathcal{T}_h} K$。\n$$\nv^{\\top} M v = \\sum_{K \\in \\mathcal{T}_h} \\int_K v_h(x)^2 \\mathrm{d}x\n$$\n基函数 $\\phi_i$ 的支集是连接到节点 $i$ 的单元片。因此，我们也可以分解分母的和：\n$$\nv^{\\top} P v = \\sum_{i=1}^n v_i^2 \\sum_{K \\in \\mathcal{T}_h, x_i \\in K} \\int_K \\phi_i(x)^2 \\mathrm{d}x = \\sum_{K \\in \\mathcal{T}_h} \\sum_{i=1}^n v_i^2 \\mathbb{I}(x_i \\in K) \\int_K \\phi_i(x)^2 \\mathrm{d}x\n$$\n其中 $\\mathbb{I}(\\cdot)$ 是指示函数。\n\n让我们分析单个单元 $K$（一个 $d$-单纯形）上的贡献。设其顶点为 $\\{x_{i_\\alpha}\\}_{\\alpha=0}^d$。相应的局部基函数是重心坐标 $\\{\\lambda_\\alpha(x)\\}_{\\alpha=0}^d$，使得 $\\phi_{i_\\alpha}(x)|_K = \\lambda_\\alpha(x)$。函数 $v_h(x)$ 在 $K$ 上的限制为 $v_h(x)|_K = \\sum_{\\alpha=0}^d v_{i_\\alpha} \\lambda_\\alpha(x)$。设 $v_K \\in \\mathbb{R}^{d+1}$ 是局部系数向量，$(v_K)_\\alpha = v_{i_\\alpha}$。\n\n对分子的单元贡献是：\n$$\n\\int_K v_h(x)^2 \\mathrm{d}x = \\int_K \\left(\\sum_{\\alpha=0}^d v_{i_\\alpha} \\lambda_\\alpha(x)\\right) \\left(\\sum_{\\beta=0}^d v_{i_\\beta} \\lambda_\\beta(x)\\right) \\mathrm{d}x = \\sum_{\\alpha,\\beta=0}^d v_{i_\\alpha} v_{i_\\beta} \\int_K \\lambda_\\alpha(x) \\lambda_\\beta(x) \\mathrm{d}x\n$$\n这可以写成 $v_K^{\\top} M^K v_K$，其中 $M^K$ 是 $(d+1) \\times (d+1)$ 的单元质量矩阵，其元素为 $M^K_{\\alpha\\beta} = \\int_K \\lambda_\\alpha(x) \\lambda_\\beta(x) \\mathrm{d}x$。\n\n对分母的单元贡献可以写成：\n$$\n\\sum_{i=1}^n v_i^2 \\mathbb{I}(x_i \\in K) \\int_K \\phi_i(x)^2 \\mathrm{d}x = \\sum_{\\alpha=0}^d v_{i_\\alpha}^2 \\int_K \\lambda_\\alpha(x)^2 \\mathrm{d}x = v_K^{\\top} P^K v_K\n$$\n其中 $P^K = \\mathrm{diag}(M^K_{\\alpha\\alpha})$ 是一个包含单元质量矩阵对角元的对角矩阵。\n\n因此，全局 Rayleigh 商是局部 Rayleigh 商的加权和：\n$$\nR(v) = \\frac{v^{\\top} M v}{v^{\\top} P v} = \\frac{\\sum_{K \\in \\mathcal{T}_h} v_K^{\\top} M^K v_K}{\\sum_{K \\in \\mathcal{T}_h} v_K^{\\top} P^K v_K}\n$$\n$R(v)$ 的界可以通过对任意单元 $K$ 的局部商 $\\frac{v_K^{\\top} M^K v_K}{v_K^{\\top} P^K v_K}$ 进行界定来找到。设 $\\lambda^K_{\\min}$ 和 $\\lambda^K_{\\max}$ 为广义特征值问题 $M^K z = \\lambda P^K z$ 的最小和最大特征值。则我们有：\n$$\n\\lambda^K_{\\min} \\le \\frac{v_K^{\\top} M^K v_K}{v_K^{\\top} P^K v_K} \\le \\lambda^K_{\\max}\n$$\n由于 $v_K^{\\top} P^K v_K \\ge 0$，我们可以写出 $\\lambda^K_{\\min} (v_K^{\\top} P^K v_K) \\le v_K^{\\top} M^K v_K \\le \\lambda^K_{\\max} (v_K^{\\top} P^K v_K)$。如果这些界 $\\lambda^K_{\\min}$ 和 $\\lambda^K_{\\max}$ 与单元 $K$ 无关，我们称它们为 $\\lambda_{\\min}$ 和 $\\lambda_{\\max}$。对所有单元 $K \\in \\mathcal{T}_h$ 求和得到：\n$$\n\\lambda_{\\min} \\sum_K v_K^{\\top} P^K v_K \\le \\sum_K v_K^{\\top} M^K v_K \\le \\lambda_{\\max} \\sum_K v_K^{\\top} P^K v_K\n$$\n两边同除以 $\\sum_K v_K^{\\top} P^K v_K = v^{\\top}P v > 0$ 得到 $\\lambda_{\\min} \\le R(v) \\le \\lambda_{\\max}$。\n\n拟一致性假设确保了任何单元 $K$ 都是参考单元 $\\hat{K}$ 的一个仿射、非退化映射。$M^K$ 和 $P^K$ 的元素与单元的体积 $|K|$ 成比例缩放。这个缩放因子在广义特征值问题中被抵消，使得特征值 $\\lambda$ 与单元的大小和形状无关。因此，我们可以在一个参考 $d$-单纯形上计算这些特征值。\n\n我们使用在 $d$-单纯形 $K$ 上关于重心坐标的标准积分公式：\n$$\n\\int_K \\lambda_0^{a_0} \\lambda_1^{a_1} \\cdots \\lambda_d^{a_d} \\mathrm{d}x = \\frac{a_0! a_1! \\cdots a_d! d!}{(d + \\sum_{\\alpha=0}^d a_\\alpha)!} |K|\n$$\n单元质量矩阵 $M^K$ 的元素为：\n对于 $\\alpha = \\beta$（对角元）：\n$$\nM^K_{\\alpha\\alpha} = \\int_K \\lambda_\\alpha^2 \\mathrm{d}x = \\frac{2! \\, d!}{(d+2)!} |K| = \\frac{2 |K|}{(d+1)(d+2)}\n$$\n对于 $\\alpha \\ne \\beta$（非对角元）：\n$$\nM^K_{\\alpha\\beta} = \\int_K \\lambda_\\alpha \\lambda_\\beta \\mathrm{d}x = \\frac{1! \\, 1! \\, d!}{(d+2)!} |K| = \\frac{|K|}{(d+1)(d+2)}\n$$\n单元质量矩阵 $M^K \\in \\mathbb{R}^{(d+1)\\times(d+1)}$ 为：\n$$\nM^K = \\frac{|K|}{(d+1)(d+2)} \\begin{pmatrix} 2  1  \\cdots  1 \\\\ 1  2  \\cdots  1 \\\\ \\vdots  \\vdots  \\ddots  \\vdots \\\\ 1  1  \\cdots  2 \\end{pmatrix} = \\frac{|K|}{(d+1)(d+2)} (I + J)\n$$\n其中 $I$ 是单位矩阵，$J$ 是全1矩阵。\n\n局部预条件子矩阵 $P^K$ 是 $M^K$ 的对角部分：\n$$\nP^K = \\frac{2|K|}{(d+1)(d+2)} I\n$$\n广义特征值问题 $M^K z = \\lambda P^K z$ 变为：\n$$\n\\frac{|K|}{(d+1)(d+2)} (I + J) z = \\lambda \\left( \\frac{2|K|}{(d+1)(d+2)} I \\right) z\n$$\n常数因子被抵消，得到一个标准特征值问题：\n$$\n(I+J)z = 2\\lambda z \\implies Jz = (2\\lambda - 1)z\n$$\n我们需要找到矩阵 $J \\in \\mathbb{R}^{(d+1)\\times(d+1)}$ 的特征值。$J$ 的秩为 $1$。\n1. 向量 $\\mathbf{1} = (1, 1, \\dots, 1)^{\\top}$ 是一个特征向量：$J\\mathbf{1} = (d+1)\\mathbf{1}$。$J$ 对应的特征值为 $d+1$。\n   对于这个特征向量，我们有 $d+1 = 2\\lambda - 1$，这给出 $2\\lambda = d+2$，所以 $\\lambda = \\frac{d+2}{2}$。\n2. $J$ 的零空间维度为 $d$。任何满足 $\\sum z_\\alpha = 0$ 的向量 $z$ 都是特征值为 $0$ 的特征向量。\n   对于这 $d$ 个线性无关的特征向量，我们有 $0 = 2\\lambda - 1$，这给出 $2\\lambda = 1$，所以 $\\lambda = \\frac{1}{2}$。\n\n局部广义问题的特征值是 $\\lambda_{\\max} = \\frac{d+2}{2}$（重数为 $1$）和 $\\lambda_{\\min} = \\frac{1}{2}$（重数为 $d$）。\n这些界与单元 $K$ 无关。因此，对于任何非零向量 $v$，全局 Rayleigh 商的界为：\n$$\n\\frac{1}{2} \\leq \\frac{v^{\\top} M v}{v^{\\top} P v} \\leq \\frac{d+2}{2}\n$$\n这些界是紧的，因为可以通过选择一个支集在单个单元上并模拟局部特征向量的函数 $v_h$ 来达到。\n因此，预处理算子 $P^{-1}M$ 的谱包含在区间 $[\\frac{1}{2}, \\frac{d+2}{2}]$ 中。\n\n条件数受最大和最小特征值之比的约束：\n$$\n\\kappa(P^{-1}M) = \\frac{\\lambda_{\\max}(P^{-1}M)}{\\lambda_{\\min}(P^{-1}M)} \\le \\frac{\\sup R(v)}{\\inf R(v)} = \\frac{(d+2)/2}{1/2} = d+2\n$$\n这个界只依赖于空间维度 $d$，并且与网格尺寸或形状正则性（在非退化类内）无关。因此，最小的这种普适常数是 $C(d) = d+2$。\n\n例如：\n在 $d=1$（线段）时，$C(1)=3$。\n在 $d=2$（三角形）时，$C(2)=4$。\n在 $d=3$（四面体）时，$C(3)=5$。\n这个结果证明了 Jacobi（对角）缩放作为 FEM 相容质量矩阵预条件子的有效性，它产生一个仅依赖于维度的小常数作为界限的条件数，这保证了诸如预处理共轭梯度法等迭代求解器的性能与网格无关。",
            "answer": "$$\\boxed{d+2}$$"
        },
        {
            "introduction": "尽管一致质量矩阵具有优越的理论特性，但在实践中，为了避免求解线性系统，研究者常倾向于使用更简单的近似，如质量集中。本练习将探讨其中一种近似方法——欠积分——对数值解动态行为的具体影响。通过分析一个简单扩散问题的最高频率模式，你将亲眼见证不恰当的质量矩阵近似如何引入非物理的伪振荡，从而理解半离散系统的谱属性与解的定性行为之间的关键联系 。",
            "id": "3454415",
            "problem": "考虑单位区间上的瞬态扩散方程，\n$$\n\\frac{\\partial u}{\\partial t} = \\kappa \\frac{\\partial^{2} u}{\\partial x^{2}}, \\quad x \\in (0,1), \\ t>0,\n$$\n边界条件为齐次狄利克雷边界条件 $u(0,t)=u(1,t)=0$，初始条件为 $L^{2}$ 初始条件。在一个包含 $3$ 个单元（节点位于 $x=0$、$x=\\tfrac{1}{3}$、$x=\\tfrac{2}{3}$、$x=1$）的均匀网格上，使用标准的伽辽金有限元 (FE) 离散化方法，并采用连续分段线性基函数。设半离散系统为\n$$\nM \\, \\dot{\\mathbf{u}}(t) + \\kappa \\, K \\, \\mathbf{u}(t) = \\mathbf{0},\n$$\n其中 $M$ 是质量矩阵，$K$ 是刚度矩阵。强加边界条件，从而使系统用位于 $x=\\tfrac{1}{3}$ 和 $x=\\tfrac{2}{3}$ 的两个内部自由度来表示。\n\n对于每个长度为 $h=\\tfrac{1}{3}$ 的单元，采用以下两种质量矩阵的选择：\n- 一致质量：$M_{ij}^{(e)} = \\int_{e} \\varphi_{i} \\varphi_{j} \\, dx$ 精确计算。\n- 欠积分质量：使用单元中心处的单点高斯法则来近似 $M_{ij}^{(e)}$，即 $\\int_{e} f(x)\\,dx \\approx h \\, f(x_{c})$，其中 $x_{c}$ 是单元中点。\n\n对刚度矩阵 $K_{ij}^{(e)} = \\int_{e} \\varphi_{i}' \\varphi_{j}' \\, dx$ 使用精确积分，因此两种情况下的刚度是相同的。使用克兰克-尼科尔森 (CN) 格式（即应用于半离散系统的梯形法则）对半离散系统进行时间推进，并令 $\\mu$ 表示矩阵束 $(K,M)$ 的一个广义特征值，即 $K \\mathbf{v} = \\mu \\, M \\mathbf{v}$。\n\n仅从 $M$ 和 $K$ 的弱形式定义、单点高斯法则的性质以及作为时间上梯形法则的 CN 方法出发，完成以下任务：\n- 对一致质量和欠积分质量两种情况，组装 $2 \\times 2$ 的内部矩阵 $M$ 和 $K$。\n- 证明二乘二的托普利茨结构意味着存在一个与 $\\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$ 成比例的最高频率广义特征向量，并为每种质量矩阵选择确定其广义特征值 $\\mu$。\n- 对于一个广义本征模，推导出用 $\\mu$、$\\kappa$ 和时间步长 $\\Delta t$ 表示的单步 CN 放大因子 $g$。\n\n然后，对于欠积分质量的情况，当 $\\kappa=1$ 且 $\\Delta t = 0.02$ 时，计算最高频率模式的单步 CN 放大因子 $g$。提供精确值，不要四舍五入。该放大因子是无量纲的，因此不需要单位。",
            "solution": "首先验证问题，以确保其自洽、科学上合理且适定。问题陈述提供了所有必要信息：在区域 $x \\in (0,1)$ 上的偏微分方程 $\\frac{\\partial u}{\\partial t} = \\kappa \\frac{\\partial^{2} u}{\\partial x^{2}}$、齐次狄利克雷边界条件、一个包含 3 个单元的均匀网格、使用连续分段线性基函数，以及组装质量矩阵和刚度矩阵以及时间步进格式的具体说明。该问题是关于抛物型偏微分方程有限元法的一个标准练习，因此是有效的。\n\n区域是单位区间 $[0,1]$。一个包含 3 个单元的均匀网格意味着节点位于 $x_0=0$、$x_1=\\frac{1}{3}$、$x_2=\\frac{2}{3}$ 和 $x_3=1$。单元长度为 $h=\\frac{1}{3}$。问题指定使用两个内部自由度，它们对应于节点 $x_1$ 和 $x_2$。基函数是标准的线性“帽子”函数 $\\varphi_i(x)$，使得 $\\varphi_i(x_j) = \\delta_{ij}$。活跃的基函数是 $\\varphi_1(x)$ 和 $\\varphi_2(x)$。\n\n首先，我们组装 $2 \\times 2$ 的内部刚度矩阵 $K$。在长度为 $h$ 的单元上，线性基函数的单元刚度矩阵由 $K^{(e)} = \\frac{1}{h} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix}$ 给出。全局刚度矩阵 $K$ 是由三个单元 $e_1=[0, \\frac{1}{3}]$、$e_2=[\\frac{1}{3}, \\frac{2}{3}]$ 和 $e_3=[\\frac{2}{3}, 1]$ 的贡献组装而成的。\n对角线元素为 $K_{11} = K^{(e_1)}_{22} + K^{(e_2)}_{11} = \\frac{1}{h} + \\frac{1}{h} = \\frac{2}{h}$ 和 $K_{22} = K^{(e_2)}_{22} + K^{(e_3)}_{11} = \\frac{1}{h} + \\frac{1}{h} = \\frac{2}{h}$。\n非对角线元素为 $K_{12} = K_{21} = K^{(e_2)}_{12} = -\\frac{1}{h}$。\n当 $h=\\frac{1}{3}$ 时，我们有 $\\frac{1}{h}=3$。因此，刚度矩阵为：\n$$ K = \\begin{pmatrix} \\frac{2}{h}  -\\frac{1}{h} \\\\ -\\frac{1}{h}  \\frac{2}{h} \\end{pmatrix} = \\begin{pmatrix} 6  -3 \\\\ -3  6 \\end{pmatrix} $$\n\n接下来，我们组装一致质量矩阵 $M_{\\text{cons}}$。单元一致质量矩阵为 $M_{\\text{cons}}^{(e)} = \\frac{h}{6} \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix}$。为内部节点进行组装：\n$M_{11} = M^{(e_1)}_{22} + M^{(e_2)}_{11} = \\frac{2h}{6} + \\frac{2h}{6} = \\frac{4h}{6} = \\frac{2h}{3}$。\n$M_{22} = M^{(e_2)}_{22} + M^{(e_3)}_{11} = \\frac{2h}{6} + \\frac{2h}{6} = \\frac{2h}{3}$。\n$M_{12} = M_{21} = M^{(e_2)}_{12} = \\frac{h}{6}$。\n当 $h=\\frac{1}{3}$ 时：\n$$ M_{\\text{cons}} = \\begin{pmatrix} \\frac{2h}{3}  \\frac{h}{6} \\\\ \\frac{h}{6}  \\frac{2h}{3} \\end{pmatrix} = \\begin{pmatrix} \\frac{2}{9}  \\frac{1}{18} \\\\ \\frac{1}{18}  \\frac{2}{9} \\end{pmatrix} = \\frac{1}{18} \\begin{pmatrix} 4  1 \\\\ 1  4 \\end{pmatrix} $$\n\n现在，组装欠积分质量矩阵 $M_{\\text{under}}$。单元上的单点高斯法则是 $\\int_e f(x) dx \\approx h f(x_c)$，其中 $x_c$ 是单元中点。我们将其应用于 $M_{ij}^{(e)} = \\int_e \\varphi_i \\varphi_j dx$。对于一个单元上的局部线性基函数 $\\psi_L$ 和 $\\psi_R$，它们在中点的值为 $\\psi_L(x_c) = \\psi_R(x_c) = \\frac{1}{2}$。\n单元质量矩阵的元素近似为：\n$M_{11}^{(e)} \\approx h (\\psi_L(x_c))^2 = h(\\frac{1}{2})^2 = \\frac{h}{4}$。\n$M_{22}^{(e)} \\approx h (\\psi_R(x_c))^2 = h(\\frac{1}{2})^2 = \\frac{h}{4}$。\n$M_{12}^{(e)} \\approx h \\psi_L(x_c) \\psi_R(x_c) = h(\\frac{1}{2})(\\frac{1}{2}) = \\frac{h}{4}$。\n所以，$M_{\\text{under}}^{(e)} = \\frac{h}{4} \\begin{pmatrix} 1  1 \\\\ 1  1 \\end{pmatrix}$。为内部节点进行组装：\n$M_{11} = M^{(e_1)}_{22} + M^{(e_2)}_{11} = \\frac{h}{4} + \\frac{h}{4} = \\frac{h}{2}$。\n$M_{22} = M^{(e_2)}_{22} + M^{(e_3)}_{11} = \\frac{h}{4} + \\frac{h}{4} = \\frac{h}{2}$。\n$M_{12} = M_{21} = M^{(e_2)}_{12} = \\frac{h}{4}$。\n当 $h=\\frac{1}{3}$ 时：\n$$ M_{\\text{under}} = \\begin{pmatrix} \\frac{h}{2}  \\frac{h}{4} \\\\ \\frac{h}{4}  \\frac{h}{2} \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{6}  \\frac{1}{12} \\\\ \\frac{1}{12}  \\frac{1}{6} \\end{pmatrix} = \\frac{1}{12} \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix} $$\n\n矩阵 $K$、$M_{\\text{cons}}$ 和 $M_{\\text{under}}$ 都是形式为 $\\begin{pmatrix} a  b \\\\ b  a \\end{pmatrix}$ 的 $2 \\times 2$ 对称托普利茨矩阵。此类矩阵的特征向量总是 $\\mathbf{v}_1 = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$ 和 $\\mathbf{v}_2 = \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$，对应的特征值为 $a+b$ 和 $a-b$。最高频率模式与符号交替的特征向量 $\\mathbf{v} = \\mathbf{v}_2 = \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$ 相关联。\n对于 $K = \\begin{pmatrix} 6  -3 \\\\ -3  6 \\end{pmatrix}$，对应于 $\\mathbf{v}$ 的特征值为 $6 - (-3) = 9$。因此，$K\\mathbf{v} = 9\\mathbf{v}$。\n对于 $M_{\\text{cons}} = \\frac{1}{18} \\begin{pmatrix} 4  1 \\\\ 1  4 \\end{pmatrix}$，对应于 $\\mathbf{v}$ 的特征值为 $\\frac{1}{18}(4-1) = \\frac{3}{18} = \\frac{1}{6}$。因此，$M_{\\text{cons}}\\mathbf{v} = \\frac{1}{6}\\mathbf{v}$。\n对于 $M_{\\text{under}} = \\frac{1}{12} \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix}$，对应于 $\\mathbf{v}$ 的特征值为 $\\frac{1}{12}(2-1) = \\frac{1}{12}$。因此，$M_{\\text{under}}\\mathbf{v} = \\frac{1}{12}\\mathbf{v}$。\n广义特征值问题是 $K\\mathbf{v} = \\mu M\\mathbf{v}$。代入特征向量 $\\mathbf{v}$ 的关系：\n$9\\mathbf{v} = \\mu \\lambda_M \\mathbf{v}$，其中 $\\lambda_M$ 是质量矩阵 $M$ 的特征值。这得出 $\\mu = \\frac{9}{\\lambda_M}$。\n对于一致质量：$\\mu_{\\text{cons}} = \\frac{9}{1/6} = 54$。\n对于欠积分质量：$\\mu_{\\text{under}} = \\frac{9}{1/12} = 108$。\n\n将克兰克-尼科尔森格式应用于 $M \\dot{\\mathbf{u}} + \\kappa K \\mathbf{u} = \\mathbf{0}$ 可得：\n$$ M \\frac{\\mathbf{u}^{n+1} - \\mathbf{u}^n}{\\Delta t} + \\kappa K \\frac{\\mathbf{u}^{n+1} + \\mathbf{u}^n}{2} = \\mathbf{0} $$\n设 $\\mathbf{u}^n$ 为一个广义本征模 $\\mathbf{v}$。单步放大因子 $g$ 定义为 $\\mathbf{u}^{n+1} = g\\mathbf{u}^n = g\\mathbf{v}$。\n$$ M \\frac{g\\mathbf{v} - \\mathbf{v}}{\\Delta t} + \\kappa K \\frac{g\\mathbf{v} + \\mathbf{v}}{2} = \\mathbf{0} $$\n使用 $K\\mathbf{v} = \\mu M\\mathbf{v}$ 并提出非零向量 $M\\mathbf{v}$：\n$$ \\frac{g-1}{\\Delta t} + \\kappa \\mu \\frac{g+1}{2} = 0 $$\n求解 $g$：\n$2(g-1) + \\kappa \\mu \\Delta t (g+1) = 0 \\implies g(2 + \\kappa \\mu \\Delta t) = 2 - \\kappa \\mu \\Delta t$。\n$$ g = \\frac{2 - \\kappa \\mu \\Delta t}{2 + \\kappa \\mu \\Delta t} = \\frac{1 - \\frac{\\kappa \\mu \\Delta t}{2}}{1 + \\frac{\\kappa \\mu \\Delta t}{2}} $$\n\n最后，我们计算欠积分质量情况、最高频率模式下的 $g$ 值，其中 $\\kappa=1$ 且 $\\Delta t = 0.02$。广义特征值为 $\\mu = \\mu_{\\text{under}} = 108$。\n参数组 $\\frac{\\kappa \\mu \\Delta t}{2}$ 为：\n$$ \\frac{1 \\cdot 108 \\cdot 0.02}{2} = \\frac{2.16}{2} = 1.08 $$\n将此值代入 $g$ 的表达式中：\n$$ g = \\frac{1 - 1.08}{1 + 1.08} = \\frac{-0.08}{2.08} = -\\frac{8}{208} $$\n通过将分子和分母除以它们的最大公约数 $8$ 来化简分数：\n$$ g = -\\frac{8 \\div 8}{208 \\div 8} = -\\frac{1}{26} $$",
            "answer": "$$\\boxed{-\\frac{1}{26}}$$"
        },
        {
            "introduction": "除了稳定性，质量矩阵的构造方式同样影响着有限元方法的精度。本练习旨在通过一个反例，挑战“质量集中总是一种无害简化”的普遍看法。你将通过对一个特定的非均匀网格进行误差分析，证明质量集中会如何降低方法的收敛阶。这个实践强调了“一致”质量矩阵对于实现最优精度（尤其是在复杂网格上）的重要性 。",
            "id": "3454347",
            "problem": "考虑一维瞬态扩散（热）方程\n$$\n\\partial_t u(x,t) - \\partial_{xx} u(x,t) = 0 \\quad \\text{for } x \\in (0,1), \\; t \\in (0,\\infty),\n$$\n其具有齐次狄利克雷边界条件\n$$\nu(0,t) = 0, \\quad u(1,t) = 0 \\quad \\text{for all } t \\ge 0,\n$$\n以及光滑的初始条件，其选择使得精确解为\n$$\nu(x,t) = \\exp(-\\pi^2 t)\\,\\sin(\\pi x).\n$$\n令 $\\{x_j\\}_{j=0}^N$ 为由 $x_j = (j/N)^2$（$j=0,1,\\dots,N$）定义的非均匀网格，并令 $V_h$ 为此网格上的连续分段线性函数空间，且这些函数在 $x=0$ 和 $x=1$ 处为零。用 $a(\\cdot,\\cdot)$ 表示标准刚度双线性形式\n$$\na(v,w) = \\int_0^1 v'(x)\\,w'(x)\\,dx,\n$$\n用 $(\\cdot,\\cdot)$ 表示精确的 $L^2(0,1)$ 内积。定义协调质量半离散化：寻找 $u_h^{\\mathrm{cons}}(t) \\in V_h$ 使得\n$$\n(\\partial_t u_h^{\\mathrm{cons}}(t), w_h) + a(u_h^{\\mathrm{cons}}(t), w_h) = 0 \\quad \\text{for all } w_h \\in V_h, \\;\\; t>0,\n$$\n其初值 $u_h^{\\mathrm{cons}}(0)$ 由 $u(\\cdot,0)$ 到 $V_h$ 上的 $L^2(0,1)$ 投影给出。通过将 $(\\cdot,\\cdot)$ 替换为由给定网格上的复合梯形法则导出的集中质量内积 $(\\cdot,\\cdot)_h$ 来定义集中质量半离散化：寻找 $u_h^{\\mathrm{lump}}(t) \\in V_h$ 使得\n$$\n(\\partial_t u_h^{\\mathrm{lump}}(t), w_h)_h + a(u_h^{\\mathrm{lump}}(t), w_h) = 0 \\quad \\text{for all } w_h \\in V_h, \\;\\; t>0,\n$$\n其初值 $u_h^{\\mathrm{lump}}(0)$ 由 $u(\\cdot,0)$ 到 $V_h$ 上的 $(\\cdot,\\cdot)_h$-正交投影给出。令 $T>0$ 为一个固定值（为确定起见，取 $T=1$）。\n\n从双线性形式和求积法则的基本定义出发，并仅使用分段线性有限元的标准逼近性质，推导集中质量法在时间 $T$ 时的 $L^2(0,1)$ 误差的渐近阶（当 $N \\to \\infty$ 时），即\n$$\n\\|u(\\cdot,T) - u_h^{\\mathrm{lump}}(\\cdot,T)\\|_{L^2(0,1)} \\sim C\\, N^{-p},\n$$\n其中 $C>0$ 为一个与 $N$ 无关的常数。确定收敛率指数 $p$。你的最终答案必须是 $p$ 的单个值，表示为一个没有单位的精确数。",
            "solution": "用户希望找到在一维热方程的特定非均匀网格上，使用集中质量有限元法的收敛率指数 $p$。\n\n### 步骤1：问题验证\n\n所提供的问题是偏微分方程数值分析中的一个定义明确的练习。\n\n**已知条件：**\n1.  **偏微分方程 (PDE)：** $\\partial_t u(x,t) - \\partial_{xx} u(x,t) = 0$，对于 $x \\in (0,1)$ 和 $t \\in (0, \\infty)$。\n2.  **边界条件 (BCs)：** $u(0,t) = 0$ 和 $u(1,t) = 0$，对于 $t \\ge 0$。\n3.  **精确解：** $u(x,t) = \\exp(-\\pi^2 t)\\sin(\\pi x)$。\n4.  **网格：** $\\{x_j\\}_{j=0}^N$ 是 $[0,1]$ 的一个非均匀划分，节点为 $x_j = (j/N)^2$，$j=0, 1, \\dots, N$。\n5.  **有限元空间：** $V_h$ 是此网格上的连续分段线性函数空间，这些函数在 $x=0$ 和 $x=1$ 处为零。\n6.  **双线性形式：** 刚度形式为 $a(v,w) = \\int_0^1 v'(x)w'(x)dx$，质量形式为 $(v,w) = \\int_0^1 v(x)w(x)dx$。\n7.  **集中质量格式：** 半离散化是寻找 $u_h^{\\mathrm{lump}}(t) \\in V_h$，使得对所有 $w_h \\in V_h$ 都有 $(\\partial_t u_h^{\\mathrm{lump}}(t), w_h)_h + a(u_h^{\\mathrm{lump}}(t), w_h) = 0$，其中 $(\\cdot,\\cdot)_h$ 是由复合梯形法则导出的内积。\n8.  **初始条件：** $u_h^{\\mathrm{lump}}(0)$ 是 $u(\\cdot,0)$ 在 $V_h$ 上的 $(\\cdot,\\cdot)_h$-正交投影。\n9.  **目标：** 在固定时间 $T>0$ 时，确定渐近误差估计 $\\|u(\\cdot,T) - u_h^{\\mathrm{lump}}(\\cdot,T)\\|_{L^2(0,1)} \\sim C N^{-p}$ 中的指数 $p$。\n\n**验证：**\n-   **科学依据：** 该问题是有限元法在热方程上的标准应用。精确解正确地满足了偏微分方程和边界条件。所描述的数值方法是一种常见的变体（集中质量法）。该设定在科学上和数学上都是合理的。\n-   **适定性：** 该问题是适定的。核心任务是进行误差分析，这是数值分析中的一个标准程序。关键特征是网格的非均匀性，这使得问题变得非平凡。\n-   **客观性：** 该问题用精确的数学术语陈述。\n\n该问题被认为是有效的。我们可以继续进行求解。\n\n### 步骤2：求解推导\n\n总误差可以使用精确解 $u(t)$ 的节点插值 $I_h u(t)$ 进行分解：\n$$\ne(t) = u(t) - u_h^{\\mathrm{lump}}(t) = (u(t) - I_h u(t)) + (I_h u(t) - u_h^{\\mathrm{lump}}(t)) = \\eta(t) + \\theta_h(t)\n$$\n这里，$\\eta(t) = u(t) - I_h u(t)$ 是插值误差，而 $\\theta_h(t) = I_h u(t) - u_h^{\\mathrm{lump}}(t)$ 是离散误差，它属于有限元空间 $V_h$。我们需要求出 $\\|e(T)\\|_{L^2(0,1)}$ 的阶。\n\n首先，我们分析网格。节点为 $x_j = (j/N)^2$。第 $j$ 个单元 $I_j = [x_{j-1}, x_j]$ 的宽度为\n$$\nh_j = x_j - x_{j-1} = \\left(\\frac{j}{N}\\right)^2 - \\left(\\frac{j-1}{N}\\right)^2 = \\frac{j^2 - (j^2 - 2j + 1)}{N^2} = \\frac{2j-1}{N^2}\n$$\n最大网格宽度为 $h_{\\max} = h_N = (2N-1)/N^2 = O(N^{-1})$。我们记 $h = h_{\\max}$。最小网格宽度为 $h_{\\min} = h_1 = 1/N^2$。由于 $h_{\\max}/h_{\\min} = O(N)$，该网格不是拟一致的。\n\n接下来，我们分析误差分量。\n1.  **插值误差 $\\eta(t)$：** 解 $u(x,t) = \\exp(-\\pi^2 t)\\sin(\\pi x)$ 是光滑的。分段线性插值的标准逼近理论给出了以下在 $L^2$ 范数和 $H^1$ 半范数下的误差估计：\n    $$\n    \\|\\eta(t)\\|_{L^2(0,1)} = \\|u(t) - I_h u(t)\\|_{L^2(0,1)} \\le C h^2 \\| \\partial_{xx} u(t) \\|_{L^2(0,1)}\n    $$\n    $$\n    |\\eta(t)|_{H^1(0,1)} = \\|(u(t) - I_h u(t))'\\|_{L^2(0,1)} \\le C h \\| \\partial_{xx} u(t) \\|_{L^2(0,1)}\n    $$\n    由于 $h = O(N^{-1})$ 且对于固定的 $t$，$\\partial_{xx} u(t)$ 是有界的，我们有：\n    $$\n    \\|\\eta(t)\\|_{L^2(0,1)} = O(N^{-2}) \\quad \\text{and} \\quad |\\eta(t)|_{H^1(0,1)} = O(N^{-1})\n    $$\n\n2.  **离散误差 $\\theta_h(t)$：** 我们推导控制 $\\theta_h(t)$ 的微分方程。\n    精确解的弱形式为 $(\\partial_t u, w_h) + a(u, w_h) = 0$，对任意 $w_h \\in V_h$ 成立。\n    集中质量格式为 $(\\partial_t u_h^{\\mathrm{lump}}, w_h)_h + a(u_h^{\\mathrm{lump}}, w_h) = 0$。\n    将 $u_h^{\\mathrm{lump}} = I_h u - \\theta_h$ 代入该格式得到：\n    $$\n    (\\partial_t I_h u - \\partial_t \\theta_h, w_h)_h + a(I_h u - \\theta_h, w_h) = 0\n    $$\n    整理得到关于 $\\theta_h$ 的方程：\n    $$\n    (\\partial_t \\theta_h, w_h)_h + a(\\theta_h, w_h) = (\\partial_t I_h u, w_h)_h + a(I_h u, w_h)\n    $$\n    我们通过添加和减去项来将右侧与精确弱形式联系起来：\n    $$\n    \\text{RHS} = (\\partial_t I_h u, w_h)_h + a(I_h u, w_h) = (\\partial_t (u-\\eta), w_h)_h + a(u-\\eta, w_h)\n    $$\n    $$\n    \\text{RHS} = (\\partial_t u, w_h)_h - (\\partial_t \\eta, w_h)_h + a(u,w_h) - a(\\eta, w_h)\n    $$\n    使用精确弱形式 $a(u, w_h) = -(\\partial_t u, w_h)$：\n    $$\n    \\text{RHS} = [(\\partial_t u, w_h)_h - (\\partial_t u, w_h)] - (\\partial_t \\eta, w_h)_h - a(\\eta, w_h)\n    $$\n    方括号中的项是质量形式的求积误差，我们将其记为 $-E(\\partial_t u, w_h)$。\n    所以，$\\theta_h$ 的误差方程为：\n    $$\n    (\\partial_t \\theta_h, w_h)_h + a(\\theta_h, w_h) = -E(\\partial_t u, w_h) - (\\partial_t \\eta, w_h)_h - a(\\eta, w_h)\n    $$\n    我们选择检验函数 $w_h = \\theta_h$ 并利用 $(\\partial_t \\theta_h, \\theta_h)_h = \\frac{1}{2}\\frac{d}{dt}\\|\\theta_h\\|_h^2$ 和 $a(\\theta_h, \\theta_h) = |\\theta_h|_{H^1}^2$ 这两个事实：\n    $$\n    \\frac{1}{2}\\frac{d}{dt}\\|\\theta_h\\|_h^2 + |\\theta_h|_{H^1}^2 = -E(\\partial_t u, \\theta_h) - (\\partial_t \\eta, \\theta_h)_h - a(\\eta, \\theta_h)\n    $$\n    我们对右侧各项的绝对值进行界定：\n    -   $|a(\\eta, \\theta_h)| \\le |\\eta|_{H^1} |\\theta_h|_{H^1} \\le O(N^{-1}) |\\theta_h|_{H^1}$。\n    -   $|(\\partial_t \\eta, \\theta_h)_h| \\le C \\|\\partial_t \\eta\\|_{L^2} \\|\\theta_h\\|_{L^2}$。由于 $\\partial_t u$ 也是光滑的，$\\|\\partial_t \\eta_t\\|_{L^2} \\le C h^2 \\|\\partial_{txx}u\\|_{L^2} = O(N^{-2})$。所以此项为 $O(N^{-2})\\|\\theta_h\\|_{L^2}$。\n    -   求积误差 $|E(\\partial_t u, \\theta_h)|$ 可以被证明其量级为 $O(N^{-2})(|\\theta_h|_{H^1} + \\|\\theta_h\\|_{L^2})$。\n\n    右侧的主导项来自 $a(\\eta, \\theta_h)$，其阶为 $O(N^{-1})$。\n    $$\n    \\frac{1}{2}\\frac{d}{dt}\\|\\theta_h\\|_h^2 + |\\theta_h|_{H^1}^2 \\le C_1 N^{-1} |\\theta_h|_{H^1} + C_2 N^{-2} \\|\\theta_h\\|_{L^2} + \\dots\n    $$\n    使用杨氏不等式 $ab \\le \\frac{1}{2\\epsilon}a^2 + \\frac{\\epsilon}{2}b^2$，我们对第一项进行界定：\n    $$\n    C_1 N^{-1} |\\theta_h|_{H^1} \\le \\frac{1}{2}|\\theta_h|_{H^1}^2 + \\frac{C_1^2}{2} N^{-2}\n    $$\n    第二项更小。因此我们有：\n    $$\n    \\frac{1}{2}\\frac{d}{dt}\\|\\theta_h\\|_h^2 + \\frac{1}{2}|\\theta_h|_{H^1}^2 \\le C N^{-2}\n    $$\n    舍去半正定项 $\\frac{1}{2}|\\theta_h|_{H^1}^2$：\n    $$\n    \\frac{d}{dt}\\|\\theta_h\\|_h^2 \\le 2C N^{-2}\n    $$\n    现在，我们检查初始条件。$u_h^{\\mathrm{lump}}(0)$ 是 $u_0 = u(\\cdot,0)$ 的 $(\\cdot,\\cdot)_h$-正交投影。这意味着对所有 $w_h \\in V_h$ 都有 $(u_0 - u_h^{\\mathrm{lump}}(0), w_h)_h = 0$。对于梯形法则，这意味着 $u_h^{\\mathrm{lump}}(0)$ 的节点值与 $u_0$ 的节点值完全相同。因此，$u_h^{\\mathrm{lump}}(0) = I_h u_0$。初始离散误差为 $\\theta_h(0) = I_h u_0 - u_h^{\\mathrm{lump}}(0) = 0$。\n\n    将此微分不等式从 $t=0$ 积分到 $T$：\n    $$\n    \\|\\theta_h(T)\\|_h^2 \\le \\int_0^T 2C N^{-2} dt = 2CT N^{-2}\n    $$\n    由于集中质量范数 $\\|\\cdot\\|_h$ 与标准 $L^2$ 范数等价，即 $\\|\\theta_h(T)\\|_h \\approx \\|\\theta_h(T)\\|_{L^2}$，我们得到：\n    $$\n    \\|\\theta_h(T)\\|_{L^2(0,1)} = O(N^{-1})\n    $$\n\n3.  **总误差：** 在时间 $T$ 的总误差由三角不等式界定：\n    $$\n    \\|u(T) - u_h^{\\mathrm{lump}}(T)\\|_{L^2} \\le \\|\\eta(T)\\|_{L^2} + \\|\\theta_h(T)\\|_{L^2}\n    $$\n    代入各部分的收敛阶：\n    $$\n    \\|u(T) - u_h^{\\mathrm{lump}}(T)\\|_{L^2} \\le O(N^{-2}) + O(N^{-1}) = O(N^{-1})\n    $$\n    整体收敛率受收敛较慢的项（即离散误差 $\\theta_h$）的限制。渐近阶为 $N^{-1}$。\n\n因此，收敛率指数为 $p=1$。这种从最优收敛率 $p=2$（在拟一致网格上可见）的下降是非拟一致网格的结果，它在使用全局参数 $h=h_{\\max}$ 衡量时，降低了有限元空间的 $H^1$ 逼近性质。这反过来又在误差演化方程中引入了一个低阶项，该项最终占主导地位。",
            "answer": "$$\\boxed{1}$$"
        }
    ]
}