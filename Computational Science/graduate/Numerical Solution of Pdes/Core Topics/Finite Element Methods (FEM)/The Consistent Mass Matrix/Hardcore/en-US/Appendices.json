{
    "hands_on_practices": [
        {
            "introduction": "The consistent mass matrix $M$ is a cornerstone of the finite element method, yet its non-diagonal structure can seem computationally burdensome, especially in explicit time-stepping schemes which require applying $M^{-1}$. This practice reveals a remarkable and fundamental property: for typical meshes, $M$ is extremely well-conditioned with respect to simple diagonal (Jacobi) scaling. By deriving the condition number bound from first principles, you will understand why inverting $M$ with iterative methods like Preconditioned Conjugate Gradient is highly efficient, with performance that is independent of mesh refinement .",
            "id": "3454404",
            "problem": "Let $\\Omega \\subset \\mathbb{R}^{d}$ be a bounded Lipschitz domain and consider the Consistent Finite Element Method (FEM) mass matrix $M \\in \\mathbb{R}^{n \\times n}$ associated with the continuous, piecewise linear Lagrange basis $\\{\\phi_{i}\\}_{i=1}^{n}$ on a conforming, quasiuniform simplicial mesh of $\\Omega$. The mass matrix entries are defined by $M_{ij} = \\int_{\\Omega} \\phi_{i}(x)\\,\\phi_{j}(x)\\,\\mathrm{d}x$. Define the Jacobi (diagonal) preconditioner $P = \\mathrm{diag}(M)$, i.e., $P_{ii} = M_{ii}$ and $P_{ij} = 0$ for $i \\neq j$.\n\nStarting from the definition of the consistent mass matrix and only using elementwise properties of the hat functions on a simplex (without invoking pre-derived formulas for the target bound), propose the preconditioner based on Jacobi scaling and analyze the spectrum of the preconditioned operator $P^{-1}M$ (equivalently $P^{-1/2} M P^{-1/2}$). Under the quasiuniformity assumption, derive mesh-independent lower and upper bounds for the Rayleigh quotient\n$$\nR(v) = \\frac{v^{\\top} M v}{v^{\\top} P v}, \\quad v \\in \\mathbb{R}^{n} \\setminus \\{0\\},\n$$\nby decomposing the contributions elementwise and using only first principles about barycentric coordinates on a $d$-simplex. From these bounds, determine the smallest universal constant $C(d)$ depending only on the spatial dimension $d$, such that the condition number satisfies\n$$\n\\kappa(P^{-1} M) \\leq C(d),\n$$\nindependently of the mesh size and shape regularity parameters within the quasiuniform class.\n\nExpress your final answer as a single closed-form expression in terms of $d$. No rounding is required.",
            "solution": "The problem asks for the smallest mesh-independent constant $C(d)$ such that the spectral condition number of the Jacobi-preconditioned consistent mass matrix, $\\kappa(P^{-1}M)$, is bounded by $C(d)$. The matrix $M$ is symmetric and positive definite (SPD). The preconditioner $P = \\mathrm{diag}(M)$ is also SPD since its diagonal entries $M_{ii} = \\int_{\\Omega} \\phi_i^2 \\mathrm{d}x$ are strictly positive.\n\nThe eigenvalues of the preconditioned matrix $P^{-1}M$ are real and positive. They are identical to the eigenvalues of the symmetrically preconditioned matrix $P^{-1/2}MP^{-1/2}$, which is SPD. The spectrum of $P^{-1}M$, $\\{\\lambda_k\\}$, can be characterized by the Rayleigh quotient:\n$$\n\\lambda_{\\min}(P^{-1}M) = \\min_{v \\in \\mathbb{R}^n \\setminus \\{0\\}} \\frac{v^{\\top} M v}{v^{\\top} P v} \\quad \\text{and} \\quad \\lambda_{\\max}(P^{-1}M) = \\max_{v \\in \\mathbb{R}^n \\setminus \\{0\\}} \\frac{v^{\\top} M v}{v^{\\top} P v}\n$$\nThe condition number is given by $\\kappa(P^{-1}M) = \\frac{\\lambda_{\\max}(P^{-1}M)}{\\lambda_{\\min}(P^{-1}M)}$. Our task is to find the sharpest possible upper and lower bounds for this Rayleigh quotient that are independent of the mesh.\n\nLet $v \\in \\mathbb{R}^n$ be a vector of coefficients. This vector corresponds to a continuous piecewise linear function $v_h(x) = \\sum_{i=1}^n v_i \\phi_i(x)$.\nThe numerator of the Rayleigh quotient is:\n$$\nv^{\\top} M v = \\sum_{i,j=1}^n v_i M_{ij} v_j = \\sum_{i,j=1}^n v_i v_j \\int_{\\Omega} \\phi_i(x) \\phi_j(x) \\mathrm{d}x = \\int_{\\Omega} \\left(\\sum_{i=1}^n v_i \\phi_i(x)\\right) \\left(\\sum_{j=1}^n v_j \\phi_j(x)\\right) \\mathrm{d}x = \\int_{\\Omega} v_h(x)^2 \\mathrm{d}x\n$$\nThe denominator is:\n$$\nv^{\\top} P v = \\sum_{i=1}^n v_i^2 P_{ii} = \\sum_{i=1}^n v_i^2 M_{ii} = \\sum_{i=1}^n v_i^2 \\int_{\\Omega} \\phi_i(x)^2 \\mathrm{d}x\n$$\nWe decompose these global integrals into a sum over the elements $K$ of the simplicial mesh $\\mathcal{T}_h$. Let $\\Omega = \\bigcup_{K \\in \\mathcal{T}_h} K$.\n$$\nv^{\\top} M v = \\sum_{K \\in \\mathcal{T}_h} \\int_K v_h(x)^2 \\mathrm{d}x\n$$\nThe basis function $\\phi_i$ has support over the patch of elements connected to node $i$. Thus, we can also decompose the denominator sum:\n$$\nv^{\\top} P v = \\sum_{i=1}^n v_i^2 \\sum_{K \\in \\mathcal{T}_h, x_i \\in K} \\int_K \\phi_i(x)^2 \\mathrm{d}x = \\sum_{K \\in \\mathcal{T}_h} \\sum_{i=1}^n v_i^2 \\mathbb{I}(x_i \\in K) \\int_K \\phi_i(x)^2 \\mathrm{d}x\n$$\nwhere $\\mathbb{I}(\\cdot)$ is the indicator function.\n\nLet us analyze the contributions on a single element $K$, which is a $d$-simplex. Let its vertices be $\\{x_{i_\\alpha}\\}_{\\alpha=0}^d$. The corresponding local basis functions are the barycentric coordinates $\\{\\lambda_\\alpha(x)\\}_{\\alpha=0}^d$, such that $\\phi_{i_\\alpha}(x)|_K = \\lambda_\\alpha(x)$. The function $v_h(x)$ restricted to $K$ is $v_h(x)|_K = \\sum_{\\alpha=0}^d v_{i_\\alpha} \\lambda_\\alpha(x)$. Let $v_K \\in \\mathbb{R}^{d+1}$ be the vector of local coefficients, $(v_K)_\\alpha = v_{i_\\alpha}$.\n\nThe element contribution to the numerator is:\n$$\n\\int_K v_h(x)^2 \\mathrm{d}x = \\int_K \\left(\\sum_{\\alpha=0}^d v_{i_\\alpha} \\lambda_\\alpha(x)\\right) \\left(\\sum_{\\beta=0}^d v_{i_\\beta} \\lambda_\\beta(x)\\right) \\mathrm{d}x = \\sum_{\\alpha,\\beta=0}^d v_{i_\\alpha} v_{i_\\beta} \\int_K \\lambda_\\alpha(x) \\lambda_\\beta(x) \\mathrm{d}x\n$$\nThis can be written as $v_K^{\\top} M^K v_K$, where $M^K$ is the $(d+1) \\times (d+1)$ element mass matrix with entries $M^K_{\\alpha\\beta} = \\int_K \\lambda_\\alpha(x) \\lambda_\\beta(x) \\mathrm{d}x$.\n\nThe element contribution to the denominator can be written as:\n$$\n\\sum_{i=1}^n v_i^2 \\mathbb{I}(x_i \\in K) \\int_K \\phi_i(x)^2 \\mathrm{d}x = \\sum_{\\alpha=0}^d v_{i_\\alpha}^2 \\int_K \\lambda_\\alpha(x)^2 \\mathrm{d}x = v_K^{\\top} P^K v_K\n$$\nwhere $P^K = \\mathrm{diag}(M^K_{\\alpha\\alpha})$ is a diagonal matrix containing the diagonal entries of the element mass matrix.\n\nThe global Rayleigh quotient is therefore a weighted sum of local Rayleigh quotients:\n$$\nR(v) = \\frac{v^{\\top} M v}{v^{\\top} P v} = \\frac{\\sum_{K \\in \\mathcal{T}_h} v_K^{\\top} M^K v_K}{\\sum_{K \\in \\mathcal{T}_h} v_K^{\\top} P^K v_K}\n$$\nThe bounds on $R(v)$ can be found by bounding the local quotient $\\frac{v_K^{\\top} M^K v_K}{v_K^{\\top} P^K v_K}$ for an arbitrary element $K$. Let $\\lambda^K_{\\min}$ and $\\lambda^K_{\\max}$ be the minimum and maximum eigenvalues of the generalized eigenvalue problem $M^K z = \\lambda P^K z$. Then we have:\n$$\n\\lambda^K_{\\min} \\le \\frac{v_K^{\\top} M^K v_K}{v_K^{\\top} P^K v_K} \\le \\lambda^K_{\\max}\n$$\nSince $v_K^{\\top} P^K v_K \\ge 0$, we can write $\\lambda^K_{\\min} (v_K^{\\top} P^K v_K) \\le v_K^{\\top} M^K v_K \\le \\lambda^K_{\\max} (v_K^{\\top} P^K v_K)$. If these bounds $\\lambda^K_{\\min}$ and $\\lambda^K_{\\max}$ are independent of the element $K$, let's call them $\\lambda_{\\min}$ and $\\lambda_{\\max}$. Summing over all elements $K \\in \\mathcal{T}_h$ yields:\n$$\n\\lambda_{\\min} \\sum_K v_K^{\\top} P^K v_K \\le \\sum_K v_K^{\\top} M^K v_K \\le \\lambda_{\\max} \\sum_K v_K^{\\top} P^K v_K\n$$\nDividing by $\\sum_K v_K^{\\top} P^K v_K = v^{\\top}P v > 0$ gives $\\lambda_{\\min} \\le R(v) \\le \\lambda_{\\max}$.\n\nThe quasiuniformity assumption ensures that any element $K$ is an affine, non-degenerate map of a reference element $\\hat{K}$. The entries of $M^K$ and $P^K$ scale proportionally to the volume of the element, $|K|$. This scaling factor cancels in the generalized eigenvalue problem, making the eigenvalues $\\lambda$ independent of the element's size and shape. We can therefore compute these eigenvalues on a reference $d$-simplex.\n\nWe use the standard integral formula for barycentric coordinates over a $d$-simplex $K$:\n$$\n\\int_K \\lambda_0^{a_0} \\lambda_1^{a_1} \\cdots \\lambda_d^{a_d} \\mathrm{d}x = \\frac{a_0! a_1! \\cdots a_d! d!}{(d + \\sum_{\\alpha=0}^d a_\\alpha)!} |K|\n$$\nThe entries of the element mass matrix $M^K$ are:\nFor $\\alpha = \\beta$ (diagonal entries):\n$$\nM^K_{\\alpha\\alpha} = \\int_K \\lambda_\\alpha^2 \\mathrm{d}x = \\frac{2! \\, d!}{(d+2)!} |K| = \\frac{2 |K|}{(d+1)(d+2)}\n$$\nFor $\\alpha \\ne \\beta$ (off-diagonal entries):\n$$\nM^K_{\\alpha\\beta} = \\int_K \\lambda_\\alpha \\lambda_\\beta \\mathrm{d}x = \\frac{1! \\, 1! \\, d!}{(d+2)!} |K| = \\frac{|K|}{(d+1)(d+2)}\n$$\nThe element mass matrix $M^K \\in \\mathbb{R}^{(d+1)\\times(d+1)}$ is:\n$$\nM^K = \\frac{|K|}{(d+1)(d+2)} \\begin{pmatrix} 2 & 1 & \\cdots & 1 \\\\ 1 & 2 & \\cdots & 1 \\\\ \\vdots & \\vdots & \\ddots & \\vdots \\\\ 1 & 1 & \\cdots & 2 \\end{pmatrix} = \\frac{|K|}{(d+1)(d+2)} (I + J)\n$$\nwhere $I$ is the identity matrix and $J$ is the matrix of all ones.\n\nThe local preconditioner matrix $P^K$ is the diagonal of $M^K$:\n$$\nP^K = \\frac{2|K|}{(d+1)(d+2)} I\n$$\nThe generalized eigenvalue problem $M^K z = \\lambda P^K z$ becomes:\n$$\n\\frac{|K|}{(d+1)(d+2)} (I + J) z = \\lambda \\left( \\frac{2|K|}{(d+1)(d+2)} I \\right) z\n$$\nThe constant factors cancel, yielding a standard eigenvalue problem:\n$$\n(I+J)z = 2\\lambda z \\implies Jz = (2\\lambda - 1)z\n$$\nWe need to find the eigenvalues of the matrix $J \\in \\mathbb{R}^{(d+1)\\times(d+1)}$. $J$ has rank $1$.\n1. The vector $\\mathbf{1} = (1, 1, \\dots, 1)^{\\top}$ is an eigenvector: $J\\mathbf{1} = (d+1)\\mathbf{1}$. The corresponding eigenvalue of $J$ is $d+1$.\n   For this eigenvector, we have $d+1 = 2\\lambda - 1$, which gives $2\\lambda = d+2$, so $\\lambda = \\frac{d+2}{2}$.\n2. The null space of $J$ has dimension $d$. Any vector $z$ with $\\sum z_\\alpha = 0$ is an eigenvector with eigenvalue $0$.\n   For these $d$ linearly independent eigenvectors, we have $0 = 2\\lambda - 1$, which gives $2\\lambda = 1$, so $\\lambda = \\frac{1}{2}$.\n\nThe eigenvalues of the local generalized problem are $\\lambda_{\\max} = \\frac{d+2}{2}$ (with multiplicity $1$) and $\\lambda_{\\min} = \\frac{1}{2}$ (with multiplicity $d$).\nThese bounds are independent of the element $K$. Therefore, for any non-zero vector $v$, the global Rayleigh quotient is bounded by:\n$$\n\\frac{1}{2} \\leq \\frac{v^{\\top} M v}{v^{\\top} P v} \\leq \\frac{d+2}{2}\n$$\nThese bounds are sharp, as they can be attained by choosing a function $v_h$ that is supported on a single element and mimics the local eigenvectors.\nThe spectrum of the preconditioned operator $P^{-1}M$ is thus contained in the interval $[\\frac{1}{2}, \\frac{d+2}{2}]$.\n\nThe condition number is bounded by the ratio of the maximum and minimum eigenvalues:\n$$\n\\kappa(P^{-1}M) = \\frac{\\lambda_{\\max}(P^{-1}M)}{\\lambda_{\\min}(P^{-1}M)} \\le \\frac{\\sup R(v)}{\\inf R(v)} = \\frac{(d+2)/2}{1/2} = d+2\n$$\nThis bound depends only on the spatial dimension $d$ and is independent of the mesh size or the shape regularity (within the non-degenerate class). Thus, the smallest such universal constant is $C(d) = d+2$.\n\nFor example:\nIn $d=1$ (line segments), $C(1)=3$.\nIn $d=2$ (triangles), $C(2)=4$.\nIn $d=3$ (tetrahedra), $C(3)=5$.\nThis result demonstrates the effectiveness of Jacobi (diagonal) scaling as a preconditioner for the FEM consistent mass matrix, yielding a condition number that is bounded by a small constant depending only on the dimension, which guarantees mesh-independent performance of iterative solvers like the preconditioned conjugate gradient method.",
            "answer": "$$\\boxed{d+2}$$"
        },
        {
            "introduction": "While the previous exercise showed that solving systems with the consistent mass matrix $M$ is computationally feasible, the allure of simplifying it to a diagonal (or \"lumped\") matrix remains strong. This practice explores the potential hidden cost of such a simplification by examining a transient diffusion problem. Through direct calculation on a minimal mesh, you will discover how using an underintegrated mass matrix—a common form of lumping—can introduce spurious, high-frequency oscillations into the numerical solution, a phenomenon absent when using the mathematically rigorous consistent mass matrix .",
            "id": "3454415",
            "problem": "Consider the transient diffusion equation on the unit interval,\n$$\n\\frac{\\partial u}{\\partial t} = \\kappa \\frac{\\partial^{2} u}{\\partial x^{2}}, \\quad x \\in (0,1), \\ t>0,\n$$\nwith homogeneous Dirichlet boundary conditions $u(0,t)=u(1,t)=0$ and an $L^{2}$ initial condition. Use a standard Galerkin finite element (FE) discretization with continuous, piecewise-linear basis functions on a uniform mesh of $3$ elements (nodes at $x=0$, $x=\\tfrac{1}{3}$, $x=\\tfrac{2}{3}$, $x=1$). Let the semi-discrete system be\n$$\nM \\, \\dot{\\mathbf{u}}(t) + \\kappa \\, K \\, \\mathbf{u}(t) = \\mathbf{0},\n$$\nwhere $M$ is the mass matrix and $K$ is the stiffness matrix. Impose the boundary conditions strongly so that the system is expressed in terms of the two interior degrees of freedom at $x=\\tfrac{1}{3}$ and $x=\\tfrac{2}{3}$.\n\nAdopt the following two choices for the mass matrix on each element of length $h=\\tfrac{1}{3}$:\n- Consistent mass: $M_{ij}^{(e)} = \\int_{e} \\varphi_{i} \\varphi_{j} \\, dx$ computed exactly.\n- Underintegrated mass: approximate $M_{ij}^{(e)}$ by the one-point Gauss rule at the element center, i.e., $\\int_{e} f(x)\\,dx \\approx h \\, f(x_{c})$, where $x_{c}$ is the element midpoint.\n\nUse exact integration for the stiffness matrix, $K_{ij}^{(e)} = \\int_{e} \\varphi_{i}' \\varphi_{j}' \\, dx$, so that the stiffness is identical in the two cases. Advance the semi-discrete system in time with the Crank–Nicolson (CN) scheme (Crank–Nicolson (CN) is the trapezoidal rule applied to the semi-discrete system), and let $\\mu$ denote a generalized eigenvalue of the matrix pencil $(K,M)$, that is, $K \\mathbf{v} = \\mu \\, M \\mathbf{v}$.\n\nStarting only from the weak form definitions of $M$ and $K$, the properties of the one-point Gauss rule, and the CN method as the trapezoidal rule in time, do the following:\n- Assemble the $2 \\times 2$ interior matrices $M$ and $K$ for both the consistent and the underintegrated mass cases.\n- Show that the two-by-two Toeplitz structure implies a highest-frequency generalized eigenvector proportional to $\\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$ and determine its generalized eigenvalue $\\mu$ for each mass choice.\n- Derive the one-step CN amplification factor $g$ for a generalized eigenmode in terms of $\\mu$, $\\kappa$, and the time step $\\Delta t$.\n\nThen, for the underintegrated mass case with $\\kappa=1$ and $\\Delta t = 0.02$, compute the one-step CN amplification factor $g$ for the highest-frequency mode. Provide the exact value. Do not round. The amplification factor is dimensionless, so no units are required.",
            "solution": "The domain is the unit interval $[0,1]$. A uniform mesh with $3$ elements implies nodes at $x_0=0$, $x_1=\\frac{1}{3}$, $x_2=\\frac{2}{3}$, and $x_3=1$. The element length is $h=\\frac{1}{3}$. The problem specifies using the two interior degrees of freedom, which correspond to nodes $x_1$ and $x_2$. The basis functions are the standard linear 'hat' functions, $\\varphi_i(x)$, such that $\\varphi_i(x_j) = \\delta_{ij}$. The active basis functions are $\\varphi_1(x)$ and $\\varphi_2(x)$.\n\nFirst, we assemble the $2 \\times 2$ interior stiffness matrix $K$. The element stiffness matrix for linear basis functions on an element of length $h$ is given by $K^{(e)} = \\frac{1}{h} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}$. The global stiffness matrix $K$ is assembled from the contributions of the three elements $e_1=[0, \\frac{1}{3}]$, $e_2=[\\frac{1}{3}, \\frac{2}{3}]$, and $e_3=[\\frac{2}{3}, 1]$.\nThe diagonal entries are $K_{11} = K^{(e_1)}_{22} + K^{(e_2)}_{11} = \\frac{1}{h} + \\frac{1}{h} = \\frac{2}{h}$ and $K_{22} = K^{(e_2)}_{22} + K^{(e_3)}_{11} = \\frac{1}{h} + \\frac{1}{h} = \\frac{2}{h}$.\nThe off-diagonal entry is $K_{12} = K_{21} = K^{(e_2)}_{12} = -\\frac{1}{h}$.\nWith $h=\\frac{1}{3}$, we have $\\frac{1}{h}=3$. Thus, the stiffness matrix is:\n$$ K = \\begin{pmatrix} \\frac{2}{h} & -\\frac{1}{h} \\\\ -\\frac{1}{h} & \\frac{2}{h} \\end{pmatrix} = \\begin{pmatrix} 6 & -3 \\\\ -3 & 6 \\end{pmatrix} $$\n\nNext, we assemble the consistent mass matrix, $M_{\\text{cons}}$. The element consistent mass matrix is $M_{\\text{cons}}^{(e)} = \\frac{h}{6} \\begin{pmatrix} 2 & 1 \\\\ 1 & 2 \\end{pmatrix}$. Assembling for the interior nodes:\n$M_{11} = M^{(e_1)}_{22} + M^{(e_2)}_{11} = \\frac{2h}{6} + \\frac{2h}{6} = \\frac{4h}{6} = \\frac{2h}{3}$.\n$M_{22} = M^{(e_2)}_{22} + M^{(e_3)}_{11} = \\frac{2h}{6} + \\frac{2h}{6} = \\frac{2h}{3}$.\n$M_{12} = M_{21} = M^{(e_2)}_{12} = \\frac{h}{6}$.\nWith $h=\\frac{1}{3}$:\n$$ M_{\\text{cons}} = \\begin{pmatrix} \\frac{2h}{3} & \\frac{h}{6} \\\\ \\frac{h}{6} & \\frac{2h}{3} \\end{pmatrix} = \\begin{pmatrix} \\frac{2}{9} & \\frac{1}{18} \\\\ \\frac{1}{18} & \\frac{2}{9} \\end{pmatrix} = \\frac{1}{18} \\begin{pmatrix} 4 & 1 \\\\ 1 & 4 \\end{pmatrix} $$\n\nNow, assemble the underintegrated mass matrix, $M_{\\text{under}}$. The one-point Gauss rule on an element is $\\int_e f(x) dx \\approx h f(x_c)$, where $x_c$ is the element midpoint. We apply this to $M_{ij}^{(e)} = \\int_e \\varphi_i \\varphi_j dx$. For local linear basis functions $\\psi_L$ and $\\psi_R$ on an element, their values at the midpoint are $\\psi_L(x_c) = \\psi_R(x_c) = \\frac{1}{2}$.\nThe entries of the element mass matrix are approximated as:\n$M_{11}^{(e)} \\approx h (\\psi_L(x_c))^2 = h(\\frac{1}{2})^2 = \\frac{h}{4}$.\n$M_{22}^{(e)} \\approx h (\\psi_R(x_c))^2 = h(\\frac{1}{2})^2 = \\frac{h}{4}$.\n$M_{12}^{(e)} \\approx h \\psi_L(x_c) \\psi_R(x_c) = h(\\frac{1}{2})(\\frac{1}{2}) = \\frac{h}{4}$.\nSo, $M_{\\text{under}}^{(e)} = \\frac{h}{4} \\begin{pmatrix} 1 & 1 \\\\ 1 & 1 \\end{pmatrix}$. Assembling for the interior nodes:\n$M_{11} = M^{(e_1)}_{22} + M^{(e_2)}_{11} = \\frac{h}{4} + \\frac{h}{4} = \\frac{h}{2}$.\n$M_{22} = M^{(e_2)}_{22} + M^{(e_3)}_{11} = \\frac{h}{4} + \\frac{h}{4} = \\frac{h}{2}$.\n$M_{12} = M_{21} = M^{(e_2)}_{12} = \\frac{h}{4}$.\nWith $h=\\frac{1}{3}$:\n$$ M_{\\text{under}} = \\begin{pmatrix} \\frac{h}{2} & \\frac{h}{4} \\\\ \\frac{h}{4} & \\frac{h}{2} \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{6} & \\frac{1}{12} \\\\ \\frac{1}{12} & \\frac{1}{6} \\end{pmatrix} = \\frac{1}{12} \\begin{pmatrix} 2 & 1 \\\\ 1 & 2 \\end{pmatrix} $$\n\nThe matrices $K$, $M_{\\text{cons}}$, and $M_{\\text{under}}$ are all $2 \\times 2$ symmetric Toeplitz matrices of the form $\\begin{pmatrix} a & b \\\\ b & a \\end{pmatrix}$. The eigenvectors of such matrices are always $\\mathbf{v}_1 = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$ and $\\mathbf{v}_2 = \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$, with corresponding eigenvalues $a+b$ and $a-b$. The highest-frequency mode is associated with the eigenvector with alternating signs, $\\mathbf{v} = \\mathbf{v}_2 = \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$.\nFor $K = \\begin{pmatrix} 6 & -3 \\\\ -3 & 6 \\end{pmatrix}$, the eigenvalue for $\\mathbf{v}$ is $6 - (-3) = 9$. Thus, $K\\mathbf{v} = 9\\mathbf{v}$.\nFor $M_{\\text{cons}} = \\frac{1}{18} \\begin{pmatrix} 4 & 1 \\\\ 1 & 4 \\end{pmatrix}$, the eigenvalue for $\\mathbf{v}$ is $\\frac{1}{18}(4-1) = \\frac{3}{18} = \\frac{1}{6}$. Thus, $M_{\\text{cons}}\\mathbf{v} = \\frac{1}{6}\\mathbf{v}$.\nFor $M_{\\text{under}} = \\frac{1}{12} \\begin{pmatrix} 2 & 1 \\\\ 1 & 2 \\end{pmatrix}$, the eigenvalue for $\\mathbf{v}$ is $\\frac{1}{12}(2-1) = \\frac{1}{12}$. Thus, $M_{\\text{under}}\\mathbf{v} = \\frac{1}{12}\\mathbf{v}$.\nThe generalized eigenvalue problem is $K\\mathbf{v} = \\mu M\\mathbf{v}$. Substituting the relations for the eigenvector $\\mathbf{v}$:\n$9\\mathbf{v} = \\mu \\lambda_M \\mathbf{v}$, where $\\lambda_M$ is the eigenvalue of the mass matrix $M$. This gives $\\mu = \\frac{9}{\\lambda_M}$.\nFor consistent mass: $\\mu_{\\text{cons}} = \\frac{9}{1/6} = 54$.\nFor underintegrated mass: $\\mu_{\\text{under}} = \\frac{9}{1/12} = 108$.\n\nThe Crank-Nicolson scheme applied to $M \\dot{\\mathbf{u}} + \\kappa K \\mathbf{u} = \\mathbf{0}$ is:\n$$ M \\frac{\\mathbf{u}^{n+1} - \\mathbf{u}^n}{\\Delta t} + \\kappa K \\frac{\\mathbf{u}^{n+1} + \\mathbf{u}^n}{2} = \\mathbf{0} $$\nLet $\\mathbf{u}^n$ be a generalized eigenmode $\\mathbf{v}$. The one-step amplification factor $g$ is defined by $\\mathbf{u}^{n+1} = g\\mathbf{u}^n = g\\mathbf{v}$.\n$$ M \\frac{g\\mathbf{v} - \\mathbf{v}}{\\Delta t} + \\kappa K \\frac{g\\mathbf{v} + \\mathbf{v}}{2} = \\mathbf{0} $$\nUsing $K\\mathbf{v} = \\mu M\\mathbf{v}$ and factoring out the non-zero vector $M\\mathbf{v}$:\n$$ \\frac{g-1}{\\Delta t} + \\kappa \\mu \\frac{g+1}{2} = 0 $$\nSolving for $g$:\n$2(g-1) + \\kappa \\mu \\Delta t (g+1) = 0 \\implies g(2 + \\kappa \\mu \\Delta t) = 2 - \\kappa \\mu \\Delta t$.\n$$ g = \\frac{2 - \\kappa \\mu \\Delta t}{2 + \\kappa \\mu \\Delta t} = \\frac{1 - \\frac{\\kappa \\mu \\Delta t}{2}}{1 + \\frac{\\kappa \\mu \\Delta t}{2}} $$\n\nFinally, we compute $g$ for the underintegrated mass case, highest-frequency mode, with $\\kappa=1$ and $\\Delta t = 0.02$. The generalized eigenvalue is $\\mu = \\mu_{\\text{under}} = 108$.\nThe parameter group $\\frac{\\kappa \\mu \\Delta t}{2}$ is:\n$$ \\frac{1 \\cdot 108 \\cdot 0.02}{2} = \\frac{2.16}{2} = 1.08 $$\nSubstituting this value into the expression for $g$:\n$$ g = \\frac{1 - 1.08}{1 + 1.08} = \\frac{-0.08}{2.08} = -\\frac{8}{208} $$\nSimplifying the fraction by dividing the numerator and denominator by their greatest common divisor, which is $8$:\n$$ g = -\\frac{8 \\div 8}{208 \\div 8} = -\\frac{1}{26} $$",
            "answer": "$$\\boxed{-\\frac{1}{26}}$$"
        },
        {
            "introduction": "We have seen how mass lumping can introduce qualitative errors like unphysical oscillations. This practice delves into a more subtle but equally critical issue: the degradation of the method's quantitative accuracy, particularly on non-uniform meshes used in adaptive simulations. By performing an error analysis for the heat equation on a specially designed mesh, you will demonstrate how replacing the consistent mass matrix with a lumped one can reduce the method's formal order of convergence. This exercise highlights the crucial interplay between quadrature, mesh geometry, and accuracy that is central to advanced finite element analysis .",
            "id": "3454347",
            "problem": "Consider the one-dimensional transient diffusion (heat) equation\n$$\n\\partial_t u(x,t) - \\partial_{xx} u(x,t) = 0 \\quad \\text{for } x \\in (0,1), \\; t \\in (0,\\infty),\n$$\nwith homogeneous Dirichlet boundary conditions\n$$\nu(0,t) = 0, \\quad u(1,t) = 0 \\quad \\text{for all } t \\ge 0,\n$$\nand smooth initial condition chosen so that the exact solution is\n$$\nu(x,t) = \\exp(-\\pi^2 t)\\,\\sin(\\pi x).\n$$\nLet $\\{x_j\\}_{j=0}^N$ be the nonuniform mesh defined by $x_j = (j/N)^2$ for $j=0,1,\\dots,N$, and let $V_h$ be the space of continuous, piecewise linear functions on this mesh that vanish at $x=0$ and $x=1$. Denote by $a(\\cdot,\\cdot)$ the standard stiffness bilinear form\n$$\na(v,w) = \\int_0^1 v'(x)\\,w'(x)\\,dx,\n$$\nand by $(\\cdot,\\cdot)$ the exact $L^2(0,1)$ inner product. Define the consistent-mass semi-discretization: find $u_h^{\\mathrm{cons}}(t) \\in V_h$ such that\n$$\n(\\partial_t u_h^{\\mathrm{cons}}(t), w_h) + a(u_h^{\\mathrm{cons}}(t), w_h) = 0 \\quad \\text{for all } w_h \\in V_h, \\;\\; t>0,\n$$\nwith initial value $u_h^{\\mathrm{cons}}(0)$ given by the $L^2(0,1)$-projection of $u(\\cdot,0)$ onto $V_h$. Define the lumped-mass semi-discretization by replacing $(\\cdot,\\cdot)$ with the mass-lumped inner product $(\\cdot,\\cdot)_h$ induced by the composite trapezoidal rule on the given mesh: find $u_h^{\\mathrm{lump}}(t) \\in V_h$ such that\n$$\n(\\partial_t u_h^{\\mathrm{lump}}(t), w_h)_h + a(u_h^{\\mathrm{lump}}(t), w_h) = 0 \\quad \\text{for all } w_h \\in V_h, \\;\\; t>0,\n$$\nwith initial value $u_h^{\\mathrm{lump}}(0)$ given by the $(\\cdot,\\cdot)_h$-orthogonal projection of $u(\\cdot,0)$ onto $V_h$. Let $T>0$ be fixed (for definiteness, take $T=1$).\n\nWorking from fundamental definitions of the bilinear forms and the quadrature rule, and using only standard approximation properties of piecewise linear finite elements, derive the asymptotic order (as $N \\to \\infty$) of the $L^2(0,1)$-error at time $T$ for the lumped-mass method, namely\n$$\n\\|u(\\cdot,T) - u_h^{\\mathrm{lump}}(\\cdot,T)\\|_{L^2(0,1)} \\sim C\\, N^{-p},\n$$\nfor some constant $C>0$ independent of $N$. Determine the convergence rate exponent $p$. Your final answer must be the single value of $p$ as an exact number without units.",
            "solution": "The total error can be decomposed using the nodal interpolant $I_h u(t)$ of the exact solution $u(t)$:\n$$\ne(t) = u(t) - u_h^{\\mathrm{lump}}(t) = (u(t) - I_h u(t)) + (I_h u(t) - u_h^{\\mathrm{lump}}(t)) = \\eta(t) + \\theta_h(t)\n$$\nHere, $\\eta(t) = u(t) - I_h u(t)$ is the interpolation error, and $\\theta_h(t) = I_h u(t) - u_h^{\\mathrm{lump}}(t)$ is the discrete error, which belongs to the finite element space $V_h$. We need to find the order of $\\|e(T)\\|_{L^2(0,1)}$.\n\nFirst, we analyze the mesh. The nodes are $x_j = (j/N)^2$. The width of the $j$-th element $I_j = [x_{j-1}, x_j]$ is\n$$\nh_j = x_j - x_{j-1} = \\left(\\frac{j}{N}\\right)^2 - \\left(\\frac{j-1}{N}\\right)^2 = \\frac{j^2 - (j^2 - 2j + 1)}{N^2} = \\frac{2j-1}{N^2}\n$$\nThe maximum mesh width is $h_{\\max} = h_N = (2N-1)/N^2 = O(N^{-1})$. We denote $h = h_{\\max}$. The minimum mesh width is $h_{\\min} = h_1 = 1/N^2$. The mesh is not quasi-uniform since $h_{\\max}/h_{\\min} = O(N)$.\n\nNext, we analyze the error components.\n1.  **Interpolation Error $\\eta(t)$:** The solution $u(x,t) = \\exp(-\\pi^2 t)\\sin(\\pi x)$ is smooth. Standard approximation theory for piecewise linear interpolation gives the following error estimates in the $L^2$-norm and the $H^1$-seminorm:\n    $$\n    \\|\\eta(t)\\|_{L^2(0,1)} = \\|u(t) - I_h u(t)\\|_{L^2(0,1)} \\le C h^2 \\| \\partial_{xx} u(t) \\|_{L^2(0,1)}\n    $$\n    $$\n    |\\eta(t)|_{H^1(0,1)} = \\|(u(t) - I_h u(t))'\\|_{L^2(0,1)} \\le C h \\| \\partial_{xx} u(t) \\|_{L^2(0,1)}\n    $$\n    Since $h = O(N^{-1})$ and $\\partial_{xx} u(t)$ is bounded for fixed $t$, we have:\n    $$\n    \\|\\eta(t)\\|_{L^2(0,1)} = O(N^{-2}) \\quad \\text{and} \\quad |\\eta(t)|_{H^1(0,1)} = O(N^{-1})\n    $$\n\n2.  **Discrete Error $\\theta_h(t)$:** We derive the differential equation governing $\\theta_h(t)$.\n    The weak form of the exact solution is $(\\partial_t u, w_h) + a(u, w_h) = 0$ for any $w_h \\in V_h$.\n    The lumped-mass scheme is $(\\partial_t u_h^{\\mathrm{lump}}, w_h)_h + a(u_h^{\\mathrm{lump}}, w_h) = 0$.\n    Substituting $u_h^{\\mathrm{lump}} = I_h u - \\theta_h$ into the scheme gives:\n    $$\n    (\\partial_t I_h u - \\partial_t \\theta_h, w_h)_h + a(I_h u - \\theta_h, w_h) = 0\n    $$\n    Rearranging for the equation in $\\theta_h$:\n    $$\n    (\\partial_t \\theta_h, w_h)_h + a(\\theta_h, w_h) = (\\partial_t I_h u, w_h)_h + a(I_h u, w_h)\n    $$\n    We add and subtract terms to relate the right-hand side to the exact weak form:\n    $$\n    \\text{RHS} = (\\partial_t I_h u, w_h)_h + a(I_h u, w_h) = (\\partial_t (u-\\eta), w_h)_h + a(u-\\eta, w_h)\n    $$\n    $$\n    \\text{RHS} = (\\partial_t u, w_h)_h - (\\partial_t \\eta, w_h)_h + a(u,w_h) - a(\\eta, w_h)\n    $$\n    Using the exact weak form $a(u, w_h) = -(\\partial_t u, w_h)$:\n    $$\n    \\text{RHS} = [(\\partial_t u, w_h)_h - (\\partial_t u, w_h)] - (\\partial_t \\eta, w_h)_h - a(\\eta, w_h)\n    $$\n    The term in the square brackets is the quadrature error for the mass form, let's denote it by $-E(\\partial_t u, w_h)$.\n    So, the error equation for $\\theta_h$ is:\n    $$\n    (\\partial_t \\theta_h, w_h)_h + a(\\theta_h, w_h) = -E(\\partial_t u, w_h) - (\\partial_t \\eta, w_h)_h - a(\\eta, w_h)\n    $$\n    We choose the test function $w_h = \\theta_h$ and use the fact that $(\\partial_t \\theta_h, \\theta_h)_h = \\frac{1}{2}\\frac{d}{dt}\\|\\theta_h\\|_h^2$ and $a(\\theta_h, \\theta_h) = |\\theta_h|_{H^1}^2$:\n    $$\n    \\frac{1}{2}\\frac{d}{dt}\\|\\theta_h\\|_h^2 + |\\theta_h|_{H^1}^2 = -E(\\partial_t u, \\theta_h) - (\\partial_t \\eta, \\theta_h)_h - a(\\eta, \\theta_h)\n    $$\n    We bound the absolute value of the right-hand side terms. The dominant consistency error term is $a(\\eta, \\theta_h)$. Using the Cauchy-Schwarz and Young inequalities:\n    $$\n    |a(\\eta, \\theta_h)| \\le |\\eta|_{H^1} |\\theta_h|_{H^1} \\le \\frac{1}{2}|\\theta_h|_{H^1}^2 + \\frac{1}{2}|\\eta|_{H^1}^2\n    $$\n    The other consistency error terms involving quadrature error and time derivatives of $\\eta$ can be shown to be of a higher order. Thus, we have:\n    $$\n    \\frac{1}{2}\\frac{d}{dt}\\|\\theta_h\\|_h^2 + |\\theta_h|_{H^1}^2 \\le \\frac{1}{2}|\\theta_h|_{H^1}^2 + \\frac{1}{2}|\\eta|_{H^1}^2 + \\text{h.o.t.}\n    $$\n    $$\n    \\frac{d}{dt}\\|\\theta_h\\|_h^2 + |\\theta_h|_{H^1}^2 \\le |\\eta|_{H^1}^2 + \\text{h.o.t.} = (O(N^{-1}))^2 = O(N^{-2})\n    $$\n    Dropping the positive semidefinite term $|\\theta_h|_{H^1}^2$:\n    $$\n    \\frac{d}{dt}\\|\\theta_h\\|_h^2 \\le C N^{-2}\n    $$\n    Now, we check the initial condition. $u_h^{\\mathrm{lump}}(0)$ is the $(\\cdot,\\cdot)_h$-orthogonal projection of $u_0 = u(\\cdot,0)$. For the trapezoidal rule, this implies that the nodal values of $u_h^{\\mathrm{lump}}(0)$ are exactly the nodal values of $u_0$. Thus, $u_h^{\\mathrm{lump}}(0) = I_h u_0$. The initial discrete error is $\\theta_h(0) = I_h u_0 - u_h^{\\mathrm{lump}}(0) = 0$.\n\n    Integrating the differential inequality from $t=0$ to $T$:\n    $$\n    \\|\\theta_h(T)\\|_h^2 \\le \\int_0^T C N^{-2} dt = CT N^{-2}\n    $$\n    Since the lumped-mass norm $\\|\\cdot\\|_h$ is equivalent to the standard $L^2$-norm (with mesh-dependent constants, which is acceptable here), we get:\n    $$\n    \\|\\theta_h(T)\\|_{L^2(0,1)} = O(N^{-1})\n    $$\n\n3.  **Total Error:** The total error at time $T$ is bounded by the triangle inequality:\n    $$\n    \\|u(T) - u_h^{\\mathrm{lump}}(T)\\|_{L^2} \\le \\|\\eta(T)\\|_{L^2} + \\|\\theta_h(T)\\|_{L^2}\n    $$\n    Substituting the orders of convergence for each part:\n    $$\n    \\|u(T) - u_h^{\\mathrm{lump}}(T)\\|_{L^2} \\le O(N^{-2}) + O(N^{-1}) = O(N^{-1})\n    $$\n    The overall convergence rate is limited by the slower-converging term, which is the discrete error $\\theta_h$. The asymptotic order is $N^{-1}$.\n\nTherefore, the convergence rate exponent is $p=1$. This reduction from the optimal rate of $p=2$ (seen with consistent mass or on quasi-uniform meshes) is a consequence of the consistency error associated with the spatial discretization on this specific non-uniform mesh, which manifests as an $O(N^{-1})$ term in the evolution of the discrete error.",
            "answer": "$$\\boxed{1}$$"
        }
    ]
}