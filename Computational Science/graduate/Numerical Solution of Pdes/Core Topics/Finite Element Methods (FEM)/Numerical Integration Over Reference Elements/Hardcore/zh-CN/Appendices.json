{
    "hands_on_practices": [
        {
            "introduction": "要想真正掌握数值积分，理解求积法则的构建方式至关重要。本练习将深入探讨其理论基础，指导您从第一性原理出发，推导经典的三点高斯-勒让德求积法则。通过在 $[-1, 1]$ 一维参考区间上强制执行多项式精确性，您将深刻体会到这些法则是如何实现其强大功能与高效率的。",
            "id": "3425921",
            "problem": "在用于数值求解偏微分方程（PDE）的有限元方法（FEM）中，参考区间上的积分通常使用基于多项式的求积法进行计算。考虑参考区间 $[-1,1]$ 和多项式 $p(x)=x^{5}-2x^{3}+x$。使用 $[-1,1]$ 上的三点高斯-勒让德求积法，按如下步骤进行：\n\n1. 通过要求对所有次数最高为 $5$ 的多项式都精确，并利用区间和勒贝格测度的对称性，推导出 $[-1,1]$ 上三点法则的节点和权重。您的推导必须从求积法则的定义开始，即一个点评估值的加权和，其结果与测度的精确矩匹配，直到目标次数。\n\n2. 使用您推导出的节点和权重，计算 $\\int_{-1}^{1} p(x)\\,dx$ 的求积近似值。\n\n3. 使用第一性原理计算 $\\int_{-1}^{1} p(x)\\,dx$ 的解析值，并与求积结果进行比较，以验证在此情况下的精确性。\n\n将您的最终答案表示为单个实数。无需四舍五入。",
            "solution": "该问题要求在区间 $[-1, 1]$ 上推导并应用三点高斯-勒让德求积法则。过程包括三个部分：推导求积节点和权重，将该法则应用于特定多项式，以及解析地计算精确积分以进行验证。\n\n**第一部分：节点和权重的推导**\n在区间 $[-1, 1]$ 上的一个三点求积法则旨在将积分近似为在三个特定点（节点）处的函数值的加权和：\n$$\n\\int_{-1}^{1} f(x) \\,dx \\approx \\sum_{i=1}^{3} w_i f(x_i) = w_1 f(x_1) + w_2 f(x_2) + w_3 f(x_3)\n$$\n该法则有六个未知数：节点 $x_1, x_2, x_3$ 和权重 $w_1, w_2, w_3$。对于一个有 $n=3$ 个点的高斯-勒让德求积法，我们要求该公式对所有次数最高为 $2n-1 = 2(3)-1 = 5$ 的多项式都精确。通过对单项式基 $\\{1, x, x^2, x^3, x^4, x^5\\}$ 强制精确性，这提供了六个条件。\n\n令 $I_k = \\int_{-1}^{1} x^k \\,dx$。这些精确积分的值为：\n- $I_0 = \\int_{-1}^{1} 1 \\,dx = [x]_{-1}^{1} = 2$\n- $I_1 = \\int_{-1}^{1} x \\,dx = [\\frac{x^2}{2}]_{-1}^{1} = 0$\n- $I_2 = \\int_{-1}^{1} x^2 \\,dx = [\\frac{x^3}{3}]_{-1}^{1} = \\frac{2}{3}$\n- $I_3 = \\int_{-1}^{1} x^3 \\,dx = [\\frac{x^4}{4}]_{-1}^{1} = 0$\n- $I_4 = \\int_{-1}^{1} x^4 \\,dx = [\\frac{x^5}{5}]_{-1}^{1} = \\frac{2}{5}$\n- $I_5 = \\int_{-1}^{1} x^5 \\,dx = [\\frac{x^6}{6}]_{-1}^{1} = 0$\n\n令 $Q(x^k) = \\sum_{i=1}^{3} w_i x_i^k$。我们必须满足 $k = 0, \\ldots, 5$ 时 $Q(x^k) = I_k$。这产生以下方程组：\n1.  $w_1 + w_2 + w_3 = 2$\n2.  $w_1 x_1 + w_2 x_2 + w_3 x_3 = 0$\n3.  $w_1 x_1^2 + w_2 x_2^2 + w_3 x_3^2 = \\frac{2}{3}$\n4.  $w_1 x_1^3 + w_2 x_2^3 + w_3 x_3^3 = 0$\n5.  $w_1 x_1^4 + w_2 x_2^4 + w_3 x_3^4 = \\frac{2}{5}$\n6.  $w_1 x_1^5 + w_2 x_2^5 + w_3 x_3^5 = 0$\n\n正如提示所说，我们利用积分区间 $[-1, 1]$ 和勒贝格测度 $dx$ 的对称性。这意味着节点和权重的对称排列。我们假设一个节点在中心，$x_2 = 0$，另外两个节点对称，$x_1 = -x_3$。相应的权重也必须对称，$w_1 = w_3$。我们记 $x_3 = \\xi > 0$。未知数减少为 $x_2=0$, $x_1=-\\xi$, $x_3=\\xi$, $w_2$, 和 $w_1=w_3$。\n\n将这些代入方程组：\n1.  $w_1 + w_2 + w_1 = 2 \\implies 2w_1 + w_2 = 2$\n2.  $w_1(-\\xi) + w_2(0) + w_1(\\xi) = 0$。这个方程自动满足。\n3.  $w_1(-\\xi)^2 + w_2(0)^2 + w_1(\\xi)^2 = \\frac{2}{3} \\implies 2w_1 \\xi^2 = \\frac{2}{3} \\implies w_1 \\xi^2 = \\frac{1}{3}$\n4.  $w_1(-\\xi)^3 + w_2(0)^3 + w_1(\\xi)^3 = 0$。这个方程也自动满足。\n5.  $w_1(-\\xi)^4 + w_2(0)^4 + w_1(\\xi)^4 = \\frac{2}{5} \\implies 2w_1 \\xi^4 = \\frac{2}{5} \\implies w_1 \\xi^4 = \\frac{1}{5}$\n6.  $w_1(-\\xi)^5 + w_2(0)^5 + w_1(\\xi)^5 = 0$。这个方程也自动满足。\n\n我们得到一个关于三个未知数 $w_1, w_2, \\xi$ 的三方程系统：\n(A) $2w_1 + w_2 = 2$\n(B) $w_1 \\xi^2 = \\frac{1}{3}$\n(C) $w_1 \\xi^4 = \\frac{1}{5}$\n\n将方程 (C) 除以 (B) 得到：\n$$\n\\frac{w_1 \\xi^4}{w_1 \\xi^2} = \\frac{1/5}{1/3} \\implies \\xi^2 = \\frac{3}{5}\n$$\n因此，正节点是 $\\xi = \\sqrt{\\frac{3}{5}}$。\n节点为 $x_1 = -\\sqrt{\\frac{3}{5}}$, $x_2 = 0$, $x_3 = \\sqrt{\\frac{3}{5}}$。\n\n将 $\\xi^2 = \\frac{3}{5}$ 代回方程 (B) 以求出 $w_1$：\n$$\nw_1 \\left(\\frac{3}{5}\\right) = \\frac{1}{3} \\implies w_1 = \\frac{5}{9}\n$$\n因为 $w_1 = w_3$，所以我们有 $w_3 = \\frac{5}{9}$。\n\n最后，使用方程 (A) 求出 $w_2$：\n$$\n2\\left(\\frac{5}{9}\\right) + w_2 = 2 \\implies \\frac{10}{9} + w_2 = \\frac{18}{9} \\implies w_2 = \\frac{8}{9}\n$$\n三点高斯-勒让德求积法的节点和权重是：\n- 节点: $x_1 = -\\sqrt{\\frac{3}{5}}, x_2 = 0, x_3 = \\sqrt{\\frac{3}{5}}$\n- 权重: $w_1 = \\frac{5}{9}, w_2 = \\frac{8}{9}, w_3 = \\frac{5}{9}$\n\n**第二部分：求积近似**\n我们现在应用这个法则来计算 $p(x) = x^5 - 2x^3 + x$ 的积分。求积近似值为 $Q(p) = \\sum_{i=1}^{3} w_i p(x_i)$。\n\n首先，在节点处计算 $p(x)$ 的值：\n- 对于 $x_2 = 0$：\n$p(0) = 0^5 - 2(0)^3 + 0 = 0$。\n- 对于 $x_3 = \\sqrt{\\frac{3}{5}}$：\n$p\\left(\\sqrt{\\frac{3}{5}}\\right) = \\left(\\sqrt{\\frac{3}{5}}\\right)^5 - 2\\left(\\sqrt{\\frac{3}{5}}\\right)^3 + \\sqrt{\\frac{3}{5}}$\n我们可以提出因子 $\\sqrt{\\frac{3}{5}}$：\n$p\\left(\\sqrt{\\frac{3}{5}}\\right) = \\sqrt{\\frac{3}{5}} \\left( \\left(\\frac{3}{5}\\right)^2 - 2\\left(\\frac{3}{5}\\right) + 1 \\right) = \\sqrt{\\frac{3}{5}} \\left( \\frac{9}{25} - \\frac{6}{5} + 1 \\right)$\n$p\\left(\\sqrt{\\frac{3}{5}}\\right) = \\sqrt{\\frac{3}{5}} \\left( \\frac{9 - 30 + 25}{25} \\right) = \\sqrt{\\frac{3}{5}} \\left( \\frac{4}{25} \\right) = \\frac{4}{25}\\sqrt{\\frac{3}{5}}$。\n- 对于 $x_1 = -\\sqrt{\\frac{3}{5}}$：\n多项式 $p(x)$ 是一个奇函数，因为 $x$ 的所有次幂都是奇数。因此，$p(-x) = -p(x)$。\n$p\\left(-\\sqrt{\\frac{3}{5}}\\right) = -p\\left(\\sqrt{\\frac{3}{5}}\\right) = -\\frac{4}{25}\\sqrt{\\frac{3}{5}}$。\n\n现在，组合求积和：\n$Q(p) = w_1 p(x_1) + w_2 p(x_2) + w_3 p(x_3)$\n$Q(p) = \\left(\\frac{5}{9}\\right) \\left(-\\frac{4}{25}\\sqrt{\\frac{3}{5}}\\right) + \\left(\\frac{8}{9}\\right)(0) + \\left(\\frac{5}{9}\\right) \\left(\\frac{4}{25}\\sqrt{\\frac{3}{5}}\\right)$\n$Q(p) = -\\frac{20}{225}\\sqrt{\\frac{3}{5}} + 0 + \\frac{20}{225}\\sqrt{\\frac{3}{5}} = 0$。\n\n通过求积法近似得到的积分值为 $0$。\n\n**第三部分：解析计算与验证**\n我们通过直接积分计算积分的精确值：\n$$\n\\int_{-1}^{1} p(x) \\,dx = \\int_{-1}^{1} (x^5 - 2x^3 + x) \\,dx\n$$\n我们可以逐项积分：\n$$\n\\left[ \\frac{x^6}{6} - 2\\frac{x^4}{4} + \\frac{x^2}{2} \\right]_{-1}^{1} = \\left[ \\frac{x^6}{6} - \\frac{x^4}{2} + \\frac{x^2}{2} \\right]_{-1}^{1}\n$$\n在边界处求值：\n$$\n\\left( \\frac{1^6}{6} - \\frac{1^4}{2} + \\frac{1^2}{2} \\right) - \\left( \\frac{(-1)^6}{6} - \\frac{(-1)^4}{2} + \\frac{(-1)^2}{2} \\right) = \\left( \\frac{1}{6} - \\frac{1}{2} + \\frac{1}{2} \\right) - \\left( \\frac{1}{6} - \\frac{1}{2} + \\frac{1}{2} \\right) = \\frac{1}{6} - \\frac{1}{6} = 0\n$$\n另外，函数 $p(x)=x^5-2x^3+x$ 是一个奇函数，因为 $p(-x) = (-x)^5 - 2(-x)^3 + (-x) = -x^5 + 2x^3 - x = -p(x)$。任何奇函数在对称区间（如 $[-1, 1]$）上的积分恒为零。\n\n比较结果，求积近似值 $Q(p)=0$ 与积分的精确解析值（也为 $0$）相同。这是预料之中的，因为多项式 $p(x)$ 的次数是 $5$，而三点高斯-勒让德求积法则对所有次数最高为 $5$ 的多项式都是精确的。该计算成功地验证了这一理论性质。最终答案是计算出的值，即 $0$。",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "现在，我们从理论转向有限元方法（FEM）中的一个核心应用：组装单元矩阵。本练习将展示我们所学的求积法则如何用于计算参考三角形上的单元质量矩阵项。您将发现一个关键情形：当求积法则的精度与多项式被积函数完全匹配时，无需符号积分即可精确计算出矩阵，这对于高效的有限元计算至关重要。",
            "id": "3425897",
            "problem": "考虑参考三角形 $\\hat K = \\{(\\xi,\\eta) \\in \\mathbb{R}^2 : \\xi \\ge 0,\\ \\eta \\ge 0,\\ \\xi+\\eta \\le 1\\}$，其标准线性形函数为 $\\hat\\phi_1(\\xi,\\eta) = 1 - \\xi - \\eta$、$\\hat\\phi_2(\\xi,\\eta) = \\xi$ 和 $\\hat\\phi_3(\\xi,\\eta) = \\eta$。在 $\\hat K$ 上的线性有限元空间的单元质量矩阵由以下各项定义：$M_{ij} = \\int_{\\hat K} \\hat\\phi_i(\\xi,\\eta)\\,\\hat\\phi_j(\\xi,\\eta)\\, \\mathrm{d}\\xi\\,\\mathrm{d}\\eta$，其中 $i,j \\in \\{1,2,3\\}$。\n\n1) 仅使用 $M_{ij}$ 的定义和在域 $\\hat K$ 上的基本多元微积分，通过解析积分计算质量矩阵 $M$ 的精确项。\n\n2) 现在考虑 $\\hat K$ 上的对称2阶求积法则，其节点为 $(\\xi,\\eta) \\in \\{(1/6,1/6),\\ (2/3,1/6),\\ (1/6,2/3)\\}$，等权重为 $w = 1/6$。组装基于求积的矩阵 $M^{(2)}$，其项为 $M^{(2)}_{ij} = \\sum_{k=1}^{3} w\\,\\hat\\phi_i(\\xi_k,\\eta_k)\\,\\hat\\phi_j(\\xi_k,\\eta_k)$。\n\n3) 通过计算弗罗贝尼乌斯范数 $\\|M - M^{(2)}\\|_F$ 来比较 $M$ 和 $M^{(2)}$，并从第一性原理（多项式精度）证明其值。\n\n作为最终答案，请以单个简化的解析表达式（无四舍五入）报告 $\\det(M)$ 的精确值。",
            "solution": "解答按要求分为三个主要部分：质量矩阵 $M$ 的解析计算，基于求积的矩阵 $M^{(2)}$ 的计算，以及两个矩阵的比较，最后是 $M$ 的行列式计算。\n\n**1) 质量矩阵 $M$ 的解析计算**\n\n单元质量矩阵 $M$ 的项由 $M_{ij} = \\int_{\\hat{K}} \\hat{\\phi}_i(\\xi, \\eta) \\hat{\\phi}_j(\\xi, \\eta) \\, \\mathrm{d}\\xi\\,\\mathrm{d}\\eta$ 给出。积分区域是参考三角形 $\\hat{K}$，其面积为 $|\\hat{K}| = \\frac{1}{2}$。所提供的形函数 $\\hat{\\phi}_1 = 1 - \\xi - \\eta$、$\\hat{\\phi}_2 = \\xi$ 和 $\\hat{\\phi}_3 = \\eta$ 是 $\\hat{K}$ 上的标准重心坐标。\n\n为了计算这些积分，我们使用在2-单纯形（一个三角形）上重心坐标乘积积分的标准公式：\n$$\n\\int_{\\hat{K}} \\hat{\\phi}_1^{a} \\hat{\\phi}_2^{b} \\hat{\\phi}_3^{c} \\, \\mathrm{d}A = 2 |\\hat{K}| \\frac{a! b! c!}{(a+b+c+2)!} = \\frac{a! b! c!}{(a+b+c+2)!}\n$$\n其中 $a, b, c$ 是非负整数指数。任何项 $M_{ij}$ 的被积函数都是两个线性基函数的乘积，总多项式次数为2。\n\n矩阵 $M$ 是对称的（$M_{ij} = M_{ji}$），因此我们只需要计算对角线和上三角部分的项。\n\n对于对角线上的项，被积函数的形式为 $\\hat{\\phi}_i^2$。\n$M_{11} = \\int_{\\hat{K}} \\hat{\\phi}_1^2 \\, \\mathrm{d}A = \\int_{\\hat{K}} \\hat{\\phi}_1^2 \\hat{\\phi}_2^0 \\hat{\\phi}_3^0 \\, \\mathrm{d}A$。使用公式，其中 $(a,b,c)=(2,0,0)$：\n$$M_{11} = \\frac{2!0!0!}{(2+0+0+2)!} = \\frac{2}{4!} = \\frac{2}{24} = \\frac{1}{12}$$\n根据公式中基函数的对称性，其他对角线项是相同的：\n$M_{22} = \\int_{\\hat{K}} \\hat{\\phi}_2^2 \\, \\mathrm{d}A = \\frac{0!2!0!}{(0+2+0+2)!} = \\frac{1}{12}$。\n$M_{33} = \\int_{\\hat{K}} \\hat{\\phi}_3^2 \\, \\mathrm{d}A = \\frac{0!0!2!}{(0+0+2+2)!} = \\frac{1}{12}$。\n\n对于非对角线上的项，被积函数的形式为 $\\hat{\\phi}_i \\hat{\\phi}_j$，其中 $i \\ne j$。\n$M_{12} = \\int_{\\hat{K}} \\hat{\\phi}_1 \\hat{\\phi}_2 \\, \\mathrm{d}A = \\int_{\\hat{K}} \\hat{\\phi}_1^1 \\hat{\\phi}_2^1 \\hat{\\phi}_3^0 \\, \\mathrm{d}A$。使用公式，其中 $(a,b,c)=(1,1,0)$：\n$$M_{12} = \\frac{1!1!0!}{(1+1+0+2)!} = \\frac{1}{4!} = \\frac{1}{24}$$\n同样，通过对称性，其他非对角线项是相同的：\n$M_{13} = \\int_{\\hat{K}} \\hat{\\phi}_1 \\hat{\\phi}_3 \\, \\mathrm{d}A = \\frac{1!0!1!}{(1+0+1+2)!} = \\frac{1}{24}$。\n$M_{23} = \\int_{\\hat{K}} \\hat{\\phi}_2 \\hat{\\phi}_3 \\, \\mathrm{d}A = \\frac{0!1!1!}{(0+1+1+2)!} = \\frac{1}{24}$。\n\n将这些项组装起来，精确的质量矩阵是：\n$$\nM = \\begin{pmatrix} 1/12  1/24  1/24 \\\\ 1/24  1/12  1/24 \\\\ 1/24  1/24  1/12 \\end{pmatrix} = \\frac{1}{24} \\begin{pmatrix} 2  1  1 \\\\ 1  2  1 \\\\ 1  1  2 \\end{pmatrix}\n$$\n\n**2) 基于求积的矩阵 $M^{(2)}$ 的计算**\n\n矩阵 $M^{(2)}$ 是使用所提供的对称2阶求积法则组装的。其项由 $M^{(2)}_{ij} = \\sum_{k=1}^{3} w\\,\\hat{\\phi}_i(\\xi_k,\\eta_k)\\,\\hat{\\phi}_j(\\xi_k,\\eta_k)$ 给出。\n求积节点为 $P_1 = (1/6, 1/6)$、$P_2 = (2/3, 1/6)$、$P_3 = (1/6, 2/3)$，统一权重为 $w = 1/6$。\n\n首先，我们在每个求积节点上计算形函数的值：\n在 $P_1=(1/6, 1/6)$ 处：$\\hat{\\phi}_1(P_1) = 1 - 1/6 - 1/6 = 2/3$，$\\hat{\\phi}_2(P_1) = 1/6$，$\\hat{\\phi}_3(P_1) = 1/6$。\n在 $P_2=(2/3, 1/6)$ 处：$\\hat{\\phi}_1(P_2) = 1 - 2/3 - 1/6 = 1/6$，$\\hat{\\phi}_2(P_2) = 2/3$，$\\hat{\\phi}_3(P_2) = 1/6$。\n在 $P_3=(1/6, 2/3)$ 处：$\\hat{\\phi}_1(P_3) = 1 - 1/6 - 2/3 = 1/6$，$\\hat{\\phi}_2(P_3) = 1/6$，$\\hat{\\phi}_3(P_3) = 2/3$。\n\n现在我们计算 $M^{(2)}$ 的各项：\n$M^{(2)}_{11} = w \\sum_{k=1}^3 (\\hat{\\phi}_1(P_k))^2 = \\frac{1}{6} \\left[ (\\frac{2}{3})^2 + (\\frac{1}{6})^2 + (\\frac{1}{6})^2 \\right] = \\frac{1}{6} \\left[ \\frac{4}{9} + \\frac{1}{36} + \\frac{1}{36} \\right] = \\frac{1}{6} \\left[ \\frac{16}{36} + \\frac{2}{36} \\right] = \\frac{1}{6} \\left( \\frac{18}{36} \\right) = \\frac{1}{12}$。\n$M^{(2)}_{22} = w \\sum_{k=1}^3 (\\hat{\\phi}_2(P_k))^2 = \\frac{1}{6} \\left[ (\\frac{1}{6})^2 + (\\frac{2}{3})^2 + (\\frac{1}{6})^2 \\right] = \\frac{1}{12}$。\n$M^{(2)}_{33} = w \\sum_{k=1}^3 (\\hat{\\phi}_3(P_k))^2 = \\frac{1}{6} \\left[ (\\frac{1}{6})^2 + (\\frac{1}{6})^2 + (\\frac{2}{3})^2 \\right] = \\frac{1}{12}$。\n\n$M^{(2)}_{12} = w \\sum_{k=1}^3 \\hat{\\phi}_1(P_k)\\hat{\\phi}_2(P_k) = \\frac{1}{6} \\left[ (\\frac{2}{3})(\\frac{1}{6}) + (\\frac{1}{6})(\\frac{2}{3}) + (\\frac{1}{6})(\\frac{1}{6}) \\right] = \\frac{1}{6} \\left[ \\frac{2}{18} + \\frac{2}{18} + \\frac{1}{36} \\right] = \\frac{1}{6} \\left[ \\frac{4}{36} + \\frac{4}{36} + \\frac{1}{36} \\right] = \\frac{1}{6} \\left( \\frac{9}{36} \\right) = \\frac{1}{24}$。\n通过节点位置和函数值的对称性，我们发现：\n$M^{(2)}_{13} = w \\sum_{k=1}^3 \\hat{\\phi}_1(P_k)\\hat{\\phi}_3(P_k) = \\frac{1}{6} \\left[ (\\frac{2}{3})(\\frac{1}{6}) + (\\frac{1}{6})(\\frac{1}{6}) + (\\frac{1}{6})(\\frac{2}{3}) \\right] = \\frac{1}{24}$。\n$M^{(2)}_{23} = w \\sum_{k=1}^3 \\hat{\\phi}_2(P_k)\\hat{\\phi}_3(P_k) = \\frac{1}{6} \\left[ (\\frac{1}{6})(\\frac{1}{6}) + (\\frac{2}{3})(\\frac{1}{6}) + (\\frac{1}{6})(\\frac{2}{3}) \\right] = \\frac{1}{24}$。\n\n得到的矩阵是：\n$$\nM^{(2)} = \\begin{pmatrix} 1/12  1/24  1/24 \\\\ 1/24  1/12  1/24 \\\\ 1/24  1/24  1/12 \\end{pmatrix}\n$$\n\n**3) 比较与证明**\n\n从上面的计算中，我们看到 $M = M^{(2)}$。\n矩阵差是零矩阵：$M - M^{(2)} = \\mathbf{0}$。\n差的弗罗贝尼乌斯范数定义为 $\\|A\\|_F = \\sqrt{\\sum_{i=1}^m \\sum_{j=1}^n |a_{ij}|^2}$。对于零矩阵，此范数为：\n$$\n\\|M - M^{(2)}\\|_F = \\|\\mathbf{0}\\|_F = 0\n$$\n\n这个结果是预料之中的，并且可以从第一性原理得到证明。每个项 $M_{ij}$ 的计算都涉及对函数 $f_{ij}(\\xi, \\eta) = \\hat{\\phi}_i(\\xi, \\eta) \\hat{\\phi}_j(\\xi, \\eta)$ 的积分。由于每个形函数 $\\hat{\\phi}_k$ 都是一个线性多项式（1次），乘积 $f_{ij}$ 是一个次数最多为2的多项式。\n问题陈述中指出，用于计算 $M^{(2)}$ 的求积法则是“2阶”法则。根据定义，一个 $p$ 阶的求积法则能够精确地积分任何次数不超过 $p$ 的多项式。因此，对于任何次数 $\\text{deg}(P) \\le 2$ 的多项式 $P(\\xi, \\eta)$，我们有 $\\int_{\\hat{K}} P(\\xi, \\eta) \\, \\mathrm{d}A = \\sum_{k=1}^{3} w P(\\xi_k, \\eta_k)$。\n由于所有被积函数 $f_{ij}$ 都是2次多项式，该求积法则对质量矩阵的每一项都能给出积分的精确值。\n因此，对于所有的 $i,j$，都有 $M_{ij}^{(2)} = \\sum_{k=1}^{3} w f_{ij}(\\xi_k, \\eta_k) = \\int_{\\hat{K}} f_{ij}(\\xi, \\eta) \\, \\mathrm{d}A = M_{ij}$。\n矩阵 $M$ 和 $M^{(2)}$ 是相同的，它们差的范数精确为零。这是求积法则的精度阶对于被积函数的多项式次数足够高的直接结果。\n\n**最终答案计算：$\\det(M)$**\n\n最后的任务是计算精确质量矩阵 $M$ 的行列式。\n$$\nM = \\frac{1}{24} \\begin{pmatrix} 2  1  1 \\\\ 1  2  1 \\\\ 1  1  2 \\end{pmatrix}\n$$\n对于一个 $n \\times n$ 矩阵，使用性质 $\\det(c A) = c^n \\det(A)$，其中 $n=3$ 且 $c=1/24$：\n$$\n\\det(M) = \\left(\\frac{1}{24}\\right)^3 \\det \\begin{pmatrix} 2  1  1 \\\\ 1  2  1 \\\\ 1  1  2 \\end{pmatrix}\n$$\n内部矩阵的行列式为：\n$$\n\\det \\begin{pmatrix} 2  1  1 \\\\ 1  2  1 \\\\ 1  1  2 \\end{pmatrix} = 2(2 \\cdot 2 - 1 \\cdot 1) - 1(1 \\cdot 2 - 1 \\cdot 1) + 1(1 \\cdot 1 - 2 \\cdot 1)\n$$\n$$\n= 2(3) - 1(1) + 1(-1) = 6 - 1 - 1 = 4\n$$\n将此结果代回到 $\\det(M)$ 的表达式中：\n$$\n\\det(M) = \\frac{4}{24^3} = \\frac{4}{24 \\times 24 \\times 24} = \\frac{1}{6 \\times 24 \\times 24} = \\frac{1}{6 \\times 576} = \\frac{1}{3456}\n$$\n行列式的精确值为 $\\frac{1}{3456}$。",
            "answer": "$$\\boxed{\\frac{1}{3456}}$$"
        },
        {
            "introduction": "现实世界的问题，尤其非线性问题，其被积函数通常不是简单的多项式。本练习将探讨当求积法则的精度不足以处理复杂函数时会发生什么，即产生所谓的“混叠误差”。通过分析一个高频三角函数的积分，您将深入了解非线性有限元分析中的一个关键挑战，并理解选择合适求积法则的重要性。",
            "id": "3425886",
            "problem": "考虑在等参有限元中用于数值求解偏微分方程（PDE）的参考四边形单元 $\\hat Q = [-1,1] \\times [-1,1]$。在非线性残差评估中，人们经常需要对离散场 $\\hat u$ 的非线性函数进行积分，当网格相对于解的振荡较为粗糙时，该函数可能包含高频内容。设在 $\\hat Q$上给定一个光滑的高频场 $\\hat u_{\\omega}(x,y) = \\cos(\\omega x)\\cos(\\omega y)$，其中频率参数 $\\omega > 0$，并考虑非线性残差贡献\n$$\n\\mathcal{R}(\\omega) = \\int_{\\hat Q} \\left(\\hat u_{\\omega}(x,y)\\right)^{3} \\,\\mathrm{d}x\\,\\mathrm{d}y.\n$$\n从高斯求积法则的基本定义及其在 $\\hat Q$ 上的张量积构造出发，推导 $\\mathcal{R}(\\omega)$ 的精确值，以及使用在 $\\hat Q$ 上每个坐标方向上的张量积两点高斯-勒让德法则得到的近似值 $\\mathcal{Q}(\\omega)$。然后，将混叠（求积）误差定义为\n$$\nE(\\omega) = \\mathcal{Q}(\\omega) - \\mathcal{R}(\\omega),\n$$\n并提供 $E(\\omega)$ 作为 $\\omega$ 函数的闭式解析表达式。最终答案必须是单一表达式。无需四舍五入。",
            "solution": "任务是计算在一个参考四边形单元上，对一个特定的非线性积分应用两点高斯-勒让德求积法则所产生的混叠误差。推导将分三步进行：首先，精确计算积分 $\\mathcal{R}(\\omega)$；其次，计算其数值近似值 $\\mathcal{Q}(\\omega)$；第三，确定误差 $E(\\omega) = \\mathcal{Q}(\\omega) - \\mathcal{R}(\\omega)$。\n\n问题将参考四边形单元定义为 $\\hat Q = [-1,1] \\times [-1,1]$，函数为 $\\hat u_{\\omega}(x,y) = \\cos(\\omega x)\\cos(\\omega y)$。需要计算的积分是\n$$\n\\mathcal{R}(\\omega) = \\int_{\\hat Q} \\left(\\hat u_{\\omega}(x,y)\\right)^{3} \\,\\mathrm{d}x\\,\\mathrm{d}y = \\int_{-1}^{1} \\int_{-1}^{1} \\cos^3(\\omega x)\\cos^3(\\omega y) \\,\\mathrm{d}x\\,\\mathrm{d}y.\n$$\n\n第一步：精确计算 $\\mathcal{R}(\\omega)$。\n被积函数 $\\cos^3(\\omega x)\\cos^3(\\omega y)$ 是一个可分离函数。因此，该二重积分可以表示为两个相同单变量积分的乘积：\n$$\n\\mathcal{R}(\\omega) = \\left( \\int_{-1}^{1} \\cos^3(\\omega x) \\,\\mathrm{d}x \\right) \\left( \\int_{-1}^{1} \\cos^3(\\omega y) \\,\\mathrm{d}y \\right) = \\left( \\int_{-1}^{1} \\cos^3(\\omega \\xi) \\,\\mathrm{d}\\xi \\right)^2.\n$$\n让我们将一维积分定义为 $I(\\omega) = \\int_{-1}^{1} \\cos^3(\\omega \\xi) \\,\\mathrm{d}\\xi$。为计算此积分，我们使用三角降幂恒等式 $\\cos^3(\\theta) = \\frac{3\\cos(\\theta) + \\cos(3\\theta)}{4}$。应用此恒等式，我们得到：\n$$\nI(\\omega) = \\int_{-1}^{1} \\frac{1}{4} \\left( 3\\cos(\\omega\\xi) + \\cos(3\\omega\\xi) \\right) \\,\\mathrm{d}\\xi.\n$$\n积分为：\n$$\nI(\\omega) = \\frac{1}{4} \\left[ \\frac{3\\sin(\\omega\\xi)}{\\omega} + \\frac{\\sin(3\\omega\\xi)}{3\\omega} \\right]_{-1}^{1}.\n$$\n在积分限 $\\xi = 1$ 和 $\\xi = -1$ 处求值：\n$$\nI(\\omega) = \\frac{1}{4\\omega} \\left[ \\left(3\\sin(\\omega) + \\frac{\\sin(3\\omega)}{3}\\right) - \\left(3\\sin(-\\omega) + \\frac{\\sin(-3\\omega)}{3}\\right) \\right].\n$$\n由于正弦函数是奇函数，$\\sin(-z) = -\\sin(z)$。这可将表达式简化为：\n$$\nI(\\omega) = \\frac{1}{4\\omega} \\left[ 2 \\left( 3\\sin(\\omega) + \\frac{\\sin(3\\omega)}{3} \\right) \\right] = \\frac{1}{2\\omega} \\left( 3\\sin(\\omega) + \\frac{\\sin(3\\omega)}{3} \\right).\n$$\n为了简化括号内的表达式，我们可以提出因子 $1/3$：\n$$\nI(\\omega) = \\frac{1}{6\\omega} \\left( 9\\sin(\\omega) + \\sin(3\\omega) \\right).\n$$\n精确积分 $\\mathcal{R}(\\omega)$ 是 $I(\\omega)$ 的平方：\n$$\n\\mathcal{R}(\\omega) = (I(\\omega))^2 = \\left( \\frac{9\\sin(\\omega) + \\sin(3\\omega)}{6\\omega} \\right)^2 = \\frac{\\left(9\\sin(\\omega) + \\sin(3\\omega)\\right)^2}{36\\omega^2}.\n$$\n\n第二步：近似计算 $\\mathcal{Q}(\\omega)$。\n该近似值是通过使用张量积两点高斯-勒让德求积法则得到的。对于在 $[-1,1]$ 上的一个一维积分，该法则由下式给出：\n$$\n\\int_{-1}^{1} g(\\xi) \\,\\mathrm{d}\\xi \\approx w_1 g(\\xi_1) + w_2 g(\\xi_2),\n$$\n其中求积点为 $\\xi_1 = -1/\\sqrt{3}$、$\\xi_2 = 1/\\sqrt{3}$，权重为 $w_1 = w_2 = 1$。\n\n对于在 $\\hat Q$ 上的二维积分，张量积法则是：\n$$\n\\int_{-1}^{1}\\int_{-1}^{1} f(x,y) \\,\\mathrm{d}x\\,\\mathrm{d}y \\approx \\sum_{i=1}^{2}\\sum_{j=1}^{2} w_i w_j f(x_i, y_j).\n$$\n被积函数为 $f(x,y) = \\cos^3(\\omega x)\\cos^3(\\omega y)$。四个求积点为 $(-1/\\sqrt{3}, -1/\\sqrt{3})$、$(-1/\\sqrt{3}, 1/\\sqrt{3})$、$(1/\\sqrt{3}, -1/\\sqrt{3})$ 和 $(1/\\sqrt{3}, 1/\\sqrt{3})$。由于所有权重都为 $1$，近似值 $\\mathcal{Q}(\\omega)$ 是函数在这四个点处的值的总和。\n\n被积函数 $f(x,y)$ 关于 $x$ 和 $y$ 都是偶函数，因为 $\\cos(-z) = \\cos(z)$。因此，函数在所有四个求积点的值都相同：\n$$\nf\\left(\\pm\\frac{1}{\\sqrt{3}}, \\pm\\frac{1}{\\sqrt{3}}\\right) = \\cos^3\\left(\\omega \\frac{1}{\\sqrt{3}}\\right) \\cos^3\\left(\\omega \\frac{1}{\\sqrt{3}}\\right) = \\cos^6\\left(\\frac{\\omega}{\\sqrt{3}}\\right).\n$$\n因此，求积近似值为：\n$$\n\\mathcal{Q}(\\omega) = 1 \\cdot 1 \\cdot \\cos^6\\left(\\frac{\\omega}{\\sqrt{3}}\\right) + 1 \\cdot 1 \\cdot \\cos^6\\left(\\frac{\\omega}{\\sqrt{3}}\\right) + 1 \\cdot 1 \\cdot \\cos^6\\left(\\frac{\\omega}{\\sqrt{3}}\\right) + 1 \\cdot 1 \\cdot \\cos^6\\left(\\frac{\\omega}{\\sqrt{3}}\\right)\n$$\n$$\n\\mathcal{Q}(\\omega) = 4\\cos^6\\left(\\frac{\\omega}{\\sqrt{3}}\\right).\n$$\n\n第三步：混叠误差 $E(\\omega)$。\n混叠误差定义为 $E(\\omega) = \\mathcal{Q}(\\omega) - \\mathcal{R}(\\omega)$。代入前面步骤中推導出的表达式：\n$$\nE(\\omega) = 4\\cos^6\\left(\\frac{\\omega}{\\sqrt{3}}\\right) - \\frac{\\left(9\\sin(\\omega) + \\sin(3\\omega)\\right)^2}{36\\omega^2}.\n$$\n这就是混叠误差作为频率参数 $\\omega$ 函数的最终闭式解析表达式。",
            "answer": "$$\n\\boxed{4\\cos^6\\left(\\frac{\\omega}{\\sqrt{3}}\\right) - \\frac{\\left(9\\sin(\\omega) + \\sin(3\\omega)\\right)^2}{36\\omega^2}}\n$$"
        }
    ]
}