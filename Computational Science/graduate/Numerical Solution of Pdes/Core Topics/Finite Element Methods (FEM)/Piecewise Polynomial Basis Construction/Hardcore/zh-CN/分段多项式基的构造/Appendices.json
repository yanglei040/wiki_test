{
    "hands_on_practices": [
        {
            "introduction": "在有限元方法中，组装刚度矩阵和载荷向量需要计算大量的积分。虽然对于简单的单元和基函数可以进行解析积分，但对于一般情况，高效的数值求积是必不可少的。本练习  将指导你从第一性原理出发，通过推导精确积分给定次数多项式所需的最小点数，来构造最高效的求积法则——高斯求积。掌握这一原理是编写高效、精确有限元代码的基础。",
            "id": "3431678",
            "problem": "考虑一个二阶线性偏微分方程（PDE）的一维有限元离散化，该离散化建立在一个区间网格上，其中每个单元都映射到参考单元 $K=[-1,1]$。在每个单元上，使用次数至多为 $p$ 的分片多项式基，即局部试探/检验空间为 $\\mathbb{P}_{p}(K)$，$K$ 上次数至多为 $p$ 的多项式空间。为了组装需要在 $\\mathbb{P}_{p}(K)$ 中对基函数进行精确积分的单元贡献，您需要构建一个在 $K$ 上的矩匹配求积法则，该法则能精确积分 $\\mathbb{P}_{p}(K)$ 中的每一个多项式，并分析每个单元所需求积点的最小数量。\n\n仅从以下基础出发：\n- 求积法则精确性的定义：一个具有节点 $\\{x_{i}\\}_{i=1}^{n}\\subset K$ 和权重 $\\{w_{i}\\}_{i=1}^{n}$ 的求积法则，如果满足 $\\int_{K} q(x)\\,\\mathrm{d}x=\\sum_{i=1}^{n} w_{i}\\,q(x_{i})$，则称其能精确积分函数 $q$。\n- 矩匹配条件的定义：对 $\\mathbb{P}_{p}(K)$ 中所有多项式都精确，意味着对于每一个 $q\\in\\mathbb{P}_{p}(K)$，求积法则都必须满足上述恒等式。\n- 在 $[-1,1]$ 上关于单位权重存在正交多项式族（即勒让德多项式），这些多项式具有经过充分检验的正交性以及其根为严格位于 $(-1,1)$ 内部的实的、简单的根的性质。\n\n任务：\n1. 建立矩匹配方程以保证对 $\\mathbb{P}_{p}(K)$ 中所有多项式的精确性，并利用正交性质构建一个在 $K$ 上具有 $n$ 个节点和权重的求积法则，使其满足这些方程。确定您所构建法则的精确阶。\n2. 仅利用矩匹配系统的结构和您所构建法则的性质，推导出一个关于 $p$ 的 $n$ 的必要下界，并将其与您构建过程中的存在性结果相结合，以确定精确积分 $\\mathbb{P}_{p}(K)$ 所需的每个单元 $K$ 的最小求积点数。\n3. 以单个闭式解析表达式的形式，给出每个单元所需最小求积点数关于 $p$ 的最终结果。不需要数值舍入，也不涉及单位。\n\n您的最终答案必须是一个单一的解析表达式。",
            "solution": "该问题是有效的。这是一个数值分析领域的适定问题，特别涉及有限元方法所需的数值积分理论。其前提在科学上是合理的，术语也是精确的。\n\n按要求分三部分解答该问题：\n1.  矩匹配方程的建立及适用求积法则的构建。\n2.  求积点数必要下界的推导及最小数量的确定。\n3.  该最小数量的最终表达式。\n\n令 $K = [-1, 1]$ 为参考单元。我们寻求一个具有 $n$ 个节点 $\\{x_i\\}_{i=1}^{n}$ 和权重 $\\{w_i\\}_{i=1}^{n}$ 的求积法则，它对 $\\mathbb{P}_{p}(K)$（次数至多为 $p$ 的多项式空间）中的所有多项式都是精确的。这意味着该法则必须满足\n$$\n\\int_{-1}^{1} q(x) \\, \\mathrm{d}x = \\sum_{i=1}^{n} w_i q(x_i) \\quad \\forall q \\in \\mathbb{P}_{p}(K)\n$$\n\n**1. 求积法则的建立与构建**\n\n为了保证对整个空间 $\\mathbb{P}_{p}(K)$ 的精确性，一个充要条件是保证它对该空间的一个基是精确的。对此，一个方便的基是单项式基 $\\{x^k\\}_{k=0}^{p}$。这导出了一个包含 $p+1$ 个非线性方程的方程组，称为矩匹配方程，用于求解 $2n$ 个未知数（$n$ 个节点 $x_i$ 和 $n$ 个权重 $w_i$）：\n$$\n\\int_{-1}^{1} x^k \\, \\mathrm{d}x = \\sum_{i=1}^{n} w_i x_i^k \\quad \\text{for } k = 0, 1, \\ldots, p\n$$\n\n问题陈述引导我们使用在 $[-1, 1]$ 上的正交多项式的性质，即勒让德多项式，此处记为 $L_k(x)$（次数为 $k$）。这些多项式关于单位权函数是正交的，即 $\\int_{-1}^{1} L_j(x) L_k(x) \\, \\mathrm{d}x = c_k \\delta_{jk}$，其中 $c_k > 0$ 为某个归一化常数。\n\n我们构建一个 $n$ 点求积法则。高斯求积的关键思想是选择节点 $\\{x_i\\}_{i=1}^{n}$ 作为 $n$ 次勒让德多项式 $L_n(x)$ 的 $n$ 个根。根据所给的性质，这些根是实的、互不相同，且严格位于区间 $(-1, 1)$ 内。\n\n固定这 $n$ 个节点后，我们通过要求该法则对次数最高为 $n-1$ 的多项式精确来确定 $n$ 个权重 $\\{w_i\\}_{i=1}^{n}$。这给出了一个关于 $n$ 个权重的 $n$ 元线性方程组：\n$$\n\\sum_{i=1}^{n} w_i x_i^k = \\int_{-1}^{1} x^k \\, \\mathrm{d}x \\quad \\text{for } k = 0, 1, \\ldots, n-1\n$$\n这可以写成矩阵形式 $V \\mathbf{w} = \\mathbf{m}$，其中 $V$ 是范德蒙矩阵，其元素为 $V_{jk} = x_k^j$（$j,k \\in \\{0, \\ldots, n-1\\}$），$\\mathbf{w}$ 是权重向量，$\\mathbf{m}$ 是矩向量 $\\int_{-1}^{1} x^j \\, \\mathrm{d}x$。由于节点 $x_i$（$L_n(x)$ 的根）是互不相同的，范德蒙矩阵是非奇异的，从而保证了权重 $\\{w_i\\}_{i=1}^{n}$ 存在唯一解。\n\n现在，我们来确定这个构建出的法则的精确阶。令 $q(x)$ 为任意一个次数至多为 $2n-1$ 的多项式。我们可以用 $n$ 次勒让德多项式 $L_n(x)$ 对 $q(x)$ 进行多项式除法。这得到：\n$$\nq(x) = s(x) L_n(x) + r(x)\n$$\n其中商 $s(x)$ 和余数 $r(x)$ 是次数至多为 $n-1$ 的多项式。\n\n对 $q(x)$ 在 $K$ 上积分得到：\n$$\n\\int_{-1}^{1} q(x) \\, \\mathrm{d}x = \\int_{-1}^{1} s(x) L_n(x) \\, \\mathrm{d}x + \\int_{-1}^{1} r(x) \\, \\mathrm{d}x\n$$\n勒让德多项式 $L_n(x)$ 与所有次数小于 $n$ 的多项式正交。由于 $\\deg(s) \\le n-1$， $s(x)$ 可以表示为 $\\{L_0(x), \\ldots, L_{n-1}(x)\\}$ 的线性组合。根据正交性质，右边的第一个积分为零：\n$$\n\\int_{-1}^{1} s(x) L_n(x) \\, \\mathrm{d}x = 0\n$$\n因此，我们有 $\\int_{-1}^{1} q(x) \\, \\mathrm{d}x = \\int_{-1}^{1} r(x) \\, \\mathrm{d}x$。\n\n接下来，我们将求积法则应用于 $q(x)$：\n$$\n\\sum_{i=1}^{n} w_i q(x_i) = \\sum_{i=1}^{n} w_i \\left( s(x_i) L_n(x_i) + r(x_i) \\right)\n$$\n根据构造，节点 $x_i$ 是 $L_n(x)$ 的根，所以对所有 $i = 1, \\ldots, n$ 都有 $L_n(x_i) = 0$。该表达式简化为：\n$$\n\\sum_{i=1}^{n} w_i q(x_i) = \\sum_{i=1}^{n} w_i r(x_i)\n$$\n由于 $\\deg(r) \\le n-1$，并且该法则被构造成对 $\\mathbb{P}_{n-1}(K)$ 中的所有多项式都精确，我们有：\n$$\n\\sum_{i=1}^{n} w_i r(x_i) = \\int_{-1}^{1} r(x) \\, \\mathrm{d}x\n$$\n综合我们的发现，我们看到对于任意次数至多为 $2n-1$ 的多项式 $q(x)$：\n$$\n\\int_{-1}^{1} q(x) \\, \\mathrm{d}x = \\int_{-1}^{1} r(x) \\, \\mathrm{d}x = \\sum_{i=1}^{n} w_i r(x_i) = \\sum_{i=1}^{n} w_i q(x_i)\n$$\n这证明了所构建的 $n$ 点法则（即高斯求积法则）具有 $2n-1$ 的精确阶。\n\n**2. 最小求积点数的推导**\n\n首先，我们推导 $n$ 的一个必要下界。问题要求求积法则对 $\\mathbb{P}_p(K)$ 中的所有多项式都精确。这意味着该法则的精确阶必须至少为 $p$。让我们确定任意 $n$ 点法则可能达到的最高精确阶。考虑如下构造的一个 $2n$ 次多项式 $q(x)$：\n$$\nq(x) = \\prod_{i=1}^{n} (x-x_i)^2\n$$\n其中 $\\{x_i\\}_{i=1}^{n}$ 是我们任意一个 $n$ 点法则的节点。$q(x)$ 的次数是 $2n$。由于对于所有 $x \\in [-1, 1]$（除了在节点处），都有 $q(x) > 0$，其在 $K$ 上的积分是严格为正的：\n$$\n\\int_{-1}^{1} q(x) \\, \\mathrm{d}x > 0\n$$\n然而，将求积法则应用于 $q(x)$ 得到：\n$$\n\\sum_{i=1}^{n} w_i q(x_i) = \\sum_{i=1}^{n} w_i \\cdot 0 = 0\n$$\n由于积分值和求积和不相等，没有一个 $n$ 点法则能对这个 $2n$ 次多项式精确。因此，任意 $n$ 点法则可能达到的最高精确阶是 $2n-1$。\n\n为了使我们的求积法则对 $\\mathbb{P}_p(K)$ 中的所有多项式都精确，其精确阶（至多为 $2n-1$）必须大于或等于 $p$：\n$$\n2n - 1 \\ge p\n$$\n这导出了关于点数 $n$ 的一个必要条件：\n$$\nn \\ge \\frac{p+1}{2}\n$$\n由于 $n$ 必须是整数，求积点的数量必须满足：\n$$\nn \\ge \\left\\lceil \\frac{p+1}{2} \\right\\rceil\n$$\n这就确立了 $n$ 的一个必要下界。\n\n从第1部分我们知道，对于任意整数 $n$，我们可以构建一个具有 $n$ 个点的高斯求积法则，其精确阶为 $2n-1$。为了满足问题的要求（在 $\\mathbb{P}_p(K)$ 上精确），我们需要选择 $n$ 使得 $2n-1 \\ge p$。满足此不等式的最小整数 $n$ 正是 $n = \\lceil \\frac{p+1}{2} \\rceil$。\n\n由于这个点数既是必要的（来自下界分析），也是充分的（来自高斯求积的存在性），因此它就是所需的最小求积点数。\n\n**3. 最终表达式**\n\n每个单元上，为精确积分 $\\mathbb{P}_{p}(K)$ 中所有多项式所需的最小求积点数 $n_{min}$，由满足 $n \\ge \\frac{p+1}{2}$ 的最小整数 $n$ 给出。这可以用上取整函数表示。\n最终结果是 $n_{min}$ 关于多项式次数 $p$ 的一个解析表达式。\n$$\nn_{min}(p) = \\left\\lceil \\frac{p+1}{2} \\right\\rceil\n$$\n例如，对于线性单元（$p=1$），我们需要 $n_{min} = \\lceil \\frac{1+1}{2} \\rceil = 1$ 个点。对于二次单元（$p=2$），我们需要 $n_{min} = \\lceil \\frac{2+1}{2} \\rceil = \\lceil 1.5 \\rceil = 2$ 个点。对于三次单元（$p=3$），我们需要 $n_{min} = \\lceil \\frac{3+1}{2} \\rceil = 2$ 个点。这与高斯求积的理论是一致的。",
            "answer": "$$\n\\boxed{\\left\\lceil \\frac{p+1}{2} \\right\\rceil}\n$$"
        },
        {
            "introduction": "一个优秀的数值方法不仅要保证计算精度，还应保持原偏微分方程关键的物理性质，例如扩散过程中的最大值原理。本练习  提供了一个具体实践，让你深入探究这一联系。你将分析单元的几何形状和介质属性（由扩散张量表示）如何影响刚度矩阵的代数性质，并推导为保证离散最大值原理成立所必须满足的条件。",
            "id": "3431719",
            "problem": "考虑平面域中的稳态扩散方程 $-\\nabla \\cdot (A \\nabla u) = f$，在边界 $\\partial \\Omega$ 上具有齐次狄利克雷边界条件。重点关注单单元情形，其中 $\\Omega$ 是顶点为 $(0,0)$、$(2,0)$ 和 $(1,1)$ 的三角形 $T$。设扩散张量为对称正定(SPD)矩阵 $A = \\mathrm{diag}(1,\\eta)$，其中参数 $\\eta > 0$。\n\n使用 $T$ 上的标准分片线性(1次)拉格朗日基，通过显式地确定形函数并证明其在 $T$ 上的非负性，来构造一个保正基。然后，组装 $3 \\times 3$ 单元刚度矩阵 $K$，其元素为 $K_{ij} = \\int_{T} \\nabla \\varphi_i^{\\top} A \\nabla \\varphi_j \\,\\mathrm{d}x$，其中 $\\{\\varphi_i\\}_{i=1}^{3}$ 是与顶点相关的局部形函数。推导使 $K$ 的非对角元素为非正的几何条件，并将其与网格角联系起来，当 $A$ 是各向异性时，还需与 $A$-度量下的锐角性联系起来。\n\n最后，计算参数 $\\eta$ 的上确界，使得在该三角形上，刚度矩阵 $K$ 的所有非对角元素均为非正，从而在所选基下强制满足离散极值原理(DMP)。将您的最终答案精确地表示为单个实数，无需四舍五入。",
            "solution": "该问题要求计算扩散张量 $A$ 中参数 $\\eta$ 的上确界，使得特定三角形 $T$ 的单元刚度矩阵 $K$ 满足离散极值原理的条件，这对应于其非对角元素为非正。\n\n首先，我们验证问题陈述的有效性。在椭圆偏微分方程的有限元方法背景下，该问题是良定义的。所有必要信息均已提供：控制方程、单元几何形状、基函数和扩散张量。概念是科学合理的，目标是明确的。该问题是有效的。\n\n我们从定义问题的具体细节开始。区域是顶点为 $v_1=(0,0)$、$v_2=(2,0)$ 和 $v_3=(1,1)$ 的三角形 $T$。基由与这些顶点相关的分片线性(P1)拉格朗日形函数 $\\{\\varphi_i\\}_{i=1}^3$ 组成。平面上的线性函数形式为 $\\varphi(x,y) = c_1 + c_2x + c_3y$。基函数 $\\varphi_i$ 由条件 $\\varphi_i(v_j) = \\delta_{ij}$ 定义，其中 $\\delta_{ij}$ 是克罗内克δ符号。\n\n我们构造这三个基函数：\n对于对应于 $v_1=(0,0)$ 的 $\\varphi_1(x,y)$：\n$\\varphi_1(0,0) = c_1 = 1$\n$\\varphi_1(2,0) = c_1 + 2c_2 = 0 \\implies 1 + 2c_2 = 0 \\implies c_2 = -1/2$\n$\\varphi_1(1,1) = c_1 + c_2 + c_3 = 0 \\implies 1 - 1/2 + c_3 = 0 \\implies c_3 = -1/2$\n因此，$\\varphi_1(x,y) = 1 - \\frac{1}{2}x - \\frac{1}{2}y$。其梯度为 $\\nabla \\varphi_1 = \\begin{pmatrix} -1/2 \\\\ -1/2 \\end{pmatrix}$。\n\n对于对应于 $v_2=(2,0)$ 的 $\\varphi_2(x,y)$：\n$\\varphi_2(0,0) = c_1 = 0$\n$\\varphi_2(2,0) = c_1 + 2c_2 = 1 \\implies 2c_2 = 1 \\implies c_2 = 1/2$\n$\\varphi_2(1,1) = c_1 + c_2 + c_3 = 0 \\implies 1/2 + c_3 = 0 \\implies c_3 = -1/2$\n因此，$\\varphi_2(x,y) = \\frac{1}{2}x - \\frac{1}{2}y$。其梯度为 $\\nabla \\varphi_2 = \\begin{pmatrix} 1/2 \\\\ -1/2 \\end{pmatrix}$。\n\n对于对应于 $v_3=(1,1)$ 的 $\\varphi_3(x,y)$：\n$\\varphi_3(0,0) = c_1 = 0$\n$\\varphi_3(2,0) = c_1 + 2c_2 = 0 \\implies c_2 = 0$\n$\\varphi_3(1,1) = c_1 + c_2 + c_3 = 1 \\implies c_3 = 1$\n因此，$\\varphi_3(x,y) = y$。其梯度为 $\\nabla \\varphi_3 = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$。\n\n这些函数是三角形 $T$ 的重心坐标。$T$ 内的任意一点 $(x,y) \\in T$ 都是其顶点的凸组合，因此重心坐标是非负的。所以，对于所有 $(x,y) \\in T$，每个 $\\varphi_i(x,y) \\ge 0$，这证明了它们构成了一个保正基。\n\n单元刚度矩阵 $K$ 的元素为 $K_{ij} = \\int_{T} \\nabla \\varphi_i^{\\top} A \\nabla \\varphi_j \\,\\mathrm{d}x$。扩散张量为 $A = \\begin{pmatrix} 1  0 \\\\ 0  \\eta \\end{pmatrix}$。由于 $\\nabla \\varphi_i$ 和 $A$ 在单元 $T$ 上是常数，积分可以简化为 $K_{ij} = (\\nabla \\varphi_i^{\\top} A \\nabla \\varphi_j) |T|$，其中 $|T|$ 是三角形的面积。\n顶点为 $(0,0)$、$(2,0)$ 和 $(1,1)$ 的三角形的面积是 $|T| = \\frac{1}{2} |( (x_2-x_1)(y_3-y_1) - (x_3-x_1)(y_2-y_1) )| = \\frac{1}{2} |( (2)(1) - (1)(0) )| = 1$。\n所以，$K_{ij} = \\nabla \\varphi_i^{\\top} A \\nabla \\varphi_j$。\n\n我们需要找到非对角元素 $K_{ij}$ ($i \\neq j$) 为非正的条件。让我们计算这些元素：\n\n$K_{12} = \\nabla \\varphi_1^{\\top} A \\nabla \\varphi_2 = \\begin{pmatrix} -1/2  -1/2 \\end{pmatrix} \\begin{pmatrix} 1  0 \\\\ 0  \\eta \\end{pmatrix} \\begin{pmatrix} 1/2 \\\\ -1/2 \\end{pmatrix} = \\begin{pmatrix} -1/2  -\\eta/2 \\end{pmatrix} \\begin{pmatrix} 1/2 \\\\ -1/2 \\end{pmatrix} = -\\frac{1}{4} + \\frac{\\eta}{4} = \\frac{\\eta-1}{4}$。\n根据对称性，$K_{21} = K_{12}$。\n\n$K_{13} = \\nabla \\varphi_1^{\\top} A \\nabla \\varphi_3 = \\begin{pmatrix} -1/2  -1/2 \\end{pmatrix} \\begin{pmatrix} 1  0 \\\\ 0  \\eta \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} -1/2  -\\eta/2 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} = -\\frac{\\eta}{2}$。\n根据对称性，$K_{31} = K_{13}$。\n\n$K_{23} = \\nabla \\varphi_2^{\\top} A \\nabla \\varphi_3 = \\begin{pmatrix} 1/2  -1/2 \\end{pmatrix} \\begin{pmatrix} 1  0 \\\\ 0  \\eta \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 1/2  -\\eta/2 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} = -\\frac{\\eta}{2}$。\n根据对称性，$K_{32} = K_{23}$。\n\n对于 $i \\neq j$，$K_{ij} \\le 0$ 的几何条件与网格的角度有关。对于各向同性介质($A=I$)，这对应于要求三角形为非钝角（所有角 $\\le \\pi/2$）。对于各向异性介质，条件是三角形在由扩散张量导出的度量下必须是非钝角的。这等价于要求通过 $v'_i = A^{-1/2}v_i$ 变换顶点后形成的三角形是非钝角的。条件 $\\nabla\\varphi_i^\\top A \\nabla\\varphi_j \\le 0$ 意味着向量 $\\nabla\\varphi_i$ 和 $\\nabla\\varphi_j$ 是 $A$-钝角的。\n\n离散极值原理的条件是所有非对角元素都为非正：\n1. $K_{12} \\le 0 \\implies \\frac{\\eta-1}{4} \\le 0 \\implies \\eta - 1 \\le 0 \\implies \\eta \\le 1$。\n2. $K_{13} \\le 0 \\implies -\\frac{\\eta}{2} \\le 0 \\implies \\eta \\ge 0$。\n3. $K_{23} \\le 0 \\implies -\\frac{\\eta}{2} \\le 0 \\implies \\eta \\ge 0$。\n\n问题陈述中 $\\eta > 0$。因此，对于任何有效的 $\\eta$，第二个和第三个条件都得到满足。唯一的限制性条件是第一个，即 $\\eta \\le 1$。\n将给定条件 $\\eta > 0$ 与我们推导出的条件 $\\eta \\le 1$ 相结合，我们发现满足非对角元素非正要求的所有可能的 $\\eta$ 值集合是区间 $(0, 1]$。\n\n问题要求参数 $\\eta$ 的上确界。集合 $(0, 1]$ 的上确界是其最小上界，即 $1$。",
            "answer": "$$\\boxed{1}$$"
        },
        {
            "introduction": "许多物理和工程问题本身具有对称性，有效利用这些对称性可以极大地简化分析和计算。本练习  聚焦于如何在有限元方法中利用反射对称性。通过构造能够反映奇偶宇称的特殊基函数，你将学习如何将全局线性系统分解为针对奇函数和偶函数分量的独立子块，从而在不损失精度的情况下大幅降低计算成本。",
            "id": "3431733",
            "problem": "考虑一维域 $\\Omega = (-1,1)$ 和由 $(Ru)(x) = u(-x)$ 定义的反射算子 $R$。设 $a(x)$ 和 $c(x)$ 为实值系数函数，满足 $a(x) > 0$，$a(-x) = a(x)$，$c(x) \\ge 0$ 和 $c(-x) = c(x)$，并定义线性微分算子 $\\mathcal{L} u = -\\dfrac{d}{dx}\\!\\left( a(x)\\, \\dfrac{du}{dx} \\right) + c(x)\\, u$。假设 $\\Omega$ 上有一个关于 $x=0$ 精确对称的协调网格，以及在此网格上构建的次数为 $p \\in \\mathbb{N}$ 的连续分片多项式有限元空间 $V_h \\subset H_0^1(\\Omega)$，且所有积分均使用精确求积。\n\n定义双线性形式 $a_h(u,v) = \\int_{-1}^1 \\left( a(x)\\, u'(x)\\, v'(x) + c(x)\\, u(x)\\, v(x) \\right)\\, dx$ 和线性泛函 $\\ell_f(v) = \\int_{-1}^1 f(x)\\, v(x)\\, dx$，其中 $f \\in L^2(\\Omega)$。\n\n令 $V_h^{\\mathrm{even}} = \\{ v_h \\in V_h \\,:\\, v_h \\circ R = v_h \\}$ 和 $V_h^{\\mathrm{odd}} = \\{ v_h \\in V_h \\,:\\, v_h \\circ R = -v_h \\}$ 分别表示 $V_h$ 的偶函数子空间和奇函数子空间。在对称网格上，对于支撑在一对镜像单元 $K$ 和 $R K$ 上的每一对基函数 $\\varphi_i^{+}$ 和 $\\varphi_i^{-}$（其中 $\\varphi_i^{-} = \\varphi_i^{+} \\circ R$），考虑宇称适配组合 $\\psi_i^{\\mathrm{even}} = \\dfrac{1}{\\sqrt{2}}\\left( \\varphi_i^{+} + \\varphi_i^{-} \\right)$ 和 $\\psi_i^{\\mathrm{odd}} = \\dfrac{1}{\\sqrt{2}}\\left( \\varphi_i^{+} - \\varphi_i^{-} \\right)$。在 $x=0$ 附近，根据连续性要求调整构造，使得 $V_h$ 的一组基可以划分为 $V_h^{\\mathrm{even}}$ 的一组基和 $V_h^{\\mathrm{odd}}$ 的一组基。\n\n您将评估关于在以下两个问题中利用宇称不变性的陈述：\n\n（椭圆问题）求 $u_h \\in V_h$ 使得对于所有 $v_h \\in V_h$都有 $a_h(u_h, v_h) = \\ell_f(v_h)$。\n\n（带诺伊曼边界条件的抛物线问题）定义 $\\mathcal{L}_0 u = -\\dfrac{d}{dx}\\!\\left( a(x)\\, \\dfrac{du}{dx} \\right)$ 并考虑在 $\\Omega$ 上的方程 $u_t + \\mathcal{L}_0 u = 0$，其齐次诺伊曼边界条件为 $a(x)\\, u_x(\\pm 1,t) = 0$。该问题通过伽辽金方法在建立于同一对称网格上的连续分片多项式空间 $W_h \\subset H^1(\\Omega)$ 中进行半离散化，并使用一致质量矩阵。假设 $a(x)$ 如上所述且不依赖于 $t$。\n\n在所述假设下，下列哪些陈述是正确的？\n\nA. 在椭圆问题中，当 $f$ 为偶函数时，在 $V_h^{\\mathrm{even}}$ 中进行组装和求解，与在 $V_h$ 中组装然后投影到 $V_h^{\\mathrm{even}}$ 上得到的有限元解相同，同时将全局自由度数量减少约2倍（不计 $x=0$ 节点带来的 $O(1)$ 修正）。在宇称适配基中，刚度矩阵和载荷矩阵关于偶/奇分裂是块对角的。\n\nB. 在椭圆问题中，当 $f$ 为偶函数时，如果在奇函数子空间 $V_h^{\\mathrm{odd}}$ 中组装和求解，唯一的伽辽金解是 $u_h \\equiv 0$。\n\nC. 对于对称网格、精确求积和偶系数的椭圆问题，宇称适配的局部构造 $\\psi_i^{\\mathrm{even}}$ 和 $\\psi_i^{\\mathrm{odd}}$ 产生的全局质量矩阵和刚度矩阵能精确地将偶函数子空间和奇函数子空间解耦，即非对角线上的偶-奇耦合块恒为零。\n\nD. 对于抛物线诺伊曼问题，若初始数据 $u_h(\\cdot,0) \\in W_h^{\\mathrm{odd}}$ 且使用一致质量矩阵，则半离散解 $u_h(\\cdot,t)$ 对所有 $t \\ge 0$ 都保持在 $W_h^{\\mathrm{odd}}$ 中，并且其离散总质量 $\\int_{-1}^1 u_h(x,t)\\, dx$ 对所有 $t \\ge 0$ 都精确为零，这与应用于该半离散系统的时间积分方法的具体选择无关。\n\nE. 在一个使用中心数值通量的对称内部罚分间断伽辽金（SIPG）离散化中，即使系数是偶函数且求积是精确的，在全域和相同的对称网格上，偶/奇解耦也会在对称平面 $x=0$ 处被通量耦合所破坏，因此在不损失精度的情况下，无法通过宇称性来减少自由度。\n\nF. 在椭圆问题中，当 $f$ 为奇函数时，在全域上仅使用偶函数子空间 $V_h^{\\mathrm{even}}$ 所得的解，与将问题限制在半域 $[0,1]$ 上、在 $x=0$ 处施加齐次狄利克雷条件然后进行反对称延拓所得的解相同。\n\n选择所有正确的选项。",
            "solution": "问题陈述已经过验证，被认为是适定的、科学上合理的且内部一致的。它描述了对称性原理在二阶边值问题的有限元方法中的一个标准应用。我们可以开始求解。\n\n分析的基础原理是将函数空间 $V_h$ 分解为偶函数和奇函数子空间，$V_h = V_h^{\\mathrm{even}} \\oplus V_h^{\\mathrm{odd}}$，以及双线性形式和线性泛函在这种分解下的行为。\n\n设 $v_e \\in V_h^{\\mathrm{even}}$ 和 $v_o \\in V_h^{\\mathrm{odd}}$。根据定义，$v_e(-x) = v_e(x)$ 且 $v_o(-x) = -v_o(x)$。偶函数的导数是奇函数，奇函数的导数是偶函数。因此，$v_e'(x)$ 是奇函数，$v_o'(x)$ 是偶函数。\n\n双线性形式为 $a_h(u,v) = \\int_{-1}^1 \\left( a(x)\\, u'(x)\\, v'(x) + c(x)\\, u(x)\\, v(x) \\right)\\, dx$。已知系数 $a(x)$ 和 $c(x)$ 是偶函数。我们来计算 $a_h(v_e, v_o)$。被积函数为 $I(x) = a(x) v_e'(x) v_o'(x) + c(x) v_e(x) v_o(x)$。\n- 项 $v_e(x) v_o(x)$ 是一个偶函数和一个奇函数的乘积，结果是奇函数。由于 $c(x)$ 是偶函数，乘积 $c(x) v_e(x) v_o(x)$ 是奇函数。\n- 项 $v_e'(x) v_o'(x)$ 是一个奇函数和一个偶函数的乘积，结果是奇函数。由于 $a(x)$ 是偶函数，乘积 $a(x) v_e'(x) v_o'(x)$ 是奇函数。\n- 两个奇函数的和是奇函数，因此被积函数 $I(x)$ 是一个奇函数。\n- 任何奇函数在对称区间 $[-1,1]$ 上的积分恒为零。\n因此，我们得到了关键的正交性：\n$$a_h(v_e, v_o) = 0 \\quad \\forall v_e \\in V_h^{\\mathrm{even}}, \\forall v_o \\in V_h^{\\mathrm{odd}}$$\n这意味着偶函数子空间和奇函数子空间关于由 $a_h(\\cdot, \\cdot)$ 定义的能量内积是正交的。\n\n类似地，对于线性泛函 $\\ell_f(v) = \\int_{-1}^1 f(x) v(x) dx$：\n- 如果 $f(x)$ 是偶函数且 $v_o(x) \\in V_h^{\\mathrm{odd}}$，则被积函数 $f(x) v_o(x)$ 是奇函数，所以 $\\ell_f(v_o) = 0$。\n- 如果 $f(x)$ 是奇函数且 $v_e(x) \\in V_h^{\\mathrm{even}}$，则被积函数 $f(x) v_e(x)$ 是奇函数，所以 $\\ell_f(v_e) = 0$。\n\n现在我们分析离散问题：求 $u_h \\in V_h$ 使得对于所有 $v_h \\in V_h$ 都有 $a_h(u_h, v_h) = \\ell_f(v_h)$。我们可以将解唯一地分解为 $u_h = u_h^{\\mathrm{even}} + u_h^{\\mathrm{odd}}$，其中 $u_h^{\\mathrm{even}} \\in V_h^{\\mathrm{even}}$ 且 $u_h^{\\mathrm{odd}} \\in V_h^{\\mathrm{odd}}$。通过分别从偶函数和奇函数子空间中选取测试函数，原问题解耦为两个独立的子问题：\n1. 求 $u_h^{\\mathrm{even}} \\in V_h^{\\mathrm{even}}$ 使得对于所有 $v_e \\in V_h^{\\mathrm{even}}$ 都有 $a_h(u_h^{\\mathrm{even}}, v_e) = \\ell_f(v_e)$。\n2. 求 $u_h^{\\mathrm{odd}} \\in V_h^{\\mathrm{odd}}$ 使得对于所有 $v_o \\in V_h^{\\mathrm{odd}}$ 都有 $a_h(u_h^{\\mathrm{odd}}, v_o) = \\ell_f(v_o)$。\n\n我们现在基于这个框架来评估每个陈述。\n\n**A. 在椭圆问题中，当 $f$ 为偶函数时，在 $V_h^{\\mathrm{even}}$ 中进行组装和求解，与在 $V_h$ 中组装然后投影到 $V_h^{\\mathrm{even}}$ 上得到的有限元解相同，同时将全局自由度数量减少约2倍（不计 $x=0$ 节点带来的 $O(1)$ 修正）。在宇称适配基中，刚度矩阵和载荷矩阵关于偶/奇分裂是块对角的。**\n\n如果 $f$ 是偶函数，则对于所有 $v_o \\in V_h^{\\mathrm{odd}}$，有 $\\ell_f(v_o) = 0$。第二个子问题变为：求 $u_h^{\\mathrm{odd}} \\in V_h^{\\mathrm{odd}}$ 使得对于所有 $v_o \\in V_h^{\\mathrm{odd}}$ 都有 $a_h(u_h^{\\mathrm{odd}}, v_o) = 0$。选择 $v_o = u_h^{\\mathrm{odd}}$，我们得到 $a_h(u_h^{\\mathrm{odd}}, u_h^{\\mathrm{odd}}) = 0$。双线性形式 $a_h(\\cdot, \\cdot)$ 在 $V_h \\subset H_0^1(\\Omega)$ 上是强制的（coercive），即存在 $C > 0$ 使得 $a_h(v,v) \\ge C\\|v\\|_{H^1}^2$。因此，$a_h(u_h^{\\mathrm{odd}}, u_h^{\\mathrm{odd}}) = 0$ 意味着 $u_h^{\\mathrm{odd}} = 0$。\n因此，完整解为 $u_h = u_h^{\\mathrm{even}}$，它通过在 $V_h^{\\mathrm{even}}$ 中求解第一个子问题得到。这正是“在 $V_h^{\\mathrm{even}}$ 中组装和求解”的含义。由于完整解 $u_h$ 已经位于 $V_h^{\\mathrm{even}}$ 中，将其投影到 $V_h^{\\mathrm{even}}$ 上不会改变任何东西。$V_h^{\\mathrm{even}}$ 的维数大约是 $V_h$ 的一半，这证实了自由度的减少。 “宇称适配基”将基函数划分为偶函数和奇函数。由于正交性 $a_h(v_e, v_o)=0$，在此基中组装的刚度矩阵将是块对角的 $\\begin{pmatrix} K_{ee}  0 \\\\ 0  K_{oo} \\end{pmatrix}$。载荷向量 $b_i = \\ell_f(\\psi_i)$ 对于所有奇基函数 $\\psi_i$ 的分量都为零，从而得到块结构 $\\begin{pmatrix} b_e \\\\ 0 \\end{pmatrix}$。这对应于一个块对角系统。\n\n**结论：正确。**\n\n**B. 在椭圆问题中，当 $f$ 为偶函数时，如果在奇函数子空间 $V_h^{\\mathrm{odd}}$ 中组装和求解，唯一的伽辽金解是 $u_h \\equiv 0$。**\n\n这指的是求解上面描述的第二个子问题：求 $u_h^{\\mathrm{odd}} \\in V_h^{\\mathrm{odd}}$ 使得对于所有 $v_o \\in V_h^{\\mathrm{odd}}$ 都有 $a_h(u_h^{\\mathrm{odd}}, v_o) = \\ell_f(v_o)$。如在选项 A 的分析中所述，当 $f$ 是偶函数时，右端项 $\\ell_f(v_o)$ 对于所有 $v_o \\in V_h^{\\mathrm{odd}}$ 都为零。问题简化为 $a_h(u_h^{\\mathrm{odd}}, v_o) = 0$。根据 $a_h(\\cdot, \\cdot)$ 的强制性，唯一的解是 $u_h^{\\mathrm{odd}} = 0$。\n\n**结论：正确。**\n\n**C. 对于对称网格、精确求积和偶系数的椭圆问题，宇称适配的局部构造 $\\psi_i^{\\mathrm{even}}$ 和 $\\psi_i^{\\mathrm{odd}}$ 产生的全局质量矩阵和刚度矩阵能精确地将偶函数子空间和奇函数子空间解耦，即非对角线上的偶-奇耦合块恒为零。**\n\n该陈述形式化了矩阵结构。一个宇称适配基的形式为 $\\{\\psi_i^{\\mathrm{even}}\\} \\cup \\{\\psi_j^{\\mathrm{odd}}\\}$。偶基函数 $\\psi_i^{\\mathrm{even}}$ 和奇基函数 $\\psi_j^{\\mathrm{odd}}$ 之间的刚度矩阵项是 $K_{ij} = a_h(\\psi_i^{\\mathrm{even}}, \\psi_j^{\\mathrm{odd}})$。正如我们最初分析所证明的，该值为零。质量矩阵项是 $M_{ij} = \\int_{-1}^1 \\psi_i^{\\mathrm{even}}(x) \\psi_j^{\\mathrm{odd}}(x) dx$。被积函数是奇函数，因此其在 $[-1,1]$ 上的积分为零。因此，对于刚度矩阵和质量矩阵，任何耦合偶基函数和奇基函数的矩阵项都为零。这意味着这些矩阵关于偶/奇划分是块对角的。精确求积对于确保这些积分精确计算为零至关重要。\n\n**结论：正确。**\n\n**D. 对于抛物线诺伊曼问题，若初始数据 $u_h(\\cdot,0) \\in W_h^{\\mathrm{odd}}$ 且使用一致质量矩阵，则半离散解 $u_h(\\cdot,t)$ 对所有 $t \\ge 0$ 都保持在 $W_h^{\\mathrm{odd}}$ 中，并且其离散总质量 $\\int_{-1}^1 u_h(x,t)\\, dx$ 对所有 $t \\ge 0$ 都精确为零，这与应用于该半离散系统的时间积分方法的具体选择无关。**\n\n半离散系统为 $M \\frac{d\\mathbf{u}}{dt} + K_0 \\mathbf{u} = 0$，其中 $M_{ij} = \\int_{-1}^1 \\psi_i \\psi_j dx$ 且 $(K_0)_{ij} = \\int_{-1}^1 a(x) \\psi_i' \\psi_j' dx$。正如在 C 中所确定的，在宇称适配基中，这两个矩阵都是块对角的。该系统解耦为两个独立的常微分方程（ODE）系统，分别对应偶系数 $\\mathbf{u}_e$ 和奇系数 $\\mathbf{u}_o$：\n$M_{ee} \\frac{d\\mathbf{u}_e}{dt} + K_{ee} \\mathbf{u}_e = 0$\n$M_{oo} \\frac{d\\mathbf{u}_o}{dt} + K_{oo} \\mathbf{u}_o = 0$\n初始条件是 $u_h(\\cdot,0) \\in W_h^{\\mathrm{odd}}$，这意味着 $\\mathbf{u}_e(0) = 0$。第一个 ODE 是一个具有零初始条件的齐次线性系统。其唯一解是 $\\mathbf{u}_e(t) = 0$ 对所有 $t \\ge 0$ 成立。这意味着解 $u_h(\\cdot,t)$ 没有偶分量，并且在所有时间内都保持在 $W_h^{\\mathrm{odd}}$ 中。这个结论只取决于半离散系统的结构，而与如何进行时间积分无关。\n总质量是积分 $\\int_{-1}^1 u_h(x,t) dx$。由于我们已经证明 $u_h(x,t)$ 对所有 $t \\ge 0$ 都是奇函数，其在对称区间 $[-1,1]$ 上的积分对所有 $t \\ge 0$ 都恒为零。\n\n**结论：正确。**\n\n**E. 在一个使用中心数值通量的对称内部罚分间断伽辽金（SIPG）离散化中，即使系数是偶函数且求积是精确的，在全域和相同的对称网格上，偶/奇解耦也会在对称平面 $x=0$ 处被通量耦合所破坏，因此在不损失精度的情况下，无法通过宇称性来减少自由度。**\n\nSIPG 双线性形式包含面积分。我们来分析在耦合偶函数 $u \\in V_h^{\\mathrm{even}}$ 和奇函数 $v \\in V_h^{\\mathrm{odd}}$ 时，来自 $x=0$ 处单元面的贡献。在 $x=0$ 处：\n- 偶函数的跳跃为 $[u](0) = u(0^+) - u(0^-) = 0$。\n- 偶函数通量的平均值为 $\\{a u'\\}(0) = \\frac{1}{2}( a(0^+)u'(0^+) + a(0^-)u'(0^-) )$。由于 $a$ 是偶函数，$u'$ 是奇函数，此式等于 $\\frac{1}{2}( a(0)u'(0^+) + a(0)(-u'(0^+)) ) = 0$。\nSIPG 的面积分项形式为 $\\{a u'\\} [v]$、$[u] \\{a v'\\}$ 和 $\\frac{\\eta}{h}[u][v]$。在 $x=0$ 的面上，对于函数对 $(u,v)$，这些项变为：\n- $\\{a u'\\}(0) [v](0) = 0 \\cdot [v](0) = 0$。\n- $[u](0) \\{a v'\\}(0) = 0 \\cdot \\{a v'\\}(0) = 0$。\n- $\\frac{\\eta}{h}[u](0) [v](0) = \\frac{\\eta}{h} \\cdot 0 \\cdot [v](0) = 0$。\n在中心面上的所有耦合项都为零。如前所述，标准的体积分项也导致零耦合。因此，在标准的 SIPG 方法中，偶/奇解耦被完美地保留了。该陈述实际上是不正确的。\n\n**结论：不正确。**\n\n**F. 在椭圆问题中，当 $f$ 为奇函数时，在全域上仅使用偶函数子空间 $V_h^{\\mathrm{even}}$ 所得的解，与将问题限制在半域 $[0,1]$ 上、在 $x=0$ 处施加齐次狄利克雷条件然后进行反对称延拓所得的解相同。**\n\n如果 $f$ 是一个奇函数，那么对于任何 $v_e \\in V_h^{\\mathrm{even}}$，右端项为 $\\ell_f(v_e) = \\int_{-1}^1 f(x)v_e(x) dx = 0$。解的偶分量部分所面临的问题是：求 $u_h^{\\mathrm{even}} \\in V_h^{\\mathrm{even}}$ 使得对于所有 $v_e \\in V_h^{\\mathrm{even}}$ 都有 $a_h(u_h^{\\mathrm{even}}, v_e) = 0$。根据强制性，唯一的解是 $u_h^{\\mathrm{even}}=0$。所以，“仅使用偶函数子空间”这一过程产生的是零函数。\n该问题的真正解是纯奇函数 $u_h = u_h^{\\mathrm{odd}}$，通过求解 $a_h(u_h^{\\mathrm{odd}}, v_o) = \\ell_f(v_o)$（对所有 $v_o \\in V_h^{\\mathrm{odd}}$）得到。一个连续的奇函数在 $x=0$ 处必须为零。在半域 $[0,1]$ 上求解、在 $x=0$ 处施加齐次狄利克雷条件并进行反对称延拓，是计算这个奇函数解 $u_h^{\\mathrm{odd}}$ 的标准正确方法。除非 $f$ 恒为零，否则该解将是非零的。\n该陈述断言零函数（来自第一个过程）等于非零的奇函数解（来自第二个过程）。这是错误的。\n\n**结论：不正确。**",
            "answer": "$$\\boxed{ABCD}$$"
        }
    ]
}