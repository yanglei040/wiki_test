{
    "hands_on_practices": [
        {
            "introduction": "在有限元分析中，我们将复杂的物理区域分解为简单的标准形状（如正方形或三角形），这些标准形状被称为“参考单元”。该方法的核心在于建立从这些简单参考单元到实际网格单元的数学映射。本练习将引导你完成为四边形单元构建这种“等参”映射的基础过程，并计算其雅可比行列式。理解这个过程至关重要，因为雅可比行列式是将在物理单元上的积分转换为在参考单元上进行计算的关键。",
            "id": "3419691",
            "problem": "考虑用于在四边形网格上求解偏微分方程的二维有限元法（FEM）。设参考单元为具有局部坐标 $(\\xi,\\eta)$ 的正方形 $\\hat{Q}=[-1,1]^2$，物理单元 $Q$ 为一个凸四边形，其顶点按逆时针顺序排列，并分别与参考节点 $(\\xi,\\eta)=(-1,-1),(1,-1),(1,1),(-1,1)$ 相关联。四个角节点的物理坐标指定如下：\n$$\n(x_1,y_1)=(0,0),\\quad (x_2,y_2)=(2,0),\\quad (x_3,y_3)=(3,1.5),\\quad (x_4,y_4)=(1,1.5).\n$$\n从 $[-1,1]$ 上的一维线性拉格朗日基的基准定义及其在 $\\hat{Q}$ 上的张量积构造出发，使用节点形函数推导从 $\\hat{Q}$ 到 $Q$ 的等参双线性映射 $(x(\\xi,\\eta),y(\\xi,\\eta))$。然后计算雅可比行列式\n$$\nJ(\\xi,\\eta)=\\det\\left(\\begin{pmatrix}\\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\eta}\\end{pmatrix}\\right)\n$$\n对于指定的角坐标。将最终结果表示为 $J(\\xi,\\eta)$ 的单个简化解析表达式。",
            "solution": "该问题是有效的，因为它科学地基于有限元法的原理，具有充分且一致的数据，问题定义良好，并且以客观、正式的语言表述。我们可以进行推导。\n\n目标是计算从参考正方形单元 $\\hat{Q}=[-1,1]^2$ 到物理四边形单元 $Q$ 的等参映射的雅可比行列式 $J(\\xi, \\eta)$。该映射是使用双线性形函数构建的。\n\n首先，我们在区间 $[-1,1]$ 上定义一维线性拉格朗日基函数。设局部坐标为 $z$。两个节点位于 $z=-1$ 和 $z=1$。基函数 $L_1(z)$ 在 $z=-1$ 处为 $1$，在 $z=1$ 处为 $0$；而 $L_2(z)$ 在 $z=-1$ 处为 $0$，在 $z=1$ 处为 $1$。它们的表达式是：\n$$\nL_1(z) = \\frac{1}{2}(1-z) \\quad \\text{and} \\quad L_2(z) = \\frac{1}{2}(1+z)\n$$\n\n接下来，我们通过对一维基函数进行张量积，为参考正方形 $\\hat{Q}$ 的四个节点构造二维双线性形函数 $N_i(\\xi, \\eta)$。节点按逆时针顺序排列：\n节点 $1$：$(\\xi_1, \\eta_1) = (-1,-1)$\n节点 $2$：$(\\xi_2, \\eta_2) = (1,-1)$\n节点 $3$：$(\\xi_3, \\eta_3) = (1,1)$\n节点 $4$：$(\\xi_4, \\eta_4) = (-1,1)$\n\n形函数为：\n$$\nN_1(\\xi, \\eta) = L_1(\\xi) L_1(\\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta)\n$$\n$$\nN_2(\\xi, \\eta) = L_2(\\xi) L_1(\\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta)\n$$\n$$\nN_3(\\xi, \\eta) = L_2(\\xi) L_2(\\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta)\n$$\n$$\nN_4(\\xi, \\eta) = L_1(\\xi) L_2(\\eta) = \\frac{1}{4}(1-\\xi)(1+\\eta)\n$$\n\n等参映射使用这些形函数和单元顶点 $(x_i, y_i)$ 的物理坐标，将物理坐标 $(x,y)$ 与参考坐标 $(\\xi,\\eta)$ 联系起来。该映射定义为：\n$$\nx(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) x_i\n$$\n$$\ny(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) y_i\n$$\n给定的物理坐标是：\n$(x_1, y_1) = (0,0)$、$(x_2, y_2) = (2,0)$、$(x_3, y_3) = (3, 1.5)$、$(x_4, y_4) = (1, 1.5)$。为保持精度，我们使用 $1.5 = \\frac{3}{2}$。\n\n我们将坐标和形函数代入映射方程。对于 $x$ 坐标：\n$$\nx(\\xi, \\eta) = N_1(0) + N_2(2) + N_3(3) + N_4(1)\n$$\n$$\nx(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta)(2) + \\frac{1}{4}(1+\\xi)(1+\\eta)(3) + \\frac{1}{4}(1-\\xi)(1+\\eta)(1)\n$$\n展开并按 $\\xi$、$\\eta$ 和 $\\xi\\eta$ 的幂次合并同类项：\n$$\n4x(\\xi, \\eta) = 2(1+\\xi-\\eta-\\xi\\eta) + 3(1+\\xi+\\eta+\\xi\\eta) + (1-\\xi+\\eta-\\xi\\eta)\n$$\n$$\n4x(\\xi, \\eta) = (2+3+1) + (2\\xi+3\\xi-\\xi) + (-2\\eta+3\\eta+\\eta) + (-2\\xi\\eta+3\\xi\\eta-\\xi\\eta)\n$$\n$$\n4x(\\xi, \\eta) = 6 + 4\\xi + 2\\eta + 0\\xi\\eta\n$$\n$$\nx(\\xi, \\eta) = \\frac{3}{2} + \\xi + \\frac{1}{2}\\eta\n$$\n对于 $y$ 坐标：\n$$\ny(\\xi, \\eta) = N_1(0) + N_2(0) + N_3\\left(\\frac{3}{2}\\right) + N_4\\left(\\frac{3}{2}\\right)\n$$\n$$\ny(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta)\\left(\\frac{3}{2}\\right) + \\frac{1}{4}(1-\\xi)(1+\\eta)\\left(\\frac{3}{2}\\right)\n$$\n提取公因式：\n$$\ny(\\xi, \\eta) = \\frac{3}{8}(1+\\eta) \\left[ (1+\\xi) + (1-\\xi) \\right]\n$$\n$$\ny(\\xi, \\eta) = \\frac{3}{8}(1+\\eta)(2) = \\frac{3}{4}(1+\\eta)\n$$\n$$\ny(\\xi, \\eta) = \\frac{3}{4} + \\frac{3}{4}\\eta\n$$\n该映射是仿射映射，这是当物理单元是平行四边形时出现的一种特殊的双线性映射。\n\n现在，我们计算雅可比矩阵 $\\mathbf{J}$ 的分量：\n$$\n\\mathbf{J}(\\xi, \\eta) = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix}\n$$\n偏导数是：\n$$\n\\frac{\\partial x}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi} \\left( \\frac{3}{2} + \\xi + \\frac{1}{2}\\eta \\right) = 1\n$$\n$$\n\\frac{\\partial x}{\\partial \\eta} = \\frac{\\partial}{\\partial \\eta} \\left( \\frac{3}{2} + \\xi + \\frac{1}{2}\\eta \\right) = \\frac{1}{2}\n$$\n$$\n\\frac{\\partial y}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi} \\left( \\frac{3}{4} + \\frac{3}{4}\\eta \\right) = 0\n$$\n$$\n\\frac{\\partial y}{\\partial \\eta} = \\frac{\\partial}{\\partial \\eta} \\left( \\frac{3}{4} + \\frac{3}{4}\\eta \\right) = \\frac{3}{4}\n$$\n该单元的雅可比矩阵是常数：\n$$\n\\mathbf{J}(\\xi, \\eta) = \\begin{pmatrix} 1  \\frac{1}{2} \\\\ 0  \\frac{3}{4} \\end{pmatrix}\n$$\n最后，雅可比行列式 $J(\\xi, \\eta)$ 是该矩阵的行列式：\n$$\nJ(\\xi, \\eta) = \\det(\\mathbf{J}) = (1)\\left(\\frac{3}{4}\\right) - \\left(\\frac{1}{2}\\right)(0) = \\frac{3}{4}\n$$\n雅可比行列式是一个常数值，与 $(\\xi,\\eta)$ 无关，这证实了该映射是仿射的，并且物理单元是一个平行四边形。该值表示物理单元面积与参考单元面积之比。具体来说，$\\text{Area}(Q) = \\int_{\\hat{Q}} J(\\xi, \\eta) d\\xi d\\eta = \\frac{3}{4} \\times \\text{Area}(\\hat{Q}) = \\frac{3}{4} \\times 4 = 3$。",
            "answer": "$$\\boxed{\\frac{3}{4}}$$"
        },
        {
            "introduction": "能够创建单元映射只是第一步；我们还必须评估该单元的“质量”，因为形状严重扭曲的单元会严重影响数值解的准确性和稳定性。这个实践练习将带你深入探讨单元质量评估，通过为一个三维四面体单元计算几个关键的质量指标。你将学习如何量化单元的几何属性，如长宽比和最小内角，并将其与雅可比矩阵的条件数等更抽象的数学度量联系起来，这些都是衡量有限元模型可靠性的重要标准。",
            "id": "3419698",
            "problem": "考虑一个用于求解偏微分方程 (PDE) 数值解的单个线性四面体有限元。参考四面体 $\\hat{K}$ 的顶点为 $\\hat{\\boldsymbol{x}}_{1}=(0,0,0)$、$\\hat{\\boldsymbol{x}}_{2}=(1,0,0)$、$\\hat{\\boldsymbol{x}}_{3}=(0,1,0)$ 和 $\\hat{\\boldsymbol{x}}_{4}=(0,0,1)$。物理四面体 $K$ 的顶点为 $\\boldsymbol{x}_{1}=(0,0,0)$、$\\boldsymbol{x}_{2}=(2,0,0)$、$\\boldsymbol{x}_{3}=(0,1,0)$ 和 $\\boldsymbol{x}_{4}=(0,0,0.5)$。\n\n单元映射 $F_{K}:\\hat{K}\\rightarrow K$ 是仿射的，其变形梯度 $DF_{K}$ 在 $K$ 上是常数。通篇使用算子 2-范数（谱范数）。\n\n任务：\n1. 从第一性原理推导 $DF_{K}$ 并计算条件数 $\\kappa(DF_{K})=\\|DF_{K}\\|\\,\\|DF_{K}^{-1}\\|$。\n2. 计算单元的长宽比，定义为 $K$ 的六条边中最长边长与最短边长之比。\n3. 计算 $K$ 的所有三角形面中的最小内角（角度以度为单位），并评估该单元是否同时满足以下两个指定的质量阈值：\n   - 最小面角阈值：$20^\\circ$。\n   - 条件数阈值：$4.1$。\n清楚地说明单元是否通过每个阈值。\n\n答案规范：\n- 最终答案必须是 $\\kappa(DF_{K})$ 的单个数值。\n- 将最终的 $\\kappa(DF_{K})$ 四舍五入到四位有效数字。\n- 条件数是无量纲的；最终答案中不要包含任何单位。\n- 所有角度必须以度表示。",
            "solution": "在尝试求解之前，对问题进行验证。\n\n### 步骤 1：提取已知条件\n- **单元类型**：单个线性四面体有限元。\n- **参考四面体 $\\hat{K}$ 的顶点**：$\\hat{\\boldsymbol{x}}_{1}=(0,0,0)$、$\\hat{\\boldsymbol{x}}_{2}=(1,0,0)$、$\\hat{\\boldsymbol{x}}_{3}=(0,1,0)$、$\\hat{\\boldsymbol{x}}_{4}=(0,0,1)$。\n- **物理四面体 $K$ 的顶点**：$\\boldsymbol{x}_{1}=(0,0,0)$、$\\boldsymbol{x}_{2}=(2,0,0)$、$\\boldsymbol{x}_{3}=(0,1,0)$、$\\boldsymbol{x}_{4}=(0,0,0.5)$。\n- **映射**：单元映射 $F_{K}:\\hat{K}\\rightarrow K$ 是仿射的。\n- **变形梯度**：$DF_{K}$ 在 $K$ 上是常数。\n- **范数**：使用算子 2-范数（谱范数）。\n- **任务**：\n  1. 推导 $DF_{K}$ 并计算条件数 $\\kappa(DF_{K})=\\|DF_{K}\\|\\,\\|DF_{K}^{-1}\\|$。\n  2. 计算单元的长宽比（最长边 / 最短边）。\n  3. 计算 $K$ 的所有三角形面中的最小内角（以度为单位）。\n  4. 评估单元是否满足质量阈值：最小面角 $> 20^\\circ$ 且条件数 $ 4.1$。\n- **答案规范**：\n  - 最终答案是 $\\kappa(DF_{K})$ 的数值。\n  - 四舍五入到四位有效数字。\n\n### 步骤 2：使用提取的已知条件进行验证\n问题陈述在科学上基于有限元法（FEM）的理论，特别是关于线性四面体单元的单元质量度量。所有术语，如“仿射映射”、“变形梯度”、“条件数”、“长宽比”和“最小内角”，都是数值分析和计算力学中的标准、定义明确的概念。所提供的数据（顶点坐标）是完整且自洽的。该问题是适定的、客观的，并且存在唯一的、可验证的解。它没有违反任何无效性标准。\n\n### 步骤 3：结论与行动\n问题被判定为**有效**。将提供完整解答。\n\n### 解答推导\n\n分析按顺序处理三个指定的任务。\n\n**1. 变形梯度和条件数**\n\n从参考单元坐标 $\\hat{\\boldsymbol{x}} \\in \\hat{K}$ 到物理单元坐标 $\\boldsymbol{x} \\in K$ 的仿射映射 $F_{K}$ 具有以下形式：\n$$ \\boldsymbol{x} = F_K(\\hat{\\boldsymbol{x}}) = \\boldsymbol{B} \\hat{\\boldsymbol{x}} + \\boldsymbol{b} $$\n其中 $\\boldsymbol{B}$ 是一个常数 $3 \\times 3$ 矩阵，$\\boldsymbol{b}$ 是一个常数平移向量。变形梯度 $DF_{K}$ 是此映射的雅可比矩阵，即矩阵 $\\boldsymbol{B}$。\n$$ DF_K = \\frac{\\partial \\boldsymbol{x}}{\\partial \\hat{\\boldsymbol{x}}} = \\boldsymbol{B} $$\n为了确定 $\\boldsymbol{B}$ 和 $\\boldsymbol{b}$，我们使用顶点的映射关系。对于第一个顶点，$\\hat{\\boldsymbol{x}}_{1} = (0,0,0)^T$ 映射到 $\\boldsymbol{x}_{1} = (0,0,0)^T$。\n$$ \\boldsymbol{x}_1 = \\boldsymbol{B} \\hat{\\boldsymbol{x}}_1 + \\boldsymbol{b} \\implies (0,0,0)^T = \\boldsymbol{B} (0,0,0)^T + \\boldsymbol{b} \\implies \\boldsymbol{b} = \\boldsymbol{0} $$\n该映射是纯线性的：$\\boldsymbol{x} = \\boldsymbol{B} \\hat{\\boldsymbol{x}}$。从 $\\boldsymbol{x}_1$ 出发的物理单元的边向量可以用映射和从 $\\hat{\\boldsymbol{x}}_1$ 出发的参考单元的边向量来表示。设 $\\boldsymbol{v}_i = \\boldsymbol{x}_i - \\boldsymbol{x}_1$ 和 $\\hat{\\boldsymbol{v}}_i = \\hat{\\boldsymbol{x}}_i - \\hat{\\boldsymbol{x}}_1$，其中 $i \\in \\{2, 3, 4\\}$。\n$$ \\boldsymbol{v}_i = \\boldsymbol{x}_i - \\boldsymbol{x}_1 = (\\boldsymbol{B}\\hat{\\boldsymbol{x}}_i + \\boldsymbol{b}) - (\\boldsymbol{B}\\hat{\\boldsymbol{x}}_1 + \\boldsymbol{b}) = \\boldsymbol{B}(\\hat{\\boldsymbol{x}}_i - \\hat{\\boldsymbol{x}}_1) = \\boldsymbol{B}\\hat{\\boldsymbol{v}}_i $$\n参考边向量为：\n$$ \\hat{\\boldsymbol{v}}_2 = (1,0,0)^T, \\quad \\hat{\\boldsymbol{v}}_3 = (0,1,0)^T, \\quad \\hat{\\boldsymbol{v}}_4 = (0,0,1)^T $$\n对应的物理边向量为：\n$$ \\boldsymbol{v}_2 = (2,0,0)^T, \\quad \\boldsymbol{v}_3 = (0,1,0)^T, \\quad \\boldsymbol{v}_4 = (0,0,0.5)^T $$\n我们可以将其写成矩阵方程：\n$$ [\\boldsymbol{v}_2, \\boldsymbol{v}_3, \\boldsymbol{v}_4] = \\boldsymbol{B} [\\hat{\\boldsymbol{v}}_2, \\hat{\\boldsymbol{v}}_3, \\hat{\\boldsymbol{v}}_4] $$\n由于 $[\\hat{\\boldsymbol{v}}_2, \\hat{\\boldsymbol{v}}_3, \\hat{\\boldsymbol{v}}_4]$ 是 $3 \\times 3$ 单位矩阵 $\\boldsymbol{I}$，我们发现 $\\boldsymbol{B}$ 就是物理边向量构成的矩阵：\n$$ DF_K = \\boldsymbol{B} = [\\boldsymbol{v}_2, \\boldsymbol{v}_3, \\boldsymbol{v}_4] = \\begin{pmatrix} 2  0  0 \\\\ 0  1  0 \\\\ 0  0  0.5 \\end{pmatrix} $$\n关于算子 2-范数的条件数 $\\kappa(DF_{K})$ 定义为 $DF_{K}$ 的最大奇异值与最小奇异值之比，即 $\\kappa(DF_{K}) = \\sigma_{\\max} / \\sigma_{\\min}$。由于 $DF_{K}$ 是一个对角矩阵，其奇异值是对角元素的绝对值：$\\sigma_1=2$、$\\sigma_2=1$ 和 $\\sigma_3=0.5$。\n最大奇异值为 $\\sigma_{\\max} = 2$。\n最小奇异值为 $\\sigma_{\\min} = 0.5$。\n条件数为：\n$$ \\kappa(DF_{K}) = \\frac{\\sigma_{\\max}}{\\sigma_{\\min}} = \\frac{2}{0.5} = 4 $$\n或者，$\\kappa(DF_{K})=\\|DF_{K}\\|_2\\,\\|DF_{K}^{-1}\\|_2$。我们有 $\\|DF_{K}\\|_2 = \\sigma_{\\max} = 2$。逆矩阵是 $DF_{K}^{-1} = \\text{diag}(1/2, 1, 2)$，所以 $\\|DF_{K}^{-1}\\|_2 = \\max(1/2, 1, 2) = 2$。因此，$\\kappa(DF_K) = 2 \\times 2 = 4$。\n\n**2. 长宽比**\n\n长宽比是最长边长与最短边长之比。我们必须计算物理四面体 $K$ 的 $6$ 条边的长度。设 $L_{ij} = \\|\\boldsymbol{x}_i - \\boldsymbol{x}_j\\|$。\n- $L_{12} = \\|(2,0,0) - (0,0,0)\\| = 2$\n- $L_{13} = \\|(0,1,0) - (0,0,0)\\| = 1$\n- $L_{14} = \\|(0,0,0.5) - (0,0,0)\\| = 0.5$\n- $L_{23} = \\|(0,1,0) - (2,0,0)\\| = \\|(-2,1,0)\\| = \\sqrt{(-2)^2+1^2+0^2} = \\sqrt{5}$\n- $L_{24} = \\|(0,0,0.5) - (2,0,0)\\| = \\|(-2,0,0.5)\\| = \\sqrt{(-2)^2+0^2+0.5^2} = \\sqrt{4+0.25} = \\sqrt{4.25} = \\frac{\\sqrt{17}}{2}$\n- $L_{34} = \\|(0,0,0.5) - (0,1,0)\\| = \\|(0,-1,0.5)\\| = \\sqrt{0^2+(-1)^2+0.5^2} = \\sqrt{1+0.25} = \\sqrt{1.25} = \\frac{\\sqrt{5}}{2}$\n边长约为 $\\{2, 1, 0.5, 2.236, 2.062, 1.118\\}$。\n最长边是 $L_{\\max} = L_{23} = \\sqrt{5}$。\n最短边是 $L_{\\min} = L_{14} = 0.5$。\n长宽比为：\n$$ \\text{长宽比} = \\frac{L_{\\max}}{L_{\\min}} = \\frac{\\sqrt{5}}{0.5} = 2\\sqrt{5} \\approx 4.472 $$\n\n**3. 最小内角和质量评估**\n\n我们使用两个向量 $\\boldsymbol{u}$ 和 $\\boldsymbol{v}$ 之间夹角 $\\theta$ 的点积公式 $\\cos\\theta = (\\boldsymbol{u} \\cdot \\boldsymbol{v}) / (\\|\\boldsymbol{u}\\| \\|\\boldsymbol{v}\\|)$，计算 $4$ 个三角形面上各自的内角。\n\n- **面 1 ($\\boldsymbol{x}_1, \\boldsymbol{x}_2, \\boldsymbol{x}_3$):** 从 $\\boldsymbol{x}_1$ 出发的向量是 $\\boldsymbol{v}_{12}=(2,0,0)$ 和 $\\boldsymbol{v}_{13}=(0,1,0)$。由于 $\\boldsymbol{v}_{12} \\cdot \\boldsymbol{v}_{13} = 0$，在 $\\boldsymbol{x}_1$ 处的角是 $90^\\circ$。其他角是 $\\arccos(2/\\sqrt{5}) \\approx 26.57^\\circ$ 和 $\\arccos(1/\\sqrt{5}) \\approx 63.43^\\circ$。\n\n- **面 2 ($\\boldsymbol{x}_1, \\boldsymbol{x}_2, \\boldsymbol{x}_4$):** 从 $\\boldsymbol{x}_1$ 出发的向量是 $\\boldsymbol{v}_{12}=(2,0,0)$ 和 $\\boldsymbol{v}_{14}=(0,0,0.5)$。由于 $\\boldsymbol{v}_{12} \\cdot \\boldsymbol{v}_{14} = 0$，在 $\\boldsymbol{x}_1$ 处的角是 $90^\\circ$。其他角是 $\\arccos(4/\\sqrt{17}) \\approx 14.04^\\circ$ 和 $\\arccos(1/\\sqrt{17}) \\approx 75.96^\\circ$。\n\n- **面 3 ($\\boldsymbol{x}_1, \\boldsymbol{x}_3, \\boldsymbol{x}_4$):** 从 $\\boldsymbol{x}_1$ 出发的向量是 $\\boldsymbol{v}_{13}=(0,1,0)$ 和 $\\boldsymbol{v}_{14}=(0,0,0.5)$。由于 $\\boldsymbol{v}_{13} \\cdot \\boldsymbol{v}_{14} = 0$，在 $\\boldsymbol{x}_1$ 处的角是 $90^\\circ$。其他角是 $\\arccos(2/\\sqrt{5}) \\approx 26.57^\\circ$ 和 $\\arccos(1/\\sqrt{5}) \\approx 63.43^\\circ$。\n\n- **面 4 ($\\boldsymbol{x}_2, \\boldsymbol{x}_3, \\boldsymbol{x}_4$):**\n    - 在 $\\boldsymbol{x}_2$ 处的角：向量为 $\\boldsymbol{x}_3-\\boldsymbol{x}_2=(-2,1,0)$ 和 $\\boldsymbol{x}_4-\\boldsymbol{x}_2=(-2,0,0.5)$。角为 $\\arccos(8/\\sqrt{85}) \\approx 29.74^\\circ$。\n    - 在 $\\boldsymbol{x}_3$ 处的角：向量为 $\\boldsymbol{x}_2-\\boldsymbol{x}_3=(2,-1,0)$ 和 $\\boldsymbol{x}_4-\\boldsymbol{x}_3=(0,-1,0.5)$。角为 $\\arccos(1/2.5) = \\arccos(0.4) \\approx 66.42^\\circ$。\n    - 在 $\\boldsymbol{x}_4$ 处的角：向量为 $\\boldsymbol{x}_2-\\boldsymbol{x}_4=(2,0,-0.5)$ 和 $\\boldsymbol{x}_3-\\boldsymbol{x}_4=(0,1,-0.5)$。角为 $\\arccos(1/\\sqrt{85}) \\approx 83.83^\\circ$。\n\n所有面中的最小角是 $\\theta_{\\min} = \\arccos(4/\\sqrt{17}) \\approx 14.04^\\circ$。\n\n**质量阈值评估：**\n\n- **最小面角阈值 ($20^\\circ$)：**\n计算出的最小角是 $14.04^\\circ$。由于 $14.04^\\circ  20^\\circ$，该单元**未通过**此质量阈值。\n\n- **条件数阈值 ($4.1$)：**\n计算出的条件数是 $\\kappa(DF_K) = 4$。由于 $4  4.1$，该单元**通过**此质量阈值。\n\n根据答案规范，最终答案是 $\\kappa(DF_{K})$ 的值，四舍五入到四位有效数字。\n$$ \\kappa(DF_K) = 4.000 $$",
            "answer": "$$\\boxed{4.000}$$"
        },
        {
            "introduction": "在实际应用中，尤其是在自适应网格细化中，我们经常会遇到“非协调”网格，其中一个单元的边可能与相邻的两个或更多个小单元的边相接，形成“悬挂节点”。为了确保整个求解域上函数的连续性并保证数值方法的收敛性，我们必须施加特定约束并通过“补丁测试”。本练习将通过一个带有T型节点的经典非协调网格，演示如何应用悬挂节点约束，并验证该方案是否能精确表示一个简单的线性函数场，这是保证任何有限元格式有效性的基本要求。",
            "id": "3419666",
            "problem": "考虑方形区域 $\\Omega = [0,1] \\times [0,1]$。设 $\\mathcal{T}_h$ 是一个三角剖分，由于在垂直线段 $\\{(x,y) \\in \\Omega : x = 0.5, 0 \\le y \\le 1\\}$ 上存在一个T型节点，该剖分是非协调的。顶点集为\n- $A = (0,0)$, $B = (0.5,0)$, $C = (0.5,1)$, $D = (0,1)$, $E = (1,0)$, $F = (1,0.5)$, $G = (1,1)$，以及一个悬挂节点 $H = (0.5,0.5)$。\n单元为以下三角形\n- $\\Omega$ 左半部分的 $T_1 = \\triangle ABC$，$T_2 = \\triangle ACD$，\n- $\\Omega$ 右半部分的 $T_3 = \\triangle BHE$，$T_4 = \\triangle EHF$，$T_5 = \\triangle HCG$，$T_6 = \\triangle HGF$。\n在每个三角形上，考虑标准的一阶拉格朗日形函数（即连续的分片仿射函数）。为了在由T型节点引起的非匹配界面上强制实现单元间的连续性，在悬挂节点 $H$ 处施加以下线性约束：\n$$\nu_h(H) \\;=\\; \\tfrac{1}{2}\\,u_h(B) \\;+\\; \\tfrac{1}{2}\\,u_h(C).\n$$\n设 $p(x,y) = a x + b y + c$ 是一个任意的线性多项式，其中常数 $a, b, c \\in \\mathbb{R}$。将 $u_h \\in V_h$ 定义为在 $\\mathcal{T}_h$ 上的唯一分片仿射函数，它在所有非悬挂顶点 $X \\in \\{A,B,C,D,E,F,G\\}$ 处取节点值 $u_h(X) = p(X)$，并在 $H$ 处满足上述约束。\n\n仅使用一阶拉格朗日有限元的基本性质和上述约束，判断这个带约束的非协调网格是否能精确表示线性函数 $p$。具体而言，计算在 $\\Omega$ 上的表示误差的 $L^2$-范数：\n$$\n\\|p - u_h\\|_{L^2(\\Omega)} \\;=\\; \\left(\\int_{\\Omega} |p(x,y) - u_h(x,y)|^2 \\, dx\\,dy\\right)^{1/2}.\n$$\n最终答案请给出一个不带单位的精确实数。",
            "solution": "问题要求计算表示误差的 $L^2$-范数 $\\|p - u_h\\|_{L^2(\\Omega)}$，其中 $p(x,y) = ax+by+c$ 是一个任意的线性多项式，而 $u_h$ 是它在一个定义于非协调网格上的特定有限元空间中的表示。\n\n首先，我们必须验证问题陈述的有效性。区域是单位正方形 $\\Omega = [0,1] \\times [0,1]$。三角剖分 $\\mathcal{T}_h$ 由一组顶点和三角形指定。我们来确认这些三角形是否构成了 $\\Omega$ 的一个有效剖分。\n顶点为 $A=(0,0)$, $B=(0.5,0)$, $C=(0.5,1)$, $D=(0,1)$, $E=(1,0)$, $F=(1,0.5)$, $G=(1,1)$。悬挂节点为 $H=(0.5,0.5)$。\n区域的左半部分 $[0, 0.5] \\times [0,1]$ 的角点为 $(0,0), (0.5,0), (0.5,1)$ 和 $(0,1)$，对应于顶点 $A, B, C, D$。单元为 $T_1 = \\triangle ABC$ 和 $T_2 = \\triangle ACD$。并集 $T_1 \\cup T_2$ 是边界为 $A \\to B \\to C \\to D \\to A$ 的多边形，它正确地构成了矩形 $[0, 0.5] \\times [0,1]$。\n区域的右半部分 $[0.5, 1] \\times [0,1]$ 由三角形 $T_3, T_4, T_5, T_6$ 组成。\n- $T_3 = \\triangle BHE = \\triangle(0.5,0), (0.5,0.5), (1,0)$。\n- $T_4 = \\triangle EHF = \\triangle(1,0), (0.5,0.5), (1,0.5)$。\n并集 $T_3 \\cup T_4$ 构成了顶点为 $(0.5,0), (1,0), (1,0.5), (0.5,0.5)$ 的矩形，即 $[0.5, 1] \\times [0, 0.5]$。\n- $T_5 = \\triangle HCG = \\triangle(0.5,0.5), (0.5,1), (1,1)$。\n- $T_6 = \\triangle HGF = \\triangle(0.5,0.5), (1,1), (1,0.5)$。\n并集 $T_5 \\cup T_6$ 构成了顶点为 $(0.5,0.5), (0.5,1), (1,1), (1,0.5)$ 的矩形，即 $[0.5, 1] \\times [0.5, 1]$。\n所有六个三角形的并集正确地覆盖了整个区域 $\\Omega$。该问题在几何上是自洽的。非协调网格、拉格朗日单元和悬挂节点约束等概念在数值分析中是标准的。该问题是有效的。\n\n要计算的误差是 $\\|p - u_h\\|_{L^2(\\Omega)} = \\left(\\int_{\\Omega} |p(x,y) - u_h(x,y)|^2 \\, dx\\,dy\\right)^{1/2}$。我们可以逐个单元地分析误差 $e(x,y) = p(x,y) - u_h(x,y)$。总的平方误差是每个单元上的平方误差之和：\n$$\n\\|p - u_h\\|_{L^2(\\Omega)}^2 = \\sum_{k=1}^6 \\int_{T_k} |p(x,y) - u_h(x,y)|^2 \\, dx\\,dy.\n$$\n函数 $u_h$ 是一个分片仿射函数。在每个三角形 $T_k$ 上，$u_h$ 是一个线性多项式，由其在 $T_k$ 的三个顶点处的值唯一确定。\n\n让我们首先分析区域左侧的单元，即 $\\Omega_L = [0, 0.5] \\times [0,1]$。这个子区域由 $T_1 = \\triangle ABC$ 和 $T_2 = \\triangle ACD$ 剖分。\n在 $T_1$ 上，函数 $u_h$ 由其在顶点 $A, B, C$ 处的值定义。根据问题定义，非悬挂顶点的节点值通过计算 $p$ 得到：\n$u_h(A) = p(A)$，$u_h(B) = p(B)$ 和 $u_h(C) = p(C)$。\n在 $T_1$ 上的函数 $u_h$ 是在三个不共线的点（$T_1$ 的顶点）上与线性多项式 $p$ 值相同的唯一线性多项式。因此，对于所有 $(x,y) \\in T_1$，$u_h(x,y)$ 必须与 $p(x,y)$ 完全相同。\n类似地，在 $T_2$ 上，$u_h$ 由其在顶点 $A, C, D$ 处的值定义。节点值为 $u_h(A)=p(A)$, $u_h(C)=p(C)$ 和 $u_h(D)=p(D)$。和之前一样，对于所有 $(x,y) \\in T_2$，$u_h(x,y)$ 必须与 $p(x,y)$ 完全相同。\n因此，误差 $p - u_h$ 在整个左子区域 $\\Omega_L$ 上恒为零。这部分对总误差的贡献为零。\n\n现在，我们分析区域右侧的单元，即 $\\Omega_R = [0.5, 1] \\times [0,1]$。这涉及到悬挂节点 $H=(0.5,0.5)$。\n$u_h$ 在非悬挂顶点 $B, C, E, F, G$ 处的值通过计算 $p$ 设定。在悬挂节点 $H$ 处的值由线性约束确定：\n$$\nu_h(H) = \\tfrac{1}{2}\\,u_h(B) + \\tfrac{1}{2}\\,u_h(C).\n$$\n代入 $u_h(B)$ 和 $u_h(C)$ 的定义，我们得到：\n$$\nu_h(H) = \\tfrac{1}{2}\\,p(B) + \\tfrac{1}{2}\\,p(C).\n$$\n我们现在必须将这个值与多项式 $p$ 在点 $H$ 处的值，即 $p(H)$，进行比较。\n任何线性函数 $p(x,y)=ax+by+c$ 的一个基本性质是，它在线段上的值是其在端点处值的线性插值。具体来说，对于一个点 $P_\\lambda = (1-\\lambda)P_1 + \\lambda P_2$，我们有 $p(P_\\lambda) = (1-\\lambda)p(P_1) + \\lambda p(P_2)$。\n所讨论的顶点是 $B=(0.5,0)$ 和 $C=(0.5,1)$。悬挂节点是 $H=(0.5,0.5)$。我们可以观察到 $H$ 是线段 $BC$ 的中点：\n$$\nH = (0.5, 0.5) = \\left(\\frac{0.5+0.5}{2}, \\frac{0+1}{2}\\right) = \\tfrac{1}{2}B + \\tfrac{1}{2}C.\n$$\n这对应于 $\\lambda = 1/2$ 的情况。应用线性函数的性质：\n$$\np(H) = p(\\tfrac{1}{2}B + \\tfrac{1}{2}C) = \\tfrac{1}{2}\\,p(B) + \\tfrac{1}{2}\\,p(C).\n$$\n将此与 $u_h(H)$ 的表达式进行比较，我们发现：\n$$\nu_h(H) = p(H).\n$$\n该约束正是使得 $u_h$ 在悬挂节点处的节点值与线性多项式 $p$ 的值相匹配所需的条件。这被称为满足线性多项式的小片检验（patch test）。\n\n既然有了 $u_h(H)=p(H)$，我们就可以确定在 $\\Omega_R$ 中各个三角形上的误差。\n- 在 $T_3 = \\triangle BHE$ 上：顶点是 $B, H, E$。$u_h$ 的节点值为 $u_h(B)=p(B)$，$u_h(H)=p(H)$ 和 $u_h(E)=p(E)$。由于 $T_3$ 上的线性函数 $u_h$ 在三个顶点处与线性函数 $p$ 相匹配，因此在 $T_3$ 上 $u_h \\equiv p$。\n- 在 $T_4 = \\triangle EHF$ 上：顶点是 $E, H, F$。节点值为 $u_h(E)=p(E)$，$u_h(H)=p(H)$，$u_h(F)=p(F)$。因此，在 $T_4$ 上 $u_h \\equiv p$。\n- 在 $T_5 = \\triangle HCG$ 上：顶点是 $H, C, G$。节点值为 $u_h(H)=p(H)$，$u_h(C)=p(C)$，$u_h(G)=p(G)$。因此，在 $T_5$ 上 $u_h \\equiv p$。\n- 在 $T_6 = \\triangle HGF$ 上：顶点是 $H, G, F$。节点值为 $u_h(H)=p(H)$，$u_h(G)=p(G)$，$u_h(F)=p(F)$。因此，在 $T_6$ 上 $u_h \\equiv p$。\n\n因此，表示误差 $p(x,y) - u_h(x,y)$ 在三角剖分 $\\mathcal{T}_h$ 中的每个单元 $T_k$ 上都恒为零。这意味着对于所有 $(x,y) \\in \\Omega$，$p(x,y) - u_h(x,y) = 0$。\n那么误差的 $L^2$-范数是：\n$$\n\\|p - u_h\\|_{L^2(\\Omega)} = \\left(\\int_{\\Omega} |0|^2 \\, dx\\,dy\\right)^{1/2} = 0.\n$$\n该带约束的非协调网格可以精确表示任何线性函数 $p$。误差为零，与线性多项式的具体系数 $a,b,c$ 无关。",
            "answer": "$$\n\\boxed{0}\n$$"
        }
    ]
}