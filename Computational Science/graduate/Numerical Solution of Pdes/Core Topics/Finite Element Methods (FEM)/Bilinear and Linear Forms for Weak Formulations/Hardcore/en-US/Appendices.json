{
    "hands_on_practices": [
        {
            "introduction": "The first step in using the finite element method is to translate a partial differential equation into its weak, or variational, form. This process involves integration by parts, which naturally separates the problem into a bilinear form, $a(u,v)$, acting on the solution and test function, and a linear form, $L(v)$, which captures sources and certain types of boundary conditions. This exercise demonstrates the fundamental procedure for deriving the weak formulation for a diffusion problem and critically highlights how Neumann boundary conditions are incorporated directly into the linear functional as \"natural\" boundary conditions. ",
            "id": "3366921",
            "problem": "Consider the scalar diffusion Partial Differential Equation (PDE) with Neumann boundary condition on a bounded Lipschitz domain $\\Omega \\subset \\mathbb{R}^{d}$ with outward unit normal $\\boldsymbol{n}$:\n$$\n- \\nabla \\cdot (\\kappa \\nabla u) = f \\quad \\text{in } \\Omega, \n\\qquad \\kappa \\nabla u \\cdot \\boldsymbol{n} = g \\quad \\text{on } \\partial \\Omega,\n$$\nwhere $\\kappa \\in L^{\\infty}(\\Omega)$ is uniformly positive, $f \\in H^{-1}(\\Omega)$, $g \\in H^{-1/2}(\\partial \\Omega)$, and $\\gamma: H^{1}(\\Omega) \\to H^{1/2}(\\partial \\Omega)$ denotes the trace operator. Starting from the divergence theorem and Green’s identity for sufficiently smooth functions, derive the weak formulation by identifying the bilinear form $a(u,v)$ and the linear functional $L(v)$ on $H^{1}(\\Omega)$, and explain precisely how the natural Neumann boundary condition appears in the linear functional $L(v)$.\n\nThen, specialize to the case $\\kappa \\equiv 1$, $\\Omega = \\{ x \\in \\mathbb{R}^{2} : |x| < 1 \\}$, choose the test function $v(x) = |x|^{2}$, and let $f(x) = 3 - 2|x|^{2}$ in $\\Omega$ and $g \\equiv 5$ on $\\partial \\Omega$. Compute the value of the linear functional\n$$\nL(v) = \\int_{\\Omega} f\\, v \\, dx + \\int_{\\partial \\Omega} g \\, \\gamma v \\, ds.\n$$\nExpress your final answer exactly; no rounding is required. The final answer must be a single real number with no units.",
            "solution": "The problem consists of two parts. First, we derive the weak formulation for a general scalar diffusion equation. Second, we compute the value of the linear functional for a specific case.\n\nPart 1: Derivation of the Weak Formulation\n\nThe strong form of the partial differential equation (PDE) is given by:\n$$\n- \\nabla \\cdot (\\kappa \\nabla u) = f \\quad \\text{in } \\Omega, \\quad (1)\n$$\nwith the Neumann boundary condition:\n$$\n\\kappa \\nabla u \\cdot \\boldsymbol{n} = g \\quad \\text{on } \\partial \\Omega, \\quad (2)\n$$\nwhere $u$ is the unknown solution. The weak formulation is found by seeking a solution $u$ in an appropriate function space, here $H^{1}(\\Omega)$, such that an integral identity holds for all test functions $v$ from the same space.\n\nWe begin by multiplying equation (1) by an arbitrary test function $v \\in H^{1}(\\Omega)$ and integrating over the domain $\\Omega$:\n$$\n- \\int_{\\Omega} (\\nabla \\cdot (\\kappa \\nabla u)) v \\, dx = \\int_{\\Omega} f v \\, dx. \\quad (3)\n$$\nThe core step in deriving the weak formulation is to apply the divergence theorem, often in the form of Green's first identity, to the term on the left-hand side. Green's first identity states that for a vector field $\\boldsymbol{F}$ and a scalar field $\\phi$ (with sufficient regularity),\n$$\n\\int_{\\Omega} (\\nabla \\cdot \\boldsymbol{F}) \\phi \\, dx = \\int_{\\partial \\Omega} (\\boldsymbol{F} \\cdot \\boldsymbol{n}) \\phi \\, ds - \\int_{\\Omega} \\boldsymbol{F} \\cdot \\nabla \\phi \\, dx.\n$$\nWe identify our vector field as $\\boldsymbol{F} = \\kappa \\nabla u$ and our scalar field as $\\phi = v$. Applying this identity to the left-hand side of equation (3) yields:\n$$\n- \\left( \\int_{\\partial \\Omega} (\\kappa \\nabla u \\cdot \\boldsymbol{n}) v \\, ds - \\int_{\\Omega} (\\kappa \\nabla u) \\cdot \\nabla v \\, dx \\right) = \\int_{\\Omega} f v \\, dx.\n$$\nDistributing the negative sign, we have:\n$$\n\\int_{\\Omega} (\\kappa \\nabla u) \\cdot \\nabla v \\, dx - \\int_{\\partial \\Omega} (\\kappa \\nabla u \\cdot \\boldsymbol{n}) v \\, ds = \\int_{\\Omega} f v \\, dx. \\quad (4)\n$$\nAt this point, the Neumann boundary condition (2) is incorporated. The term $\\kappa \\nabla u \\cdot \\boldsymbol{n}$ appearing in the boundary integral is replaced by the given function $g$. This is precisely how the natural Neumann boundary condition appears in the formulation: it is substituted into the boundary integral that arises naturally from integration by parts. This substitution transforms a condition on the solution $u$ into a known data term.\nSubstituting $g$ for $\\kappa \\nabla u \\cdot \\boldsymbol{n}$, we get:\n$$\n\\int_{\\Omega} \\kappa \\nabla u \\cdot \\nabla v \\, dx - \\int_{\\partial \\Omega} g v \\, ds = \\int_{\\Omega} f v \\, dx.\n$$\nRearranging the terms to isolate all expression involving the unknown $u$ on the left side and all terms involving known data and the test function $v$ on the right side, we obtain the final weak formulation:\n$$\n\\int_{\\Omega} \\kappa \\nabla u \\cdot \\nabla v \\, dx = \\int_{\\Omega} f v \\, dx + \\int_{\\partial \\Omega} g v \\, ds.\n$$\nThe problem is now to find $u \\in H^{1}(\\Omega)$ such that this equation holds for all $v \\in H^{1}(\\Omega)$. We can identify the bilinear form $a(u,v)$ and the linear functional $L(v)$:\nThe bilinear form is:\n$$\na(u,v) = \\int_{\\Omega} \\kappa \\nabla u \\cdot \\nabla v \\, dx.\n$$\nThe linear functional is:\n$$\nL(v) = \\int_{\\Omega} f v \\, dx + \\int_{\\partial \\Omega} g v \\, ds.\n$$\nFor functions $f \\in H^{-1}(\\Omega)$ and $g \\in H^{-1/2}(\\partial \\Omega)$, these integrals are more rigorously interpreted as duality pairings: $L(v) = \\langle f, v \\rangle_{H^{-1}(\\Omega), H^{1}(\\Omega)} + \\langle g, \\gamma v \\rangle_{H^{-1/2}(\\partial\\Omega), H^{1/2}(\\partial\\Omega)}$, where $\\gamma v$ is the trace of $v$ on $\\partial\\Omega$.\n\nPart 2: Computation of the Linear Functional\n\nWe are asked to compute $L(v)$ for the specific case:\n- Coefficient: $\\kappa = 1$.\n- Domain: $\\Omega = \\{ x \\in \\mathbb{R}^{2} : |x| < 1 \\}$, the unit disk.\n- Test function: $v(x) = |x|^{2}$.\n- Source term: $f(x) = 3 - 2|x|^{2}$.\n- Boundary data: $g(x) = 5$ for $x \\in \\partial\\Omega$.\n\nThe linear functional is $L(v) = \\int_{\\Omega} f\\, v \\, dx + \\int_{\\partial \\Omega} g \\, \\gamma v \\, ds$. We compute the two integrals separately.\n\n1.  Domain Integral: $\\int_{\\Omega} f v \\, dx$\nThe integrand is $f(x)v(x) = (3 - 2|x|^{2}) |x|^{2} = 3|x|^{2} - 2|x|^{4}$.\nTo evaluate this integral over the unit disk, we switch to polar coordinates. In polar coordinates, $x = (r\\cos\\theta, r\\sin\\theta)$, so $|x| = r$. The differential area element is $dx = r \\, dr \\, d\\theta$. The domain $\\Omega$ is described by $0 \\le r \\le 1$ and $0 \\le \\theta < 2\\pi$.\nThe integral becomes:\n$$\n\\int_{\\Omega} (3|x|^2 - 2|x|^4) \\, dx = \\int_{0}^{2\\pi} \\int_{0}^{1} (3r^2 - 2r^4) r \\, dr \\, d\\theta.\n$$\nThe integrand does not depend on $\\theta$, so the integration with respect to $\\theta$ yields a factor of $2\\pi$:\n$$\n2\\pi \\int_{0}^{1} (3r^3 - 2r^5) \\, dr.\n$$\nNow we compute the radial integral:\n$$\n\\int_{0}^{1} (3r^3 - 2r^5) \\, dr = \\left[ 3\\frac{r^4}{4} - 2\\frac{r^6}{6} \\right]_{0}^{1} = \\left[ \\frac{3}{4}r^4 - \\frac{1}{3}r^6 \\right]_{0}^{1}.\n$$\nEvaluating the antiderivative at the limits:\n$$\n\\left( \\frac{3}{4}(1)^4 - \\frac{1}{3}(1)^6 \\right) - \\left( \\frac{3}{4}(0)^4 - \\frac{1}{3}(0)^6 \\right) = \\frac{3}{4} - \\frac{1}{3} = \\frac{9-4}{12} = \\frac{5}{12}.\n$$\nThus, the domain integral is $2\\pi \\times \\frac{5}{12} = \\frac{5\\pi}{6}$.\n\n2.  Boundary Integral: $\\int_{\\partial \\Omega} g \\, \\gamma v \\, ds$\nThe boundary $\\partial \\Omega$ is the unit circle, where $|x|=1$.\nThe function $g$ is constant on the boundary: $g = 5$.\nThe trace of the test function $v(x)=|x|^2$ on the boundary is $\\gamma v = v|_{\\partial\\Omega}$. On $\\partial\\Omega$, $|x|=1$, so $\\gamma v = 1^2 = 1$.\nThe integral is:\n$$\n\\int_{\\partial \\Omega} g \\, \\gamma v \\, ds = \\int_{\\partial \\Omega} 5 \\cdot 1 \\, ds = 5 \\int_{\\partial \\Omega} ds.\n$$\nThe integral $\\int_{\\partial \\Omega} ds$ is simply the length (circumference) of the boundary $\\partial \\Omega$. For the unit circle, the radius is $R=1$, so the circumference is $2\\pi R = 2\\pi(1) = 2\\pi$.\nTherefore, the boundary integral is $5 \\times (2\\pi) = 10\\pi$.\n\nFinally, we sum the two parts to find $L(v)$:\n$$\nL(v) = \\frac{5\\pi}{6} + 10\\pi = \\frac{5\\pi}{6} + \\frac{60\\pi}{6} = \\frac{65\\pi}{6}.\n$$",
            "answer": "$$\n\\boxed{\\frac{65\\pi}{6}}\n$$"
        },
        {
            "introduction": "Once the continuous bilinear form $a(u,v)$ is established, the finite element method requires computing the entries of a \"stiffness matrix,\" whose entries are defined by applying the bilinear form to basis functions, as in $a(\\phi_j, \\phi_i)$. These integrals are almost always computed numerically using quadrature rules, and the accuracy of this step is paramount. This practice explores the crucial link between the abstract weak formulation and its computational implementation by having you determine the minimum quadrature order needed for exact integration, a key consideration for accuracy and efficiency in finite element codes. ",
            "id": "3366941",
            "problem": "Consider the second-order linear partial differential equation on a bounded Lipschitz domain $\\Omega \\subset \\mathbb{R}^d$ with $d \\in \\{2,3\\}$,\n$$\n- \\nabla \\cdot \\big(\\kappa(\\boldsymbol{x}) \\nabla u(\\boldsymbol{x})\\big) + \\boldsymbol{\\beta}(\\boldsymbol{x}) \\cdot \\nabla u(\\boldsymbol{x}) + c(\\boldsymbol{x})\\, u(\\boldsymbol{x}) = f(\\boldsymbol{x}) \\quad \\text{in } \\Omega,\n$$\nwith homogeneous Dirichlet boundary conditions on $\\partial \\Omega$. On an affine, shape-regular mesh $\\mathcal{T}_h$ of simplices, consider the continuous Lagrange finite element space $V_h \\subset H_0^1(\\Omega)$ of degree $k \\ge 1$, i.e., $V_h = \\{ v_h \\in C^0(\\overline{\\Omega}) : v_h|_K \\in P_k(K) \\ \\forall K \\in \\mathcal{T}_h, \\ v_h|_{\\partial \\Omega}=0\\}$. The Galerkin bilinear form is\n$$\na(u,v) = \\sum_{K \\in \\mathcal{T}_h} \\left[ \\int_K \\kappa(\\boldsymbol{x}) \\, \\nabla u \\cdot \\nabla v \\, \\mathrm{d}\\boldsymbol{x} + \\int_K \\boldsymbol{\\beta}(\\boldsymbol{x}) \\cdot \\nabla u \\, v \\, \\mathrm{d}\\boldsymbol{x} + \\int_K c(\\boldsymbol{x}) \\, u \\, v \\, \\mathrm{d}\\boldsymbol{x} \\right].\n$$\nAssume $\\kappa|_K \\in P_{q_\\kappa}(K)$, $\\boldsymbol{\\beta}|_K \\in [P_{q_\\beta}(K)]^d$, and $c|_K \\in P_{q_c}(K)$ are polynomials of degrees $q_\\kappa, q_\\beta, q_c \\in \\mathbb{N}_0$ on each element $K$, respectively. Each element stiffness matrix $A^K \\in \\mathbb{R}^{n_K \\times n_K}$ is defined by entries $A^K_{ij} = a_K(\\varphi_j,\\varphi_i)$ where $\\{\\varphi_i\\}_{i=1}^{n_K}$ is the local nodal basis of $V_h|_K$ and\n$$\na_K(u,v) = \\int_K \\kappa \\, \\nabla u \\cdot \\nabla v \\, \\mathrm{d}\\boldsymbol{x} + \\int_K \\boldsymbol{\\beta} \\cdot \\nabla u \\, v \\, \\mathrm{d}\\boldsymbol{x} + \\int_K c \\, u \\, v \\, \\mathrm{d}\\boldsymbol{x}.\n$$\nFor numerical integration, an elementwise quadrature rule $Q_K$ with polynomial exactness degree $m$ is used: $Q_K[p] = \\int_K p \\, \\mathrm{d}\\boldsymbol{x}$ for all polynomials $p \\in P_m(K)$.\n\nWhich one of the following statements correctly specifies a sufficient condition on the quadrature exactness degree $m$ to guarantee exact evaluation of all element stiffness entries $A^K_{ij}$ on affine elements, and correctly characterizes the impact of underintegration (i.e., using $m$ smaller than that condition) on the symmetry of the assembled matrix?\n\nA. On affine elements, it suffices to choose $m \\ge \\max\\{\\, q_\\kappa + 2k - 2,\\ q_\\beta + 2k - 1,\\ q_c + 2k \\,\\}$ to make all $A^K_{ij}$ exact. If the continuous bilinear form is symmetric (e.g., $\\boldsymbol{\\beta} = \\boldsymbol{0}$), then underintegration with any symmetric quadrature preserves matrix symmetry, although it can degrade coercivity and consistency.\n\nB. It suffices to choose $m \\ge q_\\kappa + 2k$ for exact diffusion contributions; the advection and reaction contributions require no more than $m \\ge 2k$ regardless of coefficients. Underintegration generically breaks symmetry even if the continuous bilinear form is symmetric.\n\nC. It suffices to choose $m \\ge 2k - 2$ regardless of coefficient degrees. Underintegration always preserves both positive definiteness and symmetry of the stiffness matrix.\n\nD. It suffices to choose $m \\ge q_c + 2k$; diffusion and advection terms require lower order. Underintegration produces a skew-symmetric error that makes the assembled matrix nonsymmetric only when $\\boldsymbol{\\beta} \\neq \\boldsymbol{0}$.",
            "solution": "The entries of the element stiffness matrix $A^K$ are given by $A^K_{ij} = a_K(\\varphi_j, \\varphi_i)$. To evaluate these entries exactly using a quadrature rule, the rule must be exact for the integrand of each term in $a_K(\\varphi_j, \\varphi_i)$. The basis functions $\\varphi_i, \\varphi_j$ are polynomials of degree at most $k$ on element $K$, i.e., $\\varphi_i, \\varphi_j \\in P_k(K)$. Consequently, their gradients $\\nabla \\varphi_i, \\nabla \\varphi_j$ are vector fields whose components are polynomials of degree at most $k-1$, i.e., $\\nabla \\varphi_i, \\nabla \\varphi_j \\in [P_{k-1}(K)]^d$. We analyze the polynomial degree of the integrand for each of the three terms in $a_K$.\n\n1.  **Diffusion Term:** The integrand is $\\kappa(\\boldsymbol{x}) \\, \\nabla \\varphi_j \\cdot \\nabla \\varphi_i$.\n    *   $\\kappa \\in P_{q_\\kappa}(K)$.\n    *   $\\nabla \\varphi_j \\in [P_{k-1}(K)]^d$ and $\\nabla \\varphi_i \\in [P_{k-1}(K)]^d$.\n    *   The dot product $\\nabla \\varphi_j \\cdot \\nabla \\varphi_i$ is a sum of products of polynomials of degree $k-1$, resulting in a polynomial of degree up to $(k-1) + (k-1) = 2k-2$.\n    *   The total product $\\kappa (\\nabla \\varphi_j \\cdot \\nabla \\varphi_i)$ is a product of a polynomial of degree $q_\\kappa$ and one of degree $2k-2$. The resulting polynomial has a degree of up to $q_\\kappa + 2k - 2$.\n\n2.  **Advection Term:** The integrand is $\\boldsymbol{\\beta}(\\boldsymbol{x}) \\cdot \\nabla \\varphi_j \\, \\varphi_i$.\n    *   $\\boldsymbol{\\beta} \\in [P_{q_\\beta}(K)]^d$.\n    *   $\\nabla \\varphi_j \\in [P_{k-1}(K)]^d$.\n    *   $\\varphi_i \\in P_k(K)$.\n    *   The dot product $\\boldsymbol{\\beta} \\cdot \\nabla \\varphi_j$ results in a polynomial of degree up to $q_\\beta + (k-1)$.\n    *   The subsequent product with $\\varphi_i$ gives a polynomial of degree up to $(q_\\beta + k - 1) + k = q_\\beta + 2k - 1$.\n\n3.  **Reaction Term:** The integrand is $c(\\boldsymbol{x}) \\, \\varphi_j \\, \\varphi_i$.\n    *   $c \\in P_{q_c}(K)$.\n    *   $\\varphi_j, \\varphi_i \\in P_k(K)$.\n    *   The product $\\varphi_j \\varphi_i$ is a polynomial of degree up to $k+k = 2k$.\n    *   The total product $c (\\varphi_j \\varphi_i)$ is a polynomial of degree up to $q_c + 2k$.\n\nTo guarantee exact integration for all terms, the quadrature rule must be exact for polynomials of the highest degree encountered. Therefore, the degree of exactness $m$ must satisfy:\n$$\nm \\ge \\max\\{ q_\\kappa + 2k - 2, \\ q_\\beta + 2k - 1, \\ q_c + 2k \\}\n$$\n\nNext, we analyze the impact of underintegration on the symmetry of the assembled matrix. The exact element stiffness matrix $A^K$ is symmetric if $A^K_{ij} = A^K_{ji}$ for all $i,j$. Given the definition $A^K_{ij} = a_K(\\varphi_j, \\varphi_i)$, symmetry requires $a_K(\\varphi_j, \\varphi_i) = a_K(\\varphi_i, \\varphi_j)$. The bilinear form $a_K(u,v)$ is symmetric if and only if $a_K(u,v) = a_K(v,u)$.\nThe diffusion and reaction terms are symmetric in $u$ and $v$. The advection term, $\\int_K \\boldsymbol{\\beta} \\cdot \\nabla u \\, v \\, \\mathrm{d}\\boldsymbol{x}$, is not symmetric. Thus, the continuous bilinear form $a_K$ is symmetric if and only if $\\boldsymbol{\\beta} = \\boldsymbol{0}$.\n\nNow, consider the matrix $A_h^K$ obtained using numerical quadrature. Its entries are $(A_h^K)_{ij} = a_h^K(\\varphi_j, \\varphi_i)$, where $a_h^K$ is the bilinear form with integrals replaced by the quadrature operator $Q_K$.\nIf the continuous form is symmetric (i.e., $\\boldsymbol{\\beta} = \\boldsymbol{0}$), then $a_K(u,v) = \\int_K (\\kappa \\nabla u \\cdot \\nabla v + c u v) \\, \\mathrm{d}\\boldsymbol{x}$.\nThe integrands for $a_K(\\varphi_j, \\varphi_i)$ and $a_K(\\varphi_i, \\varphi_j)$ are, respectively:\n$I_{ji}(\\boldsymbol{x}) = \\kappa \\nabla \\varphi_j \\cdot \\nabla \\varphi_i + c \\varphi_j \\varphi_i$\n$I_{ij}(\\boldsymbol{x}) = \\kappa \\nabla \\varphi_i \\cdot \\nabla \\varphi_j + c \\varphi_i \\varphi_j$\nDue to the commutativity of scalar and dot products, $I_{ji}(\\boldsymbol{x}) = I_{ij}(\\boldsymbol{x})$. The integrands are identical functions.\nThe corresponding entries of the numerical matrix are $(A_h^K)_{ij} = Q_K[I_{ji}(\\boldsymbol{x})]$ and $(A_h^K)_{ji} = Q_K[I_{ij}(\\boldsymbol{x})]$. Since the quadrature rule $Q_K$ is a linear operator applied to identical functions, the results must be identical: $(A_h^K)_{ij} = (A_h^K)_{ji}$.\nTherefore, if the continuous bilinear form is symmetric, the resulting stiffness matrix from numerical integration will also be symmetric, regardless of whether the integration is exact or not (underintegration). Underintegration can, however, have other deleterious effects, such as a loss of coercivity (leading to a singular or non-positive-definite matrix) and a reduction in the order of accuracy (consistency error).\n\nBased on the detailed analysis, only statement A is fully correct.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "The structure of the bilinear form directly dictates the properties of the final algebraic system of equations that we must solve. Different physical phenomena, like diffusion and reaction, contribute distinct components to the bilinear form, which in turn generate the stiffness ($K$) and mass ($M$) matrices in the discrete system. This problem provides a hands-on analysis of how these components influence the spectral properties and conditioning of the discretized operator, showing how the interplay between the matrices affects the eigenvalues and, consequently, the numerical stability and performance of the solver. ",
            "id": "3366968",
            "problem": "Consider the scalar diffusion-reaction Partial Differential Equation (PDE) with homogeneous Dirichlet boundary conditions on the interval $\\Omega=(0,1)$: find $u \\in H_{0}^{1}(\\Omega)$ such that, for all test functions $v \\in H_{0}^{1}(\\Omega)$,\n$$\na_{\\sigma}(u,v) = \\ell(v),\n$$\nwhere the bilinear form is\n$$\na_{\\sigma}(u,v) = \\int_{0}^{1} u'(x)\\,v'(x)\\,dx + \\sigma \\int_{0}^{1} u(x)\\,v(x)\\,dx,\n$$\nand $\\ell$ is a bounded linear functional on $H_{0}^{1}(\\Omega)$. The parameter $\\sigma \\ge 0$ multiplies the reaction term and is to be considered a variable. The reaction term corresponds to the additional contribution $\\sigma \\int_{\\Omega} u\\,v\\,dx$ in the bilinear form.\n\nLet $\\{\\phi_{i}\\}_{i=1}^{N-1}$ denote the standard conforming, continuous, piecewise linear finite element basis functions on a uniform mesh of $N$ elements (mesh size $h = 1/N$) that vanish at the endpoints, giving $N-1$ interior degrees of freedom. Define the stiffness matrix $K$ and mass matrix $M$ by\n$$\nK_{ij} = \\int_{0}^{1} \\phi_{i}'(x)\\,\\phi_{j}'(x)\\,dx, \\qquad M_{ij} = \\int_{0}^{1} \\phi_{i}(x)\\,\\phi_{j}(x)\\,dx,\n$$\nand consider the discrete operator\n$$\nA(\\sigma) = K + \\sigma M.\n$$\n\nStarting from the weak formulation and the definitions of $K$ and $M$, perform the following:\n\n1. Derive the precise entries of $K$ and $M$ for the uniform one-dimensional mesh and show that $A(\\sigma)$ is symmetric and positive definite for all $\\sigma \\ge 0$.\n2. Explain, by considering the generalized eigenproblem $Kx = \\lambda Mx$, how adding the reaction term $\\sigma M$ affects the discrete spectrum of $A(\\sigma)$ and the conditioning with respect to the $M$-weighted inner product. In particular, motivate why the spectrum of $M^{-1}A(\\sigma)$ is a shift by $\\sigma$ of the generalized stiffness spectrum.\n3. Compute in closed form the generalized eigenvalues $\\lambda_{j}$ of the pair $(K,M)$ for $j=1,2,\\dots,N-1$ in terms of $h$ and $N$, by exploiting the structure induced by the uniform mesh and the discrete sine eigenvectors.\n4. Using these $\\lambda_{j}$, derive the exact analytic expression for the spectral condition number in the $M$-weighted inner product,\n$$\n\\kappa_{M}(A(\\sigma)) = \\frac{\\sigma + \\lambda_{\\max}}{\\sigma + \\lambda_{\\min}},\n$$\nwhere $\\lambda_{\\min}$ and $\\lambda_{\\max}$ denote the smallest and largest generalized eigenvalues of $(K,M)$, respectively.\n5. Determine the leading-order asymptotic behavior of $\\kappa_{M}(A(\\sigma))$ as $\\sigma \\to \\infty$.\n\nProvide as your final answer the exact closed-form analytic expression for $\\kappa_{M}(A(\\sigma))$ as a function of $\\sigma$ and $N$. No numerical approximation or rounding is needed. Your derivation should be fully self-contained, starting from the weak formulation and the properties of the uniform mesh, and it should make clear, at a conceptual level, how the added reaction term modifies the discrete spectrum and conditioning.",
            "solution": "**1. Derivation of Matrix Entries and Properties of $A(\\sigma)$**\n\nWe consider a uniform mesh on $\\Omega = (0,1)$ with nodes $x_k = kh$ for $k = 0, 1, \\dots, N$, where $h=1/N$. The interior nodes are at $x_i$ for $i=1, \\dots, N-1$. The piecewise linear basis function $\\phi_i(x)$ associated with node $x_i$ is non-zero only on the interval $(x_{i-1}, x_{i+1})$ and is defined by:\n$$\n\\phi_i(x) =\n\\begin{cases}\n\\frac{x - x_{i-1}}{h} & \\text{for } x \\in [x_{i-1}, x_i] \\\\\n\\frac{x_{i+1} - x}{h} & \\text{for } x \\in [x_i, x_{i+1}] \\\\\n0 & \\text{otherwise}\n\\end{cases}\n$$\nThe derivative $\\phi_i'(x)$ is piecewise constant:\n$$\n\\phi_i'(x) =\n\\begin{cases}\n\\frac{1}{h} & \\text{for } x \\in (x_{i-1}, x_i) \\\\\n-\\frac{1}{h} & \\text{for } x \\in (x_i, x_{i+1}) \\\\\n0 & \\text{otherwise}\n\\end{cases}\n$$\n\n**Stiffness Matrix $K$:**\nThe entry $K_{ij} = \\int_{0}^{1} \\phi_i'(x)\\phi_j'(x)dx$ is non-zero only if the supports of $\\phi_i'$ and $\\phi_j'$ overlap, which occurs for $|i-j| \\le 1$.\n- Diagonal entries ($i=j$):\n$$ K_{ii} = \\int_{x_{i-1}}^{x_{i+1}} (\\phi_i'(x))^2 dx = \\int_{x_{i-1}}^{x_i} \\left(\\frac{1}{h}\\right)^2 dx + \\int_{x_i}^{x_{i+1}} \\left(-\\frac{1}{h}\\right)^2 dx = \\frac{1}{h^2} \\cdot h + \\frac{1}{h^2} \\cdot h = \\frac{2}{h} $$\n- Off-diagonal entries ($j=i+1$):\n$$ K_{i,i+1} = \\int_{x_i}^{x_{i+1}} \\phi_i'(x)\\phi_{i+1}'(x) dx = \\int_{x_i}^{x_{i+1}} \\left(-\\frac{1}{h}\\right)\\left(\\frac{1}{h}\\right) dx = -\\frac{1}{h^2} \\cdot h = -\\frac{1}{h} $$\nBy symmetry, $K_{i,i-1} = -1/h$. For $|i-j|>1$, $K_{ij}=0$. Thus, $K$ is the $(N-1) \\times (N-1)$ tridiagonal matrix:\n$$ K = \\frac{1}{h} \\begin{pmatrix} 2 & -1 & 0 & \\dots \\\\ -1 & 2 & -1 & \\\\ 0 & \\ddots & \\ddots & \\ddots \\\\ \\vdots & & -1 & 2 & -1 \\\\ & \\dots & 0 & -1 & 2 \\end{pmatrix} $$\n\n**Mass Matrix $M$:**\nThe entry $M_{ij} = \\int_{0}^{1} \\phi_i(x)\\phi_j(x)dx$ is non-zero only for $|i-j| \\le 1$.\n- Diagonal entries ($i=j$):\n$$ M_{ii} = \\int_{x_{i-1}}^{x_{i+1}} (\\phi_i(x))^2 dx = \\int_{x_{i-1}}^{x_i} \\left(\\frac{x-x_{i-1}}{h}\\right)^2 dx + \\int_{x_i}^{x_{i+1}} \\left(\\frac{x_{i+1}-x}{h}\\right)^2 dx = 2 \\int_0^h \\left(\\frac{y}{h}\\right)^2 dy = \\frac{2}{h^2} \\left[\\frac{y^3}{3}\\right]_0^h = \\frac{2h}{3} $$\n- Off-diagonal entries ($j=i+1$):\n$$ M_{i,i+1} = \\int_{x_i}^{x_{i+1}} \\phi_i(x)\\phi_{i+1}(x) dx = \\int_{x_i}^{x_{i+1}} \\left(\\frac{x_{i+1}-x}{h}\\right)\\left(\\frac{x-x_i}{h}\\right) dx = \\int_0^h \\left(\\frac{h-y}{h}\\right)\\left(\\frac{y}{h}\\right) dy = \\frac{1}{h^2} \\left[ \\frac{hy^2}{2} - \\frac{y^3}{3} \\right]_0^h = \\frac{h}{6} $$\nBy symmetry, $M_{i,i-1} = h/6$. Thus, $M$ is the $(N-1) \\times (N-1)$ tridiagonal matrix:\n$$ M = \\frac{h}{6} \\begin{pmatrix} 4 & 1 & 0 & \\dots \\\\ 1 & 4 & 1 & \\\\ 0 & \\ddots & \\ddots & \\ddots \\\\ \\vdots & & 1 & 4 & 1 \\\\ & \\dots & 0 & 1 & 4 \\end{pmatrix} $$\n\n**Symmetry and Positive Definiteness of $A(\\sigma)$:**\nFrom their definitions, $K_{ij}=K_{ji}$ and $M_{ij}=M_{ji}$, so both $K$ and $M$ are symmetric. Consequently, $A(\\sigma)=K+\\sigma M$ is symmetric for any $\\sigma \\in \\mathbb{R}$.\nFor any non-zero vector $\\mathbf{c} \\in \\mathbb{R}^{N-1}$, let $u_h(x) = \\sum_{k=1}^{N-1} c_k \\phi_k(x)$ be the corresponding finite element function. Since $\\mathbf{c} \\neq \\mathbf{0}$, $u_h(x)$ is not identically zero.\nThe quadratic form for $K$ is $\\mathbf{c}^T K \\mathbf{c} = \\int_0^1 (u_h'(x))^2 dx = \\|u_h'\\|_{L^2}^2$. By the Poincaré inequality for $H_0^1(\\Omega)$, if $u_h' \\equiv 0$, then $u_h \\equiv 0$, which implies $\\mathbf{c}=\\mathbf{0}$. Thus, for $\\mathbf{c} \\neq \\mathbf{0}$, $\\mathbf{c}^T K \\mathbf{c} > 0$, so $K$ is positive definite.\nThe quadratic form for $M$ is $\\mathbf{c}^T M \\mathbf{c} = \\int_0^1 (u_h(x))^2 dx = \\|u_h\\|_{L^2}^2$. Since $u_h$ is continuous and not identically zero, $\\|u_h\\|_{L^2}^2 > 0$. Thus, $M$ is positive definite.\nFor $\\sigma \\ge 0$, the quadratic form for $A(\\sigma)$ is:\n$$ \\mathbf{c}^T A(\\sigma) \\mathbf{c} = \\mathbf{c}^T K \\mathbf{c} + \\sigma \\mathbf{c}^T M \\mathbf{c} $$\nSince $K$ is positive definite, $\\mathbf{c}^T K \\mathbf{c} > 0$. Since $M$ is positive definite and $\\sigma \\ge 0$, $\\sigma \\mathbf{c}^T M \\mathbf{c} \\ge 0$. The sum is therefore strictly positive for any $\\mathbf{c} \\neq \\mathbf{0}$. Thus, $A(\\sigma)$ is symmetric and positive definite for all $\\sigma \\ge 0$.\n\n**2. Effect of the Reaction Term on the Spectrum**\nWe consider the generalized eigenvalue problem $K\\mathbf{x} = \\lambda M\\mathbf{x}$. Let $(\\lambda_j, \\mathbf{x}_j)$ be an eigenpair, where $\\lambda_j$ is a generalized eigenvalue and $\\mathbf{x}_j$ is the corresponding generalized eigenvector.\nWe are interested in the spectrum of the matrix $M^{-1}A(\\sigma)$, whose eigenvalues determine the condition number with respect to the $M$-weighted inner product. Since $M$ is SPD, it is invertible.\nLet's apply the matrix $M^{-1}A(\\sigma)$ to a generalized eigenvector $\\mathbf{x}_j$:\n$$ M^{-1}A(\\sigma)\\mathbf{x}_j = M^{-1}(K + \\sigma M)\\mathbf{x}_j = M^{-1}(K\\mathbf{x}_j) + M^{-1}(\\sigma M\\mathbf{x}_j) $$\nUsing the definition of the generalized eigenproblem, $K\\mathbf{x}_j = \\lambda_j M\\mathbf{x}_j$, which implies $M^{-1}K\\mathbf{x}_j = \\lambda_j \\mathbf{x}_j$.\nThe second term simplifies to $\\sigma M^{-1}M\\mathbf{x}_j = \\sigma I \\mathbf{x}_j = \\sigma \\mathbf{x}_j$.\nCombining these results, we get:\n$$ M^{-1}A(\\sigma)\\mathbf{x}_j = \\lambda_j \\mathbf{x}_j + \\sigma \\mathbf{x}_j = (\\lambda_j + \\sigma)\\mathbf{x}_j $$\nThis shows that if $\\mathbf{x}_j$ is a generalized eigenvector of the pair $(K,M)$ with eigenvalue $\\lambda_j$, then it is also an eigenvector of $M^{-1}A(\\sigma)$ with eigenvalue $\\sigma + \\lambda_j$. Therefore, the spectrum of $M^{-1}A(\\sigma)$ is a simple shift of the generalized spectrum of $(K,M)$ by the amount $\\sigma$.\n\n**3. Closed-Form Generalized Eigenvalues $\\lambda_j$**\nThe matrices $K$ and $M$ are tridiagonal Toeplitz-like matrices. They share a common set of eigenvectors, which are discrete sine vectors. Let the eigenvector $\\mathbf{v}_j$ have components $(\\mathbf{v}_j)_k = \\sin(j \\pi x_k) = \\sin(j \\pi k h)$ for $k=1, \\dots, N-1$.\nLet's compute the action of $K$ and $M$ on $\\mathbf{v}_j$. The $k$-th component is:\n$$ (K\\mathbf{v}_j)_k = \\frac{1}{h} \\left( -(\\mathbf{v}_j)_{k-1} + 2(\\mathbf{v}_j)_k - (\\mathbf{v}_j)_{k+1} \\right) = \\frac{1}{h} \\Big( -\\sin(j\\pi(k-1)h) + 2\\sin(j\\pi kh) - \\sin(j\\pi(k+1)h) \\Big) $$\nUsing $\\sin(A-B)+\\sin(A+B)=2\\sin A \\cos B$:\n$$ (K\\mathbf{v}_j)_k = \\frac{1}{h} \\left( 2\\sin(j\\pi kh) - 2\\sin(j\\pi kh)\\cos(j\\pi h) \\right) = \\frac{2}{h}(1-\\cos(j\\pi h))\\sin(j\\pi kh) $$\nUsing the half-angle identity $1-\\cos\\theta=2\\sin^2(\\theta/2)$:\n$$ (K\\mathbf{v}_j)_k = \\frac{4}{h}\\sin^2\\left(\\frac{j\\pi h}{2}\\right) (\\mathbf{v}_j)_k $$\nSimilarly for the mass matrix $M$:\n$$ (M\\mathbf{v}_j)_k = \\frac{h}{6} \\left( (\\mathbf{v}_j)_{k-1} + 4(\\mathbf{v}_j)_k + (\\mathbf{v}_j)_{k+1} \\right) = \\frac{h}{6} \\left( 2\\sin(j\\pi kh)\\cos(j\\pi h) + 4\\sin(j\\pi kh) \\right) = \\frac{h}{3}(2+\\cos(j\\pi h))(\\mathbf{v}_j)_k $$\nThe generalized eigenvalue problem $K\\mathbf{v}_j = \\lambda_j M\\mathbf{v}_j$ becomes:\n$$ \\frac{4}{h}\\sin^2\\left(\\frac{j\\pi h}{2}\\right) \\mathbf{v}_j = \\lambda_j \\frac{h}{3}(2+\\cos(j\\pi h)) \\mathbf{v}_j $$\nSolving for $\\lambda_j$:\n$$ \\lambda_j = \\frac{\\frac{4}{h}\\sin^2(\\frac{j\\pi h}{2})}{\\frac{h}{3}(2+\\cos(j\\pi h))} = \\frac{12}{h^2} \\frac{\\sin^2(\\frac{j\\pi h}{2})}{2+\\cos(j\\pi h)} $$\nUsing $\\cos\\theta = 1-2\\sin^2(\\theta/2)$, the denominator is $2+(1-2\\sin^2(j\\pi h/2)) = 3-2\\sin^2(j\\pi h/2)$.\nSo, the generalized eigenvalues for $j=1, \\dots, N-1$ are:\n$$ \\lambda_j = \\frac{12}{h^2} \\frac{\\sin^2\\left(\\frac{j\\pi h}{2}\\right)}{3-2\\sin^2\\left(\\frac{j\\pi h}{2}\\right)} $$\nSubstituting $h=1/N$:\n$$ \\lambda_j = 12N^2 \\frac{\\sin^2\\left(\\frac{j\\pi}{2N}\\right)}{3-2\\sin^2\\left(\\frac{j\\pi}{2N}\\right)} $$\n\n**4. Exact Analytic Expression for the Condition Number**\nThe spectral condition number in the $M$-weighted inner product is given by $\\kappa_{M}(A(\\sigma)) = \\frac{\\max_k(\\sigma+\\lambda_k)}{\\min_k(\\sigma+\\lambda_k)} = \\frac{\\sigma + \\lambda_{\\max}}{\\sigma + \\lambda_{\\min}}$.\nTo find $\\lambda_{\\min}$ and $\\lambda_{\\max}$, we analyze the dependence of $\\lambda_j$ on $j$. Let $z = \\sin^2(j\\pi/(2N))$. The function is $f(z) = \\frac{z}{3-2z}$. Its derivative is $f'(z) = \\frac{3}{(3-2z)^2} > 0$. Since $j\\pi/(2N)$ is in $(0, \\pi/2)$ for $j=1, \\dots, N-1$, $\\sin(j\\pi/(2N))$ is an increasing function of $j$, so $z$ is increasing with $j$. Therefore, $\\lambda_j$ is a monotonically increasing function of $j$.\nThe minimum eigenvalue $\\lambda_{\\min}$ corresponds to $j=1$:\n$$ \\lambda_{\\min} = \\lambda_1 = 12N^2 \\frac{\\sin^2\\left(\\frac{\\pi}{2N}\\right)}{3-2\\sin^2\\left(\\frac{\\pi}{2N}\\right)} $$\nThe maximum eigenvalue $\\lambda_{\\max}$ corresponds to $j=N-1$:\n$$ \\lambda_{\\max} = \\lambda_{N-1} = 12N^2 \\frac{\\sin^2\\left(\\frac{(N-1)\\pi}{2N}\\right)}{3-2\\sin^2\\left(\\frac{(N-1)\\pi}{2N}\\right)} $$\nUsing $\\sin\\left(\\frac{(N-1)\\pi}{2N}\\right) = \\sin\\left(\\frac{\\pi}{2}-\\frac{\\pi}{2N}\\right) = \\cos\\left(\\frac{\\pi}{2N}\\right)$:\n$$ \\lambda_{\\max} = 12N^2 \\frac{\\cos^2\\left(\\frac{\\pi}{2N}\\right)}{3-2\\cos^2\\left(\\frac{\\pi}{2N}\\right)} $$\nSubstituting these into the expression for the condition number gives the final analytic expression:\n$$ \\kappa_{M}(A(\\sigma)) = \\frac{\\sigma + 12N^2 \\frac{\\cos^2\\left(\\frac{\\pi}{2N}\\right)}{3-2\\cos^2\\left(\\frac{\\pi}{2N}\\right)}}{\\sigma + 12N^2 \\frac{\\sin^2\\left(\\frac{\\pi}{2N}\\right)}{3-2\\sin^2\\left(\\frac{\\pi}{2N}\\right)}} $$\n\n**5. Asymptotic Behavior for $\\sigma \\to \\infty$**\nTo find the leading-order asymptotic behavior of $\\kappa_{M}(A(\\sigma))$ as $\\sigma \\to \\infty$, we take the limit:\n$$ \\lim_{\\sigma \\to \\infty} \\kappa_{M}(A(\\sigma)) = \\lim_{\\sigma \\to \\infty} \\frac{\\sigma + \\lambda_{\\max}}{\\sigma + \\lambda_{\\min}} = \\lim_{\\sigma \\to \\infty} \\frac{1 + \\lambda_{\\max}/\\sigma}{1 + \\lambda_{\\min}/\\sigma} $$\nSince for a fixed mesh size $N$, $\\lambda_{\\min}$ and $\\lambda_{\\max}$ are fixed positive constants, we have $\\lambda_{\\max}/\\sigma \\to 0$ and $\\lambda_{\\min}/\\sigma \\to 0$ as $\\sigma \\to \\infty$.\nTherefore, the limit is:\n$$ \\lim_{\\sigma \\to \\infty} \\kappa_{M}(A(\\sigma)) = \\frac{1+0}{1+0} = 1 $$\nThe leading-order asymptotic behavior is that the condition number approaches $1$. This is because for large $\\sigma$, the operator $A(\\sigma) = K + \\sigma M \\approx \\sigma M$. The condition number of $M^{-1}(\\sigma M) = \\sigma M^{-1}M = \\sigma I$ is the condition number of the identity matrix (scaled), which is $1$. The reaction term dominates the stiffness term, making the system matrix behave like a well-conditioned (scaled) mass matrix.",
            "answer": "$$ \\boxed{ \\frac{\\sigma + 12N^{2} \\frac{\\cos^{2}\\left(\\frac{\\pi}{2N}\\right)}{3-2\\cos^{2}\\left(\\frac{\\pi}{2N}\\right)}}{\\sigma + 12N^{2} \\frac{\\sin^{2}\\left(\\frac{\\pi}{2N}\\right)}{3-2\\sin^{2}\\left(\\frac{\\pi}{2N}\\right)}} } $$"
        }
    ]
}