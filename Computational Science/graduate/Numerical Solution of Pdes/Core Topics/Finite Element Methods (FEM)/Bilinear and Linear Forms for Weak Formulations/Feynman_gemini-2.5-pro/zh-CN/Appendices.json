{
    "hands_on_practices": [
        {
            "introduction": "本练习将引导你完成从偏微分方程（PDE）推导弱形式的基础过程。我们将重点关注诺伊曼（Neumann）边界条件（通常称为“自然”边界条件）如何巧妙地融入线性泛函中，而不是强加于解空间之上。通过一个具体的计算示例，你将亲手实践如何构建双线性和线性形式，这是有限元分析中的一项核心技能。",
            "id": "3366921",
            "problem": "考虑一个标量扩散偏微分方程（PDE），它定义在一个有界利普希茨域 $\\Omega \\subset \\mathbb{R}^{d}$ 上，带有诺伊曼边界条件，其外单位法向量为 $\\boldsymbol{n}$：\n$$\n- \\nabla \\cdot (\\kappa \\nabla u) = f \\quad \\text{in } \\Omega, \n\\qquad \\kappa \\nabla u \\cdot \\boldsymbol{n} = g \\quad \\text{on } \\partial \\Omega,\n$$\n其中 $\\kappa \\in L^{\\infty}(\\Omega)$是一致正的，$f \\in H^{-1}(\\Omega)$，$g \\in H^{-1/2}(\\partial \\Omega)$，且 $\\gamma: H^{1}(\\Omega) \\to H^{1/2}(\\partial \\Omega)$ 表示迹算子。从适用于足够光滑函数的散度定理和格林恒等式出发，通过确定双线性形式 $a(u,v)$ 和 $H^{1}(\\Omega)$ 上的线性泛函 $L(v)$ 来推导其弱形式，并精确解释自然诺伊曼边界条件是如何在线性泛函 $L(v)$ 中出现的。\n\n然后，具体考虑情况 $\\kappa \\equiv 1$，$\\Omega = \\{ x \\in \\mathbb{R}^{2} : |x|  1 \\}$，选择检验函数 $v(x) = |x|^{2}$，并令 $\\Omega$ 内的 $f(x) = 3 - 2|x|^{2}$ 以及 $\\partial \\Omega$ 上的 $g \\equiv 5$。计算该线性泛函的值\n$$\nL(v) = \\int_{\\Omega} f\\, v \\, dx + \\int_{\\partial \\Omega} g \\, \\gamma v \\, ds.\n$$\n请给出精确的最终答案；无需四舍五入。最终答案必须是一个不带单位的实数。",
            "solution": "该问题被评估为有效，因为它在数学上是合理的、自洽的，并且在偏微分方程的标准理论框架内是适定的。\n\n该问题包含两个部分。首先，我们推导一个一般标量扩散方程的弱形式。其次，我们计算一个特定情况下线性泛函的值。\n\n第一部分：弱形式的推导\n\n偏微分方程（PDE）的强形式由下式给出：\n$$\n- \\nabla \\cdot (\\kappa \\nabla u) = f \\quad \\text{in } \\Omega, \\quad (1)\n$$\n附带诺伊曼边界条件：\n$$\n\\kappa \\nabla u \\cdot \\boldsymbol{n} = g \\quad \\text{on } \\partial \\Omega, \\quad (2)\n$$\n其中 $u$ 是未知解。弱形式是通过在合适的函数空间（此处为 $H^{1}(\\Omega)$）中寻找一个解 $u$ 来得到的，该解使得一个积分恒等式对所有来自同一空间的检验函数 $v$ 成立。\n\n我们首先将方程（1）乘以一个任意的检验函数 $v \\in H^{1}(\\Omega)$，然后在区域 $\\Omega$ 上积分：\n$$\n- \\int_{\\Omega} (\\nabla \\cdot (\\kappa \\nabla u)) v \\, dx = \\int_{\\Omega} f v \\, dx. \\quad (3)\n$$\n推导弱形式的核心步骤是对左侧项应用散度定理（通常以格林第一恒等式的形式）。格林第一恒等式指出，对于一个向量场 $\\boldsymbol{F}$ 和一个标量场 $\\phi$（具有足够的正则性），\n$$\n\\int_{\\Omega} (\\nabla \\cdot \\boldsymbol{F}) \\phi \\, dx = \\int_{\\partial \\Omega} (\\boldsymbol{F} \\cdot \\boldsymbol{n}) \\phi \\, ds - \\int_{\\Omega} \\boldsymbol{F} \\cdot \\nabla \\phi \\, dx.\n$$\n我们将向量场定义为 $\\boldsymbol{F} = \\kappa \\nabla u$，标量场定义为 $\\phi = v$。将此恒等式应用于方程（3）的左侧，得到：\n$$\n- \\left( \\int_{\\partial \\Omega} (\\kappa \\nabla u \\cdot \\boldsymbol{n}) v \\, ds - \\int_{\\Omega} (\\kappa \\nabla u) \\cdot \\nabla v \\, dx \\right) = \\int_{\\Omega} f v \\, dx.\n$$\n分配负号后，我们得到：\n$$\n\\int_{\\Omega} (\\kappa \\nabla u) \\cdot \\nabla v \\, dx - \\int_{\\partial \\Omega} (\\kappa \\nabla u \\cdot \\boldsymbol{n}) v \\, ds = \\int_{\\Omega} f v \\, dx. \\quad (4)\n$$\n此时，我们引入诺伊曼边界条件（2）。出现在边界积分中的项 $\\kappa \\nabla u \\cdot \\boldsymbol{n}$ 被给定的函数 $g$ 替换。这正是自然诺伊曼边界条件在弱形式中出现的方式：它被代入到由分部积分自然产生的边界积分中。这种代换将一个关于解 $u$ 的条件转换成一个已知的数据项。\n用 $g$ 替换 $\\kappa \\nabla u \\cdot \\boldsymbol{n}$，我们得到：\n$$\n\\int_{\\Omega} \\kappa \\nabla u \\cdot \\nabla v \\, dx - \\int_{\\partial \\Omega} g v \\, ds = \\int_{\\Omega} f v \\, dx.\n$$\n重新整理各项，将所有涉及未知数 $u$ 的表达式分离到左边，将所有涉及已知数据和检验函数 $v$ 的项分离到右边，我们得到最终的弱形式：\n$$\n\\int_{\\Omega} \\kappa \\nabla u \\cdot \\nabla v \\, dx = \\int_{\\Omega} f v \\, dx + \\int_{\\partial \\Omega} g v \\, ds.\n$$\n现在问题就变成了找到 $u \\in H^{1}(\\Omega)$，使得该方程对所有 $v \\in H^{1}(\\Omega)$ 成立。我们可以确定双线性形式 $a(u,v)$ 和线性泛函 $L(v)$：\n双线性形式是：\n$$\na(u,v) = \\int_{\\Omega} \\kappa \\nabla u \\cdot \\nabla v \\, dx.\n$$\n线性泛函是：\n$$\nL(v) = \\int_{\\Omega} f v \\, dx + \\int_{\\partial \\Omega} g v \\, ds.\n$$\n对于函数 $f \\in H^{-1}(\\Omega)$ 和 $g \\in H^{-1/2}(\\partial \\Omega)$，这些积分更严谨地解释为对偶配对：$L(v) = \\langle f, v \\rangle_{H^{-1}(\\Omega), H^{1}(\\Omega)} + \\langle g, \\gamma v \\rangle_{H^{-1/2}(\\partial\\Omega), H^{1/2}(\\partial\\Omega)}$，其中 $\\gamma v$ 是 $v$ 在 $\\partial\\Omega$ 上的迹。\n\n第二部分：线性泛函的计算\n\n我们需要计算在特定情况下的 $L(v)$：\n- 系数：$\\kappa = 1$。\n- 区域：$\\Omega = \\{ x \\in \\mathbb{R}^{2} : |x|  1 \\}$，单位圆盘。\n- 检验函数：$v(x) = |x|^{2}$。\n- 源项：$f(x) = 3 - 2|x|^{2}$。\n- 边界数据：$g(x) = 5$ 对于 $x \\in \\partial\\Omega$。\n\n线性泛函为 $L(v) = \\int_{\\Omega} f\\, v \\, dx + \\int_{\\partial \\Omega} g \\, \\gamma v \\, ds$。我们分别计算这两个积分。\n\n1.  区域积分：$\\int_{\\Omega} f v \\, dx$\n被积函数为 $f(x)v(x) = (3 - 2|x|^{2}) |x|^{2} = 3|x|^{2} - 2|x|^{4}$。\n为了在单位圆盘上计算该积分，我们切换到极坐标。在极坐标中，$x = (r\\cos\\theta, r\\sin\\theta)$，所以 $|x| = r$。面积微元为 $dx = r \\, dr \\, d\\theta$。区域 $\\Omega$ 由 $0 \\le r \\le 1$ 和 $0 \\le \\theta \\le 2\\pi$ 描述。\n积分为：\n$$\n\\int_{\\Omega} (3|x|^2 - 2|x|^4) \\, dx = \\int_{0}^{2\\pi} \\int_{0}^{1} (3r^2 - 2r^4) r \\, dr \\, d\\theta.\n$$\n被积函数不依赖于 $\\theta$，所以关于 $\\theta$ 的积分产生一个因子 $2\\pi$：\n$$\n2\\pi \\int_{0}^{1} (3r^3 - 2r^5) \\, dr.\n$$\n现在我们计算径向积分：\n$$\n\\int_{0}^{1} (3r^3 - 2r^5) \\, dr = \\left[ 3\\frac{r^4}{4} - 2\\frac{r^6}{6} \\right]_{0}^{1} = \\left[ \\frac{3}{4}r^4 - \\frac{1}{3}r^6 \\right]_{0}^{1}.\n$$\n在积分上下限处计算反导数：\n$$\n\\left( \\frac{3}{4}(1)^4 - \\frac{1}{3}(1)^6 \\right) - \\left( \\frac{3}{4}(0)^4 - \\frac{1}{3}(0)^6 \\right) = \\frac{3}{4} - \\frac{1}{3} = \\frac{9-4}{12} = \\frac{5}{12}.\n$$\n因此，区域积分为 $2\\pi \\times \\frac{5}{12} = \\frac{5\\pi}{6}$。\n\n2.  边界积分：$\\int_{\\partial \\Omega} g \\, \\gamma v \\, ds$\n边界 $\\partial \\Omega$ 是单位圆，其上 $|x|=1$。\n函数 $g$ 在边界上是常数：$g = 5$。\n检验函数 $v(x)=|x|^2$ 在边界上的迹为 $\\gamma v = v|_{\\partial\\Omega}$。在 $\\partial\\Omega$ 上，有 $|x|=1$，所以 $\\gamma v = 1^2 = 1$。\n积分为：\n$$\n\\int_{\\partial \\Omega} g \\, \\gamma v \\, ds = \\int_{\\partial \\Omega} 5 \\cdot 1 \\, ds = 5 \\int_{\\partial \\Omega} ds.\n$$\n积分 $\\int_{\\partial \\Omega} ds$ 就是边界 $\\partial \\Omega$ 的长度（周长）。对于单位圆，半径为 $R=1$，所以周长为 $2\\pi R = 2\\pi(1) = 2\\pi$。\n因此，边界积分为 $5 \\times (2\\pi) = 10\\pi$。\n\n最后，我们将两部分相加得到 $L(v)$：\n$$\nL(v) = \\frac{5\\pi}{6} + 10\\pi = \\frac{5\\pi}{6} + \\frac{60\\pi}{6} = \\frac{65\\pi}{6}.\n$$",
            "answer": "$$\n\\boxed{\\frac{65\\pi}{6}}\n$$"
        },
        {
            "introduction": "将连续的双线性形式转化为离散的刚度矩阵需要使用数值积分。本练习探讨了一个关键问题：为确保有限元方法的保真度，我们的求积法则必须达到多高的精度才能精确计算矩阵元。这对于实际编写有限元求解器而言，是一个连接理论与实践的重要考量。",
            "id": "3366941",
            "problem": "考虑在有界Lipschitz域 $\\Omega \\subset \\mathbb{R}^d$（其中 $d \\in \\{2,3\\}$）上的二阶线性偏微分方程，\n$$\n- \\nabla \\cdot \\big(\\kappa(\\boldsymbol{x}) \\nabla u(\\boldsymbol{x})\\big) + \\boldsymbol{\\beta}(\\boldsymbol{x}) \\cdot \\nabla u(\\boldsymbol{x}) + c(\\boldsymbol{x})\\, u(\\boldsymbol{x}) = f(\\boldsymbol{x}) \\quad \\text{in } \\Omega,\n$$\n其在 $\\partial \\Omega$ 上具有齐次Dirichlet边界条件。在一个由单纯形组成的仿射、形状规则的网格 $\\mathcal{T}_h$ 上，考虑次数为 $k \\ge 1$ 的连续Lagrange有限元空间 $V_h \\subset H_0^1(\\Omega)$，即 $V_h = \\{ v_h \\in C^0(\\overline{\\Omega}) : v_h|_K \\in P_k(K) \\ \\forall K \\in \\mathcal{T}_h, \\ v_h|_{\\partial \\Omega}=0\\}$。Galerkin双线性形式为\n$$\na(u,v) = \\sum_{K \\in \\mathcal{T}_h} \\left[ \\int_K \\kappa(\\boldsymbol{x}) \\, \\nabla u \\cdot \\nabla v \\, \\mathrm{d}\\boldsymbol{x} + \\int_K \\boldsymbol{\\beta}(\\boldsymbol{x}) \\cdot \\nabla u \\, v \\, \\mathrm{d}\\boldsymbol{x} + \\int_K c(\\boldsymbol{x}) \\, u \\, v \\, \\mathrm{d}\\boldsymbol{x} \\right].\n$$\n假设在每个单元 $K$ 上，$\\kappa|_K \\in P_{q_\\kappa}(K)$、$\\boldsymbol{\\beta}|_K \\in [P_{q_\\beta}(K)]^d$ 和 $c|_K \\in P_{q_c}(K)$ 分别是次数为 $q_\\kappa, q_\\beta, q_c \\in \\mathbb{N}_0$ 的多项式。每个单元刚度矩阵 $A^K \\in \\mathbb{R}^{n_K \\times n_K}$ 由元素 $A^K_{ij} = a_K(\\varphi_j,\\varphi_i)$ 定义，其中 $\\{\\varphi_i\\}_{i=1}^{n_K}$ 是 $V_h|_K$ 的局部节点基，且\n$$\na_K(u,v) = \\int_K \\kappa \\, \\nabla u \\cdot \\nabla v \\, \\mathrm{d}\\boldsymbol{x} + \\int_K \\boldsymbol{\\beta} \\cdot \\nabla u \\, v \\, \\mathrm{d}\\boldsymbol{x} + \\int_K c \\, u \\, v \\, \\mathrm{d}\\boldsymbol{x}.\n$$\n为了进行数值积分，使用了一个多项式精确次数为 $m$ 的单元求积法则 $Q_K$：$Q_K[p] = \\int_K p \\, \\mathrm{d}\\boldsymbol{x}$ 对所有多项式 $p \\in P_m(K)$ 成立。\n\n以下哪个陈述正确地指明了求积精确次数 $m$ 的一个充分条件，以保证在仿射单元上所有单元刚度矩阵元素 $A^K_{ij}$ 的精确计算，并正确地描述了积分不足（即使用小于该条件的 $m$）对组装矩阵对称性的影响？\n\nA. 在仿射单元上，选择 $m \\ge \\max\\{\\, q_\\kappa + 2k - 2,\\ q_\\beta + 2k - 1,\\ q_c + 2k \\,\\}$ 足以使所有 $A^K_{ij}$ 精确。如果连续双线性形式是对称的（例如 $\\boldsymbol{\\beta} = \\boldsymbol{0}$），那么使用任何对称求积法则的积分不足都会保持矩阵的对称性，尽管它会降低矫顽性和相容性。\n\nB. 选择 $m \\ge q_\\kappa + 2k$ 足以精确计算扩散项的贡献；对流项和反应项的贡献要求不超过 $m \\ge 2k$，无论系数如何。即使连续双线性形式是对称的，积分不足通常也会破坏对称性。\n\nC. 选择 $m \\ge 2k - 2$ 就足够了，无论系数的次数如何。积分不足总是能同时保持刚度矩阵的正定性和对称性。\n\nD. 选择 $m \\ge q_c + 2k$ 就足够了；扩散项和对流项需要更低的阶数。积分不足会产生一个斜对称误差，仅当 $\\boldsymbol{\\beta} \\neq \\boldsymbol{0}$ 时才使组装矩阵非对称。",
            "solution": "用户提供了一个关于在二阶线性偏微分方程（PDE）的有限元法（FEM）背景下，对单元刚度矩阵进行数值积分的问题。任务是验证问题陈述，如果有效，则在给定选项中确定关于所需求积精确次数和积分不足对矩阵对称性影响的正确陈述。\n\n### 问题验证\n\n**第1步：提取已知条件**\n\n*   **PDE:** $- \\nabla \\cdot \\big(\\kappa(\\boldsymbol{x}) \\nabla u(\\boldsymbol{x})\\big) + \\boldsymbol{\\beta}(\\boldsymbol{x}) \\cdot \\nabla u(\\boldsymbol{x}) + c(\\boldsymbol{x})\\, u(\\boldsymbol{x}) = f(\\boldsymbol{x})$，在有界Lipschitz域 $\\Omega \\subset \\mathbb{R}^d$ 上，其中 $d \\in \\{2,3\\}$。\n*   **边界条件:** 在 $\\partial \\Omega$ 上的齐次Dirichlet边界条件。\n*   **网格:** 一个由单纯形组成的仿射、形状规则的网格 $\\mathcal{T}_h$。\n*   **有限元空间:** 次数为 $k \\ge 1$ 的连续Lagrange有限元空间 $V_h \\subset H_0^1(\\Omega)$，定义为 $V_h = \\{ v_h \\in C^0(\\overline{\\Omega}) : v_h|_K \\in P_k(K) \\ \\forall K \\in \\mathcal{T}_h, \\ v_h|_{\\partial \\Omega}=0\\}$。\n*   **Galerkin双线性形式:** $a(u,v) = \\sum_{K \\in \\mathcal{T}_h} \\left[ \\int_K \\kappa(\\boldsymbol{x}) \\, \\nabla u \\cdot \\nabla v \\, \\mathrm{d}\\boldsymbol{x} + \\int_K \\boldsymbol{\\beta}(\\boldsymbol{x}) \\cdot \\nabla u \\, v \\, \\mathrm{d}\\boldsymbol{x} + \\int_K c(\\boldsymbol{x}) \\, u \\, v \\, \\mathrm{d}\\boldsymbol{x} \\right]$。\n*   **系数表示:** 在每个单元 $K$ 上，$\\kappa|_K \\in P_{q_\\kappa}(K)$、$\\boldsymbol{\\beta}|_K \\in [P_{q_\\beta}(K)]^d$ 和 $c|_K \\in P_{q_c}(K)$ 分别是次数为 $q_\\kappa, q_\\beta, q_c \\in \\mathbb{N}_0$ 的多项式。\n*   **单元刚度矩阵:** $A^K \\in \\mathbb{R}^{n_K \\times n_K}$，其元素为 $A^K_{ij} = a_K(\\varphi_j,\\varphi_i)$，其中 $\\{\\varphi_i\\}_{i=1}^{n_K}$ 是 $V_h|_K$ 的局部节点基。\n*   **单元双线性形式:** $a_K(u,v) = \\int_K \\kappa \\, \\nabla u \\cdot \\nabla v \\, \\mathrm{d}\\boldsymbol{x} + \\int_K \\boldsymbol{\\beta} \\cdot \\nabla u \\, v \\, \\mathrm{d}\\boldsymbol{x} + \\int_K c \\, u \\, v \\, \\mathrm{d}\\boldsymbol{x}$。\n*   **数值求积:** 使用单元求积法则 $Q_K$，它对所有多项式 $p \\in P_m(K)$ 是精确的，即 $Q_K[p] = \\int_K p \\, \\mathrm{d}\\boldsymbol{x}$。\n\n**第2步：使用提取的已知条件进行验证**\n\n1.  **科学上成立：** 该问题牢固地植根于偏微分方程数值分析理论，特别是有限元方法。所有概念，包括偏微分方程、弱形式、有限元空间和数值积分，都是标准且明确定义的。\n2.  **适定的：** 该问题要求为精确积分找到求积阶数 $m$ 的一个充分条件，这是数值分析中一个精确定义的问题。对积分不足影响的分析也是一个标准课题。\n3.  **客观的：** 语言是形式化的、数学的，并且没有主观内容。\n4.  **完整且一致的：** 提供了所有必要的信息。偏微分方程、有限元空间、系数的多项式性质以及刚度矩阵的定义都得到了清晰的说明。仿射网格的假设是一种标准的简化，它确保了在从参考单元映射下多项式次数得以保持。\n\n**第3步：结论与行动**\n\n问题陈述是有效的。这是一个来自数值数学领域的适定的、科学上成立的问题。我现在将开始推导解答。\n\n### 解答的推导\n\n单元刚度矩阵 $A^K$ 的元素由 $A^K_{ij} = a_K(\\varphi_j, \\varphi_i)$ 给出。要使用求积法则精确计算这些元素，该法则必须对 $a_K(\\varphi_j, \\varphi_i)$ 中每一项的被积函数都是精确的。基函数 $\\varphi_i, \\varphi_j$ 是单元 $K$ 上次数至多为 $k$ 的多项式，即 $\\varphi_i, \\varphi_j \\in P_k(K)$。因此，它们的梯度 $\\nabla \\varphi_i, \\nabla \\varphi_j$ 是向量场，其分量是次数至多为 $k-1$ 的多项式，即 $\\nabla \\varphi_i, \\nabla \\varphi_j \\in [P_{k-1}(K)]^d$。我们分析 $a_K$ 中三项各自被积函数的多项式次数。\n\n1.  **扩散项：** 被积函数为 $\\kappa(\\boldsymbol{x}) \\, \\nabla \\varphi_j \\cdot \\nabla \\varphi_i$。\n    *   $\\kappa \\in P_{q_\\kappa}(K)$。\n    *   $\\nabla \\varphi_j \\in [P_{k-1}(K)]^d$ 且 $\\nabla \\varphi_i \\in [P_{k-1}(K)]^d$。\n    *   点积 $\\nabla \\varphi_j \\cdot \\nabla \\varphi_i$ 是次数为 $k-1$ 的多项式的乘积之和，结果是一个次数最高为 $(k-1) + (k-1) = 2k-2$ 的多项式。\n    *   总乘积 $\\kappa (\\nabla \\varphi_j \\cdot \\nabla \\varphi_i)$ 是一个次数为 $q_\\kappa$ 的多项式和一个次数为 $2k-2$ 的多项式的乘积。所得多项式的次数最高为 $q_\\kappa + 2k - 2$。\n\n2.  **对流项：** 被积函数为 $\\boldsymbol{\\beta}(\\boldsymbol{x}) \\cdot \\nabla \\varphi_j \\, \\varphi_i$。\n    *   $\\boldsymbol{\\beta} \\in [P_{q_\\beta}(K)]^d$。\n    *   $\\nabla \\varphi_j \\in [P_{k-1}(K)]^d$。\n    *   $\\varphi_i \\in P_k(K)$。\n    *   点积 $\\boldsymbol{\\beta} \\cdot \\nabla \\varphi_j$ 得到一个次数最高为 $q_\\beta + (k-1)$ 的多项式。\n    *   随后与 $\\varphi_i$ 相乘，得到一个次数最高为 $(q_\\beta + k - 1) + k = q_\\beta + 2k - 1$ 的多项式。\n\n3.  **反应项：** 被积函数为 $c(\\boldsymbol{x}) \\, \\varphi_j \\, \\varphi_i$。\n    *   $c \\in P_{q_c}(K)$。\n    *   $\\varphi_j, \\varphi_i \\in P_k(K)$。\n    *   乘积 $\\varphi_j \\varphi_i$ 是一个次数最高为 $k+k = 2k$ 的多项式。\n    *   总乘积 $c (\\varphi_j \\varphi_i)$ 是一个次数最高为 $q_c + 2k$ 的多项式。\n\n为保证对所有项的积分都是精确的，求积法则必须对遇到的最高次数的多项式是精确的。因此，精确次数 $m$ 必须满足：\n$$\nm \\ge \\max\\{ q_\\kappa + 2k - 2, \\ q_\\beta + 2k - 1, \\ q_c + 2k \\}\n$$\n\n接下来，我们分析积分不足对组装矩阵对称性的影响。精确的单元刚度矩阵 $A^K$ 是对称的，如果对所有 $i,j$ 都有 $A^K_{ij} = A^K_{ji}$。根据定义 $A^K_{ij} = a_K(\\varphi_j, \\varphi_i)$，对称性要求 $a_K(\\varphi_j, \\varphi_i) = a_K(\\varphi_i, \\varphi_j)$。双线性形式 $a_K(u,v)$ 是对称的当且仅当 $a_K(u,v) = a_K(v,u)$。\n扩散项和反应项在 $u$ 和 $v$ 中是对称的。对流项 $\\int_K \\boldsymbol{\\beta} \\cdot \\nabla u \\, v \\, \\mathrm{d}\\boldsymbol{x}$ 不是对称的。因此，连续双线性形式 $a_K$ 是对称的当且仅当 $\\boldsymbol{\\beta} = \\boldsymbol{0}$。\n\n现在，考虑使用数值积分得到的矩阵 $A_h^K$。其元素为 $(A_h^K)_{ij} = a_h^K(\\varphi_j, \\varphi_i)$，其中 $a_h^K$ 是积分被求积算子 $Q_K$ 替换后的双线性形式。\n如果连续形式是对称的（即 $\\boldsymbol{\\beta} = \\boldsymbol{0}$），则 $a_K(u,v) = \\int_K (\\kappa \\nabla u \\cdot \\nabla v + c u v) \\, \\mathrm{d}\\boldsymbol{x}$。\n$a_K(\\varphi_j, \\varphi_i)$ 和 $a_K(\\varphi_i, \\varphi_j)$ 的被积函数分别为：\n$I_{ji}(\\boldsymbol{x}) = \\kappa \\nabla \\varphi_j \\cdot \\nabla \\varphi_i + c \\varphi_j \\varphi_i$\n$I_{ij}(\\boldsymbol{x}) = \\kappa \\nabla \\varphi_i \\cdot \\nabla \\varphi_j + c \\varphi_i \\varphi_j$\n由于标量积和点积的交换律，$I_{ji}(\\boldsymbol{x}) = I_{ij}(\\boldsymbol{x})$。被积函数是相同的函数。\n数值矩阵的相应元素是 $(A_h^K)_{ij} = Q_K[I_{ji}(\\boldsymbol{x})]$ 和 $(A_h^K)_{ji} = Q_K[I_{ij}(\\boldsymbol{x})]$。因为求积法则 $Q_K$ 是一个应用于相同函数的线性算子，所以结果必须相同：$(A_h^K)_{ij} = (A_h^K)_{ji}$。\n因此，如果连续双线性形式是对称的，那么通过数值积分得到的刚度矩阵也将是对称的，无论积分是否精确（积分不足）。然而，积分不足可能会产生其他有害影响，例如矫顽性的丧失（导致奇异或非正定矩阵）和精度阶数的降低（相容性误差）。\n\n### 逐项分析\n\n**A. 在仿射单元上，选择 $m \\ge \\max\\{\\, q_\\kappa + 2k - 2,\\ q_\\beta + 2k - 1,\\ q_c + 2k \\,\\}$ 足以使所有 $A^K_{ij}$ 精确。如果连续双线性形式是对称的（例如 $\\boldsymbol{\\beta} = \\boldsymbol{0}$），那么使用任何对称求积法则的积分不足都会保持矩阵的对称性，尽管它会降低矫顽性和相容性。**\n*   关于 $m$ 的条件与我们推导的条件完全匹配。\n*   对称性的分析是正确的。如果连续形式是对称的，那么数值积分形式也是对称的，即使存在积分不足。提及“对称求积”是标准的，尽管我们的论证表明任何一致的法则都足够。\n*   关于积分不足会降低矫顽性和相容性的陈述是有限元理论中一个基本且正确的结论。\n*   结论：**正确**。\n\n**B. 选择 $m \\ge q_\\kappa + 2k$ 足以精确计算扩散项的贡献；对流项和反应项的贡献要求不超过 $m \\ge 2k$ 无论系数如何。即使连续双线性形式是对称的，积分不足通常也会破坏对称性。**\n*   扩散项的条件是 $m \\ge q_\\kappa + 2k-2$，而不是 $m \\ge q_\\kappa + 2k$。这是不正确的。\n*   声称对流项和反应项要求 $m \\ge 2k$“无论系数如何”是错误的。次数 $q_\\beta$ 和 $q_c$ 明确地是要求的一部分。\n*   声称积分不足“通常会破坏对称性”是错误的，如我们的分析所示。\n*   结论：**不正确**。\n\n**C. 选择 $m \\ge 2k - 2$ 就足够了，无论系数的次数如何。积分不足总是能同时保持刚度矩阵的正定性和对称性。**\n*   条件 $m \\ge 2k - 2$ 是不充分的，因为它忽略了系数 $\\kappa, \\boldsymbol{\\beta}, c$ 的多项式次数。\n*   声称积分不足“总是能保持……正定性”是错误的。矫顽性的丧失是积分不足的一个众所周知的风险，这可能导致矩阵不是正定的。\n*   结论：**不正确**。\n\n**D. 选择 $m \\ge q_c + 2k$ 就足够了；扩散项和对流项需要更低的阶数。积分不足会产生一个斜对称误差，仅当 $\\boldsymbol{\\beta} \\neq \\boldsymbol{0}$ 时才使组装矩阵非对称。**\n*   条件 $m \\ge q_c + 2k$ 仅仅是反应项的要求。总体的充分条件必须是所有三项要求的最大值。声称其他项需要更低的阶数通常不成立（例如，如果 $q_\\kappa  q_c+2$）。\n*   第二部分的措辞令人困惑，但似乎正确地将非对称性与 $\\boldsymbol{\\beta}$ 项的存在联系起来。然而，非对称性也存在于精确矩阵中；它不是积分不足的产物。但主要的缺陷是关于 $m$ 的条件不正确。\n*   结论：**不正确**。\n\n根据详细分析，只有陈述A是完全正确的。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "双线性形式的选择直接决定了最终代数系统的性质。本练习提供了一个具体的分析，展示了在双线性形式中增加一个反应项，会如何系统性地改变刚度矩阵的特征值和条件数。这为了解离散问题的稳定性与求解器性能提供了深刻的洞见。",
            "id": "3366968",
            "problem": "考虑在区间 $\\Omega=(0,1)$ 上的标量扩散-反应偏微分方程 (PDE)，其带有齐次狄利克雷边界条件：求 $u \\in H_{0}^{1}(\\Omega)$，使得对于所有检验函数 $v \\in H_{0}^{1}(\\Omega)$，\n$$\na_{\\sigma}(u,v) = \\ell(v),\n$$\n其中双线性形式为\n$$\na_{\\sigma}(u,v) = \\int_{0}^{1} u'(x)\\,v'(x)\\,dx + \\sigma \\int_{0}^{1} u(x)\\,v(x)\\,dx,\n$$\n且 $\\ell$ 是 $H_{0}^{1}(\\Omega)$ 上的有界线性泛函。参数 $\\sigma \\ge 0$ 乘于反应项，并被视为一个变量。反应项对应于双线性形式中的附加项 $\\sigma \\int_{\\Omega} u\\,v\\,dx$。\n\n令 $\\{\\phi_{i}\\}_{i=1}^{N-1}$ 表示在具有 $N$ 个单元的均匀网格（网格尺寸 $h = 1/N$）上的标准协调、连续、分段线性有限元基函数，这些基函数在端点处为零，从而产生 $N-1$ 个内部自由度。定义刚度矩阵 $K$ 和质量矩阵 $M$ 如下：\n$$\nK_{ij} = \\int_{0}^{1} \\phi_{i}'(x)\\,\\phi_{j}'(x)\\,dx, \\qquad M_{ij} = \\int_{0}^{1} \\phi_{i}(x)\\,\\phi_{j}(x)\\,dx,\n$$\n并考虑离散算子\n$$\nA(\\sigma) = K + \\sigma M.\n$$\n\n从弱形式以及 $K$ 和 $M$ 的定义出发，执行以下操作：\n\n1. 推导在一维均匀网格下 $K$ 和 $M$ 的精确矩阵元，并证明对于所有 $\\sigma \\ge 0$，$A(\\sigma)$ 是对称正定的。\n2. 通过考虑广义特征问题 $Kx = \\lambda Mx$，解释添加反应项 $\\sigma M$ 如何影响 $A(\\sigma)$ 的离散谱以及关于 $M$ 加权内积的条件数。特别地，论证为何 $M^{-1}A(\\sigma)$ 的谱是广义刚度谱的一个位移，位移量为 $\\sigma$。\n3. 利用均匀网格和离散正弦特征向量所诱导的结构，计算矩阵对 $(K,M)$ 的广义特征值 $\\lambda_{j}$（$j=1,2,\\dots,N-1$）关于 $h$ 和 $N$ 的闭式解。\n4. 使用这些 $\\lambda_{j}$，推导在 $M$ 加权内积下的谱条件数的精确解析表达式，\n$$\n\\kappa_{M}(A(\\sigma)) = \\frac{\\sigma + \\lambda_{\\max}}{\\sigma + \\lambda_{\\min}},\n$$\n其中 $\\lambda_{\\min}$ 和 $\\lambda_{\\max}$ 分别表示 $(K,M)$ 的最小和最大广义特征值。\n5. 确定当 $\\sigma \\to \\infty$ 时 $\\kappa_{M}(A(\\sigma))$ 的主阶渐近行为。\n\n请提供 $\\kappa_{M}(A(\\sigma))$ 作为 $\\sigma$ 和 $N$ 的函数的精确闭式解析表达式作为最终答案。不需要数值近似或四舍五入。你的推导过程应完全自洽，从弱形式和均匀网格的性质出发，并应在概念层面上阐明所添加的反应项如何改变离散谱和条件数。",
            "solution": "用户希望分析一维扩散-反应问题的有限元离散化的性质。这涉及推导有限元矩阵、它们的谱性质以及所得线性系统的条件数。\n\n### 问题验证\n\n**第1步：提取已知条件**\n- **PDE 问题：** 在 $\\Omega=(0,1)$ 上的标量扩散-反应偏微分方程，带有齐次狄利克雷边界条件。\n- **弱形式：** 求 $u \\in H_{0}^{1}(\\Omega)$，使得对所有 $v \\in H_{0}^{1}(\\Omega)$，有 $a_{\\sigma}(u,v) = \\ell(v)$。\n- **双线性形式：** $a_{\\sigma}(u,v) = \\int_{0}^{1} u'(x)\\,v'(x)\\,dx + \\sigma \\int_{0}^{1} u(x)\\,v(x)\\,dx$，其中反应参数 $\\sigma \\ge 0$。\n- **线性泛函：** $\\ell$ 是 $H_{0}^{1}(\\Omega)$ 上的有界线性泛函。\n- **有限元基：** $\\{\\phi_{i}\\}_{i=1}^{N-1}$ 是在具有 $N$ 个单元的均匀网格（网格尺寸 $h = 1/N$）上的标准协调、连续、分段线性基函数。这些基函数在端点 $x=0$ 和 $x=1$ 处为零。\n- **矩阵定义：**\n  - 刚度矩阵：$K_{ij} = \\int_{0}^{1} \\phi_{i}'(x)\\,\\phi_{j}'(x)\\,dx$。\n  - 质量矩阵：$M_{ij} = \\int_{0}^{1} \\phi_{i}(x)\\,\\phi_{j}(x)\\,dx$。\n- **离散算子：** $A(\\sigma) = K + \\sigma M$。\n- **条件数定义：** $\\kappa_{M}(A(\\sigma)) = \\frac{\\sigma + \\lambda_{\\max}}{\\sigma + \\lambda_{\\min}}$，其中 $\\lambda_{\\min}$ 和 $\\lambda_{\\max}$ 是矩阵对 $(K,M)$ 的最小和最大广义特征值。\n\n**第2步：使用提取的已知条件进行验证**\n- **科学依据：** 该问题是有限元方法在二阶椭圆偏微分方程上的标准应用，是数值分析和科学计算领域的核心课题。所有概念都已成熟。\n- **适定性：** 该问题根据已知条件提供了一组明确的任务，可导出一个唯一的解析解。\n- **客观性：** 语言精确且数学化。所有术语在数值偏微分方程领域都是标准术语。\n- **完整性和一致性：** 问题是自洽的。提供了矩阵、基函数和所求量的所有必要定义。没有矛盾之处。\n- **其他标准：** 该问题不是比喻性的、琐碎的或不可验证的。它是一个形式化的数学练习。\n\n**第3步：结论与行动**\n问题有效。我们开始求解。\n\n### 求解推导\n\n将按照问题陈述中概述的五个步骤进行求解。\n\n**1. 矩阵元素推导及 $A(\\sigma)$ 的性质**\n\n我们考虑在 $\\Omega = (0,1)$ 上的一个均匀网格，节点为 $x_k = kh$，其中 $k = 0, 1, \\dots, N$，网格尺寸为 $h=1/N$。内部节点位于 $x_i$ 处，$i=1, \\dots, N-1$。与节点 $x_i$ 关联的分段线性基函数 $\\phi_i(x)$ 仅在区间 $(x_{i-1}, x_{i+1})$ 上非零，其定义为：\n$$\n\\phi_i(x) =\n\\begin{cases}\n\\frac{x - x_{i-1}}{h}  \\text{ for } x \\in [x_{i-1}, x_i] \\\\\n\\frac{x_{i+1} - x}{h}  \\text{ for } x \\in [x_i, x_{i+1}] \\\\\n0  \\text{otherwise}\n\\end{cases}\n$$\n导数 $\\phi_i'(x)$ 是分段常数：\n$$\n\\phi_i'(x) =\n\\begin{cases}\n\\frac{1}{h}  \\text{ for } x \\in (x_{i-1}, x_i) \\\\\n-\\frac{1}{h}  \\text{ for } x \\in (x_i, x_{i+1}) \\\\\n0  \\text{otherwise}\n\\end{cases}\n$$\n\n**刚度矩阵 $K$：**\n矩阵元 $K_{ij} = \\int_{0}^{1} \\phi_i'(x)\\phi_j'(x)dx$ 仅当 $\\phi_i'$ 和 $\\phi_j'$ 的支集重叠时非零，这发生在 $|i-j| \\le 1$ 的情况下。\n- 对角元 ($i=j$)：\n$$ K_{ii} = \\int_{x_{i-1}}^{x_{i+1}} (\\phi_i'(x))^2 dx = \\int_{x_{i-1}}^{x_i} \\left(\\frac{1}{h}\\right)^2 dx + \\int_{x_i}^{x_{i+1}} \\left(-\\frac{1}{h}\\right)^2 dx = \\frac{1}{h^2} \\cdot h + \\frac{1}{h^2} \\cdot h = \\frac{2}{h} $$\n- 非对角元 ($j=i+1$)：\n$$ K_{i,i+1} = \\int_{x_i}^{x_{i+1}} \\phi_i'(x)\\phi_{i+1}'(x) dx = \\int_{x_i}^{x_{i+1}} \\left(-\\frac{1}{h}\\right)\\left(\\frac{1}{h}\\right) dx = -\\frac{1}{h^2} \\cdot h = -\\frac{1}{h} $$\n根据对称性，$K_{i,i-1} = -1/h$。对于 $|i-j|1$，$K_{ij}=0$。因此，$K$ 是一个 $(N-1) \\times (N-1)$ 的三对角矩阵：\n$$ K = \\frac{1}{h} \\begin{pmatrix} 2  -1  0  \\dots \\\\ -1  2  -1  \\\\ 0  \\ddots  \\ddots  \\ddots \\\\ \\vdots   -1  2  -1 \\\\  \\dots  0  -1  2 \\end{pmatrix} $$\n\n**质量矩阵 $M$：**\n矩阵元 $M_{ij} = \\int_{0}^{1} \\phi_i(x)\\phi_j(x)dx$ 仅当 $|i-j| \\le 1$ 时非零。\n- 对角元 ($i=j$)：\n$$ M_{ii} = \\int_{x_{i-1}}^{x_{i+1}} (\\phi_i(x))^2 dx = \\int_{x_{i-1}}^{x_i} \\left(\\frac{x-x_{i-1}}{h}\\right)^2 dx + \\int_{x_i}^{x_{i+1}} \\left(\\frac{x_{i+1}-x}{h}\\right)^2 dx = 2 \\int_0^h \\left(\\frac{y}{h}\\right)^2 dy = \\frac{2}{h^2} \\left[\\frac{y^3}{3}\\right]_0^h = \\frac{2h}{3} $$\n- 非对角元 ($j=i+1$)：\n$$ M_{i,i+1} = \\int_{x_i}^{x_{i+1}} \\phi_i(x)\\phi_{i+1}(x) dx = \\int_{x_i}^{x_{i+1}} \\left(\\frac{x_{i+1}-x}{h}\\right)\\left(\\frac{x-x_i}{h}\\right) dy = \\int_0^h \\left(\\frac{h-y}{h}\\right)\\left(\\frac{y}{h}\\right) dy = \\frac{1}{h^2} \\left[ \\frac{hy^2}{2} - \\frac{y^3}{3} \\right]_0^h = \\frac{h}{6} $$\n根据对称性，$M_{i,i-1} = h/6$。因此，$M$ 是一个 $(N-1) \\times (N-1)$ 的三对角矩阵：\n$$ M = \\frac{h}{6} \\begin{pmatrix} 4  1  0  \\dots \\\\ 1  4  1  \\\\ 0  \\ddots  \\ddots  \\ddots \\\\ \\vdots   1  4  1 \\\\  \\dots  0  1  4 \\end{pmatrix} $$\n\n**$A(\\sigma)$ 的对称性和正定性：**\n根据它们的定义，$K_{ij}=K_{ji}$ 且 $M_{ij}=M_{ji}$，因此 $K$ 和 $M$ 都是对称的。因此，对于任何 $\\sigma \\in \\mathbb{R}$，$A(\\sigma)=K+\\sigma M$ 都是对称的。\n对于任何非零向量 $\\mathbf{c} \\in \\mathbb{R}^{N-1}$，令 $u_h(x) = \\sum_{k=1}^{N-1} c_k \\phi_k(x)$ 为对应的有限元函数。由于 $\\mathbf{c} \\neq \\mathbf{0}$，$u_h(x)$ 不恒为零。\n$K$ 的二次型为 $\\mathbf{c}^T K \\mathbf{c} = \\int_0^1 (u_h'(x))^2 dx = \\|u_h'\\|_{L^2}^2$。根据 $H_0^1(\\Omega)$ 的庞加莱不等式，如果 $u_h' \\equiv 0$，则 $u_h \\equiv 0$，这意味着 $\\mathbf{c}=\\mathbf{0}$。因此，对于 $\\mathbf{c} \\neq \\mathbf{0}$，有 $\\mathbf{c}^T K \\mathbf{c}  0$，所以 $K$ 是正定的。\n$M$ 的二次型为 $\\mathbf{c}^T M \\mathbf{c} = \\int_0^1 (u_h(x))^2 dx = \\|u_h\\|_{L^2}^2$。由于 $u_h$ 是连续且不恒为零的，$\\|u_h\\|_{L^2}^2  0$。因此，$M$ 是正定的。\n对于 $\\sigma \\ge 0$，$A(\\sigma)$ 的二次型为：\n$$ \\mathbf{c}^T A(\\sigma) \\mathbf{c} = \\mathbf{c}^T K \\mathbf{c} + \\sigma \\mathbf{c}^T M \\mathbf{c} $$\n由于 $K$ 是正定的，$\\mathbf{c}^T K \\mathbf{c}  0$。由于 $M$ 是正定的且 $\\sigma \\ge 0$，$\\sigma \\mathbf{c}^T M \\mathbf{c} \\ge 0$。因此，对于任何 $\\mathbf{c} \\neq \\mathbf{0}$，该和都严格为正。因此，对于所有 $\\sigma \\ge 0$，$A(\\sigma)$ 都是对称正定的。\n\n**2. 反应项对谱的影响**\n我们考虑广义特征值问题 $K\\mathbf{x} = \\lambda M\\mathbf{x}$。令 $(\\lambda_j, \\mathbf{x}_j)$ 为一个特征对，其中 $\\lambda_j$ 是广义特征值，$\\mathbf{x}_j$ 是对应的广义特征向量。\n我们感兴趣的是矩阵 $M^{-1}A(\\sigma)$ 的谱，其特征值决定了关于 $M$ 加权内积的条件数。由于 $M$ 是对称正定的，它是可逆的。\n我们将矩阵 $M^{-1}A(\\sigma)$ 应用于一个广义特征向量 $\\mathbf{x}_j$：\n$$ M^{-1}A(\\sigma)\\mathbf{x}_j = M^{-1}(K + \\sigma M)\\mathbf{x}_j = M^{-1}(K\\mathbf{x}_j) + M^{-1}(\\sigma M\\mathbf{x}_j) $$\n使用广义特征问题的定义，$K\\mathbf{x}_j = \\lambda_j M\\mathbf{x}_j$，这意味着 $M^{-1}K\\mathbf{x}_j = \\lambda_j \\mathbf{x}_j$。\n第二项简化为 $\\sigma M^{-1}M\\mathbf{x}_j = \\sigma I \\mathbf{x}_j = \\sigma \\mathbf{x}_j$。\n结合这些结果，我们得到：\n$$ M^{-1}A(\\sigma)\\mathbf{x}_j = \\lambda_j \\mathbf{x}_j + \\sigma \\mathbf{x}_j = (\\lambda_j + \\sigma)\\mathbf{x}_j $$\n这表明，如果 $\\mathbf{x}_j$ 是矩阵对 $(K,M)$ 的一个广义特征向量，其特征值为 $\\lambda_j$，那么它也是 $M^{-1}A(\\sigma)$ 的一个特征向量，其特征值为 $\\sigma + \\lambda_j$。因此，$M^{-1}A(\\sigma)$ 的谱是 $(K,M)$ 的广义谱经过量 $\\sigma$ 的简单平移。\n\n**3. 广义特征值 $\\lambda_j$ 的闭式解**\n矩阵 $K$ 和 $M$ 是类三对角托普利茨矩阵。它们共享一组共同的特征向量，即离散正弦向量。令特征向量 $\\mathbf{v}_j$ 的分量为 $(\\mathbf{v}_j)_k = \\sin(j \\pi x_k) = \\sin(j \\pi k h)$，其中 $k=1, \\dots, N-1$。\n我们来计算 $K$ 和 $M$ 对 $\\mathbf{v}_j$ 的作用。第 $k$ 个分量是：\n$$ (K\\mathbf{v}_j)_k = \\frac{1}{h} \\left( -(\\mathbf{v}_j)_{k-1} + 2(\\mathbf{v}_j)_k - (\\mathbf{v}_j)_{k+1} \\right) = \\frac{1}{h} \\Big( -\\sin(j\\pi(k-1)h) + 2\\sin(j\\pi kh) - \\sin(j\\pi(k+1)h) \\Big) $$\n使用 $\\sin(A-B)+\\sin(A+B)=2\\sin A \\cos B$：\n$$ (K\\mathbf{v}_j)_k = \\frac{1}{h} \\left( 2\\sin(j\\pi kh) - 2\\sin(j\\pi kh)\\cos(j\\pi h) \\right) = \\frac{2}{h}(1-\\cos(j\\pi h))\\sin(j\\pi kh) $$\n使用半角恒等式 $1-\\cos\\theta=2\\sin^2(\\theta/2)$：\n$$ (K\\mathbf{v}_j)_k = \\frac{4}{h}\\sin^2\\left(\\frac{j\\pi h}{2}\\right) (\\mathbf{v}_j)_k $$\n类似地，对于质量矩阵 $M$：\n$$ (M\\mathbf{v}_j)_k = \\frac{h}{6} \\left( (\\mathbf{v}_j)_{k-1} + 4(\\mathbf{v}_j)_k + (\\mathbf{v}_j)_{k+1} \\right) = \\frac{h}{6} \\left( 2\\sin(j\\pi kh)\\cos(j\\pi h) + 4\\sin(j\\pi kh) \\right) = \\frac{h}{3}(2+\\cos(j\\pi h))(\\mathbf{v}_j)_k $$\n广义特征值问题 $K\\mathbf{v}_j = \\lambda_j M\\mathbf{v}_j$ 变为：\n$$ \\frac{4}{h}\\sin^2\\left(\\frac{j\\pi h}{2}\\right) \\mathbf{v}_j = \\lambda_j \\frac{h}{3}(2+\\cos(j\\pi h)) \\mathbf{v}_j $$\n解出 $\\lambda_j$：\n$$ \\lambda_j = \\frac{\\frac{4}{h}\\sin^2(\\frac{j\\pi h}{2})}{\\frac{h}{3}(2+\\cos(j\\pi h))} = \\frac{12}{h^2} \\frac{\\sin^2(\\frac{j\\pi h}{2})}{2+\\cos(j\\pi h)} $$\n使用 $\\cos\\theta = 1-2\\sin^2(\\theta/2)$，分母为 $2+(1-2\\sin^2(j\\pi h/2)) = 3-2\\sin^2(j\\pi h/2)$。\n因此，对于 $j=1, \\dots, N-1$ 的广义特征值为：\n$$ \\lambda_j = \\frac{12}{h^2} \\frac{\\sin^2\\left(\\frac{j\\pi h}{2}\\right)}{3-2\\sin^2\\left(\\frac{j\\pi h}{2}\\right)} $$\n代入 $h=1/N$：\n$$ \\lambda_j = 12N^2 \\frac{\\sin^2\\left(\\frac{j\\pi}{2N}\\right)}{3-2\\sin^2\\left(\\frac{j\\pi}{2N}\\right)} $$\n\n**4. 条件数的精确解析表达式**\n在 $M$ 加权内积下的谱条件数由 $\\kappa_{M}(A(\\sigma)) = \\frac{\\max_k(\\sigma+\\lambda_k)}{\\min_k(\\sigma+\\lambda_k)} = \\frac{\\sigma + \\lambda_{\\max}}{\\sigma + \\lambda_{\\min}}$ 给出。\n为了找到 $\\lambda_{\\min}$ 和 $\\lambda_{\\max}$，我们分析 $\\lambda_j$ 对 $j$ 的依赖性。令 $z = \\sin^2(j\\pi/(2N))$。函数为 $f(z) = \\frac{z}{3-2z}$。其导数为 $f'(z) = \\frac{3}{(3-2z)^2}  0$。由于对于 $j=1, \\dots, N-1$，$j\\pi/(2N)$ 位于 $(0, \\pi/2)$ 区间内，$\\sin(j\\pi/(2N))$ 是 $j$ 的增函数，因此 $z$ 随 $j$ 递增。所以，$\\lambda_j$ 是 $j$ 的单调增函数。\n最小特征值 $\\lambda_{\\min}$ 对应于 $j=1$：\n$$ \\lambda_{\\min} = \\lambda_1 = 12N^2 \\frac{\\sin^2\\left(\\frac{\\pi}{2N}\\right)}{3-2\\sin^2\\left(\\frac{\\pi}{2N}\\right)} $$\n最大特征值 $\\lambda_{\\max}$ 对应于 $j=N-1$：\n$$ \\lambda_{\\max} = \\lambda_{N-1} = 12N^2 \\frac{\\sin^2\\left(\\frac{(N-1)\\pi}{2N}\\right)}{3-2\\sin^2\\left(\\frac{(N-1)\\pi}{2N}\\right)} $$\n使用 $\\sin\\left(\\frac{(N-1)\\pi}{2N}\\right) = \\sin\\left(\\frac{\\pi}{2}-\\frac{\\pi}{2N}\\right) = \\cos\\left(\\frac{\\pi}{2N}\\right)$：\n$$ \\lambda_{\\max} = 12N^2 \\frac{\\cos^2\\left(\\frac{\\pi}{2N}\\right)}{3-2\\cos^2\\left(\\frac{\\pi}{2N}\\right)} $$\n将这些代入条件数的表达式中，得到最终的解析表达式：\n$$ \\kappa_{M}(A(\\sigma)) = \\frac{\\sigma + 12N^2 \\frac{\\cos^2\\left(\\frac{\\pi}{2N}\\right)}{3-2\\cos^2\\left(\\frac{\\pi}{2N}\\right)}}{\\sigma + 12N^2 \\frac{\\sin^2\\left(\\frac{\\pi}{2N}\\right)}{3-2\\sin^2\\left(\\frac{\\pi}{2N}\\right)}} $$\n\n**5. 当 $\\sigma \\to \\infty$ 时的渐近行为**\n为找到当 $\\sigma \\to \\infty$ 时 $\\kappa_{M}(A(\\sigma))$ 的主阶渐近行为，我们取极限：\n$$ \\lim_{\\sigma \\to \\infty} \\kappa_{M}(A(\\sigma)) = \\lim_{\\sigma \\to \\infty} \\frac{\\sigma + \\lambda_{\\max}}{\\sigma + \\lambda_{\\min}} = \\lim_{\\sigma \\to \\infty} \\frac{1 + \\lambda_{\\max}/\\sigma}{1 + \\lambda_{\\min}/\\sigma} $$\n因为对于固定的网格尺寸 $N$，$\\lambda_{\\min}$ 和 $\\lambda_{\\max}$ 是固定的正常数，所以当 $\\sigma \\to \\infty$ 时，我们有 $\\lambda_{\\max}/\\sigma \\to 0$ 和 $\\lambda_{\\min}/\\sigma \\to 0$。\n因此，极限为：\n$$ \\lim_{\\sigma \\to \\infty} \\kappa_{M}(A(\\sigma)) = \\frac{1+0}{1+0} = 1 $$\n主阶渐近行为是条件数趋近于 $1$。这是因为当 $\\sigma$ 很大时，算子 $A(\\sigma) = K + \\sigma M \\approx \\sigma M$。$M^{-1}(\\sigma M) = \\sigma M^{-1}M = \\sigma I$ 的条件数是（缩放的）单位矩阵的条件数，即 $1$。反应项主导了刚度项，使得系统矩阵的行为像一个条件良好的（缩放的）质量矩阵。",
            "answer": "$$ \\boxed{ \\frac{\\sigma + 12N^{2} \\frac{\\cos^{2}\\left(\\frac{\\pi}{2N}\\right)}{3-2\\cos^{2}\\left(\\frac{\\pi}{2N}\\right)}}{\\sigma + 12N^{2} \\frac{\\sin^{2}\\left(\\frac{\\pi}{2N}\\right)}{3-2\\sin^{2}\\left(\\frac{\\pi}{2N}\\right)}} } $$"
        }
    ]
}