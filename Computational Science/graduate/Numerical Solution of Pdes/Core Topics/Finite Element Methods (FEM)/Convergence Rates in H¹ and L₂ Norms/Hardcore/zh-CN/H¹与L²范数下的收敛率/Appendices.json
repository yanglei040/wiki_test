{
    "hands_on_practices": [
        {
            "introduction": "理论与实践相结合是数值分析的基石。此练习旨在通过编写一个简单的有限元方法程序，从经验上验证收敛率理论。通过对一个具有已知精确解的一维泊松方程进行求解，并分析误差与网格尺寸的关系，您将亲眼见证 $H^1$ 范数和 $L^2$ 范数下的理论收敛阶是如何在计算结果中体现的。",
            "id": "3374906",
            "problem": "考虑在区间 $\\Omega=(0,1)$ 上的标量二阶偏微分方程 (PDE) $-u''(x)=f(x)$，其具有齐次狄利克雷边界条件 $u(0)=0$ 和 $u(1)=0$。设精确解为一个构造函数 $u(x)=\\sin(k\\pi x)$，其中频率参数 $k\\in\\mathbb{N}$ 为整数，右端项定义为 $f(x)=-u''(x)=(k\\pi)^2\\sin(k\\pi x)$。目标是通过对误差与网格尺寸进行对数-对数斜率分析，凭经验确认线性协调有限元方法 (FEM) 在索博列夫空间 $H^1(\\Omega)$-范数和勒贝格空间 $L^2(\\Omega)$-范数下的代数收敛率。\n\n从索博列夫空间 $H_0^1(\\Omega)$ 中的弱形式出发，在一系列网格尺寸为 $h=1/N$（其中 $N\\in\\mathbb{N}$）的均匀网格上，使用标准的连续分段线性（帽函数）逼近。对于每个网格，组装并求解通过伽辽金方法得到的离散线性系统。计算精确解 $u$ 和有限元逼近解 $u_h$ 之间在 $H^1(\\Omega)$-范数和 $L^2(\\Omega)$-范数下的误差。$L^2(\\Omega)$-范数定义为 $\\|v\\|_{L^2(\\Omega)}=\\left(\\int_\\Omega |v(x)|^2\\,dx\\right)^{1/2}$，$H^1(\\Omega)$-范数定义为 $\\|v\\|_{H^1(\\Omega)}=\\left(\\|v\\|_{L^2(\\Omega)}^2+\\|v'\\|_{L^2(\\Omega)}^2\\right)^{1/2}$。使用高阶高斯求积法以足够的精度计算必要的积分。\n\n按如下方式实现对数-对数斜率分析。对于一系列尺寸为 $h_j$ 的均匀网格，计算误差 $E_{H^1}(h_j)=\\|u-u_h\\|_{H^1(\\Omega)}$ 和 $E_{L^2}(h_j)=\\|u-u_h\\|_{L^2(\\Omega)}$，其中 $j=1,\\dots,m$，$m\\in\\mathbb{N}$ 是加密的层数。在最小二乘意义下，对 $(\\log h_j,\\log E(h_j))$ 进行直线拟合；该直线的斜率即为经验收敛率。对两种范数重复此过程。\n\n您的程序必须：\n- 使用构造解 $u(x)=\\sin(k\\pi x)$ 及相应的源项 $f(x)=(k\\pi)^2\\sin(k\\pi x)$。\n- 使用包含 $N$ 个单元的均匀网格和线性基函数，从第一性原理出发组装刚度矩阵和载荷向量。\n- 强施加齐次狄利克雷边界条件。\n- 在每个网格单元上使用足够精确的高斯求积法计算 $\\|u-u_h\\|_{L^2(\\Omega)}$ 和 $\\|u-u_h\\|_{H^1(\\Omega)}$。\n- 对 $(\\log h,\\log E)$ 进行最小二乘线性回归，以提取两种范数下的经验斜率。\n\n测试套件：\n- 情况 A（正常路径）：频率 $k=1$，初始单元数 $N_0=8$，加密层数 $m=5$（在每一层通过将 $h$ 减半，即 $N$ 加倍来进行加密）。\n- 情况 B（从粗到细的覆盖）：频率 $k=3$，初始单元数 $N_0=4$，加密层数 $m=5$。\n- 情况 C（更高频率内容）：频率 $k=5$，初始单元数 $N_0=16$，加密层数 $m=4$。\n\n对于每种情况，输出一对实数 $[p_{H^1},p_{L^2}]$，其中 $p_{H^1}$ 是 $H^1(\\Omega)$-范数的经验对数-对数斜率，$p_{L^2}$ 是 $L^2(\\Omega)$-范数的经验对数-对数斜率。所有实数必须四舍五入打印到小数点后三位。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个以逗号分隔的列表的列表形式的结果，每个测试用例一个，按 A、B、C 的顺序排列，例如 $[[p_{H^1}^{(A)},p_{L^2}^{(A)}],[p_{H^1}^{(B)},p_{L^2}^{(B)}],[p_{H^1}^{(C)},p_{L^2}^{(C)}]]$。\n- 不应打印额外的文本。",
            "solution": "该问题要求对应用于一维泊松方程的线性有限元方法 (FEM) 的收敛率进行经验性验证。该分析将通过求解一个构造解，然后在对数-对数尺度上计算误差范数与网格尺寸关系的斜率来执行。\n\n控制性偏微分方程 (PDE) 是：\n$$ -u''(x) = f(x) \\quad \\text{for } x \\in \\Omega=(0,1) $$\n具有齐次狄利克雷边界条件 $u(0)=0$ 和 $u(1)=0$。问题指定了一个构造解 $u(x)=\\sin(k\\pi x)$，其中 $k \\in \\mathbb{N}$ 是一个整数频率参数。右端项，或称源项 $f(x)$，通过将精确解代入 PDE 来确定：\n$$ f(x) = -u''(x) = - \\frac{d^2}{dx^2}(\\sin(k\\pi x)) = (k\\pi)^2 \\sin(k\\pi x) $$\n\nFEM 求解从问题的弱形式开始。我们将 PDE 乘以一个来自索博列夫空间 $H_0^1(\\Omega)$ 的测试函数 $v(x)$，该空间是函数及其一阶导数平方可积且在边界 $x=0$ 和 $x=1$ 处为零的函数空间。在定义域 $\\Omega$ 上积分得到：\n$$ -\\int_0^1 u''(x)v(x) \\,dx = \\int_0^1 f(x)v(x) \\,dx $$\n对左侧应用分部积分法得到：\n$$ \\left[-u'(x)v(x)\\right]_0^1 + \\int_0^1 u'(x)v'(x) \\,dx = \\int_0^1 f(x)v(x) \\,dx $$\n由于 $v \\in H_0^1(\\Omega)$，$v(0)=v(1)=0$，边界项消失。这导出了弱形式：求 $u \\in H_0^1(\\Omega)$ 使得\n$$ a(u,v) = L(v) \\quad \\forall v \\in H_0^1(\\Omega) $$\n其中双线性形式 $a(u,v)$ 和线性泛函 $L(v)$ 定义为：\n$$ a(u,v) = \\int_0^1 u'(x)v'(x) \\,dx $$\n$$ L(v) = \\int_0^1 f(x)v(x) \\,dx $$\n\n对于有限元离散化，我们将域 $\\Omega=(0,1)$ 剖分为一个包含 $N$ 个单元的均匀网格，每个单元的长度为 $h=1/N$。节点位于 $x_i = ih$，其中 $i=0, 1, \\dots, N$。我们在有限维子空间 $V_h \\subset H_0^1(\\Omega)$ 中寻求一个近似解 $u_h$。对于本问题，$V_h$ 是在该网格上连续且在 $x=0$ 和 $x=1$ 处为零的分段线性函数的空间。$V_h$ 的一组基由“帽”函数集合 $\\{\\phi_i(x)\\}_{i=1}^{N-1}$ 给出，其中 $\\phi_i(x)$ 是在节点 $x_i$ 处为 $1$ 并在所有其他节点 $x_j$ 处为 $0$ 的唯一线性函数。\n\nFEM 逼近解 $u_h(x)$ 写成这些基函数的线性组合：\n$$ u_h(x) = \\sum_{j=1}^{N-1} U_j \\phi_j(x) $$\n其中 $U_j$ 是未知系数，表示近似解在内部节点 $x_j$ 处的值。伽辽金方法要求弱形式对离散空间 $V_h$ 中的所有测试函数都成立，即对每个基函数 $\\phi_i$：\n$$ a(u_h, \\phi_i) = L(\\phi_i) \\quad \\text{for } i=1, \\dots, N-1 $$\n代入 $u_h$ 的展开式，得到一个线性方程组：\n$$ \\sum_{j=1}^{N-1} U_j a(\\phi_j, \\phi_i) = L(\\phi_i) $$\n这可以写成矩阵形式 $AU=F$，其中：\n- $A$ 是 $(N-1) \\times (N-1)$ 的刚度矩阵，其元素为 $A_{ij} = a(\\phi_j, \\phi_i) = \\int_0^1 \\phi_i'(x)\\phi_j'(x) \\,dx$。\n- $F$ 是 $(N-1) \\times 1$ 的载荷向量，其元素为 $F_i = L(\\phi_i) = \\int_0^1 f(x)\\phi_i(x) \\,dx$。\n- $U$ 是未知系数向量 $[U_1, \\dots, U_{N-1}]^T$。\n\n对于具有分段线性基函数的均匀网格，刚度矩阵的元素可以解析计算。导数 $\\phi_i'(x)$ 是分段常数：在 $(x_{i-1}, x_i)$ 上为 $1/h$，在 $(x_i, x_{i+1})$ 上为 $-1/h$。这产生一个对称的三对角刚度矩阵：\n$$ A_{ij} = \\begin{cases} 2/h  \\text{if } i=j \\\\ -1/h  \\text{if } |i-j|=1 \\\\ 0  \\text{otherwise} \\end{cases} $$\n载荷向量元素 $F_i = \\int_{x_{i-1}}^{x_{i+1}} (k\\pi)^2 \\sin(k\\pi x) \\phi_i(x) \\,dx$ 必须进行数值计算。这是通过使用高斯求积对每个单元的贡献求和来完成的，以确保高精度。\n\n求解线性系统 $AU=F$ 得到节点值 $U$ 后，完整的 FEM 解 $u_h(x)$ 就已知了。误差为 $e(x) = u(x) - u_h(x)$。我们计算两种范数下的误差：\n- $L^2$-范数：$\\|e\\|_{L^2(\\Omega)} = \\left(\\int_0^1 (u(x)-u_h(x))^2 \\,dx\\right)^{1/2}$。\n- $H^1$-范数：$\\|e\\|_{H^1(\\Omega)} = \\left(\\|e\\|_{L^2(\\Omega)}^2 + \\|e'\\|_{L^2(\\Omega)}^2\\right)^{1/2}$，其中 $\\|e'\\|_{L^2(\\Omega)} = \\left(\\int_0^1 (u'(x)-u_h'(x))^2 \\,dx\\right)^{1/2}$。\n\n这些积分是逐个单元使用高阶高斯求积计算的。在每个单元 $[x_j, x_{j+1}]$ 上，函数 $g(x)$ 的积分通过变换到参考单元 $[-1,1]$ 并使用在特定求积点处函数值的加权和来近似。\n\n为了找到经验收敛率，我们为一系列逐渐加密的网格计算误差。设 $h_j$ 是加密级别 $j$ 处的网格尺寸，设 $E(h_j)$ 是相应的误差（$E_{H^1}$ 或 $E_{L^2}$）。如果误差呈代数收敛，即 $E(h) \\approx C h^p$ 对于某个常数 $C$ 和速率 $p$，那么取对数得到 $\\log(E) \\approx \\log(C) + p \\log(h)$。这是 $\\log(E)$ 和 $\\log(h)$ 之间的线性关系，其中斜率是收敛率 $p$。我们对点集 $(\\log(h_j), \\log(E(h_j)))$ 进行最小二乘线性回归以确定斜率 $p$。\n\n对于线性有限元，理论预测指出，只要解足够光滑且网格足够精细，$H^1$-范数的收敛率为 $p=1$，$L^2$-范数的收敛率为 $p=2$。程序实现了这整个过程，以验证给定测试用例的这些收敛率。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the FEM convergence study for the specified test cases.\n    \"\"\"\n\n    # Test cases: (k, N_initial, num_refinements)\n    test_cases = [\n        (1, 8, 5),  # Case A\n        (3, 4, 5),  # Case B\n        (5, 16, 4), # Case C\n    ]\n\n    all_results = []\n    for k, N0, m in test_cases:\n        p_h1, p_l2 = run_convergence_study(k, N0, m)\n        all_results.append([f\"{p_h1:.3f}\", f\"{p_l2:.3f}\"])\n\n    # Format the final output string as per requirements\n    list_of_strings = [f\"[{item[0]},{item[1]}]\" for item in all_results]\n    final_output = f\"[{','.join(list_of_strings)}]\"\n    print(final_output)\n\ndef run_convergence_study(k, N0, num_refinements):\n    \"\"\"\n    Performs a convergence study for a given frequency k, initial mesh size N0,\n    and a number of refinement levels.\n\n    Args:\n        k (int): Frequency parameter for the manufactured solution.\n        N0 (int): Initial number of elements.\n        num_refinements (int): Number of mesh refinement steps.\n\n    Returns:\n        tuple: A pair of floats (p_h1, p_l2) representing the convergence\n               rates for the H1 and L2 norms.\n    \"\"\"\n    hs = []\n    errors_l2 = []\n    errors_h1 = []\n\n    for i in range(num_refinements):\n        N = N0 * (2**i)\n        h = 1.0 / N\n        l2_err, h1_err = solve_fem_1d(k, N)\n\n        hs.append(h)\n        errors_l2.append(l2_err)\n        errors_h1.append(h1_err)\n\n    log_hs = np.log(hs)\n    log_errs_l2 = np.log(errors_l2)\n    log_errs_h1 = np.log(errors_h1)\n\n    # Perform least-squares fit to find the slope (convergence rate)\n    p_l2 = np.polyfit(log_hs, log_errs_l2, 1)[0]\n    p_h1 = np.polyfit(log_hs, log_errs_h1, 1)[0]\n\n    return p_h1, p_l2\n\ndef solve_fem_1d(k, N):\n    \"\"\"\n    Solves the 1D Poisson problem -u''=f on (0,1) with u(0)=u(1)=0 using linear FEM.\n\n    Args:\n        k (int): Frequency parameter of the manufactured solution.\n        N (int): Number of mesh elements.\n\n    Returns:\n        tuple: A pair of floats (l2_error, h1_error).\n    \"\"\"\n    h = 1.0 / N\n    num_unknowns = N - 1\n\n    # Define exact solution, its derivative, and the source function\n    u_exact = lambda x: np.sin(k * np.pi * x)\n    u_prime_exact = lambda x: k * np.pi * np.cos(k * np.pi * x)\n    f_source = lambda x: (k * np.pi)**2 * np.sin(k * np.pi * x)\n\n    # Assemble stiffness matrix A\n    diag = np.full(num_unknowns, 2.0 / h)\n    off_diag = np.full(num_unknowns - 1, -1.0 / h)\n    A = np.diag(diag) + np.diag(off_diag, k=1) + np.diag(off_diag, k=-1)\n    \n    # Gaussian quadrature setup (5 points is sufficient for high accuracy)\n    NUM_QUAD_POINTS = 5\n    xi_q, w_q = np.polynomial.legendre.leggauss(NUM_QUAD_POINTS)\n\n    # Assemble load vector F\n    F = np.zeros(num_unknowns)\n    # Local basis functions on reference element [-1, 1]\n    phi_ref = [lambda xi: (1 - xi) / 2, lambda xi: (1 + xi) / 2]\n\n    for j in range(N):  # Loop over elements\n        x_left = j * h\n        f_loc = np.zeros(2)\n        for q_idx in range(NUM_QUAD_POINTS):\n            x_q_phys = x_left + h / 2 * (1 + xi_q[q_idx])\n            f_val = f_source(x_q_phys)\n            for i in range(2):\n                f_loc[i] += f_val * phi_ref[i](xi_q[q_idx]) * (h / 2) * w_q[q_idx]\n\n        # Add local contributions to global vector\n        if j > 0:\n            F[j - 1] += f_loc[0]\n        if j  N - 1:\n            F[j] += f_loc[1]\n\n    # Solve linear system AU = F\n    U_sol = np.linalg.solve(A, F)\n\n    # Full solution vector including boundary nodes\n    U_h = np.concatenate(([0.0], U_sol, [0.0]))\n\n    # Compute L2 and H1 error norms\n    l2_error_sq = 0.0\n    h1_seminorm_error_sq = 0.0\n\n    for j in range(N):  # Loop over elements to compute error integrals\n        x_left = j * h\n        U_j, U_jp1 = U_h[j], U_h[j + 1]\n        u_h_prime_const = (U_jp1 - U_j) / h\n        \n        for q_idx in range(NUM_QUAD_POINTS):\n            x_q_phys = x_left + h / 2 * (1 + xi_q[q_idx])\n            \n            # Evaluate exact solution and its derivative\n            u_ex = u_exact(x_q_phys)\n            u_prime_ex = u_prime_exact(x_q_phys)\n\n            # Evaluate FEM solution and its derivative\n            u_h_val = U_j * phi_ref[0](xi_q[q_idx]) + U_jp1 * phi_ref[1](xi_q[q_idx])\n            \n            # Accumulate squared errors\n            jacobian = h / 2\n            l2_error_sq += (u_ex - u_h_val)**2 * jacobian * w_q[q_idx]\n            h1_seminorm_error_sq += (u_prime_ex - u_h_prime_const)**2 * jacobian * w_q[q_idx]\n\n    l2_error = np.sqrt(l2_error_sq)\n    h1_error = np.sqrt(l2_error_sq + h1_seminorm_error_sq)\n\n    return l2_error, h1_error\n\nsolve()\n```"
        },
        {
            "introduction": "有限元方法的实施充满了重要的细节，这些细节决定了数值格式的准确性。一个核心问题是如何精确地计算弱形式中的积分，因为这些积分通常是通过数值求积来近似的。此练习将引导您从第一性原理出发，分析为了不破坏最优收敛阶，计算刚度矩阵和质量矩阵所需的最小求积精度。",
            "id": "3374918",
            "problem": "考虑在有界凸区域 $\\Omega \\subset \\mathbb{R}^{d}$ (其中 $d \\in \\{2,3\\}$) 上的反应扩散边值问题：求 $u \\in H_{0}^{1}(\\Omega)$ 使得\n$$\na(u,v) \\equiv \\int_{\\Omega} \\left( \\nabla u \\cdot \\nabla v + u\\,v \\right)\\,dx \\;=\\; \\ell(v) \\equiv \\int_{\\Omega} f\\,v\\,dx \\quad \\text{对所有 } v \\in H_{0}^{1}(\\Omega),\n$$\n其中 $f \\in L^{2}(\\Omega)$ 且对于一个固定的整数 $p \\geq 1$ 有 $u \\in H^{p+1}(\\Omega)$。设 $\\{\\mathcal{T}_{h}\\}_{h}$ 是 $\\Omega$ 的一族形状正则、拟一致的单纯形网格，网格尺寸为 $h$。设 $V_{h} \\subset H_{0}^{1}(\\Omega)$ 为标准 Lagrange 有限元空间，由 $\\mathcal{T}_{h}$ 上总次数至多为 $p$ 的连续分片多项式函数构成。\n\n一个协调离散方法通过在每个单元 $K \\in \\mathcal{T}_{h}$ 上对双线性形式进行欠积分来定义：\n$$\na_{h}(u_{h},v_{h}) \\;=\\; \\sum_{K \\in \\mathcal{T}_{h}} \\Big( Q_{s}^{K}\\big( \\nabla u_{h} \\cdot \\nabla v_{h} \\big) \\;+\\; Q_{m}^{K}\\big( u_{h}\\,v_{h} \\big) \\Big),\n$$\n其中离散载荷取为精确值，即 $\\ell_{h}(v_{h}) = \\ell(v_{h})$，离散问题旨在寻求 $u_{h} \\in V_{h}$ 使得\n$$\na_{h}(u_{h},v_{h}) \\;=\\; \\ell(v_{h}) \\quad \\text{对所有 } v_{h} \\in V_{h}.\n$$\n此处，对每个单元 $K$，$Q_{s}^{K}$ 和 $Q_{m}^{K}$ 分别表示单元上的求积法则，它们对 $K$ 上总次数分别至多为 $r_{s}$ 和 $r_{m}$ 的多项式是精确的。假设所有单元都使用相同的数组 $(r_{s},r_{m})$，并且这些求积法则是稳定的（在多项式空间上满足标准的范数等价界限的意义下）。\n\n仅使用弱形式的基本定义、Lagrange 有限元基的多项式次数结构，以及基于 Strang 引理的一致性论证（不得在没有论证的情况下引用任何现成的估计），推导保证以下条件的最紧的单元多项式精确次数 $r_{s}^{\\star}(p)$ 和 $r_{m}^{\\star}(p)$（仅作为 $p$ 的函数）：离散双线性形式与 $V_{h} \\times V_{h}$ 上的精确双线性形式重合，这反过来又保持了当 $h \\to 0$ 时的最优收敛率 $\\|u-u_{h}\\|_{H^{1}(\\Omega)} = \\mathcal{O}(h^{p})$ 和 $\\|u-u_{h}\\|_{L^{2}(\\Omega)} = \\mathcal{O}(h^{p+1})$。\n\n将你的最终答案表示为一个包含两个表达式 $r_{s}^{\\star}(p)$ 和 $r_{m}^{\\star}(p)$ 的单行矩阵。无需四舍五入。答案中不要包含单位。",
            "solution": "该问题要求推导在有限元离散化中使用的数值求积法则的最低多项式精确次数 $r_{s}^{\\star}(p)$ 和 $r_{m}^{\\star}(p)$。条件是这些次数必须恰好足以确保离散双线性形式 $a_{h}(\\cdot, \\cdot)$ 在限制于有限元空间 $V_{h} \\times V_{h}$ 上时与精确双线性形式 $a(\\cdot, \\cdot)$ 完全相同。题目指出，这个条件反过来又能保证最优收敛率。\n\n我们首先将问题陈述中给出的核心条件形式化：\n$$\na_{h}(v_{h}, w_{h}) = a(v_{h}, w_{h}) \\quad \\text{对所有 } v_{h}, w_{h} \\in V_{h}.\n$$\n通过将双线性形式写成在所有单元 $K \\in \\mathcal{T}_{h}$ 上的和，我们有：\n$$\na(v_{h}, w_{h}) = \\sum_{K \\in \\mathcal{T}_{h}} \\left( \\int_{K} \\nabla v_{h} \\cdot \\nabla w_{h} \\,dx + \\int_{K} v_{h} w_{h} \\,dx \\right)\n$$\n$$\na_{h}(v_{h}, w_{h}) = \\sum_{K \\in \\mathcal{T}_{h}} \\left( Q_{s}^{K}(\\nabla v_{h} \\cdot \\nabla w_{h}) + Q_{m}^{K}(v_{h} w_{h}) \\right)\n$$\n为了使等式 $a_{h}(v_{h}, w_{h}) = a(v_{h}, w_{h})$ 对所有 $v_{h}, w_{h} \\in V_{h}$ 的选择都成立，只需该等式在每个单元 $K \\in \\mathcal{T}_{h}$ 上逐项成立即可。这要求：\n1. 对于所有 $v_{h}, w_{h} \\in V_{h}$，有 $Q_{s}^{K}(\\nabla v_{h} \\cdot \\nabla w_{h}) = \\int_{K} \\nabla v_{h} \\cdot \\nabla w_{h} \\,dx$。\n2. 对于所有 $v_{h}, w_{h} \\in V_{h}$，有 $Q_{m}^{K}(v_{h} w_{h}) = \\int_{K} v_{h} w_{h} \\,dx$。\n\n在继续之前，我们根据问题框架的要求，简要论证为何此条件能保持最优收敛率。与 $a(\\cdot, \\cdot)$ 相关的能量范数中的误差 $e = u-u_{h}$ 可以使用 Strang 第一引理进行界定。假设离散形式 $a_{h}$ 在 $V_{h}$ 上是矫顽的，该引理提供了一个形式如下的估计：\n$$\n\\|u - u_{h}\\|_{H^{1}(\\Omega)} \\leq C \\left( \\inf_{v_{h} \\in V_{h}} \\|u - v_{h}\\|_{H^{1}(\\Omega)} + \\sup_{w_{h} \\in V_{h} \\setminus \\{0\\}} \\frac{|a(u, w_{h}) - \\ell(w_{h})|}{\\|w_{h}\\|_{H^{1}(\\Omega)}} + \\sup_{v_{h}, w_{h} \\in V_{h} \\setminus \\{0\\}} \\frac{|a(v_{h}, w_{h}) - a_{h}(v_{h}, w_{h})|}{\\|v_{h}\\|_{H^{1}(\\Omega)} \\|w_{h}\\|_{H^{1}(\\Omega)}} \\right).\n$$\n在我们的问题中，离散载荷是精确的，即 $\\ell_h = \\ell$，这意味着 $a(u, w_h) = \\ell(w_h)$，所以第二项（载荷一致性误差）为零。条件 $a_{h}(v_{h}, w_{h}) = a(v_{h}, w_{h})$ 对所有 $v_{h}, w_{h} \\in V_h$ 成立，使得第三项（双线性形式一致性误差）完全为零。因此，误差估计简化为 Céa 引理：\n$$\n\\|u - u_{h}\\|_{H^{1}(\\Omega)} \\leq C \\inf_{v_{h} \\in V_{h}} \\|u - v_{h}\\|_{H^{1}(\\Omega)}.\n$$\n对于具有正则性 $u \\in H^{p+1}(\\Omega)$ 的解和由 $p$ 次多项式构成的有限元空间 $V_{h}$，标准逼近理论保证了最佳逼近误差为 $\\inf_{v_{h} \\in V_{h}} \\|u - v_{h}\\|_{H^{1}(\\Omega)} = \\mathcal{O}(h^{p})$。因此，我们的条件确保了 $\\|u-u_{h}\\|_{H^{1}(\\Omega)} = \\mathcal{O}(h^{p})$。\n\n最优 $L^{2}$-范数估计是通过 Aubin-Nitsche 对偶论证得到的。该论证依赖于 $H^{1}$-范数估计。如果我们在 $V_{h} \\times V_{h}$ 上强制要求 $a_{h} \\equiv a$，则标准的对偶证明过程无需修改即可进行，从而得到 $\\|u-u_{h}\\|_{L^{2}(\\Omega)} = \\mathcal{O}(h^{p+1})$，前提是对偶问题具有足够的椭圆正则性（这由 $\\Omega$ 的凸性保证）。\n\n现在我们来确定所需的最低精确次数 $r_{s}^{\\star}$ 和 $r_{m}^{\\star}$。\n有限元空间 $V_{h}$ 由这样的函数组成：其在任何单元 $K \\in \\mathcal{T}_{h}$ 上的限制都是总次数至多为 $p$ 的多项式。我们将 $K$ 上的这类多项式空间记为 $\\mathcal{P}_{p}(K)$。因此，对于任何 $v_{h}, w_{h} \\in V_{h}$，它们在 $K$ 上的限制 $v_{h}|_{K}$ 和 $w_{h}|_{K}$ 都在 $\\mathcal{P}_{p}(K)$ 中。\n\n刚度项积分算子 $Q_{s}^{K}$ 的分析：\n被积函数是 $\\nabla v_{h} \\cdot \\nabla w_{h}$。\n如果 $v_{h} \\in \\mathcal{P}_{p}(K)$，其梯度 $\\nabla v_{h}$ 是一个向量，其分量是总次数至多为 $p-1$ 的多项式。点积 $\\nabla v_{h} \\cdot \\nabla w_{h}$ 涉及这些分量的乘积之和。一个次数至多为 $p-1$ 的多项式与另一个次数至多为 $p-1$ 的多项式的乘积，结果是一个次数至多为 $(p-1) + (p-1) = 2p-2$ 的多项式。\n因此，被积函数 $\\nabla v_{h} \\cdot \\nabla w_{h}$ 是一个总次数至多为 $2p-2$ 的多项式。\n求积法则 $Q_{s}^{K}$ 被定义为对总次数至多为 $r_{s}$ 的多项式是精确的。为了让条件 (1) 对所有 $v_{h}, w_{h} \\in V_{h}$ 都成立，$Q_{s}^{K}$ 必须能精确地积分任何可以由 $\\nabla v_h \\cdot \\nabla w_h$ 构成的多项式。我们需要积分的最高次多项式的次数是 $2p-2$。因此，我们必须有 $r_{s} \\geq 2p-2$。所以，所需的最紧的，或最低的精确次数为\n$$\nr_{s}^{\\star}(p) = 2p-2.\n$$\n\n质量项积分算子 $Q_{m}^{K}$ 的分析：\n被积函数是 $v_{h} w_{h}$。\n由于 $v_{h}|_{K}$ 和 $w_{h}|_{K}$ 都是 $\\mathcal{P}_{p}(K)$ 中的多项式，它们的乘积 $v_{h} w_{h}$ 是一个总次数至多为 $p + p = 2p$ 的多项式。\n求积法则 $Q_{m}^{K}$ 被定义为对总次数至多为 $r_{m}$ 的多项式是精确的。为了让条件 (2) 对所有 $v_{h}, w_{h} \\in V_{h}$ 都成立，$Q_{m}^{K}$ 必须能精确地积分任何可以由 $v_h w_h$ 构成的多项式。我们需要积分的最高次多项式的次数是 $2p$。因此，我们必须有 $r_{m} \\geq 2p$。所以，所需的最紧的，或最低的精确次数为\n$$\nr_{m}^{\\star}(p) = 2p.\n$$\n\n这些是确保离散双线性形式在有限元空间上与精确形式完全相同的最低求积精确次数，而正如通过 Strang 引理和 Aubin-Nitsche 论证所指出的，这是一个保持最优收敛阶的充分条件。\n最终答案是数组 $(r_{s}^{\\star}(p), r_{m}^{\\star}(p))$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2p - 2  2p\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "标准的有限元误差估计通常依赖于解具有足够正则性（光滑性）的假设。然而，在许多实际问题中，如材料界面问题，解的正则性会降低。此练习探讨了在这种情况下如何分析收敛性，特别是当对偶问题的解正则性受损时，如何利用Aubin-Nitsche对偶论证来预测非最优的 $L^2$ 收敛阶。",
            "id": "3374952",
            "problem": "考虑在等于单位圆盘的区域 $\\Omega \\subset \\mathbb{R}^{2}$ 上的一个二阶线性椭圆偏微分方程 (PDE) 的二维传输问题。令 $\\Gamma \\subset \\Omega$ 为一个光滑、闭合、严格凸的界面，其为半径 $r_{0} \\in (0,1)$ 的圆，将 $\\Omega$ 分割成两个子区域 $\\Omega_{-}$ 和 $\\Omega_{+}$，其中 $\\partial \\Omega_{-} = \\Gamma$ 且 $\\partial \\Omega_{+} = \\Gamma \\cup \\partial \\Omega$。系数 $a(x)$ 是分片常数，在 $\\Omega_{-}$ 中 $a(x) = a_{-}  0$，在 $\\Omega_{+}$ 中 $a(x) = a_{+}  0$，且 $a_{-} \\neq a_{+}$。模型问题为\n$$\n-\\nabla \\cdot \\big(a(x)\\,\\nabla u(x)\\big) = f(x) \\quad \\text{in } \\Omega, \n\\qquad u = 0 \\quad \\text{on } \\partial \\Omega,\n$$\n其在 $\\Gamma$ 上的传输条件由 $u$ 的连续性和法向通量 $a\\,\\partial_{n}u$ 的连续性给出。\n\n假设 $f \\in L^{2}(\\Omega)$，且精确解 $u$ 是分片 $H^{2}$ 的，即 $u|_{\\Omega_{\\pm}} \\in H^{2}(\\Omega_{\\pm})$，其在 $\\Gamma$ 上的迹满足传输条件，因此全局来看 $u \\in H^{1}_{0}(\\Omega)$。考虑一个保形的、贴体的有限元方法 (FEM)，该方法使用能够分辨界面 $\\Gamma$ 的拟一致三角剖分 $\\mathcal{T}_{h}$。令 $V_{h} \\subset H^{1}_{0}(\\Omega)$ 为 $\\mathcal{T}_{h}$ 上的连续分片仿射函数空间。Galerkin 近似解 $u_{h} \\in V_{h}$ 由该偏微分方程诱导的标准双线性形式和线性泛函的变分形式定义。\n\n对于此类界面问题，已知在上述关于 $u$ 的假设下，$H^{1}$ 误差是最优的，但当 $a_{-} \\neq a_{+}$ 时，弯曲的传输条件会降低对偶问题解的正则性。具体来说，对于右端项等于 $L^{2}$ 误差的对偶问题，其解 $z$ 全局属于分数阶 Sobolev 空间 $H^{1+s}(\\Omega)$，其中 $s = \\frac{1}{2}$，尽管 $z$ 是分片 $H^{2}$ 的。\n\n请根据保形 Galerkin 离散化的第一性原理以及上面给出的正则性信息，推导有限元误差的 $L^{2}(\\Omega)$ 范数 $\\|u - u_{h}\\|_{L^{2}(\\Omega)}$ 作为网格尺寸 $h$ 的函数的渐近收敛率。请将最终答案表示为仅含 $h$ 的单一解析表达式。无需四舍五入，也没有物理单位。",
            "solution": "用户提供了一个问题陈述，在尝试解答之前需要进行验证。\n\n### 步骤 1：提取已知条件\n-   **PDE 问题**：在单位圆盘 $\\Omega \\subset \\mathbb{R}^{2}$ 上的一个二维、二阶、线性、椭圆传输问题。\n-   **方程**：$-\\nabla \\cdot \\big(a(x)\\,\\nabla u(x)\\big) = f(x)$ 在 $\\Omega$ 中。\n-   **边界条件**：在 $\\partial \\Omega$ 上 $u = 0$。\n-   **界面**：$\\Gamma$ 是半径为 $r_{0} \\in (0,1)$ 的圆，将 $\\Omega$ 分割成 $\\Omega_{-}$ 和 $\\Omega_{+}$。\n-   **系数**：系数 $a(x)$ 是分片常数：在 $\\Omega_{-}$ 中 $a(x) = a_{-}  0$，在 $\\Omega_{+}$ 中 $a(x) = a_{+}  0$，且 $a_{-} \\neq a_{+}$。\n-   **传输条件**：$u$ 在 $\\Gamma$ 上连续，法向通量 $a\\,\\partial_{n}u$ 在 $\\Gamma$ 上连续。\n-   **源项**：$f \\in L^{2}(\\Omega)$。\n-   **精确解的正则性**：$u \\in H^{1}_{0}(\\Omega)$ 全局成立，且 $u$ 是分片 $H^{2}$ 的，即 $u|_{\\Omega_{\\pm}} \\in H^{2}(\\Omega_{\\pm})$。\n-   **有限元离散化**：使用贴体于界面 $\\Gamma$ 的拟一致三角剖分 $\\mathcal{T}_{h}$ 的保形有限元方法。\n-   **有限元空间**：$V_{h} \\subset H^{1}_{0}(\\Omega)$ 是连续分片仿射函数的空间。\n-   **给定信息**：\n    1.  在给定 $u$ 的正则性下，$H^{1}$ 误差是最优的。\n    2.  以 $L^2$ 误差为右端项的对偶问题的解 $z$ 具有全局正则性 $z \\in H^{1+s}(\\Omega)$，其中 $s = \\frac{1}{2}$。\n\n### 步骤 2：使用提取的已知条件进行验证\n根据指定标准对问题进行验证。\n-   **科学性**：该问题描述了一个经典的椭圆界面问题及其使用有限元方法的数值解法。所使用的概念——Sobolev 空间（$H^k$, $L^2$）、变分形式、Galerkin 方法、Aubin-Nitsche 对偶论证，以及具有不连续系数的椭圆偏微分方程的正则性理论——都是数值分析领域的标准和基础内容。所述原问题和对偶问题解的正则性属性与此类问题的既定数学理论一致。\n-   **适定性**：该问题是适定的。所提供的信息是自洽且充分的，足以唯一确定收敛率。问题表述精确，要求进行有限元误差分析中的标准推导。\n-   **客观性**：该问题以精确、客观的数学语言陈述，没有歧义或主观内容。\n-   **完整性与一致性**：该问题为推导提供了所有必要组成部分：PDE 模型、有限元设置，以及原问题和对偶问题解的关键正则性信息。已知条件内部一致。\n-   **无其他缺陷**：该问题不是平凡、隐喻或不切实际的。它代表了研究带界面的偏微分方程数值方法中的一个典型问题。\n\n### 步骤 3：结论与行动\n该问题是**有效的**。将提供解答。\n\n$L^{2}(\\Omega)$ 范数收敛率的推导通过 Aubin-Nitsche 对偶论证进行。\n\n令 $H^{1}_{0}(\\Omega)$ 为标准 Sobolev 空间，其包含一阶导数平方可积且在边界 $\\partial\\Omega$ 上为零的函数。问题的弱形式是寻找 $u \\in H^1_0(\\Omega)$，使得：\n$$B(u, v) = L(v) \\quad \\forall v \\in H^1_0(\\Omega)$$\n其中双线性形式 $B(\\cdot, \\cdot)$ 和线性泛函 $L(\\cdot)$ 定义为：\n$$B(w, v) = \\int_{\\Omega} a(x) \\nabla w \\cdot \\nabla v \\,dx$$\n$$L(v) = \\int_{\\Omega} f v \\,dx$$\n有限元近似解 $u_h \\in V_h$ 是离散问题的解：\n$$B(u_h, v_h) = L(v_h) \\quad \\forall v_h \\in V_h$$\nGalerkin 方法的一个关键性质是误差 $e = u - u_h$ 的正交性。从弱形式（取 $v=v_h$）中减去离散方程，得到：\n$$B(u - u_h, v_h) = 0 \\quad \\forall v_h \\in V_h$$\n这就是 Galerkin 正交性。\n\n为了估计 $L^2(\\Omega)$ 范数下的误差，我们引入一个辅助（对偶）问题。寻找 $z \\in H^1_0(\\Omega)$，使得：\n$$-\\nabla \\cdot (a(x) \\nabla z) = e$$\n该对偶问题的弱形式是寻找 $z \\in H^1_0(\\Omega)$，使得：\n$$B(v, z) = (v, e)_{L^2(\\Omega)} = \\int_{\\Omega} v e \\,dx \\quad \\forall v \\in H^1_0(\\Omega)$$\n在对偶问题的弱形式中令 $v = e = u - u_h$，我们将误差的 $L^2(\\Omega)$ 范数的平方表示为：\n$$\\|u - u_h\\|_{L^2(\\Omega)}^2 = (e, e)_{L^2(\\Omega)} = B(e, z) = B(u - u_h, z)$$\n利用 Galerkin 正交性，对于任意 $z_h \\in V_h$，我们可以减去 $B(u - u_h, z_h) = 0$：\n$$\\|u - u_h\\|_{L^2(\\Omega)}^2 = B(u - u_h, z - z_h)$$\n双线性形式 $B(\\cdot, \\cdot)$ 在 $H^1(\\Omega) \\times H^1(\\Omega)$ 上是连续的，即存在一个常数 $C  0$ 使得 $B(w, v) \\le C \\|w\\|_{H^1(\\Omega)} \\|v\\|_{H^1(\\Omega)}$。应用此不等式可得：\n$$\\|u - u_h\\|_{L^2(\\Omega)}^2 \\le C \\|u - u_h\\|_{H^1(\\Omega)} \\|z - z_h\\|_{H^1(\\Omega)}$$\n因为这对任意 $z_h \\in V_h$ 都成立，我们可以从 $V_h$ 中选择对 $z$ 的最佳逼近：\n$$\\|u - u_h\\|_{L^2(\\Omega)}^2 \\le C \\|u - u_h\\|_{H^1(\\Omega)} \\inf_{v_h \\in V_h} \\|z - v_h\\|_{H^1(\\Omega)}$$\n现在我们估计右侧的两项。\n\n1.  **$\\|u - u_h\\|_{H^1(\\Omega)}$ 的估计**：题目陈述精确解 $u$ 是分片 $H^2$ 的，即 $u|_{\\Omega_{\\pm}} \\in H^2(\\Omega_{\\pm})$，并且我们正在一个拟一致网格上使用连续分片仿射函数（$P_1$ 单元）。对于这种情况，标准的有限元误差分析（Céa 引理结合插值理论）保证了在能量范数（等价于 $H^1$ 范数）下的最优收敛率。该收敛率与网格尺寸 $h$ 呈线性关系：\n    $$\\|u - u_h\\|_{H^1(\\Omega)} \\le C_1 h^1 \\|u\\|_{\\text{piecewise }H^2} = \\mathcal{O}(h)$$\n\n2.  **$\\inf_{v_h \\in V_h} \\|z - v_h\\|_{H^1(\\Omega)}$ 的估计**：此项是空间 $V_h$ 中对偶解 $z$ 的最佳逼近误差。题目提供了关键信息，即对偶解的全局正则性为 $z \\in H^{1+s}(\\Omega)$，其中 $s = \\frac{1}{2}$。$P_1$ 有限元的标准逼近理论指出，对于 $H^{1+s}(\\Omega)$ 中的函数，其在 $H^1$ 范数下的最佳逼近误差有如下界：\n    $$\\inf_{v_h \\in V_h} \\|z - v_h\\|_{H^1(\\Omega)} \\le C_2 h^s \\|z\\|_{H^{1+s}(\\Omega)}$$\n    代入 $s = \\frac{1}{2}$，我们得到：\n    $$\\inf_{v_h \\in V_h} \\|z - v_h\\|_{H^1(\\Omega)} \\le C_2 h^{\\frac{1}{2}} \\|z\\|_{H^{1+\\frac{1}{2}}(\\Omega)}$$\n\n结合这两个估计，我们有：\n$$\\|u - u_h\\|_{L^2(\\Omega)}^2 \\le C (C_1 h) \\left( C_2 h^{\\frac{1}{2}} \\|z\\|_{H^{1+\\frac{1}{2}}(\\Omega)} \\right)$$\n对偶问题的椭圆正则性保证了解 $z$ 受其源项 $e = u - u_h$ 的界定：\n$$\\|z\\|_{H^{1+\\frac{1}{2}}(\\Omega)} \\le C_{\\text{reg}} \\|u-u_h\\|_{L^2(\\Omega)}$$\n将此正则性估计代回我们的误差不等式，得到：\n$$\\|u - u_h\\|_{L^2(\\Omega)}^2 \\le C_3 h^{1+\\frac{1}{2}} \\|u - u_h\\|_{L^2(\\Omega)} = C_3 h^{\\frac{3}{2}} \\|u - u_h\\|_{L^2(\\Omega)}$$\n其中 $C_3$ 是一个与 $h$ 无关的通用常数。假设误差非零，我们可以在两边同除以 $\\|u - u_h\\|_{L^2(\\Omega)}$：\n$$\\|u - u_h\\|_{L^2(\\Omega)} \\le C_3 h^{\\frac{3}{2}}$$\n这表明误差的 $L^2(\\Omega)$ 范数的渐近收敛率为 $\\mathcal{O}(h^{\\frac{3}{2}})$。问题要求将此率表示为 $h$ 的函数。",
            "answer": "$$\\boxed{h^{\\frac{3}{2}}}$$"
        }
    ]
}