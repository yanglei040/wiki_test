{
    "hands_on_practices": [
        {
            "introduction": "理论学习的核心在于实践应用。本节的第一个练习将通过一个源于对流扩散偏微分方程离散化的具体例子，直观地展示数值不稳定性问题。通过亲手计算，您将发现朴素的高斯消元法为何会失败，并理解为何部分主元法（partial pivoting）在确保数值稳定性的同时，会引入我们不希望看到的“填充”（fill-in）项。这个练习旨在揭示在求解大型稀疏线性系统时，数值稳定性与保持稀疏性这对核心矛盾。",
            "id": "3432280",
            "problem": "考虑区间 $\\left(0,1\\right)$ 上的稳态一维对流扩散偏微分方程，其带有齐次狄利克雷边界条件，\n$$ -\\kappa \\, u''(x) + b \\, u'(x) = f(x), \\quad u(0)=0,\\; u(1)=0, $$\n该方程在间距为 $h=\\frac{1}{5}$ 的均匀网格上通过二阶中心有限差分进行离散。取扩散系数 $\\kappa=10^{-3}$ 和对流速度 $b=1$。在四个内部节点上对 $u''(x)$ 和 $u'(x)$ 使用标准的三点差分格式，得到的线性系统具有一个三对角系数矩阵 $A \\in \\mathbb{R}^{4 \\times 4}$，其副对角线、对角线和超对角线上的元素均为常数\n$$ a \\equiv -\\frac{\\kappa}{h^{2}} - \\frac{b}{2h}, \\quad d \\equiv \\frac{2\\kappa}{h^{2}}, \\quad c \\equiv -\\frac{\\kappa}{h^{2}} + \\frac{b}{2h}. $$\n请仅从 $u''(x)$ 和 $u'(x)$ 的有限差分近似的定义、弱对角占优的定义、高斯消元的定义以及部分主元法的定义出发，回答以下问题。\n\n1. 推导出 $a$、$d$ 和 $c$ 的具体数值，并明确写出矩阵 $A$。\n2. 验证矩阵 $A$ 在内部行不满足弱对角占优条件。\n3. 对矩阵 $A$ 执行不带主元选择的高斯消元法的第一步。计算乘子 $m_{21} \\equiv a/d$ 以及在消去第 $(2,1)$ 个元素后更新的第二行对角线元素。解释为什么这表明在使用有限精度算术时存在潜在的不稳定性。\n4. 现在执行带部分主元选择的高斯消元法（部分主元法在每一步 $k$ 中，选择绝对值最大的元素 $|a_{\\ell k}|$ 所在的行 $\\ell \\ge k$，并在消元前交换第 $k$ 行和第 $\\ell$ 行）。跟踪所有步骤中的行交换和随后的消元过程。将“填充元”（fill-in）定义为在给定步骤中，初始置换矩阵中为零，但由于该步骤的消元更新而变为非零的任何元素。确定在整个带部分主元选择的分解过程中产生的填充元总数。\n\n您的最终答案必须是部分主元法产生的填充元总数，表示为一个整数，不带单位，也无附加文本。无需四舍五-入。",
            "solution": "根据要求，将从指定的基本定义出发，分四个部分对问题进行分析。\n\n首先，我们推导矩阵元素 $a$、$d$ 和 $c$ 的表达式。给定的偏微分方程是\n$$ -\\kappa \\, u''(x) + b \\, u'(x) = f(x). $$\n我们在一个均匀网格 $x_i = i h$（其中 $i=0, 1, \\dots, N+1$）上离散化该方程，网格间距为 $h = \\frac{1}{N+1}$。本问题中，$h=\\frac{1}{5}$，因此 $N+1=5$，有 $N=4$ 个内部节点。令 $u_i \\approx u(x_i)$。在内部节点 $x_i$ 处，导数的二阶中心有限差分近似为：\n$$ u'(x_i) \\approx \\frac{u_{i+1} - u_{i-1}}{2h} $$\n$$ u''(x_i) \\approx \\frac{u_{i-1} - 2u_i + u_{i+1}}{h^2} $$\n将这些近似值代入偏微分方程，得到每个内部节点 $i=1, 2, 3, 4$ 的差分方程：\n$$ -\\kappa \\left( \\frac{u_{i-1} - 2u_i + u_{i+1}}{h^2} \\right) + b \\left( \\frac{u_{i+1} - u_{i-1}}{2h} \\right) = f_i $$\n我们重新排列各项，将 $u_{i-1}$、$u_i$ 和 $u_{i+1}$ 的系数分组：\n$$ \\left( -\\frac{\\kappa}{h^2} - \\frac{b}{2h} \\right) u_{i-1} + \\left( \\frac{2\\kappa}{h^2} \\right) u_i + \\left( -\\frac{\\kappa}{h^2} + \\frac{b}{2h} \\right) u_{i+1} = f_i $$\n由此，我们确定矩阵 $A$ 的副对角线、对角线和超对角线元素的系数：\n$$ a = -\\frac{\\kappa}{h^2} - \\frac{b}{2h} $$\n$$ d = \\frac{2\\kappa}{h^2} $$\n$$ c = -\\frac{\\kappa}{h^2} + \\frac{b}{2h} $$\n利用给定的值 $\\kappa=10^{-3}$、$b=1$ 和 $h=\\frac{1}{5}=0.2$，我们计算其数值：\n$$ h^2 = (0.2)^2 = 0.04 $$\n$$ \\frac{\\kappa}{h^2} = \\frac{10^{-3}}{0.04} = \\frac{0.001}{0.04} = 0.025 $$\n$$ \\frac{b}{2h} = \\frac{1}{2(0.2)} = \\frac{1}{0.4} = 2.5 $$\n因此，矩阵元素为：\n$$ a = -0.025 - 2.5 = -2.525 $$\n$$ d = 2 \\times 0.025 = 0.05 $$\n$$ c = -0.025 + 2.5 = 2.475 $$\n得到的 $4 \\times 4$ 三对角矩阵 $A$ 为：\n$$ A = \\begin{pmatrix} d & c & 0 & 0 \\\\ a & d & c & 0 \\\\ 0 & a & d & c \\\\ 0 & 0 & a & d \\end{pmatrix} = \\begin{pmatrix} 0.05 & 2.475 & 0 & 0 \\\\ -2.525 & 0.05 & 2.475 & 0 \\\\ 0 & -2.525 & 0.05 & 2.475 \\\\ 0 & 0 & -2.525 & 0.05 \\end{pmatrix} $$\n\n其次，我们验证 $A$ 不满足弱对角占优条件。一个矩阵是弱对角占优的，如果对于每一行 $i$，对角线元素的绝对值大于或等于该行非对角线元素绝对值之和，即 $|A_{ii}| \\ge \\sum_{j \\neq i} |A_{ij}|$。我们以第2行为例，检查内部行的这个条件：\n对角线元素为 $A_{22} = d = 0.05$。非对角线元素为 $A_{21} = a = -2.525$ 和 $A_{23} = c = 2.475$。\n第2行的条件是：\n$$ |A_{22}| \\ge |A_{21}| + |A_{23}| $$\n代入数值：\n$$ |0.05| \\ge |-2.525| + |2.475| $$\n$$ 0.05 \\ge 2.525 + 2.475 $$\n$$ 0.05 \\ge 5.0 $$\n此不等式不成立，因此矩阵 $A$ 不是弱对角占优的。其物理原因是该问题为对流占优问题，这由较大的网格佩克莱数 $P_e = \\frac{bh}{2\\kappa} = \\frac{1 \\cdot 0.2}{2 \\cdot 10^{-3}} = 100 \\gg 1$ 所表明。\n\n第三，我们执行不带主元选择的高斯消元法的第一步。目标是消去元素 $A_{21}$。主元是 $A_{11} = d = 0.05$。乘子定义为 $m_{21} = \\frac{A_{21}}{A_{11}}$。\n$$ m_{21} = \\frac{a}{d} = \\frac{-2.525}{0.05} = -50.5 $$\n第二行的更新操作为 $R_2 \\leftarrow R_2 - m_{21} R_1$。更新后的对角线元素 $A'_{22}$ 计算如下：\n$$ A'_{22} = A_{22} - m_{21}A_{12} = d - m_{21}c = 0.05 - (-50.5)(2.475) $$\n$$ A'_{22} = 0.05 + 124.9875 = 125.0375 $$\n在有限精度环境下，此过程的不稳定性由乘子的大幅值 $|m_{21}| = 50.5 \\gg 1$ 所表明。这是因为主元 $A_{11}=0.05$ 相对于它要消去的元素 $A_{21}=-2.525$ 而言非常小。在计算更新后的元素 $A'_{22}$ 时，一个小数 ($d=0.05$) 与一个非常大的数 ($|m_{21} c|=124.9875$) 相加。在精度有限的浮点运算中，这可能导致小数所包含的信息丢失（即“大数吃小数”现象），舍入误差在整个计算过程中传播和放大，可能使最终解变得毫无意义。\n\n第四，我们执行带部分主元选择的高斯消元法，并计算填充元的总数。填充元是在某一步开始时，置换矩阵中为零，但在该步的消元更新后变为非零的元素。\n\n步骤 $k=1$：\n初始矩阵为 $A^{(0)} = A$。\n$$ A^{(0)} = \\begin{pmatrix} 0.05 & 2.475 & 0 & 0 \\\\ -2.525 & 0.05 & 2.475 & 0 \\\\ 0 & -2.525 & 0.05 & 2.475 \\\\ 0 & 0 & -2.525 & 0.05 \\end{pmatrix} $$\n为了选择主元，我们检查第1列。我们找到绝对值最大的元素：$\\max(|0.05|, |-2.525|, |0|, |0|) = 2.525$，它位于第2行。我们交换第1行和第2行。置换后的矩阵为：\n$$ A'^{(0)} = \\begin{pmatrix} -2.525 & 0.05 & 2.475 & 0 \\\\ 0.05 & 2.475 & 0 & 0 \\\\ 0 & -2.525 & 0.05 & 2.475 \\\\ 0 & 0 & -2.525 & 0.05 \\end{pmatrix} $$\n现在我们进行消元。只需要消去元素 $A'_{21} = 0.05$。乘子是 $m_{21} = \\frac{0.05}{-2.525}$。更新操作为 $R_2 \\leftarrow R_2 - m_{21}R_1$。原始的第2行 $R_2$ 是 $(0.05, 2.475, 0, 0)$。主元行 $R_1$ 是 $(-2.525, 0.05, 2.475, 0)$。\n新的第 $(2,3)$ 个元素是 $A'_{23} - m_{21}A'_{13} = 0 - m_{21}(2.475)$。由于 $m_{21} \\neq 0$ 且 $A'_{13} \\neq 0$，该元素变为非零。在 $A'^{(0)}$ 中，原始的第 $(2,3)$ 个元素是 $0$。这构成了一个填充元。\n新的第 $(2,4)$ 个元素是 $A'_{24} - m_{21}A'_{14} = 0 - m_{21}(0) = 0$。这里没有填充元。\n因此，在步骤1中，位置 $(2,3)$ 处有1个填充元。\n\n步骤 $k=2$：\n步骤1后的矩阵 $A^{(1)}$ 具有以下结构：\n$$ A^{(1)} = \\begin{pmatrix} -2.525 & 0.05 & 2.475 & 0 \\\\ 0 & A^{(1)}_{22} & A^{(1)}_{23} & 0 \\\\ 0 & -2.525 & 0.05 & 2.475 \\\\ 0 & 0 & -2.525 & 0.05 \\end{pmatrix} $$\n为了选择主元，我们从第2行开始检查第2列。候选主元是 $A^{(1)}_{22} = 2.475 - m_{21}(0.05) \\approx 2.476$ 和 $A^{(1)}_{32} = -2.525$。由于 $|-2.525| > |2.476|$，我们交换第2行和第3行。此步骤的置换矩阵为：\n$$ A'^{(1)} = \\begin{pmatrix} -2.525 & 0.05 & 2.475 & 0 \\\\ 0 & -2.525 & 0.05 & 2.475 \\\\ 0 & A^{(1)}_{22} & A^{(1)}_{23} & 0 \\\\ 0 & 0 & -2.525 & 0.05 \\end{pmatrix} $$\n我们消去元素 $A'_{32} = A^{(1)}_{22}$。乘子是 $m_{32} = \\frac{A^{(1)}_{22}}{-2.525}$。更新操作为 $R_3 \\leftarrow R_3 - m_{32}R_2$。在 $A'^{(1)}$ 中，原始的第3行 $R_3$ 是 $(0, A^{(1)}_{22}, A^{(1)}_{23}, 0)$。主元行 $R_2$ 是 $(0, -2.525, 0.05, 2.475)$。\n新的第 $(3,4)$ 个元素是 $A'_{34} - m_{32}A'_{24} = 0 - m_{32}(2.475)$。由于 $m_{32} \\neq 0$ 且 $A'_{24} \\neq 0$，该元素变为非零。在 $A'^{(1)}$ 中，原始的第 $(3,4)$ 个元素是 $0$。这构成了第二个填充元。\n因此，在步骤2中，位置 $(3,4)$ 处有1个填充元。\n\n步骤 $k=3$：\n步骤2后的矩阵 $A^{(2)}$ 具有以下结构：\n$$ A^{(2)} = \\begin{pmatrix} -2.525 & 0.05 & 2.475 & 0 \\\\ 0 & -2.525 & 0.05 & 2.475 \\\\ 0 & 0 & A^{(2)}_{33} & A^{(2)}_{34} \\\\ 0 & 0 & -2.525 & 0.05 \\end{pmatrix} $$\n为了选择主元，我们从第3行开始检查第3列。候选主元是 $A^{(2)}_{33}$ 和 $A^{(2)}_{43} = -2.525$。$A^{(2)}_{33}$ 的值是上一步更新的结果，与 $-2.525$ 相比很小。具体来说，$A^{(2)}_{33} \\approx 0.098$。\n由于 $|-2.525| > |A^{(2)}_{33}|$，我们交换第3行和第4行。置换后的矩阵为：\n$$ A'^{(2)} = \\begin{pmatrix} -2.525 & 0.05 & 2.475 & 0 \\\\ 0 & -2.525 & 0.05 & 2.475 \\\\ 0 & 0 & -2.525 & 0.05 \\\\ 0 & 0 & A^{(2)}_{33} & A^{(2)}_{34} \\end{pmatrix} $$\n我们消去元素 $A'_{43} = A^{(2)}_{33}$。更新操作为 $R_4 \\leftarrow R_4 - m_{43}R_3$。在 $A'^{(2)}$ 中，原始的第4行 $R_4$ 是 $(0, 0, A^{(2)}_{33}, A^{(2)}_{34})$。主元行 $R_3$ 是 $(0, 0, -2.525, 0.05)$。\n第4行中唯一可以被修改的元素位于第3列和第4列。$A'_{43}$ 和 $A'_{44}$ 都已经是非零值。消元过程使 $A'_{43}$ 变为零，并更新 $A'_{44}$。没有元素从零变为非零。\n因此，在步骤3中没有填充元。\n\n在整个分解过程中产生的填充元总数是各步骤填充元之和：$1 + 1 + 0 = 2$。",
            "answer": "$$ \\boxed{2} $$"
        },
        {
            "introduction": "在认识到填充问题后，自然会引出一个问题：我们能否在执行消元前预测并选择能产生最少填充的主元？Markowitz启发式算法正是为此而生。这个练习将引导您计算不同主元候选项的Markowitz计数，这是一个预测填充量的指标，并量化当引入数值稳定性阈值后，我们为了稳定性必须在稀疏性上付出的代价。通过此练习，您将掌握一种在稀疏矩阵分解中进行前瞻性决策的关键工具。",
            "id": "3432289",
            "problem": "考虑稀疏矩阵 $A \\in \\mathbb{R}^{6 \\times 6}$，该矩阵由在带有迎风偏置的非均匀网格上对一维对流-扩散偏微分方程（PDE）进行有限体积离散化而产生。得到的非对称近带状矩阵为\n$$\nA=\\begin{pmatrix}\n3  & 1.5 & 0 & 0 & 0 & 0 \\\\\n10 & 9 & 0.5 & 0 & 0 & 0 \\\\\n0 & 2 & 8 & 1 & 0 & 0 \\\\\n0 & 0 & 1.2 & 7 & 0.8 & 0 \\\\\n0 & 0 & 0 & 1.1 & 7 & 8 \\\\\n0 & 0 & 0 & 0 & 3 & 2\n\\end{pmatrix}.\n$$\n在稀疏高斯消元的第一个消元步骤中，您将构建候选主元的 Markowitz 集，并使用标准的 Markowitz 启发式方法预测由一个主元产生的填充。然后，您将施加一个数值主元阈值来限制候选主元，并评估这将如何改变预测的填充。\n\n任务：\n- 使用标准的 Markowitz 主元选择启发式方法，在初始消元步骤（无先前消元）为 $A$ 构建 Markowitz 集。对于每个非零候选主元 $a_{ij}$，设 $r_i$ 为 $A$ 中第 $i$ 行的结构性非零元数量，设 $c_j$ 为 $A$ 中第 $j$ 列的结构性非零元数量。$a_{ij}$ 的 Markowitz 计数是 $(r_i-1)$ 和 $(c_j-1)$ 的乘积。找出 $A$ 中使此计数最小化的位置集合。\n- 施加数值主元阈值：将候选主元 $a_{ij}$ 限制为满足基于列的条件 $|a_{ij}| \\ge \\alpha \\cdot \\max_{p} |a_{pj}|$ 的元素，其中 $\\alpha=0.4$，且最大值取自第 $j$ 列中所有的结构性非零元。在受限制的候选者中，确定初始消元步骤可达到的最小 Markowitz 计数。\n- 设 $\\rho$ 为最小受限 Markowitz 计数与最小不受限 Markowitz 计数之比。计算 $\\rho$。\n\n将最终答案表示为单个数字 $\\rho$。无需四舍五-入。无需单位。",
            "solution": "问题要求使用 Markowitz 启发式方法，对稀疏矩阵 $A$ 的主元选择进行分析，分析包括有和没有数值稳定性阈值两种情况。给定的矩阵为：\n$$\nA=\\begin{pmatrix}\n3  & 1.5 & 0 & 0 & 0 & 0 \\\\\n10 & 9 & 0.5 & 0 & 0 & 0 \\\\\n0 & 2 & 8 & 1 & 0 & 0 \\\\\n0 & 0 & 1.2 & 7 & 0.8 & 0 \\\\\n0 & 0 & 0 & 1.1 & 7 & 8 \\\\\n0 & 0 & 0 & 0 & 3 & 2\n\\end{pmatrix}\n$$\n\n潜在主元 $a_{ij}$ 的 Markowitz 计数定义为 $M_{ij} = (r_i - 1)(c_j - 1)$，其中 $r_i$ 是第 $i$ 行的结构性非零元数量，$c_j$ 是第 $j$ 列的结构性非零元数量。如果选择 $a_{ij}$ 作为主元，该计数预测了将在舒尔补（Schur complement）中产生的“填充”元素数量。\n\n首先，我们确定在初始步骤中矩阵 $A$ 的每行（$r_i$）和每列（$c_j$）的非零元数量。\n各行的计数如下：\n$r_1 = 2$\n$r_2 = 3$\n$r_3 = 3$\n$r_4 = 3$\n$r_5 = 3$\n$r_6 = 2$\n\n各列的计数如下：\n$c_1 = 2$\n$c_2 = 3$\n$c_3 = 3$\n$c_4 = 3$\n$c_5 = 3$\n$c_6 = 2$\n\n第1部分：不受限的 Markowitz 主元选择\n我们计算矩阵 $A$ 中每个非零元 $a_{ij}$ 的 Markowitz 计数 $M_{ij}$。\n对于 $a_{11}$: $M_{11} = (r_1-1)(c_1-1) = (2-1)(2-1) = 1$。\n对于 $a_{12}$: $M_{12} = (r_1-1)(c_2-1) = (2-1)(3-1) = 2$。\n对于 $a_{21}$: $M_{21} = (r_2-1)(c_1-1) = (3-1)(2-1) = 2$。\n对于 $a_{22}$: $M_{22} = (r_2-1)(c_2-1) = (3-1)(3-1) = 4$。\n对于 $a_{23}$: $M_{23} = (r_2-1)(c_3-1) = (3-1)(3-1) = 4$。\n对于 $a_{32}$: $M_{32} = (r_3-1)(c_2-1) = (3-1)(3-1) = 4$。\n对于 $a_{33}$: $M_{33} = (r_3-1)(c_3-1) = (3-1)(3-1) = 4$。\n对于 $a_{34}$: $M_{34} = (r_3-1)(c_4-1) = (3-1)(3-1) = 4$。\n对于 $a_{43}$: $M_{43} = (r_4-1)(c_3-1) = (3-1)(3-1) = 4$。\n对于 $a_{44}$: $M_{44} = (r_4-1)(c_4-1) = (3-1)(3-1) = 4$。\n对于 $a_{45}$: $M_{45} = (r_4-1)(c_5-1) = (3-1)(3-1) = 4$。\n对于 $a_{54}$: $M_{54} = (r_5-1)(c_4-1) = (3-1)(3-1) = 4$。\n对于 $a_{55}$: $M_{55} = (r_5-1)(c_5-1) = (3-1)(3-1) = 4$。\n对于 $a_{56}$: $M_{56} = (r_5-1)(c_6-1) = (3-1)(2-1) = 2$。\n对于 $a_{65}$: $M_{65} = (r_6-1)(c_5-1) = (2-1)(3-1) = 2$。\n对于 $a_{66}$: $M_{66} = (r_6-1)(c_6-1) = (2-1)(2-1) = 1$。\n\n使 Markowitz 计数最小化的候选位置是 $(1,1)$ 和 $(6,6)$。最小的不受限 Markowitz 计数为 $1$。\n\n第2部分：受限的 Markowitz 主元选择\n我们施加一个基于列的数值主元阈值条件 $|a_{ij}| \\ge \\alpha \\cdot \\max_{p} |a_{pj}|$，其中 $\\alpha=0.4$。我们测试每个非零元以确定它是否为有效候选者。\n\n对于列 $j=1$：非零元是 $a_{11}=3$ 和 $a_{21}=10$。$\\max_p|a_{p1}| = |10| = 10$。阈值为 $0.4 \\times 10 = 4$。\n$|a_{11}| = 3  4$，因此 $a_{11}$ 不是候选者。\n$|a_{21}| = 10 \\ge 4$，因此 $a_{21}$ 是候选者。\n\n对于列 $j=2$：非零元是 $a_{12}=1.5$、$a_{22}=9$、$a_{32}=2$。$\\max_p|a_{p2}| = |9| = 9$。阈值为 $0.4 \\times 9 = 3.6$。\n$|a_{12}|=1.5  3.6, |a_{32}|=2  3.6$。两者都不是候选者。\n$|a_{22}|=9 \\ge 3.6$，因此 $a_{22}$ 是候选者。\n\n对于列 $j=3$：非零元是 $a_{23}=0.5$、$a_{33}=8$、$a_{43}=1.2$。$\\max_p|a_{p3}| = |8| = 8$。阈值为 $0.4 \\times 8 = 3.2$。\n$|a_{23}|=0.5  3.2, |a_{43}|=1.2  3.2$。两者都不是候选者。\n$|a_{33}|=8 \\ge 3.2$，因此 $a_{33}$ 是候选者。\n\n对于列 $j=4$：非零元是 $a_{34}=1$、$a_{44}=7$、$a_{54}=1.1$。$\\max_p|a_{p4}| = |7| = 7$。阈值为 $0.4 \\times 7 = 2.8$。\n$|a_{34}|=1  2.8, |a_{54}|=1.1  2.8$。两者都不是候选者。\n$|a_{44}|=7 \\ge 2.8$，因此 $a_{44}$ 是候选者。\n\n对于列 $j=5$：非零元是 $a_{45}=0.8$、$a_{55}=7$、$a_{65}=3$。$\\max_p|a_{p5}| = |7| = 7$。阈值为 $0.4 \\times 7 = 2.8$。\n$|a_{45}|=0.8  2.8$，不是候选者。\n$|a_{55}|=7 \\ge 2.8$，因此 $a_{55}$ 是候选者。\n$|a_{65}|=3 \\ge 2.8$，因此 $a_{65}$ 是候选者。\n\n对于列 $j=6$：非零元是 $a_{56}=8$ 和 $a_{66}=2$。$\\max_p|a_{p6}| = |8| = 8$。阈值为 $0.4 \\times 8 = 3.2$。\n$|a_{66}|=2  3.2$，不是候选者。\n$|a_{56}|=8 \\ge 3.2$，因此 $a_{56}$ 是候选者。\n\n受限的候选主元集合为 $\\{ a_{21}, a_{22}, a_{33}, a_{44}, a_{55}, a_{65}, a_{56} \\}$。我们现在计算这些候选者的 Markowitz 计数：\n$M_{21} = (r_2-1)(c_1-1) = (3-1)(2-1) = 2$。\n$M_{22} = (r_2-1)(c_2-1) = (3-1)(3-1) = 4$。\n$M_{33} = (r_3-1)(c_3-1) = (3-1)(3-1) = 4$。\n$M_{44} = (r_4-1)(c_4-1) = (3-1)(3-1) = 4$。\n$M_{55} = (r_5-1)(c_5-1) = (3-1)(3-1) = 4$。\n$M_{65} = (r_6-1)(c_5-1) = (2-1)(3-1) = 2$。\n$M_{56} = (r_5-1)(c_6-1) = (3-1)(2-1) = 2$。\n\n在受限候选者中，最小的 Markowitz 计数是 $2$。\n\n第3部分：计算比率 $\\rho$\n比率 $\\rho$ 是最小受限 Markowitz 计数除以最小不受限 Markowitz 计数的结果。\n最小不受限计数 = $1$。\n最小受限计数 = $2$。\n因此，比率为：\n$$\n\\rho = \\frac{2}{1} = 2\n$$\n这个旨在确保稳定性的数值阈值，排除了那些本可以产生最少填充的主元，从而迫使选择具有更高 Markowitz 计数的主元。这说明了在保持稀疏性（低填充）和确保数值稳定性之间的权衡。",
            "answer": "$$\\boxed{2}$$"
        },
        {
            "introduction": "将稳定性和稀疏性控制结合起来，是现代稀疏直接求解器设计的核心。本练习模拟了一个更真实的场景，要求您应用一种混合主元策略——结合阈值部分主元法与Markowitz启发式算法——来完成整个LU分解过程。您将不再是预测填充，而是要追踪并计算在这种平衡策略下实际产生的总填充量。这个实践将帮助您巩固对如何动态平衡数值稳定性与计算效率的理解。",
            "id": "3432313",
            "problem": "考虑一个稀疏线性系统，它是在一个小的 $2\\times 2$ 内部网格上对一个对流扩散偏微分方程(PDE)进行有限差分离散化，并施加狄利克雷边界条件和一个导致轻微非对称性的稳定化后产生的。得到的系数矩阵为\n$$\nA \\;=\\;\n\\begin{pmatrix}\n10  2  0  0  3 \\\\\n9  \\tfrac{1}{2}  0  0  0 \\\\\n0  1  8  -2  0 \\\\\n0  0  -3  7  1 \\\\\n2  0  0  5  6\n\\end{pmatrix}.\n$$\n使用以下组合主元选择策略，在每一步 $k$ 中执行高斯消去法来计算其LU分解：\n\n1. 在第 $k$ 列使用阈值部分主元法，阈值为 $\\tau = \\tfrac{4}{5}$。也就是说，在行 $i \\ge k$ 中，将候选行限制在满足 $|a_{ik}| \\ge \\tau \\max_{j \\ge k} |a_{jk}|$ 的那些行。\n2. 在这些候选行中，应用 Markowitz 启发式策略：选择能够最小化由 Markowitz 乘积 $(r_i - 1)(c_k - 1)$ 度量的预测填充数的主元行，其中 $r_i$ 是当前活动子矩阵中第 $i$ 行的结构性非零元数量，而 $c_k$ 是当前活动子矩阵中第 $k$ 列的结构性非零元数量。在这种按列处理的情况下，$c_k$ 是固定的，因此这简化为选择具有最小 $r_i$ 的候选行。如果出现平局，为了数值稳定性，优先选择 $|a_{ik}|$ 较大的候选行。\n\n假设只进行行置换（不进行列置换）。定义“填充元”为在原始矩阵 $A$ 中为零，但在LU分解过程中的任何时刻（无论是在严格下三角因子 $L$ 中通过成为乘子的次对角线元素，还是在上三角因子 $U$ 中通过舒尔补更新）变为结构性非零的任何矩阵元素。\n\n当对矩阵 $A$ 应用上述策略时，计算在整个分解过程中引入的填充非零元的总数。将您的答案表示为一个不带单位的整数。",
            "solution": "解决方案涉及逐步执行高斯消去法，在每一步应用指定的主元选择策略，并跟踪在矩阵 $A$ 中最初为零的位置上产生非零元素的情况。设 $A^{(k)}$ 为第 $k$ 步开始时的矩阵，其中 $A^{(1)} = A$。我们还将跟踪行置换向量 $p$，初始时 $p = (1, 2, 3, 4, 5)$。如果 $A_{ij}=0$ 但在分解过程中对应的元素变为非零，则在原始矩阵位置 $(i, j)$ 处发生填充。\n\n$A$ 的初始稀疏模式显示在 $(1,3), (1,4), (2,3), (2,4), (2,5), (3,1), (3,5), (4,1), (4,2), (5,2), (5,3)$ 等位置为零。\n\n**步骤 $k=1$：**\n矩阵是 $A^{(1)} = A$。我们考虑第 1 列。\n1.  **阈值主元法**：\n    -   第 1 列的元素是 $a_{11}=10$, $a_{21}=9$, $a_{31}=0$, $a_{41}=0$, $a_{51}=2$。\n    -   最大绝对值为 $\\max_{j \\ge 1} |a_{j1}| = |10| = 10$。\n    -   阈值为 $\\tau \\times 10 = \\frac{4}{5} \\times 10 = 8$。\n    -   我们寻找满足 $|a_{i1}| \\ge 8$ 的行 $i \\ge 1$。候选行是第 1 行 ($|10| \\ge 8$) 和第 2 行 ($|9| \\ge 8$)。\n2.  **Markowitz 启发式策略**：\n    -   对于候选行 1，非零元数量为 $r_1=3$（元素为 $10, 2, 3$）。\n    -   对于候选行 2，非零元数量为 $r_2=2$（元素为 $9, \\frac{1}{2}$）。\n    -   我们选择具有最小 $r_i$ 的行，即第 2 行 ($r_2=2  r_1=3$)。\n3.  **操作**：\n    -   主元是 $a_{21}=9$。我们交换第 1 行和第 2 行。置换向量变为 $p = (2, 1, 3, 4, 5)$。\n    -   置换后的矩阵是：\n        $$\n        A^{(1.5)} = \\begin{pmatrix}\n        9  \\tfrac{1}{2}  0  0  0 \\\\\n        10  2  0  0  3 \\\\\n        0  1  8  -2  0 \\\\\n        0  0  -3  7  1 \\\\\n        2  0  0  5  6\n        \\end{pmatrix}\n        $$\n4.  **消元**：\n    -   第 1 列的乘子为：$l_{21} = \\frac{10}{9}$, $l_{31}=0$, $l_{41}=0$, $l_{51} = \\frac{2}{9}$。\n    -   更新第 2 行：$R_2 \\leftarrow R_2 - \\frac{10}{9}R_1 = (10, 2, 0, 0, 3) - \\frac{10}{9}(9, \\frac{1}{2}, 0, 0, 0) = (0, \\frac{13}{9}, 0, 0, 3)$。此行没有产生填充元。\n    -   更新第 5 行：$R_5 \\leftarrow R_5 - \\frac{2}{9}R_1 = (2, 0, 0, 5, 6) - \\frac{2}{9}(9, \\frac{1}{2}, 0, 0, 0) = (0, -\\frac{1}{9}, 0, 5, 6)$。\n    -   更新在位置 $(5,2)$ 处产生了一个非零元。原始矩阵元素 $A_{52}=0$。这是一个**填充元**。\n    -   **填充元计数 = 1**。填充位置是 $(5,2)$。\n下一步的矩阵状态 $A^{(2)}$，结合了上三角部分和更新后的行：\n$$\nA^{(2)} \\text{ (structure)} \\rightarrow \\begin{pmatrix}\n9  \\tfrac{1}{2}  0  0  0 \\\\\n\\cdot  \\tfrac{13}{9}  0  0  3 \\\\\n\\cdot  1  8  -2  0 \\\\\n\\cdot  0  -3  7  1 \\\\\n\\cdot  -\\tfrac{1}{9}  0  5  6\n\\end{pmatrix}\n$$\n\n**步骤 $k=2$：**\n我们考虑活动子矩阵 $A^{(2)}(2:5, 2:5)$ 及其第 1 列（即 $A^{(2)}$ 的第 2 列）。\n1.  **阈值主元法**：\n    -   元素为 $a_{22}=\\frac{13}{9}, a_{32}=1, a_{42}=0, a_{52}=-\\frac{1}{9}$。\n    -   最大绝对值为 $\\max_{j \\ge 2} |a_{j2}| = |\\frac{13}{9}| \\approx 1.44$。\n    -   阈值为 $\\tau \\times \\frac{13}{9} = \\frac{4}{5} \\times \\frac{13}{9} = \\frac{52}{45} \\approx 1.15$。\n    -   我们寻找满足 $|a_{i2}| \\ge \\frac{52}{45}$ 的行 $i \\ge 2$。唯一的候选行是第 2 行 ($|\\frac{13}{9}| = \\frac{65}{45} \\ge \\frac{52}{45}$)。\n2.  **操作**：\n    -   主元是 $a_{22}=\\frac{13}{9}$。不需要交换行。置换向量保持为 $p = (2, 1, 3, 4, 5)$。\n3.  **消元**：\n    -   第 2 列的乘子为：$l_{32} = \\frac{1}{13/9} = \\frac{9}{13}$, $l_{42}=0$, $l_{52} = \\frac{-1/9}{13/9} = -\\frac{1}{13}$。\n    -   更新第 3 行：$R_3 \\leftarrow R_3 - \\frac{9}{13}R_2 = (0, 1, 8, -2, 0) - \\frac{9}{13}(0, \\frac{13}{9}, 0, 0, 3) = (0, 0, 8, -2, -\\frac{27}{13})$。\n    -   更新在位置 $(3,5)$ 处产生了一个非零元。原始矩阵元素 $A_{35}=0$。这是一个**填充元**。\n    -   更新第 5 行：$R_5 \\leftarrow R_5 - (-\\frac{1}{13})R_2 = (0, -\\frac{1}{9}, 0, 5, 6) + \\frac{1}{13}(0, \\frac{13}{9}, 0, 0, 3) = (0, 0, 0, 5, 6+\\frac{3}{13}) = (0, 0, 0, 5, \\frac{81}{13})$。此行没有产生新的填充元。\n    -   **填充元计数 = 2**。填充位置是 $(5,2)$ 和 $(3,5)$。\n下一步的矩阵状态 $A^{(3)}$：\n$$\nA^{(3)} \\text{ (structure)} \\rightarrow \\begin{pmatrix}\n9  \\tfrac{1}{2}  0  0  0 \\\\\n\\cdot  \\tfrac{13}{9}  0  0  3 \\\\\n\\cdot  \\cdot  8  -2  -\\tfrac{27}{13} \\\\\n\\cdot  \\cdot  -3  7  1 \\\\\n\\cdot  \\cdot  0  5  \\tfrac{81}{13}\n\\end{pmatrix}\n$$\n\n**步骤 $k=3$：**\n我们考虑活动子矩阵 $A^{(3)}(3:5, 3:5)$。\n1.  **阈值主元法**：\n    -   第 3 列的元素是 $a_{33}=8, a_{43}=-3, a_{53}=0$。\n    -   最大绝对值为 $|8|=8$。\n    -   阈值为 $\\tau \\times 8 = \\frac{4}{5} \\times 8 = 6.4$。\n    -   唯一的候选行是第 3 行 ($|8| \\ge 6.4$)。\n2.  **操作**：\n    -   主元是 $a_{33}=8$。不需要交换行。置换向量保持为 $p = (2, 1, 3, 4, 5)$。\n3.  **消元**：\n    -   第 3 列的乘子为：$l_{43} = \\frac{-3}{8}$, $l_{53}=0$。\n    -   更新第 4 行：$R_4 \\leftarrow R_4 - (-\\frac{3}{8})R_3 = (0,0,-3,7,1) + \\frac{3}{8}(0,0,8,-2,-\\frac{27}{13}) = (0,0,0, 7-\\frac{6}{8}, 1-\\frac{81}{104}) = (0,0,0, \\frac{25}{4}, \\frac{23}{104})$。没有新的填充元。\n    -   **填充元计数 = 2**。\n\n**步骤 $k=4$：**\n我们考虑活动子矩阵 $A^{(4)}(4:5, 4:5)$。\n$$\nA^{(4)}(4:5, 4:5) = \\begin{pmatrix}\n\\tfrac{25}{4}  \\tfrac{23}{104} \\\\\n5  \\tfrac{81}{13}\n\\end{pmatrix}\n$$\n1.  **阈值主元法**：\n    -   第 4 列的元素是 $a_{44}=\\frac{25}{4}=6.25, a_{54}=5$。\n    -   最大绝对值为 $|\\frac{25}{4}| = 6.25$。\n    -   阈值为 $\\tau \\times 6.25 = \\frac{4}{5} \\times \\frac{25}{4} = 5$。\n    -   两行都是候选行：第 4 行 ($|\\frac{25}{4}| \\ge 5$) 和第 5 行 ($|5| \\ge 5$)。\n2.  **Markowitz 启发式策略**：\n    -   活动子矩阵是 $2 \\times 2$ 的。\n    -   对于候选行 4，非零元数量为 $r_4=2$。\n    -   对于候选行 5，非零元数量为 $r_5=2$。\n    -   出现平局 ($r_4=r_5=2$)。\n3.  **平局打破规则**：\n    -   我们比较主元候选的绝对值：$|a_{44}| = 6.25$ 和 $|a_{54}| = 5$。\n    -   由于 $6.25  5$，我们选择第 4 行。\n4.  **操作**：\n    -   主元是 $a_{44}=\\frac{25}{4}$。不需要交换行。\n5.  **消元**：\n    -   第 4 列的乘子为：$l_{54} = \\frac{5}{25/4} = \\frac{4}{5}$。\n    -   更新第 5 行：$R_5 \\leftarrow R_5 - \\frac{4}{5}R_4$。此步骤更新了元素 $a_{55}$，但没有产生任何新的非零元，因为所涉及行的稀疏模式不会导致填充。\n    -   **填充元计数 = 2**。\n\n分解完成。在整个过程中，在两个位置产生了填充元：$(5,2)$ 和 $(3,5)$。填充元的总数为 $2$。",
            "answer": "$$\\boxed{2}$$"
        }
    ]
}