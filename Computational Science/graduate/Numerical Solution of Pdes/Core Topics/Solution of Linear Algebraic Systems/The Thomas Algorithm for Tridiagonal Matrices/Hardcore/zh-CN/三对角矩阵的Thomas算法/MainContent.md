## 引言
在科学与工程计算的广阔领域中，尤其是在[数值求解偏微分方程](@entry_id:634353)（PDEs）时，我们经常会遇到一类特殊而重要的挑战：求解大规模的三对角线性方程组。这些系统源于对一维物理问题（如热传导或[扩散](@entry_id:141445)）的离散化，或作为解决更高维问题的复杂算法（如[交替方向隐式法](@entry_id:746289)）的核心构件。虽然通用的线性代数求解器可以处理这些问题，但它们未能利用其稀疏且高度结构化的特性，导致计算效率低下。这一知识空白催生了对专门算法的需求，而[托马斯算法](@entry_id:141077)（Thomas Algorithm）正是这一需求的完美答案。

本文旨在系统性地剖析这一经典而强大的算法。通过三个核心章节的引导，读者将全面掌握[托马斯算法](@entry_id:141077)的理论与实践。我们将在“原理与机制”部分深入算法内部，从其作为高斯消元特例的起源出发，推导其[前向消元](@entry_id:177124)和[回代](@entry_id:146909)求解的过程，并严谨分析其[计算效率](@entry_id:270255)与数值稳定性。接着，在“应用程序与跨学科联系”部分，我们将视野拓宽至该算法的广阔应用场景，探索其如何成为从计算金融到系统生物学等多个学科中解决问题的关键工具。最后，“动手实践”部分将提供具体的编程练习，帮助读者将理论知识转化为解决实际问题的能力。通过这一完整的学习路径，您将不仅学会一个算法，更将理解一种贯穿于众多计算科学领域的高效求解思想。

## 原理与机制

在[数值求解偏微分方程](@entry_id:634353)（PDEs）的领域中，将连续问题离散化后，我们常常需要求解大规模的线性方程组。对于一维问题，或者在多维问题中使用[算子分裂](@entry_id:634210)等技术后，这些[线性方程组](@entry_id:148943)的[系数矩阵](@entry_id:151473)常常呈现出一种稀疏且高度结构化的形式：三[对角形式](@entry_id:264850)。本章将深入探讨求解此类方程组的一种极其高效和经典的算法——[托马斯算法](@entry_id:141077)（Thomas Algorithm）。我们将从[三对角矩阵](@entry_id:138829)的起源出发，系统地推导算法的力学结构，分析其计算效率、数值稳定性，并从现代计算架构的视角审视其性能。最后，我们将讨论该算法的几种重要变体与扩展。

### [三对角线性系统](@entry_id:171114)的起源

为了理解[托马斯算法](@entry_id:141077)的重要性，我们首先需要探究[三对角系统](@entry_id:635799)在科学与工程计算中是如何产生的。一个典型的例子来源于一维边界值问题的有限差分法离散化。

考虑一个简单而基础的模型——一维[泊松方程](@entry_id:143763)，它描述了多种物理现象，如[静电势](@entry_id:188370)、[稳态热传导](@entry_id:177666)等：
$$ -u''(x) = f(x), \quad x \in (0, 1) $$
其中 $u(x)$ 是待求解的场函数（例如温度或[电势](@entry_id:267554)），$f(x)$ 是一个已知的[源项](@entry_id:269111)。为了确定唯一的解，我们需要在区间的边界上施加条件，此处我们采用狄利克雷（Dirichlet）边界条件：
$$ u(0) = \alpha, \quad u(1) = \beta $$
其中 $\alpha$ 和 $\beta$ 是给定的常数。

为了数值求解该方程，我们首先在区间 $(0, 1)$ 上构建一个均匀网格。我们选取 $N$ 个内部格点，将[区间划分](@entry_id:264619)为 $N+1$ 个子区间，每个子区间的长度（即网格间距）为 $h = \frac{1}{N+1}$。格点的位置为 $x_i = ih$，其中 $i=1, 2, \dots, N$ 代表内部格点，而 $i=0$ 和 $i=N+1$ 对应于区间的两个端点。我们的目标是求出在这些内部格点上的[函数近似](@entry_id:141329)值 $u_i \approx u(x_i)$。

核心步骤在于用一个离散的代数表达式来近似微分算子 $u''(x)$。通过在点 $x_i$ 附近对 $u(x)$ 进行泰勒级数展开，我们可以得到：
$$ u(x_i+h) = u(x_i) + h u'(x_i) + \frac{h^2}{2} u''(x_i) + \frac{h^3}{6} u'''(x_i) + \mathcal{O}(h^4) $$
$$ u(x_i-h) = u(x_i) - h u'(x_i) + \frac{h^2}{2} u''(x_i) - \frac{h^3}{6} u'''(x_i) + \mathcal{O}(h^4) $$
将这两个展开式相加，奇数阶导数项恰好抵消，得到：
$$ u(x_i+h) + u(x_i-h) = 2u(x_i) + h^2 u''(x_i) + \mathcal{O}(h^4) $$
整理后，我们便获得了[二阶导数](@entry_id:144508)的一个二阶精度[中心差分近似](@entry_id:177025)：
$$ u''(x_i) = \frac{u(x_i-h) - 2u(x_i) + u(x_i+h)}{h^2} + \mathcal{O}(h^2) $$
将此近似式代入原[微分方程](@entry_id:264184) $-u''(x_i) = f(x_i)$，并用[离散变量](@entry_id:263628) $u_i$ 替换[连续函数](@entry_id:137361)值 $u(x_i)$，我们得到在每个内部格点 $i$ 上的代数方程：
$$ -\frac{u_{i-1} - 2u_i + u_{i+1}}{h^2} = f_i $$
整理可得：
$$ -\frac{1}{h^2}u_{i-1} + \frac{2}{h^2}u_i - \frac{1}{h^2}u_{i+1} = f_i, \quad \text{for } i = 1, 2, \dots, N $$
这个方程揭示了一个关键的局部依赖关系：格点 $i$ 上的未知数 $u_i$ 只与其直接相邻的两个未知数 $u_{i-1}$ 和 $u_{i+1}$ 相关。当我们将这 $N$ 个[方程组](@entry_id:193238)合成一个矩阵系统 $A\mathbf{u}=\mathbf{d}$ 时，这种局部性就体现为[系数矩阵](@entry_id:151473) $A$ 的一个特殊结构。

对于第 $i$ 行（$1  i  N$），该方程的系数直接对应矩阵 $A$ 的第 $i$ 行的三个非零元素。当 $i=1$ 时，方程为 $-\frac{1}{h^2}u_0 + \frac{2}{h^2}u_1 - \frac{1}{h^2}u_2 = f_1$。由于 $u_0 = u(0) = \alpha$ 是已知值，我们将其移到方程右侧，使得右端项变为 $d_1 = f_1 + \frac{\alpha}{h^2}$。类似地，当 $i=N$ 时，$u_{N+1} = u(1) = \beta$ 也是已知的，对应的右端项变为 $d_N = f_N + \frac{\beta}{h^2}$。

最终，我们得到的 $N \times N$ [线性系统](@entry_id:147850) $A\mathbf{u}=\mathbf{d}$ 的[系数矩阵](@entry_id:151473) $A$ 具有如下形式：
$$
A = \begin{pmatrix}
b_1  c_1  0  \dots  0 \\
a_2  b_2  c_2  \ddots  \vdots \\
0  \ddots  \ddots  \ddots  0 \\
\vdots  \ddots  a_{N-1}  b_{N-1}  c_{N-1} \\
0  \dots  0  a_N  b_N
\end{pmatrix}
$$
其中，非零元素仅存在于主对角线（$b_i$）、次对角线（$a_i$）和超对角线（$c_i$）上。这种矩阵被称为**[三对角矩阵](@entry_id:138829)**。对于我们所讨论的泊松问题 ，这些对角线上的元素具有非常简洁的形式，并且独立于索引 $i$：
- 次对角线元素 (Subdiagonal): $a_i = -\frac{1}{h^2}$
- 主对角[线元](@entry_id:196833)素 (Diagonal): $b_i = \frac{2}{h^2}$
- 超对角线元素 (Superdiagonal): $c_i = -\frac{1}{h^2}$

这种三对角结构在许多一维问题的离散化中普遍存在，例如热传导方程、波方程以及更复杂的[对流-扩散方程](@entry_id:144002)。[托马斯算法](@entry_id:141077)正是为高效求解此类系统而设计的。

### [托马斯算法](@entry_id:141077)：一种精巧的高斯消元特例

对于一个一般的[三对角系统](@entry_id:635799) $a_i u_{i-1} + b_i u_i + c_i u_{i+1} = d_i$（其中 $a_1 = 0, c_N = 0$），标准的高斯消元法虽然可行，但会进行大量对零元素的不必要操作。[托马斯算法](@entry_id:141077)，又称[三对角矩阵算法](@entry_id:141077)（TDMA），是[高斯消元法](@entry_id:153590)在[三对角系统](@entry_id:635799)上的一个精简实现，它完全利用了矩阵的[稀疏性](@entry_id:136793)，从而获得了极高的[计算效率](@entry_id:270255)。

算法分为两个阶段：**[前向消元](@entry_id:177124)**（Forward Elimination）和**[回代](@entry_id:146909)求解**（Back Substitution）。

#### 算法推导

[前向消元](@entry_id:177124)的目标是将系数矩阵 $A$ 转化为一个上双[对角矩阵](@entry_id:637782)。我们从第二行开始，逐行消除次对角线上的元素 $a_i$。

考虑第 $i$ 个方程：
$$ a_i u_{i-1} + b_i u_i + c_i u_{i+1} = d_i $$
假设经过消元，第 $i-1$ 个方程已经被转化为如下形式（只包含 $u_{i-1}$ 和 $u_i$）：
$$ b'_{i-1} u_{i-1} + c_{i-1} u_i = d'_{i-1} $$
从这个方程中，我们可以表达出 $u_{i-1} = \frac{d'_{i-1} - c_{i-1} u_i}{b'_{i-1}}$。将其代入第 $i$ 个方程，可以消去 $u_{i-1}$。然而，更符合高斯消元思想的做法是，将第 $i-1$ 行乘以一个因子 $m_i = \frac{a_i}{b'_{i-1}}$，然后从第 $i$ 行中减去。

$$ (a_i u_{i-1} + b_i u_i + c_i u_{i+1}) - \frac{a_i}{b'_{i-1}} (b'_{i-1} u_{i-1} + c_{i-1} u_i) = d_i - \frac{a_i}{b'_{i-1}} d'_{i-1} $$
整理后， $u_{i-1}$ 项被消去，我们得到一个新的只涉及 $u_i$ 和 $u_{i+1}$ 的方程：
$$ \left(b_i - \frac{a_i c_{i-1}}{b'_{i-1}}\right) u_i + c_i u_{i+1} = d_i - \frac{a_i d'_{i-1}}{b'_{i-1}} $$
这正是新的第 $i$ 行。我们可以定义新的对角元素 $b'_i$ 和新的右端项 $d'_i$：
$$ b'_i = b_i - \frac{a_i c_{i-1}}{b'_{i-1}}, \quad d'_i = d_i - \frac{a_i d'_{i-1}}{b'_{i-1}} $$
这个过程从 $i=2$ 开始，一直进行到 $i=N$。[初始条件](@entry_id:152863)为 $b'_1 = b_1$ 和 $d'_1 = d_1$。

这个推导过程的一个重要实现细节是，新的系数 $b'_i$ 和 $d'_i$ 可以在计算后立即覆盖（overwrite）旧的 $b_i$ 和 $d_i$ 值，从而实现**原地**（in-place）计算，无需额外的存储空间。 中的正确性论证指出，在计算第 $i$ 行的新系数时，我们只需要第 $i-1$ 行的*已更新*系数（$b'_{i-1}, d'_{i-1}$）和第 $i$ 行的*原始*系数（$a_i, b_i, c_i, d_i$）。一旦第 $i$ 行更新完毕，其原始值就不再需要，因此这种顺序覆盖是安全且正确的。

完成[前向消元](@entry_id:177124)后，原始系统 $A\mathbf{u}=\mathbf{d}$ 变为等价的上双对角系统：
$$
\begin{align*}
b'_1 u_1 + c_1 u_2  = d'_1 \\
b'_2 u_2 + c_2 u_3  = d'_2 \\
\vdots \\
b'_{N-1} u_{N-1} + c_{N-1} u_N  = d'_{N-1} \\
b'_N u_N  = d'_N
\end{align*}
$$
第二个阶段，**[回代](@entry_id:146909)求解**，就变得非常直接。从最后一个方程开始，我们可以立即解出 $u_N$：
$$ u_N = \frac{d'_N}{b'_N} $$
然后，我们可以从后往前依次求解其余的未知数。对于 $i = N-1, N-2, \dots, 1$，我们有：
$$ u_i = \frac{d'_i - c_i u_{i+1}}{b'_i} $$
至此，所有未知数均被解出。

#### [计算效率](@entry_id:270255)

[托马斯算法](@entry_id:141077)最引人注目的优点是其卓越的[计算效率](@entry_id:270255)。对于一个 $N \times N$ 的[稠密矩阵](@entry_id:174457)，标准高斯消元的计算量为 $\mathcal{O}(N^3)$。而[托马斯算法](@entry_id:141077)充分利用了三对角结构。

在[前向消元](@entry_id:177124)阶段，对于每一行 $i$（从 $2$ 到 $N$），计算新的 $b'_i$ 和 $d'_i$ 需要：
- 1 次除法（计算因子 $m_i = a_i / b'_{i-1}$）
- 2 次乘法（$m_i c_{i-1}$ 和 $m_i d'_{i-1}$）
- 2 次减法

在[回代](@entry_id:146909)求解阶段，求解 $u_N$ 需要 1 次除法。求解其余的 $u_i$（从 $N-1$ 到 $1$）时，每个未知数需要：
- 1 次乘法（$c_i u_{i+1}$）
- 1 次减法
- 1 次除法

汇总这些操作，我们可以得到求解一个 $N$ 维[三对角系统](@entry_id:635799)的精确浮点运算（FLOPs）计数 ：
- **加法/减法**: $(2N-2) + (N-1) = 3N-3$
- **乘法**: $(2N-2) + (N-1) = 3N-3$
- **除法**: $(N-1) + 1 + (N-1) = 2N-1$

总的运算次数约为 $8N$。这表明[托马斯算法](@entry_id:141077)的计算复杂度是 $\mathcal{O}(N)$，即与问题规模成线性关系。这种非凡的效率使其成为求解一维离散化问题的首选直接法。

### 数值稳定性：阿喀琉斯之踵及其铠甲

尽管[托马斯算法](@entry_id:141077)非常高效，但作为一种无主元（pivoting-free）的高斯消元，其数值稳定性是一个必须审慎考虑的问题。如果消元过程中的主元 $b'_i$ 出现零或相对于其他元素过小的值，算法可能会失败（除以零）或因舍入误差的急剧放大而产生无意义的结果。

#### 主元失效的风险

考虑一个非奇异（即可逆）的[三对角矩阵](@entry_id:138829)，[托马斯算法](@entry_id:141077)仍有可能因遇到零主元而失效。一个精心构造的例子可以清晰地揭示这一风险 。考虑以下 $3 \times 3$ 非[对称三对角矩阵](@entry_id:755732)：
$$
A = \begin{pmatrix}
0  1  0 \\
2  0  0 \\
0  1  1
\end{pmatrix}
$$
该矩阵的行列式为 $\det(A) = -2 \neq 0$，因此它是非奇异的，对应的线性系统有唯一解。然而，[托马斯算法](@entry_id:141077)的第一步就需要计算因子 $m_{21} = a_2/b_1 = 2/0$，这直接导致了算法的**分解**（breakdown）。

这个问题的根源在于算法严格地选择主对角线元素作为主元。如果当前主元为零，算法就无法继续。一个简单的补救措施是**[部分主元法](@entry_id:138396)**（partial pivoting），即在处理第 $i$ 行时，比较 $|b'_i|$ 和 $|a_{i+1}|$ 的大小，如果后者更大，则交换第 $i$ 行和第 $i+1$ 行。对于上面这个例子，交换第一行和第二行后，新的主元变为 2，消元过程就可以顺利进行。对于[三对角系统](@entry_id:635799)，一种高效的主元策略是只允许相邻行交换，这能保持矩阵的带状结构，并将计算复杂度维持在 $\mathcal{O}(N)$ 。

#### 稳定性的充分条件

在实践中，我们更希望能够在不进行主元选择的情况下安全地使用[托马斯算法](@entry_id:141077)，因为它更简单、更快。幸运的是，许[多源](@entry_id:170321)于物理问题的[三对角矩阵](@entry_id:138829)天然具有保证[算法稳定性](@entry_id:147637)的优良性质。

一个核心的充分条件是**[严格对角占优](@entry_id:154277)**（Strict Diagonal Dominance）。如果一个矩阵 $A$ 的每一行，其对角元素的[绝对值](@entry_id:147688)都大于该行所有非对角元素[绝对值](@entry_id:147688)之和，那么该矩阵就是[严格对角占优](@entry_id:154277)的。对于[三对角矩阵](@entry_id:138829)，这意味着：
$$ |b_i|  |a_i| + |c_i|, \quad \text{for } i=1, \dots, N $$
（其中 $a_1=0, c_N=0$）。可以证明，如果一个矩阵是[严格对角占优](@entry_id:154277)的，那么高斯消元（包括[托马斯算法](@entry_id:141077)）在没有主元选择的情况下是数值稳定的。主元 $b'_i$ 会保持良好特性，不会出现过小或为零的情况。

许多[数值格式](@entry_id:752822)天然会产生[严格对角占优](@entry_id:154277)的矩阵。例如，在求解包含[对流](@entry_id:141806)项的方程时，使用**迎风格式**（upwind scheme）通常会得到一类被称为**[M-矩阵](@entry_id:189121)**的矩阵，这类矩阵保证了[托马斯算法](@entry_id:141077)的稳定性 。我们之前讨论的泊松方程离散化矩阵，其对角元素为 $2/h^2$，非对角元素为 $-1/h^2$，满足 $|b_i| = |a_i| + |c_i|$，这被称为弱[对角占优](@entry_id:748380)，虽然它不满足严格条件，但由于其其他性质（如不可约性），对于这类特定问题，[托马斯算法](@entry_id:141077)仍然是稳定的。

#### [对称正定](@entry_id:145886)（SPD）矩阵的特殊情况

当三对角矩阵是对称且正定的（Symmetric Positive Definite, SPD）时，[托马斯算法](@entry_id:141077)的稳定性有更深刻的理论保证。我们之前从泊松方程得到的矩阵就是[SPD矩阵](@entry_id:136714)的一个例子。

对于一个SPD三对角矩阵 $A$，[托马斯算法](@entry_id:141077)的消元过程在代数上等价于矩阵的 **$LDL^\top$ 分解** 。这里 $L$ 是一个单位下双[对角矩阵](@entry_id:637782)，$D$ 是一个对角矩阵。
$$ A = L D L^\top =
\begin{pmatrix}
1   \\
l_1  1  \\
 \ddots  \ddots
\end{pmatrix}
\begin{pmatrix}
d_1   \\
 d_2  \\
  \ddots
\end{pmatrix}
\begin{pmatrix}
1  l_1  \\
 1  \ddots \\
  \ddots
\end{pmatrix}
$$
通过比较 $A$ 和 $LDL^\top$ 的对应元素，可以得到 $d_i$ 和 $l_i$ 的[递推关系](@entry_id:189264)。可以证明，[托马斯算法](@entry_id:141077)[前向消元](@entry_id:177124)过程中计算出的主元 $b'_i$ 正是 $LDL^\top$ 分解中的对角矩阵 $D$ 的元素 $d_i$。一个核心定理指出，如果一个矩阵是SPD的，那么它的所有主元 $d_i$（即[Schur补](@entry_id:142780)）都必须是正数。因此，对于SPD三对行矩阵，[托马斯算法](@entry_id:141077)永远不会遇到零主元或负主元，算法是无条件稳定的。

### 现代计算架构下的性能考量

在经典的[算法分析](@entry_id:264228)中，我们通常只关心[浮点运算次数](@entry_id:749457)。然而，在现代计算机上，数据从内存移动到处理器所需的时间往往远超计算本身的时间。因此，评估算法性能需要考虑计算与访存的平衡。

#### [算术强度](@entry_id:746514)与[内存墙](@entry_id:636725)

**[算术强度](@entry_id:746514)**（Arithmetic Intensity）是衡量一个算法计算密集程度的指标，定义为总[浮点运算次数](@entry_id:749457)与总内存访问字节数之比。
$$ \text{算术强度 (AI)} = \frac{\text{浮点运算次数}}{\text{内存访问字节数}} $$
根据[屋顶线模型](@entry_id:163589)（Roofline Model），一个算法的实际性能受限于处理器的峰值计算性能和内存带宽。如果[算术强度](@entry_id:746514)很低，算法的性能瓶颈在于内存带宽，称之为**内存密集型**（memory-bound）；反之，如果[算术强度](@entry_id:746514)很高，性能瓶颈在于处理器计算能力，称之为**计算密集型**（compute-bound）。

对于[托马斯算法](@entry_id:141077)，我们已经知道其总运算量为 $\mathcal{O}(N)$。其内存访问量同样是 $\mathcal{O}(N)$，因为它只需对代表对角线和右端项的几个向量各进行常数次读写。因此，其[算术强度](@entry_id:746514)是一个与 $N$ 无关的常数，即 $\text{AI} = \mathcal{O}(1)$ 。这个常数通常很小（例如，一个典[型的实现](@entry_id:637593)可能[算术强度](@entry_id:746514)约为 0.1 FLOP/Byte）。在现代处理器上，这意味着[托马斯算法](@entry_id:141077)几乎总是受限于[内存带宽](@entry_id:751847)。即使处理器有强大的计算能力，也只能“坐等”数据从内存中传来。

与之形成鲜明对比的是求解稠密矩阵的[高斯消元法](@entry_id:153590)。其计算量为 $\mathcal{O}(N^3)$，而数据量为 $\mathcal{O}(N^2)$，因此[算术强度](@entry_id:746514)为 $\mathcal{O}(N)$。当 $N$ 足够大时，其[算术强度](@entry_id:746514)会非常高，从而成为计算密集型任务，能够充分利用处理器的峰值性能。因此，尽管[托马斯算法](@entry_id:141077)的“总时间”远少于稠密高斯消元，但其在单位时间内完成的浮点运算速率（[FLOPS](@entry_id:171702)）可能远低于后者。

#### 内在串行性与[并行计算](@entry_id:139241)

[托马斯算法](@entry_id:141077)的另一个关键特征是其**内在的串行性**。在[前向消元](@entry_id:177124)阶段，计算第 $i$ 行的系数必须等待第 $i-1$ 行的计算完成。同样，在[回代](@entry_id:146909)求解阶段，计算 $u_i$ 必须等待 $u_{i+1}$ 的结果。这种严格的数据依赖链条（$1 \to 2 \to \dots \to N$ 和 $N \to N-1 \to \dots \to 1$）意味着，即使在拥有无限多处理器的理想[并行计算](@entry_id:139241)机上，完成整个算法的最短时间（即并行深度或跨度）仍然与问题规模 $N$ 成正比，即深度为 $\mathcal{O}(N)$ 。

这种串行性限制了[托马斯算法](@entry_id:141077)在现代大规模[并行处理](@entry_id:753134)器（如GPU）上的可扩展性。为了在[并行架构](@entry_id:637629)上高效[求解三对角系统](@entry_id:166973)，研究人员发展了不同的算法，其中最著名的是**[并行循环规约](@entry_id:753119)**（Parallel Cyclic Reduction, PCR）。PCR的基本思想是在每一轮中，同时消除所有奇数（或偶数）索引的未知数。例如，通过代数变换，将第 $i-1$ 和 $i+1$ 个方程代入第 $i$ 个方程，从而建立 $u_{i-2}, u_i, u_{i+2}$ 之间的新关系。这个过程对所有偶数索引 $i$ 都是独立的，因此可以并行执行。经过一轮规约，问题规模减半，但仍保持三对角结构（只是元素之间的“距离”加倍了）。重复此过程 $\log_2 N$ 轮后，系统就被规约到一个极小规模的问题。PCR算法的并行深度为 $\mathcal{O}(\log N)$，而总计算量仍为 $\mathcal{O}(N)$，使其非常适合并行环境 。

### 常见变体与扩展

标准的[托马斯算法](@entry_id:141077)虽然强大，但其[适用范围](@entry_id:636189)限于严格的[三对角矩阵](@entry_id:138829)。在更复杂的应用场景中，我们需要对其进行推广。

#### 循环[三对角系统](@entry_id:635799)

当一维问题的边界条件是周期性的时，例如 $u(0)=u(L)$ 和 $u'(0)=u'(L)$，离散化后得到的矩阵会在标准三对角结构的基础上，增加两个“角上”的非零元素，分别位于 $A_{1,N}$ 和 $A_{N,1}$ 位置 。
$$
A = \frac{1}{h^2}
\begin{pmatrix}
2  -1  0  \dots  -1 \\
-1  2  -1   0 \\
0  \ddots  \ddots  \ddots  \vdots \\
\vdots   -1  2  -1 \\
-1  0  \dots  -1  2
\end{pmatrix}
$$
这种矩阵被称为**循环三对角矩阵**。由于 $A_{1,N}$ 和 $A_{N,1}$ 的存在，标准的[托马斯算法](@entry_id:141077)不再适用，因为它破坏了算法所依赖的严格[三项递推关系](@entry_id:176845)。然而，这类系统可以通过一些技巧来求解。一种常用方法是利用**[Sherman-Morrison公式](@entry_id:177031)**。该公式提供了一种高效计算一个矩阵（此处为标准[三对角矩阵](@entry_id:138829)）加上一个[秩一矩阵](@entry_id:199014)（用于表示角元素）的逆的方法。通过这种方法，循环[三对角系统](@entry_id:635799)可以通过求解两个标准[三对角系统](@entry_id:635799)来解决，总的计算复杂度仍然是 $\mathcal{O}(N)$。

#### 块[三对角系统](@entry_id:635799)

当我们离散化一个包含多个耦合场变量的PDE系统（例如，一个二维的[扩散](@entry_id:141445)-反应系统），或者使用高阶有限元方法时，得到的线性系统常常具有**块三对角结构** 。
$$
\mathbf{A} =
\begin{pmatrix}
D_1  U_1   \\
L_2  D_2  U_2  \\
 \ddots  \ddots  \ddots \\
  L_N  D_N
\end{pmatrix}
$$
其中，每个 $D_i, L_i, U_i$ 不再是标量，而是 $m \times m$ 的小矩阵（块），$m$ 是每个格点上的自由度数量。

对于这类系统，我们可以推广[托马斯算法](@entry_id:141077)，得到**块[托马斯算法](@entry_id:141077)**。其代数形式与标量版本完全相同，只是所有的运算都变成了矩阵运算：
- **[前向消元](@entry_id:177124)**:
$$ D'_i = D_i - L_i (D'_{i-1})^{-1} U_{i-1} $$
- **[回代](@entry_id:146909)求解**:
$$ \mathbf{u}_N = (D'_N)^{-1} \mathbf{d}'_N $$
$$ \mathbf{u}_i = (D'_i)^{-1} (\mathbf{d}'_i - U_i \mathbf{u}_{i+1}) $$
这里的主要计算开销变成了矩阵求逆和[矩阵乘法](@entry_id:156035)。

块[托马斯算法](@entry_id:141077)的稳定性条件也与标量版本类似。如果系统是**块[严格对角占优](@entry_id:154277)**的（在某种[矩阵范数](@entry_id:139520)意义下），或者整个[块矩阵](@entry_id:148435) $\mathbf{A}$ 是[对称正定](@entry_id:145886)的，那么块[托马斯算法](@entry_id:141077)就是数值稳定的 。对于SPD[块矩阵](@entry_id:148435)，[前向消元](@entry_id:177124)中计算出的对角块 $D'_i$（被称为**[Schur补](@entry_id:142780)**）也都是SPD的，从而保证了其[可逆性](@entry_id:143146)。

综上所述，[托马斯算法](@entry_id:141077)不仅是求解特定[三对角系统](@entry_id:635799)的一个高效工具，其核心思想和分析方法也为理解更广泛的结构化[线性系统](@entry_id:147850)求解提供了深刻的见解。