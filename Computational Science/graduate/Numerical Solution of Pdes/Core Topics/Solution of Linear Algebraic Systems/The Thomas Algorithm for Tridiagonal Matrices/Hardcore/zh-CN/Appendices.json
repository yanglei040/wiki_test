{
    "hands_on_practices": [
        {
            "introduction": "要体会托马斯算法的威力，我们首先需要了解它所求解的三对角系统源于何处。本练习将引导你通过一个源于物理学的基本范例——热传导方程，展示标准的有限差分法如何将一个偏微分方程转化为一个三对角线性系统。掌握这一推导过程，是将数值求解器应用于广泛物理问题的第一步。",
            "id": "3456851",
            "problem": "考虑一个空间区间上的一维热偏微分方程 (PDE) $u_{t}=\\kappa\\,u_{xx}$，其边界条件为狄利克雷边界条件，其中 $\\kappa0$ 是一个常数热扩散系数。使用间距为 $h$ 的均匀网格对空间域进行离散化，内部节点索引为 $i=1,2,\\dots,N-1$；并使用均匀时间步长 $\\Delta t$ 对时间进行离散化，时间层为 $t^{n}$ 和 $t^{n+1}=t^{n}+\\Delta t$。在时间上使用隐式后向欧拉法，对空间二阶导数使用二阶中心有限差分。从这些基本离散化出发，推导出在每个时间步为求解内部节点值 $u_{i}^{n+1}$ 所必须求解的线性代数系统，证明其系数矩阵是三对角的，并用 $\\kappa$、$\\Delta t$ 和 $h$ 纯符号形式表示三个不同的带状元素（次对角线、主对角线、超对角线）。明确说明端点处的狄利克雷边界值如何进入右端项，但并不改变这三个带状系数。将最终答案表示为一个单行矩阵，其中按顺序包含三个带状元素：次对角线、主对角线、超对角线。不需要数值；请提供精确的符号表达式。",
            "solution": "该问题陈述经评估具有科学依据、良定性、客观性和自洽性。它代表了数值偏微分方程领域一个标准和基本的任务。因此，该问题是有效的，并将提供解答。\n\n控制偏微分方程 (PDE) 是一维热方程：\n$$\nu_{t} = \\kappa\\,u_{xx}\n$$\n其中 $u=u(x,t)$ 是温度，$\\kappa  0$ 是热扩散系数，$t$ 是时间，$x$ 是空间坐标。求解域是一个有限的空间区间，并且在端点上指定了狄利克雷边界条件。\n\n根据要求，我们对此方程进行离散化。设空间域通过间距为 $h$ 的均匀网格进行离散化，使得对于整数索引 $i$，$x_i = i h$。内部节点的索引从 $i=1$ 到 $N-1$。时间域通过均匀步长 $\\Delta t$ 进行离散化，使得 $t^n = n \\Delta t$。我们将 $u(x_i, t^n)$ 的数值近似记为 $u_i^n$。\n\n问题指定对时间导数使用隐式后向欧拉法。该格式在时间层 $t^{n+1}$ 处近似时间导数：\n$$\nu_t \\bigg|_{i}^{n+1} \\approx \\frac{u_i^{n+1} - u_i^n}{\\Delta t}\n$$\n对于空间二阶导数，使用二阶中心有限差分近似。在隐式格式中，这也将在未来的时间层 $t^{n+1}$ 处进行计算：\n$$\nu_{xx} \\bigg|_{i}^{n+1} \\approx \\frac{u_{i-1}^{n+1} - 2u_i^{n+1} + u_{i+1}^{n+1}}{h^2}\n$$\n将这些离散近似代入原始偏微分方程，我们得到每个内部节点 $i=1, 2, \\dots, N-1$ 的有限差分方程：\n$$\n\\frac{u_i^{n+1} - u_i^n}{\\Delta t} = \\kappa \\left( \\frac{u_{i-1}^{n+1} - 2u_i^{n+1} + u_{i+1}^{n+1}}{h^2} \\right)\n$$\n我们的目标是推导出在新时间步求解未知值 $u_i^{n+1}$ 的线性代数系统。为此，我们重新整理方程，将所有带有上标 $n+1$ 的项（未知数）归到左侧（LHS），并将所有带有上标 $n$ 的项（来自前一时间步的已知数）归到右侧（RHS）。\n\n首先，两边同乘以 $\\Delta t$：\n$$\nu_i^{n+1} - u_i^n = \\frac{\\kappa \\Delta t}{h^2} \\left( u_{i-1}^{n+1} - 2u_i^{n+1} + u_{i+1}^{n+1} \\right)\n$$\n我们定义无量纲扩散数 $r$ 为：\n$$\nr = \\frac{\\kappa \\Delta t}{h^2}\n$$\n将 $r$ 代入方程得到：\n$$\nu_i^{n+1} - u_i^n = r \\left( u_{i-1}^{n+1} - 2u_i^{n+1} + u_{i+1}^{n+1} \\right)\n$$\n现在，我们将所有包含未知值 $u^{n+1}$ 的项收集到左侧：\n$$\nu_i^{n+1} - r u_{i-1}^{n+1} + 2r u_i^{n+1} - r u_{i+1}^{n+1} = u_i^n\n$$\n对每个未知节点值的系数进行分组，得到通用内部节点 $i$ 的方程：\n$$\n-r u_{i-1}^{n+1} + (1 + 2r) u_i^{n+1} - r u_{i+1}^{n+1} = u_i^n\n$$\n该方程对 $i=1, 2, \\dots, N-1$ 成立。这组 $N-1$ 个线性方程构成一个系统 $A \\mathbf{u}^{n+1} = \\mathbf{b}$，其中 $\\mathbf{u}^{n+1}$ 是未知节点值的向量 $[u_1^{n+1}, u_2^{n+1}, \\dots, u_{N-1}^{n+1}]^T$。\n\n关于 $u_i^{n+1}$ 的方程结构仅涉及其自身及其近邻 $u_{i-1}^{n+1}$ 和 $u_{i+1}^{n+1}$。这种结构直接意味着系数矩阵 $A$ 是三对角的。带状元素由我们推导出的系数给出：\n- $u_{i-1}^{n+1}$ 的系数是 $-r$。这构成了矩阵的次对角线。\n- $u_i^{n+1}$ 的系数是 $(1+2r)$。这构成了矩阵的主对角线。\n- $u_{i+1}^{n+1}$ 的系数是 $-r$。这构成了矩阵的超对角线。\n\n狄利克雷边界条件指定了域端点处的值，假设在 $x_0=0$ 和 $x_N=L$。这些是时间的给定函数，因此在时间 $t^{n+1}$，$u_0^{n+1}$ 和 $u_N^{n+1}$ 的值是已知量。我们来研究它们如何影响该系统。\n\n对于第一个内部节点 $i=1$：\n$$\n-r u_{0}^{n+1} + (1 + 2r) u_1^{n+1} - r u_2^{n+1} = u_1^n\n$$\n由于 $u_0^{n+1}$ 是来自边界条件的已知值，其项被移至右侧：\n$$\n(1 + 2r) u_1^{n+1} - r u_2^{n+1} = u_1^n + r u_0^{n+1}\n$$\n这表明，针对内部节点的 $(N-1) \\times (N-1)$ 系数矩阵的第一行中，主对角线上是 $(1+2r)$，超对角线上是 $-r$。次对角线元素实际上为零。边界值 $u_0^{n+1}$ 贡献给右端项向量 $\\mathbf{b}$ 的第一个元素。\n\n对于最后一个内部节点 $i=N-1$：\n$$\n-r u_{N-2}^{n+1} + (1 + 2r) u_{N-1}^{n+1} - r u_{N}^{n+1} = u_{N-1}^n\n$$\n类似地，$u_N^{n+1}$ 是一个已知的边界值，并被移至右侧：\n$$\n-r u_{N-2}^{n+1} + (1 + 2r) u_{N-1}^{n+1} = u_{N-1}^n + r u_N^{n+1}\n$$\n这表明系数矩阵的最后一行中，次对角线上是 $-r$，主对角线上是 $(1+2r)$。超对角线元素实际上为零。边界值 $u_N^{n+1}$ 贡献给右端项向量 $\\mathbf{b}$ 的最后一个元素。\n\n因此，狄利克雷边界条件不改变内部未知数系数矩阵的三个主要带状元素；它们只修改右端项向量的第一个和最后一个分量。三对角矩阵的三个不同的非零带状元素在矩阵内部是恒定的。通过代回 $r = \\frac{\\kappa \\Delta t}{h^2}$，用给定的参数 $\\kappa$、$\\Delta t$ 和 $h$ 来表示它们：\n- 次对角线元素：$-r = -\\frac{\\kappa \\Delta t}{h^2}$\n- 主对角线元素：$1+2r = 1 + \\frac{2\\kappa \\Delta t}{h^2}$\n- 超对角线元素：$-r = -\\frac{\\kappa \\Delta t}{h^2}$\n\n最终答案是一个按指定顺序包含这三个元素的行矩阵。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-\\frac{\\kappa \\Delta t}{h^2}  1 + \\frac{2\\kappa \\Delta t}{h^2}  -\\frac{\\kappa \\Delta t}{h^2}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "托马斯算法的效率令人瞩目，但其数值稳定性并非无条件保证，需要矩阵满足特定条件。本练习将深入探讨稳定性的关键课题，通过分析一个对流-扩散问题，揭示不恰当的离散化方法为何会导致算法失效。通过分析算法中枢轴元（pivots）的行为，你将深刻理解为何诸如对角占优等概念对于确保解的可靠性至关重要，尤其是在具有挑战性的强对流问题中。",
            "id": "3456789",
            "problem": "考虑一维稳态对流扩散模型方程 $-\\epsilon\\,u''(x) + u'(x) = f(x)$，定义在区间 $x \\in [0,1]$ 上，边界条件为狄利克雷边界条件 $u(0) = 0$ 和 $u(1) = 1$。其中 $\\epsilon  0$ 是一个小的扩散系数，$f$ 是一个光滑函数。使用包含 $N+1$ 个节点的均匀网格，$x_j = jh$，$j = 0,1,\\dots,N$，其中 $h = 1/N$。未知量为内部节点上的值 $u_j \\approx u(x_j)$，$j = 1,\\dots,N-1$。对 $u''$ 使用标准的二阶中心有限差分近似，并比较以下两种对 $u'$ 的离散化方法：\n- 中心差分：$u'(x_j) \\approx \\left(u_{j+1} - u_{j-1}\\right)/(2h)$。\n- 一阶迎风差分（与向右的平流一致）：$u'(x_j) \\approx \\left(u_j - u_{j-1}\\right)/h$。\n\n对于每种离散化方法，所得的关于内部未知量向量的线性系统是三对角的，需通过三对角矩阵算法（TDMA）（也称为托马斯算法）求解。设 $d_i$ 表示在将托马斯算法应用于相应的三对角系统时，在前向消元过程的第 $i$ 步所遇到的主元，其中 $i = 1,2,\\dots,N-1$。假设 $N \\geq 3$ 是固定的，并考虑奇异摄动状态 $\\epsilon \\to 0$（边界层主导的流动）。\n\n从有限差分近似的基本定义和托马斯算法中的前向消元过程出发，推导当 $\\epsilon \\to 0$ 时，每种离散化方法的主元序列 $\\{d_i\\}$ 的领头阶渐近行为。然后，通过计算以下两个极限来量化每种情况下的最小主元：\n$$\nL_{\\mathrm{c}} \\;=\\; \\lim_{\\epsilon \\to 0} \\frac{h^{2}}{\\epsilon} \\,\\min_{1 \\leq i \\leq N-1} d_i^{(\\mathrm{central})}\n\\qquad\\text{and}\\qquad\nL_{\\mathrm{u}} \\;=\\; \\lim_{\\epsilon \\to 0} h \\,\\min_{1 \\leq i \\leq N-1} d_i^{(\\mathrm{upwind})},\n$$\n其中 $d_i^{(\\mathrm{central})}$ 和 $d_i^{(\\mathrm{upwind})}$ 分别表示中心差分和迎风离散化的主元序列。将你的最终答案以包含 $\\left(L_{\\mathrm{c}},\\,L_{\\mathrm{u}}\\right)$ 的单行矩阵形式报告，并且不要进行任何四舍五入。作为推导的一部分，讨论在 $\\epsilon \\to 0$ 的极限情况下，两种离散化方法对托马斯算法的对角占优性和稳定性的影响。",
            "solution": "问题要求分析托马斯算法在求解一维对流扩散方程 $-\\epsilon\\,u''(x) + u'(x) = f(x)$（定义在 $x \\in [0,1]$ 上，且 $u(0) = 0$, $u(1) = 1$）的两种不同有限差分格式时所产生的主元。该分析需在奇异摄动极限 $\\epsilon \\to 0$ 下进行，网格间距 $h=1/N$ 为固定值。\n\n方程在均匀网格 $x_j = jh$ ($j=0, 1, \\dots, N$) 上进行离散化。二阶导数由标准的二阶中心差分近似：\n$$\nu''(x_j) \\approx \\frac{u_{j+1} - 2u_j + u_{j-1}}{h^2}\n$$\n对于内部未知数 $u_j$ ($j=1, \\dots, N-1$)，得到的线性系统形式为 $a_j u_{j-1} + b_j u_j + c_j u_{j+1} = \\tilde{f}_j$。托马斯算法（TDMA）等价于对三对角矩阵 $A$ 进行 $LU$ 分解，其中主元 $d_i$ 是上三角矩阵 $U$ 的对角元。主元由以下递推关系生成：\n$$\nd_1 = b_1, \\qquad d_i = b_i - \\frac{a_i c_{i-1}}{d_{i-1}} \\quad \\text{for } i=2, \\dots, N-1.\n$$\n边界条件 $u_0=0$ 和 $u_N=1$ 被并入系统的第一个和最后一个方程中，这会影响右端向量，但不会改变一般内部行的矩阵元素，这些元素在整个网格上是常数。\n\n**中心差分离散化**\n\n对于一阶导数的中心差分近似 $u'(x_j) \\approx (u_{j+1} - u_{j-1})/(2h)$，在内部节点 $x_j$ 处的离散方程为：\n$$\n-\\epsilon \\frac{u_{j+1} - 2u_j + u_{j-1}}{h^2} + \\frac{u_{j+1} - u_{j-1}}{2h} = f_j\n$$\n整理各项，得到三对角系统的系数：\n$$\n\\left(-\\frac{\\epsilon}{h^2} - \\frac{1}{2h}\\right)u_{j-1} + \\left(\\frac{2\\epsilon}{h^2}\\right)u_j + \\left(-\\frac{\\epsilon}{h^2} + \\frac{1}{2h}\\right)u_{j+1} = f_j\n$$\n对于矩阵的内部行（从 $i=2$ 到 $N-2$），系数是统一的。由于边界条件，第一行和最后一行是特殊的，但因为 $u_0=0$，矩阵第一行的结构与通用形式相匹配。系统矩阵 $A^{(\\mathrm{c})}$ 的系数为：\n$a_i^{(\\mathrm{c})} = a = -\\frac{\\epsilon}{h^2} - \\frac{1}{2h}$ for $i \\ge 2$.\n$b_i^{(\\mathrm{c})} = b = \\frac{2\\epsilon}{h^2}$ for all $i$.\n$c_i^{(\\mathrm{c})} = c = -\\frac{\\epsilon}{h^2} + \\frac{1}{2h}$ for $i \\le N-2$.\n\n严格对角占优的条件是 $|b_i|  |a_i| + |c_i|$。对于小的 $\\epsilon$ 且满足 $h  2\\epsilon$，我们有 $|c| = \\frac{1}{2h} - \\frac{\\epsilon}{h^2}  0$。该条件变为：\n$$\n\\frac{2\\epsilon}{h^2}  \\left(\\frac{\\epsilon}{h^2} + \\frac{1}{2h}\\right) + \\left(\\frac{1}{2h} - \\frac{\\epsilon}{h^2}\\right) = \\frac{1}{h}\n$$\n这可简化为 $2\\epsilon  h$，或者说网格佩克莱特数 $Pe_h = h/(2\\epsilon)$ 必须小于 1。在极限 $\\epsilon \\to 0$ 时，此条件被违反，因此该矩阵不是对角占优的。\n\n主元 $d_i^{(\\mathrm{c})}$ 由递推关系给出：$d_1^{(\\mathrm{c})} = b$ 且 $d_i^{(\\mathrm{c})} = b - \\frac{ac}{d_{i-1}^{(\\mathrm{c})}}$。\n乘积 $ac$ 为：\n$$\nac = \\left(-\\frac{\\epsilon}{h^2} - \\frac{1}{2h}\\right)\\left(-\\frac{\\epsilon}{h^2} + \\frac{1}{2h}\\right) = \\left(\\frac{\\epsilon}{h^2}\\right)^2 - \\left(\\frac{1}{2h}\\right)^2 = \\frac{\\epsilon^2}{h^4} - \\frac{1}{4h^2}\n$$\n当 $\\epsilon \\to 0$ 时，$b \\to 0$ 且 $ac \\to -1/(4h^2)$。\n第一个主元是 $d_1^{(\\mathrm{c})} = b = \\frac{2\\epsilon}{h^2}$。\n第二个主元是 $d_2^{(\\mathrm{c})} = b - \\frac{ac}{d_1^{(\\mathrm{c})}} = \\frac{2\\epsilon}{h^2} - \\frac{\\epsilon^2/h^4 - 1/(4h^2)}{2\\epsilon/h^2} = \\frac{2\\epsilon}{h^2} - \\left(\\frac{\\epsilon}{2h^2} - \\frac{1}{8\\epsilon}\\right) = \\frac{3\\epsilon}{2h^2} + \\frac{1}{8\\epsilon}$。\n对于小的 $\\epsilon$，领头阶行为是 $d_2^{(\\mathrm{c})} \\approx \\frac{1}{8\\epsilon}$。\n第三个主元是 $d_3^{(\\mathrm{c})} = b - \\frac{ac}{d_2^{(\\mathrm{c})}} \\approx \\frac{2\\epsilon}{h^2} - \\frac{-1/(4h^2)}{1/(8\\epsilon)} = \\frac{2\\epsilon}{h^2} + \\frac{2\\epsilon}{h^2} = \\frac{4\\epsilon}{h^2}$。\n这表明存在一种奇偶交替模式：奇数下标的主元量级为 $O(\\epsilon)$，而偶数下标的主元量级为 $O(1/\\epsilon)$。当 $\\epsilon$ 变得非常小时，一个主元可能接近于零，导致数值不稳定。\n我们可以分析子序列的单调性。对于 $i \\ge 3$，我们有 $d_i - d_{i-2} = \\frac{ac(d_{i-1} - d_{i-3})}{d_{i-1}d_{i-3}}$。\n- 我们已经看到 $d_1 \\approx 2\\epsilon/h^2$ 且 $d_3 \\approx 4\\epsilon/h^2$，所以 $d_3 - d_1 > 0$。\n- 对于偶数子序列，$d_4 - d_2 = \\frac{ac(d_3-d_1)}{d_3 d_1}$。由于 $ac  0$ 且 $d_3 - d_1  0$，我们有 $d_4 - d_2  0$，即 $d_2  d_4$。\n通过归纳法可以证明，奇数主元序列 $\\{d_{2k-1}\\}$ 是单调递增的，而偶数主元序列 $\\{d_{2k}\\}$ 是单调递减的。\n因此，所有主元中的最小值必定是奇数子序列的第一个元素，即 $d_1^{(\\mathrm{c})}$。\n$$\n\\min_{1 \\leq i \\leq N-1} d_i^{(\\mathrm{central})} = d_1^{(\\mathrm{c})} = \\frac{2\\epsilon}{h^2}.\n$$\n因此，极限为：\n$$\nL_{\\mathrm{c}} = \\lim_{\\epsilon \\to 0} \\frac{h^{2}}{\\epsilon} \\left(\\frac{2\\epsilon}{h^2}\\right) = 2.\n$$\n\n**迎风离散化**\n\n对于一阶导数的迎风差分近似 $u'(x_j) \\approx (u_j - u_{j-1})/h$，在内部节点 $x_j$ 处的离散方程为：\n$$\n-\\epsilon \\frac{u_{j+1} - 2u_j + u_{j-1}}{h^2} + \\frac{u_j - u_{j-1}}{h} = f_j\n$$\n整理各项，得到三对角系统的系数：\n$$\n\\left(-\\frac{\\epsilon}{h^2} - \\frac{1}{h}\\right)u_{j-1} + \\left(\\frac{2\\epsilon}{h^2} + \\frac{1}{h}\\right)u_j + \\left(-\\frac{\\epsilon}{h^2}\\right)u_{j+1} = f_j\n$$\n系统矩阵 $A^{(\\mathrm{u})}$ 的系数为：\n$a_i^{(\\mathrm{u})} = a = -\\frac{\\epsilon}{h^2} - \\frac{1}{h}$\n$b_i^{(\\mathrm{u})} = b = \\frac{2\\epsilon}{h^2} + \\frac{1}{h}$\n$c_i^{(\\mathrm{u})} = c = -\\frac{\\epsilon}{h^2}$\n对于严格对角占优，我们检验 $|b_i| > |a_i| + |c_i|$。\n$$\n\\frac{2\\epsilon}{h^2} + \\frac{1}{h}  \\left|-\\frac{\\epsilon}{h^2} - \\frac{1}{h}\\right| + \\left|-\\frac{\\epsilon}{h^2}\\right| = \\left(\\frac{\\epsilon}{h^2} + \\frac{1}{h}\\right) + \\frac{\\epsilon}{h^2} = \\frac{2\\epsilon}{h^2} + \\frac{1}{h}\n$$\n这个不等式是严格的，因此该矩阵对于所有 $\\epsilon > 0$ 都是严格对角占优的。这就保证了托马斯算法的稳定性。\n\n主元 $d_i^{(\\mathrm{u})}$ 由 $d_1^{(\\mathrm{u})} = b$ 和 $d_i^{(\\mathrm{u})} = b - \\frac{ac}{d_{i-1}^{(\\mathrm{u})}}$ 给出。由于 $b>0, a0, c0$，我们有 $ac>0$。因此 $d_i  b$。我们可以证明该序列是单调递减的，并收敛到一个正的极限。因此，最小值是极限值 $d_\\infty$。该极限是二次方程 $d^2 - bd + ac = 0$ 的不动点之一。当 $\\epsilon \\to 0$ 时，我们有 $b \\to 1/h$, $a \\to -1/h$, $c \\to 0$。方程变为 $d^2 - (1/h)d + 0 = 0$，其解为 $d=0$ 和 $d=1/h$。由于序列从 $d_1 \\approx 1/h$ 开始，并且是递减且有界的，它必须收敛到较大的根 $1/h$。\n$$\n\\min_{1 \\leq i \\leq N-1} d_i^{(\\mathrm{upwind})} = d_\\infty = \\frac{1}{h}.\n$$\n因此，极限为：\n$$\nL_{\\mathrm{u}} = \\lim_{\\epsilon \\to 0} h \\left(\\frac{1}{h}\\right) = 1.\n$$\n\n**最终答案**\n\n将两个计算得到的值组合成一个单行矩阵：\n$$\n\\left(L_{\\mathrm{c}},\\,L_{\\mathrm{u}}\\right) = \\left(2,\\,1\\right)\n$$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2  1\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "托马斯算法的应用范围远不止于实数矩阵，它已延伸至波物理学等前沿计算领域。本练习将挑战你将该算法应用于复对称系统，这类系统是使用完美匹配层（PML）吸收边界的波传播模型的典型特征。通过亲手实现并测试求解器，你不仅将处理复数运算，还将把理论上的稳定性判据与算法在尖端应用中的实际表现联系起来。",
            "id": "3456831",
            "problem": "考虑一个由完美匹配层 (PML) 吸收层产生的复延伸算子的一维边值问题。设 $\\Omega = (0,1)$，未知函数 $u(x)$ 满足以下模型算子\n$$\n-\\frac{d}{dx}\\left(\\alpha(x)\\frac{du}{dx}\\right) + \\kappa^2 u(x) = f(x), \\quad u(0)=u(1)=0,\n$$\n其中 $\\kappa  0$ 是一个实波数，复值系数 $\\alpha(x)$ 来自复坐标延伸，其延伸函数为 $s(x) = 1 + \\mathrm{i}\\,\\sigma(x)$ 且 $\\alpha(x) = 1/s(x)$。假设 $\\sigma(x) \\ge 0$ 是一个分段光滑函数，并且仅在靠近边界的 PML 子域中非零，因此当使用定义在单元格面上的界面系数的二阶中心差分时，得到的离散算子是复对称（非厄米）且三对角的。\n\n你的任务如下。\n\n- 从均匀网格 $x_i = i h$（其中 $h = 1/(N+1)$，内部索引为 $i=1,\\dots,N$）上的中心有限差分/有限体积平衡出发，使用界面系数 $\\alpha_{i+1/2} = \\alpha(x_{i+1/2})$，推导所得线性系统具有以下形式的复对称三对角矩阵 $A \\in \\mathbb{C}^{N\\times N}$\n$$\nA = \\mathrm{tridiag}(\\{\\ell_i\\}_{i=2}^N,\\{d_i\\}_{i=1}^N,\\{u_i\\}_{i=1}^{N-1}),\n$$\n其中对于所有有效索引，$u_i = \\ell_{i+1}$，而 $d_i$ 集合了左右两侧界面贡献以及 $\\kappa^2$ 项。简要解释为什么当 $\\alpha(x)$ 是来自对称 PML 构造的复值函数时，矩阵 $A$ 是复对称的。\n\n- 将三对角系统（Thomas 算法）的消元方案特化到复对称情况：其代数运算与实数情况相同，但所有算术运算都在 $\\mathbb{C}$ 中进行。陈述在该准则下无需选主元且消元过程是后向稳定的（即产生小残差）的稳定性准则。特别地，论证基于按行严格对角占优的准则，即：\n$$\n|d_i|  |\\ell_i| + |u_i| \\quad \\text{for all interior rows } i,\n$$\n并对第一行和最后一行进行显而易见的修改。讨论由于加上 $\\kappa^2$ 导致的 $\\operatorname{Re}(d_i)  0$ 在确保 Gershgorin 圆盘避开原点方面的作用。\n\n- 实现两个求解器：一个使用 $\\mathbb{R}$ 中的标准浮点算术求解实数三对角系统，另一个使用 $\\mathbb{C}$ 中的算术求解复数三对角系统。使用它们求解形如 $A u = b$ 的系统，该系统通过为一个选定的 $u^\\star$ 定义 $b = A u^\\star$ 来构造，以使精确离散解 $u^\\star$ 已知。将精确离散解取为\n$$\nu^\\star_i = \\sin(\\pi x_i), \\quad x_i = i h, \\quad i=1,\\dots,N.\n$$\n\n- 按如下方式设计 PML 剖面。设 PML 厚度为区域大小的一个比例 $\\tau \\in (0,1)$，并设阻尼剖面为\n$$\n\\sigma(x) = \\sigma_{\\max} \\left(1 - \\frac{\\min\\{x,\\,1-x\\}}{\\tau}\\right)_+^2,\n$$\n其中 $(\\cdot)_+ = \\max\\{\\,\\cdot,\\,0\\,\\}$ 且 $\\sigma_{\\max} \\ge 0$ 是一个参数。定义 $s(x) = 1 + \\mathrm{i}\\,\\sigma(x)$ 和 $\\alpha(x) = 1/s(x)$，并在单元格面 $x_{i+1/2} = (i+1/2)h$ 上离散化 $\\alpha$ 以获得复对称三对角矩阵。通过取 $\\sigma_{\\max} = 0$，使得 $\\alpha(x) \\equiv 1$，可获得纯实数基线（无 PML）。\n\n- 实现一个测试套件，包含以下三个参数集，每个参数集指定 $(N,\\kappa,\\sigma_{\\max},\\tau)$：\n    - 测试 A（一般情况）：$(N,\\kappa,\\sigma_{\\max},\\tau) = (127, 10.0, 20.0, 0.2)$。\n    - 测试 B（小系统边界情况）：$(N,\\kappa,\\sigma_{\\max},\\tau) = (4, 3.0, 5.0, 0.3)$。\n    - 测试 C（强吸收边缘情况）：$(N,\\kappa,\\sigma_{\\max},\\tau) = (127, 20.0, 200.0, 0.25)$。\n\n对每个参数集，执行两次求解：\n    1. 实数基线：设置 $\\sigma_{\\max} = 0$ 来构造一个实对称三对角矩阵，并用实数求解器求解。\n    2. 复数 PML 情况：使用给定的 $\\sigma_{\\max}  0$ 构造一个复对称三对角矩阵，并用复数求解器求解。\n\n对这两次求解中的每一次，计算：\n    - 欧几里得范数下的相对前向误差，\n    $$\n    \\frac{\\|u - u^\\star\\|_2}{\\|u^\\star\\|_2},\n    $$\n    作为一个实数浮点数。\n    - 一个布尔值，指示对应的三对角矩阵是否按行严格对角占优，即是否满足\n    $$\n    |d_i|  |\\ell_i| + |u_i| \\ \\text{for all } i \\in \\{1,\\dots,N\\},\n    $$\n    其中按照惯例 $|\\ell_1| = 0$ 且 $|u_N| = 0$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个测试用例贡献一个包含四个条目的列表，顺序如下\n$$\n\\left[\\text{error}_{\\mathrm{real}},\\ \\text{error}_{\\mathrm{complex}},\\ \\text{dominant}_{\\mathrm{real}},\\ \\text{dominant}_{\\mathrm{complex}}\\right].\n$$\n因此，对于按上述顺序给出的三个测试用例 A、B 和 C，最终输出必须是包含三个此类列表的单行列表，例如\n$$\n[[e_{A,\\mathrm{r}},e_{A,\\mathrm{c}},b_{A,\\mathrm{r}},b_{A,\\mathrm{c}}],[e_{B,\\mathrm{r}},e_{B,\\mathrm{c}},b_{B,\\mathrm{r}},b_{B,\\mathrm{c}}],[e_{C,\\mathrm{r}},e_{C,\\mathrm{c}},b_{C,\\mathrm{r}},b_{C,\\mathrm{c}}]].\n$$\n此问题不要求物理单位，也不涉及角度或百分比。所有数值输出必须是如上所述的普通浮点数或布尔值。",
            "solution": "该问题是有效的。它在科学上基于已建立的关于波动问题的完美匹配层 (PML) 理论及​​其数值离散化。问题是适定的，提供了所有必要的定义、参数和一组明确的任务。语言客观，要求明确。\n\n解答分为两部分。首先，按要求对数值方法进行理论推导和讨论。其次，是该方法的实现和测试。\n\n### 复对称三对角系统的推导\n\n我们从区域 $\\Omega = (0,1)$ 上的一维边值问题开始：\n$$\n-\\frac{d}{dx}\\left(\\alpha(x)\\frac{du}{dx}\\right) + \\kappa^2 u(x) = f(x), \\quad u(0)=u(1)=0.\n$$\n我们使用步长为 $h = 1/(N+1)$ 的均匀网格对区域进行离散化。网格点为 $x_i = i h$，其中 $i=0, 1, \\dots, N+1$。未知函数 $u(x)$ 在内部网格点 $x_i$（其中 $i=1, \\dots, N$）处进行近似，记为 $u_i \\approx u(x_i)$。边界条件意味着 $u_0 = 0$ 且 $u_{N+1} = 0$。\n\n我们采用有限体积法或中心有限差分法。将微分方程在围绕每个节点 $x_i$ 的控制体积 $V_i = [x_{i-1/2}, x_{i+1/2}]$ 上积分，其中 $x_{i\\pm1/2} = x_i \\pm h/2$，我们得到：\n$$\n\\int_{x_{i-1/2}}^{x_{i+1/2}} \\left[-\\frac{d}{dx}\\left(\\alpha(x)\\frac{du}{dx}\\right) + \\kappa^2 u(x)\\right] dx = \\int_{x_{i-1/2}}^{x_{i+1/2}} f(x) dx.\n$$\n对第一项应用微积分基本定理，并对剩余的积分使用中点法则，可得：\n$$\n-\\left[\\alpha(x)\\frac{du}{dx}\\right]_{x_{i-1/2}}^{x_{i+1/2}} + \\kappa^2 u(x_i) h \\approx f(x_i) h.\n$$\n通量项使用二阶中心差分进行近似：\n$$\n-\\left( \\alpha(x_{i+1/2}) \\frac{u(x_{i+1})-u(x_i)}{h} - \\alpha(x_{i-1/2}) \\frac{u(x_i)-u(x_{i-1})}{h} \\right) + \\kappa^2 u_i h \\approx f_i h.\n$$\n令 $\\alpha_{i+1/2} = \\alpha(x_{i+1/2})$，两边除以 $h$，并为未知数 $u_i$ 重新整理各项，我们得到节点 $i$ 处的离散方程：\n$$\n-\\frac{\\alpha_{i-1/2}}{h^2} u_{i-1} + \\left(\\frac{\\alpha_{i-1/2} + \\alpha_{i+1/2}}{h^2} + \\kappa^2\\right) u_i - \\frac{\\alpha_{i+1/2}}{h^2} u_{i+1} = f_i,\n$$\n其中 $i=1, \\dots, N$。边界条件 $u_0=0$ 和 $u_{N+1}=0$ 被直接并入。\n\n这 $N$ 个线性方程构成一个系统 $A u = b$，其中 $u, b \\in \\mathbb{C}^N$。矩阵 $A \\in \\mathbb{C}^{N\\times N}$ 是三对角的。遵循问题中的记法 $A = \\mathrm{tridiag}(\\{\\ell_i\\}_{i=2}^N,\\{d_i\\}_{i=1}^N,\\{u_i\\}_{i=1}^{N-1})$，其元素为：\n-   **主对角线 ($d_i = A_{i,i}$):** $d_i = \\dfrac{\\alpha_{i-1/2} + \\alpha_{i+1/2}}{h^2} + \\kappa^2$ for $i=1,\\dots,N$。\n-   **次对角线 ($\\ell_i = A_{i,i-1}$):** $\\ell_i = -\\dfrac{\\alpha_{i-1/2}}{h^2}$ for $i=2,\\dots,N$。\n-   **超对角线 ($u_i = A_{i,i+1}$):** $u_i = -\\dfrac{\\alpha_{i+1/2}}{h^2}$ for $i=1,\\dots,N-1$。\n\n矩阵 $A$ 是复对称的，即 $A = A^T$，因为 $A_{i,i+1} = A_{i+1,i}$。我们来验证这一点。元素 $A_{i,i+1}$ 是第 $i$ 个方程中 $u_{i+1}$ 的系数，即 $u_i = -\\alpha_{i+1/2}/h^2$。元素 $A_{i+1,i}$ 是第 $(i+1)$ 个方程中 $u_i$ 的系数，即 $\\ell_{i+1} = -\\alpha_{((i+1)-1/2)}/h^2 = -\\alpha_{i+1/2}/h^2$。因此，对于所有有效索引（$i=1, \\dots, N-1$），都有 $u_i = \\ell_{i+1}$，这证实了 $A$ 是对称的。这种对称性源于原始微分算子的自伴性质和中心离散格式，这确保了无论考虑哪个节点的方程，两个相邻节点之间的耦合系数都是相同的。即使当 $\\alpha(x)$ 是复数时，这一点也成立。\n\n### Thomas 算法和稳定性准则\n\nThomas 算法是求解三对角系统的一种高效方法，它基于无主元的高斯消元法。它包括一个前向消元过程和一个后向代入过程。对于一个对角线元素为 $\\ell_i, d_i, u_i$ 的系统，该算法会原地修改主对角线和右端向量。\n\n前向消元过程对 $i=2, \\dots, N$ 进行：\n$$\nw_i = \\frac{\\ell_i}{d_{i-1}'}, \\quad d_i' = d_i - w_i u_{i-1}, \\quad b_i' = b_i - w_i b_{i-1}'.\n$$\n解随后通过对 $i=N, N-1, \\dots, 1$ 进行后向代入找到：\n$$\nu_N = \\frac{b_N'}{d_N'}, \\quad u_i = \\frac{b_i' - u_i u_{i+1}}{d_i'} \\quad \\text{for } i=N-1, \\dots, 1.\n$$\n如果矩阵 $A$ 是按行严格对角占优的，该算法就是数值稳定的，这个条件表述为：\n$$\n|d_i|  |\\ell_i| + |u_i| \\quad \\text{for all } i \\in \\{1,\\dots,N\\},\n$$\n其中 $\\ell_1$ 和 $u_N$ 被理解为零。严格对角占优保证了在消元过程中产生的 pivotal 元素 $d_i'$ 不会变为零。更进一步，可以通过归纳法证明，如果 $A$ 是严格对角占优的，那么对所有 $i$ 都有 $|d_i'|  |u_i|$，这界定了矩阵元素的增长并确保了后向稳定性。\n\nGershgorin 圆盘定理提供了进一步的见解。它指出 $A$ 的每个特征值都位于某个 Gershgorin 圆盘 $G_i = \\{ z \\in \\mathbb{C} : |z - d_i| \\le R_i \\}$ 内，其中 $R_i = \\sum_{j \\ne i} |A_{ij}|$。对于我们的矩阵，$R_i = |\\ell_i| + |u_i|$。严格对角占优的条件 $|d_i|  R_i$ 意味着圆盘 $G_i$ 不包含原点（$0$）。如果这个条件对所有 $i$ 都成立，那么 $0$ 不可能是特征值，因此矩阵 $A$ 是非奇异的。\n\n在我们的问题中，对角元素为 $d_i = (\\alpha_{i-1/2} + \\alpha_{i+1/2})/h^2 + \\kappa^2$。函数 $\\alpha(x) = 1/(1+i\\sigma(x))$ 的实部为正，$\\operatorname{Re}(\\alpha(x)) = 1/(1+\\sigma(x)^2)  0$。由于给定 $\\kappa^2  0$，因此对于所有 $i$，都有 $\\operatorname{Re}(d_i)  0$。这将所有 Gershgorin 圆盘的中心置于复平面的右半部分。虽然这本身并不能保证圆盘避开原点，但它对稳定性有重要贡献，特别是对于较大的 $\\kappa$。对于 $\\sigma(x)=0$ 的实数情况，我们有 $\\alpha(x)=1$。对角占优条件变为 $|2/h^2 + \\kappa^2|  |-1/h^2| + |-1/h^2|$，可简化为 $2/h^2 + \\kappa^2  2/h^2$，即 $\\kappa^2  0$。由于给定 $\\kappa0$，该实对称矩阵总是严格对角占优且正定的。对于 $\\sigma(x)0$ 的复数情况，$\\operatorname{Re}(\\alpha(x))  |\\alpha(x)|$，对角占优性不被保证；它取决于具体参数，必须进行检验。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the specified test cases.\n    \"\"\"\n\n    def thomas_solver(l, d, u, b):\n        \"\"\"\n        Solves a tridiagonal system Ax=b.\n        l: sub-diagonal (length N-1), l[i] = A[i+1, i]\n        d: main diagonal (length N), d[i] = A[i, i]\n        u: super-diagonal (length N-1), u[i] = A[i, i+1]\n        b: right-hand side vector (length N)\n        \"\"\"\n        N = len(d)\n        d_prime = np.copy(d)\n        b_prime = np.copy(b)\n\n        # Forward elimination\n        for i in range(1, N):\n            w = l[i-1] / d_prime[i-1]\n            d_prime[i] = d_prime[i] - w * u[i-1]\n            b_prime[i] = b_prime[i] - w * b_prime[i-1]\n\n        # Backward substitution\n        x = np.zeros_like(b)\n        x[N-1] = b_prime[N-1] / d_prime[N-1]\n        for i in range(N - 2, -1, -1):\n            x[i] = (b_prime[i] - u[i] * x[i+1]) / d_prime[i]\n\n        return x\n\n    def setup_system_and_solve(N, kappa, sigma_max, tau):\n        \"\"\"\n        Constructs the tridiagonal system and solves it.\n        Returns the relative forward error and a boolean for diagonal dominance.\n        \"\"\"\n        h = 1.0 / (N + 1)\n        # Interior grid points for u\n        x_nodes = np.linspace(h, 1.0 - h, N)\n        # Grid faces for alpha\n        x_faces = np.linspace(h / 2.0, 1.0 - h / 2.0, N + 1)\n\n        # PML profile sigma(x)\n        sigma_vals = np.zeros_like(x_faces, dtype=float)\n        if sigma_max > 0:\n            min_dist_to_boundary = np.minimum(x_faces, 1.0 - x_faces)\n            profile_arg = 1.0 - min_dist_to_boundary / tau\n            profile_arg[profile_arg  0] = 0.0\n            sigma_vals = sigma_max * (profile_arg**2)\n\n        # alpha(x) = 1 / (1 + i*sigma(x))\n        alpha_vals = 1.0 / (1.0 + 1j * sigma_vals)\n        if sigma_max == 0:\n            alpha_vals = alpha_vals.real\n        \n        dtype = alpha_vals.dtype\n\n        # Construct tridiagonal matrix A\n        # l[i] = A[i+1, i], u[i] = A[i, i+1] for i in 0..N-2\n        # d[i] = A[i, i] for i in 0..N-1\n        l = -alpha_vals[1:N] / h**2\n        d = (alpha_vals[0:N] + alpha_vals[1:N+1]) / h**2 + kappa**2\n        u = -alpha_vals[1:N] / h**2\n\n        # Check for strict diagonal dominance\n        is_dominant = True\n        # Row 0\n        if N > 1 and np.abs(d[0]) = np.abs(u[0]):\n            is_dominant = False\n        # Rows 1 to N-2\n        if is_dominant:\n            for i in range(1, N - 1):\n                if np.abs(d[i]) = np.abs(l[i-1]) + np.abs(u[i]):\n                    is_dominant = False\n                    break\n        # Row N-1\n        if is_dominant and N > 1:\n            if np.abs(d[N-1]) = np.abs(l[N-2]):\n                is_dominant = False\n\n        # Define exact discrete solution\n        u_star = np.sin(np.pi * x_nodes).astype(dtype)\n\n        # Construct right-hand side b = A * u_star\n        b = np.zeros(N, dtype=dtype)\n        if N == 1:\n            b[0] = d[0] * u_star[0]\n        else:\n            b[0] = d[0] * u_star[0] + u[0] * u_star[1]\n            for i in range(1, N - 1):\n                b[i] = l[i-1] * u_star[i-1] + d[i] * u_star[i] + u[i] * u_star[i+1]\n            b[N-1] = l[N-2] * u_star[N-2] + d[N-1] * u_star[N-1]\n\n        # Solve the system\n        u_sol = thomas_solver(l, d, u, b)\n\n        # Compute relative forward error\n        norm_u_star = np.linalg.norm(u_star)\n        if norm_u_star == 0:\n            error = np.linalg.norm(u_sol)\n        else:\n            error = np.linalg.norm(u_sol - u_star) / norm_u_star\n\n        return float(error), is_dominant\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (127, 10.0, 20.0, 0.2),   # Test A\n        (4, 3.0, 5.0, 0.3),       # Test B\n        (127, 20.0, 200.0, 0.25), # Test C\n    ]\n\n    results = []\n    for case in test_cases:\n        N, kappa, sigma_max, tau = case\n        \n        # 1. Real baseline case\n        error_real, dominant_real = setup_system_and_solve(N, kappa, 0.0, tau)\n        \n        # 2. Complex PML case\n        error_complex, dominant_complex = setup_system_and_solve(N, kappa, sigma_max, tau)\n        \n        results.append([error_real, error_complex, dominant_real, dominant_complex])\n\n    # Final print statement in the exact required format.\n    # The default string representation of a list includes spaces, matching the example.\n    print(str(results).replace(\"'\", \"\"))\n\n\nsolve()\n```"
        }
    ]
}