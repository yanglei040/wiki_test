## 引言
在计算科学与工程的广阔领域中，对[偏微分方程](@entry_id:141332)（PDEs）进行数值求解是模拟物理世界的基石。而在众多求解技术中，基于[结构化网格](@entry_id:170596)的实现方法因其固有的简洁性、高效率和强大的算法支持，始终占据着核心地位。它将连续的物理问题转化为计算机可以处理的离散代数系统，是连接理论物理与实际工程应用的关键桥梁。

然而，将[数值分析](@entry_id:142637)的理论转化为高效、准确且稳健的计算机代码，本身就是一门艺术和科学，其中充满了挑战。一个看似微小的实现错误，例如对边界条件处理不当或误解[内存布局](@entry_id:635809)，都可能导致数值解的严重失真。本文旨在填补理论与实践之间的鸿沟，系统性地阐述在[结构化网格](@entry_id:170596)上实现数值方案的完整流程和最佳实践。

在接下来的章节中，我们将踏上一段从基础到前沿的旅程。在“原理与机制”部分，我们将深入剖析[结构化网格](@entry_id:170596)的定义、数据结构、边界条件处理、算子离散化以及对格式质量的分析。随后，在“应用与跨学科联系”部分，我们将展示这些原理如何在[高性能计算](@entry_id:169980)、复杂几何处理、[自适应加密](@entry_id:746260)以及固体力学、[流体力学](@entry_id:136788)等多个领域中发挥威力。最后，“动手实践”部分将提供具体的编程练习，帮助您将所学知识转化为实际的编程技能。通过这一系统性的学习，您将能够自信地在[结构化网格](@entry_id:170596)上构建和验证高质量的数值求解器。

## 原理与机制

在[偏微分方程](@entry_id:141332)（PDEs）的数值求解中，[结构化网格](@entry_id:170596)的实现是计算科学与工程领域的一块基石。本章将深入探讨在[结构化网格](@entry_id:170596)上实现数值方案所涉及的核心原理和关键机制。我们将从网格的基本定义开始，逐步过渡到边界条件处理、算子离散化、以及对[数值格式](@entry_id:752822)质量（如精度、稳定性和守恒性）的分析。

### [结构化网格](@entry_id:170596)的基本概念

[结构化网格](@entry_id:170596)，或称规则网格，其特点是具有清晰的拓扑结构和逻辑索引系统。网格中的每个点都可以通过一个整数元组（如二维中的 $(i,j)$ 或三维中的 $(i,j,k)$）来唯一标识，这种规则性极大地简化了邻近点的查找和[数据存储](@entry_id:141659)。

#### 网格的定义：节点、单元和面

考虑一个二维矩形计算域 $\Omega = [x_{\min}, x_{\max}] \times [y_{\min}, y_{\max}]$。我们可以通过沿坐标轴方向以均匀间距 $h_x$ 和 $h_y$ 对其进行划分，来构建一个均匀的笛卡尔网格。假设 $N_x = (x_{\max} - x_{\min})/h_x$ 和 $N_y = (y_{\max} - y_{\min})/h_y$ 均为整数，这就在域内定义了 $N_x \times N_y$ 个矩形单元。在此基础上，我们可以精确定义网格的三个基本要素：**节点（nodes）**、**单元（cells）** 和 **面（faces）**。

-   **节点 (Nodes)** 是网格线的交点，也即单元的顶点。对于一个由 $N_x \times N_y$ 个单元组成的网格，共有 $(N_x + 1) \times (N_y + 1)$ 个节点。若采用从零开始的索引，节点 $(i,j)$ 的索引范围为 $i \in \{0, 1, \dots, N_x\}$ 和 $j \in \{0, 1, \dots, N_y\}$。其物理坐标 $(x_i, y_j)$ 由下式给出：
    $$
    x_i = x_{\min} + i h_x, \quad y_j = y_{\min} + j h_y
    $$
    存储在节点上的物理量（如有限元方法中的解）需要一个尺寸为 $(N_x + 1) \times (N_y + 1)$ 的数组。

-   **单元中心 (Cell Centers)** 是每个矩形单元的几何中心。共有 $N_x \times N_y$ 个单元。单元 $(i,j)$ 的索引范围为 $i \in \{0, 1, \dots, N_x - 1\}$ 和 $j \in \{0, 1, \dots, N_y - 1\}$。其物理坐标 $(x_{i+1/2}, y_{j+1/2})$ 是单元四个顶点坐标的平均值：
    $$
    x_{i+\frac{1}{2}} = x_{\min} + \left(i + \frac{1}{2}\right) h_x, \quad y_{j+\frac{1}{2}} = y_{\min} + \left(j + \frac{1}{2}\right) h_y
    $$
    在有限体积法中，物理量的平均值通常存储在单元中心，需要一个尺寸为 $N_x \times N_y$ 的数组。

-   **面中心 (Face Centers)** 是单元的边界，即网格线段的中心。对于[交错网格格式](@entry_id:163561)（例如用于[流体动力学](@entry_id:136788)的 MAC 格式），区分法向分别指向 $x$ 和 $y$ 方向的面至关重要。
    -   **$x$-面 ($x$-faces)**：垂直面，其法向与 $x$ 轴平行。它们位于 $x=x_i$ 的直线上。共有 $(N_x+1)$ 列和 $N_y$ 行这样的面。其索引 $(i,j)$ 的范围为 $i \in \{0, 1, \dots, N_x\}$ 和 $j \in \{0, 1, \dots, N_y - 1\}$。面中心的坐标为 $(x_i, y_{j+1/2})$。存储在 $x$-面上的数据（如 $x$ 方向的速度分量）需要一个尺寸为 $(N_x + 1) \times N_y$ 的数组。
    -   **$y$-面 ($y$-faces)**：水平面，其法向与 $y$ 轴平行。它们位于 $y=y_j$ 的直线上。共有 $N_x$ 列和 $(N_y+1)$ 行这样的面。其索引 $(i,j)$ 的范围为 $i \in \{0, 1, \dots, N_x - 1\}$ 和 $j \in \{0, 1, \dots, N_y\}$。面中心的坐标为 $(x_{i+1/2}, y_j)$。存储在 $y$-面上的数据需要一个尺寸为 $N_x \times (N_y + 1)$ 的数组。

#### 数据结构与[内存布局](@entry_id:635809)

在计算机中存储这些多维网格数据时，[内存布局](@entry_id:635809)对性能有显著影响。对于一个二维数组 `A[i][j]`，其中 `i` 是行索引，`j` 是列索引，存在两种主要的[内存布局](@entry_id:635809)方式：

-   **[行主序](@entry_id:634801) (Row-Major Order)**：在 C、C++ 和 Python 等语言中常见。同一行中的元素在内存中是连续存储的。当最末一个索引（`j`）变化时，内存地址增长最快。为了利用 CPU 缓存的局部性原理以实现高效遍历，内层循环应当遍历 `j`，即 `for i ... for j ...`。

-   **[列主序](@entry_id:637645) (Column-Major Order)**：在 Fortran、MATLAB 和 R 等语言中常见。同一列中的元素在内存中是连续存储的。当第一个索引（`i`）变化时，内存地址增长最快。高效的遍历方式是将内层循环作用于 `i`，即 `for j ... for i ...`。

对[内存布局](@entry_id:635809)的误解可能导致严重的性能下降，因为非连续的内存访问会频繁引发缓存未命中。

#### 从逻辑空间到物理空间的映射

在实际应用中，计算域通常不从原点 $(0,0)$ 开始。因此，建立一个从**逻辑索引空间**（整数索引 $(i,j)$）到**物理坐标空间** $(x,y)$ 的通用映射至关重要。

对于一个单元中心网格，覆盖物理域 $[x_0, x_1] \times [y_0, y_1]$ 并包含 $N_x \times N_y$ 个内部控制体积，我们可以从第一性原理出发构建此映射。在 $x$ 方向上，域的长度为 $L_x = x_1 - x_0$，被划分为 $N_x$ 个单元，因此每个单元的宽度为 $\Delta x = (x_1 - x_0)/N_x$。在单元中心格式中，物理边界 $x_0$ 和 $x_1$ 分别与第一个和最后一个内部单元的外侧面对齐。逻辑索引为 $i$（通常从 1 开始，即 $i \in \{1, \dots, N_x\}$）的内部单元占据的物理区间为 $[x_0 + (i-1)\Delta x, x_0 + i\Delta x]$。该单元的中心坐标 $x(i)$ 位于此区间的中点：
$$
x(i) = x_0 + \left(i - \frac{1}{2}\right)\Delta x = x_0 + \left(i - \frac{1}{2}\right) \frac{x_1 - x_0}{N_x}
$$
同样，对于 $y$ 方向，映射为：
$$
y(j) = y_0 + \left(j - \frac{1}{2}\right)\Delta y = y_0 + \left(j - \frac{1}{2}\right) \frac{y_1 - y_0}{N_y}
$$
这些线性映射关系是实现代码可移植性和通用性的基础，它们将抽象的网格索引与具体的物理几何联系起来。

### 边界条件与[鬼点](@entry_id:177889)/晕圈

在有限差分或有限体积方法中，计算一个点上的空间导数通常需要其邻近点的值。对于靠近计算域边界的点，其“邻居”可能位于域外。**[鬼点](@entry_id:177889)（ghost cells）**或**晕圈（halo layers）**是一种强大的技术，通过在物理域周围添加虚拟的单元层来优雅地处理这个问题。

#### [鬼点](@entry_id:177889)的概念

[鬼点](@entry_id:177889)的引入使得我们可以将用于内部点的标准离散模板（stencil）统一应用于包括边界附近在内的所有点。[鬼点](@entry_id:177889)中的值不是独立的未知数，而是根据特定的边界条件由内部点的值推算出来的。

#### 实现[狄利克雷边界条件](@entry_id:173524)

以二维[泊松方程](@entry_id:143763) $-\Delta u = f$ 为例，考虑在单位正方形 $\Omega = (0,1) \times (0,1)$ 上施加**齐次狄利克雷边界条件** $u=0$。假设我们采用一种特殊的节点中心网格，其中未知数 $u_{i,j}$ 位于点 $(x_i, y_j) = ((i+1/2)h, (j+1/2)h)$，而物理边界（如 $x=0$）恰好位于第一层内部节点（$i=0$，在 $x_0=h/2$）和其对应的[鬼点](@entry_id:177889)（$i=-1$，在 $x_{-1}=-h/2$）之间。

为了保持[二阶精度](@entry_id:137876)，我们可以在物理边界 $x=0$ 处使用中心差分来施加条件 $u(0,y_j)=0$。通过对相邻的内部点和[鬼点](@entry_id:177889)的值进行平均，我们得到：
$$
u(0, y_j) \approx \frac{u(x_0, y_j) + u(x_{-1}, y_j)}{2} = \frac{u_{0,j} + u_{-1,j}}{2}
$$
由于 $u(0, y_j) = 0$，我们得到[鬼点](@entry_id:177889)值的关系式：$u_{-1,j} = -u_{0,j}$。

这个关系式可以用来修改边界附近节点的离散算子。标准的负拉普拉斯算子（$-\Delta_h$）在内部点 $(i,j)$（假设 $h_x=h_y=h$）上的[五点模板](@entry_id:174268)为：
$$
(-\Delta_h u)_{i,j} = \frac{1}{h^2} (4u_{i,j} - u_{i-1,j} - u_{i+1,j} - u_{i,j-1} - u_{i,j+1})
$$
对于一个邻近左边界的节点 $(0,j)$，其模板涉及[鬼点](@entry_id:177889) $u_{-1,j}$。将 $u_{-1,j} = -u_{0,j}$ 代入，我们得到修改后的算子：
$$
(-\Delta_h u)_{0,j} = \frac{1}{h^2} (4u_{0,j} - (-u_{0,j}) - u_{1,j} - u_{0,j-1} - u_{0,j+1}) = \frac{1}{h^2} (5u_{0,j} - u_{1,j} - u_{0,j-1} - u_{0,j+1})
$$
类似地，对于角点 $(0,0)$，它同时邻近两个边界，其模板会涉及两个[鬼点](@entry_id:177889) $u_{-1,0} = -u_{0,0}$ 和 $u_{0,-1} = -u_{0,0}$。代入后得到：
$$
(-\Delta_h u)_{0,0} = \frac{1}{h^2} (6u_{0,0} - u_{1,0} - u_{0,1})
$$
通过这种方式，[鬼点](@entry_id:177889)将边界条件的影响优雅地融入到线性系统的矩阵结构中。

#### 实现[周期性边界条件](@entry_id:147809)

对于**[周期性边界条件](@entry_id:147809)**，一个更高效的实现方式是使用**虚拟晕圈**（virtual halo）。在这种方法中，我们不为晕圈分配额外的内存。相反，我们通过逻辑索引映射来访问它们，该映射利用周期性将晕圈中的索引“环绕”回物理域内部。

考虑一个三维物理网格，其维度为 $N_x \times N_y \times N_z$，物理索引范围为 $i_p \in [0, N_x-1], j_p \in [0, N_y-1], k_p \in [0, N_z-1]$。在计算需要宽度为 $g$ 的晕圈的模板时，逻辑索引 $(i,j,k)$ 的范围会超出物理域。例如，访问点 $(i-1,j,k)$，当 $i=0$ 时，会访问到逻辑索引 $(-1,j,k)$。

对于周期性边界，我们可以使用**模运算（modulo arithmetic）**将逻辑索引映射回物理索引：
$$
i_p = i \pmod{N_x}, \quad j_p = j \pmod{N_y}, \quad k_p = k \pmod{N_z}
$$
例如，逻辑索引 $i=-1$ 会被映射到物理索引 $i_p = -1 \pmod{N_x} = N_x-1$。这种方法不仅实现了周期性，而且将内存占用降至最低，因为只需要为 $N_x N_y N_z$ 个物理单元存储数据。这在[高性能计算](@entry_id:169980)中至关重要。

### 微分算子的离散化

在[结构化网格](@entry_id:170596)上，[偏微分方程](@entry_id:141332)中的导数项被替换为[有限差分近似](@entry_id:749375)。这些近似的质量直接决定了数值解的准确性。

#### 在均匀网格上近似导数

最常见的[离散化方法](@entry_id:272547)之一是中心差分。例如，一维[二阶导数](@entry_id:144508) $u_{xx}$ 的二阶精度[中心差分近似](@entry_id:177025)为：
$$
(D^{(2)} u)_j = \frac{u_{j+1} - 2 u_j + u_{j-1}}{h^{2}}
$$
其中 $h$ 是均匀的网格间距。类似地，一阶导数 $u_x$ 的[二阶精度](@entry_id:137876)[中心差分近似](@entry_id:177025)为：
$$
(D^{(1)} u)_j = \frac{u_{j+1} - u_{j-1}}{2h}
$$
然而，对于输运问题（如平流方程），[中心差分格式](@entry_id:747203)可能会引入非物理的[振荡](@entry_id:267781)。因此，人们开发了其他格式，如[迎风格式](@entry_id:756374)和[高阶格式](@entry_id:150564)。

#### 离散化质量分析：截断误差和[修正波数](@entry_id:141354)

评估一个离散格式好坏的两种主要工具是[泰勒级数展开](@entry_id:138468)（分析**[截断误差](@entry_id:140949)**）和傅里叶分析（分析**[修正波数](@entry_id:141354)**）。

**傅里叶分析和[修正波数](@entry_id:141354) (Modified Wavenumber)**

我们可以通过考察离散算子如何作用于一个傅里叶模态 $u(x) = \exp(ikx)$ 来分析其性质。连续的[二阶导数](@entry_id:144508)算子作用于该模态会得到 $u''(x) = -k^2 \exp(ikx)$，其中 $k$ 是波数。

现在，我们将离散算子 $D^{(2)}$ 应用于离散的傅里叶模态 $u_j = \exp(ikx_j) = \exp(ikjh)$。经过代数运算，我们发现 ：
$$
(D^{(2)} u)_j = \left( \frac{-4 \sin^2(k h / 2)}{h^{2}} \right) u_j
$$
我们将这个结果与一个定义了**[修正波数](@entry_id:141354)** $k_{\mathrm{mod}}$ 的关系式 $(D^{(2)} u)_j = -k_{\mathrm{mod}}^{2} u_j$ 进行比较，得到：
$$
k_{\mathrm{mod}}^2 = \frac{4 \sin^2(k h / 2)}{h^{2}} \implies k_{\mathrm{mod}} = \frac{2}{h} \left|\sin\left(\frac{kh}{2}\right)\right|
$$
[修正波数](@entry_id:141354) $k_{\mathrm{mod}}$ 与真实[波数](@entry_id:172452) $k$ 的差异导致了**[色散误差](@entry_id:748555) (dispersion error)**，这意味着不同波长的波在数值网格上以不同的（不正确的）速度传播。[色散误差](@entry_id:748555)函数 $\epsilon(\theta)$（其中 $\theta = kh$ 是无量纲波数）定义为：
$$
\epsilon(\theta) = \frac{k_{\mathrm{mod}}^{2}}{k^{2}} - 1 = \frac{4 \sin^2(\theta / 2)}{\theta^{2}} - 1
$$
对于长波（小 $\theta$），$\epsilon(\theta) \approx -\theta^2/12$，表明误差是二阶的。但对于短波（$\theta$ 接近 $\pi$），误差显著，导致可见的非物理[振荡](@entry_id:267781)。

**修正方程分析 (Modified Equation Analysis)**

通过泰勒展开，我们可以得到一个离散格式所实际求解的“修正方程”。这揭示了离散化引入的误差项的性质。以一阶[平流方程](@entry_id:144869) $u_t + a u_x = 0$ ($a>0$) 为例 ：
-   **[一阶迎风格式](@entry_id:749417)** ($u_x \approx (u_j - u_{j-1})/h$) 的修正方程为：
    $$
    u_t + a u_x = \underbrace{a \frac{h}{2} u_{xx}}_{\text{数值耗散}} - \underbrace{a \frac{h^2}{6} u_{xxx}}_{\text{数值色散}} + \dots
    $$
    其主导误差项是[二阶导数](@entry_id:144508)，表现为**[数值耗散](@entry_id:168584)**或**[数值黏性](@entry_id:141318)**，会抹平解中的陡峭梯度。
-   **[二阶中心差分](@entry_id:170774)格式** ($u_x \approx (u_{j+1} - u_{j-1})/(2h)$) 的修正方程为：
    $$
    u_t + a u_x = \underbrace{-a \frac{h^2}{6} u_{xxx}}_{\text{数值色散}} - \dots
    $$
    其主导误差项是三阶导数，表现为**[数值色散](@entry_id:145368)**，会在解中产生非物理的[振荡](@entry_id:267781)。
-   **QUICK 格式**（一种[高阶迎风格式](@entry_id:750335)）则同时引入了耗散和[色散](@entry_id:263750)项，旨在平衡精度和稳定性。

分析这些修正方程有助于我们理解和预测不同数值格式的行为。

#### [非均匀网格](@entry_id:752607)上的离散化

在实际问题中，为了在梯度较大的区域（如[边界层](@entry_id:139416)）获得更高的分辨率，常常需要使用[非均匀网格](@entry_id:752607)。然而，网格的非[均匀性](@entry_id:152612)会影响离散格式的精度。

考虑一个在 $x$ 方向上非均匀的网格，其相邻间距分别为 $h_{i-1}^x = x_i - x_{i-1}$ 和 $h_i^x = x_{i+1} - x_i$。[二阶导数](@entry_id:144508)的保守离散格式为：
$$
D_{xx} u_{i,j} = \frac{2}{h_i^x + h_{i-1}^x} \left( \frac{u_{i+1,j} - u_{i,j}}{h_i^x} - \frac{u_{i,j} - u_{i-1,j}}{h_{i-1}^x} \right)
$$
通过泰勒展开可以证明，该格式的[截断误差](@entry_id:140949)的[主导项](@entry_id:167418)为：
$$
T_{i,j}^x = \frac{h_i^x - h_{i-1}^x}{3} \frac{\partial^3 u}{\partial x^3} + \mathcal{O}(h^2)
$$
其中 $h$ 是网格尺寸的量级。如果[网格拉伸](@entry_id:170494)剧烈，即相邻网格间距的差 $|h_i^x - h_{i-1}^x|$ 与间距本身是同阶的（即 $\mathcal{O}(h)$），那么该格式的精度会**降至一阶**。为了恢复[二阶精度](@entry_id:137876)，必须保证网格是**平滑**的，即满足如下条件：
$$
|h_i^x - h_{i-1}^x| = \mathcal{O}(h^2)
$$
这意味着相邻网格尺寸的变化率必须随着网格的加密而减小。在生成网格时，这是一个必须考虑的重要约束，以避免精度损失。

### 稳定性和守恒性

一个好的[数值格式](@entry_id:752822)不仅要精确，还必须稳定，并且理想情况下应能模拟原物理定律的守恒性质。

#### [冯·诺依曼稳定性分析](@entry_id:145718)

**[冯·诺依曼稳定性分析](@entry_id:145718)**是研究线性、[常系数](@entry_id:269842)[偏微分方程](@entry_id:141332)在[周期性边界条件](@entry_id:147809)下的离散格式稳定性的标准工具。其核心思想是考察一个傅里叶模态在[时间演化](@entry_id:153943)中的振幅变化。

考虑[二维热传导方程](@entry_id:171796) $u_t = \nu \Delta u$，使用前向欧拉法进行时间离散，标准[中心差分](@entry_id:173198)进行空间离散。其完全离散格式为：
$$
\frac{u^{n+1}_{j,k} - u^n_{j,k}}{\Delta t} = \nu \Delta_h u^n_{j,k}
$$
其中 $\Delta_h$ 是五点[离散拉普拉斯算子](@entry_id:634690)。我们代入一个傅里葉模态 $u^n_{j,k} = (A)^n e^{i(k_x x_j + k_y y_k)}$，其中 $A$ 是振幅。经过推导，我们可以得到**放大因子** $G = A^{n+1}/A^n$ 的表达式 ：
$$
G = 1 - \frac{4\nu \Delta t}{h^2} \left[ \sin^2\left(\frac{k_x h}{2}\right) + \sin^2\left(\frac{k_y h}{2}\right) \right]
$$
为了保证数值解不随时间发散，稳定性要求对所有可能的[波数](@entry_id:172452) $(k_x, k_y)$，[放大因子](@entry_id:144315)的模都必须不大于 1，即 $|G| \le 1$。对于上述实数 $G$，此条件等价于 $-1 \le G \le 1$。最严格的约束来自于使 $G$ 取最小值的最高频模态（$k_x h = \pi, k_y h = \pi$）。代入这些值，我们得到：
$$
-1 \le 1 - \frac{4\nu \Delta t}{h^2} (1 + 1) \implies \Delta t \le \frac{h^2}{4\nu}
$$
这个不等式即著名的 **CFL ([Courant-Friedrichs-Lewy](@entry_id:175598)) 条件**，它为显式时间格式的时间步长 $\Delta t$ 设定了上限。值得注意的是，该上限与网格间距的平方 $h^2$ 成正比。这意味着，当网格加密一倍时，为了维持稳定，时间步长必须缩减为原来的四分之一。对于在边界附近有精细拉伸的[非均匀网格](@entry_id:752607)，稳定性由最小的网格间距 $h_{\min}$ 决定，导致非常苛刻的[时间步长限制](@entry_id:756010) 。

#### [交错网格](@entry_id:147661)与[压力-速度耦合](@entry_id:155962)

在不可压缩流体的数值模拟中，一个核心挑战是正确地处理压力与速度之间的耦合，以满足[无散度](@entry_id:190991)条件 $\nabla \cdot \mathbf{u} = 0$。

在一个**[同位网格](@entry_id:175200) (colocated grid)** 上，即压力 $p$ 和速度分量 $(u,v)$ 都存储在单元中心，一个简单的[离散梯度](@entry_id:171970)和[散度算子](@entry_id:265975)组合可能会导致所谓的**[棋盘格压力](@entry_id:164851)模式 (checkerboard pressure mode)** 失稳。在这种模式下，压[力场](@entry_id:147325)呈现为 $p_{i,j} = (-1)^{i+j}$ 的高频[振荡](@entry_id:267781)。一个“天真”的[离散拉普拉斯算子](@entry_id:634690)（由在[同位网格](@entry_id:175200)上简单组合的中心差分构成）作用于此模式会得到零 。这意味着压[力场](@entry_id:147325)中的这种非物理[振荡](@entry_id:267781)不会受到散度约束的抑制，从而可以无限制地增长，污染整个数值解。

**MAC (Marker-and-Cell) [交错网格](@entry_id:147661) (staggered grid)** 通过将不同的物理量存储在网格的不同位置，从根本上解决了这个问题。如前文所述，压力 $p$ 存储在单元中心，而速度分量 $u$ 和 $v$ 分别存储在与之交错的面上。在这种安排下，离散的[散度算子](@entry_id:265975)在单元中心 $(i,j)$ 计算为：
$$
(\nabla_d \cdot \mathbf{u})_{i,j} = \frac{u_{i+1/2, j} - u_{i-1/2, j}}{\Delta x} + \frac{v_{i, j+1/2} - v_{i, j-1/2}}{\Delta y}
$$
而离散的[压力梯度](@entry_id:274112)则在面上计算，例如：
$$
(\nabla_d p)_{i+1/2, j} = \frac{p_{i+1, j} - p_{i, j}}{\Delta x}
$$
由这种交错的散度和[梯度算子](@entry_id:275922)复合而成的[离散拉普拉斯算子](@entry_id:634690)，正是标准的[五点模板](@entry_id:174268)。该算子作用于[棋盘格压力](@entry_id:164851)模式会得到一个非零结果，表明压力和[速度场](@entry_id:271461)之间存在正确的耦合，从而有效地抑制了棋盘格失稳。作为替代方案，在[同位网格](@entry_id:175200)上，可以使用 **Rhie-Chow 插值** 等技术来修正面的速度，以达到类似的效果。

#### 离散守恒律

许多物理系统都遵循[守恒定律](@entry_id:269268)，如质量守恒、[动量守恒](@entry_id:149964)和[能量守恒](@entry_id:140514)。设计能够在其离散形式下同样满足这些守恒律的数值格式是至关重要的，尤其对于需要进行长时间积分的模拟。

考虑一维线性平流方程，可以将其写成一种特殊的**斜对称形式**：
$$
u_t + \frac{1}{2}\big(a(x)\, D u + D(a(x) u)\big) = 0
$$
其中 $D$ 是一个离散的[一阶导数](@entry_id:749425)算子。如果 $D$ 是一个[斜对称矩阵](@entry_id:155998)（$D^T = -D$），例如在周期性边界条件下使用中心差分所得到的矩阵，并且 $a(x)$ 是一个常数，那么整个空间算子 $L = -\frac{1}{2}(AD + DA)$ 也是斜对称的。

一个斜对称的算子 $L$ 有一个关键性质：它能守恒离散的 $L^2$ 能量 $E_h = \frac{h}{2} \sum U_i^2$。能量的时间导数为：
$$
\frac{d E_h}{dt} = \frac{h}{2} U^T (L^T + L) U
$$
当 $L$ 是斜对称的（$L^T = -L$）时，此导数为零。即使使用像 Crank-Nicolson 这样本身就保能量的[时间积分方法](@entry_id:136323)，如果空间离散算子 $L$ 由于边界处理不当（例如，在[非周期性](@entry_id:275873)边界上使用非对称的单边差分）而不再是斜对称的，那么离散能量将不再守恒，会导致**[能量漂移](@entry_id:748982) (energy drift)**。这突显了在设计数值格式时，不仅要考虑局部精度，还必须关注其是否保留了原方程重要的全局结构和守恒性质。