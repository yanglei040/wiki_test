{
    "hands_on_practices": [
        {
            "introduction": "本练习将带你深入了解SOR方法在实际计算中的具体细节。通过推导单次SOR扫描的浮点运算（FLOP）次数，你将对该方法的计算成本有一个具体的认识，这对于性能分析至关重要。此外，通过比较SOR的原地更新（in-place）数据访问模式与Jacobi方法的分离更新（out-of-place）模式，你将能更好地理解内存效率和并行性之间的基本权衡。 ",
            "id": "3451653",
            "problem": "考虑一个稀疏线性系统 $A x = b$，该系统由结构化网格上的线性椭圆偏微分方程经有限差分法离散化得到。其中 $A \\in \\mathbb{R}^{n \\times n}$ 是一个实对称正定矩阵，并以压缩稀疏行 (CSR) 格式存储。令 $m = \\operatorname{nnz}(A)$ 表示 $A$ 中非零元的数量。假设采用松弛因子为 $\\omega \\in (0,2)$ 的逐次超松弛 (SOR) 方法进行原位（in-place）计算，这意味着每个分量 $x_{i}$ 一经更新便会立即被覆写。使用标准分裂 $A = D + L + U$，其中 $D$ 是对角部分，$L$ 是严格下三角部分，$U$ 是严格上三角部分。\n\n您可以假设以下实现模型：\n- 在一次前向 SOR 扫描中，更新 $x_{i}$ 时会使用第 $i$ 行中所有非对角项的贡献之和，该和通过点积 $s_{i} = \\sum_{j \\neq i} a_{ij} x_{j}$ 计算。按照约定，$x_{j}$ 使用的是最新可用的值（即对于 $j  i$ 使用新值，对于 $j  i$ 使用旧值）。\n- 新值通过公式 $x_{i}^{\\text{new}} = (1 - \\omega) x_{i}^{\\text{old}} + \\alpha_{i} \\left( b_{i} - s_{i} \\right)$ 计算，其中 $\\alpha_{i} = \\omega / a_{ii}$。\n- 对角元素的倒数 $a_{ii}^{-1}$ 和缩放后的对角系数 $\\alpha_{i}$ 在迭代开始前已预先计算好，每次迭代中可直接使用而无额外开销。\n\n请遵循以下浮点运算（flop）计数约定：\n- 仅计算浮点加法和乘法。由于 $\\alpha_{i}$ 已被预先计算，除法不计入其中。\n- 在累加 $s_{i}$ 时，每个非对角非零元 $a_{ij}$ 贡献一次乘法和一次加法，两者都需计数。\n- 计算 $b_{i} - s_{i}$ 以及合并 $x_{i}^{\\text{new}} = (1 - \\omega) x_{i}^{\\text{old}} + \\alpha_{i} \\left( b_{i} - s_{i} \\right)$ 中两项的操作，都应明确计为加法/乘法浮点运算。\n\n任务：\n1. 基于上述假设，从第一性原理出发，推导单次前向 SOR 扫描所需的精确浮点运算次数，并用 $m$ 和 $n$ 表示。\n2. 解释为何一次后向扫描会产生相同的浮点运算次数，并据此得出包含一次前向和一次后向扫描的对称 SOR (SSOR) 迭代的单次迭代成本。\n3. 结合 SOR 更新的定义和 CSR 存储模型，讨论 SOR/SSOR 中的原位更新与雅可比（Jacobi）迭代相比，如何影响数据访问模式。雅可比迭代使用两个独立的向量 $x^{(k)}$ 和 $x^{(k+1)}$，因此其更新是“非原位”（out-of-place）的。\n\n请将您的最终答案表示为单个闭式解析表达式，该表达式仅用 $m$ 和 $n$ 给出单次前向 SOR 扫描的每次迭代总浮点运算成本。无需四舍五入，也无物理单位。讨论部分是为了证明推导过程，但不会影响最终要求的数值表达式。",
            "solution": "该问题定义明确，具有科学依据，并为严谨的分析提供了一套清晰的假设和定义。我们开始进行推导。\n\n主要任务是确定逐次超松弛 (SOR) 方法完成一次完整的前向扫描所需的浮点运算（flops）精确次数，其中浮点运算定义为加法和乘法。\n\n设线性系统为 $A x = b$，其中 $A \\in \\mathbb{R}^{n \\times n}$ 是一个实对称正定矩阵，拥有 $m = \\operatorname{nnz}(A)$ 个非零元。该矩阵以压缩稀疏行 (CSR) 格式存储。SOR 方法根据给定公式对解向量 $x$ 的每个分量 $x_i$ (其中 $i=1, 2, \\dots, n$) 进行更新：\n$$x_{i}^{\\text{new}} = (1 - \\omega) x_{i}^{\\text{old}} + \\alpha_{i} \\left( b_{i} - s_{i} \\right)$$\n其中 $\\omega \\in (0,2)$ 是松弛因子，$\\alpha_{i} = \\omega / a_{ii}$，且 $s_{i} = \\sum_{j \\neq i} a_{ij} x_{j}$。求和 $s_i$ 使用了 $x_j$ 的最新更新值，即对 $j  i$ 使用 $x_j^{\\text{new}}$，对 $j  i$ 使用 $x_j^{\\text{old}}$。\n\n我们将确定更新单个分量 $x_i$ 的浮点运算次数，然后对所有 $n$ 个分量求和，以得出完整扫描的总次数。\n\n**1. 单次前向 SOR 扫描的浮点运算次数**\n\n我们来分析更新单个分量 $x_i$ 的计算成本。根据公式，计算过程分为两个主要阶段。\n\n**阶段 1：计算非对角项之和 $s_i$。**\n该和由 $s_{i} = \\sum_{j \\neq i} a_{ij} x_{j}$ 给出。令 $k_i$ 为矩阵 $A$ 第 $i$ 行中非对角非零元的数量。则第 $i$ 行的非零元总数为 $k_i + 1$（包括对角元 $a_{ii}$）。\n根据问题的浮点运算计数约定，“每个非对角非零元 $a_{ij}$ 贡献一次乘法和一次加法”。因此，计算 $s_i$ 需要：\n- $k_i$ 次乘法（用于每个 $a_{ij} x_j$ 项）。\n- $k_i$ 次加法（用于累加这些项，假设和的初值为 0）。\n因此，计算 $s_i$ 的成本为 $k_i$ 次乘法和 $k_i$ 次加法。\n\n**阶段 2：计算最终值 $x_i^{\\text{new}}$。**\n更新公式为 $x_{i}^{\\text{new}} = (1 - \\omega) x_{i}^{\\text{old}} + \\alpha_{i} ( b_{i} - s_{i} )$。我们按顺序计算操作次数：\n- 减法：$b_i - s_i$。这是 1 次加法浮点运算。\n- 乘法：$\\alpha_i \\times (b_i - s_i)$。参数 $\\alpha_i$ 是预先计算的，所以这是 1 次乘法浮点运算。\n- 乘法：$(1 - \\omega) \\times x_i^{\\text{old}}$。项 $(1 - \\omega)$ 在整个迭代过程中是常数，可以在扫描开始前预计算。这是 1 次乘法浮点运算。\n- 加法：将两项 $(1 - \\omega) x_i^{\\text{old}}$ 和 $\\alpha_i ( b_i - s_i )$ 相加。这是 1 次加法浮点运算。\n\n总计，阶段 2 对每个分量 $x_i$ 需要 $1+1=2$ 次乘法和 $1+1=2$ 次加法。\n\n**每个分量 $x_i$ 的总成本：**\n结合两个阶段，更新 $x_i$ 的总浮点运算次数为：\n- 总乘法次数：$k_i (\\text{来自 } s_i) + 2 (\\text{来自更新}) = k_i + 2$。\n- 总加法次数：$k_i (\\text{来自 } s_i) + 2 (\\text{来自更新}) = k_i + 2$。\n因此，更新 $x_i$ 的总浮点运算次数为 $(k_i+2) + (k_i+2) = 2(k_i+2)$。\n\n**一次完整前向扫描的总成本：**\n为求得一次完整前向扫描（对 $i=1, \\dots, n$）的总成本，我们将每个分量的成本相加：\n- 总乘法次数 = $\\sum_{i=1}^{n} (k_i + 2) = \\left(\\sum_{i=1}^{n} k_i\\right) + \\left(\\sum_{i=1}^{n} 2\\right)$。\n- 总加法次数 = $\\sum_{i=1}^{n} (k_i + 2) = \\left(\\sum_{i=1}^{n} k_i\\right) + \\left(\\sum_{i=1}^{n} 2\\right)$。\n\n项 $\\sum_{i=1}^{n} k_i$ 表示所有行中非对角非零元的数量之和。这正是矩阵 $A$ 中非对角非零元的总数。已知非零元总数为 $m = \\operatorname{nnz}(A)$，且矩阵有 $n$ 个对角元（因为 $A$ 来自 PDE 离散化，所以 $a_{ii} \\neq 0$），那么非对角非零元的总数就是 $m-n$。\n因此，$\\sum_{i=1}^{n} k_i = m - n$。\n\n项 $\\sum_{i=1}^{n} 2$ 就是 $2n$。\n\n将这些结果代回：\n- 总乘法次数 = $(m - n) + 2n = m + n$。\n- 总加法次数 = $(m - n) + 2n = m + n$。\n因此，单次前向 SOR 扫描的总浮点运算次数是总乘法次数和总加法次数之和：\n- 总浮点运算次数 = $(m+n) + (m+n) = 2(m+n)$。\n\n**2. 后向扫描和对称 SOR (SSOR) 的成本**\n\n一次后向 SOR 扫描执行相同的计算，但顺序为 $i=n, n-1, \\dots, 1$。更新每个 $x_i$ 的公式是相同的。虽然在求和 $s_i$ 中使用的 $x_j$ 值不同（此时新计算的值是针对 $ji$ 的），但更新单个分量 $x_i$ 的算术运算*数量*仍然是 $2(k_i+2)$。因此，一次完整后向扫描的总浮点运算次数与前向扫描相同，即 $2(m+n)$。\n\n对称 SOR (SSOR) 方法的单次迭代包括一次完整的前向扫描和一次完整的后向扫描。因此，SSOR 的单次迭代总浮点运算成本是两次扫描成本之和：\n- SSOR 浮点运算成本 = (前向扫描成本) + (后向扫描成本) = $2(m+n) + 2(m+n) = 4(m+n)$。\n\n**3. 数据访问模式：原位 SOR/SSOR vs. 非原位雅可比**\n\n选择原位更新方案（如 SOR）还是非原位方案（如雅可比）对数据访问模式和可并行性有重大影响。\n\n**SOR/SSOR（原位）：**\n- $x_i^{(k+1)}$ 的更新依赖于同一次迭代中的值（在前向扫描中，对于 $ji$ 是 $x_j^{(k+1)}$，对于 $ji$ 是 $x_j^{(k)}$）。这种数据依赖性是顺序的，使得直接并行化 SOR/SSOR 变得困难。一个分量的更新必须等待其前面所有分量的更新完成。\n- 内存效率高：只需要一个向量来存储解。更新是“原位”的，新值会覆盖旧值。\n\n**雅可比（非原位）：**\n- $x_i^{(k+1)}$ 的更新仅依赖于上一次迭代的值 $x^{(k)}$。这意味着所有分量的更新可以独立进行，互不干扰。这使得雅可比方法天然具有高度并行性。\n- 内存效率低：需要两个独立的向量来存储旧解 $x^{(k)}$ 和新解 $x^{(k+1)}$。更新是“非原位”的，计算新向量时需要读取整个旧向量。\n\n总而言之，SOR/SSOR 节省了内存，但其固有的顺序数据依赖限制了并行性，而雅可比则需要更多内存，但提供了极好的并行机会。",
            "answer": "$$\n\\boxed{2(m+n)}\n$$"
        },
        {
            "introduction": "上一个练习关注的是计算成本，而本练习则深入探讨了SOR方法的收敛行为。通过分析带有周期性边界条件的一维泊松方程——这是一个能够进行精确谱分析的特殊情况——你将推导出SOR迭代矩阵的精确特征值。这项分析为你提供了一个难得的清晰视角，让你能够观察到松弛因子$\\omega$是如何直接影响方法收敛速度的。 ",
            "id": "3451637",
            "problem": "考虑在单位区间上具有周期性边界条件的一维泊松方程，该方程在一个包含 $n \\geq 4$ 个点的均匀网格上进行离散化。使用标准三点差分格式，离散周期拉普拉斯算子产生线性系统 $A u = f$，其中 $A \\in \\mathbb{R}^{n \\times n}$ 是一个循环矩阵，其对角线上的元素为 $2$，第一条次对角线和超对角线上的元素为 $-1$，并且两个角位置的元素为 $-1$。令 $P \\in \\mathbb{R}^{n \\times n}$ 表示循环下移置换矩阵，定义为 $(P x)_{i} = x_{i-1}$（索引模 $n$），因此 $A = 2 I - P - P^{\\top}$。\n\n通过分裂 $A = D - L - U$（其中 $D = 2 I$，$L = P$，$U = P^{\\top}$）来定义逐次超松弛 (SOR) 迭代矩阵：\n$$\nT_{\\mathrm{SOR}}(\\omega) \\;=\\; (D - \\omega L)^{-1}\\big((1 - \\omega) D + \\omega U\\big),\n$$\n其中松弛参数 $\\omega \\in (0,2)$。\n\n1. 从循环矩阵和离散傅里叶变换 (DFT) 的性质出发，推导该周期性问题中 $T_{\\mathrm{SOR}}(\\omega)$ 的精确特征向量和特征值。明确写出由离散傅里叶模式索引的特征对。\n\n2. 常数向量是与特征值 $0$ 相关联的 $A$ 的一个特征向量，因此 $T_{\\mathrm{SOR}}(\\omega)$ 在此模式上具有特征值 $1$。因此，定义有效谱半径 $\\rho_{\\perp}(T_{\\mathrm{SOR}})$ 为 $T_{\\mathrm{SOR}}(\\omega)$ 在与常数向量正交的子空间（即，排除零频傅里叶模式后）上的谱半径。使用你的特征值公式，得到一个关于 $n$ 和 $\\omega$ 的 $\\rho_{\\perp}(T_{\\mathrm{SOR}})$ 的闭式表达式。\n\n3. 最后，计算当 $n = 64$ 和 $\\omega = 1.5$ 时 $\\rho_{\\perp}(T_{\\mathrm{SOR}})$ 的值，并将你的答案四舍五入到四位有效数字。如果在中间步骤中出现角度，必须以弧度处理。你的最终答案必须是一个不带单位的实数。",
            "solution": "首先根据指定标准对问题进行验证。\n\n**问题验证**\n\n1.  **提取已知条件**：\n    -   系统：一维泊松方程，周期性边界条件，单位区间，包含 $n \\geq 4$ 个点的均匀网格。\n    -   线性系统：$A u = f$。\n    -   矩阵 $A$：$A \\in \\mathbb{R}^{n \\times n}$ 是一个循环矩阵，其对角线元素为 $2$，第一条次对角线/超对角线元素为 $-1$，角位置元素为 $-1$。\n    -   矩阵表示：$A = 2 I - P - P^{\\top}$，其中 $P$ 是循环下移置换矩阵。\n    -   SOR 分裂：$A = D - L - U$，其中 $D = 2 I$，$L = P$，$U = P^{\\top}$。\n    -   SOR 迭代矩阵：$T_{\\mathrm{SOR}}(\\omega) = (D - \\omega L)^{-1}\\big((1 - \\omega) D + \\omega U\\big)$，其中 $\\omega \\in (0,2)$。\n    -   任务1：推导 $T_{\\mathrm{SOR}}(\\omega)$ 的特征向量和特征值。\n    -   任务2：推导有效谱半径 $\\rho_{\\perp}(T_{\\mathrm{SOR}})$ 的闭式表达式，该半径排除了零频模式。\n    -   任务3：计算当 $n = 64$ 和 $\\omega = 1.5$ 时 $\\rho_{\\perp}(T_{\\mathrm{SOR}})$ 的值，保留四位有效数字。\n\n2.  **验证**：该问题在数值线性代数领域有坚实的科学基础。所有术语都是标准且定义明确的。离散周期拉普拉斯算子是循环矩阵这一前提是正确的。$A$ 的结构、SOR 分裂以及迭代矩阵的定义都是标准的。问题是自洽的、一致的且适定的。各项任务逻辑上层层递进。因此，该问题被认定为有效。\n\n**解答**\n\n**1. $T_{\\mathrm{SOR}}(\\omega)$ 的特征向量和特征值**\n\n矩阵 $A$ 是一个 $n \\times n$ 的循环矩阵。任何 $n \\times n$ 循环矩阵都可以通过离散傅里叶变换 (DFT) 进行对角化。所有 $n \\times n$ 循环矩阵的特征向量都是相同的，由向量 $v_k$ 给出（$k = 0, 1, \\dots, n-1$），其分量为：\n$$\n(v_k)_j = \\frac{1}{\\sqrt{n}} \\exp\\left(\\frac{2 \\pi i (j-1)k}{n}\\right), \\quad j = 1, \\dots, n\n$$\nSOR 分裂中的矩阵 $D = 2I$、$L = P$ 和 $U = P^{\\top}$ 也都是循环矩阵。因此，它们共享相同的特征向量 $v_k$。我们来求它们对应的特征值。\n\n令 $\\lambda_M(k)$ 表示矩阵 $M$ 对应于特征向量 $v_k$ 的特征值。\n-   对于 $D=2I$，特征值为 $\\lambda_D(k) = 2$ 对所有 $k$ 成立。\n-   对于 $L=P$，循环下移矩阵，作用于 $v_k$：\n    $(P v_k)_j = (v_k)_{j-1} = \\frac{1}{\\sqrt{n}} \\exp\\left(\\frac{2 \\pi i (j-2)k}{n}\\right) = \\exp\\left(-\\frac{2 \\pi i k}{n}\\right) (v_k)_j$。\n    所以，特征值为 $\\lambda_L(k) = \\exp\\left(-\\frac{2 \\pi i k}{n}\\right)$。\n-   对于 $U=P^{\\top}$，它是 $P$ 的逆矩阵，其特征值是 $P$ 的特征值的倒数。\n    特征值为 $\\lambda_U(k) = (\\lambda_L(k))^{-1} = \\exp\\left(\\frac{2 \\pi i k}{n}\\right)$。\n\n$T_{\\mathrm{SOR}}(\\omega)$ 的特征值方程是 $T_{\\mathrm{SOR}}(\\omega) v_k = \\lambda_k(\\omega) v_k$。代入 $T_{\\mathrm{SOR}}(\\omega)$ 的定义：\n$$\n(D - \\omega L)^{-1}\\big((1 - \\omega) D + \\omega U\\big) v_k = \\lambda_k(\\omega) v_k\n$$\n将等式两边作用于 $v_k$，并将矩阵替换为它们对应模式 $k$ 的特征值：\n$$\n\\big( \\lambda_D(k) - \\omega \\lambda_L(k) \\big)^{-1} \\big( (1-\\omega)\\lambda_D(k) + \\omega \\lambda_U(k) \\big) = \\lambda_k(\\omega)\n$$\n代入特征值：\n$$\n\\lambda_k(\\omega) = \\frac{(1-\\omega) \\cdot 2 + \\omega \\exp\\left(\\frac{2 \\pi i k}{n}\\right)}{2 - \\omega \\exp\\left(-\\frac{2 \\pi i k}{n}\\right)}\n$$\n这就给出了 $T_{\\mathrm{SOR}}(\\omega)$ 对于 $k=0, 1, \\dots, n-1$ 的特征值。相应的特征向量是 DFT 向量 $v_k$。\n\n**2. 有效谱半径 $\\rho_{\\perp}(T_{\\mathrm{SOR}})$**\n\n首先，考虑零频模式 $k=0$。特征向量 $v_0$ 是一个常数向量。对应的特征值为：\n$$\n\\lambda_0(\\omega) = \\frac{2(1-\\omega) + \\omega \\exp(0)}{2 - \\omega \\exp(0)} = \\frac{2-2\\omega+\\omega}{2-\\omega} = \\frac{2-\\omega}{2-\\omega} = 1\n$$\n特征值 $1$ 表明迭代在 $A$ 的零空间上不收敛。有效谱半径 $\\rho_{\\perp}(T_{\\mathrm{SOR}})$ 是所有其他模式（$k=1, \\dots, n-1$）的特征值模的最大值。\n$$\n\\rho_{\\perp}(T_{\\mathrm{SOR}}) = \\max_{k \\in \\{1, \\dots, n-1\\}} |\\lambda_k(\\omega)|\n$$\n令 $\\theta_k = \\frac{2\\pi k}{n}$。特征值 $\\lambda_k(\\omega)$ 的模的平方为：\n$$\n|\\lambda_k(\\omega)|^2 = \\left| \\frac{2(1-\\omega) + \\omega \\exp(i\\theta_k)}{2 - \\omega \\exp(-i\\theta_k)} \\right|^2 = \\frac{|2(1-\\omega) + \\omega \\exp(i\\theta_k)|^2}{|2 - \\omega \\exp(-i\\theta_k)|^2}\n$$\n分子的模的平方为：\n$$\n|2(1-\\omega) + \\omega(\\cos\\theta_k + i\\sin\\theta_k)|^2 = (2-2\\omega+\\omega\\cos\\theta_k)^2 + (\\omega\\sin\\theta_k)^2\n= 4(1-\\omega)^2 + 4\\omega(1-\\omega)\\cos\\theta_k + \\omega^2 = 4-8\\omega+5\\omega^2 + 4\\omega(1-\\omega)\\cos\\theta_k\n$$\n分母的模的平方为：\n$$\n|2 - \\omega(\\cos\\theta_k - i\\sin\\theta_k)|^2 = (2-\\omega\\cos\\theta_k)^2 + (\\omega\\sin\\theta_k)^2 = 4 - 4\\omega\\cos\\theta_k + \\omega^2\n$$\n所以，模的平方为：\n$$\n|\\lambda_k(\\omega)|^2 = \\frac{4-8\\omega+5\\omega^2 + 4\\omega(1-\\omega)\\cos\\theta_k}{4+\\omega^2-4\\omega\\cos\\theta_k}\n$$\n令 $x = \\cos\\theta_k$。我们分析函数 $g(x) = \\frac{a+bx}{c-dx}$，其中 $a=4-8\\omega+5\\omega^2$，$b=4\\omega(1-\\omega)$，$c=4+\\omega^2$，$d=4\\omega$。为了找到 $g(x)$ 的最大值，我们检查其导数：\n$$\ng'(x) = \\frac{b(c-dx) - (a+bx)(-d)}{(c-dx)^2} = \\frac{bc+ad}{(c-dx)^2}\n$$\n$g'(x)$ 的符号由 $bc+ad$ 决定：\n$$\nbc+ad = 4\\omega(1-\\omega)(4+\\omega^2) + (4-8\\omega+5\\omega^2)(4\\omega) = 4\\omega \\left[ (1-\\omega)(4+\\omega^2) + (4-8\\omega+5\\omega^2) \\right]\n$$\n$$\n= 4\\omega [4+\\omega^2-4\\omega-\\omega^3 + 4-8\\omega+5\\omega^2] = 4\\omega [8 - 12\\omega + 6\\omega^2 - \\omega^3] = 4\\omega(2-\\omega)^3\n$$\n对于 $\\omega \\in (0,2)$， $4\\omega$ 和 $(2-\\omega)^3$ 均为正，因此 $g'(x)0$。函数 $g(x)$ 是关于 $x=\\cos\\theta_k$ 单调递增的。因此，$|\\lambda_k(\\omega)|^2$ 的最大值在 $k \\in \\{1, \\dots, n-1\\}$ 范围内 $\\cos\\theta_k$ 取最大值时出现。这发生在 $k=1$（以及 $k=n-1$）时，给出 $x_{max} = \\cos(2\\pi/n)$。\n\n因此，有效谱半径为 $|\\lambda_1(\\omega)|$：\n$$\n\\rho_{\\perp}(T_{\\mathrm{SOR}}) = \\sqrt{\\frac{4-8\\omega+5\\omega^2 + 4\\omega(1-\\omega)\\cos\\left(\\frac{2\\pi}{n}\\right)}{4+\\omega^2-4\\omega\\cos\\left(\\frac{2\\pi}{n}\\right)}}\n$$\n\n**3. 对于 $n=64$ 和 $\\omega=1.5$ 的计算**\n\n我们将 $n=64$ 和 $\\omega=1.5$ 代入推导出的 $\\rho_{\\perp}(T_{\\mathrm{SOR}})$ 表达式中。\n角度项为 $\\cos\\left(\\frac{2\\pi}{64}\\right) = \\cos\\left(\\frac{\\pi}{32}\\right)$。\n首先，计算 $\\omega=1.5$ 时的系数：\n-   $4-8\\omega+5\\omega^2 = 4-8(1.5)+5(1.5)^2 = 4-12+5(2.25) = -8+11.25 = 3.25$。\n-   $4\\omega(1-\\omega) = 4(1.5)(1-1.5) = 6(-0.5) = -3$。\n-   $4+\\omega^2 = 4+(1.5)^2 = 4+2.25 = 6.25$。\n-   $4\\omega = 4(1.5) = 6$。\n\n将这些值代入谱半径平方的公式中：\n$$\n\\rho_{\\perp}^2 = \\frac{3.25 - 3\\cos\\left(\\frac{\\pi}{32}\\right)}{6.25 - 6\\cos\\left(\\frac{\\pi}{32}\\right)}\n$$\n现在，我们计算数值。角度以弧度为单位。\n$$\n\\cos\\left(\\frac{\\pi}{32}\\right) \\approx 0.9951847267\n$$\n代入此值：\n$$\n\\rho_{\\perp}^2 \\approx \\frac{3.25 - 3(0.9951847267)}{6.25 - 6(0.9951847267)} = \\frac{3.25 - 2.9855541801}{6.25 - 5.9711083602} = \\frac{0.2644458199}{0.2788916398} \\approx 0.94820128\n$$\n取平方根：\n$$\n\\rho_{\\perp} \\approx \\sqrt{0.94820128} \\approx 0.97375626\n$$\n四舍五入到四位有效数字，我们得到 $0.9738$。",
            "answer": "$$\n\\boxed{0.9738}\n$$"
        },
        {
            "introduction": "这最后一个练习将松弛法与更广泛的多项式逼近理论联系起来，从而提升我们对这一主题的理解。通过将误差缩减过程看作是应用一个松弛多项式，我们可以利用切比雪夫多项式等强大工具来设计最优的多步迭代格式。本练习将展示从简单的单步松弛法转向更复杂的多项式优化方法所能带来的显著性能提升，并为你学习更高级的迭代法架起一座桥梁。 ",
            "id": "3451592",
            "problem": "考虑在区间 $(0,1)$ 上的泊松方程 $-u''(x) = f(x)$ 的边值问题，其边界条件为齐次狄利克雷边界条件 $u(0) = 0$ 和 $u(1) = 0$。使用具有 $N$ 个内部网格点的标准二阶中心有限差分格式，可得到一个对称正定 (SPD) 线性系统 $A u = b$。对于足够大的 $N$，矩阵 $A$ 的谱包含在一个闭区间 $[\\alpha,\\beta]$ 内，其中 $0  \\alpha  \\beta$，且该区间被假定为先验已知的。\n\n在误差传播的意义上，对称逐次超松弛 (SSOR) 方法的一次前向-后向扫描可以抽象为将一个关于 $A$ 的对称两步松弛多项式应用于当前误差。受此观点启发，考虑以下两种减小误差的策略：\n\n1. 一种两步对称松弛方法，其特征是将在误差上施加一个二次多项式 $p_{2}(\\lambda)$，其中 $\\lambda$ 表示谱区间 $[\\alpha,\\beta]$ 内的一个特征值。该多项式必须满足 $p_{2}(0) = 1$ 以确保迭代的一致性。利用切比雪夫半迭代理论，构建一个二次松弛多项式，使其在谱区间上的最坏情况误差放大最小化，即在约束条件 $p_{2}(0) = 1$ 下，最小化 $\\max_{\\lambda \\in [\\alpha,\\beta]} |p_{2}(\\lambda)|$。\n\n2. 一种单步松弛方法，它在单次线性松弛的意义上模拟了最优逐次超松弛 (SOR) 方法，其形式为 $p_{1}(\\lambda) = 1 - \\tau \\lambda$，其中选择标量 $\\tau$ 以最小化最坏情况误差放大 $\\max_{\\lambda \\in [\\alpha,\\beta]} |1 - \\tau \\lambda|$。\n\n从切比雪夫多项式的基本性质和区间上最优标量松弛的极小极大刻画出发，推导两种策略在 $[\\alpha,\\beta]$ 上的最优最坏情况放大因子，然后计算精确比值\n$$\nR(\\alpha,\\beta) = \\frac{\\displaystyle \\min_{p_{2}} \\max_{\\lambda \\in [\\alpha,\\beta]} |p_{2}(\\lambda)|}{\\displaystyle \\min_{\\tau} \\max_{\\lambda \\in [\\alpha,\\beta]} |1 - \\tau \\lambda|}.\n$$\n将您的最终答案表示为关于 $\\alpha$ 和 $\\beta$ 的单个闭式解析表达式。无需进行数值舍入。",
            "solution": "本题要求出两步对称松弛方法和单步线性松弛方法的最优最坏情况误差放大因子之比，这两种方法用于求解一个线性系统，其系数矩阵 $A$ 的谱包含在区间 $[\\alpha, \\beta]$ 内，其中 $0  \\alpha  \\beta$。\n\n我们分别分析这两种策略。\n\n### 策略 2：单步松弛（分母）\n\n单步松弛方法对应于一个一次误差传播多项式 $p_1(\\lambda) = 1 - \\tau\\lambda$。目标是找到松弛参数 $\\tau$ 的值，以最小化 $p_1(\\lambda)$ 在谱区间 $[\\alpha, \\beta]$ 上的最大绝对值。我们需要解决以下极小极大问题：\n$$\n\\min_{\\tau} \\max_{\\lambda \\in [\\alpha,\\beta]} |p_{1}(\\lambda)| = \\min_{\\tau} \\max_{\\lambda \\in [\\alpha,\\beta]} |1 - \\tau \\lambda|\n$$\n函数 $p_1(\\lambda)$ 是 $\\lambda$ 的线性函数。对于固定的 $\\tau$， $|p_1(\\lambda)|$ 在区间 $[\\alpha, \\beta]$ 上的最大值必然在端点 $\\lambda = \\alpha$ 或 $\\lambda = \\beta$ 处取得。因此，我们希望最小化 $\\max(|1-\\tau\\alpha|, |1-\\tau\\beta|)$。\n\n当端点处的幅值相等时，该最大值达到其最小值（等振荡原理）：\n$$\n|1 - \\tau \\alpha| = |1 - \\tau \\beta|\n$$\n这意味着要么 $1 - \\tau \\alpha = 1 - \\tau \\beta$，这给出 $\\tau(\\beta-\\alpha) = 0$，因此 $\\tau=0$（因为 $\\beta \\neq \\alpha$），导致一个非最优的放大因子 1。最优解来自另一种情况：\n$$\n1 - \\tau \\alpha = -(1 - \\tau \\beta) = -1 + \\tau \\beta\n$$\n求解 $\\tau$：\n$$\n2 = \\tau \\alpha + \\tau \\beta = \\tau(\\alpha + \\beta)\n$$\n最优松弛参数为 $\\tau_{opt} = \\frac{2}{\\alpha + \\beta}$。\n\n使用这个最优 $\\tau$，端点处的误差放大因子为：\n$$\n|p_1(\\alpha)| = \\left|1 - \\frac{2\\alpha}{\\alpha + \\beta}\\right| = \\left|\\frac{\\alpha + \\beta - 2\\alpha}{\\alpha + \\beta}\\right| = \\left|\\frac{\\beta - \\alpha}{\\alpha + \\beta}\\right| = \\frac{\\beta - \\alpha}{\\alpha + \\beta}\n$$\n$$\n|p_1(\\beta)| = \\left|1 - \\frac{2\\beta}{\\alpha + \\beta}\\right| = \\left|\\frac{\\alpha + \\beta - 2\\beta}{\\alpha + \\beta}\\right| = \\left|\\frac{\\alpha - \\beta}{\\alpha + \\beta}\\right| = \\frac{\\beta - \\alpha}{\\alpha + \\beta}\n$$\n由于 $p_1(\\lambda)$ 是线性的，其在区间上的最大值确实就是这个值。因此，所求比值的分母为：\n$$\n\\min_{\\tau} \\max_{\\lambda \\in [\\alpha,\\beta]} |1 - \\tau \\lambda| = \\frac{\\beta - \\alpha}{\\alpha + \\beta}\n$$\n\n### 策略 1：两步对称松弛（分子）\n\n两步法对应于一个二次误差传播多项式 $p_2(\\lambda)$。一致性条件意味着对于特征值 0，迭代矩阵应为单位矩阵，即误差不变。这转化为约束条件 $p_2(0) = 1$。问题在于找到一个次数至多为 2 且满足 $p_2(0)=1$ 的多项式，使其在 $[\\alpha, \\beta]$ 上的最大绝对值尽可能小。这是逼近论中的一个经典问题，其解涉及到切比雪夫多项式。\n\n令 $T_n(x)$ 为 n 次第一类切比雪夫多项式。对于问题“寻找一个 n 次多项式 $p_n(x)$，在约束条件 $p_n(x_0)=1$（其中点 $x_0 \\notin [-1,1]$）下，最小化 $\\max_{x \\in [-1,1]}|p_n(x)|$”，其解由 $p_n(x) = \\frac{T_n(x)}{T_n(x_0)}$ 给出。该最大值的最小值为 $\\frac{1}{|T_n(x_0)|}$。\n\n首先，我们通过一个线性变换将谱区间 $[\\alpha, \\beta]$ 映射到标准区间 $[-1, 1]$：\n$$\nx = \\frac{2\\lambda - (\\alpha + \\beta)}{\\beta - \\alpha}\n$$\n约束条件在 $\\lambda = 0$ 处给出。我们必须在变换后的坐标系中找到对应的点 $x_0$：\n$$\nx_0 = \\frac{2(0) - (\\alpha + \\beta)}{\\beta - \\alpha} = -\\frac{\\alpha + \\beta}{\\beta - \\alpha}\n$$\n由于 $0  \\alpha  \\beta$，我们有 $\\alpha+\\beta  \\beta-\\alpha  0$，这意味着 $x_0  -1$。约束点位于区间 $[-1, 1]$ 之外，符合要求。\n\n现在问题变为找到一个 2 次多项式 $q_2(x)$，在约束条件 $q_2(x_0) = 1$ 下，最小化 $\\max_{x \\in [-1,1]}|q_2(x)|$。其解为 $q_2(x) = \\frac{T_2(x)}{T_2(x_0)}$，极小极大值为 $\\frac{1}{|T_2(x_0)|}$。\n\n我们使用 2 次切比雪夫多项式的公式：$T_2(x) = 2x^2 - 1$。现在，我们计算 $T_2(x_0)$：\n$$\nT_2(x_0) = 2x_0^2 - 1 = 2 \\left( -\\frac{\\alpha + \\beta}{\\beta - \\alpha} \\right)^2 - 1 = 2 \\frac{(\\alpha + \\beta)^2}{(\\beta - \\alpha)^2} - 1\n$$\n$$\nT_2(x_0) = \\frac{2(\\alpha + \\beta)^2 - (\\beta - \\alpha)^2}{(\\beta - \\alpha)^2} = \\frac{2(\\alpha^2 + 2\\alpha\\beta + \\beta^2) - (\\beta^2 - 2\\alpha\\beta + \\alpha^2)}{(\\beta - \\alpha)^2}\n$$\n$$\nT_2(x_0) = \\frac{(2\\alpha^2 - \\alpha^2) + (4\\alpha\\beta + 2\\alpha\\beta) + (2\\beta^2 - \\beta^2)}{(\\beta - \\alpha)^2} = \\frac{\\alpha^2 + 6\\alpha\\beta + \\beta^2}{(\\beta - \\alpha)^2}\n$$\n由于 $\\alpha, \\beta  0$，分子 $\\alpha^2 + 6\\alpha\\beta + \\beta^2$ 是正的。分母也是正的。因此，$T_2(x_0)  0$，且 $|T_2(x_0)| = T_2(x_0)$。\n\n两步方法的最优最坏情况放大因子是：\n$$\n\\min_{p_2, p_2(0)=1} \\max_{\\lambda \\in [\\alpha,\\beta]} |p_2(\\lambda)| = \\frac{1}{T_2(x_0)} = \\frac{(\\beta - \\alpha)^2}{\\alpha^2 + 6\\alpha\\beta + \\beta^2}\n$$\n\n### 比值 $R(\\alpha, \\beta)$\n\n最后，我们计算两步方法的放大因子与单步方法的放大因子之比：\n$$\nR(\\alpha, \\beta) = \\frac{\\displaystyle \\min_{p_{2}} \\max_{\\lambda \\in [\\alpha,\\beta]} |p_{2}(\\lambda)|}{\\displaystyle \\min_{\\tau} \\max_{\\lambda \\in [\\alpha,\\beta]} |1 - \\tau \\lambda|} = \\frac{\\frac{(\\beta - \\alpha)^2}{\\alpha^2 + 6\\alpha\\beta + \\beta^2}}{\\frac{\\beta - \\alpha}{\\alpha + \\beta}}\n$$\n我们可以化简这个表达式：\n$$\nR(\\alpha, \\beta) = \\frac{(\\beta - \\alpha)^2}{\\alpha^2 + 6\\alpha\\beta + \\beta^2} \\cdot \\frac{\\alpha + \\beta}{\\beta - \\alpha}\n$$\n假设 $\\beta \\neq \\alpha$，我们可以约去一个因子 $(\\beta - \\alpha)$：\n$$\nR(\\alpha, \\beta) = \\frac{(\\beta - \\alpha)(\\alpha + \\beta)}{\\alpha^2 + 6\\alpha\\beta + \\beta^2}\n$$\n分子是一个平方差，即 $\\beta^2 - \\alpha^2$。\n$$\nR(\\alpha, \\beta) = \\frac{\\beta^2 - \\alpha^2}{\\alpha^2 + 6\\alpha\\beta + \\beta^2}\n$$\n这就是用 $\\alpha$ 和 $\\beta$ 表示的比值的最终闭式表达式。",
            "answer": "$$\\boxed{\\frac{\\beta^2 - \\alpha^2}{\\alpha^2 + 6\\alpha\\beta + \\beta^2}}$$"
        }
    ]
}