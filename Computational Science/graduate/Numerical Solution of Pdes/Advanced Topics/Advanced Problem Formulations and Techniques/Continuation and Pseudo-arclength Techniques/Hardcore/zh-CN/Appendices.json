{
    "hands_on_practices": [
        {
            "introduction": "数值延拓的核心在于其预测-校正的迭代思想。本练习 () 将通过追踪一个单位圆这一直观的几何问题，帮助你理解该方法的工作原理。你将亲手分析一个延拓步，探究为何过大的步长会导致校正步骤失败，从而从根本上理解伪弧长延拓方法所要解决的核心困难。",
            "id": "3217738",
            "problem": "考虑由光滑映射 $F:\\mathbb{R}^2 \\to \\mathbb{R}$ 的零点集定义的非线性系统的解流形，其中 $F(x,y) = x^2 + y^2 - 1$。解集 $\\mathcal{M} = \\{(x,y)\\in \\mathbb{R}^2 : F(x,y) = 0\\}$ 是单位圆。一种基于伪弧长的标准预测-校正延拓方法使用以下几个组成部分。\n\n1) 在曲线上已知点处的切向量计算：设 $(x_0,y_0) = (1,0) \\in \\mathcal{M}$。在 $(x_0,y_0)$ 处的切方向 $t_0 \\in \\mathbb{R}^2$ 由条件 $t_0^\\top \\nabla F(x_0,y_0) = 0$ 和 $\\|t_0\\|_2 = 1$ 定义，其中 $\\nabla F$ 表示 $F$ 的梯度。\n\n2) 预测步：对于步长 $h > 0$，构建预测点 $z_{\\mathrm{p}} = (x_{\\mathrm{p}},y_{\\mathrm{p}}) = (x_0,y_0) + h\\, t_0$。\n\n3) 针对增广系统的 Newton 校正步：使用以 $z^{(0)} = z_{\\mathrm{p}}$ 为初值的 Newton 法求解关于 $z = (x,y)$ 的 $2\\times 2$ 系统\n$$\nH(z) = \\begin{bmatrix}\nF(x,y)\\\\\nt_0^\\top (z - z_{\\mathrm{p}})\n\\end{bmatrix} = \\begin{bmatrix}0\\\\0\\end{bmatrix},\n$$\n\n已知 $h = 1.2$。请仅使用 Newton 法、光滑曲线和局部线性化的核心定义与公认事实，分析此延拓步骤。特别地，判断在此情况下 Newton 校正步能否收敛并解释原因，并指出对于更小的 $h$，决定延拓成功的几何特征。\n\n选择所有正确的陈述。\n\nA) 对于 $h = 1.2$，增广系统 $H(z) = 0$ 无解，因为仿射约束 $t_0^\\top (z - z_{\\mathrm{p}}) = 0$ 定义了水平线 $y = y_{\\mathrm{p}} = h$，该直线与单位圆不相交。因此，Newton 校正步无法收敛。\n\nB) 存在 $\\delta > 0$，使得当 $0 < h < \\delta$ 时，以 $z_{\\mathrm{p}}$ 为初值应用于 $H(z) = 0$ 的 Newton 法会二次收敛到一个邻近的交点。从几何上看，对于较小的 $h$，超平面约束与曲线横截，并且预测点到曲线的法向距离与局部曲率乘以 $h^2$ 成比例，这使得预测点落在局部吸引盆内。\n\nC) 在 $h = 1.2$ 时的失败是因为 $\\nabla F(x_0,y_0)$ 是奇异的，因此对于任何步长，延拓都会失败。\n\nD) 保持 $h = 1.2$ 不变，但将正交超平面约束 $t_0^\\top (z - z_{\\mathrm{p}}) = 0$ 替换为垂直线约束 $x = 1$，可以保证 Newton 校正步的收敛，因为 $x = 1$ 与单位圆相交。",
            "solution": "**推导与分析**\n\n首先，我们根据所提供的数据确定延拓步骤的各个组成部分。\n\n1.  **梯度计算**：函数为 $F(x,y) = x^2 + y^2 - 1$。其梯度为 $\\nabla F(x,y) = \\begin{bmatrix} 2x \\\\ 2y \\end{bmatrix}$。在点 $(x_0,y_0) = (1,0)$ 处，梯度为 $\\nabla F(1,0) = \\begin{bmatrix} 2 \\\\ 0 \\end{bmatrix}$。该向量在 $(1,0)$ 处与单位圆垂直。\n\n2.  **切向量计算**：切向量 $t_0 = \\begin{bmatrix} t_x \\\\ t_y \\end{bmatrix}$ 必须满足 $t_0^\\top \\nabla F(x_0,y_0) = 0$。\n    $$\n    \\begin{bmatrix} t_x & t_y \\end{bmatrix} \\begin{bmatrix} 2 \\\\ 0 \\end{bmatrix} = 2t_x = 0\n    $$\n    这意味着 $t_x = 0$。第二个条件是归一化：$\\|t_0\\|_2 = 1$。\n    $$\n    \\sqrt{t_x^2 + t_y^2} = \\sqrt{0^2 + t_y^2} = |t_y| = 1\n    $$\n    我们选择 $t_y = 1$ 以进行逆时针遍历，因此，$t_0 = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}$。\n\n3.  **预测点**：步长 $h = 1.2$，预测点 $z_{\\mathrm{p}}$ 为：\n    $$\n    z_{\\mathrm{p}} = (x_{\\mathrm{p}},y_{\\mathrm{p}}) = (x_0,y_0) + h\\, t_0 = (1,0) + 1.2 \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix} = (1, 1.2)\n    $$\n\n4.  **校正系统**：Newton 校正步旨在为系统 $H(z)=0$ 找到一个根 $z = (x,y)$：\n    $$\n    H(z) = \\begin{bmatrix} F(x,y) \\\\ t_0^\\top (z - z_{\\mathrm{p}}) \\end{bmatrix} = \\begin{bmatrix} x^2+y^2-1 \\\\ \\begin{bmatrix} 0 & 1 \\end{bmatrix} \\begin{bmatrix} x - 1 \\\\ y - 1.2 \\end{bmatrix} \\end{bmatrix} = \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix}\n    $$\n    这两个方程是：\n    1.  $x^2 + y^2 - 1 = 0$（解必须在单位圆上）。\n    2.  $y - 1.2 = 0$，即 $y = 1.2$（解必须位于垂直于切向量 $t_0$ 并穿过预测点 $z_p$ 的超平面上）。\n\n5.  **解的存在性**：为了找到系统的解，我们将第二个方程代入第一个方程：\n    $$\n    x^2 + (1.2)^2 = 1 \\implies x^2 + 1.44 = 1 \\implies x^2 = -0.44\n    $$\n    该方程在实数 $\\mathbb{R}$ 中没有关于 $x$ 的解。因此，系统 $H(z)=0$ 无解。由于 Newton 法是用于寻找系统根（解）的算法，如果根不存在，它就无法收敛。\n\n有了这个分析，我们就可以评估每个选项了。\n\n**逐项分析**\n\n**A) 对于 $h = 1.2$，增广系统 $H(z) = 0$ 无解，因为仿射约束 $t_0^\\top (z - z_{\\mathrm{p}}) = 0$ 定义了水平线 $y = y_{\\mathrm{p}} = h$，该直线与单位圆不相交。因此，Newton 校正步无法收敛。**\n- 增广系统是 $x^2+y^2=1$ 和 $y=1.2$。如上所推导，该系统没有实数解。\n- 约束方程 $t_0^\\top (z-z_{\\mathrm{p}})=0$ 简化为 $y-1.2=0$，即 $y=1.2$。这是一条水平线。预测点是 $z_{\\mathrm{p}} = (1, 1.2)$，所以 $y_{\\mathrm{p}} = 1.2 = h$。\n- 直线 $y=1.2$ 与单位圆 $x^2+y^2=1$ 不相交，因为圆上 y 的最大值为 1。\n- 由于没有解，像 Newton 法这样的寻根方法无法收敛到解。\n- 这个陈述完全准确地描述了情况。\n结论：**正确**\n\n**B) 存在 $\\delta > 0$，使得当 $0 < h < \\delta$ 时，以 $z_{\\mathrm{p}}$ 为初值应用于 $H(z) = 0$ 的 Newton 法会二次收敛到一个邻近的交点。从几何上看，对于较小的 $h$，超平面约束与曲线横截，并且预测点到曲线的法向距离与局部曲率乘以 $h^2$ 成比例，这使得预测点落在局部吸引盆内。**\n- 该陈述描述了对于足够小的步长 $h$，延拓方法的成功运行。\n- 对于 $0 < h < 1$，待求解的系统是 $x^2+y^2=1$ 和 $y=h$。该系统有两个解，$(\\pm\\sqrt{1-h^2}, h)$。我们考虑靠近起始点的那个解，$z^* = (\\sqrt{1-h^2}, h)$。\n- 增广系统 $H(z) = \\begin{bmatrix} x^2+y^2-1 \\\\ y-h \\end{bmatrix}$ 的雅可比矩阵是 $J_H(z) = \\begin{bmatrix} 2x & 2y \\\\ 0 & 1 \\end{bmatrix}$。在解 $z^*$ 处，其行列式为 $2\\sqrt{1-h^2}$，对于 $h<1$ 是非零的。在根处的非奇异雅可比矩阵是 Newton 法二次收敛的关键条件。\n- 初始猜测是 $z_{\\mathrm{p}} = (1,h)$。到真实解 $z^*$ 的距离约为 $\\frac{1}{2}h^2$（对于小的 $h$）。根据 Newton 法的局部收敛理论，如果初始猜测足够接近雅可比矩阵非奇异的根，则该方法二次收敛。由于初始误差与 $h^2$ 成比例，我们总可以取足够小的 $h$（即存在一个 $\\delta>0$），将初始猜测 $z_{\\mathrm{p}}$ 置于 $z^*$ 的吸引盆内。\n- 几何描述也是正确的：对于小的 $h$，超平面 $y=h$ 在 $(1,0)$ 附近与圆横截（非切向）。\n- 该陈述准确地总结了预测-校正方法为何有效的理论基础。\n结论：**正确**\n\n**C) 在 $h = 1.2$ 时的失败是因为 $\\nabla F(x_0,y_0)$ 是奇异的，因此对于任何步长，延拓都会失败。**\n- 如前所计算，$\\nabla F(x_0,y_0) = \\begin{bmatrix} 2 \\\\ 0 \\end{bmatrix}$。这是一个非零向量。“奇异”的概念不适用于向量。点 $(1,0)$ 是流形的一个正则点。\n- 在 $h=1.2$ 时的失败是由于校正系统无解，如 A 中所解释。这不是由于起始点处 $\\nabla F$ 的任何性质所致。\n- “对于任何步长延拓都会失败”的说法与 B 中的分析直接矛盾。\n结论：**不正确**\n\n**D) 保持 $h = 1.2$ 不变，但将正交超平面约束 $t_0^\\top (z - z_{\\mathrm{p}}) = 0$ 替换为垂直线约束 $x = 1$，可以保证 Newton 校正步的收敛，因为 $x = 1$ 与单位圆相交。**\n- 待求解的新系统是：$x^2 + y^2 - 1 = 0$ 和 $x = 1$。唯一的解是 $z^* = (1,0)$。\n- 初始猜测仍然是 $z^{(0)} = z_{\\mathrm{p}} = (1, 1.2)$。\n- 新的增广函数是 $H_{new}(z) = \\begin{bmatrix} x^2+y^2-1 \\\\ x-1 \\end{bmatrix}$。其雅可比矩阵是 $J_{H_{new}}(z) = \\begin{bmatrix} 2x & 2y \\\\ 1 & 0 \\end{bmatrix}$。\n- 在解 $z^* = (1,0)$ 处，雅可比矩阵为 $J_{H_{new}}(1,0) = \\begin{bmatrix} 2 & 0 \\\\ 1 & 0 \\end{bmatrix}$，其行列式为 0。\n- 根处的奇异雅可比矩阵意味着 Newton 法失去了稳健、有保证的二次收敛性。从几何上看，约束线 $x=1$ 在交点 $(1,0)$ 处与解曲线（圆）相切。这种非横截的相交正是伪弧长法旨在避免的情况。\n- “保证收敛”的说法过于强烈且具有误导性。这种设置对校正步来说是一种病态情况。\n结论：**不正确**",
            "answer": "$$\\boxed{AB}$$"
        },
        {
            "introduction": "要将延拓方法应用于偏微分方程 (PDE)，我们必须首先将其离散化为一个非线性代数方程组。本练习 () 聚焦于著名的 Bratu 方程，提供了一个关于此过程的关键动手实践。你将推导离散化系统的核心组成部分——残差向量 $R$、雅可比矩阵 $J$ 及其参数导数 $R_{\\lambda}$——并利用它们来计算作为预测步方向的切向量。",
            "id": "3373968",
            "problem": "考虑稳态一维Bratu型偏微分方程（PDE）\n$$\\frac{d^{2}u}{dx^{2}} + \\lambda \\exp(u) = 0,$$\n该方程定义在区间 $x \\in [0,1]$ 上，并带有齐次狄利克雷边界条件 $u(0) = 0$ 和 $u(1) = 0$。在一个间距为 $h = \\frac{1}{3}$ 的均匀网格上，使用标准二阶中心有限差分格式，内部网格点位于 $x_{1} = h$ 和 $x_{2} = 2h$，未知数为 $u_{1} \\approx u(x_{1})$ 和 $u_{2} \\approx u(x_{2})$。记边界值为 $u_{0} = 0$ 和 $u_{3} = 0$。内部节点 $x_{i}$ 处的残差定义为\n$$R_{i}(u,\\lambda) = \\frac{u_{i-1} - 2u_{i} + u_{i+1}}{h^{2}} + \\lambda \\exp(u_{i}), \\quad i = 1,2,$$\n因此离散非线性系统为 $R(u,\\lambda) = 0$，其中 $R \\in \\mathbb{R}^{2}$。令 $J(u,\\lambda) = \\frac{\\partial R}{\\partial u}$ 为关于向量 $u = (u_{1},u_{2})^{\\top}$ 的雅可比矩阵，令 $R_{\\lambda}(u,\\lambda) = \\frac{\\partial R}{\\partial \\lambda}$ 为残差关于参数 $\\lambda$ 的偏导数。\n\n在伪弧长延拓框架中，解分支的切向量 $(u_{s},\\lambda_{s})$ 求解以下线性化耦合方程\n$$J(u,\\lambda)\\,u_{s} + R_{\\lambda}(u,\\lambda)\\,\\lambda_{s} = 0,$$\n并辅以一个归一化约束\n$$c^{\\top} u_{s} + \\gamma\\,\\lambda_{s} = 1,$$\n其中向量 $c \\in \\mathbb{R}^{2}$ 和标量 $\\gamma \\in \\mathbb{R}$ 是给定的。\n\n从上述基本定义出发，并使用 $h = \\frac{1}{3}$，推导此离散化下的 $R(u,\\lambda)$、$J(u,\\lambda)$ 和 $R_{\\lambda}(u,\\lambda)$ 的显式表达式。然后，在状态\n$$u_{1} = 0.2,\\quad u_{2} = 0.1,\\quad \\lambda = 2,$$\n使用归一化数据\n$$c = \\begin{pmatrix}1 \\\\ -1\\end{pmatrix},\\quad \\gamma = 0,$$\n求解该耦合线性系统以得到切向量，并计算标量 $\\lambda_{s}$。将您的答案四舍五入到五位有效数字。最终答案必须是一个不带单位的实数。",
            "solution": "**步骤1：推导系统分量**\n首先，根据问题定义，我们写出离散系统的各个组成部分。网格间距 $h = 1/3$。\n- 残差向量 $R(u,\\lambda)$:\n$$R(u,\\lambda) = \\begin{pmatrix} \\frac{-2u_{1} + u_{2}}{h^{2}} + \\lambda \\exp(u_{1}) \\\\ \\frac{u_{1} - 2u_{2}}{h^{2}} + \\lambda \\exp(u_{2}) \\end{pmatrix}$$\n- 雅可比矩阵 $J(u,\\lambda) = \\frac{\\partial R}{\\partial u}$:\n$$J(u,\\lambda) = \\begin{pmatrix} -2/h^2 + \\lambda \\exp(u_1) & 1/h^2 \\\\ 1/h^2 & -2/h^2 + \\lambda \\exp(u_2) \\end{pmatrix}$$\n- 参数导数 $R_{\\lambda}(u,\\lambda) = \\frac{\\partial R}{\\partial \\lambda}$:\n$$R_{\\lambda}(u,\\lambda) = \\begin{pmatrix} \\exp(u_1) \\\\ \\exp(u_2) \\end{pmatrix}$$\n\n**步骤2：建立并求解切向量的线性系统**\n切向量 $(u_s, \\lambda_s)$，其中 $u_s = (u_{s1}, u_{s2})^\\top$，由以下线性系统确定：\n1. $J u_s + R_{\\lambda} \\lambda_s = 0$\n2. $c^\\top u_s + \\gamma \\lambda_s = 1$\n将给定的归一化数据 $c = (1, -1)^\\top$ 和 $\\gamma=0$ 代入，系统变为一个包含三个未知数 $(u_{s1}, u_{s2}, \\lambda_s)$ 的 $3 \\times 3$ 线性方程组：\n$$\n\\begin{pmatrix} J_{11} & J_{12} & R_{\\lambda 1} \\\\ J_{21} & J_{22} & R_{\\lambda 2} \\\\ 1 & -1 & 0 \\end{pmatrix} \\begin{pmatrix} u_{s1} \\\\ u_{s2} \\\\ \\lambda_s \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}\n$$\n我们想求解 $\\lambda_s$。使用克莱姆法则（Cramer's Rule），我们有：\n$$ \\lambda_s = \\frac{\\det \\begin{pmatrix} J_{11} & J_{12} & 0 \\\\ J_{21} & J_{22} & 0 \\\\ 1 & -1 & 1 \\end{pmatrix}}{\\det \\begin{pmatrix} J_{11} & J_{12} & R_{\\lambda 1} \\\\ J_{21} & J_{22} & R_{\\lambda 2} \\\\ 1 & -1 & 0 \\end{pmatrix}} $$\n分子行列式通过沿最后一列展开得到 $\\det(J)$。\n分母行列式通过沿最后一行展开得到 $1 \\cdot (J_{12} R_{\\lambda 2} - J_{22} R_{\\lambda 1}) - (-1) \\cdot (J_{11} R_{\\lambda 2} - J_{21} R_{\\lambda 1}) + 0$。\n分母 $= (J_{11}+J_{12})R_{\\lambda 2} - (J_{21}+J_{22})R_{\\lambda 1}$。\n代入 $J_{ij}$ 和 $R_{\\lambda i}$ 的表达式：\n分母 $= (-1/h^2 + \\lambda e^{u_1})e^{u_2} - (-1/h^2 + \\lambda e^{u_2})e^{u_1} = \\frac{1}{h^2}(e^{u_1} - e^{u_2})$。\n因此，我们得到 $\\lambda_s$ 的解析表达式：\n$$ \\lambda_s = \\frac{\\det(J)}{\\frac{1}{h^2}(\\exp(u_1) - \\exp(u_2))} = \\frac{h^2 \\det(J)}{\\exp(u_1) - \\exp(u_2)} $$\n\n**步骤3：数值计算**\n在给定状态 $u_1=0.2, u_2=0.1, \\lambda=2$ 和 $h=1/3$ ($h^2=1/9$) 下进行计算。\n- 首先计算雅可比矩阵的行列式：\n$$ \\det(J) = J_{11}J_{22} - J_{12}J_{21} = (-2/h^2 + \\lambda e^{u_1})(-2/h^2 + \\lambda e^{u_2}) - (1/h^2)^2 $$\n$$ \\det(J) = (-18 + 2e^{0.2})(-18 + 2e^{0.1}) - 81 = 243 - 36(e^{0.1} + e^{0.2}) + 4e^{0.3} $$\n使用数值：\n$e^{0.1} \\approx 1.1051709$, $e^{0.2} \\approx 1.2214028$, $e^{0.3} \\approx 1.3498588$\n$$ \\det(J) \\approx 243 - 36(1.1051709 + 1.2214028) + 4(1.3498588) \\approx 164.6428 $$\n- 接着计算分母中的指数项：\n$$ \\exp(u_1) - \\exp(u_2) = e^{0.2} - e^{0.1} \\approx 1.2214028 - 1.1051709 = 0.1162319 $$\n- 最后计算 $\\lambda_s$：\n$$ \\lambda_s = \\frac{(1/9) \\times 164.6428}{0.1162319} \\approx \\frac{18.29364}{0.1162319} \\approx 157.389 $$\n四舍五入到五位有效数字，结果为 $157.39$。",
            "answer": "$$\n\\boxed{157.39}\n$$"
        }
    ]
}