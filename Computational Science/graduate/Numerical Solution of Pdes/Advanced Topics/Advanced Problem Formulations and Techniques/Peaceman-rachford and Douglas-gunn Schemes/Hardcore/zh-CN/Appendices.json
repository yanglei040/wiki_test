{
    "hands_on_practices": [
        {
            "introduction": "我们的第一个动手实践是分析Peaceman-Rachford (PR)交替方向隐式(ADI)方法的一个基本性质。我们将使用冯·诺伊曼稳定性分析来推导二维常系数热方程下该格式的放大因子。这项练习旨在验证PR格式的一个关键优点——无条件稳定性，这是理解ADI方法为何在求解多维抛物线型偏微分方程中如此高效和流行的基础。",
            "id": "3429863",
            "problem": "考虑二维常系数热传导方程\n$$\nu_{t} \\;=\\; \\alpha_{x}\\,u_{xx} \\;+\\; \\alpha_{y}\\,u_{yy},\n$$\n该方程定义在一个无限均匀网格上，在 $$x$$ 和 $$y$$ 方向上的间距分别为 $$h_{x}$$ 和 $$h_{y}$$。令 $$u_{i,j}^{n}$$ 表示对 $$u(x_{i},y_{j},t_{n})$$ 的离散近似，其中 $$x_{i} = i\\,h_{x}$$，$$y_{j} = j\\,h_{y}$$，且 $$t_{n} = n\\,\\Delta t$$。定义标准的二阶中心差分算子\n$$\n(D_{xx} u)_{i,j} \\;=\\; \\frac{u_{i+1,j} - 2u_{i,j} + u_{i-1,j}}{h_{x}^{2}}, \n\\qquad\n(D_{yy} u)_{i,j} \\;=\\; \\frac{u_{i,j+1} - 2u_{i,j} + u_{i,j-1}}{h_{y}^{2}}.\n$$\n考虑 Peaceman–Rachford 格式，这是一种经典的交替方向隐式（ADI）方法，由以下两个子步骤定义\n$$\n\\bigl(I \\;-\\; \\tfrac{\\Delta t}{2}\\,\\alpha_{x}\\,D_{xx}\\bigr)\\,u^{n+\\frac{1}{2}} \\;=\\; \\bigl(I \\;+\\; \\tfrac{\\Delta t}{2}\\,\\alpha_{y}\\,D_{yy}\\bigr)\\,u^{n},\n$$\n$$\n\\bigl(I \\;-\\; \\tfrac{\\Delta t}{2}\\,\\alpha_{y}\\,D_{yy}\\bigr)\\,u^{n+1} \\;=\\; \\bigl(I \\;+\\; \\tfrac{\\Delta t}{2}\\,\\alpha_{x}\\,D_{xx}\\bigr)\\,u^{n+\\frac{1}{2}}.\n$$\n假设空间具有周期性，以便应用 Von Neumann（傅里叶）模态分析。使用傅里叶 ansatz $$u_{i,j}^{n} \\;=\\; \\zeta^{n}\\,\\exp\\!\\bigl(\\mathrm{i}\\,(i\\,\\xi + j\\,\\eta)\\bigr)$$，其中 $$\\xi,\\eta \\in [0,2\\pi]$$，推导从 $$t_{n}$$ 到 $$t_{n+1}$$ 的完整时间步长的放大因子 $$G(\\xi,\\eta)$$。然后，用无量纲参数\n$$\nr_{x} \\;=\\; \\frac{\\alpha_{x}\\,\\Delta t}{h_{x}^{2}},\n\\qquad\nr_{y} \\;=\\; \\frac{\\alpha_{y}\\,\\Delta t}{h_{y}^{2}},\n$$\n来确定\n$$\n\\sup_{\\xi,\\eta \\in [0,2\\pi]} \\,\\bigl|G(\\xi,\\eta)\\bigr|\n$$\n的精确值。\n将最终答案表示为一个精确的实数。无需四舍五入。",
            "solution": "出发点是常系数抛物型偏微分方程 $$u_{t} = \\alpha_{x} u_{xx} + \\alpha_{y} u_{yy}$$。在一个具有周期性的均匀网格上，通过将单个傅里叶模态代入离散格式，并追踪一个时间步长内的乘性因子来进行 Von Neumann 分析。对于二阶中心差分算子，\n$$\n(D_{xx} u)_{i,j} \\;=\\; \\frac{u_{i+1,j} - 2u_{i,j} + u_{i-1,j}}{h_{x}^{2}},\n\\qquad\n(D_{yy} u)_{i,j} \\;=\\; \\frac{u_{i,j+1} - 2u_{i,j} + u_{i,j-1}}{h_{y}^{2}},\n$$\n当其作用于模态 $$u_{i,j} = \\exp\\!\\bigl(\\mathrm{i}\\,(i\\,\\xi + j\\,\\eta)\\bigr)$$ 时，离散傅里叶符号（特征值）由熟知的恒等式给出。具体来说，\n$$\n\\lambda_{x}(\\xi) \\;=\\; -\\frac{4}{h_{x}^{2}}\\sin^{2}\\!\\Bigl(\\frac{\\xi}{2}\\Bigr),\n\\qquad\n\\lambda_{y}(\\eta) \\;=\\; -\\frac{4}{h_{y}^{2}}\\sin^{2}\\!\\Bigl(\\frac{\\eta}{2}\\Bigr).\n$$\n这些结果由三角恒等式 $$\\exp(\\mathrm{i}\\xi) + \\exp(-\\mathrm{i}\\xi) - 2 = 2(\\cos\\xi - 1) = -4\\sin^{2}(\\xi/2)$$ 以及 $$D_{xx},D_{yy}$$ 的定义得出。\n\n引入无量纲参数\n$$\nr_{x} \\;=\\; \\frac{\\alpha_{x}\\,\\Delta t}{h_{x}^{2}},\n\\qquad\nr_{y} \\;=\\; \\frac{\\alpha_{y}\\,\\Delta t}{h_{y}^{2}}.\n$$\n定义半步系数\n$$\na_{x}(\\xi) \\;=\\; \\frac{\\Delta t}{2}\\,\\alpha_{x}\\,\\lambda_{x}(\\xi) \\;=\\; -2\\,r_{x}\\,\\sin^{2}\\!\\Bigl(\\frac{\\xi}{2}\\Bigr),\n\\qquad\na_{y}(\\eta) \\;=\\; \\frac{\\Delta t}{2}\\,\\alpha_{y}\\,\\lambda_{y}(\\eta) \\;=\\; -2\\,r_{y}\\,\\sin^{2}\\!\\Bigl(\\frac{\\eta}{2}\\Bigr).\n$$\n考虑将 Peaceman–Rachford 格式的子步骤应用于单个傅里叶模态。第一个子步骤\n$$\n\\bigl(I - \\tfrac{\\Delta t}{2}\\alpha_{x}D_{xx}\\bigr) u^{n+\\frac{1}{2}} \\;=\\; \\bigl(I + \\tfrac{\\Delta t}{2}\\alpha_{y}D_{yy}\\bigr) u^{n}\n$$\n在傅里叶空间中产生，\n$$\n\\bigl(1 - a_{x}(\\xi)\\bigr)\\,\\widehat{u}^{\\,n+\\frac{1}{2}} \\;=\\; \\bigl(1 + a_{y}(\\eta)\\bigr)\\,\\widehat{u}^{\\,n}.\n$$\n因此，\n$$\n\\widehat{u}^{\\,n+\\frac{1}{2}} \\;=\\; \\frac{1 + a_{y}(\\eta)}{1 - a_{x}(\\xi)}\\,\\widehat{u}^{\\,n}.\n$$\n第二个子步骤\n$$\n\\bigl(I - \\tfrac{\\Delta t}{2}\\alpha_{y}D_{yy}\\bigr) u^{n+1} \\;=\\; \\bigl(I + \\tfrac{\\Delta t}{2}\\alpha_{x}D_{xx}\\bigr) u^{n+\\frac{1}{2}}\n$$\n给出\n$$\n\\bigl(1 - a_{y}(\\eta)\\bigr)\\,\\widehat{u}^{\\,n+1} \\;=\\; \\bigl(1 + a_{x}(\\xi)\\bigr)\\,\\widehat{u}^{\\,n+\\frac{1}{2}}.\n$$\n代入 $$\\widehat{u}^{\\,n+\\frac{1}{2}}$$ 的表达式，得到单步放大因子 $$G(\\xi,\\eta)$$：\n$$\n\\widehat{u}^{\\,n+1} \\;=\\; \\frac{1 + a_{x}(\\xi)}{1 - a_{y}(\\eta)} \\cdot \\frac{1 + a_{y}(\\eta)}{1 - a_{x}(\\xi)}\\,\\widehat{u}^{\\,n}\n\\;\\;\\Rightarrow\\;\\;\nG(\\xi,\\eta) \\;=\\; \\frac{\\bigl(1 + a_{x}(\\xi)\\bigr)\\bigl(1 + a_{y}(\\eta)\\bigr)}{\\bigl(1 - a_{x}(\\xi)\\bigr)\\bigl(1 - a_{y}(\\eta)\\bigr)}.\n$$\n用 $$r_{x}, r_{y}$$ 和三角因子表示，\n$$\n1 + a_{x}(\\xi) \\;=\\; 1 - 2\\,r_{x}\\,\\sin^{2}\\!\\Bigl(\\frac{\\xi}{2}\\Bigr), \\qquad\n1 - a_{x}(\\xi) \\;=\\; 1 + 2\\,r_{x}\\,\\sin^{2}\\!\\Bigl(\\frac{\\xi}{2}\\Bigr),\n$$\n对 $$y$$ 也类似。因此，\n$$\nG(\\xi,\\eta) \\;=\\; \n\\frac{\\bigl(1 - 2\\,r_{x}\\,\\sin^{2}(\\xi/2)\\bigr)\\bigl(1 - 2\\,r_{y}\\,\\sin^{2}(\\eta/2)\\bigr)}\n{\\bigl(1 + 2\\,r_{x}\\,\\sin^{2}(\\xi/2)\\bigr)\\bigl(1 + 2\\,r_{y}\\,\\sin^{2}(\\eta/2)\\bigr)}.\n$$\n为了通过 Von Neumann 分析确定稳定性边界，我们考察其模长：\n$$\n\\bigl|G(\\xi,\\eta)\\bigr| \\;=\\; \n\\left|\\frac{1 - 2\\,r_{x}\\,\\sin^{2}(\\xi/2)}{1 + 2\\,r_{x}\\,\\sin^{2}(\\xi/2)}\\right|\n\\cdot\n\\left|\\frac{1 - 2\\,r_{y}\\,\\sin^{2}(\\eta/2)}{1 + 2\\,r_{y}\\,\\sin^{2}(\\eta/2)}\\right|.\n$$\n令 $$a \\;=\\; 2\\,r_{x}\\,\\sin^{2}(\\xi/2) \\ge 0$$ 且 $$b \\;=\\; 2\\,r_{y}\\,\\sin^{2}(\\eta/2) \\ge 0$$。那么每个因子是\n$$\nf(a) \\;=\\; \\left|\\frac{1 - a}{1 + a}\\right|, \\qquad g(b) \\;=\\; \\left|\\frac{1 - b}{1 + b}\\right|.\n$$\n对于 $$a \\ge 0$$，\n$$\n0 \\;\\le\\; f(a) \\;\\le\\; 1 \\quad \\text{对于} \\quad a \\ge 0, \\qquad f(0) \\;=\\; 1, \\qquad \\lim_{a\\to\\infty} f(a) \\;=\\; 1.\n$$\n该函数在 $$[0, \\infty)$$ 区间内的值不大于 $$1$$。对 $$g(b)$$ 也同样成立。因此，\n$$\n\\bigl|G(\\xi,\\eta)\\bigr| \\;=\\; f(a)\\,g(b) \\;\\le\\; 1,\n$$\n并且当 $$a = 0$$ 或 $$b=0$$ 时（例如，在 $$\\xi = 0$$ 或 $$\\eta = 0$$ 时发生），在 $$\\xi,\\eta \\in [0,2\\pi]$$ 上的上确界得以实现，从而得到\n$$\n\\sup_{\\xi,\\eta \\in [0,2\\pi]} \\,\\bigl|G(\\xi,\\eta)\\bigr| \\;=\\; 1.\n$$\n这表明 Peaceman–Rachford 交替方向隐式格式对于二维常系数热传导方程是无条件稳定的，并且放大因子模的精确上确界是 $$1$$。",
            "answer": "$$\\boxed{1}$$"
        },
        {
            "introduction": "在掌握了基本热方程的分析之后，我们现在将注意力转向一个更复杂的场景：带混合导数项的各向异性扩散方程。标准的ADI分裂方法无法直接处理交叉偏导数项 $u_{xy}$，因此本练习将探讨一种常用策略：对此项进行显式处理。通过推导这种混合格式的放大因子，你将深入了解这种修改如何影响格式的稳定性，并为更复杂的应用打下基础。",
            "id": "3429906",
            "problem": "考虑二维各向异性扩散偏微分方程 (PDE)\n$$\nu_{t} \\;=\\; a\\,u_{xx} \\;+\\; 2b\\,u_{xy} \\;+\\; c\\,u_{yy},\n$$\n其系数 $a>0$, $c>0$, 且 $ac-b^{2}>0$ 为常数，从而保证扩散张量是正定的。在无限的、均匀的 Cartesian 网格上对空间进行离散化，两个方向上的网格宽度均为 $h$。使用二阶中心差分近似 $u_{xx}$ 和 $u_{yy}$，并使用标准的二阶混合中心差分近似 $u_{xy}$\n$$\nu_{xy}(x_{i},y_{j}) \\;\\approx\\; \\frac{u_{i+1,j+1} \\;-\\; u_{i+1,j-1} \\;-\\; u_{i-1,j+1} \\;+\\; u_{i-1,j-1}}{4h^{2}}.\n$$\n应用 Peaceman–Rachford 交替方向隐式 (ADI) 格式，其中混合导数项被显式处理。记 $L_{x}$ 和 $L_{y}$ 分别为在 $x$ 和 $y$ 方向上按 $a$ 和 $c$ 缩放的离散一维二阶导数算子，记 $M$ 为按 $2b$ 缩放的离散混合导数算子。设 $\\Delta t$ 为时间步长，并记 $\\rho = \\Delta t / h^{2}$。$u^{n} \\mapsto u^{n+1}$ 的 Peaceman–Rachford ADI 更新格式为\n$$\n\\bigl(I \\;-\\; \\tfrac{\\Delta t}{2}\\,L_{x}\\bigr)\\,\\bigl(I \\;-\\; \\tfrac{\\Delta t}{2}\\,L_{y}\\bigr)\\,u^{n+1}\n\\;=\\;\n\\bigl(I \\;+\\; \\tfrac{\\Delta t}{2}\\,L_{x}\\bigr)\\,\\bigl(I \\;+\\; \\tfrac{\\Delta t}{2}\\,L_{y}\\bigr)\\,u^{n}\n\\;+\\;\n\\Delta t\\,M\\,u^{n}.\n$$\n使用 Fourier 分析，对于模态 $u_{i,j}^{n} = \\widehat{u}^{n}\\,\\exp\\!\\bigl(i(k_{x} i h + k_{y} j h)\\bigr)$，推导该格式的单步放大因子 $G(k_{x},k_{y})$，用 $a$、$b$、$c$、$\\rho$、$k_{x}$ 和 $k_{y}$ 表示。然后，对于参数值 $a=1$、$b=\\tfrac{3}{2}$、$c=4$、$\\rho=\\tfrac{1}{5}$、$k_{x} h = \\tfrac{\\pi}{3}$ 和 $k_{y} h = \\tfrac{\\pi}{4}$，计算 $G$ 的值，并将最终结果表示为单个闭式解析表达式。请勿对答案进行四舍五入。",
            "solution": "本题要求推导应用于二维各向异性扩散方程的 Peaceman-Rachford ADI 格式的单步放大因子，并在一组特定参数下计算其值。\n\n首先，我们对问题陈述进行验证。\n**步骤1：提取已知条件**\n-   PDE: $u_{t} = a\\,u_{xx} + 2b\\,u_{xy} + c\\,u_{yy}$\n-   系数: $a>0$, $c>0$, $ac-b^{2}>0$。\n-   离散化：均匀 Cartesian 网格，网格宽度 $h$。\n-   有限差分近似：\n    -   $u_{xx}$ 和 $u_{yy}$ 采用二阶中心差分。\n    -   $u_{xy}(x_{i},y_{j}) \\approx \\frac{u_{i+1,j+1} - u_{i+1,j-1} - u_{i-1,j+1} + u_{i-1,j-1}}{4h^{2}}$。\n-   数值格式 (Peaceman-Rachford ADI)：\n    $\\bigl(I - \\tfrac{\\Delta t}{2}\\,L_{x}\\bigr)\\,\\bigl(I - \\tfrac{\\Delta t}{2}\\,L_{y}\\bigr)\\,u^{n+1} = \\bigl(I + \\tfrac{\\Delta t}{2}\\,L_{x}\\bigr)\\,\\bigl(I + \\tfrac{\\Delta t}{2}\\,L_{y}\\bigr)\\,u^{n} + \\Delta t\\,M\\,u^{n}$\n-   算子定义：\n    -   $L_x$ 代表 $a \\frac{\\partial^2}{\\partial x^2}$ 的离散算子。\n    -   $L_y$ 代表 $c \\frac{\\partial^2}{\\partial y^2}$ 的离散算子。\n    -   $M$ 代表 $2b \\frac{\\partial^2}{\\partial x \\partial y}$ 的离散算子。\n-   参数：$\\Delta t$ 是时间步长，$\\rho = \\Delta t / h^{2}$。\n-   分析方法：Fourier 分析，采用模态 $u_{i,j}^{n} = \\widehat{u}^{n}\\,\\exp\\!\\bigl(i(k_{x} i h + k_{y} j h)\\bigr)$。\n-   任务1：推导放大因子 $G(k_{x},k_{y})$。\n-   任务2：对 $a=1$, $b=\\tfrac{3}{2}$, $c=4$, $\\rho=\\tfrac{1}{5}$, $k_{x} h = \\tfrac{\\pi}{3}$ 及 $k_{y} h = \\tfrac{\\pi}{4}$ 计算 $G$ 的值。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题具有科学依据，描述了用于一个良态物理问题（各向异性扩散，由 $ac-b^2>0$ 保证）的标准数值方法 (Peaceman-Rachford ADI)。所用的分析技术 (von Neumann 稳定性分析) 是标准的。该问题是自洽的，提供了所有必要的定义、方程和参数。对于给定的值 $a=1, b=3/2, c=4$，条件 $ac-b^2 = (1)(4) - (3/2)^2 = 4 - 9/4 = 7/4 > 0$ 得到满足，保证了一致性。该问题是客观和良态的，可以得到唯一的解析推导和后续计算。未发现任何缺陷。\n\n**步骤3：结论和行动**\n问题有效。我们继续求解。\n\n为推导放大因子 $G$，我们分析该格式如何作用于单个 Fourier 模态 $u_{i,j}^{n} = \\widehat{u}^{n}\\,\\exp\\!\\bigl(i(\\theta_x i + \\theta_y j)\\bigr)$，其中 $\\theta_x = k_x h$ 且 $\\theta_y = k_y h$。放大因子定义为 $G = \\widehat{u}^{n+1} / \\widehat{u}^{n}$。\n\n我们首先求出离散算子 $L_x$、$L_y$ 和 $M$ 对应于此 Fourier 模态的特征值。\n$u_{xx}$ 的标准二阶中心差分为 $\\frac{u_{i+1,j} - 2u_{i,j} + u_{i-1,j}}{h^2}$。算子 $L_x$ 是该表达式乘以 $a$。将 $L_x$ 应用于 Fourier 模态：\n$$\nL_x u_{i,j}^n = \\frac{a}{h^2} \\left( e^{i\\theta_x} - 2 + e^{-i\\theta_x} \\right) u_{i,j}^n = \\frac{a}{h^2} (2\\cos(\\theta_x) - 2) u_{i,j}^n = -\\frac{4a}{h^2} \\sin^2\\left(\\frac{\\theta_x}{2}\\right) u_{i,j}^n\n$$\n$L_x$ 的特征值为 $\\lambda_{L_x} = -\\frac{4a}{h^2} \\sin^2\\left(\\frac{k_x h}{2}\\right)$。\n\n类似地，对于在 $y$ 方向上作用的 $L_y$：\n$$\nL_y u_{i,j}^n = \\frac{c}{h^2} \\left( e^{i\\theta_y} - 2 + e^{-i\\theta_y} \\right) u_{i,j}^n = -\\frac{4c}{h^2} \\sin^2\\left(\\frac{\\theta_y}{2}\\right) u_{i,j}^n\n$$\n$L_y$ 的特征值为 $\\lambda_{L_y} = -\\frac{4c}{h^2} \\sin^2\\left(\\frac{k_y h}{2}\\right)$。\n\n对于混合导数算子 $M$，使用给定的中心差分格式：\n$$\nM u_{i,j}^n = \\frac{2b}{4h^2} \\left( e^{i(\\theta_x+\\theta_y)} - e^{i(\\theta_x-\\theta_y)} - e^{i(-\\theta_x+\\theta_y)} + e^{i(-\\theta_x-\\theta_y)} \\right) u_{i,j}^n\n$$\n$$\nM u_{i,j}^n = \\frac{b}{2h^2} \\left( (e^{i\\theta_x} - e^{-i\\theta_x})(e^{i\\theta_y} - e^{-i\\theta_y}) \\right) u_{i,j}^n = \\frac{b}{2h^2} (2i\\sin(\\theta_x))(2i\\sin(\\theta_y)) u_{i,j}^n\n$$\n$$\nM u_{i,j}^n = -\\frac{2b}{h^2} \\sin(\\theta_x)\\sin(\\theta_y) u_{i,j}^n\n$$\n$M$ 的特征值为 $\\lambda_M = -\\frac{2b}{h^2} \\sin(k_x h)\\sin(k_y h)$。\n\n现在，我们将这些特征值代入 ADI 格式方程。在 Fourier 空间中，算子被其特征值替换，而 $u^{n+1}$ 被 $G u^n$ 替换：\n$$\n\\left(1 - \\frac{\\Delta t}{2}\\lambda_{L_x}\\right)\\left(1 - \\frac{\\Delta t}{2}\\lambda_{L_y}\\right) G = \\left(1 + \\frac{\\Delta t}{2}\\lambda_{L_x}\\right)\\left(1 + \\frac{\\Delta t}{2}\\lambda_{L_y}\\right) + \\Delta t \\lambda_M\n$$\n求解 $G$：\n$$\nG(k_x, k_y) = \\frac{\\left(1 + \\frac{\\Delta t}{2}\\lambda_{L_x}\\right)\\left(1 + \\frac{\\Delta t}{2}\\lambda_{L_y}\\right) + \\Delta t \\lambda_M}{\\left(1 - \\frac{\\Delta t}{2}\\lambda_{L_x}\\right)\\left(1 - \\frac{\\Delta t}{2}\\lambda_{L_y}\\right)}\n$$\n代入特征值表达式并使用 $\\rho=\\Delta t/h^2$：\n$\\frac{\\Delta t}{2}\\lambda_{L_x} = -2\\rho a \\sin^2(\\frac{k_x h}{2})$，\n$\\frac{\\Delta t}{2}\\lambda_{L_y} = -2\\rho c \\sin^2(\\frac{k_y h}{2})$，\n$\\Delta t \\lambda_M = -2\\rho b \\sin(k_x h)\\sin(k_y h)$。\n放大因子为：\n$$\nG(k_x, k_y) = \\frac{\\left(1 - 2\\rho a \\sin^2\\left(\\frac{k_x h}{2}\\right)\\right)\\left(1 - 2\\rho c \\sin^2\\left(\\frac{k_y h}{2}\\right)\\right) - 2\\rho b \\sin(k_x h)\\sin(k_y h)}{\\left(1 + 2\\rho a \\sin^2\\left(\\frac{k_x h}{2}\\right)\\right)\\left(1 + 2\\rho c \\sin^2\\left(\\frac{k_y h}{2}\\right)\\right)}\n$$\n这就完成了问题的第一部分。\n\n对于第二部分，我们对给定的参数 $a=1$, $b=\\tfrac{3}{2}$, $c=4$, $\\rho=\\tfrac{1}{5}$, $k_x h = \\tfrac{\\pi}{3}$, $k_y h = \\tfrac{\\pi}{4}$ 计算 $G$。\n令 $\\theta_x = k_x h = \\tfrac{\\pi}{3}$ 和 $\\theta_y = k_y h = \\tfrac{\\pi}{4}$。我们计算 $G$ 表达式的各个组成部分。\n\n分母项：\n$1 + 2\\rho a \\sin^2(\\frac{\\theta_x}{2}) = 1 + 2(\\frac{1}{5})(1)\\sin^2(\\frac{\\pi}{6}) = 1 + \\frac{2}{5}(\\frac{1}{2})^2 = 1 + \\frac{1}{10} = \\frac{11}{10}$。\n$1 + 2\\rho c \\sin^2(\\frac{\\theta_y}{2}) = 1 + 2(\\frac{1}{5})(4)\\sin^2(\\frac{\\pi}{8}) = 1 + \\frac{8}{5}\\left(\\frac{1-\\cos(\\frac{\\pi}{4})}{2}\\right) = 1 + \\frac{4}{5}\\left(1 - \\frac{\\sqrt{2}}{2}\\right) = 1 + \\frac{4-2\\sqrt{2}}{5} = \\frac{9-2\\sqrt{2}}{5}$。\n分母 = $(\\frac{11}{10})(\\frac{9-2\\sqrt{2}}{5}) = \\frac{99-22\\sqrt{2}}{50}$。\n\n分子项：\n涉及 $L_x$ 和 $L_y$ 的项是类似的，只是符号相反。\n$1 - 2\\rho a \\sin^2(\\frac{\\theta_x}{2}) = 1 - \\frac{1}{10} = \\frac{9}{10}$。\n$1 - 2\\rho c \\sin^2(\\frac{\\theta_y}{2}) = 1 - \\frac{4-2\\sqrt{2}}{5} = \\frac{1+2\\sqrt{2}}{5}$。\n来自混合导数 $M$ 的项是：\n$-2\\rho b \\sin(\\theta_x)\\sin(\\theta_y) = -2(\\frac{1}{5})(\\frac{3}{2})\\sin(\\frac{\\pi}{3})\\sin(\\frac{\\pi}{4}) = -\\frac{3}{5}\\left(\\frac{\\sqrt{3}}{2}\\right)\\left(\\frac{\\sqrt{2}}{2}\\right) = -\\frac{3\\sqrt{6}}{20}$。\n分子 = $(\\frac{9}{10})(\\frac{1+2\\sqrt{2}}{5}) - \\frac{3\\sqrt{6}}{20} = \\frac{9+18\\sqrt{2}}{50} - \\frac{3\\sqrt{6}}{20}$。\n将它们通分，分母为 $100$：\n分子 = $\\frac{2(9+18\\sqrt{2})}{100} - \\frac{5(3\\sqrt{6})}{100} = \\frac{18+36\\sqrt{2}-15\\sqrt{6}}{100}$。\n\n合并分子和分母得到 $G$：\n$$\nG = \\frac{\\frac{18+36\\sqrt{2}-15\\sqrt{6}}{100}}{\\frac{99-22\\sqrt{2}}{50}} = \\frac{18+36\\sqrt{2}-15\\sqrt{6}}{100} \\cdot \\frac{50}{99-22\\sqrt{2}} = \\frac{18+36\\sqrt{2}-15\\sqrt{6}}{2(99-22\\sqrt{2})}\n$$\n我们可以从分子中提取公因数 $3$，从分母的括号中提取 $11$。\n$$\nG = \\frac{3(6+12\\sqrt{2}-5\\sqrt{6})}{2 \\cdot 11(9-2\\sqrt{2})} = \\frac{3(6+12\\sqrt{2}-5\\sqrt{6})}{22(9-2\\sqrt{2})}\n$$\n为获得闭式表达式，我们通过将分子和分母同乘以 $9+2\\sqrt{2}$ 来使分母有理化：\n分母：$22(9-2\\sqrt{2})(9+2\\sqrt{2}) = 22(9^2 - (2\\sqrt{2})^2) = 22(81-8) = 22 \\cdot 73 = 1606$。\n分子：$3(6+12\\sqrt{2}-5\\sqrt{6})(9+2\\sqrt{2})$。\n我们展开乘积 $(6+12\\sqrt{2}-5\\sqrt{6})(9+2\\sqrt{2})$：\n$$\n(6)(9) + (6)(2\\sqrt{2}) + (12\\sqrt{2})(9) + (12\\sqrt{2})(2\\sqrt{2}) - (5\\sqrt{6})(9) - (5\\sqrt{6})(2\\sqrt{2})\n$$\n$$\n= 54 + 12\\sqrt{2} + 108\\sqrt{2} + 48 - 45\\sqrt{6} - 10\\sqrt{12}\n$$\n$$\n= (54+48) + (12+108)\\sqrt{2} - 45\\sqrt{6} - 10(2\\sqrt{3})\n$$\n$$\n= 102 + 120\\sqrt{2} - 20\\sqrt{3} - 45\\sqrt{6}\n$$\n乘以因子 $3$：\n$3(102 + 120\\sqrt{2} - 20\\sqrt{3} - 45\\sqrt{6}) = 306 + 360\\sqrt{2} - 60\\sqrt{3} - 135\\sqrt{6}$。\n\n$G$ 的最终表达式为：\n$$\nG = \\frac{306 + 360\\sqrt{2} - 60\\sqrt{3} - 135\\sqrt{6}}{1606}\n$$",
            "answer": "$$\\boxed{\\frac{306 + 360\\sqrt{2} - 60\\sqrt{3} - 135\\sqrt{6}}{1606}}$$"
        },
        {
            "introduction": "最后的这个实践从纯理论分析转向计算实践，旨在直接比较Peaceman-Rachford和Douglas-Gunn两种ADI格式的性能。你将需要为包含混合导数项的挑战性问题编写一个程序，通过数值搜索来确定两种格式的最大稳定时间步长。这项练习不仅提供了对不同ADI变体在稳定性方面差异的定量洞察，还培养了在实际模拟中应用和评估这些方法的关键技能。",
            "id": "3429916",
            "problem": "考虑在单位正方形上的二维线性抛物型偏微分方程，其带有周期性边界条件，\n$$\n\\frac{\\partial u}{\\partial t} \\;=\\; a\\,\\frac{\\partial^2 u}{\\partial x^2} \\;+\\; b\\,\\frac{\\partial^2 u}{\\partial y^2} \\;+\\; m\\,\\frac{\\partial^2 u}{\\partial x\\,\\partial y},\n$$\n其中 $a>0$，$b>0$ 和 $m\\in\\mathbb{R}$ 是满足强椭圆条件 $m^2 < 4ab$ 的常系数。设 $N_x$ 和 $N_y$ 分别是 $x$ 和 $y$ 方向上的网格点数，均匀间距为 $\\Delta x = 1/N_x$ 和 $\\Delta y = 1/N_y$。对二阶导数使用二阶中心有限差分，对混合导数使用标准的二阶中心差分组合，即通过先在 $x$ 方向上应用中心一阶导数，然后在 $y$ 方向上应用中心一阶导数来近似 $\\partial^2 u/\\partial x\\,\\partial y$。\n\n定义分裂算子\n$$\nA \\;=\\; a\\,D_{xx},\\qquad B \\;=\\; b\\,D_{yy},\\qquad C \\;=\\; m\\,D_x D_y,\n$$\n其中 $D_{xx}$ 和 $D_{yy}$ 分别表示 $x$ 和 $y$ 方向上的离散二阶导数算子，$D_x$ 和 $D_y$ 表示离散中心一阶导数算子。考虑两种交替方向隐式 (ADI) 格式：\n\n1. Peaceman-Rachford 格式，其中混合导数被显式处理：\n   - 阶段 1：求解\n     $$\n     \\left(I - \\frac{\\Delta t}{2}A\\right) u^\\star \\;=\\; \\left(I + \\frac{\\Delta t}{2}B + \\Delta t\\,C\\right) u^n.\n     $$\n   - 阶段 2：求解\n     $$\n     \\left(I - \\frac{\\Delta t}{2}B\\right) u^{n+1} \\;=\\; \\left(I + \\frac{\\Delta t}{2}A\\right) u^\\star.\n     $$\n\n2. Douglas-Gunn 格式，在参数 $\\theta = 1/2$ 处带有一个 Craig-Sneyd 型混合导数修正：\n   - 预测步：\n     $$\n     Y_0 \\;=\\; u^n \\;+\\; \\Delta t\\,(A + B + C)\\,u^n.\n     $$\n   - $x$ 方向校正步：\n     $$\n     \\left(I - \\theta\\,\\Delta t\\,A\\right) Y_1 \\;=\\; Y_0 \\;-\\; \\theta\\,\\Delta t\\,A\\,u^n.\n     $$\n   - $y$ 方向校正步：\n     $$\n     \\left(I - \\theta\\,\\Delta t\\,B\\right) Y_2 \\;=\\; Y_1 \\;-\\; \\theta\\,\\Delta t\\,B\\,u^n.\n     $$\n   - 混合导数修正：\n     $$\n     u^{n+1} \\;=\\; Y_2 \\;+\\; (1 - \\theta)\\,\\Delta t\\,C\\,(Y_2 - u^n).\n     $$\n\n在周期性边界条件下，每个离散傅里叶模式都是解耦的。对于波数 $\\theta_x = 2\\pi k_x/N_x$ 和 $\\theta_y = 2\\pi k_y/N_y$，中心有限差分符号为\n$$\n\\lambda_{xx}(\\theta_x) \\;=\\; -\\frac{4}{\\Delta x^2} \\sin^2\\!\\left(\\frac{\\theta_x}{2}\\right),\\quad\n\\lambda_{yy}(\\theta_y) \\;=\\; -\\frac{4}{\\Delta y^2} \\sin^2\\!\\left(\\frac{\\theta_y}{2}\\right),\\quad\n\\lambda_x(\\theta_x) \\;=\\; \\frac{i}{\\Delta x}\\,\\sin(\\theta_x),\\quad\n\\lambda_y(\\theta_y) \\;=\\; \\frac{i}{\\Delta y}\\,\\sin(\\theta_y),\n$$\n因此混合导数符号为\n$$\n\\lambda_{xy}(\\theta_x,\\theta_y) \\;=\\; \\lambda_x(\\theta_x)\\,\\lambda_y(\\theta_y) \\;=\\; -\\,\\frac{\\sin(\\theta_x)\\,\\sin(\\theta_y)}{\\Delta x\\,\\Delta y}.\n$$\n相应的算子符号为 $\\lambda_A = a\\,\\lambda_{xx}$，$\\lambda_B = b\\,\\lambda_{yy}$ 和 $\\lambda_C = m\\,\\lambda_{xy}$。\n\n将每个格式的单步放大因子 $g(\\Delta t;\\theta_x,\\theta_y)$ 定义为一个傅里叶模式在一个时间步长后所乘的标量。一个类 Courant–Friedrichs–Lewy (类 CFL) 稳定性条件要求\n$$\n\\max_{\\theta_x,\\theta_y}\\,\\left|g(\\Delta t;\\theta_x,\\theta_y)\\right| \\;\\le\\; 1.\n$$\n\n任务：\n- 根据上述格式定义和傅里叶符号，推导每个格式的标量放大因子 $g(\\Delta t;\\theta_x,\\theta_y)$。\n- 实现一个程序，对于给定的 $(a,b,m,N_x,N_y)$，在区间 $[0,\\Delta t_{\\max}]$ 中找到满足类 CFL 条件的最大 $\\Delta t$。使用离散波数集合 $\\theta_x = 2\\pi k_x/N_x$ 和 $\\theta_y = 2\\pi k_y/N_y$，其中 $k_x = 0,\\dots,N_x-1$ 且 $k_y = 0,\\dots,N_y-1$。对每个测试用例，使用测试套件中提供的 $\\Delta t_{\\max}$。你的搜索应产生一个浮点值。不需要物理单位。\n- 你的程序必须为两种格式计算这个最大允许 $\\Delta t$，并为每个测试用例返回对 $[\\Delta t_{\\text{PR}},\\Delta t_{\\text{DG}}]$。\n\n测试套件：\n- 用例 1 (正常路径)：$a=1.0$, $b=1.0$, $m=0.2$, $N_x=32$, $N_y=32$, $\\Delta t_{\\max}=1.0$。\n- 用例 2 (混合项更强的各向异性扩散)：$a=1.0$, $b=0.3$, $m=0.8$, $N_x=64$, $N_y=32$, $\\Delta t_{\\max}=0.5$。\n- 用例 3 (接近椭圆性边界)：$a=1.0$, $b=1.0$, $m=0.9$, $N_x=32$, $N_y=16$, $\\Delta t_{\\max}=0.5$。\n\n最终输出格式：\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。列表中的每个元素是对应一个测试用例的列表 $[\\Delta t_{\\text{PR}},\\Delta t_{\\text{DG}}]$，按上述顺序排列。例如，一个包含三个测试用例的输出必须如下所示：\n$$\n[\\,[\\Delta t_{\\text{PR},1},\\Delta t_{\\text{DG},1}],\\,[\\Delta t_{\\text{PR},2},\\Delta t_{\\text{DG},2}],\\,[\\Delta t_{\\text{PR},3},\\Delta t_{\\text{DG},3}]\\,].\n$$",
            "solution": "该问题被评估为有效。这是一个在偏微分方程 (PDE) 数值分析领域中提法恰当、有科学依据的问题，不含任何无效标准。任务要求推导两种指定的交替方向隐式 (ADI) 格式的放大因子，并实现数值搜索以找到最大稳定时间步长。\n\n分析的关键在于 von Neumann 稳定性分析方法。对于周期域上的常系数线性问题，有限差分算子独立作用于每个傅里叶模式。一个具有空间依赖性 $e^{i(k_x x + k_y y)}$ 的模式在微分时会乘以一个复数，即该算子的符号。此模式的振幅从一个时间步到下一个时间步的演化由放大因子 $g$ 控制。如果对于所有相关波数都有 $|g| \\le 1$，则该格式是稳定的。\n\n给定的微分算子离散傅里叶符号是：\n- $x$ 方向的二阶导数：$\\lambda_{xx}(\\theta_x) = -\\frac{4}{\\Delta x^2} \\sin^2(\\frac{\\theta_x}{2})$\n- $y$ 方向的二阶导数：$\\lambda_{yy}(\\theta_y) = -\\frac{4}{\\Delta y^2} \\sin^2(\\frac{\\theta_y}{2})$\n- 混合导数 $\\partial_{xy}$：$\\lambda_{xy}(\\theta_x, \\theta_y) = -\\frac{\\sin(\\theta_x)\\sin(\\theta_y)}{\\Delta x \\Delta y}$\n其中 $\\theta_x = 2\\pi k_x/N_x$ 且 $\\theta_y = 2\\pi k_y/N_y$。网格间距为 $\\Delta x=1/N_x$ 和 $\\Delta y=1/N_y$。算子 $A = a D_{xx}$、$B = b D_{yy}$ 和 $C = m D_x D_y$ 的符号分别为 $\\lambda_A = a\\lambda_{xx}$、$\\lambda_B = b\\lambda_{yy}$ 和 $\\lambda_C = m\\lambda_{xy}$。这三个符号都是实数值。\n\n设 $u^n$ 和 $u^{n+1}$ 表示单个傅里叶模式在时间层 $n$ 和 $n+1$ 的振幅。放大因子 $g$ 由 $u^{n+1} = g u^n$ 定义。\n\n### 1. Peaceman-Rachford (PR) 格式的放大因子\n该格式由两个阶段定义：\n$$\n\\left(I - \\frac{\\Delta t}{2}A\\right) u^\\star \\;=\\; \\left(I + \\frac{\\Delta t}{2}B + \\Delta t\\,C\\right) u^n\n$$\n$$\n\\left(I - \\frac{\\Delta t}{2}B\\right) u^{n+1} \\;=\\; \\left(I + \\frac{\\Delta t}{2}A\\right) u^\\star\n$$\n在傅里叶空间中，这些方程变成了算子符号的代数操作：\n$$\n\\left(1 - \\frac{\\Delta t}{2}\\lambda_A\\right) u^\\star \\;=\\; \\left(1 + \\frac{\\Delta t}{2}\\lambda_B + \\Delta t\\,\\lambda_C\\right) u^n\n$$\n$$\n\\left(1 - \\frac{\\Delta t}{2}\\lambda_B\\right) u^{n+1} \\;=\\; \\left(1 + \\frac{\\Delta t}{2}\\lambda_A\\right) u^\\star\n$$\n从第一个方程，我们将 $u^\\star$ 表示为 $u^n$ 的函数：\n$$\nu^\\star \\;=\\; \\frac{1 + \\frac{\\Delta t}{2}\\lambda_B + \\Delta t\\,\\lambda_C}{1 - \\frac{\\Delta t}{2}\\lambda_A} u^n\n$$\n将此代入第二个方程，得到：\n$$\n\\left(1 - \\frac{\\Delta t}{2}\\lambda_B\\right) u^{n+1} \\;=\\; \\left(1 + \\frac{\\Delta t}{2}\\lambda_A\\right) \\left( \\frac{1 + \\frac{\\Delta t}{2}\\lambda_B + \\Delta t\\,\\lambda_C}{1 - \\frac{\\Delta t}{2}\\lambda_A} \\right) u^n\n$$\n因此，放大因子 $g_{\\text{PR}} = u^{n+1}/u^n$ 为：\n$$\ng_{\\text{PR}}(\\Delta t; \\theta_x, \\theta_y) \\;=\\; \\frac{1 + \\frac{\\Delta t}{2}\\lambda_A}{1 - \\frac{\\Delta t}{2}\\lambda_A} \\cdot \\frac{1 + \\frac{\\Delta t}{2}\\lambda_B + \\Delta t\\,\\lambda_C}{1 - \\frac{\\Delta t}{2}\\lambda_B}\n$$\n\n### 2. Douglas-Gunn (DG) 格式的放大因子\n该格式是一种带有 Craig-Sneyd 修正的近似分解方法，定义于 $\\theta=1/2$：\n- 预测步：$Y_0 = u^n + \\Delta t\\,(A + B + C)\\,u^n$\n- $x$ 方向校正步：$\\left(I - \\frac{\\Delta t}{2}\\,A\\right) Y_1 = Y_0 - \\frac{\\Delta t}{2}\\,A\\,u^n$\n- $y$ 方向校正步：$\\left(I - \\frac{\\Delta t}{2}\\,B\\right) Y_2 = Y_1 - \\frac{\\Delta t}{2}\\,B\\,u^n$\n- 混合导数修正：$u^{n+1} = Y_2 + \\frac{\\Delta t}{2}\\,C\\,(Y_2 - u^n)$\n\n我们通过用算子符号替换算子来在傅里叶空间中分析该格式。一个更直接的推导方法是将每一步的变化与前一步联系起来。\n从 $x$ 校正步：$Y_1 - u^n = (I - \\frac{\\Delta t}{2}A)^{-1} (Y_0 - u^n)$。\n从 $y$ 校正步：$Y_2 - u^n = (I - \\frac{\\Delta t}{2}B)^{-1} (Y_1 - u^n)$。\n从预测步：$Y_0 - u^n = \\Delta t (A+B+C) u^n$。\n结合这些，得到：\n$$\nY_2 - u^n \\;=\\; \\left(I - \\frac{\\Delta t}{2}B\\right)^{-1} \\left(I - \\frac{\\Delta t}{2}A\\right)^{-1} \\Delta t (A+B+C) u^n\n$$\n最终更新是 $u^{n+1} - u^n = Y_2 - u^n + \\frac{\\Delta t}{2}C(Y_2 - u^n) = (I + \\frac{\\Delta t}{2}C)(Y_2-u^n)$。代入 $Y_2-u^n$ 的表达式给出总更新：\n$$\nu^{n+1} - u^n \\;=\\; \\left(I + \\frac{\\Delta t}{2}C\\right) \\left(I - \\frac{\\Delta t}{2}B\\right)^{-1} \\left(I - \\frac{\\Delta t}{2}A\\right)^{-1} \\Delta t (A+B+C) u^n\n$$\n用符号表示，放大因子 $g_{\\text{DG}}$ 可从 $g_{\\text{DG}} - 1 = (u^{n+1}-u^n)/u^n$ 求得：\n$$\ng_{\\text{DG}}-1 \\;=\\; \\frac{\\left(1 + \\frac{\\Delta t}{2}\\lambda_C\\right) \\Delta t (\\lambda_A+\\lambda_B+\\lambda_C)}{\\left(1 - \\frac{\\Delta t}{2}\\lambda_A\\right)\\left(1 - \\frac{\\Delta t}{2}\\lambda_B\\right)}\n$$\n因此，放大因子为：\n$$\ng_{\\text{DG}}(\\Delta t; \\theta_x, \\theta_y) \\;=\\; 1 \\;+\\; \\frac{\\Delta t (\\lambda_A+\\lambda_B+\\lambda_C) \\left(1 + \\frac{\\Delta t}{2}\\lambda_C\\right)}{\\left(1 - \\frac{\\Delta t}{2}\\lambda_A\\right)\\left(1 - \\frac{\\Delta t}{2}\\lambda_B\\right)}\n$$\n\n### 3. 稳定性条件和数值搜索\n类 CFL 稳定性条件要求放大因子在所有离散波数上的最大模长不超过 $1$：\n$$\nS(\\Delta t) \\;=\\; \\max_{k_x, k_y} |g(\\Delta t; \\theta_x, \\theta_y)| \\;\\le\\; 1\n$$\n其中 $k_x \\in \\{0, \\dots, N_x-1\\}$ 且 $k_y \\in \\{0, \\dots, N_y-1\\}$。我们需要在区间 $[0, \\Delta t_{\\max}]$ 中找到满足此条件的最大 $\\Delta t$。对于我们关心的不稳定模式，函数 $S(\\Delta t)$ 是非递减的。我们可以通过使用数值求根方法求解方程 $S(\\Delta t) - 1 = 0$ 来有效地找到所需的 $\\Delta t$。二分法是完成此任务的一个稳健选择。\n\n搜索算法如下：\n1. 定义一个函数，通过在整个波数网格 $(k_x, k_y)$ 上计算 $|g|$ 并找到最大值，来为给定格式计算 $S(\\Delta t)$。\n2. 对每个格式，设置搜索区间 $[t_{\\text{low}}, t_{\\text{high}}] = [0, \\Delta t_{\\max}]$。\n3. 如果 $S(\\Delta t_{\\max}) \\le 1$，则该格式在整个区间内都是稳定的，解即为 $\\Delta t_{\\max}$。\n4. 否则，在区间内存在 $S(\\Delta t) - 1 = 0$ 的一个根。应用二分法进行固定次数的迭代（例如 100 次），以高精度找到该根。\n    - 令 $t_{\\text{mid}} = (t_{\\text{low}} + t_{\\text{high}})/2$。\n    - 如果 $S(t_{\\text{mid}}) > 1$，则稳定边界位于区间的下半部分，因此设置 $t_{\\text{high}} = t_{\\text{mid}}$。\n    - 如果 $S(t_{\\text{mid}}) \\le 1$，则时间步 $t_{\\text{mid}}$ 是稳定的，因此我们可以通过设置 $t_{\\text{low}} = t_{\\text{mid}}$ 来搜索更大的稳定步长。\n5. $t_{\\text{low}}$ 的最终值是最大允许的 $\\Delta t$。\n对每个提供的测试用例，都为 PR 和 DG 两种格式实施此过程。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef calculate_max_g(dt, params, scheme_name):\n    \"\"\"\n    Calculates the maximum amplification factor magnitude over all wavenumbers.\n    \n    Args:\n        dt (float): The time step.\n        params (tuple): A tuple (a, b, m, Nx, Ny) of problem parameters.\n        scheme_name (str): The name of the scheme, either 'PR' or 'DG'.\n        \n    Returns:\n        float: The maximum absolute value of the amplification factor.\n    \"\"\"\n    a, b, m, Nx, Ny = params\n    \n    # Create grids of discrete wavenumber indices\n    kx = np.arange(Nx)\n    ky = np.arange(Ny)\n    kx_grid, ky_grid = np.meshgrid(kx, ky, indexing='ij')\n\n    # Calculate symbols of the spatial derivative operators\n    # These are real-valued given the specified finite difference stencils.\n    # We use np.errstate to avoid warnings for sin(pi*0/0) which is handled later\n    with np.errstate(divide='ignore', invalid='ignore'):\n        L_A = -4 * a * (Nx**2) * (np.sin(np.pi * kx_grid / Nx)**2)\n        L_B = -4 * b * (Ny**2) * (np.sin(np.pi * ky_grid / Ny)**2)\n        L_C = -m * Nx * Ny * np.sin(2 * np.pi * kx_grid / Nx) * np.sin(2 * np.pi * ky_grid / Ny)\n\n    # For kx=0 or ky=0, the arguments to sin might involve 0/0 -> nan.\n    # The limit is 0, so we replace NaNs with 0.\n    L_A[np.isnan(L_A)] = 0.0\n    L_B[np.isnan(L_B)] = 0.0\n    L_C[np.isnan(L_C)] = 0.0\n\n    # Calculate amplification factor g for the specified scheme\n    if scheme_name == 'PR':\n        # g_PR = (1 + dt/2 * L_A) / (1 - dt/2 * L_A) * (1 + dt/2 * L_B + dt * L_C) / (1 - dt/2 * L_B)\n        term1_num = 1.0 + 0.5 * dt * L_A\n        term1_den = 1.0 - 0.5 * dt * L_A\n        term2_num = 1.0 + 0.5 * dt * L_B + dt * L_C\n        term2_den = 1.0 - 0.5 * dt * L_B\n        g = (term1_num / term1_den) * (term2_num / term2_den)\n    elif scheme_name == 'DG':\n        # g_DG = 1 + dt*(L_A+L_B+L_C)*(1+0.5*dt*L_C) / ((1-0.5*dt*L_A)*(1-0.5*dt*L_B))\n        num = dt * (L_A + L_B + L_C) * (1.0 + 0.5 * dt * L_C)\n        den = (1.0 - 0.5 * dt * L_A) * (1.0 - 0.5 * dt * L_B)\n        g = 1.0 + num / den\n    else:\n        raise ValueError(\"Unknown scheme name provided\")\n\n    # Return the maximum magnitude (spectral radius of the one-step operator)\n    return np.max(np.abs(g))\n\ndef find_stable_dt(params, scheme_name, dt_max):\n    \"\"\"\n    Finds the largest stable time step dt using bisection search.\n    \n    Args:\n        params (tuple): A tuple (a, b, m, Nx, Ny) of problem parameters.\n        scheme_name (str): The name of the scheme, either 'PR' or 'DG'.\n        dt_max (float): The upper bound for the search interval [0, dt_max].\n        \n    Returns:\n        float: The largest time step dt for which the scheme is stable.\n    \"\"\"\n    # If the scheme is stable even at dt_max, then that's the answer.\n    if calculate_max_g(dt_max, params, scheme_name) = 1.0:\n        return dt_max\n\n    low = 0.0\n    high = dt_max\n    \n    # Bisection search for 100 iterations provides high precision.\n    for _ in range(100):\n        mid = (low + high) / 2.0\n        # Check for convergence to machine precision limit\n        if mid == low or mid == high:\n            break\n        \n        if calculate_max_g(mid, params, scheme_name) > 1.0:\n            high = mid  # mid is unstable, search in lower half\n        else:\n            low = mid   # mid is stable, search in upper half\n            \n    return low\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for all test cases.\n    \"\"\"\n    test_cases = [\n        # Case 1 (happy path)\n        (1.0, 1.0, 0.2, 32, 32, 1.0),\n        # Case 2 (anisotropic diffusion with stronger mixed term)\n        (1.0, 0.3, 0.8, 64, 32, 0.5),\n        # Case 3 (near the ellipticity boundary)\n        (1.0, 1.0, 0.9, 32, 16, 0.5),\n    ]\n\n    results = []\n    for case in test_cases:\n        a, b, m, Nx, Ny, dt_max = case\n        params = (a, b, m, Nx, Ny)\n        \n        dt_pr = find_stable_dt(params, 'PR', dt_max)\n        dt_dg = find_stable_dt(params, 'DG', dt_max)\n        \n        results.append([dt_pr, dt_dg])\n\n    # Final print statement in the exact required format.\n    # Example format: [[dt_PR1, dt_DG1], [dt_PR2, dt_DG2], [dt_PR3, dt_DG3]]\n    output_str = f\"[{','.join([str(p) for p in results])}]\"\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}