{
    "hands_on_practices": [
        {
            "introduction": "To build a solid foundation, our first practice revisits the classic two-dimensional heat equation. You will apply Von Neumann stability analysis to the Peaceman-Rachford scheme, a cornerstone technique for analyzing linear difference equations. This exercise will allow you to derive the amplification factor and confirm the scheme's celebrated unconditional stability for this model problem .",
            "id": "3429863",
            "problem": "Consider the two-dimensional constant-coefficient heat equation\n$$\nu_{t} \\;=\\; \\alpha_{x}\\,u_{xx} \\;+\\; \\alpha_{y}\\,u_{yy},\n$$\nposed on an infinite uniform lattice with spacings $$h_{x}$$ and $$h_{y}$$ in the $$x$$ and $$y$$ directions, respectively. Let $$u_{i,j}^{n}$$ denote the discrete approximation to $$u(x_{i},y_{j},t_{n})$$, where $$x_{i} = i\\,h_{x}$$, $$y_{j} = j\\,h_{y}$$, and $$t_{n} = n\\,\\Delta t$$. Define the standard second-order central-difference operators\n$$\n(D_{xx} u)_{i,j} \\;=\\; \\frac{u_{i+1,j} - 2u_{i,j} + u_{i-1,j}}{h_{x}^{2}}, \n\\qquad\n(D_{yy} u)_{i,j} \\;=\\; \\frac{u_{i,j+1} - 2u_{i,j} + u_{i,j-1}}{h_{y}^{2}}.\n$$\nConsider the Peaceman–Rachford scheme, a classical Alternating Direction Implicit (ADI) method, defined by the two substeps\n$$\n\\bigl(I \\;-\\; \\tfrac{\\Delta t}{2}\\,\\alpha_{x}\\,D_{xx}\\bigr)\\,u^{n+\\frac{1}{2}} \\;=\\; \\bigl(I \\;+\\; \\tfrac{\\Delta t}{2}\\,\\alpha_{y}\\,D_{yy}\\bigr)\\,u^{n},\n$$\n$$\n\\bigl(I \\;-\\; \\tfrac{\\Delta t}{2}\\,\\alpha_{y}\\,D_{yy}\\bigr)\\,u^{n+1} \\;=\\; \\bigl(I \\;+\\; \\tfrac{\\Delta t}{2}\\,\\alpha_{x}\\,D_{xx}\\bigr)\\,u^{n+\\frac{1}{2}}.\n$$\nAssume spatial periodicity so that Von Neumann (Fourier) mode analysis applies. Using the Fourier ansatz $$u_{i,j}^{n} \\;=\\; \\zeta^{n}\\,\\exp\\!\\bigl(\\mathrm{i}\\,(i\\,\\xi + j\\,\\eta)\\bigr)$$ with $$\\xi,\\eta \\in [0,2\\pi]$$, derive the amplification factor $$G(\\xi,\\eta)$$ for the full time step from $$t_{n}$$ to $$t_{n+1}$$. Then, in terms of the non-dimensional parameters\n$$\nr_{x} \\;=\\; \\frac{\\alpha_{x}\\,\\Delta t}{h_{x}^{2}},\n\\qquad\nr_{y} \\;=\\; \\frac{\\alpha_{y}\\,\\Delta t}{h_{y}^{2}},\n$$\ndetermine the exact value of\n$$\n\\sup_{\\xi,\\eta \\in [0,2\\pi]} \\,\\bigl|G(\\xi,\\eta)\\bigr|.\n$$\nExpress your final answer as a single exact real number. No rounding is required.",
            "solution": "The starting point is the constant-coefficient parabolic partial differential equation $$u_{t} = \\alpha_{x} u_{xx} + \\alpha_{y} u_{yy}$$. On a uniform lattice with periodicity, Von Neumann analysis is performed by inserting a single Fourier mode into the discrete scheme and tracking the multiplicative factor over one time step. For the second-order centered difference operators,\n$$\n(D_{xx} u)_{i,j} \\;=\\; \\frac{u_{i+1,j} - 2u_{i,j} + u_{i-1,j}}{h_{x}^{2}},\n\\qquad\n(D_{yy} u)_{i,j} \\;=\\; \\frac{u_{i,j+1} - 2u_{i,j} + u_{i,j-1}}{h_{y}^{2}},\n$$\nthe discrete Fourier symbols (eigenvalues) when acting on a mode $$u_{i,j} = \\exp\\!\\bigl(\\mathrm{i}\\,(i\\,\\xi + j\\,\\eta)\\bigr)$$ are given by well-known identities. Specifically,\n$$\n\\lambda_{x}(\\xi) \\;=\\; -\\frac{4}{h_{x}^{2}}\\sin^{2}\\!\\Bigl(\\frac{\\xi}{2}\\Bigr),\n\\qquad\n\\lambda_{y}(\\eta) \\;=\\; -\\frac{4}{h_{y}^{2}}\\sin^{2}\\!\\Bigl(\\frac{\\eta}{2}\\Bigr).\n$$\nThese follow from the trigonometric identity $$\\exp(\\mathrm{i}\\xi) + \\exp(-\\mathrm{i}\\xi) - 2 = 2(\\cos\\xi - 1) = -4\\sin^{2}(\\xi/2)$$ and the definitions of $$D_{xx},D_{yy}$$.\n\nIntroduce the non-dimensional parameters\n$$\nr_{x} \\;=\\; \\frac{\\alpha_{x}\\,\\Delta t}{h_{x}^{2}},\n\\qquad\nr_{y} \\;=\\; \\frac{\\alpha_{y}\\,\\Delta t}{h_{y}^{2}}.\n$$\nDefine the half-step coefficients\n$$\na_{x}(\\xi) \\;=\\; \\frac{\\Delta t}{2}\\,\\alpha_{x}\\,\\lambda_{x}(\\xi) \\;=\\; -2\\,r_{x}\\,\\sin^{2}\\!\\Bigl(\\frac{\\xi}{2}\\Bigr),\n\\qquad\na_{y}(\\eta) \\;=\\; \\frac{\\Delta t}{2}\\,\\alpha_{y}\\,\\lambda_{y}(\\eta) \\;=\\; -2\\,r_{y}\\,\\sin^{2}\\!\\Bigl(\\frac{\\eta}{2}\\Bigr).\n$$\nConsider the Peaceman–Rachford scheme substeps applied to a single Fourier mode. The first substep\n$$\n\\bigl(I - \\tfrac{\\Delta t}{2}\\alpha_{x}D_{xx}\\bigr) u^{n+\\frac{1}{2}} \\;=\\; \\bigl(I + \\tfrac{\\Delta t}{2}\\alpha_{y}D_{yy}\\bigr) u^{n}\n$$\nproduces, in Fourier space,\n$$\n\\bigl(1 - a_{x}(\\xi)\\bigr)\\,\\widehat{u}^{\\,n+\\frac{1}{2}} \\;=\\; \\bigl(1 + a_{y}(\\eta)\\bigr)\\,\\widehat{u}^{\\,n}.\n$$\nTherefore,\n$$\n\\widehat{u}^{\\,n+\\frac{1}{2}} \\;=\\; \\frac{1 + a_{y}(\\eta)}{1 - a_{x}(\\xi)}\\,\\widehat{u}^{\\,n}.\n$$\nThe second substep\n$$\n\\bigl(I - \\tfrac{\\Delta t}{2}\\alpha_{y}D_{yy}\\bigr) u^{n+1} \\;=\\; \\bigl(I + \\tfrac{\\Delta t}{2}\\alpha_{x}D_{xx}\\bigr) u^{n+\\frac{1}{2}}\n$$\ngives\n$$\n\\bigl(1 - a_{y}(\\eta)\\bigr)\\,\\widehat{u}^{\\,n+1} \\;=\\; \\bigl(1 + a_{x}(\\xi)\\bigr)\\,\\widehat{u}^{\\,n+\\frac{1}{2}}.\n$$\nSubstituting the expression for $$\\widehat{u}^{\\,n+\\frac{1}{2}}$$ yields the one-step amplification factor $$G(\\xi,\\eta)$$:\n$$\n\\widehat{u}^{\\,n+1} \\;=\\; \\frac{1 + a_{x}(\\xi)}{1 - a_{y}(\\eta)} \\cdot \\frac{1 + a_{y}(\\eta)}{1 - a_{x}(\\xi)}\\,\\widehat{u}^{\\,n}\n\\;\\;\\Rightarrow\\;\\;\nG(\\xi,\\eta) \\;=\\; \\frac{\\bigl(1 + a_{x}(\\xi)\\bigr)\\bigl(1 + a_{y}(\\eta)\\bigr)}{\\bigl(1 - a_{x}(\\xi)\\bigr)\\bigl(1 - a_{y}(\\eta)\\bigr)}.\n$$\nIn terms of $$r_{x},r_{y}$$ and trigonometric factors,\n$$\n1 + a_{x}(\\xi) \\;=\\; 1 - 2\\,r_{x}\\,\\sin^{2}\\!\\Bigl(\\frac{\\xi}{2}\\Bigr), \\qquad\n1 - a_{x}(\\xi) \\;=\\; 1 + 2\\,r_{x}\\,\\sin^{2}\\!\\Bigl(\\frac{\\xi}{2}\\Bigr),\n$$\nand similarly for $$y$$. Therefore,\n$$\nG(\\xi,\\eta) \\;=\\; \n\\frac{\\bigl(1 - 2\\,r_{x}\\,\\sin^{2}(\\xi/2)\\bigr)\\bigl(1 - 2\\,r_{y}\\,\\sin^{2}(\\eta/2)\\bigr)}\n{\\bigl(1 + 2\\,r_{x}\\,\\sin^{2}(\\xi/2)\\bigr)\\bigl(1 + 2\\,r_{y}\\,\\sin^{2}(\\eta/2)\\bigr)}.\n$$\nTo determine the stability bound via Von Neumann analysis, we examine the magnitude:\n$$\n\\bigl|G(\\xi,\\eta)\\bigr| \\;=\\; \n\\left|\\frac{1 - 2\\,r_{x}\\,\\sin^{2}(\\xi/2)}{1 + 2\\,r_{x}\\,\\sin^{2}(\\xi/2)}\\right|\n\\cdot\n\\left|\\frac{1 - 2\\,r_{y}\\,\\sin^{2}(\\eta/2)}{1 + 2\\,r_{y}\\,\\sin^{2}(\\eta/2)}\\right|.\n$$\nLet $$a \\;=\\; 2\\,r_{x}\\,\\sin^{2}(\\xi/2) \\ge 0$$ and $$b \\;=\\; 2\\,r_{y}\\,\\sin^{2}(\\eta/2) \\ge 0$$. Then each factor is\n$$\nf(a) \\;=\\; \\left|\\frac{1 - a}{1 + a}\\right|, \\qquad g(b) \\;=\\; \\left|\\frac{1 - b}{1 + b}\\right|.\n$$\nFor $$a \\ge 0$$, the function $f(a)$ is always less than or equal to $1$. The maximum value of $1$ is attained at $a=0$ or as $a \\to \\infty$. The same holds for $g(b)$. Consequently,\n$$\n\\bigl|G(\\xi,\\eta)\\bigr| \\;=\\; f(a)\\,g(b) \\;\\le\\; 1,\n$$\nand the supremum over $$\\xi,\\eta \\in [0,2\\pi]$$ is achieved when either $$a = 0$$ or $$b=0$$ (which occurs, for example, at $$\\xi = 0$$ or $$\\eta = 0$$), yielding\n$$\n\\sup_{\\xi,\\eta \\in [0,2\\pi]} \\,\\bigl|G(\\xi,\\eta)\\bigr| \\;=\\; 1.\n$$\nThis shows the Peaceman–Rachford Alternating Direction Implicit scheme is unconditionally stable for the two-dimensional constant-coefficient heat equation, and the exact supremum of the amplification factor magnitude is $$1$$.",
            "answer": "$$\\boxed{1}$$"
        },
        {
            "introduction": "Idealized models are a great start, but real-world diffusion is often anisotropic and may include cross-derivative terms like $u_{xy}$. These terms complicate the application of ADI methods, as they cannot be neatly split along coordinate directions and can disrupt stability. This practice challenges you to analyze a Peaceman-Rachford scheme where the mixed derivative is handled explicitly, a common strategy that introduces a stability constraint you will quantify through the amplification factor .",
            "id": "3429906",
            "problem": "Consider the two-dimensional anisotropic diffusion partial differential equation (PDE)\n$$\nu_{t} \\;=\\; a\\,u_{xx} \\;+\\; 2b\\,u_{xy} \\;+\\; c\\,u_{yy},\n$$\nwith constant coefficients $a>0$, $c>0$, and $ac-b^{2}>0$ so that the diffusion tensor is positive definite. Discretize space on an infinite, uniform Cartesian grid with mesh width $h$ in both directions. Approximate $u_{xx}$ and $u_{yy}$ using second-order centered differences, and approximate $u_{xy}$ using the standard second-order mixed centered difference\n$$\nu_{xy}(x_{i},y_{j}) \\;\\approx\\; \\frac{u_{i+1,j+1} \\;-\\; u_{i+1,j-1} \\;-\\; u_{i-1,j+1} \\;+\\; u_{i-1,j-1}}{4h^{2}}.\n$$\nApply the Peaceman–Rachford alternating direction implicit (ADI) scheme, in which the mixed derivative term is treated explicitly. Denote by $L_{x}$ and $L_{y}$ the discrete one-dimensional second derivative operators in the $x$- and $y$-directions, scaled by $a$ and $c$, respectively, and by $M$ the discrete mixed derivative operator scaled by $2b$. Let $\\Delta t$ be the time step and write $\\rho = \\Delta t / h^{2}$. The Peaceman–Rachford ADI update for $u^{n} \\mapsto u^{n+1}$ is\n$$\n\\bigl(I \\;-\\; \\tfrac{\\Delta t}{2}\\,L_{x}\\bigr)\\,\\bigl(I \\;-\\; \\tfrac{\\Delta t}{2}\\,L_{y}\\bigr)\\,u^{n+1}\n\\;=\\;\n\\bigl(I \\;+\\; \\tfrac{\\Delta t}{2}\\,L_{x}\\bigr)\\,\\bigl(I \\;+\\; \\tfrac{\\Delta t}{2}\\,L_{y}\\bigr)\\,u^{n}\n\\;+\\;\n\\Delta t\\,M\\,u^{n}.\n$$\nUsing Fourier analysis with the mode $u_{i,j}^{n} = \\widehat{u}^{n}\\,\\exp\\!\\bigl(i(k_{x} i h + k_{y} j h)\\bigr)$, derive the one-step amplification factor $G(k_{x},k_{y})$ for this scheme in terms of $a$, $b$, $c$, $\\rho$, $k_{x}$, and $k_{y}$. Then evaluate $G$ for the parameter values $a=1$, $b=\\tfrac{3}{2}$, $c=4$, $\\rho=\\tfrac{1}{5}$, $k_{x} h = \\tfrac{\\pi}{3}$, and $k_{y} h = \\tfrac{\\pi}{4}$, and express the final result as a single closed-form analytic expression. Do not round your answer.",
            "solution": "To derive the amplification factor $G$, we analyze how the scheme acts on a single Fourier mode $u_{i,j}^{n} = \\widehat{u}^{n}\\,\\exp\\!\\bigl(i(\\theta_x i + \\theta_y j)\\bigr)$, where $\\theta_x = k_x h$ and $\\theta_y = k_y h$. The amplification factor is defined by $G = \\widehat{u}^{n+1} / \\widehat{u}^{n}$.\n\nWe first find the eigenvalues of the discrete operators $L_x$, $L_y$, and $M$ corresponding to this Fourier mode.\nThe standard second-order centered difference for $u_{xx}$ is $\\frac{u_{i+1,j} - 2u_{i,j} + u_{i-1,j}}{h^2}$. The operator $L_x$ is this expression scaled by $a$. Applying $L_x$ to the Fourier mode gives the eigenvalue:\n$$\n\\lambda_{L_x} = \\frac{a}{h^2} (e^{i\\theta_x} - 2 + e^{-i\\theta_x}) = \\frac{a}{h^2} (2\\cos(\\theta_x) - 2) = -\\frac{4a}{h^2} \\sin^2\\left(\\frac{\\theta_x}{2}\\right)\n$$\nSimilarly, for $L_y$ acting in the $y$-direction:\n$$\n\\lambda_{L_y} = -\\frac{4c}{h^2} \\sin^2\\left(\\frac{\\theta_y}{2}\\right)\n$$\nFor the mixed derivative operator $M$, using the given centered difference scheme for $2b u_{xy}$:\n$$\n\\lambda_M = \\frac{2b}{4h^2} \\left( e^{i(\\theta_x+\\theta_y)} - e^{i(\\theta_x-\\theta_y)} - e^{i(-\\theta_x+\\theta_y)} + e^{i(-\\theta_x-\\theta_y)} \\right) = \\frac{b}{2h^2} (e^{i\\theta_x} - e^{-i\\theta_x})(e^{i\\theta_y} - e^{-i\\theta_y})\n$$\n$$\n\\lambda_M = \\frac{b}{2h^2} (2i\\sin(\\theta_x))(2i\\sin(\\theta_y)) = -\\frac{2b}{h^2} \\sin(\\theta_x)\\sin(\\theta_y)\n$$\nNow, we substitute these eigenvalues into the ADI scheme equation. In Fourier space, the operators are replaced by their eigenvalues and $u^{n+1}$ by $G u^n$:\n$$\n\\left(1 - \\frac{\\Delta t}{2}\\lambda_{L_x}\\right)\\left(1 - \\frac{\\Delta t}{2}\\lambda_{L_y}\\right) G = \\left(1 + \\frac{\\Delta t}{2}\\lambda_{L_x}\\right)\\left(1 + \\frac{\\Delta t}{2}\\lambda_{L_y}\\right) + \\Delta t \\lambda_M\n$$\nSolving for $G$:\n$$\nG(k_x, k_y) = \\frac{\\left(1 + \\frac{\\Delta t}{2}\\lambda_{L_x}\\right)\\left(1 + \\frac{\\Delta t}{2}\\lambda_{L_y}\\right) + \\Delta t \\lambda_M}{\\left(1 - \\frac{\\Delta t}{2}\\lambda_{L_x}\\right)\\left(1 - \\frac{\\Delta t}{2}\\lambda_{L_y}\\right)}\n$$\nSubstituting the eigenvalue expressions and using $\\rho=\\Delta t/h^2$:\n$\\frac{\\Delta t}{2}\\lambda_{L_x} = -2\\rho a \\sin^2(\\frac{k_x h}{2})$,\n$\\frac{\\Delta t}{2}\\lambda_{L_y} = -2\\rho c \\sin^2(\\frac{k_y h}{2})$,\n$\\Delta t \\lambda_M = -2\\rho b \\sin(k_x h)\\sin(k_y h)$.\nThe amplification factor is:\n$$\nG(k_x, k_y) = \\frac{\\left(1 - 2\\rho a \\sin^2\\left(\\frac{k_x h}{2}\\right)\\right)\\left(1 - 2\\rho c \\sin^2\\left(\\frac{k_y h}{2}\\right)\\right) - 2\\rho b \\sin(k_x h)\\sin(k_y h)}{\\left(1 + 2\\rho a \\sin^2\\left(\\frac{k_x h}{2}\\right)\\right)\\left(1 + 2\\rho c \\sin^2\\left(\\frac{k_y h}{2}\\right)\\right)}\n$$\nFor the second part, we evaluate $G$ for: $a=1$, $b=\\tfrac{3}{2}$, $c=4$, $\\rho=\\tfrac{1}{5}$, $\\theta_x = k_x h = \\tfrac{\\pi}{3}$, and $\\theta_y = k_y h = \\tfrac{\\pi}{4}$.\nDenominator terms:\n$1 + 2\\rho a \\sin^2(\\frac{\\theta_x}{2}) = 1 + 2(\\frac{1}{5})(1)\\sin^2(\\frac{\\pi}{6}) = 1 + \\frac{2}{5}(\\frac{1}{2})^2 = 1 + \\frac{1}{10} = \\frac{11}{10}$.\n$1 + 2\\rho c \\sin^2(\\frac{\\theta_y}{2}) = 1 + 2(\\frac{1}{5})(4)\\sin^2(\\frac{\\pi}{8}) = 1 + \\frac{8}{5}\\left(\\frac{1-\\cos(\\frac{\\pi}{4})}{2}\\right) = 1 + \\frac{4}{5}\\left(1 - \\frac{\\sqrt{2}}{2}\\right) = \\frac{5 + 4-2\\sqrt{2}}{5} = \\frac{9-2\\sqrt{2}}{5}$.\nDenominator = $(\\frac{11}{10})(\\frac{9-2\\sqrt{2}}{5}) = \\frac{99-22\\sqrt{2}}{50}$.\n\nNumerator terms:\n$1 - 2\\rho a \\sin^2(\\frac{\\theta_x}{2}) = 1 - \\frac{1}{10} = \\frac{9}{10}$.\n$1 - 2\\rho c \\sin^2(\\frac{\\theta_y}{2}) = 1 - \\frac{4-2\\sqrt{2}}{5} = \\frac{1+2\\sqrt{2}}{5}$.\nThe mixed derivative term:\n$-2\\rho b \\sin(\\theta_x)\\sin(\\theta_y) = -2(\\frac{1}{5})(\\frac{3}{2})\\sin(\\frac{\\pi}{3})\\sin(\\frac{\\pi}{4}) = -\\frac{3}{5}\\left(\\frac{\\sqrt{3}}{2}\\right)\\left(\\frac{\\sqrt{2}}{2}\\right) = -\\frac{3\\sqrt{6}}{20}$.\nNumerator = $(\\frac{9}{10})(\\frac{1+2\\sqrt{2}}{5}) - \\frac{3\\sqrt{6}}{20} = \\frac{9+18\\sqrt{2}}{50} - \\frac{3\\sqrt{6}}{20} = \\frac{18+36\\sqrt{2}}{100} - \\frac{15\\sqrt{6}}{100} = \\frac{18+36\\sqrt{2}-15\\sqrt{6}}{100}$.\n\nCombining numerator and denominator for $G$:\n$$\nG = \\frac{\\frac{18+36\\sqrt{2}-15\\sqrt{6}}{100}}{\\frac{99-22\\sqrt{2}}{50}} = \\frac{18+36\\sqrt{2}-15\\sqrt{6}}{100} \\cdot \\frac{50}{99-22\\sqrt{2}} = \\frac{18+36\\sqrt{2}-15\\sqrt{6}}{2(99-22\\sqrt{2})}\n$$\nTo obtain a closed-form expression, we rationalize the denominator by multiplying the numerator and denominator by $9+2\\sqrt{2}$:\nDenominator: $2(99-22\\sqrt{2}) = 22(9-2\\sqrt{2})$. So the rationalized denominator is $22(9-2\\sqrt{2})(9+2\\sqrt{2}) = 22(81 - 8) = 22 \\cdot 73 = 1606$.\nNumerator: $(18+36\\sqrt{2}-15\\sqrt{6}) \\cdot \\frac{1}{2} \\cdot (9+2\\sqrt{2})$. The original numerator was already divided by 2.\nLet's recalculate the numerator.\n$(18+36\\sqrt{2}-15\\sqrt{6})(9+2\\sqrt{2}) = 18(9) + 18(2\\sqrt{2}) + 36\\sqrt{2}(9) + 36\\sqrt{2}(2\\sqrt{2}) - 15\\sqrt{6}(9) - 15\\sqrt{6}(2\\sqrt{2})$\n$= 162 + 36\\sqrt{2} + 324\\sqrt{2} + 144 - 135\\sqrt{6} - 30\\sqrt{12}$\n$= (162+144) + (36+324)\\sqrt{2} - 135\\sqrt{6} - 30(2\\sqrt{3})$\n$= 306 + 360\\sqrt{2} - 60\\sqrt{3} - 135\\sqrt{6}$.\nThis has to be divided by 2 from the previous step. So the final numerator is $(306 + 360\\sqrt{2} - 60\\sqrt{3} - 135\\sqrt{6})/2 = 153 + 180\\sqrt{2} - 30\\sqrt{3} - 67.5\\sqrt{6}$. This is getting messy. Let's re-verify from `G`.\n$$\nG = \\frac{3(6+12\\sqrt{2}-5\\sqrt{6})}{22(9-2\\sqrt{2})}\n$$\nNumerator of this form is $3(6+12\\sqrt{2}-5\\sqrt{6})(9+2\\sqrt{2})$\n$= 3 [ 54+12\\sqrt{2} + 108\\sqrt{2}+48 - 45\\sqrt{6} - 10\\sqrt{12} ]$\n$= 3 [ 102 + 120\\sqrt{2} - 45\\sqrt{6} - 20\\sqrt{3} ]$\n$= 306 + 360\\sqrt{2} - 135\\sqrt{6} - 60\\sqrt{3}$\nSo the final expression for $G$ is:\n$$\nG = \\frac{306 + 360\\sqrt{2} - 60\\sqrt{3} - 135\\sqrt{6}}{1606}\n$$",
            "answer": "$$\\boxed{\\frac{306 + 360\\sqrt{2} - 60\\sqrt{3} - 135\\sqrt{6}}{1606}}$$"
        },
        {
            "introduction": "The final step in mastering these schemes is translating theoretical analysis into practical, quantitative results. While analytical formulas for amplification factors are insightful, they must be evaluated to determine concrete stability limits for a given discretization. This exercise asks you to write a program that numerically searches for the maximum stable timestep $\\Delta t$ for ADI schemes with mixed derivatives, including both the Peaceman-Rachford and Douglas-Gunn variants, thereby bridging the gap between mathematical theory and computational practice .",
            "id": "3429916",
            "problem": "Consider the two-dimensional linear parabolic partial differential equation on the unit square with periodic boundary conditions,\n$$\n\\frac{\\partial u}{\\partial t} \\;=\\; a\\,\\frac{\\partial^2 u}{\\partial x^2} \\;+\\; b\\,\\frac{\\partial^2 u}{\\partial y^2} \\;+\\; m\\,\\frac{\\partial^2 u}{\\partial x\\,\\partial y},\n$$\nwhere $a&gt;0$, $b&gt;0$, and $m\\in\\mathbb{R}$ are constant coefficients satisfying the strong ellipticity condition $m^2 &lt; 4ab$. Let $N_x$ and $N_y$ be the number of grid points in the $x$ and $y$ directions, respectively, with uniform spacings $\\Delta x = 1/N_x$ and $\\Delta y = 1/N_y$. Use second-order centered finite differences for the second derivatives and the standard second-order central-difference composition for the mixed derivative, i.e., approximate $\\partial^2 u/\\partial x\\,\\partial y$ by applying the centered first derivative in $x$ followed by the centered first derivative in $y$.\n\nDefine the splitting operators\n$$\nA \\;=\\; a\\,D_{xx},\\qquad B \\;=\\; b\\,D_{yy},\\qquad C \\;=\\; m\\,D_x D_y,\n$$\nwhere $D_{xx}$ and $D_{yy}$ denote the discrete second-derivative operators in $x$ and $y$, respectively, and $D_x$, $D_y$ denote the discrete centered first-derivative operators. Consider two Alternating Direction Implicit (ADI) schemes:\n\n1. The Peaceman-Rachford scheme, where the mixed derivative is treated explicitly:\n   - Stage 1: solve\n     $$\n     \\left(I - \\frac{\\Delta t}{2}A\\right) u^\\star \\;=\\; \\left(I + \\frac{\\Delta t}{2}B + \\Delta t\\,C\\right) u^n.\n     $$\n   - Stage 2: solve\n     $$\n     \\left(I - \\frac{\\Delta t}{2}B\\right) u^{n+1} \\;=\\; \\left(I + \\frac{\\Delta t}{2}A\\right) u^\\star.\n     $$\n\n2. The Douglas-Gunn scheme with a Craig-Sneyd-type mixed-derivative correction at parameter $\\theta = 1/2$:\n   - Predictor:\n     $$\n     Y_0 \\;=\\; u^n \\;+\\; \\Delta t\\,(A + B + C)\\,u^n.\n     $$\n   - Corrector in $x$:\n     $$\n     \\left(I - \\theta\\,\\Delta t\\,A\\right) Y_1 \\;=\\; Y_0 \\;-\\; \\theta\\,\\Delta t\\,A\\,u^n.\n     $$\n   - Corrector in $y$:\n     $$\n     \\left(I - \\theta\\,\\Delta t\\,B\\right) Y_2 \\;=\\; Y_1 \\;-\\; \\theta\\,\\Delta t\\,B\\,u^n.\n     $$\n   - Mixed-derivative correction:\n     $$\n     u^{n+1} \\;=\\; Y_2 \\;+\\; (1 - \\theta)\\,\\Delta t\\,C\\,(Y_2 - u^n).\n     $$\n\nUnder periodic boundary conditions, each discrete Fourier mode decouples. For wavenumbers $\\theta_x = 2\\pi k_x/N_x$ and $\\theta_y = 2\\pi k_y/N_y$, the centered finite-difference symbols are\n$$\n\\lambda_{xx}(\\theta_x) \\;=\\; -\\frac{4}{\\Delta x^2} \\sin^2\\!\\left(\\frac{\\theta_x}{2}\\right),\\quad\n\\lambda_{yy}(\\theta_y) \\;=\\; -\\frac{4}{\\Delta y^2} \\sin^2\\!\\left(\\frac{\\theta_y}{2}\\right),\\quad\n\\lambda_x(\\theta_x) \\;=\\; \\frac{i}{\\Delta x}\\,\\sin(\\theta_x),\\quad\n\\lambda_y(\\theta_y) \\;=\\; \\frac{i}{\\Delta y}\\,\\sin(\\theta_y),\n$$\nso that the mixed derivative symbol is\n$$\n\\lambda_{xy}(\\theta_x,\\theta_y) \\;=\\; \\lambda_x(\\theta_x)\\,\\lambda_y(\\theta_y) \\;=\\; -\\,\\frac{\\sin(\\theta_x)\\,\\sin(\\theta_y)}{\\Delta x\\,\\Delta y}.\n$$\nThe corresponding operator symbols are $\\lambda_A = a\\,\\lambda_{xx}$, $\\lambda_B = b\\,\\lambda_{yy}$, and $\\lambda_C = m\\,\\lambda_{xy}$.\n\nDefine the one-step amplification factor $g(\\Delta t;\\theta_x,\\theta_y)$ for each scheme as the scalar by which a Fourier mode is multiplied after one time step. A Courant–Friedrichs–Lewy-like (CFL-like) stability condition requires\n$$\n\\max_{\\theta_x,\\theta_y}\\,\\left|g(\\Delta t;\\theta_x,\\theta_y)\\right| \\;\\le\\; 1.\n$$\n\nTask:\n- Derive, from the scheme definitions and the Fourier symbols above, the scalar amplification $g(\\Delta t;\\theta_x,\\theta_y)$ for each scheme.\n- Implement a program that, for given $(a,b,m,N_x,N_y)$, finds the largest $\\Delta t$ in the interval $[0,\\Delta t_{\\max}]$ such that the CFL-like condition holds, using the discrete set of wavenumbers $\\theta_x = 2\\pi k_x/N_x$ and $\\theta_y = 2\\pi k_y/N_y$ with $k_x = 0,\\dots,N_x-1$ and $k_y = 0,\\dots,N_y-1$. Use $\\Delta t_{\\max}$ as provided in the test suite for each case. Your search should produce a floating-point value. No physical units are required.\n- Your program must compute this largest admissible $\\Delta t$ for both schemes and return the pair $[\\Delta t_{\\text{PR}},\\Delta t_{\\text{DG}}]$ for each test case.\n\nTest suite:\n- Case 1 (happy path): $a=1.0$, $b=1.0$, $m=0.2$, $N_x=32$, $N_y=32$, $\\Delta t_{\\max}=1.0$.\n- Case 2 (anisotropic diffusion with stronger mixed term): $a=1.0$, $b=0.3$, $m=0.8$, $N_x=64$, $N_y=32$, $\\Delta t_{\\max}=0.5$.\n- Case 3 (near the ellipticity boundary): $a=1.0$, $b=1.0$, $m=0.9$, $N_x=32$, $N_y=16$, $\\Delta t_{\\max}=0.5$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is the list $[\\Delta t_{\\text{PR}},\\Delta t_{\\text{DG}}]$ for one test case, in the order above. For example, an output with three test cases must look like\n$$\n[\\,[\\Delta t_{\\text{PR},1},\\Delta t_{\\text{DG},1}],\\,[\\Delta t_{\\text{PR},2},\\Delta t_{\\text{DG},2}],\\,[\\Delta t_{\\text{PR},3},\\Delta t_{\\text{DG},3}]\\,].\n$$",
            "solution": "The task requires deriving the amplification factors for two specified Alternating Direction Implicit (ADI) schemes and implementing a numerical search for the maximum stable time step. The analysis hinges on the von Neumann stability method. For linear problems with constant coefficients on a periodic domain, the finite difference operators act on each Fourier mode independently. The evolution of the amplitude of this mode from one time step to the next is governed by the amplification factor $g$. The scheme is stable if $|g| \\le 1$ for all relevant wavenumbers.\n\nThe discrete Fourier symbols for the differential operators are given. Let $u^n$ and $u^{n+1}$ represent the amplitudes of a single Fourier mode at time levels $n$ and $n+1$. The amplification factor $g$ is defined by $u^{n+1} = g u^n$.\n\n### 1. Amplification Factor for the Peaceman-Rachford (PR) Scheme\nThe scheme is defined by two stages. In Fourier space, these equations become algebraic manipulations of the operator symbols ($\\lambda_A, \\lambda_B, \\lambda_C$):\n$$\n\\left(1 - \\frac{\\Delta t}{2}\\lambda_A\\right) u^\\star \\;=\\; \\left(1 + \\frac{\\Delta t}{2}\\lambda_B + \\Delta t\\,\\lambda_C\\right) u^n\n$$\n$$\n\\left(1 - \\frac{\\Delta t}{2}\\lambda_B\\right) u^{n+1} \\;=\\; \\left(1 + \\frac{\\Delta t}{2}\\lambda_A\\right) u^\\star\n$$\nFrom the first equation, we express $u^\\star$ in terms of $u^n$ and substitute this into the second equation. This yields the amplification factor $g_{\\text{PR}} = u^{n+1}/u^n$:\n$$\ng_{\\text{PR}}(\\Delta t; \\theta_x, \\theta_y) \\;=\\; \\frac{1 + \\frac{\\Delta t}{2}\\lambda_A}{1 - \\frac{\\Delta t}{2}\\lambda_A} \\cdot \\frac{1 + \\frac{\\Delta t}{2}\\lambda_B + \\Delta t\\,\\lambda_C}{1 - \\frac{\\Delta t}{2}\\lambda_B}\n$$\n\n### 2. Amplification Factor for the Douglas-Gunn (DG) Scheme\nThis scheme, with $\\theta=1/2$, is analyzed similarly in Fourier space. A direct derivation proceeds by relating the change at each step to the previous one:\n$$\nu^{n+1} - u^n \\;=\\; \\left(I + \\frac{\\Delta t}{2}C\\right) \\left(I - \\frac{\\Delta t}{2}B\\right)^{-1} \\left(I - \\frac{\\Delta t}{2}A\\right)^{-1} \\Delta t (A+B+C) u^n\n$$\nIn terms of symbols, the amplification factor $g_{\\text{DG}}$ is found from $g_{\\text{DG}} - 1 = (u^{n+1}-u^n)/u^n$:\n$$\ng_{\\text{DG}}-1 \\;=\\; \\frac{\\left(1 + \\frac{\\Delta t}{2}\\lambda_C\\right) \\Delta t (\\lambda_A+\\lambda_B+\\lambda_C)}{\\left(1 - \\frac{\\Delta t}{2}\\lambda_A\\right)\\left(1 - \\frac{\\Delta t}{2}\\lambda_B\\right)}\n$$\nThus, the amplification factor is:\n$$\ng_{\\text{DG}}(\\Delta t; \\theta_x, \\theta_y) \\;=\\; 1 \\;+\\; \\frac{\\Delta t (\\lambda_A+\\lambda_B+\\lambda_C) \\left(1 + \\frac{\\Delta t}{2}\\lambda_C\\right)}{\\left(1 - \\frac{\\Delta t}{2}\\lambda_A\\right)\\left(1 - \\frac{\\Delta t}{2}\\lambda_B\\right)}\n$$\n\n### 3. Stability Condition and Numerical Search\nThe CFL-like stability condition requires that the maximum magnitude of the amplification factor over all discrete wavenumbers does not exceed $1$:\n$$\nS(\\Delta t) \\;=\\; \\max_{k_x, k_y} |g(\\Delta t; \\theta_x, \\theta_y)| \\;\\le\\; 1\n$$\nwhere $k_x \\in \\{0, \\dots, N_x-1\\}$ and $k_y \\in \\{0, \\dots, N_y-1\\}$. We need to find the largest $\\Delta t$ in the interval $[0, \\Delta t_{\\max}]$ that satisfies this condition. The function $S(\\Delta t)$ is non-decreasing for the unstable modes. We can find the desired $\\Delta t$ by solving the equation $S(\\Delta t) - 1 = 0$ using the bisection method.\n\nThe search algorithm is as follows:\n1. Define a function that computes $S(\\Delta t)$ for a given scheme by evaluating $|g|$ over the entire grid of wavenumbers and finding the maximum.\n2. For each scheme, set a search interval $[t_{\\text{low}}, t_{\\text{high}}] = [0, \\Delta t_{\\max}]$.\n3. If $S(\\Delta t_{\\max}) \\le 1$, the solution is $\\Delta t_{\\max}$.\n4. Otherwise, a root of $S(\\Delta t) - 1 = 0$ exists in the interval. Apply bisection for a fixed number of iterations to find the root with high precision. The final value of $t_{\\text{low}}$ from the bisection is the largest admissible $\\Delta t$.\nThis procedure is implemented for both the PR and DG schemes for each test case provided.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef calculate_max_g(dt, params, scheme_name):\n    \"\"\"\n    Calculates the maximum amplification factor magnitude over all wavenumbers.\n    \n    Args:\n        dt (float): The time step.\n        params (tuple): A tuple (a, b, m, Nx, Ny) of problem parameters.\n        scheme_name (str): The name of the scheme, either 'PR' or 'DG'.\n        \n    Returns:\n        float: The maximum absolute value of the amplification factor.\n    \"\"\"\n    a, b, m, Nx, Ny = params\n    \n    # Create grids of discrete wavenumber indices\n    kx = np.arange(Nx)\n    ky = np.arange(Ny)\n    kx_grid, ky_grid = np.meshgrid(kx, ky, indexing='ij')\n\n    # Calculate symbols of the spatial derivative operators\n    # These are real-valued given the specified finite difference stencils.\n    # We use np.errstate to avoid warnings for sin(pi*0/0) which is handled later\n    with np.errstate(divide='ignore', invalid='ignore'):\n        L_A = -4 * a * (Nx**2) * (np.sin(np.pi * kx_grid / Nx)**2)\n        L_B = -4 * b * (Ny**2) * (np.sin(np.pi * ky_grid / Ny)**2)\n        L_C = -m * Nx * Ny * np.sin(2 * np.pi * kx_grid / Nx) * np.sin(2 * np.pi * ky_grid / Ny)\n\n    # For kx=0 or ky=0, the arguments to sin might involve 0/0 -> nan.\n    # The limit is 0, so we replace NaNs with 0.\n    L_A[np.isnan(L_A)] = 0.0\n    L_B[np.isnan(L_B)] = 0.0\n    L_C[np.isnan(L_C)] = 0.0\n\n    # Calculate amplification factor g for the specified scheme\n    if scheme_name == 'PR':\n        # g_PR = (1 + dt/2 * L_A) / (1 - dt/2 * L_A) * (1 + dt/2 * L_B + dt * L_C) / (1 - dt/2 * L_B)\n        term1_num = 1.0 + 0.5 * dt * L_A\n        term1_den = 1.0 - 0.5 * dt * L_A\n        term2_num = 1.0 + 0.5 * dt * L_B + dt * L_C\n        term2_den = 1.0 - 0.5 * dt * L_B\n        g = (term1_num / term1_den) * (term2_num / term2_den)\n    elif scheme_name == 'DG':\n        # g_DG = 1 + dt*(L_A+L_B+L_C)*(1+0.5*dt*L_C) / ((1-0.5*dt*L_A)*(1-0.5*dt*L_B))\n        num = dt * (L_A + L_B + L_C) * (1.0 + 0.5 * dt * L_C)\n        den = (1.0 - 0.5 * dt * L_A) * (1.0 - 0.5 * dt * L_B)\n        g = 1.0 + num / den\n    else:\n        raise ValueError(\"Unknown scheme name provided\")\n\n    # Return the maximum magnitude (spectral radius of the one-step operator)\n    return np.max(np.abs(g))\n\ndef find_stable_dt(params, scheme_name, dt_max):\n    \"\"\"\n    Finds the largest stable time step dt using bisection search.\n    \n    Args:\n        params (tuple): A tuple (a, b, m, Nx, Ny) of problem parameters.\n        scheme_name (str): The name of the scheme, either 'PR' or 'DG'.\n        dt_max (float): The upper bound for the search interval [0, dt_max].\n        \n    Returns:\n        float: The largest time step dt for which the scheme is stable.\n    \"\"\"\n    # If the scheme is stable even at dt_max, then that's the answer.\n    if calculate_max_g(dt_max, params, scheme_name) <= 1.0:\n        return dt_max\n\n    low = 0.0\n    high = dt_max\n    \n    # Bisection search for 100 iterations provides high precision.\n    for _ in range(100):\n        mid = (low + high) / 2.0\n        # Check for convergence to machine precision limit\n        if mid == low or mid == high:\n            break\n        \n        if calculate_max_g(mid, params, scheme_name) > 1.0:\n            high = mid  # mid is unstable, search in lower half\n        else:\n            low = mid   # mid is stable, search in upper half\n            \n    return low\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for all test cases.\n    \"\"\"\n    test_cases = [\n        # Case 1 (happy path)\n        (1.0, 1.0, 0.2, 32, 32, 1.0),\n        # Case 2 (anisotropic diffusion with stronger mixed term)\n        (1.0, 0.3, 0.8, 64, 32, 0.5),\n        # Case 3 (near the ellipticity boundary)\n        (1.0, 1.0, 0.9, 32, 16, 0.5),\n    ]\n\n    results = []\n    for case in test_cases:\n        a, b, m, Nx, Ny, dt_max = case\n        params = (a, b, m, Nx, Ny)\n        \n        dt_pr = find_stable_dt(params, 'PR', dt_max)\n        dt_dg = find_stable_dt(params, 'DG', dt_max)\n        \n        results.append([dt_pr, dt_dg])\n\n    # Final print statement in the exact required format.\n    # Example format: [[dt_PR1, dt_DG1], [dt_PR2, dt_DG2], [dt_PR3, dt_DG3]]\n    output_str = f\"[{','.join([str(p) for p in results])}]\"\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}