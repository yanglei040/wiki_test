## 引言
从[线性偏微分方程](@entry_id:172517)（PDEs）到[非线性](@entry_id:637147)领域的跨越，是计算科学中一个深刻而富有挑战性的转变。与线性问题不同，[非线性PDE](@entry_id:202123)s的解不能简单地通过叠加基本解来构造，其离散化过程将产生复杂的[非线性](@entry_id:637147)代数方程组，而非简单的线性系统。如何有效且稳健地求解这些系统，是现代科学与工程计算面临的一个核心知识缺口。本文旨在为这一挑战提供一个系统性的框架。

在接下来的内容中，读者将踏上一段从理论到实践的旅程。第一章“**原理与机制**”将奠定理论基石，阐明如何对[非线性PDE](@entry_id:202123)进行分类，并详细介绍如何通过伽辽金方法将其离散化为[非线性](@entry_id:637147)代数系统，以及如何利用牛顿法这一强大的工具进行求解。随后，第二章“**应用与[交叉](@entry_id:147634)学科联系**”将视野拓宽至真实世界的复杂问题，展示这些原理在[多物理场耦合](@entry_id:171389)、结构保持格式设计以及[高性能计算](@entry_id:169980)等前沿领域的应用与挑战。最后，第三章“**动手实践**”将通过具体的编程练习，让读者亲手实现关键算法，将理论知识转化为实践能力。

## 原理与机制

从[线性偏微分方程](@entry_id:172517)（PDEs）到[非线性](@entry_id:637147)领域的跨越，是数学和计算科学中的一个根本性转变。[线性算子](@entry_id:149003)的叠加原理不复存在，这意味着我们无法再通过分解问题和叠加[基本解](@entry_id:184782)来构建复杂解。[非线性PDE](@entry_id:202123)s的算子本身就依赖于其未知解，这一特性深刻地改变了我们分析和求解这些方程的方式。当我们将这些方程离散化后，所得到的代数系统不再是简单的[线性方程组](@entry_id:148943) $\mathbf{A}\mathbf{x}=\mathbf{b}$，而是一个复杂的非线性方程组 $\mathbf{R}(\mathbf{U})=\mathbf{0}$。求解此类系统需要迭代方法，并且其[收敛性与稳定性](@entry_id:636533)都构成了新的、重大的挑战。本章旨在系统地阐述离散化[非线性PDE](@entry_id:202123)s的核心原理与关键机制，为后续章节中具体的数值方法和应用奠定坚实的基础。

### [非线性偏微分方程](@entry_id:169481)的类型

理解[非线性PDE](@entry_id:202123)s的第一步是学会对其进行分类，因为不同类型的[非线性](@entry_id:637147)对数值方法的选择和设计有着决定性的影响。一个 $k$ 阶的PDE通常可以被分为三类：半线性（semilinear）、[拟线性](@entry_id:637689)（quasilinear）和全[非线性](@entry_id:637147)（fully nonlinear）。

**半线性PDEs** 是最简单的一类非线性方程。它们的特征是最高阶导数项是线性的，且这些项的系数不依赖于未知解或其任何阶的导数。[非线性](@entry_id:637147)仅仅出现在低阶项中。一个典型的例子是带有[非线性](@entry_id:637147)反应项的扩散方程 ：
$$
-\Delta u + u^{3} = f
$$
在这个二阶方程中，最高阶导数项是[拉普拉斯算子](@entry_id:146319) $-\Delta u$，它对 $u$ 的[二阶导数](@entry_id:144508)是线性的，其系数为常数 $-1$。[非线性](@entry_id:637147)来自于零阶项 $u^3$。对于这类问题，我们可以通过标准的方式推导其弱形式。假设在有界区域 $\Omega \subset \mathbb{R}^d$ 上有齐次狄利克雷边界条件 $u=0$，我们寻找一个解 $u \in H_{0}^{1}(\Omega)$。将原方程乘以一个[检验函数](@entry_id:166589) $v \in H_{0}^{1}(\Omega)$ 并在 $\Omega$ 上积分，然后对拉普拉斯项进行[分部积分](@entry_id:136350)（利用[格林第一恒等式](@entry_id:170345)），即可得到弱形式：寻找 $u \in H_{0}^{1}(\Omega)$，使得对于所有 $v \in H_{0}^{1}(\Omega)$，下式成立：
$$
\int_{\Omega} \nabla u \cdot \nabla v \, dx + \int_{\Omega} u^{3} v \, dx = \int_{\Omega} f v \, dx
$$
这种[弱形式](@entry_id:142897)结构与线性问题非常相似，主要的区别在于第二项 $\int_{\Omega} u^{3} v \, dx$ 的存在，它在离散化后将产生[非线性](@entry_id:637147)代数项。

**[拟线性](@entry_id:637689)PDEs** 的[非线性](@entry_id:637147)程度更高。其最高阶导数项仍然是线性的，但这些项的系数可以依赖于未知解 $u$ 或其低阶导数。一个重要的例子是依赖于解的[扩散](@entry_id:141445)系数问题，例如在[多孔介质流](@entry_id:146440)或[热传导](@entry_id:147831)中常见的形式 ：
$$
-\operatorname{div}(a(u)\nabla u) = f
$$
这里，[扩散](@entry_id:141445)系数 $a(u)$ 是解 $u$ 本身的函数。尽管方程对最[高阶导数](@entry_id:140882)（即 $\nabla u$ 中的一阶导数和展开后的 $\Delta u$ 中的[二阶导数](@entry_id:144508)）是线性的，但其系数 $a(u)$ 的依赖性使整个问题呈现出显著的[非线性](@entry_id:637147)特征。另一个经典且重要的[拟线性方程](@entry_id:163184)是 **[p-拉普拉斯](@entry_id:196614)方程**  ：
$$
-\operatorname{div}(|\nabla u|^{p-2}\nabla u) = f, \quad \text{其中 } p > 1
$$
该方程的最[高阶导数](@entry_id:140882)（[二阶导数](@entry_id:144508)）的系数依赖于解的一阶导数 $\nabla u$。这类问题同样可以采用[变分方法](@entry_id:163656)处理。例如，[p-拉普拉斯](@entry_id:196614)方程的自然[函数空间](@entry_id:143478)是[索博列夫空间](@entry_id:141995) $W_{0}^{1,p}(\Omega)$。其[弱形式](@entry_id:142897)为：寻找 $u \in W_{0}^{1,p}(\Omega)$，使得对于所有检验函数 $v \in W_{0}^{1,p}(\Omega)$，下式成立：
$$
\int_{\Omega} |\nabla u|^{p-2} \nabla u \cdot \nabla v \, dx = \langle f, v \rangle
$$
其中 $\langle \cdot, \cdot \rangle$ 表示[对偶空间](@entry_id:146945) $W^{-1,p'}(\Omega)$ (其中 $p'=\frac{p}{p-1}$) 与 $W_{0}^{1,p}(\Omega)$ 之间的对偶积。

**全[非线性PDE](@entry_id:202123)s** 是[非线性](@entry_id:637147)程度最高的一类，其最高阶导数项本身就是[非线性](@entry_id:637147)的。这意味着方程不能被写成最高阶导数的线性组合。一个典型的例子是 **[蒙日-安培方程](@entry_id:268604)**（Monge-Ampère equation）：
$$
\det(D^{2}u) = g
$$
其中 $D^2u$ 是 $u$ 的[海森矩阵](@entry_id:139140)（Hessian matrix）。在二维情况下，$\det(D^2u) = u_{xx}u_{yy} - u_{xy}^2$，这显然是关于[二阶导数](@entry_id:144508)的二次多项式。对于这[类方程](@entry_id:144428)，标准的、通过乘以检验函数和[分部积分](@entry_id:136350)得到的弱形式通常不再适用。其“[弱解](@entry_id:161732)”的现代概念通常是基于 **[粘性解](@entry_id:177596)**（viscosity solutions）的理论，这需要一套完全不同的分析和数值工具。因此，标准的 $H^1$ 伽辽金有限元方法无法直接应用于这类问题。

这种分类揭示了[非线性](@entry_id:637147)所带来的挑战的层次性。半线性和[拟线性](@entry_id:637689)问题通常可以通过[变分原理](@entry_id:198028)和伽辽金方法进行离散化，从而转化为[非线性](@entry_id:637147)代数方程组。而全[非线性](@entry_id:637147)问题则往往需要更专门化的处理。

### [弱形式](@entry_id:142897)离散化：伽辽金方法

对于半线性和[拟线性方程](@entry_id:163184)，伽辽金方法，特别是有限元方法（FEM），提供了一个系统性的离散化框架。其核心思想是将无限维的[弱形式](@entry_id:142897)问题转化为一个有限维的代数问题。这个过程不可避免地将连续的[非线性](@entry_id:637147)问题转变为离散的[非线性](@entry_id:637147)问题。

我们以一维 [p-拉普拉斯](@entry_id:196614)方程为例，具体说明这个过程 。考虑在区域 $\Omega=(0,1)$ 上的方程 $-\frac{d}{dx}(|u'|^{p-2}u') = f(x)$，边界条件为 $u(0)=u(1)=0$。其[弱形式](@entry_id:142897)为：
$$
\int_{0}^{1} |u'|^{p-2} u' v' \, dx = \int_{0}^{1} f v \, dx
$$
为了进行[有限元离散化](@entry_id:193156)，我们首先将区域 $\Omega$ 分割成一个网格。例如，一个简单的网格包含节点 $x_0=0, x_1=1/2, x_2=1$。然后，我们在该网格上定义一个有限维的[函数空间](@entry_id:143478) $V_h \subset W_0^{1,p}(\Omega)$，例如由连续分片线性函数（“[帽子函数](@entry_id:171677)”）组成的空间。由于边界条件为齐次，唯一需要求解的自由度对应于内部节点 $x_1=1/2$。设与该节点关联的[基函数](@entry_id:170178)为 $\varphi_1(x)$。

我们将近似解 $u_h(x)$ 表示为 $u_h(x) = a \cdot \varphi_1(x)$，其中 $a$ 是待定的未知系数，即 $u_h(1/2)$ 的值。根据[伽辽金原理](@entry_id:167636)，我们要求[弱形式](@entry_id:142897)对 $V_h$ 中的所有[检验函数](@entry_id:166589)都成立。由于 $V_h$ 由 $\varphi_1$ 张成，我们只需令[检验函数](@entry_id:166589) $v_h = \varphi_1$ 即可。将 $u_h$ 和 $v_h$ 代入弱形式，得到关于未知数 $a$ 的一个[代数方程](@entry_id:272665)：
$$
\int_{0}^{1} |(a \varphi_1)'|^{p-2} (a \varphi_1)' (\varphi_1)' \, dx = \int_{0}^{1} f \varphi_1 \, dx
$$
整理左侧的积分项，我们得到：
$$
\left( \int_0^1 |\varphi'_1(x)|^p \, dx \right) |a|^{p-2}a = \int_0^1 f(x)\varphi_1(x) \, dx
$$
这是一个关于 $a$ 的**[非线性](@entry_id:637147)[代数方程](@entry_id:272665)**。例如，当 $p=3$ 且 $f(x)=1$ 时，通过计算积分可以得到 $8|a|a = 1/2$，其唯一实数解为 $a=1/4$。这个简单的例子清晰地展示了，即使对于只有一个自由度的问题，[拟线性](@entry_id:637689)[PDE的离散化](@entry_id:748528)也会直接导出一个需要专门求解的[非线性](@entry_id:637147)[代数方程](@entry_id:272665)。对于包含成千上万个自由度的实际问题，我们将面对一个大规模的非线性方程组 $\mathbf{R}(\mathbf{U})=\mathbf{0}$。

### [求解非线性系统](@entry_id:163616)：牛顿-拉夫逊方法

面对[非线性](@entry_id:637147)代数方程组 $\mathbf{R}(\mathbf{U})=\mathbf{0}$，**牛顿-拉夫逊方法**（[Newton-Raphson](@entry_id:177436) method）或简称[牛顿法](@entry_id:140116)，是求解它的主要工具。该方法从一个初始猜测 $\mathbf{U}^0$ 开始，通过一系列线性化步骤来迭代地逼近真实解。在第 $k$ 次迭代中，我们通过求解一个线性系统来计算一个修正量 $\delta \mathbf{U}$：
$$
\mathbf{J}(\mathbf{U}^k) \delta \mathbf{U} = -\mathbf{R}(\mathbf{U}^k)
$$
然后更新解：$\mathbf{U}^{k+1} = \mathbf{U}^k + \delta \mathbf{U}$。这里的 $\mathbf{J}(\mathbf{U}^k)$ 是在当前解 $\mathbf{U}^k$ 处计算的**雅可比矩阵**（Jacobian matrix），其定义为残差向量 $\mathbf{R}$ 对未知数向量 $\mathbf{U}$ 的导数，即 $J_{ij} = \partial R_i / \partial U_j$。这个矩阵在有限元中通常被称为**[切线刚度矩阵](@entry_id:170852)**（tangent stiffness matrix）。

雅可比矩阵的精确计算对于[牛顿法](@entry_id:140116)的二次收敛性至关重要。让我们推导一个一般形式的[非线性](@entry_id:637147)[扩散](@entry_id:141445)-反应方程的雅可比矩阵 。考虑PDE：
$$
-\nabla \cdot (\alpha(u)\nabla u) + \beta(u) = 0
$$
其离散后的单元级残差向量的第 $i$ 个分量为：
$$
R_i^{e}(\mathbf{U}^{e}) = \int_{\Omega^{e}} \alpha(u_h)\,\nabla u_h \cdot \nabla N_i\, d\Omega + \int_{\Omega^{e}} \beta(u_h)\,N_i\,d\Omega
$$
其中 $u_h(x) = \sum_k N_k(x) U_k$ 是[有限元近似](@entry_id:166278)。雅可比矩阵的第 $(i,j)$ 个元素是 $J_{ij}^e = \partial R_i^e / \partial U_j$。通过将[微分算子](@entry_id:140145)移入积分内，并应用链式法则和[乘法法则](@entry_id:144424)，我们可以得到：
$$
\frac{\partial}{\partial U_j} \left(\alpha(u_h) \nabla u_h \right) = \frac{d\alpha}{du_h} \frac{\partial u_h}{\partial U_j} \nabla u_h + \alpha(u_h) \frac{\partial \nabla u_h}{\partial U_j} = \alpha'(u_h) N_j \nabla u_h + \alpha(u_h) \nabla N_j
$$
以及
$$
\frac{\partial}{\partial U_j} \left(\beta(u_h)\right) = \beta'(u_h) N_j
$$
将这些结果整合，最终得到雅可比矩阵的积分形式，并用[数值积分](@entry_id:136578)（例如[高斯积分](@entry_id:187139)）来近似。在每个积分点 $\hat{\xi}_q$ 上，其贡献为：
$$
J_{ij}^{e} \approx \sum_{q=1}^{n_q} \left[ \alpha(u_h) (\nabla N_i \cdot \nabla N_j) + \alpha'(u_h) N_j (\nabla u_h \cdot \nabla N_i) + \beta'(u_h) N_i N_j \right]_{q} \det(\mathbf{J}_e(\hat{\xi}_q)) w_q
$$
这个表达式揭示了雅可比矩阵的三个组成部分：
1.  与线性问题刚度矩阵形式相同的项：$\alpha(u_h) (\nabla N_i \cdot \nabla N_j)$。
2.  由[扩散](@entry_id:141445)系数的[非线性](@entry_id:637147)产生的项：$\alpha'(u_h) N_j (\nabla u_h \cdot \nabla N_i)$。这一项通常是非对称的，即使原始问题是自伴的。
3.  由低阶[非线性](@entry_id:637147)项产生的项：$\beta'(u_h) N_i N_j$。

精确构造这个[雅可比矩阵](@entry_id:264467)是实现高效[非线性求解器](@entry_id:177708)的关键。

### 高级离散化与线性化概念

在更复杂的应用中，离散化和线性化这两个操作的顺序会产生深刻的影响，尤其是在[多物理场耦合](@entry_id:171389)和灵敏度分析的背景下。

#### 离散化-再-线性化 vs. 线性化-再-离散化

在求解[非线性PDE](@entry_id:202123)时，我们面临两种概念上的路径 ：
1.  **离散化-再-线性化 (Discretize-then-Linearize, D-then-L)**：这是实践中最常见的方法。我们首先将连续的[非线性PDE](@entry_id:202123)（[弱形式](@entry_id:142897) $\mathcal{R}(U;V)=0$）离散化，得到一个[非线性](@entry_id:637147)代数系统 $\mathbf{r}(\mathbf{U}_h)=\mathbf{0}$。然后，我们对这个代数系统进行线性化，即计算其雅可比矩阵 $\mathbf{J}(\mathbf{U}_h) = \partial \mathbf{r} / \partial \mathbf{U}_h$，以用于[牛顿法](@entry_id:140116)。
2.  **线性化-再-离散化 (Linearize-then-Discretize, L-then-D)**：在这个路径中，我们首先对连续的PDE算子 $\mathcal{R}$ 进行线性化（计算其[Gâteaux导数](@entry_id:164612) $D\mathcal{R}(U)[\delta U;V]$），得到一个关于增量 $\delta U$ 的线性PDE。然后，我们对这个线性PDE进行离散化，得到一个关于离散增量 $\delta \mathbf{U}_h$ 的线性代数系统。

一个核心问题是：这两种方法是否总能得到相同的最终线性系统？答案是**否定的**。这两个操作的**交换性**仅在特定条件下成立。当且仅当离散化算子 $\mathcal{D}_h$ 本身是线性的且与解无关时，两者才是等价的。对于标准的伽辽金有限元方法，如果使用固定的[基函数](@entry_id:170178)和固定的数值积分规则，且没有引入依赖于解的附加项，那么离散化算子是线性的，两种方法等价。物理上的[非线性](@entry_id:637147)（例如材料参数 $k(T)$ 依赖于温度 $T$）并不会破坏这种交换性。

然而，在许多现代数值方法中，离散化过程本身就依赖于解。这会导致两种方法产生不同的[雅可比矩阵](@entry_id:264467)，从而影响牛顿法的收敛性。交换性被破坏的常见情况包括：
-   **依赖于解的稳定化方法**：例如，在[流体力学](@entry_id:136788)中广泛使用的流线迎风/皮特洛夫-伽辽金（SUPG）方法，其稳定化参数通常依赖于局部流速。
-   **通量/[斜率限制器](@entry_id:638003)**：在用于[双曲守恒律](@entry_id:147752)的有限体积或[间断伽辽金方法](@entry_id:748369)中，为了抑制[伪振荡](@entry_id:152404)而引入的限制器函数是[非线性](@entry_id:637147)的，并且是解的函数。
-   **分区交错求解格式**：在求解[多物理场耦合](@entry_id:171389)问题时，如果采用[分区方法](@entry_id:170629)（例如，固定温度场求解力学场，再固定力学场求解温度场），这种算法上的[解耦](@entry_id:637294)会忽略掉物理上存在的完全耦合雅可比矩阵中的某些[偏导数](@entry_id:146280)项（非对角块），这与先对完全耦合系统进行线性化（L-then-D）得到的结果不同。

理解这种[非交换性](@entry_id:153545)对于正确实现和分析高级[数值格式](@entry_id:752822)至关重要。

#### 伴随方程与[优化问题](@entry_id:266749)的一致性

类似的概念也出现在[PDE约束优化](@entry_id:162919)问题中，这涉及到**伴随方法**（adjoint methods）来高效计算目标函数相对于设计参数的梯度 。同样存在两种策略：

1.  **离散化-再-优化 (Discretize-then-Optimize, D-O)**：首先将[状态方程](@entry_id:274378) $N(u,m)=0$ 和[目标函数](@entry_id:267263) $J(u,m)$ 离散化，得到代数约束 $R_h(u_h,m)=0$ 和代数目标 $J_h(u_h,m)$。然后，为这个有限维[优化问题](@entry_id:266749)构造拉格朗日函数，并推导出离散的伴随方程。这种方法得到的[离散伴随](@entry_id:748494)系统恰好是离散状态方程[雅可比矩阵](@entry_id:264467)的转置：$K(u_h,m)^\top \lambda_h = -g_h$，其中 $K$ 是[状态方程](@entry_id:274378)残差的雅可比矩阵，$g_h$ 是目标函数对[状态变量](@entry_id:138790)的梯度。
2.  **优化-再-离散化 (Optimize-then-Discretize, O-D)**：首先在连续的无限维函数空间中推导[连续伴随](@entry_id:747804)方程 $N_u(u,m)^* \lambda = -J_u(u,m)$。然后，对这个伴随方程进行离散化。

这两种方法得到的[离散伴随](@entry_id:748494)系统是否相同？同样，这并不总是成立。只有当所使用的[离散化格式](@entry_id:153074)是**伴随一致**（adjoint-consistent）的，两者才会吻合。标准的伽辽金方法是伴随一致的，但许多为特定问题（如[对流](@entry_id:141806)占优问题）设计的格式，例如迎风格式或某些非对称的皮特洛夫-伽辽金格式，则不具备此性质。

在实践中，**D-O方法通常是首选**。其主要优势在于，它保证了计算出的梯度是**离散[目标函数](@entry_id:267263)**相对于参数的**精确梯度**。这种梯度与求解器所使用的离散状态方程是完全一致的，这对于[基于梯度的优化](@entry_id:169228)算法的性能至关重要。使用O-D方法和一个非伴随一致的格式，可能会导致梯度与约束不匹配，从而严重影响优化过程。

### [非线性离散化](@entry_id:752576)专题

除了上述核心概念，[非线性PDE](@entry_id:202123)s的离散化还涉及到许多特定问题领域的专门技术。

#### [双曲守恒律](@entry_id:147752)

[双曲守恒律](@entry_id:147752)，如 $u_t + \partial_x f(u) = 0$，的[非线性](@entry_id:637147)在于其通量函数 $f(u)$。有限体积法（FVM）是求解此类问题的标准方法。其核心在于定义单元界面处的**[数值通量](@entry_id:752791)**（numerical flux）。

**[戈杜诺夫通量](@entry_id:634733)**（Godunov flux）是一种基于物理的构造方式，它利用了在每个单元界面处**黎曼问题**（Riemann problem）的精确解 。黎曼问题是指具有分段常数[初始条件](@entry_id:152863)（$u_L$ 和 $u_R$）的守恒律。对于一个严格凸的通量函数（如[伯格斯方程](@entry_id:177995)的 $f(u)=\frac{1}{2}u^2$），其精确解由两种波结构组成：
-   **[稀疏波](@entry_id:168428) (Rarefaction wave)**：当 $u_L  u_R$ 时，解是一个连续的扇形波。
-   **激波 (Shock wave)**：当 $u_L > u_R$ 时，解是一个以满足[Rankine-Hugoniot条件](@entry_id:181986)的速度传播的间断。

[戈杜诺夫通量](@entry_id:634733)被定义为物理通量 $f(u)$ 在界面 $x/t=0$ 处的值，即 $g(u_L, u_R) = f(u^*)$，其中 $u^*$ 是黎曼问题的精确解在界面上的状态。这个状态 $u^*$ 的取值取决于波的结构和传播方向。

为了保证解的物理正确性（例如，激波处的熵增），[数值格式](@entry_id:752822)需要满足一个离散的**[熵不等式](@entry_id:184404)**。现代的[熵稳定格式](@entry_id:749017)通过精心设计数值通量来实现这一点 。一种常见的方法是将[数值通量](@entry_id:752791)分解为一个**[熵守恒通量](@entry_id:749013)**和一个**数值耗散项**。[熵守恒通量](@entry_id:749013)被设计为在没有耗散时精确地保持离散熵的总量不变。耗散项则被构造成与解在界面处的跳跃成比例，并确保其总能产生非负的熵，从而保证[离散熵不等式](@entry_id:748505) $\frac{d}{dt} S_h(t) \le 0$ 成立，其中 $S_h$ 是总离散熵。这种结构化的设计方法极大地增强了[数值格式](@entry_id:752822)的鲁棒性。

#### [变分不等式](@entry_id:172788)

另一类[非线性](@entry_id:637147)问题来自于约束，而不是算子本身的[非线性](@entry_id:637147)。**障碍问题**（obstacle problem）就是一个典型例子 。该问题寻求一个函数 $u$，在满足 $u \ge \psi$（$\psi$ 是给定的“障碍”）的约束下，最小化某个能量泛函（例如 $\frac{1}{2}\int |\nabla v|^2 dx - \int fv dx$）。

与标准的PDEs导出的等式弱形式不同，[变分不等式](@entry_id:172788)导出的弱形式是一个不等式：寻找 $u \in K$（$K$ 是满足约束的函数集合），使得 $a(u, v-u) \ge (f, v-u)$ 对于所有 $v \in K$ 成立。

离散化后，这个问题不再是标准的[非线性方程组](@entry_id:178110)，而是一个**[互补问题](@entry_id:636575)**（complementarity problem）。它可以用一组[Karush-Kuhn-Tucker](@entry_id:634966)（KKT）条件来描述：
$$
K u = b + \lambda, \quad u_i \ge \psi_i, \quad \lambda_i \ge 0, \quad \lambda_i (u_i - \psi_i) = 0
$$
这里的向量 $\lambda$ 是[拉格朗日乘子](@entry_id:142696)，代表了障碍物施加的接触力。[互补条件](@entry_id:747558) $\lambda_i (u_i - \psi_i) = 0$ 意味着接触力只在解接触到障碍物的地方（$u_i = \psi_i$）才可能非零。

求解这类问题的有效算法是**原始-对偶积[极集](@entry_id:193237)方法**（Primal-Dual Active Set, PDAS）。该方法通过迭代地猜测哪些节点是“积极的”（即解接触到障碍物，$u_i = \psi_i$）和“非积极的”（$u_i > \psi_i$）。在每次迭代中，它将问题分解为一个在积[极集](@entry_id:193237)上的[等式约束](@entry_id:175290)问题和一个在非积[极集](@entry_id:193237)上的无约束问题，从而求解一个规模减小的[线性系统](@entry_id:147850)。

#### 时间相关问题

对于时间相关的[非线性PDE](@entry_id:202123)，我们通常采用**线方法**（method of lines），即首先进行[空间离散化](@entry_id:172158)，将PDE转化为一个常微分方程（ODE）组：$\frac{d\mathbf{U}}{dt} = \mathbf{L}(\mathbf{U})$，其中 $\mathbf{L}$ 是一个非[线性空间](@entry_id:151108)算子。然后，我们使用ODE求解器进行时间积分。

[时间积分格式](@entry_id:165373)的选择至关重要，主要分为**显式**和**隐式**两类 。
-   **显式格式**（如[前向欧拉法](@entry_id:141238) $u^{n+1} = u^n + \Delta t \mathcal{L}(u^n)$）计算简单，无需解[非线性系统](@entry_id:168347)。但它们的稳定性受到严格限制。对于一个[非线性](@entry_id:637147)扩散方程 $u_t = \nabla\cdot(\phi(u)\nabla u)$，其稳定性通常要求时间步长 $\Delta t$ 满足一个类似CFL的条件：
    $$
    \Delta t \le \frac{C h^2}{\phi_{\max}}
    $$
    其中 $h$ 是空间步长，$\phi_{\max}$ 是[扩散](@entry_id:141445)系数的最大值。时间步长与空间步长的平方成正比，这在需要精细空间网格时会变得非常苛刻。
-   **[隐式格式](@entry_id:166484)**（如后向欧拉法 $u^{n+1} = u^n + \Delta t \mathcal{L}(u^{n+1})$）在每一步都需要求解一个[非线性](@entry_id:637147)代数系统。然而，它们通常具有更好的稳定性。对于耗散性问题（如[扩散](@entry_id:141445)），许多[隐式格式](@entry_id:166484)是**无条件稳定**的，即对时间步长 $\Delta t$ 的大小没有限制。这使得它们在需要长时间模拟或处理[刚性问题](@entry_id:142143)时成为必然选择。

#### 高级求解器

求解[隐式格式](@entry_id:166484)产生的大规模非线性系统 $\mathbf{R}(\mathbf{U})=\mathbf{0}$ 本身就是一个巨大的挑战。虽然牛顿法提供了基本框架，但每次迭代都需要求解一个大规模[线性系统](@entry_id:147850) $\mathbf{J}\delta\mathbf{U}=-\mathbf{R}$。当问题规模非常大时，直接求解这个线性系统变得不可行。

**[多重网格方法](@entry_id:146386)**（Multigrid methods）是求解这类系统的最快方法之一。对于[非线性](@entry_id:637147)问题，**全逼近格式**（Full Approximation Scheme, FAS）是一种标准的多重网格技术 。与用于线性问题的校正格式（Correction Scheme, CS）在粗网格上求解[误差校正](@entry_id:273762)量不同，FAS在所有网格层次上都直接求解原问题的完整近似解。

FAS的核心在于其粗网格方程的构造：
$$
\mathcal{N}_{H}(u_{H}) = R_{h}^{H}f_{h} + \tau_{h}^{H}(u_{h})
$$
右端项由两部分组成：被限制到粗网格的细网格右端项 $R_h^H f_h$，以及一个关键的**$\tau$校正项**（tau correction）。该项定义为：
$$
\tau_{h}^{H}(u_{h}) = \mathcal{N}_{H}(I_{h}^{H}u_{h}) - R_{h}^{H}\mathcal{N}_{h}(u_{h})
$$
它度量了“在粗网格上离散化一个被限制的细网格函数”与“将在细网格上离散化的结果限制到粗网格”之间的差异。这个$\tau$项的作用是修正粗网格问题，使其能够“感知”到细网格上的[截断误差](@entry_id:140949)，从而保证粗网格上的解能够有效地校正细网格上的高频误差。FAS通过这种方式，将多重网格的高效率推广到了[非线性](@entry_id:637147)领域。