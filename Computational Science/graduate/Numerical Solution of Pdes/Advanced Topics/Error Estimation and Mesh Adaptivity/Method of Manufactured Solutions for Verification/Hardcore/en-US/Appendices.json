{
    "hands_on_practices": [
        {
            "introduction": "This first practice lays the groundwork for verification using the powerful Finite Element Method (FEM). We will apply the Method of Manufactured Solutions to a standard Poisson problem, for which the theory predicts specific convergence rates dependent on the polynomial degree of the elements used. By working through this exercise , you will confirm the standard error estimates—specifically, $\\mathcal{O}(h^p)$ convergence in the energy norm and an optimal $\\mathcal{O}(h^{p+1})$ rate in the $L^2$ norm—and learn how to practically measure these errors in a FEM code.",
            "id": "3420688",
            "problem": "Consider the second-order elliptic Partial Differential Equation (PDE)\n$$\n-\\nabla\\cdot\\left(\\kappa\\nabla u\\right)=f\\quad\\text{in }\\Omega,\\qquad u=g\\quad\\text{on }\\partial\\Omega,\n$$\non the convex polygonal domain $\\Omega=(0,1)^2$, with a constant scalar diffusion coefficient $\\kappa\\equiv 1$. You will perform verification by the Method of Manufactured Solutions (MMS), which consists of prescribing a smooth exact solution $u$ and then defining the forcing term $f$ and Dirichlet boundary data $g$ accordingly so that the prescribed $u$ satisfies the PDE and boundary conditions. Let the manufactured solution be\n$$\nu(x,y)=\\mathrm{e}^{x+y}\\sin(\\pi x)\\sin(\\pi y).\n$$\nYou discretize the problem by the conforming Finite Element Method (FEM) using a shape-regular, quasi-uniform family of triangulations with meshsize $h$, and a standard $H^1$-conforming Lagrange space of polynomial degree $p\\in\\mathbb{N}$, $p\\ge 1$. Assume $\\Omega$ is convex so that the dual problem for Aubin–Nitsche analysis has $H^2$-regularity, and assume the manufactured $u$ belongs to $H^{p+1}(\\Omega)$.\n\nYou wish to (i) formulate the expected convergence rates in the $H^1$-seminorm and the Lebesgue $L^2$-norm of the error, and (ii) describe practical, computable procedures to evaluate the discrete error using either the nodal interpolation operator or an $L^2$-orthogonal projection of $u$ onto the finite element space.\n\nSelect the option that correctly states both the asymptotic rates and a valid, computable error evaluation approach under the stated assumptions.\n\nA. For $u\\in H^{p+1}(\\Omega)$ and $H^1$-conforming FEM of degree $p$, the errors satisfy\n$$\n\\|\\nabla(u-u_h)\\|_{L^2(\\Omega)}=\\mathcal{O}(h^p),\\qquad \\|u-u_h\\|_{L^2(\\Omega)}=\\mathcal{O}(h^{p+1}).\n$$\nIn practice, one may compute the norms directly by high-order quadrature of $u-u_h$. Alternatively, one may form the nodal interpolant $I_h u\\in V_h$ and the $L^2$-projection $P_h u\\in V_h$ (via the mass matrix) and compute the proxies $\\|\\nabla(I_h u-u_h)\\|_{L^2(\\Omega)}$ and $\\|P_h u-u_h\\|_{L^2(\\Omega)}$, which are fully computable in the discrete space and exhibit the same asymptotic rates as the true errors.\n\nB. For $u\\in H^{p+1}(\\Omega)$ and $H^1$-conforming FEM of degree $p$, the errors satisfy\n$$\n\\|\\nabla(u-u_h)\\|_{L^2(\\Omega)}=\\mathcal{O}(h^{p+1}),\\qquad \\|u-u_h\\|_{L^2(\\Omega)}=\\mathcal{O}(h^{p+2}).\n$$\nThe discrete $L^2$-error can be computed exactly by replacing $u$ with its nodal interpolant $I_h u$ and evaluating $\\|I_h u-u_h\\|_{L^2(\\Omega)}$, which equals $\\|u-u_h\\|_{L^2(\\Omega)}$ on any mesh.\n\nC. For $u\\in H^{p+1}(\\Omega)$ and $H^1$-conforming FEM of degree $p$, the $H^1$-error satisfies $\\|\\nabla(u-u_h)\\|_{L^2(\\Omega)}=\\mathcal{O}(h^p)$ but the $L^2$-error cannot exceed $\\mathcal{O}(h^p)$ unless $u\\in H^{p+2}(\\Omega)$. Computing the $L^2$-error by an $L^2$-projection $P_h u$ does not change this limitation.\n\nD. The nodal maximum error $\\max_{\\text{nodes}}|u-u_h|$ is a reliable proxy that is equivalent to the $H^1$-seminorm of the error on quasi-uniform meshes, and thus its rate is $\\mathcal{O}(h^{p+1})$ for degree $p$ elements.",
            "solution": "The problem asks for the expected convergence rates of the Finite Element Method (FEM) for a second-order elliptic PDE and for a description of practical methods to compute the error, particularly in the context of the Method of Manufactured Solutions (MMS).\n\n### Derivation of Theoretical Convergence Rates\n\nLet $u_h \\in V_h$ be the finite element solution, where $V_h$ is the space of continuous piecewise polynomials of degree $p$. The error is $e = u - u_h$.\n\n**1. Error in the $H^1$-seminorm, $\\|\\nabla(u-u_h)\\|_{L^2(\\Omega)}$**\n\nThe fundamental error estimate for this class of elliptic problems is given by Céa's Lemma, which states that the FEM solution is quasi-optimal in the energy norm. For the PDE $-\\Delta u = f$, the energy norm is equivalent to the $H^1$-seminorm, $\\|\\cdot\\|_{H^1_0(\\Omega)}$. The lemma states:\n$$\n\\|\\nabla(u-u_h)\\|_{L^2(\\Omega)} \\le C \\inf_{v_h \\in V_h} \\|\\nabla(u-v_h)\\|_{L^2(\\Omega)}\n$$\nwhere $C$ is a constant independent of the meshsize $h$. The term on the right is the best approximation error in the $H^1$-seminorm. This error can be bounded by the error of a specific choice of $v_h$, such as the nodal interpolant $I_h u \\in V_h$.\n$$\n\\inf_{v_h \\in V_h} \\|\\nabla(u-v_h)\\|_{L^2(\\Omega)} \\le \\|\\nabla(u - I_h u)\\|_{L^2(\\Omega)}\n$$\nStandard interpolation theory for Lagrange elements of degree $p$ on a shape-regular, quasi-uniform mesh family provides the estimate:\n$$\n\\|\\nabla(u - I_h u)\\|_{L^2(\\Omega)} \\le C_1 h^k \\|u\\|_{H^{k+1}(\\Omega)}\n$$\nfor a function $u \\in H^{k+1}(\\Omega)$. The problem assumes $u \\in H^{p+1}(\\Omega)$, so we can take $k=p$. Combining these results, we get:\n$$\n\\|\\nabla(u-u_h)\\|_{L^2(\\Omega)} \\le C \\cdot (C_1 h^p \\|u\\|_{H^{p+1}(\\Omega)}) = \\mathcal{O}(h^p)\n$$\nThus, the expected convergence rate for the error in the $H^1$-seminorm is $\\mathcal{O}(h^p)$.\n\n**2. Error in the $L^2$-norm, $\\|u-u_h\\|_{L^2(\\Omega)}$**\n\nTo obtain the $L^2$-error estimate, we use the Aubin–Nitsche duality argument. This requires regularity of an associated dual problem. The problem statement explicitly assumes the necessary $H^2$-regularity on the convex domain $\\Omega$, which is a standard result for the Laplacian. Let $\\phi$ be the solution to the dual problem $-\\Delta \\phi = e = u-u_h$ in $\\Omega$, with $\\phi = 0$ on $\\partial\\Omega$. The $H^2$-regularity assumption implies $\\|\\phi\\|_{H^2(\\Omega)} \\le C_{reg} \\|e\\|_{L^2(\\Omega)}$.\n\nThe derivation proceeds as:\n$$\n\\|u-u_h\\|_{L^2(\\Omega)}^2 = \\int_\\Omega e^2 \\,d\\mathbf{x} = \\int_\\Omega e(-\\Delta\\phi)\\,d\\mathbf{x}\n$$\nIntegrating by parts and using Galerkin orthogonality ($\\int_\\Omega \\nabla(u-u_h)\\cdot\\nabla v_h\\,d\\mathbf{x}=0$ for all test functions $v_h$ in the appropriate space) gives:\n$$\n\\|u-u_h\\|_{L^2(\\Omega)}^2 = \\int_\\Omega \\nabla e \\cdot \\nabla \\phi \\,d\\mathbf{x} = \\int_\\Omega \\nabla(u-u_h) \\cdot \\nabla(\\phi-v_h) \\,d\\mathbf{x}\n$$\nfor any $v_h$ from the test space. Using the Cauchy-Schwarz inequality:\n$$\n\\|u-u_h\\|_{L^2(\\Omega)}^2 \\le \\|\\nabla(u-u_h)\\|_{L^2(\\Omega)} \\|\\nabla(\\phi-v_h)\\|_{L^2(\\Omega)}\n$$\nChoosing $v_h$ as the interpolant of $\\phi$, $I_h\\phi$, and using the interpolation estimate for the gradient with $p=1$ (since we only know $\\phi \\in H^2(\\Omega)$): $\\|\\nabla(\\phi - I_h\\phi)\\|_{L^2(\\Omega)} \\le C_2 h \\|\\phi\\|_{H^2(\\Omega)}$.\nSubstituting this and the regularity estimate for $\\phi$:\n$$\n\\|u-u_h\\|_{L^2(\\Omega)}^2 \\le \\|\\nabla(u-u_h)\\|_{L^2(\\Omega)} (C_2 h \\|\\phi\\|_{H^2(\\Omega)}) \\le \\|\\nabla(u-u_h)\\|_{L^2(\\Omega)} (C_2 h C_{reg} \\|u-u_h\\|_{L^2(\\Omega)})\n$$\nDividing by $\\|u-u_h\\|_{L^2(\\Omega)}$ (for a non-zero error) yields:\n$$\n\\|u-u_h\\|_{L^2(\\Omega)} \\le C_2 C_{reg} h \\|\\nabla(u-u_h)\\|_{L^2(\\Omega)}\n$$\nFinally, substituting the $H^1$-seminorm error rate we derived, $\\|\\nabla(u-u_h)\\|_{L^2(\\Omega)} = \\mathcal{O}(h^p)$:\n$$\n\\|u-u_h\\|_{L^2(\\Omega)} \\le (C_{const} h) \\cdot \\mathcal{O}(h^p) = \\mathcal{O}(h^{p+1})\n$$\nThus, the expected convergence rate for the error in the $L^2$-norm is $\\mathcal{O}(h^{p+1})$.\n\n### Practical Error Evaluation in MMS\n\nIn MMS, one computes the error norms $\\|u-u_h\\|_{L^2(\\Omega)}$ and $\\|\\nabla(u-u_h)\\|_{L^2(\\Omega)}$ for a sequence of refined meshes to verify that the observed convergence rate matches the theory.\nSince $u$ is a known analytical function (not a polynomial) and $u_h$ is a piecewise polynomial, the integrands $(u-u_h)^2$ and $|\\nabla(u-u_h)|^2$ are not typically polynomials. Therefore, the integrals must be computed using numerical quadrature. To ensure the quadrature error does not pollute the discretization error measurement, a quadrature rule of sufficiently high order must be used.\n\nAn alternative approach, which avoids evaluating the transcendental function $u$ at many quadrature points, is to use a proxy for the error that lives entirely in the finite element space. Two common choices are:\n1.  **Nodal Interpolant, $I_h u$**: $I_h u$ is the function in $V_h$ that matches $u$ at all nodal points. We can compute $\\|I_h u - u_h\\|_{L^2(\\Omega)}$ and $\\|\\nabla(I_h u - u_h)\\|_{L^2(\\Omega)}$.\n2.  **$L^2$-Projection, $P_h u$**: $P_h u$ is the function in $V_h$ that is the best approximation to $u$ in the $L^2$-norm. It requires solving a linear system involving the mass matrix.\n\nBy the triangle inequality and standard interpolation estimates, these proxies can be shown to have the same asymptotic convergence rates as the true errors. For instance:\n$$\n\\|u-u_h\\|_{L^2} \\le \\|u-I_h u\\|_{L^2} + \\|I_h u-u_h\\|_{L^2}\n$$\nand\n$$\n\\|I_h u-u_h\\|_{L^2} \\le \\|I_h u-u\\|_{L^2} + \\|u-u_h\\|_{L^2}\n$$\nSince $\\|u-I_h u\\|_{L^2} = \\mathcal{O}(h^{p+1})$ and $\\|u-u_h\\|_{L^2} = \\mathcal{O}(h^{p+1})$, it follows that $\\|I_h u-u_h\\|_{L^2} = \\mathcal{O}(h^{p+1})$. A similar argument holds for the $H^1$-seminorm, showing $\\|\\nabla(I_h u-u_h)\\|_{L^2} = \\mathcal{O}(h^p)$. The integrals for these proxy errors involve only piecewise polynomials and can be computed exactly (up to machine precision) with an appropriate quadrature rule.\n\n### Evaluation of Options\n\n**A. For $u\\in H^{p+1}(\\Omega)$ and $H^1$-conforming FEM of degree $p$, the errors satisfy $\\|\\nabla(u-u_h)\\|_{L^2(\\Omega)}=\\mathcal{O}(h^p),\\qquad \\|u-u_h\\|_{L^2(\\Omega)}=\\mathcal{O}(h^{p+1}).$ [...] In practice, one may compute the norms directly by high-order quadrature of $u-u_h$. Alternatively, one may form the nodal interpolant $I_h u\\in V_h$ and the $L^2$-projection $P_h u\\in V_h$ (via the mass matrix) and compute the proxies $\\|\\nabla(I_h u-u_h)\\|_{L^2(\\Omega)}$ and $\\|P_h u-u_h\\|_{L^2(\\Omega)}$, which are fully computable in the discrete space and exhibit the same asymptotic rates as the true errors.**\n\nThis option correctly states the theoretical convergence rates, $\\|\\nabla(u-u_h)\\|_{L^2(\\Omega)}=\\mathcal{O}(h^p)$ and $\\|u-u_h\\|_{L^2(\\Omega)}=\\mathcal{O}(h^{p+1})$, which match our derivation. It also correctly describes two valid practical procedures for error evaluation: high-order quadrature of the true error, or computation of norms of discrete proxies ($I_h u - u_h$ or $P_h u - u_h$), correctly stating that these proxies exhibit the same asymptotic rates.\n**Verdict: Correct.**\n\n**B. For $u\\in H^{p+1}(\\Omega)$ and $H^1$-conforming FEM of degree $p$, the errors satisfy $\\|\\nabla(u-u_h)\\|_{L^2(\\Omega)}=\\mathcal{O}(h^{p+1}),\\qquad \\|u-u_h\\|_{L^2(\\Omega)}=\\mathcal{O}(h^{p+2}).$ [...]**\n\nThis option states incorrect convergence rates. The rate in the $H^1$-seminorm is $\\mathcal{O}(h^p)$, not $\\mathcal{O}(h^{p+1})$. The rates given would be expected if the solution had higher regularity, i.e., $u \\in H^{p+2}(\\Omega)$. The claim that $\\|I_h u-u_h\\|_{L^2(\\Omega)}$ *equals* $\\|u-u_h\\|_{L^2(\\Omega)}$ is also false.\n**Verdict: Incorrect.**\n\n**C. For $u\\in H^{p+1}(\\Omega)$ and $H^1$-conforming FEM of degree $p$, the $H^1$-error satisfies $\\|\\nabla(u-u_h)\\|_{L^2(\\Omega)}=\\mathcal{O}(h^p)$ but the $L^2$-error cannot exceed $\\mathcal{O}(h^p)$ unless $u\\in H^{p+2}(\\Omega)$. [...]**\n\nThis option incorrectly states the $L^2$-error rate. The Aubin-Nitsche argument provides the additional power of $h$, yielding an $\\mathcal{O}(h^{p+1})$ rate for the $L^2$-error, given that $u \\in H^{p+1}(\\Omega)$ and the dual problem has $H^2$-regularity. Increased solution regularity to $u \\in H^{p+2}(\\Omega)$ would be required to achieve an $\\mathcal{O}(h^{p+2})$ rate, but not just to improve from $\\mathcal{O}(h^p)$.\n**Verdict: Incorrect.**\n\n**D. The nodal maximum error $\\max_{\\text{nodes}}|u-u_h|$ is a reliable proxy that is equivalent to the $H^1$-seminorm of the error on quasi-uniform meshes, and thus its rate is $\\mathcal{O}(h^{p+1})$ for degree $p$ elements.**\n\nThis option is fundamentally flawed. The nodal maximum error is a pointwise quantity, which is not equivalent to the $H^1$-seminorm, an integral quantity over the domain. Furthermore, it misstates the convergence rate of the $H^1$-seminorm, which is $\\mathcal{O}(h^p)$, not $\\mathcal{O}(h^{p+1})$. The nodal error may be related to the $L^\\infty$ norm of the error, but not the $H^1$-seminorm.\n**Verdict: Incorrect.**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "Building on the fundamentals, this next practice demonstrates the versatility of MMS beyond simple Cartesian domains and Dirichlet boundary conditions. Here, you will tackle a diffusion problem on a unit disk, which requires working in polar coordinates and handling Neumann (flux) boundary conditions . The core task remains the same—deriving the source term and boundary data from the manufactured solution—but this problem also forces us to confront a physical compatibility condition essential for the existence of a solution.",
            "id": "3420647",
            "problem": "Consider the verification of a diffusion model using the Method of Manufactured Solutions (MMS). Let the domain be the unit disk $\\Omega = \\{(x,y)\\in\\mathbb{R}^{2}: x^{2}+y^{2}1\\}$, described in polar coordinates $(r,\\theta)$ with $r \\in [0,1]$ and $\\theta \\in [0,2\\pi)$, where all angles are in radians. Let the diffusivity be a positive constant $a0$. Consider the Partial Differential Equation (PDE) with Neumann boundary condition\n$$\\nabla \\cdot \\big(a \\nabla u\\big) = f \\quad \\text{in } \\Omega, \\qquad a \\nabla u \\cdot n = h \\quad \\text{on } \\partial\\Omega,$$\nwhere $n$ is the outward unit normal on $\\partial\\Omega$. As a manufactured solution, choose\n$$u(r,\\theta) = \\tfrac{1}{2} r^{2} + r^{3}\\cos(3\\theta) + \\ln(1+r)\\sin(\\theta).$$\nTasks:\n1) Starting from standard vector calculus definitions and coordinate transforms, derive the source term $f$ consistent with the chosen $u$ when $a$ is constant.\n2) Derive the boundary flux $h$ implied by the Neumann boundary condition on $\\partial\\Omega$, expressed as a function $h(\\theta)$ on the unit circle $r=1$.\n3) Using only fundamental theorems (such as the divergence theorem) and the constancy of $a$, explain the origin of the compatibility condition $\\int_{\\Omega} f\\,dx = \\int_{\\partial\\Omega} h\\,ds$.\n4) Evaluate $\\int_{\\Omega} f\\,dx$ and $\\int_{\\partial\\Omega} h\\,ds$ explicitly for the given $u$ and verify the compatibility condition holds.\n\nReport your final answer as the explicit closed-form analytic expression for the boundary flux $h(\\theta)$ on $\\partial\\Omega$. No rounding is required. Angles must be in radians.",
            "solution": "The problem asks to derive the source term $f$ and boundary flux $h$ for a given manufactured solution $u$, explain the origin of a compatibility condition, and verify it. The governing PDE is $\\nabla \\cdot \\big(a \\nabla u\\big) = f$ in a domain $\\Omega$, with a Neumann boundary condition $a \\nabla u \\cdot n = h$ on the boundary $\\partial\\Omega$. The diffusivity $a$ is a positive constant. The domain $\\Omega$ is the unit disk, described in polar coordinates $(r, \\theta)$. The manufactured solution is given as $u(r,\\theta) = \\frac{1}{2} r^{2} + r^{3}\\cos(3\\theta) + \\ln(1+r)\\sin(\\theta)$.\n\n**1) Derivation of the source term $f(r, \\theta)$**\n\nSince $a$ is a constant, the PDE simplifies to $a \\nabla^2 u = f$. We must compute the Laplacian of $u$ in polar coordinates. The Laplacian operator is $\\nabla^2 = \\frac{1}{r}\\frac{\\partial}{\\partial r}\\left(r\\frac{\\partial u}{\\partial r}\\right) + \\frac{1}{r^2}\\frac{\\partial^2 u}{\\partial \\theta^2}$.\n\nFirst, we compute the necessary partial derivatives of $u(r,\\theta)$:\n$\\frac{\\partial u}{\\partial r} = \\frac{\\partial}{\\partial r} \\left(\\frac{1}{2} r^{2} + r^{3}\\cos(3\\theta) + \\ln(1+r)\\sin(\\theta)\\right) = r + 3r^2\\cos(3\\theta) + \\frac{1}{1+r}\\sin(\\theta)$.\n\nNext, we compute the term $\\frac{1}{r}\\frac{\\partial}{\\partial r}\\left(r\\frac{\\partial u}{\\partial r}\\right)$:\n$r\\frac{\\partial u}{\\partial r} = r(r + 3r^2\\cos(3\\theta) + \\frac{1}{1+r}\\sin(\\theta)) = r^2 + 3r^3\\cos(3\\theta) + \\frac{r}{1+r}\\sin(\\theta)$.\n$\\frac{\\partial}{\\partial r}\\left(r\\frac{\\partial u}{\\partial r}\\right) = \\frac{\\partial}{\\partial r}\\left(r^2 + 3r^3\\cos(3\\theta) + \\frac{r}{1+r}\\sin(\\theta)\\right)$.\nUsing the quotient rule for the last term, $\\frac{d}{dr}\\left(\\frac{r}{1+r}\\right) = \\frac{1(1+r) - r(1)}{(1+r)^2} = \\frac{1}{(1+r)^2}$.\nSo, $\\frac{\\partial}{\\partial r}\\left(r\\frac{\\partial u}{\\partial r}\\right) = 2r + 9r^2\\cos(3\\theta) + \\frac{1}{(1+r)^2}\\sin(\\theta)$.\nDividing by $r$ gives:\n$\\frac{1}{r}\\frac{\\partial}{\\partial r}\\left(r\\frac{\\partial u}{\\partial r}\\right) = 2 + 9r\\cos(3\\theta) + \\frac{1}{r(1+r)^2}\\sin(\\theta)$.\n\nNow, we compute the second partial derivative with respect to $\\theta$:\n$\\frac{\\partial u}{\\partial \\theta} = \\frac{\\partial}{\\partial \\theta} \\left(\\frac{1}{2} r^{2} + r^{3}\\cos(3\\theta) + \\ln(1+r)\\sin(\\theta)\\right) = -3r^3\\sin(3\\theta) + \\ln(1+r)\\cos(\\theta)$.\n$\\frac{\\partial^2 u}{\\partial \\theta^2} = \\frac{\\partial}{\\partial \\theta} \\left(-3r^3\\sin(3\\theta) + \\ln(1+r)\\cos(\\theta)\\right) = -9r^3\\cos(3\\theta) - \\ln(1+r)\\sin(\\theta)$.\nDividing by $r^2$ gives:\n$\\frac{1}{r^2}\\frac{\\partial^2 u}{\\partial \\theta^2} = -9r\\cos(3\\theta) - \\frac{\\ln(1+r)}{r^2}\\sin(\\theta)$.\n\nSumming the components to find the Laplacian:\n$\\nabla^2 u = \\left(2 + 9r\\cos(3\\theta) + \\frac{\\sin(\\theta)}{r(1+r)^2}\\right) + \\left(-9r\\cos(3\\theta) - \\frac{\\ln(1+r)\\sin(\\theta)}{r^2}\\right)$.\n$\\nabla^2 u = 2 + \\left(\\frac{1}{r(1+r)^2} - \\frac{\\ln(1+r)}{r^2}\\right)\\sin(\\theta)$.\n\nThe source term $f$ is therefore:\n$f(r, \\theta) = a \\nabla^2 u = a \\left[ 2 + \\left(\\frac{1}{r(1+r)^2} - \\frac{\\ln(1+r)}{r^2}\\right)\\sin(\\theta) \\right]$.\n\n**2) Derivation of the boundary flux $h(\\theta)$**\n\nThe boundary flux is given by $h = a \\nabla u \\cdot n$ on $\\partial\\Omega$. For the unit disk, the boundary $\\partial\\Omega$ is the circle $r=1$, and the outward unit normal vector $n$ is the radial unit vector, $\\hat{r}$.\nThe gradient in polar coordinates is $\\nabla u = \\frac{\\partial u}{\\partial r}\\hat{r} + \\frac{1}{r}\\frac{\\partial u}{\\partial \\theta}\\hat{\\theta}$.\nThus, $\\nabla u \\cdot n = \\nabla u \\cdot \\hat{r} = \\frac{\\partial u}{\\partial r}$.\nWe must evaluate this quantity at the boundary $r=1$.\n$h(\\theta) = a \\left[ \\frac{\\partial u}{\\partial r} \\right]_{r=1}$.\nFrom our previous calculation:\n$\\frac{\\partial u}{\\partial r} = r + 3r^2\\cos(3\\theta) + \\frac{1}{1+r}\\sin(\\theta)$.\nEvaluating at $r=1$:\n$\\left[ \\frac{\\partial u}{\\partial r} \\right]_{r=1} = 1 + 3(1)^2\\cos(3\\theta) + \\frac{1}{1+1}\\sin(\\theta) = 1 + 3\\cos(3\\theta) + \\frac{1}{2}\\sin(\\theta)$.\nThe boundary flux is:\n$h(\\theta) = a \\left( 1 + 3\\cos(3\\theta) + \\frac{1}{2}\\sin(\\theta) \\right)$.\n\n**3) Origin of the compatibility condition**\n\nThe compatibility condition arises from integrating the PDE over the entire domain $\\Omega$ and applying the divergence theorem.\nStart with the PDE: $\\nabla \\cdot (a \\nabla u) = f$.\nIntegrate both sides over the domain $\\Omega$. In two dimensions, the volume element $dx$ is an area element $dA$:\n$\\int_{\\Omega} \\nabla \\cdot (a \\nabla u) \\,dA = \\int_{\\Omega} f \\,dA$.\nThe divergence theorem states that for a vector field $\\mathbf{F}$, $\\int_{\\Omega} \\nabla \\cdot \\mathbf{F} \\,dA = \\oint_{\\partial\\Omega} \\mathbf{F} \\cdot n \\,ds$, where $n$ is the outward unit normal and $ds$ is the line element along the boundary $\\partial\\Omega$.\nLet $\\mathbf{F} = a \\nabla u$. Applying the theorem to the left-hand side of the integrated PDE gives:\n$\\int_{\\Omega} \\nabla \\cdot (a \\nabla u) \\,dA = \\oint_{\\partial\\Omega} (a \\nabla u) \\cdot n \\,ds$.\nFrom the Neumann boundary condition, we have the definition $h = a \\nabla u \\cdot n$. Substituting this into the boundary integral:\n$\\oint_{\\partial\\Omega} (a \\nabla u) \\cdot n \\,ds = \\oint_{\\partial\\Omega} h \\,ds$.\nBy equating the results of integrating both sides of the original PDE, we arrive at the compatibility condition:\n$\\int_{\\Omega} f \\,dA = \\oint_{\\partial\\Omega} h \\,ds$.\nPhysically, this represents a statement of conservation: the total amount of source generated within the domain must equal the total flux across its boundary for a steady-state solution to exist.\n\n**4) Verification of the compatibility condition**\n\nWe must explicitly evaluate both integrals for the derived $f$ and $h$.\n\nFirst, the boundary integral $\\int_{\\partial\\Omega} h\\,ds$:\nThe boundary is the unit circle, so $r=1$ and the line element $ds = r d\\theta |_{r=1} = d\\theta$. Integration is from $\\theta=0$ to $\\theta=2\\pi$.\n$\\int_{\\partial\\Omega} h\\,ds = \\int_0^{2\\pi} h(\\theta)\\,d\\theta = \\int_0^{2\\pi} a \\left( 1 + 3\\cos(3\\theta) + \\frac{1}{2}\\sin(\\theta) \\right) d\\theta$.\n$ = a \\left[ \\int_0^{2\\pi} 1\\,d\\theta + 3\\int_0^{2\\pi} \\cos(3\\theta)\\,d\\theta + \\frac{1}{2}\\int_0^{2\\pi} \\sin(\\theta)\\,d\\theta \\right]$.\nThe definite integrals of $\\cos(n\\theta)$ and $\\sin(n\\theta)$ for any non-zero integer $n$ over a full period $[0, 2\\pi]$ are zero.\n$\\int_0^{2\\pi} \\cos(3\\theta)\\,d\\theta = \\left[\\frac{\\sin(3\\theta)}{3}\\right]_0^{2\\pi} = 0$.\n$\\int_0^{2\\pi} \\sin(\\theta)\\,d\\theta = [-\\cos(\\theta)]_0^{2\\pi} = -1 - (-1) = 0$.\nThe only non-zero contribution is from the constant term:\n$\\int_{\\partial\\Omega} h\\,ds = a \\left( [\\theta]_0^{2\\pi} + 3(0) + \\frac{1}{2}(0) \\right) = 2\\pi a$.\n\nSecond, the domain integral $\\int_{\\Omega} f\\,dA$:\nThe area element in polar coordinates is $dA = r\\,dr\\,d\\theta$.\n$\\int_{\\Omega} f\\,dA = \\int_0^{2\\pi} \\int_0^1 a \\left[ 2 + \\left(\\frac{1}{r(1+r)^2} - \\frac{\\ln(1+r)}{r^2}\\right)\\sin(\\theta) \\right] r\\,dr\\,d\\theta$.\n$= a \\int_0^{2\\pi} \\int_0^1 \\left[ 2r + \\left(\\frac{1}{(1+r)^2} - \\frac{\\ln(1+r)}{r}\\right)\\sin(\\theta) \\right] dr\\,d\\theta$.\nWe can separate the integral using Fubini's theorem:\n$= a \\left( \\int_0^{2\\pi} \\int_0^1 2r\\,dr\\,d\\theta + \\int_0^{2\\pi} \\int_0^1 \\left(\\frac{1}{(1+r)^2} - \\frac{\\ln(1+r)}{r}\\right)\\sin(\\theta)\\,dr\\,d\\theta \\right)$.\n$= a \\left( \\left(\\int_0^1 2r\\,dr\\right) \\left(\\int_0^{2\\pi} d\\theta\\right) + \\left(\\int_0^1 \\left[\\frac{1}{(1+r)^2} - \\frac{\\ln(1+r)}{r}\\right]dr\\right) \\left(\\int_0^{2\\pi} \\sin(\\theta)\\,d\\theta\\right) \\right)$.\nAs established before, $\\int_0^{2\\pi} \\sin(\\theta)\\,d\\theta = 0$. Thus, the second term vanishes entirely, greatly simplifying the calculation.\nWe are left with:\n$\\int_{\\Omega} f\\,dA = a \\left( \\int_0^1 2r\\,dr \\right) \\left( \\int_0^{2\\pi} d\\theta \\right) = a \\left( [r^2]_0^1 \\right) \\left( [\\theta]_0^{2\\pi} \\right) = a (1) (2\\pi) = 2\\pi a$.\n\nSince $\\int_{\\Omega} f\\,dA = 2\\pi a$ and $\\oint_{\\partial\\Omega} h\\,ds = 2\\pi a$, the compatibility condition is verified.\n\nThe problem asks for the explicit closed-form analytic expression for the boundary flux $h(\\theta)$ as the final answer.\n$h(\\theta) = a \\left( 1 + 3\\cos(3\\theta) + \\frac{1}{2}\\sin(\\theta) \\right)$.",
            "answer": "$$\\boxed{a \\left( 1 + 3\\cos(3\\theta) + \\frac{1}{2}\\sin(\\theta) \\right)}$$"
        },
        {
            "introduction": "This final practice explores a more subtle and advanced aspect of verification: the interplay between a method's order and the solution's smoothness. In an ideal world, we would always test with infinitely smooth manufactured solutions, but real-world problems can have limited regularity. This exercise  deliberately uses a manufactured solution with a singularity to show how this limited regularity can \"pollute\" the convergence rate, preventing a high-order method from achieving its full potential. Understanding this phenomenon is critical for correctly interpreting verification results.",
            "id": "3420663",
            "problem": "Consider the Method of Manufactured Solutions (MMS) for verifying a high-order conforming Finite Element Method (FEM) for the one-dimensional Poisson equation. Let the domain be $\\Omega = (0,1)$, and consider the boundary value problem\n$$\n-u''(x) = f(x) \\quad \\text{for } x \\in (0,1), \\qquad u(0) = 0, \\quad u(1) = 0.\n$$\nManufacture the exact solution by choosing\n$$\nu(x) = x^{\\beta}(1-x),\n$$\nwith a fixed exponent $\\beta  0$, and define $f(x)$ by enforcing $f(x) = -u''(x)$ so that $u$ is the exact solution. Assume $\\beta = 1.6$, so that the forcing $f$ is integrable in a manner consistent with the weak formulation, and note that the singularity at $x=0$ limits the Sobolev regularity of $u$.\n\nYou discretize the problem using a conforming FEM with piecewise polynomials of degree $p=4$ on a quasi-uniform mesh with characteristic size $h$. Assume standard Galerkin stability and approximation properties on $(0,1)$, and that the duality argument for $L^2$-error applies under the given regularity.\n\nUsing the foundational facts of weak solution theory for elliptic equations, Céa’s lemma (which bounds the Galerkin error by the best approximation error in the energy norm), Bramble–Hilbert-type approximation properties, and Aubin–Nitsche duality for the $L^2$ norm, determine the asymptotic algebraic convergence rates with respect to $h$ in the energy norm $\\|\\cdot\\|_{H^1(0,1)}$ and the $L^2(0,1)$ norm, accounting for the limited regularity of the manufactured solution near $x=0$.\n\nWhich option correctly states the achievable rates?\n\nA. $H^1$-error $\\sim \\mathcal{O}(h^{1.1})$, $L^2$-error $\\sim \\mathcal{O}(h^{2.1})$.\n\nB. $H^1$-error $\\sim \\mathcal{O}(h^{4})$, $L^2$-error $\\sim \\mathcal{O}(h^{5})$.\n\nC. $H^1$-error $\\sim \\mathcal{O}(h^{1.6})$, $L^2$-error $\\sim \\mathcal{O}(h^{2.6})$.\n\nD. $H^1$-error $\\sim \\mathcal{O}(h^{2.1})$, $L^2$-error $\\sim \\mathcal{O}(h^{3.1})$.",
            "solution": "### Derivation of Convergence Rates\n\nThe convergence rates of a conforming Finite Element Method depend on two main factors: the polynomial degree $p$ of the basis functions and the Sobolev regularity $s$ of the exact solution $u$. The standard error estimates for a solution $u \\in H^s(\\Omega)$ and a FEM using polynomials of degree $p$ on a quasi-uniform mesh of size $h$ are given by:\n\n1.  **Energy Norm ($H^1$) Error**: From Céa's lemma and standard approximation theory (e.g., Bramble-Hilbert):\n    $$ \\|u - u_h\\|_{H^1(\\Omega)} \\leq C h^{\\min(p, s-1)} \\|u\\|_{H^s(\\Omega)} $$\n    The asymptotic convergence rate is therefore $\\mathcal{O}(h^{\\min(p, s-1)})$.\n\n2.  **$L^2$ Norm Error**: Using the Aubin–Nitsche duality argument, which is assumed to apply, one can show a higher rate of convergence in the $L^2$ norm:\n    $$ \\|u - u_h\\|_{L^2(\\Omega)} \\leq C h \\|u - u_h\\|_{H^1(\\Omega)} $$\n    Combining this with the $H^1$ estimate gives an overall rate determined by\n    $$ \\|u - u_h\\|_{L^2(\\Omega)} \\leq C' h^{\\min(p+1, s)} \\|u\\|_{H^s(\\Omega)} $$\n    The asymptotic convergence rate is therefore $\\mathcal{O}(h^{\\min(p+1, s)})$.\n\nTo find the specific rates for this problem, we must determine the regularity $s$ of the manufactured solution $u(x) = x^{1.6}(1-x)$.\n\n**Step 1: Determine the Sobolev Regularity $s$**\nThe solution is $u(x) = x^{1.6} - x^{2.6}$. The regularity of $u(x)$ is limited by the behavior of the term $x^{1.6}$ near the boundary point $x=0$.\nFor a function on $(0,1)$ which behaves as $x^\\beta$ for $x \\to 0$, its membership in the Sobolev space $H^k(0,1)$ for an integer $k$ requires that its $k$-th derivative is square-integrable. The $k$-th derivative of $x^\\beta$ behaves like $x^{\\beta-k}$. For this to be in $L^2(0,1)$, we need the integral $\\int_0^\\delta (x^{\\beta-k})^2 dx = \\int_0^\\delta x^{2(\\beta-k)} dx$ to be finite for some $\\delta0$. This requires the exponent to be greater than $-1$:\n$$ 2(\\beta-k)  -1 \\implies 2\\beta + 1  2k \\implies k  \\beta + \\frac{1}{2} $$\nThis result can be extended to non-integer Sobolev spaces. The Sobolev regularity $s$ of a function behaving as $x^\\beta$ is limited by $s  \\beta + 1/2$. The effective regularity that governs the FEM convergence rate is $s = \\beta + 1/2$.\n\nIn this problem, $\\beta = 1.6$. Thus, the regularity of the manufactured solution is:\n$$ s = 1.6 + 0.5 = 2.1 $$\nSo, $u \\in H^s(0,1)$ for all $s  2.1$, but $u \\notin H^{2.1}(0,1)$. The convergence rate is determined by this limiting value $s=2.1$.\n\n**Step 2: Calculate the Convergence Rates**\nWe have the polynomial degree $p=4$ and the solution regularity $s=2.1$. We now substitute these values into the standard error estimate formulas.\n\n-   **$H^1$ Error Rate**:\n    The exponent of $h$ is $\\min(p, s-1)$.\n    $$ \\min(4, 2.1 - 1) = \\min(4, 1.1) = 1.1 $$\n    Therefore, the convergence rate in the $H^1$ norm is $\\mathcal{O}(h^{1.1})$.\n\n-   **$L^2$ Error Rate**:\n    The exponent of $h$ is $\\min(p+1, s)$.\n    $$ \\min(4+1, 2.1) = \\min(5, 2.1) = 2.1 $$\n    Therefore, the convergence rate in the $L^2$ norm is $\\mathcal{O}(h^{2.1})$.\n\nThis result is consistent with the duality argument. The $H^1$ rate is limited by the solution's regularity $(s-1=1.1  p=4)$. The $L^2$ rate is one order higher than the $H^1$ rate, because the dual problem possesses sufficient regularity, giving a full factor of $h$ improvement: $1.1 + 1 = 2.1$. This does not exceed the maximum possible $L^2$ rate, which is also limited by the solution's regularity: $\\min(p+1,s) = \\min(5,2.1)=2.1$.\n\n### Evaluation of Options\n\n**A. $H^1$-error $\\sim \\mathcal{O}(h^{1.1})$, $L^2$-error $\\sim \\mathcal{O}(h^{2.1})$.**\nThis option matches our derived convergence rates precisely.\n**Verdict: Correct.**\n\n**B. $H^1$-error $\\sim \\mathcal{O}(h^{4})$, $L^2$-error $\\sim \\mathcal{O}(h^{5})$.**\nThese are the optimal rates achievable with $p=4$ elements. They would be observed only if the solution were sufficiently regular (i.e., $u \\in H^5(0,1)$ or smoother). Since the regularity is only $s \\approx 2.1$, these rates are not achieved. The regularity, not the polynomial degree, is the limiting factor.\n**Verdict: Incorrect.**\n\n**C. $H^1$-error $\\sim \\mathcal{O}(h^{1.6})$, $L^2$-error $\\sim \\mathcal{O}(h^{2.6})$.**\nThese rates would be obtained if one assumed an incorrect regularity, such as $s = \\beta + 1 = 1.6 + 1 = 2.6$. This is based on a misunderstanding of the relationship between the singularity exponent $\\beta$ and the Sobolev regularity $s$. The correct relationship is $s = \\beta + 1/2$.\n**Verdict: Incorrect.**\n\n**D. $H^1$-error $\\sim \\mathcal{O}(h^{2.1})$, $L^2$-error $\\sim \\mathcal{O}(h^{3.1})$.**\nThis option incorrectly uses the $L^2$ rate for the $H^1$ error and then incorrectly adds $1$ to get an even higher $L^2$ rate. The $H^1$ rate is limited by $s-1=1.1$, not $s=2.1$. This option misapplies the error estimation formulas.\n**Verdict: Incorrect.**",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}