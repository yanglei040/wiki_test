{
    "hands_on_practices": [
        {
            "introduction": "在基于四叉树或八叉树的高性能自适应网格算法中，如何高效地存储和访问网格单元至关重要。将多维的网格坐标映射到一维索引是一种核心技术，它能显著改善数据局部性，并简化邻居查找等关键操作。本练习将引导你从第一性原理出发，推导一种广泛使用的空间填充曲线——Morton 编码（或 Z-序曲线）的正向和反向映射公式，从而深入理解其数学构造。",
            "id": "3404620",
            "problem": "考虑在单位正方形上使用四叉树网格对二维偏微分方程 (PDE) 进行 $hp$-自适应离散化。在固定的四叉树层级 $\\ell \\in \\mathbb{N}$，叶单元构成域的一个均匀二分划分，形成一个 $2^{\\ell} \\times 2^{\\ell}$ 的轴对齐正方形网格。用整数坐标 $(i,j)$ 对这些叶单元进行索引，其中 $i,j \\in \\{0,1,\\dots,2^{\\ell}-1\\}$，$i$ 沿 $x$ 轴增加，$j$ 沿 $y$ 轴增加。为了在有限元法 (FEM) 中高效地进行矩阵组装，需要将每个单元的多项式次数和相关的自由度 (DOF) 连续存储，因此使用 Morton (Z-序) 索引方案，通过位交错 $i$ 和 $j$ 的二进制展开，将坐标对 $(i,j)$ 映射到单个整数键 $m \\in \\{0,1,\\dots,2^{2\\ell}-1\\}$。\n\n从整数的二进制展开和二分四叉树层级定义的基本原理出发，推导出以下显式的闭式表达式（而非算法）：\n- 前向映射 $m$ 作为 $(i,j,\\ell)$ 的函数，通过从最低有效位到最高有效位交错 $i$ 和 $j$ 的位得到，将 $i$ 的位放在 $m$ 的二进制展开中的偶数位置，将 $j$ 的位放在奇数位置，以及\n- 逆映射公式 $i$ 和 $j$ 作为 $(m,\\ell)$ 的函数，通过解交错恢复原始网格索引。\n\n您必须完全使用整数上定义良好的算术运算以及函数 $\\lfloor \\cdot \\rfloor$ 和 $\\bmod$ 来表示您的最终映射，并且必须使用对位位置的求和表示法。使用惯例，对于整数 $x \\ge 0$，其在位置 $k$（最低有效位是位置 $k=0$）的位 $x_{k} \\in \\{0,1\\}$ 由 $x_{k} = \\left\\lfloor \\dfrac{x}{2^{k}} \\right\\rfloor \\bmod 2$ 给出。假设所有位的索引都是从零开始的。\n\n请以三个闭式解析表达式的形式提供您的最终答案：$m(i,j,\\ell)$、$i(m,\\ell)$ 和 $j(m,\\ell)$。最终答案必须是单个闭式解析表达式或格式化为单行矩阵的表达式集合。不需要四舍五入。",
            "solution": "此问题被认为是有效的，因为它具有科学依据、问题适定、客观且自洽。它提出了一个计算科学和数值分析领域的标准、可形式化的任务，没有任何事实错误、歧义或矛盾。\n\n目标是推导在层级为 $\\ell$ 的四叉树中，二维网格索引 $(i,j)$ 与一维索引 $m$ 之间的前向和逆向 Morton (Z-序) 映射的闭式表达式。\n\n首先，我们建立二进制表示的基本原理。任何非负整数 $x$ 都可以唯一地表示为其二进制数字（位）加权的 2 的幂之和。如果 $x$ 可以用 $N$ 位表示，其值为：\n$$x = \\sum_{k=0}^{N-1} x_k 2^k$$\n其中 $x_k \\in \\{0, 1\\}$ 是位置 $k$ 上的位（$k=0$ 是最低有效位）。问题提供了提取该位的公式：\n$$x_k = \\left\\lfloor \\frac{x}{2^k} \\right\\rfloor \\bmod 2$$\n\n网格索引 $i$ 和 $j$ 在范围 $\\{0, 1, \\dots, 2^{\\ell}-1\\}$ 内，这意味着它们可以用 $\\ell$ 位表示。它们的二进制展开式为：\n$$i = \\sum_{k=0}^{\\ell-1} i_k 2^k$$\n$$j = \\sum_{k=0}^{\\ell-1} j_k 2^k$$\nMorton 索引 $m$ 在范围 $\\{0, 1, \\dots, 2^{2\\ell}-1\\}$ 内，这意味着它可以用 $2\\ell$ 位表示。其二进制展开式为：\n$$m = \\sum_{p=0}^{2\\ell-1} m_p 2^p$$\n\n**1. 前向映射 $m(i, j, \\ell)$ 的推导**\n\n问题通过交错 $i$ 和 $j$ 的位来定义前向 Morton 映射。具体来说，$i$ 的第 $k$ 位 $i_k$ 放置在 $m$ 的偶数位置 $2k$ 上，而 $j$ 的第 $k$ 位 $j_k$ 放置在 $m$ 的奇数位置 $2k+1$ 上。形式上：\n$$m_{2k} = i_k, \\quad \\text{for } k \\in \\{0, 1, \\dots, \\ell-1\\}$$\n$$m_{2k+1} = j_k, \\quad \\text{for } k \\in \\{0, 1, \\dots, \\ell-1\\}$$\n\n为了找到 $m$ 的表达式，我们将这些位定义代入其二进制展开式中。我们可以将关于索引 $p$ 的求和分解为偶数位置和奇数位置的两个独立的和。\n令偶数位置为 $p=2k$，奇数位置为 $p=2k+1$。当 $p$ 从 $0$ 到 $2\\ell-1$ 时，两种情况下的索引 $k$ 都从 $0$ 到 $\\ell-1$。\n$$m = \\sum_{p \\text{ is even}} m_p 2^p + \\sum_{p \\text{ is odd}} m_p 2^p$$\n代入 $p=2k$ 和 $p=2k+1$：\n$$m = \\sum_{k=0}^{\\ell-1} m_{2k} 2^{2k} + \\sum_{k=0}^{\\ell-1} m_{2k+1} 2^{2k+1}$$\n现在，我们将 $m$ 的位替换为 $i$ 和 $j$ 的相应位：\n$$m = \\sum_{k=0}^{\\ell-1} i_k 2^{2k} + \\sum_{k=0}^{\\ell-1} j_k 2^{2k+1}$$\n最后，我们代入问题提供的用于提取 $i_k$ 和 $j_k$ 的位的公式：\n$$i_k = \\left\\lfloor \\frac{i}{2^k} \\right\\rfloor \\bmod 2$$\n$$j_k = \\left\\lfloor \\frac{j}{2^k} \\right\\rfloor \\bmod 2$$\n这就得出了前向映射的最终闭式表达式：\n$$m(i, j, \\ell) = \\sum_{k=0}^{\\ell-1} \\left( \\left( \\left\\lfloor \\frac{i}{2^k} \\right\\rfloor \\bmod 2 \\right) 2^{2k} + \\left( \\left\\lfloor \\frac{j}{2^k} \\right\\rfloor \\bmod 2 \\right) 2^{2k+1} \\right)$$\n\n**2. 逆映射 $i(m, \\ell)$ 和 $j(m, \\ell)$ 的推导**\n\n逆映射，或称解交错，是从 Morton 索引 $m$ 中恢复原始网格索引 $i$ 和 $j$ 的过程。我们从 $i$ 和 $j$ 的二进制展开式开始：\n$$i = \\sum_{k=0}^{\\ell-1} i_k 2^k$$\n$$j = \\sum_{k=0}^{\\ell-1} j_k 2^k$$\n根据前向映射的定义，我们知道 $i$ 和 $j$ 的位被嵌入到 $m$ 的特定位置：\n$$i_k = m_{2k}$$\n$$j_k = m_{2k+1}$$\n我们可以将这些代入 $i$ 和 $j$ 的二进制展开式中：\n$$i = \\sum_{k=0}^{\\ell-1} m_{2k} 2^k$$\n$$j = \\sum_{k=0}^{\\ell-1} m_{2k+1} 2^k$$\n现在，我们使用给定的公式从 $m$ 中提取位 $m_p$：\n$$m_p = \\left\\lfloor \\frac{m}{2^p} \\right\\rfloor \\bmod 2$$\n分别用 $2k$ 和 $2k+1$ 替换 $p$，我们得到：\n$$m_{2k} = \\left\\lfloor \\frac{m}{2^{2k}} \\right\\rfloor \\bmod 2$$\n$$m_{2k+1} = \\left\\lfloor \\frac{m}{2^{2k+1}} \\right\\rfloor \\bmod 2$$\n将这些表达式代回 $i$ 和 $j$ 的求和式中，即可得到逆映射的最终闭式表达式：\n$$i(m, \\ell) = \\sum_{k=0}^{\\ell-1} \\left( \\left\\lfloor \\frac{m}{2^{2k}} \\right\\rfloor \\bmod 2 \\right) 2^k$$\n$$j(m, \\ell) = \\sum_{k=0}^{\\ell-1} \\left( \\left\\lfloor \\frac{m}{2^{2k+1}} \\right\\rfloor \\bmod 2 \\right) 2^k$$\n这三个关于 $m(i, j, \\ell)$、$i(m, \\ell)$ 和 $j(m, \\ell)$ 的表达式满足问题陈述的所有要求。",
            "answer": "$$\\boxed{\\begin{pmatrix} m(i,j,\\ell) = \\sum_{k=0}^{\\ell-1} \\left( 2^{2k} \\left( \\left\\lfloor \\frac{i}{2^k} \\right\\rfloor \\bmod 2 \\right) + 2^{2k+1} \\left( \\left\\lfloor \\frac{j}{2^k} \\right\\rfloor \\bmod 2 \\right) \\right) \\\\ i(m,\\ell) = \\sum_{k=0}^{\\ell-1} 2^k \\left( \\left\\lfloor \\frac{m}{2^{2k}} \\right\\rfloor \\bmod 2 \\right) \\\\ j(m,\\ell) = \\sum_{k=0}^{\\ell-1} 2^k \\left( \\left\\lfloor \\frac{m}{2^{2k+1}} \\right\\rfloor \\bmod 2 \\right) \\end{pmatrix}}$$"
        },
        {
            "introduction": "在自适应网格上应用有限元方法会带来一个独特的挑战：非协调界面（non-conforming interfaces）的出现，即一个大单元与多个小单元相邻。为了保证全局解的 $C^0$ 连续性，必须对小单元边界上的“悬挂节点”自由度进行约束，用相邻大单元的自由度来表示。本练习将具体探讨二次（$\\mathbb{Q}_2$）单元的情况，要求你推导维持连续性所必需的约束关系，这是实现可靠的自适应有限元求解器的关键一步。",
            "id": "3404633",
            "problem": "考虑一个二维四叉树网格，其在一个笔直的内部边上存在单层级差异（1:2 细化）。设一个采用张量积双二次 $\\mathbb{Q}_{2}$ 有限元的粗四边形单元 $\\Omega_{c}$，沿着一条共享边 $E$ 与两个细化的子单元 $\\Omega_{f}^{-}$ 和 $\\Omega_{f}^{+}$ 邻接。假设在节点位于 $\\{-1,0,1\\}^{2}$ 的双单位正方形参考单元上使用标准的节点拉格朗日插值。用一个从底端点到顶端点递增的坐标 $s \\in [-1,1]$ 来参数化粗边 $E$。细化的邻元在 $s=0$ 处将 $E$ 分割为两个子边 $E^{-} = [-1,0]$ 和 $E^{+} = [0,1]$，每个子边都在其端点和中点处配备了 $\\mathbb{Q}_{2}$ 边节点，因此沿 $E$ 的唯一细边节点位于 $s \\in \\{-1,-\\tfrac{1}{2},0,\\tfrac{1}{2},1\\}$。\n\n在沿 $E$ 的迹空间中进行操作。令 $\\ell_{0}(s)$ 表示粗边上与 $s=0$ 处的边中点节点相关联的一维二次拉格朗日基函数。仅使用区间上拉格朗日插值的基本定义，以及一个二次函数在子区间上由其三个插值节点上的值唯一确定这一事实。从第一性原理出发，通过将 $\\Omega_{c}$ 上的粗边中点自由度表示为 $\\Omega_{f}^{-}$ 和 $\\Omega_{f}^{+}$ 的细边自由度的线性组合，来推导强制实现全局 $C^{0}$ 连续性的约束。换句话说，确定唯一的系数行向量 $\\mathbf{c} \\in \\mathbb{R}^{5}$，使得 $\\ell_{0}(s)$ 在 $E$ 上的细化迹空间中的限制，可以由与 $s \\in \\{-1,-\\tfrac{1}{2},0,\\tfrac{1}{2},1\\}$ 处的细边节点相关联的节点基精确表示，其系数由 $\\mathbf{c}$ 的分量给出。\n\n按照节点顺序 $s=-1,-\\tfrac{1}{2},0,\\tfrac{1}{2},1$ 提供显式的 $1 \\times 5$ 约束行向量 $\\mathbf{c}$。最终答案必须是单个闭式解析表达式。无需进行四舍五入。",
            "solution": "用户提供的问题已经过分析，并被认为是有效的。它在科学上基于有限元方法的原理，特别是关于自适应细化网格上的 $C^0$ 连续性。该问题是适定的、客观的，并包含了根据要求从第一性原理推导出唯一解所需的所有必要信息。\n\n任务是确定一个约束向量，以确保在一个四边形单元被细化为两个的界面上，二次有限元能够保持 $C^0$ 连续性。这是通过用共享边上的细网格基函数来表示粗网格基函数来实现的。\n\n问题陈述要求“确定唯一的系数行向量 $\\mathbf{c} \\in \\mathbb{R}^{5}$，使得 $\\ell_{0}(s)$ 在 $E$ 上的细化迹空间中的限制，可以由与细边节点相关联的节点基精确表示...”。这是一个精确且定义明确的数学问题。它要求找到系数 $c_j$，使得 $\\ell_{0}(s) = \\sum_{j=1}^{5} c_j \\hat{\\ell}_j(s)$，其中 $\\ell_0(s)$ 是粗网格基函数，而 $\\hat{\\ell}_j(s)$ 是细网格基函数。\n\n让我们首先定义粗网格基函数 $\\ell_0(s)$。粗边 $E$ 由 $s \\in [-1,1]$ 参数化。有限元被指定为 $\\mathbb{Q}_2$，这意味着此边上的迹空间是二次多项式空间 $P_2([-1,1])$。该空间的节点基由 $s \\in \\{-1, 0, 1\\}$ 处的节点定义。基函数 $\\ell_0(s)$ 与 $s=0$ 处的中心节点相关联。根据拉格朗日基函数的定义，$\\ell_0(s)$ 必须满足：\n$$ \\ell_0(-1) = 0 $$\n$$ \\ell_0(0) = 1 $$\n$$ \\ell_0(1) = 0 $$\n满足这些条件的唯一二次多项式是：\n$$ \\ell_0(s) = \\frac{(s - (-1))(s - 1)}{(0 - (-1))(0 - 1)} = \\frac{(s+1)(s-1)}{(1)(-1)} = -(s^2-1) = 1 - s^2 $$\n\n接下来，我们考虑边 $E$ 上的细化迹空间。该空间由在子边 $E^-$（由 $s \\in [-1,0]$ 参数化）上是二次的、且在子边 $E^+$（由 $s \\in [0,1]$ 参数化）上是二次的连续函数组成。该空间的基是与五个唯一的细边节点相关联的节点拉格朗日基函数集合 $\\{\\hat{\\ell}_j(s)\\}_{j=1}^{5}$。问题指定了节点位置的有序集合为 $s \\in \\{-1, -\\frac{1}{2}, 0, \\frac{1}{2}, 1\\}$。我们用 $\\hat{s}_j$（其中 $j=1, \\dots, 5$）表示这些节点坐标。根据定义，细网格基函数满足 $\\hat{\\ell}_j(\\hat{s}_k) = \\delta_{jk}$，其中 $\\delta_{jk}$ 是克罗内克δ。\n\n我们要找到行向量 $\\mathbf{c} = \\begin{pmatrix} c_1  c_2  c_3  c_4  c_5 \\end{pmatrix}$ 在精确表示中的系数 $c_j$：\n$$ \\ell_0(s) = \\sum_{j=1}^{5} c_j \\hat{\\ell}_j(s) $$\n这个方程表示了函数 $\\ell_0(s)$ 在细网格迹空间上的插值。在节点基中的插值系数就是被插值函数在相应节点处的值。要理解这一点，我们可以在每个细网格节点 $\\hat{s}_k$ 处计算该表达式：\n$$ \\ell_0(\\hat{s}_k) = \\sum_{j=1}^{5} c_j \\hat{\\ell}_j(\\hat{s}_k) = \\sum_{j=1}^{5} c_j \\delta_{jk} = c_k $$\n因此，系数由 $c_k = \\ell_0(\\hat{s}_k)$ 给出。\n\n这保证了表示在五个细网格节点上是精确的。为了确认该表示对所有 $s \\in [-1,1]$ 都精确，我们依赖于这样一个性质：一个区间上的二次多项式由其在三个不同点上的值唯一确定。\n在子区间 $s \\in [-1,0]$ 上，细网格表示 $\\sum_{j=1}^{5} c_j \\hat{\\ell}_j(s)$ 是一个二次多项式。根据构造，它在该子区间上三个节点（$s=-1, -1/2, 0$）处的值与 $\\ell_0(s)$ 在相同点上的值完全相同。由于 $\\ell_0(s)$ 本身就是一个二次多项式，这两个函数在整个子区间 $[-1,0]$ 上必须完全相同。\n一个对称的论证适用于子区间 $s \\in [0,1]$。因此，该等式对所有 $s \\in [-1,1]$ 都成立。\n\n我们现在计算这五个系数：\n1.  对于节点 $\\hat{s}_1 = -1$：\n    $c_1 = \\ell_0(-1) = 1 - (-1)^2 = 1 - 1 = 0$。\n\n2.  对于节点 $\\hat{s}_2 = -\\frac{1}{2}$：\n    $c_2 = \\ell_0(-\\frac{1}{2}) = 1 - (-\\frac{1}{2})^2 = 1 - \\frac{1}{4} = \\frac{3}{4}$。\n\n3.  对于节点 $\\hat{s}_3 = 0$：\n    $c_3 = \\ell_0(0) = 1 - 0^2 = 1$。\n\n4.  对于节点 $\\hat{s}_4 = \\frac{1}{2}$：\n    $c_4 = \\ell_0(\\frac{1}{2}) = 1 - (\\frac{1}{2})^2 = 1 - \\frac{1}{4} = \\frac{3}{4}$。\n\n5.  对于节点 $\\hat{s}_5 = 1$：\n    $c_5 = \\ell_0(1) = 1 - 1^2 = 1 - 1 = 0$。\n\n这些系数构成了所求的约束向量。该向量描述了与粗边中点节点相关联的自由度必须如何分配给细边自由度，以在细化界面上保持有限元解的 $C^0$ 连续性。\n\n对于节点顺序 $s=-1, -\\frac{1}{2}, 0, \\frac{1}{2}, 1$，得到的 $1 \\times 5$ 系数行向量 $\\mathbf{c}$ 为：\n$$ \\mathbf{c} = \\begin{pmatrix} 0  \\frac{3}{4}  1  \\frac{3}{4}  0 \\end{pmatrix} $$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0  \\frac{3}{4}  1  \\frac{3}{4}  0 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "一个高效的 $hp$-自适应方法的核心在于其决策逻辑：如何智能地判断在何处以及如何（通过 $h$ 加密还是 $p$ 提升）来优化网格。理想的策略应以最小的计算成本换取最大的误差缩减。本练习要求你基于著名的Dörfler标记原理，构建一个选择准则，该准则通过对不同加密动作的“增益”（即预测的误差减少量与新增自由度成本之比）进行排序，来优先执行最高效的加密操作。",
            "id": "3404627",
            "problem": "考虑一个在二维四叉树网格上，通过 $hp$-版本有限元法（FEM）离散化的稳态椭圆偏微分方程（PDE）。设当前网格由三个叶单元 $E_1$、$E_2$ 和 $E_3$ 组成，其多项式阶次分别为 $p_1$、$p_2$ 和 $p_3$。假设一个基于残差的后验误差估计子产生的局部指标 $\\eta_i$ 等价于能量范数误差的局部分量，因此总误差的代理量为 $\\sum_{i=1}^{3} \\eta_i$。您需要构建一个Dörfler标记选择准则，该准则通过使用局部模型估计子对 $h$-加密和 $p$-加密操作进行排序，以最大化每个新增自由度（DOF）所带来的预测误差减少量。\n\n从以下基本前提开始：\n- Dörfler标记准则要求选择一组局部修正，其预测的误差减少量总和要达到当前总估计误差的一个目标分数 $\\theta \\in (0,1)$。\n- 对于每个叶单元 $E_i$，局部模型估计子会预测在进行 $h$-加密（四叉树四路分裂）或 $p$-加密（将 $p_i$ 增加 1）后，局部指标将变为当前指标乘以一个系数。具体来说，对于单元 $E_i$，设 $a_i \\in (0,1)$ 为预测的 $h$-加密后系数，$b_i \\in (0,1)$ 为预测的 $p$-加密后系数。预测的局部误差减少量为 $r_i^{h} = (1-a_i)\\eta_i$ 和 $r_i^{p} = (1-b_i)\\eta_i$。\n- 局部操作的新增自由度成本由一个与四边形上的 $C^0$ 张量积单元一致的局部计数模型定义：将 $p_i$ 增加到 $p_i+1$ 会使局部内部自由度改变 $\\Delta n_i^{p} = (p_i+2)^2 - (p_i+1)^2 = 2p_i+3$；用相同 $p_i$ 的 4 个子单元替换一个单元会使局部内部自由度改变 $\\Delta n_i^{h} = 4(p_i+1)^2 - (p_i+1)^2 = 3(p_i+1)^2$。\n\n从第一性原理出发，定义一个Dörfler标记准则，该准则为每个单元至多选择一个操作，以满足目标分数，同时最大化每个新增自由度的误差减少量。证明所产生的选择可以由一个增益阈值 $\\lambda_{\\star}$ 来表征，其中一个操作的增益是预测减少量与自由度成本之比。\n\n然后，对于以下四叉树叶单元数据，\n- $(\\eta_1,\\eta_2,\\eta_3) = (0.40, 0.35, 0.25)$，其中 $(p_1,p_2,p_3) = (2,1,3)$，\n- $h$-模型系数 $(a_1,a_2,a_3) = (0.52, 0.60, 0.55)$，\n- $p$-模型系数 $(b_1,b_2,b_3) = (0.35, 0.80, 0.50)$，\n以及体参数 $\\theta = 0.45$，\n\n计算您的准则所隐含的增益阈值 $\\lambda_{\\star}$ 的数值。将您的最终答案表示为一个无单位的精确数。如果您选择呈现一个四舍五入的数值，请四舍五入到四位有效数字。答案必须是一个实数。",
            "solution": "该问题是有效的，因为它在科学上基于自适应有限元方法的理论，其提法良好，数据充分且一致，并以客观、正式的语言表述。我们将提供完整的解答。\n\n该问题要求两件事：首先，为 $hp$-加密制定一个通用的Dörfler标记准则，以最大化每个新增自由度（DOF）的误差减少量；其次，将此准则应用于一个具体的数值案例，并计算由此产生的增益阈值 $\\lambda_{\\star}$。\n\n我们首先将选择准则形式化。目标是为每个单元选择至多一个加密操作，所选操作的集合需要满足 Dörfler 标记条件，同时效率最高。效率定义为最大化每个新增自由度的预测误差减少量。\n\n对于网格中的每个叶单元 $E_i$，有两种可能的加密操作：$h$-加密（类型 $h$）和 $p$-加密（类型 $p$）。\n对单元 $E_i$ 进行类型为 $k \\in \\{h, p\\}$ 的操作，其预测误差减少量记为 $r_i^k$：\n$$r_i^{h} = (1-a_i)\\eta_i$$\n$$r_i^{p} = (1-b_i)\\eta_i$$\n相应的成本（以新增的局部内部自由度衡量）为 $\\Delta n_i^k$：\n$$\\Delta n_i^{h} = 3(p_i+1)^2$$\n$$\\Delta n_i^{p} = 2p_i+3$$\n一个操作 $(i, k)$ 的效率或“增益”是预测减少量与其成本之比：\n$$\\lambda_i^k = \\frac{r_i^k}{\\Delta n_i^k}$$\n这个增益 $\\lambda_i^k$ 代表了特定操作中每个新引入的自由度所带来的预测误差减少量。为最大化整体效率，我们应优先选择增益最高的操作。这导向了一个贪心选择策略。\n\n每个单元 $E_i$ 上最多只能执行一个操作的约束意味着，对于每个单元，我们应首先确定其最有效的潜在加密方式。我们将单元 $E_i$ 的“最佳”操作定义为具有较高增益的操作。设此操作为 $(i, k_i^*)$，其中 $k_i^* = \\arg\\max_{k \\in \\{h, p\\}} \\lambda_i^k$。相应的增益、减少量和成本分别记为 $\\lambda_i^*$、$r_i^*$ 和 $\\Delta n_i^*$。\n\n所提出的Dörfler标记算法如下：\n1.  对每个单元 $E_i$（$i \\in \\{1, \\dots, N\\}$），计算增益 $\\lambda_i^h$ 和 $\\lambda_i^p$。\n2.  对每个单元 $E_i$，确定其最佳候选操作 $(i, k_i^*)$，即具有最大增益 $\\lambda_i^* = \\max(\\lambda_i^h, \\lambda_i^p)$ 的加密类型。这将得到一个包含 $N$ 个候选操作的列表，每个单元一个。\n3.  将这 $N$ 个候选操作按其增益 $\\lambda_i^*$ 降序排序。设排序后的索引列表为 $(j_1, j_2, \\dots, j_N)$，使得 $\\lambda_{j_1}^* \\ge \\lambda_{j_2}^* \\ge \\dots \\ge \\lambda_{j_N}^*$。\n4.  Dörfler 条件要求选择一个操作集合 $S$，使得预测的总减少量达到一个目标：$\\sum_{(i,k) \\in S} r_i^k \\ge \\theta \\mathcal{E}$，其中 $\\mathcal{E} = \\sum_{i=1}^N \\eta_i$ 是总估计误差。\n5.  按照步骤 3 的排序列表，贪心地将候选操作添加到选择集 $S$ 中，直到满足 Dörfler 条件。也就是说，找到最小的整数 $M$，使得 $\\sum_{m=1}^M r_{j_m}^* \\ge \\theta \\mathcal{E}$。所选集合为 $S = \\{(j_m, k_{j_m}^*) \\mid m=1, \\dots, M\\}$。\n6.  这个贪心选择过程可以用一个单一的增益阈值 $\\lambda_{\\star}$ 来表征。添加到集合中的最后一个操作 $(j_M, k_{j_M}^*)$ 在所有被选中的操作中增益最小，为 $\\lambda_{j_M}^*$。任何增益 $\\lambda_i^*  \\lambda_{j_M}^*$ 的候选操作 $(i, k_i^*)$ 都会被选中，而任何增益 $\\lambda_i^*  \\lambda_{j_M}^*$ 的操作则不会。因此，阈值为 $\\lambda_{\\star} = \\lambda_{j_M}^*$，选择规则是选择所有满足 $\\lambda_i^* \\ge \\lambda_{\\star}$ 的每单元最佳操作 $(i, k_i^*)$。\n\n现在，我们将此过程应用于给定的数值数据：\n-  局部指标：$(\\eta_1, \\eta_2, \\eta_3) = (0.40, 0.35, 0.25)$\n-  多项式阶次：$(p_1, p_2, p_3) = (2, 1, 3)$\n-  $h$-模型系数：$(a_1, a_2, a_3) = (0.52, 0.60, 0.55)$\n-  $p$-模型系数：$(b_1, b_2, b_3) = (0.35, 0.80, 0.50)$\n-  体参数：$\\theta = 0.45$\n\n首先，计算总估计误差 $\\mathcal{E}$ 和目标误差减少量：\n$$\\mathcal{E} = \\eta_1 + \\eta_2 + \\eta_3 = 0.40 + 0.35 + 0.25 = 1.00$$\n$$\\text{目标减少量} = \\theta \\mathcal{E} = 0.45 \\times 1.00 = 0.45$$\n\n接下来，我们评估三个单元中每个单元的两种可能的加密操作。\n\n对于单元 $E_1$ ($p_1=2, \\eta_1=0.40, a_1=0.52, b_1=0.35$)：\n-  $h$-加密：\n    - 减少量：$r_1^h = (1-0.52) \\times 0.40 = 0.192$\n    - 成本：$\\Delta n_1^h = 3(2+1)^2 = 27$\n    - 增益：$\\lambda_1^h = \\frac{0.192}{27} \\approx 0.00711$\n-  $p$-加密：\n    - 减少量：$r_1^p = (1-0.35) \\times 0.40 = 0.260$\n    - 成本：$\\Delta n_1^p = 2(2)+3 = 7$\n    - 增益：$\\lambda_1^p = \\frac{0.260}{7} \\approx 0.03714$\n-  比较：$\\lambda_1^p  \\lambda_1^h$。$E_1$ 的最佳操作是 $p$-加密。\n-  候选 1：操作 $(1, p)$，增益 $\\lambda_1^* = \\frac{0.26}{7}$，减少量 $r_1^* = 0.260$。\n\n对于单元 $E_2$ ($p_2=1, \\eta_2=0.35, a_2=0.60, b_2=0.80$)：\n-  $h$-加密：\n    - 减少量：$r_2^h = (1-0.60) \\times 0.35 = 0.140$\n    - 成本：$\\Delta n_2^h = 3(1+1)^2 = 12$\n    - 增益：$\\lambda_2^h = \\frac{0.140}{12} = \\frac{7}{600} \\approx 0.01167$\n-  $p$-加密：\n    - 减少量：$r_2^p = (1-0.80) \\times 0.35 = 0.070$\n    - 成本：$\\Delta n_2^p = 2(1)+3 = 5$\n    - 增益：$\\lambda_2^p = \\frac{0.070}{5} = 0.014$\n-  比较：$\\lambda_2^p  \\lambda_2^h$。$E_2$ 的最佳操作是 $p$-加密。\n-  候选 2：操作 $(2, p)$，增益 $\\lambda_2^* = 0.014$，减少量 $r_2^* = 0.070$。\n\n对于单元 $E_3$ ($p_3=3, \\eta_3=0.25, a_3=0.55, b_3=0.50$)：\n-  $h$-加密：\n    - 减少量：$r_3^h = (1-0.55) \\times 0.25 = 0.1125$\n    - 成本：$\\Delta n_3^h = 3(3+1)^2 = 48$\n    - 增益：$\\lambda_3^h = \\frac{0.1125}{48} \\approx 0.00234$\n-  $p$-加密：\n    - 减少量：$r_3^p = (1-0.50) \\times 0.25 = 0.125$\n    - 成本：$\\Delta n_3^p = 2(3)+3 = 9$\n    - 增益：$\\lambda_3^p = \\frac{0.125}{9} \\approx 0.01389$\n-  比较：$\\lambda_3^p  \\lambda_3^h$。$E_3$ 的最佳操作是 $p$-加密。\n-  候选 3：操作 $(3, p)$，增益 $\\lambda_3^* = \\frac{0.125}{9}$，减少量 $r_3^* = 0.125$。\n\n现在，我们根据增益对三个候选操作进行排序：\n1.  候选 1 (在 $E_1$上)：$\\lambda_1^* = \\frac{0.26}{7} \\approx 0.03714$\n2.  候选 2 (在 $E_2$上)：$\\lambda_2^* = 0.014$\n3.  候选 3 (在 $E_3$上)：$\\lambda_3^* = \\frac{0.125}{9} = \\frac{1}{72} \\approx 0.01389$\n候选操作的排序为 $(1,p)$、$(2,p)$、$(3,p)$。\n\n我们应用贪心选择程序，累积减少量直到达到 0.45 的目标：\n1.  选择操作 $(1, p)$。累积减少量 = $r_1^* = 0.260$。这小于 $0.45$。\n2.  选择操作 $(2, p)$。累积减少量 = $r_1^* + r_2^* = 0.260 + 0.070 = 0.330$。这小于 $0.45$。\n3.  选择操作 $(3, p)$。累积减少量 = $r_1^* + r_2^* + r_3^* = 0.330 + 0.125 = 0.455$。这大于或等于 $0.45$。\n\n在选择了所有三个候选操作后，Dörfler 准则得到满足。添加到集合中的最后一个操作是 $(3, p)$。此操作的增益是所选集合中的最小增益，即增益阈值 $\\lambda_{\\star}$。\n$$\\lambda_{\\star} = \\lambda_3^* = \\frac{0.125}{9} = \\frac{\\frac{1}{8}}{9} = \\frac{1}{72}$$\n增益阈值的精确值为 $\\frac{1}{72}$。",
            "answer": "$$\\boxed{\\frac{1}{72}}$$"
        }
    ]
}