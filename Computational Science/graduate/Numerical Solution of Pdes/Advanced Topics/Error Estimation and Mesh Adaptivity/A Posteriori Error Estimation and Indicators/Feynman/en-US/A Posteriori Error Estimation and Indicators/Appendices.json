{
    "hands_on_practices": [
        {
            "introduction": "To build a solid understanding of a posteriori error estimation, we must begin with the fundamentals of computing the estimators themselves. This exercise grounds the abstract theory in a concrete calculation, starting from the weak formulation of a model elliptic problem. By deriving and computing the element and edge jump residuals for a given finite element function, you will gain hands-on experience with the core components of residual-based error indicators, which form the bedrock of many adaptive algorithms.",
            "id": "3359755",
            "problem": "Consider the model elliptic partial differential equation (PDE) $-\\Delta u = f$ in the unit square domain $\\Omega = (0,1)^2$ with homogeneous Dirichlet boundary conditions $u=0$ on $\\partial \\Omega$. Let $\\mathcal{T}_h$ be a conforming triangulation of $\\Omega$ consisting of two triangles obtained by splitting the square along the diagonal from $(0,0)$ to $(1,1)$:\n- $K_1 = \\operatorname{conv}\\{(0,0),(1,0),(1,1)\\}$,\n- $K_2 = \\operatorname{conv}\\{(0,0),(1,1),(0,1)\\}$.\nThe interior edge (face) is $F = \\operatorname{conv}\\{(0,0),(1,1)\\}$.\n\nLet $u_h \\in V_h$ be the conforming $\\mathbb{P}_1$ (piecewise-linear) finite element function determined by the nodal values\n$u_h(0,0)=0$, $u_h(1,0)=1$, $u_h(1,1)=2$, $u_h(0,1)=0.7$, and let $f \\equiv 1$ in $\\Omega$. Assume the symmetric diffusion tensor is the identity, so the operator is $-\\Delta$. For each element $K \\in \\mathcal{T}_h$, denote its diameter by $h_K$ (the largest distance between any two vertices of $K$), and for each edge $F$ denote its length by $h_F$. For any subdomain $D \\subset \\mathbb{R}^2$, write the $L^2$ norm as $\\|g\\|_{0,D}^2 = \\int_D |g|^2$.\n\nStarting from the weak formulation and Green's identity, derive explicit residual-based formulas for the element indicator $\\eta_K$ and the interior-edge indicator $\\eta_F$ that depend only on local integrals and the known piecewise-constant gradients $\\nabla u_h|_K$. Then, using these formulas:\n- compute $\\eta_{K_1}$ on the element $K_1$ with $h_{K_1}$ chosen as its diameter,\n- compute $\\eta_F$ on the interior edge $F$ with $h_F$ chosen as the edge length,\nand define the combined local indicator for $K_1$ by\n$$\n\\Theta(K_1) = \\sqrt{\\eta_{K_1}^{2} + \\frac{1}{2}\\,\\eta_{F}^{2}}.\n$$\n\nExpress the final value of $\\Theta(K_1)$ as a single simplified analytic expression. No numerical rounding is required, and no physical units are involved.",
            "solution": "The problem asks for the computation of a local a posteriori error indicator for a given piecewise-linear function $u_h$ on a specific triangulation of the unit square $\\Omega = (0,1)^2$ for the Poisson problem $-\\Delta u = f$.\n\nFirst, we must derive the formulas for the residual-based error indicators. The starting point is the weak formulation of the problem: find $u \\in H_0^1(\\Omega)$ such that for all test functions $v \\in H_0^1(\\Omega)$,\n$$\n\\int_\\Omega \\nabla u \\cdot \\nabla v \\, d\\mathbf{x} = \\int_\\Omega f v \\, d\\mathbf{x}.\n$$\nLet $e = u - u_h$ be the error, where $u_h \\in V_h$ is the given finite element function. For any $v \\in H_0^1(\\Omega)$, the error equation is\n$$\n\\int_\\Omega \\nabla e \\cdot \\nabla v \\, d\\mathbf{x} = \\int_\\Omega f v \\, d\\mathbf{x} - \\int_\\Omega \\nabla u_h \\cdot \\nabla v \\, d\\mathbf{x}.\n$$\nWe apply integration by parts (Green's identity) element-wise to the term involving $u_h$:\n$$\n\\int_\\Omega \\nabla u_h \\cdot \\nabla v \\, d\\mathbf{x} = \\sum_{K \\in \\mathcal{T}_h} \\int_K \\nabla u_h \\cdot \\nabla v \\, d\\mathbf{x} = \\sum_{K \\in \\mathcal{T}_h} \\left( \\int_K (-\\Delta u_h) v \\, d\\mathbf{x} + \\int_{\\partial K} (\\nabla u_h \\cdot \\mathbf{n}_K) v \\, ds \\right),\n$$\nwhere $\\mathbf{n}_K$ is the outward unit normal to the boundary $\\partial K$ of element $K$. Substituting this into the error equation yields:\n$$\n\\int_\\Omega \\nabla e \\cdot \\nabla v \\, d\\mathbf{x} = \\sum_{K \\in \\mathcal{T}_h} \\int_K (f + \\Delta u_h) v \\, d\\mathbf{x} - \\sum_{K \\in \\mathcal{T}_h} \\int_{\\partial K} (\\nabla u_h \\cdot \\mathbf{n}_K) v \\, ds.\n$$\nThe sum over element boundaries can be reorganized as a sum over all edges (or faces) $\\mathcal{F}_h$ of the triangulation. For an interior edge $F$ shared by two elements $K_1$ and $K_2$, its contribution is $\\int_F (\\nabla u_h|_{K_1} \\cdot \\mathbf{n}_1 + \\nabla u_h|_{K_2} \\cdot \\mathbf{n}_2) v \\, ds$. This term in parentheses is defined as the jump of the normal flux across $F$, denoted $[\\![ \\nabla u_h \\cdot \\mathbf{n} ]\\!]_F$. Since $v=0$ on $\\partial\\Omega$, the boundary edge terms vanish. The error equation becomes:\n$$\n\\int_\\Omega \\nabla e \\cdot \\nabla v \\, d\\mathbf{x} = \\sum_{K \\in \\mathcal{T}_h} \\int_K (f + \\Delta u_h) v \\, d\\mathbf{x} - \\sum_{F \\in \\mathcal{F}_h^i} \\int_F [\\![ \\nabla u_h \\cdot \\mathbf{n} ]\\!]_F v \\, ds,\n$$\nwhere $\\mathcal{F}_h^i$ is the set of interior edges. The a posteriori error analysis bounds the error norm $\\| \\nabla e \\|_{0,\\Omega}$ by a quantity (the error estimator) that depends on the element residuals $R_K = f + \\Delta u_h$ and the edge jump residuals $J_F = [\\![ \\nabla u_h \\cdot \\mathbf{n} ]\\!]_F$.\n\nThe standard definitions for the local error indicators, which we adopt here, are:\n- The element indicator for an element $K$: $\\eta_K = h_K \\| R_K \\|_{0,K} = h_K \\| f + \\Delta u_h \\|_{0,K}$.\n- The edge indicator for an interior edge $F$: $\\eta_F = h_F^{1/2} \\| J_F \\|_{0,F} = h_F^{1/2} \\| [\\![ \\nabla u_h \\cdot \\mathbf{n} ]\\!] \\|_{0,F}$.\n\nThe problem provides a conforming $\\mathbb{P}_1$ finite element function $u_h$, which is piecewise linear. Therefore, its Laplacian $\\Delta u_h$ is zero within the interior of each element $K$. The formulas simplify to:\n- $\\eta_K = h_K \\| f \\|_{0,K}$.\n- $\\eta_F = h_F^{1/2} \\| [\\![ \\nabla u_h \\cdot \\mathbf{n} ]\\!] \\|_{0,F}$.\n\nNow we compute these quantities for the given setup.\nThe triangulation consists of two triangles:\n- $K_1 = \\operatorname{conv}\\{(0,0),(1,0),(1,1)\\}$, a right triangle with area $|K_1| = 1/2$.\n- $K_2 = \\operatorname{conv}\\{(0,0),(1,1),(0,1)\\}$, a right triangle with area $|K_2| = 1/2$.\nThe interior edge is $F = \\operatorname{conv}\\{(0,0),(1,1)\\}$.\n\nThe function $u_h$ is linear on each element.\nOn $K_1$, $u_h(x,y) = a_1 x + b_1 y + c_1$. Using the nodal values $u_h(0,0)=0$, $u_h(1,0)=1$, $u_h(1,1)=2$:\n- $u_h(0,0) = c_1 = 0$.\n- $u_h(1,0) = a_1 = 1$.\n- $u_h(1,1) = a_1 + b_1 = 2 \\implies 1 + b_1 = 2 \\implies b_1 = 1$.\nSo, $u_h|_{K_1}(x,y) = x+y$. The gradient on $K_1$ is constant: $\\nabla u_h|_{K_1} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$.\n\nOn $K_2$, $u_h(x,y) = a_2 x + b_2 y + c_2$. Using the nodal values $u_h(0,0)=0$, $u_h(0,1)=0.7$, $u_h(1,1)=2$:\n- $u_h(0,0) = c_2 = 0$.\n- $u_h(0,1) = b_2 = 0.7$.\n- $u_h(1,1) = a_2 + b_2 = 2 \\implies a_2 + 0.7 = 2 \\implies a_2 = 1.3$.\nSo, $u_h|_{K_2}(x,y) = 1.3x + 0.7y$. The gradient on $K_2$ is constant: $\\nabla u_h|_{K_2} = \\begin{pmatrix} 1.3 \\\\ 0.7 \\end{pmatrix}$.\n\nNext, we compute the indicators $\\eta_{K_1}$ and $\\eta_F$.\n\n**Calculation of $\\eta_{K_1}$**:\n- The diameter of $K_1$, $h_{K_1}$, is the length of its longest side. The side lengths are $1$, $1$, and $\\sqrt{(1-0)^2 + (1-0)^2} = \\sqrt{2}$. Thus, $h_{K_1} = \\sqrt{2}$.\n- The source function is $f \\equiv 1$.\n- $\\|f\\|_{0,K_1}^2 = \\int_{K_1} f^2 d\\mathbf{x} = \\int_{K_1} 1^2 d\\mathbf{x} = |K_1| = \\frac{1}{2}$.\n- $\\|f\\|_{0,K_1} = \\sqrt{1/2} = 1/\\sqrt{2}$.\n- $\\eta_{K_1} = h_{K_1} \\|f\\|_{0,K_1} = \\sqrt{2} \\cdot \\frac{1}{\\sqrt{2}} = 1$.\n\n**Calculation of $\\eta_F$**:\n- The edge $F$ is the line segment from $(0,0)$ to $(1,1)$. Its length is $h_F = \\sqrt{1^2+1^2} = \\sqrt{2}$.\n- The jump in the normal flux across $F$ is $J_F = [\\![ \\nabla u_h \\cdot \\mathbf{n} ]\\!] = (\\nabla u_h|_{K_1} - \\nabla u_h|_{K_2}) \\cdot \\mathbf{n}$, where $\\mathbf{n}$ is a unit normal vector on $F$. Let's choose the normal pointing from $K_1$ to $K_2$. The edge $F$ lies on the line $y=x$. $K_1$ is in the region $y \\le x$ and $K_2$ is in the region $y \\ge x$. The normal from $K_1$ to $K_2$ is $\\mathbf{n} = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix}$.\n- The difference in gradients is $\\nabla u_h|_{K_1} - \\nabla u_h|_{K_2} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} - \\begin{pmatrix} 1.3 \\\\ 0.7 \\end{pmatrix} = \\begin{pmatrix} -0.3 \\\\ 0.3 \\end{pmatrix}$.\n- The jump $J_F$ is constant along $F$:\n$J_F = \\begin{pmatrix} -0.3 \\\\ 0.3 \\end{pmatrix} \\cdot \\frac{1}{\\sqrt{2}}\\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix} = \\frac{1}{\\sqrt{2}}((-0.3)(-1) + (0.3)(1)) = \\frac{0.3+0.3}{\\sqrt{2}} = \\frac{0.6}{\\sqrt{2}}$.\n- Now we compute the $L^2$ norm of $J_F$ on the edge $F$:\n$\\|J_F\\|_{0,F}^2 = \\int_F |J_F|^2 ds = |J_F|^2 \\int_F ds = |J_F|^2 h_F = \\left(\\frac{0.6}{\\sqrt{2}}\\right)^2 \\sqrt{2} = \\frac{0.36}{2}\\sqrt{2} = 0.18\\sqrt{2}$.\n- The indicator $\\eta_F$ is:\n$\\eta_F^2 = h_F \\|J_F\\|_{0,F}^2 = \\sqrt{2} \\cdot (0.18\\sqrt{2}) = 0.18 \\cdot 2 = 0.36$.\nThus, $\\eta_F = \\sqrt{0.36} = 0.6 = \\frac{3}{5}$.\n\nFinally, we compute the combined local indicator for $K_1$:\n$$\n\\Theta(K_1) = \\sqrt{\\eta_{K_1}^{2} + \\frac{1}{2}\\,\\eta_{F}^{2}}.\n$$\nSubstituting the calculated values:\n$$\n\\Theta(K_1) = \\sqrt{1^2 + \\frac{1}{2}(0.6)^2} = \\sqrt{1 + \\frac{1}{2}(0.36)} = \\sqrt{1 + 0.18} = \\sqrt{1.18}.\n$$\nTo express this as a simplified analytic expression, we use fractions:\n$$\n\\Theta(K_1) = \\sqrt{\\frac{118}{100}} = \\frac{\\sqrt{118}}{\\sqrt{100}} = \\frac{\\sqrt{118}}{10}.\n$$\nThe number $118$ factors as $2 \\times 59$, so no further simplification of the square root is possible.",
            "answer": "$$\n\\boxed{\\frac{\\sqrt{118}}{10}}\n$$"
        },
        {
            "introduction": "Once local error indicators are computed, the next logical step in an adaptive workflow is to decide which elements to refine. This exercise introduces the Dörfler marking strategy, a cornerstone of provably optimal adaptive methods. You will apply this simple yet powerful criterion to a set of given error indicators to determine the minimal group of elements to mark for refinement, illustrating how estimators guide the efficient allocation of computational resources.",
            "id": "3571719",
            "problem": "In a two-dimensional plane-strain linear elastic analysis using the Finite Element Method (FEM), consider an adaptive refinement strategy that combines element subdivision ($h$-refinement) and polynomial degree elevation ($p$-refinement), commonly referred to as $hp$-adaptivity. Let a posteriori error estimation be employed to guide refinement by assigning nonnegative element-wise indicators $\\{\\eta_{i}\\}$ that estimate the local contribution to the energy norm of the discretization error. A common selection strategy is Dörfler marking, which prescribes selecting a minimal subset of elements such that the sum of their indicators reaches a specified fraction of the total indicator sum. Suppose that for a mesh with five elements, the element indicators are given by the multiset $\\{0.5, 0.3, 0.1, 0.05, 0.05\\}$, and the Dörfler marking parameter is $\\theta = 0.5$. Under the assumption that the error indicators are additive with respect to the global energy norm proxy and that marking is performed to satisfy the Dörfler criterion with minimal cardinality, determine the minimal number of elements that must be marked. Provide your final answer as a single integer. No rounding is needed, and no units are required.",
            "solution": "The problem requires the application of the Dörfler marking strategy. The goal is to find the smallest subset of elements, $\\mathcal{M}$, whose summed error indicators meet a specified fraction $\\theta$ of the total error. The criterion is that the sum of the indicators of the marked elements must be at least $\\theta$ times the total sum of all indicators. To find the minimal set, we must use a greedy approach.\n\nFirst, we calculate the total sum of the given indicators:\n$$ S = 0.5 + 0.3 + 0.1 + 0.05 + 0.05 = 1.0 $$\n\nNext, we calculate the target sum required by the Dörfler criterion, using the parameter $\\theta = 0.5$:\n$$ \\text{Target Sum} = \\theta \\times S = 0.5 \\times 1.0 = 0.5 $$\n\nTo satisfy the criterion with the minimal number of elements, we sort the indicators in descending order: $\\{0.5, 0.3, 0.1, 0.05, 0.05\\}$. We then accumulate their sum, starting with the largest, until the target sum is reached or exceeded.\n\n1.  Select the element with the largest indicator, which is $0.5$.\n2.  The cumulative sum is $0.5$.\n3.  Check if this sum meets the target: $0.5 \\ge 0.5$. The condition is satisfied.\n\nSince the criterion is met with the very first element, we do not need to mark any others. The minimal number of elements to be marked is 1.",
            "answer": "$$\\boxed{1}$$"
        },
        {
            "introduction": "Real-world applications often involve nonlinear PDEs, which introduce an additional source of error: the linearization error from the iterative solver (e.g., Newton's method). This practice explores the crucial challenge of balancing this algebraic error with the discretization error estimated by a posteriori indicators. By analyzing different stopping criteria, you will learn to devise a strategy that prevents \"oversolving\"—wasting computational effort by iterating the nonlinear solver to a precision far beyond what the underlying mesh can support—a key concept for the overall efficiency of adaptive methods for nonlinear problems.",
            "id": "3359724",
            "problem": "Consider a strongly monotone, Lipschitz nonlinear elliptic boundary value problem: find $u \\in V$ such that $A(u)=f$ in the variational sense, where $V$ is a Hilbert space continuously embedded into $H^{1}_{0}(\\Omega)$, $A:V \\to V'$ is a nonlinear operator with Gâteaux derivative $A'(w)$, and there exist constants $0<\\alpha \\le L < \\infty$ such that, for all $w,v \\in V$, one has the strong monotonicity and Lipschitz continuity conditions\n$$\\langle A(w)-A(v), w-v \\rangle \\ge \\alpha \\|w-v\\|_{E}^{2}, \\qquad \\|A(w)-A(v)\\|_{V'} \\le L \\|w-v\\|_{E},$$\nwith $\\|\\cdot\\|_{E}$ an energy norm equivalent to the $H^{1}_{0}(\\Omega)$ norm and $\\langle \\cdot,\\cdot \\rangle$ the duality pairing on $V' \\times V$. Let $V_{h} \\subset V$ be a conforming finite element space in the sense of the Finite Element Method (FEM), and let $u_{h}^{\\star} \\in V_{h}$ denote the exact discrete solution satisfying the discrete residual equation $F_{h}(u_{h}^{\\star})=0$, where $F_{h}(w_{h}) \\in V_{h}'$ is defined by $F_{h}(w_{h})[v_{h}] := \\langle A(w_{h}), v_{h} \\rangle - \\langle f, v_{h} \\rangle$ for all $v_{h} \\in V_{h}$. Assume a residual-type a posteriori error estimator $\\eta_{h}(w_{h}) \\ge 0$ is available such that for some mesh-independent reliability constant $C_{\\mathrm{rel}} \\ge 1$ and all $w_{h} \\in V_{h}$ sufficiently close to $u_{h}^{\\star}$,\n$$\\|u - u_{h}^{\\star}\\|_{E} \\le C_{\\mathrm{rel}} \\,\\eta_{h}(u_{h}^{\\star}) \\approx C_{\\mathrm{rel}} \\,\\eta_{h}(w_{h}),$$\nwhere the approximation indicates estimator stability at iterates near $u_{h}^{\\star}$. Suppose Newton’s method is used to solve the discrete nonlinear system: given $u_{h}^{k} \\in V_{h}$, find $\\delta u_{h}^{k} \\in V_{h}$ solving\n$$\\langle A'(u_{h}^{k}) \\,\\delta u_{h}^{k}, v_{h} \\rangle = - F_{h}(u_{h}^{k})[v_{h}] \\quad \\text{for all } v_{h} \\in V_{h}, \\qquad u_{h}^{k+1} := u_{h}^{k} + \\delta u_{h}^{k}.$$\nLet the linearization error be $e_{\\mathrm{lin}}^{k} := u_{h}^{\\star} - u_{h}^{k}$ and the discretization error be $e_{\\mathrm{disc}} := u - u_{h}^{\\star}$. A practical goal is to stop Newton’s iterations on each mesh when the linearization error is balanced with the discretization error as indicated by $\\eta_{h}$, so that further nonlinear iterations would not be cost-effective before mesh refinement.\n\nWhich of the following stopping criteria are appropriate practical rules to achieve this balance, for a fixed parameter $0<\\theta<1$ independent of $h$ and $k$?\n\nA. Stop at the first $k$ such that $\\|\\delta u_{h}^{k}\\|_{E} \\le \\theta \\,\\eta_{h}(u_{h}^{k})$.\n\nB. Stop at the first $k$ such that $\\|F_{h}(u_{h}^{k})\\|_{V_{h}'} \\le \\theta \\,\\eta_{h}(u_{h}^{k})$.\n\nC. Stop at the first $k$ such that $\\|\\delta u_{h}^{k}\\|_{E} \\le \\theta \\,\\eta_{h}(u_{h}^{k})^{2}$.\n\nD. Stop at the first $k$ such that $\\|F_{h}(u_{h}^{k})\\|_{V_{h}'} \\le \\theta \\,\\|F_{h}(u_{h}^{k-1})\\|_{V_{h}'}$.\n\nE. Stop at the first $k$ such that $\\eta_{h}(u_{h}^{k}) \\le \\theta \\,\\|\\delta u_{h}^{k}\\|_{E}$.",
            "solution": "The goal is to create an efficient adaptive strategy by balancing the linearization error (from the incomplete Newton iteration) and the discretization error (from the finite element mesh). A good strategy is to stop the Newton solver when the linearization error becomes smaller than a fraction of the discretization error, i.e., $\\|e_{\\mathrm{lin}}^{k}\\|_E \\le \\theta \\|e_{\\mathrm{disc}}\\|_E$. This prevents \"oversolving\"—wasting computational effort by reducing the linearization error far below the inherent discretization error of the mesh. We need to evaluate the options based on computable proxies for these errors. The discretization error $\\|e_{\\mathrm{disc}}\\|_E$ is estimated by the a posteriori indicator $\\eta_h(u_h^k)$. The linearization error $\\|e_{\\mathrm{lin}}^{k}\\|_E = \\|u_h^\\star - u_h^k\\|_E$ is well-approximated by the norm of the Newton update, $\\|\\delta u_h^k\\|_E$, especially as the iteration converges. It is also norm-equivalent to the norm of the discrete residual, $\\|F_h(u_h^k)\\|_{V_h'}$. Now we analyze the options:\n\n- **A. Stop at the first $k$ such that $\\|\\delta u_{h}^{k}\\|_{E} \\le \\theta \\,\\eta_{h}(u_{h}^{k})$.** This criterion directly implements the balancing principle, using the Newton update as a computable and accurate estimate for the linearization error. This is a standard and appropriate criterion.\n- **B. Stop at the first $k$ such that $\\|F_{h}(u_{h}^{k})\\|_{V_{h}'} \\le \\theta \\,\\eta_{h}(u_{h}^{k})$.** This criterion also implements the balancing principle, using the norm-equivalent residual as the estimate for the linearization error. This is also a theoretically sound and appropriate rule.\n- **C. Stop at the first $k$ such that $\\|\\delta u_{h}^{k}\\|_{E} \\le \\theta \\,\\eta_{h}(u_{h}^{k})^{2}$.** This is too strict. It forces the linearization error to be much smaller than the discretization error, leading to oversolving. This is inefficient.\n- **D. Stop at the first $k$ such that $\\|F_{h}(u_{h}^{k})\\|_{V_{h}'} \\le \\theta \\,\\|F_{h}(u_{h}^{k-1})\\|_{V_{h}'}$.** This is a relative convergence criterion for the solver itself. It does not relate the algebraic error to the discretization error and thus fails to achieve the desired balance.\n- **E. Stop at the first $k$ such that $\\eta_{h}(u_{h}^{k}) \\le \\theta \\,\\|\\delta u_{h}^{k}\\|_{E}$.** This is the opposite of the desired behavior. It stops the solver when the linearization error is still larger than the discretization error, leading to premature termination.\n\nTherefore, both options A and B represent appropriate and practical rules for balancing the error components.",
            "answer": "$$\\boxed{AB}$$"
        }
    ]
}