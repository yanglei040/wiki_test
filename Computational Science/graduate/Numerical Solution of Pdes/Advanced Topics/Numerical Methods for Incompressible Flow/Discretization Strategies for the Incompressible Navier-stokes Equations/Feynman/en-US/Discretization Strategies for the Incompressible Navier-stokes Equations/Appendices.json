{
    "hands_on_practices": [
        {
            "introduction": "This practice focuses on the fundamental implementation details of the Finite Element Method (FEM) for incompressible flow. By working through the assembly of element matrices for the viscous and pressure-divergence terms using the stable Taylor-Hood ($P_2$-$P_1$) element pair , you will gain hands-on experience with the change-of-variables procedure from a reference element to a physical one. This exercise is crucial for understanding how the abstract weak formulation translates into the concrete algebraic systems that are solved computationally.",
            "id": "3382200",
            "problem": "Consider the standard weak formulation building blocks for the two-dimensional incompressible Navier–Stokes equations, namely the bilinear forms $a(u,v) = \\nu \\int_{\\Omega} \\nabla u : \\nabla v \\, \\mathrm{d}x$ and $b(v,q) = -\\int_{\\Omega} q\\, \\nabla \\cdot v \\, \\mathrm{d}x$, where $\\nu$ is the kinematic viscosity, $u$ and $v$ are vector-valued velocity trial and test functions, and $q$ is the scalar pressure test function. In the Finite Element Method (FEM), consider the Taylor–Hood pair with quadratic Lagrange shape functions for velocity ($P_2$) and linear Lagrange shape functions for pressure ($P_1$).\n\nWork on the reference triangle $\\widehat{K}$ with vertices at $(0,0)$, $(1,0)$, $(0,1)$ and barycentric coordinates $(\\lambda_1,\\lambda_2,\\lambda_3) = (1 - x - y, x, y)$. Let $\\{\\widehat{\\varphi}_i\\}_{i=1}^{6}$ denote the scalar $P_2$ shape functions associated with the three vertices and three edge midpoints, and let $\\{\\widehat{\\psi}_j\\}_{j=1}^{3}$ denote the scalar $P_1$ shape functions associated with the three vertices. For velocity, use vector-valued basis functions formed by tensoring the scalar $P_2$ shapes with the canonical basis vectors of $\\mathbb{R}^2$.\n\n1. Starting from the definitions of $a(\\cdot,\\cdot)$ and $b(\\cdot,\\cdot)$ and the change-of-variables formula under an affine map $F:\\widehat{K} \\to K$, where $x = B \\widehat{x} + b$ with constant Jacobian matrix $B$ and translation vector $b$, derive the element-level expressions for the reference matrices $\\widehat{A}$ and $\\widehat{B}$ and their mapping to the physical element $K$:\n   - For $a(\\cdot,\\cdot)$, give the formula for a scalar-component entry $A_{i\\alpha,\\,j\\alpha}$ coupling the $\\alpha$-th components ($\\alpha \\in \\{1,2\\}$) of the velocity basis functions associated with $\\widehat{\\varphi}_i$ and $\\widehat{\\varphi}_j$.\n   - For $b(\\cdot,\\cdot)$, give the formula for an entry $B_{j,\\,i\\alpha}$ coupling the pressure basis function $\\widehat{\\psi}_j$ with the $\\alpha$-th component of the velocity basis function associated with $\\widehat{\\varphi}_i$.\n\n2. Consider the physical triangle $K$ with vertices at $(2,1)$, $(5,1)$, $(2,4)$. Identify the affine map $F$ from $\\widehat{K}$ to $K$ and compute the corresponding Jacobian matrix $B$ and its determinant.\n\n3. Using your formulas and the specific $F$ found in part 2, evaluate the following two specific entries on the physical element $K$:\n   - The stiffness entry for the $x$-component coupling the vertex-based quadratic shape function at $(0,0)$ with itself, i.e., $A_{1x,\\,1x}$ corresponding to $\\widehat{\\varphi}_1$ associated with $\\lambda_1$.\n   - The divergence–pressure coupling entry for pressure shape function associated with $(1,0)$ and the $x$-component of the quadratic velocity shape function associated with $(1,0)$, i.e., $B_{2,\\,2x}$ corresponding to $\\widehat{\\psi}_2$ associated with $\\lambda_2$ and $\\widehat{\\varphi}_2$ associated with $\\lambda_2$.\n\nFinally, define the scalar quantity $S := A_{1x,\\,1x} + B_{2,\\,2x}$ and provide the exact closed-form expression for $S$ in terms of $\\nu$. No rounding is required. Provide your final answer as a single analytic expression.",
            "solution": "The user has provided a scientifically grounded, well-posed, and objective problem from the field of numerical solutions to partial differential equations. The problem is valid and can be solved by applying standard principles of the Finite Element Method (FEM).\n\nThe solution is structured in three parts as requested: derivation of general formulas, calculation of the specific affine map, and evaluation of the matrix entries, followed by the final computation of $S$.\n\n**Part 1: Derivation of Element Matrix Formulas**\n\nWe are given an affine map from the reference element $\\widehat{K}$ to a physical element $K$:\n$$x = F(\\widehat{x}) = B \\widehat{x} + b$$\nwhere $\\widehat{x} \\in \\widehat{K}$ and $x \\in K$. The Jacobian of this map is the constant matrix $B$. A scalar function $\\widehat{f}$ on $\\widehat{K}$ transforms to a function $f$ on $K$ via $f(x) = \\widehat{f}(F^{-1}(x))$. The chain rule gives the transformation for the gradient:\n$$ \\nabla_x f = B^{-T} \\nabla_{\\widehat{x}} \\widehat{f} $$\nThe differential area element transforms as:\n$$ \\mathrm{d}x = |\\det(B)| \\, \\mathrm{d}\\widehat{x} $$\n\nThe vector-valued velocity basis functions are of the form $\\mathbf{v}_{i\\alpha}(x) = (\\widehat{\\varphi}_i \\circ F^{-1}(x)) \\mathbf{e}_\\alpha$, where $\\widehat{\\varphi}_i$ is a scalar $P_2$ shape function on $\\widehat{K}$ and $\\mathbf{e}_\\alpha$ is a canonical basis vector in $\\mathbb{R}^2$ ($\\alpha \\in \\{1,2\\}$). Similarly, the scalar pressure basis functions are $q_j(x) = \\widehat{\\psi}_j \\circ F^{-1}(x)$, where $\\widehat{\\psi}_j$ is a scalar $P_1$ shape function.\n\n**Derivation of the stiffness matrix entry $A_{i\\alpha, j\\alpha}$**\n\nThe bilinear form for the viscous term is $a(u,v) = \\nu \\int_{\\Omega} \\nabla u : \\nabla v \\, \\mathrm{d}x$. The entry $A_{i\\alpha, j\\alpha}$ of the element stiffness matrix on $K$ is obtained by setting the test function $v = \\mathbf{v}_{i\\alpha}$ and the trial function $u = \\mathbf{v}_{j\\alpha}$:\n$$ A^K_{i\\alpha, j\\alpha} = \\nu \\int_K \\nabla \\mathbf{v}_{j\\alpha} : \\nabla \\mathbf{v}_{i\\alpha} \\, \\mathrm{d}x $$\nThe gradient of the trial function $\\mathbf{v}_{j\\alpha}$ is a tensor:\n$$ \\nabla_x \\mathbf{v}_{j\\alpha} = \\nabla_x ((\\widehat{\\varphi}_j \\circ F^{-1}) \\mathbf{e}_\\alpha) = (\\nabla_x (\\widehat{\\varphi}_j \\circ F^{-1})) \\otimes \\mathbf{e}_\\alpha = (B^{-T} \\nabla_{\\widehat{x}} \\widehat{\\varphi}_j) \\otimes \\mathbf{e}_\\alpha $$\nSimilarly, $\\nabla_x \\mathbf{v}_{i\\alpha} = (B^{-T} \\nabla_{\\widehat{x}} \\widehat{\\varphi}_i) \\otimes \\mathbf{e}_\\alpha$. The double dot product is:\n$$ \\nabla \\mathbf{v}_{j\\alpha} : \\nabla \\mathbf{v}_{i\\alpha} = \\left((B^{-T} \\nabla_{\\widehat{x}} \\widehat{\\varphi}_j) \\cdot (B^{-T} \\nabla_{\\widehat{x}} \\widehat{\\varphi}_i)\\right) (\\mathbf{e}_\\alpha \\cdot \\mathbf{e}_\\alpha) $$\nSince $\\mathbf{e}_\\alpha \\cdot \\mathbf{e}_\\alpha = 1$, this simplifies to:\n$$ (\\nabla_{\\widehat{x}} \\widehat{\\varphi}_j)^T (B^{-1} B^{-T}) (\\nabla_{\\widehat{x}} \\widehat{\\varphi}_i) $$\nSubstituting this into the integral and changing variables to the reference element $\\widehat{K}$:\n$$ A^K_{i\\alpha, j\\alpha} = \\nu |\\det(B)| \\int_{\\widehat{K}} (\\nabla_{\\widehat{x}} \\widehat{\\varphi}_j)^T (B^{-1} B^{-T}) (\\nabla_{\\widehat{x}} \\widehat{\\varphi}_i) \\, \\mathrm{d}\\widehat{x} $$\nThis is the general mapping formula.\n\n**Derivation of the divergence-pressure matrix entry $B_{j, i\\alpha}$**\n\nThe bilinear form for the pressure-velocity coupling is $b(v,q) = -\\int_{\\Omega} q\\, \\nabla \\cdot v \\, \\mathrm{d}x$. The entry $B_{j, i\\alpha}$ is obtained by setting the pressure test function $q = q_j$ and the velocity test function $v = \\mathbf{v}_{i\\alpha}$:\n$$ B^K_{j, i\\alpha} = -\\int_K q_j (\\nabla_x \\cdot \\mathbf{v}_{i\\alpha}) \\, \\mathrm{d}x $$\nThe divergence term is:\n$$ \\nabla_x \\cdot \\mathbf{v}_{i\\alpha} = \\nabla_x \\cdot ((\\widehat{\\varphi}_i \\circ F^{-1}) \\mathbf{e}_\\alpha) = (\\nabla_x (\\widehat{\\varphi}_i \\circ F^{-1})) \\cdot \\mathbf{e}_\\alpha = (B^{-T} \\nabla_{\\widehat{x}} \\widehat{\\varphi}_i) \\cdot \\mathbf{e}_\\alpha $$\nThis term is the $\\alpha$-th component of the vector $B^{-T} \\nabla_{\\widehat{x}} \\widehat{\\varphi}_i$. Let $C=B^{-T}$; it is $\\sum_{k=1}^2 C_{k\\alpha} \\frac{\\partial \\widehat{\\varphi}_i}{\\partial \\widehat{x}_k}$.\nSubstituting into the integral and changing variables:\n$$ B^K_{j, i\\alpha} = -\\int_K (\\widehat{\\psi}_j \\circ F^{-1}) ((B^{-T} \\nabla_{\\widehat{x}} \\widehat{\\varphi}_i) \\cdot \\mathbf{e}_\\alpha)\\circ F^{-1} \\, \\mathrm{d}x $$\n$$ B^K_{j, i\\alpha} = -|\\det(B)| \\int_{\\widehat{K}} \\widehat{\\psi}_j \\left( (B^{-T} \\nabla_{\\widehat{x}} \\widehat{\\varphi}_i) \\cdot \\mathbf{e}_\\alpha \\right) \\, \\mathrm{d}\\widehat{x} $$\nThis is the general mapping formula for the divergence-pressure coupling matrix.\n\n**Part 2: Affine Map for the Triangle K**\n\nThe reference triangle $\\widehat{K}$ has vertices $\\widehat{p}_1=(0,0)$, $\\widehat{p}_2=(1,0)$, $\\widehat{p}_3=(0,1)$.\nThe physical triangle $K$ has vertices $p_1=(2,1)$, $p_2=(5,1)$, $p_3=(2,4)$.\nThe affine map $x = B\\widehat{x} + b$ must map corresponding vertices.\n$p_1 = B\\widehat{p}_1 + b \\implies \\begin{pmatrix} 2 \\\\ 1 \\end{pmatrix} = B\\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} + b \\implies b = \\begin{pmatrix} 2 \\\\ 1 \\end{pmatrix}$.\n$p_2 = B\\widehat{p}_2 + b \\implies \\begin{pmatrix} 5 \\\\ 1 \\end{pmatrix} = B\\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} + \\begin{pmatrix} 2 \\\\ 1 \\end{pmatrix} \\implies B\\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 3 \\\\ 0 \\end{pmatrix}$.\n$p_3 = B\\widehat{p}_3 + b \\implies \\begin{pmatrix} 2 \\\\ 4 \\end{pmatrix} = B\\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} + \\begin{pmatrix} 2 \\\\ 1 \\end{pmatrix} \\implies B\\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 3 \\end{pmatrix}$.\nThe columns of $B$ are $B\\mathbf{e}_1$ and $B\\mathbf{e}_2$. Thus:\n$$ B = \\begin{pmatrix} 3 & 0 \\\\ 0 & 3 \\end{pmatrix} = 3I_2 $$\nThe determinant is $\\det(B) = 3 \\times 3 - 0 \\times 0 = 9$.\n\n**Part 3: Evaluation of Specific Matrix Entries**\n\nThe barycentric coordinates on $\\widehat{K}$ are $\\lambda_1 = 1-\\widehat{x}-\\widehat{y}$, $\\lambda_2 = \\widehat{x}$, $\\lambda_3 = \\widehat{y}$. Their gradients are $\\nabla_{\\widehat{x}}\\lambda_1 = \\left(-1,-1\\right)^T$, $\\nabla_{\\widehat{x}}\\lambda_2 = \\left(1,0\\right)^T$, $\\nabla_{\\widehat{x}}\\lambda_3 = \\left(0,1\\right)^T$.\n\n**Calculation of $A_{1x,1x}$**\nThis entry corresponds to $i=1, j=1, \\alpha=x=1$. The shape function is the $P_2$ function at vertex 1, $\\widehat{\\varphi}_1 = \\lambda_1(2\\lambda_1-1) = 2\\lambda_1^2 - \\lambda_1$.\nWe have $B=3I_2$ and $\\det(B)=9$. Thus $B^{-1} = \\frac{1}{3}I_2$ and $B^{-T} = \\frac{1}{3}I_2$, so $B^{-1}B^{-T} = \\frac{1}{9}I_2$.\n$$ A^K_{1x,1x} = \\nu \\cdot 9 \\int_{\\widehat{K}} (\\nabla_{\\widehat{x}} \\widehat{\\varphi}_1)^T \\left(\\frac{1}{9}I_2\\right) (\\nabla_{\\widehat{x}} \\widehat{\\varphi}_1) \\, \\mathrm{d}\\widehat{x} = \\nu \\int_{\\widehat{K}} |\\nabla_{\\widehat{x}} \\widehat{\\varphi}_1|^2 \\, \\mathrm{d}\\widehat{x} $$\nThe gradient of the shape function is $\\nabla_{\\widehat{x}}\\widehat{\\varphi}_1 = (4\\lambda_1-1)\\nabla_{\\widehat{x}}\\lambda_1 = (4\\lambda_1-1)\\begin{pmatrix} -1 \\\\ -1 \\end{pmatrix}$.\nThe squared magnitude is $|\\nabla_{\\widehat{x}} \\widehat{\\varphi}_1|^2 = (-(4\\lambda_1-1))^2 + (-(4\\lambda_1-1))^2 = 2(4\\lambda_1-1)^2 = 2(16\\lambda_1^2 - 8\\lambda_1+1)$.\nWe need to compute the integral of this quantity over $\\widehat{K}$. The area of $\\widehat{K}$ is $A_{\\widehat{K}}=1/2$. We use the formula $\\int_{\\widehat{K}} \\lambda_1^a \\lambda_2^b \\lambda_3^c \\, \\mathrm{d}\\widehat{x} = 2 A_{\\widehat{K}} \\frac{a!b!c!}{(a+b+c+2)!}$.\n$$ \\int_{\\widehat{K}} 1 \\, \\mathrm{d}\\widehat{x} = A_{\\widehat{K}} = \\frac{1}{2} $$\n$$ \\int_{\\widehat{K}} \\lambda_1 \\, \\mathrm{d}\\widehat{x} = 2(\\frac{1}{2})\\frac{1!0!0!}{3!} = \\frac{1}{6} $$\n$$ \\int_{\\widehat{K}} \\lambda_1^2 \\, \\mathrm{d}\\widehat{x} = 2(\\frac{1}{2})\\frac{2!0!0!}{4!} = \\frac{2}{24} = \\frac{1}{12} $$\nThe integral is:\n$$ \\int_{\\widehat{K}} 2(16\\lambda_1^2 - 8\\lambda_1+1) \\, \\mathrm{d}\\widehat{x} = 32\\int_{\\widehat{K}}\\lambda_1^2 \\, \\mathrm{d}\\widehat{x} - 16\\int_{\\widehat{K}}\\lambda_1 \\, \\mathrm{d}\\widehat{x} + 2\\int_{\\widehat{K}}1 \\, \\mathrm{d}\\widehat{x} $$\n$$ = 32\\left(\\frac{1}{12}\\right) - 16\\left(\\frac{1}{6}\\right) + 2\\left(\\frac{1}{2}\\right) = \\frac{8}{3} - \\frac{8}{3} + 1 = 1 $$\nTherefore, $A_{1x,1x} = \\nu \\cdot 1 = \\nu$.\n\n**Calculation of $B_{2,2x}$**\nThis entry corresponds to pressure function $j=2$, velocity function $i=2$, and component $\\alpha=x=1$.\n$\\widehat{\\psi}_2$ is the $P_1$ function at vertex 2, so $\\widehat{\\psi}_2 = \\lambda_2$.\n$\\widehat{\\varphi}_2$ is the $P_2$ function at vertex 2, so $\\widehat{\\varphi}_2 = \\lambda_2(2\\lambda_2-1)$.\nUsing the formula for $B^K_{j,i\\alpha}$:\n$$ B^K_{2,2x} = -|\\det(B)| \\int_{\\widehat{K}} \\widehat{\\psi}_2 \\left( (B^{-T} \\nabla_{\\widehat{x}} \\widehat{\\varphi}_2) \\cdot \\mathbf{e}_1 \\right) \\, \\mathrm{d}\\widehat{x} $$\nWith $B^{-T} = \\frac{1}{3}I_2$, this simplifies to:\n$$ B^K_{2,2x} = -9 \\int_{\\widehat{K}} \\widehat{\\psi}_2 \\frac{1}{3} (\\nabla_{\\widehat{x}} \\widehat{\\varphi}_2 \\cdot \\mathbf{e}_1) \\, \\mathrm{d}\\widehat{x} = -3 \\int_{\\widehat{K}} \\widehat{\\psi}_2 \\frac{\\partial \\widehat{\\varphi}_2}{\\partial \\widehat{x}} \\, \\mathrm{d}\\widehat{x} $$\nThe gradient is $\\nabla_{\\widehat{x}}\\widehat{\\varphi}_2 = (4\\lambda_2-1)\\nabla_{\\widehat{x}}\\lambda_2 = (4\\lambda_2-1)\\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$.\nSo, $\\frac{\\partial \\widehat{\\varphi}_2}{\\partial \\widehat{x}} = 4\\lambda_2-1$.\nThe integral becomes:\n$$ B^K_{2,2x} = -3 \\int_{\\widehat{K}} \\lambda_2 (4\\lambda_2-1) \\, \\mathrm{d}\\widehat{x} = -3 \\int_{\\widehat{K}} (4\\lambda_2^2 - \\lambda_2) \\, \\mathrm{d}\\widehat{x} $$\n$$ = -3 \\left( 4\\int_{\\widehat{K}}\\lambda_2^2 \\, \\mathrm{d}\\widehat{x} - \\int_{\\widehat{K}}\\lambda_2 \\, \\mathrm{d}\\widehat{x} \\right) $$\nUsing the same integral formulas as before (by symmetry, they are the same for $\\lambda_2$):\n$$ = -3 \\left( 4\\left(\\frac{1}{12}\\right) - \\frac{1}{6} \\right) = -3 \\left( \\frac{1}{3} - \\frac{1}{6} \\right) = -3 \\left( \\frac{1}{6} \\right) = -\\frac{1}{2} $$\nTherefore, $B_{2,2x} = -1/2$.\n\n**Final Quantity S**\nThe quantity $S$ is defined as the sum of the two computed entries:\n$$ S = A_{1x,1x} + B_{2,2x} = \\nu + \\left(-\\frac{1}{2}\\right) = \\nu - \\frac{1}{2} $$",
            "answer": "$$\\boxed{\\nu - \\frac{1}{2}}$$"
        },
        {
            "introduction": "The convective term is the source of both nonlinearity and the rich dynamics in the Navier-Stokes equations, but its discretization can introduce non-physical artifacts. This practice explores how different mathematical forms of the convective term—advective, conservative, and rotational—behave at the discrete level, specifically concerning kinetic energy conservation . Through a combination of derivation and numerical experiment, you will quantify how choices in formulation and numerical integration can lead to spurious energy production or decay, a critical consideration for long-time simulations.",
            "id": "3382198",
            "problem": "Consider the incompressible Navier–Stokes equations for a velocity field $u(x,y,t) \\in \\mathbb{R}^2$ on a two-dimensional domain with appropriate boundary conditions. Focus on the convective term and its three equivalent continuous formulations: the advective form $(u \\cdot \\nabla) u$, the conservative form $\\nabla \\cdot (u \\otimes u)$, and the rotational (skew-symmetric) form defined as the arithmetic mean of the advective and conservative forms. The kinetic energy is $E(t) = \\frac{1}{2} \\int_{\\Omega} |u|^2 \\, \\mathrm{d}\\Omega$. Using a semi-discrete in time perspective (discretized in space, continuous in time), the kinetic energy rate due to the convective term is\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t} \\left( \\frac{1}{2} \\int_{\\Omega} |u|^2 \\, \\mathrm{d}\\Omega \\right) = - \\int_{\\Omega} u \\cdot \\mathcal{C}(u) \\, \\mathrm{d}\\Omega,\n$$\nwhere $\\mathcal{C}(u)$ denotes the chosen discrete convective operator acting on $u$. For incompressible flow ($\\nabla \\cdot u = 0$) and exact spatial integration with periodic or homogeneous boundary conditions, the continuous identities yield zero energy production for all three forms.\n\nYou are tasked to derive, implement, and quantify the discrete kinetic energy identities for the convective term in the three formulations under two spatial integration strategies that represent the role of the mass matrix in the Finite Element Method (FEM):\n1. Consistent mass integration: exact element-wise integration via Gaussian quadrature that represents the action of a consistent mass matrix.\n2. Mass-lumped integration: nodal Gauss–Lobatto quadrature that yields a diagonal (lumped) mass matrix.\n\nUse a bilinear $Q_1$ Finite Element Method (FEM) approximation on a structured rectangular mesh of the unit square $\\Omega = [0,1] \\times [0,1]$ with $N_x \\times N_y$ elements. Let the discrete velocity $u_h(x,y)$ be obtained from nodal values via standard $Q_1$ shape functions. Let $\\Delta t$ denote the time step; consider the limit $\\Delta t \\to 0$ so that the instantaneous energy production rate equals $- \\int_{\\Omega} u_h \\cdot \\mathcal{C}_h(u_h) \\, \\mathrm{d}\\Omega$, which defines the spurious growth observed in an explicit time integration scheme at vanishing time step.\n\nTasks:\n- Starting from the definitions of the three forms of the convective term and the kinetic energy, derive the discrete kinetic energy identities by expressing the semi-discrete energy rate in terms of $u_h$, its gradient, and the chosen quadrature rule. Use the following operator definitions evaluated pointwise:\n  - Advective form: $(u_h \\cdot \\nabla) u_h$,\n  - Conservative form: $\\nabla \\cdot (u_h \\otimes u_h)$,\n  - Rotational (skew-symmetric) form: $\\frac{1}{2}\\left[(u_h \\cdot \\nabla) u_h + \\nabla \\cdot (u_h \\otimes u_h)\\right]$.\n- Show, under exact spatial integration, the rotational form yields zero discrete energy production even if $\\nabla \\cdot u_h \\neq 0$, while the advective and conservative forms yield equal and opposite energy production proportional to $\\int_{\\Omega} (\\nabla \\cdot u_h) |u_h|^2 \\, \\mathrm{d}\\Omega$.\n- Implement a program that computes the instantaneous discrete energy production rate\n$$\ng = - \\int_{\\Omega} u_h \\cdot \\mathcal{C}_h(u_h) \\, \\mathrm{d}\\Omega\n$$\nfor each of the three forms using the two quadrature strategies:\n  - Consistent: $2\\times 2$ Gaussian quadrature on each element (representative of a consistent mass matrix).\n  - Lumped: $2\\times 2$ Gauss–Lobatto quadrature at element corners (representative of a lumped mass matrix).\n- Use $Q_1$ shape functions on the reference square $[-1,1]^2$ with an affine mapping to each physical element. At each quadrature point, evaluate $u_h$, its gradient, and then compute the pointwise energy production integrand $u_h \\cdot \\mathcal{C}_h(u_h)$ for each form. Assemble over all elements.\n\nVelocity test fields:\n- Divergence-free test field:\n$$\nu(x,y) = \\begin{bmatrix}\n\\sin(2\\pi x)\\, \\cos(2\\pi y) \\\\\n- \\cos(2\\pi x)\\, \\sin(2\\pi y)\n\\end{bmatrix}.\n$$\n- Non-divergence-free test field:\n$$\nu(x,y) = \\begin{bmatrix}\n\\sin(2\\pi x) \\\\\n\\sin(2\\pi y)\n\\end{bmatrix}.\n$$\n\nUnit specification: all quantities are dimensionless; report the energy production rate $g$ as a pure number.\n\nTest suite:\nCompute and output the instantaneous energy production rates $g$ for the following parameter sets, each specified as a tuple $(\\text{quadrature}, \\text{velocity}, \\text{form}, N_x, N_y)$:\n1. $(\\text{consistent}, \\text{divergence-free}, \\text{advective}, 4, 4)$,\n2. $(\\text{consistent}, \\text{non-divergence-free}, \\text{advective}, 4, 4)$,\n3. $(\\text{consistent}, \\text{non-divergence-free}, \\text{conservative}, 4, 4)$,\n4. $(\\text{consistent}, \\text{non-divergence-free}, \\text{rotational}, 4, 4)$,\n5. $(\\text{lumped}, \\text{divergence-free}, \\text{rotational}, 2, 2)$,\n6. $(\\text{lumped}, \\text{non-divergence-free}, \\text{rotational}, 1, 1)$,\n7. $(\\text{lumped}, \\text{non-divergence-free}, \\text{advective}, 4, 4)$,\n8. $(\\text{lumped}, \\text{non-divergence-free}, \\text{conservative}, 4, 4)$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,...]\"), where each result is the floating-point value of $g$ for the corresponding test case in the order listed above. No additional text should be printed.",
            "solution": "The user-provided problem is assessed to be **valid** as it is scientifically grounded, well-posed, objective, and contains all necessary information for a unique solution without any contradictions or ambiguities. The problem requires the derivation and numerical computation of discrete kinetic energy production rates for different formulations of the convective term in the incompressible Navier-Stokes equations, which is a standard topic in computational fluid dynamics.\n\n### Theoretical Derivations\n\nThe instantaneous rate of change of kinetic energy $E_h(t) = \\frac{1}{2}\\int_{\\Omega} |u_h|^2 \\, \\mathrm{d}\\Omega$ due to the convective term is given by the energy production rate $g$. Considering the semi-discrete momentum equation $\\frac{\\partial u_h}{\\partial t} = -\\mathcal{C}_h(u_h) + \\dots$, where $\\mathcal{C}_h(u_h)$ is the discrete convective operator, the energy rate is:\n$$\ng = \\frac{\\mathrm{d}E_h}{\\mathrm{d}t} = \\int_{\\Omega} u_h \\cdot \\frac{\\partial u_h}{\\partial t} \\, \\mathrm{d}\\Omega = - \\int_{\\Omega} u_h \\cdot \\mathcal{C}_h(u_h) \\, \\mathrm{d}\\Omega\n$$\nWe analyze this expression for the three given formulations of the convective term. Let $u_h$ be the discrete velocity field, which is a differentiable vector function within each element.\n\n**1. Pointwise Relationships Between Convective Forms**\n\nThe three forms are defined pointwise as:\n- Advective form: $\\mathcal{C}_h^{adv}(u_h) = (u_h \\cdot \\nabla) u_h$\n- Conservative form: $\\mathcal{C}_h^{cons}(u_h) = \\nabla \\cdot (u_h \\otimes u_h)$\n- Rotational form: $\\mathcal{C}_h^{rot}(u_h) = \\frac{1}{2}(\\mathcal{C}_h^{adv}(u_h) + \\mathcal{C}_h^{cons}(u_h))$\n\nUsing the vector calculus identity for the divergence of an outer product, $\\nabla \\cdot (a \\otimes b) = (\\nabla \\cdot b) a + (b \\cdot \\nabla) a$, we set $a=u_h$ and $b=u_h$:\n$$\n\\nabla \\cdot (u_h \\otimes u_h) = (u_h \\cdot \\nabla) u_h + u_h (\\nabla \\cdot u_h)\n$$\nThis provides a direct algebraic relationship between the conservative and advective forms:\n$$\n\\mathcal{C}_h^{cons}(u_h) = \\mathcal{C}_h^{adv}(u_h) + u_h (\\nabla \\cdot u_h)\n$$\nSubstituting this into the definition of the rotational form gives:\n$$\n\\mathcal{C}_h^{rot}(u_h) = \\frac{1}{2}(\\mathcal{C}_h^{adv}(u_h) + \\mathcal{C}_h^{adv}(u_h) + u_h (\\nabla \\cdot u_h)) = \\mathcal{C}_h^{adv}(u_h) + \\frac{1}{2} u_h (\\nabla \\cdot u_h)\n$$\n\n**2. Relationships Between Energy Production Rates**\n\nUsing these pointwise identities, we can relate the energy production rates. Let $g_{adv}$, $g_{cons}$, and $g_{rot}$ be the rates for the advective, conservative, and rotational forms, respectively.\n$$\ng_{cons} = - \\int_{\\Omega} u_h \\cdot \\mathcal{C}_h^{cons}(u_h) \\, \\mathrm{d}\\Omega = - \\int_{\\Omega} u_h \\cdot (\\mathcal{C}_h^{adv}(u_h) + u_h(\\nabla \\cdot u_h)) \\, \\mathrm{d}\\Omega\n$$\n$$\ng_{cons} = \\left( - \\int_{\\Omega} u_h \\cdot \\mathcal{C}_h^{adv}(u_h) \\, \\mathrm{d}\\Omega \\right) - \\int_{\\Omega} |u_h|^2 (\\nabla \\cdot u_h) \\, \\mathrm{d}\\Omega = g_{adv} - \\int_{\\Omega} |u_h|^2 (\\nabla \\cdot u_h) \\, \\mathrm{d}\\Omega\n$$\nSimilarly for the rotational form:\n$$\ng_{rot} = - \\int_{\\Omega} u_h \\cdot \\mathcal{C}_h^{rot}(u_h) \\, \\mathrm{d}\\Omega = - \\int_{\\Omega} u_h \\cdot (\\mathcal{C}_h^{adv}(u_h) + \\frac{1}{2} u_h(\\nabla \\cdot u_h)) \\, \\mathrm{d}\\Omega\n$$\n$$\ng_{rot} = g_{adv} - \\frac{1}{2} \\int_{\\Omega} |u_h|^2 (\\nabla \\cdot u_h) \\, \\mathrm{d}\\Omega\n$$\nFrom these relations, it follows that $g_{rot} = \\frac{1}{2}(g_{adv} + g_{cons})$. These relationships are algebraic and hold true regardless of the numerical integration rule used, provided the same rule is applied to compute all three rates.\n\n**3. Properties under Exact Integration**\n\nThe problem asks to demonstrate certain properties under the assumption of exact spatial integration. This implies that integration by parts holds. We analyze $g_{adv}$:\n$$\ng_{adv} = - \\int_{\\Omega} u_h \\cdot ((u_h \\cdot \\nabla) u_h) \\, \\mathrm{d}\\Omega\n$$\nUsing the vector identity $(v \\cdot \\nabla)v = \\frac{1}{2}\\nabla(|v|^2) - v \\times (\\nabla \\times v)$, the term $u_h \\cdot ((u_h \\cdot \\nabla) u_h)$ simplifies to $\\frac{1}{2} u_h \\cdot \\nabla(|u_h|^2)$.\n$$\ng_{adv} = - \\int_{\\Omega} \\frac{1}{2} u_h \\cdot \\nabla(|u_h|^2) \\, \\mathrm{d}\\Omega\n$$\nApplying integration by parts (via the divergence theorem, $\\int_{\\Omega} v \\cdot \\nabla f \\,d\\Omega = \\int_{\\partial \\Omega} f(v \\cdot n) \\,dS - \\int_{\\Omega} f(\\nabla \\cdot v) \\,d\\Omega$) with $v=u_h$ and $f = \\frac{1}{2}|u_h|^2$, and assuming boundary integrals vanish (due to periodic or homogeneous boundary conditions), we get:\n$$\n\\int_{\\Omega} \\frac{1}{2} u_h \\cdot \\nabla(|u_h|^2) \\, \\mathrm{d}\\Omega = - \\int_{\\Omega} \\frac{1}{2} |u_h|^2 (\\nabla \\cdot u_h) \\, \\mathrm{d}\\Omega\n$$\nTherefore, for exact integration:\n$$\ng_{adv} = - \\left( - \\frac{1}{2} \\int_{\\Omega} |u_h|^2 (\\nabla \\cdot u_h) \\, \\mathrm{d}\\Omega \\right) = \\frac{1}{2} \\int_{\\Omega} |u_h|^2 (\\nabla \\cdot u_h) \\, \\mathrm{d}\\Omega\n$$\nThis shows that the energy production for the advective form is proportional to an integral involving the discrete divergence $\\nabla \\cdot u_h$. Now, substituting this result back into the algebraic relations for $g_{cons}$ and $g_{rot}$:\n$$\ng_{cons} = g_{adv} - \\int_{\\Omega} |u_h|^2 (\\nabla \\cdot u_h) \\, \\mathrm{d}\\Omega = \\frac{1}{2} \\int |u_h|^2 (\\nabla \\cdot u_h) \\, \\mathrm{d}\\Omega - \\int |u_h|^2 (\\nabla \\cdot u_h) \\, \\mathrm{d}\\Omega = - \\frac{1}{2} \\int |u_h|^2 (\\nabla \\cdot u_h) \\, \\mathrm{d}\\Omega\n$$\nThis confirms that $g_{cons} = -g_{adv}$. For the rotational form:\n$$\ng_{rot} = g_{adv} - \\frac{1}{2} \\int_{\\Omega} |u_h|^2 (\\nabla \\cdot u_h) \\, \\mathrm{d}\\Omega = \\frac{1}{2} \\int |u_h|^2 (\\nabla \\cdot u_h) \\, \\mathrm{d}\\Omega - \\frac{1}{2}\\int |u_h|^2 (\\nabla \\cdot u_h) \\, \\mathrm{d}\\Omega = 0\n$$\nThis demonstrates the crucial property of the rotational (skew-symmetric) form: it produces zero net kinetic energy discretely, even for a non-divergence-free discrete velocity field ($ \\nabla \\cdot u_h \\neq 0 $), provided the integrals are computed exactly. Numerical quadrature approximates these integrals, and the degree to which these identities hold depends on the accuracy of the quadrature rule.\n\n### Numerical Implementation\n\nThe program implements the computation of $g$ using a $Q_1$ Finite Element Method on a structured rectangular mesh.\n1.  **Mesh and Elements**: The domain $\\Omega = [0,1] \\times [0,1]$ is divided into an $N_x \\times N_y$ grid of rectangular elements.\n2.  **Shape Functions**: Standard bilinear shape functions $N_i(\\xi, \\eta)$ and their gradients are defined on a reference element $[-1,1]^2$. An affine mapping transforms these to each physical element, for which the Jacobian of the transformation is constant.\n3.  **Quadrature**: The integral for $g$ is approximated by a sum over elements, which is in turn computed using numerical quadrature:\n    $$\n    g = - \\sum_{e} \\int_{e} u_h \\cdot \\mathcal{C}_h(u_h) \\, \\mathrm{d}\\Omega_e \\approx - \\sum_{e} |J_e| \\sum_{q} w_q (u_h \\cdot \\mathcal{C}_h(u_h))|_{(\\xi_q, \\eta_q)}\n    $$\n    - **Consistent integration** uses a $2 \\times 2$ Gaussian quadrature rule, which is exact for polynomials of degree up to $3$ and provides a highly accurate approximation.\n    - **Mass-lumped integration** uses a $2 \\times 2$ Gauss-Lobatto rule, with quadrature points at the element nodes. This is less accurate but is computationally advantageous in forming diagonal mass matrices.\n4.  **Computation at Quadrature Points**: For each quadrature point within an element, the code evaluates:\n    - The discrete velocity $u_h = \\sum_i N_i u_i$ and its gradient $\\nabla u_h = \\sum_i u_i \\otimes (\\nabla N_i)^T$, where $u_i$ are the nodal velocity values.\n    - The divergence $\\nabla \\cdot u_h = \\text{tr}(\\nabla u_h)$.\n    - The term $u_h \\cdot \\mathcal{C}_h(u_h)$ for the specified convective form (advective, conservative, or rotational).\n5.  **Assembly**: The contributions from all quadrature points and all elements are summed to obtain the total energy production rate $g$.\nThe nodal velocities $u_i$ are obtained by evaluating the given analytical test fields at the mesh node coordinates.",
            "answer": "```\n[0.000000000000,-0.693444641908,-0.693444641908,-0.693444641908,0.000000000000,0.000000000000,0.000000000000,-1.386889283816]\n```"
        },
        {
            "introduction": "After discretizing in space, we must select a stable and accurate method to advance the solution in time. This exercise involves performing a local truncation error analysis on a common semi-implicit scheme, which treats stiff linear terms implicitly and the nonlinear convective term explicitly . By methodically applying Taylor series expansions, you will determine the scheme's temporal order of accuracy, a key metric for evaluating the performance and reliability of time-stepping methods in computational fluid dynamics.",
            "id": "3382119",
            "problem": "Consider the incompressible Navier–Stokes equations for velocity $u(x,t) \\in \\mathbb{R}^{d}$ and pressure $p(x,t) \\in \\mathbb{R}$ on a periodic domain $\\Omega \\subset \\mathbb{R}^{d}$ with kinematic viscosity $\\nu > 0$ and smooth forcing $f(x,t)$:\n$$\n\\partial_{t} u + (u \\cdot \\nabla) u - \\nu \\Delta u + \\nabla p = f, \\qquad \\nabla \\cdot u = 0,\n$$\nwith smooth initial data $u(x,0)$ that satisfies $\\nabla \\cdot u(x,0) = 0$. Let $\\{t_{n}\\}_{n \\ge 0}$ be an equally spaced time grid with $t_{n} = n \\Delta t$ for time step $\\Delta t > 0$, and assume that the exact solution $(u,p)$ is sufficiently smooth in time so that all time derivatives appearing in Taylor expansions up to order four exist and are bounded.\n\nDefine the monolithic semi-implicit time-stepping scheme that uses the Backward Differentiation Formula of order two (BDF2) for the time derivative, second-order explicit extrapolation (EX2) for the convective term, and implicit treatment of viscosity and pressure at time $t_{n+1}$:\n$$\n\\frac{3 u^{n+1} - 4 u^{n} + u^{n-1}}{2 \\Delta t} + \\Big(2\\,[(u \\cdot \\nabla) u]^{n} - [(u \\cdot \\nabla) u]^{n-1}\\Big) - \\nu \\Delta u^{n+1} + \\nabla p^{n+1} = f^{n+1},\n$$\n$$\n\\nabla \\cdot u^{n+1} = 0,\n$$\nwhere $[\\cdot]^{n}$ denotes the quantity evaluated at time $t_{n}$ and the spatial differential operators act pointwise in space.\n\nPerform a local truncation error analysis by substituting the exact smooth solution $(u(\\cdot,t),p(\\cdot,t))$ into the above scheme at time $t_{n+1}$ and expanding in $\\Delta t$ about $t_{n+1}$. Derive the leading-order expressions for the local truncation error residual in the momentum equation in terms of time derivatives of $u$ and $(u \\cdot \\nabla)u$, and from this analysis determine the temporal order of accuracy for both the velocity and the pressure produced by this BDF2–EX2 scheme.\n\nExpress your final answer as a row matrix listing the temporal orders for velocity and pressure in that order. No rounding is required, and no units are needed.",
            "solution": "The problem requires a local truncation error analysis of a given semi-implicit time-stepping scheme for the incompressible Navier-Stokes equations to determine the temporal order of accuracy for the velocity and pressure.\n\nThe incompressible Navier-Stokes equations are given by:\n$$ \\partial_{t} u + (u \\cdot \\nabla) u - \\nu \\Delta u + \\nabla p = f $$\n$$ \\nabla \\cdot u = 0 $$\nLet $N(u) = (u \\cdot \\nabla) u$ denote the convective term. The equations can be written as:\n$$ \\partial_{t} u + N(u) - \\nu \\Delta u + \\nabla p = f $$\n$$ \\nabla \\cdot u = 0 $$\n\nThe proposed numerical scheme is:\n$$ \\frac{3 u^{n+1} - 4 u^{n} + u^{n-1}}{2 \\Delta t} + \\Big(2 N(u^n) - N(u^{n-1})\\Big) - \\nu \\Delta u^{n+1} + \\nabla p^{n+1} = f^{n+1} $$\n$$ \\nabla \\cdot u^{n+1} = 0 $$\nThis scheme uses a second-order Backward Differentiation Formula (BDF2) for the time derivative, a second-order explicit extrapolation (EX2) for the nonlinear convective term, and an implicit (Backward Euler) treatment for the linear diffusion term and the pressure gradient.\n\nThe local truncation error (LTE) for the momentum equation, denoted $\\tau_u^{n+1}$, is the residual obtained by substituting the exact smooth solution $(u(x,t), p(x,t))$ into the discrete momentum equation. All functions below, unless specified otherwise, are the exact solutions evaluated at the spatial point $x$.\n$$\n\\tau_u^{n+1} = \\frac{3 u(t_{n+1}) - 4 u(t_{n}) + u(t_{n-1})}{2 \\Delta t} + \\Big(2 N(u(t_n)) - N(u(t_{n-1}))\\Big) - \\nu \\Delta u(t_{n+1}) + \\nabla p(t_{n+1}) - f(t_{n+1})\n$$\nThe exact solution satisfies the PDE at time $t_{n+1}$, so we can substitute for $f(t_{n+1})$:\n$$\nf(t_{n+1}) = \\partial_{t} u(t_{n+1}) + N(u(t_{n+1})) - \\nu \\Delta u(t_{n+1}) + \\nabla p(t_{n+1})\n$$\nSubstituting this into the expression for $\\tau_u^{n+1}$ cancels the implicit terms:\n$$\n\\tau_u^{n+1} = \\left( \\frac{3 u(t_{n+1}) - 4 u(t_{n}) + u(t_{n-1})}{2 \\Delta t} - \\partial_{t} u(t_{n+1}) \\right) + \\left( 2 N(u(t_n)) - N(u(t_{n-1})) - N(u(t_{n+1})) \\right)\n$$\nTo find the leading order of $\\tau_u^{n+1}$, we perform Taylor series expansions of $u$ and $N(u)$ around the time $t_{n+1}$. Let $h = \\Delta t$.\nThe expansions for $u(t_n) = u(t_{n+1}-h)$ and $u(t_{n-1}) = u(t_{n+1}-2h)$ are:\n$$ u(t_{n+1}-h) = u(t_{n+1}) - h \\partial_t u + \\frac{h^2}{2} \\partial_{tt} u - \\frac{h^3}{6} \\partial_{ttt} u + O(h^4) $$\n$$ u(t_{n+1}-2h) = u(t_{n+1}) - 2h \\partial_t u + \\frac{(2h)^2}{2} \\partial_{tt} u - \\frac{(2h)^3}{6} \\partial_{ttt} u + O(h^4) $$\nwhere all derivatives are evaluated at $t_{n+1}$.\n\nFirst, we analyze the BDF2 part of the error:\n\\begin{align*}\n& \\frac{3 u(t_{n+1}) - 4 u(t_n) + u(t_{n-1})}{2h} \\\\\n&= \\frac{1}{2h} \\left[ 3u - 4\\left(u - h \\partial_t u + \\frac{h^2}{2} \\partial_{tt} u - \\frac{h^3}{6} \\partial_{ttt} u\\right) + \\left(u - 2h \\partial_t u + 2h^2 \\partial_{tt} u - \\frac{4h^3}{3} \\partial_{ttt} u\\right) \\right] + O(h^3) \\\\\n&= \\frac{1}{2h} \\left[ (3-4+1)u + (4h-2h)\\partial_t u + (-2h^2+2h^2)\\partial_{tt} u + \\left(\\frac{4h^3}{6}-\\frac{8h^3}{6}\\right)\\partial_{ttt} u \\right] + O(h^3) \\\\\n&= \\frac{1}{2h} \\left[ 2h \\partial_t u - \\frac{2h^3}{3} \\partial_{ttt} u \\right] + O(h^3) \\\\\n&= \\partial_t u(t_{n+1}) - \\frac{h^2}{3} \\partial_{ttt} u(t_{n+1}) + O(h^3)\n\\end{align*}\nThe error from the BDF2 approximation of the time derivative is therefore:\n$$ \\left( \\frac{3 u(t_{n+1}) - 4 u(t_{n}) + u(t_{n-1})}{2 \\Delta t} - \\partial_{t} u(t_{n+1}) \\right) = - \\frac{(\\Delta t)^2}{3} \\partial_{ttt} u(t_{n+1}) + O((\\Delta t)^3) $$\n\nNext, we analyze the EX2 part of the error for the term $N(u)$:\n$$ N(u(t_{n+1}-h)) = N(u(t_{n+1})) - h \\partial_t N(u) + \\frac{h^2}{2} \\partial_{tt} N(u) + O(h^3) $$\n$$ N(u(t_{n+1}-2h)) = N(u(t_{n+1})) - 2h \\partial_t N(u) + \\frac{(2h)^2}{2} \\partial_{tt} N(u) + O(h^3) $$\nThe extrapolated term is:\n\\begin{align*}\n& 2 N(u(t_n)) - N(u(t_{n-1})) \\\\\n&= 2\\left(N(u) - h \\partial_t N(u) + \\frac{h^2}{2} \\partial_{tt} N(u)\\right) - \\left(N(u) - 2h \\partial_t N(u) + 2h^2 \\partial_{tt} N(u)\\right) + O(h^3) \\\\\n&= (2-1)N(u) + (-2h+2h)\\partial_t N(u) + (h^2-2h^2)\\partial_{tt} N(u) + O(h^3) \\\\\n&= N(u(t_{n+1})) - h^2 \\partial_{tt} N(u(t_{n+1})) + O(h^3)\n\\end{align*}\nThe error from the EX2 approximation of the convective term is:\n$$ \\left( 2 N(u(t_n)) - N(u(t_{n-1})) - N(u(t_{n+1})) \\right) = -(\\Delta t)^2 \\partial_{tt} N(u(t_{n+1})) + O((\\Delta t)^3) $$\n\nCombining both parts, the local truncation error for the momentum equation is:\n$$ \\tau_u^{n+1} = - \\frac{(\\Delta t)^2}{3} \\partial_{ttt} u(t_{n+1}) - (\\Delta t)^2 \\partial_{tt} N(u(t_{n+1})) + O((\\Delta t)^3) $$\nThe leading-order expression for the LTE is:\n$$ \\tau_u^{n+1} = -(\\Delta t)^2 \\left( \\frac{1}{3} \\frac{\\partial^3 u}{\\partial t^3} + \\frac{\\partial^2}{\\partial t^2} [(u \\cdot \\nabla) u] \\right) \\Bigg|_{t=t_{n+1}} + O((\\Delta t)^3) $$\nThe local truncation error for the momentum equation is of order two, i.e., $\\tau_u^{n+1} = O((\\Delta t)^2)$.\n\nFor a stable numerical method, the order of the global error is the same as the order of the local truncation error. The BDF2 method is zero-stable. This semi-implicit formulation is stable under a suitable CFL-type constraint. Therefore, the scheme is convergent, and the order of accuracy for the velocity $u$ is the same as the order of consistency, which is $2$.\n\nTo determine the order of accuracy for the pressure $p$, we consider the equations governing the numerical and exact pressures. The numerical pressure $p^{n+1}$ is determined implicitly by the system, satisfying a Poisson-type equation. By taking the divergence of the numerical momentum equation and using the constraint $\\nabla \\cdot u^{n+1} = 0$, we find the equation for $p^{n+1}$:\n$$ \\Delta p^{n+1} = \\nabla \\cdot \\left[ f^{n+1} - \\left( \\frac{3 u^{n+1} - 4 u^{n} + u^{n-1}}{2 \\Delta t} \\right) - \\left(2 N(u^n) - N(u^{n-1})\\right) + \\nu \\Delta u^{n+1} \\right] $$\nUsing $\\nabla \\cdot u^{n+1} = 0$ and assuming $\\nabla \\cdot u^k = 0$ for previous steps $k \\le n$, the equation for $p^{n+1}$ simplifies considerably, particularly if we consider the global error $e_p^{n+1} = p^{n+1} - p(t_{n+1})$. The error $e_p^{n+1}$ satisfies a Poisson equation of the form $\\Delta e_p^{n+1} = S$, where the source term $S$ depends on the momentum truncation error $\\tau_u^{n+1}$ and the global errors of the velocity at previous time steps. Specifically, $\\Delta e_p^{n+1}$ is related to $\\nabla \\cdot \\tau_u^{n+1}$ and errors in the explicit convective term.\n$$ \\Delta e_p^{n+1} = -\\nabla \\cdot \\tau_u^{n+1} - \\nabla \\cdot \\left[ \\left(2 N(u^n) - N(u^{n-1})\\right) - \\left(2 N(u(t_n)) - N(u(t_{n-1}))\\right) \\right] $$\nThe first term is $\\nabla \\cdot \\tau_u^{n+1} = O((\\Delta t)^2)$. The second term involves the difference in the nonlinear term due to the global velocity error $e_u^k = u^k - u(t_k) = O((\\Delta t)^2)$ for $k \\le n$. This difference is also $O((\\Delta t)^2)$. Thus, the right-hand side is $O((\\Delta t)^2)$. By elliptic regularity for the Poisson equation, this implies that the global pressure error is also of order two: $e_p^{n+1} = O((\\Delta t)^2)$.\nA key aspect of this monolithic scheme is that the pressure $p^{n+1}$ and velocity $u^{n+1}$ are solved for simultaneously, avoiding the splitting errors common in projection methods which can degrade the pressure's order of accuracy.\nTherefore, the temporal order of accuracy for both the velocity and the pressure is $2$.\n\nFinal Answer Summary:\n-   Leading-order LTE for momentum: $\\tau_u^{n+1} = O((\\Delta t)^2)$.\n-   Temporal order of accuracy for velocity $u$: $2$.\n-   Temporal order of accuracy for pressure $p$: $2$.",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 2 & 2 \\end{pmatrix} } $$"
        }
    ]
}