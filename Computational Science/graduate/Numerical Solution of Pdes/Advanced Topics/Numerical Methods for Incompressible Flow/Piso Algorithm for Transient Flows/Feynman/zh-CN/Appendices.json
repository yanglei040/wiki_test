{
    "hands_on_practices": [
        {
            "introduction": "PISO算法的核心在于将速度场投影到无散空间上，以满足不可压缩性约束。本练习利用傅里叶分析这一强大工具，精确地展示了压力修正步骤如何滤除预测步中引入的非物理可压缩误差分量。通过这个理想化的思想实验，您将深入理解该算法的基本误差传递机制 ()。",
            "id": "3432037",
            "problem": "考虑一个三周期域中的瞬态不可压缩流，其密度 $\\rho$ 为常数，使用算子分裂压力隐式 (PISO) 算法进行时间推进。设时间步长为 $\\Delta t$，并用 $\\mathbf{u}^{*}$ 表示在时间层 $n+1$ 预测步之后的速度，该速度由于截断误差而与精确的无散速度 $\\mathbf{u}^{n+1}$ 不同。通过 $\\mathbf{u}^{*} = \\mathbf{u}^{n+1} + \\mathbf{e}_{\\mathrm{pred}}$ 定义预测截断误差场 $\\mathbf{e}_{\\mathrm{pred}}$。压力修正步通过减去一个压力梯度增量来更新速度，以在时间层 $n+1$ 强制执行不可压缩性。假设在修正步中忽略粘性，并且选择的压力增量是为了强制执行无散约束。\n\n仅使用不可压缩性约束 $\\nabla \\cdot \\mathbf{u}^{n+1} = 0$、压力修正步作为通过梯度场更新速度的定义，以及在周期域中的傅里叶分析，对预测截断误差的单个傅里叶模态进行误差传递分析。具体来说，考虑 $\\mathbf{e}_{\\mathrm{pred}}(\\mathbf{x}) = \\mathbf{a} \\exp(i \\mathbf{k} \\cdot \\mathbf{x})$，其中振幅向量 $\\mathbf{a} \\in \\mathbb{C}^{3}$ 为常数，波数向量为 $\\mathbf{k} \\in \\mathbb{R}^{3} \\setminus \\{\\mathbf{0}\\}$。推导由压力修正引起的 $\\mathbf{e}_{\\mathrm{pred}}$ 的重新分布，并计算第一次压力修正后，保留在修正速度中的误差模态动能的比例。用关于 $\\mathbf{a}$ 和 $\\mathbf{k}$ 之间的夹角 $\\theta$ 的闭式解析表达式表示最终答案，该夹角由 $\\cos \\theta = \\dfrac{\\mathbf{k} \\cdot \\mathbf{a}}{\\|\\mathbf{k}\\| \\, \\|\\mathbf{a}\\|}$ 定义。不需要数值近似；请提供精确表达式。最终答案应无单位。",
            "solution": "用户希望我分析 PISO 算法的第一次压力修正步对预测步截断误差的单个傅里叶模态的影响。\n\n### 第 1 步：提取已知条件\n- 流是瞬态、不可压缩的，密度 $\\rho$ 为常数。\n- 域是三周期的。\n- 时间步长为 $\\Delta t$。\n- $n+1$ 时间层的预测速度为 $\\mathbf{u}^{*}$。\n- $n+1$ 时间层的精确无散速度为 $\\mathbf{u}^{n+1}$。\n- 预测截断误差为 $\\mathbf{e}_{\\mathrm{pred}}$，由 $\\mathbf{u}^{*} = \\mathbf{u}^{n+1} + \\mathbf{e}_{\\mathrm{pred}}$ 定义。\n- 不可压缩性约束为 $\\nabla \\cdot \\mathbf{u}^{n+1} = 0$。\n- 压力修正步通过减去一个压力梯度增量来更新速度以强制执行不可压缩性。此步中忽略粘性。\n- 预测截断误差是一个单一傅里叶模态：$\\mathbf{e}_{\\mathrm{pred}}(\\mathbf{x}) = \\mathbf{a} \\exp(i \\mathbf{k} \\cdot \\mathbf{x})$，其中 $\\mathbf{a} \\in \\mathbb{C}^{3}$ 且 $\\mathbf{k} \\in \\mathbb{R}^{3} \\setminus \\{\\mathbf{0}\\}$。\n- $\\mathbf{a}$ 和 $\\mathbf{k}$ 之间的夹角 $\\theta$ 由 $\\cos \\theta = \\dfrac{\\mathbf{k} \\cdot \\mathbf{a}}{\\|\\mathbf{k}\\| \\, \\|\\mathbf{a}\\|}$ 定义。\n\n### 第 2 步：使用提取的已知条件进行验证\n该问题在科学上基于计算流体动力学的原理，特别是像 PISO 这样的投影方法的分析。在周期域中使用傅里叶分析是研究数值格式性质的标准技术。该问题是适定的、客观的、自洽的，提供了继续进行所需的所有必要定义。\n\n问题陈述中有一个小的歧义。它指定了振幅向量 $\\mathbf{a} \\in \\mathbb{C}^{3}$，但使用公式 $\\cos \\theta = \\frac{\\mathbf{k} \\cdot \\mathbf{a}}{\\|\\mathbf{k}\\| \\|\\mathbf{a}\\|}$ 定义了夹角 $\\theta$，这是实向量的标准定义。如果 $\\mathbf{a}$ 是一个普通的复向量，则项 $\\mathbf{k} \\cdot \\mathbf{a}$ 是复数，这意味着 $\\theta$ 是一个复角，其物理释义不那么直接。然而，问题的结构强烈暗示了基于实向量投影的几何解释。这个歧义可以通过将问题解释为 $\\mathbf{a}$ 是一个实向量（$\\mathbb{C}^3$ 的一个子集）的情况，或者通过认识到最终的能量比取决于 $|\\mathbf{k} \\cdot \\mathbf{a}|^2$ 来解决。在假设 $\\mathbf{k} \\cdot \\mathbf{a}$ 是实数（这是 $\\theta$ 为实角所必需的）的情况下，问题是完全一致的。这是一个与物理背景相符的合理解释。因此，该问题被认为是有效的。\n\n### 第 3 步：结论和行动\n问题有效。我将继续进行求解。\n\n### 解题推导\nPISO 算法的压力修正步旨在将一个速度场投影到无散场空间上。设预测步之后的速度场为 $\\mathbf{u}^{*}$。第一次修正步通过移除 $\\mathbf{u}^{*}$ 的梯度部分来计算修正后的速度，我们称之为 $\\mathbf{u}^{**}$。这是通过减去一个我们可以表示为 $\\phi$ 的标量场的梯度来实现的。\n$$\n\\mathbf{u}^{**} = \\mathbf{u}^{*} - \\nabla\\phi\n$$\n标量场 $\\phi$（与压力修正成比例）是通过对修正后的速度强制执行无散条件 $\\nabla \\cdot \\mathbf{u}^{**} = 0$ 来确定的。\n$$\n\\nabla \\cdot (\\mathbf{u}^{*} - \\nabla\\phi) = 0\n$$\n这导出了一个关于 $\\phi$ 的泊松型方程：\n$$\n\\nabla^2\\phi = \\nabla \\cdot \\mathbf{u}^{*}\n$$\n问题陈述了预测速度 $\\mathbf{u}^{*}$、精确无散速度 $\\mathbf{u}^{n+1}$ 和预测误差 $\\mathbf{e}_{\\mathrm{pred}}$ 之间的关系：\n$$\n\\mathbf{u}^{*} = \\mathbf{u}^{n+1} + \\mathbf{e}_{\\mathrm{pred}}\n$$\n鉴于精确速度是无散的，即 $\\nabla \\cdot \\mathbf{u}^{n+1} = 0$，我们可以完全用误差来表示预测速度的散度：\n$$\n\\nabla \\cdot \\mathbf{u}^{*} = \\nabla \\cdot (\\mathbf{u}^{n+1} + \\mathbf{e}_{\\mathrm{pred}}) = \\nabla \\cdot \\mathbf{u}^{n+1} + \\nabla \\cdot \\mathbf{e}_{\\mathrm{pred}} = \\nabla \\cdot \\mathbf{e}_{\\mathrm{pred}}\n$$\n因此，$\\phi$ 的泊松方程由预测误差的散度驱动：\n$$\n\\nabla^2\\phi = \\nabla \\cdot \\mathbf{e}_{\\mathrm{pred}}\n$$\n修正后速度场中的误差 $\\mathbf{e}_{\\mathrm{corr}} = \\mathbf{u}^{**} - \\mathbf{u}^{n+1}$，可以通过代入 $\\mathbf{u}^{**}$ 和 $\\mathbf{u}^{*}$ 的表达式来找到：\n$$\n\\mathbf{e}_{\\mathrm{corr}} = (\\mathbf{u}^{*} - \\nabla\\phi) - \\mathbf{u}^{n+1} = (\\mathbf{u}^{n+1} + \\mathbf{e}_{\\mathrm{pred}} - \\nabla\\phi) - \\mathbf{u}^{n+1} = \\mathbf{e}_{\\mathrm{pred}} - \\nabla\\phi\n$$\n这表明压力修正步通过移除其梯度分量来修改误差场。我们现在对给定的单个傅里叶模态误差 $\\mathbf{e}_{\\mathrm{pred}}(\\mathbf{x}) = \\mathbf{a} \\exp(i \\mathbf{k} \\cdot \\mathbf{x})$ 分析这个过程。\n\n首先，我们计算误差模态的散度：\n$$\n\\nabla \\cdot \\mathbf{e}_{\\mathrm{pred}} = \\nabla \\cdot (\\mathbf{a} \\exp(i \\mathbf{k} \\cdot \\mathbf{x})) = \\mathbf{a} \\cdot \\nabla(\\exp(i \\mathbf{k} \\cdot \\mathbf{x})) = \\mathbf{a} \\cdot (i\\mathbf{k}) \\exp(i \\mathbf{k} \\cdot \\mathbf{x}) = i(\\mathbf{k} \\cdot \\mathbf{a})\\exp(i \\mathbf{k} \\cdot \\mathbf{x})\n$$\n泊松方程变为：\n$$\n\\nabla^2\\phi = i(\\mathbf{k} \\cdot \\mathbf{a})\\exp(i \\mathbf{k} \\cdot \\mathbf{x})\n$$\n假设解的形式为 $\\phi(\\mathbf{x}) = \\hat{\\phi} \\exp(i \\mathbf{k} \\cdot \\mathbf{x})$，其中 $\\hat{\\phi}$ 是傅里叶系数，我们应用拉普拉斯算子：\n$$\n\\nabla^2 (\\hat{\\phi} \\exp(i \\mathbf{k} \\cdot \\mathbf{x})) = \\hat{\\phi} (i\\mathbf{k}) \\cdot (i\\mathbf{k}) \\exp(i \\mathbf{k} \\cdot \\mathbf{x}) = -\\hat{\\phi} \\|\\mathbf{k}\\|^2 \\exp(i \\mathbf{k} \\cdot \\mathbf{x})\n$$\n将此代入泊松方程并求解 $\\hat{\\phi}$：\n$$\n-\\hat{\\phi} \\|\\mathbf{k}\\|^2 \\exp(i \\mathbf{k} \\cdot \\mathbf{x}) = i(\\mathbf{k} \\cdot \\mathbf{a})\\exp(i \\mathbf{k} \\cdot \\mathbf{x}) \\implies \\hat{\\phi} = -\\frac{i(\\mathbf{k} \\cdot \\mathbf{a})}{\\|\\mathbf{k}\\|^2}\n$$\n现在我们求出从误差中移除的梯度项 $\\nabla\\phi$：\n$$\n\\nabla\\phi = \\nabla(\\hat{\\phi} \\exp(i \\mathbf{k} \\cdot \\mathbf{x})) = i\\mathbf{k} \\hat{\\phi} \\exp(i \\mathbf{k} \\cdot \\mathbf{x}) = i\\mathbf{k} \\left( -\\frac{i(\\mathbf{k} \\cdot \\mathbf{a})}{\\|\\mathbf{k}\\|^2} \\right) \\exp(i \\mathbf{k} \\cdot \\mathbf{x}) = \\frac{(\\mathbf{k} \\cdot \\mathbf{a})}{\\|\\mathbf{k}\\|^2} \\mathbf{k} \\exp(i \\mathbf{k} \\cdot \\mathbf{x})\n$$\n修正后的误差场 $\\mathbf{e}_{\\mathrm{corr}}$ 为：\n$$\n\\mathbf{e}_{\\mathrm{corr}} = \\mathbf{e}_{\\mathrm{pred}} - \\nabla\\phi = \\mathbf{a} \\exp(i \\mathbf{k} \\cdot \\mathbf{x}) - \\frac{(\\mathbf{k} \\cdot \\mathbf{a})}{\\|\\mathbf{k}\\|^2} \\mathbf{k} \\exp(i \\mathbf{k} \\cdot \\mathbf{x})\n$$\n提出指数项，我们得到修正后误差的振幅：\n$$\n\\mathbf{e}_{\\mathrm{corr}} = \\left( \\mathbf{a} - \\frac{(\\mathbf{k} \\cdot \\mathbf{a})}{\\|\\mathbf{k}\\|^2} \\mathbf{k} \\right) \\exp(i \\mathbf{k} \\cdot \\mathbf{x})\n$$\n括号中的项是原始振幅向量 $\\mathbf{a}$ 减去其在波数向量 $\\mathbf{k}$ 上的投影。这是 $\\mathbf{a}$ 与 $\\mathbf{k}$ 正交的分量。\n\n在一个体积为 $V$ 的周期域中，由单个傅里叶模态 $\\mathbf{v}(\\mathbf{x}) = \\mathbf{c} \\exp(i \\mathbf{k} \\cdot \\mathbf{x})$ 表示的速度场的动能，与其模的平方的积分成正比，即 $E \\propto \\int_V \\|\\mathbf{v}(\\mathbf{x})\\|^2 dV$。由于 $\\|\\mathbf{v}(\\mathbf{x})\\|^2 = (\\mathbf{c}e^{i\\mathbf{k}\\cdot\\mathbf{x}}) \\cdot (\\mathbf{c}^*e^{-i\\mathbf{k}\\cdot\\mathbf{x}}) = \\|\\mathbf{c}\\|^2$，能量为 $E \\propto \\|\\mathbf{c}\\|^2 V$。因此，动能之比即为其各自振幅向量模的平方之比。\n\n预测误差的能量为 $E_{\\mathrm{pred}} \\propto \\|\\mathbf{a}\\|^2$。\n修正后误差的振幅为 $\\mathbf{a}_{\\perp} = \\mathbf{a} - \\frac{(\\mathbf{k} \\cdot \\mathbf{a})}{\\|\\mathbf{k}\\|^2} \\mathbf{k}$。修正后误差的能量为 $E_{\\mathrm{corr}} \\propto \\|\\mathbf{a}_{\\perp}\\|^2$。\n剩余动能的比例为：\n$$\n\\frac{E_{\\mathrm{corr}}}{E_{\\mathrm{pred}}} = \\frac{\\|\\mathbf{a}_{\\perp}\\|^2}{\\|\\mathbf{a}\\|^2}\n$$\n向量 $\\mathbf{a}$ 可以分解为与 $\\mathbf{k}$ 平行和垂直的分量：$\\mathbf{a} = \\mathbf{a}_{\\|} + \\mathbf{a}_{\\perp}$，其中 $\\mathbf{a}_{\\|} = \\frac{(\\mathbf{k} \\cdot \\mathbf{a})}{\\|\\mathbf{k}\\|^2} \\mathbf{k}$。这些分量是正交的。根据勾股定理，$\\|\\mathbf{a}\\|^2 = \\|\\mathbf{a}_{\\|}\\|^2 + \\|\\mathbf{a}_{\\perp}\\|^2$。\n因此，$\\|\\mathbf{a}_{\\perp}\\|^2 = \\|\\mathbf{a}\\|^2 - \\|\\mathbf{a}_{\\|}\\|^2$。\n我们计算平行分量模的平方。根据验证步骤中的推理，为与 $\\theta$ 的定义保持一致，我们将 $\\mathbf{a}$ 视为实向量。\n$$\n\\|\\mathbf{a}_{\\|}\\|^2 = \\left\\| \\frac{(\\mathbf{k} \\cdot \\mathbf{a})}{\\|\\mathbf{k}\\|^2} \\mathbf{k} \\right\\|^2 = \\frac{(\\mathbf{k} \\cdot \\mathbf{a})^2}{\\|\\mathbf{k}\\|^4} \\|\\mathbf{k}\\|^2 = \\frac{(\\mathbf{k} \\cdot \\mathbf{a})^2}{\\|\\mathbf{k}\\|^2}\n$$\n剩余能量的比例为：\n$$\n\\frac{E_{\\mathrm{corr}}}{E_{\\mathrm{pred}}} = \\frac{\\|\\mathbf{a}\\|^2 - \\|\\mathbf{a}_{\\|}\\|^2}{\\|\\mathbf{a}\\|^2} = 1 - \\frac{\\|\\mathbf{a}_{\\|}\\|^2}{\\|\\mathbf{a}\\|^2} = 1 - \\frac{(\\mathbf{k} \\cdot \\mathbf{a})^2}{\\|\\mathbf{k}\\|^2 \\|\\mathbf{a}\\|^2}\n$$\n问题定义了 $\\cos\\theta = \\dfrac{\\mathbf{k} \\cdot \\mathbf{a}}{\\|\\mathbf{k}\\| \\, \\|\\mathbf{a}\\|}$。代入此定义：\n$$\n\\frac{E_{\\mathrm{corr}}}{E_{\\mathrm{pred}}} = 1 - (\\cos\\theta)^2 = 1 - \\cos^2\\theta\n$$\n使用基本三角恒等式 $\\sin^2\\theta + \\cos^2\\theta = 1$，该比例简化为：\n$$\n\\frac{E_{\\mathrm{corr}}}{E_{\\mathrm{pred}}} = \\sin^2\\theta\n$$\n这个结果表明，压力修正投影消除了误差模态的纵向部分（此时 $\\theta = 0$），并保留了误差模态的横向或螺线管部分（此时 $\\theta = \\pi/2$）。",
            "answer": "$$\n\\boxed{\\sin^2(\\theta)}\n$$"
        },
        {
            "introduction": "从理论机制转向实际执行，真实的PISO算法中压力泊松方程是通过迭代求解的，其收敛与否取决于设定的容差。本练习设计了一个数值实验，用于量化这种实用性选择如何影响仿真的整体精度，特别是残余散度如何随时间步长 $\\Delta t$ 缩放。这对于确保瞬态仿真的时间精度不被不充分的内部迭代所污染至关重要 ()。",
            "id": "3432041",
            "problem": "考虑一个在坐标为 $(x,y) \\in [0,1]\\times[0,1]$ 的周期性单位正方形域上建模的二维不可压缩瞬态流。在惯性可忽略的极限情况下，不可压缩 Navier-Stokes 方程简化为非定常 Stokes 方程。该方程通过 $\\nabla \\cdot \\mathbf{u} = 0$ 强制质量守恒，并通过 $\\partial_t \\mathbf{u} = -\\nabla p + \\nu \\Delta \\mathbf{u} + \\mathbf{f}$ 实现动量平衡，其中 $\\mathbf{u}$ 是速度场，$p$ 是运动压力，$\\nu$ 是运动粘度，$\\mathbf{f}$ 是体积力。一种用于瞬态不可压缩流的常用解耦策略是算子分裂压力隐式 (PISO) 算法。该算法对动量方程使用一个预测步，然后进行迭代压力修正，以在下一个时间层上近似无散约束。在实践中，内部压力修正循环由修正后速度散度的容差来终止，这可能会引入由 $\\lVert \\nabla \\cdot \\mathbf{u}^{n+1} \\rVert$ 量化的残余“声学污染”。\n\n你的任务是设计并实现一个数值实验，在一个带有基于散度的停止准则的类 PISO 内部修正过程中，分离并测量残差 $\\lVert \\nabla \\cdot \\mathbf{u}^{n+1} \\rVert_2$ 如何随时间步长 $\\Delta t$ 变化。使用以下原则性设置：\n\n- 使用具有 $N \\times N$ 个均匀间隔点的周期性单位正方形网格，网格间距为 $\\Delta x = \\Delta y = 1/N$。所有场都是无量纲的，因此无需报告物理单位。\n- 通过 Taylor-Green 涡 $\\mathbf{u}_{\\mathrm{base}}(x,y) = \\big(\\sin(2\\pi x)\\cos(2\\pi y), -\\cos(2\\pi x)\\sin(2\\pi y)\\big)$ 在下一个时间层 $t^{n+1}$ 定义一个无散度的基流。\n- 通过添加一个与 $\\Delta t$ 成正比的梯度扰动来模拟 PISO 动量预测步，从而产生一个可压缩的临时速度：$\\mathbf{u}^{\\star}(x,y;\\Delta t) = \\mathbf{u}_{\\mathrm{base}}(x,y) + \\Delta t \\nabla \\chi(x,y)$，其中 $\\chi(x,y) = \\sin(2\\pi x)\\sin(2\\pi y)$。\n- 使用周期性网格上的二阶中心差分计算离散散度 $\\nabla \\cdot \\mathbf{u}^{\\star}$，及其离散 $L^2$-范数，定义为 $\\lVert \\phi \\rVert_2 = \\sqrt{\\sum_{i,j} \\phi_{i,j}^2 \\, \\Delta x \\, \\Delta y}$。\n- 将 PISO 内部压力修正循环建模为一系列线性修正，每次迭代都以一个与 $\\Delta t$ 无关的固定收缩因子 $\\theta \\in (0,1)$ 按几何级数减小散度范数。如果 $R_0(\\Delta t) = \\lVert \\nabla \\cdot \\mathbf{u}^{\\star} \\rVert_2$ 表示初始散度范数，则经过 $k$ 次修正后，散度范数为 $R_k(\\Delta t) = \\theta^k R_0(\\Delta t)$。当 $k$ 是满足 $R_k(\\Delta t) \\le \\epsilon(\\Delta t)$ 的最小值时终止循环，其中 $\\epsilon(\\Delta t)$ 是用户指定的容差方案。\n\n你的程序必须使用以下固定的数值选择来实现上述过程：\n- 使用 $N = 64$，$\\nu$ 为任意值（但在此简化实验中未显式使用），$\\theta = 0.5$。\n- 使用二阶中心差分和周期性环绕来离散化导数。\n- 使用离散 $L^2$-范数，其中 $\\Delta x = \\Delta y = 1/N$。\n\n你必须研究对于两族容差 $\\epsilon(\\Delta t) = C \\Delta t^{\\alpha}$，最终散度范数相对于 $\\Delta t$ 的标度关系：\n- A 族 (候选二阶)：$\\alpha = 2$，其中 $C = 10^{-2}$。\n- B 族 (候选一阶)：$\\alpha = 1$，其中 $C = 10^{-2}$。\n\n对于每一族，使用时间步长测试集 $\\Delta t \\in \\{0.2, 0.1, 0.05\\}$ 运行模拟：\n- 对于每个 $\\Delta t$，构建 $\\mathbf{u}^{\\star}$，计算 $R_0(\\Delta t)$，确定满足 $R_k(\\Delta t) \\le \\epsilon(\\Delta t)$ 的最小整数 $k$，并返回最终的散度范数 $R_k(\\Delta t)$。\n- 从得到的三个 $R_k(\\Delta t)$ 值中，对于点对 $(\\Delta t_i,\\Delta t_{i+1}) = (0.2,0.1)$ 和 $(0.1,0.05)$，通过公式 $p = \\dfrac{\\log\\big(R_k(\\Delta t_i)/R_k(\\Delta t_{i+1})\\big)}{\\log\\big(\\Delta t_i/\\Delta t_{i+1}\\big)}$ 计算连续对之间的观测阶数 $p$。\n\n你的程序必须输出单行，其中包含一个按以下顺序排列的四个浮点数的列表：\n- A 族 (当 $\\alpha = 2$ 时) 在点对 $(0.2,0.1)$ 和 $(0.1,0.05)$ 上的两个观测阶数 $p$。\n- B 族 (当 $\\alpha = 1$ 时) 在相同点对上的两个观测阶数 $p$。\n\n科学和数值要求：\n- 所有导数计算必须使用指定的有限差分算子显式实现；不要使用任何谱方法或解析恒等式来计算范数。\n- 所有计算都是无量纲的。不需要物理单位。\n- 最终输出必须是下面描述的精确格式的单行。\n\n测试集和最终输出格式：\n- 使用上述固定的参数集，它们共同构成了针对每个容差族在 $\\Delta t \\in \\{0.2, 0.1, 0.05\\}$ 上的测试集。\n- 你的程序应生成单行输出，其中包含四个结果，形式为方括号内用逗号分隔的列表（例如，\"[r1,r2,r3,r4]\"），其中每个 $r_i$ 是按上述规定计算的浮点数。",
            "solution": "所提出的问题是一个数值实验，旨在研究瞬态不可压缩流的算子分裂压力隐式 (PISO) 算法简化模型中，残余质量守恒误差的标度特性。主要目标是确定在内部压力修正循环的两种不同容差方案下，最终散度范数 $\\lVert \\nabla \\cdot \\mathbf{u}^{n+1} \\rVert_2$ 相对于时间步长 $\\Delta t$ 的观测收敛阶数 $p$。\n\n这个问题的理论基础在于不可压缩 Navier-Stokes 方程的投影法。这些方法将速度和压力的计算解耦。一个典型的时间步首先通过求解一个动量方程来预测一个临时速度场 $\\mathbf{u}^\\star$，此时并未严格强制施加无散约束。这个 $\\mathbf{u}^\\star$ 通常具有非零散度，即 $\\nabla \\cdot \\mathbf{u}^\\star \\neq 0$。随后，通过求解一个压力泊松方程 $\\Delta \\phi \\propto \\nabla \\cdot \\mathbf{u}^\\star$ 来计算压力修正量 $\\phi$，然后用它来同时修正速度场和压力场以满足约束条件，即 $\\mathbf{u}^{n+1} = \\mathbf{u}^\\star - \\tau \\nabla \\phi$，其中 $\\tau$ 与 $\\Delta t$ 相关。PISO 算法在单个时间步内多次重复此修正步骤，以改善对无散条件的近似。\n\n本问题为该过程提供了一个定义明确的抽象。\n1.  一个已知的无散流，即 Taylor-Green 涡 $\\mathbf{u}_{\\mathrm{base}}$，代表了新时间层 $t^{n+1}$ 上的精确解。\n2.  临时速度 $\\mathbf{u}^{\\star} = \\mathbf{u}_{\\mathrm{base}} + \\Delta t \\nabla \\chi$ 模拟了动量预测步的结果。$\\Delta t \\nabla \\chi$ 项引入了非零散度 $\\nabla \\cdot \\mathbf{u}^{\\star} = \\Delta t \\Delta \\chi$，该散度与时间步长 $\\Delta t$ 成正比，这是许多分裂格式的一个典型特征。\n3.  PISO 内部循环被建模为一个迭代过程，在每次迭代中将散度范数 $R_k = \\lVert \\nabla \\cdot \\mathbf{u}_k \\rVert_2$ 乘以一个常数因子 $\\theta$：$R_{k+1} = \\theta R_k$。这代表了压力泊松方程的定常迭代求解器（如 Jacobi 或 Gauss-Seidel 法）的收敛过程。\n4.  循环根据一个依赖于时间步长的容差 $\\epsilon(\\Delta t)$ 终止。这是一个关键方面，因为在精度和计算成本之间进行权衡的容差选择是一个关键的实践考量。\n\n我们现在将详细说明数值计算步骤。\n\n首先，我们定义计算网格。区域是一个由 $N \\times N$ 个点离散化的周期性单位正方形 $[0,1] \\times [0,1]$，其中 $N=64$。网格坐标为 $(x_i, y_j)$，其中 $x_i = i \\Delta x$ 且 $y_j = j \\Delta y$，$i, j \\in \\{0, 1, \\dots, N-1\\}$。网格间距是均匀的，$\\Delta x = \\Delta y = 1/N$。\n\n解析场在该网格上的取值如下：\n-   基流速度分量：$u_{\\mathrm{base}, i,j} = \\sin(2\\pi x_i)\\cos(2\\pi y_j)$ 和 $v_{\\mathrm{base}, i,j} = -\\cos(2\\pi x_i)\\sin(2\\pi y_j)$。\n-   扰动势：$\\chi_{i,j} = \\sin(2\\pi x_i)\\sin(2\\pi y_j)$。\n\n数值计算的核心涉及离散微分算子。我们使用带有周期性环绕的二阶中心差分。对于任何网格函数 $\\phi_{i,j}$，其偏导数近似为：\n$$ (\\delta_x \\phi)_{i,j} = \\frac{\\phi_{i+1,j} - \\phi_{i-1,j}}{2\\Delta x} $$\n$$ (\\delta_y \\phi)_{i,j} = \\frac{\\phi_{i,j+1} - \\phi_{i,j-1}}{2\\Delta y} $$\n其中指数对 N 取模以强制周期性。\n\n对于每个给定的 $\\Delta t$，计算流程如下：\n\n1.  **计算临时速度 $\\mathbf{u}^{\\star}$**：\n    临时速度 $\\mathbf{u}^{\\star} = (u^\\star, v^\\star)$ 的分量通过将扰动势的离散梯度加到基流上构建：\n    $$ u^\\star_{i,j} = u_{\\mathrm{base}, i,j} + \\Delta t (\\delta_x \\chi)_{i,j} $$\n    $$ v^\\star_{i,j} = v_{\\mathrm{base}, i,j} + \\Delta t (\\delta_y \\chi)_{i,j} $$\n\n2.  **计算 $\\mathbf{u}^{\\star}$ 的散度**：\n    临时速度场的离散散度 $D_{i,j} = (\\nabla_h \\cdot \\mathbf{u}^\\star)_{i,j}$ 在每个网格点上计算如下：\n    $$ D_{i,j} = (\\delta_x u^\\star)_{i,j} + (\\delta_y v^\\star)_{i,j} $$\n\n3.  **计算初始散度范数 $R_0(\\Delta t)$**：\n    初始误差由散度场的离散 $L^2$-范数量化：\n    $$ R_0(\\Delta t) = \\left\\| \\nabla_h \\cdot \\mathbf{u}^\\star \\right\\|_2 = \\sqrt{\\sum_{i=0}^{N-1}\\sum_{j=0}^{N-1} D_{i,j}^2 \\, \\Delta x \\, \\Delta y} $$\n\n4.  **确定修正次数 $k$**：\n    对于由 $C$ 和 $\\alpha$ 定义的给定容差族，容差为 $\\epsilon(\\Delta t) = C \\Delta t^\\alpha$。我们寻找最小的整数 $k \\ge 0$，使得修正后的散度范数 $R_k(\\Delta t) = \\theta^k R_0(\\Delta t)$ 满足容差要求：\n    $$ \\theta^k R_0(\\Delta t) \\le \\epsilon(\\Delta t) $$\n    如果 $R_0(\\Delta t) \\le \\epsilon(\\Delta t)$，则 $k=0$。否则，取对数（并注意因为 $\\theta=0.5$，所以 $\\log(\\theta)  0$），我们得到 $k \\ge \\frac{\\log(\\epsilon(\\Delta t) / R_0(\\Delta t))}{\\log(\\theta)}$。因此，最小的整数 $k$ 是：\n    $$ k = \\left\\lceil \\frac{\\log(\\epsilon(\\Delta t) / R_0(\\Delta t))}{\\log(\\theta)} \\right\\rceil $$\n\n5.  **计算最终散度范数 $R_k(\\Delta t)$**：\n    经过 $k$ 次修正后的最终残余散度就是 $R_k(\\Delta t) = \\theta^k R_0(\\Delta t)$。对于测试集中的每个 $\\Delta t$，此值都将被存储。\n\n此过程针对每个时间步长 $\\Delta t \\in \\{0.2, 0.1, 0.05\\}$ 以及两个容差族（A 族：$\\alpha=2, C=10^{-2}$ 和 B 族：$\\alpha=1, C=10^{-2}$）执行。\n\n最后，我们计算观测收敛阶数 $p$。给定一组与时间步长 $\\{\\Delta t_1, \\Delta t_2, \\Delta t_3\\}$ 相对应的三个最终范数 $\\{R_k(\\Delta t_1), R_k(\\Delta t_2), R_k(\\Delta t_3)\\}$，阶数 $p$ 通过以下公式在连续对之间进行估计：\n$$ p = \\frac{\\log(R_k(\\Delta t_i) / R_k(\\Delta t_{i+1}))}{\\log(\\Delta t_i / \\Delta t_{i+1})} $$\n对于我们的时间步长集，比率 $\\Delta t_i / \\Delta t_{i+1}$ 始终为 $2$，因此分母简化为 $\\log(2)$。\n\n预期的结果是，最终散度范数 $R_k(\\Delta t)$ 将与容差 $\\epsilon(\\Delta t)$ 具有相似的标度关系，因为迭代过程在范数约等于容差量级时停止。因此，我们预计 A 族的观测阶数 $p$ 将接近 $\\alpha=2$，而 B 族的观测阶数将接近 $\\alpha=1$。该实现将精确计算这些阶数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nimport math\n\ndef solve():\n    \"\"\"\n    Implements a numerical experiment to measure the scaling of residual divergence\n    in a simplified PISO-like algorithm for two different tolerance schedules.\n    \"\"\"\n    # Fixed numerical choices from the problem statement\n    N = 64\n    theta = 0.5\n    delta_t_suite = [0.2, 0.1, 0.05]\n\n    # Define the two families of tolerances epsilon(dt) = C * dt^alpha\n    families = [\n        {'C': 1e-2, 'alpha': 2, 'name': 'A'},\n        {'C': 1e-2, 'alpha': 1, 'name': 'B'}\n    ]\n\n    all_orders = []\n\n    # Setup computational grid\n    dx = 1.0 / N\n    dy = 1.0 / N\n    # Create coordinate arrays. endpoint=False for periodic domain [0, 1)\n    x = np.linspace(0, 1, N, endpoint=False)\n    y = np.linspace(0, 1, N, endpoint=False)\n    xx, yy = np.meshgrid(x, y, indexing='ij')\n\n    # Define helper functions for discrete derivatives\n    def central_diff_x(field, hx):\n        # Second-order central difference in x-direction with periodic boundaries\n        return (np.roll(field, -1, axis=1) - np.roll(field, 1, axis=1)) / (2.0 * hx)\n\n    def central_diff_y(field, hy):\n        # Second-order central difference in y-direction with periodic boundaries\n        return (np.roll(field, -1, axis=0) - np.roll(field, 1, axis=0)) / (2.0 * hy)\n\n    # Evaluate analytical fields on the grid\n    u_base = np.sin(2 * np.pi * xx) * np.cos(2 * np.pi * yy)\n    v_base = -np.cos(2 * np.pi * xx) * np.sin(2 * np.pi * yy)\n    chi = np.sin(2 * np.pi * xx) * np.sin(2 * np.pi * yy)\n\n    # Pre-compute gradient of chi\n    grad_chi_x = central_diff_x(chi, dx)\n    grad_chi_y = central_diff_y(chi, dy)\n\n    # --- Main loop over tolerance families ---\n    for family in families:\n        C = family['C']\n        alpha = family['alpha']\n        final_norms = []\n\n        # --- Loop over the time-step suite ---\n        for delta_t in delta_t_suite:\n            # 1. Construct the provisional velocity field u_star\n            u_star = u_base + delta_t * grad_chi_x\n            v_star = v_base + delta_t * grad_chi_y\n\n            # 2. Compute the discrete divergence of u_star\n            div_u_star = central_diff_x(u_star, dx) + central_diff_y(v_star, dy)\n\n            # 3. Compute the initial divergence L2-norm, R0\n            R0 = np.sqrt(np.sum(div_u_star**2) * dx * dy)\n\n            # 4. Determine the number of corrections, k\n            epsilon = C * (delta_t**alpha)\n            \n            if R0 = epsilon:\n                k = 0\n            else:\n                # Calculate smallest integer k s.t. theta^k * R0 = epsilon\n                k_float = math.log(epsilon / R0) / math.log(theta)\n                k = math.ceil(k_float)\n\n            # 5. Compute the final divergence norm, Rk\n            Rk = (theta**k) * R0\n            final_norms.append(Rk)\n\n        # --- Compute observed orders for the current family ---\n        # Order for pair (dt_1, dt_2) = (0.2, 0.1)\n        p1 = (math.log(final_norms[0] / final_norms[1]) /\n              math.log(delta_t_suite[0] / delta_t_suite[1]))\n        \n        # Order for pair (dt_2, dt_3) = (0.1, 0.05)\n        p2 = (math.log(final_norms[1] / final_norms[2]) /\n              math.log(delta_t_suite[1] / delta_t_suite[2]))\n        \n        all_orders.extend([p1, p2])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, all_orders))}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "理论和孤立的测试最终要服务于复杂的实际应用。在真实场景中，算法与边界条件、网格质量和离散格式等因素相互作用。本练习将您置于一个典型的仿真失败情景中，要求您扮演计算流体力学（CFD）侦探的角色，运用所学知识诊断多个相互关联的错误来源，并选择一套完整的纠正措施 ()。",
            "id": "3432034",
            "problem": "考虑一个不可压缩、密度恒定的瞬态流，该流动由不可压缩Navier-Stokes方程控制，在一个长度为$L$、高度为$H$的二维($2\\mathrm{D}$)通道中进行，其密度为$\\rho$，运动粘度为$\\nu$。控制方程为\n$$\n\\frac{\\partial \\mathbf{u}}{\\partial t} + \\nabla \\cdot (\\mathbf{u}\\mathbf{u}) = -\\frac{1}{\\rho}\\nabla p + \\nu \\nabla^2 \\mathbf{u} + \\mathbf{f}, \\qquad \\nabla \\cdot \\mathbf{u} = 0,\n$$\n其中$\\mathbf{u}$是速度场，$p$是运动压力（压力除以密度），$\\mathbf{f}$是体积力。该流动在非正交网格上，通过有限体积法(FVM)框架内的压力隐式算子分裂(PISO)算法进行数值求解。\n\n边界条件规定如下：在$x=0$（入口），施加一个随时间变化的速度剖面$\\mathbf{u}_{\\text{in}}(t)$，且法向压力梯度为零；在$x=L$（出口），运动压力固定为$p=p_0$；在$y=0$和$y=H$（壁面），强制执行无滑移和不可穿透条件，即$\\mathbf{u}=\\mathbf{0}$和$\\mathbf{u}\\cdot \\mathbf{n}=0$。入口速度为$\\mathbf{u}_{\\text{in}}(t)=\\left(U_0\\sin(\\omega t),\\,0\\right)$，其中$U_0$和$\\omega$为给定值。Courant数定义为\n$$\nCo \\equiv \\max\\left(\\frac{|\\mathbf{u}|\\Delta t}{\\Delta x}\\right),\n$$\n其中$\\Delta t$是时间步长，$\\Delta x$是特征网格尺寸。\n\n一位计算流体动力学(CFD)从业者按如下方式设置PISO算法：一个动量预测步得到一个中间速度$\\mathbf{u}^*$，在没有使用Rhie–Chow插值的情况下计算面通量，并且在组装压力修正方程时，对出口（$p=p_0$固定的地方）的压力修正量使用齐次Neumann条件（法向梯度为零），同时没有指定全局压力参考点；对流项使用中心差分，并且选择的时间步长使得$Co \\approx 3$。压力的线性求解器使用预条件共轭梯度(PCG)法，配以简单的对角预条件子和宽松的容差。PISO修正步数很少。模拟表现出发散，其特征为压力修正残差不断增长，且$\\mathbf{u}$和$p$出现无界振荡。\n\n从不可压缩约束和PISO算法中压力修正方程的定义出发，根据边界条件不一致性和算子奇异性，诊断导致发散的主要原因。然后，选择一套必要且充分的修正措施，以恢复此瞬态问题的稳健收敛性。您的回答应基于第一性原理和关于离散连续性、压力-速度耦合、时间稳定性以及线性求解器行为的可靠推理。\n\n哪个选项正确地识别并纠正了问题？\n\nA. 增加PISO压力修正步数，并将压力求解器切换为代数多重网格(AMG)，保持边界条件和时间步长不变。这能提高修正强度和多重网格收敛性，并将解决发散问题。\n\nB. 在固定压力出口处对压力修正量$p'$施加Dirichlet条件（在$p=p_0$的边界上$p'=0$），设置单个压力参考点以消除零空间，对面通量启用Rhie–Chow插值，减小时间步长以确保$Co \\le 0.5$，对流项使用有界迎风格式或总变差减小(TVD)格式，并增加非正交压力修正步数以确保在非正交网格上的一致性。通过这些更改，离散压力方程是适定的，并且瞬态耦合变得稳定。\n\nC. 在瞬态PISO中对压力应用强欠松弛，在出口处保留压力修正量的齐次Neumann边界条件，不设置压力参考点，并使用二阶中心差分格式处理对流项以最小化扩散。额外的精度和松弛将消除发散。\n\nD. 在出口施加法向速度为零以防止回流，在压力方程中增加一个人工可压缩项$\\beta \\,\\partial p/\\partial t$（其中$\\beta0$），并增加$\\Delta t$以平均瞬态效应。这将使系统正则化并稳定瞬态演化。\n\nE. 直接在动量方程中添加一个发散阻尼项$\\epsilon \\nabla^2 p$（其中$\\epsilon0$），在所有边界上设置零梯度压力边界条件，并保持$Co \\approx 3$以避免过高的计算成本。增加的压力扩散将消除振荡并使计算收敛。",
            "solution": "用户希望我分析一个关于瞬态不可压缩流动的PISO模拟失败的计算流体动力学(CFD)问题，并找出正确的修正措施组合。\n\n### 问题验证\n\n**第一步：提取已知条件**\n\n-   **控制方程**：不可压缩Navier-Stokes方程和连续性方程。\n    $$\n    \\frac{\\partial \\mathbf{u}}{\\partial t} + \\nabla \\cdot (\\mathbf{u}\\mathbf{u}) = -\\frac{1}{\\rho}\\nabla p + \\nu \\nabla^2 \\mathbf{u} + \\mathbf{f}\n    $$\n    $$\n    \\nabla \\cdot \\mathbf{u} = 0\n    $$\n-   **流动参数**：不可压缩、恒定密度$\\rho$、运动粘度$\\nu$。\n-   **几何与边界条件**：二维通道，长度为$L$，高度为$H$。\n    -   入口 ($x=0$)：随时间变化的速度$\\mathbf{u}_{\\text{in}}(t)=\\left(U_0\\sin(\\omega t),\\,0\\right)$，法向压力梯度为零($\\partial p / \\partial n = 0$)。\n    -   出口 ($x=L$)：固定的运动压力$p=p_0$。\n    -   壁面 ($y=0$, $y=H$)：无滑移($\\mathbf{u}=\\mathbf{0}$)。\n-   **数值格式**：压力隐式算子分裂(PISO)算法，有限体积法(FVM)，非正交网格。\n-   **Courant数**：$Co \\equiv \\max\\left(\\frac{|\\mathbf{u}|\\Delta t}{\\Delta x}\\right)$。\n-   **有缺陷的模拟设置**：\n    1.  面通量计算未使用Rhie–Chow插值。\n    2.  压力修正方程$p'$在出口($x=L$)处使用齐次Neumann边界条件($\\partial p' / \\partial n = 0$)求解。\n    3.  未指定全局压力参考点。\n    4.  对流项使用中心差分。\n    5.  选择的时间步长使得$Co \\approx 3$。\n    6.  压力线性求解器是预条件共轭梯度(PCG)法，使用对角预条件子和宽松的容差。\n    7.  PISO修正循环次数较少。\n-   **观测到的行为**：模拟发散，其特征是压力修正残差不断增长，速度$\\mathbf{u}$和压力$p$出现无界振荡。\n\n**第二步：使用提取的已知条件进行验证**\n\n问题陈述描述了一个定义明确的物理问题所对应的错误数值设置，并要求进行诊断和修正。该设置的描述以及由此产生的数值失效模式与CFD中已知的陷阱相符。问题的目的是测试对这些陷阱的理解。因此，该问题是有科学依据的、(在其要求上)适定的和客观的。它未违反任何无效性标准。问题中的不一致性是待分析场景的一部分，而非问题陈述本身的缺陷。\n\n**第三步：结论与行动**\n\n问题陈述是有效的。我将继续进行推导和分析。\n\n### 推导与分析\n\nPISO算法是求解不可压缩Navier-Stokes方程的一种非迭代时间推进方法。它包含一个预测步，后跟一个或多个修正步。\n\n1.  **动量预测步**：通过使用前一时间步的压力场$p^n$求解动量方程，计算得到一个中间速度场$\\mathbf{u}^*$。离散化的动量方程形式如下：\n    $$ a_P \\mathbf{u}^*_P = \\sum_{nb} a_{nb} \\mathbf{u}^*_{nb} - V \\frac{\\nabla p^n}{\\rho} + \\mathbf{b} $$\n    这里，$a_P$和$a_{nb}$是矩阵系数，$V$是网格单元体积，$\\mathbf{b}$包含源项和瞬态项。\n\n2.  **压力修正**：预测得到的速度$\\mathbf{u}^*$不满足连续性约束$\\nabla \\cdot \\mathbf{u} = 0$。速度和压力按如下方式修正：\n    $$ \\mathbf{u}^{n+1} = \\mathbf{u}^* + \\mathbf{u}' $$\n    $$ p^{n+1} = p^n + p' $$\n    动量方程中的一个简化关系将速度修正量$\\mathbf{u}'$与压力修正梯度$\\nabla p'$联系起来：\n    $$ \\mathbf{u}' \\approx -\\frac{\\Delta t}{\\rho a_P} \\nabla p' $$\n    (注：在更严格的FVM语境下，该项是一个离散梯度算子)。\n    通过对修正后的速度强制执行连续性约束$\\nabla \\cdot \\mathbf{u}^{n+1} = 0$，我们得到关于压力修正量$p'$的Poisson方程：\n    $$ \\nabla \\cdot \\left( \\frac{\\Delta t}{\\rho a_P} \\nabla p' \\right) = \\nabla \\cdot \\mathbf{u}^* $$\n    这就是必须求解的压力修正方程。\n\n现在，我们基于此框架来诊断从业者设置中的缺陷。\n\n**缺陷1：边界条件不一致性与矩阵奇异性**\n在出口处，物理边界条件是针对绝对压力：$p=p_0$（一个Dirichlet条件）。新时间步的修正压力$p^{n+1}$必须满足此条件。根据更新公式$p^{n+1} = p^n + p'$，我们必须强制$p^{n+1}|_{\\text{outlet}} = p_0$。这意味着压力修正量$p'$的边界条件应为$p'|_{\\text{outlet}} = p_0 - p^n|_{\\text{outlet}}$。这是一个关于$p'$的**Dirichlet边界条件**。一个常见且可接受的简化是在固定压力边界上设置$p'=0$。\n然而，从业者在出口处施加了一个**齐次Neumann条件**($\\partial p' / \\partial n = 0$)。这是不正确的，且与主要边界条件不一致。在入口和壁面，压力边界条件是Neumann条件，这会转化为$p'$的Neumann条件。通过在出口处也错误地指定$p'$的Neumann条件，从业者为$p'$建立了一个在所有边界上都是纯Neumann条件的Poisson问题。得到的线性系统是**奇异的**：其解只在相差一个附加常数的情况下是唯一的，并且解存在的条件是源项（$\\mathbf{u}^*$的散度）在整个域上的积分为零，而这个条件通常不满足。要解这样一个奇异系统，必须消除零空间，通常通过在一个参考单元上设置压力修正值($p'_{ref}=0$)来实现。问题陈述中提到“没有指定全局压力参考点”。这种组合是导致压力求解器发散和“增长的压力修正残差”的主要原因。\n\n**缺陷2：压力-速度解耦**\n在同位网格上（压力和速度分量存储在同一位置，即单元中心），将单元中心的速度通过朴素的插值方法计算到面上以获得质量通量，可能导致相邻压力节点之间的耦合丢失。这会允许非物理的高频“棋盘格”振荡出现在压力场中，而动量方程却无法察觉。**Rhie–Chow插值**是标准的补救措施。它修改了面速度的计算方法，加入了一个与跨面压力差成正比的项，从而有效地引入了压力平滑耗散，防止了这些振荡。不使用Rhie-Chow插值是观测到的“无界振荡”的直接原因。\n\n**缺陷3：对流与时间不稳定性**\n-   **中心差分**：该格式是二阶精确的，但无耗散性。对于对流主导的流动（高网格Peclet数，$Pe = |\\mathbf{u}|\\Delta x / \\nu  2$），它因产生非物理振荡而臭名昭著。\n-   **Courant数 $Co \\approx 3$**：虽然PISO是半隐式的，对于$Co  1$可以保持稳定，但高Courant数会引入大的时间截断误差。更关键的是，当与像中心差分这样的无耗散空间格式结合使用时，它会产生一个不稳定的格式，任何微小扰动都会增长。对于稳健且精确的瞬态模拟，尤其是在具有复杂动力学的情况下，$Co \\le 1$是一个标准准则。当中心差分不适用时，需要使用有界的、高分辨率的格式（例如TVD、NVD）或混合/迎风格式来控制振荡。\n\n**缺陷4：非正交修正**\n在非正交网格上，压力拉普拉斯算子的离散化会产生交叉导数项，这些项通常作为源项进行显式处理。PISO算法的多个修正步旨在迭代地处理这些项和其他隐式误差。一个“很少的PISO修正步数”不足以实现这一点，导致违反离散质量守恒，从而导致不稳定性。\n\n### 逐项分析\n\n**A. 增加PISO压力修正步数，并将压力求解器切换为代数多重网格(AMG)，保持边界条件和时间步长不变。这能提高修正强度和多重网格收敛性，并将解决发散问题。**\n-   增加PISO修正步数和使用AMG是很好的做法。AMG是一个强大的求解器。然而，这个选项没有解决根本性缺陷：不一致的$p'$边界条件（这使得系统奇异）、缺少Rhie–Chow插值，以及在高Courant数下使用不稳定的对流格式。一个更好的求解器无法修复一个根本上不适定的问题；它可能只是更快地找到那个非唯一的、无用的解，或者更剧烈地发散。\n-   结论：**不正确**。\n\n**B. 在固定压力出口处对压力修正量$p'$施加Dirichlet条件（在$p=p_0$的边界上$p'=0$），设置单个压力参考点以消除零空间，对面通量启用Rhie–Chow插值，减小时间步长以确保$Co \\le 0.5$，对流项使用有界迎风格式或总变差减小(TVD)格式，并增加非正交压力修正步数以确保在非正交网格上的一致性。通过这些更改，离散压力方程是适定的，并且瞬态耦合变得稳定。**\n-   这个选项提出了一套全面且正确的修正措施。\n    -   `对p'施加Dirichlet条件`: 修正了不一致的边界条件，并使$p'$矩阵非奇异。\n    -   `设置单个压力参考点`: 虽然对$p'$应用Dirichlet边界条件使得参考点变得多余，但这一陈述正确地认识到需要解决原始错误设置中存在的奇异性问题。\n    -   `启用Rhie–Chow插值`: 解决了压力-速度解耦问题。\n    -   `减小时间步长以确保Co = 0.5` 和 `对流项使用有界...格式`: 这两项措施共同作用，通过控制对流不稳定性来确保时间和空间上的准确性和稳定性。\n    -   `增加非正交压力修正步数`: 解决了非正交网格上的误差问题。\n-   这套措施对于确保稳健和稳定的模拟是充分且必要的。\n-   结论：**正确**。\n\n**C. 在瞬态PISO中对压力应用强欠松弛，在出口处保留压力修正量的齐次Neumann边界条件，不设置压力参考点，并使用二阶中心差分格式处理对流项以最小化扩散。额外的精度和松弛将消除发散。**\n-   在PISO中对压力应用强欠松弛实际上将其变成了SIMPLE族算法，并破坏了其瞬态精度，因为PISO被设计为在一个时间步内非迭代的。\n-   保留$p'$的Neumann边界条件且不设压力参考点，使得致命的矩阵奇异性问题未得到解决。\n-   保留中心差分使得对流不稳定性问题未得到解决。这个选项是一堆糟糕的建议。\n-   结论：**不正确**。\n\n**D. 在出口施加法向速度为零以防止回流，在压力方程中增加一个人工可压缩项$\\beta \\,\\partial p/\\partial t$（其中$\\beta0$），并增加$\\Delta t$以平均瞬态效应。这将使系统正则化并稳定瞬态演化。**\n-   在出口施加法向速度为零从根本上将物理问题从通道流变成了别的东西，并且与固定压力出口相冲突。\n-   添加人工可压缩项对于*特定类别*的方法是一种有效技术，但它不是对PISO算法的修正；它完全改变了方程组。\n-   增加$\\Delta t$很可能会恶化而不是改善稳定性。\n-   这个选项建议放弃原问题而转向一个不同的问题，并使用与修复PISO无关的技术。\n-   结论：**不正确**。\n\n**E. 直接在动量方程中添加一个发散阻尼项$\\epsilon \\nabla^2 p$（其中$\\epsilon0$），在所有边界上设置零梯度压力边界条件，并保持$Co \\approx 3$以避免过高的计算成本。增加的压力扩散将消除振荡并使计算收敛。**\n-   添加一个任意的$\\epsilon \\nabla^2 p$项是一种临时的、非物理的修改。\n-   对于有净流入的流动，在所有边界上设置零梯度压力会造成一个不适定的物理问题，其中质量守恒无法全局满足。\n-   它也保证了压力矩阵是奇异的。保持$Co \\approx 3$保留了一个不稳定源。这个选项在物理上和数值上都是荒谬的。\n-   结论：**不正确**。",
            "answer": "$$\\boxed{B}$$"
        }
    ]
}