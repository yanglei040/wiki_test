{
    "hands_on_practices": [
        {
            "introduction": "要掌握斜率限制器的应用，首先需要了解不同限制器函数的基本特性。本练习通过计算几种常用限制器（minmod、superbee 和 van Leer）在特定斜率比 $r$ 下的函数值，帮助您直观地比较它们的行为。通过分析这些值，您将能够理解它们在平滑区域和不连续点附近如何影响梯度的重构，从而揭示每种限制器在耗散性（diffusiveness）与压缩性（compressiveness）之间的不同权衡。",
            "id": "3394934",
            "problem": "考虑标量线性平流方程 $\\partial_t u + a \\,\\partial_x u = 0$，其中平流速度 $a0$ 为常数，该方程通过守恒有限体积法进行离散，使用分段线性重构和一个斜率限制器来强制执行总变差不增 (TVD) 特性。设在单元 $i$ 处的斜率比定义为 $r_i = \\dfrac{\\Delta^- u_i}{\\Delta^+ u_i}$，其中 $\\Delta^- u_i = u_i - u_{i-1}$ 且 $\\Delta^+ u_i = u_{i+1} - u_i$。在通量限制器格式中，用于重构单元界面 $x_{i+1/2}$ 处左状态的限制斜率取为 $\\sigma_i = \\phi(r_i)\\,\\Delta^- u_i$，其中 $\\phi$ 是一个满足 TVD 可容许性的限制器函数。\n\n使用以下标准限制器函数，每个函数均在 $\\mathbb{R}$ 上定义：\n- minmod 限制器：$\\phi_{\\text{mm}}(r) = \\max\\!\\big(0,\\min(1,r)\\big)$。\n- superbee 限制器：$\\phi_{\\text{sb}}(r) = \\max\\!\\big(0,\\min(2r,1),\\min(r,2)\\big)$。\n- van Leer 限制器：$\\phi_{\\text{VL}}(r) = \\dfrac{r + |r|}{1 + |r|}$。\n\n计算当 $r \\in \\{0,\\,0.5,\\,1,\\,2,\\,\\infty\\}$ 时 $\\phi_{\\text{mm}}(r)$、$\\phi_{\\text{sb}}(r)$ 和 $\\phi_{\\text{VL}}(r)$ 的值，并将 $\\infty$ 解释为单侧极限 $r\\to +\\infty$。然后，根据 $\\sigma_i = \\phi(r_i)\\,\\Delta^- u_i$ 在界面重构 $u_{i+1/2}^- = u_i + \\tfrac{1}{2}\\sigma_i$ 中所起的作用，讨论您计算出的值对于光滑单调区域 ($r \\ge 0$) 中重构界面梯度的陡峭性和压缩性的影响。\n\n将您最终的组合值集以单行矩阵的形式按以下顺序表示\n$\\big[\\phi_{\\text{mm}}(0),\\,\\phi_{\\text{sb}}(0),\\,\\phi_{\\text{VL}}(0),\\,\\phi_{\\text{mm}}(0.5),\\,\\phi_{\\text{sb}}(0.5),\\,\\phi_{\\text{VL}}(0.5),\\,\\phi_{\\text{mm}}(1),\\,\\phi_{\\text{sb}}(1),\\,\\phi_{\\text{VL}}(1),\\,\\phi_{\\text{mm}}(2),\\,\\phi_{\\text{sb}}(2),\\,\\phi_{\\text{VL}}(2),\\,\\phi_{\\text{mm}}(\\infty),\\,\\phi_{\\text{sb}}(\\infty),\\,\\phi_{\\text{VL}}(\\infty)\\big]$。\n\n无需四舍五入。不提供单位。",
            "solution": "该问题被认为是有效的，因为它在偏微分方程数值方法的既定理论中具有科学依据，所有必要的定义都已提供，问题是适定的，并且以客观、正式的语言表达。因此，我们可以进行求解。\n\n该问题要求计算三个标准斜率限制器函数 $\\phi(r)$ 在给定的一组斜率比 $r$ 下的值，并随后讨论其对数值格式的影响。斜率比定义为 $r_i = \\frac{\\Delta^- u_i}{\\Delta^+ u_i} = \\frac{u_i - u_{i-1}}{u_{i+1} - u_i}$。三个限制器函数是：\n- Minmod：$\\phi_{\\text{mm}}(r) = \\max\\!\\big(0,\\min(1,r)\\big)$\n- Superbee：$\\phi_{\\text{sb}}(r) = \\max\\!\\big(0,\\min(2r,1),\\min(r,2)\\big)$\n- Van Leer：$\\phi_{\\text{VL}}(r) = \\dfrac{r + |r|}{1 + |r|}$\n\n我们将计算这些函数对于 $r \\in \\{0,\\,0.5,\\,1,\\,2,\\,\\infty\\}$ 的值。对于 $r \\ge 0$，van Leer 限制器可简化，因为 $|r|=r$：\n$\\phi_{\\text{VL}}(r) = \\dfrac{r + r}{1 + r} = \\dfrac{2r}{1+r}$ for $r \\ge 0$。\n\n让我们为每个 $r$ 计算这些值。\n\n**情况 1：$r = 0$**\n- $\\phi_{\\text{mm}}(0) = \\max\\!\\big(0,\\min(1,0)\\big) = \\max(0,0) = 0$。\n- $\\phi_{\\text{sb}}(0) = \\max\\!\\big(0,\\min(2 \\cdot 0,1),\\min(0,2)\\big) = \\max(0,\\min(0,1),\\min(0,2)\\big) = \\max(0,0,0) = 0$。\n- $\\phi_{\\text{VL}}(0) = \\dfrac{2 \\cdot 0}{1+0} = 0$。\n\n**情况 2：$r = 0.5$**\n- $\\phi_{\\text{mm}}(0.5) = \\max\\!\\big(0,\\min(1,0.5)\\big) = \\max(0,0.5) = 0.5 = \\frac{1}{2}$。\n- $\\phi_{\\text{sb}}(0.5) = \\max\\!\\big(0,\\min(2 \\cdot 0.5,1),\\min(0.5,2)\\big) = \\max(0,\\min(1,1),\\min(0.5,2)\\big) = \\max(0,1,0.5) = 1$。\n- $\\phi_{\\text{VL}}(0.5) = \\dfrac{2 \\cdot 0.5}{1+0.5} = \\dfrac{1}{1.5} = \\dfrac{2}{3}$。\n\n**情况 3：$r = 1$**\n- $\\phi_{\\text{mm}}(1) = \\max\\!\\big(0,\\min(1,1)\\big) = \\max(0,1) = 1$。\n- $\\phi_{\\text{sb}}(1) = \\max\\!\\big(0,\\min(2 \\cdot 1,1),\\min(1,2)\\big) = \\max(0,\\min(2,1),\\min(1,2)\\big) = \\max(0,1,1) = 1$。\n- $\\phi_{\\text{VL}}(1) = \\dfrac{2 \\cdot 1}{1+1} = \\dfrac{2}{2} = 1$。\n\n**情况 4：$r = 2$**\n- $\\phi_{\\text{mm}}(2) = \\max\\!\\big(0,\\min(1,2)\\big) = \\max(0,1) = 1$。\n- $\\phi_{\\text{sb}}(2) = \\max\\!\\big(0,\\min(2 \\cdot 2,1),\\min(2,2)\\big) = \\max(0,\\min(4,1),\\min(2,2)\\big) = \\max(0,1,2) = 2$。\n- $\\phi_{\\text{VL}}(2) = \\dfrac{2 \\cdot 2}{1+2} = \\dfrac{4}{3}$。\n\n**情况 5：$r \\to \\infty$**\n- $\\lim_{r\\to\\infty} \\phi_{\\text{mm}}(r) = \\lim_{r\\to\\infty} \\max\\!\\big(0,\\min(1,r)\\big) = \\max(0,1) = 1$。\n- $\\lim_{r\\to\\infty} \\phi_{\\text{sb}}(r) = \\lim_{r\\to\\infty} \\max\\!\\big(0,\\min(2r,1),\\min(r,2)\\big)$。对于 $r \\ge 2$，这简化为 $\\max(0,1,2) = 2$。因此，极限为 $2$。\n- $\\lim_{r\\to\\infty} \\phi_{\\text{VL}}(r) = \\lim_{r\\to\\infty} \\dfrac{2r}{1+r} = \\lim_{r\\to\\infty} \\dfrac{2}{1/r+1} = \\dfrac{2}{0+1} = 2$。\n\n计算出的值总结在最终答案矩阵中。\n\n**影响讨论**\n\n问题陈述，用于重构的限制斜率为 $\\sigma_i = \\phi(r_i)\\,\\Delta^- u_i$，该斜率用于界面值的计算 $u_{i+1/2}^- = u_i + \\frac{1}{2}\\sigma_i$。这意味着单元 $i$ 中重构的斜率实际上与 $\\phi(r_i)$ 成正比。$\\phi(r_i)$ 的大小决定了重构梯度的陡峭程度。分析针对的是光滑单调区域，其中 $r \\ge 0$。\n\n- $\\phi(r)=0$ 的值对应于零斜率、分段常数重构，这是一种一阶迎风格式。这是耗散性最强的情况。所有三个限制器在局部极值点（$u_i - u_{i-1} = 0$ 或 $u_{i+1}-u_i$ 为无穷大）处均得出 $\\phi(0)=0$。这可以防止新振荡的产生。\n\n- $\\phi(r)=1$ 的值意味着该格式使用未修改的后向差分 $\\Delta^- u_i$ 作为斜率。在梯度均匀的区域（$u_i - u_{i-1} = u_{i+1} - u_i$，因此 $r=1$），所有三个限制器都具有 $\\phi(1)=1$。这使得该格式在此类区域具有二阶精度。\n\n- 当 $\\phi(r)  1$ 时，该格式使用的斜率在量级上小于局部迎风梯度，使其比标准的二阶迎风格式更具耗散性或“扩散性”。这倾向于抹平尖锐特征。\n\n- 当 $\\phi(r)  1$ 时，该格式是“压缩性”的或“反扩散性”的。它重构出一个比迎风梯度更陡的斜率，这对于锐化激波或接触面等不连续性是理想的。\n\n根据计算出的值：\n\n- **Minmod ($\\phi_{\\text{mm}}$)**：对于所有 $r \\ge 0$，我们有 $0 \\le \\phi_{\\text{mm}}(r) \\le 1$。它是三个限制器中耗散性最强的。除非梯度完全均匀（$r=1$），否则它会强烈地限制斜率。它的趋势是平滑廓线，这对抑制振荡是稳健的，但可能会过度抹平尖锐特征。在 $r=0.5$ 时，$\\phi_{\\text{mm}}=0.5$，而其他限制器的值更大。对于 $r \\ge 1$，$\\phi_{\\text{mm}}(r)$ 在 1 处饱和。\n\n- **Superbee ($\\phi_{\\text{sb}}$)**：对于 $r \\in (0.5, \\infty)$，我们有 $\\phi_{\\text{sb}}(r)  1$。它是压缩性最强的限制器。在 $r=0.5$ 时，$\\phi_{\\text{sb}}=1$，在 $r=2$ 时，$\\phi_{\\text{sb}}=2$。它旨在重构最陡峭的无振荡廓线。这对于解析尖锐不连续性非常有效，但有时会引入一些小的伪影，例如光滑峰值的“方块化”。\n\n- **Van Leer ($\\phi_{\\text{VL}}$)**：这个限制器提供了一种平衡。当 $r  1$ 时，它是压缩性的，因为对于 $r  1$，有 $\\phi_{\\text{VL}}(r) = \\frac{2r}{1+r}  1$。然而，它没有 Superbee 那么激进（例如，在 $r=2$ 时，$\\phi_{\\text{VL}} = 4/3 \\approx 1.33$，而 $\\phi_{\\text{sb}}=2$）。它通常能产生既尖锐又光滑的廓线，使其成为一个受欢迎的选择。对于 $r0$，它的值总是介于 minmod 和 superbee 之间：$\\phi_{\\text{mm}}(r) \\le \\phi_{\\text{VL}}(r) \\le \\phi_{\\text{sb}}(r)$。\n\n总而言之，限制器的选择代表了在锐利解析不连续性（压缩性）的愿望与防止数值振荡（扩散性）之间的权衡。Superbee 是压缩性最强的，minmod 是扩散性最强的，而 van Leer 则在两者之间提供了一个有效的折衷方案。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0  0  0  \\frac{1}{2}  1  \\frac{2}{3}  1  1  1  1  2  \\frac{4}{3}  1  2  2\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "理解了限制器函数的基本特性后，下一步是将其应用于实际的数值计算中。本练习将引导您在一个具体的有限体积法框架内，使用 van Leer 限制器来执行一个完整的通量计算步骤。您将从离散的单元数据出发，计算重构的界面值，并最终确定迎风格式下的数值通量，从而清晰地看到限制器是如何在 MUSCL (Monotone Upstream-centered Schemes for Conservation Laws) 这类高精度格式中发挥作用的。",
            "id": "3394920",
            "problem": "考虑一维标量守恒律 $u_{t} + a\\,u_{x} = 0$，其中平流速度 $a0$ 为常数。该方程在一个均匀网格上通过有限体积法进行离散，网格单元由 $i \\in \\mathbb{Z}$ 索引，单元中心位于 $x_{i}$。为了获得二阶精度和总变差递减 (TVD) (total variation diminishing) 的数值通量，需要在每个单元内使用一个斜率限制器函数 $\\phi(r)$ 对连续离散梯度的比率进行限制，从而重构一个分段线性近似。\n\n从有限体积法的框架出发，并要求重构的界面状态在光滑区域满足TVD约束和二阶精度，推导右界面处的左状态 $u_{i+1/2}^{-}$ 和左界面处的右状态 $u_{i-1/2}^{+}$ 的表达式。这些表达式应使用局部后向差分 $\\Delta^{-}_{i} := u_{i} - u_{i-1}$、前向差分 $\\Delta^{+}_{i} := u_{i+1} - u_{i}$ 以及它们的比率 $r_{i} := \\Delta^{-}_{i}/\\Delta^{+}_{i}$ 来表示。使用的限制器函数是 van Leer 限制器\n$$\n\\phi_{\\mathrm{VL}}(r) = \\frac{r + |r|}{1 + |r|}.\n$$\n然后，将问题具体化到离散数据 $u_{i-1} = 1.2$，$u_{i} = 1.8$，$u_{i+1} = 2.0$ 和平流速度 $a = 2.5$（所有量均视为无量纲）。对此数据，数值计算 $u_{i+1/2}^{-}$ 和 $u_{i-1/2}^{+}$，并确定当 $a0$ 时界面 $x_{i+1/2}$ 处的迎风数值通量。将最终在 $x_{i+1/2}$ 处的数值通量值表示为一个纯数字。无需四舍五入，提供精确的小数值。",
            "solution": "该问题要求推导并应用一个二阶、总变差递减 (TVD) 的有限体积格式来求解线性平流方程。这通过在每个计算单元内对解进行分段线性重构来实现，其中线性函数的斜率受到限制以防止伪振荡。\n\n首先，验证问题陈述。\n- **已知条件**：\n    - 偏微分方程：$u_{t} + a\\,u_{x} = 0$，其中平流速度 $a  0$ 为常数。\n    - 数值方法：均匀网格上的有限体积法，单元由 $i$ 索引。\n    - 重构：使用斜率限制器函数 $\\phi(r)$ 的分段线性重构。\n    - 定义：$\\Delta^{-}_{i} := u_{i} - u_{i-1}$，$\\Delta^{+}_{i} := u_{i+1} - u_{i}$，$r_{i} := \\Delta^{-}_{i}/\\Delta^{+}_{i}$。\n    - 限制器：van Leer 限制器，$\\phi_{\\mathrm{VL}}(r) = \\frac{r + |r|}{1 + |r|}$。\n    - 数据：$u_{i-1} = 1.2$，$u_{i} = 1.8$，$u_{i+1} = 2.0$，$a = 2.5$。\n    - 任务：推导 $u_{i+1/2}^{-}$ 和 $u_{i-1/2}^{+}$ 的表达式，对其进行数值计算，并求出 $x_{i+1/2}$ 处的迎风数值通量。\n- **验证**：\n    - 该问题具有科学依据，描述了一种用于双曲守恒律的标准MUSCL类型格式。\n    - 问题是适定的，为得到唯一解提供了所有必要信息。\n    - 问题是客观的，并使用了计算流体力学领域的标准、无歧义的术语。\n- **结论**：问题有效。\n\n我们继续求解。\n\n在从 $x_{i-1/2}$ 到 $x_{i+1/2}$ 的单元 $i$ 内，解 $u(x)$ 的分段线性重构由下式给出：\n$$\nu_i(x) = u_i + \\sigma_i (x - x_i)\n$$\n其中 $u_i$ 是单元 $i$ 内的单元平均值，$x_i$ 是单元中心，$\\sigma_i$ 是该单元内解的受限斜率。单元宽度为 $\\Delta x = x_{i+1/2} - x_{i-1/2}$。\n\n在单元界面处的重构值是通过在单元边界 $x_{i \\pm 1/2} = x_i \\pm \\frac{\\Delta x}{2}$ 处计算此线性函数得到的。\n在单元 $i$ 的右界面处的值（即界面 $x_{i+1/2}$ 处黎曼问题的左状态 $u_{i+1/2}^{-}$）是：\n$$\nu_{i+1/2}^{-} = u_i(x_{i+1/2}) = u_i + \\sigma_i (x_{i+1/2} - x_i) = u_i + \\frac{1}{2} \\sigma_i \\Delta x\n$$\n在单元 $i$ 的左界面处的值（即界面 $x_{i-1/2}$ 处黎曼问题的右状态 $u_{i-1/2}^{+}$）是：\n$$\nu_{i-1/2}^{+} = u_i(x_{i-1/2}) = u_i + \\sigma_i (x_{i-1/2} - x_i) = u_i - \\frac{1}{2} \\sigma_i \\Delta x\n$$\n量 $\\sigma_i \\Delta x$ 表示 $u$ 在单元 $i$ 内的受限变化。在使用限制器函数 $\\phi(r)$ 的格式中，这个受限变化通常表示为限制器函数与一个特征未除差分的乘积。一个与问题中 $r_i$ 定义一致的常见约定是将斜率与前向差分 $\\Delta^{+}_{i} = u_{i+1} - u_i$ 相关联：\n$$\n\\sigma_i \\Delta x = \\phi(r_i) \\Delta^{+}_{i}\n$$\n其中 $r_i = \\Delta^{-}_{i} / \\Delta^{+}_{i} = (u_i - u_{i-1}) / (u_{i+1} - u_i)$。\n\n将这个受限斜率的定义代入界面状态的表达式中，我们得到所要求的通用公式：\n$$\nu_{i+1/2}^{-} = u_i + \\frac{1}{2} \\phi(r_i) (u_{i+1} - u_i)\n$$\n$$\nu_{i-1/2}^{+} = u_i - \\frac{1}{2} \\phi(r_i) (u_{i+1} - u_i)\n$$\n\n现在，我们将这些公式应用于给定的数值数据：\n$u_{i-1} = 1.2$，$u_{i} = 1.8$，$u_{i+1} = 2.0$。\n\n首先，我们计算单元 $i$ 的后向和前向差分：\n$$\n\\Delta^{-}_{i} = u_i - u_{i-1} = 1.8 - 1.2 = 0.6\n$$\n$$\n\\Delta^{+}_{i} = u_{i+1} - u_i = 2.0 - 1.8 = 0.2\n$$\n接下来，我们计算比率 $r_i$：\n$$\nr_i = \\frac{\\Delta^{-}_{i}}{\\Delta^{+}_{i}} = \\frac{0.6}{0.2} = 3\n$$\n我们计算 van Leer 限制器函数 $\\phi_{\\mathrm{VL}}(r)$ 在 $r=3$ 处的值：\n$$\n\\phi_{\\mathrm{VL}}(3) = \\frac{3 + |3|}{1 + |3|} = \\frac{3 + 3}{1 + 3} = \\frac{6}{4} = 1.5\n$$\n现在我们可以计算界面状态的数值：\n$$\nu_{i+1/2}^{-} = u_i + \\frac{1}{2} \\phi_{\\mathrm{VL}}(r_i) \\Delta^{+}_{i} = 1.8 + \\frac{1}{2}(1.5)(0.2) = 1.8 + (0.75)(0.2) = 1.8 + 0.15 = 1.95\n$$\n$$\nu_{i-1/2}^{+} = u_i - \\frac{1}{2} \\phi_{\\mathrm{VL}}(r_i) \\Delta^{+}_{i} = 1.8 - \\frac{1}{2}(1.5)(0.2) = 1.8 - 0.15 = 1.65\n$$\n\n最后，我们确定界面 $x_{i+1/2}$ 处的迎风数值通量。对于守恒律 $u_t + (au)_x = 0$，物理通量为 $f(u) = au$。特征速度是 $f'(u) = a$。\n给定 $a = 2.5  0$，信息从左向右传播。因此，界面 $x_{i+1/2}$ 处的迎风通量由界面左侧的状态决定，即 $u_{i+1/2}^{-}$。\n数值通量 $F_{i+1/2}$ 由 Godunov 通量给出，对于线性平流方程，它简化为迎风通量：\n$$\nF_{i+1/2} = f(u_{i+1/2}^{-}) = a \\cdot u_{i+1/2}^{-}\n$$\n代入数值 $a=2.5$ 和 $u_{i+1/2}^{-} = 1.95$：\n$$\nF_{i+1/2} = 2.5 \\times 1.95 = \\frac{5}{2} \\times \\frac{195}{100} = \\frac{5}{2} \\times \\frac{39}{20} = \\frac{1}{2} \\times \\frac{39}{4} = \\frac{39}{8} = 4.875\n$$\n界面 $x_{i+1/2}$ 处的数值通量值为 $4.875$。",
            "answer": "$$\\boxed{4.875}$$"
        },
        {
            "introduction": "这个高阶练习将局部、逐单元的限制器作用与数值解的全局、宏观行为联系起来。通过修正方程分析，我们可以理解这些格式如何引入“人工粘性”来稳定不连续性。本练习让您能够推导出一个关键的性能指标——数值捕获的激波厚度，揭示了尽管限制器函数形式不同，但在处理激波时它们都遵循一个共同的稳定化机制。",
            "id": "3394949",
            "problem": "考虑线性平流方程 $u_t + a\\,u_x = 0$，其中平流速度 $a  0$ 为常数，在间距为 $\\Delta x$ 的均匀网格和时间步长为 $\\Delta t$ 上求解，并定义库朗-弗里德里希-列维 (CFL) 数为 $\\nu = a\\,\\Delta t / \\Delta x$。一个使用总变差不增 (TVD) 通量限制器函数 $\\phi(r)$ 的高分辨率显式有限体积格式被应用于该方程，其中标准的斜率比 $r$ 是通过 $a0$ 时相邻解的差值构造的。限制器函数由下式给出\n$$\n\\phi_{\\mathrm{MM}}(r) = \\max\\!\\big(0,\\, \\min(1,\\,r)\\big),\\quad\n\\phi_{\\mathrm{SB}}(r) = \\max\\!\\big(0,\\, \\min(2r,\\,1),\\, \\min(r,\\,2)\\big),\\quad\n\\phi_{\\mathrm{VL}}(r) = \\frac{r + |r|}{1 + |r|},\n$$\n分别对应 minmod、superbee 和 van Leer 限制器。\n\n从线性平流的基本通量守恒更新和带有限制器 $\\phi(r)$ 的 TVD 高分辨率通量表示出发，对在光滑区域 ($r \\approx 1$) 和单调间断核心 ($r \\approx 0$) 均有效的 $\\Delta x$ 和 $\\Delta t$ 的主导非平凡阶进行修正方程分析。在形式修正方程\n$$\nu_t + a\\,u_x = \\beta\\,u_{xx} + \\gamma\\,u_{xxx} + \\text{higher-order terms}.\n$$\n中，提取等效扩散系数 $\\beta$ 和色散系数 $\\gamma$。\n然后，假设内部激波层是单调的，并且限制器在激波核心处强制产生一阶行为，通过平衡层内的平流和主导的人工扩散来估算激波厚度 $\\delta$。为每种限制器 (minmod、superbee 和 van Leer)，提供预测的激波厚度 $\\delta$ 关于 $\\Delta x$ 和 $\\nu$ 的最终解析表达式。你的最终答案必须是单个解析表达式；如果提供多个值，请将它们写成单行矩阵的元素。不需要四舍五入，最终表达式中不应包含物理单位。",
            "solution": "用户希望找到应用于线性平流方程 $u_t + a\\,u_x = 0$ ($a0$) 的高分辨率 TVD 格式的激波厚度。求解过程需要进行修正方程分析，然后使用一个关于格式在激波层内部行为的特定假设。\n\n对于宽度为 $\\Delta x$ 的单元 $j$，有限体积格式由下式给出\n$$u_j^{n+1} = u_j^n - \\frac{\\Delta t}{\\Delta x} \\left( f_{j+1/2} - f_{j-1/2} \\right)$$\n其中 $f_{j+1/2}$ 是单元 $j$ 和 $j+1$ 之间界面上的数值通量。对于高分辨率 TVD 格式，通量可以表示为对一阶迎风通量的修正。由于 $a0$，迎风方向来自左侧。使用限制器函数 $\\phi(r)$ 的标准数值通量形式为：\n$$f_{j+1/2} = a u_j + \\frac{a}{2}(1-\\nu) \\phi(r_j) (u_{j+1}-u_j)$$\n其中 $\\nu = a \\Delta t / \\Delta x$ 是 CFL 数，$r_j$ 是连续解梯度的比率，对于迎风格式定义为：\n$$r_j = \\frac{u_j - u_{j-1}}{u_{j+1} - u_j}$$\n项 $\\frac{a}{2}(1-\\nu)(u_{j+1}-u_j)$ 代表二阶 Lax-Wendroff 格式的反扩散通量，它被 $\\phi(r_j)$ 所限制。\n\n问题首先要求进行修正方程分析，以在形式方程 $u_t + a\\,u_x = \\beta\\,u_{xx} + \\gamma\\,u_{xxx} + \\dots$ 中找到等效扩散 ($\\beta$) 和色散 ($\\gamma$) 系数。此分析要求针对两个区域进行：光滑区域 ($r \\approx 1$) 和激波核心 ($r \\approx 0$)。\n\n然而，对于问题的最后一部分——估算激波厚度 $\\delta$——我们得到了一个具体指令：“假设内部激波层是单调的，并且限制器在激波核心处强制产生一阶行为，通过平衡层内的平流和主导的人工扩散来估算激波厚度 $\\delta$。”\n\n这个假设至关重要。一阶行为意味着高阶修正通量项可以忽略不计或为零。对于给定的通量公式，当 $\\phi(r)=0$ 时会发生这种情况。格式随后简化为一阶迎风格式：\n$$f_{j+1/2} = a u_j$$\n有限体积更新变为：\n$$u_j^{n+1} = u_j^n - \\frac{\\Delta t}{\\Delta x} (a u_j - a u_{j-1}) = u_j^n - \\nu (u_j - u_{j-1})$$\n\n我们对一阶迎风格式进行修正方程分析。我们将各项在点 $(x_j, t_n)$ 附近进行泰勒级数展开：\n$$\\frac{u_j^{n+1} - u_j^n}{\\Delta t} = u_t + \\frac{\\Delta t}{2}u_{tt} + \\mathcal{O}(\\Delta t^2)$$\n$$-a \\frac{u_j - u_{j-1}}{\\Delta x} = -a \\left( u_x - \\frac{\\Delta x}{2}u_{xx} + \\frac{\\Delta x^2}{6}u_{xxx} + \\mathcal{O}(\\Delta x^3) \\right)$$\n将这些项相等并重新整理得到：\n$$u_t + a u_x = -\\frac{\\Delta t}{2}u_{tt} + \\frac{a\\Delta x}{2}u_{xx} - \\frac{a\\Delta x^2}{6}u_{xxx} + \\dots$$\n为了获得空间上的主导误差项，我们通过反复使用原始偏微分方程 $u_t = -a u_x$ 来消除时间导数 $u_{tt}$，得到 $u_{tt} = a^2 u_{xx}$。将此代入方程中得到：\n$$u_t + a u_x = -\\frac{\\Delta t}{2}(a^2 u_{xx}) + \\frac{a\\Delta x}{2}u_{xx} + \\mathcal{O}(\\Delta x^2)$$\n$$u_t + a u_x = \\left(\\frac{a\\Delta x}{2} - \\frac{a^2\\Delta t}{2}\\right) u_{xx} + \\mathcal{O}(\\Delta x^2)$$\n$u_{xx}$ 项的系数是人工扩散系数 $\\beta$。提取公因子并使用 CFL 数的定义 $\\nu = a \\Delta t / \\Delta x$：\n$$\\beta = \\frac{a\\Delta x}{2} \\left(1 - \\frac{a\\Delta t}{\\Delta x}\\right) = \\frac{a\\Delta x}{2} (1-\\nu)$$\n这是一阶迎风格式众所周知的人工扩散。根据问题的假设，这是激波核心中的主导扩散行为。\n\n下一步是估算激波厚度 $\\delta$。这通过平衡激波层内平流项和主导人工扩散项的量级来完成。设解在激波上的总变化为 $\\Delta u$。梯度和曲率可以近似为：\n$$u_x \\sim \\frac{\\Delta u}{\\delta}$$\n$$u_{xx} \\sim \\frac{\\Delta u}{\\delta^2}$$\n修正方程中平流和扩散的平衡关系为：\n$$a u_x \\approx \\beta u_{xx}$$\n$$a \\frac{\\Delta u}{\\delta} \\approx \\beta \\frac{\\Delta u}{\\delta^2}$$\n求解激波厚度 $\\delta$ 得到：\n$$\\delta \\approx \\frac{\\beta}{a}$$\n代入一阶迎风格式的 $\\beta$ 表达式：\n$$\\delta \\approx \\frac{\\frac{a\\Delta x}{2}(1-\\nu)}{a} = \\frac{\\Delta x}{2}(1-\\nu)$$\n问题要求给出三种限制器（minmod、superbee 和 van Leer）各自的激波厚度。给定的限制器是：\n$$\\phi_{\\mathrm{MM}}(r) = \\max\\!\\big(0,\\, \\min(1,\\,r)\\big)$$\n$$\\phi_{\\mathrm{SB}}(r) = \\max\\!\\big(0,\\, \\min(2r,\\,1),\\, \\min(r,\\,2)\\big)$$\n$$\\phi_{\\mathrm{VL}}(r) = \\frac{r + |r|}{1 + |r|}$$\n所有这些限制器都被设计为在陡峭梯度或局部极值处恢复到一阶精度以防止振荡，这是成为 TVD 的一个条件。这是通过确保当局部解的剖面不光滑时（例如，对于 $r \\le 0$），$\\phi(r) \\to 0$ 来实现的。问题中关于在激波核心使用一阶模型的假设正是这种行为的形式化。由于 $\\delta$ 的计算完全基于这个假设，其结果与具体的限制器函数无关。因此，三种限制器的估算激波厚度是相同的。\n\n最终答案是每种限制器的 $\\delta$ 的解析表达式。由于它们是相同的，我们将把相同的表达式列出三次。\n\n最终表达式：\n$$\n\\delta = \\frac{\\Delta x}{2}(1-\\nu)\n$$\n我们按要求为这三种限制器中的每一种提供此结果。",
            "answer": "$$\\boxed{\\begin{pmatrix} \\frac{\\Delta x}{2}(1-\\nu)  \\frac{\\Delta x}{2}(1-\\nu)  \\frac{\\Delta x}{2}(1-\\nu) \\end{pmatrix}}$$"
        }
    ]
}