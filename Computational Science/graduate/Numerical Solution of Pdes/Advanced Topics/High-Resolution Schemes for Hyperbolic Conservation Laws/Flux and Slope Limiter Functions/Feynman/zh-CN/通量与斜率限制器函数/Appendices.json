{
    "hands_on_practices": [
        {
            "introduction": "不同的通量限制器函数代表了在抑制数值振荡和保持解的陡峭性之间不同的权衡策略。此练习  邀请你计算三种常用限制器（minmod、superbee 和 van Leer）在不同斜率比下的具体值。通过这种直接比较，你将揭示它们的基本特性，从最具耗散性的 minmod 到最具压缩性的 superbee，从而为在实际应用中选择合适的限制器建立直观理解。",
            "id": "3394934",
            "problem": "考虑标量线性平流方程 $\\partial_t u + a \\,\\partial_x u = 0$，其中平流速度 $a0$ 为常数，该方程通过保守有限体积法进行离散化，采用分段线性重构和斜率限制器来强制执行总变差递减（TVD）属性。设在单元 $i$ 处的斜率比定义为 $r_i = \\dfrac{\\Delta^- u_i}{\\Delta^+ u_i}$，其中 $\\Delta^- u_i = u_i - u_{i-1}$ 且 $\\Delta^+ u_i = u_{i+1} - u_i$。在通量限制器格式中，用于在单元界面 $x_{i+1/2}$ 处重构左状态的受限斜率取为 $\\sigma_i = \\phi(r_i)\\,\\Delta^+ u_i$，其中 $\\phi$ 是满足TVD可容许性的限制器函数。\n\n使用以下标准限制器函数，每个函数都在 $\\mathbb{R}$ 上定义：\n- minmod 限制器：$\\phi_{\\text{mm}}(r) = \\max\\!\\big(0,\\min(1,r)\\big)$。\n- superbee 限制器：$\\phi_{\\text{sb}}(r) = \\max\\!\\big(0,\\min(2r,1),\\min(r,2)\\big)$。\n- van Leer 限制器：$\\phi_{\\text{VL}}(r) = \\dfrac{r + |r|}{1 + |r|}$。\n\n计算 $\\phi_{\\text{mm}}(r)$、$\\phi_{\\text{sb}}(r)$ 和 $\\phi_{\\text{VL}}(r)$ 在 $r \\in \\{0,\\,0.5,\\,1,\\,2,\\,\\infty\\}$ 时的值，将 $\\infty$ 解释为单侧极限 $r\\to +\\infty$。然后，根据 $\\sigma_i = \\phi(r_i)\\,\\Delta^+ u_i$ 在界面重构 $u_{i+1/2}^- = u_i + \\tfrac{1}{2}\\sigma_i$ 中所扮演的角色，讨论您计算出的值对于平滑单调区域（$r \\ge 0$）中重构界面梯度的陡峭性和压缩性的影响。\n\n将您最终的组合值集表示为单个行矩阵，顺序如下\n$\\big[\\phi_{\\text{mm}}(0),\\,\\phi_{\\text{sb}}(0),\\,\\phi_{\\text{VL}}(0),\\,\\phi_{\\text{mm}}(0.5),\\,\\phi_{\\text{sb}}(0.5),\\,\\phi_{\\text{VL}}(0.5),\\,\\phi_{\\text{mm}}(1),\\,\\phi_{\\text{sb}}(1),\\,\\phi_{\\text{VL}}(1),\\,\\phi_{\\text{mm}}(2),\\,\\phi_{\\text{sb}}(2),\\,\\phi_{\\text{VL}}(2),\\,\\phi_{\\text{mm}}(\\infty),\\,\\phi_{\\text{sb}}(\\infty),\\,\\phi_{\\text{VL}}(\\infty)\\big]$。\n\n无需四舍五入。不提供单位。",
            "solution": "该问题被认为是有效的，因为它科学地基于偏微分方程数值方法的既定理论，提法得当且提供了所有必要的定义，并以客观、正式的语言表述。因此，我们可以进行求解。\n\n该问题要求计算三个标准斜率限制器函数 $\\phi(r)$ 在一组给定的斜率比 $r$ 下的值，并随后讨论其对数值格式的影响。斜率比定义为 $r_i = \\frac{\\Delta^- u_i}{\\Delta^+ u_i} = \\frac{u_i - u_{i-1}}{u_{i+1} - u_i}$。三个限制器函数是：\n- Minmod: $\\phi_{\\text{mm}}(r) = \\max\\!\\big(0,\\min(1,r)\\big)$\n- Superbee: $\\phi_{\\text{sb}}(r) = \\max\\!\\big(0,\\min(2r,1),\\min(r,2)\\big)$\n- Van Leer: $\\phi_{\\text{VL}}(r) = \\dfrac{r + |r|}{1 + |r|}$\n\n我们将计算这些函数在 $r \\in \\{0,\\,0.5,\\,1,\\,2,\\,\\infty\\}$ 时的值。对于 $r \\ge 0$，由于 $|r|=r$，van Leer 限制器可简化为：\n$\\phi_{\\text{VL}}(r) = \\dfrac{r + r}{1 + r} = \\dfrac{2r}{1+r}$ for $r \\ge 0$。\n\n让我们计算每个 $r$ 的值。\n\n**情况 1：$r = 0$**\n- $\\phi_{\\text{mm}}(0) = \\max\\!\\big(0,\\min(1,0)\\big) = \\max(0,0) = 0$。\n- $\\phi_{\\text{sb}}(0) = \\max\\!\\big(0,\\min(2 \\cdot 0,1),\\min(0,2)\\big) = \\max(0,\\min(0,1),\\min(0,2)\\big) = \\max(0,0,0) = 0$。\n- $\\phi_{\\text{VL}}(0) = \\dfrac{2 \\cdot 0}{1+0} = 0$。\n\n**情况 2：$r = 0.5$**\n- $\\phi_{\\text{mm}}(0.5) = \\max\\!\\big(0,\\min(1,0.5)\\big) = \\max(0,0.5) = 0.5 = \\frac{1}{2}$。\n- $\\phi_{\\text{sb}}(0.5) = \\max\\!\\big(0,\\min(2 \\cdot 0.5,1),\\min(0.5,2)\\big) = \\max(0,\\min(1,1),\\min(0.5,2)\\big) = \\max(0,1,0.5) = 1$。\n- $\\phi_{\\text{VL}}(0.5) = \\dfrac{2 \\cdot 0.5}{1+0.5} = \\dfrac{1}{1.5} = \\dfrac{2}{3}$。\n\n**情况 3：$r = 1$**\n- $\\phi_{\\text{mm}}(1) = \\max\\!\\big(0,\\min(1,1)\\big) = \\max(0,1) = 1$。\n- $\\phi_{\\text{sb}}(1) = \\max\\!\\big(0,\\min(2 \\cdot 1,1),\\min(1,2)\\big) = \\max(0,\\min(2,1),\\min(1,2)\\big) = \\max(0,1,1) = 1$。\n- $\\phi_{\\text{VL}}(1) = \\dfrac{2 \\cdot 1}{1+1} = \\dfrac{2}{2} = 1$。\n\n**情况 4：$r = 2$**\n- $\\phi_{\\text{mm}}(2) = \\max\\!\\big(0,\\min(1,2)\\big) = \\max(0,1) = 1$。\n- $\\phi_{\\text{sb}}(2) = \\max\\!\\big(0,\\min(2 \\cdot 2,1),\\min(2,2)\\big) = \\max(0,\\min(4,1),\\min(2,2)\\big) = \\max(0,1,2) = 2$。\n- $\\phi_{\\text{VL}}(2) = \\dfrac{2 \\cdot 2}{1+2} = \\dfrac{4}{3}$。\n\n**情况 5：$r \\to \\infty$**\n- $\\lim_{r\\to\\infty} \\phi_{\\text{mm}}(r) = \\lim_{r\\to\\infty} \\max\\!\\big(0,\\min(1,r)\\big) = \\max(0,1) = 1$。\n- $\\lim_{r\\to\\infty} \\phi_{\\text{sb}}(r) = \\lim_{r\\to\\infty} \\max\\!\\big(0,\\min(2r,1),\\min(r,2)\\big)$。对于 $r \\ge 2$，此式简化为 $\\max(0,1,2) = 2$。因此，极限为 $2$。\n- $\\lim_{r\\to\\infty} \\phi_{\\text{VL}}(r) = \\lim_{r\\to\\infty} \\dfrac{2r}{1+r} = \\lim_{r\\to\\infty} \\dfrac{2}{1/r+1} = \\dfrac{2}{0+1} = 2$。\n\n计算出的值汇总在最终答案矩阵中。\n\n**影响讨论**\n\n问题指出，用于重构的受限斜率是 $\\sigma_i = \\phi(r_i)\\,\\Delta^+ u_i$，它被用于界面值计算 $u_{i+1/2}^- = u_i + \\frac{1}{2}\\sigma_i$。这意味着单元 $i$ 中重构的斜率（总变化量）实际上与 $\\phi(r_i)$ 成正比。$\\phi(r_i)$ 的大小决定了重构梯度的陡峭程度。分析针对的是平滑单调区域，其中 $r \\ge 0$。\n\n- $\\phi(r)=0$ 的值对应于零斜率的分段常数重构，即一阶迎风格式。这是耗散性最强的情况。所有三种限制器在 $r=0$ 时都得到 $\\phi(0)=0$，这发生在局部极值点（$u_i - u_{i-1} = 0$ 或 $u_{i+1}-u_i$ 为无穷大）。这可以防止新振荡的产生。\n\n- $\\phi(r)=1$ 的值意味着格式使用未修改的前向差分 $\\Delta^+ u_i$ 作为斜率。在梯度均匀的区域（$u_i - u_{i-1} = u_{i+1} - u_i$，因此 $r=1$），所有三种限制器都有 $\\phi(1)=1$。这使得格式在此类区域中具有二阶精度。\n\n- 当 $\\phi(r)  1$ 时，格式使用的斜率在量级上小于局部迎风梯度，使其比标准的二阶迎风格式更具耗散性或“扩散性”。这倾向于抹平尖锐特征。\n\n- 当 $\\phi(r) > 1$ 时，格式是“压缩性”或“反扩散性”的。它重构的斜率比迎风梯度更陡峭，这对于锐化激波或接触面等间断是理想的。\n\n基于计算出的值：\n\n- **Minmod ($\\phi_{\\text{mm}}$)**：对于所有 $r \\ge 0$，我们有 $0 \\le \\phi_{\\text{mm}}(r) \\le 1$。它是三种限制器中耗散性最强的。它会强烈限制斜率，除非梯度是完全均匀的（$r=1$）。其倾向是平滑剖面，这对抑制振荡是鲁棒的，但可能会过度抹平尖锐特征。在 $r=0.5$ 时，$\\phi_{\\text{mm}}=0.5$，而其他限制器的值更大。对于 $r \\ge 1$，$\\phi_{\\text{mm}}(r)$ 饱和于 $1$。\n\n- **Superbee ($\\phi_{\\text{sb}}$)**：对于 $r \\in (0.5, \\infty)$，我们有 $\\phi_{\\text{sb}}(r) > 1$。它是压缩性最强的限制器。在 $r=0.5$ 时，$\\phi_{\\text{sb}}=1$；在 $r=2$ 时，$\\phi_{\\text{sb}}=2$。它旨在重构最陡峭的无振荡剖面。这在解析尖锐间断方面非常有效，但有时会引入一些小的人为瑕疵，比如使平滑峰“变方”。\n\n- **Van Leer ($\\phi_{\\text{VL}}$)**：该限制器提供了一种平衡。对于 $r > 1$，它是压缩性的，因为 $\\phi_{\\text{VL}}(r) = \\frac{2r}{1+r} > 1$。然而，它不如 Superbee 激进（例如，在 $r=2$ 时，$\\phi_{\\text{VL}} = 4/3 \\approx 1.33$ 而 $\\phi_{\\text{sb}}=2$）。它通常能产生尖锐而平滑的剖面，使其成为一个受欢迎的选择。对于 $r>0$，它的值总是介于 minmod 和 superbee 之间：$\\phi_{\\text{mm}}(r) \\le \\phi_{\\text{VL}}(r) \\le \\phi_{\\text{sb}}(r)$。\n\n总之，限制器的选择代表了在锐化间断解析（压缩性）的期望与防止数值振荡（扩散性）之间的权衡。Superbee 的压缩性最强，minmod 的扩散性最强，而 van Leer 则在两者之间提供了一个有效的折衷。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0  0  0  \\frac{1}{2}  1  \\frac{2}{3}  1  1  1  1  2  \\frac{4}{3}  1  2  2\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "抽象的限制器函数通过修正数值通量，在有限体积法中发挥其关键作用。此练习  提供了一个具体的计算场景，给定离散的单元数据，引导你逐步使用 van Leer 限制器来重构界面值并计算最终的迎风格式通量。这个过程将清晰地展示斜率限制器与解的演化之间的力学联系，将理论付诸实践。",
            "id": "3394920",
            "problem": "考虑一维标量守恒律 $u_{t} + a\\,u_{x} = 0$，其中平流速度 $a0$ 为常数。该方程在一个均匀网格上通过有限体积法进行离散，网格单元由 $i \\in \\mathbb{Z}$ 索引，单元中心位于 $x_{i}$。为了获得二阶精确且总变差递减（TVD）的数值通量，在每个单元中使用一个斜率限制器函数 $\\phi(r)$ 对连续离散梯度的比率进行处理，从而重构一个分段线性近似。\n\n从有限体积框架出发，并根据重构的界面状态在光滑区域需满足TVD约束和二阶精度的要求，推导右侧界面上的左状态 $u_{i+1/2}^{-}$ 和左侧界面上的右状态 $u_{i-1/2}^{+}$ 的表达式。这些表达式应使用局部后向差分 $\\Delta^{-}_{i} := u_{i} - u_{i-1}$、前向差分 $\\Delta^{+}_{i} := u_{i+1} - u_{i}$ 以及比率 $r_{i} := \\Delta^{-}_{i}/\\Delta^{+}_{i}$ 来表示。使用的限制器函数是 van Leer 限制器\n$$\n\\phi_{\\mathrm{VL}}(r) = \\frac{r + |r|}{1 + |r|}.\n$$\n然后，将表达式应用于离散数据 $u_{i-1} = 1.2$, $u_{i} = 1.8$, $u_{i+1} = 2.0$ 和平流速度 $a = 2.5$（所有量均视为无量纲）。对这些数据，数值计算 $u_{i+1/2}^{-}$ 和 $u_{i-1/2}^{+}$，并确定当 $a0$ 时界面 $x_{i+1/2}$ 处的迎风数值通量。将界面 $x_{i+1/2}$ 处的最终数值通量值表示为一个纯数。无需四舍五入；提供精确的小数值。",
            "solution": "该问题要求推导并应用一种用于线性平流方程的二阶总变差递减（TVD）有限体积格式。这通过在每个计算单元内对解进行分段线性重构来实现，其中线性函数的斜率受到限制以防止伪振荡。\n\n首先，对问题陈述进行验证。\n- **已知条件**：\n    - 偏微分方程：$u_{t} + a\\,u_{x} = 0$，具有恒定平流速度 $a  0$。\n    - 数值方法：在均匀网格上的有限体积法，单元由 $i$ 索引。\n    - 重构：带有斜率限制器函数 $\\phi(r)$ 的分段线性重构。\n    - 定义：$\\Delta^{-}_{i} := u_{i} - u_{i-1}$，$\\Delta^{+}_{i} := u_{i+1} - u_{i}$，$r_{i} := \\Delta^{-}_{i}/\\Delta^{+}_{i}$。\n    - 限制器：van Leer 限制器，$\\phi_{\\mathrm{VL}}(r) = \\frac{r + |r|}{1 + |r|}$。\n    - 数据：$u_{i-1} = 1.2$, $u_{i} = 1.8$, $u_{i+1} = 2.0$, $a = 2.5$。\n    - 任务：推导 $u_{i+1/2}^{-}$ 和 $u_{i-1/2}^{+}$ 的表达式，对它们进行数值计算，并求出界面 $x_{i+1/2}$ 处的迎风数值通量。\n- **验证**：\n    - 该问题具有科学依据，描述了一种用于双曲守恒律的标准MUSCL类格式。\n    - 它是适定的，为获得唯一解提供了所有必要信息。\n    - 它是客观的，并使用了计算流体动力学领域的标准、明确的术语。\n- **结论**：该问题有效。\n\n我们继续进行求解。\n\n在单元 $i$（范围从 $x_{i-1/2}$ 到 $x_{i+1/2}$）内，解 $u(x)$ 的分段线性重构由下式给出：\n$$\nu_i(x) = u_i + \\sigma_i (x - x_i)\n$$\n其中 $u_i$ 是单元 $i$ 内的单元平均值，$x_i$ 是单元中心，$\\sigma_i$ 是该单元内解的受限斜率。单元宽度为 $\\Delta x = x_{i+1/2} - x_{i-1/2}$。\n\n单元界面上的重构值是通过在单元边界 $x_{i \\pm 1/2} = x_i \\pm \\frac{\\Delta x}{2}$ 处计算此线性函数的值得到的。\n单元 $i$ 右侧界面上的值（即界面 $x_{i+1/2}$ 处黎曼问题的左状态 $u_{i+1/2}^{-}$）是：\n$$\nu_{i+1/2}^{-} = u_i(x_{i+1/2}) = u_i + \\sigma_i (x_{i+1/2} - x_i) = u_i + \\frac{1}{2} \\sigma_i \\Delta x\n$$\n单元 $i$ 左侧界面上的值（即界面 $x_{i-1/2}$ 处黎曼问题的右状态 $u_{i-1/2}^{+}$）是：\n$$\nu_{i-1/2}^{+} = u_i(x_{i-1/2}) = u_i + \\sigma_i (x_{i-1/2} - x_i) = u_i - \\frac{1}{2} \\sigma_i \\Delta x\n$$\n量 $\\sigma_i \\Delta x$ 表示 $u$ 穿过单元 $i$ 的受限变化量。在采用限制器函数 $\\phi(r)$ 的格式中，这个受限变化量通常表示为限制器函数与一个特征差分的乘积。一个与问题中 $r_i$ 定义一致的常见约定是将斜率与前向差分 $\\Delta^{+}_{i} = u_{i+1} - u_i$ 相关联：\n$$\n\\sigma_i \\Delta x = \\phi(r_i) \\Delta^{+}_{i}\n$$\n其中 $r_i = \\Delta^{-}_{i} / \\Delta^{+}_{i} = (u_i - u_{i-1}) / (u_{i+1} - u_i)$。\n\n将这个受限斜率的定义代入界面状态的表达式中，我们得到所要求的一般公式：\n$$\nu_{i+1/2}^{-} = u_i + \\frac{1}{2} \\phi(r_i) (u_{i+1} - u_i)\n$$\n$$\nu_{i-1/2}^{+} = u_i - \\frac{1}{2} \\phi(r_i) (u_{i+1} - u_i)\n$$\n\n现在，我们将这些公式应用于给定的数值数据：\n$u_{i-1} = 1.2$, $u_{i} = 1.8$, $u_{i+1} = 2.0$。\n\n首先，我们计算单元 $i$ 的后向和前向差分：\n$$\n\\Delta^{-}_{i} = u_i - u_{i-1} = 1.8 - 1.2 = 0.6\n$$\n$$\n\\Delta^{+}_{i} = u_{i+1} - u_i = 2.0 - 1.8 = 0.2\n$$\n接下来，我们计算比率 $r_i$：\n$$\nr_i = \\frac{\\Delta^{-}_{i}}{\\Delta^{+}_{i}} = \\frac{0.6}{0.2} = 3\n$$\n我们计算 van Leer 限制器函数 $\\phi_{\\mathrm{VL}}(r)$ 在 $r=3$ 处的值：\n$$\n\\phi_{\\mathrm{VL}}(3) = \\frac{3 + |3|}{1 + |3|} = \\frac{3 + 3}{1 + 3} = \\frac{6}{4} = 1.5\n$$\n现在我们可以计算界面状态的数值：\n$$\nu_{i+1/2}^{-} = u_i + \\frac{1}{2} \\phi_{\\mathrm{VL}}(r_i) \\Delta^{+}_{i} = 1.8 + \\frac{1}{2}(1.5)(0.2) = 1.8 + (0.75)(0.2) = 1.8 + 0.15 = 1.95\n$$\n$$\nu_{i-1/2}^{+} = u_i - \\frac{1}{2} \\phi_{\\mathrm{VL}}(r_i) \\Delta^{+}_{i} = 1.8 - \\frac{1}{2}(1.5)(0.2) = 1.8 - 0.15 = 1.65\n$$\n\n最后，我们确定界面 $x_{i+1/2}$ 处的迎风数值通量。对于守恒律 $u_t + (au)_x = 0$，物理通量为 $f(u) = au$。特征速度为 $f'(u) = a$。\n给定 $a = 2.5 > 0$，信息从左向右传播。因此，界面 $x_{i+1/2}$ 处的迎风通量由界面左侧的状态决定，即 $u_{i+1/2}^{-}$。\n数值通量 $F_{i+1/2}$ 由 Godunov 通量给出，对于线性平流，它简化为迎风通量：\n$$\nF_{i+1/2} = f(u_{i+1/2}^{-}) = a \\cdot u_{i+1/2}^{-}\n$$\n代入值 $a=2.5$ 和 $u_{i+1/2}^{-} = 1.95$：\n$$\nF_{i+1/2} = 2.5 \\times 1.95 = \\frac{5}{2} \\times \\frac{195}{100} = \\frac{5}{2} \\times \\frac{39}{20} = \\frac{1}{2} \\times \\frac{39}{4} = \\frac{39}{8} = 4.875\n$$\n界面 $x_{i+1/2}$ 处的数值通量值为 $4.875$。",
            "answer": "$$\\boxed{4.875}$$"
        },
        {
            "introduction": "在掌握了单个通量的计算后，我们可以进一步分析整个数值格式的宏观性能。此练习  运用修正方程分析这一强大工具，来研究一个关键的性能指标：数值捕捉到的激波厚度。通过一个核心假设——即限制器在激波内部会将格式降为一阶精度以保证单调性——你将能推导出解的锐度如何依赖于网格间距和 CFL 数，这对于评估和预测数值模拟的质量至关重要。",
            "id": "3394949",
            "problem": "考虑线性平流方程 $u_t + a\\,u_x = 0$，其中平流速度 $a  0$ 为常数，在间距为 $\\Delta x$、时间步长为 $\\Delta t$ 的均匀网格上，定义 Courant–Friedrichs–Lewy (CFL) 数为 $\\nu = a\\,\\Delta t / \\Delta x$。应用一个使用总变差递减 (TVD) 通量限制器函数 $\\phi(r)$ 的高分辨率显式有限体积格式，其中标准斜率比 $r$ 由相邻解的差分（对于 $a0$）构造。限制器函数由下式给出\n$$\n\\phi_{\\mathrm{MM}}(r) = \\max\\!\\big(0,\\, \\min(1,\\,r)\\big),\\quad\n\\phi_{\\mathrm{SB}}(r) = \\max\\!\\big(0,\\, \\min(2r,\\,1),\\, \\min(r,\\,2)\\big),\\quad\n\\phi_{\\mathrm{VL}}(r) = \\frac{r + |r|}{1 + |r|},\n$$\n分别对应于 minmod、superbee 和 van Leer 限制器。\n\n从线性平流的基本通量守恒更新和带有限制器 $\\phi(r)$ 的 TVD 高分辨率通量表示出发，进行修正方程分析，保留在 $\\Delta x$ 和 $\\Delta t$ 上的主导非平凡阶。该分析需对光滑区域（$r \\approx 1$）和单调间断的核心区域（$r \\approx 0$）均有效。在形式修正方程\n$$\nu_t + a\\,u_x = \\beta\\,u_{xx} + \\gamma\\,u_{xxx} + \\text{更高阶项}\n$$\n中，提取等效扩散系数 $\\beta$ 和色散系数 $\\gamma$。\n然后，假设内部激波层是单调的，且限制器在激波核心处强制一阶行为，通过平衡层内的平流和主导人工扩散来估计激波厚度 $\\delta$。为每个限制器（minmod、superbee 和 van Leer）提供预测激波厚度 $\\delta$ 作为 $\\Delta x$ 和 $\\nu$ 的函数的最终解析表达式。你的最终答案必须是单个解析表达式；如果提供多个值，请将它们写为单个行矩阵的条目。无需四舍五入，最终表达式中不应包含物理单位。",
            "solution": "用户希望找到应用于线性平流方程 $u_t + a\\,u_x = 0$（其中 $a0$）的高分辨率 TVD 格式的激波厚度。求解过程需要进行修正方程分析，然后使用一个关于格式在激波层内部行为的特定假设。\n\n对于宽度为 $\\Delta x$ 的单元 $j$，其有限体积格式由下式给出\n$$u_j^{n+1} = u_j^n - \\frac{\\Delta t}{\\Delta x} \\left( f_{j+1/2} - f_{j-1/2} \\right)$$\n其中 $f_{j+1/2}$ 是单元 $j$ 和 $j+1$ 之间界面上的数值通量。对于高分辨率 TVD 格式，该通量可以表示为对一阶迎风通量的修正。由于 $a0$，迎风方向来自左侧。使用限制器函数 $\\phi(r)$ 的标准数值通量形式为：\n$$f_{j+1/2} = a u_j + \\frac{a}{2}(1-\\nu) \\phi(r_j) (u_{j+1}-u_j)$$\n其中 $\\nu = a \\Delta t / \\Delta x$ 是 CFL 数，$r_j$ 是连续解梯度的比率，对于迎风格式定义为：\n$$r_j = \\frac{u_j - u_{j-1}}{u_{j+1} - u_j}$$\n项 $\\frac{a}{2}(1-\\nu)(u_{j+1}-u_j)$ 代表二阶 Lax-Wendroff 格式的抗耗散通量，它被 $\\phi(r_j)$ 所限制。\n\n问题首先要求进行修正方程分析，以找到形式方程 $u_t + a\\,u_x = \\beta\\,u_{xx} + \\gamma\\,u_{xxx} + \\dots$ 中的等效扩散 ($\\beta$) 和色散 ($\\gamma$) 系数。此分析要求在两种情况下进行：光滑区域（$r \\approx 1$）和激波核心（$r \\approx 0$）。\n\n然而，对于问题的最后一部分——估计激波厚度 $\\delta$——我们得到了一个特定指令：“假设内部激波层是单调的，且限制器在激波核心处强制一阶行为，通过平衡层内的平流和主导人工扩散来估计激波厚度 $\\delta$。”\n\n这个假设至关重要。一阶行为意味着高阶修正通量项可忽略或为零。对于给定的通量公式，当 $\\phi(r)=0$ 时会发生这种情况。此时格式退化为一阶迎风格式：\n$$f_{j+1/2} = a u_j$$\n有限体积更新变为：\n$$u_j^{n+1} = u_j^n - \\frac{\\Delta t}{\\Delta x} (a u_j - a u_{j-1}) = u_j^n - \\nu (u_j - u_{j-1})$$\n\n我们对一阶迎风格式进行修正方程分析。我们将各项在点 $(x_j, t_n)$ 附近展开为泰勒级数：\n$$\\frac{u_j^{n+1} - u_j^n}{\\Delta t} = u_t + \\frac{\\Delta t}{2}u_{tt} + \\mathcal{O}(\\Delta t^2)$$\n$$-a \\frac{u_j - u_{j-1}}{\\Delta x} = -a \\left( u_x - \\frac{\\Delta x}{2}u_{xx} + \\frac{\\Delta x^2}{6}u_{xxx} + \\mathcal{O}(\\Delta x^3) \\right)$$\n令这些相等并重新整理得到：\n$$u_t + a u_x = -\\frac{\\Delta t}{2}u_{tt} + \\frac{a\\Delta x}{2}u_{xx} - \\frac{a\\Delta x^2}{6}u_{xxx} + \\dots$$\n为了获得空间上的主导误差项，我们通过重复使用原始偏微分方程 $u_t = -a u_x$（得到 $u_{tt} = a^2 u_{xx}$）来消去时间导数 $u_{tt}$。将此代入方程得到：\n$$u_t + a u_x = -\\frac{\\Delta t}{2}(a^2 u_{xx}) + \\frac{a\\Delta x}{2}u_{xx} + \\mathcal{O}(\\Delta x^2)$$\n$$u_t + a u_x = \\left(\\frac{a\\Delta x}{2} - \\frac{a^2\\Delta t}{2}\\right) u_{xx} + \\mathcal{O}(\\Delta x^2)$$\n$u_{xx}$ 项的系数是人工扩散系数 $\\beta$。提出公因式并使用 CFL 数的定义 $\\nu = a \\Delta t / \\Delta x$：\n$$\\beta = \\frac{a\\Delta x}{2} \\left(1 - \\frac{a\\Delta t}{\\Delta x}\\right) = \\frac{a\\Delta x}{2} (1-\\nu)$$\n这是一阶迎风格式众所周知的人工扩散。根据问题的假设，这是激波核心中的主导扩散行为。\n\n下一步是估计激波厚度 $\\delta$。这通过平衡激波层内平流项和主导人工扩散项的量级来完成。设穿过激波的解的总变化为 $\\Delta u$。梯度和曲率可以近似为：\n$$u_x \\sim \\frac{\\Delta u}{\\delta}$$\n$$u_{xx} \\sim \\frac{\\Delta u}{\\delta^2}$$\n修正方程中平流与扩散之间的平衡是：\n$$a u_x \\approx \\beta u_{xx}$$\n$$a \\frac{\\Delta u}{\\delta} \\approx \\beta \\frac{\\Delta u}{\\delta^2}$$\n求解激波厚度 $\\delta$ 得到：\n$$\\delta \\approx \\frac{\\beta}{a}$$\n代入一阶迎风格式的 $\\beta$ 表达式：\n$$\\delta \\approx \\frac{\\frac{a\\Delta x}{2}(1-\\nu)}{a} = \\frac{\\Delta x}{2}(1-\\nu)$$\n问题要求给出三种限制器（minmod、superbee 和 van Leer）各自的激波厚度。给定的限制器是：\n$$\\phi_{\\mathrm{MM}}(r) = \\max\\!\\big(0,\\, \\min(1,\\,r)\\big)$$\n$$\\phi_{\\mathrm{SB}}(r) = \\max\\!\\big(0,\\, \\min(2r,\\,1),\\, \\min(r,\\,2)\\big)$$\n$$\\phi_{\\mathrm{VL}}(r) = \\frac{r + |r|}{1 + |r|}$$\n所有这些限制器都被设计为在陡峭梯度或局部极值处退化到一阶精度以防止振荡，这是成为 TVD 的一个条件。这是通过确保当局部解的剖面不光滑时（例如，对于 $r \\le 0$），$\\phi(r) \\to 0$ 来实现的。问题中使用一阶模型来描述激波核心的假设正是对这种行为的形式化。由于 $\\delta$ 的计算完全基于这个假设，所以结果与具体的限制器函数无关。因此，三种限制器的估计激波厚度是相同的。\n\n最终答案是每个限制器的 $\\delta$ 的解析表达式。由于它们是相同的，我们将列出三次相同的表达式。\n\n最终表达式：\n$$\\delta = \\frac{\\Delta x}{2}(1-\\nu)$$\n\n我们按要求为三种限制器提供此结果。",
            "answer": "$$\\boxed{\\begin{pmatrix} \\frac{\\Delta x}{2}(1-\\nu)  \\frac{\\Delta x}{2}(1-\\nu)  \\frac{\\Delta x}{2}(1-\\nu) \\end{pmatrix}}$$"
        }
    ]
}