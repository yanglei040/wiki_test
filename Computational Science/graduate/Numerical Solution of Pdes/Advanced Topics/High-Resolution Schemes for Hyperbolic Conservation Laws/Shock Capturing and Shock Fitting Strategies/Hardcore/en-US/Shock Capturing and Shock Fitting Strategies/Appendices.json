{
    "hands_on_practices": [
        {
            "introduction": "Before numerically simulating shocks, we must first understand their fundamental mathematical properties. Shocks arise as discontinuous weak solutions to hyperbolic conservation laws, and their behavior is governed by specific physical principles. This foundational exercise guides you through deriving the Rankine-Hugoniot jump condition from the integral form of the conservation law, which determines the speed of a shock, and applying the Lax entropy condition to ensure the solution is physically admissible . Mastering this analysis is crucial, as these are the very conditions that successful shock-capturing and shock-fitting schemes are designed to satisfy.",
            "id": "3442590",
            "problem": "Consider the scalar conservation law (the inviscid Burgers equation) given by $u_{t} + (f(u))_{x} = 0$ with flux $f(u) = \\frac{u^{2}}{2}$. Let the initial data be the Riemann step $u(x,0) = u_{L}$ for $x  0$ and $u(x,0) = u_{R}$ for $x  0$ with the constant states $u_{L} = 2$ and $u_{R} = 0$. Starting from the conservation law in its integral form over a moving control volume that encloses a single propagating discontinuity, derive the jump relation for the physically admissible shock speed $s$ for a piecewise constant weak solution of this Riemann problem. Then evaluate $s$ for the given states, check the Lax entropy condition for convex fluxes in the form $f'(u_{L})  s  f'(u_{R})$ (equivalently $u_{L}  u_{R}$ for Burgers), and write the corresponding piecewise weak solution $u(x,t)$ for $t  0$ with a single shock located at $x = x_{s}(t)$. Explicitly state the shock trajectory $x_{s}(t)$, and verify that your solution satisfies the conservation law in the sense of distributions and the entropy inequality associated with a convex entropy–entropy flux pair. Finally, briefly explain how this shock speed would be used in a shock fitting strategy that tracks the interface $x_{s}(t)$, and contrast this with how a shock capturing scheme would approximate the same solution.\n\nProvide your final numerical answer for the shock speed $s$; no rounding is required and no physical units are involved.",
            "solution": "The inviscid Burgers equation is the scalar conservation law $u_{t} + (f(u))_{x} = 0$ with $f(u) = \\frac{u^{2}}{2}$. Given the Riemann data $u(x,0) = u_{L}$ for $x  0$ and $u(x,0) = u_{R}$ for $x  0$, we seek a weak solution with a single discontinuity moving at speed $s$, located at $x = x_{s}(t)$, separating constant states $u_{L}$ and $u_{R}$.\n\nThe fundamental basis for deriving the shock speed is the integral form of conservation. For a smooth test function $\\varphi(x,t)$ with compact support, the weak formulation reads\n$$\n\\int_{0}^{\\infty} \\int_{-\\infty}^{\\infty} \\left( u \\, \\varphi_{t} + f(u) \\, \\varphi_{x} \\right) \\, \\mathrm{d}x \\, \\mathrm{d}t + \\int_{-\\infty}^{\\infty} u(x,0) \\, \\varphi(x,0) \\, \\mathrm{d}x = 0.\n$$\nAlternatively, consider a small control volume that moves with the shock, enclosing the discontinuity at $x = x_{s}(t)$ with left and right states $u_{L}$ and $u_{R}$. Applying conservation over this moving interface yields the Rankine–Hugoniot (RH) jump condition\n$$\ns \\, [u] = [f(u)],\n$$\nwhere $[u] = u_{R} - u_{L}$ and $[f(u)] = f(u_{R}) - f(u_{L})$. This follows by integrating the conservation law over an interval $(x_{s}(t) - \\epsilon, x_{s}(t) + \\epsilon)$ and letting $\\epsilon \\to 0$, or directly from the weak formulation with a Heaviside-type ansatz for $u(x,t)$.\n\nSolving the RH condition for $s$ gives\n$$\ns = \\frac{f(u_{R}) - f(u_{L})}{u_{R} - u_{L}}.\n$$\nFor Burgers, $f(u) = \\frac{u^{2}}{2}$, so\n$$\nf(u_{L}) = \\frac{(2)^{2}}{2} = 2, \\quad f(u_{R}) = \\frac{(0)^{2}}{2} = 0.\n$$\nTherefore,\n$$\ns = \\frac{0 - 2}{0 - 2} = \\frac{-2}{-2} = 1.\n$$\n\nNext, check the Lax entropy condition for a convex flux. For a scalar conservation law with a convex $f$, the Lax condition for a shock joining $u_{L}$ to $u_{R}$ is\n$$\nf'(u_{L})  s  f'(u_{R}).\n$$\nFor Burgers, $f'(u) = u$, hence\n$$\nf'(u_{L}) = 2, \\quad f'(u_{R}) = 0, \\quad s = 1,\n$$\nand thus\n$$\n2  1  0,\n$$\nwhich holds. Equivalently, for Burgers the admissibility reduces to $u_{L}  u_{R}$ for a shock, which is satisfied since $2  0$. This guarantees characteristics impinge upon the shock from both sides, ensuring entropy admissibility.\n\nThe corresponding piecewise weak solution for $t  0$ is a single shock located at\n$$\nx_{s}(t) = s \\, t = t,\n$$\nwith constant states\n$$\nu(x,t) = \\begin{cases}\n2,  x  x_{s}(t), \\\\\n0,  x  x_{s}(t).\n\\end{cases}\n$$\nAt the interface $x = x_{s}(t)$, $u$ is discontinuous; one may define its trace values from the left and right as $u_{L}$ and $u_{R}$. To verify that this is a weak solution, substitute this piecewise constant form into the weak formulation. Away from the shock, $u$ is constant, so $u_{t} = 0$ and $f(u)_{x} = 0$ hold pointwise. The contribution at the shock reduces to the jump measure concentrated on the interface. The weak balance reduces to the RH condition already derived, which is satisfied by $s = 1$, confirming that the distributional divergence vanishes.\n\nTo check entropy consistency with a convex entropy–entropy flux pair, consider the standard entropy $\\eta(u) = \\frac{1}{2} u^{2}$ and entropy flux $q(u) = \\int \\eta'(u) f'(u) \\, \\mathrm{d}u = \\int u \\cdot u \\, \\mathrm{d}u = \\frac{1}{3} u^{3}$. For a shock moving at speed $s$, the entropy inequality requires\n$$\ns \\, [\\eta(u)] \\geq [q(u)],\n$$\nwhere $[\\eta(u)] = \\eta(u_{R}) - \\eta(u_{L})$ and $[q(u)] = q(u_{R}) - q(u_{L})$. Compute\n$$\n\\eta(u_{L}) = \\frac{1}{2} (2)^{2} = 2, \\quad \\eta(u_{R}) = \\frac{1}{2} (0)^{2} = 0, \\quad [\\eta(u)] = 0 - 2 = -2,\n$$\nand\n$$\nq(u_{L}) = \\frac{1}{3} (2)^{3} = \\frac{8}{3}, \\quad q(u_{R}) = \\frac{1}{3} (0)^{3} = 0, \\quad [q(u)] = 0 - \\frac{8}{3} = -\\frac{8}{3}.\n$$\nThen $s \\, [\\eta(u)] = 1 \\cdot (-2) = -2$ and $[q(u)] = -\\frac{8}{3}$. The condition to check is $-2 \\geq -\\frac{8}{3}$, which is true. Thus the entropy inequality is satisfied.\n\nRegarding numerical strategies, a shock fitting scheme would explicitly track the interface $x_{s}(t)$ as a moving boundary in the computational mesh. The shock speed $s = 1$ determines the ordinary differential equation for the shock trajectory,\n$$\n\\frac{\\mathrm{d} x_{s}}{\\mathrm{d} t} = s = 1,\n$$\nwith $x_{s}(0) = 0$, yielding $x_{s}(t) = t$. The mesh or interface conditions are updated accordingly to maintain the correct jump conditions across the shock. In contrast, a shock capturing scheme (such as a finite volume method with monotone numerical fluxes or Total Variation Diminishing (TVD) limiters, or an artificial viscosity method) does not explicitly track the interface; instead, it relies on discretization mechanisms to stabilize and approximate the discontinuity, smearing the shock over a few grid cells while maintaining the correct RH speed and entropy admissibility in the discrete sense.\n\nTherefore, the required shock speed is $s = 1$, the Lax entropy condition is satisfied, and the piecewise weak solution is the left state $u = 2$ for $x  t$ and the right state $u = 0$ for $x  t$, with a shock located at $x_{s}(t) = t$.",
            "answer": "$$\\boxed{1}$$"
        },
        {
            "introduction": "With the theoretical underpinnings of shocks established, we can now construct our first numerical method to \"capture\" them on a fixed grid. The Godunov scheme is the archetypal shock-capturing finite volume method, providing a robust, albeit first-order, approximation. Its core idea is to solve an exact Riemann problem at each cell interface at every time step to determine the intercell flux. This exercise on the inviscid Burgers' equation is a classic for a reason: it provides direct, hands-on experience with the fundamental mechanics of a Godunov-type scheme, from solving the local Riemann problem to updating the cell averages via the conservative formula .",
            "id": "3442603",
            "problem": "Consider the scalar conservation law, the inviscid Burgers’ equation, given by $u_{t}+f(u)_{x}=0$ with flux $f(u)=\\frac{1}{2}u^{2}$. A first-order Godunov finite volume scheme (shock-capturing) evolves cell averages by solving Riemann problems at cell interfaces and using the exact interfacial fluxes from those self-similar solutions. Let the spatial grid consist of $2$ cells on a periodic interval of length $2\\Delta x$, with cell interfaces at $x=-\\Delta x$, $x=0$, and $x=\\Delta x$. The cell averages at time $t^{n}$ are $\\bar{u}_{0}^{n}=1$ on the left cell $[-\\Delta x,0]$ and $\\bar{u}_{1}^{n}=-1$ on the right cell $[0,\\Delta x]$. Using the Godunov flux derived from the exact Riemann problem for Burgers’ equation and the finite volume update based on conservation, compute the updated left cell average $\\bar{u}_{0}^{n+1}$ after one time step $\\Delta t$, expressed solely in terms of $\\Delta t$ and $\\Delta x$. Your final answer must be a single closed-form analytic expression. Do not include any units. Do not round.",
            "solution": "The first-order finite volume update for the cell average $\\bar{u}_i$ in a cell of width $\\Delta x$ is given by the conservation law integrated over the cell $[x_{i-1/2}, x_{i+1/2}]$ and from time $t^n$ to $t^{n+1}=t^n+\\Delta t$:\n$$ \\bar{u}_{i}^{n+1} = \\bar{u}_{i}^{n} - \\frac{\\Delta t}{\\Delta x} \\left( F_{i+1/2} - F_{i-1/2} \\right) $$\nHere, $F_{i+1/2}$ and $F_{i-1/2}$ are the numerical fluxes at the cell interfaces $x_{i+1/2}$ and $x_{i-1/2}$, respectively.\n\nWe need to compute the updated average for the left cell, cell $0$. The formula for $\\bar{u}_{0}^{n+1}$ is:\n$$ \\bar{u}_{0}^{n+1} = \\bar{u}_{0}^{n} - \\frac{\\Delta t}{\\Delta x} \\left( F_{1/2} - F_{-1/2} \\right) $$\nwhere $F_{1/2}$ is the flux at the interface $x=0$ and $F_{-1/2}$ is the flux at the interface $x=-\\Delta x$. In the Godunov scheme, the numerical flux $F_{i+1/2}$ is determined by solving the Riemann problem at the interface $x_{i+1/2}$ with left state $u_L = \\bar{u}_i^n$ and right state $u_R = \\bar{u}_{i+1}^n$. The flux is then $F_{i+1/2} = f(u_{RP}(0))$, where $u_{RP}(x/t)$ is the self-similar solution to this local Riemann problem, evaluated at $x/t = 0$.\n\n**1. Calculation of the flux $F_{1/2}$ at the interface $x = 0$**\nThis interface is between cell $0$ and cell $1$. The Riemann problem at $x=0$ has:\n- Left state: $u_L = \\bar{u}_{0}^{n} = 1$\n- Right state: $u_R = \\bar{u}_{1}^{n} = -1$\n\nThe characteristic speeds are $f'(u) = u$. Thus, $f'(u_L) = 1$ and $f'(u_R) = -1$.\nSince $f'(u_L)  f'(u_R)$, the solution to this Riemann problem is a shock wave. The speed of this shock, $s$, is given by the Rankine-Hugoniot condition:\n$$ s = \\frac{f(u_R) - f(u_L)}{u_R - u_L} = \\frac{\\frac{1}{2}(-1)^2 - \\frac{1}{2}(1)^2}{-1 - 1} = \\frac{\\frac{1}{2} - \\frac{1}{2}}{-2} = 0 $$\nThe shock is stationary and located at the interface $x=0$. The self-similar solution is $u(x/t) = u_L = 1$ for $x/t  s = 0$ and $u(x/t) = u_R = -1$ for $x/t  s = 0$.\nThe Godunov flux is the physical flux evaluated at the state corresponding to the $x/t=0$ line. Since the shock is stationary at $x/t=0$, the flux is continuous across the shock. We can evaluate it using either the left or right state:\n$f(u_L) = f(1) = \\frac{1}{2}(1)^2 = \\frac{1}{2}$\n$f(u_R) = f(-1) = \\frac{1}{2}(-1)^2 = \\frac{1}{2}$\nTherefore, the Godunov flux at this interface is:\n$$ F_{1/2} = \\frac{1}{2} $$\n\n**2. Calculation of the flux $F_{-1/2}$ at the interface $x = -\\Delta x$**\nThis interface is between cell $0$ and its left neighbor. Due to the periodic boundary conditions, the left neighbor of cell $0$ is cell $1$. The Riemann problem at $x=-\\Delta x$ has:\n- Left state: $u_L = \\bar{u}_{1}^{n} = -1$\n- Right state: $u_R = \\bar{u}_{0}^{n} = 1$\n\nThe characteristic speeds are $f'(u_L) = -1$ and $f'(u_R) = 1$.\nSince $f'(u_L)  f'(u_R)$, the solution to this Riemann problem is a rarefaction wave. The wave fans out between the speeds $f'(u_L)=-1$ and $f'(u_R)=1$.\nThe self-similar solution $u(x/t)$ is given by:\n$$ u(x/t) = \\begin{cases} -1  \\text{for } x/t  -1 \\\\ x/t  \\text{for } -1 \\leq x/t \\leq 1 \\\\ 1  \\text{for } x/t  1 \\end{cases} $$\nThe Godunov flux is the physical flux evaluated at the state corresponding to the $x/t=0$ line of the self-similar solution. For $x/t=0$, we are inside the rarefaction fan, and the state is $u=0$.\nThe flux is then:\n$$ F_{-1/2} = f(u=0) = \\frac{1}{2}(0)^2 = 0 $$\n\n**3. Update of the cell average $\\bar{u}_{0}^{n+1}$**\nNow we substitute the initial condition and the calculated fluxes into the finite volume update formula for cell $0$:\n$$ \\bar{u}_{0}^{n+1} = \\bar{u}_{0}^{n} - \\frac{\\Delta t}{\\Delta x} \\left( F_{1/2} - F_{-1/2} \\right) $$\nSubstituting the values $\\bar{u}_{0}^{n} = 1$, $F_{1/2} = \\frac{1}{2}$, and $F_{-1/2} = 0$:\n$$ \\bar{u}_{0}^{n+1} = 1 - \\frac{\\Delta t}{\\Delta x} \\left( \\frac{1}{2} - 0 \\right) $$\n$$ \\bar{u}_{0}^{n+1} = 1 - \\frac{\\Delta t}{2 \\Delta x} $$\nThis is the final expression for the updated cell average of the left cell.",
            "answer": "$$\n\\boxed{1 - \\frac{\\Delta t}{2 \\Delta x}}\n$$"
        },
        {
            "introduction": "First-order schemes like the Godunov method are highly dissipative, smearing sharp features across several grid cells. To achieve higher accuracy, we can reconstruct the solution within each cell using, for example, a piecewise linear function. However, this introduces the risk of creating spurious oscillations near discontinuities. This problem introduces the concept of slope limiting, a cornerstone of high-resolution Total Variation Diminishing (TVD) schemes . By applying the `minmod` limiter, you will see how to intelligently control the reconstructed slopes to maintain sharp, non-oscillatory shock profiles, a critical technique for balancing accuracy and stability in modern shock-capturing methods.",
            "id": "3442604",
            "problem": "Consider a scalar conservation law of the form $u_t + f(u)_x = 0$ and a uniform mesh with spacing $\\Delta x = 1$. In a shock-capturing finite volume method with Godunov-type numerical fluxes, second-order spatial accuracy is obtained by a piecewise linear reconstruction within each cell. To prevent spurious oscillations near discontinuities and sharp gradients, the linear slope is limited by a monotone limiter consistent with the Total Variation Diminishing (TVD) principle. Assume that the limited slope in cell $i$ is obtained by applying the minmod limiter to the one-sided differences in that cell, and that the reconstructed interface states used by the numerical flux are the values of the linear reconstruction in cell $i$ evaluated at the left and right interfaces $x_{i-\\frac{1}{2}}$ and $x_{i+\\frac{1}{2}}$. For the data $u_{i-1} = 0$, $u_i = 1$, and $u_{i+1} = 3$, compute the limited slope $s_i$ and the reconstructed interface values $u_{i+\\frac{1}{2}}^{-}$ (the state at $x_{i+\\frac{1}{2}}$ reconstructed from cell $i$) and $u_{i-\\frac{1}{2}}^{+}$ (the state at $x_{i-\\frac{1}{2}}$ reconstructed from cell $i$). Express the final result as a single row vector $\\big(s_i,\\;u_{i+\\frac{1}{2}}^{-},\\;u_{i-\\frac{1}{2}}^{+}\\big)$ with exact values (no rounding).",
            "solution": "The core of the problem lies in constructing a piecewise linear approximation of the solution $u$ within each cell $i$, centered at $x_i$, of the form:\n$$\nu_i(x) = u_i + s_i \\frac{(x-x_i)}{\\Delta x}\n$$\nHere, $u_i$ is the cell-average value in cell $i$, and $s_i$ is the slope of the linear function within that cell. This slope must be limited to prevent spurious oscillations near discontinuities, ensuring the scheme is Total Variation Diminishing (TVD). The problem specifies the use of the `minmod` limiter.\n\nFirst, we define the potential slopes based on the one-sided differences of the cell-average values. The backward difference, representing the slope from cell $i-1$ to cell $i$, is:\n$$\n\\Delta u_i^{-} = u_i - u_{i-1}\n$$\nThe forward difference, representing the slope from cell $i$ to cell $i+1$, is:\n$$\n\\Delta u_i^{+} = u_{i+1} - u_i\n$$\nThe problem states that the mesh spacing is uniform with $\\Delta x = 1$. Per convention, the slopes are often normalized by $\\Delta x$, but since $\\Delta x = 1$, the differences in cell averages are numerically equal to the slopes.\n\nUsing the given data, $u_{i-1} = 0$, $u_i = 1$, and $u_{i+1} = 3$, we compute these differences:\n$$\n\\Delta u_i^{-} = 1 - 0 = 1\n$$\n$$\n\\Delta u_i^{+} = 3 - 1 = 2\n$$\nThe `minmod` limiter is applied to these two values to determine the limited slope $s_i$. The `minmod` function is defined as:\n$$\n\\text{minmod}(a, b) =\n\\begin{cases}\n    \\min(a, b)  \\text{if } a  0, b  0 \\\\\n    \\max(a, b)  \\text{if } a  0, b  0 \\\\\n    0  \\text{if } ab \\le 0\n\\end{cases}\n$$\nThis function selects the slope with the smallest magnitude if both slopes have the same sign, and returns $0$ if they have opposite signs. This prevents the reconstruction from creating new local extrema.\n\nApplying the `minmod` function to our calculated differences:\n$$\ns_i = \\text{minmod}(\\Delta u_i^{-}, \\Delta u_i^{+}) = \\text{minmod}(1, 2)\n$$\nSince both arguments are positive, we take the minimum of the two values:\n$$\ns_i = \\min(1, 2) = 1\n$$\nThus, the limited slope in cell $i$ is $s_i = 1$.\n\nNext, we compute the reconstructed values at the cell interfaces. The right interface of cell $i$ is located at $x_{i+\\frac{1}{2}} = x_i + \\frac{\\Delta x}{2}$, and the left interface is at $x_{i-\\frac{1}{2}} = x_i - \\frac{\\Delta x}{2}$.\n\nThe value at the right interface, reconstructed from within cell $i$, is denoted $u_{i+\\frac{1}{2}}^{-}$. We obtain it by evaluating the reconstruction $u_i(x)$ at $x = x_{i+\\frac{1}{2}}$:\n$$\nu_{i+\\frac{1}{2}}^{-} = u_i(x_{i+\\frac{1}{2}}) = u_i + s_i \\frac{(x_i + \\frac{\\Delta x}{2}) - x_i}{\\Delta x} = u_i + s_i \\frac{\\frac{\\Delta x}{2}}{\\Delta x} = u_i + \\frac{1}{2}s_i\n$$\nSubstituting the known values $u_i = 1$, $s_i = 1$:\n$$\nu_{i+\\frac{1}{2}}^{-} = 1 + \\frac{1}{2}(1) = 1.5 = \\frac{3}{2}\n$$\nThe value at the left interface, reconstructed from within cell $i$, is denoted $u_{i-\\frac{1}{2}}^{+}$. We obtain it by evaluating $u_i(x)$ at $x = x_{i-\\frac{1}{2}}$:\n$$\nu_{i-\\frac{1}{2}}^{+} = u_i(x_{i-\\frac{1}{2}}) = u_i + s_i \\frac{(x_i - \\frac{\\Delta x}{2}) - x_i}{\\Delta x} = u_i + s_i \\frac{-\\frac{\\Delta x}{2}}{\\Delta x} = u_i - \\frac{1}{2}s_i\n$$\nSubstituting the known values $u_i = 1$, $s_i = 1$:\n$$\nu_{i-\\frac{1}{2}}^{+} = 1 - \\frac{1}{2}(1) = 0.5 = \\frac{1}{2}\n$$\nThe computed values are $s_i = 1$, $u_{i+\\frac{1}{2}}^{-} = \\frac{3}{2}$, and $u_{i-\\frac{1}{2}}^{+} = \\frac{1}{2}$. The problem requests these as a single row vector.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1  \\frac{3}{2}  \\frac{1}{2}\n\\end{pmatrix}\n}\n$$"
        }
    ]
}