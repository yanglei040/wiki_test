{
    "hands_on_practices": [
        {
            "introduction": "A fundamental step in understanding numerical dissipation is to see how it arises from the discretization process itself. Simple schemes, like the first-order upwind method, do not explicitly add a viscosity term, yet they behave as if one is present. This exercise uses the powerful technique of modified equation analysis to reveal the \"hidden\" dissipative term, demonstrating that the numerical scheme effectively solves a viscous version of the original partial differential equation . By completing this analysis, you will gain a concrete understanding of how a scheme's truncation error manifests as a physical effect, in this case, a smeared shock profile whose thickness you can predict.",
            "id": "3364595",
            "problem": "Consider the dimensionless inviscid Burgers equation $u_{t} + \\left(\\frac{1}{2} u^{2}\\right)_{x} = 0$ on the real line with Riemann initial data $u(x,0) = u_{L}$ for $x<0$ and $u(x,0)=u_{R}$ for $x>0$, where $u_{L} > u_{R} > 0$. The solution contains an entropy-satisfying shock with Rankine–Hugoniot speed $s$. The equation is discretized on a uniform mesh with spacing $\\Delta x$ using a first-order upwind (donor-cell) conservative scheme, and a forward Euler time step with $\\Delta t$ is chosen to satisfy a Courant–Friedrichs–Lewy (CFL) number $C$ based on the maximum characteristic speed, namely $C = \\max_{x} |u(x,t)| \\, \\Delta t / \\Delta x$. \n\nAssume the following numerical parameters and states: $u_{L} = 2$, $u_{R} = 1$, $\\Delta x = 0.005$, and $C = 0.8$. Using a leading-order modified-equation analysis that linearizes the scheme locally about the constant state at the shock center, and then matching to the steady traveling-wave reduction of the viscous Burgers equation $u_{t} + u u_{x} = \\nu u_{xx}$, estimate the intrinsic shock thickness $\\delta$ induced purely by the scheme’s numerical dissipation. Define $\\delta$ as the characteristic length scale obtained from the traveling-wave profile in the shock-attached frame, i.e., the inverse of the coefficient multiplying the similarity variable in the hyperbolic tangent profile. State any intermediate symbols you introduce, keep them in symbolic form until the final numerical evaluation, and assume the time step $\\Delta t$ is set by $C$ using the maximum characteristic speed $u_{L}$. \n\nCompute the final numerical value of $\\delta$ and round your answer to four significant figures. Express the final value as a pure number (dimensionless).",
            "solution": "We begin from the conservative inviscid Burgers equation $u_{t} + f(u)_{x} = 0$ with $f(u) = \\frac{1}{2} u^{2}$. The first-order upwind (donor-cell) scheme on a uniform mesh $\\{x_{i}\\}$ with spacing $\\Delta x$ and time step $\\Delta t$ may be written, in regions where the characteristic speed $f'(u)$ is positive, as\n$$\nu_{i}^{n+1} = u_{i}^{n} - \\lambda \\left(f(u_{i}^{n}) - f(u_{i-1}^{n})\\right), \\quad \\lambda := \\frac{\\Delta t}{\\Delta x}.\n$$\nWe analyze the modified equation by Taylor expanding the scheme about a locally constant state $u_{0}$ and retaining leading terms in $\\Delta x$. The key foundational steps are:\n- Linearize the flux about $u_{0}$: $f(u) \\approx f(u_{0}) + f'(u_{0}) (u - u_{0})$.\n- In this local linearization, the scheme reduces to the upwind scheme for linear advection $v_{t} + a v_{x} = 0$ with $a = f'(u_{0})$.\n- The classical modified equation for the first-order upwind scheme applied to $v_{t} + a v_{x} = 0$ is (from Taylor expansion in space and time about a smooth solution)\n$$\nv_{t} + a v_{x} = \\frac{a \\, \\Delta x}{2} \\left(1 - a \\lambda \\right) v_{xx} + \\mathcal{O}(\\Delta x^{2}).\n$$\nReturning to the nonlinear problem, this identifies the leading-order numerical viscosity coefficient, when evaluated at a locally constant state $u_{0}$ with $a = f'(u_{0}) = u_{0}$, as\n$$\n\\nu_{\\text{num}}(u_{0}) = \\frac{1}{2} \\, a \\, \\Delta x \\, \\left(1 - a \\lambda\\right) = \\frac{1}{2} \\, u_{0} \\, \\Delta x \\, \\left(1 - u_{0} \\lambda\\right).\n$$\n\nNext, to estimate the shock thickness induced by this numerical viscosity, we match to the viscous Burgers equation\n$$\nu_{t} + u \\, u_{x} = \\nu \\, u_{xx},\n$$\nwhere we set $\\nu = \\nu_{\\text{num}}$ evaluated at the shock center. The traveling-wave reduction in the frame moving with the shock speed $s$ uses the similarity variable $\\xi = x - s t$, giving a steady profile $u(\\xi)$ satisfying\n$$\n- s \\, \\frac{d u}{d \\xi} + u \\, \\frac{d u}{d \\xi} = \\nu \\, \\frac{d^{2} u}{d \\xi^{2}} \\quad \\Rightarrow \\quad \\nu \\, \\frac{d^{2} u}{d \\xi^{2}} = \\left(u - s\\right) \\frac{d u}{d \\xi}.\n$$\nAssuming a monotone connection between the endstates $u_{L}$ and $u_{R}$, integrate once using the chain rule $\\frac{d^{2} u}{d \\xi^{2}} = \\frac{d}{d \\xi}\\left(\\frac{d u}{d \\xi}\\right) = \\frac{d}{d u}\\left(\\frac{d u}{d \\xi}\\right) \\frac{d u}{d \\xi}$ to obtain\n$$\n\\nu \\, \\frac{d}{d u}\\left(\\frac{d u}{d \\xi}\\right) = u - s.\n$$\nIntegrating in $u$ and determining the constant of integration using the far-field conditions $u'(\\xi) \\to \\pm \\infty$ as $\\xi \\to \\pm \\infty$, one finds the standard first integral\n$$\n\\nu \\, \\frac{d u}{d \\xi} = \\frac{1}{2} \\left(u - u_{L}\\right) \\left(u - u_{R}\\right),\n$$\nwith the Rankine–Hugoniot speed $s = \\frac{f(u_{L}) - f(u_{R})}{u_{L} - u_{R}} = \\frac{u_{L} + u_{R}}{2}$. Separation of variables shows that the profile is a hyperbolic tangent,\n$$\nu(\\xi) = s - \\frac{\\Delta u}{2} \\, \\tanh\\!\\left( \\frac{\\Delta u}{4 \\nu} \\left(\\xi - \\xi_{0}\\right)\\right), \\quad \\Delta u := u_{L} - u_{R},\n$$\nso the coefficient multiplying $\\xi$ in the $\\tanh$ argument is $K = \\frac{\\Delta u}{4 \\nu}$. By the stated definition, the intrinsic shock thickness is the inverse of this coefficient,\n$$\n\\delta := \\frac{1}{K} = \\frac{4 \\nu}{\\Delta u}.\n$$\n\nWe now specialize this to the numerical viscosity at the shock center. The symmetry of the traveling wave implies that the shock-center state equals the Rankine–Hugoniot speed for Burgers, that is,\n$$\nu_{0} = s = \\frac{u_{L} + u_{R}}{2}.\n$$\nThe time step is chosen by the Courant–Friedrichs–Lewy (CFL) condition based on the maximum characteristic speed $u_{L}$:\n$$\nC = \\max |u| \\, \\frac{\\Delta t}{\\Delta x} = u_{L} \\, \\frac{\\Delta t}{\\Delta x} \\quad \\Rightarrow \\quad \\lambda = \\frac{\\Delta t}{\\Delta x} = \\frac{C}{u_{L}}.\n$$\nTherefore,\n$$\n\\nu_{\\text{num}}(u_{0}) = \\frac{1}{2} \\, u_{0} \\, \\Delta x \\, \\left(1 - u_{0} \\lambda \\right) \n= \\frac{1}{2} \\, s \\, \\Delta x \\left(1 - s \\, \\frac{C}{u_{L}}\\right).\n$$\nThe intrinsic thickness estimate is thus\n$$\n\\delta = \\frac{4 \\, \\nu_{\\text{num}}(u_{0})}{\\Delta u} \n= \\frac{4}{\\Delta u} \\cdot \\frac{1}{2} \\, s \\, \\Delta x \\left(1 - s \\, \\frac{C}{u_{L}}\\right)\n= \\frac{2 s \\, \\Delta x}{\\Delta u} \\left(1 - \\frac{s C}{u_{L}}\\right).\n$$\n\nInsert the given values $u_{L} = 2$, $u_{R} = 1$, $\\Delta x = 0.005$, and $C = 0.8$:\n- $\\Delta u = u_{L} - u_{R} = 2 - 1 = 1$,\n- $s = \\frac{u_{L} + u_{R}}{2} = \\frac{2 + 1}{2} = \\frac{3}{2} = 1.5$,\n- $\\lambda = \\frac{C}{u_{L}} = \\frac{0.8}{2} = 0.4$,\n- $s \\lambda = 1.5 \\times 0.4 = 0.6$,\n- $\\nu_{\\text{num}} = \\frac{1}{2} \\times 1.5 \\times 0.005 \\times (1 - 0.6) = 0.75 \\times 0.005 \\times 0.4 = 0.00375 \\times 0.4 = 0.0015$,\n- $\\delta = \\frac{4 \\times 0.0015}{1} = 0.006$.\n\nRounding to four significant figures, we obtain $\\delta = 0.006000$, which we report in scientific notation as $6.000 \\times 10^{-3}$.",
            "answer": "$$\\boxed{6.000 \\times 10^{-3}}$$"
        },
        {
            "introduction": "While first-order schemes are overly dissipative, modern high-resolution methods like the Monotonic Upstream-centered Scheme for Conservation Laws (MUSCL) offer a more sophisticated approach. In these schemes, numerical dissipation is not an unavoidable flaw but a carefully controlled feature, managed by components known as slope limiters. This hands-on coding exercise  allows you to directly measure and compare the dissipative properties of several widely-used limiters, such as minmod, Superbee, and MC. By observing how each limiter affects the amplitude of a sine wave, you will develop a practical intuition for the crucial trade-off between maintaining sharp gradients (low dissipation) and preventing spurious oscillations (requiring sufficient dissipation).",
            "id": "3364647",
            "problem": "Consider the linear advection equation $\\partial_t u + a \\,\\partial_x u = 0$ with constant velocity $a>0$ on a periodic domain of length $L$, discretized by a uniform grid of $N$ points. Let $\\Delta x = L/N$ and choose a time step $\\Delta t$ so that the Courant–Friedrichs–Lewy (CFL) number $\\nu = a \\Delta t / \\Delta x$ is fixed. Consider a cell-centered finite volume update built from a piecewise linear reconstruction with slope limiters and a Monotonic Upstream-centered Scheme for Conservation Laws (MUSCL) predictor step. The discrete update is obtained by the following principle-based steps:\n\n1. Conservation law in integral form and finite volume update: For cell averages $u_i^n$ representing the average over the $i$-th cell at time $t^n$, enforce conservation with upwind numerical flux. For $a>0$, the upwind flux uses the left state at each interface.\n\n2. Slope-limited piecewise linear reconstruction: For each cell $i$, define backward and forward differences $\\Delta_- u_i = u_i^n - u_{i-1}^n$ and $\\Delta_+ u_i = u_{i+1}^n - u_i^n$ with periodic indexing. A slope $s_i$ is computed via one of the following slope limiters:\n   - Minmod limiter: $s_i = \\operatorname{minmod}(\\Delta_- u_i, \\Delta_+ u_i)$, where $\\operatorname{minmod}(x,y) = 0$ if $xy \\le 0$, and $\\operatorname{minmod}(x,y) = \\operatorname{sign}(x)\\,\\min(|x|,|y|)$ otherwise.\n   - Superbee limiter: $s_i = \\operatorname{maxmod}\\!\\left(\\operatorname{minmod}(2\\Delta_- u_i,\\Delta_+ u_i), \\operatorname{minmod}(\\Delta_- u_i,2\\Delta_+ u_i)\\right)$, where $\\operatorname{maxmod}(x,y) = 0$ if $xy \\le 0$, and $\\operatorname{maxmod}(x,y)=\\operatorname{sign}(x)\\,\\max(|x|,|y|)$ otherwise.\n   - Monotonized Central (MC) limiter: $s_i = \\operatorname{minmod}\\!\\left(\\tfrac{1}{2}(\\Delta_- u_i + \\Delta_+ u_i), 2\\Delta_- u_i, 2\\Delta_+ u_i\\right)$, where the three-argument $\\operatorname{minmod}$ returns $0$ if the arguments do not share the same sign, and otherwise returns $\\operatorname{sign}(x)\\,\\min(|x|,|y|,|z|)$ for arguments $x,y,z$.\n\n3. MUSCL predictor to half time level and upwind flux: Define the predicted left state at the interface $x_{i+1/2}$ by advecting the reconstructed data by half a time step for linear advection, yielding $u_{i+1/2}^{L,*} = u_i^n + \\left(\\tfrac{1}{2} - \\tfrac{\\nu}{2}\\right) s_i$. For $a>0$, the numerical flux at $x_{i+1/2}$ is $F_{i+1/2} = a\\, u_{i+1/2}^{L,*}$.\n\n4. Conservative update: The finite volume update over one full time step is\n$$\nu_i^{n+1} = u_i^n - \\nu \\left(u_{i+1/2}^{L,*} - u_{i-1/2}^{L,*}\\right),\n$$\nwith periodic indexing for the interfaces.\n\nLet the initial data be a single discrete Fourier mode $u_j^0 = \\sin(k x_j)$ with $x_j = j \\,\\Delta x$ for $j=0,1,\\dots,N-1$ and wavenumber $k = \\tfrac{2\\pi m}{L}$ where $m$ is an integer in $\\{1,2,\\dots,\\tfrac{N}{2}-1\\}$. Denote by $\\widehat{u}^n(m)$ the discrete Fourier transform coefficient at index $m$ of the grid function $\\{u_j^n\\}_{j=0}^{N-1}$. Define the per-step amplitude attenuation factor for mode $m$ as\n$$\n\\alpha = \\frac{\\left|\\widehat{u}^{\\,n+1}(m)\\right|}{\\left|\\widehat{u}^{\\,n}(m)\\right|}.\n$$\nBecause the exact solution preserves amplitude, any deviation from $\\alpha = 1$ reflects numerical dissipation introduced by the limiter and discretization.\n\nTask: Write a complete program that, for the described discretization, constructs the initial condition $u_j^0 = \\sin\\!\\left(\\tfrac{2\\pi m}{N} j\\right)$ on a periodic grid, applies exactly one time step of the MUSCL scheme using each of the three limiters (minmod, Superbee, and Monotonized Central), and computes the single-step attenuation factor $\\alpha$ for the mode $m$ using the ratio of magnitudes of the discrete Fourier transform coefficients at index $m$ before and after the step.\n\nUse the following fixed parameters and test suite:\n- Domain length $L = 2\\pi$.\n- Advection speed $a = 1$.\n- Grid size $N = 256$.\n- Mode indices $m \\in \\{1, 16, 64, 127\\}$.\n- Courant numbers $\\nu \\in \\{0.2, 0.5, 0.9\\}$.\n- Limiters in the order: minmod, Superbee, Monotonized Central.\n\nFor each pair $(m,\\nu)$ and each limiter in the given order, compute the attenuation factor $\\alpha$ after a single time step, using periodic boundary conditions and the scheme described above. The final output must aggregate all results into a single line as a comma-separated list enclosed in square brackets. The results must be ordered by increasing $m$, then increasing $\\nu$, and, within each $(m,\\nu)$ pair, by the limiter order [minmod, Superbee, Monotonized Central]. No physical units are required for the outputs. Angles are in radians by construction.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, $[r_1,r_2,\\dots,r_K]$), where each $r_k$ is a floating-point attenuation factor $\\alpha$ corresponding to one of the specified $(m,\\nu)$ and limiter combinations, flattened in the specified order. The outputs must be numerical values in decimal form.",
            "solution": "The problem requires an analysis of the numerical dissipation of a second-order Monotonic Upstream-centered Scheme for Conservation Laws (MUSCL) finite volume method applied to the linear advection equation. The dissipation is quantified by measuring the amplitude attenuation of a single Fourier mode after one time step. The problem is well-posed, scientifically sound, and provides all necessary information for a unique solution.\n\nWe begin by formalizing the numerical scheme and the analysis procedure.\n\nThe governing partial differential equation (PDE) is the linear advection equation:\n$$\n\\partial_t u + a \\,\\partial_x u = 0\n$$\nwhere $u(x,t)$ is the conserved quantity and $a > 0$ is the constant advection speed. The spatial domain is periodic with length $L$. The domain is discretized into $N$ uniform cells, with cell width $\\Delta x = L/N$. The cell-averaged value in cell $i$ at time $t^n$ is denoted by $u_i^n$. The time step $\\Delta t$ is coupled to the spatial step via the Courant–Friedrichs–Lewy (CFL) number, $\\nu = a \\Delta t / \\Delta x$.\n\nThe finite volume method updates the cell average based on the conservation law in integral form:\n$$\nu_i^{n+1} = u_i^n - \\frac{\\Delta t}{\\Delta x} \\left( F_{i+1/2} - F_{i-1/2} \\right)\n$$\nwhere $F_{i+1/2}$ is the numerical flux at the interface between cell $i$ and cell $i+1$. Since $a > 0$, we use an upwind flux, where the flux is a function of the state to the left of the interface, denoted $u_{i+1/2}^{L,*}$. For linear advection, the physical flux is $F(u)=au$, so the numerical flux is $F_{i+1/2} = a u_{i+1/2}^{L,*}$. Substituting this and the definition of $\\nu$ into the update equation yields:\n$$\nu_i^{n+1} = u_i^n - \\nu \\left( u_{i+1/2}^{L,*} - u_{i-1/2}^{L,*} \\right)\n$$\nThe core of the MUSCL scheme lies in the computation of the time-evolved interface states $u_{i+1/2}^{L,*}$. This is a two-step process:\n\n1.  **Piecewise Linear Reconstruction with Slope Limiting:**\n    Within each cell $i$, the data is reconstructed as a linear function $u_i(x) = u_i^n + \\frac{s_i}{\\Delta x}(x - x_i)$, where $x_i$ is the center of cell $i$. The term $s_i$ is a limited version of the cell-to-cell difference, which approximates the slope scaled by $\\Delta x$. It is computed from the backward difference $\\Delta_- u_i = u_i^n - u_{i-1}^n$ and the forward difference $\\Delta_+ u_i = u_{i+1}^n - u_i^n$ using a slope limiter function. The problem specifies three such limiters:\n    -   **Minmod:** $s_i = \\operatorname{minmod}(\\Delta_- u_i, \\Delta_+ u_i)$\n    -   **Superbee:** $s_i = \\operatorname{maxmod}\\!\\left(\\operatorname{minmod}(2\\Delta_- u_i,\\Delta_+ u_i), \\operatorname{minmod}(\\Delta_- u_i,2\\Delta_+ u_i)\\right)$\n    -   **Monotonized Central (MC):** $s_i = \\operatorname{minmod}\\!\\left(\\tfrac{1}{2}(\\Delta_- u_i + \\Delta_+ u_i), 2\\Delta_- u_i, 2\\Delta_+ u_i\\right)$\n    The limiter functions $\\operatorname{minmod}$ and $\\operatorname{maxmod}$ are defined to return zero if their arguments have opposite signs, thus preventing the introduction of new extrema (the Total Variation Diminishing property). Periodic boundary conditions are applied when computing differences at the domain boundaries (i.e., for $i=0$ and $i=N-1$).\n\n2.  **Predictor Step (Evolution to Half Time-Step):**\n    The reconstructed data is evolved by half a time step, $\\Delta t/2$. For linear advection, this corresponds to following the characteristic line back in time. The predicted value at the interface $x_{i+1/2}$ from the left side (cell $i$) is evaluated at position $x_{i+1/2} - a \\Delta t/2$ at time $t^n$. This position is at a distance $(\\Delta x/2 - a \\Delta t/2)$ from the cell center $x_i$. Substituting this into the reconstruction formula gives:\n    $$\n    u_{i+1/2}^{L,*} = u_i^n + \\frac{s_i}{\\Delta x}\\left(\\frac{\\Delta x}{2} - \\frac{a \\Delta t}{2}\\right) = u_i^n + s_i \\left(\\frac{1}{2} - \\frac{a \\Delta t}{2 \\Delta x}\\right) = u_i^n + \\left(\\frac{1 - \\nu}{2}\\right) s_i\n    $$\n    This matches the formula given in the problem statement. This value $u_{i+1/2}^{L,*}$ is then used in the conservative update formula to calculate $u_i^{n+1}$.\n\nThe analysis of numerical dissipation proceeds as follows. The exact solution to the advection equation for an initial condition $u(x,0) = \\sin(kx)$ is $u(x,t) = \\sin(k(x-at))$. The amplitude of the wave remains constant. Any reduction in amplitude from a numerical scheme is therefore an artifact known as numerical dissipation.\n\nWe initialize the grid with values from a single Fourier mode:\n$$\nu_j^0 = \\sin(k x_j) = \\sin\\left(\\frac{2\\pi m}{L} j \\frac{L}{N}\\right) = \\sin\\left(\\frac{2\\pi m j}{N}\\right)\n$$\nfor $j=0, 1, \\dots, N-1$. We perform a single time step of the MUSCL scheme described above to obtain the new state $u_j^1$.\n\nTo measure the amplitude change, we use the Discrete Fourier Transform (DFT). Let $\\widehat{u}^0(p)$ and $\\widehat{u}^1(p)$ be the DFT coefficients of the states $u^0$ and $u^1$ at mode index $p$. The single-step amplitude attenuation factor for the initial mode $m$ is defined as the ratio of the magnitudes of the corresponding DFT coefficients:\n$$\n\\alpha = \\frac{\\left|\\widehat{u}^{\\,1}(m)\\right|}{\\left|\\widehat{u}^{\\,0}(m)\\right|}\n$$\nA value of $\\alpha < 1$ indicates dissipation, while $\\alpha = 1$ indicates no dissipation for that mode.\n\nThe computational procedure is implemented by iterating through the specified parameter space. For each combination of mode index $m \\in \\{1, 16, 64, 127\\}$ and CFL number $\\nu \\in \\{0.2, 0.5, 0.9\\}$, and for each of the three limiters (minmod, Superbee, MC), we perform the following steps:\n1.  Set up the $N=256$ point grid on the domain of length $L=2\\pi$ and generate the initial state $u^0$ for the given mode $m$. The advection speed is $a=1$.\n2.  Compute the DFT of $u^0$ and store the magnitude of the coefficient at index $m$, $|\\widehat{u}^0(m)|$.\n3.  Apply one time step of the MUSCL scheme using the given limiter and CFL number $\\nu$ to compute the state $u^1$. This involves:\n    a. Computing forward and backward differences with periodic boundary conditions.\n    b. Applying the chosen slope limiter to find the slope-related terms $s_i$ for all cells.\n    c. Calculating the predicted interface states $u_{i+1/2}^{L,*}$ for all interfaces.\n    d. Performing the final conservative update to get the vector $u^1$.\n4.  Compute the DFT of $u^1$ and find the magnitude of the coefficient at index $m$, $|\\widehat{u}^1(m)|$.\n5.  Calculate the attenuation factor $\\alpha = |\\widehat{u}^1(m)| / |\\widehat{u}^0(m)|$.\nThe computed values of $\\alpha$ are collected and presented in the specified order.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the single-step amplitude attenuation factor for a MUSCL finite volume scheme\n    applied to the linear advection equation.\n    \"\"\"\n    # Fixed parameters\n    N = 256\n    L = 2.0 * np.pi\n    a = 1.0\n\n    # Test suite parameters\n    m_vals = [1, 16, 64, 127]\n    nu_vals = [0.2, 0.5, 0.9]\n    limiters = [\"minmod\", \"superbee\", \"mc\"]\n\n    results = []\n\n    # Define limiter functions\n    def minmod(x, y):\n        \"\"\"Vectorized minmod function.\"\"\"\n        return 0.5 * (np.sign(x) + np.sign(y)) * np.minimum(np.abs(x), np.abs(y))\n\n    def maxmod(x, y):\n        \"\"\"Vectorized maxmod function.\"\"\"\n        return 0.5 * (np.sign(x) + np.sign(y)) * np.maximum(np.abs(x), np.abs(y))\n\n    def get_slope(u, limiter_name):\n        \"\"\"Computes the limited slope term s_i for all cells.\"\"\"\n        u_minus_1 = np.roll(u, 1)\n        u_plus_1 = np.roll(u, -1)\n        \n        delta_minus = u - u_minus_1\n        delta_plus = u_plus_1 - u\n\n        if limiter_name == \"minmod\":\n            return minmod(delta_minus, delta_plus)\n        elif limiter_name == \"superbee\":\n            s1 = minmod(2 * delta_minus, delta_plus)\n            s2 = minmod(delta_minus, 2 * delta_plus)\n            return maxmod(s1, s2)\n        elif limiter_name == \"mc\":\n            # 3-argument minmod can be implemented by nesting the 2-argument version\n            central_diff = 0.5 * (delta_minus + delta_plus)\n            s1 = minmod(central_diff, 2 * delta_minus)\n            return minmod(s1, 2 * delta_plus)\n        else:\n            raise ValueError(\"Unknown limiter\")\n\n    def take_step(u0, nu, limiter_name):\n        \"\"\"Applies one time step of the MUSCL scheme.\"\"\"\n        # 1. Slope Calculation\n        s = get_slope(u0, limiter_name)\n\n        # 2. Predictor Step\n        # The term u_{i+1/2}^{L,*} is computed for all i.\n        c = 0.5 * (1.0 - nu)\n        u_interface_L_star = u0 + c * s\n\n        # 3. Conservative Update\n        # The update needs the difference u_{i+1/2}^{L,*} - u_{i-1/2}^{L,*}.\n        # u_{i-1/2}^{L,*} for cell i is found by rolling u_interface_L_star.\n        flux_diff = u_interface_L_star - np.roll(u_interface_L_star, 1)\n        u1 = u0 - nu * flux_diff\n        \n        return u1\n\n    # Main loop over test cases\n    for m in m_vals:\n        # Define initial condition for the current mode m\n        x = np.linspace(0, L, N, endpoint=False)\n        k = 2.0 * np.pi * m / L\n        # In this problem setup, L=2pi, so k=m.\n        u0 = np.sin(m * x)\n\n        # Compute DFT of initial condition\n        u0_hat = np.fft.fft(u0)\n        mag_u0_hat_m = np.abs(u0_hat[m])\n\n        for nu in nu_vals:\n            for limiter_name in limiters:\n                # Apply one time step\n                u1 = take_step(u0, nu, limiter_name)\n                \n                # Compute DFT of the new state\n                u1_hat = np.fft.fft(u1)\n                mag_u1_hat_m = np.abs(u1_hat[m])\n                \n                # Calculate attenuation factor\n                if mag_u0_hat_m > 1e-12:\n                    alpha = mag_u1_hat_m / mag_u0_hat_m\n                else:\n                    # Should not happen for the given modes but good practice\n                    alpha = 1.0 \n                \n                results.append(alpha)\n\n    # Format the final output as a comma-separated list in brackets\n    print(f\"[{','.join(f'{r:.15f}' for r in results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "The most advanced shock-capturing strategies apply artificial viscosity selectively, adding it only in the immediate vicinity of a shock wave while leaving the rest of the flow field untouched. This requires an algorithmic tool—a shock sensor—that can reliably distinguish shocks from other features like smooth waves, contact discontinuities, and rarefaction fans. This practice challenges you to move from analysis to design by first identifying a failure mode in a simple pressure-based sensor and then engineering a corrected version based on a key physical principle: shocks are associated with compression ($\\partial_x u < 0$), while rarefactions are associated with expansion ($\\partial_x u > 0$) . This exercise cultivates the essential skill of translating physical insight into a robust computational component.",
            "id": "3364614",
            "problem": "Consider the one-dimensional compressible Euler equations, which encode conservation of mass, momentum, and energy, given by\n$$\n\\partial_t \\rho + \\partial_x (\\rho u) = 0,\\quad\n\\partial_t (\\rho u) + \\partial_x (\\rho u^2 + p) = 0,\\quad\n\\partial_t E + \\partial_x \\left( (E + p) u \\right) = 0,\n$$\nwhere $\\rho$ is the density, $u$ is the velocity, $p$ is the pressure, and $E$ is the total energy per unit volume. In inviscid flow governed by these equations, shocks arise from compressive kinematics characterized by negative velocity divergence, while rarefaction waves arise from expansive kinematics characterized by positive velocity divergence. Artificial viscosity (AV) and shock sensors are routinely used to stabilize numerical solutions of partial differential equations (PDEs) by selectively adding dissipation near shocks while avoiding dissipation in smooth regions or rarefactions.\n\nSuppose we define a discrete, pressure-gradient shock sensor on a uniform grid with spacing $\\Delta x$ using central differences and periodic boundary conditions. Let $p_i$ denote the discrete pressure at cell index $i$. Consider the sensor\n$$\nS_i = \\frac{\\left| p_{i+1} - 2 p_i + p_{i-1} \\right|}{\\left| p_{i+1} - p_{i-1} \\right| + \\epsilon},\n$$\nwhere $\\epsilon$ is a small positive constant to prevent division by zero. This $S_i$ is a smoothness indicator based on the ratio of a discrete second derivative to a discrete first derivative. It is known to detect steep gradients but can spuriously activate inside rarefaction fans when the denominator $\\left| p_{i+1} - p_{i-1} \\right|$ becomes small while the numerator remains finite due to smooth curvature.\n\nStarting from the fundamental characterization that shocks form under compression with negative velocity divergence and rarefactions form under expansion with positive velocity divergence, devise a corrected sensor that suppresses activation in rarefactions and retains activation in compressions. Specifically, define the discrete velocity divergence via central differences as\n$$\nD^{(u)}_i = \\frac{u_{i+1} - u_{i-1}}{2 \\Delta x},\n$$\nand construct a gating factor that is large in compression and small in expansion. Your corrected sensor should be of the multiplicative form\n$$\nS^{\\mathrm{corr}}_i = S_i \\cdot G_i,\n$$\nwhere $G_i$ is a dimensionless function of $D^{(u)}_i$ and a small positive constant $\\eta$ that regularizes $G_i$ so it remains finite. You must base your construction of $G_i$ on the kinematic principle that shocks are associated with compression and rarefactions with expansion, and you must justify the construction in your solution.\n\nYour program must implement the original sensor $S_i$ and your corrected sensor $S^{\\mathrm{corr}}_i$ on a uniform grid using periodic boundary conditions and central differences, and then quantitatively evaluate activation and failure modes in several synthetic test fields. An activation occurs at index $i$ when $S_i > T$ or $S^{\\mathrm{corr}}_i > T$, respectively, where $T$ is a prescribed threshold. The evaluation must include the following metrics:\n1. For a shock-like compressive profile, compute the true positive rate (a decimal fraction) of activation restricted to indices identified as shock-domain indices. Define the shock-domain indices as those for which $\\left| \\partial_x p \\right|$ exceeds a specified threshold and $D^{(u)}_i < 0$. Use central differences for $\\partial_x p$ and set the shock-domain pressure-gradient threshold equal to one-half of the maximum absolute pressure gradient, that is,\n$$\nG_{\\mathrm{shock}} = \\frac{1}{2} \\max_i \\left| \\frac{p_{i+1} - p_{i-1}}{2 \\Delta x} \\right|.\n$$\nReport the true positive rate for both $S_i$ and $S^{\\mathrm{corr}}_i$.\n2. For a rarefaction-like expansive profile, compute the false activation rate (a decimal fraction) restricted to expansion-domain indices with $D^{(u)}_i > 0$. Report the false activation rate for both $S_i$ and $S^{\\mathrm{corr}}_i$.\n3. For a contact-like profile with constant pressure and a discontinuity in a non-pressure variable, compute the overall activation fraction (a decimal fraction) over the entire domain for both $S_i$ and $S^{\\mathrm{corr}}_i$.\n4. For a smooth acoustic-like sinusoidal pressure field, compute the overall activation fraction (a decimal fraction) over the entire domain for both $S_i$ and $S^{\\mathrm{corr}}_i$.\n\nConstruct the following synthetic test fields on a uniform grid with periodic boundary conditions, $N$ grid points, total domain length $L$, and spacing $\\Delta x = L / N$, using hyperbolic tangent transitions for shock and rarefaction cases and sine waves for the acoustic case. Use the parameters listed below, with all central differences implemented via periodic neighbor indexing:\n- Grid parameters: $N = 400$, $L = 1.0$, $\\Delta x = L/N$.\n- Regularization constants: $\\epsilon = 10^{-12}$, $\\eta = 10^{-8}$.\n- Activation threshold: $T = 0.8$.\n- Shock-like compressive profile centered at $x_0 = 0.5$ with transition width $w_{\\mathrm{shock}} = 0.005$, left and right pressure states $p_L = 1.0$, $p_R = 0.1$, and left and right velocity states $u_L = 0.5$, $u_R = 0.0$. Define\n$$\np(x) = p_L - (p_L - p_R)\\, \\frac{1 + \\tanh\\left(\\frac{x - x_0}{w_{\\mathrm{shock}}}\\right)}{2},\\quad\nu(x) = u_L - (u_L - u_R)\\, \\frac{1 + \\tanh\\left(\\frac{x - x_0}{w_{\\mathrm{shock}}}\\right)}{2}.\n$$\n- Rarefaction-like expansive profile centered at $x_0 = 0.5$ with width $w_{\\mathrm{raf}} = 0.05$, left and right pressure states $p_L = 1.0$, $p_R = 0.2$, and left and right velocity states $u_L = 0.0$, $u_R = 0.6$. Define\n$$\np(x) = p_L - (p_L - p_R)\\, \\frac{1 + \\tanh\\left(\\frac{x - x_0}{w_{\\mathrm{raf}}}\\right)}{2},\\quad\nu(x) = u_L + (u_R - u_L)\\, \\frac{1 + \\tanh\\left(\\frac{x - x_0}{w_{\\mathrm{raf}}}\\right)}{2}.\n$$\n- Contact-like profile: constant pressure $p(x) = p_0$ with $p_0 = 1.0$ and a discontinuity in velocity is not required for this assessment, but choose a mild constant velocity $u(x) = u_0$ with $u_0 = 0.2$ so that $D^{(u)}_i \\approx 0$.\n- Acoustic-like sinusoidal profile: $p(x) = p_0 + A_p \\sin(k x)$ with $p_0 = 1.0$, $A_p = 0.01$, $k = 2 \\pi \\cdot 10$, and $u(x) = u_0 + A_u \\sin(k x)$ with $u_0 = 0.2$, $A_u = 0.02$.\n\nYour program must:\n- Implement the original sensor $S_i$ and your corrected sensor $S^{\\mathrm{corr}}_i$ using the above discretizations.\n- For each test field, compute the specified metrics and produce a single line of output containing the eight decimal fractions in the following order:\n1. Shock-case true positive rate for $S_i$,\n2. Shock-case true positive rate for $S^{\\mathrm{corr}}_i$,\n3. Rarefaction-case false activation rate for $S_i$,\n4. Rarefaction-case false activation rate for $S^{\\mathrm{corr}}_i$,\n5. Contact-case overall activation fraction for $S_i$,\n6. Contact-case overall activation fraction for $S^{\\mathrm{corr}}_i$,\n7. Acoustic-case overall activation fraction for $S_i$,\n8. Acoustic-case overall activation fraction for $S^{\\mathrm{corr}}_i$.\n\nFinal output format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, $\\left[ \\mathrm{result1}, \\mathrm{result2}, \\mathrm{result3}, \\ldots \\right]$). All reported quantities must be decimal fractions.",
            "solution": "The problem statement has been analyzed and is determined to be valid. It is scientifically grounded in the principles of computational fluid dynamics, well-posed with clear definitions and objectives, and free of contradictions or ambiguities. We may proceed with a solution.\n\nThe primary task is to devise a corrected shock sensor, $S^{\\mathrm{corr}}_i$, that mitigates the known failure mode of a standard pressure-gradient-based sensor, $S_i$, which can be spuriously activated in smooth rarefaction waves. The correction must take the form of a multiplicative gating factor, $S^{\\mathrm{corr}}_i = S_i \\cdot G_i$. The construction of this gating factor $G_i$ must be based on the fundamental kinematic principle that shocks are associated with fluid compression (negative velocity divergence, $\\partial_x u < 0$) and rarefactions with fluid expansion (positive velocity divergence, $\\partial_x u > 0$).\n\nThe original sensor is given by\n$$\nS_i = \\frac{\\left| p_{i+1} - 2 p_i + p_{i-1} \\right|}{\\left| p_{i+1} - p_{i-1} \\right| + \\epsilon},\n$$\nwhere $p_i$ is the pressure at grid index $i$ and $\\epsilon$ is a small regularization constant. This sensor detects sharp changes in pressure by measuring the ratio of the second difference to the first difference of the pressure field.\n\nThe velocity divergence is discretized using central differences as\n$$\nD^{(u)}_i = \\frac{u_{i+1} - u_{i-1}}{2 \\Delta x},\n$$\nwhere $u_i$ is the velocity at grid index $i$ and $\\Delta x$ is the grid spacing.\n\nTo construct the gating factor $G_i$, we require a function that is close to $1$ in regions of compression ($D^{(u)}_i < 0$) and close to $0$ in regions of expansion ($D^{(u)}_i > 0$). This will ensure the corrected sensor $S^{\\mathrm{corr}}_i = S_i \\cdot G_i$ is \"on\" for shocks and \"off\" for rarefactions.\n\nWe define $G_i$ as a function of $D^{(u)}_i$ and a small positive regularization constant $\\eta$. A suitable form for such a gating function is:\n$$\nG_i = \\frac{\\max(0, -D^{(u)}_i)}{|D^{(u)}_i| + \\eta}.\n$$\nLet us analyze the behavior of this proposed function $G_i$:\n1.  **In regions of compression**, $D^{(u)}_i < 0$. Let $D^{(u)}_i = -c$ where $c > 0$ represents the magnitude of the compression rate. The gating factor becomes\n    $$\n    G_i = \\frac{\\max(0, c)}{|-c| + \\eta} = \\frac{c}{c + \\eta}.\n    $$\n    As the compression becomes strong ($c \\gg \\eta$), this ratio approaches $1$. For weak compression ($c \\ll \\eta$), the factor is small. This provides a smooth transition.\n2.  **In regions of expansion**, $D^{(u)}_i > 0$. The numerator becomes $\\max(0, -D^{(u)}_i) = 0$. Thus, for any positive velocity divergence,\n    $$\n    G_i = 0.\n    $$\n    This completely suppresses the sensor in expansive flows, as required.\n3.  **In regions of zero divergence**, $D^{(u)}_i = 0$. The gating factor is also $G_i = 0$.\n4.  **Properties**: The function is dimensionless, as it is a ratio of quantities with the same units of inverse time (assuming $\\eta$ is given units consistent with $D^{(u)}_i$). The denominator $|D^{(u)}_i| + \\eta$ is always positive for $\\eta > 0$, ensuring the expression is well-defined and finite.\n\nThis construction of $G_i$ directly implements the kinematic principle specified in the problem. The final corrected sensor is therefore defined as\n$$\nS^{\\mathrm{corr}}_i = S_i \\cdot G_i = \\frac{\\left| p_{i+1} - 2 p_i + p_{i-1} \\right|}{\\left| p_{i+1} - p_{i-1} \\right| + \\epsilon} \\cdot \\frac{\\max(0, -D^{(u)}_i)}{|D^{(u)}_i| + \\eta}.\n$$\n\nThe subsequent part of the problem requires a numerical implementation to evaluate the performance of both $S_i$ and $S^{\\mathrm{corr}}_i$ across four synthetic test fields: a shock-like profile, a rarefaction-like profile, a contact-like profile, and an acoustic-like profile. The evaluation uses specific metrics: true positive rate for the shock case, false activation rate for the rarefaction case, and overall activation fraction for the contact and acoustic cases. The implementation will be performed on a uniform periodic grid with $N=400$ points over a domain of length $L=1.0$, using the provided parameters $\\epsilon = 10^{-12}$, $\\eta = 10^{-8}$, and activation threshold $T = 0.8$. All spatial differences will be computed using central stencils with periodic boundary conditions. The final program will calculate and output the eight specified metrics.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements and evaluates an original and a corrected shock sensor\n    on four synthetic test fields, reporting eight performance metrics.\n    \"\"\"\n    # Global parameters\n    N = 400\n    L = 1.0\n    dx = L / N\n    epsilon = 1e-12\n    eta = 1e-8\n    T = 0.8\n    x = np.linspace(0, L, N, endpoint=False)\n\n    def compute_sensors(p, u):\n        \"\"\"\n        Computes the original sensor S, the corrected sensor Scorr,\n        and the discrete velocity divergence Du.\n        \"\"\"\n        # Periodic boundary conditions are handled by np.roll\n        p_plus_1 = np.roll(p, -1)\n        p_minus_1 = np.roll(p, 1)\n        u_plus_1 = np.roll(u, -1)\n        u_minus_1 = np.roll(u, 1)\n\n        # Original sensor S_i\n        num_S = np.abs(p_plus_1 - 2 * p + p_minus_1)\n        den_S = np.abs(p_plus_1 - p_minus_1) + epsilon\n        S = num_S / den_S\n\n        # Discrete velocity divergence D^(u)_i\n        Du = (u_plus_1 - u_minus_1) / (2 * dx)\n        \n        # Gating factor G_i\n        G = np.maximum(0, -Du) / (np.abs(Du) + eta)\n        \n        # Corrected sensor S^corr_i\n        Scorr = S * G\n        \n        return S, Scorr, Du\n\n    results = []\n\n    # Case 1: Shock-like compressive profile\n    x0_s, w_shock, pL_s, pR_s, uL_s, uR_s = 0.5, 0.005, 1.0, 0.1, 0.5, 0.0\n    trans_s = (1 + np.tanh((x - x0_s) / w_shock)) / 2\n    p_shock = pL_s - (pL_s - pR_s) * trans_s\n    u_shock = uL_s - (uL_s - uR_s) * trans_s\n    S_s, Scorr_s, Du_s = compute_sensors(p_shock, u_shock)\n    \n    activations_S = S_s > T\n    activations_Scorr = Scorr_s > T\n    \n    dp_dx = (np.roll(p_shock, -1) - np.roll(p_shock, 1)) / (2 * dx)\n    G_shock = 0.5 * np.max(np.abs(dp_dx))\n    shock_domain_mask = (np.abs(dp_dx) > G_shock) & (Du_s < 0)\n    num_shock_domain = np.sum(shock_domain_mask)\n    \n    tpr_S = np.sum(activations_S[shock_domain_mask]) / num_shock_domain if num_shock_domain > 0 else 0.0\n    tpr_Scorr = np.sum(activations_Scorr[shock_domain_mask]) / num_shock_domain if num_shock_domain > 0 else 0.0\n    results.extend([tpr_S, tpr_Scorr])\n\n    # Case 2: Rarefaction-like expansive profile\n    x0_r, w_raf, pL_r, pR_r, uL_r, uR_r = 0.5, 0.05, 1.0, 0.2, 0.0, 0.6\n    trans_r = (1 + np.tanh((x - x0_r) / w_raf)) / 2\n    p_raf = pL_r - (pL_r - pR_r) * trans_r\n    u_raf = uL_r + (uR_r - uL_r) * trans_r\n    S_r, Scorr_r, Du_r = compute_sensors(p_raf, u_raf)\n\n    activations_S = S_r > T\n    activations_Scorr = Scorr_r > T\n\n    expansion_domain_mask = Du_r > 0\n    num_expansion_domain = np.sum(expansion_domain_mask)\n    \n    far_S = np.sum(activations_S[expansion_domain_mask]) / num_expansion_domain if num_expansion_domain > 0 else 0.0\n    far_Scorr = np.sum(activations_Scorr[expansion_domain_mask]) / num_expansion_domain if num_expansion_domain > 0 else 0.0\n    results.extend([far_S, far_Scorr])\n\n    # Case 3: Contact-like profile\n    p_contact = np.full(N, 1.0)\n    u_contact = np.full(N, 0.2)\n    S_c, Scorr_c, _ = compute_sensors(p_contact, u_contact)\n    \n    activations_S = S_c > T\n    activations_Scorr = Scorr_c > T\n    \n    af_S = np.sum(activations_S) / N\n    af_Scorr = np.sum(activations_Scorr) / N\n    results.extend([af_S, af_Scorr])\n\n    # Case 4: Acoustic-like sinusoidal profile\n    p0_a, Ap, k = 1.0, 0.01, 2 * np.pi * 10\n    u0_a, Au = 0.2, 0.02\n    p_acoustic = p0_a + Ap * np.sin(k * x)\n    u_acoustic = u0_a + Au * np.sin(k * x)\n    S_a, Scorr_a, _ = compute_sensors(p_acoustic, u_acoustic)\n\n    activations_S = S_a > T\n    activations_Scorr = Scorr_a > T\n\n    af_S = np.sum(activations_S) / N\n    af_Scorr = np.sum(activations_Scorr) / N\n    results.extend([af_S, af_Scorr])\n\n    # Print the final results in the specified format\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}