{
    "hands_on_practices": [
        {
            "introduction": "本练习是特征分解理论的基石性应用，旨在解决一个经典的线性双曲系统黎曼问题。通过亲手计算浅水波方程系统的特征值与特征向量，您将能够确定波的强度和传播速度，从而将抽象的数学理论与具体的物理波动态联系起来。这个过程将深化您对特征结构如何决定波的传播与叠加的基本原理的理解。",
            "id": "3369623",
            "problem": "考虑由常系数偏微分方程 (PDE) 给出的线性双曲系统\n$$\n\\partial_{t}\\boldsymbol{u}(x,t) + A\\,\\partial_{x}\\boldsymbol{u}(x,t) = \\boldsymbol{0}, \\quad A = \\begin{pmatrix} 0  1 \\\\ g H  0 \\end{pmatrix},\n$$\n其中重力加速度 $g>0$ 且背景深度 $H>0$。设黎曼初始数据为\n$$\n\\boldsymbol{u}(x,0) = \\begin{cases}\n\\boldsymbol{u}_{L},  x0,\\\\\n\\boldsymbol{u}_{R},  x>0,\n\\end{cases}\n$$\n其中 $\\boldsymbol{u}_{L},\\boldsymbol{u}_{R}\\in\\mathbb{R}^{2}$ 是恒定的左状态和右状态。用 $\\Delta \\boldsymbol{u} = \\boldsymbol{u}_{R} - \\boldsymbol{u}_{L}$ 表示跳跃，其分量为 $\\Delta u_{1}$ 和 $\\Delta u_{2}$。仅使用严格双曲性、矩阵 A 的特征分解以及线性系统的特征投影的基本定义，推导与每个族相关的特征波强度以及在时间 $t>0$ 时所有间断点的位置。通过将跳跃分解为矩阵 A 的右特征向量来定义波强度 $\\alpha_{+}$ 和 $\\alpha_{-}$，其中 $\\alpha_{+}$ 对应右行特征，$\\alpha_{-}$ 对应左行特征。将你的最终答案表示为单行矩阵\n$$\n\\left(\\alpha_{+},\\,\\alpha_{-},\\,x_{-}(t),\\,x_{+}(t)\\right),\n$$\n其中 $x_{-}(t)$ 和 $x_{+}(t)$ 分别是在时间 $t>0$ 时左行和右行间断点的位置。提供一个用 $g$、$H$、$t$、$\\Delta u_{1}$ 和 $\\Delta u_{2}$ 表示的精确符号表达式。无需四舍五入，最终答案中不应包含单位。",
            "solution": "该问题是有效的。这是一个在偏微分方程领域内有科学依据的适定问题，具体涉及线性双曲系统的特征分解。所有必要的数据和定义均已提供，不存在矛盾或歧义。\n\n给定的线性双曲系统是\n$$\n\\partial_{t}\\boldsymbol{u}(x,t) + A\\,\\partial_{x}\\boldsymbol{u}(x,t) = \\boldsymbol{0},\n$$\n其中 $\\boldsymbol{u}(x,t) \\in \\mathbb{R}^{2}$ 且常系数矩阵 $A$ 为\n$$\nA = \\begin{pmatrix} 0  1 \\\\ g H  0 \\end{pmatrix}.\n$$\n该问题描述了一个黎曼问题，其初始数据由两个恒定状态组成，即 $x0$ 时的 $\\boldsymbol{u}_{L}$ 和 $x>0$ 时的 $\\boldsymbol{u}_{R}$。对于线性双曲系统，此类问题的解是通过将初始跳跃 $\\Delta \\boldsymbol{u} = \\boldsymbol{u}_{R} - \\boldsymbol{u}_{L}$ 分解为矩阵 $A$ 的特征向量来构造的。\n\n首先，我们必须对 $A$ 进行特征分解。特征值 $\\lambda$ 是特征方程 $\\det(A - \\lambda I) = 0$ 的根。\n$$\n\\det\\begin{pmatrix} 0-\\lambda  1 \\\\ gH  0-\\lambda \\end{pmatrix} = (-\\lambda)(-\\lambda) - (1)(gH) = \\lambda^{2} - gH = 0.\n$$\n由于 $g>0$ 和 $H>0$，特征值是实数且不相等：\n$$\n\\lambda_{\\pm} = \\pm\\sqrt{gH}.\n$$\n两个不同实特征值的存在证实了该系统是严格双曲的。这些特征值代表信息传播的特征速度。正特征值 $\\lambda_{+} = \\sqrt{gH}$ 对应一个右行波，负特征值 $\\lambda_{-} = -\\sqrt{gH}$ 对应一个左行波。\n\n接下来，我们通过求解 $(A - \\lambda_{\\pm} I)\\boldsymbol{r}_{\\pm} = \\boldsymbol{0}$ 来找到相应的右特征向量 $\\boldsymbol{r}_{\\pm}$。\n\n对于特征值 $\\lambda_{+} = \\sqrt{gH}$：\n$$\n(A - \\lambda_{+}I)\\boldsymbol{r}_{+} = \\begin{pmatrix} -\\sqrt{gH}  1 \\\\ gH  -\\sqrt{gH} \\end{pmatrix} \\begin{pmatrix} r_{1,+} \\\\ r_{2,+} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}.\n$$\n这给出了方程 $-\\sqrt{gH}r_{1,+} + r_{2,+} = 0$，这意味着 $r_{2,+} = \\sqrt{gH}r_{1,+}$。我们可以选择 $r_{1,+} = 1$，从而得到特征向量\n$$\n\\boldsymbol{r}_{+} = \\begin{pmatrix} 1 \\\\ \\sqrt{gH} \\end{pmatrix}.\n$$\n这个特征向量对应于右行特征族。\n\n对于特征值 $\\lambda_{-} = -\\sqrt{gH}$：\n$$\n(A - \\lambda_{-}I)\\boldsymbol{r}_{-} = \\begin{pmatrix} \\sqrt{gH}  1 \\\\ gH  \\sqrt{gH} \\end{pmatrix} \\begin{pmatrix} r_{1,-} \\\\ r_{2,-} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}.\n$$\n这给出了方程 $\\sqrt{gH}r_{1,-} + r_{2,-} = 0$，这意味着 $r_{2,-} = -\\sqrt{gH}r_{1,-}$。我们可以选择 $r_{1,-} = 1$，从而得到特征向量\n$$\n\\boldsymbol{r}_{-} = \\begin{pmatrix} 1 \\\\ -\\sqrt{gH} \\end{pmatrix}.\n$$\n这个特征向量对应于左行特征族。\n\n黎曼问题的解由与每个特征族相关的波的叠加给出。初始数据的跳跃 $\\Delta \\boldsymbol{u} = \\boldsymbol{u}_{R} - \\boldsymbol{u}_{L}$ 被分解为右特征向量的线性组合。这个分解的系数就是特征波强度，记为 $\\alpha_{+}$ 和 $\\alpha_{-}$。\n$$\n\\Delta \\boldsymbol{u} = \\alpha_{+} \\boldsymbol{r}_{+} + \\alpha_{-} \\boldsymbol{r}_{-}.\n$$\n将 $\\Delta \\boldsymbol{u} = \\begin{pmatrix} \\Delta u_{1} \\\\ \\Delta u_{2} \\end{pmatrix}$ 和特征向量的表达式代入，我们得到一个关于波强度的线性系统：\n$$\n\\begin{pmatrix} \\Delta u_{1} \\\\ \\Delta u_{2} \\end{pmatrix} = \\alpha_{+} \\begin{pmatrix} 1 \\\\ \\sqrt{gH} \\end{pmatrix} + \\alpha_{-} \\begin{pmatrix} 1 \\\\ -\\sqrt{gH} \\end{pmatrix} = \\begin{pmatrix} 1  1 \\\\ \\sqrt{gH}  -\\sqrt{gH} \\end{pmatrix} \\begin{pmatrix} \\alpha_{+} \\\\ \\alpha_{-} \\end{pmatrix}.\n$$\n我们求解这个系统以得到 $\\alpha_{+}$ 和 $\\alpha_{-}$。从第一行，我们有 $\\alpha_{+} + \\alpha_{-} = \\Delta u_{1}$。从第二行，我们有 $\\sqrt{gH}(\\alpha_{+} - \\alpha_{-}) = \\Delta u_{2}$，这给出 $\\alpha_{+} - \\alpha_{-} = \\frac{\\Delta u_{2}}{\\sqrt{gH}}$。\n\n将这两个方程相加：\n$$\n(\\alpha_{+} + \\alpha_{-}) + (\\alpha_{+} - \\alpha_{-}) = \\Delta u_{1} + \\frac{\\Delta u_{2}}{\\sqrt{gH}} \\implies 2\\alpha_{+} = \\Delta u_{1} + \\frac{\\Delta u_{2}}{\\sqrt{gH}}.\n$$\n$$\n\\alpha_{+} = \\frac{1}{2}\\Delta u_{1} + \\frac{\\Delta u_{2}}{2\\sqrt{gH}}.\n$$\n从第一个新方程中减去第二个新方程：\n$$\n(\\alpha_{+} + \\alpha_{-}) - (\\alpha_{+} - \\alpha_{-}) = \\Delta u_{1} - \\frac{\\Delta u_{2}}{\\sqrt{gH}} \\implies 2\\alpha_{-} = \\Delta u_{1} - \\frac{\\Delta u_{2}}{\\sqrt{gH}}.\n$$\n$$\n\\alpha_{-} = \\frac{1}{2}\\Delta u_{1} - \\frac{\\Delta u_{2}}{2\\sqrt{gH}}.\n$$\n这些分别是右行波和左行波的强度。\n\n间断点的位置 $x_{-}(t)$ 和 $x_{+}(t)$ 由特征速度决定。对于线性常系数系统，间断点是接触间断，它们从原点 $x=0$ 发出，并以等于特征值的恒定速度传播。\n在时间 $t>0$ 时，右行间断点的位置由其速度 $\\lambda_{+}$ 乘以时间 $t$ 给出：\n$$\nx_{+}(t) = \\lambda_{+} t = \\sqrt{gH}t.\n$$\n在时间 $t>0$ 时，左行间断点的位置由其速度 $\\lambda_{-}$ 乘以时间 $t$ 给出：\n$$\nx_{-}(t) = \\lambda_{-} t = -\\sqrt{gH}t.\n$$\n解 $\\boldsymbol{u}(x,t)$ 于是为分段常数，当 $x  x_{-}(t)$ 时 $\\boldsymbol{u}(x,t) = \\boldsymbol{u}_{L}$，当 $x > x_{+}(t)$ 时 $\\boldsymbol{u}(x,t) = \\boldsymbol{u}_{R}$，以及在 $x_{-}(t)  x  x_{+}(t)$ 时为一个恒定的中间状态。\n\n我们现在将所需的量组合成一个单行矩阵 $(\\alpha_{+}, \\alpha_{-}, x_{-}(t), x_{+}(t))$：\n$$\n\\left( \\frac{1}{2}\\Delta u_{1} + \\frac{\\Delta u_{2}}{2\\sqrt{gH}}, \\quad \\frac{1}{2}\\Delta u_{1} - \\frac{\\Delta u_{2}}{2\\sqrt{gH}}, \\quad -\\sqrt{gH}t, \\quad \\sqrt{gH}t \\right).\n$$\n该表达式按要求提供了完整的特征分解和所产生间断点的动力学特性。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{2}\\Delta u_{1} + \\frac{\\Delta u_{2}}{2\\sqrt{gH}}  \\frac{1}{2}\\Delta u_{1} - \\frac{\\Delta u_{2}}{2\\sqrt{gH}}  -\\sqrt{gH}t  \\sqrt{gH}t\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "从理论转向数值实现，严格的验证是确保代码正确性的关键环节。本练习旨在挑战您如何基于特征理论，设计一套精巧的数值实验来独立地激发和验证各个特征模态的行为。掌握这种方法论对于调试复杂的计算流体动力学程序、确保数值格式的鲁棒性至关重要。",
            "id": "3369597",
            "problem": "考虑一维空间中的常系数线性双曲系统\n$$\nq_t + A\\,q_x = 0,\\qquad x\\in(0,\\ell),\\ t0,\n$$\n其中 $q\\in\\mathbb{R}^m$，$A\\in\\mathbb{R}^{m\\times m}$ 是一个可对角化且具有实特征值的矩阵，且 $A=R\\,\\Lambda\\,L$，其中 $R=[r_1,\\dots,r_m]$ 是右特征向量矩阵，$L=R^{-1}$ 是左特征向量矩阵，$\\Lambda=\\mathrm{diag}(\\lambda_1,\\dots,\\lambda_m)$。假设 $m=3$ 且特征值满足 $\\lambda_10$, $\\lambda_2=0$, $\\lambda_30$，这与围绕均匀静止状态的一维欧拉方程线性化后的情况一致。实现了一种有限体积法（FVM），该方法在每个面上将单元值投影到特征变量 $w=L\\,q$ 上，根据每个 $\\lambda_k$ 的符号应用迎风格式，并通过指定入流特征分量和外插出流特征分量来施加无反射边界条件。\n\n你的任务是通过有针对性的数值测试来验证该实现是否能正确执行 (i) 到特征基的投影以及从特征基的重构，(ii) 内部面上的迎风选择，以及 (iii) 在 $x=0$ 和 $x=\\ell$ 处的基于特征的边界处理。下列哪个测试套件是充分且方法上可靠的，能够独立地隔离和激发单个及多个特征模态，从而可以根据线性叠加和恒定波速推导出的解析期望，对上述三个方面进行验证？\n\nA. 对于每个 $k\\in\\{1,2,3\\}$，定义一个光滑波包 $\\phi_\\sigma(x)=\\exp\\!\\big(-((x-x_c)/\\sigma)^2\\big)$，其中 $x_c\\in(0,\\ell)$ 且 $\\sigma0$。单模态初值测试：设置 $q(x,0)=r_k\\,\\phi_\\sigma(x)$，并通过在 $x=0$ 处将 $\\lambda_j0$ 的入流分量 $w_j$ 设为 $0$，以及在 $x=\\ell$ 处将 $\\lambda_j0$ 的入流分量 $w_j$ 设为 $0$ 来施加无反射边界；验证 $w=L\\,q$ 仅有第 $k$ 个分量在舍入误差范围内非零，并且波包以 $q(x,t)=r_k\\,\\phi_\\sigma(x-\\lambda_k t)$ 的形式传播且无反射。边界驱动的单模态测试：在 $q(x,0)=0$ 的情况下，对于 $\\lambda_k0$ 使用 $w_k(0,t)=g(t)$，对于 $\\lambda_k0$ 使用 $w_k(\\ell,t)=g(t)$，一次只驱动一个入流特征，其中 $g(t)=\\sin(\\omega t)\\,\\chi(t)$，$\\chi(t)$ 是一个光滑紧支集窗函数，并将所有其他入流分量设为 $0$；对于 $\\lambda_k\\neq 0$，验证内部场与 $r_k\\,g(t-x/\\lambda_k)$ 匹配，并通过比较出流能量与入流能量，验证反射低于预设容差。多模态叠加测试：选择分离的中心 $x_1, x_3$ 并设置 $q(x,0)=r_1\\,\\phi_\\sigma(x-x_1)+r_3\\,\\phi_\\sigma(x-x_3)$；验证每个波包以其自身的速度传播，并且 $w=L\\,q$ 仅有分量 $1$ 和 $3$ 非零，同时线性叠加在波包穿越过程中得以保持。零速持久性测试：设置 $q(x,0)=r_2\\,\\phi_\\sigma(x)$；验证其在时间上是平稳的，并且没有伪平流。在反转的空间方向下重复选定的测试，以确认迎风格式根据 $\\lambda_k$ 的符号正确切换。\n\nB. 使用单次长时间模拟，其中 $q(x,0)$ 在原始变量中选择为空间带限随机场，并在 $x=0$ 和 $x=\\ell$ 处使用周期性边界；计算 $q$ 在探测点处的时间傅里叶变换，通过回归推断相速度，并检查频谱中是否存在三个峰值；如果存在三个峰值且估计的速度接近名义值 $\\lambda_k$，则断定该实现是正确的。\n\nC. 在每个原始变量中分别将 $q(x,0)$ 初始化为间断阶跃，设置齐次狄利克雷边界条件 $q(0,t)=0$ 和 $q(\\ell,t)=0$，并验证总变差随时间衰减且数值解保持有界；如果满足这些条件，则断定投影、迎风和边界处理是正确的。\n\nD. 对于 $\\mathbb{R}^3$ 的每个典范基向量 $e_i$，将 $q(x,0)=e_i\\,\\phi_\\sigma(x)$ 初始化并使用周期性边界；验证三次模拟在 $L^2$ 范数衰减曲线中产生三个不同的表观传播速度，并且 $i=1,2,3$ 的解之和等于组合初始化的解；如果满足这些条件，则断定投影和迎风是正确的，并且边界处理无需测试。\n\n请选择为该FVM实现提供了一个充分且科学上可靠的测试套件的选项，该套件能够独立地激发和验证单个及多个特征模态、迎风决策以及基于特征的边界处理。",
            "solution": "我们从控制线性系统 $q_t + A\\,q_x = 0$ 开始，其中 $A$ 是常数且实可对角化。写出特征分解 $A=R\\,\\Lambda\\,L$，其中 $L\\,R=I$，特征变量为 $w=L\\,q$。在这些变量中，系统解耦为 $w_t + \\Lambda\\,w_x=0$，即每个分量 $w_k$ 满足 $w_{k,t} + \\lambda_k\\,w_{k,x} = 0$。通解是线性叠加\n$$\nq(x,t) = \\sum_{k=1}^3 r_k\\,w_k(x,t),\\qquad w_k(x,t)=w_k(x-\\lambda_k t,0),\n$$\n以及在入流特征上指定的边界条件：在 $x=0$ 处，必须为 $\\lambda_k0$（从左侧入流）指定 $w_k(0,t)$；在 $x=\\ell$ 处，必须为 $\\lambda_k0$（从右侧入流）指定 $w_k(\\ell,t)$。出流分量由内部解确定。\n\n对于一个通过根据 $\\lambda_k$ 的符号进行分裂来迎风处理的有限体积法，其正确性可以通过隔离每个 $w_k$ 来探查，并验证 (i) 投影 $w=L\\,q$ 只产生预期的非零分量，而重构 $q=R\\,w$ 能恢复预期的物理场；(ii) 波包以速度 $\\lambda_k$ 并沿正确的方向传播；(iii) 在边界上，仅指定入流分量不会在出流分量中产生反射。\n\n我们现在分析每个选项。\n\n选项A：该选项构建了基于上述解耦的有针对性的测试。\n\n单模态初值测试：设置 $q(x,0)=r_k\\,\\phi_\\sigma(x)$ 会得到 $w(x,0)=L\\,q(x,0)=L\\,r_k\\,\\phi_\\sigma(x)=e_k\\,\\phi_\\sigma(x)$，因为 $L\\,r_k=e_k$，即第 $k$ 个典范基向量。因此对于 $j\\neq k$，$w_j(x,0)=0$，只有 $w_k$ 非零。由于 $w_{k,t}+\\lambda_k w_{k,x}=0$，精确的演化是 $w_k(x,t)=\\phi_\\sigma(x-\\lambda_k t)$，所以\n$$\nq(x,t)=r_k\\,\\phi_\\sigma(x-\\lambda_k t).\n$$\n通过在两端将入流分量 $w_j$ 指定为 $0$ 来施加无反射边界，这与内部波无反射地离开计算域是一致的。在数值上，如果对于所有 $t$，$w=L\\,q$ 仅有第 $k$ 个分量在舍入误差范围内非零，则验证了投影的正确性；如果波包以速度 $\\lambda_k$ 沿 $\\lambda_k$ 符号决定的方向移动，则验证了迎风格式的正确性；如果边界处的反射能量可以忽略不计，则验证了边界处理的正确性。\n\n边界驱动的单模态测试：在 $q(x,0)=0$ 且一次只驱动一个入流特征的情况下，例如，对于 $\\lambda_k0$ 使用 $w_k(0,t)=g(t)$（对于 $\\lambda_k0$ 在 $x=\\ell$ 处类似），对于 $\\lambda_k\\neq 0$，在计算域内的精确解是\n$$\nw_k(x,t)=g(t - x/\\lambda_k)\\ \\text{for}\\ t\\ge x/\\lambda_k,\\quad w_j\\equiv 0\\ \\text{for}\\ j\\neq k,\n$$\n所以 $q(x,t)=r_k\\,g(t - x/\\lambda_k)$。这直接隔离了边界处理：只应出现被驱动的分量，而不应因不正确的投影或边界耦合而产生伪分量 ($j\\neq k$)。可以通过比较出流特征能量与入流特征能量来量化反射；在精确的无反射情况下，反射分量为零。\n\n多模态叠加测试：对于\n$$\nq(x,0)=r_1\\,\\phi_\\sigma(x-x_1)+r_3\\,\\phi_\\sigma(x-x_3),\n$$\n我们有 $w(x,0)=e_1\\,\\phi_\\sigma(x-x_1)+e_3\\,\\phi_\\sigma(x-x_3)$。每个波包独立演化为 $r_1\\,\\phi_\\sigma(x-x_1-\\lambda_1 t)$ 和 $r_3\\,\\phi_\\sigma(x-x_3-\\lambda_3 t)$，可能会在时空中交叉。线性意味着不应产生交叉模态的能量；因此 $w_2$ 应保持为零，而 $w_1,w_3$ 应被独立输运。这探查了相互作用波之间的投影和重构，以及跨越不同符号的迎风分裂。\n\n零速持久性测试：对于 $\\lambda_2=0$，初始化 $q(x,0)=r_2\\,\\phi_\\sigma(x)$ 会得到 $w_2(x,t)=\\phi_\\sigma(x)$，即在时间上是平稳的。任何观察到的漂移都表明在投影（模态混合）或零速模态的通量分裂逻辑中存在错误。\n\n在反转的空间方向下重复测试（例如，将右行波包放在 $x=\\ell$ 附近，将左行波包放在 $x=0$ 附近）进一步证实了迎风格式能根据 $\\lambda_k$ 的符号正确切换。总而言之，选项A系统地从初始数据和边界数据中隔离出单个模态，并组合模态以验证叠加原理，直接测试了三个目标方面。因此，选项A是充分且可靠的。\n\n选项B：单次使用周期性边界的随机模拟不能隔离特征模态。原始变量中的随机初始条件会产生未知的模态混合，因此投影中的错误可能会被偶然的抵消所掩盖。周期性边界排除了测试基于特征的边界处理的可能性，因为这种处理需要在 $x=0$ 和 $x=\\ell$ 处指定入流与出流分量。此外，从探测点的时间谱推断速度无法检测到细微但关键的问题，如小的伪反射或交叉模态污染。因此，选项B不足以独立验证投影、迎风和边界处理。结论——不正确。\n\n选项C：原始变量上的齐次狄利克雷边界条件不对应于无反射特征边界条件，除非 $R$ 和 $L$ 恰好是单位矩阵，而通常情况并非如此。这种狄利克雷条件通常通过在边界处耦合入流和出流特征来产生反射。阶跃初始数据以非隔离的方式同时激发所有模态，使得无法将观察到的行为归因于特定模态或评估投影的准确性。总变差的衰减和有界性对于判断特征投影或迎风选择的正确性没有区分度。边界处理无法验证，因为边界指定不是基于特征的。结论——不正确。\n\n选项D：用原始变量中的典范基向量 $e_i$ 进行初始化会激发特征模态的混合，因为通常情况下，$e_i$ 是右特征向量 $r_k$ 的线性组合。周期性边界再次排除了测试边界条件的可能性。虽然总体上可以观察到线性叠加，但这并不能隔离单个特征分量，也无法验证迎风决策是针对每个特征场做出的。解的和的相等性是方程和数值方法线性的结果，但这并不能证实向 $w=L\\,q$ 的正确投影或根据 $\\lambda_k$ 符号进行的正确的基于面的迎风处理。边界处理仍未被测试。结论——不正确。\n\n因此，只有选项A提供了一个全面且有科学依据的测试套件，能够在该有限体积法实现中独立地激发和验证单个及多个特征模态、迎风处理和边界处理。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "这项综合性实践将指导您构建一个功能强大的代码验证工具——精确解生成器。通过将特征分解理论与傅里叶分析相结合，您可以为一个线性双曲系统生成任意时刻的精确解。这个练习不仅能让您实践核心理论，还能让您掌握一种定量评估和验证高阶数值格式准确性的黄金标准方法。",
            "id": "3369531",
            "problem": "考虑一维空间上具有周期性边界条件的常系数线性双曲系统，\n$$\n\\partial_t \\mathbf{u}(x,t) + A\\,\\partial_x \\mathbf{u}(x,t) = \\mathbf{0}, \\quad x \\in [0,L), \\quad t \\ge 0,\n$$\n其中 $\\mathbf{u}(x,t) \\in \\mathbb{R}^m$, $A \\in \\mathbb{R}^{m \\times m}$ 是一个常数矩阵， $L0$ 是定义域长度。当 $A$ 具有实数特征值和一组完备的特征向量时，该系统是双曲的。令 $R \\in \\mathbb{R}^{m \\times m}$ 表示右特征向量矩阵，$\\Lambda = \\mathrm{diag}(\\lambda_1,\\dots,\\lambda_m) \\in \\mathbb{R}^{m \\times m}$ 表示特征值构成的对角矩阵，使得 $A = R \\Lambda R^{-1}$。引入特征变量 $\\boldsymbol{\\alpha}(x,t) = L^\\top \\mathbf{u}(x,t)$，其中 $L^\\top = R^{-1}$。\n\n仅使用以下基本事实：(i) 线性系统满足叠加原理，(ii) 双曲性意味着系统可以对角化为独立的特征族，以及 (iii) 对于周期性定义域，傅里叶级数将线性常系数空间导数逐模式解耦。基于这些事实，推导出一个能够为该系统生成精确解的表示方法，该方法通过每个特征场的平流速度在时间上推进它，并从特征变量重构 $\\mathbf{u}(x,t)$。您的程序必须通过将特征分解与快速傅里叶变换（FFT）相结合，在 $[0,L)$ 上实现周期性平移，从而以数值上精确的方式为三角函数初始数据实现此表示。\n\n此外，为了在多个波族上验证高阶方法的有效性，请使用标准的中心5点模板为 $\\partial_x$ 实现一个四阶精度的空间离散化，并结合经典的四阶段四阶 Runge–Kutta 时间积分器。根据最大波速的绝对值，使用 Courant–Friedrichs–Lewy (CFL) 步长限制。通过将数值解与基于特征-傅里叶表示构造的精确解生成器进行比较，计算在指定最终时间的相对 $\\ell^2$ 误差。\n\n空间定义域是周期性的， $L = 2\\pi$，由 $N$ 个均匀分布的点离散化，其中 $N = 256$。对于每次测试，通过以下公式确定时间步长 $\\Delta t$：\n$$\n\\Delta t = \\mathrm{CFL}\\,\\frac{\\Delta x}{\\max_j|\\lambda_j|}, \\quad \\Delta x = L/N,\n$$\n使用 $\\mathrm{CFL} = 0.3$，并通过取 $n$ 个相等的步长，使得 $n\\,\\Delta t = T$（取 $n$ 为满足 $n \\ge T/\\Delta t$ 的最小正整数，然后重置 $\\Delta t \\leftarrow T/n$），精确地积分到指定的最终时间。\n\n您的程序必须实现以下三个测试用例。在每个用例中，通过 $A = R \\Lambda R^{-1}$ 构造 $A$，定义特征初始数据 $\\alpha_j(x)$，然后设置 $\\mathbf{u}(x,0) = R\\,\\boldsymbol{\\alpha}(x)$，其中 $\\boldsymbol{\\alpha}(x) = (\\alpha_1(x),\\dots,\\alpha_m(x))^\\top$。演化至时间 $T$。\n\n- 测试 $\\#1$（双波声学型系统）：\n  - $m = 2$, $R = \\begin{bmatrix}1  1\\\\ 1  -1\\end{bmatrix}$, $\\Lambda = \\mathrm{diag}(1,-1)$。\n  - $\\alpha_1(x) = \\sin(3x) + 0.5\\cos(5x)$, $\\alpha_2(x) = 0.3\\cos(2x) - 0.4\\sin(4x)$。\n  - $T = 0.7$。\n\n- 测试 $\\#2$（包含一个静止族的三波系统）：\n  - $m = 3$, $R = \\begin{bmatrix}1  1  0\\\\ 0  1  1\\\\ 1  0  1\\end{bmatrix}$, $\\Lambda = \\mathrm{diag}(-2,0,3)$。\n  - $\\alpha_1(x) = 0.8\\sin(2x) + 0.2\\cos(7x)$, $\\alpha_2(x) = 0.5\\sin(5x)$, $\\alpha_3(x) = 0.4\\cos(3x) - 0.1\\sin(9x)$。\n  - $T = 0.5$。\n\n- 测试 $\\#3$（具有重复速度但有完备特征基的三波系统）：\n  - $m = 3$, $R = \\begin{bmatrix}1  0  1\\\\ 0  1  1\\\\ 0  1  0\\end{bmatrix}$, $\\Lambda = \\mathrm{diag}(1,1,-0.5)$。\n  - $\\alpha_1(x) = \\sin(x) + 0.25\\cos(4x)$, $\\alpha_2(x) = 0.6\\cos(6x)$, $\\alpha_3(x) = 0.3\\sin(3x) - 0.2\\cos(8x)$。\n  - $T = 1.1$。\n\n定义和所需计算：\n- 精确解生成器必须实现特征投影 $\\boldsymbol{\\alpha}(x,0) = L^\\top \\mathbf{u}(x,0)$，使用其傅里叶级数将每个 $\\alpha_j$ 以速度 $\\lambda_j$ 进行周期性平移推进，并重构 $\\mathbf{u}(x,T) = R\\,\\boldsymbol{\\alpha}(x,T)$。\n- 高阶数值格式必须通过四阶中心模板离散化 $\\partial_x$：\n  $$\n  (\\partial_x f)(x_i) \\approx \\frac{-f_{i+2} + 8 f_{i+1} - 8 f_{i-1} + f_{i-2}}{12\\,\\Delta x},\n  $$\n  该模板逐分量应用，并采用周期性索引，时间上则使用经典的四阶段四阶 Runge–Kutta 方法对半离散系统 $\\partial_t \\mathbf{u}_h = -A\\,\\partial_x \\mathbf{u}_h$ 进行推进。\n\n对于每次测试，报告在时间 $T$ 的相对 $\\ell^2$ 误差，\n$$\n\\varepsilon = \\frac{\\left(\\sum_{i=0}^{N-1} \\|\\mathbf{u}_h(x_i,T) - \\mathbf{u}_{\\mathrm{exact}}(x_i,T)\\|_2^2 \\,\\Delta x\\right)^{1/2}}{\\left(\\sum_{i=0}^{N-1} \\|\\mathbf{u}_{\\mathrm{exact}}(x_i,T)\\|_2^2 \\,\\Delta x\\right)^{1/2}},\n$$\n其中 $\\|\\cdot\\|_2$ 是 $\\mathbb{R}^m$ 中的欧几里得范数。\n\n最终输出格式：\n- 您的程序应生成一行输出，包含测试 $\\#1$、$\\#2$ 和 $\\#3$ 的三个相对误差，形式为用方括号括起来的逗号分隔列表（例如，$[\\varepsilon_1,\\varepsilon_2,\\varepsilon_3]$）。所有量均为无量纲，不涉及单位。",
            "solution": "该问题要求解一个在周期性定义域 $x \\in [0,L)$ 上的一维常系数线性双曲系统 $\\partial_t \\mathbf{u}(x,t) + A\\,\\partial_x \\mathbf{u}(x,t) = \\mathbf{0}$。我们需要开发两种求解方法：一种是基于特征分解和傅里叶变换的精确解生成器，另一种是使用有限差分和 Runge-Kutta 积分器的高阶数值格式。最后，我们必须为三个指定的测试用例计算这两种解之间的相对 $\\ell^2$ 误差。\n\n### 1. 特征分解\n\n求解此系统的核心在于其双曲性，这一性质保证了矩阵 $A$ 可被对角化且具有实数特征值。这意味着存在一个可逆矩阵 $R$（其列是 $A$ 的右特征向量）和一个由相应实数特征值 $\\lambda_j$ 构成的对角矩阵 $\\Lambda$，使得 $A = R \\Lambda R^{-1}$。\n\n我们可以利用此性质来解耦这个包含 $m$ 个偏微分方程（PDE）的系统。让我们通过变换 $\\mathbf{u}(x,t) = R\\,\\boldsymbol{\\alpha}(x,t)$ 来定义特征变量 $\\boldsymbol{\\alpha}(x,t)$。因此，$\\boldsymbol{\\alpha}(x,t) = R^{-1}\\,\\mathbf{u}(x,t)$。将此代入原始的 PDE 系统中得到：\n$$\n\\partial_t (R\\,\\boldsymbol{\\alpha}) + A\\,\\partial_x (R\\,\\boldsymbol{\\alpha}) = \\mathbf{0}\n$$\n由于 $R$ 是一个常数矩阵，它可以从导数中提出：\n$$\nR\\,\\partial_t \\boldsymbol{\\alpha} + (R \\Lambda R^{-1})\\,R\\,\\partial_x \\boldsymbol{\\alpha} = \\mathbf{0}\n$$\n$$\nR\\,\\partial_t \\boldsymbol{\\alpha} + R \\Lambda\\,\\partial_x \\boldsymbol{\\alpha} = \\mathbf{0}\n$$\n从左侧乘以 $R^{-1}$（由于 $A$ 是可对角化的，所以 $R^{-1}$ 存在），我们得到了一个关于特征变量 $\\boldsymbol{\\alpha}$ 的解耦系统：\n$$\n\\partial_t \\boldsymbol{\\alpha} + \\Lambda\\,\\partial_x \\boldsymbol{\\alpha} = \\mathbf{0}\n$$\n因为 $\\Lambda$ 是一个对角矩阵，$\\Lambda = \\mathrm{diag}(\\lambda_1, \\dots, \\lambda_m)$，这个向量方程代表了 $m$ 个独立的标量平流方程：\n$$\n\\partial_t \\alpha_j + \\lambda_j\\,\\partial_x \\alpha_j = 0, \\quad \\text{for } j = 1, \\dots, m\n$$\n每个方程描述了一个波，或称特征场 $\\alpha_j(x,t)$，它以恒定速度 $\\lambda_j$ 传播（平流），而其形状保持不变。\n\n### 2. 通过傅里叶变换求解精确解\n\n标量平流方程 $\\partial_t f + c\\,\\partial_x f = 0$ 的解是初始剖面的简单平移：$f(x,t) = f(x - c t, 0)$。因此，每个特征变量的精确解为：\n$$\n\\alpha_j(x,t) = \\alpha_j(x - \\lambda_j t, 0)\n$$\n对于区间 $[0,L)$ 上的周期函数，这种平移可以使用傅里叶变换高效且无数值误差地执行。函数 $f(x)$ 的傅里叶级数为 $f(x) = \\sum_k \\hat{f}_k e^{i k_x x}$，其中 $k_x = 2\\pi k/L$ 是波数。傅里叶变换的平移性质指出，实空间中的位移对应于傅里叶空间中的相位调制：\n$$\nf(x - d) \\quad \\longleftrightarrow \\quad \\hat{f}_k e^{-i k_x d}\n$$\n这为在任意时间 $T$ 生成精确解提供了一个方法：\n1.  **构造初始数据**：每个测试用例都给定了特征变量的初始条件 $\\boldsymbol{\\alpha}(x,0)$。\n2.  **在傅里叶空间中演化**：对于每个分量 $\\alpha_j(x,0)$：\n    a.  使用快速傅里叶变换（FFT）算法计算其离散傅里叶变换（DFT），得到对应于一组离散波数 $k_n$ 的系数 $\\hat{\\alpha}_j(k_n, 0)$。\n    b.  将每个系数乘以相应的相位因子 $e^{-i k_n \\lambda_j T}$，以获得在时间 $T$ 的傅里叶系数：$\\hat{\\alpha}_j(k_n, T) = \\hat{\\alpha}_j(k_n, 0) e^{-i k_n \\lambda_j T}$。\n    c.  计算 $\\hat{\\alpha}_j(k_n, T)$ 的逆离散傅里叶变换（IFFT），以在物理空间中恢复平移后的特征剖面 $\\alpha_j(x,T)$。\n3.  **重构物理变量**：结合演化后的特征变量，使用关系式 $\\mathbf{u}(x,T) = R\\,\\boldsymbol{\\alpha}(x,T)$ 来找到 $\\mathbf{u}(x,T)$ 的最终解。\n\n此过程是“精确的”，因为它避免了时间步进误差和空间离散化误差，其精度仅受限于浮点运算。\n\n### 3. 高阶数值解法\n\n数值解是通过在空间和时间上对 PDE 系统进行离散化来计算的。\n半离散系统为 $\\frac{d}{dt}\\mathbf{u}_h(t) = -A (\\partial_x \\mathbf{u}_h)(t)$，其中 $\\mathbf{u}_h$ 代表空间网格上的解。\n\n**空间离散化**：空间导数 $\\partial_x$ 在均匀网格 $x_i = i\\,\\Delta x$（$i=0,\\dots,N-1$, $\\Delta x = L/N$）上使用一个四阶精度的5点中心有限差分模板来近似。对于一个网格函数 $f_i = f(x_i)$，其导数近似为：\n$$\n(\\partial_x f)(x_i) \\approx \\frac{-f_{i+2} + 8 f_{i+1} - 8 f_{i-1} + f_{i-2}}{12\\,\\Delta x}\n$$\n周期性边界条件通过模 $N$ 的索引算术来处理。此算子逐分量地应用于向量 $\\mathbf{u}_h(x_i, t)$。\n\n**时间积分**：我们求解得到的常微分方程（ODE）组 $\\frac{d}{dt}\\mathbf{U}(t) = \\mathcal{F}(\\mathbf{U}(t))$，其中 $\\mathbf{U}$ 是拼接所有 $\\mathbf{u}_h(x_i, t)$ 的大状态向量，$\\mathcal{F}$ 代表半离散化的右端项 $-A \\cdot (\\text{模板算子})$。积分使用经典的四阶段四阶 Runge-Kutta (RK4) 方法。对于从时间 $t_n$ 到 $t_{n+1} = t_n + \\Delta t$ 的单步积分：\n$$\n\\begin{aligned}\n\\mathbf{k}_1 = \\mathcal{F}(\\mathbf{U}(t_n)) \\\\\n\\mathbf{k}_2 = \\mathcal{F}(\\mathbf{U}(t_n) + \\frac{\\Delta t}{2} \\mathbf{k}_1) \\\\\n\\mathbf{k}_3 = \\mathcal{F}(\\mathbf{U}(t_n) + \\frac{\\Delta t}{2} \\mathbf{k}_2) \\\\\n\\mathbf{k}_4 = \\mathcal{F}(\\mathbf{U}(t_n) + \\Delta t \\mathbf{k}_3) \\\\\n\\mathbf{U}(t_{n+1}) = \\mathbf{U}(t_n) + \\frac{\\Delta t}{6} (\\mathbf{k}_1 + 2\\mathbf{k}_2 + 2\\mathbf{k}_3 + \\mathbf{k}_4)\n\\end{aligned}\n$$\n时间步长 $\\Delta t$ 根据 CFL 条件 $\\Delta t = \\mathrm{CFL}\\,\\frac{\\Delta x}{\\max_j|\\lambda_j|}$ 来选择，以确保稳定性。为了精确达到最终时间 $T$，我们找到满足 $n\\,\\Delta t \\ge T$ 的最小整数步数 $n$，然后将时间步长调整为 $\\Delta t' = T/n$。\n\n### 4. 误差计算\n\n在最终时间 $T$ 于网格点 $x_i$ 上计算出精确解 $\\mathbf{u}_{\\mathrm{exact}}(x_i, T)$ 和数值解 $\\mathbf{u}_h(x_i, T)$ 后，计算相对 $\\ell^2$ 误差。向量值网格函数 $\\mathbf{v}(x_i)$ 的离散 $\\ell^2$ 范数为 $\\|\\mathbf{v}\\|_{\\ell^2} = \\left(\\sum_{i=0}^{N-1} \\|\\mathbf{v}(x_i)\\|_2^2 \\,\\Delta x\\right)^{1/2}$，其中 $\\|\\cdot\\|_2$ 是 $\\mathbb{R}^m$ 中的标准欧几里得向量范数。相对误差则为：\n$$\n\\varepsilon = \\frac{\\|\\mathbf{u}_h - \\mathbf{u}_{\\mathrm{exact}}\\|_{\\ell^2}}{\\|\\mathbf{u}_{\\mathrm{exact}}\\|_{\\ell^2}} = \\frac{\\left(\\sum_{i=0}^{N-1} \\|\\mathbf{u}_h(x_i,T) - \\mathbf{u}_{\\mathrm{exact}}(x_i,T)\\|_2^2 \\,\\Delta x\\right)^{1/2}}{\\left(\\sum_{i=0}^{N-1} \\|\\mathbf{u}_{\\mathrm{exact}}(x_i,T)\\|_2^2 \\,\\Delta x\\right)^{1/2}}\n$$\n该度量通过将其输出与由特征-傅里叶方法生成的真解进行比较，来量化数值格式的准确性。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef run_test_case(m, R, Lambda, alpha_funcs, T, N, CFL):\n    \"\"\"\n    Solves a linear hyperbolic system for a single test case.\n\n    This function performs the following steps:\n    1. Sets up the spatial grid and system matrices.\n    2. Constructs the initial condition u(x, 0) from the given characteristic data.\n    3. Computes the \"exact\" solution at time T using characteristic decomposition\n       and the Fast Fourier Transform (FFT) for periodic translation.\n    4. Computes the numerical solution at time T using a 4th-order finite\n       difference scheme for space and the classical 4th-order Runge-Kutta\n       method for time.\n    5. Calculates the relative l2 error between the numerical and exact solutions.\n    \"\"\"\n    # 1. Setup\n    L = 2.0 * np.pi\n    dx = L / N\n    x = np.linspace(0, L, N, endpoint=False)\n    \n    R = np.array(R, dtype=float)\n    Lambda = np.diag(Lambda)\n    A = R @ Lambda @ np.linalg.inv(R)\n\n    # 2. Initial Condition\n    alpha_initial = np.zeros((N, m))\n    for j in range(m):\n        alpha_initial[:, j] = alpha_funcs[j](x)\n    u0 = alpha_initial @ R.T\n\n    # 3. Exact Solution Generator at Time T\n    k = 2 * np.pi * np.fft.fftfreq(N, d=dx)\n    alpha_final = np.zeros_like(alpha_initial, dtype=complex)\n    for j in range(m):\n        alpha_j_0_hat = np.fft.fft(alpha_initial[:, j])\n        lambda_j = Lambda[j, j]\n        phase_shift = np.exp(-1j * k * lambda_j * T)\n        alpha_j_T_hat = alpha_j_0_hat * phase_shift\n        alpha_final[:, j] = np.fft.ifft(alpha_j_T_hat)\n    \n    # The result should be real; take the real part to discard small imaginary noise\n    u_exact_T = (alpha_final @ R.T).real\n\n    # 4. Numerical Solution\n    \n    # Spatial derivative function (4th-order centered difference)\n    def spatial_derivative(u, dx_val):\n        # np.roll implements periodic boundary conditions\n        du_dx = (\n            -np.roll(u, -2, axis=0) + 8 * np.roll(u, -1, axis=0)\n            - 8 * np.roll(u, 1, axis=0) + np.roll(u, 2, axis=0)\n        ) / (12 * dx_val)\n        return du_dx\n\n    # RHS of the semi-discrete system: d_t u = -A * d_x u\n    def rhs(u, dx_val, A_mat):\n        du_dx = spatial_derivative(u, dx_val)\n        # Using u @ A.T is equivalent to (A @ u.T).T but can be more efficient\n        return - (du_dx @ A_mat.T)\n\n    # Time-stepping setup\n    lambda_max = np.max(np.abs(np.diag(Lambda)))\n    if lambda_max == 0: # Handle stationary wave case\n      dt_cfl = T # Avoid division by zero, take one large step\n    else:\n      dt_cfl = CFL * dx / lambda_max\n      \n    num_steps = int(np.ceil(T / dt_cfl))\n    dt = T / num_steps\n\n    # RK4 Integration\n    u_numerical = u0.copy()\n    for _ in range(num_steps):\n        k1 = rhs(u_numerical, dx, A)\n        k2 = rhs(u_numerical + dt/2 * k1, dx, A)\n        k3 = rhs(u_numerical + dt/2 * k2, dx, A)\n        k4 = rhs(u_numerical + dt * k3, dx, A)\n        u_numerical += dt/6 * (k1 + 2*k2 + 2*k3 + k4)\n\n    # 5. Error Calculation\n    diff = u_numerical - u_exact_T\n    \n    # Discrete l2 norm: sqrt(sum(|v_i|^2 * dx))\n    numerator_sq = np.sum(np.linalg.norm(diff, axis=1)**2) * dx\n    denominator_sq = np.sum(np.linalg.norm(u_exact_T, axis=1)**2) * dx\n    \n    if denominator_sq == 0:\n        return 0.0\n    \n    error = np.sqrt(numerator_sq / denominator_sq)\n    return error\n\ndef solve():\n    \"\"\"\n    Main function to define test cases and compute the errors.\n    \"\"\"\n    # Common parameters\n    N = 256\n    CFL = 0.3\n\n    test_cases = [\n        {\n            \"m\": 2, \"T\": 0.7,\n            \"R\": [[1, 1], [1, -1]],\n            \"Lambda\": [1, -1],\n            \"alpha_funcs\": [\n                lambda x: np.sin(3*x) + 0.5*np.cos(5*x),\n                lambda x: 0.3*np.cos(2*x) - 0.4*np.sin(4*x)\n            ]\n        },\n        {\n            \"m\": 3, \"T\": 0.5,\n            \"R\": [[1, 1, 0], [0, 1, 1], [1, 0, 1]],\n            \"Lambda\": [-2, 0, 3],\n            \"alpha_funcs\": [\n                lambda x: 0.8*np.sin(2*x) + 0.2*np.cos(7*x),\n                lambda x: 0.5*np.sin(5*x),\n                lambda x: 0.4*np.cos(3*x) - 0.1*np.sin(9*x)\n            ]\n        },\n        {\n            \"m\": 3, \"T\": 1.1,\n            \"R\": [[1, 0, 1], [0, 1, 1], [0, 1, 0]],\n            \"Lambda\": [1, 1, -0.5],\n            \"alpha_funcs\": [\n                lambda x: np.sin(x) + 0.25*np.cos(4*x),\n                lambda x: 0.6*np.cos(6*x),\n                lambda x: 0.3*np.sin(3*x) - 0.2*np.cos(8*x)\n            ]\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        error = run_test_case(\n            m=case[\"m\"],\n            R=case[\"R\"],\n            Lambda=case[\"Lambda\"],\n            alpha_funcs=case[\"alpha_funcs\"],\n            T=case[\"T\"],\n            N=N,\n            CFL=CFL\n        )\n        results.append(f\"{error:.16e}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}