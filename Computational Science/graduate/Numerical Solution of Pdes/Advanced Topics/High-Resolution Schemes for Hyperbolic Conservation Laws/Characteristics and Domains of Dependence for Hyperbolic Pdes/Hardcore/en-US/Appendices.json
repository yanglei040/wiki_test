{
    "hands_on_practices": [
        {
            "introduction": "The inviscid Burgers' equation serves as a fundamental prototype for nonlinear hyperbolic PDEs, where the wave speed depends on the solution itself. This dependence can cause characteristics to converge and intersect, leading to the breakdown of smooth solutions and the formation of shock waves. This exercise  provides direct practice with the method of characteristics to pinpoint the exact moment and location of this breakdown, a critical skill for analyzing the behavior of conservation laws.",
            "id": "3369909",
            "problem": "Consider the scalar conservation law known as the inviscid Burgers' Partial Differential Equation (PDE),\n$$u_{t} + \\left(\\frac{u^{2}}{2}\\right)_{x} = 0 \\quad \\text{for} \\quad x \\in \\mathbb{R}, \\ t \\ge 0,$$\nwith smooth initial data\n$$u(x,0) = u_{0}(x) = -A \\tanh(K x),$$\nwhere $A0$ and $K0$ are constants. Using the method of characteristics as the context-appropriate fundamental base, justify the relationship between the domain of dependence of a point $(x,t)$ and the characteristic flow, and then determine the earliest time $t_{s}0$ at which the classical solution loses regularity due to characteristic intersection (shock formation). Provide $t_{s}$ in closed form in terms of $A$ and $K$. The final answer must be a single analytic expression. No rounding is required.",
            "solution": "The problem is to analyze the solution to the inviscid Burgers' equation, a scalar conservation law, and determine the time of shock formation for a specific initial condition.\n\nThe governing Partial Differential Equation (PDE) is:\n$$u_{t} + \\left(\\frac{u^{2}}{2}\\right)_{x} = 0 \\quad \\text{for} \\quad x \\in \\mathbb{R}, \\ t \\ge 0$$\nUsing the chain rule, we can write the flux term as $(\\frac{u^2}{2})_x = \\frac{d}{du}(\\frac{u^2}{2}) \\frac{\\partial u}{\\partial x} = u u_x$. This transforms the PDE into its quasilinear form:\n$$u_{t} + u u_{x} = 0$$\nThe initial condition is given as a smooth function:\n$$u(x,0) = u_{0}(x) = -A \\tanh(K x)$$\nwhere $A$ and $K$ are positive constants, $A0$ and $K0$.\n\nThe method of characteristics is the fundamental tool for solving such first-order hyperbolic PDEs. The quasilinear form $u_t + c(u) u_x = 0$, where here the wave speed is $c(u) = u$, states that the total derivative of $u$ with respect to time along curves defined by $\\frac{dx}{dt} = c(u)$ is zero. That is,\n$$\\frac{d}{dt} u(x(t), t) = u_{t} + u_{x} \\frac{dx}{dt} = u_{t} + u u_{x} = 0$$\nThis implies that the solution $u$ is constant along the characteristic curves, which are defined by the ordinary differential equation $\\frac{dx}{dt} = u$.\nSince $u$ is constant along each characteristic, the speed of propagation for each characteristic is constant. Therefore, the characteristic curves are straight lines in the $(x,t)$-plane.\n\nLet a characteristic curve originate from a point $(x_0, 0)$ on the initial line. The value of the solution along this entire curve is fixed by the initial data at $x_0$, i.e., $u(x(t), t) = u(x_0, 0) = u_0(x_0)$. The equation for the characteristic line is then:\n$$\\frac{dx}{dt} = u_{0}(x_0)$$\nIntegrating this with respect to time from $0$ to $t$ yields the explicit equation for the characteristic line:\n$$x(t) = x_{0} + u_{0}(x_0) t$$\nThis equation implicitly defines the solution $u(x,t)$. To find the value of $u$ at a point $(x,t)$, one must solve the equation $x = x_0 + u_0(x_0) t$ for the starting point $x_0$. The solution is then $u(x,t) = u_0(x_0)$.\n\nThe domain of dependence of a point $(x,t)$ is the set of points on the initial data surface (at $t=0$) that influence the solution at $(x,t)$. From the characteristic equation, it is evident that the solution $u(x,t)$ is determined exclusively by the value of the initial data at the single point $x_0$ which is the foot of the characteristic passing through $(x,t)$. Therefore, for this first-order hyperbolic problem, the domain of dependence of $(x,t)$ is the single point set $\\{x_0\\}$ on the initial line $t=0$.\n\nA classical solution exists as long as the mapping from $x_0$ to $x$ at a given time $t$ is one-to-one. This fails when characteristics intersect, leading to a multi-valued solution, which is physically impossible. This breakdown of the classical solution is known as shock formation.\nAn intersection occurs when two distinct characteristics, starting from $x_{0,1}$ and $x_{0,2}$, meet at the same point $(x,t)$. For infinitesimally close characteristics starting at $x_0$ and $x_0 + dx_0$, their intersection time $t$ can be found by setting their positions equal:\n$$x_0 + u_0(x_0)t = (x_0 + dx_0) + u_0(x_0 + dx_0)t$$\nRearranging gives:\n$$[u_0(x_0) - u_0(x_0 + dx_0)]t = dx_0$$\n$$t = \\frac{dx_0}{u_0(x_0) - u_0(x_0 + dx_0)} = -\\frac{1}{\\frac{u_0(x_0 + dx_0) - u_0(x_0)}{dx_0}}$$\nTaking the limit as $dx_0 \\to 0$, the time to intersection for characteristics originating from the neighborhood of $x_0$ is:\n$$t(x_0) = -\\frac{1}{u_0'(x_0)}$$\nA shock can only form for $t0$, which requires that $u_0'(x_0)  0$. This condition signifies that characteristics are converging: a characteristic starting at a slightly larger initial position $x_0+dx_0$ has a smaller (or more negative) velocity $u_0(x_0+dx_0)$ than the characteristic starting at $x_0$, causing them to approach each other.\n\nThe first time a shock appears, denoted by $t_s$, is the minimum of these intersection times over all possible starting points $x_0$ where the derivative is negative:\n$$t_{s} = \\min_{x_0 : u_{0}'(x_0)0} \\left( -\\frac{1}{u_{0}'(x_0)} \\right)$$\nThis is equivalent to finding the overall minimum of $u_0'(x_0)$, as minimizing the positive quantity $-\\frac{1}{u_0'(x_0)}$ is the same as maximizing the denominator $u_0'(x_0)$ (i.e., making it as \"least negative\" as possible) or minimizing the positive quantity $|u_0'(x_0)|$. Let's recheck this. We want to find the smallest positive $t$. This means we want the largest negative value for $u_0'(x_0)$. So we need to find the minimum of $u_0'(x_0)$.\n$$t_s = \\frac{-1}{\\min_{x_0 \\in \\mathbb{R}} u_{0}'(x_0)}$$\nWe are given the initial condition $u_{0}(x) = -A \\tanh(K x)$. We must compute its derivative, $u_0'(x)$.\n$$u_{0}'(x) = \\frac{d}{dx} \\left( -A \\tanh(K x) \\right)$$\nUsing the chain rule and the fact that $\\frac{d}{dz}\\tanh(z) = \\operatorname{sech}^2(z)$, we get:\n$$u_{0}'(x) = -A \\cdot (\\operatorname{sech}^2(K x)) \\cdot K = -AK \\operatorname{sech}^2(K x)$$\nSince $A0$ and $K0$, the product $-AK$ is negative. The function $\\operatorname{sech}^2(y)$ is always non-negative. Therefore, $u_0'(x) \\le 0$ for all $x \\in \\mathbb{R}$, which confirms that characteristics are always converging or are parallel (at infinity).\nTo find the shock time $t_s$, we must find the minimum value of $u_0'(x)$. The minimum of $u_0'(x)$ will occur when the positive term $\\operatorname{sech}^2(Kx)$ is at its maximum.\nThe hyperbolic secant function, $\\operatorname{sech}(z) = \\frac{1}{\\cosh(z)}$, has its maximum value when $\\cosh(z)$ is at its minimum. The minimum value of $\\cosh(z)$ is $1$, which occurs at $z=0$.\nThus, the maximum value of $\\operatorname{sech}(Kx)$ is $1$, occurring at $Kx=0$, or $x=0$. The maximum value of $\\operatorname{sech}^2(Kx)$ is also $1$, occurring at $x=0$.\nThe minimum value of the derivative is therefore:\n$$\\min_{x \\in \\mathbb{R}} u_{0}'(x) = -AK \\cdot \\max_{x \\in \\mathbb{R}}(\\operatorname{sech}^2(K x)) = -AK \\cdot 1 = -AK$$\nThis minimum occurs at $x_0=0$. This is the point of steepest negative slope in the initial profile, where the rate of convergence of characteristics is highest.\n\nSubstituting this minimum value into the formula for the shock formation time:\n$$t_{s} = \\frac{-1}{\\min_{x_0 \\in \\mathbb{R}} u_{0}'(x_0)} = \\frac{-1}{-AK} = \\frac{1}{AK}$$\nSince $A0$ and $K0$, the shock time $t_s$ is positive, as expected.",
            "answer": "$$\\boxed{\\frac{1}{AK}}$$"
        },
        {
            "introduction": "Building on the concept of characteristic breakdown, this practice explores what happens *after* the initial shock formation time. The method of characteristics, when formally extended, predicts an unphysical, multivalued solution, which motivates the need for a more general framework of \"weak solutions.\" This exercise  guides you through deriving the Rankine-Hugoniot shock speed condition from the underlying integral conservation law, providing a deep understanding of the dynamics that govern physical discontinuities.",
            "id": "3369982",
            "problem": "Consider the scalar conservation law $u_{t} + f(u)_{x} = 0$ on the periodic domain $x \\in [0, 2\\pi]$ with $t \\geq 0$, where the flux $f$ is strictly convex, twice continuously differentiable, and has continuous third derivative, i.e., $f \\in C^{3}(\\mathbb{R})$ with $f''(u)  0$ for all $u \\in \\mathbb{R}$. Let the initial data be $u(x,0) = u_{0}(x) = -\\sin(x)$.\n\nStarting from the method of characteristics for quasilinear first-order partial differential equations, carry out the following steps:\n\n1. Derive the characteristic ordinary differential equations and the characteristic representation for the solution $u(x,t)$ in terms of the Lagrangian label $a \\in [0,2\\pi]$. Write the characteristic map $x(a,t)$ and the Jacobian $\\partial x / \\partial a$ in terms of $u_{0}$ and $f$.\n\n2. Specialize to the inviscid Burgers flux $f(u) = \\tfrac{1}{2}u^{2}$ and determine the first breaking time $t_{b}$ at which characteristics first lose injectivity. Base your derivation only on the characteristic map and its Jacobian, together with the strict convexity of the flux. Explain how the domain of dependence changes at $t = t_{b}$ and how the characteristic prediction becomes multivalued for $t  t_{b}$.\n\n3. For a time $t_{*}  t_{b}$, characterize the set of Lagrangian labels $a$ that map to a fixed Eulerian position $x_{*} \\in [0,2\\pi]$ via the characteristic relation. Describe how this produces a multivalued envelope for the characteristic prediction $u_{\\mathrm{char}}(x_{*}, t_{*})$, and identify the left and right states $u_{L}$ and $u_{R}$ as the values of $u_{0}$ transported along the two outer branches of the multivalued characteristic set at $(x_{*}, t_{*})$.\n\n4. Using only conservation principles across a moving discontinuity and the strict convexity of $f$, derive the analytic expression for the speed $s(t_{*})$ of the entropy-satisfying shock that replaces the multivalued envelope at $(x_{*}, t_{*})$.\n\nYour final answer must be a single closed-form analytic expression for $s(t_{*})$ in terms of $f$, $u_{L}$, and $u_{R}$. No units are associated with the answer. If you choose to present any approximations in intermediate steps, ensure all reasoning is symbolic; do not introduce numerical rounding. The boxed final answer must be the exact analytic expression.",
            "solution": "The given partial differential equation is a scalar conservation law, $u_{t} + f(u)_{x} = 0$. Using the chain rule, we can write $f(u)_{x} = f'(u) u_{x}$. This transforms the equation into its quasilinear form:\n$$\nu_{t} + f'(u) u_{x} = 0\n$$\nThis equation states that the total derivative of the solution $u$ is zero along curves, called characteristics, that satisfy the ordinary differential equation (ODE) $\\frac{dx}{dt} = f'(u)$.\n\n1. Derivation of Characteristic Equations and Representation\n\nThe method of characteristics solves this first-order PDE by converting it into a system of ODEs. Along a characteristic curve $x(t)$, the total derivative of the solution $u(x(t), t)$ is given by:\n$$\n\\frac{d}{dt}u(x(t), t) = u_{t} + u_{x} \\frac{dx}{dt}\n$$\nBy comparing this with the quasilinear PDE, we choose the characteristic curves to be those satisfying:\n$$\n\\frac{dx}{dt} = f'(u)\n$$\nAlong these curves, the PDE simplifies to:\n$$\n\\frac{du}{dt} = 0\n$$\nThese two ODEs form the characteristic system. The second equation, $\\frac{du}{dt} = 0$, implies that the solution $u$ is constant along each characteristic curve. We can parameterize these curves by their initial position at $t=0$, which we denote by the Lagrangian label $a \\in [0, 2\\pi]$. The value of $u$ along the characteristic originating at $a$ is thus fixed by the initial data:\n$$\nu(x(t), t) = u(x(0), 0) = u(a, 0) = u_{0}(a)\n$$\nSince $u$ is constant along a given characteristic, the characteristic speed $f'(u)$ is also constant along that same characteristic. The first ODE becomes:\n$$\n\\frac{dx}{dt} = f'(u_{0}(a))\n$$\nIntegrating this ODE with respect to time from $0$ to $t$, subject to the initial condition $x(0) = a$, yields the characteristic map $x(a,t)$:\n$$\n\\int_{x(0)}^{x(t)} d\\xi = \\int_{0}^{t} f'(u_{0}(a)) d\\tau\n$$\n$$\nx(t) - a = f'(u_{0}(a)) t\n$$\n$$\nx(a,t) = a + f'(u_{0}(a)) t\n$$\nThis is the characteristic map. The solution $u(x,t)$ is then given implicitly by the characteristic representation:\n$$\nu(x,t) = u_{0}(a) \\quad \\text{where} \\quad x = a + f'(u_{0}(a)) t\n$$\nThe Jacobian of the characteristic map, $\\frac{\\partial x}{\\partial a}$, measures how a small interval of initial positions evolves in time. It is found by differentiating $x(a,t)$ with respect to $a$:\n$$\n\\frac{\\partial x}{\\partial a} = \\frac{\\partial}{\\partial a} \\left[ a + f'(u_{0}(a)) t \\right]\n$$\n$$\n\\frac{\\partial x}{\\partial a} = 1 + \\frac{d}{da}[f'(u_{0}(a))] t\n$$\nUsing the chain rule, $\\frac{d}{da}[f'(u_{0}(a))] = f''(u_{0}(a)) u'_{0}(a)$. Substituting this into the expression for the Jacobian gives:\n$$\n\\frac{\\partial x}{\\partial a} = 1 + f''(u_{0}(a)) u'_{0}(a) t\n$$\n\n2. Breaking Time for the Inviscid Burgers Flux\n\nWe now specialize to the inviscid Burgers flux, $f(u) = \\frac{1}{2}u^{2}$, and the initial data $u_{0}(x) = -\\sin(x)$. The derivatives of the flux are $f'(u) = u$ and $f''(u) = 1$. The derivative of the initial data is $u'_{0}(x) = -\\cos(x)$.\nSubstituting these into the expression for the Jacobian:\n$$\n\\frac{\\partial x}{\\partial a} = 1 + (1) \\cdot (-\\cos(a)) \\cdot t = 1 - t\\cos(a)\n$$\nCharacteristics first lose injectivity, signaling the formation of a shock or a multivalued solution, at the first time $t  0$ when the Jacobian becomes zero. This time is known as the breaking time, $t_{b}$. We set the Jacobian to zero:\n$$\n1 - t\\cos(a) = 0 \\implies t = \\frac{1}{\\cos(a)}\n$$\nThe breaking time $t_{b}$ is the minimum positive time for which this condition can be met for some $a \\in [0, 2\\pi]$. This minimum is achieved when the denominator, $\\cos(a)$, is at its maximum positive value. The maximum value of $\\cos(a)$ is $1$, which occurs at $a=0$ and $a=2\\pi$.\n$$\nt_{b} = \\min_{a \\in [0, 2\\pi], \\cos(a)0} \\left( \\frac{1}{\\cos(a)} \\right) = \\frac{1}{\\max_{a \\in [0, 2\\pi]} (\\cos(a))} = \\frac{1}{1} = 1\n$$\nFor $t  t_{b}$, the Jacobian $\\frac{\\partial x}{\\partial a} = 1 - t\\cos(a)  0$ for all $a$, since $t  1$ implies $t\\cos(a)  1$. The map $a \\mapsto x(a,t)$ is therefore strictly monotonic and injective. This means that for any Eulerian position $(x,t)$, there is a unique characteristic originating from a single Lagrangian label $a$ that passes through it. The domain of dependence of the solution at $(x,t)$ is the single point $\\{a\\}$ on the initial data line.\nAt $t=t_{b}=1$, the Jacobian is zero at $a=0, 2\\pi$, and the map $a \\mapsto x(a,t)$ ceases to be globally injective.\nFor $t  t_{b}$, the term $t\\cos(a)$ can be greater than $1$, causing the Jacobian to become negative for a range of $a$. The map $a \\mapsto x(a,t)$ becomes non-monotonic. This breakdown of injectivity means that for a single Eulerian position $x$, multiple Lagrangian labels $a$ can satisfy the characteristic relation $x = x(a,t)$. Since each label $a$ carries its own constant value $u_{0}(a)$, the characteristic solution $u(x,t)$ becomes multivalued at such points. The domain of dependence of the physical, single-valued weak solution expands from a single point to an entire interval of initial data points.\n\n3. Multivalued Solution for $t_{*}  t_{b}$\n\nLet $t_{*}  t_{b} = 1$ be a fixed time. We characterize the set of Lagrangian labels $a$ that map to a fixed Eulerian position $x_{*} \\in [0, 2\\pi]$. These labels are the solutions to the equation:\n$$\nx_{*} = x(a, t_{*}) = a + u_{0}(a) t_{*} = a - t_{*} \\sin(a)\n$$\nLet's define the function $g(a) = a - t_{*} \\sin(a)$. We are seeking the roots of $g(a) = x_{*}$. The derivative is $g'(a) = 1 - t_{*} \\cos(a)$. Since $t_{*}  1$, there exists an interval of $a$ values for which $\\cos(a)  1/t_{*}$, making $g'(a)  0$. This non-monotonicity of $g(a)$ implies that for certain values of $x_{*}$, the equation $g(a) = x_{*}$ has multiple solutions. Typically for this type of problem, there will be an interval of $x_{*}$ values for which there are three solutions, say $a_{L}  a_{M}  a_{R}$.\nThis leads to a three-valued characteristic prediction for the solution at $(x_{*}, t_{*})$: $\\{ u_{0}(a_{L}), u_{0}(a_{M}), u_{0}(a_{R}) \\}$. The locus of these points $(x, u_{\\mathrm{char}}(x, t_{*}))$ forms a multivalued envelope that folds over itself.\nThe physical solution must be single-valued. A shock wave forms, replacing the unphysical multivalued region. An entropy condition dictates that the shock must connect the upper and lower branches of this envelope. The left state $u_{L}$ and right state $u_{R}$ defining the shock discontinuity at $(x_{*}, t_{*})$ are the values transported along the two outer branches of the multivalued characteristic set. These correspond to the minimum and maximum Lagrangian labels that map to $x_{*}$. Thus:\n$$\nu_{L} = u_{0}(a_{L}) \\quad \\text{and} \\quad u_{R} = u_{0}(a_{R})\n$$\nwhere $a_{L} = \\min\\{a \\mid x(a,t_{*}) = x_{*}\\}$ and $a_{R} = \\max\\{a \\mid x(a,t_{*}) = x_{*}\\}$.\n\n4. Derivation of the Shock Speed\n\nThe speed of the discontinuity is derived from the integral form of the conservation law, which must hold even for weak (non-differentiable) solutions. The law states that for any interval $[x_{1}, x_{2}]$, the rate of change of the total amount of the conserved quantity $U = \\int_{x_{1}}^{x_{2}} u(x,t) dx$ is equal to the net flux across the boundaries:\n$$\n\\frac{d}{dt} \\int_{x_{1}}^{x_{2}} u(x,t) dx = f(u(x_{1},t)) - f(u(x_{2},t))\n$$\nLet the shock be a curve $x=s(t)$ moving with speed $s(t_*) = \\frac{ds}{dt}|_{t=t_*}$. Let the states immediately to the left and right of the shock be $u_{L}$ and $u_{R}$, respectively. We apply the integral law to an infinitesimally small interval $[x_{1}, x_{2}] = [s(t)-\\epsilon, s(t)+\\epsilon]$ that moves with the shock, where $\\epsilon \\to 0$.\nThe right-hand side of the conservation law becomes:\n$$\n\\lim_{\\epsilon \\to 0} [f(u(s(t)-\\epsilon, t)) - f(u(s(t)+\\epsilon, t))] = f(u_{L}) - f(u_{R})\n$$\nFor the left-hand side, we apply the Leibniz integral rule for a time-dependent interval:\n$$\n\\frac{d}{dt} \\int_{s(t)-\\epsilon}^{s(t)+\\epsilon} u(x,t) dx = \\int_{s(t)-\\epsilon}^{s(t)+\\epsilon} u_{t}(x,t) dx + u(s(t)+\\epsilon, t) \\frac{d}{dt}(s(t)+\\epsilon) - u(s(t)-\\epsilon, t) \\frac{d}{dt}(s(t)-\\epsilon)\n$$\nAssuming $u_{t}$ is bounded, the integral term vanishes as $\\epsilon \\to 0$. The boundary terms become:\n$$\n\\lim_{\\epsilon \\to 0} \\left[ u_{R} \\cdot s'(t) - u_{L} \\cdot s'(t) \\right] = s'(t) (u_{R} - u_{L})\n$$\nEquating the two sides gives the jump condition:\n$$\ns'(t) (u_{R} - u_{L}) = f(u_{L}) - f(u_{R})\n$$\nSolving for the shock speed $s(t_*) = s'(t_*)$, we obtain the Rankine-Hugoniot condition:\n$$\ns(t_{*}) = \\frac{f(u_{L}) - f(u_{R})}{u_{L} - u_{R}}\n$$\nThis expression gives the speed of a discontinuity connecting states $u_L$ and $u_R$. The strict convexity of the flux $f(u)$ is crucial for the entropy condition, which selects the physically stable shock. For a convex flux, the entropy condition (specifically, the Lax shock condition $f'(u_L)  s  f'(u_R)$) simplifies to $u_L  u_R$. This ensures that characteristics impinge on the shock path, preventing the solution from spontaneously developing unphysical discontinuities. The derivation of the speed itself, however, relies only on the integral conservation principle.",
            "answer": "$$\n\\boxed{\\frac{f(u_{L}) - f(u_{R})}{u_{L} - u_{R}}}\n$$"
        },
        {
            "introduction": "The properties of continuous hyperbolic PDEs place fundamental constraints on any valid numerical approximation. This practice shifts our focus to the crucial link between the physical domain of dependence and its numerical counterpart. You will explore the Courant-Friedrichs-Lewy (CFL) condition not merely as a stability formula, but as a geometric necessity: for a scheme to be convergent, its grid must be able to \"see\" all the physical information required to determine the solution. This exercise  makes this abstract principle concrete by analyzing and comparing the numerical domains of dependence for different finite difference stencils.",
            "id": "3369972",
            "problem": "Consider the scalar linear hyperbolic partial differential equation $u_t + a\\,u_x = 0$ with constant characteristic speed $a \\in \\mathbb{R}$ on a uniform grid with spacing $\\Delta x  0$ and explicit time stepping with step size $\\Delta t  0$. The continuum domain of dependence of a point $(x_i, t_N)$ with $t_N = N\\,\\Delta t$ is the single point $(x_i - a\\,t_N, 0)$, determined by the characteristic curve $x(t) = x_i - a\\,t$. In a linear explicit finite-difference method, the numerical update can be written as\n$$\nu_i^{n+1} = \\sum_{s \\in \\mathcal{S}} \\alpha_s\\,u_{i+s}^n,\n$$\nwhere $\\mathcal{S}$ is the set of integer offsets defining the stencil and $\\alpha_s$ are method-dependent coefficients that satisfy consistency constraints. The numerical domain of dependence of $u_0^N$ is the set of all grid indices at time level $n=0$ whose values can influence $u_0^N$ by repeated application of the update relation for $N$ steps. This set is generated by all $N$-fold sums of elements of $\\mathcal{S}$, and its extremal indices after $N$ steps are\n$$\ni_{\\min}(N) = N\\,\\min(\\mathcal{S}),\\qquad i_{\\max}(N) = N\\,\\max(\\mathcal{S}).\n$$\nThe numerical influence envelope after $N$ steps is the spatial span from $i_{\\min}(N)$ to $i_{\\max}(N)$, whose physical width is\n$$\nW_{\\text{num}}(N) = \\left(i_{\\max}(N) - i_{\\min}(N)\\right)\\,\\Delta x.\n$$\nThe Courant–Friedrichs–Lewy (CFL) condition is the requirement that $\\Delta t \\le C\\,\\Delta x/\\max|\\lambda|$, where $\\lambda$ denotes the characteristic speeds of the hyperbolic system and $C$ is a method-dependent constant. For the scalar equation above, $\\max|\\lambda| = |a|$. Your task is to:\n- Derive from first principles how the CFL condition bounds the numerical domain of dependence, in the sense that the continuum domain-of-dependence point $(x_0 - a\\,t_N, 0)$ lies inside the numerical influence envelope whenever a scheme-dependent bound on $C$ is respected.\n- Construct and compare two explicit schemes with equal CFL parameter $C$ but different stencils:\n  1. A compact upwind stencil $\\mathcal{S}_{\\mathrm{c}} = \\{0,-1\\}$.\n  2. A wide upwind stencil $\\mathcal{S}_{\\mathrm{w}} = \\{0,-1,-2,-3\\}$.\n- For each scheme, quantify its effective numerical domain width $W_{\\text{num}}(N)$ after $N$ steps, and compare it to the continuum domain-of-dependence travel distance $D_{\\text{cont}}(N) = |a|\\,N\\,\\Delta t$.\n\nWork in non-dimensional units so that all quantities are pure numbers. Use the following test suite of parameter values, which explores a typical case, boundary conditions, and an edge case:\n1. $(a,\\Delta x,C,N) = (1.0,\\,1.0,\\,0.8,\\,10)$.\n2. $(a,\\Delta x,C,N) = (0.5,\\,0.5,\\,1.0,\\,1)$.\n3. $(a,\\Delta x,C,N) = (1.0,\\,1.0,\\,1.0,\\,5)$.\n4. $(a,\\Delta x,C,N) = (1.0,\\,1.0,\\,1.2,\\,5)$.\n5. $(a,\\Delta x,C,N) = (1.0,\\,1.0,\\,0.7,\\,0)$.\n\nFor each test case, compute:\n- The compact scheme width $W_{\\text{num,c}}(N)$.\n- The wide scheme width $W_{\\text{num,w}}(N)$.\n- The continuum travel distance $D_{\\text{cont}}(N)$.\n- A boolean flag for each scheme indicating whether the continuum domain-of-dependence location lies within that scheme’s numerical influence envelope (for $a0$, this reduces to checking if the left reach $R_{\\text{left}}(N) = -i_{\\min}(N)\\,\\Delta x$ satisfies $R_{\\text{left}}(N) \\ge D_{\\text{cont}}(N)$).\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each test case contributes an inner list in the form\n$$\n[W_{\\text{num,c}},W_{\\text{num,w}},D_{\\text{cont}},\\text{inside\\_compact},\\text{inside\\_wide}],\n$$\nand the final aggregated output must be a single list of these inner lists, with no spaces inside lists. For example, an output with two test cases would look like\n$$\n[[w_c^{(1)},w_w^{(1)},d^{(1)},b_c^{(1)},b_w^{(1)}],[w_c^{(2)},w_w^{(2)},d^{(2)},b_c^{(2)},b_w^{(2)}]].\n$$",
            "solution": "The problem requires a derivation of the relationship between the Courant-Friedrichs-Lewy (CFL) condition and the domain of dependence for a linear hyperbolic PDE, followed by a quantitative analysis of two specific finite-difference schemes.\n\n**1. Derivation of the Geometric CFL Condition**\n\nThe given partial differential equation (PDE) is the scalar linear advection equation:\n$$\nu_t + a\\,u_x = 0\n$$\nwhere $a \\in \\mathbb{R}$ is the constant characteristic speed. The characteristics are lines in the $(x,t)$ plane along which the solution $u$ is constant. They are defined by the ordinary differential equation $\\frac{dx}{dt} = a$. The solution is $x(t) = x(0) + a\\,t$. This means a signal at position $x(0)$ at time $t=0$ propagates to position $x(t)$ at time $t$.\n\nThe **continuum domain of dependence** of a point $(x_i, t_N)$ is the set of points at time $t=0$ that influence the solution at $(x_i, t_N)$. Following the characteristic backward in time from $(x_i, t_N)$, we find the influencing point at $t=0$ to be at position $x_0 = x_i - a\\,t_N$. The travel distance of the characteristic information over a time interval $t_N$ is $D_{\\text{cont}} = |a\\,t_N|$.\n\nA linear explicit finite-difference scheme approximates the solution on a grid with spacing $\\Delta x$ and time step $\\Delta t$. The update rule is given as:\n$$\nu_i^{n+1} = \\sum_{s \\in \\mathcal{S}} \\alpha_s\\,u_{i+s}^n\n$$\nwhere $\\mathcal{S}$ is the stencil. After one time step, the value at grid point $i$ depends on points in the set $\\{i+s \\mid s \\in \\mathcal{S}\\}$ at the previous time level. After $N$ steps, the value $u_i^N$ depends on the initial values $u_j^0$ where the index $j$ is in the range $[i + N\\min(\\mathcal{S}), i + N\\max(\\mathcal{S})]$.\n\nThe **numerical domain of dependence** of the point $(x_i, t_N)$ is the spatial interval at $t=0$ that contains all grid points influencing $u_i^N$. Relative to $x_i$, this interval is $[i_{\\min}(N)\\Delta x, i_{\\max}(N)\\Delta x]$, where $i_{\\min}(N) = N\\min(\\mathcal{S})$ and $i_{\\max}(N) = N\\max(\\mathcal{S})$. The width of this numerical influence envelope is $W_{\\text{num}}(N) = (i_{\\max}(N) - i_{\\min}(N))\\Delta x$.\n\nThe fundamental Courant-Friedrichs-Lewy (CFL) condition stipulates that for a convergent numerical scheme, the continuum domain of dependence must be contained within the numerical domain of dependence. For the point $(x_i, t_N)$, this means the physical point $x_i - a\\,t_N$ must lie within the physical interval $[x_i + i_{\\min}(N)\\Delta x, x_i + i_{\\max}(N)\\Delta x]$.\n$$\nx_i + N\\min(\\mathcal{S})\\Delta x \\le x_i - a\\,t_N \\le x_i + N\\max(\\mathcal{S})\\Delta x\n$$\nSubtracting $x_i$ and substituting $t_N = N\\Delta t$:\n$$\nN\\min(\\mathcal{S})\\Delta x \\le -a\\,N\\Delta t \\le N\\max(\\mathcal{S})\\Delta x\n$$\nFor $N0$, we can divide by $N\\Delta x$:\n$$\n\\min(\\mathcal{S}) \\le -a\\,\\frac{\\Delta t}{\\Delta x} \\le \\max(\\mathcal{S})\n$$\nLet the Courant number be $\\nu = a\\frac{\\Delta t}{\\Delta x}$. The condition becomes $\\min(\\mathcal{S}) \\le -\\nu \\le \\max(\\mathcal{S})$, or equivalently, $-\\max(\\mathcal{S}) \\le \\nu \\le -\\min(\\mathcal{S})$.\n\nAll test cases have $a0$, and the problem specifies \"upwind\" stencils which are biased towards negative indices. This implies $\\max(\\mathcal{S})=0$. The CFL condition thus simplifies to:\n$$\n0 \\le \\nu \\le -\\min(\\mathcal{S})\n$$\nThe first inequality, $0 \\le \\nu$, is always satisfied for $a0$, $\\Delta t0$, and $\\Delta x0$. The crucial part is the second inequality, $\\nu \\le -\\min(\\mathcal{S})$. The problem defines the CFL condition using a parameter $C$ as $\\Delta t \\le C\\,\\Delta x/|a|$, which is equivalent to $\\nu \\le C$ for $a0$. Therefore, the geometric inclusion condition is met if and only if the chosen parameter $C$ satisfies $C \\le -\\min(\\mathcal{S})$.\n\n**2. Analysis of the Specified Schemes**\n\nFor both schemes, we use the maximal time step allowed by the given parameter $C$, so $\\Delta t = C\\,\\Delta x/|a|$. For $a0$, this is $\\Delta t = C\\,\\Delta x/a$. The continuum travel distance is $D_{\\text{cont}}(N) = |a|\\,N\\,\\Delta t = a\\,N(C\\,\\Delta x/a) = NC\\Delta x$.\n\n**Scheme 1: Compact Upwind Stencil**\n- Stencil: $\\mathcal{S}_{\\mathrm{c}} = \\{0, -1\\}$.\n- Stencil bounds: $\\min(\\mathcal{S}_{\\mathrm{c}}) = -1$, $\\max(\\mathcal{S}_{\\mathrm{c}}) = 0$.\n- Extremal indices after $N$ steps: $i_{\\min,c}(N) = -N$, $i_{\\max,c}(N) = 0$.\n- Numerical width: $W_{\\text{num,c}}(N) = (i_{\\max,c}(N) - i_{\\min,c}(N))\\Delta x = (0 - (-N))\\Delta x = N\\Delta x$.\n- Inclusion condition: The continuum point $x_i - a\\,t_N$ must be in the numerical envelope. For $a0$, we check if the leftward reach of the numerical scheme is sufficient. The left reach is $R_{\\text{left,c}}(N) = -i_{\\min,c}(N)\\Delta x = N\\Delta x$. The condition is $R_{\\text{left,c}}(N) \\ge D_{\\text{cont}}(N)$, which becomes $N\\Delta x \\ge NC\\Delta x$, or $1 \\ge C$.\n\n**Scheme 2: Wide Upwind Stencil**\n- Stencil: $\\mathcal{S}_{\\mathrm{w}} = \\{0, -1, -2, -3\\}$.\n- Stencil bounds: $\\min(\\mathcal{S}_{\\mathrm{w}}) = -3$, $\\max(\\mathcal{S}_{\\mathrm{w}}) = 0$.\n- Extremal indices after $N$ steps: $i_{\\min,w}(N) = -3N$, $i_{\\max,w}(N) = 0$.\n- Numerical width: $W_{\\text{num,w}}(N) = (i_{\\max,w}(N) - i_{\\min,w}(N))\\Delta x = (0 - (-3N))\\Delta x = 3N\\Delta x$.\n- Inclusion condition: The left reach is $R_{\\text{left,w}}(N) = -i_{\\min,w}(N)\\Delta x = 3N\\Delta x$. The condition $R_{\\text{left,w}}(N) \\ge D_{\\text{cont}}(N)$ becomes $3N\\Delta x \\ge NC\\Delta x$, or $3 \\ge C$.\n\n**3. Computation for Test Cases**\n\nFor each test case $(a, \\Delta x, C, N)$, we calculate the following quantities:\n1.  $W_{\\text{num,c}}(N) = N\\Delta x$\n2.  $W_{\\text{num,w}}(N) = 3N\\Delta x$\n3.  $D_{\\text{cont}}(N) = NC\\Delta x$\n4.  `inside_compact`: A boolean flag, `True` if $C \\le 1$, `False` otherwise.\n5.  `inside_wide`: A boolean flag, `True` if $C \\le 3$, `False` otherwise.\nThe Python script implements these formulas to generate the results.\n```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of calculating numerical domain widths and\n    checking CFL inclusion for two finite difference schemes.\n    \"\"\"\n    # Define the test cases from the problem statement:\n    # Each case is a tuple (a, delta_x, C, N).\n    test_cases = [\n        (1.0, 1.0, 0.8, 10),\n        (0.5, 0.5, 1.0, 1),\n        (1.0, 1.0, 1.0, 5),\n        (1.0, 1.0, 1.2, 5),\n        (1.0, 1.0, 0.7, 0),\n    ]\n\n    results = []\n    for case in test_cases:\n        a, delta_x, C, N = case\n\n        # For the compact upwind scheme, S_c = {0, -1}\n        # min(S_c) = -1, max(S_c) = 0\n        # The numerical domain width is (max - min) * N * delta_x\n        # W_num_c = (0 - (-1)) * N * delta_x = N * delta_x\n        w_num_c = float(N * delta_x)\n\n        # For the wide upwind scheme, S_w = {0, -1, -2, -3}\n        # min(S_w) = -3, max(S_w) = 0\n        # The numerical domain width is (max - min) * N * delta_x\n        # W_num_w = (0 - (-3)) * N * delta_x = 3 * N * delta_x\n        w_num_w = float(3 * N * delta_x)\n\n        # The continuum travel distance is D_cont = |a| * N * delta_t.\n        # We use delta_t = C * delta_x / |a|.\n        # So, D_cont = |a| * N * (C * delta_x / |a|) = N * C * delta_x\n        d_cont = float(N * C * delta_x)\n\n        # The CFL inclusion condition is that the continuum domain of dependence\n        # must lie within the numerical domain of dependence.\n        # As derived, this is equivalent to C = -min(S).\n\n        # For the compact scheme, -min(S_c) = 1. Condition: C = 1.\n        inside_compact = (C = 1.0)\n\n        # For the wide scheme, -min(S_w) = 3. Condition: C = 3.\n        inside_wide = (C = 3.0)\n\n        # Assemble the results for the current test case.\n        case_result = [w_num_c, w_num_w, d_cont, inside_compact, inside_wide]\n        results.append(case_result)\n\n    # The final output must be a single string representing a list of lists,\n    # with no spaces.\n    final_output_string = str(results).replace(\" \", \"\")\n\n    print(final_output_string)\n\n# solve()\n```",
            "answer": "[[10.0,30.0,8.0,True,True],[0.5,1.5,0.5,True,True],[5.0,15.0,5.0,True,True],[5.0,15.0,6.0,False,True],[0.0,0.0,0.0,True,True]]"
        }
    ]
}