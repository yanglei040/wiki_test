## 引言
[双曲守恒律](@entry_id:147752)系统是描述从[流体动力学](@entry_id:136788)中的激波到电磁学中的光波等众多波传播现象的数学基础。然而，由于其解中可能出现间断（如激波），直接对这[类方程](@entry_id:144428)进行[数值离散化](@entry_id:752782)极具挑战性，常常导致不稳定的[振荡](@entry_id:267781)或过度耗散的模糊结果。为了克服这一难题，研究人员发展了一系列精巧的数值方法，其中，基于信息传播物理的[迎风](@entry_id:756372)（upwinding）原理和[通量分裂](@entry_id:637102)（flux splitting）思想构成了现代计算科学的基石。它们提供了一种系统性的途径，用以构建既稳定又精确，且能自动捕捉间断的[数值格式](@entry_id:752822)。

本文旨在为读者提供一份关于[迎风](@entry_id:756372)与[通量分裂](@entry_id:637102)方法的全面指南。我们将从最基本的物理图像出发，逐步揭示这些方法的深刻内涵和强大功能。
- 在“原理与机制”一章中，我们将深入探讨[特征分解](@entry_id:181333)如何揭示信息的传播方向，并以此为基础，详细阐述通量差分分裂（如Roe格式）和[通量矢量分裂](@entry_id:749491)（如[van Leer格式](@entry_id:756419)）两大主流方法的构建哲学及其核心属性。
- 接下来，在“应用与跨学科联系”一章中，我们将展示这些方法如何应用于解决从[高超声速流](@entry_id:263090)动到等离子体物理等前沿科学问题，并探讨它们如何与其他先进数值框架（如间断[伽辽金法](@entry_id:749698)）融合。
- 最后，“动手实践”部分将提供一系列精心设计的编程练习，引导您将理论知识转化为解决实际问题的计算能力。

通过学习本文，您将掌握设计、分析和应用先进[数值格式](@entry_id:752822)的核心技能，为深入研究计算流体动力学及其他相关[科学计算](@entry_id:143987)领域奠定坚实的基础。

## 原理与机制

在“引言”章节中，我们已经了解了[双曲守恒律](@entry_id:147752)系统及其数值求解的重要性。本章将深入探讨为这类[系统设计](@entry_id:755777)的[数值格式](@entry_id:752822)的核心原理与机制，重点关注迎风（upwinding）和[通量分裂](@entry_id:637102)（flux splitting）的概念。这些思想构成了现代计算流体动力学和更广泛的科学计算领域的基石。我们将从信息传播的基本物理图像出发，逐步构建起设计和分析复杂数值格式所需的理论框架。

### [特征分解](@entry_id:181333)与信息传播方向

考虑一维[双曲守恒律](@entry_id:147752)系统，其拟线性形式为：
$$
U_t + A(U) U_x = 0
$$
其中 $U(x,t) \in \mathbb{R}^m$ 是[守恒变量](@entry_id:747720)的向量，$A(U)$ 是通量雅可比矩阵 $A(U) = \partial f(U)/\partial U$。[双曲性](@entry_id:262766)的核心要求是，对于所有相关的状态 $U$，$A(U)$ 都是可[对角化](@entry_id:147016)的，并拥有 $m$ 个实[特征值](@entry_id:154894) $\lambda_k(U)$ 和一套完备的右[特征向量](@entry_id:151813) $r_k(U)$。

为了理解信息如何在系统中传播，我们首先考察一个线性[常系数](@entry_id:269842)系统 $U_t + A U_x = 0$。由于 $A$ 可被对角化，我们可以写出 $A = R\Lambda R^{-1}$，其中 $\Lambda = \mathrm{diag}(\lambda_1, \dots, \lambda_m)$ 是[特征值](@entry_id:154894)组成的[对角矩阵](@entry_id:637782)，$R$ 的列是对应的右[特征向量](@entry_id:151813)。通过引入**[特征变量](@entry_id:747282)** $W = R^{-1}U$，原[方程组](@entry_id:193238)可以被解耦。代入 $U = RW$ 可得：
$$
R W_t + (R \Lambda R^{-1}) R W_x = 0
$$
用 $R^{-1}$ 左乘上式，我们得到一个[解耦](@entry_id:637294)的系统：
$$
W_t + \Lambda W_x = 0
$$
这等价于 $m$ 个独立的[标量平流方程](@entry_id:754529)：
$$
\frac{\partial W_k}{\partial t} + \lambda_k \frac{\partial W_k}{\partial x} = 0, \quad k=1, \dots, m
$$
每个[标量平流方程](@entry_id:754529)的解 $W_k$ 沿特征线 $x - \lambda_k t = \text{常数}$ 传播，其[传播速度](@entry_id:189384)为 $\lambda_k$。因此，[特征值](@entry_id:154894) $\lambda_k$ 的符号决定了第 $k$ 个特征场（或称为“模态”）中信息在物理空间中的传播方向。

- 如果 $\lambda_k > 0$，信息从左向右传播。
- 如果 $\lambda_k  0$，信息从右向左传播。

这个基本结论是所有**迎风格式**的理论基石。在有限体积法中，我们需要在单元交界面 $x_{i+1/2}$ 处计算一个[数值通量](@entry_id:752791) $F_{i+1/2}$，该通量依赖于界面两侧的状态，即左侧的 $U_L$ 和右侧的 $U_R$。[迎风原理](@entry_id:756377)指出，对于某个特定的波（特征场），其对通量的贡献应该来自该波的来源方向。具体来说：

- 对于一个右[行波](@entry_id:185008)（$\lambda_k > 0$），其在 $x_{i+1/2}$ 处的信息来自左侧，因此数值通量中与该波相关的部分必须由 $U_L$ 决定。
- 对于一个左行波（$\lambda_k  0$），其信息来自右侧，因此其贡献必须由 $U_R$ 决定。

对于[非线性系统](@entry_id:168347)，我们在每个交界面处进行[局部线性化](@entry_id:169489)，例如使用一个 Roe 矩阵 $\tilde{A}(U_L, U_R)$，然后应用相同的逻辑。这个思想引出了基于[特征值](@entry_id:154894)符号进行[通量分裂](@entry_id:637102)的方法，即把[雅可比矩阵](@entry_id:264467) $\tilde{A}$ 分解为控制右行波的 $\tilde{A}^+$ 和控制左[行波](@entry_id:185008)的 $\tilde{A}^-$。一个典型的[迎风通量](@entry_id:143931)构造方式为 $F_{i+1/2} = \tilde{A}^+ U_L + \tilde{A}^- U_R$，它明确地将右行场（由 $\tilde{A}^+$ 投影）的贡献归于左状态 $U_L$，将左行场（由 $\tilde{A}^-$ 投影）的贡献归于右状态 $U_R$。在适当的 Courant–Friedrichs–Lewy (CFL) 条件下，这种一阶格式是稳定且自洽的 。值得注意的是，这种方向性的判断完全依赖于[特征值](@entry_id:154894)的符号，而与[雅可比矩阵](@entry_id:264467)是否对称无关 。

### 一个典型的例子：[欧拉方程](@entry_id:177914)

为了将上述抽象原理具体化，我们考察一维[可压缩欧拉方程](@entry_id:747588)组。这是一个描述无粘性、[可压缩流体](@entry_id:164617)运动的守恒律系统。其[守恒变量](@entry_id:747720)为 $U = [\rho, \rho u, \rho E]^T$，分别代表密度、动量和总能量。其通量[雅可比矩阵](@entry_id:264467) $A(U)$ 的[特征值](@entry_id:154894)为：
$$
\lambda_1 = u - a, \quad \lambda_2 = u, \quad \lambda_3 = u + a
$$
其中 $u$ 是流体速度，$a = \sqrt{\gamma p/\rho}$ 是声速。

这三个[特征值](@entry_id:154894)具有明确的物理意义 ：
- $\lambda_1 = u - a$ 和 $\lambda_3 = u + a$ 代表**声波**。它们是压力和速度的扰动，以声速 $a$ 相对于流体传播。在静止[坐标系](@entry_id:156346)中，它们的速度是流速 $u$ 与声速 $a$ 的叠加。
- $\lambda_2 = u$ 代表**接触波**（或熵波）。它携带的扰动（如密度和温度的跳跃）与压力无关，并简单地以流体自身的速度 $u$ 平流输运。

[迎风格式](@entry_id:756374)的设计必须正确处理这三族[波的传播](@entry_id:144063)方向，而这完全取决于当地马赫数 $M = u/a$：
- **[亚音速流](@entry_id:192984) ($|M|  1$)**: 假设 $u>0$，则 $0  u  a$。此时，$\lambda_1 = u - a  0$（左行），$\lambda_2 = u > 0$（右行），$\lambda_3 = u + a > 0$（右行）。这意味着在交界面处，一个声波从右侧进入，而另一个声波和接触波从左侧进入。因此，数值通量的计算需要同时利用左右两侧的状态信息。
- **[超音速流](@entry_id:262511) ($M > 1$)**: 此时，$u > a > 0$。三个[特征值](@entry_id:154894) $\lambda_1, \lambda_2, \lambda_3$ 全为正。所有信息都从左向右传播。因此，界面通量应该完全由上游（左侧）的状态决定。
- **超音速流 ($M  -1$)**: 此时，三个[特征值](@entry_id:154894)全为负。所有信息都从右向左传播，界面通量应完全由上游（右侧）的状态决定。

这种根据马赫数改变信息来源的逻辑，是设计用于气体动力学的高性能数值格式的核心 。

### [数值通量](@entry_id:752791)的基本属性

在构建具体的[迎风格式](@entry_id:756374)之前，我们必须明确任何一个有效的[数值通量](@entry_id:752791) $\hat{F}(U_L, U_R)$ 都应具备的一些基本属性。

首先是**相容性（Consistency）**。一个数值通量被称为是相容的，如果当左右状态相同时，它能够退化为物理通量，即：
$$
\hat{F}(U, U) = F(U)
$$
相容性是保证数值格式在网格无限加密时能够收敛到原[偏微分方程](@entry_id:141332)弱解的必要条件。如果一个格式不满足相容性，它在[均匀流](@entry_id:272775)区域也可能产生错误的动态行为。例如，一个不相容的格式可能无法保持一个简单的常数状态，即不具备**[自由流](@entry_id:159506)保持（free-stream preservation）**性质。考虑一个初始为常数的状态 $U_i = \bar{U}$，有限体积法的更新率为：
$$
\frac{d U_i}{dt} = -\frac{1}{\Delta x} \left( \hat{F}(\bar{U}, \bar{U}) - \hat{F}(\bar{U}, \bar{U}) \right)
$$
如果 $\hat{F}(\bar{U}, \bar{U})$ 的值不依赖于交界面的位置，那么更新率显然为零，常数状态得以保持。然而，如果一个不相容的通量 $\hat{F}(U,U) = G(U) \neq F(U)$，尽管它仍能保持常数状态（只要 $G(\bar{U})$ 是一个常数），但它在离散化过程中引入了与原方程不符的“源项”，会导致错误的解 。一个保守但严重不相容的通量，甚至可能无法保持最简单的定常[接触间断](@entry_id:194702) 。

其次是**物理可容许性（Physical Admissibility）**。对于像欧拉方程这样的系统，其解必须位于一个物理可容许的[状态空间](@entry_id:177074) $\mathcal{G}$ 内。例如，密度 $\rho$ 和压力 $p$ 必须为正。一个良好的[数值格式](@entry_id:752822)必须是**保正的（positivity-preserving）**，即如果初始状态是物理可容许的，那么在后续的演化中，计算出的状态也必须保持在 $\mathcal{G}$ 内。这通常对数值格式提出了更严格的要求，不仅涉及通量的构造，还涉及对时间步长 $\Delta t$ 的限制（即 CFL 条件）。对于欧拉方程，可容许集为：
$$
\mathcal{G} = \{U = (\rho, m, E) : \rho > 0, \text{ and } p = (\gamma-1)(E - \frac{m^2}{2\rho}) > 0\}
$$
保证数值解始终处于这个集合内，是避免计算崩溃和获得物理上有意义结果的关键 。

### [迎风格式](@entry_id:756374)的主要族系：通量差分分裂与[通量矢量分裂](@entry_id:749491)

基于[迎风原理](@entry_id:756377)，发展出了两大类主流的[数值格式](@entry_id:752822)：通量差分分裂（Flux-Difference Splitting, FDS）和[通量矢量分裂](@entry_id:749491)（Flux-Vector Splitting, FVS）。它们在理念上有着本质的区别 。

#### 通量差分分裂 (Flux-Difference Splitting) 与 Roe 格式

FDS 的核心思想是，在每个交界面上，近似求解一个以 $U_L$ 和 $U_R$ 为[初始条件](@entry_id:152863)的局部**黎曼问题**。它关注的是状态**差** $U_R - U_L$ 如何分解到不同的特征波中。最著名的 FDS 格式是 **Roe 格式**。其[数值通量](@entry_id:752791)可以写为：
$$
\hat{F}(U_L, U_R) = \frac{1}{2}\big(F(U_L) + F(U_R)\big) - \frac{1}{2} |\tilde{A}| (U_R - U_L)
$$
这里的 $\tilde{A} = \tilde{A}(U_L, U_R)$ 是一个特殊构造的**Roe 矩阵**，而 $|\tilde{A}| = \tilde{R}|\tilde{\Lambda}|\tilde{R}^{-1}$ 是其矩阵[绝对值](@entry_id:147688)，其中 $|\tilde{\Lambda}|$ 是 $\tilde{A}$ [特征值](@entry_id:154894)[绝对值](@entry_id:147688)构成的对角矩阵。第一项是中心差分通量，第二项是起耗散作用的迎风修正项。

为了使 Roe 格式有效，Roe 矩阵 $\tilde{A}(U_L, U_R)$ 必须满足三个关键性质 ：
1.  **[双曲性](@entry_id:262766) (Hyperbolicity)**：对于所有可容许的 $U_L$ 和 $U_R$，$\tilde{A}$ 必须是可对角化的，且具有实[特征值](@entry_id:154894)。这保证了局部问题是良定的，可以进行[特征分解](@entry_id:181333)。
2.  **相容性 (Consistency)**：当 $U_L \to U$ 且 $U_R \to U$ 时，$\tilde{A}(U_L, U_R) \to A(U)$。这是保证格式在光滑区域正确的关键。
3.  **守恒线性化 (Conservative Linearization)**：$\tilde{A}$ 必须精确满足通量差的关系，即 $F(U_R) - F(U_L) = \tilde{A}(U_L, U_R) (U_R - U_L)$。这个性质，有时被称为“Roe 性质”，保证了格式能够精确地捕捉稳定的、与网格对齐的激波。

FDS 格式的优点在于它直接模拟了波的物理传播，通过分析状态的“差异”来决定耗散，因此在解析间断（如激波和接触间断）方面通常具有很高的精度。

#### [通量矢量分裂](@entry_id:749491) (Flux-Vector Splitting) 与 van Leer 格式

与 FDS 不同，FVS 的思想不是分裂通量差，而是直接分裂**[通量矢量](@entry_id:273577)本身**。它试图将物理通量 $F(U)$ 分解为两个部分：
$$
F(U) = F^+(U) + F^-(U)
$$
其中 $F^+(U)$ 关联于所有右[行波](@entry_id:185008)（其雅可比矩阵 $A^+ = \partial F^+ / \partial U$ 只有非负[特征值](@entry_id:154894)），而 $F^-(U)$ 关联于所有左行波（其雅可比矩阵 $A^- = \partial F^- / \partial U$ 只有非正[特征值](@entry_id:154894)）。一旦分裂完成，[数值通量](@entry_id:752791)就可以非常简单地构造：
$$
\hat{F}(U_L, U_R) = F^+(U_L) + F^-(U_R)
$$
这个公式的物理意义非常清晰：从左侧取所有右[行波](@entry_id:185008)的通量，从右侧取所有左行波的通量。

**van Leer [通量矢量分裂](@entry_id:749491)**是 FVS 中一个里程碑式的工作。它的巧妙之处在于，它完全避免了对[雅可比矩阵](@entry_id:264467)进行显式的[特征分解](@entry_id:181333)，而是直接构造了关于马赫数 $M$ 的光滑多项式函数来定义分裂通量 $F^\pm$ 。例如，对于欧拉方程，van Leer 构造的分裂通量在亚音速和超音速区域之间是连续且光滑的，这克服了早期 FVS 格式（如 Steger-Warming 分裂）在[声速点](@entry_id:755066)附近产生[数值振荡](@entry_id:163720)的问题。

FVS 的主要优点是其**[计算效率](@entry_id:270255)和稳健性**。由于不需要计算[特征向量](@entry_id:151813)，其计算量远小于 Roe 格式。此外，由于其内在的强[耗散性](@entry_id:162959)，FVS 格式通常非常稳定。然而，它的缺点也同样显著：FVS 格式是“盲目”的，它在分裂通量时只考虑单个状态 $U$ 的信息，而忽略了界面两侧状态的相互作用。这导致它在处理某些波（特别是接触间断和[剪切层](@entry_id:274623)）时会引入过多的[数值耗散](@entry_id:168584)，从而使其模糊不清 。

对于线性[常系数](@entry_id:269842)系统 $U_t + AU_x=0$，FDS 和 FVS 两种思想殊途同归，可以证明它们会得到完全相同的数值通量 。但在[非线性](@entry_id:637147)情况下，它们代表了两种截然不同且各有优劣的设计哲学。

### 简单而稳健的[近似黎曼求解器](@entry_id:267136)

除了复杂的 Roe 格式和 van Leer 格式，还存在一些更简单、更稳健的[近似黎曼求解器](@entry_id:267136)，它们在许多应用中非常受欢迎。

#### Rusanov 格式（局部 Lax-Friedrichs 格式）

Rusanov 格式是迎风格式中最简单的一种。其[数值通量](@entry_id:752791)为：
$$
\hat{F}(U_L, U_R) = \frac{1}{2}\big(F(U_L) + F(U_R)\big) - \frac{1}{2} \alpha (U_R - U_L)
$$
这里的 $\alpha$ 是一个[数值耗散](@entry_id:168584)系数，它必须大于或等于界面处所有[特征值](@entry_id:154894)的[绝对值](@entry_id:147688)的最大值，即 $\alpha \ge \max(|\lambda_k(U_L)|, |\lambda_k(U_R)|)$ 。这个 $\alpha$ 本质上是该区域内最快的物理[信号速度](@entry_id:261601)。

Rusanov 格式可以被看作是一种非常简单的[通量分裂](@entry_id:637102)。如果我们将通量[雅可比](@entry_id:264467) $A$ 分裂为 $A^\pm = \frac{1}{2}(A \pm \alpha I)$，那么 Rusanov 格式就对应于通量 $A^+ U_L + A^- U_R$。由于 $\alpha$ 足够大， $A^+$ 的[特征值](@entry_id:154894)均为非负，而 $A^-$ 的[特征值](@entry_id:154894)均为非正，这符合 FVS 的基本思想 。它的优点是极其简单和稳健，并且易于实现。它的缺点是，它对所有的特征场都施加了同样大小的最大耗散，这对于慢速移动的波来说是过度耗散的，会严重影响解的精度。尽管如此，由于其保正性和[熵稳定性](@entry_id:749023)的良好性质（在适当的 $\alpha$ 和 CFL 条件下），它仍然是构建更高级格式的基础 [@problem_id:3459983, @problem_id:3459984]。

#### HLL, HLLE 和 HLLC 格式

Harten-Lax-van Leer (HLL) 家族的求解器在简单性和精度之间取得了很好的平衡。

**HLL 格式**的基本思想是，用一个只包含两道波（一道最左侧的波，速度为 $S_L$；一道最右侧的波，速度为 $S_R$）和一个常数中间态 $U_{HLL}$ 的模型来近似真实的黎曼扇。通过在整个区域上[积分守恒律](@entry_id:202878)，可以直接推导出 HLL [数值通量](@entry_id:752791)，而无需知道中间态的任何细节。

**HLLE 格式**（E 代表 Einfeldt）是 HLL 格式的一个重要变体。它与 HLL 在结构上完全相同，但强调了对[波速](@entry_id:186208) $S_L$ 和 $S_R$ 的明智选择。通过确保 $S_L$ 和 $S_R$ 分别是真实黎曼扇中所有左行和右[行波](@entry_id:185008)速的可靠下界和[上界](@entry_id:274738)，Einfeldt 证明了该格式在适当的 CFL 条件下是**保正的**。这种格式的更新可以被写成对一系列可容许状态的[凸组合](@entry_id:635830)，从而保证了结果的物理可容许性 。

HLL 和 HLLE 的主要缺点是它们只有一个中间态，这意味着它们无法区分[接触间断](@entry_id:194702)和声波。因此，它们会严重地模糊接触间断。为了解决这个问题，**HLLC 格式**（C 代表 Contact）被提出来。HLLC 在 HLL 的双波模型中间插入了第三道波——接触间断，其速度为 $S_M$。这形成了一个更真实的四态三波模型（$U_L \to U_L^* \to U_R^* \to U_R$）。通过在最左侧和最右侧的波上应用 Rankine-Hugoniot 关系，并假设中间的“星区”($U_L^*$ 和 $U_R^*$ 之间) 压力和法向速度连续（这是[接触间断](@entry_id:194702)的性质），就可以唯一地确定中间[波速](@entry_id:186208) $S_M$ 和星区状态。这个修正极大地提高了格式对接触间断和[材料界面](@entry_id:751731)的分辨率 。

### 深入探讨：[非线性](@entry_id:637147)和[熵条件](@entry_id:166346)

[迎风格式](@entry_id:756374)的复杂性根源于[双曲系统](@entry_id:260647)的[非线性](@entry_id:637147)特性。理解这些特性对于设计和诊断[数值格式](@entry_id:752822)至关重要。

#### 线性退化场与真正[非线性](@entry_id:637147)场

特征场可以根据其[特征值](@entry_id:154894)沿其[特征向量](@entry_id:151813)方向的变化率进行分类。一个特征场 $p$ 被称为：
- **线性退化（Linearly Degenerate, LD）**，如果 $\nabla \lambda_p(U) \cdot r_p(U) \equiv 0$。
- **真正[非线性](@entry_id:637147)（Genuinely Nonlinear, GN）**，如果 $\nabla \lambda_p(U) \cdot r_p(U) \neq 0$。

这个数学定义有着深刻的物理含义 。在 GN 场中，[特征值](@entry_id:154894) $\lambda_p$ 会随着波自身的传播而改变，这导致波形会发生变化：要么变陡形成**激波**，要么变缓形成**[稀疏波](@entry_id:168428)**。而对于 LD 场，[特征值](@entry_id:154894)在波的传播过程中保持不变。这意味着初始的间断将以恒定的速度和强度传播，形成**[接触间断](@entry_id:194702)**。

对于[欧拉方程](@entry_id:177914)，两个[声学](@entry_id:265335)场（$\lambda = u \pm a$）是真正[非线性](@entry_id:637147)的，而中间的物质场（$\lambda=u$）是线性退化的。这就是为什么激波和[稀疏波](@entry_id:168428)与[声学](@entry_id:265335)过程相关，而接触间断则以[流体速度](@entry_id:267320)[平流](@entry_id:270026)。

这个区别解释了为什么不同格式在处理不同波时表现各异。像 HLL 这样合并中间波的格式，会把线性退化的接触波和真正[非线性](@entry_id:637147)的声波混为一谈，从而导致对接触波的严重耗散。而像 Roe 格式或 HLLC 这样显式处理接触波的格式，则能更准确地捕捉它 。

#### [熵条件](@entry_id:166346)与[熵修正](@entry_id:749021)

对于[非线性系统](@entry_id:168347)，守恒律的弱解不唯一。物理上相关的解是那些满足**[熵条件](@entry_id:166346)**的解，该条件本质上是[热力学第二定律](@entry_id:142732)的体现。对于激波，它要求特征线必须“汇入”激波，而不是从中“发出”，这排除了无物理意义的**膨胀激波**。对于一个守恒律系统，如果它拥有一个熵函数 $\eta(U)$（一个[凸函数](@entry_id:143075)）和相应的熵通量 $q(U)$，则物理相关的解必须满足[熵不等式](@entry_id:184404)：
$$
\eta(U)_t + q(U)_x \le 0
$$
一个数值格式被称为**熵稳定的**，如果它能保证在离散层面上也满足这个不等式 。

然而，即使是像 Roe 格式这样设计精良的格式，有时也会产生违反[熵条件](@entry_id:166346)的解。最典型的问题发生在所谓的**[跨音速稀疏波](@entry_id:756129)**（transonic rarefaction）中，即波的两侧[特征值](@entry_id:154894)符号相反（例如 $\lambda_k(U_L)  0  \lambda_k(U_R)$）。在这种情况下，Roe 格式的线性化可能导致其平均[特征值](@entry_id:154894) $\tilde{\lambda}_k \approx 0$，从而使得该场的[数值耗散](@entry_id:168584)项 $| \tilde{\lambda}_k |$ 几乎为零。耗散的缺失使得格式无法将解平滑过渡为正确的[稀疏波](@entry_id:168428)，反而会错误地收敛到一个不稳定的膨胀激波 。

为了解决这个问题，需要引入**[熵修正](@entry_id:749021)（entropy fix）**。一个著名的例子是 Harten-Hyman [熵修正](@entry_id:749021)。其思想是，当检测到[跨音速稀疏波](@entry_id:756129)时（通过检查 $\lambda_k(U_L)$ 和 $\lambda_k(U_R)$ 的符号），就对耗散系数 $| \tilde{\lambda}_k |$ 进行修改。它在 $| \tilde{\lambda}_k |$ 接近零的一个小邻域内，用一个光滑的正值函数（通常是一个抛物线）来替换原来的[绝对值函数](@entry_id:160606)。例如，当 $| \tilde{\lambda}_k |  \delta_k$ 时，用 $\frac{\tilde{\lambda}_k^2}{2\delta_k} + \frac{\delta_k}{2}$ 来代替 $| \tilde{\lambda}_k |$。这个修正保证了即使在[声速点](@entry_id:755066)，也始终存在足够的数值耗散来阻止膨胀激波的形成，同时又不会对其他区域的解造成太大影响 。

总而言之，从简单的[迎风原理](@entry_id:756377)出发，通过考虑[非线性系统](@entry_id:168347)的复杂物理现象，如不同类型的波、物理可容许性和[熵条件](@entry_id:166346)，我们已经构建了一套丰富而强大的理论和工具，用于设计和分析适用于[双曲守恒律](@entry_id:147752)系统的高性能数值格式。