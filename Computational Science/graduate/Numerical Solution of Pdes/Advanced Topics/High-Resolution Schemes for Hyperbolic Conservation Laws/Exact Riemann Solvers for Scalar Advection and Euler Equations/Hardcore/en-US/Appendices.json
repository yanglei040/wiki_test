{
    "hands_on_practices": [
        {
            "introduction": "To build a solid understanding of Riemann solvers, we begin with the most fundamental case: the linear scalar advection equation. While simple, this equation encapsulates the core concepts of characteristic waves and the directional flow of information. This practice guides you through the process of deriving the exact Godunov flux, a cornerstone of modern finite volume methods, by analyzing how the solution at a cell interface is determined by the state from the \"upwind\" direction. Mastering this simple case provides the conceptual foundation needed to tackle more complex nonlinear systems.",
            "id": "3387985",
            "problem": "Consider the linear scalar advection equation $q_{t} + a\\, q_{x} = 0$ with constant advection speed $a \\in \\mathbb{R}$ and Riemann initial data $q(x,0) = q_{L}$ for $x  0$ and $q(x,0) = q_{R}$ for $x  0$. Using the method of characteristics and the definition of the exact Godunov numerical flux for a conservation law $q_{t} + f(q)_{x} = 0$ as the physical flux evaluated at the self-similar Riemann solution on the interface $x=0$, derive the exact Godunov flux at $x=0$ for all $t0$ for the flux function $f(q) = a\\, q$. Express your final result as a single closed-form analytic expression depending only on $a$, $|a|$, $q_{L}$, and $q_{R}$. Do not provide a piecewise-defined answer. Your final answer must be a single analytic expression with no units.",
            "solution": "The problem concerns the linear scalar advection equation, which is a conservation law of the form $q_{t} + f(q)_{x} = 0$. In this specific case, the flux function is given as $f(q) = a\\,q$, where $a \\in \\mathbb{R}$ is a constant advection speed. The equation is thus:\n$$\nq_{t} + (a\\,q)_{x} = 0\n$$\nSince $a$ is a constant, this simplifies to the familiar linear advection form:\n$$\nq_{t} + a\\,q_{x} = 0\n$$\nThe problem is posed with Riemann initial data, which consists of two constant states separated by a discontinuity at $x=0$:\n$$\nq(x,0) = \\begin{cases} q_{L}  \\text{if } x  0 \\\\ q_{R}  \\text{if } x  0 \\end{cases}\n$$\nThe solution to this initial value problem can be found using the method of characteristics. The characteristic curves are defined by the ordinary differential equation $\\frac{dx}{dt} = a$, which integrate to straight lines $x(t) = x_0 + at$, where $x_0$ is the position of the characteristic at $t=0$. Along these characteristics, the governing PDE implies that $\\frac{dq}{dt} = q_t + \\frac{dx}{dt} q_x = q_t + a q_x = 0$. This means the value of $q$ is constant along each characteristic line.\n\nThe value of $q$ at any point $(x,t)$ for $t  0$ is determined by the initial value at the point $x_0$ from which the characteristic originated. From $x = x_0 + at$, we find $x_0 = x - at$. Thus, the solution is given by $q(x,t) = q(x_0, 0) = q(x - at, 0)$.\n\nApplying the given Riemann initial data, we determine the solution $q(x,t)$:\n$$\nq(x,t) = \\begin{cases} q_{L}  \\text{if } x - at  0 \\iff x/t  a \\\\ q_{R}  \\text{if } x - at  0 \\iff x/t  a \\end{cases}\n$$\nThis solution represents a single discontinuity, or contact wave, that propagates with speed $a$. The value of the solution is $q_L$ to the left of the line $x=at$ and $q_R$ to the right of it. The solution is self-similar, meaning it depends only on the ratio $\\xi = x/t$.\n\nThe problem asks for the exact Godunov numerical flux, $f^G(q_L, q_R)$, at the interface $x=0$. By definition, this is the physical flux $f(q)$ evaluated using the state $q$ from the exact Riemann solution at the location of the interface. Mathematically, for $t0$:\n$$\nf^G(q_L, q_R) = f(q(0, t))\n$$\nTo find $q(0, t)$, we examine the self-similar solution at $x/t = 0$. The value of $q(0,t)$ depends on the sign of the advection speed $a$.\n\nCase 1: $a  0$.\nThe advection is from left to right. At the interface $x=0$, we have $x/t = 0$. Since $a0$, the condition $x/t  a$ is satisfied (i.e., $0  a$). Therefore, the state at the interface is the left state:\n$$\nq(0, t) = q_{L}\n$$\nThe Godunov flux is then:\n$$\nf^G = f(q_L) = a\\,q_L\n$$\n\nCase 2: $a  0$.\nThe advection is from right to left. At the interface $x=0$, we again have $x/t=0$. Since $a0$, the condition $x/t  a$ is satisfied (i.e., $0  a$). Therefore, the state at the interface is the right state:\n$$\nq(0, t) = q_{R}\n$$\nThe Godunov flux is then:\n$$\nf^G = f(q_R) = a\\,q_R\n$$\n\nCase 3: $a = 0$.\nThe PDE becomes $q_t = 0$, meaning the solution is stationary. The discontinuity remains at $x=0$. The flux is $f(q) = 0 \\cdot q = 0$ for any value of $q$. Thus, the flux at the interface is zero.\n$$\nf^G = 0\n$$\nThis case is consistent with both previous findings, since if $a=0$, then $a\\,q_L = 0$ and $a\\,q_R=0$.\n\nIn summary, the Godunov flux is given by the piecewise expression:\n$$\nf^G = \\begin{cases} a\\,q_L  \\text{if } a  0 \\\\ a\\,q_R  \\text{if } a  0 \\\\ 0  \\text{if } a=0 \\end{cases}\n$$\nThe problem requires a single closed-form analytic expression for $f^G$ in terms of $a$, $|a|$, $q_L$, and $q_R$. We can construct such an expression using the properties of the absolute value function. We can express the conditions on $a$ as follows:\nThe coefficient for $q_L$ should be $a$ if $a0$ and $0$ otherwise. This can be written as $\\frac{1}{2}(a+|a|)$.\n- If $a0$, $\\frac{1}{2}(a+a) = a$.\n- If $a0$, $\\frac{1}{2}(a-a) = 0$.\n- If $a=0$, $\\frac{1}{2}(0+0) = 0$.\n\nThe coefficient for $q_R$ should be $a$ if $a0$ and $0$ otherwise. This can be written as $\\frac{1}{2}(a-|a|)$.\n- If $a0$, $\\frac{1}{2}(a-a) = 0$.\n- If $a0$, $\\frac{1}{2}(a-(-a)) = a$.\n- If $a=0$, $\\frac{1}{2}(0-0) = 0$.\n\nCombining these, we can write the flux as a linear combination of $q_L$ and $q_R$ with these coefficients:\n$$\nf^G = \\frac{1}{2}(a+|a|)q_L + \\frac{1}{2}(a-|a|)q_R\n$$\nThis expression correctly reproduces the piecewise definition for all $a \\in \\mathbb{R}$. We can rearrange this expression by collecting terms with $a$ and $|a|$:\n$$\nf^G = \\frac{1}{2}a\\,q_L + \\frac{1}{2}|a|\\,q_L + \\frac{1}{2}a\\,q_R - \\frac{1}{2}|a|\\,q_R\n$$\n$$\nf^G = \\frac{1}{2}a(q_L + q_R) + \\frac{1}{2}|a|(q_L - q_R)\n$$\nThis is the desired single closed-form analytic expression for the Godunov flux, often referred to as the upwind flux for linear advection.",
            "answer": "$$\n\\boxed{\\frac{1}{2}a(q_L + q_R) + \\frac{1}{2}|a|(q_L - q_R)}\n$$"
        },
        {
            "introduction": "Having explored a scalar equation, we now transition to the system of one-dimensional Euler equations, which introduces a richer wave structure. The general solution can involve shocks, rarefactions, and contact discontinuities. This exercise simplifies the picture by constructing a special Riemann problem where the acoustic waves—shocks and rarefactions—are absent, allowing us to isolate and study a pure contact discontinuity. By applying the fundamental Rankine-Hugoniot jump conditions, you will demonstrate that pressure and velocity remain constant across this wave, while density can jump, revealing a key physical feature of compressible fluid flow.",
            "id": "3388002",
            "problem": "Consider the one-dimensional compressible Euler equations for an ideal gas, expressed in conservation form\n$$\n\\frac{\\partial}{\\partial t}\n\\begin{pmatrix}\n\\rho \\\\\n\\rho u \\\\\nE\n\\end{pmatrix}\n+\n\\frac{\\partial}{\\partial x}\n\\begin{pmatrix}\n\\rho u \\\\\n\\rho u^{2} + p \\\\\n(E+p)u\n\\end{pmatrix}\n= \\begin{pmatrix}\n0 \\\\\n0 \\\\\n0\n\\end{pmatrix},\n$$\nwhere $x$ is the spatial coordinate, $t$ is time, $\\rho$ is the mass density, $u$ is the velocity, $p$ is the pressure, and $E$ is the total energy per unit volume. The ideal-gas Equation of State (EOS) is $p = (\\gamma - 1)\\left(E - \\tfrac{1}{2}\\rho u^{2}\\right)$ with constant adiabatic index $\\gamma  1$. The Riemann problem consists of an initial condition with a single discontinuity at $x=0$:\n$$\n(\\rho(x,0),u(x,0),p(x,0)) =\n\\begin{cases}\n(\\rho_{L},u_{L},p_{L}),  x0, \\\\\n(\\rho_{R},u_{R},p_{R}),  x0,\n\\end{cases}\n$$\nwhere the subscripts $L$ and $R$ denote left and right states, respectively. Assume $p_{L} = p_{R}$ and $u_{L} = u_{R}$, but $\\rho_{L} \\neq \\rho_{R}$, with the same EOS parameter $\\gamma$ on both sides.\n\nStarting from the conservation laws and the Rankine–Hugoniot jump conditions across a moving discontinuity, and using only the fundamental properties of the characteristic fields of the Euler system (without appealing to pre-derived Riemann solver formulas), do the following:\n\n1. Show that the exact solution to this Riemann problem consists of a single, pure contact discontinuity and that no acoustic (compressive or expansive) waves are generated.\n\n2. Compute the speed $s_{c}$ of this contact discontinuity and the primitive variables in the intermediate states immediately adjacent to the contact on the left and right, denoted $(\\rho_{*,L},u_{*},p_{*})$ and $(\\rho_{*,R},u_{*},p_{*})$, respectively.\n\nExpress your final answer as a single row matrix using the LaTeX $\\texttt{pmatrix}$ environment, in the order\n$$\n\\left(s_{c},\\,p_{*},\\,u_{*},\\,\\rho_{*,L},\\,\\rho_{*,R}\\right).\n$$\nNo numerical approximation or rounding is required, and you should provide exact symbolic expressions. No physical units need to be reported in the final answer.",
            "solution": "The solution to the Euler Riemann problem is self-similar and depends on the variable $\\xi = x/t$. The solution consists of constant states separated by waves emanating from the origin. The Euler system has three characteristic speeds (eigenvalues of the flux Jacobian $\\frac{\\partial \\mathbf{F}}{\\partial \\mathbf{U}}$): $\\lambda_1 = u - c$, $\\lambda_2 = u$, and $\\lambda_3 = u + c$, where $c = \\sqrt{\\gamma p / \\rho}$ is the speed of sound. These correspond to three families of waves.\n- The $1$-wave and $3$-waves are genuinely nonlinear and correspond to acoustic phenomena (shocks or rarefaction waves). Across these waves, all primitive variables $(\\rho, u, p)$ typically change.\n- The $2$-wave is linearly degenerate and corresponds to a contact discontinuity. Across a contact discontinuity, pressure $p$ and velocity $u$ are continuous, while density $\\rho$ (and consequently temperature and entropy) can be discontinuous.\n\nThe general solution structure consists of the initial left state $(\\rho_L, u_L, p_L)$ connected by a $1$-wave to an intermediate state $(\\rho_{*,L}, u_*, p_*)$. This is then connected across a contact discontinuity to a second intermediate state $(\\rho_{*,R}, u_*, p_*)$. Finally, this second intermediate state is connected by a $3$-wave to the initial right state $(\\rho_R, u_R, p_R)$. The velocity $u_*$ and pressure $p_*$ are constant in the region between the $1$-wave and $3$-wave (the \"star\" region).\n\nThe core of solving the Riemann problem is to find the values $u_*$ and $p_*$ by matching the states across the waves. The change in velocity and pressure across the $1$- and $3$-waves is a function of the pressure jump. If the pressure jump across a wave is zero, the wave has zero strength, and none of the primitive variables change across it (except for a contact discontinuity, where density can still jump even with zero pressure change).\n\nLet's test the hypothesis that no acoustic waves are generated. This would imply that the pressure in the intermediate star region is the same as the initial pressures, i.e., $p_* = p_L = p_R$.\nIf $p_* = p_L$, the $1$-wave has zero strength. Consequently, the velocity does not change across this wave, so $u_* = u_L$.\nIf $p_* = p_R$, the $3$-wave has zero strength. Consequently, the velocity does not change across this wave, so $u_* = u_R$.\nFor the solution to be consistent, we must have $u_L = u_R$. The problem statement gives precisely this condition: $u_L = u_R$ and $p_L = p_R$.\n\nTherefore, the hypothesis is self-consistent. With $p_L = p_R$ and $u_L = u_R$, the intermediate pressure and velocity must be $p_* = p_L = p_R$ and $u_* = u_L = u_R$. The $1$-wave and $3$-wave have zero strength, meaning they are absent from the solution. The solution structure collapses to the initial left state and the initial right state separated only by the middle wave, which must be a contact discontinuity. This directly addresses the first part of the question.\n\nThe problem reduces to two constant states, $(\\rho_L, u_L, p_L)$ and $(\\rho_R, u_R, p_R)$, separated by a single discontinuity. Let the speed of this discontinuity be $s_c$. To verify this structure and find the speed, we apply the Rankine-Hugoniot (RH) jump conditions, which state that for a discontinuity moving at speed $s$, the jump in flux must equal the speed times the jump in the conserved quantities:\n$$\ns_c (\\mathbf{U}_R - \\mathbf{U}_L) = \\mathbf{F}(\\mathbf{U}_R) - \\mathbf{F}(\\mathbf{U}_L)\n$$\nwhere the \"left\" and \"right\" states for the jump are the initial conditions $(\\rho_L, u_L, p_L)$ and $(\\rho_R, u_R, p_R)$. Let's use the given conditions $u_L = u_R = u$ and $p_L = p_R = p$ in the RH equations.\n\n1.  **Mass Conservation:**\n    $$\n    s_c(\\rho_R - \\rho_L) = \\rho_R u_R - \\rho_L u_L = \\rho_R u - \\rho_L u = u(\\rho_R - \\rho_L)\n    $$\n    Since $\\rho_L \\neq \\rho_R$, we can divide by $(\\rho_R - \\rho_L)$, which gives:\n    $$\n    s_c = u\n    $$\n    So the speed of the discontinuity is simply the fluid velocity $u=u_L=u_R$. This matches the characteristic speed $\\lambda_2 = u$.\n\n2.  **Momentum Conservation:**\n    $$\n    s_c(\\rho_R u_R - \\rho_L u_L) = (\\rho_R u_R^2 + p_R) - (\\rho_L u_L^2 + p_L)\n    $$\n    Substituting $s_c=u$, $u_L=u_R=u$, and $p_L=p_R=p$:\n    $$\n    u(\\rho_R u - \\rho_L u) = (\\rho_R u^2 + p) - (\\rho_L u^2 + p)\n    $$\n    $$\n    u^2(\\rho_R - \\rho_L) = u^2(\\rho_R - \\rho_L)\n    $$\n    This equation is satisfied identically.\n\n3.  **Energy Conservation:**\n    The total energy is $E = \\frac{p}{\\gamma-1} + \\frac{1}{2}\\rho u^2$.\n    The RH condition is:\n    $$\n    s_c(E_R - E_L) = (E_R + p_R)u_R - (E_L + p_L)u_L\n    $$\n    Substituting $s_c=u$, $u_L=u_R=u$, and $p_L=p_R=p$:\n    $$\n    u(E_R - E_L) = (E_R + p)u - (E_L + p)u\n    $$\n    $$\n    u(E_R - E_L) = u(E_R - E_L)\n    $$\n    This equation is also satisfied identically.\n\nThe RH conditions are fully satisfied for a discontinuity propagating at speed $s_c = u_L = u_R$, across which pressure and velocity are continuous, while density is discontinuous. This is the definition of a contact discontinuity. This formally proves that the solution consists of a single contact discontinuity.\n\nNow we compute the requested quantities: $s_c, p_*, u_*, \\rho_{*,L}, \\rho_{*,R}$.\n- **Speed of contact, $s_c$**: As derived, $s_c = u_L$.\n- **Intermediate pressure, $p_*$**: Pressure is continuous across the contact and undifferentiated by the zero-strength acoustic waves. Thus, $p_* = p_L = p_R$.\n- **Intermediate velocity, $u_*$**: Velocity is continuous across the contact and undifferentiated by the zero-strength acoustic waves. Thus, $u_* = u_L = u_R$.\n- **Intermediate density, $\\rho_{*,L}$**: This is the density on the left side of the contact discontinuity. Since the $1$-wave has zero strength, the state to the left of the contact is the same as the initial left state. Therefore, $\\rho_{*,L} = \\rho_L$.\n- **Intermediate density, $\\rho_{*,R}$**: This is the density on the right side of the contact discontinuity. Since the $3$-wave has zero strength, the state to the right of the contact is the same as the initial right state. Therefore, $\\rho_{*,R} = \\rho_R$.\n\nThe final results are:\n$s_c = u_L$\n$p_* = p_L$\n$u_* = u_L$\n$\\rho_{*,L} = \\rho_L$\n$\\rho_{*,R} = \\rho_R$\n\nThese are to be presented in a single row matrix in the specified order.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\nu_L  p_L  u_L  \\rho_L  \\rho_R\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "We now confront the challenge of solving the general Riemann problem for the Euler equations. The key to unlocking the full solution lies in finding the constant pressure, $p^{\\ast}$, in the intermediate \"star region\" that forms between the left- and right-moving waves. This pressure is the root of a highly nonlinear scalar equation. This capstone practice moves from pure theory to practical implementation, guiding you to develop and code a robust iterative solver using a bracketing-and-bisection method. You will translate the analytical wave curve functions into a working algorithm, tackle practical issues like vacuum formation, and build a tool capable of solving canonical shock tube problems.",
            "id": "3388048",
            "problem": "Consider the one-dimensional compressible Euler equations for a polytropic ideal gas with ratio of specific heats $\\gamma$, posed as a Riemann problem with left state $(\\rho_L,u_L,p_L)$ and right state $(\\rho_R,u_R,p_R)$, where $\\rho$ is density, $u$ is velocity, and $p$ is pressure. The exact solution in the self-similar variable consists of elementary waves connecting the left state and right state through an intermediate, or star, state with common pressure $p^\\ast$ and velocity $u^\\ast$. The star pressure $p^\\ast$ is defined implicitly as the unique real root of a scalar nonlinear equation of the form $F(p)=0$, where $F(p)$ is constructed from left and right wave curves $f_L(p)$ and $f_R(p)$ and the velocity jump $u_R-u_L$.\n\nStarting from the conservation form of the Euler equations, the ideal gas equation of state, and the intermediate-state construction that equates star-region velocities, derive a bracketing-and-bisection strategy that exploits the monotonicity of $f_L(p)+f_R(p)$ to guarantee convergence to $p^\\ast$ when it exists and to detect vacuum formation when the data drive $p^\\ast$ to zero. Your strategy must:\n- Establish an initial lower bound $p_{\\mathrm{low}}$ and upper bound $p_{\\mathrm{high}}$ such that $F(p_{\\mathrm{low}})\\le 0$ and $F(p_{\\mathrm{high}})\\ge 0$, and explain why this is possible when no vacuum occurs.\n- Use a bisection iteration on $[p_{\\mathrm{low}},p_{\\mathrm{high}}]$ to converge to $p^\\ast$ to a prescribed tolerance.\n- Include a logically justified criterion to detect vacuum formation in terms of the left and right sound speeds and velocity jump, and return $p^\\ast=0$ in that case.\n- Analyze the robustness of the bracketing in the near-vacuum regime and explain how monotonicity prevents false convergence or oscillation.\n\nImplement the above bracketing-and-bisection strategy as a complete, runnable program that, for each test case below, computes and returns $p^\\ast$ to ten digits after the decimal point. Use nondimensional units for all quantities, and output the pressures in nondimensional units. The angle unit is not applicable. The final tolerance for bisection must be $10^{-12}$ in pressure units.\n\nUse the following test suite:\n- Case A (canonical shock tube): $\\rho_L=1.0$, $u_L=0.0$, $p_L=1.0$; $\\rho_R=0.125$, $u_R=0.0$, $p_R=0.1$; $\\gamma=1.4$.\n- Case B (strong shock): $\\rho_L=1.0$, $u_L=0.0$, $p_L=1000.0$; $\\rho_R=1.0$, $u_R=0.0$, $p_R=0.01$; $\\gamma=1.4$.\n- Case C (vacuum formation): $\\rho_L=1.0$, $u_L=-3.0$, $p_L=0.1$; $\\rho_R=1.0$, $u_R=3.0$, $p_R=0.1$; $\\gamma=1.4$.\n- Case D (near-vacuum threshold): $\\rho_L=1.0$, $p_L=0.1$; $\\rho_R=1.0$, $p_R=0.1$; $\\gamma=1.4$; define the left and right sound speeds $a_L=\\sqrt{\\gamma p_L/\\rho_L}$ and $a_R=\\sqrt{\\gamma p_R/\\rho_R}$, the threshold $T=2(a_L+a_R)/(\\gamma-1)$, choose $\\varepsilon=10^{-8}$, and set $u_L=-(T-\\varepsilon)/2$, $u_R=(T-\\varepsilon)/2$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with each $p^\\ast$ formatted to ten digits after the decimal point, in the order of the above cases (for example, $[p_A,p_B,p_C,p_D]$ where each entry is a decimal with ten digits).",
            "solution": "The problem requires the derivation and implementation of a numerical strategy to find the star pressure, $p^\\ast$, in the exact solution of the one-dimensional Euler equations for a Riemann problem. The strategy must be based on a bracketing-and-bisection root-finding method.\n\nThe foundation of the solution is the condition that the fluid velocity, $u^\\ast$, and pressure, $p^\\ast$, are constant in the intermediate \"star\" region that separates the left-moving and right-moving waves. The velocity $u^\\ast$ can be expressed as a function of the star pressure $p^\\ast$ and the initial state on either the left ($L$) or right ($R$) side. Equating these two expressions, $u^\\ast_L(p^\\ast) = u^\\ast_R(p^\\ast)$, yields a single nonlinear scalar equation for $p^\\ast$.\n\nLet the initial left and right states be $(\\rho_L, u_L, p_L)$ and $(\\rho_R, u_R, p_R)$, respectively, and the ratio of specific heats be $\\gamma$. The sound speed in state $k \\in \\{L, R\\}$ is $a_k = \\sqrt{\\gamma p_k / \\rho_k}$. The velocity in the star region, computed from the left state, is $u^\\ast_L(p) = u_L - f_L(p)$, and computed from the right state, it is $u^\\ast_R(p) = u_R + f_R(p)$. The functions $f_L(p)$ and $f_R(p)$ depend on whether the wave is a shock or a rarefaction.\n\nFor a generic state $k \\in \\{L, R\\}$ with initial data $(\\rho_k, u_k, p_k)$, the function $f_k(p)$ relating the star pressure $p$ to the velocity change across the wave is defined as follows:\n\nIf $p > p_k$, the wave is a shock. The Rankine-Hugoniot jump conditions yield:\n$$f_k(p) = (p - p_k) \\left[ \\frac{A_k}{p + B_k} \\right]^{1/2}$$\nwhere $A_k = \\frac{2}{(\\gamma+1)\\rho_k}$ and $B_k = \\frac{\\gamma-1}{\\gamma+1}p_k$.\n\nIf $p \\le p_k$, the wave is a rarefaction. The isentropic relations and Riemann invariants yield:\n$$f_k(p) = \\frac{2a_k}{\\gamma-1} \\left[ \\left(\\frac{p}{p_k}\\right)^{\\frac{\\gamma-1}{2\\gamma}} - 1 \\right]$$\nThis expression is valid for $p_k > 0$. If $p_k=0$, the rarefaction expression is not used as only a shock can emanate from a zero-pressure state. All problem data have $p_k0$.\n\nThe star pressure $p^\\ast$ is the root of the equation $u^\\ast_L(p) = u^\\ast_R(p)$, which can be rewritten as:\n$$u_L - f_L(p) = u_R + f_R(p)$$\nRearranging terms gives the nonlinear equation $\\Phi(p) = 0$, where:\n$$\\Phi(p) = f_L(p) + f_R(p) + u_R - u_L = 0$$\nThe functions $f_L(p)$ and $f_R(p)$ are continuous and strictly monotonically increasing for $p \\ge 0$. Consequently, their sum, $\\Phi(p)$, is also a continuous and strictly monotonically increasing function. This property is paramount, as it guarantees that if a solution $p^\\ast \\ge 0$ exists, it is unique. This monotonicity makes the bisection method exceptionally robust for finding the root.\n\nThe solution strategy proceeds as follows:\n\n**1. Vacuum Formation Criterion**\nA vacuum ($p^\\ast=0$) occurs if the initial states are moving apart rapidly enough. We can establish a precise condition by evaluating $\\Phi(p)$ at the physical lower limit for pressure, $p=0$. For a vacuum to form, rarefaction waves must be generated on both sides, so we use the rarefaction formula for $f_k(p)$ as $p \\to 0$.\n$$f_k(0) = \\lim_{p \\to 0^+} \\frac{2a_k}{\\gamma-1} \\left[ \\left(\\frac{p}{p_k}\\right)^{\\frac{\\gamma-1}{2\\gamma}} - 1 \\right] = -\\frac{2a_k}{\\gamma-1}$$\nSubstituting this into the expression for $\\Phi(p)$:\n$$\\Phi(0) = f_L(0) + f_R(0) + u_R - u_L = -\\frac{2a_L}{\\gamma-1} - \\frac{2a_R}{\\gamma-1} + u_R - u_L$$\nSince $\\Phi(p)$ is monotonically increasing, if $\\Phi(0) \\ge 0$, the root $p^\\ast$ must satisfy $p^\\ast \\le 0$. As pressure cannot be negative, the only physical solution is $p^\\ast = 0$. Therefore, the condition for vacuum formation is:\n$$u_R - u_L \\ge \\frac{2}{\\gamma-1}(a_L + a_R)$$\nIf this inequality holds, we immediately set $p^\\ast=0$ and the algorithm terminates.\n\n**2. Bracketing the Root**\nIf the vacuum condition is not met, then $\\Phi(0)  0$, which implies the root $p^\\ast$ is positive. We must find an interval $[p_{\\mathrm{low}}, p_{\\mathrm{high}}]$ that brackets the root, i.e., $\\Phi(p_{\\mathrm{low}}) \\le 0$ and $\\Phi(p_{\\mathrm{high}}) \\ge 0$.\n-   **Lower Bound**: Since $\\Phi(0)  0$, we can choose $p_{\\mathrm{low}} = 0$. The montonicity of $\\Phi(p)$ ensures that $\\Phi(p)  0$ for all $0 \\le p  p^\\ast$.\n-   **Upper Bound**: We need to find a $p_{\\mathrm{high}}$ such that $\\Phi(p_{\\mathrm{high}}) \\ge 0$. The functions $f_k(p)$ grow approximately as $\\sqrt{p}$ for large $p$, so $\\Phi(p) \\to \\infty$ as $p \\to \\infty$. This guarantees that an upper bound exists. A robust method to find it is to start with an initial guess, for example $p_{guess} = \\max(p_L, p_R)$ (or a small positive number if both are $0$), and check the sign of $\\Phi(p_{guess})$. If $\\Phi(p_{guess})  0$, it means $p^\\ast  p_{guess}$, so we repeatedly double the guess ($p_{guess} \\leftarrow 2 \\cdot p_{guess}$) until $\\Phi(p_{guess}) \\ge 0$. This value can then be set as $p_{\\mathrm{high}}$. This iterative search is guaranteed to terminate.\n\n**3. Bisection Iteration**\nWith the root bracketed in $[p_{\\mathrm{low}}, p_{\\mathrm{high}}]$, the bisection method proceeds as follows:\n1.  Set the desired tolerance $\\tau$ (here, $\\tau = 10^{-12}$).\n2.  While $(p_{\\mathrm{high}} - p_{\\mathrm{low}})  \\tau$:\n    a. Compute the midpoint $p_{\\mathrm{mid}} = (p_{\\mathrm{low}} + p_{\\mathrm{high}}) / 2$.\n    b. Evaluate $\\Phi(p_{\\mathrm{mid}})$.\n    c. If $\\Phi(p_{\\mathrm{mid}})  0$, the root lies in the upper half of the interval. Update the lower bound: $p_{\\mathrm{low}} = p_{\\mathrm{mid}}$.\n    d. If $\\Phi(p_{\\mathrm{mid}}) \\ge 0$, the root lies in the lower half. Update the upper bound: $p_{\\mathrm{high}} = p_{\\mathrm{mid}}$.\n3.  The final approximation for the star pressure is $p^\\ast = (p_{\\mathrm{low}} + p_{\\mathrm{high}}) / 2$.\n\n**4. Robustness Analysis**\nThe robustness of this strategy stems directly from the monotonicity of $\\Phi(p)$.\n-   **Guaranteed Convergence**: Monotonicity ensures there is only one root. The bisection algorithm systematically halves the search interval, guaranteeing convergence to this unique root without any risk of overshooting or oscillating, which can plague methods like Newton's if the function is not well-behaved.\n-   **Near-Vacuum Regime**: The strategy is robust even when $p^\\ast$ is a very small positive number. The problem's Case D is designed to test this, where $u_R - u_L$ is just slightly less than the vacuum threshold. In this case, $\\Phi(0)$ is a small negative number ($-\\varepsilon$ in the construction of Case D). Our algorithm correctly deduces that $p^\\ast  0$. The bracketing starts with $[0, p_{\\mathrm{high}}]$ and will successfully enclose the small positive root. The bisection method will then converge to it with the prescribed accuracy. The well-defined behavior of the rarefaction function $f_k(p) \\propto p^{(\\gamma-1)/(2\\gamma)}$ for small $p0$ (the exponent is positive for $\\gamma1$) prevents numerical instabilities near $p=0$. The initial, explicit check for the vacuum case $\\Phi(0)\\ge 0$ is critical for separating the $p^\\ast=0$ case from the $p^\\ast \\to 0^+$ case, ensuring correctness across all regimes.",
            "answer": "[0.3031301781,460.89382103,0.0000000000,0.0000000001]"
        }
    ]
}