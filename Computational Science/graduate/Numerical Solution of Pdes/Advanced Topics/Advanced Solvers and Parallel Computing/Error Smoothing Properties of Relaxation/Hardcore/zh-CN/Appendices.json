{
    "hands_on_practices": [
        {
            "introduction": "第一个练习为理解误差平滑奠定了基础。你将推导经典迭代求解器——加权雅可比法的放大因子，然后编写一个程序来数值计算其平滑因子 $\\mu$。这个动手实践将使“平滑器作为频率滤波器”这一抽象概念变得具体可感，并提供一个评估其效率的明确指标。",
            "id": "3387327",
            "problem": "考虑在通过迭代法求解椭圆偏微分方程时松弛法的误差光滑特性。使用以下基础设置：从正则网格上负拉普拉斯算子的离散化开始，这会产生一个线性系统 $A u = f$。在一维情况下，使用标准三点差分格式；在二维情况下，在均匀网格上使用标准五点差分格式。加权雅可比松弛法通过 $u^{(k+1)} = u^{(k)} + \\omega D^{-1} (f - A u^{(k)})$ 更新 $u$，其中 $D$ 是 $A$ 的对角部分，$\\omega$ 是一个标量松弛权重。一次松弛步骤的误差传播为 $e^{(k+1)} = (I - \\omega D^{-1} A) e^{(k)}$。局部傅里叶分析 (LFA) 将误差分量视为无限网格上的离散傅里叶模式，这些模式可以对角化平移不变算子；因此，每个模式都会被一个取决于该模式频率的标量因子放大。高频分量是指在更粗的网格上表示不佳的分量。在一维情况下，将高频集定义为 $\\theta \\in [\\pi/2,\\pi]$。在二维情况下，将高频集定义为所有 $(\\theta_x,\\theta_y) \\in [0,\\pi] \\times [0,\\pi]$，其中 $\\theta_x$ 或 $\\theta_y$ 至少有一个位于 $[\\pi/2,\\pi]$ 区间内。角度必须以弧度处理和报告。\n\n从这些定义和标准差分格式所蕴含的离散算子符号出发，推导作用于一维和二维空间傅里叶模式的单个加权雅可比松弛步骤的标量放大因子。然后，将光滑因子 $\\mu(\\omega)$ 定义为在指定高频集上此放大因子绝对值的上确界（在抽样意义上为最大值）。实现一个程序，通过对频域进行均匀抽样来数值计算 $\\mu(\\omega)$。为了使计算明确且可测试，用在具有指定分辨率 $N_\\theta$ 的均匀角度网格上的最大值来近似上确界。具体来说：\n- 对于一维情况 ($d=1$)，使用 $N_\\theta$ 个点（包括端点）在 $[\\pi/2,\\pi]$ 上均匀抽样 $\\theta$。\n- 对于二维情况 ($d=2$)，在每个维度上使用 $N_\\theta$ 个点（包括端点）在 $[0,\\pi] \\times [0,\\pi]$ 上均匀抽样 $(\\theta_x,\\theta_y)$，并通过仅选择那些满足 $\\theta_x \\in [\\pi/2,\\pi]$ 或 $\\theta_y \\in [\\pi/2,\\pi]$ 的抽样对 $(\\theta_x,\\theta_y)$ 来限制在上述定义的高频集上。\n\n您的程序必须为以下测试套件中的每组参数计算 $\\mu(\\omega)$，并以浮点数形式生成结果，四舍五入到 $10$ 位小数：\n\n1. $d=1$, $\\omega = 2/3$, $N_\\theta = 1024$。\n2. $d=2$, $\\omega = 2/3$, $N_\\theta = 512$。\n3. $d=2$, $\\omega = 1$, $N_\\theta = 256$。\n4. $d=1$, $\\omega = 0$, $N_\\theta = 64$。\n5. $d=2$, $\\omega = 0.8$, $N_\\theta = 512$。\n\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表（例如，“[result1,result2,result3,result4,result5]”）。角度必须以弧度为单位，所有报告的浮点数必须精确到 $10$ 位小数。",
            "solution": "任务是推导一维和二维泊松方程的加权雅可比松弛法的放大因子，然后数值计算相应的光滑因子 $\\mu(\\omega)$。\n\n线性系统 $A u = f$ 的加权雅可比迭代由 $u^{(k+1)} = u^{(k)} + \\omega D^{-1} (f - A u^{(k)})$ 给出，其中 $D$ 是 $A$ 的对角部分，$\\omega$ 是松弛权重。误差 $e^{(k)} = u - u^{(k)}$（其中 $u$ 是精确解）根据关系 $e^{(k+1)} = (I - \\omega D^{-1} A) e^{(k)}$ 进行传播。算子 $S_\\omega = I - \\omega D^{-1} A$ 是迭代或误差传播算子。\n\n我们在无限网格上使用局部傅里叶分析 (LFA)。在 LFA 中，我们分析线性、平移不变算子对单个傅里叶模式的影响。频率为 $\\boldsymbol{\\theta}$ 的误差分量由网格函数 $v(\\mathbf{x}) = e^{i \\boldsymbol{\\theta} \\cdot \\mathbf{x}/h}$ 表示，在具有整数索引 $\\mathbf{j}$ 的离散网格上，这变为 $v_{\\mathbf{j}} = e^{i \\boldsymbol{\\theta} \\cdot \\mathbf{j}}$。算子 $S_\\omega$ 作用于这样一个模式的结果是将其乘以一个标量，该标量被称为符号或放大因子，记为 $\\hat{S}_\\omega(\\boldsymbol{\\theta})$。这是因为傅里叶模式是任何平移不变算子的特征向量。符号由 $\\hat{S}_\\omega(\\boldsymbol{\\theta}) = \\widehat{I - \\omega D^{-1} A}(\\boldsymbol{\\theta}) = 1 - \\omega \\widehat{D^{-1}A}(\\boldsymbol{\\theta})$ 给出。由于对于手头的问题，$D$ 是单位算子的标量倍数（$D = cI$），所以 $D^{-1} = c^{-1}I$，其符号是常数 $c^{-1}$。因此，$\\hat{S}_\\omega(\\boldsymbol{\\theta}) = 1 - \\omega c^{-1} \\hat{A}(\\boldsymbol{\\theta})$，其中 $\\hat{A}(\\boldsymbol{\\theta})$ 是算子 $A$ 的符号。\n\n光滑因子 $\\mu(\\omega)$ 定义为在所有高频模式上放大因子绝对值的最大值：\n$$\n\\mu(\\omega) = \\sup_{\\boldsymbol{\\theta} \\in \\text{HighFreqSet}} |\\hat{S}_\\omega(\\boldsymbol{\\theta})|\n$$\n\n我们现在将推导一维和二维的放大因子。网格间距 $h$ 可以设置为 $1$，因为离散拉普拉斯算子 $A$ 的任何 $1/h^2$ 缩放也会将其对角线 $D$ 缩放 $1/h^2$，从而使乘积 $D^{-1}A$ 以及放大因子保持不变。\n\n**一维情况 ($d=1$)**\n\n一维负拉普拉斯算子的标准三点差分格式为 $[-1, 2, -1]$。算子 $A$ 作用于网格函数 $u_j$ 的结果是 $(Au)_j = 2u_j - u_{j-1} - u_{j+1}$。$A$ 的对角线是 $D=2I$，所以 $c=2$。\n为了找到符号 $\\hat{A}(\\theta)$，我们将 $A$ 应用于傅里叶模式 $e^{i\\theta j}$：\n$$\nA e^{i\\theta j} = 2e^{i\\theta j} - e^{i\\theta(j-1)} - e^{i\\theta(j+1)} = (2 - e^{-i\\theta} - e^{i\\theta}) e^{i\\theta j} = (2 - 2\\cos(\\theta)) e^{i\\theta j}\n$$\n因此，$A$ 的符号是 $\\hat{A}(\\theta) = 2 - 2\\cos(\\theta)$。\n加权雅可比方法的放大因子是：\n$$\n\\hat{S}_\\omega(\\theta) = 1 - \\omega D^{-1} \\hat{A}(\\theta) = 1 - \\omega \\frac{1}{2} (2 - 2\\cos(\\theta)) = 1 - \\omega(1 - \\cos(\\theta))\n$$\n高频集定义为 $\\theta \\in [\\pi/2, \\pi]$。问题要求我们通过在此区间内对 $N_\\theta$ 个点进行均匀抽样，计算 $|\\hat{S}_\\omega(\\theta)|$ 的最大值来得到 $\\mu(\\omega)$。\n\n**二维情况 ($d=2$)**\n\n二维负拉普拉斯算子的标准五点差分格式由其对网格函数 $u_{j,k}$ 的作用表示：$(Au)_{j,k} = 4u_{j,k} - u_{j-1,k} - u_{j+1,k} - u_{j,k-1} - u_{j,k+1}$。$A$ 的对角线是 $D=4I$，所以 $c=4$。\n我们将 $A$ 应用于傅里叶模式 $e^{i(\\theta_x j + \\theta_y k)}$：\n\\begin{align*}\nA e^{i(\\theta_x j + \\theta_y k)} = \\left(4 - e^{-i\\theta_x} - e^{i\\theta_x} - e^{-i\\theta_y} - e^{i\\theta_y}\\right) e^{i(\\theta_x j + \\theta_y k)} \\\\\n= (4 - 2\\cos(\\theta_x) - 2\\cos(\\theta_y)) e^{i(\\theta_x j + \\theta_y k)}\n\\end{align*}\n$A$ 的符号是 $\\hat{A}(\\theta_x, \\theta_y) = 4 - 2\\cos(\\theta_x) - 2\\cos(\\theta_y)$。\n加权雅可比方法的放大因子是：\n$$\n\\hat{S}_\\omega(\\theta_x, \\theta_y) = 1 - \\omega D^{-1} \\hat{A}(\\theta_x, \\theta_y) = 1 - \\omega \\frac{1}{4} (4 - 2\\cos(\\theta_x) - 2\\cos(\\theta_y)) = 1 - \\frac{\\omega}{2}(2 - \\cos(\\theta_x) - \\cos(\\theta_y))\n$$\n高频集定义为所有 $(\\theta_x, \\theta_y) \\in [0, \\pi] \\times [0, \\pi]$，其中 $\\theta_x \\in [\\pi/2, \\pi]$ 或 $\\theta_y \\in [\\pi/2, \\pi]$。$\\mu(\\omega)$ 的计算涉及使用 $N_\\theta \\times N_\\theta$ 网格对域 $[0, \\pi] \\times [0, \\pi]$ 进行抽样，筛选出高频点，为这些点计算 $|\\hat{S}_\\omega(\\theta_x, \\theta_y)|$，并找到最大值。\n\n提供的 Python 代码为每个测试用例实现了这种数值计算。\n- 对于 $d=1$，它在 $[\\pi/2, \\pi]$ 中为 $\\theta$ 生成 $N_\\theta$ 个点，并计算 $\\max|\\hat{S}_\\omega(\\theta)|$。\n- 对于 $d=2$，它在 $[0, \\pi] \\times [0, \\pi]$ 中为 $(\\theta_x, \\theta_y)$ 生成一个 $N_\\theta \\times N_\\theta$ 的网格，过滤这些点以仅保留高频集中的点，然后计算此子集上 $|\\hat{S}_\\omega(\\theta_x, \\theta_y)|$ 的最大值。\n最终结果按要求四舍五入到 $10$ 位小数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_mu(d, omega, N_theta):\n    \"\"\"\n    Computes the smoothing factor mu(omega) numerically.\n\n    Args:\n        d (int): Dimension (1 or 2).\n        omega (float): Relaxation weight.\n        N_theta (int): Number of sample points for the angle(s).\n\n    Returns:\n        float: The computed smoothing factor mu.\n    \"\"\"\n    if d == 1:\n        # Sample theta uniformly over [pi/2, pi] using N_theta points.\n        theta_vals = np.linspace(np.pi / 2, np.pi, N_theta)\n        \n        # Calculate amplification factor for each theta.\n        # S(theta) = 1 - omega * (1 - cos(theta))\n        cos_vals = np.cos(theta_vals)\n        amp_factors = 1 - omega * (1 - cos_vals)\n        \n        # The smoothing factor is the max of the absolute values.\n        mu = np.max(np.abs(amp_factors))\n        return mu\n        \n    elif d == 2:\n        # Sample (theta_x, theta_y) uniformly over [0,pi] x [0,pi].\n        theta_1d = np.linspace(0, np.pi, N_theta)\n        theta_x, theta_y = np.meshgrid(theta_1d, theta_1d)\n\n        # Identify the high-frequency set.\n        # This is where theta_x >= pi/2 OR theta_y >= pi/2.\n        pi_div_2 = np.pi / 2\n        high_freq_mask = (theta_x >= pi_div_2) | (theta_y >= pi_div_2)\n\n        # We only need to compute the amplification factor for the high-frequency modes.\n        theta_x_hf = theta_x[high_freq_mask]\n        theta_y_hf = theta_y[high_freq_mask]\n\n        # Calculate amplification factor for each high-frequency mode.\n        # S(theta_x, theta_y) = 1 - (omega/2) * (2 - cos(theta_x) - cos(theta_y))\n        cos_x = np.cos(theta_x_hf)\n        cos_y = np.cos(theta_y_hf)\n        amp_factors = 1 - (omega / 2) * (2 - cos_x - cos_y)\n        \n        # The smoothing factor is the max of the absolute values.\n        mu = np.max(np.abs(amp_factors))\n        return mu\n    else:\n        raise ValueError(\"Dimension d must be 1 or 2.\")\n\ndef solve():\n    \"\"\"\n    Solves the problem for the given test suite.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (d, omega, N_theta)\n        (1, 2/3, 1024),\n        (2, 2/3, 512),\n        (2, 1.0, 256),\n        (1, 0.0, 64),\n        (2, 0.8, 512),\n    ]\n\n    results = []\n    for case in test_cases:\n        d, omega, N_theta = case\n        mu = compute_mu(d, omega, N_theta)\n        # Round the result to 10 decimal places.\n        results.append(round(mu, 10))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n\n```"
        },
        {
            "introduction": "现实世界的问题往往比简单的各向同性泊松方程更复杂。本练习探讨了偏微分方程算子中的强各向异性如何使简单的逐点平滑器失效。通过进行局部傅里叶分析，你将比较点雅可比松弛与更稳健的线雅可比松弛的性能，并推导决定何时必须切换到更强平滑器的临界各向异性比率。",
            "id": "3387323",
            "problem": "考虑一个与坐标轴对齐的矩形域上的各向异性扩散算子，由 $-\\left(\\epsilon_{x} \\frac{\\partial^{2} u}{\\partial x^{2}} + \\epsilon_{y} \\frac{\\partial^{2} u}{\\partial y^{2}}\\right)$ 给出，其中 $\\epsilon_{x} > 0$ 和 $\\epsilon_{y} > 0$ 是常系数。令 $\\gamma := \\epsilon_{x}/\\epsilon_{y}$ 表示各向异性比。使用标准的5点有限差分格式，在两个方向上网格尺寸均为 $h$ 的均匀笛卡尔网格上对该算子进行离散化。考虑一种仅在 $y$ 方向使用半粗化（即粗化 $y$ 轴，保持 $x$ 轴不变）的多重网格方法，并通过局部傅里叶分析 (LFA) 来分析松弛的误差光滑特性，其中傅里叶空间由 $(\\theta_{x}, \\theta_{y}) \\in [-\\pi, \\pi] \\times [-\\pi, \\pi]$ 参数化。\n\n$y$ 方向半粗化的高频集定义为 $\\mathcal{H}_{y} := \\{(\\theta_{x}, \\theta_{y}) : -\\pi \\le \\theta_{x} \\le \\pi, \\, \\pi/2 \\le |\\theta_{y}| \\le \\pi\\}$。光滑因子是松弛格式的误差传播符号的幅值在 $(\\theta_{x}, \\theta_{y}) \\in \\mathcal{H}_{y}$ 上的上确界。考虑应用于细网格的两种松弛策略：\n\n$1.$ 加权点雅可比法，松弛权重 $\\omega \\in (0, 1)$。\n\n$2.$ 行块雅可比法，其中线平行于 $x$ 轴（即，沿 $x$ 线进行精确块求解，并在 $y$ 方向的相邻线之间进行雅可比耦合），松弛权重 $\\omega \\in (0, 1)$。\n\n从离散算子的符号和上述定义出发，执行局部傅里叶分析以推导：\n\n- 加权点雅可比法的优化高频光滑因子 $\\mu_{J}^{\\star}(\\gamma)$，通过在 $\\omega \\in (0, 1)$ 上最小化最坏情况下的放大因子得到。\n- $x$-行块雅可比法的优化高频光滑因子 $\\mu_{L}^{\\star}$，通过在 $\\omega \\in (0, 1)$ 上最小化最坏情况下的放大因子得到。\n\n为明确起见，如果一个点光滑子在 $\\mathcal{H}_{y}$ 上的优化光滑因子不超过预定目标 $\\eta$（其中 $\\eta \\in (1/3, 1)$），则称其为“充分的”。当点光滑子根据此标准不充分时，而行光滑子能够在单次扫描中达到目标，则行光滑子是“必要的”。\n\n确定临界各向异性比 $\\gamma_{c}(\\eta)$，使得当 $\\gamma \\le \\gamma_{c}(\\eta)$ 时，加权点雅可比光滑子是充分的；而当 $\\gamma > \\gamma_{c}(\\eta)$ 时，需要一个 $x$-行光滑子来达到相同的目标。将您的最终结果表示为关于 $\\eta$ 的单个闭式解析表达式。无需四舍五入。",
            "solution": "该问题要求确定一个临界各向异性比 $\\gamma_c(\\eta)$，它为一个特定的各向异性扩散问题划定了加权点雅可比光滑子的充分性与 $x$-行块雅可比光滑子的必要性之间的界限。分析将使用局部傅里叶分析 (LFA) 进行。\n\n首先，我们在网格间距为 $h$ 的均匀笛卡尔网格上离散化各向异性扩散算子 $L = -\\left(\\epsilon_{x} \\frac{\\partial^{2}}{\\partial x^{2}} + \\epsilon_{y} \\frac{\\partial^{2}}{\\partial y^{2}}\\right)$。使用标准的5点有限差分格式，作用于网格点 $(i,j)$ 处网格函数 $u_{i,j}$ 的离散算子 $L_h$ 为：\n$$\nL_h u_{i,j} = -\\epsilon_{x} \\frac{u_{i+1,j} - 2u_{i,j} + u_{i-1,j}}{h^2} - \\epsilon_{y} \\frac{u_{i,j+1} - 2u_{i,j} + u_{i,j-1}}{h^2}\n$$\n引入各向异性比 $\\gamma = \\epsilon_x / \\epsilon_y$，我们可以写出：\n$$\nL_h u_{i,j} = \\frac{\\epsilon_y}{h^2} \\left[ -\\gamma(u_{i+1,j} - 2u_{i,j} + u_{i-1,j}) - (u_{i,j+1} - 2u_{i,j} + u_{i,j-1}) \\right]\n$$\n为了执行 LFA，我们分析 $L_h$ 对傅里叶模 $v(\\theta)_{i,j} = \\exp(i(i\\theta_x + j\\theta_y))$ 的作用，其中 $\\theta = (\\theta_x, \\theta_y)$ 是傅里叶频率对。算子 $L_h$ 的符号（或特征值）$\\hat{L}_h(\\theta)$ 是通过将 $L_h$ 应用于 $v(\\theta)$ 得到的：\n$$\n\\hat{L}_h(\\theta) = \\frac{\\epsilon_y}{h^2} \\left[ -\\gamma(e^{i\\theta_x} - 2 + e^{-i\\theta_x}) - (e^{i\\theta_y} - 2 + e^{-i\\theta_y}) \\right]\n$$\n$$\n\\hat{L}_h(\\theta) = \\frac{\\epsilon_y}{h^2} \\left[ -2\\gamma(\\cos\\theta_x - 1) - 2(\\cos\\theta_y - 1) \\right] = \\frac{2\\epsilon_y}{h^2} \\left[ \\gamma(1-\\cos\\theta_x) + (1-\\cos\\theta_y) \\right]\n$$\n使用半角恒等式 $1 - \\cos\\alpha = 2\\sin^2(\\alpha/2)$，符号变为：\n$$\n\\hat{L}_h(\\theta) = \\frac{4\\epsilon_y}{h^2} \\left[ \\gamma\\sin^2\\left(\\frac{\\theta_x}{2}\\right) + \\sin^2\\left(\\frac{\\theta_y}{2}\\right) \\right]\n$$\n\n接下来，我们分析两种松弛格式的光滑特性。光滑因子是误差放大符号的幅值在高频集 $\\mathcal{H}_{y} = \\{(\\theta_{x}, \\theta_{y}) : -\\pi \\le \\theta_{x} \\le \\pi, \\, \\pi/2 \\le |\\theta_{y}| \\le \\pi\\}$ 上的上确界。\n\n$1.$ 加权点雅可比法\n对于系统 $L_h u = f$，加权雅可比迭代由 $u^{(k+1)} = u^{(k)} - \\omega D^{-1}(L_h u^{(k)} - f)$ 给出，其中 $D$ 是 $L_h$ 的对角部分。误差 $e^{(k)}$ 根据 $e^{(k+1)} = (I - \\omega D^{-1}L_h)e^{(k)}$ 传播。误差放大算子 $S_J = I - \\omega D^{-1}L_h$ 的符号是 $\\hat{S}_J(\\theta) = 1 - \\omega \\hat{D}^{-1}\\hat{L}_h(\\theta)$。\n$L_h$ 格式的对角元是 $u_{i,j}$ 的系数，即 $D = \\frac{\\epsilon_y}{h^2}(2\\gamma + 2)$。\n因此，放大符号为：\n$$\n\\hat{S}_J(\\theta) = 1 - \\omega \\frac{\\frac{4\\epsilon_y}{h^2} \\left[ \\gamma\\sin^2\\left(\\frac{\\theta_x}{2}\\right) + \\sin^2\\left(\\frac{\\theta_y}{2}\\right) \\right]}{\\frac{2\\epsilon_y}{h^2}(2\\gamma+2)} = 1 - \\frac{2\\omega}{\\gamma+1} \\left[ \\gamma\\sin^2\\left(\\frac{\\theta_x}{2}\\right) + \\sin^2\\left(\\frac{\\theta_y}{2}\\right) \\right]\n$$\n令 $s_x = \\sin^2(\\theta_x/2)$ 和 $s_y = \\sin^2(\\theta_y/2)$。在傅里叶域 $\\theta \\in [-\\pi, \\pi]^2$ 上，$s_x \\in [0, 1]$ 且 $s_y \\in [0, 1]$。对于高频集 $\\mathcal{H}_y$，我们有 $\\theta_x \\in [-\\pi, \\pi]$ 和 $|\\theta_y| \\in [\\pi/2, \\pi]$。这意味着 $s_x \\in [0, 1]$ 且 $s_y \\in [\\sin^2(\\pi/4), \\sin^2(\\pi/2)] = [1/2, 1]$。\n令 $X = \\frac{2}{\\gamma+1}(\\gamma s_x + s_y)$。放大因子为 $1-\\omega X$。我们需要找到当 $\\theta \\in \\mathcal{H}_y$ 时 $X$ 的范围。\n$\\gamma s_x + s_y$ 的最小值在 $s_x=0, s_y=1/2$ 时取得，为 $1/2$。最大值在 $s_x=1, s_y=1$ 时取得，为 $\\gamma+1$。\n所以，$X_{min} = \\frac{2}{\\gamma+1}\\left(\\frac{1}{2}\\right) = \\frac{1}{\\gamma+1}$ 且 $X_{max} = \\frac{2}{\\gamma+1}(\\gamma+1) = 2$。\n对于给定的 $\\omega$，光滑因子为 $\\mu_J(\\omega, \\gamma) = \\sup_{\\theta \\in \\mathcal{H}_y} |\\hat{S}_J(\\theta)| = \\sup_{X \\in [1/(\\gamma+1), 2]} |1-\\omega X| = \\max\\left(\\left|1 - \\frac{\\omega}{\\gamma+1}\\right|, |1-2\\omega|\\right)$。\n为了找到优化光滑因子 $\\mu_J^\\star(\\gamma)$，我们对 $\\omega \\in (0, 1)$ 最小化 $\\mu_J(\\omega, \\gamma)$。当 max 函数的两个参数幅值相等时取得最小值：$1 - \\frac{\\omega^*}{\\gamma+1} = -(1-2\\omega^*) = 2\\omega^* - 1$。\n$$\n2 = \\omega^*\\left(2 + \\frac{1}{\\gamma+1}\\right) = \\omega^*\\left(\\frac{2\\gamma+3}{\\gamma+1}\\right) \\implies \\omega^* = \\frac{2(\\gamma+1)}{2\\gamma+3}\n$$\n对于 $\\gamma>0$，这个最优权重在 $(0,1)$ 区间内。优化光滑因子是此权重下的值：\n$$\n\\mu_J^\\star(\\gamma) = |1-2\\omega^*| = \\left|1 - 2\\frac{2(\\gamma+1)}{2\\gamma+3}\\right| = \\left|\\frac{2\\gamma+3 - 4\\gamma-4}{2\\gamma+3}\\right| = \\left|\\frac{-2\\gamma-1}{2\\gamma+3}\\right| = \\frac{2\\gamma+1}{2\\gamma+3}\n$$\n\n$2.$ $x$-行块雅可比法\n在 $x$-行雅可比松弛中，我们同时精确求解一条水平线上的所有变量。迭代过程为 $u^{(k+1)} = (1-\\omega)u^{(k)} + \\omega u^{(k+1/2)}$，其中 $u^{(k+1/2)}$ 是通过沿每条 $x$-线求解系统得到的，求解时使用了第 $k$ 次迭代中相邻线上的值。加权行雅可比法的误差放大算子 $S_L$ 的符号为：\n$$\n\\hat{S}_L(\\theta) = 1-\\omega + \\omega \\frac{\\hat{N}(\\theta)}{\\hat{T}(\\theta)}\n$$\n其中 $\\hat{T}(\\theta)$ 是块对角部分（$x$-行算子）的符号，而 $\\hat{N}(\\theta)$ 是非对角部分（线间耦合）的符号。\n$x$-行算子是 $-\\epsilon_x \\frac{\\partial^2}{\\partial x^2} + \\frac{2\\epsilon_y}{h^2}I$。其符号为 $\\hat{T}(\\theta_x) = \\frac{4\\epsilon_y}{h^2}\\gamma\\sin^2(\\frac{\\theta_x}{2}) + \\frac{2\\epsilon_y}{h^2}$。\n行间耦合算子是 $\\frac{\\epsilon_y}{h^2}(u_{i,j-1} + u_{i,j+1})$。其符号为 $\\frac{\\epsilon_y}{h^2}(e^{-i\\theta_y} + e^{i\\theta_y}) = \\frac{2\\epsilon_y}{h^2}\\cos\\theta_y$。\n完整算子的符号是 $\\hat{L_h}(\\theta) = \\hat{T}(\\theta_x) - \\frac{2\\epsilon_y}{h^2}\\cos\\theta_y$。行雅可比迭代符号来自 $e^{(k+1)} = (1-\\omega)e^{(k)} + \\omega \\hat{T}(\\theta_x)^{-1}(\\frac{2\\epsilon_y}{h^2} \\cos\\theta_y) e^{(k)}$。\n$$\n\\hat{S}_L(\\theta) = 1-\\omega + \\omega \\frac{\\frac{2\\epsilon_y}{h^2}\\cos\\theta_y}{\\frac{4\\epsilon_y}{h^2}\\gamma\\sin^2(\\frac{\\theta_x}{2}) + \\frac{2\\epsilon_y}{h^2}} = 1-\\omega + \\omega \\frac{\\cos\\theta_y}{2\\gamma\\sin^2(\\frac{\\theta_x}{2}) + 1}\n$$\n$$\n\\hat{S}_L(\\theta) = 1 - \\omega\\left(1 - \\frac{\\cos\\theta_y}{2\\gamma\\sin^2(\\theta_x/2) + 1}\\right)\n$$\n令 $Y = 1 - \\frac{\\cos\\theta_y}{2\\gamma s_x + 1}$。对于 $\\theta \\in \\mathcal{H}_y$，我们有 $s_x \\in [0, 1]$ 和 $\\cos\\theta_y \\in [-1, 0]$。\n分母 $2\\gamma s_x + 1$ 的范围是 $[1, 2\\gamma+1]$。\n分数 $\\frac{\\cos\\theta_y}{2\\gamma s_x + 1}$ 的范围从最小值 $\\frac{-1}{1} = -1$（当 $s_x=0, \\cos\\theta_y=-1$ 时）到最大值 $0$（当 $\\cos\\theta_y=0$ 时）。\n所以，$Y$ 的范围是 $[1-0, 1-(-1)] = [1, 2]$。\n光滑因子为 $\\mu_L(\\omega) = \\sup_{Y \\in [1, 2]} |1-\\omega Y| = \\max(|1-\\omega|, |1-2\\omega|)$，这与 $\\gamma$ 无关。\n为了优化，我们令 $1-\\omega^* = -(1-2\\omega^*) \\implies 2=3\\omega^* \\implies \\omega^*=2/3$。\n优化光滑因子为 $\\mu_L^\\star = |1-2/3|=1/3$。\n\n确定临界各向异性比 $\\gamma_c(\\eta)$\n如果加权点雅可比光滑子的优化光滑因子不超过目标 $\\eta$，即 $\\mu_J^\\star(\\gamma) \\le \\eta$，则该光滑子是充分的。\n$$\n\\frac{2\\gamma+1}{2\\gamma+3} \\le \\eta\n$$\n因为 $\\gamma>0$ 且 $\\eta \\in (1/3, 1)$，我们可以乘以 $2\\gamma+3$ 而不改变不等号方向。\n$$\n2\\gamma+1 \\le \\eta(2\\gamma+3)\n$$\n$$\n2\\gamma+1 \\le 2\\eta\\gamma + 3\\eta\n$$\n$$\n1 - 3\\eta \\le 2\\eta\\gamma - 2\\gamma\n$$\n$$\n1 - 3\\eta \\le 2\\gamma(\\eta-1)\n$$\n因为 $\\eta \\in (1/3, 1)$，所以 $\\eta-1  0$。除以 $2(\\eta-1)$ 会反转不等号：\n$$\n\\gamma \\ge \\frac{1-3\\eta}{2(\\eta-1)} = \\frac{-(3\\eta-1)}{-2(1-\\eta)} = \\frac{3\\eta-1}{2(1-\\eta)}\n$$\n函数 $\\mu_J^\\star(\\gamma)$ 是关于 $\\gamma$ 单调递增的。因此，条件 $\\mu_J^\\star(\\gamma) \\le \\eta$ 对于较小的 $\\gamma$ 值是满足的。重新检查代数运算：\n$$\n2\\gamma - 2\\eta\\gamma \\le 3\\eta - 1 \\implies 2\\gamma(1-\\eta) \\le 3\\eta - 1\n$$\n因为 $1-\\eta  0$，我们有：\n$$\n\\gamma \\le \\frac{3\\eta-1}{2(1-\\eta)}\n$$\n这是点光滑子为充分的条件。临界各向异性比 $\\gamma_c(\\eta)$ 是该条件成立的 $\\gamma$ 的最大值。它通过将不等式设为等式来找到：\n$$\n\\gamma_c(\\eta) = \\frac{3\\eta-1}{2(1-\\eta)}\n$$\n对于 $\\gamma \\le \\gamma_c(\\eta)$，点雅可比光滑子是充分的。对于 $\\gamma  \\gamma_c(\\eta)$，它是不充分的。在这种情况下，如果 $x$-行光滑子能达到目标，则它是必要的。优化的行光滑子具有光滑因子 $\\mu_L^\\star = 1/3$。问题陈述 $\\eta \\in (1/3, 1)$，这意味着 $1/3  \\eta$。因此，条件 $\\mu_L^\\star \\le \\eta$ 总是满足的 ($1/3 \\le \\eta$)。这证实了 $x$-行光滑子总能达到目标，因此在点雅可比法失效时是必要的。",
            "answer": "$$\\boxed{\\frac{3\\eta-1}{2(1-\\eta)}}$$"
        },
        {
            "introduction": "在多重网格框架中，平滑器的主要作用不是求解整个系统，而是高效地衰减高频误差分量。最后一个练习将这一核心原则转化为一个实用的算法工具。你将实现一个智能停止准则，一旦残差的高频成分被充分削弱，就终止松弛过程，此时误差已经变得“平滑”，为有效的粗网格校正做好了准备。",
            "id": "3387287",
            "problem": "考虑在单位区间上带有齐次狄利克雷边界条件的标准一维泊松问题，该问题通过二阶中心有限差分进行离散化。设内部网格点数为 $n \\in \\mathbb{N}$，均匀网格间距为 $h = 1/(n+1)$，并令 $A \\in \\mathbb{R}^{n \\times n}$ 表示与离散拉普拉斯算子对应的三对角刚度矩阵，其元素为 $A_{jj} = \\frac{2}{h^{2}}$ 和 $A_{j,j\\pm 1} = -\\frac{1}{h^{2}}$。考虑线性系统 $A u = b$，初始猜测值为 $u^{(0)} = 0$。\n\n我们通过加权雅可比（Weighted Jacobi, WJ）方法研究松弛的误差光滑特性，该方法由以下迭代定义\n$$\nu^{(k+1)} = u^{(k)} + \\omega D^{-1} \\left(b - A u^{(k)}\\right),\n$$\n其中 $D$ 是 $A$ 的对角部分，$\\omega \\in (0,1)$ 是松弛权重。将第 $k$ 次迭代的残差定义为 $r^{(k)} = b - A u^{(k)}$。\n\n为了使停止准则相对于一个因子为 2 的粗网格具有频率感知能力，请按以下步骤进行。令 $\\{\\varphi_{k}\\}_{k=1}^{n}$ 表示在 $n$ 个内部点上的一维离散拉普拉斯算子的狄利克雷本征模，这些本征模与 I 型离散正弦变换（DST）的基函数 $\\varphi_{k}(j) = \\sin\\!\\big(\\theta_{k} j\\big)$ 一致，其中 $\\theta_{k} = \\frac{k \\pi}{n+1}$ 且 $j \\in \\{1,2,\\dots, n\\}$。频率 $\\theta_{k} \\in \\left(\\frac{\\pi}{2}, \\pi\\right)$（等价于索引 $k  \\frac{n+1}{2}$）对于因子为 2 的粗网格是不可见的，因为它们会因混叠而超出粗网格的奈奎斯特极限。将这些粗网格不可见模式的索引集表示为\n$$\n\\mathcal{K}_{\\text{high}} = \\left\\{ k \\in \\{1,\\dots,n\\} \\,:\\, k  \\frac{n+1}{2} \\right\\}.\n$$\n\n对于任何残差向量 $r \\in \\mathbb{R}^{n}$，令 $\\widehat{r} = \\mathrm{DST}_{\\mathrm{I}}(r)$ 表示其经过正交归一化的 I 型离散正弦变换。残差 $r$ 相对于粗网格的高频成分由以下分数来量化\n$$\n\\phi(r) = \\frac{\\left\\| \\widehat{r}_{\\mathcal{K}_{\\text{high}}} \\right\\|_{2}}{\\left\\| \\widehat{r} \\right\\|_{2}},\n$$\n其中 $\\widehat{r}_{\\mathcal{K}_{\\text{high}}}$ 是 $\\widehat{r}$ 在索引集 $\\mathcal{K}_{\\text{high}}$ 上的限制。正弦函数内的所有角度都应以弧度为单位。\n\n您的任务是实现一个程序，针对每个指定的测试用例，从 $u^{(0)} = 0$ 开始执行加权雅可比松弛，并使用频率感知停止规则：在第一个满足 $\\phi\\!\\left(r^{(k)}\\right) \\le \\tau$ 的迭代 $k$ 处停止，其中 $\\tau  0$ 是给定的阈值。如果该条件在 $k=0$ 时已经满足，则返回 0 次迭代。如果在给定的最大迭代次数内未满足该条件，则停止并返回该最大值。\n\n为了确保初始残差 $r^{(0)}$ 包含可控的高低频混合成分，通过一个预设的合成解将右侧项构造为 $b = A v$\n$$\nv_{j} = \\sin\\!\\big(k_{\\text{hi}} \\pi x_{j}\\big) + \\alpha \\sin\\!\\big(k_{\\text{lo}} \\pi x_{j}\\big), \\quad x_{j} = j h,\n$$\n其中整数 $k_{\\text{hi}}, k_{\\text{lo}} \\in \\{1,\\dots,n\\}$，混合系数 $\\alpha  0$。这保证了 $r^{(0)} = b$ 具有与 $v$ 相同的模态内容，并由 $A$ 的特征值进行缩放。\n\n请将您的推导和实现建立在以下基本且经过充分检验的事实之上：一维拉普拉斯算子的二阶有限差分离散化，加权雅可比松弛的定义，对于具有齐次狄利克雷边界条件的向量，I 型离散正弦变换的正交性和完备性，以及将因子为 2 的粗化中粗网格不可见频率表征为索引 $k  \\frac{n+1}{2}$ 的频率。\n\n实现上述频率感知停止准则，并为每个测试用例返回达到 $\\phi\\!\\left(r^{(k)}\\right) \\le \\tau$ 所需的最小非负整数迭代次数。角度单位为弧度。不涉及物理单位。\n\n需要实现和评估的测试套件：\n- 案例 1（有效权重的通用平滑）：$n = 63$，$\\omega = \\frac{2}{3}$，$k_{\\text{hi}} = 40$，$k_{\\text{lo}} = 1$，$\\alpha = 0.1$，$\\tau = 10^{-6}$，$\\text{max\\_iters} = 10000$。\n- 案例 2（较小权重导致的较慢平滑）：$n = 63$，$\\omega = 0.5$，$k_{\\text{hi}} = 40$，$k_{\\text{lo}} = 1$，$\\alpha = 0.1$，$\\tau = 10^{-6}$，$\\text{max\\_iters} = 10000$。\n- 案例 3（较小网格的边界情况）：$n = 15$，$\\omega = \\frac{2}{3}$，$k_{\\text{hi}} = 10$，$k_{\\text{lo}} = 2$，$\\alpha = 0.2$，$\\tau = 10^{-5}$，$\\text{max\\_iters} = 10000$。\n- 案例 4（宽松阈值）：$n = 63$，$\\omega = \\frac{2}{3}$，$k_{\\text{hi}} = 48$，$k_{\\text{lo}} = 2$，$\\alpha = 0.1$，$\\tau = 2 \\times 10^{-1}$，$\\text{max\\_iters} = 10000$。\n\n要求的最终输出格式：\n您的程序应生成单行输出，其中包含四个测试用例的迭代次数，格式为方括号括起来的逗号分隔列表（例如，$[i_{1},i_{2},i_{3},i_{4}]$），其中每个 $i_{m}$ 是由频率感知停止规则为测试用例 $m$ 确定的整数迭代次数。",
            "solution": "该问题是有效的，因为它提出了一个定义明确、科学合理的任务，其根源在于偏微分方程的数值分析。该问题是完整、一致且客观的。我们着手提供一个完整的解决方案。\n\n目标是确定将残差的高频成分降低到指定阈值 $\\tau$ 以下所需的加权雅可比迭代次数。该过程针对具有 $n$ 个内部点网格上的一维泊松问题进行模拟。\n\n首先，我们建立数学框架。该问题被离散化为一个线性系统 $A u = b$，其中 $A \\in \\mathbb{R}^{n \\times n}$ 是表示带有齐次狄利克雷边界条件的负拉普拉斯算子的二阶有限差分近似的刚度矩阵。网格间距为 $h = 1/(n+1)$。矩阵 $A$ 是三对角矩阵，其对角线元素为 $A_{j,j} = 2/h^2$，次对角线元素为 $A_{j,j\\pm 1} = -1/h^2$。\n\n迭代方法是加权雅可比（WJ）格式，其解向量 $u \\in \\mathbb{R}^n$ 的更新规则定义如下：\n$$\nu^{(k+1)} = u^{(k)} + \\omega D^{-1} \\left(b - A u^{(k)}\\right)\n$$\n其中 $k$ 是迭代索引，$\\omega \\in (0,1)$ 是给定的权重，$D$ 是 $A$ 的对角部分。在这种情况下，$D$ 是一个标量矩阵，$D = (2/h^2)I$，其中 $I$ 是 $n \\times n$ 的单位矩阵。因此，$D^{-1} = (h^2/2)I$。\n\n残差定义为 $r^{(k)} = b - A u^{(k)}$。一种更有效地跟踪残差的方法是直接推导其更新规则：\n$$\nr^{(k+1)} = b - A u^{(k+1)} = b - A\\left(u^{(k)} + \\omega D^{-1} r^{(k)}\\right) = \\left(b - A u^{(k)}\\right) - \\omega A D^{-1} r^{(k)}\n$$\n这可以简化为：\n$$\nr^{(k+1)} = \\left(I - \\omega A D^{-1}\\right) r^{(k)}\n$$\n矩阵 $M_{WJ} = I - \\omega A D^{-1}$ 是残差的迭代矩阵。代入 $A$ 和 $D^{-1}$ 的表达式，残差向量 $r^{(k)} \\in \\mathbb{R}^n$ 各分量的更新规则可以表示为一种模板操作：\n$$\nr^{(k+1)}_j = (1-\\omega)r^{(k)}_j + \\frac{\\omega}{2}\\left(r^{(k)}_{j-1} + r^{(k)}_{j+1}\\right)\n$$\n对于内部点 $j \\in \\{2, \\ldots, n-1\\}$。在边界 $j=1$ 和 $j=n$ 处，模板被调整为单边差分，以反映 $M_{WJ}$ 的结构：\n$$\nr^{(k+1)}_1 = (1-\\omega)r^{(k)}_1 + \\frac{\\omega}{2} r^{(k)}_2\n$$\n$$\nr^{(k+1)}_n = (1-\\omega)r^{(k)}_n + \\frac{\\omega}{2} r^{(k)}_{n-1}\n$$\n\n问题的核心在于分析残差的频率成分。矩阵 $A$ 的特征向量是离散正弦函数（DST-I 基）：\n$$\n\\varphi_k, \\quad \\text{其分量为} \\quad [\\varphi_k]_j = \\sin\\left(\\frac{k \\pi j}{n+1}\\right) \\quad \\text{对于 } j, k \\in \\{1, \\ldots, n\\}\n$$\n每个特征向量 $\\varphi_k$ 对应的特征值为：\n$$\n\\lambda_k = \\frac{4}{h^2} \\sin^2\\left(\\frac{k \\pi}{2(n+1)}\\right)\n$$\n由于 $\\{\\varphi_k\\}$ 构成一个基，任何残差向量 $r$ 都可以展开为 $r = \\sum_k c_k \\varphi_k$。WJ 迭代通过将每个频率分量乘以一个放大因子 $\\mu_k$ 来作用于它，这个因子是迭代矩阵 $M_{WJ}$ 对应于特征向量 $\\varphi_k$ 的特征值：\n$$\n\\mu_k = 1 - \\frac{\\omega h^2}{2}\\lambda_k = 1 - 2\\omega \\sin^2\\left(\\frac{k \\pi}{2(n+1)}\\right)\n$$\n对于高频（$k$ 接近 $n$），$\\sin^2(\\dots)$ 项接近 1，因此 $\\mu_k \\approx 1-2\\omega$。当选择 $\\omega = 2/3$ 时，对于所有高频，这给出 $|\\mu_k| \\le 1/3$，从而导致它们的快速衰减。这就是“光滑”特性。低频（$k$ 接近 1）衰减缓慢，因为 $\\mu_k \\approx 1$。\n\n初始残差被构造成高频和低频的混合。从 $u^{(0)}=0$ 开始，初始残差为 $r^{(0)} = b$。右侧项 $b$ 被设置为 $b=Av$，其中合成解为 $v = \\varphi_{k_{\\text{hi}}} + \\alpha \\varphi_{k_{\\text{lo}}}$。利用特征向量的性质 $Av = A(\\varphi_{k_{\\text{hi}}} + \\alpha\\varphi_{k_{\\text{lo}}}) = \\lambda_{k_{\\text{hi}}}\\varphi_{k_{\\text{hi}}} + \\alpha\\lambda_{k_{\\text{lo}}}\\varphi_{k_{\\text{lo}}}$。因此，\n$$\nr^{(0)} = \\lambda_{k_{\\text{hi}}} \\varphi_{k_{\\text{hi}}} + \\alpha\\lambda_{k_{\\text{lo}}} \\varphi_{k_{\\text{lo}}}\n$$\n这为我们的模拟提供了一个明确定义的初始状态。\n\n停止准则是基于高频分量的相对能量。高频模式是指那些无法在只有一半点数的粗网格上表示的模式，对应于索引 $k  (n+1)/2$。此类索引的集合是 $\\mathcal{K}_{\\text{high}}$。为了量化频率内容，我们使用带有正交归一化的 I 型离散正弦变换（DST-I）来计算残差 $r$ 在从 $\\{\\varphi_k\\}$ 导出的正交基中的系数 $\\widehat{r}$。停止度量为：\n$$\n\\phi(r) = \\frac{\\left\\| \\widehat{r}_{\\mathcal{K}_{\\text{high}}} \\right\\|_{2}}{\\left\\| \\widehat{r} \\right\\|_{2}}\n$$\n其中 $\\widehat{r}_{\\mathcal{K}_{\\text{high}}}$ 由索引在 $\\mathcal{K}_{\\text{high}}$ 中的系数组成。迭代在第一个满足 $\\phi(r^{(k)}) \\le \\tau$ 的步骤 $k$ 处停止。\n\n算法如下：\n1.  对于每个测试用例，定义参数 $n$、$\\omega$、$k_{\\text{hi}}$、$k_{\\text{lo}}$、$\\alpha$、$\\tau$ 和 $\\text{max\\_iters}$。\n2.  计算网格间距 $h=1/(n+1)$ 和特征值 $\\lambda_{k_{\\text{hi}}}$、$\\lambda_{k_{\\text{lo}}}$。\n3.  构造初始残差向量 $r^{(0)} = \\lambda_{k_{\\text{hi}}}\\varphi_{k_{\\text{hi}}} + \\alpha\\lambda_{k_{\\text{lo}}}\\varphi_{k_{\\text{lo}}}$。\n4.  计算 $\\phi(r^{(0)})$。如果 $\\phi(r^{(0)}) \\le \\tau$，则过程以 0 次迭代停止。\n5.  否则，从 $k=1$ 到 $\\text{max\\_iters}$ 进行迭代：\n    a. 使用高效的模板计算从 $r^{(k-1)}$ 更新残差向量 $r^{(k)}$。\n    b. 计算 $r^{(k)}$ 的正交归一化 DST-I 以获得系数 $\\widehat{r}^{(k)}$。\n    c. 通过取 $\\widehat{r}^{(k)}$ 的高频分量和全部分量的向量范数之比来计算 $\\phi(r^{(k)})$。\n    d. 如果 $\\phi(r^{(k)}) \\le \\tau$，记录迭代次数 $k$ 并终止此案例的循环。\n6.  如果循环完成但未满足准则，则结果为 $\\text{max\\_iters}$。\n7.  收集所有测试用例的迭代次数。所有角度计算均以弧度为单位进行。",
            "answer": "```python\nimport numpy as np\nfrom scipy import fft\n\ndef calculate_phi(r, n):\n    \"\"\"\n    Calculates the high-frequency content ratio phi for a given residual vector.\n    \n    Args:\n        r (np.ndarray): The residual vector of size n.\n        n (int): The number of interior grid points.\n        \n    Returns:\n        float: The high-frequency content ratio phi(r).\n    \"\"\"\n    # The problem statement defines high-frequency modes with 1-based indices k > (n+1)/2.\n    # We create a boolean mask for these modes.\n    k_1based = np.arange(1, n + 1)\n    high_freq_mask = k_1based > (n + 1) / 2.0\n    \n    # Compute the Discrete Sine Transform of type I with orthonormal normalization.\n    # The output array `r_hat` corresponds to modes k=1, ..., n.\n    # `r_hat[i]` is the coefficient for mode i+1.\n    r_hat = fft.dst(r, type=1, norm='ortho')\n    \n    # Extract the coefficients corresponding to high-frequency modes using the mask.\n    r_hat_high = r_hat[high_freq_mask]\n    \n    # Calculate the L2 norm of the high-frequency components.\n    norm_r_hat_high = np.linalg.norm(r_hat_high)\n    \n    # Calculate the L2 norm of the total set of components.\n    # Due to Parseval's theorem for an orthonormal transform, this is equal to np.linalg.norm(r).\n    norm_r_hat_total = np.linalg.norm(r_hat)\n    \n    # Avoid division by zero if the residual is zero.\n    if norm_r_hat_total == 0:\n        return 0.0\n        \n    return norm_r_hat_high / norm_r_hat_total\n\ndef solve_case(n, omega, k_hi, k_lo, alpha, tau, max_iters):\n    \"\"\"\n    Solves one test case of the frequency-aware stopping problem.\n    \n    Returns:\n        int: The number of iterations required.\n    \"\"\"\n    \n    # 1. Setup constants and grid\n    h = 1.0 / (n + 1)\n    x = np.arange(1, n + 1, dtype=float) * h\n    \n    # Function to compute eigenvalues of the discrete Laplacian matrix A\n    def get_eigenvalue(k_mode, n_pts, h_spacing):\n        return (4.0 / h_spacing**2) * np.sin(k_mode * np.pi / (2.0 * (n_pts + 1)))**2\n        \n    lambda_hi = get_eigenvalue(k_hi, n, h)\n    lambda_lo = get_eigenvalue(k_lo, n, h)\n    \n    # Unnormalized eigenvectors (modes)\n    phi_hi = np.sin(k_hi * np.pi * x)\n    phi_lo = np.sin(k_lo * np.pi * x)\n    \n    # 2. Construct the initial residual r^(0) = b = A*v\n    r_k = lambda_hi * phi_hi + alpha * lambda_lo * phi_lo\n    \n    # 3. Check stopping criterion for k = 0\n    phi_k = calculate_phi(r_k, n)\n    if phi_k = tau:\n        return 0\n        \n    # 4. Iteration Loop\n    for k in range(1, max_iters + 1):\n        r_prev = r_k.copy()\n        \n        # Update residual using the efficient stencil application of (I - omega*A*D^-1)\n        r_k[1:-1] = (1.0 - omega) * r_prev[1:-1] + (omega / 2.0) * (r_prev[:-2] + r_prev[2:])\n        r_k[0] = (1.0 - omega) * r_prev[0] + (omega / 2.0) * r_prev[1]\n        r_k[-1] = (1.0 - omega) * r_prev[-1] + (omega / 2.0) * r_prev[-2]\n        \n        # Calculate phi for the new residual\n        phi_k = calculate_phi(r_k, n)\n\n        # Check stopping criterion\n        if phi_k = tau:\n            return k\n            \n    # 5. If criterion is not met within max_iters, return max_iters\n    return max_iters\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the results.\n    \"\"\"\n    test_cases = [\n        # (n, omega, k_hi, k_lo, alpha, tau, max_iters)\n        (63, 2.0/3.0, 40, 1, 0.1, 1e-6, 10000),\n        (63, 0.5, 40, 1, 0.1, 1e-6, 10000),\n        (15, 2.0/3.0, 10, 2, 0.2, 1e-5, 10000),\n        (63, 2.0/3.0, 48, 2, 0.1, 2e-1, 10000),\n    ]\n\n    results = []\n    for case in test_cases:\n        result = solve_case(*case)\n        results.append(result)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}