{
    "hands_on_practices": [
        {
            "introduction": "要理解多重网格方法的工作原理，我们首先必须分析离散算子如何作用于误差的不同分量。局部傅里叶分析 (Local Fourier Analysis, LFA) 是一种强大的工具，它将误差分量视为傅里叶模态。本练习将引导你对标准的二维拉普拉斯算子进行LFA分析，这是理解许多偏微分方程数值方法的基础。",
            "id": "3399342",
            "problem": "考虑在环面（周期性区域）上的二维泊松方程，该方程在两个方向上间距均为 $h$ 的结构化笛卡尔网格上离散化。设离散算子 $A$ 是标准的五点正定拉普拉斯算子模板，定义为\n$$\n[A u]_{i,j} \\;=\\; \\frac{1}{h^{2}}\\Big(4\\,u_{i,j} \\;-\\; u_{i+1,j} \\;-\\; u_{i-1,j} \\;-\\; u_{i,j+1} \\;-\\; u_{i,j-1}\\Big),\n$$\n两个方向上的索引均是周期性的。由于周期性网格上的平移不变性，形如\n$$\n\\varphi_{\\theta_{x},\\theta_{y}}(i,j) \\;=\\; \\exp\\!\\big(\\mathrm{i}\\,\\theta_{x}\\,i + \\mathrm{i}\\,\\theta_{y}\\,j\\big),\n$$\n的复指数网格函数是算子 $A$ 的特征函数，其中 $(\\theta_{x},\\theta_{y})$ 位于第一布里渊区 $(-\\pi,\\pi] \\times (-\\pi,\\pi]$ 内。\n\n从这个定义和复指数的性质出发，推导算子 $A$ 的傅里叶符号 $\\widehat{A}(\\theta_{x},\\theta_{y})$，然后确定其在布里渊区 $(-\\pi,\\pi] \\times (-\\pi,\\pi]$ 上的最小值和最大值。将您的最终答案表示为由 $\\widehat{A}(\\theta_{x},\\theta_{y})$ 在布里渊区上的最小值和最大值组成的有序对。无需四舍五入。",
            "solution": "算子 $A$ 是周期性网格上的一个线性、位移不变的模板。在这样的网格上，复指数网格函数\n$$\n\\varphi_{\\theta_{x},\\theta_{y}}(i,j) \\;=\\; \\exp\\!\\big(\\mathrm{i}\\,\\theta_{x}\\,i + \\mathrm{i}\\,\\theta_{y}\\,j\\big),\n$$\n是任何平移不变离散算子的特征函数。对应的特征值就是该算子的傅里叶符号。我们显式地计算 $[A \\varphi]_{i,j}$。\n\n根据 $A$ 的定义，\n$$\n[A \\varphi]_{i,j} \\;=\\; \\frac{1}{h^{2}}\\Big(4\\,\\varphi_{i,j} \\;-\\; \\varphi_{i+1,j} \\;-\\; \\varphi_{i-1,j} \\;-\\; \\varphi_{i,j+1} \\;-\\; \\varphi_{i,j-1}\\Big).\n$$\n使用 $\\varphi$ 的定义，\n$$\n\\varphi_{i+1,j} \\;=\\; \\exp\\!\\big(\\mathrm{i}\\,\\theta_{x}(i+1) + \\mathrm{i}\\,\\theta_{y}\\,j\\big) \\;=\\; \\exp\\!\\big(\\mathrm{i}\\,\\theta_{x}\\big)\\,\\varphi_{i,j},\n$$\n$$\n\\varphi_{i-1,j} \\;=\\; \\exp\\!\\big(-\\mathrm{i}\\,\\theta_{x}\\big)\\,\\varphi_{i,j}, \\quad\n\\varphi_{i,j+1} \\;=\\; \\exp\\!\\big(\\mathrm{i}\\,\\theta_{y}\\big)\\,\\varphi_{i,j}, \\quad\n\\varphi_{i,j-1} \\;=\\; \\exp\\!\\big(-\\mathrm{i}\\,\\theta_{y}\\big)\\,\\varphi_{i,j}.\n$$\n代入这些关系式得到\n$$\n[A \\varphi]_{i,j} \\;=\\; \\frac{1}{h^{2}}\\Big(4 \\;-\\; \\exp\\!\\big(\\mathrm{i}\\,\\theta_{x}\\big) \\;-\\; \\exp\\!\\big(-\\mathrm{i}\\,\\theta_{x}\\big) \\;-\\; \\exp\\!\\big(\\mathrm{i}\\,\\theta_{y}\\big) \\;-\\; \\exp\\!\\big(-\\mathrm{i}\\,\\theta_{y}\\big)\\Big)\\,\\varphi_{i,j}.\n$$\n因此，傅里叶符号是\n$$\n\\widehat{A}(\\theta_{x},\\theta_{y}) \\;=\\; \\frac{1}{h^{2}}\\Big(4 \\;-\\; \\exp\\!\\big(\\mathrm{i}\\,\\theta_{x}\\big) \\;-\\; \\exp\\!\\big(-\\mathrm{i}\\,\\theta_{x}\\big) \\;-\\; \\exp\\!\\big(\\mathrm{i}\\,\\theta_{y}\\big) \\;-\\; \\exp\\!\\big(-\\mathrm{i}\\,\\theta_{y}\\big)\\Big).\n$$\n使用恒等式 $\\exp\\!\\big(\\mathrm{i}\\,\\theta\\big) + \\exp\\!\\big(-\\mathrm{i}\\,\\theta\\big) = 2\\cos(\\theta)$，我们简化得到\n$$\n\\widehat{A}(\\theta_{x},\\theta_{y}) \\;=\\; \\frac{1}{h^{2}}\\Big(4 \\;-\\; 2\\cos(\\theta_{x}) \\;-\\; 2\\cos(\\theta_{y})\\Big).\n$$\n\n现在我们来确定 $\\widehat{A}(\\theta_{x},\\theta_{y})$ 在 $(\\theta_{x},\\theta_{y}) \\in (-\\pi,\\pi] \\times (-\\pi,\\pi]$ 上的极值。定义\n$$\nf(\\theta_{x},\\theta_{y}) \\;=\\; 4 \\;-\\; 2\\cos(\\theta_{x}) \\;-\\; 2\\cos(\\theta_{y}).\n$$\n由于对所有 $\\theta$ 都有 $\\cos(\\theta) \\in [-1,1]$，所以每一项 $-2\\cos(\\theta)$ 的值域是 $[-2,2]$。因此，和 $-2\\cos(\\theta_{x}) - 2\\cos(\\theta_{y})$ 的范围是从 $-4$（当两个余弦值都为 $1$ 时）到 $4$（当两个余弦值都为 $-1$ 时）。因此，\n$$\n\\min f \\;=\\; 4 - 4 \\;=\\; 0, \\quad \\max f \\;=\\; 4 + 4 \\;=\\; 8.\n$$\n更具体地说，最小值在 $(\\theta_{x},\\theta_{y}) = (0,0)$ 处取得，得到 $f(0,0) = 0$；最大值在 $(\\theta_{x},\\theta_{y}) = (\\pi,\\pi)$ 处取得，得到 $f(\\pi,\\pi) = 8$。因此，\n$$\n\\min_{(\\theta_{x},\\theta_{y}) \\in (-\\pi,\\pi]^{2}} \\widehat{A}(\\theta_{x},\\theta_{y}) \\;=\\; \\frac{0}{h^{2}} \\;=\\; 0, \\quad\n\\max_{(\\theta_{x},\\theta_{y}) \\in (-\\pi,\\pi]^{2}} \\widehat{A}(\\theta_{x},\\theta_{y}) \\;=\\; \\frac{8}{h^{2}}.\n$$\n\n因此，由傅里叶符号在布里渊区上的最小值和最大值组成的有序对是 $0$ 和 $\\frac{8}{h^{2}}$。",
            "answer": "$$\\boxed{\\begin{pmatrix}0 & \\frac{8}{h^{2}}\\end{pmatrix}}$$"
        },
        {
            "introduction": "多重网格循环的一个关键组成部分是“光滑子”（smoother），这是一种旨在衰减高频误差分量的迭代方法。本练习聚焦于最简单的光滑子之一：加权雅可比（weighted Jacobi）方法。通过使用傅里叶分析推导其放大因子，你将深入了解光滑子如何影响不同的误差频率，并理解权重参数 $\\omega$ 的作用。",
            "id": "3399351",
            "problem": "考虑在二维环面（周期性单位正方形）上的离散泊松方程，该方程通过一个包含 $N \\times N$ 个点、网格间距为 $h = 1/N$ 的均匀笛卡尔网格进行离散化。令 $A$ 为一个 $N^{2} \\times N^{2}$ 矩阵，它对应于负拉普拉斯算子的标准五点有限差分离散，对于网格函数 $u_{i,j}$ 定义为\n$$\n(Au)_{i,j} = \\frac{1}{h^{2}}\\left(4\\,u_{i,j} - u_{i+1,j} - u_{i-1,j} - u_{i,j+1} - u_{i,j-1}\\right),\n$$\n其中 $i$ 和 $j$ 的索引都是周期性的。令 $D$ 表示 $A$ 的对角部分，并考虑加权雅可比光滑算子 $S_{J} = I - \\omega D^{-1}A$，其中权重参数为 $\\omega \\in \\mathbb{R}$。\n\n从五点模板的定义和周期性出发，推导 $D^{-1}A$ 和 $S_{J}$ 的模板形式。然后，利用周期性网格上的离散傅里叶基和局部傅里叶分析 (LFA)，推导 $S_{J}$ 的特征值作为傅里葉频率的函数，并计算 $S_{J}$ 在周期性网格上的谱半径，表示为 $\\omega$ 的显式函数。将最终答案表示为关于 $\\omega$ 的单个闭式解析表达式。无需四舍五入，且不涉及物理单位。",
            "solution": "网格上的一个线性、平移不变算子可以用一个模板来表示。算子的作用是模板与网格函数的离散卷积。$A$ 的模板是：\n$$\n[A] = \\frac{1}{h^2} \\begin{pmatrix} & -1 & \\\\ -1 & 4 & -1 \\\\ & -1 & \\end{pmatrix}\n$$\n其中矩阵的中心对应于网格点 $(i,j)$。$D$ 是 $A$ 的对角部分。对于所有网格点，该系数都是常数 $4/h^2$。因此，$D$ 是单位矩阵的一个标量倍：$D = \\frac{4}{h^2}I$。其逆为 $D^{-1} = \\frac{h^2}{4}I$。$D^{-1}A$ 的模板是：\n$$\n[D^{-1}A] = \\frac{h^2}{4} \\left( \\frac{1}{h^2} \\begin{pmatrix} & -1 & \\\\ -1 & 4 & -1 \\\\ & -1 & \\end{pmatrix} \\right) = \\frac{1}{4} \\begin{pmatrix} & -1 & \\\\ -1 & 4 & -1 \\\\ & -1 & \\end{pmatrix}\n$$\n光滑算子为 $S_J = I - \\omega D^{-1}A$。其模板由单位算子 $[I]$（中心为1，其他位置为0）和 $[D^{-1}A]$ 的模板推导得出：\n$$\n[S_J] = \\begin{pmatrix} & 0 & \\\\ 0 & 1 & 0 \\\\ & 0 & \\end{pmatrix} - \\frac{\\omega}{4} \\begin{pmatrix} & -1 & \\\\ -1 & 4 & -1 \\\\ & -1 & \\end{pmatrix} = \\begin{pmatrix} & \\frac{\\omega}{4} & \\\\ \\frac{\\omega}{4} & 1 - \\omega & \\frac{\\omega}{4} \\\\ & \\frac{\\omega}{4} & \\end{pmatrix}\n$$\n\n周期性网格上任何线性、平移不变算子的特征向量都是离散傅里葉模态。令 $\\theta_x, \\theta_y$ 为傅里叶频率。$A$ 的符号（其对于模态 $(\\theta_x, \\theta_y)$ 的特征值）是：\n$$\n\\hat{A}(\\theta_x, \\theta_y) = \\frac{1}{h^2} [4 - 2\\cos(\\theta_x) - 2\\cos(\\theta_y)] = \\frac{4}{h^2} \\left( \\sin^2\\left(\\frac{\\theta_x}{2}\\right) + \\sin^2\\left(\\frac{\\theta_y}{2}\\right) \\right)\n$$\n由于 $D=\\frac{4}{h^2}I$，其符号为常数 $\\hat{D} = 4/h^2$。$S_J = I - \\omega D^{-1}A$ 的符号为：\n$$\n\\hat{S}_J(\\theta_x, \\theta_y) = 1 - \\omega \\frac{\\hat{A}(\\theta_x, \\theta_y)}{\\hat{D}} = 1 - \\omega \\left( \\sin^2\\left(\\frac{\\theta_x}{2}\\right) + \\sin^2\\left(\\frac{\\theta_y}{2}\\right) \\right)\n$$\n这些是算子 $S_J$ 的特征值。谱半径 $\\rho(S_J)$ 是其特征值绝对值的最大值。令 $\\mu = \\sin^2(\\theta_x/2) + \\sin^2(\\theta_y/2)$。$\\mu$ 的范围是 $[0, 2]$。$S_J$ 的特征值为 $\\lambda(\\mu) = 1 - \\omega \\mu$，其中 $\\mu \\in [0, 2]$。我们需要找到 $\\rho(S_J) = \\max_{\\mu \\in [0, 2]} |1 - \\omega\\mu|$。函数 $f(\\mu) = |1 - \\omega\\mu|$ 是一个凸函数，因此它在区间 $[0, 2]$ 上的最大值必定在其中一个端点，即 $\\mu=0$ 或 $\\mu=2$ 处取得。\n-   在 $\\mu=0$ 处：$|\\lambda(0)| = |1 - \\omega \\cdot 0| = 1$。\n-   在 $\\mu=2$ 处：$|\\lambda(2)| = |1 - \\omega \\cdot 2| = |1 - 2\\omega|$。\n谱半径是这两个值中较大的一个：\n$$\n\\rho(S_J) = \\max(1, |1 - 2\\omega|)\n$$",
            "answer": "$$\n\\boxed{\\max(1, |1 - 2\\omega|)}\n$$"
        },
        {
            "introduction": "尽管雅可比方法易于分析，但在实践中通常使用更有效的光滑子，如高斯-赛德尔（Gauss-Seidel）方法。本练习深入分析了字典序高斯-赛德尔光滑子，并突显了其在高频误差阻尼方面的优越性。通过推导其复值符号并计算其光滑因子，你将体会到为何这种光滑子的不对称性使其在多重网格应用中表现更佳。",
            "id": "3399391",
            "problem": "考虑在一个具有均匀间距 $h$ 的无限结构化笛卡尔网格上的二维泊松方程 $-\\Delta u = f$，该方程通过标准五点有限差分格式进行离散化。得到的离散算子 $A$ 作用于网格函数 $\\{u_{i,j}\\}$ 的方式为 $A u_{i,j} = \\frac{1}{h^{2}}\\left(4 u_{i,j} - u_{i+1,j} - u_{i-1,j} - u_{i,j+1} - u_{i,j-1}\\right)$。在几何多重网格中，每个方向采用标准的 $2$-比-$1$ 粗化，定义低频集 $\\mathcal{L} = \\{(\\theta_{x}, \\theta_{y}) \\in [-\\pi,\\pi]^{2} : |\\theta_{x}| \\leq \\pi/2,\\, |\\theta_{y}| \\leq \\pi/2\\}$ 和高频集 $\\mathcal{H} = [-\\pi,\\pi]^{2} \\setminus \\mathcal{L}$。考虑采用字典序Gauss–Seidel排序的点松弛法，其中在网格点 $(i,j)$ 处，使用其西侧 $(i-1,j)$ 和南侧 $(i,j-1)$ 邻点的最新更新值，而使用其东侧 $(i+1,j)$ 和北侧 $(i,j+1)$ 邻点的旧值。\n\n从矩阵分裂 $A = D + L + U$ 出发，其中 $D$ 是对角部分，$L$ 包含字典序“下”邻点耦合（西侧和南侧），$U$ 包含字典序“上”邻点耦合（东侧和北侧），Gauss–Seidel误差传播算子 $S_{\\mathrm{GS}}$ 由 $S_{\\mathrm{GS}} = -(D+L)^{-1}U$ 给出。使用局部傅里叶分析（LFA）来处理无限网格上的平移不变算子，其中傅里叶模 $\\varphi_{i,j}(\\theta_{x},\\theta_{y}) = \\exp\\big(i(\\theta_{x} i + \\theta_{y} j)\\big)$ 是所有平移算子的特征函数，从而推导出对应于字典序Gauss–Seidel的标量符号 $\\widetilde{S}_{\\mathrm{GS}}(\\theta_{x},\\theta_{y})$。然后，使用此符号计算光滑因子\n$$\n\\mu_{\\mathrm{GS}} \\;=\\; \\sup_{(\\theta_{x},\\theta_{y}) \\in \\mathcal{H}} \\left| \\widetilde{S}_{\\mathrm{GS}}(\\theta_{x},\\theta_{y}) \\right|.\n$$\n从迭代的基本原理和符号的结构出发，解释为什么字典序Gauss–Seidel在某些振荡误差分量上比未加权Jacobi更有效地衰减高频模。最后，报告 $\\mu_{\\mathrm{GS}}$ 的数值。将答案四舍五入到四位有效数字。",
            "solution": "我们进行局部傅里叶分析（LFA）来推导离散算子 $A$ 的符号。LFA基于分析算子对单个傅里叶模 $\\varphi_{i,j}(\\theta_{x},\\theta_{y}) = \\exp\\big(i(\\theta_{x} i + \\theta_{y} j)\\big)$ 的作用，其中 $i$ 和 $j$ 是网格索引，$(\\theta_x, \\theta_y)$是一对频率分量。算子 $A$ 在无限网格上是平移不变的，因此傅里叶模是其特征函数。\n\n五点格式算子 $A$ 对模 $\\varphi_{i,j}$ 的作用由下式给出：\n$$\nA \\varphi_{i,j} = \\frac{1}{h^{2}}\\left(4 \\varphi_{i,j} - \\varphi_{i+1,j} - \\varphi_{i-1,j} - \\varphi_{i,j+1} - \\varphi_{i,j-1}\\right)\n$$\n利用傅里叶模的平移性质，例如 $\\varphi_{i+1,j} = \\exp(i\\theta_x) \\varphi_{i,j}$，我们得到算子 $A$ 的符号：\n$$\n\\widetilde{A}(\\theta_x, \\theta_y) = \\frac{1}{h^{2}}\\left(4 - 2\\cos(\\theta_x) - 2\\cos(\\theta_y)\\right) = \\frac{4}{h^{2}}\\left(\\sin^{2}\\left(\\frac{\\theta_x}{2}\\right) + \\sin^{2}\\left(\\frac{\\theta_y}{2}\\right)\\right)\n$$\n\n接下来，我们推导字典序Gauss–Seidel光滑子的符号。在第 $k$ 步，误差 $e^k$ 的迭代公式为 $(D+L)e^{k+1} + Ue^k = 0$，这导出了误差传播算子 $S_{\\mathrm{GS}} = -(D+L)^{-1}U$。我们分析单次Gauss-Seidel扫描对误差的单个傅里叶模的影响。在网格点 $(i,j)$ 处误差 $e_{i,j}$ 的更新规则为（针对齐次问题 $Ae=0$）：\n$$\n4 e_{i,j}^{k+1} - e_{i-1,j}^{k+1} - e_{i,j-1}^{k+1} - e_{i+1,j}^k - e_{i,j+1}^k = 0\n$$\n设扫描前的误差为 $e_{i,j}^k = \\exp\\big(i(\\theta_x i + \\theta_y j)\\big)$，扫描后的误差为 $e_{i,j}^{k+1} = \\widetilde{S}_{\\mathrm{GS}}(\\theta_x, \\theta_y) \\exp\\big(i(\\theta_x i + \\theta_y j)\\big)$。将这些代入误差方程：\n$$\n4 \\widetilde{S}_{\\mathrm{GS}} \\varphi_{i,j} - \\widetilde{S}_{\\mathrm{GS}} \\varphi_{i-1,j} - \\widetilde{S}_{\\mathrm{GS}} \\varphi_{i,j-1} - \\varphi_{i+1,j} - \\varphi_{i,j+1} = 0\n$$\n应用平移性质并除以 $\\varphi_{i,j} \\neq 0$：\n$$\n4 \\widetilde{S}_{\\mathrm{GS}} - \\widetilde{S}_{\\mathrm{GS}} \\exp(-i\\theta_x) - \\widetilde{S}_{\\mathrm{GS}} \\exp(-i\\theta_y) - \\exp(i\\theta_x) - \\exp(i\\theta_y) = 0\n$$\n解出符号 $\\widetilde{S}_{\\mathrm{GS}}(\\theta_x, \\theta_y)$：\n$$\n\\widetilde{S}_{\\mathrm{GS}}(\\theta_x, \\theta_y) \\left(4 - \\exp(-i\\theta_x) - \\exp(-i\\theta_y)\\right) = \\exp(i\\theta_x) + \\exp(i\\theta_y)\n$$\n$$\n\\widetilde{S}_{\\mathrm{GS}}(\\theta_x, \\theta_y) = \\frac{\\exp(i\\theta_x) + \\exp(i\\theta_y)}{4 - \\exp(-i\\theta_x) - \\exp(-i\\theta_y)}\n$$\n这就是所求的字典序Gauss–Seidel光滑子的标量符号。\n\n光滑因子 $\\mu_{\\mathrm{GS}}$ 是该符号的模在高频域 $\\mathcal{H} = [-\\pi,\\pi]^2 \\setminus [-\\pi/2, \\pi/2]^2$ 上的上确界。\n$$\n\\mu_{\\mathrm{GS}} = \\sup_{(\\theta_x, \\theta_y) \\in \\mathcal{H}} \\left| \\widetilde{S}_{\\mathrm{GS}}(\\theta_x, \\theta_y) \\right|\n$$\n分析表明，该上确界在分隔低频和高频的边界上达到，例如在 $\\theta_x = \\pi/2, \\theta_y \\in [-\\pi/2, \\pi/2]$。在该边界上，符号的模的平方为：\n$$\n\\left|\\widetilde{S}_{\\mathrm{GS}}(\\pi/2, \\theta_y)\\right|^2 = \\frac{2+2\\sin\\theta_y}{18-8\\cos\\theta_y+2\\sin\\theta_y}\n$$\n该函数在 $\\theta_y=2\\arctan(1/3)$ 处达到其最大值 $1/4$。因此，最大模为 $\\sqrt{1/4} = 1/2$。\n$$\n\\mu_{\\mathrm{GS}} = \\frac{1}{2} = 0.5\n$$\n\n字典序Gauss–Seidel比未加权Jacobi更有效地光滑高频模的原因在于它们各自迭代格式的结构以及由此产生的符号。未加权Jacobi的符号是实值的 $\\widetilde{S}_{\\mathrm{Jac}}(\\theta_x,\\theta_y) = \\frac{1}{2}(\\cos\\theta_x + \\cos\\theta_y)$。对于最高频率的模 $(\\theta_x, \\theta_y) = (\\pi, \\pi)$，其符号为 $-1$，意味着这种高度振荡的模根本没有被衰减。相比之下，字典序Gauss–Seidel迭代是不对称的，它在同一步更新中混合使用了旧值和新值。这反映在其复数值符号中。对于相同的最高频率模 $(\\pi, \\pi)$，Gauss-Seidel的符号是：\n$$\n\\widetilde{S}_{\\mathrm{GS}}(\\pi,\\pi) = \\frac{\\exp(i\\pi) + \\exp(i\\pi)}{4 - \\exp(-i\\pi) - \\exp(-i\\pi)} = \\frac{-1-1}{4 - (-1) - (-1)} = \\frac{-2}{6} = -\\frac{1}{3}\n$$\n其模为 $1/3$，表示显著的衰减。Gauss-Seidel的非对称扫描将修正传播到整个网格，使用来自邻点的“新鲜”信息比使用所有邻点的“陈旧”信息的Jacobi方法能更有效地消除局部高频误差。\n\n光滑因子的数值为 $0.5$。精确到四位有效数字，即为 $0.5000$。",
            "answer": "$$\n\\boxed{0.5000}\n$$"
        }
    ]
}