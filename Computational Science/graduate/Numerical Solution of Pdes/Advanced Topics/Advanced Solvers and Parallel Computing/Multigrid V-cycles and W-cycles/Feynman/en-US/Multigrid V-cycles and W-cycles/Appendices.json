{
    "hands_on_practices": [
        {
            "introduction": "To begin our hands-on exploration, we must first master the fundamental building blocks of multigrid: the operators that transfer information between grids. This exercise focuses on the restriction operator, which coarsens data, and the prolongation operator, which interpolates it back to a finer grid. By applying these standard operators to a simple quadratic function, you will gain a concrete understanding of how they work and quantify the error introduced in a single round-trip process, a key first step in analyzing the accuracy of a full multigrid cycle .",
            "id": "3347230",
            "problem": "Consider a prototypical grid-transfer step used in multigrid V-cycle and W-cycle iterations within Computational Fluid Dynamics (CFD) for a smooth scalar field representative of a Partial Differential Equation (PDE) solution. Let the computational domain be $\\Omega = [0,1] \\times [0,1]$, and let the fine grid be uniform with $9 \\times 9$ nodal points (i.e., $8$ intervals per direction), so the fine-grid spacing is $h = \\frac{1}{8}$. The coarse grid is defined by selecting every other fine-grid node, yielding $5 \\times 5$ coarse-grid nodes with spacing $2h$.\n\nLet the continuous field be $u(x,y) = x^{2} + y^{2}$, and suppose the fine-grid samples of $u$ are given exactly at the fine-grid nodes. Define the full-weighting restriction operator from fine to coarse at a coarse node $(x_{0},y_{0})$ by the nine-point stencil\n$$\n\\mathcal{R}_{\\text{FW}}[u] (x_{0},y_{0}) \\;=\\; \\frac{1}{16}\\Big(u(x_{0}-h,y_{0}-h) + 2\\,u(x_{0},y_{0}-h) + u(x_{0}+h,y_{0}-h) \\\\\n+ 2\\,u(x_{0}-h,y_{0}) + 4\\,u(x_{0},y_{0}) + 2\\,u(x_{0}+h,y_{0}) \\\\\n+ u(x_{0}-h,y_{0}+h) + 2\\,u(x_{0},y_{0}+h) + u(x_{0}+h,y_{0}+h)\\Big).\n$$\nThen define the prolongation from coarse to fine by cellwise bilinear interpolation: on a coarse cell with corners $(X_{0},Y_{0})$, $(X_{0}+2h,Y_{0})$, $(X_{0},Y_{0}+2h)$, $(X_{0}+2h,Y_{0}+2h)$, for any point $(x,y)$ in that cell with local coordinates $s,t \\in [0,1]$ such that $x = X_{0} + 2hs$ and $y = Y_{0} + 2ht$, the interpolant equals\n$$\n\\mathcal{P}_{\\text{bilinear}}[U_{c}](x,y) \\;=\\; (1-s)(1-t)\\,U_{c}(X_{0},Y_{0}) \\;+\\; s(1-t)\\,U_{c}(X_{0}+2h,Y_{0}) \\\\\n+\\; (1-s)t\\,U_{c}(X_{0},Y_{0}+2h) \\;+\\; s t\\,U_{c}(X_{0}+2h,Y_{0}+2h),\n$$\nwhere $U_{c}$ denotes the coarse-grid values obtained by restriction. Using these definitions, apply full-weighting to the given fine-grid samples of $u$ to obtain coarse-grid values, then apply bilinear interpolation to reconstruct approximate fine-grid values at the fine nodes. Compute the maximum pointwise interpolation error magnitude over all fine-grid nodes,\n$$\nE_{\\max} \\;=\\; \\max_{\\text{fine nodes }(x,y)} \\left|\\mathcal{P}_{\\text{bilinear}}\\big[\\mathcal{R}_{\\text{FW}}[u]\\big](x,y) \\;-\\; u(x,y)\\right|,\n$$\nand provide your answer in exact form as a single real number. No rounding is required, and no units are to be included in the final answer.",
            "solution": "The user wants me to solve a problem.\n\nHere's my plan:\n1.  **Validate the problem statement.**\n    *   **Extract Givens**:\n        *   Computational domain: $\\Omega = [0,1] \\times [0,1]$.\n        *   Fine grid: $9 \\times 9$ nodes, spacing $h = \\frac{1}{8}$.\n        *   Coarse grid: $5 \\times 5$ nodes, spacing $2h = \\frac{1}{4}$.\n        *   Continuous field: $u(x,y) = x^2 + y^2$.\n        *   Fine-grid values are exact samples of $u(x,y)$.\n        *   Restriction operator: $\\mathcal{R}_{\\text{FW}}$ is the full-weighting 9-point stencil.\n        *   Prolongation operator: $\\mathcal{P}_{\\text{bilinear}}$ is bilinear interpolation.\n        *   Objective: Compute $E_{\\max} = \\max_{\\text{fine nodes }(x,y)} |\\mathcal{P}_{\\text{bilinear}}[\\mathcal{R}_{\\text{FW}}[u]](x,y) - u(x,y)|$.\n    *   **Validate**:\n        *   **Scientifically Grounded**: The problem is based on standard, fundamental concepts of multigrid methods (restriction, prolongation), which are a cornerstone of numerical analysis for solving PDEs. The specific operators (full-weighting, bilinear interpolation) and the test function ($u(x,y)=x^2+y^2$) are canonical choices for analyzing the properties of such methods.\n        *   **Well-Posed**: The problem is clearly stated with all necessary definitions and values. The objective is a specific calculation leading to a unique numerical answer.\n        *   **Objective**: The problem is stated using precise mathematical language, free of ambiguity or subjective content.\n        *   **Conclusion**: The problem is valid. The mention of a continuous field $u(x,y)$ addresses the potential ambiguity of applying the restriction stencil at the boundaries of the domain by implying that the function's definition extends beyond the grid, a standard practice in truncation error analysis.\n\n2.  **Solve the problem.**\n    The solution process involves three main steps:\n    1.  Apply the restriction operator $\\mathcal{R}_{\\text{FW}}$ to the fine-grid representation of $u(x,y)$ to obtain the coarse-grid values $U_c$.\n    2.  Apply the prolongation operator $\\mathcal{P}_{\\text{bilinear}}$ to the coarse-grid values $U_c$ to obtain the interpolated fine-grid values $u_I$.\n    3.  Compute the error $E(x,y) = u_I(x,y) - u(x,y)$ and find its maximum magnitude over all fine-grid nodes.\n\n    **Step 1: Restriction**\n    Let $(x_0, y_0)$ be a coarse-grid node. The full-weighting restriction operator $\\mathcal{R}_{\\text{FW}}$ computes the coarse-grid value $U_c(x_0, y_0)$ as a weighted average of the nine fine-grid values centered at $(x_0, y_0)$. The fine-grid values are given by the continuous function $u(x,y) = x^2 + y^2$.\n    The operator is defined as:\n    $$\n    U_c(x_0, y_0) = \\frac{1}{16} \\sum_{i=-1}^{1} \\sum_{j=-1}^{1} w_{ij} u(x_0+ih, y_0+jh)\n    $$\n    where the weights are $w_{00}=4$, $w_{\\pm 1, 0}=w_{0, \\pm 1}=2$, and $w_{\\pm 1, \\pm 1}=1$.\n\n    We can analyze the action of this operator on $u(x,y)$ by expanding $u(x_0+ih, y_0+jh)$ in a Taylor series around $(x_0, y_0)$. Since $u(x,y)$ is a quadratic polynomial, the Taylor expansion is exact and finite:\n    $$\n    u(x_0+ih, y_0+jh) = u(x_0, y_0) + (ih) \\frac{\\partial u}{\\partial x} + (jh) \\frac{\\partial u}{\\partial y} + \\frac{1}{2} \\left( (ih)^2 \\frac{\\partial^2 u}{\\partial x^2} + (jh)^2 \\frac{\\partial^2 u}{\\partial y^2} + 2(ih)(jh) \\frac{\\partial^2 u}{\\partial x \\partial y} \\right)\n    $$\n    For $u(x,y) = x^2 + y^2$, the partial derivatives at $(x_0, y_0)$ are: $\\frac{\\partial u}{\\partial x} = 2x_0$, $\\frac{\\partial u}{\\partial y} = 2y_0$, $\\frac{\\partial^2 u}{\\partial x^2} = 2$, $\\frac{\\partial^2 u}{\\partial y^2} = 2$, and $\\frac{\\partial^2 u}{\\partial x \\partial y} = 0$.\n    Substituting these into the expansion gives:\n    $$\n    u(x_0+ih, y_0+jh) = (x_0^2+y_0^2) + 2x_0 i h + 2y_0 j h + i^2 h^2 + j^2 h^2\n    $$\n    Now, we compute the weighted sum:\n    $$\n    U_c(x_0, y_0) = \\frac{1}{16} \\sum_{i,j} w_{ij} \\left( u(x_0, y_0) + 2x_0 i h + 2y_0 j h + i^2 h^2 + j^2 h^2 \\right)\n    $$\n    By linearity of summation:\n    $$\n    U_c(x_0, y_0) = \\frac{1}{16} \\left( u(x_0, y_0)\\sum_{i,j} w_{ij} + 2x_0 h \\sum_{i,j} w_{ij}i + 2y_0 h \\sum_{i,j} w_{ij}j + h^2 \\sum_{i,j} w_{ij}i^2 + h^2 \\sum_{i,j} w_{ij}j^2 \\right)\n    $$\n    We evaluate the sums of weighted indices:\n    $\\sum_{i,j} w_{ij} = 1+2+1+2+4+2+1+2+1 = 16$.\n    Due to the symmetry of the weights ($w_{ij} = w_{-i,j}$ and $w_{ij}=w_{i,-j}$):\n    $\\sum_{i,j} w_{ij} i = 0$ and $\\sum_{i,j} w_{ij} j = 0$.\n    The sum for the $i^2$ term is:\n    $\\sum_{i,j} w_{ij} i^2 = \\sum_{j} (w_{-1,j}(-1)^2 + w_{0,j}(0)^2 + w_{1,j}(1)^2) = \\sum_{j} (w_{-1,j} + w_{1,j})$.\n    For $j \\in \\{-1, 1\\}$, $w_{-1,j}+w_{1,j} = 1+1=2$. For $j=0$, $w_{-1,0}+w_{1,0} = 2+2=4$.\n    So, $\\sum_{i,j} w_{ij} i^2 = 2 + 4 + 2 = 8$. By symmetry, $\\sum_{i,j} w_{ij} j^2 = 8$.\n\n    Substituting these sums back into the expression for $U_c$:\n    $$\n    U_c(x_0, y_0) = \\frac{1}{16} \\left( 16 u(x_0, y_0) + 0 + 0 + 8h^2 + 8h^2 \\right) = u(x_0, y_0) + \\frac{16h^2}{16} = u(x_0, y_0) + h^2\n    $$\n    So, the coarse-grid values are $U_c(x,y) = x^2+y^2+h^2$ at each coarse-grid node $(x,y)$.\n\n    **Step 2: Prolongation**\n    Next, we apply bilinear interpolation $\\mathcal{P}_{\\text{bilinear}}$ to the coarse-grid data $U_c$ to get values $u_I$ on the fine grid. The operator is linear, so we can write:\n    $$\n    u_I(x,y) = \\mathcal{P}_{\\text{bilinear}}[U_c](x,y) = \\mathcal{P}_{\\text{bilinear}}[u+h^2](x,y) = \\mathcal{P}_{\\text{bilinear}}[u](x,y) + \\mathcal{P}_{\\text{bilinear}}[h^2](x,y)\n    $$\n    Bilinear interpolation of a constant value ($h^2$) results in that same constant value everywhere. Thus, $\\mathcal{P}_{\\text{bilinear}}[h^2](x,y) = h^2$.\n    The equation simplifies to:\n    $$\n    u_I(x,y) = \\mathcal{P}_{\\text{bilinear}}[u](x,y) + h^2\n    $$\n\n    **Step 3: Error Calculation**\n    The error at a fine-grid point $(x,y)$ is:\n    $$\n    E(x,y) = u_I(x,y) - u(x,y) = \\left( \\mathcal{P}_{\\text{bilinear}}[u](x,y) - u(x,y) \\right) + h^2\n    $$\n    The term in the parenthesis is the standard error of bilinear interpolation for the function $u(x,y)=x^2+y^2$. Let's compute this error.\n    Consider a coarse cell with corners at $(X_0, Y_0), (X_0+2h, Y_0), (X_0, Y_0+2h), (X_0+2h, Y_0+2h)$. A point $(x,y)$ in this cell is parameterized by $x = X_0 + s(2h)$ and $y = Y_0 + t(2h)$ with $s,t \\in [0,1]$.\n    The bilinear interpolation operator is also linear with respect to the function being interpolated, so $\\mathcal{P}_{\\text{bilinear}}[x^2+y^2] = \\mathcal{P}_{\\text{bilinear}}[x^2] + \\mathcal{P}_{\\text{bilinear}}[y^2]$.\n    The interpolation error for $f(z)=z^2$ using 1D linear interpolation on an interval of length $L=2h$ is $L^2\\sigma(1-\\sigma) = 4h^2\\sigma(1-\\sigma)$ where $\\sigma$ is the local coordinate.\n    For bilinear interpolation of $u(x,y)=x^2+y^2$, the interpolation error is the sum of the 1D errors:\n    $$\n    \\mathcal{P}_{\\text{bilinear}}[u](x,y) - u(x,y) = 4h^2s(1-s) + 4h^2t(1-t)\n    $$\n    The total error is therefore:\n    $$\n    E(x,y) = \\left( 4h^2s(1-s) + 4h^2t(1-t) \\right) + h^2 = h^2(1 + 4s(1-s) + 4t(1-t))\n    $$\n\n    **Step 4: Maximization**\n    We need to find the maximum of $|E(x,y)|$ over all fine-grid nodes. Since $h>0$ and $s,t\\in[0,1]$, the terms $s(1-s)$ and $t(1-t)$ are non-negative, so $E(x,y)$ is always positive. Thus, $|E(x,y)|=E(x,y)$.\n    The fine-grid nodes are located at coordinates $(ih, jh)$ for $i,j \\in \\{0, 1, \\dots, 8\\}$. A fine node $(ih, jh)$ has local coordinates $(s,t)$ within a coarse cell given by $s = (i \\pmod 2)/2$ and $t = (j \\pmod 2)/2$.\n    The possible values for $s$ and $t$ at fine-grid nodes are $0$ and $1/2$.\n    We need to maximize $E(x,y)$ for $(s,t) \\in \\{0, 1/2\\} \\times \\{0, 1/2\\}$.\n    The function $f(\\sigma) = \\sigma(1-\\sigma)$ is $0$ for $\\sigma=0$ and $1/4$ for $\\sigma=1/2$.\n    The error function $E$ is maximized when $s(1-s)$ and $t(1-t)$ are maximized, which occurs at $s=1/2$ and $t=1/2$.\n    This corresponds to fine-grid nodes with odd indices $(i,j)$, which are the centers of the coarse grid cells.\n    The maximum error is:\n    $$\n    E_{\\max} = h^2\\left(1 + 4\\left(\\frac{1}{2}\\right)\\left(1-\\frac{1}{2}\\right) + 4\\left(\\frac{1}{2}\\right)\\left(1-\\frac{1}{2}\\right)\\right) = h^2\\left(1 + 4\\left(\\frac{1}{4}\\right) + 4\\left(\\frac{1}{4}\\right)\\right)\n    $$\n    $$\n    E_{\\max} = h^2(1 + 1 + 1) = 3h^2\n    $$\n    The problem provides $h = \\frac{1}{8}$. Substituting this value:\n    $$\n    E_{\\max} = 3 \\left(\\frac{1}{8}\\right)^2 = 3 \\left(\\frac{1}{64}\\right) = \\frac{3}{64}\n    $$",
            "answer": "$$\\boxed{\\frac{3}{64}}$$"
        },
        {
            "introduction": "Having practiced with grid-transfer operators, we now examine how the problem itself is defined on coarser grids. A powerful and robust approach is to use the Galerkin principle, which defines the coarse-grid operator $A_c$ algebraically from the fine-grid operator $A_f$ and the transfer operators $R$ and $P$ via the relation $A_c = R A_f P$. This exercise guides you through the derivation of the coarse-grid operator's stencil, revealing a crucial insight: the resulting operator is often fundamentally different from a simple rediscretization of the original PDE on the coarse grid, which is a key reason for the robustness of Galerkin-based multigrid methods .",
            "id": "3347238",
            "problem": "Consider the two-dimensional Poisson equation $-\\nabla^{2} u = f$ on an infinite, uniform Cartesian grid of spacing $h$ in both spatial directions. Let $A_{f}$ denote the standard five-point discrete Laplacian on the fine grid, defined by the stencil\n$$\n\\frac{1}{h^{2}}\n\\begin{pmatrix}\n0 & -1 & 0 \\\\\n-1 & 4 & -1 \\\\\n0 & -1 & 0\n\\end{pmatrix}.\n$$\nDefine the coarse grid by uniform coarsening with spacing $H = 2h$. Let the prolongation $P$ be bilinear interpolation from the coarse grid to the fine grid, and let the restriction $R$ be the full-weighting operator from the fine grid to the coarse grid. Explicitly, the bilinear interpolation $P$ maps a coarse-grid degree of freedom at $(I,J)$ into fine-grid values on the $3 \\times 3$ block centered at $(2I,2J)$ with weights\n$$\np_{0,0} = 1,\\quad p_{\\pm1,0} = p_{0,\\pm1} = \\frac{1}{2},\\quad p_{\\pm1,\\pm1} = \\frac{1}{4},\n$$\nand zero elsewhere; and full-weighting restriction $R$ maps a fine-grid field to the coarse-grid node at $(I,J)$ using\n$$\n\\frac{1}{16}\n\\begin{pmatrix}\n1 & 2 & 1 \\\\\n2 & 4 & 2 \\\\\n1 & 2 & 1\n\\end{pmatrix}\n$$\non the $3 \\times 3$ fine block centered at $(2I,2J)$. The Galerkin coarse-grid operator is $A_{c} = R\\,A_{f}\\,P$.\n\nStarting from these definitions alone, derive the effective coarse-grid $3 \\times 3$ footprint (stencil) of $A_{c}$ and express its nine weights in the order $\\{\\text{NW}, \\text{N}, \\text{NE}, \\text{W}, \\text{C}, \\text{E}, \\text{SW}, \\text{S}, \\text{SE}\\}$, simplified in terms of the coarse spacing $H$. Then, compare the resulting five-point subset (center and the four cardinal neighbors) to the weights of the rediscretized five-point Laplacian on the coarse grid, which has the stencil\n$$\n\\frac{1}{H^{2}}\n\\begin{pmatrix}\n0 & -1 & 0 \\\\\n-1 & 4 & -1 \\\\\n0 & -1 & 0\n\\end{pmatrix}.\n$$\nYour final answer must be the coarse-grid $3 \\times 3$ stencil weights as a single $1 \\times 9$ row matrix expression in terms of $H$. No numerical rounding is required.",
            "solution": "The user wants me to solve the problem.\nMy analysis of the problem is as follows:\n1.  **Extract Givens**:\n    *   Equation: Two-dimensional Poisson equation, $-\\nabla^{2} u = f$.\n    *   Grid: Infinite, uniform Cartesian grid.\n    *   Fine grid spacing: $h$.\n    *   Fine grid operator $A_f$: Standard five-point discrete Laplacian, stencil $\\frac{1}{h^{2}} \\begin{pmatrix} 0 & -1 & 0 \\\\ -1 & 4 & -1 \\\\ 0 & -1 & 0 \\end{pmatrix}$.\n    *   Coarse grid spacing: $H = 2h$.\n    *   Prolongation operator $P$: Bilinear interpolation, with weights $p_{0,0} = 1$, $p_{\\pm1,0} = p_{0,\\pm1} = \\frac{1}{2}$, $p_{\\pm1,\\pm1} = \\frac{1}{4}$ for a $3 \\times 3$ fine-grid block centered at $(2I, 2J)$ for a coarse-grid node at $(I,J)$.\n    *   Restriction operator $R$: Full-weighting, with stencil $\\frac{1}{16} \\begin{pmatrix} 1 & 2 & 1 \\\\ 2 & 4 & 2 \\\\ 1 & 2 & 1 \\end{pmatrix}$ on the $3 \\times 3$ fine-grid block centered at $(2I, 2J)$.\n    *   Coarse-grid operator: $A_c = R A_f P$.\n    *   Task 1: Derive the $3 \\times 3$ stencil for $A_c$ and express its nine weights in terms of $H$.\n    *   Task 2: Present the weights in the order $\\{\\text{NW}, \\text{N}, \\text{NE}, \\text{W}, \\text{C}, \\text{E}, \\text{SW}, \\text{S}, \\text{SE}\\}$.\n    *   Task 3: Compare the five-point subset of the $A_c$ stencil to the standard rediscretized Laplacian on the coarse grid, with stencil $\\frac{1}{H^{2}} \\begin{pmatrix} 0 & -1 & 0 \\\\ -1 & 4 & -1 \\\\ 0 & -1 & 0 \\end{pmatrix}$.\n\n2.  **Validate Using Extracted Givens**:\n    *   The problem is scientifically grounded, being a standard exercise in the theory of multigrid methods, a core topic in numerical analysis and computational fluid dynamics.\n    *   All operators ($A_f$, $P$, $R$) and the Galerkin coarsening procedure ($A_c = R A_f P$) are defined using their standard, textbook forms.\n    *   The problem is well-posed, objective, and self-contained. It provides all necessary information for a direct algebraic derivation of the coarse-grid operator stencil.\n    *   The problem does not violate any of the invalidity criteria.\n\n3.  **Verdict and Action**:\n    *   The problem is **valid**.\n    *   I will proceed with the derivation.\n\nThe coarse-grid operator is defined as the triple product $A_c = R A_f P$. To determine the stencil of $A_c$, we can compute its action on a coarse-grid delta function. Let $u_c$ be a coarse-grid function that is $1$ at a single coarse-grid node, which we can place at the origin $(I,J)=(0,0)$ without loss of generality, and $0$ at all other coarse-grid nodes. The stencil weights of $A_c$ are then the values of the resulting coarse-grid function, $(A_c u_c)(I', J')$, for $(I',J') \\in \\{(-1,-1), \\dots, (1,1)\\}$. The derivation proceeds in three steps.\n\nStep 1: Prolongation. We apply the prolongation operator $P$ to the coarse-grid delta function $u_c$. This maps the single non-zero value at the coarse node $(0,0)$ to a patch of values on the fine grid. Let this fine-grid function be $u_f = P u_c$. The values of $u_f(i,j)$ for $i,j \\in \\{-1, 0, 1\\}$ are given by the weights of $P$:\n$$\nu_f(i,j) = \n\\begin{pmatrix}\np_{-1,1} & p_{0,1} & p_{1,1} \\\\\np_{-1,0} & p_{0,0} & p_{1,0} \\\\\np_{-1,-1} & p_{0,-1} & p_{1,-1}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n1/4 & 1/2 & 1/4 \\\\\n1/2 & 1 & 1/2 \\\\\n1/4 & 1/2 & 1/4\n\\end{pmatrix}.\n$$\nFor all other fine-grid points $(i,j)$, $u_f(i,j) = 0$.\n\nStep 2: Application of the fine-grid operator. We now apply the fine-grid Laplacian $A_f$ to the fine-grid function $u_f$. Let the result be $v_f = A_f u_f$. The action of $A_f$ at a fine-grid node $(i,j)$ is given by its stencil:\n$$\nv_f(i,j) = \\frac{1}{h^2} \\left[ 4u_f(i,j) - u_f(i-1,j) - u_f(i+1,j) - u_f(i,j-1) - u_f(i,j+1) \\right].\n$$\nSince $u_f$ is non-zero on a $3 \\times 3$ patch, $v_f$ will be non-zero on a $5 \\times 5$ patch. We compute the values of $h^2 v_f(i,j)$ for key points, using symmetry:\nAt the center $(0,0)$:\n$h^2 v_f(0,0) = 4u_f(0,0) - 4u_f(1,0) = 4(1) - 4(1/2) = 2$.\nAt cardinal points, e.g., $(1,0)$:\n$h^2 v_f(1,0) = 4u_f(1,0) - u_f(0,0) - u_f(2,0) - u_f(1,-1) - u_f(1,1) = 4(1/2) - 1 - 0 - 1/4 - 1/4 = 2-1-1/2 = 1/2$.\nBy symmetry, $h^2 v_f(-1,0) = h^2 v_f(0,1) = h^2 v_f(0,-1) = 1/2$.\nAt diagonal points, e.g., $(1,1)$:\n$h^2 v_f(1,1) = 4u_f(1,1) - u_f(0,1) - u_f(2,1) - u_f(1,0) - u_f(1,2) = 4(1/4) - 1/2 - 0 - 1/2 - 0 = 1-1 = 0$.\nBy symmetry, $h^2 v_f(\\pm 1, \\pm 1) = 0$.\nAt outer cardinal points, e.g., $(2,0)$:\n$h^2 v_f(2,0) = 4u_f(2,0) - u_f(1,0) - u_f(3,0) - u_f(2,-1) - u_f(2,1) = 4(0) - 1/2 - 0 - 0 - 0 = -1/2$.\nBy symmetry, $h^2 v_f(-2,0) = h^2 v_f(0,2) = h^2 v_f(0,-2) = -1/2$.\nAt outer mixed points, e.g., $(2,1)$:\n$h^2 v_f(2,1) = 4u_f(2,1) - u_f(1,1) - u_f(3,1) - u_f(2,0) - u_f(2,2) = 4(0) - 1/4 - 0 - 0 - 0 = -1/4$.\nBy symmetry, $h^2 v_f(\\pm 2, \\pm 1) = h^2 v_f(\\pm 1, \\pm 2) = -1/4$.\nAll other values of $v_f$ are zero. The patch $h^2 v_f$ is:\n$$\nh^2 v_f(i,j) = \n\\begin{pmatrix}\n0 & -1/4 & -1/2 & -1/4 & 0 \\\\\n-1/4 & 0 & 1/2 & 0 & -1/4 \\\\\n-1/2 & 1/2 & 2 & 1/2 & -1/2 \\\\\n-1/4 & 0 & 1/2 & 0 & -1/4 \\\\\n0 & -1/4 & -1/2 & -1/4 & 0\n\\end{pmatrix}.\n$$\n\nStep 3: Restriction. We apply the restriction operator $R$ to $v_f$ to obtain the final coarse-grid function $v_c = R v_f$. The value of $v_c$ at a coarse-grid node $(I,J)$ is a weighted average of $v_f$ values in a $3 \\times 3$ fine-grid patch centered at $(2I, 2J)$. The weights are given by the full-weighting stencil $S_R = \\frac{1}{16} \\begin{pmatrix} 1 & 2 & 1 \\\\ 2 & 4 & 2 \\\\ 1 & 2 & 1 \\end{pmatrix}$.\nThe values $v_c(I,J)$ are the stencil weights of $A_c$.\nWeight for Center (C), $(I,J)=(0,0)$: The restriction stencil is centered at fine-grid point $(0,0)$.\n$v_c(0,0) = \\frac{1}{16} \\sum_{i,j=-1}^{1} w_R(i,j) v_f(i,j) = \\frac{1}{16h^2} \\left[ 4(2) + 2(1/2)\\times4 + 1(0)\\times4 \\right] = \\frac{1}{16h^2}[8+4] = \\frac{12}{16h^2} = \\frac{3}{4h^2}$.\nWeight for North (N), $(I,J)=(0,1)$: The restriction stencil is centered at fine-grid point $(0,2)$.\n$v_c(0,1) = \\frac{1}{16} \\sum_{i,j=-1}^{1} w_R(i,j) v_f(i, 2+j) = \\frac{1}{16h^2} \\left[ 1(0)+2(1/2)+1(0) + 2(-1/4)+4(-1/2)+2(-1/4) + 1(0)+2(-1/4)+1(0) \\right] = \\frac{1}{16h^2}[1 - 1/2 - 2 - 1/2 - 1/2] = \\frac{-2}{16h^2} = -\\frac{1}{8h^2}$.\nBy symmetry, the weights for South (S), East (E), and West (W) are also $-\\frac{1}{8h^2}$.\nWeight for North-West (NW), $(I,J)=(-1,1)$: The restriction stencil is centered at fine-grid point $(-2,2)$.\n$v_c(-1,1) = \\frac{1}{16} \\sum_{i,j=-1}^{1} w_R(i,j) v_f(-2+i, 2+j) = \\frac{1}{16h^2} \\left[ 2(-1/4) + 2(-1/4) \\right] = \\frac{1}{16h^2}[-1/2-1/2] = \\frac{-1}{16h^2}$.\nBy symmetry, the weights for North-East (NE), South-West (SW), and South-East (SE) are also $-\\frac{1}{16h^2}$.\n\nWe are given $H = 2h$, so $h^2 = H^2/4$. We substitute this into our derived weights to express them in terms of $H$:\nCenter (C): $\\frac{3}{4(H^2/4)} = \\frac{3}{H^2}$.\nCardinal (N,S,E,W): $-\\frac{1}{8(H^2/4)} = -\\frac{4}{8H^2} = -\\frac{1}{2H^2}$.\nDiagonal (NW,NE,SW,SE): $-\\frac{1}{16(H^2/4)} = -\\frac{4}{16H^2} = -\\frac{1}{4H^2}$.\n\nThe resulting $3 \\times 3$ stencil for $A_c$ is:\n$$\nS_{A_c} = \\frac{1}{H^2} \\begin{pmatrix} -1/4 & -1/2 & -1/4 \\\\ -1/2 & 3 & -1/2 \\\\ -1/4 & -1/2 & -1/4 \\end{pmatrix}.\n$$\nThe nine weights in the specified order $\\{\\text{NW}, \\text{N}, \\text{NE}, \\text{W}, \\text{C}, \\text{E}, \\text{SW}, \\text{S}, \\text{SE}\\}$ are:\n$$\n\\frac{1}{H^2} \\left\\{ -\\frac{1}{4}, -\\frac{1}{2}, -\\frac{1}{4}, -\\frac{1}{2}, 3, -\\frac{1}{2}, -\\frac{1}{4}, -\\frac{1}{2}, -\\frac{1}{4} \\right\\}.\n$$\nComparison with the rediscretized operator:\nThe standard five-point Laplacian on the coarse grid is $A_H \\sim \\frac{1}{H^2} \\begin{pmatrix} 0 & -1 & 0 \\\\ -1 & 4 & -1 \\\\ 0 & -1 & 0 \\end{pmatrix}$.\nThe five-point subset of our derived Galerkin operator $A_c$ is $\\frac{1}{H^2} \\begin{pmatrix} 0 & -1/2 & 0 \\\\ -1/2 & 3 & -1/2 \\\\ 0 & -1/2 & 0 \\end{pmatrix}$.\nComparing the two, we observe two main differences. First, the Galerkin operator $A_c$ is a nine-point stencil, not a five-point stencil. Second, for the five-point part, the weights of $A_c$ are different from $A_H$. The magnitude of the off-diagonal entries of $A_c$ is half that of $A_H$, and the diagonal entry is $3$ instead of $4$ (in units of $1/H^2$). The sum of all nine weights in the $A_c$ stencil is $\\frac{1}{H^2} (3 + 4(-1/2) + 4(-1/4)) = \\frac{1}{H^2}(3 - 2 - 1) = 0$, which is a necessary condition for consistency with the continuous operator.\n\nThe final answer is the row matrix of the nine weights.",
            "answer": "$$ \\boxed{\\frac{1}{H^2} \\begin{pmatrix} -\\frac{1}{4} & -\\frac{1}{2} & -\\frac{1}{4} & -\\frac{1}{2} & 3 & -\\frac{1}{2} & -\\frac{1}{4} & -\\frac{1}{2} & -\\frac{1}{4} \\end{pmatrix}} $$"
        },
        {
            "introduction": "We now move from the mechanics of multigrid components to the strategic choice of the cycle itself. While the V-cycle is computationally efficient, its performance can degrade for challenging problems where the smoother and coarse-grid correction are not perfectly complementary. This thought experiment presents a classic \"killer\" problem—anisotropic diffusion with a rotating principal axis—and asks you to analyze why the cheaper V-cycle may fail while the more expensive W-cycle succeeds. This practice sharpens your intuition about the crucial trade-off between computational cost and algorithmic robustness that is central to designing effective multigrid solvers .",
            "id": "2415597",
            "problem": "Consider the linear system $A \\mathbf{u} = \\mathbf{f}$ arising from a second-order accurate finite difference discretization on a uniform grid of the Partial Differential Equation (PDE) $-\\nabla \\cdot (K(x,y)\\nabla u) = f$ on the unit square $[0,1]\\times[0,1]$ with homogeneous Dirichlet boundary conditions. The diffusion tensor is\n$$\nK(x,y) = R(\\theta(y)) \n\\begin{pmatrix}\n\\epsilon & 0 \\\\\n0 & 1\n\\end{pmatrix}\nR(-\\theta(y)),\n$$\nwhere $R(\\theta)$ is the $2\\times 2$ rotation matrix, $\\theta(y) = \\frac{\\pi}{2} y$, and $0<\\epsilon \\ll 1$. Thus the strong diffusion direction rotates continuously from the $x$-axis at $y=0$ to the $y$-axis at $y=1$.\n\nYou apply a Geometric Multigrid (GMG) method with the following ingredients on a hierarchy of successively coarser uniform grids with mesh size $h,2h,4h,\\dots$: pointwise Gauss–Seidel relaxation ($\\nu_1$ pre-smoothing and $\\nu_2$ post-smoothing steps with fixed small integers $\\nu_1,\\nu_2 \\ge 1$), standard full-weighting restriction $R$, bilinear interpolation $P$, and the Galerkin coarse-grid operator $A_c = R A P$. Consider two multigrid cycling strategies: a V-cycle (one coarse-grid descent per level per cycle) and a W-cycle (two coarse-grid descents per level per cycle). Assume exact solves on the coarsest grid.\n\nWhich statement best predicts the asymptotic convergence behavior, and explains why, for this problem under the stated GMG choices?\n\nA. The V-cycle will stagnate or converge very slowly, while the W-cycle will converge significantly faster, because the rotating anisotropy makes the coarse-grid correction weak for the low-frequency error components relative to the fine grid, and the W-cycle applies coarse-grid correction multiple times per cycle, substantially enhancing reduction of those components.\n\nB. The V-cycle and W-cycle will converge at essentially the same rate, because only the smoother determines convergence and the recursion pattern does not affect the asymptotic factor.\n\nC. The V-cycle will converge faster than the W-cycle, because extra coarse-grid work in the W-cycle over-smooths high-frequency errors that are already eliminated by pointwise Gauss–Seidel relaxation.\n\nD. The W-cycle will diverge, because repeating the coarse-grid correction amplifies low-frequency errors when the anisotropy direction varies with $y$.",
            "solution": "The problem statement must first be validated for scientific and logical integrity.\n\n### Step 1: Extract Givens\n\n-   **Linear System**: $A \\mathbf{u} = \\mathbf{f}$.\n-   **Origin**: Second-order accurate finite difference discretization of a Partial Differential Equation (PDE).\n-   **PDE**: $-\\nabla \\cdot (K(x,y)\\nabla u) = f$.\n-   **Domain**: Unit square, $[0,1]\\times[0,1]$.\n-   **Boundary Conditions**: Homogeneous Dirichlet.\n-   **Diffusion Tensor**: $K(x,y) = R(\\theta(y)) \\begin{pmatrix} \\epsilon & 0 \\\\ 0 & 1 \\end{pmatrix} R(-\\theta(y))$.\n-   **Rotation Matrix**: $R(\\theta)$ is the $2\\times 2$ rotation matrix.\n-   **Rotation Angle**: $\\theta(y) = \\frac{\\pi}{2} y$.\n-   **Anisotropy Parameter**: $0 < \\epsilon \\ll 1$.\n-   **Problem Feature**: The strong diffusion direction rotates from the $x$-direction at $y=0$ to the $y$-direction at $y=1$.\n-   **Method**: Geometric Multigrid (GMG) on a hierarchy of uniform grids with mesh sizes $h, 2h, 4h, \\dots$.\n-   **GMG Components**:\n    -   **Smoother**: Pointwise Gauss-Seidel relaxation.\n    -   **Smoothing**: $\\nu_1$ pre-smoothing and $\\nu_2$ post-smoothing steps, with $\\nu_1, \\nu_2 \\ge 1$ being small integers.\n    -   **Restriction**: Standard full-weighting, $R$.\n    -   **Interpolation**: Bilinear interpolation, $P$.\n    -   **Coarse-Grid Operator**: Galerkin operator, $A_c = R A P$.\n-   **Cycling Strategies**: V-cycle and W-cycle.\n-   **Coarsest Grid**: Exact solution is assumed.\n-   **Question**: Predict the asymptotic convergence behavior of the V-cycle versus the W-cycle and provide the reasoning.\n\n### Step 2: Validate Using Extracted Givens\n\n1.  **Scientific Soundness**: The problem describes a canonical anisotropic diffusion equation. Such problems are standard benchmarks in the field of numerical analysis and computational engineering for testing the robustness of iterative solvers, particularly multigrid methods. All specified components—the PDE, boundary conditions, discretization, and GMG ingredients (pointwise Gauss-Seidel, standard inter-grid transfers, Galerkin coarsening)—are well-established and scientifically sound.\n2.  **Well-Posedness**: The problem is well-posed. It asks for a qualitative comparison of the convergence performance of two standard multigrid cycles for a specific, well-defined numerical problem. The setup provides sufficient information to apply established multigrid theory and analysis.\n3.  **Objectivity**: The problem statement is formulated with precise, objective, and technical language, free from any subjective G_x.\n4.  **Completeness**: The problem is self-contained. It defines the PDE, the domain, the boundary conditions, and all essential components of the numerical method.\n5.  **Realism**: The setup is a classic and realistic test case used to demonstrate the limitations of standard multigrid methods and the need for more robust components or cycles.\n6.  **Structure**: The question is direct and does not involve circular reasoning.\n\n### Step 3: Verdict and Action\n\nThe problem statement is valid. It is a standard, non-trivial problem in numerical analysis that requires an understanding of multigrid principles. A solution will be derived.\n\n### Derivation and Analysis\n\nThe core of this problem lies in the interaction between the chosen smoother and the nature of the anisotropy in the PDE operator.\n\n1.  **Analysis of the Smoother**: The specified smoother is a pointwise Gauss-Seidel method. Pointwise smoothers are effective at damping high-frequency error components. An error component is considered high-frequency if it is oscillatory with respect to the grid spacing. However, the efficiency of a smoother depends critically on the operator. For an elliptic operator with strong, direction-dependent anisotropy, such as the one given where $0 < \\epsilon \\ll 1$, the stencil coupling is much stronger in one direction (the direction of weak diffusion) than another. Pointwise smoothers are notoriously inefficient for such problems because they fail to damp certain error modes. These problematic modes are smooth (low-frequency) in the direction of strong coupling but oscillatory (high-frequency) in the direction of weak coupling. Such modes are often called \"semi-coarse\" or \"characteristic\" error modes. The pointwise smoother does not \"see\" these modes as highly oscillatory, as the error varies little between adjacent points in the strongly coupled direction, and thus fails to reduce them effectively.\n\n2.  **Impact of Rotating Anisotropy**: The problem is complicated further because the direction of anisotropy rotates with the vertical coordinate $y$.\n    -   Near $y=0$, $\\theta(0)=0$. The strong diffusion direction is along the $y$-axis, and weak diffusion ($\\epsilon$) is along the $x$-axis. The operator is locally approximated by $-\\epsilon u_{xx} - u_{yy} = f$. Pointwise Gauss-Seidel will fail to smooth errors that are oscillatory in the $y$-direction but smooth in the $x$-direction.\n    -   Near $y=1$, $\\theta(1)=\\pi/2$. The strong diffusion direction is along the $x$-axis, and weak diffusion is along the $y$-axis. The operator is locally approximated by $-u_{xx} - \\epsilon u_{yy} = f$. Pointwise Gauss-Seidel will fail to smooth errors that are oscillatory in the $x$-direction but smooth in the $y$-direction.\n    -   At intermediate $y$, the problematic modes are aligned with the rotated coordinate system.\n\n3.  **Analysis of the Coarse-Grid Correction (CGC)**: The purpose of the CGC is to eliminate the smooth error components that the smoother cannot handle. In standard multigrid theory, it is assumed that any error not damped by the smoother is smooth enough to be accurately represented and solved on a coarser grid. However, the semi-coarse modes described above are not smooth in all directions. When these modes are restricted to a coarser grid using standard operators like full-weighting, their high-frequency nature in one direction leads to aliasing. The standard coarse-grid operator, even with Galerkin construction ($A_c = R A P$), fails to accurately represent the behavior of these fine-grid semi-coarse modes. Consequently, the coarse-grid correction is very weak in reducing these specific modes. This leads to a two-grid convergence factor, $\\rho_{2g}$, that is close to $1$.\n\n4.  **Comparison of V-cycle and W-cycle**: The asymptotic convergence factor of a multigrid cycle depends on the two-grid factor $\\rho_{2g}$ and the type of cycle.\n    -   A **V-cycle** performs one coarse-grid correction step per level. Its convergence factor degrades as the number of levels increases if the CGC is not sufficiently effective (i.e., if $\\rho_{2g}$ is not small enough). For a problem like this, where $\\rho_{2g}$ is close to $1$, the V-cycle will exhibit very slow convergence or stagnation. The single application of the weak CGC at each level is insufficient to control the problematic semi-coarse error modes.\n    -   A **W-cycle** performs two coarse-grid correction steps per level. This repeated application of the CGC has a compounding effect. If the two-grid process is a contraction with factor $\\rho_{2g}$, applying it twice in a W-cycle roughly corresponds to a reduction factor of $\\rho_{2g}^2$. Since $\\rho_{2g} < 1$ (even if close to $1$), we have $\\rho_{2g}^2 < \\rho_{2g}$. Therefore, the W-cycle is more robust and achieves a significantly better convergence factor than the V-cycle precisely in cases where the CGC is weak. The extra work on the coarse grids is targeted at the slowly converging error components that the V-cycle fails to adequately reduce.\n\n### Option-by-Option Evaluation\n\n-   **A. The V-cycle will stagnate or converge very slowly, while the W-cycle will converge significantly faster, because the rotating anisotropy makes the coarse-grid correction weak for the low-frequency error components relative to the fine grid, and the W-cycle applies coarse-grid correction multiple times per cycle, substantially enhancing reduction of those components.**\n    -   This statement correctly identifies that the V-cycle will perform poorly due to a weak coarse-grid correction. It correctly identifies the reason for the weak correction as the anisotropy. It correctly asserts that the W-cycle will be significantly faster and provides the correct reason: the repeated application of the (weak) coarse-grid correction within each cycle leads to a more effective reduction of the problematic error modes. The term \"low-frequency error components\" is used in the context of multigrid to refer to components that should be handled on the coarse grid, which is appropriate for the semi-coarse modes at hand.\n    -   **Verdict: Correct.**\n\n-   **B. The V-cycle and W-cycle will converge at essentially the same rate, because only the smoother determines convergence and the recursion pattern does not affect the asymptotic factor.**\n    -   This statement is fundamentally flawed. Multigrid convergence is a a synthesis of smoothing and coarse-grid correction. The claim that \"only the smoother determines convergence\" is false. The recursion pattern (V-cycle, W-cycle, etc.) directly dictates how the CGC is applied and is a primary determinant of the overall asymptotic convergence factor, especially for difficult problems.\n    -   **Verdict: Incorrect.**\n\n-   **C. The V-cycle will converge faster than the W-cycle, because extra coarse-grid work in the W-cycle over-smooths high-frequency errors that are already eliminated by pointwise Gauss–Seidel relaxation.**\n    -   This statement misunderstands the function of the coarse-grid correction. The CGC is designed to address smooth (low-frequency) errors, not high-frequency errors. High-frequency errors are not even representable on coarse grids. The premise that extra coarse-grid work \"over-smooths high-frequency errors\" is nonsensical. The W-cycle's additional work is precisely for the errors the smoother *cannot* eliminate.\n    -   **Verdict: Incorrect.**\n\n-   **D. The W-cycle will diverge, because repeating the coarse-grid correction amplifies low-frequency errors when the anisotropy direction varies with $y$.**\n    -   Divergence would imply that the two-grid convergence factor is greater than or equal to $1$. While the method is inefficient, a properly implemented Galerkin-based multigrid method for this problem is typically convergent, albeit slowly (i.e., $\\rho_{2g} < 1$). Repeating a convergent process (the CGC) does not lead to amplification or divergence; it leads to a greater reduction of the error. The W-cycle should converge, and faster than the V-cycle.\n    -   **Verdict: Incorrect.**",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}