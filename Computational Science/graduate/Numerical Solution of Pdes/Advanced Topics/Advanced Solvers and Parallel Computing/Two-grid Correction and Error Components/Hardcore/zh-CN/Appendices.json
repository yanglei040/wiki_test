{
    "hands_on_practices": [
        {
            "introduction": "理论的美妙在于其能够通过具体计算来体现。在深入探讨双网格方法如何分解和处理不同频率的误差分量之前，首先通过一个具体的代数示例来掌握其核心机制是至关重要的。这项练习将引导您完成一个完整的粗网格校正步骤——从计算残差、将其限制到粗网格，到求解粗网格问题并最终将校正量插值回细网格。通过这个小规模的算例，您将对多重网格方法中信息在不同尺度网格间传递的方式建立起坚实的直观理解。",
            "id": "3458899",
            "problem": "考虑一个在一维均匀细网格上离散化的线性椭圆偏微分方程 (PDE) 的狄利克雷问题，该网格有 $n_h = 3$ 个内部点。令细网格刚度矩阵 $A_h \\in \\mathbb{R}^{3 \\times 3}$ 为标准三对角矩阵\n$$\nA_h \\;=\\; \\begin{pmatrix}\n2  -1  0 \\\\\n-1  2  -1 \\\\\n0  -1  2\n\\end{pmatrix}.\n$$\n给定当前的细网格迭代值\n$$\nu_h^{(k)} \\;=\\; \\begin{pmatrix} 1 \\\\ 0 \\\\ -1 \\end{pmatrix},\n$$\n以及细网格右端项\n$$\nf_h \\;=\\; \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}.\n$$\n使用双网格校正，其中包含一次精确粗网格求解，以及由下式定义的全加权限制算子 $R \\in \\mathbb{R}^{1 \\times 3}$\n$$\nR \\;=\\; \\begin{pmatrix} \\tfrac{1}{4}  \\tfrac{1}{2}  \\tfrac{1}{4} \\end{pmatrix},\n$$\n和由下式定义的线性插值延拓算子 $P \\in \\mathbb{R}^{3 \\times 1}$\n$$\nP \\;=\\; \\begin{pmatrix} \\tfrac{1}{2} \\\\ 1 \\\\ \\tfrac{1}{2} \\end{pmatrix}.\n$$\n通过伽辽金定义 $A_H \\;=\\; R\\,A_h\\,P \\in \\mathbb{R}^{1 \\times 1}$ 来构造粗网格算子。定义细网格残差 $r_h \\;=\\; f_h - A_h u_h^{(k)}$，将其限制到粗网格上得到 $r_H \\;=\\; R\\,r_h$，通过求解 $A_H e_H \\;=\\; r_H$ 计算精确粗网格误差 $e_H \\in \\mathbb{R}$，然后计算校正后的细网格迭代值 $u_h^{(k+1)} \\;=\\; u_h^{(k)} + P e_H$。\n\n仅根据这些定义，计算 $e_H$ 和 $u_h^{(k+1)}$ 的显式值。将最终答案表示为一个包含两个元素的单行矩阵，其中第一个元素是标量 $e_H$，第二个元素是 $3 \\times 1$ 的列向量 $u_h^{(k+1)}$。无需四舍五入，答案应为精确值。",
            "solution": "我们从双网格校正的基本定义出发进行计算。细网格残差定义如下：\n$$\nr_h \\;=\\; f_h \\;-\\; A_h\\,u_h^{(k)}.\n$$\n利用给定的 $A_h$ 和 $u_h^{(k)}$，我们首先计算 $A_h\\,u_h^{(k)}$。令\n$$\nA_h \\;=\\; \\begin{pmatrix}\n2  -1  0 \\\\\n-1  2  -1 \\\\\n0  -1  2\n\\end{pmatrix}, \n\\quad \nu_h^{(k)} \\;=\\; \\begin{pmatrix} 1 \\\\ 0 \\\\ -1 \\end{pmatrix}.\n$$\n则\n$$\nA_h\\,u_h^{(k)} \\;=\\; \n\\begin{pmatrix}\n2 \\cdot 1 + (-1) \\cdot 0 + 0 \\cdot (-1) \\\\\n(-1) \\cdot 1 + 2 \\cdot 0 + (-1) \\cdot (-1) \\\\\n0 \\cdot 1 + (-1) \\cdot 0 + 2 \\cdot (-1)\n\\end{pmatrix}\n\\;=\\;\n\\begin{pmatrix}\n2 \\\\\n-1 + 1 \\\\\n-2\n\\end{pmatrix}\n\\;=\\;\n\\begin{pmatrix}\n2 \\\\\n0 \\\\\n-2\n\\end{pmatrix}.\n$$\n因此残差为\n$$\nr_h \\;=\\; f_h - A_h\\,u_h^{(k)} \n\\;=\\; \n\\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix} \n- \n\\begin{pmatrix} 2 \\\\ 0 \\\\ -2 \\end{pmatrix}\n\\;=\\;\n\\begin{pmatrix} -2 \\\\ 1 \\\\ 2 \\end{pmatrix}.\n$$\n\n接下来，使用全加权限制算子 $R$ 将残差限制到粗网格上：\n$$\nR \\;=\\; \\begin{pmatrix} \\tfrac{1}{4}  \\tfrac{1}{2}  \\tfrac{1}{4} \\end{pmatrix},\n\\qquad\nr_H \\;=\\; R\\,r_h.\n$$\n可得\n$$\nr_H \\;=\\; \\begin{pmatrix} \\tfrac{1}{4}  \\tfrac{1}{2}  \\tfrac{1}{4} \\end{pmatrix}\n\\begin{pmatrix} -2 \\\\ 1 \\\\ 2 \\end{pmatrix}\n\\;=\\; \\tfrac{1}{4} \\cdot (-2) \\;+\\; \\tfrac{1}{2} \\cdot 1 \\;+\\; \\tfrac{1}{4} \\cdot 2\n\\;=\\; -\\tfrac{1}{2} \\;+\\; \\tfrac{1}{2} \\;+\\; \\tfrac{1}{2}\n\\;=\\; \\tfrac{1}{2}.\n$$\n\n通过伽辽金定义 $A_H \\;=\\; R\\,A_h\\,P$ 构造粗网格算子 $A_H$。其中\n$$\nP \\;=\\; \\begin{pmatrix} \\tfrac{1}{2} \\\\ 1 \\\\ \\tfrac{1}{2} \\end{pmatrix},\n$$\n我们首先计算 $A_h\\,P$：\n$$\nA_h\\,P \\;=\\; \n\\begin{pmatrix}\n2  -1  0 \\\\\n-1  2  -1 \\\\\n0  -1  2\n\\end{pmatrix}\n\\begin{pmatrix} \\tfrac{1}{2} \\\\ 1 \\\\ \\tfrac{1}{2} \\end{pmatrix}\n\\;=\\;\n\\begin{pmatrix}\n2 \\cdot \\tfrac{1}{2} + (-1) \\cdot 1 + 0 \\cdot \\tfrac{1}{2} \\\\\n(-1) \\cdot \\tfrac{1}{2} + 2 \\cdot 1 + (-1) \\cdot \\tfrac{1}{2} \\\\\n0 \\cdot \\tfrac{1}{2} + (-1) \\cdot 1 + 2 \\cdot \\tfrac{1}{2}\n\\end{pmatrix}\n\\;=\\;\n\\begin{pmatrix}\n1 - 1 \\\\\n- \\tfrac{1}{2} + 2 - \\tfrac{1}{2} \\\\\n-1 + 1\n\\end{pmatrix}\n\\;=\\;\n\\begin{pmatrix}\n0 \\\\ 1 \\\\ 0\n\\end{pmatrix}.\n$$\n因此，\n$$\nA_H \\;=\\; R\\,(A_h\\,P) \\;=\\; \\begin{pmatrix} \\tfrac{1}{4}  \\tfrac{1}{2}  \\tfrac{1}{4} \\end{pmatrix}\n\\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}\n\\;=\\; \\tfrac{1}{2}.\n$$\n\n精确求解粗网格问题 $A_H e_H \\;=\\; r_H$：\n$$\n\\tfrac{1}{2}\\, e_H \\;=\\; \\tfrac{1}{2}\n\\;\\;\\Longrightarrow\\;\\;\ne_H \\;=\\; 1.\n$$\n\n将粗网格误差延拓到细网格上，并校正细网格迭代值：\n$$\nP\\,e_H \\;=\\; \\begin{pmatrix} \\tfrac{1}{2} \\\\ 1 \\\\ \\tfrac{1}{2} \\end{pmatrix} \\cdot 1\n\\;=\\; \\begin{pmatrix} \\tfrac{1}{2} \\\\ 1 \\\\ \\tfrac{1}{2} \\end{pmatrix},\n\\qquad\nu_h^{(k+1)} \\;=\\; u_h^{(k)} + P\\,e_H \n\\;=\\; \n\\begin{pmatrix} 1 \\\\ 0 \\\\ -1 \\end{pmatrix}\n+\n\\begin{pmatrix} \\tfrac{1}{2} \\\\ 1 \\\\ \\tfrac{1}{2} \\end{pmatrix}\n\\;=\\;\n\\begin{pmatrix} \\tfrac{3}{2} \\\\ 1 \\\\ -\\tfrac{1}{2} \\end{pmatrix}.\n$$\n\n因此，计算得到的粗网格误差为 $e_H \\;=\\; 1$，校正后的细网格迭代值为 $u_h^{(k+1)} \\;=\\; \\begin{pmatrix} \\tfrac{3}{2} \\\\ 1 \\\\ -\\tfrac{1}{2} \\end{pmatrix}$，符合题目要求。",
            "answer": "$$\\boxed{\\begin{pmatrix} 1  \\begin{pmatrix} \\tfrac{3}{2} \\\\ 1 \\\\ -\\tfrac{1}{2} \\end{pmatrix} \\end{pmatrix}}$$"
        },
        {
            "introduction": "我们知道，双网格方法的效率依赖于两个关键过程的互补作用：光滑和粗网格校正。光滑器的任务是有效地衰减那些无法在粗网格上表示的高频误差分量。但是，我们如何量化一个光滑器的“有效性”并对其进行优化呢？这项练习引入了局部傅里叶分析（Local Fourier Analysis, LFA）这一强大工具，通过推导加权雅可比迭代的光滑因子，来确定最优的松弛参数 $\\omega$。这不仅是一个计算练习，更是理解如何通过理论分析来设计和优化多重网格算法组件的第一步。",
            "id": "3458866",
            "problem": "考虑偏微分方程 (PDE) 的边值问题 $-u''(x)=f(x)$，定义在区间 $(0,1)$ 上，并带有齐次狄利克雷边界条件 $u(0)=u(1)=0$。在网格尺寸为 $h=\\frac{1}{n+1}$ 的均匀网格 $x_j=jh$, $j=1,\\dots,n$ 上，使用标准的二阶中心有限差分格式对该算子进行离散化，得到线性系统 $A_h u_h = f_h$，其中 $A_h$ 是一个三对角矩阵，其差分模板为 $\\frac{1}{h^2}[-1,2,-1]$。考虑加权雅可比松弛迭代 $u_h^{(k+1)} = u_h^{(k)} + \\omega D_h^{-1}(f_h - A_h u_h^{(k)})$，其中 $D_h$ 是 $A_h$ 的对角部分，$\\omega0$ 是松弛参数。\n\n在粗网格间距为 $2h$ 的双网格方法中，光滑子的作用是衰减那些在粗网格上无法表示的高频误差分量。使用局部傅里叶分析（LFA），该分析假设网格是无限且均匀的，并逐个模式地分析误差演化。将光滑因子 $\\mu_{\\text{smooth}}(\\omega)$ 定义为误差传播算子的傅里叶符号在粗网格空间补集的高频集上的模的上确界。取高频集为 $\\{\\theta\\in[\\pi/2,\\pi]\\}$（角度以弧度为单位），这对应于在间距为 $2h$ 的粗网格上不可表示的模式。\n\n从第一性原理（离散算子模板、加权雅可比迭代的定义以及平移不变算子的傅里叶表示）出发，推导 $\\mu_{\\text{smooth}}(\\omega)$ 的解析表达式，并确定在 $\\omega0$ 上使其最小化的值 $\\omega^{\\star}$。然后，计算得到的最小光滑因子 $\\mu_{\\text{smooth}}(\\omega^{\\star})$。\n\n将你的最终答案以单行矩阵 $\\begin{pmatrix}\\omega^{\\star}  \\mu_{\\text{smooth}}(\\omega^{\\star})\\end{pmatrix}$ 的形式给出。不需要进行数值舍入。",
            "solution": "用户希望找到应用于一维泊松方程的加权雅可比光滑子的最优松弛参数 $\\omega^{\\star}$ 和相应的最小光滑因子 $\\mu_{\\text{smooth}}(\\omega^{\\star})$。我们将按要求使用局部傅里叶分析 (LFA)。\n\n首先，我们确定加权雅可比迭代的误差传播算子。迭代公式如下：\n$$ u_h^{(k+1)} = u_h^{(k)} + \\omega D_h^{-1}(f_h - A_h u_h^{(k)}) $$\n设 $u_h$ 是离散系统 $A_h u_h = f_h$ 的精确解。第 $k$ 次迭代的误差为 $e_h^{(k)} = u_h - u_h^{(k)}$。将 $u_h^{(k)} = u_h - e_h^{(k)}$ 和 $f_h = A_h u_h$ 代入迭代公式，我们得到：\n$$ u_h - e_h^{(k+1)} = (u_h - e_h^{(k)}) + \\omega D_h^{-1}(A_h u_h - A_h (u_h - e_h^{(k)})) $$\n$$ u_h - e_h^{(k+1)} = u_h - e_h^{(k)} + \\omega D_h^{-1}(A_h e_h^{(k)}) $$\n$$ -e_h^{(k+1)} = -e_h^{(k)} + \\omega D_h^{-1} A_h e_h^{(k)} $$\n$$ e_h^{(k+1)} = (I - \\omega D_h^{-1} A_h) e_h^{(k)} $$\n误差传播算子，即光滑子，为 $S_h(\\omega) = I - \\omega D_h^{-1} A_h$。\n\n接下来，我们应用局部傅里叶分析 (LFA)。LFA 分析离散算子对形如 $v_\\theta(x_j) = \\exp(i \\theta j)$ 的傅里叶模式的作用，其中 $x_j=jh$ 是网格点，$\\theta \\in [-\\pi, \\pi]$ 是缩放频率。一个线性、平移不变的算子作用于这样一个模式，其效果是将其乘以一个标量，该标量被称为傅里叶符号或放大因子。\n$L_h v_\\theta(x_j) = \\widehat{L_h}(\\theta) v_\\theta(x_j)$。\n\n我们需要找到算子 $S_h(\\omega)$ 的符号。这需要 $A_h$ 和 $D_h$ 的符号。\n算子 $A_h$ 由模板 $\\frac{1}{h^2}[-1, 2, -1]$ 给出。将其应用于 $v_\\theta(x_j)$：\n$$ (A_h v_\\theta)_j = \\frac{1}{h^2} [-v_\\theta(x_{j-1}) + 2v_\\theta(x_j) - v_\\theta(x_{j+1})] $$\n$$ = \\frac{1}{h^2} [-\\exp(i\\theta(j-1)) + 2\\exp(i\\theta j) - \\exp(i\\theta(j+1))] $$\n$$ = \\frac{\\exp(i\\theta j)}{h^2} [-\\exp(-i\\theta) + 2 - \\exp(i\\theta)] $$\n$$ = \\frac{\\exp(i\\theta j)}{h^2} [2 - 2\\cos(\\theta)] $$\n使用半角恒等式 $1 - \\cos(\\theta) = 2\\sin^2(\\theta/2)$，我们得到：\n$$ = \\frac{\\exp(i\\theta j)}{h^2} [4\\sin^2(\\theta/2)] $$\n因此，$A_h$ 的符号是 $\\widehat{A_h}(\\theta) = \\frac{4}{h^2}\\sin^2(\\theta/2)$。\n\n算子 $D_h$ 是 $A_h$ 的对角部分。从模板可知，对角线元素是 $\\frac{2}{h^2}$。所以，$D_h = \\frac{2}{h^2}I$。$D_h$ 的符号是一个常数：$\\widehat{D_h}(\\theta) = \\frac{2}{h^2}$。因此，其逆的符号是 $\\widehat{D_h^{-1}}(\\theta) = \\frac{h^2}{2}$。\n\n现在我们可以找到光滑子 $S_h(\\omega)$ 的符号：\n$$ \\widehat{S_h}(\\omega, \\theta) = \\widehat{I}(\\theta) - \\omega \\widehat{D_h^{-1}}(\\theta) \\widehat{A_h}(\\theta) $$\n$$ \\widehat{S_h}(\\omega, \\theta) = 1 - \\omega \\left(\\frac{h^2}{2}\\right) \\left(\\frac{4}{h^2}\\sin^2(\\theta/2)\\right) $$\n$$ \\widehat{S_h}(\\omega, \\theta) = 1 - 2\\omega \\sin^2(\\theta/2) $$\n这个表达式是频率为 $\\theta$ 的误差模式的放大因子。\n\n光滑因子 $\\mu_{\\text{smooth}}(\\omega)$ 定义为放大因子的模在高频集上的上确界。题目指定该集合为 $\\theta \\in [\\pi/2, \\pi]$。\n$$ \\mu_{\\text{smooth}}(\\omega) = \\sup_{\\theta \\in [\\pi/2, \\pi]} |1 - 2\\omega \\sin^2(\\theta/2)| $$\n为了计算这个上确界，我们来分析当 $\\theta \\in [\\pi/2, \\pi]$ 时，$z = \\sin^2(\\theta/2)$ 这一项的取值范围。函数 $\\sin(\\phi)$ 在 $\\phi \\in [0, \\pi/2]$ 上是增函数。当 $\\theta$ 的范围从 $\\pi/2$ 到 $\\pi$ 时，其参数 $\\theta/2$ 的范围从 $\\pi/4$ 到 $\\pi/2$。\n当 $\\theta = \\pi/2$ 时，$z = \\sin^2(\\pi/4) = \\left(\\frac{\\sqrt{2}}{2}\\right)^2 = \\frac{1}{2}$。\n当 $\\theta = \\pi$ 时，$z = \\sin^2(\\pi/2) = 1^2 = 1$。\n由于 $\\sin^2(\\theta/2)$ 在此区间上是单调递增函数，所以 $z$ 的取值范围是 $[1/2, 1]$。\n\n问题现在简化为求解：\n$$ \\mu_{\\text{smooth}}(\\omega) = \\sup_{z \\in [1/2, 1]} |1 - 2\\omega z| $$\n函数 $g(z) = 1 - 2\\omega z$ 是关于 $z$ 的线性函数。其绝对值在闭区间 $[1/2, 1]$ 上的上确界必然在区间的某个端点处取得。\n当 $z = 1/2$ 时：$|g(1/2)| = |1 - 2\\omega(1/2)| = |1 - \\omega|$。\n当 $z = 1$ 时：$|g(1)| = |1 - 2\\omega(1)| = |1 - 2\\omega|$。\n因此，光滑因子是这两个值的最大值：\n$$ \\mu_{\\text{smooth}}(\\omega) = \\max(|1 - \\omega|, |1 - 2\\omega|) $$\n\n我们最后的任务是找到使 $\\mu_{\\text{smooth}}(\\omega)$ 最小化的值 $\\omega^{\\star}$。两个函数的最大值的最小值通常在两个函数相等时出现。我们令它们的模相等：\n$$ |1 - \\omega| = |1 - 2\\omega| $$\n该等式成立的条件是 $1 - \\omega = 1 - 2\\omega$ 或者 $1 - \\omega = -(1 - 2\\omega)$。\n情况1：$1 - \\omega = 1 - 2\\omega \\implies \\omega = 0$。这不是一个有意义的松弛参数，并且被题目条件 $\\omega0$ 所排除。\n情况2：$1 - \\omega = -(1 - 2\\omega) \\implies 1 - \\omega = -1 + 2\\omega \\implies 2 = 3\\omega \\implies \\omega = \\frac{2}{3}$。\n\n这个值 $\\omega = 2/3$ 是最优参数 $\\omega^{\\star}$ 的候选值。为了确认它是一个最小值，我们可以观察 $\\mu_{\\text{smooth}}(\\omega) = \\max(|1 - \\omega|, |2\\omega - 1|)$ 的行为。对于 $\\omega  2/3$，$1-\\omega > 2\\omega-1$，所以 $\\mu_{\\text{smooth}}(\\omega) = 1-\\omega$，这是一个减函数。对于 $\\omega > 2/3$，$2\\omega-1 > 1-\\omega$，所以 $\\mu_{\\text{smooth}}(\\omega) = 2\\omega-1$，这是一个增函数。因此，该函数在 $\\omega = 2/3$ 处达到其最小值。\n所以，最优松弛参数是 $\\omega^{\\star} = \\frac{2}{3}$。\n\n最小光滑因子是在 $\\omega^{\\star}$ 处的 $\\mu_{\\text{smooth}}(\\omega)$ 的值：\n$$ \\mu_{\\text{smooth}}(\\omega^{\\star}) = \\mu_{\\text{smooth}}(2/3) = \\max\\left(\\left|1 - \\frac{2}{3}\\right|, \\left|1 - 2\\left(\\frac{2}{3}\\right)\\right|\\right) $$\n$$ = \\max\\left(\\left|\\frac{1}{3}\\right|, \\left|1 - \\frac{4}{3}\\right|\\right) = \\max\\left(\\frac{1}{3}, \\left|-\\frac{1}{3}\\right|\\right) = \\max\\left(\\frac{1}{3}, \\frac{1}{3}\\right) = \\frac{1}{3} $$\n最小光滑因子是 $\\mu_{\\text{smooth}}(\\omega^{\\star}) = \\frac{1}{3}$。\n\n最终答案是数对 $(\\omega^{\\star}, \\mu_{\\text{smooth}}(\\omega^{\\star}))$。",
            "answer": "$$ \\boxed{\\begin{pmatrix} \\frac{2}{3}  \\frac{1}{3} \\end{pmatrix}} $$"
        },
        {
            "introduction": "在分别理解了粗网格校正的代数机制和光滑器对高频误差的作用之后，现在是时候将所有部分整合起来，从整体上分析双网格方法的性能了。这项综合性练习将运用局部傅里叶分析来推导整个双网格迭代算子的符号，并计算其谱半径，即理论收敛因子。通过这个分析，您将亲眼见证光滑过程与粗网格校正过程如何协同工作，使得低频和高频误差分量都在一个迭代周期内被有效衰减，从而揭示多重网格方法实现快速收敛的深刻原因。",
            "id": "3458872",
            "problem": "考虑定义在周期性域上的一维泊松方程，其细网格间距为 $h$，通过标准二阶中心有限差分算子 $A_h$（模板为 $\\frac{1}{h^2}[-1, 2, -1]$）进行离散化。应用一个双网格方法，该方法使用一步加权雅可比松弛作为前平滑，一步作为后平滑，从细网格到粗网格采用全加权限制，以及从粗网格返回细网格采用线性插值。粗网格算子通过伽辽金选择定义为 $A_{2h} = R A_h P$，其中 $R$ 是限制算子，$P$ 是延拓算子。\n\n使用局部傅里叶分析（LFA），将细网格上的双网格误差传播算子表示为其符号 $\\widehat{E}(\\theta)$，该符号作用于由谐波对 $\\{\\exp(\\mathrm{i} j \\theta), \\exp(\\mathrm{i} j (\\theta+\\pi))\\}$ 张成的空间上，其中 $\\theta \\in (-\\pi,\\pi]$（单位为弧度）。选择加权雅可比参数 $\\omega$，使其在适用于双网格分析的高频范围内最小化最大平滑因子，从而达到最优。\n\n仅从细网格上离散算子符号、加权雅可比平滑符号、全加权限制符号和线性插值符号的定义出发，推导双网格误差符号 $\\widehat{E}(\\theta)$ 并确定 LFA 双网格收敛因子，即谱半径\n$$\n\\rho_{\\text{LFA}} \\;=\\; \\sup_{\\theta \\in (-\\pi,\\pi]} \\rho\\big(\\widehat{E}(\\theta)\\big).\n$$\n将您的最终答案以一个精确数字的形式给出。然后，将此 LFA 预测与在所述组件下，大型周期性网格上预期的经验收敛行为进行简要比较。",
            "solution": "该问题要求使用局部傅里叶分析（LFA）推导一维泊松方程的双网格收敛因子。分析是针对一个循环进行的，该循环包含一步使用加权雅可比的前平滑和一步后平滑、全加权限制和线性延拓。\n\n首先，我们验证问题陈述。\n**步骤 1：提取已知条件**\n- 方程：一维泊松方程, $-u''(x) = f(x)$。\n- 区域：周期性。\n- 细网格算子 ($A_h$): 标准二阶中心有限差分离散化，模板为 $\\frac{1}{h^2}[-1, 2, -1]$。问题隐含算子被 $1/h^2$ 缩放，即 $A_h u_j = \\frac{1}{h^2}(-u_{j-1} + 2u_j - u_{j+1})$。\n- 双网格方法：\n  - 平滑子：带参数 $\\omega$ 的加权雅可比方法。一步前平滑（$\\nu_1=1$）和一步后平滑（$\\nu_2=1$）。\n  - 限制算子 ($R$): 全加权算子。\n  - 延拓算子 ($P$): 线性插值算子。\n  - 粗网格算子 ($A_{2h}$): 伽辽金算子, $A_{2h} = R A_h P$。\n- 任務：\n  - 找到最优的平滑参数 $\\omega$。\n  - 推导双网格误差算子符号 $\\widehat{E}(\\theta)$。\n  - 计算 LFA 收敛因子 $\\rho_{\\text{LFA}} = \\sup_{\\theta} \\rho(\\widehat{E}(\\theta))$。\n  - 以精确数字给出最终答案，并与经验结果进行比较。\n\n**步骤 2：使用提取的已知条件进行验证**\n- 该问题是**有科学依据**且**客观的**。它是偏微分方程数值分析领域，特别是多重网格方法中的一个标准、成熟的问题。\n- 问题设定是**完整且一致的**。双网格方法的所有组件都已指定，任务是执行标准的 LFA 计算。\n- 该问题是**适定的**，存在唯一的可推导解。没有矛盾、歧义或不切实际的条件。\n\n**步骤 3：结论与行动**\n问题有效。我们继续进行求解。\n\nLFA 的核心是分析网格算子对傅里葉模式 $\\phi_j(\\theta) = \\exp(\\mathrm{i} j \\theta)$ 的作用，其中 $\\theta = k h$ 是波数 $k$ 和网格间距 $h$ 对应的无量纲频率。对于粗化因子为 $2$ 的双网格方法，一个低频模式 $\\exp(\\mathrm{i} j \\theta)$（其中 $\\theta \\in [-\\pi/2, \\pi/2]$）与其高频混淆模式 $\\exp(\\mathrm{i} j (\\theta-\\pi))$ 耦合。LFA 将算子表示为作用于这两个耦合模式振幅向量上的 $2 \\times 2$ 矩阵（符号）。\n\n**1. 算子符号**\n\n令 $s = \\sin(\\theta/2)$ 及 $c = \\cos(\\theta/2)$。\n\n- **细网格算子 ($A_h$)**: 模板 $\\frac{1}{h^2}[-1, 2, -1]$ 作用于 $\\exp(\\mathrm{i} j \\theta)$ 产生的符号为 $\\frac{2}{h^2}(1-\\cos\\theta) = \\frac{4}{h^2}\\sin^2(\\theta/2) = \\frac{4s^2}{h^2}$。完整的算子 $A_h$ 的符号是一个对角 $2 \\times 2$ 矩阵：\n$$\n\\widehat{A}_h(\\theta) = \\frac{4}{h^2} \\begin{pmatrix} \\sin^2(\\theta/2)  0 \\\\ 0  \\sin^2((\\theta-\\pi)/2) \\end{pmatrix} = \\frac{4}{h^2} \\begin{pmatrix} s^2  0 \\\\ 0  c^2 \\end{pmatrix}.\n$$\n\n- **加权雅可比平滑子 ($S_h$)**: 平滑子由 $S_h = I_h - \\omega D_h^{-1} A_h$ 给出，其中 $D_h$ 是 $A_h$ 的对角部分，即 $2/h^2$。因此，$S_h = I_h - \\frac{\\omega h^2}{2} A_h$。其符号为：\n$$\n\\widehat{S}_h(\\theta) = \\mathbf{I} - \\frac{\\omega h^2}{2} \\widehat{A}_h(\\theta) = \\mathbf{I} - 2\\omega \\begin{pmatrix} s^2  0 \\\\ 0  c^2 \\end{pmatrix} = \\begin{pmatrix} 1 - 2\\omega s^2  0 \\\\ 0  1 - 2\\omega c^2 \\end{pmatrix}.\n$$\n\n**2. 最优平滑参数 $\\omega$**\n\n平滑子的作用是衰减高频误差分量，在双网格分析中对应于 $\\theta \\in [-\\pi, -\\pi/2] \\cup [\\pi/2, \\pi]$。平滑因子为 $\\mu(\\theta) = \\rho(\\widehat{S}_h(\\theta))$。由于对称性，我们考虑 $\\theta \\in [\\pi/2, \\pi]$。在此范围内，$\\widehat{S}_h(\\theta)$ 的特征值为 $1-2\\omega\\sin^2(\\theta/2)$ 和 $1-2\\omega\\cos^2(\\theta/2)$。平滑因子是它们在高频范围内的模的最大值。目标是选择 $\\omega$ 来解决以下极小化极大问题：\n$$\n\\min_{\\omega} \\left( \\sup_{\\theta \\in [\\pi/2, \\pi]} \\rho\\left(\\widehat{S}_h(\\theta)\\right) \\right) = \\min_{\\omega} \\left( \\sup_{\\theta \\in [\\pi/2, \\pi]} \\max\\left(|1-2\\omega s^2|, |1-2\\omega c^2|\\right) \\right).\n$$\n对于 $\\theta \\in [\\pi/2, \\pi]$，我们有 $\\theta/2 \\in [\\pi/4, \\pi/2]$，所以 $s^2 \\in [1/2, 1]$ 且 $c^2 \\in [0, 1/2]$。函数 $|1-2\\omega x|$ 在区间 $[0, 1/2]$ 和 $[1/2, 1]$ 的并集，即 $[0, 1]$ 上进行求值。最优选择使得平滑子在被衰减的频谱边界上同样有效。对于 $\\theta = \\pi/2$，$s^2=c^2=1/2$，特征值均为 $1-\\omega$。对于 $\\theta=\\pi$，$s^2=1, c^2=0$，特征值为 $1-2\\omega$ 和 $1$。高频模式对应 $s^2 \\in [1/2, 1]$。标准分析要求 $|1-2\\omega(1/2)| = - (1-2\\omega(1))$，这得到 $1-\\omega = -(1-2\\omega) = 2\\omega-1$。由此得出 $3\\omega=2$，所以 $\\omega=2/3$。当 $\\omega=2/3$ 时，对于高频 $\\theta \\in [\\pi/2, \\pi]$，平滑因子为 $\\sup_{x \\in [1/2, 1]}|1 - 4x/3| = |1 - 4/6| = 1/3$。因此，最优参数为 $\\omega=2/3$。\n\n**3. 网格间传递和粗网格算子符号**\n\n- **限制算子 ($R$)**: 全加权使用模板 $[1/4, 2/4, 1/4]_h$。其 LFA 符号是一个 $1 \\times 2$ 的行向量：\n$$\n\\widehat{R}(\\theta) = [\\cos^2(\\theta/2), \\sin^2(\\theta/2)] = [c^2, s^2].\n$$\n- **延拓算子 ($P$)**: 线性插值的 LFA 符号是一个 $2 \\times 1$ 的列向量：\n$$\n\\widehat{P}(\\theta) = \\begin{pmatrix} \\cos^2(\\theta/2) \\\\ \\sin^2(\\theta/2) \\end{pmatrix} = \\begin{pmatrix} c^2 \\\\ s^2 \\end{pmatrix}.\n$$\n- **粗网格算子 ($A_{2h}$)**: 使用伽辽金选择 $A_{2h} = R A_h P$，其符号为 $\\widehat{A}_{2h}(2\\theta) = \\widehat{R}(\\theta) \\widehat{A}_h(\\theta) \\widehat{P}(\\theta)$：\n$$\n\\widehat{A}_{2h}(2\\theta) = [c^2, s^2] \\frac{4}{h^2} \\begin{pmatrix} s^2  0 \\\\ 0  c^2 \\end{pmatrix} \\begin{pmatrix} c^2 \\\\ s^2 \\end{pmatrix} = \\frac{4}{h^2} [s^2 c^2, s^2 c^2] \\begin{pmatrix} c^2 \\\\ s^2 \\end{pmatrix} = \\frac{4}{h^2} (s^2 c^4 + s^4 c^2)\n$$\n$$\n\\widehat{A}_{2h}(2\\theta) = \\frac{4}{h^2} s^2 c^2 (c^2 + s^2) = \\frac{4}{h^2} s^2 c^2 = \\frac{1}{h^2} (2sc)^2 = \\frac{1}{h^2} \\sin^2(\\theta).\n$$\n这恰好是粗网格上间距为 $2h$ 的标准离散化的符号。\n\n**4. 双网格误差传播符号 $\\widehat{E}(\\theta)$**\n\n对于包含 $\\nu_1=1$ 次前平滑和 $\\nu_2=1$ 次后平滑的循环，双网格误差传播算子为 $E_h^{2h} = S_h (I_h - P A_{2h}^{-1} R A_h) S_h$。其符号为：\n$$\n\\widehat{E}(\\theta) = \\widehat{S}_h(\\theta) (\\mathbf{I} - \\widehat{P}(\\theta) \\widehat{A}_{2h}^{-1}(2\\theta) \\widehat{R}(\\theta) \\widehat{A}_h(\\theta)) \\widehat{S}_h(\\theta).\n$$\n我们来计算粗网格修正部分，$C(\\theta) = \\widehat{P}(\\theta) \\widehat{A}_{2h}^{-1}(2\\theta) \\widehat{R}(\\theta) \\widehat{A}_h(\\theta)$：\n$$\nC(\\theta) = \\begin{pmatrix} c^2 \\\\ s^2 \\end{pmatrix} \\frac{h^2}{\\sin^2(\\theta)} [c^2, s^2] \\frac{4}{h^2} \\begin{pmatrix} s^2  0 \\\\ 0  c^2 \\end{pmatrix} = \\frac{4}{4s^2c^2} \\begin{pmatrix} c^2 \\\\ s^2 \\end{pmatrix} [s^2c^2, s^2c^2] = \\begin{pmatrix} c^2 \\\\ s^2 \\end{pmatrix} [1, 1] = \\begin{pmatrix} c^2  c^2 \\\\ s^2  s^2 \\end{pmatrix}.\n$$\n粗网格修正算子符号为 $\\mathbf{I} - C(\\theta) = \\begin{pmatrix} 1-c^2  -c^2 \\\\ -s^2  1-s^2 \\end{pmatrix} = \\begin{pmatrix} s^2  -c^2 \\\\ -s^2  c^2 \\end{pmatrix}$。\n现在我们用 $\\omega=2/3$ 来组装 $\\widehat{E}(\\theta)$：\n$$\n\\widehat{S}_h(\\theta) = \\begin{pmatrix} 1 - \\frac{4}{3} s^2  0 \\\\ 0  1 - \\frac{4}{3} c^2 \\end{pmatrix}.\n$$\n令 $S_{lo} = 1 - \\frac{4}{3} s^2$ 及 $S_{hi} = 1 - \\frac{4}{3} c^2$。\n$$\n\\widehat{E}(\\theta) = \\begin{pmatrix} S_{lo}  0 \\\\ 0  S_{hi} \\end{pmatrix} \\begin{pmatrix} s^2  -c^2 \\\\ -s^2  c^2 \\end{pmatrix} \\begin{pmatrix} S_{lo}  0 \\\\ 0  S_{hi} \\end{pmatrix} = \\begin{pmatrix} S_{lo}^2 s^2  -S_{lo}S_{hi}c^2 \\\\ -S_{lo}S_{hi}s^2  S_{hi}^2 c^2 \\end{pmatrix}.\n$$\n\n**5. LFA 收敛因子 $\\rho_{\\text{LFA}}$**\n\n收敛因子是 $\\widehat{E}(\\theta)$ 在 $\\theta \\in [-\\pi/2, \\pi/2]$ 上的谱半径的上确界。我们求 $\\widehat{E}(\\theta)$ 的特征值。特征方程为 $\\lambda^2 - \\text{Tr}(\\widehat{E}) \\lambda + \\det(\\widehat{E}) = 0$。\n行列式为：\n$$\n\\det(\\widehat{E}(\\theta)) = (S_{lo}^2 s^2)(S_{hi}^2 c^2) - (-S_{lo}S_{hi}c^2)(-S_{lo}S_{hi}s^2) = (S_{lo}S_{hi})^2 s^2 c^2 - (S_{lo}S_{hi})^2 s^2 c^2 = 0.\n$$\n由于行列式为零，一个特征值为 $\\lambda_1 = 0$。另一个特征值是矩阵的迹，$\\lambda_2 = \\text{Tr}(\\widehat{E}(\\theta)) = S_{lo}^2 s^2 + S_{hi}^2 c^2$。\n谱半径为 $\\rho(\\widehat{E}(\\theta)) = |\\text{Tr}(\\widehat{E}(\\theta))|$。\n我们代入 $S_{lo}$ 和 $S_{hi}$ 的表达式：\n$$\n\\rho(\\widehat{E}(\\theta)) = \\left| \\left(1-\\frac{4}{3}s^2\\right)^2 s^2 + \\left(1-\\frac{4}{3}c^2\\right)^2 c^2 \\right|.\n$$\n令 $x = s^2 = \\sin^2(\\theta/2)$。则 $c^2=1-x$。表达式变为 $x$ 的函数：\n$$\n\\lambda(x) = \\left(1-\\frac{4}{3}x\\right)^2 x + \\left(1-\\frac{4}{3}(1-x)\\right)^2 (1-x) = \\left(\\frac{3-4x}{3}\\right)^2 x + \\left(\\frac{4x-1}{3}\\right)^2 (1-x).\n$$\n$$\n9\\lambda(x) = (9-24x+16x^2)x + (16x^2-8x+1)(1-x)\n$$\n$$\n9\\lambda(x) = (9x-24x^2+16x^3) + (16x^2-8x+1 - 16x^3+8x^2-x)\n$$\n$$\n9\\lambda(x) = (16-16)x^3 + (-24+16+8)x^2 + (9-8-1)x + 1 = 1.\n$$\n因此，$\\lambda(x)=1/9$。谱半径对于所有 $\\theta$ 都是常数。\n$$\n\\rho(\\widehat{E}(\\theta)) = \\frac{1}{9}.\n$$\nLFA 双网格收敛因子是所有频率上的上确界，即 $1/9$。\n$$\n\\rho_{\\text{LFA}} = \\sup_{\\theta} \\rho(\\widehat{E}(\\theta)) = \\frac{1}{9}.\n$$\n\n**与经验行为的比较**\n\n局部傅里葉分析假设网格是无限、均匀的（或在拓扑上等效的周期性域）。因此，LFA 收敛因子 $1/9$ 代表了在非常大的周期性网格上可以观察到的渐近收敛率，此时边界效应可以忽略不计。对于在一维泊松问题上使用周期性边界条件进行的数值实验，随着网格点数的增加，经验上测量的收敛因子（例如，连续残差范数的比率）预计将非常接近这个理论值 $1/9$。这种特殊的多重网格组件组合（最优加权雅可比、全加权、线性插值、伽辽金粗网格算子）已知是高效的，并且 LFA 在这种理想设置下的预测异常准确。",
            "answer": "$$\\boxed{\\frac{1}{9}}$$"
        }
    ]
}