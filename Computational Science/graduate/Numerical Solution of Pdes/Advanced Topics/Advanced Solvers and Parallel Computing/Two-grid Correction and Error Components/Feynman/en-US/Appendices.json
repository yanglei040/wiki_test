{
    "hands_on_practices": [
        {
            "introduction": "To build a robust understanding of two-grid methods, we first focus on the core mechanism: the coarse-grid correction. This initial exercise  strips the process down to its essential algebraic steps, omitting the smoothing component for clarity. By working through a small-scale matrix problem, you will gain a concrete, step-by-step familiarity with how a fine-grid residual is transferred to a coarse grid, solved, and then used to update the fine-grid solution.",
            "id": "3458899",
            "problem": "Consider the one-dimensional Dirichlet problem for a linear elliptic partial differential equation (PDE) discretized on a uniform fine grid with $n_h = 3$ interior points. Let the fine-grid stiffness matrix $A_h \\in \\mathbb{R}^{3 \\times 3}$ be the standard tridiagonal matrix\n$$\nA_h \\;=\\; \\begin{pmatrix}\n2 & -1 & 0 \\\\\n-1 & 2 & -1 \\\\\n0 & -1 & 2\n\\end{pmatrix}.\n$$\nYou are given the current fine-grid iterate\n$$\nu_h^{(k)} \\;=\\; \\begin{pmatrix} 1 \\\\ 0 \\\\ -1 \\end{pmatrix},\n$$\nand the fine-grid right-hand side\n$$\nf_h \\;=\\; \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}.\n$$\nUse a two-grid correction with an exact coarse-grid solve, the full-weighting restriction operator $R \\in \\mathbb{R}^{1 \\times 3}$ defined by\n$$\nR \\;=\\; \\begin{pmatrix} \\tfrac{1}{4} & \\tfrac{1}{2} & \\tfrac{1}{4} \\end{pmatrix},\n$$\nand the linear interpolation prolongation operator $P \\in \\mathbb{R}^{3 \\times 1}$ defined by\n$$\nP \\;=\\; \\begin{pmatrix} \\tfrac{1}{2} \\\\ 1 \\\\ \\tfrac{1}{2} \\end{pmatrix}.\n$$\nForm the coarse-grid operator by the Galerkin definition $A_H = R A_h P \\in \\mathbb{R}^{1 \\times 1}$. Define the fine-grid residual $r_h = f_h - A_h u_h^{(k)}$, restrict it to the coarse grid $r_H = R r_h$, compute the exact coarse-grid error $e_H \\in \\mathbb{R}$ by solving $A_H e_H = r_H$, and then compute the corrected fine-grid iterate $u_h^{(k+1)} = u_h^{(k)} + P e_H$.\n\nStarting from these definitions only, compute the explicit values of $e_H$ and $u_h^{(k+1)}$. Express your final answer as a single row matrix with two entries, where the first entry is the scalar $e_H$ and the second entry is the $3 \\times 1$ column vector $u_h^{(k+1)}$. No rounding is required, and your answer should be exact.",
            "solution": "We proceed from the fundamental definitions of the two-grid correction. The fine-grid residual is defined by\n$$\nr_h \\;=\\; f_h \\;-\\; A_h\\,u_h^{(k)}.\n$$\nWith the given $A_h$ and $u_h^{(k)}$, we first compute $A_h\\,u_h^{(k)}$. Let\n$$\nA_h \\;=\\; \\begin{pmatrix}\n2 & -1 & 0 \\\\\n-1 & 2 & -1 \\\\\n0 & -1 & 2\n\\end{pmatrix}, \n\\quad \nu_h^{(k)} \\;=\\; \\begin{pmatrix} 1 \\\\ 0 \\\\ -1 \\end{pmatrix}.\n$$\nThen\n$$\nA_h\\,u_h^{(k)} \\;=\\; \n\\begin{pmatrix}\n2 \\cdot 1 + (-1) \\cdot 0 + 0 \\cdot (-1) \\\\\n(-1) \\cdot 1 + 2 \\cdot 0 + (-1) \\cdot (-1) \\\\\n0 \\cdot 1 + (-1) \\cdot 0 + 2 \\cdot (-1)\n\\end{pmatrix}\n\\;=\\;\n\\begin{pmatrix}\n2 \\\\\n-1 + 1 \\\\\n-2\n\\end{pmatrix}\n\\;=\\;\n\\begin{pmatrix}\n2 \\\\\n0 \\\\\n-2\n\\end{pmatrix}.\n$$\nHence the residual is\n$$\nr_h \\;=\\; f_h - A_h\\,u_h^{(k)} \n\\;=\\; \n\\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix} \n- \n\\begin{pmatrix} 2 \\\\ 0 \\\\ -2 \\end{pmatrix}\n\\;=\\;\n\\begin{pmatrix} -2 \\\\ 1 \\\\ 2 \\end{pmatrix}.\n$$\n\nNext, restrict the residual to the coarse grid using the full-weighting restriction $R$:\n$$\nR \\;=\\; \\begin{pmatrix} \\tfrac{1}{4} & \\tfrac{1}{2} & \\tfrac{1}{4} \\end{pmatrix},\n\\qquad\nr_H \\;=\\; R\\,r_h.\n$$\nThus\n$$\nr_H \\;=\\; \\begin{pmatrix} \\tfrac{1}{4} & \\tfrac{1}{2} & \\tfrac{1}{4} \\end{pmatrix}\n\\begin{pmatrix} -2 \\\\ 1 \\\\ 2 \\end{pmatrix}\n\\;=\\; \\tfrac{1}{4} \\cdot (-2) \\;+\\; \\tfrac{1}{2} \\cdot 1 \\;+\\; \\tfrac{1}{4} \\cdot 2\n\\;=\\; -\\tfrac{1}{2} \\;+\\; \\tfrac{1}{2} \\;+\\; \\tfrac{1}{2}\n\\;=\\; \\tfrac{1}{2}.\n$$\n\nForm the coarse-grid operator $A_H$ by the Galerkin definition $A_H \\;=\\; R\\,A_h\\,P$. With\n$$\nP \\;=\\; \\begin{pmatrix} \\tfrac{1}{2} \\\\ 1 \\\\ \\tfrac{1}{2} \\end{pmatrix},\n$$\nwe first compute $A_h\\,P$:\n$$\nA_h\\,P \\;=\\; \n\\begin{pmatrix}\n2 & -1 & 0 \\\\\n-1 & 2 & -1 \\\\\n0 & -1 & 2\n\\end{pmatrix}\n\\begin{pmatrix} \\tfrac{1}{2} \\\\ 1 \\\\ \\tfrac{1}{2} \\end{pmatrix}\n\\;=\\;\n\\begin{pmatrix}\n2 \\cdot \\tfrac{1}{2} + (-1) \\cdot 1 + 0 \\cdot \\tfrac{1}{2} \\\\\n(-1) \\cdot \\tfrac{1}{2} + 2 \\cdot 1 + (-1) \\cdot \\tfrac{1}{2} \\\\\n0 \\cdot \\tfrac{1}{2} + (-1) \\cdot 1 + 2 \\cdot \\tfrac{1}{2}\n\\end{pmatrix}\n\\;=\\;\n\\begin{pmatrix}\n1 - 1 \\\\\n- \\tfrac{1}{2} + 2 - \\tfrac{1}{2} \\\\\n-1 + 1\n\\end{pmatrix}\n\\;=\\;\n\\begin{pmatrix}\n0 \\\\ 1 \\\\ 0\n\\end{pmatrix}.\n$$\nTherefore,\n$$\nA_H \\;=\\; R\\,(A_h\\,P) \\;=\\; \\begin{pmatrix} \\tfrac{1}{4} & \\tfrac{1}{2} & \\tfrac{1}{4} \\end{pmatrix}\n\\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}\n\\;=\\; \\tfrac{1}{2}.\n$$\n\nSolve the coarse problem $A_H e_H \\;=\\; r_H$ exactly:\n$$\n\\tfrac{1}{2}\\, e_H \\;=\\; \\tfrac{1}{2}\n\\;\\;\\Longrightarrow\\;\\;\ne_H \\;=\\; 1.\n$$\n\nProlong the coarse-grid error to the fine grid and correct the fine-grid iterate:\n$$\nP\\,e_H \\;=\\; \\begin{pmatrix} \\tfrac{1}{2} \\\\ 1 \\\\ \\tfrac{1}{2} \\end{pmatrix} \\cdot 1\n\\;=\\; \\begin{pmatrix} \\tfrac{1}{2} \\\\ 1 \\\\ \\tfrac{1}{2} \\end{pmatrix},\n\\qquad\nu_h^{(k+1)} \\;=\\; u_h^{(k)} + P\\,e_H \n\\;=\\; \n\\begin{pmatrix} 1 \\\\ 0 \\\\ -1 \\end{pmatrix}\n+\n\\begin{pmatrix} \\tfrac{1}{2} \\\\ 1 \\\\ \\tfrac{1}{2} \\end{pmatrix}\n\\;=\\;\n\\begin{pmatrix} \\tfrac{3}{2} \\\\ 1 \\\\ -\\tfrac{1}{2} \\end{pmatrix}.\n$$\n\nThus the computed coarse-grid error is $e_H \\;=\\; 1$, and the corrected fine-grid iterate is $u_h^{(k+1)} \\;=\\; \\begin{pmatrix} \\tfrac{3}{2} \\\\ 1 \\\\ -\\tfrac{1}{2} \\end{pmatrix}$, as required.",
            "answer": "$$\\boxed{\\begin{pmatrix} 1 & \\begin{pmatrix} \\tfrac{3}{2} \\\\ 1 \\\\ -\\tfrac{1}{2} \\end{pmatrix} \\end{pmatrix}}$$"
        },
        {
            "introduction": "While coarse-grid correction effectively handles smooth, low-frequency errors, it is inefficient for highly oscillatory, high-frequency errors. This is where smoothing comes in. This practice  delves into the design of an optimal smoother, using Local Fourier Analysis to determine the weighted Jacobi parameter that most effectively damps these problematic high-frequency components, making the error more amenable to coarse-grid correction.",
            "id": "3458866",
            "problem": "Consider the boundary value problem for a partial differential equation (PDE), $-u''(x)=f(x)$ on $(0,1)$ with homogeneous Dirichlet boundary conditions $u(0)=u(1)=0$. Discretize the operator by the standard second-order centered finite difference scheme on a uniform grid with mesh size $h=1/(n+1)$, $x_j=jh$, for $j=1,\\dots,n$, leading to the linear system $A_h u_h = f_h$ where $A_h$ is the tridiagonal matrix with stencil $\\frac{1}{h^2}[-1,2,-1]$. Consider the weighted Jacobi relaxation $u_h^{(k+1)} = u_h^{(k)} + \\omega D_h^{-1}(f_h - A_h u_h^{(k)})$, where $D_h$ is the diagonal of $A_h$ and $\\omega > 0$ is the relaxation parameter.\n\nIn a two-grid method with coarse grid spacing $2h$, the purpose of the smoother is to damp the high-frequency error components that are not representable on the coarse grid. Using Local Fourier Analysis (LFA), which assumes an infinite uniform grid and analyzes the error evolution mode-by-mode, define the smoothing factor $\\mu_{\\text{smooth}}(\\omega)$ as the supremum of the magnitude of the Fourier symbol of the error-propagation operator over the high-frequency set complementary to the coarse-grid space. Take the high-frequency set to be $\\{\\theta \\in [\\pi/2, \\pi]\\}$ (angles measured in radians), corresponding to modes not representable on the coarse grid of spacing $2h$.\n\nStarting from first principles (the discrete operator stencil, the definition of the weighted Jacobi iteration, and the Fourier representation of translation-invariant operators), derive an analytic expression for $\\mu_{\\text{smooth}}(\\omega)$ and determine the value $\\omega^{\\star}$ that minimizes it over $\\omega > 0$. Then compute the resulting minimal smoothing factor $\\mu_{\\text{smooth}}(\\omega^{\\star})$.\n\nProvide your final answer as a single row matrix $\\begin{pmatrix}\\omega^{\\star} & \\mu_{\\text{smooth}}(\\omega^{\\star})\\end{pmatrix}$. No numerical rounding is required.",
            "solution": "The user wants to find the optimal relaxation parameter $\\omega^{\\star}$ and the corresponding minimal smoothing factor $\\mu_{\\text{smooth}}(\\omega^{\\star})$ for a weighted Jacobi smoother applied to the 1D Poisson equation. We will use Local Fourier Analysis (LFA) as specified.\n\nFirst, we determine the error-propagation operator for the weighted Jacobi iteration. The iteration is given by:\n$$ u_h^{(k+1)} = u_h^{(k)} + \\omega D_h^{-1}(f_h - A_h u_h^{(k)}) $$\nLet $u_h$ be the exact solution to the discrete system $A_h u_h = f_h$. The error at iteration $k$ is $e_h^{(k)} = u_h - u_h^{(k)}$. Substituting $u_h^{(k)} = u_h - e_h^{(k)}$ and $f_h = A_h u_h$ into the iteration formula, we get:\n$$ u_h - e_h^{(k+1)} = (u_h - e_h^{(k)}) + \\omega D_h^{-1}(A_h u_h - A_h (u_h - e_h^{(k)})) $$\n$$ u_h - e_h^{(k+1)} = u_h - e_h^{(k)} + \\omega D_h^{-1}(A_h e_h^{(k)}) $$\n$$ -e_h^{(k+1)} = -e_h^{(k)} + \\omega D_h^{-1} A_h e_h^{(k)} $$\n$$ e_h^{(k+1)} = (I - \\omega D_h^{-1} A_h) e_h^{(k)} $$\nThe error-propagation operator, or smoother, is $S_h(\\omega) = I - \\omega D_h^{-1} A_h$.\n\nNext, we apply Local Fourier Analysis (LFA). LFA analyzes the action of a discrete operator on Fourier modes of the form $v_\\theta(x_j) = \\exp(i \\theta j)$, where $x_j=jh$ is the grid point and $\\theta \\in [-\\pi, \\pi]$ is the scaled frequency. The action of a linear, translation-invariant operator on such a mode is to multiply it by a scalar, called the Fourier symbol or amplification factor.\n$L_h v_\\theta(x_j) = \\widehat{L_h}(\\theta) v_\\theta(x_j)$.\n\nWe need to find the symbol of the operator $S_h(\\omega)$. This requires the symbols of $A_h$ and $D_h$.\nThe operator $A_h$ is given by the stencil $\\frac{1}{h^2}[-1, 2, -1]$. Applying it to $v_\\theta(x_j)$:\n$$ (A_h v_\\theta)_j = \\frac{1}{h^2} [-v_\\theta(x_{j-1}) + 2v_\\theta(x_j) - v_\\theta(x_{j+1})] $$\n$$ = \\frac{1}{h^2} [-\\exp(i\\theta(j-1)) + 2\\exp(i\\theta j) - \\exp(i\\theta(j+1))] $$\n$$ = \\frac{\\exp(i\\theta j)}{h^2} [-\\exp(-i\\theta) + 2 - \\exp(i\\theta)] $$\n$$ = \\frac{\\exp(i\\theta j)}{h^2} [2 - 2\\cos(\\theta)] $$\nUsing the half-angle identity $1 - \\cos(\\theta) = 2\\sin^2(\\theta/2)$, we get:\n$$ = \\frac{\\exp(i\\theta j)}{h^2} [4\\sin^2(\\theta/2)] $$\nThus, the symbol of $A_h$ is $\\widehat{A_h}(\\theta) = \\frac{4}{h^2}\\sin^2(\\theta/2)$.\n\nThe operator $D_h$ is the diagonal of $A_h$. From the stencil, the diagonal entry is $\\frac{2}{h^2}$. So, $D_h = \\frac{2}{h^2}I$. The symbol of $D_h$ is a constant: $\\widehat{D_h}(\\theta) = \\frac{2}{h^2}$. Consequently, the symbol of its inverse is $\\widehat{D_h^{-1}}(\\theta) = \\frac{h^2}{2}$.\n\nNow we can find the symbol of the smoother $S_h(\\omega)$:\n$$ \\widehat{S_h}(\\omega, \\theta) = \\widehat{I}(\\theta) - \\omega \\widehat{D_h^{-1}}(\\theta) \\widehat{A_h}(\\theta) $$\n$$ \\widehat{S_h}(\\omega, \\theta) = 1 - \\omega \\left(\\frac{h^2}{2}\\right) \\left(\\frac{4}{h^2}\\sin^2(\\theta/2)\\right) $$\n$$ \\widehat{S_h}(\\omega, \\theta) = 1 - 2\\omega \\sin^2(\\theta/2) $$\nThis expression is the amplification factor for an error mode with frequency $\\theta$.\n\nThe smoothing factor, $\\mu_{\\text{smooth}}(\\omega)$, is defined as the supremum of the magnitude of the amplification factor over the set of high frequencies. The problem specifies this set as $\\theta \\in [\\pi/2, \\pi]$.\n$$ \\mu_{\\text{smooth}}(\\omega) = \\sup_{\\theta \\in [\\pi/2, \\pi]} |1 - 2\\omega \\sin^2(\\theta/2)| $$\nTo evaluate this supremum, let's analyze the range of the term $z = \\sin^2(\\theta/2)$ for $\\theta \\in [\\pi/2, \\pi]$. The function $\\sin(\\phi)$ is increasing for $\\phi \\in [0, \\pi/2]$. As $\\theta$ ranges from $\\pi/2$ to $\\pi$, the argument $\\theta/2$ ranges from $\\pi/4$ to $\\pi/2$.\nAt $\\theta = \\pi/2$, $z = \\sin^2(\\pi/4) = \\left(\\frac{\\sqrt{2}}{2}\\right)^2 = \\frac{1}{2}$.\nAt $\\theta = \\pi$, $z = \\sin^2(\\pi/2) = 1^2 = 1$.\nSince $\\sin^2(\\theta/2)$ is a monotonically increasing function on this interval, the range of $z$ is $[1/2, 1]$.\n\nThe problem now reduces to finding:\n$$ \\mu_{\\text{smooth}}(\\omega) = \\sup_{z \\in [1/2, 1]} |1 - 2\\omega z| $$\nThe function $g(z) = 1 - 2\\omega z$ is linear in $z$. The supremum of its absolute value over the closed interval $[1/2, 1]$ must be attained at one of the endpoints.\nAt $z = 1/2$: $|g(1/2)| = |1 - 2\\omega(1/2)| = |1 - \\omega|$.\nAt $z = 1$: $|g(1)| = |1 - 2\\omega(1)| = |1 - 2\\omega|$.\nTherefore, the smoothing factor is the maximum of these two values:\n$$ \\mu_{\\text{smooth}}(\\omega) = \\max(|1 - \\omega|, |1 - 2\\omega|) $$\n\nOur final task is to find the value $\\omega^{\\star}$ that minimizes $\\mu_{\\text{smooth}}(\\omega)$. The minimum of the maximum of two functions often occurs when the two functions are equal. We set the magnitudes equal:\n$$ |1 - \\omega| = |1 - 2\\omega| $$\nThis equality holds if either $1 - \\omega = 1 - 2\\omega$ or $1 - \\omega = -(1 - 2\\omega)$.\nCase 1: $1 - \\omega = 1 - 2\\omega \\implies \\omega = 0$. This is not a meaningful relaxation parameter and is excluded by the problem statement $\\omega>0$.\nCase 2: $1 - \\omega = -(1 - 2\\omega) \\implies 1 - \\omega = -1 + 2\\omega \\implies 2 = 3\\omega \\implies \\omega = \\frac{2}{3}$.\n\nThis value $\\omega = 2/3$ is the candidate for the optimal parameter $\\omega^{\\star}$. To confirm it is a minimum, we can observe the behavior of $\\mu_{\\text{smooth}}(\\omega) = \\max(|1 - \\omega|, |2\\omega - 1|)$. For $\\omega < 2/3$, $1-\\omega > 2\\omega-1$, so $\\mu_{\\text{smooth}}(\\omega) = 1-\\omega$, which is a decreasing function. For $\\omega > 2/3$, $2\\omega-1 > 1-\\omega$, so $\\mu_{\\text{smooth}}(\\omega) = 2\\omega-1$, which is an increasing function. The function thus attains its minimum at $\\omega = 2/3$.\nSo, the optimal relaxation parameter is $\\omega^{\\star} = \\frac{2}{3}$.\n\nThe minimal smoothing factor is the value of $\\mu_{\\text{smooth}}(\\omega)$ at $\\omega^{\\star}$:\n$$ \\mu_{\\text{smooth}}(\\omega^{\\star}) = \\mu_{\\text{smooth}}(2/3) = \\max\\left(\\left|1 - \\frac{2}{3}\\right|, \\left|1 - 2\\left(\\frac{2}{3}\\right)\\right|\\right) $$\n$$ = \\max\\left(\\left|\\frac{1}{3}\\right|, \\left|1 - \\frac{4}{3}\\right|\\right) = \\max\\left(\\frac{1}{3}, \\left|-\\frac{1}{3}\\right|\\right) = \\max\\left(\\frac{1}{3}, \\frac{1}{3}\\right) = \\frac{1}{3} $$\nThe minimal smoothing factor is $\\mu_{\\text{smooth}}(\\omega^{\\star}) = \\frac{1}{3}$.\n\nThe final answer is the pair $(\\omega^{\\star}, \\mu_{\\text{smooth}}(\\omega^{\\star}))$.",
            "answer": "$$ \\boxed{\\begin{pmatrix} \\frac{2}{3} & \\frac{1}{3} \\end{pmatrix}} $$"
        },
        {
            "introduction": "With a grasp of both coarse-grid correction mechanics and smoother design, we can now analyze a complete two-grid cycle. This exercise  synthesizes these concepts by tracking an error composed of distinct low- and high-frequency modes through each stage of the method. You will quantitatively observe how pre-smoothing attenuates the oscillatory error, the coarse-grid correction resolves the smooth error, and post-smoothing cleans up any remaining high-frequency components, revealing the symbiotic relationship that underpins multigrid efficiency.",
            "id": "3458890",
            "problem": "Consider the model problem of the one-dimensional Poisson equation with periodic boundary conditions discretized on a uniform fine grid of $n=8$ points with spacing $h = 1/8$. The fine-grid discrete operator $A$ is the standard second-difference (discrete Laplacian) acting on grid functions $\\{u_j\\}_{j=0}^{7}$ by\n$$\n(Au)_{j} = \\frac{1}{h^{2}}\\big(2u_{j} - u_{j-1} - u_{j+1}\\big),\n$$\nwith periodic indexing. Let the two-grid cycle use one pre-smoothing step and one post-smoothing step, both given by weighted Jacobi with weight $\\omega = 2/3$, i.e., the error-propagation smoothing operator is\n$$\nS = I - \\omega D^{-1}A,\n$$\nwhere $D$ is the diagonal of $A$. For coarse-grid correction, use full-weighting restriction $R: \\mathbb{R}^8 \\to \\mathbb{R}^4$ defined for coarse indices $I=0,1,2,3$ by\n$$\n(Rv)_{I} = \\frac{1}{4}v_{2I-1} + \\frac{1}{2}v_{2I} + \\frac{1}{4}v_{2I+1},\n$$\nwith periodic indexing, and linear interpolation prolongation $P: \\mathbb{R}^4 \\to \\mathbb{R}^8$ defined by\n$$\n(Pw)_{2I} = w_{I}, \\qquad (Pw)_{2I+1} = \\frac{1}{2}\\big(w_{I} + w_{I+1}\\big),\n$$\nwith periodic indexing on coarse indices. Let the coarse-grid operator be the canonical Galerkin choice $A_c = R A P$. The two-grid cycle updates the error $e$ in three stages: pre-smoothing $e^1 = S e^0$, coarse-grid correction $e^2 = (I - P A_c^{-1} R A)e^1$, and post-smoothing $e^3 = S e^2$.\n\nTake the initial fine-grid error to be the superposition of a low-frequency cosine mode and a high-frequency cosine mode,\n$$\ne^{0}_{j} = \\cos\\!\\Big(\\frac{\\pi}{4}\\,j\\Big) + \\cos(\\pi j), \\qquad j=0,1,\\dots,7.\n$$\nUsing only the definitions above and first principles derived from the periodic discrete Fourier representation of $A$, compute the Euclidean norms $\\|e^1\\|_2$, $\\|e^2\\|_2$, and $\\|e^3\\|_2$ resulting from one two-grid cycle. Express your final answer as a single row matrix with the three entries in exact analytic form. No units are required, and no rounding is needed.",
            "solution": "The user wants to compute the Euclidean norms of the error vector at three stages of a two-grid cycle for the one-dimensional Poisson equation. The problem is well-defined and all operators and parameters are specified. The method of choice for this analysis is Discrete Fourier Analysis, as the grid is uniform and the boundary conditions are periodic. The operators involved have a simple representation in the Fourier domain.\n\nFirst, we identify the components of the initial error, $e^{0}_{j} = \\cos(\\frac{\\pi}{4}\\,j) + \\cos(\\pi j)$. The uniform grid has $n=8$ points. We can express the error in terms of the standard real-valued discrete Fourier modes, $c^{(k)}_{j} = \\cos(\\frac{2\\pi k j}{n})$.\nThe first term is $\\cos(\\frac{\\pi}{4}j) = \\cos(\\frac{2\\pi \\cdot 1 \\cdot j}{8})$, which corresponds to the mode $c^{(1)}$. This is a low-frequency (smooth) mode.\nThe second term is $\\cos(\\pi j) = \\cos(\\frac{2\\pi \\cdot 4 \\cdot j}{8})$, which corresponds to the mode $c^{(4)}$. This is the highest-frequency mode on the grid.\nSo, the initial error is $e^0 = c^{(1)} + c^{(4)}$.\n\nThe discrete cosine modes on a grid of $n$ points are orthogonal. The squared Euclidean norm of a mode $c^{(k)}$ is given by:\n$$\n\\|c^{(k)}\\|_2^2 = \\sum_{j=0}^{n-1} \\cos^2\\left(\\frac{2\\pi k j}{n}\\right) =\n\\begin{cases}\nn & \\text{if } k=0 \\text{ or } k=n/2 \\\\\nn/2 & \\text{if } 0 < k < n/2\n\\end{cases}\n$$\nFor our grid with $n=8$:\n$\\|c^{(1)}\\|_2^2 = 8/2 = 4$.\n$\\|c^{(4)}\\|_2^2 = 8$.\nThe modes $c^{(1)}$ and $c^{(4)}$ are orthogonal, so $\\|e^0\\|_2^2 = \\|c^{(1)}\\|_2^2 + \\|c^{(4)}\\|_2^2 = 4 + 8 = 12$.\n\nThe operators $A$, $S$, and the coarse-grid correction operator $C = I - P A_{c}^{-1} R A$ act linearly on the error. We can analyze their effect on each mode. For periodic boundary conditions, a Fourier mode $v_j = \\exp(i\\theta j)$ with $\\theta = \\frac{2\\pi k}{n}$ is an eigenvector of any linear, translation-invariant operator. The corresponding eigenvalue is called the symbol of the operator.\n\nThe symbol of the discrete Laplacian $A$ is $\\hat{A}(\\theta) = \\frac{1}{h^2}(2 - e^{-i\\theta} - e^{i\\theta}) = \\frac{2(1-\\cos\\theta)}{h^2} = \\frac{4\\sin^2(\\theta/2)}{h^2}$.\nThe diagonal of $A$ is $D = \\frac{2}{h^2}I$. The symbol of the weighted Jacobi smoother $S = I - \\omega D^{-1}A$ with $\\omega=2/3$ is:\n$\\hat{S}(\\theta) = 1 - \\omega (\\frac{2}{h^2})^{-1} \\hat{A}(\\theta) = 1 - \\frac{2}{3} \\frac{h^2}{2} \\frac{4\\sin^2(\\theta/2)}{h^2} = 1 - \\frac{4}{3}\\sin^2(\\theta/2)$.\nSince $S$ is a real-symmetric operator, it scales the real mode $c^{(k)}$ by the factor $\\hat{S}(2\\pi k/n)$.\n\n**Step 1: Pre-smoothing to get $e^1 = S e^0$**\n$e^1 = S(c^{(1)} + c^{(4)}) = S c^{(1)} + S c^{(4)} = \\hat{S}(2\\pi/8) c^{(1)} + \\hat{S}(8\\pi/8) c^{(4)} = \\hat{S}(\\pi/4) c^{(1)} + \\hat{S}(\\pi) c^{(4)}$.\n\nWe compute the smoothing factors:\n$\\hat{S}(\\pi/4) = 1 - \\frac{4}{3}\\sin^2(\\pi/8) = 1 - \\frac{4}{3}\\left(\\frac{1-\\cos(\\pi/4)}{2}\\right) = 1 - \\frac{2}{3}\\left(1-\\frac{\\sqrt{2}}{2}\\right) = 1 - \\frac{2-\\sqrt{2}}{3} = \\frac{1+\\sqrt{2}}{3}$.\n$\\hat{S}(\\pi) = 1 - \\frac{4}{3}\\sin^2(\\pi/2) = 1 - \\frac{4}{3}(1) = -\\frac{1}{3}$.\n\nSo, $e^1 = \\frac{1+\\sqrt{2}}{3} c^{(1)} - \\frac{1}{3} c^{(4)}$.\nSince $c^{(1)}$ and $c^{(4)}$ are orthogonal, the norm is:\n$\\|e^1\\|_2^2 = \\left(\\frac{1+\\sqrt{2}}{3}\\right)^2 \\|c^{(1)}\\|_2^2 + \\left(-\\frac{1}{3}\\right)^2 \\|c^{(4)}\\|_2^2 = \\frac{1+2+2\\sqrt{2}}{9} \\cdot 4 + \\frac{1}{9} \\cdot 8 = \\frac{4(3+2\\sqrt{2})+8}{9} = \\frac{12+8\\sqrt{2}+8}{9} = \\frac{20+8\\sqrt{2}}{9}$.\n$\\|e^1\\|_2 = \\sqrt{\\frac{20+8\\sqrt{2}}{9}} = \\frac{\\sqrt{4(5+2\\sqrt{2})}}{3} = \\frac{2\\sqrt{5+2\\sqrt{2}}}{3}$.\n\n**Step 2: Coarse-grid correction to get $e^2 = C e^1$**\nThe coarse-grid correction operator $C = I - P A_{c}^{-1} R A$ couples Fourier modes. A low-frequency mode $k$ is aliased with a high-frequency mode $n/2-k$.\nFor our error components:\n- The high-frequency mode $c^{(4)}$ (i.e., $k=4=n/2$) is aliased with mode $k'=n/2-k = 4-4=0$. A key property of the full-weighting restriction operator $R$ is that it annihilates the highest-frequency mode: $R c^{(4)} = 0$. Consequently, $RAc^{(4)} = 0$ and $C c^{(4)} = (I - PA_c^{-1}RA)c^{(4)} = c^{(4)}$.\n- The low-frequency mode $c^{(1)}$ ($k=1$) is aliased with mode $c^{(3)}$ ($k'=4-1=3$). The action of $C$ on an input vector $\\alpha c^{(1)}$ produces an output with both $c^{(1)}$ and $c^{(3)}$ components. Fourier analysis shows that for an input $f_1 c^{(1)}$, the output is $f'_1 c^{(1)} + f'_3 c^{(3)}$, where $(f'_1, f'_3)^T = \\widehat{CGC}(\\pi/4) (f_1, 0)^T$. The symbol matrix is $\\widehat{CGC}(\\theta) = \\begin{pmatrix} \\sin^2(\\theta/2) & -\\cos^2(\\theta/2) \\\\ -\\sin^2(\\theta/2) & \\cos^2(\\theta/2) \\end{pmatrix}$.\n\nWith $\\theta=\\pi/4$ and an input coefficient of $\\alpha = \\frac{1+\\sqrt{2}}{3}$ for $c^{(1)}$ (from $e^1$), the output coefficients are:\n$\\begin{pmatrix} f'_1 \\\\ f'_3 \\end{pmatrix} = \\begin{pmatrix} \\sin^2(\\pi/8) & -\\cos^2(\\pi/8) \\\\ -\\sin^2(\\pi/8) & \\cos^2(\\pi/8) \\end{pmatrix} \\begin{pmatrix} \\alpha \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} \\alpha\\sin^2(\\pi/8) \\\\ -\\alpha\\sin^2(\\pi/8) \\end{pmatrix}$.\nLet's compute the coefficient value:\n$\\alpha\\sin^2(\\pi/8) = \\frac{1+\\sqrt{2}}{3} \\cdot \\frac{1-\\cos(\\pi/4)}{2} = \\frac{1+\\sqrt{2}}{3} \\cdot \\frac{1-\\sqrt{2}/2}{2} = \\frac{1+\\sqrt{2}}{3} \\cdot \\frac{2-\\sqrt{2}}{4} = \\frac{2-\\sqrt{2}+2\\sqrt{2}-2}{12} = \\frac{\\sqrt{2}}{12}$.\n\nSo, the action of $C$ on the components of $e^1$ is:\n$C\\left(\\frac{1+\\sqrt{2}}{3}c^{(1)}\\right) = \\frac{\\sqrt{2}}{12} c^{(1)} - \\frac{\\sqrt{2}}{12} c^{(3)}$.\n$C\\left(-\\frac{1}{3}c^{(4)}\\right) = -\\frac{1}{3} c^{(4)}$.\n$e^2 = \\frac{\\sqrt{2}}{12} c^{(1)} - \\frac{\\sqrt{2}}{12} c^{(3)} - \\frac{1}{3} c^{(4)}$.\nThe modes $c^{(1)}$, $c^{(3)}$, and $c^{(4)}$ are mutually orthogonal.\n$\\|e^2\\|_2^2 = \\left(\\frac{\\sqrt{2}}{12}\\right)^2\\|c^{(1)}\\|_2^2 + \\left(-\\frac{\\sqrt{2}}{12}\\right)^2\\|c^{(3)}\\|_2^2 + \\left(-\\frac{1}{3}\\right)^2\\|c^{(4)}\\|_2^2$.\n$\\|c^{(3)}\\|_2^2 = n/2 = 4$.\n$\\|e^2\\|_2^2 = \\frac{2}{144}(4) + \\frac{2}{144}(4) + \\frac{1}{9}(8) = \\frac{8}{144} + \\frac{8}{144} + \\frac{8}{9} = \\frac{1}{18} + \\frac{1}{18} + \\frac{16}{18} = \\frac{18}{18} = 1$.\nSo, $\\|e^2\\|_2 = 1$.\n\n**Step 3: Post-smoothing to get $e^3 = S e^2$**\n$e^3 = S e^2 = S\\left(\\frac{\\sqrt{2}}{12} c^{(1)} - \\frac{\\sqrt{2}}{12} c^{(3)} - \\frac{1}{3} c^{(4)}\\right)$.\n$e^3 = \\frac{\\sqrt{2}}{12} \\hat{S}(\\pi/4) c^{(1)} - \\frac{\\sqrt{2}}{12} \\hat{S}(3\\pi/4) c^{(3)} - \\frac{1}{3} \\hat{S}(\\pi) c^{(4)}$.\n\nWe already have $\\hat{S}(\\pi/4) = \\frac{1+\\sqrt{2}}{3}$ and $\\hat{S}(\\pi) = -\\frac{1}{3}$. We need $\\hat{S}(3\\pi/4)$:\n$\\hat{S}(3\\pi/4) = 1 - \\frac{4}{3}\\sin^2(3\\pi/8) = 1 - \\frac{4}{3}\\left(\\frac{1-\\cos(3\\pi/4)}{2}\\right) = 1 - \\frac{2}{3}\\left(1+\\frac{\\sqrt{2}}{2}\\right) = 1 - \\frac{2+\\sqrt{2}}{3} = \\frac{1-\\sqrt{2}}{3}$.\n\nThe coefficients of the modes in $e^3$ are:\n- for $c^{(1)}$: $\\frac{\\sqrt{2}}{12} \\cdot \\frac{1+\\sqrt{2}}{3} = \\frac{\\sqrt{2}+2}{36}$.\n- for $c^{(3)}$: $-\\frac{\\sqrt{2}}{12} \\cdot \\frac{1-\\sqrt{2}}{3} = -\\frac{\\sqrt{2}-2}{36} = \\frac{2-\\sqrt{2}}{36}$.\n- for $c^{(4)}$: $-\\frac{1}{3} \\cdot (-\\frac{1}{3}) = \\frac{1}{9}$.\n\n$e^3 = \\frac{2+\\sqrt{2}}{36} c^{(1)} + \\frac{2-\\sqrt{2}}{36} c^{(3)} + \\frac{1}{9} c^{(4)}$.\nBy orthogonality, we compute the norm:\n$\\|e^3\\|_2^2 = \\left(\\frac{2+\\sqrt{2}}{36}\\right)^2\\|c^{(1)}\\|_2^2 + \\left(\\frac{2-\\sqrt{2}}{36}\\right)^2\\|c^{(3)}\\|_2^2 + \\left(\\frac{1}{9}\\right)^2\\|c^{(4)}\\|_2^2$.\n$\\|e^3\\|_2^2 = \\left(\\frac{4+2+4\\sqrt{2}}{1296}\\right)(4) + \\left(\\frac{4+2-4\\sqrt{2}}{1296}\\right)(4) + \\frac{1}{81}(8)$.\n$\\|e^3\\|_2^2 = \\frac{4}{1296} ( (6+4\\sqrt{2}) + (6-4\\sqrt{2}) ) + \\frac{8}{81} = \\frac{4}{1296}(12) + \\frac{8}{81} = \\frac{48}{1296} + \\frac{8}{81}$.\nSince $1296 = 16 \\times 81$, we have $\\frac{48}{1296} = \\frac{3 \\times 16}{16 \\times 81} = \\frac{3}{81}$.\n$\\|e^3\\|_2^2 = \\frac{3}{81} + \\frac{8}{81} = \\frac{11}{81}$.\nTherefore, $\\|e^3\\|_2 = \\sqrt{\\frac{11}{81}} = \\frac{\\sqrt{11}}{9}$.\n\nThe three computed norms are $\\|e^1\\|_2 = \\frac{2\\sqrt{5+2\\sqrt{2}}}{3}$, $\\|e^2\\|_2 = 1$, and $\\|e^3\\|_2 = \\frac{\\sqrt{11}}{9}$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{2\\sqrt{5+2\\sqrt{2}}}{3} & 1 & \\frac{\\sqrt{11}}{9} \\end{pmatrix}}\n$$"
        }
    ]
}