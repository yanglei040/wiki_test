{
    "hands_on_practices": [
        {
            "introduction": "At the heart of a sparse grid construction is the rule for selecting which tensor-product grids to combine. This rule is encoded in an \"admissible index set.\" This first practice demystifies this concept by having you build a total-degree index set from scratch, giving you a foundational understanding of the combinatorial structure that makes sparse grids efficient .",
            "id": "3447814",
            "problem": "Consider a parametric elliptic Partial Differential Equation (PDE) with random inputs in three stochastic dimensions, where the spatial operator and forcing are fixed and the randomness enters through a parametric vector $\\boldsymbol{\\xi} \\in \\Gamma \\subset \\mathbb{R}^{3}$. A stochastic collocation method on sparse grids is constructed using hierarchical one-dimensional rules, combined by a Smolyak-type selection of tensor-product subspaces guided by a multi-index admissible set. The total-degree constraint prescribes the set of multi-indices to be those whose components sum to at most a given level. \n\nLet the admissible set be defined by\n$$\n\\Lambda^{\\mathrm{TD}}(q,d) := \\left\\{ \\boldsymbol{\\alpha} \\in \\mathbb{N}_{0}^{d} : \\sum_{j=1}^{d} \\alpha_{j} \\le q \\right\\},\n$$\nwith $d=3$ and $q=4$. The anisotropic levels for each tensor-product subspace are the one-dimensional hierarchical levels corresponding to the components of $\\boldsymbol{\\alpha}$, namely $\\ell_{j} = \\alpha_{j}$ for $j \\in \\{1,2,3\\}$, when the anisotropy is governed by the total-degree (isotropic) constraint so that all directions are weighted equally in the sum.\n\nStarting from the core definitions of hierarchical levels and admissible index sets, construct $\\Lambda^{\\mathrm{TD}}(4,3)$ and the associated anisotropic levels $\\boldsymbol{\\ell}(\\boldsymbol{\\alpha}) = (\\alpha_{1},\\alpha_{2},\\alpha_{3})$ for each $\\boldsymbol{\\alpha} \\in \\Lambda^{\\mathrm{TD}}(4,3)$. Then, compute the cardinality of $\\Lambda^{\\mathrm{TD}}(4,3)$, i.e., the total number of admissible multi-indices.\n\nProvide your final answer as a single real-valued number. No rounding is required.",
            "solution": "The problem requires the construction of the total-degree admissible set of multi-indices $\\Lambda^{\\mathrm{TD}}(q,d)$ for a stochastic dimension $d=3$ and a level $q=4$, and the computation of its cardinality.\n\nThe admissible set is defined as:\n$$\n\\Lambda^{\\mathrm{TD}}(q,d) := \\left\\{ \\boldsymbol{\\alpha} \\in \\mathbb{N}_{0}^{d} : \\sum_{j=1}^{d} \\alpha_{j} \\le q \\right\\}\n$$\nIn this specific case, the parameters are given as $d=3$ and $q=4$. Thus, the set is:\n$$\n\\Lambda^{\\mathrm{TD}}(4,3) = \\left\\{ \\boldsymbol{\\alpha} = (\\alpha_1, \\alpha_2, \\alpha_3) \\in \\mathbb{N}_{0}^{3} : \\alpha_1 + \\alpha_2 + \\alpha_3 \\le 4 \\right\\}\n$$\nwhere $\\mathbb{N}_{0}$ represents the set of non-negative integers $\\{0, 1, 2, \\dots\\}$.\n\nThe problem asks for three tasks:\n1.  Construct the set $\\Lambda^{\\mathrm{TD}}(4,3)$.\n2.  Identify the associated anisotropic levels $\\boldsymbol{\\ell}(\\boldsymbol{\\alpha}) = (\\alpha_1, \\alpha_2, \\alpha_3)$ for each $\\boldsymbol{\\alpha}$. By definition, the vector of levels $\\boldsymbol{\\ell}(\\boldsymbol{\\alpha})$ is identical to the multi-index $\\boldsymbol{\\alpha}$ itself. Therefore, constructing the set of multi-indices is equivalent to constructing the set of level vectors.\n3.  Compute the cardinality of this set, $|\\Lambda^{\\mathrm{TD}}(4,3)|$.\n\nTo compute the cardinality, we need to find the number of non-negative integer solutions to the inequality $\\alpha_1 + \\alpha_2 + \\alpha_3 \\le 4$. This is a classic combinatorial problem that can be solved using the \"stars and bars\" method.\n\nWe introduce a non-negative integer slack variable, $\\alpha_4 \\ge 0$, to convert the inequality into an equality:\n$$\n\\alpha_1 + \\alpha_2 + \\alpha_3 + \\alpha_4 = 4\n$$\nThe number of non-negative integer solutions $(\\alpha_1, \\alpha_2, \\alpha_3)$ to the inequality is now equal to the number of non-negative integer solutions $(\\alpha_1, \\alpha_2, \\alpha_3, \\alpha_4)$ to the equality.\n\nThis is equivalent to distributing $k=4$ indistinguishable items (\"stars\") into $n=4$ distinguishable bins (the variables $\\alpha_1, \\alpha_2, \\alpha_3, \\alpha_4$). The number of ways to do this is given by the multiset coefficient formula:\n$$\n\\binom{k+n-1}{n-1} = \\binom{k+n-1}{k}\n$$\nSubstituting $k=4$ and $n=4$, we get:\n$$\n|\\Lambda^{\\mathrm{TD}}(4,3)| = \\binom{4+4-1}{4-1} = \\binom{7}{3}\n$$\nNow we compute the value of the binomial coefficient:\n$$\n\\binom{7}{3} = \\frac{7!}{3!(7-3)!} = \\frac{7!}{3!4!} = \\frac{7 \\times 6 \\times 5 \\times 4!}{ (3 \\times 2 \\times 1) \\times 4!} = \\frac{7 \\times 6 \\times 5}{6} = 35\n$$\nThus, the cardinality of the set $\\Lambda^{\\mathrm{TD}}(4,3)$ is $35$.\n\nTo fulfill the construction part of the problem, we can systematically list the multi-indices $\\boldsymbol{\\alpha} = (\\alpha_1, \\alpha_2, \\alpha_3)$ by grouping them according to the sum of their components, $S = \\alpha_1 + \\alpha_2 + \\alpha_3$.\n\nFor $S=0$:\nThere is $1$ multi-index: $(0,0,0)$.\n\nFor $S=1$:\nThere are $\\binom{1+3-1}{3-1} = \\binom{3}{2} = 3$ multi-indices:\n$(1,0,0)$, $(0,1,0)$, $(0,0,1)$.\n\nFor $S=2$:\nThere are $\\binom{2+3-1}{3-1} = \\binom{4}{2} = 6$ multi-indices:\n$(2,0,0)$, $(0,2,0)$, $(0,0,2)$, $(1,1,0)$, $(1,0,1)$, $(0,1,1)$.\n\nFor $S=3$:\nThere are $\\binom{3+3-1}{3-1} = \\binom{5}{2} = 10$ multi-indices:\n$(3,0,0)$, $(0,3,0)$, $(0,0,3)$, $(2,1,0)$, $(2,0,1)$, $(1,2,0)$, $(0,2,1)$, $(1,0,2)$, $(0,1,2)$, $(1,1,1)$.\n\nFor $S=4$:\nThere are $\\binom{4+3-1}{3-1} = \\binom{6}{2} = 15$ multi-indices:\n$(4,0,0)$, $(0,4,0)$, $(0,0,4)$, $(3,1,0)$, $(3,0,1)$, $(1,3,0)$, $(0,3,1)$, $(1,0,3)$, $(0,1,3)$, $(2,2,0)$, $(2,0,2)$, $(0,2,2)$, $(2,1,1)$, $(1,2,1)$, $(1,1,2)$.\n\nThe total number of multi-indices is the sum of the counts for each possible sum $S$:\n$$\n|\\Lambda^{\\mathrm{TD}}(4,3)| = 1 + 3 + 6 + 10 + 15 = 35\n$$\nThis enumeration confirms the result obtained from the stars and bars method. The set $\\Lambda^{\\mathrm{TD}}(4,3)$ consists of these $35$ multi-indices. As noted, the set of associated anisotropic levels $\\boldsymbol{\\ell}(\\boldsymbol{\\alpha})$ is identical to this set of multi-indices. The final answer required is the cardinality of this set.",
            "answer": "$$\\boxed{35}$$"
        },
        {
            "introduction": "Now that you understand the blueprint of a sparse grid, let's see the method in action on a complete problem. This practice walks you through the entire uncertainty quantification workflow, starting from a parametric partial differential equation (PDE), deriving the quantity of interest, and finally applying a Smolyak sparse-grid quadrature rule to approximate its expected value. This exercise connects the abstract construction to a tangible engineering application .",
            "id": "3447872",
            "problem": "Consider the following parametric Partial Differential Equation (PDE) model posed on the spatial domain $x \\in (0,1)$ with homogeneous Dirichlet boundary conditions. Let the parametric vector be $\\boldsymbol{y} = (y_1,y_2) \\in \\Gamma := [-1,1]^2$, and define the product measure density $\\rho(\\boldsymbol{y}) = \\frac{1}{4}$ on $\\Gamma$. The PDE is\n$$\n-\\frac{d}{dx}\\left( a(\\boldsymbol{y}) \\frac{du(x;\\boldsymbol{y})}{dx} \\right) = 1, \\quad u(0;\\boldsymbol{y}) = 0, \\quad u(1;\\boldsymbol{y}) = 0,\n$$\nwith parametric coefficient\n$$\na(\\boldsymbol{y}) := 3 + y_1 + y_2,\n$$\nwhich is strictly positive on $\\Gamma$. Define the quantity of interest\n$$\nQ\\big(u(\\boldsymbol{y})\\big) := \\int_{0}^{1} u(x;\\boldsymbol{y})\\,dx.\n$$\nThe mean of $Q$, denoted $\\mathbb{E}[Q]$, is\n$$\n\\mathbb{E}[Q] = \\int_{\\Gamma} Q\\big(u(\\boldsymbol{y})\\big)\\,\\rho(\\boldsymbol{y})\\,d\\boldsymbol{y}.\n$$\n\nYou are to compute $\\mathbb{E}[Q]$ using stochastic collocation on sparse grids via a Smolyak quadrature construction at total level $L=2$ in dimension $d=2$, built from the following one-dimensional quadrature rules on $[-1,1]$ (for Lebesgue measure):\n\n1. The level-$1$ rule $Q_1$ consists of the single node $y=0$ with weight $w=2$.\n2. The level-$2$ rule $Q_2$ is the two-point Gauss–Legendre rule with nodes $y=\\pm a$, $a = 1/\\sqrt{3}$, each with weight $w=1$.\n\nConstruct the two-dimensional Smolyak quadrature at level $L=2$ from the hierarchical differences and apply it to approximate $\\mathbb{E}[Q]$. In particular:\n\n1. Solve the PDE analytically to obtain $u(x;\\boldsymbol{y})$ as a function of $x$ and $\\boldsymbol{y}$, then derive $Q\\big(u(\\boldsymbol{y})\\big)$ explicitly in terms of $\\boldsymbol{y}$.\n2. From the definition of the Smolyak construction in two dimensions at level $L=2$ with the given one-dimensional rules, derive the resulting sparse-grid nodes and weights for the integral over $\\Gamma$. Carefully incorporate the product measure density $\\rho(\\boldsymbol{y})$ into the quadrature weights appropriate for computing the mean.\n3. Evaluate the collocation-based sparse-grid quadrature approximation to $\\mathbb{E}[Q]$.\n\nExpress the final result as a single closed-form analytic expression. Do not round; provide the exact value.",
            "solution": "The problem statement is evaluated based on the established criteria for validity.\n\n### Step 1: Extract Givens\n- **PDE Model**: $-\\frac{d}{dx}\\left( a(\\boldsymbol{y}) \\frac{du(x;\\boldsymbol{y})}{dx} \\right) = 1$\n- **Spatial Domain**: $x \\in (0,1)$\n- **Boundary Conditions**: $u(0;\\boldsymbol{y}) = 0$, $u(1;\\boldsymbol{y}) = 0$\n- **Parametric Domain**: $\\boldsymbol{y} = (y_1, y_2) \\in \\Gamma := [-1,1]^2$\n- **Probability Density**: $\\rho(\\boldsymbol{y}) = \\frac{1}{4}$ on $\\Gamma$\n- **Parametric Coefficient**: $a(\\boldsymbol{y}) := 3 + y_1 + y_2$\n- **Quantity of Interest (QoI)**: $Q\\big(u(\\boldsymbol{y})\\big) := \\int_{0}^{1} u(x;\\boldsymbol{y})\\,dx$\n- **Target Quantity**: $\\mathbb{E}[Q] = \\int_{\\Gamma} Q\\big(u(\\boldsymbol{y})\\big)\\,\\rho(\\boldsymbol{y})\\,d\\boldsymbol{y}$\n- **Numerical Method**: Stochastic collocation on a Smolyak sparse grid.\n- **Dimension**: $d=2$\n- **Total Level**: $L=2$\n- **1D Quadrature Rules on $[-1,1]$ (for Lebesgue measure)**:\n  - Level-1 rule ($Q_1$): Node $y=0$, weight $w=2$. So, $Q_1[f] = 2f(0)$.\n  - Level-2 rule ($Q_2$): Nodes $y=\\pm a$ where $a = 1/\\sqrt{3}$, each with weight $w=1$. So, $Q_2[f] = f(-1/\\sqrt{3}) + f(1/\\sqrt{3})$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is well-defined and scientifically grounded.\n- **Scientific Grounding**: The problem describes a one-dimensional elliptic PDE (a form of the Poisson equation) with a parametric diffusion coefficient. This is a standard model problem in the field of uncertainty quantification. The parameterization of the coefficient $a(\\boldsymbol{y}) = 3 + y_1 + y_2$ ensures it is strictly positive on the domain $\\Gamma = [-1,1]^2$, as $y_1+y_2$ ranges from $-2$ to $2$, so $a(\\boldsymbol{y})$ ranges from $1$ to $5$. This guarantees the existence and uniqueness of a solution to the PDE for each $\\boldsymbol{y}$. The use of Smolyak sparse grids for numerical integration is a well-established technique in computational science.\n- **Well-Posedness**: The problem is specified with all necessary components: a well-posed PDE, defined parameter space and probability measure, a clearly defined quantity of interest, and specific instructions for the numerical approximation scheme. The goal is unambiguous.\n- **Objectivity**: The problem is stated in precise, objective mathematical language, free from any subjective or speculative content.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A complete solution will be provided.\n\n### Solution Derivation\n\nThe solution is found in three stages: first, we solve the PDE analytically to find an explicit expression for the Quantity of Interest (QoI); second, we construct the specified Smolyak quadrature rule; third, we apply the rule to approximate the expected value of the QoI.\n\n**1. Analytical Expression for the Quantity of Interest**\n\nThe PDE is given by:\n$$-\\frac{d}{dx}\\left( a(\\boldsymbol{y}) \\frac{du(x;\\boldsymbol{y})}{dx} \\right) = 1$$\nSince the coefficient $a(\\boldsymbol{y})$ does not depend on the spatial variable $x$, we can integrate the equation with respect to $x$ twice.\nFirst integration:\n$$-a(\\boldsymbol{y}) \\frac{du}{dx} = x + C_1$$\nDividing by $-a(\\boldsymbol{y})$:\n$$\\frac{du}{dx} = -\\frac{1}{a(\\boldsymbol{y})}(x + C_1)$$\nSecond integration:\n$$u(x;\\boldsymbol{y}) = -\\frac{1}{a(\\boldsymbol{y})} \\left(\\frac{1}{2}x^2 + C_1x + C_2\\right)$$\nWe apply the homogeneous Dirichlet boundary conditions, $u(0;\\boldsymbol{y}) = 0$ and $u(1;\\boldsymbol{y}) = 0$, to determine the integration constants $C_1$ and $C_2$.\nFrom $u(0;\\boldsymbol{y})=0$:\n$$-\\frac{1}{a(\\boldsymbol{y})} \\left(\\frac{1}{2}(0)^2 + C_1(0) + C_2\\right) = 0 \\implies C_2 = 0$$\nFrom $u(1;\\boldsymbol{y})=0$:\n$$-\\frac{1}{a(\\boldsymbol{y})} \\left(\\frac{1}{2}(1)^2 + C_1(1)\\right) = 0 \\implies \\frac{1}{2} + C_1 = 0 \\implies C_1 = -\\frac{1}{2}$$\nSubstituting the constants back, the analytical solution for the displacement $u(x;\\boldsymbol{y})$ is:\n$$u(x;\\boldsymbol{y}) = -\\frac{1}{a(\\boldsymbol{y})} \\left(\\frac{1}{2}x^2 - \\frac{1}{2}x\\right) = \\frac{x-x^2}{2a(\\boldsymbol{y})}$$\nNext, we compute the quantity of interest, $Q\\big(u(\\boldsymbol{y})\\big)$:\n$$Q\\big(u(\\boldsymbol{y})\\big) = \\int_{0}^{1} u(x;\\boldsymbol{y})\\,dx = \\int_{0}^{1} \\frac{x-x^2}{2a(\\boldsymbol{y})}\\,dx$$\n$$Q\\big(u(\\boldsymbol{y})\\big) = \\frac{1}{2a(\\boldsymbol{y})} \\left[ \\frac{1}{2}x^2 - \\frac{1}{3}x^3 \\right]_{0}^{1} = \\frac{1}{2a(\\boldsymbol{y})} \\left( \\frac{1}{2} - \\frac{1}{3} \\right) = \\frac{1}{2a(\\boldsymbol{y})} \\left( \\frac{1}{6} \\right) = \\frac{1}{12a(\\boldsymbol{y})}$$\nSubstituting the expression for $a(\\boldsymbol{y}) = 3 + y_1 + y_2$, we obtain the QoI as an explicit function of $\\boldsymbol{y}$:\n$$Q\\big(u(\\boldsymbol{y})\\big) = \\frac{1}{12(3 + y_1 + y_2)}$$\nLet us denote this function as $f(\\boldsymbol{y}) \\equiv f(y_1, y_2)$.\n\n**2. Smolyak Quadrature Rule Construction**\n\nThe task is to approximate $\\mathbb{E}[Q] = \\int_{[-1,1]^2} f(\\boldsymbol{y}) \\rho(\\boldsymbol{y}) d\\boldsymbol{y}$, where $\\rho(\\boldsymbol{y})=1/4$. This can be written as:\n$$\\mathbb{E}[Q] = \\frac{1}{4} \\int_{-1}^{1} \\int_{-1}^{1} f(y_1, y_2) \\,dy_1 \\,dy_2$$\nWe will approximate the integral over the Lebesgue measure using a Smolyak sparse grid. The Smolyak quadrature operator, $\\mathcal{A}_{L,d}$, at level $L$ in $d$ dimensions is constructed from the one-dimensional rules $Q_i$. A standard construction based on hierarchical differences $\\Delta_i = Q_i - Q_{i-1}$ (with $Q_0=0$) is given by:\n$$\\mathcal{A}_{L,d} = \\sum_{|\\boldsymbol{i}|_1 \\leq L+d-1, \\boldsymbol{i} \\in \\mathbb{N}^d} \\bigotimes_{j=1}^d \\Delta_{i_j}$$\nFor this problem, $L=2$ and $d=2$, so the index set is $\\{ \\boldsymbol{i}=(i_1, i_2) \\in \\mathbb{N}^2 \\mid i_1+i_2 \\le 2+2-1=3 \\}$. The multi-indices are $(1,1), (1,2), (2,1)$.\nThe operator is $\\mathcal{A}_{2,2} = (\\Delta_1 \\otimes \\Delta_1) + (\\Delta_1 \\otimes \\Delta_2) + (\\Delta_2 \\otimes \\Delta_1)$.\nSubstituting the hierarchical differences $\\Delta_1 = Q_1$ and $\\Delta_2 = Q_2 - Q_1$:\n$$\\mathcal{A}_{2,2} = (Q_1 \\otimes Q_1) + (Q_1 \\otimes (Q_2 - Q_1)) + ((Q_2 - Q_1) \\otimes Q_1)$$\nExpanding this expression gives:\n$$\\mathcal{A}_{2,2} = (Q_1 \\otimes Q_1) + (Q_1 \\otimes Q_2) - (Q_1 \\otimes Q_1) + (Q_2 \\otimes Q_1) - (Q_1 \\otimes Q_1)$$\n$$\\mathcal{A}_{2,2} = (Q_1 \\otimes Q_2) + (Q_2 \\otimes Q_1) - (Q_1 \\otimes Q_1)$$\nThis is the Smolyak quadrature rule for level $L=2$ in dimension $d=2$. Let's apply this to our function $f(\\boldsymbol{y})$.\n- $Q_1[g] = 2g(0)$.\n- $Q_2[g] = g(-a) + g(a)$, where $a=1/\\sqrt{3}$.\nThe tensor product terms are:\n- $(Q_1 \\otimes Q_1)[f] = Q_1[Q_1[f(y_1, y_2)]_{y_2}]_{y_1} = Q_1[2f(y_1, 0)]_{y_1} = 2(2f(0,0)) = 4f(0,0)$.\n- $(Q_1 \\otimes Q_2)[f] = Q_1[Q_2[f(y_1, y_2)]_{y_2}]_{y_1} = Q_1[f(y_1, -a) + f(y_1, a)]_{y_1} = 2(f(0, -a) + f(0, a))$.\n- $(Q_2 \\otimes Q_1)[f] = Q_2[Q_1[f(y_1, y_2)]_{y_2}]_{y_1} = Q_2[2f(y_1, 0)]_{y_1} = 2(f(-a, 0) + f(a, 0))$.\nCombining these gives the Smolyak rule:\n$$\\mathcal{A}_{2,2}[f] = 2(f(0, -a) + f(0, a)) + 2(f(-a, 0) + f(a, 0)) - 4f(0,0)$$\nThe sparse grid consists of the following nodes and weights for the Lebesgue integral:\n- Nodes: $(0, -1/\\sqrt{3})$, $(0, 1/\\sqrt{3})$, $(-1/\\sqrt{3}, 0)$, $(1/\\sqrt{3}, 0)$. Each has a weight of $2$.\n- Node: $(0,0)$. This has a weight of $-4$.\n\n**3. Evaluation of the Mean QoI Approximation**\n\nWe now evaluate $f(y_1, y_2) = \\frac{1}{12(3 + y_1 + y_2)}$ at the sparse grid nodes, where $a=1/\\sqrt{3}$.\n- $f(0,0) = \\frac{1}{12(3 + 0 + 0)} = \\frac{1}{36}$.\n- $f(a,0) = f(1/\\sqrt{3}, 0) = \\frac{1}{12(3 + 1/\\sqrt{3})}$.\n- $f(-a,0) = f(-1/\\sqrt{3}, 0) = \\frac{1}{12(3 - 1/\\sqrt{3})}$.\n- $f(0,a) = f(0, 1/\\sqrt{3}) = \\frac{1}{12(3 + 1/\\sqrt{3})}$.\n- $f(0,-a) = f(0, -1/\\sqrt{3}) = \\frac{1}{12(3 - 1/\\sqrt{3})}$.\n\nSubstitute these values into the quadrature formula $\\mathcal{A}_{2,2}[f]$:\n$$\\mathcal{A}_{2,2}[f] = 2\\left(\\frac{1}{12(3 - 1/\\sqrt{3})}\\right) + 2\\left(\\frac{1}{12(3 + 1/\\sqrt{3})}\\right) + 2\\left(\\frac{1}{12(3 - 1/\\sqrt{3})}\\right) + 2\\left(\\frac{1}{12(3 + 1/\\sqrt{3})}\\right) - 4\\left(\\frac{1}{36}\\right)$$\n$$\\mathcal{A}_{2,2}[f] = 4\\left(\\frac{1}{12(3 - 1/\\sqrt{3})}\\right) + 4\\left(\\frac{1}{12(3 + 1/\\sqrt{3})}\\right) - \\frac{4}{36}$$\n$$\\mathcal{A}_{2,2}[f] = \\frac{1}{3}\\left(\\frac{1}{3 - 1/\\sqrt{3}} + \\frac{1}{3 + 1/\\sqrt{3}}\\right) - \\frac{1}{9}$$\nWe simplify the term in the parenthesis by finding a common denominator:\n$$\\frac{1}{3 - 1/\\sqrt{3}} + \\frac{1}{3 + 1/\\sqrt{3}} = \\frac{(3 + 1/\\sqrt{3}) + (3 - 1/\\sqrt{3})}{(3 - 1/\\sqrt{3})(3 + 1/\\sqrt{3})} = \\frac{6}{3^2 - (1/\\sqrt{3})^2} = \\frac{6}{9 - 1/3} = \\frac{6}{26/3} = \\frac{18}{26} = \\frac{9}{13}$$\nSubstituting this back into the expression for $\\mathcal{A}_{2,2}[f]$:\n$$\\mathcal{A}_{2,2}[f] = \\frac{1}{3}\\left(\\frac{9}{13}\\right) - \\frac{1}{9} = \\frac{3}{13} - \\frac{1}{9} = \\frac{3 \\cdot 9 - 13 \\cdot 1}{117} = \\frac{27 - 13}{117} = \\frac{14}{117}$$\nThis is the approximation of the integral $\\int_{[-1,1]^2} f(\\boldsymbol{y}) d\\boldsymbol{y}$. The approximation of the expected value $\\mathbb{E}[Q]$ is:\n$$\\mathbb{E}[Q] \\approx \\frac{1}{4} \\mathcal{A}_{2,2}[f] = \\frac{1}{4} \\left(\\frac{14}{117}\\right) = \\frac{7}{2 \\cdot 117} = \\frac{7}{234}$$\nThis is the final closed-form analytic result.",
            "answer": "$$\n\\boxed{\\frac{7}{234}}\n$$"
        },
        {
            "introduction": "While fixed sparse grids are powerful, their efficiency can be dramatically improved by concentrating computational effort where it's most needed. This leads to the concept of adaptive sparse grids. This practice explores the core mechanism of adaptivity by having you compute \"hierarchical surpluses,\" which serve as error indicators that guide the refinement process, making the grid construction intelligent and dynamic .",
            "id": "3447815",
            "problem": "Consider a one-dimensional parametric response function $f(y)$ arising from a coercive linear Partial Differential Equation (PDE) with an affine parameterization in a single uncertain input $y \\in [-1,1]$. Assume that the mapping from $y$ to the quantity of interest is analytic and, for the purposes of this exercise, let $f(y) = \\exp(y)$. In stochastic collocation on sparse grids with nested Clenshaw–Curtis (CC) abscissae, the level-$\\ell$ node sets on $[-1,1]$ are nested as follows:\n- Level $1$: $\\{0\\}$,\n- Level $2$: $\\{-1,0,1\\}$,\n- Level $3$: $\\{-1,-1/\\sqrt{2},0,1/\\sqrt{2},1\\}$.\n\nDefine the hierarchical surplus at a level-$\\ell$ node $y$ as $s_{\\ell}(y) = f(y) - I_{\\ell-1}[f](y)$, where $I_{\\ell-1}[f]$ is the unique polynomial interpolant constructed using all nodes from levels $1$ through $\\ell-1$.\n\nTasks:\n1. Construct $I_{0}[f]$ and compute $s_{1}(0)$.\n2. Construct $I_{1}[f]$ and compute $s_{2}(-1)$ and $s_{2}(1)$.\n3. Construct $I_{2}[f]$ using the level-$2$ nodes $\\{-1,0,1\\}$ and compute $s_{3}(-1/\\sqrt{2})$ and $s_{3}(1/\\sqrt{2})$.\n4. Using the computed surpluses, determine the largest absolute hierarchical surplus magnitude across all added nodes at levels $1$, $2$, and $3$.\n\nReport as your final answer the largest absolute hierarchical surplus magnitude as an exact analytical expression. No rounding is required, and no physical units are involved. Briefly explain in your working how the surplus magnitude guides refinement decisions in a sparse-grid collocation setting.",
            "solution": "The problem requires the calculation of hierarchical surpluses for the function $f(y) = \\exp(y)$ on a sequence of nested Clenshaw-Curtis grids and the identification of the largest absolute surplus magnitude. The hierarchical surplus at a level-$\\ell$ node $y$ is defined as $s_{\\ell}(y) = f(y) - I_{\\ell-1}[f](y)$, where $I_{\\ell-1}[f]$ is the polynomial interpolant constructed using all nodes up to level $\\ell-1$. The function is $f(y) = \\exp(y)$ on the domain $y \\in [-1,1]$.\n\nThe process is divided into four tasks.\n\n**Task 1: Construct $I_{0}[f]$ and compute $s_{1}(0)$**\nThe interpolant $I_{0}[f]$ is constructed using nodes from levels $1$ through $0$, which is an empty set. By convention, an interpolating polynomial on an empty set of nodes is the zero polynomial.\nThus, $I_{0}[f](y) = 0$.\nThe single node added at level $\\ell=1$ is $y_1 = 0$.\nThe hierarchical surplus at this node is:\n$$s_{1}(0) = f(0) - I_{0}[f](0) = \\exp(0) - 0 = 1$$\n\n**Task 2: Construct $I_{1}[f]$ and compute $s_{2}(-1)$ and $s_{2}(1)$**\nThe interpolant $I_{1}[f]$ is constructed using the nodes from level $1$, which is the set $\\{0\\}$. The polynomial of degree $0$ that interpolates $f(y)$ at $y=0$ is a constant function matching the function value at that point.\nThe interpolation point is $(0, f(0)) = (0, \\exp(0)) = (0,1)$.\nThus, the interpolant is $I_{1}[f](y) = 1$.\nThe nodes added at level $\\ell=2$ are $\\{-1, 1\\}$. We compute the surpluses at these nodes:\nFor $y=-1$:\n$$s_{2}(-1) = f(-1) - I_{1}[f](-1) = \\exp(-1) - 1$$\nFor $y=1$:\n$$s_{2}(1) = f(1) - I_{1}[f](1) = \\exp(1) - 1$$\n\n**Task 3: Construct $I_{2}[f]$ and compute $s_{3}(-1/\\sqrt{2})$ and $s_{3}(1/\\sqrt{2})$**\nThe interpolant $I_{2}[f]$ is constructed using the nodes from levels $1$ and $2$. The union of these node sets is the level-$2$ set $\\{-1, 0, 1\\}$. We need to find the unique polynomial of degree at most $2$ that passes through the points $(-1, f(-1))$, $(0, f(0))$, and $(1, f(1))$.\nThe points are $(-1, \\exp(-1))$, $(0, 1)$, and $(1, \\exp(1))$.\nLet the interpolating polynomial be $I_{2}[f](y) = ay^2 + by + c$.\nUsing the point $(0,1)$:\n$$I_{2}[f](0) = c = 1$$\nUsing the points $(1, \\exp(1))$ and $(-1, \\exp(-1))$:\n\\begin{align*} a(1)^2 + b(1) + 1 = \\exp(1) \\implies a+b = \\exp(1) - 1 \\\\ a(-1)^2 + b(-1) + 1 = \\exp(-1) \\implies a-b = \\exp(-1) - 1 \\end{align*}\nThis is a system of two linear equations for $a$ and $b$. Adding the two equations yields:\n$$2a = \\exp(1) + \\exp(-1) - 2 \\implies a = \\frac{\\exp(1) + \\exp(-1)}{2} - 1 = \\cosh(1) - 1$$\nSubtracting the second equation from the first yields:\n$$2b = \\exp(1) - \\exp(-1) \\implies b = \\frac{\\exp(1) - \\exp(-1)}{2} = \\sinh(1)$$\nSo the interpolant is $I_{2}[f](y) = (\\cosh(1)-1)y^2 + \\sinh(1)y + 1$.\nThe nodes added at level $\\ell=3$ are $\\{-1/\\sqrt{2}, 1/\\sqrt{2}\\}$. We compute the surpluses at these points.\nFor $y = 1/\\sqrt{2}$:\n\\begin{align*} s_{3}\\left(\\frac{1}{\\sqrt{2}}\\right) = f\\left(\\frac{1}{\\sqrt{2}}\\right) - I_{2}[f]\\left(\\frac{1}{\\sqrt{2}}\\right) \\\\ = \\exp\\left(\\frac{1}{\\sqrt{2}}\\right) - \\left[ (\\cosh(1)-1)\\left(\\frac{1}{\\sqrt{2}}\\right)^2 + \\sinh(1)\\left(\\frac{1}{\\sqrt{2}}\\right) + 1 \\right] \\\\ = \\exp\\left(\\frac{1}{\\sqrt{2}}\\right) - \\left[ \\frac{1}{2}(\\cosh(1)-1) + \\frac{1}{\\sqrt{2}}\\sinh(1) + 1 \\right] \\\\ = \\exp\\left(\\frac{1}{\\sqrt{2}}\\right) - \\frac{1}{2}\\cosh(1) + \\frac{1}{2} - \\frac{1}{\\sqrt{2}}\\sinh(1) - 1 \\\\ = \\exp\\left(\\frac{1}{\\sqrt{2}}\\right) - \\frac{1}{2}\\cosh(1) - \\frac{1}{\\sqrt{2}}\\sinh(1) - \\frac{1}{2} \\end{align*}\nFor $y = -1/\\sqrt{2}$:\n\\begin{align*} s_{3}\\left(-\\frac{1}{\\sqrt{2}}\\right) = f\\left(-\\frac{1}{\\sqrt{2}}\\right) - I_{2}[f]\\left(-\\frac{1}{\\sqrt{2}}\\right) \\\\ = \\exp\\left(-\\frac{1}{\\sqrt{2}}\\right) - \\left[ (\\cosh(1)-1)\\left(-\\frac{1}{\\sqrt{2}}\\right)^2 + \\sinh(1)\\left(-\\frac{1}{\\sqrt{2}}\\right) + 1 \\right] \\\\ = \\exp\\left(-\\frac{1}{\\sqrt{2}}\\right) - \\left[ \\frac{1}{2}(\\cosh(1)-1) - \\frac{1}{\\sqrt{2}}\\sinh(1) + 1 \\right] \\\\ = \\exp\\left(-\\frac{1}{\\sqrt{2}}\\right) - \\frac{1}{2}\\cosh(1) + \\frac{1}{2} + \\frac{1}{\\sqrt{2}}\\sinh(1) - 1 \\\\ = \\exp\\left(-\\frac{1}{\\sqrt{2}}\\right) - \\frac{1}{2}\\cosh(1) + \\frac{1}{\\sqrt{2}}\\sinh(1) - \\frac{1}{2} \\end{align*}\n\n**Task 4: Determine the largest absolute hierarchical surplus magnitude**\nWe compare the absolute values of the surpluses computed at the new nodes of each level.\n- Level 1 surplus: $|s_1(0)| = |1| = 1$.\n- Level 2 surpluses:\n  - $|s_2(-1)| = |\\exp(-1) - 1| = 1 - \\exp(-1)$. Since $\\exp(-1) \\approx 0.368$, this is approximately $0.632$.\n  - $|s_2(1)| = |\\exp(1) - 1| = \\exp(1) - 1$. Since $\\exp(1) \\approx 2.718$, this is approximately $1.718$.\n- Level 3 surpluses: The expressions for $s_3$ represent the interpolation error of a quadratic polynomial. For an analytic function like $\\exp(y)$, this error decreases rapidly as the degree of the interpolant increases. The magnitudes of $s_3(\\pm 1/\\sqrt{2})$ are significantly smaller than the magnitudes of the level-2 surpluses. For instance, the interpolation error for $I_2[f](y)$ is given by $\\frac{f'''(\\xi)}{3!}y(y^2-1) = \\frac{\\exp(\\xi)}{6}y(y^2-1)$. At $y=1/\\sqrt{2}$, this error is $-\\frac{\\exp(\\xi)}{12\\sqrt{2}}$ for some $\\xi \\in (-1, 1/\\sqrt{2})$, which is a small quantity.\nComparing the calculated values:\n$$ |s_2(1)| = \\exp(1) - 1 \\approx 1.718 $$\n$$ |s_1(0)| = 1 $$\n$$ |s_2(-1)| = 1 - \\exp(-1) \\approx 0.632 $$\nThe values of $|s_3(\\pm 1/\\sqrt{2})|$ are smaller still. The largest absolute magnitude among all computed surpluses is clearly $|s_2(1)| = \\exp(1) - 1$.\n\nIn adaptive sparse-grid collocation methods, the magnitude of the hierarchical surpluses serves as a crucial error indicator. At each stage of the grid construction, surpluses are computed at newly added points. A large surplus magnitude indicates a region (or, in higher dimensions, a direction) where the current polynomial approximation is poor. Adaptive algorithms exploit this information by preferentially adding new grid points (and corresponding basis functions) in the dimensions that exhibit the largest surpluses. This strategy ensures that computational effort is concentrated where it is most needed to reduce the overall approximation error, leading to a much more efficient convergence than non-adaptive approaches.",
            "answer": "$$\\boxed{\\exp(1) - 1}$$"
        }
    ]
}