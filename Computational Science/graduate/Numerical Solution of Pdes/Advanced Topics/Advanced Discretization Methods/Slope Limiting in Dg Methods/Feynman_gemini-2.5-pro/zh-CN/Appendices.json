{
    "hands_on_practices": [
        {
            "introduction": "为了在不连续伽辽金 (DG) 方法中抑制伪振荡，斜率限制器是必不可少的工具。本练习将从最基本的情景入手：标量守恒律的线性元 (DG-$p^1$) 近似。通过一个具体的计算 ，您将亲手应用经典的 minmod 限制器，并观察它如何在一个局部极值点处自动将解的斜率调整为零，从而保证数值解的单调性。",
            "id": "3443823",
            "problem": "考虑一维标量守恒律 $u_{t} + f(u)_{x} = 0$，该方程在一个由单元 $\\{I_{i}\\}$ 组成的均匀网格上进行离散，网格间距为 $h>0$，单元中心为 $x_{i}$。在分片线性间断伽辽金(DG)近似中，单元 $I_{i}$ 内的局部多项式表示为 $p_{i}(x) = \\bar{u}_{i} + s_{i}(x - x_{i})$，其中 $\\bar{u}_{i}$ 表示单元平均值，$s_{i}$ 是从模态系数估计出的斜率。为了在单调数值通量和前向欧拉时间更新下抑制伪振荡同时保持离散极值原理，我们强制要求重构的界面值 $p_{i}(x_{i\\pm\\frac{1}{2}}) = \\bar{u}_{i} \\pm \\frac{h}{2}s_{i}$ 位于相邻单元平均值之间。这意味着容许的斜率必须与单侧离散梯度的符号一致，并且其大小不得超过它们的量值。\n\n从上述单调性约束和总变差递减(TVD)特性的要求出发，用单侧差分 $(\\bar{u}_{i} - \\bar{u}_{i-1})/h$ 和 $(\\bar{u}_{i+1} - \\bar{u}_{i})/h$ 推导斜率 $s_{i}$ 的限制规则，然后应用此规则计算在以下特定配置中的限制后斜率 $s_{i}^{\\ell}$：\n- 相邻单元的平均值为 $\\bar{u}_{i-1} = 1$，$\\bar{u}_{i} = 0.2$ 和 $\\bar{u}_{i+1} = 0.3$。\n- 局部的未限制斜率估计值为 $s_{i} = 0.9$。\n\n假设 $h>0$，并且限制器是使用应用于集合 $\\{s_{i}, (\\bar{u}_{i} - \\bar{u}_{i-1})/h, (\\bar{u}_{i+1} - \\bar{u}_{i})/h\\}$ 的经典minmod机制构建的。请提供 $s_{i}^{\\ell}$ 的最终值，该值应为精确数，无需四舍五入，并且不包含任何物理单位。",
            "solution": "该问题要求为分片线性间断伽辽金(DG)方法推导一个斜率限制规则，并将其应用于一个具体案例。第一步是验证问题陈述。\n\n**问题验证**\n\n步骤1：提取已知条件\n-   一维标量守恒律为 $u_{t} + f(u)_{x} = 0$。\n-   计算网格由均匀单元 $\\{I_{i}\\}$ 组成，间距为 $h > 0$，中心为 $x_{i}$。\n-   单元 $I_{i}$ 中的局部DG近似是一个线性多项式 $p_{i}(x) = \\bar{u}_{i} + s_{i}(x - x_{i})$，其中 $\\bar{u}_{i}$ 是单元平均值，$s_{i}$ 是斜率。\n-   施加了一个单调性约束：重构的界面值 $p_{i}(x_{i\\pm\\frac{1}{2}}) = \\bar{u}_{i} \\pm \\frac{h}{2}s_{i}$ 必须位于相邻单元平均值之间。\n-   该约束意味着容许的斜率必须与单侧离散梯度 $(\\bar{u}_{i} - \\bar{u}_{i-1})/h$ 和 $(\\bar{u}_{i+1} - \\bar{u}_{i})/h$ 的符号一致，并且其大小不得超过它们的量值。\n-   用于计算的具体数值为：$\\bar{u}_{i-1} = 1$，$\\bar{u}_{i} = 0.2$，$\\bar{u}_{i+1} = 0.3$。\n-   局部的未限制斜率估计值为 $s_{i} = 0.9$。\n-   要使用的限制器是应用于集合 $\\{s_{i}, (\\bar{u}_{i} - \\bar{u}_{i-1})/h, (\\bar{u}_{i+1} - \\bar{u}_{i})/h\\}$ 的经典minmod机制。\n\n步骤2：使用提取的已知条件进行验证\n该问题具有科学依据，因为它涉及DG方法的标准斜率限制技术（特别是TVD类型限制器），这是偏微分方程数值分析领域一个成熟的研究方向。这个问题是适定的，提供了所有必要的数据和一个明确的目标。术语精确客观。没有矛盾、缺失数据或不科学的前提。该问题是计算流体动力学和数值方法领域的标准练习题。\n\n步骤3：结论与行动\n该问题被认为是有效的。将提供完整的解答。\n\n**限制规则的推导**\n\n在此背景下，斜率限制器的目标是强制执行单调性原理，防止在数值解中产生新的局部极值，这对于获得双曲守恒律的具有物理意义的非振荡解至关重要。问题陈述为限制后的斜率提供了核心约束，我们将对其进行形式化。\n\n令 $s_i^\\ell$ 表示限制后的斜率。单侧离散梯度（或有限差分斜率）定义如下：\n-   后向差分斜率：$\\Delta_i^- = \\frac{\\bar{u}_{i} - \\bar{u}_{i-1}}{h}$\n-   前向差分斜率：$\\Delta_i^+ = \\frac{\\bar{u}_{i+1} - \\bar{u}_{i}}{h}$\n\n对 $s_i^\\ell$ 的约束如下：\n1.  **符号一致性**：斜率 $s_i^\\ell$ 必须与 $\\Delta_i^-$ 和 $\\Delta_i^+$ 两者具有相同的符号。这仅在 $\\Delta_i^-$ 和 $\\Delta_i^+$ 符号相同时才可能。如果它们的符号不同（这发生在局部极值点，即峰值或谷值），则不存在非零斜率能与两者都保持符号一致。在这种情况下，为防止上冲或下冲，重构必须设为常数，意味着斜率必须为零。因此，如果 $\\text{sign}(\\Delta_i^-) \\neq \\text{sign}(\\Delta_i^+)$，则 $s_i^\\ell = 0$。\n2.  **大小约束**：斜率的绝对值不得超过单侧离散梯度的绝对值。这等价于 $|s_i^\\ell| \\le |\\Delta_i^-|$ 和 $|s_i^\\ell| \\le |\\Delta_i^+|$。合并这两个条件，我们得到 $|s_i^\\ell| \\le \\min(|\\Delta_i^-|, |\\Delta_i^+|)$。\n\n这些条件可以被minmod函数精确地概括，对于一组参数 $\\{a_1, a_2, \\dots, a_n\\}$，其定义如下：\n$$\n\\text{minmod}(a_1, a_2, \\dots, a_n) =\n\\begin{cases}\n\\min(a_1, \\dots, a_n)  \\text{if } a_j > 0 \\text{ for all } j \\\\\n\\max(a_1, \\dots, a_n)  \\text{if } a_j  0 \\text{ for all } j \\\\\n0  \\text{otherwise}\n\\end{cases}\n$$\n将此应用于两个离散梯度，满足从相邻单元导出的单调性界限的最大斜率为 $s'_{i} = \\text{minmod}(\\Delta_i^-, \\Delta_i^+)$。\n\n最后一步是限制原始的、未约束的斜率 $s_{i}$。限制的原则是尽可能少地修改原始斜率。限制后的斜率 $s_i^\\ell$ 必须满足上述推导的单调性条件，同时其大小也不能超过原始斜率，即 $|s_i^\\ell| \\le |s_i|$。这可以通过将原始斜率 $s_i$ 作为minmod函数的一个参数来实现。得到的限制后斜率为：\n$$ s_i^\\ell = \\text{minmod}(s_i, s'_{i}) = \\text{minmod}\\left(s_i, \\text{minmod}(\\Delta_i^-, \\Delta_i^+)\\right) $$\n根据minmod函数的性质，这等价于：\n$$ s_i^\\ell = \\text{minmod}(s_i, \\Delta_i^-, \\Delta_i^+) = \\text{minmod}\\left(s_i, \\frac{\\bar{u}_i - \\bar{u}_{i-1}}{h}, \\frac{\\bar{u}_{i+1} - \\bar{u}_i}{h}\\right) $$\n这证实了问题陈述中指定的规则的有效性。\n\n**应用于特定配置**\n\n我们被要求根据给定数据计算限制后的斜率 $s_i^\\ell$。minmod函数的参数是：\n1.  未限制的斜率: $s_i = 0.9$。\n2.  后向差分斜率: $\\Delta_i^- = \\frac{\\bar{u}_i - \\bar{u}_{i-1}}{h} = \\frac{0.2 - 1}{h} = -\\frac{0.8}{h}$。\n3.  前向差分斜率: $\\Delta_i^+ = \\frac{\\bar{u}_{i+1} - \\bar{u}_i}{h} = \\frac{0.3 - 0.2}{h} = \\frac{0.1}{h}$。\n\nminmod函数的三个参数是 $\\{0.9, -0.8/h, 0.1/h\\}$。我们必须确定它们的符号。因为给定 $h0$：\n-   $s_i = 0.9$ 是正数。\n-   $\\Delta_i^- = -0.8/h$ 是负数。\n-   $\\Delta_i^+ = 0.1/h$ 是正数。\n\n参数集合 $\\{0.9, -0.8/h, 0.1/h\\}$ 同时包含正值和负值。根据minmod函数的定义，如果参数不全是相同符号，则结果为零。这种情况对应于单元 $I_i$ 是一个局部极小值（$\\bar{u}_i$ 小于 $\\bar{u}_{i-1}$ 和 $\\bar{u}_{i+1}$），限制器正确地将重构平坦化为一个常数值（$\\bar{u}_{i}$），以防止产生新的、非物理的极小值（下冲）。\n\n因此，限制后的斜率为：\n$$ s_i^\\ell = \\text{minmod}\\left(0.9, -\\frac{0.8}{h}, \\frac{0.1}{h}\\right) = 0 $$\n最终值与网格间距 $h$ 无关。",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "当 DG 方法的阶数提高时（例如 DG-$p^2$），简单地限制一个“斜率”已不足以控制解的行为。子单元限制 (subcell limiting) 提供了一种直观且强大的方法：它将高次多项式分解到更精细的子网格上，在子网格上应用标准限制器，然后将限制后的分段线性解投影回原始的多项式空间。本练习  将引导您完整地走过这个算法流程，从计算子单元平均值到最终的 $L^2$ 投影，从而揭示高阶 DG 程序中限制器的实现机理。",
            "id": "3443832",
            "problem": "考虑一个一维标量守恒律 $u_{t} + f(u)_{x} = 0$，该守恒律在均匀网格上通过一个次数为 $2$ 的多项式的间断伽辽金 (DG) 方法进行离散。关注一个通过仿射映射到参考单元 $\\xi \\in [-1,1]$ 的单个单元。在给定时间，此单元上的局部 DG 表示在 Legendre 基 $\\{P_{0}(\\xi), P_{1}(\\xi), P_{2}(\\xi)\\}$ 中由下式给出：\n$$\nu_{h}(\\xi) \\;=\\; \\bar{u} \\, P_{0}(\\xi) \\;+\\; \\alpha_{1}\\, P_{1}(\\xi) \\;+\\; \\alpha_{2}\\, P_{2}(\\xi),\n$$\n其中 $P_{0}(\\xi) = 1$, $P_{1}(\\xi) = \\xi$, 且 $P_{2}(\\xi) = \\frac{3\\xi^{2} - 1}{2}$。取特定多项式数据 $\\bar{u} = 0$, $\\alpha_{1} = 1$, $\\alpha_{2} = 1$，使得\n$$\nu_{h}(\\xi) \\;=\\; \\xi \\;+\\; \\frac{3\\xi^{2}-1}{2}.\n$$\n要在此单元内执行一个基于子单元的斜率限制程序，请按以下步骤进行。\n\n1. 将参考单元细分为四个相等的子单元 $J_{1} = [-1,-\\frac{1}{2}]$, $J_{2} = [-\\frac{1}{2},0]$, $J_{3} = [0,\\frac{1}{2}]$, 和 $J_{4} = [\\frac{1}{2},1]$。对每个子单元 $J_{k}$，计算子单元平均值\n$$\nA_{k} \\;=\\; \\frac{1}{|J_{k}|} \\int_{J_{k}} u_{h}(\\xi)\\, d\\xi, \\quad \\text{其中} \\quad |J_{k}| = \\frac{1}{2}.\n$$\n\n2. 对任意有限集合 $\\{a_{j}\\}$ 定义 minmod 函数如下：\n$$\n\\operatorname{minmod}(a_{1},\\dots,a_{m}) \\;=\\;\n\\begin{cases}\n\\operatorname{sign}(a_{1}) \\,\\min\\{|a_{1}|,\\dots,|a_{m}|\\}  \\text{如果 } \\operatorname{sign}(a_{1})=\\cdots=\\operatorname{sign}(a_{m}) \\\\\n0  \\text{其他情况}\n\\end{cases}\n$$\n设子单元中心为 $c_{1}=-\\frac{3}{4}$, $c_{2}=-\\frac{1}{4}$, $c_{3}=\\frac{1}{4}$, $c_{4}=\\frac{3}{4}$，子单元宽度为 $\\Delta=\\frac{1}{2}$。对每个子单元 $J_{k}$，计算原始斜率 $s_{k}^{\\mathrm{raw}} = u_{h}'(c_{k})$。然后使用子单元平均值计算离散差分：\n$$\nd_{k}^{-} \\;=\\; \\frac{A_{k}-A_{k-1}}{\\Delta}, \\;\\; k=2,3,4, \n\\qquad\nd_{k}^{+} \\;=\\; \\frac{A_{k+1} - A_{k}}{\\Delta}, \\;\\; k=1,2,3.\n$$\n定义限制后的斜率如下：\n$$\ns_{1} \\;=\\; \\operatorname{minmod}\\!\\big(s_{1}^{\\mathrm{raw}}, d_{1}^{+}\\big),\\quad\ns_{k} \\;=\\; \\operatorname{minmod}\\!\\big(s_{k}^{\\mathrm{raw}}, d_{k}^{-}, d_{k}^{+}\\big)\\; \\text{对 } k=2,3,\\quad\ns_{4} \\;=\\; \\operatorname{minmod}\\!\\big(s_{4}^{\\mathrm{raw}}, d_{4}^{-}\\big).\n$$\n\n3. 通过在每个 $J_{k}$ 上规定线性剖面来构造一个分段线性子单元代理 $\\tilde{u}(\\xi)$\n$$\n\\tilde{u}(\\xi)\\big|_{J_{k}} \\;=\\; A_{k} \\;+\\; s_{k}\\,(\\xi - c_{k}),\n$$\n使得 $J_{k}$ 上的子单元平均值为 $A_{k}$。\n\n4. 将次数最多为 $2$ 的限制后的 DG 多项式 $\\hat{u}(\\xi)$ 重构为 $\\tilde{u}$ 在 $\\operatorname{span}\\{P_{0},P_{1},P_{2}\\}$ 上的 $L^{2}$-投影，即\n$$\n\\hat{u}(\\xi) \\;=\\; \\hat{\\alpha}_{0} P_{0}(\\xi) \\;+\\; \\hat{\\alpha}_{1} P_{1}(\\xi) \\;+\\; \\hat{\\alpha}_{2} P_{2}(\\xi),\n$$\n其系数由下式确定\n$$\n\\hat{\\alpha}_{n} \\;=\\; \\frac{\\int_{-1}^{1} \\tilde{u}(\\xi)\\,P_{n}(\\xi)\\, d\\xi}{\\int_{-1}^{1} P_{n}(\\xi)^{2} \\, d\\xi},\n\\quad n=0,1,2,\n$$\n以及 Legendre 正交积分 $\\int_{-1}^{1} P_{n}(\\xi)^{2}\\, d\\xi = \\frac{2}{2n+1}$。\n\n以符号方式精确执行所有步骤。将最终限制后的 DG 多项式 $\\hat{u}(\\xi)$ 表示为关于 $\\xi$ 的单一显式多项式。不要四舍五入；给出精确的有理系数。",
            "solution": "该问题被验证为科学上可靠、适定、客观和完整的。它描述了一个用于间断伽辽金 (DG) 方法的标准子单元斜率限制程序。任务是为一个特定的多项式执行此程序。我们将遵循问题陈述中概述的四个步骤。\n\n初始的 DG 多项式在参考单元 $\\xi \\in [-1,1]$ 上为\n$$\nu_{h}(\\xi) = \\xi + \\frac{3\\xi^{2}-1}{2} = \\frac{3}{2}\\xi^2 + \\xi - \\frac{1}{2}.\n$$\n\n**步骤1：计算子单元平均值**\n\n我们将参考单元 $[-1,1]$ 细分为四个子单元 $J_{1} = [-1,-1/2]$, $J_{2} = [-1/2,0]$, $J_{3} = [0,1/2]$, 和 $J_{4} = [1/2,1]$，每个子单元的宽度为 $|J_{k}| = 1/2$。子单元平均值为 $A_k = \\frac{1}{|J_k|} \\int_{J_k} u_h(\\xi) d\\xi = 2 \\int_{J_k} u_h(\\xi) d\\xi$。\n首先，我们求 $u_h(\\xi)$ 的反导数：\n$$\nF(\\xi) = \\int \\left(\\frac{3}{2}\\xi^2 + \\xi - \\frac{1}{2}\\right) d\\xi = \\frac{1}{2}\\xi^3 + \\frac{1}{2}\\xi^2 - \\frac{1}{2}\\xi.\n$$\n现在，我们计算平均值：\n$$\nA_1 = 2 \\int_{-1}^{-1/2} u_h(\\xi) d\\xi = 2 [F(\\xi)]_{-1}^{-1/2} = 2(F(-1/2) - F(-1)).\n$$\n$F(-1/2) = \\frac{1}{2}(-\\frac{1}{8}) + \\frac{1}{2}(\\frac{1}{4}) - \\frac{1}{2}(-\\frac{1}{2}) = -\\frac{1}{16} + \\frac{1}{8} + \\frac{1}{4} = \\frac{-1+2+4}{16} = \\frac{5}{16}$。\n$F(-1) = \\frac{1}{2}(-1) + \\frac{1}{2}(1) - \\frac{1}{2}(-1) = -\\frac{1}{2} + \\frac{1}{2} + \\frac{1}{2} = \\frac{1}{2}$。\n因此，$A_1 = 2(\\frac{5}{16} - \\frac{1}{2}) = 2(\\frac{5-8}{16}) = 2(-\\frac{3}{16}) = -\\frac{3}{8}$。\n\n$$\nA_2 = 2 \\int_{-1/2}^{0} u_h(\\xi) d\\xi = 2(F(0) - F(-1/2)) = 2(0 - \\frac{5}{16}) = -\\frac{5}{8}.\n$$\n\n$$\nA_3 = 2 \\int_{0}^{1/2} u_h(\\xi) d\\xi = 2(F(1/2) - F(0)).\n$$\n$F(1/2) = \\frac{1}{2}(\\frac{1}{8}) + \\frac{1}{2}(\\frac{1}{4}) - \\frac{1}{2}(\\frac{1}{2}) = \\frac{1}{16} + \\frac{1}{8} - \\frac{1}{4} = \\frac{1+2-4}{16} = -\\frac{1}{16}$。\n因此，$A_3 = 2(-\\frac{1}{16} - 0) = -\\frac{1}{8}$。\n\n$$\nA_4 = 2 \\int_{1/2}^{1} u_h(\\xi) d\\xi = 2(F(1) - F(1/2)).\n$$\n$F(1) = \\frac{1}{2}(1) + \\frac{1}{2}(1) - \\frac{1}{2}(1) = \\frac{1}{2}$。\n因此，$A_4 = 2(\\frac{1}{2} - (-\\frac{1}{16})) = 2(\\frac{8+1}{16}) = 2(\\frac{9}{16}) = \\frac{9}{8}$。\n\n子单元平均值为：$A_1 = -3/8$, $A_2 = -5/8$, $A_3 = -1/8$, $A_4 = 9/8$。\n\n**步骤2：计算限制后的斜率**\n\n首先，我们计算原始斜率 $s_k^{\\mathrm{raw}} = u_h'(c_k)$。导数为 $u_h'(\\xi) = 3\\xi + 1$。子单元中心为 $c_1=-3/4$, $c_2=-1/4$, $c_3=1/4$, $c_4=3/4$。\n$s_1^{\\mathrm{raw}} = 3(-\\frac{3}{4}) + 1 = -\\frac{9}{4} + 1 = -\\frac{5}{4}$。\n$s_2^{\\mathrm{raw}} = 3(-\\frac{1}{4}) + 1 = -\\frac{3}{4} + 1 = \\frac{1}{4}$。\n$s_3^{\\mathrm{raw}} = 3(\\frac{1}{4}) + 1 = \\frac{3}{4} + 1 = \\frac{7}{4}$。\n$s_4^{\\mathrm{raw}} = 3(\\frac{3}{4}) + 1 = \\frac{9}{4} + 1 = \\frac{13}{4}$。\n\n接下来，我们用子单元宽度 $\\Delta = 1/2$ 计算离散差分。\n$d_1^{+} = \\frac{A_2 - A_1}{\\Delta} = \\frac{-5/8 - (-3/8)}{1/2} = \\frac{-2/8}{1/2} = -\\frac{1}{4} \\times 2 = -\\frac{1}{2}$。\n$d_2^{-} = d_1^{+} = -1/2$。\n$d_2^{+} = \\frac{A_3 - A_2}{\\Delta} = \\frac{-1/8 - (-5/8)}{1/2} = \\frac{4/8}{1/2} = \\frac{1}{2} \\times 2 = 1$。\n$d_3^{-} = d_2^{+} = 1$。\n$d_3^{+} = \\frac{A_4 - A_3}{\\Delta} = \\frac{9/8 - (-1/8)}{1/2} = \\frac{10/8}{1/2} = \\frac{5}{4} \\times 2 = \\frac{5}{2}$。\n$d_4^{-} = d_3^{+} = 5/2$。\n\n最后，我们应用 minmod 函数来找到限制后的斜率 $s_k$。\n$s_1 = \\operatorname{minmod}(s_1^{\\mathrm{raw}}, d_1^{+}) = \\operatorname{minmod}(-\\frac{5}{4}, -\\frac{1}{2})$。符号相同，所以 $s_1 = \\operatorname{sign}(-\\frac{5}{4}) \\min(|\\!-\\frac{5}{4}|, |\\!-\\frac{1}{2}|) = -\\min(\\frac{5}{4}, \\frac{1}{2}) = -\\frac{1}{2}$。\n$s_2 = \\operatorname{minmod}(s_2^{\\mathrm{raw}}, d_2^{-}, d_2^{+}) = \\operatorname{minmod}(\\frac{1}{4}, -\\frac{1}{2}, 1)$。符号不同，所以 $s_2 = 0$。\n$s_3 = \\operatorname{minmod}(s_3^{\\mathrm{raw}}, d_3^{-}, d_3^{+}) = \\operatorname{minmod}(\\frac{7}{4}, 1, \\frac{5}{2})$。符号相同，所以 $s_3 = \\min(\\frac{7}{4}, 1, \\frac{5}{2}) = 1$。\n$s_4 = \\operatorname{minmod}(s_4^{\\mathrm{raw}}, d_4^{-}) = \\operatorname{minmod}(\\frac{13}{4}, \\frac{5}{2})$。符号相同，所以 $s_4 = \\min(\\frac{13}{4}, \\frac{5}{2}) = \\min(3.25, 2.5) = \\frac{5}{2}$。\n限制后的斜率为：$s_1 = -1/2$, $s_2 = 0$, $s_3 = 1$, $s_4 = 5/2$。\n\n**步骤3：构造分段线性代理 $\\tilde{u}(\\xi)$**\n\n在每个子单元 $J_k$上，代理为 $\\tilde{u}(\\xi)|_{J_k} = A_k + s_k(\\xi - c_k)$。\n$J_1: \\tilde{u}(\\xi) = -\\frac{3}{8} + (-\\frac{1}{2})(\\xi - (-\\frac{3}{4})) = -\\frac{3}{8} - \\frac{1}{2}\\xi - \\frac{3}{8} = -\\frac{1}{2}\\xi - \\frac{3}{4}$。\n$J_2: \\tilde{u}(\\xi) = -\\frac{5}{8} + 0(\\xi - (-\\frac{1}{4})) = -\\frac{5}{8}$。\n$J_3: \\tilde{u}(\\xi) = -\\frac{1}{8} + 1(\\xi - \\frac{1}{4}) = \\xi - \\frac{1}{8} - \\frac{1}{4} = \\xi - \\frac{3}{8}$。\n$J_4: \\tilde{u}(\\xi) = \\frac{9}{8} + \\frac{5}{2}(\\xi - \\frac{3}{4}) = \\frac{9}{8} + \\frac{5}{2}\\xi - \\frac{15}{8} = \\frac{5}{2}\\xi - \\frac{3}{4}$。\n\n**步骤4：重构限制后的 DG 多项式 $\\hat{u}(\\xi)$**\n\n我们将 $\\tilde{u}(\\xi)$ 投影到 Legendre 基 $\\{P_0, P_1, P_2\\}$ 上。系数为 $\\hat{\\alpha}_n = \\frac{2n+1}{2} \\int_{-1}^{1} \\tilde{u}(\\xi) P_n(\\xi) d\\xi$。\n\n对于 $\\hat{\\alpha}_0$：\n$\\hat{\\alpha}_0 = \\frac{1}{2} \\int_{-1}^{1} \\tilde{u}(\\xi) d\\xi$。$\\tilde{u}$ 的积分是平均值乘以子单元体积的总和：$\\int_{-1}^1 \\tilde{u} d\\xi = \\sum_{k=1}^4 |J_k| A_k = \\frac{1}{2} \\sum A_k = \\frac{1}{2}(-\\frac{3}{8} - \\frac{5}{8} - \\frac{1}{8} + \\frac{9}{8}) = 0$。所以，$\\hat{\\alpha}_0=0$。\n\n对于 $\\hat{\\alpha}_1$：\n$\\hat{\\alpha}_1 = \\frac{3}{2} \\int_{-1}^{1} \\tilde{u}(\\xi) P_1(\\xi) d\\xi = \\frac{3}{2} \\int_{-1}^{1} \\tilde{u}(\\xi) \\xi d\\xi$。\n积分为 $\\int_{-1}^{-1/2} (-\\frac{1}{2}\\xi^2 - \\frac{3}{4}\\xi) d\\xi + \\int_{-1/2}^{0} (-\\frac{5}{8}\\xi) d\\xi + \\int_{0}^{1/2} (\\xi^2 - \\frac{3}{8}\\xi) d\\xi + \\int_{1/2}^{1} (\\frac{5}{2}\\xi^2 - \\frac{3}{4}\\xi) d\\xi$。\n它们分别计算为 $\\frac{13}{96}$, $\\frac{5}{64}$, $-\\frac{1}{192}$, 和 $\\frac{43}{96}$。\n将它们相加：$\\frac{13}{96} + \\frac{5}{64} - \\frac{1}{192} + \\frac{43}{96} = \\frac{26+15-1+86}{192} = \\frac{126}{192} = \\frac{21}{32}$。\n所以，$\\hat{\\alpha}_1 = \\frac{3}{2} \\times \\frac{21}{32} = \\frac{63}{64}$。\n\n对于 $\\hat{\\alpha}_2$：\n$\\hat{\\alpha}_2 = \\frac{5}{2} \\int_{-1}^{1} \\tilde{u}(\\xi) P_2(\\xi) d\\xi = \\frac{5}{2} \\int_{-1}^{1} \\tilde{u}(\\xi) \\frac{3\\xi^2-1}{2} d\\xi = \\frac{5}{4} \\left( 3\\int_{-1}^{1} \\tilde{u}(\\xi)\\xi^2 d\\xi - \\int_{-1}^{1} \\tilde{u}(\\xi)d\\xi \\right)$。\n由于 $\\int \\tilde{u} d\\xi=0$，我们只需要 $\\int_{-1}^{1} \\tilde{u}(\\xi)\\xi^2 d\\xi$。\n积分为 $\\int_{-1}^{-1/2} (-\\frac{1}{2}\\xi^3 - \\frac{3}{4}\\xi^2) d\\xi + \\int_{-1/2}^{0} (-\\frac{5}{8}\\xi^2) d\\xi + \\int_{0}^{1/2} (\\xi^3 - \\frac{3}{8}\\xi^2) d\\xi + \\int_{1/2}^{1} (\\frac{5}{2}\\xi^3 - \\frac{3}{4}\\xi^2) d\\xi$。\n它们分别计算为 $-\\frac{13}{128}$, $-\\frac{5}{192}$, $0$, 和 $\\frac{47}{128}$。\n将它们相加：$-\\frac{13}{128} - \\frac{5}{192} + 0 + \\frac{47}{128} = \\frac{34}{128} - \\frac{5}{192} = \\frac{17}{64} - \\frac{5}{192} = \\frac{51-5}{192} = \\frac{46}{192} = \\frac{23}{96}$。\n计算 $\\hat{\\alpha}_2$ 所需的积分为 $\\int_{-1}^1 \\tilde{u} P_2 d\\xi = \\frac{3}{2}(\\frac{23}{96}) - \\frac{1}{2}(0) = \\frac{23}{64}$。\n所以，$\\hat{\\alpha}_2 = \\frac{5}{2} \\times \\frac{23}{64} = \\frac{115}{128}$。\n\n限制后的多项式为 $\\hat{u}(\\xi) = \\hat{\\alpha}_0 P_0(\\xi) + \\hat{\\alpha}_1 P_1(\\xi) + \\hat{\\alpha}_2 P_2(\\xi)$：\n$$\n\\hat{u}(\\xi) = 0 \\cdot (1) + \\frac{63}{64} \\xi + \\frac{115}{128} \\left(\\frac{3\\xi^2-1}{2}\\right)\n$$\n$$\n\\hat{u}(\\xi) = \\frac{63}{64}\\xi + \\frac{345}{256}\\xi^2 - \\frac{115}{256}\n$$\n整理成标准多项式形式：\n$$\n\\hat{u}(\\xi) = \\frac{345}{256}\\xi^2 + \\frac{63}{64}\\xi - \\frac{115}{256}\n$$",
            "answer": "$$\n\\boxed{\\frac{345}{256}\\xi^2 + \\frac{63}{64}\\xi - \\frac{115}{256}}\n$$"
        },
        {
            "introduction": "对于守恒律方程组，例如气体动力学的欧拉方程，问题的复杂性进一步增加。解的各个分量（如密度、动量和能量）在物理上是耦合的，直接对每个分量独立地应用标量限制器（分量限制）可能会导致非物理状态（例如负压）。更合理的方法是在与物理波动（如声波）相对应的特征变量空间中进行限制，即特征限制。本练习  将直接比较这两种限制方式，并要求您计算最终的物理压力，这突显了选择物理上恰当的限制策略对于保证数值解的可容许性 (admissibility) 至关重要。",
            "id": "3443857",
            "problem": "考虑在间断伽辽金（DG）有限元背景下，针对比热比 $\\gamma = 1.4$ 的理想气体的一维可压缩欧拉方程。在均匀网格上的三个连续单元 $i-1$、$i$ 和 $i+1$ 中，给定单元平均守恒态如下：\n$$\n\\boldsymbol{U}_{i-1} = \\begin{pmatrix} 1.0 \\\\ 0.0 \\\\ 2.5 \\end{pmatrix},\\quad\n\\boldsymbol{U}_{i} = \\begin{pmatrix} 0.9 \\\\ 0.18 \\\\ 2.018 \\end{pmatrix},\\quad\n\\boldsymbol{U}_{i+1} = \\begin{pmatrix} 0.5 \\\\ 0.2 \\\\ 1.29 \\end{pmatrix},\n$$\n其中 $\\boldsymbol{U} = (\\rho, \\rho u, E)^{\\mathsf{T}}$ 汇集了密度 $\\rho$、动量 $\\rho u$ 和总能量 $E$。所有量均为无量纲。\n\n在每个单元中使用分段线性重构，并基于总变差递减（TVD）的 minmod 函数进行对称斜率限制，定义未除差分\n$$\n\\Delta^{-}\\boldsymbol{U}_{i} = \\boldsymbol{U}_{i} - \\boldsymbol{U}_{i-1},\\qquad\n\\Delta^{+}\\boldsymbol{U}_{i} = \\boldsymbol{U}_{i+1} - \\boldsymbol{U}_{i}.\n$$\n设 minmod 函数为\n$$\n\\operatorname{mm}(a,b) = \\begin{cases}\n\\operatorname{sign}(a)\\,\\min(|a|,|b|)  \\text{if } ab > 0 \\\\\n0  \\text{otherwise}\n\\end{cases}\n$$\n\n在交界面 $x_{i+1/2}$ 处对左状态执行以下两种重构：\n\n1) 守恒变量的分量限制：构造受限斜率\n$$\n\\boldsymbol{S}^{\\mathrm{comp}}_{i} = \\begin{pmatrix}\n\\operatorname{mm}(\\Delta^{-}\\rho_{i},\\Delta^{+}\\rho_{i}) \\\\\n\\operatorname{mm}(\\Delta^{-}(\\rho u)_{i},\\Delta^{+}(\\rho u)_{i}) \\\\\n\\operatorname{mm}(\\Delta^{-}E_{i},\\Delta^{+}E_{i})\n\\end{pmatrix},\n$$\n并设置重构的左状态\n$$\n\\boldsymbol{U}^{-,\\mathrm{comp}}_{i+1/2} = \\boldsymbol{U}_{i} + \\tfrac{1}{2}\\,\\boldsymbol{S}^{\\mathrm{comp}}_{i}.\n$$\n\n2) 特征限制：对一维欧拉通量雅可比矩阵（在守恒变量中），使用标准的右特征向量矩阵 $\\boldsymbol{R}(\\boldsymbol{U}_{i})$ 及其逆矩阵 $\\boldsymbol{L}(\\boldsymbol{U}_{i}) = \\boldsymbol{R}(\\boldsymbol{U}_{i})^{-1}$，在单元 $i$ 处形成基于雅可比矩阵的特征分解。将未除差分投影到特征空间\n$$\n\\boldsymbol{w}^{-}_{i} = \\boldsymbol{L}(\\boldsymbol{U}_{i})\\,\\Delta^{-}\\boldsymbol{U}_{i},\\qquad\n\\boldsymbol{w}^{+}_{i} = \\boldsymbol{L}(\\boldsymbol{U}_{i})\\,\\Delta^{+}\\boldsymbol{U}_{i},\n$$\n用 minmod 函数限制每个特征分量以获得 $\\widetilde{\\boldsymbol{w}}_{i}$，通过 $\\widetilde{\\boldsymbol{S}}^{\\mathrm{char}}_{i} = \\boldsymbol{R}(\\boldsymbol{U}_{i})\\,\\widetilde{\\boldsymbol{w}}_{i}$ 映射回守恒变量，并设置\n$$\n\\boldsymbol{U}^{-,\\mathrm{char}}_{i+1/2} = \\boldsymbol{U}_{i} + \\tfrac{1}{2}\\,\\widetilde{\\boldsymbol{S}}^{\\mathrm{char}}_{i}.\n$$\n\n对于每个重构的左状态，计算热力学压力\n$$\np = (\\gamma - 1)\\left(E - \\tfrac{1}{2}\\,\\frac{(\\rho u)^{2}}{\\rho}\\right).\n$$\n\n最后，计算两种压力的比值\n$$\n\\Pi = \\frac{p^{\\mathrm{char}}}{p^{\\mathrm{comp}}}.\n$$\n\n所有计算必须与上述定义自洽。将最终答案表示为一个纯数（无量纲），并四舍五入到五位有效数字。",
            "solution": "用户提供了一个在计算流体力学领域定义明确的问题，具体涉及应用于一维欧拉方程的间断伽辽金法的斜率限制技术。该问题在科学上是合理的，内容完整，并提供了所有必需的数据和定义。因此，该问题被视为**有效**。\n\n求解过程需要在单元交界面处对流体状态执行两种类型的重构，然后比较得到的压力。这两种方法是分量限制和特征限制。\n\n### 已知数据\n- 比热比: $\\gamma = 1.4$\n- 单元平均守恒态:\n  $$ \\boldsymbol{U}_{i-1} = \\begin{pmatrix} 1.0 \\\\ 0.0 \\\\ 2.5 \\end{pmatrix}, \\quad \\boldsymbol{U}_{i} = \\begin{pmatrix} 0.9 \\\\ 0.18 \\\\ 2.018 \\end{pmatrix}, \\quad \\boldsymbol{U}_{i+1} = \\begin{pmatrix} 0.5 \\\\ 0.2 \\\\ 1.29 \\end{pmatrix} $$\n- 状态向量: $\\boldsymbol{U} = (\\rho, \\rho u, E)^{\\mathsf{T}}$\n- 压力计算: $p = (\\gamma - 1)\\left(E - \\frac{1}{2}\\,\\frac{(\\rho u)^{2}}{\\rho}\\right)$\n\n### 第 1 部分：分量限制\n\n首先，我们计算相邻单元之间守恒变量的未除差分。\n$$ \\Delta^{-}\\boldsymbol{U}_{i} = \\boldsymbol{U}_{i} - \\boldsymbol{U}_{i-1} = \\begin{pmatrix} 0.9 - 1.0 \\\\ 0.18 - 0.0 \\\\ 2.018 - 2.5 \\end{pmatrix} = \\begin{pmatrix} -0.1 \\\\ 0.18 \\\\ -0.482 \\end{pmatrix} $$\n$$ \\Delta^{+}\\boldsymbol{U}_{i} = \\boldsymbol{U}_{i+1} - \\boldsymbol{U}_{i} = \\begin{pmatrix} 0.5 - 0.9 \\\\ 0.2 - 0.18 \\\\ 1.29 - 2.018 \\end{pmatrix} = \\begin{pmatrix} -0.4 \\\\ 0.02 \\\\ -0.728 \\end{pmatrix} $$\n\n接下来，我们将 `minmod` 函数逐分量地应用于这些差分，以找到受限斜率向量 $\\boldsymbol{S}^{\\mathrm{comp}}_{i}$。\n$$ S^{\\mathrm{comp}}_{1} = \\operatorname{mm}(-0.1, -0.4) = \\operatorname{sign}(-0.1)\\min(|-0.1|, |-0.4|) = -0.1 $$\n$$ S^{\\mathrm{comp}}_{2} = \\operatorname{mm}(0.18, 0.02) = \\operatorname{sign}(0.18)\\min(|0.18|, |0.02|) = 0.02 $$\n$$ S^{\\mathrm{comp}}_{3} = \\operatorname{mm}(-0.482, -0.728) = \\operatorname{sign}(-0.482)\\min(|-0.482|, |-0.728|) = -0.482 $$\n因此，受限斜率为 $\\boldsymbol{S}^{\\mathrm{comp}}_{i} = (-0.1, 0.02, -0.482)^{\\mathsf{T}}$。\n\n在交界面 $x_{i+1/2}$ 处的重构左状态由下式给出：\n$$ \\boldsymbol{U}^{-,\\mathrm{comp}}_{i+1/2} = \\boldsymbol{U}_{i} + \\frac{1}{2}\\boldsymbol{S}^{\\mathrm{comp}}_{i} = \\begin{pmatrix} 0.9 \\\\ 0.18 \\\\ 2.018 \\end{pmatrix} + \\frac{1}{2}\\begin{pmatrix} -0.1 \\\\ 0.02 \\\\ -0.482 \\end{pmatrix} = \\begin{pmatrix} 0.9 - 0.05 \\\\ 0.18 + 0.01 \\\\ 2.018 - 0.241 \\end{pmatrix} = \\begin{pmatrix} 0.85 \\\\ 0.19 \\\\ 1.777 \\end{pmatrix} $$\n将此重构状态表示为 $\\boldsymbol{U}^{\\mathrm{comp}} = (\\rho^{\\mathrm{comp}}, (\\rho u)^{\\mathrm{comp}}, E^{\\mathrm{comp}})^{\\mathsf{T}}$。\n\n最后，我们计算此状态的压力 $p^{\\mathrm{comp}}$：\n$$ p^{\\mathrm{comp}} = (\\gamma - 1)\\left(E^{\\mathrm{comp}} - \\frac{1}{2}\\,\\frac{((\\rho u)^{\\mathrm{comp}})^{2}}{\\rho^{\\mathrm{comp}}}\\right) = (1.4 - 1)\\left(1.777 - \\frac{1}{2}\\,\\frac{(0.19)^{2}}{0.85}\\right) $$\n$$ p^{\\mathrm{comp}} = 0.4\\left(1.777 - \\frac{0.0361}{1.7}\\right) = 0.4(1.777 - 0.02123529...) = 0.4(1.7557647...) = 0.70230588... $$\n\n### 第 2 部分：特征限制\n\n此过程需要将差分投影到欧拉方程的特征场上。用于此投影的矩阵 $\\boldsymbol{R}$ 和 $\\boldsymbol{L}$ 取决于单元 $i$ 中的局部流体状态。\n首先，我们计算状态 $\\boldsymbol{U}_{i}$ 的原始变量：\n$$ \\rho_i = 0.9 $$\n$$ u_i = \\frac{(\\rho u)_i}{\\rho_i} = \\frac{0.18}{0.9} = 0.2 $$\n$$ p_i = (\\gamma-1)\\left(E_i - \\frac{1}{2}\\rho_i u_i^2\\right) = (1.4-1)\\left(2.018 - \\frac{1}{2}(0.9)(0.2)^2\\right) = 0.4(2.018 - 0.018) = 0.4(2.0) = 0.8 $$\n声速 $c_i$ 为：\n$$ c_i = \\sqrt{\\frac{\\gamma p_i}{\\rho_i}} = \\sqrt{\\frac{1.4 \\times 0.8}{0.9}} = \\sqrt{\\frac{1.12}{0.9}} = \\sqrt{\\frac{56}{45}} \\approx 1.11554676 $$\n\n左特征向量矩阵 $\\boldsymbol{L}(\\boldsymbol{U}_{i})$ 用于将未除差分投影到特征空间。使用标准公式，我们得到：\n$$ \\boldsymbol{L}(\\boldsymbol{U}_{i}) \\approx \\begin{pmatrix} 0.092871   -0.480424  0.160714 \\\\ 0.993683  0.064286  -0.321429 \\\\ -0.086455  0.416161  0.160714 \\end{pmatrix} $$\n现在我们投影差分： $\\boldsymbol{w}^{-}_{i} = \\boldsymbol{L}\\Delta^{-}\\boldsymbol{U}_{i}$ 和 $\\boldsymbol{w}^{+}_{i} = \\boldsymbol{L}\\Delta^{+}\\boldsymbol{U}_{i}$。\n$$ \\boldsymbol{w}^{-}_{i} = \\boldsymbol{L} \\begin{pmatrix} -0.1 \\\\ 0.18 \\\\ -0.482 \\end{pmatrix} \\approx \\begin{pmatrix} -0.173227 \\\\ 0.067132 \\\\ 0.006091 \\end{pmatrix} $$\n$$ \\boldsymbol{w}^{+}_{i} = \\boldsymbol{L} \\begin{pmatrix} -0.4 \\\\ 0.02 \\\\ -0.728 \\end{pmatrix} \\approx \\begin{pmatrix} -0.163755 \\\\ -0.162197 \\\\ -0.074094 \\end{pmatrix} $$\n\n接下来，将 `minmod` 函数应用于特征变量向量的每个分量：\n$$ \\widetilde{w}_{1} = \\operatorname{mm}(w^{-}_{1}, w^{+}_{1}) = \\operatorname{mm}(-0.173227, -0.163755) = -0.163755 $$\n$$ \\widetilde{w}_{2} = \\operatorname{mm}(w^{-}_{2}, w^{+}_{2}) = \\operatorname{mm}(0.067132, -0.162197) = 0 $$\n$$ \\widetilde{w}_{3} = \\operatorname{mm}(w^{-}_{3}, w^{+}_{3}) = \\operatorname{mm}(0.006091, -0.074094) = 0 $$\n受限特征向量为 $\\widetilde{\\boldsymbol{w}}_{i} \\approx (-0.163755, 0, 0)^{\\mathsf{T}}$。第二和第三特征场的斜率被设置为零，因为它们对应差分的符号相反，这表明存在一个局部极值。\n\n使用右特征向量矩阵 $\\boldsymbol{R}(\\boldsymbol{U}_{i})$ 将此受限向量映射回守恒变量，以获得受限斜率 $\\widetilde{\\boldsymbol{S}}^{\\mathrm{char}}_{i} = \\boldsymbol{R}\\widetilde{\\boldsymbol{w}}_{i}$。由于只有 $\\widetilde{\\boldsymbol{w}}_{i}$ 的第一个分量非零，我们只需要第一个右特征向量 $\\boldsymbol{r}_1$：\n$$ \\boldsymbol{r}_1 = (1, u-c, H-uc)^{\\mathsf{T}} $$\n其中 $H = \\frac{E+p}{\\rho}$ 是比总焓。\n$$ H_i = \\frac{E_i+p_i}{\\rho_i} = \\frac{2.018+0.8}{0.9} = \\frac{2.818}{0.9} \\approx 3.131111... $$\n$$ \\boldsymbol{r}_1 \\approx (1, 0.2 - 1.115547, 3.131111 - 0.2 \\times 1.115547)^{\\mathsf{T}} \\approx (1, -0.915547, 2.908002)^{\\mathsf{T}} $$\n受限斜率为：\n$$ \\widetilde{\\boldsymbol{S}}^{\\mathrm{char}}_{i} = \\widetilde{w}_{1} \\boldsymbol{r}_1 \\approx -0.163755 \\times \\begin{pmatrix} 1 \\\\ -0.915547 \\\\ 2.908002 \\end{pmatrix} \\approx \\begin{pmatrix} -0.163755 \\\\ 0.149921 \\\\ -0.476191 \\end{pmatrix} $$\n\n在交界面 $x_{i+1/2}$ 处的重构左状态为：\n$$ \\boldsymbol{U}^{-,\\mathrm{char}}_{i+1/2} = \\boldsymbol{U}_{i} + \\frac{1}{2}\\widetilde{\\boldsymbol{S}}^{\\mathrm{char}}_{i} \\approx \\begin{pmatrix} 0.9 \\\\ 0.18 \\\\ 2.018 \\end{pmatrix} + \\frac{1}{2}\\begin{pmatrix} -0.163755 \\\\ 0.149921 \\\\ -0.476191 \\end{pmatrix} \\approx \\begin{pmatrix} 0.818123 \\\\ 0.254961 \\\\ 1.779904 \\end{pmatrix} $$\n设此为 $\\boldsymbol{U}^{\\mathrm{char}} = (\\rho^{\\mathrm{char}}, (\\rho u)^{\\mathrm{char}}, E^{\\mathrm{char}})^{\\mathsf{T}}$。\n\n对应的压力 $p^{\\mathrm{char}}$ 为：\n$$ p^{\\mathrm{char}} = (\\gamma - 1)\\left(E^{\\mathrm{char}} - \\frac{1}{2}\\,\\frac{((\\rho u)^{\\mathrm{char}})^{2}}{\\rho^{\\mathrm{char}}}\\right) \\approx 0.4\\left(1.779904 - \\frac{1}{2}\\,\\frac{(0.254961)^{2}}{0.818123}\\right) $$\n$$ p^{\\mathrm{char}} \\approx 0.4\\left(1.779904 - \\frac{0.065005}{1.636246}\\right) \\approx 0.4(1.779904 - 0.039728) \\approx 0.4(1.740176) \\approx 0.696070 $$\n\n### 最终计算\n\n最后，我们计算两种压力的比值 $\\Pi$：\n$$ \\Pi = \\frac{p^{\\mathrm{char}}}{p^{\\mathrm{comp}}} \\approx \\frac{0.696070}{0.70230588} \\approx 0.9911225... $$\n\n将结果四舍五入到五位有效数字，得到 $0.99112$。",
            "answer": "$$\n\\boxed{0.99112}\n$$"
        }
    ]
}