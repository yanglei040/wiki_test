{
    "hands_on_practices": [
        {
            "introduction": "此练习具体应用了经典的 `minmod` 斜率限制器，它是总变差递减（TVD）格式的基石。通过解决这个问题，您将亲眼看到限制器如何检测单元平均数据中的局部极值，并通过将局部重构平坦化来防止非物理振荡。这是实现稳健高分辨率方法的一项基本技能。",
            "id": "3443823",
            "problem": "考虑一维标量守恒律 $u_{t} + f(u)_{x} = 0$，其在一个间距为 $h0$、单元中心为 $x_{i}$ 的均匀单元网格 $\\{I_{i}\\}$ 上离散化。在分片线性间断伽辽金 (DG) 近似中，单元 $I_{i}$ 中的局部多项式表示为 $p_{i}(x) = \\bar{u}_{i} + s_{i}(x - x_{i})$，其中 $\\bar{u}_{i}$ 表示单元平均值，$s_{i}$ 是从模态系数估计的斜率。为了在单调数值通量和向前欧拉时间更新下抑制伪振荡并保持离散极值原理，我们强制要求重构的界面值 $p_{i}(x_{i\\pm\\frac{1}{2}}) = \\bar{u}_{i} \\pm \\frac{h}{2}s_{i}$ 位于相邻单元平均值之间，这意味着容许斜率必须与单边离散梯度的符号一致，并且其大小不得超过它们的大小。\n\n从上述单调性约束和总变差递减 (TVD) 行为的要求出发，推导斜率 $s_{i}$ 的限制规则，用单边差分 $(\\bar{u}_{i} - \\bar{u}_{i-1})/h$ 和 $(\\bar{u}_{i+1} - \\bar{u}_{i})/h$ 表示，然后应用此规则计算在以下特定配置中的受限斜率 $s_{i}^{\\ell}$：\n- 相邻单元平均值为 $\\bar{u}_{i-1} = 1$，$\\bar{u}_{i} = 0.2$，以及 $\\bar{u}_{i+1} = 0.3$。\n- 局部无约束斜率估计为 $s_{i} = 0.9$。\n\n假设 $h0$ 且限制器是使用应用于集合 $\\{s_{i}, (\\bar{u}_{i} - \\bar{u}_{i-1})/h, (\\bar{u}_{i+1} - \\bar{u}_{i})/h\\}$ 的经典 minmod 机制构建的。提供 $s_{i}^{\\ell}$ 的最终值，该值应为精确数，无需四舍五入，且不包含任何物理单位。",
            "solution": "该问题要求推导分片线性间断伽辽金 (DG) 方法的斜率限制规则，并将其应用于特定情况。问题陈述的验证是第一步。\n\n**问题验证**\n\n步骤1：提取已知条件\n-   一维标量守恒律为 $u_{t} + f(u)_{x} = 0$。\n-   计算网格由间距为 $h  0$、中心为 $x_{i}$ 的均匀单元 $\\{I_{i}\\}$ 组成。\n-   单元 $I_{i}$ 中的局部 DG 近似是一个线性多项式 $p_{i}(x) = \\bar{u}_{i} + s_{i}(x - x_{i})$，其中 $\\bar{u}_{i}$ 是单元平均值，$s_{i}$ 是斜率。\n-   施加了一个单调性约束：重构的界面值 $p_{i}(x_{i\\pm\\frac{1}{2}}) = \\bar{u}_{i} \\pm \\frac{h}{2}s_{i}$ 必须位于相邻单元平均值之间。\n-   此约束意味着容许斜率必须与单边离散梯度 $(\\bar{u}_{i} - \\bar{u}_{i-1})/h$ 和 $(\\bar{u}_{i+1} - \\bar{u}_{i})/h$ 的符号一致，并且其大小不得超过它们的大小。\n-   用于计算的具体数值为：$\\bar{u}_{i-1} = 1$，$\\bar{u}_{i} = 0.2$，$\\bar{u}_{i+1} = 0.3$。\n-   局部无约束斜率估计为 $s_{i} = 0.9$。\n-   要使用的限制器是应用于集合 $\\{s_{i}, (\\bar{u}_{i} - \\bar{u}_{i-1})/h, (\\bar{u}_{i+1} - \\bar{u}_{i})/h\\}$ 的经典 minmod 机制。\n\n步骤2：使用提取的已知条件进行验证\n该问题具有科学依据，因为它涉及 DG 方法的标准斜率限制技术（特别是 TVD 型限制器），这是偏微分方程数值分析中的一个成熟领域。该问题是适定的，提供了所有必要的数据和明确的目标。术语精确客观。没有矛盾、缺失数据或不科学的前提。该问题是计算流体力学和数值方法领域的标准练习。\n\n步骤3：结论与行动\n该问题被认为是有效的。将提供完整的解决方案。\n\n**限制规则的推导**\n\n在此背景下，斜率限制器的目标是强制执行单调性原理，防止在数值解中产生新的局部极值，这对于获得双曲守恒律的物理上有意义的、无振荡的解至关重要。问题陈述为受限斜率提供了核心约束，我们将对其进行形式化。\n\n令 $s_i^\\ell$ 表示受限斜率。单边离散梯度（或有限差分斜率）定义为：\n-   后向差分斜率：$\\Delta_i^- = \\frac{\\bar{u}_{i} - \\bar{u}_{i-1}}{h}$\n-   前向差分斜率：$\\Delta_i^+ = \\frac{\\bar{u}_{i+1} - \\bar{u}_{i}}{h}$\n\n$s_i^\\ell$ 的约束条件如下：\n1.  **符号一致性**：斜率 $s_i^\\ell$ 必须与 $\\Delta_i^-$ 和 $\\Delta_i^+$ 的符号相同。这仅在 $\\Delta_i^-$ 和 $\\Delta_i^+$ 符号相同时才可能。如果它们的符号不同，这种情况发生在局部极值点（峰值或谷值），则没有非零斜率可以与两者符号一致。在这种情况下，为防止过冲或下冲，重构必须为常数，这意味着斜率必须为零。因此，如果 $\\text{sign}(\\Delta_i^-) \\neq \\text{sign}(\\Delta_i^+)$，则 $s_i^\\ell = 0$。\n2.  **大小约束**：斜率的大小不得超过单边离散梯度的大小。这可以表示为 $|s_i^\\ell| \\le |\\Delta_i^-|$ 和 $|s_i^\\ell| \\le |\\Delta_i^+|$。将它们结合起来，我们得到 $|s_i^\\ell| \\le \\min(|\\Delta_i^-|, |\\Delta_i^+|)$。\n\n这些条件被 minmod 函数精确地概括，对于一组参数 $\\{a_1, a_2, \\dots, a_n\\}$，其定义为：\n$$\n\\text{minmod}(a_1, a_2, \\dots, a_n) =\n\\begin{cases}\n\\min(a_1, \\dots, a_n)  \\text{if } a_j > 0 \\text{ for all } j, \\\\\n\\max(a_1, \\dots, a_n)  \\text{if } a_j  0 \\text{ for all } j, \\\\\n0  \\text{otherwise}.\n\\end{cases}\n$$\n将此应用于两个离散梯度，满足从相邻点导出的单调性边界的最大斜率为 $s'_{i} = \\text{minmod}(\\Delta_i^-, \\Delta_i^+)$。\n\n最后一步是限制原始的无约束斜率 $s_{i}$。限制的原则是尽可能少地修改原始斜率。受限斜率 $s_i^\\ell$ 必须满足上述推导的单调性条件，同时其大小也不能超过原始斜率，即 $|s_i^\\ell| \\le |s_i|$。这通过将原始斜率 $s_i$ 作为 minmod 函数的一个参数来实现。得到的受限斜率为：\n$$ s_i^\\ell = \\text{minmod}(s_i, s'_{i}) = \\text{minmod}\\left(s_i, \\text{minmod}(\\Delta_i^-, \\Delta_i^+)\\right) $$\n根据 minmod 函数的性质，这等价于：\n$$ s_i^\\ell = \\text{minmod}(s_i, \\Delta_i^-, \\Delta_i^+) = \\text{minmod}\\left(s_i, \\frac{\\bar{u}_i - \\bar{u}_{i-1}}{h}, \\frac{\\bar{u}_{i+1} - \\bar{u}_i}{h}\\right) $$\n这证实了问题陈述中指定规则的有效性。\n\n**应用于特定配置**\n\n我们需要计算给定数据的受限斜率 $s_i^\\ell$。minmod 函数的参数为：\n1.  无约束斜率：$s_i = 0.9$。\n2.  后向差分斜率：$\\Delta_i^- = \\frac{\\bar{u}_i - \\bar{u}_{i-1}}{h} = \\frac{0.2 - 1}{h} = -\\frac{0.8}{h}$。\n3.  前向差分斜率：$\\Delta_i^+ = \\frac{\\bar{u}_{i+1} - \\bar{u}_i}{h} = \\frac{0.3 - 0.2}{h} = \\frac{0.1}{h}$。\n\nminmod 函数的三个参数是 $\\{0.9, -0.8/h, 0.1/h\\}$。我们必须确定它们的符号。由于给定 $h0$：\n-   $s_i = 0.9$ 是正数。\n-   $\\Delta_i^- = -0.8/h$ 是负数。\n-   $\\Delta_i^+ = 0.1/h$ 是正数。\n\n参数集 $\\{0.9, -0.8/h, 0.1/h\\}$ 包含正值和负值。根据 minmod 函数的定义，如果参数不都具有相同的符号，则结果为零。这种情况对应于单元 $I_i$ 是一个局部最小值（$\\bar{u}_i$ 小于 $\\bar{u}_{i-1}$ 但大于 $\\bar{u}_{i+1}$ 是错误的，原文是 $\\bar{u}_{i-1}=1, \\bar{u}_i=0.2, \\bar{u}_{i+1}=0.3$ 所以 $\\bar{u}_i$ 小于 $\\bar{u}_{i-1}$ 和 $\\bar{u}_{i+1}$），限制器正确地将重构平坦化为一个常数值（$\\bar{u}_{i}$），以防止产生新的、非物理的最小值（下冲）。\n\n因此，受限斜率为：\n$$ s_i^\\ell = \\text{minmod}\\left(0.9, -\\frac{0.8}{h}, \\frac{0.1}{h}\\right) = 0 $$\n最终值与网格间距 $h$ 无关。",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "除了斜率修正，这个练习探讨了一种基于强制执行离散极值原理（DMP）的替代限制策略。您将计算一个缩放因子，将一个超出范围的节点值拉回到由相邻单元确定的物理合理范围内。 这个练习阐明了如何将限制器表达为对高阶项的缩放，既能保持单元平均值不变，又能保证解的单调性。",
            "id": "3443803",
            "problem": "考虑一个用间断伽辽金 (DG) 方法离散的标量守恒律，并假设应用了一个保单调性限制器来强制执行离散极值原理 (DMP)。DMP要求目标单元内的重构解保持在由该单元平均值和相邻单元平均值组成的集合所计算出的极值范围内。设相邻单元的平均值为集合 $\\{0.1, 0.4, 0.3\\}$，当前单元的平均值为 $\\bar{u}_{K} = 0.3$。假设目标单元的DMP上界为 $M_{K} = 0.4$，这与在由相邻单元平均值和目标单元平均值组成的并集上取最大值是一致的。\n\n设目标单元中的无限制多项式近似 $u_{h}$ 在一个求积点 $x_{q}$ 处产生节点值 $u_{h}(x_{q}) = 0.55$，这违反了DMP上界。在使用一个以单元平均值为基准的线性缩放限制器的情况下，限制后的多项式形式为 $\\tilde{u}_{h}(x) = \\bar{u}_{K} + \\theta \\left(u_{h}(x) - \\bar{u}_{K}\\right)$，其中标量 $\\theta \\in [0, 1]$ 的选择应以最小程度在 $x_{q}$ 处强制执行DMP，同时保持单元平均值不变。\n\n使用DMP和所述的限制器构造，确定在 $x_{q}$ 处强制执行上界的 $\\theta$ 值。请以单个实数形式提供答案，无需四舍五入。",
            "solution": "对于使用间断伽辽金 (DG) 方法离散化的标量守恒律，离散极值原理 (DMP) 规定，每个单元内的重构解必须位于由邻近平均值确定的界限内。对于一个目标单元 $K$，其下界和上界定义为\n$$\nm_{K} := \\min\\left(\\bar{u}_{K}, \\text{neighbor averages}\\right), \\qquad M_{K} := \\max\\left(\\bar{u}_{K}, \\text{neighbor averages}\\right).\n$$\n已知相邻单元平均值为 $\\{0.1, 0.4, 0.3\\}$，目标单元平均值为 $\\bar{u}_{K} = 0.3$，则上界为\n$$\nM_{K} = \\max\\left(0.3, 0.1, 0.4, 0.3\\right) = 0.4.\n$$\n假设无限制多项式 $u_{h}$ 在位置 $x_{q}$ 处的值为\n$$\nu_{h}(x_{q}) = 0.55,\n$$\n这违反了DMP上界 $M_{K} = 0.4$，因为 $0.55  0.4$。\n\n为在保持单元平均值不变的情况下强制执行DMP，应用一个以单元平均值为基准的线性缩放限制器：\n$$\n\\tilde{u}_{h}(x) = \\bar{u}_{K} + \\theta \\left(u_{h}(x) - \\bar{u}_{K}\\right), \\qquad \\theta \\in [0,1].\n$$\n在特定点 $x_{q}$ 处，限制后的值必须满足不等式\n$$\n\\tilde{u}_{h}(x_{q}) \\leq M_{K}.\n$$\n将限制后多项式的形式代入此不等式，得到\n$$\n\\bar{u}_{K} + \\theta \\left(u_{h}(x_{q}) - \\bar{u}_{K}\\right) \\leq M_{K}.\n$$\n因为 $u_{h}(x_{q})  \\bar{u}_{K}$ 且 $M_{K}  \\bar{u}_{K}$，我们可以求解使约束取等号的最小 $\\theta$（以最小程度地抑制高阶修正）：\n$$\n\\theta = \\frac{M_{K} - \\bar{u}_{K}}{u_{h}(x_{q}) - \\bar{u}_{K}}.\n$$\n代入数值，得到\n$$\n\\theta = \\frac{0.4 - 0.3}{0.55 - 0.3} = \\frac{0.1}{0.25} = 0.4.\n$$\n因此，在 $x_{q}$ 处强制执行DMP上界的限制器缩放参数为\n$$\n\\theta = 0.4.\n$$",
            "answer": "$$\\boxed{0.4}$$"
        },
        {
            "introduction": "这个高级练习将斜率限制的概念扩展到守恒律方程组，特别是可压缩欧拉方程。它要求您执行并比较两种不同的限制方法：一种是简单的分量限制法，另一种是基于物理的特征限制法。 这种比较对于理解为什么在限制密度、动量和能量等耦合变量时，特征分解通常是避免产生非物理状态所必需的，至关重要。",
            "id": "3443857",
            "problem": "在间断伽辽金 (DG) 有限元背景下，考虑比热比 $\\gamma = 1.4$ 的理想气体的一维可压缩欧拉方程。在一个均匀网格上，给定三个连续单元 $i-1$、$i$ 和 $i+1$ 上的网格平均守恒态：\n$$\n\\boldsymbol{U}_{i-1} = \\begin{pmatrix} 1.0 \\\\ 0.0 \\\\ 2.5 \\end{pmatrix},\\quad\n\\boldsymbol{U}_{i} = \\begin{pmatrix} 0.9 \\\\ 0.18 \\\\ 2.018 \\end{pmatrix},\\quad\n\\boldsymbol{U}_{i+1} = \\begin{pmatrix} 0.5 \\\\ 0.2 \\\\ 1.29 \\end{pmatrix},\n$$\n其中 $\\boldsymbol{U} = (\\rho, \\rho u, E)^{\\mathsf{T}}$ 汇集了密度 $\\rho$、动量 $\\rho u$ 和总能量 $E$。所有量均为无量纲。\n\n在每个单元中使用分段线性重构，并基于总变差递减 (TVD) minmod 函数进行对称斜率限制，定义未除差分\n$$\n\\Delta^{-}\\boldsymbol{U}_{i} = \\boldsymbol{U}_{i} - \\boldsymbol{U}_{i-1},\\qquad\n\\Delta^{+}\\boldsymbol{U}_{i} = \\boldsymbol{U}_{i+1} - \\boldsymbol{U}_{i}.\n$$\n设 minmod 函数为\n$$\n\\operatorname{mm}(a,b) = \\begin{cases}\n\\operatorname{sign}(a)\\,\\min(|a|,|b|),   \\text{if } ab  0,\\\\\n0,   \\text{otherwise}.\n\\end{cases}\n$$\n\n对界面 $x_{i+1/2}$ 处的左态执行以下两种重构：\n\n1) 守恒变量的分量限制：构造受限斜率\n$$\n\\boldsymbol{S}^{\\mathrm{comp}}_{i} = \\begin{pmatrix}\n\\operatorname{mm}(\\Delta^{-}\\rho_{i},\\Delta^{+}\\rho_{i})\\\\\n\\operatorname{mm}(\\Delta^{-}(\\rho u)_{i},\\Delta^{+}(\\rho u)_{i})\\\\\n\\operatorname{mm}(\\Delta^{-}E_{i},\\Delta^{+}E_{i})\n\\end{pmatrix},\n$$\n并设置重构的左态\n$$\n\\boldsymbol{U}^{-,\\mathrm{comp}}_{i+1/2} = \\boldsymbol{U}_{i} + \\tfrac{1}{2}\\,\\boldsymbol{S}^{\\mathrm{comp}}_{i}.\n$$\n\n2) 特征分量限制：通过使用一维欧拉通量雅可比矩阵（在守恒变量中）的标准右特征向量矩阵 $\\boldsymbol{R}(\\boldsymbol{U}_{i})$ 及其逆矩阵 $\\boldsymbol{L}(\\boldsymbol{U}_{i}) = \\boldsymbol{R}(\\boldsymbol{U}_{i})^{-1}$，在单元 $i$ 处形成基于雅可比矩阵的特征分解。将未除差分投影到特征空间\n$$\n\\boldsymbol{w}^{-}_{i} = \\boldsymbol{L}(\\boldsymbol{U}_{i})\\,\\Delta^{-}\\boldsymbol{U}_{i},\\qquad\n\\boldsymbol{w}^{+}_{i} = \\boldsymbol{L}(\\boldsymbol{U}_{i})\\,\\Delta^{+}\\boldsymbol{U}_{i},\n$$\n用 minmod 函数限制每个特征分量以获得 $\\widetilde{\\boldsymbol{w}}_{i}$，通过 $\\widetilde{\\boldsymbol{S}}^{\\mathrm{char}}_{i} = \\boldsymbol{R}(\\boldsymbol{U}_{i})\\,\\widetilde{\\boldsymbol{w}}_{i}$ 映射回守恒变量，并设置\n$$\n\\boldsymbol{U}^{-,\\mathrm{char}}_{i+1/2} = \\boldsymbol{U}_{i} + \\tfrac{1}{2}\\,\\widetilde{\\boldsymbol{S}}^{\\mathrm{char}}_{i}.\n$$\n\n对于每个重构的左态，计算热力学压力\n$$\np = (\\gamma - 1)\\left(E - \\tfrac{1}{2}\\,\\frac{(\\rho u)^{2}}{\\rho}\\right).\n$$\n\n最后，计算两个压力的比率\n$$\n\\Pi = \\frac{p^{\\mathrm{char}}}{p^{\\mathrm{comp}}}.\n$$\n\n所有计算必须与上述定义自洽。将最终答案表示为一个纯数（无量纲），并将您的答案四舍五入到五位有效数字。",
            "solution": "用户提供了一个计算流体动力学领域的明确问题，具体涉及应用于一维欧拉方程的间断伽辽金法的斜率限制技术。该问题在科学上是合理的、自洽的，并且所有需要的数据和定义都已提供。因此，该问题被视为**有效的**。\n\n求解过程需要对单元界面处的流体状态执行两种类型的重构，然后比较得到的压力。这两种方法是分量限制和特征分量限制。\n\n### 已知数据\n- 比热比：$\\gamma = 1.4$\n- 网格平均守恒态：\n  $$ \\boldsymbol{U}_{i-1} = \\begin{pmatrix} 1.0 \\\\ 0.0 \\\\ 2.5 \\end{pmatrix}, \\quad \\boldsymbol{U}_{i} = \\begin{pmatrix} 0.9 \\\\ 0.18 \\\\ 2.018 \\end{pmatrix}, \\quad \\boldsymbol{U}_{i+1} = \\begin{pmatrix} 0.5 \\\\ 0.2 \\\\ 1.29 \\end{pmatrix} $$\n- 状态向量：$\\boldsymbol{U} = (\\rho, \\rho u, E)^{\\mathsf{T}}$\n- 压力计算公式：$p = (\\gamma - 1)\\left(E - \\frac{1}{2}\\,\\frac{(\\rho u)^{2}}{\\rho}\\right)$\n\n### 第1部分：分量限制\n\n首先，我们计算相邻单元之间守恒变量的未除差分。\n$$ \\Delta^{-}\\boldsymbol{U}_{i} = \\boldsymbol{U}_{i} - \\boldsymbol{U}_{i-1} = \\begin{pmatrix} 0.9 - 1.0 \\\\ 0.18 - 0.0 \\\\ 2.018 - 2.5 \\end{pmatrix} = \\begin{pmatrix} -0.1 \\\\ 0.18 \\\\ -0.482 \\end{pmatrix} $$\n$$ \\Delta^{+}\\boldsymbol{U}_{i} = \\boldsymbol{U}_{i+1} - \\boldsymbol{U}_{i} = \\begin{pmatrix} 0.5 - 0.9 \\\\ 0.2 - 0.18 \\\\ 1.29 - 2.018 \\end{pmatrix} = \\begin{pmatrix} -0.4 \\\\ 0.02 \\\\ -0.728 \\end{pmatrix} $$\n\n接下来，我们对这些差分逐分量应用 `minmod` 函数，以求得受限斜率向量 $\\boldsymbol{S}^{\\mathrm{comp}}_{i}$。\n$$ S^{\\mathrm{comp}}_{1} = \\operatorname{mm}(-0.1, -0.4) = \\operatorname{sign}(-0.1)\\min(|-0.1|, |-0.4|) = -0.1 $$\n$$ S^{\\mathrm{comp}}_{2} = \\operatorname{mm}(0.18, 0.02) = \\operatorname{sign}(0.18)\\min(|0.18|, |0.02|) = 0.02 $$\n$$ S^{\\mathrm{comp}}_{3} = \\operatorname{mm}(-0.482, -0.728) = \\operatorname{sign}(-0.482)\\min(|-0.482|, |-0.728|) = -0.482 $$\n因此，受限斜率为 $\\boldsymbol{S}^{\\mathrm{comp}}_{i} = (-0.1, 0.02, -0.482)^{\\mathsf{T}}$。\n\n在界面 $x_{i+1/2}$ 处的重构左态由下式给出：\n$$ \\boldsymbol{U}^{-,\\mathrm{comp}}_{i+1/2} = \\boldsymbol{U}_{i} + \\frac{1}{2}\\boldsymbol{S}^{\\mathrm{comp}}_{i} = \\begin{pmatrix} 0.9 \\\\ 0.18 \\\\ 2.018 \\end{pmatrix} + \\frac{1}{2}\\begin{pmatrix} -0.1 \\\\ 0.02 \\\\ -0.482 \\end{pmatrix} = \\begin{pmatrix} 0.9 - 0.05 \\\\ 0.18 + 0.01 \\\\ 2.018 - 0.241 \\end{pmatrix} = \\begin{pmatrix} 0.85 \\\\ 0.19 \\\\ 1.777 \\end{pmatrix} $$\n将此重构状态表示为 $\\boldsymbol{U}^{\\mathrm{comp}} = (\\rho^{\\mathrm{comp}}, (\\rho u)^{\\mathrm{comp}}, E^{\\mathrm{comp}})^{\\mathsf{T}}$。\n\n最后，我们计算此状态下的压力 $p^{\\mathrm{comp}}$：\n$$ p^{\\mathrm{comp}} = (\\gamma - 1)\\left(E^{\\mathrm{comp}} - \\frac{1}{2}\\,\\frac{((\\rho u)^{\\mathrm{comp}})^{2}}{\\rho^{\\mathrm{comp}}}\\right) = (1.4 - 1)\\left(1.777 - \\frac{1}{2}\\,\\frac{(0.19)^{2}}{0.85}\\right) $$\n$$ p^{\\mathrm{comp}} = 0.4\\left(1.777 - \\frac{0.0361}{1.7}\\right) = 0.4(1.777 - 0.02123529...) = 0.4(1.7557647...) = 0.70230588... $$\n\n### 第2部分：特征分量限制\n\n此过程需要将差分投影到欧拉方程的特征场上。用于此投影的矩阵 $\\boldsymbol{R}$ 和 $\\boldsymbol{L}$ 取决于单元 $i$ 中的局部流体状态。\n首先，我们计算状态 $\\boldsymbol{U}_{i}$ 的原始变量：\n$$ \\rho_i = 0.9 $$\n$$ u_i = \\frac{(\\rho u)_i}{\\rho_i} = \\frac{0.18}{0.9} = 0.2 $$\n$$ p_i = (\\gamma-1)\\left(E_i - \\frac{1}{2}\\rho_i u_i^2\\right) = (1.4-1)\\left(2.018 - \\frac{1}{2}(0.9)(0.2)^2\\right) = 0.4(2.018 - 0.018) = 0.4(2.0) = 0.8 $$\n声速 $c_i$ 为：\n$$ c_i = \\sqrt{\\frac{\\gamma p_i}{\\rho_i}} = \\sqrt{\\frac{1.4 \\times 0.8}{0.9}} = \\sqrt{\\frac{1.12}{0.9}} = \\sqrt{\\frac{56}{45}} \\approx 1.11554676 $$\n\n左特征向量矩阵 $\\boldsymbol{L}(\\boldsymbol{U}_{i})$ 用于将未除差分投影到特征空间中。使用标准公式，我们得到：\n$$ \\boldsymbol{L}(\\boldsymbol{U}_{i}) \\approx \\begin{pmatrix} 0.092871   -0.480424   0.160714 \\\\ 0.993683   0.064286   -0.321429 \\\\ -0.086455   0.416161   0.160714 \\end{pmatrix} $$\n现在我们投影差分：$\\boldsymbol{w}^{-}_{i} = \\boldsymbol{L}\\Delta^{-}\\boldsymbol{U}_{i}$ 和 $\\boldsymbol{w}^{+}_{i} = \\boldsymbol{L}\\Delta^{+}\\boldsymbol{U}_{i}$。\n$$ \\boldsymbol{w}^{-}_{i} = \\boldsymbol{L} \\begin{pmatrix} -0.1 \\\\ 0.18 \\\\ -0.482 \\end{pmatrix} \\approx \\begin{pmatrix} -0.173227 \\\\ 0.067132 \\\\ 0.006091 \\end{pmatrix} $$\n$$ \\boldsymbol{w}^{+}_{i} = \\boldsymbol{L} \\begin{pmatrix} -0.4 \\\\ 0.02 \\\\ -0.728 \\end{pmatrix} \\approx \\begin{pmatrix} -0.163755 \\\\ -0.162197 \\\\ -0.074094 \\end{pmatrix} $$\n\n接下来，对特征变量向量的每个分量应用 `minmod` 函数：\n$$ \\widetilde{w}_{1} = \\operatorname{mm}(w^{-}_{1}, w^{+}_{1}) = \\operatorname{mm}(-0.173227, -0.163755) = -0.163755 $$\n$$ \\widetilde{w}_{2} = \\operatorname{mm}(w^{-}_{2}, w^{+}_{2}) = \\operatorname{mm}(0.067132, -0.162197) = 0 $$\n$$ \\widetilde{w}_{3} = \\operatorname{mm}(w^{-}_{3}, w^{+}_{3}) = \\operatorname{mm}(0.006091, -0.074094) = 0 $$\n受限特征向量为 $\\widetilde{\\boldsymbol{w}}_{i} \\approx (-0.163755, 0, 0)^{\\mathsf{T}}$。第二和第三特征场的斜率被设置为零，因为它们对应差分的符号相反，这表明存在一个局部极值。\n\n使用右特征向量矩阵 $\\boldsymbol{R}(\\boldsymbol{U}_{i})$ 将此受限向量映射回守恒变量，以获得受限斜率 $\\widetilde{\\boldsymbol{S}}^{\\mathrm{char}}_{i} = \\boldsymbol{R}\\widetilde{\\boldsymbol{w}}_{i}$。由于只有 $\\widetilde{\\boldsymbol{w}}_{i}$ 的第一个分量非零，我们只需要第一个右特征向量 $\\boldsymbol{r}_1$：\n$$ \\boldsymbol{r}_1 = (1, u-c, H-uc)^{\\mathsf{T}} $$\n其中 $H = \\frac{E+p}{\\rho}$ 是比总焓。\n$$ H_i = \\frac{E_i+p_i}{\\rho_i} = \\frac{2.018+0.8}{0.9} = \\frac{2.818}{0.9} \\approx 3.131111... $$\n$$ \\boldsymbol{r}_1 \\approx (1, 0.2 - 1.115547, 3.131111 - 0.2 \\times 1.115547)^{\\mathsf{T}} \\approx (1, -0.915547, 2.908002)^{\\mathsf{T}} $$\n受限斜率为：\n$$ \\widetilde{\\boldsymbol{S}}^{\\mathrm{char}}_{i} = \\widetilde{w}_{1} \\boldsymbol{r}_1 \\approx -0.163755 \\times \\begin{pmatrix} 1 \\\\ -0.915547 \\\\ 2.908002 \\end{pmatrix} \\approx \\begin{pmatrix} -0.163755 \\\\ 0.149921 \\\\ -0.476191 \\end{pmatrix} $$\n\n在界面 $x_{i+1/2}$ 处的重构左态为：\n$$ \\boldsymbol{U}^{-,\\mathrm{char}}_{i+1/2} = \\boldsymbol{U}_{i} + \\frac{1}{2}\\widetilde{\\boldsymbol{S}}^{\\mathrm{char}}_{i} \\approx \\begin{pmatrix} 0.9 \\\\ 0.18 \\\\ 2.018 \\end{pmatrix} + \\frac{1}{2}\\begin{pmatrix} -0.163755 \\\\ 0.149921 \\\\ -0.476191 \\end{pmatrix} \\approx \\begin{pmatrix} 0.818123 \\\\ 0.254961 \\\\ 1.779904 \\end{pmatrix} $$\n设其为 $\\boldsymbol{U}^{\\mathrm{char}} = (\\rho^{\\mathrm{char}}, (\\rho u)^{\\mathrm{char}}, E^{\\mathrm{char}})^{\\mathsf{T}}$。\n\n对应的压力 $p^{\\mathrm{char}}$ 为：\n$$ p^{\\mathrm{char}} = (\\gamma - 1)\\left(E^{\\mathrm{char}} - \\frac{1}{2}\\,\\frac{((\\rho u)^{\\mathrm{char}})^{2}}{\\rho^{\\mathrm{char}}}\\right) \\approx 0.4\\left(1.779904 - \\frac{1}{2}\\,\\frac{(0.254961)^{2}}{0.818123}\\right) $$\n$$ p^{\\mathrm{char}} \\approx 0.4\\left(1.779904 - \\frac{0.065005}{1.636246}\\right) \\approx 0.4(1.779904 - 0.039728) \\approx 0.4(1.740176) \\approx 0.696070 $$\n\n### 最终计算\n\n最后，我们计算两个压力的比率 $\\Pi$：\n$$ \\Pi = \\frac{p^{\\mathrm{char}}}{p^{\\mathrm{comp}}} \\approx \\frac{0.696070}{0.70230588} \\approx 0.9911225... $$\n\n将结果四舍五入到五位有效数字，得到 $0.99112$。",
            "answer": "$$\n\\boxed{0.99112}\n$$"
        }
    ]
}