{
    "hands_on_practices": [
        {
            "introduction": "为了构建高效的有限元，意外单元（Serendipity Element）通过精心地挑选构成其基函数的多项式，从而在保持所需逼近精度的同时，减少自由度的数量。一种形式化的方法是引入“超线性次数”的概念来筛选这些多项式。这个练习将帮助你通过一个具体的例子——判断一个简单的单项式是否属于特定阶数的意外单元空间——来掌握这个核心定义。",
            "id": "3442379",
            "problem": "考虑参考正方形 $\\hat K=[-1,1]^2$ 上 serendipity 有限元空间。对于一个单项式 $m(x,y)=x^{\\alpha}y^{\\beta}$（其中 $\\alpha$ 和 $\\beta$ 为非负整数），定义其超线性次数 $\\operatorname{sldeg}(m)$ 为\n$$\n\\operatorname{sldeg}(x^{\\alpha}y^{\\beta})=\\sum_{v\\in\\{\\alpha,\\beta\\}\\,:\\,v\\ge 2} v.\n$$\n对于一个多项式 $p(x,y)=\\sum_{\\alpha,\\beta\\ge 0} c_{\\alpha\\beta} x^{\\alpha}y^{\\beta}$，定义其超线性次数为\n$$\n\\operatorname{sldeg}(p)=\\max\\{\\operatorname{sldeg}(x^{\\alpha}y^{\\beta}) \\,:\\, c_{\\alpha\\beta}\\ne 0\\}.\n$$\n阶为 $r$ 的 serendipity 空间，记作 $S_r(\\hat K)$，是 $\\hat K$ 上所有满足 $\\operatorname{sldeg}(p)\\le r$ 的多项式 $p$ 构成的空间。\n\n确定最小的整数 $r$，使得单项式 $x^2y^2$ 属于 $S_r(\\hat K)$，并根据超线性次数的定义直接证明你的答案。你的最终答案必须是一个整数。",
            "solution": "任务是确定最小的整数 $r$，使得单项式 $p(x,y) = x^2y^2$ 是 serendipity 空间 $S_r(\\hat K)$ 的一个元素。\n\n问题中给出的 serendipity 空间 $S_r(\\hat K)$ 的定义是，在参考正方形 $\\hat K$ 上，所有其超线性次数 $\\operatorname{sldeg}(p)$ 小于或等于 $r$ 的多项式 $p$ 构成的集合。因此，一个多项式 $p$ 属于 $S_r(\\hat K)$ 的条件是：\n$$\n\\operatorname{sldeg}(p) \\le r.\n$$\n我们所考虑的多项式是单项式 $p(x,y) = x^2y^2$。一个多项式的超线性次数定义为其各组成单项式的超线性次数的最大值。由于我们的多项式只包含一项，其超线性次数就是该单项式的超线性次数：\n$$\n\\operatorname{sldeg}(x^2y^2) = \\max\\{\\operatorname{sldeg}(x^2y^2)\\} = \\operatorname{sldeg}(x^2y^2).\n$$\n我们现在必须使用给定的公式来计算单项式 $x^2y^2$ 的超线性次数。该单项式的形式为 $x^{\\alpha}y^{\\beta}$，其中指数为 $\\alpha=2$ 和 $\\beta=2$。单项式的超线性次数的定义是：\n$$\n\\operatorname{sldeg}(x^{\\alpha}y^{\\beta})=\\sum_{v\\in\\{\\alpha,\\beta\\}\\,:\\,v\\ge 2} v.\n$$\n该公式指示我们将指数 $\\alpha$ 和 $\\beta$ 的值相加，当且仅当它们的值大于或等于 $2$ 时。\n\n让我们将此规则应用于 $x^2y^2$ 的指数，即 $\\alpha=2$ 和 $\\beta=2$。\n1.  我们检查指数 $\\alpha=2$。由于 $2 \\ge 2$ 为真，$\\alpha$ 的值（即 $2$）被包含在求和中。\n2.  我们检查指数 $\\beta=2$。由于 $2 \\ge 2$ 为真，$\\beta$ 的值（即 $2$）也被包含在求和中。\n\n因此，要求和的指数集合是 $\\{2, 2\\}$。超线性次数是这些值的和：\n$$\n\\operatorname{sldeg}(x^2y^2) = 2 + 2 = 4.\n$$\n在求出 $x^2y^2$ 的超线性次数后，我们现在可以确定该单项式属于 $S_r(\\hat K)$ 的条件。该条件是 $\\operatorname{sldeg}(x^2y^2) \\le r$。代入我们计算出的值，我们得到不等式：\n$$\n4 \\le r.\n$$\n问题要求满足此不等式的最小整数 $r$。满足 $r \\ge 4$ 的整数集合是 $\\{4, 5, 6, \\dots\\}$。此集合中的最小整数是 $4$。\n\n因此，使得 $x^2y^2$ 属于 $S_r(\\hat K)$ 的最小整数 $r$ 是 $4$。",
            "answer": "$$\\boxed{4}$$"
        },
        {
            "introduction": "掌握了如何使用超线性次数来识别单个多项式后，我们可以更进一步，通过组合计数的方法来确定整个意外单元空间的维度。这个练习不仅是一个有趣的组合数学挑战，它还能揭示意外单元的深层结构，展示其多项式基底如何与单元的几何实体（顶点、边、面和内部）精确对应。通过这个过程，你将理解意外单元相比于张量积单元在计算效率上的优势来源。",
            "id": "3442394",
            "problem": "设 $\\hat K = [-1,1]^3$ 为参考六面体。对于一个整数多项式阶数 $r \\geq 1$，将三维 serendipity 空间 $S_r(\\hat K)$ 定义为所有超线性次数至多为 $r$ 的单项式 $x^{a} y^{b} z^{c}$ 的张成空间，其中单项式 $x^{a} y^{b} z^{c}$ 的超线性次数定义为 $\\operatorname{sldeg}(x^{a} y^{b} z^{c}) := \\sum_{\\{v \\in \\{a,b,c\\} : v \\geq 2\\}} v$。从这个定义和基本计数原理出发，通过直接对所有允许的单项式进行计数，推导出一个关于维数 $\\dim S_r(\\hat K)$ 的闭式表达式。您的推导过程应根据超线性变量的个数 $m \\in \\{0,1,2,3\\}$ 对单项式进行划分，然后对每个 $m$ 计算允许的指数分配。\n\n接下来，利用您的计数分解，确定在任意单解自由度（DOF）系统中，面支撑和单元内部支撑的基函数首次出现时的多项式阶数 $r$。这里，“面支撑”指的是其支撑集始于 $\\hat K$ 的二维面内部（即不限于顶点或边）的基函数，“单元内部支撑”指的是其支撑集始于 $\\hat K$ 的三维内部（即不限于任何边界子实体）的基函数。通过在您按 $m$ 进行的分解中确定相应计数何时变为严格正数，来论证您的阈值。\n\n将您的最终答案以一个包含三个条目的行矩阵 $\\big(\\dim S_r(\\hat K), r_{\\text{face}}, r_{\\text{cell}}\\big)$ 的形式报告，其中 $r_{\\text{face}}$ 是面支撑自由度首次出现的最小 $r$ 值，$r_{\\text{cell}}$ 是单元内部支撑自由度首次出现的最小 $r$ 值。无需四舍五入。没有物理单位。将维数表示为 $r$ 的闭式解析表达式（您可以使用二项式系数）。",
            "solution": "### 解答\n\n$S_r(\\hat K)$ 的维数是满足条件 $\\operatorname{sldeg}(x^{a} y^{b} z^{c}) \\leq r$ 的线性无关单项式 $x^{a} y^{b} z^{c}$（其中指数 $a, b, c$ 为非负整数）的数量。超线性次数只考虑大于或等于2的指数。我们根据集合 $\\{a, b, c\\}$ 中超线性（即大于或等于2）指数的个数 $m$ 来划分所有此类单项式的集合。\n\n设 $N_m$ 是恰好有 $m$ 个超线性指数的允许单项式的数量。总维数为 $\\dim S_r(\\hat K) = N_0 + N_1 + N_2 + N_3$。\n\n**情况 $m=0$：** 没有指数是超线性的。\n这意味着 $a, b, c \\in \\{0, 1\\}$。对于任何这样的选择，超线性指数的集合是空的，所以它们的和，即超线性次数，为0。条件 $\\operatorname{sldeg} \\leq r$ 变为 $0 \\leq r$，因为 $r \\geq 1$ 所以这总是成立的。\n每个指数的选择数量为2（0或1）。因此，这类单项式的数量是 $2 \\times 2 \\times 2 = 8$。\n$$N_0 = 8$$\n这8个单项式（$1, x, y, z, xy, xz, yz, xyz$）张成了空间 $Q_1$，并对应于六面体8个顶点的自由度。\n\n**情况 $m=1$：** 恰好有一个指数是超线性的。\n我们假设指数 $a$ 是超线性的，所以 $a \\geq 2$。另外两个指数 $b$ 和 $c$ 必须在 $\\{0, 1\\}$ 中。\n关于超线性次数的条件变为 $\\operatorname{sldeg}(x^a y^b z^c) = a \\leq r$。\n所以我们需要计算满足 $2 \\leq a \\leq r$ 和 $b, c \\in \\{0, 1\\}$ 的整数三元组 $(a, b, c)$ 的数量。\n$a$ 的选择数量是 $r - 2 + 1 = r-1$。这个计数对于 $r \\geq 2$ 有效；对于 $r=1$，计数为0。\n$b$ 的选择数量是2，$c$ 的选择数量也是2。\n有 $\\binom{3}{1} = 3$ 种方式来选择三个变量（$x, y, z$）中哪一个具有超线性指数。\n根据对称性，每种选择的计数是相同的。因此，对于 $m=1$ 的单项式总数为：\n$$N_1 = \\binom{3}{1} \\times (r-1) \\times 2^{2} = 12(r-1) = 12\\binom{r-1}{1}$$\n这些单项式对应于边的自由度，它们在 $r=2$ 时首次出现。\n\n**情况 $m=2$：** 恰好有两个指数是超线性的。\n我们假设 $a \\geq 2$ 和 $b \\geq 2$ 是超线性的，而 $c \\in \\{0, 1\\}$。\n超线性次数的条件变为 $\\operatorname{sldeg}(x^a y^b z^c) = a + b \\leq r$。\n我们需要计算满足 $a+b \\leq r$ 且 $a,b \\ge 2$，$c \\in \\{0, 1\\}$ 的整数三元组 $(a, b, c)$ 的数量。\n$c$ 有2种选择。有 $\\binom{3}{2}=3$ 种方式来选择哪两个指数是超线性的。\n满足 $a+b \\leq r$ 且 $a,b \\ge 2$ 的正整数对 $(a,b)$ 的数量，等价于满足 $a'+b' \\leq r-4$ 的非负整数对 $(a',b')$ 的数量（通过令 $a=a'+2, b=b'+2$）。使用星号和隔板法，这个数量是 $\\binom{(r-4)+2}{2} = \\binom{r-2}{2}$。\n因此，对于 $m=2$ 的单项式总数为：\n$$N_2 = \\binom{3}{2} \\times \\binom{r-2}{2} \\times 2 = 6\\binom{r-2}{2}$$\n这些单项式对应于面的自由度。它们首次出现需要 $\\binom{r-2}{2} > 0$，这意味着 $r-2 \\geq 2$，即 $r \\geq 4$。因此，$r_{\\text{face}} = 4$。\n\n**情况 $m=3$：** 所有三个指数都是超线性的。\n我们有 $a \\geq 2, b \\geq 2, c \\geq 2$。\n超线性次数的条件是 $a+b+c \\leq r$。\n我们需要计算满足此条件的三元组 $(a,b,c)$ 的数量。这等价于计算满足 $a'+b'+c' \\leq r-6$ 的非负整数三元组 $(a',b',c')$ 的数量，其数量为 $\\binom{(r-6)+3}{3} = \\binom{r-3}{3}$。\n$$N_3 = \\binom{r-3}{3}$$\n这些单项式对应于单元内部的自由度。它们首次出现需要 $\\binom{r-3}{3} > 0$，这意味着 $r-3 \\geq 3$，即 $r \\geq 6$。因此，$r_{\\text{cell}} = 6$。\n\n**最终公式和值**\n\n将所有情况相加，我们得到 $S_r(\\hat K)$ 的总维数：\n$$ \\dim S_r(\\hat K) = N_0 + N_1 + N_2 + N_3 = 8 + 12\\binom{r-1}{1} + 6\\binom{r-2}{2} + \\binom{r-3}{3} $$\n面支撑自由度首次出现的最小阶数是 $r_{\\text{face}} = 4$。\n单元内部支撑自由度首次出现的最小阶数是 $r_{\\text{cell}} = 6$。\n\n将这些结果组合成所要求的行矩阵格式，我们得到：\n$$\n\\begin{pmatrix}\n8 + 12\\binom{r-1}{1} + 6\\binom{r-2}{2} + \\binom{r-3}{3}  4  6\n\\end{pmatrix}\n$$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n8 + 12\\binom{r-1}{1} + 6\\binom{r-2}{2} + \\binom{r-3}{3}  4  6\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "一个有限元空间的理论定义必须转化为一组实际可操作的自由度（DOFs），才能在计算机上实现。这组自由度（如节点值或矩）必须是“单值求解”（unisolvent）的，即它们能唯一地确定空间中的任何一个函数。这个练习要求你基于我们之前探讨过的分层结构，为三维意外单元挑选出正确的自由度“配方”，从而将抽象的多项式空间与具体的有限元实现联系起来。",
            "id": "3442392",
            "problem": "考虑参考六面体 $K=[-1,1]^3$ 上次数为 $r\\ge 1$ 的标量、协调 serendipity 有限元族，其 serendipity 空间记为 $S_r(K)$。一个基于超线性次数的几何分解的标准定义是，$S_r(K)$ 由单项式的超线性次数至多为 $r$ 的多项式组成，其在每条边上的迹位于一维多项式空间 $P_r$ 中，而在每个面上的迹位于正方形上的二维 serendipity 空间 $S_r$ 中。此处，$P_m(F)$ 表示在适当维度的实体 $F$ 上定义的总次数至多为 $m$ 的多项式空间，并约定当 $m0$ 时 $P_m(F)=\\{0\\}$。如果映射 $u\\mapsto$ (所有泛函作用于 $u$ 得到的值) 是从 $S_r(K)$ 到某个 $N$ 维空间 $\\mathbb{R}^N$ 的双射，则称一组线性泛函（自由度）对于 $S_r(K)$ 是单值可解的。这尤其要求该映射是单射的，且 $N=\\dim S_r(K)$。在意外单元设定中，标准的做法是使用顶点值以及在边、面和单元体上的多项式矩，这些矩乘以适当的泡函数因子，以将自由度局部化到每个子实体并保持迹的性质。\n\n令 $b_e$、$b_f$ 和 $b_K$ 分别表示边 $e$、面 $f$ 和单元体 $K$ 上的典范泡函数，定义为：对于边参数 $s\\in[-1,1]$，$b_e(s)=1-s^2$；对于由 $(\\xi,\\eta)\\in[-1,1]^2$ 参数化的面，$b_f(\\xi,\\eta)=(1-\\xi^2)(1-\\eta^2)$；以及在 $K$上，$b_K(x,y,z)=(1-x^2)(1-y^2)(1-z^2)$。对于每个 $m\\in\\mathbb{Z}$ 和实体 $F$，记 $b_F P_m(F):=\\{b_F q:q\\in P_m(F)\\}$。\n\n对于所有的 $r\\ge 1$，下列哪一个集合是 $S_r(K)$ 的一组单值可解的自由度？\n\nA. 所有 $8$ 个顶点的顶点值；对于 $12$ 条边中的每条边 $e$，所有的矩 $\\int_e u\\,b_e\\,p\\,\\mathrm{d}s$（其中 $p\\in P_{r-2}(e)$）；对于 $6$ 个面中的每个面 $f$，所有的矩 $\\int_f u\\,b_f\\,q\\,\\mathrm{d}S$（其中 $q\\in P_{r-4}(f)$）；以及在 $K$ 上，所有的矩 $\\int_K u\\,b_K\\,r\\,\\mathrm{d}V$（其中 $r\\in P_{r-6}(K)$），并约定如果某个下标为负，则对应的集合为空。\n\nB. 所有 $8$ 个顶点的顶点值；对于每条边 $e$，所有的矩 $\\int_e u\\,b_e\\,p\\,\\mathrm{d}s$（其中 $p\\in P_{r-2}(e)$）；对于每个面 $f$，所有的矩 $\\int_f u\\,b_f\\,q\\,\\mathrm{d}S$（其中 $q\\in P_{r-3}(f)$）；以及在 $K$ 上，所有的矩 $\\int_K u\\,b_K\\,r\\,\\mathrm{d}V$（其中 $r\\in P_{r-4}(K)$），并遵循关于负下标的相同约定。\n\nC. 所有 $8$ 个顶点的顶点值；对于每条边 $e$，所有的矩 $\\int_e u\\,b_e\\,p\\,\\mathrm{d}s$（其中 $p\\in P_{r-2}(e)$）；对于每个面 $f$，所有的矩 $\\int_f u\\,b_f\\,q\\,\\mathrm{d}S$（其中 $q\\in Q_{r-3}(f)$，此处 $Q_m$ 表示每个变量的次数至多为 $m$ 的张量积多项式）；以及在 $K$ 上，所有的矩 $\\int_K u\\,b_K\\,r\\,\\mathrm{d}V$（其中 $r\\in Q_{r-6}(K)$）。\n\nD. 所有 $8$ 个顶点的顶点值；对于每条边 $e$，所有的矩 $\\int_e u\\,b_e\\,p\\,\\mathrm{d}s$（其中 $p\\in P_{r-3}(e)$）；对于每个面 $f$，所有的矩 $\\int_f u\\,b_f\\,q\\,\\mathrm{d}S$（其中 $q\\in P_{r-4}(f)$）；以及在 $K$ 上，所有的矩 $\\int_K u\\,b_K\\,r\\,\\mathrm{d}V$（其中 $r\\in P_{r-6}(K)$）。",
            "solution": "### 步骤 1：提取已知条件\n-   **单元类型**：标量、协调意外有限元。\n-   **多项式次数**：$r \\ge 1$。\n-   **区域**：参考六面体 $K = [-1,1]^3$。\n-   **空间记法**：$S_r(K)$。\n-   **空间性质**：\n    -   $u \\in S_r(K)$ 在任意边上的迹属于 $P_r$。\n    -   $u \\in S_r(K)$ 在任意面上的迹属于二维意外单元空间 $S_r$。\n-   **自由度 (DoFs)**：如果从 $u \\in S_r(K)$ 到其自由度值向量的映射是到 $\\mathbb{R}^N$ 的一个双射（其中 $N=\\dim S_r(K)$），则称一组线性泛函對於 $S_r(K)$ 是单值可解的。\n-   **泡函数**：\n    -   边：$b_e(s)=1-s^2$。\n    -   面：$b_f(\\xi,\\eta)=(1-\\xi^2)(1-\\eta^2)$。\n    -   单元体：$b_K(x,y,z)=(1-x^2)(1-y^2)(1-z^2)$。\n-   **多项式空间**：\n    -   $P_m(F)$：在实体 $F$ 上总次数至多为 $m$ 的多项式。\n    -   $Q_m(F)$：在实体 $F$ 上每个变量次数至多为 $m$ 的张量积多项式。\n-   **约定**：如果多项式空间 $P_m$ 或 $Q_m$ 的下标 $m$ 为负，则该空间为 $\\{0\\}$，且对应的自由度集合为空。\n-   **组合学**：六面体有 $8$ 个顶点、$12$ 条边和 $6$ 个面。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题陈述在有限元方法理论中有坚实的科学基础。其中定义和概念，如意外单元、单值可解性、泡函数和基于矩的自由度，都是该领域的标准内容。问题通过指定空间 $S_r(K)$ 的迹性质来支持其定义，这是表征有限元空间的一种常用方法。这些迹性质与意外单元的一种著名的分层构造相符。该问题是适定的 (well-posed)，因为可以从这些原理中推导出唯一答案。语言客观、精确。问题是自洽的，没有矛盾。\n\n### 步骤 3：结论与行动\n问题陈述有效。我将继续进行求解。\n\n### 基于原理的推导\n一组自由度 (DoFs) 对于一个有限元空间是单值可解的，如果它能唯一确定该空间内的任何函数。对于包含意外单元的分层有限元族，空间 $S_r(K)$ 被构造为与单元 $K$ 的几何实体（顶点、边、面及单元体内部）相关联的子空间的直和。一个单值可解的自由度集合很自然地通过定义能够分离并确定函数在每个子空间中的分量的泛函来构造。\n\n空间 $S_r(K)$ 可以分解为：\n$$S_r(K) = \\mathcal{V}_{\\text{vtx}} \\oplus \\left( \\bigoplus_{e \\in \\text{edges}(K)} \\mathcal{V}_{e} \\right) \\oplus \\left( \\bigoplus_{f \\in \\text{faces}(K)} \\mathcal{V}_{f} \\right) \\oplus \\mathcal{V}_{K}$$\n其中每个子空间中的函数在其他实体的边界上具有特定的零值性质。我们逐一分析每个分量：\n\n1.  **顶点分量 ($\\mathcal{V}_{\\text{vtx}}$)**：这是最低阶的空间，由其自由度为六面体顶点值的函数组成。对于 $r \\ge 1$，该分量由 $8$ 个三线性基函数张成，构成空间 $Q_1(K)$。对应的自由度是 $8$ 个顶点的函数值。所有选项都正确地包含了这些自由度。\n\n2.  **边分量 ($\\mathcal{V}_{e}$)**：对于 $12$ 条边中的每一条，我们必须定义能够确定“边模式”的自由度。边模式是 $S_r(K)$ 中在所有顶点处为零的函数。问题陈述中提到，任何 $u \\in S_r(K)$ 在边 $e$ 上的迹都是次数至多为 $r$ 的一维多项式，即 $u|_e \\in P_r(e)$。顶点值确定了该迹的线性部分。剩余部分是一个次数至多为 $r$ 且在该边两个端点处为零的多项式。这类多项式的空间恰好是 $b_e P_{r-2}(e)$，其中 $b_e$ 是边泡函数（次数为2）。为了唯一确定该空间中的一个函数，我们需要 $\\dim(P_{r-2}(e)) = (r-2)+1 = r-1$ 个线性泛函。标准的选择是与 $P_{r-2}(e)$ 的一组基作矩，并由泡函数本身加权以确保局部性：\n    $$ \\int_e u \\, b_e \\, p \\, \\mathrm{d}s \\quad \\forall p \\in P_{r-2}(e) $$\n    这为 $r \\ge 2$ 定义了 $12(r-1)$ 个自由度。对于 $r=1$，下标为负，因此有 $0$ 个边自由度，这是正确的。\n\n3.  **面分量 ($\\mathcal{V}_{f}$)**：对于 $6$ 个面中的每一个，我们需要为面模式定义自由度。这些是在 $K$ 的所有边上为零的函数。它们在面 $f$ 上的迹必须在边界 $\\partial f$ 上为零。这类面模式的空间，当限制在面 $f$ 上时，由乘以面泡函数 $b_f(\\xi, \\eta) = (1-\\xi^2)(1-\\eta^2)$ 的多项式张成。泡函数 $b_f$ 是一个总次数为 $4$ 的多项式。在标准的分层（意外）构造中，$f$ 上的面模式空间是 $b_f P_{r-4}(f)$。对于 $r \\ge 4$，其维数为 $\\dim(P_{r-4}(f)) = \\frac{((r-4)+2)((r-4)+1)}{2} = \\frac{(r-2)(r-3)}{2}$。对应的自由度是矩：\n    $$ \\int_f u \\, b_f \\, q \\, \\mathrm{d}S \\quad \\forall q \\in P_{r-4}(f) $$\n    这为 $r \\ge 4$ 定义了 $6 \\times \\frac{(r-2)(r-3)}{2} = 3(r-2)(r-3)$ 个面自由度。对于 $r4$，下标为负，得到 $0$ 个面自由度。\n\n4.  **单元体分量 ($\\mathcal{V}_{K}$)**：最后，单元体或内部模式是在整个边界 $\\partial K$ 上为零的函数。这些是使用单元体泡函数 $b_K(x,y,z)=(1-x^2)(1-y^2)(1-z^2)$ 构造的，其总次数为 $6$。内部模式的空间是 $b_K P_{r-6}(K)$。对于 $r \\ge 6$，其维数为 $\\dim(P_{r-6}(K)) = \\frac{((r-6)+3)((r-6)+2)((r-6)+1)}{6} = \\frac{(r-3)(r-4)(r-5)}{6}$。自由度是矩：\n    $$ \\int_K u \\, b_K \\, r \\, \\mathrm{d}V \\quad \\forall r \\in P_{r-6}(K) $$\n    对于 $r6$，没有内部自由度。\n\n這種分层构造为 $S_r(K)$ 定义了一组基，以及一组对应的对偶基泛函（即自由度），它们构成了一个单值可解集。因此，自由度的集合是：\n-   $8$ 个顶点值。\n-   对于 $12$ 条边中的每条边 $e$，与所有 $p \\in P_{r-2}(e)$ 的 $b_e p$ 作矩。\n-   对于 $6$ 个面中的每个面 $f$，与所有 $q \\in P_{r-4}(f)$ 的 $b_f q$ 作矩。\n-   对于单元体 $K$，与所有 $r \\in P_{r-6}(K)$ 的 $b_K r$ 作矩。\n\n这个集合与选项 A 中的描述完全匹配。\n\n### 逐项分析\n\n**A. 所有 $8$ 个顶点的顶点值；对于 $12$ 条边中的每条边 $e$，所有的矩 $\\int_e u\\,b_e\\,p\\,\\mathrm{d}s$（其中 $p\\in P_{r-2}(e)$）；对于 $6$ 个面中的每个面 $f$，所有的矩 $\\int_f u\\,b_f\\,q\\,\\mathrm{d}S$（其中 $q\\in P_{r-4}(f)$）；以及在 $K$ 上，所有的矩 $\\int_K u\\,b_K\\,r\\,\\mathrm{d}V$（其中 $r\\in P_{r-6}(K)$），并约定如果某个下标为负，则对应的集合为空。**\n\n此选项精确地匹配了上面推导的六面体上意外有限元族的典范分层自由度构造。多项式空间（$P_{r-2}$、$P_{r-4}$、$P_{r-6}$）是正确的，反映了相应泡函数的次数（$2$、$4$、$6$）。\n\n**结论：正确。**\n\n**B. 所有 $8$ 个顶点的顶点值；对于每条边 $e$，所有的矩 $\\int_e u\\,b_e\\,p\\,\\mathrm{d}s$（其中 $p\\in P_{r-2}(e)$）；对于每个面 $f$，所有的矩 $\\int_f u\\,b_f\\,q\\,\\mathrm{d}S$（其中 $q\\in P_{r-3}(f)$）；以及在 $K$ 上，所有的矩 $\\int_K u\\,b_K\\,r\\,\\mathrm{d}V$（其中 $r\\in P_{r-4}(K)$），并遵循关于负下标的相同约定。**\n\n此选项对面和单元体矩使用了错误的多项式空间。对于面矩，使用 $q\\in P_{r-3}(f)$ 对应于面函数空间 $b_f P_{r-3}(f)$。此空间中函数的总次数最高可达 $\\deg(b_f) + \\deg(q) = 4 + (r-3) = r+1$。这通常会违反空间 $S_r(K)$ 的次数约束。同样的逻辑适用于单元体矩，其中 $r\\in P_{r-4}(K)$，其次数最高可达 $\\deg(b_K) + \\deg(r) = 6 + (r-4) = r+2$。多项式次数的减法必须与相应泡函数的总次数相匹配。\n\n**结论：不正确。**\n\n**C. 所有 $8$ 个顶点的顶点值；对于每条边 $e$，所有的矩 $\\int_e u\\,b_e\\,p\\,\\mathrm{d}s$（其中 $p\\in P_{r-2}(e)$）；对于每个面 $f$，所有的矩 $\\int_f u\\,b_f\\,q\\,\\mathrm{d}S$（其中 $q\\in Q_{r-3}(f)$，此处 $Q_m$ 表示每个变量的次数至多为 $m$ 的张量积多项式）；以及在 $K$ 上，所有的矩 $\\int_K u\\,b_K\\,r\\,\\mathrm{d}V$（其中 $r\\in Q_{r-6}(K)$）。**\n\n此选项错误地对面和单元体矩使用了张量积多项式空间 ($Q_m$)。意外单元是专门设计来使用总次数多项式空间 ($P_m$) 的，以减少与完全张量积单元（$Q_r$ 族）相比的自由度数量。混合这些构造与意外单元族的定义不一致。此外，如对选项 B 的讨论，次数下标（面的 $r-3$）也是不正确的。\n\n**结论：不正确。**\n\n**D. 所有 $8$ 个顶点的顶点值；对于每条边 $e$，所有的矩 $\\int_e u\\,b_e\\,p\\,\\mathrm{d}s$（其中 $p\\in P_{r-3}(e)$）；对于每个面 $f$，所有的矩 $\\int_f u\\,b_f\\,q\\,\\mathrm{d}S$（其中 $q\\in P_{r-4}(f)$）；以及在 $K$ 上，所有的矩 $\\int_K u\\,b_K\\,r\\,\\mathrm{d}V$（其中 $r\\in P_{r-6}(K)$）。**\n\n此选项在边自由度上就出错了。它建议使用 $p \\in P_{r-3}(e)$ 的矩。对于 $r \\ge 3$，该空间的维数为 $r-2$。然而，如推导中所述，为了确定迹在 $b_e P_{r-2}(e)$ 中的分量，我们需要 $\\dim(P_{r-2}(e)) = r-1$ 个泛函。使用 $P_{r-3}(e)$ 提供的自由度数量不足以确保对于任何 $r \\ge 2$ 的边模式都是单值可解的。例如，当 $r=2$ 时，此选项建议 $p \\in P_{-1}(e)$，意味着 $0$ 个边矩，而正确的数量是 $12 \\times (2-1)=12$。\n\n**结论：不正确。**",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}