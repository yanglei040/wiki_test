{
    "hands_on_practices": [
        {
            "introduction": "The efficiency of serendipity elements comes from a clever reduction in the number of basis functions compared to their tensor-product counterparts. This is achieved by carefully selecting which monomials are included in the basis. This first exercise  provides direct practice with one such selection rule, based on a hypothetical \"superlinear degree,\" helping you to build a concrete understanding of how these polynomial spaces are constructed from their fundamental building blocks.",
            "id": "3442379",
            "problem": "Consider the serendipity finite element space on the reference square $\\hat K=[-1,1]^2$. For a monomial $m(x,y)=x^{\\alpha}y^{\\beta}$ with nonnegative integers $\\alpha$ and $\\beta$, define its superlinear degree $\\operatorname{sldeg}(m)$ by\n$$\n\\operatorname{sldeg}(x^{\\alpha}y^{\\beta})=\\sum_{v\\in\\{\\alpha,\\beta\\}\\,:\\,v\\ge 2} v.\n$$\nFor a polynomial $p(x,y)=\\sum_{\\alpha,\\beta\\ge 0} c_{\\alpha\\beta} x^{\\alpha}y^{\\beta}$, define its superlinear degree by\n$$\n\\operatorname{sldeg}(p)=\\max\\{\\operatorname{sldeg}(x^{\\alpha}y^{\\beta}) \\,:\\, c_{\\alpha\\beta}\\ne 0\\}.\n$$\nThe serendipity space of order $r$, denoted $S_r(\\hat K)$, is the space of all polynomials $p$ on $\\hat K$ with $\\operatorname{sldeg}(p)\\le r$.\n\nDetermine the smallest integer $r$ such that the monomial $x^2y^2$ lies in $S_r(\\hat K)$, and justify your answer directly from the definition of the superlinear degree. Your final answer must be a single integer.",
            "solution": "The task is to determine the smallest integer $r$ for which the monomial $p(x,y) = x^2y^2$ is an element of the serendipity space $S_r(\\hat K)$.\n\nThe definition of the serendipity space $S_r(\\hat K)$ provided in the problem is the set of all polynomials $p$ on the reference square $\\hat K$ whose superlinear degree, $\\operatorname{sldeg}(p)$, is less than or equal to $r$. The condition for a polynomial $p$ to belong to $S_r(\\hat K)$ is therefore:\n$$\n\\operatorname{sldeg}(p) \\le r.\n$$\nThe polynomial under consideration is the single monomial $p(x,y) = x^2y^2$. The superlinear degree of a polynomial is defined as the maximum of the superlinear degrees of its constituent monomials. Since our polynomial consists of only one term, its superlinear degree is the superlinear degree of that monomial:\n$$\n\\operatorname{sldeg}(x^2y^2) = \\max\\{\\operatorname{sldeg}(x^2y^2)\\} = \\operatorname{sldeg}(x^2y^2).\n$$\nWe must now calculate the superlinear degree of the monomial $x^2y^2$ using the given formula. The monomial is of the form $x^{\\alpha}y^{\\beta}$, with exponents $\\alpha=2$ and $\\beta=2$. The definition for the superlinear degree of a monomial is:\n$$\n\\operatorname{sldeg}(x^{\\alpha}y^{\\beta})=\\sum_{v\\in\\{\\alpha,\\beta\\}\\,:\\,v\\ge 2} v.\n$$\nThis formula directs us to sum the values of the exponents $\\alpha$ and $\\beta$ if and only if their value is greater than or equal to $2$.\n\nLet's apply this rule to the exponents of $x^2y^2$, which are $\\alpha=2$ and $\\beta=2$.\n1.  We check the exponent $\\alpha=2$. Since $2 \\ge 2$ is true, the value of $\\alpha$, which is $2$, is included in the summation.\n2.  We check the exponent $\\beta=2$. Since $2 \\ge 2$ is true, the value of $\\beta$, which is $2$, is also included in the summation.\n\nThe set of exponents to be summed is thus $\\{2, 2\\}$. The superlinear degree is the sum of these values:\n$$\n\\operatorname{sldeg}(x^2y^2) = 2 + 2 = 4.\n$$\nHaving found the superlinear degree of $x^2y^2$, we can now establish the condition for this monomial to be in $S_r(\\hat K)$. The condition is $\\operatorname{sldeg}(x^2y^2) \\le r$. Substituting our calculated value, we obtain the inequality:\n$$\n4 \\le r.\n$$\nThe problem asks for the smallest integer $r$ that satisfies this inequality. The set of integers satisfying $r \\ge 4$ is $\\{4, 5, 6, \\dots\\}$. The smallest integer in this set is $4$.\n\nThus, the smallest integer $r$ such that $x^2y^2$ lies in $S_r(\\hat K)$ is $4$.",
            "answer": "$$\\boxed{4}$$"
        },
        {
            "introduction": "A crucial step in any finite element analysis is the assembly process, where local element matrices are combined into a single global system. For the solution to be mathematically valid in $H^1$, it must be continuous across element boundaries, a property known as $C^0$ conformity. This practical exercise  challenges you to think like a software developer and devise a robust local-to-global mapping strategy for midside nodes, a common source of error in implementing higher-order elements on unstructured meshes.",
            "id": "3558271",
            "problem": "Consider a scalar elliptic boundary value problem representative of quasi-static geomechanics, posed in the Sobolev space $H^1(\\Omega)$, and discretized by the Finite Element Method (FEM). Let the trial space be assembled from isoparametric serendipity quadrilateral elements of order $S_2$ (commonly denoted $Q8$), with $8$ nodal Degrees of Freedom (DOF) per element: $4$ vertex nodes and $4$ midside nodes. The element mapping is from the bi-unit square $\\hat{\\Omega} = [-1,1]^2$ with a conventional local node ordering: corners $1:(-1,-1)$, $2:(1,-1)$, $3:(1,1)$, $4:(-1,1)$, and midsides $5:(0,-1)$, $6:(1,0)$, $7:(0,1)$, $8:(-1,0)$. Two adjacent elements $e_1$ and $e_2$ share a physical edge, but their local edge orientations may be opposite due to their individual reference-to-physical mappings (e.g., $e_2$ may be rotated or reflected with respect to $e_1$).\n\nFrom first principles, recall that for conforming $C^0$ Lagrangian interpolation in $H^1(\\Omega)$, the trace of any discrete function on a shared interior edge must be single-valued. In matrix form, global assembly implements this by summing elemental contributions via a local-to-global incidence (or scatter) matrix $\\mathbf{A}_e$, so that the global stiffness is $\\mathbf{K} = \\sum_{e} \\mathbf{A}_e^\\top \\mathbf{K}_e \\mathbf{A}_e$. A correct local-to-global DOF map must therefore identify and merge coincident geometric DOFs across elements, including midside nodes on shared edges, in an orientation-robust way.\n\nWhich of the following local-to-global DOF mapping strategies both guarantees $C^0$ edge continuity for $S_2$ quadrilateral elements on arbitrary unstructured meshes and avoids assembly errors, and which incorrect strategies would violate the conformity requirement or corrupt the assembled operator? Choose the single best option.\n\nA. For each mesh edge with global endpoint vertex IDs $(I,J)$, define a canonical orientation by the ordered pair with $I<J$. Build a unique global edge record keyed by the unordered set $\\{I,J\\}$ with a single global midside DOF. For any element $e$ and a local edge with endpoint local vertex IDs $(i_\\ell,j_\\ell)$ that map to $(I,J)$ (possibly with reversed order), map the local edge DOFs to the global edge DOFs in forward order $(I,\\text{mid},J)$ if the local orientation is $(i_\\ell\\to j_\\ell)$ corresponding to $(I\\to J)$, and in reversed order $(J,\\text{mid},I)$ if the local orientation is $(i_\\ell\\to j_\\ell)$ corresponding to $(J\\to I)$. This preserves a single-valued trace on the shared edge and passes the linear patch test; incorrect mappings would otherwise duplicate midside DOFs and introduce interelement jumps that degrade convergence.\n\nB. Merge only the $4$ corner DOFs by matching coincident vertices globally; assign independent global indices to all $4$ midside DOFs per element. This leaves more flexibility per edge and avoids orientation issues; any loss of accuracy is negligible because midside nodes primarily improve interpolation inside elements.\n\nC. Let the first element that touches an edge define the ordered global edge DOF triplet $(I,\\text{mid},J)$ using its local orientation. Any subsequent element that shares this edge maps its local edge DOFs in the same local order $(i_\\ell,\\text{mid},j_\\ell)$ to $(I,\\text{mid},J)$ without checking whether its local edge orientation is reversed. This keeps a consistent global ordering and avoids extra data structures; any mismatch in local orientation is harmless for scalar nodal elements.\n\nD. Switch to hierarchical edge modes with odd parity and apply sign flips when an edge is traversed in the opposite direction; for serendipity elements, keep midside DOFs distinct per element to avoid ambiguity. The continuity along edges is then enforced weakly during assembly, eliminating the need to merge midside DOFs explicitly.\n\nYour answer should be based on the variational requirement for $H^1(\\Omega)$ conformity and the definition of the assembled operator $\\mathbf{K}$, not on ad hoc rules of thumb. Explain how an incorrect mapping leads to a nonconforming trace or to a corrupted $\\mathbf{A}_e$ that fails the patch test or produces spurious modes in the global system.",
            "solution": "The problem statement is subjected to validation before proceeding to a solution.\n\n### Step 1: Extract Givens\n-   **Problem Domain:** A scalar elliptic boundary value problem representative of quasi-static geomechanics.\n-   **Function Space:** The solution is sought in the Sobolev space $H^1(\\Omega)$.\n-   **Numerical Method:** The problem is discretized using the Finite Element Method (FEM).\n-   **Element Type:** The trial space is constructed from isoparametric serendipity quadrilateral elements of order $S_2$ (denoted $Q8$).\n-   **Degrees of Freedom (DOF):** Each element has $8$ nodal DOFs: $4$ at the vertices and $4$ at the midsides.\n-   **Reference Element:** The mapping is from the bi-unit square $\\hat{\\Omega} = [-1,1]^2$.\n-   **Local Node Ordering:** A conventional ordering is specified for nodes $1$ through $8$ on the reference element.\n-   **Mesh Configuration:** Arbitrary unstructured meshes are considered, where adjacent elements $e_1$ and $e_2$ sharing an edge may have opposite local orientations for that edge.\n-   **Conformity Requirement:** For a conforming discretization in $H^1(\\Omega)$, the trace of any discrete function must be single-valued on any shared interior edge. This requires $C^0$ continuity of the global solution.\n-   **Assembly Process:** The global stiffness matrix $\\mathbf{K}$ is assembled from elemental stiffness matrices $\\mathbf{K}_e$ using the formula $\\mathbf{K} = \\sum_{e} \\mathbf{A}_e^\\top \\mathbf{K}_e \\mathbf{A}_e$, where $\\mathbf{A}_e$ is the local-to-global incidence matrix (or map).\n-   **Task:** Identify the local-to-global DOF mapping strategy that guarantees $C^0$ edge continuity for $S_2$ elements on arbitrary unstructured meshes.\n\n### Step 2: Validate Using Extracted Givens\nThe problem statement is scientifically sound, well-posed, and objective.\n-   **Scientifically Grounded:** All concepts—$H^1(\\Omega)$ Sobolev space, $C^0$ continuity, FEM, $Q8$ serendipity elements, and the assembly process—are standard and fundamental in the field of computational mechanics and numerical analysis for PDEs.\n-   **Well-Posed:** The problem is clearly defined. It asks for the correct procedure to ensure conformity in a standard FEM implementation, a problem which has a unique and established solution.\n-   **Objective:** The terminology is precise and technical, free of ambiguity or subjectivity. It describes a concrete challenge in FEM software development.\n-   **Completeness:** The problem provides all necessary information to understand the context and the requirement: the function space, the element type, and the continuity condition that must be satisfied.\n-   **No Flaws Detected:** The problem does not violate any of the invalidity criteria. It is a valid and well-formulated question on a core concept of the Finite Element Method.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A full derivation and analysis will be performed.\n\n### Derivation from First Principles\nThe requirement that the finite element solution $u_h$ belongs to a subspace of $H^1(\\Omega)$ is central. For piecewise polynomial trial functions, a sufficient condition to be in $H^1(\\Omega)$ is that the function is globally continuous, i.e., $u_h \\in C^0(\\bar{\\Omega})$. This is known as $C^0$-conformity.\n\nFor a Lagrangian element, the value of the function $u_h$ is defined by its values at the nodes. The function within an element $e$ is given by $u_h(\\mathbf{x}) = \\sum_{a=1}^{N_{dof}} N_a(\\mathbf{x}) d_a^e$, where $N_a$ are the shape functions and $d_a^e$ are the local nodal DOF values.\n\nConsider an edge $\\Gamma_{12}$ shared by two elements, $e_1$ and $e_2$. The trace of $u_h$ on this edge is the restriction of the function to the edge. For a $Q8$ (serendipity $S_2$) element, the basis is quadratic. The shape function restriction to an edge is a 1D quadratic polynomial uniquely defined by the values at the $3$ nodes on that edge: the two endpoint vertices and the midside node.\n\nLet the shared edge connect global vertices $I$ and $J$. Let the midside point be $M$.\nFor the trace of $u_h$ to be single-valued on $\\Gamma_{12}$, the quadratic function describing the solution along that edge must be identical when evaluated from either element $e_1$ or $e_2$. Since this quadratic function is uniquely determined by the nodal values at $I$, $J$, and $M$, conformity requires that:\n1.  The DOF associated with vertex $I$ is the same for both elements.\n2.  The DOF associated with vertex $J$ is the same for both elements.\n3.  The DOF associated with the midside node $M$ is the same for both elements.\n\nPoints 1 and 2 are typically handled by creating a global list of vertex DOFs and mapping element vertices to them based on geometric coincidence. The critical part for higher-order elements is point 3. A robust implementation must ensure that there is only one global DOF associated with the physical point $M$, regardless of which element is processed first or what the local orientation of the edge is within each element.\n\nThe local-to-global assembly map $\\mathbf{A}_e$ for each element $e$ must be constructed such that if local node $a$ in element $e_1$ and local node $b$ in element $e_2$ correspond to the same physical node (e.g., node $M$), then they must be mapped to the same global DOF index. Failure to do so creates two independent DOFs at the same physical location, allowing a discontinuity (a \"jump\") in the solution across the edge. This violates $C^0$ continuity, making the method non-conforming ($u_h \\notin H^1(\\Omega)$), which typically leads to a failure of the patch test and suboptimal convergence rates.\n\nThe most robust way to achieve this is to create a unique identifier for each edge in the mesh. An identifier based on the unordered pair of its global vertex indices, $\\{I, J\\}$, is independent of orientation. This unique edge identifier can then be used as a key to store or retrieve the unique global DOF index assigned to its midside node. When assembling any element, one finds the global vertices $\\{I, J\\}$ of a local edge, looks up the unique global midside DOF for that edge, and writes this into the element's local-to-global map $\\mathbf{A}_e$.\n\n### Option-by-Option Analysis\n\n**A. For each mesh edge with global endpoint vertex IDs $(I,J)$, define a canonical orientation by the ordered pair with $I<J$. Build a unique global edge record keyed by the unordered set $\\{I,J\\}$ with a single global midside DOF. For any element $e$ and a local edge with endpoint local vertex IDs $(i_\\ell,j_\\ell)$ that map to $(I,J)$ (possibly with reversed order), map the local edge DOFs to the global edge DOFs in forward order $(I,\\text{mid},J)$ if the local orientation is $(i_\\ell\\to j_\\ell)$ corresponding to $(I\\to J)$, and in reversed order $(J,\\text{mid},I)$ if the local orientation is $(i_\\ell\\to j_\\ell)$ corresponding to $(J\\to I)$. This preserves a single-valued trace on the shared edge and passes the linear patch test; incorrect mappings would otherwise duplicate midside DOFs and introduce interelement jumps that degrade convergence.**\n\nThis option correctly identifies the core requirement: creating a unique global identity for the midside DOF on each edge, independent of orientation. The key mechanism is to use the unordered set of vertex IDs $\\{I,J\\}$ to uniquely identify the edge. This ensures that any element sharing this edge, regardless of its local edge traversal direction, will be mapped to the same single global midside DOF. The language about \"forward order\" and \"reversed order\" might be slightly confusing for nodal elements (it is more critical for certain hierarchical or vector elements), but it describes the necessary process of correctly mapping the local vertex DOFs to their global counterparts ($i_\\ell \\to I$, $j_\\ell \\to J$ or $i_\\ell \\to J$, $j_\\ell \\to I$) while correctly mapping the local midside DOF to the unique global midside DOF associated with $\\{I,J\\}$. The consequences described—preserving the single-valued trace and passing the patch test—are the correct outcomes of this valid procedure.\n\n**Verdict: Correct**\n\n**B. Merge only the $4$ corner DOFs by matching coincident vertices globally; assign independent global indices to all $4$ midside DOFs per element. This leaves more flexibility per edge and avoids orientation issues; any loss of accuracy is negligible because midside nodes primarily improve interpolation inside elements.**\n\nThis strategy explicitly violates the conformity requirement. By assigning independent global indices to the midside DOF of each element, a shared edge between elements $e_1$ and $e_2$ will have two distinct global DOFs at its midpoint. This allows the solution to be discontinuous across the inter-element boundary. The restriction of the solution to the edge from $e_1$ is a quadratic polynomial determined by the nodal values $(d_I, d_J, d_{mid}^{(1)})$, while from $e_2$ it is determined by $(d_I, d_J, d_{mid}^{(2)})$. Since $d_{mid}^{(1)}$ and $d_{mid}^{(2)}$ are independent, the traces are generally different. This constitutes a non-conforming method. The claim that the loss of accuracy is \"negligible\" is false; non-conformity is a serious error that degrades convergence and can lead to physically meaningless results.\n\n**Verdict: Incorrect**\n\n**C. Let the first element that touches an edge define the ordered global edge DOF triplet $(I,\\text{mid},J)$ using its local orientation. Any subsequent element that shares this edge maps its local edge DOFs in the same local order $(i_\\ell,\\text{mid},j_\\ell)$ to $(I,\\text{mid},J)$ without checking whether its local edge orientation is reversed. This keeps a consistent global ordering and avoids extra data structures; any mismatch in local orientation is harmless for scalar nodal elements.**\n\nThis approach is fundamentally flawed and would lead to a catastrophic assembly error. Suppose element $e_1$ defines the mapping for the edge with physical vertices $(I, J)$. If element $e_2$ is oriented oppositely, its local edge vertices $(k_\\ell, m_\\ell)$ correspond to physical vertices $(J, I)$. This option proposes mapping the local DOF at $k_\\ell$ (physically at $J$) to the global DOF for vertex $I$, and the local DOF at $m_\\ell$ (physically at $I$) to the global DOF for vertex $J$. This scrambles the connectivity of the mesh, incorrectly coupling degrees of freedom. The resulting global stiffness matrix $\\mathbf{K}$ would be corrupted and would not represent the intended physical problem. The assertion that this mismatch is \"harmless\" is profoundly incorrect.\n\n**Verdict: Incorrect**\n\n**D. Switch to hierarchical edge modes with odd parity and apply sign flips when an edge is traversed in the opposite direction; for serendipity elements, keep midside DOFs distinct per element to avoid ambiguity. The continuity along edges is then enforced weakly during assembly, eliminating the need to merge midside DOFs explicitly.**\n\nThis option incorrectly conflates several different FEM concepts. The problem is explicitly about standard nodal serendipity ($S_2$) elements, not hierarchical elements. While hierarchical bases are a valid alternative formulation where basis functions are associated with topological entities (vertices, edges, faces) and orientation-dependent sign flips are used, this is not a solution to the stated problem of assembling nodal elements. Furthermore, the suggestion to \"keep midside DOFs distinct\" is the same non-conforming approach as in Option B. Finally, enforcing continuity \"weakly\" implies a method like Discontinuous Galerkin (DG), which involves a different variational formulation (with penalty or flux terms) and is not the standard conforming Galerkin method implied by the problem statement. This option does not provide a valid mapping strategy for the problem as posed.\n\n**Verdict: Incorrect**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "While serendipity elements reduce the number of degrees of freedom, it is essential to analyze how this choice affects the properties of the resulting linear system. A poorly conditioned system can be difficult and slow to solve, potentially negating the benefits of having fewer unknowns. This final practice  delves into the numerical analysis of the method, guiding you to derive the asymptotic scaling of the stiffness matrix condition number and revealing important trade-offs between element complexity and numerical stability.",
            "id": "3442374",
            "problem": "Consider the homogeneous Dirichlet boundary value problem for the Poisson equation on a bounded, connected, Lipschitz domain $\\Omega \\subset \\mathbb{R}^{2}$, with bilinear form $a(u,v) = \\int_{\\Omega} \\nabla u \\cdot \\nabla v \\, dx$ and $L^{2}$ inner product $(u,v) = \\int_{\\Omega} u v \\, dx$. Let $\\mathcal{T}_{h}$ be a quasiuniform family of shape-regular quadrilateral meshes of mesh size $h$, and let $V_{h}^{S_{r}} \\subset H_{0}^{1}(\\Omega)$ denote the conforming serendipity space of order $r \\in \\mathbb{N}$ on $\\mathcal{T}_{h}$, assembled in the standard way from elementwise mapped serendipity shape functions. Let $K_{h} \\in \\mathbb{R}^{N \\times N}$ and $M_{h} \\in \\mathbb{R}^{N \\times N}$ be the global stiffness and mass matrices corresponding to $a(\\cdot,\\cdot)$ and $(\\cdot,\\cdot)$, respectively, in any fixed nodal basis of $V_{h}^{S_{r}}$.\n\nDefine the generalized spectral condition number\n$$\n\\kappa\\big(M_{h}^{-1}K_{h}\\big) \\;=\\; \\frac{\\lambda_{\\max}(K_{h},M_{h})}{\\lambda_{\\min}(K_{h},M_{h})}\n\\;=\\; \\frac{\\displaystyle \\sup_{0 \\neq v_{h} \\in V_{h}^{S_{r}}} \\frac{a(v_{h},v_{h})}{(v_{h},v_{h})}}{\\displaystyle \\inf_{0 \\neq v_{h} \\in V_{h}^{S_{r}}} \\frac{a(v_{h},v_{h})}{(v_{h},v_{h})}} \\, ,\n$$\nwhere the Rayleigh quotient is taken over $V_{h}^{S_{r}}$.\n\nStarting from the Poincaré–Friedrichs inequality on $H_{0}^{1}(\\Omega)$ and standard $hp$-inverse inequalities on quasiuniform meshes for polynomial degree $r$ on quadrilaterals, derive the asymptotic scaling of $\\kappa(M_{h}^{-1}K_{h})$ with respect to $h$ and $r$ for the serendipity space $V_{h}^{S_{r}}$. Then compare this scaling with that for the tensor-product Lagrange space $V_{h}^{Q_{r}}$ on the same meshes. Assume that any constants hidden by inequalities depend only on $\\Omega$ and the mesh shape regularity, but not on $h$ or $r$.\n\nProvide as your final answer a single closed-form expression in terms of $h$ and $r$ that gives the leading-order asymptotic behavior of $\\kappa(M_{h}^{-1}K_{h})$ for $V_{h}^{S_{r}}$, which matches that for $V_{h}^{Q_{r}}$. Do not include any constants. No units are required. The final answer must be a single expression.",
            "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, and objective.\n\n### Step 1: Extract Givens\n- **Problem Type**: Homogeneous Dirichlet boundary value problem for the Poisson equation.\n- **Domain**: $\\Omega \\subset \\mathbb{R}^{2}$, a bounded, connected, Lipschitz domain.\n- **Bilinear Form**: $a(u,v) = \\int_{\\Omega} \\nabla u \\cdot \\nabla v \\, dx$.\n- **Inner Product**: $(u,v) = \\int_{\\Omega} u v \\, dx$.\n- **Meshes**: $\\mathcal{T}_{h}$, a quasiuniform family of shape-regular quadrilateral meshes of mesh size $h$.\n- **Finite Element Space**: $V_{h}^{S_{r}} \\subset H_{0}^{1}(\\Omega)$, the conforming serendipity space of order $r \\in \\mathbb{N}$.\n- **Matrices**: $K_{h}$ and $M_{h}$ are the global stiffness and mass matrices corresponding to $a(\\cdot,\\cdot)$ and $(\\cdot,\\cdot)$ in a nodal basis for $V_{h}^{S_{r}}$.\n- **Generalized Spectral Condition Number**: $\\kappa(M_{h}^{-1}K_{h}) = \\frac{\\lambda_{\\max}(K_{h},M_{h})}{\\lambda_{\\min}(K_{h},M_{h})} = \\frac{\\sup_{0 \\neq v_{h} \\in V_{h}^{S_{r}}} \\frac{a(v_{h},v_{h})}{(v_{h},v_{h})}}{\\inf_{0 \\neq v_{h} \\in V_{h}^{S_{r}}} \\frac{a(v_{h},v_{h})}{(v_{h},v_{h})}}$.\n- **Required Tools**: Poincaré–Friedrichs inequality and $hp$-inverse inequalities.\n- **Assumptions**: Constants in inequalities depend only on $\\Omega$ and mesh shape regularity.\n- **Objective**: Derive the asymptotic scaling of $\\kappa(M_{h}^{-1}K_{h})$ with respect to $h$ and $r$ for $V_{h}^{S_{r}}$ and compare it to the scaling for the tensor-product Lagrange space $V_{h}^{Q_{r}}$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is a standard exercise in the numerical analysis of partial differential equations, specifically within the finite element method (FEM). All terms, such as \"serendipity space\", \"quasiuniform\", \"shape-regular\", \"stiffness matrix\", and \"mass matrix\", are well-defined in this context. The problem is scientifically grounded in functional analysis and numerical linear algebra as applied to FEM. It is well-posed, as it asks for an asymptotic scaling law, which can be derived from established theoretical results. The language is objective and precise. The problem does not violate any of the invalidity criteria.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\n### Solution Derivation\n\nThe generalized spectral condition number is defined as the ratio of the largest to the smallest eigenvalue of the generalized eigenvalue problem $K_h \\mathbf{v} = \\lambda M_h \\mathbf{v}$, where $\\mathbf{v}$ is the vector of nodal coefficients for a function $v_h \\in V_h^{S_r}$. In terms of the bilinear form $a(\\cdot, \\cdot)$ and inner product $(\\cdot,\\cdot)$, the eigenvalues $\\lambda$ are given by the Rayleigh quotient:\n$$\n\\lambda = \\frac{a(v_h, v_h)}{(v_h, v_h)} = \\frac{\\int_{\\Omega} |\\nabla v_h|^2 \\, dx}{\\int_{\\Omega} |v_h|^2 \\, dx} = \\frac{|v_h|_{H^1(\\Omega)}^2}{\\|v_h\\|_{L^2(\\Omega)}^2}\n$$\nfor a non-zero function $v_h \\in V_h^{S_r}$. The condition number is therefore\n$$\n\\kappa(M_h^{-1} K_h) = \\frac{\\lambda_{\\max}}{\\lambda_{\\min}} = \\frac{\\sup_{0 \\neq v_h \\in V_h^{S_r}} \\frac{|v_h|_{H^1(\\Omega)}^2}{\\|v_h\\|_{L^2(\\Omega)}^2}}{\\inf_{0 \\neq v_h \\in V_h^{S_r}} \\frac{|v_h|_{H^1(\\Omega)}^2}{\\|v_h\\|_{L^2(\\Omega)}^2}}\n$$\nWe derive the asymptotic scaling of $\\lambda_{\\min}$ and $\\lambda_{\\max}$ with respect to the mesh size $h$ and the polynomial order $r$.\n\n**Analysis of the Minimum Eigenvalue $\\lambda_{\\min}$**\n\nThe finite element space $V_h^{S_r}$ is a subspace of the Sobolev space $H_0^1(\\Omega)$, as the elements are conforming and satisfy homogeneous Dirichlet boundary conditions. The Poincaré–Friedrichs inequality holds for all functions in $H_0^1(\\Omega)$. It states that there exists a constant $C_{PF}$, depending only on the domain $\\Omega$, such that for any $v \\in H_0^1(\\Omega)$:\n$$\n\\|v\\|_{L^2(\\Omega)}^2 \\le C_{PF} |v|_{H^1(\\Omega)}^2\n$$\nRearranging this inequality, we have:\n$$\n\\frac{|v|_{H^1(\\Omega)}^2}{\\|v\\|_{L^2(\\Omega)}^2} \\ge \\frac{1}{C_{PF}}\n$$\nSince this holds for all functions in $H_0^1(\\Omega)$, it must also hold for all functions in its subspace $V_h^{S_r}$. Therefore, the minimum eigenvalue is bounded below by a constant independent of $h$ and $r$:\n$$\n\\lambda_{\\min} = \\inf_{0 \\neq v_h \\in V_h^{S_r}} \\frac{|v_h|_{H^1(\\Omega)}^2}{\\|v_h\\|_{L^2(\\Omega)}^2} \\ge \\frac{1}{C_{PF}} > 0\n$$\nFrom the approximation theory of FEM, the discrete eigenvalues converge to the eigenvalues of the continuous operator $(-\\Delta)$ as $h \\to 0$. In particular, $\\lambda_{\\min}$ converges to the first (smallest) eigenvalue of the Laplacian on $\\Omega$ with homogeneous Dirichlet conditions. Thus, for small $h$, $\\lambda_{\\min}$ is a quantity of order $1$. We write this as $\\lambda_{\\min} \\asymp 1$, where $\\asymp$ denotes that the quantities are proportional up to constants independent of $h$ and $r$.\n\n**Analysis of the Maximum Eigenvalue $\\lambda_{\\max}$**\n\nTo bound $\\lambda_{\\max}$, we employ a standard inverse inequality for finite element spaces. The analysis proceeds in three steps: an inequality on a reference element, scaling to a physical element, and summing over all elements.\n\n1.  **Inverse Inequality on the Reference Element**: Let $\\hat{K} = [-1,1]^2$ be the reference square. The serendipity space of order $r$, denoted $S_r(\\hat{K})$, is a subspace of the tensor-product polynomial space $Q_r(\\hat{K}) = \\text{span}\\{ \\hat{x}^i \\hat{y}^j \\mid 0 \\le i, j \\le r \\}$. For any polynomial $\\hat{p} \\in Q_r(\\hat{K})$, a standard inverse inequality (a Markov-type inequality for polynomials) holds:\n    $$\n    |\\hat{p}|_{H^1(\\hat{K})}^2 \\le C r^4 \\|\\hat{p}\\|_{L^2(\\hat{K})}^2\n    $$\n    The constant $C$ is independent of $r$ and $\\hat{p}$. The factor $r^4$ arises from applying the one-dimensional inequality $|\\hat{p}'|_{L^2(-1,1)}^2 \\le C' r^4 \\|\\hat{p}\\|_{L^2(-1,1)}^2$ to each partial derivative. Since $S_r(\\hat{K}) \\subset Q_r(\\hat{K})$, this inequality also holds for any $\\hat{v}_h \\in S_r(\\hat{K})$.\n\n2.  **Scaling to a Physical Element**: Let $K \\in \\mathcal{T}_h$ be a physical element obtained by a mapping $F_K: \\hat{K} \\to K$. For a quasiuniform and shape-regular mesh family, the Jacobian of the map $F_K$ and its inverse satisfy estimates involving the element size $h$: $\\|DF_K\\|_{L^\\infty(\\hat{K})} \\le C_1 h$ and $\\|DF_K^{-1}\\|_{L^\\infty(K)} \\le C_2 h^{-1}$, and the determinant scales as $|\\det(DF_K)| \\asymp h^2$.\n    For a function $v_h \\in V_h^{S_r}|_K$, let $\\hat{v}_h = v_h \\circ F_K$ be its counterpart on $\\hat{K}$. A change of variables yields:\n    $$\n    |v_h|_{H^1(K)}^2 \\le C_{\\text{shape}} h^2 (h^{-1})^2 |\\hat{v}_h|_{H^1(\\hat{K})}^2 = C_{\\text{shape}} |\\hat{v}_h|_{H^1(\\hat{K})}^2\n    $$\n    $$\n    \\|v_h\\|_{L^2(K)}^2 \\ge C'_{\\text{shape}} h^2 \\|\\hat{v}_h\\|_{L^2(\\hat{K})}^2\n    $$\n    Combining these scaling relations with the reference element inequality gives the inverse inequality on the physical element $K$:\n    $$\n    \\frac{|v_h|_{H^1(K)}^2}{\\|v_h\\|_{L^2(K)}^2} \\le \\frac{C_{\\text{shape}} |\\hat{v}_h|_{H^1(\\hat{K})}^2}{C'_{\\text{shape}} h^2 \\|\\hat{v}_h\\|_{L^2(\\hat{K})}^2} \\le \\frac{C_{\\text{shape}}}{C'_{\\text{shape}}} \\frac{1}{h^2} \\frac{C r^4 \\|\\hat{v}_h\\|_{L^2(\\hat{K})}^2}{\\|\\hat{v}_h\\|_{L^2(\\hat{K})}^2} = C'' \\frac{r^4}{h^2}\n    $$\n\n3.  **Global Inverse Inequality**: Summing over all elements $K \\in \\mathcal{T}_h$ yields the global inequality:\n    $$\n    |v_h|_{H^1(\\Omega)}^2 = \\sum_{K \\in \\mathcal{T}_h} |v_h|_{H^1(K)}^2 \\le \\sum_{K \\in \\mathcal{T}_h} C'' \\frac{r^4}{h^2} \\|v_h\\|_{L^2(K)}^2 = C'' \\frac{r^4}{h^2} \\sum_{K \\in \\mathcal{T}_h} \\|v_h\\|_{L^2(K)}^2 = C'' \\frac{r^4}{h^2} \\|v_h\\|_{L^2(\\Omega)}^2\n    $$\n    This implies an upper bound on the Rayleigh quotient:\n    $$\n    \\frac{|v_h|_{H^1(\\Omega)}^2}{\\|v_h\\|_{L^2(\\Omega)}^2} \\le C'' \\frac{r^4}{h^2}\n    $$\n    This inequality is known to be sharp; one can construct a highly oscillatory function in $V_h^{S_r}$ for which the ratio achieves this scaling. Thus, the asymptotic behavior of the maximum eigenvalue is:\n    $$\n    \\lambda_{\\max} \\asymp \\frac{r^4}{h^2}\n    $$\n\n**Asymptotic Scaling of the Condition Number**\n\nCombining the asymptotic behavior of $\\lambda_{\\min}$ and $\\lambda_{\\max}$, we find the scaling of the condition number:\n$$\n\\kappa(M_h^{-1} K_h) = \\frac{\\lambda_{\\max}}{\\lambda_{\\min}} \\asymp \\frac{r^4/h^2}{1} = \\frac{r^4}{h^2}\n$$\n\n**Comparison with Tensor-Product Space $V_h^{Q_r}$**\n\nThe argument for the lower bound $\\lambda_{\\min} \\asymp 1$ depends only on the Poincaré–Friedrichs inequality and the fact that $V_h \\subset H_0^1(\\Omega)$, so it is identical for the tensor-product Lagrange space $V_h^{Q_r}$.\nThe argument for the upper bound $\\lambda_{\\max}$ relies on the inverse inequality. Our derivation used the inequality on the reference space $Q_r(\\hat{K})$ and noted that it also applies to the subspace $S_r(\\hat{K})$. The inequality is sharp for $Q_r(\\hat{K})$ itself. Therefore, the same steps lead to the same asymptotic scaling for $\\lambda_{\\max}$ for the space $V_h^{Q_r}$.\nConsequently, the asymptotic scaling of the condition number $\\kappa(M_h^{-1} K_h)$ is identical for both serendipity ($V_h^{S_r}$) and tensor-product ($V_h^{Q_r}$) finite element spaces on quasiuniform, shape-regular quadrilateral meshes. The leading-order asymptotic behavior is proportional to $r^4 h^{-2}$.\n\nThe final answer should provide the expression for this dependence.",
            "answer": "$$\n\\boxed{\\frac{r^{4}}{h^{2}}}\n$$"
        }
    ]
}