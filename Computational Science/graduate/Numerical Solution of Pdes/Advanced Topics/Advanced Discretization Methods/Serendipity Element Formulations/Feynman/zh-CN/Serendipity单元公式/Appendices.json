{
    "hands_on_practices": [
        {
            "introduction": "相比于拉格朗日单元，Serendipity 单元通过更精巧地选择基函数，在保证近似精度的同时，显著减少了自由度数量。一种构建这类单元的方法是引入“超线性次数”的概念，用以筛选和保留对插值贡献最大的多项式项。这项练习将通过一个具体的计算，帮助你掌握超线性次数的定义，并理解其在构建 Serendipity 空间中的作用。",
            "id": "3442379",
            "problem": "考虑参考正方形 $\\hat K=[-1,1]^2$ 上的 Serendipity 有限元空间。对于具有非负整数 $\\alpha$ 和 $\\beta$ 的单项式 $m(x,y)=x^{\\alpha}y^{\\beta}$，其超线性次数 $\\operatorname{sldeg}(m)$ 定义为\n$$\n\\operatorname{sldeg}(x^{\\alpha}y^{\\beta})=\\sum_{v\\in\\{\\alpha,\\beta\\}\\,:\\,v\\ge 2} v.\n$$\n对于多项式 $p(x,y)=\\sum_{\\alpha,\\beta\\ge 0} c_{\\alpha\\beta} x^{\\alpha}y^{\\beta}$，其超线性次数定义为\n$$\n\\operatorname{sldeg}(p)=\\max\\{\\operatorname{sldeg}(x^{\\alpha}y^{\\beta}) \\,:\\, c_{\\alpha\\beta}\\ne 0\\}.\n$$\n阶数为 $r$ 的 Serendipity 空间，记作 $S_r(\\hat K)$，是 $\\hat K$ 上所有满足 $\\operatorname{sldeg}(p)\\le r$ 的多项式 $p$ 构成的空间。\n\n请确定最小的整数 $r$，使得单项式 $x^2y^2$ 属于 $S_r(\\hat K)$，并直接根据超线性次数的定义来证明你的答案。你的最终答案必须是一个整数。",
            "solution": "我们的目标是找到最小的整数 $r$，使得单项式 $p(x,y) = x^2y^2$ 属于 Serendipity 空间 $S_r(\\hat K)$。\n\n根据定义，一个多项式 $p$ 属于空间 $S_r(\\hat K)$ 的条件是其超线性次数 $\\operatorname{sldeg}(p)$ 小于或等于 $r$。对于单项式 $p(x,y) = x^2y^2$，其超线性次数就是它自身的超线性次数。\n\n我们来计算 $x^2y^2$ 的超线性次数。该单项式的形式为 $x^{\\alpha}y^{\\beta}$，其中指数为 $\\alpha=2$ 和 $\\beta=2$。超线性次数的定义为：\n$$\n\\operatorname{sldeg}(x^{\\alpha}y^{\\beta})=\\sum_{v\\in\\{\\alpha,\\beta\\}\\,:\\,v\\ge 2} v.\n$$\n该公式指示我们将所有大于或等于 2 的指数相加。\n\n对于 $x^2y^2$：\n1.  指数 $\\alpha=2$ 满足条件 $2 \\ge 2$，因此它被包含在求和中。\n2.  指数 $\\beta=2$ 满足条件 $2 \\ge 2$，因此它也被包含在求和中。\n\n所以，该单项式的超线性次数是这两个指数的和：\n$$\n\\operatorname{sldeg}(x^2y^2) = 2 + 2 = 4.\n$$\n为了使 $x^2y^2$ 属于 $S_r(\\hat K)$，必须满足条件 $\\operatorname{sldeg}(x^2y^2) \\le r$。将我们计算出的值代入，得到不等式：\n$$\n4 \\le r.\n$$\n问题要求满足此条件的最小整数 $r$。满足 $r \\ge 4$ 的最小整数是 $4$。\n\n因此，使得单项式 $x^2y^2$ 属于 $S_r(\\hat K)$ 的最小整数 $r$ 是 $4$。",
            "answer": "$$\\boxed{4}$$"
        },
        {
            "introduction": "在掌握了超线性次数的基本概念后，我们可以将其推广到更复杂的三维情况，并探索其更深层的结构意义。这项练习要求我们不仅要推导三维 Serendipity 空间的维度表达式，还要揭示其基函数与单元几何实体（顶点、边、面、体）之间的内在联系。通过这种方式，我们可以清晰地看到不同阶次的“内部”基函数是如何随着多项式次数的增加而逐次出现的。",
            "id": "3442394",
            "problem": "设 $\\hat K = [-1,1]^3$ 为参考六面体。对于整数多项式次数 $r \\geq 1$，定义三维 serendipity 空间 $S_r(\\hat K)$ 为所有超线性次数至多为 $r$ 的单项式 $x^{a} y^{b} z^{c}$ 的张成空间，其中单项式 $x^{a} y^{b} z^{c}$ 的超线性次数定义为 $\\operatorname{sldeg}(x^{a} y^{b} z^{c}) := \\sum_{\\{v \\in \\{a,b,c\\} : v \\geq 2\\}} v$。从该定义和基本计数原理出发，通过直接对所有允许的单项式进行计数，推导维数 $\\dim S_r(\\hat K)$ 的闭式表达式。你的推导应根据超线性变量的个数 $m \\in \\{0,1,2,3\\}$ 对单项式进行划分，然后对每个 $m$ 值计算允许的指数分配。\n\n接下来，利用你的计数分解，确定在任何单值自由度（DOF）系统中，面支持基函数和体内部支持基函数首次出现时所对应的多项式次数 $r$。这里，“面支持”指的是其支集始于 $\\hat K$ 的二维面内部（即不限于顶点或棱）的基函数，“体内部支持”指的是其支集始于 $\\hat K$ 的三维体内部（即不限于任何边界子实体）的基函数。通过在你按 $m$ 的分解中确定相应计数何时变为严格正值，来论证你的阈值。\n\n将你的最终答案以一个包含三个条目的行矩阵 $\\big(\\dim S_r(\\hat K), r_{\\text{face}}, r_{\\text{cell}}\\big)$ 的形式报告，其中 $r_{\\text{face}}$ 是面支持自由度首次出现的最小 $r$ 值，$r_{\\text{cell}}$ 是体内部支持自由度首次出现的最小 $r$ 值。无需四舍五入。没有物理单位。将维数表示为关于 $r$ 的闭式解析表达式（可以使用二项式系数）。",
            "solution": "### 第 1 部分：推导 $\\dim S_r(\\hat K)$\n\n$S_r(\\hat K)$ 的维数是满足条件 $\\operatorname{sldeg}(x^a y^b z^c) \\le r$ 的线性无关单项式 $x^a y^b z^c$ 的数量。我们根据超线性指数（即值大于或等于 2 的指数）的个数 $m$ 来对所有单项式进行分类。\n\n**情况 $m=0$：没有超线性指数**\n- 条件：$a, b, c \\in \\{0, 1\\}$。\n- $\\operatorname{sldeg} = 0$，这总是满足 $0 \\le r$ (因为 $r \\ge 1$)。\n- 计数：每个指数有 2 种选择，所以总共有 $2^3 = 8$ 个单项式。这些对应于六面体的 8 个顶点自由度。\n- $N_0 = 8$。\n\n**情况 $m=1$：恰好有一个超线性指数**\n- 条件：一个指数（例如 $a$）满足 $a \\ge 2$，另外两个指数 $b,c \\in \\{0,1\\}$。\n- $\\operatorname{sldeg} = a \\le r$。因此，$a$ 的取值范围是 $\\{2, 3, \\dots, r\\}$，共有 $r-1$ 种选择（此计数对 $r \\ge 2$ 有意义，当 $r=1$ 时为 0）。\n- 计数：有 $\\binom{3}{1}=3$ 种方式选择哪个指数是超线性的。对于每种选择，有 $r-1$ 种方式确定该指数的值，并有 $2^2=4$ 种方式确定另外两个线性/常数指数的值。\n- $N_1 = \\binom{3}{1}(r-1) \\cdot 4 = 12(r-1) = 12\\binom{r-1}{1}$。这些对应于六面体的 12 条边的内部自由度。\n\n**情况 $m=2$：恰好有两个超线性指数**\n- 条件：两个指数（例如 $a,b$）满足 $a,b \\ge 2$，另一个指数 $c \\in \\{0,1\\}$。\n- $\\operatorname{sldeg} = a+b \\le r$。我们需求解 $a,b \\ge 2, a+b \\le r$ 的整数解的数量。令 $a' = a-2, b' = b-2$，则 $a',b' \\ge 0$ 且 $a'+b' \\le r-4$。根据“星和棒”定理的推广，解的数量为 $\\binom{(r-4)+2}{2} = \\binom{r-2}{2}$。\n- 计数：有 $\\binom{3}{2}=3$ 种方式选择哪两个指数是超线性的。指数 $c$ 有 2 种选择。\n- $N_2 = \\binom{3}{2} \\binom{r-2}{2} \\cdot 2 = 6\\binom{r-2}{2}$。这些对应于六面体的 6 个面的内部自由度。\n\n**情况 $m=3$：所有三个指数都是超线性的**\n- 条件：$a,b,c \\ge 2$。\n- $\\operatorname{sldeg} = a+b+c \\le r$。令 $a' = a-2, b' = b-2, c'=c-2$，则 $a',b',c' \\ge 0$ 且 $a'+b'+c' \\le r-6$。解的数量为 $\\binom{(r-6)+3}{3} = \\binom{r-3}{3}$。\n- 计数：只有 $\\binom{3}{3}=1$ 种方式选择所有三个指数。\n- $N_3 = \\binom{r-3}{3}$。这些对应于六面体的体内部自由度。\n\n**总维数**\n将所有情况相加（并使用当上标小于下标时二项式系数为 0 的约定），我们得到总维数：\n$$ \\dim S_r(\\hat K) = N_0 + N_1 + N_2 + N_3 = 8 + 12\\binom{r-1}{1} + 6\\binom{r-2}{2} + \\binom{r-3}{3} $$\n\n### 第 2 部分：确定自由度出现的阈值\n\n**面支持自由度 ($r_{\\text{face}}$)**\n面支持自由度对应于 $m=2$ 的情况。这些自由度首次出现时，其对应的单项式数量 $N_2$ 首次变为正值。\n$N_2 = 6\\binom{r-2}{2} > 0$\n这要求二项式系数的“上标”大于或等于“下标”，即 $r-2 \\ge 2$，这意味着 $r \\ge 4$。\n因此，面支持自由度首次出现的最小多项式次数是 $r_{\\text{face}}=4$。\n\n**体内部支持自由度 ($r_{\\text{cell}}$)**\n体内部支持自由度对应于 $m=3$ 的情况。这些自由度首次出现时，其对应的单项式数量 $N_3$ 首次变为正值。\n$N_3 = \\binom{r-3}{3} > 0$\n这要求 $r-3 \\ge 3$，这意味着 $r \\ge 6$。\n因此，体内部支持自由度首次出现的最小多项式次数是 $r_{\\text{cell}}=6$。\n\n### 最终答案\n综合以上结果，最终答案为包含维数表达式、$r_{\\text{face}}$ 和 $r_{\\text{cell}}$ 的行矩阵。\n$$\n\\left( 8 + 12\\binom{r-1}{1} + 6\\binom{r-2}{2} + \\binom{r-3}{3}, \\quad 4, \\quad 6 \\right)\n$$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n8 + 12\\binom{r-1}{1} + 6\\binom{r-2}{2} + \\binom{r-3}{3} & 4 & 6\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "我们为什么要在单元构造上花费如此多的精力？Serendipity 单元的真正价值在于其在实际计算中的效率和性能。这项练习将从数值分析的角度，为我们揭示这一优势的关键所在。通过分析整体刚度矩阵条件数与网格尺寸 $h$ 和多项式次数 $r$ 的关系，我们将看到 Serendipity 单元如何在大幅节省计算成本的同时，保持与张量积单元同样优良的数值稳定性。",
            "id": "3442374",
            "problem": "考虑在有界、连通的 Lipschitz 域 $\\Omega \\subset \\mathbb{R}^{2}$ 上的泊松方程的齐次狄利克雷边界值问题，其双线性形式为 $a(u,v) = \\int_{\\Omega} \\nabla u \\cdot \\nabla v \\, dx$，$L^{2}$ 内积为 $(u,v) = \\int_{\\Omega} u v \\, dx$。令 $\\mathcal{T}_{h}$ 为一个网格尺寸为 $h$ 的拟一致、形状规则的四边形网格族，并令 $V_{h}^{S_{r}} \\subset H_{0}^{1}(\\Omega)$ 表示在 $\\mathcal{T}_{h}$ 上的 $r \\in \\mathbb{N}$ 阶协调 serendipity 空间，该空间由逐单元映射的 serendipity 形函数以标准方式组合而成。令 $K_{h} \\in \\mathbb{R}^{N \\times N}$ 和 $M_{h} \\in \\mathbb{R}^{N \\times N}$ 分别为在 $V_{h}^{S_{r}}$ 的任意固定节点基下，对应于 $a(\\cdot,\\cdot)$ 和 $(\\cdot,\\cdot)$ 的全局刚度矩阵和质量矩阵。\n\n定义广义谱条件数\n$$\n\\kappa\\big(M_{h}^{-1}K_{h}\\big) \\;=\\; \\frac{\\lambda_{\\max}(K_{h},M_{h})}{\\lambda_{\\min}(K_{h},M_{h})}\n\\;=\\; \\frac{\\displaystyle \\sup_{0 \\neq v_{h} \\in V_{h}^{S_{r}}} \\frac{a(v_{h},v_{h})}{(v_{h},v_{h})}}{\\displaystyle \\inf_{0 \\neq v_{h} \\in V_{h}^{S_{r}}} \\frac{a(v_{h},v_{h})}{(v_{h},v_{h})}} \\, ,\n$$\n其中瑞利商是在 $V_{h}^{S_{r}}$ 上计算的。\n\n从 $H_{0}^{1}(\\Omega)$ 上的 Poincaré–Friedrichs 不等式和四边形上多项式次数为 $r$ 的拟一致网格上的标准 $hp$-逆不等式出发，推导 serendipity 空间 $V_{h}^{S_{r}}$ 中 $\\kappa(M_{h}^{-1}K_{h})$ 关于 $h$ 和 $r$ 的渐近尺度关系。然后将此尺度关系与相同网格上的张量积拉格朗日空间 $V_{h}^{Q_{r}}$ 的尺度关系进行比较。假设不等式中隐藏的任何常数仅依赖于 $\\Omega$ 和网格的形状规则性，而不依赖于 $h$ 或 $r$。\n\n请提供一个单一的封闭形式表达式作为最终答案，该表达式给出了 $V_{h}^{S_{r}}$ 中 $\\kappa(M_{h}^{-1}K_{h})$ 的主阶渐近行为，且该行为与 $V_{h}^{Q_{r}}$ 的情况相匹配。不要包含任何常数。不需要单位。最终答案必须是单一表达式。",
            "solution": "广义谱条件数 $\\kappa(M_{h}^{-1}K_{h})$ 是广义特征值问题 $K_h \\mathbf{v} = \\lambda M_h \\mathbf{v}$ 的最大特征值 $\\lambda_{\\max}$ 与最小特征值 $\\lambda_{\\min}$ 之比。在函数空间中，特征值 $\\lambda$ 由瑞利商给出：\n$$\n\\lambda = \\frac{a(v_h, v_h)}{(v_h, v_h)} = \\frac{|v_h|_{H^1(\\Omega)}^2}{\\|v_h\\|_{L^2(\\Omega)}^2}\n$$\n对于任意非零函数 $v_h \\in V_h^{S_r}$。我们的目标是推导 $\\lambda_{\\min}$ 和 $\\lambda_{\\max}$ 关于网格尺寸 $h$ 和多项式阶数 $r$ 的渐近尺度关系。\n\n**最小特征值 $\\lambda_{\\min}$ 的分析**\n\n有限元空间 $V_h^{S_r}$ 是 Sobolev 空间 $H_0^1(\\Omega)$ 的一个子空间。对于 $H_0^1(\\Omega)$ 中的任何函数 $v$，Poincaré–Friedrichs 不等式成立，即存在一个仅依赖于区域 $\\Omega$ 的常数 $C_{PF}$，使得：\n$$\n\\|v\\|_{L^2(\\Omega)}^2 \\le C_{PF} |v|_{H^1(\\Omega)}^2\n$$\n整理后得到：\n$$\n\\frac{|v|_{H^1(\\Omega)}^2}{\\|v\\|_{L^2(\\Omega)}^2} \\ge \\frac{1}{C_{PF}}\n$$\n由于此不等式对 $H_0^1(\\Omega)$ 中的所有函数都成立，它自然也对子空间 $V_h^{S_r}$ 中的所有函数成立。因此，最小特征值由一个与 $h$ 和 $r$ 无关的正常数从下方界定：\n$$\n\\lambda_{\\min} = \\inf_{0 \\neq v_h \\in V_h^{S_r}} \\frac{|v_h|_{H^1(\\Omega)}^2}{\\|v_h\\|_{L^2(\\Omega)}^2} \\ge \\frac{1}{C_{PF}} > 0\n$$\n因此，我们可以认为 $\\lambda_{\\min}$ 的量级为 1，记作 $\\lambda_{\\min} \\asymp 1$。\n\n**最大特征值 $\\lambda_{\\max}$ 的分析**\n\n为了界定 $\\lambda_{\\max}$，我们使用有限元空间上的标准逆不等式。\n1.  **参考单元上的逆不等式**：在参考单元 $\\hat{K} = [-1,1]^2$ 上，对于任意次数为 $r$ 的多项式 $\\hat{v}_h$，一个标准的多项式逆不等式成立：\n    $$\n    |\\hat{v}_h|_{H^1(\\hat{K})}^2 \\le C r^4 \\|\\hat{v}_h\\|_{L^2(\\hat{K})}^2\n    $$\n    其中常数 $C$ 与 $r$ 和 $\\hat{v}_h$ 无关。由于 $r$ 阶 Serendipity 空间 $S_r(\\hat{K})$ 是 $r$ 阶张量积空间 $Q_r(\\hat{K})$ 的子空间，此不等式对 $S_r(\\hat{K})$ 中的多项式同样成立。\n\n2.  **缩放到物理单元**：通过标准的尺度变换参数，将参考单元上的不等式映射到网格 $\\mathcal{T}_h$ 中任意一个尺寸为 $h$ 的物理单元 $K$ 上。对于一个拟一致且形状规则的网格，我们得到单元上的逆不等式：\n    $$\n    |v_h|_{H^1(K)}^2 \\le C' \\frac{r^4}{h^2} \\|v_h\\|_{L^2(K)}^2\n    $$\n\n3.  **全局逆不等式**：将单元上的不等式在所有单元上求和，得到全局逆不等式：\n    $$\n    |v_h|_{H^1(\\Omega)}^2 = \\sum_{K \\in \\mathcal{T}_h} |v_h|_{H^1(K)}^2 \\le \\sum_{K \\in \\mathcal{T}_h} C' \\frac{r^4}{h^2} \\|v_h\\|_{L^2(K)}^2 = C' \\frac{r^4}{h^2} \\|v_h\\|_{L^2(\\Omega)}^2\n    $$\n    这个不等式对 $V_h^{S_r}$ 中所有函数都成立，并且是尖锐的（即存在可以达到该尺度关系的函数）。因此，最大特征值的渐近行为是：\n    $$\n    \\lambda_{\\max} \\asymp \\frac{r^4}{h^2}\n    $$\n\n**条件数的渐近尺度关系**\n\n结合 $\\lambda_{\\min}$ 和 $\\lambda_{\\max}$ 的渐近行为，我们得到条件数的尺度关系：\n$$\n\\kappa(M_h^{-1} K_h) = \\frac{\\lambda_{\\max}}{\\lambda_{\\min}} \\asymp \\frac{r^4/h^2}{1} = \\frac{r^4}{h^2}\n$$\n\n**与张量积空间 $V_h^{Q_r}$ 的比较**\n\n上述推导中的所有论证——Poincaré–Friedrichs 不等式和逆不等式——对于张量积拉格朗日空间 $V_h^{Q_r}$ 也同样成立，并且得到相同的渐近尺度。因此，Serendipity 空间与张量积空间在此问题上具有相同的条件数渐近行为。\n\n最终的表达式代表了这个与 $h$ 和 $r$ 相关的主阶渐近行为。",
            "answer": "$$\n\\boxed{\\frac{r^{4}}{h^{2}}}\n$$"
        }
    ]
}