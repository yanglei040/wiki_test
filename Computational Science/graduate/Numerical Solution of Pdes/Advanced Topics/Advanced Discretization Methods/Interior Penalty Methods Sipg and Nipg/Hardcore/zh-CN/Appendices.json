{
    "hands_on_practices": [
        {
            "introduction": "第一个练习是基础性的。它将引导您从对称内部罚分 (SIPG) 双线性形式出发，为一个简单的一维问题推导出局部刚度矩阵和罚分矩阵。通过将这些局部矩阵组装成一个全局系统并进行傅里叶分析 ()，您将具体理解 SIPG 公式的不同组成部分如何转化为最终的离散系统。",
            "id": "3410379",
            "problem": "考虑一维扩散问题 $-\\frac{d}{dx}\\left(\\kappa \\frac{du}{dx}\\right)=f$，其中扩散系数 $\\kappa>0$ 为常数，定义在周期性域 $[0,1]$ 上。设该域被划分为一个包含 $N$ 个单元的均匀网格，每个单元的长度为 $h=\\frac{1}{N}$。使用分片线性多项式（多项式次数 $p=1$）的间断 Galerkin (DG) 离散方法和对称内部罚 Galerkin (SIPG) 方法。用 $\\eta>0$ 表示无量纲罚参数，并设边上的罚尺度为 $\\tau=\\eta \\frac{\\kappa}{h}$。\n\n在每个单元 $K_e=[x_e,x_{e+1}]$ 上，使用单元上的节点基，其局部基函数为 $\\phi_{1}(x)=1-\\frac{x-x_e}{h}$ 和 $\\phi_{2}(x)=\\frac{x-x_e}{h}$。对内部边采用标准的 DG 定义：对于由左单元 $K^{-}$ 和右单元 $K^{+}$ 共享的边，取外法线 $n^{-}=+1$ 和 $n^{+}=-1$，跳跃 $[w]=w^{-}n^{-}+w^{+}n^{+}=w^{-}-w^{+}$，以及平均 $\\{q\\}=\\frac{1}{2}(q^{-}+q^{+})$。\n\n仅使用 SIPG 双线性形式的基本定义，\n\n$$\na(u,v)=\\sum_{K}\\int_{K}\\kappa\\,u'(x)\\,v'(x)\\,dx-\\sum_{F}\\left(\\{\\kappa u'\\},[v]\\right)_{F}-\\sum_{F}\\left(\\{\\kappa v'\\},[u]\\right)_{F}+\\sum_{F}\\left(\\tau\\,[u],[v]\\right)_{F},\n$$\n\n推导以下内容：\n\n1. 在基 $\\{\\phi_{1},\\phi_{2}\\}$ 中，任意单元的显式 $2\\times 2$ 局部单元体积刚度矩阵 $A^{\\mathrm{vol}}$。\n\n2. 跨越单个内部边、耦合两个相邻单元的显式 $4\\times 4$ 内部边贡献矩阵 $A^{\\mathrm{face}}$，写成 $2\\times 2$ 的分块形式\n\n$$\nA^{\\mathrm{face}}=\\begin{pmatrix}A^{LL}  A^{LR}\\\\ A^{RL}  A^{RR}\\end{pmatrix},\n$$\n\n其中 $A^{LL}$ 和 $A^{RR}$ 分别是单元上（左和右）的 $2\\times 2$ 块，而 $A^{LR}$ 和 $A^{RL}$ 是 $2\\times 2$ 的耦合块。清楚地指出罚项是如何进入这些块的。\n\n3. 在周期性边界条件下，组装全局块循环刚度矩阵，并形成其与离散模（其单元相位为 $\\theta\\in[-\\pi,\\pi)$）相关联的 $2\\times 2$ 块傅里叶符号 $S(\\theta)$。然后计算行列式 $\\det S(\\theta)$ 关于 $\\kappa$、$\\eta$、$h$ 和 $\\theta$ 的闭式表达式。\n\n以 $\\det S(\\theta)$ 的单个解析表达式的形式给出最终答案。无需四舍五入。",
            "solution": "我们从具有常数 $\\kappa$ 的扩散算子的对称内部罚 Galerkin (SIPG) 双线性形式的定义开始：\n\n$$\na(u,v)=\\sum_{K}\\int_{K}\\kappa\\,u'(x)\\,v'(x)\\,dx-\\sum_{F}\\left(\\{\\kappa u'\\},[v]\\right)_{F}-\\sum_{F}\\left(\\{\\kappa v'\\},[u]\\right)_{F}+\\sum_{F}\\left(\\tau\\,[u],[v]\\right)_{F},\n$$\n\n其中，对于由左单元 $K^{-}$ 和右单元 $K^{+}$ 共享的内部边，我们使用 $n^{-}=+1$，$n^{+}=-1$，跳跃 $[w]=w^{-}n^{-}+w^{+}n^{+}=w^{-}-w^{+}$，平均 $\\{q\\}=\\frac{1}{2}(q^{-}+q^{+})$，以及边罚 $\\tau=\\eta \\frac{\\kappa}{h}$ (其中 $\\eta>0$) 。\n\n我们采用一个均匀网格，其单元为 $K_e=[x_e,x_{e+1}]$，长度为 $h=\\frac{1}{N}$，并在每个单元上使用局部线性节点基，\n\n$$\n\\phi_{1}(x)=1-\\frac{x-x_e}{h},\\qquad \\phi_{2}(x)=\\frac{x-x_e}{h}.\n$$\n\n它们在 $K_e$ 上的导数是常数：\n\n$$\n\\phi_{1}'(x)=-\\frac{1}{h},\\qquad \\phi_{2}'(x)=\\frac{1}{h}.\n$$\n\n\n1. 局部单元体积刚度矩阵。单元体积贡献为\n\n$$\nA^{\\mathrm{vol}}_{ij}=\\int_{K_e}\\kappa\\,\\phi_{i}'(x)\\,\\phi_{j}'(x)\\,dx=\\kappa\\left(\\frac{1}{h^2}\\right)\\int_{x_e}^{x_{e+1}}(\\pm 1)(\\pm 1)\\,dx=\\frac{\\kappa}{h}\\begin{pmatrix}1  -1\\\\ -1  1\\end{pmatrix}_{ij}.\n$$\n\n因此，\n\n$$\nA^{\\mathrm{vol}}=\\frac{\\kappa}{h}\\begin{pmatrix}1  -1\\\\ -1  1\\end{pmatrix}.\n$$\n\n\n2. 跨越单个边的内部边贡献矩阵。考虑位于左单元 $K^{-}$ 和右单元 $K^{+}$ 之间 $x=x_i$ 处的一个内部边。我们在基 $\\{\\phi_{1}^{-},\\phi_{2}^{-},\\phi_{1}^{+},\\phi_{2}^{+}\\}$ 中构建 $4\\times 4$ 的边矩阵，并将其分组为 $2\\times 2$ 的块形式\n\n$$\nA^{\\mathrm{face}}=\\begin{pmatrix}A^{LL}  A^{LR}\\\\ A^{RL}  A^{RR}\\end{pmatrix},\n$$\n\n其中上标表示左 ($L$) 或右 ($R$) 单元。\n\n我们需要边上的迹和单元上的导数：\n\n$$\n\\phi_{1}^{-}(x_i)=0,\\quad \\phi_{2}^{-}(x_i)=1,\\quad \\phi_{1}^{+}(x_i)=1,\\quad \\phi_{2}^{+}(x_i)=0,\n$$\n\n\n$$\n(\\phi_{1}^{-})'=-\\frac{1}{h},\\quad (\\phi_{2}^{-})'=\\frac{1}{h},\\quad (\\phi_{1}^{+})'=-\\frac{1}{h},\\quad (\\phi_{2}^{+})'=\\frac{1}{h}.\n$$\n\n对于每个基函数，其跳跃和平均导数因子为：对于任何仅在一个单元上具有支撑的测试/试探函数 $w$，其在另一个单元上的迹和导数均为零。因此，定义跨越四个基函数的跳跃向量和平均导数向量，\n\n$$\nj=\\begin{pmatrix}[\\,\\phi_{1}^{-}\\,]\\\n$$\\,\\phi_{2}^{-}\\,]\\\n$$\\,\\phi_{1}^{+}\\,]\\\n$$\\,\\phi_{2}^{+}\\,]\\end{pmatrix}\n=\\begin{pmatrix}0\\\\ 1\\\\ -1\\\\ 0\\end{pmatrix},\\qquad\nm=\\begin{pmatrix}\\{\\kappa(\\phi_{1}^{-})'\\}\\\\ \\{\\kappa(\\phi_{2}^{-})'\\}\\\\ \\{\\kappa(\\phi_{1}^{+})'\\}\\\\ \\{\\kappa(\\phi_{2}^{+})'\\}\\end{pmatrix}\n=\\frac{\\kappa}{2h}\\begin{pmatrix}-1\\\\ 1\\\\ -1\\\\ 1\\end{pmatrix}.\n$$\n\n对于试探函数 $\\psi$ 和测试函数 $v$，边双线性形式为\n\n$$\na_{F}(\\psi,v)=-\\{\\kappa \\psi'\\}[v]-\\{\\kappa v'\\}[\\psi]+\\tau[\\psi][v].\n$$\n\n因此，$4\\times 4$ 的边矩阵可以紧凑地写为\n\n$$\nA^{\\mathrm{face}}=-\\,j\\,m^{\\top}-\\,m\\,j^{\\top}+\\tau\\,j\\,j^{\\top}.\n$$\n\n设 $c=\\frac{\\kappa}{2h}$ 和 $\\tau=\\eta\\frac{\\kappa}{h}$，通过直接乘法，我们得到四个 $2\\times 2$ 的块：\n\n$$\nA^{LL}=\\begin{pmatrix}0  c\\\\ c  -2c+\\tau\\end{pmatrix},\\quad\nA^{LR}=\\begin{pmatrix}-c  0\\\\ 2c-\\tau  -c\\end{pmatrix},\n$$\n\n\n$$\nA^{RL}=\\begin{pmatrix}-c  2c-\\tau\\\\ 0  -c\\end{pmatrix},\\quad\nA^{RR}=\\begin{pmatrix}-2c+\\tau  c\\\\ c  0\\end{pmatrix}.\n$$\n\n在这些表达式中，罚项对应于与 $\\tau\\,j\\,j^{\\top}$ 成比例的秩一更新；具体来说，仅在 $A^{LL}$ 的 $(2,2)$ 元、 $A^{RR}$ 的 $(1,1)$ 元上加上 $\\tau$，并在非对角块 $A^{LR}$ 的 $(2,1)$ 元和 $A^{RL}$ 的 $(1,2)$ 元处减去 $\\tau$（这与外积结构一致）。\n\n3. 全局组装和傅里叶符号。在周期性边界条件下，每个单元将其体积矩阵贡献给对角块，而单元 $e$（左）和 $e+1$（右）之间的每个内部边将 $A^{LL}$ 贡献给块 $(e,e)$，将 $A^{LR}$ 贡献给块 $(e,e+1)$，将 $A^{RL}$ 贡献给块 $(e+1,e)$，并将 $A^{RR}$ 贡献给块 $(e+1,e+1)$。每个单元有两个相邻的边（左和右），因此单元 $e$ 的总对角块为\n\n$$\nK_{0}=A^{\\mathrm{vol}}+A^{LL}+A^{RR}.\n$$\n\n使用 $A^{\\mathrm{vol}}=\\frac{\\kappa}{h}\\begin{pmatrix}1  -1\\\\ -1  1\\end{pmatrix}=2c\\begin{pmatrix}1  -1\\\\ -1  1\\end{pmatrix}$ 以及 $A^{LL}$ 和 $A^{RR}$ 的表达式，我们得到\n\n$$\nK_{0}=2c\\begin{pmatrix}1  -1\\\\ -1  1\\end{pmatrix}+\\begin{pmatrix}-2c+\\tau  2c\\\\ 2c  -2c+\\tau\\end{pmatrix}=\\begin{pmatrix}\\tau  0\\\\ 0  \\tau\\end{pmatrix}.\n$$\n\n上、下非对角块分别为，\n\n$$\nK_{+1}=A^{LR}=\\begin{pmatrix}-c  0\\\\ 2c-\\tau  -c\\end{pmatrix},\\qquad\nK_{-1}=A^{RL}=\\begin{pmatrix}-c  2c-\\tau\\\\ 0  -c\\end{pmatrix}.\n$$\n\n因此，对于单元相位为 $\\theta$ 的模，其 $2\\times 2$ 块傅里叶符号 $S(\\theta)$ 为\n\n$$\nS(\\theta)=K_{0}+K_{+1}\\exp(i\\theta)+K_{-1}\\exp(-i\\theta)=\n\\begin{pmatrix}\n\\tau - c\\left(\\exp(i\\theta)+\\exp(-i\\theta)\\right)  & (2c-\\tau)\\exp(-i\\theta)\\\\\n(2c-\\tau)\\exp(i\\theta)  & \\tau - c\\left(\\exp(i\\theta)+\\exp(-i\\theta)\\right)\n\\end{pmatrix}.\n$$\n\n使用 $\\exp(i\\theta)+\\exp(-i\\theta)=2\\cos\\theta$，我们重写为\n\n$$\nS(\\theta)=\\begin{pmatrix}\n\\tau-2c\\cos\\theta  & (2c-\\tau)\\exp(-i\\theta)\\\\\n(2c-\\tau)\\exp(i\\theta)  & \\tau-2c\\cos\\theta\n\\end{pmatrix}.\n$$\n\n一个 $2\\times 2$ 矩阵，其对角元相等，为 $a=\\tau-2c\\cos\\theta$，非对角元为 $b=(2c-\\tau)\\exp(-i\\theta)$ 和 $\\overline{b}=(2c-\\tau)\\exp(i\\theta)$，其行列式为\n\n$$\n\\det S(\\theta)=a^{2}-|b|^{2}=\\left(\\tau-2c\\cos\\theta\\right)^{2}-(2c-\\tau)^{2}.\n$$\n\n代入 $c=\\frac{\\kappa}{2h}$ 和 $\\tau=\\eta\\frac{\\kappa}{h}$，得到 $2c=\\frac{\\kappa}{h}$ 以及\n\n$$\n\\det S(\\theta)=\\left(\\frac{\\kappa}{h}\\right)^{2}\\left[(\\eta-\\cos\\theta)^{2}-(1-\\eta)^{2}\\right].\n$$\n\n这个表达式可以使用平方差公式进行因式分解：\n\n$$\n(\\eta-\\cos\\theta)^{2}-(1-\\eta)^{2}=\\left((\\eta-\\cos\\theta)-(1-\\eta)\\right)\\left((\\eta-\\cos\\theta)+(1-\\eta)\\right)\n=\\left(2\\eta-1-\\cos\\theta\\right)\\left(1-\\cos\\theta\\right).\n$$\n\n因此，\n\n$$\n\\det S(\\theta)=\\left(\\frac{\\kappa}{h}\\right)^{2}\\left(1-\\cos\\theta\\right)\\left(2\\eta-1-\\cos\\theta\\right).\n$$\n\n这就是所求的关于 $\\kappa$、$\\eta$、$h$ 和 $\\theta$ 的闭式表达式。",
            "answer": "$$\\boxed{\\left(\\frac{\\kappa}{h}\\right)^{2}\\left(1-\\cos\\theta\\right)\\left(2\\eta-1-\\cos\\theta\\right)}$$"
        },
        {
            "introduction": "在学习了如何构建 SIPG 系统之后，我们来探讨为何罚分项如此关键。本练习通过构建一个特定的振荡函数来探索稳定性的概念。虽然这个函数不具备物理意义，但它是不连续函数空间中的一个有效成员 ()。通过计算其“能量”，您将揭示罚分参数 $\\sigma$ 如何抑制这类伪模式并保证方法的稳定性。",
            "id": "3410396",
            "problem": "考虑在一维域 $[0,1]$ 上定义的标量泊松方程 $-u'' = f$，其具有齐次狄利克雷边界条件 $u(0) = 0$ 和 $u(1) = 0$。设 $\\mathcal{T}_h$ 是 $[0,1]$ 的一个协调剖分，将其划分为两个相等的子区间（单元），节点位于 $x=0$、$x=1/2$ 和 $x=1$，因此单元尺寸为 $h = 1/2$。设 $V_h$ 是 $\\mathcal{T}_h$ 上的分片常数函数空间，这些函数允许在界面 $x=1/2$ 处不连续。考虑对称内部罚函数伽辽金 (SIPG) 方法，其中每个边 $e$ 上的内部罚参数取为 $\\sigma/h$（$\\sigma > 0$），并且通过 Nitsche 方法弱施加狄利克雷边界条件。使用标准的不连续伽辽金跳跃和平均的定义：在内部界面 $x=1/2$ 处，跳跃为 $[u] = u^{-} - u^{+}$，平均为 $\\{u'\\} = (u'^{-} + u'^{+})/2$，其中上标分别表示来自左、右单元的迹；在边界处，迹 $u$ 取自相邻单元，并使用外法线。\n\n构造振荡离散模式 $u_h \\in V_h$，其在左单元 $[0,1/2)$ 上取值为 $u_h(x) = 1$，在右单元 $(1/2,1]$ 上取值为 $u_h(x) = -1$。从泊松算子的 SIPG 方法的基本双线性形式和齐次狄利克雷边界条件的 Nitsche 施加方法出发，推导内部罚能量 $a(u_h,u_h)$——即，将 $u_h$ 作为两个参数代入 SIPG 双线性形式求得的值。你的推导必须从破碎梯度、跳跃和平均算子以及罚项缩放的定义出发。最后，给出对于这个 $h=1/2$ 的网格，$a(u_h,u_h)$ 作为 $\\sigma$ 的函数的闭式解析表达式。\n\n答案格式要求：将 $a(u_h,u_h)$ 报告为仅依赖于 $\\sigma$ 的单个符号表达式。无需进行数值舍入。在你的构造和推导中，解释为什么这种振荡模式在连续有限元方法中是不被允许的，但在内部罚框架下的“罚不足”情况下却可以具有很小的能量。",
            "solution": "首先验证该问题以确保其具有科学依据、适定且客观。问题陈述描述了一维泊松方程的对称内部罚函数伽辽金 (SIPG) 方法的一个标准应用。所有术语，如双线性形式、跳跃和平均算子以及用于边界条件的 Nitsche 方法，在偏微分方程数值分析领域都是标准的。所提供的网格、有限元空间以及特定函数 $u_h$ 的数据是完整且一致的。因此，该问题被认为是有效的，可以构建一个解。\n\n对于定义在 $\\Omega = [0,1]$ 上且在 $\\partial\\Omega$ 上具有齐次狄利克雷边界条件 $u=0$ 的泊松问题 $-u'' = f$，其 SIPG 提法旨在寻求一个函数 $u_h \\in V_h$，使得对所有 $v_h \\in V_h$ 都有 $a(u_h, v_h) = L(v_h)$。双线性形式 $a(u,v)$ 由下式给出：\n$$\na(u,v) = \\sum_{K \\in \\mathcal{T}_h} \\int_K u' v' \\, dx - \\sum_{e \\in \\mathcal{E}_h^i} \\left( \\{u'\\} [v] + \\{v'\\} [u] \\right)|_e + \\sum_{e \\in \\mathcal{E}_h^i} \\frac{\\sigma}{h_e} [u] [v]|_e - \\sum_{e \\in \\mathcal{E}_h^b} \\left( u' n_K v + v' n_K u \\right)|_e + \\sum_{e \\in \\mathcal{E}_h^b} \\frac{\\sigma}{h_e} u v|_e\n$$\n这里，$\\mathcal{E}_h^i$ 是内部边的集合，$\\mathcal{E}_h^b$ 是边界边的集合。对于我们的特定问题，当 $u=v$ 时，此表达式变为：\n$$\na(u,u) = \\sum_{K \\in \\mathcal{T}_h} \\int_K (u')^2 \\, dx - \\sum_{e \\in \\mathcal{E}_h^i} 2 \\{u'\\} [u]|_e + \\sum_{e \\in \\mathcal{E}_h^i} \\frac{\\sigma}{h_e} [u]^2|_e - \\sum_{e \\in \\mathcal{E}_h^b} 2 u' n_K u|_e + \\sum_{e \\in \\mathcal{E}_h^b} \\frac{\\sigma}{h_e} u^2|_e\n$$\n域 $[0,1]$ 被剖分为两个单元，$K_1 = [0, 1/2]$ 和 $K_2 = [1/2, 1]$。单元尺寸为 $h=1/2$。内部边是 $e_i = \\{1/2\\}$，边界边是 $e_{b0} = \\{0\\}$ 和 $e_{b1} = \\{1\\}$。域 $\\Omega$ 的单位外法线在 $x=0$ 处为 $n_K = -1$，在 $x=1$ 处为 $n_K = 1$。\n\n离散函数 $u_h \\in V_h$ 定义为：\n$$\nu_h(x) = \\begin{cases} 1  \\text{ for } x \\in K_1 = [0, 1/2] \\\\ -1  \\text{ for } x \\in K_2 = (1/2, 1] \\end{cases}\n$$\n由于 $u_h$ 是一个分片常数函数，其在每个单元内的导数为零：对于 $x \\in (0, 1/2)$ 和 $x \\in (1/2, 1)$，$u_h'(x) = 0$。\n\n我们现在计算 $a(u_h, u_h)$ 的每一项：\n\n1.  **体项**：此项度量了单元内梯度的能量。由于 $u_h'$ 几乎处处为零，此项为零。\n    $$\n    \\sum_{K \\in \\mathcal{T}_h} \\int_K (u_h')^2 \\, dx = \\int_{0}^{1/2} (0)^2 \\, dx + \\int_{1/2}^{1} (0)^2 \\, dx = 0\n    $$\n\n2.  **内部边项**：此项在单个内部边 $e_i = \\{1/2\\}$ 处计算。我们首先计算必要的迹、跳跃和平均。\n    -   来自左侧 ($^-$) 和右侧 ($^+$) 的迹：\n        $$\n        u_h^- = \\lim_{x \\to 1/2^-} u_h(x) = 1\n        $$\n        $$\n        u_h^+ = \\lim_{x \\to 1/2^+} u_h(x) = -1\n        $$\n    -   $u_h$ 的跳跃：\n        $$\n        [u_h]|_{1/2} = u_h^- - u_h^+ = 1 - (-1) = 2\n        $$\n    -   导数的迹：\n        $$\n        (u_h')^- = \\lim_{x \\to 1/2^-} u_h'(x) = 0\n        $$\n        $$\n        (u_h')^+ = \\lim_{x \\to 1/2^+} u_h'(x) = 0\n        $$\n    -   导数的平均：\n        $$\n        \\{u_h'\\}|_{1/2} = \\frac{(u_h')^- + (u_h')^+}{2} = \\frac{0 + 0}{2} = 0\n        $$\n    内部边的贡献包括一致性/对称性项和罚项。\n    -   一致性/对称性：$- 2 \\{u_h'\\} [u_h]|_{1/2} = -2 \\cdot (0) \\cdot (2) = 0$。\n    -   罚项：$\\frac{\\sigma}{h} [u_h]^2|_{1/2}$。当 $h=1/2$ 时，此项为 $\\frac{\\sigma}{1/2} (2)^2 = 2\\sigma \\cdot 4 = 8\\sigma$。\n    内部边的总贡献为 $0 + 8\\sigma = 8\\sigma$。\n\n3.  **边界边项**：这些项在 $e_{b0}=0$ 和 $e_{b1}=1$ 处计算。\n    -   **在 $x=0$ 处**：迹取自单元 $K_1$ 内部。外法线为 $n_K = -1$。\n        -   $u_h$ 的迹：$u_h|_0 = u_h(0^+) = 1$。\n        -   $u_h'$ 的迹：$u_h'|_0 = u_h'(0^+) = 0$。\n        -   其贡献为 $-2 u_h' n_K u_h|_0 + \\frac{\\sigma}{h} u_h^2|_0 = -2 \\cdot (0) \\cdot (-1) \\cdot (1) + \\frac{\\sigma}{1/2} (1)^2 = 0 + 2\\sigma = 2\\sigma$。\n    -   **在 $x=1$ 处**：迹取自单元 $K_2$ 内部。外法线为 $n_K = 1$。\n        -   $u_h$ 的迹：$u_h|_1 = u_h(1^-) = -1$。\n        -   $u_h'$ 的迹：$u_h'|_1 = u_h'(1^-) = 0$。\n        -   其贡献为 $-2 u_h' n_K u_h|_1 + \\frac{\\sigma}{h} u_h^2|_1 = -2 \\cdot (0) \\cdot (1) \\cdot (-1) + \\frac{\\sigma}{1/2} (-1)^2 = 0 + 2\\sigma = 2\\sigma$。\n    边界边的总贡献为 $2\\sigma + 2\\sigma = 4\\sigma$。\n\n4.  **总内部罚能量**：我们将所有贡献相加。\n    $$\n    a(u_h, u_h) = (\\text{Volume Term}) + (\\text{Interior Face Term}) + (\\text{Boundary Face Terms})\n    $$\n    $$\n    a(u_h, u_h) = 0 + 8\\sigma + 4\\sigma = 12\\sigma\n    $$\n\n对此结果的解释如下。在标准的连续有限元方法 (CG-FEM) 中，试探函数和检验函数必须属于 Sobolev 空间 $H^1([0,1])$，这要求它们是连续的。函数 $u_h$ 在 $x=1/2$ 处有跳跃间断点，因此不属于 $H^1([0,1])$。它在 CG-FEM 空间中根本不是一个容许函数，因此是“不被允许的”。\n\n在不连续伽辽金 (DG) 框架中，函数空间 $V_h$ 允许这种不连续性。函数 $u_h$ 是分片常数空间的一个有效成员。由双线性形式 $a(u_h, u_h)$ 度量的其“能量”为 $12\\sigma$。由于体（梯度）项为零，该能量完全源于内部边和边界边上的罚项。此能量的大小与罚参数 $\\sigma$ 成正比。如果选择的 $\\sigma$ 非常小（这种情况被称为“罚不足”），这个高度振荡的模式 $u_h$ 将具有非常小的能量。一个稳定的 DG 方法依赖于足够大的 $\\sigma$ 来确保这种非物理振荡被赋予大的能量，从而在数值解中有效地抑制它们。存在这样一个能量与 $\\sigma$ 成正比的模式，证明了罚参数在控制单元间跳跃和稳定 DG 方法方面的关键作用。\n\n最终推导出的内部罚能量表达式为 $a(u_h, u_h) = 12\\sigma$。",
            "answer": "$$\\boxed{12\\sigma}$$"
        },
        {
            "introduction": "最后一个练习将我们的焦点从对称方法 (SIPG) 转移到非对称方法 (NIPG)，以突显两者在性能上的一个关键理论差异。通过使用对偶论证 (duality argument)，您将推导 NIPG 方法在 $L^2$ 范数下的收敛阶 ()。这个练习将阐明，作为 NIPG 的一个决定性特征，对称性的丧失如何导致伴随一致性 (adjoint consistency) 的缺失，并最终导致其收敛阶低于 SIPG 所能达到的最优阶。",
            "id": "3410414",
            "problem": "考虑单位区间 $\\,\\Omega=(0,1)\\,$ 上的标量扩散模型问题，其带有齐次狄利克雷边界条件：\n$$\n- u'' = f \\quad \\text{in } \\Omega,\\qquad u=0 \\quad \\text{on } \\partial\\Omega.\n$$\n设精确解为 $\\,u(x)=\\sin(\\pi x)\\,$，从而 $\\,f(x)=\\pi^{2}\\sin(\\pi x)\\,$。设 $\\,\\mathcal{T}_{h}\\,$ 是 $\\,\\Omega\\,$ 的一个均匀剖分，将其分为 $\\,N\\,$ 个长度为 $\\,h=1/N\\,$ 的子区间，并设 $\\,V_{h}\\,$ 为在每个单元上是次数至多为 $\\,1\\,$ 的多项式（分片线性）且不要求在单元交界面上连续的函数所构成的空间。对于一个内部节点 $\\,x_{i}\\,$，将 $\\,v\\in V_{h}\\,$ 的迹记为 $\\,v(x_{i}^{-})\\,$ 和 $\\,v(x_{i}^{+})\\,$，并定义跳跃项和平均项为\n$$\n[v]_{i} := v(x_{i}^{-}) - v(x_{i}^{+}),\\qquad \\{v'\\}_{i} := \\tfrac{1}{2}\\big(v'(x_{i}^{-})+v'(x_{i}^{+})\\big).\n$$\n在边界上，设 $\\,n(0)=-1\\,$ 和 $\\,n(1)=+1\\,$。定义非对称内部罚分伽辽金 (NIPG) 双线性形式 $\\,a_{h}(\\cdot,\\cdot)\\,$ 和右端项 $\\,\\ell_{h}(\\cdot)\\,$ 如下\n$$\na_{h}(w,v) := \\sum_{K\\in\\mathcal{T}_{h}}\\int_{K} w'v'\\,dx \\;-\\; \\sum_{i=1}^{N-1} \\{\\partial_{x} w\\}_{i}\\,[v]_{i} \\;+\\; \\sum_{i=1}^{N-1} \\{\\partial_{x} v\\}_{i}\\,[w]_{i} \\;+\\; \\frac{\\eta}{h}\\sum_{i=1}^{N-1}[w]_{i}[v]_{i}\n$$\n$$\n\\phantom{a_{h}(w,v) :=}\\;\\;-\\; w'(0)\\,n(0)\\,v(0) + v'(0)\\,n(0)\\,w(0) + \\frac{\\eta}{h}\\,w(0)\\,v(0)\\;-\\; w'(1)\\,n(1)\\,v(1) + v'(1)\\,n(1)\\,w(1) + \\frac{\\eta}{h}\\,w(1)\\,v(1),\n$$\n$$\n\\ell_{h}(v) := \\sum_{K\\in\\mathcal{T}_{h}}\\int_{K} f\\, v\\,dx,\n$$\n其中罚参数 $\\,\\eta>0\\,$ 的选取与 $\\,h\\,$ 无关，且足够大以保证在离散能量范数下的矫顽性\n$$\n\\|v\\|_{1,h}^{2} := \\sum_{K\\in\\mathcal{T}_{h}} \\int_{K} |v'|^{2}\\,dx \\;+\\; \\frac{\\eta}{h}\\sum_{i=1}^{N-1}[v]_{i}^{2} \\;+\\; \\frac{\\eta}{h}\\big(v(0)^{2}+v(1)^{2}\\big).\n$$\nNIPG方法旨在求解 $\\,u_{h}\\in V_{h}\\,$，使得\n$$\na_{h}(u_{h},v_{h})=\\ell_{h}(v_{h})\\qquad\\text{对所有 } v_{h}\\in V_{h}.\n$$\n已知此格式是相容和矫顽的，因此在使用分片线性函数时能达到最优的能量范数收敛率。然而，其非对称性导致了伴随相容性的丧失。\n\n仅使用上述基本定义、逐单元分部积分、跳跃/平均算子、一维狄利克雷拉普拉斯算子的对偶解的稳定性以及标准逼近和迹不等式，推导最大指数 $\\,p_{L^{2}}\\,$，使得存在一个与 $\\,h\\,$ 无关的常数 $\\,C>0\\,$，满足\n$$\n\\|u-u_{h}\\|_{L^{2}(\\Omega)} \\;\\le\\; C\\, h^{\\,p_{L^{2}}}\\,\\|u\\|_{H^{2}(\\Omega)}\\quad\\text{as } h\\to 0,\n$$\n对于上面定义的使用分片线性逼近的非对称内部罚分伽辽金法。给出 $\\,p_{L^{2}}\\,$ 的值。最终答案必须是一个无单位的数字。无需四舍五入。",
            "solution": "用户希望找到应用于一维泊松问题 $-u''=f$（在 $\\Omega=(0,1)$ 上，带有齐次狄利克雷边界条件）的非对称内部罚分伽辽金 (NIPG) 方法在 $L^2$-范数下的收敛率。\n\n### 步骤 1：问题验证\n问题陈述清晰而完整地定义了一个标量扩散模型问题、其精确解、有限元空间 $V_h$、NIPG双线性和线性形式以及离散范数。任务是使用指定的数学工具，在先验误差估计 $\\|u-u_h\\|_{L^2(\\Omega)} \\leq C h^{p_{L^2}} \\|u\\|_{H^2(\\Omega)}$ 中推导出指数 $p_{L^2}$。问题正确地指出了 NIPG 形式的非对称性会导致伴随相容性的丧失，这是影响 $L^2$ 收敛率的一个关键特征。所有定义和概念在偏微分方程数值分析领域都是标准的。该问题具有科学依据、良定、客观，并需要一个不平凡的数学推导。该问题被认为是**有效的**。\n\n### 步骤 2：$L^2$ 误差估计的推导\n\n有限元方法的 $L^2$ 误差估计的推导通常通过对偶论证进行，也称为 Aubin-Nitsche 技巧。\n\n设 $e=u-u_h$ 为精确解 $u$ 和 NIPG 解 $u_h$ 之间的误差。我们希望估计 $\\|e\\|_{L^2(\\Omega)}$。\n考虑对偶（或伴随）问题：求 $\\phi$ 使得\n$$\n-\\phi'' = e \\quad \\text{in } \\Omega, \\qquad \\phi=0 \\quad \\text{on } \\partial\\Omega.\n$$\n由于 $\\Omega=(0,1)$ 是一个凸区域，该问题有唯一解 $\\phi$。标准的椭圆正则性理论保证 $\\phi \\in H^2(\\Omega)$，并且存在一个不依赖于 $e$ 的稳定性常数 $C_s$，使得\n$$\n\\|\\phi\\|_{H^2(\\Omega)} \\le C_s \\|e\\|_{L^2(\\Omega)}.\n$$\n此外，由于我们在一维空间中，$\\phi \\in C^1(\\bar{\\Omega})$。\n\n使用对偶问题，我们可以将误差的 $L^2$-范数的平方表示为：\n$$\n\\|e\\|_{L^2(\\Omega)}^2 = \\int_{\\Omega} e \\cdot e \\, dx = \\int_{\\Omega} e (-\\phi'') \\, dx.\n$$\n因为离散解 $u_h$（以及误差 $e$）是不连续的，我们必须逐单元进行分部积分：\n$$\n\\|e\\|_{L^2(\\Omega)}^2 = \\sum_{K \\in \\mathcal{T}_h} \\int_K e (-\\phi'') \\, dx = \\sum_{K \\in \\mathcal{T}_h} \\left( \\int_K e' \\phi' \\, dx - [e \\phi']_{\\partial K} \\right).\n$$\n对于一个单元 $K=(x_{k-1}, x_k)$，边界项 $[e \\phi']_{\\partial K}$ 是 $e(x_k)\\phi'(x_k) - e(x_{k-1})\\phi'(x_{k-1})$。对所有单元 $K \\in \\mathcal{T}_h$ 求和，内部边界项会成对出现。使用跳跃项记号 $[v]_i = v(x_i^-) - v(x_i^+)$ 以及 $\\phi'$ 是连续的（因此 $\\phi'(x_i^-) = \\phi'(x_i^+) = \\phi'(x_i) =: \\{\\phi'\\}_i$）这一事实，内部边界项之和为：\n$$\n\\sum_{i=1}^{N-1} (e(x_i^-)\\phi'(x_i) - e(x_i^+)\\phi'(x_i)) = \\sum_{i=1}^{N-1} [e]_i \\{\\phi'\\}_i.\n$$\n在区域边界 $\\partial\\Omega=\\{0,1\\}$ 处的项是 $e(1)\\phi'(1) - e(0)\\phi'(0)$。我们使用外法线定义 $n(0)=-1, n(1)=1$ 将其写为 $e(1)\\phi'(1)n(1) + e(0)\\phi'(0)n(0)$。\n因此，\n$$\n\\sum_{K \\in \\mathcal{T}_h} [e \\phi']_{\\partial K} = \\sum_{i=1}^{N-1} [e]_i \\{\\phi'\\}_i + e(1)\\phi'(1)n(1)+e(0)\\phi'(0)n(0).\n$$\n将其代回，我们得到：\n$$\n\\|e\\|_{L^2(\\Omega)}^2 = \\sum_{K \\in \\mathcal{T}_h} \\int_K e' \\phi' \\, dx - \\sum_{i=1}^{N-1} [e]_i \\{\\phi'\\}_i - \\sum_{j \\in \\{0,1\\}} e(x_j)\\phi'(x_j)n(j).\n$$\n我们将此表达式称为 $\\mathcal{B}(e, \\phi)$。\n\nNIPG 解 $u_h$ 满足 $a_h(u_h, v_h) = \\ell_h(v_h)$ 对所有 $v_h \\in V_h$ 成立。精确解 $u$ 是光滑的，所以 $[u]_i=0$ 且在 $\\partial\\Omega$ 上 $u=0$。通过分部积分的直接计算表明该方法是相容的：$a_h(u, v_h) = \\ell_h(v_h)$ 对所有 $v_h \\in V_h$ 成立。\n两式相减得到误差 $e=u-u_h$ 的伽辽金正交性：\n$$\na_h(e, v_h) = 0 \\quad \\text{对所有 } v_h \\in V_h.\n$$\n设 $\\phi_h \\in V_h$ 是 $\\phi$ 的一个合适的插值。由于 $\\phi_h \\in V_h$，我们可以将其用作伽辽金正交关系中的检验函数，因此 $a_h(e, \\phi_h) = 0$。\n现在我们可以写出：\n$$\n\\|e\\|_{L^2(\\Omega)}^2 = \\mathcal{B}(e, \\phi) - a_h(e, \\phi_h) = \\left( \\mathcal{B}(e, \\phi) - a_h(e, \\phi) \\right) + a_h(e, \\phi - \\phi_h).\n$$\n这将误差分为两项。第一项源于伴随相容性的缺乏，第二项是对偶论证中的标准项。\n\n**第二项分析：$a_h(e, \\phi - \\phi_h)$**\n设 $\\eta_\\phi = \\phi - \\phi_h$。根据双线性形式 $a_h(\\cdot, \\cdot)$ 关于离散能量范数 $\\|\\cdot\\|_{1,h}$ 的连续性，我们有：\n$$\n|a_h(e, \\eta_\\phi)| \\le C \\|e\\|_{1,h} \\|\\eta_\\phi\\|_{1,h}.\n$$\n问题陈述中提到 NIPG 格式达到了最优的能量范数收敛率。对于分片线性逼近 ($k=1$)，这意味着 $\\|e\\|_{1,h} \\le C h \\|u\\|_{H^2(\\Omega)}$。标准逼近理论提供了插值误差估计 $\\|\\eta_\\phi\\|_{1,h} \\le C h \\|\\phi\\|_{H^2(\\Omega)}$。将这些与正则性估计 $\\|\\phi\\|_{H^2(\\Omega)} \\le C_s \\|e\\|_{L^2(\\Omega)}$ 结合起来，我们得到：\n$$\n|a_h(e, \\eta_\\phi)| \\le C (h \\|u\\|_{H^2(\\Omega)}) (h \\|\\phi\\|_{H^2(\\Omega)}) \\le C' h^2 \\|u\\|_{H^2(\\Omega)} \\|e\\|_{L^2(\\Omega)}.\n$$\n\n**第一项分析：$\\mathcal{B}(e, \\phi) - a_h(e, \\phi)$**\n这一项表示伴随不相容性。我们需要计算 $a_h(e, \\phi)$。由于 $\\phi$ 是一个在 $\\partial\\Omega$ 上为零的光滑函数，我们有 $[\\phi]_i=0$ 和 $\\phi(0)=\\phi(1)=0$。双线性形式 $a_h(e, \\phi)$ 简化为：\n$$\na_h(e, \\phi) = \\sum_{K}\\int_{K} e'\\phi'\\,dx + \\sum_{i} \\{\\phi'\\}_{i}\\,[e]_{i} + \\sum_{j \\in \\{0,1\\}} \\phi'(j)\\,n(j)\\,e(j).\n$$\n那么差值项为：\n\\begin{align*}\n\\mathcal{B}(e, \\phi) - a_h(e, \\phi) = \\left( \\sum_K \\int_K e'\\phi' - \\sum_i [e]_i\\{\\phi'\\}_i - \\sum_j e(j)\\phi'(j) n(j) \\right) \\\\\n \\quad - \\left( \\sum_K \\int_K e'\\phi' + \\sum_i \\{\\phi'\\}_i[e]_i + \\sum_j \\phi'(j) n(j) e(j) \\right) \\\\\n= -2 \\left( \\sum_{i=1}^{N-1} [e]_i \\{\\phi'\\}_i + \\sum_{j \\in \\{0,1\\}} e(j)\\phi'(j)n(j) \\right).\n\\end{align*}\n我们使用柯西-施瓦茨不等式来界定这一项。由于 $e = u-u_h$ 且 $u$ 是连续的并在 $\\partial\\Omega$ 上为零，我们有 $[e]_i = -[u_h]_i$ 和 $e(j)=-u_h(j)$。\n伴随不相容性项的大小为：\n$$\n| \\mathcal{B}(e, \\phi) - a_h(e, \\phi) | \\le 2 \\left| \\sum_{i=1}^{N-1} [e]_i \\{\\phi'\\}_i \\right| + 2 \\left| \\sum_{j \\in \\{0,1\\}} e(j)\\phi'(j)n(j) \\right|.\n$$\n对于内部和：\n$$\n\\left| \\sum_{i=1}^{N-1} [e]_i \\{\\phi'\\}_i \\right| \\le \\left( \\sum_{i=1}^{N-1} [e]_i^2 \\right)^{1/2} \\left( \\sum_{i=1}^{N-1} (\\{\\phi'\\}_i)^2 \\right)^{1/2}.\n$$\n根据离散范数的定义，$(\\frac{\\eta}{h} \\sum [e]_i^2)^{1/2} \\le \\|e\\|_{1,h}$。因此，$(\\sum [e]_i^2)^{1/2} \\le \\sqrt{h/\\eta} \\|e\\|_{1,h}$。使用能量估计，这给出 $(\\sum [e]_i^2)^{1/2} \\le C h^{3/2} \\|u\\|_{H^2(\\Omega)}$。\n对于对偶解的导数，标准的迹不等式和黎曼和论证表明 $(\\sum (\\{\\phi'\\}_i)^2)^{1/2} \\le C h^{-1/2} \\|\\phi\\|_{H^2(\\Omega)}$。\n乘积的界为：\n$$\n\\left| \\sum [e]_i \\{\\phi'\\}_i \\right| \\le (C h^{3/2} \\|u\\|_{H^2}) (C' h^{-1/2} \\|\\phi\\|_{H^2}) \\le C'' h \\|u\\|_{H^2} \\|\\phi\\|_{H^2}.\n$$\n类似地，对于边界项， $|e(j)| \\le \\sqrt{h/\\eta}\\|e\\|_{1,h} \\le C h^{3/2}\\|u\\|_{H^2}$ 且 $|\\phi'(j)| \\le C\\|\\phi\\|_{H^2}$，因此它们的贡献是 $h^{3/2}$ 阶的，这个值更小。\n使用对 $\\phi$ 的正则性估计：\n$$\n|\\mathcal{B}(e, \\phi) - a_h(e, \\phi)| \\le C h \\|u\\|_{H^2(\\Omega)} \\|e\\|_{L^2(\\Omega)}.\n$$\n\n**最终组合与结果**\n结合两项的界：\n$$\n\\|e\\|_{L^2(\\Omega)}^2 \\le C' h^2 \\|u\\|_{H^2(\\Omega)} \\|e\\|_{L^2(\\Omega)} + C h \\|u\\|_{H^2(\\Omega)} \\|e\\|_{L^2(\\Omega)}.\n$$\n对于足够小的 $h$， $h$ 的较低次幂项占主导地位。\n因此：\n$$\n\\|e\\|_{L^2(\\Omega)}^2 \\le C h \\|u\\|_{H^2(\\Omega)} \\|e\\|_{L^2(\\Omega)}.\n$$\n两边同除以 $\\|e\\|_{L^2(\\Omega)}$（假设 $e \\neq 0$），我们得到最终的误差估计：\n$$\n\\|e\\|_{L^2(\\Omega)} \\le C h \\|u\\|_{H^2(\\Omega)}.\n$$\n这对应于形式为 $\\|u-u_h\\|_{L^2(\\Omega)} \\le C h^{p_{L^2}} \\|u\\|_{H^2(\\Omega)}$ 的先验误差估计，其中 $p_{L^2} = 1$。\n伴随相容性的丧失将 $L^2$-范数下的收敛率从最优的 $O(h^2)$（由对称方法如 SIPG 达到）降低到次优的 $O(h)$。\n\n最大指数是 $p_{L^2}=1$。",
            "answer": "$$\\boxed{1}$$"
        }
    ]
}