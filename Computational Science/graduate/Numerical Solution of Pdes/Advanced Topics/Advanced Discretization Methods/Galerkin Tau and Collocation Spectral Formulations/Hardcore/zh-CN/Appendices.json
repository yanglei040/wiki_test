{
    "hands_on_practices": [
        {
            "introduction": "伽辽金（Galerkin）方法的核心是将连续的微分方程问题转化为离散的线性代数系统。这个练习将带你亲手构建该系统的关键组成部分——质量矩阵 $M$ 和刚度矩阵 $K$。通过为切比雪夫（Chebyshev）多项式基函数计算这些矩阵的元素，你将深入理解如何将一个微分算子的弱形式具体地表示为矩阵，并体会到谱方法中基函数选择对系统性质的影响。",
            "id": "3398055",
            "problem": "考虑在第一类切比雪夫多项式的模态基上，求解区间 $[-1,1]$ 上的一维二阶线性椭圆算子的对称伽辽金法。设试探空间和检验空间由 $\\{T_{0}(x),T_{1}(x),T_{2}(x)\\}$ 张成，其中 $T_{m}(x) = \\cos(m \\arccos(x))$。定义质量矩阵 $M \\in \\mathbb{R}^{3 \\times 3}$ 和刚度矩阵 $K \\in \\mathbb{R}^{3 \\times 3}$ 为\n$$\nM_{mn} = \\int_{-1}^{1} T_{m}(x)\\,T_{n}(x)\\,dx, \\qquad\nK_{mn} = \\int_{-1}^{1} T_{m}'(x)\\,T_{n}'(x)\\,dx,\n$$\n其中 $m,n \\in \\{0,1,2\\}$，并使用克伦肖-柯蒂斯求积法来近似这些积分。使用 $N=4$ 个切比雪夫-洛巴托节点 $x_{k} = \\cos\\!\\left(\\frac{k\\pi}{4}\\right)$，$k=0,1,2,3,4$，并通过要求该求积法则对所有次数不超过 $4$ 的多项式都精确来确定求积权重 $\\{w_{k}\\}_{k=0}^{4}$。\n\n您可以使用任何等价的表示来计算所得矩阵的元素，但必须证明克伦肖-柯蒂斯求积法对于这些特定元素的精确性。然后，将注意力限制在非常数子空间 $\\operatorname{span}\\{T_{1},T_{2}\\}$ 上，其中刚度矩阵是非奇异的，并在此二维子空间上构造广义特征值算子 $A = M^{-1}K$。最后，通过计算 $A$ 在 $\\operatorname{span}\\{T_{1},T_{2}\\}$ 上的谱条件数（定义为该子空间上最大特征值与最小特征值之比），来量化端点聚类对数值条件的影响。将您的最终答案表示为一个无单位的精确有理数。",
            "solution": "我们从伽辽金法和切比雪夫多项式的核心定义开始。第一类切比雪夫多项式满足 $T_m(x) = \\cos(m\\theta)$，其中 $x=\\cos\\theta$，$\\theta \\in [0,\\pi]$。它们关于 $x$ 的导数由下式给出\n$$\n\\frac{d}{dx}T_{m}(x) = m\\,U_{m-1}(x),\n$$\n其中 $U_{n}$ 是第二类切比雪夫多项式，由 $U_n(\\cos\\theta)=\\frac{\\sin((n+1)\\theta)}{\\sin\\theta}$ 导出。\n\n克伦肖-柯蒂斯求积法使用切比雪夫-洛巴托节点 $x_k=\\cos\\!\\left(\\frac{k\\pi}{N}\\right)$（$k=0,\\dots,N$），并分配权重 $\\{w_k\\}$，使得该插值型求积对于所有次数不超过 $N$ 的多项式都是精确的。对于 $N=4$，节点为\n$$\nx_0=1,\\quad x_1=\\frac{\\sqrt{2}}{2},\\quad x_2=0,\\quad x_3=-\\frac{\\sqrt{2}}{2},\\quad x_4=-1.\n$$\n我们确定权重 $w_k$，使得对于 $p=0,1,2,3,4$，\n$$\n\\sum_{k=0}^{4} w_k\\,x_k^{p} = \\int_{-1}^{1} x^{p}\\,dx =\n\\begin{cases}\n\\frac{2}{p+1}, & p \\text{ 为偶数},\\\\\n0, & p \\text{ 为奇数}.\n\\end{cases}\n$$\n根据节点的对称性，自然地可以设 $w_0=w_4=a$，$w_1=w_3=b$，$w_2=c$。当 $w_k$ 对称时，奇数阶矩的方程自动满足。偶数阶矩的方程得出\n$$\n\\begin{aligned}\n2a+2b+c&=2,\\\\\n2a+b&=\\frac{2}{3},\\\\\n2a+\\frac{b}{2}&=\\frac{2}{5}.\n\\end{aligned}\n$$\n解此方程组得 $b=\\frac{8}{15}$，$a=\\frac{1}{15}$，以及 $c=\\frac{4}{5}$。因此，克伦肖-柯蒂斯权重为\n$$\nw_0=w_4=\\frac{1}{15},\\qquad w_1=w_3=\\frac{8}{15},\\qquad w_2=\\frac{4}{5}.\n$$\n由于基函数是次数最多为 $2$ 的多项式，乘积 $T_m T_n$ 的次数最多为 $4$，类似地，对于 $m,n\\in\\{0,1,2\\}$，$T_m'\\,T_n'$ 的次数最多为 $2$，因此 $N=4$ 的克伦肖-柯蒂斯求积法对 $M$ 和 $K$ 的所有元素都是精确的。因此，我们可以通过解析积分计算 $M$ 和 $K$，并确信求积法会精确地复现这些结果。\n\n为了计算质量矩阵的元素，我们使用变量替换 $x=\\cos\\theta$，$dx=-\\sin\\theta\\,d\\theta$，并写出\n$$\nM_{mn} = \\int_{-1}^{1} T_m(x)\\,T_n(x)\\,dx\n= \\int_{0}^{\\pi} \\cos(m\\theta)\\,\\cos(n\\theta)\\,\\sin\\theta\\,d\\theta.\n$$\n使用积化和差恒等式 $\\cos(m\\theta)\\cos(n\\theta) = \\frac{1}{2}\\left[\\cos((m-n)\\theta)+\\cos((m+n)\\theta)\\right]$，我们将积分简化为\n$$\nM_{mn} = \\frac{1}{2}\\left[J(|m-n|) + J(m+n)\\right],\n$$\n其中\n$$\nJ(k) = \\int_{0}^{\\pi} \\cos(k\\theta)\\,\\sin\\theta\\,d\\theta.\n$$\n我们通过恒等式 $\\sin\\theta\\cos(k\\theta)=\\frac{1}{2}\\left[\\sin((k+1)\\theta)+\\sin((1-k)\\theta)\\right]$ 来计算 $J(k)$，并使用\n$$\n\\int_{0}^{\\pi} \\sin(\\ell\\theta)\\,d\\theta =\n\\begin{cases}\n\\frac{2}{\\ell}, & \\ell \\text{ 为奇数},\\\\\n0, & \\ell \\text{ 为偶数}.\n\\end{cases}\n$$\n对于整数 $k\\geq 0$，这得出\n$$\nJ(k) =\n\\begin{cases}\n2, & k=0,\\\\\n0, & k \\text{ 为奇数},\\\\\n\\frac{2}{1-k^{2}}, & k \\text{ 为偶数},\\ k\\geq 2.\n\\end{cases}\n$$\n因此，对于 $m,n\\in\\{0,1,2\\}$，我们得到\n$$\n\\begin{aligned}\nM_{00}&=\\frac{1}{2}[J(0)+J(0)]=2,\\\\\nM_{01}&=\\frac{1}{2}[J(1)+J(1)]=0,\\\\\nM_{02}&=\\frac{1}{2}[J(2)+J(2)]=\\frac{1}{2}\\left(-\\frac{2}{3}-\\frac{2}{3}\\right)=-\\frac{2}{3},\\\\\nM_{11}&=\\frac{1}{2}[J(0)+J(2)]=\\frac{1}{2}\\left(2-\\frac{2}{3}\\right)=\\frac{2}{3},\\\\\nM_{12}&=\\frac{1}{2}[J(1)+J(3)]=0,\\\\\nM_{22}&=\\frac{1}{2}[J(0)+J(4)]=\\frac{1}{2}\\left(2-\\frac{2}{15}\\right)=\\frac{14}{15}.\n\\end{aligned}\n$$\n因此，\n$$\nM = \\begin{pmatrix}\n2 & 0 & -\\frac{2}{3}\\\\\n0 & \\frac{2}{3} & 0\\\\\n-\\frac{2}{3} & 0 & \\frac{14}{15}\n\\end{pmatrix}.\n$$\n\n对于刚度矩阵，我们使用导数表示和相同的变量替换：\n$$\nK_{mn} = \\int_{-1}^{1} T_m'(x)\\,T_n'(x)\\,dx = \\int_{0}^{\\pi} \\frac{m\\,\\sin(m\\theta)}{\\sin\\theta}\\cdot \\frac{n\\,\\sin(n\\theta)}{\\sin\\theta}\\,\\sin\\theta\\,d\\theta\n= m n \\int_{0}^{\\pi} \\frac{\\sin(m\\theta)\\sin(n\\theta)}{\\sin\\theta}\\,d\\theta.\n$$\n对于 $m,n\\in\\{0,1,2\\}$，我们直接计算：\n- 当 $m=0$ 或 $n=0$ 时，$\\sin(0\\theta)=0$，所以 $K_{0n}=K_{n0}=0$。\n- 当 $m=n=1$ 时，\n$$\nK_{11} = 1\\cdot 1 \\int_{0}^{\\pi} \\frac{\\sin\\theta\\,\\sin\\theta}{\\sin\\theta}\\,d\\theta\n= \\int_{0}^{\\pi} \\sin\\theta\\,d\\theta = 2.\n$$\n- 当 $m=1,n=2$ 时，\n$$\nK_{12} = 1\\cdot 2 \\int_{0}^{\\pi} \\frac{\\sin\\theta\\,\\sin(2\\theta)}{\\sin\\theta}\\,d\\theta\n= 2 \\int_{0}^{\\pi} \\sin(2\\theta)\\,d\\theta = 0.\n$$\n- 当 $m=n=2$ 时，\n$$\nK_{22} = 2\\cdot 2 \\int_{0}^{\\pi} \\frac{\\sin(2\\theta)\\,\\sin(2\\theta)}{\\sin\\theta}\\,d\\theta\n= 4 \\int_{0}^{\\pi} \\frac{(2\\sin\\theta\\cos\\theta)^{2}}{\\sin\\theta}\\,d\\theta\n= 16 \\int_{0}^{\\pi} \\sin\\theta\\,\\cos^{2}\\theta\\,d\\theta.\n$$\n令 $u=\\cos\\theta$，$du=-\\sin\\theta\\,d\\theta$，且 $\\theta:0\\to\\pi$ 对应于 $u:1\\to -1$。则\n$$\nK_{22} = 16 \\int_{0}^{\\pi} \\sin\\theta\\,\\cos^{2}\\theta\\,d\\theta\n= -16 \\int_{1}^{-1} u^{2}\\,du\n= 16 \\int_{-1}^{1} u^{2}\\,du\n= 16 \\cdot \\frac{2}{3} = \\frac{32}{3}.\n$$\n因此，\n$$\nK = \\begin{pmatrix}\n0 & 0 & 0\\\\\n0 & 2 & 0\\\\\n0 & 0 & \\frac{32}{3}\n\\end{pmatrix}.\n$$\n\n我们现在限制在非常数子空间 $\\operatorname{span}\\{T_{1},T_{2}\\}$ 上，其中刚度矩阵是非奇异的。在这个子空间上，质量矩阵和刚度矩阵都是对角矩阵，其元素分别为 $M_{11}=\\frac{2}{3}$、$M_{22}=\\frac{14}{15}$ 和 $K_{11}=2$、$K_{22}=\\frac{32}{3}$。因此，广义算子 $A=M^{-1}K$ 是对角矩阵，其特征值为\n$$\n\\lambda_{1} = \\frac{K_{11}}{M_{11}} = \\frac{2}{2/3} = 3,\\qquad\n\\lambda_{2} = \\frac{K_{22}}{M_{22}} = \\frac{32/3}{14/15} = \\frac{32}{3}\\cdot\\frac{15}{14} = \\frac{80}{7}.\n$$\n$A$ 在 $\\operatorname{span}\\{T_{1},T_{2}\\}$ 上的谱条件数是其最大特征值与最小特征值之比，\n$$\n\\kappa(A) = \\frac{\\max\\{\\lambda_{1},\\lambda_{2}\\}}{\\min\\{\\lambda_{1},\\lambda_{2}\\}} = \\frac{80/7}{3} = \\frac{80}{21}.\n$$\n\n关于端点聚类的解释：切比雪夫-洛巴托节点在 $x=\\pm 1$ 附近聚集，当在能量内积中度量时，这会使得函数值和导数在端点附近的权重更大。随着多项式次数的增加，$T_{m}$ 的导数越来越集中在端点附近，而 $K_{mm}/M_{mm}$ 的相对大小随 $m$ 增长，从而增大了 $A$ 的特征值的分布范围。在这个低阶示例中，这表现为 $\\lambda_{2}$ 比 $\\lambda_{1}$ 大一个因子 $\\frac{80}{21}$，量化了在使用克伦肖-柯蒂斯求积的伽辽金离散化中，端点聚类对相关广义特征值问题条件数的影响。",
            "answer": "$$\\boxed{\\frac{80}{21}}$$"
        },
        {
            "introduction": "与伽辽金方法不同，陶（Tau）方法通过在模态空间中替换某些方程来施加边界条件，这提供了一种处理复杂边界的灵活方式。然而，这种灵活性也伴随着陷阱，如  所示。通过分析一个不正确的陶条件配置，你将揭示为什么必须用边界条件替换高阶模态方程，而不是低阶模态方程，从而理解该方法背后的深刻数学原理。",
            "id": "3397978",
            "problem": "考虑在区间 $[-1,1]$ 上的 Sturm–Liouville 特征值问题：\n$$-u''(x) = \\lambda\\, u(x), \\quad u(-1)=0, \\quad u(1)=0,$$\n该问题使用前 $N+1$ 个 Chebyshev 多项式 $\\{T_k(x)\\}_{k=0}^{N}$ 通过 Chebyshev 谱陶方法进行近似，其中在 $[-1,1]$ 上 $T_k(x) = \\cos(k \\arccos x)$。令 $N=3$，则近似空间由 $\\{T_0, T_1, T_2, T_3\\}$ 张成，并设近似解为\n$$u_3(x) = \\sum_{k=0}^{3} a_k\\, T_k(x).$$\n\n根据谱陶方法的定义，构建残差\n$$R(x) = -u_3''(x) - \\lambda\\, u_3(x),$$\n并强制要求 $R(x)$ 与一组选定的测试模态（在 Chebyshev 模态意义下）正交，而两个边界条件通过用边界方程替换两个模态方程来施加。对于二阶问题，数学上标准的陶方法配置强制要求与最低的两个模态 $T_0$ 和 $T_1$ 正交，并用边界条件替换 $T_2$ 和 $T_3$ 的方程。与此相反，考虑一种不正确的陶方法配置，它用边界条件替换 $T_0$ 和 $T_1$ 的方程，并仅强制要求 $R(x)$ 与最高的两个模态 $T_2$ 和 $T_3$ 正交。\n\n从上述定义和恒等式 $T_0(x)=1$, $T_1(x)=x$, $T_2(x)=2x^2-1$, $T_3(x)=4x^3-3x$，以及端点值 $T_k(1)=1$ 和 $T_k(-1)=(-1)^k$ 出发，推导由这种不正确的陶方法配置产生的代数系统，并证明它恰好移除了携带微分算子作用的模态方程，从而过度约束了系统，以至于对于任何 $\\lambda \\neq 0$，它只允许平凡解，或者只对一个伪特征值允许非平凡解。\n\n你的最终答案应该是这个不正确配置的陶方法系统所允许的伪特征值。以实数形式提供该值。无需四舍五入。",
            "solution": "设近似解为 $u_3(x) = \\sum_{k=0}^{3} a_k T_k(x)$。\n第一步是在Chebyshev基中表示二阶导数 $u_3''(x)$。对于Chebyshev级数 $u(x) = \\sum_{k=0}^{N} a_k T_k(x)$ 的二阶导数系数，一个标准结果是 $u''(x) = \\sum_{k=0}^{N-2} c_k^{(2)} T_k(x)$，其中系数 $c_k^{(2)}$ 由下式给出：\n$$c_k^{(2)} = \\frac{1}{\\bar{c}_k} \\sum_{p=k+2, \\, p+k \\text{ even}}^{N} p(p^2 - k^2) a_p$$\n其中 $\\bar{c}_0=2$ 且当 $k>0$ 时 $\\bar{c}_k=1$。\n\n在我们的例子中，$N=3$，因此二阶导数是一个次数最多为 1 的多项式，这意味着它是 $T_0(x)$ 和 $T_1(x)$ 的线性组合。\n$$u_3''(x) = c_0^{(2)} T_0(x) + c_1^{(2)} T_1(x)$$\n我们计算系数 $c_0^{(2)}$ 和 $c_1^{(2)}$。\n对于 $k=0$：\n$$c_0^{(2)} = \\frac{1}{2} \\sum_{p=2, \\, p \\text{ even}}^{3} p(p^2 - 0^2) a_p = \\frac{1}{2} \\left[ 2(2^2 - 0^2) a_2 \\right] = \\frac{1}{2}(8a_2) = 4a_2$$\n对于 $k=1$：\n$$c_1^{(2)} = \\frac{1}{1} \\sum_{p=3, \\, p \\text{ odd}}^{3} p(p^2 - 1^2) a_p = 3(3^2 - 1^2) a_3 = 3(8)a_3 = 24a_3$$\n因此，二阶导数为：\n$$u_3''(x) = 4a_2 T_0(x) + 24a_3 T_1(x)$$\n现在，我们构建残差 $R(x) = -u_3''(x) - \\lambda u_3(x)$：\n$$R(x) = -(4a_2 T_0(x) + 24a_3 T_1(x)) - \\lambda \\sum_{k=0}^{3} a_k T_k(x)$$\n按基函数 $T_k(x)$ 对各项进行分组：\n$$R(x) = (-4a_2 - \\lambda a_0) T_0(x) + (-24a_3 - \\lambda a_1) T_1(x) - \\lambda a_2 T_2(x) - \\lambda a_3 T_3(x)$$\n谱方法要求将残差在测试基中的系数设为零。这种“不正确”的方案强制要求与 $T_2$ 和 $T_3$ 正交。这意味着 $R(x)$ 展开式中 $T_2(x)$ 和 $T_3(x)$ 的系数必须为零。\n1. 与 $T_2(x)$ 正交：$-\\lambda a_2 = 0$\n2. 与 $T_3(x)$ 正交：$-\\lambda a_3 = 0$\n\n这两个方程替换了 $T_0$ 和 $T_1$ 的模态方程。边界条件被用来构成剩下的两个方程。\n3. 边界条件 $u_3(1)=0$：\n$$u_3(1) = \\sum_{k=0}^{3} a_k T_k(1) = \\sum_{k=0}^{3} a_k (1) = a_0 + a_1 + a_2 + a_3 = 0$$\n4. 边界条件 $u_3(-1)=0$：\n$$u_3(-1) = \\sum_{k=0}^{3} a_k T_k(-1) = \\sum_{k=0}^{3} a_k (-1)^k = a_0 - a_1 + a_2 - a_3 = 0$$\n\n这给出了一个关于系数 $(a_0, a_1, a_2, a_3)$ 的四元齐次线性方程组：\n$$\\begin{cases}\n    a_0 + a_1 + a_2 + a_3 = 0 \\\\\n    a_0 - a_1 + a_2 - a_3 = 0 \\\\\n    -\\lambda a_2 = 0 \\\\\n    -\\lambda a_3 = 0\n\\end{cases}$$\n该方法的缺陷现在显而易见。微分算子 $-d^2/dx^2$ 对高阶模态 ($T_2, T_3$) 的作用完全被残差中低阶模态 ($T_0, T_1$) 的系数所捕获。通过用边界条件替换 $T_0$ 和 $T_1$ 的模态方程，算子的“刚度矩阵”贡献被丢弃了。\n\n我们寻求系数向量 $\\mathbf{a} = (a_0, a_1, a_2, a_3)^T$ 的非平凡解。这种解存在的充分必要条件是系统矩阵的行列式为零。该系统可以写成 $M(\\lambda) \\mathbf{a} = \\mathbf{0}$，其中：\n$$M(\\lambda) = \\begin{pmatrix}\n1 & 1 & 1 & 1 \\\\\n1 & -1 & 1 & -1 \\\\\n0 & 0 & -\\lambda & 0 \\\\\n0 & 0 & 0 & -\\lambda\n\\end{pmatrix}$$\n我们沿第四行进行余子式展开来计算这个矩阵的行列式：\n$$\\det(M(\\lambda)) = (-\\lambda) \\det \\begin{pmatrix} 1 & 1 & 1 \\\\ 1 & -1 & 1 \\\\ 0 & 0 & -\\lambda \\end{pmatrix}$$\n现在，沿第三行展开这个 $3 \\times 3$ 行列式：\n$$\\det(M(\\lambda)) = (-\\lambda) \\left( (-\\lambda) \\det \\begin{pmatrix} 1 & 1 \\\\ 1 & -1 \\end{pmatrix} \\right)$$\n$$\\det(M(\\lambda)) = \\lambda^2 \\left( (1)(-1) - (1)(1) \\right) = \\lambda^2(-2) = -2\\lambda^2$$\n为了存在非平凡解，必须有 $\\det(M(\\lambda))=0$。\n$$-2\\lambda^2 = 0 \\implies \\lambda = 0$$\n因此，这个不正确构建的系统允许非平凡解的唯一特征值是 $\\lambda=0$。对于任何 $\\lambda \\neq 0$，该系统强制 $a_2=0$ 和 $a_3=0$，这继而强制 $a_0=0$ 和 $a_1=0$，从而导致平凡解 $u_3(x)=0$。这个Sturm-Liouville问题的真实特征值都是严格为正的。因此，由这个有缺陷的数值方案产生的 $\\lambda=0$ 是一个伪特征值。",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "谱方法中的配置（Collocation）法和伽辽金（Galerkin）法在概念上有着根本区别：前者在物理空间的配置点上精确满足偏微分方程，而后者则在谱空间的模态上满足。练习  通过一个计算任务揭示了这一差异的核心，即插值（interpolation）与投影（projection）的区别。通过比较通过这两种方式得到的谱系数，你将亲身体会到“混淆误差”（aliasing error）的来源，这是理解和选择不同谱方法时至关重要的概念。",
            "id": "3398051",
            "problem": "令 $[-1,1]$ 为计算域，并令 $\\{x_j\\}_{j=0}^N$ 为 Chebyshev–Gauss–Lobatto 节点，其定义为 $x_j = \\cos\\left(\\frac{\\pi j}{N}\\right)$（对于整数 $N \\ge 0$）。考虑一个光滑标量函数 $f:[-1,1]\\to\\mathbb{R}$。次数至多为 $N$ 的重心形式的 Lagrange 插值多项式由样本点 $f_j = f(x_j)$ 构建如下\n$$\np_N(x) = \\frac{\\displaystyle\\sum_{j=0}^N \\frac{w_j f_j}{x - x_j}}{\\displaystyle\\sum_{j=0}^N \\frac{w_j}{x - x_j}},\n$$\n其中重心权重 $\\{w_j\\}_{j=0}^N$ 由基本 Lagrange 多项式导出，即 $w_j = \\left(\\prod_{m\\ne j}(x_j - x_m)\\right)^{-1}$，并针对 Chebyshev–Gauss–Lobatto 节点的选择进行了特化。第一类 Chebyshev 多项式 $\\{T_k\\}_{k=0}^\\infty$ 定义为 $T_k(\\cos\\theta) = \\cos(k\\theta)$（对于所有实数 $\\theta$，角度以弧度为单位）。对于任意次数至多为 $N$ 的多项式 $q_N(x)$，我们可将其展开为 Chebyshev 基：\n$$\nq_N(x) = \\sum_{k=0}^N a_k T_k(x),\n$$\n其系数 $\\{a_k\\}_{k=0}^N$ 是唯一的。\n\n定义与 Chebyshev 多项式相关的带权内积为\n$$\n\\langle u, v \\rangle = \\int_{-1}^1 \\frac{u(x)\\, v(x)}{\\sqrt{1-x^2}}\\, dx,\n$$\n这导出了正交性\n$$\n\\int_{-1}^1 \\frac{T_m(x)\\, T_n(x)}{\\sqrt{1-x^2}}\\, dx = \n\\begin{cases}\n\\pi, & n=m=0,\\\\\n\\frac{\\pi}{2}, & n=m\\ge 1,\\\\\n0, & n\\ne m.\n\\end{cases}\n$$\n$f$ 在 $\\text{span}\\{T_0,\\dots,T_N\\}$ 上的正交投影具有系数 $\\{a_k^{(\\mathrm{proj})}\\}_{k=0}^N$，满足\n$$\na_0^{(\\mathrm{proj})} = \\frac{1}{\\pi}\\int_{-1}^1 \\frac{f(x)}{\\sqrt{1-x^2}}\\, dx,\\qquad\na_k^{(\\mathrm{proj})} = \\frac{2}{\\pi}\\int_{-1}^1 \\frac{f(x)\\, T_k(x)}{\\sqrt{1-x^2}}\\, dx,\\quad k\\ge 1.\n$$\n\n任务：对以下每个测试用例，执行以下操作。\n- 使用 Chebyshev–Gauss–Lobatto 样本点 $\\{f_j\\}_{j=0}^N$，构建重心插值多项式 $p_N(x)$。然后通过求解在 Chebyshev–Gauss–Lobatto 节点上对 Chebyshev 基求值得到的方阵线性系统，计算 $p_N(x)$ 的 Chebyshev 系数 $\\{a_k^{(\\mathrm{interp})}\\}_{k=0}^N$，并使用恒等式 $T_k(x_j)=\\cos\\!\\left(\\frac{\\pi k j}{N}\\right)$。\n- 通过高精度数值积分计算正交投影系数 $\\{a_k^{(\\mathrm{proj})}\\}_{k=0}^N$，使用针对权重 $1/\\sqrt{1-x^2}$ 的 $M$ 点 Gauss–Chebyshev 法则，其节点为 $x_j^{(\\mathrm{GC})}=\\cos\\!\\left(\\frac{(2j-1)\\pi}{2M}\\right)$（对于 $j=1,\\dots,M$），等权重为 $\\omega_j=\\frac{\\pi}{M}$，得到\n$$\na_0^{(\\mathrm{proj})} \\approx \\frac{1}{M}\\sum_{j=1}^M f\\!\\left(x_j^{(\\mathrm{GC})}\\right),\\qquad\na_k^{(\\mathrm{proj})} \\approx \\frac{2}{M}\\sum_{j=1}^M f\\!\\left(x_j^{(\\mathrm{GC})}\\right)\\, \\cos\\!\\left(k\\, \\frac{(2j-1)\\pi}{2M}\\right),\\quad k\\ge 1.\n$$\n- 报告最大绝对系数差异\n$$\nE_\\infty = \\max_{0\\le k\\le N}\\left|a_k^{(\\mathrm{interp})} - a_k^{(\\mathrm{proj})}\\right|.\n$$\n\n你的程序应为以下测试套件实现上述操作（角度以弧度为单位）：\n- 测试 1：$f(x) = \\sin(\\pi x)$，其中 $N=32$。\n- 测试 2：$f(x) = T_{10}(x) = \\cos\\!\\left(10\\, \\arccos x\\right)$，其中 $N=10$。\n- 测试 3：$f(x) = x$，其中 $N=1$。\n- 测试 4：$f(x) = e^{3x}$，其中 $N=48$。\n\n覆盖性设计：\n- 测试 1 是一个光滑、非多项式的“理想路径”用例。\n- 测试 2 是一个精确多项式边缘用例，其中当 $N\\ge 10$ 时，插值和投影必须匹配。\n- 测试 3 是一个最小次数的边界用例。\n- 测试 4 是一个高度光滑的解析用例，其高阶系数快速衰减但不为零。\n\n答案规格：\n- 对于每个测试用例，将 $E_\\infty$ 计算为一个实数（浮点数）。\n- 你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如“[r_1,r_2,r_3,r_4]”），每个 $r_i$ 对应于测试 $i$ 的 $E_\\infty$。",
            "solution": "解决方案的核心是计算两组Chebyshev系数 $\\{a_k^{(\\mathrm{interp})}\\}_{k=0}^N$ 和 $\\{a_k^{(\\mathrm{proj})}\\}_{k=0}^N$，然后找出它们之间的最大绝对差。\n\n### 步骤 1：插值系数 $\\{a_k^{(\\mathrm{interp})}\\}_{k=0}^N$ 的计算\n\n系数 $\\{a_k^{(\\mathrm{interp})}\\}_{k=0}^N$ 是多项式 $p_N(x) = \\sum_{k=0}^N a_k^{(\\mathrm{interp})} T_k(x)$ 的系数，该多项式在 $N+1$ 个 Chebyshev–Gauss–Lobatto (CGL) 节点 $\\{x_j\\}_{j=0}^N$ 上对函数 $f(x)$ 进行插值。插值条件为 $p_N(x_j) = f(x_j)$（对于 $j=0, \\dots, N$）。代入 $p_N(x)$ 的 Chebyshev 展开式并使用恒等式 $T_k(x_j) = \\cos\\left(\\frac{\\pi kj}{N}\\right)$，我们得到线性系统：\n$$\nf(x_j) = \\sum_{k=0}^N a_k^{(\\mathrm{interp})} \\cos\\left(\\frac{\\pi kj}{N}\\right), \\quad j=0, \\dots, N.\n$$\n这是一个离散余弦变换（DCT-I）问题。我们可以使用其逆变换公式直接给出系数：\n$$\na_k^{(\\mathrm{interp})} = \\frac{2}{N \\bar{c}_k} \\sum_{j=0}^{N} \\frac{f(x_j)}{\\bar{c}_j} \\cos\\left(\\frac{\\pi jk}{N}\\right), \\quad k=0, \\dots, N.\n$$\n此处，$\\bar{c}_k$ 是定义的权重，即 $\\bar{c}_0 = \\bar{c}_N = 2$，对于 $1 \\le k \\le N-1$ 则 $\\bar{c}_k = 1$。相同的定义适用于 $\\bar{c}_j$。此公式被用来计算 $\\{a_k^{(\\mathrm{interp})}\\}$。\n\n### 步骤 2：投影系数 $\\{a_k^{(\\mathrm{proj})}\\}_{k=0}^N$ 的计算\n\n系数 $\\{a_k^{(\\mathrm{proj})}\\}_{k=0}^N$ 对应于函数 $f(x)$ 在 Chebyshev 多项式基 $\\{T_k(x)\\}_{k=0}^N$ 上的正交投影。它们是 $f(x)$ 的“真实”Chebyshev 系数，由以下积分定义：\n$$\na_0^{(\\mathrm{proj})} = \\frac{1}{\\pi}\\int_{-1}^1 \\frac{f(x)}{\\sqrt{1-x^2}}\\, dx, \\qquad\na_k^{(\\mathrm{proj})} = \\frac{2}{\\pi}\\int_{-1}^1 \\frac{f(x)\\, T_k(x)}{\\sqrt{1-x^2}}\\, dx,\\quad k\\ge 1.\n$$\n按照规定，这些积分使用高精度的 $M$ 点第一类 Gauss-Chebyshev 求积法则进行近似。此近似的公式如下：\n$$\na_0^{(\\mathrm{proj})} \\approx \\frac{1}{M}\\sum_{j=1}^M f\\!\\left(x_j^{(\\mathrm{GC})}\\right),\\qquad\na_k^{(\\mathrm{proj})} \\approx \\frac{2}{M}\\sum_{j=1}^M f\\!\\left(x_j^{(\\mathrm{GC})}\\right)\\, T_k\\!\\left(x_j^{(\\mathrm{GC})}\\right),\\quad k\\ge 1,\n$$\n其中 $x_j^{(\\mathrm{GC})}=\\cos\\left(\\frac{(2j-1)\\pi}{2M}\\right)$ 是 Gauss-Chebyshev 节点。为确保“高精度”，所选的求积点数 $M$ 远大于 $N$，这使得求积误差与所测量的差异相比可以忽略不计。\n\n### 步骤 3：最大绝对差异 $E_\\infty$ 的计算\n\n差异 $E_\\infty$ 是对混叠误差的度量，该误差的产生是因为插值多项式的系数包含了原始函数高阶模态的贡献。它被计算为两个系数向量之差的最大范数：\n$$\nE_\\infty = \\max_{0\\le k\\le N}\\left|a_k^{(\\mathrm{interp})} - a_k^{(\\mathrm{proj})}\\right|.\n$$\n\n### 测试用例分析\n\n- **测试 1 和 4：** 对于这些光滑、解析、非多项式的函数，真实的 Chebyshev 系数 $a_k^{(\\mathrm{proj})}$ 随着 $k \\to \\infty$ 快速衰减。差异 $a_k^{(\\mathrm{interp})} - a_k^{(\\mathrm{proj})}$ 是由混叠引起的，其中高频系数（例如 $a_{2N \\pm k}^{(\\mathrm{proj})}$）被折叠到低频系数上。预计会有一个小的但非零的误差 $E_\\infty$。\n- **测试 2 和 3：** 在这些用例中，函数 $f(x)$ 是一个次数为 $D$ 的多项式，我们使用的插值次数为 $N \\ge D$。次数为 $D$ 的多项式的 Lagrange 插值多项式就是该多项式本身。因此，$p_N(x) = f(x)$，它们的 Chebyshev 系数必须相同：$a_k^{(\\mathrm{interp})} = a_k^{(\\mathrm{proj})}$。因此，对于这些情况，$E_\\infty$ 预计为零，或者是一个在机器浮点精度量级上的非常小的数。\n\n实现过程遵循为每个提供的测试用例设定的这些步骤。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import ...\n\ndef solve():\n    # Define test case functions\n    def f_test1(x):\n        \"\"\"Test 1: f(x) = sin(pi*x)\"\"\"\n        return np.sin(np.pi * x)\n\n    def f_test2(x):\n        \"\"\"Test 2: f(x) = T_10(x)\"\"\"\n        # Clip input to arccos's domain to handle potential floating point errors at endpoints\n        x_safe = np.clip(x, -1.0, 1.0)\n        return np.cos(10 * np.arccos(x_safe))\n\n    def f_test3(x):\n        \"\"\"Test 3: f(x) = x, which is T_1(x)\"\"\"\n        return x\n\n    def f_test4(x):\n        \"\"\"Test 4: f(x) = exp(3x)\"\"\"\n        return np.exp(3 * x)\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (f_test1, 32),\n        (f_test2, 10),\n        (f_test3, 1),\n        (f_test4, 48),\n    ]\n\n    # Number of quadrature points for projection. Chosen to be large for high accuracy.\n    M_QUADRATURE = 2048\n\n    def compute_interp_coeffs(f, N):\n        \"\"\"\n        Computes the Chebyshev coefficients a_k^{(interp)} of the polynomial\n        interpolant of f at the N+1 Chebyshev-Gauss-Lobatto nodes.\n        This is done by solving the linear system p_N(x_j) = f(x_j) using\n        the inverse Discrete Cosine Transform of Type I (DCT-I).\n        \"\"\"\n        if N == 0:\n            return np.array([f(1.0)])\n        \n        j = np.arange(N + 1)\n        x_cgl = np.cos(np.pi * j / N)\n        f_vals = f(x_cgl)\n        \n        c_bar_j = np.ones(N + 1)\n        c_bar_j[0] = c_bar_j[N] = 2.0\n        f_vals_weighted = f_vals / c_bar_j\n        \n        a_interp = np.zeros(N + 1)\n        for k in range(N + 1):\n            cos_transform = np.cos(np.pi * j * k / N)\n            summation = np.sum(f_vals_weighted * cos_transform)\n            \n            c_bar_k = 2.0 if k == 0 or k == N else 1.0\n            a_interp[k] = (2.0 / N) * summation / c_bar_k\n            \n        return a_interp\n\n    def compute_proj_coeffs(f, N, M):\n        \"\"\"\n        Computes the Chebyshev coefficients a_k^{(proj)} of the orthogonal\n        projection of f. The integrals are approximated using an M-point\n        Gauss-Chebyshev quadrature rule.\n        \"\"\"\n        j_gc = np.arange(1, M + 1)\n        theta_gc = (2 * j_gc - 1) * np.pi / (2 * M)\n        x_gc = np.cos(theta_gc)\n        f_vals_gc = f(x_gc)\n        \n        a_proj = np.zeros(N + 1)\n        \n        # k = 0 case\n        a_proj[0] = np.mean(f_vals_gc)\n        \n        # k >= 1 cases\n        for k in range(1, N + 1):\n            cos_transform = np.cos(k * theta_gc)\n            a_proj[k] = (2.0 / M) * np.sum(f_vals_gc * cos_transform)\n            \n        return a_proj\n\n    results = []\n    for f, N in test_cases:\n        # Main logic to calculate the result for one case goes here.\n        a_interp = compute_interp_coeffs(f, N)\n        a_proj = compute_proj_coeffs(f, N, M_QUADRATURE)\n        \n        e_inf = np.max(np.abs(a_interp - a_proj))\n        results.append(e_inf)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}