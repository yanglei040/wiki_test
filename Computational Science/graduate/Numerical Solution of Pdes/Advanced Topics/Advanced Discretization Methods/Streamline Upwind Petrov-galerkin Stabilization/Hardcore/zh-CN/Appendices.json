{
    "hands_on_practices": [
        {
            "introduction": "理解任何数值方法的第一步，都是从最简单的设置中剖析其核心机制。本练习将引导你在一维对流扩散问题中，从头推导流线迎风Petrov-Galerkin (SUPG) 方法的代数形式 。通过直接计算单元刚度矩阵，你将清晰地看到SUPG稳定项如何修正标准Galerkin格式的离散方程，并直观地理解其作为“人工黏性”或“流线扩散”的物理意义。",
            "id": "3448963",
            "problem": "考虑在开区间 $(0,L)$ 上的具有常系数的一维稳态对流扩散边值问题，其偏微分方程为\n$$\n-\\mu\\,\\frac{d^{2}u}{dx^{2}} + a\\,\\frac{du}{dx} = f(x),\n$$\n其中 $a>0$ 是恒定对流速度，$\\mu \\ge 0$ 是（可能很小的）扩散系数，$f$ 是一个足够光滑的源项。使用间距为 $h>0$ 的均匀网格对区域进行离散化，并采用标准的协调有限元法，使用连续的分片线性拉格朗日基函数（线性 $P_1$ 单元）来逼近 $u$。采用流线迎风彼得罗夫-伽辽金 (SUPG) 稳定化方法，该方法在每个单元上将标准检验函数 $w$ 替换为彼得罗夫-伽辽金检验函数 $w + \\tau\\,a\\,\\frac{dw}{dx}$，其中 $\\tau \\ge 0$ 是一个常数稳定化参数。假设 $a$、$\\mu$ 和 $\\tau$ 为常数，并对弱形式中的对流项使用未经分部积分的形式。\n\n从弱形式和 SUPG 检验函数的定义出发，推导单元级双线性形式，并组装其贡献项，以获得与内部节点 $i$ 相关联的代数刚度矩阵行。直接在物理单元 $[x_{i-1},x_i]$ 和 $[x_i,x_{i+1}]$ 上进行计算，使用局部节点形函数 $N_1$（左）和 $N_2$（右）及其导数。对线性 $P_1$ 基函数，精确计算所有单元积分。然后，组装来自两个相邻单元的贡献，以获得内部行 $i$ 的三点格式，即乘以节点 $i-1$、$i$ 和 $i+1$ 处未知数的系数。\n\n以单个 $1\\times 3$ 行矩阵的形式，报告 SUPG 刚度矩阵行中内部节点三点格式的最终系数，这些系数用 $a$、$\\mu$、$h$ 和 $\\tau$ 表示，并按 $\\{i-1,i,i+1\\}$ 的顺序排列。此外，指出与标准伽辽金离散化产生的中心差分格式相比，对流格式的修正项是什么。最终答案必须是一个无单位的解析表达式。",
            "solution": "用户希望推导应用于一维对流扩散问题的流线迎风彼得罗夫-伽辽金 (SUPG) 方法的三点格式。\n\n### 第 1 步：提取已知条件\n-   **控制方程：** 一维稳态对流扩散方程由下式给出\n    $$-\\mu\\,\\frac{d^{2}u}{dx^{2}} + a\\,\\frac{du}{dx} = f(x) \\quad \\text{for } x \\in (0,L)$$\n-   **系数：** $a > 0$ 是恒定对流速度，$\\mu \\ge 0$ 是恒定扩散系数。\n-   **离散化：** 使用间距为 $h > 0$ 的均匀网格对区域进行离散化。\n-   **有限元逼近：** 使用连续的分片线性拉格朗日基函数（$P_1$ 单元）作为试探函数空间 $V_h$。\n-   **稳定化方法：** 采用流线迎风彼得罗夫-伽辽金 (SUPG) 方法。\n-   **检验函数：** 标准伽辽金检验函数 $w$ 被替换为彼得罗夫-伽辽金检验函数 $w_{supg} = w + \\tau\\,a\\,\\frac{dw}{dx}$，其中 $\\tau \\ge 0$ 是一个常数稳定化参数。\n-   **弱形式：** 问题指定对流项的弱形式使用未经分部积分的形式。\n-   **目标：**\n    1.  推导内部节点 $i$ 的三点格式，表示节点 $i-1$、$i$ 和 $i+1$ 处未知数的系数。\n    2.  指出与标准伽辽金方法产生的中心差分格式相比，对流格式的修正项。\n\n### 第 2 步：使用提取的已知条件进行验证\n-   **科学依据：** 该问题是偏微分方程数值分析中的一个标准练习。对流扩散方程、有限元法和 SUPG 稳定化是计算科学与工程中的基本且成熟的概念。\n-   **适定性：** 问题提供了唯一推导代数格式所需的所有信息。公式清晰，能够导出一个确定性的答案。\n-   **客观性：** 问题使用精确的数学语言陈述，没有歧义或主观论断。\n\n### 第 3 步：结论与行动\n问题陈述被确认为有效。它是自包含的、科学合理的且适定的。可以继续进行求解过程。\n\n### SUPG 弱形式的推导\n\n标准伽辽金弱形式是通过将控制方程乘以一个检验函数 $w \\in V_h$，在区域 $\\Omega = (0,L)$ 上积分，并将二阶扩散项分部积分得到的。这得到：\n求 $u_h \\in V_h$，使得对于所有 $w_h \\in V_h$，\n$$\n\\int_0^L \\mu \\frac{du_h}{dx} \\frac{dw_h}{dx} dx + \\int_0^L a \\frac{du_h}{dx} w_h dx = \\int_0^L f w_h dx\n$$\n这里，我们按照要求使用了“未经分部积分的弱形式对流项”。\n\nSUPG 方法在伽辽金公式中增加了一个稳定项。该项是通过对强形式微分方程的单元残差 $R(u_h) = -\\mu u_h'' + a u_h' - f$ 乘以检验函数的“扰动”$\\delta_{w_h} = \\tau a w_h'$ 后进行积分得到的。积分在所有单元内部的并集上进行。\n$$\n\\sum_{K} \\int_K R(u_h) (\\tau a w_h') dx = \\sum_{K} \\int_K (-\\mu u_h'' + a u_h' - f) (\\tau a w_h') dx\n$$\n由于 $u_h$ 由分片线性函数构成，其二阶导数 $u_h''$ 在每个单元 $K$ 内部为零。稳定项简化为：\n$$\n\\sum_{K} \\int_K (a u_h' - f) (\\tau a w_h') dx = \\sum_{K} \\int_K \\tau a^2 u_h' w_h' dx - \\sum_{K} \\int_K \\tau a f w_h' dx\n$$\n将此项加到伽辽金形式中，并将所有含 $f$ 的项移到右侧，我们得到完整的 SUPG 弱形式：\n求 $u_h \\in V_h$，使得对于所有 $w_h \\in V_h$，\n$$\n\\int_0^L \\mu u_h' w_h' dx + \\int_0^L a u_h' w_h dx + \\sum_{K} \\int_K \\tau a^2 u_h' w_h' dx = \\int_0^L f w_h dx + \\sum_{K} \\int_K \\tau a f w_h' dx\n$$\n左侧定义了双线性形式 $B_{SUPG}(u_h, w_h)$，刚度矩阵由此导出：\n$$\nB_{SUPG}(u_h, w_h) = \\int_0^L (\\mu + \\tau a^2) \\frac{du_h}{dx} \\frac{dw_h}{dx} dx + \\int_0^L a \\frac{du_h}{dx} w_h dx\n$$\n注意，在 $\\Omega$ 上的积分可以分解为在各个单元 $K$ 上的积分之和。由于 $\\tau$ 和 $a$ 是常数，$\\sum_K \\int_K$ 项等价于 $\\int_0^L$。\n\n### 单元级计算\n\n我们考虑一个长度为 $h$ 的通用单元 $K_e = [x_j, x_{j+1}]$。试探函数 $u_h$ 和检验函数 $w_h$ 用局部线性形函数 $N_1$ 和 $N_2$ 表示。在坐标为 $\\xi$ 的参考单元 $\\hat{K}=[0,1]$ 上，形函数为 $\\hat{N}_1(\\xi) = 1-\\xi$ 和 $\\hat{N}_2(\\xi) = \\xi$。在物理单元上的导数是常数：$\\frac{dN_1}{dx} = -\\frac{1}{h}$ 和 $\\frac{dN_2}{dx} = \\frac{1}{h}$。\n\n单元刚度矩阵 $k^e$ 的分量为 $k^e_{mn} = B_{SUPG}(N_n, N_m)$，在单元 $K_e$ 上计算，其中 $m$ 是行索引（检验函数），$n$ 是列索引（试探函数）。\n\n双线性形式由两部分组成：对称的类扩散部分和非对称的对流部分。\n1.  **扩散和稳定化部分：**\n    $k^e_{D,mn} = \\int_{K_e} (\\mu + \\tau a^2) \\frac{dN_n}{dx} \\frac{dN_m}{dx} dx$。\n    由于导数是常数，该矩阵为：\n    $$\n    k^e_D = \\frac{\\mu + \\tau a^2}{h} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix}\n    $$\n2.  **对流部分：**\n    $k^e_{A,mn} = \\int_{K_e} a \\frac{dN_n}{dx} N_m dx$。\n    分量计算如下：\n    $k^e_{A,11} = \\int_{K_e} a(-\\frac{1}{h})N_1 dx = -\\frac{a}{h}\\int_{K_e}N_1 dx = -\\frac{a}{h}(\\frac{h}{2}) = -\\frac{a}{2}$。\n    $k^e_{A,12} = \\int_{K_e} a(+\\frac{1}{h})N_1 dx = +\\frac{a}{h}\\int_{K_e}N_1 dx = +\\frac{a}{h}(\\frac{h}{2}) = +\\frac{a}{2}$。\n    $k^e_{A,21} = \\int_{K_e} a(-\\frac{1}{h})N_2 dx = -\\frac{a}{h}\\int_{K_e}N_2 dx = -\\frac{a}{h}(\\frac{h}{2}) = -\\frac{a}{2}$。\n    $k^e_{A,22} = \\int_{K_e} a(+\\frac{1}{h})N_2 dx = +\\frac{a}{h}\\int_{K_e}N_2 dx = +\\frac{a}{h}(\\frac{h}{2}) = +\\frac{a}{2}$。\n    单元对流矩阵为：\n    $$\n    k^e_A = \\frac{a}{2} \\begin{pmatrix} -1  1 \\\\ -1  1 \\end{pmatrix}\n    $$\n总的单元刚度矩阵为 $k^e = k^e_D + k^e_A$：\n$$\nk^e = \\begin{pmatrix} \\frac{\\mu+\\tau a^2}{h} - \\frac{a}{2}  -\\frac{\\mu+\\tau a^2}{h} + \\frac{a}{2} \\\\ -\\frac{\\mu+\\tau a^2}{h} - \\frac{a}{2}  \\frac{\\mu+\\tau a^2}{h} + \\frac{a}{2} \\end{pmatrix}\n$$\n\n### 内部节点格式的组装\n\n我们组装与内部节点 $i$ 对应的全局刚度矩阵行的系数。该行由两个相邻单元 $K_{left} = [x_{i-1}, x_i]$ 和 $K_{right} = [x_i, x_{i+1}]$ 的贡献构成。检验函数是全局基函数 $N_i$。\n\n-   **$u_{i-1}$ 的系数 ($K_{i,i-1}$):** 此相互作用发生在 $K_{left}$ 上。试探函数为 $N_{i-1}$（局部 $N_1$），检验函数为 $N_i$（局部 $N_2$）。贡献项为 $k^e_{21}$。\n    $$K_{i,i-1} = k^e_{21} = -\\frac{\\mu+\\tau a^2}{h} - \\frac{a}{2}$$\n-   **$u_{i+1}$ 的系数 ($K_{i,i+1}$):** 此相互作用发生在 $K_{right}$ 上。试探函数为 $N_{i+1}$（局部 $N_2$），检验函数为 $N_i$（局部 $N_1$）。贡献项为 $k^e_{12}$。\n    $$K_{i,i+1} = k^e_{12} = -\\frac{\\mu+\\tau a^2}{h} + \\frac{a}{2}$$\n-   **$u_i$ 的系数 ($K_{i,i}$):** 该系数接收两个贡献项。\n    -   来自 $K_{left}$：试探函数为 $N_i$（局部 $N_2$），检验函数为 $N_i$（局部 $N_2$）。贡献项为 $k^e_{22}$。\n    -   来自 $K_{right}$：试探函数为 $N_i$（局部 $N_1$），检验函数为 $N_i$（局部 $N_1$）。贡献项为 $k^e_{11}$。\n    $$K_{i,i} = k^e_{22} + k^e_{11} = \\left(\\frac{\\mu+\\tau a^2}{h} + \\frac{a}{2}\\right) + \\left(\\frac{\\mu+\\tau a^2}{h} - \\frac{a}{2}\\right) = \\frac{2(\\mu+\\tau a^2)}{h}$$\n\n对于内部行 $i$ 的三点格式，按 $\\{u_{i-1}, u_i, u_{i+1}\\}$ 系数的顺序排列为：\n$$\n\\left\\{ -\\frac{\\mu+\\tau a^2}{h} - \\frac{a}{2}, \\quad \\frac{2(\\mu+\\tau a^2)}{h}, \\quad -\\frac{\\mu+\\tau a^2}{h} + \\frac{a}{2} \\right\\}\n$$\n\n### 格式修正项的确定\n\n问题要求指出与标准伽辽金方法产生的中心差分对流格式相比的修正项。根据推导，对于对流项 $a u'$，标准伽辽金方法 ($\\tau=0$) 产生的格式为 $\\frac{a}{2}\\{-1, 0, 1\\}$。这对应于方程项 $-\\frac{a}{2}u_{i-1} + \\frac{a}{2}u_{i+1} = a \\frac{u_{i+1}-u_{i-1}}{2}$。该形式除以 $h$ 后，恰好是 $a u'$ 的二阶中心差分近似，并乘以了 $h$。\n\n问题的措辞“与标准伽辽金离散化产生的中心差分格式相比……的修正”有些绕。一个更直接的解释是，确定 SUPG 方法在伽辽金格式上增加的项。\n-   **伽辽金格式 ($\\tau=0$):** 这结合了扩散和对流的标准中心差分格式。\n    -   扩散：$\\frac{\\mu}{h}\\{-1, 2, -1\\}$ (对称)\n    -   对流：$\\frac{a}{2}\\{-1, 0, 1\\}$ (反对称，中心差分)\n-   **SUPG 修正项 ($\\tau0$):** SUPG 从双线性形式 $\\int \\tau a^2 u'w' dx$ 引入了一个附加项。该项的格式为：\n    $$\n    \\frac{\\tau a^2}{h}\\{-1, 2, -1\\}\n    $$\n这个修正项是一个对称的二阶格式，其形式与物理扩散格式相同。通常被称为人工扩散或流线扩散项。其目的是向格式中添加数值耗散，以稳定在对流主导的流动中中心差分（伽辽金）格式特有的伪振荡。通过为 $\\tau$ 选择一个合适的值（例如，对于纯对流问题，$\\tau = \\frac{h}{2a}$），该项有效地将格式从中心差分类别转换为一阶迎风类别，从而确保稳定性。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix} -\\frac{\\mu}{h} - \\frac{\\tau a^2}{h} - \\frac{a}{2}  \\frac{2\\mu}{h} + \\frac{2\\tau a^2}{h}  -\\frac{\\mu}{h} - \\frac{\\tau a^2}{h} + \\frac{a}{2} \\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "将SUPG方法从一维推广到多维时，一个核心问题是如何定义与流动方向相关的“单元尺寸”，以便正确地设定稳定化参数 $\\tau$。本练习将一维思想推广至二维三角形单元，引入并计算沿流线方向的“方向性单元长度” $h_{\\boldsymbol{t}}$ 。这个练习是连接抽象稳定化理论与具体有限元几何实现的关键一步，让你掌握在复杂几何和非结构网格上定义SUPG参数的核心技能。",
            "id": "2602150",
            "problem": "考虑二维空间中的稳态、无量纲的对流-扩散-反应边值问题，\n$$-\\,\\epsilon\\,\\Delta u + \\boldsymbol{\\beta}\\cdot\\nabla u + \\sigma\\,u = f \\quad \\text{在多边形域中},$$\n其中系数为常数。关注一个仿射线性三角形有限元，其顶点位于\n$$\\boldsymbol{x}_1=(0,0),\\quad \\boldsymbol{x}_2=(0.04,0),\\quad \\boldsymbol{x}_3=(0,0.03),$$\n及其相关的线性 Lagrange 节点形函数 $N_i$，这些形函数满足单位分解性和线性完备性。设对流速度为 $\\boldsymbol{\\beta}=(10,0.5)$，扩散系数为 $\\epsilon=10^{-4}$，反应系数为 $\\sigma=0$。\n\n(a) 仅从以下两点出发：(i) 线性两节点单元的一维恒等式，即形函数导数的绝对值之和等于 $2/h$（其中 $h$ 是单元长度）；(ii) 三角形的仿射映射和方向导数概念，推导在流线方向 $\\boldsymbol{t}=\\boldsymbol{\\beta}/\\|\\boldsymbol{\\beta}\\|$ 上的方向单元长度 $h_{\\boldsymbol{t}}$ 的公式，该公式用常梯度 $\\nabla N_i$ 和 $\\boldsymbol{t}$ 表示。然后，对给定的三角形和 $\\boldsymbol{\\beta}$ 计算 $h_{\\boldsymbol{t}}$ 的值。\n\n(b) 使用一维常系数分析，该分析得到沿流线方向的最优流线迎风Petrov-Galerkin (SUPG) 稳定化参数，推导稳定化参数 $\\tau$ 的表达式，该表达式用 $h_{\\boldsymbol{t}}$、$\\|\\boldsymbol{\\beta}\\|$、$\\epsilon$ 和单元 Péclet 数表示。然后，根据给定数据计算 $\\tau$ 的值。\n\n提供 $h_{\\boldsymbol{t}}$ 和 $\\tau$ 的最终数值。将两者均四舍五入至六位有效数字。将最终答案表示为有序对 $(h_{\\boldsymbol{t}},\\ \\tau)$，不带单位。",
            "solution": "问题陈述经验证是适定的、有科学依据且自洽的。这是一个关于对流主导问题有限元分析的标准练习，尽管并非微不足道。我们开始求解。\n\n问题分为两部分。我们依次解决每一部分。\n\n(a) 方向单元长度 $h_{\\boldsymbol{t}}$ 的推导与计算。\n\n对于一个线性三角形单元，Lagrange 节点形函数 $N_i(\\boldsymbol{x})$ 是空间坐标 $\\boldsymbol{x}=(x,y)$ 的线性函数。因此，它们的梯度 $\\nabla N_i$ 在整个单元上是常向量。这些梯度由单元的几何形状决定。给定顶点 $\\boldsymbol{x}_1=(0,0)$、$\\boldsymbol{x}_2=(0.04,0)$ 和 $\\boldsymbol{x}_3=(0,0.03)$，三角形的面积为 $A = \\frac{1}{2}(0.04)(0.03) = 0.0006$。梯度计算如下：\n$$\n\\nabla N_i = \\frac{1}{2A} \\begin{pmatrix} y_j - y_k \\\\ x_k - x_j \\end{pmatrix}\n$$\n其中 $(i,j,k)$ 是 $(1,2,3)$ 的一个循环排列。对于给定的顶点：\n$$\n\\nabla N_1 = \\frac{1}{0.0012} \\begin{pmatrix} 0 - 0.03 \\\\ 0 - 0.04 \\end{pmatrix} = \\begin{pmatrix} -25 \\\\ -100/3 \\end{pmatrix}\n$$\n$$\n\\nabla N_2 = \\frac{1}{0.0012} \\begin{pmatrix} 0.03 - 0 \\\\ 0 - 0 \\end{pmatrix} = \\begin{pmatrix} 25 \\\\ 0 \\end{pmatrix}\n$$\n$$\n\\nabla N_3 = \\frac{1}{0.0012} \\begin{pmatrix} 0 - 0 \\\\ 0.04 - 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 100/3 \\end{pmatrix}\n$$\n线性完备性条件 $\\sum_{i=1}^3 \\nabla N_i = \\boldsymbol{0}$ 得到满足。\n\n问题要求从一个长度为 $h$ 的线性两节点单元的一维恒等式 $\\sum_{i=1}^2 |N_i'| = \\frac{2}{h}$ 出发。这个恒等式可以重新整理，定义单元长度为 $h = 2 / (\\sum_{i=1}^2 |N_i'|)$。\n\n我们将此概念推广到多维情况。单一空间坐标上的导数 $N_i'$ 的作用，被 $N_i$ 沿指定流线方向（由单位向量 $\\boldsymbol{t}$ 给出）的方向导数所取代。方向导数为 $\\nabla N_i \\cdot \\boldsymbol{t}$。求和遍及单元的所有节点，本例中为 $i=1, 2, 3$。这就得到了方向单元长度 $h_{\\boldsymbol{t}}$ 的定义：\n$$\nh_{\\boldsymbol{t}} = \\frac{2}{\\sum_{i=1}^3 |\\nabla N_i \\cdot \\boldsymbol{t}|}\n$$\n流线方向与对流速度 $\\boldsymbol{\\beta}=(10, 0.5)$ 一致。单位向量为 $\\boldsymbol{t} = \\boldsymbol{\\beta} / \\|\\boldsymbol{\\beta}\\|$。\n首先，我们计算点积 $\\nabla N_i \\cdot \\boldsymbol{\\beta}$：\n$$\n\\nabla N_1 \\cdot \\boldsymbol{\\beta} = (-25)(10) + (-\\frac{100}{3})(0.5) = -250 - \\frac{50}{3} = -\\frac{800}{3}\n$$\n$$\n\\nabla N_2 \\cdot \\boldsymbol{\\beta} = (25)(10) + (0)(0.5) = 250\n$$\n$$\n\\nabla N_3 \\cdot \\boldsymbol{\\beta} = (0)(10) + (\\frac{100}{3})(0.5) = \\frac{50}{3}\n$$\n它们的绝对值之和为：\n$$\n\\sum_{i=1}^3 |\\nabla N_i \\cdot \\boldsymbol{\\beta}| = |-\\frac{800}{3}| + |250| + |\\frac{50}{3}| = \\frac{800}{3} + \\frac{750}{3} + \\frac{50}{3} = \\frac{1600}{3}\n$$\n对流速度的大小为 $\\|\\boldsymbol{\\beta}\\| = \\sqrt{10^2 + 0.5^2} = \\sqrt{100.25}$。\n现在我们可以写出方向导数绝对值的和：\n$$\n\\sum_{i=1}^3 |\\nabla N_i \\cdot \\boldsymbol{t}| = \\sum_{i=1}^3 \\left|\\nabla N_i \\cdot \\frac{\\boldsymbol{\\beta}}{\\|\\boldsymbol{\\beta}\\|}\\right| = \\frac{1}{\\|\\boldsymbol{\\beta}\\|} \\sum_{i=1}^3 |\\nabla N_i \\cdot \\boldsymbol{\\beta}| = \\frac{1600/3}{\\sqrt{100.25}}\n$$\n将此代入 $h_{\\boldsymbol{t}}$ 的公式中：\n$$\nh_{\\boldsymbol{t}} = \\frac{2}{\\frac{1600/3}{\\sqrt{100.25}}} = \\frac{6 \\sqrt{100.25}}{1600} = \\frac{3 \\sqrt{100.25}}{800}\n$$\n对该表达式进行数值计算，我们得到：\n$$\nh_{\\boldsymbol{t}} \\approx \\frac{3 \\times 10.0124922}{800} \\approx 0.03754684575\n$$\n四舍五入至六位有效数字，$h_{\\boldsymbol{t}} = 0.0375468$。\n\n(b) SUPG 稳定化参数 $\\tau$ 的推导与计算。\n\n对于长度为 $h$ 的线性单元上的一维常系数对流-扩散方程，最优的 SUPG 稳定化参数由下式给出：\n$$\n\\tau_{\\text{1D}} = \\frac{h}{2\\beta} \\left( \\coth(Pe_{\\text{1D}}) - \\frac{1}{Pe_{\\text{1D}}} \\right)\n$$\n其中一维 Péclet 数为 $Pe_{\\text{1D}} = \\frac{\\beta h}{2\\epsilon}$。\n\n为了推导多维情况下的表达式，我们通过将一维量统一替换为它们的多维对应量来推广此公式。单元长度 $h$ 被沿流线的方向单元长度 $h_{\\boldsymbol{t}}$ 所取代。标量速度 $\\beta$ 被其大小 $\\|\\boldsymbol{\\beta}\\|$ 所取代。这得到了稳定化参数 $\\tau$ 的表达式为：\n$$\n\\tau = \\frac{h_{\\boldsymbol{t}}}{2\\|\\boldsymbol{\\beta}\\|} \\left( \\coth(Pe) - \\frac{1}{Pe} \\right)\n$$\n其中单元 Péclet 数现在定义为：\n$$\nPe = \\frac{\\|\\boldsymbol{\\beta}\\| h_{\\boldsymbol{t}}}{2\\epsilon}\n$$\n这就构成了所要求的推导。现在我们根据给定数据对此进行计算。首先，我们计算单元 Péclet 数 $Pe$：\n$$\nPe = \\frac{\\|\\boldsymbol{\\beta}\\| h_{\\boldsymbol{t}}}{2\\epsilon} = \\frac{\\sqrt{100.25}}{2 \\times 10^{-4}} \\left( \\frac{3 \\sqrt{100.25}}{800} \\right) = \\frac{3 (100.25)}{1600 \\times 10^{-4}} = \\frac{300.75}{0.16} = 1879.6875\n$$\nPéclet 数的值非常大，表明这是一个强对流主导的区域。对于大的自变量 $x$，双曲余切函数 $\\coth(x)$ 迅速趋近于 $1$。对于 $Pe = 1879.6875$，$\\coth(Pe)$ 的值在计算上与 $1$ 无法区分。因此，我们可以使用高 Péclet 数的渐近形式。\n将 $h_{\\boldsymbol{t}}$ 和 $Pe$ 的表达式代入 $\\tau$ 的公式中：\n$$\n\\tau = \\frac{1}{2\\|\\boldsymbol{\\beta}\\|} \\left(\\frac{3 \\sqrt{100.25}}{800}\\right) \\left( \\coth(Pe) - \\frac{1}{Pe} \\right) = \\frac{3 \\sqrt{100.25}}{1600\\|\\boldsymbol{\\beta}\\|} \\left( \\coth(Pe) - \\frac{1}{Pe} \\right)\n$$\n注意到 $\\|\\boldsymbol{\\beta}\\| = \\sqrt{100.25}$，上式简化为：\n$$\n\\tau = \\frac{3}{1600} \\left( \\coth(Pe) - \\frac{1}{Pe} \\right)\n$$\n使用 $Pe$ 的值和近似 $\\coth(Pe) \\approx 1$：\n$$\n\\tau \\approx \\frac{3}{1600} \\left( 1 - \\frac{1}{1879.6875} \\right)\n$$\n$$\n\\tau \\approx 0.001875 \\left( 1 - 0.0005320053... \\right) \\approx 0.001875 \\times 0.99946799... \\approx 0.00187400249\n$$\n四舍五入至六位有效数字，$\\tau = 0.00187400$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0.0375468  0.00187400 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在理解了SUPG稳定项的形式及其参数的定义之后，一个自然的实际问题是：在有限元程序中实现这个额外的项有多复杂？本练习旨在解答这个问题，通过分析SUPG积分项中被积函数的性质 。你将发现，对于最常用的线性元，尽管稳定项的表达式看起来很复杂，其被积函数却是一个低阶多项式，这意味着计算它的数值积分非常直接且高效，从而消除了对实现复杂性的担忧。",
            "id": "2602085",
            "problem": "考虑一个在有界 Lipschitz 域 $\\Omega \\subset \\mathbb{R}^{d}$（其中 $d \\in \\{1,2,3\\}$）上的稳态对流-扩散-反应模型问题：\n$$\n- \\nabla \\cdot \\left( \\kappa \\nabla u \\right) + \\boldsymbol{\\beta} \\cdot \\nabla u + \\sigma u = f \\quad \\text{in } \\Omega,\n$$\n并带有适当的边界条件以确保问题的适定性。假设扩散系数 $\\kappa  0$、对流速度 $\\boldsymbol{\\beta} \\in \\mathbb{R}^{d}$、反应系数 $\\sigma \\ge 0$ 以及源项 $f$ 在 $\\Omega$ 上均为常数。\n\n令 $\\mathcal{T}_{h}$ 为 $\\Omega$ 的一个协调单纯剖分，使得对每个单元 $K \\in \\mathcal{T}_{h}$ 的映射都是仿射的。令 $V_{h}$ 为 $\\mathcal{T}_{h}$ 上的标准连续分片线性（$\\mathbb{P}_{1}$）有限元空间。记 $u_{h} \\in V_{h}$ 为离散试探函数，$w_{h} \\in V_{h}$ 为检验函数。考虑流线迎风Petrov-Galerkin (SUPG) 稳定化项\n$$\n\\sum_{K \\in \\mathcal{T}_{h}} \\int_{K} \\tau_{K} \\left( \\boldsymbol{\\beta} \\cdot \\nabla w_{h} \\right) \\, r_{h} \\, \\mathrm{d}x,\n$$\n其中 $\\tau_{K}  0$ 是一个在每个单元 $K$ 上为常数的稳定化参数，而 $r_{h}$ 是离散解在 $K$ 上的强残差，由下式给出：\n$$\nr_{h} := - \\nabla \\cdot \\left( \\kappa \\nabla u_{h} \\right) + \\boldsymbol{\\beta} \\cdot \\nabla u_{h} + \\sigma u_{h} - f.\n$$\n\n假设我们希望对每个单元 $K$ 上的 SUPG 稳定化项进行精确的数值积分，每个单元使用单一的求积法则，该法则对 $K$ 上所有总次数不超过 $m$ 的多项式都是精确的。确定最小的多项式精确度阶数 $m$，使得对于任意的 $u_{h}, w_{h} \\in V_{h}$，每个 $K$ 上的 SUPG 稳定化积分都能被精确计算。请以单个整数形式给出答案。无需四舍五入，也无需单位。",
            "solution": "问题是要确定一个求积法则所需的最小多项式精确度阶数 $m$，以便在网格 $\\mathcal{T}_h$ 的每个单元 $K$ 上精确计算流线迎风/Petrov–Galerkin (SUPG) 稳定化项。该问题是适定的，并且包含了进行严格分析所需的足够信息。\n\nSUPG 稳定化项由对所有单元 $K \\in \\mathcal{T}_{h}$ 上的积分求和给出：\n$$\n\\int_{K} \\tau_{K} \\left( \\boldsymbol{\\beta} \\cdot \\nabla w_{h} \\right) \\, r_{h} \\, \\mathrm{d}x\n$$\n为了确定求积法则所需的精确度，我们必须首先确定在任意单元 $K$ 上被积函数的多项式次数。被积函数是三项的乘积：稳定化参数 $\\tau_{K}$、修正的检验函数项 $\\boldsymbol{\\beta} \\cdot \\nabla w_{h}$ 以及离散残差 $r_{h}$。\n\n令 $\\mathbb{P}_{p}(K)$ 表示单元 $K$ 上总次数至多为 $p$ 的多项式空间。\n\n首先，我们分析项 $\\boldsymbol{\\beta} \\cdot \\nabla w_{h}$。\n检验函数 $w_{h}$ 属于连续分片线性函数空间 $V_{h}$。因此，在任何单元 $K$ 上，其限制 $w_{h}|_{K}$ 是一个线性多项式，即 $w_{h}|_{K} \\in \\mathbb{P}_{1}(K)$。\n线性多项式的梯度是一个常数向量。因此，$\\nabla w_{h}|_{K}$ 是一个由常数组成的向量，可以看作是 $0$ 次多项式。所以，$\\nabla w_{h}|_{K} \\in [\\mathbb{P}_{0}(K)]^{d}$。\n对流速度 $\\boldsymbol{\\beta}$ 被给定为常数向量。\n常数向量 $\\boldsymbol{\\beta}$ 和常数向量场 $\\nabla w_{h}|_{K}$ 的点积结果是一个标量常数。因此，表达式 $\\boldsymbol{\\beta} \\cdot \\nabla w_{h}|_{K}$ 是一个 $0$ 次多项式，即 $\\boldsymbol{\\beta} \\cdot \\nabla w_{h}|_{K} \\in \\mathbb{P}_{0}(K)$。\n\n接下来，我们分析单元 $K$ 上的离散残差 $r_{h}$。残差定义为：\n$$\nr_{h}|_{K} = - \\nabla \\cdot \\left( \\kappa \\nabla u_{h} \\right)|_{K} + \\left( \\boldsymbol{\\beta} \\cdot \\nabla u_{h} \\right)|_{K} + \\left( \\sigma u_{h} \\right)|_{K} - f\n$$\n我们检查这个表达式中的每一项：\n1.  试探函数 $u_{h}$ 也来自空间 $V_{h}$，所以 $u_{h}|_{K} \\in \\mathbb{P}_{1}(K)$。\n2.  扩散系数 $\\kappa$ 是一个常数。梯度 $\\nabla u_{h}|_{K}$ 是一个常数向量场（$0$ 次多项式）。因此，乘积 $\\kappa \\nabla u_{h}|_{K}$ 也是一个常数向量场。常数向量场的散度为零。因此，$-\\nabla \\cdot ( \\kappa \\nabla u_{h} )|_{K} = 0$。零函数是一个 $0$ 次多项式（或者更严格地说，次数为 $-\\infty$，它包含在 $\\mathbb{P}_{0}(K)$ 中）。\n3.  如前面对 $w_{h}$ 所确立的，项 $\\boldsymbol{\\beta} \\cdot \\nabla u_{h}|_{K}$ 是一个常数，所以它属于 $\\mathbb{P}_{0}(K)$。\n4.  反应系数 $\\sigma$ 是一个非负常数。这个常数与线性多项式 $u_{h}|_{K}$ 的乘积得到一个次数至多为 $1$ 的多项式。如果 $\\sigma  0$ 且 $u_{h}$ 在 $K$ 上不是常数，则此项的次数恰好为 $1$。因此，$\\sigma u_{h}|_{K} \\in \\mathbb{P}_{1}(K)$。\n5.  源项 $f$ 被给定为常数，所以 $f \\in \\mathbb{P}_{0}(K)$。\n\n残差 $r_{h}|_{K}$ 是来自 $\\mathbb{P}_{0}(K)$、$\\mathbb{P}_{0}(K)$、$\\mathbb{P}_{1}(K)$ 和 $\\mathbb{P}_{0}(K)$ 的函数之和。多项式之和的次数等于各个多项式次数的最大值。因此，残差 $r_{h}|_{K}$ 是一个次数至多为 $1$ 的多项式，即 $r_{h}|_{K} \\in \\mathbb{P}_{1}(K)$。\n\n最后，我们确定单元 $K$ 上整个被积函数的多项式次数：\n$$\n\\text{Integrand} = \\tau_{K} \\left( \\boldsymbol{\\beta} \\cdot \\nabla w_{h}|_{K} \\right) \\, r_{h}|_{K}\n$$\n问题陈述 $\\tau_{K}$ 在每个单元上是常数，所以 $\\tau_{K} \\in \\mathbb{P}_{0}(K)$。我们已经发现 $\\boldsymbol{\\beta} \\cdot \\nabla w_{h}|_{K} \\in \\mathbb{P}_{0}(K)$ 且 $r_{h}|_{K} \\in \\mathbb{P}_{1}(K)$。\n被积函数是一个 $0$ 次多项式、另一个 $0$ 次多项式和一个次数至多为 $1$ 的多项式的乘积。乘积的次数是各因子次数之和，即 $0 + 0 + 1 = 1$。\n因此，被积函数是一个总次数至多为 $1$ 的多项式。\n\n如果一个求积法则能够精确地积分任何总次数不超过 $m$ 的多项式，则称其多项式精确度阶数为 $m$。为了保证对任意 $u_{h}, w_{h} \\in V_{h}$ 都能精确计算 SUPG 稳定化项，该求积法则必须能够精确地积分被积函数，这是一个次数至多为 1 的多项式。这要求精确度阶数 $m$ 至少为 $1$。因此，$m$ 的最小整数值为 $1$。",
            "answer": "$$\n\\boxed{1}\n$$"
        }
    ]
}