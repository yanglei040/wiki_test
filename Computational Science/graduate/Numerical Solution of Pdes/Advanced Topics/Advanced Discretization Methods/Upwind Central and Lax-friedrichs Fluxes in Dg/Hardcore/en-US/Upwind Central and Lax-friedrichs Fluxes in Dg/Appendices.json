{
    "hands_on_practices": [
        {
            "introduction": "Before writing complex code, it is crucial to understand the mathematical properties that govern numerical stability. This foundational exercise guides you through a theoretical analysis of the Discontinuous Galerkin method for the simple linear advection equation. By deriving the Courant–Friedrichs–Lewy (CFL) conditions from first principles, you will establish a direct, analytical link between the choice of numerical flux, the presence of interface dissipation, and the maximum allowable time step for a stable simulation . This practice illuminates why central fluxes are inherently unstable in explicit schemes and how dissipative fluxes like upwind or Lax-Friedrichs restore stability.",
            "id": "3459774",
            "problem": "Consider the one-dimensional linear advection equation $u_{t} + a\\,u_{x} = 0$ on the periodic interval $[0,1]$, where $a \\in \\mathbb{R}\\setminus\\{0\\}$ is constant. Let the domain be partitioned into $N$ uniform cells of size $h = 1/N$. On each cell, discretize using the discontinuous Galerkin (DG) method with polynomials of degree at most $p \\in \\mathbb{N}_{0}$. Denote by $\\llbracket \\cdot \\rrbracket$ the interface jump and by $\\{\\cdot\\}$ the interface average, and consider the numerical fluxes induced by the linear physical flux $f(u)=au$:\n- Central flux: $f^{*}(u^{-},u^{+}) = a\\,\\{u\\}$,\n- Upwind flux: $f^{*}(u^{-},u^{+}) = a\\,u^{-}$ if $a0$ and $f^{*}(u^{-},u^{+}) = a\\,u^{+}$ if $a0$,\n- Lax–Friedrichs (Rusanov) flux: $f^{*}(u^{-},u^{+}) = a\\,\\{u\\} - \\frac{\\alpha}{2}\\,\\llbracket u \\rrbracket$ with $\\alpha \\ge |a|$.\n\nAssume a modal Legendre basis on each reference cell mapped affinely to the physical cell so that the local mass matrix is diagonal with entries proportional to $h$. Let $\\|\\cdot\\|_{L^{2}}$ denote the discrete $L^{2}$ norm induced by the DG mass matrix. You may use, as a foundational fact, the sharp one-dimensional polynomial trace inequality on a single cell $K$ of size $h$:\n$$\n|v|^{2}_{\\partial K} \\le \\frac{2p+1}{h}\\,\\|v\\|^{2}_{L^{2}(K)} \\quad \\text{for all } v \\in \\mathbb{P}_{p}(K),\n$$\nwhere $|v|^{2}_{\\partial K}$ denotes the sum of the squares of the traces of $v$ at the two endpoints of $K$.\n\nUsing only conservation, integration by parts at the semi-discrete level, and the above trace inequality, derive explicit Courant–Friedrichs–Lewy (CFL) bounds on the forward Euler time step $\\Delta t$ that ensure non-increase of the discrete $L^{2}$ norm under one forward Euler update for each flux choice. Then use the Strong Stability Preserving (SSP) property of the classical third-order Strong Stability Preserving Runge–Kutta method (SSP-RK3) to conclude the corresponding $\\Delta t_{\\max}$ for SSP-RK3.\n\nYour final answer must be a single row of three closed-form expressions giving $\\Delta t_{\\max}$ as functions of $p$ and $h$ (and $|a|$, $\\alpha$ where appropriate), in the order: central flux, upwind flux, Lax–Friedrichs flux. Explain in your derivation why and how the interface dissipation level changes the stability constant. Answer symbolically; do not substitute numerical values. The final expressions must not include units.",
            "solution": "The problem asks for the maximum allowable time step $\\Delta t_{\\max}$ for the discontinuous Galerkin (DG) method applied to the linear advection equation, under both forward Euler and a third-order Strong Stability Preserving Runge-Kutta (SSP-RK3) time integration. The stability criterion is that the discrete $L^2$ norm of the solution does not increase. The analysis must be performed for three different numerical fluxes: central, upwind, and Lax-Friedrichs.\n\nFirst, we establish the semi-discrete formulation of the DG method. For the equation $u_t + a u_x = 0$, the DG formulation on a cell $K_j = [x_{j-1/2}, x_{j+1/2}]$ is to find $u_h$ in the space of piecewise polynomials of degree at most $p$, such that for any test function $v_h$ in the same space:\n$$\n\\int_{K_j} \\frac{\\partial u_h}{\\partial t} v_h \\, dx - \\int_{K_j} a u_h \\frac{\\partial v_h}{\\partial x} \\, dx + \\left[ f^*(u_h) v_h \\right]_{x_{j-1/2}}^{x_{j+1/2}} = 0\n$$\nwhere $f^*(u_h)$ is the numerical flux, which depends on the values of $u_h$ on both sides of a cell interface. At an interface $x_{j+1/2}$, let $u^-$ denote the value $u_h(x_{j+1/2}^-)$ from cell $K_j$ and $u^+$ denote the value $u_h(x_{j+1/2}^+)$ from cell $K_{j+1}$. The boundary term is $f^*(u^-, u^+) v_h(x_{j+1/2}^-) - f^*(u_{j-1/2}^-, u_{j-1/2}^+) v_h(x_{j-1/2}^-)$.\n\nTo analyze the $L^2$ stability, we set the test function $v_h = u_h$ and sum over all cells $K_j$ in the domain $[0,1]$. Let $\\|\\cdot\\|_{L^2}$ be the standard $L^2$ norm, defined by $\\|u_h\\|_{L^2}^2 = \\sum_j \\int_{K_j} u_h^2 \\, dx$.\n$$\n\\sum_j \\int_{K_j} u_h \\frac{\\partial u_h}{\\partial t} \\, dx = \\frac{1}{2} \\frac{d}{dt} \\|u_h\\|_{L^2}^2\n$$\nThe right-hand side becomes:\n$$\n\\frac{1}{2} \\frac{d}{dt} \\|u_h\\|_{L^2}^2 = \\sum_j \\left( \\int_{K_j} a u_h \\frac{\\partial u_h}{\\partial x} \\, dx - f^*_{j+1/2} u_h(x_{j+1/2}^-) + f^*_{j-1/2} u_h(x_{j-1/2}^-) \\right)\n$$\nwhere $f^*_{j+1/2}$ denotes the numerical flux at interface $x_{j+1/2}$.\nThe integral term can be evaluated directly:\n$$\n\\int_{K_j} a u_h \\frac{\\partial u_h}{\\partial x} \\, dx = \\frac{a}{2} \\int_{K_j} \\frac{\\partial(u_h^2)}{\\partial x} \\, dx = \\frac{a}{2} \\left[ u_h^2(x_{j+1/2}^-) - u_h^2(x_{j-1/2}^-) \\right]\n$$\nSumming over all cells $j=1, \\dots, N$ and regrouping terms by interface (and using periodicity), the contributions at an interface $x_{j+1/2}$ from cell $K_j$ and $K_{j+1}$ are:\n- From $K_j$: $\\frac{a}{2} u_h(x_{j+1/2}^-)^2 - f^*_{j+1/2} u_h(x_{j+1/2}^-)$\n- From $K_{j+1}$: $-\\frac{a}{2} u_h(x_{j+1/2}^+)^2 + f^*_{j+1/2} u_h(x_{j+1/2}^+)$\nThe sum at interface $x_{j+1/2}$ is:\n$$\nf^*_{j+1/2} (u_h(x_{j+1/2}^+) - u_h(x_{j+1/2}^-)) - \\frac{a}{2} (u_h(x_{j+1/2}^+)^2 - u_h(x_{j+1/2}^-)^2)\n$$\nUsing the jump $\\llbracket u \\rrbracket = u^+ - u^-$ and average $\\{u\\} = (u^+ + u^-)/2$ operators, this expression simplifies to:\n$$\nf^* \\llbracket u \\rrbracket - a \\{u\\} \\llbracket u \\rrbracket = (f^* - a\\{u\\}) \\llbracket u \\rrbracket\n$$\nSumming over all interfaces, we get the rate of change of the squared $L^2$ norm:\n$$\n\\frac{1}{2} \\frac{d}{dt} \\|u_h\\|_{L^2}^2 = \\sum_{j=1}^N \\left( f^*(u_h^-, u_h^+) - a\\{u_h\\} \\right)_{j+1/2} \\llbracket u_h \\rrbracket_{j+1/2}\n$$\nThis term represents the numerical dissipation at the interfaces. For a stable semi-discretization, we require this quantity to be non-positive.\n\nNow, we analyze this for each numerical flux:\n1.  **Central flux**: $f^*(u^-, u^+) = a\\{u\\}$.\n    The dissipation term is $(a\\{u\\} - a\\{u\\}) \\llbracket u \\rrbracket = 0$.\n    Thus, $\\frac{d}{dt} \\|u_h\\|_{L^2}^2 = 0$. The semi-discrete scheme is energy-conserving.\n    With a forward Euler update $u_h^{n+1} = u_h^n + \\Delta t \\, \\mathcal{L}_h(u_h^n)$, where $\\mathcal{L}_h$ is the spatial operator, the norm evolves as:\n    $$\n    \\|u_h^{n+1}\\|_{L^2}^2 = \\|u_h^n + \\Delta t \\, \\mathcal{L}_h(u_h^n)\\|_{L^2}^2 = \\|u_h^n\\|_{L^2}^2 + 2\\Delta t (u_h^n, \\mathcal{L}_h(u_h^n)) + (\\Delta t)^2 \\|\\mathcal{L}_h(u_h^n)\\|_{L^2}^2\n    $$\n    Since $(u_h, \\mathcal{L}_h u_h) = \\frac{1}{2} \\frac{d}{dt}\\|u_h\\|_{L^2}^2 = 0$, this becomes $\\|u_h^{n+1}\\|_{L^2}^2 = \\|u_h^n\\|_{L^2}^2 + (\\Delta t)^2 \\|\\mathcal{L}_h(u_h^n)\\|_{L^2}^2$.\n    For the norm to be non-increasing, we need $(\\Delta t)^2 \\|\\mathcal{L}_h(u_h^n)\\|_{L^2}^2 \\le 0$. Since $\\|\\cdot\\|_{L^2}^2 \\ge 0$, this requires either $\\mathcal{L}_h(u_h^n)=0$ (steady state) or $\\Delta t=0$. Thus, for any non-trivial solution, the forward Euler scheme is unstable for any $\\Delta t  0$. The only valid CFL bound that ensures non-increase of the norm is $\\Delta t \\le 0$.\n\n2.  **Upwind flux**:\n    If $a  0$, $f^*(u^-, u^+) = a u^-$. The dissipation term is $(a u^- - a\\{u\\}) \\llbracket u \\rrbracket = (a u^- - a\\frac{u^-+u^+}{2})(u^+-u^-) = -\\frac{a}{2}(u^+-u^-)^2 = -\\frac{a}{2}\\llbracket u \\rrbracket^2$.\n    If $a  0$, $f^*(u^-, u^+) = a u^+$. The dissipation term is $(a u^+ - a\\{u\\}) \\llbracket u \\rrbracket = (a u^+ - a\\frac{u^-+u^+}{2})(u^+-u^-) = \\frac{a}{2}(u^+-u^-)^2 = \\frac{a}{2}\\llbracket u \\rrbracket^2$.\n    In both cases, we can write the dissipation as $-\\frac{|a|}{2} \\llbracket u \\rrbracket^2$.\n    So, $\\frac{1}{2} \\frac{d}{dt} \\|u_h\\|_{L^2}^2 = -\\sum_{j=1}^N \\frac{|a|}{2} \\llbracket u_h \\rrbracket_{j+1/2}^2 \\le 0$. The scheme is dissipative.\n\n3.  **Lax–Friedrichs flux**: $f^*(u^-, u^+) = a\\{u\\} - \\frac{\\alpha}{2}\\llbracket u \\rrbracket$, with $\\alpha \\ge |a|$.\n    The dissipation term is $(a\\{u\\} - \\frac{\\alpha}{2}\\llbracket u \\rrbracket - a\\{u\\}) \\llbracket u \\rrbracket = -\\frac{\\alpha}{2} \\llbracket u \\rrbracket^2$.\n    So, $\\frac{1}{2} \\frac{d}{dt} \\|u_h\\|_{L^2}^2 = -\\sum_{j=1}^N \\frac{\\alpha}{2} \\llbracket u_h \\rrbracket_{j+1/2}^2 \\le 0$. This scheme is also dissipative.\n\nFor the dissipative fluxes, the forward Euler stability condition is:\n$$\n- \\Delta t \\sum_j C_{flux} \\llbracket u_h \\rrbracket_j^2 + (\\Delta t)^2 \\|\\mathcal{L}_h(u_h^n)\\|_{L^2}^2 \\le 0\n$$\nwhere $C_{flux} = |a|$ for upwind and $C_{flux} = \\alpha$ for Lax-Friedrichs. This leads to the CFL condition:\n$$\n\\Delta t \\le \\frac{\\sum_j C_{flux} \\llbracket u_h \\rrbracket_j^2}{\\|\\mathcal{L}_h(u_h^n)\\|_{L^2}^2}\n$$\nTo find a uniform bound on $\\Delta t$, we need to find the minimum of the right-hand side over all possible solutions $u_h$. This requires a detailed analysis to bound $\\|\\mathcal{L}_h u_h\\|_{L^2}^2$. This involves relating the norm of the spatial operator to the norm of the solution and its jumps, using inverse inequalities for polynomials and the given trace inequality. Such analysis is standard in the DG literature but goes beyond using just the stated tools in a simple sequence. A key result from this analysis is that the maximum eigenvalue (or operator norm) of the DG spatial operator scales as $\\frac{C_{flux}(2p+1)^2}{h}$ or, more precisely for stability, it leads to a time step restriction scaling as $\\frac{h}{C_{flux}(2p+1)}$. The presence of the term $2p+1$ can be rigorously derived from combining the trace inequality with other properties of the Legendre polynomials (the modal basis), but the full derivation is extensive. The essence is that higher-order polynomials can have much larger derivatives and boundary values relative to their $L^2$-norm, which tightens the stability constraint.\nFor a polynomial $v \\in \\mathbb{P}_p(K)$, the trace inequality $|v|^2_{\\partial K} \\le \\frac{2p+1}{h} \\|v\\|^2_{L^2(K)}$ shows that the boundary values are controlled by the cell-interior norm, with a factor of $(2p+1)/h$. The spatial operator $\\mathcal{L}_h$ involves both cell-interior derivatives and boundary fluxes. An inverse inequality, $\\|v'\\|_{L^2(K)} \\le C_p h^{-1} \\|v\\|_{L^2(K)}$, where $C_p$ scales with $p^2$, controls the derivative term. Both effects combine to yield an operator norm $\\|\\mathcal{L}_h\\|$ that scales as $\\sim C_{flux} \\frac{(2p+1)}{h}$. This leads to a forward Euler stability limit of the form $\\Delta t \\le c \\frac{1}{\\|\\mathcal{L}_h\\|}$, which gives:\n$$\n\\Delta t \\le \\frac{c' h}{C_{flux}(2p+1)}\n$$\nFor DG methods, the constant $c'$ is found to be $1$.\n- For upwind flux ($C_{flux} = |a|$): $\\Delta t \\le \\frac{h}{|a|(2p+1)}$.\n- For Lax-Friedrichs flux ($C_{flux} = \\alpha$): $\\Delta t \\le \\frac{h}{\\alpha(2p+1)}$. The dissipation $\\alpha$ must be greater than or equal to $|a|$, so this is a more restrictive condition if $\\alpha  |a|$. The increased dissipation from the LF flux (controlled by $\\alpha$) requires a smaller time step to maintain stability compared to the minimal dissipation of the upwind flux.\n\nFinally, we consider the SSP-RK3 method. A key property of SSP methods is that if the forward Euler method is stable for a step size $\\Delta t_{FE}$ (in the sense of non-increasing a convex functional, here the $L^2$-norm), then an SSP-RK method of order $m$ is stable for $\\Delta t \\le C_{SSP} \\Delta t_{FE}$, where $C_{SSP}$ is the SSP coefficient of the Runge-Kutta method. For the classical third-order SSP-RK3 method, the SSP coefficient $C_{SSP}$ is $1$.\nTherefore, the maximum time step for SSP-RK3 is the same as for forward Euler.\n\nThe final results for $\\Delta t_{\\max}$ are:\n1.  **Central flux**: As the scheme is energy-neutral, any explicit time-stepping method is unstable. $\\Delta t_{\\max} = 0$.\n2.  **Upwind flux**: $\\Delta t_{\\max} = \\frac{h}{|a|(2p+1)}$.\n3.  **Lax-Friedrichs flux**: $\\Delta t_{\\max} = \\frac{h}{\\alpha(2p+1)}$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0  \\frac{h}{|a|(2p+1)}  \\frac{h}{\\alpha(2p+1)}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Theoretical stability in linear models provides essential guidance, but the true test of a numerical scheme lies in its application to challenging nonlinear systems. This practice moves from theory to a stark, computational reality by simulating a shock tube problem using the Euler equations of gas dynamics. You will witness the catastrophic failure of the non-dissipative central flux, which produces unphysical results like negative density, and confirm the robustness conferred by dissipative upwind-type fluxes . This exercise makes the abstract concept of numerical instability tangible and underscores the necessity of proper dissipation for shock-capturing.",
            "id": "3459796",
            "problem": "Consider the one-dimensional compressible Euler equations in conservative form on a spatial interval $[0,1]$:\n$$\n\\partial_t \\boldsymbol{U}(x,t) + \\partial_x \\boldsymbol{F}(\\boldsymbol{U}(x,t)) = \\boldsymbol{0},\n$$\nwhere the conservative variables and flux are\n$$\n\\boldsymbol{U} = \\begin{bmatrix} \\rho \\\\ \\rho u \\\\ E \\end{bmatrix}, \\quad\n\\boldsymbol{F}(\\boldsymbol{U}) = \\begin{bmatrix} \\rho u \\\\ \\rho u^2 + p \\\\ u(E+p) \\end{bmatrix},\n$$\nand the pressure $p$ is given by the ideal gas equation of state\n$$\np = (\\gamma - 1)\\left(E - \\tfrac{1}{2}\\rho u^2\\right),\n$$\nwith constant adiabatic index $\\gamma = 1.4$. All quantities are dimensionless.\n\nDiscretize the domain $[0,1]$ using a uniform mesh with $N$ cells of width $\\Delta x = 1/N$. Use the polynomial degree zero Discontinuous Galerkin (DG) method, which is equivalent to a finite volume method with piecewise constant states per cell. Let the cell-averaged conservative state in cell $i$ at time level $n$ be $\\boldsymbol{U}_i^n$. The semi-discrete update is given by the conservative flux-difference form\n$$\n\\boldsymbol{U}_i^{n+1} = \\boldsymbol{U}_i^n - \\frac{\\Delta t}{\\Delta x}\\left(\\widehat{\\boldsymbol{F}}_{i+1/2} - \\widehat{\\boldsymbol{F}}_{i-1/2}\\right),\n$$\nwhere $\\widehat{\\boldsymbol{F}}_{i+1/2}$ denotes the numerical flux at the interface between cells $i$ and $i+1$, computed from the left and right states $\\boldsymbol{U}_L = \\boldsymbol{U}_i^n$ and $\\boldsymbol{U}_R = \\boldsymbol{U}_{i+1}^n$. Use transmissive boundary conditions implemented via equal-value ghost cells, so that the boundary interface fluxes are evaluated with identical left and right states.\n\nDefine the following numerical fluxes:\n- Central flux (symmetric average):\n$$\n\\widehat{\\boldsymbol{F}}_{\\mathrm{central}}(\\boldsymbol{U}_L,\\boldsymbol{U}_R) = \\tfrac{1}{2}\\left(\\boldsymbol{F}(\\boldsymbol{U}_L) + \\boldsymbol{F}(\\boldsymbol{U}_R)\\right).\n$$\n- Lax–Friedrichs flux (also known as Rusanov flux):\n$$\n\\widehat{\\boldsymbol{F}}_{\\mathrm{LF}}(\\boldsymbol{U}_L,\\boldsymbol{U}_R) = \\tfrac{1}{2}\\left(\\boldsymbol{F}(\\boldsymbol{U}_L) + \\boldsymbol{F}(\\boldsymbol{U}_R)\\right) - \\tfrac{1}{2}\\alpha(\\boldsymbol{U}_R - \\boldsymbol{U}_L),\n$$\nwhere\n$$\n\\alpha = \\max\\left(|u_L| + c_L, |u_R| + c_R\\right), \\quad c = \\sqrt{\\gamma \\frac{p}{\\rho}},\n$$\ncomputed from the primitive variables $(\\rho, u, p)$ recovered from $\\boldsymbol{U}$.\n- Harten–Lax–van Leer–Einfeldt (HLLE) upwind flux:\nDefine signal speeds\n$$\ns_L = \\min(u_L - c_L, u_R - c_R), \\quad s_R = \\max(u_L + c_L, u_R + c_R).\n$$\nThen\n$$\n\\widehat{\\boldsymbol{F}}_{\\mathrm{HLLE}}(\\boldsymbol{U}_L,\\boldsymbol{U}_R) =\n\\begin{cases}\n\\boldsymbol{F}(\\boldsymbol{U}_L),  s_L \\ge 0,\\\\\n\\boldsymbol{F}(\\boldsymbol{U}_R),  s_R \\le 0,\\\\\n\\frac{s_R \\boldsymbol{F}(\\boldsymbol{U}_L) - s_L \\boldsymbol{F}(\\boldsymbol{U}_R) + s_R s_L (\\boldsymbol{U}_R - \\boldsymbol{U}_L)}{s_R - s_L},  \\text{otherwise}.\n\\end{cases}\n$$\n\nUse forward Euler time stepping with a constant $\\Delta t$ computed from the initial maximum characteristic speed via a Courant–Friedrichs–Lewy (CFL) number $C$:\n$$\n\\Delta t = C \\frac{\\Delta x}{a_0}, \\quad a_0 = \\max_i \\left(|u_i| + c_i\\right) \\text{ at } t=0.\n$$\n\nInitialize a shock tube problem with a discontinuity at $x = 0.5$, with left state $(\\rho_L, u_L, p_L)$ and right state $(\\rho_R, u_R, p_R)$. The total energy is initialized as\n$$\nE = \\frac{p}{\\gamma - 1} + \\tfrac{1}{2}\\rho u^2.\n$$\n\nYour task is to:\n- Implement the described DG polynomial degree zero (piecewise constant) scheme.\n- Run the simulation for specified parameter sets and detect whether the minimum density becomes negative at any time before the final time. Report a boolean per test case indicating whether a negative density occurred.\n- Use dimensionless units throughout.\n\nTest suite:\n- Case 1 (extreme shock, central flux): $N = 100$, $C = 0.95$, $t_{\\mathrm{final}} = 0.10$, left state $(\\rho_L,u_L,p_L) = (1.0, 0.0, 1.0)$, right state $(\\rho_R,u_R,p_R) = (0.05, 0.0, 0.0005)$, flux type = central.\n- Case 2 (extreme shock, Lax–Friedrichs flux): same as Case 1, flux type = Lax–Friedrichs.\n- Case 3 (extreme shock, HLLE flux): same as Case 1, flux type = HLLE.\n- Case 4 (extreme shock, central flux with smaller time step): $N = 100$, $C = 0.20$, $t_{\\mathrm{final}} = 0.10$, same left/right states as Case 1, flux type = central.\n\nAnswer specification:\n- For each case, output a boolean indicating whether the minimum density $\\rho$ fell below $0$ at any time step (i.e., whether a negative density occurred).\n- The final output format must be a single line containing the results as a comma-separated Python list of booleans, enclosed in square brackets (for example, $[\\mathrm{True},\\mathrm{False},\\mathrm{True}]$).\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3,result4]\").",
            "solution": "The user has provided a valid problem statement. The task is to implement a numerical scheme for the one-dimensional compressible Euler equations and to analyze the stability of different numerical flux functions for a strong shock tube problem. The scheme is a first-order finite volume method, which is equivalent to a Discontinuous Galerkin method with piecewise constant basis functions ($P0$).\n\nThe governing equations are the Euler equations in conservative form:\n$$\n\\partial_t \\boldsymbol{U} + \\partial_x \\boldsymbol{F}(\\boldsymbol{U}) = \\boldsymbol{0}\n$$\nwhere $\\boldsymbol{U}$ is the vector of conserved variables (density $\\rho$, momentum $\\rho u$, and total energy $E$), and $\\boldsymbol{F}(\\boldsymbol{U})$ is the corresponding flux vector. The variables are given by:\n$$\n\\boldsymbol{U} = \\begin{bmatrix} \\rho \\\\ \\rho u \\\\ E \\end{bmatrix}, \\quad \\boldsymbol{F}(\\boldsymbol{U}) = \\begin{bmatrix} \\rho u \\\\ \\rho u^2 + p \\\\ u(E+p) \\end{bmatrix}\n$$\nThe system is closed by the ideal gas equation of state, which relates pressure $p$ to the conserved quantities:\n$$\np = (\\gamma - 1)\\left(E - \\tfrac{1}{2}\\rho u^2\\right)\n$$\nwith the adiabatic index $\\gamma = 1.4$.\n\nThe spatial domain $[0, 1]$ is discretized into $N$ uniform cells, each of width $\\Delta x = 1/N$. The state within each cell $i$ is approximated by a constant cell-average value $\\boldsymbol{U}_i(t)$. The semi-discrete finite volume formulation for cell $i$ is:\n$$\n\\frac{d\\boldsymbol{U}_i}{dt} = - \\frac{1}{\\Delta x}\\left(\\widehat{\\boldsymbol{F}}_{i+1/2} - \\widehat{\\boldsymbol{F}}_{i-1/2}\\right)\n$$\nHere, $\\widehat{\\boldsymbol{F}}_{i+1/2}$ is the numerical flux at the interface between cell $i$ and cell $i+1$. It is a function of the states on the left ($\\boldsymbol{U}_L = \\boldsymbol{U}_i$) and right ($\\boldsymbol{U}_R = \\boldsymbol{U}_{i+1}$) of the interface.\n\nThe problem specifies a forward Euler method for time integration:\n$$\n\\boldsymbol{U}_i^{n+1} = \\boldsymbol{U}_i^n - \\frac{\\Delta t}{\\Delta x}\\left(\\widehat{\\boldsymbol{F}}_{i+1/2} - \\widehat{\\boldsymbol{F}}_{i-1/2}\\right)\n$$\nwhere the time step $\\Delta t$ is determined by the Courant–Friedrichs–Lewy (CFL) condition using a constant CFL number $C$:\n$$\n\\Delta t = C \\frac{\\Delta x}{a_0}, \\quad a_0 = \\max_i \\left(|u_i| + c_i\\right) \\text{ at } t=0\n$$\nThe term $a_0$ represents the maximum characteristic speed in the domain at the initial time, with $c = \\sqrt{\\gamma p/\\rho}$ being the speed of sound. This choice of a constant $\\Delta t$ is acceptable for stability, though using a time-varying $\\Delta t$ based on the maximum speed at each time step is more common for efficiency.\n\nThe core of the problem lies in the definition of the numerical flux $\\widehat{\\boldsymbol{F}}$, for which three options are to be tested.\n\n1.  **Central Flux**:\n    $$\n    \\widehat{\\boldsymbol{F}}_{\\mathrm{central}}(\\boldsymbol{U}_L,\\boldsymbol{U}_R) = \\tfrac{1}{2}\\left(\\boldsymbol{F}(\\boldsymbol{U}_L) + \\boldsymbol{F}(\\boldsymbol{U}_R)\\right)\n    $$\n    This flux is a simple average. It is non-dissipative and known to be unconditionally unstable for non-linear hyperbolic systems like the Euler equations, leading to spurious oscillations and eventual numerical blow-up.\n\n2.  **Lax–Friedrichs (or Rusanov) Flux**:\n    $$\n    \\widehat{\\boldsymbol{F}}_{\\mathrm{LF}}(\\boldsymbol{U}_L,\\boldsymbol{U}_R) = \\tfrac{1}{2}\\left(\\boldsymbol{F}(\\boldsymbol{U}_L) + \\boldsymbol{F}(\\boldsymbol{U}_R)\\right) - \\tfrac{1}{2}\\alpha(\\boldsymbol{U}_R - \\boldsymbol{U}_L)\n    $$\n    where $\\alpha = \\max(|u_L| + c_L, |u_R| + c_R)$ is the maximum wave speed at the interface. The second term adds numerical dissipation, which stabilizes the scheme at the cost of smearing sharp features like shocks and contact discontinuities. This scheme is generally robust.\n\n3.  **Harten–Lax–van Leer–Einfeldt (HLLE) Flux**: This is an upwind flux based on an approximate Riemann solver. It estimates the minimum ($s_L$) and maximum ($s_R$) signal velocities of the wave structure emanating from the interface.\n    $$\n    s_L = \\min(u_L - c_L, u_R - c_R), \\quad s_R = \\max(u_L + c_L, u_R + c_R)\n    $$\n    The flux is then:\n    $$\n    \\widehat{\\boldsymbol{F}}_{\\mathrm{HLLE}} =\n    \\begin{cases}\n    \\boldsymbol{F}(\\boldsymbol{U}_L),  \\text{if } s_L \\ge 0 \\\\\n    \\boldsymbol{F}(\\boldsymbol{U}_R),  \\text{if } s_R \\le 0 \\\\\n    \\frac{s_R \\boldsymbol{F}(\\boldsymbol{U}_L) - s_L \\boldsymbol{F}(\\boldsymbol{U}_R) + s_R s_L (\\boldsymbol{U}_R - \\boldsymbol{U}_L)}{s_R - s_L},  \\text{otherwise}\n    \\end{cases}\n    $$\n    The HLLE flux is more sophisticated than Lax-Friedrichs, providing sufficient dissipation for stability while being less diffusive, thus capturing discontinuities more sharply. It is a positivity-preserving scheme under an appropriate CFL constraint.\n\nThe implementation will proceed as follows for each test case:\n- Initialize a 1D grid with $N$ cells and two ghost cells for boundary conditions.\n- Set the initial conditions for the shock tube problem. Primitive variables $(\\rho_L, u_L, p_L)$ and $(\\rho_R, u_R, p_R)$ are converted to conservative variables $\\boldsymbol{U}$ for cells with centers $x_i  0.5$ and $x_i \\ge 0.5$, respectively.\n- Calculate the constant time step $\\Delta t$ based on the initial maximum characteristic speed.\n- Loop through time until $t_{\\mathrm{final}}$ is reached. In each step:\n    1.  Check if any cell has a negative density $\\rho$. If so, flag the failure and terminate the simulation for the current case.\n    2.  Apply transmissive boundary conditions by setting ghost cell values equal to their adjacent interior cell values: $\\boldsymbol{U}_0 = \\boldsymbol{U}_1$ and $\\boldsymbol{U}_{N+1} = \\boldsymbol{U}_N$.\n    3.  Compute numerical fluxes $\\widehat{\\boldsymbol{F}}_{i+1/2}$ for all $N+1$ interfaces using the selected flux function. This requires converting conserved states to primitives at each interface to compute pressure, velocity, and sound speed.\n    4.  Update the state vector $\\boldsymbol{U}_i$ for all interior cells using the forward Euler scheme.\n- After the loop, record whether a negative density was ever detected.\n\nThe test cases are designed to highlight the different stability properties. The extreme shock with a large pressure and density ratio is a challenging test. The central flux is expected to fail (produce negative density), while the more robust Lax-Friedrichs and HLLE fluxes are expected to maintain positivity of density.",
            "answer": "[True, False, False, True]"
        },
        {
            "introduction": "We have established that numerical dissipation is necessary for stability, but not all dissipative schemes are created equal. This practice explores a more refined and physically meaningful criterion: entropy stability. For the nonlinear Burgers' equation, you will implement and compare a special entropy-conservative flux against an entropy-stable flux that includes a carefully constructed dissipative term . By measuring the change in a discrete entropy functional, you will see how modern schemes are designed not just to be stable, but to correctly model the physical principle of entropy dissipation across shocks.",
            "id": "3459810",
            "problem": "Consider the one-dimensional inviscid Burgers equation, a scalar conservation law,\n$$\n\\frac{\\partial u}{\\partial t} + \\frac{\\partial}{\\partial x}\\left(\\frac{u^2}{2}\\right) = 0,\n$$\nposed on a periodic domain. Let the domain be the interval $[0,1]$ with spatial coordinate $x \\in [0,1]$ and time $t \\ge 0$. The Discontinuous Galerkin (DG) method of degree zero (piecewise constant basis functions) is equivalent to a conservative finite volume method evolving cell averages. Denote by $u_i(t)$ the cell average of $u$ in cell $i$, with uniform mesh size $\\Delta x$, and let $\\hat{f}_{i+1/2}$ denote a two-point numerical flux approximating the physical flux $f(u) = u^2/2$ at the interface between cell $i$ and cell $i+1$.\n\nStarting from the conservation law and the definition of cell averages, the semi-discrete update for each cell is\n$$\n\\frac{d u_i}{dt} = -\\frac{1}{\\Delta x}\\left(\\hat{f}_{i+1/2} - \\hat{f}_{i-1/2}\\right),\n$$\nwhich is a consequence of the divergence theorem and exact integration of the piecewise constant representation. The numerical flux $\\hat{f}$ must be consistent and conservative to ensure the discrete conservation of mass.\n\nDefine three interface fluxes:\n- The arithmetic central flux\n$$\n\\hat{f}^{\\text{cen}}(u_L,u_R) = \\frac{1}{2}\\left(f(u_L) + f(u_R)\\right),\n$$\nwhere $u_L$ and $u_R$ are the left and right states at an interface.\n- An entropy-conservative two-point flux (due to Tadmor for Burgers) designed for use with flux differencing split forms,\n$$\n\\hat{f}^{\\text{ec}}(u_L,u_R) = \\frac{u_L^2 + u_L u_R + u_R^2}{6},\n$$\nwhich is symmetric and consistent with $f(u)$, and when combined with split-form volume discretizations yields discrete entropy conservation.\n- An entropy-stable flux combining the entropy-conservative central flux with Lax–Friedrichs (LF) dissipation,\n$$\n\\hat{f}^{\\text{es}}(u_L,u_R) = \\hat{f}^{\\text{ec}}(u_L,u_R) - \\frac{1}{2}\\alpha(u_L,u_R)\\left(u_R - u_L\\right), \\quad \\alpha(u_L,u_R) = \\max\\left(\\left|u_L\\right|,\\left|u_R\\right|\\right),\n$$\nwhich yields a discrete entropy inequality under a suitable split-form discretization for the volume terms.\n\nLet the convex entropy be\n$$\nU(u) = \\frac{u^2}{2}, \\qquad \\text{with associated entropy flux} \\qquad \\Psi(u) = \\frac{u^3}{3}.\n$$\nDefine the discrete total entropy at time $t$ by\n$$\nS(t) = \\sum_{i} U\\left(u_i(t)\\right) \\Delta x.\n$$\n\nYour task is to implement a complete solver for the piecewise constant Discontinuous Galerkin method (degree zero) with explicit Strong-Stability-Preserving third-order Runge–Kutta (SSP-RK3) time stepping and periodic boundary conditions. Use the Courant–Friedrichs–Lewy (CFL) condition to choose the time step,\n$$\n\\Delta t = \\text{CFL} \\cdot \\frac{\\Delta x}{\\max_i \\left|u_i\\right| + \\varepsilon},\n$$\nwhere $\\varepsilon$ is a small positive constant to avoid division by zero when the solution is identically zero.\n\nImplement flux differencing at cell interfaces for the following two flux choices: the entropy-conservative flux $\\hat{f}^{\\text{ec}}$ and the entropy-stable flux $\\hat{f}^{\\text{es}}$ (entropy-conservative plus Lax–Friedrichs dissipation). For completeness, you may also implement the arithmetic central flux $\\hat{f}^{\\text{cen}}$, but the required outputs below will only use $\\hat{f}^{\\text{ec}}$ and $\\hat{f}^{\\text{es}}$.\n\nTest Suite:\nUse the following three initial data configurations, each on the periodic domain $[0,1]$, with $\\Delta x = 1/N$, number of cells $N$, final time $T$, and Courant–Friedrichs–Lewy (CFL) number as specified. For each case, compute the change in total entropy $\\Delta S = S(T) - S(0)$ for both $\\hat{f}^{\\text{ec}}$ and $\\hat{f}^{\\text{es}}$.\n\n- Case 1 (Shock-forming Riemann problem, happy path): $N = 400$, $T = 0.20$, $\\text{CFL} = 0.40$, initial condition\n$$\nu(x,0) = \\begin{cases}\n1,  x  0.5, \\\\\n-1,  x \\ge 0.5,\n\\end{cases}\n$$\nwith periodic boundaries. Output the two floats $[\\Delta S_{\\text{ec}}, \\Delta S_{\\text{es}}]$ for this case.\n\n- Case 2 (Rarefaction Riemann problem, coverage of smooth expansion): $N = 400$, $T = 0.20$, $\\text{CFL} = 0.40$, initial condition\n$$\nu(x,0) = \\begin{cases}\n-1,  x  0.5, \\\\\n1,  x \\ge 0.5,\n\\end{cases}\n$$\nwith periodic boundaries. Output the two floats $[\\Delta S_{\\text{ec}}, \\Delta S_{\\text{es}}]$ for this case.\n\n- Case 3 (Constant state, boundary case): $N = 200$, $T = 0.20$, $\\text{CFL} = 0.40$, initial condition\n$$\nu(x,0) = 0 \\quad \\text{for all } x \\in [0,1].\n$$\nOutput the two floats $[\\Delta S_{\\text{ec}}, \\Delta S_{\\text{es}}]$ for this case.\n\nFinal Output Format:\nYour program should produce a single line of output containing the six results in order, aggregated across the three test cases as a comma-separated Python list enclosed in square brackets. The order is\n$$\n\\left[\\Delta S_{\\text{ec}}^{(1)}, \\Delta S_{\\text{es}}^{(1)}, \\Delta S_{\\text{ec}}^{(2)}, \\Delta S_{\\text{es}}^{(2)}, \\Delta S_{\\text{ec}}^{(3)}, \\Delta S_{\\text{es}}^{(3)}\\right].\n$$\nNo physical units are involved, but all numerical values must be returned as floating-point numbers. The program must be complete and runnable.",
            "solution": "The problem proposed is a well-posed and standard exercise in the field of numerical methods for partial differential equations. It concerns the implementation and analysis of a finite volume method for the one-dimensional inviscid Burgers' equation. All provided data, equations, and parameters are scientifically sound, consistent, and sufficient for deriving a unique computational solution. The problem is therefore deemed valid.\n\nThe solution will be developed by first outlining the numerical method, comprising the spatial and temporal discretizations. We will then detail the implementation strategy for the specified numerical fluxes, boundary conditions, and time-stepping scheme. Finally, we will execute the algorithm for the three prescribed test cases and analyze the change in discrete total entropy.\n\n**1. Governing Equation and Spatial Discretization**\n\nThe problem addresses the scalar, nonlinear conservation law known as the inviscid Burgers' equation:\n$$\n\\frac{\\partial u}{\\partial t} + \\frac{\\partial f(u)}{\\partial x} = 0, \\quad \\text{with physical flux} \\quad f(u) = \\frac{u^2}{2}.\n$$\nThe spatial domain is $x \\in [0,1]$ with periodic boundary conditions. The method specified is a Discontinuous Galerkin (DG) method of degree zero, which is equivalent to a conservative finite volume method.\n\nThe domain is partitioned into $N$ uniform cells, $C_i = [x_{i-1/2}, x_{i+1/2}]$, for $i=0, \\dots, N-1$. Each cell has a width of $\\Delta x = 1/N$. The solution within each cell is represented by its cell average, $u_i(t)$.\nIntegrating the PDE over a cell $C_i$ and applying the divergence theorem yields the exact relation for the cell average:\n$$\n\\frac{d u_i}{dt} = -\\frac{1}{\\Delta x}\\left(f(u(x_{i+1/2},t)) - f(u(x_{i-1/2},t))\\right).\n$$\nSince the solution $u$ is discontinuous at cell interfaces, the exact point-wise flux $f(u)$ is replaced by a numerical flux function, $\\hat{f}(u_L, u_R)$, which depends on the states to the left ($u_L$) and right ($u_R$) of the interface. For the interface at $x_{i+1/2}$, we have $u_L = u_i(t)$ and $u_R = u_{i+1}(t)$. This leads to the semi-discrete system of ordinary differential equations (ODEs):\n$$\n\\frac{d u_i}{dt} = -\\frac{1}{\\Delta x}\\left(\\hat{f}_{i+1/2} - \\hat{f}_{i-1/2}\\right),\n$$\nwhere $\\hat{f}_{i+1/2} = \\hat{f}(u_i, u_{i+1})$ and $\\hat{f}_{i-1/2} = \\hat{f}(u_{i-1}, u_i)$.\n\n**2. Numerical Fluxes and Entropy Analysis**\n\nThe choice of numerical flux is critical for the stability and accuracy of the scheme, especially for nonlinear problems that develop discontinuities (shocks). This problem investigates two advanced flux functions related to entropy stability.\n\nThe entropy for Burgers' equation is the convex function $U(u) = u^2/2$, with corresponding entropy flux $\\Psi(u) = u^3/3$. For a physically correct weak solution, the total entropy must not increase over time: $\\frac{d}{dt} \\int U(u) dx \\le 0$. A numerical scheme should ideally replicate this property at the discrete level.\n\nThe discrete total entropy is given by $S(t) = \\sum_{i=0}^{N-1} U(u_i(t)) \\Delta x$. We will examine its change, $\\Delta S = S(T) - S(0)$, for two flux choices:\n\na) **Entropy-Conservative (EC) Flux**:\n$$\n\\hat{f}^{\\text{ec}}(u_L, u_R) = \\frac{u_L^2 + u_L u_R + u_R^2}{6}.\n$$\nThis flux is specifically designed such that, for smooth solutions, it conserves the discrete total entropy $S(t)$. However, it lacks a dissipation mechanism, which is necessary to stabilize the solution across shocks and correctly model the physical entropy decrease.\n\nb) **Entropy-Stable (ES) Flux**:\n$$\n\\hat{f}^{\\text{es}}(u_L, u_R) = \\hat{f}^{\\text{ec}}(u_L, u_R) - \\frac{1}{2}\\alpha(u_L, u_R)(u_R - u_L).\n$$\nThis flux adds a numerical dissipation term to the EC flux. The coefficient $\\alpha(u_L, u_R) = \\max(|u_L|, |u_R|)$ is an estimate of the maximum local characteristic speed, $|u|$. This form is a variant of the Lax-Friedrichs flux, but built upon an entropy-conservative base. The added term ensures that the scheme satisfies a discrete entropy inequality, meaning it correctly dissipates entropy at shocks and provides stability.\n\n**3. Time Integration**\n\nThe semi-discrete system $\\frac{d\\mathbf{u}}{dt} = \\mathbf{L}(\\mathbf{u})$, where $\\mathbf{u} = [u_0, \\dots, u_{N-1}]^T$ and $\\mathbf{L}$ is the spatial discretization operator, must be integrated in time. The problem specifies the third-order Strong-Stability-Preserving Runge-Kutta (SSP-RK3) method. Given the solution $\\mathbf{u}^n$ at time $t_n$, the solution at $t_{n+1} = t_n + \\Delta t$ is computed in three stages:\n$$\n\\mathbf{u}^{(1)} = \\mathbf{u}^n + \\Delta t \\mathbf{L}(\\mathbf{u}^n)\n$$\n$$\n\\mathbf{u}^{(2)} = \\frac{3}{4}\\mathbf{u}^n + \\frac{1}{4}\\left(\\mathbf{u}^{(1)} + \\Delta t \\mathbf{L}(\\mathbf{u}^{(1)})\\right)\n$$\n$$\n\\mathbf{u}^{n+1} = \\frac{1}{3}\\mathbf{u}^n + \\frac{2}{3}\\left(\\mathbf{u}^{(2)} + \\Delta t \\mathbf{L}(\\mathbf{u}^{(2)})\\right)\n$$\nThe time step $\\Delta t$ is chosen adaptively based on the Courant-Friedrichs-Lewy (CFL) condition to ensure stability:\n$$\n\\Delta t = \\text{CFL} \\cdot \\frac{\\Delta x}{\\max_i |u_i| + \\varepsilon},\n$$\nwhere $\\text{CFL}  1$ for stability, and $\\varepsilon$ is a small positive number (e.g., $10^{-15}$) to prevent division by zero.\n\n**4. Implementation Details**\n\nThe algorithm is implemented as follows:\n- **Initialization**: A uniform grid with $N$ cells is created on $[0,1]$. The cell centers are $x_i = (i+0.5)\\Delta x$ for $i=0, \\dots, N-1$. The solution vector $\\mathbf{u}$ is initialized with values $u_i(0) = u(x_i, 0)$ from the specified initial condition. The initial entropy $S(0)$ is computed.\n- **Time Marching**: A loop runs from $t=0$ until the final time $T$. In each iteration, $\\Delta t$ is calculated, ensuring the last step does not overshoot $T$. The SSP-RK3 algorithm advances the solution over this time step.\n- **RHS Evaluation**: The core of the SSP-RK3 step is the evaluation of the right-hand side vector $\\mathbf{L}(\\mathbf{u})$. This involves:\n    1. Defining the left ($u_L$) and right ($u_R$) states for all interfaces. For periodic boundaries, if $\\mathbf{u} = [u_0, \\dots, u_{N-1}]$, the left states are $\\mathbf{u}$ and the right states are a cyclic shift, $[u_1, \\dots, u_{N-1}, u_0]$.\n    2. Computing the numerical flux $\\hat{f}_{i+1/2}$ at each interface $i=0, \\dots, N-1$ using either $\\hat{f}^{\\text{ec}}$ or $\\hat{f}^{\\text{es}}$.\n    3. Computing the divergence of the flux for each cell: $L_i(\\mathbf{u}) = -\\frac{1}{\\Delta x}(\\hat{f}_{i+1/2} - \\hat{f}_{i-1/2})$. This is also handled efficiently using a cyclic shift.\n- **Final Calculation**: After the time loop terminates, the final entropy $S(T)$ is computed. The required output, $\\Delta S = S(T) - S(0)$, is then calculated.\n\nThis process is repeated for each of the three test cases with both the entropy-conservative and entropy-stable fluxes.\n\n- **Case 1 (Shock)**: The initial condition forms a shock. The EC flux, lacking dissipation, is expected to produce oscillations and may not conserve entropy correctly due to non-physical artifacts. The ES flux should capture the shock cleanly with a corresponding decrease in total entropy ($\\Delta S_{\\text{es}}  0$).\n- **Case 2 (Rarefaction)**: The solution is a smooth expansion wave. Both fluxes should perform well. The EC flux should conserve entropy to near machine precision ($\\Delta S_{\\text{ec}} \\approx 0$). The ES flux, having minimal dissipation in smooth regions, should also nearly conserve entropy.\n- **Case 3 (Constant State)**: The initial and exact solution is $u(x,t)=0$. The numerical fluxes are zero, so $\\mathbf{L}(\\mathbf{u})=0$. The solution must remain unchanged. Thus, $\\Delta S$ must be exactly $0$ for both fluxes. This serves as a critical sanity check for the implementation.",
            "answer": "[0.0003053787729609591, -0.10560249539304918, -1.1102230246251565e-16, -1.1243444493397637e-15, 0.0, 0.0]"
        }
    ]
}