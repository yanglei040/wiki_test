## 引言
在有限元分析中，数值积分是构建离散代数系统的核心步骤，但其作用远不止于近似计算。求积规则的选择直接影响着单元的精度、效率和稳定性，是有限元模型设计中的一门精妙艺术。然而，工程师和研究者常常面临一个两难的境地：理论上最精确的“完全积分”方案，在应用于低阶单元时，可能导致单元表现出非物理的过度刚度，即“数值闭锁”现象，严重损害解的质量；而简单地减少积分点以提高效率，又可能导致单元过软，产生不稳定的“沙漏”模式，使计算结果失去意义。

本文旨在系统性地解决这一矛盾，深入剖析[有限元法](@entry_id:749389)中两种强大而微妙的[数值积分](@entry_id:136578)策略：[减缩积分](@entry_id:167949)与选择性积分。通过阅读本文，您将理解这些技术如何作为一种“受控的[变分罪](@entry_id:178318)过”，在牺牲部分积分精度的同时，巧妙地克服[数值病态](@entry_id:169044)，并提升计算性能。

文章将分为三个章节展开。在**“原理与机制”**一章中，我们将首先回顾[数值求积](@entry_id:136578)的基础，然后详细阐述[减缩积分](@entry_id:167949)和选择性积分的定义、动机、力学机制，并揭示其与体积闭锁、剪切闭锁以及沙漏不稳定性之间的深刻联系。接下来，在**“应用与交叉学科联系”**一章中，我们将展示这些技术如何从经典的[固体力学](@entry_id:164042)扩展到[非线性](@entry_id:637147)分析、[多物理场耦合](@entry_id:171389)、动力学以及[计算优化](@entry_id:636888)等前沿领域，体现其作为一种普适性设计理念的强大生命力。最后，在**“动手实践”**部分，我们提供了一系列精心设计的计算练习，帮助您将理论知识转化为解决实际问题的能力。

## 原理与机制

在[有限元法](@entry_id:749389) (Finite Element Method, FEM) 的理论框架中，通过[变分原理](@entry_id:198028)将一个连续的[偏微分方程](@entry_id:141332) (PDE) 问题转化为一个代数方程组。这一过程的核心步骤是在有限元空间中求解离散的弱形式，这通常涉及到在每个单元域上对由形函数及其导数构成的表达式进行积分。虽然在理论推导中我们常假设这些积分是精确计算的，但在实际应用中，特别是在使用[等参单元](@entry_id:173863) (isoparametric elements) 时，被积函数往往是复杂的[有理函数](@entry_id:154279)，难以或不可能进行解析积分。因此，[数值积分](@entry_id:136578)，即**[数值求积](@entry_id:136578)** (numerical quadrature)，成为了不可或缺的计算工具。

然而，数值求积在有限元分析中的角色远不止是一个简单的近似计算。求积规则的选择是一个深刻的设计决策，它不仅影响[计算效率](@entry_id:270255)和精度，还直接关系到单元的稳定性和性能，甚至可以用来克服某些低阶单元固有的[数值病态](@entry_id:169044)问题。本章将系统地阐述与[数值求积](@entry_id:136578)相关的两个核心概念：**[减缩积分](@entry_id:167949)** (reduced integration) 和**选择性积分** (selective integration)，并揭示其背后的原理、机制以及对有限元解的影响。

### [数值求积](@entry_id:136578)与[单元刚度矩阵](@entry_id:139369)

我们首先回顾数值求积在[单元刚度矩阵](@entry_id:139369)构建中的作用。以一个标量[扩散](@entry_id:141445)问题为例，其双线性形式为 $a(u,v)=\int_{\Omega}\nabla u \cdot \nabla v \,dx$。对于一个单元 $\Omega_e$，其对总[刚度矩阵](@entry_id:178659)的贡献，即[单元刚度矩阵](@entry_id:139369) $\mathbf{K}_e$，是通过对形函数 $\phi_i$ 的组合进行积分得到的：

$ (\mathbf{K}_e)_{ij} = \int_{\Omega_e} \nabla \phi_j \cdot \nabla \phi_i \, d\mathbf{x} $

在使用等参元的框架下，我们将这个积分从物理单元 $\Omega_e$ 映射到参考单元 $\hat{\Omega}$ (例如，对于[四边形单元](@entry_id:176937)，是 $\xi, \eta \in [-1, 1]^2$) 上进行计算。通过链式法则和坐标变换，积分表达式变为：

$ (\mathbf{K}_e)_{ij} = \int_{\hat{\Omega}} (\nabla_{\xi} \hat{\phi}_j)^T \mathbf{J}^{-T} \mathbf{J}^{-1} (\nabla_{\xi} \hat{\phi}_i) \det(\mathbf{J}) \, d\boldsymbol{\xi} $

其中，$\hat{\phi}_i$ 是参考单元上的形函数，$\mathbf{J}$ 是从参考坐标 $\boldsymbol{\xi}$ 到物理坐标 $\mathbf{x}$ 的雅可比矩阵。通常，$\mathbf{J}$ 本身是 $\boldsymbol{\xi}$ 的函数，导致被积函数——我们称之为 $I(\boldsymbol{\xi})$——是一个复杂的[有理函数](@entry_id:154279)。[数值求积](@entry_id:136578)通过一个加权和来近似这个积分：

$ \int_{\hat{\Omega}} I(\boldsymbol{\xi}) \, d\boldsymbol{\xi} \approx \sum_{k=1}^{n_{gp}} w_k I(\boldsymbol{\xi}_k) $

其中，$n_{gp}$ 是求积点（或[高斯点](@entry_id:170251)）的数量，$w_k$ 是权重，$\boldsymbol{\xi}_k$ 是求积点在参考单元中的位置。

#### 完全积分

一个自然的问题是：我们需要多少个求积点才能得到“足够精确”的结果？在有限元中，我们通常将“足够精确”的求积规则称为**完全积分** (full integration) 或精确积分。这里的“精确”并非指能够解析地计算出任何被积函数的积分，而是指所选用的求积规则的精度足以保证有限元解的[收敛阶](@entry_id:146394)不因[数值积分误差](@entry_id:137490)而降低。

具体需要多少个点，取决于被积函数的性质。以一个在仿射网格（所有单元都是平行四边形）上的双线性四边形 ($Q_1$) 单元为例 。在这种情况下，[雅可比矩阵](@entry_id:264467) $\mathbf{J}$ 是一个常数矩阵。$Q_1$ 形函数的导数（如 $\frac{\partial \hat{\phi}}{\partial \xi}$）是 $\eta$ 的线性函数，而 $\frac{\partial \hat{\phi}}{\partial \eta}$ 是 $\xi$ 的线性函数。因此，被积函数 $I(\xi, \eta)$ 的每一项最多是 $\xi$ 或 $\eta$ 的二次多项式。例如，$(\frac{\partial \hat{\phi}_j}{\partial \eta})(\frac{\partial \hat{\phi}_i}{\partial \eta})$ 是一个关于 $\xi$ 的二次多项式。一个 $n$ 点的[高斯求积法](@entry_id:146011)则能精确积分最高 $2n-1$ 次的多项式。为了精确积分二次多项式，我们需要 $2n-1 \ge 2$，这意味着 $n \ge 1.5$。因此，在每个坐标方向上，我们至少需要 $n=2$ 个[高斯点](@entry_id:170251)。对于二维问题，这就构成了 $2 \times 2$ 的[张量积求积](@entry_id:145940)规则。对于 $Q_1$ 单元，这通常被视为完全积分。

### [减缩积分](@entry_id:167949)：定义、动机与风险

**[减缩积分](@entry_id:167949)** (Reduced Integration) 是一种有意使用比完全积分阶数更低的求积规则来计算单元积分的做法 。例如，对于上述 $Q_1$ 单元，采用 $1 \times 1$ 的高斯求积规则（即只在单元中心 $\xi=0, \eta=0$ 处求值）就是一个典型的[减缩积分](@entry_id:167949)方案。需要强调的是，[减缩积分](@entry_id:167949)改变的是积分的计算方式，而不是单元的[插值函数](@entry_id:262791)（即形函数）。它与降低形函数阶数是两个截然不同的概念。

使用[减缩积分](@entry_id:167949)有两个主要动机：
1.  **提高[计算效率](@entry_id:270255)**：减少求积点的数量直接降低了构建[单元刚度矩阵](@entry_id:139369)所需的计算量，从而加快了整体分析速度。
2.  **克服[数值锁定](@entry_id:752802)** (Numerical Locking)：这是更重要的一个动机。在某些情况下，特别是对于低阶单元，完全积分会使得单元在特定变形模式下表现出过度的、非物理的刚度，导致解的精度严重恶化。这种现象称为“锁定”。[减缩积分](@entry_id:167949)通过放松某些约束，可以有效地缓解或消除[锁定现象](@entry_id:751421)。

#### [变分罪](@entry_id:178318)过与沙漏不稳定性

尽管[减缩积分](@entry_id:167949)有其优势，但它也引入了严重的风险。在理论上，使用不精确的积分是一种**[变分罪](@entry_id:178318)过** (variational crime) 。标准的[伽辽金法](@entry_id:749698)保证了离散解的误差与有限元空间正交，即满足**[伽辽金正交性](@entry_id:173536)** (Galerkin orthogonality)：$a(u - u_h, v_h) = 0, \forall v_h \in V_h$。然而，当使用近似的积分形式 $a_h(\cdot, \cdot)$ 时，我们得到的解 $u_h^Q$ 仅满足 $a_h(u_h^Q, v_h) = \ell_h(v_h)$。[伽辽金正交性](@entry_id:173536) $a(u - u_h^Q, v_h) = 0$ 在一般情况下不再成立。这意味着标准的[误差分析](@entry_id:142477)理论（如[Céa引理](@entry_id:165386)）不再直接适用，必须引入额外的项来估计由求积误差引起的[一致性误差](@entry_id:747725) 。

更危险的是，[减缩积分](@entry_id:167949)可能导致离散系统不稳定。当求积点的数量过少，以至于无法“侦测”到某些非刚体运动的变形模式时，[单元刚度矩阵](@entry_id:139369)就会变得[秩亏](@entry_id:754065) (rank-deficient)。这些求积法则无法感知的、能量为零的非物理变形模式被称为**[伪零能模式](@entry_id:755267)** (spurious zero-energy modes) 或**[沙漏模式](@entry_id:174855)** (hourglass modes)。

让我们通过一个具体的例子来理解[沙漏模式](@entry_id:174855) 。考虑一个矩形 $Q_1$ 单元，其节点位移呈现一种“沙漏”形状，例如，节点位移向量为 $\mathbf{d} = \alpha \{1, 0, -1, 0, 1, 0, -1, 0\}^T$。这个位移场对应的单元内插位移为 $u_x = \alpha \xi \eta, u_y=0$。现在我们计算其应变。在单元中心 $(\xi, \eta) = (0,0)$ 处，应变分量为：
$ \varepsilon_{xx} = \frac{\partial u_x}{\partial x}, \quad \varepsilon_{yy} = \frac{\partial u_y}{\partial y}, \quad \gamma_{xy} = \frac{\partial u_x}{\partial y} + \frac{\partial u_y}{\partial x} $
由于 $u_x$ 的梯度分量 $\frac{\partial u_x}{\partial \xi} = \alpha \eta$ 和 $\frac{\partial u_x}{\partial \eta} = \alpha \xi$ 在原点处均为零，因此在单元中心点的所有应变分量也都为零。如果采用单[点积](@entry_id:149019)分（在[中心点](@entry_id:636820)求值），计算出的[应变能](@entry_id:162699)将为零。这意味着对于这种非刚体变形，单元不产生任何抵抗力。这种[零能模式](@entry_id:172472)的存在会导致[全局刚度矩阵](@entry_id:138630)奇[异或](@entry_id:172120)病态，使得数值解被非物理的、高频[振荡](@entry_id:267781)的[沙漏模式](@entry_id:174855)所污染。

此外，当单元的几何形状发生畸变（即非[仿射映射](@entry_id:746332)）时，沙漏不稳定性问题会更加严重 。对于一个理想的矩形单元，[沙漏模式](@entry_id:174855)产生的应变在整个单元内可能就是零（或呈现某种特定形式），单[点积](@entry_id:149019)分是精确的。但对于一个畸变的四边形，[雅可比矩阵](@entry_id:264467) $\mathbf{J}$ 和[应变-位移矩阵](@entry_id:163451) $\mathbf{B}$ 都是坐标 $(\xi, \eta)$ 的函数。此时，沙漏位移模式虽然在[中心点](@entry_id:636820)应变为零，但在单元的其他位置会产生非零应变。因此，该模式的精确[应变能](@entry_id:162699)是正的。然而，单点[减缩积分](@entry_id:167949)仍然计算出零能量，忽略了这部分本应存在的、能够抵[抗变](@entry_id:192290)形的能量。单元的几何畸变越大，被忽略的能量就越多，这使得数值解与真实物理行为之间的偏差更大，从而“放大”了沙漏不稳定性。

### 选择性积分：一种权衡策略

既然完全积分可能导致锁定，而（均匀）[减缩积分](@entry_id:167949)又可能导致不稳定的[沙漏模式](@entry_id:174855)，一个自然的思路是：我们能否结合两者的优点，既避免锁定，又保持稳定？**选择性积分** (Selective Integration) 正是为此而生。

其核心思想是将单元的能量或双线性形式分解为多个部分，并对不同部分采用不同的求积规则 。通常，我们将导致锁定的那部分能量项进行[减缩积分](@entry_id:167949)，而对其它部分（特别是提供稳定性的部分）进行完全积分。

#### 应用一：缓解[体积锁定](@entry_id:172606)

在[近不可压缩材料](@entry_id:752388)的弹性力学分析中（例如，泊松比 $\nu$ 接近 $0.5$），低阶单元会表现出**[体积锁定](@entry_id:172606)** (volumetric locking)。这是因为离散的位移场无法很好地满足体积不变的约束（$\nabla \cdot \mathbf{u} = 0$），导致单元表现得异常刚硬。

为了解决这个问题，我们将[应变能](@entry_id:162699)分解为**体积** (volumetric) 部分和**偏** (deviatoric) 部分。体积部分与[体积应变](@entry_id:267252) $(\nabla \cdot \mathbf{u})$ 相关，是导致锁定的“罪魁祸首”。选择性积分策略因此采用：
*   对**体积能**项使用**[减缩积分](@entry_id:167949)**（例如，对 $Q_1$ 单元用 $1 \times 1$ 积分）。
*   对**偏置能**项使用**完全积分**（例如，用 $2 \times 2$ 积分）。

这种方法的巧妙之处在于，它在保持单元对[剪切变形](@entry_id:170920)和拉伸变形的精确描述的同时，放松了对体积不变约束的强制要求 [@problem_id:3439193, @problem_id:3439203]。

更深入地看，对体积项采用单[点积](@entry_id:149019)分在代数上等价于引入一个单元内部的常数静水压力未知数，并将其[静态凝聚](@entry_id:176722)掉，这相当于一个 $Q_1/P_0$ ([双线性](@entry_id:146819)位移/常数压力) 的混合单元 。完全积分在单元的多个点上强加体积约束，而单[点积](@entry_id:149019)分仅在单元中心（或平均意义上）施加该约束。这种约束的放松使得单元有足够的“自由度”去变形，从而消除了锁定。同时，由于偏置能项被完全积分，它提供了足够的刚度来抑制由位移插值引起的[沙漏模式](@entry_id:174855)，保证了单元的稳定性 。

#### 应用二：缓解剪切锁定

在板[壳单元](@entry_id:176094)的分析中，特别是对于薄板，**剪切锁定** (shear locking) 是另一个常见问题。以 Reissner-Mindlin 板理论为例，其能量包括弯曲能和剪切能。当板的厚度 $t$ 趋于零时，剪切刚度（与 $t$ 成正比）相对于弯曲刚度（与 $t^3$ 成正比）占主导地位。

对于[双线性插值](@entry_id:170280)的板单元，位移和转角场的不匹配会导致在[纯弯曲](@entry_id:202969)状态下产生非零的伪剪切应变。如果对剪切能项采用完全积分（如 $2 \times 2$ 积分），在薄板极限下，系统为了最小化巨大的剪切能，会强制在所有四个[高斯点](@entry_id:170251)上剪切应变为零。这些过多的约束“锁死”了单元，使其无法产生正确的弯曲变形 。

选择性积分再次提供了解决方案：
*   对**剪切能**项使用**[减缩积分](@entry_id:167949)**（$1 \times 1$ 积分）。
*   对**弯曲能**项使用**完全积分**（$2 \times 2$ 积分）。

通过仅在单元中心一点上强制剪切应变为零，该方法极大地放松了约束。那些在单元[中心点](@entry_id:636820)剪切应变为零的弯曲模式现在可以无惩罚地发生，从而恢复了单元的柔性，使其能够正确地模拟薄板的弯曲行为。

### 理论视角：[一致性与收敛性](@entry_id:747723)

最后，我们从理论层面审视这些积分策略。一个有限元格式能够收敛到正确解的一个必要条件是它能通过**补片检验** (Patch Test)。这意味着，如果一个问题的精确解是一个常应变场（例如，线性位移场），那么有限元方法必须能够精确地再现这个解。

精心设计的减缩或选择性积分方案，其求积规则的选择往往以通过补片检验为准则 。例如，对于仿射网格上的 $Q_1$ 单元，在常应变状态下，双线性形式的被积函数是常数。单点[高斯积分](@entry_id:187139)能够精确地积分常数，因此，尽管它是一种[减缩积分](@entry_id:167949)，但它能通过常应变补片检验，保证了方法的基本一致性 。

总结而言，[减缩积分](@entry_id:167949)和选择性积分是有限元实践中强大而微妙的工具。它们通过引入“受控的”[变分罪](@entry_id:178318)过，以牺牲部分积分精度为代价，来换取计算效率的提升和[数值锁定](@entry_id:752802)等病态行为的克服。均匀[减缩积分](@entry_id:167949)虽然简单，但常伴随着沙漏不稳定的风险，需要额外的稳定化技术。选择性积分则提供了一种更为精妙的平衡，它针对性地处理问题项，在缓解锁定的同时保持了单元的稳定性和一致性，是现代[计算力学](@entry_id:174464)中许多高性能单元设计的基石。理解这些方法的原理和机制，对于正确使用和开发先进的有限元模型至关重要。