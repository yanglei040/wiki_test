{
    "hands_on_practices": [
        {
            "introduction": "The power of the Hybridizable Discontinuous Galerkin (HDG) method lies in its computational efficiency, achieved by reducing a large system of equations into a smaller one involving only unknowns on the mesh skeleton. This process, known as static condensation, is the focus of our first practice. By manually deriving the local-to-global mapping for a simple 1D diffusion problem, you will build a foundational understanding of how element-level unknowns are eliminated in favor of the globally coupled trace variable.",
            "id": "3405290",
            "problem": "Consider the scalar diffusion model problem on the interval $\\Omega = [0,1]$ with constant diffusion coefficient $\\kappa > 0$ and a constant source $f \\in \\mathbb{R}$:\n$$\n- \\frac{\\mathrm{d}}{\\mathrm{d}x} \\left( \\kappa \\frac{\\mathrm{d}u}{\\mathrm{d}x} \\right) = f \\quad \\text{in } (0,1), \\qquad u(0)=0,\\quad u(1)=0.\n$$\nIntroduce the first-order system by defining the flux $q = - \\kappa \\frac{\\mathrm{d}u}{\\mathrm{d}x}$, so that\n$$\n\\kappa^{-1} q + \\frac{\\mathrm{d}u}{\\mathrm{d}x} = 0, \\qquad - \\frac{\\mathrm{d}q}{\\mathrm{d}x} = f.\n$$\nDiscretize $\\Omega$ with a mesh of $2$ elements $K_1=(0,\\tfrac{1}{2})$ and $K_2=(\\tfrac{1}{2},1)$ of equal size $h=\\tfrac{1}{2}$. Consider the Hybridizable Discontinuous Galerkin (HDG) method with polynomial degree $0$ for both the flux and primal variables on each element, that is, seek approximations $q_h|_{K} \\in \\mathbb{P}_0(K)$ and $u_h|_{K} \\in \\mathbb{P}_0(K)$, and a trace $\\lambda_h$ defined on faces (points in one dimension) with constants on each face. On each element $K$, for all constant test functions $r \\in \\mathbb{P}_0(K)$ and $w \\in \\mathbb{P}_0(K)$, the HDG local equations are\n$$\n\\left( \\kappa^{-1} q_h, r \\right)_{K} - \\left( u_h, \\frac{\\mathrm{d}r}{\\mathrm{d}x} \\right)_{K} + \\left\\langle \\lambda_h, r n \\right\\rangle_{\\partial K} = 0,\n$$\n$$\n- \\left( q_h, \\frac{\\mathrm{d}w}{\\mathrm{d}x} \\right)_{K} + \\left\\langle \\widehat{q}_h n, w \\right\\rangle_{\\partial K} = \\left( f, w \\right)_{K},\n$$\nwhere $n$ is the outward unit normal at $\\partial K$ and the numerical flux is given by\n$$\n\\widehat{q}_h n = q_h n + \\tau \\left( u_h - \\lambda_h \\right) \\quad \\text{on } \\partial K,\n$$\nwith a stabilization parameter $\\tau > 0$ constant on each face. Impose the Dirichlet boundary data weakly by prescribing the trace on boundary faces as $\\lambda_h(0)=0$ and $\\lambda_h(1)=0$, leaving only the interior face trace at $x=\\tfrac{1}{2}$, denoted by $\\lambda_m$, as the global unknown.\n\nStarting from these definitions and without invoking any pre-derived HDG formula, do the following:\n\n1. For a generic element $K=(x_L,x_R)$ of length $h$, derive the element-level linear relation that maps the pair of face traces $(\\lambda_L,\\lambda_R)$ on $\\partial K$ to the pair of numerical fluxes $\\left( \\widehat{q}_h n \\right)\\big|_{x_L}$ and $\\left( \\widehat{q}_h n \\right)\\big|_{x_R}$ in the form\n$$\n\\begin{pmatrix}\n\\left. \\widehat{q}_h n \\right|_{x_L} \\\\\n\\left. \\widehat{q}_h n \\right|_{x_R}\n\\end{pmatrix}\n=\n\\mathbf{A}_K\n\\begin{pmatrix}\n\\lambda_L \\\\ \\lambda_R\n\\end{pmatrix}\n+\n\\mathbf{b}_K,\n$$\nidentifying explicitly the $2 \\times 2$ matrix $\\mathbf{A}_K$ and the vector $\\mathbf{b}_K$ as functions of $\\kappa$, $h$, $\\tau$, and $\\int_K f \\, \\mathrm{d}x$.\n\n2. Using the flux continuity (global conservation) condition on the single interior face $x=\\tfrac{1}{2}$, assemble the $1 \\times 1$ global hybrid system for $\\lambda_m$. Reduce it to a single scalar equation $S \\lambda_m = \\beta$, and express the global Schur complement coefficient $S$ and the right-hand side $\\beta$ in terms of $\\kappa$, $h$, $\\tau$, and $f$.\n\nWhat is the resulting closed-form analytic expression for the interior trace value $\\lambda_m$ as a function of $\\kappa$, $h$, $\\tau$, and $f$? Provide your final answer as a single simplified symbolic expression. No numerical rounding is required, and no units are to be included.",
            "solution": "The user wants me to solve a problem regarding the Hybridizable Discontinuous Galerkin (HDG) method for a 1D diffusion equation.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n- **Governing Equation:** $- \\frac{\\mathrm{d}}{\\mathrm{d}x} \\left( \\kappa \\frac{\\mathrm{d}u}{\\mathrm{d}x} \\right) = f$ for $x \\in (0,1)$.\n- **Parameters:** $\\kappa > 0$ is a constant diffusion coefficient, $f \\in \\mathbb{R}$ is a constant source term.\n- **Boundary Conditions:** $u(0)=0, u(1)=0$.\n- **First-Order System:** $q = - \\kappa \\frac{\\mathrm{d}u}{\\mathrm{d}x}$, leading to $\\kappa^{-1} q + \\frac{\\mathrm{d}u}{\\mathrm{d}x} = 0$ and $- \\frac{\\mathrm{d}q}{\\mathrm{d}x} = f$.\n- **Discretization:** Domain $\\Omega = [0,1]$ is divided into two elements $K_1=(0,\\frac{1}{2})$ and $K_2=(\\frac{1}{2},1)$, each of size $h=\\frac{1}{2}$.\n- **Approximation Spaces:** For each element $K$, the approximations for the flux and primal variable are sought in the space of constant polynomials, i.e., $q_h|_K \\in \\mathbb{P}_0(K)$ and $u_h|_K \\in \\mathbb{P}_0(K)$. The trace approximation $\\lambda_h$ is constant on each face (at points $x=0, \\frac{1}{2}, 1$).\n- **HDG Local Weak Form:** For any element $K$ and for all test functions $r \\in \\mathbb{P}_0(K)$ and $w \\in \\mathbb{P}_0(K)$:\n  $$\n  \\left( \\kappa^{-1} q_h, r \\right)_{K} - \\left( u_h, \\frac{\\mathrm{d}r}{\\mathrm{d}x} \\right)_{K} + \\left\\langle \\lambda_h, r n \\right\\rangle_{\\partial K} = 0\n  $$\n  $$\n  - \\left( q_h, \\frac{\\mathrm{d}w}{\\mathrm{d}x} \\right)_{K} + \\left\\langle \\widehat{q}_h n, w \\right\\rangle_{\\partial K} = \\left( f, w \\right)_{K}\n  $$\n- **Numerical Flux:** $\\widehat{q}_h n = q_h n + \\tau \\left( u_h - \\lambda_h \\right)$ on $\\partial K$, with a constant stabilization parameter $\\tau > 0$.\n- **Boundary Trace Values:** $\\lambda_h(0)=0$, $\\lambda_h(1)=0$.\n- **Global Unknown:** The interior trace value $\\lambda_m = \\lambda_h(\\frac{1}{2})$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, being a standard application of the HDG method to the Poisson equation, a fundamental topic in numerical analysis. It is well-posed, providing all necessary equations, boundary conditions, and definitions for a unique solution of the discrete system to be derived. The problem statement is objective and uses precise mathematical language. The setup is complete, consistent, and represents a standard, albeit simplified, scenario for demonstrating the HDG method. The problem is not trivial as it requires a full derivation of the local-to-global procedure.\n\n**Step 3: Verdict and Action**\nThe problem is valid. The solution process will now proceed.\n\n### Part 1: Derivation of the Element-Level Relation\n\nLet us consider a generic element $K=(x_L,x_R)$ of length $h=x_R-x_L$. Since the approximation spaces are $\\mathbb{P}_0(K)$, the approximate solutions on $K$ are constants: $u_h|_K = u_K$ and $q_h|_K = q_K$. We can choose the test functions to be $r=1$ and $w=1$. Their derivatives are $\\frac{\\mathrm{d}r}{\\mathrm{d}x}=0$ and $\\frac{\\mathrm{d}w}{\\mathrm{d}x}=0$.\n\nThe first local equation becomes:\n$$\n\\left( \\kappa^{-1} q_K, 1 \\right)_{K} - \\left( u_K, 0 \\right)_{K} + \\left\\langle \\lambda_h, 1 \\cdot n \\right\\rangle_{\\partial K} = 0\n$$\nThe inner product is $\\int_K \\kappa^{-1} q_K \\, \\mathrm{d}x = \\kappa^{-1} q_K h$. The boundary term is a sum over the boundary points $\\{x_L, x_R\\}$. The outward normal is $n(x_R)=1$ and $n(x_L)=-1$. Let $\\lambda_L = \\lambda_h(x_L)$ and $\\lambda_R = \\lambda_h(x_R)$.\n$$\n\\left\\langle \\lambda_h, n \\right\\rangle_{\\partial K} = \\lambda_h(x_R)n(x_R) + \\lambda_h(x_L)n(x_L) = \\lambda_R(1) + \\lambda_L(-1) = \\lambda_R - \\lambda_L\n$$\nSubstituting these into the equation gives:\n$$\n\\kappa^{-1} q_K h + \\lambda_R - \\lambda_L = 0 \\implies q_K = \\frac{\\kappa}{h}(\\lambda_L - \\lambda_R)\n$$\n\nThe second local equation becomes:\n$$\n- \\left( q_K, 0 \\right)_{K} + \\left\\langle \\widehat{q}_h n, 1 \\right\\rangle_{\\partial K} = \\left( f, 1 \\right)_{K}\n$$\nThe first term is zero. The boundary term is the sum of the normal numerical fluxes at the element ends. Let's denote the scalar numerical normal flux by $Q_L = (\\widehat{q}_h n)|_{x_L}$ and $Q_R = (\\widehat{q}_h n)|_{x_R}$. The boundary term is $Q_L+Q_R$. The right-hand side is $\\int_K f \\, \\mathrm{d}x$. Since $f$ is constant, this is $f h$.\n$$\nQ_L + Q_R = \\int_K f\\,\\mathrm{d}x = f h\n$$\n\nNow we use the definition of the numerical flux. On the boundary $\\partial K$, it is given by $\\widehat{q}_h n = q_h n + \\tau \\left( u_h - \\lambda_h \\right)$.\nAt $x=x_R$, $n=1$:\n$$\nQ_R = q_K(1) + \\tau(u_K - \\lambda_R) = q_K + \\tau(u_K - \\lambda_R)\n$$\nAt $x=x_L$, $n=-1$:\n$$\nQ_L = q_K(-1) + \\tau(u_K - \\lambda_L) = -q_K + \\tau(u_K - \\lambda_L)\n$$\n\nWe have a system of four linear equations for the four variables $q_K, u_K, Q_L, Q_R$ in terms of $\\lambda_L, \\lambda_R$:\n1. $q_K = \\frac{\\kappa}{h}(\\lambda_L - \\lambda_R)$\n2. $Q_L + Q_R = f h$\n3. $Q_R = q_K + \\tau(u_K - \\lambda_R)$\n4. $Q_L = -q_K + \\tau(u_K - \\lambda_L)$\n\nWe want to eliminate $u_K$ and $q_K$. From $(3)$ and $(4)$, we can express $u_K$ terms:\n$u_K - \\lambda_R = \\frac{1}{\\tau}(Q_R - q_K)$\n$u_K - \\lambda_L = \\frac{1}{\\tau}(Q_L + q_K)$\nSubtracting the first from the second gives:\n$(u_K - \\lambda_L) - (u_K - \\lambda_R) = \\frac{1}{\\tau}(Q_L + q_K - (Q_R - q_K))$\n$\\lambda_R - \\lambda_L = \\frac{1}{\\tau}(Q_L - Q_R + 2q_K)$\n$Q_L - Q_R = \\tau(\\lambda_R - \\lambda_L) - 2q_K$.\nSubstitute the expression for $q_K$ from $(1)$:\n$Q_L - Q_R = \\tau(\\lambda_R - \\lambda_L) - 2\\frac{\\kappa}{h}(\\lambda_L - \\lambda_R) = \\tau(\\lambda_R - \\lambda_L) + 2\\frac{\\kappa}{h}(\\lambda_R - \\lambda_L) = (\\tau + \\frac{2\\kappa}{h})(\\lambda_R - \\lambda_L)$\nSo we have a $2 \\times 2$ system for $Q_L, Q_R$:\n(A) $Q_L + Q_R = fh$\n(B) $Q_L - Q_R = -(\\tau + \\frac{2\\kappa}{h})(\\lambda_L - \\lambda_R)$\n\nAdding (A) and (B):\n$2Q_L = fh - (\\tau + \\frac{2\\kappa}{h})(\\lambda_L - \\lambda_R) \\implies Q_L = \\frac{fh}{2} - \\frac{1}{2}(\\tau + \\frac{2\\kappa}{h})\\lambda_L + \\frac{1}{2}(\\tau + \\frac{2\\kappa}{h})\\lambda_R$\nSubtracting (B) from (A):\n$2Q_R = fh + (\\tau + \\frac{2\\kappa}{h})(\\lambda_L - \\lambda_R) \\implies Q_R = \\frac{fh}{2} + \\frac{1}{2}(\\tau + \\frac{2\\kappa}{h})\\lambda_L - \\frac{1}{2}(\\tau + \\frac{2\\kappa}{h})\\lambda_R$\n\nIn the required matrix form, this is:\n$$\n\\begin{pmatrix}\nQ_L \\\\\nQ_R\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n-\\frac{1}{2}(\\tau + \\frac{2\\kappa}{h}) & \\frac{1}{2}(\\tau + \\frac{2\\kappa}{h}) \\\\\n\\frac{1}{2}(\\tau + \\frac{2\\kappa}{h}) & -\\frac{1}{2}(\\tau + \\frac{2\\kappa}{h})\n\\end{pmatrix}\n\\begin{pmatrix}\n\\lambda_L \\\\\n\\lambda_R\n\\end{pmatrix}\n+\n\\begin{pmatrix}\n\\frac{fh}{2} \\\\\n\\frac{fh}{2}\n\\end{pmatrix}\n$$\nThe requested matrix $\\mathbf{A}_K$ and vector $\\mathbf{b}_K$ are:\n$$\n\\mathbf{A}_K = \\frac{1}{2}\\left(\\tau + \\frac{2\\kappa}{h}\\right) \\begin{pmatrix} -1 & 1 \\\\ 1 & -1 \\end{pmatrix}, \\quad \\mathbf{b}_K = \\frac{1}{2}\\left(\\int_K f \\, \\mathrm{d}x\\right) \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}\n$$\n\n### Part 2: Assembly of the Global System and Solution for $\\lambda_m$\n\nThe global system is formed by enforcing the continuity of the numerical flux at the interior face $x=\\frac{1}{2}$. The normal vector $n$ points outwards from each element. For element $K_1=(0, \\frac{1}{2})$, the face at $x=\\frac{1}{2}$ is its right boundary, so its outward normal is $n^{(1)}=+1$. For element $K_2=(\\frac{1}{2}, 1)$, the face at $x=\\frac{1}{2}$ is its left boundary, so its outward normal is $n^{(2)}=-1$. The continuity condition is that the sum of the physical fluxes is zero, which for HDG translates to the sum of numerical normal fluxes being zero:\n$$\n\\left( \\widehat{q}_h n \\right)^{(1)}\\bigg|_{x=\\frac{1}{2}} + \\left( \\widehat{q}_h n \\right)^{(2)}\\bigg|_{x=\\frac{1}{2}} = 0\n$$\n\nFor element $K_1 = (0, \\frac{1}{2})$, we have $h=\\frac{1}{2}$, $x_L=0$, $x_R=\\frac{1}{2}$. The trace values are $\\lambda_L = \\lambda_h(0) = 0$ and $\\lambda_R = \\lambda_h(\\frac{1}{2}) = \\lambda_m$. The flux term corresponds to $Q_R$ from our generic derivation:\n$$\nQ_R^{(1)} = \\frac{fh}{2} + \\frac{1}{2}\\left(\\tau + \\frac{2\\kappa}{h}\\right)(\\lambda_L - \\lambda_R) = \\frac{fh}{2} + \\frac{1}{2}\\left(\\tau + \\frac{2\\kappa}{h}\\right)(0 - \\lambda_m) = \\frac{fh}{2} - \\frac{1}{2}\\left(\\tau + \\frac{2\\kappa}{h}\\right)\\lambda_m\n$$\n\nFor element $K_2 = (\\frac{1}{2}, 1)$, we have $h=\\frac{1}{2}$, $x_L=\\frac{1}{2}$, $x_R=1$. The trace values are $\\lambda_L = \\lambda_h(\\frac{1}{2}) = \\lambda_m$ and $\\lambda_R = \\lambda_h(1) = 0$. The flux term corresponds to $Q_L$:\n$$\nQ_L^{(2)} = \\frac{fh}{2} - \\frac{1}{2}\\left(\\tau + \\frac{2\\kappa}{h}\\right)(\\lambda_L - \\lambda_R) = \\frac{fh}{2} - \\frac{1}{2}\\left(\\tau + \\frac{2\\kappa}{h}\\right)(\\lambda_m - 0) = \\frac{fh}{2} - \\frac{1}{2}\\left(\\tau + \\frac{2\\kappa}{h}\\right)\\lambda_m\n$$\n\nSubstituting these into the continuity equation $Q_R^{(1)} + Q_L^{(2)} = 0$:\n$$\n\\left[ \\frac{fh}{2} - \\frac{1}{2}\\left(\\tau + \\frac{2\\kappa}{h}\\right)\\lambda_m \\right] + \\left[ \\frac{fh}{2} - \\frac{1}{2}\\left(\\tau + \\frac{2\\kappa}{h}\\right)\\lambda_m \\right] = 0\n$$\n$$\nfh - \\left(\\tau + \\frac{2\\kappa}{h}\\right)\\lambda_m = 0\n$$\nThis is the global $1 \\times 1$ system $S \\lambda_m = \\beta$, where the Schur complement coefficient is $S = \\tau + \\frac{2\\kappa}{h}$ and the right-hand side is $\\beta = fh$.\n\nFinally, we solve for the unknown interior trace $\\lambda_m$:\n$$\n\\lambda_m = \\frac{\\beta}{S} = \\frac{fh}{\\tau + \\frac{2\\kappa}{h}}\n$$\nTo simplify, we multiply the numerator and denominator by $h$:\n$$\n\\lambda_m = \\frac{f h^2}{\\tau h + 2\\kappa}\n$$\nThis is the closed-form expression for the interior trace value as a function of $\\kappa$, $h$, $\\tau$, and $f$. For the specific problem given, the mesh size is $h=\\frac{1}{2}$.",
            "answer": "$$\n\\boxed{\\frac{f h^2}{2\\kappa + \\tau h}}\n$$"
        },
        {
            "introduction": "The HDG formulation introduces a stabilization parameter, $\\tau$, which is not merely a numerical knob but is essential for the method's stability and accuracy. This practice challenges you to analyze how different scalings of $\\tau$ with respect to the mesh size $h$ and polynomial degree $p$ affect performance. By reasoning through the provided inequalities, you will uncover the scaling required to achieve $p$-robustness, a critical property for modern high-order methods that ensures stability as the polynomial degree increases. ",
            "id": "3390936",
            "problem": "Consider the scalar diffusion equation on a bounded Lipschitz domain $\\Omega\\subset\\mathbb{R}^d$ with constant diffusion coefficient $\\kappa>0$,\n$$\n-\\nabla\\cdot\\big(\\kappa\\,\\nabla u\\big)=f \\quad \\text{in }\\Omega,\\qquad u=0\\quad\\text{on }\\partial\\Omega.\n$$\nIntroduce the first-order system with flux $q=-\\kappa\\nabla u$ and $\\nabla\\cdot q=f$. Let $\\mathcal{T}_h$ be a shape-regular, quasi-uniform simplicial mesh of $\\Omega$ with element diameter $h$, and let $p\\ge 1$ be the polynomial degree. The Hybridizable Discontinuous Galerkin (HDG) method seeks the element-wise unknowns $(q_h,u_h)$ in polynomial spaces of degree $p$ and a single-valued hybrid trace $\\widehat{u}_h$ on the mesh skeleton. The HDG numerical flux on each face $F$ of an element $K$ is defined by\n$$\n\\widehat{q}_h\\cdot n \\;=\\; q_h\\cdot n \\;+\\; \\tau\\,\\big(u_h-\\widehat{u}_h\\big)\\quad\\text{on }\\partial K,\n$$\nwhere $n$ is the outward normal to $\\partial K$ and $\\tau>0$ is a stabilization parameter, taken piecewise constant per face. Assume the standard polynomial inverse and trace inequalities hold: there exist mesh- and shape-regularityâ€“dependent constants $C_{\\mathrm{tr}},C_{\\mathrm{inv}}>0$ independent of $h$ and $p$ such that for all polynomials $v$ of degree at most $p$ on $K$,\n$$\n\\|v\\|_{L^2(\\partial K)}^2 \\;\\le\\; C_{\\mathrm{tr}}\\,\\frac{p^2}{h}\\,\\|v\\|_{L^2(K)}^2,\\qquad\n\\|\\nabla v\\|_{L^2(K)} \\;\\le\\; C_{\\mathrm{inv}}\\,\\frac{p^2}{h}\\,\\|v\\|_{L^2(K)}.\n$$\nYou are to compare the following three choices for the scaling of $\\tau$ on each face $F$:\n$$\n\\text{(i) }\\;\\tau\\sim \\frac{\\kappa}{h},\\qquad \\text{(ii) }\\;\\tau\\sim \\frac{\\kappa\\,p^2}{h},\\qquad \\text{(iii) }\\;\\tau\\sim \\kappa.\n$$\nUsing only the governing equations, the definition of the HDG flux, and the stated trace/inverse inequalities, reason about how each scaling impacts the stability and accuracy of the HDG method under $p$-refinement at fixed $h$. In particular, assess whether the method remains uniformly stable with respect to $p$ (often termed $p$-robust), whether optimal convergence in energy-type norms with respect to increasing $p$ is preserved, and how the conditioning is affected.\n\nWhich one of the following statements best characterizes the comparative behavior of these three choices under $p$-refinement?\n\nA. Choosing $\\tau\\sim \\kappa\\,p^2/h$ yields $p$-robust stability and preserves optimal $p$-convergence; $\\tau\\sim \\kappa/h$ may be stable for fixed $p$ but loses $p$-robustness as $p$ increases, potentially degrading $p$-convergence constants; $\\tau\\sim \\kappa$ lacks both $h^{-1}$ and $p^2$ scaling, so it can lose stability as $h\\to 0$ or $p\\to\\infty$ and is not $p$-robust.\n\nB. Choosing $\\tau\\sim \\kappa/h$ produces the strongest penalization among the three and therefore the best $p$-robust stability and accuracy; $\\tau\\sim \\kappa\\,p^2/h$ over-penalizes and typically reduces the convergence order under $p$-refinement.\n\nC. The three choices are equivalent up to constants for fixed $h$, so their stability and $p$-refinement behavior are effectively identical.\n\nD. Choosing $\\tau\\sim \\kappa$ provides $p$-robust stability (since it is independent of $p$) but may deteriorate as $h\\to 0$; in contrast, $\\tau\\sim \\kappa\\,p^2/h$ does not improve stability or accuracy relative to $\\tau\\sim \\kappa/h$ under $p$-refinement.",
            "solution": "The user has requested an analysis of the stability and accuracy of the Hybridizable Discontinuous Galerkin (HDG) method for the scalar diffusion equation under different choices for the scaling of the stabilization parameter $\\tau$. The analysis is to be performed under $p$-refinement, where the polynomial degree $p$ is increased while the mesh size $h$ is held fixed. The tools for this analysis are restricted to the governing equations, the HDG flux definition, and the provided polynomial trace and inverse inequalities.\n\nFirst, let us establish the framework for the stability analysis. The stability of DG-type methods, including HDG, hinges on the coercivity of the associated bilinear form. For the HDG method, a key step in the analysis is to ensure that the local problems on each element $K$ are well-posed and that these local properties lead to global stability. The parameter $\\tau$ is critical for this.\n\nLet us consider the local HDG equations on a single element $K$ with source $f=0$ and given trace data $\\widehat{u}_h$ on the boundary $\\partial K$. The solution $(q_h, u_h)$ in the space of polynomials of degree $p$ satisfies:\n1. $\\int_K \\kappa^{-1} q_h \\cdot v \\, d\\mathbf{x} - \\int_K u_h (\\nabla \\cdot v) \\, d\\mathbf{x} + \\int_{\\partial K} \\widehat{u}_h (v \\cdot n) \\, ds = 0$ for all test functions $v$.\n2. $-\\int_K q_h \\cdot \\nabla w \\, d\\mathbf{x} + \\int_{\\partial K} \\widehat{q}_h \\cdot n \\, w \\, ds = 0$ for all test functions $w$.\n\nThe numerical flux is given by $\\widehat{q}_h\\cdot n = q_h\\cdot n + \\tau(u_h-\\widehat{u}_h)$.\n\nTo investigate stability, we can analyze the energy balance. Let us consider the case where the boundary data is homogeneous, i.e., $\\widehat{u}_h = 0$ on $\\partial K$.\nSet $v=q_h$ in (1) and $w=u_h$ in (2):\n$$ \\int_K \\kappa^{-1} |q_h|^2 \\, d\\mathbf{x} - \\int_K u_h (\\nabla \\cdot q_h) \\, d\\mathbf{x} = 0 $$\n$$ -\\int_K q_h \\cdot \\nabla u_h \\, d\\mathbf{x} + \\int_{\\partial K} (q_h\\cdot n + \\tau u_h) u_h \\, ds = 0 $$\nIntegrating by parts the term $\\int_K q_h \\cdot \\nabla u_h \\, d\\mathbf{x}$ gives $-\\int_K u_h (\\nabla \\cdot q_h) \\, d\\mathbf{x} + \\int_{\\partial K} u_h (q_h \\cdot n) \\, ds$.\nSubstituting this into the second equation yields:\n$$ \\int_K u_h (\\nabla \\cdot q_h) \\, d\\mathbf{x} - \\int_{\\partial K} u_h (q_h \\cdot n) \\, ds + \\int_{\\partial K} u_h (q_h \\cdot n) \\, ds + \\int_{\\partial K} \\tau |u_h|^2 \\, ds = 0 $$\n$$ \\implies \\int_K u_h (\\nabla \\cdot q_h) \\, d\\mathbf{x} + \\int_{\\partial K} \\tau |u_h|^2 \\, ds = 0 $$\nNow, substitute the expression for $\\int_K u_h (\\nabla \\cdot q_h) \\, d\\mathbf{x}$ from the first equation:\n$$ \\int_K \\kappa^{-1} |q_h|^2 \\, d\\mathbf{x} + \\int_{\\partial K} \\tau |u_h|^2 \\, ds = 0 $$\nThis equation is fundamental. A crucial part of the full error analysis, which is not shown here but relies on the same principles, reveals a potential instability that must be controlled by $\\tau$. The above derivation for $\\widehat{u}_h=0$ is not sufficient to determine the size of $\\tau$. A more detailed analysis involves bounding cross-terms. Let us follow that path. From the derivation, we had:\n$$ \\int_K \\kappa^{-1} |q_h|^2 \\, d\\mathbf{x} + \\int_{\\partial K} \\tau |u_h|^2 \\, ds = \\int_{\\partial K} u_h (q_h \\cdot n) \\, ds $$\nThis identity holds when considering the local problem for $(q_h,u_h)$ with $\\widehat{u}_h=0$. For stability, the right-hand side term must be controlled by the left-hand side terms. We use the Cauchy-Schwarz inequality, the provided trace inequality, and Young's inequality:\n$$ \\int_{\\partial K} u_h (q_h \\cdot n) \\, ds \\le \\|u_h\\|_{L^2(\\partial K)} \\|q_h \\cdot n\\|_{L^2(\\partial K)} \\le \\|u_h\\|_{L^2(\\partial K)} \\|q_h\\|_{L^2(\\partial K)} $$\nFor any $\\epsilon > 0$, Young's inequality gives:\n$$ \\|u_h\\|_{L^2(\\partial K)} \\|q_h\\|_{L^2(\\partial K)} \\le \\frac{1}{2\\epsilon}\\|u_h\\|_{L^2(\\partial K)}^2 + \\frac{\\epsilon}{2}\\|q_h\\|_{L^2(\\partial K)}^2 $$\nNow we use the given trace inequality for polynomials, $\\|v\\|_{L^2(\\partial K)}^2 \\le C_{\\mathrm{tr}} \\frac{p^2}{h} \\|v\\|_{L^2(K)}^2$, applied to the vector-valued polynomial $q_h$:\n$$ \\frac{\\epsilon}{2}\\|q_h\\|_{L^2(\\partial K)}^2 \\le \\frac{\\epsilon C_{\\mathrm{tr}}}{2} \\frac{p^2}{h} \\|q_h\\|_{L^2(K)}^2 = \\frac{\\epsilon \\kappa C_{\\mathrm{tr}}}{2} \\frac{p^2}{h} \\|\\kappa^{-1/2}q_h\\|_{L^2(K)}^2 $$\nSubstituting this back into the main relation:\n$$ \\int_K \\kappa^{-1} |q_h|^2 \\, d\\mathbf{x} + \\int_{\\partial K} \\tau |u_h|^2 \\, ds \\le \\frac{1}{2\\epsilon}\\|u_h\\|_{L^2(\\partial K)}^2 + \\frac{\\epsilon \\kappa C_{\\mathrm{tr}}}{2} \\frac{p^2}{h} \\|\\kappa^{-1/2}q_h\\|_{L^2(K)}^2 $$\nRearranging the terms:\n$$ \\left(1 - \\frac{\\epsilon \\kappa C_{\\mathrm{tr}}}{2} \\frac{p^2}{h}\\right) \\|\\kappa^{-1/2}q_h\\|_{L^2(K)}^2 + \\left(\\tau - \\frac{1}{2\\epsilon}\\right) \\|u_h\\|_{L^2(\\partial K)}^2 \\le 0 $$\nFor this inequality to enforce that $q_h=0$ and $u_h=0$ on $\\partial K$ (which implies $u_h=0$ in $K$ for a suitable polynomial space), we need both coefficients to be non-negative. There must exist an $\\epsilon > 0$ such that:\n1. $1 - \\frac{\\epsilon \\kappa C_{\\mathrm{tr}}}{2} \\frac{p^2}{h} \\ge 0 \\implies \\epsilon \\le \\frac{2h}{\\kappa C_{\\mathrm{tr}} p^2}$\n2. $\\tau - \\frac{1}{2\\epsilon} \\ge 0 \\implies \\tau \\ge \\frac{1}{2\\epsilon}$\n\nCombining these two conditions, we must have $\\tau \\ge \\frac{1}{2\\epsilon} \\ge \\frac{\\kappa C_{\\mathrm{tr}} p^2}{4h}$.\nThis demonstrates that for local stability (and consequently global stability and optimal error estimates), the stabilization parameter $\\tau$ must be chosen to be at least proportional to $\\kappa p^2/h$.\n\nLet us now evaluate the three proposed scalings based on this finding.\n\n(i) $\\tau \\sim \\frac{\\kappa}{h}$: With this choice, the condition $\\tau \\ge \\frac{\\kappa C_{\\mathrm{tr}} p^2}{4h}$ becomes (up to constants) $\\frac{\\kappa}{h} \\gtrsim \\frac{\\kappa p^2}{h}$, which simplifies to $1 \\gtrsim p^2$. This condition is violated for sufficiently large $p$. Therefore, this choice of $\\tau$ is not sufficient to ensure stability uniformly in $p$. The method is not $p$-robust. For a fixed $p$, this scaling is adequate for stability under $h$-refinement, but for $p$-refinement (fixed $h$), the stability constant degenerates, which degrades the convergence behavior.\n\n(ii) $\\tau \\sim \\frac{\\kappa p^2}{h}$: This choice satisfies the derived condition $\\tau \\gtrsim \\kappa p^2/h$. It ensures that the stability constants in the error analysis are independent of $p$. This property is known as $p$-robustness. A $p$-robust method is expected to achieve optimal convergence rates under $p$-refinement. While a large $\\tau$ can increase the condition number of the algebraic system, this scaling is precisely what is required by the analysis to guarantee robust stability and accuracy as $p$ grows.\n\n(iii) $\\tau \\sim \\kappa$: This choice lacks both the $h^{-1}$ and $p^2$ scaling factors. The condition $\\tau \\gtrsim \\kappa p^2/h$ becomes $\\kappa \\gtrsim \\kappa p^2/h$, or $h \\gtrsim p^2$. This condition fails for both $h \\to 0$ (at fixed $p$) and $p \\to \\infty$ (at fixed $h$). Thus, this choice fails to provide stability in either of the important asymptotic regimes and is unsuitable for a general-purpose method.\n\nWith this analysis, we can evaluate each of the options.\n\nA. Choosing $\\tau\\sim \\kappa\\,p^2/h$ yields $p$-robust stability and preserves optimal $p$-convergence; $\\tau\\sim \\kappa/h$ may be stable for fixed $p$ but loses $p$-robustness as $p$ increases, potentially degrading $p$-convergence constants; $\\tau\\sim \\kappa$ lacks both $h^{-1}$ and $p^2$ scaling, so it can lose stability as $h\\to 0$ or $p\\to\\infty$ and is not $p$-robust.\nThis statement aligns perfectly with our derivation. It correctly identifies $\\tau\\sim \\kappa p^2/h$ as the $p$-robust choice, correctly describes the failure of $\\tau\\sim \\kappa/h$ to be $p$-robust, and correctly points out the instability of $\\tau\\sim \\kappa$ in both $h$ and $p$ limits.\nVerdict: **Correct**.\n\nB. Choosing $\\tau\\sim \\kappa/h$ produces the strongest penalization among the three and therefore the best $p$-robust stability and accuracy; $\\tau\\sim \\kappa\\,p^2/h$ over-penalizes and typically reduces the convergence order under $p$-refinement.\nThe premise that $\\tau\\sim \\kappa/h$ provides the strongest penalization is false for any $p>1$. The conclusion that it yields the best $p$-robust stability is contrary to our analysis. The claim that $\\tau\\sim \\kappa p^2/h$ reduces the convergence order is also incorrect; this scaling is necessary to *preserve* the optimal convergence order.\nVerdict: **Incorrect**.\n\nC. The three choices are equivalent up to constants for fixed $h$, so their stability and $p$-refinement behavior are effectively identical.\nFor a fixed $h$, the three choices $\\tau \\sim \\kappa/h$, $\\tau \\sim \\kappa p^2/h$, and $\\tau \\sim \\kappa$ have distinct dependencies on $p$ and are therefore not equivalent. Their behavior under $p$-refinement is fundamentally different, as shown by our stability analysis.\nVerdict: **Incorrect**.\n\nD. Choosing $\\tau\\sim \\kappa$ provides $p$-robust stability (since it is independent of $p$) but may deteriorate as $h\\to 0$; in contrast, $\\tau\\sim \\kappa\\,p^2/h$ does not improve stability or accuracy relative to $\\tau\\sim \\kappa/h$ under $p$-refinement.\nThe assertion that $\\tau\\sim \\kappa$ is $p$-robust because it is independent of $p$ is a fallacy. $p$-robustness requires the stability constants of the *method* to be independent of $p$, which, as we have shown, requires $\\tau$ to scale with $p^2$. The claim that $\\tau\\sim \\kappa p^2/h$ offers no improvement over $\\tau\\sim \\kappa/h$ for $p$-refinement is also false; it is the crucial modification that ensures $p$-robustness.\nVerdict: **Incorrect**.\n\nThe analysis unequivocally supports statement A as the correct characterization of the behavior of the different scalings for the stabilization parameter $\\tau$.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "Translating a variational formulation into a working computer program requires approximating integrals with numerical quadrature, a step that is fundamental to the method's stability. This exercise guides you to determine the minimum quadrature accuracy needed to exactly evaluate the HDG bilinear form, a crucial consideration for a correct implementation. You will also analyze the severe consequences of underintegration, providing a clear link between the method's theoretical stability and the practical details of its coding. ",
            "id": "3390918",
            "problem": "Consider the Hybridizable Discontinuous Galerkin (HDG) method for the scalar diffusion model problem $-\\nabla \\cdot (\\kappa \\nabla u)=f$ posed on a bounded Lipschitz domain with an affine simplicial mesh. Assume the diffusion coefficient $\\kappa$ is constant on each element and the face stabilization parameter $\\tau$ is a positive constant on each face. Let the HDG finite element spaces be\n- element (volume) scalar unknown $u_h \\in \\mathcal{P}^k(K)$,\n- element (volume) flux $q_h \\in [\\mathcal{P}^k(K)]^d$,\n- face (trace) scalar unknown $\\hat{u}_h \\in \\mathcal{P}^k(F)$,\nwith corresponding test functions $v_h \\in \\mathcal{P}^k(K)$, $r_h \\in [\\mathcal{P}^k(K)]^d$, and $\\hat{v}_h \\in \\mathcal{P}^k(F)$. Here $d$ is the spatial dimension, $K$ denotes an element, and $F \\subset \\partial K$ denotes a face. The HDG local bilinear form on an element $K$ contains, in its canonical formulation derived from integration by parts, the volume inner products\n$(\\kappa q_h, r_h)_K$, $(\\nabla \\cdot q_h, v_h)_K$, $(u_h, \\nabla \\cdot r_h)_K$\nand the face dualities\n$\\langle \\hat{u}_h, r_h \\cdot n \\rangle_{\\partial K}$ and $\\langle \\tau (u_h - \\hat{u}_h), v_h - \\hat{v}_h \\rangle_{\\partial K}$,\nwhere $n$ is the outward unit normal on $\\partial K$. All integrals are understood in the physical domain and the mesh mapping is affine so that Jacobians are constant on elements and faces.\n\nA quadrature rule with polynomial exactness degree $m$ integrates exactly any polynomial integrand of total degree at most $m$. Determine, as functions of the polynomial degree $k$, the minimal polynomial exactness degrees $m_V(k)$ and $m_F(k)$ required for volume and face quadrature rules, respectively, to exactly evaluate all contributions of the HDG bilinear form on each element and face under the assumptions above.\n\nThen, suppose the face quadrature is underintegrated to be exact only up to degree $2k-1$ while volume quadrature remains exact for the degree you determined. Analyze the impact of this face underintegration on the discrete coercivity associated with the $\\langle \\tau (u_h - \\hat{u}_h), v_h - \\hat{v}_h \\rangle_{\\partial K}$ stabilization term. In particular, argue whether such underintegration can create nontrivial functions $(u_h - \\hat{u}_h)$ on a face whose stabilization contribution vanishes under the quadrature, and state the polynomial degree threshold on $m_F(k)$ that rules out this failure mode.\n\nExpress your final answer as a two-entry row matrix of the form $\\begin{pmatrix} m_V(k) & m_F(k) \\end{pmatrix}$. No rounding is required.",
            "solution": "The problem is first validated against the specified criteria.\n\n### Step 1: Extract Givens\n- **Model Problem**: Scalar diffusion $-\\nabla \\cdot (\\kappa \\nabla u)=f$ on a bounded Lipschitz domain.\n- **Mesh**: Affine simplicial mesh.\n- **Coefficients**: $\\kappa$ is constant on each element $K$; $\\tau$ is a positive constant on each face $F$.\n- **Finite Element Spaces**: Volume scalar $u_h \\in \\mathcal{P}^k(K)$, volume flux $q_h \\in [\\mathcal{P}^k(K)]^d$, face scalar $\\hat{u}_h \\in \\mathcal{P}^k(F)$.\n- **Test Function Spaces**: $v_h \\in \\mathcal{P}^k(K)$, $r_h \\in [\\mathcal{P}^k(K)]^d$, $\\hat{v}_h \\in \\mathcal{P}^k(F)$.\n- **HDG Bilinear Form Terms**: Volume integrals $(\\kappa q_h, r_h)_K$, $(\\nabla \\cdot q_h, v_h)_K$, $(u_h, \\nabla \\cdot r_h)_K$; face dualities $\\langle \\hat{u}_h, r_h \\cdot n \\rangle_{\\partial K}$ and $\\langle \\tau (u_h - \\hat{u}_h), v_h - \\hat{v}_h \\rangle_{\\partial K}$.\n- **Quadrature Definition**: A rule with exactness degree $m$ exactly integrates polynomials of total degree at most $m$.\n- **Objective 1**: Determine minimal polynomial exactness degrees $m_V(k)$ and $m_F(k)$ for volume and face quadrature rules for exact evaluation of the bilinear form.\n- **Objective 2**: Analyze the effect of face underintegration with exactness degree $2k-1$ on coercivity and state the threshold degree on $m_F(k)$ to avoid failure.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is well-defined and scientifically grounded. It presents a standard formulation of the Hybridizable Discontinuous Galerkin (HDG) method for a model elliptic problem. All terms, spaces, and assumptions are standard in the field of numerical analysis for partial differential equations. The questions posed are precise, objective, and address a fundamental aspect of the implementation and stability of finite element methods, namely numerical quadrature. The problem is self-contained, with all necessary information provided. The assumptions, such as constant coefficients and affine mappings, are common simplifications used in theoretical analysis that do not trivialize the core concepts being tested. The problem is therefore valid.\n\n### Step 3: Verdict and Action\nThe problem is valid. A full solution will be provided.\n\nThe solution proceeds in two parts as requested. First, we determine the minimal quadrature exactness degrees for the exact evaluation of the HDG bilinear form. Second, we analyze the impact of underintegration on the face stabilization term.\n\nTo determine the required degree of exactness for a quadrature rule, we must find the maximum polynomial degree of the integrands in the bilinear form. The problem assumes an affine mesh, which implies that the Jacobian of the mapping from a reference element (or face) to a physical element (or face) is constant. Consequently, a polynomial of degree $p$ in reference coordinates maps to a polynomial of degree $p$ in physical coordinates, and the integration measure transformation contributes only a constant factor. Therefore, we only need to analyze the degree of the product of the function terms in each integral.\n\n**Part 1: Minimal Quadrature Exactness Degrees**\n\n**Volume Integrals on an element $K$:**\nThe volume integrals involve products of functions defined on the element $K$. The space for scalar functions is $\\mathcal{P}^k(K)$, the space of polynomials of total degree at most $k$. The space for vector functions is $[\\mathcal{P}^k(K)]^d$, where each component is a polynomial of total degree at most $k$.\n\n1.  Term $(\\kappa q_h, r_h)_K = \\int_K \\kappa q_h \\cdot r_h \\, dK$:\n    -   $q_h \\in [\\mathcal{P}^k(K)]^d$ and $r_h \\in [\\mathcal{P}^k(K)]^d$.\n    -   The dot product $q_h \\cdot r_h$ is a sum of products of polynomials of degree at most $k$. Each product $(q_h)_i (r_h)_i$ is a polynomial of degree at most $k+k=2k$.\n    -   Since $\\kappa$ is constant on $K$, the integrand $\\kappa q_h \\cdot r_h$ is a polynomial of degree at most $2k$.\n\n2.  Term $(\\nabla \\cdot q_h, v_h)_K = \\int_K (\\nabla \\cdot q_h) v_h \\, dK$:\n    -   For $q_h \\in [\\mathcal{P}^k(K)]^d$, its divergence $\\nabla \\cdot q_h$ is a sum of derivatives of its components. The derivative of a polynomial of degree $k$ is a polynomial of degree at most $k-1$. Thus, $\\nabla \\cdot q_h \\in \\mathcal{P}^{k-1}(K)$.\n    -   $v_h \\in \\mathcal{P}^k(K)$.\n    -   The integrand $(\\nabla \\cdot q_h) v_h$ is a product of a polynomial of degree at most $k-1$ and a polynomial of degree at most $k$. Its degree is at most $(k-1)+k = 2k-1$.\n\n3.  Term $(u_h, \\nabla \\cdot r_h)_K = \\int_K u_h (\\nabla \\cdot r_h) \\, dK$:\n    -   $u_h \\in \\mathcal{P}^k(K)$.\n    -   For $r_h \\in [\\mathcal{P}^k(K)]^d$, its divergence $\\nabla \\cdot r_h \\in \\mathcal{P}^{k-1}(K)$.\n    -   The integrand $u_h (\\nabla \\cdot r_h)$ is a product of a polynomial of degree at most $k$ and a polynomial of degree at most $k-1$. Its degree is at most $k+(k-1) = 2k-1$.\n\nTo integrate all volume terms exactly, the quadrature rule must be exact for polynomials of the highest degree encountered, which is $\\max(2k, 2k-1, 2k-1) = 2k$.\nThus, the minimal polynomial exactness degree for volume quadrature is $m_V(k) = 2k$.\n\n**Face Integrals on the boundary $\\partial K$:**\nThe face integrals are evaluated over the faces $F$ of the element $K$. The trace of a polynomial from $\\mathcal{P}^k(K)$ onto a flat face $F$ is a polynomial in $\\mathcal{P}^k(F)$.\n\n1.  Term $\\langle \\hat{u}_h, r_h \\cdot n \\rangle_{\\partial K} = \\sum_{F \\subset \\partial K} \\int_F \\hat{u}_h (r_h \\cdot n) \\, dF$:\n    -   On a face $F$, $\\hat{u}_h \\in \\mathcal{P}^k(F)$.\n    -   The trace of $r_h$ on $F$ belongs to $[\\mathcal{P}^k(F)]^d$.\n    -   The normal vector $n$ is constant for each face of an affine simplex.\n    -   The term $r_h \\cdot n$ is a linear combination of components of $r_h$, so its trace is a polynomial in $\\mathcal{P}^k(F)$.\n    -   The integrand $\\hat{u}_h (r_h \\cdot n)$ is a product of two polynomials of degree at most $k$. Its degree is at most $k+k=2k$.\n\n2.  Term $\\langle \\tau (u_h - \\hat{u}_h), v_h - \\hat{v}_h \\rangle_{\\partial K} = \\sum_{F \\subset \\partial K} \\int_F \\tau (u_h - \\hat{u}_h)(v_h - \\hat{v}_h) \\, dF$:\n    -   On a face $F$, the trace $u_h|_F \\in \\mathcal{P}^k(F)$ and $\\hat{u}_h \\in \\mathcal{P}^k(F)$. The difference $(u_h - \\hat{u}_h)$ is a polynomial in $\\mathcal{P}^k(F)$.\n    -   Similarly, $(v_h - \\hat{v}_h)$ is a polynomial in $\\mathcal{P}^k(F)$.\n    -   $\\tau$ is constant on $F$.\n    -   The integrand $\\tau (u_h - \\hat{u}_h)(v_h - \\hat{v}_h)$ is a product of two polynomials of degree at most $k$. Its degree is at most $k+k=2k$.\n\nTo integrate all face terms exactly, the quadrature rule must be exact for polynomials of degree up to $2k$.\nThus, the minimal polynomial exactness degree for face quadrature is $m_F(k) = 2k$.\n\n**Part 2: Analysis of Face Underintegration**\n\nWe now analyze the scenario where the face quadrature is exact only up to degree $2k-1$. We focus on the stabilization term $\\langle \\tau (u_h - \\hat{u}_h), v_h - \\hat{v}_h \\rangle_{\\partial K}$, which is essential for the coercivity of the HDG method. Coercivity is typically established by choosing $v_h = u_h$, $r_h=q_h$, and an appropriate test trace function $\\hat{v}_h$, leading to the term $\\int_F \\tau (u_h - \\hat{u}_h)^2 \\, dF$ on each face $F$. Let $w_h(x) = u_h(x)|_F - \\hat{u}_h(x)$. Since $u_h|_F \\in \\mathcal{P}^k(F)$ and $\\hat{u}_h \\in \\mathcal{P}^k(F)$, we have $w_h \\in \\mathcal{P}^k(F)$. The integrand for the coercivity term is $\\tau(w_h)^2$, which is a polynomial of degree at most $2k$.\n\nAn exactly computed integral $\\int_F \\tau (w_h)^2 \\, dF$ is strictly positive for any non-zero $w_h \\in \\mathcal{P}^k(F)$ since $\\tau > 0$. This ensures that the only function for which the stabilization term vanishes is the zero function, a critical property for stability.\n\nNow consider a quadrature rule $I_F^{2k-1}$ on face $F$, which is exact for polynomials of degree up to $2k-1$. The computed contribution is $I_F^{2k-1}(\\tau (w_h)^2)$. Standard quadrature rules, such as Gauss-type rules, use a set of quadrature points $\\{\\xi_j\\}$ and positive weights $\\{\\omega_j\\}$. The computed integral is $I_F^{2k-1}(\\tau (w_h)^2) = \\tau \\sum_j \\omega_j (w_h(\\xi_j))^2$. Since $\\tau>0$ and $\\omega_j>0$, this sum is zero if and only if $w_h(\\xi_j)=0$ for all quadrature points $\\xi_j$.\n\nThe question is whether a non-trivial $w_h \\in \\mathcal{P}^k(F)$ can exist such that $w_h(\\xi_j)=0$ at all quadrature points of a rule exact to degree $2k-1$. A quadrature rule that is exact for polynomials of degree $2k-1$ can be constructed using $k$ points (e.g., the $k$-point Gauss-Legendre rule for a 1D face). A polynomial of degree $k$ is not uniquely determined by its values at $k$ points. We can construct a non-zero polynomial $p(x) \\in \\mathcal{P}^k(F)$ that has its roots at precisely the $k$ quadrature points, e.g., $p(x) = c \\prod_{j=1}^k (x - \\xi_j)$ for some non-zero constant $c$. For this $w_h = p(x)$, the computed stabilization term is $I_F^{2k-1}(\\tau (w_h)^2) = 0$. However, the true integral is $\\int_F \\tau (w_h)^2 \\, dF > 0$.\n\nTherefore, underintegration with a rule exact to degree $2k-1$ allows for non-zero functions in the kernel of the discrete stabilization term, which breaks coercivity and can render the global linear system singular.\n\nTo rule out this failure mode, the quadrature rule must guarantee that $I_F(\\tau (w_h)^2) > 0$ for all non-zero $w_h \\in \\mathcal{P}^k(F)$. This can be ensured if the quadrature rule integrates the term $\\tau (w_h)^2$ exactly. Since $w_h \\in \\mathcal{P}^k(F)$, the integrand $\\tau(w_h)^2$ is a polynomial of degree at most $2k$. Consequently, the polynomial degree threshold on $m_F(k)$ to rule out this failure mode is $m_F(k) = 2k$. This confirms our finding from the first part.\n\nThe final answer combines the results for $m_V(k)$ and $m_F(k)$ based on the requirement of exact integration.\n$m_V(k) = 2k$\n$m_F(k) = 2k$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2k & 2k\n\\end{pmatrix}\n}\n$$"
        }
    ]
}