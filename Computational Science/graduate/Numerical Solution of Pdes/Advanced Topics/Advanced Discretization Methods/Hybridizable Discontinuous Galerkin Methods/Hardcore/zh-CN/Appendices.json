{
    "hands_on_practices": [
        {
            "introduction": "要想真正掌握混合不连续伽辽金（HDG）方法，没有什么比从第一性原理推导其核心组成部分更有效了。这个实践问题 () 将引导您在一个简单的一维扩散模型上完成这一基本过程。通过手动构建局部到全局的映射并求解界面未知量，您将对静态凝聚（static condensation）以及最终全局系统的结构获得具体的理解。",
            "id": "3405290",
            "problem": "考虑区间 $\\Omega = [0,1]$ 上的标量扩散模型问题，其中扩散系数 $\\kappa > 0$ 和源项 $f \\in \\mathbb{R}$ 均为常数：\n$$\n- \\frac{\\mathrm{d}}{\\mathrm{d}x} \\left( \\kappa \\frac{\\mathrm{d}u}{\\mathrm{d}x} \\right) = f \\quad \\text{在 } (0,1) \\text{ 内}, \\qquad u(0)=0,\\quad u(1)=0.\n$$\n通过定义通量 $q = - \\kappa \\frac{\\mathrm{d}u}{\\mathrm{d}x}$，引入一阶系统，可得\n$$\n\\kappa^{-1} q + \\frac{\\mathrm{d}u}{\\mathrm{d}x} = 0, \\qquad - \\frac{\\mathrm{d}q}{\\mathrm{d}x} = f.\n$$\n用一个包含2个大小相等（$h=\\tfrac{1}{2}$）的单元 $K_1=(0,\\tfrac{1}{2})$ 和 $K_2=(\\tfrac{1}{2},1)$ 的网格来离散化 $\\Omega$。考虑混合化间断 Galerkin (HDG) 方法，在每个单元上，通量和主变量的多项式次数均为 0，即寻求近似解 $q_h|_{K} \\in \\mathbb{P}_0(K)$ 和 $u_h|_{K} \\in \\mathbb{P}_0(K)$，以及在每个面上（一维中的点）为常数的迹函数 $\\lambda_h$。在每个单元 $K$ 上，对于所有常数测试函数 $r \\in \\mathbb{P}_0(K)$ 和 $w \\in \\mathbb{P}_0(K)$，HDG 局部方程为\n$$\n\\left( \\kappa^{-1} q_h, r \\right)_{K} - \\left( u_h, \\frac{\\mathrm{d}r}{\\mathrm{d}x} \\right)_{K} + \\left\\langle \\lambda_h, r n \\right\\rangle_{\\partial K} = 0,\n$$\n$$\n- \\left( q_h, \\frac{\\mathrm{d}w}{\\mathrm{d}x} \\right)_{K} + \\left\\langle \\widehat{q}_h n, w \\right\\rangle_{\\partial K} = \\left( f, w \\right)_{K},\n$$\n其中 $n$ 是 $\\partial K$ 上的单位外法向量，数值通量由下式给出\n$$\n\\widehat{q}_h n = q_h n + \\tau \\left( u_h - \\lambda_h \\right) \\quad \\text{在 } \\partial K \\text{ 上},\n$$\n其中稳定化参数 $\\tau > 0$ 在每个面上均为常数。通过在边界上指定迹函数为 $\\lambda_h(0)=0$ 和 $\\lambda_h(1)=0$ 来弱施加 Dirichlet 边界数据，仅留下内部面 $x=\\tfrac{1}{2}$ 处的迹（记为 $\\lambda_m$）作为全局未知量。\n\n从这些定义出发，并且不调用任何预先推导的 HDG 公式，完成以下操作：\n\n1. 对于长度为 $h$ 的通用单元 $K=(x_L,x_R)$，推导将 $\\partial K$ 上的面迹对 $(\\lambda_L,\\lambda_R)$ 映射到数值通量对 $\\left( \\widehat{q}_h n \\right)\\big|_{x_L}$ 和 $\\left( \\widehat{q}_h n \\right)\\big|_{x_R}$ 的单元级线性关系，其形式为\n$$\n\\begin{pmatrix}\n\\left. \\widehat{q}_h n \\right|_{x_L} \\\\\n\\left. \\widehat{q}_h n \\right|_{x_R}\n\\end{pmatrix}\n=\n\\mathbf{A}_K\n\\begin{pmatrix}\n\\lambda_L \\\\\n\\lambda_R\n\\end{pmatrix}\n+\n\\mathbf{b}_K,\n$$\n并明确指出 $2 \\times 2$ 矩阵 $\\mathbf{A}_K$ 和向量 $\\mathbf{b}_K$ 作为 $\\kappa$、$h$、$\\tau$ 和 $\\int_K f \\, \\mathrm{d}x$ 的函数。\n\n2. 利用单一内部面 $x=\\tfrac{1}{2}$ 上的通量连续性（全局守恒）条件，为 $\\lambda_m$ 组装 $1 \\times 1$ 的全局混合系统。将其简化为单个标量方程 $S \\lambda_m = \\beta$，并用 $\\kappa$、$h$、$\\tau$ 和 $f$ 表示全局舒尔补系数 $S$ 和右端项 $\\beta$。\n\n作为 $\\kappa$、$h$、$\\tau$ 和 $f$ 的函数，内部迹值 $\\lambda_m$ 的解析表达式是什么？请以单个简化的符号表达式形式提供最终答案。不需要进行数值取整，也不需要包含单位。",
            "solution": "用户要求我解决一个关于一维扩散方程的混合化间断 Galerkin (HDG) 方法的问题。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n- **控制方程：** $- \\frac{\\mathrm{d}}{\\mathrm{d}x} \\left( \\kappa \\frac{\\mathrm{d}u}{\\mathrm{d}x} \\right) = f$ 对于 $x \\in (0,1)$。\n- **参数：** $\\kappa > 0$ 是常数扩散系数，$f \\in \\mathbb{R}$ 是常数源项。\n- **边界条件：** $u(0)=0, u(1)=0$。\n- **一阶系统：** $q = - \\kappa \\frac{\\mathrm{d}u}{\\mathrm{d}x}$，得到 $\\kappa^{-1} q + \\frac{\\mathrm{d}u}{\\mathrm{d}x} = 0$ 和 $- \\frac{\\mathrm{d}q}{\\mathrm{d}x} = f$。\n- **离散化：** 区域 $\\Omega = [0,1]$ 被划分为两个单元 $K_1=(0,\\frac{1}{2})$ 和 $K_2=(\\frac{1}{2},1)$，每个单元的大小为 $h=\\frac{1}{2}$。\n- **近似空间：** 对于每个单元 $K$，通量和主变量的近似解在常数多项式空间中寻找，即 $q_h|_K \\in \\mathbb{P}_0(K)$ 和 $u_h|_K \\in \\mathbb{P}_0(K)$。迹近似 $\\lambda_h$ 在每个面（点 $x=0, \\frac{1}{2}, 1$）上是常数。\n- **HDG 局部弱形式：** 对于任意单元 $K$ 和所有测试函数 $r \\in \\mathbb{P}_0(K)$ 及 $w \\in \\mathbb{P}_0(K)$：\n  $$\n  \\left( \\kappa^{-1} q_h, r \\right)_{K} - \\left( u_h, \\frac{\\mathrm{d}r}{\\mathrm{d}x} \\right)_{K} + \\left\\langle \\lambda_h, r n \\right\\rangle_{\\partial K} = 0\n  $$\n  $$\n  - \\left( q_h, \\frac{\\mathrm{d}w}{\\mathrm{d}x} \\right)_{K} + \\left\\langle \\widehat{q}_h n, w \\right\\rangle_{\\partial K} = \\left( f, w \\right)_{K}\n  $$\n- **数值通量：** $\\widehat{q}_h n = q_h n + \\tau \\left( u_h - \\lambda_h \\right)$ 在 $\\partial K$ 上，其中稳定化参数 $\\tau > 0$ 为常数。\n- **边界迹值：** $\\lambda_h(0)=0$, $\\lambda_h(1)=0$。\n- **全局未知量：** 内部迹值 $\\lambda_m = \\lambda_h(\\frac{1}{2})$。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题具有科学依据，是 HDG 方法在泊松方程上的标准应用，这是数值分析中的一个基本课题。问题是适定的，提供了唯一解离散系统所需的所有方程、边界条件和定义。问题陈述是客观的，并使用了精确的数学语言。该设置是完整、一致的，并代表了演示 HDG 方法的一个标准（尽管简化了）场景。问题并非无足轻重，因为它需要对从局部到全局的过程进行完整推导。\n\n**步骤 3：结论与行动**\n问题是有效的。现在开始求解过程。\n\n### 第 1 部分：单元级关系的推导\n\n我们考虑一个长度为 $h=x_R-x_L$ 的通用单元 $K=(x_L,x_R)$。由于近似空间为 $\\mathbb{P}_0(K)$，单元 $K$ 上的近似解是常数：$u_h|_K = u_K$ 和 $q_h|_K = q_K$。我们可以选择测试函数为 $r=1$ 和 $w=1$。它们的导数为 $\\frac{\\mathrm{d}r}{\\mathrm{d}x}=0$ 和 $\\frac{\\mathrm{d}w}{\\mathrm{d}x}=0$。\n\n第一个局部方程变为：\n$$\n\\left( \\kappa^{-1} q_K, 1 \\right)_{K} - \\left( u_K, 0 \\right)_{K} + \\left\\langle \\lambda_h, 1 \\cdot n \\right\\rangle_{\\partial K} = 0\n$$\n内积为 $\\int_K \\kappa^{-1} q_K \\, \\mathrm{d}x = \\kappa^{-1} q_K h$。边界项是边界点 $\\{x_L, x_R\\}$ 上的和。外法向量为 $n(x_R)=1$ 和 $n(x_L)=-1$。设 $\\lambda_L = \\lambda_h(x_L)$ 和 $\\lambda_R = \\lambda_h(x_R)$。\n$$\n\\left\\langle \\lambda_h, n \\right\\rangle_{\\partial K} = \\lambda_h(x_R)n(x_R) + \\lambda_h(x_L)n(x_L) = \\lambda_R(1) + \\lambda_L(-1) = \\lambda_R - \\lambda_L\n$$\n将这些代入方程可得：\n$$\n\\kappa^{-1} q_K h + \\lambda_R - \\lambda_L = 0 \\implies q_K = \\frac{\\kappa}{h}(\\lambda_L - \\lambda_R)\n$$\n\n第二个局部方程变为：\n$$\n- \\left( q_K, 0 \\right)_{K} + \\left\\langle \\widehat{q}_h n, 1 \\right\\rangle_{\\partial K} = \\left( f, 1 \\right)_{K}\n$$\n第一项为零。边界项是单元两端法向数值通量之和。我们用法向数值通量标量 $Q_L = (\\widehat{q}_h n)|_{x_L}$ 和 $Q_R = (\\widehat{q}_h n)|_{x_R}$ 表示。边界项是 $Q_L+Q_R$。右端项是 $\\int_K f \\, \\mathrm{d}x$。由于 $f$ 是常数，此项为 $f h$。\n$$\nQ_L + Q_R = \\int_K f\\,\\mathrm{d}x = f h\n$$\n\n现在我们使用数值通量的定义。在边界 $\\partial K$ 上，它由 $\\widehat{q}_h n = q_h n + \\tau \\left( u_h - \\lambda_h \\right)$ 给出。\n在 $x=x_R$ 处，$n=1$：\n$$\nQ_R = q_K(1) + \\tau(u_K - \\lambda_R) = q_K + \\tau(u_K - \\lambda_R)\n$$\n在 $x=x_L$ 处，$n=-1$：\n$$\nQ_L = q_K(-1) + \\tau(u_K - \\lambda_L) = -q_K + \\tau(u_K - \\lambda_L)\n$$\n\n我们有四个变量 $q_K, u_K, Q_L, Q_R$ 关于 $\\lambda_L, \\lambda_R$ 的四个线性方程组：\n1. $q_K = \\frac{\\kappa}{h}(\\lambda_L - \\lambda_R)$\n2. $Q_L + Q_R = f h$\n3. $Q_R = q_K + \\tau(u_K - \\lambda_R)$\n4. $Q_L = -q_K + \\tau(u_K - \\lambda_L)$\n\n我们希望消去 $u_K$ 和 $q_K$。从(3)和(4)，我们可以表达 $u_K$ 项：\n$u_K - \\lambda_R = \\frac{1}{\\tau}(Q_R - q_K)$\n$u_K - \\lambda_L = \\frac{1}{\\tau}(Q_L + q_K)$\n用第二个式子减去第一个式子得到：\n$(u_K - \\lambda_L) - (u_K - \\lambda_R) = \\frac{1}{\\tau}(Q_L + q_K - (Q_R - q_K))$\n$\\lambda_R - \\lambda_L = \\frac{1}{\\tau}(Q_L - Q_R + 2q_K)$\n$Q_L - Q_R = \\tau(\\lambda_R - \\lambda_L) - 2q_K$。\n代入(1)中 $q_K$ 的表达式：\n$Q_L - Q_R = \\tau(\\lambda_R - \\lambda_L) - 2\\frac{\\kappa}{h}(\\lambda_L - \\lambda_R) = \\tau(\\lambda_R - \\lambda_L) + 2\\frac{\\kappa}{h}(\\lambda_R - \\lambda_L) = (\\tau + \\frac{2\\kappa}{h})(\\lambda_R - \\lambda_L)$\n所以我们有一个关于 $Q_L, Q_R$ 的 $2 \\times 2$ 系统：\n(A) $Q_L + Q_R = fh$\n(B) $Q_L - Q_R = -(\\tau + \\frac{2\\kappa}{h})(\\lambda_L - \\lambda_R)$\n\n将 (A) 和 (B) 相加：\n$2Q_L = fh - (\\tau + \\frac{2\\kappa}{h})(\\lambda_L - \\lambda_R) \\implies Q_L = \\frac{fh}{2} - \\frac{1}{2}(\\tau + \\frac{2\\kappa}{h})\\lambda_L + \\frac{1}{2}(\\tau + \\frac{2\\kappa}{h})\\lambda_R$\n将 (B) 从 (A) 中减去：\n$2Q_R = fh + (\\tau + \\frac{2\\kappa}{h})(\\lambda_L - \\lambda_R) \\implies Q_R = \\frac{fh}{2} + \\frac{1}{2}(\\tau + \\frac{2\\kappa}{h})\\lambda_L - \\frac{1}{2}(\\tau + \\frac{2\\kappa}{h})\\lambda_R$\n\n写成所要求的矩阵形式，即为：\n$$\n\\begin{pmatrix}\nQ_L \\\\\nQ_R\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n-\\frac{1}{2}(\\tau + \\frac{2\\kappa}{h}) & \\frac{1}{2}(\\tau + \\frac{2\\kappa}{h}) \\\\\n\\frac{1}{2}(\\tau + \\frac{2\\kappa}{h}) & -\\frac{1}{2}(\\tau + \\frac{2\\kappa}{h})\n\\end{pmatrix}\n\\begin{pmatrix}\n\\lambda_L \\\\\n\\lambda_R\n\\end{pmatrix}\n+\n\\begin{pmatrix}\n\\frac{fh}{2} \\\\\n\\frac{fh}{2}\n\\end{pmatrix}\n$$\n所求的矩阵 $\\mathbf{A}_K$ 和向量 $\\mathbf{b}_K$ 是：\n$$\n\\mathbf{A}_K = \\frac{1}{2}\\left(\\tau + \\frac{2\\kappa}{h}\\right) \\begin{pmatrix} -1 & 1 \\\\ 1 & -1 \\end{pmatrix}, \\quad \\mathbf{b}_K = \\frac{1}{2}\\left(\\int_K f \\, \\mathrm{d}x\\right) \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}\n$$\n\n### 第 2 部分：全局系统的组装与 $\\lambda_m$ 的求解\n\n全局系统是通过在内表面 $x=\\frac{1}{2}$ 上强制施加数值通量的连续性来形成的。法向量 $n$ 从每个单元向外指出。对于单元 $K_1=(0, \\frac{1}{2})$，$x=\\frac{1}{2}$ 处的面是其右边界，因此其外法向量为 $n^{(1)}=+1$。对于单元 $K_2=(\\frac{1}{2}, 1)$，$x=\\frac{1}{2}$ 处的面是其左边界，因此其外法向量为 $n^{(2)}=-1$。连续性条件是物理通量之和为零，对于 HDG，这转化为法向数值通量之和为零：\n$$\n\\left( \\widehat{q}_h n \\right)^{(1)}\\bigg|_{x=\\frac{1}{2}} + \\left( \\widehat{q}_h n \\right)^{(2)}\\bigg|_{x=\\frac{1}{2}} = 0\n$$\n\n对于单元 $K_1 = (0, \\frac{1}{2})$，我们有 $h=\\frac{1}{2}$，$x_L=0$，$x_R=\\frac{1}{2}$。迹值为 $\\lambda_L = \\lambda_h(0) = 0$ 和 $\\lambda_R = \\lambda_h(\\frac{1}{2}) = \\lambda_m$。通量项对应于我们通用推导中的 $Q_R$：\n$$\nQ_R^{(1)} = \\frac{fh}{2} + \\frac{1}{2}\\left(\\tau + \\frac{2\\kappa}{h}\\right)(\\lambda_L - \\lambda_R) = \\frac{fh}{2} + \\frac{1}{2}\\left(\\tau + \\frac{2\\kappa}{h}\\right)(0 - \\lambda_m) = \\frac{fh}{2} - \\frac{1}{2}\\left(\\tau + \\frac{2\\kappa}{h}\\right)\\lambda_m\n$$\n\n对于单元 $K_2 = (\\frac{1}{2}, 1)$，我们有 $h=\\frac{1}{2}$，$x_L=\\frac{1}{2}$，$x_R=1$。迹值为 $\\lambda_L = \\lambda_h(\\frac{1}{2}) = \\lambda_m$ 和 $\\lambda_R = \\lambda_h(1) = 0$。通量项对应于 $Q_L$：\n$$\nQ_L^{(2)} = \\frac{fh}{2} - \\frac{1}{2}\\left(\\tau + \\frac{2\\kappa}{h}\\right)(\\lambda_L - \\lambda_R) = \\frac{fh}{2} - \\frac{1}{2}\\left(\\tau + \\frac{2\\kappa}{h}\\right)(\\lambda_m - 0) = \\frac{fh}{2} - \\frac{1}{2}\\left(\\tau + \\frac{2\\kappa}{h}\\right)\\lambda_m\n$$\n\n将这些代入连续性方程 $Q_R^{(1)} + Q_L^{(2)} = 0$：\n$$\n\\left[ \\frac{fh}{2} - \\frac{1}{2}\\left(\\tau + \\frac{2\\kappa}{h}\\right)\\lambda_m \\right] + \\left[ \\frac{fh}{2} - \\frac{1}{2}\\left(\\tau + \\frac{2\\kappa}{h}\\right)\\lambda_m \\right] = 0\n$$\n$$\nfh - \\left(\\tau + \\frac{2\\kappa}{h}\\right)\\lambda_m = 0\n$$\n这就是全局 $1 \\times 1$ 系统 $S \\lambda_m = \\beta$，其中舒尔补系数为 $S = \\tau + \\frac{2\\kappa}{h}$，右端项为 $\\beta = fh$。\n\n最后，我们求解未知的内部迹 $\\lambda_m$：\n$$\n\\lambda_m = \\frac{\\beta}{S} = \\frac{fh}{\\tau + \\frac{2\\kappa}{h}}\n$$\n为了简化，我们将分子和分母同乘以 $h$：\n$$\n\\lambda_m = \\frac{f h^2}{\\tau h + 2\\kappa}\n$$\n这就是内部迹值作为 $\\kappa$、$h$、$\\tau$ 和 $f$ 函数的闭式表达式。对于给定的具体问题，网格尺寸为 $h=\\frac{1}{2}$。",
            "answer": "$$\n\\boxed{\\frac{f h^2}{2\\kappa + \\tau h}}\n$$"
        },
        {
            "introduction": "从理论走向实践，我们必须考虑如何计算HDG公式中的积分。本练习 () 探讨了数值积分（numerical quadrature）的关键作用，这是一种在计算机程序中近似这些积分的方法。您将确定这些积分准则为保证方法的完整性所需的最低精度，并分析积分精度不足如何损害数值稳定性——这是任何稳健的有限元实现都必须考虑的关键因素。",
            "id": "3390918",
            "problem": "考虑标量扩散模型问题 $-\\nabla \\cdot (\\kappa \\nabla u)=f$，该问题建立在一个带有仿射单纯网格的有界利普希茨域上。假设扩散系数 $\\kappa$ 在每个单元上为常数，面稳定化参数 $\\tau$ 在每个面上为正常数。设可杂交间断伽辽金 (HDG) 有限元空间为\n- 单元（体积）标量未知数 $u_h \\in \\mathcal{P}^k(K)$，\n- 单元（体积）通量 $q_h \\in [\\mathcal{P}^k(K)]^d$，\n- 面（迹）标量未知数 $\\hat{u}_h \\in \\mathcal{P}^k(F)$，\n及其对应的检验函数 $v_h \\in \\mathcal{P}^k(K)$、$r_h \\in [\\mathcal{P}^k(K)]^d$ 和 $\\hat{v}_h \\in \\mathcal{P}^k(F)$。此处 $d$ 是空间维度，$K$ 表示一个单元，$F \\subset \\partial K$ 表示一个面。单元 $K$ 上的 HDG 局部双线性形式，在其通过分部积分推导出的典范形式中，包含体积内积\n$(\\kappa q_h, r_h)_K$、$(\\nabla \\cdot q_h, v_h)_K$、$(u_h, \\nabla \\cdot r_h)_K$\n和面对偶\n$\\langle \\hat{u}_h, r_h \\cdot n \\rangle_{\\partial K}$ 和 $\\langle \\tau (u_h - \\hat{u}_h), v_h - \\hat{v}_h \\rangle_{\\partial K}$，\n其中 $n$ 是 $\\partial K$ 上的外单位法向量。所有积分都在物理域中进行，且网格映射是仿射的，因此雅可比行列式在单元和面上是常数。\n\n一个多项式精确度为 $m$ 的求积法则能够精确积分任何总次数至多为 $m$ 的多项式被积函数。在上述假设下，请确定体积和面求积法则分别需要的最小多项式精确度 $m_V(k)$ 和 $m_F(k)$（作为多项式次数 $k$ 的函数），以精确计算 HDG 双线性形式在每个单元和面上的所有贡献。\n\n然后，假设面求积是欠积分的，仅对次数最高为 $2k-1$ 的多项式精确，而体积求积仍对您确定的次数保持精确。分析这种面欠积分对与稳定化项 $\\langle \\tau (u_h - \\hat{u}_h), v_h - \\hat{v}_h \\rangle_{\\partial K}$ 相关的离散矫顽性的影响。特别地，论证这种欠积分是否会在面上产生非平凡函数 $(u_h - \\hat{u}_h)$，其在求积下的稳定化贡献为零，并陈述排除此失效模式的 $m_F(k)$ 的多项式次数阈值。\n\n将您的最终答案表示为一个二元行矩阵，形式为 $\\begin{pmatrix} m_V(k) & m_F(k) \\end{pmatrix}$。无需四舍五入。",
            "solution": "首先根据指定标准对问题进行验证。\n\n### 步骤 1：提取已知条件\n- **模型问题**：在有界利普希茨域上的标量扩散问题 $-\\nabla \\cdot (\\kappa \\nabla u)=f$。\n- **网格**：仿射单纯网格。\n- **系数**：$\\kappa$ 在每个单元 $K$ 上为常数；$\\tau$ 在每个面 $F$ 上为正常数。\n- **有限元空间**：体积标量 $u_h \\in \\mathcal{P}^k(K)$，体积通量 $q_h \\in [\\mathcal{P}^k(K)]^d$，面标量 $\\hat{u}_h \\in \\mathcal{P}^k(F)$。\n- **检验函数空间**：$v_h \\in \\mathcal{P}^k(K)$，$r_h \\in [\\mathcal{P}^k(K)]^d$，$\\hat{v}_h \\in \\mathcal{P}^k(F)$。\n- **HDG 双线性形式项**：体积积分 $(\\kappa q_h, r_h)_K$、$(\\nabla \\cdot q_h, v_h)_K$、$(u_h, \\nabla \\cdot r_h)_K$；面对偶 $\\langle \\hat{u}_h, r_h \\cdot n \\rangle_{\\partial K}$ 和 $\\langle \\tau (u_h - \\hat{u}_h), v_h - \\hat{v}_h \\rangle_{\\partial K}$。\n- **求积定义**：精确度为 $m$ 的法则能精确积分总次数至多为 $m$ 的多项式。\n- **目标 1**：确定体积和面求积法则的最小多项式精确度 $m_V(k)$ 和 $m_F(k)$，以精确计算双线性形式。\n- **目标 2**：分析面欠积分（精确度为 $2k-1$）对矫顽性的影响，并陈述避免失效的 $m_F(k)$ 的阈值。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题定义明确且具有科学依据。它为模型椭圆问题提出了可杂交间断伽辽金 (HDG) 方法的标准形式。所有术语、空间和假设在偏微分方程数值分析领域都是标准的。所提出的问题精确、客观，并涉及有限元方法实现和稳定性的一个基本方面，即数值求积。问题是自洽的，提供了所有必要信息。诸如常数系数和仿射映射等假设是理论分析中常用的简化，它们不会使所测试的核心概念变得无足轻重。因此，该问题是有效的。\n\n### 步骤 3：结论与行动\n问题有效。将提供完整解答。\n\n解答按要求分为两部分。首先，我们确定精确计算 HDG 双线性形式所需的最小求积精确度。其次，我们分析欠积分对面临定化项的影响。\n\n为了确定求积法则所需的精确度，我们必须找出双线性形式中被积函数的最高多项式次数。问题假设网格是仿射的，这意味着从参考单元（或面）到物理单元（或面）的映射的雅可比行列式是常数。因此，参考坐标系中次数为 $p$ 的多项式映射到物理坐标系中次数为 $p$ 的多项式，而积分测度变换仅贡献一个常数因子。因此，我们只需分析每个积分中函数项乘积的次数。\n\n**第一部分：最小求积精确度**\n\n**单元 $K$ 上的体积积分：**\n体积积分涉及在单元 $K$ 上定义的函数的乘积。标量函数的空间是 $\\mathcal{P}^k(K)$，即总次数至多为 $k$ 的多项式空间。矢量函数的空间是 $[\\mathcal{P}^k(K)]^d$，其中每个分量都是总次数至多为 $k$ 的多项式。\n\n1.  项 $(\\kappa q_h, r_h)_K = \\int_K \\kappa q_h \\cdot r_h \\, dK$：\n    -   $q_h \\in [\\mathcal{P}^k(K)]^d$ 且 $r_h \\in [\\mathcal{P}^k(K)]^d$。\n    -   点积 $q_h \\cdot r_h$ 是次数至多为 $k$ 的多项式的乘积之和。每个乘积 $(q_h)_i (r_h)_i$ 都是一个次数至多为 $k+k=2k$ 的多项式。\n    -   由于 $\\kappa$ 在 $K$ 上是常数，被积函数 $\\kappa q_h \\cdot r_h$ 是一个次数至多为 $2k$ 的多项式。\n\n2.  项 $(\\nabla \\cdot q_h, v_h)_K = \\int_K (\\nabla \\cdot q_h) v_h \\, dK$：\n    -   对于 $q_h \\in [\\mathcal{P}^k(K)]^d$，其散度 $\\nabla \\cdot q_h$ 是其分量导数的和。次数为 $k$ 的多项式的导数是一个次数至多为 $k-1$ 的多项式。因此，$\\nabla \\cdot q_h \\in \\mathcal{P}^{k-1}(K)$。\n    -   $v_h \\in \\mathcal{P}^k(K)$。\n    -   被积函数 $(\\nabla \\cdot q_h) v_h$ 是一个次数至多为 $k-1$ 的多项式和一个次数至多为 $k$ 的多项式的乘积。其次数至多为 $(k-1)+k = 2k-1$。\n\n3.  项 $(u_h, \\nabla \\cdot r_h)_K = \\int_K u_h (\\nabla \\cdot r_h) \\, dK$：\n    -   $u_h \\in \\mathcal{P}^k(K)$。\n    -   对于 $r_h \\in [\\mathcal{P}^k(K)]^d$，其散度 $\\nabla \\cdot r_h \\in \\mathcal{P}^{k-1}(K)$。\n    -   被积函数 $u_h (\\nabla \\cdot r_h)$ 是一个次数至多为 $k$ 的多项式和一个次数至多为 $k-1$ 的多项式的乘积。其次数至多为 $k+(k-1) = 2k-1$。\n\n为了精确地积分所有体积项，求积法则必须对遇到的最高次数的多项式精确，即 $\\max(2k, 2k-1, 2k-1) = 2k$。\n因此，体积求积的最小多项式精确度为 $m_V(k) = 2k$。\n\n**边界 $\\partial K$ 上的面积分：**\n面积分是在单元 $K$ 的各个面 $F$ 上计算的。$\\mathcal{P}^k(K)$ 中多项式在平面 $F$ 上的迹是 $\\mathcal{P}^k(F)$ 中的多项式。\n\n1.  项 $\\langle \\hat{u}_h, r_h \\cdot n \\rangle_{\\partial K} = \\sum_{F \\subset \\partial K} \\int_F \\hat{u}_h (r_h \\cdot n) \\, dF$：\n    -   在一个面 $F$ 上，$\\hat{u}_h \\in \\mathcal{P}^k(F)$。\n    -   $r_h$ 在 $F$ 上的迹属于 $[\\mathcal{P}^k(F)]^d$。\n    -   对于仿射单纯形的每个面，法向量 $n$ 是常数。\n    -   项 $r_h \\cdot n$ 是 $r_h$ 分量的线性组合，因此其迹是 $\\mathcal{P}^k(F)$ 中的一个多项式。\n    -   被积函数 $\\hat{u}_h (r_h \\cdot n)$ 是两个次数至多为 $k$ 的多项式的乘积。其次数至多为 $k+k=2k$。\n\n2.  项 $\\langle \\tau (u_h - \\hat{u}_h), v_h - \\hat{v}_h \\rangle_{\\partial K} = \\sum_{F \\subset \\partial K} \\int_F \\tau (u_h - \\hat{u}_h)(v_h - \\hat{v}_h) \\, dF$：\n    -   在一个面 $F$ 上，迹 $u_h|_F \\in \\mathcal{P}^k(F)$ 且 $\\hat{u}_h \\in \\mathcal{P}^k(F)$。差 $(u_h - \\hat{u}_h)$ 是 $\\mathcal{P}^k(F)$ 中的一个多项式。\n    -   类似地，$(v_h - \\hat{v}_h)$ 是 $\\mathcal{P}^k(F)$ 中的一个多项式。\n    -   $\\tau$ 在 $F$ 上是常数。\n    -   被积函数 $\\tau (u_h - \\hat{u}_h)(v_h - \\hat{v}_h)$ 是两个次数至多为 $k$ 的多项式的乘积。其次数至多为 $k+k=2k$。\n\n为了精确地积分所有面积分项，求积法则必须对次数最高为 $2k$ 的多项式精确。\n因此，面求积的最小多项式精确度为 $m_F(k) = 2k$。\n\n**第二部分：面欠积分分析**\n\n我们现在分析面求积仅对次数至多为 $2k-1$ 的多项式精确的情形。我们关注稳定化项 $\\langle \\tau (u_h - \\hat{u}_h), v_h - \\hat{v}_h \\rangle_{\\partial K}$，它对于 HDG 方法的矫顽性至关重要。矫顽性通常通过选择 $v_h = u_h$、$r_h=q_h$ 和一个合适的检验迹函数 $\\hat{v}_h$ 来建立，从而在每个面 $F$ 上得到项 $\\int_F \\tau (u_h - \\hat{u}_h)^2 \\, dF$。令 $w_h(x) = u_h(x)|_F - \\hat{u}_h(x)$。由于 $u_h|_F \\in \\mathcal{P}^k(F)$ 和 $\\hat{u}_h \\in \\mathcal{P}^k(F)$，我们有 $w_h \\in \\mathcal{P}^k(F)$。矫顽性项的被积函数是 $\\tau(w_h)^2$，它是一个次数至多为 $2k$ 的多项式。\n\n一个精确计算的积分 $\\int_F \\tau (w_h)^2 \\, dF$ 对于任何非零的 $w_h \\in \\mathcal{P}^k(F)$ 都是严格为正的，因为 $\\tau > 0$。这确保了使稳定化项为零的唯一函数是零函数，这是稳定性的一个关键性质。\n\n现在考虑面 $F$ 上的一个求积法则 $I_F^{2k-1}$，它对次数至多为 $2k-1$ 的多项式是精确的。计算出的贡献是 $I_F^{2k-1}(\\tau (w_h)^2)$。标准的求积法则，如高斯型法则，使用一组求积点 $\\{\\xi_j\\}$ 和正权重 $\\{\\omega_j\\}$。计算出的积分为 $I_F^{2k-1}(\\tau (w_h)^2) = \\tau \\sum_j \\omega_j (w_h(\\xi_j))^2$。由于 $\\tau>0$ 和 $\\omega_j>0$，这个和为零当且仅当对于所有求积点 $\\xi_j$ 都有 $w_h(\\xi_j)=0$。\n\n问题是是否存在一个非平凡的 $w_h \\in \\mathcal{P}^k(F)$ 使得在某个对次数 $2k-1$ 精确的法则的所有求积点 $\\xi_j$ 上都有 $w_h(\\xi_j)=0$。一个对次数为 $2k-1$ 的多项式精确的求积法则可以用 $k$ 个点来构造（例如，对于一维面，使用 $k$ 点高斯-勒让德法则）。一个次数为 $k$ 的多项式并不能由其在 $k$ 个点上的值唯一确定。我们可以构造一个非零多项式 $p(x) \\in \\mathcal{P}^k(F)$，其根恰好是这 $k$ 个求积点，例如，对于某个非零常数 $c$，有 $p(x) = c \\prod_{j=1}^k (x - \\xi_j)$。对于这个 $w_h = p(x)$，计算出的稳定化项为 $I_F^{2k-1}(\\tau (w_h)^2) = 0$。然而，真实的积分是 $\\int_F \\tau (w_h)^2 \\, dF > 0$。\n\n因此，使用一个对次数 $2k-1$ 精确的法则进行欠积分，会使得离散稳定化项的核中存在非零函数，这会破坏矫顽性并可能使全局线性系统奇异。\n\n为了排除这种失效模式，求积法则必须保证对于所有非零的 $w_h \\in \\mathcal{P}^k(F)$，都有 $I_F(\\tau (w_h)^2) > 0$。如果求积法则能精确地积分项 $\\tau (w_h)^2$，则可以保证这一点。由于 $w_h \\in \\mathcal{P}^k(F)$，被积函数 $\\tau(w_h)^2$ 是一个次数至多为 $2k$ 的多项式。因此，排除此失效模式的 $m_F(k)$ 的多项式次数阈值为 $m_F(k) = 2k$。这证实了我们第一部分的发现。\n\n最终答案结合了要求精确积分的 $m_V(k)$ 和 $m_F(k)$ 的结果。\n$m_V(k) = 2k$\n$m_F(k) = 2k$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2k  2k\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "一个数值方法的稳定性通常取决于其公式中的微妙选择，例如有限元空间的选择。这个思想实验 () 将挑战您分析一个另类的HDG公式，其中单元内部的未知量与界面上的未知量采用了不匹配的多项式次数。通过识别“伪模式”（spurious mode）或非物理的解的存在，您将揭示为何审慎地选择多项式空间对于HDG方法的稳定性和可靠性至关重要。",
            "id": "3405305",
            "problem": "考虑具有齐次狄利克雷边界条件的标量泊松问题，\n$$\n-\\nabla \\cdot (\\kappa \\nabla u) = f \\quad \\text{in } \\Omega, \\qquad u = 0 \\quad \\text{on } \\partial \\Omega,\n$$\n其中扩散系数 $\\kappa > 0$ 为常数，定义在多边形域 $\\Omega \\subset \\mathbb{R}^2$ 上。设 $\\mathcal{T}_h$ 是将 $\\Omega$ 剖分为三角形的一致单纯网格。在每个单元 $K \\in \\mathcal{T}_h$ 上，定义局部可杂交间断伽辽金 (HDG) 未知量\n$$\n\\boldsymbol{q}_h \\in [\\mathbb{P}_k(K)]^2, \\qquad u_h \\in \\mathbb{P}_k(K),\n$$\n并在每个网格边 $E$ 上，定义骨架未知量（数值迹）\n$$\n\\hat{u}_h \\in \\mathbb{P}_{k-1}(E),\n$$\n其中 $k \\geq 1$。考虑每个单元 $K$ 上的标准 HDG 局部方程：\n- 对所有 $\\boldsymbol{r} \\in [\\mathbb{P}_k(K)]^2$，\n$$\n(\\kappa^{-1} \\boldsymbol{q}_h, \\boldsymbol{r})_K + (u_h, \\nabla \\cdot \\boldsymbol{r})_K - \\langle \\hat{u}_h, \\boldsymbol{r} \\cdot \\boldsymbol{n} \\rangle_{\\partial K} = 0,\n$$\n- 对所有 $v \\in \\mathbb{P}_k(K)$，\n$$\n-(\\boldsymbol{q}_h, \\nabla v)_K + \\langle \\widehat{\\boldsymbol{q}}_h \\cdot \\boldsymbol{n}, v \\rangle_{\\partial K} = (f, v)_K,\n$$\n其中数值通量为\n$$\n\\widehat{\\boldsymbol{q}}_h \\cdot \\boldsymbol{n} \\;=\\; \\boldsymbol{q}_h \\cdot \\boldsymbol{n} \\;+\\; \\tau \\big(u_h - \\hat{u}_h\\big)\\quad \\text{on } \\partial K,\n$$\n其中 $\\tau > 0$ 是每条边上的常数稳定化参数，$\\boldsymbol{n}$ 是 $\\partial K$ 上的单位外法向量。\n\n全局 HDG 系统（凝聚骨架系统）在每个内部边 $E$ 上以弱形式强制通量连续性：对所有 $\\mu \\in \\mathbb{P}_{k-1}(E)$，\n$$\n\\sum_{K: E \\subset \\partial K} \\langle \\widehat{\\boldsymbol{q}}_h \\cdot \\boldsymbol{n}_K, \\mu \\rangle_{E} = 0,\n$$\n并通过在边界边上设置 $\\hat{u}_h = 0$ 来强加齐次狄利克雷边界条件。\n\n现在，特化到网格 $\\mathcal{T}_h$，该网格由恰好两个三角形组成，这两个三角形构成一个由其对角线分割的平行四边形，因此恰好有一条内部边 $E_{\\mathrm{int}}$ 和四条边界边。假设在边界边上 $f \\equiv 0$ 且 $\\hat{u}_h \\equiv 0$。使用上述 HDG 格式，其中单元空间是 $k$ 次的，但骨架空间是 $k-1$ 次的。\n\n通过考虑单一内部边 $E_{\\mathrm{int}}$ 上的凝聚全局系统，确定其零空间的维数（即，在 $E_{\\mathrm{int}}$ 上，能在全局方程中产生零残差的线性无关的非平凡骨架向量的数量）。你的答案必须是一个实数。不需要四舍五入。",
            "solution": "问题要求的是针对泊松方程的特定可杂交间断伽辽金 (HDG) 格式，其全局凝聚系统的零空间的维数。该系统是在一个由两个三角形组成的网格上考虑的，具有零强迫项和齐次狄利克雷边界条件。\n\n首先，让我们形式化地描述寻找零空间的问题。我们要求的是，在给定 $f=0$ 且迹 $\\hat{u}_h$ 在所有边界边上为零的条件下，在内部边上定义的、能使全局系统右端项为零的非平凡骨架函数 $\\hat{u}_h$ 空间维数。\n\n区域 $\\Omega$ 是一个剖分成两个三角形 $K_1$ 和 $K_2$ 的平行四边形。这两个三角形共享一条公共边，即网格的唯一内部边，记为 $E_{\\mathrm{int}}$。剩下的四条边构成了区域的边界 $\\partial\\Omega$。\n\nHDG 方法的未知量是：\n1. 在每个单元 $K \\in \\{K_1, K_2\\}$ 上：标量函数 $u_h \\in \\mathbb{P}_k(K)$ 和向量场 $\\boldsymbol{q}_h \\in [\\mathbb{P}_k(K)]^2$，多项式次数为 $k \\geq 1$。\n2. 在内部边 $E_{\\mathrm{int}}$ 上：数值迹 $\\hat{u}_{\\mathrm{int}} \\in \\mathbb{P}_{k-1}(E_{\\mathrm{int}})$。\n在边界边上，通过设置 $\\hat{u}_h = 0$ 来强加齐次狄利克雷条件。\n\n全局系统是通过首先在每个单元 $K$ 上求解局部未知量 $(u_h, \\boldsymbol{q}_h)$（用其边界 $\\partial K$ 上定义的骨架未知量 $\\hat{u}_h$ 表示）来导出的。然后，将这些局部解代入通量连续性条件，得到一个仅含骨架自由度的系统。\n\n全局系统以弱形式强制内部边上的通量连续性。对于单一内部边 $E_{\\mathrm{int}}$ 及其相邻单元 $K_1$ 和 $K_2$，该条件由下式给出：\n$$\n\\langle \\widehat{\\boldsymbol{q}}_{h,1} \\cdot \\boldsymbol{n}_1, \\mu \\rangle_{E_{\\mathrm{int}}} + \\langle \\widehat{\\boldsymbol{q}}_{h,2} \\cdot \\boldsymbol{n}_2, \\mu \\rangle_{E_{\\mathrm{int}}} = 0, \\quad \\forall \\mu \\in \\mathbb{P}_{k-1}(E_{\\mathrm{int}}).\n$$\n这里，$\\widehat{\\boldsymbol{q}}_{h,i}$ 是与单元 $K_i$ 相关的数值通量，$\\boldsymbol{n}_i$ 是指向 $\\partial K_i$ 外部的单位法向量。在共享边 $E_{\\mathrm{int}}$ 上，法向量方向相反，即 $\\boldsymbol{n}_1 = -\\boldsymbol{n}_2$。我们记 $\\boldsymbol{n}_{\\mathrm{int}} = \\boldsymbol{n}_1$。方程变为：\n$$\n\\langle \\widehat{\\boldsymbol{q}}_{h,1} \\cdot \\boldsymbol{n}_{\\mathrm{int}} - \\widehat{\\boldsymbol{q}}_{h,2} \\cdot \\boldsymbol{n}_{\\mathrm{int}}, \\mu \\rangle_{E_{\\mathrm{int}}} = 0, \\quad \\forall \\mu \\in \\mathbb{P}_{k-1}(E_{\\mathrm{int}}).\n$$\n单元 $K$ 的边上的数值通量定义为：\n$$\n\\widehat{\\boldsymbol{q}}_h \\cdot \\boldsymbol{n} = \\boldsymbol{q}_h \\cdot \\boldsymbol{n} + \\tau (u_h - \\hat{u}_h),\n$$\n其中 $\\tau > 0$ 是一个稳定化参数。\n\n分析这个问题的关键在于多项式空间的选择。单元未知量 $u_h$ 和 $\\boldsymbol{q}_h$ 位于 $k$ 次空间中，而骨架未知量 $\\hat{u}_h$ 位于 $k-1$ 次空间中。这种特定的选择，通常表示为 $\\mathbb{P}_k - \\mathbb{P}_{k-1}$ 方法，是 HDG 方法的一个著名变体。虽然解决此问题的标准、稳定的 HDG 方法对所有未知量都使用相同的多项式次数 $k$（即 $\\mathbb{P}_k - \\mathbb{P}_k$ 方法），但 $\\mathbb{P}_k - \\mathbb{P}_{k-1}$ 格式是已知不稳定的。\n\n让我们分析为通量连续性方程选择测试空间的后果。在边 $E_{\\mathrm{int}}$ 上，局部解 $u_{h,i}$ 和 $\\boldsymbol{q}_{h,i}$ 是次数最高为 $k$ 的多项式。因此，数值通量 $\\widehat{\\boldsymbol{q}}_{h,i} \\cdot \\boldsymbol{n}_i$ 也是次数最多为 $k$ 的多项式。设 $J_q = \\widehat{\\boldsymbol{q}}_{h,1} \\cdot \\boldsymbol{n}_1 + \\widehat{\\boldsymbol{q}}_{h,2} \\cdot \\boldsymbol{n}_2$ 是跨越 $E_{\\mathrm{int}}$ 的数值通量跳跃。$J_q$ 是在 $E_{\\mathrm{int}}$ 上次数最多为 $k$ 的多项式，即 $J_q \\in \\mathbb{P}_k(E_{\\mathrm{int}})$。\n\n全局方程要求 $J_q$ 与 $\\mathbb{P}_{k-1}(E_{\\mathrm{int}})$ 中的每个多项式 $L^2$-正交。\n$$\n\\langle J_q, \\mu \\rangle_{E_{\\mathrm{int}}} = 0, \\quad \\forall \\mu \\in \\mathbb{P}_{k-1}(E_{\\mathrm{int}}).\n$$\n这个条件并不强制 $J_q$ 为零。相反，它只强制 $J_q$ 在 $\\mathbb{P}_{k-1}(E_{\\mathrm{int}})$ 上的投影为零。$J_q$ 可以是 $\\mathbb{P}_k(E_{\\mathrm{int}})$ 空间内 $\\mathbb{P}_{k-1}(E_{\\mathrm{int}})$ 的正交补中的任何非零多项式。\n\n让我们考虑这些空间在一维区间（如 $E_{\\mathrm{int}}$）上的维数。$\\mathbb{P}_k(E_{\\mathrm{int}})$ 的维数是 $k+1$，$\\mathbb{P}_{k-1}(E_{\\mathrm{int}})$ 的维数是 $k$。因此，$\\mathbb{P}_k(E_{\\mathrm{int}})$ 中 $(\\mathbb{P}_{k-1}(E_{\\mathrm{int}}))^{\\perp}$ 这个正交补空间的维数是 $(k+1) - k = 1$。\n\n这个一维空间由单个函数张成，该函数可选为 $k$ 次勒让德多项式，并经过适当缩放和平移以适应边 $E_{\\mathrm{int}}$。我们用 $L_k^{E_{\\mathrm{int}}}$ 表示这个多项式。\n\n零空间中的一个非平凡解对应于找到一个非零的骨架函数 $\\hat{u}_{\\mathrm{int}} \\in \\mathbb{P}_{k-1}(E_{\\mathrm{int}})$（它定义了相应的局部解 $(u_{h,1}, \\boldsymbol{q}_{h,1})$ 和 $(u_{h,2}, \\boldsymbol{q}_{h,2})$），使得产生的通量跳跃是这个特殊多项式的非零倍数：\n$$\nJ_q = c \\cdot L_k^{E_{\\mathrm{int}}} \\quad \\text{for some constant } c \\neq 0.\n$$\n对于每个内部边，存在这样一个“伪模式”，是这种 HDG 空间选择下的一个已知结果。对于一般网格中的每个内部边，可以构造一个非平凡的骨架函数 $\\hat{u}_h$（局部支持于该边周围），它产生的通量跳跃与该边上的最高阶勒让德多项式成正比，从而满足零问题（$f=0$）的全局方程。这些模式是线性无关的。\n\n因此，全局凝聚系统的零空间维数等于网格中内部边的数量。\n\n在给定的具体问题中，网格由两个构成平行四边形的三角形组成。它们恰好共享一个内部边 $E_{\\mathrm{int}}$。内部边的数量为 $1$。\n\n因此，这个单一内部边上的凝聚全局系统的零空间维数为 $1$。这对应于一个单一的、非物理的伪模式，该离散化因多项式空间的特定选择而容许此模式的存在。",
            "answer": "$$\n\\boxed{1}\n$$"
        }
    ]
}