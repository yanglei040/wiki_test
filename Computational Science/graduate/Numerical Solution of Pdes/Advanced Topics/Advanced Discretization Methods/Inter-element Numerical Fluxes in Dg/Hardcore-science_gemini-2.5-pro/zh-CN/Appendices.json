{
    "hands_on_practices": [
        {
            "introduction": "在间断有限元（DG）方法中，数值通量是连接不连续单元的基石，它促进了单元之间的信息交换。本练习将提供一个直接的动手实践，计算一种最常见的数值通量——Rusanov（或局部Lax-Friedrichs）通量。通过从给定的多项式系数出发，逐步计算出最终的通量值，您将巩固对如何使用抽象的解表示来计算这一关键界面项的理解。",
            "id": "3409742",
            "problem": "考虑在区域 $[-1,1]$ 上的标量守恒律 $u_{t} + f(u)_{x} = 0$，其中 $f(u) = u + \\frac{u^{3}}{3}$。在两个单元 $E_{L} = [-1,0]$ 和 $E_{R} = [0,1]$ 上应用间断Galerkin (DG) 方法，在参考区间 $[-1,1]$ 上使用基于Legendre基的2次多项式展开。从每个物理单元到参考坐标 $\\xi \\in [-1,1]$ 的仿射映射将交界面位置 $x=0$ 映射到 $E_{L}$ 的 $\\xi = +1$ 和 $E_{R}$ 的 $\\xi = -1$。在每个单元上，近似解表示为\n$$\nu_{L}(\\xi) = \\alpha_{0} P_{0}(\\xi) + \\alpha_{1} P_{1}(\\xi) + \\alpha_{2} P_{2}(\\xi), \\quad u_{R}(\\xi) = \\beta_{0} P_{0}(\\xi) + \\beta_{1} P_{1}(\\xi) + \\beta_{2} P_{2}(\\xi),\n$$\n其中 $P_{0}(\\xi) = 1$，$P_{1}(\\xi) = \\xi$ 和 $P_{2}(\\xi) = \\frac{1}{2}(3\\xi^{2} - 1)$ 是前三个Legendre多项式，且系数为\n$$\n\\alpha_{0} = \\frac{1}{2}, \\quad \\alpha_{1} = -\\frac{3}{4}, \\quad \\alpha_{2} = \\frac{2}{3}, \\qquad \\beta_{0} = \\frac{2}{5}, \\quad \\beta_{1} = \\frac{7}{8}, \\quad \\beta_{2} = -\\frac{1}{3}.\n$$\n在交界面 $x=0$ 处，设内部迹为来自 $E_{L}$ 的 $u^{-} = \\lim_{x \\to 0^{-}} u(x)$ 和来自 $E_{R}$ 的 $u^{+} = \\lim_{x \\to 0^{+}} u(x)$。使用一个相容的单调数值通量，该通量由守恒律在交界面处的局部线性化导出，并将耗散参数取为跨交界面的最大绝对特征速度 $\\lambda = \\max\\{\\,|f'(u^{-})|,\\,|f'(u^{+})|\\,\\}$，计算 $x=0$ 处的单元间数值通量。将最终答案表示为单个最简有理数。无需四舍五入。",
            "solution": "首先验证问题以确保其自洽、有科学依据且适定。\n\n### 步骤 1：提取已知条件\n-   **守恒律**：$u_{t} + f(u)_{x} = 0$ 在区域 $[-1,1]$ 上。\n-   **通量函数**：$f(u) = u + \\frac{u^{3}}{3}$。\n-   **离散化**：两个单元，$E_{L} = [-1,0]$ 和 $E_{R} = [0,1]$。\n-   **近似空间**：基于Legendre基的2次多项式。\n-   **参考映射**：交界面 $x=0$ 映射到 $E_{L}$ 的 $\\xi = +1$ 和 $E_{R}$ 的 $\\xi = -1$。\n-   **基函数**：$P_{0}(\\xi) = 1$，$P_{1}(\\xi) = \\xi$，$P_{2}(\\xi) = \\frac{1}{2}(3\\xi^{2} - 1)$。\n-   **解的表示**：\n    -   在 $E_{L}$ 上：$u_{L}(\\xi) = \\alpha_{0} P_{0}(\\xi) + \\alpha_{1} P_{1}(\\xi) + \\alpha_{2} P_{2}(\\xi)$，系数为 $\\alpha_{0} = \\frac{1}{2}$，$\\alpha_{1} = -\\frac{3}{4}$，$\\alpha_{2} = \\frac{2}{3}$。\n    -   在 $E_{R}$ 上：$u_{R}(\\xi) = \\beta_{0} P_{0}(\\xi) + \\beta_{1} P_{1}(\\xi) + \\beta_{2} P_{2}(\\xi)$，系数为 $\\beta_{0} = \\frac{2}{5}$，$\\beta_{1} = \\frac{7}{8}$，$\\beta_{2} = -\\frac{1}{3}$。\n-   **交界面迹**：$u^{-} = \\lim_{x \\to 0^{-}} u(x)$ 和 $u^{+} = \\lim_{x \\to 0^{+}} u(x)$。\n-   **数值通量**：将使用一种相容的单调通量（局部Lax-Friedrichs类型），其形式为 $\\hat{f}(u^{-}, u^{+}) = \\frac{1}{2}\\left[f(u^{-}) + f(u^{+}) - \\lambda(u^{+} - u^{-})\\right]$。\n-   **耗散参数**：$\\lambda = \\max\\{\\,|f'(u^{-})|,\\,|f'(u^{+})|\\,\\}$。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题是使用间断Galerkin方法求解偏微分方程的一个标准练习。它提供了所有必要的组成部分：控制方程、离散化设置、基函数、定义解状态的系数，以及待计算数值通量的精确公式。该问题具有科学依据、适定、客观，且不含矛盾或歧义。\n\n### 步骤 3：结论与行动\n问题是有效的。将提供完整解答。\n\n### 解答\n任务是计算交界面 $x=0$ 处的单元间数值通量 $\\hat{f}$。指定的通量是局部Lax-Friedrichs（或Rusanov）通量，由下式给出：\n$$\n\\hat{f}(u^{-}, u^{+}) = \\frac{1}{2} \\left[ f(u^{-}) + f(u^{+}) - \\lambda (u^{+} - u^{-}) \\right]\n$$\n其中 $\\lambda = \\max\\{|f'(u^{-})|, |f'(u^{+})|\\}$。解答过程分为四个步骤。\n\n**1. 计算迹值 $u^{-}$ 和 $u^{+}$。**\n\n左迹值 $u^{-}$ 是解从单元 $E_{L}$ 在 $x \\to 0^{-}$ 时的极限。这对应于计算 $u_{L}(\\xi)$ 在 $\\xi = +1$ 处的值。Legendre多项式在 $\\xi = 1$ 处的值为：\n$P_{0}(1) = 1$\n$P_{1}(1) = 1$\n$P_{2}(1) = \\frac{1}{2}(3(1)^{2} - 1) = 1$\n\n因此，$u^{-}$ 为：\n$$\nu^{-} = u_{L}(1) = \\alpha_{0}P_{0}(1) + \\alpha_{1}P_{1}(1) + \\alpha_{2}P_{2}(1) = \\alpha_{0} + \\alpha_{1} + \\alpha_{2}\n$$\n代入给定的系数：\n$$\nu^{-} = \\frac{1}{2} - \\frac{3}{4} + \\frac{2}{3} = \\frac{6}{12} - \\frac{9}{12} + \\frac{8}{12} = \\frac{5}{12}\n$$\n\n右迹值 $u^{+}$ 是解从单元 $E_{R}$ 在 $x \\to 0^{+}$ 时的极限，对应于计算 $u_{R}(\\xi)$ 在 $\\xi = -1$ 处的值。Legendre多项式在 $\\xi = -1$ 处的值为：\n$P_{0}(-1) = 1$\n$P_{1}(-1) = -1$\n$P_{2}(-1) = \\frac{1}{2}(3(-1)^{2} - 1) = 1$\n\n因此，$u^{+}$ 为：\n$$\nu^{+} = u_{R}(-1) = \\beta_{0}P_{0}(-1) + \\beta_{1}P_{1}(-1) + \\beta_{2}P_{2}(-1) = \\beta_{0} - \\beta_{1} + \\beta_{2}\n$$\n代入给定的系数：\n$$\nu^{+} = \\frac{2}{5} - \\frac{7}{8} - \\frac{1}{3} = \\frac{48}{120} - \\frac{105}{120} - \\frac{40}{120} = \\frac{48 - 105 - 40}{120} = -\\frac{97}{120}\n$$\n\n**2. 计算特征速度和耗散参数 $\\lambda$。**\n\n特征速度由通量函数的导数 $f'(u)$ 给出。\n$$\nf(u) = u + \\frac{u^{3}}{3} \\implies f'(u) = 1 + u^{2}\n$$\n由于 $u^{2} \\ge 0$，$f'(u) = 1+u^{2}$ 恒为正，所以 $|f'(u)| = f'(u)$。我们计算其在 $u^{-}$ 和 $u^{+}$ 处的值：\n$$\nf'(u^{-}) = 1 + (u^{-})^{2} = 1 + \\left(\\frac{5}{12}\\right)^{2} = 1 + \\frac{25}{144} = \\frac{144+25}{144} = \\frac{169}{144}\n$$\n$$\nf'(u^{+}) = 1 + (u^{+})^{2} = 1 + \\left(-\\frac{97}{120}\\right)^{2} = 1 + \\frac{9409}{14400} = \\frac{14400+9409}{14400} = \\frac{23809}{14400}\n$$\n为了比较这些值，我们使用公分母：\n$$\nf'(u^{-}) = \\frac{169 \\times 100}{144 \\times 100} = \\frac{16900}{14400}\n$$\n由于 $23809  16900$，我们有 $f'(u^{+})  f'(u^{-})$。因此耗散参数为：\n$$\n\\lambda = \\max\\{f'(u^{-}), f'(u^{+})\\} = f'(u^{+}) = \\frac{23809}{14400}\n$$\n\n**3. 计算数值通量的各项。**\n\n我们需要 $f(u^{-})$、$f(u^{+})$ 以及耗散项 $\\lambda(u^{+}-u^{-})$。\n$$\nf(u^{-}) = u^{-} + \\frac{(u^{-})^{3}}{3} = \\frac{5}{12} + \\frac{1}{3}\\left(\\frac{5}{12}\\right)^{3} = \\frac{5}{12} + \\frac{125}{3 \\cdot 1728} = \\frac{5}{12} + \\frac{125}{5184} = \\frac{5 \\cdot 432 + 125}{5184} = \\frac{2160+125}{5184} = \\frac{2285}{5184}\n$$\n$$\nf(u^{+}) = u^{+} + \\frac{(u^{+})^{3}}{3} = -\\frac{97}{120} + \\frac{1}{3}\\left(-\\frac{97}{120}\\right)^{3} = -\\frac{97}{120} - \\frac{912673}{3 \\cdot 1728000} = -\\frac{97}{120} - \\frac{912673}{5184000}\n$$\n为了合并它们，我们找到一个公分母：\n$$\nf(u^{+}) = -\\frac{97 \\cdot 43200}{5184000} - \\frac{912673}{5184000} = \\frac{-4190400 - 912673}{5184000} = -\\frac{5103073}{5184000}\n$$\n接下来，我们计算 $u$ 的跳跃：\n$$\nu^{+} - u^{-} = -\\frac{97}{120} - \\frac{5}{12} = -\\frac{97}{120} - \\frac{50}{120} = -\\frac{147}{120} = -\\frac{49}{40}\n$$\n耗散项为：\n$$\n\\lambda(u^{+} - u^{-}) = \\frac{23809}{14400} \\cdot \\left(-\\frac{49}{40}\\right) = -\\frac{23809 \\cdot 49}{14400 \\cdot 40} = -\\frac{1166641}{576000}\n$$\n\n**4. 组装数值通量并化简。**\n\n现在将这些分量代入通量公式：\n$$\n\\hat{f} = \\frac{1}{2} \\left[ \\frac{2285}{5184} - \\frac{5103073}{5184000} - \\left(-\\frac{1166641}{576000}\\right) \\right]\n$$\n括号内分数的公分母是 $5184000$。注意 $5184000 = 5184 \\times 1000$ 且 $5184000 = 576000 \\times 9$。\n$$\n\\hat{f} = \\frac{1}{2} \\left[ \\frac{2285 \\cdot 1000}{5184000} - \\frac{5103073}{5184000} + \\frac{1166641 \\cdot 9}{5184000} \\right]\n$$\n$$\n\\hat{f} = \\frac{1}{2 \\cdot 5184000} \\left[ 2285000 - 5103073 + 10499769 \\right]\n$$\n$$\n\\hat{f} = \\frac{1}{10368000} \\left[ 12784769 - 5103073 \\right] = \\frac{7681696}{10368000}\n$$\n为了化简这个分数，我们可以用公因数约分分子和分母。两者都能被 $32$ 整除：\n$$\n\\hat{f} = \\frac{7681696 \\div 32}{10368000 \\div 32} = \\frac{240053}{324000}\n$$\n分母的质因数是 $2$、$3$ 和 $5$。分子 $240053$ 不能被 $2$ 整除（因为是奇数），不能被 $3$ 整除（因为数字之和是 $14$），也不能被 $5$ 整除（因为末位不是 $0$ 或 $5$）。因此，该分数已是最简形式。",
            "answer": "$$\n\\boxed{\\frac{240053}{324000}}\n$$"
        },
        {
            "introduction": "在学习了如何计算数值通量之后，一个自然的问题是：什么才是一个“好”的数值通量？本练习将探讨一个基本性质——*相容性*，它确保在解是光滑的情况下，数值通量能正确地再现物理通量。通过一个精心构建的反例，您将研究当这一性质被破坏时会发生什么，并发现一个不相容的通量如何连最简单的精确解都无法保持，从而有力地说明了为什么相容性是任何数值格式设计的关键原则。",
            "id": "3409743",
            "problem": "考虑一维线性平流偏微分方程 (PDE) $u_{t} + a\\,u_{x} = 0$，定义在区域 $[0,1]$上，并具有周期性边界条件。将该区域离散为两个均匀单元 $I_{1} = [0,\\tfrac{1}{2}]$ 和 $I_{2} = [\\tfrac{1}{2},1]$，每个单元的长度为 $h = \\tfrac{1}{2}$。使用多项式次数为 $p=0$（分段常数试探函数和检验函数）的不连续伽辽金 (Discontinuous Galerkin, DG) 方法。\n\n在界面处，定义单元间的数值通量，其左迹为 $u^{-}$，右迹为 $u^{+}$，单元外法向单位向量为 $n$（指向正在组装方程的单元的外部），其表达式为\n$$\n\\widehat{f}(u^{-},u^{+},n) = a\\,\\frac{u^{-} + u^{+}}{2} + \\beta\\,n,\n$$\n其中 $a$ 和 $\\beta$ 是给定常数。该偏微分方程的物理通量为 $f(u) = a\\,u$。如果对于所有的 $u$ 和所有的界面，都有 $\\widehat{f}(u,u,n) = f(u)$，则称数值通量是一致的。\n\n任务：\n1. 从偏微分方程的局部守恒形式和单个单元上的 DG 弱形式出发，写出当 $p=0$ 并使用常数检验函数时，单元平均解的半离散 DG 方程。\n2. 证明上述 $\\widehat{f}$ 的选择违反了与物理通量的一致性。\n3. 对于常数解 $u(x,t) \\equiv c$，在两个单元上分别计算半离散 DG 方程，并用 $a$、$\\beta$ 和 $h$ 表示所得的单元平均解 $u_{j}(t)$ 的时间导数。\n4. 使用 $a = 3$，$\\beta = 1$， $h = \\tfrac{1}{2}$ 以及任意常数 $c$，计算该通量产生的单元平均解时间导数 $u_{j}'(t)$ 的数值。将最终数值答案表示为一个无单位的纯数字。无需四舍五入。",
            "solution": "该问题提法恰当且科学上合理，是不连续伽辽金 (DG) 方法数值分析课程中的一个标准练习。它考察了对 DG 公式、数值通量一致性概念以及违反此性质的后果的理解。\n\n### 任务 1：半离散 DG 方程\n\n我们从守恒形式的一维线性平流方程开始：\n$$\n\\frac{\\partial u}{\\partial t} + \\frac{\\partial f(u)}{\\partial x} = 0\n$$\n其中物理通量为 $f(u) = a\\,u$。区域 $[0,1]$ 被离散化为单元 $I_j$。通过将 PDE 乘以一个检验函数 $v(x)$ 并在一个单元 $I_j = [x_{j-1/2}, x_{j+1/2}]$ 上积分，可以得到 DG 弱形式：\n$$\n\\int_{I_j} \\frac{\\partial u}{\\partial t} v \\,dx + \\int_{I_j} \\frac{\\partial f(u)}{\\partial x} v \\,dx = 0\n$$\n对于多项式次数 $p=0$，解 $u(x,t)$ 在每个单元 $I_j$ 上被近似为一个分段常数函数，$u_h(x,t) = u_j(t)$ (对于 $x \\in I_j$)。我们在 $I_j$ 上使用常数检验函数 $v(x)=1$。\n\n弱形式中的第一项变为：\n$$\n\\int_{I_j} \\frac{\\partial u_j(t)}{\\partial t} (1) \\,dx = \\frac{du_j}{dt} \\int_{I_j} dx = h \\frac{du_j}{dt}\n$$\n其中 $h$ 是单元的长度。\n\n第二项通过分部积分法处理：\n$$\n\\int_{I_j} \\frac{\\partial f(u)}{\\partial x} v \\,dx = \\left[ f(u) v \\right]_{x_{j-1/2}}^{x_{j+1/2}} - \\int_{I_j} f(u) \\frac{\\partial v}{\\partial x} \\,dx\n$$\n由于检验函数 $v$ 是常数（$v=1$），其导数 $\\frac{\\partial v}{\\partial x}$ 为 $0$，因此右侧的积分消失。该项简化为在单元边界上的通量求值：\n$$\n\\left[ f(u) v \\right]_{x_{j-1/2}}^{x_{j+1/2}} = f(u(x_{j+1/2},t)) - f(u(x_{j-1/2},t))\n$$\n由于解 $u_h$ 在单元界面处是不连续的，通量 $f(u)$ 没有唯一定义。我们用数值通量 $\\widehat{f}$ 来代替它，该通量取决于界面左侧（$u^-$）和右侧（$u^+$）的状态解值，以及单元边界的外法向单位向量 $n$。\n\n在单元 $I_j$ 的右边界 $x=x_{j+1/2}$ 处，外法向为 $n=+1$。左侧状态为 $u^- = u_j(t)$，右侧状态为 $u^+ = u_{j+1}(t)$。此处的通量项为 $\\widehat{f}(u_j, u_{j+1}, +1)$。\n在单元 $I_j$ 的左边界 $x=x_{j-1/2}$ 处，外法向为 $n=-1$。左侧状态为 $u^- = u_{j-1}(t)$，右侧状态为 $u^+ = u_j(t)$。此处的通量项为 $\\widehat{f}(u_{j-1}, u_j, -1)$。\n\n将这些代入分部积分后的表达式中，边界项变为：\n$$\n\\widehat{f}(u_j, u_{j+1}, +1) - \\widehat{f}(u_{j-1}, u_j, -1)\n$$\n合并各项，单元平均解 $u_j$ 的半离散 DG 方程为：\n$$\nh \\frac{du_j}{dt} + \\widehat{f}(u_j, u_{j+1}, +1) - \\widehat{f}(u_{j-1}, u_j, -1) = 0\n$$\n\n### 任务 2：违反一致性\n\n如果对于任何状态 $u$，数值通量 $\\widehat{f}(u^-, u^+, n)$ 满足 $\\widehat{f}(u,u,n) = f(u)$，则称其与物理通量 $f(u)$ 是一致的。\n给定的物理通量是 $f(u) = a\\,u$。给定的数值通量是 $\\widehat{f}(u^-, u^+, n) = a\\,\\frac{u^- + u^+}{2} + \\beta\\,n$。\n为检验一致性，我们令 $u^- = u$ 和 $u^+ = u$：\n$$\n\\widehat{f}(u, u, n) = a\\,\\frac{u + u}{2} + \\beta\\,n = a\\,\\frac{2u}{2} + \\beta\\,n = a\\,u + \\beta\\,n\n$$\n为满足一致性，该表达式必须等于 $f(u) = a\\,u$。\n$$\na\\,u + \\beta\\,n = a\\,u\n$$\n该等式成立当且仅当 $\\beta\\,n = 0$。由于界面处的法向量 $n$ 为 $+1$ 或 $-1$，这意味着只有当 $\\beta=0$ 时才能实现一致性。由于 $\\beta$ 是一个可以为非零的给定常数（例如，在任务 4 中 $\\beta=1$），所以数值通量 $\\widehat{f}$ 通常与物理通量 $f(u)$ 不一致。\n\n### 任务 3：对常数解进行求值\n\n我们考虑一个常数解 $u(x,t) \\equiv c$。对于 $p=0$ 的离散化，这意味着两个单元中每个单元的平均解都是 $u_1(t) = c$ 和 $u_2(t) = c$。我们想求出 $j=1,2$ 时的时间导数 $\\frac{du_j}{dt}$。\n\n我们有两个单元 $I_1 = [0, \\frac{1}{2}]$ 和 $I_2 = [\\frac{1}{2}, 1]$，并带有周期性边界条件。相邻单元为 $u_0 = u_2$ 和 $u_3 = u_1$。\n\n对于单元 $I_1$ ($j=1$)：\n半离散方程为 $h \\frac{du_1}{dt} + \\widehat{f}(u_1, u_2, +1) - \\widehat{f}(u_0, u_1, -1) = 0$。利用周期性，$u_0=u_2$，方程变为：\n$$\nh \\frac{du_1}{dt} + \\widehat{f}(u_1, u_2, +1) - \\widehat{f}(u_2, u_1, -1) = 0\n$$\n代入 $u_1 = c$ 和 $u_2 = c$：\n$$\nh \\frac{du_1}{dt} + \\widehat{f}(c, c, +1) - \\widehat{f}(c, c, -1) = 0\n$$\n从任务 2 可知，$\\widehat{f}(u, u, n) = a\\,u + \\beta\\,n$。因此，当 $u=c$ 时：\n$\\widehat{f}(c, c, +1) = a\\,c + \\beta(+1) = a\\,c + \\beta$。\n$\\widehat{f}(c, c, -1) = a\\,c + \\beta(-1) = a\\,c - \\beta$。\n\n将这些代入 $u_1$ 的方程中：\n$$\nh \\frac{du_1}{dt} + (a\\,c + \\beta) - (a\\,c - \\beta) = 0\n$$\n$$\nh \\frac{du_1}{dt} + a\\,c + \\beta - a\\,c + \\beta = 0\n$$\n$$\nh \\frac{du_1}{dt} + 2\\beta = 0\n$$\n$$\n\\frac{du_1}{dt} = -\\frac{2\\beta}{h}\n$$\n对于单元 $I_2$ ($j=2$)：\n半离散方程为 $h \\frac{du_2}{dt} + \\widehat{f}(u_2, u_3, +1) - \\widehat{f}(u_1, u_2, -1) = 0$。利用周期性，$u_3=u_1$：\n$$\nh \\frac{du_2}{dt} + \\widehat{f}(u_2, u_1, +1) - \\widehat{f}(u_1, u_2, -1) = 0\n$$\n代入 $u_1 = c$ 和 $u_2 = c$：\n$$\nh \\frac{du_2}{dt} + \\widehat{f}(c, c, +1) - \\widehat{f}(c, c, -1) = 0\n$$\n这与 $u_1$ 的方程相同，得到相同的结果：\n$$\n\\frac{du_2}{dt} = -\\frac{2\\beta}{h}\n$$\n因此，对于任何单元 $j$，单元平均解的时间导数为 $\\frac{du_j}{dt} = -\\frac{2\\beta}{h}$。一个一致的格式会产生 $\\frac{du_j}{dt}=0$，从而保持常数状态。这个非零结果是通量不一致的直接后果。\n\n### 任务 4：数值计算\n\n我们被要求使用给定的常数 $a=3$, $\\beta=1$ 和 $h=\\frac{1}{2}$ 来计算 $\\frac{du_j}{dt}$ 的数值。常数 $c$ 的值与此无关，$a$ 的值也一样。\n使用任务 3 中导出的公式：\n$$\n\\frac{du_j}{dt} = -\\frac{2\\beta}{h}\n$$\n代入数值：\n$$\n\\frac{du_j}{dt} = -\\frac{2(1)}{\\frac{1}{2}} = -\\frac{2}{0.5} = -4\n$$\n单元平均解时间导数的数值为 $-4$。",
            "answer": "$$\n\\boxed{-4}\n$$"
        },
        {
            "introduction": "在实际应用中，存在多种数值通量可供选择，每种通量都在准确性、复杂性和耗散性之间有不同的权衡。本练习将从单个通量的计算，拓展到对不同重要通量类型的实际比较：简单而稳健的Rusanov通量，以及更准确但更复杂的Godunov通量（其基于求解局部黎曼问题）。通过在编程环境中实现这两种通量，并将其应用于多项式解的迹，您将深入了解通量选择中涉及的权衡，并体会到在DG方法中近似黎曼求解器和精确黎曼求解器之间的实际差异。",
            "id": "3409747",
            "problem": "考虑一维空间中标量守恒律，其守恒形式写作 $u_t + \\partial_x f(u) = 0$，其中 $u = u(x,t)$ 且 $f$ 是一个足够光滑的通量函数。在间断伽辽金 (DG) 方法中，单元间的耦合仅通过单元面上的数值通量出现。设单元面由局部坐标 $\\xi \\in [-1,1]$ 参数化，单位法向量从左侧单元指向右侧单元。DG 解在单元面上的多项式迹为来自左侧的 $u^-(\\xi)$ 和来自右侧的 $u^+(\\xi)$。您将构建一个使用这些跨单元面的多项式重构的高阶局部黎曼求解器，并将其与 DG 方法中使用的标准近似求解器进行比较。\n\n从精确的局部黎曼问题和标量守恒律的朗金-雨贡纽条件出发，将每个 $\\xi$ 处的 Godunov 数值通量 $F_G(u^-,u^+)$ 定义为由左态为 $u^-(\\xi)$ 和右态为 $u^+(\\xi)$ 的黎曼问题的自相似解所解析的物理上正确的通量。对于像 Burgers 通量 $f(u) = \\frac{1}{2}u^2$ 这样的凸通量，可以使用特征速度的符号，根据稀疏波和激波机制来表示逐点 Godunov 通量。对于线性对流 $f(u) = a u$，逐点 Godunov 通量简化为由 $a$ 的符号决定的迎风通量。\n\n通过对逐点 Godunov 通量在单元面测度上积分来定义单元面平均高阶黎曼通量：\n$$\n\\widehat{F}_{\\mathrm{HR}} = \\frac{1}{2}\\int_{-1}^{1} F_G\\!\\left(u^-(\\xi),u^+(\\xi)\\right)\\, d\\xi,\n$$\n其中前置因子 $\\frac{1}{2}$ 是因为在长度为 $2$ 的区间上进行平均。使用在 $[-1,1]$ 上 $p$ 阶的高斯-勒让德求积来近似该积分。\n\n为了进行比较，通过对逐点 Rusanov 通量进行积分来定义单元面平均局部 Lax-Friedrichs (Rusanov) 通量\n$$\nF_{\\mathrm{LF}}(u^-,u^+) = \\frac{1}{2}\\left(f(u^-)+f(u^+)\\right) - \\frac{1}{2}\\alpha(u^-,u^+)\\left(u^+ - u^-\\right)\n$$\n对于非线性通量，$\\alpha(u^-,u^+) = \\max\\left(|f'(u^-)|,|f'(u^+)|\\right)$；对于线性对流 $f(u) = a u$，$\\alpha = |a|$。单元面平均 Rusanov 通量为\n$$\n\\widehat{F}_{\\mathrm{LF}} = \\frac{1}{2}\\int_{-1}^{1} F_{\\mathrm{LF}}\\!\\left(u^-(\\xi),u^+(\\xi)\\right)\\, d\\xi.\n$$\n\n您的程序必须：\n- 针对 Burgers 通量 $f(u)=\\frac{1}{2}u^2$ 逐点实现 $F_G$，使用基于 $u^-$ 和 $u^+$ 的稀疏波和激波情况（使用标准的标量 Godunov 通量处理 Burgers 方程：当 $u^- \\le u^+$ 时为稀疏波，并根据 $u^-$ 和 $u^+$ 相对于 $0$ 的符号分子情况处理；当 $u^-  u^+$ 时为激波，使用激波速度 $s = \\frac{f(u^-) - f(u^+)}{u^- - u^+} = \\frac{u^- + u^+}{2}$ 来选择迎风侧）。\n- 针对线性对流 $f(u)=a u$ 逐点实现 $F_G$，将其作为由 $a$ 的符号决定的迎风通量。\n- 针对 Burgers 方程和线性对流，使用相应的特征速度 $\\alpha$ 来逐点实现 $F_{\\mathrm{LF}}$。\n- 使用 $p=5$ 阶的高斯-勒让德求积来近似单元面平均值 $\\widehat{F}_{\\mathrm{HR}}$ 和 $\\widehat{F}_{\\mathrm{LF}}$。\n- 对于每个测试用例，输出三个浮点数：单元面平均高阶 Godunov 通量 $\\widehat{F}_{\\mathrm{HR}}$、单元面平均 Rusanov 通量 $\\widehat{F}_{\\mathrm{LF}}$，以及绝对差值 $|\\widehat{F}_{\\mathrm{HR}}-\\widehat{F}_{\\mathrm{LF}}|$。\n\n使用以下多项式迹 $u^\\pm(\\xi)$ 和通量函数 $f$ 的测试套件：\n- 测试 A（线性对流，理想情况）：$f(u) = a u$，其中 $a = 1.7$。左侧迹 $u^-(\\xi) = 1 + 0.5\\,\\xi - 0.2\\,\\xi^2$。右侧迹 $u^+(\\xi) = 0.8 - 1.0\\,\\xi + 0.3\\,\\xi^2$。预期 $\\widehat{F}_{\\mathrm{HR}} = \\widehat{F}_{\\mathrm{LF}}$。\n- 测试 B（Burgers 方程，激波/稀疏波混合）：$f(u) = \\frac{1}{2}u^2$。左侧迹 $u^-(\\xi) = 1 + \\xi$。右侧迹 $u^+(\\xi) = -0.5 + 0.5\\,\\xi$。\n- 测试 C（Burgers 方程，零跳跃边界情况）：$f(u) = \\frac{1}{2}u^2$。相同的迹 $u^-(\\xi) = u^+(\\xi) = 0.3 + 0.4\\,\\xi - 0.1\\,\\xi^2$。预期 $|\\widehat{F}_{\\mathrm{HR}}-\\widehat{F}_{\\mathrm{LF}}| = 0$。\n- 测试 D（Burgers 方程，穿越扇区的符号变化的稀疏波）：$f(u) = \\frac{1}{2}u^2$。左侧迹 $u^-(\\xi) = -0.6 + 0.4\\,\\xi$。右侧迹 $u^+(\\xi) = 0.2 + 0.4\\,\\xi$。\n\n最终输出格式必须是单行，包含一个有 $12$ 个浮点数的 Python 列表，顺序为 $[\\widehat{F}_{\\mathrm{HR}}^{(A)},\\widehat{F}_{\\mathrm{LF}}^{(A)},|\\widehat{F}_{\\mathrm{HR}}^{(A)}-\\widehat{F}_{\\mathrm{LF}}^{(A)}|,\\widehat{F}_{\\mathrm{HR}}^{(B)},\\widehat{F}_{\\mathrm{LF}}^{(B)},|\\widehat{F}_{\\mathrm{HR}}^{(B)}-\\widehat{F}_{\\mathrm{LF}}^{(B)}|,\\widehat{F}_{\\mathrm{HR}}^{(C)},\\widehat{F}_{\\mathrm{LF}}^{(C)},|\\widehat{F}_{\\mathrm{HR}}^{(C)}-\\widehat{F}_{\\mathrm{LF}}^{(C)}|,\\widehat{F}_{\\mathrm{HR}}^{(D)},\\widehat{F}_{\\mathrm{LF}}^{(D)},|\\widehat{F}_{\\mathrm{HR}}^{(D)}-\\widehat{F}_{\\mathrm{LF}}^{(D)}|]$。不涉及单位；所有量均为无量纲实数。",
            "solution": "该问题要求计算和比较两种数值通量：高阶 Godunov（或黎曼）通量 $\\widehat{F}_{\\mathrm{HR}}$ 和局部 Lax-Friedrichs（或 Rusanov）通量 $\\widehat{F}_{\\mathrm{LF}}$。这两种通量应用于形式为 $u_t + \\partial_x f(u) = 0$ 的标量守恒律的 DG 方法。这些通量被定义为在一个单元面上的平均值，该单元面由局部坐标 $\\xi \\in [-1, 1]$ 参数化。从左侧和右侧单元投影到该面上的解的迹分别由多项式 $u^-(\\xi)$ 和 $u^+(\\xi)$ 给出。\n\n问题的核心在于计算单元面平均积分：\n$$\n\\widehat{F}_{\\mathrm{HR}} = \\frac{1}{2}\\int_{-1}^{1} F_G\\!\\left(u^-(\\xi),u^+(\\xi)\\right)\\, d\\xi\n$$\n$$\n\\widehat{F}_{\\mathrm{LF}} = \\frac{1}{2}\\int_{-1}^{1} F_{\\mathrm{LF}}\\!\\left(u^-(\\xi),u^+(\\xi)\\right)\\, d\\xi\n$$\n这些积分使用具有 $p=5$ 个点的高斯-勒让德求积进行近似。在区间 $[-1, 1]$ 上的一个通用积分近似为：\n$$\n\\int_{-1}^{1} g(\\xi) \\, d\\xi \\approx \\sum_{i=1}^{p} w_i g(\\xi_i)\n$$\n其中 $\\xi_i$ 是求积节点（$p$ 阶勒让德多项式的根），$w_i$ 是相应的权重。通量定义中的前置因子 $\\frac{1}{2}$ 是因为在长度为 $2$ 的区间上进行平均。因此，数值近似为：\n$$\n\\widehat{F} \\approx \\frac{1}{2} \\sum_{i=1}^{5} w_i F(u^-(\\xi_i), u^+(\\xi_i))\n$$\n其中 $F$ 是逐点 Godunov 通量 $F_G$ 或逐点 Rusanov 通量 $F_{\\mathrm{LF}}$。\n\n我们必须首先为两种指定的守恒律定义逐点通量函数：线性对流和 Burgers 方程。\n\n对于线性对流，通量函数为 $f(u) = au$，其中 $a$ 是一个恒定的波速。其导数为 $f'(u) = a$。\n逐点 Godunov 通量 $F_G$ 是黎曼问题的精确解，它简化为标准的迎风通量。信息传播的方向仅由速度 $a$ 的符号决定。\n$$\nF_G(u^-, u^+) = \\begin{cases} f(u^-) = au^-  \\text{若 } a  0 \\\\ f(u^+) = au^+  \\text{若 } a \\le 0 \\end{cases}\n$$\n逐点 Rusanov 通量 $F_{\\mathrm{LF}}$ 由下式给出：\n$$\nF_{\\mathrm{LF}}(u^-, u^+) = \\frac{1}{2}\\left(f(u^-) + f(u^+)\\right) - \\frac{1}{2}\\alpha\\left(u^+ - u^-\\right)\n$$\n对于线性对流，局部波速为 $\\alpha = |f'(u)| = |a|$。将此代入公式：\n$$\nF_{\\mathrm{LF}}(u^-, u^+) = \\frac{1}{2}\\left(au^- + au^+\\right) - \\frac{1}{2}|a|\\left(u^+ - u^-\\right)\n$$\n如果 $a0$，则 $|a|=a$，通量变为 $\\frac{1}{2}(au^- + au^+) - \\frac{1}{2}a(u^+ - u^-) = \\frac{1}{2}(au^- + au^+ - au^+ + au^-) = au^-$。\n如果 $a \\le 0$，则 $|a|=-a$，通量变为 $\\frac{1}{2}(au^- + au^+) - \\frac{1}{2}(-a)(u^+ - u^-) = \\frac{1}{2}(au^- + au^+ + au^+ - au^-) = au^+$。\n在两种情况下，$F_{\\mathrm{LF}}(u^-, u^+) = F_G(u^-, u^+)$。因此，对于线性对流方程，单元面平均 Rusanov 通量和 Godunov 通量将是相同的，即 $\\widehat{F}_{\\mathrm{HR}} = \\widehat{F}_{\\mathrm{LF}}$，正如测试 A 中所预期的。\n\n对于 Burgers 方程，通量是非线性和凸的：$f(u) = \\frac{1}{2}u^2$。特征速度是 $f'(u) = u$。\n逐点 Godunov 通量 $F_G$ 取决于黎曼问题解的结构，可以是激波或稀疏波。设 $u_L=u^-$ 和 $u_R=u^+$。\n1. 如果 $u_L  u_R$，解是一个以速度 $s = \\frac{f(u_L) - f(u_R)}{u_L - u_R} = \\frac{\\frac{1}{2}u_L^2 - \\frac{1}{2}u_R^2}{u_L - u_R} = \\frac{1}{2}(u_L + u_R)$ 传播的激波。界面（$\\xi=0$）处的通量由迎风状态决定。\n    - 如果 $s  0$，激波向右移动，界面处的状态是 $u_L$。通量为 $f(u_L)$。\n    - 如果 $s \\le 0$，激波向左移动（或静止），界面处的状态是 $u_R$。通量为 $f(u_R)$。\n2. 如果 $u_L \\le u_R$，解是一个稀疏扇。界面处的状态取决于扇区是否穿过线 $\\xi=0$，这对应于特征速度为 $0$ 的情况。\n    - 如果 $u_L \\ge 0$（这意味着 $u_R \\ge u_L \\ge 0$），所有特征线都向右移动。界面处的状态是 $u_L$，通量为 $f(u_L)$。\n    - 如果 $u_R \\le 0$（这意味着 $u_L \\le u_R \\le 0$），所有特征线都向左移动。界面处的状态是 $u_R$，通量为 $f(u_R)$。\n    - 如果 $u_L  0  u_R$，扇区包含速度为 $0$ 的特征线。界面处的状态是声速点状态 $u_{sonic}$，其中 $f'(u_{sonic})=0$。对于 Burgers 方程，$u_{sonic}=0$，所以通量为 $f(0) = 0$。\n\n对于 Burgers 方程，逐点 Rusanov 通量 $F_{\\mathrm{LF}}$ 使用局部速度 $\\alpha = \\max(|f'(u^-)|, |f'(u^+)|) = \\max(|u^-|, |u^+|)$。公式为：\n$$\nF_{\\mathrm{LF}}(u^-, u^+) = \\frac{1}{2}\\left(f(u^-) + f(u^+)\\right) - \\frac{1}{2}\\max(|u^-|, |u^+|)\\left(u^+ - u^-\\right)\n$$\n其中 $f(u) = \\frac{1}{2}u^2$。\n\n在测试 C 中，对于所有 $\\xi \\in [-1, 1]$ 都有 $u^-(\\xi) = u^+(\\xi)$。在这种情况下，跳跃量 $u^+ - u^-$ 为零。Godunov 通量就是 $F_G(u, u) = f(u)$，而 Rusanov 通量变为 $F_{\\mathrm{LF}}(u, u) = \\frac{1}{2}(f(u) + f(u)) - 0 = f(u)$。因此，$\\widehat{F}_{\\mathrm{HR}}$ 和 $\\widehat{F}_{\\mathrm{LF}}$ 是相同的，它们的绝对差为 $0$。\n\n每个测试用例的算法流程如下：\n1. 获取 $p=5$ 阶高斯-勒让德求积节点 $\\xi_i$ 和权重 $w_i$。\n2. 对每个测试用例，定义多项式迹 $u^-(\\xi)$ 和 $u^+(\\xi)$ 以及物理通量函数 $f(u)$。\n3. 将积分通量的总和初始化为 $0$。\n4. 遍历每个求积节点 $\\xi_i$：\n    a. 计算左侧和右侧的状态，$u_L = u^-(\\xi_i)$ 和 $u_R = u^+(\\xi_i)$。\n    b. 使用适当的逻辑（线性对流或 Burgers 方程）计算逐点 Godunov 通量 $F_G(u_L, u_R)$。\n    c. 根据其定义计算逐点 Rusanov 通量 $F_{\\mathrm{LF}}(u_L, u_R)$。\n    d. 累加加权通量：将 $w_i F_G(u_L, u_R)$ 和 $w_i F_{\\mathrm{LF}}(u_L, u_R)$ 分别加到它们各自的总和中。\n5. 将总和乘以 $\\frac{1}{2}$ 来计算最终的单元面平均通量。\n6. 计算两个平均通量之间的绝对差。\n7. 收集最终输出所需的三个浮点数结果。\n对所有四个测试用例重复此过程。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import roots_legendre\n\n# language: Python\n# version: 3.12\n# libraries:\n#     name: numpy, version: 1.23.5\n#     name: scipy, version: 1.11.4\n\ndef solve():\n    \"\"\"\n    Computes and compares face-averaged high-order Godunov and Rusanov fluxes\n    for several test cases in the Discontinuous Galerkin method.\n    \"\"\"\n\n    # --- Pointwise Flux Implementations ---\n\n    def f_burgers(u):\n        \"\"\"Physical flux for Burgers' equation.\"\"\"\n        return 0.5 * u**2\n\n    def godunov_flux_linear(u_left, u_right, a):\n        \"\"\"Pointwise Godunov (upwind) flux for linear advection f(u)=au.\"\"\"\n        if a > 0.0:\n            return a * u_left\n        else:\n            return a * u_right\n\n    def rusanov_flux_linear(u_left, u_right, a):\n        \"\"\"Pointwise Rusanov (LLF) flux for linear advection f(u)=au.\"\"\"\n        f_left = a * u_left\n        f_right = a * u_right\n        alpha = np.abs(a)\n        return 0.5 * (f_left + f_right) - 0.5 * alpha * (u_right - u_left)\n\n    def godunov_flux_burgers(u_left, u_right):\n        \"\"\"Pointwise Godunov flux for Burgers' equation f(u)=0.5*u^2.\"\"\"\n        if u_left > u_right:  # Shock\n            s = 0.5 * (u_left + u_right)\n            if s > 0.0:\n                return f_burgers(u_left)\n            else:\n                return f_burgers(u_right)\n        else:  # Rarefaction (or u_left == u_right)\n            # f'(u) = u\n            if u_left >= 0.0:  # and u_right >= u_left >= 0\n                return f_burgers(u_left)\n            elif u_right = 0.0: # and u_left = u_right = 0\n                return f_burgers(u_right)\n            else:  # u_left  0  u_right, sonic point crossed\n                return f_burgers(0.0)\n\n    def rusanov_flux_burgers(u_left, u_right):\n        \"\"\"Pointwise Rusanov (LLF) flux for Burgers' equation.\"\"\"\n        f_left = f_burgers(u_left)\n        f_right = f_burgers(u_right)\n        # alpha = max(|f'(u_left)|, |f'(u_right)|) = max(|u_left|, |u_right|)\n        alpha = np.maximum(np.abs(u_left), np.abs(u_right))\n        return 0.5 * (f_left + f_right) - 0.5 * alpha * (u_right - u_left)\n\n    # --- Test Case Definitions ---\n\n    test_cases = [\n        {\n            \"id\": \"A\",\n            \"type\": \"linear\",\n            \"params\": {\"a\": 1.7},\n            \"u_left\": lambda xi: 1.0 + 0.5 * xi - 0.2 * xi**2,\n            \"u_right\": lambda xi: 0.8 - 1.0 * xi + 0.3 * xi**2,\n        },\n        {\n            \"id\": \"B\",\n            \"type\": \"burgers\",\n            \"params\": {},\n            \"u_left\": lambda xi: 1.0 + xi,\n            \"u_right\": lambda xi: -0.5 + 0.5 * xi,\n        },\n        {\n            \"id\": \"C\",\n            \"type\": \"burgers\",\n            \"params\": {},\n            \"u_left\": lambda xi: 0.3 + 0.4 * xi - 0.1 * xi**2,\n            \"u_right\": lambda xi: 0.3 + 0.4 * xi - 0.1 * xi**2,\n        },\n        {\n            \"id\": \"D\",\n            \"type\": \"burgers\",\n            \"params\": {},\n            \"u_left\": lambda xi: -0.6 + 0.4 * xi,\n            \"u_right\": lambda xi: 0.2 + 0.4 * xi,\n        },\n    ]\n\n    # --- Numerical Integration Setup ---\n    p_order = 5\n    xi_nodes, w_weights = roots_legendre(p_order)\n\n    # --- Main Calculation Loop ---\n    \n    all_results = []\n    \n    for case in test_cases:\n        sum_hr = 0.0\n        sum_lf = 0.0\n        \n        # Select appropriate pointwise flux functions based on case type\n        if case[\"type\"] == \"linear\":\n            a = case[\"params\"][\"a\"]\n            pt_flux_hr = lambda ul, ur: godunov_flux_linear(ul, ur, a)\n            pt_flux_lf = lambda ul, ur: rusanov_flux_linear(ul, ur, a)\n        elif case[\"type\"] == \"burgers\":\n            pt_flux_hr = godunov_flux_burgers\n            pt_flux_lf = rusanov_flux_burgers\n        \n        for xi, w in zip(xi_nodes, w_weights):\n            u_l = case[\"u_left\"](xi)\n            u_r = case[\"u_right\"](xi)\n            \n            sum_hr += w * pt_flux_hr(u_l, u_r)\n            sum_lf += w * pt_flux_lf(u_l, u_r)\n            \n        # The integral is over [-1, 1], an interval of length 2.\n        # The factor 1/2 is for averaging.\n        avg_flux_hr = 0.5 * sum_hr\n        avg_flux_lf = 0.5 * sum_lf\n        \n        diff = np.abs(avg_flux_hr - avg_flux_lf)\n        \n        all_results.extend([avg_flux_hr, avg_flux_lf, diff])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{x:.12f}' for x in all_results)}]\")\n\nsolve()\n\n```"
        }
    ]
}