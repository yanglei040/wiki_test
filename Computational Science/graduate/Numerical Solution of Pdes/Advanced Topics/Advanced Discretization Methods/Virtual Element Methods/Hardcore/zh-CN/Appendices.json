{
    "hands_on_practices": [
        {
            "introduction": "本练习关注虚拟单元空间的基本定义。通过枚举自由度（DoFs）——包括顶点值、边矩和内部矩——您将推导出局部空间的维度，这是构建任何VEM近似的关键第一步。这项练习将巩固您对如何在通用多边形上构建VEM空间的理解。",
            "id": "3461335",
            "problem": "考虑一个单连通多边形单元 $E \\subset \\mathbb{R}^{2}$，其具有 $n_{E}$ 条直边，因此有 $n_{E}$ 个顶点。该单元用于求解二阶椭圆型偏微分方程的协调虚拟单元法（VEM），多项式次数为 $k \\ge 2$。$E$ 上的局部试验空间被设计为：(i) 在每条边上的迹位于次数至多为 $k$ 的多项式空间中，以及 (ii) 该空间包含 $E$ 上所有总次数至多为 $k$ 的多项式。$E$ 上的典范自由度定义如下：\n- 顶点值：函数在每个多边形顶点处的点态求值。\n- 次数至多为 $k-2$ 的边矩：对于每个边 $e \\subset \\partial E$，函数与 $e$ 上所有总次数至多为 $k-2$ 的单项式作线积分。\n- 次数至多为 $k-2$ 的内部矩：在 $E$ 上，函数与 $E$ 上所有总次数至多为 $k-2$ 的单项式作面积分。\n\n从关于一维线段和二维区域上多边形空间的结构和维数的基本原理出发，枚举这些自由度的类别，并推导出一个关于 $k$ 和 $n_{E}$ 的闭式表达式，用于表示 $E$ 上独立的局部自由度的总数。您的最终答案必须是关于 $k$ 和 $n_{E}$ 的单个闭式解析表达式。",
            "solution": "问题要求计算在多边形单元 $E$ 上，一种特定虚拟单元法（VEM）构造的独立局部自由度（DoFs）的总数。该问题陈述是有效的，在偏微分方程数值方法的理论中有科学依据，并且是适定的。因此，我们可以进行系统性的推导。\n\n自由度的总数（我们记为 $N_{DoF}$）是问题中定义的三个类别中自由度数量的总和：\n1.  顶点值 ($N_{vertex}$)。\n2.  边矩 ($N_{edge}$)。\n3.  内部矩 ($N_{internal}$)。\n\n因此，我们有以下关系式：\n$$N_{DoF} = N_{vertex} + N_{edge} + N_{internal}$$\n\n现在，我们将基于关于多项式空间维数的基本原理，为每个类别的自由度数量推导表达式。\n\n**1. 顶点自由度的枚举 ($N_{vertex}$)**\n\n问题将这些自由度定义为“函数在每个多边形顶点处的点态求值”。一个具有 $n_E$ 条边的多边形单元 $E$ 由其 $n_E$ 个顶点定义。由于每个顶点提供一个单一的自由度（函数在该点的值），顶点自由度的总数就等于顶点的数量。\n$$N_{vertex} = n_E$$\n\n**2. 边自由度的枚举 ($N_{edge}$)**\n\n这些自由度被定义为“对于每个边 $e \\subset \\partial E$，函数与 $e$ 上所有总次数至多为 $k-2$ 的单项式作线积分”。\n\n让我们考虑一条直边 $e$。边是一个一维区域。我们可以在这条边上建立一个局部坐标系，例如，使用一个沿其长度变化的变量 $s$。这条边上的单项式形式为 $s^j$，其中 $j$ 是表示次数的非负整数。\n\n问题指定使用所有总次数至多为 $k-2$ 的单项式。对于一维区域，这对应于单项式集合 $\\{s^0, s^1, s^2, \\dots, s^{k-2}\\}$。这类单项式的数量是一维线段上次数至多为 $k-2$ 的多项式空间的维数，我们记作 $\\mathcal{P}_{k-2}(e)$。该维数由最高次数加一给出。\n$$\\text{每条边的单项式数量} = \\dim(\\mathcal{P}_{k-2}(e)) = (k-2) + 1 = k-1$$\n这个计数是有效的，因为问题陈述了 $k \\ge 2$，这确保了最大次数 $k-2$ 是非负的。\n\n由于多边形 $E$ 的边界上有 $n_E$ 条边，每条边贡献 $k-1$ 个自由度，因此边自由度的总数是它们的乘积：\n$$N_{edge} = n_E \\times (k-1)$$\n\n**3. 內部自由度的枚举 ($N_{internal}$)**\n\n这些自由度被定义为“在 $E$ 上，函数与 $E$ 上所有总次数至多为 $k-2$ 的单项式作面积分”。\n\n单元 $E$ 是 $\\mathbb{R}^2$ 中的一个二维区域。两个变量（比如 $x$ 和 $y$）的单项式形式为 $x^i y^j$，其中 $i$ 和 $j$ 是非负整数。这个单项式的总次数是 $i+j$。\n\n我们需要计算总次数至多为 $k-2$ 的这类单项式的数量。这等价于找到两个变量中总次数至多为 $k-2$ 的多项式空间的维数，记作 $\\mathcal{P}_{k-2}(E)$。$m$ 个变量中次数至多为 $d$ 的多项式空间的维数由公式 $\\binom{m+d}{m}$ 给出。\n\n在我们的例子中，变量数为 $m=2$，最大次数为 $d=k-2$。将这些值代入公式，我们得到：\n$$N_{internal} = \\dim(\\mathcal{P}_{k-2}(E)) = \\binom{2 + (k-2)}{2} = \\binom{k}{2}$$\n使用二项式系数的定义 $\\binom{n}{r} = \\frac{n!}{r!(n-r)!}$，我们可以将其写作：\n$$N_{internal} = \\frac{k(k-1)}{2 \\cdot 1} = \\frac{k(k-1)}{2}$$\n这对于 $k \\ge 2$ 是有效的。如果 $k=2$，则次数至多为 $0$，因此只有一个单项式（常数 $1$），并且公式正确地给出 $\\binom{2}{2} = 1$。\n\n**4. 自由度总数 ($N_{DoF}$)**\n\n最后，我们将这三个类别的计数相加，得到单元 $E$ 上局部自由度的总数。\n$$N_{DoF} = N_{vertex} + N_{edge} + N_{internal}$$\n代入我们推导出的表达式：\n$$N_{DoF} = n_E + n_E(k-1) + \\frac{k(k-1)}{2}$$\n我们可以简化这个表达式：\n$$N_{DoF} = n_E + n_E k - n_E + \\frac{k(k-1)}{2}$$\n$$N_{DoF} = n_E k + \\frac{k(k-1)}{2}$$\n这就是单元 $E$ 上独立的局部自由度总数的闭式表达式，用顶点数 $n_E$ 和多项式次数 $k$ 表示。这些自由度的独立性是 VEM 构造的基石，确保它们在局部 VEM 空间内唯一确定一个函数，而该空间的维数恰好是 $N_{DoF}$。",
            "answer": "$$\\boxed{n_{E} k + \\frac{k(k-1)}{2}}$$"
        },
        {
            "introduction": "$L^2$ 投影算子 $\\Pi^0_m$ 是VEM中处理源项和非恒定系数的一个重要工具，它使得计算在实际中变得可行。本练习将引导您完成构建和求解局部线性系统的过程，以计算给定函数的投影。这个动手计算展示了抽象的投影算子如何转化为具体的数值计算。",
            "id": "3461308",
            "problem": "考虑一个具有 Lipschitz 边界的多边形单元 $E \\subset \\mathbb{R}^2$，并令 $\\mathbb{P}_m(E)$ 表示 $E$ 上总次数至多为 $m \\in \\mathbb{N}$ 的多项式空间。$L^2$ 投影算子 $\\Pi^0_m : L^2(E) \\to \\mathbb{P}_m(E)$ 由条件\n$$(\\Pi^0_m w, p)_E = (w, p)_E \\quad \\text{对所有 } p \\in \\mathbb{P}_m(E),$$\n定义，其中 $(u,v)_E := \\int_E u v \\, \\mathrm{d}\\boldsymbol{x}$ 表示 $E$ 上的 $L^2$ 内积。在虚拟元方法 (VEM) 中，一个离散函数由自由度 (DoFs) 来刻画，并且投影算子 $\\Pi^0_m$ 可以通过求解一个小的、单元上的线性系统来计算。该线性系统由 $\\mathbb{P}_m(E)$ 中多项式基的格拉姆 (Gram) 矩阵和右端矩 $(w,p)_E$ 构建。对于光滑或多项式的 $w$，这些矩可以通过精确积分来计算。\n\n从 $L^2$ 投影算子的定义和多项式矩自由度出发，推导在 $\\mathbb{P}_m(E)$ 的一个选定基中 $\\Pi^0_m f$ 的系数所满足的线性系统，并解释为什么当 $f$ 是光滑的或多项式时，精确积分是足够的。然后，令 $E = [0,1]^2 \\subset \\mathbb{R}^2$，令 $m=1$，选择 $\\mathbb{P}_1(E)$ 的中心化基 $\\{p_0, p_1, p_2\\}$，其中 $p_0(x,y) = 1$，$p_1(x,y) = x - \\tfrac{1}{2}$ 以及 $p_2(x,y) = y - \\tfrac{1}{2}$，并取 $f(x,y) = x^2 + y$。使用上述框架和在 $E$ 上的精确积分，计算 $\\Pi^0_1 f$ 的显式表达式，并将其简化为关于 $x$ 和 $y$ 的单个多项式。以单个解析表达式的形式给出你的最终答案。无需四舍五入。",
            "solution": "该问题要求推导用于计算到多项式空间上的 $L^2$ 投影的线性系统，然后对一个具体情况进行显式计算。我们首先讨论一般框架。\n\n令 $E \\subset \\mathbb{R}^2$ 为一个多边形区域，并令 $\\mathbb{P}_m(E)$ 为 $E$ 上总次数至多为 $m$ 的多项式空间。该空间的维数为 $N = \\dim(\\mathbb{P}_m(E)) = \\frac{(m+1)(m+2)}{2}$。令 $\\{\\phi_j\\}_{j=1}^{N}$ 为 $\\mathbb{P}_m(E)$ 的一个基。$L^2$ 投影算子 $\\Pi^0_m$ 将函数 $f \\in L^2(E)$ 映射到它在 $\\mathbb{P}_m(E)$ 中的最佳逼近，记作 $\\Pi^0_m f$。根据定义，$\\Pi^0_m f \\in \\mathbb{P}_m(E)$，并且它满足正交性条件：\n$$ (\\Pi^0_m f, p)_E = (f, p)_E \\quad \\text{对所有 } p \\in \\mathbb{P}_m(E) $$\n其中 $(u,v)_E = \\int_E u v \\, \\mathrm{d}\\boldsymbol{x}$ 是标准的 $L^2(E)$ 内积。\n\n由于 $\\Pi^0_m f$ 是 $\\mathbb{P}_m(E)$ 的一个元素，它可以表示为基函数的唯一线性组合：\n$$ \\Pi^0_m f = \\sum_{j=1}^{N} c_j \\phi_j $$\n其中 $\\{c_j\\}_{j=1}^{N}$ 为一些未知的标量系数。为了求出这些系数，我们可以使用投影算子的定义性质。由于该条件对任意多项式 $p \\in \\mathbb{P}_m(E)$ 都必须成立，因此它对每个基函数 $\\phi_i$（其中 $i \\in \\{1, \\dots, N\\}$）也必须成立。将 $\\Pi^0_m f$ 的表达式代入定义方程，并令 $p = \\phi_i$，得到：\n$$ \\left( \\sum_{j=1}^{N} c_j \\phi_j, \\phi_i \\right)_E = (f, \\phi_i)_E \\quad \\text{对于 } i = 1, \\dots, N $$\n根据内积在第一个参数上的线性性，我们可以写出：\n$$ \\sum_{j=1}^{N} c_j (\\phi_j, \\phi_i)_E = (f, \\phi_i)_E \\quad \\text{对于 } i = 1, \\dots, N $$\n这构成了一个关于 $N$ 个未知系数 $c_j$ 的 $N$ 个线性方程组。该系统可以写成矩阵形式 $G \\boldsymbol{c} = \\boldsymbol{b}$，其中：\n- $\\boldsymbol{c} = (c_1, c_2, \\dots, c_N)^T$ 是系数向量。\n- $G$ 是 $N \\times N$ 的格拉姆 (Gram) 矩阵，其元素为 $G_{ij} = (\\phi_j, \\phi_i)_E = \\int_E \\phi_i \\phi_j \\, \\mathrm{d}\\boldsymbol{x}$。\n- $\\boldsymbol{b}$ 是右端矩向量，其元素为 $b_i = (f, \\phi_i)_E = \\int_E f \\phi_i \\, \\mathrm{d}\\boldsymbol{x}$。\n由于基函数 $\\{\\phi_j\\}$ 是线性无关的，格拉姆矩阵 $G$ 是对称正定的。因此，$G$ 是可逆的，对于任何给定的 $f \\in L^2(E)$，都存在唯一的解 $\\boldsymbol{c}$。\n\n该系统的可计算性取决于我们计算构成矩阵 $G$ 和向量 $\\boldsymbol{b}$ 的积分的能力。$G$ 的元素是基多项式乘积的积分，即 $G_{ij} = \\int_E \\phi_i \\phi_j \\, \\mathrm{d}\\boldsymbol{x}$。由于 $\\phi_i$ 和 $\\phi_j$ 是多项式，它们的乘积 $\\phi_i \\phi_j$ 也是一个多项式。任何多项式在多边形区域上的积分都可以精确计算，例如，通过使用 Green 定理将面积分转换为多边形边界（由直线段组成）上的线积分。因此，格拉姆矩阵总是可以精确计算的。右端向量的元素是 $b_i = \\int_E f \\phi_i \\, \\mathrm{d}\\boldsymbol{x}$。如果函数 $f$ 是一个多项式，那么被积函数 $f \\phi_i$ 也是一个多项式，该积分可以精确计算。如果 $f$ 是一个更一般的平滑函数，除非该函数具有适用于符号积分的结构，否则可能无法进行精确积分。问题陈述中提到了“光滑或多项式”函数，承认了对于在许多 VEM 应用中至关重要的多项式情况，精确性是可以保证的。\n\n现在，我们将此框架应用于具体问题。给定：\n- 区域 $E = [0,1]^2$。\n- 多项式次数 $m = 1$。空间 $\\mathbb{P}_1(E)$ 的维数为 $N=3$。\n- $\\mathbb{P}_1(E)$ 的基 $\\{p_0, p_1, p_2\\}$：\n  - $p_0(x,y) = 1$\n  - $p_1(x,y) = x - \\frac{1}{2}$\n  - $p_2(x,y) = y - \\frac{1}{2}$\n- 要投影的函数：$f(x,y) = x^2 + y$。\n\n我们要求解 $\\Pi^0_1 f = c_0 p_0 + c_1 p_1 + c_2 p_2$。我们必须计算格拉姆矩阵 $G$ 和矩向量 $\\boldsymbol{b}$。矩阵元素为 $G_{ij} = (p_i, p_j)_E$。\n\n- $G_{00} = \\int_0^1 \\int_0^1 (1)(1) \\, \\mathrm{d}x \\mathrm{d}y = 1$。\n- $G_{01} = G_{10} = \\int_0^1 \\int_0^1 (1)(x - \\frac{1}{2}) \\, \\mathrm{d}x \\mathrm{d}y = \\int_0^1 \\left[\\frac{x^2}{2} - \\frac{x}{2}\\right]_0^1 \\mathrm{d}y = \\int_0^1 0 \\, \\mathrm{d}y = 0$。\n- $G_{02} = G_{20} = \\int_0^1 \\int_0^1 (1)(y - \\frac{1}{2}) \\, \\mathrm{d}x \\mathrm{d}y = \\int_0^1 (y - \\frac{1}{2}) \\mathrm{d}y = \\left[\\frac{y^2}{2} - \\frac{y}{2}\\right]_0^1 = 0$。\n- $G_{11} = \\int_0^1 \\int_0^1 (x - \\frac{1}{2})^2 \\, \\mathrm{d}x \\mathrm{d}y = \\int_0^1 \\left[\\frac{(x - \\frac{1}{2})^3}{3}\\right]_0^1 \\mathrm{d}y = \\int_0^1 \\frac{(\\frac{1}{2})^3 - (-\\frac{1}{2})^3}{3} \\mathrm{d}y = \\int_0^1 \\frac{\\frac{1}{8} + \\frac{1}{8}}{3} \\mathrm{d}y = \\int_0^1 \\frac{1}{12} \\mathrm{d}y = \\frac{1}{12}$。\n- $G_{12} = G_{21} = \\int_0^1 \\int_0^1 (x - \\frac{1}{2})(y - \\frac{1}{2}) \\, \\mathrm{d}x \\mathrm{d}y = \\left(\\int_0^1 (x - \\frac{1}{2}) \\mathrm{d}x\\right) \\left(\\int_0^1 (y - \\frac{1}{2}) \\mathrm{d}y\\right) = (0)(0) = 0$。\n- $G_{22} = \\int_0^1 \\int_0^1 (y - \\frac{1}{2})^2 \\, \\mathrm{d}x \\mathrm{d}y = \\int_0^1 (y - \\frac{1}{2})^2 \\mathrm{d}y = \\left[\\frac{(y - \\frac{1}{2})^3}{3}\\right]_0^1 = \\frac{1}{12}$。\n\n该基的格拉姆矩阵是对角矩阵，证实了该基是正交的。\n$$ G = \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & \\frac{1}{12} & 0 \\\\ 0 & 0 & \\frac{1}{12} \\end{pmatrix} $$\n接下来，我们计算右端向量 $\\boldsymbol{b}$，其元素为 $b_i = (f, p_i)_E$。\n\n- $b_0 = \\int_0^1 \\int_0^1 (x^2+y)(1) \\, \\mathrm{d}x \\mathrm{d}y = \\int_0^1 \\left[\\frac{x^3}{3} + yx\\right]_0^1 \\mathrm{d}y = \\int_0^1 (\\frac{1}{3} + y) \\mathrm{d}y = \\left[\\frac{y}{3} + \\frac{y^2}{2}\\right]_0^1 = \\frac{1}{3} + \\frac{1}{2} = \\frac{5}{6}$。\n- $b_1 = \\int_0^1 \\int_0^1 (x^2+y)(x - \\frac{1}{2}) \\, \\mathrm{d}x \\mathrm{d}y = \\int_0^1 \\int_0^1 (x^3 - \\frac{1}{2}x^2 + yx - \\frac{1}{2}y) \\, \\mathrm{d}x \\mathrm{d}y$。\n关于 x 的内层积分是 $\\int_0^1 (x^3 - \\frac{1}{2}x^2 + yx - \\frac{1}{2}y) \\, \\mathrm{d}x = \\left[\\frac{x^4}{4} - \\frac{x^3}{6} + \\frac{yx^2}{2} - \\frac{yx}{2}\\right]_0^1 = \\frac{1}{4} - \\frac{1}{6} + \\frac{y}{2} - \\frac{y}{2} = \\frac{1}{12}$。\n那么，$\\int_0^1 \\frac{1}{12} \\mathrm{d}y = \\frac{1}{12}$。所以，$b_1 = \\frac{1}{12}$。\n- $b_2 = \\int_0^1 \\int_0^1 (x^2+y)(y - \\frac{1}{2}) \\, \\mathrm{d}x \\mathrm{d}y = \\int_0^1 \\int_0^1 (x^2y - \\frac{1}{2}x^2 + y^2 - \\frac{1}{2}y) \\, \\mathrm{d}x \\mathrm{d}y$。\n关于 x 的内层积分是 $\\int_0^1 (x^2y - \\frac{1}{2}x^2 + y^2 - \\frac{1}{2}y) \\, \\mathrm{d}x = \\left[\\frac{x^3y}{3} - \\frac{x^3}{6} + y^2x - \\frac{y}{2}x\\right]_0^1 = \\frac{y}{3} - \\frac{1}{6} + y^2 - \\frac{y}{2} = y^2 - \\frac{y}{6} - \\frac{1}{6}$。\n那么，$\\int_0^1 (y^2 - \\frac{y}{6} - \\frac{1}{6}) \\mathrm{d}y = \\left[\\frac{y^3}{3} - \\frac{y^2}{12} - \\frac{y}{6}\\right]_0^1 = \\frac{1}{3} - \\frac{1}{12} - \\frac{1}{6} = \\frac{4-1-2}{12} = \\frac{1}{12}$。所以，$b_2 = \\frac{1}{12}$。\n\n线性系统 $G \\boldsymbol{c} = \\boldsymbol{b}$ 为：\n$$ \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & \\frac{1}{12} & 0 \\\\ 0 & 0 & \\frac{1}{12} \\end{pmatrix} \\begin{pmatrix} c_0 \\\\ c_1 \\\\ c_2 \\end{pmatrix} = \\begin{pmatrix} \\frac{5}{6} \\\\ \\frac{1}{12} \\\\ \\frac{1}{12} \\end{pmatrix} $$\n求解系数是直接的：\n- $c_0 = \\frac{5}{6}$。\n- $\\frac{1}{12} c_1 = \\frac{1}{12} \\implies c_1 = 1$。\n- $\\frac{1}{12} c_2 = \\frac{1}{12} \\implies c_2 = 1$。\n\n最后，我们构建投影多项式 $\\Pi^0_1 f$：\n$$ \\Pi^0_1 f(x,y) = c_0 p_0(x,y) + c_1 p_1(x,y) + c_2 p_2(x,y) \\\\ = \\frac{5}{6}(1) + 1\\left(x - \\frac{1}{2}\\right) + 1\\left(y - \\frac{1}{2}\\right) \\\\ = \\frac{5}{6} + x - \\frac{1}{2} + y - \\frac{1}{2} \\\\ = x + y + \\frac{5}{6} - 1 \\\\ = x + y - \\frac{1}{6} $$\n函数 $f(x,y)=x^2+y$ 在单位正方形上到线性多项式空间上的 $L^2$ 投影的显式表达式为 $x+y-\\frac{1}{6}$。",
            "answer": "$$\\boxed{x + y - \\frac{1}{6}}$$"
        },
        {
            "introduction": "一致性投影算子 $\\Pi^{\\nabla}_1$ 是虚拟单元方法的核心，它允许在不明确知道基函数的情况下计算刚度矩阵。本练习要求您从其定义性质出发推导该投影算子，并理解其在确保方法对线性多项式精确性（即通过“修补检验”）中的作用。这是掌握VEM如何实现精度和收敛性的关键。",
            "id": "3456377",
            "problem": "考虑用于求解单个多边形单元 $K \\subset \\mathbb{R}^{2}$ 上模型椭圆型偏微分方程 (PDE) 的最低阶协调虚拟元法 (VEM)，其中 $K$ 是关于一个球的任意星形多边形。设 $K$ 的边界 $\\partial K$ 由直边 $e$ 组成，其单位外法向量为 $n_{e}$，边长为 $\\ell_{e}$，边中点为 $m_{e} \\in \\mathbb{R}^{2}$。用 $|K|$ 表示 $K$ 的面积，用 $L_{K} = \\sum_{e \\subset \\partial K} \\ell_{e}$ 表示其周长。最低阶VEM的局部离散试探空间 $V_{h}(K)$ 由在 $K$ 上弱意义下调和的函数 $u_{h}$ 组成，且其在每条边 $e$ 上的迹是次数至多为1的多项式（分片线性）。自由度是 $K$ 的顶点处的节点值，并且在每条端点为 $i_{e}$ 和 $j_{e}$ 的边 $e$ 上，其迹是匹配这些节点自由度的唯一线性函数。\n\nVEM的局部能量双线性形式通过以下分解由精确单元双线性形式 $a^{K}(u,v) = \\int_{K} \\nabla u \\cdot \\nabla v \\, dx$ 构造：\n$$\na^{K}_{h}(u_{h}, v_{h}) = a^{K}\\big(\\Pi^{\\nabla}_{1} u_{h}, \\Pi^{\\nabla}_{1} v_{h}\\big) + S\\big(u_{h} - \\Pi^{\\nabla}_{1} u_{h}, \\, v_{h} - \\Pi^{\\nabla}_{1} v_{h}\\big),\n$$\n其中 $\\Pi^{\\nabla}_{1}: V_{h}(K) \\to \\mathbb{P}_{1}(K)$ 是到线性多项式空间上的多项式一致性投影算子，$S(\\cdot,\\cdot)$ 是一个稳定双线性形式，它在 $\\Pi^{\\nabla}_{1}$ 的核上是对称正定的，并且当其任一参数为 $\\mathbb{P}_{1}(K)$ 中的多项式时其值为零。\n\n从基本定义和 patch test (分片检验) 的多项式一致性要求（即精确重构线性场）出发，推导投影算子 $\\Pi^{\\nabla}_{1} u_{h}(x)$ 对于 $x \\in K$ 的显式闭式表达式，该表达式用以下各项表示：\n- 几何量 $\\{|K|, L_{K}, n_{e}, \\ell_{e}, m_{e}\\}_{e \\subset \\partial K}$，以及\n- 顶点自由度 $\\{u_{i}\\}$，通过边上的线性迹沿边组合。\n\n您必须仅使用边上的线性信息来计算边界积分；$u_{h}$ 的内部矩是不可用的。通过以下定义条件来施加该投影算子：\n- 能量正交性：对于所有 $q \\in \\mathbb{P}_{1}(K)$，$\\int_{K} \\nabla\\big(u_{h} - \\Pi^{\\nabla}_{1} u_{h}\\big) \\cdot \\nabla q \\, dx = 0$，\n- 平均边界值匹配：$\\int_{\\partial K} \\big(u_{h} - \\Pi^{\\nabla}_{1} u_{h}\\big) \\, ds = 0$。\n\n然后，对于精确线性场 $u(x) = a + b x + c y$（其中 $a, b, c \\in \\mathbb{R}$ 为常数），当 $u_{h}$ 是 $u$ 在 $K$ 上的VEM插值时，量化稳定项 $S(u_{h}, u_{h})$ 对 $a^{K}_{h}(u_{h}, u_{h})$ 的贡献。\n\n您的最终答案必须是一个包含两个元素的单行矩阵：在上述条件下推导并使用边上线性数据计算的 $\\Pi^{\\nabla}_{1} u_{h}(x)$ 的显式表达式，以及对于 $u(x) = a + b x + c y$ 时 $S(u_{h}, u_{h})$ 的精确值。无需四舍五入。最终答案必须是闭式解析表达式。",
            "solution": "该问题要求关于多边形单元 $K$ 上最低阶协调虚拟元法 (VEM) 的两个结果：首先，推导 $\\mathbb{P}_{1}$ 一致性投影算子 $\\Pi^{\\nabla}_{1}$ 的显式公式；其次，计算线性函数的稳定项。\n\n该问题陈述已经过验证，被认为是科学上合理的、适定的和客观的。它代表了VEM理论基础中的一个标准练习。我们可以开始求解。\n\n### 第一部分：投影算子 $\\Pi^{\\nabla}_{1} u_{h}$ 的推导\n\n投影 $\\Pi^{\\nabla}_{1} u_{h}$ 是 $\\mathbb{P}_{1}(K)$ 中的一个线性多项式。设 $x = (x, y)$ 表示 $\\mathbb{R}^{2}$ 中的空间坐标。我们可以将 $\\Pi^{\\nabla}_{1} u_h$ 写为：\n$$\np(x,y) = \\Pi^{\\nabla}_{1} u_{h}(x,y) = c_{0} + c_{1}x + c_{2}y\n$$\n其中系数 $c_{0}, c_{1}, c_{2} \\in \\mathbb{R}$ 有待确定。该投影算子的定义条件已给出。\n\n**条件1：能量正交性**\n第一个条件指出，在由双线性形式 $a^{K}(\\cdot, \\cdot)$ 导出的半范数意义下，投影误差与 $\\mathbb{P}_{1}(K)$ 正交。\n$$\n\\int_{K} \\nabla\\big(u_{h} - \\Pi^{\\nabla}_{1} u_{h}\\big) \\cdot \\nabla q \\, dx = 0 \\quad \\forall q \\in \\mathbb{P}_{1}(K)\n$$\n这等价于：\n$$\n\\int_{K} \\nabla u_{h} \\cdot \\nabla q \\, dx = \\int_{K} \\nabla(\\Pi^{\\nabla}_{1} u_{h}) \\cdot \\nabla q \\, dx \\quad \\forall q \\in \\mathbb{P}_{1}(K)\n$$\n空间 $\\mathbb{P}_{1}(K)$ 由基函数 $\\{1, x, y\\}$ 张成。用 $q=1$ 测试得到一个平凡的恒等式，因为 $\\nabla(1) = 0$。我们用 $q=x$ 和 $q=y$ 进行测试。\n投影算子的梯度为 $\\nabla p = (c_{1}, c_{2})^{T}$。\n\n对于 $q(x,y) = x$，我们有 $\\nabla q = (1, 0)^{T}$。右侧变为：\n$$\n\\int_{K} \\nabla p \\cdot (1, 0)^{T} \\, dx = \\int_{K} c_{1} \\, dx = c_{1} |K|\n$$\n对于 $q(x,y) = y$，我们有 $\\nabla q = (0, 1)^{T}$。右侧变为：\n$$\n\\int_{K} \\nabla p \\cdot (0, 1)^{T} \\, dx = \\int_{K} c_{2} \\, dx = c_{2} |K|\n$$\n左侧的积分涉及 $u_{h}$，我们只知道它的边界值及其在 $K$ 上是调和函数的性质。我们使用格林第一恒等式。对于一个向量场 $F$ 和一个标量场 $\\phi$，$\\int_K F \\cdot \\nabla \\phi \\, dx = \\int_{\\partial K} \\phi (F \\cdot n) \\, ds - \\int_K \\phi (\\nabla \\cdot F) \\, dx$。或者，更直接地，对于标量场 $u$ 和 $v$，其中 $v$ 是调和的（$\\Delta v = 0$）：\n$$\n\\int_{K} \\nabla u \\cdot \\nabla v \\, dx = \\int_{\\partial K} u (\\nabla v \\cdot n) \\, ds\n$$\n由于任何 $q \\in \\mathbb{P}_{1}(K)$ 都是调和的（$\\Delta q = 0$），此恒等式适用。\n对于 $q=x$，$\\nabla q \\cdot n = (1, 0)^{T} \\cdot (n_{x}, n_{y})^{T} = n_{x}$。\n对于 $q=y$，$\\nabla q \\cdot n = (0, 1)^{T} \\cdot (n_{x}, n_{y})^{T} = n_{y}$。\n因此，我们有：\n$$\n\\int_{K} \\nabla u_{h} \\cdot \\nabla x \\, dx = \\int_{\\partial K} u_{h} n_{x} \\, ds\n$$\n$$\n\\int_{K} \\nabla u_{h} \\cdot \\nabla y \\, dx = \\int_{\\partial K} u_{h} n_{y} \\, ds\n$$\n通过令等式左右两边的表达式相等，我们求得系数 $c_{1}$ 和 $c_{2}$：\n$$\nc_{1} = \\frac{1}{|K|} \\int_{\\partial K} u_{h} n_{x} \\, ds \\quad \\text{和} \\quad c_{2} = \\frac{1}{|K|} \\int_{\\partial K} u_{h} n_{y} \\, ds\n$$\n边界积分 $\\int_{\\partial K}$ 是多边形各边 $e$ 上积分的总和。在每条边 $e$ 上，单位外法向量 $n_{e} = (n_{e,x}, n_{e,y})^{T}$ 是常数。$u_{h}$ 在 $e$ 上的迹是由边端点处的节点值 $u_{i_{e}}$ 和 $u_{j_{e}}$ 决定的线性函数。一个线性函数在边上的积分等于其边长 $\\ell_{e}$ 乘以其在中点 $m_{e}$ 处的值。设 $u_{h}(m_{e})$ 表示这个值，它就是端点值的平均值：$u_{h}(m_{e}) = \\frac{1}{2}(u_{i_{e}} + u_{j_{e}})$。\n$$\n\\int_{e} u_{h} \\, ds = \\ell_{e} u_{h}(m_{e})\n$$\n因此，系数变为：\n$$\nc_{1} = \\frac{1}{|K|} \\sum_{e \\subset \\partial K} \\int_{e} u_{h} n_{e,x} \\, ds = \\frac{1}{|K|} \\sum_{e \\subset \\partial K} n_{e,x} \\ell_{e} u_{h}(m_{e})\n$$\n$$\nc_{2} = \\frac{1}{|K|} \\sum_{e \\subset \\partial K} \\int_{e} u_{h} n_{e,y} \\, ds = \\frac{1}{|K|} \\sum_{e \\subset \\partial K} n_{e,y} \\ell_{e} u_{h}(m_{e})\n$$\n用向量形式表示，投影算子的梯度为：\n$$\n\\nabla(\\Pi^{\\nabla}_{1} u_{h}) = (c_{1}, c_{2})^{T} = \\frac{1}{|K|} \\sum_{e \\subset \\partial K} \\ell_{e} u_{h}(m_{e}) n_{e}\n$$\n\n**条件2：平均边界值匹配**\n第二个条件用于确定常数项 $c_{0}$：\n$$\n\\int_{\\partial K} \\big(u_{h} - \\Pi^{\\nabla}_{1} u_{h}\\big) \\, ds = 0 \\quad \\implies \\quad \\int_{\\partial K} u_{h} \\, ds = \\int_{\\partial K} \\Pi^{\\nabla}_{1} u_{h} \\, ds\n$$\n我们计算等式两边。左侧为：\n$$\n\\int_{\\partial K} u_{h} \\, ds = \\sum_{e \\subset \\partial K} \\int_{e} u_{h} \\, ds = \\sum_{e \\subset \\partial K} \\ell_{e} u_{h}(m_{e})\n$$\n右侧涉及多项式 $p(x,y) = c_{0} + c_{1}x + c_{2}y$ 的积分：\n$$\n\\int_{\\partial K} p(x,y) \\, ds = \\int_{\\partial K} (c_{0} + c_{1}x + c_{2}y) \\, ds = c_{0} \\int_{\\partial K} ds + c_{1} \\int_{\\partial K} x \\, ds + c_{2} \\int_{\\partial K} y \\, ds\n$$\n这些积分被计算为边积分的和：\n$\\int_{\\partial K} ds = \\sum_{e} \\ell_{e} = L_{K}$，即周长。\n$\\int_{\\partial K} x \\, ds = \\sum_{e} \\int_{e} x \\, ds = \\sum_{e} \\ell_{e} x_{m,e}$，其中 $m_{e}=(x_{m,e}, y_{m,e})$ 是边 $e$ 的中点。\n$\\int_{\\partial K} y \\, ds = \\sum_{e} \\int_{e} y \\, ds = \\sum_{e} \\ell_{e} y_{m,e}$。\n令两边相等，得到：\n$$\n\\sum_{e \\subset \\partial K} \\ell_{e} u_{h}(m_{e}) = c_{0}L_{K} + c_{1} \\sum_{e \\subset \\partial K} \\ell_{e} x_{m,e} + c_{2} \\sum_{e \\subset \\partial K} \\ell_{e} y_{m,e}\n$$\n求解 $c_{0}$：\n$$\nc_{0} = \\frac{1}{L_{K}} \\left( \\sum_{e \\subset \\partial K} \\ell_{e} u_{h}(m_{e}) - \\left( c_{1} \\sum_{e \\subset \\partial K} \\ell_{e} x_{m,e} + c_{2} \\sum_{e \\subset \\partial K} \\ell_{e} y_{m,e} \\right) \\right)\n$$\n这可以用向量符号更紧凑地写出：\n$$\nc_{0} = \\frac{1}{L_{K}} \\sum_{e \\subset \\partial K} \\ell_{e} u_{h}(m_{e}) - \\nabla(\\Pi^{\\nabla}_{1} u_{h}) \\cdot \\left( \\frac{1}{L_{K}} \\sum_{e \\subset \\partial K} \\ell_{e} m_{e} \\right)\n$$\n\n**$\\Pi^{\\nabla}_{1} u_{h}$ 的最终表达式**\n结合 $c_0, c_1, c_2$ 的表达式，我们得到在点 $x \\in K$ 处求值的投影算子的最终形式：\n$$\n\\Pi^{\\nabla}_{1} u_{h}(x) = c_{0} + \\nabla(\\Pi^{\\nabla}_{1} u_{h}) \\cdot x = \\frac{1}{L_{K}} \\sum_{e' \\subset \\partial K} \\ell_{e'} u_{h}(m_{e'}) + \\nabla(\\Pi^{\\nabla}_{1} u_{h}) \\cdot \\left( x - \\frac{1}{L_{K}} \\sum_{e'' \\subset \\partial K} \\ell_{e''} m_{e''} \\right)\n$$\n代入梯度的表达式并展开项 $u_{h}(m_{e})$：\n$$\n\\Pi^{\\nabla}_{1} u_{h}(x) = \\frac{1}{L_{K}}\\sum_{e' \\subset \\partial K} \\ell_{e'} \\left(\\frac{u_{i_{e'}} + u_{j_{e'}}}{2}\\right) + \\left(\\frac{1}{|K|} \\sum_{e \\subset \\partial K} n_{e} \\ell_{e} \\left(\\frac{u_{i_{e}} + u_{j_{e}}}{2}\\right)\\right) \\cdot \\left(x - \\frac{1}{L_{K}}\\sum_{e'' \\subset \\partial K} \\ell_{e''} m_{e''}\\right)\n$$\n这就是投影算子的显式闭式表达式。\n\n### 第二部分：稳定项的贡献\n\n第二个任务是量化对于一个精确线性场 $u(x,y) = a + bx + cy$（其中 $a, b, c$ 为实常数），稳定项的贡献。设 $u_{h}$ 是 $u$ 在单元 $K$ 上的VEM插值。\n\n对于最低阶VEM，自由度是单元顶点处的函数值。因此，VEM插值 $u_{h} \\in V_{h}(K)$ 是满足以下条件的函数：\n1. $u_{h}$ 在 $K$ 上是调和的。\n2. 对于 $K$ 的每个顶点 $v_{i}$，都有 $u_{h}(v_{i}) = u(v_{i})$。\n\n由于 $u(x,y) = a + bx + cy$ 是一个线性多项式，它是一个调和函数，即 $\\Delta u = 0$。根据VEM空间的定义，$u_{h}$ 在任何边 $e$ （连接顶点 $v_{i}$ 和 $v_{j}$）上的迹是插值顶点值 $u_{h}(v_{i}) = u(v_{i})$ 和 $u_{h}(v_{j}) = u(v_{j})$ 的唯一线性函数。函数 $u(x,y)$ 本身是线性的，并且在该边上插值这些值。根据唯一性，$u_{h}$ 在每条边上的迹都与 $u$ 的迹相同。因此，$u_{h}|_{\\partial K} = u|_{\\partial K}$。\n\n我们现在有两个函数 $u_{h}$ 和 $u$，它们都在区域 $K$ 内是调和的，并且在边界 $\\partial K$ 上具有相同的值。根据拉普拉斯方程狄利克雷问题的唯一性定理，这两个函数在整个区域 $K$ 内必须完全相同。因此，对于所有 $x \\in K$，$u_{h}(x) = u(x)$。\n\n这意味着线性多项式的VEM插值就是该多项式本身。所以，$u_{h}$ 是 $\\mathbb{P}_{1}(K)$ 的一个元素。\n\n接下来，我们必须计算应用于 $u_{h} = u \\in \\mathbb{P}_{1}(K)$ 的投影算子 $\\Pi^{\\nabla}_{1}$。该投影算子被定义为与 $\\mathbb{P}_{1}(K)$ 中的多项式一致。我们可以从其定义条件中验证这一点。如果我们设 $u_{h} = p \\in \\mathbb{P}_{1}(K)$ 并测试候选投影 $\\Pi^{\\nabla}_{1} p = p$，我们发现：\n1. 对于所有 $q \\in \\mathbb{P}_{1}(K)$，$\\int_{K} \\nabla(p-p) \\cdot \\nabla q \\, dx = 0$。\n2. $\\int_{\\partial K} (p-p) \\, ds = 0$。\n两个条件都显然满足。由于投影算子是唯一的，所以对于任何 $p \\in \\mathbb{P}_{1}(K)$，必然有 $\\Pi^{\\nabla}_{1} p = p$。\n这就是问题陈述中提到的“多项式一致性”属性，它是通过 patch test (分片检验) 的一个关键特征。\n\n在我们的例子中，$u_{h}(x) = u(x) \\in \\mathbb{P}_{1}(K)$，所以 $\\Pi^{\\nabla}_{1} u_{h} = u_{h}$。\n\n稳定项对能量 $a^{K}_{h}(u_{h}, u_{h})$ 的贡献由项 $S(u_{h} - \\Pi^{\\nabla}_{1} u_{h}, u_{h} - \\Pi^{\\nabla}_{1} u_{h})$ 给出。\n代入我们的结果：\n$$\nu_{h} - \\Pi^{\\nabla}_{1} u_{h} = u_{h} - u_{h} = 0\n$$\n因此，稳定项为：\n$$\nS(0, 0)\n$$\n由于 $S(\\cdot, \\cdot)$ 是一个双线性形式，它必须满足 $S(0, 0) = 0$。\n\n因此，对于任何线性场 $u$，其VEM插值 $u_{h}$ 的稳定项恰好为零。这证实了该方法能精确地重现线性解的能量，正如 patch test (分片检验) 所要求的那样。问题文本中存在一个轻微的不精确之处，它将该项称为“$S(u_h, u_h)$”，而加到能量中的稳定项实际上是 $S(u_h - \\Pi^\\nabla_1 u_h, u_h - \\Pi^\\nabla_1 u_h)$。我们的分析处理的是后者，它代表了实际的贡献。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{L_{K}}\\sum\\limits_{e' \\subset \\partial K} \\ell_{e'} \\left(\\frac{u_{i_{e'}} + u_{j_{e'}}}{2}\\right) + \\left(\\frac{1}{|K|} \\sum\\limits_{e \\subset \\partial K} n_{e} \\ell_{e} \\left(\\frac{u_{i_{e}} + u_{j_{e}}}{2}\\right)\\right) \\cdot \\left(x - \\frac{1}{L_{K}}\\sum\\limits_{e'' \\subset \\partial K} \\ell_{e''} m_{e''}\\right) & 0 \\end{pmatrix}}\n$$"
        }
    ]
}