{
    "hands_on_practices": [
        {
            "introduction": "任何有限元类方法都始于在单元上定义局部函数空间。虚拟单元法（VEM）的独特之处在于，这个空间不是由显式基函数定义的，而是通过其性质和自由度（DoFs）来定义。这项练习是基础的第一步，通过明确地计算自由度，您将具体理解 VEM 空间是如何构建的，以及需要哪些信息来唯一地确定这个抽象空间中的函数。",
            "id": "3461335",
            "problem": "考虑一个单连通多边形单元 $E \\subset \\mathbb{R}^{2}$，它有 $n_{E}$ 条直边，因此也有 $n_{E}$ 个顶点。该单元用于求解一个二阶椭圆型偏微分方程，采用的是多项式次数为 $k \\ge 2$ 的协调虚单元法 (VEM)。单元 $E$ 上的局部试验空间被设计为满足：(i) 在每条边上的迹都位于次数至多为 $k$ 的多项式空间中，以及 (ii) 该空间包含单元 $E$ 上所有总次数至多为 $k$ 的多项式。单元 $E$ 上的典则自由度定义如下：\n- 顶点值：函数在每个多边形顶点处的逐点求值。\n- 次数至多为 $k-2$ 的边矩：对于每条边 $e \\subset \\partial E$，函数与 $e$ 上所有总次数至多为 $k-2$ 的单项式的线积分。\n- 次数至多为 $k-2$ 的内部矩：在 $E$ 上，函数与 $E$ 上所有总次数至多为 $k-2$ 的单项式的面积分。\n\n从一维线段和二维域上多项式空间的结构和维度的第一性原理出发，枚举这些类别的自由度，并推导出一个关于 $k$ 和 $n_E$ 的封闭形式表达式，用于表示 $E$ 上局部独立自由度的总数。你的最终答案必须是单个关于 $k$ 和 $n_E$ 的封闭形式解析表达式。",
            "solution": "该问题要求计算在一个多边形单元 $E$ 上，特定虚单元法 (VEM) 构造的局部独立自由度 (DoFs) 的总数。问题陈述是有效的，在偏微分方程数值方法的理论中有科学依据，并且是适定的。因此，我们可以进行系统的推导。\n\n我们记自由度的总数为 $N_{DoF}$，它是问题中定义的三类自由度数量之和：\n1.  顶点值 ($N_{vertex}$)。\n2.  边矩 ($N_{edge}$)。\n3.  内部矩 ($N_{internal}$)。\n\n因此，我们有如下关系：\n$$N_{DoF} = N_{vertex} + N_{edge} + N_{internal}$$\n\n现在，我们将基于关于多项式空间维度的第一性原理，为每一类自由度的数量推导表达式。\n\n**1. 顶点自由度的计数 ($N_{vertex}$)**\n\n问题将这些自由度定义为“函数在每个多边形顶点处的逐点求值”。一个具有 $n_E$ 条边的多边形单元 $E$ 由其 $n_E$ 个顶点定义。由于每个顶点提供单个自由度（函数在该点的值），顶点自由度的总数就等于顶点的数量。\n$$N_{vertex} = n_E$$\n\n**2. 边自由度的计数 ($N_{edge}$)**\n\n这些自由度被定义为“对于每条边 $e \\subset \\partial E$，函数与 $e$ 上所有总次数至多为 $k-2$ 的单项式的线积分”。\n\n我们考虑单条直边 $e$。一条边是一个一维域。我们可以在这条边上建立一个局部坐标系，例如，使用一个沿其长度变化的变量 $s$。这条边上的一个单项式形式为 $s^j$，其中 $j$ 是表示次数的非负整数。\n\n问题指定使用所有总次数至多为 $k-2$ 的单项式。对于一维域，这对应于单项式集合 $\\{s^0, s^1, s^2, \\dots, s^{k-2}\\}$。这类单项式的数量是一维线段上次数至多为 $k-2$ 的多项式空间的维度，我们记作 $\\mathcal{P}_{k-2}(e)$。该维度由最高次数加一给出。\n$$\\text{每条边的单项式数量} = \\dim(\\mathcal{P}_{k-2}(e)) = (k-2) + 1 = k-1$$\n这个计数是有效的，因为问题陈述了 $k \\ge 2$，这确保了最大次数 $k-2$ 是非负的。\n\n由于多边形 $E$ 的边界上有 $n_E$ 条边，每条边贡献 $k-1$ 个自由度，所以边自由度的总数是其乘积：\n$$N_{edge} = n_E \\times (k-1)$$\n\n**3. 内部自由度的计数 ($N_{internal}$)**\n\n这些自由度被定义为“在 $E$ 上，函数与 $E$ 上所有总次数至多为 $k-2$ 的单项式的面积分”。\n\n单元 $E$ 是 $\\mathbb{R}^2$ 中的一个二维域。一个二元（比如 $x$ 和 $y$）单项式的形式为 $x^i y^j$，其中 $i$ 和 $j$ 是非负整数。该单项式的总次数是 $i+j$。\n\n我们需要计算总次数至多为 $k-2$ 的这类单项式的数量。这等价于求二元总次数至多为 $k-2$ 的多项式空间的维度，记作 $\\mathcal{P}_{k-2}(E)$。一个 $m$ 元次数至多为 $d$ 的多项式空间的维度由公式 $\\binom{m+d}{m}$ 给出。\n\n在我们的情况下，变量数为 $m=2$，最大次数为 $d=k-2$。将这些值代入公式，我们得到：\n$$N_{internal} = \\dim(\\mathcal{P}_{k-2}(E)) = \\binom{2 + (k-2)}{2} = \\binom{k}{2}$$\n使用二项式系数的定义 $\\binom{n}{r} = \\frac{n!}{r!(n-r)!}$，我们可以将其写为：\n$$N_{internal} = \\frac{k(k-1)}{2 \\cdot 1} = \\frac{k(k-1)}{2}$$\n这对 $k \\ge 2$ 是有效的。如果 $k=2$，次数至多为0，因此只有一个单项式（常数1），该公式正确地给出 $\\binom{2}{2} = 1$。\n\n**4. 自由度总数 ($N_{DoF}$)**\n\n最后，我们将这三类的计数相加，得到单元 $E$ 上局部自由度的总数。\n$$N_{DoF} = N_{vertex} + N_{edge} + N_{internal}$$\n代入我们推导出的表达式：\n$$N_{DoF} = n_E + n_E(k-1) + \\frac{k(k-1)}{2}$$\n我们可以简化这个表达式：\n$$N_{DoF} = n_E + n_E k - n_E + \\frac{k(k-1)}{2}$$\n$$N_{DoF} = n_E k + \\frac{k(k-1)}{2}$$\n这就是单元 $E$ 上局部独立自由度总数的封闭形式表达式，用顶点数 $n_E$ 和多项式次数 $k$ 表示。这些自由度的独立性是 VEM 构造的基石，它确保了这些自由度能够唯一确定局部 VEM 空间中的一个函数，而该空间的维度恰好是 $N_{DoF}$。",
            "answer": "$$\\boxed{n_E k + \\frac{k(k-1)}{2}}$$"
        },
        {
            "introduction": "虚拟单元法的一个关键挑战是，由于缺乏显式基函数，我们无法直接计算刚度矩阵。解决方案是将能量计算分解为一个可计算的“相容性”部分和一个“稳定性”部分。这项练习深入探讨了这种分解的核心。通过推导能量投影算子 $\\Pi^{\\nabla}$ 并验证对于线性多项式，稳定项为零，您将直接接触到“补片测试”的机制，这是保证收敛性的一个关键条件。",
            "id": "3456377",
            "problem": "考虑在单个多边形单元 $K \\subset \\mathbb{R}^{2}$ 上的模型椭圆型偏微分方程 (PDE) 的最低阶协调虚拟元法 (VEM)，其中 $K$ 是一个关于球的任意星形多边形。设 $K$ 的边界 $\\partial K$ 由直边 $e$ 组成，其单位外法向量为 $n_{e}$，边长为 $\\ell_{e}$，边的中点为 $m_{e} \\in \\mathbb{R}^{2}$。将 $K$ 的面积记为 $|K|$，周长记为 $L_{K} = \\sum_{e \\subset \\partial K} \\ell_{e}$。最低阶VEM的局部离散试验空间 $V_{h}(K)$ 由在 $K$ 上弱调和的函数 $u_{h}$ 组成，其在每条边 $e$ 上的迹是次数最多为 $1$ 的多项式（分片线性）。自由度是 $K$ 的顶点上的节点值，并且沿着每条以 $i_{e}$ 和 $j_{e}$ 为端点顶点的边 $e$，其迹是匹配这些节点自由度的唯一线性函数。\n\nVEM的局部能量双线性形式是通过以下分解，由精确单元双线性形式 $a^{K}(u,v) = \\int_{K} \\nabla u \\cdot \\nabla v \\, \\mathrm{d}x$ 构造而成的：\n$$\na^{K}_{h}(u_{h}, v_{h}) = a^{K}\\big(\\Pi^{\\nabla}_{1} u_{h}, \\Pi^{\\nabla}_{1} v_{h}\\big) + S\\big(u_{h} - \\Pi^{\\nabla}_{1} u_{h}, \\, v_{h} - \\Pi^{\\nabla}_{1} v_{h}\\big),\n$$\n其中 $\\Pi^{\\nabla}_{1}: V_{h}(K) \\to \\mathbb{P}_{1}(K)$ 是到线性多项式空间上的多项式协调性投影算子，而 $S(\\cdot,\\cdot)$ 是一个稳定双线性形式，它在 $\\Pi^{\\nabla}_{1}$ 的核上是对称、正定的，并且当其参数在 $\\mathbb{P}_{1}(K)$ 中时，其在 $\\mathbb{P}_{1}(K)$ 上为零。\n\n从基本定义和补片检验的多项式协调性要求（即，精确再现线性场）出发，推导投影算子 $\\Pi^{\\nabla}_{1} u_{h}(x)$（对于 $x \\in K$）的显式闭式表达式，该表达式用以下各项表示：\n- 几何量 $\\{|K|, L_{K}, n_{e}, \\ell_{e}, m_{e}\\}_{e \\subset \\partial K}$，以及\n- 通过逐边线性迹组合的顶点自由度 $\\{u_{i}\\}$。\n\n您必须仅使用逐边的线性信息来计算边界积分；$u_{h}$ 的内部矩是不可用的。通过以下定义条件来确定投影算子：\n- 能量正交性：对于所有 $q \\in \\mathbb{P}_{1}(K)$，$\\int_{K} \\nabla\\big(u_{h} - \\Pi^{\\nabla}_{1} u_{h}\\big) \\cdot \\nabla q \\, \\mathrm{d}x = 0$，\n- 边界平均值匹配：$\\int_{\\partial K} \\big(u_{h} - \\Pi^{\\nabla}_{1} u_{h}\\big) \\, \\mathrm{d}s = 0$。\n\n然后，对于一个精确的线性场 $u(x) = a + b x + c y$（其中常数 $a, b, c \\in \\mathbb{R}$），当 $u_{h}$ 是 $u$ 在 $K$ 上的VEM插值时，计算稳定项对离散能量的贡献，即 $S(u_{h} - \\Pi^{\\nabla}_{1} u_{h}, u_{h} - \\Pi^{\\nabla}_{1} u_{h})$ 的值。\n\n您的最终答案必须是一个包含两个元素的单行矩阵：在上述条件下推导并使用逐边线性数据计算出的 $\\Pi^{\\nabla}_{1} u_{h}(x)$ 的显式表达式，以及对于 $u(x) = a + b x + c y$ 时 $S(u_{h} - \\Pi^{\\nabla}_{1} u_{h}, u_{h} - \\Pi^{\\nabla}_{1} u_{h})$ 的精确值。无需四舍五入。最终答案必须是闭式解析表达式。",
            "solution": "该问题要求得到关于多边形单元 $K$ 上最低阶协调虚拟元法 (VEM) 的两个结果：首先，推导 $\\mathbb{P}_{1}$ 协调性投影算子 $\\Pi^{\\nabla}_{1}$ 的显式公式；其次，计算线性函数的稳定项。\n\n问题陈述已经过验证，被认为是科学合理的、适定的和客观的。它代表了VEM理论基础中的一个标准练习。我们可以开始求解。\n\n### 第1部分：投影算子 $\\Pi^{\\nabla}_{1} u_{h}$ 的推导\n\n投影 $\\Pi^{\\nabla}_{1} u_{h}$ 是 $\\mathbb{P}_{1}(K)$ 中的一个线性多项式。令 $x = (x, y)$ 表示 $\\mathbb{R}^{2}$ 中的空间坐标。我们可以将 $\\Pi^{\\nabla}_{1} u_h$ 写为：\n$$\np(x,y) = \\Pi^{\\nabla}_{1} u_{h}(x,y) = c_{0} + c_{1}x + c_{2}y\n$$\n其中系数 $c_{0}, c_{1}, c_{2} \\in \\mathbb{R}$ 是待定的。该投影算子的定义条件已给出。\n\n**条件1：能量正交性**\n第一个条件指出，在由双线性形式 $a^{K}(\\cdot, \\cdot)$ 诱导的半范数意义下，投影误差与 $\\mathbb{P}_{1}(K)$ 正交。\n$$\n\\int_{K} \\nabla\\big(u_{h} - \\Pi^{\\nabla}_{1} u_{h}\\big) \\cdot \\nabla q \\, \\mathrm{d}x = 0 \\quad \\forall q \\in \\mathbb{P}_{1}(K)\n$$\n这等价于：\n$$\n\\int_{K} \\nabla u_{h} \\cdot \\nabla q \\, \\mathrm{d}x = \\int_{K} \\nabla(\\Pi^{\\nabla}_{1} u_{h}) \\cdot \\nabla q \\, \\mathrm{d}x \\quad \\forall q \\in \\mathbb{P}_{1}(K)\n$$\n空间 $\\mathbb{P}_{1}(K)$ 由基函数 $\\{1, x, y\\}$ 张成。用 $q=1$ 进行测试会得到一个平凡的恒等式，因为 $\\nabla(1) = 0$。我们用 $q=x$ 和 $q=y$ 进行测试。\n投影算子的梯度为 $\\nabla p = (c_{1}, c_{2})^{T}$。\n\n对于 $q(x,y) = x$，我们有 $\\nabla q = (1, 0)^{T}$。右侧变为：\n$$\n\\int_{K} \\nabla p \\cdot (1, 0)^{T} \\, \\mathrm{d}x = \\int_{K} c_{1} \\, \\mathrm{d}x = c_{1} |K|\n$$\n对于 $q(x,y) = y$，我们有 $\\nabla q = (0, 1)^{T}$。右侧变为：\n$$\n\\int_{K} \\nabla p \\cdot (0, 1)^{T} \\, \\mathrm{d}x = \\int_{K} c_{2} \\, \\mathrm{d}x = c_{2} |K|\n$$\n左侧的积分涉及 $u_{h}$，而 $u_{h}$ 仅通过其边界值和在 $K$ 上是调和函数这一性质而为人所知。我们使用格林第一恒等式。对于一个向量场 $F$ 和一个标量场 $\\phi$，$\\int_K F \\cdot \\nabla \\phi \\, \\mathrm{d}x = \\int_{\\partial K} \\phi (F \\cdot n) \\, \\mathrm{d}s - \\int_K \\phi (\\nabla \\cdot F) \\, \\mathrm{d}x$。或者，更直接地，对于标量场 $u$ 和 $v$，其中 $v$ 是调和的（$\\Delta v = 0$）：\n$$\n\\int_{K} \\nabla u \\cdot \\nabla v \\, \\mathrm{d}x = \\int_{\\partial K} u (\\nabla v \\cdot n) \\, \\mathrm{d}s\n$$\n由于任何 $q \\in \\mathbb{P}_{1}(K)$ 都是调和的（$\\Delta q = 0$），该恒等式适用。\n对于 $q=x$，$\\nabla q \\cdot n = (1, 0)^{T} \\cdot (n_{x}, n_{y})^{T} = n_{x}$。\n对于 $q=y$，$\\nabla q \\cdot n = (0, 1)^{T} \\cdot (n_{x}, n_{y})^{T} = n_{y}$。\n因此，我们有：\n$$\n\\int_{K} \\nabla u_{h} \\cdot \\nabla x \\, \\mathrm{d}x = \\int_{\\partial K} u_{h} n_{x} \\, \\mathrm{d}s\n$$\n$$\n\\int_{K} \\nabla u_{h} \\cdot \\nabla y \\, \\mathrm{d}x = \\int_{\\partial K} u_{h} n_{y} \\, \\mathrm{d}s\n$$\n将左侧和右侧的表达式相等，我们求得系数 $c_{1}$ 和 $c_{2}$：\n$$\nc_{1} = \\frac{1}{|K|} \\int_{\\partial K} u_{h} n_{x} \\, \\mathrm{d}s \\quad \\text{和} \\quad c_{2} = \\frac{1}{|K|} \\int_{\\partial K} u_{h} n_{y} \\, \\mathrm{d}s\n$$\n边界积分 $\\int_{\\partial K}$ 是多边形各边 $e$ 上积分的总和。在每条边 $e$ 上，单位外法向量 $n_{e} = (n_{e,x}, n_{e,y})^{T}$ 是常数。$u_{h}$ 在 $e$ 上的迹是一个由该边端点节点值 $u_{i_{e}}$ 和 $u_{j_{e}}$ 决定的线性函数。一个线性函数在边上的积分等于其长度 $\\ell_{e}$ 乘以其在中点 $m_{e}$ 处的值。令 $u_{h}(m_{e})$ 表示此值，它就是端点值的平均值：$u_{h}(m_{e}) = \\frac{1}{2}(u_{i_{e}} + u_{j_{e}})$。\n$$\n\\int_{e} u_{h} \\, \\mathrm{d}s = \\ell_{e} u_{h}(m_{e})\n$$\n所以，系数变为：\n$$\nc_{1} = \\frac{1}{|K|} \\sum_{e \\subset \\partial K} \\int_{e} u_{h} n_{e,x} \\, \\mathrm{d}s = \\frac{1}{|K|} \\sum_{e \\subset \\partial K} n_{e,x} \\ell_{e} u_{h}(m_{e})\n$$\n$$\nc_{2} = \\frac{1}{|K|} \\sum_{e \\subset \\partial K} \\int_{e} u_{h} n_{e,y} \\, \\mathrm{d}s = \\frac{1}{|K|} \\sum_{e \\subset \\partial K} n_{e,y} \\ell_{e} u_{h}(m_{e})\n$$\n以向量形式表示，投影算子的梯度为：\n$$\n\\nabla(\\Pi^{\\nabla}_{1} u_{h}) = (c_{1}, c_{2})^{T} = \\frac{1}{|K|} \\sum_{e \\subset \\partial K} \\ell_{e} u_{h}(m_{e}) n_{e}\n$$\n\n**条件2：边界平均值匹配**\n第二个条件用于确定常数项 $c_{0}$：\n$$\n\\int_{\\partial K} \\big(u_{h} - \\Pi^{\\nabla}_{1} u_{h}\\big) \\, \\mathrm{d}s = 0 \\quad \\implies \\quad \\int_{\\partial K} u_{h} \\, \\mathrm{d}s = \\int_{\\partial K} \\Pi^{\\nabla}_{1} u_{h} \\, \\mathrm{d}s\n$$\n我们计算等式两边。左侧是：\n$$\n\\int_{\\partial K} u_{h} \\, \\mathrm{d}s = \\sum_{e \\subset \\partial K} \\int_{e} u_{h} \\, \\mathrm{d}s = \\sum_{e \\subset \\partial K} \\ell_{e} u_{h}(m_{e})\n$$\n右侧涉及多项式 $p(x,y) = c_{0} + c_{1}x + c_{2}y$ 的积分：\n$$\n\\int_{\\partial K} p(x,y) \\, \\mathrm{d}s = \\int_{\\partial K} (c_{0} + c_{1}x + c_{2}y) \\, \\mathrm{d}s = c_{0} \\int_{\\partial K} \\mathrm{d}s + c_{1} \\int_{\\partial K} x \\, \\mathrm{d}s + c_{2} \\int_{\\partial K} y \\, \\mathrm{d}s\n$$\n这些积分被计算为边积分之和：\n$\\int_{\\partial K} \\mathrm{d}s = \\sum_{e} \\ell_{e} = L_{K}$，即周长。\n$\\int_{\\partial K} x \\, \\mathrm{d}s = \\sum_{e} \\int_{e} x \\, \\mathrm{d}s = \\sum_{e} \\ell_{e} x_{m,e}$，其中 $m_{e}=(x_{m,e}, y_{m,e})$ 是边 $e$ 的中点。\n$\\int_{\\partial K} y \\, \\mathrm{d}s = \\sum_{e} \\int_{e} y \\, \\mathrm{d}s = \\sum_{e} \\ell_{e} y_{m,e}$。\n令两边相等得到：\n$$\n\\sum_{e \\subset \\partial K} \\ell_{e} u_{h}(m_{e}) = c_{0}L_{K} + c_{1} \\sum_{e \\subset \\partial K} \\ell_{e} x_{m,e} + c_{2} \\sum_{e \\subset \\partial K} \\ell_{e} y_{m,e}\n$$\n求解 $c_{0}$：\n$$\nc_{0} = \\frac{1}{L_{K}} \\left( \\sum_{e \\subset \\partial K} \\ell_{e} u_{h}(m_{e}) - \\left( c_{1} \\sum_{e \\subset \\partial K} \\ell_{e} x_{m,e} + c_{2} \\sum_{e \\subset \\partial K} \\ell_{e} y_{m,e} \\right) \\right)\n$$\n使用向量符号可以更紧凑地写成：\n$$\nc_{0} = \\frac{1}{L_{K}} \\sum_{e \\subset \\partial K} \\ell_{e} u_{h}(m_{e}) - \\nabla(\\Pi^{\\nabla}_{1} u_{h}) \\cdot \\left( \\frac{1}{L_{K}} \\sum_{e \\subset \\partial K} \\ell_{e} m_{e} \\right)\n$$\n\n**$\\Pi^{\\nabla}_{1} u_{h}$ 的最终表达式**\n结合 $c_0, c_1, c_2$ 的表达式，我们得到投影算子在点 $x \\in K$ 处的最终形式：\n$$\n\\Pi^{\\nabla}_{1} u_{h}(x) = c_{0} + \\nabla(\\Pi^{\\nabla}_{1} u_{h}) \\cdot x = \\frac{1}{L_{K}} \\sum_{e' \\subset \\partial K} \\ell_{e'} u_{h}(m_{e'}) + \\nabla(\\Pi^{\\nabla}_{1} u_{h}) \\cdot \\left( x - \\frac{1}{L_{K}} \\sum_{e'' \\subset \\partial K} \\ell_{e''} m_{e''} \\right)\n$$\n代入梯度的表达式并展开项 $u_{h}(m_{e})$：\n$$\n\\Pi^{\\nabla}_{1} u_{h}(x) = \\frac{1}{L_{K}}\\sum_{e' \\subset \\partial K} \\ell_{e'} \\left(\\frac{u_{i_{e'}} + u_{j_{e'}}}{2}\\right) + \\left(\\frac{1}{|K|} \\sum_{e \\subset \\partial K} n_{e} \\ell_{e} \\left(\\frac{u_{i_{e}} + u_{j_{e}}}{2}\\right)\\right) \\cdot \\left(x - \\frac{1}{L_{K}}\\sum_{e'' \\subset \\partial K} \\ell_{e''} m_{e''}\\right)\n$$\n这就是投影算子的显式闭式表达式。\n\n### 第2部分：稳定项的贡献\n\n第二个任务是计算一个精确线性场 $u(x,y) = a + bx + cy$（其中 $a, b, c$ 是实常数）的稳定项的贡献。设 $u_{h}$ 是 $u$ 在单元 $K$ 上的VEM插值。\n\n对于最低阶VEM，自由度是单元顶点处的函数值。因此，VEM插值 $u_{h} \\in V_{h}(K)$ 是满足以下条件的函数：\n1. $u_{h}$ 在 $K$ 中是调和的。\n2. 对于 $K$ 的每个顶点 $v_{i}$，都有 $u_{h}(v_{i}) = u(v_{i})$。\n\n由于 $u(x,y) = a + bx + cy$ 是一个线性多项式，它是一个调和函数，即 $\\Delta u = 0$。根据VEM空间的定义，$u_{h}$ 在任何边 $e$（连接顶点 $v_{i}$ 和 $v_{j}$）上的迹是插值顶点值 $u_{h}(v_{i}) = u(v_{i})$ 和 $u_{h}(v_{j}) = u(v_{j})$ 的唯一线性函数。函数 $u(x,y)$ 本身是线性的，并且在该边上插值这些值。根据唯一性，$u_{h}$ 在每条边上的迹都与 $u$ 的迹相同。因此，$u_{h}|_{\\partial K} = u|_{\\partial K}$。\n\n我们现在有两个函数 $u_{h}$ 和 $u$，它们都在区域 $K$ 内是调和的，并且在边界 $\\partial K$ 上具有相同的值。根据拉普拉斯方程狄利克雷问题的唯一性定理，这两个函数在整个区域 $K$ 上必须相同。因此，对于所有 $x \\in K$，都有 $u_{h}(x) = u(x)$。\n\n这意味着线性多项式的VEM插值就是该多项式本身。所以，$u_{h}$ 是 $\\mathbb{P}_{1}(K)$ 的一个元素。\n\n接下来，我们必须计算应用于 $u_{h} = u \\in \\mathbb{P}_{1}(K)$ 的投影算子 $\\Pi^{\\nabla}_{1}$。该投影算子被定义为与 $\\mathbb{P}_{1}(K)$ 中的多项式协调。我们可以从其定义条件中验证这一点。如果我们设 $u_{h} = p \\in \\mathbb{P}_{1}(K)$ 并测试候选投影算子 $\\Pi^{\\nabla}_{1} p = p$，我们会发现：\n1. $\\int_{K} \\nabla(p-p) \\cdot \\nabla q \\, \\mathrm{d}x = 0$ 对所有 $q \\in \\mathbb{P}_{1}(K)$ 成立。\n2. $\\int_{\\partial K} (p-p) \\, \\mathrm{d}s = 0$。\n两个条件都被平凡地满足。由于投影算子是唯一的，因此对于任何 $p \\in \\mathbb{P}_{1}(K)$，必然有 $\\Pi^{\\nabla}_{1} p = p$。\n这就是问题陈述中提到的“多项式协调性”属性，它是通过补片检验的一个关键特性。\n\n在我们的情况下，$u_{h}(x) = u(x) \\in \\mathbb{P}_{1}(K)$，所以 $\\Pi^{\\nabla}_{1} u_{h} = u_{h}$。\n\n问题要求计算稳定项对能量的贡献，即 $S(u_{h} - \\Pi^{\\nabla}_{1} u_{h}, u_{h} - \\Pi^{\\nabla}_{1} u_{h})$。\n代入我们的发现：\n$$\nu_{h} - \\Pi^{\\nabla}_{1} u_{h} = u_{h} - u_{h} = 0\n$$\n因此，稳定项为：\n$$\nS(0, 0)\n$$\n由于 $S(\\cdot, \\cdot)$ 是一个双线性形式，它必须满足 $S(0, 0) = 0$。\n\n因此，对于任何线性场 $u$，其VEM插值 $u_{h}$ 的稳定项贡献恰好为零。这证实了该方法能精确再现线性解的能量，正如补片检验所要求的那样。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{L_{K}}\\sum\\limits_{e' \\subset \\partial K} \\ell_{e'} \\left(\\frac{u_{i_{e'}} + u_{j_{e'}}}{2}\\right) + \\left(\\frac{1}{|K|} \\sum\\limits_{e \\subset \\partial K} n_{e} \\ell_{e} \\left(\\frac{u_{i_{e}} + u_{j_{e}}}{2}\\right)\\right) \\cdot \\left(x - \\frac{1}{L_{K}}\\sum\\limits_{e'' \\subset \\partial K} \\ell_{e''} m_{e''}\\right) & 0 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "稳定项并非唯一，存在多种不同的构造形式。稳定项的选择会显著影响方法的精度和鲁棒性，尤其是在具有挑战性、扭曲或各向异性的网格上。这项高级实践将理论转向分析，在一系列“条状”矩形上比较了两种常见的稳定格式。通过分析当单元纵横比趋于退化时它们的行为，您将学会如何批判性地评估和比较数值方法的不同组成部分，这是计算科学与工程研究中的一项关键技能。",
            "id": "3461350",
            "problem": "考虑虚拟单元法 (VEM) 中限制在单个多边形单元上的二维泊松问题，其源项为齐次。设单元为矩形 $E_{\\varepsilon} = (0,L) \\times (0,H)$，其中 $H = \\varepsilon L$ 且 $0  \\varepsilon \\ll 1$。使用最低阶局部 VEM 空间 $V_{E_{\\varepsilon}}$（多项式次数 $k=1$），该空间定义为在 $E_{\\varepsilon}$ 内部为调和函数，且在每条边上的迹为次数至多为 $k$ 的多项式的限制的函数集合；局部自由度为顶点值。\n\n连续双线性形式由 $a_{E_{\\varepsilon}}(u,v) = \\int_{E_{\\varepsilon}} \\nabla u \\cdot \\nabla v \\,\\mathrm{d}x$ 给出。局部能量投影算子 $\\Pi_{E_{\\varepsilon}}^{\\nabla} : V_{E_{\\varepsilon}} \\to \\mathbb{P}_{1}(E_{\\varepsilon})$ 定义为\n$$\n\\int_{E_{\\varepsilon}} \\nabla\\big( v - \\Pi_{E_{\\varepsilon}}^{\\nabla} v \\big) \\cdot \\nabla p \\,\\mathrm{d}x = 0 \\quad \\text{for all } p \\in \\mathbb{P}_{1}(E_{\\varepsilon}), \\qquad \\int_{\\partial E_{\\varepsilon}} \\big( v - \\Pi_{E_{\\varepsilon}}^{\\nabla} v \\big) \\,\\mathrm{d}s = 0.\n$$\n令 $K_{E_{\\varepsilon}} := \\{ v \\in V_{E_{\\varepsilon}} : \\Pi_{E_{\\varepsilon}}^{\\nabla} v = 0 \\}$ 表示投影算子的核，在此设置下其维数为 1。\n\n比较 $K_{E_{\\varepsilon}}$ 上的以下两种标准稳定化项：\n1. 基于顶点的对角稳定化项（有时称为 D-recipe 稳定化项），定义为\n$$\nS_{E_{\\varepsilon}}^{(1)}(u,v) = \\alpha_{E_{\\varepsilon}} \\sum_{i=1}^{4} d_{i}(u) \\, d_{i}(v),\n$$\n其中 $d_{i}(u)$ 是 $u$ 在 $E_{\\varepsilon}$ 四个角点的顶点值，而 $\\alpha_{E_{\\varepsilon}}$ 被选为坐标线性多项式能量中的较大者；即，\n$$\n\\alpha_{E_{\\varepsilon}} := \\max\\big\\{ a_{E_{\\varepsilon}}(p_{x},p_{x}), \\, a_{E_{\\varepsilon}}(p_{y},p_{y}) \\big\\}, \\quad p_{x}(x,y) := \\frac{x}{L}, \\quad p_{y}(x,y) := \\frac{y}{H}.\n$$\n2. 边界 $L^{2}$ 型稳定化项，定义为\n$$\nS_{E_{\\varepsilon}}^{(2)}(u,v) = \\frac{1}{h_{E_{\\varepsilon}}} \\sum_{e \\subset \\partial E_{\\varepsilon}} \\int_{e} u \\, v \\,\\mathrm{d}s,\n$$\n其中 $h_{E_{\\varepsilon}}$ 是单元的特征尺寸，在此定义为最长边的长度，对于矩形 $E_{\\varepsilon}$，其值为 $h_{E_{\\varepsilon}} = L$。\n\n令 $v_{\\varepsilon} \\in K_{E_{\\varepsilon}}$ 表示核中的任意非零函数（在缩放意义下是唯一的）。将这些稳定化项与连续双线性形式的光谱等价常数定义为\n$$\nc^{(j)}(\\varepsilon) := \\frac{S_{E_{\\varepsilon}}^{(j)}\\big(v_{\\varepsilon},v_{\\varepsilon}\\big)}{a_{E_{\\varepsilon}}\\big(v_{\\varepsilon},v_{\\varepsilon}\\big)}, \\quad j \\in \\{1,2\\}.\n$$\n对于上述的细长矩形序列 $E_{\\varepsilon}$，推导出比率\n$$\nR(\\varepsilon) := \\frac{c^{(2)}(\\varepsilon)}{c^{(1)}(\\varepsilon)}\n$$\n的精确闭式表达式，用 $\\varepsilon$ 表示。请以 $\\varepsilon$ 的单个解析表达式形式提供最终答案。",
            "solution": "该问题要求计算对于一个薄矩形单元序列 $E_{\\varepsilon} = (0,L) \\times (0,H)$（其中 $H=\\varepsilon L$）的比率 $R(\\varepsilon) = c^{(2)}(\\varepsilon) / c^{(1)}(\\varepsilon)$。量 $c^{(j)}(\\varepsilon)$ 定义为两个稳定化项 $S_{E_{\\varepsilon}}^{(j)}$ 与连续双线性形式 $a_{E_{\\varepsilon}}$ 之间的光谱等价常数，该常数是为能量投影算子 $\\Pi_{E_{\\varepsilon}}^{\\nabla}$ 的核中的任意非零函数 $v_{\\varepsilon}$ 计算的。\n\n令 $v_{\\varepsilon} \\in K_{E_{\\varepsilon}}$ 为一个非零函数。根据定义，\n$$\nc^{(j)}(\\varepsilon) = \\frac{S_{E_{\\varepsilon}}^{(j)}\\big(v_{\\varepsilon},v_{\\varepsilon}\\big)}{a_{E_{\\varepsilon}}\\big(v_{\\varepsilon},v_{\\varepsilon}\\big)}, \\quad j \\in \\{1,2\\}.\n$$\n所求比率为\n$$\nR(\\varepsilon) = \\frac{c^{(2)}(\\varepsilon)}{c^{(1)}(\\varepsilon)} = \\frac{S_{E_{\\varepsilon}}^{(2)}(v_{\\varepsilon},v_{\\varepsilon}) / a_{E_{\\varepsilon}}(v_{\\varepsilon},v_{\\varepsilon})}{S_{E_{\\varepsilon}}^{(1)}(v_{\\varepsilon},v_{\\varepsilon}) / a_{E_{\\varepsilon}}(v_{\\varepsilon},v_{\\varepsilon})}.\n$$\n由于分子和分母中的函数 $v_{\\varepsilon}$ 相同，只要项 $a_{E_{\\varepsilon}}(v_{\\varepsilon},v_{\\varepsilon})$ 非零，它就会被消去。双线性形式 $a_{E_{\\varepsilon}}$ 的核由常数函数组成。然而，一个非零常数函数 $v$ 不满足条件 $\\int_{\\partial E_{\\varepsilon}} v \\,\\mathrm{d}s=0$，因此它不能在 $K_{E_{\\varepsilon}}$ 中。所以，对于任何 $v_{\\varepsilon} \\in K_{E_{\\varepsilon}} \\setminus \\{0\\}$，都有 $a_{E_{\\varepsilon}}(v_{\\varepsilon},v_{\\varepsilon})  0$。\n因此，问题简化为计算两个稳定化项的比率：\n$$\nR(\\varepsilon) = \\frac{S_{E_{\\varepsilon}}^{(2)}(v_{\\varepsilon}, v_{\\varepsilon})}{S_{E_{\\varepsilon}}^{(1)}(v_{\\varepsilon}, v_{\\varepsilon})}.\n$$\n这要求我们首先确定核 $K_{E_{\\varepsilon}}$ 中函数的性质。一个函数 $v \\in V_{E_{\\varepsilon}}$ 在核 $K_{E_{\\varepsilon}}$ 中，如果 $\\Pi_{E_{\\varepsilon}}^{\\nabla} v = 0$。这意味着两个条件：\n1. 对所有 $p \\in \\mathbb{P}_{1}(E_{\\varepsilon})$，$\\int_{E_{\\varepsilon}} \\nabla v \\cdot \\nabla p \\,\\mathrm{d}x = 0$。\n2. $\\int_{\\partial E_{\\varepsilon}} v \\,\\mathrm{d}s = 0$。\n\n令 $d_1, d_2, d_3, d_4$ 分别为 $v$ 在角点 $(0,0)$, $(L,0)$, $(L,H)$ 和 $(0,H)$ 处的顶点值。对于 $k=1$，函数 $v$ 在 $E_{\\varepsilon}$ 的边上具有线性迹。\n\n第一个条件可以针对 $\\mathbb{P}_1(E_{\\varepsilon})$ 的一个基（例如 $\\{1, x, y\\}$）进行检验。对于 $p=1$，$\\nabla p = 0$，所以条件是平凡的。\n对于 $p=x$，$\\nabla p = (1,0)$。使用散度定理：\n$$\n\\int_{E_{\\varepsilon}} \\frac{\\partial v}{\\partial x} \\, \\mathrm{d}x\\mathrm{d}y = \\int_{\\partial E_{\\varepsilon}} v n_x \\, \\mathrm{d}s = \\int_0^H v(L,y)\\,\\mathrm{d}y - \\int_0^H v(0,y)\\,\\mathrm{d}y = 0.\n$$\n迹 $v(L,y)$ 和 $v(0,y)$ 是线性的。$v(L,y)$ 连接 $d_2$ 和 $d_3$。$v(0,y)$ 连接 $d_1$ 和 $d_4$。\n$\\int_0^H v(L,y)\\,\\mathrm{d}y = H \\frac{d_2+d_3}{2}$。\n$\\int_0^H v(0,y)\\,\\mathrm{d}y = H \\frac{d_1+d_4}{2}$。\n因此，$d_2+d_3 = d_1+d_4$。\n\n对于 $p=y$，$\\nabla p = (0,1)$。类似的计算可得：\n$$\n\\int_{E_{\\varepsilon}} \\frac{\\partial v}{\\partial y} \\, \\mathrm{d}x\\mathrm{d}y = \\int_{\\partial E_{\\varepsilon}} v n_y \\, \\mathrm{d}s = \\int_0^L v(x,H)\\,\\mathrm{d}x - \\int_0^L v(x,0)\\,\\mathrm{d}x = 0.\n$$\n这导致 $L \\frac{d_3+d_4}{2} - L \\frac{d_1+d_2}{2} = 0$，所以 $d_3+d_4 = d_1+d_2$。\n\n第二个条件是 $\\int_{\\partial E_{\\varepsilon}} v ds = 0$。这得到：\n$$\nL\\frac{d_1+d_2}{2} + H\\frac{d_2+d_3}{2} + L\\frac{d_3+d_4}{2} + H\\frac{d_4+d_1}{2} = 0.\n$$\n使用 $d_3+d_4=d_1+d_2$ 和 $d_1+d_4=d_2+d_3$，这可以简化为：\n$(d_1+d_2+d_3+d_4) \\frac{L+H}{2} = 0$。\n因为 $L,H > 0$，我们必须有 $d_1+d_2+d_3+d_4=0$。\n\n结合这些条件，$d_1+d_4=d_2+d_3$, $d_1+d_2=d_3+d_4$ 和 $d_1+d_2+d_3+d_4=0$，我们发现顶点值必须满足 $d_1=d_3$ 和 $d_2=d_4$，以及 $d_1+d_2=0$。\n这定义了一个一维空间，由顶点向量 $(1, -1, 1, -1)$ 张成。我们可以选择这个向量作为 $v_{\\varepsilon}$ 的自由度。\n因此，对于我们选择的 $v_{\\varepsilon}$，顶点值为 $(d_1, d_2, d_3, d_4) = (1, -1, 1, -1)$。\n\n现在我们为这个 $v_{\\varepsilon}$ 计算两个稳定化项。\n\n**1. 基于顶点的稳定化项 $S^{(1)}$**\n$S_{E_{\\varepsilon}}^{(1)}(v_{\\varepsilon},v_{\\varepsilon}) = \\alpha_{E_{\\varepsilon}} \\sum_{i=1}^{4} d_{i}(v_{\\varepsilon})^2$。\n首先，计算 $\\alpha_{E_{\\varepsilon}}$：\n$$\n\\alpha_{E_{\\varepsilon}} = \\max\\left\\{ a_{E_{\\varepsilon}}\\Big(\\frac{x}{L},\\frac{x}{L}\\Big), \\, a_{E_{\\varepsilon}}\\Big(\\frac{y}{H},\\frac{y}{H}\\Big) \\right\\}.\n$$\n$a_{E_{\\varepsilon}}(\\frac{x}{L},\\frac{x}{L}) = \\int_{E_{\\varepsilon}} |\\nabla(\\frac{x}{L})|^2 \\,\\mathrm{d}x = \\int_{E_{\\varepsilon}} (\\frac{1}{L})^2 \\,\\mathrm{d}x = \\frac{1}{L^2} (\\text{Area}(E_{\\varepsilon})) = \\frac{LH}{L^2} = \\frac{H}{L} = \\varepsilon$。\n$a_{E_{\\varepsilon}}(\\frac{y}{H},\\frac{y}{H}) = \\int_{E_{\\varepsilon}} |\\nabla(\\frac{y}{H})|^2 \\,\\mathrm{d}x = \\int_{E_{\\varepsilon}} (\\frac{1}{H})^2 \\,\\mathrm{d}x = \\frac{1}{H^2} (\\text{Area}(E_{\\varepsilon})) = \\frac{LH}{H^2} = \\frac{L}{H} = \\frac{1}{\\varepsilon}$。\n由于 $0  \\varepsilon \\ll 1$，我们有 $1/\\varepsilon > \\varepsilon$。因此，$\\alpha_{E_{\\varepsilon}} = 1/\\varepsilon$。\n稳定化项是：\n$$\nS_{E_{\\varepsilon}}^{(1)}(v_{\\varepsilon},v_{\\varepsilon}) = \\frac{1}{\\varepsilon} \\left( 1^2 + (-1)^2 + 1^2 + (-1)^2 \\right) = \\frac{4}{\\varepsilon}.\n$$\n\n**2. 边界 $L^2$ 型稳定化项 $S^{(2)}$**\n$S_{E_{\\varepsilon}}^{(2)}(v_{\\varepsilon},v_{\\varepsilon}) = \\frac{1}{h_{E_{\\varepsilon}}} \\sum_{e \\subset \\partial E_{\\varepsilon}} \\int_{e} v_{\\varepsilon}^2 \\,\\mathrm{d}s$。\n根据问题陈述，$h_{E_{\\varepsilon}}=L$。$v_{\\varepsilon}$ 在各边上的迹是连接顶点值的线性多项式。\n- 边 1 (底边, $y=0$)：从 $(0,0)$ 到 $(L,0)$。连接 $d_1=1$ 和 $d_2=-1$。$v_{\\varepsilon}(x,0) = 1 - \\frac{2x}{L}$。\n- 边 2 (右边, $x=L$)：从 $(L,0)$ 到 $(L,H)$。连接 $d_2=-1$ 和 $d_3=1$。$v_{\\varepsilon}(L,y) = -1 + \\frac{2y}{H}$。\n- 边 3 (顶边, $y=H$)：从 $(L,H)$ 到 $(0,H)$。连接 $d_3=1$ 和 $d_4=-1$。$v_{\\varepsilon}(x,H) = 1 - \\frac{2(L-x)}{L} = -1 + \\frac{2x}{L}$。\n- 边 4 (左边, $x=0$)：从 $(0,H)$ 到 $(0,0)$。连接 $d_4=-1$ 和 $d_1=1$。$v_{\\varepsilon}(0,y) = -1 + \\frac{2(H-y)}{H} = 1 - \\frac{2y}{H}$。\n\n积分的和是：\n$$\n\\sum_{e} \\int_e v_{\\varepsilon}^2 ds = \\int_0^L \\left(1-\\frac{2x}{L}\\right)^2 \\mathrm{d}x + \\int_0^H \\left(-1+\\frac{2y}{H}\\right)^2 \\mathrm{d}y + \\int_0^L \\left(-1+\\frac{2x}{L}\\right)^2 \\mathrm{d}x + \\int_0^H \\left(1-\\frac{2y}{H}\\right)^2 \\mathrm{d}y.\n$$\n一个标准积分：$\\int_0^A (1-2t/A)^2 dt = [-A/6 (1-2t/A)^3]_0^A = -A/6 ((-1)^3 - 1^3) = -A/6(-2)=A/3$。\n所以，$\\int_0^L (1-2x/L)^2 \\mathrm{d}x = L/3$ 且 $\\int_0^H (1-2y/H)^2 \\mathrm{d}y = H/3$。\n$(-1+z)^2$ 的积分与 $(1-z)^2$ 的相同。\n积分的和是 $L/3 + H/3 + L/3 + H/3 = \\frac{2}{3}(L+H)$。\n代入 $H=\\varepsilon L$，和为 $\\frac{2}{3}(L+\\varepsilon L) = \\frac{2L}{3}(1+\\varepsilon)$。\n稳定化项是：\n$$\nS_{E_{\\varepsilon}}^{(2)}(v_{\\varepsilon},v_{\\varepsilon}) = \\frac{1}{L} \\left( \\frac{2L}{3}(1+\\varepsilon) \\right) = \\frac{2}{3}(1+\\varepsilon).\n$$\n\n**3. 比率 $R(\\varepsilon)$**\n我们现在计算最终的比率：\n$$\nR(\\varepsilon) = \\frac{S_{E_{\\varepsilon}}^{(2)}(v_{\\varepsilon}, v_{\\varepsilon})}{S_{E_{\\varepsilon}}^{(1)}(v_{\\varepsilon}, v_{\\varepsilon})} = \\frac{\\frac{2}{3}(1+\\varepsilon)}{\\frac{4}{\\varepsilon}} = \\frac{2(1+\\varepsilon)}{3} \\cdot \\frac{\\varepsilon}{4} = \\frac{2\\varepsilon(1+\\varepsilon)}{12} = \\frac{\\varepsilon(1+\\varepsilon)}{6}.\n$$",
            "answer": "$$\n\\boxed{\\frac{\\varepsilon(1+\\varepsilon)}{6}}\n$$"
        }
    ]
}