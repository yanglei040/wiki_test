{
    "hands_on_practices": [
        {
            "introduction": "这个首个实践提供了一项基础练习。它不只是简单地使用预定义的算子，而是挑战你从头开始推导一个算子。通过施加精度约束和核心的分部求和(SBP)恒等式，你将构建一个二阶精度的对角范数算子，从而深入理解这些属性如何决定算子的结构。",
            "id": "3451162",
            "problem": "考虑区间 $[0,1]$ 上的一个均匀网格，该网格有 $N \\ge 3$ 个节点 $x_i = (i-1)h$（对于 $i=1,\\dots,N$），间距为 $h = \\frac{1}{N-1}$。设一个一阶导数的分部求和（Summation-By-Parts, SBP）算子由一个对称正定对角范数矩阵 $H$ 和一个满足离散分部积分恒等式的微分矩阵 $D$ 定义。具体来说，设 $H = h \\,\\operatorname{diag}\\!\\big(\\frac{1}{2}, 1, \\dots, 1, \\frac{1}{2}\\big)$ 且 $D = H^{-1} Q$，其中 $Q$ 是一个 $N \\times N$ 的实矩阵，满足 SBP 恒等式 $Q + Q^{T} = B$，其中 $B = \\operatorname{diag}(-1,0,\\dots,0,1)$。\n\n按如下方式构造一个用于一阶导数的二阶精度对角范数 SBP 算子：\n\n- 在内部，对所有满足 $2 \\le i \\le N-1$ 的节点 $i$，假设 $Q$ 采用平移不变的三点格式，使得 $(Q \\boldsymbol{u})_i = q_{-1} u_{i-1} + q_0 u_i + q_{1} u_{i+1}$，其中常数 $q_{-1}, q_0, q_1$ 与 $i$ 无关。施加要求，使得内部格式对光滑函数是形式上二阶精度的，这可解释为在内部节点上对最高为 2 次的多项式是精确微分。\n\n- 在边界处，假设 $Q$ 采用最近邻闭包，使得 $(Q \\boldsymbol{u})_1 = a \\, u_1 + b \\, u_2$ 且 $(Q \\boldsymbol{u})_N = c \\, u_{N-1} + d \\, u_N$，其中 $a,b,c,d$ 是常数。强制满足 SBP 恒等式 $Q + Q^{T} = B$ 和离散相容性 $D \\boldsymbol{1} = \\boldsymbol{0}$ 及 $D \\boldsymbol{x} = \\boldsymbol{1}$，其中 $\\boldsymbol{1}$ 是分量全为 1 的网格函数，$\\boldsymbol{x}$ 是分量为 $x_i$ 的网格函数。\n\n在完成构造并施加所有约束后，边界闭包系数 $Q_{1,1}$ 的精确值是多少？请以精确有理数形式给出答案（无舍入）。",
            "solution": "目标是确定指定的分部求和（SBP）算子的系数 $Q_{1,1}$ 的值。题目定义了矩阵 $Q$ 的结构，并给出了它必须满足的几个约束。我们将系统地利用这些约束来求出 $Q_{1,1}$ 的值。\n\n题目指出，对于第一个网格节点，$Q$ 的作用由 $(Q \\boldsymbol{u})_1 = a \\, u_1 + b \\, u_2$ 给出。这意味着矩阵 $Q$ 的第一行只有两个非零元素：$Q_{1,1} = a$ 和 $Q_{1,2} = b$。问题要求的是 $Q_{1,1}$ 的值。\n\nSBP 定义的基石是恒等式 $Q + Q^T = B$，其中 $Q^T$ 是 $Q$ 的转置，而 $B$ 是边界矩阵，给定为 $B = \\operatorname{diag}(-1,0,\\dots,0,1)$。这个矩阵恒等式必须对每个元素都成立。我们来考察位置 $(1,1)$ 处的元素：\n$$ (Q + Q^T)_{1,1} = B_{1,1} $$\n$Q+Q^T$ 的 $(1,1)$ 元素是 $Q_{1,1} + Q^T_{1,1}$。根据矩阵转置的定义，$Q^T_{1,1} = Q_{1,1}$。因此，方程变为：\n$$ Q_{1,1} + Q_{1,1} = 2Q_{1,1} $$\n根据 $B$ 的定义，其 $(1,1)$ 元素是 $B_{1,1} = -1$。\n令 $(1,1)$ 元素的两个表达式相等，得到：\n$$ 2Q_{1,1} = -1 $$\n解出 $Q_{1,1}$ 可得：\n$$ Q_{1,1} = -\\frac{1}{2} $$\n这就确定了所求系数的值。为确保该结果是一个相容且有效的 SBP 算子的一部分，我们将验证一个满足题目所有条件的矩阵 $Q$ 可以用这个值构造出来。\n\n首先，我们来确定内部格式的系数。对于一个内部节点 $i$（其中 $2 \\le i \\le N-1$），范数矩阵的元素是 $H_{i,i} = h$，因此微分算子 $D=H^{-1}Q$ 的作用是 $(D\\boldsymbol{u})_i = \\frac{1}{h}(Q\\boldsymbol{u})_i$。格式由 $(Q \\boldsymbol{u})_i = q_{-1} u_{i-1} + q_0 u_i + q_{1} u_{i+1}$ 给出。\n要求是该格式对最高为 2 次的多项式是精确的。我们用 $p_0(x)=1$，$p_1(x)=x$ 和 $p_2(x)=x^2$ 来检验。\n1.  对于 $p_0(x)=1$，对所有 $i$ 有 $u_i = 1$。精确导数为 $p_0'(x)=0$。算子给出 $\\frac{1}{h}(q_{-1} + q_0 + q_1) = 0$，所以 $q_{-1} + q_0 + q_1 = 0$。\n2.  对于 $p_1(x)=x$，$u_i = x_i=(i-1)h$。精确导数为 $p_1'(x)=1$。算子给出 $\\frac{1}{h} (q_{-1}x_{i-1} + q_0x_i + q_1x_{i+1}) = \\frac{1}{h} (q_{-1}(x_i-h) + q_0x_i + q_1(x_i+h)) = \\frac{x_i}{h}(q_{-1}+q_0+q_1) + (q_1-q_{-1})$。使用第一个条件，这化简为 $q_1-q_{-1}$。所以，我们必须有 $q_1 - q_{-1} = 1$。\n3.  对于 $p_2(x)=x^2$，$u_i = x_i^2$。精确导数为 $p_2'(x)=2x$。算子给出 $\\frac{1}{h} (q_{-1}(x_i-h)^2 + q_0x_i^2 + q_1(x_i+h)^2)$。展开并使用前面的条件，得到 $2x_i + h(q_{-1}+q_1)$。为了使其恰好为 $2x_i$，我们需要 $q_{-1}+q_1 = 0$。\n\n解这个线性方程组：\n$q_1 - q_{-1} = 1$\n$q_1 + q_{-1} = 0$\n两式相加得到 $2q_1 = 1 \\implies q_1 = 1/2$。两式相减得到 $2q_{-1} = -1 \\implies q_{-1} = -1/2$。\n从 $q_0 = -q_1-q_{-1}$，我们得到 $q_0 = 0$。\n所以 $Q$ 的内部行具有 $Q_{i,i-1}=-1/2$，$Q_{i,i}=0$，$Q_{i,i+1}=1/2$ 的形式。\n\n完整的矩阵 $Q$ 由内部格式和边界闭包确定：\n$$\nQ = \\begin{pmatrix}\na  b  0  \\dots  0 \\\\\n-1/2  0  1/2  \\dots  0 \\\\\n0  -1/2  0  1/2  \\dots \\\\\n\\vdots   \\ddots  \\ddots  \\vdots \\\\\n0  \\dots  -1/2  0  1/2 \\\\\n0  \\dots  0  c  d\n\\end{pmatrix}\n$$\n其中 $a=Q_{1,1}$，$b=Q_{1,2}$，$c=Q_{N,N-1}$，$d=Q_{N,N}$。\n将 SBP 恒等式 $Q+Q^T=B$ 应用于其他边界系数：\n- $(1,2)$ 元素：$Q_{1,2} + Q_{2,1} = 0 \\implies b + (-1/2)=0 \\implies b = 1/2$。\n- $(N,N)$ 元素：$2Q_{N,N} = 1 \\implies 2d = 1 \\implies d = 1/2$。\n- $(N-1,N)$ 元素：$Q_{N-1,N} + Q_{N,N-1} = 0 \\implies 1/2 + c = 0 \\implies c = -1/2$。\n我们得到 $a = -1/2$，$b = 1/2$，$c = -1/2$，$d = 1/2$。\n\n最后，我们验证离散相容性关系 $D\\boldsymbol{1}=\\boldsymbol{0}$ 和 $D\\boldsymbol{x}=\\boldsymbol{1}$。\n- $D\\boldsymbol{1}=\\boldsymbol{0}$ 等价于 $Q\\boldsymbol{1}=\\boldsymbol{0}$，这意味着 $Q$ 的行和必须为零。\n  - 第 1 行：$a+b = -1/2 + 1/2 = 0$。\n  - 第 2 到 $N-1$ 行：$-1/2 + 0 + 1/2 = 0$。\n  - 第 $N$ 行：$c+d = -1/2 + 1/2 = 0$。\n  这个条件得到满足。\n- $D\\boldsymbol{x}=\\boldsymbol{1}$ 等价于 $Q\\boldsymbol{x}=H\\boldsymbol{1}$。向量 $H\\boldsymbol{1}$ 是 $(h/2, h, \\dots, h, h/2)^T$。\n  - 第 1 行：$(Q\\boldsymbol{x})_1 = a x_1 + b x_2 = (-1/2)(0) + (1/2)(h) = h/2$。这与 $(H\\boldsymbol{1})_1$ 相符。\n  - 第 $i$ 行（$i \\in [2, N-1]$）：$(Q\\boldsymbol{x})_i = (-1/2)x_{i-1} + (1/2)x_{i+1} = \\frac{1}{2}(-x_i+h+x_i+h) = h$。这与 $(H\\boldsymbol{1})_i$ 相符。\n  - 第 $N$ 行：$(Q\\boldsymbol{x})_N = c x_{N-1} + d x_N = (-1/2)(N-2)h + (1/2)(N-1)h = \\frac{h}{2}(-(N-2) + (N-1)) = h/2$。这与 $(H\\boldsymbol{1})_N$ 相符。\n所有条件都得到满足，证实了这个著名的二阶 SBP 算子的唯一构造。系数 $Q_{1,1}$ 的值确实是 $-\\frac{1}{2}$。",
            "answer": "$$\\boxed{-\\frac{1}{2}}$$"
        },
        {
            "introduction": "在前一个练习原理的基础上，本实践将挑战更高阶算子的构建。你将建立并求解一个由四阶精度矩条件和分部求和(SBP)约束导出的方程组，以确定边界格式的系数。这个过程对于开发用于前沿计算模拟的高性能数值格式至关重要。",
            "id": "3451184",
            "problem": "考虑一个一维守恒律，定义在包含 $N+1$ 个节点 $x_i = i h$（$i = 0,1,\\dots,N$，$h=1/N$）的均匀网格上。构建一个具有对角范数的一阶导数分部求和（Summation-By-Parts, SBP）算子，该算子适用于同步近似项（Simultaneous Approximation Term, SAT）边界处理。设 SBP 算子定义为 $\\mathbf{D} = \\mathbf{H}^{-1} \\mathbf{Q}$，其中 $\\mathbf{H} = h \\, \\mathrm{diag}(w_0,w_1,\\dots,w_N)$ 是一个由求积权重组成的对角正定矩阵，$\\mathbf{Q}$ 满足 SBP 恒等式 $\\mathbf{Q} + \\mathbf{Q}^{\\top} = \\mathbf{B}$，其中 $\\mathbf{B} = \\mathrm{diag}(-1,0,\\dots,0,1)$。目标内部精度为 $2p = 4$ 阶，边界精度为 $p = 2$ 阶。\n\n假设在行 $i = 2,3,\\dots,N-2$ 上，$\\mathbf{D}$ 的内部格式为标准的四阶精度中心有限差分，\n$$\n(\\mathbf{D} \\mathbf{u})_i \\;=\\; \\frac{1}{12 h} \\left(-\\mathbf{u}_{i+2} + 8 \\mathbf{u}_{i+1} - 8 \\mathbf{u}_{i-1} + \\mathbf{u}_{i-2}\\right).\n$$\n对于 $i = 0$ 处的左边界封闭格式，令 $(\\mathbf{D}\\mathbf{u})_0 = \\frac{1}{h}\\sum_{j=0}^{4} a_j \\mathbf{u}_j$，其中未知的边界封闭系数 $a_j$ 必须满足确保边界精度为 $p=2$ 阶的矩条件。具体来说，对于单项式 $\\mathbf{u}(x) = x^m$（$m = 0,1,2$），\n$$\n\\sum_{j=0}^{4} a_j \\, j^m \\;=\\; m \\cdot 0^{m-1}\n$$\n其中 $0^{m-1}$ 在 $m \\geq 2$ 时解释为 $0$，在 $m=1$ 时解释为 $1$。此外，施加 $\\mathbf{Q}$ 与边界封闭格式之间的 SBP 关系，即对于 $j=0,1,2,3,4$，有 $Q_{0j} = w_0 a_j$，同时还有 $Q_{00} = -\\tfrac{1}{2}$ 和当 $j \\geq 1$ 时的斜对称性 $Q_{0j} + Q_{j0} = 0$。假设最小半带宽为三，因此 $a_4 = 0$，并且内部格式从第 $i=2$ 行开始。使用第 $i=2$ 行的内部格式和 SBP 恒等式来确定边界封闭格式中任何剩余的自由度。\n\n从这些条件和 SBP 结构出发，建立并求解得到的线性代数矩系统和 SBP 约束，以确定四阶 ($2p=4$) 对角范数 SBP 算子在左边界处的对角范数权重 $w_0$。将您的 $w_0$ 最终结果表示为一个精确的最简分数。无需四舍五入，也无需报告单位。",
            "solution": "目标是确定一个四阶精度分部求和（SBP）算子在左边界处的对角范数权重 $w_0$。推导过程是通过为未知的边界封闭系数和权重 $w_0$ 建立一个线性代数方程组，该方程组基于所提供的精度和 SBP 条件。\n\n问题指明了一个一阶导数 SBP 算子 $\\mathbf{D} = \\mathbf{H}^{-1}\\mathbf{Q}$，其中 $\\mathbf{H} = h \\, \\mathrm{diag}(w_0, w_1, \\dots, w_N)$ 是对角范数矩阵，$\\mathbf{Q}$ 是一个满足 SBP 属性 $\\mathbf{Q} + \\mathbf{Q}^\\top = \\mathbf{B} = \\mathrm{diag}(-1, 0, \\dots, 0, 1)$ 的矩阵。左边界（$i=0$）处的边界封闭格式由下式给出\n$$ (\\mathbf{D}\\mathbf{u})_0 = \\frac{1}{h}\\sum_{j=0}^{4} a_j \\mathbf{u}_j $$\n未知系数 $a_j$ 和权重 $w_0$ 必须满足几个条件。\n\n首先，边界精度为 $p=2$ 阶。这意味着边界处的有限差分公式对于所有次数直到 $m=2$ 的单项式 $\\mathbf{u}(x) = x^m$ 都必须是精确的。条件是在 $x=0$ 处，数值导数必须与解析导数相匹配。\n对于 $u(x) = x^m$ 在 $x_0=0$ 处的数值导数为：\n$$ (\\mathbf{D}u)_0 = \\frac{1}{h} \\sum_{j=0}^{4} a_j (x_j)^m = \\frac{1}{h} \\sum_{j=0}^{4} a_j (jh)^m = h^{m-1} \\sum_{j=0}^{4} a_j j^m $$\n在 $x=0$ 处的解析导数为 $u'(0) = [mx^{m-1}]_{x=0}$。\n为使算子对于次数直到 $m=2$ 都精确，我们必须有 $h^{m-1} \\sum_{j=0}^{4} a_j j^m = [mx^{m-1}]_{x=0}$ 对于 $m=0, 1, 2$。\n这产生了以下矩条件：\n\\begin{itemize}\n    \\item 对于 $m=0$: $u(x)=x^0=1$, $u'(0)=0$。条件是 $\\frac{1}{h}\\sum a_j = 0 \\implies \\sum_{j=0}^{4} a_j = 0$。\n    \\item 对于 $m=1$: $u(x)=x^1=x$, $u'(0)=1$。条件是 $\\sum a_j j = 1$。\n    \\item 对于 $m=2$: $u(x)=x^2$, $u'(0)=0$。条件是 $h \\sum a_j j^2 = 0 \\implies \\sum a_j j^2 = 0$。\n\\end{itemize}\n问题陈述 $a_4=0$，所以求和实际上是从 $j=0$ 到 $j=3$。矩条件为：\n\\begin{align}\n    a_0 + a_1 + a_2 + a_3 = 0 \\quad (1) \\\\\n    a_1 + 2a_2 + 3a_3 = 1 \\quad (2) \\\\\n    a_1 + 4a_2 + 9a_3 = 0 \\quad (3)\n\\end{align}\n\n其次，我们引入由 SBP 结构施加的约束。关系 $\\mathbf{D} = \\mathbf{H}^{-1}\\mathbf{Q}$ 意味着 $\\mathbf{Q} = \\mathbf{H}\\mathbf{D}$。$\\mathbf{Q}$ 的元素为 $Q_{ij} = H_{ii}D_{ij} = (h w_i)D_{ij}$。\n根据边界封闭格式的定义，$\\mathbf{D}$ 的第一行元素为 $D_{0j} = a_j/h$。因此，对于 $\\mathbf{Q}$ 的第一行，我们有 $Q_{0j} = H_{00} D_{0j} = (h w_0) (a_j/h) = w_0 a_j$。\nSBP 属性 $\\mathbf{Q} + \\mathbf{Q}^\\top = \\mathbf{B}$ 给出两个关键约束：\n\\begin{enumerate}\n    \\item 对于对角元素 $(0,0)$：$Q_{00} + Q_{00} = B_{00} = -1 \\implies 2Q_{00} = -1 \\implies Q_{00} = -1/2$。与 $Q_{00} = w_0 a_0$ 结合，我们得到：\n    $$ w_0 a_0 = -\\frac{1}{2} \\quad (4) $$\n    \\item 对于非对角元素，例如 $(0,2)$：$Q_{02} + Q_{20} = B_{02} = 0$。第一项是 $Q_{02} = w_0 a_2$。第二项是 $Q_{20} = H_{22}D_{20} = (h w_2) D_{20}$。问题指明对第 $i=2$ 行使用四阶内部格式：\n    $$ (\\mathbf{D} \\mathbf{u})_2 = \\frac{1}{12 h} (-\\mathbf{u}_4 + 8 \\mathbf{u}_3 - 8 \\mathbf{u}_1 + \\mathbf{u}_0) $$\n    从 $(\\mathbf{D} \\mathbf{u})_2$ 的格式中，$\\mathbf{u}_0$ 的系数是 $D_{20} = \\frac{1}{12h}$。对于一个基于中心差分的标准 $2p=4$ SBP 算子，当 $i \\ge p=2$ 时，内部求积权重为 $w_i=1$。因此，我们设 $w_2=1$。\n    $$ Q_{20} = (h \\cdot 1) \\left(\\frac{1}{12h}\\right) = \\frac{1}{12} $$\n    约束 $Q_{02} + Q_{20} = 0$ 变为 $w_0 a_2 + 1/12 = 0$：\n    $$ w_0 a_2 = -\\frac{1}{12} \\quad (5) $$\n\\end{enumerate}\n\n现在我们有了一个关于五个未知数 $a_0, a_1, a_2, a_3, w_0$ 的五方程系统。我们来求解这个系统。\n首先，我们从方程(1)、(2)、(3)中求解 $a_1, a_2, a_3$ 的线性系统。\n由(2)和(3)得：\n将(3)减去(2)：$(a_1 + 4a_2 + 9a_3) - (a_1 + 2a_2 + 3a_3) = 0 - 1 \\implies 2a_2 + 6a_3 = -1$。\n这给出 $a_2 = -3a_3 - \\frac{1}{2}$。\n将 $a_2$ 代入(2)：$a_1 + 2(-3a_3 - \\frac{1}{2}) + 3a_3 = 1 \\implies a_1 - 6a_3 - 1 + 3a_3 = 1 \\implies a_1 - 3a_3 = 2$，所以 $a_1 = 3a_3 + 2$。\n将 $a_1$ 和 $a_2$ 代入(1)：$a_0 + (3a_3 + 2) + (-3a_3 - \\frac{1}{2}) + a_3 = 0 \\implies a_0 + a_3 + \\frac{3}{2} = 0$。\n这给出用 $a_0$ 表示的 $a_3$：$a_3 = -a_0 - \\frac{3}{2}$。\n现在我们可以用 $a_0$ 表示 $a_2$：\n$a_2 = -3a_3 - \\frac{1}{2} = -3(-a_0 - \\frac{3}{2}) - \\frac{1}{2} = 3a_0 + \\frac{9}{2} - \\frac{1}{2} = 3a_0 + \\frac{8}{2} = 3a_0 + 4$。\n\n我们找到了 $a_2$ 和 $a_0$ 之间的一个线性关系：\n$$ a_2 = 3a_0 + 4 $$\n从方程(4)和(5)，我们可以用 $w_0$ 表示 $a_0$ 和 $a_2$：\n$a_0 = -\\frac{1}{2w_0}$\n$a_2 = -\\frac{1}{12w_0}$\n\n将这些代入关系式 $a_2 = 3a_0 + 4$ 中：\n$$ -\\frac{1}{12w_0} = 3\\left(-\\frac{1}{2w_0}\\right) + 4 $$\n$$ -\\frac{1}{12w_0} = -\\frac{3}{2w_0} + 4 $$\n为了解出 $w_0$，我们可以将整个方程乘以 $12w_0$（由于 $\\mathbf{H}$ 是正定的，它不为零）：\n$$ -1 = -3 \\cdot \\frac{12}{2} + 4 \\cdot (12w_0) $$\n$$ -1 = -18 + 48w_0 $$\n$$ 17 = 48w_0 $$\n$$ w_0 = \\frac{17}{48} $$\n得到的权重 $w_0$ 是一个正有理数，这与对角范数 SBP 算子的预期相符。分数 $17/48$ 是其最简形式，因为 $17$ 是一个质数，而 $48$ 不是 $17$ 的倍数。",
            "answer": "$$\\boxed{\\frac{17}{48}}$$"
        }
    ]
}