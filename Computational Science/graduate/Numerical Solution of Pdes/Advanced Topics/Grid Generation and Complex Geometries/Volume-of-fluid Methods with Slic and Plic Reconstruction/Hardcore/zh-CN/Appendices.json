{
    "hands_on_practices": [
        {
            "introduction": "本练习旨在巩固流体体积（VOF）方法中通量计算的核心机制。通过采用简单的线性界面计算（SLIC）重构，您将手动计算在一个离散时间步内通过单元界面的流体体积，从而将抽象的平流概念转化为具体的几何计算。",
            "id": "3461623",
            "problem": "考虑由流体体积 (VOF) 指示函数表示的二元流体的二维不可压缩平流。设指示函数表示为 $H(x,y,t)$，在液体中 $H=1$，在气体中 $H=0$。单元格中的 VOF 分数是 $C=\\frac{1}{\\Delta x\\,\\Delta y}\\iint_{\\text{cell}} H(x,y,t)\\,dx\\,dy$。在时间间隔 $[t^n,t^{n}+\\Delta t]$ 内，使用均匀、恒定的速度场 $u0$ 执行一个 $x$ 方向算子分裂的平流步骤，其中 Courant–Friedrichs–Lewy (CFL) 数 $\\lambda = \\dfrac{u\\,\\Delta t}{\\Delta x}$ 是预先设定的。\n\n考虑一个由大小为 $\\Delta x=\\Delta y=1.0\\,\\text{m}$ 的方形笛卡尔单元格组成的 $2\\times 2$ 块。列的索引为 $i=0$（左）和 $i=1$（右），行的索引为 $j=1$（下）和 $j=2$（上）。中心垂直面是位于 $x=\\Delta x$ 处分隔左右两列并跨越两行的面。在时间 $t^n$ 时的 VOF 值为：\n- 左列中 $C_{0,1}=0.85$，$C_{0,2}=0.75$\n- 右列中 $C_{1,1}=0.10$，$C_{1,2}=0.00$\n\n在 $x$ 方向扫描期间，采用简单线性界面计算 (Simple Line Interface Calculation, SLIC) 重构：在每个单元格中，界面被近似为一个垂直段，液相区域是一个宽度为 $s_j=C_{0,j}\\,\\Delta x$ 的连续垂直厚片，对于 $u0$ 的情况，该厚片附着于上游（左）面，并且每行 $j$ 相互独立。\n\n给定的 CFL 数为 $\\lambda=\\dfrac{u\\,\\Delta t}{\\Delta x}=0.35$。仅使用所述的假设和定义，确定在一个时间步 $\\Delta t$ 内，通过中心垂直面传输的、由 Simple Line Interface Calculation (SLIC) 预测的单位深度的总液体体积（即通过该面的时间积分通量），并对两行的贡献求和。以平方米每单位深度表示您的最终答案，并将结果四舍五入到四位有效数字。",
            "solution": "用户要求我解决一个与流体体积（VOF）法相关的流体动力学问题。\n\n这是我的计划：\n1.  **验证问题陈述。** 我将把问题分解为给定的组成部分，并检查其科学合理性、完整性和清晰度。\n2.  **理解核心概念。**\n    *   **VOF 法：** 一种用于跟踪和定位自由表面或流体-流体界面的数值技术。它使用一个标量函数，即 VOF 分数 `C`，表示计算单元格中被其中一种流体填充的比例。\n    *   **算子分裂法：** 将多维平流方程分解为一系列一维平流问题。在这里，我们只关心 `x` 方向的扫描。\n    *   **SLIC (简单线性界面计算)：** 一种根据 VOF 分数 `C` 在单元格内重构界面的特定方法。问题明确说明了如何应用 SLIC：界面是一条垂直线，流体形成一个附着于上游面的垂直厚片。\n    *   **通量计算：** 目标是求出在一个时间步长内通过特定面的液体总体积。这就是时间积分通量。\n\n3.  **逐步解构问题。**\n    *   **问题设置：**\n        *   二维，不可压缩平流。\n        *   VOF 指示函数 `H`。\n        *   单元格中的 VOF 分数 `C`。\n        *   `x` 方向算子分裂的平流步骤。\n        *   均匀、恒定的速度 `u  0`。\n        *   时间间隔 `[t^n, t^n + Δt]`。\n        *   CFL 数：`λ = u * Δt / Δx = 0.35`。\n        *   网格：2x2 块，方形单元格。\n        *   单元格尺寸：`Δx = Δy = 1.0 m`。\n        *   单元格索引：`i` 为列 (0, 1)，`j` 为行 (1, 2)。\n        *   VOF 值在 `t^n` 时：\n            *   `C_{0,1} = 0.85`\n            *   `C_{0,2} = 0.75`\n            *   `C_{1,1} = 0.10`\n            *   `C_{1,2} = 0.00`\n        *   目标面：位于 `x = Δx` 的中心垂直面。这是单元格 `(0,j)` 和 `(1,j)` 之间的界面。\n    *   **SLIC 重构：**\n        *   问题指定了*上游*单元格的重构，即 `i=0` 列中的单元格，因为 `u  0`。\n        *   对于每一行 `j`，单元格 `(0,j)` 中的界面是一个垂直段。\n        *   液相区域是一个宽度为 `s_j = C_{0,j} * Δx` 的连续垂直厚片。\n        *   该厚片附着于单元格的上游（左）面。\n    *   **通量计算：**\n        *   在时间步 `Δt` 内，从单元格 `(0,j)` 平流到单元格 `(1,j)` 的流体量是在单元格 `(0,j)` 中穿过 `x = Δx` 面的流体体积。\n        *   平流距离是 `u * Δt`。\n        *   CFL 数 `λ = u * Δt / Δx` 将此距离表示为单元格宽度的分数：`u * Δt = λ * Δx`。\n        *   将被平流穿过面的体积是包含在位于上游单元格下游侧的“通量盒”中的体积，该通量盒的宽度为 `u * Δt`，高度为 `Δy`。\n        *   我需要计算每一行 `j` 在此通量盒内的液体体积，然后将它们相加。\n\n4.  **执行计算。**\n    *   **单元格几何形状：**\n        *   `Δx = 1.0`\n        *   `Δy = 1.0`\n    *   **平流距离：**\n        *   `λ = 0.35`\n        *   平流距离 `d = u * Δt = λ * Δx = 0.35 * 1.0 = 0.35`。\n    *   **考虑行 `j=1`：**\n        *   上游单元格为 `(0,1)`。VOF 分数为 `C_{0,1} = 0.85`。\n        *   SLIC 重构：液体形成一个宽度为 `s_1 = C_{0,1} * Δx = 0.85 * 1.0 = 0.85` 的垂直厚片。\n        *   该厚片附着于单元格的左侧面，因此它占据了单元格 `(0,1)` 内 `0 ≤ x  0.85` 的区域（假设单元格范围为 `0 ≤ x ≤ Δx=1`）。\n        *   “通量盒”是将穿过 `x=Δx=1` 处平面的区域。这是上游单元格 `(0,1)` 内的区域 `(Δx - u*Δt) ≤ x  Δx`。\n        *   通量盒是 `(1.0 - 0.35) ≤ x  1.0`，即单元格 `(0,1)` 右边缘处宽度为 `0.35` 的区域。\n        *   现在我需要计算这个通量盒中有多少被液体填充。\n        *   液体厚片从 `x=0` 到 `x=0.85`。\n        *   通量盒从 `x=0.65` 到 `x=1.0`。\n        *   液体厚片和通量盒的重叠区域是从 `x=0.65` 到 `x=0.85`。\n        *   这个重叠区域的宽度是 `0.85 - 0.65 = 0.20`。\n        *   从单元格 `(0,1)` 流出的液体体积是这个重叠宽度乘以单元格高度 `Δy`。体积通量 `V_1 = (0.20) * Δy = 0.20 * 1.0 = 0.20`。单位是 `m^2`（单位深度的体积）。\n    *   **考虑行 `j=2`：**\n        *   上游单元格为 `(0,2)`。VOF 分数为 `C_{0,2} = 0.75`。\n        *   SLIC 重构：液体形成一个宽度为 `s_2 = C_{0,2} * Δx = 0.75 * 1.0 = 0.75` 的垂直厚片。\n        *   该厚片附着于左侧面，占据了单元格 `(0,2)` 内 `0 ≤ x  0.75` 的区域。\n        *   通量盒与之前相同：区域 `(Δx - u*Δt) ≤ x  Δx`，即 `0.65 ≤ x  1.0`。\n        *   液体厚片和通量盒的重叠区域是从 `x=0.65` 到 `x=0.75`。\n        *   这个重叠区域的宽度是 `0.75 - 0.65 = 0.10`。\n        *   从单元格 `(0,2)` 流出的液体体积是这个重叠宽度乘以单元格高度 `Δy`。体积通量 `V_2 = (0.10) * Δy = 0.10 * 1.0 = 0.10`。单位是 `m^2`。\n    *   **总通量：**\n        *   传输的总液体体积是两行通量之和。\n        *   `V_{total} = V_1 + V_2 = 0.20 + 0.10 = 0.30`。\n        *   问题要求答案以平方米每单位深度表示，这正是我计算的。它还要求四舍五入到四位有效数字。`0.30` 就是 `0.3000`。\n\n5.  **形式化解法。**\n    *   **验证：**\n        *   **给定条件：**\n            *   二维不可压缩平流，二元流体，VOF。\n            *   指示函数 `H(x,y,t)`。\n            *   VOF 分数 `C = (1/(Δx Δy)) ∫∫ H dx dy`。\n            *   `x` 方向算子分裂的平流。\n            *   速度场 `u  0`，均匀，恒定。\n            *   时间间隔 `[t^n, t^n + Δt]`。\n            *   CFL 数 `λ = u Δt / Δx`。\n            *   网格：2x2，方形单元格，`Δx = Δy = 1.0 m`。\n            *   索引：`i=0,1` (列)，`j=1,2` (行)。\n            *   中心垂直面位于 `x = Δx`。\n            *   `t^n` 时的 VOF 值：`C_{0,1}=0.85`, `C_{0,2}=0.75`, `C_{1,1}=0.10`, `C_{1,2}=0.00`。\n            *   SLIC 重构：界面是垂直段，液体是宽度为 `s_j = C_{0,j} Δx` 的厚片，附着于上游（左）面，每行 `j` 独立。\n            *   CFL 数值：`λ = 0.35`。\n            *   任务：确定在一个时间步 `Δt` 内，通过中心垂直面传输的单位深度的总液体体积。\n        *   **验证检查：**\n            *   _科学上合理_：是的，这是计算流体动力学中的一个标准问题，特别是在使用 VOF 方法进行多相流模拟的背景下。相关概念（VOF、算子分裂法、SLIC、CFL 条件）都是成熟的。\n            *   _适定性_：是的，所有必要信息都已提供，可以计算出唯一答案。问题是自洽的。\n            *   _客观性_：是的，语言是精确和技术性的。没有主观因素。\n            *   _无缺陷_：问题没有违反任何无效性标准。这是一个教科书式的练习题。\n        *   **结论：** 问题有效。\n\n    *   **解法推导：**\n        *   让我们定义两个上游单元格的计算域。单元格 `(0,j)` 在给定行 `j` 中占据空间 `0 \\le x \\le \\Delta x`。在这个一维扫描中，各行是独立的。\n        *   在时间步 `\\Delta t` 内，要平流穿过 `x=\\Delta x` 面的流体体积来自上游单元格 `(0,j)` 下游侧的“通量体积”或“通量盒”。\n        *   这个通量盒的宽度是平流距离 `d = u \\Delta t`。\n        *   根据 CFL 数的定义，`d = u \\Delta t = \\lambda \\Delta x`。\n        *   单元格 `(0,j)` 的通量盒占据区域 `\\Delta x - d \\le x \\le \\Delta x`。\n        *   传输的液体体积 `\\mathcal{F}_j` 是指示函数 `H` 在此通量盒上的积分。\n        *   `\\mathcal{F}_j = \\int_{t^n}^{t^n+\\Delta t} \\int_{j\\Delta y - \\Delta y}^{j\\Delta y} u H(x,y,\\tau)|_{x=\\Delta x} \\, dy \\, d\\tau`。对于恒定的 `u` 和在 `\\Delta t` 上的冻结场假设，这等价于 `\\int_{\\Delta x - u\\Delta t}^{\\Delta x} \\int_{y_{\\text{bottom}}}^{y_{\\text{top}}} H(x,y,t^n) \\, dy \\, dx`。\n        *   我们使用几何解释，这更简单直接。平流的液体体积是通量盒内的液体体积。\n        *   单元格 `(0,j)` 的 SLIC 重构定义了一个液相区域，它是一个宽度为 `s_j = C_{0,j} \\Delta x` 的垂直厚片，附着在左侧面 `x=0`。因此，在单元格 `(0,j)` 内，对于 `0 \\le x \\le s_j`，`H(x,y,t^n)=1`，对于 `s_j  x \\le \\Delta x`，`H=0`。\n        *   通量体积 `\\mathcal{V}_j`（单位深度）是液相区域和通量盒区域相交的面积。\n        *   液相区域 `L_j`: `[0, s_j] \\times [y_{\\text{cell_bottom}}, y_{\\text{cell_top}}]`。\n        *   通量盒区域 `B`: `[\\Delta x - \\lambda \\Delta x, \\Delta x] \\times [y_{\\text{cell_bottom}}, y_{\\text{cell_top}}]`。\n        *   传输的体积是 `x` 区间 `[0, s_j]` 和 `[\\Delta x - \\lambda \\Delta x, \\Delta x]` 相交部分的面积，乘以单元格高度 `\\Delta y`。\n        *   相交部分的宽度：`w_j = \\max(0, \\min(\\Delta x, s_j) - \\max(0, \\Delta x - \\lambda \\Delta x))`。由于 `s_j \\le \\Delta x`，这可以简化为 `w_j = \\max(0, s_j - (\\Delta x - \\lambda \\Delta x))`。\n        *   `w_j = \\max(0, C_{0,j} \\Delta x - \\Delta x(1-\\lambda)) = \\Delta x \\max(0, C_{0,j} - (1-\\lambda))`。\n        *   第 `j` 行的平流体积为 `\\mathcal{V}_j = w_j \\Delta y = \\Delta x \\Delta y \\max(0, C_{0,j} - 1 + \\lambda)`。\n\n    *   **将公式应用于给定数据：**\n        *   `\\Delta x = 1.0` m, `\\Delta y = 1.0` m。\n        *   `\\lambda = 0.35`。\n        *   `1 - \\lambda = 1 - 0.35 = 0.65`。\n        *   **对于行 `j=1`：**\n            *   `C_{0,1} = 0.85`。\n            *   `\\mathcal{V}_1 = (1.0)(1.0) \\max(0, 0.85 - 1 + 0.35) = \\max(0, 0.85 - 0.65) = \\max(0, 0.20) = 0.20` m$^2$。\n        *   **对于行 `j=2`：**\n            *   `C_{0,2} = 0.75`。\n            *   `\\mathcal{V}_2 = (1.0)(1.0) \\max(0, 0.75 - 1 + 0.35) = \\max(0, 0.75 - 0.65) = \\max(0, 0.10) = 0.10` m$^2$。\n        *   **总传输体积：**\n            *   `\\mathcal{V}_{\\text{total}} = \\mathcal{V}_1 + \\mathcal{V}_2 = 0.20 + 0.10 = 0.30` m$^2$。\n        *   **四舍五入：** 结果必须四舍五入到四位有效数字。\n            *   `0.3000`。\n\n    *   **最后复核：**\n        *   我的手动计算与派生公式相符。\n        *   对“通量盒”和“SLIC 重构”的解释是此类问题的标准解释。\n        *   逻辑是合理的。上游单元格（`i=0`）中的流体向右移动。穿过边界 `x=\\Delta x` 的量是包含在该单元格最右侧 `u \\Delta t` 切片中的流体。\n        *   该切片的宽度为 `\\lambda \\Delta x = 0.35 \\times 1.0 = 0.35`。因此我们关心的是区间 `x \\in [1.0 - 0.35, 1.0] = [0.65, 1.0]` 内的流体。\n        *   对于行 `j=1`，`C_{0,1}=0.85`。流体厚片的宽度为 `0.85`，占据 `x \\in [0, 0.85]`。`[0, 0.85]` 和 `[0.65, 1.0]` 的交集是 `[0.65, 0.85]`，其长度为 `0.20`。单位深度的体积是 `0.20 \\times \\Delta y = 0.20 \\times 1.0 = 0.20`。\n        *   对于行 `j=2`，`C_{0,2}=0.75`。流体厚片的宽度为 `0.75`，占据 `x \\in [0, 0.75]`。`[0, 0.75]` 和 `[0.65, 1.0]` 的交集是 `[0.65, 0.75]`，其长度为 `0.10`。单位深度的体积是 `0.10 \\times \\Delta y = 0.10 \\times 1.0 = 0.10`。\n        *   总体积是 `0.20 + 0.10 = 0.30`。\n        *   最终答案需要是 `0.3000`。\n\n    *   格式规则很严格。所有数学公式都用 LaTeX。没有 markdown 标题。XML 标签。最终答案放在方框里。结构是固定的。\n    *   该问题属于“偏微分方程数值解”领域中关于“带 SLIC 和 PLIC 重构的流体体积法”的内容。该问题恰好与此相关，因此并非不相关。\n    *   这个问题并非故作高深。它是定义的直接应用。\n    *   一切看起来都很好。我现在将按照所有规则编写解决方案。",
            "answer": "$$\n\\boxed{0.3000}\n$$"
        },
        {
            "introduction": "在掌握了基本通量计算后，本练习将引导您深入探索分段线性界面计算（PLIC）的核心几何问题。您将需要通过编程解决一个“反问题”：即根据已知的法向量和体积分数，反向求解定义界面的线段参数，这是实现高精度PLIC重构的关键一步。",
            "id": "3461601",
            "problem": "给定一个二维的流体体积（Volume-of-Fluid, VOF）重构问题，该问题位于一个单位单元格内。在分段线性界面计算（Piecewise Linear Interface Calculation, PLIC）中，重构的界面由一条直线表示，该直线通过隐式方程 $\\mathbf{n}\\cdot\\mathbf{x}=\\alpha$ 定义，其中 $\\mathbf{n}\\in\\mathbb{R}^2$ 是法向量，$\\alpha\\in\\mathbb{R}$ 是截距参数。液体区域被定义为半空间 $\\{\\mathbf{x}\\in[0,1]^2:\\mathbf{n}\\cdot\\mathbf{x}\\le \\alpha\\}$。单位单元格中的液体体积分数 $C$ 是此半空间与单位正方形相交区域的面积除以单元格面积。在简单线性界面计算（Simple Line Interface Calculation, SLIC）中，重构被限制为轴对齐切割，这是上述情况的一个特例，其中 $\\mathbf{n}$ 与某个坐标轴对齐。\n\n从第一性原理和核心定义出发：\n- 单位正方形中的VOF分数 $C$ 是区域 $\\{\\mathbf{x}\\in[0,1]^2:\\mathbf{n}\\cdot\\mathbf{x}\\le \\alpha\\}$ 的面积。\n- 面积函数 $A(\\alpha):=\\text{area}(\\{\\mathbf{x}\\in[0,1]^2:\\mathbf{n}\\cdot\\mathbf{x}\\le \\alpha\\})$ 对于任何固定的非零 $\\mathbf{n}$，在 $\\alpha$ 上是连续且非递减的。\n- 线性泛函 $\\mathbf{n}\\cdot\\mathbf{x}$ 在凸多边形 $[0,1]^2$ 上的最小值和最大值出现在其顶点处，因此 $\\alpha$ 的物理相关范围是 $[\\alpha_{\\min},\\alpha_{\\max}]$，其中 $\\alpha_{\\min}=\\min_{\\mathbf{v}\\in\\{(0,0),(1,0),(1,1),(0,1)\\}}\\mathbf{n}\\cdot\\mathbf{v}$ 且 $\\alpha_{\\max}=\\max_{\\mathbf{v}\\in\\{(0,0),(1,0),(1,1),(0,1)\\}}\\mathbf{n}\\cdot\\mathbf{v}$。它们满足 $A(\\alpha_{\\min})=0$ 和 $A(\\alpha_{\\max})=1$。\n- VOF重构的约束条件是 $A(\\alpha)=C$。\n\n您的任务是实现一个程序，对于每个测试用例，计算相应的截距参数 $\\alpha$ 以满足 $A(\\alpha)=C$。您必须通过计算单位正方形被半空间 $\\mathbf{n}\\cdot\\mathbf{x}\\le \\alpha$ 裁剪后得到的多边形的面积来精确计算 $A(\\alpha)$；不要使用任何预先制表的公式或简化表达式。您应该使用一个稳健的多边形-半空间裁剪程序和一个利用 $A(\\alpha)$ 单调性的求根方法（如二分法），在区间 $[\\alpha_{\\min},\\alpha_{\\max}]$ 上求解。对于边界情况 $C=0$ 或 $C=1$，应分别返回 $\\alpha=\\alpha_{\\min}$ 和 $\\alpha=\\alpha_{\\max}$，以确保唯一性。\n\n要求：\n- 每个测试的输入包含一个法向量 $\\mathbf{n}=(n_x,n_y)$（其中 $n_x$ 和 $n_y$ 是可正、可负或为零的实数）和一个目标体积分数 $C\\in[0,1]$。\n- 您必须按照上述描述计算 $\\alpha$ 以满足 $A(\\alpha)=C$，并将其结果四舍五入到三位有效数字。\n- 不涉及角度。此问题中没有物理单位。\n- 算法必须对任意非零 $\\mathbf{n}$（不一定已归一化）均有效。\n\n测试套件：\n对于以下每个测试用例，计算并输出 $\\alpha$，四舍五入到三位有效数字，采用标准的“四舍五入到最近值，平局时远离零”的规则。这六个用例是：\n1. $\\mathbf{n}=(0.6,0.8)$, $C=0.65$。\n2. $\\mathbf{n}=(1.0,0.0)$, $C=0.3$。\n3. $\\mathbf{n}=(0.0,-1.0)$, $C=0.3$。\n4. $\\mathbf{n}=(-0.6,0.8)$, $C=0.25$。\n5. $\\mathbf{n}=(-1.0,-2.0)$, $C=0.0$。\n6. $\\mathbf{n}=(0.2,-0.7)$, $C=1.0$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个逗号分隔的列表，用方括号括起来。列表中的每个数字都应四舍五入到三位有效数字，并以定点表示法（无指数表示法）表示。例如，一个有效的输出应类似于“[0.820,0.300,-0.700,-0.110,-3.00,0.200]”。",
            "solution": "该问题定义明确，要求开发一个数值程序来求解一条直线的截距参数 $\\alpha$，该直线将一个单位正方形划分为两个具有特定面积比的区域。这是一个在流体体积（Volume-of-Fluid, VOF）方法，特别是分段线性界面计算（Piecewise Linear Interface Calculation, PLIC）背景下的基本几何问题。\n\n该问题要求对于给定的法向量 $\\mathbf{n} \\in \\mathbb{R}^2$ 和体积分数 $C \\in [0,1]$，找到 $\\alpha \\in \\mathbb{R}$，使得区域 $\\{\\mathbf{x} \\in [0,1]^2 : \\mathbf{n} \\cdot \\mathbf{x} \\le \\alpha\\}$ 的面积等于 $C$。由于单位单元格 $[0,1]^2$ 的面积为 1，这个面积在数值上等于体积分数 $C$。\n\n我们将面积函数 $A(\\alpha)$ 定义为：\n$$A(\\alpha) = \\text{area}(\\{\\mathbf{x} \\in [0,1]^2 : \\mathbf{n} \\cdot \\mathbf{x} \\le \\alpha\\})$$\n我们的目标是求解方程 $A(\\alpha) = C$ 以得到 $\\alpha$。\n\n**1. 面积函数的性质与二分法**\n\n函数 $\\mathbf{n} \\cdot \\mathbf{x}$ 是 $\\mathbb{R}^2$ 上的一个线性泛函。区域 $\\{\\mathbf{x} : \\mathbf{n} \\cdot \\mathbf{x} \\le \\alpha\\}$ 是一个半平面。随着 $\\alpha$ 的增加，这个半平面会扩张，因此它与固定的单位正方形的交集面积 $A(\\alpha)$ 是一个关于 $\\alpha$ 的连续且单调非递减函数。\n\n线性泛函 $\\mathbf{n} \\cdot \\mathbf{x}$ 在凸集 $[0,1]^2$ 上的最小值和最大值出现在其顶点处，即 $\\mathbf{v}_1=(0,0)$、$\\mathbf{v}_2=(1,0)$、$\\mathbf{v}_3=(1,1)$ 和 $\\mathbf{v}_4=(0,1)$。我们定义：\n$$\\alpha_{\\min} = \\min_{i \\in \\{1,2,3,4\\}} (\\mathbf{n} \\cdot \\mathbf{v}_i)$$\n$$\\alpha_{\\max} = \\max_{i \\in \\{1,2,3,4\\}} (\\mathbf{n} \\cdot \\mathbf{v}_i)$$\n对于任何 $\\alpha  \\alpha_{\\min}$，半平面与单位正方形不相交，因此 $A(\\alpha) = 0$。对于任何 $\\alpha  \\alpha_{\\max}$，半平面完全包含单位正方形，因此 $A(\\alpha) = 1$。因此，$\\alpha$ 的相关范围是 $[\\alpha_{\\min}, \\alpha_{\\max}]$。\n\n$A(\\alpha)$ 在 $[\\alpha_{\\min}, \\alpha_{\\max}]$ 上的单调性使得二分法成为求解 $A(\\alpha) - C = 0$ 的理想选择。\n算法如下：\n1.  建立搜索区间 $[\\alpha_{low}, \\alpha_{high}] = [\\alpha_{\\min}, \\alpha_{\\max}]$。\n2.  如果目标体积分数 $C$ 为 $0$ 或 $1$，根据规定，解分别为 $\\alpha = \\alpha_{\\min}$ 或 $\\alpha = \\alpha_{\\max}$。\n3.  对于 $C \\in (0,1)$，重复二分区间：\n    a. 计算中点 $\\alpha_{mid} = (\\alpha_{low} + \\alpha_{high})/2$。\n    b. 计算面积 $A_{mid} = A(\\alpha_{mid})$。\n    c. 如果 $A_{mid}  C$，则根必定位于区间的上半部分，因此我们设置 $\\alpha_{low} = \\alpha_{mid}$。\n    d. 如果 $A_{mid} \\ge C$，则根必定位于区间的下半部分，因此我们设置 $\\alpha_{high} = \\alpha_{mid}$。\n4.  这个过程迭代足够多次（例如 100 次）以达到高精度。$\\alpha$ 的最终估计值是最终区间的中点。\n\n**2. 面积 $A(\\alpha)$ 的几何计算**\n\n问题的核心是对于给定的 $\\alpha$ 计算 $A(\\alpha)$。这涉及两个计算几何步骤：用半空间裁剪多边形，以及计算所得多边形的面积。\n\n**2.1. 多边形裁剪**\n区域 $\\{\\mathbf{x} \\in [0,1]^2 : \\mathbf{n} \\cdot \\mathbf{x} \\le \\alpha\\}$ 是一个凸多边形。其顶点通过用由直线 $\\mathbf{n} \\cdot \\mathbf{x} = \\alpha$ 定义的半空间来裁剪单位正方形而找到。Sutherland-Hodgman 算法是完成此任务的稳健方法。\n\n该算法针对裁剪线处理主题多边形（单位正方形）的每条边。对于从顶点 $S$ 到顶点 $P$ 的一条边：\n- 如果 $S$ 和 $P$ 都在半空间内部（$\\mathbf{n}\\cdot\\mathbf{x} - \\alpha \\le 0$），则将顶点 $P$ 添加到输出顶点列表中。\n- 如果 $S$ 在内部而 $P$ 在外部，则计算它们与直线 $\\mathbf{n}\\cdot\\mathbf{x} = \\alpha$ 的交点，并将其添加到输出列表中。\n- 如果 $S$ 和 $P$ 都在外部，则不添加任何顶点。\n- 如果 $S$ 在外部而 $P$ 在内部，则添加它们的交点，然后添加顶点 $P$。\n\n点 $S$ 和 $P$ 之间的线段与直线 $\\mathbf{n} \\cdot \\mathbf{x} = \\alpha$ 的交点 $I$ 可以通过参数化方法找到。设线段为 $\\mathbf{x}(t) = S + t(P-S)$，其中 $t \\in [0,1]$。交点出现在满足 $\\mathbf{n} \\cdot (S + t(P-S)) = \\alpha$ 的 $t$ 值处，这给出：\n$$t = \\frac{\\alpha - \\mathbf{n} \\cdot S}{\\mathbf{n} \\cdot (P-S)}$$\n交点为 $I = S + t(P-S)$。这个过程会生成裁剪后多边形的有序顶点列表。\n\n**2.2. 多边形面积计算**\n给定所得凸多边形的有序顶点 $(x_1, y_1), (x_2, y_2), \\dots, (x_k, y_k)$，其面积可以使用鞋带公式（或测量员公式）精确计算：\n$$ \\text{Area} = \\frac{1}{2} \\left| \\sum_{i=1}^{k} (x_i y_{i+1} - x_{i+1} y_i) \\right| $$\n其中 $(x_{k+1}, y_{k+1}) = (x_1, y_1)$。\n\n**3. 最终处理**\n最终计算出的 $\\alpha$ 值被四舍五入到三位有效数字。问题指定了标准舍入规则，即平局时远离零。实现了一个自定义函数来处理这个问题，因为标准的 Python `round()` 函数可能会舍入到最近的偶数。然后将结果格式化为定点表示法，以正确反映三位有效数字。",
            "answer": "```python\nimport numpy as np\n\ndef round_to_sf_and_format(value, sf=3):\n    \"\"\"\n    Rounds a number to a specified number of significant figures\n    using standard rounding (ties away from zero) and formats it\n    to a string with the correct number of decimal places.\n    \"\"\"\n    if value == 0:\n        return f\"{0.0:.{sf - 1}f}\"\n\n    # Calculate the power of 10 to scale for rounding\n    power = sf - 1 - int(np.floor(np.log10(np.abs(value))))\n    factor = 10**power\n    \n    # Perform rounding (ties away from zero)\n    rounded_value = np.sign(value) * np.floor(np.abs(value) * factor + 0.5) / factor\n\n    # After rounding, a number might change its order of magnitude (e.g., 9.996 - 10.0)\n    # The number of decimal places for formatting must be based on the rounded value.\n    if rounded_value == 0:\n        # This can happen if a small number rounds to 0.\n        return f\"{0.0:.{sf - 1}f}\"\n\n    decimals = sf - 1 - int(np.floor(np.log10(np.abs(rounded_value))))\n    if decimals  0:\n        decimals = 0\n    \n    return f\"{rounded_value:.{decimals}f}\"\n\ndef polygon_area(vertices):\n    \"\"\"\n    Calculates the area of a polygon using the Shoelace formula.\n    Assumes vertices are ordered (clockwise or counter-clockwise).\n    \"\"\"\n    if len(vertices)  3:\n        return 0.0\n    \n    area = 0.0\n    num_vertices = len(vertices)\n    for i in range(num_vertices):\n        j = (i + 1) % num_vertices\n        area += vertices[i][0] * vertices[j][1]\n        area -= vertices[j][0] * vertices[i][1]\n        \n    return np.abs(area) / 2.0\n\ndef clip_polygon_by_halfspace(subject_polygon, n, alpha):\n    \"\"\"\n    Clips a convex polygon against a half-space defined by n.x = alpha\n    using the Sutherland-Hodgman algorithm.\n    \"\"\"\n    output_list = []\n    input_list = [np.array(p) for p in subject_polygon]\n    \n    if not input_list:\n        return []\n\n    # A small tolerance for floating point comparisons\n    EPS = 1e-12\n\n    S = input_list[-1]\n    \n    for P in input_list:\n        s_val = np.dot(n, S) - alpha\n        p_val = np.dot(n, P) - alpha\n\n        s_inside = s_val  EPS\n        p_inside = p_val  EPS\n\n        if s_inside and p_inside:\n            # Case 1: Both S and P are inside - output P\n            output_list.append(P)\n        elif s_inside and not p_inside:\n            # Case 2: S is inside, P is outside - output intersection\n            denominator = p_val - s_val\n            if abs(denominator)  EPS:\n                t = -s_val / denominator\n                I = S + t * (P - S)\n                output_list.append(I)\n        elif not s_inside and p_inside:\n            # Case 4: S is outside, P is inside - output intersection then P\n            denominator = p_val - s_val\n            if abs(denominator)  EPS:\n                t = -s_val / denominator\n                I = S + t * (P - S)\n                output_list.append(I)\n                output_list.append(P)\n        # Case 3: Both S and P are outside - do nothing\n        \n        S = P\n        \n    return [p.tolist() for p in output_list]\n\ndef calculate_volume_fraction_area(n, alpha):\n    \"\"\"\n    Calculates the area of the unit square clipped by the half-space n.x = alpha.\n    \"\"\"\n    unit_square = [[0.0, 0.0], [1.0, 0.0], [1.0, 1.0], [0.0, 1.0]]\n    clipped_polygon = clip_polygon_by_halfspace(unit_square, n, alpha)\n    return polygon_area(clipped_polygon)\n\ndef find_alpha_for_volume_fraction(n_vec, C):\n    \"\"\"\n    Finds the intercept 'alpha' for a given normal 'n' and volume fraction 'C'.\n    \"\"\"\n    n = np.array(n_vec)\n    \n    # Define corners of the unit cell\n    corners = np.array([[0.0, 0.0], [1.0, 0.0], [1.0, 1.0], [0.0, 1.0]])\n    dot_products = corners @ n\n    alpha_min = np.min(dot_products)\n    alpha_max = np.max(dot_products)\n    \n    # Handle boundary cases as specified\n    if C = 0.0:\n        return alpha_min\n    if C = 1.0:\n        return alpha_max\n\n    # Bisection method to find alpha such that Area(alpha) = C\n    low, high = alpha_min, alpha_max\n    for _ in range(100):  # 100 iterations provides more than sufficient precision\n        mid = (low + high) / 2\n        area = calculate_volume_fraction_area(n, mid)\n        if area  C:\n            low = mid\n        else:\n            high = mid\n            \n    return (low + high) / 2.0\n\ndef solve():\n    \"\"\"Main function to run test cases and print results.\"\"\"\n    test_cases = [\n        ((0.6, 0.8), 0.65),\n        ((1.0, 0.0), 0.3),\n        ((0.0, -1.0), 0.3),\n        ((-0.6, 0.8), 0.25),\n        ((-1.0, -2.0), 0.0),\n        ((0.2, -0.7), 1.0),\n    ]\n\n    results = []\n    for n_vec, C in test_cases:\n        alpha = find_alpha_for_volume_fraction(n_vec, C)\n        results.append(alpha)\n\n    formatted_results = [round_to_sf_and_format(r, 3) for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "本练习将理论与实际应用相结合，探讨了界面重构精度对模拟物理现象的直接影响。您将分析由PLIC曲率计算误差引起的“伪电流”问题，并通过量纲分析来估算其大小，这有助于深刻理解数值误差如何影响多相流模拟的物理真实性。",
            "id": "3461573",
            "problem": "考虑一个半径为 $R$ 的二维不可压缩静止液滴，浸没在另一种不互溶液体的无限域中。界面采用流体体积法（VOF）进行追踪，并使用分段线性界面重构（PLIC）进行重构。假设两相具有相等且恒定的动力粘度 $\\mu$ 和密度 $\\rho$，惯性可以忽略（稳态斯托克斯流态），且表面张力系数 $\\sigma$ 是恒定且均匀的。界面曲率由重构后的界面计算得出。对于一个完美的圆形界面，其精确曲率为 $\\kappa_{\\mathrm{exact}}=1/R$。\n\n毛细力采用连续表面力（CSF）模型进行建模，并使用一种力平衡离散化方法，使得当曲率精确时，离散压力梯度和离散毛细力能够以机器精度相互抵消，从而实现速度为零的静力平衡。然而，由于几何重构和曲率估计，数值计算出的曲率存在确定性截断误差。对于在间距为 $h$ 的均匀笛卡尔网格上具有二阶精度的、采用高度函数曲率估计器的 PLIC 方法，假设曲率误差的大小满足\n$$\n|\\Delta \\kappa| \\equiv |\\kappa_{\\mathrm{num}}-\\kappa_{\\mathrm{exact}}| \\;=\\; C_{\\kappa}\\,\\frac{h^{2}}{R^{3}},\n$$\n其中 $C_{\\kappa}$ 是一个 $\\mathcal{O}(1)$ 的无量纲常数，它可能取决于界面的方向和局部的体积分数分布，但与 $h$ 或 $R$ 无关。\n\n任务：\n1) 仅使用不可压缩稳态斯托克斯动量平衡和毛细法向应力跳跃，确定完美重构的圆形界面（即 $\\Delta \\kappa=0$）的连续平衡压力场 $p(r)$，该压力场以外部流体中恒定的远场压力 $p_{\\infty}$ 为参考。\n\n2) 现在假设唯一的误差源是上述指定的曲率误差 $\\Delta \\kappa$，并且力平衡离散化抵消了所有其他的离散毛细-压力不平衡。通过在液滴尺度上平衡残余法向毛细应力与粘性应力，对由该残余毛细误差产生的稳态伪电流进行建模。取特征流体动力学长度为液滴半径 $R$。推导伪速度大小 $U_{s}$ 的估计值，用 $\\sigma$、$\\mu$、$R$、$h$ 和 $C_{\\kappa}$ 表示。\n\n请以 $U_{s}$ 的单个闭式解析表达式的形式提供您的最终答案。在最终的方框答案中不要包含单位。无需进行数值四舍五入。",
            "solution": "该问题要求两个结果：首先，理想静止液滴的平衡压力场；其次，由曲率计算中的数值误差产生的伪电流大小的估计。\n\n首先，我们求解完美重构的圆形界面的平衡压力场 $p(r)$，此时数值曲率误差 $\\Delta \\kappa$ 为零。该系统由不可压缩稳态斯托克斯方程描述。动量平衡方程为：\n$$ \\nabla p = \\mu \\nabla^2 \\mathbf{u} $$\n其中 $p$ 是压力，$\\mu$ 是动力粘度，$\\mathbf{u}$ 是速度场。问题指出，对于完美重构的界面，系统处于静止状态，即速度为零的静力平衡。因此，$\\mathbf{u} = \\mathbf{0}$。将此代入斯托克斯方程可得：\n$$ \\nabla p = \\mathbf{0} $$\n该方程意味着压力 $p$ 在每个流体相内部在空间上是恒定的。设 $p_{in}$ 表示液滴内部的压力（径向位置 $r  R$），$p_{out}$ 表示周围流体中的压力（$r  R$）。\n\n在两种不互溶液体的界面处（$r=R$），压力是不连续的。压力跳跃由 Young-Laplace 方程确定，该方程将跳跃与表面张力系数 $\\sigma$ 和界面曲率 $\\kappa$ 联系起来。对于二维界面，该关系为：\n$$ p_{in} - p_{out} = \\sigma \\kappa $$\n问题指明，对于半径为 $R$ 的完美圆形界面，精确曲率为 $\\kappa_{\\mathrm{exact}} = 1/R$。因此，压力跳跃为：\n$$ p_{in} - p_{out} = \\frac{\\sigma}{R} $$\n问题还指出，外部流体中的远场压力是一个常数 $p_{\\infty}$。由于外部流体中的压力处处恒定，我们必然有 $p_{out} = p_{\\infty}$。将此代入压力跳跃方程，我们可以确定液滴内部的压力：\n$$ p_{in} = p_{\\infty} + \\frac{\\sigma}{R} $$\n问题要求的是相对于 $p_{\\infty}$ 的压力场 $p(r)$，即 $p(r) - p_{\\infty}$。我们可以将该场表示为径向坐标 $r$ 的分段函数：\n$$\np(r) - p_{\\infty} =\n\\begin{cases}\n\\frac{\\sigma}{R}  \\text{对于 } r  R \\\\\n0  \\text{对于 } r  R\n\\end{cases}\n$$\n这描述了在没有数值误差情况下的理想压力场。\n\n接下来，我们推导由数值曲率计算误差引起的伪速度大小 $U_s$ 的估计值。问题指出，不平衡的唯一来源是曲率误差。该误差导致界面上产生残余法向应力，从而驱动一种非物理流动，即伪电流。问题指导我们通过在液滴尺度上平衡残余法向毛细应力与粘性应力来对此进行建模。\n\n源于毛细项的残余应力大小 $\\tau_{cap, err}$ 与表面张力系数 $\\sigma$ 和曲率误差的大小 $|\\Delta \\kappa|$ 成正比：\n$$ \\tau_{cap, err} \\sim \\sigma |\\Delta \\kappa| $$\n伪电流处于稳态斯托克斯流态，因此驱动力被粘性力所平衡。流体中的特征粘性应力 $\\tau_{visc}$ 可以通过量纲分析进行估计。它与动力粘度 $\\mu$ 和速度的空间梯度成正比。使用伪速度大小 $U_s$ 作为特征速度，液滴半径 $R$ 作为特征长度尺度（如问题中所指定），粘性应力的尺度为：\n$$ \\tau_{visc} \\sim \\mu \\frac{U_s}{R} $$\n在稳态下，当驱动的残余毛细应力与阻尼的粘性应力相平衡时，伪电流就形成了。因此，我们将这两种应力的大小相等：\n$$ \\tau_{visc} \\approx \\tau_{cap, err} $$\n$$ \\frac{\\mu U_s}{R} \\approx \\sigma |\\Delta \\kappa| $$\n问题为二阶精度的 PLIC 方法的曲率误差大小提供了一个具体表达式：\n$$ |\\Delta \\kappa| = C_{\\kappa} \\frac{h^2}{R^3} $$\n其中 $h$ 是网格间距，$C_{\\kappa}$ 是一个量级为 1 的无量纲常数。将此表达式代入我们的应力平衡方程中得到：\n$$ \\frac{\\mu U_s}{R} \\approx \\sigma \\left( C_{\\kappa} \\frac{h^2}{R^3} \\right) $$\n最后，我们通过将伪速度大小 $U_s$ 在方程的一侧分离出来，来求解它：\n$$ U_s \\approx \\frac{R}{\\mu} \\sigma C_{\\kappa} \\frac{h^2}{R^3} $$\n$$ U_s \\approx \\frac{\\sigma C_{\\kappa} h^2}{\\mu R^2} $$\n该表达式根据给定的物理和数值参数，提供了所求的伪速度大小的估计值。",
            "answer": "$$\\boxed{\\frac{\\sigma C_{\\kappa} h^{2}}{\\mu R^{2}}}$$"
        }
    ]
}