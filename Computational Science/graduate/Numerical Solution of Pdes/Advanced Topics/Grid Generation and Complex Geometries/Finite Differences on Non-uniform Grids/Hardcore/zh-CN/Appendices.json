{
    "hands_on_practices": [
        {
            "introduction": "从均匀网格过渡到非均匀网ge时，首要任务是重新推导差分格式。本练习将指导您使用泰勒级数展开这一基本工具，为一阶导数构建一个具有二阶精度的中心差分格式。掌握这一过程是理解和构建更复杂格式的基石。",
            "id": "3394040",
            "problem": "考虑一个偏微分方程（PDE）的一维离散化，其中，一个足够光滑的函数 $f(x)$ 在三个连续的非均匀节点 $x_{i-1}, x_i, x_{i+1}$ 上进行采样。定义局部网格间距为 $h_{-} = x_i - x_{i-1}$ 和 $h_{+} = x_{i+1} - x_i$，其中 $h_{-} > 0$ 且 $h_{+} > 0$。仅使用这三个函数值 $f_{i-1} = f(x_{i-1})$、$f_i = f(x_i)$ 和 $f_{i+1} = f(x_{i+1})$，构建一个唯一的线性组合\n$$a_{-1} f_{i-1} + a_{0} f_i + a_{+1} f_{i+1}$$\n该组合为一阶导数 $f'(x_i)$ 提供一个一致的近似，且在非均匀网格上使用这三个节点能达到可能的最大代数阶数。从第一性原理出发，推导系数 $a_{-1}$、$a_0$ 和 $a_{+1}$（用 $h_{-}$ 和 $h_{+}$ 表示），确定近似的阶数 $p$，并计算局部展开式中的主截断误差系数 $C$\n$$a_{-1} f_{i-1} + a_{0} f_i + a_{+1} f_{i+1} = f'(x_i) + C\\, f^{(3)}(x_i) + \\text{更高阶项}.$$\n将你的最终答案表示为封闭形式的解析表达式。不需要四舍五入，也不涉及物理单位。",
            "solution": "我们从光滑函数 $f(x)$ 在点 $x_i$ 周围的泰勒级数展开开始，并在相邻节点 $x_{i-1}$ 和 $x_{i+1}$ 处求值。令 $h_{-} = x_i - x_{i-1} > 0$ 且 $h_{+} = x_{i+1} - x_i > 0$。根据泰勒定理，\n\n$$\nf(x_{i-1}) = f(x_i - h_{-}) = f(x_i) - h_{-} f'(x_i) + \\frac{h_{-}^{2}}{2} f''(x_i) - \\frac{h_{-}^{3}}{6} f^{(3)}(x_i) + \\frac{h_{-}^{4}}{24} f^{(4)}(x_i) + \\cdots,\n$$\n\n\n$$\nf(x_{i+1}) = f(x_i + h_{+}) = f(x_i) + h_{+} f'(x_i) + \\frac{h_{+}^{2}}{2} f''(x_i) + \\frac{h_{+}^{3}}{6} f^{(3)}(x_i) + \\frac{h_{+}^{4}}{24} f^{(4)}(x_i) + \\cdots.\n$$\n\n我们寻找系数 $a_{-1}$、$a_0$ 和 $a_{+1}$，使得线性组合\n\n$$\nS = a_{-1} f(x_{i-1}) + a_{0} f(x_i) + a_{+1} f(x_{i+1})\n$$\n\n仅使用这三个点以最高阶数近似 $f'(x_i)$。将泰勒展开式代入 $S$ 并按 $f$ 在 $x_i$ 处的导数整理各项，得到\n\n$$\nS = (a_{-1} + a_0 + a_{+1}) f(x_i) + \\left(- a_{-1} h_{-} + a_{+1} h_{+}\\right) f'(x_i) + \\left(\\frac{a_{-1} h_{-}^{2}}{2} + \\frac{a_{+1} h_{+}^{2}}{2}\\right) f''(x_i)\n$$\n\n\n$$\n\\quad + \\left(- \\frac{a_{-1} h_{-}^{3}}{6} + \\frac{a_{+1} h_{+}^{3}}{6}\\right) f^{(3)}(x_i) + \\cdots.\n$$\n\n为了与目标导数 $f'(x_i)$ 保持一致，我们要求 $f(x_i)$ 的系数为零，而 $f'(x_i)$ 的系数为 $1$。为了使用三个点最大化代数精度阶数，我们进一步消去 $f''(x_i)$ 项。这给出了一个关于 $a_{-1}$、$a_0$ 和 $a_{+1}$ 的线性方程组：\n\n$$\na_{-1} + a_0 + a_{+1} = 0,\n$$\n\n\n$$\n- a_{-1} h_{-} + a_{+1} h_{+} = 1,\n$$\n\n\n$$\n\\frac{a_{-1} h_{-}^{2}}{2} + \\frac{a_{+1} h_{+}^{2}}{2} = 0.\n$$\n\n由第三个方程，我们有 $a_{-1} h_{-}^{2} + a_{+1} h_{+}^{2} = 0$，这意味着\n\n$$\na_{-1} = - a_{+1} \\frac{h_{+}^{2}}{h_{-}^{2}}.\n$$\n\n代入第二个方程，\n\n$$\n- \\left(- a_{+1} \\frac{h_{+}^{2}}{h_{-}^{2}}\\right) h_{-} + a_{+1} h_{+} = 1 \\quad \\Rightarrow \\quad a_{+1} \\left(\\frac{h_{+}^{2}}{h_{-}} + h_{+}\\right) = 1.\n$$\n\n因此\n\n$$\na_{+1} = \\frac{1}{\\dfrac{h_{+}^{2}}{h_{-}} + h_{+}} = \\frac{h_{-}}{h_{+} (h_{-} + h_{+})}.\n$$\n\n然后\n\n$$\na_{-1} = - a_{+1} \\frac{h_{+}^{2}}{h_{-}^{2}} = - \\frac{h_{+}}{h_{-} (h_{-} + h_{+})}.\n$$\n\n最后，使用 $a_0 = - (a_{-1} + a_{+1})$，我们得到\n\n$$\na_0 = \\frac{h_{+}^{2} - h_{-}^{2}}{h_{-} h_{+} (h_{-} + h_{+})}.\n$$\n\n这些系数消除了 $f(x_i)$ 和 $f''(x_i)$ 的贡献，并将 $f'(x_i)$ 项归一化为 $1$。对于三个节点，这是达到最大代数阶数（即二阶）的唯一构造。为计算主截断误差系数，考察 $f^{(3)}(x_i)$ 项：\n\n$$\n\\text{主误差项} = \\left(- \\frac{a_{-1} h_{-}^{3}}{6} + \\frac{a_{+1} h_{+}^{3}}{6}\\right) f^{(3)}(x_i).\n$$\n\n代入 $a_{-1}$ 和 $a_{+1}$：\n\n$$\n- \\frac{a_{-1} h_{-}^{3}}{6} = - \\frac{\\left(- \\dfrac{h_{+}}{h_{-} (h_{-} + h_{+})}\\right) h_{-}^{3}}{6} = \\frac{h_{+} h_{-}^{2}}{6 (h_{-} + h_{+})},\n$$\n\n\n$$\n\\frac{a_{+1} h_{+}^{3}}{6} = \\frac{\\left(\\dfrac{h_{-}}{h_{+} (h_{-} + h_{+})}\\right) h_{+}^{3}}{6} = \\frac{h_{-} h_{+}^{2}}{6 (h_{-} + h_{+})}.\n$$\n\n将这两部分的贡献相加，得到\n\n$$\n\\frac{h_{+} h_{-}^{2} + h_{-} h_{+}^{2}}{6 (h_{-} + h_{+})} = \\frac{h_{-} h_{+} (h_{-} + h_{+})}{6 (h_{-} + h_{+})} = \\frac{h_{-} h_{+}}{6}.\n$$\n\n因此，主截断误差为\n\n$$\nC\\, f^{(3)}(x_i) \\quad \\text{其中} \\quad C = \\frac{h_{-} h_{+}}{6},\n$$\n\n并且近似的阶数 $p=2$，因为误差与乘积 $h_{-} h_{+}$ 成比例，在网格细化（其中 $h_{-}$ 和 $h_{+}$ 都与小参数 $h$ 成比例）的情况下，这是 $\\mathcal{O}(h^{2})$。作为一致性检验，在均匀网格情况 $h_{-} = h_{+} = h$ 下，这些系数简化为 $a_{-1} = - \\dfrac{1}{2 h}$，$a_0 = 0$，$a_{+1} = \\dfrac{1}{2 h}$，以及 $C = \\dfrac{h^{2}}{6}$，这正是 $f'(x_i)$ 的经典二阶中心差分及其正确的主误差项。",
            "answer": "$$\\boxed{\\begin{pmatrix}\n-\\dfrac{h_{+}}{h_{-}\\left(h_{-}+h_{+}\\right)} & \\dfrac{h_{+}^{2}-h_{-}^{2}}{h_{-}h_{+}\\left(h_{-}+h_{+}\\right)} & \\dfrac{h_{-}}{h_{+}\\left(h_{-}+h_{+}\\right)} & 2 & \\dfrac{h_{-}h_{+}}{6}\n\\end{pmatrix}}$$"
        },
        {
            "introduction": "一个好的数值格式不仅要局部精确，还应在全局上遵守潜在的物理守恒律，如质量或能量守恒。本练习将引导您采用积分形式（即有限体积法）推导一个用于扩散方程的格式，该格式能精确地保持离散质量。通过这个练习，您将理解如何构建在长时间模拟中行为更可靠、物理意义更明确的守恒格式。",
            "id": "3394092",
            "problem": "考虑线性扩散偏微分方程 (PDE) $u_{t}=\\nu\\,u_{xx}$，其中扩散系数 $\\nu>0$ 为常数，定义在周期区间 $[0,L]$ 上。设 $\\{x_{i}\\}_{i=0}^{N-1}$ 是 $N$ 个节点的严格递增集合，具有周期性环绕条件 $x_{i+N}=x_{i}+L$，并用 $h_{i}=x_{i+1}-x_{i}$ 表示所有 $i$ 的非均匀间距（索引在模 $N$ 意义下理解）。定义中点 $x_{i+\\frac{1}{2}}=\\frac{x_{i}+x_{i+1}}{2}$ 和对偶单元长度（求积权重）$w_{i}=x_{i+\\frac{1}{2}}-x_{i-\\frac{1}{2}}=\\frac{h_{i-1}+h_{i}}{2}$。利用 PDE 在对偶单元 $[x_{i-\\frac{1}{2}},x_{i+\\frac{1}{2}}]$ 上的积分（守恒）形式，在每个节点 $x_{i}$ 处推导一个守恒的三点、求积加权的半离散有限差分格式，其形式为\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t}\\big(w_{i}u_{i}(t)\\big)=F_{i+\\frac{1}{2}}(t)-F_{i-\\frac{1}{2}}(t),\n$$\n其中，相容的数值通量 $F_{i+\\frac{1}{2}}(t)$ 仅由 $u_{i}(t)$、$u_{i+1}(t)$ 以及 $x_{i}$、$x_{i+1}$ 计算。将得到的格式明确地写成关于 $\\frac{\\mathrm{d}}{\\mathrm{d}t}u_{i}(t)$ 的三点模板形式，用 $u_{i-1}(t)$、$u_{i}(t)$、$u_{i+1}(t)$ 和网格间距表示。\n\n从守恒定律和您的半离散格式出发，证明求积加权的离散质量 $\\sum_{i=0}^{N-1}w_{i}u_{i}(t)$ 对所有 $t\\ge 0$ 都是时间不变量。然后，利用周期性边界条件和 $\\nu$ 的严格正性，论证半离散常微分方程的解在 $t\\to\\infty$ 时收敛到一个与 $i$ 无关的空间常数状态 $u_{i}(t)\\to c$。仅用初始数据 $\\{u_{i}(0)\\}_{i=0}^{N-1}$ 和求积权重 $\\{w_{i}\\}_{i=0}^{N-1}$ 表示常数 $c$。\n\n提供 $c$ 的最终表达式作为您的答案。不需要进行数值计算；给出封闭形式的表达式。不要包含单位。",
            "solution": "我们从扩散方程的守恒形式 $u_t = (\\nu u_x)_x$ 开始。我们将此方程在与节点 $x_i$ 相关联的对偶单元（或控制体积）$[x_{i-\\frac{1}{2}}, x_{i+\\frac{1}{2}}]$ 上积分：\n$$\n\\int_{x_{i-\\frac{1}{2}}}^{x_{i+\\frac{1}{2}}} u_t(x,t) \\,dx = \\int_{x_{i-\\frac{1}{2}}}^{x_{i+\\frac{1}{2}}} \\frac{\\partial}{\\partial x} (\\nu u_x(x,t)) \\,dx\n$$\n对左侧使用莱布尼茨积分法则，对右侧使用微积分基本定理，我们得到：\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t} \\int_{x_{i-\\frac{1}{2}}}^{x_{i+\\frac{1}{2}}} u(x,t) \\,dx = \\left[\\nu u_x(x,t)\\right]_{x_{i-\\frac{1}{2}}}^{x_{i+\\frac{1}{2}}} = \\nu u_x(x_{i+\\frac{1}{2}},t) - \\nu u_x(x_{i-\\frac{1}{2}},t)\n$$\n现在我们引入近似。令 $u_i(t) \\approx u(x_i,t)$。我们使用类似中点求积的法则来近似左侧的积分，假设 $u(x,t)$ 在单元 $[x_{i-\\frac{1}{2}}, x_{i+\\frac{1}{2}}]$ 上近似为常数且等于 $u_i(t)$。该单元的长度为 $w_i = x_{i+\\frac{1}{2}} - x_{i-\\frac{1}{2}}$。\n$$\n\\int_{x_{i-\\frac{1}{2}}}^{x_{i+\\frac{1}{2}}} u(x,t) \\,dx \\approx u_i(t) w_i\n$$\n时间导数项变为 $\\frac{\\mathrm{d}}{\\mathrm{d}t}(w_i u_i(t))$。\n\n右侧的项代表单元边界处的物理通量。我们将数值通量 $F_{i+\\frac{1}{2}}(t)$ 定义为在 $x_{i+\\frac{1}{2}}$ 处对 $\\nu u_x$ 的近似。我们使用基于节点 $x_i$ 和 $x_{i+1}$ 值的二阶中心差分来近似中点 $x_{i+\\frac{1}{2}}$ 处的空间导数 $u_x$：\n$$\nu_x(x_{i+\\frac{1}{2}},t) \\approx \\frac{u(x_{i+1},t) - u(x_i,t)}{x_{i+1}-x_i} = \\frac{u_{i+1}(t) - u_i(t)}{h_i}\n$$\n因此，在界面 $x_{i+\\frac{1}{2}}$ 处的数值通量为：\n$$\nF_{i+\\frac{1}{2}}(t) = \\nu \\frac{u_{i+1}(t) - u_i(t)}{h_i}\n$$\n类似地，在界面 $x_{i-\\frac{1}{2}}$ 处的通量使用节点 $x_{i-1}$ 和 $x_i$ 进行近似：\n$$\nF_{i-\\frac{1}{2}}(t) = \\nu \\frac{u_i(t) - u_{i-1}(t)}{h_{i-1}}\n$$\n将这些表达式代入积分后的方程，得到所需守恒形式的半离散格式：\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t}\\big(w_{i}u_{i}(t)\\big) = \\nu \\frac{u_{i+1}(t) - u_i(t)}{h_i} - \\nu \\frac{u_i(t) - u_{i-1}(t)}{h_{i-1}}\n$$\n由于权重 $w_i$ 不随时间变化，我们有 $\\frac{\\mathrm{d}}{\\mathrm{d}t}(w_i u_i(t)) = w_i \\frac{\\mathrm{d}u_i(t)}{\\mathrm{d}t}$。我们可以写出关于 $\\frac{\\mathrm{d}u_i}{\\mathrm{d}t}$ 的显式三点模板：\n$$\n\\frac{\\mathrm{d}u_i}{\\mathrm{d}t} = \\frac{\\nu}{w_i} \\left( \\frac{u_{i+1} - u_i}{h_i} - \\frac{u_i - u_{i-1}}{h_{i-1}} \\right)\n$$\n代入 $w_i = \\frac{h_{i-1}+h_i}{2}$：\n$$\n\\frac{\\mathrm{d}u_i}{\\mathrm{d}t} = \\frac{2\\nu}{h_{i-1}+h_i} \\left( \\frac{1}{h_{i-1}}u_{i-1} - \\left(\\frac{1}{h_{i-1}} + \\frac{1}{h_i}\\right)u_i + \\frac{1}{h_i}u_{i+1} \\right)\n$$\n总离散质量定义为 $M(t) = \\sum_{i=0}^{N-1} w_i u_i(t)$。我们将 $M(t)$ 对时间求导：\n$$\n\\frac{\\mathrm{d}M}{\\mathrm{d}t} = \\frac{\\mathrm{d}}{\\mathrm{d}t} \\sum_{i=0}^{N-1} w_i u_i(t) = \\sum_{i=0}^{N-1} \\frac{\\mathrm{d}}{\\mathrm{d}t}(w_i u_i(t)) = \\sum_{i=0}^{N-1} \\left( F_{i+\\frac{1}{2}}(t) - F_{i-\\frac{1}{2}}(t) \\right)\n$$\n由于周期性，这是一个伸缩求和，其结果为零：$\\frac{\\mathrm{d}M}{\\mathrm{d}t} = 0$。这证明了总离散质量 $M(t)$ 是时间不变量。\n\n常微分方程组描述了一个离散的扩散过程，该过程会驱动系统趋向于平衡状态，此时所有梯度都消失，即对所有 $i$ 都有 $u_i \\to c$。为了求出这个常数 $c$ 的值，我们利用质量守恒性质。$t\\to\\infty$ 时的总质量必须等于 $t=0$ 时的初始质量。\n$$\nM(\\infty) = M(0)\n$$\n初始质量为 $M(0) = \\sum_{i=0}^{N-1} w_i u_i(0)$。无限时间时的质量为 $M(\\infty) = \\sum_{i=0}^{N-1} w_i c = c \\sum_{i=0}^{N-1} w_i$。\n令两个质量表达式相等并求解 $c$：\n$$\nc \\sum_{i=0}^{N-1} w_i = \\sum_{i=0}^{N-1} w_i u_i(0) \\implies c = \\frac{\\sum_{i=0}^{N-1} w_i u_i(0)}{\\sum_{i=0}^{N-1} w_i}\n$$\n这是初始数据的加权平均值，权重为对偶单元的长度，即初始条件在定义域上均值的离散模拟。",
            "answer": "$$\n\\boxed{\\frac{\\sum_{i=0}^{N-1} w_{i} u_{i}(0)}{\\sum_{i=0}^{N-1} w_{i}}}\n$$"
        },
        {
            "introduction": "即使一个差分格式是局部精确且守恒的，它在某些参数下也可能产生非物理的振荡解，尤其是在求解对流占优问题时。本练习将探讨对流扩散方程的中心差分格式，并分析其何时会违背保证解的单调性的M-矩阵条件。您将通过确定关键的单元Peclet数阈值，深入理解数值稳定性的重要性以及如何避免伪振荡的产生。",
            "id": "3394088",
            "problem": "考虑稳态一维对流扩散边值问题\n$$\n-\\nu\\,u''(x)+\\mu\\,u'(x)=f(x),\\quad x\\in(0,L),\n$$\n带有狄利克雷边界条件 $u(0)=\\ell_0$ 和 $u(L)=\\ell_L$，其中 $\\nu>0$ 和 $\\mu\\in\\mathbb{R}$ 为常数。设 $\\{x_i\\}$ 为严格递增的非均匀网格，在内部节点 $x_i$ 处，相邻间距为 $h_-:=x_i-x_{i-1}>0$ 和 $h_+:=x_{i+1}-x_i>0$。在 $\\{x_{i-1},x_i,x_{i+1}\\}$上通过二次插值离散化 $u''(x_i)$，并在相同的非均匀模板上通过三点中心公式离散化 $u'(x_i)$。这产生一个三对角离散算子行\n$$\na_{i,i-1}\\,u_{i-1}+a_{i,i}\\,u_i+a_{i,i+1}\\,u_{i+1}=b_i,\n$$\n其系数为\n$$\na_{i,i-1}=-\\frac{2\\nu}{h_-(h_-+h_+)}+\\mu\\left(-\\frac{h_+}{h_-(h_-+h_+)}\\right),\\quad\na_{i,i}=\\frac{2\\nu}{h_-h_+}+\\mu\\left(\\frac{h_+-h_-}{h_-h_+}\\right),\n$$\n$$\na_{i,i+1}=-\\frac{2\\nu}{h_+(h_-+h_+)}+\\mu\\left(\\frac{h_-}{h_+(h_-+h_+)}\\right).\n$$\n此处 $b_i$ 汇集了 $f$ 以及在 $x_{i-1}$ 和 $x_{i+1}$ 处的边界条件的贡献。\n\n一个实三对角矩阵是 M-矩阵（单调矩阵），如果其每个对角元为正，每个非对角元为非正，并且矩阵是行弱对角占优的。关注上述局部行，精确确定在 $(\\nu,\\mu,h_-,h_+)$ 的何种参数范围内，M-矩阵条件在节点 $x_i$ 处被违反。然后，通过指定网格、参数 $(\\nu,\\mu)$、边界值和右端项 $f$ 来构造一个具体反例，使得得到的离散解呈现出非单调的内部下冲或过冲（一种伪振荡）。\n\n最后，定义局部上风单元 Peclet 数\n$$\n\\mathrm{Pe}_{\\mathrm{up}}:=\\frac{|\\mu|\\,h_{\\mathrm{up}}}{\\nu},\n$$\n其中，如果 $\\mu>0$，则 $h_{\\mathrm{up}}:=h_-$；如果 $\\mu0$，则 $h_{\\mathrm{up}}:=h_+$。使得只要 $\\mathrm{Pe}_{\\mathrm{up}}\\mathrm{Pe}_{\\star}$，M-矩阵性质就被违反的精确临界阈值 $\\mathrm{Pe}_{\\star}$ 是什么？请将你的最终答案以一个精确数字的形式给出。",
            "solution": "我们从通过泰勒展开或拉格朗日插值得到的标准三点非均匀网格公式开始。在模板 $\\{x_{i-1},x_i,x_{i+1}\\}$ 上，其中 $h_-:=x_i-x_{i-1}$ 和 $h_+:=x_{i+1}-x_i$，在 $x_i$ 处的二阶导数近似为\n$$\nu''(x_i)\\approx \\frac{2}{h_-(h_-+h_+)}\\,u_{i-1}-\\frac{2}{h_-h_+}\\,u_i+\\frac{2}{h_+(h_-+h_+)}\\,u_{i+1}.\n$$\n在非均匀模板上使用三点中心差分，在 $x_i$ 处的一阶导数为\n$$\nu'(x_i)\\approx -\\frac{h_+}{h_-(h_-+h_+)}\\,u_{i-1}+\\frac{h_+-h_-}{h_-h_+}\\,u_i+\\frac{h_-}{h_+(h_-+h_+)}\\,u_{i+1}.\n$$\n将这些代入 $-\\nu u''+\\mu u'$ 得到行系数\n$$\na_{i,i-1}=-\\frac{2\\nu}{h_-(h_-+h_+)}-\\mu\\,\\frac{h_+}{h_-(h_-+h_+)},\n$$\n$$\na_{i,i}=\\frac{2\\nu}{h_-h_+}+\\mu\\,\\frac{h_+-h_-}{h_-h_+},\n$$\n$$\na_{i,i+1}=-\\frac{2\\nu}{h_+(h_-+h_+)}+\\mu\\,\\frac{h_-}{h_+(h_-+h_+)}.\n$$\n我们分析此行的 M-矩阵条件。\n\n1. 非对角元符号。对于 M-矩阵，我们要求 $a_{i,i\\pm 1}\\le 0$。\n- 对于 $a_{i,i-1}$，\n$$\na_{i,i-1}=-\\frac{1}{h_-(h_-+h_+)}\\bigl(2\\nu+\\mu h_+\\bigr).\n$$\n如果 $\\mu\\ge 0$，则 $2\\nu+\\mu h_+0$，所以 $a_{i,i-1}0$，总是可接受的。如果 $\\mu0$，则 $2\\nu+\\mu h_+$ 可能变为负；在这种情况下，$a_{i,i-1}0$，并且当以下条件满足时，M-矩阵条件被违反：\n$$\n2\\nu+\\mu h_+0\\quad\\Longleftrightarrow\\quad |\\mu|\\,h_+2\\nu.\n$$\n- 对于 $a_{i,i+1}$，\n$$\na_{i,i+1}=\\frac{1}{h_+(h_-+h_+)}\\bigl(-2\\nu+\\mu h_-\\bigr).\n$$\n如果 $\\mu\\le 0$，则 $\\mu h_-\\le 0$ 并且 $-2\\nu+\\mu h_-0$，所以 $a_{i,i+1}0$，总是可接受的。如果 $\\mu0$，则 $a_{i,i+1}0$ 精确地发生在\n$$\n-2\\nu+\\mu h_->0\\quad\\Longleftrightarrow\\quad \\mu\\,h_->2\\nu.\n$$\n因此，在所有情况下，只要上风单元长度 $h_{\\mathrm{up}}$ 满足以下条件，位于顺风方向的非对角元就会改变符号并违反 M-矩阵条件\n$$\n|\\mu|\\,h_{\\mathrm{up}}2\\nu,\\quad\\text{其中}\\quad h_{\\mathrm{up}}=\\begin{cases}\nh_-  \\text{如果 } \\mu0,\\\\\nh_+  \\text{如果 } \\mu0.\n\\end{cases}\n$$\n\n2. 对角元符号和对角占优。对角元为\n$$\na_{i,i}=\\frac{2\\nu}{h_-h_+}+\\mu\\,\\frac{h_+-h_-}{h_-h_+}.\n$$\n对于中等对流 $|\\mu|\\le \\frac{2\\nu}{\\max\\{h_-,h_+\\}}$，对角元保持为正。此外，仅扩散项的贡献就满足带等号的弱对角占优：\n$$\n\\frac{2\\nu}{h_-h_+}=\\frac{2\\nu}{h_-(h_-+h_+)}+\\frac{2\\nu}{h_+(h_-+h_+)},\n$$\n而对流项对 $a_{i,i}$ 的贡献是对流项对 $a_{i,i-1}$ 和 $a_{i,i+1}$ 贡献之和的负数，因此只要两个非对角元都是非正的，行弱对角占优就继续成立。因此，M-矩阵性质的丧失取决于顺风方向非对角元的符号，这正是上面导出的条件。\n\n等价地，定义局部上风 Peclet 数\n$$\n\\mathrm{Pe}_{\\mathrm{up}}:=\\frac{|\\mu|\\,h_{\\mathrm{up}}}{\\nu},\n$$\n只要 $\\mathrm{Pe}_{\\mathrm{up}}2$，M-矩阵性质就在节点 $x_i$ 处被违反。\n\n呈现伪振荡的反例。取网格 $\\{x_0,x_1,x_2,x_3\\}=\\{0,1,2,5\\}$，使得在 $x_1$ 处我们有 $h_- = x_1-x_0=1$ 和 $h_+=x_2-x_1=1$，而在 $x_2$ 处我们有 $h_- = x_2-x_1=1$ 和 $h_+=x_3-x_2=3$。选择参数 $\\nu=1$ 和 $\\mu=10$，使得在 $x_2$ 处上风间距为 $h_- = 1$ (因为 $\\mu0$) 且 $\\mu h_-=102\\nu=2$，违反了 M-矩阵条件。施加狄利克雷边界条件 $u(0)=0$ 和 $u(5)=1$，并取 $f\\equiv 0$。\n\n两个内部方程（$x_1$ 处的 $u_1$ 和 $x_2$ 处的 $u_2$）使用上面计算的系数：\n- 在 $x_1$ 处，有 $h_-=1$, $h_+=1$,\n$$\na_{1,0}=-\\frac{2+\\mu}{2}=-6,\\quad a_{1,1}=2,\\quad a_{1,2}=\\frac{\\mu-2}{2}=4.\n$$\n- 在 $x_2$ 处，有 $h_-=1$, $h_+=3$,\n$$\na_{2,1}=-\\frac{2+3\\mu}{4}=-8,\\quad a_{2,2}=\\frac{2}{3}+\\frac{2\\mu}{3}=\\frac{22}{3},\\quad a_{2,3}=\\frac{\\mu-2}{12}=\\frac{2}{3}.\n$$\n当 $f\\equiv 0$ 时，右端项简化为边界贡献：\n$$\n2\\,u_1+4\\,u_2=-a_{1,0}\\,u_0=0,\\qquad -8\\,u_1+\\frac{22}{3}\\,u_2=-a_{2,3}\\,u_3=-\\frac{2}{3}\\cdot 1=-\\frac{2}{3}.\n$$\n求解该 $2\\times 2$ 系统得到\n$$\nu_1=-2\\,u_2,\\qquad 16\\,u_2+\\frac{22}{3}\\,u_2=-\\frac{2}{3}\\ \\Longrightarrow\\ 70\\,u_2=-2\\ \\Longrightarrow\\ u_2=-\\frac{1}{35},\\quad u_1=\\frac{2}{35}.\n$$\n当 $f\\equiv 0$ 且 $\\mu,\\nu0$ 时，连续问题的精确解是从 $0$ 到 $1$ 单调递增的，但是离散解呈现出伪振荡：$u_20$。",
            "answer": "$$\\boxed{2}$$"
        }
    ]
}