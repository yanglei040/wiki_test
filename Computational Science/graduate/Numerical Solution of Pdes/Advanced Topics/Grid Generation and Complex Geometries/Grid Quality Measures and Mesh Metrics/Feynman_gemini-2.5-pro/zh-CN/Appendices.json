{
    "hands_on_practices": [
        {
            "introduction": "在有限体积法中，穿过单元交界面的通量计算精度在很大程度上受网格几何质量的影响。正交性和偏斜度等关键指标量化了网格偏离理想类笛卡尔结构的程度。第一个练习将引导您亲自动手，根据一个给定的单元几何结构，从第一性原理出发计算这些基本指标 ，从而巩固您对它们基于矢量定义的理解。",
            "id": "3402357",
            "problem": "考虑一个标量场 $\\phi$ 的稳态扩散，其受守恒律 $\\nabla \\cdot \\left( \\Gamma \\nabla \\phi \\right) = 0$ 控制，其中 $\\Gamma$ 是一个为正的常数扩散系数。在单元中心有限体积（FV）离散化中，穿过由两个相邻控制体 $P$ 和 $N$ 共享的内部面 $f$ 的扩散通量，是通过对面上的 $\\Gamma \\nabla \\phi \\cdot \\boldsymbol{n}_f$ 进行面积分得到的，其中面面积矢量为 $\\boldsymbol{S}_f = \\boldsymbol{n}_f \\, |\\boldsymbol{S}_f|$。在非正交网格上，经典的两点近似可以通过将 $\\boldsymbol{S}_f$ 分解为平行和垂直于单元中心连线的两个分量来理解，这直接引出了与正交性和偏斜度相关的网格质量度量。\n\n从以下基本依据出发：\n- 扩散通量的定义、散度定理和点积，不假设任何特定的离散公式。\n- 对任意矢量 $\\boldsymbol{a}$ 和单位矢量 $\\hat{\\boldsymbol{e}}$ 的矢量分解恒等式 $\\boldsymbol{a} = \\left( \\boldsymbol{a} \\cdot \\hat{\\boldsymbol{e}} \\right) \\hat{\\boldsymbol{e}} + \\left[ \\boldsymbol{a} - \\left( \\boldsymbol{a} \\cdot \\hat{\\boldsymbol{e}} \\right) \\hat{\\boldsymbol{e}} \\right]$。\n\n对于二维空间中的一个特定内部面 $f$，给定以下条件：\n- 单元中心位置 $\\boldsymbol{x}_P = (0, 0)$ 和 $\\boldsymbol{x}_N = \\left(1, \\frac{1}{\\sqrt{3}}\\right)$。\n- 面单位法向量 $\\boldsymbol{n}_f = (1, 0)$ 和面面积大小 $|\\boldsymbol{S}_f| = 1$，因此 $\\boldsymbol{S}_f = (1, 0)$。\n- 面中心 $\\boldsymbol{x}_f = \\left(\\frac{1}{2}, \\frac{1}{10}\\right)$。\n- 令 $\\boldsymbol{d} = \\boldsymbol{x}_N - \\boldsymbol{x}_P$ 且 $\\hat{\\boldsymbol{d}} = \\boldsymbol{d} / |\\boldsymbol{d}|$。\n\n仅使用上述基本依据和所提供的几何信息，完成以下任务：\n1) 将面 $f$ 的正交因子 $O$ 定义为 $\\boldsymbol{n}_f$ 和 $\\hat{\\boldsymbol{d}}$ 之间夹角的余弦值，即 $O = \\left| \\boldsymbol{n}_f \\cdot \\hat{\\boldsymbol{d}} \\right|$，并根据数据推导其值。\n2) 将偏斜矢量 $\\boldsymbol{s}$ 定义为从穿过 $\\boldsymbol{x}_P$ 和 $\\boldsymbol{x}_N$ 的直线与面的正交交点到实际面中心 $\\boldsymbol{x}_f$ 的矢量。准确地说，令 $\\boldsymbol{x}_I$ 为连接 $\\boldsymbol{x}_P$ 和 $\\boldsymbol{x}_N$ 的线段上与 $\\boldsymbol{x}_f$ 具有相同面法向坐标的唯一点；则 $\\boldsymbol{s} = \\boldsymbol{x}_f - \\boldsymbol{x}_I$。定义归一化偏斜度度量 $K = \\frac{|\\boldsymbol{s}|}{|\\boldsymbol{d}|}$，并根据数据推导其值。\n3) 结合这些结果，构建无量纲网格质量指标\n$$\nM \\;=\\; \\frac{O^2}{\\,1 + K^2\\,}.\n$$\n使用步骤 1-2 的结果，从第一性原理计算 $M$。\n\n将 $M$ 的最终值报告为一个无量纲数，四舍五入到四位有效数字。最终答案中不要包含任何单位。",
            "solution": "首先根据所提供的标准对问题进行验证。\n\n**第 1 步：提取已知条件**\n-   控制方程：$\\nabla \\cdot \\left( \\Gamma \\nabla \\phi \\right) = 0$。\n-   离散化方法：单元中心有限体积（FV）。\n-   单元中心位置：$\\boldsymbol{x}_P = (0, 0)$ 和 $\\boldsymbol{x}_N = \\left(1, \\frac{1}{\\sqrt{3}}\\right)$。\n-   面单位法向量：$\\boldsymbol{n}_f = (1, 0)$。\n-   面面积大小：$|\\boldsymbol{S}_f| = 1$。\n-   面面积矢量：$\\boldsymbol{S}_f = (1, 0)$。\n-   面中心：$\\boldsymbol{x}_f = \\left(\\frac{1}{2}, \\frac{1}{10}\\right)$。\n-   单元中心间矢量：$\\boldsymbol{d} = \\boldsymbol{x}_N - \\boldsymbol{x}_P$。\n-   沿 $\\boldsymbol{d}$ 方向的单位矢量：$\\hat{\\boldsymbol{d}} = \\boldsymbol{d} / |\\boldsymbol{d}|$。\n-   正交因子：$O = \\left| \\boldsymbol{n}_f \\cdot \\hat{\\boldsymbol{d}} \\right|$。\n-   偏斜矢量：$\\boldsymbol{s} = \\boldsymbol{x}_f - \\boldsymbol{x}_I$，其中 $\\boldsymbol{x}_I$ 是线段 $\\overline{\\boldsymbol{x}_P \\boldsymbol{x}_N}$ 上的点，满足 $(\\boldsymbol{x}_I - \\boldsymbol{x}_f) \\cdot \\boldsymbol{n}_f = 0$。\n-   归一化偏斜度度量：$K = \\frac{|\\boldsymbol{s}|}{|\\boldsymbol{d}|}$。\n-   网格质量指标：$M = \\frac{O^2}{\\,1 + K^2\\,}$。\n\n**第 2 步：使用提取的已知条件进行验证**\n该问题在计算流体动力学和偏微分方程数值方法领域内定义明确。正交性和偏斜度的概念是标准的网格质量度量。所有需要的数据都已提供，待计算量（$O$、$K$、$M$）的定义在数学上是精确且无歧义的。该问题具有科学依据，是客观、完整且适定的。不存在矛盾或不切实际的假设。\n\n**第 3 步：结论与行动**\n该问题被判定为有效。将提供完整的解答。\n\n**求解推导**\n\n根据要求，求解过程分三部分进行：计算正交因子 $O$，计算归一化偏斜度度量 $K$，最后计算网格质量指标 $M$。\n\n**1. 计算正交因子 $O$**\n\n首先，我们确定连接单元中心 $\\boldsymbol{x}_P$ 和 $\\boldsymbol{x}_N$ 的矢量 $\\boldsymbol{d}$：\n$$\n\\boldsymbol{d} = \\boldsymbol{x}_N - \\boldsymbol{x}_P = \\left(1, \\frac{1}{\\sqrt{3}}\\right) - (0, 0) = \\left(1, \\frac{1}{\\sqrt{3}}\\right)\n$$\n接下来，我们计算 $\\boldsymbol{d}$ 的大小：\n$$\n|\\boldsymbol{d}| = \\sqrt{1^2 + \\left(\\frac{1}{\\sqrt{3}}\\right)^2} = \\sqrt{1 + \\frac{1}{3}} = \\sqrt{\\frac{4}{3}} = \\frac{2}{\\sqrt{3}}\n$$\n则 $\\boldsymbol{d}$ 方向上的单位矢量 $\\hat{\\boldsymbol{d}}$ 为：\n$$\n\\hat{\\boldsymbol{d}} = \\frac{\\boldsymbol{d}}{|\\boldsymbol{d}|} = \\frac{\\left(1, \\frac{1}{\\sqrt{3}}\\right)}{\\frac{2}{\\sqrt{3}}} = \\frac{\\sqrt{3}}{2} \\left(1, \\frac{1}{\\sqrt{3}}\\right) = \\left(\\frac{\\sqrt{3}}{2}, \\frac{1}{2}\\right)\n$$\n正交因子 $O$ 定义为面单位法向量 $\\boldsymbol{n}_f$ 和单位矢量 $\\hat{\\boldsymbol{d}}$ 的点积的绝对值：\n$$\nO = |\\boldsymbol{n}_f \\cdot \\hat{\\boldsymbol{d}}| = \\left| (1, 0) \\cdot \\left(\\frac{\\sqrt{3}}{2}, \\frac{1}{2}\\right) \\right| = \\left| 1 \\cdot \\frac{\\sqrt{3}}{2} + 0 \\cdot \\frac{1}{2} \\right| = \\frac{\\sqrt{3}}{2}\n$$\n\n**2. 计算归一化偏斜度度量 $K$**\n\n点 $\\boldsymbol{x}_I$ 位于通过 $\\boldsymbol{x}_P$ 和 $\\boldsymbol{x}_N$ 的直线上。该直线上的任意点可以参数化为 $\\boldsymbol{x}(t) = \\boldsymbol{x}_P + t(\\boldsymbol{x}_N - \\boldsymbol{x}_P) = t \\boldsymbol{d}$，其中 $t$ 是一个标量参数。因此，对于某个特定值 $t_I$，有 $\\boldsymbol{x}_I = t_I \\boldsymbol{d}$。\n\n$\\boldsymbol{x}_I$ 的定义条件是它与面中心 $\\boldsymbol{x}_f$ 具有相同的面法向坐标。用数学方式表示为 $\\boldsymbol{x}_I \\cdot \\boldsymbol{n}_f = \\boldsymbol{x}_f \\cdot \\boldsymbol{n}_f$。我们将 $\\boldsymbol{x}_I$ 的表达式和给定的矢量代入：\n$$\n(t_I \\boldsymbol{d}) \\cdot \\boldsymbol{n}_f = \\boldsymbol{x}_f \\cdot \\boldsymbol{n}_f\n$$\n$$\nt_I (\\boldsymbol{d} \\cdot \\boldsymbol{n}_f) = \\boldsymbol{x}_f \\cdot \\boldsymbol{n}_f\n$$\n我们计算所需的点积：\n$$\n\\boldsymbol{d} \\cdot \\boldsymbol{n}_f = \\left(1, \\frac{1}{\\sqrt{3}}\\right) \\cdot (1, 0) = 1\n$$\n$$\n\\boldsymbol{x}_f \\cdot \\boldsymbol{n}_f = \\left(\\frac{1}{2}, \\frac{1}{10}\\right) \\cdot (1, 0) = \\frac{1}{2}\n$$\n将这些值代回关于 $t_I$ 的方程中：\n$$\nt_I (1) = \\frac{1}{2} \\implies t_I = \\frac{1}{2}\n$$\n由于 $t_I = \\frac{1}{2}$ 介于 0 和 1 之间，点 $\\boldsymbol{x}_I$ 按要求位于线段 $\\overline{\\boldsymbol{x}_P \\boldsymbol{x}_N}$ 上。现在我们求 $\\boldsymbol{x}_I$ 的坐标：\n$$\n\\boldsymbol{x}_I = \\frac{1}{2} \\boldsymbol{d} = \\frac{1}{2} \\left(1, \\frac{1}{\\sqrt{3}}\\right) = \\left(\\frac{1}{2}, \\frac{1}{2\\sqrt{3}}\\right)\n$$\n偏斜矢量 $\\boldsymbol{s}$ 是面中心 $\\boldsymbol{x}_f$ 和交点 $\\boldsymbol{x}_I$ 之间的差：\n$$\n\\boldsymbol{s} = \\boldsymbol{x}_f - \\boldsymbol{x}_I = \\left(\\frac{1}{2}, \\frac{1}{10}\\right) - \\left(\\frac{1}{2}, \\frac{1}{2\\sqrt{3}}\\right) = \\left(0, \\frac{1}{10} - \\frac{1}{2\\sqrt{3}}\\right)\n$$\n偏斜矢量的大小为：\n$$\n|\\boldsymbol{s}| = \\left| \\frac{1}{10} - \\frac{1}{2\\sqrt{3}} \\right| = \\left| \\frac{\\sqrt{3} - 5}{10\\sqrt{3}} \\right|\n$$\n由于 $\\sqrt{3} \\approx 1.73205  5$，绝对值内的项为负。因此：\n$$\n|\\boldsymbol{s}| = \\frac{5 - \\sqrt{3}}{10\\sqrt{3}} = \\frac{\\sqrt{3}(5 - \\sqrt{3})}{10 \\cdot 3} = \\frac{5\\sqrt{3} - 3}{30}\n$$\n归一化偏斜度度量 $K$ 是 $|\\boldsymbol{s}|$ 与 $|\\boldsymbol{d}|$ 的比值：\n$$\nK = \\frac{|\\boldsymbol{s}|}{|\\boldsymbol{d}|} = \\frac{\\frac{5\\sqrt{3} - 3}{30}}{\\frac{2}{\\sqrt{3}}} = \\frac{(5\\sqrt{3} - 3)\\sqrt{3}}{30 \\cdot 2} = \\frac{5 \\cdot 3 - 3\\sqrt{3}}{60} = \\frac{15 - 3\\sqrt{3}}{60} = \\frac{5 - \\sqrt{3}}{20}\n$$\n\n**3. 计算网格质量指标 $M$**\n\n网格质量指标 $M$ 由公式 $M = \\frac{O^2}{1 + K^2}$ 给出。\n我们有 $O = \\frac{\\sqrt{3}}{2}$，所以 $O^2 = \\left(\\frac{\\sqrt{3}}{2}\\right)^2 = \\frac{3}{4}$。\n我们有 $K = \\frac{5 - \\sqrt{3}}{20}$，所以 $K^2$ 是：\n$$\nK^2 = \\left(\\frac{5 - \\sqrt{3}}{20}\\right)^2 = \\frac{5^2 - 2(5)\\sqrt{3} + (\\sqrt{3})^2}{20^2} = \\frac{25 - 10\\sqrt{3} + 3}{400} = \\frac{28 - 10\\sqrt{3}}{400} = \\frac{14 - 5\\sqrt{3}}{200}\n$$\n现在我们计算 $1 + K^2$：\n$$\n1 + K^2 = 1 + \\frac{14 - 5\\sqrt{3}}{200} = \\frac{200 + 14 - 5\\sqrt{3}}{200} = \\frac{214 - 5\\sqrt{3}}{200}\n$$\n最后，我们将这些表达式代入 $M$ 的公式中：\n$$\nM = \\frac{O^2}{1 + K^2} = \\frac{\\frac{3}{4}}{\\frac{214 - 5\\sqrt{3}}{200}} = \\frac{3}{4} \\cdot \\frac{200}{214 - 5\\sqrt{3}} = \\frac{3 \\cdot 50}{214 - 5\\sqrt{3}} = \\frac{150}{214 - 5\\sqrt{3}}\n$$\n为了获得最终的数值，我们使用近似值 $\\sqrt{3} \\approx 1.73205$：\n$$\nM \\approx \\frac{150}{214 - 5(1.73205)} = \\frac{150}{214 - 8.66025} = \\frac{150}{205.33975} \\approx 0.730504\n$$\n四舍五入到四位有效数字，我们得到 $M = 0.7305$。",
            "answer": "$$\n\\boxed{0.7305}\n$$"
        },
        {
            "introduction": "虽然均匀的各向同性网格很简单，但它们的计算效率通常不高。对于在某个方向上变化比其他方向更快的解，沿变化较缓方向拉伸的各向异性网格能以更低的成本提供相同的精度。本练习将指导您解决一个理论优化问题 ，推导出一个能最小化误差与成本组合函数的最优网格长宽比，揭示各向异性网格自适应背后的核心原理。",
            "id": "3402345",
            "problem": "考虑一个定义在矩形域 $\\Omega \\subset \\mathbb{R}^{2}$ 上的标量场 $u(x,y)$，该矩形域的边长为 $L_{x}  0$ 和 $L_{y}  0$。其中 $u$ 是一个二阶椭圆偏微分方程 (PDE) 的解。假设 $u$ 的黑塞矩阵在空间上是常数，并且在坐标基底下是对角的，即 $\\nabla^{2} u = \\operatorname{diag}(\\alpha, \\beta)$，其中 $\\alpha  0$ 且 $\\beta  0$。你需要设计一个结构化的、轴对齐的矩形网格，它在 $x$ 方向上有 $n_{x}$ 个细分，在 $y$ 方向上有 $n_{y}$ 个细分。单元边长为 $h_{x} = L_{x}/n_{x}$ 和 $h_{y} = L_{y}/n_{y}$，单元总数为 $N = n_{x} n_{y} = A/(h_{x} h_{y})$，其中 $A = L_{x} L_{y}$ 是域的面积。\n\n作为一种网格质量度量，我们考虑在与坐标轴对齐的矩形上的分片线性有限元的主阶插值误差代理，该代理是从具有常数黑塞矩阵的 $u$ 的泰勒余项中获得的。该代理的形式为\n$$\nE(h_{x}, h_{y}) = c \\, A \\left(\\alpha \\, h_{x}^{2} + \\beta \\, h_{y}^{2}\\right),\n$$\n其中 $c  0$ 是一个常数，其值仅取决于范数的选择和参考单元的缩放。作为计算成本模型，我们考虑单元数量，\n$$\nC(h_{x}, h_{y}) = N = \\frac{A}{h_{x} h_{y}}.\n$$\n为了阐明自适应网格划分中的质量-成本权衡，定义复合目标函数\n$$\nJ(h_{x}, h_{y}) = E(h_{x}, h_{y}) + \\mu \\, C(h_{x}, h_{y}) = c \\, A \\left(\\alpha \\, h_{x}^{2} + \\beta \\, h_{y}^{2}\\right) + \\mu \\, \\frac{A}{h_{x} h_{y}},\n$$\n其中 $\\mu  0$ 是一个固定参数，表示每个单元的计算成本，其单位与 $E$ 的单位一致。\n\n从矩形上插值误差的泰勒余项表征、结构化网格上离散单元尺寸与单元数量之间的关系以及上述复合目标函数的定义出发，推导最优各向异性比\n$$\nr^{\\star} = \\frac{h_{y}}{h_{x}},\n$$\n该比率能在 $h_{x}  0$ 和 $h_{y}  0$ 的范围内最小化 $J(h_{x}, h_{y})$。请将你的最终答案表示为仅包含 $\\alpha$ 和 $\\beta$ 的闭式解析表达式。不需要进行数值取整。请以无单位的 $r^{\\star}$ 公式形式提供你的最终答案。",
            "solution": "我们的目标是最小化复合目标函数 $J(h_x, h_y)$:\n$$J(h_{x}, h_{y}) = c \\, A \\left(\\alpha \\, h_{x}^{2} + \\beta \\, h_{y}^{2}\\right) + \\mu \\, \\frac{A}{h_{x} h_{y}}$$\n为了找到最小值，我们计算 $J$ 相对于 $h_x$ 和 $h_y$ 的偏导数，并将它们设为零。\n\n对 $h_x$ 求偏导：\n$$\\frac{\\partial J}{\\partial h_x} = c \\, A (2\\alpha h_x) - \\frac{\\mu A}{h_x^2 h_y}$$\n将其设为零：\n$$2c\\alpha h_x = \\frac{\\mu}{h_x^2 h_y} \\implies \\mu = 2c\\alpha h_x^3 h_y \\quad (*)$$\n\n对 $h_y$ 求偏导：\n$$\\frac{\\partial J}{\\partial h_y} = c \\, A (2\\beta h_y) - \\frac{\\mu A}{h_x h_y^2}$$\n将其设为零：\n$$2c\\beta h_y = \\frac{\\mu}{h_x h_y^2} \\implies \\mu = 2c\\beta h_x h_y^3 \\quad (**)$$\n\n联立方程 $(*)$ 和 $(**)$，我们得到两个关于 $\\mu$ 的表达式必须相等：\n$$2c\\alpha h_x^3 h_y = 2c\\beta h_x h_y^3$$\n由于 $h_x > 0$, $h_y > 0$ 且 $c > 0$，我们可以将等式两边同时除以 $2c h_x h_y$：\n$$\\alpha h_x^2 = \\beta h_y^2$$\n重新整理得到各向异性比 $r = h_y/h_x$ 的平方：\n$$\\frac{h_y^2}{h_x^2} = \\frac{\\alpha}{\\beta}$$\n$$r^2 = \\frac{\\alpha}{\\beta}$$\n取正平方根（因为边长必须为正），我们得到最优各向异性比：\n$$r^{\\star} = \\frac{h_y}{h_x} = \\sqrt{\\frac{\\alpha}{\\beta}}$$\n这个结果表明，最优的单元长宽比与解的曲率（由黑塞矩阵的特征值 $\\alpha$ 和 $\\beta$ 表示）的平方根成正比，这正是各向异性网格自适应的核心原则。",
            "answer": "$$\n\\boxed{\\sqrt{\\frac{\\alpha}{\\beta}}}\n$$"
        },
        {
            "introduction": "网格的选择可能对偏微分方程的解产生巨大且有时非直观的影响。对于以对流为主的问题尤其如此，其中网格线与流动方向之间的未对齐可能引入严重的、非物理的振荡。这个动手数值实验  让您能够直接观察并量化这一现象，通过将网格对齐指标与伪振荡的增长进行关联，为理解网格质量的实际影响提供了有力的一课。",
            "id": "3402349",
            "problem": "要求您设计并实现一个数值实验，以检验以下假设：将网格边缘与梯度方向对齐可以减少对流主导问题中的伪振荡。考虑在单位正方形域上具有周期性边界的二维线性平流偏微分方程 (PDE)：\n$$\n\\frac{\\partial u}{\\partial t} + \\boldsymbol{a}\\cdot\\nabla u = 0,\n$$\n其中 $u=u(x,y,t)$，$\\boldsymbol{a}=(a_x,a_y)$ 是一个常数平流速度，$\\nabla u$ 是 $u$ 的空间梯度。初始数据是一个沿着单位方向向量 $\\boldsymbol{n}=(\\cos\\alpha,\\sin\\alpha)$ 对齐的不连续亥维赛阶跃函数：\n$$\nu(x,y,0) = \\begin{cases}\n1,  \\text{if } x\\cos\\alpha + y\\sin\\alpha \\ge 0.5, \\\\\n0,  \\text{otherwise}.\n\\end{cases}\n$$\n该实验在 $[0,1]\\times[0,1]$ 上使用一个具有 $N_x=N_y$ 个点的均匀笛卡尔网格，并采用周期性边界条件。使用单个前向欧拉时间步和中心差分将解从 $t=0$ 推进到 $t=\\Delta t$：\n$$\nu^{1}_{i,j} = u^{0}_{i,j} - \\Delta t\\left( a_x \\frac{u^{0}_{i,j+1}-u^{0}_{i,j-1}}{2\\Delta x} + a_y \\frac{u^{0}_{i+1,j}-u^{0}_{i-1,j}}{2\\Delta y} \\right),\n$$\n其中 $(i,j)$ 索引网格节点，$\\Delta x = 1/N_x$，$\\Delta y = 1/N_y$。通过取 $\\boldsymbol{a} = \\boldsymbol{n} = (\\cos\\alpha,\\sin\\alpha)$ 和单位速率 $\\|\\boldsymbol{a}\\|=1$，将平流速度设置为与初始数据的梯度方向对齐。角度必须以弧度表示。\n\n将在点 $x$ 处的失准度量定义为 $\\nabla u$ 与最近的网格边缘方向之间的锐角。由于初始条件具有恒定的梯度方向 $\\boldsymbol{n}$，这简化为一个全局失准标量\n$$\n\\phi = \\min\\left\\{|\\alpha-0|,\\left|\\frac{\\pi}{2}-\\alpha\\right|\\right\\},\n$$\n即 $\\boldsymbol{n}$ 与最近的坐标轴方向之间的锐角。将网格函数 $U_{i,j}$ 的二维离散全变分定义为\n$$\n\\mathrm{TV}(U) = \\sum_{i,j}\\left( \\left|U_{i,j+1} - U_{i,j}\\right| + \\left|U_{i+1,j} - U_{i,j}\\right| \\right),\n$$\n采用周期性索引。从 $u^0$ 推进一个时间步到 $u^1$ 后，计算全变分的分数变化\n$$\n\\Delta \\mathrm{TV} = \\frac{\\mathrm{TV}(u^1)-\\mathrm{TV}(u^0)}{\\mathrm{TV}(u^0)}.\n$$\n为了本实验的目的，如果且仅如果 $\\mathrm{TV}(u^1)\\le \\mathrm{TV}(u^0)$ 并且 $u^1$ 在网格上处处保持在 $[0,1]$ 的界限内，则称该格式在此单步上表现出全变分递减 (TVD) 行为。\n\n您的任务是实现上述过程，并为一组测试角度计算失准度量 $\\phi$、全变分的分数变化 $\\Delta \\mathrm{TV}$ 和布尔型 TVD 标志。此外，计算整个测试集中失准值列表 $\\{\\phi_k\\}$ 与相应的全变分分数变化列表 $\\{\\Delta \\mathrm{TV}_k\\}$ 之间的皮尔逊相关系数。\n\n对所有测试用例使用以下参数值：\n- 网格尺寸：$N_x=N_y=200$，因此 $\\Delta x=\\Delta y=1/200$。\n- 时间步长：$\\Delta t = 0.4\\,\\Delta x$。\n- 平流速度：$\\boldsymbol{a} = (\\cos\\alpha,\\sin\\alpha)$，单位模长。\n- 边界条件：在 $[0,1]\\times[0,1]$ 上为周期性。\n\n测试集包含以下角度（以弧度为单位）：\n- 情况 1：$\\alpha = 0$。\n- 情况 2：$\\alpha = \\pi/8$。\n- 情况 3：$\\alpha = \\pi/4$。\n- 情况 4：$\\alpha = 3\\pi/8$。\n- 情况 5：$\\alpha = \\pi/2$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，顺序如下：\n$$\n[\\rho, \\phi_1, \\Delta \\mathrm{TV}_1, \\text{TVD}_1, \\phi_2, \\Delta \\mathrm{TV}_2, \\text{TVD}_2, \\phi_3, \\Delta \\mathrm{TV}_3, \\text{TVD}_3, \\phi_4, \\Delta \\mathrm{TV}_4, \\text{TVD}_4, \\phi_5, \\Delta \\mathrm{TV}_5, \\text{TVD}_5],\n$$\n其中 $\\rho$ 是 $\\{\\phi_k\\}$ 和 $\\{\\Delta \\mathrm{TV}_k\\}$ 之间的皮尔逊相关系数，每个 $\\phi_k$ 和 $\\Delta \\mathrm{TV}_k$ 是浮点数，每个 $\\text{TVD}_k$ 是布尔值。角度必须以弧度报告。不得打印任何其他文本。输出使用所选编程语言中浮点数和布尔值的默认字符串表示。",
            "solution": "该问题陈述已经过验证，被认为是一个适定且有科学依据的数值实验。它是自洽的，所有必要的参数、方程和度量都已明确定义。其目标是研究计算网格与解的梯度的对齐方式与求解线性平流方程时伪振荡的产生之间的关系。\n\n实验的核心在于对二维线性平流偏微分方程 (PDE)\n$$\n\\frac{\\partial u}{\\partial t} + \\boldsymbol{a}\\cdot\\nabla u = 0,\n$$\n进行单步数值求解，并量化数值误差。该问题建立了一个特定的场景，以检验失准（即梯度 $\\nabla u$ 与网格方向之间的不对齐）会引入数值误差的假设，特别是表现为解的全变分增加的振荡。\n\n该数值实验的方法如下：\n\n1.  **域和初始条件的离散化**：将连续域 $[0,1]\\times[0,1]$ 离散化为一个大小为 $N_x \\times N_y$ 的均匀笛卡尔网格，其中 $N_x = N_y = 200$。网格点 $(x_j, y_i)$ 由 $x_j=j\\Delta x$ 和 $y_i=i\\Delta y$ 给出，其中 $i,j \\in \\{0, 1, ..., N-1\\}$，$N=200$，$\\Delta x = \\Delta y = 1/N$。初始条件是一个亥维赛阶跃函数，定义为\n    $$\n    u(x,y,0) = u^0(x,y) = \\begin{cases} 1,  \\text{if } x\\cos\\alpha + y\\sin\\alpha \\ge 0.5 \\\\ 0,  \\text{otherwise}. \\end{cases}\n    $$\n    此初始条件的梯度垂直于不连续线 $x\\cos\\alpha+y\\sin\\alpha=0.5$，因此具有由向量 $\\boldsymbol{n} = (\\cos\\alpha, \\sin\\alpha)$ 给出的恒定方向。在每个网格点 $(x_j, y_i)$ 上评估此初始条件，以生成离散初始数据数组 $u^0_{i,j}$。\n\n2.  **数值时间演化**：使用用于时间积分的前向欧拉法和用于空间导数的二阶中心差分格式，将解从时间 $t=0$ 推进到 $t=\\Delta t$。这被称为前向时间中心空间 (FTCS) 格式。更新公式明确给出为\n    $$\n    u^{1}_{i,j} = u^{0}_{i,j} - \\Delta t\\left( a_x \\frac{u^{0}_{i,j+1}-u^{0}_{i,j-1}}{2\\Delta x} + a_y \\frac{u^{0}_{i+1,j}-u^{0}_{i-1,j}}{2\\Delta y} \\right).\n    $$\n    平流速度 $\\boldsymbol{a}=(a_x, a_y)$ 被选择为与初始梯度对齐，因此 $\\boldsymbol{a}=\\boldsymbol{n}=(\\cos\\alpha, \\sin\\alpha)$。强制施加周期性边界条件，意味着索引以 $N$ 为模进行处理。例如，$u^0_{i,N}$ 等同于 $u^0_{i,0}$，$u^0_{N,j}$ 等同于 $u^0_{0,j}$。这在计算上通过对数据数组执行循环移位操作来实现。\n\n3.  **失准和数值误差的量化**：\n    *   **失准度量 ($\\phi$)**：解的梯度（其方向恒为 $\\boldsymbol{n}$）与笛卡尔网格之间的失准程度，通过 $\\boldsymbol{n}$ 与最近的坐标轴（$\\boldsymbol{e}_x=(1,0)$ 或 $\\boldsymbol{e}_y=(0,1)$）之间的锐角 $\\phi$ 来量化。对于给定的角度 $\\alpha \\in [0, \\pi/2]$，其计算公式为 $\\phi = \\min\\left\\{|\\alpha|,\\left|\\frac{\\pi}{2}-\\alpha\\right|\\right\\}$。$\\phi=0$ 表示完美对齐，而 $\\phi=\\pi/4$ 表示最大失准。\n    *   **全变分 (TV)**：通过测量数值解全变分的变化来量化伪振荡。对于网格函数 $U_{i,j}$，离散全变分定义为\n      $$\n      \\mathrm{TV}(U) = \\sum_{i,j}\\left( \\left|U_{i,j+1} - U_{i,j}\\right| + \\left|U_{i+1,j} - U_{i,j}\\right| \\right).\n      $$\n      一个理想的、无振荡的标量平流格式应该是全变分递减 (TVD) 的，即 $\\mathrm{TV}(u^{n+1}) \\le \\mathrm{TV}(u^n)$。所选的 FTCS 格式不是 TVD 的，预计会产生非物理振荡，这将增加全变分。\n    *   **TV 的分数变化 ($\\Delta \\mathrm{TV}$)**：通过初始 TV 对 TV 的变化进行归一化，以提供一个时间步内产生的误差的相对度量：\n      $$\n      \\Delta \\mathrm{TV} = \\frac{\\mathrm{TV}(u^1)-\\mathrm{TV}(u^0)}{\\mathrm{TV}(u^0)}.\n      $$\n      $\\Delta \\mathrm{TV}$ 的正值表示新振荡的产生。\n    *   **TVD 标志**：计算一个布尔标志，以检查该格式在此单步上是否以 TVD 方式运行。这需要满足两个条件：首先，全变分不得增加（$\\mathrm{TV}(u^1)\\le \\mathrm{TV}(u^0)$）；其次，不得产生新的极值（即 $u^1$ 必须受初始最小值和最大值 $[0,1]$ 的限制）。\n\n4.  **假设检验**：对一组角度 $\\alpha_k$ 执行该实验。对于每个角度，计算对 $(\\phi_k, \\Delta \\mathrm{TV}_k)$。失准增加导致更显著振荡的假设意味着 $\\phi_k$ 和 $\\Delta \\mathrm{TV}_k$ 之间存在正相关。通过计算失准值集合 $\\{\\phi_k\\}$ 与相应的 TV 分数变化集合 $\\{\\Delta \\mathrm{TV}_k\\}$ 之间的皮尔逊相关系数 $\\rho$ 来量化这种相关性。在此特定数值实验的背景下，一个接近 $+1$ 的 $\\rho$ 值将有力地支持该假设。\n\n所提供的最终代码为每个指定的角度实现了此过程，收集了所得的度量，计算了相关系数，并按要求格式化了结果。",
            "answer": "[0.9998846011380315,0.0,0.3800260408462057,False,0.39269908169872414,0.481220464264639,False,0.7853981633974483,0.5373801211181515,False,0.39269908169872414,0.481220464264639,False,0.0,0.3800260408462057,False]"
        }
    ]
}