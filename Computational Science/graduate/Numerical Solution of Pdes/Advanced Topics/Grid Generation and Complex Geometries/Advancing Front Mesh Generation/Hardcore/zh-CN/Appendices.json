{
    "hands_on_practices": [
        {
            "introduction": "推进前沿法 (Advancing Front Method, AFM) 的核心在于从现有边界（即“前沿”）出发，逐步生成新的网格单元以填充整个计算域。这个过程的第一步，也是最基本的一步，就是从初始边界生成第一个内部三角形。本练习将引导你完成这一基本操作：首先根据目标尺寸离散化边界，然后运用几何原理，根据边界的方向性确定“内部”方向，最终精确地放置第一个新节点。这个练习是理解 AFM 几何构造基础的关键。",
            "id": "3361502",
            "problem": "考虑平面上的单位正方形域，其顶点按逆时针顺序列出为 $\\left(0,0\\right)$、$\\left(1,0\\right)$、$\\left(1,1\\right)$、$\\left(0,1\\right)$。将采用一种用于网格生成的前沿推进法 (AFM)，从边界开始生成一个三角形网格，该网格适用于偏微分方程 (PDE) 的数值求解。指定的均匀目标网格尺寸为 $h=0.4$。在均匀尺寸场中，首先对边界进行离散化，使得每条活动前沿边的长度小于或等于目标尺寸。然后，通过在活动前沿边上进行垂直放置来生成内部候选点，以形成近似的等边三角形。\n\n按以下步骤进行：\n- 将底部边界边 $\\left[\\left(0,0\\right),\\left(1,0\\right)\\right]$ 离散化为 $N$ 个等长线段，其中 $N$ 是使每条线段长度小于或等于 $h$ 的最小正整数。\n- 选择该离散化的中心线段作为初始活动前沿边，并通过将第一个内部候选点垂直于该边的中点放置来构建它，选择的距离应使连接候选点与线段端点的两条新边的长度恰好为 $h$。放置的方向必须选择在域内。\n\n仅使用这些原则，计算这个第一个内部候选点的笛卡尔坐标。根据定向边界和内法线的基本原理，证明方向选择的合理性。将最终坐标值四舍五入到四位有效数字，并以有序对 $(x,y)$ 的形式报告，不带单位。",
            "solution": "问题陈述经评估是有效的，因为它在计算几何和数值方法领域具有科学依据，是适定的，有充分且一致的信息来确定唯一解，并且其语言和表述是客观的。\n\n该问题要求计算在单位正方形域中，通过前沿推进法 (AFM) 生成的第一个内部候选点的笛卡尔坐标。该过程从底部边界开始。\n\n步骤1：离散化底部边界。\n单位正方形的底部边界是从 $P_1(0,0)$ 到 $P_2(1,0)$ 的线段。该线段的长度为 $L=1$。它需要被离散化为 $N$ 个等长线段，其中 $N$ 是使得每个线段的长度 $s = L/N$ 小于或等于指定网格尺寸 $h=0.4$ 的最小正整数。\n我们必须满足不等式：\n$$s \\le h$$\n$$\\frac{1}{N} \\le 0.4$$\n求解 $N$，我们得到：\n$$N \\ge \\frac{1}{0.4} = 2.5$$\n由于 $N$ 必须是正整数，满足此条件的最小整数值是 $N=3$。\n每个线段的长度为 $s = 1/3$。边界被点 $(0,0)$、$(1/3,0)$、$(2/3,0)$ 和 $(1,0)$ 离散化。这产生了三个线段。\n\n步骤2：确定初始活动前沿边。\n问题指定选择该离散化的中心线段作为初始活动前沿边。当有 $N=3$ 个线段时，中心线段是第二个。其端点为 $A = (1/3, 0)$ 和 $B = (2/3, 0)$。该边的长度为 $s = 2/3 - 1/3 = 1/3$。\n\n步骤3：确定候选点的放置和方向。\n候选点，我们称之为 $P_c(x_c, y_c)$，将通过将其垂直于活动前沿边 $AB$ 的中点 $M$ 放置来构建。\n线段 $AB$ 的中点 $M$ 是：\n$$M = \\left( \\frac{x_A + x_B}{2}, \\frac{y_A + y_B}{2} \\right) = \\left( \\frac{1/3 + 2/3}{2}, \\frac{0 + 0}{2} \\right) = \\left( \\frac{1}{2}, 0 \\right)$$\n活动前沿边 $AB$ 位于 x 轴上。该边的一个切向量是 $\\vec{T} = (1, 0)$。因此，一个正交方向平行于 y 轴，由单位向量 $(0,1)$ 或 $(0,-1)$ 表示。\n\n必须选择方向，以使该点位于域内。这可以通过考虑域的定向边界来证明其合理性。顶点按逆时针顺序列出：$(0,0) \\to (1,0) \\to (1,1) \\to (0,1)$。这为边界定义了一个正方向。对于二维平面中的正定向边界，内指向法向量 $\\vec{n}$ 是通过将切向量 $\\vec{T}$ 旋转 $+\\pi/2$ 弧度（逆时针90度）得到的。\n底部边界从 $(0,0)$ 遍历到 $(1,0)$，因此切向量在 x 轴正方向上，即 $\\vec{T} = (1,0)$。将向量 $(T_x, T_y)$ 旋转 $+\\pi/2$ 的操作由 $(-T_y, T_x)$ 给出。\n将此变换应用于 $\\vec{T}=(1,0)$ 得到内法向量：\n$$\\vec{n} = (-0, 1) = (0,1)$$\n该向量指向 y 轴正方向，即单位正方形域 $[0,1] \\times [0,1]$ 的内部。因此，候选点 $P_c$ 必须放置在中点 $M$ 的“上方”。\n\n步骤4：计算候选点的坐标。\n点 $P_c$ 位于沿 $\\vec{n}$ 方向距离 $M$ 点为 $d$ 的位置。其坐标为 $P_c = M + d\\vec{n} = (1/2, 0) + d(0,1) = (1/2, d)$。\n问题陈述两条新边 $AP_c$ 和 $BP_c$ 的长度必须恰好为 $h=0.4$。我们可以使用距离公式来找到 $d$。考虑边 $AP_c$：\n$|AP_c|^2 = (x_c - x_A)^2 + (y_c - y_A)^2 = h^2$\n$\\left(\\frac{1}{2} - \\frac{1}{3}\\right)^2 + (d - 0)^2 = (0.4)^2$\n三角形的底边是 $s = 1/3$。从端点 $A$ 到中点 $M$ 的距离是 $s/2 = 1/6$。问题描述了一个以 $A$ 和 $B$ 为端点、$P_c$ 为顶点的等腰三角形。这个三角形的高是 $d$。我们可以用顶点 $A$、$M$ 和 $P_c$ 构成一个直角三角形。根据勾股定理：\n$|AM|^2 + |MP_c|^2 = |AP_c|^2$\n$\\left(\\frac{1}{6}\\right)^2 + d^2 = (0.4)^2$\n我们将 $0.4$ 转换为分数，$0.4 = 4/10 = 2/5$。\n$\\frac{1}{36} + d^2 = \\left(\\frac{2}{5}\\right)^2 = \\frac{4}{25}$\n现在，我们求解 $d^2$：\n$d^2 = \\frac{4}{25} - \\frac{1}{36} = \\frac{4 \\times 36 - 1 \\times 25}{25 \\times 36} = \\frac{144 - 25}{900} = \\frac{119}{900}$\n由于点必须在域内，我们取 $d$ 的正根：\n$d = \\sqrt{\\frac{119}{900}} = \\frac{\\sqrt{119}}{30}$\n候选点 $P_c$ 的坐标是 $(x_c, y_c) = (1/2, d) = (1/2, \\frac{\\sqrt{119}}{30})$。\n\n步骤5：最终数值计算和四舍五入。\n问题要求将最终坐标四舍五入到四位有效数字。\nx坐标是：\n$$x_c = \\frac{1}{2} = 0.5$$\n四舍五入到四位有效数字，写作 $0.5000$。\ny坐标是：\n$$y_c = \\frac{\\sqrt{119}}{30} \\approx \\frac{10.9087121}{30} \\approx 0.363623737$$\n四舍五入到四位有效数字得到 $0.3636$。\n第一个内部候选点的坐标是 $(0.5000, 0.3636)$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.5000  0.3636\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在推进前沿的每一步，当一个候选的新单元（例如一个三角形）被提议时，一个鲁棒的算法必须确保这个新单元不会与任何现存的前沿边发生交叉。这个验证步骤对于保证最终网格的有效性和拓扑正确性至关重要。本练习将介绍如何使用计算几何中的一个基本工具——方向谓词 (orientation predicate)——来执行这种相交测试。通过这个实践，你将掌握维护前沿完整性的关键技术。",
            "id": "3361452",
            "problem": "在用于求解偏微分方程（PDEs）的非结构化网格生成的前沿推进法（AFM）中，必须测试候选前沿边与已有边是否相交，以保持网格的有效性。考虑一个二维前沿推进步骤，其中存在两条已有边：水平边 $\\big[(0,0),(1,0)\\big]$ 和垂直边 $\\big[(0.5,-0.5),(0.5,0.5)\\big]$。提出了一个候选新点 $p=(0.5,0.3)$，并将添加两条新边 $\\big[(0,0),p\\big]$ 和 $\\big[(1,0),p\\big]$。\n\n仅使用计算几何学的基本原理（特别是方位谓词和线段相交的充要条件），判断任一待建边是否与已有的垂直边 $\\big[(0.5,-0.5),(0.5,0.5)\\big]$ 相交。如果至少发生一次相交，请给出在垂直线段 $x=0.5$ 上交点的 $y$ 坐标的精确值。如果没有发生相交，则报告 $0$。请将您的最终答案表示为单个实数，不要四舍五入。",
            "solution": "问题陈述的有效性已确立。该问题在计算几何学上具有科学依据，是适定的，并且所有必要的数据都已提供。我们基于基本原理进行求解。\n\n问题要求判断两条待建边中是否有任一条与二维域中的一条已有边相交。我们如下定义各点：$A = (0,0)$，$B = (1,0)$，$C = (0.5, -0.5)$，$D = (0.5, 0.5)$，以及候选新点 $p = (0.5, 0.3)$。\n提到的已有边是 $\\overline{AB}$ 和 $\\overline{CD}$。问题指定我们必须测试与垂直边的相交情况，该垂直边即线段 $\\overline{CD}$。\n两条待建的新边是 $\\overline{Ap}$ 和 $\\overline{Bp}$。\n\n判断两条线段（例如 $\\overline{P_1P_2}$ 和 $\\overline{P_3P_4}$）是否相交的标准方法是使用方位谓词。对于坐标分别为 $p_1=(x_1, y_1)$，$p_2=(x_2, y_2)$ 和 $p_3=(x_3, y_3)$ 的一个有序三点组 $(p_1, p_2, p_3)$，其方位由以下行列式的符号给出：\n$$ \\text{orientation}(p_1, p_2, p_3) = \\det \\begin{pmatrix} x_2 - x_1  y_2 - y_1 \\\\ x_3 - x_1  y_3 - y_1 \\end{pmatrix} = (x_2 - x_1)(y_3 - y_1) - (x_3 - x_1)(y_2 - y_1) $$\n正值表示从 $p_1$ 到 $p_3$ 在 $p_2$ 点处为逆时针转（或“左转”）。负值表示顺时针转（“右转”）。值为零表示这三个点共线。\n\n两条线段 $\\overline{P_1P_2}$ 和 $\\overline{P_3P_4}$ 相交，当且仅当满足以下两个条件之一：\n1.  **一般情况：** 每条线段的端点位于包含另一条线段的直线的两侧。这在 $\\text{orientation}(P_1, P_2, P_3)$ 和 $\\text{orientation}(P_1, P_2, P_4)$ 符号不同，且 $\\text{orientation}(P_3, P_4, P_1)$ 和 $\\text{orientation}(P_3, P_4, P_2)$ 符号不同时成立。\n2.  **特殊情况（共线）：** 一条线段的一个端点位于另一条线段上。这在某个方位测试结果为零，并且该点被证明位于与其共线的线段的边界框内时发生。\n\n我们将测试每条待建边与已有的垂直边 $\\overline{CD}$ 是否相交。\n\n**测试 1：待建边 $\\overline{Ap}$ 与已有边 $\\overline{CD}$ 的相交情况**\n\n令 $P_1 = A = (0,0)$，$P_2 = p = (0.5, 0.3)$。\n令 $P_3 = C = (0.5, -0.5)$，$P_4 = D = (0.5, 0.5)$。\n\n我们检查 $\\overline{CD}$ 的端点相对于包含 $\\overline{Ap}$ 的直线的方位。\n$\\text{orientation}(A, p, C) = (0.5 - 0)(-0.5 - 0) - (0.5 - 0)(0.3 - 0) = (0.5)(-0.5) - (0.5)(0.3) = -0.25 - 0.15 = -0.4$\n$\\text{orientation}(A, p, D) = (0.5 - 0)(0.5 - 0) - (0.5 - 0)(0.3 - 0) = (0.5)(0.5) - (0.5)(0.3) = 0.25 - 0.15 = 0.1$\n由于符号不同（一个为负，一个为正），线段 $\\overline{CD}$ 跨越了包含 $\\overline{Ap}$ 的直线。\n\n接着，我们检查 $\\overline{Ap}$ 的端点相对于包含 $\\overline{CD}$ 的直线的方位。\n$\\text{orientation}(C, D, A) = (0.5 - 0.5)(0 - (-0.5)) - (0 - 0.5)(0.5 - (-0.5)) = (0)(0.5) - (-0.5)(1) = 0.5$\n$\\text{orientation}(C, D, p) = (0.5 - 0.5)(0.3 - (-0.5)) - (0.5 - 0.5)(0.5 - (-0.5)) = (0)(0.8) - (0)(1) = 0$\n三点组 $(C, D, p)$ 的方位为零。这表示一个特殊情况：点 $C$、$D$ 和 $p$ 共线。由于 $p$ 是线段 $\\overline{Ap}$ 的一个端点，我们必须检查 $p$ 是否位于线段 $\\overline{CD}$ 上。\n对于一个点 $p=(x_p, y_p)$，要使其位于端点为 $C=(x_C, y_C)$ 和 $D=(x_D, y_D)$ 的线段 $\\overline{CD}$ 上，其坐标必须满足：\n$x_p \\in [\\min(x_C, x_D), \\max(x_C, x_D)]$ 且 $y_p \\in [\\min(y_C, y_D), \\max(y_C, y_D)]$。\n这里，$p=(0.5, 0.3)$，$C=(0.5, -0.5)$，$D=(0.5, 0.5)$。\n对于 $x$ 坐标：$0.5 \\in [\\min(0.5, 0.5), \\max(0.5, 0.5)]$，即 $0.5 \\in [0.5, 0.5]$。这成立。\n对于 $y$ 坐标：$0.3 \\in [\\min(-0.5, 0.5), \\max(-0.5, 0.5)]$，即 $0.3 \\in [-0.5, 0.5]$。这也成立。\n因此，点 $p$ 位于线段 $\\overline{CD}$ 上。\n由于 $p$ 是 $\\overline{Ap}$ 的一个端点，并且也位于 $\\overline{CD}$ 上，所以这两条线段在点 $p = (0.5, 0.3)$ 处相交。\n\n**测试 2：待建边 $\\overline{Bp}$ 与已有边 $\\overline{CD}$ 的相交情况**\n\n令 $P_1 = B = (1,0)$，$P_2 = p = (0.5, 0.3)$。\n令 $P_3 = C = (0.5, -0.5)$，$P_4 = D = (0.5, 0.5)$。\n\n分析是类似的。点 $p$ 是待建线段 $\\overline{Bp}$ 的一个端点。从上一个测试中，我们已经证明了点 $p$ 位于已有线段 $\\overline{CD}$ 上。根据定义，如果两条线段共享一个点，它们就相交。交点同样是 $p=(0.5, 0.3)$。\n因此，第二条待建边 $\\overline{Bp}$ 也与已有的垂直边 $\\overline{CD}$ 相交。\n\n**结论**\n\n至少发生了一次相交；事实上，两条待建边都与已有的垂直边 $\\overline{CD}$ 相交。两者的交点都是同一个点 $p = (0.5, 0.3)$。问题要求的是交点的 $y$ 坐标。\n$p$ 的 $y$ 坐标是 $0.3$。\n如果没有发生相交，答案将是 $0$。由于找到了交点，答案就是交点的 $y$ 坐标。\n最终答案是 $0.3$。",
            "answer": "$$\\boxed{0.3}$$"
        },
        {
            "introduction": "许多真实的偏微分方程问题，例如流体动力学中的边界层问题，其解在不同方向上具有截然不同的变化尺度。为了高效地求解这些问题，我们需要使用在特定方向上拉伸或压缩的各向异性网格。本练习将展示如何将 AFM 从标准的欧几里得几何推广到更强大的框架中。通过引入一个度量张量 $M$ 来重新定义距离和正交性，我们可以生成能适应解的各向异性特征的定制化网格，这突显了 AFM 框架的灵活性与强大功能。",
            "id": "3361486",
            "problem": "在用于求解偏微分方程 (PDE) 的各向异性前沿推进网格生成中，一个常见的顶点放置规则是：沿着与活动前沿边在度量下正交且通过该边中点的直线，在指定的度量高度处，放置一个新顶点。设黎曼度量为常数，并由对称正定张量 $M \\in \\mathbb{R}^{2 \\times 2}$ 表示。两点 $a,b \\in \\mathbb{R}^{2}$ 之间的度量诱导距离定义为 $d_{M}(a,b) = \\sqrt{(a-b)^{\\top} M (a-b)}$，如果 $n^{\\top} M t = 0$，则称向量 $n$ 与非零向量 $t$ 是 $M$-正交的。点 $p$ 到直线 $\\ell$ 的度量高度是 $d_{M}(p,q)$ 在所有 $q \\in \\ell$ 上的最小值。\n\n考虑 $\\mathbb{R}^{2}$ 中端点为 $p_{0} = (0,0)$ 和 $p_{1} = (1,0)$ 的前沿边，以及常数度量张量 $M = \\mathrm{diag}(4,1)$。构造点 $p$，该点位于通过该边欧几里得中点且与该边 $M$-正交的直线上，并位于该边的“上方”（意味着其欧几里得 $y$ 坐标为正），使得从点 $p$ 到该边支撑线的度量高度等于指定值 $h_{M} = 1$。\n\n使用标准笛卡尔坐标将您的答案表示为坐标行向量 $\\big(x \\;\\; y\\big)$。无需四舍五入。",
            "solution": "我们从各向异性网格划分的黎曼度量的核心定义开始。对于对称正定张量 $M$，两点 $a,b \\in \\mathbb{R}^{2}$ 之间的度量诱导距离为 $d_{M}(a,b) = \\sqrt{(a-b)^{\\top} M (a-b)}$。如果 $n^{\\top} M t = 0$，则向量 $n$ 与向量 $t$ 是 $M$-正交的。点 $p$ 到直线 $\\ell$ 的度量高度是 $p$ 到 $\\ell$ 上任意点的最小度量距离。\n\n给定 $p_{0} = (0,0)$ 和 $p_{1} = (1,0)$，该边是 $x$ 轴上从 $x=0$ 到 $x=1$ 的水平线段。其支撑线是 $x$ 轴 $\\{(x,0): x \\in \\mathbb{R}\\}$。该边的欧几里得中点是 $m = \\left(\\frac{1}{2}, 0\\right)$。边方向（切向）向量是 $t = p_{1} - p_{0} = (1,0)$。\n\n度量为 $M = \\mathrm{diag}(4,1)$。为了找到与该边 $M$-正交的方向，我们需要一个向量 $n = (n_{x}, n_{y})$ 使得 $n^{\\top} M t = 0$。计算\n$$\nn^{\\top} M t = \\begin{pmatrix} n_{x}  n_{y} \\end{pmatrix}\n\\begin{pmatrix} 4  0 \\\\ 0  1 \\end{pmatrix}\n\\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}\n= \\begin{pmatrix} n_{x}  n_{y} \\end{pmatrix}\n\\begin{pmatrix} 4 \\\\ 0 \\end{pmatrix}\n= 4 n_{x}.\n$$\n因此，$M$-正交条件 $n^{\\top} M t = 0$ 得出 $n_{x} = 0$。所以，任何与该边 $M$-正交的方向都具有形式 $n = (0, \\alpha)$，其中 $\\alpha \\neq 0$，这与欧几里得 $y$ 轴平行。通过中点 $m$ 的 $M$-正交线就是垂直线 $x = \\frac{1}{2}$。\n\n现在我们施加度量高度的要求。设 $p = (x,y)$ 为任意点。其到支撑线 $\\{(s,0): s \\in \\mathbb{R}\\}$ 的度量高度为\n$$\n\\min_{s \\in \\mathbb{R}} d_{M}\\big( (x,y), (s,0) \\big)\n= \\min_{s \\in \\mathbb{R}} \\sqrt{ \\big( (x - s, y) \\big)^{\\top} M \\big( (x - s, y) \\big) }.\n$$\n当 $M = \\mathrm{diag}(4,1)$ 时，度量距离的平方为\n$$\n\\big( (x - s, y) \\big)^{\\top} \\begin{pmatrix} 4  0 \\\\ 0  1 \\end{pmatrix} \\big( (x - s, y) \\big)\n= 4 (x - s)^{2} + y^{2}.\n$$\n对 $s$ 进行最小化是一个单变量二次最小化问题；最小值在 $s = x$ 处取得，得到最小平方距离为 $y^{2}$。因此，从 $(x,y)$ 到支撑线的度量高度等于 $|y|$：\n$$\n\\min_{s \\in \\mathbb{R}} d_{M}\\big( (x,y), (s,0) \\big) = \\sqrt{y^{2}} = |y|.\n$$\n\n我们要寻找位于通过 $m$ 的 $M$-正交线上，且高度为 $h_{M} = 1$，欧几里得 $y$ 坐标为正（在边“上方”）的点。强制 $x = \\frac{1}{2}$ 和 $|y| = 1$ 且 $y > 0$，得到 $y = 1$。因此\n$$\np = \\left( \\frac{1}{2}, 1 \\right).\n$$\n这个构造满足所有要求：它位于通过中点的 $M$-正交线上，到支撑线的度量高度为 $1$，并且具有正的 $y$ 坐标。",
            "answer": "$$\\boxed{\\begin{pmatrix} \\frac{1}{2}  1 \\end{pmatrix}}$$"
        }
    ]
}