{
    "hands_on_practices": [
        {
            "introduction": "应用守恒定律最直接的方法之一是对一个明确的控制体积进行分析。本练习  旨在通过计算一个天体物理流中的质量通量和源项，来巩固对质量守恒积分形式的理解。这种对流入、流出和内部产生的质量进行“收支核算”的方法，是所有有限体积数值格式的核心思想。",
            "id": "3506440",
            "problem": "在一个高分辨率的计算天体物理学模拟中，一个嵌入在薄吸积流中的固定体积为 $V$ 的一维控制体，在时间间隔 $[t_{0}, t_{1}]$ 内被监测。该控制体有两个平面边界，分别位于 $x=0$（左侧）和 $x=L$（右侧）。正的质量流入率 $F_{\\text{in}}(t)$ 定义为单位时间内穿过左边界进入控制体的质量，正的质量流出率 $F_{\\text{out}}(t)$ 定义为单位时间内穿过右边界离开控制体的质量。在控制体内，气体经历一个空间上均匀的体积质量源项 $S_{m}(t)$（对于质量汇，该项可为负）。\n\n在区间 $t \\in [0, \\Delta t]$ (其中 $\\Delta t = t_{1}-t_{0}$) 内，边界通量和体积源被设定为：\n$$F_{\\text{in}}(t) = 5.0 \\times 10^{28}\\left(1 + 0.2 \\sin(\\omega t)\\right)\\ \\mathrm{g}\\ \\mathrm{s}^{-1},$$\n$$F_{\\text{out}}(t) = 4.0 \\times 10^{28}\\left(1 + 0.1 \\cos(\\omega t + \\phi)\\right)\\ \\mathrm{g}\\ \\mathrm{s}^{-1},$$\n$$S_{m}(t) = -\\,1.0 \\times 10^{-18}\\,\\exp\\!\\left(-\\frac{t}{\\tau}\\right)\\ \\mathrm{g}\\ \\mathrm{cm}^{-3}\\ \\mathrm{s}^{-1},$$\n参数如下：\n$$\\Delta t = 1.0 \\times 10^{5}\\ \\mathrm{s},\\quad \\omega = \\frac{2\\pi}{\\Delta t}\\ \\mathrm{rad}\\ \\mathrm{s}^{-1},\\quad \\phi = \\frac{\\pi}{2}\\ \\mathrm{rad},\\quad \\tau = 5.0 \\times 10^{4}\\ \\mathrm{s},\\quad V = 1.0 \\times 10^{45}\\ \\mathrm{cm}^{3}.$$\n\n模拟报告的控制体内初始和最终质量为：\n$$M(t_{0}) = 2.000000000 \\times 10^{35}\\ \\mathrm{g},\\qquad M(t_{1}) = 2.009567667642 \\times 10^{35}\\ \\mathrm{g}.$$\n\n仅使用守恒第一性原理，推导在 $[t_{0}, t_{1}]$ 时间段内净质量变化 $\\Delta M$ 的表达式（用给定的流入率、流出率和体积源表示），然后利用上述数据进行数值计算。通过将计算出的 $\\Delta M$ 与 $M(t_{1}) - M(t_{0})$ 进行比较，验证其与积分守恒的一致性。以 $\\mathrm{g}$ 为单位表示净质量变化，并将答案四舍五入至四位有效数字。",
            "solution": "该问题要求基于质量守恒基本原理，推导并计算在一个指定时间间隔内，一维控制体中质量的净变化量 $\\Delta M$。\n\n控制体的质量守恒原理指出，控制体内质量随时间的变化率 $\\frac{dM}{dt}$ 等于流入质量的速率减去流出质量的速率，再加上控制体内质量生成的速率。其数学表达式为：\n$$ \\frac{dM}{dt} = \\dot{M}_{\\text{in}} - \\dot{M}_{\\text{out}} + \\dot{M}_{\\text{source}} $$\n按照题目的符号，质量流入和流出速率分别由 $F_{\\text{in}}(t)$ 和 $F_{\\text{out}}(t)$ 给出。体积质量源项是 $S_m(t)$，其单位是质量/（体积·时间）。由于源项在空间上是均匀的，所以在控制体积 $V$ 内的总质量源速率为 $\\dot{M}_{\\text{source}} = S_m(t) V$。\n\n因此，控制体内质量 $M(t)$ 的控制常微分方程为：\n$$ \\frac{dM}{dt} = F_{\\text{in}}(t) - F_{\\text{out}}(t) + S_m(t) V $$\n为了求出在时间间隔 $[t_0, t_1]$ 内的净质量变化 $\\Delta M = M(t_1) - M(t_0)$，我们必须对该方程进行积分。题目将函数定义在区间 $t \\in [0, \\Delta t]$ 上，因此我们设 $t_0 = 0$ 且 $t_1 = \\Delta t$。\n$$ \\Delta M = \\int_{0}^{\\Delta t} \\frac{dM}{dt} dt = \\int_{0}^{\\Delta t} \\left( F_{\\text{in}}(t) - F_{\\text{out}}(t) + S_m(t) V \\right) dt $$\n这个积分可以分为三部分：\n$$ \\Delta M = \\int_{0}^{\\Delta t} F_{\\text{in}}(t) dt - \\int_{0}^{\\Delta t} F_{\\text{out}}(t) dt + V \\int_{0}^{\\Delta t} S_m(t) dt $$\n这就是推导出的净质量变化 $\\Delta M$ 的表达式。我们现在使用给定的函数和参数来计算每个积分。\n\n根据题意定义常数参数如下：\n$A_{\\text{in}} = 5.0 \\times 10^{28}\\ \\mathrm{g}\\ \\mathrm{s}^{-1}$, $c_{\\text{in}} = 0.2$\n$A_{\\text{out}} = 4.0 \\times 10^{28}\\ \\mathrm{g}\\ \\mathrm{s}^{-1}$, $c_{\\text{out}} = 0.1$\n$S_0 = -1.0 \\times 10^{-18}\\ \\mathrm{g}\\ \\mathrm{cm}^{-3}\\ \\mathrm{s}^{-1}$\n$\\Delta t = 1.0 \\times 10^{5}\\ \\mathrm{s}$, $\\omega = \\frac{2\\pi}{\\Delta t}\\ \\mathrm{rad}\\ \\mathrm{s}^{-1}$, $\\phi = \\frac{\\pi}{2}\\ \\mathrm{rad}$, $\\tau = 5.0 \\times 10^{4}\\ \\mathrm{s}$, $V = 1.0 \\times 10^{45}\\ \\mathrm{cm}^{3}$。\n\n总流入质量 $\\Delta M_{\\text{in}}$ 为：\n$$ \\Delta M_{\\text{in}} = \\int_{0}^{\\Delta t} A_{\\text{in}}(1 + c_{\\text{in}} \\sin(\\omega t)) dt = A_{\\text{in}} \\left[ t - \\frac{c_{\\text{in}}}{\\omega} \\cos(\\omega t) \\right]_{0}^{\\Delta t} $$\n由于 $\\omega \\Delta t = 2\\pi$，计算过程为：\n$$ \\Delta M_{\\text{in}} = A_{\\text{in}} \\left( (\\Delta t - \\frac{c_{\\text{in}}}{\\omega} \\cos(2\\pi)) - (0 - \\frac{c_{\\text{in}}}{\\omega} \\cos(0)) \\right) = A_{\\text{in}} \\left( \\Delta t - \\frac{c_{\\text{in}}}{\\omega} + \\frac{c_{\\text{in}}}{\\omega} \\right) = A_{\\text{in}} \\Delta t $$\n$$ \\Delta M_{\\text{in}} = (5.0 \\times 10^{28}\\ \\mathrm{g}\\ \\mathrm{s}^{-1})(1.0 \\times 10^{5}\\ \\mathrm{s}) = 5.0 \\times 10^{33}\\ \\mathrm{g} $$\n\n总流出质量 $\\Delta M_{\\text{out}}$ 为：\n$$ \\Delta M_{\\text{out}} = \\int_{0}^{\\Delta t} A_{\\text{out}}(1 + c_{\\text{out}} \\cos(\\omega t + \\phi)) dt = A_{\\text{out}} \\left[ t + \\frac{c_{\\text{out}}}{\\omega} \\sin(\\omega t + \\phi) \\right]_{0}^{\\Delta t} $$\n当 $\\omega \\Delta t = 2\\pi$ 且 $\\phi = \\frac{\\pi}{2}$ 时：\n$$ \\Delta M_{\\text{out}} = A_{\\text{out}} \\left( (\\Delta t + \\frac{c_{\\text{out}}}{\\omega} \\sin(2\\pi + \\frac{\\pi}{2})) - (0 + \\frac{c_{\\text{out}}}{\\omega} \\sin(\\frac{\\pi}{2})) \\right) = A_{\\text{out}} \\left( \\Delta t + \\frac{c_{\\text{out}}}{\\omega}(1) - \\frac{c_{\\text{out}}}{\\omega}(1) \\right) = A_{\\text{out}} \\Delta t $$\n$$ \\Delta M_{\\text{out}} = (4.0 \\times 10^{28}\\ \\mathrm{g}\\ \\mathrm{s}^{-1})(1.0 \\times 10^{5}\\ \\mathrm{s}) = 4.0 \\times 10^{33}\\ \\mathrm{g} $$\n\n来自源项的总质量变化 $\\Delta M_{\\text{source}}$ 为：\n$$ \\Delta M_{\\text{source}} = V \\int_{0}^{\\Delta t} S_0 \\exp(-t/\\tau) dt = V S_0 \\left[ -\\tau \\exp(-t/\\tau) \\right]_{0}^{\\Delta t} $$\n$$ \\Delta M_{\\text{source}} = V S_0 \\left( -\\tau \\exp(-\\Delta t/\\tau) - (-\\tau \\exp(0)) \\right) = V S_0 \\tau (1 - \\exp(-\\Delta t/\\tau)) $$\n指数为 $-\\frac{\\Delta t}{\\tau} = -\\frac{1.0 \\times 10^5}{5.0 \\times 10^4} = -2$。\n$$ \\Delta M_{\\text{source}} = (1.0 \\times 10^{45}\\ \\mathrm{cm}^{3})(-1.0 \\times 10^{-18}\\ \\mathrm{g}\\ \\mathrm{cm}^{-3}\\ \\mathrm{s}^{-1})(5.0 \\times 10^{4}\\ \\mathrm{s})(1 - \\exp(-2)) $$\n$$ \\Delta M_{\\text{source}} = -5.0 \\times 10^{31} (1 - \\exp(-2))\\ \\mathrm{g} $$\n\n净质量变化 $\\Delta M$ 是这些贡献的总和：\n$$ \\Delta M = \\Delta M_{\\text{in}} - \\Delta M_{\\text{out}} + \\Delta M_{\\text{source}} $$\n$$ \\Delta M = (A_{\\text{in}} - A_{\\text{out}})\\Delta t + V S_0 \\tau (1 - \\exp(-\\Delta t/\\tau)) $$\n$$ \\Delta M = (5.0 \\times 10^{33} - 4.0 \\times 10^{33}) - 5.0 \\times 10^{31} (1 - \\exp(-2)) $$\n$$ \\Delta M = 1.0 \\times 10^{33} - 5.0 \\times 10^{31} (1 - \\exp(-2)) $$\n为了合并这些项，我们将 $1.0 \\times 10^{33}$ 写成 $100 \\times 10^{31}$：\n$$ \\Delta M = (100 \\times 10^{31}) - 5.0 \\times 10^{31}(1 - \\exp(-2)) = \\left( 100 - 5(1 - \\exp(-2)) \\right) \\times 10^{31} $$\n$$ \\Delta M = (100 - 5 + 5\\exp(-2)) \\times 10^{31} = (95 + 5\\exp(-2)) \\times 10^{31}\\ \\mathrm{g} $$\n\n现在，我们对此表达式进行数值计算：\n$$ \\Delta M \\approx (95 + 5(0.1353352832)) \\times 10^{31} \\approx (95 + 0.676676416) \\times 10^{31} \\approx 95.676676416 \\times 10^{31}\\ \\mathrm{g} $$\n用标准科学记数法表示，即为：\n$$ \\Delta M \\approx 9.5676676416 \\times 10^{32}\\ \\mathrm{g} $$\n\n为了验证一致性，我们将此计算值与模拟报告的质量变化 $\\Delta M_{\\text{sim}} = M(t_1) - M(t_0)$ 进行比较：\n$$ \\Delta M_{\\text{sim}} = (2.009567667642 \\times 10^{35} - 2.000000000 \\times 10^{35})\\ \\mathrm{g} = 0.009567667642 \\times 10^{35}\\ \\mathrm{g} $$\n$$ \\Delta M_{\\text{sim}} = 9.567667642 \\times 10^{32}\\ \\mathrm{g} $$\n计算值 $\\Delta M$ 和模拟报告值 $\\Delta M_{\\text{sim}}$ 在十位有效数字上是相同的，这证实了数据与质量守恒原理的一致性。\n\n最后，我们按要求将计算出的净质量变化四舍五入到四位有效数字：\n$$ \\Delta M = 9.5676... \\times 10^{32}\\ \\mathrm{g} $$\n第五位有效数字是 6，因此对第四位有效数字进行进位。\n$$ \\Delta M \\approx 9.568 \\times 10^{32}\\ \\mathrm{g} $$",
            "answer": "$$\\boxed{9.568 \\times 10^{32}}$$"
        },
        {
            "introduction": "黎曼问题是理解复杂流体动力学现象和验证数值计算程序的基石。本练习  挑战你求解经典的索德激波管问题，这是一个涉及完整欧拉方程组的标准初值问题。通过推导和求解决定波后区域状态的非线性相容性方程，你将深入了解由简单间断演化而来的激波、稀疏波和接触间断的丰富物理结构。",
            "id": "3506428",
            "problem": "在计算天体物理学中，通常使用由可压缩欧拉方程控制的一维黎曼问题的精确解来验证流体动力学求解器。这些方程表述了绝热指数为 $\\gamma$ 的多方气体的质量、动量和能量守恒。考虑一个理想气体的一维激波管问题（Sod 初始值问题），其绝热指数 $\\gamma=1.4$，单位为无量纲代码单位。初始左态 $(\\rho_L,p_L,v_L)$ 和右态 $(\\rho_R,p_R,v_R)$ 分别由 $(\\rho_L,p_L,v_L)=(1,1,0)$ 和 $(\\rho_R,p_R,v_R)=(0.125,0.1,0)$ 给出。流动是自相似演化的，由一个左行稀疏波、一个接触间断和一个右行激波组成。稀疏波尾和激波之间的状态，被称为星区，是均匀的，其特征为压力 $p^\\ast$ 和速度 $v^\\ast$。\n\n从守恒律以及适用于多方气体中光滑等熵膨胀波和激波的跳跃关系或积分关系出发，推导星区压力 $p^\\ast$ 的非线性相容性方程，并求解该方程以获得给定初始状态下 $p^\\ast$ 的数值。使用无量纲代码单位（因此压力是无单位的），并将最终答案四舍五入到 $6$ 位有效数字。",
            "solution": "### 步骤 1：提取给定信息\n问题陈述提供了以下信息：\n- 控制方程是多方气体的 $1$ 维可压缩欧拉方程。\n- 气体是理想气体，绝热指数 $\\gamma = 1.4$。\n- 初始左态为 $(\\rho_L, p_L, v_L) = (1, 1, 0)$（无量纲单位）。\n- 初始右态为 $(\\rho_R, p_R, v_R) = (0.125, 0.1, 0)$（无量纲单位）。\n- 流动结构由一个左行稀疏波、一个接触间断和一个右行激波组成。\n- 稀疏波和激波之间的区域（星区）的特征是均匀的压力 $p^\\ast$ 和速度 $v^\\ast$。\n- $p^\\ast$ 的最终答案必须四舍五入到 $6$ 位有效数字。\n\n### 步骤 2：使用提取的信息进行验证\n- **科学依据：** 该问题描述了 Sod 激波管，这是计算流体力学和天体物理学中的一个标准基准问题。它由欧拉方程控制，这些方程是流体力学的基本原理。该设置在科学上是合理的。\n- **适定性：** 具有这些初始条件的 Sod 黎曼问题众所周知有一个唯一、稳定且具有物理意义的解。待求量 $p^\\ast$ 是定义明确的。\n- **客观性：** 问题使用精确的技术语言陈述，没有主观或模棱两可的术语。\n- **完整性与一致性：** 提供了所有必要的参数（$\\gamma$，初始状态）。设置中没有矛盾。波系（稀疏波-接触间断-激波）的描述与初始条件（$p_L > p_R$）一致。\n\n### 步骤 3：结论与行动\n该问题是有效的。将提供完整的解答。\n\n### $p^\\ast$ 的相容性方程推导\n\n黎曼问题的解是自相似的，取决于变量 $\\xi = x/t$。$x=0$ 处的初始间断演化为一系列波，这些波分隔了多个常数状态区域。对于给定的初始条件（$p_L > p_R$），波系由一个左传稀疏波、一个中心接触间断和一个右传激波组成。\n\n在接触间断面上，压力和速度是连续的。我们将这些在“星区”（稀疏波尾和激波阵面之间的区域）的值表示为 $p^\\ast$ 和 $v^\\ast$。我们的目标是找到 $v^\\ast$ 作为 $p^\\ast$ 函数的两个表达式——一个通过将星区与初始左态相关联，另一个通过将其与初始右态相关联——然后将它们相等。\n\n**1. 左行稀疏波（L区到星区）**\n\n稀疏波是一种连续的等熵膨胀。在稀疏扇中，与右行特征线（$C_+$）对应的黎曼不变量是守恒的：\n$$v + \\int \\frac{dp}{\\rho c} = \\text{constant}$$\n其中 $c = \\sqrt{\\gamma p / \\rho}$ 是当地声速。对于多方气体中的等熵过程，有 $p = K\\rho^\\gamma$，其中 $K$ 是一个常数。这使我们能够将声速写成压力的函数：$c = c_L (p/p_L)^{(\\gamma-1)/(2\\gamma)}$。该积分可以计算为：\n$$\\int \\frac{dp}{\\rho c} = \\int \\frac{c}{\\gamma p} dp = \\frac{2c}{\\gamma-1}$$\n因此，黎曼不变量是 $v + \\frac{2c}{\\gamma-1}$。将此应用于穿过稀疏波的过程，从状态 $(\\rho_L, p_L, v_L)$ 到状态 $(\\rho^\\ast, p^\\ast, v^\\ast)$：\n$$v_L + \\frac{2 c_L}{\\gamma-1} = v^\\ast + \\frac{2 c^\\ast}{\\gamma-1}$$\n其中 $c_L = \\sqrt{\\gamma p_L / \\rho_L}$ 和 $c^\\ast = \\sqrt{\\gamma p^\\ast / \\rho^\\ast}$。由于从 L 态到星区的流动是等熵的，所以 $c^\\ast = c_L (p^\\ast/p_L)^{(\\gamma-1)/(2\\gamma)}$。\n求解 $v^\\ast$，我们得到：\n$$v^\\ast = v_L + \\frac{2 c_L}{\\gamma-1} \\left[ 1 - \\left( \\frac{p^\\ast}{p_L} \\right)^{(\\gamma-1)/(2\\gamma)} \\right]$$\n此方程给出了星区速度作为 $p^\\ast$ 和初始左态的函数。\n\n**2. 右行激波（R区到星区）**\n\n从初始右态 $(\\rho_R, p_R, v_R)$ 到星区状态 $(\\rho^\\ast, p^\\ast, v^\\ast)$ 的过渡是跨越一个激波发生的。跨越激波的关系由 Rankine-Hugoniot 跳跃条件给出。从这些条件推导出的一个标准结果将速度变化与压力变化联系起来：\n$$(v^\\ast - v_R)^2 = (p^\\ast - p_R)^2 \\frac{2/\\rho_R}{(\\gamma+1)p^\\ast + (\\gamma-1)p_R}$$\n对于右行激波，我们有 $p^\\ast > p_R$ 和 $v^\\ast > v_R$。取正平方根得到：\n$$v^\\ast = v_R + (p^\\ast - p_R) \\sqrt{\\frac{2/\\rho_R}{(\\gamma+1)p^\\ast + (\\gamma-1)p_R}}$$\n此方程给出了星区速度作为 $p^\\ast$ 和初始右态的函数。\n\n**3. 非线性相容性方程**\n\n将 $v^\\ast$ 的两个表达式相等，得到一个关于未知压力 $p^\\ast$ 的单一非线性方程：\n$$v_L + \\frac{2 c_L}{\\gamma-1} \\left[ 1 - \\left( \\frac{p^\\ast}{p_L} \\right)^{(\\gamma-1)/(2\\gamma)} \\right] = v_R + (p^\\ast - p_R) \\sqrt{\\frac{2/\\rho_R}{(\\gamma+1)p^\\ast + (\\gamma-1)p_R}}$$\n\n### 求解 $p^\\ast$\n\n我们现在将给定的数值代入这个方程。\n- $\\gamma = 1.4$\n- $(\\rho_L, p_L, v_L) = (1, 1, 0)$\n- $(\\rho_R, p_R, v_R) = (0.125, 0.1, 0)$\n\n由此，我们可以计算出辅助常数：\n- 左态声速：$c_L = \\sqrt{\\frac{\\gamma p_L}{\\rho_L}} = \\sqrt{\\frac{1.4 \\times 1}{1}} = \\sqrt{1.4}$。\n- $\\gamma - 1 = 0.4$\n- $\\gamma + 1 = 2.4$\n- 指数 $(\\gamma-1)/(2\\gamma) = 0.4 / (2 \\times 1.4) = 0.4 / 2.8 = 1/7$。\n\n将这些值代入相容性方程：\n$$0 + \\frac{2 \\sqrt{1.4}}{0.4} \\left[ 1 - \\left( \\frac{p^\\ast}{1} \\right)^{1/7} \\right] = 0 + (p^\\ast - 0.1) \\sqrt{\\frac{2/0.125}{(2.4)p^\\ast + (0.4)(0.1)}}$$\n简化各项：\n$$5\\sqrt{1.4} \\left( 1 - (p^\\ast)^{1/7} \\right) = (p^\\ast - 0.1) \\sqrt{\\frac{16}{2.4 p^\\ast + 0.04}}$$\n设 $f(p^\\ast)$ 是我们要求根的函数：\n$$f(p^\\ast) = 5\\sqrt{1.4} \\left( 1 - (p^\\ast)^{1/7} \\right) - (p^\\ast - 0.1) \\frac{4}{\\sqrt{2.4 p^\\ast + 0.04}} = 0$$\n这是一个超越方程，必须使用数值求根方法（如 Newton-Raphson 法或二分法）来求解。解必须位于区间 $p_R  p^\\ast  p_L$ 内，即 $0.1  p^\\ast  1$。\n\n让我们测试一个值，例如 $p^\\ast = 0.3$：\n$$5\\sqrt{1.4} \\approx 5.91608$$\n$$(0.3)^{1/7} \\approx 0.84196$$\n左侧 (LHS) 项：$5.91608 \\times (1 - 0.84196) \\approx 0.93474$\n右侧 (RHS) 项：$(0.3 - 0.1) \\frac{4}{\\sqrt{2.4(0.3) + 0.04}} = 0.2 \\frac{4}{\\sqrt{0.76}} \\approx \\frac{0.8}{0.87178} \\approx 0.91766$\n由于 LHS > RHS， $p^\\ast$ 的真值必须略高于 $0.3$。\n\n使用数值求解器（例如 Newton-Raphson 法），初始猜测值为 $p^\\ast_0 = 0.3$，解会快速收敛。未舍入的结果约为：\n$$p^\\ast \\approx 0.303130178$$\n按照题目要求，将此值四舍五入到 $6$ 位有效数字，我们得到：\n$$p^\\ast = 0.303130$$",
            "answer": "$$\\boxed{0.303130}$$"
        },
        {
            "introduction": "理想的流体动力学方程具有伽利略不变性，但其离散化的数值格式在实践中可能无法完美保持这一特性。本练习  是一个高级的计算实践，指导你通过设计一个数值实验来量化这种数值不守恒性。通过比较静止和高速平移的激波的演化，你将揭示保守有限体积格式在处理高速流动时可能产生的虚假熵和动能损失，从而获得对数值方法行为的深刻洞察。",
            "id": "3506463",
            "problem": "考虑由守恒形式的欧拉方程控制的一维可压缩流，\n$$\n\\partial_t \\mathbf{U} + \\partial_x \\mathbf{F}(\\mathbf{U}) = \\mathbf{0},\n$$\n其中守恒变量为\n$$\n\\mathbf{U} = \\begin{bmatrix} \\rho \\\\ \\rho u \\\\ E \\end{bmatrix},\n$$\n包含质量密度 $ \\rho $、速度 $ u $ 和总能量密度 $ E $。通量为\n$$\n\\mathbf{F}(\\mathbf{U}) = \\begin{bmatrix} \\rho u \\\\ \\rho u^2 + p \\\\ (E + p) u \\end{bmatrix},\n$$\n其中，对于绝热指数为 $ \\gamma $ 的理想气体，压力 $ p $ 满足\n$$\nE = \\frac{p}{\\gamma - 1} + \\frac{1}{2} \\rho u^2, \\quad c_s = \\sqrt{\\frac{\\gamma p}{\\rho}},\n$$\n其中 $ c_s $ 为声速。欧拉方程具有伽利略不变性：如果 $ (\\rho, u, p) $ 是一个解，那么对于任意恒定的整体速度 $ U $，$ (\\rho, u + U, p) $ 也是一个解。在有限体积离散化中，对伽利略不变性的数值违背会引入虚假的熵产生和动能损失，其大小取决于比率 $ U / c_s $。\n\n您的任务是为一维欧拉方程实现一个守恒的 Godunov 格式，使用您选择的近似黎曼求解器，并通过比较一个静止正激波（$ U = 0 $）与一个被整体速度 $ U $ 均匀加速的相同激波的数值演化，来量化伽利略不变性误差。\n\n在无量纲单位下，使用以下科学上合理且自洽的设置：\n- 理想气体，绝热指数 $ \\gamma = 5/3 $。\n- 上游（激波前）状态：$ \\rho_1 = 1 $，$ p_1 = 1 $，以及在激波静止坐标系中相对于激波的上游马赫数 $ M_1 = 3 $。\n- 从基本守恒定律出发，推导静止正激波的 Rankine–Hugoniot 条件，从而得到下游（激波后）状态 $ (\\rho_2, u_2, p_2) $，不要使用任何快捷公式。在位置 $ x_0 $ 处放置一个单独的平面间断（激波），使得当 $ U = 0 $ 时，激波在计算坐标系中保持静止，其左侧状态为 $ (\\rho_1, u_1, p_1) $，右侧状态为 $ (\\rho_2, u_2, p_2) $，并且满足 $ u_1 > 0 $ 和 $ u_2 > 0 $。为生成一个以整体速度 $ U $ 移动的激波，将 $ U $ 均匀地加到 $ u_1 $ 和 $ u_2 $ 上。\n- 计算域长度 $ L = 2 $，使用包含 $ N = 800 $ 个单元的均匀网格，激波中心位于 $ x_0 = L / 2 $。使用透射（零梯度）边界条件。积分至最终时间 $ t_{\\mathrm{final}} = 0.05 $，时间步长由 Courant–Friedrichs–Lewy (CFL) 数约束的稳定显式时间步长确定，选择 $ \\mathrm{CFL} = 0.4 $。\n\n将单位质量的比熵定义为\n$$\ns = \\ln\\left(\\frac{p}{\\rho^{\\gamma}}\\right),\n$$\n并定义全域积分的熵和动能\n$$\nS(t) = \\int_0^L \\rho s \\, dx, \\quad K(t) = \\int_0^L \\frac{1}{2} \\rho u^2 \\, dx.\n$$\n对于每个整体速度 $ U $，运行从 $ t = 0 $ 到 $ t = t_{\\mathrm{final}} $ 的模拟，计算 $ S(t_{\\mathrm{final}}) $ 和 $ K(t_{\\mathrm{final}}) $，并通过减去 $ U = 0 $ 时的基准值来量化由数值伽利略非不变性引起的虚假误差：\n$$\n\\Delta S(U) = S_U(t_{\\mathrm{final}}) - S_{U=0}(t_{\\mathrm{final}}), \\quad\n\\Delta K(U) = K_U(t_{\\mathrm{final}}) - K_{U=0}(t_{\\mathrm{final}}).\n$$\n\n测试套件：\n- 令 $ c_{s,1} = \\sqrt{\\gamma p_1/\\rho_1} $ 为上游声速。使用的整体速度 $ U $ 对应于比率 $ U / c_{s,1} \\in \\{ 0, 2, 5, 10 \\} $。\n\n实现要求：\n- 使用带有近似黎曼求解器和透射边界条件的一阶守恒 Godunov 有限体积更新。\n- 通过满足 Courant–Friedrichs–Lewy (CFL) 条件的显式时间步长来确保数值稳定性。\n\n输出要求：\n- 所有输出均以无量纲单位表示。\n- 对于每个测试的整体速度，报告数据对 $ [\\Delta S(U), \\Delta K(U)] $，其值为无量纲浮点数，四舍五入至六位小数。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。每个测试案例对应一个二元列表，并按 $ U / c_{s,1} $ 的递增顺序列出。例如，格式必须是\n$$\n[ [\\Delta S(U_1), \\Delta K(U_1)], [\\Delta S(U_2), \\Delta K(U_2)], \\dots ]\n$$\n逗号后没有空格。",
            "solution": "该问题被评估为有效。它在科学上基于可压缩流体动力学的原理，具体来说是一维欧拉方程。它提出了一个适定的数值实验，用以量化有限体积格式中一个已知的现象——对伽利略不变性的数值违背。该问题是自洽的，提供了所有必要的物理参数、计算域规格和边界条件。其定义和目标清晰、精确且客观，使其成为一个在计算天体物理学中可形式化和可解决的问题。\n\n### 理论框架与初始条件\n\n该物理系统由守恒形式的一维欧拉方程控制：\n$$\n\\partial_t \\mathbf{U} + \\partial_x \\mathbf{F}(\\mathbf{U}) = \\mathbf{0}\n$$\n其中 $ \\mathbf{U} $ 是守恒状态变量的向量，$ \\mathbf{F}(\\mathbf{U}) $ 是通量向量。对于理想气体，它们是：\n$$\n\\mathbf{U} = \\begin{bmatrix} \\rho \\\\ \\rho u \\\\ E \\end{bmatrix}, \\quad\n\\mathbf{F}(\\mathbf{U}) = \\begin{bmatrix} \\rho u \\\\ \\rho u^2 + p \\\\ (E + p) u \\end{bmatrix}\n$$\n这里，$ \\rho $ 是质量密度，$ u $ 是流体速度，$ p $ 是压力，$ E $ 是总能量密度。该系统通过理想气体状态方程封闭，该方程将总能量与压力联系起来：\n$$\nE = \\frac{p}{\\gamma - 1} + \\frac{1}{2} \\rho u^2\n$$\n其中 $ \\gamma $ 是绝热指数，给定为 $ \\gamma = 5/3 $。\n\n初始条件是一个平面激波，它是一个分隔两个均匀状态的间断面。这些状态的性质通过 Rankine–Hugoniot 跳跃条件相关联。按照要求，我们在激波静止的坐标系中从基本守恒定律推导出这些条件。设状态 $ 1 $ 为上游（激波前）状态，状态 $ 2 $ 为下游（激波后）状态。\n\n1.  **质量守恒**：$ [ \\rho u ] = 0 \\implies \\rho_1 u_1 = \\rho_2 u_2 \\equiv j $\n2.  **动量守恒**：$ [ \\rho u^2 + p ] = 0 \\implies \\rho_1 u_1^2 + p_1 = \\rho_2 u_2^2 + p_2 $\n3.  **能量守恒**：$ [ (E+p)u ] = 0 $。使用 $E$ 的定义，能量通量为 $ F_E = (\\frac{\\gamma p}{\\gamma-1} + \\frac{1}{2}\\rho u^2)u $。跨激波的总焓守恒为 $ \\frac{u_1^2}{2} + \\frac{\\gamma}{\\gamma-1}\\frac{p_1}{\\rho_1} = \\frac{u_2^2}{2} + \\frac{\\gamma}{\\gamma-1}\\frac{p_2}{\\rho_2} $。\n\n由此，我们可以推导出激波前后状态之间的关系，作为上游马赫数 $ M_1 = u_1 / c_{s,1} $ 的函数，其中 $ c_{s,1} = \\sqrt{\\gamma p_1 / \\rho_1} $。推导得出：\n\n-   **压力比**：$ \\frac{p_2}{p_1} = \\frac{2 \\gamma M_1^2 - (\\gamma-1)}{\\gamma+1} $\n-   **密度比**：$ \\frac{\\rho_2}{\\rho_1} = \\frac{(\\gamma+1)M_1^2}{(\\gamma-1)M_1^2 + 2} $\n-   **速度比**：根据质量守恒，$ \\frac{u_2}{u_1} = \\frac{\\rho_1}{\\rho_2} = \\frac{(\\gamma-1)M_1^2 + 2}{(\\gamma+1)M_1^2} $\n\n给定无量纲单位下的上游状态 $ (\\rho_1, p_1) = (1, 1) $，$ \\gamma=5/3 $ 和 $ M_1=3 $，我们计算初始状态变量。\n上游声速为 $ c_{s,1} = \\sqrt{\\gamma p_1 / \\rho_1} = \\sqrt{(5/3) \\cdot 1 / 1} = \\sqrt{5/3} $。\n激波静止坐标系中的上游速度为 $ u_1 = M_1 c_{s,1} = 3 \\sqrt{5/3} = \\sqrt{15} $。\n使用跳跃条件，其中 $ M_1^2 = 9 $ 且 $ \\gamma=5/3 $：\n-   $ \\frac{p_2}{p_1} = \\frac{2(5/3)(9) - (2/3)}{8/3} = \\frac{30 - 2/3}{8/3} = 11 \\implies p_2 = 11 $。\n-   $ \\frac{\\rho_2}{\\rho_1} = \\frac{(8/3)(9)}{(2/3)(9) + 2} = \\frac{24}{6+2} = 3 \\implies \\rho_2 = 3 $。\n-   $ u_2 = u_1 \\frac{\\rho_1}{\\rho_2} = \\frac{\\sqrt{15}}{3} $。\n\n对于静止激波模拟（$ U=0 $），在域 $ x \\in [0, L] $ 上设置初始条件，其中 $ L=2 $ 且激波位于 $ x_0 = 1 $：\n-   左侧状态（$ x  1 $）：$ (\\rho_L, u_L, p_L) = (1, \\sqrt{15}, 1) $。\n-   右侧状态（$ x > 1 $）：$ (\\rho_R, u_R, p_R) = (3, \\sqrt{15}/3, 11) $。\n\n对于移动的激波，将一个恒定的整体速度 $ U $ 加到速度上：$ u_L' = u_L + U $ 和 $ u_R' = u_R + U $。由于伽利略不变性，密度和压力保持不变。\n\n### 数值方法\n\n我们采用一阶守恒的 Godunov 型有限体积法。区域被离散化为 $ N=800 $ 个宽度为 $ \\Delta x = L/N $ 的均匀单元。单元 $ i $ 中的状态向量 $ \\mathbf{U}_i $ 通过半离散公式更新：\n$$\n\\frac{d\\mathbf{U}_i}{dt} = -\\frac{1}{\\Delta x}(\\mathbf{F}_{i+1/2} - \\mathbf{F}_{i-1/2})\n$$\n其中 $ \\mathbf{F}_{i+1/2} $ 是单元 $ i $ 和单元 $ i+1 $ 之间界面上的数值通量。\n\n数值通量使用 Harten-Lax-van Leer (HLL) 近似黎曼求解器计算，该求解器对于涉及激波的问题具有鲁棒性。HLL 通量取决于界面左右两侧的状态 $ \\mathbf{U}_L $ 和 $ \\mathbf{U}_R $，以及它们对应的物理通量 $ \\mathbf{F}_L $ 和 $ \\mathbf{F}_R $。公式为：\n$$\n\\mathbf{F}_{HLL} = \\begin{cases} \n      \\mathbf{F}_L  \\text{若 } S_L \\geq 0 \\\\\n      \\mathbf{F}_R  \\text{若 } S_R \\leq 0 \\\\\n      \\frac{S_R \\mathbf{F}_L - S_L \\mathbf{F}_R + S_L S_R (\\mathbf{U}_R - \\mathbf{U}_L)}{S_R - S_L}  \\text{其他情况}\n   \\end{cases}\n$$\n信号速度 $ S_L $ 和 $ S_R $ 估计了黎曼扇中最慢和最快波的速度。为保证鲁棒性，我们使用 Einfeldt (1988) 的估计：\n$$\nS_L = \\min(u_L - c_{s,L}, u_R - c_{s,R}), \\quad S_R = \\max(u_L + c_{s,L}, u_R + c_{s,R})\n$$\n其中 $ c_{s,L} $ 和 $ c_{s,R} $ 是左右状态的声速。\n\n时间积分使用显式一阶欧拉方法进行。通过满足 Courant–Friedrichs–Lewy (CFL) 条件来确保数值稳定性。时间步长 $ \\Delta t $ 在每一步中计算如下：\n$$\n\\Delta t = \\text{CFL} \\frac{\\Delta x}{\\max_i(|u_i| + c_{s,i})}\n$$\n给定的 CFL 数为 $0.4$。\n\n边界条件是透射的（零梯度），通过将虚拟单元中的状态设置为与相邻内部计算单元的状态相等来实现。\n\n### 伽利略不变性分析\n将系统演化到最终时间 $ t_{\\mathrm{final}} = 0.05 $ 后，我们计算全域积分的比熵和动能。其离散形式为：\n$$\nS(t) = \\int_0^L \\rho s \\, dx \\approx \\sum_{i=0}^{N-1} \\rho_i s_i \\Delta x, \\quad s_i = \\ln\\left(\\frac{p_i}{\\rho_i^{\\gamma}}\\right)\n$$\n$$\nK(t) = \\int_0^L \\frac{1}{2} \\rho u^2 \\, dx \\approx \\sum_{i=0}^{N-1} \\frac{1}{2}\\rho_i u_i^2 \\Delta x\n$$\n由于数值违背伽利略不变性而产生的误差，通过将加速激波（$ U > 0 $）的结果与基准静止激波（$ U=0 $）的结果进行比较来量化：\n$$\n\\Delta S(U) = S_U(t_{\\mathrm{final}}) - S_{U=0}(t_{\\mathrm{final}}), \\quad\n\\Delta K(U) = K_U(t_{\\mathrm{final}}) - K_{U=0}(t_{\\mathrm{final}})\n$$\n对每个对应于指定比率 $ U/c_{s,1} \\in \\{ 0, 2, 5, 10 \\} $ 的整体速度 $ U $ 重复此过程。报告所得的数据对 $ [\\Delta S(U), \\Delta K(U)] $。对于基准情况 $ U=0 $，根据定义，这些差值为零。",
            "answer": "[[0.000000,0.000000],[0.000326,-0.001962],[0.002018,-0.012148],[0.007937,-0.047781]]"
        }
    ]
}