{
    "hands_on_practices": [
        {
            "introduction": "Understanding artificial viscosity begins with its role in ensuring numerical stability. This practice strips the problem down to its essence by examining the one-dimensional linear advection equation, a common model for transport phenomena. By adding an artificial viscosity term, you will perform a rigorous analysis to derive the conditions for stability and monotonicity, culminating in a determination of the minimum viscosity needed to prevent spurious oscillations in a finite difference scheme .",
            "id": "3504913",
            "problem": "Consider the one-dimensional linear advection equation used as a model for passive scalar transport in computational astrophysics,\n$$\n\\partial_{t} u(x,t) + a\\,\\partial_{x} u(x,t) = 0,\n$$\naugmented by an artificial viscosity term to stabilize numerical oscillations near steep gradients,\n$$\n\\partial_{t} u(x,t) + a\\,\\partial_{x} u(x,t) = \\epsilon\\,\\partial_{xx} u(x,t).\n$$\nAssume a uniform grid with spacing $\\Delta x$ and an explicit single-step time integrator with time step $\\Delta t$. Consider the following conservative finite difference scheme with forward Euler time stepping, centered differencing for the advective flux, and a second difference for the viscous flux:\n$$\nu_{j}^{n+1} = u_{j}^{n} - \\frac{a\\,\\Delta t}{2\\,\\Delta x}\\left(u_{j+1}^{n} - u_{j-1}^{n}\\right) + \\frac{\\epsilon\\,\\Delta t}{\\Delta x^{2}}\\left(u_{j+1}^{n} - 2u_{j}^{n} + u_{j-1}^{n}\\right).\n$$\nIntroduce the nondimensional parameters $\\lambda = \\frac{a\\,\\Delta t}{\\Delta x}$ and $\\mu = \\frac{\\epsilon\\,\\Delta t}{\\Delta x^{2}}$. Starting from first principles, do the following:\n\n- Derive the consistency (accuracy) conditions for this scheme by Taylor expansion, identifying the leading-order terms in the local truncation error in terms of $\\Delta t$, $\\Delta x$, $a$, and $\\epsilon$.\n- Using the Lax–Richtmyer equivalence theorem (LRET), articulate stability requirements for this linear constant-coefficient scheme to guarantee convergence under grid refinement.\n- Map the Total Variation Diminishing (TVD) requirement to a monotonicity constraint for this linear update and derive the inequalities on $\\lambda$ and $\\mu$ that enforce TVD for all grid points.\n- From these inequalities, determine the minimal artificial viscosity $\\epsilon(\\Delta x,\\Delta t)$ that guarantees TVD behavior for the given discretization while maintaining consistency.\n\nProvide your final answer as a single closed-form expression for the minimal artificial viscosity $\\epsilon$ in terms of $a$ and $\\Delta x$, without any numerical substitution. If evaluated numerically, express $\\epsilon$ in square meters per second, but do not include units in the final expression. No rounding is required.",
            "solution": "The problem statement is valid as it presents a standard, well-posed problem in computational fluid dynamics concerning the numerical analysis of a finite difference scheme for the advection-diffusion equation. The problem is scientifically grounded, objective, and self-contained. I will proceed with the four-part derivation as requested.\n\nThe governing partial differential equation (PDE) is the one-dimensional linear advection-diffusion equation:\n$$\n\\partial_{t} u + a\\,\\partial_{x} u = \\epsilon\\,\\partial_{xx} u\n$$\nThe provided finite difference scheme is:\n$$\nu_{j}^{n+1} = u_{j}^{n} - \\frac{a\\,\\Delta t}{2\\,\\Delta x}\\left(u_{j+1}^{n} - u_{j-1}^{n}\\right) + \\frac{\\epsilon\\,\\Delta t}{\\Delta x^{2}}\\left(u_{j+1}^{n} - 2u_{j}^{n} + u_{j-1}^{n}\\right)\n$$\nUsing the nondimensional parameters $\\lambda = \\frac{a\\,\\Delta t}{\\Delta x}$ and $\\mu = \\frac{\\epsilon\\,\\Delta t}{\\Delta x^{2}}$, the scheme can be written as:\n$$\nu_{j}^{n+1} = u_{j}^{n} - \\frac{\\lambda}{2}\\left(u_{j+1}^{n} - u_{j-1}^{n}\\right) + \\mu\\left(u_{j+1}^{n} - 2u_{j}^{n} + u_{j-1}^{n}\\right)\n$$\n\nFirst, to derive the consistency conditions and local truncation error, we perform a Taylor series expansion of each term in the scheme around the point $(x_j, t_n)$. We rearrange the scheme as:\n$$\n\\frac{u_{j}^{n+1} - u_{j}^{n}}{\\Delta t} + a\\frac{u_{j+1}^{n} - u_{j-1}^{n}}{2\\,\\Delta x} - \\epsilon\\frac{u_{j+1}^{n} - 2u_{j}^{n} + u_{j-1}^{n}}{\\Delta x^{2}} = 0\n$$\nWe expand each term, where $u$ and its derivatives are evaluated at $(x_j, t_n)$:\n$$\n\\frac{u_{j}^{n+1} - u_{j}^{n}}{\\Delta t} = \\frac{(u + \\Delta t\\,\\partial_t u + \\frac{\\Delta t^2}{2}\\partial_{tt} u + \\dots) - u}{\\Delta t} = \\partial_t u + \\frac{\\Delta t}{2}\\partial_{tt} u + O(\\Delta t^2)\n$$\n$$\n\\frac{u_{j+1}^{n} - u_{j-1}^{n}}{2\\,\\Delta x} = \\frac{(u + \\Delta x\\,\\partial_x u + \\frac{\\Delta x^2}{2}\\partial_{xx} u + \\frac{\\Delta x^3}{6}\\partial_{xxx} u + \\dots) - (u - \\Delta x\\,\\partial_x u + \\frac{\\Delta x^2}{2}\\partial_{xx} u - \\frac{\\Delta x^3}{6}\\partial_{xxx} u + \\dots)}{2\\,\\Delta x} = \\partial_x u + \\frac{\\Delta x^2}{6}\\partial_{xxx} u + O(\\Delta x^4)\n$$\n$$\n\\frac{u_{j+1}^{n} - 2u_{j}^{n} + u_{j-1}^{n}}{\\Delta x^{2}} = \\frac{(u + \\Delta x\\,\\partial_x u + \\frac{\\Delta x^2}{2}\\partial_{xx} u + \\dots) - 2u + (u - \\Delta x\\,\\partial_x u + \\frac{\\Delta x^2}{2}\\partial_{xx} u + \\dots)}{\\Delta x^2} = \\partial_{xx} u + \\frac{\\Delta x^2}{12}\\partial_{xxxx} u + O(\\Delta x^4)\n$$\nSubstituting these expansions into the rearranged scheme gives the truncation error, $T_j^n$:\n$$\nT_j^n = \\left(\\partial_t u + \\frac{\\Delta t}{2}\\partial_{tt} u\\right) + a\\left(\\partial_x u + \\frac{\\Delta x^2}{6}\\partial_{xxx} u\\right) - \\epsilon\\left(\\partial_{xx} u + \\frac{\\Delta x^2}{12}\\partial_{xxxx} u\\right) + \\dots\n$$\n$$\nT_j^n = (\\partial_t u + a\\,\\partial_x u - \\epsilon\\,\\partial_{xx} u) + \\frac{\\Delta t}{2}\\partial_{tt} u + a\\,\\frac{\\Delta x^2}{6}\\partial_{xxx} u - \\epsilon\\,\\frac{\\Delta x^2}{12}\\partial_{xxxx} u + O(\\Delta t^2, \\Delta x^4)\n$$\nFor an exact solution to the PDE, the first term $(\\partial_t u + a\\,\\partial_x u - \\epsilon\\,\\partial_{xx} u)$ is zero. The local truncation error is therefore:\n$$\nT_j^n = \\frac{\\Delta t}{2}\\partial_{tt} u + a\\,\\frac{\\Delta x^2}{6}\\partial_{xxx} u - \\epsilon\\,\\frac{\\Delta x^2}{12}\\partial_{xxxx} u + \\dots\n$$\nThe scheme is consistent because $T_j^n \\to 0$ as $\\Delta t \\to 0$ and $\\Delta x \\to 0$. The leading-order error terms are $O(\\Delta t)$ and $O(\\Delta x^2)$, so the scheme is first-order accurate in time and second-order accurate in space.\n\nSecond, according to the Lax–Richtmyer equivalence theorem, for a consistent scheme applied to a well-posed linear initial-value problem, convergence is equivalent to stability. We analyze stability using the von Neumann method. We seek a solution of the form $u_j^n = g^n e^{ikx_j}$, where $g$ is the amplification factor and $k$ is the wavenumber. Substituting this into the scheme:\n$$\ng = 1 - \\frac{\\lambda}{2}(e^{ik\\Delta x} - e^{-ik\\Delta x}) + \\mu(e^{ik\\Delta x} - 2 + e^{-ik\\Delta x})\n$$\nUsing Euler's formula, with $\\theta = k\\Delta x$, we have $e^{i\\theta} - e^{-i\\theta} = 2i\\sin\\theta$ and $e^{i\\theta} + e^{-i\\theta} - 2 = 2\\cos\\theta - 2 = -4\\sin^2(\\theta/2)$.\n$$\ng(\\theta) = 1 - i\\lambda\\sin\\theta - 4\\mu\\sin^2(\\frac{\\theta}{2})\n$$\nThe stability condition is $|g| \\le 1$ for all $\\theta \\in [-\\pi, \\pi]$.\n$$\n|g|^2 = \\left(1 - 4\\mu\\sin^2(\\frac{\\theta}{2})\\right)^2 + (-\\lambda\\sin\\theta)^2 \\le 1\n$$\n$$\n1 - 8\\mu\\sin^2(\\frac{\\theta}{2}) + 16\\mu^2\\sin^4(\\frac{\\theta}{2}) + \\lambda^2\\sin^2\\theta \\le 1\n$$\nUsing $\\sin\\theta = 2\\sin(\\theta/2)\\cos(\\theta/2)$, we get:\n$$\n-8\\mu\\sin^2(\\frac{\\theta}{2}) + 16\\mu^2\\sin^4(\\frac{\\theta}{2}) + 4\\lambda^2\\sin^2(\\frac{\\theta}{2})\\cos^2(\\frac{\\theta}{2}) \\le 0\n$$\nFor $\\theta \\neq 0$, we can divide by $4\\sin^2(\\theta/2)  0$:\n$$\n-2\\mu + 4\\mu^2\\sin^2(\\frac{\\theta}{2}) + \\lambda^2\\cos^2(\\frac{\\theta}{2}) \\le 0\n$$\nSince $\\cos^2(\\theta/2) = 1 - \\sin^2(\\theta/2)$, the inequality becomes:\n$$\n\\lambda^2 - 2\\mu + (4\\mu^2 - \\lambda^2)\\sin^2(\\frac{\\theta}{2}) \\le 0\n$$\nThis must hold for all $\\sin^2(\\theta/2) \\in [0, 1]$. We check the endpoints.\nAt $\\sin^2(\\theta/2) = 0$ (i.e., $\\theta=0$): $\\lambda^2 - 2\\mu \\le 0 \\implies \\lambda^2 \\le 2\\mu$.\nAt $\\sin^2(\\theta/2) = 1$ (i.e., $\\theta=\\pi$): $\\lambda^2 - 2\\mu + 4\\mu^2 - \\lambda^2 \\le 0 \\implies 4\\mu^2 - 2\\mu \\le 0 \\implies 2\\mu(2\\mu - 1) \\le 0$. Since $\\mu = \\epsilon\\Delta t/\\Delta x^2 \\ge 0$, this implies $2\\mu - 1 \\le 0$, or $\\mu \\le 1/2$.\nThus, the stability requirements are $\\lambda^2 \\le 2\\mu$ and $\\mu \\le 1/2$.\n\nThird, we map the Total Variation Diminishing (TVD) requirement to a monotonicity constraint. A sufficient condition for a linear scheme to be TVD is that it is monotone, which means all coefficients in its explicit update form are non-negative. We rewrite the scheme to identify these coefficients:\n$$\nu_{j}^{n+1} = \\left(\\mu - \\frac{\\lambda}{2}\\right)u_{j+1}^{n} + (1 - 2\\mu)u_{j}^{n} + \\left(\\mu + \\frac{\\lambda}{2}\\right)u_{j-1}^{n}\n$$\nThe coefficients are $C_{j+1} = \\mu - \\lambda/2$, $C_j = 1 - 2\\mu$, and $C_{j-1} = \\mu + \\lambda/2$. For monotonicity, all must be non-negative.\n1. $C_j = 1 - 2\\mu \\ge 0 \\implies \\mu \\le 1/2$.\n2. The other two coefficients depend on the sign of $\\lambda = a\\Delta t/\\Delta x$.\n   Case $a \\ge 0$ ($\\lambda \\ge 0$):\n   $C_{j+1} = \\mu - \\lambda/2 \\ge 0 \\implies \\lambda \\le 2\\mu$.\n   $C_{j-1} = \\mu + \\lambda/2 \\ge 0$ is always true since $\\mu, \\lambda \\ge 0$.\n   Case $a  0$ ($\\lambda  0$):\n   $C_{j-1} = \\mu + \\lambda/2 \\ge 0 \\implies \\mu \\ge -\\lambda/2 \\implies \\mu \\ge |\\lambda|/2 \\implies |\\lambda| \\le 2\\mu$.\n   $C_{j+1} = \\mu - \\lambda/2 = \\mu + |\\lambda|/2 \\ge 0$ is always true.\nIn both cases, the conditions for monotonicity (and thus TVD) are:\n$$\n|\\lambda| \\le 2\\mu \\quad \\text{and} \\quad \\mu \\le \\frac{1}{2}\n$$\nNote that the TVD condition $|\\lambda| \\le 2\\mu$ is stricter than the stability condition $\\lambda^2 \\le 2\\mu$, as squaring the former gives $\\lambda^2 \\le 4\\mu^2$, and since $\\mu \\le 1/2$, $4\\mu^2 = 2\\mu(2\\mu) \\le 2\\mu(1) = 2\\mu$.\n\nFourth, we determine the minimal artificial viscosity $\\epsilon$ from these TVD inequalities. The first inequality is $|\\lambda| \\le 2\\mu$. Substituting the definitions of $\\lambda$ and $\\mu$:\n$$\n\\left|\\frac{a\\,\\Delta t}{\\Delta x}\\right| \\le 2\\left(\\frac{\\epsilon\\,\\Delta t}{\\Delta x^{2}}\\right)\n$$\nAssuming $\\Delta t > 0$ and $\\Delta x > 0$, we can simplify:\n$$\n\\frac{|a|}{\\Delta x} \\le \\frac{2\\epsilon}{\\Delta x^2} \\implies |a|\\Delta x \\le 2\\epsilon\n$$\nThis gives a lower bound on the artificial viscosity coefficient:\n$$\n\\epsilon \\ge \\frac{|a|\\Delta x}{2}\n$$\nThe minimal artificial viscosity that can satisfy this condition is therefore $\\epsilon_{\\min} = \\frac{|a|\\Delta x}{2}$. For this choice to guarantee TVD, the second condition, $\\mu \\le 1/2$, must also be satisfiable. Substituting $\\epsilon = \\epsilon_{\\min}$:\n$$\n\\mu = \\frac{\\epsilon_{\\min}\\Delta t}{\\Delta x^2} = \\frac{(|a|\\Delta x/2)\\Delta t}{\\Delta x^2} = \\frac{|a|\\Delta t}{2\\Delta x} = \\frac{|\\lambda|}{2}\n$$\nThe condition $\\mu \\le 1/2$ becomes $|\\lambda|/2 \\le 1/2$, which simplifies to $|\\lambda| \\le 1$. This is the standard Courant-Friedrichs-Lewy (CFL) condition for an advective scheme. Therefore, a TVD scheme is only possible if the time step is chosen such that $|\\lambda| = |a|\\Delta t / \\Delta x \\le 1$. Assuming the scheme operates under this condition, the minimal artificial viscosity required to enforce TVD behavior is given by the equality in the first condition. This choice of $\\epsilon$ is consistent with the original advection equation in the limit of grid refinement, as $\\epsilon \\propto \\Delta x$ implies $\\epsilon \\to 0$ as $\\Delta x \\to 0$.\n\nThe minimal artificial viscosity $\\epsilon$ is thus expressed in terms of $a$ and $\\Delta x$.\n$$\n\\epsilon_{\\min} = \\frac{|a|\\Delta x}{2}\n$$",
            "answer": "$$\n\\boxed{\\frac{|a|\\Delta x}{2}}\n$$"
        },
        {
            "introduction": "Moving from theory to practice, we now apply artificial viscosity to a classic astrophysical scenario: the Sedov-Taylor blast wave. In complex simulations, it is not enough for the scheme to be stable; we must also control the structure of captured shocks to ensure accuracy. This hands-on exercise guides you through the process of calibrating the von Neumann-Richtmyer artificial viscosity coefficients to controllably spread a shock front over a specific number of grid zones, a crucial skill for obtaining reliable results .",
            "id": "3504909",
            "problem": "Consider a one-dimensional, spherically symmetric Sedov-Taylor blast wave in a uniform medium of rest-mass density $\\rho_0$ and adiabatic index $\\gamma$. The inviscid dynamics are governed by the Euler equations for compressible flow together with the Rankine–Hugoniot shock jump conditions. In the strong-shock limit, the shock radius obeys a self-similar scaling law $R_s(t) \\propto t^{2/5}$ and the shock speed $U_s(t) = \\mathrm{d}R_s/\\mathrm{d}t \\propto t^{-3/5}$. The post-shock sound speed $c_{s,2}$ is related to the shock speed $U_s$ by a constant ratio that depends only on $\\gamma$. Define this ratio as $\\kappa \\equiv c_{s,2}/U_s$.\n\nTo capture shocks numerically while preserving self-similar scaling, many schemes use Artificial Viscosity (AV). A standard form is the von Neumann–Richtmyer AV, which augments the pressure by\n$$\nq = \\rho\\left(\\beta\\, \\ell^2 (\\nabla\\cdot \\mathbf{u})^2 + \\alpha\\, c_s\\, \\ell\\, \\lvert \\nabla\\cdot \\mathbf{u}\\rvert\\right),\n$$\nwhere $\\rho$ is the density, $\\mathbf{u}$ is the velocity, $c_s$ is the local sound speed, $\\ell$ is a characteristic numerical length (take $\\ell = \\Delta x$), and $\\alpha$ and $\\beta$ are dimensionless AV coefficients. The goal is to spread the shock over a thickness $\\delta$ that is approximately $N$ zones, so that $\\delta \\approx N \\Delta x$, while preserving the self-similar scaling.\n\nStarting from the Euler equations and the Rankine–Hugoniot conditions in the strong-shock limit, proceed from first principles to:\n1) Derive the post-shock sound speed $c_{s,2}$ in terms of the shock speed $U_s$ and the adiabatic index $\\gamma$, and hence show that $\\kappa \\equiv c_{s,2}/U_s$ is a constant depending only on $\\gamma$.\n2) By balancing the AV-induced stress with the inertial momentum flux across the shock layer, derive an equation for the nondimensional shock thickness $x \\equiv \\delta/\\ell$ of the form\n$$\n\\beta \\left(\\frac{\\ell}{\\delta}\\right)^2 + \\alpha \\kappa \\left(\\frac{\\ell}{\\delta}\\right) = 1,\n$$\nand show that prescribing $x = N$ implies a relation between $\\beta$, $\\alpha$, $N$, and $\\kappa$.\n3) Solve the relation from step 2 to obtain $\\beta$ in terms of $\\alpha$, $N$, and $\\kappa$, under the condition that $\\beta \\ge 0$ for physical admissibility and self-similarity (which requires a time-independent $x$). Explicitly identify the constraint on $\\alpha$ for given $N$ and $\\gamma$ ensuring $\\beta \\ge 0$.\n4) Provide an algorithm that, for given $(\\gamma, \\alpha, N)$, computes $\\kappa(\\gamma)$, computes $\\beta$, and independently verifies the implied thickness $x$ by solving the quadratic relation for $x$ without assuming $x=N$ a priori. Use $\\ell = \\Delta x$ so that $x = \\delta/\\Delta x$.\n\nYour program must implement the algorithm from step 4 and evaluate it on the following test suite. All quantities in the output are dimensionless, so no physical units are required.\n- Test case 1 (pure quadratic AV): $\\gamma = 5/3$, $\\alpha = 0$, $N = 3$.\n- Test case 2 (pure linear AV achieving $x=N$): $\\gamma = 5/3$, $N = 4$, and choose $\\alpha = N/\\kappa(\\gamma)$ so that $\\beta = 0$.\n- Test case 3 (mixed AV): $\\gamma = 1.4$, $\\alpha = 1.0$, $N = 6$.\n- Test case 4 (near-boundary mixed AV): $\\gamma = 5/3$, choose $\\alpha = 0.95\\, N/\\kappa(\\gamma)$ with $N=3$.\n\nFor each test case, your program must output two values in order:\n- The computed $\\beta$ according to your derived formula.\n- The independently verified $x$ obtained by solving the quadratic relation for the nondimensional thickness, i.e., solving for $x = \\delta/\\Delta x$ directly from the relation in step 2 without assuming $x=N$.\n\nFinal output format: Your program should produce a single line of output containing the eight floating-point results for the four test cases, ordered as\n$$\n[\\beta_1, x_1, \\beta_2, x_2, \\beta_3, x_3, \\beta_4, x_4],\n$$\nrounded to six decimal places, with comma separators and enclosed in square brackets (e.g., \"[1.000000,3.000000,0.000000,4.000000, ...]\").",
            "solution": "The problem is valid as it is scientifically grounded in the principles of fluid dynamics and computational astrophysics, well-posed, objective, and internally consistent. We proceed with a step-by-step derivation and solution.\n\n### Step 1: Derivation of the Post-Shock Sound Speed Ratio $\\kappa$\n\nWe analyze a one-dimensional strong shock using the Rankine-Hugoniot jump conditions in the shock rest frame. Let the pre-shock (upstream) state be denoted by subscript $1$ and the post-shock (downstream) state by subscript $2$.\n\nThe given conditions are:\n- Pre-shock density: $\\rho_1 = \\rho_0$\n- Pre-shock velocity: $u_1 = U_s$ (velocity of the medium entering the shock)\n- Strong shock limit: Pre-shock pressure $P_1 \\to 0$ and specific internal energy $e_1 \\to 0$.\n\nThe Rankine-Hugoniot conditions for conservation of mass, momentum, and energy are:\n1.  Mass: $\\rho_1 u_1 = \\rho_2 u_2$\n    $$ \\rho_0 U_s = \\rho_2 u_2 $$\n2.  Momentum: $P_1 + \\rho_1 u_1^2 = P_2 + \\rho_2 u_2^2$\n    $$ \\rho_0 U_s^2 = P_2 + \\rho_2 u_2^2 $$\n3.  Energy: $e_1 + \\frac{P_1}{\\rho_1} + \\frac{1}{2}u_1^2 = e_2 + \\frac{P_2}{\\rho_2} + \\frac{1}{2}u_2^2$, where $e = \\frac{P}{(\\gamma-1)\\rho}$ for an ideal gas.\n    $$ \\frac{1}{2}U_s^2 = \\frac{P_2}{(\\gamma-1)\\rho_2} + \\frac{P_2}{\\rho_2} + \\frac{1}{2}u_2^2 = \\frac{\\gamma P_2}{(\\gamma-1)\\rho_2} + \\frac{1}{2}u_2^2 $$\n\nFrom the mass conservation equation, we have $u_2 = (\\rho_0/\\rho_2) U_s$. Substituting this into the momentum equation:\n$$ P_2 = \\rho_0 U_s^2 - \\rho_2 \\left(\\frac{\\rho_0}{\\rho_2} U_s\\right)^2 = \\rho_0 U_s^2 \\left(1 - \\frac{\\rho_0}{\\rho_2}\\right) $$\nNow, substitute the expressions for $u_2$ and $P_2$ into the energy equation:\n$$ \\frac{1}{2}U_s^2 = \\frac{\\gamma}{(\\gamma-1)\\rho_2} \\left[\\rho_0 U_s^2 \\left(1 - \\frac{\\rho_0}{\\rho_2}\\right)\\right] + \\frac{1}{2}\\left(\\frac{\\rho_0}{\\rho_2} U_s\\right)^2 $$\nDividing by $U_s^2$ and letting $\\xi = \\rho_0/\\rho_2$ be the inverse compression ratio:\n$$ \\frac{1}{2} = \\frac{\\gamma}{\\gamma-1} \\xi - \\left(\\frac{\\gamma}{\\gamma-1} - \\frac{1}{2}\\right)\\xi^2 = \\frac{\\gamma}{\\gamma-1} \\xi - \\frac{\\gamma+1}{2(\\gamma-1)} \\xi^2 $$\nMultiplying by $2(\\gamma-1)$ yields a quadratic equation for $\\xi$:\n$$ \\gamma-1 = 2\\gamma \\xi - (\\gamma+1)\\xi^2 \\implies (\\gamma+1)\\xi^2 - 2\\gamma\\xi + (\\gamma-1) = 0 $$\nThe solutions are $\\xi=1$ (the trivial no-shock case) and $\\xi = \\frac{\\gamma-1}{\\gamma+1}$. Thus, the compression ratio is $\\rho_2/\\rho_0 = \\frac{\\gamma+1}{\\gamma-1}$.\n\nNow we find the post-shock pressure $P_2$:\n$$ P_2 = \\rho_0 U_s^2 (1 - \\xi) = \\rho_0 U_s^2 \\left(1 - \\frac{\\gamma-1}{\\gamma+1}\\right) = \\frac{2\\rho_0 U_s^2}{\\gamma+1} $$\nThe post-shock sound speed $c_{s,2}$ is given by $c_{s,2}^2 = \\gamma P_2 / \\rho_2$:\n$$ c_{s,2}^2 = \\gamma \\frac{P_2}{\\rho_2} = \\gamma \\frac{2\\rho_0 U_s^2 / (\\gamma+1)}{ \\rho_0 (\\gamma+1)/(\\gamma-1)} = \\frac{2\\gamma(\\gamma-1)}{(\\gamma+1)^2} U_s^2 $$\nTaking the square root gives the post-shock sound speed:\n$$ c_{s,2} = U_s \\frac{\\sqrt{2\\gamma(\\gamma-1)}}{\\gamma+1} $$\nThe ratio $\\kappa$ is therefore:\n$$ \\kappa \\equiv \\frac{c_{s,2}}{U_s} = \\frac{\\sqrt{2\\gamma(\\gamma-1)}}{\\gamma+1} $$\nThis expression depends only on the adiabatic index $\\gamma$, so $\\kappa$ is a constant for a given medium.\n\n### Step 2: Derivation of the Shock Thickness Equation\n\nThe von Neumann-Richtmyer artificial viscosity (AV) adds a term $q$ to the pressure to model shock dissipation. The problem asks us to derive a relation by balancing the AV-induced stress with the inertial momentum flux.\n\nThe inertial momentum flux of the upstream gas is the ram pressure, $\\rho_0 U_s^2$. We postulate that the maximum AV stress, $q_{max}$, must be of this order to halt the incoming flow:\n$$ q_{max} \\approx \\rho_0 U_s^2 $$\nThe AV stress is given by:\n$$ q = \\rho\\left(\\beta\\, \\ell^2 (\\nabla\\cdot \\mathbf{u})^2 + \\alpha\\, c_s\\, \\ell\\, \\lvert \\nabla\\cdot \\mathbf{u}\\rvert\\right) $$\nTo evaluate $q$ within the shock layer of thickness $\\delta$, we make the following scaling approximations:\n- The velocity gradient across the shock is of order the shock speed divided by the shock thickness: $|\\nabla \\cdot \\mathbf{u}| \\approx U_s/\\delta$.\n- The characteristic sound speed within the dissipative region is the post-shock sound speed: $c_s \\approx c_{s,2} = \\kappa U_s$.\n- The density factor $\\rho$ in the AV formula is often chosen based on numerical convenience and stability. To obtain the desired relation, we choose the pre-shock density $\\rho_0$.\n\nSubstituting these approximations into the expression for $q$:\n$$ q \\approx \\rho_0 \\left( \\beta \\ell^2 \\left(\\frac{U_s}{\\delta}\\right)^2 + \\alpha (\\kappa U_s) \\ell \\left(\\frac{U_s}{\\delta}\\right) \\right) $$\n$$ q \\approx \\rho_0 U_s^2 \\left( \\beta \\left(\\frac{\\ell}{\\delta}\\right)^2 + \\alpha \\kappa \\left(\\frac{\\ell}{\\delta}\\right) \\right) $$\nEquating this to the ram pressure $\\rho_0 U_s^2$:\n$$ \\rho_0 U_s^2 \\approx \\rho_0 U_s^2 \\left( \\beta \\left(\\frac{\\ell}{\\delta}\\right)^2 + \\alpha \\kappa \\left(\\frac{\\ell}{\\delta}\\right) \\right) $$\nThis simplifies to the desired relation:\n$$ \\beta \\left(\\frac{\\ell}{\\delta}\\right)^2 + \\alpha \\kappa \\left(\\frac{\\ell}{\\delta}\\right) = 1 $$\nWith the definition of the nondimensional shock thickness $x \\equiv \\delta/\\ell$, the relation becomes $\\beta(1/x)^2 + \\alpha\\kappa(1/x) = 1$. If we prescribe that the shock thickness spans $N$ zones, i.e., $x = N$, we get a relation between the AV coefficients and physical parameters:\n$$ \\beta \\left(\\frac{1}{N}\\right)^2 + \\alpha \\kappa \\left(\\frac{1}{N}\\right) = 1 $$\n\n### Step 3: Expression for $\\beta$ and Physical Constraint\n\nWe solve the relation from Step 2 for $\\beta$:\n$$ \\frac{\\beta}{N^2} + \\frac{\\alpha \\kappa}{N} = 1 \\implies \\frac{\\beta}{N^2} = 1 - \\frac{\\alpha \\kappa}{N} $$\n$$ \\beta = N^2 \\left(1 - \\frac{\\alpha \\kappa}{N}\\right) = N^2 - N \\alpha \\kappa $$\nFor $\\beta$ to be physically admissible (representing a dissipative, not antidissipative, process), we must have $\\beta \\ge 0$. This imposes a constraint on $\\alpha$:\n$$ N^2 - N \\alpha \\kappa \\ge 0 $$\nSince $N  0$, we can divide by $N$:\n$$ N - \\alpha \\kappa \\ge 0 \\implies N \\ge \\alpha \\kappa $$\nThus, the constraint on the linear viscosity coefficient $\\alpha$ is:\n$$ \\alpha \\le \\frac{N}{\\kappa} $$\n\n### Step 4: Algorithm for Computing $\\beta$ and Verifying $x$\n\nThe algorithm proceeds as follows for a given set of parameters $(\\gamma, \\alpha, N)$:\n1.  **Compute $\\kappa$**: Use the formula derived in Step 1:\n    $$ \\kappa(\\gamma) = \\frac{\\sqrt{2\\gamma(\\gamma-1)}}{\\gamma+1} $$\n2.  **Compute $\\beta$**: Use the formula derived in Step 3:\n    $$ \\beta(\\alpha, N, \\kappa) = N^2 - N \\alpha \\kappa $$\n3.  **Verify thickness $x$**: Solve the quadratic relation from Step 2 for $x$ without assuming $x=N$. Let $y = 1/x$. The equation is:\n    $$ \\beta y^2 + (\\alpha\\kappa) y - 1 = 0 $$\n    This is a quadratic equation for $y$.\n    -   If $\\beta \\approx 0$, the equation is linear: $(\\alpha \\kappa) y - 1 = 0$, so $y = 1/(\\alpha\\kappa)$, which gives $x = \\alpha\\kappa$.\n    -   If $\\beta  0$, we use the quadratic formula for $y$. Since $x$ must be a positive physical thickness, $y=1/x$ must also be positive.\n    $$ y = \\frac{-(\\alpha\\kappa) \\pm \\sqrt{(\\alpha\\kappa)^2 - 4(\\beta)(-1)}}{2\\beta} = \\frac{-\\alpha\\kappa \\pm \\sqrt{(\\alpha\\kappa)^2 + 4\\beta}}{2\\beta} $$\n    Since $\\beta \\ge 0$, the term under the square root is non-negative. To ensure $y  0$, we must choose the positive root:\n    $$ y = \\frac{-\\alpha\\kappa + \\sqrt{(\\alpha\\kappa)^2 + 4\\beta}}{2\\beta} $$\n    The independently verified thickness is then $x = 1/y$. As a self-consistency check, substituting the expression for $\\beta$ into this formula for $y$ recovers $y=1/N$, thus $x=N$, provided $\\beta0$. This \"verification\" step confirms the algebraic consistency of our derivation.\n\nThis constitutes the complete algorithm to be implemented.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements an algorithm to compute artificial viscosity parameters for a\n    Sedov-Taylor blast wave and verifies the resulting shock thickness.\n    \"\"\"\n    \n    # Define test cases: (type, gamma, alpha_parameter, N)\n    # 'const_alpha': alpha_parameter is the value of alpha.\n    # 'beta_zero': alpha is calculated as N/kappa to make beta=0.\n    # 'scaled_alpha': alpha is calculated as alpha_parameter * N/kappa.\n    test_cases = [\n        ('const_alpha', 5/3, 0.0, 3),  # Test case 1\n        ('beta_zero', 5/3, None, 4),   # Test case 2\n        ('const_alpha', 1.4, 1.0, 6),  # Test case 3\n        ('scaled_alpha', 5/3, 0.95, 3) # Test case 4\n    ]\n\n    results = []\n\n    for case_type, gamma, alpha_param, N in test_cases:\n        # Step 1: Compute kappa(gamma)\n        # kappa = c_{s,2} / U_s\n        kappa = np.sqrt(2 * gamma * (gamma - 1)) / (gamma + 1)\n\n        # Step 2: Determine alpha and compute beta\n        alpha = 0.0\n        if case_type == 'const_alpha':\n            alpha = alpha_param\n        elif case_type == 'beta_zero':\n            #\n            # Set alpha such that beta = 0.\n            # beta = N^2 - N * alpha * kappa = 0  =>  alpha = N / kappa\n            #\n            alpha = N / kappa\n        elif case_type == 'scaled_alpha':\n            #\n            # Set alpha as a scaling factor of the beta=0 case.\n            # alpha = scaling_factor * (N / kappa)\n            #\n            alpha = alpha_param * N / kappa\n        \n        # beta = N^2 - N * alpha * kappa\n        beta = N**2 - N * alpha * kappa\n\n        # Step 3: Independently verify the nondimensional thickness x\n        # This is done by solving beta * (1/x)^2 + alpha*kappa * (1/x) - 1 = 0 for x.\n        ak = alpha * kappa\n        x = 0.0\n\n        # Handle the case where beta is numerically close to zero (linear equation for 1/x)\n        if np.isclose(beta, 0.0):\n            # The relation becomes alpha*kappa * (1/x) = 1 => x = alpha*kappa\n            # Note that for this case, N = alpha*kappa by definition of alpha.\n            if np.isclose(ak, 0.0): # Should not happen in these test cases\n                x = np.inf\n            else:\n                x = ak\n        else: # Standard quadratic case for 1/x\n            # Let y = 1/x. Equation is beta*y^2 + ak*y - 1 = 0\n            # Physical solution (y > 0) requires the positive root.\n            discriminant = ak**2 + 4 * beta\n            \n            # Since beta is guaranteed to be >= 0 by the problem setup\n            # for physically meaningful shocks, discriminant is non-negative.\n            sqrt_discriminant = np.sqrt(discriminant)\n            \n            # y = (-ak + sqrt(discriminant)) / (2*beta)\n            y = (-ak + sqrt_discriminant) / (2 * beta)\n\n            if np.isclose(y, 0.0):\n                x = np.inf\n            else:\n                x = 1.0 / y\n        \n        results.extend([beta, x])\n\n    # Print results in the specified format, rounded to 6 decimal places.\n    print(f\"[{','.join([f'{r:.6f}' for r in results])}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "While essential for shocks, artificial viscosity can be overly dissipative, damping important physical motions like rotation and shear. This practice introduces a sophisticated solution common in Smoothed Particle Hydrodynamics (SPH): an artificial viscosity \"switch\". You will construct a switch function from first principles that uses local flow properties to distinguish between compression and vorticity, ensuring that viscosity is applied strongly in shocks but suppressed in divergence-free flows .",
            "id": "3465306",
            "problem": "In cosmological Smoothed Particle Hydrodynamics (SPH), artificial viscosity is introduced to capture shocks while avoiding spurious dissipation in vortical or shear-dominated flows. A common strategy is to modulate the artificial viscosity coefficient by a switch factor that suppresses viscosity in regions where vorticity dominates over compression. Consider a switch function $f$ that multiplies a base artificial viscosity coefficient $\\alpha$, so that the effective coefficient is $f \\alpha$. The switch $f$ should satisfy the following principles derived from first principles and dimensional analysis:\n\n- It depends only on kinematic invariants that distinguish compression from rotation, namely the divergence magnitude $\\left|\\nabla \\cdot \\mathbf{v}\\right|$ and the vorticity magnitude $\\left|\\nabla \\times \\mathbf{v}\\right|$.\n- It is dimensionless, bounded between $0$ and $1$, increases monotonically with $\\left|\\nabla \\cdot \\mathbf{v}\\right|$ at fixed $\\left|\\nabla \\times \\mathbf{v}\\right|$, and decreases monotonically with $\\left|\\nabla \\times \\mathbf{v}\\right|$ at fixed $\\left|\\nabla \\cdot \\mathbf{v}\\right|$.\n- It remains well-defined in quiescent flows by including a regularizing term constructed from the local signal speed $c$ and smoothing length $h$, combined with a small dimensionless parameter $\\epsilon0$, such that the combination has the same dimensions as $\\left|\\nabla \\cdot \\mathbf{v}\\right|$ and $\\left|\\nabla \\times \\mathbf{v}\\right|$.\n\n(a) Using these requirements, construct the simplest admissible form of $f$ built from nonnegative linear contributions of the admissible invariants that respects the stated monotonicity, boundedness, and dimensional constraints.\n\n(b) For a locally vortical flow in a cosmological SPH calculation with $\\left|\\nabla \\cdot \\mathbf{v}\\right|=0.01$, $\\left|\\nabla \\times \\mathbf{v}\\right|=10$, $c=1$, $h=0.05$, $\\epsilon=0.1$, and base coefficient $\\alpha=1$, evaluate the switch $f$ and the effective artificial viscosity coefficient $f\\alpha$.\n\nRound your numerical results for $f$ and $f\\alpha$ to four significant figures. Report your final answers as two numbers without units in the order $\\left(f, f\\alpha\\right)$.",
            "solution": "The user has provided a problem that requires the derivation of a switch function for artificial viscosity in Smoothed Particle Hydrodynamics (SPH) based on a set of physical principles, followed by a numerical evaluation.\n\n### Step 1: Problem Validation\n\nFirst, I must validate the problem statement.\n\n#### 1.1. Extraction of Givens\n\n- **Context**: Artificial viscosity in cosmological SPH.\n- **Goal**: Modulate the base artificial viscosity coefficient, $\\alpha$, with a switch function, $f$, resulting in an effective coefficient $f\\alpha$.\n- **Principles for constructing $f$**:\n    1.  $f$ depends only on the divergence magnitude, $\\left|\\nabla \\cdot \\mathbf{v}\\right|$, and the vorticity magnitude, $\\left|\\nabla \\times \\mathbf{v}\\right|$.\n    2.  $f$ is dimensionless and bounded, such that $0 \\le f \\le 1$.\n    3.  $f$ exhibits specific monotonicity: it increases with $\\left|\\nabla \\cdot \\mathbf{v}\\right|$ (at fixed $\\left|\\nabla \\times \\mathbf{v}\\right|$) and decreases with $\\left|\\nabla \\times \\mathbf{v}\\right|$ (at fixed $\\left|\\nabla \\cdot \\mathbf{v}\\right|$).\n    4.  $f$ is regularized to be well-defined in quiescent flows. The regularizing term is constructed from the local signal speed $c$, smoothing length $h$, and a small dimensionless parameter $\\epsilon  0$. This term must have the same dimensions as $\\left|\\nabla \\cdot \\mathbf{v}\\right|$.\n    5. The form of $f$ should be the \"simplest admissible form\" built from nonnegative linear contributions of the admissible invariants.\n- **Part (a) Task**: Construct the mathematical form of $f$.\n- **Part (b) Task**: Evaluate $f$ and $f\\alpha$ using the following numerical values:\n    - $\\left|\\nabla \\cdot \\mathbf{v}\\right| = 0.01$\n    - $\\left|\\nabla \\times \\mathbf{v}\\right| = 10$\n    - $c = 1$\n    - $h = 0.05$\n    - $\\epsilon = 0.1$\n    - $\\alpha = 1$\n- **Output Requirement**: Round numerical results to four significant figures and report them as an ordered pair $(f, f\\alpha)$.\n\n#### 1.2. Validation against Criteria\n\n- **Scientifically Grounded**: The problem is well-grounded in the field of computational fluid dynamics and astrophysics. The use of artificial viscosity, and specifically switches based on the ratio of divergence to vorticity to suppress it in shear flows, is a standard and well-documented technique in SPH (e.g., the Balsara switch). The principles stated are physically and mathematically sound.\n- **Well-Posed**: The problem is well-posed. Part (a) asks for the derivation of a functional form based on a clear set of constraints. The \"simplest form\" is a standard heuristic in such derivations and leads to a specific, commonly used function. Part (b) is a direct numerical calculation using the derived formula. A unique solution exists.\n- **Objective**: The problem is stated in precise, objective language, free of ambiguity or subjective claims.\n- **Flaw Check**: The problem does not violate any of the disqualifying flaws. It is not scientifically unsound, is formalizable, is complete, poses a realistic and feasible task, is well-structured, and is not trivial or tautological.\n\n#### 1.3. Verdict\n\nThe problem is valid. I will now proceed with the solution.\n\n### Step 2: Solution Derivation\n\n#### Part (a): Construction of the Switch Function $f$\n\nLet the divergence magnitude be $D = \\left|\\nabla \\cdot \\mathbf{v}\\right|$ and the vorticity magnitude be $W = \\left|\\nabla \\times \\mathbf{v}\\right|$. In fluid dynamics, both $D$ and $W$ have dimensions of inverse time, $[T^{-1}]$.\n\n1.  **Dimensionality**: The function $f$ must be dimensionless. This requires it to be a function of a dimensionless combination of the input quantities. The simplest way to form a dimensionless quantity from $D$ and $W$ is to take their ratio, or a ratio of expressions with the same dimensions.\n\n2.  **Monotonicity**: The function $f$ must increase with $D$ and decrease with $W$. This suggests that $D$ should be in the numerator and $W$ in the denominator. Let us consider a general form $f = g\\left(\\frac{D}{W}\\right)$, where $g$ is some function. To satisfy the monotonicity, $g$ must be an increasing function of its argument.\n\n3.  **Simplicity and Boundedness**: The problem asks for the \"simplest admissible form built from nonnegative linear contributions\". This suggests a rational function where the numerator and denominator are linear sums of the available terms. Let's propose a form:\n    $$f = \\frac{k_1 D}{k_2 D + k_3 W}$$\n    where $k_1, k_2, k_3$ are positive dimensionless constants. This form is dimensionless.\n    - To satisfy the boundedness condition $f \\le 1$, we require $k_1 D \\le k_2 D + k_3 W$. Rearranging gives $(k_1 - k_2)D \\le k_3 W$. For this to hold for all non-negative $D$ and $W$, the simplest choice is to set $k_1 = k_2$.\n    - The requirement for the \"simplest\" form with \"nonnegative linear contributions\" implies we should choose the constants to be as simple as possible, e.g., $1$. Setting $k_1 = k_2 = k_3 = 1$ gives the form:\n    $$f = \\frac{D}{D+W} = \\frac{\\left|\\nabla \\cdot \\mathbf{v}\\right|}{\\left|\\nabla \\cdot \\mathbf{v}\\right| + \\left|\\nabla \\times \\mathbf{v}\\right|}$$\n    This form is bounded between $0$ and $1$ for non-negative $D$ and $W$, and satisfies the monotonicity requirements.\n\n4.  **Regularization**: The form above is undefined if both $D$ and $W$ are zero. The problem requires a regularizing term to prevent this. This term, let's call it $R$, must have the same dimensions as $D$ and $W$, which is $[T^{-1}]$. It is constructed from the signal speed $c$ (dimensions $[L T^{-1}]$), the smoothing length $h$ (dimensions $[L]$), and the dimensionless parameter $\\epsilon  0$. The only combination of $c$ and $h$ that yields dimensions of $[T^{-1}]$ is $c/h$. Thus, the regularizing term is proportional to this, e.g., $R = \\epsilon \\frac{c}{h}$.\n    To incorporate this regularization into our \"simplest linear contribution\" form, we add it to the denominator to prevent division by zero. This maintains the structure of the function and its dimensionless nature.\n\nCombining these principles, the simplest admissible form for the switch function $f$ is:\n$$f = \\frac{\\left|\\nabla \\cdot \\mathbf{v}\\right|}{\\left|\\nabla \\cdot \\mathbf{v}\\right| + \\left|\\nabla \\times \\mathbf{v}\\right| + \\epsilon \\frac{c}{h}}$$\nThis form satisfies all the stated conditions: it depends on the correct invariants, is dimensionless, is bounded between $0$ and $1$, has the correct monotonic behavior, and is regularized for quiescent flows.\n\n#### Part (b): Numerical Evaluation\n\nWe are given the following values:\n- $\\left|\\nabla \\cdot \\mathbf{v}\\right| = 0.01$\n- $\\left|\\nabla \\times \\mathbf{v}\\right| = 10$\n- $c = 1$\n- $h = 0.05$\n- $\\epsilon = 0.1$\n- $\\alpha = 1$\n\nFirst, calculate the regularization term, $R = \\epsilon \\frac{c}{h}$:\n$$R = (0.1) \\frac{1}{0.05} = 0.1 \\times 20 = 2$$\n\nNow, substitute the values into the derived expression for the switch function $f$:\n$$f = \\frac{\\left|\\nabla \\cdot \\mathbf{v}\\right|}{\\left|\\nabla \\cdot \\mathbf{v}\\right| + \\left|\\nabla \\times \\mathbf{v}\\right| + R} = \\frac{0.01}{0.01 + 10 + 2} = \\frac{0.01}{12.01}$$\n$$f \\approx 0.000832639467...$$\nRounding to four significant figures, we get:\n$$f \\approx 0.0008326$$\n\nNext, we calculate the effective artificial viscosity coefficient, $f\\alpha$. Since the base coefficient $\\alpha = 1$, the effective coefficient is numerically equal to $f$:\n$$f\\alpha = (0.0008326) \\times 1 = 0.0008326$$\n\nThe problem asks for the two numbers $(f, f\\alpha)$. The values are $(0.0008326, 0.0008326)$. This extremely low value of the switch function is expected, as the flow is strongly dominated by vorticity ($\\left|\\nabla \\times \\mathbf{v}\\right| = 10$) compared to compression ($\\left|\\nabla \\cdot \\mathbf{v}\\right| = 0.01$), which is precisely the situation where artificial viscosity should be suppressed.",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 0.0008326  0.0008326 \\end{pmatrix} } $$"
        }
    ]
}