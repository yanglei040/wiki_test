{
    "hands_on_practices": [
        {
            "introduction": "The foundation of any Riemann solver lies in understanding the characteristic structure of the underlying hyperbolic equations. For the Euler equations, these characteristics represent the paths along which information propagates, corresponding to sound waves and the fluid flow itself. This exercise  focuses on deriving and calculating these fundamental wave speeds, which are not only critical for determining the stable time step of a simulation via the Courant–Friedrichs–Lewy (CFL) condition but also form the basis for estimating the dissipation needed in many approximate solvers.",
            "id": "3504120",
            "problem": "Consider the one-dimensional Euler equations for an inviscid, compressible ideal gas,\n$$\n\\partial_t U + \\partial_x F(U) = 0,\n$$\nwith conserved variables $U = (\\rho, \\rho u, E)^{\\top}$, flux $F(U) = (\\rho u, \\rho u^{2} + p, u(E + p))^{\\top}$, and closure by the ideal-gas equation of state $p = (\\gamma - 1)\\left(E - \\tfrac{1}{2}\\rho u^{2}\\right)$. The system is hyperbolic, and small perturbations about a constant state propagate along characteristic fields. From the hyperbolic structure and the thermodynamics of an ideal gas, derive the characteristic wave speeds of the one-dimensional Euler system in terms of primitive variables $(\\rho, u, p)$ and the adiabatic index $\\gamma$, and then evaluate these speeds for the left and right initial states\n$$\nU_L = (\\rho_L, u_L, p_L) = (1.0, 0.0, 1.0), \\quad U_R = (\\rho_R, u_R, p_R) = (0.125, 0.0, 0.1),\n$$\nwith $\\gamma = 1.4$. Using these results, determine the maximum signal speed at time $t = 0$ appropriate for a Courant–Friedrichs–Lewy (CFL) time step estimate, defined as the largest magnitude of any characteristic speed present initially in the domain. Work in nondimensional units consistent with the given states. Round all numerical values to six significant figures. The final answer must list, in order, the three characteristic speeds for the left state, the three characteristic speeds for the right state, and the maximum signal speed, and must be given as a single row matrix. No physical units are to be reported in the final boxed answer.",
            "solution": "The problem is well-posed, scientifically grounded, and contains all necessary information for a unique solution. The one-dimensional Euler equations for an inviscid, ideal gas constitute a standard model in fluid dynamics. The task involves deriving the characteristic wave speeds from the fundamental system of equations and then applying this result to the given initial conditions. The problem is therefore valid.\n\nThe one-dimensional Euler equations are given in conservation law form as:\n$$\n\\partial_t U + \\partial_x F(U) = 0\n$$\nwhere $U = (\\rho, \\rho u, E)^{\\top}$ is the vector of conserved variables (density, momentum, total energy), and $F(U) = (\\rho u, \\rho u^2 + p, u(E+p))^{\\top}$ is the flux vector. The system is closed by the ideal gas equation of state, $p = (\\gamma-1)(E - \\frac{1}{2}\\rho u^2)$.\n\nThe characteristic speeds of this hyperbolic system are the eigenvalues of the Jacobian matrix $A(U) = \\frac{\\partial F}{\\partial U}$. To find these eigenvalues, it is more convenient to first express the Euler equations in terms of primitive variables $W = (\\rho, u, p)^{\\top}$. The resulting quasi-linear system is $\\partial_t W + \\tilde{A}(W) \\partial_x W = 0$, where the matrix $\\tilde{A}(W)$ has the same eigenvalues as $A(U)$.\n\nThe primitive form of the Euler equations is derived as follows:\n1.  **Continuity Equation**:\n    Starting from $\\partial_t \\rho + \\partial_x(\\rho u) = 0$, we apply the product rule:\n    $$\n    \\partial_t \\rho + u \\partial_x \\rho + \\rho \\partial_x u = 0\n    $$\n\n2.  **Momentum Equation**:\n    Starting from the conservative momentum equation $\\partial_t(\\rho u) + \\partial_x(\\rho u^2 + p) = 0$, and using the continuity equation, one can derive the primitive variable form:\n    $$\n    \\partial_t u + u \\partial_x u + \\frac{1}{\\rho}\\partial_x p = 0\n    $$\n\n3.  **Energy Equation**:\n    For an ideal gas undergoing an adiabatic process, the quantity $p/\\rho^\\gamma$ is conserved along fluid streamlines. This leads to the equation:\n    $$\n    \\partial_t p + u \\partial_x p + \\gamma p \\partial_x u = 0\n    $$\n\nThese three equations can be written in matrix form as:\n$$\n\\frac{\\partial}{\\partial t}\n\\begin{pmatrix}\n\\rho \\\\ u \\\\ p\n\\end{pmatrix}\n+\n\\begin{pmatrix}\nu & \\rho & 0 \\\\\n0 & u & 1/\\rho \\\\\n0 & \\gamma p & u\n\\end{pmatrix}\n\\frac{\\partial}{\\partial x}\n\\begin{pmatrix}\n\\rho \\\\ u \\\\ p\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0 \\\\ 0 \\\\ 0\n\\end{pmatrix}\n$$\nThe characteristic wave speeds, $\\lambda$, are the eigenvalues of the matrix $\\tilde{A}(W)$:\n$$\n\\tilde{A}(W) = \\begin{pmatrix}\nu & \\rho & 0 \\\\\n0 & u & 1/\\rho \\\\\n0 & \\gamma p & u\n\\end{pmatrix}\n$$\nWe solve the characteristic equation $\\det(\\tilde{A} - \\lambda I) = 0$:\n$$\n\\det \\begin{pmatrix}\nu - \\lambda & \\rho & 0 \\\\\n0 & u - \\lambda & 1/\\rho \\\\\n0 & \\gamma p & u - \\lambda\n\\end{pmatrix} = (u - \\lambda) \\left[ (u - \\lambda)^2 - (\\gamma p)(1/\\rho) \\right] = 0\n$$\nThis equation yields three eigenvalues:\n$$\n\\lambda_1 = u, \\quad (u - \\lambda)^2 = \\frac{\\gamma p}{\\rho}\n$$\nThe second part gives $u - \\lambda = \\pm \\sqrt{\\frac{\\gamma p}{\\rho}}$.\nThe term $c = \\sqrt{\\frac{\\gamma p}{\\rho}}$ is the adiabatic speed of sound.\nThus, the three characteristic wave speeds are:\n$$\n\\lambda_1 = u - c, \\quad \\lambda_2 = u, \\quad \\lambda_3 = u + c\n$$\n\nNow, we evaluate these speeds for the given left ($L$) and right ($R$) initial states, with $\\gamma = 1.4$.\n\n**For the left state:** $U_L \\implies (\\rho_L, u_L, p_L) = (1.0, 0.0, 1.0)$.\nThe speed of sound in the left state is:\n$$\nc_L = \\sqrt{\\frac{\\gamma p_L}{\\rho_L}} = \\sqrt{\\frac{(1.4)(1.0)}{1.0}} = \\sqrt{1.4} \\approx 1.1832159566\n$$\nRounding to six significant figures, $c_L \\approx 1.18322$.\nThe characteristic speeds for the left state are:\n$$\n\\lambda_{1,L} = u_L - c_L = 0.0 - 1.18322 = -1.18322\n$$\n$$\n\\lambda_{2,L} = u_L = 0.0\n$$\n$$\n\\lambda_{3,L} = u_L + c_L = 0.0 + 1.18322 = 1.18322\n$$\n\n**For the right state:** $U_R \\implies (\\rho_R, u_R, p_R) = (0.125, 0.0, 0.1)$.\nThe speed of sound in the right state is:\n$$\nc_R = \\sqrt{\\frac{\\gamma p_R}{\\rho_R}} = \\sqrt{\\frac{(1.4)(0.1)}{0.125}} = \\sqrt{\\frac{0.14}{0.125}} = \\sqrt{1.12} \\approx 1.0583005244\n$$\nRounding to six significant figures, $c_R \\approx 1.05830$.\nThe characteristic speeds for the right state are:\n$$\n\\lambda_{1,R} = u_R - c_R = 0.0 - 1.05830 = -1.05830\n$$\n$$\n\\lambda_{2,R} = u_R = 0.0\n$$\n$$\n\\lambda_{3,R} = u_R + c_R = 0.0 + 1.05830 = 1.05830\n$$\n\n**Maximum Signal Speed:**\nThe maximum signal speed, $S_{\\text{max}}$, for the CFL condition is the largest magnitude among all characteristic speeds initially present.\n$$\nS_{\\text{max}} = \\max(|\\lambda_{1,L}|, |\\lambda_{2,L}|, |\\lambda_{3,L}|, |\\lambda_{1,R}|, |\\lambda_{2,R}|, |\\lambda_{3,R}|)\n$$\nThe set of magnitudes is $\\{|-1.18322|, |0.0|, |1.18322|, |-1.05830|, |0.0|, |1.05830|\\}$, which is $\\{1.18322, 0.0, 1.05830\\}$.\nThe maximum of these values is:\n$$\nS_{\\text{max}} = 1.18322\n$$\nThis corresponds to the magnitude of the fastest waves, which are the sound waves moving into the stationary fluid in the left state.\n\nThe final answer requires a row matrix containing the three left-state speeds, the three right-state speeds, and the maximum signal speed, all rounded to six significant figures.\nThe values are:\n-   Left speeds: $-1.18322, 0.0, 1.18322$\n-   Right speeds: $-1.05830, 0.0, 1.05830$\n-   Max signal speed: $1.18322$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -1.18322 & 0.0 & 1.18322 & -1.05830 & 0.0 & 1.05830 & 1.18322 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "With an understanding of characteristic speeds, we can construct our first complete approximate Riemann solver. The Rusanov solver, also known as the local Lax-Friedrichs scheme, is valued for its simplicity and robustness. This practice exercise  walks you through the calculation of the Rusanov numerical flux, which elegantly combines the physical fluxes from either side of a discontinuity with a powerful dissipation term scaled by the maximum local signal speed. This approach provides a practical introduction to the core idea of numerical stabilization in shock-capturing schemes.",
            "id": "3504119",
            "problem": "Consider the one-dimensional Euler equations for an ideal gas in conservation form, with state vector $U = (\\rho, m, E)$ where $\\rho$ is the mass density, $m = \\rho u$ is the momentum density, and $E$ is the total energy density. The corresponding flux function is $F(U) = (\\rho u, \\rho u^{2} + p, u(E + p))$, where $p$ is the gas pressure and $u$ is the fluid velocity. The equation of state for an ideal gas is $p = (\\gamma - 1)\\left(E - \\frac{1}{2}\\rho u^{2}\\right)$, and the adiabatic sound speed is $a = \\sqrt{\\frac{\\gamma p}{\\rho}}$. In the Rusanov (local Lax–Friedrichs) approximate Riemann solver, the numerical flux at an interface is constructed by averaging the physical fluxes from the left and right states and adding dissipation proportional to the maximum characteristic speed.\n\nYou are modeling a compressible astrophysical flow with adiabatic index $\\gamma = \\frac{5}{3}$. At a cell interface, the left and right primitive states (density, velocity, pressure) are given by $U_{L} = (\\rho_{L}, u_{L}, p_{L}) = (1, 2, 1)$ and $U_{R} = (\\rho_{R}, u_{R}, p_{R}) = \\left(0.5, -1, 0.5\\right)$. Treat these tuples as primitive variables and convert them to the conserved form where necessary. Using the standard definition of the Rusanov approximate Riemann solver, compute the numerical flux at the interface and report the three components of the flux vector (mass, momentum, and energy flux). Express your final answer as a single row vector of the three components. Provide the result in exact analytic form; do not round. No units are required.",
            "solution": "The user has provided a problem from computational astrophysics concerning the calculation of a numerical flux using the Rusanov approximate Riemann solver.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n- **System:** One-dimensional Euler equations in conservation form.\n- **State Vector:** $U = (\\rho, m, E)$, where $\\rho$ is mass density, $m = \\rho u$ is momentum density, and $E$ is total energy density.\n- **Flux Function:** $F(U) = (\\rho u, \\rho u^{2} + p, u(E + p))$, where $u$ is velocity and $p$ is pressure.\n- **Equation of State (ideal gas):** $p = (\\gamma - 1)\\left(E - \\frac{1}{2}\\rho u^{2}\\right)$.\n- **Adiabatic Sound Speed:** $a = \\sqrt{\\frac{\\gamma p}{\\rho}}$.\n- **Numerical Method:** Rusanov (local Lax–Friedrichs) approximate Riemann solver. The numerical flux $F^*$ is defined as $F^* = \\frac{1}{2}[F(U_L) + F(U_R)] - \\frac{1}{2}S_{\\text{max}}[U_R - U_L]$, where $S_{\\text{max}}$ is the maximum characteristic speed.\n- **Adiabatic Index:** $\\gamma = \\frac{5}{3}$.\n- **Left Primitive State:** $(\\rho_{L}, u_{L}, p_{L}) = (1, 2, 1)$.\n- **Right Primitive State:** $(\\rho_{R}, u_{R}, p_{R}) = (0.5, -1, 0.5)$.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientific Grounding:** The problem is based on the Euler equations of gas dynamics, the ideal gas law, and the Rusanov flux scheme, which are standard, well-established concepts in computational fluid dynamics and computational astrophysics. This is scientifically sound.\n- **Well-Posedness:** The problem provides all necessary information: the governing equations, the equation of state, the specific numerical scheme, the adiabatic index, and the initial left and right states. These inputs are sufficient to compute a unique, stable, and meaningful numerical flux vector.\n- **Objectivity:** The problem statement is composed entirely of clear, precise, and objective mathematical and physical definitions and data. There are no subjective or ambiguous terms.\n- **Flaw Checklist:**\n    1.  **Scientific Unsoundness:** None.\n    2.  **Non-Formalizable/Irrelevant:** The problem is a formal and canonical example within the topic of approximate Riemann solvers.\n    3.  **Incomplete/Contradictory:** All necessary data are provided and are self-consistent.\n    4.  **Unrealistic/Infeasible:** The numerical values for the states are physically plausible within a normalized context.\n    5.  **Ill-Posed/Poorly Structured:** The problem is well-posed.\n    6.  **Trivial/Tautological:** The calculation, while straightforward, involves multiple non-trivial steps and requires a solid understanding of the underlying physics and numerical method.\n    7.  **Outside Verifiability:** The result is mathematically verifiable.\n\n**Step 3: Verdict and Action**\nThe problem is **valid**. A complete, reasoned solution will be provided.\n\n### Solution\n\nThe Rusanov numerical flux, $F^*$, at the interface between a left state $U_L$ and a right state $U_R$ is given by the formula:\n$$F^*(U_L, U_R) = \\frac{1}{2} [F(U_L) + F(U_R)] - \\frac{1}{2} S_{\\text{max}} [U_R - U_L]$$\nwhere $F(U)$ is the physical flux, $U$ is the vector of conserved variables, and $S_{\\text{max}}$ is the maximum signal speed at the interface. The calculation proceeds in four steps.\n\n**1. Convert Primitive Variables to Conserved Variables**\nThe vector of conserved variables is $U = (\\rho, m, E) = (\\rho, \\rho u, E)$. The total energy density $E$ is related to the primitive variables via the equation of state:\n$$E = \\frac{p}{\\gamma - 1} + \\frac{1}{2}\\rho u^{2}$$\nWith $\\gamma = \\frac{5}{3}$, the term $\\gamma-1 = \\frac{2}{3}$.\n\nFor the left state, $U_L$, with $(\\rho_L, u_L, p_L) = (1, 2, 1)$:\n- Mass density: $\\rho_L = 1$.\n- Momentum density: $m_L = \\rho_L u_L = (1)(2) = 2$.\n- Total energy density: $E_L = \\frac{p_L}{\\gamma - 1} + \\frac{1}{2}\\rho_L u_L^2 = \\frac{1}{\\frac{2}{3}} + \\frac{1}{2}(1)(2^2) = \\frac{3}{2} + 2 = \\frac{7}{2}$.\nThus, the left-state conserved vector is $U_L = (1, 2, \\frac{7}{2})$.\n\nFor the right state, $U_R$, with $(\\rho_R, u_R, p_R) = (0.5, -1, 0.5) = (\\frac{1}{2}, -1, \\frac{1}{2})$:\n- Mass density: $\\rho_R = \\frac{1}{2}$.\n- Momentum density: $m_R = \\rho_R u_R = (\\frac{1}{2})(-1) = -\\frac{1}{2}$.\n- Total energy density: $E_R = \\frac{p_R}{\\gamma-1} + \\frac{1}{2}\\rho_R u_R^2 = \\frac{\\frac{1}{2}}{\\frac{2}{3}} + \\frac{1}{2}(\\frac{1}{2})(-1)^2 = \\frac{3}{4} + \\frac{1}{4} = 1$.\nThus, the right-state conserved vector is $U_R = (\\frac{1}{2}, -\\frac{1}{2}, 1)$.\n\n**2. Calculate the Physical Fluxes**\nThe physical flux vector is $F(U) = (\\rho u, \\rho u^2+p, u(E+p))$.\n\nFor the left state, $F(U_L)$:\n- Mass flux: $\\rho_L u_L = 2$.\n- Momentum flux: $\\rho_L u_L^2 + p_L = (1)(2^2) + 1 = 5$.\n- Energy flux: $u_L (E_L + p_L) = 2(\\frac{7}{2} + 1) = 2(\\frac{9}{2}) = 9$.\nThus, the left-state flux vector is $F(U_L) = (2, 5, 9)$.\n\nFor the right state, $F(U_R)$:\n- Mass flux: $\\rho_R u_R = -\\frac{1}{2}$.\n- Momentum flux: $\\rho_R u_R^2 + p_R = (\\frac{1}{2})(-1)^2 + \\frac{1}{2} = \\frac{1}{2} + \\frac{1}{2} = 1$.\n- Energy flux: $u_R(E_R + p_R) = (-1)(1 + \\frac{1}{2}) = -\\frac{3}{2}$.\nThus, the right-state flux vector is $F(U_R) = (-\\frac{1}{2}, 1, -\\frac{3}{2})$.\n\n**3. Calculate the Maximum Signal Speed**\nThe characteristic speeds (eigenvalues) of the 1D Euler equations are $u-a$, $u$, and $u+a$. The maximum signal speed for the Rusanov flux is typically taken as $S_{\\text{max}} = \\max(|u_L| + a_L, |u_R| + a_R)$. The sound speed $a$ is given by $a = \\sqrt{\\frac{\\gamma p}{\\rho}}$.\n\nFor the left state:\n- $a_L = \\sqrt{\\frac{\\gamma p_L}{\\rho_L}} = \\sqrt{\\frac{(\\frac{5}{3})(1)}{1}} = \\sqrt{\\frac{5}{3}}$.\n- $|u_L| + a_L = |2| + \\sqrt{\\frac{5}{3}} = 2 + \\sqrt{\\frac{5}{3}}$.\n\nFor the right state:\n- $a_R = \\sqrt{\\frac{\\gamma p_R}{\\rho_R}} = \\sqrt{\\frac{(\\frac{5}{3})(\\frac{1}{2})}{\\frac{1}{2}}} = \\sqrt{\\frac{5}{3}}$.\n- $|u_R| + a_R = |-1| + \\sqrt{\\frac{5}{3}} = 1 + \\sqrt{\\frac{5}{3}}$.\n\nComparing the two, we find the maximum signal speed:\n$$S_{\\text{max}} = \\max\\left(2 + \\sqrt{\\frac{5}{3}}, 1 + \\sqrt{\\frac{5}{3}}\\right) = 2 + \\sqrt{\\frac{5}{3}} = 2 + \\frac{\\sqrt{15}}{3}$$\n\n**4. Assemble the Rusanov Flux**\nWe now combine the components into the Rusanov flux formula.\n\nFirst, compute the average flux term:\n$$\\frac{1}{2}[F(U_L) + F(U_R)] = \\frac{1}{2}\\left( (2, 5, 9) + (-\\frac{1}{2}, 1, -\\frac{3}{2}) \\right) = \\frac{1}{2}\\left(\\frac{3}{2}, 6, \\frac{15}{2}\\right) = \\left(\\frac{3}{4}, 3, \\frac{15}{4}\\right)$$\n\nNext, compute the dissipation term, $-\\frac{1}{2} S_{\\text{max}} [U_R - U_L]$.\nThe difference in conserved states is:\n$$U_R - U_L = \\left(\\frac{1}{2}, -\\frac{1}{2}, 1\\right) - \\left(1, 2, \\frac{7}{2}\\right) = \\left(-\\frac{1}{2}, -\\frac{5}{2}, -\\frac{5}{2}\\right)$$\nThe dissipation coefficient is:\n$$\\frac{1}{2} S_{\\text{max}} = \\frac{1}{2}\\left(2 + \\frac{\\sqrt{15}}{3}\\right) = 1 + \\frac{\\sqrt{15}}{6}$$\nThe dissipation vector is:\n$$-\\frac{1}{2} S_{\\text{max}} [U_R - U_L] = -\\left(1 + \\frac{\\sqrt{15}}{6}\\right)\\left(-\\frac{1}{2}, -\\frac{5}{2}, -\\frac{5}{2}\\right) = \\left(\\frac{1}{2}\\left(1 + \\frac{\\sqrt{15}}{6}\\right), \\frac{5}{2}\\left(1 + \\frac{\\sqrt{15}}{6}\\right), \\frac{5}{2}\\left(1 + \\frac{\\sqrt{15}}{6}\\right)\\right)$$\n$$= \\left(\\frac{1}{2} + \\frac{\\sqrt{15}}{12}, \\frac{5}{2} + \\frac{5\\sqrt{15}}{12}, \\frac{5}{2} + \\frac{5\\sqrt{15}}{12}\\right)$$\n\nFinally, add the average flux and the dissipation vector to obtain $F^*$:\n- Mass flux $F_1^*$:\n$$F_1^* = \\frac{3}{4} + \\left(\\frac{1}{2} + \\frac{\\sqrt{15}}{12}\\right) = \\frac{3}{4} + \\frac{2}{4} + \\frac{\\sqrt{15}}{12} = \\frac{5}{4} + \\frac{\\sqrt{15}}{12} = \\frac{15}{12} + \\frac{\\sqrt{15}}{12} = \\frac{15 + \\sqrt{15}}{12}$$\n- Momentum flux $F_2^*$:\n$$F_2^* = 3 + \\left(\\frac{5}{2} + \\frac{5\\sqrt{15}}{12}\\right) = \\frac{6}{2} + \\frac{5}{2} + \\frac{5\\sqrt{15}}{12} = \\frac{11}{2} + \\frac{5\\sqrt{15}}{12} = \\frac{66}{12} + \\frac{5\\sqrt{15}}{12} = \\frac{66 + 5\\sqrt{15}}{12}$$\n- Energy flux $F_3^*$:\n$$F_3^* = \\frac{15}{4} + \\left(\\frac{5}{2} + \\frac{5\\sqrt{15}}{12}\\right) = \\frac{15}{4} + \\frac{10}{4} + \\frac{5\\sqrt{15}}{12} = \\frac{25}{4} + \\frac{5\\sqrt{15}}{12} = \\frac{75}{12} + \\frac{5\\sqrt{15}}{12} = \\frac{75 + 5\\sqrt{15}}{12}$$\n\nThe resulting numerical flux vector is $F^* = \\left(\\frac{15 + \\sqrt{15}}{12}, \\frac{66 + 5\\sqrt{15}}{12}, \\frac{75 + 5\\sqrt{15}}{12}\\right)$.",
            "answer": "$$ \\boxed{ \\begin{pmatrix} \\frac{15 + \\sqrt{15}}{12} & \\frac{66 + 5\\sqrt{15}}{12} & \\frac{75 + 5\\sqrt{15}}{12} \\end{pmatrix} } $$"
        },
        {
            "introduction": "While robust, simple solvers like Rusanov can be overly dissipative. More sophisticated solvers, such as Roe and HLLC, aim to capture more of the detailed wave structure within a Riemann fan. A pure shear wave, which is a type of contact discontinuity, serves as a crucial test case for evaluating a solver's ability to handle non-compressive features. This problem  challenges you to apply both the Roe and HLLC solvers to this specific scenario, providing deep insight into how their different designs correctly identify and preserve stationary contact waves with minimal numerical error.",
            "id": "3504072",
            "problem": "Consider the two-dimensional compressible Euler equations for an ideal gas with specific heat ratio $\\gamma$, written in conservation form with state vector $U = (\\rho, \\rho u, \\rho v, E)^{\\mathsf{T}}$ and flux in the $x$-direction $F(U) = (\\rho u, \\rho u^{2} + p, \\rho u v, u (E + p))^{\\mathsf{T}}$, where $p$ is the thermodynamic pressure, $\\rho$ is the mass density, $(u,v)$ are the velocity components in the $(x,y)$ directions, and $E$ is the total energy density. The equation of state is $p = (\\gamma - 1)\\left(E - \\tfrac{1}{2}\\rho(u^{2} + v^{2})\\right)$. All quantities are non-dimensional.\n\nA planar material interface coincides with the plane $x=0$ at time $t=0$ and separates two uniform states. The initial data are a pure shear layer in which the normal velocity and thermodynamic variables are continuous but the tangential velocity has a jump. The left state is\n$$(\\rho_{L}, u_{L}, v_{L}, p_{L}) = (1, 0, 1, 1),$$\nand the right state is\n$$(\\rho_{R}, u_{R}, v_{R}, p_{R}) = (1, 0, -1, 1).$$\nAssume $\\gamma = 1.4$.\n\nStarting from the conservation laws and the Rankine–Hugoniot jump conditions, and using only standard properties of the Euler system (such as its characteristic structure and the definition of the sound speed $a = \\sqrt{\\gamma p/\\rho}$), determine the interfacial numerical flux in the $x$-direction at $x/t=0$ predicted by:\n- Roe’s approximate Riemann solver, and\n- the Harten–Lax–van Leer–Contact (HLLC) approximate Riemann solver.\n\nIn each case, explicitly justify the predicted interfacial normal mass flux and tangential momentum flux in terms of the above data and the relevant wave structure. Then compute the scalar quantity\n$$\\Delta F_{y} \\equiv (F_{y})_{\\mathrm{Roe}} - (F_{y})_{\\mathrm{HLLC}},$$\nwhere $F_{y}$ denotes the $y$-momentum component of the $x$-flux, i.e., $F_{y} = \\rho u v$. Express your final answer for $\\Delta F_{y}$ as a single real number (unitless). No rounding is required.",
            "solution": "The problem requires the calculation of the interfacial numerical flux in the $x$-direction for a pure shear layer using two different approximate Riemann solvers: Roe's solver and the Harten–Lax–van Leer–Contact (HLLC) solver. The final goal is to compute the difference in the $y$-momentum component of this flux between the two solvers.\n\nFirst, we establish the initial states and related quantities. The primitive variables for the left (L) and right (R) states are given as:\n$$(\\rho_{L}, u_{L}, v_{L}, p_{L}) = (1, 0, 1, 1)$$\n$$(\\rho_{R}, u_{R}, v_{R}, p_{R}) = (1, 0, -1, 1)$$\nThe specific heat ratio is $\\gamma = 1.4$.\n\nThe total energy density $E$ is given by the equation of state: $E = \\frac{p}{\\gamma - 1} + \\frac{1}{2}\\rho(u^{2} + v^{2})$.\nFor the left state:\n$$E_{L} = \\frac{p_{L}}{\\gamma - 1} + \\frac{1}{2}\\rho_{L}(u_{L}^{2} + v_{L}^{2}) = \\frac{1}{1.4 - 1} + \\frac{1}{2}(1)(0^{2} + 1^{2}) = 2.5 + 0.5 = 3$$\nFor the right state:\n$$E_{R} = \\frac{p_{R}}{\\gamma - 1} + \\frac{1}{2}\\rho_{R}(u_{R}^{2} + v_{R}^{2}) = \\frac{1}{1.4 - 1} + \\frac{1}{2}(1)(0^{2} + (-1)^{2}) = 2.5 + 0.5 = 3$$\nThe conserved state vectors $U = (\\rho, \\rho u, \\rho v, E)^{\\mathsf{T}}$ are:\n$$U_{L} = (1, 0, 1, 3)^{\\mathsf{T}}$$\n$$U_{R} = (1, 0, -1, 3)^{\\mathsf{T}}$$\n\nThe flux vector in the $x$-direction is $F(U) = (\\rho u, \\rho u^{2} + p, \\rho u v, u(E+p))^{\\mathsf{T}}$.\nFor the left state, since $u_{L}=0$:\n$$F(U_{L}) = (0, 0^{2} + 1, 0, 0)^{\\mathsf{T}} = (0, 1, 0, 0)^{\\mathsf{T}}$$\nFor the right state, since $u_{R}=0$:\n$$F(U_{R}) = (0, 0^{2} + 1, 0, 0)^{\\mathsf{T}} = (0, 1, 0, 0)^{\\mathsf{T}}$$\nWe note that $F(U_{L}) = F(U_{R})$. The quantity of interest is the $y$-momentum component of the $x$-flux, denoted $F_{y} = \\rho u v$, which is the third component of the flux vector $F$.\n\n### Roe's Approximate Riemann Solver\n\nThe numerical flux for Roe's solver is given by:\n$$F_{\\mathrm{Roe}} = \\frac{1}{2}(F(U_{L}) + F(U_{R})) - \\frac{1}{2}\\sum_{k=1}^{4} |\\tilde{\\lambda}_{k}| \\tilde{\\alpha}_{k} \\tilde{e}_{k}$$\nwhere $\\tilde{\\lambda}_{k}$, $\\tilde{\\alpha}_{k}$, and $\\tilde{e}_{k}$ are the eigenvalues, wave strengths, and right eigenvectors of the Roe matrix $\\tilde{A}$, which linearizes the system such that $F(U_{R}) - F(U_{L}) = \\tilde{A}(U_{R} - U_{L})$.\n\nThe Roe-averaged state is computed as follows:\n$\\tilde{\\rho} = \\sqrt{\\rho_{L}\\rho_{R}} = \\sqrt{1 \\cdot 1} = 1$.\n$\\tilde{u} = \\frac{\\sqrt{\\rho_{L}}u_{L} + \\sqrt{\\rho_{R}}u_{R}}{\\sqrt{\\rho_{L}} + \\sqrt{\\rho_{R}}} = \\frac{1 \\cdot 0 + 1 \\cdot 0}{1 + 1} = 0$.\n$\\tilde{v} = \\frac{\\sqrt{\\rho_{L}}v_{L} + \\sqrt{\\rho_{R}}v_{R}}{\\sqrt{\\rho_{L}} + \\sqrt{\\rho_{R}}} = \\frac{1 \\cdot 1 + 1 \\cdot (-1)}{1 + 1} = 0$.\nThe specific enthalpy is $h=(E+p)/\\rho$. $h_{L} = (3+1)/1 = 4$, $h_{R} = (3+1)/1 = 4$.\n$\\tilde{h} = \\frac{\\sqrt{\\rho_{L}}h_{L} + \\sqrt{\\rho_{R}}h_{R}}{\\sqrt{\\rho_{L}} + \\sqrt{\\rho_{R}}} = \\frac{1 \\cdot 4 + 1 \\cdot 4}{1 + 1} = 4$.\nThe Roe-averaged sound speed $\\tilde{a}$ is given by $\\tilde{a}^{2} = (\\gamma-1)(\\tilde{h} - \\frac{1}{2}(\\tilde{u}^{2} + \\tilde{v}^{2})) = (1.4-1)(4 - 0) = 1.6$.\n\nThe eigenvalues of the Roe matrix are $\\tilde{\\lambda}_{1,4} = \\tilde{u} \\mp \\tilde{a} = \\mp\\sqrt{1.6}$ and $\\tilde{\\lambda}_{2,3} = \\tilde{u} = 0$.\nThe jump in the state vector is $\\Delta U = U_{R} - U_{L} = (0, 0, -2, 0)^{\\mathsf{T}}$.\nThis jump must be projected onto the eigenvectors of the Roe matrix. For the averaged state with $\\tilde{u}=0, \\tilde{v}=0$, the eigenvectors associated with the eigenvalue $\\tilde{\\lambda}=\\tilde{u}=0$ are one for the entropy wave and one for the shear wave. The jump $\\Delta U$ corresponds to a change only in tangential momentum $(\\rho v)$, so it projects entirely onto the shear wave eigenvector. The jump can be written as $\\Delta U = \\tilde{\\alpha}_{\\text{shear}} \\tilde{e}_{\\text{shear}}$, where $\\tilde{e}_{\\text{shear}} \\propto (0,0,1,0)^{\\mathsf{T}}$ and its strength $\\tilde{\\alpha}_{\\text{shear}} = -2$. The strengths of the acoustic and entropy waves are zero.\n\nThe dissipation term in the Roe flux is a sum over all waves. The only wave with non-zero strength is the shear wave, which has an associated eigenvalue $\\tilde{\\lambda}_{\\text{shear}} = \\tilde{u} = 0$.\nThe contribution from this wave to the dissipation sum is:\n$$-\\frac{1}{2} |\\tilde{\\lambda}_{\\text{shear}}| \\tilde{\\alpha}_{\\text{shear}} \\tilde{e}_{\\text{shear}} = -\\frac{1}{2} |0| (-2) (0,0,1,0)^{\\mathsf{T}} = (0,0,0,0)^{\\mathsf{T}}$$\nThus, the Roe flux is simply the arithmetic average of the left and right fluxes:\n$$F_{\\mathrm{Roe}} = \\frac{1}{2}(F(U_{L}) + F(U_{R})) = \\frac{1}{2}((0,1,0,0)^{\\mathsf{T}} + (0,1,0,0)^{\\mathsf{T}}) = (0,1,0,0)^{\\mathsf{T}}$$\nThe $y$-momentum component of this flux is the third component:\n$$(F_{y})_{\\mathrm{Roe}} = 0$$\n\nJustification: The interfacial normal mass flux, $(\\rho u)_{\\mathrm{Roe}}$, is the first component, which is $0$. The tangential momentum flux, $(\\rho u v)_{\\mathrm{Roe}}$, is the third component, which is $0$. This is because the Roe solver identifies the problem as a single, stationary contact discontinuity. For such a wave, the associated eigenvalue $\\tilde{\\lambda}$ is zero, resulting in zero numerical dissipation. The flux is then just the average of the initial fluxes, both of which have zero for these components because the initial normal velocity is zero.\n\n### HLLC Approximate Riemann Solver\n\nThe HLLC solver models the Riemann problem with three waves: a left-going wave with speed $S_{L}$, a right-going wave with speed $S_{R}$, and a contact wave with speed $S_{*}$. The interfacial flux at $x/t=0$ depends on the position of the interface relative to these waves.\n\nFirst, we estimate the wave speeds. Using Roe-averaged speeds is a common choice:\n$$S_{L} = \\tilde{u} - \\tilde{a} = 0 - \\sqrt{1.6} = -\\sqrt{1.6}$$\n$$S_{R} = \\tilde{u} + \\tilde{a} = 0 + \\sqrt{1.6} = \\sqrt{1.6}$$\nThe contact wave speed $S_{*}$ is given by:\n$$S_{*} = \\frac{p_{R} - p_{L} + \\rho_{L}u_{L}(S_{L}-u_{L}) - \\rho_{R}u_{R}(S_{R}-u_{R})}{\\rho_{L}(S_{L}-u_{L}) - \\rho_{R}(S_{R}-u_{R})}$$\nSubstituting the given values ($p_{L}=p_{R}=1, \\rho_{L}=\\rho_{R}=1, u_{L}=u_{R}=0$):\n$$S_{*} = \\frac{1-1 + 1 \\cdot 0(S_{L}-0) - 1 \\cdot 0(S_{R}-0)}{1(S_{L}-0) - 1(S_{R}-0)} = \\frac{0}{S_{L}-S_{R}} = 0$$\nSince $S_{L} < 0$, $S_{*} = 0$, and $S_{R} > 0$, the interface at $x/t=0$ coincides with the contact wave. The HLLC flux is thus given by the \"star\" flux, $F^{*} = F_{L}^{*} = F_{R}^{*}$.\n\nThe state vector in the star region, $U_{L}^{*}$, can be determined from the Rankine-Hugoniot conditions across the wave with speed $S_L$: $F(U_{L}^{*}) - F(U_{L}) = S_{L}(U_{L}^{*} - U_{L})$. A key finding for this problem is that the star state $U_{L}^{*}$ is identical to the initial left state $U_{L}$. This can be shown by analyzing the jump conditions for each component with $u_L=0$ and $S_*=0$:\n1. Mass: $\\rho_L^* S_* - \\rho_L u_L = S_L(\\rho_L^* - \\rho_L) \\implies 0 - 0 = S_L(\\rho_L^* - \\rho_L) \\implies \\rho_L^* = \\rho_L = 1$.\n2. $x$-momentum: $\\rho_L^* S_*^2 + p^* - (\\rho_L u_L^2 + p_L) = S_L(\\rho_L^* S_* - \\rho_L u_L) \\implies p^* - p_L = 0 \\implies p^* = p_L=1$.\n3. $y$-momentum: $\\rho_L^* S_* v_L^* - \\rho_L u_L v_L = S_L(\\rho_L^* v_L^* - \\rho_L v_L) \\implies 0 - 0 = S_L(\\rho_L^* v_L^* - \\rho_L v_L) \\implies \\rho_L^* v_L^* = \\rho_L v_L \\implies v_L^*=v_L=1$.\n4. Energy: $S_*(E_L^*+p^*) - u_L(E_L+p_L) = S_L(E_L^*-E_L) \\implies 0-0 = S_L(E_L^*-E_L) \\implies E_L^* = E_L = 3$.\nSince all conserved variables are identical, $U_{L}^{*} = U_{L}$.\nThe star flux $F_{L}^{*}$ is given by the jump condition itself:\n$$F(U_{L}^{*}) - F(U_{L}) = S_{L}(U_{L}^{*} - U_{L})$$\nThis flux represents the flux into the star region. The standard HLLC numerical flux is however defined as $F^*$. In Toro's formalism, this is $F_{L}^{*} = F(U_{L}) + S_{L}(U_{L}^{*} - U_{L})$.\nSince we found $U_L^* = U_L$, the correction term is zero:\n$$F_{L}^{*} = F(U_{L}) + S_{L}(U_{L} - U_{L}) = F(U_{L}) = (0,1,0,0)^{\\mathsf{T}}$$\nSimilarly, we would find $U_{R}^{*} = U_{R}$ and thus $F_{R}^{*} = F(U_{R})$. Since $F(U_L) = F(U_R)$, the condition $F_L^*=F_R^*$ is satisfied.\nThe HLLC flux at the interface is therefore:\n$$F_{\\mathrm{HLLC}} = F^{*} = (0,1,0,0)^{\\mathsf{T}}$$\nThe $y$-momentum component of this flux is the third component:\n$$(F_{y})_{\\mathrm{HLLC}} = 0$$\n\nJustification: The normal mass flux, $(\\rho u)_{\\mathrm{HLLC}}$, is $0$, and the tangential momentum flux, $(\\rho u v)_{\\mathrm{HLLC}}$, is $0$. The HLLC solver correctly identifies the contact wave as stationary ($S_*=0$). The star region has normal velocity $u^*=S_*=0$. Consequently, any flux component containing a factor of $u$ (such as $\\rho u$ and $\\rho u v$) is zero in the star region flux calculation, which defines the interfacial flux.\n\n### Final Calculation\n\nThe problem asks for the scalar quantity $\\Delta F_{y}$:\n$$\\Delta F_{y} \\equiv (F_{y})_{\\mathrm{Roe}} - (F_{y})_{\\mathrm{HLLC}}$$\nUsing the results from the analyses above:\n$$\\Delta F_{y} = 0 - 0 = 0$$",
            "answer": "$$\\boxed{0}$$"
        }
    ]
}