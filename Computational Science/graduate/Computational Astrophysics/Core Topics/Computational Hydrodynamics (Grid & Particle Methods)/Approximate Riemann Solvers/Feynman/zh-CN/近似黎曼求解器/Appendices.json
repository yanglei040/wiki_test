{
    "hands_on_practices": [
        {
            "introduction": "在我们求解黎曼问题之前，必须首先理解信息在流体中是如何传播的。这一过程由特征波速决定，它们是系统雅可比矩阵的特征值。本练习  将通过一个经典的激波管问题，训练推导和计算这些基本速度，它们是估算时间步长（CFL条件）和构建任何黎曼求解器的基础。",
            "id": "3504120",
            "problem": "考虑一个无粘性、可压缩理想气体的一维欧拉方程，\n$$\n\\partial_t U + \\partial_x F(U) = 0,\n$$\n其中守恒变量为 $U = (\\rho, \\rho u, E)^{\\top}$，通量为 $F(U) = (\\rho u, \\rho u^{2} + p, u(E + p))^{\\top}$，并通过理想气体状态方程 $p = (\\gamma - 1)\\left(E - \\tfrac{1}{2}\\rho u^{2}\\right)$ 进行封闭。该系统是双曲型的，围绕常数状态的小扰动会沿着特征场传播。根据该双曲型结构和理想气体的热力学，推导出一维欧拉系统的特征波速，用原始变量 $(\\rho, u, p)$ 和绝热指数 $\\gamma$ 表示，然后计算左、右初始状态下这些波速的值：\n$$\nU_L = (\\rho_L, u_L, p_L) = (1.0, 0.0, 1.0), \\quad U_R = (\\rho_R, u_R, p_R) = (0.125, 0.0, 0.1),\n$$\n其中 $\\gamma = 1.4$。使用这些结果，确定在时间 $t=0$ 时适用于 Courant–Friedrichs–Lewy (CFL) 时间步长估计的最大信号速度。该速度定义为初始存在于域中的所有特征速度的最大绝对值。使用与给定状态一致的无量纲单位进行计算。将所有数值四舍五入到六位有效数字。最终答案必须按顺序列出左状态的三个特征速度、右状态的三个特征速度以及最大信号速度，并以单行矩阵的形式给出。在最终的方框答案中不应报告任何物理单位。",
            "solution": "该问题是适定的，有科学依据，并包含了获得唯一解所需的所有信息。无粘性理想气体的一维欧拉方程是流体动力学中的一个标准模型。任务包括从基本方程组推导特征波速，然后将此结果应用于给定的初始条件。因此，该问题是有效的。\n\n一维欧拉方程以守恒律形式给出：\n$$\n\\partial_t U + \\partial_x F(U) = 0\n$$\n其中 $U = (\\rho, \\rho u, E)^{\\top}$ 是守恒变量（密度、动量、总能量）的向量，$F(U) = (\\rho u, \\rho u^2 + p, u(E+p))^{\\top}$ 是通量向量。该系统通过理想气体状态方程 $p = (\\gamma-1)(E - \\frac{1}{2}\\rho u^2)$ 封闭。\n\n这个双曲系统的特征速度是雅可比矩阵 $A(U) = \\frac{\\partial F}{\\partial U}$ 的特征值。为了找到这些特征值，更方便的做法是首先用原始变量 $W = (\\rho, u, p)^{\\top}$ 来表示欧拉方程。得到的拟线性系统是 $\\partial_t W + \\tilde{A}(W) \\partial_x W = 0$，其中矩阵 $\\tilde{A}(W)$ 与 $A(U)$ 具有相同的特征值。\n\n欧拉方程的原始形式推导如下：\n1.  **连续性方程**：\n    从 $\\partial_t \\rho + \\partial_x(\\rho u) = 0$ 开始，我们应用乘法法则：\n    $$\n    \\partial_t \\rho + u \\partial_x \\rho + \\rho \\partial_x u = 0\n    $$\n\n2.  **动量方程**：\n    动量守恒方程 $\\partial_t(\\rho u) + \\partial_x(\\rho u^2 + p) = 0$ 的原始变量形式为：\n    $$\n    \\partial_t u + u \\partial_x u + \\frac{1}{\\rho}\\partial_x p = 0\n    $$\n\n3.  **能量方程**：\n    对于经历绝热过程的理想气体，量 $p/\\rho^\\gamma$ 沿着流体流线是守恒的。这导出了方程：\n    $$\n    \\partial_t p + u \\partial_x p + \\gamma p \\partial_x u = 0\n    $$\n\n这三个方程可以写成矩阵形式：\n$$\n\\frac{\\partial}{\\partial t}\n\\begin{pmatrix}\n\\rho \\\\ u \\\\ p\n\\end{pmatrix}\n+\n\\begin{pmatrix}\nu  \\rho  0 \\\\\n0  u  1/\\rho \\\\\n0  \\gamma p  u\n\\end{pmatrix}\n\\frac{\\partial}{\\partial x}\n\\begin{pmatrix}\n\\rho \\\\ u \\\\ p\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0 \\\\ 0 \\\\ 0\n\\end{pmatrix}\n$$\n特征波速 $\\lambda$ 是矩阵 $\\tilde{A}(W)$ 的特征值：\n$$\n\\tilde{A}(W) = \\begin{pmatrix}\nu  \\rho  0 \\\\\n0  u  1/\\rho \\\\\n0  \\gamma p  u\n\\end{pmatrix}\n$$\n我们求解特征方程 $\\det(\\tilde{A} - \\lambda I) = 0$：\n$$\n\\det \\begin{pmatrix}\nu - \\lambda  \\rho  0 \\\\\n0  u - \\lambda  1/\\rho \\\\\n0  \\gamma p  u - \\lambda\n\\end{pmatrix} = (u - \\lambda) \\left[ (u - \\lambda)^2 - (\\gamma p)(1/\\rho) \\right] = 0\n$$\n该方程产生三个特征值：\n$$\n\\lambda_1 = u, \\quad (u - \\lambda)^2 = \\frac{\\gamma p}{\\rho}\n$$\n第二部分给出 $u - \\lambda = \\pm \\sqrt{\\frac{\\gamma p}{\\rho}}$。\n项 $c = \\sqrt{\\frac{\\gamma p}{\\rho}}$ 是绝热声速。\n因此，三个特征波速为：\n$$\n\\lambda_1 = u - c, \\quad \\lambda_2 = u, \\quad \\lambda_3 = u + c\n$$\n\n现在，我们针对给定的左 ($L$) 和右 ($R$) 初始状态，在 $\\gamma = 1.4$ 的条件下计算这些速度。\n\n**对于左状态：** $U_L \\implies (\\rho_L, u_L, p_L) = (1.0, 0.0, 1.0)$。\n左状态的声速为：\n$$\nc_L = \\sqrt{\\frac{\\gamma p_L}{\\rho_L}} = \\sqrt{\\frac{(1.4)(1.0)}{1.0}} = \\sqrt{1.4} \\approx 1.1832159566\n$$\n四舍五入到六位有效数字，$c_L \\approx 1.18322$。\n左状态的特征速度为：\n$$\n\\lambda_{1,L} = u_L - c_L = 0.0 - 1.18322 = -1.18322\n$$\n$$\n\\lambda_{2,L} = u_L = 0.0\n$$\n$$\n\\lambda_{3,L} = u_L + c_L = 0.0 + 1.18322 = 1.18322\n$$\n\n**对于右状态：** $U_R \\implies (\\rho_R, u_R, p_R) = (0.125, 0.0, 0.1)$。\n右状态的声速为：\n$$\nc_R = \\sqrt{\\frac{\\gamma p_R}{\\rho_R}} = \\sqrt{\\frac{(1.4)(0.1)}{0.125}} = \\sqrt{\\frac{0.14}{0.125}} = \\sqrt{1.12} \\approx 1.0583005244\n$$\n四舍五入到六位有效数字，$c_R \\approx 1.05830$。\n右状态的特征速度为：\n$$\n\\lambda_{1,R} = u_R - c_R = 0.0 - 1.05830 = -1.05830\n$$\n$$\n\\lambda_{2,R} = u_R = 0.0\n$$\n$$\n\\lambda_{3,R} = u_R + c_R = 0.0 + 1.05830 = 1.05830\n$$\n\n**最大信号速度：**\n用于 CFL 条件的最大信号速度 $S_{\\text{max}}$ 是初始存在的所有特征速度中的最大绝对值。\n$$\nS_{\\text{max}} = \\max(|\\lambda_{1,L}|, |\\lambda_{2,L}|, |\\lambda_{3,L}|, |\\lambda_{1,R}|, |\\lambda_{2,R}|, |\\lambda_{3,R}|)\n$$\n绝对值的集合是 $\\{|-1.18322|, |0.0|, |1.18322|, |-1.05830|, |0.0|, |1.05830|\\}$，即 $\\{1.18322, 0.0, 1.05830\\}$。\n这些值的最大值为：\n$$\nS_{\\text{max}} = 1.18322\n$$\n这对应于最快波的幅度，即进入左状态静止流体中的声波。\n\n最终答案要求一个行矩阵，包含左状态的三个速度、右状态的三个速度以及最大信号速度，所有值都四舍五入到六位有效数字。\n这些值为：\n-   左侧速度：$-1.18322, 0.0, 1.18322$\n-   右侧速度：$-1.05830, 0.0, 1.05830$\n-   最大信号速度：$1.18322$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -1.18322  0.0  1.18322  -1.05830  0.0  1.05830  1.18322 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "Rusanov（或局部Lax-Friedrichs）方法是最直接的近似黎曼求解器之一。它的工作原理是对左右两边的物理通量进行平均，并基于局部最大信号速度添加一个强的数值耗散项。本练习  演示了从零开始构建数值通量的完整过程，加深了对物理通量与数值耗散之间相互作用的理解。",
            "id": "3504119",
            "problem": "考虑守恒形式的一维理想气体欧拉方程，其状态向量为 $U = (\\rho, m, E)$，其中 $\\rho$ 是质量密度，$m = \\rho u$ 是动量密度，$E$ 是总能量密度。对应的通量函数为 $F(U) = (\\rho u, \\rho u^{2} + p, u(E + p))$，其中 $p$ 是气体压力，$u$ 是流体速度。理想气体的状态方程为 $p = (\\gamma - 1)\\left(E - \\frac{1}{2}\\rho u^{2}\\right)$，绝热声速为 $a = \\sqrt{\\frac{\\gamma p}{\\rho}}$。在 Rusanov（局部 Lax–Friedrichs）近似黎曼求解器中，界面上的数值通量是通过对左右状态的物理通量进行平均，并加上与最大特征速度成正比的耗散项来构造的。\n\n你正在模拟一个绝热指数为 $\\gamma = \\frac{5}{3}$ 的可压缩天体物理流。在一个单元界面处，左、右原始状态（密度、速度、压力）由 $U_{L} = (\\rho_{L}, u_{L}, p_{L}) = (1, 2, 1)$ 和 $U_{R} = (\\rho_{R}, u_{R}, p_{R}) = \\left(0.5, -1, 0.5\\right)$ 给出。将这些元组视为原始变量，并在必要时将其转换为守恒形式。使用 Rusanov 近似黎曼求解器的标准定义，计算界面处的数值通量，并报告通量向量的三个分量（质量通量、动量通量和能量通量）。将你的最终答案表示为包含这三个分量的单行向量。以精确解析形式提供结果，不要四舍五入。不需要单位。",
            "solution": "用户提供了一个来自计算天体物理学的问题，涉及使用 Rusanov 近似黎曼求解器计算数值通量。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n- **系统：** 守恒形式的一维欧拉方程。\n- **状态向量：** $U = (\\rho, m, E)$，其中 $\\rho$ 是质量密度，$m = \\rho u$ 是动量密度，$E$ 是总能量密度。\n- **通量函数：** $F(U) = (\\rho u, \\rho u^{2} + p, u(E + p))$，其中 $u$ 是速度，$p$ 是压力。\n- **状态方程（理想气体）：** $p = (\\gamma - 1)\\left(E - \\frac{1}{2}\\rho u^{2}\\right)$。\n- **绝热声速：** $a = \\sqrt{\\frac{\\gamma p}{\\rho}}$。\n- **数值方法：** Rusanov（局部 Lax–Friedrichs）近似黎曼求解器。数值通量 $F^*$ 定义为 $F^* = \\frac{1}{2}[F(U_L) + F(U_R)] - \\frac{1}{2}S_{\\text{max}}[U_R - U_L]$，其中 $S_{\\text{max}}$ 是最大特征速度。\n- **绝热指数：** $\\gamma = \\frac{5}{3}$。\n- **左侧原始状态：** $(\\rho_{L}, u_{L}, p_{L}) = (1, 2, 1)$。\n- **右侧原始状态：** $(\\rho_{R}, u_{R}, p_{R}) = (0.5, -1, 0.5)$。\n\n**步骤 2：使用提取的已知条件进行验证**\n- **科学依据：** 该问题基于气体动力学的欧拉方程、理想气体定律和 Rusanov 通量格式，这些都是计算流体动力学和计算天体物理学中标准、成熟的概念。这在科学上是合理的。\n- **适定性：** 该问题提供了所有必要信息：控制方程、状态方程、具体的数值格式、绝热指数以及初始的左右状态。这些输入足以计算出唯一、稳定且有意义的数值通量向量。\n- **客观性：** 问题陈述完全由清晰、精确、客观的数学和物理定义及数据构成。没有主观或含糊不清的术语。\n- **缺陷清单：**\n    1.  **科学上不合理：** 无。\n    2.  **非形式化/不相关：** 该问题是近似黎曼求解器主题下的一个形式化和典型的例子。\n    3.  **不完整/矛盾：** 所有必要数据均已提供且自洽。\n    4.  **不切实际/不可行：** 在归一化背景下，状态的数值在物理上是合理的。\n    5.  **不适定/结构不良：** 该问题是适定的。\n    6.  **琐碎/同义反复：** 计算虽然直接，但涉及多个非平凡的步骤，需要对基础物理和数值方法有扎实的理解。\n    7.  **外部可验证性：** 结果在数学上是可验证的。\n\n**步骤 3：结论与行动**\n该问题是**有效的**。将提供一个完整、合理的解答。\n\n### 解答\n\n在左状态 $U_L$ 和右状态 $U_R$ 之间的界面上，Rusanov 数值通量 $F^*$ 由以下公式给出：\n$$F^*(U_L, U_R) = \\frac{1}{2} [F(U_L) + F(U_R)] - \\frac{1}{2} S_{\\text{max}} [U_R - U_L]$$\n其中 $F(U)$ 是物理通量，$U$ 是守恒变量向量，$S_{\\text{max}}$ 是界面处的最大信号速度。计算分四个步骤进行。\n\n**1. 将原始变量转换为守恒变量**\n守恒变量向量为 $U = (\\rho, m, E) = (\\rho, \\rho u, E)$。总能量密度 $E$ 通过状态方程与原始变量相关联：\n$$E = \\frac{p}{\\gamma - 1} + \\frac{1}{2}\\rho u^{2}$$\n当 $\\gamma = \\frac{5}{3}$ 时，项 $\\gamma-1 = \\frac{2}{3}$。\n\n对于左状态 $U_L$，其中 $(\\rho_L, u_L, p_L) = (1, 2, 1)$：\n- 质量密度：$\\rho_L = 1$。\n- 动量密度：$m_L = \\rho_L u_L = (1)(2) = 2$。\n- 总能量密度：$E_L = \\frac{p_L}{\\gamma - 1} + \\frac{1}{2}\\rho_L u_L^2 = \\frac{1}{\\frac{2}{3}} + \\frac{1}{2}(1)(2^2) = \\frac{3}{2} + 2 = \\frac{7}{2}$。\n因此，左状态的守恒向量为 $U_L = (1, 2, \\frac{7}{2})$。\n\n对于右状态 $U_R$，其中 $(\\rho_R, u_R, p_R) = (0.5, -1, 0.5) = (\\frac{1}{2}, -1, \\frac{1}{2})$：\n- 质量密度：$\\rho_R = \\frac{1}{2}$。\n- 动量密度：$m_R = \\rho_R u_R = (\\frac{1}{2})(-1) = -\\frac{1}{2}$。\n- 总能量密度：$E_R = \\frac{p_R}{\\gamma-1} + \\frac{1}{2}\\rho_R u_R^2 = \\frac{\\frac{1}{2}}{\\frac{2}{3}} + \\frac{1}{2}(\\frac{1}{2})(-1)^2 = \\frac{3}{4} + \\frac{1}{4} = 1$。\n因此，右状态的守恒向量为 $U_R = (\\frac{1}{2}, -\\frac{1}{2}, 1)$。\n\n**2. 计算物理通量**\n物理通量向量为 $F(U) = (\\rho u, \\rho u^2+p, u(E+p))$。\n\n对于左状态 $F(U_L)$：\n- 质量通量：$\\rho_L u_L = 2$。\n- 动量通量：$\\rho_L u_L^2 + p_L = (1)(2^2) + 1 = 5$。\n- 能量通量：$u_L (E_L + p_L) = 2(\\frac{7}{2} + 1) = 2(\\frac{9}{2}) = 9$。\n因此，左状态的通量向量为 $F(U_L) = (2, 5, 9)$。\n\n对于右状态 $F(U_R)$：\n- 质量通量：$\\rho_R u_R = -\\frac{1}{2}$。\n- 动量通量：$\\rho_R u_R^2 + p_R = (\\frac{1}{2})(-1)^2 + \\frac{1}{2} = \\frac{1}{2} + \\frac{1}{2} = 1$。\n- 能量通量：$u_R(E_R + p_R) = (-1)(1 + \\frac{1}{2}) = -\\frac{3}{2}$。\n因此，右状态的通量向量为 $F(U_R) = (-\\frac{1}{2}, 1, -\\frac{3}{2})$。\n\n**3. 计算最大信号速度**\n一维欧拉方程的特征速度（特征值）为 $u-a$、$u$ 和 $u+a$。Rusanov 通量的最大信号速度通常取为 $S_{\\text{max}} = \\max(|u_L| + a_L, |u_R| + a_R)$。声速 $a$ 由 $a = \\sqrt{\\frac{\\gamma p}{\\rho}}$ 给出。\n\n对于左状态：\n- $a_L = \\sqrt{\\frac{\\gamma p_L}{\\rho_L}} = \\sqrt{\\frac{(\\frac{5}{3})(1)}{1}} = \\sqrt{\\frac{5}{3}}$。\n- $|u_L| + a_L = |2| + \\sqrt{\\frac{5}{3}} = 2 + \\sqrt{\\frac{5}{3}}$。\n\n对于右状态：\n- $a_R = \\sqrt{\\frac{\\gamma p_R}{\\rho_R}} = \\sqrt{\\frac{(\\frac{5}{3})(\\frac{1}{2})}{\\frac{1}{2}}} = \\sqrt{\\frac{5}{3}}$。\n- $|u_R| + a_R = |-1| + \\sqrt{\\frac{5}{3}} = 1 + \\sqrt{\\frac{5}{3}}$。\n\n比较两者，我们得到最大信号速度：\n$$S_{\\text{max}} = \\max\\left(2 + \\sqrt{\\frac{5}{3}}, 1 + \\sqrt{\\frac{5}{3}}\\right) = 2 + \\sqrt{\\frac{5}{3}} = 2 + \\frac{\\sqrt{15}}{3}$$\n\n**4. 组装 Rusanov 通量**\n我们现在将各分量组合到 Rusanov 通量公式中。\n\n首先，计算平均通量项：\n$$\\frac{1}{2}[F(U_L) + F(U_R)] = \\frac{1}{2}\\left( (2, 5, 9) + (-\\frac{1}{2}, 1, -\\frac{3}{2}) \\right) = \\frac{1}{2}\\left(\\frac{3}{2}, 6, \\frac{15}{2}\\right) = \\left(\\frac{3}{4}, 3, \\frac{15}{4}\\right)$$\n\n接下来，计算耗散项 $-\\frac{1}{2} S_{\\text{max}} [U_R - U_L]$。\n守恒状态的差为：\n$$U_R - U_L = \\left(\\frac{1}{2}, -\\frac{1}{2}, 1\\right) - \\left(1, 2, \\frac{7}{2}\\right) = \\left(-\\frac{1}{2}, -\\frac{5}{2}, -\\frac{5}{2}\\right)$$\n耗散系数为：\n$$\\frac{1}{2} S_{\\text{max}} = \\frac{1}{2}\\left(2 + \\frac{\\sqrt{15}}{3}\\right) = 1 + \\frac{\\sqrt{15}}{6}$$\n耗散向量为：\n$$-\\frac{1}{2} S_{\\text{max}} [U_R - U_L] = -\\left(1 + \\frac{\\sqrt{15}}{6}\\right)\\left(-\\frac{1}{2}, -\\frac{5}{2}, -\\frac{5}{2}\\right) = \\left(\\frac{1}{2}\\left(1 + \\frac{\\sqrt{15}}{6}\\right), \\frac{5}{2}\\left(1 + \\frac{\\sqrt{15}}{6}\\right), \\frac{5}{2}\\left(1 + \\frac{\\sqrt{15}}{6}\\right)\\right)$$\n$$= \\left(\\frac{1}{2} + \\frac{\\sqrt{15}}{12}, \\frac{5}{2} + \\frac{5\\sqrt{15}}{12}, \\frac{5}{2} + \\frac{5\\sqrt{15}}{12}\\right)$$\n\n最后，将平均通量和耗散向量相加得到 $F^*$：\n- 质量通量 $F_1^*$：\n$$F_1^* = \\frac{3}{4} + \\left(\\frac{1}{2} + \\frac{\\sqrt{15}}{12}\\right) = \\frac{3}{4} + \\frac{2}{4} + \\frac{\\sqrt{15}}{12} = \\frac{5}{4} + \\frac{\\sqrt{15}}{12} = \\frac{15}{12} + \\frac{\\sqrt{15}}{12} = \\frac{15 + \\sqrt{15}}{12}$$\n- 动量通量 $F_2^*$：\n$$F_2^* = 3 + \\left(\\frac{5}{2} + \\frac{5\\sqrt{15}}{12}\\right) = \\frac{6}{2} + \\frac{5}{2} + \\frac{5\\sqrt{15}}{12} = \\frac{11}{2} + \\frac{5\\sqrt{15}}{12} = \\frac{66}{12} + \\frac{5\\sqrt{15}}{12} = \\frac{66 + 5\\sqrt{15}}{12}$$\n- 能量通量 $F_3^*$：\n$$F_3^* = \\frac{15}{4} + \\left(\\frac{5}{2} + \\frac{5\\sqrt{15}}{12}\\right) = \\frac{15}{4} + \\frac{10}{4} + \\frac{5\\sqrt{15}}{12} = \\frac{25}{4} + \\frac{5\\sqrt{15}}{12} = \\frac{75}{12} + \\frac{5\\sqrt{15}}{12} = \\frac{75 + 5\\sqrt{15}}{12}$$\n\n最终的数值通量向量为 $F^* = \\left(\\frac{15 + \\sqrt{15}}{12}, \\frac{66 + 5\\sqrt{15}}{12}, \\frac{75 + 5\\sqrt{15}}{12}\\right)$。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} \\frac{15 + \\sqrt{15}}{12}  \\frac{66 + 5\\sqrt{15}}{12}  \\frac{75 + 5\\sqrt{15}}{12} \\end{pmatrix} } $$"
        },
        {
            "introduction": "尽管像Rusanov这样简单的求解器很稳健，但它们可能具有过度的耗散性，从而模糊掉重要的物理特征。本练习  探讨了一个关键的测试案例：纯剪切层。我们将看到，更复杂的求解器（如Roe和HLLC）是如何被专门设计来识别并以最小的误差保持这类接触间断的，这在模拟天体物理中的湍流和界面时至关重要。",
            "id": "3504072",
            "problem": "考虑理想气体的二维可压缩欧拉方程，其比热比为$\\gamma$，写成守恒形式，状态向量为$U = (\\rho, \\rho u, \\rho v, E)^{\\mathsf{T}}$，$x$方向的通量为$F(U) = (\\rho u, \\rho u^{2} + p, \\rho u v, u (E + p))^{\\mathsf{T}}$，其中$p$是热力学压力，$\\rho$是质量密度，$(u,v)$是$(x,y)$方向的速度分量，$E$是总能量密度。状态方程为$p = (\\gamma - 1)\\left(E - \\tfrac{1}{2}\\rho(u^{2} + v^{2})\\right)$。所有量均为无量纲。\n\n一个平面物质界面在时间$t=0$时与平面$x=0$重合，并分隔开两个均匀状态。初始数据是一个纯剪切层，其中法向速度和热力学变量是连续的，但切向速度有跳跃。左侧状态为\n$$(\\rho_{L}, u_{L}, v_{L}, p_{L}) = (1, 0, 1, 1),$$\n右侧状态为\n$$(\\rho_{R}, u_{R}, v_{R}, p_{R}) = (1, 0, -1, 1),$$\n假设$\\gamma = 1.4$。\n\n从守恒律和Rankine–Hugoniot跳跃条件出发，并且只使用欧拉系统的标准性质（例如其特征结构和声速定义$a = \\sqrt{\\gamma p/\\rho}$），确定由以下方法预测的在$x/t=0$处$x$方向的界面数值通量：\n- Roe近似黎曼求解器，以及\n- Harten–Lax–van Leer–Contact (HLLC) 近似黎曼求解器。\n\n在每种情况下，根据上述数据和相关的波结构，明确地论证预测的界面法向质量通量和切向动量通量。然后计算标量\n$$\\Delta F_{y} \\equiv (F_{y})_{\\mathrm{Roe}} - (F_{y})_{\\mathrm{HLLC}},$$\n其中$F_{y}$表示$x$-通量的$y$-动量分量，即$F_{y} = \\rho u v$。将您对$\\Delta F_{y}$的最终答案表示为一个无单位的实数。无需四舍五入。",
            "solution": "该问题要求使用两种不同的近似黎曼求解器：Roe求解器和Harten–Lax–van Leer–Contact (HLLC) 求解器，计算纯剪切层在$x$方向上的界面数值通量。最终目标是计算这两种求解器得到的该通量的$y$-动量分量之差。\n\n首先，我们确定初始状态及相关量。左(L)和右(R)状态的原始变量给出如下：\n$$(\\rho_{L}, u_{L}, v_{L}, p_{L}) = (1, 0, 1, 1)$$\n$$(\\rho_{R}, u_{R}, v_{R}, p_{R}) = (1, 0, -1, 1)$$\n比热比为$\\gamma = 1.4$。\n\n总能量密度$E$由状态方程给出：$E = \\frac{p}{\\gamma - 1} + \\frac{1}{2}\\rho(u^{2} + v^{2})$。\n对于左侧状态：\n$$E_{L} = \\frac{p_{L}}{\\gamma - 1} + \\frac{1}{2}\\rho_{L}(u_{L}^{2} + v_{L}^{2}) = \\frac{1}{1.4 - 1} + \\frac{1}{2}(1)(0^{2} + 1^{2}) = 2.5 + 0.5 = 3$$\n对于右侧状态：\n$$E_{R} = \\frac{p_{R}}{\\gamma - 1} + \\frac{1}{2}\\rho_{R}(u_{R}^{2} + v_{R}^{2}) = \\frac{1}{1.4 - 1} + \\frac{1}{2}(1)(0^{2} + (-1)^{2}) = 2.5 + 0.5 = 3$$\n守恒状态向量$U = (\\rho, \\rho u, \\rho v, E)^{\\mathsf{T}}$为：\n$$U_{L} = (1, 0, 1, 3)^{\\mathsf{T}}$$\n$$U_{R} = (1, 0, -1, 3)^{\\mathsf{T}}$$\n\n$x$方向的通量向量为$F(U) = (\\rho u, \\rho u^{2} + p, \\rho u v, u(E+p))^{\\mathsf{T}}$。\n对于左侧状态，由于$u_{L}=0$：\n$$F(U_{L}) = (0, 0^{2} + 1, 0, 0)^{\\mathsf{T}} = (0, 1, 0, 0)^{\\mathsf{T}}$$\n对于右侧状态，由于$u_{R}=0$：\n$$F(U_{R}) = (0, 0^{2} + 1, 0, 0)^{\\mathsf{T}} = (0, 1, 0, 0)^{\\mathsf{T}}$$\n我们注意到$F(U_{L}) = F(U_{R})$。我们关心的量是$x$-通量的$y$-动量分量，记为$F_{y} = \\rho u v$，它是通量向量$F$的第三个分量。\n\n### Roe近似黎曼求解器\n\nRoe求解器的数值通量由下式给出：\n$$F_{\\mathrm{Roe}} = \\frac{1}{2}(F(U_{L}) + F(U_{R})) - \\frac{1}{2}\\sum_{k=1}^{4} |\\tilde{\\lambda}_{k}| \\tilde{\\alpha}_{k} \\tilde{e}_{k}$$\n其中$\\tilde{\\lambda}_{k}$, $\\tilde{\\alpha}_{k}$, 和 $\\tilde{e}_{k}$ 分别是Roe矩阵$\\tilde{A}$的特征值、波强度和右特征向量，该矩阵将系统线性化，使得$F(U_{R}) - F(U_{L}) = \\tilde{A}(U_{R} - U_{L})$。\n\nRoe平均状态计算如下：\n$\\tilde{\\rho} = \\sqrt{\\rho_{L}\\rho_{R}} = \\sqrt{1 \\cdot 1} = 1$。\n$\\tilde{u} = \\frac{\\sqrt{\\rho_{L}}u_{L} + \\sqrt{\\rho_{R}}u_{R}}{\\sqrt{\\rho_{L}} + \\sqrt{\\rho_{R}}} = \\frac{1 \\cdot 0 + 1 \\cdot 0}{1 + 1} = 0$。\n$\\tilde{v} = \\frac{\\sqrt{\\rho_{L}}v_{L} + \\sqrt{\\rho_{R}}v_{R}}{\\sqrt{\\rho_{L}} + \\sqrt{\\rho_{R}}} = \\frac{1 \\cdot 1 + 1 \\cdot (-1)}{1 + 1} = 0$。\n比焓为$h=(E+p)/\\rho$。$h_{L} = (3+1)/1 = 4$，$h_{R} = (3+1)/1 = 4$。\n$\\tilde{h} = \\frac{\\sqrt{\\rho_{L}}h_{L} + \\sqrt{\\rho_{R}}h_{R}}{\\sqrt{\\rho_{L}} + \\sqrt{\\rho_{R}}} = \\frac{1 \\cdot 4 + 1 \\cdot 4}{1 + 1} = 4$。\nRoe平均声速$\\tilde{a}$由$\\tilde{a}^{2} = (\\gamma-1)(\\tilde{h} - \\frac{1}{2}(\\tilde{u}^{2} + \\tilde{v}^{2})) = (1.4-1)(4 - 0) = 1.6$给出。\n\nRoe矩阵的特征值为$\\tilde{\\lambda}_{1,4} = \\tilde{u} \\mp \\tilde{a} = \\mp\\sqrt{1.6}$和$\\tilde{\\lambda}_{2,3} = \\tilde{u} = 0$。\n状态向量的跳跃为$\\Delta U = U_{R} - U_{L} = (0, 0, -2, 0)^{\\mathsf{T}}$。\n这个跳跃必须投影到Roe矩阵的特征向量上。对于$\\tilde{u}=0, \\tilde{v}=0$的平均状态，与特征值$\\tilde{\\lambda}=\\tilde{u}=0$相关的特征向量一个是熵波的，一个是剪切波的。跳跃$\\Delta U$仅对应于切向动量$(\\rho v)$的变化，因此它完全投影到剪切波的特征向量上。该跳跃可以写成$\\Delta U = \\tilde{\\alpha}_{\\text{shear}} \\tilde{e}_{\\text{shear}}$，其中$\\tilde{e}_{\\text{shear}} \\propto (0,0,1,0)^{\\mathsf{T}}$，其强度$\\tilde{\\alpha}_{\\text{shear}} = -2$。声波和熵波的强度为零。\n\nRoe通量中的耗散项是所有波的总和。唯一强度非零的波是剪切波，其相关特征值为$\\tilde{\\lambda}_{\\text{shear}} = \\tilde{u} = 0$。\n该波对耗散项总和的贡献是：\n$$-\\frac{1}{2} |\\tilde{\\lambda}_{\\text{shear}}| \\tilde{\\alpha}_{\\text{shear}} \\tilde{e}_{\\text{shear}} = -\\frac{1}{2} |0| (-2) (0,0,1,0)^{\\mathsf{T}} = (0,0,0,0)^{\\mathsf{T}}$$\n因此，Roe通量就是左右通量的算术平均值：\n$$F_{\\mathrm{Roe}} = \\frac{1}{2}(F(U_{L}) + F(U_{R})) = \\frac{1}{2}((0,1,0,0)^{\\mathsf{T}} + (0,1,0,0)^{\\mathsf{T}}) = (0,1,0,0)^{\\mathsf{T}}$$\n该通量的$y$-动量分量是第三个分量：\n$$(F_{y})_{\\mathrm{Roe}} = 0$$\n\n论证：界面法向质量通量$(\\rho u)_{\\mathrm{Roe}}$是第一个分量，为$0$。切向动量通量$(\\rho u v)_{\\mathrm{Roe}}$是第三个分量，为$0$。这是因为Roe求解器将该问题识别为单个静止的接触间断。对于这样的波，其相关的特征值$\\tilde{\\lambda}$为零，导致数值耗散为零。因此，通量就是初始通量的平均值，而初始通量的这两个分量都为零，因为初始法向速度为零。\n\n### HLLC近似黎曼求解器\n\nHLLC求解器用三道波来模拟黎曼问题：速度为$S_{L}$的左行波，速度为$S_{R}$的右行波，以及速度为$S_{*}$的接触波。在$x/t=0$处的界面通量取决于界面相对于这些波的位置。\n\n首先，我们估计波速。使用Roe平均速度是一种常见的选择：\n$$S_{L} = \\tilde{u} - \\tilde{a} = 0 - \\sqrt{1.6} = -\\sqrt{1.6}$$\n$$S_{R} = \\tilde{u} + \\tilde{a} = 0 + \\sqrt{1.6} = \\sqrt{1.6}$$\n接触波速度$S_{*}$由下式给出：\n$$S_{*} = \\frac{p_{R} - p_{L} + \\rho_{L}u_{L}(S_{L}-u_{L}) - \\rho_{R}u_{R}(S_{R}-u_{R})}{\\rho_{L}(S_{L}-u_{L}) - \\rho_{R}(S_{R}-u_{R})}$$\n代入给定值($p_{L}=p_{R}=1, \\rho_{L}=\\rho_{R}=1, u_{L}=u_{R}=0$)：\n$$S_{*} = \\frac{1-1 + 1 \\cdot 0(S_{L}-0) - 1 \\cdot 0(S_{R}-0)}{1(S_{L}-0) - 1(S_{R}-0)} = \\frac{0}{S_{L}-S_{R}} = 0$$\n由于$S_{L}  0$，$S_{*} = 0$ 且 $S_{R} > 0$，在$x/t=0$处的界面与接触波重合。因此，HLLC通量由“星区”通量给出，$F^{*} = F_{L}^{*} = F_{R}^{*}$。\n\n星区中的状态向量$U_{L}^{*}$可以从跨越速度为$S_L$的波的Rankine-Hugoniot条件确定：$F(U_{L}^{*}) - F(U_{L}) = S_{L}(U_{L}^{*} - U_{L})$。这个问题的一个关键发现是，星区状态$U_{L}^{*}$与初始左侧状态$U_{L}$相同。这可以通过分析$u_L=0$和$S_*=0$时每个分量的跳跃条件来证明：\n1. 质量：$\\rho_L^* S_* - \\rho_L u_L = S_L(\\rho_L^* - \\rho_L) \\implies 0 - 0 = S_L(\\rho_L^* - \\rho_L) \\implies \\rho_L^* = \\rho_L = 1$。\n2. $x$-动量：$\\rho_L^* S_*^2 + p^* - (\\rho_L u_L^2 + p_L) = S_L(\\rho_L^* S_* - \\rho_L u_L) \\implies p^* - p_L = 0 \\implies p^* = p_L=1$。\n3. $y$-动量：$\\rho_L^* S_* v_L^* - \\rho_L u_L v_L = S_L(\\rho_L^* v_L^* - \\rho_L v_L) \\implies 0 - 0 = S_L(\\rho_L^* v_L^* - \\rho_L v_L) \\implies \\rho_L^* v_L^* = \\rho_L v_L \\implies v_L^*=v_L=1$。\n4. 能量：$S_*(E_L^*+p^*) - u_L(E_L+p_L) = S_L(E_L^*-E_L) \\implies 0-0 = S_L(E_L^*-E_L) \\implies E_L^* = E_L = 3$。\n由于所有守恒变量都相同，所以$U_{L}^{*} = U_{L}$。\n星区通量$F_{L}^{*}$由跳跃条件本身给出：\n$$F(U_{L}^{*}) - F(U_{L}) = S_{L}(U_{L}^{*} - U_{L})$$\n该通量代表进入星区的通量。然而，标准的HLLC数值通量定义为$F^*$。在Toro的表述法中，这是$F_{L}^{*} = F(U_{L}) + S_{L}(U_{L}^{*} - U_{L})$。\n由于我们发现$U_L^* = U_L$，修正项为零：\n$$F_{L}^{*} = F(U_{L}) + S_{L}(U_{L} - U_{L}) = F(U_{L}) = (0,1,0,0)^{\\mathsf{T}}$$\n类似地，我们会发现$U_{R}^{*} = U_{R}$，因此$F_{R}^{*} = F(U_{R})$。由于$F(U_L) = F(U_R)$，条件$F_L^*=F_R^*$得到满足。\n因此，界面处的HLLC通量为：\n$$F_{\\mathrm{HLLC}} = F^{*} = (0,1,0,0)^{\\mathsf{T}}$$\n该通量的$y$-动量分量是第三个分量：\n$$(F_{y})_{\\mathrm{HLLC}} = 0$$\n\n论证：法向质量通量$(\\rho u)_{\\mathrm{HLLC}}$为$0$，切向动量通量$(\\rho u v)_{\\mathrm{HLLC}}$为$0$。HLLC求解器正确地将接触波识别为静止的($S_*=0$)。星区的法向速度为$u^*=S_*=0$。因此，在定义界面通量的星区通量计算中，任何包含$u$因子（例如$\\rho u$和$\\rho u v$）的通量分量都为零。\n\n### 最终计算\n\n问题要求计算标量$\\Delta F_{y}$：\n$$\\Delta F_{y} \\equiv (F_{y})_{\\mathrm{Roe}} - (F_{y})_{\\mathrm{HLLC}}$$\n使用上述分析的结果：\n$$\\Delta F_{y} = 0 - 0 = 0$$",
            "answer": "$$\\boxed{0}$$"
        }
    ]
}