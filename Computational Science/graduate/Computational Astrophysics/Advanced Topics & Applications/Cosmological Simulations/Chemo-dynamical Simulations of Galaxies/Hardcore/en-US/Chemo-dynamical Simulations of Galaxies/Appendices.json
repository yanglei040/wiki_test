{
    "hands_on_practices": [
        {
            "introduction": "The stability of a numerical simulation is its most fundamental requirement. In explicit hydrodynamical schemes, the maximum permissible timestep is governed not only by the speed of information propagation—the well-known Courant-Friedrichs-Lewy (CFL) condition—but also by the characteristic timescales of physical source terms. This exercise guides you through the first-principles derivation of the combined timestep constraint, considering both fluid advection and the often more restrictive limit imposed by rapid radiative cooling . Mastering this concept is essential for understanding the practical performance of chemo-dynamical codes and the computational challenges posed by 'stiff' physical processes.",
            "id": "3505207",
            "problem": "Consider a one-dimensional explicit finite-volume solver for compressible gas dynamics with radiative cooling, as commonly employed in chemo-dynamical simulations of galaxies. A uniform mesh of size $\\Delta x$ resolves a region with local bulk velocity $u$, adiabatic sound speed $c_s$, adiabatic index $\\gamma$, total particle number density $n$, gas temperature $T$, and metallicity $Z$. The gas is ideal, with pressure $p = n k_B T$, where $k_B$ is the Boltzmann constant. Radiative cooling is represented as an energy sink term in the internal energy equation with volumetric cooling rate $\\dot{e}_{\\mathrm{cool}} = -n^{2}\\,\\Lambda(T,Z)$, where $\\Lambda(T,Z)$ is the tabulated cooling function that depends on temperature and metallicity; this form is appropriate when the rate can be approximated by $n_e n_H \\Lambda(T,Z)$ with ionization fractions absorbed into $\\Lambda$. The integrator uses a Courant-Friedrichs-Lewy (CFL) safety factor $C_{\\mathrm{CFL}} \\in (0,1)$ for the hyperbolic flux update and a source-term safety factor $\\beta \\in (0,1)$ for the explicit cooling update.\n\nStarting from first principles—namely, the domain-of-dependence requirement for explicit schemes applied to hyperbolic conservation laws, and ideal-gas thermodynamics—derive the maximum stable timestep imposed by wave propagation. Then, derive the explicit cooling-limited timestep implied by the requirement that the fractional change in internal energy per update not exceed the source-term safety factor. Finally, combine these constraints into a single effective maximum stable timestep for the zone.\n\nExpress your final answer as a single closed-form analytic expression for the effective timestep in seconds, in terms of $\\Delta x$, $u$, $c_s$, $n$, $T$, $\\Lambda(T,Z)$, $\\gamma$, $k_B$, $C_{\\mathrm{CFL}}$, and $\\beta$. Do not include units inside your final boxed expression. No numerical rounding is required.",
            "solution": "The problem statement is evaluated to be scientifically grounded, well-posed, objective, and internally consistent. It poses a standard, non-trivial question in computational astrophysics regarding the stability of numerical schemes for hydrodynamics with source terms. All necessary variables and constraints for the derivation are provided. Therefore, the problem is valid and a solution will be provided.\n\nThe goal is to derive the effective maximum stable timestep, $\\Delta t_{\\mathrm{eff}}$, for a one-dimensional explicit finite-volume solver. This timestep is determined by the most restrictive of two constraints: the Courant-Friedrichs-Lewy (CFL) condition for wave propagation (the hyperbolic part of the equations) and a stability condition for the explicit integration of the radiative cooling source term.\n\nFirst, we derive the timestep limit imposed by wave propagation. The equations of compressible gas dynamics are a system of hyperbolic conservation laws. For a one-dimensional system, the characteristic speeds at which information propagates are $u-c_s$, $u$, and $u+c_s$, where $u$ is the local fluid velocity and $c_s$ is the adiabatic sound speed. An explicit numerical scheme on a discrete grid of cell size $\\Delta x$ is stable only if the numerical domain of dependence of a grid cell contains the physical domain of dependence. This is the CFL condition. It requires that no wave can travel more than one cell width, $\\Delta x$, in a single timestep, $\\Delta t$. The maximum possible signal speed in the grid frame is given by the maximum of the absolute values of the characteristic speeds:\n$$\nv_{\\mathrm{max}} = \\max(|u-c_s|, |u|, |u+c_s|)\n$$\nSince the sound speed $c_s$ is by definition non-negative, this simplifies to:\n$$\nv_{\\mathrm{max}} = |u| + c_s\n$$\nThe CFL condition is therefore $\\Delta t \\le \\frac{\\Delta x}{v_{\\mathrm{max}}}$, which translates to:\n$$\n\\Delta t \\le \\frac{\\Delta x}{|u| + c_s}\n$$\nThe problem specifies a CFL safety factor $C_{\\mathrm{CFL}} \\in (0,1)$, which is a fractional multiplier used to ensure stability in practice. The maximum stable timestep constraint from the hyperbolic flux update, which we denote $\\Delta t_{\\mathrm{CFL}}$, is thus:\n$$\n\\Delta t_{\\mathrm{CFL}} = C_{\\mathrm{CFL}} \\frac{\\Delta x}{|u| + c_s}\n$$\n\nNext, we derive the timestep limit imposed by the explicit treatment of the radiative cooling source term. The problem states that radiative cooling acts as a volumetric energy sink, with a rate given by $\\dot{e}_{\\mathrm{cool}} = -n^2 \\Lambda(T,Z)$, where $n$ is the particle number density and $\\Lambda(T,Z)$ is the cooling function. This term represents the rate of change of the internal energy density, $e_{\\mathrm{int}}$, due to cooling. So, $\\frac{de_{\\mathrm{int}}}{dt}\\Big|_{\\mathrm{cool}} = -n^2 \\Lambda(T,Z)$.\n\nFor an ideal gas with an adiabatic index $\\gamma$, the internal energy density is related to the pressure $p$ by:\n$$\ne_{\\mathrm{int}} = \\frac{p}{\\gamma - 1}\n$$\nUsing the ideal gas law, $p = n k_B T$, where $k_B$ is the Boltzmann constant and $T$ is the temperature, we can express the internal energy density in terms of the given variables:\n$$\ne_{\\mathrm{int}} = \\frac{n k_B T}{\\gamma - 1}\n$$\nThe problem requires that for an explicit update, the fractional change in internal energy over one timestep must not exceed a source-term safety factor $\\beta \\in (0,1)$. For an explicit (forward Euler) update, the change in internal energy density due to cooling over a timestep $\\Delta t$ is $\\Delta e_{\\mathrm{int}} \\approx \\frac{de_{\\mathrm{int}}}{dt}\\Big|_{\\mathrm{cool}} \\Delta t$. The stability constraint is thus:\n$$\n\\frac{|\\Delta e_{\\mathrm{int}}|}{e_{\\mathrm{int}}} \\le \\beta\n$$\nSubstituting the expressions for $\\Delta e_{\\mathrm{int}}$ and $e_{\\mathrm{int}}$:\n$$\n\\frac{|-n^2 \\Lambda(T,Z) \\Delta t|}{ \\frac{n k_B T}{\\gamma - 1} } \\le \\beta\n$$\nSimplifying the expression:\n$$\n\\frac{n^2 \\Lambda(T,Z) \\Delta t (\\gamma - 1)}{n k_B T} \\le \\beta\n$$\n$$\n\\frac{n (\\gamma - 1) \\Lambda(T,Z)}{k_B T} \\Delta t \\le \\beta\n$$\nSolving for $\\Delta t$ gives the maximum stable timestep imposed by the cooling term, which we denote $\\Delta t_{\\mathrm{cool}}$:\n$$\n\\Delta t_{\\mathrm{cool}} = \\frac{\\beta k_B T}{n (\\gamma - 1) \\Lambda(T,Z)}\n$$\n\nFinally, for the overall explicit scheme to be stable, the timestep $\\Delta t$ must satisfy both constraints simultaneously. Therefore, the effective maximum stable timestep, $\\Delta t_{\\mathrm{eff}}$, is the minimum of the two derived timesteps:\n$$\n\\Delta t_{\\mathrm{eff}} = \\min(\\Delta t_{\\mathrm{CFL}}, \\Delta t_{\\mathrm{cool}})\n$$\nSubstituting the expressions for $\\Delta t_{\\mathrm{CFL}}$ and $\\Delta t_{\\mathrm{cool}}$, we obtain the final combined expression for the effective timestep:\n$$\n\\Delta t_{\\mathrm{eff}} = \\min \\left( C_{\\mathrm{CFL}} \\frac{\\Delta x}{|u| + c_s}, \\frac{\\beta k_B T}{n (\\gamma - 1) \\Lambda(T,Z)} \\right)\n$$\nThis single closed-form expression provides the maximum stable timestep for the zone in terms of all specified parameters, as requested.",
            "answer": "$$\\boxed{\\min \\left( C_{\\mathrm{CFL}} \\frac{\\Delta x}{|u| + c_s}, \\frac{\\beta k_B T}{n (\\gamma - 1) \\Lambda(T,Z)} \\right)}$$"
        },
        {
            "introduction": "Radiative cooling is a cornerstone of galaxy formation, allowing gas to lose thermal energy, condense, and form stars. The efficiency of this process is highly sensitive to the gas's temperature and, crucially for chemo-dynamical models, its metallicity. This practice focuses on quantifying this dependence by calculating the characteristic cooling time of a gas parcel from fundamental thermodynamic principles and tabulated atomic data . By exploring how the cooling time changes with metallicity, you will develop a concrete understanding of the 'chemo' in chemo-dynamical simulations and its direct impact on gas dynamics.",
            "id": "3505146",
            "problem": "A uniform, optically thin, fully ionized gas parcel representative of the circumgalactic medium cools isochorically. Its hydrogen number density is $n_{\\mathrm{H}} = 1.0\\ \\mathrm{cm}^{-3}$, its temperature is $T = 10^{6}\\ \\mathrm{K}$, and its composition is primordial with hydrogen mass fraction $X=0.76$ and helium mass fraction $Y=0.24$ (neglect metals for the purpose of computing number densities). The radiative cooling rate per unit volume is described by a tabulated cooling function $\\Lambda(T,Z)$, so that the emissivity is $\\mathcal{L} = n_{e}\\,n_{\\mathrm{H}}\\,\\Lambda(T,Z)$, where $n_{e}$ is the electron number density. The internal energy density of an ideal, monatomic, fully ionized gas is $u = \\tfrac{3}{2}\\,n\\,k_{B}\\,T$, where $n$ is the total particle number density and $k_{B}$ is the Boltzmann constant. Assume that ionization state does not change with metallicity at the given temperature, so that $n$, $n_{e}$, and $n_{\\mathrm{H}}$ are independent of $Z$ at fixed $T$ and composition.\n\nAt $T = 10^{6}\\ \\mathrm{K}$, the tabulated values of $\\Lambda(T,Z)$ are:\n- $Z = 0$: $\\Lambda = 1.2 \\times 10^{-23}\\ \\mathrm{erg}\\ \\mathrm{cm}^{3}\\ \\mathrm{s}^{-1}$,\n- $Z = 0.1\\,Z_{\\odot}$: $\\Lambda = 4.0 \\times 10^{-23}\\ \\mathrm{erg}\\ \\mathrm{cm}^{3}\\ \\mathrm{s}^{-1}$,\n- $Z = 1.0\\,Z_{\\odot}$: $\\Lambda = 2.0 \\times 10^{-22}\\ \\mathrm{erg}\\ \\mathrm{cm}^{3}\\ \\mathrm{s}^{-1}$,\n\nwhere $Z_{\\odot}$ denotes Solar metallicity.\n\nUsing only fundamental definitions and the tabulated $\\Lambda(T,Z)$:\n1) Derive the isochoric cooling time $t_{\\mathrm{cool}}$ in terms of $n$, $n_{e}$, $n_{\\mathrm{H}}$, $T$, and $\\Lambda(T,Z)$ starting from energy conservation for radiative losses.\n2) Compute $n_{e}$ and $n$ from $n_{\\mathrm{H}}$, $X$, and $Y$ for a fully ionized gas, and then evaluate $t_{\\mathrm{cool}}$ numerically at $Z=0.1\\,Z_{\\odot}$ and $Z=1.0\\,Z_{\\odot}$ using the tabulated $\\Lambda(T,Z)$.\n3) Define the logarithmic metallicity sensitivity of the cooling time over the interval $Z \\in [0.1\\,Z_{\\odot},\\,1.0\\,Z_{\\odot}]$ as\n$$\nS_{Z} \\equiv \\frac{\\ln\\!\\big(t_{\\mathrm{cool}}(Z_{\\mathrm{high}})\\big) - \\ln\\!\\big(t_{\\mathrm{cool}}(Z_{\\mathrm{low}})\\big)}{\\ln(Z_{\\mathrm{high}}) - \\ln(Z_{\\mathrm{low}})}\\ \\ \\text{with}\\ \\ Z_{\\mathrm{low}} = 0.1\\,Z_{\\odot},\\ \\ Z_{\\mathrm{high}} = 1.0\\,Z_{\\odot}.\n$$\nCompute $S_{Z}$ using your $t_{\\mathrm{cool}}$ values and the tabulated $\\Lambda(T,Z)$.\n\nExpress the final sensitivity $S_{Z}$ as a dimensionless number and round your final answer to three significant figures. Do not report intermediate results in the final answer.",
            "solution": "The problem is first validated against the established criteria.\n\n**Problem Validation**\n\n**Step 1: Extract Givens**\n- Process: Isochoric cooling of a uniform, optically thin, fully ionized gas parcel.\n- Hydrogen number density: $n_{\\mathrm{H}} = 1.0\\ \\mathrm{cm}^{-3}$.\n- Temperature: $T = 10^{6}\\ \\mathrm{K}$.\n- Composition: Hydrogen mass fraction $X=0.76$, Helium mass fraction $Y=0.24$.\n- Emissivity: $\\mathcal{L} = n_{e}\\,n_{\\mathrm{H}}\\,\\Lambda(T,Z)$, where $\\Lambda(T,Z)$ is the cooling function.\n- Internal energy density: $u = \\tfrac{3}{2}\\,n\\,k_{B}\\,T$ for an ideal, monatomic, fully ionized gas. $n$ is the total particle number density.\n- Assumption: $n$, $n_{e}$, and $n_{\\mathrm{H}}$ are independent of metallicity $Z$.\n- Tabulated values of $\\Lambda(T,Z)$ at $T = 10^{6}\\ \\mathrm{K}$:\n  - $Z = 0$: $\\Lambda = 1.2 \\times 10^{-23}\\ \\mathrm{erg}\\ \\mathrm{cm}^{3}\\ \\mathrm{s}^{-1}$.\n  - $Z = 0.1\\,Z_{\\odot}$: $\\Lambda = 4.0 \\times 10^{-23}\\ \\mathrm{erg}\\ \\mathrm{cm}^{3}\\ \\mathrm{s}^{-1}$.\n  - $Z = 1.0\\,Z_{\\odot}$: $\\Lambda = 2.0 \\times 10^{-22}\\ \\mathrm{erg}\\ \\mathrm{cm}^{3}\\ \\mathrm{s}^{-1}$.\n- Tasks:\n  1. Derive the isochoric cooling time $t_{\\mathrm{cool}}$ in terms of $n$, $n_{e}$, $n_{\\mathrm{H}}$, $T$, and $\\Lambda(T,Z)$.\n  2. Compute $n_{e}$ and $n$ from $n_{\\mathrm{H}}$, $X$, and $Y$, then evaluate $t_{\\mathrm{cool}}$ at $Z=0.1\\,Z_{\\odot}$ and $Z=1.0\\,Z_{\\odot}$.\n  3. Compute the logarithmic metallicity sensitivity $S_{Z} \\equiv \\frac{\\ln\\!\\big(t_{\\mathrm{cool}}(Z_{\\mathrm{high}})\\big) - \\ln\\!\\big(t_{\\mathrm{cool}}(Z_{\\mathrm{low}})\\big)}{\\ln(Z_{\\mathrm{high}}) - \\ln(Z_{\\mathrm{low}})}$ with $Z_{\\mathrm{low}} = 0.1\\,Z_{\\odot}$ and $Z_{\\mathrm{high}} = 1.0\\,Z_{\\odot}$.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded**: The problem describes radiative cooling of astrophysical gas, governed by standard thermodynamic principles and using conventional definitions for internal energy and emissivity. The physical parameters and tabular data are representative of real astrophysical environments like the circumgalactic medium. The problem is scientifically sound.\n- **Well-Posed**: The problem is self-contained, providing all necessary definitions, equations, and data. The tasks are specified unambiguously and lead to a unique, meaningful solution.\n- **Objective**: The problem is stated in precise, quantitative, and unbiased language.\n\n**Step 3: Verdict and Action**\n- **Verdict**: The problem is valid. It is scientifically grounded, well-posed, and objective.\n- **Action**: Proceed with the solution.\n\n**Solution**\n\n**1) Derivation of the Isochoric Cooling Time, $t_{\\mathrm{cool}}$**\nThe first law of thermodynamics applied to a unit volume of gas undergoing isochoric cooling with only radiative losses is given by the balance between the rate of change of internal energy density, $u$, and the volumetric radiative cooling rate, $\\mathcal{L}$.\n$$ \\frac{du}{dt} = -\\mathcal{L} $$\nWe are given the expressions for the internal energy density of a monatomic ideal gas and the emissivity:\n$$ u = \\frac{3}{2} n k_{B} T $$\n$$ \\mathcal{L} = n_{e} n_{\\mathrm{H}} \\Lambda(T,Z) $$\nSubstituting these expressions into the energy conservation equation yields:\n$$ \\frac{d}{dt} \\left( \\frac{3}{2} n k_{B} T \\right) = -n_{e} n_{\\mathrm{H}} \\Lambda(T,Z) $$\nFor an isochoric process where the composition is fixed and the gas remains fully ionized, the number densities $n$, $n_{e}$, and $n_{\\mathrm{H}}$ are constant. The Boltzmann constant $k_{B}$ is also a constant. Therefore, we can write:\n$$ \\frac{3}{2} n k_{B} \\frac{dT}{dt} = -n_{e} n_{\\mathrm{H}} \\Lambda(T,Z) $$\nThe characteristic cooling time, $t_{\\mathrm{cool}}$, is defined as the e-folding time for the internal energy, or equivalently, for the temperature, assuming the cooling rate is constant over that timescale:\n$$ t_{\\mathrm{cool}} \\equiv \\left| \\frac{u}{du/dt} \\right| = \\frac{u}{\\mathcal{L}} $$\nSubstituting the expressions for $u$ and $\\mathcal{L}$ gives the desired relationship for the cooling time:\n$$ t_{\\mathrm{cool}} = \\frac{\\frac{3}{2} n k_{B} T}{n_{e} n_{\\mathrm{H}} \\Lambda(T,Z)} $$\n\n**2) Computation of Number Densities and $t_{\\mathrm{cool}}$**\nNext, we compute the total particle number density $n$ and the electron number density $n_{e}$ for a fully ionized gas with hydrogen mass fraction $X=0.76$ and helium mass fraction $Y=0.24$. Let $n_{\\mathrm{H}}$ and $n_{\\mathrm{He}}$ be the number densities of hydrogen and helium nuclei, respectively. The mass of a hydrogen nucleus is $m_{\\mathrm{p}}$ and a helium nucleus is approximately $4m_{\\mathrm{p}}$.\nThe mass fractions are defined as $X = n_{\\mathrm{H}} m_{\\mathrm{p}} / \\rho$ and $Y = 4 n_{\\mathrm{He}} m_{\\mathrm{p}} / \\rho$, where $\\rho$ is the total mass density. The ratio of these fractions gives a relationship between the number densities:\n$$ \\frac{Y}{X} = \\frac{4 n_{\\mathrm{He}} m_{\\mathrm{p}} / \\rho}{n_{\\mathrm{H}} m_{\\mathrm{p}} / \\rho} = \\frac{4 n_{\\mathrm{He}}}{n_{\\mathrm{H}}} \\implies n_{\\mathrm{He}} = n_{\\mathrm{H}} \\frac{Y}{4X} $$\nSince the gas is fully ionized, each hydrogen atom contributes one electron and each helium atom contributes two electrons. The electron number density $n_e$ is:\n$$ n_{e} = n_{\\mathrm{H}} + 2 n_{\\mathrm{He}} = n_{\\mathrm{H}} + 2 \\left( n_{\\mathrm{H}} \\frac{Y}{4X} \\right) = n_{\\mathrm{H}} \\left( 1 + \\frac{Y}{2X} \\right) $$\nThe total particle number density $n$ is the sum of ions (protons and alpha particles) and electrons:\n$$ n = n_{\\mathrm{H}} + n_{\\mathrm{He}} + n_{e} = n_{\\mathrm{H}} + n_{\\mathrm{H}} \\frac{Y}{4X} + n_{\\mathrm{H}} \\left( 1 + \\frac{Y}{2X} \\right) = n_{\\mathrm{H}} \\left( 2 + \\frac{3Y}{4X} \\right) $$\nUsing the given values $X=0.76$ and $Y=0.24$:\n$$ \\frac{Y}{X} = \\frac{0.24}{0.76} = \\frac{6}{19} $$\n$$ n_{e} = n_{\\mathrm{H}} \\left( 1 + \\frac{1}{2} \\frac{6}{19} \\right) = n_{\\mathrm{H}} \\left( 1 + \\frac{3}{19} \\right) = \\frac{22}{19} n_{\\mathrm{H}} $$\n$$ n = n_{\\mathrm{H}} \\left( 2 + \\frac{3}{4} \\frac{6}{19} \\right) = n_{\\mathrm{H}} \\left( 2 + \\frac{9}{38} \\right) = \\frac{85}{38} n_{\\mathrm{H}} $$\nGiven $n_{\\mathrm{H}} = 1.0\\ \\mathrm{cm}^{-3}$, we have $n_{e} = \\frac{22}{19}\\ \\mathrm{cm}^{-3}$ and $n = \\frac{85}{38}\\ \\mathrm{cm}^{-3}$.\n\nNow we substitute these into the expression for $t_{\\mathrm{cool}}$:\n$$ t_{\\mathrm{cool}} = \\frac{\\frac{3}{2} \\left( \\frac{85}{38} n_{\\mathrm{H}} \\right) k_{B} T}{ \\left( \\frac{22}{19} n_{\\mathrm{H}} \\right) n_{\\mathrm{H}} \\Lambda(T,Z)} = \\frac{3}{2} \\frac{85/38}{22/19} \\frac{k_{B} T}{n_{\\mathrm{H}} \\Lambda(T,Z)} = \\frac{3}{2} \\frac{85}{44} \\frac{k_{B} T}{n_{\\mathrm{H}} \\Lambda(T,Z)} = \\frac{255}{88} \\frac{k_{B} T}{n_{\\mathrm{H}} \\Lambda(T,Z)} $$\nLet the constant part be $C = \\frac{255}{88} \\frac{k_B T}{n_{\\mathrm{H}}}$. The cooling time is then $t_{\\mathrm{cool}}(Z) = C / \\Lambda(T,Z)$. We are asked to evaluate $t_{\\mathrm{cool}}$ for two metallicities, though these are intermediate results.\nAt $Z_{\\mathrm{low}} = 0.1\\,Z_{\\odot}$, $\\Lambda(Z_{\\mathrm{low}}) = 4.0 \\times 10^{-23}\\ \\mathrm{erg}\\ \\mathrm{cm}^{3}\\ \\mathrm{s}^{-1}$.\nAt $Z_{\\mathrm{high}} = 1.0\\,Z_{\\odot}$, $\\Lambda(Z_{\\mathrm{high}}) = 2.0 \\times 10^{-22}\\ \\mathrm{erg}\\ \\mathrm{cm}^{3}\\ \\mathrm{s}^{-1}$.\nThe evaluation of cooling times is not strictly necessary for the final answer, as shown in the next step.\n\n**3) Computation of the Logarithmic Metallicity Sensitivity, $S_{Z}$**\nThe sensitivity $S_Z$ is defined as:\n$$ S_{Z} = \\frac{\\ln\\!\\big(t_{\\mathrm{cool}}(Z_{\\mathrm{high}})\\big) - \\ln\\!\\big(t_{\\mathrm{cool}}(Z_{\\mathrm{low}})\\big)}{\\ln(Z_{\\mathrm{high}}) - \\ln(Z_{\\mathrm{low}})} $$\nUsing the properties of logarithms, this can be rewritten as:\n$$ S_{Z} = \\frac{\\ln \\left( \\frac{t_{\\mathrm{cool}}(Z_{\\mathrm{high}})}{t_{\\mathrm{cool}}(Z_{\\mathrm{low}})} \\right)}{\\ln \\left( \\frac{Z_{\\mathrm{high}}}{Z_{\\mathrm{low}}} \\right)} $$\nFrom our expression for $t_{\\mathrm{cool}}$, we see that $t_{\\mathrm{cool}}$ is inversely proportional to $\\Lambda(T,Z)$, as all other quantities ($n, n_e, n_{\\mathrm{H}}, T, k_B$) are constant with respect to metallicity $Z$ based on the problem statement.\n$$ \\frac{t_{\\mathrm{cool}}(Z_{\\mathrm{high}})}{t_{\\mathrm{cool}}(Z_{\\mathrm{low}})} = \\frac{C / \\Lambda(T, Z_{\\mathrm{high}})}{C / \\Lambda(T, Z_{\\mathrm{low}})} = \\frac{\\Lambda(T, Z_{\\mathrm{low}})}{\\Lambda(T, Z_{\\mathrm{high}})} $$\nSubstituting the values of $\\Lambda$ from the table:\n$$ \\frac{\\Lambda(T, Z_{\\mathrm{low}})}{\\Lambda(T, Z_{\\mathrm{high}})} = \\frac{4.0 \\times 10^{-23}\\ \\mathrm{erg}\\ \\mathrm{cm}^{3}\\ \\mathrm{s}^{-1}}{2.0 \\times 10^{-22}\\ \\mathrm{erg}\\ \\mathrm{cm}^{3}\\ \\mathrm{s}^{-1}} = \\frac{4.0}{20.0} = \\frac{1}{5} $$\nThe ratio of the metallicities is:\n$$ \\frac{Z_{\\mathrm{high}}}{Z_{\\mathrm{low}}} = \\frac{1.0\\,Z_{\\odot}}{0.1\\,Z_{\\odot}} = 10 $$\nNow, we can compute $S_{Z}$:\n$$ S_{Z} = \\frac{\\ln(1/5)}{\\ln(10)} = \\frac{-\\ln(5)}{\\ln(10)} $$\nUsing the values for the natural logarithms:\n$\\ln(5) \\approx 1.6094379$\n$\\ln(10) \\approx 2.3025851$\n$$ S_{Z} \\approx \\frac{-1.6094379}{2.3025851} \\approx -0.6989700 $$\nRounding the result to three significant figures, we get $S_{Z} \\approx -0.699$.",
            "answer": "$$\\boxed{-0.699}$$"
        },
        {
            "introduction": "Having explored the numerical constraints and key physical ingredients, we now synthesize them in a working 'one-zone' model to investigate an emergent galactic phenomenon. This practice involves implementing a simulation where star formation is regulated by a metallicity-dependent threshold, which in turn is altered by the enrichment from new stars, creating a fundamental feedback loop. By building and analyzing this model, you will see firsthand how the interplay between chemistry and dynamics can drive complex, bursty star formation histories in low-mass galaxies and learn how to quantify these behaviors with time-series analysis .",
            "id": "3505128",
            "problem": "Design and implement a minimal one-zone chemo-dynamical model for a low-mass galactic disk patch in which the conversion of neutral gas to molecular hydrogen ($\\text{H}_2$) is controlled by a metallicity-dependent surface-density threshold. The goal is to quantify how this threshold modulates star formation burstiness and the timing of enrichment cycles. Your program must simulate the coupled evolution of gas mass, stellar mass, and gas-phase metallicity under mass inflow, star formation, instantaneous recycling, and outflows, then compute quantitative metrics from the emergent time series.\n\nStart from the following fundamental base and core definitions:\n\n- Mass conservation for gas: the time derivative of gas mass $M_{\\mathrm{g}}$ is the inflow rate minus the sink terms due to star formation locking up long-lived stars and outflows driven by feedback.\n- Instantaneous recycling approximation (IRA): a constant return fraction $R$ instantaneously returns a fraction of formed stellar mass to the interstellar medium (ISM), while a constant metal yield $y$ adds freshly produced metals to the gas phase per unit mass locked into long-lived stars.\n- Star formation law controlled by a threshold in molecular content: adopt a sharp on/off conversion such that star formation proceeds only when the gas surface density exceeds a critical value that depends on the current metallicity.\n\nModel ingredients and notation:\n\n- Let $M_{\\mathrm{g}}(t)$ be the gas mass in solar masses, $M_{*}(t)$ be the stellar mass in solar masses, and $M_{Z}(t)$ be the mass of metals in the gas phase in solar masses. Define gas-phase metallicity (mass fraction) $Z(t) \\equiv M_{Z}(t)/M_{\\mathrm{g}}(t)$.\n- Consider a circular patch of radius $R_{\\mathrm{disk}} = 0.5$ kiloparsec, with area $A = \\pi (1000\\,R_{\\mathrm{disk}})^{2}$ in square parsecs. The gas surface density is $\\Sigma_{\\mathrm{g}} = M_{\\mathrm{g}}/A$ in units of solar masses per square parsec.\n- The star formation rate is modeled as $\\mathrm{SFR} = \\epsilon_{\\mathrm{sf}} M_{\\mathrm{g}}$ when $\\Sigma_{\\mathrm{g}} \\ge \\Sigma_{\\mathrm{crit}}(Z)$ and $\\mathrm{SFR} = 0$ otherwise, where $\\epsilon_{\\mathrm{sf}} = 1/t_{\\mathrm{dep}}$ with $t_{\\mathrm{dep}} = 10^{9}$ years. Express $\\mathrm{SFR}$ in solar masses per year.\n- The metallicity-dependent critical surface density is $\\Sigma_{\\mathrm{crit}}(Z) = \\Sigma_{0}\\left(Z_{\\odot}/\\max(Z,Z_{\\mathrm{floor}})\\right)^{\\alpha}$, with $\\Sigma_{0}$ in solar masses per square parsec, $Z_{\\odot} = 0.0142$, exponent $\\alpha \\ge 0$, and a floor $Z_{\\mathrm{floor}} = 0.05 Z_{\\odot}$ to represent an effective dust-shielding/clumping floor below which the threshold does not increase further.\n- Mass flows and chemical evolution follow:\n  - Constant inflow $\\dot{M}_{\\mathrm{in}}$ (solar masses per year) with inflow metallicity $Z_{\\mathrm{in}}$.\n  - Outflow $\\dot{M}_{\\mathrm{out}} = \\eta\\,\\mathrm{SFR}$, with constant mass-loading factor $\\eta$ (dimensionless).\n  - Gas mass evolution: $\\frac{dM_{\\mathrm{g}}}{dt} = \\dot{M}_{\\mathrm{in}} - (1-R)\\,\\mathrm{SFR} - \\dot{M}_{\\mathrm{out}}$.\n  - Metal mass evolution: $\\frac{dM_{Z}}{dt} = y(1-R)\\,\\mathrm{SFR} + Z_{\\mathrm{in}}\\,\\dot{M}_{\\mathrm{in}} - Z\\,\\dot{M}_{\\mathrm{out}} - Z(1-R)\\,\\mathrm{SFR}$.\n- Adopt constants: $R = 0.4$, $y = 0.02$, $\\eta = 2.0$, $Z_{\\odot} = 0.0142$, $R_{\\mathrm{disk}} = 0.5$ kiloparsec, $\\dot{M}_{\\mathrm{in}} = 0.05$ solar masses per year, and $t_{\\mathrm{dep}} = 10^{9}$ years.\n\nInitial conditions at $t=0$:\n- $M_{\\mathrm{g}}(0) = 10^{7}$ solar masses, $M_{*}(0) = 0$ solar masses, and $Z(0) = 0$. The metallicity floor $Z_{\\mathrm{floor}}$ applies when evaluating $\\Sigma_{\\mathrm{crit}}(Z)$, but the actual $Z(0)$ used in chemical evolution is zero.\n\nNumerical integration:\n- Integrate the system forward in time using explicit Euler with a fixed time step $\\Delta t = 1$ megayear. Simulate until $T_{\\mathrm{end}} = 2000$ megayears. Use consistent unit conversions, with $1$ megayear equal to $10^{6}$ years.\n\nRequired diagnostics from the simulated time series:\n- Define the analysis window as the second half of the trajectory, i.e., times $t \\in [T_{\\mathrm{end}}/2, T_{\\mathrm{end}}]$.\n- Star formation burstiness metrics:\n  1. Coefficient of variation $B_{\\mathrm{CV}} \\equiv \\sigma(\\mathrm{SFR})/\\mu(\\mathrm{SFR})$ computed over the analysis window. If $\\mu(\\mathrm{SFR}) = 0$, define $B_{\\mathrm{CV}} = 0$.\n  2. Burst fraction $B_{\\mathrm{frac}} \\equiv$ the fraction of analysis-window time steps where $\\mathrm{SFR}  k \\cdot \\mathrm{median}(\\mathrm{SFR})$, with $k = 2$. If the median is zero, count as a burst any time step with $\\mathrm{SFR}  0$.\n- Enrichment timing metric:\n  - Cross-correlation lag $L$ between $\\mathrm{SFR}(t)$ and $Z(t)$ over the analysis window. Detrend by subtracting the mean from each series, compute the discrete cross-correlation over integer lags, and return the lag (in megayears) at which the cross-correlation is maximal. Use the sign convention that a positive $L$ means $Z$ lags $\\mathrm{SFR}$.\n\nTest suite:\n- Run the simulation for the following three parameter sets, which vary the metallicity dependence and inflow metallicity while keeping other parameters fixed:\n  1. Case A (happy path): $\\alpha = 0.8$, $\\Sigma_{0} = 5$, $Z_{\\mathrm{in}} = 0.1 Z_{\\odot}$.\n  2. Case B (boundary, no metallicity dependence): $\\alpha = 0.0$, $\\Sigma_{0} = 5$, $Z_{\\mathrm{in}} = 0.1 Z_{\\odot}$.\n  3. Case C (edge, stronger metallicity dependence and lower inflow metallicity): $\\alpha = 1.0$, $\\Sigma_{0} = 5$, $Z_{\\mathrm{in}} = 0.05 Z_{\\odot}$.\n\nUnits:\n- Time in megayears, masses in solar masses, surface densities in solar masses per square parsec, and star formation rates in solar masses per year. Express the lag $L$ in megayears.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The result for each case must be a three-element list $[B_{\\mathrm{CV}}, B_{\\mathrm{frac}}, L]$ in that order. The final output line must therefore be a list of three lists, e.g., $[[b_{1},f_{1},\\ell_{1}],[b_{2},f_{2},\\ell_{2}],[b_{3},f_{3},\\ell_{3}]]$, with floating-point numbers.",
            "solution": "The problem is valid as it presents a well-posed, scientifically grounded computational astrophysics task based on established principles of galaxy evolution modeling. The equations, parameters, and numerical methods are clearly defined and consistent.\n\nHere follows the systematic approach to solving the problem.\n\n### 1. Model Formulation\n\nThe model describes the chemo-dynamical evolution of a single, uniform gas patch, often called a \"one-zone\" or \"bathtub\" model. The state of the system at any time `$t$` is defined by three variables: the gas mass `$M_{\\mathrm{g}}(t)$`, the stellar mass `$M_{*}(t)$`, and the mass of metals within the gas `$M_{Z}(t)$`. The evolution is governed by a system of coupled ordinary differential equations (ODEs).\n\nThe gas mass evolution follows the principle of mass conservation:\n$$\n\\frac{dM_{\\mathrm{g}}}{dt} = \\dot{M}_{\\mathrm{in}} - (1-R)\\,\\mathrm{SFR} - \\dot{M}_{\\mathrm{out}}\n$$\n- `$\\dot{M}_{\\mathrm{in}}$`: A constant rate of pristine or near-pristine gas inflow.\n- `$(1-R)\\,\\mathrm{SFR}$`: The rate at which gas is converted into long-lived stars. `$R=0.4$` is the mass fraction of a stellar population that is instantaneously returned to the interstellar medium (ISM).\n- `$\\dot{M}_{\\mathrm{out}} = \\eta\\,\\mathrm{SFR}$`: The rate of gas loss due to galactic outflows driven by stellar feedback. The constant `$\\eta=2.0$` is the mass-loading factor.\n\nThe metal mass in the gas phase, `$M_{Z}(t)$`, evolves as:\n$$\n\\frac{dM_{Z}}{dt} = y(1-R)\\,\\mathrm{SFR} + Z_{\\mathrm{in}}\\,\\dot{M}_{\\mathrm{in}} - Z(t)\\,\\dot{M}_{\\mathrm{out}} - Z(t)(1-R)\\,\\mathrm{SFR}\n$$\n- `$y(1-R)\\,\\mathrm{SFR}$`: The rate of new metal production. `$y=0.02$` is the metal yield per unit mass of stars locked up. This reflects enrichment from short-lived massive stars, consistent with the Instantaneous Recycling Approximation (IRA).\n- `$Z_{\\mathrm{in}}\\,\\dot{M}_{\\mathrm{in}}$`: The rate at which metals are brought in with the inflowing gas.\n- `$Z(t)\\,\\dot{M}_{\\mathrm{out}}$`: The rate at which metals are expelled in outflows, assuming the outflowing gas has the same metallicity `$Z(t) = M_{Z}(t)/M_{\\mathrm{g}}(t)$` as the ISM.\n- `$Z(t)(1-R)\\,\\mathrm{SFR}$`: The rate at which existing metals are removed from the gas phase and locked into new long-lived stars.\n\nThe stellar mass of long-lived stars increases as:\n$$\n\\frac{dM_{*}}{dt} = (1-R)\\,\\mathrm{SFR}\n$$\n\n### 2. Star Formation Threshold\n\nA key feature of this model is the non-linear star formation law. Star formation is active only when the gas surface density, `$\\Sigma_{\\mathrm{g}} = M_{\\mathrm{g}} / A$`, exceeds a critical threshold, `$\\Sigma_{\\mathrm{crit}}(Z)$`. The area `$A$` is fixed by the patch radius `$R_{\\mathrm{disk}}=0.5$` kpc.\n$$\n\\mathrm{SFR} = \n\\begin{cases} \n\\epsilon_{\\mathrm{sf}} M_{\\mathrm{g}}  \\text{if } \\Sigma_{\\mathrm{g}} \\ge \\Sigma_{\\mathrm{crit}}(Z) \\\\\n0  \\text{if } \\Sigma_{\\mathrm{g}}  \\Sigma_{\\mathrm{crit}}(Z) \n\\end{cases}\n$$\nThe star formation efficiency is `$\\epsilon_{\\mathrm{sf}} = 1/t_{\\mathrm{dep}}$`, with a gas depletion time of `$t_{\\mathrm{dep}} = 10^9$` years.\n\nThe critical threshold `$\\Sigma_{\\mathrm{crit}}(Z)$` depends on the gas-phase metallicity `$Z$`, modeling the transition from neutral to molecular gas, which is catalyzed by dust grains (metals).\n$$\n\\Sigma_{\\mathrm{crit}}(Z) = \\Sigma_{0}\\left(\\frac{Z_{\\odot}}{\\max(Z, Z_{\\mathrm{floor}})}\\right)^{\\alpha}\n$$\n- `$\\Sigma_{0}$` is a base density threshold.\n- `$\\alpha$` controls the strength of the metallicity dependence.\n- `$Z_{\\odot} = 0.0142$` is the solar metallicity.\n- `$Z_{\\mathrm{floor}} = 0.05 Z_{\\odot}$` is a minimum metallicity used to calculate the threshold, preventing divergence at `$Z=0$`.\n\n### 3. Numerical Integration\n\nThe system of ODEs is integrated numerically using the explicit Euler method with a fixed time step `$\\Delta t = 1$` Myr (`$10^6$` years). Starting from the initial conditions `$M_{\\mathrm{g}}(0) = 10^7 \\, M_{\\odot}$`, `$M_{*}(0)=0$`, and `$Z(0)=0$`, the state variables are evolved forward in time for a total duration of `$T_{\\mathrm{end}} = 2000$` Myr. For each time step `$i$`:\n1.  Calculate current quantities: `$Z_i = M_{Z,i}/M_{\\mathrm{g},i}$` and `$\\Sigma_{\\mathrm{g},i} = M_{\\mathrm{g},i}/A$`.\n2.  Determine `$\\mathrm{SFR}_i$` based on the threshold condition.\n3.  Compute the derivatives `$\\frac{dM_{\\mathrm{g}}}{dt}$` and `$\\frac{dM_{Z}}{dt}$` using the rates at step `$i$`.\n4.  Update the state variables: `$M_{\\mathrm{g},i+1} = M_{\\mathrm{g},i} + \\frac{dM_{\\mathrm{g}}}{dt} \\Delta t_{\\mathrm{years}}$` and `$M_{Z,i+1} = M_{Z,i} + \\frac{dM_Z}{dt} \\Delta t_{\\mathrm{years}}$`.\n\n### 4. Diagnostic Metrics\n\nThe analysis is performed on the time series of `$\\mathrm{SFR}(t)$` and `$Z(t)$` over the second half of the simulation, `$t \\in [1000, 2000]$` Myr, to focus on the system's quasi-equilibrium behavior.\n\n1.  **Burstiness Coefficient (`$B_{\\mathrm{CV}}$`)**: The coefficient of variation of the `$\\mathrm{SFR}$` time series, defined as `$\\sigma(\\mathrm{SFR}) / \\mu(\\mathrm{SFR})$`. It measures the amplitude of fluctuations relative to the mean.\n2.  **Burst Fraction (`$B_{\\mathrm{frac}}$`)**: The fraction of time steps within the analysis window where the `$\\mathrm{SFR}$` exceeds twice its median value. This quantifies the duty cycle of strong star formation episodes.\n3.  **Enrichment Lag (`$L$`)**: The time lag between the `$\\mathrm{SFR}(t)$` and `$Z(t)$` time series. It is found by computing the discrete cross-correlation of the mean-subtracted series and identifying the lag (in Myr) that maximizes the correlation. A positive lag signifies that metallicity changes trail star formation activity, as expected since stars produce metals.\n\nThese steps are implemented for each of the three test cases, which explore different model parameters (`$\\alpha$`, `$\\Sigma_0$`, `$Z_{\\mathrm{in}}$`), to generate the required output.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Simulates a one-zone chemo-dynamical galaxy model and computes diagnostics.\n    \"\"\"\n    # Define test cases with parameters (alpha, Sigma0, Z_in_fraction_of_solar)\n    Z_solar = 0.0142\n    test_cases = [\n        # Case A: Happy path\n        (0.8, 5.0, 0.1 * Z_solar),\n        # Case B: Boundary, no metallicity dependence\n        (0.0, 5.0, 0.1 * Z_solar),\n        # Case C: Edge, stronger metallicity dependence and lower inflow metallicity\n        (1.0, 5.0, 0.05 * Z_solar),\n    ]\n\n    # Global constants for the model\n    R = 0.4\n    y = 0.02\n    eta = 2.0\n    R_disk_kpc = 0.5\n    M_in_dot = 0.05  # M_sun / yr\n    t_dep_yr = 1e9   # yr\n    dt_myr = 1.0     # Myr\n    t_end_myr = 2000.0 # Myr\n    \n    # Derived physical and simulation constants\n    A_pc2 = np.pi * (R_disk_kpc * 1000)**2\n    epsilon_sf = 1.0 / t_dep_yr\n    dt_yr = dt_myr * 1e6\n    Z_floor = 0.05 * Z_solar\n    num_steps = int(t_end_myr / dt_myr)\n\n    all_results = []\n    for case in test_cases:\n        alpha, Sigma0, Z_in = case\n\n        # Initialize time-series arrays\n        M_g = np.zeros(num_steps + 1)\n        M_Z = np.zeros(num_steps + 1)\n        sfr_series = np.zeros(num_steps)\n        \n        # Initial conditions\n        M_g[0] = 1e7\n        M_Z[0] = 0.0\n        \n        # Main integration loop\n        for i in range(num_steps):\n            # Ensure masses are non-negative\n            M_g[i] = max(0, M_g[i])\n            M_Z[i] = max(0, M_Z[i])\n\n            # Calculate current state variables\n            Z_i = M_Z[i] / M_g[i] if M_g[i] > 0 else 0.0\n            Sigma_g = M_g[i] / A_pc2\n            \n            # Calculate metallicity-dependent critical surface density\n            Z_for_crit = max(Z_i, Z_floor)\n            Sigma_crit = Sigma0 * (Z_solar / Z_for_crit)**alpha\n            \n            # Calculate Star Formation Rate (SFR) based on threshold\n            sfr = 0.0\n            if Sigma_g >= Sigma_crit:\n                sfr = epsilon_sf * M_g[i]\n            sfr_series[i] = sfr\n            \n            # Calculate mass and metal flow rates\n            M_out_dot = eta * sfr\n            dMg_dt = M_in_dot - (1 - R) * sfr - M_out_dot\n            dMZ_dt = y * (1 - R) * sfr + Z_in * M_in_dot - Z_i * M_out_dot - Z_i * (1 - R) * sfr\n\n            # Update state variables using Explicit Euler method\n            M_g[i+1] = M_g[i] + dMg_dt * dt_yr\n            M_Z[i+1] = M_Z[i] + dMZ_dt * dt_yr\n        \n        # --- Post-processing and Diagnostics ---\n        analysis_start_index = num_steps // 2\n        \n        # Extract time series for the analysis window\n        sfr_window = sfr_series[analysis_start_index:]\n        \n        # 1. Burstiness Coefficient (B_CV)\n        mean_sfr = np.mean(sfr_window)\n        if mean_sfr > 1e-12: # Use a small tolerance for floating point\n            std_sfr = np.std(sfr_window)\n            B_cv = std_sfr / mean_sfr\n        else:\n            B_cv = 0.0\n\n        # 2. Burst Fraction (B_frac)\n        median_sfr = np.median(sfr_window)\n        n_window = len(sfr_window)\n        if median_sfr > 1e-12:\n            burst_threshold = 2.0 * median_sfr\n            burst_count = np.sum(sfr_window > burst_threshold)\n        else:\n            burst_count = np.sum(sfr_window > 0)\n        B_frac = burst_count / n_window if n_window > 0 else 0.0\n        \n        # 3. Enrichment Lag (L)\n        Z_full = np.divide(M_Z, M_g, out=np.zeros_like(M_g), where=M_g>0)\n        Z_window = Z_full[analysis_start_index:num_steps]\n        \n        sfr_detrended = sfr_window - np.mean(sfr_window)\n        Z_detrended = Z_window - np.mean(Z_window)\n        \n        # Avoid correlation of constant signals\n        if np.std(sfr_detrended)  1e-12 or np.std(Z_detrended)  1e-12:\n            L = 0.0\n        else:\n            correlation = np.correlate(sfr_detrended, Z_detrended, mode='full')\n            lag_array = np.arange(-n_window + 1, n_window)\n            lag_in_steps = lag_array[np.argmax(correlation)]\n            L = float(lag_in_steps * dt_myr)\n            \n        all_results.append([B_cv, B_frac, L])\n\n    # Format the final output string precisely as a list of lists with no spaces\n    output_parts = []\n    for r in all_results:\n        part = f\"[{r[0]},{r[1]},{r[2]}]\"\n        output_parts.append(part)\n    final_output_str = f\"[{','.join(output_parts)}]\"\n    print(final_output_str)\n\nsolve()\n```"
        }
    ]
}