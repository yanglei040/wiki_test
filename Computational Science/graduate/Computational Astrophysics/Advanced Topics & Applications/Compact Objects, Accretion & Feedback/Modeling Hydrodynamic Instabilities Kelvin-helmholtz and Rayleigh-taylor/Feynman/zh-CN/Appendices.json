{
    "hands_on_practices": [
        {
            "introduction": "在运行复杂的流体力学模拟之前，利用简化的解析模型来理解关键的物理平衡是非常有价值的。本练习利用线性稳定性理论的经典结果，来确定开尔文-亥姆霍兹不稳定性（KHI）克服粘性耗散的阈值。通过这个练习，你将计算出临界雷诺数 $Re$，这是流体动力学中一个基本的无量纲参数，它标志着不稳定性开始增长的条件。",
            "id": "3519377",
            "problem": "考虑一个平面天体物理剪切层，该剪切层形成于两种半无限、不可压缩、等密度的流体之间，其速度剖面为 $U(y) = \\frac{\\Delta U}{2} \\tanh\\!\\left(\\frac{y}{a}\\right)$，其中 $\\Delta U$ 是跨越该层的速度差，$a$ 是特征剪切厚度。假设流动是等温的，密度是均匀的，其动力学由具有运动粘度 $\\nu$ 的不可压缩纳维-斯托克斯方程控制。一个波数为 $k$ 的小振幅二维扰动，在无粘开尔文-亥姆霍兹不稳定性 (KHI) 和粘性扩散的共同作用下演化。对于双曲正切剪切层，线性稳定性理论有一个经过充分检验的结果：在无粘极限下，最不稳定的模具有 $k a \\approx \\alpha$（其中 $\\alpha \\approx 0.44$），并且在等密度情况下，相应的无粘增长率为 $\\gamma_{\\text{inv}} \\approx C \\frac{\\Delta U}{a}$（其中 $C \\approx 0.19$）。另一个经过充分检验的事实是，粘性扩散会以指数率 $\\gamma_{\\nu} \\approx \\nu k^{2}$ 阻尼一个傅里叶模。\n\n将雷诺数定义为 $\\mathrm{Re} = \\frac{\\Delta U\\, a}{\\nu}$。对于增长最快的模的近无粘KHI增长，估算使得无粘增长不被粘性抑制的最小雷诺数 $\\mathrm{Re}$。使用阈值出现在无粘增长率等于增长最快的模的粘性阻尼率这一判据。计算所得的最小雷诺数，并将最终答案四舍五入到三位有效数字。最终答案以无单位的纯数表示。",
            "solution": "该问题陈述已经过验证，被认为是科学上可靠、适定且客观的。这是一个关于剪切层稳定性的流体动力学标准问题。\n\n目标是确定开尔文-亥姆霍兹不稳定性 (KHI) 得以增长所需的最小雷诺数 $\\mathrm{Re}$。雷诺数的定义为：\n$$\n\\mathrm{Re} = \\frac{\\Delta U\\, a}{\\nu}\n$$\n其中 $\\Delta U$ 是速度差，$a$ 是特征剪切厚度，$\\nu$ 是运动粘度。\n\n扰动的增长由净增长率决定，净增长率是无粘增长率 $\\gamma_{\\text{inv}}$ 与为负的粘性阻尼率 $-\\gamma_{\\nu}$ 之和。当净增长率为正时，即 $\\gamma_{\\text{inv}} - \\gamma_{\\nu} > 0$，不稳定性发生。因此，不稳定的阈值（对应于增长所需的最小雷诺数）由无粘增长率与粘性阻尼率恰好平衡的条件定义：\n$$\n\\gamma_{\\text{inv}} = \\gamma_{\\nu}\n$$\n问题指明，该判据应应用于增长最快的无粘模。\n\n根据问题陈述，增长最快的模的无粘增长率由下式给出：\n$$\n\\gamma_{\\text{inv}} \\approx C \\frac{\\Delta U}{a}\n$$\n其中常数 $C \\approx 0.19$。\n\n波数为 $k$ 的模的粘性阻尼率由下式给出：\n$$\n\\gamma_{\\nu} \\approx \\nu k^{2}\n$$\n问题指出，增长最快的无粘模具有满足以下条件的无量纲波数 $ka$：\n$$\nka \\approx \\alpha\n$$\n其中常数 $\\alpha \\approx 0.44$。根据这个关系，我们可以将此模的波数 $k$ 表示为：\n$$\nk \\approx \\frac{\\alpha}{a}\n$$\n将 $k$ 的这个表达式代入粘性阻尼率方程，得到增长最快的模的阻尼率：\n$$\n\\gamma_{\\nu} \\approx \\nu \\left(\\frac{\\alpha}{a}\\right)^2 = \\nu \\frac{\\alpha^2}{a^2}\n$$\n现在，我们应用阈值判据，令无粘增长率等于粘性阻尼率：\n$$\nC \\frac{\\Delta U}{a} = \\nu \\frac{\\alpha^2}{a^2}\n$$\n为了求出雷诺数，我们重排此方程以分离出项 $\\frac{\\Delta U a}{\\nu}$。首先，我们可以消去两边的因子 $a^{-1}$，或者等价地，将两边同乘以 $a^2$：\n$$\nC (\\Delta U) a = \\nu \\alpha^2\n$$\n接下来，我们将两边同除以 $\\nu$ 和 $C$，以求解对应于雷诺数的表达式：\n$$\n\\frac{\\Delta U a}{\\nu} = \\frac{\\alpha^2}{C}\n$$\n由于 $\\mathrm{Re} = \\frac{\\Delta U a}{\\nu}$，不稳定性所需的最小雷诺数为：\n$$\n\\mathrm{Re} = \\frac{\\alpha^2}{C}\n$$\n我们已知常数 $\\alpha$ 和 $C$ 的近似值：\n$$\n\\alpha \\approx 0.44\n$$\n$$\nC \\approx 0.19\n$$\n将这些值代入 $\\mathrm{Re}$ 的表达式中：\n$$\n\\mathrm{Re} \\approx \\frac{(0.44)^2}{0.19} = \\frac{0.1936}{0.19} \\approx 1.018947...\n$$\n问题要求最终答案四舍五入到三位有效数字。前三位有效数字是 $1.01$。第四位数字是 $8$，因此我们将第三位有效数字向上取整。\n$$\n\\mathrm{Re} \\approx 1.02\n$$\n这个临界雷诺数代表了一个阈值，低于该阈值，对于给定的剪切层剖面，粘性力将足够强，足以完全抑制KHI。",
            "answer": "$$\\boxed{1.02}$$"
        },
        {
            "introduction": "在模拟了流体不稳定性（如开尔文-亥姆霍兹或瑞利-泰勒不稳定性）之后，我们需要定量的指标来分析和解释模拟结果。本练习将指导你如何从原始模拟数据中实现并计算几个关键的诊断量，例如标量方差和混合分数，用以衡量流体的混合程度。掌握这些度量方法对于比较不同模拟的结果，以及将模拟与理论或观测联系起来至关重要。",
            "id": "3519383",
            "problem": "给定与开尔文-亥姆霍兹 (KH) 流和瑞利-泰勒 (RT) 流相关的理想可压缩流体动力学模拟快照。每个快照在均匀网格上由单元中心密度 $\\rho_i$（单位为 $\\mathrm{kg\\,m^{-3}}$）、速度分量 $u_{x,i}$ 和 $u_{y,i}$（单位为 $\\mathrm{m\\,s^{-1}}$）以及用于标记其中一种流体的无源标量质量分数 $Y_i$（无量纲）的数组表示。网格是均匀的，因此所有单元的体积相等。请考虑以下三个全局混合度量，并根据这些场进行计算：\n\n- 定义在整个域上、使用密度加权（Favre）平均的无源标量质量分数的质量加权标量方差。\n- 质量加权混合分数，定义为无源标量值严格介于指定容差 $\\delta$ 和 $1-\\delta$ 之间的单元所占总质量的比例。\n- 单位质量湍动能 (TKE)，使用速度场的密度加权分解来定义。\n\n从质量守恒和可压缩流的密度加权平均的定义出发，结合脉动定义为与适当平均值的偏差，进行推导。使用这些来推导仅依赖于 $\\rho_i$、$u_{x,i}$、$u_{y,i}$ 和 $Y_i$ 以及用户指定的 $\\delta$ 的表达式。在推导过程中，请明确区分任何域平均、质量加权平均和脉动场。假设网格是均匀的，因此体积加权简化为简单求和；在需要质量加权平均时，使用密度加权。以 $\\mathrm{m^2\\,s^{-2}}$ 为单位表示单位质量湍动能，并四舍五入到六位小数。另外两个度量是无量纲的，也必须四舍五入到六位小数。\n\n您的程序必须实现推导出的表达式，并在以下由 4 个单元的数组指定的测试用例集上对其进行评估：\n\n- 案例 $1$（未混合，均匀速度）：\n  - $\\rho = (1, 1, 1, 1)$（单位为 $\\mathrm{kg\\,m^{-3}}$）\n  - $u_x = (1, 1, 1, 1)$ 和 $u_y = (0, 0, 0, 0)$（单位为 $\\mathrm{m\\,s^{-1}}$）\n  - $Y = (0, 0, 1, 1)$（无量纲）\n  - $\\delta = 0.01$\n- 案例 $2$（完全混合标量，密度可变且速度相反）：\n  - $\\rho = (1, 2, 1, 2)$（单位为 $\\mathrm{kg\\,m^{-3}}$）\n  - $u_x = (1, -1, 1, -1)$ 和 $u_y = (0, 0, 0, 0)$（单位为 $\\mathrm{m\\,s^{-1}}$）\n  - $Y = (0.5, 0.5, 0.5, 0.5)$（无量纲）\n  - $\\delta = 0.01$\n- 案例 $3$（部分混合界面，密度分层，剪切）：\n  - $\\rho = (3, 3, 1, 1)$（单位为 $\\mathrm{kg\\,m^{-3}}$）\n  - $u_x = (0.5, 0.5, -0.5, -0.5)$ 和 $u_y = (0, 0, 0, 0)$（单位为 $\\mathrm{m\\,s^{-1}}$）\n  - $Y = (0.98, 0.9, 0.1, 0.02)$（无量纲）\n  - $\\delta = 0.05$\n\n覆盖设计：\n- 案例 $1$ 探究了均匀流下的未混合状态，其湍流度量是平凡的。\n- 案例 $2$ 探究了完全标量混合和密度加权下非平凡的湍动能。\n- 案例 $3$ 探究了部分混合、非平凡的标量方差以及类似于 RT 初始条件中的密度分层和剪切。\n\n您的程序应生成单行输出，其中包含一个逗号分隔的列表，列表内容为每个案例的三元组结果，每个三元组按 $[\\text{scalar\\_variance}, \\text{mixing\\_fraction}, \\text{tke}]$ 的顺序排列。总体输出必须是包含三个案例列表的单个列表，例如：\n\"[[v1,m1,k1],[v2,m2,k2],[v3,m3,k3]]\"\n所有值必须四舍五入到六位小数，TKE 的单位为 $\\mathrm{m^2\\,s^{-2}}$，另外两个度量为无量纲。",
            "solution": "该问题要求从离散的单元中心数据中推导和计算可压缩流体动力学流动的三个诊断度量。这些度量是质量加权标量方差、质量加权混合分数和单位质量湍动能。推导将从均匀网格上离散数据的密度加权（Favre）平均的基本定义开始。\n\n设计算域由 $N$ 个单元组成，索引为 $i = 1, \\dots, N$。为每个单元提供的量是密度 $\\rho_i$、速度分量 $u_{x,i}$ 和 $u_{y,i}$，以及无源标量质量分数 $Y_i$。由于网格是均匀的，每个单元具有相同的体积 $V$。单元 $i$ 中的质量为 $m_i = \\rho_i V$。\n\n域上的总质量为 $M_{tot} = \\sum_{i=1}^{N} m_i = \\sum_{i=1}^{N} \\rho_i V = V \\sum_{i=1}^{N} \\rho_i$。\n\n任意物理量 $\\phi$ 的质量加权或 Favre 平均定义为 $\\rho \\phi$ 在整个域上的积分除以总质量。对于离散网格，这变为：\n$$ \\widetilde{\\phi} = \\frac{\\sum_{i=1}^{N} \\phi_i m_i}{\\sum_{i=1}^{N} m_i} = \\frac{\\sum_{i=1}^{N} \\phi_i \\rho_i V}{\\sum_{i=1}^{N} \\rho_i V} = \\frac{\\sum_{i=1}^{N} \\rho_i \\phi_i}{\\sum_{i=1}^{N} \\rho_i} $$\n单元体积 $V$ 被消去，简化了表达式。此定义将用于所有必需的平均计算。\n\n### 度量 1：质量加权标量方差\n标量方差衡量标量场 $Y$ 的不均匀程度。对于可压缩流，它是使用 Favre 平均量来定义的。单元 $i$ 中标量的脉动是局部值与 Favre 平均值之差：$Y_i'' = Y_i - \\widetilde{Y}$。\n\n标量 $Y$ 的 Favre 平均为：\n$$ \\widetilde{Y} = \\frac{\\sum_{i=1}^{N} \\rho_i Y_i}{\\sum_{i=1}^{N} \\rho_i} $$\n质量加权方差 $\\sigma_Y^2$ 是脉动平方 $(Y'')^2$ 的 Favre 平均：\n$$ \\sigma_Y^2 = \\widetilde{(Y'')^2} = \\widetilde{(Y - \\widetilde{Y})^2} $$\n代入 Favre 平均的定义：\n$$ \\sigma_Y^2 = \\frac{\\sum_{i=1}^{N} \\rho_i (Y_i - \\widetilde{Y})^2}{\\sum_{i=1}^{N} \\rho_i} $$\n为便于计算，使用通过展开平方推导出的替代形式通常更稳定和高效：$\\widetilde{(Y - \\widetilde{Y})^2} = \\widetilde{Y^2 - 2Y\\widetilde{Y} + \\widetilde{Y}^2}$。根据平均算子的线性性质，这等于 $\\widetilde{Y^2} - 2\\widetilde{Y}\\widetilde{Y} + \\widetilde{Y}^2 = \\widetilde{Y^2} - (\\widetilde{Y})^2$。\n质量加权标量方差的最终离散表达式为：\n$$ \\sigma_Y^2 = \\frac{\\sum_{i=1}^{N} \\rho_i Y_i^2}{\\sum_{i=1}^{N} \\rho_i} - \\left( \\frac{\\sum_{i=1}^{N} \\rho_i Y_i}{\\sum_{i=1}^{N} \\rho_i} \\right)^2 $$\n由于 $Y_i$ 是无量纲的质量分数，因此该量是无量纲的。\n\n### 度量 2：质量加权混合分数\n这个度量 $M_\\delta$ 量化了处于“混合”状态的总质量的比例。如果单元 $i$ 的标量质量分数 $Y_i$ 严格介于容差 $\\delta$ 和 $1-\\delta$ 之间，即 $\\delta  Y_i  1 - \\delta$，则认为该单元是混合的。\n\n混合流体的总质量 $M_{mixed}$ 是满足此条件的所有单元的质量之和。\n$$ M_{mixed} = \\sum_{i \\text{ s.t. } \\delta  Y_i  1-\\delta} m_i = \\sum_{i=1}^{N} m_i \\cdot I(\\delta  Y_i  1-\\delta) $$\n其中 $I(\\cdot)$ 是指示函数，如果条件为真，则为 $1$，否则为 $0$。代入 $m_i = \\rho_i V$：\n$$ M_{mixed} = V \\sum_{i=1}^{N} \\rho_i \\cdot I(\\delta  Y_i  1-\\delta) $$\n混合分数是混合质量与总质量之比，$M_\\delta = M_{mixed} / M_{tot}$。\n$$ M_\\delta = \\frac{V \\sum_{i=1}^{N} \\rho_i \\cdot I(\\delta  Y_i  1-\\delta)}{V \\sum_{i=1}^{N} \\rho_i} = \\frac{\\sum_{i=1}^{N} \\rho_i \\cdot I(\\delta  Y_i  1-\\delta)}{\\sum_{i=1}^{N} \\rho_i} $$\n该度量是无量纲的质量比。\n\n### 度量 3：单位质量湍动能\n单位质量湍动能 (TKE) $k$ 是与速度脉动相关的动能。速度场 $\\mathbf{u}$ 被分解为其 Favre 平均部分 $\\widetilde{\\mathbf{u}}$ 和其脉动部分 $\\mathbf{u}''$：$\\mathbf{u}_i = \\widetilde{\\mathbf{u}} + \\mathbf{u}_i''$。\n\nFavre 平均速度分量为：\n$$ \\widetilde{u_x} = \\frac{\\sum_{i=1}^{N} \\rho_i u_{x,i}}{\\sum_{i=1}^{N} \\rho_i} \\quad \\text{和} \\quad \\widetilde{u_y} = \\frac{\\sum_{i=1}^{N} \\rho_i u_{y,i}}{\\sum_{i=1}^{N} \\rho_i} $$\n单位质量 TKE 定义为速度脉动大小平方的 Favre 平均值的一半：\n$$ k = \\frac{1}{2}\\widetilde{|\\mathbf{u}''|^2} = \\frac{1}{2}\\widetilde{(u_x''^2 + u_y''^2)} = \\frac{1}{2}\\left( \\widetilde{(u_x - \\widetilde{u_x})^2} + \\widetilde{(u_y - \\widetilde{u_y})^2} \\right) $$\n使用与标量方差相同的恒等式 $\\widetilde{(\\phi - \\widetilde{\\phi})^2} = \\widetilde{\\phi^2} - (\\widetilde{\\phi})^2$，我们可以将 $k$ 写为：\n$$ k = \\frac{1}{2} \\left[ \\left( \\widetilde{u_x^2} - (\\widetilde{u_x})^2 \\right) + \\left( \\widetilde{u_y^2} - (\\widetilde{u_y})^2 \\right) \\right] $$\n代入 Favre 平均的离散定义，得到最终表达式：\n$$ k = \\frac{1}{2} \\left[ \\left( \\frac{\\sum \\rho_i u_{x,i}^2}{\\sum \\rho_i} - \\left(\\frac{\\sum \\rho_i u_{x,i}}{\\sum \\rho_i}\\right)^2 \\right) + \\left( \\frac{\\sum \\rho_i u_{y,i}^2}{\\sum \\rho_i} - \\left(\\frac{\\sum \\rho_i u_{y,i}}{\\sum \\rho_i}\\right)^2 \\right) \\right] $$\n$k$ 的单位是速度的平方，即 $\\mathrm{m^2\\,s^{-2}}$。\n\n现在可以实现这些推导出的表达式，以计算给定测试用例所需的度量。",
            "answer": "[[0.250000,0.000000,0.000000],[0.000000,1.000000,0.444444],[0.146800,0.500000,0.093750]]"
        },
        {
            "introduction": "数值模拟并非对现实的完美复刻，其本身会引入误差，例如数值扩散。本练习将引导你建立一个模型，用以描述开尔文-亥姆霍兹不稳定性的物理增长与数值格式带来的人为耗散之间的竞争关系。这项技能对于确保模拟结果反映真实的物理过程而非数值效应至关重要，尤其是在处理像剪切层这样的尖锐结构时。",
            "id": "3519421",
            "problem": "要求您形式化和量化在Kelvin-Helmholtz不稳定性数值模拟中，剪切层厚度与网格间距之比如何控制数值耗散以及网格尺度二次不稳定性的倾向。在基础剪切层的一维表示（具有双曲正切速度剖面）框架下进行研究，并考虑流向方向上的周期性扰动。您的目标是推导并实现一个定量模型，该模型将无粘Kelvin-Helmholtz增长与由有限体积通量离散化引起的等效数值粘性联系起来。然后，您必须在一组给定的参数测试套件上评估此模型，并以单一、标准化的输出格式报告特定的度量指标。\n\n从以下基本基础开始：\n- 在无粘极限下的质量和动量守恒。将基础状态视为两个密度相等的半无限流体，由一个名义厚度为$\\delta$的剪切层隔开，其速度剖面表示为$U(z) \\approx \\frac{\\Delta U}{2} \\tanh(z/\\delta)$，其中$\\Delta U$是跨越该层的速度差。\n- 对密度相等的涡片进行的经典无粘Kelvin-Helmholtz简正模态分析表明，流向波数为$k$的扰动会以与剪切成正比的速率发生指数级放大，并且当$\\delta \\to 0$时，系统趋近于涡片极限。\n- 对于采用类黎曼求解器通量分裂的保守有限体积格式，其数值耗散的线性标量模型，在网格间距$\\Delta x$的主导阶上，可以近似为一个等效的对流-扩散方程，其等效数值粘性为$\\nu_{\\mathrm{num}}$，该粘性与特征信号速度和网格间距线性相关。为解决此问题，将等效数值粘性建模为$\\nu_{\\mathrm{num}} = \\chi \\, a \\, \\Delta x$，其中$a$是方法的特征速度，$\\chi$是区间$(0,1]$内一个无量纲的、依赖于格式的系数。\n\n您的任务：\n1. 从第一性原理出发，为分隔两个速度差为$\\Delta U$的等密度流体的平面涡片，推导其无粘Kelvin-Helmholtz指数增长率$\\gamma_{\\mathrm{KH}}(k)$的公式。不要假定任何先验公式；使用线性化方程和适当的界面条件。\n2. 使用von Neumann分析方法，分析由保守单调通量离散化的线性对流，推导作用于波数为$k$的傅里叶模态上的等效扩散的主导阶形式，并证明对于小的$\\Delta x$，由数值耗散引起的衰减率为$\\sigma_{\\mathrm{num}}(k) = \\nu_{\\mathrm{num}} k^{2}$，其中$\\nu_{\\mathrm{num}}$按上述方式建模。\n3. 将前两个结果合并为一个净增长率模型$\\gamma_{\\mathrm{eff}}(k) = \\gamma_{\\mathrm{KH}}(k) - \\nu_{\\mathrm{num}} k^{2}$，该模型捕捉了无粘剪切放大和数值耗散之间的竞争。使用该模型定义以下诊断量：\n   - 主模态净增长率，在基本扰动波数$k_{\\mathrm{p}} = 2\\pi/L$处计算，其中$L$是给定的域长度：$\\gamma_{\\mathrm{eff}}(k_{\\mathrm{p}})$，以$\\mathrm{s}^{-1}$为单位表示。\n   - 无量纲的伪耗散-增长比$\\mathcal{S} = \\dfrac{\\nu_{\\mathrm{num}} \\, \\delta^{-2}}{\\gamma_{\\mathrm{KH}}(k_{\\mathrm{p}})}$，定义为在特征波数$k \\sim \\delta^{-1}$处的数值耗散阻尼率与在$k_{\\mathrm{p}}$处的无粘主模态Kelvin-Helmholtz增长率之比。该比率衡量了剪切层是否在主模态增长之前被人为地平滑。将$\\mathcal{S}$报告为无量纲浮点数。\n   - 网格尺度二次不稳定性倾向的二元指示符，通过评估在奈奎斯特波数$k_{\\mathrm{N}} = \\pi/\\Delta x$处$\\gamma_{\\mathrm{eff}}(k_{\\mathrm{N}})$的符号来定义。如果$\\gamma_{\\mathrm{eff}}(k_{\\mathrm{N}})  0$，则返回$1$（不稳定的网格尺度）；否则返回$0$（稳定的网格尺度）。\n\n使用以下参数集测试套件，每个测试用例以指定单位的六元组$(\\delta, \\Delta x, \\Delta U, L, a, \\chi)$形式给出：\n- 案例 $1$：$(\\delta, \\Delta x, \\Delta U, L, a, \\chi) = (8\\times 10^{-3}\\ \\mathrm{m}, 10^{-3}\\ \\mathrm{m}, 100\\ \\mathrm{m/s}, 0.1\\ \\mathrm{m}, 50\\ \\mathrm{m/s}, 0.5)$。\n- 案例 $2$：$(\\delta, \\Delta x, \\Delta U, L, a, \\chi) = (2\\times 10^{-3}\\ \\mathrm{m}, 10^{-3}\\ \\mathrm{m}, 100\\ \\mathrm{m/s}, 0.1\\ \\mathrm{m}, 50\\ \\mathrm{m/s}, 0.5)$。\n- 案例 $3$：$(\\delta, \\Delta x, \\Delta U, L, a, \\chi) = (5\\times 10^{-4}\\ \\mathrm{m}, 10^{-3}\\ \\mathrm{m}, 100\\ \\mathrm{m/s}, 0.1\\ \\mathrm{m}, 50\\ \\mathrm{m/s}, 0.5)$。\n- 案例 $4$：$(\\delta, \\Delta x, \\Delta U, L, a, \\chi) = (5\\times 10^{-4}\\ \\mathrm{m}, 10^{-3}\\ \\mathrm{m}, 100\\ \\mathrm{m/s}, 0.1\\ \\mathrm{m}, 50\\ \\mathrm{m/s}, 0.05)$。\n\n对于每个案例，计算并报告三元组$[\\gamma_{\\mathrm{eff}}(k_{\\mathrm{p}}), \\mathcal{S}, I_{\\mathrm{N}}]$，其中$\\gamma_{\\mathrm{eff}}(k_{\\mathrm{p}})$必须以$\\mathrm{s}^{-1}$表示并四舍五入到小数点后恰好六位，$\\mathcal{S}$必须四舍五入到小数点后恰好六位，而$I_{\\mathrm{N}} \\in \\{0,1\\}$是如上定义的整数指示符。\n\n您的程序应生成单行输出，其中包含所有案例的结果，形式为一个用方括号括起来的逗号分隔列表，并按顺序连接这些三元组。例如，对于结果为$(x_{1},y_{1},z_{1})$和$(x_{2},y_{2},z_{2})$的两个案例，输出格式必须完全为$[x_{1},y_{1},z_{1},x_{2},y_{2},z_{2}]$。\n\n所有物理量必须使用上述指定的单位。所有角度（如有）必须以弧度为单位。百分比必须表示为小数或分数，不得使用百分号。通过使用推导出的表达式和给定的等效数值粘性模型，确保科学真实性，除$\\chi$外，不得引入额外的经验拟合因子。",
            "solution": "该问题要求构建并应用一个模型，用以量化计算模拟中物理Kelvin-Helmholtz (KH)不稳定性与数值耗散之间的相互作用。该方法包括推导无粘增长率，将数值耗散建模为等效粘性，将二者合并为净增长率，并为一组给定的物理和数值参数评估特定的诊断量。\n\n第一个任务是推导涡片的无粘增长率$\\gamma_{\\mathrm{KH}}(k)$。涡片是剪切层厚度$\\delta \\to 0$时的极限情况。我们考虑两种密度相等（为$\\rho$）的半无限、无粘、不可压缩流体。在一个平均速度为零的参考系中，上层流体（$z>0$）以速度$U_1 = \\Delta U/2$运动，下层流体（$z0$）以速度$U_2 = -\\Delta U/2$运动，两者均沿$x$方向。\n\n我们通过引入小扰动来分析$z=0$处界面的稳定性。流场是无旋的，因此速度扰动可以表示为势函数$\\mathbf{u}' = \\nabla\\phi$的梯度。不可压缩性条件$\\nabla \\cdot \\mathbf{u} = 0$意味着扰动势满足拉普拉斯方程$\\nabla^2\\phi = 0$。我们寻找形式为$\\phi(x,z,t) = \\hat{\\phi}(z) e^{i(kx - \\omega t)}$的简正模解，以及界面垂直位移的解$\\eta(x,t) = \\hat{\\eta} e^{i(kx - \\omega t)}$。不稳定性的增长率由复频率的虚部给出，即$\\gamma = \\mathrm{Im}(\\omega)$。\n\n将简正模形式代入拉普拉斯方程，得到$\\frac{d^2\\hat{\\phi}}{dz^2} - k^2\\hat{\\phi} = 0$。在远离界面（$z \\to \\pm\\infty$）处保持有界的解为：\n$$\n\\hat{\\phi}_1(z) = A_1 e^{-|k|z} \\quad \\text{for } z0 \\\\\n\\hat{\\phi}_2(z) = A_2 e^{|k|z} \\quad \\text{for } z0\n$$\n此处我们不失一般性地假设$k0$，因此写作$|k|=k$。\n\n在扰动界面$z=\\eta$处应用两个边界条件：\n1. 运动学边界条件指出，界面上的流体质点始终停留在界面上。一阶近似下，这表示为$w' = \\frac{\\partial\\eta}{\\partial t} + U \\frac{\\partial\\eta}{\\partial x}$。由于$w' = \\frac{\\partial\\phi}{\\partial z}$，我们在$z=0$处有：\n    $$\n    \\frac{\\partial\\phi_1}{\\partial z} \\Big|_{z=0} = (-i\\omega + ikU_1)\\eta \\implies -kA_1 = i(kU_1 - \\omega)\\hat{\\eta}\n    $$\n    $$\n    \\frac{\\partial\\phi_2}{\\partial z} \\Big|_{z=0} = (-i\\omega + ikU_2)\\eta \\implies kA_2 = i(kU_2 - \\omega)\\hat{\\eta}\n    $$\n\n2. 动力学边界条件要求跨界面的压力是连续的（忽略表面张力）。压力扰动$p'$由线性化伯努利方程给出：$p' = -\\rho(\\frac{\\partial\\phi}{\\partial t} + U\\frac{\\partial\\phi}{\\partial x})$。令$z=0$处的压力相等：\n    $$\n    -\\rho(-i\\omega + ikU_1)\\hat{\\phi}_1(0) = -\\rho(-i\\omega + ikU_2)\\hat{\\phi}_2(0)\n    $$\n    $$\n    (kU_1 - \\omega)A_1 = (kU_2 - \\omega)A_2\n    $$\n\n我们现在得到了一个关于$A_1$、$A_2$和$\\hat{\\eta}$的线性齐次方程组。为了使非平凡解存在，系数行列式必须为零。或者，我们可以利用运动学条件，将$A_1$和$A_2$代入动力学条件中：\n$$\nA_1 = -\\frac{i\\hat{\\eta}}{k}(kU_1 - \\omega)\n$$\n$$\nA_2 = \\frac{i\\hat{\\eta}}{k}(kU_2 - \\omega)\n$$\n将这些代入动力学条件得到：\n$$\n(kU_1 - \\omega)\\left(-\\frac{i\\hat{\\eta}}{k}(kU_1 - \\omega)\\right) = (kU_2 - \\omega)\\left(\\frac{i\\hat{\\eta}}{k}(kU_2 - \\omega)\\right)\n$$\n假设存在非平凡扰动($\\hat{\\eta} \\neq 0$)，上式简化为色散关系：\n$$\n(kU_1 - \\omega)^2 + (kU_2 - \\omega)^2 = 0\n$$\n展开并求解关于$\\omega$的二次方程：\n$$\n2\\omega^2 - 2k(U_1+U_2)\\omega + k^2(U_1^2+U_2^2) = 0\n$$\n$$\n\\omega = \\frac{2k(U_1+U_2) \\pm \\sqrt{4k^2(U_1+U_2)^2 - 8k^2(U_1^2+U_2^2)}}{4}\n$$\n$$\n\\omega = k\\frac{U_1+U_2}{2} \\pm \\frac{k}{2}\\sqrt{(U_1+U_2)^2 - 2(U_1^2+U_2^2)} = k\\frac{U_1+U_2}{2} \\pm \\frac{k}{2}\\sqrt{-U_1^2+2U_1U_2-U_2^2}\n$$\n$$\n\\omega = k\\frac{U_1+U_2}{2} \\pm i \\frac{k}{2}\\sqrt{(U_1-U_2)^2} = k\\frac{U_1+U_2}{2} \\pm i \\frac{k}{2}|U_1-U_2|\n$$\n不稳定性增长率$\\gamma = \\mathrm{Im}(\\omega)$是正的虚部：\n$$\n\\gamma_{\\mathrm{KH}}(k) = \\frac{k}{2}|U_1-U_2|\n$$\n当$U_1=\\Delta U/2$且$U_2=-\\Delta U/2$时，我们有$|U_1-U_2| = |\\Delta U|$。因此，无粘增长率的最终表达式为：\n$$\n\\gamma_{\\mathrm{KH}}(k) = \\frac{k |\\Delta U|}{2}\n$$\n\n第二个任务是为数值耗散的影响建模。我们考虑在一维均匀网格（间距为$\\Delta x$）上离散化的一维线性对流方程$\\frac{\\partial u}{\\partial t} + a \\frac{\\partial u}{\\partial x} = 0$。一个保守的有限体积更新公式为$\\frac{du_j}{dt} = -\\frac{1}{\\Delta x}(F_{j+1/2} - F_{j-1/2})$。对于$a>0$的一阶迎风格式通量为$F_{j+1/2} = a u_j$，这得到了如下的半离散格式：\n$$\n\\frac{du_j}{dt} = -\\frac{a}{\\Delta x}(u_j - u_{j-1})\n$$\n我们通过代入傅里葉模态$u_j(t) = \\hat{u}(t)e^{ikj\\Delta x}$来进行von Neumann分析：\n$$\n\\frac{d\\hat{u}}{dt}e^{ikj\\Delta x} = -\\frac{a}{\\Delta x}(\\hat{u}e^{ikj\\Delta x} - \\hat{u}e^{ik(j-1)\\Delta x})\n$$\n$$\n\\frac{d\\hat{u}}{dt} = -\\frac{a}{\\Delta x}(1 - e^{-ik\\Delta x})\\hat{u} = \\hat{\\omega}(k)\\hat{u}\n$$\n该数值格式的复频率$\\hat{\\omega}(k)$为：\n$$\n\\hat{\\omega}(k) = -\\frac{a}{\\Delta x}(1 - \\cos(k\\Delta x) + i\\sin(k\\Delta x))\n$$\n$\\hat{\\omega}(k)$的实部决定了模态振幅的阻尼或增长。对于小的$k\\Delta x$，我们展开三角函数：$\\cos(z) \\approx 1-z^2/2$和$\\sin(z) \\approx z$。\n$$\n\\hat{\\omega}(k) \\approx -\\frac{a}{\\Delta x}\\left(\\frac{(k\\Delta x)^2}{2} + ik\\Delta x\\right) = -ik a - \\frac{a\\Delta x}{2}k^2\n$$\n虚部$-ika$对应于速度为$a$的对流。实部$-\\frac{a\\Delta x}{2}k^2$代表一个耗散衰减。衰减率为$\\sigma(k) = -\\mathrm{Re}(\\hat{\\omega}(k))$。这类似于物理扩散过程$\\frac{\\partial u}{\\partial t} = \\nu \\frac{\\partial^2 u}{\\partial x^2}$，该过程对于模态$e^{ikx}$给出的衰减率为$\\nu k^2$。通过比较，该数值格式具有等效数值粘性$\\nu_{\\mathrm{num}} = \\frac{a\\Delta x}{2}$。问题提供了一个广义模型$\\nu_{\\mathrm{num}} = \\chi a \\Delta x$，它通过系数$\\chi$来解释不同数值格式的影响。因此，由数值耗散引起的衰减率为：\n$$\n\\sigma_{\\mathrm{num}}(k) = \\nu_{\\mathrm{num}}k^2 = (\\chi a \\Delta x)k^2\n$$\n\n第三个任务是合并这些效应。净增长率$\\gamma_{\\mathrm{eff}}(k)$是无粘增长率减去数值衰减率：\n$$\n\\gamma_{\\mathrm{eff}}(k) = \\gamma_{\\mathrm{KH}}(k) - \\sigma_{\\mathrm{num}}(k) = \\frac{k|\\Delta U|}{2} - (\\chi a \\Delta x)k^2\n$$\n使用这个模型，我们定义所需的诊断量：\n1.  主模态净增长率在计算域的基本波数$k_{\\mathrm{p}} = 2\\pi/L$处进行评估：\n    $$\n    \\gamma_{\\mathrm{eff}}(k_{\\mathrm{p}}) = \\frac{k_{\\mathrm{p}}|\\Delta U|}{2} - \\chi a \\Delta x k_{\\mathrm{p}}^2\n    $$\n2.  伪耗散-增长比$\\mathcal{S}$，比较了在剪切层厚度$\\delta$尺度上（即波数$k \\sim \\delta^{-1}$处）的数值耗散率与主模态的无粘增长率：\n    $$\n    \\mathcal{S} = \\frac{\\nu_{\\mathrm{num}}\\delta^{-2}}{\\gamma_{\\mathrm{KH}}(k_{\\mathrm{p}})} = \\frac{\\chi a \\Delta x / \\delta^2}{k_{\\mathrm{p}}|\\Delta U|/2}\n    $$\n3.  网格尺度二次不稳定性倾向$I_{\\mathrm{N}}$，由在奈奎斯特波数$k_{\\mathrm{N}} = \\pi/\\Delta x$（代表网格可分辨的最高频率）处的净增长率的符号决定：\n    $$\n    I_{\\mathrm{N}} = \\begin{cases} 1  \\text{if } \\gamma_{\\mathrm{eff}}(k_{\\mathrm{N}})  0 \\\\ 0  \\text{if } \\gamma_{\\mathrm{eff}}(k_{\\mathrm{N}}) \\le 0 \\end{cases} \\quad \\text{where} \\quad \\gamma_{\\mathrm{eff}}(k_{\\mathrm{N}}) = \\frac{k_{\\mathrm{N}}|\\Delta U|}{2} - \\chi a \\Delta x k_{\\mathrm{N}}^2\n    $$\n\n现在将这些推导出的公式应用于提供的参数测试套件，以计算指定的物理和数值度量。",
            "answer": "[3042.896610,0.124341,0,3042.896610,1.989437,0,3042.896610,31.830989,0,3131.723049,3.183099,1]"
        }
    ]
}