{
    "hands_on_practices": [
        {
            "introduction": "The choice of a particle's \"shape\" is a foundational concept in the Particle-in-Cell (PIC) method, directly influencing how particle data is interpolated to and from the computational grid. This practice provides a quantitative look at spectral aliasing, a numerical artifact that arises from this grid-based representation. By deriving the properties of common shape functions and comparing the alias noise generated by Cloud-In-Cell (CIC) and Triangular-Shaped Cloud (TSC) schemes, you will develop a deeper understanding of the trade-offs between computational simplicity and numerical accuracy in the core PIC algorithm .",
            "id": "3529046",
            "problem": "Consider a one-dimensional Particle-In-Cell (PIC) density assignment onto a uniform grid of spacing $\\Delta x$ for a spatially uniform Poisson particle distribution of mean density. Let the particle-to-grid assignment use the order-$m$ cardinal $B$-spline shape function constructed by convolving $m+1$ identical unit-area top-hat functions of width $\\Delta x$. Denote by $S_{m}(k)$ the Fourier transform (with the convention that convolution in real space corresponds to multiplication in Fourier space) of the assignment shape, normalized such that $S_{m}(0)=1$. The discrete sampling by the grid produces spectral aliasing: the expected shot-noise contribution to the assigned grid density power at a resolved wavenumber $k$ is proportional to the sum over all integer aliases $p \\in \\mathbb{Z}$ of $\\left|S_{m}\\!\\left(k + \\frac{2\\pi p}{\\Delta x}\\right)\\right|^{2}$. \n\nStarting only from the definitions above, and using the convolution theorem and basic Fourier properties of the unit-area top-hat, do the following:\n\n1) Derive a closed-form expression for $S_{m}(k)$ in terms of $k$ and $\\Delta x$.\n\n2) Using the result of part (1) and assuming that only the first pair of aliases ($p=\\pm 1$) contribute appreciably to the alias power, define the first-alias power at mode $k$ as\n$$\nA_{m}^{(1)}(k) \\propto \\left|S_{m}\\!\\left(k + \\frac{2\\pi}{\\Delta x}\\right)\\right|^{2} + \\left|S_{m}\\!\\left(k - \\frac{2\\pi}{\\Delta x}\\right)\\right|^{2}.\n$$\nEvaluate the dimensionless ratio\n$$\nR \\equiv \\frac{A_{1}^{(1)}(k_{N}/2)}{A_{2}^{(1)}(k_{N}/2)},\n$$\nwhere $k_{N} \\equiv \\pi/\\Delta x$ is the Nyquist wavenumber, and $m=1$ corresponds to Cloud-In-Cell (CIC) while $m=2$ corresponds to Triangular-Shaped Cloud (TSC).\n\nExpress the final answer for $R$ as a pure number, rounded to four significant figures. No units are required for $R$.",
            "solution": "The problem has been validated and is a well-posed, scientifically grounded question in computational astrophysics. We shall proceed with a complete solution.\n\nThe problem is divided into two parts. First, we must derive the closed-form expression for the Fourier transform of the order-$m$ cardinal $B$-spline shape function, denoted $S_m(k)$. Second, we must use this result to compute a specific ratio $R$ of alias powers for two different spline orders.\n\n### Part 1: Derivation of $S_m(k)$\n\nThe order-$m$ cardinal $B$-spline shape function, let's call it $W_m(x)$, is defined as the convolution of $m+1$ identical unit-area top-hat functions of width $\\Delta x$. Let us define the centered top-hat function, $\\Pi(x)$, as:\n$$\n\\Pi(x) =\n\\begin{cases}\n    \\frac{1}{\\Delta x}  \\text{if } |x| \\le \\frac{\\Delta x}{2} \\\\\n    0  \\text{otherwise}\n\\end{cases}\n$$\nBy construction, the area under $\\Pi(x)$ is $\\int_{-\\infty}^{\\infty} \\Pi(x) dx = \\frac{1}{\\Delta x} \\times \\Delta x = 1$.\n\nThe shape function $W_m(x)$ is the $(m+1)$-fold convolution of $\\Pi(x)$ with itself:\n$$\nW_m(x) = \\underbrace{(\\Pi * \\Pi * \\dots * \\Pi)(x)}_{m+1 \\text{ times}}\n$$\nwhere $*$ denotes the convolution operator.\n\nThe problem asks for $S_m(k)$, the Fourier transform of $W_m(x)$. We utilize the convolution theorem, which states that the Fourier transform of a convolution of functions is the product of their individual Fourier transforms. Let $\\hat{\\Pi}(k)$ be the Fourier transform of $\\Pi(x)$. Then,\n$$\nS_m(k) = \\mathcal{F}[W_m(x)](k) = \\left( \\mathcal{F}[\\Pi(x)](k) \\right)^{m+1} = (\\hat{\\Pi}(k))^{m+1}\n$$\nWe compute $\\hat{\\Pi}(k)$ using the definition of the Fourier transform, $\\mathcal{F}[f(x)](k) = \\int_{-\\infty}^{\\infty} f(x) e^{-ikx} dx$:\n$$\n\\hat{\\Pi}(k) = \\int_{-\\infty}^{\\infty} \\Pi(x) e^{-ikx} dx = \\int_{-\\Delta x/2}^{\\Delta x/2} \\frac{1}{\\Delta x} e^{-ikx} dx\n$$\n$$\n\\hat{\\Pi}(k) = \\frac{1}{\\Delta x} \\left[ \\frac{e^{-ikx}}{-ik} \\right]_{-\\Delta x/2}^{\\Delta x/2} = \\frac{1}{-ik\\Delta x} \\left( e^{-ik\\Delta x/2} - e^{ik\\Delta x/2} \\right)\n$$\nUsing Euler's formula, $e^{i\\theta} - e^{-i\\theta} = 2i\\sin(\\theta)$, we get:\n$$\n\\hat{\\Pi}(k) = \\frac{1}{ik\\Delta x} \\left( e^{ik\\Delta x/2} - e^{-ik\\Delta x/2} \\right) = \\frac{1}{ik\\Delta x} \\left( 2i\\sin\\left(\\frac{k\\Delta x}{2}\\right) \\right) = \\frac{2\\sin(k\\Delta x/2)}{k\\Delta x}\n$$\nThis expression is commonly written using the normalized sinc function, $\\text{sinc}(\\theta) = \\sin(\\theta)/\\theta$. Thus,\n$$\n\\hat{\\Pi}(k) = \\frac{\\sin(k\\Delta x/2)}{k\\Delta x/2} = \\text{sinc}\\left(\\frac{k\\Delta x}{2}\\right)\n$$\nThe problem specifies the normalization $S_m(0)=1$. Let's check this: $\\hat{\\Pi}(0) = \\lim_{k\\to 0} \\text{sinc}(k\\Delta x/2) = 1$. Therefore, $S_m(0) = (\\hat{\\Pi}(0))^{m+1} = 1^{m+1} = 1$, which is consistent.\n\nSubstituting the expression for $\\hat{\\Pi}(k)$ back into the equation for $S_m(k)$, we obtain the final closed-form expression for the shape factor:\n$$\nS_m(k) = \\left( \\text{sinc}\\left(\\frac{k\\Delta x}{2}\\right) \\right)^{m+1} = \\left( \\frac{\\sin(k\\Delta x/2)}{k\\Delta x/2} \\right)^{m+1}\n$$\n\n### Part 2: Evaluation of the Ratio $R$\n\nThe problem defines the first-alias power at mode $k$ as:\n$$\nA_{m}^{(1)}(k) \\propto \\left|S_{m}\\!\\left(k + \\frac{2\\pi}{\\Delta x}\\right)\\right|^{2} + \\left|S_{m}\\!\\left(k - \\frac{2\\pi}{\\Delta x}\\right)\\right|^{2}\n$$\nWe need to evaluate the ratio $R = A_{1}^{(1)}(k_{N}/2) / A_{2}^{(1)}(k_{N}/2)$, where $m=1$ is CIC, $m=2$ is TSC, and the Nyquist wavenumber is $k_N = \\pi/\\Delta x$. The evaluation wavenumber is $k = k_N/2 = \\frac{\\pi}{2\\Delta x}$.\n\nSince the ratio $R$ is independent of the proportionality constant, we can write:\n$$\nR = \\frac{\\left|S_{1}\\!\\left(\\frac{k_N}{2} + \\frac{2\\pi}{\\Delta x}\\right)\\right|^{2} + \\left|S_{1}\\!\\left(\\frac{k_N}{2} - \\frac{2\\pi}{\\Delta x}\\right)\\right|^{2}}{\\left|S_{2}\\!\\left(\\frac{k_N}{2} + \\frac{2\\pi}{\\Delta x}\\right)\\right|^{2} + \\left|S_{2}\\!\\left(\\frac{k_N}{2} - \\frac{2\\pi}{\\Delta x}\\right)\\right|^{2}}\n$$\nLet's evaluate the arguments of $S_m$. The alias wavenumbers are $k_{\\pm} = \\frac{k_N}{2} \\pm \\frac{2\\pi}{\\Delta x}$. Substituting $k_N = \\pi/\\Delta x$, we have $\\frac{2\\pi}{\\Delta x} = 2k_N$.\n$$\nk_+ = \\frac{k_N}{2} + 2k_N = \\frac{5}{2}k_N = \\frac{5\\pi}{2\\Delta x}\n$$\n$$\nk_- = \\frac{k_N}{2} - 2k_N = -\\frac{3}{2}k_N = -\\frac{3\\pi}{2\\Delta x}\n$$\nThe argument of the sinc function in $S_m(k)$ is $\\frac{k\\Delta x}{2}$. For the alias wavenumbers $k_{\\pm}$, the arguments are:\n$$\n\\frac{k_+\\Delta x}{2} = \\frac{(5\\pi/2\\Delta x)\\Delta x}{2} = \\frac{5\\pi}{4}\n$$\n$$\n\\frac{k_-\\Delta x}{2} = \\frac{(-3\\pi/2\\Delta x)\\Delta x}{2} = -\\frac{3\\pi}{4}\n$$\nNow we evaluate the sinc function at these values:\n$$\n\\text{sinc}\\left(\\frac{5\\pi}{4}\\right) = \\frac{\\sin(5\\pi/4)}{5\\pi/4} = \\frac{-1/\\sqrt{2}}{5\\pi/4} = -\\frac{4}{5\\pi\\sqrt{2}}\n$$\n$$\n\\text{sinc}\\left(-\\frac{3\\pi}{4}\\right) = \\frac{\\sin(-3\\pi/4)}{-3\\pi/4} = \\frac{-1/\\sqrt{2}}{-3\\pi/4} = \\frac{4}{3\\pi\\sqrt{2}}\n$$\nSince the shape factor $S_m(k)$ is real for real arguments, $|S_m(k)|^2 = (S_m(k))^2$.\nFor $m=1$ (CIC), $S_1(k) = (\\text{sinc}(\\frac{k\\Delta x}{2}))^2$. The alias power is:\n$$\nA_1^{(1)}(k_N/2) \\propto \\left(S_1(k_+)\\right)^2 + \\left(S_1(k_-)\\right)^2 = \\left(\\left(\\text{sinc}\\left(\\frac{5\\pi}{4}\\right)\\right)^2\\right)^2 + \\left(\\left(\\text{sinc}\\left(-\\frac{3\\pi}{4}\\right)\\right)^2\\right)^2\n$$\n$$\nA_1^{(1)}(k_N/2) \\propto \\left(-\\frac{4}{5\\pi\\sqrt{2}}\\right)^4 + \\left(\\frac{4}{3\\pi\\sqrt{2}}\\right)^4 = \\left(\\frac{256}{625 \\times 4\\pi^4}\\right) + \\left(\\frac{256}{81 \\times 4\\pi^4}\\right) = \\frac{64}{\\pi^4}\\left(\\frac{1}{625} + \\frac{1}{81}\\right)\n$$\nFor $m=2$ (TSC), $S_2(k) = (\\text{sinc}(\\frac{k\\Delta x}{2}))^3$. The alias power is:\n$$\nA_2^{(1)}(k_N/2) \\propto \\left(S_2(k_+)\\right)^2 + \\left(S_2(k_-)\\right)^2 = \\left(\\left(\\text{sinc}\\left(\\frac{5\\pi}{4}\\right)\\right)^3\\right)^2 + \\left(\\left(\\text{sinc}\\left(-\\frac{3\\pi}{4}\\right)\\right)^3\\right)^2\n$$\n$$\nA_2^{(1)}(k_N/2) \\propto \\left(-\\frac{4}{5\\pi\\sqrt{2}}\\right)^6 + \\left(\\frac{4}{3\\pi\\sqrt{2}}\\right)^6 = \\frac{4096}{8\\pi^6}\\left(\\frac{1}{5^6} + \\frac{1}{3^6}\\right) = \\frac{512}{\\pi^6}\\left(\\frac{1}{15625} + \\frac{1}{729}\\right)\n$$\nNow we compute the ratio $R$:\n$$\nR = \\frac{A_1^{(1)}}{A_2^{(1)}} = \\frac{\\frac{64}{\\pi^4}\\left(\\frac{1}{625} + \\frac{1}{81}\\right)}{\\frac{512}{\\pi^6}\\left(\\frac{1}{15625} + \\frac{1}{729}\\right)} = \\frac{64}{512} \\pi^2 \\frac{\\frac{81+625}{625 \\times 81}}{\\frac{729+15625}{15625 \\times 729}}\n$$\n$$\nR = \\frac{\\pi^2}{8} \\frac{\\frac{706}{50625}}{\\frac{16354}{11390625}} = \\frac{\\pi^2}{8} \\frac{706}{50625} \\frac{11390625}{16354}\n$$\nSince $11390625 / 50625 = 225$, the expression simplifies to:\n$$\nR = \\frac{\\pi^2}{8} \\frac{706 \\times 225}{16354}\n$$\nNow we substitute the numerical value for $\\pi \\approx 3.14159265$:\n$$\nR = \\frac{\\pi^2}{8} \\frac{158850}{16354} \\approx \\frac{9.8696044}{8} \\times 9.7132199 \\approx 1.23370055 \\times 9.7132199 \\approx 11.982141\n$$\nRounding to four significant figures, we get $11.98$.",
            "answer": "$$\n\\boxed{11.98}\n$$"
        },
        {
            "introduction": "Explicit PIC simulations of relativistic phenomena are often constrained by the Courant-Friedrichs-Lewy (CFL) condition, which limits the time step based on the speed of light, making some problems computationally expensive. The \"reduced speed-of-light\" approximation is a practical technique used to relax this constraint, but it does not come for free. This exercise challenges you to quantify the physical errors introduced by this approximation in two important astrophysical contexts: magnetic reconnection outflows and magnetosonic shocks . Through this hands-on coding problem, you will gain a crucial understanding of the validity and consequences of this widely used computational shortcut.",
            "id": "3529033",
            "problem": "You are asked to quantify the impact of using the reduced speed-of-light approximation in Particle-In-Cell (PIC) methods for plasmas within computational astrophysics. The reduced speed-of-light approximation replaces the true speed of light $c$ with a smaller value $c_{\\mathrm{red}}$ to relax time step constraints, but can modify signal speeds and coupling between fields and particles. Quantify the resulting errors in two physically relevant diagnostics: reconnection outflow speed and one-dimensional perpendicular fast magnetosonic shock compression ratio, relative to the baseline using the full speed of light $c$.\n\nStart from the following foundational laws and well-tested facts:\n- The Lorentz force and Maxwell equations imply finite signal propagation in plasma, bounded by the speed of light $c$.\n- In relativistic magnetohydrodynamics (RMHD) for a pair plasma with mass per particle $m$, magnetic field magnitude $B$ in $\\mathrm{Tesla}$, number density $n$ in $\\mathrm{m^{-3}}$, and the vacuum permeability $\\mu_0$, the magnetization parameter is $\\sigma = \\frac{B^2}{\\mu_0 n m c^2}$. The corresponding relativistic Alfvén speed is $v_{\\mathrm{A}}(c) = c \\sqrt{\\frac{\\sigma}{1+\\sigma}}$.\n- The relativistic sound speed for an ideal gas with adiabatic index $\\gamma$ and upstream pressure $p$ in $\\mathrm{Pascal}$ and mass density $\\rho = n m$ in $\\mathrm{kg/m^3}$ is $a_s(c) = c \\sqrt{\\frac{\\gamma p}{\\rho c^2 + \\frac{\\gamma}{\\gamma - 1} p}}$. This follows from the definition of relativistic enthalpy density $w = \\rho c^2 + \\frac{\\gamma}{\\gamma - 1} p$.\n- For perpendicular propagation in RMHD, an approximate fast magnetosonic speed is $v_{\\mathrm{ms}}^2(c) = a_s^2(c) + v_{\\mathrm{A}}^2(c) - \\frac{a_s^2(c)\\, v_{\\mathrm{A}}^2(c)}{c^2}$. This expression reduces correctly in limiting cases and is widely used as a closure for characteristic speeds.\n- In compressible gas dynamics, a commonly used shock compression ratio formula in terms of the upstream Mach number $M$ is $r(M,\\gamma) = \\frac{(\\gamma + 1) M^2}{(\\gamma - 1) M^2 + 2}$. Here $M = \\frac{u_1}{v_{\\mathrm{ms}}}$ with upstream flow speed $u_1$ relative to the shock normal, in $\\mathrm{m/s}$. This formula provides a robust estimate used in numerical solvers and is taken here as the diagnostic definition.\n\nDefine the two diagnostics and their errors as follows:\n- Reconnection outflow speed diagnostic: $v_{\\mathrm{out,true}} = v_{\\mathrm{A}}(c)$, and in a reduced speed-of-light PIC discretization the outflow cannot exceed $c_{\\mathrm{red}}$, so adopt $v_{\\mathrm{out,red}} = \\min\\!\\left(v_{\\mathrm{A}}(c), c_{\\mathrm{red}}\\right)$. The relative error is $\\varepsilon_{\\mathrm{out}} = \\frac{v_{\\mathrm{out,red}} - v_{\\mathrm{out,true}}}{v_{\\mathrm{out,true}}}$, which is dimensionless and should be reported as a decimal (not a percentage).\n- Shock compression ratio diagnostic: $v_{\\mathrm{ms,true}}$ uses $c$ everywhere, while the reduced approximation consistently replaces $c$ by $c_{\\mathrm{red}}$ in the definitions of $\\sigma$, $v_{\\mathrm{A}}$, and $a_s$. That is, $\\sigma_{\\mathrm{red}} = \\frac{B^2}{\\mu_0 n m c_{\\mathrm{red}}^2}$, $v_{\\mathrm{A,red}} = c_{\\mathrm{red}} \\sqrt{\\frac{\\sigma_{\\mathrm{red}}}{1+\\sigma_{\\mathrm{red}}}}$, and $a_{s,\\mathrm{red}} = c_{\\mathrm{red}} \\sqrt{\\frac{\\gamma p}{\\rho c_{\\mathrm{red}}^2 + \\frac{\\gamma}{\\gamma - 1} p}}$. Then $v_{\\mathrm{ms,red}}^2 = a_{s,\\mathrm{red}}^2 + v_{\\mathrm{A,red}}^2 - \\frac{a_{s,\\mathrm{red}}^2\\, v_{\\mathrm{A,red}}^2}{c_{\\mathrm{red}}^2}$. The corresponding Mach numbers are $M_{\\mathrm{true}} = \\frac{u_1}{v_{\\mathrm{ms,true}}}$ and $M_{\\mathrm{red}} = \\frac{u_1}{v_{\\mathrm{ms,red}}}$, and compression ratios $r_{\\mathrm{true}} = r(M_{\\mathrm{true}},\\gamma)$, $r_{\\mathrm{red}} = r(M_{\\mathrm{red}},\\gamma)$. The relative error is $\\varepsilon_r = \\frac{r_{\\mathrm{red}} - r_{\\mathrm{true}}}{r_{\\mathrm{true}}}$, dimensionless and to be reported as a decimal.\n\nImplement a program that, for each test case, computes and reports the pair $(\\varepsilon_{\\mathrm{out}}, \\varepsilon_r)$ according to the definitions above. Use the following physical constants and test suite. All inputs are in International System of Units (SI), and any outputs are unitless decimals:\n- Speed of light: $c = 2.99792458 \\times 10^8\\,\\mathrm{m/s}$.\n- Vacuum permeability: $\\mu_0 = 4 \\pi \\times 10^{-7}\\,\\mathrm{H/m}$.\n\nTest suite parameter sets (each tuple is $(B, n, m, p, u_1, \\gamma, c_{\\mathrm{red}})$):\n1. $(0.01\\,\\mathrm{T}, 10^{16}\\,\\mathrm{m^{-3}}, 9.10938356 \\times 10^{-31}\\,\\mathrm{kg}, 0.01\\, n m c^2\\,\\mathrm{Pa}, 0.6\\, c, \\frac{4}{3}, 0.7\\, c)$.\n2. $(0.5\\,\\mathrm{T}, 10^{15}\\,\\mathrm{m^{-3}}, 9.10938356 \\times 10^{-31}\\,\\mathrm{kg}, 0.001\\, n m c^2\\,\\mathrm{Pa}, 0.9\\, c, \\frac{4}{3}, 0.5\\, c)$.\n3. $(0.001\\,\\mathrm{T}, 10^{16}\\,\\mathrm{m^{-3}}, 9.10938356 \\times 10^{-31}\\,\\mathrm{kg}, 0.05\\, n m c^2\\,\\mathrm{Pa}, 0.2\\, c, \\frac{4}{3}, 0.2\\, c)$.\n4. $(0.1\\,\\mathrm{T}, 10^{15}\\,\\mathrm{m^{-3}}, 9.10938356 \\times 10^{-31}\\,\\mathrm{kg}, 0.02\\, n m c^2\\,\\mathrm{Pa}, 0.5\\, c, \\frac{4}{3}, c)$.\n5. $(0.3\\,\\mathrm{T}, 10^{15}\\,\\mathrm{m^{-3}}, 9.10938356 \\times 10^{-31}\\,\\mathrm{kg}, 0.005\\, n m c^2\\,\\mathrm{Pa}, 0.8\\, c, \\frac{4}{3}, 0.1\\, c)$.\n\nNotes:\n- In each tuple, expressions like $0.01\\, n m c^2\\,\\mathrm{Pa}$ denote that the pressure $p$ is $0.01 \\times n \\times m \\times c^2$ in $\\mathrm{Pa}$.\n- The plasma is a pair plasma for which the mass per charge carrier is taken as $m$; the mass density is $\\rho = n m$ and the adiabatic index is $\\gamma = \\frac{4}{3}$, consistent with a relativistic ideal gas closure.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, ordered as $[\\varepsilon_{\\mathrm{out},1}, \\varepsilon_{r,1}, \\varepsilon_{\\mathrm{out},2}, \\varepsilon_{r,2}, \\ldots, \\varepsilon_{\\mathrm{out},5}, \\varepsilon_{r,5}]$, with each entry a floating-point decimal number.",
            "solution": "The provided problem is valid. It is scientifically grounded in the principles of relativistic magnetohydrodynamics (RMHD), well-posed with all necessary information provided, and objective in its formulation. The task is to quantify the error introduced by the reduced speed-of-light approximation, a genuine technique in computational plasma physics, on two key physical diagnostics. This is a well-defined and substantive problem.\n\nThe solution proceeds by first calculating the true values of the diagnostics using the speed of light $c$, and then calculating the corresponding values using the reduced speed of light $c_{\\mathrm{red}}$. The relative error is then computed for each diagnostic.\n\n### Governing Equations and Definitions\n\nThe problem is based on the following set of equations from RMHD, which serve as the foundation for our calculations.\nThe physical constants used are the speed of light, $c = 2.99792458 \\times 10^8\\,\\mathrm{m/s}$, and the vacuum permeability, $\\mu_0 = 4 \\pi \\times 10^{-7}\\,\\mathrm{H/m}$.\n\nFor a plasma with magnetic field magnitude $B$, number density $n$, and mass per particle $m$, the mass density is $\\rho = n m$.\n\n1.  **Magnetization Parameter ($\\sigma$)**: This dimensionless parameter measures the magnetic energy density relative to the rest mass energy density.\n    $$ \\sigma = \\frac{B^2}{\\mu_0 n m c^2} $$\n\n2.  **Relativistic Alfvén Speed ($v_{\\mathrm{A}}$)**: This is the characteristic speed of magnetic field perturbations.\n    $$ v_{\\mathrm{A}}(c) = c \\sqrt{\\frac{\\sigma}{1+\\sigma}} $$\n\n3.  **Relativistic Sound Speed ($a_s$)**: This is the speed of longitudinal pressure waves. For an ideal gas with adiabatic index $\\gamma$ and pressure $p$, it is given by:\n    $$ a_s(c) = c \\sqrt{\\frac{\\gamma p}{\\rho c^2 + \\frac{\\gamma}{\\gamma - 1} p}} $$\n\n4.  **Perpendicular Fast Magnetosonic Speed ($v_{\\mathrm{ms}}$)**: This is the speed of the fastest wave propagating perpendicular to the magnetic field.\n    $$ v_{\\mathrm{ms}}^2(c) = a_s^2(c) + v_{\\mathrm{A}}^2(c) - \\frac{a_s^2(c) v_{\\mathrm{A}}^2(c)}{c^2} $$\n\n5.  **Shock Compression Ratio ($r$)**: For a shock with upstream Mach number $M = u_1/v_{\\mathrm{ms}}$, where $u_1$ is the upstream flow speed, the compression ratio is defined as:\n    $$ r(M,\\gamma) = \\frac{(\\gamma + 1) M^2}{(\\gamma - 1) M^2 + 2} $$\n\n### Error Calculation Methodology\n\nFor each test case, we compute two relative errors: $\\varepsilon_{\\mathrm{out}}$ for the reconnection outflow speed and $\\varepsilon_r$ for the shock compression ratio.\n\n#### 1. Reconnection Outflow Speed Error ($\\varepsilon_{\\mathrm{out}}$)\n\nThe reconnection outflow is modeled by the Alfvén speed.\n- The **true outflow speed** is the relativistic Alfvén speed calculated with the true speed of light, $c$:\n  $$ v_{\\mathrm{out,true}} = v_{\\mathrm{A}}(c) = c \\sqrt{\\frac{\\sigma_{\\mathrm{true}}}{1+\\sigma_{\\mathrm{true}}}}, \\quad \\text{where} \\quad \\sigma_{\\mathrm{true}} = \\frac{B^2}{\\mu_0 n m c^2} $$\n- In a simulation with a reduced speed of light, $c_{\\mathrm{red}}$, the maximum speed any signal can propagate is $c_{\\mathrm{red}}$. Therefore, the **approximated outflow speed** is capped by $c_{\\mathrm{red}}$:\n  $$ v_{\\mathrm{out,red}} = \\min(v_{\\mathrm{out,true}}, c_{\\mathrm{red}}) $$\n- The **relative error** is then:\n  $$ \\varepsilon_{\\mathrm{out}} = \\frac{v_{\\mathrm{out,red}} - v_{\\mathrm{out,true}}}{v_{\\mathrm{out,true}}} $$\n  This error will be non-zero only if the true Alfvén speed exceeds the reduced speed of light ($v_{\\mathrm{A}}(c) > c_{\\mathrm{red}}$).\n\n#### 2. Shock Compression Ratio Error ($\\varepsilon_r$)\n\nThe calculation of this error requires computing the compression ratio $r$ in two separate scenarios: one using the true speed of light $c$ (the \"true\" path) and one consistently using the reduced speed of light $c_{\\mathrm{red}}$ (the \"reduced\" path).\n\n**True Path (using $c$):**\n1.  Calculate the true Alfvén speed, $v_{\\mathrm{A,true}} = v_{\\mathrm{A}}(c)$, as above.\n2.  Calculate the true sound speed, $a_{s,\\mathrm{true}} = a_s(c)$:\n    $$ a_{s,\\mathrm{true}} = c \\sqrt{\\frac{\\gamma p}{\\rho c^2 + \\frac{\\gamma}{\\gamma - 1} p}} $$\n3.  Calculate the true fast magnetosonic speed, $v_{\\mathrm{ms,true}}$:\n    $$ v_{\\mathrm{ms,true}}^2 = a_{s,\\mathrm{true}}^2 + v_{\\mathrm{A,true}}^2 - \\frac{a_{s,\\mathrm{true}}^2 v_{\\mathrm{A,true}}^2}{c^2} $$\n4.  Calculate the true Mach number, $M_{\\mathrm{true}} = u_1 / v_{\\mathrm{ms,true}}$. Note that the upstream parameters $u_1$ and $p$ are fixed inputs for both paths.\n5.  Calculate the true compression ratio, $r_{\\mathrm{true}} = r(M_{\\mathrm{true}}, \\gamma)$.\n\n**Reduced Path (using $c_{\\mathrm{red}}$):**\n1.  Calculate the reduced magnetization parameter $\\sigma_{\\mathrm{red}}$:\n    $$ \\sigma_{\\mathrm{red}} = \\frac{B^2}{\\mu_0 n m c_{\\mathrm{red}}^2} $$\n2.  Calculate the reduced Alfvén speed, $v_{\\mathrm{A,red}} = v_{\\mathrm{A}}(c_{\\mathrm{red}})$:\n    $$ v_{\\mathrm{A,red}} = c_{\\mathrm{red}} \\sqrt{\\frac{\\sigma_{\\mathrm{red}}}{1+\\sigma_{\\mathrm{red}}}} $$\n3.  Calculate the reduced sound speed, $a_{s,\\mathrm{red}} = a_s(c_{\\mathrm{red}})$:\n    $$ a_{s,\\mathrm{red}} = c_{\\mathrm{red}} \\sqrt{\\frac{\\gamma p}{\\rho c_{\\mathrm{red}}^2 + \\frac{\\gamma}{\\gamma - 1} p}} $$\n4.  Calculate the reduced fast magnetosonic speed, $v_{\\mathrm{ms,red}}$:\n    $$ v_{\\mathrm{ms,red}}^2 = a_{s,\\mathrm{red}}^2 + v_{\\mathrm{A,red}}^2 - \\frac{a_{s,\\mathrm{red}}^2 v_{\\mathrm{A,red}}^2}{c_{\\mathrm{red}}^2} $$\n5.  Calculate the reduced Mach number, $M_{\\mathrm{red}} = u_1 / v_{\\mathrm{ms,red}}$.\n6.  Calculate the reduced compression ratio, $r_{\\mathrm{red}} = r(M_{\\mathrm{red}}, \\gamma)$.\n\n**Relative Error Calculation:**\nFinally, the relative error in the compression ratio is computed as:\n$$ \\varepsilon_r = \\frac{r_{\\mathrm{red}} - r_{\\mathrm{true}}}{r_{\\mathrm{true}}} $$\n\nBy implementing these steps for each parameter set provided in the test suite, we can quantify the impact of the reduced speed-of-light approximation. A Python script is developed to perform these calculations systematically.",
            "answer": "```\n[0.0,-0.00392659714853,-0.428717208358455,0.03607062406853,0.0,-0.125642436417235,0.0,0.0,-0.874134444747225,-0.038144214532585]\n```"
        },
        {
            "introduction": "Simulating high-density plasmas, where the plasma frequency $ \\omega_p $ is very large, poses a significant challenge for standard explicit PIC methods due to the severe time-step constraint $ \\omega_p \\Delta t \\lt 2 $. Implicit methods overcome this limitation by using information at the future time step, ensuring numerical stability even for large time steps. This practice guides you through the implementation of an implicit solver, requiring you to use the Conjugate Gradient method to solve the resulting linear system and to explore the power of a physics-based preconditioner to accelerate convergence . This is an essential skill for anyone looking to simulate phenomena in dense environments like stellar interiors or laser-plasma interactions.",
            "id": "3529066",
            "problem": "Consider a one-dimensional, electrostatic implicit Particle-In-Cell method for a cold, singly charged electron plasma with periodic boundaries. The computational objective is to advance the electric field from time step $n$ to $n+1$ under dense plasma conditions where the plasma frequency $ \\omega_p $ is large relative to the time step, specifically satisfying $ \\omega_p \\Delta t \\gg 1 $. Begin from fundamental laws and well-tested formulas: the momentum equation for electrons, Maxwell's equations specialized to electrostatic conditions, and the continuity equation. Assume a cold, uniform electron plasma of number density $ n_e $ with fixed, neutralizing ions, and restrict attention to one spatial dimension $ x \\in [0,1) $ with periodic boundary conditions. Use dimensionless variables throughout so that no physical units are required in the final numerical answer.\n\nStarting from these bases, carry out a backward-in-time implicit discretization to derive a linear, symmetric positive definite system for the grid representation of the electric field $ E^{n+1} $. Show that the resulting operator contains a local response term proportional to the identity matrix that depends on $ \\omega_p^2 \\Delta t^2 $ and a spatial coupling term arising from Maxwell's equations that reduces to a discrete Laplacian on the periodic grid. Denote the resulting linear system as\n$$\n\\mathbf{A} \\mathbf{E}^{n+1} = \\mathbf{b},\n$$\nwhere $ \\mathbf{A} $ is a symmetric positive definite matrix combining the local plasma response and the discrete Laplacian, $ \\mathbf{E}^{n+1} $ is the unknown grid vector of the electric field at time step $ n+1 $, and $ \\mathbf{b} $ is a known vector determined by data at time step $ n $ and any external sources. Use a zero initial guess $ \\mathbf{E}^{(0)} = \\mathbf{0} $ for the iterative solve.\n\nImplement a Conjugate Gradient method to solve $ \\mathbf{A} \\mathbf{E}^{n+1} = \\mathbf{b} $ and record the residual norms $ \\| \\mathbf{r}^{(k)} \\|_2 $ at each iteration $ k $, where $ \\mathbf{r}^{(k)} = \\mathbf{b} - \\mathbf{A} \\mathbf{E}^{(k)} $. Analyze convergence in two scenarios:\n1. Without any preconditioner.\n2. With a physics-based preconditioner that models the local plasma response by neglecting spatial coupling, that is, applies an inverse of the diagonal operator obtained when the discrete Laplacian is dropped.\n\nUse a uniform grid of $ N $ points on $ [0,1) $ with periodic boundary conditions. The discrete Laplacian on this grid acts on a vector $ \\mathbf{x} $ via\n$$\n(D \\mathbf{x})_i = \\mathbf{x}_{i+1} - 2 \\mathbf{x}_i + \\mathbf{x}_{i-1},\n$$\nwith indices taken modulo $ N $. In the derived operator $ \\mathbf{A} $, the discrete Laplacian must be scaled by a nonnegative coupling parameter $ \\lambda $ that encodes the strength of spatial coupling produced by the implicit field update. Construct the right-hand side vector $ \\mathbf{b} $ from a single sine Fourier mode of wavenumber $ m $, specifically\n$$\nb_i = \\sin(2 \\pi m x_i), \\quad x_i = \\frac{i}{N}, \\quad i = 0, 1, \\ldots, N-1.\n$$\n\nFor each test case, run Conjugate Gradient without preconditioning and with the physics-based preconditioner. Use a stopping criterion based on the relative residual: stop when $ \\| \\mathbf{r}^{(k)} \\|_2 / \\| \\mathbf{r}^{(0)} \\|_2 \\leq 10^{-8} $ or when $ k $ reaches $ N $, whichever occurs first. Record the number of iterations required in each scenario.\n\nTest suite:\n- Case 1 (general dense plasma, moderate spatial coupling): $ N = 128 $, $ \\omega_p = 100 $, $ \\Delta t = 10 $, $ \\lambda = 1 $, $ m = 1 $.\n- Case 2 (very dense plasma, moderate spatial coupling): $ N = 128 $, $ \\omega_p = 1000 $, $ \\Delta t = 20 $, $ \\lambda = 1 $, $ m = 3 $.\n- Case 3 (no spatial coupling, purely local response): $ N = 128 $, $ \\omega_p = 100 $, $ \\Delta t = 10 $, $ \\lambda = 0 $, $ m = 5 $.\n- Case 4 (dense plasma, strong spatial coupling and higher resolution): $ N = 256 $, $ \\omega_p = 300 $, $ \\Delta t = 15 $, $ \\lambda = 50 $, $ m = 2 $.\n\nFinal output specification:\nYour program should produce a single line of output containing the results as a comma-separated list of pairs enclosed in square brackets, where each pair is $ [k_{\\text{no}},k_{\\text{pre}}] $ for one test case and $ k_{\\text{no}} $ and $ k_{\\text{pre}} $ are integers denoting the iteration counts without and with the physics-based preconditioner, respectively. For example, the output format must be\n$$\n\\texttt{[[k\\_no1,k\\_pre1],[k\\_no2,k\\_pre2],[k\\_no3,k\\_pre3],[k\\_no4,k\\_pre4]]}.\n$$",
            "solution": "The problem requires the derivation and solution of a linear system for the electric field in a one-dimensional, implicit Particle-In-Cell (PIC) model of a cold electron plasma. The system is to be solved using the Conjugate Gradient (CG) method, both with and without a physics-based preconditioner.\n\n### Derivation of the Linear System for the Electric Field\n\nWe begin with the linearized one-dimensional fluid equations for a cold, unmagnetized electron plasma with a fixed neutralizing ion background of density $n_0$. The electron charge is $q_e = -e$ and mass is $m_e$. In dimensionless units, we can set $e=1$, $m_e=1$, and $\\epsilon_0=1$.\n\n1.  **Momentum Equation (Euler's equation for cold fluid):**\n    $$\n    \\frac{\\partial v_e}{\\partial t} = -E\n    $$\n2.  **Current Density:** The electron current density is $J_e = -n_e v_e$. Linearizing around the equilibrium state ($n_e \\approx n_0$, $v_e \\approx 0$), we get $J_e \\approx -n_0 v_e$.\n3.  **Ampere-Maxwell Law:** In one dimension without magnetic fields, this is $\\frac{\\partial E}{\\partial t} = -J_{tot}$. In our plasma, the total current consists of the electron current $J_e$ and any other sources, which we will incorporate into the right-hand side of our final system. Thus, we relate the time evolution of $E$ to the plasma current: $\\frac{\\partial E}{\\partial t} = -J_e$.\n\nWe employ a backward-in-time (fully implicit) discretization scheme to handle the high-frequency plasma oscillations, which is stable even for $\\omega_p \\Delta t \\gg 1$.\nDiscretizing the momentum equation:\n$$\n\\frac{v_e^{n+1} - v_e^n}{\\Delta t} = -E^{n+1} \\implies v_e^{n+1} = v_e^n - \\Delta t E^{n+1}\n$$\nThe current at time step $n+1$ is then:\n$$\nJ_e^{n+1} = -n_0 v_e^{n+1} = -n_0 (v_e^n - \\Delta t E^{n+1}) = J_e^n + n_0 \\Delta t E^{n+1}\n$$\nThe plasma frequency is defined as $\\omega_p^2 = n_0 e^2 / (\\epsilon_0 m_e)$. In our dimensionless units, this becomes $\\omega_p^2 = n_0$. So, we have:\n$$\nJ_e^{n+1} = J_e^n + \\omega_p^2 \\Delta t E^{n+1}\n$$\nNow, we discretize the Ampere-Maxwell law implicitly:\n$$\n\\frac{E^{n+1} - E^n}{\\Delta t} = -J_e^{n+1}\n$$\nSubstituting the expression for $J_e^{n+1}$:\n$$\n\\frac{E^{n+1} - E^n}{\\Delta t} = -(J_e^n + \\omega_p^2 \\Delta t E^{n+1})\n$$\nRearranging to solve for $E^{n+1}$:\n$$\nE^{n+1} - E^n = -\\Delta t J_e^n - \\omega_p^2 \\Delta t^2 E^{n+1}\n$$\n$$\n(1 + \\omega_p^2 \\Delta t^2) E^{n+1} = E^n - \\Delta t J_e^n\n$$\nThis equation describes the local plasma response. The term $(1 + \\omega_p^2 \\Delta t^2)E^{n+1}$ shows how the field is shielded by the plasma's inertial response. Since $\\omega_p \\Delta t \\gg 1$, we can approximate this as $(\\omega_p^2 \\Delta t^2) E^{n+1}$.\n\nSpatial coupling arises from Maxwell's equations, specifically Gauss's law (Poisson's equation), which relates the field to its sources. A complete derivation using the \"direct implicit\" method leads to a Helmholtz-type equation for the electric field. For the purposes of this problem, we adopt the structure provided, which is a common outcome of such derivations:\n$$\n(\\omega_p^2 \\Delta t^2) \\mathbf{E}^{n+1} - \\lambda \\nabla^2 \\mathbf{E}^{n+1} = \\mathbf{b}'\n$$\nwhere $\\mathbf{b}'$ is a source term derived from conditions at time $n$, and $\\lambda$ is a parameter controlling the strength of spatial coupling. The operator $\\nabla^2$ is the one-dimensional Laplacian $\\frac{\\partial^2}{\\partial x^2}$.\n\nWe discretize this equation on a uniform grid of $N$ points $x_i = i/N$ for $i=0, \\dots, N-1$. The electric field is represented by a vector $\\mathbf{E}$ of its values $E_i$ at the grid points. The discrete Laplacian operator specified is $(D\\mathbf{E})_i = E_{i+1} - 2E_i + E_{i-1}$, which corresponds to $h^2 \\nabla^2 E$ where $h=1/N$ is the grid spacing. The factor $h^2$ can be absorbed into $\\lambda$. The resulting linear system is $\\mathbf{A} \\mathbf{E}^{n+1} = \\mathbf{b}$, where the matrix $\\mathbf{A}$ acts on a vector $\\mathbf{E}$ as:\n$$\n(\\mathbf{A} \\mathbf{E})_i = (\\omega_p^2 \\Delta t^2) E_i + \\lambda (- (E_{i+1} - 2E_i + E_{i-1}))\n$$\nLet $c = \\omega_p^2 \\Delta t^2$. The matrix $\\mathbf{A}$ can be written as:\n$$\n\\mathbf{A} = c \\mathbf{I} - \\lambda \\mathbf{D}\n$$\nwhere $\\mathbf{I}$ is the identity matrix and $\\mathbf{D}$ is the matrix representation of the discrete Laplacian operator with periodic boundary conditions. The matrix $-\\mathbf{D}$ is a symmetric positive semi-definite matrix. Its eigenvalues are $2(1 - \\cos(2\\pi k/N)) \\ge 0$ for $k=0, \\dots, N-1$. The eigenvalues of $\\mathbf{A}$ are $\\mu_k = c + 2\\lambda(1 - \\cos(2\\pi k/N))$. Since $c = (\\omega_p \\Delta t)^2  0$ and $\\lambda \\ge 0$, all eigenvalues $\\mu_k$ are positive. Thus, $\\mathbf{A}$ is a symmetric positive definite (SPD) matrix, which is a requirement for the standard Conjugate Gradient algorithm.\n\nThe right-hand side vector $\\mathbf{b}$ is given as a single Fourier mode:\n$$\nb_i = \\sin(2 \\pi m x_i) = \\sin(2 \\pi m i / N)\n$$\n\n### Conjugate Gradient Method\n\nThe Conjugate Gradient (CG) method is an iterative algorithm for solving linear systems $\\mathbf{A}\\mathbf{x} = \\mathbf{b}$ where $\\mathbf{A}$ is SPD. Starting with an initial guess $\\mathbf{x}^{(0)} = \\mathbf{0}$, the algorithm iteratively refines the solution. For each test case, we will run the standard CG algorithm and count the number of iterations $k_{\\text{no}}$ until the relative residual norm $\\| \\mathbf{r}^{(k)} \\|_2 / \\| \\mathbf{r}^{(0)} \\|_2$ falls below a tolerance of $10^{-8}$.\n\n### Preconditioned Conjugate Gradient Method\n\nPreconditioning is a technique to improve the convergence rate of iterative methods. A preconditioner $\\mathbf{M}$ is a matrix that approximates $\\mathbf{A}$ but is easier to invert. The Preconditioned Conjugate Gradient (PCG) method effectively solves the transformed system $\\mathbf{M}^{-1}\\mathbf{A}\\mathbf{x} = \\mathbf{M}^{-1}\\mathbf{b}$.\n\nThe problem specifies a physics-based preconditioner that models the dominant local plasma response, obtained by dropping the spatial coupling (Laplacian) term from $\\mathbf{A}$. The operator $\\mathbf{A}$ is composed of the local response term $c\\mathbf{I}$ and the spatial coupling term $-\\lambda \\mathbf{D}$. Dropping the spatial term leaves the operator $c\\mathbf{I}$. The preconditioner $\\mathbf{M}$ is this operator itself. The preconditioning step in PCG requires solving $\\mathbf{M}\\mathbf{z}^{(k)} = \\mathbf{r}^{(k)}$, which becomes trivial:\n$$\n(c\\mathbf{I}) \\mathbf{z}^{(k)} = \\mathbf{r}^{(k)} \\implies \\mathbf{z}^{(k)} = \\frac{1}{c} \\mathbf{r}^{(k)}\n$$\nThis is a simple scaling of the residual vector. For the dense plasma regime with $\\omega_p \\Delta t \\gg 1$, the term $c\\mathbf{I}$ dominates $\\mathbf{A}$, making it strongly diagonally dominant. This suggests that this preconditioner should be highly effective. We will run the PCG algorithm with this preconditioner and count the iterations $k_{\\text{pre}}$.\n\nThe implementation will consist of two functions, one for CG and one for PCG. They will not construct the matrix $\\mathbf{A}$ explicitly but will use a function to compute the matrix-vector product $\\mathbf{A}\\mathbf{p}$, which is more efficient for sparse/structured matrices like $\\mathbf{A}$.",
            "answer": "```\n[[2,2],[1,1],[1,1],[12,2]]\n```"
        }
    ]
}