{
    "hands_on_practices": [
        {
            "introduction": "这第一个练习是一项基础的“量级”估算。在构建复杂的数值模型之前，理解主导的物理过程至关重要。我们将通过比较宇宙线在典型银盘环境中的平流、流不稳定性和扩散的特征时标，来建立物理直觉，这项技能对于简化问题和解释模拟结果至关重要。",
            "id": "3518661",
            "problem": "考虑宇宙线磁流体力学（CR-MHD）在星系盘的一个分层区域中的应用，该区域被建模为一个特征尺寸为 $L$ 的一维板，被强度为 $B_{0}$ 的均匀磁场穿过，其质量密度为 $\\rho$，气体整体平流速度为 $U$，宇宙线（CR）平行扩散系数为 $\\kappa_{\\parallel}$。假设等离子体可以被理想磁流体力学（MHD）很好地描述，因此沿磁场的小振幅横波传播速度（阿尔芬速度）由平衡场和密度决定。对于沿平均场的宇宙线输运，三种机制是相关的：随气体的平流、以阿尔芬速度进行的流串、以及平行扩散。在尺度 $L$ 上的特征量纲时间尺度分别为：平流为 $L/U$，流串为 $L/v_{A}$，扩散为 $L^{2}/\\kappa_{\\parallel}$。\n\n从理想 MHD 方程和核心定义出发，首先得到阿尔芬速度 $v_{A}$ 关于 $B_{0}$ 和 $\\rho$ 的表达式。然后，构建流串和扩散时间尺度与平流时间尺度的无量纲比值，并用它们来量化在以下基准星系盘模型中哪个过程最快：\n- $L = 1.0$ 千秒差距,\n- $U = 10$ 公里每秒,\n- $B_{0} = 5.0$ 微高斯,\n- $\\rho = 1.67 \\times 10^{-24}$ 克每立方厘米,\n- $\\kappa_{\\parallel} = 3.0 \\times 10^{28}$ 平方厘米每秒.\n\n在厘米-克-秒（cgs）单位制下进行计算，使用 $1\\,\\mathrm{pc} = 3.086 \\times 10^{18}\\,\\mathrm{cm}$ 和 $1\\,\\mathrm{G}$ 代表高斯。定义无量纲比值\n$$\nR \\equiv \\frac{\\min\\left\\{L/U,\\;L/v_{A},\\;L^{2}/\\kappa_{\\parallel}\\right\\}}{L/U},\n$$\n该比值衡量了最快输运时间尺度相对于平流时间尺度的关系。计算上述基准参数下的 $R$ 值。将您的答案四舍五入到四位有效数字。以无单位的无量纲数报告 $R$。",
            "solution": "解答包含两个主要部分：首先，从理想 MHD 方程推导阿尔芬速度；其次，根据给定参数计算无量纲比值 $R$。\n\n**第一部分：阿尔芬速度（$v_A$）的推导**\n\n在 cgs-高斯单位制中，线性化的理想 MHD 方程描述了在均匀背景磁场 $\\mathbf{B}_0$ 和均匀密度 $\\rho_0$ 的等离子体中，垂直于 $\\mathbf{B}_0$ 方向的速度微扰 $\\mathbf{v}_1$ 如何传播。对于沿 $\\mathbf{B}_0$ 方向传播的横波（阿尔芬波），其波动方程为：\n$$\n\\rho_0 \\frac{\\partial^2 \\mathbf{v}_1}{\\partial t^2} = \\frac{B_0^2}{4\\pi} \\frac{\\partial^2 \\mathbf{v}_1}{\\partial z^2}\n$$\n其中 $z$ 是沿 $\\mathbf{B}_0$ 方向的坐标。这是一个标准的波动方程，其波速的平方是空间导数项的系数。因此，阿尔芬速度 $v_A$ 由下式给出：\n$$\nv_A^2 = \\frac{B_0^2}{4\\pi \\rho_0}\n$$\n取平方根并使用问题的符号（用 $\\rho$ 表示背景密度）：\n$$\nv_A = \\frac{B_0}{\\sqrt{4\\pi \\rho}}\n$$\n\n**第二部分：无量纲比值 $R$ 的计算**\n\n我们首先将所有参数转换为 cgs 单位。\n- $L = 1.0\\,\\mathrm{kpc} = 10^3\\,\\mathrm{pc} = 10^3 \\times (3.086 \\times 10^{18}\\,\\mathrm{cm}) = 3.086 \\times 10^{21}\\,\\mathrm{cm}$\n- $U = 10\\,\\mathrm{km/s} = 10 \\times 10^5\\,\\mathrm{cm/s} = 1.0 \\times 10^6\\,\\mathrm{cm/s}$\n- $B_0 = 5.0\\,\\mu\\mathrm{G} = 5.0 \\times 10^{-6}\\,\\mathrm{G}$\n- $\\rho = 1.67 \\times 10^{-24}\\,\\mathrm{g/cm^3}$\n- $\\kappa_{\\parallel} = 3.0 \\times 10^{28}\\,\\mathrm{cm^2/s}$\n\n接下来，我们使用推导出的公式计算阿尔芬速度 $v_A$：\n$$\nv_A = \\frac{B_0}{\\sqrt{4\\pi \\rho}} = \\frac{5.0 \\times 10^{-6}}{\\sqrt{4\\pi(1.67 \\times 10^{-24})}} \\approx \\frac{5.0 \\times 10^{-6}}{\\sqrt{2.09858 \\times 10^{-23}}} \\approx \\frac{5.0 \\times 10^{-6}}{4.58103 \\times 10^{-12}} \\approx 1.09146 \\times 10^6\\,\\mathrm{cm/s}\n$$\n\n问题要求计算 $R = \\frac{\\min\\left\\{\\tau_{adv}, \\tau_{stream}, \\tau_{diff}\\right\\}}{\\tau_{adv}}$，其中 $\\tau_{adv} = L/U$，$\\tau_{stream} = L/v_A$，以及 $\\tau_{diff} = L^2/\\kappa_{\\parallel}$。这等价于找到 $\\{1, \\tau_{stream}/\\tau_{adv}, \\tau_{diff}/\\tau_{adv}\\}$ 中的最小值。\n\n我们计算各个时间尺度与平流时间尺度的比值。\n1. 流串与平流时间尺度之比：\n$$\n\\frac{\\tau_{stream}}{\\tau_{adv}} = \\frac{L/v_A}{L/U} = \\frac{U}{v_A} = \\frac{1.0 \\times 10^6\\,\\mathrm{cm/s}}{1.09146 \\times 10^6\\,\\mathrm{cm/s}} \\approx 0.91619\n$$\n2. 扩散与平流时间尺度之比：\n$$\n\\frac{\\tau_{diff}}{\\tau_{adv}} = \\frac{L^2/\\kappa_{\\parallel}}{L/U} = \\frac{LU}{\\kappa_{\\parallel}} = \\frac{(3.086 \\times 10^{21}\\,\\mathrm{cm})(1.0 \\times 10^6\\,\\mathrm{cm/s})}{3.0 \\times 10^{28}\\,\\mathrm{cm^2/s}} = \\frac{3.086 \\times 10^{27}}{3.0 \\times 10^{28}} = \\frac{3.086}{30} \\approx 0.10287\n$$\n\n现在我们比较这组数值 $\\{1, 0.91619, 0.10287\\}$。最小值约为 $0.10287$，它对应于扩散时间尺度。因此，对于这些参数，扩散是最快的输运过程。\n无量纲比值 $R$ 为：\n$$\nR = \\frac{\\tau_{diff}}{\\tau_{adv}} = \\frac{LU}{\\kappa_{\\parallel}} = \\frac{3.086 \\times 1.0}{30} = 0.1028666...\n$$\n问题要求将答案四舍五入到四位有效数字。\n$$\nR \\approx 0.1029\n$$",
            "answer": "$$\\boxed{0.1029}$$"
        },
        {
            "introduction": "在将流不稳定性确定为一个关键的输运机制后，我们现在通过一个解析基准问题来详细探究其动力学。这个问题涉及求解在自约束假设下宇宙线流的一维黎曼问题。推导压力分布和相关气体加热率的精确解，能为我们提供关于宇宙线与气体之间非线性耦合的深刻见解，并作为数值代码的一个关键验证测试。",
            "id": "3518694",
            "problem": "考虑一个一维、磁化的静态背景等离子体，其质量密度均匀，并有沿 $x$ 轴方向的均匀磁场。Alfvén 速度（大小）为常数 $v_A$，气体速度为零。宇宙线 (CR) 被建模为一种绝热指数 $\\gamma_c = 4/3$ 的超相对论性流体，因此宇宙线能量密度和压强满足 $e_c = P_c/(\\gamma_c - 1) = 3 P_c$，宇宙线焓密度为 $e_c + P_c = 4 P_c$。在自约束假设下，宇宙线以漂流速度 $v_s = -\\,v_A\\,\\mathrm{sgn}(\\partial_x P_c)$ 沿磁场漂流，其中 $\\mathrm{sgn}$ 是符号函数。\n\n在时间 $t=0$ 时，宇宙线压强初始化为一个阶跃函数：\n$$\nP_c(x,0) = \\begin{cases}\nP_L,  x  0, \\\\\nP_R,  x > 0,\n\\end{cases}\n$$\n其中 $P_L > P_R$，且 $P_L$ 和 $P_R$ 为正常数。\n\n从耦合的宇宙线-气体系统的能量守恒和宇宙线漂流的自约束闭合关系出发，在分布意义上推导宇宙线能量通量 $F_c(x,t)$ 和气体体积加热率 $H(x,t)$ 对于所有 $t>0$ 的精确时间演化。使用 Heaviside 阶跃函数 $H(z)$ 表示任何间断，使用 Dirac delta 分布 $\\delta(z)$ 表示任何奇异加热层。假设宇宙线和气体之间唯一的能量交换是共振波加热，并且 Alfvén 速度 $v_A$ 在时间和空间上保持不变。\n\n最后，计算单位横截面积上的总气体加热功率，\n$$\nQ(t) \\equiv \\int_{-\\infty}^{+\\infty} H(x,t)\\,dx,\n$$\n并将其表示为 $v_A$、$P_L$ 和 $P_R$ 的闭式解析表达式。将这个最终的量 $Q(t)$ 作为你的最终答案。以 cgs 单位（erg cm$^{-2}$ s$^{-1}$）表示最终答案。不需要进行数值代入；请提供精确表达式。",
            "solution": "我们从宇宙线流体的基本守恒定律开始。宇宙线能量密度由 $e_c = 3P_c$ 给出。其能量守恒由以下方程描述：\n$$\n\\frac{\\partial e_c}{\\partial t} + \\frac{\\partial F_c}{\\partial x} = -H\n$$\n其中 $H$ 是能量从宇宙线转移到气体的速率（加热率）。背景气体速度为零，因此宇宙线能量通量 $F_c$ 仅由漂流引起：\n$$\nF_c = (e_c + P_c) v_s = 4 P_c v_s\n$$\n问题指明了宇宙线漂流速度为 $v_s = -v_A\\,\\mathrm{sgn}(\\partial_x P_c)$，加热是由于宇宙线压强梯度对漂流运动所做的功，在自约束模型中，这表示为 $H = -v_s \\partial_x P_c = v_A|\\partial_x P_c|$。\n\n我们将上述关系代入宇宙线能量守恒方程，以得到宇宙线压强 $P_c$ 的演化方程。\n$$\n\\frac{\\partial (3P_c)}{\\partial t} + \\frac{\\partial}{\\partial x} \\left(4 P_c (-v_A\\,\\mathrm{sgn}(\\partial_x P_c))\\right) = -v_A |\\partial_x P_c|\n$$\n初始条件为当 $x0$ 时 $P_c(x,0) = P_L$，当 $x>0$ 时 $P_c(x,0) = P_R$，且 $P_L > P_R$。这意味着对于任意时间 $t>0$，随着 $x$ 的增加，压强必须从一个高值过渡到一个低值。因此，在导数存在的地方，我们有 $\\partial_x P_c  0$。这意味着 $\\mathrm{sgn}(\\partial_x P_c) = -1$ 且 $|\\partial_x P_c| = -\\partial_x P_c$。我们假设这个关系在梯度非零的任何地方都成立。\n方程变为：\n$$\n3\\frac{\\partial P_c}{\\partial t} - 4v_A \\frac{\\partial}{\\partial x} (P_c (-1)) = -v_A (-\\partial_x P_c)\n$$\n$$\n3\\frac{\\partial P_c}{\\partial t} + 4v_A \\frac{\\partial P_c}{\\partial x} = v_A \\frac{\\partial P_c}{\\partial x}\n$$\n$$\n\\frac{\\partial P_c}{\\partial t} + v_A \\frac{\\partial P_c}{\\partial x} = 0\n$$\n这是一个线性平流方程，它表明 $P_c$ 的任意初始剖面都将以恒定速度 $v_A$ 沿 $x$ 轴正方向传播，且形状不变。对于给定的初始阶跃函数的解是：\n$$\nP_c(x,t) = P_c(x - v_A t, 0) = P_L + (P_R - P_L) H(x - v_A t)\n$$\n其中 $H(z)$ 是 Heaviside 阶跃函数。这描述了一个位于 $x=v_A t$ 并向右移动的接触间断。\n\n接下来，我们推导加热率 $H(x,t)$。在分布意义上，对 $P_c(x,t)$ 求关于 $x$ 的导数得到：\n$$\n\\partial_x P_c(x,t) = (P_R - P_L) \\delta(x - v_A t)\n$$\n其中 $\\delta(z)$ 是 Dirac delta 分布。加热率为：\n$$\nH(x,t) = v_A |\\partial_x P_c| = v_A |(P_R - P_L) \\delta(x - v_A t)| = v_A (P_L - P_R) \\delta(x - v_A t)\n$$\n这表明所有的加热都发生在一个与宇宙线压强前沿共同移动的无限薄层中。\n\n我们通过对 $\\partial F_c / \\partial x = -\\partial e_c / \\partial t - H(x,t)$ 积分来求解宇宙线能量通量 $F_c(x,t)$。这给出了\n$$\nF_c(x,t) = 4v_A (P_R - P_L) H(x - v_A t)\n$$\n这个表达式描述了一个通量，它在前沿的上游 ($x  v_A t$) 为零，在下游 ($x > v_A t$) 有一个恒定的负值 $4v_A(P_R-P_L)$。\n\n最后，我们计算单位横截面积上的总气体加热功率 $Q(t)$：\n$$\nQ(t) = \\int_{-\\infty}^{+\\infty} H(x,t)\\,dx = \\int_{-\\infty}^{+\\infty} v_A (P_L - P_R) \\delta(x - v_A t)\\,dx\n$$\n利用 Dirac delta 函数的积分性质，我们得到：\n$$\nQ(t) = v_A (P_L - P_R)\n$$\n结果不随时间变化。单位为 $[v_A](\\text{cm s}^{-1}) \\times [P](\\text{erg cm}^{-3})$，得到 $\\text{erg cm}^{-2} \\text{s}^{-1}$，符合要求。",
            "answer": "$$\\boxed{v_A(P_L - P_R)}$$"
        },
        {
            "introduction": "现在我们转向模拟另一个关键输运过程——扩散——的计算方面。本实践聚焦于有限体积法的核心：计算各向异性扩散在单元交界面上的数值通量。你将实现一个精确的算法，包括一个通量限制器，将连续的物理定律转化为离散形式，这是计算天体物理学中的一项基本技能。",
            "id": "3518646",
            "problem": "考虑在笛卡尔网格上磁流体动力学中的宇宙射线各向异性扩散。宇宙射线压力（记为 $P_c$）主要沿磁场方向进行扩散传输。网格由具有单位面法线 $\\hat{\\boldsymbol{n}}$ 的平面组成。每个面分隔一个“左”单元和一个“右”单元，通过对 $P_c$ 进行分段线性重构，可以得到在面处求值的单元中心梯度。面心磁场方向由一个向量 $\\boldsymbol{b}$ 给出，其长度可能不为 1，平行扩散系数为标量 $\\kappa_{\\parallel}$。\n\n基本原理：在磁流体动力学中，沿磁力线的各向异性扩散的扩散输运定律遵循一个本构关系，该关系基于推广到与磁场对齐的二阶传导张量的菲克定律：宇宙射线压力的通量密度沿磁场方向，且与 $P_c$ 沿该场的方向导数成正比。设单位磁场方向为 $\\hat{\\boldsymbol{b}} = \\boldsymbol{b}/\\|\\boldsymbol{b}\\|$（对于 $\\|\\boldsymbol{b}\\| \\neq 0$）。沿 $\\hat{\\boldsymbol{b}}$ 的方向导数为 $\\hat{\\boldsymbol{b}}\\cdot\\nabla P_c$。离散面法向通量应使用两侧重构的梯度和一个保持单调性的限制器来计算，该限制器可防止跨越极值点的伪扩散。\n\n任务：对于每个面，使用从上述基本原理推导出的以下步骤，计算通过该面的标量通量，即各向异性扩散通量的法向分量：\n1. 将给定的面心磁场方向归一化为 $\\hat{\\boldsymbol{b}}$。如果 $\\|\\boldsymbol{b}\\|=0$，则将通量定义为零。\n2. 将面法线归一化为单位向量 $\\hat{\\boldsymbol{n}}$。\n3. 根据左侧和右侧重构的梯度（记为 $\\nabla P_c^{L}$ 和 $\\nabla P_c^{R}$），计算方向导数 $s_L = \\hat{\\boldsymbol{b}}\\cdot\\nabla P_c^{L}$ 和 $s_R = \\hat{\\boldsymbol{b}}\\cdot\\nabla P_c^{R}$。\n4. 应用 minmod 限制器以获得受限方向导数 $s^{\\star}$，其定义为\n$$\n\\operatorname{minmod}(a,b) = \n\\begin{cases}\n\\operatorname{sign}(a)\\,\\min(|a|,|b|),  \\text{if } a\\,b0,\\\\\n0,  \\text{otherwise},\n\\end{cases}\n$$\n并设置 $s^{\\star} = \\operatorname{minmod}(s_L,s_R)$。\n5. 计算面上的各向异性扩散通量向量为\n$$\n\\boldsymbol{F}_{\\text{diff}} = -\\kappa_{\\parallel}\\, s^{\\star}\\, \\hat{\\boldsymbol{b}},\n$$\n然后计算通过该面的标量通量（即要输出的量）为\n$$\n\\phi = \\boldsymbol{F}_{\\text{diff}}\\cdot \\hat{\\boldsymbol{n}}.\n$$\n\n所有量均采用一致的代码单位。您必须以代码单位输出每个面的标量通量 $\\phi$。无需报告任何角度，但任何向量归一化都必须在欧几里得意义上执行。您的程序必须精确地实现以上步骤。\n\n测试套件：使用以下六个具有指定参数的面，每个参数均以代码单位给出。对于每种情况，输入为 $(\\kappa_{\\parallel},\\, \\boldsymbol{b},\\, \\hat{\\boldsymbol{n}},\\, \\nabla P_c^{L},\\, \\nabla P_c^{R})$。\n- 情况 1（理想情况，场与面法线对齐）：\n  $(0.5,\\,(1,0,0),\\,(1,0,0),\\,(1,0,0),\\,(3,0,0))$。\n- 情况 2（场与面法线相切，零投影）：\n  $(1.0,\\,(0,1,0),\\,(1,0,0),\\,(10,0,0),\\,(10,0,0))$。\n- 情况 3（方向导数相反，限制器归零）：\n  $(0.25,\\,(1,1,0),\\,(0,1,0),\\,(4,0,0),\\,(-4,0,0))$。\n- 情况 4（斜场和非零受限导数）：\n  $(0.25,\\,(1,1,0),\\,(0,1,0),\\,(3,1,0),\\,(5,1,0))$。\n- 情况 5（零扩散系数）：\n  $(0.0,\\,(0,0,5),\\,(0,0,1),\\,(0,0,2),\\,(0,0,2))$。\n- 情况 6（零磁场方向向量）：\n  $(1.0,\\,(0,0,0),\\,(1,0,0),\\,(1,2,3),\\,(1,2,3))$。\n\n答案规格和最终输出格式：对于每种情况，计算如上定义的标量通量 $\\phi$。您的程序应生成一行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，例如 $[\\phi_1,\\phi_2,\\ldots,\\phi_6]$，其中每个 $\\phi_i$ 都是代码单位下的浮点数。\n\n不读取任何外部输入；程序必须对测试套件进行硬编码并计算输出。该问题纯粹是数学和算法问题；在归一化向量时，请确保数值稳定性并避免除以零。",
            "solution": "任务是为几个给定场景计算通过单元面的标量扩散通量 $\\phi$。该计算遵循一个精确的多步骤过程。我们将首先概述通用方法，然后将其应用于六个指定的测试用例中的每一个。\n\n对于一组给定的输入：$\\kappa_{\\parallel}$, $\\boldsymbol{b}$, $\\hat{\\boldsymbol{n}}$, $\\nabla P_c^{L}$ 和 $\\nabla P_c^{R}$，通用步骤如下。\n\n1.  **处理零磁场情况**：如果磁场向量的模 $\\|\\boldsymbol{b}\\| = 0$，则通量定义为 $\\phi = 0$。否则，对磁场向量进行归一化，以获得单位方向向量 $\\hat{\\boldsymbol{b}} = \\boldsymbol{b}/\\|\\boldsymbol{b}\\|$。\n\n2.  **归一化面法线向量**：确保面法线向量 $\\hat{\\boldsymbol{n}}$ 是单位向量。对于给定的测试套件，所提供的向量已经是单位长度。\n\n3.  **计算方向导数**：计算压力沿磁场方向的方向导数：$s_L = \\hat{\\boldsymbol{b}} \\cdot \\nabla P_c^{L}$ 和 $s_R = \\hat{\\boldsymbol{b}} \\cdot \\nabla P_c^{R}$。\n\n4.  **应用 Minmod 限制器**：计算受限方向导数 $s^{\\star} = \\operatorname{minmod}(s_L, s_R)$。如果两个导数符号相同，此限制器选择幅度较小的一个；如果符号相反，则返回 $0$。\n\n5.  **计算最终标量通量**：构造各向异性扩散通量向量 $\\boldsymbol{F}_{\\text{diff}} = -\\kappa_{\\parallel}\\, s^{\\star}\\, \\hat{\\boldsymbol{b}}$。通过面的标量通量 $\\phi$ 是该通量向量在面法线方向上的分量，通过点积获得：$\\phi = \\boldsymbol{F}_{\\text{diff}} \\cdot \\hat{\\boldsymbol{n}}$。\n\n现在我们将此过程应用于每个测试用例。\n\n**情况 1**: $(\\kappa_{\\parallel}=0.5, \\boldsymbol{b}=(1,0,0), \\hat{\\boldsymbol{n}}=(1,0,0), \\nabla P_c^{L}=(1,0,0), \\nabla P_c^{R}=(3,0,0))$\n1.  $\\hat{\\boldsymbol{b}} = (1,0,0)$。\n2.  $\\hat{\\boldsymbol{n}}=(1,0,0)$。\n3.  $s_L = 1$, $s_R = 3$。\n4.  $s^{\\star} = \\operatorname{minmod}(1, 3) = 1$。\n5.  $\\boldsymbol{F}_{\\text{diff}} = -0.5 \\cdot 1 \\cdot (1,0,0) = (-0.5, 0, 0)$。\n    $\\phi = (-0.5, 0, 0) \\cdot (1,0,0) = -0.5$。\n\n**情况 2**: $(\\kappa_{\\parallel}=1.0, \\boldsymbol{b}=(0,1,0), \\hat{\\boldsymbol{n}}=(1,0,0), \\nabla P_c^{L}=(10,0,0), \\nabla P_c^{R}=(10,0,0))$\n1.  $\\hat{\\boldsymbol{b}} = (0,1,0)$。\n2.  $\\hat{\\boldsymbol{n}}=(1,0,0)$。\n3.  $s_L = 0$, $s_R = 0$。\n4.  $s^{\\star} = 0$。\n5.  $\\boldsymbol{F}_{\\text{diff}} = (0,0,0)$。\n    $\\phi = 0.0$。\n\n**情况 3**: $(\\kappa_{\\parallel}=0.25, \\boldsymbol{b}=(1,1,0), \\hat{\\boldsymbol{n}}=(0,1,0), \\nabla P_c^{L}=(4,0,0), \\nabla P_c^{R}=(-4,0,0))$\n1.  $\\hat{\\boldsymbol{b}} = (1/\\sqrt{2}, 1/\\sqrt{2}, 0)$。\n2.  $\\hat{\\boldsymbol{n}}=(0,1,0)$。\n3.  $s_L = 4/\\sqrt{2}$, $s_R = -4/\\sqrt{2}$。\n4.  $s_L \\cdot s_R  0$, 所以 $s^{\\star} = 0$。\n5.  $\\boldsymbol{F}_{\\text{diff}} = (0,0,0)$。\n    $\\phi = 0.0$。\n\n**情况 4**: $(\\kappa_{\\parallel}=0.25, \\boldsymbol{b}=(1,1,0), \\hat{\\boldsymbol{n}}=(0,1,0), \\nabla P_c^{L}=(3,1,0), \\nabla P_c^{R}=(5,1,0))$\n1.  $\\hat{\\boldsymbol{b}} = (1/\\sqrt{2}, 1/\\sqrt{2}, 0)$。\n2.  $\\hat{\\boldsymbol{n}}=(0,1,0)$。\n3.  $s_L = 4/\\sqrt{2}$, $s_R = 6/\\sqrt{2}$。\n4.  $s^{\\star} = \\operatorname{minmod}(4/\\sqrt{2}, 6/\\sqrt{2}) = 4/\\sqrt{2} = 2\\sqrt{2}$。\n5.  $\\boldsymbol{F}_{\\text{diff}} = -0.25 \\cdot (2\\sqrt{2}) \\cdot (1/\\sqrt{2}, 1/\\sqrt{2}, 0) = -0.5 \\cdot (1,1,0) = (-0.5, -0.5, 0)$。\n    $\\phi = (-0.5, -0.5, 0) \\cdot (0,1,0) = -0.5$。\n\n**情况 5**: $(\\kappa_{\\parallel}=0.0, \\boldsymbol{b}=(0,0,5), \\hat{\\boldsymbol{n}}=(0,0,1), \\nabla P_c^{L}=(0,0,2), \\nabla P_c^{R}=(0,0,2))$\n1.  因为 $\\kappa_{\\parallel} = 0.0$，通量向量必为零。\n2.  因此，$\\phi = 0.0$。\n\n**情况 6**: $(\\kappa_{\\parallel}=1.0, \\boldsymbol{b}=(0,0,0), \\hat{\\boldsymbol{n}}=(1,0,0), \\nabla P_c^{L}=(1,2,3), \\nabla P_c^{R}=(1,2,3))$\n1.  因为 $\\boldsymbol{b} = (0,0,0)$，根据问题说明，通量为零。\n2.  因此，$\\phi = 0.0$。\n\n六种情况最终计算出的标量通量为：$-0.5$, $0.0$, $0.0$, $-0.5$, $0.0$ 和 $0.0$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the anisotropic diffusive scalar flux for a series of test cases based on a\n    specified algorithm for cosmic ray transport in magnetohydrodynamics.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (kappa_parallel, b, n_face, grad_P_L, grad_P_R)\n    test_cases = [\n        # Case 1\n        (0.5, np.array([1.0, 0.0, 0.0]), np.array([1.0, 0.0, 0.0]), np.array([1.0, 0.0, 0.0]), np.array([3.0, 0.0, 0.0])),\n        # Case 2\n        (1.0, np.array([0.0, 1.0, 0.0]), np.array([1.0, 0.0, 0.0]), np.array([10.0, 0.0, 0.0]), np.array([10.0, 0.0, 0.0])),\n        # Case 3\n        (0.25, np.array([1.0, 1.0, 0.0]), np.array([0.0, 1.0, 0.0]), np.array([4.0, 0.0, 0.0]), np.array([-4.0, 0.0, 0.0])),\n        # Case 4\n        (0.25, np.array([1.0, 1.0, 0.0]), np.array([0.0, 1.0, 0.0]), np.array([3.0, 1.0, 0.0]), np.array([5.0, 1.0, 0.0])),\n        # Case 5\n        (0.0, np.array([0.0, 0.0, 5.0]), np.array([0.0, 0.0, 1.0]), np.array([0.0, 0.0, 2.0]), np.array([0.0, 0.0, 2.0])),\n        # Case 6\n        (1.0, np.array([0.0, 0.0, 0.0]), np.array([1.0, 0.0, 0.0]), np.array([1.0, 2.0, 3.0]), np.array([1.0, 2.0, 3.0])),\n    ]\n\n    results = []\n    \n    def minmod(a, b):\n        \"\"\"\n        Implementation of the minmod limiter function.\n        \"\"\"\n        if a * b > 0:\n            return np.sign(a) * np.min([np.abs(a), np.abs(b)])\n        else:\n            return 0.0\n\n    for case in test_cases:\n        kappa_parallel, b, n_face, grad_P_L, grad_P_R = case\n\n        # Step 1: Handle zero magnetic field and normalize b\n        b_norm = np.linalg.norm(b)\n        if b_norm == 0.0:\n            # As per problem statement, flux is zero if magnetic field is zero\n            phi = 0.0\n            results.append(phi)\n            continue\n        \n        b_hat = b / b_norm\n\n        # Step 2: Normalize the face-normal vector\n        n_norm = np.linalg.norm(n_face)\n        if n_norm == 0.0:\n            # This case is not expected but good practice to handle\n            phi = 0.0\n            results.append(phi)\n            continue\n        n_hat = n_face / n_norm\n        \n        # Step 3: Compute directional derivatives\n        s_L = np.dot(b_hat, grad_P_L)\n        s_R = np.dot(b_hat, grad_P_R)\n        \n        # Step 4: Apply the minmod limiter\n        s_star = minmod(s_L, s_R)\n        \n        # Step 5: Compute the anisotropic diffusive flux vector and scalar flux\n        F_diff = -kappa_parallel * s_star * b_hat\n        phi = np.dot(F_diff, n_hat)\n        \n        results.append(phi)\n\n    # Final print statement in the exact required format.\n    # Use format specifier to avoid potential trailing zeros for clean output.\n    # E.g., for -0.5, str(-0.5) is '-0.5', for 0.0, str(0.0) is '0.0'\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        }
    ]
}