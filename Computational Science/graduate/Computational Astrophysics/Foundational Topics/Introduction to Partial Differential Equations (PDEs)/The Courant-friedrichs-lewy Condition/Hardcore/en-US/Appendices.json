{
    "hands_on_practices": [
        {
            "introduction": "This exercise builds from first principles, asking you to derive the Courant-Friedrichs-Lewy (CFL) condition from the domain-of-dependence principle. By comparing the physical region of influence with the numerical stencil's reach, you will solidify your understanding of why this condition is fundamental to the stability of explicit numerical schemes . This practice provides a concrete calculation that anchors the theoretical concept.",
            "id": "3442602",
            "problem": "Consider a one-dimensional hyperbolic conservation law $u_{t} + f(u)_{x} = 0$ discretized on a uniform grid of spacing $\\Delta x = 0.01$ using a shock-capturing scheme that is second-order Total Variation Diminishing (TVD). Let the explicit time integrator be second-order TVD Runge–Kutta, and assume the maximum characteristic wavespeed satisfies $|a| = \\max |f^{\\prime}(u)| = 3$. The Courant–Friedrichs–Lewy (CFL) condition for stability and preservation of the TVD property constrains the Courant number $\\lambda$ defined by $\\lambda = |a|\\,\\Delta t / \\Delta x$, and you are asked to enforce $\\lambda \\le 0.9$ to maintain a safety margin within the TVD stability regime.\n\nDerive the CFL restriction from the domain-of-dependence principle for hyperbolic equations and shock-capturing finite-volume discretizations, and compute the largest time step $\\Delta t$ that satisfies the stated CFL constraint. Provide the final numerical value of $\\Delta t$ as a single real number. No rounding is needed.",
            "solution": "The problem is validated as well-posed, scientifically grounded, and containing all necessary information for a unique solution.\n\nThe problem asks for two things: first, to derive the Courant–Friedrichs–Lewy (CFL) condition from the domain-of-dependence principle, and second, to calculate the largest permissible time step $\\Delta t$ given the constraints.\n\nFirst, we address the derivation.\nThe governing equation is a one-dimensional hyperbolic conservation law, given by $u_{t} + f(u)_{x} = 0$. By applying the chain rule to the flux term $f(u)_{x}$, we can write the equation in its quasilinear form: $u_{t} + f^{\\prime}(u) u_{x} = 0$. The term $a(u) = f^{\\prime}(u)$ is the local characteristic wave speed, which describes the speed at which information propagates in the system. The equation $u_{t} + a(u) u_{x} = 0$ implies that the solution $u$ is constant along the characteristic curves in the $x-t$ plane, which are defined by the ordinary differential equation $\\frac{dx}{dt} = a(u)$.\n\nThe Courant–Friedrichs–Lewy (CFL) condition is a necessary condition for the stability of explicit numerical schemes for solving hyperbolic partial differential equations. It can be derived by comparing the physical domain of dependence of the PDE's solution with the numerical domain of dependence of the finite difference or finite volume scheme.\n\nConsider a point $(x_j, t^{n+1})$ on our computational grid, where $x_j$ is a spatial grid point and $t^{n+1} = t^n + \\Delta t$ is the time at the next step. The exact solution at this point, $u(x_j, t^{n+1})$, depends on the data at the previous time $t^n$ within a certain spatial interval. This interval is the physical domain of dependence. Information propagates with a finite speed, the maximum of which is given by $|a|_{\\max} = \\max_u |f^{\\prime}(u)|$. For a wave to reach the point $x_j$ at time $t^{n+1}$, it must have originated at time $t^n$ from a point $x_0$ such that the travel time is $\\Delta t$. The distance traveled is $|x_j - x_0| \\le |a|_{\\max} \\Delta t$. Therefore, the physical domain of dependence for the point $(x_j, t^{n+1})$ is the interval $[x_j - |a|_{\\max} \\Delta t, x_j + |a|_{\\max} \\Delta t]$ on the line $t=t^n$.\n\nNow, let's consider the numerical scheme. A shock-capturing scheme, such as a finite-volume scheme, computes the updated value $u_j^{n+1}$ in cell $j$ using the values from neighboring cells at time $t^n$. For a typical second-order TVD scheme, the numerical stencil to compute $u_j^{n+1}$ involves, at a minimum, the cells $j-1$, $j$, and $j+1$. The set of grid points at time $t^n$ that influences the computation of $u_j^{n+1}$ is the numerical domain of dependence. For a standard three-point stencil centered at $j$, this domain covers the spatial interval $[x_{j-1}, x_{j+1}]$, which, on a uniform grid with spacing $\\Delta x$, corresponds to the interval $[x_j - \\Delta x, x_j + \\Delta x]$.\n\nThe fundamental principle of the CFL condition is that for the numerical scheme to have any chance of yielding a convergent solution, its numerical domain of dependence must contain the physical domain of dependence of the PDE. If this condition is violated, the numerical scheme would be unable to access all the physical information necessary to correctly calculate the state at the next time step, leading to instability.\n\nThus, we must have:\n$$[x_j - |a|_{\\max} \\Delta t, x_j + |a|_{\\max} \\Delta t] \\subseteq [x_j - \\Delta x, x_j + \\Delta x]$$\nThis inclusion is satisfied if and only if the extent of the physical domain of dependence is less than or equal to the extent of the numerical domain of dependence. This leads to the inequality:\n$$|a|_{\\max} \\Delta t \\le \\Delta x$$\nDividing by $\\Delta x$ (which is strictly positive), we obtain the classic CFL condition:\n$$\\frac{|a|_{\\max} \\Delta t}{\\Delta x} \\le 1$$\nThe dimensionless group $\\lambda = \\frac{|a|_{\\max} \\Delta t}{\\Delta x}$ is known as the Courant number. The stability condition is therefore $\\lambda \\le 1$. For some multi-stage or higher-order schemes, the stability-enforcing limit on $\\lambda$ can be smaller than $1$. The problem statement provides a practical stability and TVD-property constraint of $\\lambda \\le 0.9$, which falls within this theoretical framework.\n\nNext, we compute the largest time step $\\Delta t$ that satisfies the given constraint.\nThe provided information is:\nMaximum characteristic wavespeed, $|a| = \\max |f^{\\prime}(u)| = 3$. We denote this by $|a|_{\\max} = 3$.\nGrid spacing, $\\Delta x = 0.01$.\nThe Courant number, $\\lambda = \\frac{|a|_{\\max} \\Delta t}{\\Delta x}$.\nThe CFL constraint to be enforced: $\\lambda \\le 0.9$.\n\nWe substitute the definition of the Courant number into the constraint:\n$$\\frac{|a|_{\\max} \\Delta t}{\\Delta x} \\le 0.9$$\nWe are looking for the largest possible time step, $\\Delta t$, which we denote $\\Delta t_{\\max}$. This value is obtained when the equality holds:\n$$\\frac{|a|_{\\max} \\Delta t_{\\max}}{\\Delta x} = 0.9$$\nSolving for $\\Delta t_{\\max}$, we get:\n$$\\Delta t_{\\max} = \\frac{0.9 \\cdot \\Delta x}{|a|_{\\max}}$$\nNow, we substitute the given numerical values into this expression:\n$$\\Delta t_{\\max} = \\frac{0.9 \\times 0.01}{3}$$\nPerforming the calculation:\n$$0.9 \\times 0.01 = 0.009$$\n$$\\Delta t_{\\max} = \\frac{0.009}{3} = 0.003$$\nTherefore, the largest time step that satisfies the stated CFL constraint is $0.003$.",
            "answer": "$$\\boxed{0.003}$$"
        },
        {
            "introduction": "Real astrophysical environments are rarely simple or isotropic. This problem explores how the CFL condition is applied in a more complex, physically-motivated scenario: a magnetized, stratified stellar atmosphere with anisotropic thermal conduction . You will derive how the direction of wave propagation relative to the magnetic field leads to different characteristic speeds, which in turn imposes different stability constraints for each dimension in a directionally split numerical scheme.",
            "id": "3538584",
            "problem": "Consider a two-dimensional, plane-parallel, gravitationally stratified, fully ionized hydrogen-helium plasma representing a coronal segment of a stellar atmosphere. Gravity of magnitude $g$ is uniform and points in the negative $z$-direction. The temperature is uniform and equal to $T$, so the atmosphere is isothermal. The mean molecular weight is $\\mu$. The plasma is threaded by a uniform magnetic field that makes an angle $\\phi$ with the $x$-axis (measured in the $x$-$z$ plane). Thermal conduction is extremely efficient along magnetic field lines and negligible across them, so compressions parallel to the magnetic field are effectively isothermal, while compressions perpendicular to the magnetic field are effectively adiabatic with ratio of specific heats $\\gamma$. You will analyze how this anisotropic thermodynamics modifies the directional signal speeds that enter the Courant-Friedrichs-Lewy (CFL) condition for an explicit, directionally split, first-order finite-volume Godunov method using a local Lax-Friedrichs (Rusanov) flux.\n\nWork in the low-Mach-number, non-magnetically-dynamic limit in which the only wave family of interest is the acoustic-like compressive mode and the magnetic field enters only by enforcing the anisotropic thermodynamic response described above. Start from the linearized mass and momentum conservation equations for a compressible fluid and an anisotropic closure for the pressure-density relation consistent with the assumptions above. By considering plane-wave perturbations with wavevector aligned with either the $x$-axis or the $z$-axis, derive the directional characteristic speeds $c_{x}$ and $c_{z}$ that control signal propagation in the numerical fluxes. Express these in terms of the isothermal sound speed along the magnetic field $c_{\\parallel}$ and the adiabatic sound speed across the magnetic field $c_{\\perp}$, the angle $\\phi$, and fundamental constants and parameters. Then, enforce the requirement that in each one-dimensional split sweep the numerical domain of dependence contains the physical domain of dependence, and obtain the maximum stable time step $\\Delta t_{\\max}$ for one full $x$-$z$ update in terms of the directional speeds, grid spacings, and flow velocities.\n\nAssume the following physically plausible parameters representative of a stellar corona:\n- Uniform temperature $T = 1.00 \\times 10^{6}\\ \\mathrm{K}$.\n- Mean molecular weight $\\mu = 0.6$.\n- Ratio of specific heats $\\gamma = \\frac{5}{3}$.\n- Gravitational acceleration $g = 274\\ \\mathrm{m}\\ \\mathrm{s}^{-2}$.\n- Boltzmann constant $k_{B} = 1.380649 \\times 10^{-23}\\ \\mathrm{J}\\ \\mathrm{K}^{-1}$.\n- Proton mass $m_{p} = 1.6726219 \\times 10^{-27}\\ \\mathrm{kg}$.\n- Magnetic-field angle $\\phi = 30^{\\circ}$.\n- Background velocities $u_{x} = 4.00 \\times 10^{4}\\ \\mathrm{m}\\ \\mathrm{s}^{-1}$ and $u_{z} = 0$.\n- Courant number $C = 0.5$.\n\nLet the isothermal scale height be $H = \\frac{k_{B} T}{\\mu m_{p} g}$. Choose an anisotropic grid that resolves the steep vertical stratification with $\\Delta z = \\frac{H}{2500}$ and a ten times larger horizontal spacing $\\Delta x = 10\\,\\Delta z$.\n\nUsing only the fundamental laws and facts specified or implicit above, compute the maximum stable time step $\\Delta t_{\\max}$ implied by the CFL condition for the described explicit, directionally split scheme. Express your final answer in seconds and round to four significant figures.",
            "solution": "The user has provided a problem in computational astrophysics that requires the derivation and calculation of the maximum stable time step, $\\Delta t_{\\max}$, for a specific numerical scheme. The validation process will be performed first.\n\n### Step 1: Extract Givens\n- **System Description**: Two-dimensional ($x$-$z$), plane-parallel, gravitationally stratified, fully ionized hydrogen-helium plasma.\n- **Gravity**: Uniform magnitude $g$, pointing in the negative $z$-direction.\n- **Temperature**: Uniform and constant, $T$.\n- **Mean Molecular Weight**: $\\mu$.\n- **Magnetic Field**: Uniform, in the $x$-$z$ plane, at an angle $\\phi$ with the $x$-axis.\n- **Anisotropic Thermodynamics**:\n    - Compressions parallel to the magnetic field are isothermal.\n    - Compressions perpendicular to the magnetic field are adiabatic with ratio of specific heats $\\gamma$.\n- **Numerical Scheme**: Explicit, directionally split, first-order finite-volume Godunov method with a local Lax-Friedrichs (Rusanov) flux.\n- **Physical Limit**: Low-Mach-number, non-magnetically-dynamic, considering only the acoustic-like compressive mode.\n- **Task**:\n    1.  Derive directional characteristic speeds $c_x$ and $c_z$.\n    2.  Obtain the expression for the maximum stable time step $\\Delta t_{\\max}$ for one full $x$-$z$ update.\n    3.  Compute a numerical value for $\\Delta t_{\\max}$.\n- **Physical Parameters**:\n    - $T = 1.00 \\times 10^{6}\\ \\mathrm{K}$\n    - $\\mu = 0.6$\n    - $\\gamma = \\frac{5}{3}$\n    - $g = 274\\ \\mathrm{m}\\ \\mathrm{s}^{-2}$\n    - $k_{B} = 1.380649 \\times 10^{-23}\\ \\mathrm{J}\\ \\mathrm{K}^{-1}$\n    - $m_{p} = 1.6726219 \\times 10^{-27}\\ \\mathrm{kg}$\n    - $\\phi = 30^{\\circ}$\n    - $u_{x} = 4.00 \\times 10^{4}\\ \\mathrm{m}\\ \\mathrm{s}^{-1}$\n    - $u_{z} = 0\\ \\mathrm{m}\\ \\mathrm{s}^{-1}$\n    - Courant number $C = 0.5$\n- **Grid Definitions**:\n    - Isothermal scale height: $H = \\frac{k_{B} T}{\\mu m_{p} g}$\n    - Grid spacing in $z$: $\\Delta z = \\frac{H}{2500}$\n    - Grid spacing in $x$: $\\Delta x = 10\\,\\Delta z$\n\n### Step 2: Validate Using Extracted Givens\n- **Scientific Grounding**: The problem is well-grounded in the principles of plasma physics, fluid dynamics, and numerical methods for hyperbolic conservation laws. The concept of anisotropic heat conduction guided by a strong magnetic field is fundamental in astrophysics, particularly in stellar coronae. The Courant-Friedrichs-Lewy (CFL) condition is a cornerstone of explicit numerical methods. The specified parameters are physically realistic for a stellar corona.\n- **Well-Posedness**: The problem is well-posed. It provides all necessary information, including physical laws, parameters, and a clear description of the numerical scheme's properties, to uniquely determine the characteristic speeds and the resulting maximum stable time step.\n- **Objectivity**: The problem is stated in precise, objective, and technical language, free from ambiguity or subjective claims.\n- **Consistency and Completeness**: The setup is self-contained and internally consistent. No required information is missing, and no constraints are contradictory. The simplification to consider only the acoustic-like mode is explicitly stated and serves to make the problem tractable while focusing on the core concept of anisotropic wave propagation.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. It is a scientifically sound, well-posed, and non-trivial problem in computational astrophysics. A full solution will be derived.\n\n### Solution Derivation\nThe solution proceeds in several steps:\n1.  Derive the anisotropic sound speed based on the problem's thermodynamic constraints.\n2.  Determine the directional characteristic speeds, $c_x$ and $c_z$, for waves propagating along the grid axes.\n3.  Calculate the numerical values of the required physical quantities.\n4.  Apply the CFL condition for a directionally split scheme to find the maximum stable time step, $\\Delta t_{\\max}$.\n\n**1. Anisotropic Sound Speed**\nThe problem specifies that the thermal response of the plasma depends on the direction of compression relative to the magnetic field $\\mathbf{B}$.\nLet $\\hat{\\mathbf{b}}$ be the unit vector in the direction of the magnetic field. Since $\\mathbf{B}$ is in the $x$-$z$ plane at an angle $\\phi$ to the $x$-axis, we have:\n$$ \\hat{\\mathbf{b}} = (\\cos\\phi, 0, \\sin\\phi) $$\nThe speed of sound for compressions parallel to $\\mathbf{B}$ is the isothermal sound speed, $c_{\\parallel}$, given by:\n$$ c_{\\parallel}^2 = \\frac{P_0}{\\rho_0} = \\frac{k_B T}{\\mu m_p} $$\nwhere $P_0$ and $\\rho_0$ are the background pressure and density.\nThe speed of sound for compressions perpendicular to $\\mathbf{B}$ is the adiabatic sound speed, $c_{\\perp}$, given by:\n$$ c_{\\perp}^2 = \\frac{\\gamma P_0}{\\rho_0} = \\gamma c_{\\parallel}^2 $$\nFor a general plane wave with wavevector $\\mathbf{k}$, the effective sound speed squared, $c_{\\text{eff}}^2$, is a combination of these, weighted by the direction of $\\mathbf{k}$ relative to $\\hat{\\mathbf{b}}$. Let $\\theta$ be the angle between $\\mathbf{k}$ and $\\mathbf{B}$. The pressure perturbation $p'$ is related to the density perturbation $\\rho'$ by $p' = c_{\\text{eff}}^2 \\rho'$, where:\n$$ c_{\\text{eff}}^2 = c_{\\parallel}^2 \\cos^2\\theta + c_{\\perp}^2 \\sin^2\\theta $$\nThis relation constitutes the anisotropic closure required by the problem.\n\n**2. Directional Characteristic Speeds ($c_x$ and $c_z$)**\nA directionally split numerical scheme treats propagation along each coordinate axis separately. The relevant characteristic speeds are the speeds of waves propagating purely along these axes.\nFor a wave propagating in the $x$-direction, the wavevector is $\\mathbf{k} = (k_x, 0, 0)$, and the unit vector is $\\hat{\\mathbf{k}} = (1, 0, 0)$. The angle $\\theta_x$ between this wavevector and the magnetic field $\\mathbf{B}$ is given by:\n$$ \\cos\\theta_x = \\hat{\\mathbf{k}} \\cdot \\hat{\\mathbf{b}} = (1, 0, 0) \\cdot (\\cos\\phi, 0, \\sin\\phi) = \\cos\\phi $$\nThe characteristic speed in the $x$-direction, $c_x$, is the effective sound speed for this orientation:\n$$ c_x^2 = c_{\\parallel}^2 \\cos^2\\phi + c_{\\perp}^2 \\sin^2\\phi $$\nFor a wave propagating in the $z$-direction, the wavevector is $\\mathbf{k} = (0, 0, k_z)$, and the unit vector is $\\hat{\\mathbf{k}} = (0, 0, 1)$. The angle $\\theta_z$ between this wavevector and $\\mathbf{B}$ is given by:\n$$ \\cos\\theta_z = \\hat{\\mathbf{k}} \\cdot \\hat{\\mathbf{b}} = (0, 0, 1) \\cdot (\\cos\\phi, 0, \\sin\\phi) = \\sin\\phi $$\nThe characteristic speed in the $z$-direction, $c_z$, is then:\n$$ c_z^2 = c_{\\parallel}^2 \\cos^2\\theta_z + c_{\\perp}^2 \\sin^2\\theta_z = c_{\\parallel}^2 \\sin^2\\phi + c_{\\perp}^2 \\cos^2\\phi $$\nThese are the required directional speeds.\n\n**3. Numerical Calculations**\nFirst, we compute the base sound speed $c_{\\parallel}$ using the given parameters: $T = 1.00 \\times 10^6\\ \\mathrm{K}$, $\\mu = 0.6$, $k_{B} = 1.380649 \\times 10^{-23}\\ \\mathrm{J}\\ \\mathrm{K}^{-1}$, and $m_{p} = 1.6726219 \\times 10^{-27}\\ \\mathrm{kg}$.\n$$ c_{\\parallel}^2 = \\frac{k_B T}{\\mu m_p} = \\frac{(1.380649 \\times 10^{-23}\\ \\mathrm{J}\\ \\mathrm{K}^{-1}) (1.00 \\times 10^6\\ \\mathrm{K})}{(0.6)(1.6726219 \\times 10^{-27}\\ \\mathrm{kg})} \\approx 1.375763 \\times 10^{10}\\ \\mathrm{m}^2\\ \\mathrm{s}^{-2} $$\n$$ c_{\\parallel} = \\sqrt{1.375763 \\times 10^{10}\\ \\mathrm{m}^2\\ \\mathrm{s}^{-2}} \\approx 1.17293 \\times 10^5\\ \\mathrm{m}\\ \\mathrm{s}^{-1} $$\nNow we find $c_x$ and $c_z$ with $\\gamma = \\frac{5}{3}$ and $\\phi = 30^{\\circ}$ (so $\\cos^2\\phi = \\frac{3}{4}$ and $\\sin^2\\phi = \\frac{1}{4}$).\n$$ c_x^2 = c_{\\parallel}^2 \\cos^2\\phi + (\\gamma c_{\\parallel}^2) \\sin^2\\phi = c_{\\parallel}^2(\\cos^2\\phi + \\gamma \\sin^2\\phi) = c_{\\parallel}^2 \\left(\\frac{3}{4} + \\frac{5}{3} \\cdot \\frac{1}{4}\\right) = c_{\\parallel}^2 \\left(\\frac{9+5}{12}\\right) = \\frac{7}{6} c_{\\parallel}^2 $$\n$$ c_x = c_{\\parallel} \\sqrt{\\frac{7}{6}} \\approx (1.17293 \\times 10^5\\ \\mathrm{m}\\ \\mathrm{s}^{-1}) \\sqrt{\\frac{7}{6}} \\approx 1.26690 \\times 10^5\\ \\mathrm{m}\\ \\mathrm{s}^{-1} $$\n$$ c_z^2 = c_{\\parallel}^2 \\sin^2\\phi + (\\gamma c_{\\parallel}^2) \\cos^2\\phi = c_{\\parallel}^2(\\sin^2\\phi + \\gamma \\cos^2\\phi) = c_{\\parallel}^2 \\left(\\frac{1}{4} + \\frac{5}{3} \\cdot \\frac{3}{4}\\right) = c_{\\parallel}^2 \\left(\\frac{1+5}{4}\\right) = \\frac{3}{2} c_{\\parallel}^2 $$\n$$ c_z = c_{\\parallel} \\sqrt{\\frac{3}{2}} \\approx (1.17293 \\times 10^5\\ \\mathrm{m}\\ \\mathrm{s}^{-1}) \\sqrt{\\frac{3}{2}} \\approx 1.43647 \\times 10^5\\ \\mathrm{m}\\ \\mathrm{s}^{-1} $$\nNext, we calculate the grid spacings. The isothermal scale height $H$ is:\n$$ H = \\frac{k_B T}{\\mu m_p g} = \\frac{c_{\\parallel}^2}{g} = \\frac{1.375763 \\times 10^{10}\\ \\mathrm{m}^2\\ \\mathrm{s}^{-2}}{274\\ \\mathrm{m}\\ \\mathrm{s}^{-2}} \\approx 5.02103 \\times 10^7\\ \\mathrm{m} $$\nThe grid spacings $\\Delta z$ and $\\Delta x$ are:\n$$ \\Delta z = \\frac{H}{2500} = \\frac{5.02103 \\times 10^7\\ \\mathrm{m}}{2500} \\approx 2.00841 \\times 10^4\\ \\mathrm{m} $$\n$$ \\Delta x = 10 \\Delta z \\approx 2.00841 \\times 10^5\\ \\mathrm{m} $$\n\n**4. CFL Condition and $\\Delta t_{\\max}$**\nFor an explicit, directionally split scheme, the time step $\\Delta t$ must satisfy the CFL condition for each directional sweep. The fastest signal speed in a given direction is the sum of the fluid velocity magnitude and the characteristic speed.\nFor the $x$-sweep:\n$$ \\Delta t \\le C \\frac{\\Delta x}{|u_x| + c_x} $$\nFor the $z$-sweep:\n$$ \\Delta t \\le C \\frac{\\Delta z}{|u_z| + c_z} $$\nThe maximum stable time step for a full $x$-$z$ update, $\\Delta t_{\\max}$, is limited by the more restrictive of these two conditions:\n$$ \\Delta t_{\\max} = C \\cdot \\min \\left( \\frac{\\Delta x}{|u_x| + c_x}, \\frac{\\Delta z}{|u_z| + c_z} \\right) $$\nWe now substitute the numerical values: $C = 0.5$, $u_x = 4.00 \\times 10^4\\ \\mathrm{m}\\ \\mathrm{s}^{-1}$, $u_z = 0\\ \\mathrm{m}\\ \\mathrm{s}^{-1}$.\nThe time scale for the $x$-sweep is:\n$$ \\tau_x = \\frac{\\Delta x}{|u_x| + c_x} = \\frac{2.00841 \\times 10^5\\ \\mathrm{m}}{4.00 \\times 10^4\\ \\mathrm{m}\\ \\mathrm{s}^{-1} + 1.26690 \\times 10^5\\ \\mathrm{m}\\ \\mathrm{s}^{-1}} = \\frac{2.00841 \\times 10^5\\ \\mathrm{m}}{1.66690 \\times 10^5\\ \\mathrm{m}\\ \\mathrm{s}^{-1}} \\approx 1.20488\\ \\mathrm{s} $$\nThe time scale for the $z$-sweep is:\n$$ \\tau_z = \\frac{\\Delta z}{|u_z| + c_z} = \\frac{2.00841 \\times 10^4\\ \\mathrm{m}}{0\\ \\mathrm{m}\\ \\mathrm{s}^{-1} + 1.43647 \\times 10^5\\ \\mathrm{m}\\ \\mathrm{s}^{-1}} = \\frac{2.00841 \\times 10^4\\ \\mathrm{m}}{1.43647 \\times 10^5\\ \\mathrm{m}\\ \\mathrm{s}^{-1}} \\approx 0.13981\\ \\mathrm{s} $$\nThe minimum of these two time scales is $\\tau_z \\approx 0.13981\\ \\mathrm{s}$. Thus, the maximum stable time step is:\n$$ \\Delta t_{\\max} = C \\cdot \\min(\\tau_x, \\tau_z) = 0.5 \\times 0.13981\\ \\mathrm{s} \\approx 0.069905\\ \\mathrm{s} $$\nRounding to four significant figures as required gives $\\Delta t_{\\max} \\approx 0.06991\\ \\mathrms$.",
            "answer": "$$\n\\boxed{0.06991}\n$$"
        },
        {
            "introduction": "Modern simulations often use Adaptive Mesh Refinement (AMR) to focus computational resources where they are most needed. This practice delves into the subtle but critical constraints that AMR imposes on the time step, beyond the basic CFL condition . You will develop a subcycling policy that not only ensures stability on each refinement level but also maintains causal consistency across the boundaries between fine and coarse grids, preventing information from propagating into regions with out-of-date data.",
            "id": "3538578",
            "problem": "You are to implement, in a fully self-contained program, a subcycling time-integration policy for Adaptive Mesh Refinement (AMR) that enforces the Courant-Friedrichs-Lewy (CFL) condition together with causal consistency across refinement levels. The goal is to ensure that during subcycled evolution, the numerical domain of dependence of each refinement level is contained within valid data regions and that information cones described by $x \\pm \\lambda \\Delta t$ do not cross fine–coarse interfaces without synchronization. The physical context is one-dimensional blast waves governed by hyperbolic conservation laws with a known maximum characteristic signal speed.\n\nFundamental base and assumptions:\n\n- Consider a hyperbolic system with maximum characteristic speed $\\lambda$ such that all physical signals satisfy $|\\mathrm{d}x/\\mathrm{d}t| \\le \\lambda$. The domain of dependence for signals over a time increment $\\Delta t$ lies within the interval $x \\pm \\lambda \\Delta t$.\n- For explicit methods, a stability requirement is that the Courant number $C$ satisfies $C \\in (0,1]$, and time steps obey a bound consistent with the definition of the Courant number. You should not assume any particular discretization beyond this stability interpretation.\n- For an ideal gas with adiabatic index $\\gamma$, the local sound speed $c$ satisfies $c = \\sqrt{\\gamma p/\\rho}$, where $\\rho$ is the mass density and $p$ is the pressure. A robust bound on the maximum characteristic speed for Euler-like flows is $\\lambda = \\max\\left(|u| + c\\right)$ over relevant states, where $u$ is the fluid velocity in the laboratory frame.\n- The AMR hierarchy consists of levels $\\ell = 0,1,\\dots,L-1$, with level $\\ell = 0$ being the coarsest. The spatial step at level $\\ell$ is $\\Delta x_\\ell = \\Delta x_0 / r^\\ell$, where $r \\ge 2$ is an integer refinement ratio between successive levels. The time step at level $\\ell$ is subcycled by a factor $r$, so that $\\Delta t_\\ell = \\Delta t_0 / r^\\ell$, where $\\Delta t_0$ is the level-$0$ time step.\n- Each level $\\ell \\ge 1$ is adjacent to its parent level $\\ell - 1$ along fine–coarse interfaces. Let $g_\\ell$ be the number of ghost cells maintained at level $\\ell$ (expressed as a nonnegative integer count of cells) that provide valid boundary data for level $\\ell$ between synchronizations with level $\\ell-1$.\n\nCausal consistency concept to be enforced:\n\n- Over any coarse-level advancement interval separating synchronizations between level $\\ell$ and level $\\ell-1$, the information cone defined by $x \\pm \\lambda \\Delta t$ at level $\\ell$ must remain within the region covered by valid data prepared at the previous synchronization. In other words, the distance $\\lambda$ can propagate over the time interval between synchronizations must not exceed the spatial buffer represented by $g_\\ell$ ghost cells of size $\\Delta x_\\ell$.\n- Simultaneously, at each level, the usual interpretation of the Courant number must hold so that the per-level time step is also bounded appropriately by the ratio of spatial step to maximum signal speed scaled by $C$.\n\nYour task is to implement the following steps from first principles:\n\n1. Given left and right blast-wave states with densities $\\rho_{\\mathrm{L}}$, $\\rho_{\\mathrm{R}}$, pressures $p_{\\mathrm{L}}$, $p_{\\mathrm{R}}$, velocities $u_{\\mathrm{L}}$, $u_{\\mathrm{R}}$, and adiabatic index $\\gamma$, compute a robust bound on the maximum characteristic speed $\\lambda$ by evaluating $c_{\\mathrm{L}} = \\sqrt{\\gamma p_{\\mathrm{L}}/\\rho_{\\mathrm{L}}}$ and $c_{\\mathrm{R}} = \\sqrt{\\gamma p_{\\mathrm{R}}/\\rho_{\\mathrm{R}}}$, then taking $\\lambda = \\max\\left(|u_{\\mathrm{L}}| + c_{\\mathrm{L}}, |u_{\\mathrm{R}}| + c_{\\mathrm{R}}\\right)$.\n\n2. Using only the above definitions and concepts:\n   - Design a subcycling policy that assigns a single base time step $\\Delta t_0$ for level $\\ell = 0$ and induces $\\Delta t_\\ell = \\Delta t_0 / r^\\ell$ for all finer levels so that:\n     - The explicit-stability interpretation of the Courant number $C$ holds simultaneously at all levels.\n     - The causal consistency condition is respected, meaning that information cones at level $\\ell$ cannot cross a fine–coarse boundary into regions without synchronized data during the time interval between synchronizations of levels $\\ell$ and $\\ell-1$.\n   - Your derivation must make clear how the synchronization interval between levels and the ghost-zone buffer expressed by $g_\\ell$ in units of $\\Delta x_\\ell$ jointly constrain $\\Delta t_0$ in addition to the usual Courant constraint.\n\n3. Implement a verifier that, for a given AMR configuration, checks:\n   - For each interface between levels $\\ell-1$ and $\\ell$ with $\\ell \\ge 1$, the causal no-crossing condition measured over the synchronization interval between those levels.\n   - For each level $\\ell$, the Courant number interpretation for explicit stability.\n\n4. Output, for each test case described below, the following in a consistent format:\n   - A boolean indicating whether all constraints are satisfied by your chosen $\\Delta t_0$ and the induced $\\Delta t_\\ell$ for all levels and interfaces.\n   - An integer flag equal to $0$ if the limiting bound on $\\Delta t_0$ comes from the Courant interpretation and equal to $1$ if it comes from the causal synchronization requirement.\n   - The base time step $\\Delta t_0$ in seconds, rounded to six decimal places.\n   - The number of subcycles taken by the finest level per one coarse-level step, which equals $r^{L-1}$, as a nonnegative integer.\n\nPhysical and numerical units:\n\n- All physical quantities must be in the International System of Units (SI). The base spatial step $\\Delta x_0$ must be in meters, velocities $u$ in meters per second, densities $\\rho$ in kilograms per cubic meter, pressures $p$ in Pascals, and the adiabatic index $\\gamma$ is dimensionless.\n- The time steps must be expressed in seconds. The printed $\\Delta t_0$ must be rounded to six decimal places.\n- No angles are used.\n\nTest suite to be used by your program:\n\n- Test case $1$ (happy path where the Courant interpretation dominates):\n  - $\\Delta x_0 = 1.0 \\times 10^{6}~\\mathrm{m}$, $r = 2$, $L = 2$, $C = 0.8$, $\\gamma = 5/3$.\n  - Ghost-cell counts by level: `[2, 2]` (use $g_\\ell$ for $\\ell \\ge 1$ in the causal constraint).\n  - Left state: $\\rho_{\\mathrm{L}} = 1.0 \\times 10^{-21}~\\mathrm{kg/m^3}$, $p_{\\mathrm{L}} = 1.0 \\times 10^{-9}~\\mathrm{Pa}$, $u_{\\mathrm{L}} = 0.0~\\mathrm{m/s}$.\n  - Right state: $\\rho_{\\mathrm{R}} = 1.0 \\times 10^{-21}~\\mathrm{kg/m^3}$, $p_{\\mathrm{R}} = 1.0 \\times 10^{-11}~\\mathrm{Pa}$, $u_{\\mathrm{R}} = 0.0~\\mathrm{m/s}$.\n\n- Test case $2$ (boundary case where the causal synchronization constraint dominates due to small ghost buffer and large refinement ratio):\n  - $\\Delta x_0 = 1.0 \\times 10^{5}~\\mathrm{m}$, $r = 4$, $L = 3$, $C = 0.9$, $\\gamma = 5/3$.\n  - Ghost-cell counts by level: `[2, 1, 1]`.\n  - Left state: $\\rho_{\\mathrm{L}} = 2.0 \\times 10^{-21}~\\mathrm{kg/m^3}$, $p_{\\mathrm{L}} = 5.0 \\times 10^{-10}~\\mathrm{Pa}$, $u_{\\mathrm{L}} = 0.0~\\mathrm{m/s}$.\n  - Right state: $\\rho_{\\mathrm{R}} = 2.0 \\times 10^{-21}~\\mathrm{kg/m^3}$, $p_{\\mathrm{R}} = 5.0 \\times 10^{-12}~\\mathrm{Pa}$, $u_{\\mathrm{R}} = 0.0~\\mathrm{m/s}$.\n\n- Test case $3$ (edge case with nonzero bulk velocities and multiple levels where causal synchronization dominates):\n  - $\\Delta x_0 = 5.0 \\times 10^{5}~\\mathrm{m}$, $r = 2$, $L = 3$, $C = 0.6$, $\\gamma = 5/3$.\n  - Ghost-cell counts by level: `[1, 2, 3]`.\n  - Left state: $\\rho_{\\mathrm{L}} = 1.0 \\times 10^{-19}~\\mathrm{kg/m^3}$, $p_{\\mathrm{L}} = 1.0 \\times 10^{-8}~\\mathrm{Pa}$, $u_{\\mathrm{L}} = 2.0 \\times 10^{5}~\\mathrm{m/s}$.\n  - Right state: $\\rho_{\\mathrm{R}} = 5.0 \\times 10^{-20}~\\mathrm{kg/m^3}$, $p_{\\mathrm{R}} = 2.0 \\times 10^{-9}~\\mathrm{Pa}$, $u_{\\mathrm{R}} = -1.0 \\times 10^{5}~\\mathrm{m/s}$.\n\nRequired final output format:\n\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element corresponds to one test case and is itself a list of the form $[\\text{boolean}, \\text{integer}, \\text{float}, \\text{integer}]$, namely $[\\text{causal_ok}, \\text{limiter_flag}, \\Delta t_0, r^{L-1}]$. For example, a syntactically valid output could look like `[[True,0,0.123456,4],[True,1,0.000321,16],[True,1,1.234000,4]]` but with the numerically correct values for the specified test suite.",
            "solution": "The problem requires the design and implementation of a subcycling time-step policy for an Adaptive Mesh Refinement (AMR) simulation that satisfies both the Courant-Friedrichs-Lewy (CFL) stability condition and a causal consistency constraint at fine-coarse grid interfaces. I will first validate the problem statement and then, upon confirmation of its validity, proceed to derive the necessary mathematical constraints from first principles and implement them programmatically.\n\n### Problem Validation\n\n**Step 1: Extracted Givens**\n-   **Hyperbolic System**: Maximum characteristic speed $\\lambda$, such that $|\\mathrm{d}x/\\mathrm{d}t| \\le \\lambda$.\n-   **Stability**: Courant number $C \\in (0,1]$.\n-   **Fluid Properties**: Adiabatic index $\\gamma$, density $\\rho$, pressure $p$, velocity $u$.\n-   **Sound Speed**: $c = \\sqrt{\\gamma p/\\rho}$.\n-   **Speed Bound**: $\\lambda = \\max\\left(|u_{\\mathrm{L}}| + c_{\\mathrm{L}}, |u_{\\mathrm{R}}| + c_{\\mathrm{R}}\\right)$ for given left (L) and right (R) states.\n-   **AMR Hierarchy**: Levels $\\ell = 0, \\dots, L-1$.\n-   **Refinement Ratio**: Integer $r \\ge 2$.\n-   **Grid Spacing**: $\\Delta x_\\ell = \\Delta x_0 / r^\\ell$.\n-   **Time Stepping**: $\\Delta t_\\ell = \\Delta t_0 / r^\\ell$.\n-   **Ghost Cells**: $g_\\ell$ is the integer count of ghost cells for level $\\ell \\ge 1$.\n-   **Causal Consistency**: For an interface between levels $\\ell-1$ and $\\ell$, the information propagation distance over the synchronization interval, $\\lambda T_{sync}$, must not exceed the ghost cell buffer width, $g_\\ell \\Delta x_\\ell$. The synchronization interval is the time step of the parent level, $\\Delta t_{\\ell-1}$.\n\n**Step 2: Validation Using Extracted Givens**\n-   **Scientific Grounding**: The problem is well-grounded in the fundamental principles of numerical methods for hyperbolic partial differential equations, specifically within the context of computational fluid dynamics and astrophysics. The concepts of CFL stability, AMR, subcycling, and causal consistency at refinement boundaries are standard and critically important in this field. The physical model (ideal gas, Euler-like flow) is appropriate.\n-   **Well-Posedness**: The problem is well-posed. It provides all necessary parameters and definitions to derive a unique, maximum allowable base time step $\\Delta t_0$ that satisfies all stated constraints.\n-   **Objectivity**: The problem is stated using precise, objective, and formalizable scientific and mathematical language.\n\n**Step 3: Verdict and Action**\nThe problem is **valid**. It is a standard, well-defined problem in computational science. I will now proceed with the solution.\n\n### Derivation of the Time-Step Policy\n\nThe goal is to find the maximum possible base time step $\\Delta t_0$ that simultaneously satisfies two independent constraints for all levels in the AMR hierarchy.\n\n**1. The Courant-Friedrichs-Lewy (CFL) Stability Constraint**\n\nFor an explicit numerical scheme, stability requires that the time step $\\Delta t_\\ell$ at any level $\\ell$ obey the CFL condition:\n$$ \\Delta t_\\ell \\le C \\frac{\\Delta x_\\ell}{\\lambda} $$\nwhere $C$ is the Courant number and $\\lambda$ is the global maximum characteristic speed. The problem specifies a uniform subcycling policy where $\\Delta t_\\ell = \\Delta t_0 / r^\\ell$ and $\\Delta x_\\ell = \\Delta x_0 / r^\\ell$. Substituting these into the CFL condition for an arbitrary level $\\ell$:\n$$ \\frac{\\Delta t_0}{r^\\ell} \\le C \\frac{\\Delta x_0 / r^\\ell}{\\lambda} $$\nMultiplying both sides by $r^\\ell$, we find that the condition on $\\Delta t_0$ is independent of the level $\\ell$:\n$$ \\Delta t_0 \\le C \\frac{\\Delta x_0}{\\lambda} $$\nThis means that if the base time step $\\Delta t_0$ satisfies the CFL condition on the coarsest grid ($\\ell=0$), the condition is automatically satisfied on all finer levels with the same effective Courant number, $C_\\ell = (\\lambda \\Delta t_\\ell) / \\Delta x_\\ell = (\\lambda \\Delta t_0) / \\Delta x_0 = C_0$. Thus, the first constraint on $\\Delta t_0$ is:\n$$ \\Delta t_{0, \\text{CFL}} = C \\frac{\\Delta x_0}{\\lambda} $$\n\n**2. The Causal Consistency Constraint**\n\nThis constraint ensures that information propagating on a fine grid does not outrun the boundary data provided by its coarser parent grid. Level $\\ell$ performs $r$ time steps of size $\\Delta t_\\ell$ for every single time step of its parent, level $\\ell-1$. The boundary data for level $\\ell$, stored in $g_\\ell$ ghost cells, are held constant during this synchronization interval, which has a duration of $T_{sync, \\ell} = \\Delta t_{\\ell-1}$.\n\nThe causal consistency condition states that a physical signal, traveling at the maximum speed $\\lambda$, cannot cross the entire ghost-cell buffer during this synchronization interval. The physical width of the ghost-cell buffer at level $\\ell$ is $W_{ghost, \\ell} = g_\\ell \\Delta x_\\ell$. The maximum distance a signal can propagate is $D_{prop, \\ell} = \\lambda T_{sync, \\ell}$. The constraint is therefore:\n$$ D_{prop, \\ell} \\le W_{ghost, \\ell} $$\n$$ \\lambda \\Delta t_{\\ell-1} \\le g_\\ell \\Delta x_\\ell $$\nWe substitute the subcycling relations $\\Delta t_{\\ell-1} = \\Delta t_0 / r^{\\ell-1}$ and $\\Delta x_\\ell = \\Delta x_0 / r^\\ell$:\n$$ \\lambda \\frac{\\Delta t_0}{r^{\\ell-1}} \\le g_\\ell \\frac{\\Delta x_0}{r^\\ell} $$\nSolving for $\\Delta t_0$, we obtain the constraint for the interface between levels $\\ell-1$ and $\\ell$:\n$$ \\Delta t_0 \\le \\frac{g_\\ell \\Delta x_0}{r^\\ell} \\frac{r^{\\ell-1}}{\\lambda} = \\frac{g_\\ell \\Delta x_0}{r \\lambda} $$\nThis condition must hold for all interfaces, i.e., for all $\\ell \\in \\{1, \\dots, L-1\\}$. To satisfy all these constraints with a single $\\Delta t_0$, we must take the most restrictive (minimum) bound:\n$$ \\Delta t_0 \\le \\min_{\\ell=1, \\dots, L-1} \\left(\\frac{g_\\ell \\Delta x_0}{r \\lambda}\\right) = \\frac{\\Delta x_0}{r \\lambda} \\min_{\\ell=1, \\dots, L-1}(g_\\ell) $$\nLet $g_{\\min} = \\min\\{g_1, g_2, \\dots, g_{L-1}\\}$. The second constraint on $\\Delta t_0$ is:\n$$ \\Delta t_{0, \\text{causal}} = \\frac{g_{\\min} \\Delta x_0}{r \\lambda} $$\nThis constraint is not applicable if $L=1$, as there are no fine-coarse interfaces.\n\n**3. Final Time-Step Policy**\n\nThe chosen base time step $\\Delta t_0$ must satisfy both the CFL and causal consistency constraints. Therefore, the maximal allowed time step is the minimum of the two derived bounds:\n$$ \\Delta t_0 = \\min\\left( \\Delta t_{0, \\text{CFL}}, \\Delta t_{0, \\text{causal}} \\right) = \\min\\left( C \\frac{\\Delta x_0}{\\lambda}, \\frac{g_{\\min} \\Delta x_0}{r \\lambda} \\right) $$\nThis can be rewritten as:\n$$ \\Delta t_0 = \\frac{\\Delta x_0}{\\lambda} \\min\\left(C, \\frac{g_{\\min}}{r}\\right) $$\nThe flag indicating the limiting factor is determined by comparing the two terms in the minimum:\n-   If $C \\le g_{\\min}/r$, the CFL condition is the limiter (flag $0$).\n-   If $C > g_{\\min}/r$, the causal consistency condition is the limiter (flag $1$).\n\nThis derived policy is implemented in the following program.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates and verifies the AMR subcycling time-step policy for a suite of test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test case 1\n        {\n            \"dx0\": 1.0e6, \"r\": 2, \"L\": 2, \"C\": 0.8, \"gamma\": 5/3,\n            \"g_counts\": [2, 2],\n            \"state_L\": (1.0e-21, 1.0e-9, 0.0), # (rho, p, u)\n            \"state_R\": (1.0e-21, 1.0e-11, 0.0)\n        },\n        # Test case 2\n        {\n            \"dx0\": 1.0e5, \"r\": 4, \"L\": 3, \"C\": 0.9, \"gamma\": 5/3,\n            \"g_counts\": [2, 1, 1],\n            \"state_L\": (2.0e-21, 5.0e-10, 0.0),\n            \"state_R\": (2.0e-21, 5.0e-12, 0.0)\n        },\n        # Test case 3\n        {\n            \"dx0\": 5.0e5, \"r\": 2, \"L\": 3, \"C\": 0.6, \"gamma\": 5/3,\n            \"g_counts\": [1, 2, 3],\n            \"state_L\": (1.0e-19, 1.0e-8, 2.0e5),\n            \"state_R\": (5.0e-20, 2.0e-9, -1.0e5)\n        },\n    ]\n\n    results_as_strings = []\n    for case in test_cases:\n        # Unpack problem parameters\n        dx0, r, L, C = case[\"dx0\"], case[\"r\"], case[\"L\"], case[\"C\"]\n        gamma, g_counts = case[\"gamma\"], case[\"g_counts\"]\n        rho_L, p_L, u_L = case[\"state_L\"]\n        rho_R, p_R, u_R = case[\"state_R\"]\n\n        # Step 1: Compute the maximum characteristic speed lambda\n        c_L = np.sqrt(gamma * p_L / rho_L)\n        c_R = np.sqrt(gamma * p_R / rho_R)\n        lam = np.max([np.abs(u_L) + c_L, np.abs(u_R) + c_R])\n\n        # Step 2: Derive and compare time step constraints\n        # Constraint 1: CFL stability bound\n        dt0_cfl_bound = C * dx0 / lam\n\n        # Constraint 2: Causal consistency bound\n        if L  1:\n            g_min = min(g_counts[1:])\n            dt0_causal_bound = (g_min * dx0) / (r * lam)\n        else:\n            # No causal constraint for a single level, so set bound to infinity\n            dt0_causal_bound = float('inf')\n\n        # Determine the limiting constraint and the final base time step dt0\n        if dt0_cfl_bound = dt0_causal_bound:\n            limiter_flag = 0  # CFL condition is the limiter\n            dt0 = dt0_cfl_bound\n        else:\n            limiter_flag = 1  # Causal consistency is the limiter\n            dt0 = dt0_causal_bound\n\n        # Step 3: Verify that the chosen dt0 satisfies all constraints\n        causal_ok = True\n        tolerance = 1e-9  # For robust floating-point comparisons\n\n        # Verify CFL condition (one check is sufficient for all levels)\n        if (lam * dt0 / dx0)  C + tolerance:\n            causal_ok = False\n\n        # Verify causal consistency for each fine-coarse interface\n        if L  1:\n            for ell in range(1, L):\n                # lhs: propagation distance during synchronization interval dt_{ell-1}\n                lhs = lam * (dt0 / (r**(ell - 1)))\n                # rhs: ghost cell buffer width at level ell\n                rhs = g_counts[ell] * (dx0 / (r**ell))\n                if lhs  rhs + tolerance:\n                    causal_ok = False\n        \n        # Step 4: Calculate the number of subcycles for the finest level\n        num_subcycles = int(r**(L - 1))\n\n        # Format the result list into a string as per the specified format\n        # [boolean, integer, float, integer]\n        result_str = f\"[{causal_ok},{limiter_flag},{dt0:.6f},{num_subcycles}]\"\n        results_as_strings.append(result_str)\n\n    # Final print statement in the exact required format: [[...],[...],...]\n    print(f\"[{','.join(results_as_strings)}]\")\n\nsolve()\n```"
        }
    ]
}