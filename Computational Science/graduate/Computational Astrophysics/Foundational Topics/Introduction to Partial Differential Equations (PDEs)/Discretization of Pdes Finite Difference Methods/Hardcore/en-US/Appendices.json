{
    "hands_on_practices": [
        {
            "introduction": "The stability of a numerical scheme is paramount; an unstable method is useless for physical simulation. This first practice introduces the von Neumann stability analysis, a cornerstone technique for investigating how errors propagate in finite difference schemes. By applying it to the classic Forward-Time, Centered-Space (FTCS) discretization of the diffusion equation, you will determine the precise mathematical condition under which the simulation remains stable, a crucial skill for developing and debugging numerical codes. ",
            "id": "3508817",
            "problem": "In modeling electron thermal conduction in an optically thick accretion disk annulus, consider the scalar diffusion of temperature in one spatial dimension with periodic boundary conditions. On a uniform grid with spacing $\\Delta x$ and time step $\\Delta t$, an explicit forward-time, centered-space (FTCS) finite difference method advances the nodal temperature $u_i^n$ according to\n$$\nu_i^{n+1} \\;=\\; u_i^n \\;+\\; \\mu \\,\\big(u_{i+1}^n \\;-\\; 2\\,u_i^n \\;+\\; u_{i-1}^n\\big),\n$$\nwhere $\\mu \\equiv \\chi\\,\\Delta t/\\Delta x^2$ and $\\chi$ is the thermal diffusivity. Using von Neumann (Fourier) stability analysis from first principles, determine the largest value of the dimensionless diffusion number $\\mu$ for which the scheme is linearly stable for all spatial Fourier modes. Provide your answer as an exact analytic number. No rounding is required, and no physical units should be included in the final answer.",
            "solution": "The user wants to find the stability criterion for a given finite difference scheme using von Neumann analysis.\n\n### Step 1: Problem Validation\n\n**1.1. Extract Givens:**\n- **Governing Process:** Scalar diffusion of temperature in one spatial dimension, $u_t = \\chi u_{xx}$.\n- **Discretization Scheme:** Explicit Forward-Time, Centered-Space (FTCS).\n- **Update Rule:** $u_i^{n+1} = u_i^n + \\mu (u_{i+1}^n - 2u_i^n + u_{i-1}^n)$.\n- **Variables:** $u_i^n$ is the temperature at spatial grid point $i$ and time step $n$.\n- **Grid:** Uniform spatial spacing $\\Delta x$ and time step $\\Delta t$.\n- **Dimensionless Diffusion Number:** $\\mu \\equiv \\chi \\Delta t / \\Delta x^2$.\n- **Physical Constant:** $\\chi$ is the thermal diffusivity.\n- **Boundary Conditions:** Periodic.\n- **Methodology:** Von Neumann (Fourier) stability analysis from first principles.\n- **Objective:** Determine the largest value of $\\mu$ for which the scheme is linearly stable for all spatial Fourier modes.\n\n**1.2. Validate Using Extracted Givens:**\n- **Scientific Grounding:** The problem is a canonical example in the study of numerical solutions to partial differential equations (PDEs), specifically the heat/diffusion equation. The FTCS scheme is a standard (though conditionally stable) method, and von Neumann analysis is the appropriate tool for analyzing its stability under periodic boundary conditions. The physical context of accretion disks is a valid application area for such models. The problem is scientifically and mathematically sound.\n- **Well-Posedness:** The problem is well-posed. It asks for a specific, uniquely determinable value (the stability limit of $\\mu$) using a specified, standard mathematical procedure.\n- **Objectivity:** The problem is stated in clear, objective, and unambiguous technical language.\n- **Completeness and Consistency:** The problem provides all necessary information: the discretization scheme, the definition of the parameter $\\mu$, the required analysis method, and the specific property to be determined. There are no contradictions.\n\n**1.3. Verdict and Action:**\nThe problem is valid. It is a standard, well-posed problem in computational physics. A solution will be derived.\n\n### Step 2: Solution Derivation\n\nThe analysis proceeds by applying the von Neumann stability method to the given FTCS finite difference equation. The core idea is to decompose the numerical solution at a given time step into its spatial Fourier modes and to determine the condition under which the amplitude of every mode does not grow in subsequent time steps.\n\nLet the nodal temperature $u_i^n$ at grid point $x_i = i\\Delta x$ and time $t_n = n\\Delta t$ be represented by a single generic Fourier mode. Due to the linearity of the difference equation, the behavior of a full Fourier series solution is determined by the behavior of its individual modes. A generic mode has the form:\n$$\nu_i^n = A(k)^n e^{I k x_i} = A^n e^{I k i \\Delta x}\n$$\nwhere $k$ is the spatial wavenumber, $I \\equiv \\sqrt{-1}$ is the imaginary unit, and $A(k)$ is the amplification factor for the mode with wavenumber $k$. For simplicity, we denote $A(k)$ as $A$. A new amplitude $A^{n+1}$ is obtained at the next time step. For the scheme to be stable, the magnitude of the amplification factor must not exceed unity for any wavenumber $k$. This is the von Neumann stability condition:\n$$\n|A| = \\left|\\frac{A^{n+1}}{A^n}\\right| \\le 1 \\quad \\forall k\n$$\n\nWe substitute the Fourier mode representation into the given FTCS scheme:\n$$\nu_i^{n+1} = u_i^n + \\mu (u_{i+1}^n - 2u_i^n + u_{i-1}^n)\n$$\nSubstituting $u_j^m = A^m e^{I k j \\Delta x}$ for $(m,j) \\in \\{(n, i-1), (n, i), (n, i+1), (n+1, i)\\}$:\n$$\nA^{n+1} e^{I k i \\Delta x} = A^n e^{I k i \\Delta x} + \\mu \\left( A^n e^{I k (i+1) \\Delta x} - 2 A^n e^{I k i \\Delta x} + A^n e^{I k (i-1) \\Delta x} \\right)\n$$\nWe can divide the entire equation by the non-zero common factor $A^n e^{I k i \\Delta x}$ to find the amplification factor $A = A^{n+1}/A^n$:\n$$\nA = 1 + \\mu \\left( e^{I k \\Delta x} - 2 + e^{-I k \\Delta x} \\right)\n$$\nUsing Euler's identity, $e^{I\\theta} + e^{-I\\theta} = 2\\cos(\\theta)$, we can simplify the term in the parentheses:\n$$\ne^{I k \\Delta x} + e^{-I k \\Delta x} = 2\\cos(k \\Delta x)\n$$\nSubstituting this back into the expression for $A$:\n$$\nA = 1 + \\mu \\left( 2\\cos(k \\Delta x) - 2 \\right) = 1 - 2\\mu \\left( 1 - \\cos(k \\Delta x) \\right)\n$$\nTo further simplify, we use the half-angle trigonometric identity $1 - \\cos(\\theta) = 2\\sin^2(\\theta/2)$:\n$$\nA = 1 - 2\\mu \\left( 2\\sin^2\\left(\\frac{k \\Delta x}{2}\\right) \\right) = 1 - 4\\mu \\sin^2\\left(\\frac{k \\Delta x}{2}\\right)\n$$\nThe amplification factor $A$ is a purely real quantity. Therefore, the stability condition $|A| \\le 1$ translates to the inequalities:\n$$\n-1 \\le A \\le 1\n$$\nLet's analyze these two inequalities separately.\n\nFirst, the upper bound:\n$$\nA \\le 1 \\implies 1 - 4\\mu \\sin^2\\left(\\frac{k \\Delta x}{2}\\right) \\le 1\n$$\n$$\n-4\\mu \\sin^2\\left(\\frac{k \\Delta x}{2}\\right) \\le 0\n$$\nSince $\\mu \\equiv \\chi \\Delta t / \\Delta x^2$ must be non-negative (as physical diffusivity $\\chi$, time step $\\Delta t$, and grid spacing $\\Delta x$ are non-negative), and $\\sin^2(\\cdot)$ is always non-negative, this inequality $A \\le 1$ is unconditionally satisfied. This is expected for a diffusive process, which should not amplify any mode.\n\nSecond, the lower bound, which imposes the crucial constraint:\n$$\nA \\ge -1 \\implies 1 - 4\\mu \\sin^2\\left(\\frac{k \\Delta x}{2}\\right) \\ge -1\n$$\n$$\n2 \\ge 4\\mu \\sin^2\\left(\\frac{k \\Delta x}{2}\\right)\n$$\n$$\n\\mu \\sin^2\\left(\\frac{k \\Delta x}{2}\\right) \\le \\frac{1}{2}\n$$\nThis condition must hold for all possible wavenumbers $k$ that can be represented on the grid. The stability of the scheme is limited by the \"worst-case\" mode, which is the mode that maximizes the term $\\sin^2(k \\Delta x / 2)$, thereby making the constraint on $\\mu$ most stringent. The range of the $\\sin^2$ function is $[0, 1]$. The maximum value is $1$. This maximum occurs for the highest frequency (most oscillatory) mode representable on the grid, which corresponds to $k \\Delta x = \\pi$. This is the Nyquist frequency, with a wavelength of $2\\Delta x$.\n\nTo ensure stability for all modes, we must satisfy the inequality for this worst-case scenario:\n$$\n\\max\\left[\\sin^2\\left(\\frac{k \\Delta x}{2}\\right)\\right] = 1\n$$\nSubstituting this maximum value into the stability inequality:\n$$\n\\mu \\cdot 1 \\le \\frac{1}{2}\n$$\n$$\n\\mu \\le \\frac{1}{2}\n$$\nThis is the famous Courant-Friedrichs-Lewy (CFL) condition for the $1$D diffusion equation solved with the FTCS scheme. The scheme is stable if and only if $\\mu \\le 1/2$. The problem asks for the largest value of $\\mu$ for which the scheme is stable. This corresponds to the equality in the condition.\n\nThus, the largest value of the dimensionless diffusion number $\\mu$ is $1/2$.",
            "answer": "$$\n\\boxed{\\frac{1}{2}}\n$$"
        },
        {
            "introduction": "Explicit methods, while simple, often suffer from restrictive time step constraints. This practice explores the widely-used Crank-Nicolson scheme, an implicit method that is unconditionally stable and thus allows for much larger time steps. However, you will discover a critical subtlety: stability does not guarantee physical fidelity, as the scheme can introduce spurious oscillations. Through a combination of analytical derivation and numerical implementation, you will investigate this trade-off and learn why robust numerical modeling requires looking beyond formal stability criteria. ",
            "id": "3508814",
            "problem": "Consider the one-dimensional heat equation (thermal diffusion) in a periodic domain as a canonical model for diffusive transport in computational astrophysics, expressed in dimensionless form as $$\\frac{\\partial u(x,t)}{\\partial t} = \\nu \\frac{\\partial^2 u(x,t)}{\\partial x^2},$$ where $u(x,t)$ is the scalar field (e.g., a temperature proxy), and $\\nu$ is a positive diffusion coefficient. Let the spatial domain be $[0,1]$ with periodic boundary conditions. Discretize the domain with $N$ uniformly spaced grid points with spacing $\\Delta x = 1/N$. Consider the Crank-Nicolson time discretization, which is second-order accurate in time and uses midpoint averaging of the spatial operator over time levels. Use a centered second-order finite difference for the spatial second derivative and apply the periodic boundary condition in the discrete operator. \n\nYour tasks are:\n- Derive, from first principles, the linear amplification factor of the Crank-Nicolson scheme for the discrete Fourier mode $e^{i k x}$ under the above discretization and periodic boundary conditions, as a function of the nondimensional parameter $r = \\nu \\Delta t / \\Delta x^2$ and the grid-resolved wavenumber. Use the definition of von Neumann stability based on the magnitude of the amplification factor.\n- Using the derived amplification factor, explain why Crank-Nicolson is unconditionally stable for the heat equation, yet can produce spurious oscillations for large $\\Delta t$ due to sign changes in the amplification factor for sufficiently high-frequency modes.\n- Implement a program that carries out the following for each test case in the provided suite:\n    1. Construct the discrete periodic Laplacian and perform one Crank-Nicolson time step from the initial condition that is a step function: $u(x,0) = 1$ for $x  1/2$ and $u(x,0) = 0$ for $x \\ge 1/2$. Detect spurious oscillations by checking if the minimum of the numerical solution after one time step is negative (which violates the discrete maximum principle for a positive initial condition).\n    2. Compute the amplification factor at all grid-resolved discrete modes, and report the maximum magnitude of the amplification factor over all modes.\n    3. Compute the fraction of grid-resolved modes whose amplification factor is negative, indicating sign-flipping and potential oscillatory behavior in time for those modes.\n\nUse purely dimensionless quantities; no physical units are required. The angle unit for Fourier-mode analysis is radians. The final output must be a single line containing the aggregate results for all test cases as a comma-separated list enclosed in square brackets, where each test case contributes a nested list in the form $[\\text{max\\_abs\\_G}, \\text{fraction\\_negative\\_G}, \\text{oscillation\\_boolean}]$.\n\nTest suite:\n- Case A (happy path): $N = 64$, $\\nu = 1$, $\\Delta t = 5 \\times 10^{-5}$.\n- Case B (boundary condition): $N = 64$, $\\nu = 1$, $\\Delta t = 0.5 \\Delta x^2$ (i.e., $\\Delta t = 0.5 / N^2$).\n- Case C (large time step, edge case): $N = 64$, $\\nu = 1$, $\\Delta t = 5 \\times 10^{-3}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[\\,[\\text{A1},\\text{A2},\\text{A3}],[\\text{B1},\\text{B2},\\text{B3}],[\\text{C1},\\text{C2},\\text{C3}]\\,]$), where each $\\text{Ai}, \\text{Bi}, \\text{Ci}$ is a boolean or a float as specified above.",
            "solution": "The fundamental base is the heat equation $$\\frac{\\partial u(x,t)}{\\partial t} = \\nu \\frac{\\partial^2 u(x,t)}{\\partial x^2},$$ which models diffusion. To determine stability and oscillatory behavior of a numerical scheme, one applies von Neumann analysis, which decomposes the solution into Fourier modes and examines the per-mode amplification by the time-stepping scheme. The scheme is unconditionally stable for diffusion if the per-mode amplification factor has magnitude less than or equal to $1$ for all resolved modes and for any time step $\\Delta t$.\n\nDiscretize space using a uniform grid with $N$ points and spacing $\\Delta x = 1/N$. The discrete periodic second derivative (Laplacian) operator $D_{xx}$ acting on a grid function $u_j$ is defined by $$\\left(D_{xx} u\\right)_j = \\frac{u_{j+1} - 2 u_j + u_{j-1}}{\\Delta x^2},$$ where indices are taken modulo $N$ to enforce periodic boundary conditions. The Crank-Nicolson time-stepping for the semi-discrete system is obtained by midpoint averaging of the spatial operator: $$\\frac{u_j^{n+1} - u_j^n}{\\Delta t} = \\frac{\\nu}{2} \\left[\\left(D_{xx} u^{n+1}\\right)_j + \\left(D_{xx} u^n\\right)_j\\right].$$ In matrix form, defining $r = \\nu \\Delta t / \\Delta x^2$ and the circulant matrix $A$ corresponding to the stencil $[1, -2, 1]$ (without the factor $\\Delta x^{-2}$), the update is $$\\left(I - \\frac{r}{2} A\\right) u^{n+1} = \\left(I + \\frac{r}{2} A\\right) u^n.$$\n\nTo perform von Neumann analysis, consider a single Fourier mode $u_j^n = \\hat{u}^n e^{i j \\theta}$, where $\\theta = 2 \\pi m / N$ for integer $m \\in \\{0,1,\\dots,N-1\\}$. The discrete Laplacian acting on this mode yields the eigenvalue $$\\lambda(\\theta) = \\frac{2 \\cos \\theta - 2}{\\Delta x^2} = -\\frac{4}{\\Delta x^2} \\sin^2\\left(\\frac{\\theta}{2}\\right).$$ Substituting $u_j^n = \\hat{u}^n e^{i j \\theta}$ into the Crank-Nicolson scheme and canceling the common spatial factor shows that the temporal amplification satisfies $$\\frac{\\hat{u}^{n+1} - \\hat{u}^n}{\\Delta t} = \\frac{\\nu}{2} \\lambda(\\theta) \\left(\\hat{u}^{n+1} + \\hat{u}^n\\right).$$ Solving for the amplification factor $G(\\theta) = \\hat{u}^{n+1} / \\hat{u}^n$ gives $$G(\\theta) = \\frac{1 + \\frac{\\nu \\Delta t}{2} \\lambda(\\theta)}{1 - \\frac{\\nu \\Delta t}{2} \\lambda(\\theta)}.$$ Using $\\lambda(\\theta) = -\\frac{4}{\\Delta x^2} \\sin^2\\left(\\frac{\\theta}{2}\\right)$ and $r = \\nu \\Delta t / \\Delta x^2$ yields $$G(\\theta) = \\frac{1 - 2 r \\sin^2\\left(\\frac{\\theta}{2}\\right)}{1 + 2 r \\sin^2\\left(\\frac{\\theta}{2}\\right)}.$$\n\nUnconditional stability follows by inspecting $|G(\\theta)|$. For all $r \\ge 0$ and all $\\theta$, $$\\left|G(\\theta)\\right| = \\left|\\frac{1 - 2 r s^2}{1 + 2 r s^2}\\right| \\le 1,$$ where $s^2 = \\sin^2\\left(\\frac{\\theta}{2}\\right) \\in [0,1]$. The denominator $1 + 2 r s^2$ is strictly positive, and the numerator magnitude is never greater than the denominator magnitude, so the amplification magnitude does not exceed $1$ for any resolved mode, independent of the time step $\\Delta t$. Therefore, the scheme is unconditionally stable in the von Neumann sense.\n\nSpurious oscillations arise when $G(\\theta)$ becomes negative (while its magnitude remains less than or equal to $1$). A negative amplification factor implies that the corresponding Fourier component changes sign from one time step to the next, creating temporal oscillations. The sign of $G(\\theta)$ is controlled by the numerator $1 - 2 r s^2$: $G(\\theta)  0$ when $$1 - 2 r s^2  0 \\quad \\Longleftrightarrow \\quad r  \\frac{1}{2 s^2}.$$ Since $s^2$ attains its maximum value $1$ at the highest grid-resolved frequency (the Nyquist mode with $\\theta = \\pi$), oscillations can occur whenever $r  1/2$, i.e., when $\\Delta t  \\frac{1}{2} \\frac{\\Delta x^2}{\\nu}$. For modes with smaller $s^2$, the threshold $r$ is higher; thus, large time steps disproportionately induce sign flips in high-frequency modes. This phenomenon is an expression of the fact that Crank-Nicolson is A-stable for linear stiff problems but not L-stable: its stability function for the test equation $y' = \\lambda y$ is $$R(z) = \\frac{1 + \\frac{z}{2}}{1 - \\frac{z}{2}},$$ with $z = \\lambda \\Delta t$. For large negative $z$ (diffusive modes with large $|\\lambda|$ and large $\\Delta t$), $R(z) \\to -1$, which means that stiff components are not strongly damped and can flip sign between steps. In the discrete diffusion context, this manifests as non-monotone behavior and potential violation of the discrete maximum principle (e.g., negative values appearing from nonnegative initial data), even though the overall energy decays.\n\nAlgorithmic design for the program:\n- For each test case, compute $r = \\nu \\Delta t / \\Delta x^2$ with $\\Delta x = 1/N$. \n- Evaluate the amplification factor $G(\\theta_m)$ for all discrete modes $m = 0,1,\\dots,N-1$ using $$\\theta_m = \\frac{2 \\pi m}{N}, \\quad s_m^2 = \\sin^2\\left(\\frac{\\theta_m}{2}\\right), \\quad G_m = \\frac{1 - 2 r s_m^2}{1 + 2 r s_m^2}.$$ Compute the maximum of $\\left|G_m\\right|$ and the fraction of indices $m$ for which $G_m  0$.\n- Construct the periodic discrete Laplacian matrix $A$ with entries $A_{jj} = -2$, $A_{j,j+1} = 1$, $A_{j,j-1} = 1$, and wrap-around connections $A_{0,N-1} = A_{N-1,0} = 1$. Perform one Crank-Nicolson update: $$\\left(I - \\frac{r}{2} A\\right) u^{n+1} = \\left(I + \\frac{r}{2} A\\right) u^n,$$ starting from the step-function initial condition $u^n$. Detect oscillations by checking whether $\\min(u^{n+1})  0$, which signals nonphysical undershoot arising from oscillatory high-frequency components.\n- Report, for each case, the list $[\\text{max\\_abs\\_G}, \\text{fraction\\_negative\\_G}, \\text{oscillation\\_boolean}]$, and print the aggregate as a single bracketed comma-separated line as specified.\n\nThis procedure demonstrates unconditional stability by verifying that the maximum amplification magnitude is less than or equal to $1$ in all cases, and illustrates spurious oscillations when $\\Delta t$ is large by counting negative amplification factors and observing negative undershoot in the numerical solution after one step. The mechanism is rooted in the Crank-Nicolson stability function approaching $-1$ for stiff modes, leading to sign flips without blow-up, consistent with A-stability but not L-stability.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_amplification_metrics(N: int, nu: float, dt: float):\n    \"\"\"\n    Compute amplification factor metrics for Crank-Nicolson applied to the\n    heat equation with periodic boundary conditions on a uniform grid.\n    Returns:\n        max_abs_G: maximum over modes of |G|\n        fraction_negative_G: fraction of modes with G  0\n    \"\"\"\n    dx = 1.0 / N\n    r = nu * dt / (dx * dx)\n    # Discrete modes m = 0..N-1, theta_m = 2*pi*m/N\n    m = np.arange(N, dtype=float)\n    theta = 2.0 * np.pi * m / N\n    s2 = np.sin(theta / 2.0) ** 2\n    G = (1.0 - 2.0 * r * s2) / (1.0 + 2.0 * r * s2)\n    max_abs_G = float(np.max(np.abs(G)))\n    fraction_negative_G = float(np.mean(G  0.0))\n    return max_abs_G, fraction_negative_G\n\ndef crank_nicolson_step(N: int, nu: float, dt: float, u0: np.ndarray):\n    \"\"\"\n    Perform one Crank-Nicolson step for 1D heat equation with periodic BCs.\n    Discrete Laplacian matrix A has stencil [1, -2, 1] with wrap-around.\n    Scheme: (I - (r/2) A) u^{n+1} = (I + (r/2) A) u^n, with r = nu*dt/dx^2.\n    \"\"\"\n    dx = 1.0 / N\n    r = nu * dt / (dx * dx)\n\n    # Build periodic Laplacian stencil matrix A\n    A = np.zeros((N, N), dtype=float)\n    # main diagonal\n    np.fill_diagonal(A, -2.0)\n    # upper diagonal\n    for j in range(N - 1):\n        A[j, j + 1] = 1.0\n    # lower diagonal\n    for j in range(1, N):\n        A[j, j - 1] = 1.0\n    # periodic wrap-around\n    A[0, N - 1] = 1.0\n    A[N - 1, 0] = 1.0\n\n    I = np.eye(N, dtype=float)\n    M_left = I - (r / 2.0) * A\n    M_right = I + (r / 2.0) * A\n\n    # Solve the linear system for u^{n+1}\n    rhs = M_right @ u0\n    u1 = np.linalg.solve(M_left, rhs)\n    return u1\n\ndef run_case(N: int, nu: float, dt: float):\n    \"\"\"\n    Run one test case: compute amplification metrics and perform one CN step\n    from a step-function initial condition; detect oscillations by negativity.\n    Returns the list [max_abs_G, fraction_negative_G, oscillation_boolean].\n    \"\"\"\n    max_abs_G, frac_neg = compute_amplification_metrics(N, nu, dt)\n\n    # Step-function initial condition: u=1 on left half, 0 on right half.\n    x = np.arange(N) / N\n    u0 = np.where(x  0.5, 1.0, 0.0)\n\n    u1 = crank_nicolson_step(N, nu, dt, u0)\n    oscillation = bool(np.min(u1)  0.0)\n\n    return [max_abs_G, frac_neg, oscillation]\n\ndef solve():\n    # Define the test cases from the problem statement.\n    N = 64\n    nu = 1.0\n    dx = 1.0 / N\n\n    test_cases = [\n        # Case A: happy path\n        (N, nu, 5e-5),\n        # Case B: boundary condition r = 0.5 = dt = 0.5 * dx^2\n        (N, nu, 0.5 * dx * dx),\n        # Case C: large time step, edge case\n        (N, nu, 5e-3),\n    ]\n\n    results = []\n    for case in test_cases:\n        N_i, nu_i, dt_i = case\n        result = run_case(N_i, nu_i, dt_i)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # Single line: nested list of [max_abs_G, fraction_negative_G, oscillation_boolean] per case.\n    print(f\"[{','.join(str(res) for res in results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "After designing and implementing a numerical scheme, a critical final step is verification: ensuring the code is correct and achieves its theoretical accuracy. This practice introduces the powerful technique of Richardson extrapolation, a standard method for analyzing data from a grid convergence study. Using a set of hypothetical simulation results for the Poisson equation, you will learn how to numerically determine your scheme's order of accuracy and produce a more precise estimate of the true, continuum solution. ",
            "id": "3508857",
            "problem": "In Newtonian self-gravity, the gravitational potential $\\Phi$ of a mass distribution with density $\\rho$ satisfies the Poisson equation $\\nabla^{2} \\Phi = 4 \\pi G \\rho$. Consider a smooth, centrally concentrated, spherically symmetric density profile $\\rho(r)$ with compact support, placed inside a cubic computational domain of side length $L$ with Dirichlet boundary conditions consistent with the isolated solution. A standard finite difference method on a uniform Cartesian grid is used to discretize $\\nabla^{2}$ with a centered stencil, and the resulting linear system is solved to obtain numerical approximations $\\Phi_{h}$ to the continuum solution $\\Phi$.\n\nDefine the dimensionless diagnostic $U$ to be the value of the normalized potential at the origin, $U \\equiv \\Phi(0) / (G M / R)$, where $M$ is the total mass and $R$ is a characteristic radius of the mass distribution. Assume the numerical scheme is consistent and the solution is smooth so that, in the asymptotic grid-refinement regime, the grid-dependent approximation $U_{h}$ satisfies an expansion of the form $U_{h} = U^{\\ast} + C h^{p} + \\text{higher-order terms}$ for some constant $C$, asymptotic order $p  0$, and continuum limit $U^{\\ast}$.\n\nYou perform three simulations with uniform grid spacings $h$, $h/2$, and $h/4$, obtaining\n$$\nU_{h} = \\frac{17}{16}, \\quad U_{h/2} = \\frac{65}{64}, \\quad U_{h/4} = \\frac{257}{256}.\n$$\n\nUsing only the foundational error model for consistent finite difference discretizations stated above and systematic grid refinement, carry out a Richardson extrapolation analysis to estimate:\n- the asymptotic order of accuracy $p$, and\n- the continuum-limit value $U^{\\ast}$.\n\nExpress your final answer as a row vector $\\bigl(U^{\\ast},\\,p\\bigr)$ with exact values (no rounding). The diagnostic $U$ is dimensionless, so report $U^{\\ast}$ as a pure number without units. Do not provide intermediate calculations in the final answer.",
            "solution": "The problem requires the determination of the asymptotic order of accuracy $p$ and the continuum-limit value $U^{\\ast}$ from a set of three numerical solutions obtained via systematic grid refinement. The provided error model for the dimensionless diagnostic $U_{h}$ is given by the expansion $U_{h} = U^{\\ast} + C h^{p} + \\text{H.O.T.}$, where $h$ is the grid spacing, $C$ is a constant, and H.O.T. represents higher-order terms. For this analysis, we assume that the grid spacings are sufficiently small, such that the leading-order error term dominates and the higher-order terms can be neglected.\n\nWe are given three data points for three successively halved grid spacings, which we denote using the grid spacing as a subscript:\n$$ U_{h} = \\frac{17}{16} $$\n$$ U_{h/2} = \\frac{65}{64} $$\n$$ U_{h/4} = \\frac{257}{256} $$\nUnder the assumption that the H.O.T. are negligible, we can write the following system of equations:\n$$ U_{h} = U^{\\ast} + C h^{p} \\qquad (1) $$\n$$ U_{h/2} = U^{\\ast} + C \\left(\\frac{h}{2}\\right)^{p} = U^{\\ast} + \\frac{C h^{p}}{2^{p}} \\qquad (2) $$\n$$ U_{h/4} = U^{\\ast} + C \\left(\\frac{h}{4}\\right)^{p} = U^{\\ast} + \\frac{C h^{p}}{4^{p}} \\qquad (3) $$\n\nTo find the convergence order $p$, we can use the ratio of the differences between successive solutions. Let us define the differences $\\Delta_{1} = U_h - U_{h/2}$ and $\\Delta_{2} = U_{h/2} - U_{h/4}$.\nSubtracting equation $(2)$ from $(1)$:\n$$ \\Delta_{1} = U_{h} - U_{h/2} = (U^{\\ast} + C h^{p}) - \\left(U^{\\ast} + \\frac{C h^{p}}{2^{p}}\\right) = C h^{p} \\left(1 - \\frac{1}{2^{p}}\\right) $$\nSubtracting equation $(3)$ from $(2)$:\n$$ \\Delta_{2} = U_{h/2} - U_{h/4} = \\left(U^{\\ast} + \\frac{C h^{p}}{2^{p}}\\right) - \\left(U^{\\ast} + \\frac{C h^{p}}{4^{p}}\\right) = \\frac{C h^{p}}{2^{p}} \\left(1 - \\frac{1}{2^{p}}\\right) $$\nThe ratio of these differences, commonly known as the convergence factor, is:\n$$ \\frac{\\Delta_{1}}{\\Delta_{2}} = \\frac{C h^{p} \\left(1 - \\frac{1}{2^{p}}\\right)}{\\frac{C h^{p}}{2^{p}} \\left(1 - \\frac{1}{2^{p}}\\right)} = 2^{p} $$\nNow, we substitute the given numerical values to compute the differences:\n$$ \\Delta_{1} = \\frac{17}{16} - \\frac{65}{64} = \\frac{4 \\times 17}{64} - \\frac{65}{64} = \\frac{68 - 65}{64} = \\frac{3}{64} $$\n$$ \\Delta_{2} = \\frac{65}{64} - \\frac{257}{256} = \\frac{4 \\times 65}{256} - \\frac{257}{256} = \\frac{260 - 257}{256} = \\frac{3}{256} $$\nThe ratio is therefore:\n$$ 2^{p} = \\frac{\\Delta_{1}}{\\Delta_{2}} = \\frac{3/64}{3/256} = \\frac{3}{64} \\cdot \\frac{256}{3} = \\frac{256}{64} = 4 $$\nFrom $2^{p} = 4 = 2^2$, we deduce that the asymptotic order of accuracy is $p=2$. This is consistent with the theoretical expectation for a standard centered finite difference stencil for the Laplacian operator.\n\nWith the order of accuracy $p=2$ determined, we can proceed to find the continuum-limit value $U^{\\ast}$ using Richardson extrapolation. The general formula for Richardson extrapolation based on two solutions with grid sizes $h$ and $h/r$ is $U^{\\ast} \\approx \\frac{r^{p} U_{h/r} - U_{h}}{r^{p} - 1}$. In our case, the refinement factor is $r=2$. We can rearrange equations $(1)$ and $(2)$ to eliminate the error term $C h^p$. With $p=2$:\n$$ U_{h} = U^{\\ast} + C h^{2} $$\n$$ U_{h/2} = U^{\\ast} + \\frac{C h^{2}}{4} $$\nTo eliminate the term $C h^2$, we multiply the second equation by $4$ and subtract the first equation:\n$$ 4 U_{h/2} - U_{h} = 4\\left(U^{\\ast} + \\frac{C h^{2}}{4}\\right) - (U^{\\ast} + C h^{2}) = (4 U^{\\ast} + C h^{2}) - (U^{\\ast} + C h^{2}) = 3 U^{\\ast} $$\nThis gives the Richardson extrapolation formula for $U^{\\ast}$:\n$$ U^{\\ast} = \\frac{4 U_{h/2} - U_{h}}{3} $$\nSubstituting the given values into this formula:\n$$ U^{\\ast} = \\frac{4 \\left(\\frac{65}{64}\\right) - \\frac{17}{16}}{3} = \\frac{\\frac{260}{64} - \\frac{4 \\times 17}{64}}{3} = \\frac{\\frac{260 - 68}{64}}{3} = \\frac{192/64}{3} $$\nSince $192 = 3 \\times 64$, we have:\n$$ U^{\\ast} = \\frac{3}{3} = 1 $$\nAs a consistency check, we apply the same extrapolation procedure to the pair of solutions $U_{h/2}$ and $U_{h/4}$:\n$$ U^{\\ast} = \\frac{4 U_{h/4} - U_{h/2}}{3} = \\frac{4 \\left(\\frac{257}{256}\\right) - \\frac{65}{64}}{3} = \\frac{\\frac{1028}{256} - \\frac{4 \\times 65}{256}}{3} = \\frac{\\frac{1028 - 260}{256}}{3} = \\frac{768/256}{3} $$\nSince $768 = 3 \\times 256$, we have:\n$$ U^{\\ast} = \\frac{3}{3} = 1 $$\nThe result is consistent. Therefore, the continuum-limit value is $U^{\\ast}=1$ and the asymptotic order of accuracy is $p=2$. The problem asks for the answer as a row vector $(U^{\\ast}, p)$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 1  2 \\end{pmatrix}}\n$$"
        }
    ]
}