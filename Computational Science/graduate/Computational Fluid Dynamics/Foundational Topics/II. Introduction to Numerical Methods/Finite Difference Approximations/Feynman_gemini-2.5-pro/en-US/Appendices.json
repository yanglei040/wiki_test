{
    "hands_on_practices": [
        {
            "introduction": "The cornerstone of creating finite difference schemes is the methodical application of Taylor series expansions. This exercise  guides you through the fundamental process of deriving a high-order approximation for a second derivative. By systematically combining function values on a multi-point stencil, you will learn to set up and solve for the coefficients that achieve a desired level of accuracy, providing a concrete understanding of the link between a scheme's structure and its truncation error.",
            "id": "3318184",
            "problem": "Consider a one-dimensional diffusion term in Computational Fluid Dynamics (CFD), where the spatial second derivative $u''(x)$ must be approximated on a uniform grid for high-order accuracy. Let $x_i$ denote a grid point on a uniform mesh with spacing $h$, and let $u_i = u(x_i)$ for a sufficiently smooth function $u$ with at least $6$ continuous derivatives on an interval containing $x_i$. Using the centered stencil $\\{x_{i-2}, x_{i-1}, x_i, x_{i+1}, x_{i+2}\\}$, construct a linear combination of the form\n$$\n\\frac{1}{h^2}\\left(A\\,u_{i-2} + B\\,u_{i-1} + C\\,u_i + B\\,u_{i+1} + A\\,u_{i+2}\\right)\n$$\nthat approximates $u''(x_i)$ with fourth-order accuracy. Derive the coefficients $A$, $B$, and $C$ from first principles by expanding $u(x)$ in a Taylor series about $x_i$ and imposing the necessary consistency and accuracy conditions. Then verify, via Taylor expansion, that the truncation error is $O(h^4)$, and determine the leading-order truncation error term. Express your final approximation as a single closed-form stencil expression in terms of the grid values $u_{i-2}$, $u_{i-1}$, $u_i$, $u_{i+1}$, and $u_{i+2}$. No rounding is required, and no physical units are needed in your answer.",
            "solution": "The user-provided problem is assessed as valid. It is a well-posed, scientifically grounded problem in the field of numerical analysis, specifically concerning the derivation of finite difference formulas. The problem statement is complete, consistent, and requires a standard derivation using Taylor series, a fundamental technique in the discipline.\n\nThe objective is to derive a fourth-order accurate central difference approximation for the second derivative, $u''(x_i)$, using a five-point symmetric stencil. The proposed approximation has the form:\n$$\nu''(x_i) \\approx \\frac{1}{h^2}\\left(A\\,u_{i-2} + B\\,u_{i-1} + C\\,u_i + B\\,u_{i+1} + A\\,u_{i+2}\\right)\n$$\nwhere $h$ is the uniform grid spacing, $u_j = u(x_j)$, and $A$, $B$, $C$ are coefficients to be determined. The function $u(x)$ is assumed to be sufficiently smooth, possessing at least six continuous derivatives.\n\nThe derivation proceeds by expanding the function values $u_{i \\pm 1}$ and $u_{i \\pm 2}$ in a Taylor series around the point $x_i$. We denote $u^{(n)}_i = \\frac{d^n u}{dx^n}\\Big|_{x=x_i}$. The expansions are:\n$$\nu_{i+k} = u(x_i + kh) = \\sum_{n=0}^{\\infty} \\frac{(kh)^n}{n!} u^{(n)}_i\n$$\nWe expand up to the term involving $u^{(6)}_i$ to determine the $O(h^4)$ error term.\n\\begin{align*}\nu_{i+1} &= u_i + h u'_i + \\frac{h^2}{2} u''_i + \\frac{h^3}{6} u'''_i + \\frac{h^4}{24} u''''_i + \\frac{h^5}{120} u^{(5)}_i + \\frac{h^6}{720} u^{(6)}_i + O(h^7) \\\\\nu_{i-1} &= u_i - h u'_i + \\frac{h^2}{2} u''_i - \\frac{h^3}{6} u'''_i + \\frac{h^4}{24} u''''_i - \\frac{h^5}{120} u^{(5)}_i + \\frac{h^6}{720} u^{(6)}_i + O(h^7) \\\\\nu_{i+2} &= u_i + 2h u'_i + \\frac{(2h)^2}{2} u''_i + \\frac{(2h)^3}{6} u'''_i + \\frac{(2h)^4}{24} u''''_i + \\frac{(2h)^5}{120} u^{(5)}_i + \\frac{(2h)^6}{720} u^{(6)}_i + O(h^7) \\\\\nu_{i-2} &= u_i - 2h u'_i + \\frac{(2h)^2}{2} u''_i - \\frac{(2h)^3}{6} u'''_i + \\frac{(2h)^4}{24} u''''_i - \\frac{(2h)^5}{120} u^{(5)}_i + \\frac{(2h)^6}{720} u^{(6)}_i + O(h^7)\n\\end{align*}\nDue to the symmetry of the stencil and the coefficients ($A$ for $u_{i\\pm 2}$, $B$ for $u_{i\\pm 1}$), the odd derivative terms will cancel out when combined. Let's form the symmetric combinations:\n$$\nu_{i+1} + u_{i-1} = 2u_i + h^2 u''_i + \\frac{h^4}{12} u''''_i + \\frac{h^6}{360} u^{(6)}_i + O(h^8)\n$$\n$$\nu_{i+2} + u_{i-2} = 2u_i + (2h)^2 u''_i + \\frac{(2h)^4}{12} u''''_i + \\frac{(2h)^6}{360} u^{(6)}_i + O(h^8) = 2u_i + 4h^2 u''_i + \\frac{4h^4}{3} u''''_i + \\frac{8h^6}{45} u^{(6)}_i + O(h^8)\n$$\nLet the linear combination in the numerator be denoted by $S$:\n$$\nS = A(u_{i+2} + u_{i-2}) + B(u_{i+1} + u_{i-1}) + C u_i\n$$\nSubstituting the combined Taylor series:\n$$\nS = A\\left(2u_i + 4h^2 u''_i + \\frac{4}{3}h^4 u''''_i + \\frac{8}{45}h^6 u^{(6)}_i\\right) + B\\left(2u_i + h^2 u''_i + \\frac{1}{12}h^4 u''''_i + \\frac{1}{360}h^6 u^{(6)}_i\\right) + C u_i + O(h^8)\n$$\nGrouping terms by derivatives of $u_i$:\n$$\nS = (2A + 2B + C)u_i + (4A + B)h^2 u''_i + \\left(\\frac{4}{3}A + \\frac{1}{12}B\\right)h^4 u''''_i + \\left(\\frac{8}{45}A + \\frac{1}{360}B\\right)h^6 u^{(6)}_i + O(h^8)\n$$\nThe full approximation is $\\frac{S}{h^2}$. We desire this to be equal to $u''_i + O(h^4)$.\n$$\n\\frac{S}{h^2} = \\frac{2A + 2B + C}{h^2}u_i + (4A + B)u''_i + \\left(\\frac{4}{3}A + \\frac{1}{12}B\\right)h^2 u''''_i + \\left(\\frac{8}{45}A + \\frac{1}{360}B\\right)h^4 u^{(6)}_i + O(h^6)\n$$\nTo match this to $u''_i$ and achieve the desired accuracy, we set the coefficients of the unwanted terms to zero and the coefficient of $u''_i$ to one. This yields a system of linear equations for $A$, $B$, and $C$.\n\\begin{enumerate}\n    \\item The coefficient of $u_i$ must be zero: $2A + 2B + C = 0$\n    \\item The coefficient of $u''_i$ must be one: $4A + B = 1$\n    \\item To achieve $O(h^4)$ accuracy, the coefficient of the $h^2 u''''_i$ term must be zero: $\\frac{4}{3}A + \\frac{1}{12}B = 0$\n\\end{enumerate}\nWe now solve this system. From the third equation:\n$$\n\\frac{4}{3}A = -\\frac{1}{12}B \\implies 16A = -B \\implies B = -16A\n$$\nSubstitute this result into the second equation:\n$$\n4A + (-16A) = 1 \\implies -12A = 1 \\implies A = -\\frac{1}{12}\n$$\nNow we find $B$:\n$$\nB = -16A = -16\\left(-\\frac{1}{12}\\right) = \\frac{16}{12} = \\frac{4}{3}\n$$\nFinally, use the first equation to find $C$:\n$$\nC = -2A - 2B = -2\\left(-\\frac{1}{12}\\right) - 2\\left(\\frac{4}{3}\\right) = \\frac{2}{12} - \\frac{8}{3} = \\frac{1}{6} - \\frac{16}{6} = -\\frac{15}{6} = -\\frac{5}{2}\n$$\nThe coefficients are $A = -\\frac{1}{12}$, $B = \\frac{4}{3}$, and $C = -\\frac{5}{2}$.\n\nHaving found the coefficients, we can now determine the truncation error. With these coefficients, the terms for $u_i$ and $u''''_i$ vanish, and the term for $u''_i$ is $1$. The finite difference approximation becomes:\n$$\n\\frac{S}{h^2} = u''_i + \\left(\\frac{8}{45}A + \\frac{1}{360}B\\right)h^4 u^{(6)}_i + O(h^6)\n$$\nThe truncation error, $T_i$, is defined as the exact value minus the approximation:\n$$\nT_i = u''_i - \\frac{S}{h^2} = - \\left(\\frac{8}{45}A + \\frac{1}{360}B\\right)h^4 u^{(6)}_i - O(h^6)\n$$\nLet's compute the coefficient of the leading error term:\n$$\n- \\left(\\frac{8}{45}A + \\frac{1}{360}B\\right) = - \\left(\\frac{8}{45}\\left(-\\frac{1}{12}\\right) + \\frac{1}{360}\\left(\\frac{4}{3}\\right)\\right) = - \\left(-\\frac{8}{540} + \\frac{4}{1080}\\right)\n$$\n$$\n= - \\left(-\\frac{16}{1080} + \\frac{4}{1080}\\right) = - \\left(-\\frac{12}{1080}\\right) = \\frac{12}{1080} = \\frac{1}{90}\n$$\nThus, the truncation error is $T_i = \\frac{1}{90}h^4 u^{(6)}_i + O(h^6)$. This verifies that the approximation is indeed fourth-order accurate, $O(h^4)$, and the leading-order truncation error term is $\\frac{h^4 u^{(6)}(x_i)}{90}$.\n\nThe final step is to construct the closed-form stencil expression. Substituting the coefficients $A$, $B$, and $C$ into the approximation formula:\n$$\nu''(x_i) \\approx \\frac{1}{h^2}\\left(-\\frac{1}{12}u_{i-2} + \\frac{4}{3}u_{i-1} - \\frac{5}{2}u_i + \\frac{4}{3}u_{i+1} - \\frac{1}{12}u_{i+2}\\right)\n$$\nTo write this with integer coefficients inside the bracket, we can factor out a common denominator of $12$:\n$$\nA = -\\frac{1}{12}, \\quad B = \\frac{4}{3} = \\frac{16}{12}, \\quad C = -\\frac{5}{2} = -\\frac{30}{12}\n$$\nThe approximation can be written as:\n$$\nu''(x_i) \\approx \\frac{1}{12h^2}\\left(-u_{i-2} + 16u_{i-1} - 30u_i + 16u_{i+1} - u_{i+2}\\right)\n$$\nThis is the required fourth-order central difference approximation for the second derivative.",
            "answer": "$$\n\\boxed{\\frac{-u_{i-2} + 16u_{i-1} - 30u_i + 16u_{i+1} - u_{i+2}}{12h^2}}\n$$"
        },
        {
            "introduction": "While theoretical analysis provides the formal order of accuracy for a finite difference scheme, empirical verification is a crucial step in computational practice. This hands-on exercise  introduces the grid refinement study, a standard methodology for measuring the observed order of accuracy of a numerical method. You will implement several stencils, measure their error on a known function, and use data fitting to confirm that their computational behavior matches their theoretical design, a core skill in code verification.",
            "id": "3318157",
            "problem": "Design and implement a numerical grid refinement study to empirically verify the formal order of accuracy of finite difference approximations for the second derivative $u''(x)$, starting from Taylor series expansions and the definition of consistency and order. The study must be formulated and executed purely in mathematical terms, with angles measured in radians.\n\nYou must proceed from the following fundamental base:\n- Use Taylor series expansions of a smooth function $u(x)$ about a point $x^\\star$ to construct and analyze finite difference approximations to $u''(x^\\star)$ based on values of $u$ on a uniform grid with spacing $h>0$.\n- Define the observed error at $x^\\star$ for grid spacing $h$ as $E(h) = \\lvert D_h[u](x^\\star) - u''(x^\\star)\\rvert$, where $D_h$ denotes a finite difference operator constructed from a specified stencil.\n- Assume an asymptotic error model $E(h) \\approx C h^p$ for $h \\to 0^+$, with constants $C>0$ and $p>0$, and explain how to extract the exponent $p$ from measured errors using a least-squares fit of $\\log E(h)$ versus $\\log h$.\n\nImplement a single program that executes the following tasks.\n\n1. Choose a smooth test function and an evaluation point:\n   - Let $u(x) = e^{x} + \\sin(7x)$, where all angles are measured in radians.\n   - Its exact second derivative is $u''(x) = e^{x} - 49 \\sin(7x)$.\n   - Fix the evaluation point $x^\\star = 0.3$.\n\n2. Define a refinement sequence of uniform grid spacings:\n   - Use the set $\\{h_k\\}_{k=1}^{5}$ given by $h_k \\in \\{2^{-3}, 2^{-4}, 2^{-5}, 2^{-6}, 2^{-7}\\}$.\n\n3. Specify the four distinct stencils to be tested, each constructing a finite difference approximation to $u''(x^\\star)$ based on function values at offsets $\\{j h\\}$ from $x^\\star$:\n   - Forward one-sided three-point stencil: offsets $j \\in \\{0, 1, 2\\}$.\n   - Backward one-sided three-point stencil: offsets $j \\in \\{0, -1, -2\\}$.\n   - Central three-point stencil: offsets $j \\in \\{-1, 0, 1\\}$.\n   - Central five-point stencil: offsets $j \\in \\{-2, -1, 0, 1, 2\\}$.\n   For each stencil, construct weights for approximating $u''(x^\\star)$ by satisfying the necessary Taylor moment conditions so that the operator is consistent with the second derivative at $x^\\star$. The construction of weights must follow from the fundamental Taylor series principles; do not assume any result that has not been derived from those principles.\n\n4. For each stencil and each $h_k$:\n   - Form the approximation $D_{h_k}[u](x^\\star)$ from the corresponding weighted sum of $u(x^\\star + j h_k)$ divided by $h_k^2$.\n   - Compute the absolute error $E(h_k) = \\lvert D_{h_k}[u](x^\\star) - u''(x^\\star)\\rvert$.\n\n5. For each stencil, estimate the observed order of accuracy $p$ by applying a linear least-squares fit to the pairs $\\{(\\log h_k, \\log E(h_k))\\}_{k=1}^{5}$:\n   - Use the natural logarithm.\n   - Fit a straight line $y = a + p x$ to $x = \\log h_k$, $y = \\log E(h_k)$, and report the slope $p$ as the observed order.\n\nTest suite and answer specification:\n- The test suite consists of the four stencils listed above and the five values of $h_k$ in the set $\\{2^{-3}, 2^{-4}, 2^{-5}, 2^{-6}, 2^{-7}\\}$.\n- For each stencil, compute the observed order $p$ as a real number.\n- Your program should output a single line containing a list of the four observed orders, in the order: forward three-point, backward three-point, central three-point, central five-point. Each observed order must be rounded to three decimal places.\n- Final output format: a single line of the form $[p_1,p_2,p_3,p_4]$, where $p_i$ are floats rounded to three decimal places, with no additional text.\n\nNo physical units are involved in this task; all angles for trigonometric functions must be treated in radians. The task is purely mathematical and numerical.",
            "solution": "The objective is to empirically determine the order of accuracy, $p$, for four different finite difference stencils approximating the second derivative, $u''(x)$. This is achieved through a grid refinement study. The order of accuracy is defined by the asymptotic error model $E(h) \\approx C h^p$, where $E(h)$ is the absolute error of the approximation for a grid spacing $h$, and $C$ is a constant. We can determine $p$ by observing that $\\log E(h) \\approx \\log C + p \\log h$. This shows a linear relationship between $\\log E$ and $\\log h$, where the slope is the order of accuracy $p$. We will compute the error for a sequence of decreasing grid spacings $h_k$ and then use a linear least-squares fit on the $(\\log h_k, \\log E_k)$ data to estimate the slope $p$.\n\nThe foundation of this method lies in the Taylor series expansion. A finite difference approximation $D_h[u](x^\\star)$ for the second derivative $u''(x^\\star)$ is a linear combination of function values $u(x)$ at grid points near $x^\\star$. Let the grid points be $x^\\star + j h$ for a set of integer offsets $j \\in S$. The general form is:\n$$ D_h[u](x^\\star) = \\frac{1}{h^2} \\sum_{j \\in S} w_j u(x^\\star + j h) $$\nThe weights $w_j$ are determined by matching the Taylor series expansion of $D_h[u](x^\\star)$ to the desired derivative. Expanding each $u(x^\\star + j h)$ term around $x^\\star$:\n$$ u(x^\\star + j h) = u(x^\\star) + (j h) u'(x^\\star) + \\frac{(j h)^2}{2!} u''(x^\\star) + \\frac{(j h)^3}{3!} u'''(x^\\star) + \\dots = \\sum_{k=0}^{\\infty} \\frac{(jh)^k}{k!} u^{(k)}(x^\\star) $$\nSubstituting this into the formula for $D_h[u](x^\\star)$:\n$$ D_h[u](x^\\star) = \\frac{1}{h^2} \\sum_{j \\in S} w_j \\sum_{k=0}^{\\infty} \\frac{(jh)^k}{k!} u^{(k)}(x^\\star) $$\nRearranging the sums gives:\n$$ D_h[u](x^\\star) = \\sum_{k=0}^{\\infty} \\left[ \\frac{h^{k-2}}{k!} \\left( \\sum_{j \\in S} j^k w_j \\right) \\right] u^{(k)}(x^\\star) $$\nFor $D_h[u](x^\\star)$ to be a good approximation of $u''(x^\\star)$, the coefficient of $u''(x^\\star)$ must be $1$, and the coefficients of other derivatives (especially lower-order ones) should be $0$. This leads to a system of linear equations for the weights $w_j$, known as the moment conditions:\n\\begin{enumerate}\n    \\item Coefficient of $u(x^\\star)$ ($k=0$): $\\frac{1}{h^2} \\sum_{j \\in S} w_j = 0 \\implies \\sum_{j \\in S} w_j = 0$\n    \\item Coefficient of $u'(x^\\star)$ ($k=1$): $\\frac{1}{h} \\sum_{j \\in S} j w_j = 0 \\implies \\sum_{j \\in S} j w_j = 0$\n    \\item Coefficient of $u''(x^\\star)$ ($k=2$): $\\frac{1}{2!} \\sum_{j \\in S} j^2 w_j = 1 \\implies \\sum_{j \\in S} j^2 w_j = 2$\n\\end{enumerate}\nTo achieve a higher order of accuracy, we can impose additional conditions by setting the coefficients of higher-order derivative terms to zero. The first non-zero term in the expansion of the truncation error, $T(h) = D_h[u](x^\\star) - u''(x^\\star)$, determines the order of accuracy. If the leading error term is proportional to $h^p$, the method is $p$-th order accurate.\n\nWe now derive the weights and theoretical order for each specified stencil.\n\n1.  **Forward one-sided three-point stencil**: The stencil uses offsets $S = \\{0, 1, 2\\}$. We have three weights $w_0, w_1, w_2$ to find, so we use the first three moment conditions:\n    $$ w_0 + w_1 + w_2 = 0 $$\n    $$ 0 \\cdot w_0 + 1 \\cdot w_1 + 2 \\cdot w_2 = 0 \\implies w_1 + 2w_2 = 0 $$\n    $$ 0^2 \\cdot w_0 + 1^2 \\cdot w_1 + 2^2 \\cdot w_2 = 2 \\implies w_1 + 4w_2 = 2 $$\n    Solving this system yields $w_2=1$, $w_1=-2$, and $w_0=1$. The leading error term is determined by the first non-zero higher-order moment, which is for $k=3$:\n    $$ \\sum_{j \\in S} j^3 w_j = 0^3(1) + 1^3(-2) + 2^3(1) = 6 $$\n    The leading term of the truncation error is $\\frac{h^{3-2}}{3!} (6) u'''(x^\\star) = h u'''(x^\\star)$. The error is $O(h)$, so the formal order is $p=1$.\n\n2.  **Backward one-sided three-point stencil**: The stencil uses offsets $S = \\{0, -1, -2\\}$. The moment conditions are:\n    $$ w_0 + w_{-1} + w_{-2} = 0 $$\n    $$ 0 \\cdot w_0 - 1 \\cdot w_{-1} - 2 \\cdot w_{-2} = 0 \\implies w_{-1} + 2w_{-2} = 0 $$\n    $$ 0^2 \\cdot w_0 + (-1)^2 \\cdot w_{-1} + (-2)^2 \\cdot w_{-2} = 2 \\implies w_{-1} + 4w_{-2} = 2 $$\n    This system is analogous to the forward case and yields $w_{-2}=1$, $w_{-1}=-2$, and $w_0=1$. The leading error term is determined by the $k=3$ moment:\n    $$ \\sum_{j \\in S} j^3 w_j = 0^3(1) + (-1)^3(-2) + (-2)^3(1) = 2 - 8 = -6 $$\n    The leading error term is $\\frac{h}{6}(-6)u'''(x^\\star) = -h u'''(x^\\star)$. The error is $O(h)$, so the formal order is $p=1$.\n\n3.  **Central three-point stencil**: The stencil uses offsets $S = \\{-1, 0, 1\\}$. The moment conditions are:\n    $$ w_{-1} + w_0 + w_1 = 0 $$\n    $$ -1 \\cdot w_{-1} + 0 \\cdot w_0 + 1 \\cdot w_1 = 0 \\implies w_{-1} = w_1 $$\n    $$ (-1)^2 \\cdot w_{-1} + 0^2 \\cdot w_0 + 1^2 \\cdot w_1 = 2 \\implies w_{-1} + w_1 = 2 $$\n    This yields $w_1=1$, $w_{-1}=1$, and $w_0=-2$. Due to the symmetry of the stencil and weights, the sum for any odd power $k$ is zero ($\\sum j^{2m+1} w_j = 0$). Thus, the $k=3$ moment is zero. We must check the $k=4$ moment:\n    $$ \\sum_{j \\in S} j^4 w_j = (-1)^4(1) + 0^4(-2) + 1^4(1) = 2 $$\n    The leading error term is $\\frac{h^{4-2}}{4!} (2) u^{(4)}(x^\\star) = \\frac{h^2}{12} u^{(4)}(x^\\star)$. The error is $O(h^2)$, so the formal order is $p=2$.\n\n4.  **Central five-point stencil**: The stencil uses offsets $S = \\{-2, -1, 0, 1, 2\\}$. We have five weights, allowing us to satisfy more moment conditions for higher accuracy. We enforce symmetry ($w_{-j}=w_j$), which automatically nullifies odd moments. We set the $k=4$ moment to zero to eliminate the $O(h^2)$ error term. The conditions are:\n    $$ w_0 + 2w_1 + 2w_2 = 0 \\quad (\\text{from } \\sum w_j = 0) $$\n    $$ 2w_1(1^2) + 2w_2(2^2) = 2 \\implies w_1 + 4w_2 = 1 \\quad (\\text{from } \\sum j^2 w_j = 2) $$\n    $$ 2w_1(1^4) + 2w_2(2^4) = 0 \\implies w_1 + 16w_2 = 0 \\quad (\\text{from } \\sum j^4 w_j = 0) $$\n    Solving this system gives $w_2 = -1/12$, $w_1 = 4/3$, and $w_0 = -5/2$. The leading error is determined by the first non-zero higher-order moment, which is for $k=6$:\n    $$ \\sum_{j \\in S} j^6 w_j = 2(w_1 \\cdot 1^6 + w_2 \\cdot 2^6) = 2(4/3 - 64/12) = 2(4/3 - 16/3) = -8 $$\n    The leading error term is $\\frac{h^{6-2}}{6!} (-8) u^{(6)}(x^\\star) = -\\frac{h^4}{90} u^{(6)}(x^\\star)$. The error is $O(h^4)$, so the formal order is $p=4$.\n\nThe numerical experiment is performed using the function $u(x) = e^{x} + \\sin(7x)$ and its exact second derivative $u''(x) = e^{x} - 49 \\sin(7x)$ at the point $x^\\star = 0.3$. For each stencil, we calculate the approximation $D_{h_k}[u](x^\\star)$ and the error $E(h_k) = |D_{h_k}[u](x^\\star) - u''(x^\\star)|$ for each grid spacing $h_k \\in \\{2^{-3}, 2^{-4}, 2^{-5}, 2^{-6}, 2^{-7}\\}$. Then, we perform a linear regression on the points $(\\log h_k, \\log E_k)$ to find the slope, which corresponds to the observed order of accuracy $p$.",
            "answer": "[1.000,1.000,2.000,4.000]"
        },
        {
            "introduction": "For problems involving wave propagation, the local accuracy dictated by Taylor series is often insufficient; a scheme's spectral properties become paramount. This advanced practice  explores the design of Dispersion-Relation-Preserving (DRP) schemes, which are optimized to minimize phase errors for a wide range of wavenumbers. By working with the modified wavenumber in Fourier space, you will solve a constrained optimization problem to derive a stencil that offers superior performance for simulating advection and wave phenomena.",
            "id": "3318142",
            "problem": "Consider a one-dimensional, uniform grid with spacing $\\Delta x$ used to approximate the spatial derivative $u'(x)$ by a linear, shift-invariant finite-difference operator built from a $(2m+1)$-point stencil centered at $x$. For a nondissipative central scheme, the stencil coefficients are antisymmetric: $c_{-j} = -c_{j}$ for $j=1,\\dots,m$, and $c_{0}=0$. Let the numerical derivative operator be defined by\n$$\n\\mathcal{D}_{\\Delta x} u(x) \\equiv \\frac{1}{\\Delta x} \\sum_{j=-m}^{m} c_{j} \\, u(x + j \\Delta x).\n$$\nOn a uniform grid, the response of such an operator to a Fourier mode $u(x) = \\exp(i \\kappa x)$ is characterized by a discrete symbol. Defining the nondimensional wavenumber $k \\equiv \\kappa \\Delta x \\in [0,\\pi]$ (limited by the Nyquist wavenumber), the modified wavenumber $\\tilde{k}(k)$ is the real scalar such that\n$$\n\\mathcal{D}_{\\Delta x} \\exp(i \\kappa x) = \\frac{i}{\\Delta x} \\tilde{k}(k) \\exp(i \\kappa x).\n$$\nThe Dispersion-Relation-Preserving (DRP) design approach seeks stencil coefficients that optimize phase accuracy over a band of wavenumbers $k \\in [0,\\pi]$ by minimizing the integrated dispersion error. Starting from the Taylor expansion of $u(x+j\\Delta x)$ about $x$ and the definition of the derivative, accuracy constraints of order $O(\\Delta x^{p})$ are obtained by requiring exactness for the leading terms in the expansion.\n\nDesign a seven-point ($m=3$) antisymmetric central stencil for $u'(x)$ that is fourth-order accurate ($p=4$) and minimizes the integrated dispersion error\n$$\n\\int_{0}^{\\pi} \\left| \\tilde{k}(k) - k \\right|^{2} \\, dk,\n$$\nsubject to the $O(\\Delta x^{4})$ accuracy constraints derived from the Taylor expansion. Use the nondimensional wavenumber definition above and the fact that antisymmetry implies $c_{0}=0$ and $c_{-j}=-c_{j}$. Express your final answer as the ordered list of stencil coefficients $\\{c_{-3}, c_{-2}, c_{-1}, c_{0}, c_{1}, c_{2}, c_{3}\\}$ in exact analytic form. No rounding is required.",
            "solution": "The problem statement is evaluated to be valid. It is a well-posed, scientifically grounded problem in the field of numerical analysis for computational fluid dynamics. It is self-contained, with all necessary definitions and constraints provided, and free from any scientific or logical contradictions. The task is to solve a constrained optimization problem to find the coefficients of a finite difference scheme, which is a standard procedure in the design of such schemes.\n\nThe problem is to design a seven-point ($m=3$) antisymmetric central finite difference stencil for the first derivative, $u'(x)$, that is fourth-order accurate ($p=4$) and minimizes the integrated dispersion error. The stencil coefficients are denoted by $c_j$ for $j \\in \\{-3, -2, -1, 0, 1, 2, 3\\}$.\n\nFirst, we establish the constraints on the coefficients $c_j$ from the accuracy requirement. The general form of the finite difference operator is given as:\n$$\n\\mathcal{D}_{\\Delta x} u(x) \\equiv \\frac{1}{\\Delta x} \\sum_{j=-m}^{m} c_{j} \\, u(x + j \\Delta x)\n$$\nThe problem specifies an antisymmetric stencil, which implies $c_0 = 0$ and $c_{-j} = -c_j$. For $m=3$, the operator can be written as:\n$$\n\\mathcal{D}_{\\Delta x} u(x) = \\frac{1}{\\Delta x} \\sum_{j=1}^{3} c_j \\left[ u(x+j\\Delta x) - u(x-j\\Delta x) \\right]\n$$\nTo determine the accuracy, we substitute the Taylor series expansion of $u(x \\pm j\\Delta x)$ around $x$ into the operator. The difference term is:\n$$\nu(x+j\\Delta x) - u(x-j\\Delta x) = \\sum_{k=0}^{\\infty} \\frac{u^{(k)}(x)}{k!} \\left[ (j\\Delta x)^k - (-j\\Delta x)^k \\right] = 2 \\sum_{l=0}^{\\infty} \\frac{(j\\Delta x)^{2l+1}}{(2l+1)!} u^{(2l+1)}(x)\n$$\nSubstituting this into the operator expression gives:\n$$\n\\mathcal{D}_{\\Delta x} u(x) = \\frac{1}{\\Delta x} \\sum_{j=1}^{3} c_j \\left[ 2j\\Delta x u'(x) + \\frac{2(j\\Delta x)^3}{3!} u'''(x) + \\frac{2(j\\Delta x)^5}{5!} u^{(5)}(x) + \\dots \\right]\n$$\n$$\n= \\left( 2\\sum_{j=1}^{3} j c_j \\right) u'(x) + \\left( \\frac{1}{3}\\sum_{j=1}^{3} j^3 c_j \\right) (\\Delta x)^2 u'''(x) + \\left( \\frac{1}{60}\\sum_{j=1}^{3} j^5 c_j \\right) (\\Delta x)^4 u^{(5)}(x) + O(\\Delta x^6)\n$$\nFor this operator to approximate $u'(x)$, the coefficient of $u'(x)$ must be $1$. For the scheme to be fourth-order accurate ($p=4$), the coefficient of the $(\\Delta x)^2 u'''(x)$ term must be zero, making the leading error term proportional to $(\\Delta x)^4$. This leads to two constraint equations for the three unknown coefficients $c_1, c_2, c_3$:\n1. $2\\sum_{j=1}^{3} j c_j = 1 \\implies c_1 + 2c_2 + 3c_3 = \\frac{1}{2}$\n2. $\\sum_{j=1}^{3} j^3 c_j = 0 \\implies c_1 + 8c_2 + 27c_3 = 0$\n\nNext, we derive the modified wavenumber $\\tilde{k}(k)$. Applying the operator to a Fourier mode $u(x) = \\exp(i\\kappa x)$, where $k=\\kappa \\Delta x$:\n$$\n\\mathcal{D}_{\\Delta x} \\exp(i\\kappa x) = \\frac{1}{\\Delta x} \\sum_{j=-3}^{3} c_j \\exp(i\\kappa(x+j\\Delta x)) = \\frac{\\exp(i\\kappa x)}{\\Delta x} \\sum_{j=-3}^{3} c_j \\exp(ijk)\n$$\nUsing the antisymmetry $c_0=0$ and $c_{-j}=-c_j$:\n$$\n\\sum_{j=-3}^{3} c_j \\exp(ijk) = \\sum_{j=1}^{3} c_j (\\exp(ijk) - \\exp(-ijk)) = \\sum_{j=1}^{3} c_j (2i \\sin(jk)) = 2i \\sum_{j=1}^{3} c_j \\sin(jk)\n$$\nBy definition, $\\mathcal{D}_{\\Delta x} \\exp(i\\kappa x) = \\frac{i}{\\Delta x}\\tilde{k}(k)\\exp(i\\kappa x)$. Comparing these expressions, we find the modified wavenumber:\n$$\n\\tilde{k}(k) = 2 \\sum_{j=1}^{3} c_j \\sin(jk) = 2(c_1 \\sin(k) + c_2 \\sin(2k) + c_3 \\sin(3k))\n$$\nThe problem is now a constrained optimization: minimize $E = \\int_{0}^{\\pi} (\\tilde{k}(k) - k)^2 dk$ subject to the two linear constraints on $c_1, c_2, c_3$. We solve the constraint system to express $c_1$ and $c_2$ in terms of $c_3$. Subtracting the first constraint from the second gives:\n$6c_2 + 24c_3 = -\\frac{1}{2} \\implies c_2 = -4c_3 - \\frac{1}{12}$\nSubstituting $c_2$ into the first constraint:\n$c_1 + 2(-4c_3 - \\frac{1}{12}) + 3c_3 = \\frac{1}{2} \\implies c_1 - 8c_3 - \\frac{1}{6} + 3c_3 = \\frac{1}{2} \\implies c_1 - 5c_3 = \\frac{2}{3} \\implies c_1 = 5c_3 + \\frac{2}{3}$\n\nNow, substitute these into the expression for $\\tilde{k}(k)$:\n$$\n\\tilde{k}(k) = 2\\left(5c_3 + \\frac{2}{3}\\right)\\sin(k) + 2\\left(-4c_3 - \\frac{1}{12}\\right)\\sin(2k) + 2c_3\\sin(3k)\n$$\n$$\n= \\left(\\frac{4}{3}\\sin(k) - \\frac{1}{6}\\sin(2k)\\right) + c_3 \\left(10\\sin(k) - 8\\sin(2k) + 2\\sin(3k)\\right)\n$$\nLet $g(k) = \\frac{4}{3}\\sin(k) - \\frac{1}{6}\\sin(2k)$ and $f(k) = 10\\sin(k) - 8\\sin(2k) + 2\\sin(3k)$. The error functional to minimize is $E(c_3) = \\int_{0}^{\\pi} (g(k) + c_3f(k) - k)^2 dk$. To find the minimum, we set $\\frac{dE}{dc_3} = 0$:\n$$\n\\frac{dE}{dc_3} = \\int_{0}^{\\pi} 2(g(k) + c_3f(k) - k)f(k) dk = 0\n$$\n$$\nc_3 \\int_{0}^{\\pi} f(k)^2 dk + \\int_{0}^{\\pi} g(k)f(k) dk - \\int_{0}^{\\pi} k f(k) dk = 0\n$$\nSolving for $c_3$:\n$$\nc_3 = \\frac{\\int_{0}^{\\pi} k f(k) dk - \\int_{0}^{\\pi} g(k)f(k) dk}{\\int_{0}^{\\pi} f(k)^2 dk}\n$$\nWe compute the integrals using the standard results $\\int_{0}^{\\pi}\\sin(nk)\\sin(mk)dk = \\frac{\\pi}{2}\\delta_{nm}$ and $\\int_{0}^{\\pi} k \\sin(nk)dk = \\frac{-\\pi(-1)^n}{n}$ for integer $n,m > 0$.\n\nDenominator: $\\int_{0}^{\\pi} f(k)^2 dk = \\int_{0}^{\\pi} (10\\sin(k) - 8\\sin(2k) + 2\\sin(3k))^2 dk$. By orthogonality:\n$$\n\\int_{0}^{\\pi} f(k)^2 dk = \\left(10^2 + (-8)^2 + 2^2\\right)\\frac{\\pi}{2} = (100+64+4)\\frac{\\pi}{2} = 168\\frac{\\pi}{2} = 84\\pi\n$$\nNumerator part 1: $\\int_{0}^{\\pi} k f(k) dk = 10\\int_{0}^{\\pi} k\\sin(k)dk - 8\\int_{0}^{\\pi} k\\sin(2k)dk + 2\\int_{0}^{\\pi} k\\sin(3k)dk$\n$$\n= 10\\left(\\frac{-\\pi(-1)^1}{1}\\right) - 8\\left(\\frac{-\\pi(-1)^2}{2}\\right) + 2\\left(\\frac{-\\pi(-1)^3}{3}\\right) = 10\\pi + 4\\pi + \\frac{2\\pi}{3} = 14\\pi + \\frac{2\\pi}{3} = \\frac{44\\pi}{3}\n$$\nNumerator part 2: $\\int_{0}^{\\pi} g(k)f(k) dk = \\int_{0}^{\\pi} (\\frac{4}{3}\\sin(k) - \\frac{1}{6}\\sin(2k))(10\\sin(k) - 8\\sin(2k) + \\dots) dk$. By orthogonality:\n$$\n= \\left(\\frac{4}{3}\\right)(10)\\frac{\\pi}{2} + \\left(-\\frac{1}{6}\\right)(-8)\\frac{\\pi}{2} = \\frac{40}{3}\\frac{\\pi}{2} + \\frac{8}{6}\\frac{\\pi}{2} = \\frac{20\\pi}{3} + \\frac{2\\pi}{3} = \\frac{22\\pi}{3}\n$$\nNow, substitute these back to find $c_3$:\n$$\nc_3 = \\frac{\\frac{44\\pi}{3} - \\frac{22\\pi}{3}}{84\\pi} = \\frac{\\frac{22\\pi}{3}}{84\\pi} = \\frac{22}{3 \\times 84} = \\frac{11}{3 \\times 42} = \\frac{11}{126}\n$$\nWith $c_3 = \\frac{11}{126}$, we can find $c_1$ and $c_2$:\n$$\nc_2 = -4c_3 - \\frac{1}{12} = -4\\left(\\frac{11}{126}\\right) - \\frac{1}{12} = -\\frac{44}{126} - \\frac{1}{12} = -\\frac{22}{63} - \\frac{1}{12} = \\frac{-22 \\times 4 - 21}{252} = -\\frac{109}{252}\n$$\n$$\nc_1 = 5c_3 + \\frac{2}{3} = 5\\left(\\frac{11}{126}\\right) + \\frac{2}{3} = \\frac{55}{126} + \\frac{2 \\times 42}{126} = \\frac{55 + 84}{126} = \\frac{139}{126}\n$$\nThe positive coefficients are $c_1 = \\frac{139}{126}$, $c_2 = -\\frac{109}{252}$, and $c_3 = \\frac{11}{126}$.\nThe complete set of stencil coefficients, using $c_0=0$ and $c_{-j}=-c_j$, is:\n$$\nc_{-3} = -\\frac{11}{126}, \\quad c_{-2} = \\frac{109}{252}, \\quad c_{-1} = -\\frac{139}{126}, \\quad c_0 = 0, \\quad c_1 = \\frac{139}{126}, \\quad c_2 = -\\frac{109}{252}, \\quad c_3 = \\frac{11}{126}\n$$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -\\frac{11}{126} & \\frac{109}{252} & -\\frac{139}{126} & 0 & \\frac{139}{126} & -\\frac{109}{252} & \\frac{11}{126} \\end{pmatrix}}\n$$"
        }
    ]
}