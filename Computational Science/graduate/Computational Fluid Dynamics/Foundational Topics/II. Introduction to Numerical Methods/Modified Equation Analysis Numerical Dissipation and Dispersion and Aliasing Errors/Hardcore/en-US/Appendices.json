{
    "hands_on_practices": [
        {
            "introduction": "Understanding the errors inherent in a numerical scheme is the first step toward mastering computational fluid dynamics. This exercise provides foundational practice in modified equation analysis by examining the classic MacCormack scheme. By deriving the modified equation, you will learn to precisely identify and quantify the leading-order numerical dispersion and dissipation, gaining insight into how this popular scheme behaves and discovering the specific conditions under which its accuracy can be maximized .",
            "id": "3346245",
            "problem": "Consider the constant-coefficient linear advection equation $u_t + a u_x = 0$ with $a \\in \\mathbb{R}$ on a uniform grid with spatial step $h$ and time step $\\tau$. Define the Courant–Friedrichs–Lewy (CFL) number $\\lambda = \\frac{a \\tau}{h}$. Apply the MacCormack predictor–corrector method in its standard one-dimensional form, where the predictor uses the forward difference and the corrector uses the backward difference:\n$$\nu_i^{(p)} = u_i^n - \\lambda \\left(u_{i+1}^n - u_i^n\\right), \\quad\nu_i^{n+1} = \\frac{1}{2}\\left(u_i^n + u_i^{(p)} - \\lambda \\left(u_i^{(p)} - u_{i-1}^{(p)}\\right)\\right).\n$$\nStarting from this discretization and the base partial differential equation, perform a modified equation analysis that consistently retains and combines cross terms introduced by the predictor and the corrector. Use a Fourier mode ansatz $u_i^n = \\exp\\!\\left(i\\left(k x_i - \\omega t_n\\right)\\right)$ to connect the discrete amplification factor to a continuous modified equation and determine the leading-order dispersive and dissipative corrections. Derive a closed-form modified equation of the form\n$$\nu_t + a u_x = \\chi(\\lambda,a)\\, h^2\\, u_{xxx} - \\delta(\\lambda,a)\\, h^3\\, u_{xxxx} + O\\!\\left(h^4\\right),\n$$\nwith explicit analytical expressions for $\\chi(\\lambda,a)$ and $\\delta(\\lambda,a)$ that arise from matching the series expansion of the scheme’s amplification factor to the exponential of the modified dispersion relation. Based on these expressions, identify the CFL value $\\lambda_\\star$ that cancels the leading $O(h^2)$ dispersive error, and state the symbolic form of the leading dissipative coefficient $\\delta(\\lambda,a)$ in the above representation.\n\nIn your derivation, explain the roles of numerical dispersion and numerical dissipation, and discuss how aliasing errors may manifest at high wavenumbers in the discrete symbol and how the presence or absence of dissipation influences their control. Your final reported quantities must be:\n- The single CFL value $\\lambda_\\star$ that cancels the $O(h^2)$ dispersive term.\n- The closed-form expression of $\\delta(\\lambda,a)$.\n\nExpress your final answer as a single analytical expression or as a single row vector using LaTeX’s $pmatrix$. No rounding is required.",
            "solution": "The subject of this analysis is the one-dimensional, constant-coefficient linear advection equation, given by:\n$$\nu_t + a u_x = 0\n$$\nwhere $a \\in \\mathbb{R}$ is the constant advection speed. We analyze the MacCormack predictor-corrector scheme on a uniform grid with spatial step $h$ and time step $\\tau$. The Courant–Friedrichs–Lewy (CFL) number is defined as $\\lambda = \\frac{a \\tau}{h}$.\n\nThe scheme is defined by two steps:\n1.  **Predictor step (forward difference):**\n    $$\n    u_i^{(p)} = u_i^n - \\lambda \\left(u_{i+1}^n - u_i^n\\right)\n    $$\n2.  **Corrector step (backward difference on predicted values):**\n    $$\n    u_i^{n+1} = \\frac{1}{2}\\left(u_i^n + u_i^{(p)} - \\lambda \\left(u_i^{(p)} - u_{i-1}^{(p)}\\right)\\right)\n    $$\n\nOur first task is to combine these two steps into a single explicit formula for $u_i^{n+1}$ in terms of values at the time level $n$. We substitute the predictor expression into the corrector expression.\nFirst, we write the predictor for indices $i$ and $i-1$:\n$$\nu_i^{(p)} = (1+\\lambda)u_i^n - \\lambda u_{i+1}^n\n$$\n$$\nu_{i-1}^{(p)} = (1+\\lambda)u_{i-1}^n - \\lambda u_{i}^n\n$$\nNow, substitute these into the corrector equation:\n$$\nu_i^{n+1} = \\frac{1}{2}\\left[ u_i^n + \\left((1+\\lambda)u_i^n - \\lambda u_{i+1}^n\\right) - \\lambda \\left( \\left((1+\\lambda)u_i^n - \\lambda u_{i+1}^n\\right) - \\left((1+\\lambda)u_{i-1}^n - \\lambda u_{i}^n\\right) \\right) \\right]\n$$\nSimplifying the term inside the large parentheses:\n$$\nu_i^{n+1} = \\frac{1}{2}\\left[ (2+\\lambda)u_i^n - \\lambda u_{i+1}^n - \\lambda \\left( (1+2\\lambda)u_i^n - \\lambda u_{i+1}^n - (1+\\lambda)u_{i-1}^n \\right) \\right]\n$$\nDistributing the inner $-\\lambda$:\n$$\nu_i^{n+1} = \\frac{1}{2}\\left[ (2+\\lambda)u_i^n - \\lambda u_{i+1}^n - \\lambda(1+2\\lambda)u_i^n + \\lambda^2 u_{i+1}^n + \\lambda(1+\\lambda)u_{i-1}^n \\right]\n$$\nCollecting terms based on their spatial index:\n$$\nu_i^{n+1} = \\frac{1}{2}\\left[ \\left(2+\\lambda - \\lambda - 2\\lambda^2\\right)u_i^n + \\left(\\lambda^2 - \\lambda\\right)u_{i+1}^n + \\left(\\lambda^2 + \\lambda\\right)u_{i-1}^n \\right]\n$$\n$$\nu_i^{n+1} = \\frac{1}{2}\\left[ (2 - 2\\lambda^2)u_i^n + \\lambda(\\lambda-1)u_{i+1}^n + \\lambda(\\lambda+1)u_{i-1}^n \\right]\n$$\nThis simplifies to the well-known Lax-Wendroff scheme stencil:\n$$\nu_i^{n+1} = (1 - \\lambda^2)u_i^n + \\frac{\\lambda(\\lambda-1)}{2}u_{i+1}^n + \\frac{\\lambda(\\lambda+1)}{2}u_{i-1}^n\n$$\n\nTo perform the modified equation analysis, we introduce a Fourier mode ansatz $u_j^n = G^n(k) \\exp(i k x_j)$, where $x_j=jh$, $k$ is the wavenumber, and $G(k)$ is the amplification factor. Substituting this into the single-step scheme gives:\n$$\nG \\exp(ikx_i) = (1 - \\lambda^2)\\exp(ikx_i) + \\frac{\\lambda(\\lambda-1)}{2}\\exp(ikx_{i+1}) + \\frac{\\lambda(\\lambda+1)}{2}\\exp(ikx_{i-1})\n$$\nDividing by $\\exp(ikx_i)$:\n$$\nG = (1 - \\lambda^2) + \\frac{\\lambda(\\lambda-1)}{2}\\exp(ikh) + \\frac{\\lambda(\\lambda+1)}{2}\\exp(-ikh)\n$$\nUsing the dimensionless wavenumber $\\theta = kh$ and Euler's formula $\\exp(\\pm i\\theta) = \\cos(\\theta) \\pm i\\sin(\\theta)$, we find:\n$$\nG(\\theta) = 1 - \\lambda^2 + \\left(\\frac{\\lambda(\\lambda-1)}{2} + \\frac{\\lambda(\\lambda+1)}{2}\\right)\\cos(\\theta) + i\\left(\\frac{\\lambda(\\lambda-1)}{2} - \\frac{\\lambda(\\lambda+1)}{2}\\right)\\sin(\\theta)\n$$\n$$\nG(\\theta) = 1 - \\lambda^2 + \\lambda^2\\cos(\\theta) - i\\lambda\\sin(\\theta) = 1 - \\lambda^2(1-\\cos(\\theta)) - i\\lambda\\sin(\\theta)\n$$\nThe modified equation is of the form $u_t + a u_x = \\mathcal{L}_{err}(u)$, where $\\mathcal{L}_{err}$ represents the error terms. The amplification factor of the modified equation over one time step $\\tau$ is $G_{mod} = \\exp(-i\\omega_{mod}\\tau)$, where $\\omega_{mod}(k)$ is the modified dispersion relation. We find $\\omega_{mod}$ by substituting $u(x,t) = \\exp(i(kx-\\omega_{mod}t))$ into the target modified equation:\n$u_t + a u_x = \\chi h^2 u_{xxx} - \\delta h^3 u_{xxxx}$\n$$\n-i\\omega_{mod} + a(ik) = \\chi h^2 (ik)^3 - \\delta h^3 (ik)^4\n$$\n$$\n-i\\omega_{mod} = -iak - i\\chi k^3 h^2 - \\delta k^4 h^3\n$$\nMultiplying by $\\tau$ and using $\\lambda = a\\tau/h$, $\\theta=kh$:\n$$\n-i\\omega_{mod}\\tau = -iak\\tau - i\\chi k^3 h^2 \\tau - \\delta k^4 h^3 \\tau = -i\\lambda\\theta - i\\chi(k^3 h^3)\\frac{\\tau}{h} - \\delta(k^4 h^4)\\frac{\\tau}{h}\n$$\n$$\n\\ln(G_{mod}) = -i\\lambda\\theta - i\\frac{\\chi\\lambda}{a}\\theta^3 - \\frac{\\delta\\lambda}{a}\\theta^4 + O(\\theta^5)\n$$\nWe must match this to the Taylor series expansion of $\\ln(G(\\theta))$ for the numerical scheme. Let us expand $G(\\theta)$ for small $\\theta$:\n$$\n\\cos(\\theta) = 1 - \\frac{\\theta^2}{2!} + \\frac{\\theta^4}{4!} - O(\\theta^6)\n$$\n$$\n\\sin(\\theta) = \\theta - \\frac{\\theta^3}{3!} + \\frac{\\theta^5}{5!} - O(\\theta^7)\n$$\n$$\nG(\\theta) = 1 - \\lambda^2\\left(\\frac{\\theta^2}{2} - \\frac{\\theta^4}{24} + \\dots\\right) - i\\lambda\\left(\\theta - \\frac{\\theta^3}{6} + \\dots\\right)\n$$\n$$\nG(\\theta) = 1 - i\\lambda\\theta - \\frac{\\lambda^2\\theta^2}{2} + i\\frac{\\lambda\\theta^3}{6} + \\frac{\\lambda^2\\theta^4}{24} + O(\\theta^5)\n$$\nUsing the series $\\ln(1+z) = z - z^2/2 + z^3/3 - z^4/4 + \\dots$ with $z = G(\\theta)-1$, the expansion of $\\ln(G(\\theta))$ is:\n$$\n\\ln(G(\\theta)) = -i\\lambda\\theta + i\\frac{\\lambda(1-\\lambda^2)}{6}\\theta^3 - \\frac{\\lambda^2(1-\\lambda^2)}{8}\\theta^4 + O(\\theta^5)\n$$\nComparing this with $\\ln(G_{mod})$:\n$$\n-i\\lambda\\theta - i\\frac{\\chi\\lambda}{a}\\theta^3 - \\frac{\\delta\\lambda}{a}\\theta^4 = -i\\lambda\\theta + i\\frac{\\lambda(1-\\lambda^2)}{6}\\theta^3 - \\frac{\\lambda^2(1-\\lambda^2)}{8}\\theta^4\n$$\nMatching the imaginary $\\theta^3$ terms (dispersive error):\n$$\n-i\\frac{\\chi\\lambda}{a} = i\\frac{\\lambda(1-\\lambda^2)}{6} \\implies \\chi(\\lambda,a) = -\\frac{a(1-\\lambda^2)}{6} = \\frac{a(\\lambda^2-1)}{6}\n$$\nThis is the coefficient of the leading-order dispersive error term $h^2 u_{xxx}$. Numerical dispersion arises from odd-derivative error terms, which cause different Fourier components of the solution to propagate at incorrect, wavenumber-dependent phase velocities, distorting the solution profile.\n\nMatching the real $\\theta^4$ terms (dissipative error):\n$$\n-\\frac{\\delta\\lambda}{a} = -\\frac{\\lambda^2(1-\\lambda^2)}{8} \\implies \\delta(\\lambda,a) = \\frac{a\\lambda(1-\\lambda^2)}{8}\n$$\nThis is the coefficient for the leading-order dissipative error term, which is written as $-\\delta h^3 u_{xxxx}$ in the modified equation. Numerical dissipation arises from even-derivative error terms, which cause the amplitudes of Fourier components to decay. This effect is generally stronger for higher wavenumbers (shorter wavelengths) and can be beneficial for damping spurious, high-frequency oscillations. Such oscillations can be generated by aliasing, where wavenumbers higher than the grid's Nyquist frequency ($k_{Nyquist} = \\pi/h$) are misrepresented as lower wavenumbers. This misrepresentation can lead to non-physical behavior, such as components propagating in the wrong direction. The dissipative term, whose coefficient is positive for the stable range $|\\lambda|1$, systematically removes energy from the system, particularly at high wavenumbers, thus controlling the growth of aliasing-induced instabilities.\n\nTo cancel the leading $O(h^2)$ dispersive error, we set its coefficient $\\chi(\\lambda, a)$ to zero:\n$$\n\\frac{a(\\lambda^2-1)}{6} = 0\n$$\nAssuming $a \\neq 0$, this requires $\\lambda^2 - 1 = 0$, which yields $\\lambda = \\pm 1$. In either case, $|\\lambda|=1$. For a specific case with $a>0$, the corresponding CFL number is $\\lambda=1$. Thus, we identify the specific value $\\lambda_\\star=1$ as the condition for vanishing third-order dispersion. For $\\lambda_\\star = \\pm 1$, the scheme becomes exact, $u_i^{n+1}=u_{i\\mp1}^n$, and all error terms, including the dissipative ones, vanish.\n\nThe required quantities are the CFL value $\\lambda_\\star$ and the expression for $\\delta(\\lambda,a)$.\n1.  The single CFL value that cancels the $O(h^2)$ dispersive term is $\\lambda_\\star=1$ (or, more generally, $|\\lambda_\\star|=1$). We will report the principal positive value.\n2.  The leading dissipative coefficient is $\\delta(\\lambda,a) = \\frac{a\\lambda(1-\\lambda^2)}{8}$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 1  \\frac{a\\lambda(1-\\lambda^2)}{8} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "Modified equation analysis is not just for diagnosing errors; it is a powerful tool for designing them. In this practice, we shift from analyzing inherent numerical flaws to evaluating intentionally added artificial viscosity, a common technique for stabilizing solutions near shocks. You will analyze a scheme that uses a shock sensor to apply viscosity selectively, learning how to quantify the sensor's effect and tune its parameters to suppress oscillations without excessively damping physical features in smooth regions of the flow .",
            "id": "3346187",
            "problem": "Consider the one-dimensional linear advection equation $u_{t} + a\\,u_{x} = 0$ for a passive scalar $u(x,t)$ with constant advection speed $a$. A uniform grid with spacing $h$ is used, and a forward Euler time discretization with time step $\\Delta t$ advances the solution. To add shock capturing while minimizing spurious damping in smooth regions, an artificial viscosity term is included in semi-discrete form as a second-difference, scaled by a shock sensor. The fully discrete update at grid index $i$ and time level $n$ is\n$$\nu_{i}^{n+1} = u_{i}^{n} - \\frac{a\\,\\Delta t}{2h}\\left(u_{i+1}^{n} - u_{i-1}^{n}\\right) + \\Delta t\\,\\frac{\\nu_{i}^{n}}{h^{2}}\\left(u_{i+1}^{n} - 2u_{i}^{n} + u_{i-1}^{n}\\right),\n$$\nwhere the artificial viscosity coefficient is defined pointwise as\n$$\n\\nu_{i}^{n} = C_{\\text{vis}}\\;a\\,h\\,S_{i}^{n},\n$$\nwith a dimensionless scaling parameter $C_{\\text{vis}} > 0$ and a shock sensor\n$$\nS_{i}^{n} = \\left|\\frac{u_{i+1}^{n} - 2u_{i}^{n} + u_{i-1}^{n}}{u_{i+1}^{n} - u_{i-1}^{n}}\\right|.\n$$\nYou may assume that $S_{i}^{n}$ is evaluated without any additional limiting in smooth regions. A modified equation analysis should be used to connect the discrete scheme to a continuous equation, revealing the leading-order dissipative and dispersive corrections and quantifying the action of the sensor in the presence of a traveling wave. In particular, consider a smooth traveling wave $u(x,t) = A \\sin\\!\\big(k(x - a t)\\big)$, with amplitude $A$ and wavenumber $k$ in radians per unit length. Focus on the dimensionless wavenumber $\\theta = k h$ content and suppose that a single Fourier mode with $\\theta \\approx 0.5$ dominates the local spectrum.\n\nTasks:\n1. Starting from the discrete update and the definition of the shock sensor, derive the leading-order modified equation for $u(x,t)$, identifying the equivalent continuous viscosity field $\\nu_{\\text{num}}(x)$ induced by the artificial viscosity term in terms of $C_{\\text{vis}}$, $a$, $h$, and the local value of the sensor for the traveling wave.\n2. For a single Fourier mode with dimensionless wavenumber $\\theta = k h$, use the discrete sensor definition to deduce a closed-form expression for the sensor magnitude as a function of $\\theta$. From this, express the equivalent viscosity $\\nu_{\\text{num}}$ near the smooth traveling wave explicitly as a function of $\\theta$.\n3. Using the result of the modified equation and the discrete symbol of the second-difference operator, obtain the per-step amplitude reduction factor caused by the artificial viscosity for a Fourier mode with wavenumber $k$ and grid spacing $h$, in terms of $C_{\\text{vis}}$, $a$, $\\Delta t$, $h$, and $\\theta$.\n4. Let the advection speed be $a = 1.2$ (in meters per second), the grid spacing be $h = 1.0 \\times 10^{-2}$ (in meters), and the time step satisfy a Courant–Friedrichs–Lewy (CFL) number $\\lambda = a\\,\\Delta t / h = 0.7$. Impose the requirement that the amplitude reduction per time step for the Fourier content with $\\theta = 0.5$ be at most $0.01$ in decimal form. Under this requirement, determine the maximum allowable value of the dimensionless viscosity scaling parameter $C_{\\text{vis}}$ that avoids overdamping of the $\\theta \\approx 0.5$ content.\nRound your final answer to four significant figures. Express the final answer as a dimensionless number.",
            "solution": "The problem statement is scientifically grounded, well-posed, and objective. It presents a standard problem in the numerical analysis of partial differential equations, specifically concerning modified equation analysis for a finite difference scheme applied to the linear advection equation. All necessary data and definitions are provided. We may therefore proceed with the solution.\n\nThe problem asks for a four-part analysis of a numerical scheme for the one-dimensional linear advection equation, $u_{t} + a\\,u_{x} = 0$. The scheme is given by\n$$\nu_{i}^{n+1} = u_{i}^{n} - \\frac{a\\,\\Delta t}{2h}\\left(u_{i+1}^{n} - u_{i-1}^{n}\\right) + \\Delta t\\,\\frac{\\nu_{i}^{n}}{h^{2}}\\left(u_{i+1}^{n} - 2u_{i}^{n} + u_{i-1}^{n}\\right),\n$$\nwith the artificial viscosity coefficient $\\nu_{i}^{n} = C_{\\text{vis}}\\;a\\,h\\,S_{i}^{n}$ and the shock sensor $S_{i}^{n} = \\left|\\frac{u_{i+1}^{n} - 2u_{i}^{n} + u_{i-1}^{n}}{u_{i+1}^{n} - u_{i-1}^{n}}\\right|$.\n\n**1. Modified Equation and Equivalent Viscosity**\n\nTo derive the modified equation, we perform Taylor series expansions of the terms in the finite difference scheme around the point $(x_i, t_n)$. Let $u = u(x_i, t_n)$.\nThe time derivative term on the left-hand side is approximated by\n$$\n\\frac{u_i^{n+1} - u_i^n}{\\Delta t} = \\frac{(u + \\Delta t u_t + \\frac{\\Delta t^2}{2} u_{tt} + \\dots) - u}{\\Delta t} = u_t + \\frac{\\Delta t}{2} u_{tt} + O(\\Delta t^2).\n$$\nThe spatial differences on the right-hand side are expanded as:\nThe central difference for the first derivative:\n$$\n\\frac{u_{i+1}^n - u_{i-1}^n}{2h} = \\frac{(u+h u_x+\\frac{h^2}{2}u_{xx}+\\frac{h^3}{6}u_{xxx}+\\dots)-(u-h u_x+\\frac{h^2}{2}u_{xx}-\\frac{h^3}{6}u_{xxx}+\\dots)}{2h} = u_x + \\frac{h^2}{6}u_{xxx} + O(h^4).\n$$\nThe central difference for the second derivative:\n$$\n\\frac{u_{i+1}^n - 2u_i^n + u_{i-1}^n}{h^2} = \\frac{(u+h u_x+\\frac{h^2}{2}u_{xx}+\\dots) - 2u + (u-h u_x+\\frac{h^2}{2}u_{xx}-\\dots)}{h^2} = u_{xx} + \\frac{h^2}{12}u_{xxxx} + O(h^4).\n$$\nSubstituting these expansions into the scheme gives:\n$$\nu_t + \\frac{\\Delta t}{2} u_{tt} + \\dots = -a\\left(u_x + \\frac{h^2}{6}u_{xxx}\\right) + \\nu_i^n \\left(u_{xx} + \\frac{h^2}{12}u_{xxxx}\\right) + \\dots\n$$\nTo eliminate the $u_{tt}$ term, we differentiate the original PDE, $u_t = -a u_x$, with respect to time: $u_{tt} = -a u_{xt} = -a(u_t)_x = -a(-a u_x)_x = a^2 u_{xx}$.\nSubstituting this back into the expanded scheme:\n$$\nu_t + \\frac{a^2 \\Delta t}{2} u_{xx} + \\dots = -a u_x - \\frac{ah^2}{6}u_{xxx} + \\nu_i^n u_{xx} + \\dots\n$$\nRearranging to match the form of a modified PDE, we get:\n$$\nu_t + a u_x = (\\nu_i^n - \\frac{a^2 \\Delta t}{2}) u_{xx} - \\frac{ah^2}{6}u_{xxx} + O(\\Delta t^2, h^4, \\Delta t h^2).\n$$\nThis is the leading-order modified equation. The term $(\\nu_i^n - \\frac{a^2 \\Delta t}{2}) u_{xx}$ is the total leading-order dissipation, comprising the added artificial viscosity and the numerical viscosity from the Forward-Euler-in-time, central-in-space discretization of the advection term. The term $-\\frac{ah^2}{6}u_{xxx}$ is the leading-order numerical dispersion.\n\nThe problem asks for the equivalent continuous viscosity field $\\nu_{\\text{num}}(x)$ induced by the artificial viscosity term. This corresponds to the continuous analogue of the coefficient $\\nu_i^n$ that multiplies the second derivative $u_{xx}$. Thus, the equivalent viscosity is simply the continuous representation of $\\nu_i^n$.\n$$\n\\nu_{\\text{num}}(x,t) = C_{\\text{vis}}\\,a\\,h\\,S(x,t)\n$$\nwhere $S(x,t)$ is the continuous analogue of the sensor $S_i^n$. This is the answer to the first task.\n\n**2. Sensor Magnitude and Equivalent Viscosity as a function of $\\theta$**\n\nWe analyze the sensor for a single Fourier mode, $u(x) = \\exp(I k x)$, where $I = \\sqrt{-1}$. The analysis is performed at a fixed time level $n$. The dimensionless wavenumber is $\\theta = k h$.\n$u_j = \\exp(I k x_j) = \\exp(I k (jh))$.\nThe numerator of the sensor ratio involves the second difference operator $\\delta^2$:\n$$\nu_{i+1} - 2u_i + u_{i-1} = u_i(\\exp(I\\theta) - 2 + \\exp(-I\\theta)) = u_i(2\\cos(\\theta) - 2) = -4u_i\\sin^2(\\frac{\\theta}{2}).\n$$\nThe denominator involves the central first difference operator over $2h$, let's call it $\\delta_{2x}$:\n$$\nu_{i+1} - u_{i-1} = u_i(\\exp(I\\theta) - \\exp(-I\\theta)) = u_i(2I\\sin(\\theta)).\n$$\nThe ratio for this complex mode is:\n$$\n\\frac{u_{i+1} - 2u_i + u_{i-1}}{u_{i+1} - u_{i-1}} = \\frac{-4u_i\\sin^2(\\frac{\\theta}{2})}{2Iu_i\\sin(\\theta)} = \\frac{-4\\sin^2(\\frac{\\theta}{2})}{2I(2\\sin(\\frac{\\theta}{2})\\cos(\\frac{\\theta}{2}))} = \\frac{-\\sin(\\frac{\\theta}{2})}{I\\cos(\\frac{\\theta}{2})} = I\\tan(\\frac{\\theta}{2}).\n$$\nThe sensor $S_i^n$ is the magnitude of this complex number. Since the problem focuses on a single mode, we evaluate the sensor for this mode.\n$$\nS(\\theta) = \\left|I\\tan(\\frac{\\theta}{2})\\right| = \\left|\\tan(\\frac{\\theta}{2})\\right|.\n$$\nFor physical waves represented on a grid, we consider $k h = \\theta \\in [0, \\pi]$, for which $\\tan(\\theta/2) \\ge 0$. Therefore,\n$$\nS(\\theta) = \\tan(\\frac{\\theta}{2}).\n$$\nThe equivalent viscosity for this mode is then a function of $\\theta$:\n$$\n\\nu_{\\text{num}}(\\theta) = C_{\\text{vis}}\\,a\\,h\\,S(\\theta) = C_{\\text{vis}}\\,a\\,h\\,\\tan(\\frac{\\theta}{2}).\n$$\n\n**3. Per-step Amplitude Reduction Factor**\n\nThe amplitude evolution of a Fourier mode $u_i^n = \\hat{u}^n e^{I k x_i}$ is described by the amplification factor $G = \\hat{u}^{n+1}/\\hat{u}^n$. Substituting the mode into the discrete scheme:\n$$\nG u_i^n = u_i^n - \\frac{a\\Delta t}{2h}(u_{i+1}^n - u_{i-1}^n) + \\frac{\\Delta t \\nu_{\\text{num}}(\\theta)}{h^2}(u_{i+1}^n - 2u_i^n + u_{i-1}^n).\n$$\nDividing by $u_i^n$ and substituting the discrete operator symbols found in part 2:\n$$\nG = 1 - \\frac{a\\Delta t}{2h}(2I\\sin\\theta) + \\frac{\\Delta t \\nu_{\\text{num}}(\\theta)}{h^2}(-4\\sin^2(\\frac{\\theta}{2})).\n$$\nUsing the CFL number $\\lambda = a\\Delta t/h$:\n$$\nG = 1 - I\\lambda\\sin\\theta - \\frac{4\\Delta t \\nu_{\\text{num}}(\\theta)}{h^2}\\sin^2(\\frac{\\theta}{2}).\n$$\nThe \"amplitude reduction factor caused by the artificial viscosity\" refers to the term that damps the amplitude. The real part of $G$ controls the amplitude change.\n$$\n\\text{Re}(G) = 1 - \\frac{4\\Delta t \\nu_{\\text{num}}(\\theta)}{h^2}\\sin^2(\\frac{\\theta}{2}).\n$$\nThe per-step fractional amplitude reduction, let's call it $\\mathcal{R}$, is the positive quantity subtracted from $1$ in $\\text{Re}(G)$:\n$$\n\\mathcal{R} = \\frac{4\\Delta t \\nu_{\\text{num}}(\\theta)}{h^2}\\sin^2(\\frac{\\theta}{2}).\n$$\nSubstituting the expression for $\\nu_{\\text{num}}(\\theta)$ from part 2:\n$$\n\\mathcal{R} = \\frac{4\\Delta t}{h^2} \\left(C_{\\text{vis}}\\,a\\,h\\,\\tan(\\frac{\\theta}{2})\\right) \\sin^2(\\frac{\\theta}{2}) = 4 \\left(\\frac{a\\Delta t}{h}\\right) C_{\\text{vis}} \\tan(\\frac{\\theta}{2})\\sin^2(\\frac{\\theta}{2}).\n$$\nThus, the per-step amplitude reduction is:\n$$\n\\mathcal{R} = 4 \\lambda C_{\\text{vis}} \\tan(\\frac{\\theta}{2})\\sin^2(\\frac{\\theta}{2}).\n$$\n\n**4. Maximum Allowable Value of $C_{\\text{vis}}$**\n\nWe are given the constraint that the amplitude reduction per time step for $\\theta = 0.5$ is at most $0.01$. This means $\\mathcal{R} \\le 0.01$.\n$$\n4 \\lambda C_{\\text{vis}} \\tan(\\frac{\\theta}{2})\\sin^2(\\frac{\\theta}{2}) \\le 0.01.\n$$\nWe need to find the maximum allowable value of $C_{\\text{vis}}$, which occurs at the equality:\n$$\nC_{\\text{vis, max}} = \\frac{0.01}{4 \\lambda \\tan(\\frac{\\theta}{2})\\sin^2(\\frac{\\theta}{2})}.\n$$\nThe given parameters are:\n- $\\lambda = 0.7$\n- $\\theta = 0.5$ (radians)\n\nTherefore, $\\theta/2 = 0.25$ radians. We compute the trigonometric functions:\n$$\n\\tan(0.25) \\approx 0.255340758\n$$\n$$\n\\sin(0.25) \\approx 0.247403959\n$$\n$$\n\\sin^2(0.25) \\approx 0.061208611\n$$\nNow, substitute these values into the expression for $C_{\\text{vis, max}}$:\n$$\nC_{\\text{vis, max}} = \\frac{0.01}{4 \\times 0.7 \\times \\tan(0.25) \\times \\sin^2(0.25)}\n$$\n$$\nC_{\\text{vis, max}} = \\frac{0.01}{2.8 \\times 0.255340758 \\times 0.061208611}\n$$\n$$\nC_{\\text{vis, max}} = \\frac{0.01}{0.04375404} \\approx 0.2285461\n$$\nRounding to four significant figures, we get:\n$$\nC_{\\text{vis, max}} \\approx 0.2285.\n$$",
            "answer": "$$\n\\boxed{0.2285}\n$$"
        },
        {
            "introduction": "Beyond local truncation error, the algebraic structure of a numerical scheme can endow it with powerful global properties. This advanced practice explores the difference between a standard conservative discretization and a specially constructed skew-symmetric form for the nonlinear Burgers' equation. You will discover how the skew-symmetric formulation perfectly conserves kinetic energy at the discrete level, thereby eliminating a source of aliasing-induced instability that plagues many other schemes, a property not fully captured by a simple Taylor series analysis .",
            "id": "3346217",
            "problem": "Consider the one-dimensional inviscid Burgers equation on a periodic domain with coordinate $x \\in [0,2\\pi)$ and time $t \\geq 0$,\n$$\nu_{t} + u\\,u_{x} = 0,\n$$\nwhere $u(x,t)$ is sufficiently smooth. Let $\\{x_{j}\\}_{j=0}^{N-1}$ denote an equispaced grid with spacing $h = \\frac{2\\pi}{N}$, and let $D$ denote the semi-discrete second-order centered difference operator defined by\n$$\nD u_{j} = \\frac{u_{j+1}-u_{j-1}}{2h},\n$$\nwith periodic indexing.\n\nTwo semi-discrete formulations of the nonlinear term $u\\,u_{x}$ are considered:\n\n1. The conservative form,\n$$\nu_{t,j} + \\frac{1}{2}\\,D\\!\\left(u_{j}^{2}\\right) = 0,\n$$\n\n2. The skew-symmetric, kinetic-energy-conserving split form,\n$$\nu_{t,j} + \\frac{1}{3}\\,D\\!\\left(u_{j}^{2}\\right) + \\frac{1}{3}\\,u_{j}\\,D u_{j} = 0.\n$$\n\nThese formulations are used without explicit dealiasing procedures. Assume $u$ has a Fourier representation $u(x,t) = \\sum_{k} \\hat{u}(k,t)\\,\\exp(i k x)$, where $k$ are integer wavenumbers consistent with the grid. Define the discrete kinetic energy\n$$\nE_{d}(t) = \\frac{h}{2}\\sum_{j=0}^{N-1} u_{j}(t)^{2},\n$$\nand consider the energy budget induced by each semi-discrete formulation. The modified equation analysis uses the centered-difference Taylor expansion\n$$\nD f = f_{x} + \\frac{h^{2}}{6} f_{xxx} + \\mathcal{O}(h^{4}),\n$$\napplied consistently to all differentiations, and interprets aliasing by the failure of the discrete product rule $D(u^{2}) \\neq 2 u\\,D u$ on the grid.\n\nFor each formulation, derive its $\\mathcal{O}(h^{2})$ modified equation in continuous form and use the corresponding semi-discrete energy budget to define an effective wavenumber-dependent numerical viscosity $\\nu_{\\text{num}}(k)$ by matching the leading-order energy change at mode $k$ to the viscous energy decay law\n$$\n\\frac{d}{dt}\\left(\\frac{|\\hat{u}(k)|^{2}}{2}\\right) \\approx -\\nu_{\\text{num}}(k)\\,k^{2}\\,|\\hat{u}(k)|^{2},\n$$\nwith all aliasing-induced transfers interpreted in this sense. Assume that the field contains sufficient Fourier content to realize nonzero aliasing-induced energy transfer in the conservative formulation, and that $D$ satisfies discrete summation-by-parts with respect to the discrete inner product.\n\nFinally, compute the ratio\n$$\nR(k) = \\frac{\\nu_{\\text{num}}^{\\text{skew}}(k)}{\\nu_{\\text{num}}^{\\text{cons}}(k)}\n$$\nfor any resolved wavenumber $k$ under these assumptions. Express your final answer as a single real number. No rounding is required, and no physical units need be attached to the final answer inside the box. If relevant, angles should be interpreted in radians.",
            "solution": "The problem asks for the ratio $R(k) = \\frac{\\nu_{\\text{num}}^{\\text{skew}}(k)}{\\nu_{\\text{num}}^{\\text{cons}}(k)}$ of effective numerical viscosities for two different semi-discretizations of the inviscid Burgers equation. The numerical viscosity $\\nu_{\\text{num}}(k)$ for each scheme is to be determined from its corresponding semi-discrete energy budget.\n\nFirst, we establish the definitions provided in the problem statement.\nThe two semi-discrete formulations are:\n1. Conservative form:\n$$\nu_{t,j} + \\frac{1}{2}\\,D\\!\\left(u_{j}^{2}\\right) = 0 \\quad (\\text{Scheme 1})\n$$\n2. Skew-symmetric, kinetic-energy-conserving split form:\n$$\nu_{t,j} + \\frac{1}{3}\\,D\\!\\left(u_{j}^{2}\\right) + \\frac{1}{3}\\,u_{j}\\,D u_{j} = 0 \\quad (\\text{Scheme 2})\n$$\nThe discrete kinetic energy is defined as:\n$$\nE_{d}(t) = \\frac{h}{2}\\sum_{j=0}^{N-1} u_{j}(t)^{2}\n$$\nThe centered difference operator $D$ is assumed to satisfy the discrete summation-by-parts (SBP) property. For a periodic domain, this property implies that for any grid functions $f_j$ and $g_j$, the discrete inner product satisfies:\n$$\n\\sum_{j=0}^{N-1} f_{j} (D g_{j}) = - \\sum_{j=0}^{N-1} g_{j} (D f_{j})\n$$\n\nThe core of the problem lies in determining the energy budget, i.e., the rate of change of the discrete kinetic energy $\\frac{dE_d}{dt}$, for each scheme. The time derivative of $E_d$ is:\n$$\n\\frac{dE_d}{dt} = \\frac{d}{dt}\\left(\\frac{h}{2}\\sum_{j=0}^{N-1} u_{j}^{2}\\right) = \\frac{h}{2}\\sum_{j=0}^{N-1} 2 u_{j} \\frac{du_j}{dt} = h\\sum_{j=0}^{N-1} u_{j} u_{t,j}\n$$\nWe now substitute the expression for $u_{t,j}$ from each scheme.\n\nLet's analyze the skew-symmetric formulation (Scheme 2). The defining feature of this scheme, as its name suggests, is its behavior with respect to the energy budget. Substituting $u_{t,j}$ from Scheme 2 into the expression for $\\frac{dE_d}{dt}$:\n$$\n\\frac{dE_d^{\\text{skew}}}{dt} = h\\sum_{j=0}^{N-1} u_{j} \\left(-\\frac{1}{3}\\,D\\!\\left(u_{j}^{2}\\right) - \\frac{1}{3}\\,u_{j}\\,D u_{j}\\right)\n$$\n$$\n\\frac{dE_d^{\\text{skew}}}{dt} = -\\frac{h}{3}\\sum_{j=0}^{N-1} u_{j}\\,D\\!\\left(u_{j}^{2}\\right) - \\frac{h}{3}\\sum_{j=0}^{N-1} u_{j}^{2}\\,D u_{j}\n$$\nWe apply the summation-by-parts property to the first term, with $f_j = u_j$ and $g_j = u_j^2$:\n$$\n\\sum_{j=0}^{N-1} u_{j}\\,D\\!\\left(u_{j}^{2}\\right) = - \\sum_{j=0}^{N-1} u_{j}^{2}\\,D u_{j}\n$$\nSubstituting this result back into the expression for the energy change:\n$$\n\\frac{dE_d^{\\text{skew}}}{dt} = -\\frac{h}{3}\\left(- \\sum_{j=0}^{N-1} u_{j}^{2}\\,D u_{j}\\right) - \\frac{h}{3}\\sum_{j=0}^{N-1} u_{j}^{2}\\,D u_{j}\n$$\n$$\n\\frac{dE_d^{\\text{skew}}}{dt} = \\frac{h}{3}\\sum_{j=0}^{N-1} u_{j}^{2}\\,D u_{j} - \\frac{h}{3}\\sum_{j=0}^{N-1} u_{j}^{2}\\,D u_{j} = 0\n$$\nThus, the discrete kinetic energy is exactly conserved by the skew-symmetric formulation.\n\nThe problem requires us to define an effective numerical viscosity $\\nu_{\\text{num}}(k)$ by matching the energy change to the viscous decay law:\n$$\n\\frac{d}{dt}\\left(\\frac{|\\hat{u}(k)|^{2}}{2}\\right) \\approx -\\nu_{\\text{num}}(k)\\,k^{2}\\,|\\hat{u}(k)|^{2}\n$$\nThe total rate of energy change is the sum of the modal energy changes over all wavenumbers $k$:\n$$\n\\frac{dE_d}{dt} = \\sum_{k} C_k \\frac{d}{dt}\\left(\\frac{|\\hat{u}(k)|^{2}}{2}\\right) \\approx - \\sum_{k} C_k \\nu_{\\text{num}}(k)\\,k^{2}\\,|\\hat{u}(k)|^{2}\n$$\nwhere $C_k$ is a constant related to the Fourier transform normalization.\nSince we have shown that $\\frac{dE_d^{\\text{skew}}}{dt} = 0$, it follows that:\n$$\n\\sum_{k} C_k \\nu_{\\text{num}}^{\\text{skew}}(k)\\,k^{2}\\,|\\hat{u}(k)|^{2} = 0\n$$\nFor a physically meaningful viscosity, we must have $\\nu_{\\text{num}}(k) \\ge 0$. As $k^2 \\ge 0$, $|\\hat{u}(k)|^2 \\ge 0$, and $C_k  0$, the sum can only be zero if each term is zero. This implies that for any mode with non-zero energy ($|\\hat{u}(k)| \\ne 0$), we must have $\\nu_{\\text{num}}^{\\text{skew}}(k) = 0$.\n\nFor the conservative formulation (Scheme 1), the problem explicitly states to assume conditions that lead to a non-zero energy transfer. This implies that $\\nu_{\\text{num}}^{\\text{cons}}(k)$ is not identically zero for all $k$. Indeed, a similar energy budget analysis for Scheme 1 shows that its energy change is related to the aliasing error and is generally non-zero.\n\nGiven these findings, we can compute the required ratio:\n$$\nR(k) = \\frac{\\nu_{\\text{num}}^{\\text{skew}}(k)}{\\nu_{\\text{num}}^{\\text{cons}}(k)} = \\frac{0}{\\nu_{\\text{num}}^{\\text{cons}}(k)}\n$$\nFor any wavenumber $k$ where the numerical dissipation of the conservative scheme is non-zero (as assumed), the ratio is well-defined.\n\nTherefore, the ratio $R(k)$ is $0$.\n\nThe information provided about modified equation analysis via Taylor series expansion is a potential distraction. While that analysis reveals the leading-order truncation error, which is dispersive in nature for both schemes, it does not fully capture the schemes' properties with respect to the conserved discrete energy norm. The exact algebraic conservation property of the skew-symmetric scheme is the decisive factor in determining its effective numerical dissipation, which is identically zero.",
            "answer": "$$\n\\boxed{0}\n$$"
        }
    ]
}