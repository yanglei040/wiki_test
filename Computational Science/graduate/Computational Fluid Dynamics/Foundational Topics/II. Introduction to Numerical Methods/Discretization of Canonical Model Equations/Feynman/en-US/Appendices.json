{
    "hands_on_practices": [
        {
            "introduction": "At the heart of discretizing partial differential equations lies the task of accurately approximating derivatives on a discrete grid. This first practice focuses on the foundational technique of using Taylor series expansions to systematically construct a high-order finite difference operator for the second derivative, $u_{xx}$. By deriving a fourth-order accurate, $O(h^4)$, stencil, you will gain hands-on experience with the principles of consistency and order of accuracy that are critical for developing reliable numerical schemes. ",
            "id": "3310241",
            "problem": "In computational fluid dynamics (CFD), high-order spatial discretizations of diffusive operators are used to control numerical dispersion and dissipation without excessive grid refinement. Consider a smooth scalar field $u(x)$ sampled on a uniform one-dimensional grid with points $x_i = x_0 + i h$, where $h > 0$ is the constant grid spacing and $i \\in \\mathbb{Z}$ indexes interior points. Starting only from Taylor series expansions about the point $x_i$ and the definition of consistency for a discrete approximation to the second derivative, construct a symmetric five-point stencil that approximates $u_{xx}(x_i)$ with fourth-order accuracy. Determine the weights of the stencil in terms of $h$ by enforcing that the discrete operator matches the continuous second derivative and eliminates the lower-order error terms required to achieve fourth-order accuracy. Then, compute the leading truncation error term of this approximation and express it explicitly in terms of $h$ and the sixth derivative $u^{(6)}(x_i)$.\n\nProvide your final result as two closed-form analytic expressions: first, the five-point stencil formula for the approximation to $u_{xx}(x_i)$ normalized by $h^2$, written in terms of the nodal values $u_{i-2}$, $u_{i-1}$, $u_i$, $u_{i+1}$, and $u_{i+2}$; second, the leading truncation error term written as a multiple of $h^4 u^{(6)}(x_i)$. No numerical rounding is required.",
            "solution": "The user wants to derive a fourth-order accurate, symmetric, five-point finite difference stencil for the second derivative $u_{xx}(x_i)$ and determine its leading truncation error term. The derivation must be based on Taylor series expansions.\n\nLet the approximation of the second derivative $u_{xx}(x_i) = u_i''$ be denoted by $\\delta_{xx} u_i$. For a symmetric five-point stencil centered at $x_i$, the general form of the approximation is given by:\n$$ \\delta_{xx} u_i = c_{-2} u_{i-2} + c_{-1} u_{i-1} + c_0 u_i + c_1 u_{i+1} + c_2 u_{i+2} $$\nwhere $u_{i+j} = u(x_i + j h)$. For a symmetric stencil, the weights must satisfy $c_{-j} = c_j$. Therefore, we have $c_{-1}=c_1$ and $c_{-2}=c_2$. Let's rename the independent coefficients as $A = c_2$, $B = c_1$, and $C = c_0$. The stencil becomes:\n$$ \\delta_{xx} u_i = A u_{i-2} + B u_{i-1} + C u_i + B u_{i+1} + A u_{i+2} $$\n\nTo determine the coefficients $A$, $B$, and $C$, we expand each term $u_{i+j}$ in a Taylor series around the point $x_i$. We denote $u^{(k)}(x_i)$ as $u_i^{(k)}$.\n$$ u_{i+1} = u(x_i+h) = u_i + h u_i^{(1)} + \\frac{h^2}{2!} u_i^{(2)} + \\frac{h^3}{3!} u_i^{(3)} + \\frac{h^4}{4!} u_i^{(4)} + \\frac{h^5}{5!} u_i^{(5)} + \\frac{h^6}{6!} u_i^{(6)} + O(h^7) $$\n$$ u_{i-1} = u(x_i-h) = u_i - h u_i^{(1)} + \\frac{h^2}{2!} u_i^{(2)} - \\frac{h^3}{3!} u_i^{(3)} + \\frac{h^4}{4!} u_i^{(4)} - \\frac{h^5}{5!} u_i^{(5)} + \\frac{h^6}{6!} u_i^{(6)} + O(h^7) $$\n$$ u_{i+2} = u(x_i+2h) = u_i + (2h) u_i^{(1)} + \\frac{(2h)^2}{2!} u_i^{(2)} + \\frac{(2h)^3}{3!} u_i^{(3)} + \\frac{(2h)^4}{4!} u_i^{(4)} + \\frac{(2h)^5}{5!} u_i^{(5)} + \\frac{(2h)^6}{6!} u_i^{(6)} + O(h^7) $$\n$$ u_{i-2} = u(x_i-2h) = u_i - (2h) u_i^{(1)} + \\frac{(2h)^2}{2!} u_i^{(2)} - \\frac{(2h)^3}{3!} u_i^{(3)} + \\frac{(2h)^4}{4!} u_i^{(4)} - \\frac{(2h)^5}{5!} u_i^{(5)} + \\frac{(2h)^6}{6!} u_i^{(6)} + O(h^7) $$\n\nSubstitute these expansions into the stencil formula:\n$$ \\delta_{xx} u_i = A(u_{i-2} + u_{i+2}) + B(u_{i-1} + u_{i+1}) + C u_i $$\nBy summing the Taylor series in pairs, the odd-order derivative terms cancel out due to symmetry:\n$$ u_{i+1} + u_{i-1} = 2u_i + h^2 u_i^{(2)} + \\frac{h^4}{12} u_i^{(4)} + \\frac{h^6}{360} u_i^{(6)} + O(h^8) $$\n$$ u_{i+2} + u_{i-2} = 2u_i + 4h^2 u_i^{(2)} + \\frac{16h^4}{12} u_i^{(4)} + \\frac{64h^6}{360} u_i^{(6)} + O(h^8) = 2u_i + 4h^2 u_i^{(2)} + \\frac{4h^4}{3} u_i^{(4)} + \\frac{8h^6}{45} u_i^{(6)} + O(h^8) $$\nSubstituting these sums into the expression for $\\delta_{xx} u_i$:\n$$ \\delta_{xx} u_i = A \\left( 2u_i + 4h^2 u_i^{(2)} + \\frac{4h^4}{3} u_i^{(4)} + \\dots \\right) + B \\left( 2u_i + h^2 u_i^{(2)} + \\frac{h^4}{12} u_i^{(4)} + \\dots \\right) + C u_i $$\nCollect terms by the order of the derivative of $u_i$:\n$$ \\delta_{xx} u_i = (2A+2B+C) u_i + (4A+B)h^2 u_i^{(2)} + \\left(\\frac{4A}{3} + \\frac{B}{12}\\right)h^4 u_i^{(4)} + O(h^6) $$\n\nFor this operator to be a consistent, fourth-order approximation of $u_i^{(2)}$, we must match the coefficients of the derivatives in the expansion to those of the target operator, $u_i^{(2)}$.\n1.  The coefficient of $u_i$ must be zero: $2A+2B+C = 0$.\n2.  The coefficient of $u_i^{(2)}$ must be one: $(4A+B)h^2 = 1 \\implies 4A+B = \\frac{1}{h^2}$.\n3.  To achieve fourth-order accuracy, the $O(h^2)$ error term must be eliminated. The coefficient of the leading error term, which involves $u_i^{(4)}$, must be zero: $(\\frac{4A}{3} + \\frac{B}{12})h^4 = 0 \\implies \\frac{4A}{3} + \\frac{B}{12} = 0$.\n\nWe solve this system of three linear equations for $A$, $B$, and $C$.\nFrom equation (3):\n$$ \\frac{B}{12} = -\\frac{4A}{3} \\implies B = -16A $$\nSubstitute this into equation (2):\n$$ 4A + (-16A) = \\frac{1}{h^2} \\implies -12A = \\frac{1}{h^2} \\implies A = -\\frac{1}{12h^2} $$\nNow we find $B$:\n$$ B = -16A = -16\\left(-\\frac{1}{12h^2}\\right) = \\frac{16}{12h^2} = \\frac{4}{3h^2} $$\nFinally, from equation (1), we find $C$:\n$$ C = -2A - 2B = -2\\left(-\\frac{1}{12h^2}\\right) - 2\\left(\\frac{4}{3h^2}\\right) = \\frac{1}{6h^2} - \\frac{8}{3h^2} = \\frac{1-16}{6h^2} = -\\frac{15}{6h^2} = -\\frac{5}{2h^2} $$\nThe coefficients are $c_{-2}=c_2=A=-\\frac{1}{12h^2}$, $c_{-1}=c_1=B=\\frac{16}{12h^2}$, and $c_0=C=-\\frac{30}{12h^2}$.\nSubstituting these coefficients into the stencil formula yields the approximation for $u_{xx}(x_i)$:\n$$ u_{xx}(x_i) \\approx \\frac{1}{12h^2} (-u_{i-2} + 16u_{i-1} - 30u_i + 16u_{i+1} - u_{i+2}) $$\nThis is the desired fourth-order stencil formula.\n\nNext, we compute the leading truncation error term. The truncation error $T$ is defined as $T = \\delta_{xx}u_i - u_{xx}(x_i)$. The leading term of $T$ is the first non-zero term in the Taylor expansion of this difference. Since we eliminated the $u_i^{(4)}$ term, the next term is proportional to $u_i^{(6)}$.\nThe full expansion of $\\delta_{xx} u_i$ is:\n$$ \\delta_{xx} u_i = (2A+2B+C) u_i + (4A+B)h^2 u_i^{(2)} + \\left(\\frac{4A}{3} + \\frac{B}{12}\\right)h^4 u_i^{(4)} + \\left(\\frac{8A}{45} + \\frac{B}{360}\\right)h^6 u_i^{(6)} + O(h^8) $$\nBy construction, this simplifies to:\n$$ \\delta_{xx} u_i = u_i^{(2)} + \\left(\\frac{8A}{45} + \\frac{B}{360}\\right)h^6 u_i^{(6)} + O(h^8) $$\nThe leading truncation error term is therefore:\n$$ T_{\\text{lead}} = \\left(\\frac{8A}{45} + \\frac{B}{360}\\right)h^6 u_i^{(6)} $$\nSubstitute the values for $A$ and $B$:\n$A = -\\frac{1}{12h^2}$ and $B = \\frac{16}{12h^2}$.\n$$ T_{\\text{lead}} = \\left(\\frac{8}{45}\\left(-\\frac{1}{12h^2}\\right) + \\frac{1}{360}\\left(\\frac{16}{12h^2}\\right)\\right)h^6 u_i^{(6)} $$\n$$ T_{\\text{lead}} = \\left(-\\frac{8}{540h^2} + \\frac{16}{4320h^2}\\right)h^6 u_i^{(6)} $$\nLet's use a common denominator of $4320$:\n$$ T_{\\text{lead}} = \\left(-\\frac{8 \\times 8}{4320h^2} + \\frac{16}{4320h^2}\\right)h^6 u_i^{(6)} = \\left(\\frac{-64+16}{4320h^2}\\right)h^6 u_i^{(6)} $$\n$$ T_{\\text{lead}} = \\left(\\frac{-48}{4320h^2}\\right)h^6 u_i^{(6)} = -\\frac{48}{4320} h^4 u_i^{(6)} $$\nSimplify the fraction:\n$$ -\\frac{48}{4320} = -\\frac{48}{48 \\times 90} = -\\frac{1}{90} $$\nSo, the leading truncation error term is:\n$$ T_{\\text{lead}} = -\\frac{1}{90}h^4 u_i^{(6)} $$\nThis confirms that the stencil is indeed fourth-order accurate, as the error is proportional to $h^4$.\n\nThe two requested results are the stencil formula and the leading truncation error term.\n1. Stencil formula: $\\delta_{xx} u_i = \\frac{-u_{i-2} + 16u_{i-1} - 30u_i + 16u_{i+1} - u_{i+2}}{12h^2}$\n2. Leading truncation error term: $-\\frac{1}{90}h^4 u^{(6)}(x_i)$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{-u_{i-2} + 16u_{i-1} - 30u_i + 16u_{i+1} - u_{i+2}}{12h^2} & -\\frac{1}{90}h^4 u^{(6)}(x_i)\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Once we can approximate individual derivatives, the next step is to combine them to solve a full partial differential equation, such as the wave equation. This process introduces new types of error, like numerical dispersion, where waves of different wavelengths travel at incorrect speeds in the simulation. This exercise challenges you to use Fourier analysis to compare the phase accuracy of two different second-order schemes, revealing how the choice of discretization directly impacts the physical fidelity of wave propagation phenomena. ",
            "id": "3310226",
            "problem": "Consider the one-dimensional linear wave equation $u_{tt} = c^{2} u_{xx}$ on a uniform spatial grid with spacing $\\Delta x$ and time step $\\Delta t$, and define the Courant number $\\nu = c \\Delta t / \\Delta x$. Analyze phase dispersion for a single Fourier mode with wavenumber $k$ and nondimensional wavenumber $\\kappa = k \\Delta x$ under the following two explicit, second-order accurate discretizations.\n\nScheme A (standard centered-in-time and centered-in-space discretization of the second-order equation): for grid index $j \\in \\mathbb{Z}$ and time level $n \\in \\mathbb{Z}$,\n$$\nu_{j}^{n+1} - 2 u_{j}^{n} + u_{j}^{n-1} = \\nu^{2} \\left(u_{j+1}^{n} - 2 u_{j}^{n} + u_{j-1}^{n}\\right).\n$$\n\nScheme B (characteristic-based evolution of traveling components by Lax–Wendroff for one-way advection): decompose the solution into right- and left-traveling components, each satisfying a one-way wave equation of the form $w_{t} \\pm c w_{x} = 0$. Discretize each one-way equation by the Lax–Wendroff method,\n$$\nw_{j}^{n+1} = w_{j}^{n} \\mp \\frac{\\nu}{2} \\left(w_{j+1}^{n} - w_{j-1}^{n}\\right) + \\frac{\\nu^{2}}{2} \\left(w_{j+1}^{n} - 2 w_{j}^{n} + w_{j-1}^{n}\\right),\n$$\nand interpret the phase dispersion for a single right-traveling Fourier mode of the full wave equation by the dispersion of the corresponding one-way component.\n\nFor each scheme, perform a discrete Fourier (von Neumann) analysis on a single Fourier mode $u_{j}^{n} = \\exp\\!\\left(i \\left(j \\kappa - n \\theta\\right)\\right)$ to obtain the numerical phase $\\theta(\\kappa,\\nu)$ per time step. Define the numerical phase speed $c_{\\text{num}} = (\\theta/\\Delta t) / k = (c/\\nu)\\, \\theta/\\kappa$, and consider the small-wavenumber expansion\n$$\n\\frac{c_{\\text{num}}}{c} = 1 + \\alpha(\\nu)\\, \\kappa^{2} + \\mathcal{O}(\\kappa^{4}).\n$$\nLet $\\alpha_{A}(\\nu)$ and $\\alpha_{B}(\\nu)$ denote the coefficients for Scheme A and Scheme B, respectively.\n\nDerive $\\alpha_{A}(\\nu)$ and $\\alpha_{B}(\\nu)$ from first principles and report the analytic expression for the difference\n$$\n\\Delta \\alpha(\\nu) = \\alpha_{B}(\\nu) - \\alpha_{A}(\\nu).\n$$\nYour final answer must be a single closed-form expression in terms of $\\nu$ only. No numerical rounding is required, and no physical units are to be included in the final expression.",
            "solution": "The problem requires the derivation of the leading-order phase dispersion error coefficients, $\\alpha_A(\\nu)$ and $\\alpha_B(\\nu)$, for two numerical schemes for the one-dimensional wave equation, and to compute their difference $\\Delta \\alpha(\\nu) = \\alpha_{B}(\\nu) - \\alpha_{A}(\\nu)$.\n\nThe analysis is performed on a single Fourier mode of the form $u_{j}^{n} = \\exp(i (j \\kappa - n \\theta))$, where $\\kappa = k \\Delta x$ is the nondimensional wavenumber and $\\theta$ is the numerical phase shift per time step. The amplification factor is $G = u_j^{n+1}/u_j^n = \\exp(-i\\theta)$. The ratio of the numerical phase speed $c_{\\text{num}}$ to the true phase speed $c$ is given by\n$$\n\\frac{c_{\\text{num}}}{c} = \\frac{\\theta / (k \\Delta t)}{c} = \\frac{\\theta}{(k \\Delta x)(c \\Delta t / \\Delta x)} = \\frac{\\theta}{\\kappa \\nu}\n$$\nThe leading-order dispersion error coefficient $\\alpha(\\nu)$ is defined by the small-$\\kappa$ expansion\n$$\n\\frac{c_{\\text{num}}}{c} = 1 + \\alpha(\\nu) \\kappa^2 + \\mathcal{O}(\\kappa^4)\n$$\n\nFirst, we analyze Scheme A:\n$$\nu_{j}^{n+1} - 2 u_{j}^{n} + u_{j}^{n-1} = \\nu^{2} \\left(u_{j+1}^{n} - 2 u_{j}^{n} + u_{j-1}^{n}\\right)\n$$\nSubstituting the Fourier mode $u_j^n = G^n \\exp(ij\\kappa)$ into the scheme yields:\n$$\n(G - 2 + G^{-1}) G^n \\exp(ij\\kappa) = \\nu^2 (\\exp(i\\kappa) - 2 + \\exp(-i\\kappa)) G^n \\exp(ij\\kappa)\n$$\nDividing by the common factor $G^n \\exp(ij\\kappa)$ and using Euler's identity $\\exp(i\\phi) + \\exp(-i\\phi) = 2\\cos(\\phi)$, we get:\n$$\n2\\cos(\\theta) - 2 = \\nu^2(2\\cos(\\kappa) - 2)\n$$\nUsing the half-angle identity $1-\\cos(\\phi) = 2\\sin^2(\\phi/2)$:\n$$\n-4\\sin^2(\\frac{\\theta}{2}) = -2\\nu^2(1-\\cos(\\kappa)) = -4\\nu^2\\sin^2(\\frac{\\kappa}{2})\n$$\nThis gives the numerical dispersion relation for Scheme A:\n$$\n\\sin\\left(\\frac{\\theta}{2}\\right) = \\nu \\sin\\left(\\frac{\\kappa}{2}\\right)\n$$\nwhere we select the positive root corresponding to the forward-propagating wave. From this, we have $\\theta = 2\\arcsin(\\nu\\sin(\\kappa/2))$. To find $\\alpha_A(\\nu)$, we expand $\\theta$ for small $\\kappa$:\n$$\n\\sin\\left(\\frac{\\kappa}{2}\\right) = \\frac{\\kappa}{2} - \\frac{1}{3!}\\left(\\frac{\\kappa}{2}\\right)^3 + \\mathcal{O}(\\kappa^5) = \\frac{\\kappa}{2} - \\frac{\\kappa^3}{48} + \\mathcal{O}(\\kappa^5)\n$$\nLet $X = \\nu\\sin(\\kappa/2) = \\frac{\\nu\\kappa}{2} - \\frac{\\nu\\kappa^3}{48} + \\mathcal{O}(\\kappa^5)$. Using $\\arcsin(X) = X + \\frac{X^3}{6} + \\mathcal{O}(X^5)$:\n$$\n\\frac{\\theta}{2} = \\arcsin\\left(\\nu\\sin\\left(\\frac{\\kappa}{2}\\right)\\right) = \\left(\\frac{\\nu\\kappa}{2} - \\frac{\\nu\\kappa^3}{48}\\right) + \\frac{1}{6}\\left(\\frac{\\nu\\kappa}{2}\\right)^3 + \\mathcal{O}(\\kappa^5)\n$$\n$$\n\\frac{\\theta}{2} = \\frac{\\nu\\kappa}{2} - \\frac{\\nu\\kappa^3}{48} + \\frac{\\nu^3\\kappa^3}{48} + \\mathcal{O}(\\kappa^5) = \\frac{\\nu\\kappa}{2} + \\frac{\\nu^3-\\nu}{48}\\kappa^3 + \\mathcal{O}(\\kappa^5)\n$$\n$$\n\\theta = \\nu\\kappa + \\frac{\\nu^3-\\nu}{24}\\kappa^3 + \\mathcal{O}(\\kappa^5)\n$$\nNow, we find the phase speed ratio:\n$$\n\\frac{c_{\\text{num}}}{c} = \\frac{\\theta}{\\nu\\kappa} = \\frac{1}{\\nu\\kappa}\\left(\\nu\\kappa + \\frac{\\nu(\\nu^2-1)}{24}\\kappa^3 + \\mathcal{O}(\\kappa^5)\\right) = 1 + \\frac{\\nu^2-1}{24}\\kappa^2 + \\mathcal{O}(\\kappa^4)\n$$\nBy comparing with the definition, we identify the coefficient for Scheme A:\n$$\n\\alpha_A(\\nu) = \\frac{\\nu^2-1}{24}\n$$\n\nNext, we analyze Scheme B for a right-traveling wave, which satisfies $w_t+cw_x=0$. The problem states this corresponds to the Lax-Wendroff discretization:\n$$\nw_{j}^{n+1} = w_{j}^{n} - \\frac{\\nu}{2} \\left(w_{j+1}^{n} - w_{j-1}^{n}\\right) + \\frac{\\nu^{2}}{2} \\left(w_{j+1}^{n} - 2 w_{j}^{n} + w_{j-1}^{n}\\right)\n$$\nSubstituting the Fourier mode $w_j^n = G^n \\exp(ij\\kappa)$ gives the amplification factor $G$:\n$$\nG = 1 - \\frac{\\nu}{2}(\\exp(i\\kappa) - \\exp(-i\\kappa)) + \\frac{\\nu^2}{2}(\\exp(i\\kappa) - 2 + \\exp(-i\\kappa))\n$$\n$$\nG = 1 - i\\nu\\sin(\\kappa) + \\nu^2(\\cos(\\kappa)-1) = 1 - i\\nu\\sin(\\kappa) - 2\\nu^2\\sin^2\\left(\\frac{\\kappa}{2}\\right)\n$$\nThe numerical phase is $\\theta = -\\arg(G)$.\n$$\n\\theta = -\\arctan\\left(\\frac{\\text{Im}(G)}{\\text{Re}(G)}\\right) = -\\arctan\\left(\\frac{-\\nu\\sin(\\kappa)}{1-2\\nu^2\\sin^2(\\kappa/2)}\\right) = \\arctan\\left(\\frac{\\nu\\sin(\\kappa)}{1-2\\nu^2\\sin^2(\\kappa/2)}\\right)\n$$\nTo find $\\alpha_B(\\nu)$, we expand $\\theta$ for small $\\kappa$. Let $Y$ be the argument of the arctangent function.\nNumerator: $\\nu\\sin(\\kappa) = \\nu\\left(\\kappa - \\frac{\\kappa^3}{6} + \\mathcal{O}(\\kappa^5)\\right)$.\nDenominator: $1 - 2\\nu^2\\sin^2(\\kappa/2) = 1 - 2\\nu^2\\left(\\frac{\\kappa}{2} - \\frac{\\kappa^3}{48} + \\dots\\right)^2 = 1 - 2\\nu^2\\left(\\frac{\\kappa^2}{4} - \\frac{\\kappa^4}{48} + \\dots\\right) = 1 - \\frac{\\nu^2\\kappa^2}{2} + \\frac{\\nu^2\\kappa^4}{24} + \\dots$.\nPerforming the division:\n$$\nY = \\frac{\\nu\\kappa - \\frac{\\nu}{6}\\kappa^3 + \\dots}{1 - \\frac{\\nu^2}{2}\\kappa^2 + \\dots} = \\left(\\nu\\kappa - \\frac{\\nu}{6}\\kappa^3 + \\dots\\right)\\left(1 + \\frac{\\nu^2}{2}\\kappa^2 + \\dots\\right) = \\nu\\kappa + \\frac{\\nu^3}{2}\\kappa^3 - \\frac{\\nu}{6}\\kappa^3 + \\mathcal{O}(\\kappa^5) = \\nu\\kappa + \\frac{3\\nu^3-\\nu}{6}\\kappa^3 + \\mathcal{O}(\\kappa^5)\n$$\nNow, expand $\\theta = \\arctan(Y) = Y - \\frac{Y^3}{3} + \\mathcal{O}(Y^5)$:\n$$\n\\theta = \\left(\\nu\\kappa + \\frac{3\\nu^3-\\nu}{6}\\kappa^3\\right) - \\frac{1}{3}(\\nu\\kappa)^3 + \\mathcal{O}(\\kappa^5) = \\nu\\kappa + \\left(\\frac{3\\nu^3-\\nu}{6} - \\frac{\\nu^3}{3}\\right)\\kappa^3 + \\mathcal{O}(\\kappa^5)\n$$\n$$\n\\theta = \\nu\\kappa + \\frac{3\\nu^3 - \\nu - 2\\nu^3}{6}\\kappa^3 + \\mathcal{O}(\\kappa^5) = \\nu\\kappa + \\frac{\\nu^3-\\nu}{6}\\kappa^3 + \\mathcal{O}(\\kappa^5)\n$$\nThe phase speed ratio is:\n$$\n\\frac{c_{\\text{num}}}{c} = \\frac{\\theta}{\\nu\\kappa} = \\frac{1}{\\nu\\kappa}\\left(\\nu\\kappa + \\frac{\\nu(\\nu^2-1)}{6}\\kappa^3 + \\mathcal{O}(\\kappa^5)\\right) = 1 + \\frac{\\nu^2-1}{6}\\kappa^2 + \\mathcal{O}(\\kappa^4)\n$$\nThus, the coefficient for Scheme B is:\n$$\n\\alpha_B(\\nu) = \\frac{\\nu^2-1}{6}\n$$\nFinally, we compute the difference $\\Delta\\alpha(\\nu) = \\alpha_B(\\nu) - \\alpha_A(\\nu)$:\n$$\n\\Delta\\alpha(\\nu) = \\frac{\\nu^2-1}{6} - \\frac{\\nu^2-1}{24} = (\\nu^2-1)\\left(\\frac{1}{6} - \\frac{1}{24}\\right) = (\\nu^2-1)\\left(\\frac{4-1}{24}\\right) = (\\nu^2-1)\\left(\\frac{3}{24}\\right)\n$$\n$$\n\\Delta\\alpha(\\nu) = \\frac{\\nu^2-1}{8}\n$$",
            "answer": "$$\\boxed{\\frac{\\nu^2 - 1}{8}}$$"
        },
        {
            "introduction": "A robust numerical method must perform well not just in the interior of a computational domain, but also at its boundaries, a major practical consideration. The high-order centered stencils effective in the interior are unusable near domain edges, requiring special one-sided closures that can degrade the overall solution accuracy if not designed carefully. In this final practice, you will tackle this challenge by constructing a fourth-order accurate one-sided stencil, learning how to maintain global accuracy and prevent boundary errors from polluting the solution. ",
            "id": "3310275",
            "problem": "Consider the one-dimensional heat equation $u_{t} = \\nu u_{xx}$ on the interval $[0,1]$ with a uniform grid $x_{i} = i \\Delta x$ for $i=0,1,\\dots,N$ and $\\Delta x = 1/N$. Suppose the interior second derivative $u_{xx}$ is discretized using a centered finite difference formula of order $p=4$ on the set $\\{x_{i-2},x_{i-1},x_{i},x_{i+1},x_{i+2}\\}$ for $i=2,\\dots,N-2$; near the boundary $x=0$, the centered stencil is unavailable and must be replaced by a one-sided closure.\n\nStarting from Taylor series and the definition of truncation error, construct a one-sided finite difference closure at $x=0$ for $u_{xx}(0)$ using the grid points $\\{x_{0},x_{1},x_{2},x_{3},x_{4},x_{5}\\}$ of the form\n$$\n\\left(D_{xx} u\\right)\\big|_{x=0} \\;=\\; \\frac{1}{\\Delta x^{2}}\\sum_{j=0}^{5} c_{j}\\,u(x_{j}),\n$$\nwhere the coefficients $c_{j}$ are chosen to attain local order $p=4$ accuracy at the boundary. Specifically:\n\n1. Use Taylor expansions of $u(x_{j})$ about $x=0$ to derive the moment conditions on the coefficients $c_{j}$ that are necessary and sufficient for the local boundary truncation error to be $O(\\Delta x^{4})$.\n\n2. Solve for the unique set of coefficients $\\{c_{j}\\}_{j=0}^{5}$ that satisfy these moment conditions.\n\n3. Compute the leading term of the boundary truncation error at $x=0$ by expressing it in the form\n$$\n\\mathrm{TE}_{\\mathrm{bnd}}(0) \\;=\\; C_{\\mathrm{bnd}}\\,\\Delta x^{4}\\,u^{(6)}(0) \\;+\\; O(\\Delta x^{5}),\n$$\nand determine the exact constant $C_{\\mathrm{bnd}}$.\n\n4. Explain briefly why this one-sided closure, together with the fourth-order centered interior scheme, maintains a global accuracy of $O(\\Delta x^{4})$ for smooth $u(x)$.\n\nYour final answer must be the exact analytic expression for the leading-term boundary truncation error obtained in step 3. No rounding is required and no units are to be reported in the final answer box.",
            "solution": "The problem requires the construction and analysis of a one-sided finite difference closure for the second derivative $u_{xx}$ at the boundary $x=0$. The closure must be of local order $p=4$ and uses the stencil $\\{x_0, x_1, x_2, x_3, x_4, x_5\\}$.\n\n**1. Derivation of Moment Conditions**\n\nWe seek coefficients $c_j$ for $j=0, \\dots, 5$ such that the operator\n$$\n\\left(D_{xx} u\\right)\\big|_{x=0} \\;=\\; \\frac{1}{\\Delta x^{2}}\\sum_{j=0}^{5} c_{j}\\,u(x_{j})\n$$\napproximates $u_{xx}(0)$ with a local truncation error of order $O(\\Delta x^4)$. The grid points are given by $x_j = j \\Delta x$.\n\nThe local truncation error, $\\mathrm{TE}_{\\mathrm{bnd}}(0)$, is defined as the difference between the discrete operator and the continuous derivative it approximates, applied to a sufficiently smooth function $u(x)$:\n$$\n\\mathrm{TE}_{\\mathrm{bnd}}(0) = \\left(D_{xx} u\\right)\\big|_{x=0} - u_{xx}(0)\n$$\nTo determine the conditions on the coefficients $c_j$, we expand each term $u(x_j)$ in the formula as a Taylor series around the point $x=0$:\n$$\nu(x_j) = u(j \\Delta x) = \\sum_{k=0}^{\\infty} \\frac{u^{(k)}(0)}{k!} (j \\Delta x)^k\n$$\nwhere $u^{(k)}(0)$ denotes the $k$-th derivative of $u$ evaluated at $x=0$.\n\nSubstituting these expansions into the discrete operator gives:\n$$\n\\left(D_{xx} u\\right)\\big|_{x=0} = \\frac{1}{\\Delta x^2} \\sum_{j=0}^{5} c_j \\left( \\sum_{k=0}^{\\infty} \\frac{u^{(k)}(0)}{k!} (j \\Delta x)^k \\right)\n$$\nBy rearranging the order of summation, we can group terms by derivatives of $u$:\n$$\n\\left(D_{xx} u\\right)\\big|_{x=0} = \\sum_{k=0}^{\\infty} \\frac{u^{(k)}(0)}{k!} \\Delta x^{k-2} \\left( \\sum_{j=0}^{5} c_j j^k \\right)\n$$\nExpanding this sum for the first few values of $k$ yields:\n$$\n\\left(D_{xx} u\\right)\\big|_{x=0} = \\frac{u^{(0)}(0)}{0!} \\Delta x^{-2} \\sum_j c_j j^0 + \\frac{u^{(1)}(0)}{1!} \\Delta x^{-1} \\sum_j c_j j^1 + \\frac{u^{(2)}(0)}{2!} \\Delta x^{0} \\sum_j c_j j^2 + \\frac{u^{(3)}(0)}{3!} \\Delta x^{1} \\sum_j c_j j^3 + \\dots\n$$\nFor this expression to approximate $u_{xx}(0) \\equiv u^{(2)}(0)$ with an error of $O(\\Delta x^4)$, the coefficients of the lower-order derivatives must match, and the coefficients of the higher-order error terms must vanish up to the desired order. Specifically:\n\\begin{itemize}\n    \\item The coefficient of $u^{(0)}(0)$ must be $0$: $\\frac{1}{\\Delta x^2} \\sum_{j=0}^5 c_j j^0 = 0 \\implies \\sum_{j=0}^5 c_j = 0$.\n    \\item The coefficient of $u^{(1)}(0)$ must be $0$: $\\frac{1}{\\Delta x} \\sum_{j=0}^5 c_j j^1 = 0 \\implies \\sum_{j=0}^5 c_j j^1 = 0$.\n    \\item The coefficient of $u^{(2)}(0)$ must be $1$: $\\frac{1}{2} \\sum_{j=0}^5 c_j j^2 = 1 \\implies \\sum_{j=0}^5 c_j j^2 = 2$.\n    \\item The coefficient of $u^{(3)}(0)$ must be $0$: $\\frac{\\Delta x}{6} \\sum_{j=0}^5 c_j j^3 = 0 \\implies \\sum_{j=0}^5 c_j j^3 = 0$.\n    \\item The coefficient of $u^{(4)}(0)$ must be $0$: $\\frac{\\Delta x^2}{24} \\sum_{j=0}^5 c_j j^4 = 0 \\implies \\sum_{j=0}^5 c_j j^4 = 0$.\n    \\item The coefficient of $u^{(5)}(0)$ must be $0$: $\\frac{\\Delta x^3}{120} \\sum_{j=0}^5 c_j j^5 = 0 \\implies \\sum_{j=0}^5 c_j j^5 = 0$.\n\\end{itemize}\nThese six equations form a linear system for the six unknown coefficients $c_0, \\dots, c_5$. They are the necessary and sufficient moment conditions for the local truncation error to be at least $O(\\Delta x^4)$.\n\n**2. Solving for the Coefficients**\n\nThe moment conditions form the following $6 \\times 6$ linear system, expressed in matrix form $A\\mathbf{c}=\\mathbf{b}$:\n$$\n\\begin{pmatrix}\n1 & 1 & 1 & 1 & 1 & 1 \\\\\n0 & 1 & 2 & 3 & 4 & 5 \\\\\n0 & 1 & 4 & 9 & 16 & 25 \\\\\n0 & 1 & 8 & 27 & 64 & 125 \\\\\n0 & 1 & 16 & 81 & 256 & 625 \\\\\n0 & 1 & 32 & 243 & 1024 & 3125\n\\end{pmatrix}\n\\begin{pmatrix} c_0 \\\\ c_1 \\\\ c_2 \\\\ c_3 \\\\ c_4 \\\\ c_5 \\end{pmatrix}\n=\n\\begin{pmatrix} 0 \\\\ 0 \\\\ 2 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\nThe matrix $A$ is a Vandermonde matrix, which is non-singular, guaranteeing a unique solution for the vector of coefficients $\\mathbf{c}$. Solving this system yields the following unique set of rational coefficients:\n$$\nc_0 = \\frac{15}{4}, \\quad c_1 = -\\frac{77}{6}, \\quad c_2 = \\frac{107}{6}, \\quad c_3 = -13, \\quad c_4 = \\frac{61}{12}, \\quad c_5 = -\\frac{5}{6}\n$$\n\n**3. Boundary Truncation Error**\n\nWith the coefficients determined, the truncation error is given by the first non-vanishing term in the Taylor series expansion. This term corresponds to $k=6$:\n$$\n\\mathrm{TE}_{\\mathrm{bnd}}(0) = \\frac{u^{(6)}(0)}{6!} \\Delta x^{6-2} \\left( \\sum_{j=0}^{5} c_j j^6 \\right) + O(\\Delta x^5)\n$$\nThe constant $C_{\\mathrm{bnd}}$ is therefore $C_{\\mathrm{bnd}} = \\frac{1}{6!} \\sum_{j=0}^{5} c_j j^6$. We compute the sum:\n$$\n\\sum_{j=0}^{5} c_j j^6 = c_0(0^6) + c_1(1^6) + c_2(2^6) + c_3(3^6) + c_4(4^6) + c_5(5^6)\n$$\n$$\n= 0 + \\left(-\\frac{77}{6}\\right)(1) + \\left(\\frac{107}{6}\\right)(64) + (-13)(729) + \\left(\\frac{61}{12}\\right)(4096) + \\left(-\\frac{5}{6}\\right)(15625)\n$$\n$$\n= -\\frac{77}{6} + \\frac{6848}{6} - 9477 + \\frac{249984}{12} - \\frac{78125}{6}\n$$\n$$\n= -\\frac{77}{6} + \\frac{6848}{6} - \\frac{56862}{6} + \\frac{41664}{6} - \\frac{78125}{6}\n$$\n$$\n= \\frac{-77 + 6848 - 56862 + 41664 - 78125}{6} = \\frac{48512 - 135064}{6} = \\frac{-86552}{6}\n$$\nThis calculation appears arithmetically incorrect. An alternative, more robust method relies on the error formula for polynomial interpolation. The error of the approximation is $u_{xx}(0) - P_5''(0)$, where $P_5(x)$ is the interpolating polynomial. This error is given by $\\frac{u^{(6)}(\\xi)}{6!} \\omega''(0)$, where $\\omega(x) = \\prod_{i=0}^5 (x-x_i)$. For small $\\Delta x$, $\\xi \\approx 0$.\nWith $\\Delta x=1$, $\\omega(x) = x(x-1)(x-2)(x-3)(x-4)(x-5)$.\nWe find the second derivative $\\omega''(x)$ and evaluate at $x=0$.\n$\\omega(x) = x^6 - 15x^5 + 85x^4 - 225x^3 + 274x^2 - 120x$.\n$\\omega'(x) = 6x^5 - 75x^4 + 340x^3 - 675x^2 + 548x - 120$.\n$\\omega''(x) = 30x^4 - 300x^3 + 1020x^2 - 1350x + 548$.\nSo, $\\omega''(0) = 548$.\nThe error is $\\mathrm{TE}_{\\mathrm{bnd}}(0) = - \\frac{u^{(6)}(0)}{6!} (\\omega''(0)) (\\Delta x)^4 = -\\frac{548}{720} \\Delta x^4 u^{(6)}(0) = -\\frac{137}{180} \\Delta x^4 u^{(6)}(0)$.\nThe constant is $C_{\\mathrm{bnd}} = -137/180$. The leading term of the boundary truncation error is:\n$$\n\\mathrm{TE}_{\\mathrm{bnd}}(0) = -\\frac{137}{180} \\Delta x^{4} u^{(6)}(0) + O(\\Delta x^5)\n$$\n\n**4. Global Accuracy**\n\nThe global accuracy of a numerical scheme for a time-dependent PDE is determined by the interplay between the local truncation errors of the interior scheme and the boundary closures, and the stability of the overall method. The interior scheme is given to be fourth-order accurate, i.e., its local truncation error is $O(\\Delta x^4)$. We have constructed a boundary closure that also has a local truncation error of $O(\\Delta x^4)$.\n\nAccording to the theory developed by Gustafsson, Kreiss, and Sundstrom (GKS theory), for a stable interior scheme of order $p$, if the boundary closures are also stable and have an order of accuracy $q \\ge p-1$, then the global solution will converge with order $p$.\nIn this problem, the interior scheme has order $p=4$. The constructed boundary closure has order $q=4$. Since $q=4 \\ge p-1=3$, the condition is satisfied. The errors introduced at the few boundary points do not accumulate in a way that degrades the overall accuracy of the scheme. Therefore, the combination of a fourth-order interior scheme and a fourth-order one-sided boundary closure results in a global accuracy of $O(\\Delta x^4)$ for a sufficiently smooth solution $u(x)$.",
            "answer": "$$ \\boxed{-\\frac{137}{180}\\Delta x^{4}u^{(6)}(0)} $$"
        }
    ]
}