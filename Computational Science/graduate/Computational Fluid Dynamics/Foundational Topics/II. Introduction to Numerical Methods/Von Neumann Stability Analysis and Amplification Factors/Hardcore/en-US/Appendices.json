{
    "hands_on_practices": [
        {
            "introduction": "We begin with a foundational application of von Neumann analysis to a multidimensional, parabolic system: the two-dimensional heat equation. This exercise is fundamental because it demonstrates how to derive the stability constraint for an explicit scheme in more than one dimension . By analyzing the amplification factor for the Forward-Time, Centered-Space (FTCS) discretization, you will derive the classic time-step restriction that is essential for ensuring stable simulations of diffusive processes.",
            "id": "3388993",
            "problem": "Consider the two-dimensional diffusion equation, a canonical model in Computational Fluid Dynamics (CFD), with possibly anisotropic constant diffusivities,\n$$\n\\frac{\\partial u}{\\partial t} \\;=\\; \\alpha_{x}\\,\\frac{\\partial^{2}u}{\\partial x^{2}} \\;+\\; \\alpha_{y}\\,\\frac{\\partial^{2}u}{\\partial y^{2}},\n$$\nwhere $u(x,y,t)$ is a scalar field and $\\alpha_{x} \\gt 0$, $\\alpha_{y} \\gt 0$. Discretize space on a uniform Cartesian grid with spacings $\\Delta x$ and $\\Delta y$, and index the grid by integers $j,k$ so that $x_{j} = j\\,\\Delta x$, $y_{k} = k\\,\\Delta y$. Advance in time using the forward Euler method with time step $\\Delta t$ and approximate the Laplacian by the standard five-point stencil. This yields the fully discrete explicit scheme\n$$\nU^{n+1}_{j,k} \\;=\\; U^{n}_{j,k} \\;+\\; \\Delta t \\left[ \\alpha_{x}\\,\\frac{U^{n}_{j+1,k} - 2\\,U^{n}_{j,k} + U^{n}_{j-1,k}}{(\\Delta x)^{2}} \\;+\\; \\alpha_{y}\\,\\frac{U^{n}_{j,k+1} - 2\\,U^{n}_{j,k} + U^{n}_{j,k-1}}{(\\Delta y)^{2}} \\right],\n$$\nfor integers $j,k$, where $U^{n}_{j,k}$ approximates $u(x_{j},y_{k},t^{n})$ at time level $t^{n} = n\\,\\Delta t$. Assume periodic boundary conditions so that discrete Fourier analysis applies.\n\nPerform a von Neumann stability analysis: substitute a single-mode discrete Fourier ansatz $U^{n}_{j,k} = \\hat{U}^{n} \\exp\\!\\big( \\mathrm{i}(j\\,\\theta_{x} + k\\,\\theta_{y}) \\big)$ with $(\\theta_{x},\\theta_{y}) \\in [-\\pi,\\pi] \\times [-\\pi,\\pi]$ to derive the amplification factor $G(\\theta_{x},\\theta_{y})$ for one time step of the scheme. Then, using the absolute stability condition for forward Euler applied to this diffusion operator, deduce the sharp upper bound on the time step $\\Delta t$ that guarantees $|G(\\theta_{x},\\theta_{y})| \\leq 1$ for all $(\\theta_{x},\\theta_{y})$.\n\nExpress your final answer as a single closed-form analytic expression for the maximal stable time step $\\Delta t_{\\max}$ in terms of $\\alpha_{x}$, $\\alpha_{y}$, $\\Delta x$, and $\\Delta y$. No rounding is required, and do not include any physical units in your final expression.",
            "solution": "The user wants me to perform a von Neumann stability analysis for the two-dimensional, anisotropic diffusion equation, discretized using a forward Euler scheme in time and a standard five-point stencil for the spatial derivatives.\n\n### Step 1: Extract Givens\n-   **Governing Partial Differential Equation (PDE)**:\n    $$\n    \\frac{\\partial u}{\\partial t} \\;=\\; \\alpha_{x}\\,\\frac{\\partial^{2}u}{\\partial x^{2}} \\;+\\; \\alpha_{y}\\,\\frac{\\partial^{2}u}{\\partial y^{2}}\n    $$\n-   **Physical Constants**: $\\alpha_{x} > 0$ and $\\alpha_{y} > 0$ are constant diffusivities.\n-   **Grid Discretization**: Uniform Cartesian grid with spacings $\\Delta x$ and $\\Delta y$. Grid points are indexed by $(j,k)$, where $x_{j} = j\\,\\Delta x$ and $y_{k} = k\\,\\Delta y$. Time is discretized as $t^n = n\\,\\Delta t$.\n-   **Finite Difference Scheme**:\n    $$\n    U^{n+1}_{j,k} \\;=\\; U^{n}_{j,k} \\;+\\; \\Delta t \\left[ \\alpha_{x}\\,\\frac{U^{n}_{j+1,k} - 2\\,U^{n}_{j,k} + U^{n}_{j-1,k}}{(\\Delta x)^{2}} \\;+\\; \\alpha_{y}\\,\\frac{U^{n}_{j,k+1} - 2\\,U^{n}_{j,k} + U^{n}_{j,k-1}}{(\\Delta y)^{2}} \\right]\n    $$\n-   **Boundary Conditions**: Periodic, allowing for Fourier analysis.\n-   **Analysis Tool**: Von Neumann stability analysis.\n-   **Fourier Ansatz**:\n    $$\n    U^{n}_{j,k} = \\hat{U}^{n} \\exp\\!\\big( \\mathrm{i}(j\\,\\theta_{x} + k\\,\\theta_{y}) \\big)\n    $$\n    with phase angles $(\\theta_{x},\\theta_{y}) \\in [-\\pi,\\pi] \\times [-\\pi,\\pi]$.\n-   **Objective**: Derive the amplification factor $G(\\theta_{x},\\theta_{y})$ and use it to find the sharp upper bound on the time step, $\\Delta t_{\\max}$, that ensures stability, i.e., $|G(\\theta_{x},\\theta_{y})| \\leq 1$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem presented is a standard, canonical exercise in the field of numerical analysis for partial differential equations, specifically within the context of computational fluid dynamics.\n-   **Scientifically Grounded**: The problem is based on the well-established diffusion equation and a standard numerical discretization (FTCS: Forward Time, Centered Space). The method of von Neumann stability analysis is a fundamental tool for analyzing the stability of finite difference schemes. The problem is free of any scientific inaccuracies or pseudoscience.\n-   **Well-Posed**: The problem is clearly stated, with all necessary components provided—the PDE, the discrete scheme, the analysis method, and a well-defined objective. It is self-contained and structured to lead to a unique, analytical solution.\n-   **Objective**: The problem is stated using precise mathematical language, devoid of any subjectivity or ambiguity.\n\nThe problem does not violate any of the invalidity criteria. It is not incomplete, contradictory, unrealistic, ill-posed, trivial, or unverifiable. It is a formal, solvable task in applied mathematics.\n\n### Step 3: Verdict and Action\nThe problem is valid. The solution process may proceed.\n\n### Solution Derivation\nThe objective is to determine the stability constraint on the time step $\\Delta t$ for the given numerical scheme. We employ the von Neumann stability analysis. The core of this method is to examine how the amplitude of a single Fourier mode evolves over one time step.\n\nFirst, we substitute the Fourier ansatz, $U^{n}_{j,k} = \\hat{U}^{n} \\exp(\\mathrm{i}(j\\theta_x + k\\theta_y))$, into the finite difference equation. The amplitude of the mode at time level $n$ is $\\hat{U}^n$, and at time level $n+1$ is $\\hat{U}^{n+1}$. The amplification factor is defined as $G(\\theta_x, \\theta_y) = \\frac{\\hat{U}^{n+1}}{\\hat{U}^n}$.\n\nFor the left-hand side of the scheme, we have:\n$$\nU^{n+1}_{j,k} = \\hat{U}^{n+1} \\exp(\\mathrm{i}(j\\theta_x + k\\theta_y)) = G \\hat{U}^{n} \\exp(\\mathrm{i}(j\\theta_x + k\\theta_y))\n$$\nFor the terms on the right-hand side, we note the following substitutions:\n$$\nU^{n}_{j,k} = \\hat{U}^{n} \\exp(\\mathrm{i}(j\\theta_x + k\\theta_y))\n$$\n$$\nU^{n}_{j \\pm 1, k} = \\hat{U}^{n} \\exp(\\mathrm{i}((j \\pm 1)\\theta_x + k\\theta_y)) = \\hat{U}^{n} \\exp(\\mathrm{i}(j\\theta_x + k\\theta_y)) \\exp(\\pm \\mathrm{i}\\theta_x)\n$$\n$$\nU^{n}_{j, k \\pm 1} = \\hat{U}^{n} \\exp(\\mathrm{i}(j\\theta_x + (k \\pm 1)\\theta_y)) = \\hat{U}^{n} \\exp(\\mathrm{i}(j\\theta_x + k\\theta_y)) \\exp(\\pm \\mathrm{i}\\theta_y)\n$$\nSubstituting these expressions into the numerical scheme:\n\\begin{align*}\nG \\hat{U}^{n} \\exp(\\mathrm{i}(j\\theta_x + k\\theta_y)) = & \\; \\hat{U}^{n} \\exp(\\mathrm{i}(j\\theta_x + k\\theta_y)) \\\\\n& + \\frac{\\alpha_x \\Delta t}{(\\Delta x)^2} \\left[ \\hat{U}^{n} e^{\\mathrm{i}(j\\theta_x+k\\theta_y)}(e^{\\mathrm{i}\\theta_x} - 2 + e^{-\\mathrm{i}\\theta_x}) \\right] \\\\\n& + \\frac{\\alpha_y \\Delta t}{(\\Delta y)^2} \\left[ \\hat{U}^{n} e^{\\mathrm{i}(j\\theta_x+k\\theta_y)}(e^{\\mathrm{i}\\theta_y} - 2 + e^{-\\mathrm{i}\\theta_y}) \\right]\n\\end{align*}\nWe can divide through by the common non-zero factor $\\hat{U}^{n} \\exp(\\mathrm{i}(j\\theta_x + k\\theta_y))$ to isolate the amplification factor $G$:\n$$\nG(\\theta_x, \\theta_y) = 1 + \\frac{\\alpha_x \\Delta t}{(\\Delta x)^2} (e^{\\mathrm{i}\\theta_x} - 2 + e^{-\\mathrm{i}\\theta_x}) + \\frac{\\alpha_y \\Delta t}{(\\Delta y)^2} (e^{\\mathrm{i}\\theta_y} - 2 + e^{-\\mathrm{i}\\theta_y})\n$$\nUsing Euler's identity, $e^{\\mathrm{i}\\phi} + e^{-\\mathrm{i}\\phi} = 2\\cos(\\phi)$, the terms in the parentheses simplify:\n$$\ne^{\\mathrm{i}\\phi} - 2 + e^{-\\mathrm{i}\\phi} = 2\\cos(\\phi) - 2 = -2(1 - \\cos(\\phi))\n$$\nApplying this to our expression for $G$:\n$$\nG(\\theta_x, \\theta_y) = 1 - 2 \\frac{\\alpha_x \\Delta t}{(\\Delta x)^2} (1 - \\cos(\\theta_x)) - 2 \\frac{\\alpha_y \\Delta t}{(\\Delta y)^2} (1 - \\cos(\\theta_y))\n$$\nTo further simplify, we use the trigonometric half-angle identity $1 - \\cos(\\phi) = 2\\sin^2(\\phi/2)$:\n$$\nG(\\theta_x, \\theta_y) = 1 - 4 \\frac{\\alpha_x \\Delta t}{(\\Delta x)^2} \\sin^2\\left(\\frac{\\theta_x}{2}\\right) - 4 \\frac{\\alpha_y \\Delta t}{(\\Delta y)^2} \\sin^2\\left(\\frac{\\theta_y}{2}\\right)\n$$\nThis is the amplification factor for the scheme. Note that $G$ is a real-valued function because all parameters $\\alpha_x, \\alpha_y, \\Delta t, \\Delta x, \\Delta y$ are real, and $\\sin^2(\\cdot)$ is real.\n\nFor numerical stability, the magnitude of the amplification factor must not exceed unity for any possible mode, otherwise errors will grow exponentially. This condition is $|G(\\theta_x, \\theta_y)| \\leq 1$. Since $G$ is real, this is equivalent to the two inequalities:\n$$\n-1 \\leq G(\\theta_x, \\theta_y) \\leq 1\n$$\nLet's examine the right inequality, $G \\leq 1$:\n$$\n1 - 4 \\Delta t \\left[ \\frac{\\alpha_x}{(\\Delta x)^2} \\sin^2\\left(\\frac{\\theta_x}{2}\\right) + \\frac{\\alpha_y}{(\\Delta y)^2} \\sin^2\\left(\\frac{\\theta_y}{2}\\right) \\right] \\leq 1\n$$\n$$\n- 4 \\Delta t \\left[ \\frac{\\alpha_x}{(\\Delta x)^2} \\sin^2\\left(\\frac{\\theta_x}{2}\\right) + \\frac{\\alpha_y}{(\\Delta y)^2} \\sin^2\\left(\\frac{\\theta_y}{2}\\right) \\right] \\leq 0\n$$\nSince $\\Delta t > 0$, $\\alpha_x > 0$, $\\alpha_y > 0$, and $\\sin^2(\\cdot) \\geq 0$, the term in the square brackets is always non-negative. Therefore, the left-hand side is always non-positive, and the condition $G \\leq 1$ is always satisfied.\n\nNow we examine the left inequality, $G \\geq -1$, which provides the actual stability constraint:\n$$\n1 - 4 \\Delta t \\left[ \\frac{\\alpha_x}{(\\Delta x)^2} \\sin^2\\left(\\frac{\\theta_x}{2}\\right) + \\frac{\\alpha_y}{(\\Delta y)^2} \\sin^2\\left(\\frac{\\theta_y}{2}\\right) \\right] \\geq -1\n$$\nRearranging the terms to solve for $\\Delta t$:\n$$\n2 \\geq 4 \\Delta t \\left[ \\frac{\\alpha_x}{(\\Delta x)^2} \\sin^2\\left(\\frac{\\theta_x}{2}\\right) + \\frac{\\alpha_y}{(\\Delta y)^2} \\sin^2\\left(\\frac{\\theta_y}{2}\\right) \\right]\n$$\n$$\n\\Delta t \\leq \\frac{2}{4 \\left[ \\frac{\\alpha_x}{(\\Delta x)^2} \\sin^2\\left(\\frac{\\theta_x}{2}\\right) + \\frac{\\alpha_y}{(\\Delta y)^2} \\sin^2\\left(\\frac{\\theta_y}{2}\\right) \\right]}\n$$\n$$\n\\Delta t \\leq \\frac{1}{2 \\left( \\frac{\\alpha_x}{(\\Delta x)^2} \\sin^2\\left(\\frac{\\theta_x}{2}\\right) + \\frac{\\alpha_y}{(\\Delta y)^2} \\sin^2\\left(\\frac{\\theta_y}{2}\\right) \\right)}\n$$\nThis inequality must hold for all possible wave numbers, i.e., for all $(\\theta_x, \\theta_y) \\in [-\\pi, \\pi] \\times [-\\pi, \\pi]$. To find the single most restrictive upper bound on $\\Delta t$, we must find the minimum value of the expression on the right-hand side. This minimum occurs when the denominator is maximized.\n\nThe denominator is maximized when the terms $\\sin^2(\\theta_x/2)$ and $\\sin^2(\\theta_y/2)$ reach their maximum values. The range of both $\\theta_x/2$ and $\\theta_y/2$ is $[-\\pi/2, \\pi/2]$. Over this interval, the maximum value of $\\sin^2(\\cdot)$ is $1$, which occurs at the endpoints $\\pm \\pi/2$ (corresponding to $\\theta_x = \\pm \\pi$ and $\\theta_y = \\pm \\pi$). These values correspond to the highest frequency modes (\"sawtooth\" waves) that can be represented on the grid.\n\nSubstituting $\\sin^2(\\theta_x/2)=1$ and $\\sin^2(\\theta_y/2)=1$ into the inequality yields the most stringent condition on $\\Delta t$:\n$$\n\\Delta t \\leq \\frac{1}{2 \\left( \\frac{\\alpha_x}{(\\Delta x)^2} (1) + \\frac{\\alpha_y}{(\\Delta y)^2} (1) \\right)}\n$$\nThe sharp upper bound for the time step, $\\Delta t_{\\max}$, is the value that makes this an equality:\n$$\n\\Delta t_{\\max} = \\frac{1}{2 \\left( \\frac{\\alpha_x}{(\\Delta x)^2} + \\frac{\\alpha_y}{(\\Delta y)^2} \\right)}\n$$\nThis is the stability limit for the FTCS scheme applied to the two-dimensional anisotropic diffusion equation.",
            "answer": "$$\n\\boxed{\\frac{1}{2 \\left(\\frac{\\alpha_{x}}{(\\Delta x)^{2}} + \\frac{\\alpha_{y}}{(\\Delta y)^{2}}\\right)}}\n$$"
        },
        {
            "introduction": "Having established stability for a dissipative system, we now turn our attention to a hyperbolic problem: linear advection. Unlike diffusion, advection involves wave propagation, where the phase accuracy of a scheme is as critical as its amplitude stability. This practice analyzes the leapfrog scheme, which is known for its low numerical dissipation but can suffer from significant phase errors, leading to incorrect wave speeds . By deriving the discrete dispersion relation and the numerical group velocity, you will learn to quantify this crucial form of error that impacts the fidelity of wave simulations.",
            "id": "3388991",
            "problem": "Consider the one-dimensional linear advection equation $u_{t} + a\\,u_{x} = 0$ with constant advection speed $a > 0$, discretized on a uniform grid $x_{j} = j\\,\\Delta x$ and time levels $t^{n} = n\\,\\Delta t$. The leapfrog advection scheme updates $u_{j}^{n}$ by\n$$\nu_{j}^{n+1} = u_{j}^{n-1} - C\\left(u_{j+1}^{n} - u_{j-1}^{n}\\right),\n$$\nwhere the Courant–Friedrichs–Lewy (CFL) number $C$ is defined as $C = a\\,\\Delta t/\\Delta x$. Perform a von Neumann stability and dispersion analysis by considering Fourier modes $u_{j}^{n} = \\hat{u}^{n}\\,\\exp\\!\\left(\\mathrm{i} j \\theta\\right)$ with grid wavenumber $\\theta \\in \\mathbb{R}$ expressed in radians. Let the amplification factor be represented in the form $\\lambda = \\exp\\!\\left(-\\mathrm{i}\\,\\omega(\\theta)\\,\\Delta t\\right)$, which defines the discrete temporal frequency $\\omega(\\theta)$ in radians per unit time. Derive the discrete dispersion relation $\\omega(\\theta)$ implied by the scheme, then obtain the group velocity $v_{g}(\\theta) = \\dfrac{d\\omega}{dk}$ where $k = \\theta/\\Delta x$ is the physical wavenumber. Finally, compare $v_{g}(\\theta)$ with the exact advection speed $a$ and provide a single closed-form analytic expression for the group velocity error\n$$\n\\Delta v_{g}(\\theta) = v_{g}(\\theta) - a\n$$\nin terms of $a$, $C$, and $\\theta$. Express $\\theta$ in radians. Your final answer must be the simplified analytic expression for $\\Delta v_{g}(\\theta)$; do not include any units inside the final boxed answer.",
            "solution": "We start from the linear advection equation $u_{t} + a\\,u_{x} = 0$ and its leapfrog discretization\n$$\nu_{j}^{n+1} = u_{j}^{n-1} - C\\left(u_{j+1}^{n} - u_{j-1}^{n}\\right), \\quad C = \\frac{a\\,\\Delta t}{\\Delta x}.\n$$\nTo perform a von Neumann analysis, we insert the Fourier ansatz $u_{j}^{n} = \\hat{u}^{n}\\,\\exp\\!\\left(\\mathrm{i} j \\theta\\right)$ with grid wavenumber $\\theta$ in radians. Then\n$$\nu_{j\\pm 1}^{n} = \\hat{u}^{n}\\,\\exp\\!\\left(\\mathrm{i} (j\\pm 1)\\theta\\right) = \\hat{u}^{n}\\,\\exp\\!\\left(\\mathrm{i} j \\theta\\right)\\,\\exp\\!\\left(\\pm \\mathrm{i} \\theta\\right).\n$$\nSubstituting into the scheme and factoring out $\\exp\\!\\left(\\mathrm{i} j \\theta\\right)$ gives\n$$\n\\hat{u}^{n+1} = \\hat{u}^{n-1} - C\\,\\hat{u}^{n}\\left(\\exp\\!\\left(\\mathrm{i} \\theta\\right) - \\exp\\!\\left(-\\mathrm{i} \\theta\\right)\\right).\n$$\nUsing $\\exp\\!\\left(\\mathrm{i} \\theta\\right) - \\exp\\!\\left(-\\mathrm{i} \\theta\\right) = 2 \\mathrm{i} \\sin(\\theta)$, we obtain\n$$\n\\hat{u}^{n+1} = \\hat{u}^{n-1} - 2 \\mathrm{i} C \\sin(\\theta)\\,\\hat{u}^{n}.\n$$\nLet the amplification per time step be $\\lambda$ such that $\\hat{u}^{n+1} = \\lambda\\,\\hat{u}^{n}$ and $\\hat{u}^{n-1} = \\lambda^{-1}\\,\\hat{u}^{n}$. Substituting yields\n$$\n\\lambda\\,\\hat{u}^{n} = \\lambda^{-1}\\,\\hat{u}^{n} - 2 \\mathrm{i} C \\sin(\\theta)\\,\\hat{u}^{n} \\quad \\Rightarrow \\quad \\lambda - \\lambda^{-1} = -2 \\mathrm{i} C \\sin(\\theta).\n$$\nMultiplying by $\\lambda$ gives the quadratic in $\\lambda$:\n$$\n\\lambda^{2} + 2 \\mathrm{i} C \\sin(\\theta)\\,\\lambda - 1 = 0.\n$$\nThe two roots are\n$$\n\\lambda = - \\mathrm{i} C \\sin(\\theta) \\pm \\sqrt{1 - C^{2}\\sin^{2}(\\theta)}.\n$$\nFor stability and a physically relevant branch continuous at $\\theta = 0$, we select the root with positive real part for small $\\theta$. Writing $\\lambda$ in polar form as $\\lambda = \\exp\\!\\left(-\\mathrm{i}\\,\\omega(\\theta)\\,\\Delta t\\right)$ with real $\\omega(\\theta)$, we match real and imaginary parts:\n$$\n\\lambda = \\cos\\!\\left(\\omega(\\theta)\\,\\Delta t\\right) - \\mathrm{i} \\sin\\!\\left(\\omega(\\theta)\\,\\Delta t\\right).\n$$\nComparing to $\\lambda = - \\mathrm{i} C \\sin(\\theta) + \\sqrt{1 - C^{2}\\sin^{2}(\\theta)}$ gives\n$$\n\\sin\\!\\left(\\omega(\\theta)\\,\\Delta t\\right) = C\\,\\sin(\\theta), \\qquad \\cos\\!\\left(\\omega(\\theta)\\,\\Delta t\\right) = \\sqrt{1 - C^{2}\\sin^{2}(\\theta)}.\n$$\nThus, the discrete dispersion relation is implicitly defined by\n$$\n\\sin\\!\\left(\\omega(\\theta)\\,\\Delta t\\right) = C\\,\\sin(\\theta).\n$$\nEquivalently, on the principal branch,\n$$\n\\omega(\\theta) = \\frac{1}{\\Delta t}\\,\\arcsin\\!\\left(C\\,\\sin(\\theta)\\right).\n$$\nThe group velocity is defined as $v_{g}(\\theta) = \\dfrac{d\\omega}{dk}$, where the physical wavenumber is $k = \\theta/\\Delta x$. By the chain rule,\n$$\nv_{g}(\\theta) = \\frac{d\\omega}{d\\theta}\\,\\frac{d\\theta}{dk} = \\Delta x\\,\\frac{d\\omega}{d\\theta}.\n$$\nDifferentiate the implicit relation $\\sin\\!\\left(\\omega(\\theta)\\,\\Delta t\\right) = C\\,\\sin(\\theta)$ with respect to $\\theta$:\n$$\n\\cos\\!\\left(\\omega(\\theta)\\,\\Delta t\\right)\\,\\Delta t\\,\\frac{d\\omega}{d\\theta} = C\\,\\cos(\\theta).\n$$\nTherefore,\n$$\n\\frac{d\\omega}{d\\theta} = \\frac{C\\,\\cos(\\theta)}{\\Delta t\\,\\cos\\!\\left(\\omega(\\theta)\\,\\Delta t\\right)}.\n$$\nUsing $\\cos\\!\\left(\\omega(\\theta)\\,\\Delta t\\right) = \\sqrt{1 - C^{2}\\sin^{2}(\\theta)}$, we obtain\n$$\n\\frac{domega}{d\\theta} = \\frac{C\\,\\cos(\\theta)}{\\Delta t\\,\\sqrt{1 - C^{2}\\sin^{2}(\\theta)}}.\n$$\nHence,\n$$\nv_{g}(\\theta) = \\Delta x\\,\\frac{C\\,\\cos(\\theta)}{\\Delta t\\,\\sqrt{1 - C^{2}\\sin^{2}(\\theta)}}.\n$$\nRecall $C = \\dfrac{a\\,\\Delta t}{\\Delta x}$, so\n$$\nv_{g}(\\theta) = a\\,\\frac{\\cos(\\theta)}{\\sqrt{1 - C^{2}\\sin^{2}(\\theta)}}.\n$$\nThe exact group velocity for linear advection is $a$. The group velocity error is therefore\n$$\n\\Delta v_{g}(\\theta) = v_{g}(\\theta) - a = a\\left(\\frac{\\cos(\\theta)}{\\sqrt{1 - C^{2}\\sin^{2}(\\theta)}} - 1\\right).\n$$\nThis is the desired closed-form analytic expression in terms of $a$, $C$, and $\\theta$ (with $\\theta$ in radians).",
            "answer": "$$\\boxed{a\\left(\\frac{\\cos(\\theta)}{\\sqrt{1 - C^{2}\\sin^{2}(\\theta)}} - 1\\right)}$$"
        },
        {
            "introduction": "The standard von Neumann analysis provides powerful insights, but its assumption of periodic boundary conditions is a critical limitation. This final practice explores what happens when we move to a more physically realistic finite domain with fixed (Dirichlet) boundaries . By constructing the global amplification matrix and computing its spectral radius, you will compare the true stability of the system to the prediction from the periodic von Neumann analysis. This exercise reveals the often-stabilizing effect of physical boundaries and introduces the more general and robust method of matrix stability analysis.",
            "id": "3388958",
            "problem": "Consider the one-dimensional heat equation on a finite interval with homogeneous Dirichlet boundaries, discretized by an explicit time integrator and a central interior stencil in space. Starting from the governing equation and standard finite-difference definitions, you must derive the global amplification operator on the interior degrees of freedom and compare its spectral radius to the periodic von Neumann prediction. Your program must implement this comparison for the specified test suite and report a single aggregate line of numerical results.\n\nFundamental base:\n- The partial differential equation is the heat equation $\\partial_t u(x,t) = \\alpha \\,\\partial_{xx} u(x,t)$ on a finite interval $x \\in [0,L]$, with homogeneous Dirichlet boundary conditions $u(0,t) = 0$ and $u(L,t) = 0$ for all $t \\ge 0$.\n- Use a uniform spatial grid with $N$ interior points, grid spacing $\\Delta x = L/(N+1)$, and time step $\\Delta t$. At each interior node $j \\in \\{1,2,\\dots,N\\}$, approximate the second derivative by the central difference $(u_{j+1}^n - 2 u_j^n + u_{j-1}^n)/\\Delta x^2$, and advance in time using forward Euler: $u_j^{n+1} = u_j^n + \\alpha \\Delta t \\,(u_{j+1}^n - 2 u_j^n + u_{j-1}^n)/\\Delta x^2$. The boundary values at the ghost nodes satisfy $u_0^n = 0$ and $u_{N+1}^n = 0$.\n- Define the non-dimensional parameter $r = \\alpha \\Delta t/\\Delta x^2$.\n\nTasks:\n1. Assemble the global amplification matrix $A \\in \\mathbb{R}^{N \\times N}$ for the homogeneous Dirichlet boundary conditions and central interior stencil described above so that the vector of interior values $u^n \\in \\mathbb{R}^N$ is mapped to $u^{n+1} = A \\,u^n$.\n2. Compute the spectral radius of $A$, i.e., the maximum absolute value of its eigenvalues.\n3. Under periodic boundary conditions on an infinite uniform grid with the same spatial discretization and explicit time step, perform a von Neumann analysis using Fourier modes $e^{\\mathrm{i} \\theta j}$, where $\\theta \\in [0,\\pi]$ is a dimensionless wave angle in radians. Determine the predicted maximum amplification magnitude over all $\\theta$ (the periodic von Neumann spectral radius). Angles must be treated in radians.\n4. Quantify the boundary-induced deviation by the difference $\\Delta \\rho = \\rho_{\\mathrm{Dirichlet}} - \\rho_{\\mathrm{VN, periodic}}$, where $\\rho_{\\mathrm{Dirichlet}}$ is the spectral radius of the assembled Dirichlet amplification matrix and $\\rho_{\\mathrm{VN, periodic}}$ is the periodic von Neumann prediction.\n\nTest suite:\n- Case $1$: $L = 1$, $\\alpha = 1$, $N = 10$, $r = 0.4$.\n- Case $2$: $L = 1$, $\\alpha = 1$, $N = 10$, $r = 0.5$.\n- Case $3$: $L = 1$, $\\alpha = 1$, $N = 10$, $r = 0.6$.\n- Case $4$: $L = 1$, $\\alpha = 1$, $N = 2$, $r = 0.6$.\n\nFor each case, compute $\\Delta x = L/(N+1)$ and then choose $\\Delta t = r\\,\\Delta x^2/\\alpha$ so that the specified $r$ is realized. You must compute and report one floating-point number per case: the value of $\\Delta \\rho$ as defined above.\n\nFinal output format:\n- Your program should produce a single line of output containing the results for the four test cases as a comma-separated list enclosed in square brackets, in the order of the cases listed, for example, $[d_1,d_2,d_3,d_4]$, where each $d_k$ is the computed $\\Delta \\rho$ for the corresponding case. No additional text or whitespace should be printed beyond this single line.",
            "solution": "The problem requires a comparative stability analysis of the Forward-Time Central-Space (FTCS) scheme for the one-dimensional heat equation, contrasting the behavior on a finite domain with Dirichlet boundary conditions against that on an infinite, periodic domain.\n\nThe governing partial differential equation is the heat equation:\n$$\n\\partial_t u(x,t) = \\alpha \\,\\partial_{xx} u(x,t)\n$$\non a domain $x \\in [0,L]$ with boundary conditions $u(0,t) = u(L,t) = 0$.\n\nThe discretization is given by the forward Euler method in time and a central difference scheme in space. The grid has $N$ interior points $x_j = j \\Delta x$ for $j=1, \\dots, N$, with a uniform spacing of $\\Delta x = L/(N+1)$. The discretized equation at an interior node $j$ and time step $n$ is:\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} = \\alpha \\frac{u_{j+1}^n - 2 u_j^n + u_{j-1}^n}{\\Delta x^2}\n$$\nRearranging and introducing the non-dimensional parameter $r = \\alpha \\Delta t / \\Delta x^2$, we obtain the update rule:\n$$\nu_j^{n+1} = u_j^n + r(u_{j+1}^n - 2 u_j^n + u_{j-1}^n)\n$$\n$$\nu_j^{n+1} = r u_{j-1}^n + (1 - 2r) u_j^n + r u_{j+1}^n\n$$\n\n**Task 1: Global Amplification Matrix for Dirichlet Boundaries**\n\nWe assemble the system of equations for all $N$ interior nodes into a single matrix equation, $u^{n+1} = A u^n$, where $u^n = [u_1^n, u_2^n, \\dots, u_N^n]^T$ is the vector of solutions at the interior nodes. The homogeneous Dirichlet boundary conditions impose $u_0^n = 0$ and $u_{N+1}^n = 0$.\n\nFor the first interior node, $j=1$:\n$$\nu_1^{n+1} = r u_0^n + (1 - 2r) u_1^n + r u_2^n = (1 - 2r) u_1^n + r u_2^n\n$$\nFor a general interior node, $j \\in \\{2, \\dots, N-1\\}$:\n$$\nu_j^{n+1} = r u_{j-1}^n + (1 - 2r) u_j^n + r u_{j+1}^n\n$$\nFor the last interior node, $j=N$:\n$$\nu_N^{n+1} = r u_{N-1}^n + (1 - 2r) u_N^n + r u_{N+1}^n = r u_{N-1}^n + (1 - 2r) u_N^n\n$$\nThese $N$ linear equations define the $N \\times N$ global amplification matrix $A$:\n$$\nA = \\begin{pmatrix}\n1-2r & r & 0 & \\dots & 0 \\\\\nr & 1-2r & r & \\dots & 0 \\\\\n0 & r & 1-2r & \\ddots & \\vdots \\\\\n\\vdots & \\ddots & \\ddots & \\ddots & r \\\\\n0 & \\dots & 0 & r & 1-2r\n\\end{pmatrix}\n$$\nThis is a symmetric tridiagonal Toeplitz matrix.\n\n**Task 2: Spectral Radius of the Dirichlet Matrix ($A$)**\n\nThe stability of the scheme is determined by the spectral radius of $A$, denoted $\\rho(A)$, which is the maximum absolute value of its eigenvalues. The eigenvalues $\\lambda_k$ of this specific matrix are known analytically:\n$$\n\\lambda_k(A) = 1 - 2r + 2r \\cos\\left(\\frac{k \\pi}{N+1}\\right) \\quad \\text{for } k=1, 2, \\dots, N\n$$\nUsing the identity $1 - \\cos(\\theta) = 2 \\sin^2(\\theta/2)$, we can rewrite this as:\n$$\n\\lambda_k(A) = 1 - 4r \\sin^2\\left(\\frac{k \\pi}{2(N+1)}\\right)\n$$\nThe spectral radius for the Dirichlet problem, $\\rho_{\\mathrm{Dirichlet}}$, is the maximum of the absolute values of these eigenvalues:\n$$\n\\rho_{\\mathrm{Dirichlet}} = \\max_{k \\in \\{1, \\dots, N\\}} \\left| 1 - 4r \\sin^2\\left(\\frac{k \\pi}{2(N+1)}\\right) \\right|\n$$\nSince the function $f(k) = 1 - 4r \\sin^2\\left(\\frac{k \\pi}{2(N+1)}\\right)$ is monotonic over $k \\in \\{1,\\dots,N\\}$, the maximum of its absolute value will occur at the endpoints, $k=1$ or $k=N$. The numerical implementation will compute the eigenvalues of the matrix $A$ directly and find the maximum of their absolute values.\n\n**Task 3: Periodic von Neumann Analysis**\n\nVon Neumann stability analysis is performed on an infinite periodic domain. We analyze the amplification of a single Fourier mode, $u_j^n = g^n e^{\\mathrm{i} \\theta j}$, where $g$ is the amplification factor and $\\theta = k_{wave} \\Delta x \\in [0, \\pi]$ is the dimensionless wave angle. Substituting this mode into the discretized equation:\n$$\ng^{n+1} e^{\\mathrm{i} \\theta j} = g^n e^{\\mathrm{i} \\theta j} + r \\left( g^n e^{\\mathrm{i} \\theta (j+1)} - 2 g^n e^{\\mathrm{i} \\theta j} + g^n e^{\\mathrm{i} \\theta (j-1)} \\right)\n$$\nDividing by $g^n e^{\\mathrm{i} \\theta j}$ gives the amplification factor $g(\\theta)$:\n$$\ng(\\theta) = 1 + r (e^{\\mathrm{i}\\theta} - 2 + e^{-\\mathrm{i}\\theta}) = 1 + r(2\\cos(\\theta) - 2)\n$$\n$$\ng(\\theta) = 1 - 2r(1 - \\cos(\\theta)) = 1 - 4r \\sin^2(\\theta/2)\n$$\nThe von Neumann spectral radius is the maximum magnitude of $g(\\theta)$ over all possible wave angles $\\theta \\in [0, \\pi]$:\n$$\n\\rho_{\\mathrm{VN, periodic}} = \\max_{\\theta \\in [0, \\pi]} |g(\\theta)| = \\max_{\\theta \\in [0, \\pi]} \\left| 1 - 4r \\sin^2(\\theta/2) \\right|\n$$\nThe term $\\sin^2(\\theta/2)$ ranges from $0$ (at $\\theta=0$) to $1$ (at $\\theta=\\pi$). Therefore, the function $g(\\theta)$ ranges from $g(0)=1$ to $g(\\pi)=1-4r$. The maximum of its absolute value is $\\max(|1|, |1-4r|)$.\nThis leads to the well-known stability condition for the FTCS scheme:\n- If $r \\le 1/2$, then $|1-4r| \\le 1$, so $\\rho_{\\mathrm{VN, periodic}} = 1$.\n- If $r > 1/2$, then $|1-4r| > 1$, so $\\rho_{\\mathrm{VN, periodic}} = 4r-1$.\n\n**Task 4: Boundary-Induced Deviation ($\\Delta \\rho$)**\n\nThe deviation is defined as $\\Delta \\rho = \\rho_{\\mathrm{Dirichlet}} - \\rho_{\\mathrm{VN, periodic}}$. The eigenvalues for the Dirichlet case correspond to the von Neumann amplification factor evaluated at a discrete set of wave angles, $\\theta_k = k\\pi/(N+1)$ for $k=1,\\dots,N$. This discrete set does not include the endpoints $\\theta=0$ and $\\theta=\\pi$, where the amplification factor $|g(\\theta)|$ attains its maximum. Consequently, $\\rho_{\\mathrm{Dirichlet}}$ is strictly less than $\\rho_{\\mathrm{VN, periodic}}$ (for $N < \\infty$), leading to a negative value for $\\Delta \\rho$. This demonstrates the stabilizing effect of the homogeneous Dirichlet boundary conditions, which prevent the growth of the modes that are most unstable in the periodic case.\n\nThe numerical solution will compute these quantities for each test case as specified.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of comparing the spectral radius of the FTCS scheme\n    for the 1D heat equation under Dirichlet and periodic boundary conditions.\n    \"\"\"\n    \n    # Test suite: (L, alpha, N, r)\n    test_cases = [\n        (1.0, 1.0, 10, 0.4),\n        (1.0, 1.0, 10, 0.5),\n        (1.0, 1.0, 10, 0.6),\n        (1.0, 1.0, 2, 0.6),\n    ]\n\n    results = []\n\n    for case in test_cases:\n        L, alpha, N, r = case\n        \n        # Although not strictly needed for stability calculations (which only use r),\n        # these would be the physical grid parameters.\n        # delta_x = L / (N + 1)\n        # delta_t = r * delta_x**2 / alpha\n        \n        # --- Task 1 & 2: Compute spectral radius for Dirichlet BCs ---\n        \n        # Construct the N x N amplification matrix A\n        # A = I + r * T_N, where T_N is the discrete Laplacian.\n        # Main diagonal is (1 - 2r), off-diagonals are r.\n        \n        if N > 0:\n            diag_val = 1.0 - 2.0 * r\n            off_diag_val = r\n            \n            A = np.diag(np.full(N, diag_val))\n            if N > 1:\n                A += np.diag(np.full(N - 1, off_diag_val), k=1)\n                A += np.diag(np.full(N - 1, off_diag_val), k=-1)\n\n            # Compute eigenvalues and spectral radius\n            eigenvalues = np.linalg.eigvals(A)\n            rho_dirichlet = np.max(np.abs(eigenvalues))\n        else: # Handle N=0 case, though not in test suite.\n            rho_dirichlet = 0.0\n\n        # --- Task 3: Compute spectral radius for periodic von Neumann analysis ---\n        \n        # The maximum amplification factor |g(theta)| depends on r.\n        if r <= 0.5:\n            rho_vn_periodic = 1.0\n        else:\n            rho_vn_periodic = 4.0 * r - 1.0\n            \n        # --- Task 4: Compute the deviation ---\n        \n        delta_rho = rho_dirichlet - rho_vn_periodic\n        results.append(delta_rho)\n\n    # Format the final output as specified\n    formatted_results = [f\"{res:.16f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}