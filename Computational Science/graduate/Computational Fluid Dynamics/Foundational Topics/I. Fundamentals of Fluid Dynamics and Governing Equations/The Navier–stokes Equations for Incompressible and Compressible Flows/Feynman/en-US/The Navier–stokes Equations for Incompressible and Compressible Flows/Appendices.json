{
    "hands_on_practices": [
        {
            "introduction": "Mastering the Navier-Stokes equations begins with understanding how to simplify them for canonical flow problems. This practice challenges you to derive one of the most fundamental exact solutions: the velocity profile for pressure-driven flow between two parallel plates, known as planar Poiseuille flow. By systematically applying assumptions of steady, fully developed, and incompressible flow, you will transform the governing partial differential equations into a simple ordinary differential equation, yielding an analytical expression for the velocity field and the total flow rate .",
            "id": "3377200",
            "problem": "Consider a steady, laminar, fully developed, planar pressure-driven flow of an incompressible, Newtonian fluid between two infinite, parallel plates located at $y=-h$ and $y=+h$. The streamwise direction is $x$, the wall-normal direction is $y$, and the spanwise direction is $z$. The fluid has constant dynamic viscosity $\\mu$ and constant density $\\rho$. Gravity is neglected. The imposed streamwise pressure gradient $\\frac{\\partial p}{\\partial x}$ is spatially uniform. Starting from the incompressible mass conservation and the Navier–Stokes equations (NSE), impose the no-slip boundary condition at both plates and the symmetry condition about $y=0$ to obtain the streamwise velocity profile $u(y)$. Then compute the volumetric flow rate per unit span in the $z$-direction,\n$$\nq \\;=\\; \\int_{-h}^{+h} u(y)\\,dy \\, .\n$$\nExpress your final answer for $q$ as a single closed-form analytic expression in terms of $\\mu$, $h$, and $\\frac{\\partial p}{\\partial x}$. Do not substitute numerical values and do not report intermediate results; provide only the final analytic expression as your answer.",
            "solution": "The problem is first validated to ensure it is scientifically sound, well-posed, and objective.\n\n**Step 1: Extract Givens**\n-   **Flow conditions**: Steady, laminar, fully developed, planar, pressure-driven.\n-   **Fluid properties**: Incompressible, Newtonian, constant dynamic viscosity $\\mu$, constant density $\\rho$.\n-   **Geometry**: Flow between two infinite, parallel plates located at $y=-h$ and $y=+h$.\n-   **Coordinate system**: Streamwise direction $x$, wall-normal direction $y$, spanwise direction $z$.\n-   **External fields**: Gravity is neglected.\n-   **Driving force**: Spatially uniform streamwise pressure gradient, $\\frac{\\partial p}{\\partial x}$.\n-   **Boundary conditions**: No-slip at $y=\\pm h$.\n-   **Symmetry condition**: Symmetry about $y=0$.\n-   **Required output**: Volumetric flow rate per unit span, $q = \\int_{-h}^{+h} u(y)\\,dy$, expressed in terms of $\\mu$, $h$, and $\\frac{\\partial p}{\\partial x}$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem describes the canonical case of planar Poiseuille flow. It is a fundamental, well-established problem in fluid dynamics derived directly from first principles.\n-   **Scientifically Grounded**: The problem is based on the Navier–Stokes equations for an incompressible, Newtonian fluid, which are fundamental principles of fluid mechanics.\n-   **Well-Posed**: The problem provides the governing equations (implied), domain geometry, and sufficient boundary conditions (no-slip) to determine a unique and stable velocity profile. The mention of a symmetry condition is consistent with the symmetric geometry and boundary conditions and can be used to simplify the solution.\n-   **Objective**: The problem is stated using precise, unambiguous mathematical and physical terminology.\n\n**Step 3: Verdict and Action**\nThe problem is deemed **valid**. A solution will be derived from the governing equations of fluid motion.\n\n**Derivation of the Solution**\n\nThe governing equations for an incompressible, Newtonian fluid are the continuity equation and the Navier–Stokes equations. In Cartesian coordinates $(x, y, z)$ with corresponding velocity components $(u, v, w)$, they are:\n\nContinuity:\n$$ \\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y} + \\frac{\\partial w}{\\partial z} = 0 $$\n\nNavier–Stokes (momentum equations):\n$$ \\rho \\left( \\frac{\\partial u}{\\partial t} + u \\frac{\\partial u}{\\partial x} + v \\frac{\\partial u}{\\partial y} + w \\frac{\\partial u}{\\partial z} \\right) = -\\frac{\\partial p}{\\partial x} + \\mu \\left( \\frac{\\partial^2 u}{\\partial x^2} + \\frac{\\partial^2 u}{\\partial y^2} + \\frac{\\partial^2 u}{\\partial z^2} \\right) $$\n$$ \\rho \\left( \\frac{\\partial v}{\\partial t} + u \\frac{\\partial v}{\\partial x} + v \\frac{\\partial v}{\\partial y} + w \\frac{\\partial v}{\\partial z} \\right) = -\\frac{\\partial p}{\\partial y} + \\mu \\left( \\frac{\\partial^2 v}{\\partial x^2} + \\frac{\\partial^2 v}{\\partial y^2} + \\frac{\\partial^2 v}{\\partial z^2} \\right) $$\n$$ \\rho \\left( \\frac{\\partial w}{\\partial t} + u \\frac{\\partial w}{\\partial x} + v \\frac{\\partial w}{\\partial y} + w \\frac{\\partial w}{\\partial z} \\right) = -\\frac{\\partial p}{\\partial z} + \\mu \\left( \\frac{\\partial^2 w}{\\partial x^2} + \\frac{\\partial^2 w}{\\partial y^2} + \\frac{\\partial^2 w}{\\partial z^2} \\right) $$\nHere, $p$ is the pressure. We neglect the body force term as gravity is ignored.\n\nWe apply the simplifying assumptions given in the problem statement:\n1.  **Steady flow**: All time derivatives are zero, $\\frac{\\partial}{\\partial t}(\\cdot) = 0$.\n2.  **Planar flow between infinite plates**: There is no flow in the spanwise ($z$) direction, so $w=0$. The \"infinite\" extent implies that there are no variations in the $z$-direction, so $\\frac{\\partial}{\\partial z}(\\cdot) = 0$.\n3.  **Fully developed flow**: The velocity profile does not change in the streamwise ($x$) direction. This means $\\frac{\\partial u}{\\partial x} = 0$. Since $w=0$, it also implies $\\frac{\\partial v}{\\partial x} = 0$ and $\\frac{\\partial w}{\\partial x} = 0$.\n\nApplying these simplifications to the continuity equation:\n$$ \\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y} + \\frac{\\partial w}{\\partial z} = 0 \\quad \\implies \\quad 0 + \\frac{\\partial v}{\\partial y} + 0 = 0 \\quad \\implies \\quad \\frac{\\partial v}{\\partial y} = 0 $$\nThis implies that $v$ is a function of $x$ and $z$ only. However, the no-slip condition at the walls requires $v=0$ at $y = \\pm h$. Combined with $\\frac{\\partial v}{\\partial y} = 0$, this means $v$ must be zero everywhere in the flow. So, $v=0$.\n\nNow, we simplify the momentum equations:\n-   **z-momentum equation**: With $w=0$ everywhere, all terms on the left-hand side and all viscous terms on the right-hand side are zero. The equation reduces to:\n    $$ 0 = -\\frac{\\partial p}{\\partial z} $$\n    This shows that the pressure $p$ does not vary in the $z$-direction.\n\n-   **y-momentum equation**: With $v=0$ everywhere, all terms on the left-hand side and all viscous terms on the right-hand side are zero. The equation reduces to:\n    $$ 0 = -\\frac{\\partial p}{\\partial y} $$\n    This shows that the pressure $p$ does not vary in the $y$-direction.\n\n-   **x-momentum equation**: With $\\frac{\\partial}{\\partial t}=0$, $v=0$, $w=0$, $\\frac{\\partial u}{\\partial x}=0$, and $\\frac{\\partial u}{\\partial z}=0$, the equation simplifies significantly. The left-hand side (advection term) becomes zero.\n    $$ \\rho \\left( 0 + u(0) + 0 + 0 \\right) = -\\frac{\\partial p}{\\partial x} + \\mu \\left( 0 + \\frac{\\partial^2 u}{\\partial y^2} + 0 \\right) $$\n    This yields:\n    $$ 0 = -\\frac{\\partial p}{\\partial x} + \\mu \\frac{d^2 u}{d y^2} $$\n    Since we found that $p$ is only a function of $x$ and $u$ is only a function of $y$, we can write this equation with ordinary derivatives:\n    $$ \\frac{d^2 u}{dy^2} = \\frac{1}{\\mu} \\frac{dp}{dx} $$\n    The problem states that $\\frac{\\partial p}{\\partial x}$ is spatially uniform (i.e., a constant). Let's denote this constant as $G = \\frac{dp}{dx}$.\n\nWe now solve this second-order ordinary differential equation for $u(y)$ by integrating twice with respect to $y$:\n$$ \\frac{du}{dy} = \\int \\frac{G}{\\mu} dy = \\frac{G}{\\mu} y + C_1 $$\n$$ u(y) = \\int \\left( \\frac{G}{\\mu} y + C_1 \\right) dy = \\frac{G}{2\\mu} y^2 + C_1 y + C_2 $$\nwhere $C_1$ and $C_2$ are integration constants determined by the boundary conditions.\n\nThe problem provides three conditions: no-slip at both walls and symmetry. We need two to find the constants.\n1.  Symmetry condition about $y=0$: $\\left. \\frac{du}{dy} \\right|_{y=0} = 0$.\n    Applying this to the first integral:\n    $$ \\frac{G}{\\mu} (0) + C_1 = 0 \\quad \\implies \\quad C_1 = 0 $$\n2.  No-slip condition at the upper wall $y=h$: $u(h)=0$.\n    Applying this to the solution for $u(y)$ with $C_1=0$:\n    $$ u(h) = \\frac{G}{2\\mu} h^2 + C_2 = 0 \\quad \\implies \\quad C_2 = -\\frac{G}{2\\mu} h^2 $$\n\nSubstituting the constants back into the expression for $u(y)$:\n$$ u(y) = \\frac{G}{2\\mu} y^2 - \\frac{G}{2\\mu} h^2 = \\frac{G}{2\\mu} (y^2 - h^2) $$\nReplacing $G$ with $\\frac{dp}{dx}$ (or $\\frac{\\partial p}{\\partial x}$ as per the problem's notation), we get the parabolic velocity profile:\n$$ u(y) = \\frac{1}{2\\mu} \\frac{\\partial p}{\\partial x} (y^2 - h^2) $$\nNote that for flow to occur in the positive $x$-direction ($u0$), the pressure gradient $\\frac{\\partial p}{\\partial x}$ must be negative, as expected for a pressure-driven flow.\n\nFinally, we compute the volumetric flow rate per unit span, $q$:\n$$ q = \\int_{-h}^{+h} u(y) \\, dy = \\int_{-h}^{+h} \\frac{1}{2\\mu} \\frac{\\partial p}{\\partial x} (y^2 - h^2) \\, dy $$\nSince $\\frac{1}{2\\mu}\\frac{\\partial p}{\\partial x}$ is a constant, we can take it out of the integral:\n$$ q = \\frac{1}{2\\mu} \\frac{\\partial p}{\\partial x} \\int_{-h}^{+h} (y^2 - h^2) \\, dy $$\nWe evaluate the definite integral:\n$$ \\int_{-h}^{+h} (y^2 - h^2) \\, dy = \\left[ \\frac{y^3}{3} - h^2 y \\right]_{-h}^{+h} $$\n$$ = \\left( \\frac{h^3}{3} - h^2(h) \\right) - \\left( \\frac{(-h)^3}{3} - h^2(-h) \\right) $$\n$$ = \\left( \\frac{h^3}{3} - h^3 \\right) - \\left( -\\frac{h^3}{3} + h^3 \\right) $$\n$$ = \\left( -\\frac{2h^3}{3} \\right) - \\left( \\frac{2h^3}{3} \\right) = -\\frac{4h^3}{3} $$\nSubstituting this result back into the expression for $q$:\n$$ q = \\frac{1}{2\\mu} \\frac{\\partial p}{\\partial x} \\left( -\\frac{4h^3}{3} \\right) $$\nSimplifying the expression gives the final answer:\n$$ q = -\\frac{2h^3}{3\\mu} \\frac{\\partial p}{\\partial x} $$\nThis is the required closed-form analytic expression for the volumetric flow rate per unit span.",
            "answer": "$$ \\boxed{-\\frac{2h^3}{3\\mu} \\frac{\\partial p}{\\partial x}} $$"
        },
        {
            "introduction": "When transitioning from analytical solutions to numerical methods, we encounter challenges not present in the continuous equations, such as stability and spurious oscillations. This exercise delves into the critical issue of pressure-velocity decoupling that arises in finite volume methods on collocated grids for incompressible flows . You will analyze this problem in Fourier space and design a Rhie-Chow-like filter, learning how to construct numerical schemes that suppress unphysical modes while preserving the accuracy of the underlying physics.",
            "id": "3377184",
            "problem": "Consider the incompressible Navier–Stokes equations in one spatial dimension on a periodic domain, discretized by a collocated finite volume method (FVM) on a uniform grid with spacing $\\Delta x$. Let the cell-centered pressure be $p_i$ and the face-normal velocity needed in the discrete continuity equation at face $i+\\tfrac{1}{2}$ be $u_{i+1/2}$. To update $u_{i+1/2}$ in a projection-like step, one must evaluate a face pressure-gradient contribution computed from cell-centered $p_i$. On collocated grids, naive linear interpolation can cause pressure–velocity decoupling and checkerboarding. \n\nYou are asked to design a one-parameter family of Rhie–Chow-like filters for the face pressure gradient that simultaneously:\n- annihilates unphysical checkerboard modes,\n- preserves long-wavelength kinetic-energy dynamics (in the sense of not introducing low-wavenumber dissipation), and\n- avoids over-damping.\n\nProceed as follows, starting only from the incompressible continuity constraint and core finite-volume consistency:\n\n1) Let the face pressure-gradient contribution be constructed from two basic, second-order consistent building blocks computed from cell-centered $p_i$:\n- the face-difference gradient $G_{i+1/2} := \\dfrac{p_{i+1} - p_i}{\\Delta x}$,\n- the face-average of cell-centered central gradients $\\bar{G}_{i+1/2} := \\dfrac{1}{2}\\left(\\dfrac{p_{i+2} - p_i}{2\\Delta x} + \\dfrac{p_{i+1} - p_{i-1}}{2\\Delta x}\\right)$.\n\nFor a dimensionless filter parameter $\\beta \\in \\mathbb{R}$, define the filtered face gradient\n$$\nG_{i+1/2}^{\\mathrm{eff}} := G_{i+1/2} + \\beta\\left(G_{i+1/2} - \\bar{G}_{i+1/2}\\right).\n$$\n\nThis construction removes the filter for linear pressure fields and targets only high-wavenumber content.\n\n2) The discrete continuity operator uses the face-normal flux difference. In a semi-discrete projection step, the pressure equation that emerges from taking the discrete divergence of the face gradient has the form\n$$\n\\mathcal{L}_{\\mathrm{eff}} p = \\text{known},\n$$\nwhere $\\mathcal{L}_{\\mathrm{eff}}$ is the discrete operator obtained by applying the face-to-cell divergence to $G_{i+1/2}^{\\mathrm{eff}}$. On a periodic grid, analyze $\\mathcal{L}_{\\mathrm{eff}}$ in Fourier space by setting $p_i = \\hat{p}\\,\\exp(\\mathrm{i}\\theta i)$ with $\\theta \\in [-\\pi,\\pi]$ and defining $s := \\theta/2$. The baseline second-order Laplacian symbol is $\\lambda_0(\\theta) = \\dfrac{4}{\\Delta x^2}\\sin^2(s)$.\n\nWorking from the definitions, derive the symbol of the filtered operator,\n$$\n\\lambda_{\\mathrm{eff}}(\\theta) = \\frac{4}{\\Delta x^2}\\sin^2(s)\\left[1 + \\beta\\,\\sin^2(s)\\right].\n$$\n\n3) Impose two design criteria:\n- Long-wave preservation: the low-wavenumber expansion of $\\lambda_{\\mathrm{eff}}(\\theta)$ must agree with the baseline second-order operator through order $\\theta^4$, thereby not adding any $\\mathcal{O}(\\theta^4)$ low-wavenumber dissipation. This requirement formalizes that the filter does not inject artificial damping into the large-scale kinetic energy dynamics.\n- Checkerboard suppression: the Nyquist mode at $\\theta = \\pi$ (i.e., $s = \\pi/2$) must be strictly damped, so $\\lambda_{\\mathrm{eff}}(\\pi) > 0$.\n\nDetermine a unique value of the parameter $\\beta$ that satisfies both criteria. Provide the final value of $\\beta$ as your answer. No intermediate expressions are accepted as the final answer; only the single number. Units are not applicable. The answer is exact and does not require rounding.",
            "solution": "The user has provided a problem from the field of computational fluid dynamics concerning the design of a filter for the pressure gradient in a finite volume discretization of the incompressible Navier-Stokes equations. The task is to determine a specific parameter, $\\beta$, for this filter based on two given criteria.\n\nFirst, the problem statement is validated. The problem is scientifically grounded in the numerical analysis of partial differential equations, specifically concerning pressure-velocity coupling on collocated grids. It is well-posed, objective, self-contained, and mathematically formalizable. All provided definitions and conditions are standard in the field. Therefore, the problem is deemed valid and a full solution will be provided.\n\nThe solution proceeds in three main parts:\n1.  Derivation of the Fourier symbol, $\\lambda_{\\mathrm{eff}}(\\theta)$, for the filtered discrete pressure operator, $\\mathcal{L}_{\\mathrm{eff}}$.\n2.  Application of the long-wave preservation criterion to constrain $\\beta$.\n3.  Application of the checkerboard suppression criterion and the final determination of $\\beta$.\n\n**1. Derivation of the Operator Symbol $\\lambda_{\\mathrm{eff}}(\\theta)$**\n\nThe discrete pressure operator is formed by the composition of a divergence operator and a gradient operator. We define the discrete divergence at cell center $i$ as $\\mathcal{D}(F)_i = \\frac{F_{i+1/2} - F_{i-1/2}}{\\Delta x}$ for a face-defined field $F$. The pressure equation takes the form $\\mathcal{L}_{\\mathrm{eff}} p = \\text{known}$, where $\\mathcal{L}_{\\mathrm{eff}}$ is equivalent to a discrete negative Laplacian, $\\mathcal{L}_{\\mathrm{eff}} = -\\mathcal{D}(G^{\\mathrm{eff}})$. We analyze its action on a Fourier mode $p_j = \\exp(\\mathrm{i}\\theta j)$ for a dimensionless wavenumber $\\theta \\in [-\\pi, \\pi]$. The symbol of an operator $\\mathcal{L}$ is the function $\\lambda(\\theta)$ such that $\\mathcal{L} \\exp(\\mathrm{i}\\theta j) = \\lambda(\\theta) \\exp(\\mathrm{i}\\theta j)$.\n\nFirst, let's find the symbol of the baseline operator $\\mathcal{L}_0 = -\\mathcal{D}(G)$.\nThe gradient is $G_{i+1/2} = \\frac{p_{i+1} - p_i}{\\Delta x}$. Applying $p_j = \\exp(\\mathrm{i}\\theta j)$:\n$G_{i+1/2} = \\frac{\\exp(\\mathrm{i}\\theta(i+1)) - \\exp(\\mathrm{i}\\theta i)}{\\Delta x} = \\frac{\\exp(\\mathrm{i}\\theta i)(\\exp(\\mathrm{i}\\theta)-1)}{\\Delta x}$.\nThen, $\\mathcal{D}(G)_i = \\frac{G_{i+1/2} - G_{i-1/2}}{\\Delta x} = \\frac{1}{\\Delta x^2} [(\\exp(\\mathrm{i}\\theta(i+1)) - \\exp(\\mathrm{i}\\theta i)) - (\\exp(\\mathrm{i}\\theta i) - \\exp(\\mathrm{i}\\theta (i-1)))] = \\frac{\\exp(\\mathrm{i}\\theta i)}{\\Delta x^2} (\\exp(\\mathrm{i}\\theta) - 2 + \\exp(-\\mathrm{i}\\theta))$.\nThe term in parentheses is $2\\cos(\\theta) - 2 = -4\\sin^2(\\theta/2)$. Let $s = \\theta/2$.\nSo, $\\mathcal{D}(G)_i = -\\frac{4\\sin^2(s)}{\\Delta x^2} \\exp(\\mathrm{i}\\theta i)$.\nThe symbol of $\\mathcal{L}_0 = -\\mathcal{D}(G)$ is therefore $\\lambda_0(\\theta) = \\frac{4\\sin^2(s)}{\\Delta x^2}$, which matches the problem statement.\n\nNext, we evaluate the term involving $\\bar{G}_{i+1/2}$.\n$\\bar{G}_{i+1/2} = \\frac{1}{2}\\left(\\frac{p_{i+2} - p_i}{2\\Delta x} + \\frac{p_{i+1} - p_{i-1}}{2\\Delta x}\\right) = \\frac{1}{4\\Delta x}(p_{i+2} + p_{i+1} - p_i - p_{i-1})$.\nLet's find the symbol of the operator $\\mathcal{L}_{\\bar{G}} = -\\mathcal{D}(\\bar{G})$. We first compute $\\mathcal{D}(\\bar{G})_i$:\n$\\mathcal{D}(\\bar{G})_i = \\frac{1}{\\Delta x} (\\bar{G}_{i+1/2} - \\bar{G}_{i-1/2}) = \\frac{1}{4\\Delta x^2} [(p_{i+2} + p_{i+1} - p_i - p_{i-1}) - (p_{i+1} + p_i - p_{i-1} - p_{i-2})]$\n$= \\frac{1}{4\\Delta x^2} [p_{i+2} - 2p_i + p_{i-2}]$.\nApplying $p_j = \\exp(\\mathrm{i}\\theta j)$, the stencil becomes $\\exp(\\mathrm{i}\\theta i)(\\exp(2\\mathrm{i}\\theta) - 2 + \\exp(-2\\mathrm{i}\\theta)) = \\exp(\\mathrm{i}\\theta i)(2\\cos(2\\theta)-2) = -4\\sin^2(\\theta)\\exp(\\mathrm{i}\\theta i)$.\nUsing $\\sin(\\theta) = 2\\sin(s)\\cos(s)$, this is $-16\\sin^2(s)\\cos^2(s)\\exp(\\mathrm{i}\\theta i)$.\nSo, $\\mathcal{D}(\\bar{G})_i = \\frac{-16\\sin^2(s)\\cos^2(s)}{4\\Delta x^2} \\exp(\\mathrm{i}\\theta i) = -\\frac{4\\sin^2(s)\\cos^2(s)}{\\Delta x^2} \\exp(\\mathrm{i}\\theta i)$.\nThe symbol of $\\mathcal{L}_{\\bar{G}} = -\\mathcal{D}(\\bar{G})$ is $\\lambda_{\\bar{G}}(\\theta) = \\frac{4\\sin^2(s)\\cos^2(s)}{\\Delta x^2}$.\n\nThe filtered gradient is $G_{i+1/2}^{\\mathrm{eff}} = G_{i+1/2} + \\beta(G_{i+1/2} - \\bar{G}_{i+1/2}) = (1+\\beta)G_{i+1/2} - \\beta\\bar{G}_{i+1/2}$.\nThe filtered operator is $\\mathcal{L}_{\\mathrm{eff}} = -\\mathcal{D}(G^{\\mathrm{eff}}) = -(1+\\beta)\\mathcal{D}(G) + \\beta\\mathcal{D}(\\bar{G}) = (1+\\beta)\\mathcal{L}_0 - \\beta\\mathcal{L}_{\\bar{G}}$.\nIts symbol is $\\lambda_{\\mathrm{eff}}(\\theta) = (1+\\beta)\\lambda_0(\\theta) - \\beta\\lambda_{\\bar{G}}(\\theta)$.\n$\\lambda_{\\mathrm{eff}}(\\theta) = (1+\\beta)\\frac{4\\sin^2(s)}{\\Delta x^2} - \\beta\\frac{4\\sin^2(s)\\cos^2(s)}{\\Delta x^2}$\n$= \\frac{4\\sin^2(s)}{\\Delta x^2} [ (1+\\beta) - \\beta\\cos^2(s) ]$\n$= \\frac{4\\sin^2(s)}{\\Delta x^2} [ 1 + \\beta(1-\\cos^2(s)) ]$\n$= \\frac{4\\sin^2(s)}{\\Delta x^2} [ 1 + \\beta\\sin^2(s) ]$.\nThis confirms the expression provided in the problem statement.\n\n**2. Application of Criterion 1: Long-Wave Preservation**\n\nThis criterion states that the low-wavenumber expansion of $\\lambda_{\\mathrm{eff}}(\\theta)$ must agree with the baseline second-order operator through order $\\theta^4$, and that this ensures the filter does not inject artificial dissipation at large scales.\n\nThe symbol of the exact continuous operator $-\\frac{d^2}{dx^2}$ applied to $\\exp(\\mathrm{i}kx)$ is $k^2$. For a discrete mode $\\theta$ on a grid with spacing $\\Delta x$, the corresponding continuous wavenumber is $k = \\theta/\\Delta x$. So the target symbol is $(\\theta/\\Delta x)^2$.\n\nLet's expand $\\lambda_0(\\theta)$ and $\\lambda_{\\mathrm{eff}}(\\theta)$ in powers of $\\theta$ (or $s = \\theta/2$) for $\\theta \\to 0$:\n$\\sin(s) = s - \\frac{s^3}{6} + \\frac{s^5}{120} - \\mathcal{O}(s^7)$.\n$\\sin^2(s) = (s - \\frac{s^3}{6} + \\dots)^2 = s^2 - 2s\\frac{s^3}{6} + \\mathcal{O}(s^6) = s^2 - \\frac{s^4}{3} + \\mathcal{O}(s^6)$.\n\nExpansion of the baseline symbol $\\lambda_0(\\theta)$:\n$\\lambda_0(\\theta) = \\frac{4}{\\Delta x^2} \\sin^2(s) = \\frac{4}{\\Delta x^2} \\left(s^2 - \\frac{s^4}{3} + \\mathcal{O}(s^6)\\right)$.\nSubstituting $s = \\theta/2$:\n$\\lambda_0(\\theta) = \\frac{4}{\\Delta x^2} \\left(\\frac{\\theta^2}{4} - \\frac{\\theta^4}{48} + \\mathcal{O}(\\theta^6)\\right) = \\frac{\\theta^2}{\\Delta x^2} - \\frac{\\theta^4}{12\\Delta x^2} + \\mathcal{O}(\\theta^6)$.\nThe deviation from the exact symbol, $-\\frac{\\theta^4}{12\\Delta x^2}$, is the leading-order truncation error, which is a form of numerical dissipation. The scheme is second-order accurate.\n\nExpansion of the filtered symbol $\\lambda_{\\mathrm{eff}}(\\theta)$:\n$\\lambda_{\\mathrm{eff}}(\\theta) = \\lambda_0(\\theta) [1 + \\beta\\sin^2(s)] = \\frac{4}{\\Delta x^2} \\sin^2(s) (1 + \\beta\\sin^2(s))$.\n$= \\frac{4}{\\Delta x^2} (s^2 - \\frac{s^4}{3} + \\mathcal{O}(s^6)) (1 + \\beta(s^2 - \\mathcal{O}(s^4)))$.\n$= \\frac{4}{\\Delta x^2} (s^2 - \\frac{s^4}{3} + \\beta s^4 + \\mathcal{O}(s^6)) = \\frac{4}{\\Delta x^2} \\left(s^2 + (\\beta - \\frac{1}{3})s^4 + \\mathcal{O}(s^6)\\right)$.\nSubstituting $s = \\theta/2$:\n$\\lambda_{\\mathrm{eff}}(\\theta) = \\frac{4}{\\Delta x^2} \\left(\\frac{\\theta^2}{4} + (\\beta - \\frac{1}{3})\\frac{\\theta^4}{16} + \\mathcal{O}(\\theta^6)\\right) = \\frac{\\theta^2}{\\Delta x^2} + \\frac{1}{4\\Delta x^2}\\left(\\beta - \\frac{1}{3}\\right)\\theta^4 + \\mathcal{O}(\\theta^6)$.\n\nThe phrase \"agree with the baseline second-order operator through order $\\theta^4$\" is interpreted in the context of improving the scheme. The objective \"not introducing low-wavenumber dissipation\" is understood to mean that the added filter term should cancel the leading-order dissipation of the baseline method, thereby making the method higher-order. This requires the total truncation error of the filtered scheme to be of higher order than $\\mathcal{O}(\\theta^4)$. The truncation error term is the coefficient of $\\theta^4$ in the expansion of $\\lambda_{\\mathrm{eff}}(\\theta) - (\\theta/\\Delta x)^2$. For this term to vanish, we must have:\n$\\frac{1}{4\\Delta x^2}\\left(\\beta - \\frac{1}{3}\\right) = 0$.\nThis implies a unique value for $\\beta$:\n$\\beta - \\frac{1}{3} = 0 \\implies \\beta = \\frac{1}{3}$.\nWith this value, the operator becomes fourth-order accurate at low wavenumbers, as $\\lambda_{\\mathrm{eff}}(\\theta) = \\frac{\\theta^2}{\\Delta x^2} + \\mathcal{O}(\\theta^6)$.\n\n**3. Application of Criterion 2: Checkerboard Suppression**\n\nThis criterion states that the Nyquist mode at $\\theta=\\pi$ must be strictly damped, which translates to $\\lambda_{\\mathrm{eff}}(\\pi)  0$.\nAt $\\theta = \\pi$, we have $s = \\pi/2$, so $\\sin(s) = \\sin(\\pi/2) = 1$.\n$\\lambda_{\\mathrm{eff}}(\\pi) = \\frac{4\\sin^2(\\pi/2)}{\\Delta x^2}[1 + \\beta\\sin^2(\\pi/2)] = \\frac{4(1)^2}{\\Delta x^2}[1 + \\beta(1)^2] = \\frac{4(1+\\beta)}{\\Delta x^2}$.\nThe condition $\\lambda_{\\mathrm{eff}}(\\pi)  0$ requires $1+\\beta  0$, or $\\beta  -1$.\nThe value $\\beta = 1/3$ determined from the first criterion satisfies this condition, since $1/3  -1$.\n\nThus, the unique value of $\\beta$ that satisfies both criteria is $1/3$.",
            "answer": "$$\\boxed{\\frac{1}{3}}$$"
        },
        {
            "introduction": "Compressible flows introduce new complexities, most notably the tight coupling of mass, momentum, and energy conservation, and the possibility of shock waves. This hands-on practice guides you through the construction of a complete one-dimensional finite volume solver for the compressible Navier-Stokes equations . By designing and implementing conservative numerical fluxes for both inviscid and viscous terms, you will build a tool that respects the fundamental conservation laws to machine precision, a cornerstone for accurately simulating high-speed flows.",
            "id": "3377190",
            "problem": "You are tasked with deriving and implementing a one-dimensional finite volume method for the compressible Navier–Stokes equations that is exactly conservative for mass, momentum, and total energy by construction through shared face fluxes. The derivation must start from the integral conservation laws and use constitutive relations for a Newtonian fluid with Fourier heat conduction and an ideal gas equation of state. Your program will carry out a single explicit time step on a uniform structured grid with periodic boundary conditions and report machine-level conservation diagnostics. All quantities are nondimensional, so no physical units are required.\n\nThe fundamental base you must start from consists of:\n- The integral conservation laws over a control volume for mass, momentum, and total energy. Let the conserved variable vector be $U = [\\rho, \\rho u, \\rho E]^{\\top}$, where $\\rho$ is density, $u$ is velocity, and $E$ is total specific energy. Let the inviscid (convective) flux be $F^{\\mathrm{c}}(U)$ and the viscous flux be $F^{\\mathrm{v}}(\\nabla W)$, where $W$ denotes primitive variables. The integral form over a control volume of width $\\Delta x$ centered at cell index $j$ on the domain $x \\in [0, L]$ is\n$$\n\\frac{d}{dt}\\int_{V_j} U\\, dx + \\left.F^{\\mathrm{c}}\\right|_{x_{j+\\frac{1}{2}}} - \\left.F^{\\mathrm{c}}\\right|_{x_{j-\\frac{1}{2}}} = \\left.F^{\\mathrm{v}}\\right|_{x_{j+\\frac{1}{2}}} - \\left.F^{\\mathrm{v}}\\right|_{x_{j-\\frac{1}{2}}}.\n$$\n- The ideal gas equation of state $p = (\\gamma - 1)\\left(\\rho E - \\frac{1}{2}\\rho u^{2}\\right)$, where $p$ is pressure and $\\gamma$ is the ratio of specific heats. The temperature is $T = p/(\\rho R)$ with gas constant $R$.\n- Newtonian viscous stress with Stokes hypothesis in one dimension: $\\tau_{xx} = \\frac{4}{3}\\mu \\frac{\\partial u}{\\partial x}$, with dynamic viscosity $\\mu$. Fourier heat conduction: $q_x = -\\kappa \\frac{\\partial T}{\\partial x}$ with thermal conductivity $\\kappa$. The specific heat at constant pressure is $c_p = \\frac{\\gamma R}{\\gamma - 1}$ and $\\kappa = \\frac{\\mu c_p}{\\mathrm{Pr}}$, where $\\mathrm{Pr}$ is the Prandtl number.\n- The inviscid flux in one spatial dimension:\n$$\nF^{\\mathrm{c}}(U) = \n\\begin{bmatrix}\n\\rho u \\\\\n\\rho u^{2} + p \\\\\nu(\\rho E + p)\n\\end{bmatrix}.\n$$\nThe viscous flux in one spatial dimension:\n$$\nF^{\\mathrm{v}} = \n\\begin{bmatrix}\n0 \\\\\n\\tau_{xx} \\\\\nu\\,\\tau_{xx} - q_x\n\\end{bmatrix}.\n$$\n\nRequirements for your discrete design and implementation:\n- Use a uniform grid with $N$ finite volumes covering $[0, L]$ with periodic boundary conditions, so that each interior face flux used to update adjacent cells is equal and opposite, guaranteeing exact telescoping cancellation of interior contributions.\n- Construct a two-point, consistent, symmetric numerical interface flux for the inviscid part that adds dissipation proportional to an upper bound on the local characteristic speed. In the implementation, use as penalization speed at each face the maximum over the two adjacent states of $|u| + a$, where $a = \\sqrt{\\gamma p/\\rho}$ is the local speed of sound. This choice must be applied in such a way that face contributions are equal and opposite for the two adjacent cells.\n- Discretize viscous terms by centered face gradients computed from adjacent cell values to form face-centered $\\tau_{xx}$ and $q_x$, and use the same face viscous flux vector for both cells sharing that face, so that viscous fluxes are also equal and opposite across interior faces.\n- Advance the solution by a single forward Euler time step, $U^{n+1}_j = U^n_j - \\frac{\\Delta t}{\\Delta x} \\left(\\widehat{F}^{\\mathrm{c}}_{j+\\frac{1}{2}} - \\widehat{F}^{\\mathrm{c}}_{j-\\frac{1}{2}}\\right) + \\frac{\\Delta t}{\\Delta x} \\left(F^{\\mathrm{v}}_{j+\\frac{1}{2}} - F^{\\mathrm{v}}_{j-\\frac{1}{2}}\\right)$, where hats denote numerical inviscid fluxes at faces. Choose the time step using a Courant–Friedrichs–Lewy number $\\mathrm{CFL}$ as $\\Delta t = \\mathrm{CFL}\\, \\Delta x / \\max_i \\left(|u_i| + a_i\\right)$.\n- All computations are nondimensional. You must implement all formulas needed; no external data is provided.\n\nTest suite and initial data:\n- Use domain length $L = 1$. For each test, initialize $(\\rho, u, p)$ as follows at cell centers $x_i = \\left(i + \\frac{1}{2}\\right)\\Delta x$, $i = 0,\\dots,N-1$.\n- Test A (smooth periodic): $N = 100$, $\\gamma = 1.4$, $R = 1$, $\\mu = 0.01$, $\\mathrm{Pr} = 0.72$, $\\mathrm{CFL} = 0.1$. Initialize $\\rho(x) = 1 + 0.1\\sin(2\\pi x)$, $u(x) = 0.3$, $p(x) = 1$.\n- Test B (uniform equilibrium): $N = 64$, $\\gamma = 1.4$, $R = 1$, $\\mu = 0$, $\\mathrm{Pr} = 0.72$, $\\mathrm{CFL} = 0.2$. Initialize $\\rho(x) = 1$, $u(x) = 0$, $p(x) = 1$.\n- Test C (Riemann-type step): $N = 200$, $\\gamma = 1.4$, $R = 1$, $\\mu = 0.001$, $\\mathrm{Pr} = 0.72$, $\\mathrm{CFL} = 0.05$. Initialize left state on $x  0.5$: $(\\rho, u, p) = (1, 0, 1)$; right state on $x \\ge 0.5$: $(\\rho, u, p) = (0.125, 0, 0.1)$.\n\nRequired outputs:\n- For each test, compute the global integrals before and after one time step: $M = \\int_0^L \\rho\\, dx$, $P = \\int_0^L \\rho u\\, dx$, $E_{\\mathrm{tot}} = \\int_0^L \\rho E\\, dx$. Use the midpoint rule consistent with cell averages, i.e., $\\sum_j U_{j} \\Delta x$.\n- Report, for each test, the absolute changes $\\left(|\\Delta M|, |\\Delta P|, |\\Delta E_{\\mathrm{tot}}|\\right)$ after one time step, rounded to $10^{-12}$ in decimal representation.\n- Your program should produce a single line of output containing the results as a comma-separated Python-style list enclosed in square brackets, with one three-element list per test in the order A, B, C. For example, a valid shape is $[[m_A,p_A,e_A],[m_B,p_B,e_B],[m_C,p_C,e_C]]$, where each entry is a decimal float.\n\nYour submission must be a complete, runnable program that performs these computations and prints the single required line. No user input is allowed, and no external files may be accessed.",
            "solution": "The user has provided a well-defined problem in computational fluid dynamics. The task is to derive and implement a one-dimensional finite volume method for the compressible Navier-Stokes equations, verify its conservation properties, and report the results for a given set of test cases. The problem is scientifically sound, self-contained, and all necessary parameters and equations are specified.\n\nThe derivation and implementation will proceed as follows. First, the governing equations and constitutive relations are discretized on a uniform, periodic grid. The final algorithm will then be implemented in Python using the NumPy library for vectorized computations.\n\n**1. Governing Equations and State Variables**\n\nThe system is governed by the 1D compressible Navier-Stokes equations in conservation form. The vector of conserved variables is $U = [\\rho, \\rho u, \\rho E]^{\\top}$, where $\\rho$ is the fluid density, $u$ is the velocity, and $E$ is the total specific energy. The integral form of the conservation law for a control volume $V_j$ of width $\\Delta x$ is:\n$$\n\\frac{d}{dt}\\int_{V_j} U\\, dx + F_{j+\\frac{1}{2}} - F_{j-\\frac{1}{2}} = 0\n$$\nwhere $F = F^{\\mathrm{c}} - F^{\\mathrm{v}}$ is the total flux, composed of an inviscid (convective) part $F^{\\mathrm{c}}$ and a viscous part $F^{\\mathrm{v}}$.\n\nThe ideal gas equation of state relates pressure $p$ to the conserved quantities:\n$$\np = (\\gamma - 1)\\left(\\rho E - \\frac{1}{2}\\rho u^2\\right) = (\\gamma - 1)\\left(U_3 - \\frac{U_2^2}{2U_1}\\right)\n$$\nwhere $\\gamma$ is the ratio of specific heats. To convert from primitive variables $(\\rho, u, p)$ back to conserved variables, we use:\n$$\nU = \\begin{bmatrix} \\rho \\\\ \\rho u \\\\ \\frac{p}{\\gamma - 1} + \\frac{1}{2}\\rho u^2 \\end{bmatrix}\n$$\n\n**2. Finite Volume Discretization**\n\nWe use a finite volume method, where $U_j$ represents the cell-average of the conserved quantities in cell $j$. The semi-discrete form of the governing equations is:\n$$\n\\frac{dU_j}{dt} = -\\frac{1}{\\Delta x} \\left(\\widehat{F}_{j+\\frac{1}{2}} - \\widehat{F}_{j-\\frac{1}{2}}\\right)\n$$\nHere, $\\widehat{F}_{j+\\frac{1}{2}}$ is the numerical flux at the interface between cell $j$ and cell $j+1$. This flux approximates the physical flux and is composed of numerical inviscid and viscous components: $\\widehat{F} = \\widehat{F}^{\\mathrm{c}} - \\widehat{F}^{\\mathrm{v}}$.\n\n**3. Numerical Inviscid Flux**\n\nThe problem specifies a symmetric, two-point flux with dissipation, characteristic of a Rusanov (or local Lax-Friedrichs) scheme. The numerical flux at the interface $j+\\frac{1}{2}$ between states $U_L = U_j$ and $U_R = U_{j+1}$ is:\n$$\n\\widehat{F}^{\\mathrm{c}}_{j+\\frac{1}{2}} = \\frac{1}{2} \\left[ F^{\\mathrm{c}}(U_L) + F^{\\mathrm{c}}(U_R) \\right] - \\frac{1}{2} S_{j+\\frac{1}{2}} (U_R - U_L)\n$$\nThe physical flux $F^{\\mathrm{c}}(U)$ is given by:\n$$\nF^{\\mathrm{c}}(U) = \\begin{bmatrix} \\rho u \\\\ \\rho u^2 + p \\\\ u(\\rho E + p) \\end{bmatrix}\n$$\nThe dissipation term $S_{j+\\frac{1}{2}}$ is a numerical wave speed, specified as the maximum characteristic speed at the interface:\n$$\nS_{j+\\frac{1}{2}} = \\max\\left( |u_L| + a_L, |u_R| + a_R \\right)\n$$\nwhere $a = \\sqrt{\\gamma p / \\rho}$ is the local speed of sound. This formulation ensures that the flux contribution is equal and opposite for the two cells sharing the interface, leading to a conservative scheme.\n\n**4. Numerical Viscous Flux**\n\nThe viscous flux is discretized using centered differences at the cell interface $j+\\frac{1}{2}$. The physical viscous flux is:\n$$\nF^{\\mathrm{v}} = \\begin{bmatrix} 0 \\\\ \\tau_{xx} \\\\ u\\,\\tau_{xx} - q_x \\end{bmatrix}\n$$\nThe shear stress $\\tau_{xx}$ and heat flux $q_x$ are approximated at the face:\n$$\n\\tau_{xx, j+\\frac{1}{2}} = \\frac{4}{3}\\mu \\left(\\frac{\\partial u}{\\partial x}\\right)_{j+\\frac{1}{2}} \\approx \\frac{4}{3}\\mu \\frac{u_{j+1} - u_j}{\\Delta x}\n$$\n$$\nq_{x, j+\\frac{1}{2}} = -\\kappa \\left(\\frac{\\partial T}{\\partial x}\\right)_{j+\\frac{1}{2}} \\approx -\\kappa \\frac{T_{j+1} - T_j}{\\Delta x}\n$$\nThe temperature $T$ is derived from the ideal gas law, $T = p/(\\rho R)$, where $R$ is the gas constant. The thermal conductivity $\\kappa$ is related to the dynamic viscosity $\\mu$ via the Prandtl number $\\mathrm{Pr}$: $\\kappa = \\frac{\\mu c_p}{\\mathrm{Pr}}$, with $c_p = \\frac{\\gamma R}{\\gamma - 1}$. The velocity $u$ in the energy flux term is averaged at the face: $u_{j+\\frac{1}{2}} = \\frac{1}{2}(u_j + u_{j+1})$. This centered formulation is also conservative by construction.\n\n**5. Time Integration and Conservation**\n\nThe system is advanced by a single forward Euler step:\n$$\nU^{n+1}_j = U^n_j - \\frac{\\Delta t}{\\Delta x} \\left(\\widehat{F}^{\\mathrm{c}}_{j+\\frac{1}{2}} - \\widehat{F}^{\\mathrm{c}}_{j-\\frac{1}{2}}\\right) + \\frac{\\Delta t}{\\Delta x} \\left(\\widehat{F}^{\\mathrm{v}}_{j+\\frac{1}{2}} - \\widehat{F}^{\\mathrm{v}}_{j-\\frac{1}{2}}\\right)\n$$\nThe time step $\\Delta t$ is determined by the Courant-Friedrichs-Lewy (CFL) condition:\n$$\n\\Delta t = \\mathrm{CFL} \\frac{\\Delta x}{\\max_j(|u_j| + a_j)}\n$$\nTo check for conservation, we compute the total mass $M$, momentum $P$, and energy $E_{\\mathrm{tot}}$ over the domain by summing the cell-averaged quantities:\n$$\n\\sum_j U_j \\Delta x = \\begin{bmatrix} M \\\\ P \\\\ E_{\\mathrm{tot}} \\end{bmatrix}\n$$\nDue to the periodic boundary conditions and the conservative flux formulation, the sum of all flux differences across the domain forms a telescoping sum that evaluates to zero. Therefore, $\\sum_j (U^{n+1}_j - U^n_j) = 0$. The total conserved quantities should remain constant up to floating-point precision errors. The problem asks to calculate the absolute change in these total quantities to verify this property.\n\nThe implementation will be fully vectorized using NumPy. Left and right states for all interfaces will be generated using `numpy.roll` to handle the periodic boundaries efficiently. The algorithm will loop through the specified test cases, perform one time step for each, and calculate the conservation diagnostics.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and implements a 1D finite volume method for compressible Navier-Stokes\n    and carries out a single explicit time step to report conservation diagnostics.\n    \"\"\"\n\n    test_cases = [\n        # Test A: Smooth periodic wave\n        {\n            \"name\": \"A\",\n            \"N\": 100, \"L\": 1.0, \"gamma\": 1.4, \"R\": 1.0,\n            \"mu\": 0.01, \"Pr\": 0.72, \"CFL\": 0.1,\n            \"ic_type\": \"function\",\n            \"ic_func\": lambda x: (1.0 + 0.1 * np.sin(2 * np.pi * x), 0.3, 1.0)\n        },\n        # Test B: Uniform equilibrium\n        {\n            \"name\": \"B\",\n            \"N\": 64, \"L\": 1.0, \"gamma\": 1.4, \"R\": 1.0,\n            \"mu\": 0.0, \"Pr\": 0.72, \"CFL\": 0.2,\n            \"ic_type\": \"function\",\n            \"ic_func\": lambda x: (1.0, 0.0, 1.0)\n        },\n        # Test C: Riemann-type step\n        {\n            \"name\": \"C\",\n            \"N\": 200, \"L\": 1.0, \"gamma\": 1.4, \"R\": 1.0,\n            \"mu\": 0.001, \"Pr\": 0.72, \"CFL\": 0.05,\n            \"ic_type\": \"riemann\",\n            \"ic_states\": {\"L\": (1.0, 0.0, 1.0), \"R\": (0.125, 0.0, 0.1), \"split\": 0.5}\n        }\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        # Unpack parameters\n        N, L, gamma, R = case[\"N\"], case[\"L\"], case[\"gamma\"], case[\"R\"]\n        mu, Pr, CFL = case[\"mu\"], case[\"Pr\"], case[\"CFL\"]\n\n        # Grid setup\n        dx = L / N\n        x = (np.arange(N) + 0.5) * dx\n\n        # Initial conditions\n        rho, u, p = np.zeros(N), np.zeros(N), np.zeros(N)\n        if case[\"ic_type\"] == \"function\":\n            rho_vals, u_vals, p_vals = case[\"ic_func\"](x)\n            rho = rho_vals if isinstance(rho_vals, np.ndarray) else np.full(N, rho_vals)\n            u = u_vals if isinstance(u_vals, np.ndarray) else np.full(N, u_vals)\n            p = p_vals if isinstance(p_vals, np.ndarray) else np.full(N, p_vals)\n        elif case[\"ic_type\"] == \"riemann\":\n            split_pos = case[\"ic_states\"][\"split\"]\n            mask_L = x  split_pos\n            mask_R = x >= split_pos\n            rho[mask_L], u[mask_L], p[mask_L] = case[\"ic_states\"][\"L\"]\n            rho[mask_R], u[mask_R], p[mask_R] = case[\"ic_states\"][\"R\"]\n            \n        # Helper functions\n        def primitives_to_conserved(rho, u, p, gamma):\n            rho_u = rho * u\n            rho_E = p / (gamma - 1.0) + 0.5 * rho * u**2\n            return np.array([rho, rho_u, rho_E])\n\n        def conserved_to_primitives(U, gamma, R):\n            rho = U[0]\n            # Add a small epsilon to rho to prevent division by zero in vacuum-like states\n            u = U[1] / (rho + 1e-100)\n            rho_E = U[2]\n            # Ensure internal energy is non-negative\n            internal_energy_density = rho_E - 0.5 * rho * u**2\n            internal_energy_density = np.maximum(internal_energy_density, 1e-100)\n            p = (gamma - 1.0) * internal_energy_density\n            T = p / ((rho + 1e-100) * R)\n            a = np.sqrt(gamma * p / (rho + 1e-100))\n            return rho, u, p, T, a\n\n        # Initial state and total quantities\n        U = primitives_to_conserved(rho, u, p, gamma)\n        total_initial = np.sum(U, axis=1) * dx\n\n        # --- Single Time Step Calculation ---\n        \n        # 1. Decode primitives from conserved state U\n        rho, u, p, T, a = conserved_to_primitives(U, gamma, R)\n        \n        # 2. Calculate time step dt\n        max_wave_speed = np.max(np.abs(u) + a)\n        dt = CFL * dx / max_wave_speed\n        \n        # 3. Prepare left and right states at interfaces using periodic boundaries\n        U_L = U\n        U_R = np.roll(U, -1, axis=1)\n        rho_L, u_L, p_L, T_L, a_L = conserved_to_primitives(U_L, gamma, R)\n        rho_R, u_R, p_R, T_R, a_R = conserved_to_primitives(U_R, gamma, R)\n        \n        # 4. Compute numerical inviscid flux (Rusanov)\n        def get_inviscid_flux(rho, u, p, U):\n            rho_u = U[1]\n            rho_E = U[2]\n            return np.array([rho_u, rho_u * u + p, u * (rho_E + p)])\n\n        Fc_L = get_inviscid_flux(rho_L, u_L, p_L, U_L)\n        Fc_R = get_inviscid_flux(rho_R, u_R, p_R, U_R)\n        \n        S = np.maximum(np.abs(u_L) + a_L, np.abs(u_R) + a_R)\n        Fc_num = 0.5 * (Fc_L + Fc_R) - 0.5 * S[np.newaxis, :] * (U_R - U_L)\n        \n        # 5. Compute numerical viscous flux\n        Fv_num = np.zeros_like(U)\n        if mu > 0:\n            cp = gamma * R / (gamma - 1.0)\n            kappa = mu * cp / Pr\n            dudx = (u_R - u_L) / dx\n            dTdx = (T_R - T_L) / dx\n            tau_xx = (4.0/3.0) * mu * dudx\n            q_x = -kappa * dTdx\n            u_face = 0.5 * (u_L + u_R)\n            Fv_num[1, :] = tau_xx\n            Fv_num[2, :] = u_face * tau_xx - q_x\n\n        # 6. Total numerical flux and RHS computation\n        F_total_num = Fc_num - Fv_num\n        F_total_num_shifted = np.roll(F_total_num, 1, axis=1) # Fluxes at j-1/2 faces\n        RHS = -(1.0 / dx) * (F_total_num - F_total_num_shifted)\n        \n        # 7. Update solution with Forward Euler\n        U_final = U + dt * RHS\n        \n        # --- End of time step ---\n\n        # Final total quantities and conservation check\n        total_final = np.sum(U_final, axis=1) * dx\n        changes = np.abs(total_final - total_initial)\n        rounded_changes = [round(c, 12) for c in changes]\n        all_results.append(rounded_changes)\n        \n    print(f\"{all_results}\")\n\nsolve()\n```"
        }
    ]
}