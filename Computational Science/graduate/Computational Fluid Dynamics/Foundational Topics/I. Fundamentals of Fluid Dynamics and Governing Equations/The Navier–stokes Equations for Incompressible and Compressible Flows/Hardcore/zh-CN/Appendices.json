{
    "hands_on_practices": [
        {
            "introduction": "理论通过实践得以升华。本章提供了一系列精心设计的练习，旨在将纳维-斯托克斯方程的抽象概念转化为具体的求解技能。第一个练习将引导您从完整的不可压缩纳维-斯托克斯方程出发，通过应用合理的物理假设，推导出泊肃叶流这一经典问题的精确解析解。这个过程不仅是求解一个具体问题，更是掌握如何简化复杂控制方程以洞察流动核心物理机制的基础训练。",
            "id": "3377200",
            "problem": "考虑位于 $y=-h$ 和 $y=+h$ 的两块无限大平行板之间的不可压缩牛顿流体的稳态、层流、完全发展、平面压力驱动流。流向为 $x$ 方向，壁面法向为 $y$ 方向，展向为 $z$ 方向。流体的动力粘度 $\\mu$ 和密度 $\\rho$ 均为常数。忽略重力。施加的流向压力梯度 $\\partial p/\\partial x$ 在空间上是均匀的。从不可压缩质量守恒和 Navier–Stokes 方程 (NSE) 出发，施加两块板上的无滑移边界条件和关于 $y=0$ 的对称条件，以获得流向速度剖面 $u(y)$。然后计算 $z$ 方向上单位展长的体积流量，\n$$\nq \\;=\\; \\int_{-h}^{+h} u(y)\\,dy \\, .\n$$\n将 $q$ 的最终答案表示为仅含 $\\mu$、$h$ 和 $\\frac{\\partial p}{\\partial x}$ 的单个闭式解析表达式。不要代入数值，也不要报告中间结果；只提供最终的解析表达式作为答案。",
            "solution": "首先验证问题，以确保其科学上合理、适定且客观。\n\n**步骤 1：提取已知条件**\n-   **流动条件**：稳态、层流、完全发展、平面、压力驱动。\n-   **流体性质**：不可压缩、牛顿流体、恒定的动力粘度 $\\mu$、恒定的密度 $\\rho$。\n-   **几何结构**：位于 $y=-h$ 和 $y=+h$ 的两块无限大平行板之间的流动。\n-   **坐标系**：流向 $x$，壁面法向 $y$，展向 $z$。\n-   **外场**：忽略重力。\n-   **驱动力**：空间均匀的流向压力梯度，$\\frac{\\partial p}{\\partial x}$。\n-   **边界条件**：在 $y=\\pm h$ 处无滑移。\n-   **对称条件**：关于 $y=0$ 对称。\n-   **要求输出**：单位展长的体积流量，$q = \\int_{-h}^{+h} u(y)\\,dy$，用 $\\mu$、$h$ 和 $\\frac{\\partial p}{\\partial x}$ 表示。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题描述了平面 Poiseuille 流的典型案例。这是流体动力学中一个基础且成熟的问题，直接从第一性原理推导得出。\n-   **科学依据**：该问题基于不可压缩牛顿流体的 Navier–Stokes 方程，这是流体力学的基本原理。\n-   **适定性**：该问题提供了控制方程（隐含的）、域几何结构以及足够的边界条件（无滑移）来确定一个唯一且稳定的速度剖面。提及对称条件与对称的几何结构和边界条件一致，并可用于简化求解过程。\n-   **客观性**：该问题使用精确、无歧义的数学和物理术语进行陈述。\n\n**步骤 3：结论与行动**\n该问题被认为是**有效的**。将从流体运动的控制方程推导出解。\n\n**解的推导**\n\n不可压缩牛顿流体的控制方程是连续性方程和 Navier–Stokes 方程。在笛卡尔坐标系 $(x, y, z)$ 中，对应的速度分量为 $(u, v, w)$，方程如下：\n\n连续性方程：\n$$ \\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y} + \\frac{\\partial w}{\\partial z} = 0 $$\n\nNavier–Stokes 方程（动量方程）：\n$$ \\rho \\left( \\frac{\\partial u}{\\partial t} + u \\frac{\\partial u}{\\partial x} + v \\frac{\\partial u}{\\partial y} + w \\frac{\\partial u}{\\partial z} \\right) = -\\frac{\\partial p}{\\partial x} + \\mu \\left( \\frac{\\partial^2 u}{\\partial x^2} + \\frac{\\partial^2 u}{\\partial y^2} + \\frac{\\partial^2 u}{\\partial z^2} \\right) $$\n$$ \\rho \\left( \\frac{\\partial v}{\\partial t} + u \\frac{\\partial v}{\\partial x} + v \\frac{\\partial v}{\\partial y} + w \\frac{\\partial v}{\\partial z} \\right) = -\\frac{\\partial p}{\\partial y} + \\mu \\left( \\frac{\\partial^2 v}{\\partial x^2} + \\frac{\\partial^2 v}{\\partial y^2} + \\frac{\\partial^2 v}{\\partial z^2} \\right) $$\n$$ \\rho \\left( \\frac{\\partial w}{\\partial t} + u \\frac{\\partial w}{\\partial x} + v \\frac{\\partial w}{\\partial y} + w \\frac{\\partial w}{\\partial z} \\right) = -\\frac{\\partial p}{\\partial z} + \\mu \\left( \\frac{\\partial^2 w}{\\partial x^2} + \\frac{\\partial^2 w}{\\partial y^2} + \\frac{\\partial^2 w}{\\partial z^2} \\right) $$\n这里，$p$ 是压力。由于忽略了重力，我们忽略体积力项。\n\n我们应用问题陈述中给出的简化假设：\n1.  **稳态流**：所有时间导数均为零，$\\frac{\\partial}{\\partial t}(\\cdot) = 0$。\n2.  **无限大平行板间的平面流**：在展向（$z$）方向上没有流动，所以 $w=0$。“无限”范围意味着在 $z$ 方向上没有变化，所以 $\\frac{\\partial}{\\partial z}(\\cdot) = 0$。\n3.  **完全发展流**：速度剖面在流向（$x$）方向上不发生变化。这意味着 $\\frac{\\partial u}{\\partial x} = 0$。由于 $w=0$，这也意味着 $\\frac{\\partial v}{\\partial x} = 0$ 和 $\\frac{\\partial w}{\\partial x} = 0$。\n\n将这些简化应用于连续性方程：\n$$ \\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y} + \\frac{\\partial w}{\\partial z} = 0 \\quad \\implies \\quad 0 + \\frac{\\partial v}{\\partial y} + 0 = 0 \\quad \\implies \\quad \\frac{\\partial v}{\\partial y} = 0 $$\n这意味着 $v$ 仅是 $x$ 和 $z$ 的函数。然而，壁面处的无滑移条件要求在 $y = \\pm h$ 处 $v=0$。结合 $\\frac{\\partial v}{\\partial y} = 0$，这意味着 $v$ 在流场中必须处处为零。所以，$v=0$。\n\n现在，我们简化动量方程：\n-   **z-动量方程**：由于 $w=0$ 处处成立，左侧的所有项和右侧的所有粘性项均为零。方程简化为：\n    $$ 0 = -\\frac{\\partial p}{\\partial z} $$\n    这表明压力 $p$ 不随 $z$ 方向变化。\n\n-   **y-动量方程**：由于 $v=0$ 处处成立，左侧的所有项和右侧的所有粘性项均为零。方程简化为：\n    $$ 0 = -\\frac{\\partial p}{\\partial y} $$\n    这表明压力 $p$ 不随 $y$ 方向变化。\n\n-   **x-动量方程**：由于 $\\frac{\\partial}{\\partial t}=0$, $v=0$, $w=0$, $\\frac{\\partial u}{\\partial x}=0$, 以及 $\\frac{\\partial u}{\\partial z}=0$，方程显著简化。左侧（对流项）变为零。\n    $$ \\rho \\left( 0 + u(0) + 0 + 0 \\right) = -\\frac{\\partial p}{\\partial x} + \\mu \\left( 0 + \\frac{\\partial^2 u}{\\partial y^2} + 0 \\right) $$\n    这得到：\n    $$ 0 = -\\frac{\\partial p}{\\partial x} + \\mu \\frac{d^2 u}{d y^2} $$\n    因为我们发现 $p$ 仅是 $x$ 的函数，而 $u$ 仅是 $y$ 的函数，我们可以用常导数来写这个方程：\n    $$ \\frac{d^2 u}{dy^2} = \\frac{1}{\\mu} \\frac{dp}{dx} $$\n    问题陈述中指出 $\\frac{\\partial p}{\\partial x}$ 在空间上是均匀的（即一个常数）。我们把这个常数记为 $G = \\frac{dp}{dx}$。\n\n我们现在通过对 $y$ 积分两次来求解这个关于 $u(y)$ 的二阶常微分方程：\n$$ \\frac{du}{dy} = \\int \\frac{G}{\\mu} dy = \\frac{G}{\\mu} y + C_1 $$\n$$ u(y) = \\int \\left( \\frac{G}{\\mu} y + C_1 \\right) dy = \\frac{G}{2\\mu} y^2 + C_1 y + C_2 $$\n其中 $C_1$ 和 $C_2$ 是由边界条件决定的积分常数。\n\n问题提供了三个条件：两个壁面上的无滑移和对称性。我们需要两个条件来求解常数。\n1.  关于 $y=0$ 的对称条件：$\\left. \\frac{du}{dy} \\right|_{y=0} = 0$。\n    将此条件应用于第一个积分：\n    $$ \\frac{G}{\\mu} (0) + C_1 = 0 \\quad \\implies \\quad C_1 = 0 $$\n2.  上壁面 $y=h$ 处的无滑移条件：$u(h)=0$。\n    将此条件应用于 $u(y)$ 的解（其中 $C_1=0$）：\n    $$ u(h) = \\frac{G}{2\\mu} h^2 + C_2 = 0 \\quad \\implies \\quad C_2 = -\\frac{G}{2\\mu} h^2 $$\n\n将常数代回 $u(y)$ 的表达式：\n$$ u(y) = \\frac{G}{2\\mu} y^2 - \\frac{G}{2\\mu} h^2 = \\frac{G}{2\\mu} (y^2 - h^2) $$\n用 $\\frac{dp}{dx}$（或根据问题符号 $\\frac{\\partial p}{\\partial x}$）替换 $G$，我们得到抛物线速度剖面：\n$$ u(y) = \\frac{1}{2\\mu} \\frac{\\partial p}{\\partial x} (y^2 - h^2) $$\n注意，要使流动发生在 $x$ 正方向（$u>0$），压力梯度 $\\frac{\\partial p}{\\partial x}$ 必须为负，这与压力驱动流的预期一致。\n\n最后，我们计算单位展长的体积流量 $q$：\n$$ q = \\int_{-h}^{+h} u(y) \\, dy = \\int_{-h}^{+h} \\frac{1}{2\\mu} \\frac{\\partial p}{\\partial x} (y^2 - h^2) \\, dy $$\n因为 $\\frac{1}{2\\mu}\\frac{\\partial p}{\\partial x}$ 是一个常数，我们可以将其从积分中提出：\n$$ q = \\frac{1}{2\\mu} \\frac{\\partial p}{\\partial x} \\int_{-h}^{+h} (y^2 - h^2) \\, dy $$\n我们计算定积分：\n$$ \\int_{-h}^{+h} (y^2 - h^2) \\, dy = \\left[ \\frac{y^3}{3} - h^2 y \\right]_{-h}^{+h} $$\n$$ = \\left( \\frac{h^3}{3} - h^2(h) \\right) - \\left( \\frac{(-h)^3}{3} - h^2(-h) \\right) $$\n$$ = \\left( \\frac{h^3}{3} - h^3 \\right) - \\left( -\\frac{h^3}{3} + h^3 \\right) $$\n$$ = \\left( -\\frac{2h^3}{3} \\right) - \\left( \\frac{2h^3}{3} \\right) = -\\frac{4h^3}{3} $$\n将此结果代回 $q$ 的表达式：\n$$ q = \\frac{1}{2\\mu} \\frac{\\partial p}{\\partial x} \\left( -\\frac{4h^3}{3} \\right) $$\n简化表达式得到最终答案：\n$$ q = -\\frac{2h^3}{3\\mu} \\frac{\\partial p}{\\partial x} $$\n这是所要求的单位展长体积流量的闭式解析表达式。",
            "answer": "$$ \\boxed{-\\frac{2h^3}{3\\mu} \\frac{\\partial p}{\\partial x}} $$"
        },
        {
            "introduction": "在掌握了稳态流动的解析分析后，我们将转向非稳态流动，并探究黏性耗散这一核心物理现象。泰勒-格林涡是研究黏性效应和湍流转捩的经典模型。通过本练习，您将从第一性原理出发，推导其动能随时间的衰减率，从而深刻理解纳维-斯托克斯方程中的黏性项如何控制流场中能量的耗散过程。",
            "id": "3377151",
            "problem": "考虑一不可压缩的常密度流体，其密度为 $\\rho$，运动粘度为 $\\nu$。该流体在方形周期性域 $\\Omega = [0, 2\\pi/k] \\times [0, 2\\pi/k]$ 中根据纳维-斯托克斯方程演化。初始速度场为泰勒-格林涡\n$$\nu_x(x,y,0) = U_0 \\cos(k x)\\,\\sin(k y), \\quad\nu_y(x,y,0) = -U_0 \\sin(k x)\\,\\cos(k y), \\quad\nu_z(x,y,0) = 0,\n$$\n其满足 $\\nabla \\cdot \\boldsymbol{u} = 0$。令单位质量的域平均动能定义为\n$$\nE(t) = \\frac{1}{2|\\Omega|} \\int_{\\Omega} |\\boldsymbol{u}(x,y,t)|^2 \\,\\mathrm{d}\\Omega.\n$$\n不存在外部体力。\n\n仅使用基本守恒定律和周期性边界条件的标准性质，完成以下任务：\n\n1. 从不可压缩的纳维-斯托克斯方程和上述 $E(t)$ 的定义出发，推导在 $t = 0$ 时仅由粘性耗散引起的 $E(t)$ 的瞬时衰减率。用 $\\nu$、$k$ 和 $U_0$ 表示你的结果，并将其写为 $\\left.\\frac{\\mathrm{d}E}{\\mathrm{d}t}\\right|_{t=0}$。\n\n2. 独立地，假设在早期时间内，流动保持初始泰勒-格林涡的空间结构，并且可以用可分离拟设表示\n$$\n\\boldsymbol{u}(x,y,t) = U_0\\,A(t)\\,\\Big(\\cos(k x)\\,\\sin(k y),\\, -\\sin(k x)\\,\\cos(k y),\\, 0\\Big),\n$$\n其中 $A(t)$ 为某个标量振幅，且 $A(0) = 1$。从不可压缩的纳维-斯托克斯方程确定 $A(t)$ 满足的常微分方程，并求得能量比的早期时间展开式，\n$$\n\\frac{E(t)}{E(0)} = 1 + a_1\\,t + \\mathcal{O}(t^2),\n$$\n并确定系数 $a_1$。\n\n最终答案请报告仅用 $\\nu$ 和 $k$ 表示的 $a_1$ 的单一简化解析表达式。最终答案中不要包含任何单位。如果你找到了多个中间表达式，提交的最终答案必须仅为 $a_1$ 的单一值。",
            "solution": "用户提供的问题经核实具有科学依据、问题适定且客观。这是一个理论流体动力学中的标准问题，其表述清晰明确。所有必要信息均已提供，所要求的任务在数学上是可解的。\n\n按照问题陈述的要求，解答分为两部分。\n\n第1部分：推导 $t=0$ 时的瞬时能量衰减率。\n\n单位质量的域平均动能定义为：\n$$\nE(t) = \\frac{1}{2|\\Omega|} \\int_{\\Omega} |\\boldsymbol{u}(x,y,t)|^2 \\,\\mathrm{d}\\Omega\n$$\n其中 $|\\Omega| = (2\\pi/k)^2$ 是域的面积。将 $E(t)$ 对时间 $t$ 求导，得到：\n$$\n\\frac{\\mathrm{d}E}{\\mathrm{d}t} = \\frac{1}{2|\\Omega|} \\int_{\\Omega} \\frac{\\partial}{\\partial t}(\\boldsymbol{u} \\cdot \\boldsymbol{u}) \\,\\mathrm{d}\\Omega = \\frac{1}{|\\Omega|} \\int_{\\Omega} \\boldsymbol{u} \\cdot \\frac{\\partial \\boldsymbol{u}}{\\partial t} \\,\\mathrm{d}\\Omega\n$$\n无外部力作用下的不可压缩纳维-斯托克斯动量守恒方程为：\n$$\n\\frac{\\partial \\boldsymbol{u}}{\\partial t} + (\\boldsymbol{u} \\cdot \\nabla)\\boldsymbol{u} = -\\frac{1}{\\rho}\\nabla p + \\nu \\nabla^2 \\boldsymbol{u}\n$$\n将 $\\frac{\\partial \\boldsymbol{u}}{\\partial t}$ 代入 $\\frac{\\mathrm{d}E}{\\mathrm{d}t}$ 的表达式中：\n$$\n\\frac{\\mathrm{d}E}{\\mathrm{d}t} = \\frac{1}{|\\Omega|} \\int_{\\Omega} \\boldsymbol{u} \\cdot \\left( -\\frac{1}{\\rho}\\nabla p - (\\boldsymbol{u} \\cdot \\nabla)\\boldsymbol{u} + \\nu \\nabla^2 \\boldsymbol{u} \\right) \\,\\mathrm{d}\\Omega\n$$\n我们分析积分中的每一项：\n1.  压力项：$-\\frac{1}{\\rho|\\Omega|} \\int_{\\Omega} \\boldsymbol{u} \\cdot \\nabla p \\, \\mathrm{d}\\Omega$。使用矢量恒等式 $\\nabla \\cdot (p\\boldsymbol{u}) = (\\nabla p) \\cdot \\boldsymbol{u} + p(\\nabla \\cdot \\boldsymbol{u})$ 以及不可压缩性条件 $\\nabla \\cdot \\boldsymbol{u} = 0$，我们有 $\\boldsymbol{u} \\cdot \\nabla p = \\nabla \\cdot (p \\boldsymbol{u})$。根据散度定理和周期性边界条件，$\\int_{\\Omega} \\nabla \\cdot (p \\boldsymbol{u}) \\, \\mathrm{d}\\Omega = \\int_{\\partial \\Omega} p \\boldsymbol{u} \\cdot \\boldsymbol{n} \\, \\mathrm{d}S = 0$。\n2.  平流项：$-\\frac{1}{|\\Omega|} \\int_{\\Omega} \\boldsymbol{u} \\cdot ((\\boldsymbol{u} \\cdot \\nabla)\\boldsymbol{u}) \\, \\mathrm{d}\\Omega$。被积函数可以写为 $u_j \\frac{\\partial}{\\partial x_j} (\\frac{1}{2} u_i u_i) = \\nabla \\cdot (\\frac{1}{2}|\\boldsymbol{u}|^2 \\boldsymbol{u})$。同样，由于周期性边界条件，这个散度的积分也为零。\n3.  粘性项：$\\frac{\\nu}{|\\Omega|} \\int_{\\Omega} \\boldsymbol{u} \\cdot (\\nabla^2 \\boldsymbol{u}) \\, \\mathrm{d}\\Omega$。在周期性域上使用分部积分（等同于一个矢量恒等式和散度定理），对每个分量 $u_i$：$\\int_{\\Omega} u_i \\nabla^2 u_i \\, \\mathrm{d}\\Omega = -\\int_{\\Omega} |\\nabla u_i|^2 \\, \\mathrm{d}\\Omega$。对所有分量求和，$\\int_{\\Omega} \\boldsymbol{u} \\cdot \\nabla^2 \\boldsymbol{u} \\, \\mathrm{d}\\Omega = -\\int_{\\Omega} |\\nabla \\boldsymbol{u}|^2 \\, \\mathrm{d}\\Omega$，其中 $|\\nabla \\boldsymbol{u}|^2 = \\sum_{i,j} (\\partial u_i/\\partial x_j)^2$。\n\n因此，动能的变化率由粘性耗散决定：\n$$\n\\frac{\\mathrm{d}E}{\\mathrm{d}t} = - \\frac{\\nu}{|\\Omega|} \\int_{\\Omega} |\\nabla \\boldsymbol{u}|^2 \\, \\mathrm{d}\\Omega\n$$\n我们使用初始速度场 $\\boldsymbol{u}(x,y,0)$ 在 $t=0$ 时计算该式：\n$u_x(0) = U_0 \\cos(kx)\\sin(ky)$，$u_y(0) = -U_0 \\sin(kx)\\cos(ky)$，$u_z(0) = 0$。\n所需的偏导数为：\n$\\frac{\\partial u_x}{\\partial x} = -U_0 k \\sin(kx)\\sin(ky)$，$\\frac{\\partial u_x}{\\partial y} = U_0 k \\cos(kx)\\cos(ky)$。\n$\\frac{\\partial u_y}{\\partial x} = -U_0 k \\cos(kx)\\cos(ky)$，$\\frac{\\partial u_y}{\\partial y} = U_0 k \\sin(kx)\\sin(ky)$。\n所有涉及 $u_z$ 或 $\\partial/\\partial z$ 的导数均为零。\n被积函数 $|\\nabla \\boldsymbol{u}(x,y,0)|^2$ 为：\n$$\n|\\nabla \\boldsymbol{u}|^2 = \\left(\\frac{\\partial u_x}{\\partial x}\\right)^2 + \\left(\\frac{\\partial u_x}{\\partial y}\\right)^2 + \\left(\\frac{\\partial u_y}{\\partial x}\\right)^2 + \\left(\\frac{\\partial u_y}{\\partial y}\\right)^2\n$$\n$$\n|\\nabla \\boldsymbol{u}|^2 = U_0^2 k^2 \\sin^2(kx)\\sin^2(ky) + U_0^2 k^2 \\cos^2(kx)\\cos^2(ky) + U_0^2 k^2 \\cos^2(kx)\\cos^2(ky) + U_0^2 k^2 \\sin^2(kx)\\sin^2(ky)\n$$\n$$\n|\\nabla \\boldsymbol{u}|^2 = 2 U_0^2 k^2 \\left( \\sin^2(kx)\\sin^2(ky) + \\cos^2(kx)\\cos^2(ky) \\right)\n$$\n为了进行积分，我们利用在一个完整周期内 $\\sin^2(\\theta)$ 或 $\\cos^2(\\theta)$ 的平均值为 $1/2$ 这一性质。对于矩形域 $\\Omega$ 上的函数 $f(x)$ 和 $g(y)$，其乘积的平均值等于其各自平均值的乘积。\n$$\n\\frac{1}{|\\Omega|} \\int_{\\Omega} |\\nabla \\boldsymbol{u}|^2\\mathrm{d}\\Omega = 2 U_0^2 k^2 \\left( \\langle\\sin^2(kx)\\rangle\\langle\\sin^2(ky)\\rangle + \\langle\\cos^2(kx)\\rangle\\langle\\cos^2(ky)\\rangle \\right)\n$$\n$$\n= 2 U_0^2 k^2 \\left( \\left(\\frac{1}{2}\\right)\\left(\\frac{1}{2}\\right) + \\left(\\frac{1}{2}\\right)\\left(\\frac{1}{2}\\right) \\right) = 2 U_0^2 k^2 \\left(\\frac{1}{4} + \\frac{1}{4}\\right) = U_0^2 k^2\n$$\n最后，将此结果代回 $t=0$ 时的能量衰减率表达式中：\n$$\n\\left.\\frac{\\mathrm{d}E}{\\mathrm{d}t}\\right|_{t=0} = -\\nu (U_0^2 k^2) = -U_0^2 k^2 \\nu\n$$\n\n第2部分：使用可分离拟设确定 $a_1$。\n\n假设速度场的形式为 $\\boldsymbol{u}(x,y,t) = U_0 A(t) \\boldsymbol{u}_{sp}(x,y)$，其中 $\\boldsymbol{u}_{sp}(x,y) = (\\cos(kx)\\sin(ky), -\\sin(kx)\\cos(ky), 0)$ 且 $A(0)=1$。为求得 $A(t)$ 的常微分方程，我们将此拟设代入纳维-斯托克斯方程，并使用在 $\\Omega$ 上的空间积分内积（记为 $\\langle \\boldsymbol{f}, \\boldsymbol{g} \\rangle = \\int_\\Omega \\boldsymbol{f}\\cdot\\boldsymbol{g}\\,\\mathrm{d}\\Omega$）将方程投影到模态 $\\boldsymbol{u}_{sp}$ 上。\n投影方程为：\n$$\n\\langle \\boldsymbol{u}_{sp}, \\frac{\\partial \\boldsymbol{u}}{\\partial t} \\rangle = \\langle \\boldsymbol{u}_{sp}, -(\\boldsymbol{u}\\cdot\\nabla)\\boldsymbol{u} \\rangle - \\langle \\boldsymbol{u}_{sp}, \\frac{1}{\\rho}\\nabla p \\rangle + \\langle \\boldsymbol{u}_{sp}, \\nu\\nabla^2\\boldsymbol{u} \\rangle\n$$\n代入拟设：\n$$\nU_0 \\frac{\\mathrm{d}A}{\\mathrm{d}t} \\langle \\boldsymbol{u}_{sp}, \\boldsymbol{u}_{sp} \\rangle = - (U_0 A)^2 \\langle \\boldsymbol{u}_{sp}, (\\boldsymbol{u}_{sp}\\cdot\\nabla)\\boldsymbol{u}_{sp} \\rangle - 0 + \\nu U_0 A \\langle \\boldsymbol{u}_{sp}, \\nabla^2\\boldsymbol{u}_{sp} \\rangle\n$$\n由于 $\\nabla\\cdot\\boldsymbol{u}_{sp}=0$ 和周期性边界条件，压力项为零。我们来计算这些内积：\n- $\\langle \\boldsymbol{u}_{sp}, \\boldsymbol{u}_{sp} \\rangle = \\int_\\Omega |\\boldsymbol{u}_{sp}|^2 d\\Omega = \\int_\\Omega (\\cos^2(kx)\\sin^2(ky) + \\sin^2(kx)\\cos^2(ky)) d\\Omega$。被积函数的平均值为 $1/4 + 1/4 = 1/2$。所以，$\\langle \\boldsymbol{u}_{sp}, \\boldsymbol{u}_{sp} \\rangle = \\frac{1}{2}|\\Omega|$。\n- $\\langle \\boldsymbol{u}_{sp}, \\nabla^2\\boldsymbol{u}_{sp} \\rangle = -\\int_\\Omega |\\nabla\\boldsymbol{u}_{sp}|^2 d\\Omega$。我们在第1部分中发现 $\\frac{1}{|\\Omega|}\\int|\\nabla(U_0\\boldsymbol{u}_{sp})|^2 d\\Omega = U_0^2k^2$，这意味着 $\\frac{1}{|\\Omega|}\\int|\\nabla\\boldsymbol{u}_{sp}|^2 d\\Omega = k^2$。所以，$\\langle \\boldsymbol{u}_{sp}, \\nabla^2\\boldsymbol{u}_{sp} \\rangle = -|\\Omega|k^2$。\n- 平流项需要计算 $(\\boldsymbol{u}_{sp}\\cdot\\nabla)\\boldsymbol{u}_{sp}$。计算表明该项为 $(\\boldsymbol{u}_{sp}\\cdot\\nabla)\\boldsymbol{u}_{sp} = -\\frac{k}{2}(\\sin(2kx), \\sin(2ky), 0)$。于是内积为 $\\langle \\boldsymbol{u}_{sp}, (\\boldsymbol{u}_{sp}\\cdot\\nabla)\\boldsymbol{u}_{sp} \\rangle = -\\frac{k}{2} \\int_\\Omega (\\cos(kx)\\sin(ky)\\sin(2kx) - \\sin(kx)\\cos(ky)\\sin(2ky)) d\\Omega$。根据三角恒等式 $\\sin(2\\theta)=2\\sin\\theta\\cos\\theta$ 以及正弦和余弦的正交性，积分中的两项在周期性域上的积分都为零。例如，$\\int_0^{2\\pi/k}\\cos(kx)\\sin(2kx)dx = 0$。因此，$\\langle \\boldsymbol{u}_{sp}, (\\boldsymbol{u}_{sp}\\cdot\\nabla)\\boldsymbol{u}_{sp} \\rangle = 0$。\n\n投影方程简化为：\n$$\nU_0 \\frac{\\mathrm{d}A}{\\mathrm{d}t} \\left(\\frac{1}{2}|\\Omega|\\right) = \\nu U_0 A (-|\\Omega| k^2)\n$$\n$$\n\\frac{\\mathrm{d}A}{\\mathrm{d}t} = -2\\nu k^2 A\n$$\n在初始条件 $A(0)=1$ 下，解为 $A(t) = \\exp(-2\\nu k^2 t)$。\n\n现在，我们计算能量比 $E(t)/E(0)$。\n$$\nE(t) = \\frac{1}{2|\\Omega|} \\int_{\\Omega} |U_0 A(t) \\boldsymbol{u}_{sp}|^2 d\\Omega = U_0^2 A(t)^2 \\left(\\frac{1}{2|\\Omega|} \\int_{\\Omega} |\\boldsymbol{u}_{sp}|^2 d\\Omega\\right)\n$$\n括号中的项是初始能量 $Е(0)$ 除以 $U_0^2$（因为 $A(0)=1$）。具体来说，$E(0) = \\frac{U_0^2}{2|\\Omega|}\\int|\\boldsymbol{u}_{sp}|^2d\\Omega = \\frac{U_0^2}{2|\\Omega|}(\\frac{|\\Omega|}{2}) = \\frac{U_0^2}{4}$。\n所以，$E(t) = E(0) A(t)^2$。能量比为：\n$$\n\\frac{E(t)}{E(0)} = A(t)^2 = \\left(\\exp(-2\\nu k^2 t)\\right)^2 = \\exp(-4\\nu k^2 t)\n$$\n对于早期时间（$t \\ll 1$），我们对小的 $x$ 使用泰勒展开 $\\exp(x) \\approx 1+x$：\n$$\n\\frac{E(t)}{E(0)} \\approx 1 - 4\\nu k^2 t + \\mathcal{O}(t^2)\n$$\n将其与指定形式 $\\frac{E(t)}{E(0)} = 1 + a_1 t + \\mathcal{O}(t^2)$ 进行比较，我们确定系数 $a_1$：\n$$\na_1 = -4\\nu k^2\n$$\n此结果与 $U_0$ 无关，符合要求。",
            "answer": "$$\\boxed{-4\\nu k^{2}}$$"
        },
        {
            "introduction": "最后，我们将从理论分析跃升到数值实现，聚焦于可压缩流动。求解可压缩纳维-斯托克斯方程的数值方法必须严格保证质量、动量和能量的守恒性。这个综合性练习将指导您从零开始，构建一个一维有限体积格式，通过精心设计交界面上的数值通量，确保离散方程的守恒性。这不仅是一次编程实践，更是对现代计算流体力学方法基石的深刻体验。",
            "id": "3377190",
            "problem": "您的任务是推导并实现一种用于可压缩纳维-斯托克斯方程的一维有限体积法，该方法通过共享面通量，在构造上对质量、动量和总能量是精确守恒的。推导必须从积分守恒律开始，并使用牛顿流体的本构关系、傅里叶热传导定律以及理想气体状态方程。您的程序将在具有周期性边界条件的均匀结构化网格上执行单个显式时间步，并报告机器精度级别的守恒诊断结果。所有量都是无量纲的，因此不需要物理单位。\n\n您必须基于以下基本原理：\n- 在控制体上对质量、动量和总能量的积分守恒律。设守恒变量向量为 $U = [\\rho, \\rho u, \\rho E]^{\\top}$，其中 $\\rho$ 是密度，$u$ 是速度，$E$ 是总比能。设无粘（对流）通量为 $F^{\\mathrm{c}}(U)$，粘性通量为 $F^{\\mathrm{v}}(\\nabla W)$，其中 $W$ 表示原始变量。在区域 $x \\in [0, L]$ 上，以单元索引 $j$ 为中心、宽度为 $\\Delta x$ 的控制体上的积分形式为\n$$\n\\frac{d}{dt}\\int_{V_j} U\\, dx + \\left.F^{\\mathrm{c}}\\right|_{x_{j+\\frac{1}{2}}} - \\left.F^{\\mathrm{c}}\\right|_{x_{j-\\frac{1}{2}}} = \\left.F^{\\mathrm{v}}\\right|_{x_{j+\\frac{1}{2}}} - \\left.F^{\\mathrm{v}}\\right|_{x_{j-\\frac{1}{2}}}.\n$$\n- 理想气体状态方程 $p = (\\gamma - 1)\\left(\\rho E - \\frac{1}{2}\\rho u^{2}\\right)$，其中 $p$ 是压力，$\\gamma$ 是比热比。温度为 $T = p/(\\rho R)$，其中 $R$ 是气体常数。\n- 一维情况下的牛顿粘性应力及斯托克斯假设：$\\tau_{xx} = \\frac{4}{3}\\mu \\frac{\\partial u}{\\partial x}$，其中 $\\mu$ 是动力粘度。傅里叶热传导定律：$q_x = -\\kappa \\frac{\\partial T}{\\partial x}$，其中 $\\kappa$ 是热导率。定压比热为 $c_p = \\frac{\\gamma R}{\\gamma - 1}$，且 $\\kappa = \\frac{\\mu c_p}{\\mathrm{Pr}}$，其中 $\\mathrm{Pr}$ 是普朗特数。\n- 一维空间中的无粘通量：\n$$\nF^{\\mathrm{c}}(U) = \n\\begin{bmatrix}\n\\rho u \\\\\n\\rho u^{2} + p \\\\\nu(\\rho E + p)\n\\end{bmatrix}.\n$$\n一维空间中的粘性通量：\n$$\nF^{\\mathrm{v}} = \n\\begin{bmatrix}\n0 \\\\\n\\tau_{xx} \\\\\nu\\,\\tau_{xx} - q_x\n\\end{bmatrix}.\n$$\n\n对您的离散设计和实现的要求：\n- 使用一个包含 $N$ 个有限体积的均匀网格覆盖 $[0, L]$，并采用周期性边界条件，从而使每个用于更新相邻单元的内部面通量大小相等、方向相反，保证内部贡献的精确对消求和。\n- 为无粘部分构造一个两点、相容、对称的数值界面通量，该通量增加与局部特征速度上限成正比的耗散。在实现中，每个面上的惩罚速度使用两个相邻状态的 $|u| + a$ 的最大值，其中 $a = \\sqrt{\\gamma p/\\rho}$ 是局部声速。此选择的应用方式必须确保对于两个相邻单元，面贡献是大小相等、方向相反的。\n- 通过由相邻单元值计算的中心面梯度来离散化粘性项，以形成面心的 $\\tau_{xx}$ 和 $q_x$，并对共享同一面的两个单元使用相同的面粘性通量向量，从而使粘性通量在内部面上也是大小相等、方向相反的。\n- 通过单个前向欧拉时间步推进求解，$U^{n+1}_j = U^n_j - \\frac{\\Delta t}{\\Delta x} \\left(\\widehat{F}^{\\mathrm{c}}_{j+\\frac{1}{2}} - \\widehat{F}^{\\mathrm{c}}_{j-\\frac{1}{2}}\\right) + \\frac{\\Delta t}{\\Delta x} \\left(F^{\\mathrm{v}}_{j+\\frac{1}{2}} - F^{\\mathrm{v}}_{j-\\frac{1}{2}}\\right)$，其中帽子符号表示面上的数值无粘通量。使用库朗-弗里德里希斯-路维数 $\\mathrm{CFL}$ 选择时间步长 $\\Delta t = \\mathrm{CFL}\\, \\Delta x / \\max_i \\left(|u_i| + a_i\\right)$。\n- 所有计算都是无量纲的。您必须实现所有需要的公式；不提供外部数据。\n\n测试套件和初始数据：\n- 使用区域长度 $L = 1$。对于每个测试，在单元中心 $x_i = \\left(i + \\frac{1}{2}\\right)\\Delta x$（$i = 0,\\dots,N-1$）处按如下方式初始化 $(\\rho, u, p)$。\n- 测试 A (光滑周期)：$N = 100$, $\\gamma = 1.4$, $R = 1$, $\\mu = 0.01$, $\\mathrm{Pr} = 0.72$, $\\mathrm{CFL} = 0.1$。初始化 $\\rho(x) = 1 + 0.1\\sin(2\\pi x)$, $u(x) = 0.3$, $p(x) = 1$。\n- 测试 B (均匀平衡)：$N = 64$, $\\gamma = 1.4$, $R = 1$, $\\mu = 0$, $\\mathrm{Pr} = 0.72$, $\\mathrm{CFL} = 0.2$。初始化 $\\rho(x) = 1$, $u(x) = 0$, $p(x) = 1$。\n- 测试 C (黎曼型阶跃)：$N = 200$, $\\gamma = 1.4$, $R = 1$, $\\mu = 0.001$, $\\mathrm{Pr} = 0.72$, $\\mathrm{CFL} = 0.05$。在 $x  0.5$ 上初始化左状态：$(\\rho, u, p) = (1, 0, 1)$；在 $x \\ge 0.5$ 上初始化右状态：$(\\rho, u, p) = (0.125, 0, 0.1)$。\n\n要求输出：\n- 对于每个测试，计算一个时间步前后的全局积分：$M = \\int_0^L \\rho\\, dx$, $P = \\int_0^L \\rho u\\, dx$, $E_{\\mathrm{tot}} = \\int_0^L \\rho E\\, dx$。使用与单元平均值一致的中点法则，即 $\\sum_j U_{j} \\Delta x$。\n- 对于每个测试，报告一个时间步后的绝对变化量 $\\left(|\\Delta M|, |\\Delta P|, |\\Delta E_{\\mathrm{tot}}|\\right)$，在十进制表示中四舍五入到 $10^{-12}$。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的、逗号分隔的 Python 风格列表，每个测试对应一个三元素列表，按 A、B、C 的顺序排列。例如，一个有效的格式是 $[[m_A,p_A,e_A],[m_B,p_B,e_B],[m_C,p_C,e_C]]$，其中每个条目都是一个十进制浮点数。\n\n您提交的必须是一个完整的、可运行的程序，执行这些计算并打印所要求的单行输出。不允许用户输入，也不得访问外部文件。",
            "solution": "用户提供了一个定义明确的计算流体力学问题。任务是推导并实现一个用于可压缩纳维-斯托克斯方程的一维有限体积法，验证其守恒特性，并报告一组给定测试用例的结果。该问题在科学上是合理的、自洽的，并且所有必要的参数和方程都已指定。\n\n推导和实现将按以下步骤进行。首先，在均匀的周期性网格上离散控制方程和本构关系。然后，最终的算法将使用 NumPy 库在 Python 中实现，以进行向量化计算。\n\n**1. 控制方程和状态变量**\n\n该系统由守恒形式的一维可压缩纳维-斯托克斯方程控制。守恒变量的向量是 $U = [\\rho, \\rho u, \\rho E]^{\\top}$，其中 $\\rho$ 是流体密度，$u$ 是速度，$E$ 是总比能。对于宽度为 $\\Delta x$ 的控制体 $V_j$，守恒律的积分形式为：\n$$\n\\frac{d}{dt}\\int_{V_j} U\\, dx + F_{j+\\frac{1}{2}} - F_{j-\\frac{1}{2}} = 0\n$$\n其中 $F = F^{\\mathrm{c}} - F^{\\mathrm{v}}$ 是总通量，由无粘（对流）部分 $F^{\\mathrm{c}}$ 和粘性部分 $F^{\\mathrm{v}}$ 组成。\n\n理想气体状态方程将压力 $p$ 与守恒量联系起来：\n$$\np = (\\gamma - 1)\\left(\\rho E - \\frac{1}{2}\\rho u^2\\right) = (\\gamma - 1)\\left(U_3 - \\frac{U_2^2}{2U_1}\\right)\n$$\n其中 $\\gamma$ 是比热比。要从原始变量 $(\\rho, u, p)$ 转换回守恒变量，我们使用：\n$$\nU = \\begin{bmatrix} \\rho \\\\ \\rho u \\\\ \\frac{p}{\\gamma - 1} + \\frac{1}{2}\\rho u^2 \\end{bmatrix}\n$$\n\n**2. 有限体积离散化**\n\n我们使用有限体积法，其中 $U_j$ 代表单元 $j$ 中守恒量的单元平均值。控制方程的半离散形式是：\n$$\n\\frac{dU_j}{dt} = -\\frac{1}{\\Delta x} \\left(\\widehat{F}_{j+\\frac{1}{2}} - \\widehat{F}_{j-\\frac{1}{2}}\\right)\n$$\n此处，$\\widehat{F}_{j+\\frac{1}{2}}$ 是单元 $j$ 和单元 $j+1$ 之间界面上的数值通量。该通量近似于物理通量，并由数值无粘和粘性分量组成：$\\widehat{F} = \\widehat{F}^{\\mathrm{c}} - \\widehat{F}^{\\mathrm{v}}$。\n\n**3. 数值无粘通量**\n\n问题指定了一种带有耗散的对称两点通量，这是 Rusanov（或局部 Lax-Friedrichs）格式的特征。在状态 $U_L = U_j$ 和 $U_R = U_{j+1}$ 之间的界面 $j+\\frac{1}{2}$ 处的数值通量为：\n$$\n\\widehat{F}^{\\mathrm{c}}_{j+\\frac{1}{2}} = \\frac{1}{2} \\left[ F^{\\mathrm{c}}(U_L) + F^{\\mathrm{c}}(U_R) \\right] - \\frac{1}{2} S_{j+\\frac{1}{2}} (U_R - U_L)\n$$\n物理通量 $F^{\\mathrm{c}}(U)$ 由下式给出：\n$$\nF^{\\mathrm{c}}(U) = \\begin{bmatrix} \\rho u \\\\ \\rho u^2 + p \\\\ u(\\rho E + p) \\end{bmatrix}\n$$\n耗散项 $S_{j+\\frac{1}{2}}$ 是一个数值波速，指定为界面处的最大特征速度：\n$$\nS_{j+\\frac{1}{2}} = \\max\\left( |u_L| + a_L, |u_R| + a_R \\right)\n$$\n其中 $a = \\sqrt{\\gamma p / \\rho}$ 是局部声速。这种公式确保了共享界面的两个单元的通量贡献大小相等、方向相反，从而形成一个守恒格式。\n\n**4. 数值粘性通量**\n\n粘性通量在单元界面 $j+\\frac{1}{2}$ 处使用中心差分进行离散化。物理粘性通量为：\n$$\nF^{\\mathrm{v}} = \\begin{bmatrix} 0 \\\\ \\tau_{xx} \\\\ u\\,\\tau_{xx} - q_x \\end{bmatrix}\n$$\n剪切应力 $\\tau_{xx}$ 和热通量 $q_x$ 在面上近似为：\n$$\n\\tau_{xx, j+\\frac{1}{2}} = \\frac{4}{3}\\mu \\left(\\frac{\\partial u}{\\partial x}\\right)_{j+\\frac{1}{2}} \\approx \\frac{4}{3}\\mu \\frac{u_{j+1} - u_j}{\\Delta x}\n$$\n$$\nq_{x, j+\\frac{1}{2}} = -\\kappa \\left(\\frac{\\partial T}{\\partial x}\\right)_{j+\\frac{1}{2}} \\approx -\\kappa \\frac{T_{j+1} - T_j}{\\Delta x}\n$$\n温度 $T$ 由理想气体定律 $T = p/(\\rho R)$ 导出，其中 $R$ 是气体常数。热导率 $\\kappa$ 通过普朗特数 $\\mathrm{Pr}$ 与动力粘度 $\\mu$ 相关联：$\\kappa = \\frac{\\mu c_p}{\\mathrm{Pr}}$，其中 $c_p = \\frac{\\gamma R}{\\gamma - 1}$。能量通量项中的速度 $u$ 在面上取平均值：$u_{j+\\frac{1}{2}} = \\frac{1}{2}(u_j + u_{j+1})$。这种中心化公式在构造上也是守恒的。\n\n**5. 时间积分和守恒性**\n\n系统通过单个前向欧拉步长推进：\n$$\nU^{n+1}_j = U^n_j - \\frac{\\Delta t}{\\Delta x} \\left(\\widehat{F}^{\\mathrm{c}}_{j+\\frac{1}{2}} - \\widehat{F}^{\\mathrm{c}}_{j-\\frac{1}{2}}\\right) + \\frac{\\Delta t}{\\Delta x} \\left(\\widehat{F}^{\\mathrm{v}}_{j+\\frac{1}{2}} - \\widehat{F}^{\\mathrm{v}}_{j-\\frac{1}{2}}\\right)\n$$\n时间步长 $\\Delta t$ 由库朗-弗里德里希斯-路维 (CFL) 条件确定：\n$$\n\\Delta t = \\mathrm{CFL} \\frac{\\Delta x}{\\max_j(|u_j| + a_j)}\n$$\n为检验守恒性，我们通过对单元平均量求和来计算区域上的总质量 $M$、总动量 $P$ 和总能量 $E_{\\mathrm{tot}}$：\n$$\n\\sum_j U_j \\Delta x = \\begin{bmatrix} M \\\\ P \\\\ E_{\\mathrm{tot}} \\end{bmatrix}\n$$\n由于周期性边界条件和守恒通量公式，整个区域上所有通量差值的总和形成一个值为零的对消求和。因此，$\\sum_j (U^{n+1}_j - U^n_j) = 0$。总守恒量应在浮点精度误差范围内保持恒定。问题要求计算这些总量的绝对变化来验证此属性。\n\n该实现将使用 NumPy 进行完全向量化。所有界面的左右状态将使用 `numpy.roll` 生成，以高效处理周期性边界。算法将遍历指定的测试用例，为每个用例执行一个时间步，并计算守恒诊断。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and implements a 1D finite volume method for compressible Navier-Stokes\n    and carries out a single explicit time step to report conservation diagnostics.\n    \"\"\"\n\n    test_cases = [\n        # Test A: Smooth periodic wave\n        {\n            \"name\": \"A\",\n            \"N\": 100, \"L\": 1.0, \"gamma\": 1.4, \"R\": 1.0,\n            \"mu\": 0.01, \"Pr\": 0.72, \"CFL\": 0.1,\n            \"ic_type\": \"function\",\n            \"ic_func\": lambda x: (1.0 + 0.1 * np.sin(2 * np.pi * x), 0.3, 1.0)\n        },\n        # Test B: Uniform equilibrium\n        {\n            \"name\": \"B\",\n            \"N\": 64, \"L\": 1.0, \"gamma\": 1.4, \"R\": 1.0,\n            \"mu\": 0.0, \"Pr\": 0.72, \"CFL\": 0.2,\n            \"ic_type\": \"function\",\n            \"ic_func\": lambda x: (1.0, 0.0, 1.0)\n        },\n        # Test C: Riemann-type step\n        {\n            \"name\": \"C\",\n            \"N\": 200, \"L\": 1.0, \"gamma\": 1.4, \"R\": 1.0,\n            \"mu\": 0.001, \"Pr\": 0.72, \"CFL\": 0.05,\n            \"ic_type\": \"riemann\",\n            \"ic_states\": {\"L\": (1.0, 0.0, 1.0), \"R\": (0.125, 0.0, 0.1), \"split\": 0.5}\n        }\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        # Unpack parameters\n        N, L, gamma, R = case[\"N\"], case[\"L\"], case[\"gamma\"], case[\"R\"]\n        mu, Pr, CFL = case[\"mu\"], case[\"Pr\"], case[\"CFL\"]\n\n        # Grid setup\n        dx = L / N\n        x = (np.arange(N) + 0.5) * dx\n\n        # Initial conditions\n        rho, u, p = np.zeros(N), np.zeros(N), np.zeros(N)\n        if case[\"ic_type\"] == \"function\":\n            rho_vals, u_vals, p_vals = case[\"ic_func\"](x)\n            rho = rho_vals if isinstance(rho_vals, np.ndarray) else np.full(N, rho_vals)\n            u = u_vals if isinstance(u_vals, np.ndarray) else np.full(N, u_vals)\n            p = p_vals if isinstance(p_vals, np.ndarray) else np.full(N, p_vals)\n        elif case[\"ic_type\"] == \"riemann\":\n            split_pos = case[\"ic_states\"][\"split\"]\n            mask_L = x  split_pos\n            mask_R = x = split_pos\n            rho[mask_L], u[mask_L], p[mask_L] = case[\"ic_states\"][\"L\"]\n            rho[mask_R], u[mask_R], p[mask_R] = case[\"ic_states\"][\"R\"]\n            \n        # Helper functions\n        def primitives_to_conserved(rho, u, p, gamma):\n            rho_u = rho * u\n            rho_E = p / (gamma - 1.0) + 0.5 * rho * u**2\n            return np.array([rho, rho_u, rho_E])\n\n        def conserved_to_primitives(U, gamma, R):\n            rho = U[0]\n            # Add a small epsilon to rho to prevent division by zero in vacuum-like states\n            u = U[1] / (rho + 1e-100)\n            rho_E = U[2]\n            # Ensure internal energy is non-negative\n            internal_energy_density = rho_E - 0.5 * rho * u**2\n            internal_energy_density = np.maximum(internal_energy_density, 1e-100)\n            p = (gamma - 1.0) * internal_energy_density\n            T = p / ((rho + 1e-100) * R)\n            a = np.sqrt(gamma * p / (rho + 1e-100))\n            return rho, u, p, T, a\n\n        # Initial state and total quantities\n        U = primitives_to_conserved(rho, u, p, gamma)\n        total_initial = np.sum(U, axis=1) * dx\n\n        # --- Single Time Step Calculation ---\n        \n        # 1. Decode primitives from conserved state U\n        rho, u, p, T, a = conserved_to_primitives(U, gamma, R)\n        \n        # 2. Calculate time step dt\n        max_wave_speed = np.max(np.abs(u) + a)\n        dt = CFL * dx / max_wave_speed\n        \n        # 3. Prepare left and right states at interfaces using periodic boundaries\n        U_L = U\n        U_R = np.roll(U, -1, axis=1)\n        rho_L, u_L, p_L, T_L, a_L = conserved_to_primitives(U_L, gamma, R)\n        rho_R, u_R, p_R, T_R, a_R = conserved_to_primitives(U_R, gamma, R)\n        \n        # 4. Compute numerical inviscid flux (Rusanov)\n        def get_inviscid_flux(rho, u, p, U):\n            rho_u = U[1]\n            rho_E = U[2]\n            return np.array([rho_u, rho_u * u + p, u * (rho_E + p)])\n\n        Fc_L = get_inviscid_flux(rho_L, u_L, p_L, U_L)\n        Fc_R = get_inviscid_flux(rho_R, u_R, p_R, U_R)\n        \n        S = np.maximum(np.abs(u_L) + a_L, np.abs(u_R) + a_R)\n        Fc_num = 0.5 * (Fc_L + Fc_R) - 0.5 * S[np.newaxis, :] * (U_R - U_L)\n        \n        # 5. Compute numerical viscous flux\n        Fv_num = np.zeros_like(U)\n        if mu > 0:\n            cp = gamma * R / (gamma - 1.0)\n            kappa = mu * cp / Pr\n            dudx = (u_R - u_L) / dx\n            dTdx = (T_R - T_L) / dx\n            tau_xx = (4.0/3.0) * mu * dudx\n            q_x = -kappa * dTdx\n            u_face = 0.5 * (u_L + u_R)\n            Fv_num[1, :] = tau_xx\n            Fv_num[2, :] = u_face * tau_xx - q_x\n\n        # 6. Total numerical flux and RHS computation\n        F_total_num = Fc_num - Fv_num\n        F_total_num_shifted = np.roll(F_total_num, 1, axis=1) # Fluxes at j-1/2 faces\n        RHS = -(1.0 / dx) * (F_total_num - F_total_num_shifted)\n        \n        # 7. Update solution with Forward Euler\n        U_final = U + dt * RHS\n        \n        # --- End of time step ---\n\n        # Final total quantities and conservation check\n        total_final = np.sum(U_final, axis=1) * dx\n        changes = np.abs(total_final - total_initial)\n        rounded_changes = [round(c, 12) for c in changes]\n        all_results.append(rounded_changes)\n        \n    print(f\"{all_results}\")\n\nsolve()\n```"
        }
    ]
}