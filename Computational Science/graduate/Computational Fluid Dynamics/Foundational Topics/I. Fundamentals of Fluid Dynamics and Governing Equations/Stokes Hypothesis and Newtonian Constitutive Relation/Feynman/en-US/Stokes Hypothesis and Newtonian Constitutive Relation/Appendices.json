{
    "hands_on_practices": [
        {
            "introduction": "The Newtonian constitutive relation can be expressed in multiple, equivalent forms. While one form may use the second viscosity coefficient $\\lambda$, another might use the bulk viscosity $\\zeta$. This exercise solidifies your understanding of the mathematical relationship between these parameterizations by asking you to prove their equivalence directly. More importantly, it translates this theoretical knowledge into a practical software engineering task: designing a unit test to verify that both formulations produce identical results in a CFD code, a crucial step for ensuring numerical robustness. ",
            "id": "3366559",
            "problem": "Consider a compressible, isotropic, Newtonian fluid modeled within Computational Fluid Dynamics (CFD). Let the Cauchy stress tensor be decomposed as $\\boldsymbol{\\sigma} = -p \\boldsymbol{I} + \\boldsymbol{\\tau}$, where $p$ is thermodynamic pressure, $\\boldsymbol{I}$ is the identity tensor, and $\\boldsymbol{\\tau}$ is the viscous stress. For a Newtonian fluid, $\\boldsymbol{\\tau}$ is a linear, objective, isotropic tensor function of the local rate-of-deformation tensor $\\boldsymbol{D}$, where $\\boldsymbol{D} = \\frac{1}{2}\\left(\\nabla \\boldsymbol{u} + \\nabla \\boldsymbol{u}^{\\top}\\right)$, $\\nabla \\boldsymbol{u}$ is the velocity gradient, and $\\boldsymbol{u}$ is the velocity field. Define the deviatoric part of the rate-of-deformation as $\\boldsymbol{D}' = \\boldsymbol{D} - \\frac{1}{3}\\left(\\nabla \\cdot \\boldsymbol{u}\\right)\\boldsymbol{I}$.\n\nStarting from the requirements of linearity, frame indifference (objectivity), and isotropy of the constitutive mapping $\\boldsymbol{D} \\mapsto \\boldsymbol{\\tau}$, derive a deviatoric-plus-isotropic representation of $\\boldsymbol{\\tau}$ parameterized by shear viscosity $\\mu$ and bulk viscosity $\\zeta$, and show its equivalence to an alternative parameterization by shear viscosity $\\mu$ and the second viscosity coefficient $\\lambda$. From first principles, obtain an analytic expression for $\\lambda$ in terms of $\\mu$ and $\\zeta$. Briefly comment on how the Stokes hypothesis constrains $\\lambda$ and $\\zeta$.\n\nThen, to design a robust unit test for a CFD code, consider the following specific input at a point in the flow:\n- Shear viscosity $\\mu = 1.7 \\times 10^{-5}$ in $\\mathrm{Pa \\cdot s}$.\n- Bulk viscosity $\\zeta = 3.1 \\times 10^{-5}$ in $\\mathrm{Pa \\cdot s}$.\n- Velocity gradient\n$$\n\\nabla \\boldsymbol{u} = \n\\begin{pmatrix}\n1.2 & -0.5 & 0.3 \\\\\n0.4 & -0.8 & 1.1 \\\\\n0.0 & -1.3 & 0.6\n\\end{pmatrix}\n\\ \\text{in } \\mathrm{s}^{-1}.\n$$\nDesign a unit test that computes $\\boldsymbol{\\tau}$ in two ways: (i) using the deviatoric-plus-bulk-viscosity representation, and (ii) using the $(\\mu,\\lambda)$ representation. The test should take the Frobenius norm of the difference of the two stress tensors as the metric,\n$$\n\\|\\Delta \\boldsymbol{\\tau}\\|_{F} = \\left(\\sum_{i=1}^{3}\\sum_{j=1}^{3} \\left[\\tau^{(\\zeta)}_{ij} - \\tau^{(\\lambda)}_{ij}\\right]^{2}\\right)^{\\frac{1}{2}},\n$$\nand assert that this norm is within machine tolerance of zero. For the given numerical data, compute $\\|\\Delta \\boldsymbol{\\tau}\\|_{F}$ and express your result in $\\mathrm{Pa}$. Round your numerical answer to four significant figures.\n\nReport your final answer as a two-entry row vector, where the first entry is the analytic expression for $\\lambda$ in terms of $\\mu$ and $\\zeta$, and the second entry is the computed value of $\\|\\Delta \\boldsymbol{\\tau}\\|_{F}$ in $\\mathrm{Pa}$ (units should not be placed in the final boxed answer).",
            "solution": "We begin by recalling the foundational principles that constrain the constitutive law for a Newtonian fluid. The viscous stress $\\boldsymbol{\\tau}$ depends linearly on the local kinematics, specifically the symmetric part of the velocity gradient $\\boldsymbol{D} = \\frac{1}{2}\\left(\\nabla \\boldsymbol{u} + \\nabla \\boldsymbol{u}^{\\top}\\right)$. Objectivity (frame indifference) requires that $\\boldsymbol{\\tau}$ depend on $\\boldsymbol{D}$ and not on the antisymmetric part, and isotropy requires that the mapping from $\\boldsymbol{D}$ to $\\boldsymbol{\\tau}$ be expressible in terms of the scalar invariants of $\\boldsymbol{D}$ and the isotropic tensors constructed from $\\boldsymbol{D}$ and $\\boldsymbol{I}$.\n\nFor a linear isotropic mapping, the most general form is\n$$\n\\boldsymbol{\\tau} = 2\\mu \\boldsymbol{D} + \\lambda \\left(\\nabla \\cdot \\boldsymbol{u}\\right)\\boldsymbol{I},\n$$\nwhere $\\mu$ is the shear viscosity and $\\lambda$ is the second viscosity coefficient. This is a standard result obtained by noting that the linear isotropic tensor function of a symmetric second-order tensor must be a linear combination of $\\boldsymbol{D}$ and $\\boldsymbol{I}\\,\\mathrm{tr}(\\boldsymbol{D})$.\n\nIntroduce the deviatoric decomposition\n$$\n\\boldsymbol{D}' = \\boldsymbol{D} - \\frac{1}{3}\\left(\\nabla \\cdot \\boldsymbol{u}\\right)\\boldsymbol{I}, \\qquad \\mathrm{tr}(\\boldsymbol{D}') = 0.\n$$\nThen\n$$\n\\boldsymbol{D} = \\boldsymbol{D}' + \\frac{1}{3}\\left(\\nabla \\cdot \\boldsymbol{u}\\right)\\boldsymbol{I}.\n$$\nSubstitute this into the $(\\mu,\\lambda)$ representation:\n\\begin{align*}\n\\boldsymbol{\\tau}\n&= 2\\mu\\left(\\boldsymbol{D}' + \\frac{1}{3}\\left(\\nabla \\cdot \\boldsymbol{u}\\right)\\boldsymbol{I}\\right) + \\lambda \\left(\\nabla \\cdot \\boldsymbol{u}\\right)\\boldsymbol{I} \\\\\n&= 2\\mu \\boldsymbol{D}' + \\left(\\lambda + \\frac{2}{3}\\mu\\right)\\left(\\nabla \\cdot \\boldsymbol{u}\\right)\\boldsymbol{I}.\n\\end{align*}\nDefine the bulk viscosity $\\zeta$ as the coefficient multiplying the isotropic part $\\left(\\nabla \\cdot \\boldsymbol{u}\\right)\\boldsymbol{I}$ when the stress is expressed in deviatoric-plus-isotropic form. That is,\n$$\n\\boldsymbol{\\tau} = 2\\mu \\boldsymbol{D}' + \\zeta \\left(\\nabla \\cdot \\boldsymbol{u}\\right)\\boldsymbol{I}.\n$$\nEquating coefficients of $\\left(\\nabla \\cdot \\boldsymbol{u}\\right)\\boldsymbol{I}$ in the two representations gives\n$$\n\\zeta = \\lambda + \\frac{2}{3}\\mu \\quad \\Longleftrightarrow \\quad \\lambda = \\zeta - \\frac{2}{3}\\mu.\n$$\nThis is the sought analytic relation between $\\lambda$, $\\mu$, and $\\zeta$. Under the Stokes hypothesis, the bulk viscosity is hypothesized to vanish, i.e., $\\zeta = 0$, which implies\n$$\n\\lambda = -\\frac{2}{3}\\mu.\n$$\n\nWe now design and evaluate the unit test. The input data are:\n$$\n\\mu = 1.7 \\times 10^{-5}\\ \\mathrm{Pa \\cdot s}, \\qquad \\zeta = 3.1 \\times 10^{-5}\\ \\mathrm{Pa \\cdot s},\n$$\nand\n$$\n\\nabla \\boldsymbol{u} =\n\\begin{pmatrix}\n1.2 & -0.5 & 0.3 \\\\\n0.4 & -0.8 & 1.1 \\\\\n0.0 & -1.3 & 0.6\n\\end{pmatrix}\n\\ \\mathrm{s}^{-1}.\n$$\nCompute the symmetric rate-of-deformation:\n\\begin{align*}\n\\boldsymbol{D} &= \\frac{1}{2}\\left(\\nabla \\boldsymbol{u} + \\nabla \\boldsymbol{u}^{\\top}\\right) \\\\\n&= \\frac{1}{2}\n\\begin{pmatrix}\n1.2+1.2 & -0.5+0.4 & 0.3+0.0 \\\\\n0.4-0.5 & -0.8-0.8 & 1.1-1.3 \\\\\n0.0+0.3 & -1.3+1.1 & 0.6+0.6\n\\end{pmatrix} \\\\\n&=\n\\begin{pmatrix}\n1.2 & -0.05 & 0.15 \\\\\n-0.05 & -0.8 & -0.1 \\\\\n0.15 & -0.1 & 0.6\n\\end{pmatrix}\n\\ \\mathrm{s}^{-1}.\n\\end{align*}\nThe divergence of velocity is the trace of $\\nabla \\boldsymbol{u}$ (and also of $\\boldsymbol{D}$):\n$$\n\\nabla \\cdot \\boldsymbol{u} = \\mathrm{tr}(\\nabla \\boldsymbol{u}) = 1.2 + (-0.8) + 0.6 = 1.0\\ \\mathrm{s}^{-1}.\n$$\nThe deviatoric part is\n\\begin{align*}\n\\boldsymbol{D}' &= \\boldsymbol{D} - \\frac{1}{3}\\left(\\nabla \\cdot \\boldsymbol{u}\\right)\\boldsymbol{I} \\\\\n&=\n\\begin{pmatrix}\n1.2 - \\frac{1}{3} & -0.05 & 0.15 \\\\\n-0.05 & -0.8 - \\frac{1}{3} & -0.1 \\\\\n0.15 & -0.1 & 0.6 - \\frac{1}{3}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\frac{13}{15} & -0.05 & 0.15 \\\\\n-0.05 & -\\frac{17}{15} & -0.1 \\\\\n0.15 & -0.1 & \\frac{4}{15}\n\\end{pmatrix}\n\\ \\mathrm{s}^{-1},\n\\end{align*}\nwhere we have expressed the diagonal entries exactly: $1.2 - \\frac{1}{3} = \\frac{13}{15}$, $-0.8 - \\frac{1}{3} = -\\frac{17}{15}$, and $0.6 - \\frac{1}{3} = \\frac{4}{15}$.\n\nCompute the stress via the deviatoric-plus-bulk-viscosity representation:\n\\begin{align*}\n\\boldsymbol{\\tau}^{(\\zeta)} &= 2\\mu \\boldsymbol{D}' + \\zeta \\left(\\nabla \\cdot \\boldsymbol{u}\\right)\\boldsymbol{I} \\\\\n&= 2\\mu \\boldsymbol{D}' + \\zeta \\boldsymbol{I} \\\\\n&=\n\\begin{pmatrix}\n2\\mu \\cdot \\frac{13}{15} + \\zeta & 2\\mu \\cdot (-0.05) & 2\\mu \\cdot 0.15 \\\\\n2\\mu \\cdot (-0.05) & 2\\mu \\cdot \\left(-\\frac{17}{15}\\right) + \\zeta & 2\\mu \\cdot (-0.1) \\\\\n2\\mu \\cdot 0.15 & 2\\mu \\cdot (-0.1) & 2\\mu \\cdot \\frac{4}{15} + \\zeta\n\\end{pmatrix}.\n\\end{align*}\nCompute the stress via the $(\\mu,\\lambda)$ representation, using the derived relation $\\lambda = \\zeta - \\frac{2}{3}\\mu$:\n\\begin{align*}\n\\lambda &= \\zeta - \\frac{2}{3}\\mu, \\\\\n\\boldsymbol{\\tau}^{(\\lambda)} &= 2\\mu \\boldsymbol{D} + \\lambda \\left(\\nabla \\cdot \\boldsymbol{u}\\right)\\boldsymbol{I} = 2\\mu \\boldsymbol{D} + \\lambda \\boldsymbol{I} \\\\\n&=\n\\begin{pmatrix}\n2\\mu \\cdot 1.2 + \\lambda & 2\\mu \\cdot (-0.05) & 2\\mu \\cdot 0.15 \\\\\n2\\mu \\cdot (-0.05) & 2\\mu \\cdot (-0.8) + \\lambda & 2\\mu \\cdot (-0.1) \\\\\n2\\mu \\cdot 0.15 & 2\\mu \\cdot (-0.1) & 2\\mu \\cdot 0.6 + \\lambda\n\\end{pmatrix}.\n\\end{align*}\nTo verify equality, rewrite $2\\mu \\boldsymbol{D}$ as $2\\mu \\left(\\boldsymbol{D}' + \\frac{1}{3}(\\nabla \\cdot \\boldsymbol{u})\\boldsymbol{I}\\right)$, giving\n\\begin{align*}\n\\boldsymbol{\\tau}^{(\\lambda)}\n&= 2\\mu \\boldsymbol{D}' + \\left(\\frac{2}{3}\\mu + \\lambda\\right)\\boldsymbol{I} \\\\\n&= 2\\mu \\boldsymbol{D}' + \\zeta \\boldsymbol{I} \\\\\n&= \\boldsymbol{\\tau}^{(\\zeta)}.\n\\end{align*}\nThus, analytically they are identical for any $\\boldsymbol{D}$, $\\mu$, and $\\zeta$ satisfying the relation $\\lambda = \\zeta - \\frac{2}{3}\\mu$.\n\nFor the numerical unit test, substitute the given values. First compute $2\\mu$:\n$$\n2\\mu = 2 \\times \\left(1.7 \\times 10^{-5}\\right) = 3.4 \\times 10^{-5}\\ \\mathrm{Pa \\cdot s}.\n$$\nCompute $\\lambda$:\n$$\n\\lambda = \\zeta - \\frac{2}{3}\\mu = \\left(3.1 \\times 10^{-5}\\right) - \\frac{2}{3}\\left(1.7 \\times 10^{-5}\\right)\n= 3.1 \\times 10^{-5} - 1.133333\\ldots \\times 10^{-5} = 1.966666\\ldots \\times 10^{-5}\\ \\mathrm{Pa \\cdot s}.\n$$\nForm $\\boldsymbol{\\tau}^{(\\zeta)}$ and $\\boldsymbol{\\tau}^{(\\lambda)}$ componentwise. Off-diagonal components coincide because $\\boldsymbol{D}'$ and $\\boldsymbol{D}$ share the same off-diagonal entries:\n\\begin{align*}\n\\tau^{(\\zeta)}_{12} &= \\tau^{(\\lambda)}_{12} = 2\\mu \\cdot (-0.05) = -1.7 \\times 10^{-6}, \\\\\n\\tau^{(\\zeta)}_{13} &= \\tau^{(\\lambda)}_{13} = 2\\mu \\cdot 0.15 = 5.1 \\times 10^{-6}, \\\\\n\\tau^{(\\zeta)}_{23} &= \\tau^{(\\lambda)}_{23} = 2\\mu \\cdot (-0.1) = -3.4 \\times 10^{-6},\n\\end{align*}\nand the symmetric counterparts match as well.\n\nFor the diagonals,\n\\begin{align*}\n\\tau^{(\\zeta)}_{11} &= 2\\mu \\cdot \\frac{13}{15} + \\zeta = \\left(3.4 \\times 10^{-5}\\right)\\cdot 0.866666\\ldots + 3.1 \\times 10^{-5} \\\\\n&= 2.946666\\ldots \\times 10^{-5} + 3.1 \\times 10^{-5} = 6.046666\\ldots \\times 10^{-5}, \\\\\n\\tau^{(\\lambda)}_{11} &= 2\\mu \\cdot 1.2 + \\lambda = \\left(3.4 \\times 10^{-5}\\right)\\cdot 1.2 + 1.966666\\ldots \\times 10^{-5} \\\\\n&= 4.08 \\times 10^{-5} + 1.966666\\ldots \\times 10^{-5} = 6.046666\\ldots \\times 10^{-5}.\n\\end{align*}\nSimilarly,\n\\begin{align*}\n\\tau^{(\\zeta)}_{22} &= 2\\mu \\cdot \\left(-\\frac{17}{15}\\right) + \\zeta = \\left(3.4 \\times 10^{-5}\\right)\\cdot (-1.133333\\ldots) + 3.1 \\times 10^{-5} \\\\\n&= -3.853333\\ldots \\times 10^{-5} + 3.1 \\times 10^{-5} = -7.533333\\ldots \\times 10^{-6}, \\\\\n\\tau^{(\\lambda)}_{22} &= 2\\mu \\cdot (-0.8) + \\lambda = -2.72 \\times 10^{-5} + 1.966666\\ldots \\times 10^{-5} = -7.533333\\ldots \\times 10^{-6}.\n\\end{align*}\nAnd\n\\begin{align*}\n\\tau^{(\\zeta)}_{33} &= 2\\mu \\cdot \\frac{4}{15} + \\zeta = \\left(3.4 \\times 10^{-5}\\right)\\cdot 0.266666\\ldots + 3.1 \\times 10^{-5} \\\\\n&= 9.066666\\ldots \\times 10^{-6} + 3.1 \\times 10^{-5} = 4.006666\\ldots \\times 10^{-5}, \\\\\n\\tau^{(\\lambda)}_{33} &= 2\\mu \\cdot 0.6 + \\lambda = 2.04 \\times 10^{-5} + 1.966666\\ldots \\times 10^{-5} = 4.006666\\ldots \\times 10^{-5}.\n\\end{align*}\nTherefore, $\\boldsymbol{\\tau}^{(\\zeta)} = \\boldsymbol{\\tau}^{(\\lambda)}$ exactly for the given data, and the Frobenius norm of the difference is\n$$\n\\|\\Delta \\boldsymbol{\\tau}\\|_{F} = 0.\n$$\n\nUnit test design: a general-purpose unit test should (i) generate or take a prescribed $\\nabla \\boldsymbol{u}$, (ii) compute $\\boldsymbol{D}$ and $\\boldsymbol{D}'$, (iii) form $\\boldsymbol{\\tau}^{(\\zeta)} = 2\\mu \\boldsymbol{D}' + \\zeta (\\nabla \\cdot \\boldsymbol{u})\\boldsymbol{I}$ and $\\boldsymbol{\\tau}^{(\\lambda)} = 2\\mu \\boldsymbol{D} + \\lambda (\\nabla \\cdot \\boldsymbol{u})\\boldsymbol{I}$ with $\\lambda = \\zeta - \\frac{2}{3}\\mu$, (iv) compute $\\|\\Delta \\boldsymbol{\\tau}\\|_{F}$, and (v) assert that $\\|\\Delta \\boldsymbol{\\tau}\\|_{F} \\leq \\varepsilon$ for a small tolerance $\\varepsilon$ appropriate to floating-point arithmetic. For the specific numerical case provided, the exact analytic equality yields $\\|\\Delta \\boldsymbol{\\tau}\\|_{F} = 0$. Expressed in $\\mathrm{Pa}$ and rounded to four significant figures, this is $0$.",
            "answer": "$$\\boxed{\\begin{pmatrix}\\zeta - \\frac{2}{3}\\mu & 0\\end{pmatrix}}$$"
        },
        {
            "introduction": "Beyond the mathematical formalism, the choice of viscous model has direct physical consequences, particularly in compressible flows. While the Stokes hypothesis simplifies the model by setting the bulk viscosity $\\zeta$ to zero, this property is responsible for damping compressional motion. This practice delves into the physics of wave propagation in a viscous fluid, asking you to derive and quantify how bulk viscosity contributes to the attenuation of acoustic waves, while simultaneously showing it has no effect on the diffusion of a contact discontinuity. ",
            "id": "3366586",
            "problem": "You are asked to analyze a one-dimensional viscous Riemann problem for a compressible fluid governed by the conservation of mass, momentum, and energy, coupled with the Newtonian constitutive relation augmented by a nonzero bulk viscosity. Begin from the following fundamental base:\n- Conservation of mass: $\\partial_t \\rho + \\partial_x (\\rho u) = 0$.\n- Conservation of momentum: $\\partial_t (\\rho u) + \\partial_x (\\rho u^2 + p) = \\partial_x \\tau_{xx}$.\n- Conservation of energy in terms of temperature with Fourier heat conduction: $\\rho c_v \\left( \\partial_t T + u \\partial_x T \\right) + p \\partial_x u = \\partial_x \\left( \\kappa \\partial_x T \\right)$.\n- Ideal gas equation of state: $p = \\rho R T$, with $\\gamma = c_p / c_v$.\n- Newtonian constitutive relation with bulk viscosity: $\\boldsymbol{\\tau} = 2 \\mu \\boldsymbol{S} + \\left( \\zeta - \\tfrac{2}{3} \\mu \\right) (\\nabla \\cdot \\boldsymbol{u}) \\boldsymbol{I}$, where $\\mu$ is the shear viscosity and $\\zeta$ is the bulk viscosity. In one dimension, this yields $\\partial_x \\tau_{xx} = \\left( \\tfrac{4}{3} \\mu + \\zeta \\right) \\partial_{xx} u$. The Stokes hypothesis is the special case $\\zeta = 0$.\n\nLinearize these equations about a uniform equilibrium state $(\\rho_0, u_0, p_0, T_0)$ with $u_0 = 0$, consider small perturbations $(\\rho', u', p', T')$, and restrict attention to plane-wave and step-like initial disturbances. Under the linearized model:\n1) Show that the entropy (contact) mode is isobaric to leading order and reduces to a pure thermal diffusion process for $T'$ with thermal diffusivity $\\alpha_T = \\kappa / (\\rho_0 c_p)$. For an initial contact discontinuity (a jump in $\\rho$ and $T$ that keeps $p$ continuous), define the contact thickness as the $10\\text{–}90$ transition width of the error-function profile. Derive that this width is\n$$\nL_{10\\text{–}90}(t) = 4\\, \\mathrm{erf}^{-1}(0.8)\\, \\sqrt{\\alpha_T t},\n$$\nand justify whether or not it depends on the bulk viscosity $\\zeta$.\n\n2) For the acoustic mode, derive the small-dissipation dispersion relation for a plane wave of wavenumber $k$, and show that the complex angular frequency has an imaginary part\n$$\n\\omega_i = \\frac{k^2}{2} \\left( \\frac{\\tfrac{4}{3}\\mu + \\zeta}{\\rho_0} + (\\gamma - 1)\\, \\frac{\\kappa}{\\rho_0 c_p} \\right),\n$$\nso that a sinusoidal pressure perturbation $p'(x,0) = \\hat{p}_0 \\cos(k x)$ decays in time as $\\hat{p}(t) = \\hat{p}_0 \\exp(-\\omega_i t)$, where the amplitude decay factor is $\\exp(-\\omega_i t)$. Explain explicitly how $\\zeta$ influences this damping.\n\nYour program must implement the formulas you derive to compute, for each test case, two outputs:\n- The contact thickness $L_{10\\text{–}90}(t)$ in meters, to be reported in $\\mathrm{m}$.\n- The pressure-oscillation amplitude decay factor $\\exp(-\\omega_i t)$ as a decimal (unitless).\n\nAssume the following constant material parameters (representative of air at standard conditions):\n- $\\rho_0 = 1.0$ (in $\\mathrm{kg/m^3}$),\n- $\\mu = 1.8 \\times 10^{-5}$ (in $\\mathrm{Pa \\cdot s}$),\n- $\\kappa = 0.026$ (in $\\mathrm{W/(m \\cdot K)}$),\n- $c_p = 1005.0$ (in $\\mathrm{J/(kg \\cdot K)}$),\n- $\\gamma = 1.4$ (dimensionless).\n\nUse the thermal diffusivity $\\alpha_T = \\kappa / (\\rho_0 c_p)$ and the dissipation combination $A = \\tfrac{4}{3} \\mu + \\zeta$ in your calculations.\n\nTest Suite (each test case specifies $(t, k, \\zeta)$):\n- Case $1$ (Stokes hypothesis baseline): $t = 0.01$ (in $\\mathrm{s}$), $k = 500.0$ (in $\\mathrm{m^{-1}}$), $\\zeta = 0.0$ (in $\\mathrm{Pa \\cdot s}$).\n- Case $2$ (increased bulk viscosity): $t = 0.01$ (in $\\mathrm{s}$), $k = 500.0$ (in $\\mathrm{m^{-1}}$), $\\zeta = 2.0 \\times 10^{-4}$ (in $\\mathrm{Pa \\cdot s}$).\n- Case $3$ (higher wavenumber, Stokes hypothesis): $t = 0.01$ (in $\\mathrm{s}$), $k = 1500.0$ (in $\\mathrm{m^{-1}}$), $\\zeta = 0.0$ (in $\\mathrm{Pa \\cdot s}$).\n- Case $4$ (shorter time with increased bulk viscosity): $t = 0.001$ (in $\\mathrm{s}$), $k = 500.0$ (in $\\mathrm{m^{-1}}$), $\\zeta = 2.0 \\times 10^{-4}$ (in $\\mathrm{Pa \\cdot s}$).\n\nYour program should compute, for each case, the pair $[L_{10\\text{–}90}(t), \\exp(-\\omega_i t)]$ with $L_{10\\text{–}90}(t)$ in $\\mathrm{m}$ and the amplitude factor unitless. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is a two-element list for a test case, in the same order as the cases above. For example: \"[[result_case1_thickness,result_case1_decay],[result_case2_thickness,result_case2_decay],...]\".",
            "solution": "The problem statement is a valid exercise in theoretical fluid dynamics, grounded in the established principles of the Navier-Stokes equations for a compressible, viscous, and heat-conducting ideal gas. All provided equations, constants, and problem parameters are scientifically sound, consistent, and well-defined. We may therefore proceed with the derivation and solution.\n\nThe analysis hinges on linearizing the governing equations about a quiescent, uniform equilibrium state $(\\rho_0, u_0, p_0, T_0)$ where the velocity $u_0=0$. We introduce small perturbations denoted by a prime: $\\rho = \\rho_0 + \\rho'$, $u = u'$, $p = p_0 + p'$, and $T = T_0 + T'$. Retaining only first-order terms in these perturbations yields the following linearized system of equations:\n\n1.  **Conservation of Mass:**\n    $$ \\partial_t \\rho' + \\rho_0 \\partial_x u' = 0 $$\n2.  **Conservation of Momentum:**\n    $$ \\rho_0 \\partial_t u' + \\partial_x p' = \\left( \\frac{4}{3}\\mu + \\zeta \\right) \\partial_{xx} u' $$\n3.  **Equation of State (Ideal Gas):**\n    $$ \\frac{p'}{p_0} = \\frac{\\rho'}{\\rho_0} + \\frac{T'}{T_0} $$\n4.  **Conservation of Energy:** To properly isolate the effects of thermal diffusion, it is most clarifying to begin with the transport equation for entropy, $S$. For a fluid element, $\\rho T \\frac{DS}{Dt} = \\Phi + \\nabla \\cdot (\\kappa \\nabla T)$, where $\\Phi = \\tau_{ij} \\partial_j u_i$ is the viscous dissipation function. In the linearized system, $\\Phi$ is of second order in perturbations and may be neglected. The linearized entropy equation about a state with $u_0=0$ is thus $\\rho_0 T_0 \\partial_t S' = \\kappa \\partial_{xx} T'$. For an ideal gas, a small change in entropy $S'$ is related to changes in temperature $T'$ and pressure $p'$ by $S' = \\frac{c_p}{T_0} T' - \\frac{R}{p_0} p'$.\n\nWith these linearized equations, we analyze the two distinct modes of disturbance propagation as requested.\n\n### 1. Entropy (Contact) Mode\n\nThe entropy mode, which corresponds to a contact discontinuity in the non-dissipative limit, is characterized by having zero pressure and velocity perturbations to leading order, i.e., $p' \\approx 0$ and $u' \\approx 0$. Let us verify this structure.\n- If $u'=0$ and $p'=0$, the momentum equation is trivially satisfied.\n- The mass conservation equation becomes $\\partial_t \\rho' = 0$, indicating that density perturbations do not propagate, but simply persist or diffuse.\n- The linearized equation of state with $p' = 0$ yields the characteristic relation for the entropy mode: $\\frac{\\rho'}{\\rho_0} = -\\frac{T'}{T_0}$.\n- The linearized entropy transport equation is the key. Since $p' \\approx 0$, the entropy perturbation simplifies to $S' \\approx \\frac{c_p}{T_0} T'$. Substituting this into the linearized entropy transport equation gives:\n$$ \\rho_0 T_0 \\partial_t \\left( \\frac{c_p}{T_0} T' \\right) = \\kappa \\partial_{xx} T' $$\n$$ \\rho_0 c_p \\partial_t T' = \\kappa \\partial_{xx} T' $$\nThis simplifies to the one-dimensional heat diffusion equation for the temperature perturbation:\n$$ \\partial_t T' = \\alpha_T \\partial_{xx} T' \\quad \\text{where} \\quad \\alpha_T = \\frac{\\kappa}{\\rho_0 c_p} $$\nThis confirms that the entropy mode reduces to a pure thermal diffusion process governed by the thermal diffusivity $\\alpha_T$.\n\nAn initial step-function profile in temperature (an idealized contact discontinuity) located at $x=0$ has the self-similar solution in terms of the error function, $\\mathrm{erf}(z)$. Normalizing the temperature profile to range from $0$ to $1$, the solution is given by:\n$$ \\Theta(x, t) = \\frac{1}{2} \\left[ 1 + \\mathrm{erf}\\left( \\frac{x}{2\\sqrt{\\alpha_T t}} \\right) \\right] $$\nThe $10\\text{–}90$ transition width, $L_{10\\text{–}90}(t)$, is the distance between the points $x_{10}$ and $x_{90}$ where $\\Theta = 0.1$ and $\\Theta = 0.9$, respectively.\n- For $\\Theta = 0.1$: $0.1 = \\frac{1}{2} [1 + \\mathrm{erf}(\\frac{x_{10}}{2\\sqrt{\\alpha_T t}})] \\implies \\mathrm{erf}(\\frac{x_{10}}{2\\sqrt{\\alpha_T t}}) = -0.8$.\n- For $\\Theta = 0.9$: $0.9 = \\frac{1}{2} [1 + \\mathrm{erf}(\\frac{x_{90}}{2\\sqrt{\\alpha_T t}})] \\implies \\mathrm{erf}(\\frac{x_{90}}{2\\sqrt{\\alpha_T t}}) = 0.8$.\nUsing the inverse error function, $\\mathrm{erf}^{-1}(z)$, and the property that it is an odd function:\n$x_{10} = -2\\, \\mathrm{erf}^{-1}(0.8) \\sqrt{\\alpha_T t}$\n$x_{90} = +2\\, \\mathrm{erf}^{-1}(0.8) \\sqrt{\\alpha_T t}$\nThe width is the difference $L_{10\\text{–}90}(t) = x_{90} - x_{10}$:\n$$ L_{10\\text{–}90}(t) = 4\\, \\mathrm{erf}^{-1}(0.8)\\, \\sqrt{\\alpha_T t} $$\nThis derivation confirms the provided formula.\n\n**Dependence on Bulk Viscosity $\\zeta$**: The governing equation for the entropy mode evolution is the heat equation, whose diffusion coefficient $\\alpha_T$ depends only on $\\kappa$, $\\rho_0$, and $c_p$. Neither the shear viscosity $\\mu$ nor the bulk viscosity $\\zeta$ appear in this equation. Therefore, **the contact thickness $L_{10\\text{–}90}(t)$ does not depend on the bulk viscosity $\\zeta$**.\n\n### 2. Acoustic Mode\n\nFor the acoustic modes, we assume plane-wave solutions of the form $q'(x,t) = \\hat{q} \\exp(i(kx - \\omega t))$ for each perturbation variable $q'$. Substituting this form into the linearized system of governing equations yields a homogeneous algebraic system for the amplitudes $(\\hat{\\rho}, \\hat{u}, \\hat{p}, \\hat{T})$. A non-trivial solution exists only if the determinant of the coefficient matrix is zero, which yields the dispersion relation $\\omega(k)$.\n\nThe full derivation of the dispersion relation is algebraically intensive. However, the result for the small-dissipation limit is a standard result in physical acoustics. In this limit, the frequency is complex, $\\omega = \\omega_r + i\\omega_i$, where the real part $\\omega_r \\approx \\pm c_0 k$ (with $c_0=\\sqrt{\\gamma p_0/\\rho_0}$ being the ideal speed of sound) describes wave propagation, and the small imaginary part $\\omega_i > 0$ describes the temporal damping of the wave amplitude, via the factor $\\exp(-\\omega_i t)$.\n\nThe derived expression for this damping rate is:\n$$ \\omega_i = \\frac{k^2}{2 \\rho_0} \\left[ \\left(\\frac{4}{3}\\mu + \\zeta\\right) + \\kappa \\left(\\frac{1}{c_v} - \\frac{1}{c_p}\\right) \\right] $$\nUsing the thermodynamic relation for an ideal gas, $c_p - c_v = R$, and $\\gamma = c_p/c_v$, the thermal term can be rewritten:\n$$ \\kappa \\left(\\frac{1}{c_v} - \\frac{1}{c_p}\\right) = \\kappa \\frac{c_p - c_v}{c_p c_v} = \\kappa \\frac{R}{c_p c_v} = \\kappa \\frac{c_p(1-1/\\gamma)}{c_p (c_p/\\gamma)} = \\kappa \\frac{\\gamma-1}{c_p} $$\nSubstituting this back into the expression for $\\omega_i$ and rearranging gives:\n$$ \\omega_i = \\frac{k^2}{2} \\left( \\frac{\\frac{4}{3}\\mu + \\zeta}{\\rho_0} + (\\gamma - 1)\\, \\frac{\\kappa}{\\rho_0 c_p} \\right) $$\nThis confirms the expression provided in the problem statement.\n\n**Influence of Bulk Viscosity $\\zeta$**: The damping rate $\\omega_i$ is a sum of contributions from viscosity and thermal conduction. The viscous contribution is proportional to an effective longitudinal viscosity, $\\mu_L = \\frac{4}{3}\\mu + \\zeta$. Since $\\zeta$ is a non-negative physical parameter, its presence directly and additively increases the total viscous dissipation for a compressional (acoustic) wave. A larger value of $\\zeta$ results in a larger $\\omega_i$, leading to a more rapid exponential decay of the pressure oscillation amplitude.\n\nThe required computations will be performed using the derived formulas and the provided constants.\n- For contact thickness: $L_{10\\text{–}90}(t) = 4\\, \\mathrm{erf}^{-1}(0.8)\\, \\sqrt{(\\kappa/(\\rho_0 c_p)) t}$.\n- For amplitude decay: $\\exp(-\\omega_i t)$, with $\\omega_i$ as given above.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import erfinv\n\ndef solve():\n    \"\"\"\n    Computes contact thickness and acoustic decay for a linearized viscous Riemann problem.\n    \"\"\"\n    # Define the constant material parameters from the problem statement.\n    rho0 = 1.0  # Equilibrium density in kg/m^3\n    mu = 1.8e-5  # Shear viscosity in Pa.s\n    kappa = 0.026  # Thermal conductivity in W/(m.K)\n    cp = 1005.0  # Specific heat at constant pressure in J/(kg.K)\n    gamma = 1.4  # Ratio of specific heats (dimensionless)\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple (t, k, zeta)\n    # t: time in s\n    # k: wavenumber in m^-1\n    # zeta: bulk viscosity in Pa.s\n    test_cases = [\n        (0.01, 500.0, 0.0),            # Case 1: Stokes hypothesis baseline\n        (0.01, 500.0, 2.0e-4),         # Case 2: Increased bulk viscosity\n        (0.01, 1500.0, 0.0),           # Case 3: Higher wavenumber, Stokes hypothesis\n        (0.001, 500.0, 2.0e-4)         # Case 4: Shorter time with increased bulk viscosity\n    ]\n\n    # Pre-calculate derived constants to improve clarity and efficiency.\n    # Thermal diffusivity, alpha_T = kappa / (rho0 * cp)\n    alpha_T = kappa / (rho0 * cp)\n    \n    # Pre-calculate the constant part of the contact thickness formula\n    # The constant term is 4 * erf_inv(0.8)\n    erfinv_0_8 = erfinv(0.8)\n    contact_thickness_const = 4.0 * erfinv_0_8\n\n    results = []\n    for t, k, zeta in test_cases:\n        # 1. Calculate the contact thickness L_10–90(t) in meters.\n        # Formula: L = 4 * erf_inv(0.8) * sqrt(alpha_T * t)\n        L_10_90 = contact_thickness_const * np.sqrt(alpha_T * t)\n\n        # 2. Calculate the pressure-oscillation amplitude decay factor exp(-omega_i * t).\n        # First, compute the damping rate omega_i.\n        # Formula: omega_i = (k^2 / 2) * ( (4/3*mu + zeta)/rho0 + (gamma-1)*alpha_T )\n        term_viscous = (4.0/3.0 * mu + zeta) / rho0\n        term_thermal = (gamma - 1.0) * alpha_T\n        omega_i = (k**2 / 2.0) * (term_viscous + term_thermal)\n        \n        # Then, compute the decay factor.\n        decay_factor = np.exp(-omega_i * t)\n\n        # Append the pair of results for the current test case.\n        results.append([L_10_90, decay_factor])\n\n    # Final print statement in the exact required format.\n    # The format is a string representation of a list of lists.\n    # Example: [[result1_a, result1_b],[result2_a, result2_b],...]\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Ultimately, the correctness of a simulation depends on the accurate implementation of its underlying physical models. A common pitfall in CFD codes is the implicit or explicit enforcement of the Stokes hypothesis, which can lead to subtle but significant errors. This exercise introduces the Method of Manufactured Solutions, a powerful code verification technique, to create a test case that definitively violates the hypothesis. You will see firsthand how a solver that incorrectly assumes the thermodynamic and mechanical pressures are equal will fail this test, demonstrating the critical importance of a general constitutive implementation. ",
            "id": "3366519",
            "problem": "You are tasked with constructing a manufactured three-dimensional flow field that provably violates Stokes’ hypothesis and then using it to test two hypothetical solvers for the pressure-stress relationship in compressible Newtonian fluids. The problem revolves around the distinction between thermodynamic pressure and mechanical pressure in the presence of a nonzero trace of the viscous stress tensor.\n\nStarting point and definitions:\n- Consider a compressible Newtonian fluid whose Cauchy stress tensor is defined by the decomposition $$\\boldsymbol{\\sigma} = -p \\boldsymbol{I} + \\boldsymbol{\\tau},$$ where $p$ is the thermodynamic pressure and $\\boldsymbol{\\tau}$ is the viscous stress tensor.\n- For a Newtonian fluid, the viscous stress tensor is defined by $$\\boldsymbol{\\tau} = 2 \\mu \\boldsymbol{S} + \\lambda (\\nabla \\cdot \\boldsymbol{u}) \\boldsymbol{I},$$ where $\\mu$ is the dynamic viscosity, $\\lambda$ is the second viscosity coefficient, $\\boldsymbol{u}$ is the velocity field, and $\\boldsymbol{S} = \\frac{1}{2}(\\nabla \\boldsymbol{u} + (\\nabla \\boldsymbol{u})^{\\top})$ is the symmetric rate-of-strain tensor.\n- The mechanical pressure is defined as the negative of the mean normal stress, i.e., $$p_m = -\\frac{1}{3} \\operatorname{tr}(\\boldsymbol{\\sigma}),$$ in three spatial dimensions. Under Stokes’ hypothesis, the second viscosity coefficient is set to satisfy $$\\lambda = -\\frac{2}{3}\\mu,$$ which ensures $$\\operatorname{tr}(\\boldsymbol{\\tau}) = (2\\mu + 3\\lambda) (\\nabla \\cdot \\boldsymbol{u}) = 0,$$ implying $$p_m = p.$$\n- When Stokes’ hypothesis does not hold, the quantity $$\\operatorname{tr}(\\boldsymbol{\\tau}) = (2\\mu + 3\\lambda) (\\nabla \\cdot \\boldsymbol{u})$$ can be nonzero, and therefore $p_m \\neq p$ in general.\n\nYour program must:\n1. Define a manufactured three-dimensional velocity field and a pressure field. Use $$\\boldsymbol{u}(x,y,z) = [\\alpha x, \\beta y, \\gamma z]$$ and $$p(x,y,z) = p_0 + a x + b y + c z.$$ All parameters and variables are to be treated as real numbers.\n2. Compute $\\nabla \\boldsymbol{u}$, $\\boldsymbol{S}$, $\\boldsymbol{\\tau}$, and $\\boldsymbol{\\sigma}$ at a given point $(x,y,z)$.\n3. Compute the mechanical pressure $$p_m = -\\frac{1}{3} \\operatorname{tr}(\\boldsymbol{\\sigma}).$$\n4. Emulate two solvers:\n   - A solver hard-coded with Stokes’ hypothesis, which recovers thermodynamic pressure as $$\\widehat{p}_{\\text{Stokes}} = p_m.$$\n   - A solver with general $\\lambda$, which recovers thermodynamic pressure as $$\\widehat{p}_{\\lambda} = p_m + \\frac{1}{3}\\operatorname{tr}(\\boldsymbol{\\tau}).$$\n5. Compare each solver’s recovered pressure with the true manufactured pressure $p(x,y,z)$ at the point. A solver is deemed to pass if the absolute error between its recovered pressure and the true pressure is less than a prescribed tolerance.\n\nUnits and physical realism:\n- Use the International System of Units (SI). Pressures must be in Pascal ($\\mathrm{Pa}$), dynamic viscosity $\\mu$ and second viscosity coefficient $\\lambda$ in Pascal-second ($\\mathrm{Pa}\\cdot \\mathrm{s}$), and spatial coordinates in meters ($\\mathrm{m}$).\n- Use the tolerance $$\\varepsilon = 10^{-9}~\\mathrm{Pa}.$$ A solver passes a test case if $$|\\widehat{p} - p| \\le \\varepsilon.$$\n\nTest suite and parameter coverage:\n- You must implement the following three test cases, each specified by the parameter tuple $$(\\alpha,\\beta,\\gamma,\\mu,\\lambda,p_0,a,b,c,x,y,z).$$\n  1. General compressible case violating Stokes’ hypothesis (expected: Stokes hard-coded solver fails, general $\\lambda$ solver passes):\n     $$ (\\alpha,\\beta,\\gamma,\\mu,\\lambda,p_0,a,b,c,x,y,z) = (1.0, 0.2, 0.3, 1.0, 0.1, 100000.0, 300.0, -500.0, 100.0, 0.25, -0.75, 0.5). $$\n  2. Boundary case exactly satisfying Stokes’ hypothesis (expected: both solvers pass):\n     $$ (\\alpha,\\beta,\\gamma,\\mu,\\lambda,p_0,a,b,c,x,y,z) = (0.9, 0.5, -0.4, 1.0, -\\tfrac{2}{3}, 101325.0, 10.0, 20.0, -30.0, -1.0, 2.0, 0.0). $$\n  3. Near-incompressible edge case with extremely small divergence (expected: both solvers pass within tolerance):\n     $$ (\\alpha,\\beta,\\gamma,\\mu,\\lambda,p_0,a,b,c,x,y,z) = (5\\times 10^{-13}, 4\\times 10^{-13}, 1\\times 10^{-13}, 1.2, 0.9, 50000.0, -7.0, 8.0, 9.0, 3.0, -3.0, 1.0). $$\n\nRequired final output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The results must be the six booleans, in order, $$[\\text{S}_1,\\text{L}_1,\\text{S}_2,\\text{L}_2,\\text{S}_3,\\text{L}_3],$$ where $\\text{S}_i$ is the pass/fail boolean for the Stokes-hard-coded solver on test case $i$, and $\\text{L}_i$ is the pass/fail boolean for the general $\\lambda$ solver on test case $i$.",
            "solution": "The problem requires the validation of two computational solvers against a manufactured solution for a compressible Newtonian fluid. The core of the problem lies in the distinction between the thermodynamic pressure $p$ and the mechanical pressure $p_m$, which arises when Stokes' hypothesis is not satisfied.\n\nThe relationship between the Cauchy stress tensor $\\boldsymbol{\\sigma}$, the thermodynamic pressure $p$, and the viscous stress tensor $\\boldsymbol{\\tau}$ is given by:\n$$ \\boldsymbol{\\sigma} = -p \\boldsymbol{I} + \\boldsymbol{\\tau} $$\nwhere $\\boldsymbol{I}$ is the identity tensor. The mechanical pressure $p_m$ is defined as the negative mean normal stress:\n$$ p_m = -\\frac{1}{3} \\operatorname{tr}(\\boldsymbol{\\sigma}) $$\nwhere $\\operatorname{tr}(\\cdot)$ denotes the trace of a tensor. By substituting the definition of $\\boldsymbol{\\sigma}$ into the equation for $p_m$, we can establish a direct relationship between $p$ and $p_m$. In $3$ dimensions, $\\operatorname{tr}(\\boldsymbol{I}) = 3$.\n$$ p_m = -\\frac{1}{3} \\operatorname{tr}(-p \\boldsymbol{I} + \\boldsymbol{\\tau}) = -\\frac{1}{3} (-p \\operatorname{tr}(\\boldsymbol{I}) + \\operatorname{tr}(\\boldsymbol{\\tau})) = -\\frac{1}{3} (-3p + \\operatorname{tr}(\\boldsymbol{\\tau})) $$\n$$ p_m = p - \\frac{1}{3} \\operatorname{tr}(\\boldsymbol{\\tau}) $$\nThis equation is central to the problem. It can be rearranged to express the thermodynamic pressure $p$ as:\n$$ p = p_m + \\frac{1}{3} \\operatorname{tr}(\\boldsymbol{\\tau}) $$\nThis shows that a solver which correctly computes $p_m$ and $\\operatorname{tr}(\\boldsymbol{\\tau})$ can perfectly recover the true thermodynamic pressure $p$. This is precisely what the \"general $\\lambda$ solver\" is designed to do: $\\widehat{p}_{\\lambda} = p_m + \\frac{1}{3}\\operatorname{tr}(\\boldsymbol{\\tau})$.\n\nThe \"Stokes hard-coded solver\" assumes Stokes' hypothesis is valid, which implies $\\operatorname{tr}(\\boldsymbol{\\tau})=0$. Therefore, this solver estimates the thermodynamic pressure as $\\widehat{p}_{\\text{Stokes}} = p_m$. The error of this solver is:\n$$ |\\widehat{p}_{\\text{Stokes}} - p| = |p_m - p| = \\left| \\left(p - \\frac{1}{3}\\operatorname{tr}(\\boldsymbol{\\tau})\\right) - p \\right| = \\left|-\\frac{1}{3}\\operatorname{tr}(\\boldsymbol{\\tau})\\right| = \\frac{1}{3}|\\operatorname{tr}(\\boldsymbol{\\tau})| $$\n\nThe next step is to compute $\\operatorname{tr}(\\boldsymbol{\\tau})$ for the given manufactured flow field. The viscous stress tensor for a Newtonian fluid is:\n$$ \\boldsymbol{\\tau} = 2 \\mu \\boldsymbol{S} + \\lambda (\\nabla \\cdot \\boldsymbol{u}) \\boldsymbol{I} $$\nwhere $\\boldsymbol{S} = \\frac{1}{2}(\\nabla \\boldsymbol{u} + (\\nabla \\boldsymbol{u})^{\\top})$. The trace is:\n$$ \\operatorname{tr}(\\boldsymbol{\\tau}) = \\operatorname{tr}(2 \\mu \\boldsymbol{S}) + \\operatorname{tr}(\\lambda (\\nabla \\cdot \\boldsymbol{u}) \\boldsymbol{I}) = 2 \\mu \\operatorname{tr}(\\boldsymbol{S}) + 3 \\lambda (\\nabla \\cdot \\boldsymbol{u}) $$\nThe trace of the rate-of-strain tensor is $\\operatorname{tr}(\\boldsymbol{S}) = \\operatorname{tr}(\\frac{1}{2}(\\nabla \\boldsymbol{u} + (\\nabla \\boldsymbol{u})^{\\top})) = \\frac{1}{2}(\\operatorname{tr}(\\nabla \\boldsymbol{u}) + \\operatorname{tr}((\\nabla \\boldsymbol{u})^{\\top})) = \\operatorname{tr}(\\nabla \\boldsymbol{u}) = \\nabla \\cdot \\boldsymbol{u}$.\nThus, the trace of the viscous stress tensor simplifies to:\n$$ \\operatorname{tr}(\\boldsymbol{\\tau}) = 2 \\mu (\\nabla \\cdot \\boldsymbol{u}) + 3 \\lambda (\\nabla \\cdot \\boldsymbol{u}) = (2\\mu + 3\\lambda)(\\nabla \\cdot \\boldsymbol{u}) $$\n\nThe manufactured velocity field is $\\boldsymbol{u}(x,y,z) = [\\alpha x, \\beta y, \\gamma z]$. Its gradient $\\nabla \\boldsymbol{u}$ is a diagonal matrix of constants:\n$$ \\nabla \\boldsymbol{u} = \\begin{pmatrix} \\alpha & 0 & 0 \\\\ 0 & \\beta & 0 \\\\ 0 & 0 & \\gamma \\end{pmatrix} $$\nThe divergence $\\nabla \\cdot \\boldsymbol{u}$ is the trace of this matrix:\n$$ \\nabla \\cdot \\boldsymbol{u} = \\alpha + \\beta + \\gamma $$\n\nCombining these results, the error for the Stokes solver is:\n$$ |\\widehat{p}_{\\text{Stokes}} - p| = \\frac{1}{3}|(2\\mu + 3\\lambda)(\\alpha + \\beta + \\gamma)| $$\nThe general $\\lambda$ solver should, in theory, have zero error:\n$$ |\\widehat{p}_{\\lambda} - p| = 0 $$\nsubject to machine floating-point precision.\n\nThe algorithm for testing each case is as follows:\n1.  For a given test case specified by the tuple $(\\alpha,\\beta,\\gamma,\\mu,\\lambda,p_0,a,b,c,x,y,z)$, first compute the \"true\" manufactured pressure $p(x,y,z) = p_0 + ax + by + cz$.\n2.  Compute the divergence of the velocity field, $\\nabla \\cdot \\boldsymbol{u} = \\alpha + \\beta + \\gamma$.\n3.  Compute the trace of the viscous stress tensor, $\\operatorname{tr}(\\boldsymbol{\\tau}) = (2\\mu + 3\\lambda)(\\nabla \\cdot \\boldsymbol{u})$.\n4.  Compute the mechanical pressure using the derived relation: $p_m = p - \\frac{1}{3}\\operatorname{tr}(\\boldsymbol{\\tau})$. Note that we compute $p_m$ from the known true pressure $p$ and the computed $\\operatorname{tr}(\\boldsymbol{\\tau})$, which is simpler than building the full stress tensor.\n5.  Emulate the solvers:\n    -   Stokes solver recovery: $\\widehat{p}_{\\text{Stokes}} = p_m$.\n    -   General $\\lambda$ solver recovery: $\\widehat{p}_{\\lambda} = p_m + \\frac{1}{3}\\operatorname{tr}(\\boldsymbol{\\tau})$.\n6.  Calculate the absolute errors: $|\\widehat{p}_{\\text{Stokes}} - p|$ and $|\\widehat{p}_{\\lambda} - p|$.\n7.  A solver passes if its absolute error is less than or equal to the tolerance $\\varepsilon = 10^{-9}~\\mathrm{Pa}$.\n\nThis procedure is implemented for each of the three test cases specified. The results, a sequence of six boolean values representing the pass/fail status of each solver for each case, are then formatted into the required output string.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Validates two pressure recovery solvers against manufactured solutions\n    for a compressible Newtonian fluid.\n    \"\"\"\n    \n    # Test suite: (alpha, beta, gamma, mu, lambda_, p0, a, b, c, x, y, z)\n    test_cases = [\n        # 1. General compressible case violating Stokes’ hypothesis\n        (1.0, 0.2, 0.3, 1.0, 0.1, 100000.0, 300.0, -500.0, 100.0, 0.25, -0.75, 0.5),\n        # 2. Boundary case exactly satisfying Stokes’ hypothesis\n        (0.9, 0.5, -0.4, 1.0, -2.0/3.0, 101325.0, 10.0, 20.0, -30.0, -1.0, 2.0, 0.0),\n        # 3. Near-incompressible edge case with extremely small divergence\n        (5e-13, 4e-13, 1e-13, 1.2, 0.9, 50000.0, -7.0, 8.0, 9.0, 3.0, -3.0, 1.0)\n    ]\n    \n    epsilon = 1e-9  # Tolerance in Pascals\n    results = []\n\n    for case in test_cases:\n        alpha, beta, gamma, mu, lambda_, p0, a, b, c, x, y, z = case\n\n        # 1. Compute the true manufactured thermodynamic pressure p\n        p_true = p0 + a * x + b * y + c * z\n\n        # 2. Compute the divergence of the velocity field\n        # For u = [alpha*x, beta*y, gamma*z], div(u) = alpha + beta + gamma\n        div_u = alpha + beta + gamma\n\n        # 3. Compute the trace of the viscous stress tensor tau\n        # tr(tau) = (2*mu + 3*lambda) * div(u)\n        trace_tau = (2 * mu + 3 * lambda_) * div_u\n\n        # 4. Compute the mechanical pressure p_m\n        # p_m = p - (1/3) * tr(tau)\n        p_m = p_true - (1.0 / 3.0) * trace_tau\n\n        # 5. Emulate the two solvers to recover pressure\n        # Solver hard-coded with Stokes' hypothesis (assumes tr(tau)=0)\n        p_recovered_stokes = p_m\n        \n        # Solver with general lambda\n        # This relationship should exactly recover p_true, barring float precision issues\n        p_recovered_lambda = p_m + (1.0 / 3.0) * trace_tau\n\n        # 6. Compare recovered pressures with true pressure against tolerance\n        error_stokes = abs(p_recovered_stokes - p_true)\n        error_lambda = abs(p_recovered_lambda - p_true)\n        \n        pass_stokes = error_stokes <= epsilon\n        pass_lambda = error_lambda <= epsilon\n        \n        results.extend([pass_stokes, pass_lambda])\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        }
    ]
}