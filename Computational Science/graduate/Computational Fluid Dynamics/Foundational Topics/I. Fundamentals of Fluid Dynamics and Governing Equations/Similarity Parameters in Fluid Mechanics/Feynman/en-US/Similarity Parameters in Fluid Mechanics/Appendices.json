{
    "hands_on_practices": [
        {
            "introduction": "The principles of similarity are most powerful when they connect fundamental theory to practical engineering predictions. This exercise focuses on a canonical problem in heat transfer: forced convection over a flat plate. By calculating the key dimensionless parameters—the Reynolds number ($Re$) and the Prandtl number ($Pr$)—you will determine the nature of the boundary layer and select the appropriate scaling law for the Nusselt number ($Nu$), which quantifies heat transfer. This practice is essential for internalizing how similarity arguments form the basis of the empirical correlations used widely in thermal engineering design .",
            "id": "3361943",
            "problem": "A two-dimensional, steady, zero-pressure-gradient external flow of an ideal gas passes over a smooth, isothermal flat plate of length $L$ aligned with the free stream. The free-stream velocity is $U_{\\infty}$, the free-stream temperature is $T_{\\infty}$, and the wall temperature is $T_{w}$ with $T_{w} > T_{\\infty}$. Assume negligible viscous dissipation, negligible buoyancy effects, and negligible compressibility effects. Properties are to be evaluated at the film temperature $T_{f} = (T_{w} + T_{\\infty})/2$. At $T_{f}$, the dynamic viscosity, thermal conductivity, and specific heat at constant pressure are given as $\\,\\mu\\,$, $\\,k\\,$, and $\\,c_{p}\\,$, respectively. The gas density at the free stream is $\\,\\rho\\,$.\n\nStarting from the governing boundary-layer momentum and energy equations and their non-dimensional forms, use similarity arguments to determine the appropriate regime (laminar or turbulent) for heat transfer over the plate and justify the canonical exponents of the Reynolds number and Prandtl number appearing in the average Nusselt number correlation for that regime. Then:\n\n1) Compute the Prandtl number $Pr$ at $T_{f}$ using only the provided property values.  \n2) Select the appropriate correlation form for the average Nusselt number over the plate, expressed as a closed-form analytic function of the Reynolds number based on plate length $Re_{L}$ and the Prandtl number $Pr$, consistent with the identified regime and an isothermal wall.\n\nUse the following data, evaluated at the film temperature $T_{f}$:\n- Free-stream velocity: $U_{\\infty} = 3.00 \\ \\mathrm{m/s}$.\n- Plate length: $L = 0.400 \\ \\mathrm{m}$.\n- Free-stream density: $\\rho = 0.950 \\ \\mathrm{kg/m^{3}}$.\n- Dynamic viscosity: $\\mu = 2.10 \\times 10^{-5} \\ \\mathrm{kg/(m \\cdot s)}$.\n- Thermal conductivity: $k = 2.60 \\times 10^{-2} \\ \\mathrm{W/(m \\cdot K)}$.\n- Specific heat at constant pressure: $c_{p} = 1.012 \\times 10^{3} \\ \\mathrm{J/(kg \\cdot K)}$.\n\nDefinitions to use include $Pr = \\dfrac{c_{p} \\mu}{k}$ and $Re_{L} = \\dfrac{\\rho U_{\\infty} L}{\\mu}$. Treat the plate as hydrodynamically smooth and assume that, if the flow is turbulent, it is not tripped at the leading edge. If the Reynolds number indicates laminar flow over the entire plate, select the laminar forced-convection correlation form; otherwise, select the turbulent forced-convection correlation form appropriate for an isothermal wall over a smooth plate at zero pressure gradient.\n\nExpress your final answer as a two-entry row matrix where:\n- The first entry is the numerical value of $Pr$ rounded to four significant figures.\n- The second entry is the selected analytic correlation expression for the average Nusselt number over the plate in terms of $Re_{L}$ and $Pr$.\n\nDo not include units in your final boxed answer.",
            "solution": "The problem statement is first validated against the required criteria.\n\n**Step 1: Extract Givens**\n- Flow description: two-dimensional, steady, zero-pressure-gradient external flow of an ideal gas.\n- Geometry: smooth, isothermal flat plate of length $L$, aligned with the free stream.\n- Free-stream velocity: $U_{\\infty}$.\n- Free-stream temperature: $T_{\\infty}$.\n- Wall temperature: $T_{w}$, with $T_{w} > T_{\\infty}$.\n- Assumptions: negligible viscous dissipation, negligible buoyancy effects, negligible compressibility effects.\n- Property evaluation temperature: film temperature $T_{f} = (T_{w} + T_{\\infty})/2$.\n- Properties at $T_{f}$: dynamic viscosity $\\mu$, thermal conductivity $k$, specific heat at constant pressure $c_{p}$.\n- Free-stream density: $\\rho$.\n- Numerical values:\n  - $U_{\\infty} = 3.00 \\ \\mathrm{m/s}$.\n  - $L = 0.400 \\ \\mathrm{m}$.\n  - $\\rho = 0.950 \\ \\mathrm{kg/m^{3}}$ (at free stream conditions).\n  - $\\mu = 2.10 \\times 10^{-5} \\ \\mathrm{kg/(m \\cdot s)}$ (at $T_f$).\n  - $k = 2.60 \\times 10^{-2} \\ \\mathrm{W/(m \\cdot K)}$ (at $T_f$).\n  - $c_{p} = 1.012 \\times 10^{3} \\ \\mathrm{J/(kg \\cdot K)}$ (at $T_f$).\n- Definitions:\n  - $Pr = \\dfrac{c_{p} \\mu}{k}$.\n  - $Re_{L} = \\dfrac{\\rho U_{\\infty} L}{\\mu}$.\n- Conditions:\n  - Plate is hydrodynamically smooth.\n  - No tripping of the boundary layer.\n  - Regime (laminar or turbulent) to be determined from the Reynolds number.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, describing a classical case of forced convection over a flat plate, a fundamental topic in fluid mechanics and heat transfer. It is well-posed, providing all necessary data, definitions, and a clear objective. The language is precise and objective. The assumptions are standard for simplifying the problem to a canonical form. The provided property values are physically realistic for a gas like air at moderate temperatures. The use of free-stream density $\\rho$ with other properties evaluated at the film temperature in the Reynolds number calculation is a standard and accepted practice in external flow analysis. The problem is complete, consistent, and solvable.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A full solution will be provided.\n\nThe problem requires a justification of the exponents in the Nusselt number correlation based on similarity arguments, followed by the selection of the correct correlation and the calculation of the Prandtl number.\n\nThe governing equations for a two-dimensional, steady, incompressible, zero-pressure-gradient boundary layer flow with constant properties and negligible viscous dissipation are:\nContinuity:\n$$ \\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y} = 0 $$\nMomentum in the $x$-direction:\n$$ u \\frac{\\partial u}{\\partial x} + v \\frac{\\partial u}{\\partial y} = \\nu \\frac{\\partial^2 u}{\\partial y^2} $$\nEnergy:\n$$ u \\frac{\\partial T}{\\partial x} + v \\frac{\\partial T}{\\partial y} = \\alpha \\frac{\\partial^2 T}{\\partial y^2} $$\nwhere $u$ and $v$ are the velocity components in the $x$ and $y$ directions, respectively, $T$ is the temperature, $\\nu = \\mu/\\rho$ is the kinematic viscosity (momentum diffusivity), and $\\alpha = k/(\\rho c_{p})$ is the thermal diffusivity.\n\nBy non-dimensionalizing these equations using variables such as $x^* = x/L$, $y^* = y/L$, $u^* = u/U_{\\infty}$, and a dimensionless temperature $\\theta = (T - T_w)/(T_{\\infty} - T_w)$, two key dimensionless groups emerge. The momentum equation yields the Reynolds number, $Re_{L} = \\frac{U_{\\infty} L}{\\nu}$, which represents the ratio of inertial forces to viscous forces. The energy equation yields both the Reynolds number and the Prandtl number, $Pr = \\frac{\\nu}{\\alpha} = \\frac{c_p \\mu}{k}$, which represents the ratio of momentum diffusivity to thermal diffusivity. The solution to the dimensionless equations, and therefore any derived quantities like the Nusselt number, must be a function of these two similarity parameters.\n\nThe local Nusselt number is defined as $Nu_x = \\frac{h_x x}{k}$. The heat transfer coefficient $h_x$ is related to the temperature gradient at the wall: $h_x = -k \\frac{(\\partial T / \\partial y)_{y=0}}{T_w - T_\\infty}$. This implies that $Nu_x$ is a function of the local Reynolds number, $Re_x = \\frac{\\rho U_{\\infty} x}{\\mu}$, and the Prandtl number, $Pr$.\n\nFor **laminar flow**, the exact solution to the boundary layer equations (the Blasius-Pohlhausen solution) shows that the hydrodynamic boundary layer thickness $\\delta$ scales as $\\delta \\propto x Re_x^{-\\frac{1}{2}}$. The thermal boundary layer thickness $\\delta_T$ is related to $\\delta$ by $\\delta_T \\approx \\delta Pr^{-\\frac{1}{3}}$ for $Pr \\gtrsim 0.6$. Since $h_x \\propto k/\\delta_T$, we have $h_x \\propto \\frac{k}{x} Re_x^{\\frac{1}{2}} Pr^{\\frac{1}{3}}$. This leads to the local Nusselt number scaling $Nu_x \\propto Re_x^{\\frac{1}{2}} Pr^{\\frac{1}{3}}$. The exponent on the Reynolds number is $\\frac{1}{2}$ and on the Prandtl number is $\\frac{1}{3}$.\n\nFor **turbulent flow**, semi-empirical analyses (like the Reynolds-Colburn analogy) predict a different scaling due to enhanced mixing. The local Nusselt number is found to scale as $Nu_x \\propto Re_x^{\\frac{4}{5}} Pr^{\\frac{1}{3}}$. The exponent on the Reynolds number is $\\frac{4}{5} = 0.8$.\n\nTo select the correct regime, we must compute the Reynolds number at the end of the plate, $Re_L$.\n$$ Re_L = \\frac{\\rho U_{\\infty} L}{\\mu} $$\nSubstituting the given values:\n$$ Re_L = \\frac{(0.950 \\ \\mathrm{kg/m^{3}}) (3.00 \\ \\mathrm{m/s}) (0.400 \\ \\mathrm{m})}{2.10 \\times 10^{-5} \\ \\mathrm{kg/(m \\cdot s)}} = \\frac{1.14}{2.10 \\times 10^{-5}} \\approx 54285.7 $$\nThe result is $Re_L \\approx 5.43 \\times 10^4$. The critical Reynolds number for transition to turbulence on a smooth flat plate is $Re_{crit} \\approx 5 \\times 10^5$. Since $Re_L  Re_{crit}$, the flow over the entire plate is laminar.\n\nTherefore, we must select the correlation for a laminar boundary layer. The average heat transfer coefficient $\\bar{h}_L$ is obtained by integrating the local coefficient $h_x \\propto x^{-\\frac{1}{2}}$ over the plate length $L$.\n$$ \\bar{h}_L = \\frac{1}{L} \\int_0^L h_x dx \\propto \\frac{1}{L} \\int_0^L x^{-\\frac{1}{2}} dx \\propto L^{-\\frac{1}{2}} $$\nThe average Nusselt number $\\overline{Nu}_L = \\frac{\\bar{h}_L L}{k}$ then scales as:\n$$ \\overline{Nu}_L \\propto \\frac{L^{-\\frac{1}{2}} L}{k} \\propto \\left(\\frac{\\rho U_{\\infty}}{\\mu}\\right)^{\\frac{1}{2}} L^{\\frac{1}{2}} \\propto Re_L^{\\frac{1}{2}} $$\nIncluding the Prandtl number dependence, $\\overline{Nu}_L \\propto Re_L^{\\frac{1}{2}} Pr^{\\frac{1}{3}}$. The well-established correlation for average Nusselt number for laminar flow over an isothermal flat plate is:\n$$ \\overline{Nu}_L = 0.664 Re_L^{\\frac{1}{2}} Pr^{\\frac{1}{3}} $$\nThis is the appropriate correlation form.\n\nNext, we compute the Prandtl number, $Pr$, using the provided data.\n$$ Pr = \\frac{c_{p} \\mu}{k} $$\nSubstituting the values:\n$$ Pr = \\frac{(1.012 \\times 10^{3} \\ \\mathrm{J/(kg \\cdot K)}) (2.10 \\times 10^{-5} \\ \\mathrm{kg/(m \\cdot s)})}{2.60 \\times 10^{-2} \\ \\mathrm{W/(m \\cdot K)}} $$\n$$ Pr = \\frac{0.021252}{0.026} \\approx 0.8173846... $$\nRounding to four significant figures, the Prandtl number is $Pr = 0.8174$. Since $Pr > 0.6$, the use of the selected correlation is justified.\n\nThe final answer consists of two parts: the numerical value of $Pr$ and the analytical expression for the average Nusselt number.\n\n1. Prandtl number, $Pr$: $0.8174$.\n2. Nusselt number correlation: $0.664 Re_L^{\\frac{1}{2}} Pr^{\\frac{1}{3}}$.\n\nThese are combined into a two-entry row matrix.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.8174  0.664 Re_L^{\\frac{1}{2}} Pr^{\\frac{1}{3}}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "For computational fluid dynamicists, understanding similarity parameters goes beyond predicting physical behavior; it is crucial for predicting computational cost. This problem explores the practical consequences of turbulence scaling laws, which are themselves rooted in similarity principles, on the resource requirements for a Direct Numerical Simulation (DNS). By deriving the total computational effort as a function of the Reynolds number ($Re$) and Prandtl number ($Pr$), you will gain a profound appreciation for how these abstract parameters dictate the feasibility of simulating complex flows on high-performance computers .",
            "id": "3361913",
            "problem": "A research group plans a Direct Numerical Simulation (DNS) of incompressible, statistically stationary, homogeneous isotropic turbulence with an actively transported temperature field modeled as a passive scalar in a triply periodic cube of edge length $L$. The flow is characterized by the Reynolds number $Re_{L} = U L / \\nu$ and the Prandtl number $Pr = \\nu / \\alpha$, where $U$ is a characteristic large-scale velocity, $\\nu$ is the kinematic viscosity, and $\\alpha$ is the thermal diffusivity. The group will run on an exascale-class High-Performance Computing (HPC) system.\n\nStarting only from fundamental definitions and well-tested small-scale turbulence facts, derive the space-time resolution requirements and compute the estimated wall-clock time as follows:\n\n- Use that the mean kinetic energy dissipation per unit mass scales as $\\varepsilon \\sim U^{3}/L$ at high $Re_{L}$, and that the Kolmogorov microscale is $\\eta = \\left(\\nu^{3}/\\varepsilon\\right)^{1/4}$. For $Pr \\ge 1$, the smallest thermal scale is the Batchelor scale $\\eta_{B} = \\eta / Pr^{1/2}$.\n- Impose a uniform grid with spacing $\\Delta x$ chosen to resolve the smallest relevant physical scale with $s$ points, i.e., $\\Delta x = \\eta_{B}/s$.\n- Let the number of grid points be $N_{\\text{grid}} = (L/\\Delta x)^{3}$. Impose a Courant–Friedrichs–Lewy (CFL) stability condition for explicit time integration $\\Delta t = C\\,\\Delta x/U$, and simulate for $n$ large-eddy turnover times $T_{\\text{sim}} = n\\,L/U$. Let the number of time steps be $N_{t} = T_{\\text{sim}}/\\Delta t$.\n- Assume a per-time-step floating-point cost of $q$ floating-point operations per grid point per time step for the coupled velocity–temperature solver.\n\nGiven the target dimensionless parameters and numerical choices $Re_{L} = 1.0 \\times 10^{4}$, $Pr = 7.0$, $s = 3$, $C = 0.5$, $n = 10$, and $q = 2.0 \\times 10^{5}$, and given a sustained machine performance of $R = 1.0 \\times 10^{17}$ floating-point operations per second, compute the estimated wall-clock time to complete the simulation.\n\nExpress your final answer in hours, rounded to three significant figures. Do not include any other quantities in your final answer.",
            "solution": "The user has provided a problem that requires the estimation of the wall-clock time for a Direct Numerical Simulation (DNS) of turbulence. The first step is to validate the problem statement.\n\n### Step 1: Extract Givens\n- Domain: Triply periodic cube of edge length $L$.\n- Flow: Incompressible, statistically stationary, homogeneous isotropic turbulence.\n- Scalar: Actively transported passive temperature field.\n- Dimensionless parameters: Reynolds number $Re_{L} = U L / \\nu$, Prandtl number $Pr = \\nu / \\alpha$.\n- Fundamental scaling relations:\n  - Mean kinetic energy dissipation per unit mass: $\\varepsilon \\sim U^{3}/L$.\n  - Kolmogorov microscale: $\\eta = \\left(\\nu^{3}/\\varepsilon\\right)^{1/4}$.\n  - Batchelor scale (for $Pr \\ge 1$): $\\eta_{B} = \\eta / Pr^{1/2}$.\n- Numerical discretization parameters:\n  - Grid spacing: $\\Delta x = \\eta_{B}/s$.\n  - Number of grid points: $N_{\\text{grid}} = (L/\\Delta x)^{3}$.\n  - Time step (CFL condition): $\\Delta t = C\\,\\Delta x/U$.\n  - Total simulation time: $T_{\\text{sim}} = n\\,L/U$.\n  - Number of time steps: $N_{t} = T_{\\text{sim}}/\\Delta t$.\n- Computational cost parameters:\n  - Floating-point operations per grid point per time step: $q$.\n- Given numerical values:\n  - $Re_{L} = 1.0 \\times 10^{4}$\n  - $Pr = 7.0$\n  - $s = 3$ (points per smallest scale)\n  - $C = 0.5$ (CFL number)\n  - $n = 10$ (large-eddy turnover times)\n  - $q = 2.0 \\times 10^{5}$ (ops/point/step)\n  - $R = 1.0 \\times 10^{17}$ (FLOPS, sustained machine performance)\n- Required output: Wall-clock time in hours, rounded to three significant figures.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, using standard Kolmogorov and Batchelor theories for turbulence scaling, which are foundational in fluid mechanics. It is well-posed, providing all necessary definitions, relations, and numerical values to calculate a unique answer. The language is objective and precise. The parameters given ($Re_L$, $Pr$, etc.) are physically and computationally realistic for a simulation on an exascale system. The problem is a standard, albeit complex, estimation problem in computational fluid dynamics and is not trivial or ill-posed.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be derived.\n\nThe objective is to compute the total wall-clock time, $T_{\\text{wall}}$, which is the total number of floating-point operations, $F_{\\text{total}}$, divided by the sustained machine performance, $R$.\n$$T_{\\text{wall}} = \\frac{F_{\\text{total}}}{R}$$\nThe total number of floating-point operations is the product of the number of grid points $N_{\\text{grid}}$, the number of time steps $N_{t}$, and the computational cost per grid point per time step $q$.\n$$F_{\\text{total}} = N_{\\text{grid}} \\times N_{t} \\times q$$\nWe must first derive expressions for $N_{\\text{grid}}$ and $N_{t}$ in terms of the given dimensionless parameters.\n\n**Derivation of the number of grid points, $N_{\\text{grid}}$**\n\nFirst, we establish the relationship between the smallest physical scale and the large-scale parameters $Re_{L}$ and $Pr$. The problem states that for $Pr \\ge 1$, the smallest scale to be resolved is the Batchelor scale, $\\eta_{B}$.\nThe scaling for the mean kinetic energy dissipation rate is given as $\\varepsilon \\sim U^{3}/L$. We assume a constant of proportionality of unity for this scaling estimate, so $\\varepsilon = U^{3}/L$.\nThe Kolmogorov microscale $\\eta$ is defined as:\n$$\\eta = \\left(\\frac{\\nu^{3}}{\\varepsilon}\\right)^{1/4}$$\nSubstituting the expression for $\\varepsilon$:\n$$\\eta = \\left(\\frac{\\nu^{3}}{U^{3}/L}\\right)^{1/4} = \\left(\\frac{\\nu^{3}L}{U^{3}}\\right)^{1/4} = L \\left(\\frac{\\nu}{UL}\\right)^{3/4}$$\nUsing the definition of the Reynolds number, $Re_{L} = UL/\\nu$:\n$$\\eta = L (Re_{L})^{-3/4}$$\nThe Batchelor scale $\\eta_{B}$ is given for $Pr \\ge 1$ as:\n$$\\eta_{B} = \\frac{\\eta}{Pr^{1/2}} = L Re_{L}^{-3/4} Pr^{-1/2}$$\nThe grid spacing $\\Delta x$ is set to resolve this scale with $s$ points:\n$$\\Delta x = \\frac{\\eta_{B}}{s} = \\frac{L Re_{L}^{-3/4} Pr^{-1/2}}{s}$$\nThe total number of grid points $N_{\\text{grid}}$ for a cubic domain of side length $L$ is:\n$$N_{\\text{grid}} = \\left(\\frac{L}{\\Delta x}\\right)^{3} = \\left(\\frac{L}{L Re_{L}^{-3/4} Pr^{-1/2} / s}\\right)^{3} = \\left(s Re_{L}^{3/4} Pr^{1/2}\\right)^{3}$$\n$$N_{\\text{grid}} = s^{3} Re_{L}^{9/4} Pr^{3/2}$$\n\n**Derivation of the number of time steps, $N_{t}$**\n\nThe total number of time steps $N_{t}$ is the total simulation time $T_{\\text{sim}}$ divided by the time step size $\\Delta t$.\n$$N_{t} = \\frac{T_{\\text{sim}}}{\\Delta t}$$\nThe total simulation time is given as $n$ large-eddy turnover times, $T_{e} = L/U$:\n$$T_{\\text{sim}} = n \\frac{L}{U}$$\nThe time step is constrained by the CFL condition:\n$$\\Delta t = C \\frac{\\Delta x}{U}$$\nSubstituting the expression for $\\Delta x$:\n$$\\Delta t = C \\frac{L Re_{L}^{-3/4} Pr^{-1/2}}{s U}$$\nNow, we can compute $N_{t}$:\n$$N_{t} = \\frac{n L / U}{C L Re_{L}^{-3/4} Pr^{-1/2} / (s U)} = \\frac{nL}{U} \\frac{sU}{C L Re_{L}^{-3/4} Pr^{-1/2}}$$\n$$N_{t} = \\frac{n s}{C} Re_{L}^{3/4} Pr^{1/2}$$\n\n**Calculation of Total Operations and Wall-Clock Time**\n\nNow we combine these results to find the total floating-point operations $F_{\\text{total}}$:\n$$F_{\\text{total}} = N_{\\text{grid}} \\times N_{t} \\times q = (s^{3} Re_{L}^{9/4} Pr^{3/2}) \\times \\left(\\frac{n s}{C} Re_{L}^{3/4} Pr^{1/2}\\right) \\times q$$\n$$F_{\\text{total}} = \\frac{q n s^{4}}{C} Re_{L}^{(9/4 + 3/4)} Pr^{(3/2 + 1/2)} = \\frac{q n s^{4}}{C} Re_{L}^{3} Pr^{2}$$\nThe wall-clock time in seconds is $T_{\\text{wall}} = F_{\\text{total}} / R$:\n$$T_{\\text{wall}} = \\frac{q n s^{4} Re_{L}^{3} Pr^{2}}{C R}$$\nNow, we substitute the given numerical values:\n$q = 2.0 \\times 10^{5}$, $n = 10$, $s = 3$, $Re_{L} = 1.0 \\times 10^{4}$, $Pr = 7.0$, $C = 0.5$, $R = 1.0 \\times 10^{17}$.\n$$T_{\\text{wall}} = \\frac{(2.0 \\times 10^{5}) \\times 10 \\times (3)^{4} \\times (1.0 \\times 10^{4})^{3} \\times (7.0)^{2}}{0.5 \\times (1.0 \\times 10^{17})}$$\n$$T_{\\text{wall}} = \\frac{(2.0 \\times 10^{5}) \\times 10 \\times 81 \\times (10^{12}) \\times 49}{0.5 \\times 10^{17}}$$\n$$T_{\\text{wall}} = \\frac{2.0 \\times 10 \\times 81 \\times 49}{0.5} \\times \\frac{10^{5} \\times 10^{12}}{10^{17}}$$\n$$T_{\\text{wall}} = \\frac{79380}{0.5} \\times 10^{0} = 158760 \\text{ seconds}$$\n\nFinally, we convert the wall-clock time from seconds to hours. There are $3600$ seconds in one hour.\n$$T_{\\text{wall, hours}} = \\frac{158760}{3600} = 44.1$$\nThe problem requires the answer to be rounded to three significant figures. The calculated value $44.1$ already has three significant figures.",
            "answer": "$$\\boxed{44.1}$$"
        },
        {
            "introduction": "A deep understanding of similarity requires scrutinizing the assumptions that underpin our dimensionless parameters. This advanced practice challenges the common ideal-gas formulation of the Mach number ($Ma$) by returning to its fundamental thermodynamic definition. You will derive the speed of sound for a non-ideal gas and computationally assess how real-gas effects can cause the similarity scaling based on an ideal-gas Mach number to break down. This exercise highlights the critical importance of selecting appropriate physical models when dealing with flows at high pressures or temperatures where ideal-gas assumptions fail .",
            "id": "3361892",
            "problem": "A steady, one-dimensional nozzle flow with variable temperature is to be analyzed using Mach-number-based similarity. The Mach number is defined in terms of the flow speed and the thermodynamic speed of sound, and the speed of sound is defined from equilibrium thermodynamics. Use a real-gas model for the equation of state, and quantitatively assess how non-ideal thermodynamics in conjunction with strong temperature variation can degrade Mach-number-based similarity, by comparing a real-gas Mach number against the ideal-gas Mach number computed from the same local state and mass flux.\n\nStart from the following fundamental bases only:\n- The definition of Mach number $M$ as $M = u/a$, where $u$ is the flow speed and $a$ is the thermodynamic speed of sound.\n- Mass flux definition $j = \\rho u$, so that $u = j/\\rho$ for steady one-dimensional flow.\n- The thermodynamic definition of the speed of sound $a$ through the isentropic derivative of pressure with respect to density.\n- Standard thermodynamic identities, including Maxwell relations and the definition of specific heat at constant volume $c_v$.\n\nUse the van der Waals equation of state expressed on a mass-specific basis for a single-component gas:\n$$\np(\\rho,T) = \\frac{R\\,T\\,\\rho}{1 - b\\,\\rho} - a\\,\\rho^2,\n$$\nwhere $p$ is pressure, $\\rho$ is mass density, $T$ is temperature, $R$ is the specific gas constant, and $a$ and $b$ are van der Waals parameters in mass-specific units. The specific gas constant is $R = R_u/M$, where $R_u$ is the universal gas constant and $M$ is molar mass. The mass-specific van der Waals parameters are $a = a_m/M^2$ and $b = b_m/M$, where $a_m$ and $b_m$ are the conventional molar-based van der Waals parameters. Assume $c_v$ is constant (equal to its ideal-gas value for the gas at the stated temperature range), and recall that for an ideal gas with constant specific heats, $c_p - c_v = R$ and $\\gamma = c_p/c_v = 1 + R/c_v$.\n\nTasks:\n1. From the fundamental definition of the speed of sound in terms of the isentropic pressure-density derivative, use only thermodynamic identities and the chain rule to obtain a computable expression for $a^2$ in terms of partial derivatives of $p(\\rho,T)$ and the constant $c_v$. Then, for the van der Waals equation of state above, obtain expressions for the needed partial derivatives. Do not assume any ideal-gas shortcut for the final expression of $a^2$.\n2. Implement a program that, for each test case below, computes:\n   - The real-gas speed of sound $a_{\\text{real}}$ using your expression for $a^2$.\n   - The ideal-gas speed of sound $a_{\\text{ideal}}$ using the corresponding ideal-gas $\\gamma$ (constructed from $R$ and the given $c_v$) and $R$, that is consistent with the same gas.\n   - The real-gas Mach number $M_{\\text{real}} = (j/\\rho)/a_{\\text{real}}$ and the ideal-gas Mach number $M_{\\text{ideal}} = (j/\\rho)/a_{\\text{ideal}}$ evaluated at the same local $\\rho$, $T$, and $j$.\n   - A dimensionless degradation metric $\\Delta = |M_{\\text{real}} - M_{\\text{ideal}}|/M_{\\text{real}}$.\n3. Your program must output, in a single line, a list of the $\\Delta$ values for the test suite in the order given, each rounded to six decimal places, with no units (dimensionless). The format must be a single comma-separated list enclosed in square brackets, for example `[...]`.\n\nUse the following constants and test suite. All numbers are to be interpreted in the specified units, and all computations must be carried out using the stated units.\n\nUniversal constant:\n- Universal gas constant: $R_u = 8.314462618~\\text{J} \\cdot \\text{mol}^{-1} \\cdot \\text{K}^{-1}$.\n\nGas data and test cases:\n- Gas A (Nitrogen-like):\n  - Molar mass: $M = 0.0280134~\\text{kg} \\cdot \\text{mol}^{-1}$.\n  - van der Waals molar parameters: $a_m = 0.1352~\\text{Pa} \\cdot \\text{m}^6 \\cdot \\text{mol}^{-2}$, $b_m = 3.87\\times 10^{-5}~\\text{m}^3 \\cdot \\text{mol}^{-1}$.\n  - Constant molar $c_v$: $c_{v,m} = 2.5\\,R_u~\\text{J} \\cdot \\text{mol}^{-1} \\cdot \\text{K}^{-1}$.\n  - Test cases for Gas A:\n    - Case A1: $\\rho = 5.0~\\text{kg} \\cdot \\text{m}^{-3}$, $T = 300.0~\\text{K}$, $j = 500.0~\\text{kg} \\cdot \\text{m}^{-2} \\cdot \\text{s}^{-1}$.\n    - Case A2: $\\rho = 10.0~\\text{kg} \\cdot \\text{m}^{-3}$, $T = 1200.0~\\text{K}$, $j = 500.0~\\text{kg} \\cdot \\text{m}^{-2} \\cdot \\text{s}^{-1}$.\n    - Case A3: $\\rho = 0.5~\\text{kg} \\cdot \\text{m}^{-3}$, $T = 300.0~\\text{K}$, $j = 100.0~\\text{kg} \\cdot \\text{m}^{-2} \\cdot \\text{s}^{-1}$.\n- Gas B (Carbon-dioxide-like):\n  - Molar mass: $M = 0.0440095~\\text{kg} \\cdot \\text{mol}^{-1}$.\n  - van der Waals molar parameters: $a_m = 0.3592~\\text{Pa} \\cdot \\text{m}^6 \\cdot \\text{mol}^{-2}$, $b_m = 4.267\\times 10^{-5}~\\text{m}^3 \\cdot \\text{mol}^{-1}$.\n  - Constant molar $c_v$: $c_{v,m} = 3.5\\,R_u~\\text{J} \\cdot \\text{mol}^{-1} \\cdot \\text{K}^{-1}$.\n  - Test cases for Gas B:\n    - Case B1: $\\rho = 60.0~\\text{kg} \\cdot \\text{m}^{-3}$, $T = 300.0~\\text{K}$, $j = 200.0~\\text{kg} \\cdot \\text{m}^{-2} \\cdot \\text{s}^{-1}$.\n    - Case B2: $\\rho = 200.0~\\text{kg} \\cdot \\text{m}^{-3}$, $T = 800.0~\\text{K}$, $j = 2000.0~\\text{kg} \\cdot \\text{m}^{-2} \\cdot \\text{s}^{-1}$.\n\nImplementation details to respect:\n- Convert the molar van der Waals parameters $(a_m,b_m)$ and molar heat capacity $c_{v,m}$ to mass-specific values via $a = a_m/M^2$, $b = b_m/M$, $c_v = c_{v,m}/M$, and $R = R_u/M$ for each gas.\n- For ideal-gas comparison, compute $\\gamma = 1 + R/c_v$ for the same $R$ and $c_v$ just defined, and then $a_{\\text{ideal}} = \\sqrt{\\gamma R T}$.\n- You must compute $a_{\\text{real}}$ using only the thermodynamic definition of the speed of sound and your derived expression in terms of $p(\\rho,T)$ and its derivatives, not by any empirical or tabulated sound-speed formula.\n\nNumerical output requirements:\n- For each case, compute $\\Delta = \\left|M_{\\text{real}} - M_{\\text{ideal}}\\right|/M_{\\text{real}}$ and report it as a decimal (dimensionless), rounded to six decimal places.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the same order as the five test cases $[\\text{A1},\\text{A2},\\text{A3},\\text{B1},\\text{B2}]$.",
            "solution": "The problem requires a quantitative assessment of the deviation of a real-gas Mach number from its ideal-gas counterpart under specified thermodynamic conditions. This involves deriving the expression for the speed of sound in a van der Waals gas from fundamental thermodynamic principles and then applying this to a series of test cases.\n\n### Task 1: Derivation of the Speed of Sound Expression\n\nThe first task is to derive a computable expression for the square of the speed of sound, $a^2$, for a general fluid described by an equation of state $p(\\rho, T)$ with a constant specific heat at constant volume, $c_v$.\n\nThe thermodynamic definition of the speed of sound squared is the isentropic derivative of pressure with respect to density:\n$$\na^2 = \\left(\\frac{\\partial p}{\\partial \\rho}\\right)_s\n$$\nwhere $s$ is the specific entropy. Since the equation of state is provided in terms of density $\\rho$ and temperature $T$, we must express this derivative in terms of partial derivatives with respect to $\\rho$ and $T$.\n\nWe consider pressure $p$ as a function $p(\\rho, T)$. Applying the chain rule for derivatives, we can write the change in pressure as:\n$$\ndp = \\left(\\frac{\\partial p}{\\partial \\rho}\\right)_T d\\rho + \\left(\\frac{\\partial p}{\\partial T}\\right)_\\rho dT\n$$\nDividing by $d\\rho$ while holding entropy $s$ constant gives:\n$$\n\\left(\\frac{\\partial p}{\\partial \\rho}\\right)_s = \\left(\\frac{\\partial p}{\\partial \\rho}\\right)_T + \\left(\\frac{\\partial p}{\\partial T}\\right)_\\rho \\left(\\frac{\\partial T}{\\partial \\rho}\\right)_s\n$$\n\nTo proceed, we need to evaluate the term $(\\partial T / \\partial \\rho)_s$. We use the cyclic chain rule for the variables $T, \\rho, s$:\n$$\n\\left(\\frac{\\partial T}{\\partial \\rho}\\right)_s \\left(\\frac{\\partial \\rho}{\\partial s}\\right)_T \\left(\\frac{\\partial s}{\\partial T}\\right)_\\rho = -1\n$$\nRearranging for $(\\partial T / \\partial \\rho)_s$ yields:\n$$\n\\left(\\frac{\\partial T}{\\partial \\rho}\\right)_s = - \\frac{(\\partial s / \\partial \\rho)_T}{(\\partial s / \\partial T)_\\rho}\n$$\nThe partial derivatives of entropy can be found using standard thermodynamic relations. The specific heat at constant volume (or constant density) is defined as:\n$$\nc_v = T \\left(\\frac{\\partial s}{\\partial T}\\right)_\\rho \\quad \\implies \\quad \\left(\\frac{\\partial s}{\\partial T}\\right)_\\rho = \\frac{c_v}{T}\n$$\nFrom the Maxwell relations derived from the Helmholtz free energy $f = u - Ts$, we have:\n$$\n\\left(\\frac{\\partial s}{\\partial v}\\right)_T = \\left(\\frac{\\partial p}{\\partial T}\\right)_v\n$$\nwhere $v=1/\\rho$ is the specific volume. Using the chain rule, we can change the variable from $v$ to $\\rho$:\n$$\n\\left(\\frac{\\partial s}{\\partial \\rho}\\right)_T = \\left(\\frac{\\partial s}{\\partial v}\\right)_T \\left(\\frac{\\partial v}{\\partial \\rho}\\right)_T = \\left(\\frac{\\partial p}{\\partial T}\\right)_v \\left(-\\frac{1}{\\rho^2}\\right)\n$$\nSince holding $v$ constant is equivalent to holding $\\rho$ constant, $(\\partial p / \\partial T)_v = (\\partial p / \\partial T)_\\rho$. Thus,\n$$\n\\left(\\frac{\\partial s}{\\partial \\rho}\\right)_T = -\\frac{1}{\\rho^2} \\left(\\frac{\\partial p}{\\partial T}\\right)_\\rho\n$$\nSubstituting these expressions for entropy derivatives back into the equation for $(\\partial T / \\partial \\rho)_s$:\n$$\n\\left(\\frac{\\partial T}{\\partial \\rho}\\right)_s = - \\frac{- \\frac{1}{\\rho^2} (\\partial p / \\partial T)_\\rho}{c_v / T} = \\frac{T}{c_v \\rho^2} \\left(\\frac{\\partial p}{\\partial T}\\right)_\\rho\n$$\nFinally, substituting this back into the expression for $a^2$:\n$$\na^2 = \\left(\\frac{\\partial p}{\\partial \\rho}\\right)_T + \\left(\\frac{\\partial p}{\\partial T}\\right)_\\rho \\left[ \\frac{T}{c_v \\rho^2} \\left(\\frac{\\partial p}{\\partial T}\\right)_\\rho \\right]\n$$\nThis simplifies to the general expression for the speed of sound squared for a fluid with a known equation of state $p(\\rho, T)$ and constant $c_v$:\n$$\na^2 = \\left(\\frac{\\partial p}{\\partial \\rho}\\right)_T + \\frac{T}{c_v \\rho^2} \\left[ \\left(\\frac{\\partial p}{\\partial T}\\right)_\\rho \\right]^2\n$$\nNow, we apply this general result to the van der Waals equation of state:\n$$\np(\\rho, T) = \\frac{R\\,T\\,\\rho}{1 - b\\,\\rho} - a\\,\\rho^2\n$$\nWe compute the required partial derivatives:\n1.  Derivative with respect to temperature at constant density:\n    $$\n    \\left(\\frac{\\partial p}{\\partial T}\\right)_\\rho = \\frac{\\partial}{\\partial T}\\left(\\frac{R\\,T\\,\\rho}{1 - b\\,\\rho} - a\\,\\rho^2\\right) = \\frac{R\\,\\rho}{1 - b\\,\\rho}\n    $$\n2.  Derivative with respect to density at constant temperature:\n    $$\n    \\left(\\frac{\\partial p}{\\partial \\rho}\\right)_T = \\frac{\\partial}{\\partial \\rho}\\left(\\frac{R\\,T\\,\\rho}{1 - b\\,\\rho} - a\\,\\rho^2\\right) = \\frac{(RT)(1-b\\rho) - (RT\\rho)(-b)}{(1-b\\rho)^2} - 2a\\rho = \\frac{R\\,T}{(1-b\\rho)^2} - 2a\\rho\n    $$\nSubstituting these derivatives into our general expression for $a^2$:\n$$\na_{\\text{real}}^2 = \\left(\\frac{R\\,T}{(1-b\\rho)^2} - 2a\\rho\\right) + \\frac{T}{c_v \\rho^2} \\left(\\frac{R\\rho}{1-b\\rho}\\right)^2\n$$\n$$\na_{\\text{real}}^2 = \\frac{R\\,T}{(1-b\\rho)^2} - 2a\\rho + \\frac{T R^2 \\rho^2}{c_v \\rho^2 (1-b\\rho)^2}\n$$\n$$\na_{\\text{real}}^2 = \\frac{R\\,T}{(1-b\\rho)^2} - 2a\\rho + \\frac{R^2 T}{c_v (1-b\\rho)^2}\n$$\nCombining the terms with the common denominator $(1-b\\rho)^2$:\n$$\na_{\\text{real}}^2 = \\frac{R\\,T(1 + R/c_v)}{(1-b\\rho)^2} - 2a\\rho\n$$\nUsing the definition of the heat capacity ratio for the corresponding ideal gas, $\\gamma = 1 + R/c_v$, we arrive at the final expression for the speed of sound in a van der Waals gas:\n$$\na_{\\text{real}}^2 = \\frac{\\gamma R T}{(1-b\\rho)^2} - 2a\\rho\n$$\n\n### Task 2  3: Computational Implementation\n\nThe program will execute the following steps for each test case provided:\n\n1.  **Gas-Specific Parameters**: The molar parameters ($a_m, b_m, c_{v,m}$) are converted to mass-specific parameters ($a, b, c_v$) using the molar mass $M$. The specific gas constant $R$ is also calculated.\n    -   $R = R_u/M$\n    -   $a = a_m/M^2$\n    -   $b = b_m/M$\n    -   $c_v = c_{v,m}/M$\n\n2.  **Ideal Gas Benchmark**: The ideal-gas speed of sound, $a_{\\text{ideal}}$, is calculated using the standard formula. The heat capacity ratio $\\gamma$ is computed from the mass-specific constants $R$ and $c_v$.\n    -   $\\gamma = 1 + R/c_v$\n    -   $a_{\\text{ideal}} = \\sqrt{\\gamma R T}$\n\n3.  **Real Gas Sound Speed**: The real-gas speed of sound, $a_{\\text{real}}$, is calculated using the formula derived in Task 1.\n    -   $a_{\\text{real}} = \\sqrt{\\frac{\\gamma R T}{(1-b\\rho)^2} - 2a\\rho}$\n\n4.  **Mach Numbers and Degradation Metric**: The flow speed $u$ is determined from the given mass flux $j$ and density $\\rho$ as $u = j/\\rho$. The real and ideal Mach numbers are then computed.\n    -   $M_{\\text{real}} = u / a_{\\text{real}}$\n    -   $M_{\\text{ideal}} = u / a_{\\text{ideal}}$\n    The dimensionless degradation metric $\\Delta$ is calculated as specified:\n    -   $\\Delta = \\frac{|M_{\\text{real}} - M_{\\text{ideal}}|}{M_{\\text{real}}}$\n\nThe final program implements this logic, iterates through the five test cases, and formats the output as a comma-separated list of $\\Delta$ values, rounded to six decimal places, enclosed in square brackets.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of comparing real-gas and ideal-gas Mach numbers\n    for a van der Waals gas under different conditions.\n    \"\"\"\n\n    # Universal constant\n    R_u = 8.314462618  # J mol^-1 K^-1\n\n    # Test cases data structure:\n    # (Gas Name, M, a_m, b_m, c_v_m_factor, rho, T, j)\n    # where c_v_m_factor is the multiplier for R_u\n    test_cases = [\n        # Gas A cases\n        ('A1', 0.0280134, 0.1352, 3.87e-5, 2.5, 5.0, 300.0, 500.0),\n        ('A2', 0.0280134, 0.1352, 3.87e-5, 2.5, 10.0, 1200.0, 500.0),\n        ('A3', 0.0280134, 0.1352, 3.87e-5, 2.5, 0.5, 300.0, 100.0),\n        # Gas B cases\n        ('B1', 0.0440095, 0.3592, 4.267e-5, 3.5, 60.0, 300.0, 200.0),\n        ('B2', 0.0440095, 0.3592, 4.267e-5, 3.5, 200.0, 800.0, 2000.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        _case_name, M, a_m, b_m, c_v_m_factor, rho, T, j = case\n\n        # 1. Calculate mass-specific parameters\n        # M: molar mass (kg/mol)\n        # a_m: vdW param (Pa m^6 mol^-2)\n        # b_m: vdW param (m^3 mol^-1)\n        # c_v_m: molar heat capacity (J mol^-1 K^-1)\n        \n        R = R_u / M  # Specific gas constant (J kg^-1 K^-1)\n        a = a_m / M**2  # Mass-specific vdW 'a' (Pa m^6 kg^-2 or m^5 kg^-1 s^-2)\n        b = b_m / M    # Mass-specific vdW 'b' (m^3 kg^-1)\n        c_v_m = c_v_m_factor * R_u\n        c_v = c_v_m / M  # Specific heat at constant volume (J kg^-1 K^-1)\n\n        # 2. Calculate ideal gas sound speed\n        gamma = 1.0 + R / c_v\n        a_ideal_sq = gamma * R * T\n        if a_ideal_sq  0:\n            raise ValueError(f\"Case {_case_name}: Negative a_ideal_sq encountered.\")\n        a_ideal = np.sqrt(a_ideal_sq)\n\n        # 3. Calculate real gas (van der Waals) sound speed\n        # Check for physical validity of the state (denominator must be positive)\n        vdw_denom = 1.0 - b * rho\n        if vdw_denom = 0:\n            raise ValueError(f\"Case {_case_name}: Unphysical state, 1 - b*rho = 0.\")\n        \n        # a_real^2 = (gamma * R * T) / (1 - b*rho)^2 - 2*a*rho\n        a_real_sq = (gamma * R * T) / (vdw_denom**2) - 2.0 * a * rho\n        if a_real_sq  0:\n            # This indicates an unstable thermodynamic state (spinodal decomposition)\n            raise ValueError(f\"Case {_case_name}: Negative a_real_sq encountered (unstable state).\")\n        a_real = np.sqrt(a_real_sq)\n\n        # 4. Calculate Mach numbers and degradation metric\n        u = j / rho  # Flow speed (m/s)\n\n        M_real = u / a_real\n        M_ideal = u / a_ideal\n\n        # Avoid division by zero if M_real is zero\n        if M_real == 0:\n            # If M_real is 0, u must be 0, so M_ideal is also 0. Delta is 0.\n            delta = 0.0\n        else:\n            delta = abs(M_real - M_ideal) / M_real\n        \n        results.append(round(delta, 6))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}