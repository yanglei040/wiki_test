{
    "hands_on_practices": [
        {
            "introduction": "在计算流体动力学（CFD）中，连接经典流体力学理论与数值实践至关重要。本练习旨在搭建这座桥梁，通过一个经典的层流边界层解，推导在湍流模型中至关重要的壁面单位量，即摩擦速度 $u_{\\tau}$ 和无量纲壁面距离 $y^+$。通过此练习，您将理解理论解如何直接指导CFD网格设计，并为评估壁面附近的网格分辨率奠定基础 。",
            "id": "3389986",
            "problem": "一种密度为 $\\rho$、动力粘度为 $\\mu$ 的不可压缩牛顿流体，以均匀的自由来流速度 $U_{\\infty}$ 流过一块与流动方向对齐的光滑、等温、半无限长平板。对于 $x>0$ 的层流流动，壁面剪切应力由 $\\tau_{w}(x) = 0.332\\,\\rho\\,U_{\\infty}^{2}\\,\\sqrt{\\frac{\\nu}{U_{\\infty}\\,x}}$ 给出，其中 $\\nu = \\mu/\\rho$。假设第一个近壁网格的高度为 $\\Delta y$，请推导摩擦速度 $u_{\\tau}(x)$ 和无量纲壁面距离 $y^{+}(x)$ 的表达式。",
            "solution": "问题陈述已经过验证，被认为是科学上合理的、适定的和客观的。它提供了根据流体力学中的基本定义推导所求量所需的所有必要信息。\n\n推导过程分两部分进行。首先，我们将推导摩擦速度 $u_{\\tau}(x)$ 的表达式，其次，我们将推导无量纲壁面距离 $y^{+}(x)$ 的表达式。\n\n摩擦速度 $u_{\\tau}$ 是一个具有速度单位的量，根据壁面剪切应力 $\\tau_{w}$ 和流体密度 $\\rho$ 定义。其基本定义为：\n$$\nu_{\\tau} = \\sqrt{\\frac{\\tau_{w}}{\\rho}}\n$$\n问题给出了层流流过平板时的局部壁面剪切应力 $\\tau_{w}(x)$ 的表达式：\n$$\n\\tau_{w}(x) = 0.332\\,\\rho\\,U_{\\infty}^{2}\\,\\sqrt{\\frac{\\nu}{U_{\\infty}\\,x}}\n$$\n其中 $U_{\\infty}$ 是自由来流速度，$\\nu$ 是运动粘度，$x$ 是流向坐标。将 $\\tau_{w}(x)$ 的这个表达式代入 $u_{\\tau}$ 的定义，得到作为 $x$ 的函数的摩擦速度：\n$$\nu_{\\tau}(x) = \\sqrt{\\frac{1}{\\rho} \\left( 0.332\\,\\rho\\,U_{\\infty}^{2}\\,\\sqrt{\\frac{\\nu}{U_{\\infty}\\,x}} \\right)}\n$$\n密度 $\\rho$ 被消去：\n$$\nu_{\\tau}(x) = \\sqrt{0.332\\,U_{\\infty}^{2}\\,\\left(\\frac{\\nu}{U_{\\infty}\\,x}\\right)^{1/2}}\n$$\n我们可以通过应用指数的性质来简化这个表达式：\n$$\nu_{\\tau}(x) = (0.332)^{1/2} \\, (U_{\\infty}^{2})^{1/2} \\, \\left(\\left(\\frac{\\nu}{U_{\\infty}\\,x}\\right)^{1/2}\\right)^{1/2}\n$$\n$$\nu_{\\tau}(x) = \\sqrt{0.332} \\, U_{\\infty} \\, \\left(\\frac{\\nu}{U_{\\infty}\\,x}\\right)^{1/4}\n$$\n将指数 $1/4$ 分配给括号内的各项，得到：\n$$\nu_{\\tau}(x) = \\sqrt{0.332} \\, U_{\\infty} \\, \\frac{\\nu^{1/4}}{U_{\\infty}^{1/4} \\, x^{1/4}}\n$$\n合并包含 $U_{\\infty}$ 的项，得到摩擦速度的最终简化表达式：\n$$\nu_{\\tau}(x) = \\sqrt{0.332} \\, U_{\\infty}^{1 - 1/4} \\, \\nu^{1/4} \\, x^{-1/4} = \\sqrt{0.332} \\, U_{\\infty}^{3/4} \\, \\nu^{1/4} \\, x^{-1/4}\n$$\n这个表达式给出了以速度单位（$\\mathrm{m}\\,\\mathrm{s}^{-1}$）表示的摩擦速度，符合要求。\n\n接下来，我们推导无量纲壁面距离 $y^{+}$ 的表达式。$y^{+}$ 的基本定义是：\n$$\ny^{+} = \\frac{y u_{\\tau}}{\\nu}\n$$\n其中 $y$ 是与壁面的物理距离。在计算流体动力学 (CFD) 的背景下，$y^{+}$ 是评估近壁面网格分辨率的关键参数。问题指定了均匀的近壁第一层网格高度 $\\Delta y$。无量纲距离通常在第一层网格内的某个特征高度处计算。问题要求 $y^{+}(x)$ 的表达式以 $\\Delta y$ 表示，这意味着我们应将此高度用作与壁面的特征物理距离。因此，我们设 $y = \\Delta y$。这给出了第一层网格顶部处的 $y^{+}$ 值。\n$$\ny^{+}(x) = \\frac{\\Delta y \\, u_{\\tau}(x)}{\\nu}\n$$\n现在，我们代入之前推导出的 $u_{\\tau}(x)$ 表达式：\n$$\ny^{+}(x) = \\frac{\\Delta y}{\\nu} \\left( \\sqrt{0.332} \\, U_{\\infty}^{3/4} \\, \\nu^{1/4} \\, x^{-1/4} \\right)\n$$\n我们可以通过合并包含运动粘度 $\\nu$ 的项来简化这个表达式：\n$$\ny^{+}(x) = \\sqrt{0.332} \\, \\Delta y \\, U_{\\infty}^{3/4} \\, \\nu^{1/4 - 1} \\, x^{-1/4}\n$$\n$$\ny^{+}(x) = \\sqrt{0.332} \\, \\Delta y \\, U_{\\infty}^{3/4} \\, \\nu^{-3/4} \\, x^{-1/4}\n$$\n这个表达式给出了无量纲壁面距离 $y^{+}$ 作为 $x$ 和网格参数 $\\Delta y$ 的函数。该表达式是无量纲的，符合要求。\n\n因此，所求的两个表达式为：\n1. 摩擦速度：$u_{\\tau}(x) = \\sqrt{0.332} \\, U_{\\infty}^{3/4} \\, \\nu^{1/4} \\, x^{-1/4}$\n2. 无量纲壁面距离：$y^{+}(x) = \\sqrt{0.332} \\, \\Delta y \\, U_{\\infty}^{3/4} \\, \\nu^{-3/4} \\, x^{-1/4}$\n这些是基于所提供的信息和基本定义得出的最终、简化的闭式解析表达式。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\sqrt{0.332} \\, U_{\\infty}^{3/4} \\, \\nu^{1/4} \\, x^{-1/4}  \\sqrt{0.332} \\, \\Delta y \\, U_{\\infty}^{3/4} \\, \\nu^{-3/4} \\, x^{-1/4} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "理解了壁面物理量的重要性之后，下一步是学习如何从离散的模拟结果中精确地计算它们。本练习应对了在壁面附近使用非均匀网格这一实际挑战，指导您推导出一个二阶精度的壁面剪切应力计算格式。掌握这项技能对于确保CFD模拟的可靠性和准确性至关重要 。",
            "id": "3389984",
            "problem": "给定一个与笛卡尔坐标轴对齐的平坦、不可渗透的壁面，壁面法向用 $n$ 表示，沿壁面的切向速度分量定义为 $u_t(n)$。流体是牛顿流体，具有恒定的动力粘度 $\\mu$ 和恒定的密度 $\\rho$。壁面可以是静止的（无滑移）、以规定的壁面速度 $U_w$ 切向移动的（无滑移），或者是自由滑移的（壁面切向应力为零）。牛顿流体的切向壁面剪切应力由以下基本本构关系定义：\n$$\n\\tau_w = \\mu \\left.\\frac{\\partial u_t}{\\partial n}\\right|_{w}.\n$$\n您正在使用一种在壁面法向方向上、基于局部非均匀网格的单元中心有限体积离散化方法。第一个近壁单元的厚度为 $\\Delta y_1$，第二个单元的厚度为 $\\Delta y_2$。这些单元的中心距离壁面的距离分别为 $y_1 = \\Delta y_1/2$ 和 $y_2 = \\Delta y_1 + \\Delta y_2/2$。唯一可用的切向速度数据是单元中心的值 $u_1 = u_t(y_1)$ 和 $u_2 = u_t(y_2)$。没有其他离壁点可用。\n\n从上述基本定义和适当的壁面边界条件出发，从第一性原理推导出一个壁面法向梯度 $\\left.\\frac{\\partial u_t}{\\partial n}\\right|_{w}$ 的二阶精度单边近似。该近似仅使用两个内部单元中心值 $u_1$ 和 $u_2$ 以及边界条件所隐含的壁面值，并且对于非均匀间距 $\\Delta y_1$ 和 $\\Delta y_2$ 仍然有效。使用此梯度计算壁面剪切应力 $\\tau_w$。摩擦速度定义为\n$$\nu_\\tau = \\sqrt{\\frac{|\\tau_w|}{\\rho}}.\n$$\n对于自由滑移壁面，边界条件要求切向应力为零，因此切向速度的壁面法向梯度也为零；请相应地处理这种情况。\n\n您的任务是实现一个程序，为下面给出的每个测试用例计算 $\\tau_w$ 和 $u_\\tau$。所有输入均采用标准的国际单位制（SI单位）指定。您必须生成满足以下要求的输出：\n- 以帕斯卡（Pa）表示 $\\tau_w$，以米每秒（m/s）表示 $u_\\tau$。\n- 将报告的每个 $\\tau_w$ 和 $u_\\tau$ 四舍五入到六位小数。\n- 您的程序应生成单行输出，其中包含结果，格式为由每个案例的子列表组成的逗号分隔列表，不含空格，每个子列表的形式为 $[\\tau_w,u_\\tau]$。例如：$[[\\tau_1,u_{\\tau,1}],[\\tau_2,u_{\\tau,2}],\\ldots]$。\n\n实现以下测试套件：\n- 案例A（无滑移，静止壁面）：$\\Delta y_1 = 1.2\\times 10^{-4}\\,\\text{m}$，$\\Delta y_2 = 2.5\\times 10^{-4}\\,\\text{m}$，$u_1 = 0.04\\,\\text{m/s}$，$u_2 = 0.07\\,\\text{m/s}$，$\\mu = 1.0\\times 10^{-3}\\,\\text{Pa}\\cdot\\text{s}$，$\\rho = 998.2\\,\\text{kg/m}^3$，$U_w = 0\\,\\text{m/s}$。\n- 案例B（无滑移，静止壁面，局部均匀）：$\\Delta y_1 = 5.0\\times 10^{-3}\\,\\text{m}$，$\\Delta y_2 = 5.0\\times 10^{-3}\\,\\text{m}$，$u_1 = 0.20\\,\\text{m/s}$，$u_2 = 0.35\\,\\text{m/s}$，$\\mu = 1.8\\times 10^{-5}\\,\\text{Pa}\\cdot\\text{s}$，$\\rho = 1.225\\,\\text{kg/m}^3$，$U_w = 0\\,\\text{m/s}$。\n- 案例C（自由滑移壁面）：$\\Delta y_1 = 1.0\\times 10^{-3}\\,\\text{m}$，$\\Delta y_2 = 1.5\\times 10^{-3}\\,\\text{m}$，$u_1 = 0.12\\,\\text{m/s}$，$u_2 = 0.125\\,\\text{m/s}$，$\\mu = 1.0\\times 10^{-3}\\,\\text{Pa}\\cdot\\text{s}$，$\\rho = 1000.0\\,\\text{kg/m}^3$，$U_w = 0\\,\\text{m/s}$。\n- 案例D（无滑移，移动壁面）：$\\Delta y_1 = 2.0\\times 10^{-4}\\,\\text{m}$，$\\Delta y_2 = 3.0\\times 10^{-4}\\,\\text{m}$，$u_1 = 0.11\\,\\text{m/s}$，$u_2 = 0.115\\,\\text{m/s}$，$\\mu = 1.5\\times 10^{-3}\\,\\text{Pa}\\cdot\\text{s}$，$\\rho = 1050.0\\,\\text{kg/m}^3$，$U_w = 0.10\\,\\text{m/s}$。\n- 案例E（无滑移，薄第一单元）：$\\Delta y_1 = 1.0\\times 10^{-6}\\,\\text{m}$，$\\Delta y_2 = 1.0\\times 10^{-4}\\,\\text{m}$，$u_1 = 0.005\\,\\text{m/s}$，$u_2 = 0.05\\,\\text{m/s}$，$\\mu = 1.0\\times 10^{-3}\\,\\text{Pa}\\cdot\\text{s}$，$\\rho = 1000.0\\,\\text{kg/m}^3$，$U_w = 0\\,\\text{m/s}$。\n\n您的程序必须实现上述基于推导的二阶单边近似，为每个案例计算 $\\tau_w$ 和 $u_\\tau$，并以精确格式打印单行输出：$[[\\tau_A,u_{\\tau,A}],[\\tau_B,u_{\\tau,B}],[\\tau_C,u_{\\tau,C}],[\\tau_D,u_{\\tau,D}],[\\tau_E,u_{\\tau,E}]]$，所有数字四舍五入到六位小数，不含空格。",
            "solution": "该问题要求计算平坦壁面附近粘性流的壁面剪切应力 $\\tau_w$ 和摩擦速度 $u_\\tau$。解决方案的基础是，使用来自非均匀网格的单元中心速度数据，推导并实现一个用于计算切向速度壁面法向梯度 $\\left.\\frac{\\partial u_t}{\\partial n}\\right|_{w}$ 的二阶精度数值近似。\n\n我们在位置 $n=0$ 处有一个平坦壁面。壁面法向的速度剖面为 $u_t(n)$。可用数据点源自一个单元中心的有限体积格式：\n1. 壁面上的切向速度 $u_w = u_t(0)$，由边界条件确定。对于无滑移条件，$u_w$ 是指定的壁面速度 $U_w$。对于静止壁面，$U_w=0$。\n2. 位于 $y_1 = \\Delta y_1/2$ 处的第一个单元中的单元中心速度 $u_1 = u_t(y_1)$。\n3. 位于 $y_2 = \\Delta y_1 + \\Delta y_2/2$ 处的第二个单元中的单元中心速度 $u_2 = u_t(y_2)$。\n\n问题的核心是利用三个点 $(0, u_w)$、$(y_1, u_1)$ 和 $(y_2, u_2)$，为导数 $u_t'(0)$ 构造一个二阶精度的单边有限差分公式。这可以通过对 $u_1$ 和 $u_2$ 在点 $n=0$ 附近进行泰勒级数展开来实现。设 $u_t'(0)$ 和 $u_t''(0)$ 分别表示在壁面处的一阶和二阶导数。\n\n泰勒级数展开式为：\n$$\nu_1 = u_t(y_1) = u_t(0) + y_1 u_t'(0) + \\frac{y_1^2}{2} u_t''(0) + O(y_1^3)\n$$\n$$\nu_2 = u_t(y_2) = u_t(0) + y_2 u_t'(0) + \\frac{y_2^2}{2} u_t''(0) + O(y_2^3)\n$$\n\n代入 $u_w = u_t(0)$ 并重新整理，我们得到一个关于两个未知数 $u_t'(0)$ 和 $u_t''(0)$ 的二元线性方程组。我们忽略高阶项，这与寻求二阶精度格式的目标是一致的：\n$$\nu_1 - u_w = y_1 u_t'(0) + \\frac{y_1^2}{2} u_t''(0) \\quad (1)\n$$\n$$\nu_2 - u_w = y_2 u_t'(0) + \\frac{y_2^2}{2} u_t''(0) \\quad (2)\n$$\n\n为了求解梯度 $u_t'(0)$，我们可以消去 $u_t''(0)$。将方程 (1) 乘以 $y_2^2$，将方程 (2) 乘以 $y_1^2$：\n$$\ny_2^2 (u_1 - u_w) = y_1 y_2^2 u_t'(0) + \\frac{y_1^2 y_2^2}{2} u_t''(0)\n$$\n$$\ny_1^2 (u_2 - u_w) = y_1^2 y_2 u_t'(0) + \\frac{y_1^2 y_2^2}{2} u_t''(0)\n$$\n\n从第一个新方程中减去第二个新方程，得到：\n$$\ny_2^2 (u_1 - u_w) - y_1^2 (u_2 - u_w) = (y_1 y_2^2 - y_1^2 y_2) u_t'(0)\n$$\n$$\ny_2^2 (u_1 - u_w) - y_1^2 (u_2 - u_w) = y_1 y_2 (y_2 - y_1) u_t'(0)\n$$\n\n解出壁面梯度，记为 $\\left.\\frac{\\partial u_t}{\\partial n}\\right|_{w} = u_t'(0)$，得到所需的、适用于非均匀网格的二阶精度单边公式：\n$$\n\\left.\\frac{\\partial u_t}{\\partial n}\\right|_{w} = \\frac{y_2^2 (u_1 - u_w) - y_1^2 (u_2 - u_w)}{y_1 y_2 (y_2 - y_1)}\n$$\n\n该公式等价于求一个经过三个数据点 $(0, u_w)$、$(y_1, u_1)$ 和 $(y_2, u_2)$ 的唯一二次多项式 $P(n) = an^2 + bn + c$ 在 $n=0$ 处的导数，该导数为 $\\left.\\frac{dP}{dn}\\right|_{n=0} = b$。\n\n一旦计算出壁面梯度，就可以根据牛顿流体本构关系求出壁面剪切应力 $\\tau_w$：\n$$\n\\tau_w = \\mu \\left.\\frac{\\partial u_t}{\\partial n}\\right|_{w}\n$$\n然后根据其定义计算摩擦速度 $u_\\tau$：\n$$\nu_\\tau = \\sqrt{\\frac{|\\tau_w|}{\\rho}}\n$$\n\n每个测试用例的计算步骤如下：\n1.  **确定边界条件：**\n    -   对于无滑移壁面（静止或移动），设置 $u_w = U_w$。继续进行计算。\n    -   对于自由滑移壁面，边界条件根据定义要求切向应力为零，所以 $\\tau_w = 0\\,\\text{Pa}$。这意味着 $\\left.\\frac{\\partial u_t}{\\partial n}\\right|_{w} = 0$，因此 $u_\\tau = 0\\,\\text{m/s}$。在这种特定情况下，不需要使用 $u_1$、$u_2$ 和流体属性的值来确定壁面物理量。\n\n2.  **计算网格点位置（对于无滑移情况）：**\n    -   第一个单元中心：$y_1 = \\Delta y_1 / 2$。\n    -   第二个单元中心：$y_2 = \\Delta y_1 + \\Delta y_2 / 2$。\n\n3.  **计算壁面梯度（对于无滑移情况）：**\n    -   应用推导出的公式计算 $\\left.\\frac{\\partial u_t}{\\partial n}\\right|_{w}$。\n\n4.  **计算 $\\tau_w$ 和 $u_\\tau$（对于无滑移情况）：**\n    -   使用 $\\tau_w$ 和 $u_\\tau$ 的定义，以及计算出的梯度和给定的流体属性 $\\mu$ 和 $\\rho$ 进行计算。\n\n5.  **格式化输出：**\n    -   按要求将最终计算出的 $\\tau_w$ 和 $u_\\tau$ 值四舍五入到六位小数。程序将系统地将此方法应用于每个测试用例。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes wall shear stress and friction velocity for various boundary\n    conditions and grid configurations using a second-order one-sided\n    approximation for the wall-normal velocity gradient.\n    \"\"\"\n    test_cases = [\n        # Case A: no-slip, stationary wall\n        {\n            \"name\": \"A\", \"type\": \"no_slip\",\n            \"delta_y1\": 1.2e-4, \"delta_y2\": 2.5e-4,\n            \"u1\": 0.04, \"u2\": 0.07,\n            \"mu\": 1.0e-3, \"rho\": 998.2, \"Uw\": 0.0\n        },\n        # Case B: no-slip, stationary wall, locally uniform\n        {\n            \"name\": \"B\", \"type\": \"no_slip\",\n            \"delta_y1\": 5.0e-3, \"delta_y2\": 5.0e-3,\n            \"u1\": 0.20, \"u2\": 0.35,\n            \"mu\": 1.8e-5, \"rho\": 1.225, \"Uw\": 0.0\n        },\n        # Case C: free-slip wall\n        {\n            \"name\": \"C\", \"type\": \"free_slip\",\n            \"delta_y1\": 1.0e-3, \"delta_y2\": 1.5e-3,\n            \"u1\": 0.12, \"u2\": 0.125,\n            \"mu\": 1.0e-3, \"rho\": 1000.0, \"Uw\": 0.0\n        },\n        # Case D: no-slip, moving wall\n        {\n            \"name\": \"D\", \"type\": \"no_slip\",\n            \"delta_y1\": 2.0e-4, \"delta_y2\": 3.0e-4,\n            \"u1\": 0.11, \"u2\": 0.115,\n            \"mu\": 1.5e-3, \"rho\": 1050.0, \"Uw\": 0.10\n        },\n        # Case E: no-slip, thin first cell\n        {\n            \"name\": \"E\", \"type\": \"no_slip\",\n            \"delta_y1\": 1.0e-6, \"delta_y2\": 1.0e-4,\n            \"u1\": 0.005, \"u2\": 0.05,\n            \"mu\": 1.0e-3, \"rho\": 1000.0, \"Uw\": 0.0\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        if case[\"type\"] == \"free_slip\":\n            # For a free-slip wall, tangential stress is zero by definition.\n            tau_w = 0.0\n            u_tau = 0.0\n        else: # no_slip case\n            # Extract parameters\n            delta_y1 = case[\"delta_y1\"]\n            delta_y2 = case[\"delta_y2\"]\n            u1 = case[\"u1\"]\n            u2 = case[\"u2\"]\n            mu = case[\"mu\"]\n            rho = case[\"rho\"]\n            u_w = case[\"Uw\"]\n\n            # Calculate cell-center distances from the wall\n            y1 = delta_y1 / 2.0\n            y2 = delta_y1 + delta_y2 / 2.0\n\n            # Calculate the wall-normal velocity gradient using the second-order\n            # one-sided formula derived from first principles.\n            # grad_u = (y2^2 * (u1 - u_w) - y1^2 * (u2 - u_w)) / (y1 * y2 * (y2 - y1))\n            numerator = y2**2 * (u1 - u_w) - y1**2 * (u2 - u_w)\n            denominator = y1 * y2 * (y2 - y1)\n            \n            # Avoid division by zero if y1 is very close to y2 (not an issue here)\n            if abs(denominator)  1e-30:\n                # Fallback to a lower-order scheme if needed, but not for this problem.\n                # For this setup, y2 is always greater than y1.\n                grad_u = 0.0 \n            else:\n                grad_u = numerator / denominator\n\n            # Calculate wall shear stress (tau_w)\n            tau_w = mu * grad_u\n\n            # Calculate friction velocity (u_tau)\n            u_tau = np.sqrt(np.abs(tau_w) / rho)\n        \n        results.append([tau_w, u_tau])\n\n    # Format the final output string as per requirements\n    # [[tau_A,u_tau_A],[tau_B,u_tau_B],...,[tau_E,u_tau_E]]\n    # Numbers are rounded to six decimal places, with no spaces.\n    output_str = \"[\" + \",\".join([f\"[{res[0]:.6f},{res[1]:.6f}]\" for res in results]) + \"]\"\n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "为了得到能够计算剪切应力的速度场，必须在求解器中正确地施加边界条件。本练习深入探讨了在有限体积法中广泛应用的“虚拟单元法”，以精确施加无滑移边界条件。通过此练习，您将掌握如何将一个物理边界条件转化为具体的算法实现，这是开发或使用CFD软件的一项核心能力 。",
            "id": "3389957",
            "problem": "一个开发者正在计算流体动力学（CFD）中为牛顿粘性流体实现一维、平面、同位网格有限体积离散的壁面边界条件。考虑一个中心点为 $P$ 的内部控制体和一个中心点为 $G$ 的虚拟控制体，其中分隔 $P$ 和 $G$ 的平面与物理壁面在点 $f$ 处重合。坐标 $n$ 垂直于壁面，从 $P$ 指向 $G$。从壁面到中心点的距离分别为 $d_P$（对于 $P$）和 $d_G$（对于 $G$），二者均为严格正值。我们关心的标量是切向速度分量 $u$，壁面施加了狄利克雷无滑移条件，指定了壁面处的切向壁面速度为 $U_w$。动力粘度为 $\\mu$，质量密度为 $\\rho$。\n\n仅从以下基本原则出发：\n- 沿着连接相邻点中心的直线对标量进行线性插值。\n- 牛顿粘性定律，该定律指出对于牛顿流体，壁面剪切应力与切向速度分量的壁面法向梯度成正比。\n- 摩擦速度的定义，它是一个由壁面剪切应力和密度导出的尺度。\n\n推导虚拟单元切向速度值 $u_G$ 的表达式，使得在 $P$ 和 $G$ 之间应用线性插值能够在壁面处再现壁面值 $u_f = U_w$。然后，在壁面处使用一个一致的面法向速度梯度近似，计算壁面剪切应力 $\\tau_w$ 和摩擦速度 $u_\\tau$。\n\n您的程序必须：\n- 实现推导出的 $u_G$ 表达式，该表达式通过线性插值在壁面处强制施加狄利克雷壁面条件。\n- 使用在壁面处得到的一致离散的壁面法向速度梯度，通过牛顿粘性定律计算壁面剪切应力 $\\tau_w$。\n- 基于 $\\tau_w$ 和 $\\rho$ 计算摩擦速度 $u_\\tau$。\n\n单位和数值要求：\n- 距离 $d_P$ 和 $d_G$ 必须以 $\\mathrm{m}$ 为单位提供和使用。\n- 速度 $u_P$ 和 $U_w$ 必须以 $\\mathrm{m/s}$ 为单位提供和使用。\n- 动力粘度 $\\mu$ 必须以 $\\mathrm{Pa \\cdot s}$ 为单位提供和使用。\n- 密度 $\\rho$ 必须以 $\\mathrm{kg/m^3}$ 为单位提供和使用。\n- 壁面剪切应力 $\\tau_w$ 必须以 $\\mathrm{Pa}$ 为单位报告。\n- 摩擦速度 $u_\\tau$ 必须以 $\\mathrm{m/s}$ 为单位报告。\n- 将每个数值输出四舍五入到恰好 $6$ 位小数。\n\n测试套件：\n- 情况 $1$：$d_P = 0.01 \\ \\mathrm{m}$，$d_G = 0.01 \\ \\mathrm{m}$，$u_P = 0.5 \\ \\mathrm{m/s}$，$U_w = 0.0 \\ \\mathrm{m/s}$，$\\mu = 0.001 \\ \\mathrm{Pa \\cdot s}$，$\\rho = 1000.0 \\ \\mathrm{kg/m^3}$。\n- 情况 $2$：$d_P = 0.01 \\ \\mathrm{m}$，$d_G = 0.01 \\ \\mathrm{m}$，$u_P = 0.0 \\ \\mathrm{m/s}$，$U_w = 1.0 \\ \\mathrm{m/s}$，$\\mu = 0.001 \\ \\mathrm{Pa \\cdot s}$，$\\rho = 1000.0 \\ \\mathrm{kg/m^3}$。\n- 情况 $3$：$d_P = 0.005 \\ \\mathrm{m}$，$d_G = 0.015 \\ \\mathrm{m}$，$u_P = 0.2 \\ \\mathrm{m/s}$，$U_w = 0.8 \\ \\mathrm{m/s}$，$\\mu = 1.8 \\times 10^{-5} \\ \\mathrm{Pa \\cdot s}$，$\\rho = 1.225 \\ \\mathrm{kg/m^3}$。\n- 情况 $4$：$d_P = 0.02 \\ \\mathrm{m}$，$d_G = 0.03 \\ \\mathrm{m}$，$u_P = 0.75 \\ \\mathrm{m/s}$，$U_w = 0.75 \\ \\mathrm{m/s}$，$\\mu = 0.002 \\ \\mathrm{Pa \\cdot s}$，$\\rho = 900.0 \\ \\mathrm{kg/m^3}$。\n- 情况 $5$：$d_P = 1.0 \\times 10^{-6} \\ \\mathrm{m}$，$d_G = 1.0 \\times 10^{-6} \\ \\mathrm{m}$，$u_P = 0.1 \\ \\mathrm{m/s}$，$U_w = 0.0 \\ \\mathrm{m/s}$，$\\mu = 1.0 \\ \\mathrm{Pa \\cdot s}$，$\\rho = 1.0 \\ \\mathrm{kg/m^3}$。\n\n对于每种情况，使用推导的表达式和提供的参数计算并输出三元组 $[u_G, \\tau_w, u_\\tau]$。您的程序应生成单行输出，其中包含结果，格式为一个逗号分隔的列表，并用方括号括起来，其中每种情况都是按顺序排列的子列表。例如，输出格式必须是：\n\"[[u_G1,tau_w1,u_tau1],[u_G2,tau_w2,u_tau2],...]\"，每个数字都四舍五入到 $6$ 位小数。",
            "solution": "该问题要求在一维有限体积框架下，为狄利克雷无滑移壁面边界条件推导虚拟单元切向速度 $u_G$、壁面剪切应力 $\\tau_w$ 和摩擦速度 $u_\\tau$ 的表达式。推导过程必须遵循指定的基本原则。\n\n设壁面 $f$ 位于壁面法向坐标 $n=0$ 的位置。内部流体单元中心 $P$ 位于 $n_P = -d_P$，外部虚拟单元中心 $G$ 位于 $n_G = d_G$。这些点对应的切向速度分别为 $u_P$ 和 $u_G$。壁面处指定的切向速度为 $U_w$。\n\n**1. 虚拟单元速度 $u_G$ 的推导**\n\n第一个原则是在相邻单元中心 $P$ 和 $G$ 之间对标量速度场 $u$ 使用线性插值。在 $n_P = -d_P$ 和 $n_G = d_G$ 之间的位置 $n$ 处的速度 $u(n)$ 由 $u_P$ 和 $u_G$ 的加权平均值给出：\n$$u(n) = \\frac{(n_G - n)u_P + (n - n_P)u_G}{n_G - n_P}$$\n代入位置 $n_P = -d_P$ 和 $n_G = d_G$：\n$$u(n) = \\frac{(d_G - n)u_P + (n - (-d_P))u_G}{d_G - (-d_P)} = \\frac{(d_G - n)u_P + (n + d_P)u_G}{d_G + d_P}$$\n我们在壁面 $f$ 处施加狄利克雷边界条件，此处 $n=0$ 且速度被指定为 $u_f = U_w$。在插值公式中令 $n=0$ 可得到壁面处的速度：\n$$u_f = u(0) = \\frac{(d_G - 0)u_P + (0 + d_P)u_G}{d_G + d_P} = \\frac{d_G u_P + d_P u_G}{d_G + d_P}$$\n通过施加条件 $u_f = U_w$，我们可以求解所需的虚拟单元值 $u_G$：\n$$U_w = \\frac{d_G u_P + d_P u_G}{d_G + d_P}$$\n$$U_w (d_G + d_P) = d_G u_P + d_P u_G$$\n$$d_P u_G = U_w (d_G + d_P) - d_G u_P$$\n$$u_G = \\frac{U_w (d_G + d_P) - d_G u_P}{d_P}$$\n该表达式可改写为：\n$$u_G = U_w \\left(1 + \\frac{d_G}{d_P}\\right) - u_P \\frac{d_G}{d_P}$$\n此方程定义了虚拟单元中的值 $u_G$，使得 $P$ 和 $G$ 之间的线性插值能正确地在壁面处得到指定的速度 $U_w$。\n\n**2. 壁面剪切应力 $\\tau_w$ 的推导**\n\n第二个原则是牛顿粘性定律，它将剪切应力与速度梯度联系起来。对于切向分量，壁面剪切应力 $\\tau_w$ 由下式给出：\n$$\\tau_w = \\mu \\left. \\frac{\\partial u}{\\partial n} \\right|_{n=0}$$\n其中 $\\mu$ 是动力粘度，$\\left. \\frac{\\partial u}{\\partial n} \\right|_{n=0}$ 是在壁面处评估的垂直于壁面的速度梯度。\n\n问题陈述要求必须使用一个一致的面法向速度梯度近似。一致性要求梯度必须从上一步建立的同一直线速度剖面计算。线性函数 $u(n)$ 的梯度在 $P$ 和 $G$ 之间是恒定的：\n$$\\frac{du}{dn} = \\frac{d}{dn} \\left( \\frac{(d_G - n)u_P + (n + d_P)u_G}{d_G + d_P} \\right) = \\frac{-u_P + u_G}{d_G + d_P}$$\n这种中心差分近似（以 $P$ 和 $G$ 之间的中点为中心）是插值函数在各处的梯度，包括在壁面 $f$ 处。\n$$\\left. \\frac{\\partial u}{\\partial n} \\right|_{n=0} = \\frac{u_G - u_P}{d_G + d_P}$$\n将此梯度代入牛顿粘性定律，得到壁面剪切应力的表达式：\n$$\\tau_w = \\mu \\left( \\frac{u_G - u_P}{d_G + d_P} \\right)$$\n该表达式正确地使用虚拟单元值 $u_G$ 来计算应力，确保了与所施加的狄利克雷条件的一致性。\n\n**3. 摩擦速度 $u_\\tau$ 的推导**\n\n第三个原则是摩擦速度 $u_\\tau$ 的定义。它是一个由壁面剪切应力 $\\tau_w$ 和流体密度 $\\rho$ 导出的速度尺度。作为一个尺度，它是一个非负量，其定义涉及壁面剪切应力的绝对值：\n$$u_\\tau = \\sqrt{\\frac{|\\tau_w|}{\\rho}}$$\n代入推导出的 $\\tau_w$ 表达式：\n$$u_\\tau = \\sqrt{\\frac{\\left| \\mu \\left( \\frac{u_G - u_P}{d_G + d_P} \\right) \\right|}{\\rho}}$$\n\n**最终公式总结**\n\n每个测试用例的计算步骤如下：\n1.  使用给定参数计算虚拟单元速度 $u_G$：\n    $$u_G = U_w \\left(1 + \\frac{d_G}{d_P}\\right) - u_P \\frac{d_G}{d_P}$$\n2.  使用计算出的 $u_G$ 计算壁面剪切应力 $\\tau_w$：\n    $$\\tau_w = \\mu \\left( \\frac{u_G - u_P}{d_G + d_P} \\right)$$\n3.  根据计算出的 $\\tau_w$ 计算摩擦速度 $u_\\tau$：\n    $$u_\\tau = \\sqrt{\\frac{|\\tau_w|}{\\rho}}$$\n\n这些表达式将被实现以求解所提供测试套件中的值。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes ghost-cell velocity, wall shear stress, and friction velocity\n    for a series of test cases based on a 1D finite-volume wall boundary condition.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (d_P, d_G, u_P, U_w, mu, rho)\n    test_cases = [\n        (0.01, 0.01, 0.5, 0.0, 0.001, 1000.0),\n        (0.01, 0.01, 0.0, 1.0, 0.001, 1000.0),\n        (0.005, 0.015, 0.2, 0.8, 1.8e-5, 1.225),\n        (0.02, 0.03, 0.75, 0.75, 0.002, 900.0),\n        (1.0e-6, 1.0e-6, 0.1, 0.0, 1.0, 1.0),\n    ]\n\n    all_results = []\n    \n    for case in test_cases:\n        d_P, d_G, u_P, U_w, mu, rho = case\n\n        # 1. Derive the expression for the ghost-cell tangential velocity u_G\n        # u_G = U_w * (1 + d_G/d_P) - u_P * (d_G/d_P)\n        u_G = U_w * (1.0 + d_G / d_P) - u_P * (d_G / d_P)\n\n        # 2. Compute the wall shear stress tau_w\n        # tau_w = mu * (u_G - u_P) / (d_G + d_P)\n        # The velocity gradient is consistently determined from the linear profile\n        # between P and G.\n        grad_u_at_wall = (u_G - u_P) / (d_G + d_P)\n        tau_w = mu * grad_u_at_wall\n\n        # 3. Compute the friction velocity u_tau\n        # u_tau = sqrt(|tau_w| / rho)\n        if tau_w == 0.0:\n            u_tau = 0.0\n        else:\n            u_tau = np.sqrt(np.abs(tau_w) / rho)\n            \n        # Round each result to 6 decimal places.\n        # np.round is used as specified in execution environment.\n        # Python's format specifier with f-strings for '0-padding' and rounding.\n        # We process results into a list of correctly rounded numbers.\n        case_results = [\n            round(u_G, 6),\n            round(tau_w, 6),\n            round(u_tau, 6),\n        ]\n        all_results.append(case_results)\n\n    # Format the final output string as specified: \"[[r11,r12,r13],[r21,r22,r23],...]\"\n    # Using a list comprehension to build the string representation of each inner list.\n    inner_lists_str = [f\"[{','.join(map(str, res))}]\" for res in all_results]\n    # Joining the inner list strings with commas and enclosing in the outer brackets.\n    final_output = f\"[{','.join(inner_lists_str)}]\"\n    \n    print(final_output)\n\nsolve()\n```"
        }
    ]
}