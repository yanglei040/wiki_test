{
    "hands_on_practices": [
        {
            "introduction": "Mastering computational fluid dynamics begins with the correct implementation of boundary conditions at the code level. This first practice focuses on the foundational technique of using ghost cells to handle supersonic flows, a cornerstone of many finite volume solvers. By directly implementing the logic for a supersonic inlet where all flow properties are fixed, and a supersonic outlet where properties are extrapolated from the interior, you will gain hands-on experience in how boundary data is prepared for numerical flux computations. ",
            "id": "3368205",
            "problem": "Consider a one-dimensional inviscid, compressible flow of an ideal gas governed by the Euler equations for conservation of mass, momentum, and energy. Let the state vector be $U = [\\rho, \\rho u, E]^T$, where $\\rho$ is the density in $\\mathrm{kg/m^3}$, $u$ is the velocity in $\\mathrm{m/s}$, and $E$ is the total energy per unit volume in $\\mathrm{J/m^3}$. The pressure $p$ is related to $E$ and $u$ by the ideal gas relation $p = (\\gamma - 1)\\left(E - \\tfrac{1}{2}\\rho u^2\\right)$, where $\\gamma$ is the ratio of specific heats (dimensionless). The flux vector is $F(U) = [\\rho u, \\rho u^2 + p, u(E + p)]^T$. The one-dimensional Euler equations in conservation form are $\\partial_t U + \\partial_x F(U) = 0$.\n\nYou are to implement the Finite Volume Method (FVM) using ghost-cell construction to handle supersonic inlet and outlet boundary conditions. The numerical flux at an interface between a left state $U_L$ and a right state $U_R$ must be the local Lax-Friedrichs (also known as Rusanov) flux:\n$$\nF_{LF}(U_L, U_R) = \\tfrac{1}{2}\\left(F(U_L) + F(U_R)\\right) - \\tfrac{1}{2}\\alpha\\left(U_R - U_L\\right),\n$$\nwhere $\\alpha = \\max\\left(|u_L| + a_L, |u_R| + a_R\\right)$ and $a = \\sqrt{\\gamma p / \\rho}$ is the speed of sound. The Mach number is $M = |u|/a$. In this problem, treat $M \\ge 1$ as supersonic. For a supersonic inlet (left boundary) with specified primitive state $(\\rho_{in}, u_{in}, p_{in})$, construct the left ghost cell primitive state equal to $(\\rho_{in}, u_{in}, p_{in})$. For a supersonic outlet (right boundary), construct the right ghost cell primitive state by copying the primitive state of the last interior cell. Convert primitive states to conservative variables using $E = p/(\\gamma - 1) + \\tfrac{1}{2}\\rho u^2$ prior to using them in flux computations.\n\nYou must compute, for each provided test case, the numerical mass flux across the left boundary interface (between the left ghost cell and the first interior cell) and across the right boundary interface (between the last interior cell and the right ghost cell). The mass flux is the first component of $F_{LF}$ and must be reported in $\\mathrm{kg/(m^2\\cdot s)}$.\n\nUse the following test suite, each specified by $(\\gamma; \\rho_{in}, u_{in}, p_{in}; \\rho_{int}, u_{int}, p_{int})$ in International System of Units (SI):\n\n- Test Case 1 (general supersonic inlet and outlet):\n  - $\\gamma = 1.4$\n  - Inlet primitive state: $\\rho_{in} = 1.0$ $\\mathrm{kg/m^3}$, $u_{in} = 600.0$ $\\mathrm{m/s}$, $p_{in} = 120000.0$ $\\mathrm{Pa}$\n  - Interior primitive state (uniform): $\\rho_{int} = 1.0$ $\\mathrm{kg/m^3}$, $u_{int} = 580.0$ $\\mathrm{m/s}$, $p_{int} = 110000.0$ $\\mathrm{Pa}$\n- Test Case 2 (sonic inlet treated as supersonic, supersonic interior):\n  - $\\gamma = 1.4$\n  - Inlet primitive state: $\\rho_{in} = 1.0$ $\\mathrm{kg/m^3}$, $u_{in} = \\sqrt{1.4 \\cdot 100000.0}$ $\\mathrm{m/s}$, $p_{in} = 100000.0$ $\\mathrm{Pa}$\n  - Interior primitive state (uniform): $\\rho_{int} = 1.0$ $\\mathrm{kg/m^3}$, $u_{int} = 400.0$ $\\mathrm{m/s}$, $p_{int} = 80000.0$ $\\mathrm{Pa}$\n- Test Case 3 (high-Mach supersonic inlet and outlet):\n  - $\\gamma = 1.4$\n  - Inlet primitive state: $\\rho_{in} = 0.9$ $\\mathrm{kg/m^3}$, $u_{in} = 1500.0$ $\\mathrm{m/s}$, $p_{in} = 50000.0$ $\\mathrm{Pa}$\n  - Interior primitive state (uniform): $\\rho_{int} = 0.95$ $\\mathrm{kg/m^3}$, $u_{int} = 1400.0$ $\\mathrm{m/s}$, $p_{int} = 60000.0$ $\\mathrm{Pa}$\n\nFor each test case, perform the following steps:\n1. Construct the left ghost cell primitive state from the inlet primitive state and the right ghost cell primitive state from the last interior primitive state according to the supersonic rules given above.\n2. Convert all involved primitive states to conservative variables.\n3. Compute $F_{LF}$ at the left boundary interface using the left ghost cell as $U_L$ and the first interior cell as $U_R$; record the mass flux value $f_{m,L}$.\n4. Compute $F_{LF}$ at the right boundary interface using the last interior cell as $U_L$ and the right ghost cell as $U_R$; record the mass flux value $f_{m,R}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order $\\left[f_{m,L}^{(1)}, f_{m,R}^{(1)}, f_{m,L}^{(2)}, f_{m,R}^{(2)}, f_{m,L}^{(3)}, f_{m,R}^{(3)}\\right]$, where the superscript indicates the test case index. Each entry must be a real number (float) expressed in $\\mathrm{kg/(m^2\\cdot s)}$ with the program’s default formatting. No other text should be printed.",
            "solution": "The problem statement is an entirely self-contained, well-posed computational problem in the field of computational fluid dynamics. It is scientifically grounded in the Euler equations for one-dimensional inviscid compressible flow and specifies a standard numerical method (Finite Volume Method with Rusanov flux) and boundary condition treatment (ghost cells for supersonic flow). All necessary parameters and definitions are provided, and the requested computations are clearly defined. No scientific, logical, or factual flaws were identified. The problem is therefore deemed valid.\n\nThe objective is to compute the numerical mass flux across the left (supersonic inlet) and right (supersonic outlet) boundaries of a computational domain for three distinct test cases. The mass flux is the first component of the vector-valued Local Lax-Friedrichs (Rusanov) numerical flux, $F_{LF}$.\n\nThe Rusanov flux at an interface between a left state $U_L$ and a right state $U_R$ is given by:\n$$\nF_{LF}(U_L, U_R) = \\tfrac{1}{2}\\left(F(U_L) + F(U_R)\\right) - \\tfrac{1}{2}\\alpha\\left(U_R - U_L\\right)\n$$\nwhere $F(U)$ is the physical flux vector, $U$ is the vector of conserved variables, and $\\alpha$ is the local dissipation coefficient. The state vector is $U = [\\rho, \\rho u, E]^T$, and the physical flux vector is $F(U) = [\\rho u, \\rho u^2 + p, u(E + p)]^T$. We are interested in the first component of $F_{LF}$, which represents the mass flux, $f_m$. Let $U_1 = \\rho$ and $F_1(U) = \\rho u$. The mass flux is:\n$$\nf_{m,LF} = \\frac{1}{2}\\left(F_1(U_L) + F_1(U_R)\\right) - \\frac{1}{2}\\alpha\\left(U_{R,1} - U_{L,1}\\right)\n$$\nSubstituting the definitions for the first components, this becomes:\n$$\nf_{m,LF} = \\frac{1}{2}\\left(\\rho_L u_L + \\rho_R u_R\\right) - \\frac{1}{2}\\alpha\\left(\\rho_R - \\rho_L\\right)\n$$\nThe dissipation coefficient $\\alpha$ is defined as the maximum characteristic speed at the interface:\n$$\n\\alpha = \\max\\left(|u_L| + a_L, |u_R| + a_R\\right)\n$$\nwhere $a = \\sqrt{\\gamma p / \\rho}$ is the speed of sound. The primitive variables $(\\rho, u, p)$ for the left ($L$) and right ($R$) states are determined by the ghost cell boundary conditions.\n\n**Boundary Conditions:**\n1.  **Supersonic Inlet (Left Boundary):** The interface is between the left ghost cell and the first interior cell.\n    -   State $L$ (ghost cell): The primitive variables are set to the specified inlet conditions, $(\\rho_L, u_L, p_L) = (\\rho_{in}, u_{in}, p_{in})$.\n    -   State $R$ (first interior cell): The primitive variables are taken from the specified interior state, $(\\rho_R, u_R, p_R) = (\\rho_{int}, u_{int}, p_{int})$.\n\n2.  **Supersonic Outlet (Right Boundary):** The interface is between the last interior cell and the right ghost cell.\n    -   State $L$ (last interior cell): The primitive variables are from the interior state, $(\\rho_L, u_L, p_L) = (\\rho_{int}, u_{int}, p_{int})$.\n    -   State $R$ (ghost cell): The primitive variables are copied from the last interior cell, so $(\\rho_R, u_R, p_R) = (\\rho_{int}, u_{int}, p_{int})$.\n    For this case, since $(\\rho_L, u_L, p_L) = (\\rho_R, u_R, p_R)$, the Rusanov mass flux simplifies significantly. The dissipation term vanishes as $\\rho_R - \\rho_L = 0$. The flux term becomes $\\frac{1}{2}(\\rho_L u_L + \\rho_L u_L) = \\rho_L u_L$. Thus, for the supersonic outlet, the numerical mass flux is simply the physical mass flux evaluated at the interior state: $f_m = \\rho_{int} u_{int}$.\n\nWe now apply this methodology to each test case.\n\n**Test Case 1**\n-   Given: $\\gamma = 1.4$.\n-   Inlet primitives: $\\rho_{in} = 1.0$ $\\mathrm{kg/m^3}$, $u_{in} = 600.0$ $\\mathrm{m/s}$, $p_{in} = 120000.0$ $\\mathrm{Pa}$.\n-   Interior primitives: $\\rho_{int} = 1.0$ $\\mathrm{kg/m^3}$, $u_{int} = 580.0$ $\\mathrm{m/s}$, $p_{int} = 110000.0$ $\\mathrm{Pa}$.\n\n**Left Boundary Mass Flux, $f_{m,L}^{(1)}$:**\n-   State $L$: $(\\rho_L, u_L, p_L) = (1.0, 600.0, 120000.0)$.\n-   State $R$: $(\\rho_R, u_R, p_R) = (1.0, 580.0, 110000.0)$.\n-   Speeds of sound:\n    -   $a_L = \\sqrt{1.4 \\cdot 120000.0 / 1.0} = \\sqrt{168000} \\approx 409.878$ $\\mathrm{m/s}$.\n    -   $a_R = \\sqrt{1.4 \\cdot 110000.0 / 1.0} = \\sqrt{154000} \\approx 392.428$ $\\mathrm{m/s}$.\n-   Dissipation coefficient:\n    -   $|u_L| + a_L = 600.0 + 409.878 = 1009.878$ $\\mathrm{m/s}$.\n    -   $|u_R| + a_R = 580.0 + 392.428 = 972.428$ $\\mathrm{m/s}$.\n    -   $\\alpha = \\max(1009.878, 972.428) = 1009.878$ $\\mathrm{m/s}$.\n-   Rusanov mass flux:\n    -   $f_{m,L}^{(1)} = \\frac{1}{2}(1.0 \\cdot 600.0 + 1.0 \\cdot 580.0) - \\frac{1}{2}(1009.878)(1.0 - 1.0) = \\frac{1}{2}(1180.0) - 0 = 590.0$ $\\mathrm{kg/(m^2\\cdot s)}$.\n\n**Right Boundary Mass Flux, $f_{m,R}^{(1)}$:**\n-   Using the simplification for supersonic outlets:\n    -   $f_{m,R}^{(1)} = \\rho_{int} u_{int} = 1.0 \\cdot 580.0 = 580.0$ $\\mathrm{kg/(m^2\\cdot s)}$.\n\n**Test Case 2**\n-   Given: $\\gamma = 1.4$.\n-   Inlet primitives: $\\rho_{in} = 1.0$ $\\mathrm{kg/m^3}$, $u_{in} = \\sqrt{1.4 \\cdot 100000.0} \\approx 374.166$ $\\mathrm{m/s}$, $p_{in} = 100000.0$ $\\mathrm{Pa}$.\n-   Interior primitives: $\\rho_{int} = 1.0$ $\\mathrm{kg/m^3}$, $u_{int} = 400.0$ $\\mathrm{m/s}$, $p_{int} = 80000.0$ $\\mathrm{Pa}$.\n\n**Left Boundary Mass Flux, $f_{m,L}^{(2)}$:**\n-   State $L$: $(\\rho_L, u_L, p_L) = (1.0, \\sqrt{140000}, 100000.0)$.\n-   State $R$: $(\\rho_R, u_R, p_R) = (1.0, 400.0, 80000.0)$.\n-   Speeds of sound:\n    -   $a_L = \\sqrt{1.4 \\cdot 100000.0 / 1.0} = \\sqrt{140000} \\approx 374.166$ $\\mathrm{m/s}$. Note $u_L = a_L$, so the inlet flow is sonic ($M=1$).\n    -   $a_R = \\sqrt{1.4 \\cdot 80000.0 / 1.0} = \\sqrt{112000} \\approx 334.664$ $\\mathrm{m/s}$.\n-   Dissipation coefficient:\n    -   $|u_L| + a_L = \\sqrt{140000} + \\sqrt{140000} = 2\\sqrt{140000} \\approx 748.331$ $\\mathrm{m/s}$.\n    -   $|u_R| + a_R = 400.0 + 334.664 = 734.664$ $\\mathrm{m/s}$.\n    -   $\\alpha = 2\\sqrt{140000} \\approx 748.331$ $\\mathrm{m/s}$.\n-   Rusanov mass flux:\n    -   $f_{m,L}^{(2)} = \\frac{1}{2}(1.0 \\cdot \\sqrt{140000} + 1.0 \\cdot 400.0) - \\frac{1}{2}(\\alpha)(1.0 - 1.0) = \\frac{1}{2}(\\sqrt{140000} + 400.0) \\approx 387.083$ $\\mathrm{kg/(m^2\\cdot s)}$.\n\n**Right Boundary Mass Flux, $f_{m,R}^{(2)}$:**\n-   $f_{m,R}^{(2)} = \\rho_{int} u_{int} = 1.0 \\cdot 400.0 = 400.0$ $\\mathrm{kg/(m^2\\cdot s)}$.\n\n**Test Case 3**\n-   Given: $\\gamma = 1.4$.\n-   Inlet primitives: $\\rho_{in} = 0.9$ $\\mathrm{kg/m^3}$, $u_{in} = 1500.0$ $\\mathrm{m/s}$, $p_{in} = 50000.0$ $\\mathrm{Pa}$.\n-   Interior primitives: $\\rho_{int} = 0.95$ $\\mathrm{kg/m^3}$, $u_{int} = 1400.0$ $\\mathrm{m/s}$, $p_{int} = 60000.0$ $\\mathrm{Pa}$.\n\n**Left Boundary Mass Flux, $f_{m,L}^{(3)}$:**\n-   State $L$: $(\\rho_L, u_L, p_L) = (0.9, 1500.0, 50000.0)$.\n-   State $R$: $(\\rho_R, u_R, p_R) = (0.95, 1400.0, 60000.0)$.\n-   Speeds of sound:\n    -   $a_L = \\sqrt{1.4 \\cdot 50000.0 / 0.9} \\approx 278.887$ $\\mathrm{m/s}$.\n    -   $a_R = \\sqrt{1.4 \\cdot 60000.0 / 0.95} \\approx 297.357$ $\\mathrm{m/s}$.\n-   Dissipation coefficient:\n    -   $|u_L| + a_L = 1500.0 + 278.887 = 1778.887$ $\\mathrm{m/s}$.\n    -   $|u_R| + a_R = 1400.0 + 297.357 = 1697.357$ $\\mathrm{m/s}$.\n    -   $\\alpha = 1778.887$ $\\mathrm{m/s}$.\n-   Rusanov mass flux:\n    -   $f_{m,L}^{(3)} = \\frac{1}{2}(0.9 \\cdot 1500.0 + 0.95 \\cdot 1400.0) - \\frac{1}{2}(1778.887)(0.95 - 0.9)$.\n    -   $f_{m,L}^{(3)} = \\frac{1}{2}(1350.0 + 1330.0) - \\frac{1}{2}(1778.887)(0.05) = 1340.0 - 44.472 = 1295.528$ $\\mathrm{kg/(m^2\\cdot s)}$.\n\n**Right Boundary Mass Flux, $f_{m,R}^{(3)}$:**\n-   $f_{m,R}^{(3)} = \\rho_{int} u_{int} = 0.95 \\cdot 1400.0 = 1330.0$ $\\mathrm{kg/(m^2\\cdot s)}$.\n\nSummary of Results:\n-   Case 1: $(f_{m,L}^{(1)}, f_{m,R}^{(1)}) = (590.0, 580.0)$\n-   Case 2: $(f_{m,L}^{(2)}, f_{m,R}^{(2)}) = (387.083, 400.0)$\n-   Case 3: $(f_{m,L}^{(3)}, f_{m,R}^{(3)}) = (1295.528, 1330.0)$\n\nThe final implementation will compute these values programmatically.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes numerical mass fluxes for supersonic inlet/outlet boundary conditions\n    using the Local Lax-Friedrichs (Rusanov) scheme.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is (gamma, (rho_in, u_in, p_in), (rho_int, u_int, p_int))\n    test_cases = [\n        (1.4, (1.0, 600.0, 120000.0), (1.0, 580.0, 110000.0)),\n        (1.4, (1.0, np.sqrt(1.4 * 100000.0), 100000.0), (1.0, 400.0, 80000.0)),\n        (1.4, (0.9, 1500.0, 50000.0), (0.95, 1400.0, 60000.0)),\n    ]\n\n    results = []\n    \n    def calculate_rusanov_mass_flux(prim_L, prim_R, gamma):\n        \"\"\"\n        Calculates the mass flux component of the Rusanov numerical flux.\n        prim_L and prim_R are tuples of (rho, u, p).\n        \"\"\"\n        rho_L, u_L, p_L = prim_L\n        rho_R, u_R, p_R = prim_R\n\n        # Speed of sound\n        a_L = np.sqrt(gamma * p_L / rho_L)\n        a_R = np.sqrt(gamma * p_R / rho_R)\n\n        # Dissipation coefficient alpha\n        alpha = max(abs(u_L) + a_L, abs(u_R) + a_R)\n        \n        # Physical mass fluxes\n        mass_flux_L = rho_L * u_L\n        mass_flux_R = rho_R * u_R\n        \n        # Rusanov mass flux\n        f_m = 0.5 * (mass_flux_L + mass_flux_R) - 0.5 * alpha * (rho_R - rho_L)\n        \n        return f_m\n\n    for case in test_cases:\n        gamma, inlet_prims, interior_prims = case\n        \n        # --- Left Boundary Mass Flux (Supersonic Inlet) ---\n        # The left state is the ghost cell, which holds the inlet conditions.\n        # The right state is the first interior cell.\n        prim_L = inlet_prims\n        prim_R = interior_prims\n        \n        f_m_L = calculate_rusanov_mass_flux(prim_L, prim_R, gamma)\n        results.append(f_m_L)\n        \n        # --- Right Boundary Mass Flux (Supersonic Outlet) ---\n        # The right ghost cell state is a copy of the last interior cell state.\n        # The numerical flux simplifies to the physical flux at the interior state.\n        rho_int, u_int, p_int = interior_prims\n        f_m_R = rho_int * u_int\n        results.append(f_m_R)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "While simple extrapolation is sufficient for purely supersonic outlets, real-world simulations often encounter complexities like transient shocks that create local subsonic regions. This practice challenges you to move beyond basic implementation and design a physically-grounded, non-reflecting outlet boundary condition based on the method of characteristics. You will derive and implement a strategy that correctly identifies the number of incoming characteristics, which for an outlet is a function of the local Mach number $M$, and imposes only the necessary physical constraints, allowing waves to pass cleanly through the boundary without generating spurious reflections. ",
            "id": "3368220",
            "problem": "Consider the quasi-one-dimensional inviscid compressible flow governed by the one-dimensional Euler equations for an ideal gas in primitive variables $W = [\\rho, u, p]^T$, where $\\rho$ is density in $\\mathrm{kg/m^3}$, $u$ is velocity in $\\mathrm{m/s}$, and $p$ is static pressure in $\\mathrm{Pa}$. Assume the ratio of specific heats $\\gamma$ is constant. The governing equations in quasi-linear form are\n$$\n\\frac{\\partial W}{\\partial t} + A(W)\\,\\frac{\\partial W}{\\partial x} = 0,\n$$\nwhere $A(W)$ is the Jacobian matrix of the flux with respect to $W$. You are asked to design and implement a right boundary (outlet) strategy for a computational domain truncated downstream of the throat inside the supersonic regime of a converging-diverging nozzle, such that shocks can pass through the outlet without generating spurious reflections. Your design must be justified using characteristic compatibility of the one-dimensional Euler equations.\n\nStarting from first principles appropriate for Computational Fluid Dynamics (CFD), namely the hyperbolic character of the one-dimensional Euler equations for an ideal gas, the existence of characteristic fields and compatibility relations along them, and the ideal-gas speed of sound $a$ defined by $a^2 = \\gamma p/\\rho$, derive a characteristic-based outlet strategy that satisfies the following design goals:\n- For a right boundary (outlet) with flow directed toward increasing $x$, when the local flow at the outlet is supersonic, no boundary data should be imposed on the computational domain (all characteristics leave the domain).\n- When the local flow at the outlet is subsonic, only the minimum number of boundary conditions equal to the number of incoming characteristics should be imposed. Design this imposition so that outgoing characteristics are left unchanged and the only incoming acoustic characteristic is adjusted to be compatible with a specified far-field static pressure $p_\\infty$ in $\\mathrm{Pa}$.\n- Your design must follow from characteristic compatibility relations of the one-dimensional Euler equations; it must not rely on ad hoc extrapolations that do not preserve compatibility.\n\nOnce you have derived the boundary strategy, implement it as a program that, given the interior (last computed) primitive state adjacent to the outlet $W_i = [\\rho_i, u_i, p_i]^T$, the ratio of specific heats $\\gamma$, and a far-field static pressure $p_\\infty$ in $\\mathrm{Pa}$ (used only when needed), computes the outlet ghost-cell primitive state $W_b = [\\rho_b, u_b, p_b]^T$ to be used for numerical flux evaluations at the boundary.\n\nYour implementation must satisfy:\n- Use the local acoustic speed $a_i$ defined by $a_i^2 = \\gamma p_i/\\rho_i$ to determine the characteristic speeds at the outlet and, consequently, the number of incoming characteristics at the right boundary.\n- If the most negative characteristic speed at the right boundary is strictly positive (equivalently, if $u_i - a_i > 0$), treat the outlet as fully supersonic and set $W_b = W_i$.\n- If there is exactly one incoming characteristic (equivalently, if $u_i - a_i \\le 0$ and $u_i + a_i > 0$), impose only one scalar condition compatible with an ideal non-reflecting outlet by adjusting the incoming acoustic characteristic so that the boundary static pressure equals the specified far-field static pressure $p_\\infty$, while preserving the outgoing characteristic content of the interior state. The resulting $W_b$ must be consistent with the linearized characteristic structure of the one-dimensional Euler equations about $W_i$.\n- Ensure $\\rho_b > 0$ and $p_b > 0$ for the provided test inputs without introducing artificial limiters.\n\nPhysical units:\n- All inputs and outputs must be in SI units: $\\rho$ in $\\mathrm{kg/m^3}$, $u$ in $\\mathrm{m/s}$, $p$ in $\\mathrm{Pa}$, and $\\gamma$ dimensionless.\n\nAngle units are not involved. No percentages are involved.\n\nTest Suite:\nFor each parameter tuple $(\\gamma, \\rho_i, u_i, p_i, p_\\infty)$ below, compute and return $W_b = [\\rho_b, u_b, p_b]$:\n1. $(\\gamma, \\rho_i, u_i, p_i, p_\\infty) = (1.4, 1.0, 800.0, 100000.0, 95000.0)$\n2. $(\\gamma, \\rho_i, u_i, p_i, p_\\infty) = (1.4, 1.2, 150.0, 101325.0, 100000.0)$\n3. $(\\gamma, \\rho_i, u_i, p_i, p_\\infty) = (1.4, 1.0, 530.0, 200000.0, 180000.0)$\n4. $(\\gamma, \\rho_i, u_i, p_i, p_\\infty) = (1.67, 0.4, 200.0, 80000.0, 90000.0)$\n5. $(\\gamma, \\rho_i, u_i, p_i, p_\\infty) = (1.4, 0.8, 250.0, 90000.0, 90000.0)$\n\nRequired final output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is itself a list $[\\rho_b, u_b, p_b]$. Each floating-point value must be rounded to six decimal places. For example: $[[\\rho_{b,1}, u_{b,1}, p_{b,1}], [\\rho_{b,2}, u_{b,2}, p_{b,2}], \\dots]$.",
            "solution": "We begin with the one-dimensional Euler equations for an ideal gas in primitive variables $W = [\\rho, u, p]^T$:\n$$\n\\frac{\\partial \\rho}{\\partial t} + u \\frac{\\partial \\rho}{\\partial x} + \\rho \\frac{\\partial u}{\\partial x} = 0, \\quad\n\\frac{\\partial u}{\\partial t} + u \\frac{\\partial u}{\\partial x} + \\frac{1}{\\rho} \\frac{\\partial p}{\\partial x} = 0, \\quad\n\\frac{\\partial p}{\\partial t} + u \\frac{\\partial p}{\\partial x} + \\gamma p \\frac{\\partial u}{\\partial x} = 0,\n$$\nwith the ideal-gas speed of sound defined by $a^2 = \\gamma p/\\rho$. In quasi-linear form,\n$$\n\\frac{\\partial W}{\\partial t} + A(W)\\,\\frac{\\partial W}{\\partial x} = 0,\n$$\nwhere\n$$\nA(W) =\n\\begin{bmatrix}\nu & \\rho & 0 \\\\\n0 & u & \\tfrac{1}{\\rho} \\\\\n0 & \\gamma p & u\n\\end{bmatrix}.\n$$\nThe system is strictly hyperbolic for $p>0$, $\\rho>0$, with three real eigenvalues\n$$\n\\lambda_1 = u - a, \\quad \\lambda_2 = u, \\quad \\lambda_3 = u + a.\n$$\nLet the corresponding right eigenvectors in primitive variables be columns of $R(W)$. Solving $(A - \\lambda I) r = 0$ yields the standard basis of right eigenvectors (up to scaling):\n$$\nr_1 = \\begin{bmatrix} 1 \\\\ -\\frac{a}{\\rho} \\\\ a^2 \\end{bmatrix}, \\quad\nr_2 = \\begin{bmatrix} 1 \\\\ 0 \\\\ 0 \\end{bmatrix}, \\quad\nr_3 = \\begin{bmatrix} 1 \\\\ \\frac{a}{\\rho} \\\\ a^2 \\end{bmatrix}.\n$$\nLet $L(W) = R(W)^{-1}$ denote the corresponding left eigenvector matrix, so that $L A L^{-1}$ is diagonal with entries $\\lambda_k$. Projecting the Partial Differential Equation (PDE) onto the characteristic directions, one obtains the characteristic compatibility equations for the wave amplitudes $\\alpha_k$ associated with each eigenvector, which in linearized form about a reference state $\\bar W$ satisfy\n$$\n\\frac{\\partial \\alpha_k}{\\partial t} + \\lambda_k(\\bar W)\\, \\frac{\\partial \\alpha_k}{\\partial x} \\approx 0, \\quad k \\in \\{1,2,3\\}.\n$$\nAt a right boundary located at $x = x_R$, with outward normal pointing toward increasing $x$, the number of boundary conditions to be prescribed equals the number of characteristics entering the computational domain. A characteristic enters the domain if its speed relative to the boundary is negative. For the right boundary, these are the characteristics with $\\lambda_k < 0$.\n\nTwo canonical regimes arise:\n1. Supersonic outflow: If $u - a > 0$ at the outlet, then $\\lambda_1 > 0$, $\\lambda_2 > 0$, and $\\lambda_3 > 0$. All characteristics leave the domain, so no boundary data should be imposed on the solution inside the domain. The non-reflecting choice consistent with compatibility is to set the ghost state equal to the interior state, $W_b = W_i$, thereby allowing all outgoing waves, including shocks, to convect out without constraint. This is consistent with the physics: in supersonic outflow, downstream cannot influence upstream.\n2. Subsonic outflow: If $u - a \\le 0 < u + a$, then exactly one characteristic, the $\\lambda_1$ (left-running acoustic) wave, enters the computational domain. The other two characteristics, $\\lambda_2$ (entropy) and $\\lambda_3$ (right-running acoustic), leave the domain. A non-reflecting outlet should preserve the amplitudes of the outgoing waves while prescribing only the incoming one. A common and effective choice is to impose a single scalar condition on the static pressure at the boundary, $p_b = p_\\infty$, where $p_\\infty$ is a specified far-field static pressure, and to ensure that only the incoming acoustic wave amplitude is altered to achieve this, with the outgoing waves unchanged. This strategy is the essence of the Characteristic-Based Boundary Condition (CBC) for non-reflecting outflow (as in the approaches by Thompson and by Poinsot–Lele), justified by the linearized compatibility relations.\n\nTo make this precise, consider a linearized update about the interior state $W_i = [\\rho_i, u_i, p_i]^T$ with local acoustic speed $a_i^2 = \\gamma p_i/\\rho_i$. Because we aim to leave outgoing waves unchanged, we set the increments in the entropy and right-running acoustic modes to zero. Let the boundary state be\n$$\nW_b = W_i + \\alpha_1 r_1,\n$$\nwhere $r_1$ is evaluated at $W_i$ and $\\alpha_1$ is the amplitude of the incoming acoustic mode to be determined. Extracting the pressure component,\n$$\np_b = p_i + \\alpha_1 \\left(r_1\\right)_p = p_i + \\alpha_1 a_i^2.\n$$\nImposing $p_b = p_\\infty$ gives\n$$\n\\alpha_1 = \\frac{p_\\infty - p_i}{a_i^2}.\n$$\nTherefore,\n$$\n\\rho_b = \\rho_i + \\alpha_1, \\quad\nu_b = u_i - \\frac{a_i}{\\rho_i}\\,\\alpha_1, \\quad\np_b = p_\\infty.\n$$\nThis construction directly follows from characteristic compatibility: only the incoming acoustic characteristic is adjusted to satisfy the single prescribed scalar condition, and the outgoing characteristics are unaltered, minimizing reflections. Because shocks in quasi-one-dimensional flow are carried by acoustic modes, allowing the outgoing acoustic mode content to pass unmodified through the boundary permits shocks to exit with minimal spurious reflection. In the supersonic case, no characteristic enters, and thus the boundary should not impose any additional condition, which is implemented by $W_b = W_i$.\n\nAlgorithm summary for the right boundary ghost state:\n- Given $\\gamma$, $\\rho_i$, $u_i$, $p_i$, compute $a_i = \\sqrt{\\gamma p_i/\\rho_i}$.\n- If $u_i - a_i > 0$, then $W_b = W_i$.\n- Else, compute $\\alpha_1 = (p_\\infty - p_i)/a_i^2$, and set\n$$\n\\rho_b = \\rho_i + \\alpha_1, \\quad\nu_b = u_i - \\frac{a_i}{\\rho_i}\\,\\alpha_1, \\quad\np_b = p_\\infty.\n$$\n\nWe now apply this to the provided test suite. All values are in SI units. We will compute $W_b = [\\rho_b, u_b, p_b]$ for each case and round to six decimal places.\n\nCase 1: $(\\gamma, \\rho_i, u_i, p_i, p_\\infty) = (1.4, 1.0, 800.0, 100000.0, 95000.0)$.\n- $a_i = \\sqrt{1.4 \\cdot 100000.0 / 1.0} = \\sqrt{140000.0} \\approx 374.1657$.\n- $u_i - a_i \\approx 800.0 - 374.1657 > 0$, supersonic outflow.\n- $W_b = W_i = [1.0, 800.0, 100000.0]$.\n\nCase 2: $(\\gamma, \\rho_i, u_i, p_i, p_\\infty) = (1.4, 1.2, 150.0, 101325.0, 100000.0)$.\n- $a_i^2 = \\gamma p_i/\\rho_i = 1.4 \\cdot 101325.0 / 1.2 = 118212.5$, $a_i \\approx 343.8174$.\n- $u_i - a_i \\approx 150.0 - 343.8174  0$, subsonic outflow.\n- $\\alpha_1 = (100000.0 - 101325.0)/118212.5 \\approx -0.011209$.\n- $\\rho_b = 1.2 + (-0.011209) \\approx 1.188791$.\n- $u_b = 150.0 - (a_i/\\rho_i)\\alpha_1 \\approx 150.0 - (343.8174/1.2)(-0.011209) \\approx 153.211$.\n- $p_b = 100000.0$.\n\nCase 3: $(\\gamma, \\rho_i, u_i, p_i, p_\\infty) = (1.4, 1.0, 530.0, 200000.0, 180000.0)$.\n- $a_i = \\sqrt{1.4 \\cdot 200000.0 / 1.0} = \\sqrt{280000.0} \\approx 529.1503$.\n- $u_i - a_i \\approx 530.0 - 529.1503 > 0$, supersonic outflow.\n- $W_b = W_i = [1.0, 530.0, 200000.0]$.\n\nCase 4: $(\\gamma, \\rho_i, u_i, p_i, p_\\infty) = (1.67, 0.4, 200.0, 80000.0, 90000.0)$.\n- $a_i^2 = 1.67 \\cdot 80000.0 / 0.4 = 334000.0$, $a_i \\approx 577.9273$.\n- $u_i - a_i \\approx 200.0 - 577.9273  0$, subsonic outflow.\n- $\\alpha_1 = (90000.0 - 80000.0)/334000.0 \\approx 0.029940$.\n- $\\rho_b = 0.4 + 0.029940 \\approx 0.429940$.\n- $u_b = 200.0 - (a_i/\\rho_i)\\alpha_1 \\approx 200.0 - (577.9273/0.4)\\cdot 0.029940 \\approx 200.0 - 43.263 \\approx 156.737$.\n- $p_b = 90000.0$.\nNote that $u_b$ can decrease substantially due to the strong imposed back pressure; the formulation remains physically consistent in the linearized sense, and $\\rho_b0$, $p_b0$.\n\nCase 5: $(\\gamma, \\rho_i, u_i, p_i, p_\\infty) = (1.4, 0.8, 250.0, 90000.0, 90000.0)$.\n- $a_i^2 = 1.4 \\cdot 90000.0 / 0.8 = 157500.0$, $a_i \\approx 396.8627$.\n- $u_i - a_i \\approx 250.0 - 396.8627  0$, subsonic outflow.\n- $\\alpha_1 = (90000.0 - 90000.0)/157500.0 = 0$.\n- $W_b = W_i = [0.8, 250.0, 90000.0]$.\n\nThe program implements these computations, rounding each component of $W_b$ to six decimal places, and prints a single line with the list $[W_{b,1}, W_{b,2}, W_{b,3}, W_{b,4}, W_{b,5}]$. This outlet strategy is non-reflecting in the linearized characteristic sense: in supersonic outflow, no incoming waves exist and the boundary does not impose constraints; in subsonic outflow, only the incoming acoustic characteristic is adjusted to achieve the far-field static pressure $p_\\infty$, while outgoing characteristics, including those constituting a shock propagating out of the domain, are left unchanged, thereby permitting shocks to pass through the boundary without spurious reflections.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef outlet_ghost_state(gamma, rho_i, u_i, p_i, p_inf):\n    \"\"\"\n    Compute right-boundary ghost-cell primitive state (rho_b, u_b, p_b)\n    using a characteristic-based non-reflecting outlet:\n    - If u_i - a_i  0 (supersonic outflow), set ghost = interior.\n    - Else (one incoming acoustic characteristic), adjust only the incoming\n      acoustic amplitude to enforce p_b = p_inf and leave outgoing modes unchanged.\n    \"\"\"\n    # Speed of sound and characteristic speeds\n    a2 = gamma * p_i / rho_i\n    a = np.sqrt(a2)\n    lambda1 = u_i - a\n    # Supersonic outflow: all characteristics leave the domain\n    if lambda1  0.0:\n        rho_b = rho_i\n        u_b = u_i\n        p_b = p_i\n    else:\n        # One incoming acoustic characteristic: adjust only that mode\n        # r1 = [1, -a/rho, a^2] in primitive variables\n        alpha1 = (p_inf - p_i) / a2\n        rho_b = rho_i + alpha1\n        u_b = u_i - (a / rho_i) * alpha1\n        p_b = p_inf\n    return rho_b, u_b, p_b\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each test case: (gamma, rho_i, u_i, p_i, p_inf)\n    test_cases = [\n        (1.4, 1.0, 800.0, 100000.0, 95000.0),\n        (1.4, 1.2, 150.0, 101325.0, 100000.0),\n        (1.4, 1.0, 530.0, 200000.0, 180000.0),\n        (1.67, 0.4, 200.0, 80000.0, 90000.0),\n        (1.4, 0.8, 250.0, 90000.0, 90000.0),\n    ]\n\n    results = []\n    for gamma, rho_i, u_i, p_i, p_inf in test_cases:\n        rho_b, u_b, p_b = outlet_ghost_state(gamma, rho_i, u_i, p_i, p_inf)\n        # Round to six decimal places as required\n        results.append([round(rho_b, 6), round(u_b, 6), round(p_b, 6)])\n\n    # Final print statement in the exact required format.\n    print(str(results))\n\nsolve()\n```"
        },
        {
            "introduction": "The ultimate test of our numerical methods is their ability to predict complex, real-world phenomena. In this final practice, you will apply your understanding of supersonic boundary conditions to simulate a critical engineering problem: the 'unstart' phenomenon in a scramjet isolator. By coupling a supersonic inlet with a time-varying back pressure at the outlet, you will investigate how boundary conditions govern the dynamic behavior of shock waves and determine the operational limits of a high-speed propulsion system. ",
            "id": "3368199",
            "problem": "Consider a constant-area isolator duct representative of a scramjet inlet–isolator, modeled as a one-dimensional compressible flow governed by the inviscid Euler equations and an ideal gas equation of state. The task is to determine, by simulation and principled reasoning, which specified combinations of supersonic inlet and outlet boundary conditions suppress unstart when the outlet back pressure is ramped in time. The final answer must be a complete, runnable program.\n\nThe governing conservation laws for a calorically perfect gas are the one-dimensional Euler equations, expressed in conservative form for mass, momentum, and total energy. The ideal gas equation of state and definitions of primitive variables, sound speed, and Mach number apply. Supersonic inlet and outlet boundary conditions shall be enforced according to characteristic compatibility: at the supersonic inlet all characteristic information enters the domain, whereas at the outlet under subsonic conditions one characteristic enters and the static pressure can be prescribed. The computational method must be a consistent first-principles discretization that respects conservation, characteristic directions, and causality.\n\nYou must begin the derivation and algorithmic design from the following fundamental bases and well-tested facts:\n- The one-dimensional compressible Euler equations for a calorically perfect gas, with conservative state vector and fluxes defined in terms of density, velocity, pressure, and total energy, and the Ideal Gas Law with ratio of specific heats and gas constant.\n- The concept of characteristics in hyperbolic systems, including that at a supersonic inlet all characteristics point into the domain and all primitive variables may be prescribed; at a subsonic outlet one characteristic enters the domain and pressure may be prescribed consistently.\n- The normal shock relations in a constant-area duct for a calorically perfect gas, used to reason about the maximum downstream static pressure achievable for a given upstream supersonic Mach number without altering the upstream state.\n- The causality constraint that information cannot propagate upstream through a supersonic region via characteristics until a subsonic region is formed.\n\nThe program must implement a one-dimensional finite-volume Godunov-type solver with a robust approximate Riemann flux (for example, the Harten–Lax–van Leer–Einfeldt (HLLE) flux), a Courant–Friedrichs–Lewy (CFL) condition based time step, and physically consistent boundary conditions. The supersonic inlet boundary condition must prescribe the static state derived from given total conditions and inlet Mach number. The outlet boundary condition must prescribe a time-dependent static pressure ramp when the outlet is subsonic, and otherwise avoid imposing non-physical constraints. The computational domain is a constant-area duct of length $L$ discretized into $N$ uniform control volumes of size $\\Delta x$, and the integration runs to a specified final time $t_{\\text{final}}$.\n\nUnstart detection must be based on a physically meaningful criterion. Define unstart to have occurred if the Mach number in the cell adjacent to the inlet becomes strictly less than 1, and remains so for a sustained number of consecutive time steps during or after the outlet pressure ramp begins. Suppression of unstart is declared if unstart does not occur during the simulation time horizon. For numerical robustness, you must include floors for density and pressure to maintain positivity and use a moderate CFL number.\n\nAll physical quantities must be used and reported in International System of Units (SI units). Pressures must be in pascals (Pa), temperatures in kelvins (K), lengths in meters (m), and times in seconds (s). Angles are not used. All fractional quantities must be treated as decimals or rational numbers as needed, but the final outputs are booleans.\n\nYour program must evaluate the following test suite, which exercises different boundary-condition combinations and ramp specifications:\n\n- Test Case 1 (happy path): $\\gamma = 1.4$, $R = 287\\,\\mathrm{J/(kg\\cdot K)}$, $L = 1.0\\,\\mathrm{m}$, $N = 120$, $t_{\\text{final}} = 0.004\\,\\mathrm{s}$, $\\text{CFL} = 0.5$, inlet total temperature $T_0 = 1200\\,\\mathrm{K}$, inlet total pressure $p_0 = 200000\\,\\mathrm{Pa}$, inlet Mach $M_{\\text{in}} = 2.0$. Compute the initial static state $(p_1, T_1, u_1, \\rho_1)$ from $(T_0, p_0, M_{\\text{in}})$ using isentropic relations for a calorically perfect gas. Set the outlet base static pressure $p_{\\text{out,base}} = p_1$. Define the outlet peak static pressure $p_{\\text{out,peak}} = 0.93\\,p_2$, where $p_2$ is the downstream static pressure immediately after a normal shock for an upstream Mach number $M_{\\text{in}}$ located at the duct exit in a constant-area duct. The outlet pressure ramp is $p_{\\text{out}}(t) = p_{\\text{out,base}} + \\left(p_{\\text{out,peak}} - p_{\\text{out,base}}\\right)\\,\\min\\!\\left(1, \\frac{t}{t_{\\text{ramp}}}\\right)$ with $t_{\\text{ramp}} = 0.001\\,\\mathrm{s}$.\n\n- Test Case 2 (aggressive ramp): same gas and geometry as Test Case 1 with $t_{\\text{final}} = 0.006\\,\\mathrm{s}$ and $M_{\\text{in}} = 2.0$. Set $p_{\\text{out,base}} = p_1$ and $p_{\\text{out,peak}} = 1.20\\,p_2$. Use $t_{\\text{ramp}} = 0.002\\,\\mathrm{s}$.\n\n- Test Case 3 (boundary sensitivity, lower inlet Mach): same gas and geometry with $t_{\\text{final}} = 0.004\\,\\mathrm{s}$ and $M_{\\text{in}} = 1.5$. Compute $p_1$ from $(T_0, p_0, M_{\\text{in}})$ and set $p_{\\text{out,base}} = p_1$ and $p_{\\text{out,peak}} = 1.05\\,p_2$ (with $p_2$ computed from the normal shock relation at $M_{\\text{in}} = 1.5$). Use $t_{\\text{ramp}} = 0.001\\,\\mathrm{s}$.\n\n- Test Case 4 (supersonic outlet regime, small ramp): same gas and geometry with $t_{\\text{final}} = 0.004\\,\\mathrm{s}$ and $M_{\\text{in}} = 2.5$. Compute $p_1$ from $(T_0, p_0, M_{\\text{in}})$ and set $p_{\\text{out,base}} = p_1$ and $p_{\\text{out,peak}} = 0.50\\,p_2$ (with $p_2$ computed from the normal shock relation at $M_{\\text{in}} = 2.5$). Use $t_{\\text{ramp}} = 0.001\\,\\mathrm{s}$.\n\nFor each test case, your program must:\n- Initialize the duct with the uniform static state corresponding to the given inlet total conditions and $M_{\\text{in}}$.\n- Advance the solution in time to $t_{\\text{final}}$ using a first-order conservative finite-volume method with HLLE flux and a time step satisfying the CFL condition.\n- Enforce a supersonic inlet boundary by prescribing the static primitive variables derived from $(T_0, p_0, M_{\\text{in}})$ at the left ghost cell at each time step. Enforce the outlet pressure ramp by prescribing the static pressure at the right ghost cell, with velocity and density extrapolated from the last interior cell to maintain consistency, and computing the ghost cell total energy from the prescribed pressure and extrapolated velocity and density.\n- Detect unstart if the Mach number in the first interior cell adjacent to the inlet becomes below 1 for at least $5$ consecutive time steps at any time $t \\ge 0$ while the ramp progresses. Otherwise declare unstart suppressed.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3,result4]\"), where each result is a boolean indicating whether unstart was suppressed (True) or not (False) for the corresponding test case, in the order listed above. All internal computations must consistently use SI units and the Ideal Gas Law for a calorically perfect gas.",
            "solution": "The problem of determining unstart suppression in a scramjet isolator duct is a well-posed problem in computational gas dynamics. It is scientifically grounded in the one-dimensional Euler equations and the theory of hyperbolic partial differential equations. The provided parameters and conditions are complete, consistent, and physically realistic, allowing for a direct numerical simulation. We will proceed with a solution based on a first-principles finite-volume method.\n\n### 1. Governing Equations and State Variables\n\nThe flow is modeled by the one-dimensional Euler equations for an inviscid, compressible, calorically perfect gas. In conservative form, these are:\n$$\n\\frac{\\partial \\mathbf{U}}{\\partial t} + \\frac{\\partial \\mathbf{F}(\\mathbf{U})}{\\partial x} = 0\n$$\nwhere $t$ is time, $x$ is the spatial coordinate, $\\mathbf{U}$ is the vector of conserved quantities, and $\\mathbf{F}(\\mathbf{U})$ is the flux vector. They are defined as:\n$$\n\\mathbf{U} = \\begin{bmatrix} \\rho \\\\ \\rho u \\\\ E \\end{bmatrix}, \\quad\n\\mathbf{F}(\\mathbf{U}) = \\begin{bmatrix} \\rho u \\\\ \\rho u^2 + p \\\\ (E+p)u \\end{bmatrix}\n$$\nHere, $\\rho$ is the fluid density, $u$ is the velocity, $p$ is the static pressure, and $E$ is the total energy per unit volume.\n\nThe system is closed using the ideal gas law and the definition of total energy:\n$$\np = \\rho R T\n$$\n$$\nE = \\rho e + \\frac{1}{2}\\rho u^2 = \\frac{p}{\\gamma-1} + \\frac{1}{2}\\rho u^2\n$$\nwhere $T$ is temperature, $R$ is the specific gas constant, $\\gamma$ is the ratio of specific heats, and $e = c_v T$ is the specific internal energy. These relations allow for the conversion between the vector of conservative variables $\\mathbf{U} = [U_1, U_2, U_3]^T$ and the vector of primitive variables $\\mathbf{W} = [\\rho, u, p]^T$.\n\nConversion from conservative to primitive variables:\n$$\n\\rho = U_1, \\quad u = \\frac{U_2}{U_1}, \\quad p = (\\gamma-1)\\left(U_3 - \\frac{1}{2}\\frac{U_2^2}{U_1}\\right)\n$$\nThe speed of sound, $a$, and Mach number, $M$, are given by:\n$$\na = \\sqrt{\\frac{\\gamma p}{\\rho}}, \\quad M = \\frac{u}{a}\n$$\n\n### 2. Numerical Method: Finite-Volume Scheme\n\nWe employ a first-order finite-volume method. The duct of length $L$ is divided into $N$ uniform cells, each of width $\\Delta x = L/N$. The semi-discretized Euler equations for the cell-averaged state $\\mathbf{U}_i$ in cell $i$ are:\n$$\n\\frac{d\\mathbf{U}_i}{dt} = -\\frac{1}{\\Delta x}(\\mathbf{F}_{i+1/2} - \\mathbf{F}_{i-1/2})\n$$\nwhere $\\mathbf{F}_{i\\pm 1/2}$ represents the numerical flux at the cell interfaces. We use a first-order forward Euler method for time integration:\n$$\n\\mathbf{U}_i^{n+1} = \\mathbf{U}_i^n - \\frac{\\Delta t}{\\Delta x}(\\mathbf{F}_{i+1/2}^n - \\mathbf{F}_{i-1/2}^n)\n$$\nThe time step $\\Delta t$ is dynamically calculated to satisfy the Courant-Friedrichs-Lewy (CFL) condition for stability:\n$$\n\\Delta t = \\text{CFL} \\cdot \\min_{i} \\left( \\frac{\\Delta x}{|u_i| + a_i} \\right)\n$$\nwhere the minimum is taken over all cells in the domain, and $\\text{CFL}$ is a number less than $1$ (given as $0.5$).\n\n### 3. HLLE Approximate Riemann Solver\n\nThe numerical flux $\\mathbf{F}_{i+1/2}$ at the interface between cell $i$ (left state $\\mathbf{U}_L = \\mathbf{U}_i$) and cell $i+1$ (right state $\\mathbf{U}_R = \\mathbf{U}_{i+1}$) is computed using the Harten-Lax-van Leer-Einfeldt (HLLE) scheme. This scheme is robust and guarantees positivity of density and pressure. The HLLE flux is:\n$$\n\\mathbf{F}_{HLLE}(\\mathbf{U}_L, \\mathbf{U}_R) = \\frac{S_R \\mathbf{F}(\\mathbf{U}_L) - S_L \\mathbf{F}(\\mathbf{U}_R) + S_L S_R (\\mathbf{U}_R - \\mathbf{U}_L)}{S_R - S_L}\n$$\nThe wave speed estimates, $S_L$ and $S_R$, are crucial. We use the Davis estimates, which are based on the left and right states adjacent to the interface:\n$$\nS_L = \\min(u_L - a_L, u_R - a_R)\n$$\n$$\nS_R = \\max(u_L + a_L, u_R + a_R)\n$$\n\n### 4. Initial and Boundary Conditions\n\nThe simulation requires specifying the initial state of the flow and the boundary conditions at the inlet and outlet.\n\n**Initial Conditions**: The duct is initialized with a uniform supersonic flow corresponding to the inlet conditions. Given total temperature $T_0$, total pressure $p_0$, and inlet Mach number $M_{\\text{in}}$, the static properties (denoted with subscript $1$) are found using isentropic flow relations:\n$$\nT_1 = \\frac{T_0}{1 + \\frac{\\gamma-1}{2} M_{\\text{in}}^2}\n$$\n$$\np_1 = \\frac{p_0}{\\left(1 + \\frac{\\gamma-1}{2} M_{\\text{in}}^2\\right)^{\\gamma/(\\gamma-1)}}\n$$\nFrom these, we compute $\\rho_1 = p_1 / (R T_1)$ and $u_1 = M_{\\text{in}} \\sqrt{\\gamma R T_1}$. The initial conservative state vector $\\mathbf{U}_{init}$ is then computed from $(\\rho_1, u_1, p_1)$ and applied to all $N$ cells.\n\n**Boundary Conditions**: We use ghost cells at both ends of the domain (cell $-1$ at the inlet, cell $N$ at the outlet) to enforce boundary conditions.\n\n- **Inlet (Supersonic)**: Since the inlet flow is supersonic ($M_{\\text{in}}  1$), all three characteristics enter the domain. Thus, all flow properties can and must be specified. The state vector in the inlet ghost cell is fixed for all time:\n$$\n\\mathbf{U}_{-1}^n = \\mathbf{U}_{init} \\quad \\forall n\n$$\n\n- **Outlet**: The boundary condition at the outlet models the response to a downstream back pressure. As instructed, a pressure is prescribed at the outlet ghost cell. This represents the physical situation where the isolator exits into a plenum (the combustor) with a specified pressure. The ghost cell state $\\mathbf{U}_N^n$ is constructed as follows:\n    1. Prescribe the static pressure: $p_N^n = p_{\\text{out}}(t^n)$. The pressure ramp is given by:\n       $$\n       p_{\\text{out}}(t) = p_{\\text{out,base}} + (p_{\\text{out,peak}} - p_{\\text{out,base}}) \\min\\left(1, \\frac{t}{t_{\\text{ramp}}}\\right)\n       $$\n    2. Extrapolate density and velocity from the last interior cell ($i=N-1$):\n       $$\n       \\rho_N^n = \\rho_{N-1}^n, \\quad u_N^n = u_{N-1}^n\n       $$\n    3. Compute the ghost cell's total energy from its primitive variables:\n       $$\n       E_N^n = \\frac{p_N^n}{\\gamma-1} + \\frac{1}{2}\\rho_N^n (u_N^n)^2\n       $$\nThis procedure correctly introduces the back pressure information into the domain via the Riemann problem solved at the outlet interface $x_{N-1/2}$.\n\n### 5. Unstart Criterion and Logic\n\nUnstart is a critical failure mode where the shock system is expelled from the inlet. This is triggered by an excessive back pressure causing a shock to propagate fully upstream. The maximum back pressure a supersonic flow can withstand in a constant-area duct without upstream influence is the static pressure after a normal shock, $p_2$. This is given by the Rankine-Hugoniot relation:\n$$\n\\frac{p_2}{p_1} = 1 + \\frac{2\\gamma}{\\gamma+1} (M_{\\text{in}}^2 - 1)\n$$\nThe test cases are defined relative to this pressure $p_2$.\n\nNumerically, unstart is detected if the flow in the first interior cell ($i=0$) becomes subsonic ($M_0  1$) and remains so for $5$ consecutive time steps. A counter tracks these consecutive subsonic steps. If the counter reaches $5$, an unstart flag is set, and the simulation for that test case terminates. If the simulation completes to $t_{\\text{final}}$ without this condition being met, unstart is considered suppressed.\n\nThe expected outcomes are:\n- **Case 1 ($p_{\\text{out,peak}}  p_2$)**: Unstart should be suppressed.\n- **Case 2 ($p_{\\text{out,peak}}  p_2$)**: Unstart is expected.\n- **Case 3 ($p_{\\text{out,peak}}  p_2$)**: With a lower inlet Mach number ($M_{\\text{in}}=1.5$), the system is less resilient to pressure disturbances. Unstart is expected.\n- **Case 4 ($p_{\\text{out,peak}}  p_2$)**: Although the inlet Mach number is high ($M_{\\text{in}}=2.5$), the applied back pressure is well below the theoretical limit $p_2$. The shock generated at the outlet should stabilize within the duct. Unstart should be suppressed.\n\nThe final program implements this entire logic, iterating through each test case and reporting the outcome.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the scramjet unstart problem for the given test cases.\n    \"\"\"\n\n    class EulerSolver1D:\n        \"\"\"\n        A 1D Euler solver for simulating flow in a scramjet isolator.\n        \"\"\"\n        def __init__(self, gamma, R, L, N, CFL, T0, p0, M_in, \n                     t_final, p_out_base_factor, p_out_peak_factor, t_ramp):\n            # Physical and numerical parameters\n            self.gamma = gamma\n            self.R = R\n            self.L = L\n            self.N = N\n            self.CFL = CFL\n            self.t_final = t_final\n            self.t_ramp = t_ramp\n\n            # Grid setup\n            self.dx = self.L / self.N\n            self.x = np.linspace(-self.dx / 2, self.L + self.dx / 2, self.N + 2)\n\n            # Initial and boundary condition parameters\n            self.T0 = T0\n            self.p0 = p0\n            self.M_in = M_in\n\n            # Derived initial conditions\n            self.T1 = self.T0 / (1 + (self.gamma - 1) / 2 * self.M_in**2)\n            self.p1 = self.p0 / (1 + (self.gamma - 1) / 2 * self.M_in**2)**(self.gamma / (self.gamma - 1))\n            self.rho1 = self.p1 / (self.R * self.T1)\n            self.a1 = np.sqrt(self.gamma * self.R * self.T1)\n            self.u1 = self.M_in * self.a1\n            self.U_init = self._prim_to_cons(np.array([self.rho1, self.u1, self.p1]))\n            \n            # Outlet pressure ramp parameters\n            p2_ratio = 1 + (2 * self.gamma / (self.gamma + 1)) * (self.M_in**2 - 1)\n            self.p2 = self.p1 * p2_ratio\n            self.p_out_base = p_out_base_factor * self.p1 if p_out_base_factor is not None else self.p1\n            self.p_out_peak = p_out_peak_factor * self.p2\n\n            # State vector U = [rho, rho*u, E]\n            # N computational cells + 2 ghost cells\n            self.U = np.zeros((self.N + 2, 3))\n            self.U[1:-1, :] = self.U_init\n            \n            # Positivity floors\n            self.rho_floor = 1e-6\n            self.p_floor = 1e-6\n\n        def _prim_to_cons(self, W):\n            rho, u, p = W\n            rho_u = rho * u\n            E = p / (self.gamma - 1) + 0.5 * rho * u**2\n            return np.array([rho, rho_u, E])\n\n        def _cons_to_prim(self, U):\n            rho, rho_u, E = U.T\n            # Apply floors to conservative variables before conversion\n            rho = np.maximum(self.rho_floor, rho)\n            # Ensure E is consistent with floored pressure\n            u = rho_u / rho\n            p_check = (self.gamma - 1) * (E - 0.5 * rho * u**2)\n            E = np.where(p_check  self.p_floor, self.p_floor / (self.gamma - 1) + 0.5 * rho * u**2, E)\n            \n            # Proceed with conversion\n            u = rho_u / rho\n            p = (self.gamma - 1) * (E - 0.5 * rho * u**2)\n            \n            # Apply floors to primitive variables\n            rho = np.maximum(self.rho_floor, rho)\n            p = np.maximum(self.p_floor, p)\n\n            return np.vstack([rho, u, p]).T\n\n        def _compute_flux(self, U):\n            W = self._cons_to_prim(U)\n            rho, u, p = W.T\n            rho_u = rho * u\n            E = U[:, 2]\n            F = np.zeros_like(U)\n            F[:, 0] = rho_u\n            F[:, 1] = rho_u * u + p\n            F[:, 2] = (E + p) * u\n            return F\n\n        def _apply_bcs(self, t):\n            # Inlet (left ghost cell, index 0)\n            self.U[0, :] = self.U_init\n\n            # Outlet (right ghost cell, index N+1)\n            p_out = self.p_out_base + (self.p_out_peak - self.p_out_base) * min(1.0, t / self.t_ramp)\n            \n            W_last_interior = self._cons_to_prim(self.U[self.N:self.N+1, :])[0]\n            rho_ghost, u_ghost = W_last_interior[0], W_last_interior[1]\n            p_ghost = p_out\n            \n            self.U[-1, :] = self._prim_to_cons(np.array([rho_ghost, u_ghost, p_ghost]))\n        \n        def run(self):\n            t = 0.0\n            unstart_counter = 0\n            \n            while t  self.t_final:\n                # Apply boundary conditions\n                self._apply_bcs(t)\n\n                # Convert all conservative states to primitive\n                W = self._cons_to_prim(self.U)\n                rho, u, p = W.T\n                a = np.sqrt(self.gamma * p / rho)\n                \n                # Calculate time step from CFL condition\n                max_speed = np.max(np.abs(u) + a)\n                dt = self.CFL * self.dx / max_speed\n                if t + dt  self.t_final:\n                    dt = self.t_final - t\n                \n                # HLLE Flux Calculation\n                F = self._compute_flux(self.U)\n                \n                # Wave speeds for all interfaces\n                u_L, u_R = u[:-1], u[1:]\n                a_L, a_R = a[:-1], a[1:]\n                \n                S_L = np.minimum(u_L - a_L, u_R - a_R)\n                S_R = np.maximum(u_L + a_L, u_R + a_R)\n                \n                # HLLE flux formula\n                # Need to avoid division by zero if S_R == S_L\n                # Although unlikely for HLLE with Davis estimate\n                denom = S_R - S_L\n                denom[denom == 0] = 1e-9\n\n                F_L, F_R = F[:-1], F[1:]\n                U_L, U_R = self.U[:-1], self.U[1:]\n                \n                F_h = (S_R[:, np.newaxis] * F_L - S_L[:, np.newaxis] * F_R +\n                       S_L[:, np.newaxis] * S_R[:, np.newaxis] * (U_R - U_L)) / denom[:, np.newaxis]\n\n                # Update step (first-order Euler)\n                self.U[1:-1, :] -= (dt / self.dx) * (F_h[1:, :] - F_h[:-1, :])\n\n                # Unstart detection in first interior cell (index 1)\n                W_first_cell = self._cons_to_prim(self.U[1:2, :])[0]\n                rho_fc, u_fc, p_fc = W_first_cell\n                a_fc = np.sqrt(self.gamma * p_fc / rho_fc)\n                M_fc = u_fc / a_fc\n\n                if M_fc  1.0:\n                    unstart_counter += 1\n                else:\n                    unstart_counter = 0\n\n                if unstart_counter = 5:\n                    return False  # Unstart occurred\n\n                t += dt\n                if t = self.t_final:\n                    break\n\n            return True  # Unstart suppressed\n\n    test_cases = [\n        # Case 1: Happy path\n        {'gamma': 1.4, 'R': 287.0, 'L': 1.0, 'N': 120, 'CFL': 0.5,\n         'T0': 1200.0, 'p0': 200000.0, 'M_in': 2.0, 't_final': 0.004,\n         'p_out_base_factor': 1.0, 'p_out_peak_factor': 0.93, 't_ramp': 0.001},\n        # Case 2: Aggressive ramp\n        {'gamma': 1.4, 'R': 287.0, 'L': 1.0, 'N': 120, 'CFL': 0.5,\n         'T0': 1200.0, 'p0': 200000.0, 'M_in': 2.0, 't_final': 0.006,\n         'p_out_base_factor': 1.0, 'p_out_peak_factor': 1.20, 't_ramp': 0.002},\n        # Case 3: Lower inlet Mach\n        {'gamma': 1.4, 'R': 287.0, 'L': 1.0, 'N': 120, 'CFL': 0.5,\n         'T0': 1200.0, 'p0': 200000.0, 'M_in': 1.5, 't_final': 0.004,\n         'p_out_base_factor': 1.0, 'p_out_peak_factor': 1.05, 't_ramp': 0.001},\n        # Case 4: High inlet Mach, small relative ramp\n        {'gamma': 1.4, 'R': 287.0, 'L': 1.0, 'N': 120, 'CFL': 0.5,\n         'T0': 1200.0, 'p0': 200000.0, 'M_in': 2.5, 't_final': 0.004,\n         'p_out_base_factor': 1.0, 'p_out_peak_factor': 0.50, 't_ramp': 0.001},\n    ]\n\n    results = []\n    for case in test_cases:\n        solver = EulerSolver1D(**case)\n        unstart_suppressed = solver.run()\n        results.append(unstart_suppressed)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}