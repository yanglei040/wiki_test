## 引言
在计算流体动力学（CFD）领域，对飞机机翼、涡轮叶片或汽车外形等复杂几何体周围的流场进行精确模拟，是一项核心且持久的挑战。直接在这些不规则的物理域上求解流体控制方程（如[Navier-Stokes方程](@entry_id:161487)）往往异常困难，因为标准的数值离散格式通常是在简单、正交的网格上定义的。为了克服这一障碍，一种强大而系统的方法应运而生：[网格变换](@entry_id:750071)。其核心思想是将复杂的物理域映射到一个简单的、结构化的计算域（如一个单位立方体）上，从而将一个复杂的几何问题转化为一个在简单域上的标准数值问题。

然而，这种变换并非简单的几何游戏。它是一套深刻的数学工具，其选择和实施方式直接决定了最终数值解的准确性、稳定性和物理保真度。一个不恰当的变换可能会引入巨大的数值误差，甚至导致计算失败。因此，理解[网格变换](@entry_id:750071)的内在原理、掌握其应用技巧，并认识其局限性，是每一位CFD研究者和工程师的必备技能。

本文旨在系统地阐述复杂几何体[网格变换](@entry_id:750071)的理论与实践。我们将分三个章节逐步深入：
- 在**“原理与机制”**中，我们将奠定数学基础，详细探讨[坐标变换](@entry_id:172727)、[雅可比矩阵](@entry_id:264467)、度量张量以及有效网格必须满足的几何条件。
- 在**“应用与[交叉](@entry_id:147634)学科联系”**中，我们将展示这些原理如何应用于各种实际场景，从基础的[网格生成技术](@entry_id:751906)到前沿的[自适应网格](@entry_id:164379)、[形状优化](@entry_id:170695)和[湍流建模](@entry_id:151192)。
- 最后，在**“动手实践”**部分，您将通过一系列精心设计的问题，亲手应用所学知识，加深对[网格变换](@entry_id:750071)如何影响数值离散和求解器鲁棒性的理解。

通过本次学习，您将不仅掌握生成和评估高质量网格的工具，更能深刻理解网格、物理模型和[数值算法](@entry_id:752770)之间密不可分的内在联系。

## 原理与机制

在计算流体动力学（CFD）中，为了[精确模拟](@entry_id:749142)复杂几何形状（如飞机机翼或涡轮叶片）周围的流动，我们必须在这些不规则的物理域中[求解偏微分方程](@entry_id:138485)。一种强大而系统的方法是将复杂的物理域变换为一个简单的、结构化的计算域，例如一个单位立方体。在这种计算域中，网格是均匀且正交的，这极大地简化了数值离散和算法实现。本章将深入探讨将物理域映射到计算域的数学原理，并阐明这些变换对[数值模拟](@entry_id:137087)的准确性、稳定性和效率产生的深远影响。我们将从[坐标变换](@entry_id:172727)的基本概念入手，逐步建立一个用于分析和设计网格的几何工具集，并最终探讨这些几何属性如何直接影响控制方程的离散化过程。

### [坐标变换](@entry_id:172727)的基本概念

我们考虑一个从计算空间到物理空间的映射 $\mathbf{x}(\boldsymbol{\xi})$。计算空间通常是一个简单的域，如单位立方体 $\Omega_{\boldsymbol{\xi}} = [0,1]^3$，其坐标为 $\boldsymbol{\xi} = (\xi, \eta, \zeta)$ 或 $(\xi^1, \xi^2, \xi^3)$。物理空间是我们的实际问题所在域 $\Omega_{\mathbf{x}}$，其[笛卡尔坐标](@entry_id:167698)为 $\mathbf{x} = (x, y, z)$ 或 $(x_1, x_2, x_3)$。这个映射 $\mathbf{x}(\boldsymbol{\xi})$ 定义了物理空间中的一个[曲线坐标系](@entry_id:172561)。

这个[变换的核](@entry_id:149509)心是**雅可比矩阵**（Jacobian matrix），其定义为物理坐标相对于计算坐标的偏导数矩阵：
$$
\mathbf{J} = \frac{\partial \mathbf{x}}{\partial \boldsymbol{\xi}} = 
\begin{pmatrix}
\frac{\partial x}{\partial \xi} & \frac{\partial x}{\partial \eta} & \frac{\partial x}{\partial \zeta} \\
\frac{\partial y}{\partial \xi} & \frac{\partial y}{\partial \eta} & \frac{\partial y}{\partial \zeta} \\
\frac{\partial z}{\partial \xi} & \frac{\partial z}{\partial \eta} & \frac{\partial z}{\partial \zeta}
\end{pmatrix}
$$
雅可比矩阵在几何上描述了映射的[局部线性](@entry_id:266981)行为。它将计算空间中的一个[无穷小位移](@entry_id:202209)向量 $\mathrm{d}\boldsymbol{\xi}$ 变换为物理空间中的对应位移向量 $\mathrm{d}\mathbf{x}$：
$$
\mathrm{d}\mathbf{x} = \mathbf{J} \mathrm{d}\boldsymbol{\xi}
$$
雅可比矩阵的[行列式](@entry_id:142978)，即**[雅可比行列式](@entry_id:137120)**（Jacobian determinant）$J = \det(\mathbf{J})$，具有至关重要的几何意义。根据多元微[积分中的变量替换](@entry_id:140343)定理，它描述了无穷小体积元素在变换下的缩放关系 。一个在计算空间中体积为 $\mathrm{d}V_{\boldsymbol{\xi}} = \mathrm{d}\xi \mathrm{d}\eta \mathrm{d}\zeta$ 的无穷小立方体，在物理空间中会映射为一个无穷小的平行六面体，其有向体积为：
$$
\mathrm{d}V_{\mathbf{x}} = J(\boldsymbol{\xi}) \mathrm{d}V_{\boldsymbol{\xi}}
$$
这个关系是所有涉及在[曲线坐标系](@entry_id:172561)下进行积分计算的基础，例如在[有限体积法](@entry_id:749372)中计算单元体积或在[有限元法](@entry_id:749389)中变换积分域。

### 有效网格的条件

一个成功的 CFD 模拟始于一个“有效”的网格。一个变换要生成一个有效的网格，必须满足几个关键的数学和几何条件。

首先，映射 $\mathbf{x}(\boldsymbol{\xi})$ 必须是**双射**（bijective），即它必须是[单射](@entry_id:183792)（one-to-one）和满射（onto）的。[单射性](@entry_id:147722)确保计算空间中不同的点不会映射到物理空间中的同一点，从而防止网格单元发生重叠或折叠。这是网格有效性的最基本要求。

其次，映射的局部行为由雅可比行列式 $J$ 控制。根据[反函数定理](@entry_id:275014)，如果在一个点上 $J \neq 0$，则该映射在该点附近是局部可逆的。然而，对于一个用于守恒律离散的有效网格，我们需要一个更强的条件：雅可比行列式 $J$ 必须在整个计算域中**严格为正**，即 $J > 0$。这个条件的原因是三重的 ：

1.  **保持定向**：$J$ 的符号决定了[局部坐标系](@entry_id:751394)的定向。在计算空间中，坐标轴 $(\boldsymbol{\xi}, \boldsymbol{\eta}, \boldsymbol{\zeta})$ 通常构成一个[右手系](@entry_id:166669)。如果 $J > 0$，那么它们在物理空间中的像（即[雅可比矩阵](@entry_id:264467)的列向量）也构成一个[右手系](@entry_id:166669)。如果 $J  0$，则定向被反转，物理单元变成了“里外翻转”的左手系。这种**单元反转**（cell inversion）对于依赖于单元定向（如通过外法线计算通量）的[守恒格式](@entry_id:747715)是致命的。

2.  **避免奇异性**：如果在一个点或一个面上 $J = 0$，这意味着映射在该处是奇异的。物理空间中对应单元的体积坍缩为零。这在变换后的控制方程中会导致除以零的错误，因为变换后的方程通常包含 $1/J$ 这样的因子。

3.  **保证局部双射**：$J \neq 0$ 是局部双射的必要条件。如果 $J$ 从正值变为负值，它必须穿过 $J=0$ 的点或面，这标志着映射的折叠。

让我们通过两个例子来阐明这些概念 。考虑从 $\boldsymbol{\xi} = (\xi, \eta, \zeta) \in [0,1]^3$ 出发的两个映射：
-   映射 A: $\mathbf{x}_A(\boldsymbol{\xi}) = ( \xi, \eta, \zeta + \alpha \sin(2\pi \xi)\sin(2\pi \eta) )$
-   映射 B: $\mathbf{x}_B(\boldsymbol{\xi}) = ( \xi, \eta, \sin(\pi \zeta) )$

对于映射 A，可以计算出其[雅可比行列式](@entry_id:137120) $J_A \equiv 1$。由于 $J_A$ 处处为正，且该映射可以被证明是全局[单射](@entry_id:183792)的，因此它生成了一个有效的、没有重叠的网格。这是一种剪切类型的变换，它扭曲了网格但保持了体积。

相比之下，对于映射 B，其雅可比行列式为 $J_B = \pi \cos(\pi \zeta)$。在计算域 $\zeta \in [0,1]$ 内，当 $\zeta = 1/2$ 时，$J_B = 0$；当 $\zeta  1/2$ 时，$J_B > 0$；而当 $\zeta > 1/2$ 时，$J_B  0$。$J_B=0$ 的平面对应于物理空间中体积为零的退化单元。$J_B$ 的变号表示当 $\zeta$ 超过 $1/2$ 时，网格发生了折叠和反转。例如，点 $(\xi, \eta, 1/4)$ 和 $(\xi, \eta, 3/4)$ 被映射到物理空间中的同一点。因此，映射 B 生成的网格是无效的。

最后，需要注意的是，即使一个映射在域内每一点都满足 $J > 0$（保证了[局部可逆性](@entry_id:143266)），也**不能**保证它是全局单射的 。一个经典的例子是将笛卡尔坐标映射到极坐标，如果角度范围取得过大（例如 $\theta \in [0, 3\pi]$），映射虽然处处局部可逆，但会在全局上发生重叠。因此，确保全局有效性通常需要对边界施加额外的约束。此外，对于具有复杂拓扑结构的域，例如一个环形域（torus），单个结构化块（即一个立方体的像）在拓扑上就不可能填充整个域，因为立方体是单连通的（没有“洞”），而环形域不是 。这种情况需要使用**多块[结构化网格](@entry_id:170596)**（multi-block structured grids），这是更高级的主题。

### [曲线坐标系](@entry_id:172561)的几何工具

为了在变换后的[坐标系](@entry_id:156346)中分析和离散控制方程，我们需要一套描述[曲线网格](@entry_id:748122)局部几何特性的数学工具。这些工具源于[微分几何](@entry_id:145818)，并构成了[张量分析](@entry_id:161423)在CFD中的应用基础 。

**[协变与逆变](@entry_id:189600)[基向量](@entry_id:199546)**

- **[协变基](@entry_id:198968)向量** (Covariant Basis Vectors) 定义为物理空间位置向量 $\mathbf{x}$ 对计算坐标 $\xi^i$ 的[偏导数](@entry_id:146280)：
  $$
  \mathbf{a}_i = \frac{\partial \mathbf{x}}{\partial \xi^i}
  $$
  这些向量正是[雅可比矩阵](@entry_id:264467)的列向量。在几何上，$\mathbf{a}_i$ 向量在物理空间中与 $\xi^i$ 坐标线相切。它们构成了每个点上的[局部坐标](@entry_id:181200)基。

- **[逆变基](@entry_id:197906)向量** (Contravariant Basis Vectors) $\mathbf{a}^i$ 定义为其对偶基，满足关系：
  $$
  \mathbf{a}^i \cdot \mathbf{a}_j = \delta^i_j
  $$
  其中 $\delta^i_j$ 是克罗内克符号（当 $i=j$ 时为1，否则为0）。这个定义意味着 $\mathbf{a}^i$ 向量垂直于所有 $\mathbf{a}_j$（当 $j \neq i$ 时）。因此，$\mathbf{a}^i$ 垂直于由其他基[向量张成](@entry_id:152883)的 $\xi^i = \text{const}$ 的坐标面。可以证明，[逆变基](@entry_id:197906)向量等于计算坐标作为物理空间函数时的梯度：
  $$
  \mathbf{a}^i = \nabla_{\mathbf{x}} \xi^i
  $$

**度量张量**

度量张量描述了在[曲线坐标系](@entry_id:172561)下如何测量距离和角度。

- **协变度量张量** (Covariant Metric Tensor) 的分量定义为[协变基](@entry_id:198968)向量的[点积](@entry_id:149019)：
  $$
  g_{ij} = \mathbf{a}_i \cdot \mathbf{a}_j
  $$
  它直接关联到雅可比矩阵：若将[雅可比矩阵](@entry_id:264467)记为 $\mathbf{J}$，其分量为 $J_{\alpha i} = \partial x_\alpha / \partial \xi^i$，那么度量张量矩阵 $\mathbf{g}$ 可以写作 $\mathbf{g} = \mathbf{J}^T \mathbf{J}$。

- **逆变度量张量** (Contravariant Metric Tensor) 的分量定义为[逆变基](@entry_id:197906)向量的[点积](@entry_id:149019)：
  $$
  g^{ij} = \mathbf{a}^i \cdot \mathbf{a}^j
  $$
  可以证明，由 $g^{ij}$ 构成的矩阵是协变度量张量矩阵 $[g_{ij}]$ 的[逆矩阵](@entry_id:140380)，即 $[g^{ij}] = [g_{ij}]^{-1}$。

度量张量使得我们可以在[协变基](@entry_id:198968)和[逆变基](@entry_id:197906)之间转换。例如，一个[逆变基](@entry_id:197906)向量可以表示为[协变基](@entry_id:198968)向量的线性组合：$\mathbf{a}^i = \sum_j g^{ij} \mathbf{a}_j$。

最后，度量张量的[行列式](@entry_id:142978)与[雅可比行列式](@entry_id:137120)之间存在一个重要的关系：
$$
\det([g_{ij}]) = (\det(\mathbf{J}))^2 = J^2
$$
这个恒等式连接了映射的体积拉伸因子（$J$）和其度量属性（$g_{ij}$）。

如果一个网格在某点是**正交的** (orthogonal)，意味着该点的[协变基](@entry_id:198968)向量相互垂直，即当 $i \neq j$ 时，$g_{ij} = \mathbf{a}_i \cdot \mathbf{a}_j = 0$。需要强调的是，即使[雅可比行列式](@entry_id:137120) $J=1$（[体积守恒](@entry_id:276587)变换），也不意味着网格是正交的。例如，一个简单的[剪切变换](@entry_id:151272)即是如此 。

### 控制方程与积分的变换

[坐标变换](@entry_id:172727)的主要目的是为了能在一个简单的计算域上求解复杂的物理问题。这要求我们将原始的控制方程和相关积分从物理空间 $\mathbf{x}$ 变换到计算空间 $\boldsymbol{\xi}$。

**积分的变换**

正如前面提到的，体积（或面积）积分的变换遵循[变量替换定理](@entry_id:160749)。一个定义在物理域 $\Omega_{\mathbf{x}}$ 上的积分可以被转换为计算域 $\Omega_{\boldsymbol{\xi}}$ 上的积分：
$$
\int_{\Omega_{\mathbf{x}}} f(\mathbf{x}) \, dV_{\mathbf{x}} = \int_{\Omega_{\boldsymbol{\xi}}} f(\mathbf{x}(\boldsymbol{\xi})) J(\boldsymbol{\xi}) \, dV_{\boldsymbol{\xi}}
$$
其中 $J$ 是雅可比行列式。在实际计算中，这个积分通常通过[数值求积](@entry_id:136578)（如[高斯求积](@entry_id:146011)）来近似。

例如，考虑计算一个二维[曲面](@entry_id:267450)上总热率的问题，其中热源密度为 $s(\mathbf{x})$ 。总热率 $Q$ 是 $s$ 在[曲面](@entry_id:267450)上的[面积分](@entry_id:275394)。如果[曲面](@entry_id:267450)由映射 $\mathbf{x}(\xi, \eta)$ [参数化](@entry_id:272587)，则总热率的计算可变换为：
$$
Q = \int_{\text{物理面}} s(\mathbf{x}) \, dA = \int_{-1}^{1} \int_{-1}^{1} s(\mathbf{x}(\xi, \eta)) J(\xi, \eta) \, d\xi d\eta
$$
这里 $J$ 是[二维映射](@entry_id:270748)的雅可比行列式。如果被积函数是 $\xi$ 和 $\eta$ 的多项式，我们可以选择合适阶数的高斯求积法则来精确地计算这个积分。

**微分算子的变换**

微分算子（如梯度、散度）的变换规则更为复杂，它依赖于逆[雅可比矩阵](@entry_id:264467) $\mathbf{J}^{-1}$。根据[链式法则](@entry_id:190743)，物理空间中的[梯度算子](@entry_id:275922) $\nabla_{\mathbf{x}}$ 可以表示为：
$$
\nabla_{\mathbf{x}} u = (\mathbf{J}^{-1})^T \nabla_{\boldsymbol{\xi}} \hat{u}
$$
其中 $\hat{u}(\boldsymbol{\xi}) = u(\mathbf{x}(\boldsymbol{\xi}))$ 是在计算空间中的函数。

这个变换关系是推导所有变换后[微分方程](@entry_id:264184)的基础。例如，在有限元方法 (FEM) 中，一个典型的[弱形式](@entry_id:142897)项是 $\int \nabla_{\mathbf{x}} u \cdot \nabla_{\mathbf{x}} v \, d\mathbf{x}$ 。将其变换到计算空间，[点积](@entry_id:149019) $\nabla_{\mathbf{x}} u \cdot \nabla_{\mathbf{x}} v$ 变为：
$$
(\nabla_{\mathbf{x}} u)^T (\nabla_{\mathbf{x}} v) = ((\mathbf{J}^{-1})^T \nabla_{\boldsymbol{\xi}} \hat{u})^T ((\mathbf{J}^{-1})^T \nabla_{\boldsymbol{\xi}} \hat{v}) = (\nabla_{\boldsymbol{\xi}} \hat{u})^T (\mathbf{J}^{-1} (\mathbf{J}^{-1})^T) (\nabla_{\boldsymbol{\xi}} \hat{v})
$$
矩阵 $\mathbf{G} = \mathbf{J}^{-1} (\mathbf{J}^{-1})^T$ 正是[逆变](@entry_id:192290)度量张量 $[g^{ij}]$ 的[矩阵表示](@entry_id:146025)。因此，完整的变换后的积分项为：
$$
\int_{\Omega_{\boldsymbol{\xi}}} k(\boldsymbol{\xi}) (\nabla_{\boldsymbol{\xi}} \hat{u})^T [g^{ij}] (\nabla_{\boldsymbol{\xi}} \hat{v}) J \, d\boldsymbol{\xi}
$$
这个例子清楚地展示了度量张量和[雅可比行列式](@entry_id:137120)是如何自然地出现在变换后的方程中的。在**等参元**（isoparametric element）方法中，用于表示几何形状的[插值函数](@entry_id:262791)（例如，[拉格朗日多项式](@entry_id:142463)）与用于逼近解的函数是相同的，这为处理[曲面](@entry_id:267450)单元提供了一种优雅而强大的方式 。

### 网格属性对数值离散的影响

网格的几何属性，如正交性、偏斜度和各向异性，并非仅仅是美学上的考量，它们直接决定了数值解的准确性、稳定性和计算成本。

**网格正交性与准确性**

在许多应用中，尤其是在包含[边界层](@entry_id:139416)的[粘性流](@entry_id:136330)动模拟中，网格在固体边界处的**正交性**至关重要 。当一个网格非正交时（即当 $i \neq j$ 时，$g_{ij} \neq 0$），在离散[扩散](@entry_id:141445)项（如 $\nabla^2 u$）时，会引入**伪交叉导数项**（spurious cross-derivative terms）。例如，物理导数 $\partial^2 u / \partial n^2$（$n$ 为壁面法向）在非正交网格下会被展开为包含 $\partial^2 \hat{u} / \partial \xi \partial \eta$ 等项的复杂表达式。

在[边界层](@entry_id:139416)中，流动变量在壁面法向上的梯度远大于切向梯度。如果网格非正交，离散格式会将大的法向梯度与切向变化耦合起来，产生数值误差，这种现象被称为“[伪扩散](@entry_id:755256)”或“[交叉](@entry_id:147634)导数污染”。为了避免这种情况，理想的[边界层网格](@entry_id:746936)应在壁面处保持正交。这对应的几何条件是，在壁面（例如 $\eta=0$）上，与壁面相切的[协变基](@entry_id:198968)向量（例如 $\mathbf{a}_\xi$）应与离开壁面的[协变基](@entry_id:198968)向量（$\mathbf{a}_\eta$）垂直，即 $\mathbf{a}_\xi \cdot \mathbf{a}_\eta = g_{\xi\eta} = 0$。

**网格偏斜/各向异性与稳定性**

网格的几何质量也直接影响[显式时间积分](@entry_id:165797)格式的稳定性极限，即**CFL条件**（[Courant-Friedrichs-Lewy](@entry_id:175598) condition）。对于一个简单的平流方程，CFL条件限制了时间步长 $\Delta t$。在[曲线坐标系](@entry_id:172561)下，这个限制取决于变换后的**[逆变](@entry_id:192290)速度** (contravariant velocities)，而不是物理速度 。

对于一个给定的物理速度 $\mathbf{v}$，逆变速度分量 $U^i = \mathbf{a}^i \cdot \mathbf{v}$。一个高度偏斜的网格可能导致即使物理速度很小，某些逆变速度分量也变得非常大，从而导致一个非常小、不切实际的[稳定时间步长](@entry_id:755325)。例如，对于一个[剪切映射](@entry_id:754760) $x = \xi + s\eta, y=\eta$，当偏斜因子 $s$ 很大时，即使物理速度很小，$\xi$ 方向的[逆变](@entry_id:192290)速度也会变得很大，严重限制 $\Delta t$。

类似地，网格的**各向异性拉伸**（anisotropic stretching）也会影响稳定性。在[边界层网格](@entry_id:746936)中，单元在法向方向上通常比切向方向上小得多。这种拉伸体现在度量张量 $\mathbf{g}$ 的[特征值](@entry_id:154894)上。可以推导出，对于[平流](@entry_id:270026)问题，最大允许时间步长与 $\sqrt{\sum_i (1/\lambda_i)}$ 成反比，其中 $\lambda_i$ 是度量张量的[特征值](@entry_id:154894) 。这意味着，在某个方向上的极端拉伸（对应一个很小的[特征值](@entry_id:154894)）将会极大地限制全局时间步长。

**网格奇异性与刚度**

在处理具有尖角或重入角的几何时，[网格生成](@entry_id:149105)本身就面临挑战。为了使网格线适应这些几何特征，映射可能在角点附近变得奇[异或](@entry_id:172120)接近奇异，即 $J \to 0$ 。当这种情况发生时，变换后的[微分算子](@entry_id:140145)（如用于[椭圆网格生成](@entry_id:748939)的拉普拉斯算子）的系数可能会变得极端不均衡。变换后的[扩散张量](@entry_id:748421) $\mathbf{D} = (1/J) [g^{ij}]^{-1}$ 的[特征值](@entry_id:154894)之比，即**[刚度比](@entry_id:142692)**（stiffness ratio），会变得非常大。这导致离散后的线性系统是**病态的**（ill-conditioned），使得迭代求解器收敛极其缓慢。为了解决这个问题，可以引入**网格[控制函数](@entry_id:183140)**（grid control functions）来正则化变换后的算子，有目的地改变其各向异性，从而改善刚度。

### [曲线网格](@entry_id:748122)上的守恒性与一致性

当我们将一个守恒律（如[Navier-Stokes方程](@entry_id:161487)）从物理空间变换到计算空间时，一个至关重要的要求是保持其[守恒形式](@entry_id:747710)。这不仅是理论上的优雅，更是数值方案能够正确捕捉激波并保证全局量（如总质量）守恒的基础。

经过变换，一个形如 $\partial_t U + \nabla_{\mathbf{x}} \cdot \mathbf{F} = 0$ 的守恒律会变成：
$$
\frac{\partial (JU)}{\partial t} + \nabla_{\boldsymbol{\xi}} \cdot \hat{\mathbf{F}} = 0
$$
其中 $\hat{\mathbf{F}}$ 是在计算空间中的通量。一个基本的一致性要求是，一个在物理空间中均匀的流场（即 $U$ 和 $\mathbf{F}$ 处处为常数）在计算中也必须是一个[稳态解](@entry_id:200351)，即其时间导数和通量散度都应为零。

将常数物理通量代入变换后的方程，我们发现要使通量散度为零，必须满足一组纯粹由网格几何决定的恒等式。这些恒等式被称为**[几何守恒律](@entry_id:170384)** (Geometric Conservation Law, GCL) 。在连续形式下，它们可以写作：
$$
\sum_i \frac{\partial (J a^i_k)}{\partial \xi^i} = 0, \quad \text{for each } k=1,2,3
$$
其中 $a^i_k = \partial \xi^i / \partial x_k$ 是逆雅可比矩阵的分量。这个恒等式源于[光滑映射](@entry_id:203730)的[混合偏导数](@entry_id:139334)可以交换次序这一事实。

至关重要的是，当我们在离散网格上求解时，用于计算几何量（如单元体积 $J$ 和面法向 $J \mathbf{a}^i$）的离散方法，必须与用于计算通量散度的离散算子相**一致**。只有这样，离散形式的 GCL 才能得到满足。如果一个数值方案不满足离散 GCL，它就无法精确地保持一个[均匀流](@entry_id:272775)场，会在一个本应没有任何变化的流场中产生[伪解](@entry_id:275285)，这是一个严重的缺陷。因此，满足 GCL 是高质量 CFD 求解器的基本要求。