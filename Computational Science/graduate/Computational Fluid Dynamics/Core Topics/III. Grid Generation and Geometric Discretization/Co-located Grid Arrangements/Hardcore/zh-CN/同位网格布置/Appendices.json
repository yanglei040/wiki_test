{
    "hands_on_practices": [
        {
            "introduction": "本练习旨在帮助您从根本上理解为什么同位网格需要特殊处理。我们将通过数值实验，演示臭名昭著的“棋盘格”压力问题，这是一种在朴素离散格式下可能出现的非物理振荡。通过构建一个能激发此模式的特定源项，您将亲眼看到在一个简单的同位网格方案中，该模式如何“隐藏”于动量方程之外，而交错网格布置却能有效地捕捉并抑制它，从而揭示了为何需要Rhie-Chow插值这类稳定化技术。",
            "id": "3365597",
            "problem": "考虑在每个方向上长度为 $L=1$ 的二维周期性区域上的稳态不可压缩斯托克斯方程，其空间坐标为 $(x,y)$，速度场为 $\\mathbf{u}(x,y) = (u(x,y), v(x,y))$：\n$$\n-\\nabla p + \\nu \\nabla^2 \\mathbf{u} = \\mathbf{f}, \\quad \\nabla \\cdot \\mathbf{u} = 0,\n$$\n其中 $p(x,y)$ 是压力，$\\nu$ 是运动粘度，$\\mathbf{f}(x,y)$ 是给定的体力。在分步投影法中，压力场 $p$ 是通过求解以下与强制执行离散不可压缩性相关的压力泊松方程来恢复的：\n$$\n\\nabla^2 p = s,\n$$\n其中 $s$ 是一个离散源项，由中间速度场的散度构造而成。在间距为 $\\Delta x = \\Delta y$ 的均匀笛卡尔网格上，不同的网格布置会导致不同的离散梯度和散度算子。具体来说：\n- 同位（单元中心）网格布置将 $u$、$v$ 和 $p$ 都置于单元中心。一种常见的简单中心差分实现使用每个坐标方向上的最近邻点来计算中心的离散压力梯度：\n$$\n\\left(\\frac{\\partial p}{\\partial x}\\right)_{i,j}^{\\text{col}} = \\frac{p_{i+1,j} - p_{i-1,j}}{2 \\Delta x}, \\quad\n\\left(\\frac{\\partial p}{\\partial y}\\right)_{i,j}^{\\text{col}} = \\frac{p_{i,j+1} - p_{i,j-1}}{2 \\Delta x}.\n$$\n- Marker-And-Cell (MAC) 交错网格布置将 $u$ 置于垂直面 $(i+\\tfrac{1}{2}, j)$ 上，$v$ 置于水平面 $(i, j+\\tfrac{1}{2})$ 上，而 $p$ 置于单元中心 $(i,j)$ 上。离散压力梯度自然地出现在面上：\n$$\n\\left(\\frac{\\partial p}{\\partial x}\\right)_{i+\\frac{1}{2},j}^{\\text{MAC}} = \\frac{p_{i+1,j} - p_{i,j}}{\\Delta x}, \\quad\n\\left(\\frac{\\partial p}{\\partial y}\\right)_{i,j+\\frac{1}{2}}^{\\text{MAC}} = \\frac{p_{i,j+1} - p_{i,j}}{\\Delta x}.\n$$\n\n众所周知，同位中心差分会产生一种伪压力模式，通常称为棋盘模式，它在 $N_x \\times N_y$ 均匀周期性网格上定义为\n$$\np_{i,j}^{\\text{chk}} = (-1)^{i+j}, \\quad i = 0,1,\\dots,N_x-1, \\quad j = 0,1,\\dots,N_y-1,\n$$\n它对应于最高可分辨空间频率（奈奎斯特模式）。该模式可由某些离散强迫项激发，在同位网格上，通过从中心到面的简单插值，它会与动量方程解耦，导致 $p$ 中出现不驱动动量的非物理振荡。相比之下，MAC 交错网格抑制了这种解耦，因为面心离散梯度直接对相邻的单元中心压力进行采样，棋盘模式的差分在面上不为零。\n\n您的任务是：\n1. 使用制造源项 $s_{i,j} = (-1)^{i+j}$ 在具有周期性边界条件的离散压力泊松方程中激发棋盘模式，该方程通过标准五点拉普拉斯算子进行离散化。在间距为 $\\Delta x$ 的均匀网格上，五点拉普拉斯算子的离散傅里叶符号为\n$$\n\\lambda(k_x,k_y) = \\frac{2}{\\Delta x^2}\\left(\\cos(k_x \\Delta x)-1\\right) + \\frac{2}{\\Delta x^2}\\left(\\cos(k_y \\Delta x)-1\\right),\n$$\n其中离散波数为 $k_x = \\frac{2\\pi m}{L}$，$k_y = \\frac{2\\pi n}{L}$，$m = 0,1,\\dots,N_x-1$ 且 $n = 0,1,\\dots,N_y-1$。当 $N_x$ 和 $N_y$ 为偶数时，棋盘模式对应于 $(m,n) = (N_x/2, N_y/2)$，此时 $\\cos(\\pi) = -1$，因此\n$$\n\\lambda_{\\text{chk}} = -\\frac{4}{\\Delta x^2} - \\frac{4}{\\Delta x^2} = -\\frac{8}{\\Delta x^2}.\n$$\n由此，与棋盘强迫项相关的压力振幅按以下比例缩放\n$$\nA_p(\\Delta x) = \\frac{1}{|\\lambda_{\\text{chk}}|} = \\frac{\\Delta x^2}{8}.\n$$\n2. 对于一系列均匀网格，在傅里叶域中使用上述离散拉普拉斯符号数值求解离散周期性泊松方程 $\\nabla^2 p = s$，并通过将计算出的 $p$ 投影到 $p^{\\text{chk}}$ 上来提取棋盘分量的数值振幅 $A_p(\\Delta x)$。\n3. 计算并比较在以下两种情况下，会进入动量方程的面心压力梯度的均方根 (RMS) 大小：\n   - 通过将相邻单元的中心梯度平均到面上获得的同位网格简单面梯度：\n   $$\n   \\left(\\frac{\\partial p}{\\partial x}\\right)_{i+\\frac{1}{2},j}^{\\text{col-face}} = \\frac{1}{2}\\left[\\left(\\frac{\\partial p}{\\partial x}\\right)_{i,j}^{\\text{col}} + \\left(\\frac{\\partial p}{\\partial x}\\right)_{i+1,j}^{\\text{col}}\\right], \\quad\n   \\left(\\frac{\\partial p}{\\partial y}\\right)_{i,j+\\frac{1}{2}}^{\\text{col-face}} = \\frac{1}{2}\\left[\\left(\\frac{\\partial p}{\\partial y}\\right)_{i,j}^{\\text{col}} + \\left(\\frac{\\partial p}{\\partial y}\\right)_{i,j+1}^{\\text{col}}\\right].\n   $$\n   - MAC 面梯度，如上定义。RMS 大小定义为\n   $$\n   G_{\\text{RMS}} = \\sqrt{\\frac{1}{N_f}\\sum_{f} g_f^2},\n   $$\n   其中 $g_f$ 遍历两个方向上的所有面梯度分量，$N_f$ 是面的总数。\n4. 数值上证明：\n   - 同位网格的简单面梯度对棋盘分量“视而不见”，因此对于制造的强迫项，其 RMS 大小在数值上为零，这解释了解耦现象。\n   - MAC 面梯度与棋盘模式耦合，并且对于制造的强迫项，其 RMS 大小按 $\\mathcal{O}(\\Delta x)$ 比例缩放，因为 $A_p(\\Delta x) \\sim \\Delta x^2$ 且面梯度按 $A_p(\\Delta x)/\\Delta x$ 比例缩放。\n\n实现一个程序，该程序：\n- 在长度为 $L=1$ 的周期性区域上构建制造源项 $s_{i,j} = (-1)^{i+j}$。\n- 在傅里叶空间中使用离散拉普拉斯符号求解离散泊松方程以获得 $p_{i,j}$。\n- 通过投影到 $(-1)^{i+j}$ 上计算数值棋盘振幅 $A_p(\\Delta x)$。\n- 为得到的 $p_{i,j}$ 计算 $G_{\\text{RMS}}^{\\text{col-face}}$ 和 $G_{\\text{RMS}}^{\\text{MAC}}$。\n- 报告每个网格的元组 $(A_p(\\Delta x), G_{\\text{RMS}}^{\\text{col-face}}, G_{\\text{RMS}}^{\\text{MAC}})$。\n\n测试套件：\n- 对以下情况使用 $N_x=N_y$ 和 $L=1$ 的方形网格：\n  1. $N_x=N_y=8$ (粗网格, $\\Delta x = 1/8$)。\n  2. $N_x=N_y=16$ (中等网格, $\\Delta x = 1/16$)。\n  3. $N_x=N_y=32$ (细网格, $\\Delta x = 1/32$)。\n  4. $N_x=N_y=64$ (极细网格, $\\Delta x = 1/64$)。\n所有报告的量都是无量纲的。您的程序应生成单行输出，其中包含结果，形式为由四个方括号括起来的元组组成的逗号分隔列表，每个元组的顺序为 $(A_p(\\Delta x), G_{\\text{RMS}}^{\\text{col-face}}, G_{\\text{RMS}}^{\\text{MAC}})$，与测试用例的顺序相同，例如：\n\"[(a1,b1,c1),(a2,b2,c2),(a3,b3,c3),(a4,b4,c4)]\"。",
            "solution": "我们从稳态不可压缩斯托克斯方程开始\n$$\n-\\nabla p + \\nu \\nabla^2 \\mathbf{u} = \\mathbf{f}, \\quad \\nabla \\cdot \\mathbf{u} = 0,\n$$\n在分步投影法下，这导致通过压力泊松方程来强制执行离散不可压缩性\n$$\n\\nabla^2 p = s,\n$$\n其中源项 $s$ 是从中间速度的散度获得的。在均匀周期性网格上，在离散傅里叶空间中求解此泊松方程是很自然的，并且能揭示某些空间模式如何传播到压力中。我们关注棋盘（奈奎斯特）模式，\n$$\np_{i,j}^{\\text{chk}} = (-1)^{i+j},\n$$\n它在相邻的单元中心之间符号交替变化。\n\n对于间距为 $\\Delta x$ 且具有周期性边界条件的均匀网格，标准的五点离散拉普拉斯算子具有傅里叶符号\n$$\n\\lambda(k_x,k_y) = \\frac{2}{\\Delta x^2}\\left(\\cos(k_x \\Delta x)-1\\right) + \\frac{2}{\\Delta x^2}\\left(\\cos(k_y \\Delta x)-1\\right),\n$$\n其中离散波数为 $k_x = \\frac{2\\pi m}{L}$ 和 $k_y = \\frac{2\\pi n}{L}$，$m=0,\\dots,N_x-1$，$n=0,\\dots,N_y-1$，$L=1$。对于棋盘模式，$(m,n)=(N_x/2, N_y/2)$ 且 $k_x \\Delta x = \\pi$, $k_y \\Delta x = \\pi$，得到\n$$\n\\lambda_{\\text{chk}} = \\frac{2}{\\Delta x^2}\\left(\\cos \\pi - 1\\right) + \\frac{2}{\\Delta x^2}\\left(\\cos \\pi - 1\\right) = \\frac{2}{\\Delta x^2}\\left(-1 - 1\\right) + \\frac{2}{\\Delta x^2}\\left(-1 - 1\\right) = -\\frac{8}{\\Delta x^2}.\n$$\n用 $s_{i,j}=(-1)^{i+j}$ 强迫泊松方程意味着右端项仅包含此模式。因此，解与同一模式成正比：\n$$\np_{i,j} = A_p(\\Delta x)\\, (-1)^{i+j}.\n$$\n将其代入傅里叶空间中的离散泊松方程可得\n$$\n\\lambda_{\\text{chk}} A_p(\\Delta x) = 1 \\quad \\Rightarrow \\quad A_p(\\Delta x) = -\\frac{1}{\\lambda_{\\text{chk}}} = \\frac{\\Delta x^2}{8}.\n$$\n因此，计算出的压力中棋盘分量的振幅按 $\\Delta x^2$ 比例缩放。\n\n同位网格和 Marker-And-Cell (MAC) 交错网格之间的区别体现在压力梯度在动量方程中的表示方式上：\n- 在同位（单元中心）格式中，一种常见的简单实现使用中心差分来估计单元中心的 $\\left(\\frac{\\partial p}{\\partial x}\\right)_{i,j}^{\\text{col}}$ 和 $\\left(\\frac{\\partial p}{\\partial y}\\right)_{i,j}^{\\text{col}}$。对于棋盘压力 $p_{i,j} = A_p(\\Delta x)\\,(-1)^{i+j}$，\n$$\n\\left(\\frac{\\partial p}{\\partial x}\\right)_{i,j}^{\\text{col}} = \\frac{p_{i+1,j} - p_{i-1,j}}{2 \\Delta x}\n= \\frac{A_p(\\Delta x)\\left[(-1)^{i+1+j} - (-1)^{i-1+j}\\right]}{2\\Delta x}\n= \\frac{A_p(\\Delta x)\\,(-1)^{i+j}\\left[-1 - (-1)\\right]}{2\\Delta x} = 0,\n$$\n类似的计算表明 $\\left(\\frac{\\partial p}{\\partial y}\\right)_{i,j}^{\\text{col}}=0$。如果接着通过平均相邻的中心梯度来简单地构造面梯度，那么驱动动量方程的最终面压力梯度仍然为零。这证明了解耦：在同位简单格式中，棋盘压力不产生面心压力。\n- 在 MAC 交错网格布置中，面心离散梯度直接取相邻中心压力的差分：\n$$\n\\left(\\frac{\\partial p}{\\partial x}\\right)_{i+\\frac{1}{2},j}^{\\text{MAC}} = \\frac{p_{i+1,j} - p_{i,j}}{\\Delta x}\n= \\frac{A_p(\\Delta x)\\left[(-1)^{i+1+j} - (-1)^{i+j}\\right]}{\\Delta x}\n= \\frac{A_p(\\Delta x)\\,(-1)^{i+j}(-1 - 1)}{\\Delta x}\n= -\\frac{2\\,A_p(\\Delta x)}{\\Delta x}\\,(-1)^{i+j}.\n$$\n对于 $\\left(\\frac{\\partial p}{\\partial y}\\right)_{i,j+\\frac{1}{2}}^{\\text{MAC}}$ 也有类似的表达式。因此，MAC 面梯度与棋盘模式强耦合，并驱动动量修正来抑制此类振荡。对于制造的强迫项，MAC 面梯度的大小按 $\\frac{A_p(\\Delta x)}{\\Delta x} \\sim \\frac{\\Delta x^2}{\\Delta x} = \\mathcal{O}(\\Delta x)$ 比例缩放。\n\n程序的算法设计：\n1. 对于每个具有 $N_x=N_y$ 和 $\\Delta x = 1/N_x$ 的测试网格，构造制造源项 $s_{i,j} = (-1)^{i+j}$。\n2. 计算 $s$ 的二维离散傅里叶变换以获得 $\\hat{s}(m,n)$。\n3. 对于每个傅里叶模式 $(m,n)$，使用以下公式计算离散拉普拉斯符号 $\\lambda(m,n)$\n$$\n\\lambda(m,n) = \\frac{2}{\\Delta x^2}\\left(\\cos\\left(\\frac{2\\pi m}{N_x}\\right)-1\\right) + \\frac{2}{\\Delta x^2}\\left(\\cos\\left(\\frac{2\\pi n}{N_y}\\right)-1\\right).\n$$\n4. 对所有 $\\lambda(m,n) \\neq 0$ 的 $(m,n)$ 计算 $\\hat{p}(m,n) = \\hat{s}(m,n) / \\lambda(m,n)$。由于交替模式，零模式 $(m,n)=(0,0)$ 在 $\\hat{s}$ 中不存在，因此不会发生除以零的情况。\n5. 进行逆变换以在物理空间中获得 $p_{i,j}$。\n6. 将 $p$ 投影到棋盘模式上以提取振幅，\n$$\nA_p(\\Delta x) = \\frac{1}{N_x N_y} \\sum_{i=0}^{N_x-1}\\sum_{j=0}^{N_y-1} p_{i,j}(-1)^{i+j}.\n$$\n7. 使用中心差分计算同位中心梯度，然后通过将相邻中心梯度平均到面上来获得同位面梯度。计算所有面上的均方根大小：\n$$\nG_{\\text{RMS}}^{\\text{col-face}} = \\sqrt{\\frac{1}{N_f}\\sum_{f}\\left(g_{f}^{\\text{col-face}}\\right)^2}.\n$$\n8. 根据相邻中心压力计算 MAC 面梯度及相应的均方根大小：\n$$\nG_{\\text{RMS}}^{\\text{MAC}} = \\sqrt{\\frac{1}{N_f}\\sum_{f}\\left(g_{f}^{\\text{MAC}}\\right)^2}.\n$$\n9. 为测试套件中的每个网格输出 $(A_p(\\Delta x), G_{\\text{RMS}}^{\\text{col-face}}, G_{\\text{RMS}}^{\\text{MAC}})$，按规定汇总成单行。\n\n预期行为：\n- 数值 $A_p(\\Delta x)$ 应与 $\\Delta x^2/8$ 近似成比例（取决于浮点精度和离散变换的归一化）。\n- $G_{\\text{RMS}}^{\\text{col-face}}$ 在数值上应为零（达到机器精度），表明同位简单梯度对棋盘压力不敏感。\n- 对于此制造强迫项，$G_{\\text{RMS}}^{\\text{MAC}}$ 应与 $\\Delta x$呈线性比例关系，因为面梯度大小的行为类似于 $2 A_p(\\Delta x)/\\Delta x$。\n\n这直接展示了 Marker-And-Cell (MAC) 交错网格抑制棋盘压力模式的机制：通过将速度置于面上，离散压力梯度被评估为相邻压力的差值，该差值对于交替模式不为零，从而将伪模式耦合到动量中，并在其中被耗散。相比之下，同位网格中用于中心压力梯度的简单中心差分会消除交替分量，从而允许伪压力模式在不影响速度场的情况下持续存在。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef discrete_laplacian_symbol(nx, ny, dx):\n    \"\"\"\n    Build the discrete Laplacian symbol lambda(m,n) for a periodic grid\n    using the five-point stencil central differences on a uniform grid.\n    \"\"\"\n    # Wavenumber indices m, n\n    m = np.arange(nx)\n    n = np.arange(ny)\n    # Cosine terms for each axis\n    cos_m = np.cos(2.0 * np.pi * m / nx)\n    cos_n = np.cos(2.0 * np.pi * n / ny)\n    # Broadcast to 2D grid of (m,n)\n    lam = (2.0 / dx**2) * (cos_m[:, None] - 1.0) + (2.0 / dx**2) * (cos_n[None, :] - 1.0)\n    return lam\n\ndef solve_poisson_checkerboard(nx, ny, L=1.0):\n    \"\"\"\n    Solve the discrete periodic Poisson equation for s_{i,j} = (-1)^{i+j}\n    using the discrete Laplacian symbol in Fourier space.\n\n    Returns:\n        p: computed pressure field (nx x ny)\n        Ap: numerical checkerboard amplitude via projection onto (-1)^{i+j}\n    \"\"\"\n    dx = L / nx\n    # Manufactured source s = (-1)^{i+j}\n    i = np.arange(nx)[:, None]\n    j = np.arange(ny)[None, :]\n    s = ((-1.0) ** (i + j)).astype(np.float64)\n\n    # FFT of source\n    s_hat = np.fft.fft2(s)\n\n    # Discrete Laplacian symbol\n    lam = discrete_laplacian_symbol(nx, ny, dx)\n\n    # Avoid division by zero: source has zero mean, so lam[0,0] won't be used\n    # Construct p_hat = s_hat / lam\n    # Use where to handle potential zeros robustly (though s_hat[0,0]==0)\n    p_hat = np.zeros_like(s_hat, dtype=np.complex128)\n    mask = lam != 0.0\n    p_hat[mask] = s_hat[mask] / lam[mask]\n\n    # Inverse FFT to get p\n    p = np.real(np.fft.ifft2(p_hat))\n\n    # Compute checkerboard amplitude Ap = mean(p * (-1)^{i+j})\n    pattern = ((-1.0) ** (i + j)).astype(np.float64)\n    Ap = np.sum(p * pattern) / (nx * ny)\n\n    return p, Ap, dx\n\ndef colocated_face_gradient_rms(p, dx):\n    \"\"\"\n    Compute colocated center gradients via central differences and then\n    naive face gradients by averaging adjacent center gradients.\n    Return RMS magnitude over all faces.\n    \"\"\"\n    nx, ny = p.shape\n\n    # Periodic shifts\n    p_ip = np.roll(p, -1, axis=0)\n    p_im = np.roll(p,  1, axis=0)\n    p_jp = np.roll(p, -1, axis=1)\n    p_jm = np.roll(p,  1, axis=1)\n\n    # Center gradients (central difference)\n    gx_c = (p_ip - p_im) / (2.0 * dx)\n    gy_c = (p_jp - p_jm) / (2.0 * dx)  # dx == dy\n\n    # Face gradients: average adjacent center gradients to faces\n    # x-faces at (i+1/2, j): average gx_c[i,j] and gx_c[i+1,j]\n    gx_face = 0.5 * (gx_c + np.roll(gx_c, -1, axis=0))\n    # y-faces at (i, j+1/2): average gy_c[i,j] and gy_c[i,j+1]\n    gy_face = 0.5 * (gy_c + np.roll(gy_c, -1, axis=1))\n\n    # RMS over all faces (both directions)\n    # Number of faces: 2 * nx * ny\n    rms = np.sqrt((np.sum(gx_face**2) + np.sum(gy_face**2)) / (2.0 * nx * ny))\n    return rms\n\ndef mac_face_gradient_rms(p, dx):\n    \"\"\"\n    Compute MAC face gradients directly from adjacent center pressures.\n    Return RMS magnitude over all faces.\n    \"\"\"\n    nx, ny = p.shape\n\n    # x-face gradient: (p_{i+1,j} - p_{i,j}) / dx\n    p_ip = np.roll(p, -1, axis=0)\n    gx_face = (p_ip - p) / dx\n\n    # y-face gradient: (p_{i,j+1} - p_{i,j}) / dx\n    p_jp = np.roll(p, -1, axis=1)\n    gy_face = (p_jp - p) / dx\n\n    rms = np.sqrt((np.sum(gx_face**2) + np.sum(gy_face**2)) / (2.0 * nx * ny))\n    return rms\n\ndef run_test_case(nx):\n    ny = nx\n    p, Ap, dx = solve_poisson_checkerboard(nx, ny, L=1.0)\n    rms_col = colocated_face_gradient_rms(p, dx)\n    rms_mac = mac_face_gradient_rms(p, dx)\n    return (Ap, rms_col, rms_mac)\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [8, 16, 32, 64]\n\n    results = []\n    for nx in test_cases:\n        Ap, rms_col, rms_mac = run_test_case(nx)\n        # Format each tuple with reasonable precision\n        results.append(f\"({Ap:.10f},{rms_col:.10e},{rms_mac:.10e})\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在理解了稳定化的必要性之后，我们现在转向最常见解决方案的核心机制：Rhie-Chow插值。本练习将引导您推导同位网格上压力修正方程的系数，这是至关重要的一步。从SIMPLE算法的基本原理和Rhie-Chow插值格式出发，您将构建出将压力修正与质量守恒耦合起来的代数系统，从而具体地理解该技术在数学上是如何防止解耦的。",
            "id": "3302122",
            "problem": "考虑一个在同位（co-located）有限体积网格上求解的二维、不可压缩、密度恒定的流动，其中所有原始变量都存储在单元中心。网格是均匀的，间距为 $\\Delta x$ 和 $\\Delta y$，因此任何内部单元 $P$ 的控制体积为 $\\Delta V = \\Delta x \\Delta y$，面面积为 $A_{e} = \\Delta y$、$A_{w} = \\Delta y$、$A_{n} = \\Delta x$ 和 $A_{s} = \\Delta x$。时间积分采用隐式欧拉法，时间步长为 $\\Delta t$。为了避免同位网格上的压力-速度解耦，面质量通量使用 Rhie–Chow 插值法构建，其中面法向速度修正取决于通过对单元中心对角系数的倒数进行中心插值得出的动量方程的面有效逆对角元。\n\n假设在水平速度分量 $u$ 和垂直速度分量 $v$ 的离散化动量方程中，所有单元的对角系数恰好为 $a_{P}^{u} = a_{P}^{v} = \\rho \\Delta V / \\Delta t$，其中 $\\rho$ 是恒定密度。利用这个假设，并通过对对角系数的倒数进行中心插值来计算每个面的面有效对角元，推导并显式地组合内部单元 $P$ 的线性压力修正方程的系数，\n$$\na_{P}^{p'} \\, p'_{P} \\;=\\; a_{E}^{p'} \\, p'_{E} \\;+\\; a_{W}^{p'} \\, p'_{W} \\;+\\; a_{N}^{p'} \\, p'_{N} \\;+\\; a_{S}^{p'} \\, p'_{S} \\;+\\; b_{P}^{p'} \\,,\n$$\n其中 $p'$ 表示压力修正值，$b_{P}^{p'}$ 是由预测（未修正）通量的质量通量不平衡引起的修正源项。用 $\\Delta x$、$\\Delta y$、$\\rho$ 和 $\\Delta t$ 表示组合后的系数 $a_{W}^{p'}$、$a_{E}^{p'}$、$a_{S}^{p'}$、$a_{N}^{p'}$ 以及对角项 $a_{P}^{p'}$。以 $a_{W}^{p'}$、$a_{E}^{p'}$、$a_{S}^{p'}$、$a_{N}^{p'}$、$a_{P}^{p'}$ 的顺序将最终答案表示为单行。无需进行数值计算。",
            "solution": "用户希望我使用 Rhie-Chow 插值法，推导同位网格压力修正方程的系数。\n\n以下是我需要执行的步骤分解：\n\n1.  **问题验证**：\n    *   **提取已知条件**：我需要逐字列出问题陈述中提供的所有信息。\n        *   流动：二维、不可压缩、密度恒定。\n        *   网格：同位有限体积网格，均匀，间距为 $\\Delta x$ 和 $\\Delta y$。\n        *   控制体积：$\\Delta V = \\Delta x \\Delta y$。\n        *   面面积：$A_{e} = \\Delta y$、$A_{w} = \\Delta y$、$A_{n} = \\Delta x$、$A_{s} = \\Delta x$。\n        *   时间积分：隐式欧拉法，时间步长为 $\\Delta t$。\n        *   解耦防止：Rhie-Chow 插值法。\n        *   面法向速度修正：取决于动量方程的面有效逆对角元。\n        *   面有效逆对角元：通过对单元中心对角系数的倒数进行中心插值得到。\n        *   对角系数：对于所有单元，$a_{P}^{u} = a_{P}^{v} = \\rho \\Delta V / \\Delta t$。\n        *   目标方程：$a_{P}^{p'} \\, p'_{P} \\;=\\; a_{E}^{p'} \\, p'_{E} \\;+\\; a_{W}^{p'} \\, p'_{W} \\;+\\; a_{N}^{p'} \\, p'_{N} \\;+\\; a_{S}^{p'} \\, p'_{S} \\;+\\; b_{P}^{p'}$。\n        *   任务：用 $\\Delta x$、$\\Delta y$、$\\rho$、$\\Delta t$ 表示并推导组合系数 $a_{W}^{p'}$、$a_{E}^{p'}$、$a_{S}^{p'}$、$a_{N}^{p'}$ 和 $a_{P}^{p'}$。\n        *   输出顺序：$a_{W}^{p'}$、$a_{E}^{p'}$、$a_{S}^{p'}$、$a_{N}^{p'}$、$a_{P}^{p'}$。\n\n    *   **验证已知条件**：\n        *   **是否科学合理？**：是。该问题描述了压力修正方程的推导，这是计算流体动力学（CFD）中 SIMPLE 系列算法的核心组成部分。在同位网格上使用 Rhie-Chow 插值法是一种标准且必要的技术。假设的动量方程对角系数形式是一个有效的简化，对应于纯瞬态问题，常用于教科书的推导中。\n        *   **是否适定？**：是。问题陈述清晰，提供了足够的信息来推导一组唯一的系数。\n        *   **是否客观？**：是。问题使用了 CFD 领域的精确、标准术语。\n        *   **是否符合主题？**：是，此问题是 CFD 中同位网格布置主题的核心。\n        *   **是否不完整/矛盾？**：否。问题提供了一套自洽的假设和定义。\n        *   **是否不切实际/不可行？**：将对角系数简化为仅包含瞬态项是一种教学上的选择，而非物理上不可能。它简化了代数复杂性，以便专注于压力修正方程本身的结构。该问题在量纲上是一致的，因为动量方程可以解释为单位深度的力，压力修正方程可以解释为单位深度的质量通量不平衡。\n        *   **是否不适定/结构不良？**：否。问题结构逻辑清晰，可以导出一个确定的解。\n        *   **是否故作高深/过于简单？**：否。推导需要基于有限体积法基本原理的多个非平凡步骤。\n        *   **是否无法验证？**：否。推导可以通过基于所提供的物理和数值原理的标准代数操作进行验证。\n\n    *   **结论**：问题有效。现在开始推导求解。\n\n压力修正方程是通过对修正后的速度场强制执行质量守恒来推导的。对于均匀笛卡尔网格上的二维不可压缩流，控制体积 $P$ 的离散化连续性方程为：\n$$\n(\\rho u A)_{e} - (\\rho u A)_{w} + (\\rho v A)_{n} - (\\rho v A)_{s} = 0\n$$\n其中 $u$ 和 $v$ 是单元面上的速度分量，$A$ 是面面积。在 SIMPLE 算法框架内，速度场和压力场被分解为预测部分（用 $*$ 表示）和修正部分（用 $'$ 表示）：\n$$\np = p^* + p' \\quad, \\quad u = u^* + u' \\quad, \\quad v = v^* + v'\n$$\n预测速度 $u^*$ 和 $v^*$ 通常不满足连续性方程，导致单元 $P$ 出现质量通量不平衡。修正后的速度必须满足连续性方程。将分解式代入连续性方程并重新整理，得到一个关于修正量的方程：\n$$\n(\\rho u' A)_{e} - (\\rho u' A)_{w} + (\\rho v' A)_{n} - (\\rho v' A)_{s} = - [(\\rho u^* A)_{e} - (\\rho u^* A)_{w} + (\\rho v^* A)_{n} - (\\rho v^* A)_{s}]\n$$\n右侧是预测步骤中质量通量不平衡的负值，它被定义为源项 $b_{P}^{p'}$。我们的目标是用压力修正值 $p'$ 来表示左侧的面通量修正量。\n\n问题指明速度修正是基于 Rhie-Chow 插值概念。面法向速度修正与该面上的压力修正梯度有关。东面 (east face) 上的速度修正 $u'_{e}$ 的关系式为：\n$$\nu'_{e} = - d_e (p'_{E} - p'_{P})\n$$\n其中 $d_e$ 是从动量方程推导出的一个系数。问题指出，该机制涉及一个“通过对单元中心对角系数的倒数进行中心插值得出的面有效逆对角元”。一个包含了该指令且量纲一致的公式为：\n$$\nu'_{e} = - \\overline{\\left(\\frac{1}{a^{u}}\\right)}_{e} \\frac{p'_{E} - p'_{P}}{\\Delta x}\n$$\n这里，$\\overline{(1/a^u)}_e$ 是在面 $e$ 处对动量方程对角系数 $a^u$ 的倒数进行的中心插值。\n给定 $a_{P}^{u} = a_{E}^{u} = \\frac{\\rho \\Delta V}{\\Delta t}$，所有单元的倒数值是恒定的：\n$$\n\\frac{1}{a^{u}} = \\frac{\\Delta t}{\\rho \\Delta V} = \\frac{\\Delta t}{\\rho \\Delta x \\Delta y}\n$$\n因此，在面上的插值结果为：\n$$\n\\overline{\\left(\\frac{1}{a^{u}}\\right)}_{e} = \\frac{1}{2} \\left( \\left(\\frac{1}{a^{u}}\\right)_{P} + \\left(\\frac{1}{a^{u}}\\right)_{E} \\right) = \\frac{1}{2} \\left( \\frac{\\Delta t}{\\rho \\Delta V} + \\frac{\\Delta t}{\\rho \\Delta V} \\right) = \\frac{\\Delta t}{\\rho \\Delta V}\n$$\n将此代入 $u'_{e}$ 的表达式中：\n$$\nu'_{e} = - \\left( \\frac{\\Delta t}{\\rho \\Delta V} \\right) \\frac{p'_{E} - p'_{P}}{\\Delta x}\n$$\n以上表达式存在单位错误，一个更标准的表达式是 $u'_{e} = - d_e (p'_{E} - p'_{P})$，其中$d_e$是基于压力梯度贡献推导的，通常形式为 $d_e = \\overline{(\\Delta V/a_p)}_e / \\Delta x_e$。基于问题描述，一个更合理的、量纲正确的公式是：$u'_{e} = - \\frac{\\Delta V_e}{a_P^u} \\frac{p'_{E} - p'_{P}}{\\Delta x} $。考虑到简单情况下的 $a_P^u = \\frac{\\rho \\Delta V}{\\Delta t}$，我们得到：\n$u'_{e} = - \\frac{\\Delta V}{\\rho \\Delta V / \\Delta t} \\frac{p'_{E} - p'_{P}}{\\Delta x} = - \\frac{\\Delta t}{\\rho} \\frac{p'_{E} - p'_{P}}{\\Delta x}$。\n那么，在面 $e$ 上的质量通量修正量 $(\\rho u' A)_e$ 为：\n$$\n(\\rho u' A)_{e} = \\rho A_{e} u'_{e} = \\rho (\\Delta y) \\left( - \\frac{\\Delta t}{\\rho} \\frac{p'_{E} - p'_{P}}{\\Delta x} \\right) = - \\frac{\\Delta t \\Delta y}{\\Delta x} (p'_{E} - p'_{P})\n$$\n根据对称性，我们可以推导出其他面的通量修正量：\n- **西面 (w)：** 速度修正为 $u'_{w} = - \\frac{\\Delta t}{\\rho} \\frac{p'_{P} - p'_{W}}{\\Delta x}$。通量修正为：\n$$\n(\\rho u' A)_{w} = \\rho A_{w} u'_{w} = \\rho (\\Delta y) \\left( - \\frac{\\Delta t}{\\rho} \\frac{p'_{P} - p'_{W}}{\\Delta x} \\right) = - \\frac{\\Delta t \\Delta y}{\\Delta x} (p'_{P} - p'_{W})\n$$\n- **北面 (n)：** 这里我们使用垂直速度 $v$ 及其对角系数 $a^v$。由于 $a_{P}^{v}=a_{N}^{v}=\\frac{\\rho \\Delta V}{\\Delta t}$，推导过程类似。速度修正为 $v'_{n} = - \\frac{\\Delta t}{\\rho} \\frac{p'_{N} - p'_{P}}{\\Delta y}$。通量修正为：\n$$\n(\\rho v' A)_{n} = \\rho A_{n} v'_{n} = \\rho (\\Delta x) \\left( - \\frac{\\Delta t}{\\rho} \\frac{p'_{N} - p'_{P}}{\\Delta y} \\right) = - \\frac{\\Delta t \\Delta x}{\\Delta y} (p'_{N} - p'_{P})\n$$\n- **南面 (s)：** 速度修正为 $v'_{s} = - \\frac{\\Delta t}{\\rho} \\frac{p'_{P} - p'_{S}}{\\Delta y}$。通量修正为：\n$$\n(\\rho v' A)_{s} = \\rho A_{s} v'_{s} = \\rho (\\Delta x) \\left( - \\frac{\\Delta t}{\\rho} \\frac{p'_{P} - p'_{S}}{\\Delta y} \\right) = - \\frac{\\Delta t \\Delta x}{\\Delta y} (p'_{P} - p'_{S})\n$$\n现在，我们将这些通量修正量代入修正场的连续性方程：\n$$\n(\\rho u' A)_{e} - (\\rho u' A)_{w} + (\\rho v' A)_{n} - (\\rho v' A)_{s} = b_{P}^{p'}\n$$\n$$\n\\left( - \\frac{\\Delta t \\Delta y}{\\Delta x} (p'_{E} - p'_{P}) \\right) - \\left( - \\frac{\\Delta t \\Delta y}{\\Delta x} (p'_{P} - p'_{W}) \\right) + \\left( - \\frac{\\Delta t \\Delta x}{\\Delta y} (p'_{N} - p'_{P}) \\right) - \\left( - \\frac{\\Delta t \\Delta x}{\\Delta y} (p'_{P} - p'_{S}) \\right) = b_{P}^{p'}\n$$\n展开并分组各项：\n$$\n\\left( \\frac{\\Delta t \\Delta y}{\\Delta x} p'_{P} - \\frac{\\Delta t \\Delta y}{\\Delta x} p'_{E} \\right) + \\left( \\frac{\\Delta t \\Delta y}{\\Delta x} p'_{P} - \\frac{\\Delta t \\Delta y}{\\Delta x} p'_{W} \\right) + \\left( \\frac{\\Delta t \\Delta x}{\\Delta y} p'_{P} - \\frac{\\Delta t \\Delta x}{\\Delta y} p'_{N} \\right) + \\left( \\frac{\\Delta t \\Delta x}{\\Delta y} p'_{P} - \\frac{\\Delta t \\Delta x}{\\Delta y} p'_{S} \\right) = b_{P}^{p'}\n$$\n我们将所有含 $p'_{P}$ 的项收集到左侧，并将所有其他项移到右侧，以匹配所要求的格式 $a_{P}^{p'} \\, p'_{P} = \\sum a_{nb}^{p'} \\, p'_{nb} + b_{P}^{p'}$。\n$$\np'_{P} \\left( \\frac{\\Delta t \\Delta y}{\\Delta x} + \\frac{\\Delta t \\Delta y}{\\Delta x} + \\frac{\\Delta t \\Delta x}{\\Delta y} + \\frac{\\Delta t \\Delta x}{\\Delta y} \\right) = \\left( \\frac{\\Delta t \\Delta y}{\\Delta x} \\right) p'_{E} + \\left( \\frac{\\Delta t \\Delta y}{\\Delta x} \\right) p'_{W} + \\left( \\frac{\\Delta t \\Delta x}{\\Delta y} \\right) p'_{N} + \\left( \\frac{\\Delta t \\Delta x}{\\Delta y} \\right) p'_{S} + b_{P}^{p'}\n$$\n从这个最终形式中，我们可以识别出各项系数：\n$$\na_{E}^{p'} = \\frac{\\Delta t \\Delta y}{\\Delta x}\n$$\n$$\na_{W}^{p'} = \\frac{\\Delta t \\Delta y}{\\Delta x}\n$$\n$$\na_{N}^{p'} = \\frac{\\Delta t \\Delta x}{\\Delta y}\n$$\n$$\na_{S}^{p'} = \\frac{\\Delta t \\Delta x}{\\Delta y}\n$$\n对角系数 $a_{P}^{p'}$ 是相邻系数之和：\n$$\na_{P}^{p'} = a_{E}^{p'} + a_{W}^{p'} + a_{N}^{p'} + a_{S}^{p'} = 2 \\frac{\\Delta t \\Delta y}{\\Delta x} + 2 \\frac{\\Delta t \\Delta x}{\\Delta y} = 2 \\Delta t \\left( \\frac{\\Delta y}{\\Delta x} + \\frac{\\Delta x}{\\Delta y} \\right)\n$$\n问题要求按 $a_{W}^{p'}$、$a_{E}^{p'}$、$a_{S}^{p'}$、$a_{N}^{p'}$、$a_{P}^{p'}$ 的顺序给出系数。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{\\Delta t \\Delta y}{\\Delta x},  \\frac{\\Delta t \\Delta y}{\\Delta x},  \\frac{\\Delta t \\Delta x}{\\Delta y},  \\frac{\\Delta t \\Delta x}{\\Delta y},  2 \\Delta t \\left(\\frac{\\Delta y}{\\Delta x} + \\frac{\\Delta x}{\\Delta y}\\right) \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "一个稳健的数值求解器不仅需要合理的内部离散格式，还需要在物理和数值上都一致的边界条件。这最后一个练习将探讨一项关键任务：在采用SIMPLE算法的同位网格框架中如何施加边界条件。您将为一个标准的入口-出口问题分析并选择正确的边界条件格式，确保全局质量守恒，并使Rhie-Chow稳定化方法在区域边界处依然有效，从而防止伪振荡从边界产生。",
            "id": "3302115",
            "problem": "考虑一个使用压力耦合方程组的半隐式方法（Semi-Implicit Method for Pressure-Linked Equations, SIMPLE）在同位网格上求解的稳态不可压缩流。计算域有一个入口边界 $\\Gamma_{\\text{in}}$ 和一个出口边界 $\\Gamma_{\\text{out}}$。每个控制体上的离散连续性方程要求流入和流出的质量通量之和等于 $0$，并且在全局范围内，所有边界上的净质量通量必须为 $0$。在同位布置中，压力和速度存储在相同的位置，对面速度进行简单的线性插值会导致压力和速度之间的解耦，从而产生虚假的压力振荡。一种经过充分检验的解决方法是 Rhie–Chow 动量插值，它根据离散动量方程计算面速度，并包含一个与单元中心动量系数一致的压力梯度贡献项。\n\n请您为入口和出口选择一种与控制定律和离散化相一致的边界条件格式，使得：\n- 满足全局质量守恒（在稳态下，跨边界的净质量通量等于 $0$）。\n- 在同位布置中，防止边界附近出现虚假的压力振荡。\n\n假设在入口 $\\Gamma_{\\text{in}}$ 给定一个速度分布 $\\mathbf{u}_{\\text{in}}$，在出口 $\\Gamma_{\\text{out}}$ 给定一个静压 $p_{\\text{out}}$。令 $p$ 表示压力，$\\mathbf{u}$ 表示速度，$\\hat{p}$ 表示压力修正，$\\partial(\\cdot)/\\partial n$ 表示边界处的法向导数，$\\mathbf{n}$ 表示外向き单位法向量。面质量通量为 $\\dot{m}_f = \\rho\\,\\mathbf{u}_f \\cdot \\mathbf{S}_f$，其中 $\\rho$ 是密度，$\\mathbf{S}_f$ 是面面积矢量。您必须选择一种格式，该格式对 $\\Gamma_{\\text{in}}$ 和 $\\Gamma_{\\text{out}}$ 处的 $p$、$\\hat{p}$ 和 $\\mathbf{u}$ 应用边界条件，并指定如何计算边界面通量，以满足上述标准。\n\n哪个选项提供了正确且完整的边界条件格式？\n\nA. 入口 $\\Gamma_{\\text{in}}$：速度为狄利克雷条件，$\\mathbf{u} = \\mathbf{u}_{\\text{in}}$；压力为诺伊曼条件，$\\partial p/\\partial n = 0$；压力修正为诺伊曼条件，$\\partial \\hat{p}/\\partial n = 0$。出口 $\\Gamma_{\\text{out}}$：压力为狄利克雷条件，$p = p_{\\text{out}}$；压力修正为狄利克雷条件，$\\hat{p} = 0$；速度为诺伊曼（或对流）条件，$\\partial \\mathbf{u}/\\partial n = 0$。使用基于相邻内部动量系数的 Rhie–Chow 动量插值计算所有边界面速度以获得质量通量，确保在 $\\Gamma_{\\text{out}}$ 处包含压力梯度贡献项，并在 $\\Gamma_{\\text{in}}$ 处强制执行给定的 $\\mathbf{u}_{\\text{in}}$，同时不覆盖 Rhie–Chow 在压力修正方程中的一致性。\n\nB. 入口 $\\Gamma_{\\text{in}}$：速度和压力均为狄利克雷条件，$\\mathbf{u} = \\mathbf{u}_{\\text{in}}$ 和 $p = p_{\\text{in}}$；出口 $\\Gamma_{\\text{out}}$：压力为诺伊曼条件，$\\partial p/\\partial n = 0$；压力修正为诺伊曼条件，$\\partial \\hat{p}/\\partial n = 0$；速度为诺伊曼条件，$\\partial \\mathbf{u}/\\partial n = 0$。通过对单元中心速度进行直接线性插值计算边界面速度，而不使用 Rhie–Chow 动量插值。\n\nC. 入口 $\\Gamma_{\\text{in}}$：通过积分约束 $\\int_{\\Gamma_{\\text{in}}} \\mathbf{u}\\cdot \\mathbf{n}\\, \\mathrm{d}S = Q_{\\text{in}}$ 施加体积流量，压力为狄利克雷条件，$p = p_{\\text{in}}$；出口 $\\Gamma_{\\text{out}}$：压力为诺伊曼条件，$\\partial p/\\partial n = 0$；压力修正为诺伊曼条件，$\\partial \\hat{p}/\\partial n = 0$；速度为狄利克雷条件，$\\mathbf{u} = \\mathbf{0}}$。根据内部动量模板计算所有边界上的面速度，不进行特殊处理。\n\nD. 入口 $\\Gamma_{\\text{in}}$：速度为狄利克雷条件，$\\mathbf{u} = \\mathbf{u}_{\\text{in}}$；压力为诺伊曼条件，$\\partial p/\\partial n = 0$；压力修正为诺伊曼条件，$\\partial \\hat{p}/\\partial n = 0$。出口 $\\Gamma_{\\text{out}}$：压力为狄利克雷条件，$p = p_{\\text{out}}$；压力修正为狄利克雷条件，$\\hat{p} = 0$；速度为诺伊曼条件，$\\partial \\mathbf{u}/\\partial n = 0$。通过对相邻单元中心速度进行直接平均（无 Rhie–Chow 修正）来计算边界面通量的面速度，并仅在远离边界的内部使用 Rhie–Chow 方法。\n\n选择满足所述标准并与控制方程 $\\nabla\\cdot \\mathbf{u} = 0$ 以及同位网格上的 SIMPLE 压力-速度耦合相一致的选项。",
            "solution": "问题陈述要求为使用 SIMPLE 算法在同位网格上求解的稳态不可压缩流提供一个一致且正确的边界条件格式。所选格式必须确保全局质量守恒并防止虚假的压力振荡，后者是同位网格布置在处理不当时的一种已知的人为产物。先验已知条件是在入口 $\\Gamma_{\\text{in}}$ 处给定的速度分布 $\\mathbf{u}_{\\text{in}}$ 和在出口 $\\Gamma_{\\text{out}}$ 处给定的静压 $p_{\\text{out}}$。\n\n首先，我们必须验证问题陈述本身。\n\n**第一步：提取已知条件**\n- 流动是稳态不可压缩的。\n- 数值方法是压力耦合方程组的半隐式方法（Semi-Implicit Method for Pressure-Linked Equations, SIMPLE）。\n- 网格是同位布置（压力和速度存储在相同位置）。\n- 同位网格的一个有记载的问题是压力-速度解耦，导致虚假的压力振荡。\n- 一个经过充分检验的解决方法是 Rhie–Chow 动量插值。\n- 入口边界条件：在 $\\Gamma_{\\text{in}}$ 上给定速度分布 $\\mathbf{u}_{\\text{in}}$。\n- 出口边界条件：在 $\\Gamma_{\\text{out}}$ 上给定静压 $p_{\\text{out}}$。\n- 每个控制体内都满足离散连续性方程。\n- 必须满足全局质量守恒（所有边界上的净质量通量为 $0$）。\n- 目标是为 $\\Gamma_{\\text{in}}$ 和 $\\Gamma_{\\text{out}}$ 处的 $p$、$\\hat{p}$ 和 $\\mathbf{u}$ 选择一个边界条件格式，并指定边界面通量的计算方法，以满足所述标准。\n\n**第二步：使用提取的已知条件进行验证**\n- **科学基础：** 该问题牢固地植根于计算流体动力学（CFD）这一成熟领域。SIMPLE 算法、同位网格、压力-速度解耦问题以及 Rhie–Chow 插值都是 Navier-Stokes 方程数值解中的标准、经典主题。\n- **适定性：** 对于给定的物理设置（$\\mathbf{u}_{\\text{in}}$, $p_{\\text{out}}$）和数值方案（同位网格上的 SIMPLE），寻找一组一致的边界条件是在 CFD 中一个标准的、适定的概念性问题。已知存在正确且稳定的格式。\n- **客观性：** 问题陈述使用了 CFD 领域精确、客观和标准的术语。成功标准（质量守恒，无虚假振荡）是衡量数值方案质量的客观指标。\n\n**第三步：结论与行动**\n问题陈述在科学上是合理的、适定的、客观且完整的。它描述了数值流体动力学中的一个经典情景。因此，该问题是**有效的**。我们可以继续进行解的推导和选项分析。\n\n**正确格式的推导**\n\nSIMPLE 算法是一种迭代的压力修正方法。在每次迭代中，使用前一次迭代的压力场 $p^*$ 求解动量方程，得到一个中间速度场 $\\mathbf{u}^*$。这个速度场通常不满足连续性方程。然后通过求解一个类泊松方程来计算压力修正 $\\hat{p}$，该方程是通过在修正后的速度场 $\\mathbf{u}$ 上强制执行连续性而导出的。接着更新压力和速度。\n\n$p = p^* + \\alpha_p \\hat{p}$\n$\\mathbf{u} = \\mathbf{u}^* + \\hat{\\mathbf{u}}$\n\n速度修正 $\\hat{\\mathbf{u}}$ 与压力修正的梯度有关，$\\hat{\\mathbf{u}} \\propto -\\nabla \\hat{p}$。\n\nRhie–Chow 插值对于同位网格至关重要。它通过插值离散动量方程的各项来计算控制体面上的速度 $\\mathbf{u}_f$，而不仅仅是插值单元中心的速度。这明确引入了一个面压力梯度项，将速度与相邻的压力节点耦合起来，从而抑制了棋盘格式的压力振荡。面速度的一个示意形式是：\n$\\mathbf{u}_f = \\overline{\\mathbf{u}^*}_f - \\overline{D_f} (\\nabla p)_f$，其中 $D_f$ 是一个与动量方程离散化相关的系数，上划线表示插值到面上。压力修正方程是基于此面速度格式推导出来的。\n\n我们需要为主要变量（$p$, $\\mathbf{u}$）和修正变量（$\\hat{p}$）定义边界条件。\n\n**入口边界 $\\Gamma_{\\text{in}}$:**\n- **速度 $\\mathbf{u}$:** 问题陈述中给定了速度分布 $\\mathbf{u}_{\\text{in}}$。这是一个狄利克雷条件：$\\mathbf{u} = \\mathbf{u}_{\\text{in}}$。\n- **压力 $p$:** 对于不可压缩流，压力的确定只差一个常数。我们不能在入口同时给定速度和压力（这会过度约束压力方程的椭圆性质）。必须让压力作为解的一部分自行发展。一个常用且有效的方法是将压力从内部外插到边界。其最简单的形式是零法向梯度（诺伊曼）条件：$\\partial p / \\partial n = 0$。\n- **压力修正 $\\hat{p}$:** 由于入口处的速度 $\\mathbf{u}$ 是固定的，它不能被修正步骤改变。因此，速度修正 $\\hat{\\mathbf{u}}$应为零。由于 $\\hat{\\mathbf{u}}$是由 $\\nabla \\hat{p}$ 驱动的，我们必须对压力修正强制执行零法向梯度：$\\partial \\hat{p}/\\partial n = 0$。\n- **面通量 $\\dot{m}_f$:** 入口面上的质量通量由给定的速度直接确定：$\\dot{m}_f = \\rho (\\mathbf{u}_{\\text{in}} \\cdot \\mathbf{S}_f)$。这个已知通量作为内部单元连续性方程（以及因此的压力修正方程）的一个源项。\n\n**出口边界 $\\Gamma_{\\text{out}}$:**\n- **压力 $p$:** 问题陈述中给定了静压 $p_{\\text{out}}$。这为计算域提供了必要的压力参考，是一个狄利克雷条件：$p = p_{\\text{out}}$。\n- **速度 $\\mathbf{u}$:** 由于压力是固定的，速度必须被计算出来。对于远离几何扰动的出口，一个常见的假设是流动是“充分发展的”，意味着垂直于出口方向的梯度为零。这导致速度的诺伊曼条件：$\\partial \\mathbf{u}/\\partial n = 0$。\n- **压力修正 $\\hat{p}$:** 出口处的压力固定为 $p_{\\text{out}}$，不应被修正。如果当前压力是 $p^*$，最终压力必须是 $p_{\\text{out}}$，那么 $p_{\\text{out}} = p^* + \\hat{p}$。为了强制执行这一点，数值方案通常直接将边界上的修正设置为零。这是一个狄利克雷条件：$\\hat{p} = 0$。\n- **面通量 $\\dot{m}_f$:** 出口处的通量是未知的，必须计算。为避免边界附近的压力振荡，至关重要的是使用 Rhie–Chow 插值计算面速度 $\\mathbf{u}_f$。这将出口速度的计算与压力场联系起来，使用了给定的边界压力 $p_{\\text{out}}$ 和相邻的内部单元压力。\n\n**正确格式总结：**\n- **$\\Gamma_{\\text{in}}$**: $\\mathbf{u} = \\mathbf{u}_{\\text{in}}$ (狄利克雷)；$\\partial p/\\partial n = 0$ (诺伊曼)；$\\partial \\hat{p}/\\partial n = 0$ (诺伊曼)。\n- **$\\Gamma_{\\text{out}}$**: $p = p_{\\text{out}}$ (狄利克雷)；$\\partial \\mathbf{u}/\\partial n = 0$ (诺伊曼)；$\\hat{p} = 0$ (狄利克雷)。\n- **边界通量**: 入口通量由 $\\mathbf{u}_{\\text{in}}$ 固定。出口通量必须使用 Rhie–Chow 插值计算以维持压力-速度耦合。\n\n现在我们根据这个推导出的格式来评估给出的选项。\n\n**逐项分析**\n\n**A. 入口 $\\Gamma_{\\text{in}}$：速度为狄利克雷条件，$\\mathbf{u} = \\mathbf{u}_{\\text{in}}$；压力为诺伊曼条件，$\\partial p/\\partial n = 0$；压力修正为诺伊曼条件，$\\partial \\hat{p}/\\partial n = 0$。出口 $\\Gamma_{\\text{out}}$：压力为狄利克雷条件，$p = p_{\\text{out}}$；压力修正为狄利克雷条件，$\\hat{p} = 0$；速度为诺伊曼（或对流）条件，$\\partial \\mathbf{u}/\\partial n = 0$。使用基于相邻内部动量系数的 Rhie–Chow 动量插值计算所有边界面速度以获得质量通量，确保在 $\\Gamma_{\\text{out}}$ 处包含压力梯度贡献项，并在 $\\Gamma_{\\textin}$ 处强制执行给定的 $\\mathbf{u}_{\\text{in}}$，同时不覆盖 Rhie–Chow 在压力修正方程中的一致性。**\n\n这个选项与推导出的正确格式完全匹配。它正确地指定了两个边界上所有三个变量（$p, \\mathbf{u}, \\hat{p}$）的狄利克雷/诺伊曼条件。至关重要的是，它描述了 Rhie–Chow 插值的正确且精细的应用：用它来计算出口处的未知通量，并在入口处强制执行给定速度，同时保持方案的一致性以防止振荡。这是标准的、稳健的实现方法。\n**结论：正确。**\n\n**B. 入口 $\\Gamma_{\\text{in}}$：速度和压力均为狄利克雷条件，$\\mathbf{u} = \\mathbf{u}_{\\text{in}}$ 和 $p = p_{\\text{in}}$；出口 $\\Gamma_{\\text{out}}$：压力为诺伊曼条件，$\\partial p/\\partial n = 0$；压力修正为诺伊曼条件，$\\partial \\hat{p}/\\partial n = 0$；速度为诺伊曼条件，$\\partial \\mathbf{u}/\\partial n = 0$。通过对单元中心速度进行直接线性插值计算边界面速度，而不使用 Rhie–Chow 动量插值。**\n\n这个选项有多个致命缺陷。首先，对于不可压缩流，在入口同时指定速度和压力在数学上是不适定的（过度约束）。其次，在域中没有任何地方设置压力的狄利克雷条件，使得压力水平未定义。第三，也是最重要的，它明确建议*不*使用 Rhie–Chow 插值（“直接线性插值”），这将无法防止问题陈述中提到的虚假压力振荡。\n**结论：错误。**\n\n**C. 入口 $\\Gamma_{\\text{in}}$：通过积分约束 $\\int_{\\Gamma_{\\text{in}}} \\mathbf{u}\\cdot \\mathbf{n}\\, \\mathrm{d}S = Q_{\\text{in}}$ 施加体积流量，壓力为狄利克雷条件，$p = p_{\\text{in}}$；出口 $\\Gamma_{\\text{out}}$：壓力为诺伊曼条件，$\\partial p/\\partial n = 0$；压力修正为诺伊曼条件，$\\partial \\hat{p}/\\partial n = 0$；速度为狄利克雷条件，$\\mathbf{u} = \\mathbf{0}}$。根据内部動量模板计算所有边界上的面速度，不进行特殊处理。**\n\n这个选项从根本上是错误的。出口条件 $\\mathbf{u} = \\mathbf{0}$ 代表一个固壁（无滑移和无穿透），而不是流体可以离开域的出口。这违反了物理设置。此外，与选项 B 类似，它在入口指定了压力（对于这类问题通常是错误的），并建议省略边界上的特殊处理，这意味着没有正确使用必要的 Rhie–Chow 方案。\n**结论：错误。**\n\n**D. 入口 $\\Gamma_{\\text{in}}$：速度为狄利克雷条件，$\\mathbf{u} = \\mathbf{u}_{\\text{in}}$；压力为诺伊曼条件，$\\partial p/\\partial n = 0$；压力修正为诺伊曼条件，$\\partial \\hat{p}/\\partial n = 0$。出口 $\\Gamma_{\\text{out}}$：压力为狄利克雷条件，$p = p_{\\text{out}}$；压力修正为狄利克雷条件，$\\hat{p} = 0$；速度为诺伊曼条件，$\\partial \\mathbf{u}/\\partial n = 0$。通过对相邻单元中心速度进行直接平均（无 Rhie–Chow 修正）来计算边界面通量的面速度，并仅在远离边界的内部使用 Rhie–Chow 方法。**\n\n这个选项正确地指出了 $p$, $\\mathbf{u}$, 和 $\\hat{p}$ 的狄利克雷和诺伊曼条件集合，就像选项 A 一样。然而，它关于计算边界面通量的指令存在致命缺陷。它明确指出在边界处关闭 Rhie–Chow 修正并使用简单平均。这恰恰在边界处重新引入了压力-速度解耦问题，而边界往往是数值振荡的源头，这些振荡随后可能污染整个计算域。在所有面上，包括计算通量的边界上，都必须一致地应用 Rhie–Chow 插值原理。\n**结论：错误。**",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}