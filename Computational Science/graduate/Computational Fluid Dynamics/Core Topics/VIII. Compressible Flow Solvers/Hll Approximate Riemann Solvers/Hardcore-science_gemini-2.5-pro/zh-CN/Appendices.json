{
    "hands_on_practices": [
        {
            "introduction": "理论学习之后，最关键的一步是将其应用于具体计算。本练习将指导您在一个经典的 Sod 激波管问题中，完整地实践一次基于 HLL 近似黎曼解的 Godunov 方法更新。通过这个练习，您将把离散化方程、CFL 条件、波速估计和 HLL 通量公式联系起来，巩固对整个计算流程的理解。",
            "id": "3329729",
            "problem": "考虑一维可压缩欧拉方程的质量、动量和总能量守恒形式，\n$$\n\\frac{\\partial U}{\\partial t} + \\frac{\\partial F(U)}{\\partial x} = 0,\n$$\n其守恒变量和物理通量矢量为\n$$\nU = \\begin{pmatrix} \\rho \\\\ \\rho u \\\\ E \\end{pmatrix}, \\quad F(U) = \\begin{pmatrix} \\rho u \\\\ \\rho u^{2} + p \\\\ u\\,(E + p) \\end{pmatrix},\n$$\n以及理想气体状态方程\n$$\np = (\\gamma - 1)\\left(E - \\frac{1}{2}\\rho u^{2}\\right).\n$$\n此处，$\\rho$ 是密度，$u$ 是速度，$E$ 是总能量，$p$ 是压力，$\\gamma$ 是比热比。在采用分段常数重构的 Godunov 有限体积法中，单元 $i$ 在一个时间步长 $\\Delta t$ 内的更新由守恒通量差决定，\n$$\nU_{i}^{n+1} = U_{i}^{n} - \\frac{\\Delta t}{\\Delta x}\\left(F_{i+1/2} - F_{i-1/2}\\right),\n$$\n其中 $F_{i\\pm 1/2}$ 是通过（近似）求解由左右相邻单元状态构成的黎曼问题得到的界面 $x_{i\\pm 1/2}$ 处的数值通量。\n\n你需要使用 Harten–Lax–van Leer (HLL) 近似黎曼求解器来计算 Sod 激波管界面处的界面通量 $F_{i+1/2}$，并随后更新左侧单元的单元平均值。HLL 求解器通过两个边界信号速度和一个恒定的中间状态来模拟黎曼问题的解。波速应根据从相邻的左右状态推断出的欧拉系统的极值单侧特征速度来估计。\n\n假设网格间距 $\\Delta x = 0.01$（无量纲单位）的均匀网格，并考虑间断点恰好位于 $x_{i+1/2}$ 处，因此左侧单元 $i$ 包含标准 Sod 左状态，右侧单元 $i+1$ 包含标准 Sod 右状态，其参数为\n$$\n\\rho_{L} = 1, \\quad u_{L} = 0, \\quad p_{L} = 1, \\qquad \\rho_{R} = \\frac{1}{8}, \\quad u_{R} = 0, \\quad p_{R} = \\frac{1}{10},\n$$\n且 $\\gamma = \\frac{7}{5}$。使用 Courant–Friedrichs–Lewy (CFL) 数 $\\text{CFL} = 0.5$ 通过以下公式在界面局部设置时间步长\n$$\n\\Delta t = \\frac{\\text{CFL}\\,\\Delta x}{\\max\\left(|u_{L}| + a_{L},\\, |u_{R}| + a_{R}\\right)},\n$$\n其中 $a = \\sqrt{\\gamma p/\\rho}$ 是每个状态下的局部声速。取单元 $i$ 左侧界面上的通量 $F_{i-1/2}$ 为由两个相同的左状态构成的黎曼问题的解（这与 $t^{n}$ 时刻的分段常数重构一致）。\n\n使用双波 HLL 构造计算 HLL 数值通量 $F_{i+1/2}$，并对单元 $i$ 执行一次 Godunov 更新。报告更新后的密度 $\\rho_{i}^{n+1}$（无量纲单位）。你的最终答案必须是单个数字或单个闭式解析表达式。如果提供数值，请给出精确值，或者在无法避免近似时，四舍五入到四位有效数字。",
            "solution": "该问题要求使用 Godunov 型有限体积法计算一个时间步长后单元中更新后的密度。数值通量将使用 Harten–Lax–van Leer (HLL) 近似黎曼求解器针对一维欧拉方程来确定。具体案例是 Sod 激波管问题。\n\n首先，我们根据所提供的数据确定初始状态及其属性。左状态（L，在单元 $i$ 中）和右状态（R，在单元 $i+1$ 中）以原始变量 $(\\rho, u, p)$ 的形式给出。我们使用下标 L 表示单元 $i$ 中的状态，下标 R 表示单元 $i+1$ 中的状态。\n\n给定左状态的数据：\n$\\rho_L = 1$， $u_L = 0$， $p_L = 1$。\n比热比为 $\\gamma = \\frac{7}{5}$。\n\n给定右状态的数据：\n$\\rho_R = \\frac{1}{8}$， $u_R = 0$， $p_R = \\frac{1}{10}$。\n\n基于这些数据，我们可以计算其他热力学和状态矢量量。声速 $a$ 由 $a = \\sqrt{\\gamma p / \\rho}$ 给出。\n对于左状态：\n$$a_L = \\sqrt{\\frac{\\gamma p_L}{\\rho_L}} = \\sqrt{\\frac{(7/5) \\cdot 1}{1}} = \\sqrt{\\frac{7}{5}}$$\n单位体积总能量 $E$ 通过理想气体状态方程与压力 $p$ 相关联：$p = (\\gamma-1)\\left(E - \\frac{1}{2}\\rho u^2\\right)$。\n对于左状态：\n$$p_L = (\\gamma - 1)\\left(E_L - \\frac{1}{2}\\rho_L u_L^2\\right) \\implies 1 = \\left(\\frac{7}{5} - 1\\right)\\left(E_L - \\frac{1}{2}(1)(0)^2\\right) \\implies 1 = \\frac{2}{5} E_L \\implies E_L = \\frac{5}{2}$$\n守恒状态矢量 $U_L$ 和通量矢量 $F_L$ 为：\n$$U_L = \\begin{pmatrix} \\rho_L \\\\ \\rho_L u_L \\\\ E_L \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 0 \\\\ 5/2 \\end{pmatrix}, \\quad F(U_L) = \\begin{pmatrix} \\rho_L u_L \\\\ \\rho_L u_L^2 + p_L \\\\ u_L(E_L + p_L) \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}$$\n\n对于右状态：\n$$a_R = \\sqrt{\\frac{\\gamma p_R}{\\rho_R}} = \\sqrt{\\frac{(7/5) \\cdot (1/10)}{1/8}} = \\sqrt{\\frac{7}{5} \\cdot \\frac{8}{10}} = \\sqrt{\\frac{56}{50}} = \\sqrt{\\frac{28}{25}} = \\frac{2\\sqrt{7}}{5}$$\n$$p_R = (\\gamma - 1)\\left(E_R - \\frac{1}{2}\\rho_R u_R^2\\right) \\implies \\frac{1}{10} = \\left(\\frac{2}{5}\\right)\\left(E_R - \\frac{1}{2}\\left(\\frac{1}{8}\\right)(0)^2\\right) \\implies \\frac{1}{10} = \\frac{2}{5} E_R \\implies E_R = \\frac{5}{20} = \\frac{1}{4}$$\n守恒状态矢量 $U_R$ 和通量矢量 $F_R$ 为：\n$$U_R = \\begin{pmatrix} \\rho_R \\\\ \\rho_R u_R \\\\ E_R \\end{pmatrix} = \\begin{pmatrix} 1/8 \\\\ 0 \\\\ 1/4 \\end{pmatrix}, \\quad F(U_R) = \\begin{pmatrix} \\rho_R u_R \\\\ \\rho_R u_R^2 + p_R \\\\ u_R(E_R + p_R) \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 1/10 \\\\ 0 \\end{pmatrix}$$\n\n接下来，我们确定数值更新的参数。时间步长 $\\Delta t$ 由 CFL 条件设定：\n$$\\Delta t = \\frac{\\text{CFL}\\,\\Delta x}{\\max\\left(|u_{L}| + a_{L},\\, |u_{R}| + a_{R}\\right)}$$\n其中 $\\text{CFL} = 0.5$ 且 $\\Delta x = 0.01$。最大信号速度为：\n$$\\max\\left(|0| + \\sqrt{\\frac{7}{5}},\\, |0| + \\frac{2\\sqrt{7}}{5}\\right) = \\max\\left(\\sqrt{\\frac{7}{5}},\\, \\sqrt{\\frac{28}{25}}\\right) = \\max\\left(\\sqrt{1.4},\\, \\sqrt{1.12}\\right) = \\sqrt{\\frac{7}{5}}$$\n因此，时间步长为：\n$$\\Delta t = \\frac{0.5 \\cdot 0.01}{\\sqrt{7/5}} = \\frac{0.005}{\\sqrt{7/5}}$$\n更新所需的比率 $\\frac{\\Delta t}{\\Delta x}$ 为：\n$$\\frac{\\Delta t}{\\Delta x} = \\frac{0.5}{\\sqrt{7/5}}$$\n\nHLL 求解器需要对黎曼扇的最左侧 ($S_L$) 和最右侧 ($S_R$) 信号速度进行估计。我们使用基于左右状态的极值特征速度 $u \\pm a$ 的估计：\n$$S_L = \\min(u_L - a_L, u_R - a_R) = \\min\\left(0 - \\sqrt{\\frac{7}{5}}, 0 - \\frac{2\\sqrt{7}}{5}\\right) = -\\sqrt{\\frac{7}{5}}$$\n$$S_R = \\max(u_L + a_L, u_R + a_R) = \\max\\left(0 + \\sqrt{\\frac{7}{5}}, 0 + \\frac{2\\sqrt{7}}{5}\\right) = \\sqrt{\\frac{7}{5}}$$\n由于 $S_L  0$ 且 $S_R > 0$，HLL 通量 $F_{i+1/2}$ 由下式给出：\n$$F_{i+1/2}^{\\text{HLL}} = \\frac{S_R F_L - S_L F_R + S_L S_R (U_R - U_L)}{S_R - S_L}$$\n我们来计算各项：\n$$S_R - S_L = \\sqrt{\\frac{7}{5}} - \\left(-\\sqrt{\\frac{7}{5}}\\right) = 2\\sqrt{\\frac{7}{5}}$$\n$$S_L S_R = -\\left(\\sqrt{\\frac{7}{5}}\\right)^2 = -\\frac{7}{5}$$\n$$U_R - U_L = \\begin{pmatrix} 1/8 \\\\ 0 \\\\ 1/4 \\end{pmatrix} - \\begin{pmatrix} 1 \\\\ 0 \\\\ 5/2 \\end{pmatrix} = \\begin{pmatrix} -7/8 \\\\ 0 \\\\ -9/4 \\end{pmatrix}$$\n$$S_L S_R (U_R - U_L) = -\\frac{7}{5} \\begin{pmatrix} -7/8 \\\\ 0 \\\\ -9/4 \\end{pmatrix} = \\begin{pmatrix} 49/40 \\\\ 0 \\\\ 63/20 \\end{pmatrix}$$\n$$S_R F_L - S_L F_R = \\sqrt{\\frac{7}{5}}\\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix} - \\left(-\\sqrt{\\frac{7}{5}}\\right)\\begin{pmatrix} 0 \\\\ 1/10 \\\\ 0 \\end{pmatrix} = \\sqrt{\\frac{7}{5}}\\begin{pmatrix} 0 \\\\ 1 + 1/10 \\\\ 0 \\end{pmatrix} = \\sqrt{\\frac{7}{5}}\\begin{pmatrix} 0 \\\\ 11/10 \\\\ 0 \\end{pmatrix}$$\nHLL 通量表达式的分子是最后两个结果的和：\n$$\\text{Numerator} = \\begin{pmatrix} 0 \\\\ \\frac{11}{10}\\sqrt{\\frac{7}{5}} \\\\ 0 \\end{pmatrix} + \\begin{pmatrix} \\frac{49}{40} \\\\ 0 \\\\ \\frac{63}{20} \\end{pmatrix} = \\begin{pmatrix} \\frac{49}{40} \\\\ \\frac{11}{10}\\sqrt{\\frac{7}{5}} \\\\ \\frac{63}{20} \\end{pmatrix}$$\n除以分母 $S_R - S_L$：\n$$F_{i+1/2}^{\\text{HLL}} = \\frac{1}{2\\sqrt{7/5}} \\begin{pmatrix} \\frac{49}{40} \\\\ \\frac{11}{10}\\sqrt{\\frac{7}{5}} \\\\ \\frac{63}{20} \\end{pmatrix} = \\begin{pmatrix} \\frac{49}{80\\sqrt{7/5}} \\\\ \\frac{11}{20} \\\\ \\frac{63}{40\\sqrt{7/5}} \\end{pmatrix}$$\n单元 $i$ 的有限体积更新为：\n$$U_i^{n+1} = U_i^n - \\frac{\\Delta t}{\\Delta x} \\left( F_{i+1/2} - F_{i-1/2} \\right)$$\n在时间 $n$，$i$ 单元的状态为 $U_i^n = U_L$。单元左侧界面处的通量 $F_{i-1/2}$ 来自黎曼问题 $(U_L, U_L)$。对于这个平凡的黎曼问题，通量就是 $F(U_L) = F_L$。\n因此，$F_{i-1/2} = F_L = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}$。\n\n我们关心的是更新后的密度 $\\rho_i^{n+1}$，它是 $U_i^{n+1}$ 的第一个分量。\n$$\\rho_i^{n+1} = (U_i^{n+1})_1 = (U_L)_1 - \\frac{\\Delta t}{\\Delta x} \\left( (F_{i+1/2}^{\\text{HLL}})_1 - (F_L)_1 \\right)$$\n代入数值：\n$$(U_L)_1 = \\rho_L = 1$$\n$$\\frac{\\Delta t}{\\Delta x} = \\frac{0.5}{\\sqrt{7/5}}$$\n$$(F_{i+1/2}^{\\text{HLL}})_1 = \\frac{49}{80\\sqrt{7/5}}$$\n$$(F_L)_1 = 0$$\n因此密度的更新方程为：\n$$\\rho_i^{n+1} = 1 - \\frac{0.5}{\\sqrt{7/5}} \\left( \\frac{49}{80\\sqrt{7/5}} - 0 \\right)$$\n$$\\rho_i^{n+1} = 1 - \\frac{0.5 \\cdot 49}{80 (\\sqrt{7/5})^2} = 1 - \\frac{1/2 \\cdot 49}{80 \\cdot (7/5)}$$\n$$\\rho_i^{n+1} = 1 - \\frac{49/2}{112} = 1 - \\frac{49}{224}$$\n分子和分母都可以被 49 整除（$224 = 4 \\times 56 = 4 \\times 7 \\times 8 = 49 \\times (4 \\times 8 / 7)$，不，$224/49$ 不是整数）。\n我们重新计算分母中的乘积：$80 \\cdot (7/5) = (80/5) \\cdot 7 = 16 \\cdot 7 = 112$。\n所以，$\\rho_i^{n+1} = 1 - \\frac{49/2}{112} = 1 - \\frac{49}{224}$。\n我们用与上面不同的方式来简化：\n$$\\rho_i^{n+1} = 1 - \\frac{1/2 \\cdot 49}{16 \\cdot 7} = 1 - \\frac{1/2 \\cdot 7}{16} = 1 - \\frac{7}{32}$$\n$$\\rho_i^{n+1} = \\frac{32}{32} - \\frac{7}{32} = \\frac{25}{32}$$\n单元 $i$ 中更新后的密度恰好是 $\\frac{25}{32}$。\n\n换算成小数，结果是 $0.78125$。",
            "answer": "$$\\boxed{\\frac{25}{32}}$$"
        },
        {
            "introduction": "HLL 通量公式根据波速 $S_L$ 和 $S_R$ 的符号分为不同情况，每种情况都对应着特定的物理场景。本练习旨在让您深入理解这些不同情况，特别是当整个波系结构向一个方向移动时的超音速流动情形。通过分析一个超音速入流问题，您将学会如何判断流动状态并选择正确的通量计算方式，体会 HLL 格式的迎风特性。",
            "id": "3329752",
            "problem": "考虑守恒形式的理想气体一维欧拉方程，其状态向量为 $U = (\\rho, \\rho u, E)^{\\mathsf{T}}$，通量为 $F(U) = (\\rho u, \\rho u^{2} + p, u(E + p))^{\\mathsf{T}}$，其中 $E = \\dfrac{p}{\\gamma - 1} + \\dfrac{1}{2} \\rho u^{2}$。在界面 $x = 0$ 处设置一个黎曼问题，其左侧原始状态为 $(\\rho_{L}, u_{L}, p_{L})$，右侧原始状态为 $(\\rho_{R}, u_{R}, p_{R})$。比热比为 $\\gamma = 1.4$。左、右状态分别为\n- $(\\rho_{L}, u_{L}, p_{L}) = (1.0, 500, 1.0 \\times 10^{5})$，\n- $(\\rho_{R}, u_{R}, p_{R}) = (0.9, 450, 0.8 \\times 10^{5})$，\n其中 $\\rho$ 的单位是 $\\mathrm{kg}\\,\\mathrm{m}^{-3}$，$u$ 的单位是 $\\mathrm{m}\\,\\mathrm{s}^{-1}$，$p$ 的单位是 $\\mathrm{Pa}$。每个状态下的理想气体声速为 $a = \\sqrt{\\gamma p / \\rho}$。\n\n基于每个状态中最快的左行和右行声波，为信号速度采用具有物理动机的界限：\n$$\nS_{L} = \\min\\!\\big(u_{L} - a_{L},\\, u_{R} - a_{R}\\big), \\qquad\nS_{R} = \\max\\!\\big(u_{L} + a_{L},\\, u_{R} + a_{R}\\big).\n$$\n\n使用 Harten–Lax–van Leer (HLL) 近似黎曼求解器，从一个由波 $x = S_{L} t$ 和 $x = S_{R} t$ 界定的时空控制体上的积分守恒形式出发，并假设这些波之间存在一个单一的常数中间状态。推导界面数值通量 $F_{\\mathrm{HLL}}$ 在由 $S_{L}$ 和 $S_{R}$ 符号划分的三个区域中的表达式。然后，对于给定的数据，判断 $S_{L} \\ge 0$ 或 $S_{R} \\le 0$ 是否成立，确定生效区域，并计算界面处的 x 方向动量通量分量 $\\big(F_{\\mathrm{HLL}}\\big)_{2}$。根据您的符号评估，简要讨论其对界面处超音速流入或流出的影响。\n\n将 $\\big(F_{\\mathrm{HLL}}\\big)_{2}$ 的最终数值四舍五入到四位有效数字。以帕斯卡为单位表示最终答案。",
            "solution": "首先验证问题，以确保其科学上合理、良定且完整。\n\n### 步骤 1: 提取已知条件\n- **控制方程**：一维欧拉方程守恒形式。\n- **状态向量**：$U = (\\rho, \\rho u, E)^{\\mathsf{T}}$\n- **通量向量**：$F(U) = (\\rho u, \\rho u^{2} + p, u(E + p))^{\\mathsf{T}}$\n- **状态方程**：$E = \\dfrac{p}{\\gamma - 1} + \\dfrac{1}{2} \\rho u^{2}$\n- **比热比**：$\\gamma = 1.4$\n- **左侧原始状态**：$(\\rho_{L}, u_{L}, p_{L}) = (1.0 \\,\\, \\mathrm{kg}\\,\\mathrm{m}^{-3}, 500 \\,\\, \\mathrm{m}\\,\\mathrm{s}^{-1}, 1.0 \\times 10^{5} \\,\\, \\mathrm{Pa})$\n- **右侧原始状态**：$(\\rho_{R}, u_{R}, p_{R}) = (0.9 \\,\\, \\mathrm{kg}\\,\\mathrm{m}^{-3}, 450 \\,\\, \\mathrm{m}\\,\\mathrm{s}^{-1}, 0.8 \\times 10^{5} \\,\\, \\mathrm{Pa})$\n- **声速公式**：$a = \\sqrt{\\gamma p / \\rho}$\n- **信号速度**：\n  $S_{L} = \\min\\!\\big(u_{L} - a_{L},\\, u_{R} - a_{R}\\big)$\n  $S_{R} = \\max\\!\\big(u_{L} + a_{L},\\, u_{R} + a_{R}\\big)$\n- **任务**：推导 HLL 数值通量 $F_{\\mathrm{HLL}}$，为给定数据确定生效区域，计算 x 方向动量通量分量 $\\big(F_{\\mathrm{HLL}}\\big)_{2}$，并讨论物理含义。\n\n### 步骤 2: 使用提取的已知条件进行验证\n- **科学基础**：问题涉及理想气体的欧拉方程和 Harten–Lax–van Leer (HLL) 近似黎曼求解器，这些都是计算流体动力学中的标准和基本概念。物理量以一致的国际单位制给出，并代表了一个合理的高速气体流动场景。信号速度的选择对于 HLL 求解器是常见且有效的。问题具有科学依据。\n- **良定性**：所有必要的数据（$\\rho_{L}, u_{L}, p_{L}, \\rho_{R}, u_{R}, p_{R}, \\gamma$）和定义（对于 $a$、$S_L$、$S_R$）都已提供，以唯一确定数值通量并回答问题。问题是良定的。\n- **客观性**：问题以精确、技术性的语言陈述，没有歧义或主观论断。\n\n### 步骤 3: 结论与行动\n问题被判定为**有效**。将提供完整解答。\n\n### HLL 数值通量的推导\nHLL 近似黎曼求解器用一个双波模型来近似黎曼问题的解。它假设解由三个常数状态（$U_L$、$U_{HLL}$、$U_R$）组成，这三个状态被两个以速度 $S_L$ 和 $S_R$ 传播的波分开。界面 $x=0$ 处的状态由下式给出\n$$\nU(x, t) =\n\\begin{cases}\nU_L  \\text{若 } x/t  S_L \\\\\nU_{HLL}  \\text{若 } S_L \\le x/t \\le S_R \\\\\nU_R  \\text{若 } x/t > S_R\n\\end{cases}\n$$\n将守恒律的积分形式 $\\oint (U dx - F dt) = 0$ 应用于 $x-t$ 平面上的一个控制体。通过在左行波（$S_L$）和右行波（$S_R$）上应用 Rankine-Hugoniot 条件，我们得到关于中间状态 $U_{HLL}$ 及其对应通量 $F_{HLL}$ 的两个关系式：\n1. 穿过速度为 $S_L$ 的波：$S_L (U_{HLL} - U_L) = F_{HLL} - F_L$\n2. 穿过速度为 $S_R$ 的波：$S_R (U_{HLL} - U_R) = F_{HLL} - F_R$\n\n此处，$F_L = F(U_L)$ 且 $F_R = F(U_R)$。这两个向量方程可以求解出两个向量未知数，$U_{HLL}$ 和 $F_{HLL}$。首先，我们通过在两个方程中分离出 $U_{HLL}$ 并令 $F_{HLL}$ 的表达式相等来求解 $U_{HLL}$：\n$F_L + S_L(U_{HLL} - U_L) = F_R + S_R(U_{HLL} - U_R)$\n$S_L U_{HLL} - S_R U_{HLL} = F_L - S_L U_L - F_R + S_R U_R$\n$U_{HLL}(S_L - S_R) = (F_L - F_R) - (S_L U_L - S_R U_R)$\n$$\nU_{HLL} = \\frac{S_R U_R - S_L U_L - (F_R - F_L)}{S_R - S_L}\n$$\n将 $U_{HLL}$ 的这个表达式代回第一个 Rankine-Hugoniot 方程，得到通量 $F_{HLL}$：\n$F_{HLL} = F_L + S_L (U_{HLL} - U_L) = F_L + S_L \\left(\\frac{S_R U_R - S_L U_L - F_R + F_L}{S_R - S_L} - U_L\\right)$\n$F_{HLL} = \\frac{F_L(S_R - S_L) + S_L(S_R U_R - S_L U_L - F_R + F_L) - S_L U_L(S_R - S_L)}{S_R - S_L}$\n$F_{HLL} = \\frac{S_R F_L - S_L F_L + S_L S_R U_R - S_L^2 U_L - S_L F_R + S_L F_L - S_L S_R U_L + S_L^2 U_L}{S_R - S_L}$\n$F_{HLL} = \\frac{S_R F_L - S_L F_R + S_L S_R (U_R - U_L)}{S_R - S_L}$\n\n界面 $x=0$ 处的数值通量，记为 $F_{\\mathrm{HLL}}$，是该位置状态对应的通量。该状态取决于 $S_L$ 和 $S_R$ 的符号：\n- 如果 $S_L \\ge 0$，整个波系向右移动。$x=0$ 处的状态是未受扰动的左侧状态 $U_L$。因此通量为 $F_{\\mathrm{HLL}} = F_L$。\n- 如果 $S_R \\le 0$，整个波系向左移动。$x=0$ 处的状态是未受扰动的右侧状态 $U_R$。因此通量为 $F_{\\mathrm{HLL}} = F_R$。\n- 如果 $S_L  0  S_R$，界面位于波扇内部。$x=0$ 处的通量是与中间区域相关的常数通量 $F_{HLL}$。\n\nHLL 数值通量的完整表达式为：\n$$\nF_{\\mathrm{HLL}} =\n\\begin{cases}\nF_L  \\text{若 } S_L \\ge 0 \\\\\n\\dfrac{S_R F_L - S_L F_R + S_L S_R (U_R - U_L)}{S_R - S_L}  \\text{若 } S_L  0 \\text{ 且 } S_R > 0 \\\\\nF_R  \\text{若 } S_R \\le 0\n\\end{cases}\n$$\n\n### 针对给定数据的计算\n首先，我们使用 $a = \\sqrt{\\gamma p / \\rho}$ 计算左、右状态的声速。\n$$\na_L = \\sqrt{\\frac{\\gamma p_L}{\\rho_L}} = \\sqrt{\\frac{1.4 \\times (1.0 \\times 10^5)}{1.0}} = \\sqrt{140000} \\approx 374.166 \\,\\, \\mathrm{m}\\,\\mathrm{s}^{-1}\n$$\n$$\na_R = \\sqrt{\\frac{\\gamma p_R}{\\rho_R}} = \\sqrt{\\frac{1.4 \\times (0.8 \\times 10^5)}{0.9}} = \\sqrt{\\frac{112000}{0.9}} \\approx 352.767 \\,\\, \\mathrm{m}\\,\\mathrm{s}^{-1}\n$$\n接下来，我们计算信号速度 $S_L$ 和 $S_R$。\n对于 $S_L$：\n$u_L - a_L = 500 - 374.166 = 125.834 \\,\\, \\mathrm{m}\\,\\mathrm{s}^{-1}$\n$u_R - a_R = 450 - 352.767 = 97.233 \\,\\, \\mathrm{m}\\,\\mathrm{s}^{-1}$\n$$\nS_L = \\min(125.834, 97.233) = 97.233 \\,\\, \\mathrm{m}\\,\\mathrm{s}^{-1}\n$$\n对于 $S_R$：\n$u_L + a_L = 500 + 374.166 = 874.166 \\,\\, \\mathrm{m}\\,\\mathrm{s}^{-1}$\n$u_R + a_R = 450 + 352.767 = 802.767 \\,\\, \\mathrm{m}\\,\\mathrm{s}^{-1}$\n$$\nS_R = \\max(874.166, 802.767) = 874.166 \\,\\, \\mathrm{m}\\,\\mathrm{s}^{-1}\n$$\n\n### 生效区域的确定\n我们发现 $S_L \\approx 97.233 > 0$。这对应于我们推导的 HLL 通量表达式中的第一种情况。\n因此，生效区域是 $S_L \\ge 0$，界面处的数值通量就是左侧状态的通量：\n$$\nF_{\\mathrm{HLL}} = F_L = F(U_L)\n$$\n\n### 动量通量的计算\n问题要求计算 x 方向动量通量分量，即通量向量的第二个分量 $\\big(F\\big)_{2} = \\rho u^2 + p$。我们需要为左侧状态计算这个值。\n$$\n\\big(F_{\\mathrm{HLL}}\\big)_{2} = \\big(F_L\\big)_{2} = \\rho_L u_L^2 + p_L\n$$\n代入给定值：\n$$\n\\big(F_{\\mathrm{HLL}}\\big)_{2} = (1.0 \\,\\, \\mathrm{kg}\\,\\mathrm{m}^{-3})(500 \\,\\, \\mathrm{m}\\,\\mathrm{s}^{-1})^2 + (1.0 \\times 10^5 \\,\\, \\mathrm{Pa})\n$$\n$$\n\\big(F_{\\mathrm{HLL}}\\big)_{2} = 1.0 \\times 250000 + 100000 = 250000 + 100000 = 350000 \\,\\, \\mathrm{Pa}\n$$\n$\\rho u^2$ 的单位是 $(\\mathrm{kg}/\\mathrm{m}^3)(\\mathrm{m}/\\mathrm{s})^2 = (\\mathrm{kg} \\cdot \\mathrm{m}/\\mathrm{s}^2)/\\mathrm{m}^2 = \\mathrm{N}/\\mathrm{m}^2 = \\mathrm{Pa}$，是一致的。\n四舍五入到四位有效数字，结果是 $3.500 \\times 10^5 \\,\\, \\mathrm{Pa}$。\n\n### 物理含义的讨论\n条件 $S_L > 0$ 意味着系统中可能的最慢信号，即相对于流体运动的左行声波，仍然在正 x 方向上移动。左、右两个状态的物理流速均大于它们各自的局部声速：\n- 左状态马赫数：$M_L = u_L/a_L = 500/374.166 \\approx 1.336 > 1$\n- 右状态马赫数：$M_R = u_R/a_R = 450/352.767 \\approx 1.276 > 1$\n两种流动都是超音速的。所有信号，包括最慢的信号（$S_L$），都从左向右传播，这一事实意味着存在来自左侧的**超音速流入**。界面 $x=0$ 处的信息完全由上游（左侧）状态决定。下游（右侧）状态对界面处的流动条件没有因果影响。这一物理推理证明了为什么 HLL 数值通量能正确地简化为左侧状态的物理通量 $F_L$。",
            "answer": "$$\n\\boxed{3.500 \\times 10^{5}}\n$$"
        },
        {
            "introduction": "任何近似方法都有其局限性，理解这些局限是推动算法发展的关键。本练习将揭示 HLL 格式的一个核心缺陷：它无法精确捕捉接触间断，并会产生显著的数值耗散。通过对比 HLL 和 HLLC (Harten-Lax-van Leer-Contact) 两种解法器在处理纯接触间断问题时的不同表现，您将直观地看到数值弥散现象，并理解为何需要 HLLC 这样更精细的格式来提升解的精度。",
            "id": "3329792",
            "problem": "考虑一维理想气体欧拉方程的守恒形式：\n$$\n\\frac{\\partial \\boldsymbol{U}}{\\partial t} + \\frac{\\partial \\boldsymbol{F}(\\boldsymbol{U})}{\\partial x} = 0,\n$$\n其守恒变量为\n$$\n\\boldsymbol{U} = \\begin{pmatrix} \\rho \\\\ \\rho u \\\\ E \\end{pmatrix},\n$$\n通量为\n$$\n\\boldsymbol{F}(\\boldsymbol{U}) = \\begin{pmatrix} \\rho u \\\\ \\rho u^{2} + p \\\\ u\\,(E + p) \\end{pmatrix}.\n$$\n假设理想气体状态方程的比热比为 $\\,\\gamma = 1.4\\,$，因此\n$$\nE = \\frac{p}{\\gamma - 1} + \\frac{1}{2}\\,\\rho u^{2}.\n$$\n考虑一个具有左右两种状态的黎曼问题：\n$$\n(\\rho_{L}, u_{L}, p_{L}) = (1,\\,1,\\,1), \\qquad (\\rho_{R}, u_{R}, p_{R}) = (0.125,\\,1,\\,1).\n$$\n因此，初始间断是一个纯接触间断：压力和速度相等，密度不同。\n\n使用 Harten–Lax–van Leer (HLL) 近似黎曼求解器，并根据两侧局部声速计算 Davis 型波速界，确定界面处的恒定中间状态，并展示接触间断的抹平现象。然后，使用 Harten–Lax–van Leer–Contact (HLLC) 近似黎曼求解器，并根据 Rankine–Hugoniot 条件确定接触波速，确定保持接触间断的界面状态。最后，以单个无量纲数的形式报告 HLL 预测的界面中间密度与 HLLC 预测的界面密度之比。将您的答案四舍五入至四位有效数字。",
            "solution": "用户提供了一个计算流体力学领域的问题，具体涉及比较 HLL 和 HLLC 近似黎曼求解器对于纯接触间断的处理。\n\n### 步骤 1：问题验证\n\n第一步是验证问题陈述。\n\n#### 提取的已知条件\n- **控制方程**：一维欧拉方程，$\\frac{\\partial \\boldsymbol{U}}{\\partial t} + \\frac{\\partial \\boldsymbol{F}(\\boldsymbol{U})}{\\partial x} = 0$。\n- **状态向量**：$\\boldsymbol{U} = (\\rho, \\rho u, E)^T$。\n- **通量向量**：$\\boldsymbol{F}(\\boldsymbol{U}) = (\\rho u, \\rho u^2 + p, u(E+p))^T$。\n- **状态方程 (EOS)**：理想气体，$E = \\frac{p}{\\gamma - 1} + \\frac{1}{2}\\rho u^2$。\n- **比热比**：$\\gamma = 1.4$。\n- **左状态**：$(\\rho_L, u_L, p_L) = (1, 1, 1)$。\n- **右状态**：$(\\rho_R, u_R, p_R) = (0.125, 1, 1)$。\n- **求解器 1**：Harten–Lax–van Leer (HLL)，采用 Davis 型波速界。\n- **求解器 2**：Harten–Lax–van Leer–Contact (HLLC)。\n- **任务**：计算 HLL 预测的中间密度与 HLLC 预测的界面密度之比，结果保留四位有效数字。\n\n#### 验证\n1.  **科学依据**：该问题建立在成熟的气体动力学欧拉方程之上，并使用了两种标准且广为人知的近似黎曼求解器（HLL 和 HLLC）。初始条件代表纯接触间断，这是一个经典的测试案例。该问题在科学上是合理的。\n2.  **适定性**：所有必要的数据（$\\rho_L, u_L, p_L, \\rho_R, u_R, p_R, \\gamma$）均已提供。计算波速和中间状态的方法已明确定义。问题要求一个具体、可计算的比率。该问题是适定的。\n3.  **客观性**：语言正式，没有主观或模糊的术语。\n4.  **一致性**：提供的左右状态 $u_L = u_R = 1$ 和 $p_L = p_R = 1$ 与纯接触间断的描述完全一致。\n5.  **无其他缺陷**：该问题是 CFD 领域一个标准的、不平凡的练习，旨在检验对不同数值格式如何处理特定物理现象（接触波）的理解。\n\n#### 结论\n问题有效。我们可以继续进行求解。\n\n### 步骤 2：求解\n\n首先，我们计算左（$L$）状态和右（$R$）状态所需的热力学和状态变量。\n\n声速 $a$ 由 $a = \\sqrt{\\gamma p / \\rho}$ 给出。\n对于左状态：\n$a_L = \\sqrt{\\frac{\\gamma p_L}{\\rho_L}} = \\sqrt{\\frac{1.4 \\times 1}{1}} = \\sqrt{1.4}$。\n\n对于右状态：\n$a_R = \\sqrt{\\frac{\\gamma p_R}{\\rho_R}} = \\sqrt{\\frac{1.4 \\times 1}{0.125}} = \\sqrt{1.4 \\times 8} = \\sqrt{11.2}$。\n\n接下来，我们计算守恒状态向量 $\\boldsymbol{U}_L$ 和 $\\boldsymbol{U}_R$，以及相应的通量向量 $\\boldsymbol{F}_L$ 和 $\\boldsymbol{F}_R$。\n对于左状态 $(\\rho_L, u_L, p_L) = (1, 1, 1)$：\n$E_L = \\frac{p_L}{\\gamma - 1} + \\frac{1}{2}\\rho_L u_L^2 = \\frac{1}{1.4 - 1} + \\frac{1}{2}(1)(1)^2 = \\frac{1}{0.4} + 0.5 = 2.5 + 0.5 = 3$。\n$\\boldsymbol{U}_L = \\begin{pmatrix} 1 \\\\ 1 \\\\ 3 \\end{pmatrix}$。\n$\\boldsymbol{F}_L = \\begin{pmatrix} \\rho_L u_L \\\\ \\rho_L u_L^2 + p_L \\\\ u_L(E_L + p_L) \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 1(1)^2 + 1 \\\\ 1(3+1) \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 2 \\\\ 4 \\end{pmatrix}$。\n\n对于右状态 $(\\rho_R, u_R, p_R) = (0.125, 1, 1)$：\n$E_R = \\frac{p_R}{\\gamma - 1} + \\frac{1}{2}\\rho_R u_R^2 = \\frac{1}{1.4 - 1} + \\frac{1}{2}(0.125)(1)^2 = 2.5 + 0.0625 = 2.5625$。\n$\\boldsymbol{U}_R = \\begin{pmatrix} 0.125 \\\\ 0.125 \\\\ 2.5625 \\end{pmatrix}$。\n$\\boldsymbol{F}_R = \\begin{pmatrix} \\rho_R u_R \\\\ \\rho_R u_R^2 + p_R \\\\ u_R(E_R + p_R) \\end{pmatrix} = \\begin{pmatrix} 0.125 \\\\ 0.125(1)^2 + 1 \\\\ 1(2.5625+1) \\end{pmatrix} = \\begin{pmatrix} 0.125 \\\\ 1.125 \\\\ 3.5625 \\end{pmatrix}$。\n\n#### HLL 求解器分析\n\nHLL 求解器用两个速度为 $S_L$ 和 $S_R$ 的波来近似黎曼扇，这两个波之间包含一个单一的恒定中间状态 $\\boldsymbol{U}_{HLL}$。我们使用 Davis 型波速估计：\n$S_L = \\min(u_L - a_L, u_R - a_R) = \\min(1 - \\sqrt{1.4}, 1 - \\sqrt{11.2}) = 1 - \\sqrt{11.2}$。\n$S_R = \\max(u_L + a_L, u_R + a_R) = \\max(1 + \\sqrt{1.4}, 1 + \\sqrt{11.2}) = 1 + \\sqrt{11.2}$。\n\n由于 $1  \\sqrt{1.4}  \\sqrt{11.2}$，我们有 $S_L  0$ 和 $S_R > 0$。位于 $x/t = 0$ 的界面在黎曼扇内部，即 $S_L  0  S_R$。此区域的状态是恒定状态 $\\boldsymbol{U}_{HLL}$，由下式给出：\n$$ \\boldsymbol{U}_{HLL} = \\frac{S_R \\boldsymbol{U}_R - S_L \\boldsymbol{U}_L - (\\boldsymbol{F}_R - \\boldsymbol{F}_L)}{S_R - S_L} $$\n我们感兴趣的是该状态的密度分量 $\\rho_{HLL}$：\n$$ \\rho_{HLL} = \\frac{S_R \\rho_R - S_L \\rho_L - ((\\rho u)_R - (\\rho u)_L)}{S_R - S_L} $$\n让我们代入已知值：\n分母是 $S_R - S_L = (1 + \\sqrt{11.2}) - (1 - \\sqrt{11.2}) = 2\\sqrt{11.2}$。\n分子是：\n$N = (1 + \\sqrt{11.2})(0.125) - (1 - \\sqrt{11.2})(1) - (0.125 - 1)$\n$N = 0.125 + 0.125\\sqrt{11.2} - 1 + \\sqrt{11.2} - (-0.875)$\n$N = 0.125 - 1 + 0.875 + (0.125 + 1)\\sqrt{11.2}$\n$N = 0 + 1.125\\sqrt{11.2}$\n因此，中间密度为：\n$$ \\rho_{HLL} = \\frac{1.125\\sqrt{11.2}}{2\\sqrt{11.2}} = \\frac{1.125}{2} = 0.5625 $$\n这个值是左右密度的平均值，展示了 HLL 格式固有的数值扩散或对接触间断的“抹平”效应。\n\n#### HLLC 求解器分析\n\nHLLC 求解器为接触间断增加了一个速度为 $S_*$ 的中间波。波结构为 $S_L$, $S_*$, $S_R$。初始条件是纯接触间断，其中 $u_L=u_R=u$ 且 $p_L=p_R=p$。精确解包含一个以速度 $S_* = u = 1$ 移动的单一接触波。HLLC 求解器旨在精确解析此情况。接触波速 $S_*$ 的通用公式为：\n$$ S_* = \\frac{p_R - p_L + \\rho_L u_L(S_L - u_L) - \\rho_R u_R(S_R - u_R)}{\\rho_L(S_L - u_L) - \\rho_R(S_R - u_R)} $$\n对于我们的问题，$p_L=p_R=1$ 且 $u_L=u_R=1$。公式简化为：\n$S_* = \\frac{0 + \\rho_L(1)(S_L - 1) - \\rho_R(1)(S_R - 1)}{\\rho_L(S_L - 1) - \\rho_R(S_R - 1)}$。\n使用 $S_L-1 = -\\sqrt{11.2}$ 和 $S_R-1 = \\sqrt{11.2}$：\n$S_* = \\frac{\\rho_L(-\\sqrt{11.2}) - \\rho_R(\\sqrt{11.2})}{\\rho_L(-\\sqrt{11.2}) - \\rho_R(\\sqrt{11.2})} = 1$。\n这证实了 HLLC 的接触波速为 $S_*=1$，与精确解相符。\n\nHLLC 解包含两个中间星区状态，$\\boldsymbol{U}_{*L}$（对于 $S_L  x/t  S_*$）和 $\\boldsymbol{U}_{*R}$（对于 $S_*  x/t  S_R$）。我们有 $S_L = 1 - \\sqrt{11.2} \\approx -2.345  0$ 和 $S_* = 1 > 0$。位于 $x/t=0$ 的界面处于左星区，即 $S_L  0  S_*$。因此，界面处的状态是 $\\boldsymbol{U}_{*L}$。该区域的密度 $\\rho_{*L}$ 由下式给出：\n$$ \\rho_{*L} = \\rho_L \\frac{S_L - u_L}{S_L - S_*} $$\n代入数值：\n$\\rho_L = 1$, $u_L = 1$, $S_L = 1 - \\sqrt{11.2}$, and $S_* = 1$：\n$$ \\rho_{*L} = (1) \\frac{(1 - \\sqrt{11.2}) - 1}{(1 - \\sqrt{11.2}) - 1} = \\frac{-\\sqrt{11.2}}{-\\sqrt{11.2}} = 1 $$\nHLLC 预测的界面 $x/t=0$ 处的密度是 $\\rho_{HLLC} = \\rho_{*L} = 1$。HLLC 正确地恢复了移动接触波左侧的状态，即原始的左状态，其密度为 $\\rho_L=1$。\n\n#### 最终比率\n\n问题要求 HLL 预测的中间密度与 HLLC 预测的界面密度之比。\n比率 $= \\frac{\\rho_{HLL}}{\\rho_{HLLC}} = \\frac{0.5625}{1} = 0.5625$。\n\n结果要求保留四位有效数字。值 $0.5625$ 已有四位有效数字。",
            "answer": "$$\\boxed{0.5625}$$"
        }
    ]
}