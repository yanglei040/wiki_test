{
    "hands_on_practices": [
        {
            "introduction": "To truly understand an approximate Riemann solver, there is no substitute for a direct, hands-on calculation. This first exercise provides that foundational experience by applying the Harten-Lax-van Leer (HLL) solver to the Sod shock tube problem, a canonical benchmark in computational gas dynamics. You will calculate the HLL numerical flux at an interface and use it to perform a single Godunov-type finite volume update, reinforcing your grasp of the method's core mechanics .",
            "id": "3329729",
            "problem": "Consider the one-dimensional compressible Euler equations in conservative form for mass, momentum, and total energy,\n$$\n\\frac{\\partial U}{\\partial t} + \\frac{\\partial F(U)}{\\partial x} = 0,\n$$\nwith conserved variables and physical flux vector\n$$\nU = \\begin{pmatrix} \\rho \\\\ \\rho u \\\\ E \\end{pmatrix}, \\quad F(U) = \\begin{pmatrix} \\rho u \\\\ \\rho u^{2} + p \\\\ u\\,(E + p) \\end{pmatrix},\n$$\nand the ideal-gas equation of state\n$$\np = (\\gamma - 1)\\left(E - \\frac{1}{2}\\rho u^{2}\\right).\n$$\nHere, $\\rho$ is the density, $u$ is the velocity, $E$ is the total energy, $p$ is the pressure, and $\\gamma$ is the ratio of specific heats. In a Godunov finite volume method with piecewise constant reconstruction, the update for cell $i$ over one time step $\\Delta t$ is governed by the conservative flux difference,\n$$\nU_{i}^{n+1} = U_{i}^{n} - \\frac{\\Delta t}{\\Delta x}\\left(F_{i+1/2} - F_{i-1/2}\\right),\n$$\nwhere $F_{i\\pm 1/2}$ are numerical fluxes at the interfaces $x_{i\\pm 1/2}$ obtained by solving (approximately) the Riemann problems formed by the left and right neighboring cell states.\n\nYou are to use the Harten–Lax–van Leer (HLL) approximate Riemann solver, which models the solution of the Riemann problem by two bounding signal speeds and a constant intermediate state, to compute the interface flux $F_{i+1/2}$ at a Sod shock-tube interface and subsequently update the cell-average in the left cell. The wave speeds should be estimated from the extremal one-sided characteristic speeds of the Euler system inferred from the adjacent left and right states.\n\nAssume a uniform grid of spacing $\\Delta x = 0.01$ (in non-dimensional units) and consider the discontinuity located exactly at $x_{i+1/2}$, so that the left cell $i$ holds the standard Sod left state and the right cell $i+1$ holds the standard Sod right state, with\n$$\n\\rho_{L} = 1, \\quad u_{L} = 0, \\quad p_{L} = 1, \\qquad \\rho_{R} = \\frac{1}{8}, \\quad u_{R} = 0, \\quad p_{R} = \\frac{1}{10},\n$$\nand $\\gamma = \\frac{7}{5}$. Use a Courant–Friedrichs–Lewy (CFL) number of $\\text{CFL} = 0.5$ to set the time step locally at the interface by\n$$\n\\Delta t = \\frac{\\text{CFL}\\,\\Delta x}{\\max\\left(|u_{L}| + a_{L},\\, |u_{R}| + a_{R}\\right)},\n$$\nwhere $a = \\sqrt{\\gamma p/\\rho}$ is the local speed of sound in each state. Take $F_{i-1/2}$ at the left face of cell $i$ from the Riemann problem formed by two identical left states (consistent with piecewise constant reconstruction at $t^{n}$).\n\nCompute the HLL numerical flux $F_{i+1/2}$ using the two-wave HLL construction and perform one Godunov update for cell $i$. Report the updated density $\\rho_{i}^{n+1}$ in non-dimensional units. Your final answer must be a single number or a single closed-form analytic expression. If you present a numerical value, express it exactly or, if approximation is unavoidable, round to four significant figures.",
            "solution": "The problem requires the computation of the updated density in a cell after one time step using a Godunov-type finite volume method. The numerical flux is to be determined using the Harten–Lax–van Leer (HLL) approximate Riemann solver for the one-dimensional Euler equations. The specific case is the Sod shock-tube problem.\n\nFirst, we establish the initial states and their properties based on the provided data. The left state (L, in cell $i$) and right state (R, in cell $i+1$) are given in terms of primitive variables $(\\rho, u, p)$. We use the subscript $L$ for the state in cell $i$ and $R$ for the state in cell $i+1$.\n\nGiven data for the left state:\n$\\rho_L = 1$, $u_L = 0$, $p_L = 1$.\nThe ratio of specific heats is $\\gamma = \\frac{7}{5}$.\n\nGiven data for the right state:\n$\\rho_R = \\frac{1}{8}$, $u_R = 0$, $p_R = \\frac{1}{10}$.\n\nFrom these, we can calculate other thermodynamic and state-vector quantities. The speed of sound $a$ is given by $a = \\sqrt{\\gamma p / \\rho}$.\nFor the left state:\n$$a_L = \\sqrt{\\frac{\\gamma p_L}{\\rho_L}} = \\sqrt{\\frac{(7/5) \\cdot 1}{1}} = \\sqrt{\\frac{7}{5}}$$\nThe total energy per unit volume, $E$, is related to the pressure $p$ by the ideal-gas equation of state: $p = (\\gamma-1)\\left(E - \\frac{1}{2}\\rho u^2\\right)$.\nFor the left state:\n$$p_L = (\\gamma - 1)\\left(E_L - \\frac{1}{2}\\rho_L u_L^2\\right) \\implies 1 = \\left(\\frac{7}{5} - 1\\right)\\left(E_L - \\frac{1}{2}(1)(0)^2\\right) \\implies 1 = \\frac{2}{5} E_L \\implies E_L = \\frac{5}{2}$$\nThe conserved state vector $U_L$ and flux vector $F_L$ are:\n$$U_L = \\begin{pmatrix} \\rho_L \\\\ \\rho_L u_L \\\\ E_L \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 0 \\\\ 5/2 \\end{pmatrix}, \\quad F(U_L) = \\begin{pmatrix} \\rho_L u_L \\\\ \\rho_L u_L^2 + p_L \\\\ u_L(E_L + p_L) \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}$$\n\nFor the right state:\n$$a_R = \\sqrt{\\frac{\\gamma p_R}{\\rho_R}} = \\sqrt{\\frac{(7/5) \\cdot (1/10)}{1/8}} = \\sqrt{\\frac{7}{5} \\cdot \\frac{8}{10}} = \\sqrt{\\frac{56}{50}} = \\sqrt{\\frac{28}{25}} = \\frac{2\\sqrt{7}}{5}$$\n$$p_R = (\\gamma - 1)\\left(E_R - \\frac{1}{2}\\rho_R u_R^2\\right) \\implies \\frac{1}{10} = \\left(\\frac{2}{5}\\right)\\left(E_R - \\frac{1}{2}\\left(\\frac{1}{8}\\right)(0)^2\\right) \\implies \\frac{1}{10} = \\frac{2}{5} E_R \\implies E_R = \\frac{5}{20} = \\frac{1}{4}$$\nThe conserved state vector $U_R$ and flux vector $F_R$ are:\n$$U_R = \\begin{pmatrix} \\rho_R \\\\ \\rho_R u_R \\\\ E_R \\end{pmatrix} = \\begin{pmatrix} 1/8 \\\\ 0 \\\\ 1/4 \\end{pmatrix}, \\quad F(U_R) = \\begin{pmatrix} \\rho_R u_R \\\\ \\rho_R u_R^2 + p_R \\\\ u_R(E_R + p_R) \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 1/10 \\\\ 0 \\end{pmatrix}$$\n\nNext, we establish the parameters for the numerical update. The time step $\\Delta t$ is set by the CFL condition:\n$$\\Delta t = \\frac{\\text{CFL}\\,\\Delta x}{\\max\\left(|u_{L}| + a_{L},\\, |u_{R}| + a_{R}\\right)}$$\nwith $\\text{CFL} = 0.5$ and $\\Delta x = 0.01$. The maximum signal speed is:\n$$\\max\\left(|0| + \\sqrt{\\frac{7}{5}},\\, |0| + \\frac{2\\sqrt{7}}{5}\\right) = \\max\\left(\\sqrt{\\frac{7}{5}},\\, \\sqrt{\\frac{28}{25}}\\right) = \\max\\left(\\sqrt{1.4},\\, \\sqrt{1.12}\\right) = \\sqrt{\\frac{7}{5}}$$\nSo, the time step is:\n$$\\Delta t = \\frac{0.5 \\cdot 0.01}{\\sqrt{7/5}} = \\frac{0.005}{\\sqrt{7/5}}$$\nThe ratio $\\frac{\\Delta t}{\\Delta x}$ required for the update is:\n$$\\frac{\\Delta t}{\\Delta x} = \\frac{0.5}{\\sqrt{7/5}}$$\n\nThe HLL solver requires estimates for the leftmost ($S_L$) and rightmost ($S_R$) signal speeds of the Riemann fan. We use the estimate based on the extremal characteristic speeds from the left and right states, which are $u \\pm a$:\n$$S_L = \\min(u_L - a_L, u_R - a_R) = \\min\\left(0 - \\sqrt{\\frac{7}{5}}, 0 - \\frac{2\\sqrt{7}}{5}\\right) = -\\sqrt{\\frac{7}{5}}$$\n$$S_R = \\max(u_L + a_L, u_R + a_R) = \\max\\left(0 + \\sqrt{\\frac{7}{5}}, 0 + \\frac{2\\sqrt{7}}{5}\\right) = \\sqrt{\\frac{7}{5}}$$\nSince $S_L  0$ and $S_R  0$, the HLL flux $F_{i+1/2}$ is given by:\n$$F_{i+1/2}^{\\text{HLL}} = \\frac{S_R F_L - S_L F_R + S_L S_R (U_R - U_L)}{S_R - S_L}$$\nLet's compute the terms:\n$$S_R - S_L = \\sqrt{\\frac{7}{5}} - \\left(-\\sqrt{\\frac{7}{5}}\\right) = 2\\sqrt{\\frac{7}{5}}$$\n$$S_L S_R = -\\left(\\sqrt{\\frac{7}{5}}\\right)^2 = -\\frac{7}{5}$$\n$$U_R - U_L = \\begin{pmatrix} 1/8 \\\\ 0 \\\\ 1/4 \\end{pmatrix} - \\begin{pmatrix} 1 \\\\ 0 \\\\ 5/2 \\end{pmatrix} = \\begin{pmatrix} -7/8 \\\\ 0 \\\\ -9/4 \\end{pmatrix}$$\n$$S_L S_R (U_R - U_L) = -\\frac{7}{5} \\begin{pmatrix} -7/8 \\\\ 0 \\\\ -9/4 \\end{pmatrix} = \\begin{pmatrix} 49/40 \\\\ 0 \\\\ 63/20 \\end{pmatrix}$$\n$$S_R F_L - S_L F_R = \\sqrt{\\frac{7}{5}}\\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix} - \\left(-\\sqrt{\\frac{7}{5}}\\right)\\begin{pmatrix} 0 \\\\ 1/10 \\\\ 0 \\end{pmatrix} = \\sqrt{\\frac{7}{5}}\\begin{pmatrix} 0 \\\\ 1 + 1/10 \\\\ 0 \\end{pmatrix} = \\sqrt{\\frac{7}{5}}\\begin{pmatrix} 0 \\\\ 11/10 \\\\ 0 \\end{pmatrix}$$\nThe numerator of the HLL flux expression is the sum of the last two results:\n$$\\text{Numerator} = \\begin{pmatrix} 0 \\\\ \\frac{11}{10}\\sqrt{\\frac{7}{5}} \\\\ 0 \\end{pmatrix} + \\begin{pmatrix} \\frac{49}{40} \\\\ 0 \\\\ \\frac{63}{20} \\end{pmatrix} = \\begin{pmatrix} \\frac{49}{40} \\\\ \\frac{11}{10}\\sqrt{\\frac{7}{5}} \\\\ \\frac{63}{20} \\end{pmatrix}$$\nDividing by the denominator $S_R - S_L$:\n$$F_{i+1/2}^{\\text{HLL}} = \\frac{1}{2\\sqrt{7/5}} \\begin{pmatrix} \\frac{49}{40} \\\\ \\frac{11}{10}\\sqrt{\\frac{7}{5}} \\\\ \\frac{63}{20} \\end{pmatrix} = \\begin{pmatrix} \\frac{49}{80\\sqrt{7/5}} \\\\ \\frac{11}{20} \\\\ \\frac{63}{40\\sqrt{7/5}} \\end{pmatrix}$$\nThe finite volume update for cell $i$ is:\n$$U_i^{n+1} = U_i^n - \\frac{\\Delta t}{\\Delta x} \\left( F_{i+1/2} - F_{i-1/2} \\right)$$\nAt time $n$, cell $i$ has the state $U_i^n = U_L$. The flux at the left interface of the cell, $F_{i-1/2}$, is from the Riemann problem $(U_L, U_L)$. For this trivial Riemann problem, the flux is simply $F(U_L) = F_L$.\nThus, $F_{i-1/2} = F_L = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}$.\n\nWe are interested in the updated density $\\rho_i^{n+1}$, which is the first component of $U_i^{n+1}$.\n$$\\rho_i^{n+1} = (U_i^{n+1})_1 = (U_L)_1 - \\frac{\\Delta t}{\\Delta x} \\left( (F_{i+1/2}^{\\text{HLL}})_1 - (F_L)_1 \\right)$$\nSubstituting the values:\n$$(U_L)_1 = \\rho_L = 1$$\n$$\\frac{\\Delta t}{\\Delta x} = \\frac{0.5}{\\sqrt{7/5}}$$\n$$(F_{i+1/2}^{\\text{HLL}})_1 = \\frac{49}{80\\sqrt{7/5}}$$\n$$(F_L)_1 = 0$$\nSo the update equation for density is:\n$$\\rho_i^{n+1} = 1 - \\frac{0.5}{\\sqrt{7/5}} \\left( \\frac{49}{80\\sqrt{7/5}} - 0 \\right)$$\n$$\\rho_i^{n+1} = 1 - \\frac{0.5 \\cdot 49}{80 (\\sqrt{7/5})^2} = 1 - \\frac{1/2 \\cdot 49}{80 \\cdot (7/5)}$$\n$$\\rho_i^{n+1} = 1 - \\frac{49/2}{112} = 1 - \\frac{49}{224}$$\nSimplifying the fraction:\n$$\\rho_i^{n+1} = 1 - \\frac{7 \\times 7}{32 \\times 7} = 1 - \\frac{7}{32}$$\n$$\\rho_i^{n+1} = \\frac{32}{32} - \\frac{7}{32} = \\frac{25}{32}$$\nThe updated density in cell $i$ is exactly $\\frac{25}{32}$.\n\nAs a decimal, this is $0.78125$.",
            "answer": "$$\\boxed{\\frac{25}{32}}$$"
        },
        {
            "introduction": "The HLL solver's formulation includes specific conditions for when the entire Riemann fan is swept downstream or upstream of the cell interface, corresponding to supersonic flow. This practice explores such a scenario, where the flux at the interface is determined solely by the upstream state, illustrating the solver's ability to respect physical causality. By analyzing this supersonic inflow case, you will connect the mathematical structure of the HLL flux conditions to the underlying physics of information propagation in high-speed flows .",
            "id": "3329752",
            "problem": "Consider the one-dimensional Euler equations for an ideal gas in conservative form, with state vector $U = (\\rho, \\rho u, E)^{\\mathsf{T}}$ and flux $F(U) = (\\rho u, \\rho u^{2} + p, u(E + p))^{\\mathsf{T}}$, where $E = \\dfrac{p}{\\gamma - 1} + \\dfrac{1}{2} \\rho u^{2}$. A Riemann problem is posed at an interface $x = 0$ with left primitive state $(\\rho_{L}, u_{L}, p_{L})$ and right primitive state $(\\rho_{R}, u_{R}, p_{R})$. The ratio of specific heats is $\\gamma = 1.4$. The left and right states are\n- $(\\rho_{L}, u_{L}, p_{L}) = (1.0, 500, 1.0 \\times 10^{5})$,\n- $(\\rho_{R}, u_{R}, p_{R}) = (0.9, 450, 0.8 \\times 10^{5})$,\nwhere $\\rho$ is in $\\mathrm{kg}\\,\\mathrm{m}^{-3}$, $u$ in $\\mathrm{m}\\,\\mathrm{s}^{-1}$, and $p$ in $\\mathrm{Pa}$. The ideal-gas sound speed in each state is $a = \\sqrt{\\gamma p / \\rho}$.\n\nAdopt physically motivated bounds for the signal velocities based on the fastest left- and right-moving acoustic waves in each state:\n$$\nS_{L} = \\min\\!\\big(u_{L} - a_{L},\\, u_{R} - a_{R}\\big), \\qquad\nS_{R} = \\max\\!\\big(u_{L} + a_{L},\\, u_{R} + a_{R}\\big).\n$$\n\nUsing the Harten–Lax–van Leer (HLL) approximate Riemann solver, start from the integral conservation form over a space–time control volume bounded by the waves $x = S_{L} t$ and $x = S_{R} t$ and the assumption of a single constant intermediate state between these waves. Derive the expression for the interfacial numerical flux $F_{\\mathrm{HLL}}$ in the three regimes delineated by the signs of $S_{L}$ and $S_{R}$. Then, for the given data, determine whether $S_{L} \\ge 0$ or $S_{R} \\le 0$ holds, identify the active regime, and compute the $x$-momentum flux component $\\big(F_{\\mathrm{HLL}}\\big)_{2}$ at the interface. Discuss briefly the implication for supersonic inflow or outflow at the interface based on your sign evaluation.\n\nRound your final numerical value of $\\big(F_{\\mathrm{HLL}}\\big)_{2}$ to four significant figures. Express the final answer in Pascals.",
            "solution": "### Derivation of the HLL Numerical Flux\nThe HLL approximate Riemann solver approximates the solution to the Riemann problem with a two-wave model. It assumes the solution consists of three constant states ($U_L$, $U_{HLL}$, $U_R$) separated by two waves propagating with speeds $S_L$ and $S_R$. The state at the interface $x=0$ is given by\n$$\nU(x, t) =\n\\begin{cases}\nU_L  \\text{if } x/t  S_L \\\\\nU_{HLL}  \\text{if } S_L \\le x/t \\le S_R \\\\\nU_R  \\text{if } x/t > S_R\n\\end{cases}\n$$\nThe integral form of the conservation law, $\\oint (U dx - F dt) = 0$, is applied to a control volume in the $x-t$ plane. By applying the Rankine-Hugoniot conditions across the left-moving wave ($S_L$) and the right-moving wave ($S_R$), we obtain two relations for the intermediate state $U_{HLL}$ and the corresponding flux $F_{HLL}$:\n1. Across the wave with speed $S_L$: $F_{HLL} - F_L = S_L (U_{HLL} - U_L)$\n2. Across the wave with speed $S_R$: $F_R - F_{HLL} = S_R (U_R - U_{HLL})$\n\nHere, $F_L = F(U_L)$ and $F_R = F(U_R)$. Solving this system for the intermediate flux $F_{HLL}$ gives:\n$$\nF_{HLL} = \\frac{S_R F_L - S_L F_R + S_L S_R (U_R - U_L)}{S_R - S_L}\n$$\n\nThe numerical flux at the interface $x=0$, denoted $F_{\\mathrm{HLL}}$, is the flux corresponding to the state at that location. The state depends on the signs of $S_L$ and $S_R$:\n- If $S_L \\ge 0$, the entire wave pattern moves to the right. The state at $x=0$ is the undisturbed left state, $U_L$. The flux is thus $F_{\\mathrm{HLL}} = F_L$.\n- If $S_R \\le 0$, the entire wave pattern moves to the left. The state at $x=0$ is the undisturbed right state, $U_R$. The flux is thus $F_{\\mathrm{HLL}} = F_R$.\n- If $S_L  0  S_R$, the interface is within the wave fan. The flux at $x=0$ is the constant flux $F_{HLL}$ associated with the intermediate region.\n\nThe complete expression for the HLL numerical flux is:\n$$\nF_{\\mathrm{HLL}} =\n\\begin{cases}\nF_L  \\text{if } S_L \\ge 0 \\\\\n\\dfrac{S_R F_L - S_L F_R + S_L S_R (U_R - U_L)}{S_R - S_L}  \\text{if } S_L  0 \\text{ and } S_R > 0 \\\\\nF_R  \\text{if } S_R \\le 0\n\\end{cases}\n$$\n\n### Computation for the Given Data\nFirst, we compute the sound speeds in the left and right states using $a = \\sqrt{\\gamma p / \\rho}$.\n$$\na_L = \\sqrt{\\frac{\\gamma p_L}{\\rho_L}} = \\sqrt{\\frac{1.4 \\times (1.0 \\times 10^5)}{1.0}} = \\sqrt{140000} \\approx 374.166 \\,\\, \\mathrm{m}\\,\\mathrm{s}^{-1}\n$$\n$$\na_R = \\sqrt{\\frac{\\gamma p_R}{\\rho_R}} = \\sqrt{\\frac{1.4 \\times (0.8 \\times 10^5)}{0.9}} = \\sqrt{\\frac{112000}{0.9}} \\approx 352.767 \\,\\, \\mathrm{m}\\,\\mathrm{s}^{-1}\n$$\nNext, we compute the signal velocities $S_L$ and $S_R$.\nFor $S_L$:\n$u_L - a_L = 500 - 374.166 = 125.834 \\,\\, \\mathrm{m}\\,\\mathrm{s}^{-1}$\n$u_R - a_R = 450 - 352.767 = 97.233 \\,\\, \\mathrm{m}\\,\\mathrm{s}^{-1}$\n$$\nS_L = \\min(125.834, 97.233) = 97.233 \\,\\, \\mathrm{m}\\,\\mathrm{s}^{-1}\n$$\nFor $S_R$:\n$u_L + a_L = 500 + 374.166 = 874.166 \\,\\, \\mathrm{m}\\,\\mathrm{s}^{-1}$\n$u_R + a_R = 450 + 352.767 = 802.767 \\,\\, \\mathrm{m}\\,\\mathrm{s}^{-1}$\n$$\nS_R = \\max(874.166, 802.767) = 874.166 \\,\\, \\mathrm{m}\\,\\mathrm{s}^{-1}\n$$\n\n### Identification of the Active Regime\nWe have found that $S_L \\approx 97.233 > 0$. This corresponds to the first case in our derived expression for the HLL flux.\nThe active regime is therefore $S_L \\ge 0$, and the numerical flux at the interface is simply the flux of the left state:\n$$\nF_{\\mathrm{HLL}} = F_L = F(U_L)\n$$\n\n### Calculation of the Momentum Flux\nThe problem asks for the $x$-momentum flux component, which is the second component of the flux vector, $\\big(F\\big)_{2} = \\rho u^2 + p$. We need to compute this for the left state.\n$$\n\\big(F_{\\mathrm{HLL}}\\big)_{2} = \\big(F_L\\big)_{2} = \\rho_L u_L^2 + p_L\n$$\nSubstituting the given values:\n$$\n\\big(F_{\\mathrm{HLL}}\\big)_{2} = (1.0 \\,\\, \\mathrm{kg}\\,\\mathrm{m}^{-3})(500 \\,\\, \\mathrm{m}\\,\\mathrm{s}^{-1})^2 + (1.0 \\times 10^5 \\,\\, \\mathrm{Pa})\n$$\n$$\n\\big(F_{\\mathrm{HLL}}\\big)_{2} = 1.0 \\times 250000 + 100000 = 250000 + 100000 = 350000 \\,\\, \\mathrm{Pa}\n$$\nThe unit of $\\rho u^2$ is $(\\mathrm{kg}/\\mathrm{m}^3)(\\mathrm{m}/\\mathrm{s})^2 = (\\mathrm{kg} \\cdot \\mathrm{m}/\\mathrm{s}^2)/\\mathrm{m}^2 = \\mathrm{N}/\\mathrm{m}^2 = \\mathrm{Pa}$, which is consistent.\nRounding to four significant figures, the result is $3.500 \\times 10^5 \\,\\, \\mathrm{Pa}$.\n\n### Discussion of Physical Implications\nThe condition $S_L > 0$ implies that the slowest possible signal in the system, which is the left-moving acoustic wave relative to the flow, is still moving in the positive $x$-direction. The physical flow velocities in both the left and right states are greater than their respective local sound speeds:\n- Mach number in left state: $M_L = u_L/a_L = 500/374.166 \\approx 1.336 > 1$\n- Mach number in right state: $M_R = u_R/a_R = 450/352.767 \\approx 1.276 > 1$\nBoth flows are supersonic. The fact that all signals, including the slowest one ($S_L$), propagate from left to right means that there is a **supersonic inflow** from the left. Information at the interface $x=0$ is determined solely by the upstream (left) state. The downstream (right) state has no causal influence on the flow conditions at the interface. This physical reasoning justifies why the HLL numerical flux correctly simplifies to the physical flux of the left state, $F_L$.",
            "answer": "$$\n\\boxed{3.500 \\times 10^{5}}\n$$"
        },
        {
            "introduction": "A critical aspect of mastering numerical methods is understanding not only their strengths but also their limitations. The HLL solver, while robust, is known to be overly diffusive and cannot exactly resolve contact discontinuities or shear waves. This final practice demonstrates this key deficiency by tasking you with computing the HLL flux for a pure contact wave, revealing how the solver smears the density jump and motivating the development of more advanced schemes like the Harten-Lax-van Leer-Contact (HLLC) solver .",
            "id": "3329792",
            "problem": "Consider the one-dimensional Euler equations for an ideal gas in conservation form,\n$$\n\\frac{\\partial \\boldsymbol{U}}{\\partial t} + \\frac{\\partial \\boldsymbol{F}(\\boldsymbol{U})}{\\partial x} = 0,\n$$\nwith conservative variables\n$$\n\\boldsymbol{U} = \\begin{pmatrix} \\rho \\\\ \\rho u \\\\ E \\end{pmatrix},\n$$\nand flux\n$$\n\\boldsymbol{F}(\\boldsymbol{U}) = \\begin{pmatrix} \\rho u \\\\ \\rho u^{2} + p \\\\ u\\,(E + p) \\end{pmatrix}.\n$$\nAssume an ideal gas equation of state with ratio of specific heats $\\,\\gamma = 1.4\\,$, so that\n$$\nE = \\frac{p}{\\gamma - 1} + \\frac{1}{2}\\,\\rho u^{2}.\n$$\nConsider the Riemann problem with left and right states\n$$\n(\\rho_{L}, u_{L}, p_{L}) = (1,\\,1,\\,1), \\qquad (\\rho_{R}, u_{R}, p_{R}) = (0.125,\\,1,\\,1).\n$$\nThus, the initial discontinuity is a pure contact: equal pressure and velocity, different density.\n\nUsing the Harten–Lax–van Leer (HLL) approximate Riemann solver with Davis-type wave speed bounds computed from the local sound speeds on each side, determine the constant intermediate state at the interface and demonstrate the smearing of the contact. Then, using the Harten–Lax–van Leer–Contact (HLLC) approximate Riemann solver with the contact wave speed determined from the Rankine–Hugoniot conditions, determine the interfacial state that retains the contact discontinuity. Finally, report the ratio of the HLL-predicted intermediate density at the interface to the HLLC-predicted interfacial density as a single dimensionless number. Round your answer to four significant figures.",
            "solution": "First, we calculate the necessary thermodynamic and state variables for the left ($L$) and right ($R$) states. The speed of sound $a$ is given by $a = \\sqrt{\\gamma p / \\rho}$.\n\nFor the left state $(\\rho_L, u_L, p_L) = (1, 1, 1)$:\n$a_L = \\sqrt{\\frac{\\gamma p_L}{\\rho_L}} = \\sqrt{\\frac{1.4 \\times 1}{1}} = \\sqrt{1.4}$.\n$E_L = \\frac{p_L}{\\gamma - 1} + \\frac{1}{2}\\rho_L u_L^2 = \\frac{1}{1.4 - 1} + \\frac{1}{2}(1)(1)^2 = 2.5 + 0.5 = 3$.\n$\\boldsymbol{U}_L = \\begin{pmatrix} \\rho_L \\\\ \\rho_L u_L \\\\ E_L \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 1 \\\\ 3 \\end{pmatrix}$.\n$\\boldsymbol{F}_L = \\begin{pmatrix} \\rho_L u_L \\\\ \\rho_L u_L^2 + p_L \\\\ u_L(E_L + p_L) \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 2 \\\\ 4 \\end{pmatrix}$.\n\nFor the right state $(\\rho_R, u_R, p_R) = (0.125, 1, 1)$:\n$a_R = \\sqrt{\\frac{\\gamma p_R}{\\rho_R}} = \\sqrt{\\frac{1.4 \\times 1}{0.125}} = \\sqrt{1.4 \\times 8} = \\sqrt{11.2}$.\n$E_R = \\frac{p_R}{\\gamma - 1} + \\frac{1}{2}\\rho_R u_R^2 = \\frac{1}{1.4 - 1} + \\frac{1}{2}(0.125)(1)^2 = 2.5 + 0.0625 = 2.5625$.\n$\\boldsymbol{U}_R = \\begin{pmatrix} \\rho_R \\\\ \\rho_R u_R \\\\ E_R \\end{pmatrix} = \\begin{pmatrix} 0.125 \\\\ 0.125 \\\\ 2.5625 \\end{pmatrix}$.\n$\\boldsymbol{F}_R = \\begin{pmatrix} \\rho_R u_R \\\\ \\rho_R u_R^2 + p_R \\\\ u_R(E_R + p_R) \\end{pmatrix} = \\begin{pmatrix} 0.125 \\\\ 1.125 \\\\ 3.5625 \\end{pmatrix}$.\n\n#### HLL Solver Analysis\n\nThe HLL solver approximates the Riemann fan with two waves of speeds $S_L$ and $S_R$, enclosing a single constant intermediate state $\\boldsymbol{U}_{HLL}$. We use the Davis-type wave speed estimates:\n$S_L = \\min(u_L - a_L, u_R - a_R) = \\min(1 - \\sqrt{1.4}, 1 - \\sqrt{11.2}) = 1 - \\sqrt{11.2}$.\n$S_R = \\max(u_L + a_L, u_R + a_R) = \\max(1 + \\sqrt{1.4}, 1 + \\sqrt{11.2}) = 1 + \\sqrt{11.2}$.\n\nSince $S_L  0  S_R$, the state in the intermediate region is given by:\n$$ \\boldsymbol{U}_{HLL} = \\frac{S_R \\boldsymbol{U}_R - S_L \\boldsymbol{U}_L - (\\boldsymbol{F}_R - \\boldsymbol{F}_L)}{S_R - S_L} $$\nWe are interested in the density component of this state, $\\rho_{HLL}$:\n$$ \\rho_{HLL} = \\frac{S_R \\rho_R - S_L \\rho_L - ((\\rho u)_R - (\\rho u)_L)}{S_R - S_L} $$\nLet's substitute the known values:\nThe denominator is $S_R - S_L = (1 + \\sqrt{11.2}) - (1 - \\sqrt{11.2}) = 2\\sqrt{11.2}$.\nThe numerator is:\n$N = (1 + \\sqrt{11.2})(0.125) - (1 - \\sqrt{11.2})(1) - (0.125 - 1)$\n$N = 0.125 + 0.125\\sqrt{11.2} - 1 + \\sqrt{11.2} - (-0.875)$\n$N = 0.125 - 1 + 0.875 + (0.125 + 1)\\sqrt{11.2}$\n$N = 0 + 1.125\\sqrt{11.2}$\nThus, the intermediate density is:\n$$ \\rho_{HLL} = \\frac{1.125\\sqrt{11.2}}{2\\sqrt{11.2}} = \\frac{1.125}{2} = 0.5625 $$\nThis value, an average of the left and right densities, demonstrates the numerical diffusion or \"smearing\" of the contact discontinuity inherent in the HLL scheme.\n\n#### HLLC Solver Analysis\n\nThe HLLC solver adds a middle wave for the contact discontinuity with speed $S_*$. The wave structure is $S_L$, $S_*$, $S_R$. The initial condition is a pure contact, where $u_L=u_R=u$ and $p_L=p_R=p$. The exact solution consists of a single contact wave moving at speed $S_* = u = 1$. The HLLC solver is designed to resolve this exactly. The general formula for the contact speed $S_*$ is:\n$$ S_* = \\frac{p_R - p_L + \\rho_L u_L(S_L - u_L) - \\rho_R u_R(S_R - u_R)}{\\rho_L(S_L - u_L) - \\rho_R(S_R - u_R)} $$\nFor our problem, $p_L=p_R=1$ and $u_L=u_R=1$. The formula simplifies:\n$S_* = \\frac{0 + \\rho_L(1)(S_L - 1) - \\rho_R(1)(S_R - 1)}{\\rho_L(S_L - 1) - \\rho_R(S_R - 1)}$.\nUsing $S_L-1 = -\\sqrt{11.2}$ and $S_R-1 = \\sqrt{11.2}$:\n$S_* = \\frac{\\rho_L(-\\sqrt{11.2}) - \\rho_R(\\sqrt{11.2})}{\\rho_L(-\\sqrt{11.2}) - \\rho_R(\\sqrt{11.2})} = 1$.\nThis confirms the HLLC contact speed is $S_*=1$, matching the exact solution.\n\nThe HLLC solution consists of two intermediate star states, $\\boldsymbol{U}_{*L}$ for $S_L  x/t  S_*$ and $\\boldsymbol{U}_{*R}$ for $S_*  x/t  S_R$. We have $S_L = 1 - \\sqrt{11.2} \\approx -2.345  0$ and $S_* = 1 > 0$. The interface at $x/t=0$ lies in the left star region, $S_L  0  S_*$. The state at the interface is therefore $\\boldsymbol{U}_{*L}$. The density in this region, $\\rho_{*L}$, is given by:\n$$ \\rho_{*L} = \\rho_L \\frac{S_L - u_L}{S_L - S_*} $$\nSubstituting the values:\n$\\rho_L = 1$, $u_L = 1$, $S_L = 1 - \\sqrt{11.2}$, and $S_* = 1$:\n$$ \\rho_{*L} = (1) \\frac{(1 - \\sqrt{11.2}) - 1}{(1 - \\sqrt{11.2}) - 1} = \\frac{-\\sqrt{11.2}}{-\\sqrt{11.2}} = 1 $$\nThe HLLC-predicted density at the interface $x/t=0$ is $\\rho_{HLLC} = \\rho_{*L} = 1$. HLLC correctly recovers the state to the left of the moving contact, which is the original left state with $\\rho_L=1$.\n\n#### Final Ratio\n\nThe problem asks for the ratio of the HLL-predicted intermediate density to the HLLC-predicted interfacial density.\nRatio $= \\frac{\\rho_{HLL}}{\\rho_{HLLC}} = \\frac{0.5625}{1} = 0.5625$.\n\nThe result is required to be rounded to four significant figures. The value $0.5625$ already has four significant figures.",
            "answer": "$$\\boxed{0.5625}$$"
        }
    ]
}