{
    "hands_on_practices": [
        {
            "introduction": "可压缩流求解器的一个基本设计选择是能量方程的形式。本练习将引导您推导静态焓 ($h$) 和总能 ($E$) 的输运方程，重点阐明两种不同公式如何处理关键的压力功和动能交换项，这对数值守恒性和激波捕捉能力有着深远影响。",
            "id": "3353133",
            "problem": "考虑一种可压缩牛顿流体，其动力粘度$\\mu$和热导率$k$为常数，受质量守恒、动量守恒和热力学第一定律（针对内能）的支配。令$\\rho$表示质量密度，$\\boldsymbol{u}$表示速度，$p$表示热力学压力，$\\boldsymbol{\\tau}$表示粘性应力张量，$\\boldsymbol{q}$表示遵循傅里叶定律$\\boldsymbol{q} = -k \\nabla T$的热通量矢量，其中$T$是温度。定义比总能$E = e + \\tfrac{1}{2}|\\boldsymbol{u}|^2$，其中$e$是比内能，以及比静焓$h = e + p/\\rho$。您的任务是从守恒定律和热力学恒等式出发进行推导，以说明当基于压力的计算流体动力学(CFD)求解器选择推进$h$或$E$时，压力功和动能交换项是如何以不同方式表示的。\n\n仅从以下各项开始：\n- 连续性方程，\n- 动量方程，以及\n- 针对粘性导热流体的热力学第一定律的内能表述，\n\n执行以下概念性推导：\n- 结合内能和动能平衡，得到总能量的守恒形式，并确定压力-速度耦合出现在何处，\n- 使用热力学恒等式和连续性方程，将内能平衡转换为静态焓平衡，并确定可压缩性如何引入。\n\n然后，根据您的推导，选择所有关于在基于压力的可压缩求解器中，压力功和动能交换项在基于$h$与基于$E$的公式中如何出现的正确陈述。\n\nA. 在$E$的守恒总能量公式中，压力功和动能-内能交换通过$\\nabla\\cdot(p \\boldsymbol{u})$以面通量的形式出现，并且在$E$方程中没有显式的体积源项$-p\\,\\nabla\\cdot\\boldsymbol{u}$。\n\nB. 在$h$的静态焓公式中，可压缩性相互作用以压力物质导数$D p/D t$的形式出现在右侧，即，显式的$p\\,\\nabla\\cdot\\boldsymbol{u}$项不存在。\n\nC. 将内能和动能平衡相加，消除了$-p\\,\\nabla\\cdot\\boldsymbol{u}$和$-\\boldsymbol{u}\\cdot\\nabla p$这对项，将它们转换为$\\nabla\\cdot(p \\boldsymbol{u})$；这个恒等式是守恒总能量通量的基础。\n\nD. 粘性耗散$\\boldsymbol{\\tau}:\\nabla \\boldsymbol{u}$不进入静态焓方程，因为焓已经考虑了机械效应。\n\nE. 对于理想气体，静态焓方程只包含一个与$\\nabla\\cdot \\boldsymbol{u}$成比例的源项；因此它不需要$D p/D t$。\n\nF. 在基于压力的可压缩求解器中，使用$h$代替$E$会将压力-速度耦合从对流通量转移到涉及$D p/D t$的源项，除非采取特殊措施，否则这会影响跨激波的离散守恒性。\n\n选择所有适用项。",
            "solution": "问题陈述是计算流体动力学领域中一个有效的、适定的问题，其基础是流体和热力学的基本原理。我们将进行完整的推导和分析。\n\n作为起点的基本控制方程是：\n1.  **连续性方程：**\n    $$ \\frac{\\partial \\rho}{\\partial t} + \\nabla \\cdot (\\rho \\boldsymbol{u}) = 0 $$\n    用物质导数$D/Dt = \\partial/\\partial t + \\boldsymbol{u} \\cdot \\nabla$表示，这等价于$\\frac{1}{\\rho}\\frac{D\\rho}{Dt} = -\\nabla \\cdot \\boldsymbol{u}$。\n\n2.  **动量方程（非守恒形式）：**\n    $$ \\rho \\frac{D\\boldsymbol{u}}{Dt} = -\\nabla p + \\nabla \\cdot \\boldsymbol{\\tau} $$\n\n3.  **内能方程：**\n    $$ \\rho \\frac{De}{Dt} = -p (\\nabla \\cdot \\boldsymbol{u}) + \\boldsymbol{\\tau} : \\nabla \\boldsymbol{u} - \\nabla \\cdot \\boldsymbol{q} $$\n    这里，$-p (\\nabla \\cdot \\boldsymbol{u})$表示压缩/膨胀的可逆功，$\\boldsymbol{\\tau} : \\nabla \\boldsymbol{u}$是不可逆的粘性耗散（由粘性应力做功转化为内能），$-\\nabla \\cdot \\boldsymbol{q}$是通过传导增加的热量。\n\n### 总能（$E$）方程的推导\n\n比总能定义为$E = e + \\frac{1}{2}|\\boldsymbol{u}|^2$。其演化方程通过将内能和动能的演化方程相加得到。\n\n首先，我们通过将速度矢量$\\boldsymbol{u}$与动量方程做点积来推导动能方程：\n$$ \\boldsymbol{u} \\cdot \\left(\\rho \\frac{D\\boldsymbol{u}}{Dt}\\right) = \\boldsymbol{u} \\cdot (-\\nabla p) + \\boldsymbol{u} \\cdot (\\nabla \\cdot \\boldsymbol{\\tau}) $$\n注意到$\\boldsymbol{u} \\cdot \\frac{D\\boldsymbol{u}}{Dt} = \\frac{D}{Dt}\\left(\\frac{1}{2}\\boldsymbol{u}\\cdot\\boldsymbol{u}\\right) = \\frac{D}{Dt}\\left(\\frac{1}{2}|\\boldsymbol{u}|^2\\right)$，我们得到比动能方程：\n$$ \\rho \\frac{D}{Dt}\\left(\\frac{1}{2}|\\boldsymbol{u}|^2\\right) = -\\boldsymbol{u} \\cdot \\nabla p + \\boldsymbol{u} \\cdot (\\nabla \\cdot \\boldsymbol{\\tau}) $$\n现在，我们将内能方程与动能方程相加：\n$$ \\rho \\frac{De}{Dt} + \\rho \\frac{D}{Dt}\\left(\\frac{1}{2}|\\boldsymbol{u}|^2\\right) = [-p (\\nabla \\cdot \\boldsymbol{u}) - \\boldsymbol{u} \\cdot \\nabla p] + [\\boldsymbol{\\tau} : \\nabla \\boldsymbol{u} + \\boldsymbol{u} \\cdot (\\nabla \\cdot \\boldsymbol{\\tau})] - \\nabla \\cdot \\boldsymbol{q} $$\n左边合并得到$\\rho \\frac{DE}{Dt}$。我们对右边的项进行分组。\n使用散度的乘积法则，我们确定两个关键的恒等式：\n1.  对于压力功项：$p (\\nabla \\cdot \\boldsymbol{u}) + \\boldsymbol{u} \\cdot \\nabla p = \\nabla \\cdot (p \\boldsymbol{u})$。\n2.  对于粘性功项：$\\boldsymbol{\\tau} : \\nabla \\boldsymbol{u} + \\boldsymbol{u} \\cdot (\\nabla \\cdot \\boldsymbol{\\tau}) = \\nabla \\cdot (\\boldsymbol{\\tau} \\cdot \\boldsymbol{u})$。\n\n将这些恒等式代入相加后的方程，得到非守恒形式的总能量输运方程：\n$$ \\rho \\frac{DE}{Dt} = -\\nabla \\cdot (p \\boldsymbol{u}) + \\nabla \\cdot (\\boldsymbol{\\tau} \\cdot \\boldsymbol{u}) - \\nabla \\cdot \\boldsymbol{q} $$\n为了得到完全守恒形式，我们使用关系式$\\rho \\frac{D\\phi}{Dt} = \\frac{\\partial (\\rho \\phi)}{\\partial t} + \\nabla \\cdot (\\rho \\boldsymbol{u} \\phi)$，这是连续性方程的直接推论。将此应用于$E$：\n$$ \\frac{\\partial (\\rho E)}{\\partial t} + \\nabla \\cdot (\\rho E \\boldsymbol{u}) = -\\nabla \\cdot (p \\boldsymbol{u}) + \\nabla \\cdot (\\boldsymbol{\\tau} \\cdot \\boldsymbol{u}) - \\nabla \\cdot \\boldsymbol{q} $$\n将所有项重排为散度形式，得到标准的守恒形式：\n$$ \\frac{\\partial (\\rho E)}{\\partial t} + \\nabla \\cdot [(\\rho E + p) \\boldsymbol{u}] = \\nabla \\cdot (\\boldsymbol{\\tau} \\cdot \\boldsymbol{u} - \\boldsymbol{q}) $$\n关键的观察是，来自内能的压力功项$-p(\\nabla \\cdot \\boldsymbol{u})$和来自动能的压力功项$-\\boldsymbol{u}\\cdot\\nabla p$（它们都是体积源项），合并成一个单一的散度项$-\\nabla \\cdot (p \\boldsymbol{u})$，该项代表能量通量。\n\n### 静态焓（$h$）方程的推导\n\n比静焓定义为$h = e + p/\\rho$。为了找到其输运方程，我们从此定义开始。应用物质导数：\n$$ \\frac{Dh}{Dt} = \\frac{De}{Dt} + \\frac{D}{Dt}\\left(\\frac{p}{\\rho}\\right) $$\n对压力/密度项使用商法则：\n$$ \\frac{D}{Dt}\\left(\\frac{p}{\\rho}\\right) = \\frac{1}{\\rho}\\frac{Dp}{Dt} - \\frac{p}{\\rho^2}\\frac{D\\rho}{Dt} $$\n根据连续性方程，我们有$\\frac{D\\rho}{Dt} = -\\rho \\nabla \\cdot \\boldsymbol{u}$。代入此式：\n$$ \\frac{D}{Dt}\\left(\\frac{p}{\\rho}\\right) = \\frac{1}{\\rho}\\frac{Dp}{Dt} - \\frac{p}{\\rho^2}(-\\rho \\nabla \\cdot \\boldsymbol{u}) = \\frac{1}{\\rho}\\frac{Dp}{Dt} + \\frac{p}{\\rho}\\nabla \\cdot \\boldsymbol{u} $$\n将此结果代回$Dh/Dt$的表达式中，并乘以$\\rho$：\n$$ \\rho \\frac{Dh}{Dt} = \\rho \\frac{De}{Dt} + \\rho \\left( \\frac{1}{\\rho}\\frac{Dp}{Dt} + \\frac{p}{\\rho}\\nabla \\cdot \\boldsymbol{u} \\right) = \\rho \\frac{De}{Dt} + \\frac{Dp}{Dt} + p \\nabla \\cdot \\boldsymbol{u} $$\n最后，我们代入给定的内能方程，$\\rho \\frac{De}{Dt} = -p (\\nabla \\cdot \\boldsymbol{u}) + \\boldsymbol{\\tau} : \\nabla \\boldsymbol{u} - \\nabla \\cdot \\boldsymbol{q}$：\n$$ \\rho \\frac{Dh}{Dt} = (-p \\nabla \\cdot \\boldsymbol{u} + \\boldsymbol{\\tau} : \\nabla \\boldsymbol{u} - \\nabla \\cdot \\boldsymbol{q}) + \\frac{Dp}{Dt} + p \\nabla \\cdot \\boldsymbol{u} $$\n项$+p \\nabla \\cdot \\boldsymbol{u}$和$-p \\nabla \\cdot \\boldsymbol{u}$相互抵消。这就得到了静态焓的输运方程：\n$$ \\rho \\frac{Dh}{Dt} = \\frac{Dp}{Dt} + \\boldsymbol{\\tau} : \\nabla \\boldsymbol{u} - \\nabla \\cdot \\boldsymbol{q} $$\n在这里，显式的压缩功项$p(\\nabla\\cdot \\boldsymbol{u})$被压力的物质导数$Dp/Dt$所取代，后者作为一个源项。这是与内能公式的关键区别。\n\n### 选项评估\n\n**A. 在$E$的守恒总能量公式中，压力功和动能-内能交换通过$\\nabla\\cdot(p \\boldsymbol{u})$以面通量的形式出现，并且在$E$方程中没有显式的体积源项$-p\\,\\nabla\\cdot\\boldsymbol{u}$。**\n这是正确的。我们的推导表明，体积源项$-p(\\nabla \\cdot \\boldsymbol{u})$（来自$e$）和$-\\boldsymbol{u} \\cdot \\nabla p$（来自总能）的组合在$E$方程中产生了项$-\\nabla \\cdot(p \\boldsymbol{u})$。在控制体积上积分一个散度项会得到一个面积分（通量），在有限体积法中，这个通量在单元面上计算。原始的源项$-p\\,\\nabla\\cdot\\boldsymbol{u}$不再显式存在。**正确**。\n\n**B. 在$h$的静态焓公式中，可压缩性相互作用以压力物质导数$D p/D t$的形式出现在右侧，即，显式的$p\\,\\nabla\\cdot\\boldsymbol{u}$项不存在。**\n这是正确的。我们对$h$方程的推导明确表明，项$\\pm p\\,\\nabla\\cdot\\boldsymbol{u}$相互抵消，压力变化对流体微团的影响表现为源项$Dp/Dt$。该项封装了在内能方程中由$-p(\\nabla\\cdot\\boldsymbol{u})$表示的可压缩性效应。**正确**。\n\n**C. 将内能和动能平衡相加，消除了$-p\\,\\nabla\\cdot\\boldsymbol{u}$和$-\\boldsymbol{u}\\cdot\\nabla p$这对项，将它们转换为$\\nabla\\cdot(p \\boldsymbol{u})$；这个恒等式是守恒总能量通量的基础。**\n这是正确的。该陈述准确地描述了推导总能量方程的关键数学步骤。恒等式$-\\left(p\\nabla\\cdot\\boldsymbol{u} + \\boldsymbol{u}\\cdot\\nabla p\\right) = -\\nabla\\cdot(p\\boldsymbol{u})$正是将分离的、非守恒的功项合并为具有通量散度数学形式的单一项的原因，这是守恒公式的要求。**正确**。\n\n**D. 粘性耗散$\\boldsymbol{\\tau}:\\nabla \\boldsymbol{u}$不进入静态焓方程，因为焓已经考虑了机械效应。**\n这是不正确的。我们的推导$\\rho \\frac{Dh}{Dt} = \\frac{Dp}{Dt} + \\boldsymbol{\\tau} : \\nabla \\boldsymbol{u} - \\nabla \\cdot \\boldsymbol{q}$清楚地表明，粘性耗散项$\\boldsymbol{\\tau} : \\nabla \\boldsymbol{u}$是存在的。该项代表机械能到内能（热量）的不可逆转换，并且必须在任何能量或焓平衡中加以考虑。焓本身并不包含这种耗散效应。**不正确**。\n\n**E. 对于理想气体，静态焓方程只包含一个与$\\nabla\\cdot \\boldsymbol{u}$成比例的源项；因此它不需要$D p/D t$。**\n这是不正确的。推导出的焓方程适用于任何流体。该方程为$\\rho \\frac{Dh}{Dt} = \\frac{Dp}{Dt} + \\dots$。它包含源项$Dp/Dt$，而*不*包含与$\\nabla\\cdot\\boldsymbol{u}$成比例的源项。假设是理想气体并不会改变这个基本结构。该陈述混淆了焓公式与内能公式，后者确实包含项$-p \\nabla\\cdot\\boldsymbol{u}$。**不正确**。\n\n**F. 在基于压力的可压缩求解器中，使用$h$代替$E$会将压力-速度耦合从对流通量转移到涉及$D p/D t$的源项，除非采取特殊措施，否则这会影响跨激波的离散守恒性。**\n这是正确的。该陈述正确地解释了我们推导的数值意义。在$E$公式中，压力出现在对流通量项$(\\rho E + p)\\boldsymbol{u}$中。这是一种严格的守恒形式，可以正确捕捉激波。在$h$公式中，其守恒形式为$\\frac{\\partial (\\rho h)}{\\partial t} + \\nabla \\cdot (\\rho h \\boldsymbol{u}) = \\frac{Dp}{Dt} + \\dots$，压力耦合已移至源项$Dp/Dt$。源项中包含导数的方程不是严格的守恒形式。应用于此类方程的标准数值格式将无法正确计算激波等间断的速度和强度，从而违反Rankine-Hugoniot跳跃条件。这是CFD中一个众所周知的问题，因此在跨音速/超音速流中需要对$h$公式进行特殊处理。**正确**。",
            "answer": "$$\\boxed{ABCF}$$"
        },
        {
            "introduction": "实际的可压缩流模拟必须考虑真实的物性，例如比热容会随温度变化。本练习聚焦于基于焓的求解器中的一个关键实施细节，要求您从第一性原理出发，为具有随温度变化的 $c_p(T)$ 的气体推导雅可比矩阵项 $\\frac{\\partial h}{\\partial T}$。该项对于隐式耦合求解方法的稳定性和收敛性至关重要。",
            "id": "3353153",
            "problem": "考虑一种单组分理想气体，其气体常数 $R$ 为常数，等压比热 $c_p(T)$ 依赖于温度。一个基于压力的可压缩求解器通过一个焓输运方程来推进静焓 $h(T)$，并使用一种全耦合的牛顿线性化方法，其中雅可比矩阵需要 $\\frac{\\partial h}{\\partial T}$。从热力学第一定律和连续介质的静焓定义出发，并采用理想气体状态方程，写出以 $h(T)$ 表示的焓输运方程，并将 $h(T)$ 表示为相对于一个选定的参考温度 $T_{\\mathrm{ref}}$（其中 $h(T_{\\mathrm{ref}})=0$）的形式，该形式应与依赖于温度的 $c_p(T)$ 一致。假设在一个适度的温度范围内，热容具有以下科学上合理的表示形式：\n$$\nc_{p}(T) \\;=\\; c_{0} \\;+\\; c_{1}\\,T \\;+\\; c_{2}\\,T^{2} \\;+\\; \\frac{c_{3}}{T},\n$$\n其中 $c_0$、$c_1$、$c_2$ 和 $c_3$ 是正常数。推导出耦合求解器所需的雅可比矩阵贡献项 $\\frac{\\partial h}{\\partial T}$ 的闭合形式表达式，该表达式是温度 $T$ 和给定常数的函数。将您的最终答案表示为单一的闭合形式解析表达式。无需进行数值计算。",
            "solution": "问题要求为具有随温度变化的定压比热 $c_p(T)$ 的理想气体推导雅可比贡献项 $\\frac{\\partial h}{\\partial T}$。推导过程必须基于基本的热力学原理。\n\n让我们从连续介质的比静焓 $h$ 的定义开始：\n$$h = e + \\frac{p}{\\rho}$$\n其中 $e$ 是比内能，$p$ 是静压，$\\rho$ 是密度。使用比容 $v = 1/\\rho$，其微分形式为：\n$$dh = de + d(pv) = de + p\\,dv + v\\,dp$$\n对于可逆过程，以比性质表示的热力学第一定律为：\n$$de = T\\,ds - p\\,dv$$\n其中 $T$ 是绝对温度，$s$ 是比熵。将此 $de$ 的表达式代入 $dh$ 的微分式，得到一个基本的热力学关系式：\n$$dh = (T\\,ds - p\\,dv) + p\\,dv + v\\,dp = T\\,ds + v\\,dp$$\n定压比热 $c_p$ 定义为在恒定压力下焓对温度的偏导数：\n$$c_p \\equiv \\left(\\frac{\\partial h}{\\partial T}\\right)_p$$\n对于一般物质，焓 $h$ 是温度和压力的函数 $h(T, p)$。其全微分是 $dh = (\\frac{\\partial h}{\\partial T})_p dT + (\\frac{\\partial h}{\\partial p})_T dp$。使用 $c_p$ 的定义，这变为：\n$$dh = c_p\\,dT + \\left(\\frac{\\partial h}{\\partial p}\\right)_T dp$$\n对于理想气体，状态方程为 $p = \\rho R T$ 或 $pv = RT$。我们可以证明理想气体的焓仅是温度的函数。项 $(\\frac{\\partial h}{\\partial p})_T$ 可以通过表达式 $(\\frac{\\partial h}{\\partial p})_T = v - T(\\frac{\\partial v}{\\partial T})_p$ 与状态方程关联起来。对于理想气体，$v(T,p) = RT/p$，因此 $(\\frac{\\partial v}{\\partial T})_p = R/p = v/T$。代入得到：\n$$\\left(\\frac{\\partial h}{\\partial p}\\right)_T = v - T\\left(\\frac{v}{T}\\right) = v - v = 0$$\n因此，对于理想气体，焓不依赖于压力，即 $h = h(T)$。微分 $dh$ 简化为：\n$$dh = c_p(T)\\,dT$$\n这表明对于理想气体，即使是热容依赖于温度的理想气体，焓对温度的常导数也等于定压比热。\n\n问题要求给出 $h(T)$ 相对于参考温度 $T_{\\mathrm{ref}}$（在该温度下 $h(T_{\\mathrm{ref}}) = 0$）的表达式。我们通过对前述关系式从 $T_{\\mathrm{ref}}$ 到 $T$ 积分来得到：\n$$\\int_{h(T_{\\mathrm{ref}})}^{h(T)} dh' = \\int_{T_{\\mathrm{ref}}}^{T} c_p(\\tau)\\,d\\tau$$\n$$h(T) - h(T_{\\mathrm{ref}}) = \\int_{T_{\\mathrm{ref}}}^{T} c_p(\\tau)\\,d\\tau$$\n应用条件 $h(T_{\\mathrm{ref}}) = 0$：\n$$h(T) = \\int_{T_{\\mathrm{ref}}}^{T} c_p(\\tau)\\,d\\tau$$\n问题给出了 $c_p(T)$ 的函数形式：\n$$c_p(T) = c_{0} + c_{1}T + c_{2}T^{2} + \\frac{c_{3}}{T}$$\n将此代入 $h(T)$ 的积分中：\n$$h(T) = \\int_{T_{\\mathrm{ref}}}^{T} \\left(c_{0} + c_{1}\\tau + c_{2}\\tau^{2} + \\frac{c_{3}}{\\tau}\\right) d\\tau$$\n执行定积分得到：\n$$h(T) = \\left[ c_{0}\\tau + \\frac{c_{1}}{2}\\tau^{2} + \\frac{c_{2}}{3}\\tau^{3} + c_{3}\\ln(\\tau) \\right]_{T_{\\mathrm{ref}}}^{T}$$\n$$h(T) = \\left( c_{0}T + \\frac{c_{1}}{2}T^{2} + \\frac{c_{2}}{3}T^{3} + c_{3}\\ln(T) \\right) - \\left( c_{0}T_{\\mathrm{ref}} + \\frac{c_{1}}{2}T_{\\mathrm{ref}}^{2} + \\frac{c_{2}}{3}T_{\\mathrm{ref}}^{3} + c_{3}\\ln(T_{\\mathrm{ref}}) \\right)$$\n这就是比静焓作为温度函数的表达式。\n\n要推导的主要量是雅可比贡献项 $\\frac{\\partial h}{\\partial T}$。由于 $h$ 仅是 $T$ 的函数，这等价于全导数 $\\frac{dh}{dT}$。我们可以通过对推导出的 $h(T)$ 表达式直接对 $T$ 求导来得到。涉及 $T_{\\mathrm{ref}}$ 的项是一个常数，其导数为零。\n$$\\frac{\\partial h}{\\partial T} = \\frac{\\partial}{\\partial T} \\left[ \\left( c_{0}T + \\frac{c_{1}}{2}T^{2} + \\frac{c_{2}}{3}T^{3} + c_{3}\\ln(T) \\right) - (\\text{constant}) \\right]$$\n$$\\frac{\\partial h}{\\partial T} = c_{0}\\frac{d(T)}{dT} + \\frac{c_{1}}{2}\\frac{d(T^{2})}{dT} + \\frac{c_{2}}{3}\\frac{d(T^{3})}{dT} + c_{3}\\frac{d(\\ln(T))}{dT}$$\n$$\\frac{\\partial h}{\\partial T} = c_{0}(1) + \\frac{c_{1}}{2}(2T) + \\frac{c_{2}}{3}(3T^{2}) + c_{3}\\left(\\frac{1}{T}\\right)$$\n简化此表达式，我们得到最终结果：\n$$\\frac{\\partial h}{\\partial T} = c_{0} + c_{1}T + c_{2}T^{2} + \\frac{c_{3}}{T}$$\n正如微积分基本定理和我们最初的热力学分析所预期的，焓积分的导数就是比热容，即 $\\frac{\\partial h}{\\partial T} = c_p(T)$。在温度作为自变量的耦合求解器中，该项对于能量（或焓）输运方程的牛顿线性化至关重要。\n\n为了完整起见，问题陈述中要求的焓输运方程可以从一般能量方程推导得出。一种常见的形式是：\n$$\\rho \\frac{Dh}{Dt} = \\frac{Dp}{Dt} - \\nabla \\cdot \\mathbf{q} + \\mathbf{\\Phi}$$\n其中 $\\frac{D}{Dt} = \\frac{\\partial}{\\partial t} + \\mathbf{u} \\cdot \\nabla$ 是物质导数，$\\mathbf{q}$ 是热通量矢量（例如，根据傅里叶定律，$\\mathbf{q} = -k \\nabla T$），而 $\\mathbf{\\Phi} = \\mathbf{\\tau} : \\nabla\\mathbf{u}$ 代表粘性耗散函数。在一个求解温度 $T$ 的耦合数值求解器中，焓 $h$ 被视为 $h(T)$。在对任何包含 $h$ 的项（例如瞬态项 $\\rho \\frac{\\partial h}{\\partial t} = \\rho \\frac{\\partial h}{\\partial T} \\frac{\\partial T}{\\partial t}$）进行线性化时，就会出现 $\\frac{\\partial h}{\\partial T}$ 这一项。",
            "answer": "$$\\boxed{c_{0} + c_{1}T + c_{2}T^{2} + \\frac{c_{3}}{T}}$$"
        },
        {
            "introduction": "基于压力的求解器的性能通常取决于压力（或压力修正）方程的求解效率，而在物性变化剧烈的可压缩流中，该方程可能变得严重病态。这项高级练习将挑战您设计一个鲁棒的代数多重网格 (AMG) 求解器层次结构。您需要将刚度的物理来源——可压缩性 $\\partial \\rho / \\partial p$ 的剧烈变化——与离散算子的数学结构联系起来，并为您对多重网格组件的选择提供合理解释。",
            "id": "3353085",
            "problem": "考虑一个用于可压缩流求解器的基于压力的格式，其中质量守恒是通过在半隐式格式中将压力方程与动量预测耦合来强制执行的。从连续性方程和一般状态方程出发，主导的质量守恒方程由 $\\partial \\rho / \\partial t + \\nabla \\cdot (\\rho \\mathbf{u}) = 0$ 给出，其中 $\\rho = \\rho(p, T)$，$\\mathbf{u}$ 是速度。在固定温度 $T$ 下，将 $\\rho$ 对 $p$ 进行线性化，得到 $\\delta \\rho \\approx (\\partial \\rho / \\partial p) \\, \\delta p$，其中 $(\\partial \\rho / \\partial p)$ 是可压缩性导数。在基于压力的求解器中，压力方程是通过将动量预测的速度代入连续性方程，并求解一个强制执行质量守恒的离散压力系统来形成的。由此产生的离散压力线性系统可以理想化为\n$$\nA \\, p = b, \\quad A = M + K,\n$$\n其中 $M$ 是一个对角或块对角的“类反应”贡献，来自于 $\\partial \\rho / \\partial t$ 的时间离散化（与 $\\chi \\equiv \\partial \\rho / \\partial p$ 除以时间步长 $\\Delta t$ 成正比），而 $K$ 是一个椭圆算子，源于通过动量方程和通量计算的压力梯度的离散散度，$K$ 通常具有负的非对角线元素，并代表一个变系数的类扩散算子。假设压力满足狄利克雷边界条件，因此 $A$ 是对称正定的。由于整个区域存在强烈的热力学变化，系数 $\\chi(\\mathbf{x})$ 变化剧烈，可达数个数量级，例如 $\\chi$ 的范围从 $\\chi_{\\min}$ 到 $\\chi_{\\max}$，且 $\\chi_{\\max}/\\chi_{\\min} \\approx 10^3$。\n\n针对此类变系数系统的代数多重网格（AMG）方法必须经过精心设计，以确保即使在 $\\chi(\\mathbf{x})$ 存在巨大非均匀性的情况下也能实现与网格无关的收敛性。$\\chi(\\mathbf{x})$ 的非均匀性使得 $M$ 变化剧烈，并可能在局部主导 $A$ 的行缩放。一个鲁棒的 AMG 层次结构必须选择一个合适的光滑子，定义能够反映椭圆部分 $K$ 中真实耦合的连接强度和粗化规则，并构建能够可靠表示代数光滑误差分量的延拓算子。\n\n基于对 $A = M + K$ 结构和 $\\chi(\\mathbf{x})$ 作用的第一性原理推断，以下哪种 AMG 层次结构设计最为合适？\n\nA. 仅使用 $A$ 的非对角线元素（即 $K$ 的元素）来定义连接强度，例如 $s_{ij} = |a_{ij}| / \\max_{k \\neq i} |a_{ik}|$，$j \\neq i$，从而忽略由 $M$ 引起的对角占优。使用针对 $K$ 中强连接的经典粗化或聚合方法，并通过关于 $K$ 的能量最小化来构建插值，以便粗糙空间能够很好地表示椭圆算子的低能量模态。使用基于 $D^{-1} A$ 构建的 $\\ell_{1}$-缩放的雅可比或切比雪夫光滑子，其中 $D$ 取为 $\\ell_{1}$ 行和，以便即使在由 $M$ 产生的对角元很大的情况下也能鲁棒地衰减高频误差。将 $M$ 主要视为一个细网格层面的阻尼项，并避免让 $M$ 扭曲粗化过程。\n\nB. 使用 $A$ 的完整行（包括对角线）来定义连接强度，例如 $s_{ij} = |a_{ij}| / a_{ii}$，这样由于大的 $\\chi$ 而导致 $a_{ii}$ 较大的节点将变得弱连接，并在粗化过程中被积极地孤立。无论算子元素如何，都使用均匀的几何 $2 \\times 2 \\times 2$ 聚合进行粗化，并使用带有恒定松弛因子的点雅可比光滑，通过纯注入构建插值。\n\nC. 通过用局部可压缩性归一化非对角线元素来定义连接强度，例如 $s_{ij} = |a_{ij}| / \\sqrt{\\chi_{i} \\chi_{j}}$，选择对称逐次超松弛（SSOR）光滑，其松弛因子针对常系数拉普拉斯算子进行调优，并通过加权平均构建插值，其中权重与 $\\chi$ 成正比。在 $\\chi$ 发生跳跃的区域进行积极粗化，以快速减小算子的大小。\n\nD. 用动量算子替换压力算子来定义连接强度和延拓，理由是速度耦合占主导地位。使用零填充不完全下上三角分解（ILU$(0)$）光滑子和带有积极粗化的纯F循环，假设来自运动量预测的非对称特征应指导压力求解的 AMG 层次结构。\n\n选择最合适的选项，并通过将控制方程与 AMG 设计联系起来证明你的选择，解释光滑子和粗化策略如何在保持椭圆分量 $K$ 的有效粗网格校正的同时，处理 $\\chi(\\mathbf{x})$ 的强烈变化。",
            "solution": "问题描述了一个由可压缩流的基于压力的格式产生的压力线性系统 $A p = b$。该系统的关键特征是矩阵 $A = M + K$ 的结构，其中 $M$ 是一个对角矩阵，强烈依赖于一个高度变化的系数 $\\chi(\\mathbf{x})$，而 $K$ 是一个椭圆（类扩散）算子。任务是为高效且鲁棒地求解该系统，确定最合适的代数多重网格（AMG）设计。\n\n**问题验证**\n\n**第一步：提取已知条件**\n-   **主导物理：** 通过从连续性方程 $\\partial \\rho / \\partial t + \\nabla \\cdot (\\rho \\mathbf{u}) = 0$ 导出的压力方程来强制执行质量守恒。\n-   **状态方程：** 密度 $\\rho$ 是压力 $p$ 和温度 $T$ 的函数，即 $\\rho = \\rho(p, T)$。\n-   **线性化：** 密度变化对压力进行线性化：$\\delta \\rho \\approx (\\partial \\rho / \\partial p) \\, \\delta p$。\n-   **可压缩性系数：** $\\chi \\equiv \\partial \\rho / \\partial p$。\n-   **离散压力系统：** $A \\, p = b$。\n-   **矩阵结构：** $A = M + K$。\n-   **矩阵分量 M：** 一个来自 $\\partial \\rho / \\partial t$ 时间离散化的对角或块对角“类反应”项。它与 $\\chi / \\Delta t$ 成正比。\n-   **矩阵分量 K：** 一个来自压力梯度离散散度的椭圆算子。它是一个变系数类扩散算子，通常具有负的非对角线元素。\n-   **边界条件：** 压力的狄利克雷边界条件。\n-   **矩阵性质：** 假设 $A$ 是对称正定（SPD）的。\n-   **系数变化：** 系数 $\\chi(\\mathbf{x})$ 在整个区域内变化剧烈，$\\chi_{\\max}/\\chi_{\\min} \\approx 10^3$。这使得 $M$ 的元素变化数个数量级。\n-   **目标：** 在给定选项中选择最合适的 AMG 层次结构设计，旨在实现不受 $\\chi$ 非均匀性影响的、与网格无关的收敛性。\n\n**第二步：使用提取的已知条件进行验证**\n-   **科学上合理：** 该问题表述是计算流体力学（CFD）中的标准形式。基于压力的求解器（如 SIMPLE、PISO 及其可压缩流变体）通常会导出一个具有这种精确数学结构的压力校正方程：一个反应-扩散型方程，其中反应项来自可压缩性和/或时间步进，扩散项来自运动量方程中的压力梯度。对 $A=M+K$ 的描述对于此类偏微分方程的离散化是经典的。该问题牢固地植根于已建立的偏微分方程数值分析原理。\n-   **适定性：** 问题要求从一系列设计选择中选出“最合适”的方法。在设计数值算法的背景下，这是一个定义明确的问题，其中“合适性”是根据算子的已知属性，基于鲁棒性和效率来判断的。对于标准有限元或有限体积离散化下的狄利克雷边界条件，假设 $A$ 是对称正定是合理的。\n-   **客观性：** 所使用的语言在数值线性代数和CFD领域是精确和标准的。诸如“连接强度”、“延拓”、“光滑子”、“椭圆算子”和“类反应”等术语都有明确的定义。没有主观或含糊的语言。\n-   **完整性和一致性：** 问题是自洽的，提供了推理矩阵 $A$ 的性质和鲁棒 AMG 求解器要求所需的所有信息。对 $M$ 和 $K$ 及其来源的描述彼此一致，也与底层物理学一致。\n-   **现实性：** 这一场景非常现实。在许多应用中，如多相流、燃烧或跨音速流，热力学性质（如可压缩性）的剧烈变化是常见的。为具有大的、依赖于参数的非均匀性的系统设计可扩展的求解器是数值分析中一个核心且活跃的研究领域。\n\n**第三步：结论与行动**\n问题陈述科学上合理、适定、客观且现实。它提出了一个数值算法设计中有效且不容忽视的挑战。因此，我们着手进行全面求解。\n\n**推导与分析**\n\n问题的核心在于算子 $A = M + K$ 的结构。这是一个反应-扩散算子的典型形式。\n-   $K$ 是扩散（椭圆）部分。代数光滑误差分量——那些不能被标准光滑子有效衰减的分量——由 $K$ 的性质决定。这些分量通常是缓变函数的离散近似。多重网格中粗网格校正的目的正是为了逼近和消除这些分量。\n-   $M$ 是反应部分。它是一个对角矩阵，其元素 $m_{ii} \\propto \\chi_i / \\Delta t$。在 $\\chi_i$ 很大的地方，$A$ 的第 $i$ 行变得强对角占优。大的对角元通过衰减该节点处的所有误差分量（包括高频分量），从而增强了点光滑子（如雅可比或高斯-赛德尔）的性能。\n\n一个鲁棒的 AMG 方法必须正确识别真正的光滑误差以构建其粗网格校正，而不被大的、空间变化的反应项 $M$ 所误导。标准 AMG 在处理此类问题时的一个常见失败模式是误解连接的性质。例如，像 $|a_{ij}|/|a_{ii}|$ 这样的连接强度（SOC）度量，如果由于大的 $m_{ii}$ 导致 $a_{ii}$ 很大，则会将来自节点 $i$ 的所有连接分类为弱连接。这将导致节点 $i$ 在粗化过程中被孤立，从而阻止粗网格校正该位置的任何光滑误差。这是不正确的，因为由 $K$ 代表的物理耦合依然存在。\n\n为这类问题设计 AMG 方法的正确理念是，将层次结构（粗化和插值）的构建基于算子的主要部分，即扩散项 $K$。反应项 $M$ 应被视为有助于光滑子的特征，而不是应该定义粗网格的东西。反过来，光滑子必须足够鲁棒，以处理整个区域内对角占优的巨大变化。\n\n**逐项分析**\n\n**A. 仅使用 $A$ 的非对角线元素（即 $K$ 的元素）来定义连接强度，例如 $s_{ij} = |a_{ij}| / \\max_{k \\neq i} |a_{ik}|$，$j \\neq i$，从而忽略由 $M$ 引起的对角占优。使用针对 $K$ 中强连接的经典粗化或聚合方法，并通过关于 $K$ 的能量最小化来构建插值，以便粗糙空间能够很好地表示椭圆算子的低能量模态。使用基于 $D^{-1} A$ 构建的 $\\ell_{1}$-缩放的雅可比或切比雪夫光滑子，其中 $D$ 取为 $\\ell_{1}$ 行和，以便即使在由 $M$ 产生的对角元很大的情况下也能鲁棒地衰减高频误差。将 $M$ 主要视为一个细网格层面的阻尼项，并避免让 $M$ 扭曲粗化过程。**\n\n-   **理由：** 该选项完美地概括了处理反应-扩散问题的现代、鲁棒的策略。\n    1.  **SOC 和粗化：** 将连接强度（SOC）基于 $A$ 的非对角线元素（即 $K$ 的非对角线元素）可以正确识别底层椭圆问题的耦合结构。这可以防止大的对角项 $M$ “毒化”粗化过程。\n    2.  **插值：** 通过关于 $K$ 的能量最小化来构建插值是一种理论上合理且强大的技术。代数光滑误差模态是相对于“刚度”矩阵 $K$ 的低能量模态。通过设计能够很好地表示这些模态的插值，可以保证有效的粗网格校正。\n    3.  **光滑子：** $\\ell_1$-缩放的光滑子对于由非均匀系数 $\\chi$ 引起的行缩放的巨大变化是鲁棒的。它可以在不需要调整参数的情况下局部调整其阻尼效果，使其非常适合这种情况。\n    4.  **总体理念：** 最后一句正确总结了最先进的方法：层次结构处理椭圆部分（$K$），而光滑子处理完整的算子 $A=M+K$，并从 $M$ 提供的额外阻尼中受益。\n-   **结论：** **正确**。\n\n**B. 使用 $A$ 的完整行（包括对角线）来定义连接强度，例如 $s_{ij} = |a_{ij}| / a_{ii}$，这样由于大的 $\\chi$ 而导致 $a_{ii}$ 较大的节点将变得弱连接，并在粗化过程中被积极地孤立。无论算子元素如何，都使用均匀的几何 $2 \\times 2 \\times 2$ 聚合进行粗化，并使用带有恒定松弛因子的点雅可比光滑，通过纯注入构建插值。**\n\n-   **理由：** 该选项结合了几个有缺陷或不合适的策略。\n    1.  **SOC：** 如上所述，使用 $s_{ij} = |a_{ij}| / a_{ii}$ 是处理此类问题的典型错误。它会导致在高 $\\chi$ 区域的粗化效果不佳。\n    2.  **粗化：** 均匀几何聚合是一种几何多重网格（GMG）策略。它完全忽略了算子中的代数信息，而这正是 AMG 的全部意义所在。对于非均匀问题，这是一个非常差的选择。\n    3.  **光滑子：** 带有*恒定*松弛因子的点雅可比光滑子是不鲁棒的。最优参数取决于迭代矩阵的谱半径，而谱半径随 $\\chi$ 的变化而显著变化。\n    4.  **插值：** 纯注入是一种低阶插值方法，通常不足以捕捉扩散算子的光滑误差。\n-   **结论：** **不正确**。\n\n**C. 通过用局部可压缩性归一化非对角线元素来定义连接强度，例如 $s_{ij} = |a_{ij}| / \\sqrt{\\chi_{i} \\chi_{j}}$，选择对称逐次超松弛（SSOR）光滑，其松弛因子针对常系数拉普拉斯算子进行调优，并通过加权平均构建插值，其中权重与 $\\chi$ 成正比。在 $\\chi$ 发生跳跃的区域进行积极粗化，以快速减小算子的大小。**\n\n-   **理由：** 该选项提出了一系列临时的、违反直觉的启发式方法。\n    1.  **SOC：** 缩放 $s_{ij} = |a_{ij}| / \\sqrt{\\chi_{i} \\chi_{j}}$ 没有明确的理论基础。它以一种非标准的方式混合了椭圆系数（来自 $K$ 的 $a_{ij}$）和反应系数（来自 $M$ 的 $\\chi$）。\n    2.  **光滑子：** 为*常系数*问题调整光滑子参数与处理高度*变系数*问题所需的方法背道而驰。\n    3.  **插值和粗化：** 按 $\\chi$ 加权插值以及在 $\\chi$ 发生跳跃的区域进行积极粗化都是不明智的。粗网格通常应遵循椭圆算子的强连接，这通常意味着*不*跨越系数的大跳跃进行粗化。\n-   **结论：** **不正确**。\n\n**D. 用动量算子替换压力算子来定义连接强度和延拓，理由是速度耦合占主导地位。使用零填充不完全下上三角分解（ILU$(0)$）光滑子和带有积极粗化的纯F循环，假设来自运动量预测的非对称特征应指导压力求解的 AMG 层次结构。**\n\n-   **理由：** 这个选项从根本上就是错误的。\n    1.  **算子不匹配：** AMG 求解器必须为其要解决的特定线性系统 $Ap=b$ 构建。矩阵 $A$ 是一个对称正定的标量算子。动量算子是一个具有完全不同结构的非对称矢量算子。使用动量算子来定义压力求解的层次结构是对 AMG 原理的无稽之谈。\n    2.  **非对称特征：** 问题中声明压力矩阵 $A$ 是对称的。引用来自不同方程的非对称特征作为 $A$ 的 AMG 设计的理由是不正确的。动量方程的影响在其推导过程中已经嵌入到压力系统的系数和源项中了。\n-   **结论：** **不正确**。",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}