## 引言
在[计算流体力学](@entry_id:747620)（CFD）领域，对如[欧拉方程](@entry_id:177914)和[Navier-Stokes方程](@entry_id:161487)这类守恒律方程进行精确且鲁棒的数值求解是核心挑战之一。其中，单元界面处[数值通量](@entry_id:752791)的计算方法直接决定了模拟的精度和稳定性。[平流上游分裂法](@entry_id:746322)（Advection Upstream Splitting Method, AUSM）系列格式作为一类重要的[通量分裂](@entry_id:637102)方法，因其清晰的物理直觉和出色的性能而备受关注。与依赖复杂[特征分解](@entry_id:181333)的传统[黎曼求解器](@entry_id:754362)不同，AUSM通过一种创新的方式解决了问题，但其背后的设计哲学、演化路径以及在复杂应用中的具体挑战，构成了研究人员和工程师必须填补的知识鸿沟。

本文旨在系统性地梳理AUSM系列格式的完整图景，引领读者从基本原理走向前沿应用。在接下来的内容中，您将首先通过“原理与机制”章节，深入理解AUSM如何将物理通量巧妙地分解为[对流](@entry_id:141806)与压力两部分，并探索其从原始版本到现代全速格式的演化历程。随后，在“应用与跨学科交叉”章节中，我们将展示该格式如何扩展至多维[复杂流动](@entry_id:747569)，并应用于[湍流模拟](@entry_id:187401)、天体物理学等多个尖端领域，揭示其强大的适应性。最后，“动手实践”部分将提供具体的编程与分析练习，帮助您将理论知识转化为解决实际问题的能力。

## 原理与机制

在计算流体力学中，对守恒律方程（如[欧拉方程](@entry_id:177914)）的[数值离散化](@entry_id:752782)需要精确且稳健地近似单元界面处的通量。AUSM（Advection Upstream Splitting Method，即[平流上游分裂法](@entry_id:746322)）系列格式是为此目的而设计的一类重要的[通量分裂](@entry_id:637102)方法。与那些基于通量雅可比矩阵特征结构分解的格式（如Roe格式或Steger-Warming格式）不同，AUSM系列格式建立在一个更符合物理直觉的原理之上：将无粘通量分解为[对流](@entry_id:141806)[部分和](@entry_id:162077)压力部分，并为这两部分设计各自独立的、符合其物理传播特性的上游加权策略。本章将深入探讨这一核心原理及其在格式家族[演化过程](@entry_id:175749)中的各种机制。

### 基本原理：[对流](@entry_id:141806)-压力[通量分裂](@entry_id:637102)

我们从一维[可压缩欧拉方程](@entry_id:747588)的[守恒形式](@entry_id:747710)出发：
$$
\frac{\partial \mathbf{U}}{\partial t} + \frac{\partial \mathbf{F}(\mathbf{U})}{\partial x} = 0
$$
其中，[守恒变量](@entry_id:747720)向量 $\mathbf{U}$ 和物理通量向量 $\mathbf{F}(\mathbf{U})$ 分别为：
$$
\mathbf{U} = \begin{pmatrix} \rho \\ \rho u \\ \rho E \end{pmatrix}, \quad \mathbf{F}(\mathbf{U}) = \begin{pmatrix} \rho u \\ \rho u^2 + p \\ u(\rho E + p) \end{pmatrix}
$$
这里，$\rho$ 是流体密度，$u$ 是速度，$E$ 是单位质量总能量，$p$ 是[热力学](@entry_id:141121)压力。

通量向量 $\mathbf{F}(\mathbf{U})$ 的物理内涵揭示了两种截然不同的输运机制：一是通过[流体速度](@entry_id:267320) $u$ 对质量、动量和能量进行的**[对流输运](@entry_id:149512)**；二是由压力 $p$ 引起的机械作用，包括[动量方程](@entry_id:197225)中的压力项和能量方程中的压力功项 $pu$。[AUSM格式](@entry_id:746578)的核心思想正是将这两个物理过程在通量层面分离开来。具体来说，物理通量 $\mathbf{F}(\mathbf{U})$ 可以被精确地分解为一个**[对流](@entry_id:141806)项** $\mathbf{F}_c$ 和一个**压力项** $\mathbf{F}_p$ ：
$$
\mathbf{F}(\mathbf{U}) = \mathbf{F}_c(\mathbf{U}) + \mathbf{F}_p(\mathbf{U})
$$
其中，
$$
\mathbf{F}_c(\mathbf{U}) = \begin{pmatrix} \rho u \\ \rho u^2 \\ \rho E u \end{pmatrix} = u \begin{pmatrix} \rho \\ \rho u \\ \rho E \end{pmatrix} = u\mathbf{U}, \quad \mathbf{F}_p(\mathbf{U}) = \begin{pmatrix} 0 \\ p \\ pu \end{pmatrix}
$$
$\mathbf{F}_c$ 显而易见地表示了守恒量 $\mathbf{U}$ 随速度 $u$ 的整体[平流](@entry_id:270026)，而 $\mathbf{F}_p$ 则包含了所有与压力直接相关的项。

这种分裂的深刻物理合理性可以通过考察[移动控制体](@entry_id:265261)上的[积分守恒律](@entry_id:202878)来揭示。考虑一个边界以法向速度 $w_n$ 移动的控制体，其界面上的[通量平衡](@entry_id:637776)项自然地呈现为 $(\mathbf{F}\cdot\mathbf{n} - w_n \mathbf{U})$，其中 $\mathbf{n}$ 是界面外[法线](@entry_id:167651)。将欧拉方程的通量和[守恒量](@entry_id:150267)代入，我们可以将此界面通量精确地分解为 ：
$$
\mathbf{F}\cdot \mathbf{n} - w_n \mathbf{U} = \underbrace{(u_n - w_n) \mathbf{U}}_{\text{相对对流输运}} + \underbrace{\begin{pmatrix} 0 \\ p\mathbf{n} \\ p u_n \end{pmatrix}}_{\text{压力作用}}
$$
这里 $u_n = \mathbf{u} \cdot \mathbf{n}$ 是法向流速。第一项代表了流体相对于界面运动所携带的质量、动量和能量通量。第二项则代表了压力在界面上施加的力和所做的功。

这种物理分裂与欧拉方程的特征波结构紧密相连。欧拉方程的特征速度（即信息传播速度）为 $u_n-a$, $u_n$, 和 $u_n+a$，其中 $a$ 是声速。其中，$u_n$ 对应于**[平流](@entry_id:270026)模式**（或[接触间断](@entry_id:194702)），它以流体速度输运熵和切向速度的扰动。而 $u_n \pm a$ 对应于**[声学模](@entry_id:263916)式**，它们以相对于流体 $\pm a$ 的速度传播压力、密度和法向速度的扰动。AUSM的[通量分裂](@entry_id:637102)恰好将与[平流](@entry_id:270026)模式相关的通量 $(u_n \mathbf{U})$ 和与[声学模](@entry_id:263916)式相关的压力通量 $(\mathbf{P})$ 分离开来。这使得我们可以为这两种性质迥异的物理过程设计不同的上游格式，从而获得更高的[数值精度](@entry_id:173145)和稳定性。

这种方法的直接优势之一是它能够精确地保持**接触间断**。[接触间断](@entry_id:194702)是黎曼问题的一个解，其两侧的压力和速度相等（$p_L = p_R, u_L = u_R$），但密度和温度等[热力学](@entry_id:141121)量可以有跳跃。在这种情况下，由于压力和速度连续，声学信息是缺省的。[AUSM格式](@entry_id:746578)的压力部分 $\mathbf{F}_p$ 的离散贡献在这种情况下会自然地变得微不足道或为零，而[对流](@entry_id:141806)部分 $\mathbf{F}_c$ 则退化为对密度（以及其他被输运的标量）的纯粹上游平流。这避免了[声学](@entry_id:265335)项对密度间断的“污染”，从而能够以最小的数值耗散尖锐地捕捉[接触间断](@entry_id:194702) 。这与一些纯粹基于[特征分解](@entry_id:181333)的格式（可能在接触间断处引入不必要的耗散）形成了鲜明对比。

### 实施方案：原始[AUSM格式](@entry_id:746578)

基于上述的[对流](@entry_id:141806)-压力分裂思想，[AUSM格式](@entry_id:746578)在单元界面处构造[数值通量](@entry_id:752791) $\widehat{\mathbf{F}}$。其通用形式为：
$$
\widehat{\mathbf{F}}_{i+1/2} = \dot{m}_{i+1/2} \mathbf{\Psi}_{L/R} + \mathbf{P}_{i+1/2}
$$
其中，$\dot{m}_{i+1/2}$ 是通过界面的数值质量通量，$\mathbf{\Psi} = [1, u, H]^{\top}$（$H$ 为[总焓](@entry_id:197863)）是待输运的物理量向量，其取值 ($L$ 或 $R$) 由质量通量的符号决定，而 $\mathbf{P}_{i+1/2} = [0, p_{i+1/2}, 0]^{\top}$ 是界面压力项。

问题的核心在于如何定义界面质量通量 $\dot{m}_{i+1/2}$ 和界面压力 $p_{i+1/2}$。原始的[AUSM格式](@entry_id:746578)引入了基于马赫数 $M=u/a$ 的[分裂函数](@entry_id:161308)来实现这一点。界面质量通量通过一个分裂的界面马赫数 $M^*$ 来定义，而界面压力则通过对左右压力的加权平均得到。

具体来说，界面马赫数 $M^*$ 和界面压力 $p^*$ 定义为：
$$
M^* = M^+(M_L) + M^-(M_R)
$$
$$
p^* = \mathcal{P}^+(M_L) p_L + \mathcal{P}^-(M_R) p_R
$$
其中 $M_L, M_R$ 和 $p_L, p_R$ 分别是界面左右两侧的[马赫数](@entry_id:274014)和压力。[分裂函数](@entry_id:161308) $M^\pm(M)$ 和 $\mathcal{P}^\pm(M)$ 需要满足[相容性条件](@entry_id:637057) $M^+(M) + M^-(M) = M$ 和 $\mathcal{P}^+(M) + \mathcal{P}^-(M) = 1$。

在Liou和Steffen提出的原始[AUSM格式](@entry_id:746578)中，这些[分裂函数](@entry_id:161308)被定义为[分段多项式](@entry_id:634113) ：

- **马赫数[分裂函数](@entry_id:161308) $M^\pm(M)$**：
  - 对于超[声速流](@entry_id:267707)（$|M| \ge 1$），信息只从上游传来，分裂是直接的：$M^+(M) = \frac{1}{2}(M + |M|)$，$M^-(M) = \frac{1}{2}(M - |M|)$。
  - 对于亚[声速流](@entry_id:267707)（$|M|  1$），为了在 $M=0$ 处保持光滑以避免[数值振荡](@entry_id:163720)，引入了二次多项式混合：
    $$
    M^+(M) = \frac{1}{4}(M+1)^2, \quad M^-(M) = -\frac{1}{4}(M-1)^2
    $$

- **压力[分裂函数](@entry_id:161308) $\mathcal{P}^\pm(M)$**：
  - 对于超[声速流](@entry_id:267707)（$|M| \ge 1$），压力信息完全来自上游：$\mathcal{P}^+(M) = \frac{1}{2}(1 + \operatorname{sgn}(M))$，$\mathcal{P}^-(M) = \frac{1}{2}(1 - \operatorname{sgn}(M))$。
  - 对于亚[声速流](@entry_id:267707)（$|M|  1$），声波双向传播，压力是左右状态的混合。为了在[声速点](@entry_id:755066)（$|M|=1$）处满足值的连续性以及导数的特定条件，使用了三次多项式：
    $$
    \mathcal{P}^+(M) = \frac{1}{4}(M+1)^2(2-M), \quad \mathcal{P}^-(M) = \frac{1}{4}(M-1)^2(2+M)
    $$
通过这种方式，[AUSM格式](@entry_id:746578)实现了[对流](@entry_id:141806)和压力项的分别上游加权。[对流](@entry_id:141806)部分由马赫数的符号和大小决定，而压力部分则通过与声学特性相关的 $\mathcal{P}^\pm$ 函数进行加权，从而在超声速时实现纯上游选择，在亚声速时实现平滑过渡。

### 演化与改进：AUSM+及其后继格式

尽管原始[AUSM格式](@entry_id:746578)在很多情况下表现出色，但在处理强激波等极端情况时，可能会产生一些非物理[振荡](@entry_id:267781)。为了提升格式的健壮性，AUSM+ 及其后续改进版本被提了出来。

AUSM+ 的核心改进在于两个方面：一是优化了亚声速分裂多项式，二是引入了**目标压力耗散**（targeted pressure dissipation）机制 。

1.  **改进的分裂多项式**：AUSM+ 采用了更高阶、更光滑的多项式来定义[分裂函数](@entry_id:161308)，以改善格式在跨声速区域的行为，并确保在[声速点](@entry_id:755066)有更好的连续性。

2.  **目标压力耗散**：这是AUSM+最重要的改进。它在压力通量中增加了一个耗散项，该项与界面两侧的**压力差** $\Delta p = p_R - p_L$ 成正比，并由一个基于[马赫数](@entry_id:274014)的传感器函数进行缩放。这个设计的精妙之处在于：
    - 在**激波**处，压力差 $\Delta p$ 很大，耗散项会变得显著，从而有效地抑制激波后的[振荡](@entry_id:267781)，稳定数值解。
    - 在**接触间断**处，压力是连续的（$\Delta p \approx 0$），因此该耗散项自动变为零，不会对接触间断造成额外的模糊，保持了其锐利性。
    - 在光滑的低速流区域，$\Delta p$ 也很小，耗散同样可以忽略不计，从而保持了格式的高精度。

此外，为了进一步控制亚声速区的压力加权，AUSM+引入了一个可调参数 $\alpha$ 。在亚声速压力[分裂函数](@entry_id:161308) $\phi(M)$（使得 $p^\pm(M) = \frac{1}{2} p (1 \pm \phi(M))$）中，$\alpha$ 的角色是：
$$
\phi(M) = M \left(1 + \frac{\alpha}{2} (1 - M^{2})\right), \quad \alpha \in [0,1]
$$
当 $\alpha=0$ 时，$\phi(M) = M$，压力加权是关于[马赫数](@entry_id:274014)的线性函数。当 $\alpha=1$ 时，$\phi(M) = \frac{3}{2} M - \frac{1}{2} M^3$，这是一个在 $M=\pm 1$ 处斜率为零的高阶多项式。通过调节 $\alpha$，用户可以在不同的耗散水平之间进行权衡。

### 应对数值挑战：全速能力与激波稳定性

标准的基于[可压缩流体](@entry_id:164617)方程的数值格式在应用于[低马赫数流](@entry_id:751506)时常常会遇到困难。[AUSM格式](@entry_id:746578)的后续发展，如AUSM+-up和SLAU2，重点解决了这些所谓的“全速”（all-speed）问题。

#### [低马赫数](@entry_id:751528)问题与全速格式

从[无量纲化](@entry_id:136704)的[欧拉方程组](@entry_id:143098)可以看出，在动量方程中存在一个[压力梯度](@entry_id:274112)项 $\frac{1}{M^2}\nabla p$。当马赫数 $M \to 0$ 时，为了使方程保持平衡，压力梯度 $\nabla p$ 必须与 $M^2$ 成正比。这意味着物理上的压[力场](@entry_id:147325)可以表示为 $p(\mathbf{x}, t) = p_0(t) + M^2 \pi(\mathbf{x}, t)$，其中 $p_0$ 是空间均匀的背景压力，而 $\pi$ 是 $O(1)$ 阶的动力学压力。一个[数值格式](@entry_id:752822)若要具备**[低马赫数](@entry_id:751528)相容性**（low-Mach consistency），其产生的[数值误差](@entry_id:635587)压力必须不大于 $O(M^2)$，否则 $\frac{1}{M^2}$ 因子会将[误差放大](@entry_id:749086)到灾难性的程度 。

许多经典的[黎曼求解器](@entry_id:754362)（如Roe或HLLC）在此极限下会失效，因为它们的内蕴数值耗散在[声学模](@entry_id:263916)式上尺度为 $O(a)$（声速）。当 $M \to 0$ 时，这种与流速无关的大耗散会过度地阻尼物理声波，并导致解的精度严重下降 。

为了解决这个问题，像 **AUSM+-up**（"up" 指 velocity-pressure）这样的全速格式被开发出来。AUSM+-up在AUSM+的基础上，额外增加了专门为[低马赫数](@entry_id:751528)设计的耗散项 。这些增补项分别作用于质量通量和压力通量：
$$
\delta m^{(p)} \propto \frac{\Delta p}{a}, \quad \delta p^{(u)} \propto \bar{\rho} a \Delta u
$$
这些项具有正确的量纲，并且至关重要的是，它们在 $M \to 0$ 的极限下提供了一个非简并的、尺度为 $O(a)$ 的阻尼。通过对离散化的线性[声波方程](@entry_id:746230)进行[色散关系分析](@entry_id:748557)可以证明，这些项能够有效地抑制在中心格式中常见的非物理的[压力-速度解耦](@entry_id:167545)（棋盘格[振荡](@entry_id:267781)），同时确保施加于物理模式的耗散尺度为正确的 $O(aM)$，从而在不牺牲低速流精度的前提下保证了稳定性  。这些耗散项同样由[马赫数](@entry_id:274014)函数控制，在[高速流](@entry_id:154843)动时会减弱，以避免过度模糊激波。

#### 多维问题：定常激波的稳定性

在多维问题中，尤其是在笛卡尔网格上模拟与网格对齐的定常[正激波](@entry_id:263382)时，一些数值格式会出现所谓的**奇偶[解耦](@entry_id:637294)**（odd-even decoupling）或“红玉（carbuncle）”现象，即在激波下游出现垂直于激波方向的非物理压力[振荡](@entry_id:267781)。

这种不稳定性的根源在于平行于激波的界面上（法向速度为零）的通量计算存在缺陷。在这些界面上，如果[数值格式](@entry_id:752822)不能有效地耦合压力和动量场，棋盘状的[压力模](@entry_id:159654)式就可能成为离散算子的一个零模而持续存在。

现代AUSM系列格式通过其压力耗散机制有效地解决了这个问题 。由于耗散项与界面压力差成正比，并作用于法向通量，它能够在**所有**方向的界面上都建立起压力和动量之间的耦合。对于平行于激波的界面，尽管法向流速为零，但如果出现了横向的压力[振荡](@entry_id:267781)，该耗散项就会被激活，从而有效地阻尼这些非物理模式，确保了定常激波的稳定和无[振荡](@entry_id:267781)捕捉。

### 对比分析与总结

AUSM系列格式的演化路径清晰地反映了CFD领域对数值方法日益增长的需求：从最初的AUSM（提供基本的物理分裂思想），到AUSM+（通过目标耗散提升激波稳定性），再到AUSM+-up和SLAU2等全速格式（通过[低马赫数](@entry_id:751528)修正实现对从不可压到[高超声速流](@entry_id:263090)动的统一计算）。

与其他主流格式相比，AUSM系列格式的特点鲜明：

-   **与Roe格式对比**：Roe格式是基于特征空间的线性化[黎曼求解器](@entry_id:754362)，而AUSM是基于物理空间的[通量分裂](@entry_id:637102)。AUSM在概念上更简单，并且由于其出色的[接触间断](@entry_id:194702)保持能力，通常在包含这类结构的问题上表现更好。标准的Roe格式存在严重的[低马赫数](@entry_id:751528)耗散问题，而AUSM+-up等则通过专门设计克服了这一点。

-   **与HLLC格式对比**：HLLC格式基于一个假定的三波（two-star）黎曼扇结构，它能与Roe格式一样精确地捕捉接触间断。然而，标准的HLLC格式同样存在与Roe格式类似的[低马赫数](@entry_id:751528)过度耗散问题。

总而言之，以AUSM+-up和SLAU2为代表的现代AUSM系列格式，通过[对流](@entry_id:141806)-压力分裂这一核心思想，并结合精心设计的多尺度耗散机制，已经发展成为一类高度健壮、精确且通用的“全速”格式，能够可靠地处理从低速不可压流到包含强激波和复杂波系的超[声速流](@entry_id:267707)等广泛的[流体力学](@entry_id:136788)问题。