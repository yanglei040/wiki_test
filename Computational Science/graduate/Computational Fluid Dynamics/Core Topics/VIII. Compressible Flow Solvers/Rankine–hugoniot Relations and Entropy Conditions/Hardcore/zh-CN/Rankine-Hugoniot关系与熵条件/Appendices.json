{
    "hands_on_practices": [
        {
            "introduction": "本次练习将我们带回理论基础。我们将从守恒律的积分形式出发，推导著名的朗肯-雨果尼奥跳跃条件，该条件决定了激波等间断的传播速度。接着，我们会将此条件应用于一个具有非凸通量的具体问题，你将看到，为了从众多可能的数学解中筛选出唯一具有物理意义的解，一个额外的约束——熵条件——是必不可少的。 这项练习旨在夯实激波分析的理论基石。",
            "id": "3356128",
            "problem": "考虑标量守恒律 $u_{t} + f(u)_{x} = 0$ 在 $\\mathbb{R} \\times (0,\\infty)$ 上，其分段常数弱解具有单个移动间断，模型为 $u(x,t) = u_{L}\\,\\mathbf{1}_{\\{x  s(t)\\}} + u_{R}\\,\\mathbf{1}_{\\{x > s(t)\\}}$，其中 $s(t)$ 为 Lipschitz 连续轨迹。通量由 $f(u) = u^{3} - 3u$ 给出，黎曼数据为 $u_{L} = 2$ 和 $u_{R} = 0$。\n\n1) 仅从守恒在横跨间断的时空控制体上的积分形式以及 $u$ 是一个弱解的假设出发，推导连接激波速度 $s'(t)$ 与迹 $u_{L}$、$u_{R}$ 及相应通量值的跳跃条件。\n\n2) 对于给定的通量和状态，计算激波速度 $s'(t)$。请以精确数的形式给出你的最终答案。\n\n3) 解释用于从所有弱解中选择物理间断的标量守恒律的熵可容许性判据，并陈述在何种条件下，第 2 部分中得到的激波速度是与熵解相容的唯一速度。特别地，评估从 $u_{L} = 2$ 到 $u_{R} = 0$ 的激波是否满足基于特征压缩的标准可容许性条件。\n\n请将第 2 部分的最终答案表示为一个精确数，无需四舍五入，也无需单位。",
            "solution": "在尝试求解之前，对问题进行验证。\n\n### 步骤1：提取已知条件\n-   **控制方程**：标量守恒律为 $u_{t} + f(u)_{x} = 0$，定义域为 $\\mathbb{R} \\times (0,\\infty)$。\n-   **通量函数**：通量由 $f(u) = u^{3} - 3u$ 给出。\n-   **解的结构**：弱解具有单个移动间断，描述为 $u(x,t) = u_{L}\\,\\mathbf{1}_{\\{x  s(t)\\}} + u_{R}\\,\\mathbf{1}_{\\{x > s(t)\\}}$。\n-   **间断路径**：间断的路径 $s(t)$ 是一个 Lipschitz 连续函数。\n-   **黎曼数据**：常数状态为 $u_{L} = 2$ 和 $u_{R} = 0$。\n\n### 步骤2：使用提取的已知条件进行验证\n1.  **科学依据**：该问题是双曲偏微分方程数学理论中的一个标准练习，特别关注标量守恒律、Rankine–Hugoniot 条件和熵解。这些是计算流体动力学和连续介质力学中的基本概念。该问题在科学上和数学上是合理的。\n2.  **适定的**：该问题是一个标量守恒律的黎曼问题。Oleinik 和 Kružkov 的工作已经很好地确立了此类问题物理相关（熵）解的存在性和唯一性。在此背景下，该问题是适定的。\n3.  **客观的**：该问题使用精确的数学语言和定义进行陈述。所有量都有明确的定义。\n4.  **不完整或矛盾的设置**：该问题提供了所有必要的信息：偏微分方程、通量函数、初始状态以及假定的解的结构。没有矛盾之处。\n5.  **不切实际或不可行**：该问题是一个理论模型，并未声称代表具有测量数据的特定物理系统。其组成部分在数学上是一致的。\n6.  **不适定或结构不良**：该问题结构良好，在熵解的标准框架下，可以得到一个唯一的、有意义的解。\n7.  **伪深刻、琐碎或同义反复**：该问题需要一个标准但非琐碎的推导、计算和概念解释，考察了该主题的基础知识。\n8.  **超出科学可验证性**：该问题是一个数学构造，完全可以通过逻辑推演和已建立的数学理论进行验证。\n\n### 步骤3：结论与行动\n问题被判定为**有效**。将提供完整的解答。\n\n***\n\n### 第1部分：朗肯-雨果尼奥跳跃条件的推导\n\n守恒律 $u_{t} + f(u)_{x} = 0$ 可以写成积分形式。对于空间中的任意控制体 $[x_{1}, x_{2}]$，守恒量 $u$ 的总量变化率等于穿过边界的净通量：\n$$\n\\frac{d}{dt} \\int_{x_{1}}^{x_{2}} u(x,t) \\,dx = f(u(x_{1}, t)) - f(u(x_{2}, t))\n$$\n这种形式对光滑解成立。对于在 $x=s(t)$ 处存在间断的弱解，我们必须谨慎应用此原理。\n\n让我们考虑一个在空间中固定且在所有相关时间 $t$ 都包含激波的控制体 $[x_{1}, x_{2}]$，即 $x_{1}  s(t)  x_{2}$。解由 $x  s(t)$ 时 $u(x,t) = u_{L}$ 和 $x > s(t)$ 时 $u(x,t) = u_{R}$ 给出。\n\n左侧的积分可以在间断点处分开：\n$$\n\\int_{x_{1}}^{x_{2}} u(x,t) \\,dx = \\int_{x_{1}}^{s(t)} u_{L} \\,dx + \\int_{s(t)}^{x_{2}} u_{R} \\,dx = u_{L} (s(t) - x_{1}) + u_{R} (x_{2} - s(t))\n$$\n现在，我们对这个表达式关于时间 $t$ 求导。由于 $x_{1}$、$x_{2}$、$u_{L}$ 和 $u_{R}$ 是常数，我们对 $s(t)$ 使用链式法则，将其导数记为 $s'(t)$：\n$$\n\\frac{d}{dt} \\int_{x_{1}}^{x_{2}} u(x,t) \\,dx = \\frac{d}{dt} [u_{L} s(t) - u_{L} x_{1} + u_{R} x_{2} - u_{R} s(t)] = u_{L} s'(t) - u_{R} s'(t) = s'(t)(u_{L} - u_{R})\n$$\n积分形式的右侧涉及边界 $x_{1}$ 和 $x_{2}$ 处的通量。由于 $x_{1}  s(t)$ 和 $x_{2} > s(t)$，我们有 $u(x_{1}, t) = u_{L}$ 和 $u(x_{2}, t) = u_{R}$。因此通量项为：\n$$\nf(u(x_{1}, t)) - f(u(x_{2}, t)) = f(u_{L}) - f(u_{R})\n$$\n令两个表达式相等，我们得到：\n$$\ns'(t)(u_{L} - u_{R}) = f(u_{L}) - f(u_{R})\n$$\n这就是朗肯-雨果尼奥跳跃条件。它将间断速度 $s'(t)$ 与其两侧的状态 $u_{L}$、$u_{R}$ 以及相应的通量值联系起来。速度（通常记为 $s$）由下式给出：\n$$\ns'(t) = \\frac{f(u_{L}) - f(u_{R})}{u_{L} - u_{R}}\n$$\n\n### 第2部分：激波速度的计算\n\n给定通量函数 $f(u) = u^{3} - 3u$ 和黎曼数据 $u_{L} = 2$ 和 $u_{R} = 0$。我们应用第1部分推导出的朗肯-雨果尼奥条件。\n\n首先，我们计算左右状态下的通量：\n-   对于 $u_{L} = 2$：$f(u_{L}) = f(2) = 2^{3} - 3(2) = 8 - 6 = 2$。\n-   对于 $u_{R} = 0$：$f(u_{R}) = f(0) = 0^{3} - 3(0) = 0$。\n\n接下来，我们计算公式中的各项：\n-   分子：$f(u_{L}) - f(u_{R}) = 2 - 0 = 2$。\n-   分母：$u_{L} - u_{R} = 2 - 0 = 2$。\n\n激波速度 $s'(t)$ 是两者的比值：\n$$\ns'(t) = \\frac{2}{2} = 1\n$$\n激波速度是常数，$s'(t) = 1$。\n\n### 第3部分：熵可容许性判据\n\n守恒律的弱解不一定是唯一的。需要一个额外的判据，称为熵条件，来选择物理上正确的解。对于标量守恒律，此条件确保沿特征线携带的信息流入激波间断，而不是从其发出。激波前沿代表一个信息丢失的不可逆过程，这类似于热力学系统中熵的增加。\n\n信息的传播速度，或称特征速度，由 $c(u) = f'(u)$ 给出。对于给定的通量 $f(u) = u^{3} - 3u$，特征速度为：\n$$\nc(u) = f'(u) = \\frac{d}{du}(u^{3} - 3u) = 3u^{2} - 3\n$$\n激波的标准可容许性条件，称为 Lax 熵条件，要求激波左侧的特征速度大于激波速度，而激波速度又必须大于右侧的特征速度。这种“特征压缩”可表示为：\n$$\nf'(u_{L})  s'(t)  f'(u_{R})\n$$\n让我们对给定问题评估此条件。我们有 $u_{L} = 2$，$u_{R} = 0$，并且我们求得 $s'(t) = 1$。我们计算左右状态下的特征速度：\n-   $c(u_{L}) = f'(u_{L}) = f'(2) = 3(2)^{2} - 3 = 3(4) - 3 = 12 - 3 = 9$。\n-   $c(u_{R}) = f'(u_{R}) = f'(0) = 3(0)^{2} - 3 = 0 - 3 = -3$。\n\n将这些值代入 Lax 熵不等式：\n$$\n9  1  -3\n$$\n这个不等式成立。因此，连接 $u_{L}=2$ 和 $u_{R}=0$ 且速度为 $s'=1$ 的激波满足 Lax 熵条件，是一个可容许的物理激波。\n\n对于给定的黎曼问题，该激波解的唯一性源于熵解的一般理论（例如，Kružkov 的理论）。该理论保证了唯一的满足熵条件的解。当 Lax 条件对一个间断成立时，该激波就是唯一熵解的正确构成部分。\n\n值得注意的是，通量函数 $f(u) = u^{3} - 3u$ 是非凸的，因为其二阶导数 $f''(u) = 6u$ 会变号。对于非凸通量，需要更一般的 Oleinik 熵条件。该条件规定，对于所有在 $u_{L}$ 和 $u_{R}$ 之间的 $u$，连接通量图上点 $(u_{L}, f(u_{L}))$ 和 $(u_{R}, f(u_{R}))$ 的线段（弦）必须位于 $f(u)$ 图像的一侧。在我们的例子中，由于 $u_{L}u_{R}$，弦必须位于通量图的上方。弦连接 $(0,0)$ 和 $(2,2)$，其方程为 $y(u)=u$。条件是对于 $u \\in [0, 2]$，$f(u) \\le u$。这等价于 $u^{3} - 3u \\le u$，或 $u^{3} - 4u \\le 0$。因式分解得到 $u(u-2)(u+2) \\le 0$。对于 $u \\in (0,2)$，该表达式为负，在端点处为零，因此条件成立。因此，即使在这个更严格、更一般的条件下，该激波也是可容许的。",
            "answer": "$$\\boxed{1}$$"
        },
        {
            "introduction": "理论与实践在本练习中交汇，我们将探讨计算流体动力学中的一个经典挑战。即使是如Roe格式这样精密的数值方法，有时也会产生违背物理规律的解，例如“膨胀激波”。 本题要求你运用熵增原理，诊断这类伪激波为何违反了基本的熵条件，并识别出在现代CFD代码中用于修正此问题的标准技术。完成这项练习将加深你对熵原理如何直接指导鲁棒数值格式设计与实现的理解。",
            "id": "3356174",
            "problem": "考虑理想气体的一维可压缩欧拉方程，其比热比为 $\\gamma$：\n$$\n\\partial_t \\begin{pmatrix} \\rho \\\\ \\rho u \\\\ E \\end{pmatrix}\n+ \\partial_x \\begin{pmatrix} \\rho u \\\\ \\rho u^2 + p \\\\ u(E+p) \\end{pmatrix} = 0,\n\\quad p = (\\gamma - 1)\\left(E - \\tfrac{1}{2}\\rho u^2\\right),\n$$\n其中 $\\rho$ 是密度，$u$ 是速度，$E$ 是总能量，$p$ 是压力。该系统的特征速度为 $\\lambda_1 = u - a$, $\\lambda_2 = u$, $\\lambda_3 = u + a$，其中 $a = \\sqrt{\\gamma p / \\rho}$ 是当地声速。\n\n对于一个黎曼问题，其精确解在第 $1$ 族中包含一个跨音速稀疏波（即 $\\lambda_1$ 在整个扇区内从负值增加到正值），使用 Roe 近似黎曼求解器的有限体积格式会在稀疏区域内产生一个微小但持续存在的间断，通常称为伪膨胀激波。在稀疏波内部的网格界面上，当地重构的左右状态满足 $p_R  p_L$ 和 $u_R  u_L$，并且代码报告了一个分隔这些状态的数值计算出的间断速度 $S$。\n\n仅使用控制守恒律、跨越间断的 Rankine–Hugoniot 跳跃条件、双曲系统的 Lax 熵条件以及理想气体可压缩欧拉方程的熵不等式（即比熵在穿过激波时不能减少），回答以下问题：\n\n- 诊断为什么在第 $1$ 族稀疏波内部出现一个 $p_R  p_L$ 和 $u_R  u_L$ 的表观间断必然违反可采纳性（在你的推理中明确使用 Lax 熵条件或熵不等式）。\n- 然后，指出对空间离散化或黎曼求解器的修正方法，这些方法专门用于消除跨音速稀疏区中的伪膨胀激波，同时保持物理上可采纳的解。\n\n选择所有正确陈述了熵违背的有效诊断以及能消除伪膨胀激波的修正方法的选项。\n\nA. 观察到的跳跃违反了第 $1$ 族的 Lax 熵条件，因为在稀疏波中 $\\lambda_1$ 是增加的，而任何间断都要求 $\\lambda_1(U_L)  S  \\lambda_1(U_R)$，这在 $\\lambda_1(U_R)  \\lambda_1(U_L)$ 时无法成立。为 Roe 求解器实施 Harten–Hyman 熵修正，通过修改声速点附近特征值的绝对值，在 $|\\lambda_k|$ 很小时施加额外的耗散。\n\nB. Roe 线性化会错误地表示跨音速稀疏波，因为 Roe 平均的第 $1$ 波速可能无法反映 $\\lambda_1$ 的符号变化，从而导致不正确的迎风和非熵增的膨胀激波。用 Harten–Lax–van Leer with contact (HLLC) 求解器替换 Roe 通量，并使用熵相容且保正的波速估计（例如 Einfeldt 速度），这种方法可以避免跨音速扇区中的膨胀激波。\n\nC. 伪膨胀激波源于声速点附近熵相容耗散不足。使用单调通量，例如局部 Lax–Friedrichs (LLF，也称为 Rusanov) 通量或两波 Harten–Lax–van Leer–Einfeldt (HLLE) 通量；这些通量满足离散熵不等式，不能形成膨胀激波，尽管它们更具耗散性。\n\nD. 将 Courant–Friedrichs–Lewy (CFL) 数增加到接近 1 以减少数值误差；更高的 CFL 数会直接强制执行熵不等式，从而在不修改通量函数的情况下消除伪膨胀激波。\n\nE. 保持 Roe 通量不变，但增加一个带有总变差递减 (TVD) 限制器的高阶重构，或切换到高阶加权基本无振荡 (WENO) 格式；仅靠高阶无振荡重构就能确保熵可采纳性并消除跨音速稀疏波中的膨胀激波。",
            "solution": "问题陈述在科学上是合理的且是适定的。它描述了在使用 Roe 近似黎曼求解器求解一维可压缩欧拉方程时遇到的一个经典数值伪影，即在跨音速稀疏波中形成伪膨胀激波。该问题要求基于基本原理对这种非物理现象进行诊断，并确定适当的补救措施。\n\n### 问题陈述的验证\n\n**步骤 1：提取已知条件**\n-   控制方程：理想气体的 $1D$ 可压缩欧拉方程，\n    $$ \\partial_t \\begin{pmatrix} \\rho \\\\ \\rho u \\\\ E \\end{pmatrix} + \\partial_x \\begin{pmatrix} \\rho u \\\\ \\rho u^2 + p \\\\ u(E+p) \\end{pmatrix} = 0 $$\n-   状态方程：$p = (\\gamma - 1)(E - \\tfrac{1}{2}\\rho u^2)$\n-   状态变量：密度 $\\rho$，速度 $u$，单位体积总能量 $E$，压力 $p$。\n-   特征速度：$\\lambda_1 = u - a$, $\\lambda_2 = u$, $\\lambda_3 = u + a$，其中 $a = \\sqrt{\\gamma p / \\rho}$ 是声速。\n-   问题背景：一个在第 $1$ 族中带有跨音速稀疏波的黎曼问题，意味着 $\\lambda_1$ 在稀疏扇区内从负值增加到正值。\n-   数值观察：使用 Roe 求解器的有限体积格式在稀疏波内部产生了一个伪间断。\n-   伪间断的性质：它分隔左右两个状态 $U_L$ 和 $U_R$，使得 $p_R  p_L$ 和 $u_R  u_L$。\n-   任务：\n    1.  使用 Lax 熵条件或熵不等式，诊断为什么这个表观间断违反了可采纳性。\n    2.  确定修正数值格式以消除此伪影的正确方法。\n\n**步骤 2：使用提取的已知条件进行验证**\n-   **科学上合理**：欧拉方程、理想气体定律和特征速度的概念是流体动力学的基础。Roe 求解器产生的伪膨胀激波现象是计算流体力学中一个有详细记载并经过严谨研究的课题。描述是准确的，并基于已建立的理论。\n-   **适定性**：问题陈述清晰。它要求基于给定的理论工具进行特定诊断，并从选项列表中确定正确的数值修正方法。在守恒律数值方法的既定理论中，存在一组唯一的正确答案。\n-   **客观性**：语言是技术性的、精确的，并且没有主观性或歧义。\n\n**步骤 3：结论与行动**\n问题陈述是有效的。这是分析双曲守恒律数值格式中的一个标准问题。我将继续进行求解。\n\n### 推导与分析\n\n双曲守恒律 $\\partial_t U + \\partial_x F(U) = 0$ 解中的一个间断或激波，必须满足两个条件才能被认为是物理上可采纳的：\n1.  Rankine-Hugoniot (R-H) 跳跃条件，该条件由守恒律的积分形式导出。对于一个以速度 $S$ 移动的间断，R-H 条件为：\n    $$ S(U_R - U_L) = F(U_R) - F(U_L) $$\n2.  熵条件，它确保解是物理相关的弱解，并遵守热力学第二定律。\n\n问题描述了一个数值上产生的间断，其中 $p_R  p_L$ 和 $u_R  u_L$。这代表一次膨胀，因为流体在跳跃中膨胀到更低的压力和更高的速度。这种特征通常被称为“膨胀激波”。我们必须诊断为什么它不是一个物理上可采纳的解。\n\n**使用 Lax 熵条件进行诊断：**\nLax 熵条件是激波可采纳性的一个数学判据。对于与第 $k$ 特征族相关的激波（一个 $k$-激波），激波两侧的特征速度必须“指向”间断。这表示为：\n$$ \\lambda_k(U_L)  S  \\lambda_k(U_R) $$\n这个不等式意味着沿第 $k$ 特征族传播的信息被激波吞噬，这是像激波这样的不可逆过程的一个关键特征。\n\n问题指明了一个出现在第 $1$ 族稀疏波内的跳跃。稀疏波是一个光滑、连续的解，其中状态变量连续变化。$k$-稀疏波的一个基本性质是，相应的特征速度 $\\lambda_k$ 在波的传播方向上（$x$ 增加的方向）严格增加。对于给定的第 $1$ 族稀疏波，这意味着对于扇区内的任意两个状态 $U_L$ 和 $U_R$（$U_L$ 在 $U_R$ 的左侧），我们必须有：\n$$ \\lambda_1(U_R)  \\lambda_1(U_L) $$\n一个 $1$-激波的 Lax 条件要求 $\\lambda_1(U_L)  S  \\lambda_1(U_R)$，这意味着 $\\lambda_1(U_L)  \\lambda_1(U_R)$。这与第 $1$ 族稀疏波的定义属性直接矛盾。因此，一个满足 R-H 条件的间断不能同时存在于稀疏扇区内。数值上观察到的“膨胀激波”违反了第 $1$ 族的 Lax 熵条件。\n\n**使用热力学熵不等式进行诊断：**\n热力学第二定律要求比熵 $s$ 不能穿过激波而减少。对于欧拉方程的解，这意味着：\n$$ s_R \\ge s_L $$\n对于理想气体，比熵与压力和密度通过 $s = C_v \\ln(p/\\rho^\\gamma) + \\text{constant}$ 相关联，其中 $C_v$ 是定容比热。条件 $s_R \\ge s_L$ 等价于 $p_R/\\rho_R^\\gamma \\ge p_L/\\rho_L^\\gamma$。\n可以从欧拉方程的 Rankine-Hugoniot 条件证明，对于任何非平凡激波（$U_L \\ne U_R$），熵的增加（$s_R  s_L$）只在激波是压缩激波（$p_R  p_L$）时发生。反之，如果一个间断是膨胀的（$p_R  p_L$），它必然导致熵的减少（$s_R  s_L$），这违反了热力学第二定律。因此，膨胀激波在物理上是不可能的。\n\n**Roe 求解器中数值伪影的成因：**\nRoe 求解器在每个单元界面通过构造一个“Roe 平均”矩阵 $\\hat{A}(U_L, U_R)$ 来将问题线性化，该矩阵的特征值为 $\\hat{\\lambda}_k$。数值通量包含一个与 $|\\hat{\\lambda}_k|$ 成正比的耗散项。在跨音速稀疏波中，真实的特征速度 $\\lambda_1 = u-a$ 会改变符号，穿过零点。然而，Roe 平均速度 $\\hat{\\lambda}_1$ 只有一个值。如果 $\\lambda_1(U_L)  0$ 且 $\\lambda_1(U_R)  0$，那么 $\\hat{\\lambda}_1$ 可能是一个非常小的数。与 $|\\hat{\\lambda}_1|$ 成正比的耗散项变得极小，无法提供表示光滑稀疏扇区所需的数值扩散。取而代之的是，求解器计算其线性化问题的解，即一个单一的静止或缓慢移动的间断——也就是伪膨胀激波。\n\n### 选项评估\n\n**A. 观察到的跳跃违反了第 $1$ 族的 Lax 熵条件，因为在稀疏波中 $\\lambda_1$ 是增加的，而任何间断都要求 $\\lambda_1(U_L)  S  \\lambda_1(U_R)$，这在 $\\lambda_1(U_R)  \\lambda_1(U_L)$ 时无法成立。为 Roe 求解器实施 Harten–Hyman 熵修正，通过修改声速点附近特征值的绝对值，在 $|\\lambda_k|$ 很小时施加额外的耗散。**\n-   **诊断**：这是一个完全正确且严谨的解释。它正确地指出了激波的 Lax 条件（$\\lambda_1(U_L)  \\lambda_1(U_R)$）与稀疏波的性质（$\\lambda_1(U_R)  \\lambda_1(U_L)$）之间的矛盾。\n-   **修正方法**：Harten–Hyman 熵修正正是处理此问题的标准方法，用于修补 Roe 求解器。它在原始格式失效的声速点精确地增加少量数值耗散，从而使稀疏波能够被解析为光滑的扇区。\n-   **结论**：**正确**。\n\n**B. Roe 线性化会错误地表示跨音速稀疏波，因为 Roe 平均的第 $1$ 波速可能无法反映 $\\lambda_1$ 的符号变化，从而导致不正确的迎风和非熵增的膨胀激波。用 Harten–Lax–van Leer with contact (HLLC) 求解器替换 Roe 通量，并使用熵相容且保正的波速估计（例如 Einfeldt 速度），这种方法可以避免跨音速扇区中的膨胀激波。**\n-   **诊断**：这正确地指出了问题的根源在于 Roe 求解器的机制：Roe 平均特征值未能捕捉跨音速扇区的结构。\n-   **修正方法**：用像 HLLC 这样更鲁棒的求解器替换 Roe 求解器是一种标准且有效的策略。HLLC 被设计为满足熵条件且保正，并且不会产生膨胀激波。在 Roe 求解器已知会失效的情况下，它是一个成熟的替代方案。\n-   **结论**：**正确**。\n\n**C. 伪膨胀激波源于声速点附近熵相容耗散不足。使用单调通量，例如局部 Lax–Friedrichs (LLF，也称为 Rusanov) 通量或两波 Harten–Lax–van Leer–Einfeldt (HLLE) 通量；这些通量满足离散熵不等式，不能形成膨胀激波，尽管它们更具耗散性。**\n-   **诊断**：该诊断正确而简洁。声速点处耗散不足是伪影形成的根本原因。\n-   **修正方法**：使用像 LLF (Rusanov) 或 HLLE 这样内在耗散且满足熵条件的通量是另一种有效且常见的修正方法。这些求解器保证不会产生膨胀激波，因为它们内在地包含了足够的数值粘性。承认它们比 Roe 求解器（即使带有熵修正）更具耗散性也是准确的。\n-   **结论**：**正确**。\n\n**D. 将 Courant–Friedrichs–Lewy (CFL) 数增加到接近 1 以减少数值误差；更高的 CFL 数会直接强制执行熵不等式，从而在不修改通量函数的情况下消除伪膨胀激波。**\n-   **诊断**：这是不正确的。问题不是一个对 CFL 数如此敏感的泛泛的“数值误差”。\n-   **修正方法**：CFL 条件关联了时间步长、空间网格尺寸和特征速度，以确保数值稳定性。它并不强制执行熵条件。增加 CFL 数（对于显式格式）会减少每单位物理时间的数值扩散，这可能会使伪激波变得*更尖锐*、更持久，而不是消除它。声称更高的 CFL 数“直接强制执行熵不等式”是错误的。熵违背是空间离散化（通量函数）的缺陷，而不是时间积分的缺陷。\n-   **结论**：**不正确**。\n\n**E. 保持 Roe 通量不变，但增加一个带有总变差递减 (TVD) 限制器的高阶重构，或切换到高阶加权基本无振荡 (WENO) 格式；仅靠高阶无振荡重构就能确保熵可采纳性并消除跨音速稀疏波中的膨胀激波。**\n-   **诊断**：这含蓄且错误地将问题归因于重构的精度阶数。\n-   **修正方法**：高阶重构（TVD, WENO）提高了提供给每个单元界面处黎曼求解器的状态（$U_L$ 和 $U_R$）的准确性。然而，它并不改变黎曼求解器本身的逻辑。如果 Roe 求解器接收到跨越声速点的状态 $U_L$ 和 $U_R$，无论 $U_L$ 和 $U_R$ 的计算多么精确，它仍然会失效并产生非物理的通量。高阶格式只会试图更尖锐地解析由此产生的非物理膨胀激波。熵条件必须在黎曼求解器（通量函数）的层面上强制执行，而不是仅靠重构。\n-   **结论**：**不正确**。",
            "answer": "$$\\boxed{ABC}$$"
        },
        {
            "introduction": "最后的这项练习将引领我们进入非经典气体动力学这一前沿领域。当处理如范德华模型等复杂物态方程时，相变等现象可能导致激波不再遵守标准的Lax熵条件。 本练习将介绍更具普适性的Liu熵条件，并指导你从第一性原理出发，构建一个能明确满足该条件的数值通量。通过这个过程，你将学会如何针对性地开发数值方法，以精确捕捉高级流体模型中出现的复杂、非经典波结构。",
            "id": "3356172",
            "problem": "你需要从第一性原理出发，为一维可压缩欧拉方程实现一个两点数值通量。该通量通过惩罚沿雨贡纽曲线上激波速度的增加来显式地强制执行 Liu 熵条件。守恒形式的控制方程组是欧拉方程组，其状态向量为 $U = [\\rho, \\rho u, \\rho E]^{\\top}$，物理通量为 $F(U) = [\\rho u, \\rho u^{2} + p, u(\\rho E + p)]^{\\top}$。其中，$\\rho$ 是质量密度， $u$ 是速度， $E$ 是比总能， $e = E - \\tfrac{1}{2}u^{2}$ 是比内能， $p$ 是热力学压力。状态方程是一个无量纲的范德瓦尔斯型模型，其吸引力参数为 $a$，协体积参数为 $b$，由下式给出\n$$\np(\\rho,e) = \\frac{(\\gamma - 1)\\,\\rho\\, e}{1 - b\\,\\rho} - a\\,\\rho^{2},\n$$\n其定义域限制为 $\\rho  1/b$。所有量均为无量纲；报告所有数值结果时无需物理单位。\n\n连接左状态 $L$ 和右状态 $R$ 的间断处的界面激波速度 $\\sigma$ 受限于以速度 $\\sigma$ 移动的定常间断上的朗肯-雨贡纽关系：\n- 质量：$\\rho_{R}(u_{R} - \\sigma) = \\rho_{L}(u_{L} - \\sigma) = m$。\n- 动量：$p_{R} + \\rho_{R}(u_{R} - \\sigma)^{2} = p_{L} + \\rho_{L}(u_{L} - \\sigma)^{2}$。\n- 能量：$h_{R} + \\tfrac{1}{2}(u_{R} - \\sigma)^{2} = h_{L} + \\tfrac{1}{2}(u_{L} - \\sigma)^{2}$，其中 $h = e + p/\\rho$。\n\n从能量跳跃关系可以得到左右热力学状态之间的经典热力学雨贡纽关系：\n$$\ne_{R} - e_{L} + \\tfrac{1}{2}(p_{R} + p_{L})(v_{R} - v_{L}) = 0,\n$$\n其中 $v = 1/\\rho$ 是比容。对于一个给定的左状态 $(\\rho_{L}, u_{L}, p_{L})$（其内能 $e_{L}$ 由状态方程确定），以及一个选定的右密度 $\\rho_{R}$，雨贡纽关系与范德瓦尔斯状态方程共同构成一个关于 $e_{R}$ 的线性方程。记 $v_{L} = 1/\\rho_{L}$，$v_{R} = 1/\\rho_{R}$，以及 $A_{R} = (\\gamma - 1)\\rho_{R}/(1 - b\\rho_{R})$。那么\n$$\ne_{R} = \\frac{ e_{L} - \\tfrac{1}{2}\\,(p_{L} - a\\rho_{R}^{2})\\,(v_{R} - v_{L}) }{ 1 + \\tfrac{1}{2}\\,A_{R}\\,(v_{R} - v_{L}) },\n\\quad\np_{R} = A_{R}\\,e_{R} - a\\rho_{R}^{2}.\n$$\n沿雨贡纽曲线的质量通量大小由动量-质量跳跃关系的组合确定：\n$$\nm^{2} = \\frac{p_{R} - p_{L}}{v_{L} - v_{R}},\n$$\n激波速度为\n$$\n\\sigma = u_{L} - \\frac{m}{\\rho_{L}} = u_{R} - \\frac{m}{\\rho_{R}}.\n$$\n对于 $p_{R}  p_{L}$ 和 $\\rho_{R}  \\rho_{L}$ 的压缩激波，假设取 $m \\ge 0$ 的主分支。\n\nLiu 熵条件要求，从左状态到右状态的允许激波必须位于雨贡纽曲线上当远离左状态时激波速度不增加的部分。令 $\\xi \\in [0,1]$ 参数化从左状态开始的雨贡纽曲线，其中 $\\rho(\\xi) = \\rho_{L} + \\xi(\\rho_{R} - \\rho_{L})$。通过上述构造定义相应的激波速度 $\\sigma(\\xi)$。Liu 条件要求 $\\sigma(\\xi)$ 在 $\\xi$ 上是不增的。为了在数值界面通量中强制执行此条件，定义一个惩罚序列 $\\sigma_{\\text{pen}}(\\xi)$ 作为 $\\sigma(\\xi)$ 的移动最小值：\n$$\n\\sigma_{\\text{pen}}(\\xi_{k}) = \\min_{0 \\le j \\le k}\\, \\sigma(\\xi_{j}),\n$$\n对于一个离散集合 $\\{\\xi_{k}\\}_{k=0}^{N}$，其中 $\\xi_{0} = 0$ 且 $\\xi_{N} = 1$。\n\n为左状态 $U_{L}$ 和与雨贡纽关系一致的右状态 $U_{R}$ 定义两点数值通量为\n$$\nF^{\\text{pen}}(U_{L},U_{R}) = \\tfrac{1}{2}\\big(F(U_{L}) + F(U_{R})\\big) - \\tfrac{1}{2}\\, \\alpha\\, (U_{R} - U_{L}),\n$$\n其中 $\\alpha = |\\sigma_{\\text{pen}}(\\xi_{N})|$ 是惩罚后的特征速度标度。这是一个对称耗散模型，其中的特征耗散由惩罚后的激波速度设定，以满足 Liu 条件。如果在任何采样点，$\\sigma(\\xi)$ 的构造是不可允许的（例如 $m^{2} \\le 0$），则将无效样本视为非激波状态，并将耗散基于遇到的最后一个允许的 $\\sigma(\\xi)$；如果不存在允许的样本，则设 $\\alpha = 0$。\n\n你的程序必须实现以下内容：\n\n1) 给定参数 $(\\gamma,a,b)$、左状态 $(\\rho_{L},u_{L},p_{L})$ 和目标右密度 $\\rho_{R}$（其中 $\\rho_{R}  \\rho_{L}$ 且 $\\rho_{L},\\rho_{R}  1/b$），通过在 $\\xi \\in (0,1]$ 中采样 $N$ 个等距点来构造离散的雨贡纽路径，其中 $\\rho(\\xi)$ 从 $\\rho_{L}$ 到 $\\rho_{R}$ 进行线性插值。在每个采样点，根据上述关系计算 $(e_{R},p_{R})$、质量通量大小 $m$ 和激波速度 $\\sigma(\\xi)$。忽略违反可允许性（$m^{2} \\le 0$）的样本。使用 $N = 100$。\n\n2) 从允许的 $\\sigma(\\xi)$ 序列中，形成惩罚后的移动最小值序列 $\\sigma_{\\text{pen}}(\\xi)$。\n\n3) 在 $\\xi = 1$ 处使用雨贡纽关系构造右状态 $(\\rho_{R},u_{R},E_{R})$，然后以 $\\alpha = |\\sigma_{\\text{pen}}(1)|$ 形成惩罚后的数值通量 $F^{\\text{pen}}(U_{L},U_{R})$。\n\n4) 对于每个测试案例，报告：\n   - 一个布尔值，指示原始序列 $\\sigma(\\xi)$ 是否在 $\\tau = 10^{-8}$ 的容差内不增加（即，所有前向差分都 $\\le \\tau$）。\n   - 一个布尔值，指示惩罚序列 $\\sigma_{\\text{pen}}(\\xi)$ 是否在相同容差内不增加。\n   - 惩罚数值通量的质量分量，即 $F^{\\text{pen}}(U_{L},U_{R})$ 的第一个分量，四舍五入到小数点后 $6$ 位。\n\n使用以下测试套件来检验不同区域，包括经典和非经典行为：\n\n- 案例 A（类经典激波）：$(\\gamma,a,b) = (1.4, 0.5, 0.1)$，左状态 $(\\rho_{L},u_{L},p_{L}) = (0.8, 0.0, 1.0)$，右密度 $\\rho_{R} = 1.3$。\n- 案例 B（非凸区域候选）：$(\\gamma,a,b) = (1.35, 1.0, 0.25)$，左状态 $(\\rho_{L},u_{L},p_{L}) = (1.0, 0.0, 0.2)$，右密度 $\\rho_{R} = 2.4$。\n- 案例 C（接近协体积极限的边缘情况）：$(\\gamma,a,b) = (1.4, 0.8, 0.22)$，左状态 $(\\rho_{L},u_{L},p_{L}) = (1.5, 0.05, 0.5)$，右密度 $\\rho_{R} = 2.9$。\n\n你的程序应生成单行输出，其中包含三个测试案例的结果，格式为一个由方括号括起来的逗号分隔列表，每个测试案例的结果本身也是一个按上述顺序排列的列表。例如，打印的输出必须具有以下形式\n$[ [\\text{bool}_{A}, \\text{bool}_{A}^{\\text{pen}}, \\text{flux}_{A}], [\\text{bool}_{B}, \\text{bool}_{B}^{\\text{pen}}, \\text{flux}_{B}], [\\text{bool}_{C}, \\text{bool}_{C}^{\\text{pen}}, \\text{flux}_{C}] ]$\n其中布尔值应为该语言的字面布尔值，通量条目为四舍五入到小数点后 $6$ 位的十进制数。",
            "solution": "目标是在为具有范德瓦尔斯型状态方程的一维欧拉方程构造两点数值通量时，沿雨贡纽曲线强制执行 Liu 熵条件。该构造基于守恒律和经典的朗肯-雨贡纽关系，我们现在使用这些关系来推导所需的公式和算法。\n\n从守恒欧拉方程开始，其一维空间的状态向量为 $U = [\\rho,\\rho u,\\rho E]^{\\top}$，通量为 $F(U) = [\\rho u, \\rho u^{2} + p, u(\\rho E + p)]^{\\top}$。热力学通过指定的范德瓦尔斯型状态方程封闭\n$$\np(\\rho,e) = \\frac{(\\gamma - 1)\\,\\rho\\, e}{1 - b \\rho} - a \\rho^{2},\n$$\n其允许域为 $\\rho  1/b$。对于给定的 $(\\rho,p)$，我们可以反解求出 $e$：\n$$\ne = \\frac{(p + a \\rho^{2})(1 - b \\rho)}{(\\gamma - 1)\\rho}.\n$$\n\n对于以速度 $\\sigma$ 传播的间断，朗肯-雨贡纽关系表达了守恒律的积分形式：\n$$\n\\rho_{R}(u_{R} - \\sigma) = \\rho_{L}(u_{L} - \\sigma) = m,\n$$\n$$\np_{R} + \\rho_{R}(u_{R} - \\sigma)^{2} = p_{L} + \\rho_{L}(u_{L} - \\sigma)^{2},\n$$\n$$\nh_{R} + \\tfrac{1}{2}(u_{R} - \\sigma)^{2} = h_{L} + \\tfrac{1}{2}(u_{L} - \\sigma)^{2},\n$$\n其中 $h = e + p/\\rho$ 是比焓。第三个方程可以重排为不依赖于激波速度的经典热力学雨贡纽关系：\n$$\ne_{R} - e_{L} + \\tfrac{1}{2}(p_{R} + p_{L})(v_{R} - v_{L}) = 0,\\quad v = \\frac{1}{\\rho}.\n$$\n给定一个左状态 $(\\rho_{L},u_{L},p_{L})$，其内能 $e_{L}$ 由状态方程确定，我们通过选择一个候选的右密度 $\\rho_{R}$ 来参数化雨贡纽曲线，并寻找与范德瓦尔斯模型和雨贡纽关系一致的相应 $(e_{R},p_{R})$。定义\n$$\nv_{L} = \\frac{1}{\\rho_{L}},\\quad v_{R} = \\frac{1}{\\rho_{R}},\\quad A_{R} = \\frac{(\\gamma - 1)\\rho_{R}}{1 - b \\rho_{R}}.\n$$\n那么 $p_{R} = A_{R} e_{R} - a \\rho_{R}^{2}$。代入雨贡纽关系得到一个关于 $e_{R}$ 的线性方程：\n$$\ne_{R} - e_{L} + \\tfrac{1}{2}\\big(A_{R} e_{R} - a \\rho_{R}^{2} + p_{L}\\big)(v_{R} - v_{L}) = 0,\n$$\n可以显式解出 $e_{R}$：\n$$\ne_{R} = \\frac{ e_{L} - \\tfrac{1}{2}(p_{L} - a \\rho_{R}^{2})(v_{R} - v_{L}) }{ 1 + \\tfrac{1}{2} A_{R}(v_{R} - v_{L}) }.\n$$\n一旦获得 $e_{R}$，$p_{R}$ 就直接从状态方程得出。动量和质量跳跃关系可以组合起来，得到质量通量平方的公式：\n$$\nm^{2} = \\frac{p_{R} - p_{L}}{v_{L} - v_{R}}.\n$$\n对于 $\\rho_{R}  \\rho_{L}$ 且通常 $p_{R}  p_{L}$ 的压缩激波，我们有 $v_{R}  v_{L}$，因此 $m^{2}  0$。选择 $m \\ge 0$ 的主分支将激波速度定义为\n$$\n\\sigma = u_{L} - \\frac{m}{\\rho_{L}}.\n$$\n然后右侧速度可由质量和动量跳跃关系得出\n$$\nu_{R} = u_{L} + \\frac{p_{L} - p_{R}}{m},\n$$\n右侧总能量为 $E_{R} = e_{R} + \\tfrac{1}{2} u_{R}^{2}$。\n\nLiu 熵条件指出，沿着由 $\\xi \\in [0,1]$ 参数化的雨贡纽路径，其中 $\\rho(\\xi) = \\rho_{L} + \\xi(\\rho_{R} - \\rho_{L})$，允许的激波必须位于激波速度 $\\sigma(\\xi)$ 对 $\\xi$ 不增的部分。在数值上，我们将 $\\xi$ 离散为 $N$ 个均匀样本 $\\{\\xi_{k}\\}_{k=1}^{N}$，并在所有允许的点（即 $m^{2}(\\xi_{k})  0$ 的点）计算 $\\sigma(\\xi_{k})$。为强制执行 Liu 条件，我们定义一个惩罚序列 $\\sigma_{\\text{pen}}(\\xi_{k})$ 作为移动最小值：\n$$\n\\sigma_{\\text{pen}}(\\xi_{k}) = \\min\\{\\sigma(\\xi_{1}), \\sigma(\\xi_{2}), \\ldots, \\sigma(\\xi_{k})\\}.\n$$\n根据定义，这种构造确保了 $\\sigma_{\\text{pen}}(\\xi_{k})$ 是不增的。\n\n然后我们使用界面处的惩罚激波速度 $\\alpha = |\\sigma_{\\text{pen}}(\\xi_{N})|$，作为对称两点数值通量中的特征耗散标度：\n$$\nF^{\\text{pen}}(U_{L},U_{R}) = \\tfrac{1}{2}\\big(F(U_{L}) + F(U_{R})\\big) - \\tfrac{1}{2}\\,\\alpha\\,(U_{R} - U_{L}).\n$$\n这类似于 Rusanov（局部 Lax–Friedrichs）通量，但其耗散标度与满足 Liu 条件的激波速度相关，而不是最大特征波速；因此，它通过裁剪到移动最小值来惩罚 $\\sigma(\\xi)$ 的任何增加，从而遵守 Liu 条件。如果在采样期间未找到允许的激波（即，所有激波的 $m^{2} \\le 0$），我们设置 $\\alpha = 0$，此时通量对于该界面简化为中心通量。\n\n每个测试案例的算法步骤如下：\n\n1) 根据 $(\\rho_{L},p_{L})$ 使用 $e_{L} = \\big(p_{L} + a \\rho_{L}^{2}\\big)\\big(1 - b \\rho_{L}\\big)\\big/\\big((\\gamma - 1)\\rho_{L}\\big)$ 计算 $e_{L}$，以及 $E_{L} = e_{L} + \\tfrac{1}{2}u_{L}^{2}$。构成 $U_{L} = [\\rho_{L}, \\rho_{L} u_{L}, \\rho_{L} E_{L}]^{\\top}$。\n\n2) 对于 $k = 1,\\ldots,N$，采样 $\\xi_{k} = k/N$（其中 $N = 100$），并设置 $\\rho(\\xi_{k}) = \\rho_{L} + \\xi_{k}(\\rho_{R} - \\rho_{L})$。对于每个样本：\n   - 计算 $v_{L}, v(\\xi_{k}), A(\\xi_{k})$。\n   - 从线性雨贡纽关系计算 $e(\\xi_{k})$，并从状态方程计算 $p(\\xi_{k})$。\n   - 计算 $m^{2}(\\xi_{k}) = \\big(p(\\xi_{k}) - p_{L}\\big)\\big/\\big(v_{L} - v(\\xi_{k})\\big)$。如果 $m^{2}(\\xi_{k}) \\le 0$，则将该样本标记为无效，并将其从激波速度序列中排除。\n   - 否则，设置 $m(\\xi_{k}) = \\sqrt{m^{2}(\\xi_{k})}$ 和 $\\sigma(\\xi_{k}) = u_{L} - m(\\xi_{k})/\\rho_{L}$。\n\n3) 在有效的激波速度 $\\{\\sigma(\\xi_{k})\\}$ 上，形成移动最小值序列 $\\{\\sigma_{\\text{pen}}(\\xi_{k})\\}$。如果所有前向差分都 $\\le \\tau$（容差 $\\tau = 10^{-8}$），则定义原始序列为不增的。根据构造，惩罚序列是不增的。\n\n4) 在 $\\xi_{N} = 1$ 处，构建右状态如下：计算 $e_{R}, p_{R}, m$，然后 $u_{R} = u_{L} + (p_{L} - p_{R})/m$ 和 $E_{R} = e_{R} + \\tfrac{1}{2}u_{R}^{2}$。构成 $U_{R} = [\\rho_{R}, \\rho_{R} u_{R}, \\rho_{R} E_{R}]^{\\top}$。\n\n5) 如果最终样本是允许的，则计算 $\\alpha = |\\sigma_{\\text{pen}}(\\xi_{N})|$；否则取最后一个允许样本的 $\\sigma_{\\text{pen}}$；如果没有允许的样本，则设置 $\\alpha = 0$。\n\n6) 计算 $F^{\\text{pen}}(U_{L},U_{R})$ 并报告其第一个分量（四舍五入到小数点后 6 位），以及检查原始序列和惩罚序列不增行为的两个布尔值。\n\n测试套件包含三个案例，旨在探测不同区域：一个类经典压缩激波，其中气体响应接近凸性；一个非凸区域候选，具有较大的吸引力参数和协体积参数，可能出现非经典行为；以及一个接近协体积极限的边缘案例，用于测试可允许性和鲁棒性。对于每个案例，我们提供 $(\\gamma,a,b)$、$(\\rho_{L},u_{L},p_{L})$ 和 $\\rho_{R}$，所有量均为无量纲，并要求程序按指定格式输出单行，其中包含三个三元组 $[ \\text{raw\\_nonincreasing}, \\text{penalized\\_nonincreasing}, \\text{mass\\_flux} ]$ 的列表。",
            "answer": "```python\nimport numpy as np\n\ndef eos_pressure(rho, e, gamma, a, b):\n    # p = ((gamma - 1) * rho * e) / (1 - b*rho) - a*rho^2\n    return ((gamma - 1.0) * rho * e) / (1.0 - b * rho) - a * rho * rho\n\ndef eos_internal_energy_from_p(rho, p, gamma, a, b):\n    # Invert p = ((gamma - 1) * rho * e) / (1 - b*rho) - a*rho^2 for e\n    # e = ( (p + a rho^2) (1 - b rho) ) / ( (gamma - 1) rho )\n    return ((p + a * rho * rho) * (1.0 - b * rho)) / ((gamma - 1.0) * rho)\n\ndef flux(U, p):\n    rho, mom, E_tot_vol = U\n    u = mom / rho\n    return np.array([mom, mom * u + p, u * (E_tot_vol + p)])\n\ndef hugoniot_right_state_from_density(rhoL, uL, pL, rhoR, gamma, a, b):\n    # Compute eL, then solve Hugoniot relation for eR and pR at given rhoR\n    vL = 1.0 / rhoL\n    vR = 1.0 / rhoR\n    # Check domain of EOS\n    if rhoL = 1.0 / b or rhoR = 1.0 / b:\n        return None  # invalid due to co-volume limit\n    eL = eos_internal_energy_from_p(rhoL, pL, gamma, a, b)\n    AR = (gamma - 1.0) * rhoR / (1.0 - b * rhoR)\n    denom = 1.0 + 0.5 * AR * (vR - vL)\n    # Avoid division by zero in degenerate Hugoniot denominator\n    if np.isclose(denom, 0.0):\n        return None\n    eR = (eL - 0.5 * (pL - a * rhoR * rhoR) * (vR - vL)) / denom\n    pR = eos_pressure(rhoR, eR, gamma, a, b)\n    # Compute mass flux squared\n    denom_m2 = (vL - vR)\n    if np.isclose(denom_m2, 0.0):\n        return None\n    m2 = (pR - pL) / denom_m2\n    if m2 = 0.0 or not np.isfinite(m2):\n        return None\n    m = np.sqrt(m2)\n    # Shock speed\n    s = uL - m / rhoL\n    # Right velocity from momentum/mass RH relations\n    uR = uL + (pL - pR) / m\n    ER = eR + 0.5 * uR * uR\n    return {\n        \"rhoR\": rhoR,\n        \"uR\": uR,\n        \"eR\": eR,\n        \"ER\": ER,\n        \"pR\": pR,\n        \"m\": m,\n        \"s\": s\n    }\n\ndef build_sigma_sequence(rhoL, uL, pL, rhoR, gamma, a, b, N=100):\n    # Sample densities along the Hugoniot from rhoL to rhoR\n    sigmas = []\n    rhos = []\n    last_valid = None\n    for k in range(1, N + 1):\n        xi = k / N\n        rho_k = rhoL + xi * (rhoR - rhoL)\n        st = hugoniot_right_state_from_density(rhoL, uL, pL, rho_k, gamma, a, b)\n        if st is not None:\n            sigmas.append(st[\"s\"])\n            rhos.append(rho_k)\n            last_valid = st\n    return np.array(sigmas), np.array(rhos), last_valid\n\ndef running_minimum(arr):\n    if arr.size == 0:\n        return arr\n    out = np.empty_like(arr)\n    current = arr[0]\n    out[0] = current\n    for i in range(1, arr.size):\n        if arr[i]  current:\n            current = arr[i]\n        out[i] = current\n    return out\n\ndef is_nonincreasing(arr, tol=1e-8):\n    if arr.size = 1:\n        return True\n    diffs = np.diff(arr)\n    return np.all(diffs = tol)\n\ndef penalized_flux(gamma, a, b, rhoL, uL, pL, rhoR, N=100, tol=1e-8):\n    # Build left state\n    eL = eos_internal_energy_from_p(rhoL, pL, gamma, a, b)\n    EL = eL + 0.5 * uL * uL\n    UL = np.array([rhoL, rhoL * uL, rhoL * EL])\n    FL = flux(UL, pL)\n\n    # Build sigma sequence along Hugoniot\n    sigmas, rhos, last_valid = build_sigma_sequence(rhoL, uL, pL, rhoR, gamma, a, b, N=N)\n    raw_noninc = is_nonincreasing(sigmas, tol=tol)\n    sigmas_pen = running_minimum(sigmas)\n    pen_noninc = is_nonincreasing(sigmas_pen, tol=tol)\n\n    # Construct right state at target density\n    final_state = hugoniot_right_state_from_density(rhoL, uL, pL, rhoR, gamma, a, b)\n    if final_state is None:\n        # If target is invalid, fall back to last valid if available\n        final_state = last_valid\n\n    if final_state is None:\n        # No admissible shock samples: use central flux\n        FR = FL.copy()\n        alpha = 0.0\n        UR = UL.copy()\n    else:\n        rhoR_eff = final_state[\"rhoR\"]\n        uR = final_state[\"uR\"]\n        ER = final_state[\"ER\"]\n        pR = final_state[\"pR\"]\n        UR = np.array([rhoR_eff, rhoR_eff * uR, rhoR_eff * ER])\n        FR = flux(UR, pR)\n        # Choose alpha from penalized sigma at the last admissible sample\n        if sigmas_pen.size  0:\n            alpha = abs(sigmas_pen[-1])\n        else:\n            alpha = abs(final_state[\"s\"])\n\n    # Symmetric dissipative flux with Liu-penalized alpha\n    Fpen = 0.5 * (FL + FR) - 0.5 * alpha * (UR - UL)\n    return raw_noninc, pen_noninc, float(Fpen[0])\n\ndef solve():\n    # Define test cases: (gamma, a, b, rhoL, uL, pL, rhoR)\n    test_cases = [\n        (1.4, 0.5, 0.1, 0.8, 0.0, 1.0, 1.3),   # Case A\n        (1.35, 1.0, 0.25, 1.0, 0.0, 0.2, 2.4), # Case B\n        (1.4, 0.8, 0.22, 1.5, 0.05, 0.5, 2.9), # Case C\n    ]\n\n    results = []\n    for (gamma, a, b, rhoL, uL, pL, rhoR) in test_cases:\n        raw_noninc, pen_noninc, mass_flux = penalized_flux(\n            gamma, a, b, rhoL, uL, pL, rhoR, N=100, tol=1e-8\n        )\n        results.append([bool(raw_noninc), bool(pen_noninc), round(mass_flux, 6)])\n\n    # Final print statement in the exact required format.\n    # Use Python literals for booleans and floats inside a list of lists.\n    print(str(results).replace(\" \", \"\"))\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}