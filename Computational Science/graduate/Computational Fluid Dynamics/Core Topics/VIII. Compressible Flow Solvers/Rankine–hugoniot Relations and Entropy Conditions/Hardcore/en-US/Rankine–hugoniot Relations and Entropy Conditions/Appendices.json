{
    "hands_on_practices": [
        {
            "introduction": "The journey into the mathematics of shock waves begins with the simplest case: the scalar conservation law. This fundamental exercise guides you through the process of deriving the Rankine-Hugoniot jump condition directly from the integral form of the conservation law, a cornerstone skill for analyzing discontinuities. It then challenges you to apply the essential entropy condition to distinguish the single, physically valid shock from the infinite family of weak solutions, highlighting why this criterion is indispensable for uniqueness .",
            "id": "3356128",
            "problem": "Consider the scalar conservation law $u_{t} + f(u)_{x} = 0$ on $\\mathbb{R} \\times (0,\\infty)$ with a piecewise constant weak solution having a single moving discontinuity, modeled as $u(x,t) = u_{L}\\,\\mathbf{1}_{\\{x  s(t)\\}} + u_{R}\\,\\mathbf{1}_{\\{x  s(t)\\}}$ for a Lipschitz continuous trajectory $s(t)$. The flux is given by $f(u) = u^{3} - 3u$, and the Riemann data are $u_{L} = 2$ and $u_{R} = 0$. \n\n1) Starting only from the integral form of conservation over a space-time control volume that straddles the discontinuity and from the assumption that $u$ is a weak solution, derive the jump condition that links the shock speed $s'(t)$ to the traces $u_{L}$, $u_{R}$ and the corresponding flux values.\n\n2) Evaluate the shock speed $s'(t)$ for the given flux and states. Provide your final answer as an exact number.\n\n3) Explain the entropy admissibility criteria for scalar conservation laws that select physical discontinuities among all weak solutions, and state conditions under which the shock speed obtained in part 2 is the unique speed compatible with an entropy solution. In particular, assess whether the shock from $u_{L} = 2$ to $u_{R} = 0$ satisfies the standard admissibility condition based on characteristic compression.\n\nExpress the final answer to part 2 as an exact number with no rounding and no units required.",
            "solution": "The problem is subjected to validation before a solution is attempted.\n\n### Step 1: Extract Givens\n-   **Governing Equation**: The scalar conservation law is $u_{t} + f(u)_{x} = 0$ on the domain $\\mathbb{R} \\times (0,\\infty)$.\n-   **Flux Function**: The flux is given by $f(u) = u^{3} - 3u$.\n-   **Solution Structure**: The weak solution has a single moving discontinuity, described by $u(x,t) = u_{L}\\,\\mathbf{1}_{\\{x  s(t)\\}} + u_{R}\\,\\mathbf{1}_{\\{x  s(t)\\}}$.\n-   **Discontinuity Path**: The path of the discontinuity, $s(t)$, is a Lipschitz continuous function.\n-   **Riemann Data**: The constant states are $u_{L} = 2$ and $u_{R} = 0$.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientifically Grounded**: The problem is a standard exercise in the mathematical theory of hyperbolic partial differential equations, specifically focusing on scalar conservation laws, Rankine–Hugoniot conditions, and entropy solutions. These are foundational concepts in computational fluid dynamics and continuum mechanics. The problem is scientifically and mathematically sound.\n2.  **Well-Posed**: The problem is a Riemann problem for a scalar conservation law. The existence and uniqueness of a physically relevant (entropy) solution for such problems are well-established by the work of Oleinik and Kružkov. The problem is well-posed in this context.\n3.  **Objective**: The problem is stated using precise mathematical language and definitions. All quantities are unambiguously defined.\n4.  **Incomplete or Contradictory Setup**: The problem provides all necessary information: the PDE, the flux function, the initial states, and the presumed structure of the solution. There are no contradictions.\n5.  **Unrealistic or Infeasible**: The problem is a theoretical model and does not claim to represent a specific physical system with measured data. Its components are mathematically consistent.\n6.  **Ill-Posed or Poorly Structured**: The problem is well-structured and leads to a unique, meaningful solution under the standard framework of entropy solutions.\n7.  **Pseudo-Profound, Trivial, or Tautological**: The problem requires a standard but non-trivial derivation, calculation, and conceptual explanation, testing fundamental knowledge of the topic.\n8.  **Outside Scientific Verifiability**: The problem is a mathematical construct and is entirely verifiable through logical deduction and established mathematical theory.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. A complete solution will be provided.\n\n***\n\n### Part 1: Derivation of the Rankine–Hugoniot Jump Condition\n\nThe conservation law $u_{t} + f(u)_{x} = 0$ can be written in integral form. For any control volume $[x_{1}, x_{2}]$ in space, the rate of change of the total amount of the conserved quantity $u$ is equal to the net flux across the boundaries:\n$$\n\\frac{d}{dt} \\int_{x_{1}}^{x_{2}} u(x,t) \\,dx = f(u(x_{1}, t)) - f(u(x_{2}, t))\n$$\nThis form holds for smooth solutions. For a weak solution with a discontinuity at $x=s(t)$, we must apply this principle carefully.\n\nLet us consider a control volume $[x_{1}, x_{2}]$ that is fixed in space and contains the shock at all times $t$ of interest, i.e., $x_{1}  s(t)  x_{2}$. The solution is given as $u(x,t) = u_{L}$ for $x  s(t)$ and $u(x,t) = u_{R}$ for $x  s(t)$.\n\nThe integral on the left-hand side can be split at the discontinuity:\n$$\n\\int_{x_{1}}^{x_{2}} u(x,t) \\,dx = \\int_{x_{1}}^{s(t)} u_{L} \\,dx + \\int_{s(t)}^{x_{2}} u_{R} \\,dx = u_{L} (s(t) - x_{1}) + u_{R} (x_{2} - s(t))\n$$\nNow, we differentiate this expression with respect to time $t$. Since $x_{1}$, $x_{2}$, $u_{L}$, and $u_{R}$ are constants, we use the chain rule for $s(t)$, denoting its derivative as $s'(t)$:\n$$\n\\frac{d}{dt} \\int_{x_{1}}^{x_{2}} u(x,t) \\,dx = \\frac{d}{dt} [u_{L} s(t) - u_{L} x_{1} + u_{R} x_{2} - u_{R} s(t)] = u_{L} s'(t) - u_{R} s'(t) = s'(t)(u_{L} - u_{R})\n$$\nThe right-hand side of the integral form involves the fluxes at the boundaries $x_{1}$ and $x_{2}$. Since $x_{1}  s(t)$ and $x_{2}  s(t)$, we have $u(x_{1}, t) = u_{L}$ and $u(x_{2}, t) = u_{R}$. The flux term is therefore:\n$$\nf(u(x_{1}, t)) - f(u(x_{2}, t)) = f(u_{L}) - f(u_{R})\n$$\nEquating the two expressions, we obtain:\n$$\ns'(t)(u_{L} - u_{R}) = f(u_{L}) - f(u_{R})\n$$\nThis is the Rankine–Hugoniot jump condition. It relates the speed of the discontinuity, $s'(t)$, to the states $u_{L}$, $u_{R}$ on either side and the corresponding flux values. The speed, often denoted by $s$, is given by:\n$$\ns'(t) = \\frac{f(u_{L}) - f(u_{R})}{u_{L} - u_{R}} = \\frac{[f]}{[u]}\n$$\nwhere $[q] = q_L - q_R$ denotes the jump in a quantity $q$ across the discontinuity.\n\n### Part 2: Evaluation of the Shock Speed\n\nWe are given the flux function $f(u) = u^{3} - 3u$ and the Riemann data $u_{L} = 2$ and $u_{R} = 0$. We apply the Rankine–Hugoniot condition derived in Part 1.\n\nFirst, we evaluate the flux at the left and right states:\n-   For $u_{L} = 2$: $f(u_{L}) = f(2) = 2^{3} - 3(2) = 8 - 6 = 2$.\n-   For $u_{R} = 0$: $f(u_{R}) = f(0) = 0^{3} - 3(0) = 0$.\n\nNext, we calculate the jumps in flux and state:\n-   Jump in flux: $[f] = f(u_{L}) - f(u_{R}) = 2 - 0 = 2$.\n-   Jump in state: $[u] = u_{L} - u_{R} = 2 - 0 = 2$.\n\nThe shock speed $s'(t)$ is the ratio of these jumps:\n$$\ns'(t) = \\frac{f(u_{L}) - f(u_{R})}{u_{L} - u_{R}} = \\frac{2}{2} = 1\n$$\nThe shock speed is constant, $s'(t) = 1$.\n\n### Part 3: Entropy Admissibility criteria\n\nWeak solutions to conservation laws are not necessarily unique. An additional criterion, known as an entropy condition, is required to select the physically correct solution. For scalar conservation laws, this condition ensures that information, carried along characteristics, flows into the shock discontinuity, rather than emanating from it. A shock front represents an irreversible process where information is lost, which is analogous to the increase of entropy in thermodynamic systems.\n\nThe speed of propagation of information, or the characteristic speed, is given by $c(u) = f'(u)$. For the given flux $f(u) = u^{3} - 3u$, the characteristic speed is:\n$$\nc(u) = f'(u) = \\frac{d}{du}(u^{3} - 3u) = 3u^{2} - 3\n$$\nThe standard admissibility condition for a shock, known as the Lax entropy condition, requires that the characteristic speed on the left of the shock be greater than the shock speed, which in turn must be greater than the characteristic speed on the right. This \"characteristic compression\" is formulated as:\n$$\nf'(u_{L})  s'(t)  f'(u_{R})\n$$\nLet's assess this condition for the given problem. We have $u_{L} = 2$, $u_{R} = 0$, and we found $s'(t) = 1$. We calculate the characteristic speeds at the left and right states:\n-   $c(u_{L}) = f'(u_{L}) = f'(2) = 3(2)^{2} - 3 = 3(4) - 3 = 12 - 3 = 9$.\n-   $c(u_{R}) = f'(u_{R}) = f'(0) = 3(0)^{2} - 3 = 0 - 3 = -3$.\n\nSubstituting these values into the Lax entropy inequality:\n$$\n9  1  -3\n$$\nThis inequality is true. Therefore, the shock connecting $u_{L}=2$ to $u_{R}=0$ with speed $s'=1$ satisfies the Lax entropy condition and is an admissible, physical shock.\n\nThe uniqueness of this shock solution for the given Riemann problem stems from the general theory of entropy solutions (e.g., Kružkov's theory). This theory guarantees a unique entropy-satisfying solution. When the Lax condition holds for a discontinuity, that shock is the correct building block of the unique entropy solution.\n\nIt is worth noting that the flux function $f(u) = u^{3} - 3u$ is non-convex, as its second derivative $f''(u) = 6u$ changes sign. For non-convex fluxes, the more general Oleinik entropy condition is required. This condition states that the line segment (chord) connecting the points $(u_{L}, f(u_{L}))$ and $(u_{R}, f(u_{R}))$ on the flux graph must lie on one side of the graph of $f(u)$ for all $u$ between $u_{L}$ and $u_{R}$. For our case, with $u_{L}u_{R}$, the chord must lie above the flux graph. The chord connects $(0,0)$ and $(2,2)$ and has equation $y(u)=u$. The condition is $f(u) \\le u$ for $u \\in [0, 2]$. This is equivalent to $u^{3} - 3u \\le u$, or $u^{3} - 4u \\le 0$. Factoring gives $u(u-2)(u+2) \\le 0$. For $u \\in (0,2)$, this expression is negative, and it is zero at the endpoints, so the condition holds. Thus, the shock is admissible even under this more stringent, general condition.",
            "answer": "$$\\boxed{1}$$"
        },
        {
            "introduction": "Building on the scalar case, we now apply our understanding to a tangible physical system governed by the Euler equations. This practice involves deriving the relations for a piston-driven shock wave from the first principles of mass, momentum, and energy conservation. The problem then advances to a sophisticated and practical application: quantifying how uncertainty in a fundamental fluid property, the ratio of specific heats $\\gamma$, impacts the predicted shock speed, a crucial skill in modern engineering and scientific modeling .",
            "id": "3356163",
            "problem": "A planar normal shock is driven into a quiescent ideal gas by a rigid piston. The upstream gas (state $1$) is initially at rest with pressure $p_1 = 1.00 \\times 10^5\\,\\mathrm{Pa}$ and density $\\rho_1 = 1.225\\,\\mathrm{kg/m^3}$. At time scales of interest the piston moves steadily at speed $u_p = 300\\,\\mathrm{m/s}$ into the gas, and a single, steady, planar shock propagates into the undisturbed gas with laboratory-frame speed $S$. The working fluid obeys the ideal-gas Equation of State (EOS) with constant but uncertain specific-heat ratio $\\gamma$; treat all other quantities as known and deterministic. Assume the physically admissible (entropy-increasing) shock.\n\nStarting only from one-dimensional conservation of mass, momentum, and energy across a discontinuity in the shock-attached frame, and the ideal-gas enthalpy relation $h = \\gamma p/[(\\gamma - 1)\\rho]$, proceed as follows.\n\n1. Derive a single implicit equation $F(S,\\gamma)=0$ that relates the shock speed $S$ and the EOS parameter $\\gamma$ for this piston-driven configuration, expressed in terms of the given upstream data $(p_1,\\rho_1)$ and piston speed $u_p$.\n2. Using implicit differentiation of your $F(S,\\gamma)=0$, obtain the linearized sensitivity $\\partial S / \\partial \\gamma$ evaluated at the nominal value $\\gamma_0 = 1.40$. In this evaluation, use the corresponding shock speed $S(\\gamma_0)$ implied by your implicit equation.\n3. Suppose the standard uncertainty in $\\gamma$ is $\\sigma_\\gamma = 0.020$. Using first-order uncertainty propagation, estimate the standard uncertainty in the shock speed as $\\sigma_S \\approx \\left|\\left.\\partial S/\\partial \\gamma\\right|_{\\gamma_0}\\right| \\,\\sigma_\\gamma$.\n\nExpress the final numerical value of $\\sigma_S$ in $\\mathrm{m/s}$ and round your answer to three significant figures. Do not use any pre-tabulated normal-shock formulas; derive your relations from the conservation laws and the ideal-gas model. Clearly state any physical admissibility checks you use to select the correct shock solution consistent with the entropy condition. The final answer must be a single real number.",
            "solution": "The problem requires the derivation of the sensitivity of a piston-driven shock's speed, $S$, to the specific-heat ratio, $\\gamma$, of the gas, starting from first principles.\n\nThe solution proceeds in three main parts:\n1. Derivation of an implicit equation relating the shock speed $S$ and the specific-heat ratio $\\gamma$.\n2. Calculation of the linearized sensitivity $\\partial S / \\partial \\gamma$ at a nominal value $\\gamma_0$.\n3. Estimation of the uncertainty in the shock speed, $\\sigma_S$, based on the uncertainty in $\\gamma$.\n\nWe are given the upstream quiescent state (state $1$) with pressure $p_1 = 1.00 \\times 10^5\\,\\mathrm{Pa}$ and density $\\rho_1 = 1.225\\,\\mathrm{kg/m^3}$. The gas is initially at rest, so its velocity in the laboratory frame is $u_1 = 0$. A piston moves into this gas at a constant speed $u_p = 300\\,\\mathrm{m/s}$, driving a planar normal shock with a laboratory-frame speed $S$. The gas behind the shock (state $2$) is brought to the piston's speed, so $u_2 = u_p$. The gas is ideal, with enthalpy given by $h = \\gamma p / ((\\gamma - 1)\\rho)$.\n\nThe problem must be solved in a frame of reference attached to the shock, where the shock is stationary. The velocities in this shock-attached frame, denoted with a prime, are related to the lab-frame velocities by $u' = u - S$.\nThe upstream gas velocity is $u'_1 = u_1 - S = 0 - S = -S$.\nThe downstream gas velocity is $u'_2 = u_2 - S = u_p - S$.\n\nThe Rankine–Hugoniot relations, which express the conservation of mass, momentum, and energy across the stationary shock, are:\n1. Conservation of mass: $\\rho_1 u'_1 = \\rho_2 u'_2$\n$$ \\rho_1 (-S) = \\rho_2 (u_p - S) \\implies \\rho_1 S = \\rho_2 (S - u_p) \\quad (1) $$\n2. Conservation of momentum: $p_1 + \\rho_1 (u'_1)^2 = p_2 + \\rho_2 (u'_2)^2$\n$$ p_1 + \\rho_1 S^2 = p_2 + \\rho_2 (u_p - S)^2 \\quad (2) $$\n3. Conservation of energy: $h_1 + \\frac{1}{2}(u'_1)^2 = h_2 + \\frac{1}{2}(u'_2)^2$\n$$ h_1 + \\frac{1}{2} S^2 = h_2 + \\frac{1}{2} (u_p - S)^2 \\quad (3) $$\n\nOur first goal is to derive a single equation $F(S, \\gamma) = 0$ by eliminating the unknown downstream state variables $p_2$ and $\\rho_2$.\n\nFrom the mass conservation equation (1), we can express $\\rho_2$ in terms of $\\rho_1$ and the velocities:\n$$ \\rho_2 = \\rho_1 \\frac{S}{S - u_p} \\quad (4) $$\nFor a compressive shock, we must have $\\rho_2 > \\rho_1$. Since $S > 0$ for a shock moving into the gas, this implies $S - u_p > 0$, so $S > u_p$.\n\nNext, we rearrange the momentum equation (2) to solve for $p_2$:\n$p_2 = p_1 + \\rho_1 S^2 - \\rho_2 (S - u_p)^2$.\nSubstitute $\\rho_2$ from (4):\n$p_2 = p_1 + \\rho_1 S^2 - \\left(\\rho_1 \\frac{S}{S - u_p}\\right) (S-u_p)^2 = p_1 + \\rho_1 S^2 - \\rho_1 S (S - u_p)$.\n$p_2 = p_1 + \\rho_1 S^2 - \\rho_1 S^2 + \\rho_1 S u_p$.\n$$ p_2 = p_1 + \\rho_1 S u_p \\quad (5) $$\n\nNow, we use the energy equation (3). Rearranging it gives:\n$h_2 - h_1 = \\frac{1}{2} (S^2 - (u_p-S)^2) = \\frac{1}{2} (S^2 - (S^2 - 2Su_p + u_p^2)) = S u_p - \\frac{1}{2} u_p^2$.\nUsing the ideal gas enthalpy relation $h = \\gamma p / ((\\gamma - 1)\\rho)$:\n$h_2 - h_1 = \\frac{\\gamma}{\\gamma - 1} \\left(\\frac{p_2}{\\rho_2} - \\frac{p_1}{\\rho_1}\\right)$.\nEquating the two expressions for $h_2 - h_1$:\n$$ \\frac{\\gamma}{\\gamma - 1} \\left(\\frac{p_2}{\\rho_2} - \\frac{p_1}{\\rho_1}\\right) = S u_p - \\frac{1}{2} u_p^2 \\quad (6) $$\nSubstitute $p_2$ from (5) and $\\rho_2$ from (4) into equation (6):\n$\\frac{p_2}{\\rho_2} = \\frac{p_1 + \\rho_1 S u_p}{\\rho_1 S / (S - u_p)} = \\frac{(p_1 + \\rho_1 S u_p)(S - u_p)}{\\rho_1 S}$.\nSubstituting this into (6):\n$\\frac{\\gamma}{\\gamma - 1} \\left( \\frac{(p_1 + \\rho_1 S u_p)(S - u_p)}{\\rho_1 S} - \\frac{p_1}{\\rho_1} \\right) = S u_p - \\frac{1}{2} u_p^2$.\n$\\frac{\\gamma}{(\\gamma - 1)\\rho_1} \\left( \\frac{p_1 S - p_1 u_p + \\rho_1 S^2 u_p - \\rho_1 S u_p^2 - p_1 S}{S} \\right) = S u_p - \\frac{1}{2} u_p^2$.\n$\\frac{\\gamma}{(\\gamma - 1)\\rho_1} \\frac{-p_1 u_p + \\rho_1 u_p S^2 - \\rho_1 u_p S u_p}{S} = u_p \\left(S - \\frac{u_p}{2}\\right)$.\nSince $u_p \\neq 0$, we can divide both sides by $u_p$:\n$\\frac{\\gamma}{(\\gamma - 1)\\rho_1 S} (-p_1 + \\rho_1 S^2 - \\rho_1 S u_p) = S - \\frac{u_p}{2}$.\n$\\frac{\\gamma}{\\gamma - 1} (S - u_p - \\frac{p_1}{\\rho_1 S}) = S - \\frac{u_p}{2}$.\n$\\frac{\\gamma(S - u_p)}{\\gamma - 1} - \\frac{\\gamma p_1}{(\\gamma - 1)\\rho_1 S} = S - \\frac{u_p}{2}$.\nRearranging terms to solve for the $p_1$ term:\n$\\frac{\\gamma(S - u_p)}{\\gamma - 1} - (S - \\frac{u_p}{2}) = \\frac{\\gamma p_1}{(\\gamma - 1)\\rho_1 S}$.\n$\\frac{\\gamma S - \\gamma u_p - (\\gamma-1)(S - u_p/2)}{\\gamma-1} = \\frac{\\gamma p_1}{(\\gamma-1)\\rho_1 S}$.\n$\\frac{\\gamma S - \\gamma u_p - \\gamma S + \\gamma u_p/2 + S - u_p/2}{\\gamma-1} = \\frac{\\gamma p_1}{(\\gamma-1)\\rho_1 S}$.\n$\\frac{S - (\\gamma/2)u_p - u_p/2}{\\gamma-1} = \\frac{\\gamma p_1}{(\\gamma-1)\\rho_1 S}$.\n$S - \\frac{\\gamma + 1}{2}u_p = \\frac{\\gamma p_1}{\\rho_1 S}$.\n$S^2 - \\frac{\\gamma + 1}{2} u_p S - \\frac{\\gamma p_1}{\\rho_1} = 0$.\nThis is the required implicit equation $F(S, \\gamma) = 0$. For convenience, we can multiply by $2\\rho_1$:\n$$ F(S, \\gamma) = 2\\rho_1 S^2 - (\\gamma+1)\\rho_1 u_p S - 2\\gamma p_1 = 0 \\quad (7) $$\nThis is a quadratic equation for $S$. The physically admissible solution must satisfy $S0$ and $Su_p$. The solution is:\n$S = \\frac{(\\gamma+1)\\rho_1 u_p \\pm \\sqrt{((\\gamma+1)\\rho_1 u_p)^2 - 4(2\\rho_1)(-2\\gamma p_1)}}{4\\rho_1} = \\frac{(\\gamma+1)u_p}{4} \\pm \\sqrt{\\left(\\frac{(\\gamma+1)u_p}{4}\\right)^2 + \\frac{\\gamma p_1}{\\rho_1}}$.\nThe term under the square root is positive. To ensure $S0$, we must take the positive root. This choice also ensures $S  u_p$, as required for a compressive shock, since $\\sqrt{\\left(\\frac{(\\gamma+1)u_p}{4}\\right)^2 + \\frac{\\gamma p_1}{\\rho_1}}  \\frac{(\\gamma+1)u_p}{4}$, which implies $S  2\\frac{(\\gamma+1)u_p}{4} = \\frac{\\gamma+1}{2}u_p$. For $\\gamma1$, this means $Su_p$.\n\nNext, we find the sensitivity $\\partial S / \\partial \\gamma$ by implicit differentiation of $F(S, \\gamma) = 0$.\n$\\frac{dF}{d\\gamma} = \\frac{\\partial F}{\\partial S}\\frac{\\partial S}{\\partial \\gamma} + \\frac{\\partial F}{\\partial \\gamma} = 0 \\implies \\frac{\\partial S}{\\partial \\gamma} = -\\frac{\\partial F / \\partial \\gamma}{\\partial F / \\partial S}$.\nThe partial derivatives of $F(S, \\gamma)$ from (7) are:\n$\\frac{\\partial F}{\\partial S} = 4\\rho_1 S - (\\gamma+1)\\rho_1 u_p$.\n$\\frac{\\partial F}{\\partial \\gamma} = - \\rho_1 u_p S - 2p_1$.\nSo, the sensitivity is:\n$$ \\frac{\\partial S}{\\partial \\gamma} = - \\frac{-\\rho_1 u_p S - 2p_1}{4\\rho_1 S - (\\gamma+1)\\rho_1 u_p} = \\frac{\\rho_1 u_p S + 2p_1}{4\\rho_1 S - (\\gamma+1)\\rho_1 u_p} $$\nTo evaluate this, we first need to find the shock speed $S_0$ for the nominal value $\\gamma_0 = 1.40$.\nUsing the solution for $S$ with the positive root:\n$S_0 = S(\\gamma_0) = \\frac{(\\gamma_0+1)u_p}{4} + \\sqrt{\\left(\\frac{(\\gamma_0+1)u_p}{4}\\right)^2 + \\frac{\\gamma_0 p_1}{\\rho_1}}$.\nGiven data: $u_p=300\\,\\mathrm{m/s}$, $p_1=1.00 \\times 10^5\\,\\mathrm{Pa}$, $\\rho_1=1.225\\,\\mathrm{kg/m^3}$, $\\gamma_0=1.40$.\n$\\frac{(\\gamma_0+1)u_p}{4} = \\frac{(1.40+1) \\times 300}{4} = \\frac{2.4 \\times 300}{4} = 180\\,\\mathrm{m/s}$.\n$\\frac{\\gamma_0 p_1}{\\rho_1} = \\frac{1.40 \\times 1.00 \\times 10^5}{1.225} \\approx 114285.71\\,\\mathrm{m^2/s^2}$.\n$S_0 = 180 + \\sqrt{(180)^2 + 114285.71} = 180 + \\sqrt{32400 + 114285.71} = 180 + \\sqrt{146685.71}$.\n$S_0 \\approx 180 + 382.9957 \\approx 562.9957\\,\\mathrm{m/s}$.\n\nNow we evaluate the sensitivity $\\partial S / \\partial \\gamma$ at $(\\gamma_0, S_0)$:\nNumerator: $\\rho_1 u_p S_0 + 2p_1 = (1.225)(300)(562.9957) + 2(1.00 \\times 10^5)$\n$= 367.5 \\times 562.9957 + 200000 \\approx 206890.93 + 200000 = 406890.93\\,\\mathrm{N/m^2}$.\nDenominator: $4\\rho_1 S_0 - (\\gamma_0+1)\\rho_1 u_p = 4(1.225)(562.9957) - (1.40+1)(1.225)(300)$\n$= 4.9 \\times 562.9957 - 2.4 \\times 367.5 \\approx 2758.679 - 882 = 1876.679\\,\\mathrm{kg \\cdot m/(s \\cdot m^2)}$.\n$\\left.\\frac{\\partial S}{\\partial \\gamma}\\right|_{\\gamma_0} = \\frac{406890.93}{1876.679} \\approx 216.819\\,\\mathrm{m/s}$.\n\nFinally, we estimate the standard uncertainty in the shock speed, $\\sigma_S$, using first-order uncertainty propagation.\n$\\sigma_S \\approx \\left|\\left.\\frac{\\partial S}{\\partial \\gamma}\\right|_{\\gamma_0}\\right| \\sigma_\\gamma$.\nGiven $\\sigma_\\gamma = 0.020$.\n$\\sigma_S \\approx |216.819| \\times 0.020 \\approx 4.33638\\,\\mathrm{m/s}$.\nRounding to three significant figures, the uncertainty in the shock speed is $4.34\\,\\mathrm{m/s}$.",
            "answer": "$$\n\\boxed{4.34}\n$$"
        },
        {
            "introduction": "A central goal in computational fluid dynamics is to develop numerical methods that faithfully reproduce physical reality. This practice bridges the gap between theory and computation by presenting a classic numerical artifact: the non-physical expansion shock that can arise in simulations of the Euler equations . You will diagnose this failure by applying the Lax entropy condition and identify the correct modifications to numerical flux functions needed to ensure that the simulation remains physically admissible.",
            "id": "3356174",
            "problem": "Consider the one-dimensional compressible Euler equations for an ideal gas with ratio of specific heats $\\gamma$:\n$$\n\\partial_t \\begin{pmatrix} \\rho \\\\ \\rho u \\\\ E \\end{pmatrix}\n+ \\partial_x \\begin{pmatrix} \\rho u \\\\ \\rho u^2 + p \\\\ u(E+p) \\end{pmatrix} = 0,\n\\quad p = (\\gamma - 1)\\left(E - \\tfrac{1}{2}\\rho u^2\\right),\n$$\nwhere $\\rho$ is density, $u$ is velocity, $E$ is total energy, and $p$ is pressure. The characteristic speeds of the system are $\\lambda_1 = u - a$, $\\lambda_2 = u$, $\\lambda_3 = u + a$, with $a = \\sqrt{\\gamma p / \\rho}$ the local sound speed.\n\nFor a Riemann problem whose exact solution contains a transonic rarefaction in the $1$-family (that is, $\\lambda_1$ increases from negative to positive through the fan), a finite volume scheme with Roe’s approximate Riemann solver produces a small but persistent discontinuity within the rarefaction region, often called a spurious expansion shock. At grid interfaces inside the rarefaction, local reconstructed left/right states satisfy $p_R  p_L$ and $u_R  u_L$, and the code reports a numerically computed discontinuity speed $S$ separating these states.\n\nUsing only the governing conservation laws, the Rankine–Hugoniot jump conditions across a discontinuity, the Lax entropy condition for hyperbolic systems, and the entropy inequality for the compressible Euler equations with ideal gas (i.e., specific entropy must not decrease across shocks), answer the following:\n\n- Diagnose why an apparent discontinuity with $p_R  p_L$ and $u_R  u_L$ inside a $1$-rarefaction necessarily violates admissibility (make explicit use of either the Lax entropy condition or the entropy inequality in your reasoning).\n- Then, identify modifications to the spatial discretization or Riemann solver that are specifically targeted at eliminating spurious expansion shocks in transonic rarefaction zones while maintaining physically admissible solutions.\n\nSelect all options that correctly state both a valid diagnosis of the entropy violation and a modification that will eliminate spurious expansion shocks.\n\nA. The observed jump violates the Lax entropy condition for the $1$-family because $\\lambda_1$ increases across a rarefaction and any discontinuity would require $\\lambda_1(U_L)  S  \\lambda_1(U_R)$, which cannot hold when $\\lambda_1(U_R)  \\lambda_1(U_L)$. Implement the Harten–Hyman entropy fix for Roe’s solver by modifying the absolute values of eigenvalues near sonic points to enforce additional dissipation when $|\\lambda_k|$ is small.\n\nB. The Roe linearization can misrepresent transonic rarefactions because the Roe-averaged $1$-wave speed may not reflect the sign change of $\\lambda_1$, causing incorrect upwinding and a non-entropic expansion shock. Replace the Roe flux with the Harten–Lax–van Leer with contact (HLLC) solver using entropy-consistent and positivity-preserving wave-speed estimates (for example, Einfeldt’s speeds), which avoids expansion shocks in transonic fans.\n\nC. The spurious expansion shock stems from insufficient entropy-consistent dissipation near sonic points. Use a monotone flux such as the Local Lax–Friedrichs (LLF, also called Rusanov) or the two-wave Harten–Lax–van Leer–Einfeldt (HLLE) flux; these satisfy a discrete entropy inequality and cannot form expansion shocks, although they are more diffusive.\n\nD. Increase the Courant–Friedrichs–Lewy (CFL) number toward unity to reduce numerical errors; higher CFL directly enforces the entropy inequality, removing spurious expansion shocks without modifying the flux function.\n\nE. Keep the Roe flux unchanged but add a high-order reconstruction with a Total Variation Diminishing (TVD) limiter or switch to a high-order Weighted Essentially Non-Oscillatory (WENO) scheme; higher-order non-oscillatory reconstruction alone will ensure entropy admissibility and eliminate expansion shocks in transonic rarefactions.",
            "solution": "The problem statement is scientifically sound and well-posed. It describes a classic numerical artifact encountered when using Roe's approximate Riemann solver for the one-dimensional compressible Euler equations, namely the formation of spurious expansion shocks in transonic rarefaction waves. The question requires a diagnosis of this non-physical phenomenon based on fundamental principles and an identification of appropriate remedies.\n\n### Validation of the Problem Statement\n\n**Step 1: Extract Givens**\n-   Governing Equations: $1D$ compressible Euler equations for an ideal gas,\n    $$ \\partial_t \\begin{pmatrix} \\rho \\\\ \\rho u \\\\ E \\end{pmatrix} + \\partial_x \\begin{pmatrix} \\rho u \\\\ \\rho u^2 + p \\\\ u(E+p) \\end{pmatrix} = 0 $$\n-   Equation of State: $p = (\\gamma - 1)(E - \\tfrac{1}{2}\\rho u^2)$\n-   State Variables: density $\\rho$, velocity $u$, total energy per unit volume $E$, pressure $p$.\n-   Characteristic Speeds: $\\lambda_1 = u - a$, $\\lambda_2 = u$, $\\lambda_3 = u + a$, where $a = \\sqrt{\\gamma p / \\rho}$ is the speed of sound.\n-   Problem Context: A Riemann problem with a transonic rarefaction in the $1$-family, meaning $\\lambda_1$ increases from a negative value to a positive value across the rarefaction fan.\n-   Numerical Observation: A finite volume scheme with Roe's solver produces a spurious discontinuity within the rarefaction.\n-   Properties of the spurious discontinuity: It separates a left state $U_L$ and a right state $U_R$ such that $p_R  p_L$ and $u_R  u_L$.\n-   Task:\n    1.  Diagnose why this apparent discontinuity violates admissibility using the Lax entropy condition or the entropy inequality.\n    2.  Identify correct modifications to the numerical scheme to eliminate this artifact.\n\n**Step 2: Validate Using Extracted Givens**\n-   **Scientifically Grounded**: The Euler equations, the ideal gas law, and the concept of characteristic speeds are fundamental to fluid dynamics. The phenomenon of spurious expansion shocks with Roe's solver is a well-documented and rigorously studied topic in computational fluid dynamics. The description is accurate and grounded in established theory.\n-   **Well-Posed**: The problem is clearly stated. It asks for a specific diagnosis based on given theoretical tools and an identification of correct numerical fixes from a list of options. A unique set of correct answers exists within the established theory of numerical methods for conservation laws.\n-   **Objective**: The language is technical, precise, and free from subjectivity or ambiguity.\n\n**Step 3: Verdict and Action**\nThe problem statement is valid. It is a standard problem in the analysis of numerical schemes for hyperbolic conservation laws. I will proceed with the solution.\n\n### Derivation and Analysis\n\nA discontinuity, or shock wave, in the solution of a hyperbolic conservation law $\\partial_t U + \\partial_x F(U) = 0$ must satisfy two conditions to be considered physically admissible:\n1.  The Rankine-Hugoniot (R-H) jump conditions, which are derived from the integral form of the conservation laws. For a discontinuity moving with speed $S$, the R-H conditions are:\n    $$ S(U_R - U_L) = F(U_R) - F(U_L) $$\n2.  An entropy condition, which ensures the solution is the physically relevant weak solution and respects the second law of thermodynamics.\n\nThe problem describes a numerically generated discontinuity where $p_R  p_L$ and $u_R  u_L$. This represents an expansion, as the fluid expands to a lower pressure and higher velocity across the jump. Such a feature is often called an \"expansion shock\". We must diagnose why it is not a physically admissible solution.\n\n**Diagnosis using the Lax Entropy Condition:**\nThe Lax entropy condition is a mathematical criterion for the admissibility of shocks. For a shock wave associated with the $k$-th characteristic family (a $k$-shock), the characteristic speeds on either side of the shock must \"point into\" the discontinuity. This is expressed as:\n$$ \\lambda_k(U_L)  S  \\lambda_k(U_R) $$\nThis inequality implies that information carried along the $k$-th characteristic family is consumed by the shock, which is a key feature of irreversible processes like shocks.\n\nThe problem specifies a jump appearing within a $1$-rarefaction. A rarefaction wave is a smooth, continuous solution in which the state variables change continuously. A fundamental property of a $k$-rarefaction wave is that the corresponding characteristic speed, $\\lambda_k$, strictly increases across the wave in the direction of increasing $x$. For the given $1$-rarefaction, this means for any two states $U_L$ and $U_R$ within the fan, with $U_L$ to the left of $U_R$, we must have:\n$$ \\lambda_1(U_R)  \\lambda_1(U_L) $$\nThe Lax condition for a $1$-shock requires $\\lambda_1(U_L)  S  \\lambda_1(U_R)$, which implies $\\lambda_1(U_L)  \\lambda_1(U_R)$. This is in direct contradiction with the defining property of a $1$-rarefaction. Therefore, a discontinuity satisfying the R-H conditions cannot simultaneously exist within a rarefaction fan. The numerically observed \"expansion shock\" violates the Lax entropy condition for the $1$-family.\n\n**Diagnosis using the Thermodynamic Entropy Inequality:**\nThe second law of thermodynamics requires that the specific entropy, $s$, cannot decrease across a shock wave. For a solution to the Euler equations, this means:\n$$ s_R \\ge s_L $$\nFor an ideal gas, specific entropy is related to pressure and density by $s = C_v \\ln(p/\\rho^\\gamma) + \\text{constant}$, where $C_v$ is the specific heat at constant volume. The condition $s_R \\ge s_L$ is equivalent to $p_R/\\rho_R^\\gamma \\ge p_L/\\rho_L^\\gamma$.\nIt can be proven from the Rankine-Hugoniot conditions for the Euler equations that for any non-trivial shock ($U_L \\ne U_R$), an increase in entropy ($s_R  s_L$) occurs only if the shock is a compression ($p_R  p_L$). Conversely, if a discontinuity were an expansion ($p_R  p_L$), it would necessarily lead to a decrease in entropy ($s_R  s_L$), which is a violation of the second law of thermodynamics. Thus, an expansion shock is physically impossible.\n\n**Cause of the Numerical Artifact in Roe's Solver:**\nRoe's solver linearizes the problem at each cell interface by constructing a \"Roe-averaged\" matrix $\\hat{A}(U_L, U_R)$ whose eigenvalues are $\\hat{\\lambda}_k$. The numerical flux includes a dissipation term proportional to $|\\hat{\\lambda}_k|$. In a transonic rarefaction, the true characteristic speed $\\lambda_1 = u-a$ changes sign, passing through zero. The Roe-averaged speed $\\hat{\\lambda}_1$ however, has a single value. If $\\lambda_1(U_L)  0$ and $\\lambda_1(U_R)  0$, $\\hat{\\lambda}_1$ might be a very small number. The dissipation term proportional to $|\\hat{\\lambda}_1|$ becomes vanishingly small, failing to provide the numerical diffusion needed to represent the smooth rarefaction fan. Instead, the solver computes a solution to its linearized problem, which is a single stationary or slowly moving discontinuity—the spurious expansion shock.\n\n### Evaluation of Options\n\n**A. The observed jump violates the Lax entropy condition for the $1$-family because $\\lambda_1$ increases across a rarefaction and any discontinuity would require $\\lambda_1(U_L)  S  \\lambda_1(U_R)$, which cannot hold when $\\lambda_1(U_R)  \\lambda_1(U_L)$. Implement the Harten–Hyman entropy fix for Roe’s solver by modifying the absolute values of eigenvalues near sonic points to enforce additional dissipation when $|\\lambda_k|$ is small.**\n-   **Diagnosis**: This is a perfectly correct and rigorous explanation. It correctly identifies the contradiction between the Lax condition for a shock ($\\lambda_1(U_L)  \\lambda_1(U_R)$) and the property of a rarefaction wave ($\\lambda_1(U_R)  \\lambda_1(U_L)$).\n-   **Modification**: The Harten–Hyman entropy fix is the canonical method for patching Roe's solver to handle this exact issue. It adds a small amount of numerical dissipation precisely at the sonic points where the original scheme fails, allowing the rarefaction to be resolved as a smooth fan.\n-   **Verdict**: **Correct**.\n\n**B. The Roe linearization can misrepresent transonic rarefactions because the Roe-averaged $1$-wave speed may not reflect the sign change of $\\lambda_1$, causing incorrect upwinding and a non-entropic expansion shock. Replace the Roe flux with the Harten–Lax–van Leer with contact (HLLC) solver using entropy-consistent and positivity-preserving wave-speed estimates (for example, Einfeldt’s speeds), which avoids expansion shocks in transonic fans.**\n-   **Diagnosis**: This correctly identifies the source of the problem within the mechanics of the Roe solver: the failure of the Roe-averaged eigenvalue to capture the structure of a transonic fan.\n-   **Modification**: Replacing the Roe solver with a more robust solver like HLLC is a standard and effective strategy. HLLC is designed to be entropy-satisfying and positivity-preserving, and it does not produce expansion shocks. It is a well-established alternative for cases where Roe's solver is known to fail.\n-   **Verdict**: **Correct**.\n\n**C. The spurious expansion shock stems from insufficient entropy-consistent dissipation near sonic points. Use a monotone flux such as the Local Lax–Friedrichs (LLF, also called Rusanov) or the two-wave Harten–Lax–van Leer–Einfeldt (HLLE) flux; these satisfy a discrete entropy inequality and cannot form expansion shocks, although they are more diffusive.**\n-   **Diagnosis**: The diagnosis is correct and concise. The lack of dissipation at the sonic point is the fundamental reason for the artifact's formation.\n-   **Modification**: Using inherently dissipative and entropy-satisfying fluxes like LLF (Rusanov) or HLLE is another valid and common fix. These solvers are guaranteed not to produce expansion shocks because they inherently contain enough numerical viscosity. The acknowledgement that they are more diffusive than Roe's solver (even with an entropy fix) is also accurate.\n-   **Verdict**: **Correct**.\n\n**D. Increase the Courant–Friedrichs–Lewy (CFL) number toward unity to reduce numerical errors; higher CFL directly enforces the entropy inequality, removing spurious expansion shocks without modifying the flux function.**\n-   **Diagnosis**: This is incorrect. The issue is not a generic \"numerical error\" that is sensitive to the CFL number in this way.\n-   **Modification**: The CFL condition relates the time step to the spatial grid size and characteristic speeds to ensure numerical stability. It does not enforce the entropy condition. Increasing the CFL number (for an explicit scheme) reduces the numerical diffusion per unit of physical time, which would likely make the spurious shock *sharper* and more persistent, not eliminate it. The claim that a higher CFL number \"directly enforces the entropy inequality\" is false. The entropy violation is a flaw in the spatial discretization (the flux function), not the time integration.\n-   **Verdict**: **Incorrect**.\n\n**E. Keep the Roe flux unchanged but add a high-order reconstruction with a Total Variation Diminishing (TVD) limiter or switch to a high-order Weighted Essentially Non-Oscillatory (WENO) scheme; higher-order non-oscillatory reconstruction alone will ensure entropy admissibility and eliminate expansion shocks in transonic rarefactions.**\n-   **Diagnosis**: This implicitly and incorrectly attributes the problem to the order of accuracy of the reconstruction.\n-   **Modification**: High-order reconstruction (TVD, WENO) improves the accuracy of the states ($U_L$ and $U_R$) provided to the Riemann solver at each cell interface. However, it does not alter the logic of the Riemann solver itself. If the Roe solver is fed states $U_L$ and $U_R$ that span a sonic point, it will still fail and produce a non-physical flux, regardless of how accurately $U_L$ and $U_R$ were computed. Higher-order schemes would simply try to resolve the resulting non-physical expansion shock more sharply. The entropy condition must be enforced at the level of the Riemann solver (the flux function), not by the reconstruction alone.\n-   **Verdict**: **Incorrect**.",
            "answer": "$$\\boxed{ABC}$$"
        }
    ]
}