{
    "hands_on_practices": [
        {
            "introduction": "低马赫数预处理最直接的好处之一是放宽了显式求解器中极其严格的时间步长限制。这个练习将通过计算Turkel预处理所允许的、大得多的稳定伪时间步长，具体且定量地展示这一优势。通过这个实践，你将看到重新调整声波速度如何直接转化为计算效率的提升 。",
            "id": "3341765",
            "problem": "考虑量热完全理想气体的一维定常均匀流，比热比 $\\gamma=1.4$，自由流马赫数 $M=0.02$。可压缩欧拉方程写成准线性形式 $\\partial \\mathbf{Q}/\\partial t + \\partial \\mathbf{F}(\\mathbf{Q})/\\partial x = \\mathbf{0}$，其中 $\\mathbf{Q}$ 表示守恒变量，$\\mathbf{F}$ 表示无粘通量。为了加速收敛到定常状态，采用带有预处理矩阵的伪时间 $\\tau$ 积分，因此伪时间系统为 $\\mathbf{P}\\,\\partial \\mathbf{Q}/\\partial \\tau + \\partial \\mathbf{F}(\\mathbf{Q})/\\partial x = \\mathbf{0}$，其中 $\\mathbf{P}$ 是 Turkel 预处理矩阵。\n\n假设在均匀状态附近进行线性化，并考虑在间距为 $\\Delta x$ 的均匀网格上进行伪时间的一阶显式前向欧拉更新。Courant–Friedrichs–Lewy (CFL) 数定义为 $\\mathrm{CFL} = \\lambda_{\\max}\\,\\Delta \\tau/\\Delta x$，其中 $\\lambda_{\\max}$ 是沿 $x$ 方向的预处理特征速度的最大幅值，$\\Delta \\tau$ 是伪时间步长。物理声速为 $a$，流速为 $u$，马赫数定义为 $M = |u|/a$。对于量热完全气体，$a = \\sqrt{\\gamma p/\\rho}$，其中 $p$ 是压力，$\\rho$ 是密度。\n\n在低马赫数区域，使用 Turkel 预处理时，声学特征速度按因子 $\\sqrt{\\beta}$ 进行缩放，其中预处理参数满足当 $M \\leq 1$ 时 $\\beta = M^{2}$，而对流特征速度保持为 $u$。利用这些事实，推导显式格式的稳定性约束，并计算当 $\\mathrm{CFL} = 0.5$，$M = 0.02$，$\\gamma = 1.4$，网格尺寸为 $\\Delta x$ 时的稳定伪时间步长 $\\Delta \\tau$。将您的最终答案以秒为单位，表示为关于 $\\Delta x$ 和 $a$ 的单个简化的闭式解析表达式。无需四舍五入。",
            "solution": "我们从准线性形式的可压缩欧拉方程开始，在均匀状态附近进行线性化，其中一维空间中的通量雅可比矩阵具有特征速度 $u-a$、$u$ 和 $u+a$。这些是沿 $x$ 方向的未预处理雅可比矩阵 $\\partial \\mathbf{F}/\\partial \\mathbf{Q}$ 的特征值。引入伪时间 $\\tau$ 和 Turkel 预处理，该系统可以写成\n$$\n\\mathbf{P}\\,\\frac{\\partial \\mathbf{Q}}{\\partial \\tau} + \\frac{\\partial \\mathbf{F}(\\mathbf{Q})}{\\partial x} = \\mathbf{0},\n$$\n或等价地\n$$\n\\frac{\\partial \\mathbf{Q}}{\\partial \\tau} + \\mathbf{P}^{-1}\\,\\frac{\\partial \\mathbf{F}(\\mathbf{Q})}{\\partial x} = \\mathbf{0}.\n$$\n预处理的作用是将空间算子的特征速度从其物理值修改为预处理值。在用于低马赫数流的 Turkel 预处理器中，对流特征速度 $u$ 保持不变，而声学速度按因子 $\\sqrt{\\beta}$ 进行缩放，其中预处理参数 $\\beta$ 在 $M \\leq 1$ 时满足 $\\beta = M^{2}$。因此，预处理后的特征速度为\n$$\n\\lambda_{1} = u - a\\sqrt{\\beta}, \\quad \\lambda_{2} = u, \\quad \\lambda_{3} = u + a\\sqrt{\\beta}.\n$$\n\n对于应用于间距为 $\\Delta x$ 的均匀网格上的线性化系统的伪时间显式前向欧拉格式，标准的 von Neumann 稳定性分析给出了 Courant–Friedrichs–Lewy 条件\n$$\n\\Delta \\tau \\leq \\frac{\\mathrm{CFL}\\,\\Delta x}{\\max\\left(|\\lambda_{1}|,|\\lambda_{2}|,|\\lambda_{3}|\\right)}.\n$$\n对于 $u \\geq 0$ 且马赫数较小（此处 $M=0.02$）的亚音速流，三个特征速度中的最大幅值为\n$$\n\\lambda_{\\max} = u + a\\sqrt{\\beta}.\n$$\n使用马赫数定义 $M = |u|/a$，我们有 $u = M a$。将 $u = M a$ 和 $\\beta = M^{2}$ 代入 $\\lambda_{\\max}$ 得\n$$\n\\lambda_{\\max} = M a + a\\sqrt{M^{2}} = M a + a M = 2 M a.\n$$\n\n因此，稳定性约束变为\n$$\n\\Delta \\tau \\leq \\frac{\\mathrm{CFL}\\,\\Delta x}{2 M a}.\n$$\n使用指定的参数 $\\mathrm{CFL} = 0.5$ 和 $M = 0.02$，这简化为\n$$\n\\Delta \\tau = \\frac{0.5\\,\\Delta x}{2 \\cdot 0.02 \\, a} = \\frac{0.5\\,\\Delta x}{0.04\\,a} = \\frac{12.5\\,\\Delta x}{a}.\n$$\n这里，$a$ 是物理声速，对于量热完全理想气体，$a = \\sqrt{\\gamma p/\\rho}$，其中 $\\gamma = 1.4$。由于未指定 $p$ 和 $\\rho$，以 $\\Delta x$ 和 $a$ 表示的闭式表达式即为最终结果。单位是秒，因为 $\\Delta x$ 的单位是长度，$a$ 的单位是长度每单位时间，所以它们的比值的单位是时间。\n\n因此，在给定条件下，Turkel 预处理的稳定伪时间步长为\n$$\n\\Delta \\tau = \\frac{12.5\\,\\Delta x}{a}.\n$$",
            "answer": "$$\\boxed{\\frac{12.5\\,\\Delta x}{a}}$$"
        },
        {
            "introduction": "在理解了预处理带来的效率提升后，我们进一步探究其背后的物理原理。为什么能量方程在低马赫数下会变得特别棘手？这项练习将引导你分析压力功项——刚性的主要来源。你将构建一个预处理器，并且更关键的是，量化它所引入的误差，这对于理解数值模型中的权衡是一种至关重要的技能 。",
            "id": "3341775",
            "problem": "考虑一个由可压缩纳维-斯托克斯方程控制的量热完全理想气体的低马赫数流动。关注一个粘性耗散和热扩散可忽略不计区域内的热能。比内能方程简化为以下形式\n$$\n\\rho c_{v} \\frac{D T}{D t} \\;=\\; -\\,p\\,\\nabla\\cdot\\mathbf{u} \\;+\\; \\rho\\,\\dot{Q},\n$$\n其中 $\\rho$ 是密度，$T$ 是温度，$c_{v}$ 是定容比热，$p$ 是热力学压力，$\\mathbf{u}$ 是速度矢量，$\\dot{Q}$ 是给定的单位质量体积加热率。该气体遵循理想气体定律 $p=\\rho R T$，其中气体常数 $R$ 为常数，比热比 $\\gamma=c_{p}/c_{v}$ 为常数，且有 $c_{p}=c_{v}+R$。\n\n假设压力的低马赫数渐近分解为\n$$\np \\;=\\; p_{0} \\;+\\; M^{2}\\,\\tilde{p},\n$$\n其中 $M \\ll 1$ 是马赫数，$p_{0}$ 是零阶热力学压力（在零阶上空间均匀），$\\tilde{p}=\\mathcal{O}(p_{0})$ 是动压修正。在 $M$ 的零阶上，使用连续性方程和理想气体定律证明膨胀率受以下约束\n$$\n\\nabla\\cdot\\mathbf{u} \\;=\\; \\frac{1}{T}\\,\\frac{D T}{D t}.\n$$\n\n为了缓解在动压标度下，由压力功项 $p\\,\\nabla\\cdot\\mathbf{u}$ 引起的离散化中的 $\\mathcal{O}(1/M^{2})$ 刚性问题，构建一个仅对动压贡献进行重新标度的低马赫数预处理器。具体来说，将压力功项替换为\n$$\np\\,\\nabla\\cdot\\mathbfu \\;\\longrightarrow\\; p_{0}\\,\\nabla\\cdot\\mathbf{u} \\;+\\; \\chi(M)\\,M^{2}\\,\\tilde{p}\\,\\nabla\\cdot\\mathbf{u},\n$$\n其预处理函数为\n$$\n\\chi(M) \\;=\\; \\frac{M^{2}}{M^{2}+\\beta},\n$$\n其中 $\\beta>0$ 是一个与马赫数无关的常数，其选择是为了在低马赫数下限制动压功的贡献，同时保持零阶热力学部分 $p_{0}\\,\\nabla\\cdot\\mathbf{u}$ 不变。\n\n考虑一个空间均匀的非等熵加热过程，其物性 $(\\rho, c_{v}, c_{p}, R)$、零阶压力 $p_{0}$、动压修正 $\\tilde{p}$ 以及加热率 $\\dot{Q}>0$ 均为常数。从初始均匀温度 $T(0)=T_{0}$ 开始，并假设在一个长度为 $\\tau$ 的有限时间间隔内，$T$ 的变化足够缓慢，以至于分母中的 $T$ 在零阶上可以近似为 $T_{0}$，推导温差的零阶表达式\n$$\n\\Delta T \\;=\\; T_{\\text{pre}}(\\tau) \\,-\\,T_{\\text{true}}(\\tau),\n$$\n即预处理后的能量演化与真实能量演化之间的温差。\n\n将 $\\Delta T$ 的最终答案表示为以开尔文为单位、由参数 $M$、$\\beta$、$\\tilde{p}$、$\\rho$、$c_{p}$、$T_{0}$、$\\dot{Q}$ 和 $\\tau$ 构成的单个闭式解析表达式。无需进行数值计算。",
            "solution": "首先，作为预备步骤，我们证明在零阶上约束 $\\nabla\\cdot\\mathbf{u} = \\frac{1}{T}\\frac{DT}{Dt}$ 成立。连续性方程为 $\\frac{D\\rho}{Dt} + \\rho \\nabla\\cdot\\mathbf{u} = 0$，这给出 $\\nabla\\cdot\\mathbf{u} = -\\frac{1}{\\rho}\\frac{D\\rho}{Dt}$。零阶上的理想气体定律是 $p_0 = \\rho R T$。由于 $p_0$ 和 $R$ 是常数，我们对其取物质导数：\n$$\n\\frac{D}{Dt}(p_0) = \\frac{D}{Dt}(\\rho R T) \\implies 0 = R\\left(T\\frac{D\\rho}{Dt} + \\rho\\frac{DT}{Dt}\\right)\n$$\n这意味着 $\\frac{1}{\\rho}\\frac{D\\rho}{Dt} = -\\frac{1}{T}\\frac{DT}{Dt}$。将此代入膨胀率 $\\nabla\\cdot\\mathbf{u}$ 的表达式中，得到：\n$$\n\\nabla\\cdot\\mathbf{u} = -\\left(-\\frac{1}{T}\\frac{DT}{Dt}\\right) = \\frac{1}{T}\\frac{DT}{Dt}\n$$\n这证实了所提供约束的有效性。由于过程是空间均匀的，物质导数 $\\frac{D}{Dt}$ 简化为常时间导数 $\\frac{d}{dt}$。\n\n**1. 真实能量演化**\n我们从真实温度 $T_{\\text{true}}(t)$ 的能量方程开始：\n$$\n\\rho c_{v} \\frac{d T_{\\text{true}}}{d t} = -p\\,\\nabla\\cdot\\mathbf{u} + \\rho\\,\\dot{Q}\n$$\n代入 $p = p_0 + M^2 \\tilde{p}$ 和 $\\nabla\\cdot\\mathbf{u} = \\frac{1}{T_{\\text{true}}}\\frac{d T_{\\text{true}}}{dt}$：\n$$\n\\rho c_{v} \\frac{d T_{\\text{true}}}{d t} = -(p_0 + M^2 \\tilde{p}) \\frac{1}{T_{\\text{true}}}\\frac{d T_{\\text{true}}}{dt} + \\rho\\,\\dot{Q}\n$$\n整理各项以求解 $\\frac{d T_{\\text{true}}}{dt}$：\n$$\n\\left(\\rho c_{v} + \\frac{p_0 + M^2 \\tilde{p}}{T_{\\text{true}}}\\right) \\frac{d T_{\\text{true}}}{d t} = \\rho\\,\\dot{Q}\n$$\n根据问题陈述，我们使用零阶近似 $\\frac{p_0}{T_{\\text{true}}} \\approx \\frac{p_0}{T_0} = \\rho R$ （其中 $\\rho$ 是恒定的参考密度），并假设分母中的 $T$ 可以近似为 $T_0$：\n$$\n\\left(\\rho c_{v} + \\rho R + \\frac{M^2 \\tilde{p}}{T_0}\\right) \\frac{d T_{\\text{true}}}{d t} = \\rho\\,\\dot{Q}\n$$\n使用关系式 $c_p = c_v + R$：\n$$\n\\left(\\rho c_{p} + \\frac{M^2 \\tilde{p}}{T_0}\\right) \\frac{d T_{\\text{true}}}{d t} = \\rho\\,\\dot{Q}\n$$\n这是一个具有常系数的常微分方程。在初始条件 $T_{\\text{true}}(0)=T_0$ 下，从 $t=0$ 积分到 $t=\\tau$：\n$$\nT_{\\text{true}}(\\tau) = T_0 + \\left( \\frac{\\rho\\,\\dot{Q}}{\\rho c_{p} + \\frac{M^2 \\tilde{p}}{T_0}} \\right) \\tau\n$$\n\n**2. 预处理后的能量演化**\n对于预处理系统，压力功项 $p\\,\\nabla\\cdot\\mathbf{u}$ 被替换为 $p_0\\,\\nabla\\cdot\\mathbf{u} + \\chi(M) M^2 \\tilde{p}\\,\\nabla\\cdot\\mathbf{u}$。预处理温度 $T_{\\text{pre}}(t)$ 的能量方程为：\n$$\n\\rho c_{v} \\frac{d T_{\\text{pre}}}{d t} = -(p_0 + \\chi(M) M^2 \\tilde{p}) \\nabla\\cdot\\mathbf{u} + \\rho\\,\\dot{Q}\n$$\n遵循与真实系统相同的代入和简化步骤：\n$$\n\\left(\\rho c_{p} + \\frac{\\chi(M) M^2 \\tilde{p}}{T_0}\\right) \\frac{d T_{\\text{pre}}}{d t} = \\rho\\,\\dot{Q}\n$$\n在 $T_{\\text{pre}}(0)=T_0$ 的条件下积分此方程：\n$$\nT_{\\text{pre}}(\\tau) = T_0 + \\left( \\frac{\\rho\\,\\dot{Q}}{\\rho c_{p} + \\frac{\\chi(M) M^2 \\tilde{p}}{T_0}} \\right) \\tau\n$$\n\n**3. 温差的零阶表达式**\n温差 $\\Delta T$ 为：\n$$\n\\Delta T = T_{\\text{pre}}(\\tau) - T_{\\text{true}}(\\tau) = \\rho\\,\\dot{Q}\\,\\tau \\left( \\frac{1}{\\rho c_{p} + \\frac{\\chi(M) M^2 \\tilde{p}}{T_0}} - \\frac{1}{\\rho c_{p} + \\frac{M^2 \\tilde{p}}{T_0}} \\right)\n$$\n为了找到零阶表达式，我们将分母中的 $\\rho c_p$ 提出，并利用泰勒展开 $(1+x)^{-1} \\approx 1 - x$（因为涉及 $M^2$ 的项是小量）：\n$$\n\\Delta T = \\frac{\\dot{Q}\\,\\tau}{c_p} \\left( \\frac{1}{1 + \\frac{\\chi(M) M^2 \\tilde{p}}{\\rho c_p T_0}} - \\frac{1}{1 + \\frac{M^2 \\tilde{p}}{\\rho c_p T_0}} \\right) \\approx \\frac{\\dot{Q}\\,\\tau}{c_p} \\left( \\left(1 - \\frac{\\chi(M) M^2 \\tilde{p}}{\\rho c_p T_0}\\right) - \\left(1 - \\frac{M^2 \\tilde{p}}{\\rho c_p T_0}\\right) \\right)\n$$\n$$\n\\Delta T \\approx \\frac{\\dot{Q}\\,\\tau}{c_p} \\left( \\frac{M^2 \\tilde{p}}{\\rho c_p T_0} (1 - \\chi(M)) \\right) = \\frac{\\dot{Q}\\,\\tau\\, M^2 \\tilde{p} (1 - \\chi(M))}{\\rho c_p^2 T_0}\n$$\n现在，代入给定的预处理函数 $\\chi(M) = \\frac{M^{2}}{M^{2}+\\beta}$：\n$$\n1 - \\chi(M) = 1 - \\frac{M^2}{M^2 + \\beta} = \\frac{M^2 + \\beta - M^2}{M^2 + \\beta} = \\frac{\\beta}{M^2 + \\beta}\n$$\n最后，我们得到温差的零阶表达式：\n$$\n\\Delta T = \\frac{\\dot{Q}\\,\\tau\\, M^2 \\tilde{p}}{\\rho c_p^2 T_0} \\left( \\frac{\\beta}{M^2 + \\beta} \\right) = \\frac{\\beta M^2}{M^2 + \\beta} \\frac{\\dot{Q}\\,\\tau\\,\\tilde{p}}{\\rho c_p^2 T_0}\n$$\n该表达式符合题目要求。",
            "answer": "$$\\boxed{\\frac{\\beta M^{2}}{M^{2} + \\beta} \\frac{\\dot{Q}\\,\\tau\\,\\tilde{p}}{\\rho c_{p}^{2} T_{0}}}$$"
        },
        {
            "introduction": "最后，我们探讨预处理一个更精妙但同样关键的优势：精度的提升。这个练习以声流作为物理代理，展示了未经预处理的格式如何因过度的数值耗散而淹没精细的物理效应。通过实施一个基于冯·诺依曼分析的模型，你将定量地看到预处理如何减少这种耗散，从而使得解析小尺度物理现象成为可能 。",
            "id": "3341755",
            "problem": "要求您使用一个基于原理的代理模型来评估，一种用于可压缩流的低马赫数预处理离散格式是否能够解析阶为 $\\overline{\\mathbf{u}}=O(M^2)$ 的二阶声流平均流，同时不会对主声场造成过度的数值耗散。在一维空间中进行分析，并进行无量纲化，使得参考声速为 $c=1$，基态速度为零，周期性域的长度为 $L=1$。考虑一个波数为 $k=2\\pi$（在域中为一个波长）、声学马赫数为 $M$ 的单一右行声学傅里叶模态，因此主声学速度振幅的标度为 $O(M)$，而流动平均值的标度为 $O(M^2)$。Weiss–Smith意义下的低马赫数预处理通过一个因子 $\\beta(M)=\\max(M,M_{\\mathrm{cut}})$ 来修正声学特征速度，其中 $M_{\\mathrm{cut}}$ 是一个预设的截止值；也就是说，有效声速变为 $\\pm \\beta(M)\\,c$。\n\n使用以下基本依据和假设，并从中推导出所有需要的关系，不要引入无法从它们逻辑推导出的公式：\n\n- 从关于均匀静止状态的线性化可压缩方程及其特征形式出发，在没有预处理的情况下，声学特征会解耦并以速度 $\\pm c$ 传播。\n- 假设在每个波长有 $N_p$ 个点的均匀网格上，使用局部Lax–Friedrichs (LLF) 数值通量（也称为Rusanov通量）进行半离散空间离散化。LLF耗散参数等于通量雅可比矩阵沿法线方向的谱半径；对于声学模态，在预处理系统中，该参数等于 $\\alpha=\\beta(M)\\,c$，而在没有预处理的情况下，它等于 $\\alpha=c$。\n- 对网格间距为 $\\Delta x=1/N_p$、波数为 $\\theta=2\\pi/N_p$ 的单个傅里叶模态，对半离散LLF算子应用标准的傅里叶或冯·诺依曼分析。根据该模态在LLF作用下的半离散演化，确定由LLF耗散项引起的模态振幅随时间指数衰减的速率。然后，在一个物理波周期 $T=L/c$（由未经预处理的物理过程设定）内，获得仅由空间数值耗散引起的主声学模态的振幅衰减因子 $A\\in(0,1)$。\n- 最后，论证在 $M$ 的主阶上，二阶流动平均值的大小与主模态振幅的平方成比例，因此由数值耗散引起的流动大小的相对误差可以近似为 $E=1-A^2$。同样，将一个周期内的主波振幅下降定义为 $D=1-A$。\n\n判定准则：对于给定的参数集 $(M,N_p,M_{\\mathrm{cut}},\\delta,\\varepsilon,\\mathrm{precond})$，其中 $\\mathrm{precond}\\in\\{\\mathrm{True},\\mathrm{False}\\}$ 表示是否应用预处理，当且仅当 $D\\le \\delta$ 和 $E\\le \\varepsilon$ 同时成立时，声明该配置能够解析 $O(M^2)$ 流动而没有过度耗散。\n\n任务：实现一个程序，对下面套件中的每个测试用例，根据上述步骤计算布尔决策，并根据 $\\mathrm{precond}$ 的指示决定是否使用预处理。假设在所有情况下 $c=1$ 和 $L=1$。在此评估中，主波传播无需模拟物理粘性。\n\n测试套件（每个元组为 $(M,N_p,M_{\\mathrm{cut}},\\delta,\\varepsilon,\\mathrm{precond})$）：\n- $\\left(0.01,\\,64,\\,0.1,\\,0.2,\\,0.2,\\,\\mathrm{False}\\right)$\n- $\\left(0.01,\\,64,\\,0.1,\\,0.2,\\,0.2,\\,\\mathrm{True}\\right)$\n- $\\left(0.0001,\\,64,\\,0.01,\\,0.1,\\,0.1,\\,\\mathrm{True}\\right)$\n- $\\left(0.0001,\\,64,\\,0.01,\\,0.1,\\,0.1,\\,\\mathrm{False}\\right)$\n- $\\left(0.05,\\,16,\\,0.1,\\,0.15,\\,0.25,\\,\\mathrm{True}\\right)$\n- $\\left(0.1,\\,256,\\,0.05,\\,0.1,\\,0.15,\\,\\mathrm{False}\\right)$\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，“[result1,result2,result3]”），其中每个结果均为True或False，按上面列出的顺序对应于每个测试用例。由于此处指定了无量纲化，因此不需要物理单位。傅里葉波数中使用的角度是无量纲的相位角。",
            "solution": "该问题是计算流体力学中数值方法分析领域一个有效且适定的练习。它要求通过构建一个基于主声波数值耗散的代理模型，来评估一种数值格式解析物理现象——声流——的能力。分析过程将通过推导指定格式的数值耗散率，并将产生的波衰减与规定的误差容限进行比较来进行。\n\n其基本物理过程是声流，其中速度振幅为 $O(M)$ 的一阶声场驱动了大小为 $O(M^2)$ 的二阶平均流，其中 $M$ 是声学马赫数。问题的核心是量化此过程中的数值误差。我们已知，流动大小的相对误差 $E$ 可以通过主波能量的衰减来近似。如果主波振幅在一个特征时间内衰减了因子 $A$，其能量（与振幅的平方成正比）则衰减了 $A^2$。因此，相对损失为 $E = 1-A^2$。直接的振幅下降为 $D=1-A$。如果 $D$ 和流动误差 $E$ 都分别低于给定的阈值 $\\delta$ 和 $\\varepsilon$，则认为该配置是足够的。\n\n我们的第一步是模拟数值格式对主声波的衰减。该格式是在均匀网格上使用局部Lax-Friedrichs (LLF) 或Rusanov数值通量对一维线性化可压缩欧拉方程进行的半离散化。分析是针对代表主声波的单个傅里葉模态进行的。\n\n设与右行声波相关的特征变量 $w(x,t)$ 受标量平流方程控制：\n$$\n\\frac{\\partial w}{\\partial t} + c \\frac{\\partial w}{\\partial x} = 0\n$$\n其中 $c=1$ 是无量纲声速。在网格间距为 $\\Delta x$ 的网格上，节点 $j$ 处的守恒律 $\\frac{\\partial w}{\\partial t} + \\frac{\\partial f(w)}{\\partial x} = 0$ 的半离散形式由下式给出：\n$$\n\\frac{dw_j}{dt} = -\\frac{1}{\\Delta x} \\left( F_{j+1/2} - F_{j-1/2} \\right)\n$$\n其中 $F_{j+1/2}$ 是节点 $j$ 和 $j+1$ 之间的数值通量。对于LLF格式，此通量为：\n$$\nF_{j+1/2} = \\frac{1}{2} \\left[ f(w_j) + f(w_{j+1}) \\right] - \\frac{\\alpha}{2} \\left( w_{j+1} - w_j \\right)\n$$\n此处，$f(w) = cw$ 是物理通量，$\\alpha$ 是数值耗散参数，其值设为最大特征速度（通量雅可比矩阵的谱半径）。问题陈述指出，对于未经预处理的系统，$\\alpha=c$；对于预处理系统，$\\alpha=\\beta(M)c$。由于 $c=1$，我们有：\n$$\n\\alpha = \\begin{cases} 1  \\text{不使用预处理} \\\\ \\beta(M) = \\max(M, M_{\\mathrm{cut}})  \\text{使用预处理} \\end{cases}\n$$\n将LLF通量代入半离散方程可得：\n$$\n\\frac{dw_j}{dt} = -\\frac{c}{2\\Delta x}(w_{j+1} - w_{j-1}) + \\frac{\\alpha}{2\\Delta x}(w_{j+1} - 2w_j + w_{j-1})\n$$\n第一项是平流项 $-c \\frac{\\partial w}{\\partial x}$ 的二阶中心差分近似，第二项是类似于离散拉普拉斯算子的数值耗散项。\n\n为求耗散率，我们进行冯·诺依曼分析，代入单个傅里叶模态 $w_j(t) = \\hat{w}(t) e^{ikx_j} = \\hat{w}(t) e^{ij\\theta}$，其中 $k=2\\pi$ 是物理波数，$\\Delta x = L/N_p = 1/N_p$ 是每个波长 $N_p$ 个点时的网格间距，而 $\\theta = k\\Delta x = 2\\pi/N_p$ 是无量纲网格波数。此代换将网格值 $w_j$ 的常微分方程转换为关于模态振幅 $\\hat{w}$ 的方程：\n$$\n\\frac{d\\hat{w}}{dt} = \\left[ -\\frac{c}{2\\Delta x}(e^{i\\theta} - e^{-i\\theta}) + \\frac{\\alpha}{2\\Delta x}(e^{i\\theta} - 2 + e^{-i\\theta}) \\right] \\hat{w}(t)\n$$\n使用恒等式 $e^{i\\theta} - e^{-i\\theta} = 2i\\sin\\theta$ 和 $e^{i\\theta} - 2 + e^{-i\\theta} = 2\\cos\\theta - 2$，方程变为：\n$$\n\\frac{d\\hat{w}}{dt} = \\left[ -i\\frac{c\\sin\\theta}{\\Delta x} + \\frac{\\alpha(\\cos\\theta - 1)}{\\Delta x} \\right] \\hat{w}(t)\n$$\n这是一个形如 $\\frac{d\\hat{w}}{dt} = \\lambda \\hat{w}$ 的线性常微分方程，其解为 $\\hat{w}(t) = \\hat{w}(0)e^{\\lambda t}$。复特征值 $\\lambda$ 决定了模态的行为。虚部对应于数值相速度（色散），而实部控制振幅的增长或衰减（不稳定性或耗散）。实部为：\n$$\n\\lambda_{Re} = \\frac{\\alpha(\\cos\\theta - 1)}{\\Delta x}\n$$\n由于 $\\cos\\theta \\le 1$，所以 $\\lambda_{Re} \\le 0$，表明LLF格式是耗散的，这与预期相符。随时间指数衰减的速率为 $\\sigma = -\\lambda_{Re}$：\n$$\n\\sigma = -\\frac{\\alpha(\\cos\\theta - 1)}{\\Delta x} = \\frac{\\alpha(1 - \\cos\\theta)}{\\Delta x}\n$$\n代入 $\\Delta x = 1/N_p$ 和 $\\theta = 2\\pi/N_p$，我们得到：\n$$\n\\sigma = N_p \\alpha \\left(1 - \\cos\\left(\\frac{2\\pi}{N_p}\\right)\\right)\n$$\n经过时间 $t$ 后，波的振幅为 $|\\hat{w}(t)| = |\\hat{w}(0)|e^{-\\sigma t}$。问题要求在一个物理波周期 $T = L/c$ 内评估衰减。当 $L=1$ 和 $c=1$ 时，该周期为 $T=1$。因此，振幅衰减因子 $A$ 为：\n$$\nA = \\frac{|\\hat{w}(T)|}{|\\hat{w}(0)|} = e^{-\\sigma T} = e^{-\\sigma}\n$$\n确定了衰减因子 $A$ 后，我们计算误差度量：\n$$\nD = 1-A \\quad \\text{和} \\quad E=1-A^2\n$$\n对于每个测试用例 $(M, N_p, M_{\\mathrm{cut}}, \\delta, \\varepsilon, \\mathrm{precond})$ 的最终决策由以下逻辑条件给出：\n$$\n\\text{结果} = (D \\le \\delta) \\land (E \\le \\varepsilon)\n$$\n至此完成了算法的推导。对于每个测试用例，我们计算 $\\alpha$，然后是 $\\sigma$，然后是 $A$，接着是 $D$ 和 $E$，最后应用判定准则。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes whether a low-Mach-number preconditioned discretization\n    can resolve second-order acoustic streaming based on a proxy model for\n    numerical dissipation.\n    \"\"\"\n\n    # Test suite: each tuple is (M, Np, Mcut, delta, epsilon, precond)\n    test_cases = [\n        (0.01, 64, 0.1, 0.2, 0.2, False),\n        (0.01, 64, 0.1, 0.2, 0.2, True),\n        (0.0001, 64, 0.01, 0.1, 0.1, True),\n        (0.0001, 64, 0.01, 0.1, 0.1, False),\n        (0.05, 16, 0.1, 0.15, 0.25, True),\n        (0.1, 256, 0.05, 0.1, 0.15, False),\n    ]\n\n    results = []\n\n    for case in test_cases:\n        M, Np, Mcut, delta, epsilon, precond = case\n\n        # Assign reference sound speed c=1 as per problem statement.\n        c = 1.0\n\n        # Step 1: Determine the LLF dissipation parameter alpha.\n        # It is the spectral radius of the (preconditioned) flux Jacobian.\n        if precond:\n            # For the preconditioned system, alpha = beta(M)*c\n            # where beta(M) = max(M, Mcut).\n            beta_M = max(M, Mcut)\n            alpha = beta_M * c\n        else:\n            # For the unpreconditioned system, alpha = c.\n            alpha = c\n\n        # Step 2: Determine the exponential-in-time decay rate sigma.\n        # This comes from Fourier analysis of the semi-discrete operator.\n        # The dimensionless grid wavenumber is theta = 2*pi/Np.\n        # The grid spacing is Delta_x = 1/Np.\n        # sigma = alpha * (1 - cos(theta)) / Delta_x\n        sigma = Np * alpha * (1 - np.cos(2 * np.pi / Np))\n\n        # Step 3: Compute the amplitude attenuation factor A over one\n        # physical wave period T=L/c. Since L=1 and c=1, T=1.\n        # A = exp(-sigma * T) = exp(-sigma).\n        A = np.exp(-sigma)\n\n        # Step 4: Calculate the error metrics.\n        # D: primary-wave amplitude drop.\n        # E: relative error in the streaming magnitude.\n        D = 1.0 - A\n        E = 1.0 - A**2\n\n        # Step 5: Apply the decision criterion.\n        # The configuration is successful if D is below delta AND E is below epsilon.\n        decision = (D = delta) and (E = epsilon)\n        results.append(decision)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}