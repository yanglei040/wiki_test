{
    "hands_on_practices": [
        {
            "introduction": "在基于密度的求解器中，控制方程演化的是守恒变量（如密度、动量密度和总能量密度）。然而，物理边界条件、状态方程以及结果的物理解释通常依赖于原始变量（如压力和温度）。本练习  将指导你推导一个关键的“解码”步骤：如何从给定的守恒变量中恢复温度，这是在每个时间步中连接数值演化量与热力学状态的桥梁。",
            "id": "3307255",
            "problem": "考虑在三维（$3$D）基于密度的计算流体力学（CFD）格式中建模的单组分、无粘性、可压缩理想气体。单位体积的守恒变量是质量密度 $\\rho$、动量密度 $\\rho u$、$\\rho v$、$\\rho w$ 以及总能量密度 $\\rho E$，其中 $E$ 是单位质量的总能量。原始变量是速度分量 $u$、$v$、$w$、压力 $p$ 和温度 $T$。假设该气体是量热完全气体，具有恒定的比热比 $\\gamma > 1$ 和特定气体常数 $R > 0$。基于密度的更新会推进守恒变量，而原始变量必须由这些守恒变量重构。\n\n从以下基本原理出发：\n- 单位质量总能量 $E$ 定义为单位质量内能 $e$ 和单位质量动能之和，\n- 理想气体状态方程 $p = \\rho R T$，\n- 以及量热完全气体的热力学关系 $e = c_{v} T$，其中 $c_{v} = \\frac{R}{\\gamma - 1}$，\n\n推导一个用守恒变量和热力学参数表示的温度 $T$ 的闭式表达式，并解释（定性地，不含数值实现细节）在基于密度的求解器中，每次更新守恒变量后，应如何一致地重构并保持 $p$、$T$ 和 $E$ 之间的一致性。你的推导必须从所述的基本关系开始，并通过使用适用于基于密度格式的定义来消除非原始量。\n\n提供 $T$ 的最终表达式作为你的答案。无需进行数值计算。将最终答案表示为单个解析表达式。最终的方框答案中不应包含单位。",
            "solution": "问题陈述被评估为**有效**。它在热力学和流体力学原理，特别是量热完全理想气体模型方面具有科学依据。该问题提法恰当、客观，并提供了一套完整且一致的定义和关系，足以推导出所要求的表达式并提供后续解释。该任务是计算流体力学领域的标准推导，不包含验证标准中列出的任何缺陷。\n\n目标是推导一个用单位体积守恒变量（质量密度 $\\rho$、动量密度 $\\rho u$、$\\rho v$、$\\rho w$ 和总能量密度 $\\rho E$）表示的温度 $T$ 的闭式表达式。推导从所提供的基本原理开始。\n\n令守恒变量向量为 $\\mathbf{U} = [\\rho, \\rho u, \\rho v, \\rho w, \\rho E]^T$。\n\n第一个原理是单位质量总能量 $E$ 的定义，即单位质量内能 $e$ 和单位质量动能 $K$ 之和。\n$$E = e + K$$\n三维流动的单位质量动能由下式给出：\n$$K = \\frac{1}{2} (u^2 + v^2 + w^2)$$\n因此，单位质量总能量为：\n$$E = e + \\frac{1}{2} (u^2 + v^2 + w^2)$$\n为了使用基于密度格式中常规的单位体积量，我们乘以质量密度 $\\rho$：\n$$\\rho E = \\rho e + \\frac{1}{2} \\rho (u^2 + v^2 + w^2)$$\n\n第二个原理是量热完全气体的量热状态方程，它将单位质量内能 $e$ 与温度 $T$ 联系起来：\n$$e = c_v T$$\n其中 $c_v$ 是定容比热。问题给出了 $c_v$ 用特定气体常数 $R$ 和比热比 $\\gamma$ 表示的关系：\n$$c_v = \\frac{R}{\\gamma - 1}$$\n将 $e$ 的表达式代入 $\\rho E$ 的方程中：\n$$\\rho E = \\rho (c_v T) + \\frac{1}{2} \\rho (u^2 + v^2 + w^2)$$\n\n下一步是用守恒变量表示右侧除 $T$ 以外的所有项。速度分量 $u$、$v$ 和 $w$ 本身不是守恒变量，但它们与守恒的动量密度和质量密度相关：\n$$u = \\frac{\\rho u}{\\rho}, \\quad v = \\frac{\\rho v}{\\rho}, \\quad w = \\frac{\\rho w}{\\rho}$$\n单位体积动能 $\\frac{1}{2} \\rho (u^2 + v^2 + w^2)$ 可以用守恒量重写：\n$$\\frac{1}{2} \\rho (u^2 + v^2 + w^2) = \\frac{1}{2} \\rho \\left( \\left(\\frac{\\rho u}{\\rho}\\right)^2 + \\left(\\frac{\\rho v}{\\rho}\\right)^2 + \\left(\\frac{\\rho w}{\\rho}\\right)^2 \\right)$$\n$$= \\frac{1}{2} \\rho \\frac{(\\rho u)^2 + (\\rho v)^2 + (\\rho w)^2}{\\rho^2}$$\n$$= \\frac{(\\rho u)^2 + (\\rho v)^2 + (\\rho w)^2}{2\\rho}$$\n现在，将动能项的这个表达式代回总能量密度 $\\rho E$ 的方程中：\n$$\\rho E = \\rho c_v T + \\frac{(\\rho u)^2 + (\\rho v)^2 + (\\rho w)^2}{2\\rho}$$\n\n目标是求解该方程以得到温度 $T$。我们分离出包含 $T$ 的项：\n$$\\rho c_v T = \\rho E - \\frac{(\\rho u)^2 + (\\rho v)^2 + (\\rho w)^2}{2\\rho}$$\n两边除以 $\\rho c_v$ 得到 $T$ 的表达式：\n$$T = \\frac{1}{\\rho c_v} \\left( \\rho E - \\frac{(\\rho u)^2 + (\\rho v)^2 + (\\rho w)^2}{2\\rho} \\right)$$\n最后，代入 $c_v = \\frac{R}{\\gamma - 1}$ 的表达式：\n$$T = \\frac{1}{\\rho \\left(\\frac{R}{\\gamma - 1}\\right)} \\left( \\rho E - \\frac{(\\rho u)^2 + (\\rho v)^2 + (\\rho w)^2}{2\\rho} \\right)$$\n$$T = \\frac{\\gamma - 1}{\\rho R} \\left( \\rho E - \\frac{(\\rho u)^2 + (\\rho v)^2 + (\\rho w)^2}{2\\rho} \\right)$$\n这就是所求的完全用守恒变量和气体常数参数 $\\gamma$ 和 $R$ 表示的温度 $T$ 的闭式表达式。\n\n关于问题的第二部分，从守恒变量（$\\rho E$ 等）一致地重构原始变量（$p, T$）是任何基于密度的求解器中的一个基本步骤。守恒定律（例如欧拉方程）被数值求解以得到守恒变量向量 $\\mathbf{U} = [\\rho, \\rho u, \\rho v, \\rho w, \\rho E]^T$。这意味着在每个时间步（或龙格-库塔阶段）结束时，求解器会产生一个更新后的状态向量 $\\mathbf{U}^{n+1}$。\n\n为了计算下一个时间步所需的量，例如通量（其依赖于压力 $p$ 等原始变量），或为了进行后处理，必须从 $\\mathbf{U}^{n+1}$ 中恢复原始变量 $\\mathbf{W} = [\\rho, u, v, w, p, T]^T$。这种重构，通常称为“解码状态向量”，是一个确定性过程，它强制所有热力学和运动学性质之间的一致性。该过程如下：\n\n1. 更新后的密度 $\\rho$ 直接从 $\\mathbf{U}^{n+1}$ 的第一个分量获得。\n2. 通过将动量密度除以质量密度来计算速度分量：$u = (\\rho u)/\\rho$，$v = (\\rho v)/\\rho$，$w = (\\rho w)/\\rho$。\n3. 总能量密度 $\\rho E$ 从 $\\mathbf{U}^{n+1}$ 的第五个分量获得。单位体积动能由已经找到的密度和动量密度计算得出。然后通过相减得到内能密度：$\\rho e = \\rho E - \\frac{1}{2\\rho}((\\rho u)^2 + (\\rho v)^2 + (\\rho w)^2)$。\n4. 然后使用热力学关系 $e = c_v T$ 从内能计算出温度 $T$，这等同于使用上面推导出的 $T$ 的显式公式。这一步直接且唯一地将热力学状态（$T$）与总能量状态（$\\rho E$）和运动学状态（动量密度）联系起来。\n5. 最后，使用理想气体状态方程计算压力 $p$：$p = \\rho R T$。\n\n$p$、$T$ 和 $E$ 之间的一致性并非需要主动“维持”的东西，好像它们是可以相互偏离的独立变量一样。相反，一致性是由这个顺序重构过程内在强制执行的。在基于密度的格式中，原始变量 $p$ 和 $T$ 不是独立的、被演化的量；它们是诊断变量，完全由任意时刻的守恒变量状态所决定。通过从 $\\rho E$ 的组成部分推导 $T$，然后从 $T$ 推导 $p$，连接它们的热力学关系在每次更新后在流场的每一点都通过定义得到满足。此过程保证了用于计算通量的压力场与正在被守恒和演化的能量场完全一致。任何其他方法都将违反基本的物理模型。",
            "answer": "$$\n\\boxed{\\frac{\\gamma - 1}{\\rho R} \\left( \\rho E - \\frac{(\\rho u)^2 + (\\rho v)^2 + (\\rho w)^2}{2\\rho} \\right)}\n$$"
        },
        {
            "introduction": "选择合适的数值格式是CFD实践的核心，但这不仅仅是实现一个算法的问题，更重要的是理解其内在属性。本练习  采用傅里叶分析这一强大的数学工具，如同一个“显微镜”，来剖析一个基本的一阶迎风格式。通过这个过程，你将亲手量化由离散化引入的数值耗散（幅值衰减）和数值色散（相位错误），从而深刻理解为什么简单格式会模糊细节，以及为何需要更高阶的方法来精确捕捉流动现象。",
            "id": "3307236",
            "problem": "考虑以守恒形式写出的一维理想气体欧拉方程，其守恒变量为 $q = [\\rho, \\rho u, \\rho E]^{\\top}$，通量为 $F(q) = [\\rho u, \\rho u^{2} + p, u(\\rho E + p)]^{\\top}$，其中 $\\rho$ 是密度，$u$ 是速度，$E$ 是总比能，$p$ 是压力。假设理想气体的比热比为 $\\gamma$，因此 $p = (\\gamma - 1)\\left(\\rho E - \\tfrac{1}{2}\\rho u^{2}\\right)$。设基态是均匀的：$(\\rho_{0}, u_{0}, p_{0})$，其声速为常数 $a_{0} = \\sqrt{\\gamma p_{0}/\\rho_{0}}$。围绕该基态对该方程组进行线性化，得到一个常系数双曲系统 $\\partial_{t} \\delta q + A \\partial_{x} \\delta q = 0$，其中 $A = \\left.\\partial F/\\partial q\\right|_{(\\rho_{0},u_{0},p_{0})}$ 的实特征值为 $u_{0} - a_{0}$、$u_{0}$ 和 $u_{0} + a_{0}$，分别对应于左行声波、熵（接触）和右行声波的特征场。\n\n在间距为 $\\Delta x$ 的均匀网格上，使用带 Rusanov (局部 Lax–Friedrichs) 通量的一阶迎风有限体积法对线性化系统进行空间离散化，并假设采用基于密度的格式，以便从欧拉通量雅可比矩阵中获取特征信息。对于每个单元 $j$，半离散更新为\n$$\n\\frac{d q_{j}}{d t} \\;=\\; -\\frac{1}{\\Delta x}\\left[F_{j+\\tfrac{1}{2}} - F_{j-\\tfrac{1}{2}}\\right],\n$$\n其中界面 $j+\\tfrac{1}{2}$ 处的数值通量为\n$$\nF_{j+\\tfrac{1}{2}} \\;=\\; \\tfrac{1}{2}\\left(F(q_{j}) + F(q_{j+1})\\right) \\;-\\; \\tfrac{1}{2}\\alpha\\,(q_{j+1} - q_{j}),\n$$\n耗散参数 $\\alpha$ 为冻结在基态的常数，即 $\\alpha = |u_{0}| + a_{0}$。考虑形式为 $\\delta q_{j}(t) = \\widehat{q}\\,\\exp\\!\\left(i j \\theta - \\omega t\\right)$ 的小振幅傅里叶扰动，其中 $\\theta = k\\,\\Delta x$ 是无量纲波数，$k$ 是物理波数。所有工作都在半离散设置（时间连续，空间离散）和围绕基态的线性范围内进行。\n\n从线性化的守恒律和所述的离散化方法出发，推导傅里叶空间中的线性半离散符号及其特征值。然后，通过投影到与左行声波、熵（接触）波和右行声波相关的特征场上，量化由离散化引入的数值耗散和数值色散。您的推导必须从控制守恒律、线性化和离散化过程出发，不得引用任何预先推导的修正方程公式。\n\n作为最终答案，请提供作用于特征速度为 $\\lambda \\in \\{u_{0}-a_{0},\\,u_{0},\\,u_{0}+a_{0}\\}$ 的特征模态的空间离散算子的半离散特征值 $s(\\lambda,\\theta)$ 的单一闭式解析表达式，用 $\\lambda$、$\\theta$、$\\Delta x$ 和 $\\alpha$ 表示。不包括单位。不要近似或四舍五入；以符号形式提供精确表达式。",
            "solution": "该问题要求推导和分析线性化一维欧拉方程的一阶 Rusanov 有限体积离散格式的半离散特征值。分析过程将首先对半离散格式进行线性化，然后应用傅里叶分析来寻找所得空间算子的特征值。\n\n对于一个通用单元 $j$ 的半离散有限体积格式由下式给出\n$$ \\frac{d q_{j}}{d t} = -\\frac{1}{\\Delta x}\\left[F_{j+\\tfrac{1}{2}} - F_{j-\\tfrac{1}{2}}\\right] $$\n其中 $q_j$ 是单元 $j$ 中的守恒变量向量，$\\Delta x$ 是均匀的网格间距。\n\n单元 $j$ 和 $j+1$ 之间界面 $j+\\tfrac{1}{2}$ 处的数值通量是 Rusanov（或局部 Lax-Friedrichs）通量：\n$$ F_{j+\\tfrac{1}{2}} = \\tfrac{1}{2}\\left(F(q_{j}) + F(q_{j+1})\\right) - \\tfrac{1}{2}\\alpha\\,(q_{j+1} - q_{j}) $$\n此处，$F(q)$ 是物理通量向量，$\\alpha$ 是一个常数耗散参数，给定为 $\\alpha = |u_{0}| + a_{0}$。\n\n我们首先将通量表达式代入半离散方程。通量差为\n$$ F_{j+\\tfrac{1}{2}} - F_{j-\\tfrac{1}{2}} = \\left[ \\tfrac{1}{2}(F(q_{j}) + F(q_{j+1})) - \\tfrac{1}{2}\\alpha(q_{j+1} - q_{j}) \\right] - \\left[ \\tfrac{1}{2}(F(q_{j-1}) + F(q_{j})) - \\tfrac{1}{2}\\alpha(q_{j} - q_{j-1}) \\right] $$\n$$ F_{j+\\tfrac{1}{2}} - F_{j-\\tfrac{1}{2}} = \\tfrac{1}{2}\\left(F(q_{j+1}) - F(q_{j-1})\\right) - \\tfrac{1}{2}\\alpha\\left(q_{j+1} - 2q_{j} + q_{j-1}\\right) $$\n半离散格式变为\n$$ \\frac{d q_{j}}{d t} = -\\frac{1}{\\Delta x} \\left[ \\tfrac{1}{2}\\left(F(q_{j+1}) - F(q_{j-1})\\right) - \\tfrac{1}{2}\\alpha\\left(q_{j+1} - 2q_{j} + q_{j-1}\\right) \\right] $$\n\n接下来，我们围绕一个均匀基态 $q_{0} = [\\rho_{0}, \\rho_{0}u_{0}, \\rho_{0}E_{0}]^{\\top}$ 对该方程进行线性化。我们考虑小扰动 $\\delta q_{j}$，使得 $q_{j} = q_{0} + \\delta q_{j}$。通量通过一阶泰勒展开来近似：$F(q_{j}) \\approx F(q_{0}) + A \\delta q_{j}$，其中 $A = \\left.\\frac{\\partial F}{\\partial q}\\right|_{q_0}$ 是在基态下求值的常数通量雅可比矩阵。\n由于 $q_{0}$ 是常数，$F(q_{0})$ 也是常数，且 $\\frac{d q_{0}}{d t} = 0$。扰动 $\\delta q_{j}$ 的线性化方程为\n$$ \\frac{d \\delta q_{j}}{d t} = -\\frac{1}{\\Delta x} \\left[ \\tfrac{1}{2}\\left((F(q_{0}) + A\\delta q_{j+1}) - (F(q_{0}) + A\\delta q_{j-1})\\right) - \\tfrac{1}{2}\\alpha\\left((q_{0}+\\delta q_{j+1}) - 2(q_{0}+\\delta q_{j}) + (q_{0}+\\delta q_{j-1})\\right) \\right] $$\n$$ \\frac{d \\delta q_{j}}{d t} = -\\frac{1}{\\Delta x} \\left[ \\tfrac{1}{2}A\\left(\\delta q_{j+1} - \\delta q_{j-1}\\right) - \\tfrac{1}{2}\\alpha\\left(\\delta q_{j+1} - 2\\delta q_{j} + \\delta q_{j-1}\\right) \\right] $$\n该方程可以写成 $\\frac{d \\delta q_{j}}{d t} = \\mathcal{L}(\\delta q)_{j}$，其中 $\\mathcal{L}$ 是线性空间离散算子。\n\n为了找到该算子的特征值，我们进行傅里叶分析。我们考虑扰动的单个傅里叶模态：\n$$ \\delta q_{j}(t) = \\widehat{q}(t) \\exp(i j \\theta) $$\n其中 $\\theta = k \\Delta x$ 是无量纲波数，$k$ 是物理波数，$\\widehat{q}(t)$ 是随时间变化的傅里叶振幅向量。将此代入线性化方程：\n$$ \\frac{d \\widehat{q}}{dt} \\exp(ij\\theta) = -\\frac{1}{\\Delta x} \\left[ \\tfrac{1}{2}A\\left(\\widehat{q}e^{i(j+1)\\theta} - \\widehat{q}e^{i(j-1)\\theta}\\right) - \\tfrac{1}{2}\\alpha I\\left(\\widehat{q}e^{i(j+1)\\theta} - 2\\widehat{q}e^{ij\\theta} + \\widehat{q}e^{i(j-1)\\theta}\\right) \\right] $$\n其中 $I$ 是单位矩阵。从每一项中提出因子 $\\widehat{q}(t)\\exp(ij\\theta)$，我们得到\n$$ \\frac{d \\widehat{q}}{dt} = -\\frac{1}{\\Delta x} \\left[ \\tfrac{1}{2}A\\left(e^{i\\theta} - e^{-i\\theta}\\right) - \\tfrac{1}{2}\\alpha I\\left(e^{i\\theta} - 2 + e^{-i\\theta}\\right) \\right] \\widehat{q} $$\n使用恒等式 $e^{i\\theta} - e^{-i\\theta} = 2i\\sin\\theta$ 和 $e^{i\\theta} + e^{-i\\theta} - 2 = 2\\cos\\theta - 2 = -4\\sin^2(\\theta/2) = -2(1-\\cos\\theta)$，方程变为：\n$$ \\frac{d \\widehat{q}}{dt} = -\\frac{1}{\\Delta x} \\left[ \\tfrac{1}{2}A(2i\\sin\\theta) - \\tfrac{1}{2}\\alpha I(2\\cos\\theta - 2) \\right] \\widehat{q} $$\n$$ \\frac{d \\widehat{q}}{dt} = \\left[ -\\frac{iA\\sin\\theta}{\\Delta x} - \\frac{\\alpha(1-\\cos\\theta)}{\\Delta x}I \\right] \\widehat{q} $$\n右侧的矩阵是空间算子 $\\mathcal{L}$ 的符号，我们将其记为 $\\widehat{\\mathcal{L}}(\\theta)$。傅里叶空间中的半离散系统为 $\\frac{d\\widehat{q}}{dt} = \\widehat{\\mathcal{L}}(\\theta) \\widehat{q}$。\n半离散特征值，记作 $s(\\theta)$，是矩阵 $\\widehat{\\mathcal{L}}(\\theta)$ 的特征值。\n$$ \\widehat{\\mathcal{L}}(\\theta) = -\\frac{1}{\\Delta x} \\left[ i\\sin\\theta A + (1-\\cos\\theta)\\alpha I \\right] $$\n雅可比矩阵 $A$ 可对角化，其实特征值为 $\\lambda \\in \\{u_{0}-a_{0}, u_{0}, u_{0}+a_{0}\\}$。设 $A=R\\Lambda L$ 是 $A$ 的特征分解，其中 $\\Lambda$ 是由特征值 $\\lambda$ 构成的对角矩阵。矩阵 $A$ 和 $I$ 可交换。因此，$\\widehat{\\mathcal{L}}(\\theta)$ 的特征值可以通过将矩阵 $A$ 替换为其标量特征值 $\\lambda$ 来找到。对应于速度为 $\\lambda$ 的特征场的空间算子的特征值为：\n$$ s(\\lambda, \\theta) = -\\frac{1}{\\Delta x} \\left[ i\\lambda\\sin\\theta + \\alpha(1-\\cos\\theta) \\right] $$\n此表达式是空间离散算子的半离散特征值。\n\n为了量化数值耗散和数值色散，我们分析 $s(\\lambda, \\theta)$ 的实部和虚部。特征模态振幅的解随 $\\exp(s(\\lambda, \\theta) t)$ 演化。\n特征值的实部控制数值解的振幅（耗散）：\n$$ \\Re[s(\\lambda, \\theta)] = -\\frac{\\alpha(1-\\cos\\theta)}{\\Delta x} $$\n由于 $\\alpha = |u_{0}| + a_{0} > 0$ 且 $1-\\cos\\theta \\ge 0$，我们有 $\\Re[s(\\lambda, \\theta)] \\le 0$。负实部导致振幅的指数衰减，这对应于数值耗散。这种耗散对高波数模态的阻尼最强（在 $1-\\cos\\theta$ 最大处），并确保了半离散格式的稳定性。\n\n特征值的虚部控制数值解的相位（色散）：\n$$ \\Im[s(\\lambda, \\theta)] = -\\frac{\\lambda\\sin\\theta}{\\Delta x} $$\n数值相速度 $v_{\\text{ph}}$ 由 $v_{\\text{ph}} = -\\Im[s(\\lambda, \\theta)]/k$ 给出。由于 $\\theta = k\\Delta x$，我们有 $k=\\theta/\\Delta x$。\n$$ v_{\\text{ph}} = -\\frac{-\\lambda\\sin\\theta / \\Delta x}{\\theta / \\Delta x} = \\lambda\\frac{\\sin\\theta}{\\theta} $$\n连续方程 $\\partial_t u + \\lambda \\partial_x u = 0$ 的精确相速度为 $\\lambda$。比率 $v_{\\text{ph}}/\\lambda = (\\sin\\theta)/\\theta$ 表征了数值色散误差。对于小 $\\theta$，$ (\\sin\\theta)/\\theta \\approx 1 - \\theta^2/6$，这表明数值波滞后于真实波，这是此类格式的一个特点。当 $\\theta \\to 0$ 时，数值相速度正确地趋近于物理波速 $\\lambda$。\n\n所要求的最终答案是 $s(\\lambda, \\theta)$ 的闭式解析表达式。",
            "answer": "$$\n\\boxed{-\\frac{1}{\\Delta x} \\left( i \\lambda \\sin(\\theta) + \\alpha(1 - \\cos(\\theta)) \\right)}\n$$"
        },
        {
            "introduction": "虽然高阶格式能更准确地捕捉激波和接触间断等复杂流动结构，但它们也容易在陡峭梯度附近产生非物理的振荡，可能导致密度或压力变为负值，从而使模拟崩溃。本练习  探讨了斜坡限制器在保证解的物理实在性方面的关键作用。通过对比在守恒变量空间和原始变量空间中应用限制器的后果，你将揭示两者之间的非线性关系如何影响求解器的鲁棒性，并理解为何在原始变量上进行限制通常是更安全、更稳健的选择。",
            "id": "3307215",
            "problem": "考虑计算流体动力学 (CFD) 中可压缩欧拉方程的有限体积 (FV) 离散化中的一个一维单元。基于密度的格式推进守恒变量 $\\boldsymbol{U} = (\\rho, \\rho u, \\rho E)$，其中 $\\rho$ 是密度，$u$ 是速度，$E$ 是单位质量总能量。原始变量为 $\\boldsymbol{W} = (\\rho, u, p)$，其中 $p$ 是压力。理想气体的状态方程为 $p = (\\gamma - 1)\\left(\\rho E - \\tfrac{1}{2}\\dfrac{(\\rho u)^{2}}{\\rho}\\right)$，其中 $\\gamma$ 是比热比。\n\n你将一个带有参数 $\\theta \\in [0,1]$ 的线性缩放限制器应用于相对于单元平均状态的候选面状态，此操作可在守恒变量空间或原始变量空间中进行。具体来说，对于守恒变量限制，定义 $\\boldsymbol{U}(\\theta) = \\bar{\\boldsymbol{U}} + \\theta\\left(\\boldsymbol{U}^{*} - \\bar{\\boldsymbol{U}}\\right)$；对于原始变量限制，定义 $\\boldsymbol{W}(\\theta) = \\bar{\\boldsymbol{W}} + \\theta\\left(\\boldsymbol{W}^{*} - \\bar{\\boldsymbol{W}}\\right)$。此处，$\\bar{\\boldsymbol{U}}$ 和 $\\bar{\\boldsymbol{W}}$ 分别是单元平均的守恒状态和原始状态，而 $\\boldsymbol{U}^{*}$ 和 $\\boldsymbol{W}^{*}$ 是相应空间中未限制的候选面状态。\n\n从可压缩欧拉方程和理想气体状态方程出发，从第一性原理推导在守恒变量中进行限制与在原始变量中进行限制时，为保持密度和压力的严格正性（即 $\\rho(\\theta) > 0$ 和 $p(\\theta) > 0$）所必需的关于 $\\theta$ 的条件。你的推导必须从守恒变量、原始变量的定义以及状态方程开始，并且不得引用任何预先推导的限制器公式。解释在守恒变量限制下 $p(\\theta)$ 的非线性如何导致比在原始变量限制下更严格的约束，并利用此推理提出一个选择限制空间的准则，该准则在保持 $\\rho(\\theta) > 0$ 和 $p(\\theta) > 0$ 的同时最大化鲁棒性。\n\n然后，对于以下物理上合理的数据，评估由守恒变量正性条件所决定的可行 $\\theta$ 值：\n\n- 比热比：$\\gamma = 1.4$。\n- 单元平均原始状态：$\\bar{\\boldsymbol{W}} = (\\bar{\\rho}, \\bar{u}, \\bar{p}) = (0.1, 1000, 10000)$。\n- 单元平均守恒状态：$\\bar{\\boldsymbol{U}} = (\\bar{\\rho}, \\bar{m}, \\bar{\\tau})$，其中 $\\bar{m} = \\bar{\\rho}\\bar{u}$ 且 $\\bar{\\tau} = \\bar{\\rho} \\bar{E}$，而 $\\bar{E} = \\dfrac{\\bar{p}}{(\\gamma - 1)\\bar{\\rho}} + \\dfrac{1}{2}\\bar{u}^{2}$。\n- 未限制的候选面守恒状态：$\\boldsymbol{U}^{*} = (\\rho^{*}, m^{*}, \\tau^{*}) = (0.05, 300, 10000)$。\n- 未限制的候选面原始状态：$\\boldsymbol{W}^{*} = (\\rho^{*}_{\\mathrm{prim}}, u^{*}_{\\mathrm{prim}}, p^{*}_{\\mathrm{prim}}) = (0.05, 6000, 1000)$。\n\n计算针对 $p(\\theta) > 0$ 的守恒正性条件的最小正根，并将其表示为 $\\theta_{+}^{\\mathrm{cons}}$。将最终数值答案表示为一个纯数。将答案四舍五入到四位有效数字。",
            "solution": "该问题陈述经评估是科学上合理的、良定的、客观的且自洽的。这是计算流体动力学数值方法分析中的一个标准问题。所提供的数据是一致且物理上合理的。因此，该问题被认为是有效的，下面提供完整解答。\n\n核心任务是推导并比较当对原始变量 $\\boldsymbol{W} = (\\rho, u, p)$ 或守恒变量 $\\boldsymbol{U} = (\\rho, \\rho u, \\rho E)$ 应用线性缩放限制器时，保持密度 $\\rho$ 和压力 $p$ 正性的条件。\n\n首先，我们定义变量之间的关系。守恒变量为 $\\boldsymbol{U} = (\\rho, m, \\tau)$，其中 $m = \\rho u$ 是动量密度，$\\tau = \\rho E$ 是总能量密度。单位质量总能量 $E$ 是单位质量内能 $e$ 和单位质量动能之和，$E = e + \\frac{1}{2}u^2$。对于理想气体，压力 $p$ 通过 $p = (\\gamma-1)\\rho e$ 与内能相关。将 $e = E - \\frac{1}{2}u^2$ 代入，得到 $p = (\\gamma-1)(\\rho E - \\frac{1}{2}\\rho u^2)$。直接用守恒变量表示，即可得到给定的状态方程：\n$$p = (\\gamma - 1)\\left(\\tau - \\frac{1}{2}\\frac{m^2}{\\rho}\\right)$$\n\n### 原始变量限制的正性条件\n\n当对原始变量 $\\boldsymbol{W} = (\\rho, u, p)$ 进行限制时，受限状态 $\\boldsymbol{W}(\\theta)$ 是单元平均状态 $\\bar{\\boldsymbol{W}} = (\\bar{\\rho}, \\bar{u}, \\bar{p})$ 和未限制的面状态 $\\boldsymbol{W}^{*} = (\\rho^{*}_{\\mathrm{prim}}, u^{*}_{\\mathrm{prim}}, p^{*}_{\\mathrm{prim}})$ 之间的线性插值。\n$$\\boldsymbol{W}(\\theta) = \\bar{\\boldsymbol{W}} + \\theta(\\boldsymbol{W}^{*} - \\bar{\\boldsymbol{W}})$$\n受限状态的分量为：\n$$\\rho(\\theta) = \\bar{\\rho} + \\theta(\\rho^{*}_{\\mathrm{prim}} - \\bar{\\rho})$$\n$$p(\\theta) = \\bar{p} + \\theta(p^{*}_{\\mathrm{prim}} - \\bar{p})$$\n正性约束 $\\rho(\\theta) > 0$ 和 $p(\\theta) > 0$ 是关于 $\\theta$ 的线性不等式。\n\n对于密度正性，$\\bar{\\rho} + \\theta(\\rho^{*}_{\\mathrm{prim}} - \\bar{\\rho}) > 0$。如果 $\\rho^{*}_{\\mathrm{prim}} \\ge \\bar{\\rho}$，由于 $\\bar{\\rho} > 0$，此条件对 $\\theta \\ge 0$ 恒成立。如果 $\\rho^{*}_{\\mathrm{prim}} < \\bar{\\rho}$，条件变为 $\\theta < \\frac{\\bar{\\rho}}{\\bar{\\rho} - \\rho^{*}_{\\mathrm{prim}}}$。\n\n对于压力正性，$\\bar{p} + \\theta(p^{*}_{\\mathrm{prim}} - \\bar{p}) > 0$。如果 $p^{*}_{\\mathrm{prim}} \\ge \\bar{p}$，由于 $\\bar{p} > 0$，此条件对 $\\theta \\ge 0$ 恒成立。如果 $p^{*}_{\\mathrm{prim}} < \\bar{p}$，条件为 $\\theta < \\frac{\\bar{p}}{\\bar{p} - p^{*}_{\\mathrm{prim}}}$。\n\n由于 $\\theta \\in [0, 1]$，总体要求是 $\\theta$ 必须小于 1 以及从这些线性不等式推导出的任何上界。关键的观察是，如果单元平均状态（$\\theta=0$）和未限制的面状态（$\\theta=1$）都具有正密度和正压力，那么对于 $\\theta \\in [0, 1]$ 的任何线性组合也将具有正密度和正压力。\n\n### 守恒变量限制的正性条件\n\n当对守恒变量 $\\boldsymbol{U} = (\\rho, m, \\tau)$ 进行限制时，受限状态为：\n$$\\boldsymbol{U}(\\theta) = \\bar{\\boldsymbol{U}} + \\theta(\\boldsymbol{U}^{*} - \\bar{\\boldsymbol{U}})$$\n令 $\\Delta\\boldsymbol{U} = \\boldsymbol{U}^{*} - \\bar{\\boldsymbol{U}}$，各分量为：\n$$\\rho(\\theta) = \\bar{\\rho} + \\theta\\Delta\\rho$$\n$$m(\\theta) = \\bar{m} + \\theta\\Delta m$$\n$$\\tau(\\theta) = \\bar{\\tau} + \\theta\\Delta\\tau$$\n\n密度正性约束 $\\rho(\\theta) > 0$ 在形式上与原始变量情况相同：\n$$\\bar{\\rho} + \\theta\\Delta\\rho > 0$$\n这是一个关于 $\\theta$ 的线性不等式。如果 $\\Delta\\rho < 0$，它施加了约束 $\\theta < \\frac{\\bar{\\rho}}{-\\Delta\\rho} = \\frac{\\bar{\\rho}}{\\bar{\\rho} - \\rho^{*}}$。\n\n压力正性约束 $p(\\theta) > 0$ 更为复杂。我们使用带有受限守恒变量的状态方程。由于 $\\gamma-1 > 0$，条件 $p(\\theta) > 0$ 等价于：\n$$\\tau(\\theta) - \\frac{1}{2}\\frac{m(\\theta)^2}{\\rho(\\theta)} > 0$$\n为避免除以一个依赖于 $\\theta$ 的项，我们乘以 $2\\rho(\\theta)$。由于我们强制要求 $\\rho(\\theta) > 0$，这不会改变不等式的方向：\n$$2\\rho(\\theta)\\tau(\\theta) - m(\\theta)^2 > 0$$\n代入受限守恒变量的线性表达式：\n$$2(\\bar{\\rho} + \\theta\\Delta\\rho)(\\bar{\\tau} + \\theta\\Delta\\tau) - (\\bar{m} + \\theta\\Delta m)^2 > 0$$\n展开此表达式得到一个关于 $\\theta$ 的二次不等式，形式为 $A\\theta^2 + B\\theta + C > 0$：\n$$2(\\bar{\\rho}\\bar{\\tau} + \\theta(\\bar{\\rho}\\Delta\\tau+\\bar{\\tau}\\Delta\\rho) + \\theta^2\\Delta\\rho\\Delta\\tau) - (\\bar{m}^2 + 2\\theta\\bar{m}\\Delta m + \\theta^2(\\Delta m)^2) > 0$$\n按 $\\theta$ 的幂次整理：\n$$(2\\Delta\\rho\\Delta\\tau - (\\Delta m)^2)\\theta^2 + 2(\\bar{\\rho}\\Delta\\tau+\\bar{\\tau}\\Delta\\rho - \\bar{m}\\Delta m)\\theta + (2\\bar{\\rho}\\bar{\\tau} - \\bar{m}^2) > 0$$\n系数为：\n$$A = 2\\Delta\\rho\\Delta\\tau - (\\Delta m)^2$$\n$$B = 2(\\bar{\\rho}\\Delta\\tau + \\bar{\\tau}\\Delta\\rho - \\bar{m}\\Delta m)$$\n$$C = 2\\bar{\\rho}\\bar{\\tau} - \\bar{m}^2$$\n常数项 $C$ 对应于 $\\theta=0$ 时的状态。我们可以验证它与单元平均压力成正比：\n$$C = 2\\bar{\\rho}(\\bar{\\rho}\\bar{E}) - (\\bar{\\rho}\\bar{u})^2 = 2\\bar{\\rho}^2(\\bar{E} - \\frac{1}{2}\\bar{u}^2) = 2\\bar{\\rho}^2\\left(\\frac{\\bar{p}}{(\\gamma - 1)\\bar{\\rho}}\\right) = \\frac{2\\bar{\\rho}\\bar{p}}{\\gamma - 1}$$\n由于对于一个有效的单元平均值，$\\bar{\\rho} > 0$ 且 $\\bar{p} > 0$，所以 $C > 0$。\n\n### 鲁棒性的比较与准则\n\n在守恒变量限制下，$p(\\theta)$ 的非线性源于动能项 $\\frac{1}{2}\\rho u^2 = \\frac{1}{2}m^2/\\rho$。当 $m$ 和 $\\rho$ 是 $\\theta$ 的线性函数时，它们的比值不是。这导致了压力正性的二次不等式。一个二次函数 $f(\\theta) = A\\theta^2 + B\\theta + C$ 是一条抛物线。即使 $p(0) > 0$（即 $C>0$）和 $p(1) > 0$，如果抛物线在该区间内有根并且开口向下（$A<0$），压力 $p(\\theta)$ 仍可能在某个 $\\theta \\in (0,1)$ 处变为负值。这是鲁棒性的一个严重缺陷。相比之下，在原始变量中进行限制会使得 $\\rho(\\theta)$ 和 $p(\\theta)$ 都是线性函数。一个连接两个正端点的线性函数保证在整个区间内都为正。\n\n因此，更严格的约束源于在守恒变量限制下压力可能出现的非单调行为。为了在保持正性的同时最大化鲁棒性，准则是**在原始变量 $(\\rho, u, p)$ 的空间中执行限制过程**。这确保了正性约束是线性的且容易满足。一个常见的鲁棒算法是：1) 将原始变量重构到单元面，2) 对原始变量应用限制器以获得受限的面状态，3) 将受限的原始变量面状态转换回守恒变量以进行通量计算。\n\n### 守恒变量限制的数值评估\n\n给定以下数据：\n- $\\gamma = 1.4$\n- $\\bar{\\boldsymbol{W}} = (\\bar{\\rho}, \\bar{u}, \\bar{p}) = (0.1, 1000, 10000)$\n- $\\boldsymbol{U}^{*} = (\\rho^{*}, m^{*}, \\tau^{*}) = (0.05, 300, 10000)$\n\n首先，我们计算单元平均守恒状态 $\\bar{\\boldsymbol{U}} = (\\bar{\\rho}, \\bar{m}, \\bar{\\tau})$。\n$\\bar{\\rho} = 0.1$\n$\\bar{m} = \\bar{\\rho}\\bar{u} = 0.1 \\times 1000 = 100$\n单位质量总能量为 $\\bar{E} = \\frac{\\bar{p}}{(\\gamma - 1)\\bar{\\rho}} + \\frac{1}{2}\\bar{u}^{2}$：\n$\\bar{E} = \\frac{10000}{(1.4 - 1) \\times 0.1} + \\frac{1}{2}(1000)^2 = \\frac{10000}{0.04} + 500000 = 250000 + 500000 = 750000$\n总能量密度为 $\\bar{\\tau} = \\bar{\\rho}\\bar{E} = 0.1 \\times 750000 = 75000$。\n所以，$\\bar{\\boldsymbol{U}} = (0.1, 100, 75000)$。\n\n接下来，我们计算差值 $\\Delta\\boldsymbol{U} = \\boldsymbol{U}^{*} - \\bar{\\boldsymbol{U}}$。\n$\\Delta\\rho = \\rho^{*} - \\bar{\\rho} = 0.05 - 0.1 = -0.05$\n$\\Delta m = m^{*} - \\bar{m} = 300 - 100 = 200$\n$\\Delta\\tau = \\tau^{*} - \\bar{\\tau} = 10000 - 75000 = -65000$\n\n现在，我们计算二次不等式 $p(\\theta)>0$ 的系数 $A, B, C$。\n$A = 2\\Delta\\rho\\Delta\\tau - (\\Delta m)^2 = 2(-0.05)(-65000) - (200)^2 = 6500 - 40000 = -33500$\n$B = 2(\\bar{\\rho}\\Delta\\tau + \\bar{\\tau}\\Delta\\rho - \\bar{m}\\Delta m) = 2(0.1(-65000) + 75000(-0.05) - 100(200))$\n$B = 2(-6500 - 3750 - 20000) = 2(-30250) = -60500$\n$C = 2\\bar{\\rho}\\bar{\\tau} - \\bar{m}^2 = 2(0.1)(75000) - (100)^2 = 15000 - 10000 = 5000$\n\n压力正性条件是二次不等式：\n$$-33500\\theta^2 - 60500\\theta + 5000 > 0$$\n两边除以-500，不等式反向：\n$$67\\theta^2 + 121\\theta - 10 < 0$$\n二次方程 $67\\theta^2 + 121\\theta - 10 = 0$ 的根由求根公式 $\\theta = \\frac{-b \\pm \\sqrt{b^2-4ac}}{2a}$ 给出：\n$$\\theta = \\frac{-121 \\pm \\sqrt{121^2 - 4(67)(-10)}}{2(67)} = \\frac{-121 \\pm \\sqrt{14641 + 2680}}{134} = \\frac{-121 \\pm \\sqrt{17321}}{134}$$\n两个根是：\n$$\\theta_1 = \\frac{-121 - \\sqrt{17321}}{134} \\approx \\frac{-121 - 131.609}{134} \\approx -1.8851$$\n$$\\theta_2 = \\frac{-121 + \\sqrt{17321}}{134} \\approx \\frac{-121 + 131.609}{134} \\approx 0.079174$$\n由于抛物线 $67\\theta^2 + 121\\theta - 10$ 开口向上，不等式在两根之间成立，即对于 $\\theta \\in (\\theta_1, \\theta_2) \\approx (-1.8851, 0.079174)$ 成立。\n参数 $\\theta$ 也必须在区间 $[0, 1]$ 内。这些范围的交集是 $[0, \\theta_2)$。因此 $\\theta$ 的上界是二次方程的最小正根，我们将其表示为 $\\theta_{+}^{\\mathrm{cons}}$。\n$$\\theta_{+}^{\\mathrm{cons}} = \\frac{-121 + \\sqrt{17321}}{134} \\approx 0.0791736...$$\n为完整起见，密度正性条件是 $\\rho(\\theta) = 0.1 - 0.05\\theta > 0$，这给出 $\\theta < \\frac{0.1}{0.05}=2$。这比压力约束要弱得多。\n$\\theta$ 的容许值受压力约束的限制。限定可接受范围的最小正根是 $\\theta_{+}^{\\mathrm{cons}}$。四舍五入到四位有效数字，我们得到 $0.07917$。",
            "answer": "$$ \\boxed{0.07917} $$"
        }
    ]
}