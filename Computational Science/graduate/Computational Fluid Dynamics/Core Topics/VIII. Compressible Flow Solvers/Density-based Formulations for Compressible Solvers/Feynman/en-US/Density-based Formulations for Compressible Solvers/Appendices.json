{
    "hands_on_practices": [
        {
            "introduction": "In a density-based solver, the equations of motion are solved for a set of conserved variables, namely mass, momentum, and total energy densities $(\\rho, \\rho \\boldsymbol{u}, \\rho E)$. However, the calculation of fluxes and other physical properties often requires primitive variables like pressure $p$ and temperature $T$. This practice guides you through the essential \"decoding\" process of deriving the temperature from the conserved state vector for an ideal gas, a foundational skill for understanding and implementing compressible flow solvers .",
            "id": "3307255",
            "problem": "Consider a single-component, inviscid, compressible ideal gas modeled in a three-dimensional ($3$D) density-based formulation for Computational Fluid Dynamics (CFD). The conserved variables per unit volume are the mass density $\\rho$, the momentum densities $\\rho u$, $\\rho v$, $\\rho w$, and the total energy density $\\rho E$, where $E$ is the total energy per unit mass. The primitive variables are the velocity components $u$, $v$, $w$, the pressure $p$, and the temperature $T$. Assume the gas is calorically perfect with constant specific heat ratio $\\gamma > 1$ and specific gas constant $R > 0$. The density-based update advances the conserved variables, and the primitive variables must be reconstructed from these.\n\nStarting from fundamental principles, namely:\n- the definition of total specific energy $E$ as the sum of specific internal energy $e$ and specific kinetic energy,\n- the ideal gas equation of state $p = \\rho R T$,\n- and the caloric relation for a calorically perfect gas $e = c_{v} T$ with $c_{v} = \\frac{R}{\\gamma - 1}$,\n\nderive a closed-form expression for the temperature $T$ in terms of the conserved variables and thermodynamic parameters, and explain (qualitatively, without numerical implementation details) how, in a density-based solver, one should consistently reconstruct and maintain agreement among $p$, $T$, and $E$ after each update of the conserved variables. Your derivation must start from the stated foundational relations and proceed by eliminating non-primitive quantities using definitions valid for a density-based formulation.\n\nProvide the final expression for $T$ as your answer. No numerical evaluation is required. Express the final answer as a single analytic expression. No units are to be included in the final boxed answer.",
            "solution": "The problem statement is evaluated to be **valid**. It is scientifically grounded in the principles of thermodynamics and fluid dynamics, specifically the model of a calorically perfect ideal gas. The problem is well-posed, objective, and provides a complete and consistent set of definitions and relations required to derive the requested expression and provide the subsequent explanation. The task is a standard derivation in the field of computational fluid dynamics and does not contain any of the flaws listed in the validation criteria.\n\nThe objective is to derive a closed-form expression for the temperature $T$ in terms of the conserved variables per unit volume: the mass density $\\rho$, the momentum densities $\\rho u$, $\\rho v$, $\\rho w$, and the total energy density $\\rho E$. The derivation begins from the fundamental principles provided.\n\nLet the vector of conserved variables be $\\mathbf{U} = [\\rho, \\rho u, \\rho v, \\rho w, \\rho E]^T$.\n\nThe first principle is the definition of the total energy per unit mass, $E$, as the sum of the specific internal energy, $e$, and the specific kinetic energy, $K$.\n$$E = e + K$$\nThe specific kinetic energy for a $3$D flow is given by:\n$$K = \\frac{1}{2} (u^2 + v^2 + w^2)$$\nTherefore, the total energy per unit mass is:\n$$E = e + \\frac{1}{2} (u^2 + v^2 + w^2)$$\nTo work with quantities per unit volume, as is conventional in a density-based formulation, we multiply by the mass density $\\rho$:\n$$\\rho E = \\rho e + \\frac{1}{2} \\rho (u^2 + v^2 + w^2)$$\n\nThe second principle is the caloric equation of state for a calorically perfect gas, which relates the specific internal energy $e$ to the temperature $T$:\n$$e = c_v T$$\nwhere $c_v$ is the specific heat at constant volume. The problem provides the relation for $c_v$ in terms of the specific gas constant $R$ and the specific heat ratio $\\gamma$:\n$$c_v = \\frac{R}{\\gamma - 1}$$\nSubstituting the expression for $e$ into the equation for $\\rho E$:\n$$\\rho E = \\rho (c_v T) + \\frac{1}{2} \\rho (u^2 + v^2 + w^2)$$\n\nThe next step is to express all terms on the right-hand side, other than $T$, using the conserved variables. The velocity components $u$, $v$, and $w$ are not conserved variables themselves, but are related to the conserved momentum densities and mass density:\n$$u = \\frac{\\rho u}{\\rho}, \\quad v = \\frac{\\rho v}{\\rho}, \\quad w = \\frac{\\rho w}{\\rho}$$\nThe kinetic energy per unit volume, $\\frac{1}{2} \\rho (u^2 + v^2 + w^2)$, can be rewritten using the conserved quantities:\n$$\\frac{1}{2} \\rho (u^2 + v^2 + w^2) = \\frac{1}{2} \\rho \\left( \\left(\\frac{\\rho u}{\\rho}\\right)^2 + \\left(\\frac{\\rho v}{\\rho}\\right)^2 + \\left(\\frac{\\rho w}{\\rho}\\right)^2 \\right)$$\n$$= \\frac{1}{2} \\rho \\frac{(\\rho u)^2 + (\\rho v)^2 + (\\rho w)^2}{\\rho^2}$$\n$$= \\frac{(\\rho u)^2 + (\\rho v)^2 + (\\rho w)^2}{2\\rho}$$\nNow, substitute this expression for the kinetic energy term back into the equation for the total energy density $\\rho E$:\n$$\\rho E = \\rho c_v T + \\frac{(\\rho u)^2 + (\\rho v)^2 + (\\rho w)^2}{2\\rho}$$\n\nThe goal is to solve this equation for the temperature $T$. We isolate the term containing $T$:\n$$\\rho c_v T = \\rho E - \\frac{(\\rho u)^2 + (\\rho v)^2 + (\\rho w)^2}{2\\rho}$$\nDividing by $\\rho c_v$ gives the expression for $T$:\n$$T = \\frac{1}{\\rho c_v} \\left( \\rho E - \\frac{(\\rho u)^2 + (\\rho v)^2 + (\\rho w)^2}{2\\rho} \\right)$$\nFinally, substituting the expression for $c_v = \\frac{R}{\\gamma - 1}$:\n$$T = \\frac{1}{\\rho \\left(\\frac{R}{\\gamma - 1}\\right)} \\left( \\rho E - \\frac{(\\rho u)^2 + (\\rho v)^2 + (\\rho w)^2}{2\\rho} \\right)$$\n$$T = \\frac{\\gamma - 1}{\\rho R} \\left( \\rho E - \\frac{(\\rho u)^2 + (\\rho v)^2 + (\\rho w)^2}{2\\rho} \\right)$$\nThis is the desired closed-form expression for temperature $T$ exclusively in terms of the conserved variables and the constant gas parameters $\\gamma$ and $R$.\n\nRegarding the second part of the question, the consistent reconstruction of primitive variables ($p, T$) from the conserved variables ($\\rho E$, etc.) is a fundamental procedure in any density-based solver. The conservation laws (e.g., the Euler equations) are solved numerically for the vector of conserved variables $\\mathbf{U} = [\\rho, \\rho u, \\rho v, \\rho w, \\rho E]^T$. This means that at the end of each time step (or Runge-Kutta stage), the solver produces an updated state vector $\\mathbf{U}^{n+1}$.\n\nTo calculate quantities needed for the next time step, such as the fluxes (which depend on primitive variables like pressure $p$), or for post-processing, the primitive variables $\\mathbf{W} = [\\rho, u, v, w, p, T]^T$ must be recovered from $\\mathbf{U}^{n+1}$. This reconstruction, often called \"decoding the state vector,\" is a deterministic process that enforces consistency among all thermodynamic and kinematic properties. The procedure is as follows:\n\n1.  The updated density $\\rho$ is directly available from the first component of $\\mathbf{U}^{n+1}$.\n2.  The velocity components are calculated by dividing the momentum densities by the mass density: $u = (\\rho u)/\\rho$, $v = (\\rho v)/\\rho$, $w = (\\rho w)/\\rho$.\n3.  The total energy density $\\rho E$ is known from the fifth component of $\\mathbf{U}^{n+1}$. The kinetic energy per unit volume is calculated from the already-found density and momentum densities. The internal energy density is then found by subtraction: $\\rho e = \\rho E - \\frac{1}{2\\rho}((\\rho u)^2 + (\\rho v)^2 + (\\rho w)^2)$.\n4.  The temperature $T$ is then calculated from the internal energy using the caloric relation, $e = c_v T$, which is equivalent to using the explicit formula for $T$ derived above. This step directly and uniquely links the thermal state ($T$) to the total energy state ($\\rho E$) and the kinematic state (the momentum densities).\n5.  Finally, the pressure $p$ is calculated using the ideal gas equation of state: $p = \\rho R T$.\n\nThe consistency among $p$, $T$, and $E$ is not something that needs to be actively \"maintained\" as if they were independent variables that could drift apart. Instead, consistency is inherently enforced by this sequential reconstruction procedure. The primitive variables $p$ and $T$ are not independent, evolved quantities in a density-based scheme; they are diagnostic variables, entirely determined by the state of the conserved variables at any given instant. By deriving $T$ from the constituents of $\\rho E$ and then deriving $p$ from $T$, the thermodynamic relationships that connect them are satisfied by definition at every point in the flow field after each update. This procedure guarantees that the pressure field used to compute fluxes is perfectly consistent with the energy field that is being conserved and evolved. Any other approach would violate the fundamental physical model.",
            "answer": "$$\n\\boxed{\\frac{\\gamma - 1}{\\rho R} \\left( \\rho E - \\frac{(\\rho u)^2 + (\\rho v)^2 + (\\rho w)^2}{2\\rho} \\right)}\n$$"
        },
        {
            "introduction": "Once we can relate conserved and primitive variables, we must turn our attention to the numerical scheme that advances the solution in time. Any discretization of the governing partial differential equations introduces numerical errors that can affect the accuracy and stability of the simulation. This exercise delves into the crucial technique of Fourier analysis to precisely quantify the numerical dissipation and dispersion—the primary sources of error—for a widely used first-order upwind scheme .",
            "id": "3307236",
            "problem": "Consider the one-dimensional Euler equations for an ideal gas written in conservative form for the conserved variables $q = [\\rho, \\rho u, \\rho E]^{\\top}$ and flux $F(q) = [\\rho u, \\rho u^{2} + p, u(\\rho E + p)]^{\\top}$, where $\\rho$ is density, $u$ is velocity, $E$ is total specific energy, and $p$ is pressure. Assume an ideal gas with ratio of specific heats $\\gamma$, so that $p = (\\gamma - 1)\\left(\\rho E - \\tfrac{1}{2}\\rho u^{2}\\right)$. Let the base state be uniform: $(\\rho_{0}, u_{0}, p_{0})$ with constant speed of sound $a_{0} = \\sqrt{\\gamma p_{0}/\\rho_{0}}$. Linearize the equations about this base state to obtain a constant-coefficient hyperbolic system $\\partial_{t} \\delta q + A \\partial_{x} \\delta q = 0$, where $A = \\left.\\partial F/\\partial q\\right|_{(\\rho_{0},u_{0},p_{0})}$ has real eigenvalues $u_{0} - a_{0}$, $u_{0}$, and $u_{0} + a_{0}$ corresponding to the left-moving acoustic, entropy (contact), and right-moving acoustic characteristic fields, respectively.\n\nDiscretize the linearized system in space using a first-order upwind finite volume method with Rusanov (local Lax–Friedrichs) flux on a uniform grid with spacing $\\Delta x$, and assume a density-based formulation so that the characteristic information is taken from the Euler flux Jacobian. For each cell $j$, the semi-discrete update is\n$$\n\\frac{d q_{j}}{d t} \\;=\\; -\\frac{1}{\\Delta x}\\left[F_{j+\\tfrac{1}{2}} - F_{j-\\tfrac{1}{2}}\\right],\n$$\nwhere the numerical flux at interface $j+\\tfrac{1}{2}$ is\n$$\nF_{j+\\tfrac{1}{2}} \\;=\\; \\tfrac{1}{2}\\left(F(q_{j}) + F(q_{j+1})\\right) \\;-\\; \\tfrac{1}{2}\\alpha\\,(q_{j+1} - q_{j}),\n$$\nwith a constant dissipation parameter frozen at the base state, $\\alpha = |u_{0}| + a_{0}$. Consider small-amplitude Fourier perturbations of the form $\\delta q_{j}(t) = \\widehat{q}\\,\\exp\\!\\left(i j \\theta - \\omega t\\right)$, where $\\theta = k\\,\\Delta x$ is the nondimensional wavenumber and $k$ is the physical wavenumber. Work entirely in the semi-discrete setting (continuous time, discrete space) and in the linear regime about the base state.\n\nStarting from the linearized conservation laws and the stated discretization, derive the linear semi-discrete symbol in Fourier space and its characteristic eigenvalues. Then, by projecting onto the characteristic fields associated with the left-moving acoustic wave, entropy (contact) wave, and right-moving acoustic wave, quantify the numerical dissipation and dispersion introduced by the discretization. Your derivation must proceed from the governing conservation laws, the linearization, and the discretization, without invoking any pre-derived modified-equation formulas.\n\nAs your final answer, provide a single closed-form analytic expression for the semi-discrete eigenvalue $s(\\lambda,\\theta)$ of the spatial discretization operator acting on a characteristic mode with characteristic speed $\\lambda \\in \\{u_{0}-a_{0},\\,u_{0},\\,u_{0}+a_{0}\\}$, expressed in terms of $\\lambda$, $\\theta$, $\\Delta x$, and $\\alpha$. Do not include units. Do not approximate or round; provide the exact expression in symbolic form.",
            "solution": "The problem requires the derivation and analysis of the semi-discrete eigenvalues for a first-order Rusanov finite volume discretization of the linearized one-dimensional Euler equations. The analysis will proceed by first linearizing the semi-discrete scheme and then applying Fourier analysis to find the eigenvalues of the resulting spatial operator.\n\nThe semi-discrete finite volume scheme for a generic cell $j$ is given by\n$$ \\frac{d q_{j}}{d t} = -\\frac{1}{\\Delta x}\\left[F_{j+\\tfrac{1}{2}} - F_{j-\\tfrac{1}{2}}\\right] $$\nwhere $q_j$ is the vector of conserved variables in cell $j$ and $\\Delta x$ is the uniform grid spacing.\n\nThe numerical flux at the interface $j+\\tfrac{1}{2}$ between cells $j$ and $j+1$ is the Rusanov (or local Lax-Friedrichs) flux:\n$$ F_{j+\\tfrac{1}{2}} = \\tfrac{1}{2}\\left(F(q_{j}) + F(q_{j+1})\\right) - \\tfrac{1}{2}\\alpha\\,(q_{j+1} - q_{j}) $$\nHere, $F(q)$ is the physical flux vector, and $\\alpha$ is a constant dissipation parameter given as $\\alpha = |u_{0}| + a_{0}$.\n\nWe first substitute the flux expression into the semi-discrete equation. The flux difference is\n$$ F_{j+\\tfrac{1}{2}} - F_{j-\\tfrac{1}{2}} = \\left[ \\tfrac{1}{2}(F(q_{j}) + F(q_{j+1})) - \\tfrac{1}{2}\\alpha(q_{j+1} - q_{j}) \\right] - \\left[ \\tfrac{1}{2}(F(q_{j-1}) + F(q_{j})) - \\tfrac{1}{2}\\alpha(q_{j} - q_{j-1}) \\right] $$\n$$ F_{j+\\tfrac{1}{2}} - F_{j-\\tfrac{1}{2}} = \\tfrac{1}{2}\\left(F(q_{j+1}) - F(q_{j-1})\\right) - \\tfrac{1}{2}\\alpha\\left(q_{j+1} - 2q_{j} + q_{j-1}\\right) $$\nThe semi-discrete scheme becomes\n$$ \\frac{d q_{j}}{d t} = -\\frac{1}{\\Delta x} \\left[ \\tfrac{1}{2}\\left(F(q_{j+1}) - F(q_{j-1})\\right) - \\tfrac{1}{2}\\alpha\\left(q_{j+1} - 2q_{j} + q_{j-1}\\right) \\right] $$\n\nNext, we linearize this equation around a uniform base state $q_{0} = [\\rho_{0}, \\rho_{0}u_{0}, \\rho_{0}E_{0}]^{\\top}$. We consider small perturbations $\\delta q_{j}$ such that $q_{j} = q_{0} + \\delta q_{j}$. The flux is approximated by a first-order Taylor expansion: $F(q_{j}) \\approx F(q_{0}) + A \\delta q_{j}$, where $A = \\left.\\frac{\\partial F}{\\partial q}\\right|_{q_0}$ is the constant flux Jacobian matrix evaluated at the base state.\nSince $q_{0}$ is constant, $F(q_{0})$ is also constant, and $\\frac{d q_{0}}{d t} = 0$. The linearized equation for the perturbation $\\delta q_{j}$ is\n$$ \\frac{d \\delta q_{j}}{d t} = -\\frac{1}{\\Delta x} \\left[ \\tfrac{1}{2}\\left((F(q_{0}) + A\\delta q_{j+1}) - (F(q_{0}) + A\\delta q_{j-1})\\right) - \\tfrac{1}{2}\\alpha\\left((q_{0}+\\delta q_{j+1}) - 2(q_{0}+\\delta q_{j}) + (q_{0}+\\delta q_{j-1})\\right) \\right] $$\n$$ \\frac{d \\delta q_{j}}{d t} = -\\frac{1}{\\Delta x} \\left[ \\tfrac{1}{2}A\\left(\\delta q_{j+1} - \\delta q_{j-1}\\right) - \\tfrac{1}{2}\\alpha\\left(\\delta q_{j+1} - 2\\delta q_{j} + \\delta q_{j-1}\\right) \\right] $$\nThis equation can be written as $\\frac{d \\delta q_{j}}{d t} = \\mathcal{L}(\\delta q)_{j}$, where $\\mathcal{L}$ is the linear spatial discretization operator.\n\nTo find the eigenvalues of this operator, we perform a Fourier analysis. We consider a single Fourier mode for the perturbation:\n$$ \\delta q_{j}(t) = \\widehat{q}(t) \\exp(i j \\theta) $$\nwhere $\\theta = k \\Delta x$ is the non-dimensional wavenumber, $k$ is the physical wavenumber, and $\\widehat{q}(t)$ is the time-dependent Fourier amplitude vector. Substituting this into the linearized equation:\n$$ \\frac{d \\widehat{q}}{dt} \\exp(ij\\theta) = -\\frac{1}{\\Delta x} \\left[ \\tfrac{1}{2}A\\left(\\widehat{q}e^{i(j+1)\\theta} - \\widehat{q}e^{i(j-1)\\theta}\\right) - \\tfrac{1}{2}\\alpha I\\left(\\widehat{q}e^{i(j+1)\\theta} - 2\\widehat{q}e^{ij\\theta} + \\widehat{q}e^{i(j-1)\\theta}\\right) \\right] $$\nwhere $I$ is the identity matrix. Factoring out $\\widehat{q}(t)\\exp(ij\\theta)$ from each term, we get\n$$ \\frac{d \\widehat{q}}{dt} = -\\frac{1}{\\Delta x} \\left[ \\tfrac{1}{2}A\\left(e^{i\\theta} - e^{-i\\theta}\\right) - \\tfrac{1}{2}\\alpha I\\left(e^{i\\theta} - 2 + e^{-i\\theta}\\right) \\right] \\widehat{q} $$\nUsing the identities $e^{i\\theta} - e^{-i\\theta} = 2i\\sin\\theta$ and $e^{i\\theta} + e^{-i\\theta} - 2 = 2\\cos\\theta - 2 = -4\\sin^2(\\theta/2) = -2(1-\\cos\\theta)$, the equation becomes:\n$$ \\frac{d \\widehat{q}}{dt} = -\\frac{1}{\\Delta x} \\left[ \\tfrac{1}{2}A(2i\\sin\\theta) - \\tfrac{1}{2}\\alpha I(2\\cos\\theta - 2) \\right] \\widehat{q} $$\n$$ \\frac{d \\widehat{q}}{dt} = \\left[ -\\frac{iA\\sin\\theta}{\\Delta x} - \\frac{\\alpha(1-\\cos\\theta)}{\\Delta x}I \\right] \\widehat{q} $$\nThe matrix on the right-hand side is the symbol of the spatial operator $\\mathcal{L}$, which we denote as $\\widehat{\\mathcal{L}}(\\theta)$. The semi-discrete system in Fourier space is $\\frac{d\\widehat{q}}{dt} = \\widehat{\\mathcal{L}}(\\theta) \\widehat{q}$.\nThe semi-discrete eigenvalues, denoted $s(\\theta)$, are the eigenvalues of the matrix $\\widehat{\\mathcal{L}}(\\theta)$.\n$$ \\widehat{\\mathcal{L}}(\\theta) = -\\frac{1}{\\Delta x} \\left[ i\\sin\\theta A + (1-\\cos\\theta)\\alpha I \\right] $$\nThe Jacobian matrix $A$ is diagonalizable with real eigenvalues $\\lambda \\in \\{u_{0}-a_{0}, u_{0}, u_{0}+a_{0}\\}$. Let $A=R\\Lambda L$ be the eigendecomposition of $A$, where $\\Lambda$ is the diagonal matrix of eigenvalues $\\lambda$. The matrices $A$ and $I$ commute. Therefore, the eigenvalues of $\\widehat{\\mathcal{L}}(\\theta)$ can be found by replacing the matrix $A$ with its scalar eigenvalues $\\lambda$. The eigenvalue of the spatial operator corresponding to the characteristic field with speed $\\lambda$ is:\n$$ s(\\lambda, \\theta) = -\\frac{1}{\\Delta x} \\left[ i\\lambda\\sin\\theta + \\alpha(1-\\cos\\theta) \\right] $$\nThis expression is the semi-discrete eigenvalue of the spatial discretization operator.\n\nTo quantify the numerical dissipation and dispersion, we analyze the real and imaginary parts of $s(\\lambda, \\theta)$. The solution for a characteristic mode amplitude evolves as $\\exp(s(\\lambda, \\theta) t)$.\nThe real part of the eigenvalue governs the amplitude of the numerical solution (dissipation):\n$$ \\Re[s(\\lambda, \\theta)] = -\\frac{\\alpha(1-\\cos\\theta)}{\\Delta x} $$\nSince $\\alpha = |u_{0}| + a_{0} > 0$ and $1-\\cos\\theta \\ge 0$, we have $\\Re[s(\\lambda, \\theta)] \\le 0$. The negative real part causes exponential decay of the amplitude, which corresponds to numerical dissipation. This dissipation damps high-wavenumber modes most strongly (where $1-\\cos\\theta$ is largest) and ensures stability of the semi-discrete scheme.\n\nThe imaginary part of the eigenvalue governs the phase of the numerical solution (dispersion):\n$$ \\Im[s(\\lambda, \\theta)] = -\\frac{\\lambda\\sin\\theta}{\\Delta x} $$\nThe numerical phase speed $v_{\\text{ph}}$ is given by $v_{\\text{ph}} = -\\Im[s(\\lambda, \\theta)]/k$. Since $\\theta = k\\Delta x$, we have $k=\\theta/\\Delta x$.\n$$ v_{\\text{ph}} = -\\frac{-\\lambda\\sin\\theta / \\Delta x}{\\theta / \\Delta x} = \\lambda\\frac{\\sin\\theta}{\\theta} $$\nThe exact phase speed for the continuous equation $\\partial_t u + \\lambda \\partial_x u = 0$ is $\\lambda$. The ratio $v_{\\text{ph}}/\\lambda = (\\sin\\theta)/\\theta$ characterizes the numerical dispersion error. For small $\\theta$, $(\\sin\\theta)/\\theta \\approx 1 - \\theta^2/6$, indicating that numerical waves lag behind the true waves, a characteristic of this type of scheme. For $\\theta \\to 0$, the numerical phase speed correctly approaches the physical wave speed $\\lambda$.\n\nThe required final answer is the closed-form analytic expression for $s(\\lambda, \\theta)$.",
            "answer": "$$\n\\boxed{-\\frac{1}{\\Delta x} \\left( i \\lambda \\sin(\\theta) + \\alpha(1 - \\cos(\\theta)) \\right)}\n$$"
        },
        {
            "introduction": "Achieving high-order accuracy in compressible flow simulations, especially those with shocks or contact discontinuities, requires the use of limiters to prevent unphysical oscillations. However, the application of limiters can itself introduce challenges to the robustness of the solver. This practice explores the critical and non-intuitive consequences of applying limiters to conservative variables versus primitive variables, demonstrating how this choice impacts the fundamental physical requirement of positive density and pressure .",
            "id": "3307215",
            "problem": "Consider a one-dimensional cell in a Finite Volume (FV) discretization of the compressible Euler equations in Computational Fluid Dynamics (CFD). The density-based formulation advances the conservative variables $\\boldsymbol{U} = (\\rho, \\rho u, \\rho E)$, where $\\rho$ is the density, $u$ is the velocity, and $E$ is the total energy per unit mass. The primitive variables are $\\boldsymbol{W} = (\\rho, u, p)$, where $p$ is the pressure. The equation of state for a perfect gas is $p = (\\gamma - 1)\\left(\\rho E - \\tfrac{1}{2}\\dfrac{(\\rho u)^{2}}{\\rho}\\right)$, where $\\gamma$ is the ratio of specific heats.\n\nYou apply a linear scaling limiter with parameter $\\theta \\in [0,1]$ to the candidate face state relative to the cell-averaged state, either in conservative space or in primitive space. Specifically, for conservative limiting, define $\\boldsymbol{U}(\\theta) = \\bar{\\boldsymbol{U}} + \\theta\\left(\\boldsymbol{U}^{*} - \\bar{\\boldsymbol{U}}\\right)$, and for primitive limiting, define $\\boldsymbol{W}(\\theta) = \\bar{\\boldsymbol{W}} + \\theta\\left(\\boldsymbol{W}^{*} - \\bar{\\boldsymbol{W}}\\right)$. Here, $\\bar{\\boldsymbol{U}}$ and $\\bar{\\boldsymbol{W}}$ are the cell-averaged conservative and primitive states, respectively, while $\\boldsymbol{U}^{*}$ and $\\boldsymbol{W}^{*}$ are the unlimited candidate face states in the corresponding spaces.\n\nStarting from the compressible Euler equations and the perfect-gas equation of state, derive from first principles the conditions on $\\theta$ necessary to preserve strict positivity of density and pressure, i.e., $\\rho(\\theta) > 0$ and $p(\\theta) > 0$, when limiting in conservative variables versus limiting in primitive variables. Your derivation must begin from the definitions of conservative and primitive variables and the equation of state, and must not invoke any pre-derived limiter formulas. Explain how the nonlinearity of $p(\\theta)$ under conservative limiting induces a stricter constraint than under primitive limiting, and use this reasoning to propose a criterion for selecting the limiting space that maximizes robustness while preserving $\\rho(\\theta) > 0$ and $p(\\theta) > 0$.\n\nThen, for the following physically plausible data, evaluate the admissible $\\theta$ dictated by the conservative-variables positivity condition:\n\n- Ratio of specific heats: $\\gamma = 1.4$.\n- Cell-averaged primitive state: $\\bar{\\boldsymbol{W}} = (\\bar{\\rho}, \\bar{u}, \\bar{p}) = (0.1, 1000, 10000)$.\n- Cell-averaged conservative state: $\\bar{\\boldsymbol{U}} = (\\bar{\\rho}, \\bar{m}, \\bar{\\tau})$, where $\\bar{m} = \\bar{\\rho}\\bar{u}$ and $\\bar{\\tau} = \\bar{\\rho} \\bar{E}$ with $\\bar{E} = \\dfrac{\\bar{p}}{(\\gamma - 1)\\bar{\\rho}} + \\dfrac{1}{2}\\bar{u}^{2}$.\n- Unlimited candidate face conservative state: $\\boldsymbol{U}^{*} = (\\rho^{*}, m^{*}, \\tau^{*}) = (0.05, 300, 10000)$.\n- Unlimited candidate face primitive state: $\\boldsymbol{W}^{*} = (\\rho^{*}_{\\mathrm{prim}}, u^{*}_{\\mathrm{prim}}, p^{*}_{\\mathrm{prim}}) = (0.05, 6000, 1000)$.\n\nCompute the smallest positive root of the conservative positivity condition for $p(\\theta) > 0$ and denote it by $\\theta_{+}^{\\mathrm{cons}}$. Express your final numerical answer as a pure number. Round your answer to four significant figures.",
            "solution": "The problem statement is evaluated as scientifically grounded, well-posed, objective, and self-contained. It is a standard problem in the analysis of numerical methods for computational fluid dynamics. The data provided are consistent and physically plausible. Therefore, the problem is deemed valid and a full solution is provided below.\n\nThe core task is to derive and compare the conditions for preserving positivity of density $\\rho$ and pressure $p$ when applying a linear scaling limiter to either primitive variables $\\boldsymbol{W} = (\\rho, u, p)$ or conservative variables $\\boldsymbol{U} = (\\rho, \\rho u, \\rho E)$.\n\nFirst, we define the relationships between the variables. The conservative variables are $\\boldsymbol{U} = (\\rho, m, \\tau)$ where $m = \\rho u$ is the momentum density and $\\tau = \\rho E$ is the total energy density. The total energy per unit mass $E$ is the sum of internal energy per unit mass $e$ and kinetic energy per unit mass, $E = e + \\frac{1}{2}u^2$. For a perfect gas, the pressure $p$ is related to the internal energy by $p = (\\gamma-1)\\rho e$. Substituting $e = E - \\frac{1}{2}u^2$ gives $p = (\\gamma-1)(\\rho E - \\frac{1}{2}\\rho u^2)$. Expressing this in terms of conservative variables directly yields the given equation of state:\n$$p = (\\gamma - 1)\\left(\\tau - \\frac{1}{2}\\frac{m^2}{\\rho}\\right)$$\n\n### Positivity Conditions for Primitive Variable Limiting\n\nWhen limiting is performed on the primitive variables $\\boldsymbol{W} = (\\rho, u, p)$, the limited state $\\boldsymbol{W}(\\theta)$ is a linear interpolation between the cell-averaged state $\\bar{\\boldsymbol{W}} = (\\bar{\\rho}, \\bar{u}, \\bar{p})$ and the unlimited face state $\\boldsymbol{W}^{*} = (\\rho^{*}_{\\mathrm{prim}}, u^{*}_{\\mathrm{prim}}, p^{*}_{\\mathrm{prim}})$.\n$$\\boldsymbol{W}(\\theta) = \\bar{\\boldsymbol{W}} + \\theta(\\boldsymbol{W}^{*} - \\bar{\\boldsymbol{W}})$$\nThe components of the limited state are:\n$$\\rho(\\theta) = \\bar{\\rho} + \\theta(\\rho^{*}_{\\mathrm{prim}} - \\bar{\\rho})$$\n$$p(\\theta) = \\bar{p} + \\theta(p^{*}_{\\mathrm{prim}} - \\bar{p})$$\nThe positivity constraints $\\rho(\\theta) > 0$ and $p(\\theta) > 0$ are linear inequalities in $\\theta$.\n\nFor density positivity, $\\bar{\\rho} + \\theta(\\rho^{*}_{\\mathrm{prim}} - \\bar{\\rho}) > 0$. If $\\rho^{*}_{\\mathrm{prim}} \\ge \\bar{\\rho}$, this is always true for $\\theta \\ge 0$ since $\\bar{\\rho} > 0$. If $\\rho^{*}_{\\mathrm{prim}} < \\bar{\\rho}$, the condition becomes $\\theta < \\frac{\\bar{\\rho}}{\\bar{\\rho} - \\rho^{*}_{\\mathrm{prim}}}$.\n\nFor pressure positivity, $\\bar{p} + \\theta(p^{*}_{\\mathrm{prim}} - \\bar{p}) > 0$. If $p^{*}_{\\mathrm{prim}} \\ge \\bar{p}$, this is always true for $\\theta \\ge 0$ since $\\bar{p} > 0$. If $p^{*}_{\\mathrm{prim}} < \\bar{p}$, the condition is $\\theta < \\frac{\\bar{p}}{\\bar{p} - p^{*}_{\\mathrm{prim}}}$.\n\nSince $\\theta \\in [0, 1]$, the overall requirement is that $\\theta$ must be smaller than $1$ and any upper bounds derived from these linear inequalities. The key observation is that if both the cell-average state ($\\theta=0$) and the unlimited face state ($\\theta=1$) have positive density and pressure, then any linear combination with $\\theta \\in [0, 1]$ will also have positive density and pressure.\n\n### Positivity Conditions for Conservative Variable Limiting\n\nWhen limiting is performed on the conservative variables $\\boldsymbol{U} = (\\rho, m, \\tau)$, the limited state is:\n$$\\boldsymbol{U}(\\theta) = \\bar{\\boldsymbol{U}} + \\theta(\\boldsymbol{U}^{*} - \\bar{\\boldsymbol{U}})$$\nLetting $\\Delta\\boldsymbol{U} = \\boldsymbol{U}^{*} - \\bar{\\boldsymbol{U}}$, the components are:\n$$\\rho(\\theta) = \\bar{\\rho} + \\theta\\Delta\\rho$$\n$$m(\\theta) = \\bar{m} + \\theta\\Delta m$$\n$$\\tau(\\theta) = \\bar{\\tau} + \\theta\\Delta\\tau$$\n\nThe density positivity constraint, $\\rho(\\theta) > 0$, is identical in form to the primitive case:\n$$\\bar{\\rho} + \\theta\\Delta\\rho > 0$$\nThis is a linear inequality in $\\theta$. If $\\Delta\\rho < 0$, it imposes the constraint $\\theta < \\frac{\\bar{\\rho}}{-\\Delta\\rho} = \\frac{\\bar{\\rho}}{\\bar{\\rho} - \\rho^{*}}$.\n\nThe pressure positivity constraint, $p(\\theta) > 0$, is more complex. We use the equation of state with the limited conservative variables. As $\\gamma-1 > 0$, the condition $p(\\theta) > 0$ is equivalent to:\n$$\\tau(\\theta) - \\frac{1}{2}\\frac{m(\\theta)^2}{\\rho(\\theta)} > 0$$\nTo avoid division by a $\\theta$-dependent term, we multiply by $2\\rho(\\theta)$. Since we are enforcing $\\rho(\\theta) > 0$, this does not change the inequality direction:\n$$2\\rho(\\theta)\\tau(\\theta) - m(\\theta)^2 > 0$$\nSubstituting the linear expressions for the limited conservative variables:\n$$2(\\bar{\\rho} + \\theta\\Delta\\rho)(\\bar{\\tau} + \\theta\\Delta\\tau) - (\\bar{m} + \\theta\\Delta m)^2 > 0$$\nExpanding this expression gives a quadratic inequality in $\\theta$ of the form $A\\theta^2 + B\\theta + C > 0$:\n$$2(\\bar{\\rho}\\bar{\\tau} + \\theta(\\bar{\\rho}\\Delta\\tau+\\bar{\\tau}\\Delta\\rho) + \\theta^2\\Delta\\rho\\Delta\\tau) - (\\bar{m}^2 + 2\\theta\\bar{m}\\Delta m + \\theta^2(\\Delta m)^2) > 0$$\nOrganizing by powers of $\\theta$:\n$$(2\\Delta\\rho\\Delta\\tau - (\\Delta m)^2)\\theta^2 + 2(\\bar{\\rho}\\Delta\\tau+\\bar{\\tau}\\Delta\\rho - \\bar{m}\\Delta m)\\theta + (2\\bar{\\rho}\\bar{\\tau} - \\bar{m}^2) > 0$$\nThe coefficients are:\n$$A = 2\\Delta\\rho\\Delta\\tau - (\\Delta m)^2$$\n$$B = 2(\\bar{\\rho}\\Delta\\tau + \\bar{\\tau}\\Delta\\rho - \\bar{m}\\Delta m)$$\n$$C = 2\\bar{\\rho}\\bar{\\tau} - \\bar{m}^2$$\nThe constant term $C$ corresponds to the state at $\\theta=0$. We can verify that it is proportional to the cell-averaged pressure:\n$$C = 2\\bar{\\rho}(\\rho\\bar{E}) - (\\bar{\\rho}\\bar{u})^2 = 2\\bar{\\rho}^2(\\bar{E} - \\frac{1}{2}\\bar{u}^2) = 2\\bar{\\rho}^2\\left(\\frac{\\bar{p}}{(\\gamma - 1)\\bar{\\rho}}\\right) = \\frac{2\\bar{\\rho}\\bar{p}}{\\gamma - 1}$$\nSince $\\bar{\\rho} > 0$ and $\\bar{p} > 0$ for a valid cell-average, $C > 0$.\n\n### Comparison and Criterion for Robustness\n\nThe nonlinearity of $p(\\theta)$ under conservative limiting stems from the kinetic energy term $\\frac{1}{2}\\rho u^2 = \\frac{1}{2}m^2/\\rho$. When $m$ and $\\rho$ are linear functions of $\\theta$, their ratio is not. This results in the quadratic inequality for pressure positivity. A quadratic function $f(\\theta) = A\\theta^2 + B\\theta + C$ is a parabola. Even if $p(0) > 0$ (i.e., $C>0$) and $p(1) > 0$, the pressure $p(\\theta)$ can become negative for some $\\theta \\in (0,1)$ if the parabola has roots in this interval and opens downwards ($A<0$). This is a critical failure of robustness. In contrast, limiting in primitive variables leads to linear functions for both $\\rho(\\theta)$ and $p(\\theta)$. A linear function between two positive endpoints is guaranteed to be positive everywhere in the interval.\n\nTherefore, the stricter constraint arises from the possibility of non-monotonic behavior of pressure under conservative limiting. To maximize robustness while preserving positivity, the criterion is to **perform the limiting procedure in the space of primitive variables $(\\rho, u, p)$**. This ensures that positivity constraints are linear and easily satisfied. A common robust algorithm is: 1) reconstruct primitive variables to cell faces, 2) apply the limiter to the primitive variables to get limited face states, and 3) convert the limited primitive face states back to conservative variables for the flux calculation.\n\n### Numerical Evaluation for Conservative Limiting\n\nWe are given the following data:\n- $\\gamma = 1.4$\n- $\\bar{\\boldsymbol{W}} = (\\bar{\\rho}, \\bar{u}, \\bar{p}) = (0.1, 1000, 10000)$\n- $\\boldsymbol{U}^{*} = (\\rho^{*}, m^{*}, \\tau^{*}) = (0.05, 300, 10000)$\n\nFirst, we compute the cell-averaged conservative state $\\bar{\\boldsymbol{U}} = (\\bar{\\rho}, \\bar{m}, \\bar{\\tau})$.\n$\\bar{\\rho} = 0.1$\n$\\bar{m} = \\bar{\\rho}\\bar{u} = 0.1 \\times 1000 = 100$\nThe total energy per unit mass is $\\bar{E} = \\frac{\\bar{p}}{(\\gamma - 1)\\bar{\\rho}} + \\frac{1}{2}\\bar{u}^{2}$:\n$\\bar{E} = \\frac{10000}{(1.4 - 1) \\times 0.1} + \\frac{1}{2}(1000)^2 = \\frac{10000}{0.04} + 500000 = 250000 + 500000 = 750000$\nThe total energy density is $\\bar{\\tau} = \\bar{\\rho}\\bar{E} = 0.1 \\times 750000 = 75000$.\nSo, $\\bar{\\boldsymbol{U}} = (0.1, 100, 75000)$.\n\nNext, we compute the differences $\\Delta\\boldsymbol{U} = \\boldsymbol{U}^{*} - \\bar{\\boldsymbol{U}}$.\n$\\Delta\\rho = \\rho^{*} - \\bar{\\rho} = 0.05 - 0.1 = -0.05$\n$\\Delta m = m^{*} - \\bar{m} = 300 - 100 = 200$\n$\\Delta\\tau = \\tau^{*} - \\bar{\\tau} = 10000 - 75000 = -65000$\n\nNow, we compute the coefficients $A, B, C$ for the quadratic inequality $p(\\theta)>0$.\n$A = 2\\Delta\\rho\\Delta\\tau - (\\Delta m)^2 = 2(-0.05)(-65000) - (200)^2 = 6500 - 40000 = -33500$\n$B = 2(\\bar{\\rho}\\Delta\\tau + \\bar{\\tau}\\Delta\\rho - \\bar{m}\\Delta m) = 2(0.1(-65000) + 75000(-0.05) - 100(200))$\n$B = 2(-6500 - 3750 - 20000) = 2(-30250) = -60500$\n$C = 2\\bar{\\rho}\\bar{\\tau} - \\bar{m}^2 = 2(0.1)(75000) - (100)^2 = 15000 - 10000 = 5000$\n\nThe pressure positivity condition is the quadratic inequality:\n$$-33500\\theta^2 - 60500\\theta + 5000 > 0$$\nDividing by $-500$ reverses the inequality:\n$$67\\theta^2 + 121\\theta - 10 < 0$$\nThe roots of the quadratic equation $67\\theta^2 + 121\\theta - 10 = 0$ are given by the quadratic formula $\\theta = \\frac{-b \\pm \\sqrt{b^2-4ac}}{2a}$:\n$$\\theta = \\frac{-121 \\pm \\sqrt{121^2 - 4(67)(-10)}}{2(67)} = \\frac{-121 \\pm \\sqrt{14641 + 2680}}{134} = \\frac{-121 \\pm \\sqrt{17321}}{134}$$\nThe two roots are:\n$$\\theta_1 = \\frac{-121 - \\sqrt{17321}}{134} \\approx \\frac{-121 - 131.609}{134} \\approx -1.8851$$\n$$\\theta_2 = \\frac{-121 + \\sqrt{17321}}{134} \\approx \\frac{-121 + 131.609}{134} \\approx 0.079174$$\nSince the parabola $67\\theta^2 + 121\\theta - 10$ opens upwards, the inequality is satisfied between the roots, i.e., for $\\theta \\in (\\theta_1, \\theta_2) \\approx (-1.8851, 0.079174)$.\nThe parameter $\\theta$ must also be in the interval $[0, 1]$. The intersection of these ranges is $[0, \\theta_2)$. The upper limit on $\\theta$ is thus the smallest positive root of the quadratic, which we denote $\\theta_{+}^{\\mathrm{cons}}$.\n$$\\theta_{+}^{\\mathrm{cons}} = \\frac{-121 + \\sqrt{17321}}{134} \\approx 0.0791736...$$\nFor completeness, the density positivity condition is $\\rho(\\theta) = 0.1 - 0.05\\theta > 0$, which gives $\\theta < \\frac{0.1}{0.05}=2$. This is a much weaker constraint than the one for pressure.\nThe admissible value of $\\theta$ is limited by the pressure constraint. The smallest positive root that bounds the acceptable range is $\\theta_{+}^{\\mathrm{cons}}$. Rounding to four significant figures, we get $0.07917$.",
            "answer": "$$\\boxed{0.07917}$$"
        }
    ]
}