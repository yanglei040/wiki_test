{
    "hands_on_practices": [
        {
            "introduction": "To truly master a numerical method, we must look beyond the final formulas and understand their origins. This first practice invites you to derive the celebrated van Leer splitting functions for subsonic flow from first principles. By applying constraints of continuity, symmetry, and differentiability, you will construct the polynomial forms that ensure a smooth and physically consistent transition at the sonic points, revealing the elegant design behind the scheme. ",
            "id": "3387430",
            "problem": "Consider the one-dimensional compressible Euler equations and the Mach number definition $M = u/a$, where $u$ is the fluid velocity and $a$ is the speed of sound. In van Leer flux vector splitting for convective terms, the goal is to split the mass convective flux into positive- and negative-propagating contributions, written in terms of splitting functions $\\phi^{+}(M)$ and $\\phi^{-}(M)$ applied to the Mach number for subsonic states $|M|<1$. In supersonic states, the absolute upwind splitting is used: for $M \\geq 1$, the positive branch carries the full convective contribution and the negative branch carries none, and for $M \\leq -1$, the negative branch carries the full contribution and the positive branch carries none.\n\nStarting from first principles, require the following well-tested and physically grounded constraints on the subsonic splitting functions:\n- Continuity at the sonic points with the supersonic branches: $\\phi^{+}(1)=1$, $\\phi^{-}(1)=0$, $\\phi^{+}(-1)=0$, $\\phi^{-}(-1)=-1$.\n- Symmetry under velocity sign reversal: $\\phi^{-}(M) = -\\phi^{+}(-M)$ for all $M$ in $(-1,1)$.\n- Exact mass flux recovery in the subsonic range: $\\phi^{+}(M) + \\phi^{-}(M) = M$ for all $M$ in $(-1,1)$.\n\nAdditionally, to prevent non-physical artifacts at the sonic points, assume the subsonic splitting functions are polynomials of minimal degree that are differentiable at $M=\\pm 1$ and match the first derivatives of the supersonic branches there.\n\nConstruct the explicit polynomial forms of $\\phi^{+}(M)$ and $\\phi^{-}(M)$ for $|M|<1$ that satisfy all these conditions. Your final answer must be the pair $\\phi^{+}(M)$ and $\\phi^{-}(M)$ written as closed-form analytic expressions. No numerical rounding is required and no units should be included in the final expressions.",
            "solution": "The van Leer flux vector splitting for convective terms seeks functions $\\phi^{+}(M)$ and $\\phi^{-}(M)$ that correctly partition the mass convective flux according to propagation direction. We identify the requirements from the problem:\n\n1. Continuity at sonic points $M=\\pm 1$ with supersonic absolute upwinding:\n   - For $M=1$, the positive branch must carry the full contribution while the negative carries none, so $\\phi^{+}(1)=1$ and $\\phi^{-}(1)=0$.\n   - For $M=-1$, the negative branch must carry the full contribution while the positive carries none, so $\\phi^{+}(-1)=0$ and $\\phi^{-}(-1)=-1$.\n\n2. Symmetry:\n   - The splitting should respect reversal of sign, so $\\phi^{-}(M) = - \\phi^{+}(-M)$ for $M \\in (-1,1)$.\n\n3. Exact mass flux recovery:\n   - The split must recombine to the original convective content, so $\\phi^{+}(M) + \\phi^{-}(M) = M$ for $M \\in (-1,1)$.\n\n4. Smoothness and minimal-degree polynomial:\n   - To avoid spurious wave reflection or dissipation at sonic points, the subsonic polynomials should be differentiable at $M=\\pm 1$ and match the first derivatives of the supersonic branches. The supersonic behavior is: for the positive branch, $\\phi^{+}(M)=M$ for $M \\geq 1$ and $\\phi^{+}(M)=0$ for $M \\leq -1$, and for the negative branch, $\\phi^{-}(M)=0$ for $M \\geq 1$ and $\\phi^{-}(M)=M$ for $M \\leq -1$. Therefore,\n   - $\\frac{d}{dM}\\phi^{+}(1) = 1$ and $\\frac{d}{dM}\\phi^{+}(-1) = 0$,\n   - $\\frac{d}{dM}\\phi^{-}(1) = 0$ and $\\frac{d}{dM}\\phi^{-}(-1) = 1$.\n\nWe construct $\\phi^{+}(M)$ on $|M|<1$ as a minimal-degree polynomial consistent with the endpoint values and derivative matching. A natural choice that enforces the value and zero-derivative at $M=-1$ is to include a squared factor of $(M+1)$, i.e., let\n$$\n\\phi^{+}(M) = c\\,(M+1)^{2}\n$$\nfor some constant $c$. This form implies $\\phi^{+}(-1) = 0$ and $\\frac{d}{dM}\\phi^{+}(-1) = 0$, matching the supersonic left-side behavior of the positive branch, which is identically zero for $M \\leq -1$.\n\nWe now enforce $\\phi^{+}(1) = 1$:\n$$\n\\phi^{+}(1) = c\\,(1+1)^{2} = c\\,(2)^{2} = 4c = 1 \\quad \\Rightarrow \\quad c = \\frac{1}{4}.\n$$\nThus,\n$$\n\\phi^{+}(M) = \\frac{1}{4}(M+1)^{2}.\n$$\nWe verify the derivative at $M=1$:\n$$\n\\frac{d}{dM}\\phi^{+}(M) = \\frac{1}{2}(M+1), \\quad \\frac{d}{dM}\\phi^{+}(1) = \\frac{1}{2}(2) = 1,\n$$\nwhich matches the supersonic derivative of the positive branch at $M=1$.\n\nBy symmetry, we define\n$$\n\\phi^{-}(M) = -\\phi^{+}(-M) = -\\frac{1}{4}(-M+1)^{2} = -\\frac{1}{4}(1-M)^{2} = -\\frac{1}{4}(M-1)^{2}.\n$$\nWe check the endpoint values:\n- At $M=1$, $\\phi^{-}(1) = -\\frac{1}{4}(1-1)^{2} = 0$, consistent with the supersonic negative branch.\n- At $M=-1$, $\\phi^{-}(-1) = -\\frac{1}{4}((-1)-1)^{2} = -\\frac{1}{4}(-2)^{2} = -1$, consistent with the supersonic negative branch.\n\nWe verify derivative matching for the negative branch:\n$$\n\\frac{d}{dM}\\phi^{-}(M) = -\\frac{1}{2}(M-1),\n$$\nso\n$$\n\\frac{d}{dM}\\phi^{-}(1) = -\\frac{1}{2}(0) = 0, \\quad \\frac{d}{dM}\\phi^{-}(-1) = -\\frac{1}{2}(-2) = 1,\n$$\nmatching the supersonic derivatives for the negative branch at $M=1$ and $M=-1$, respectively.\n\nFinally, we verify exact mass flux recovery for all $M \\in (-1,1)$:\n$$\n\\phi^{+}(M) + \\phi^{-}(M) = \\frac{1}{4}(M+1)^{2} - \\frac{1}{4}(M-1)^{2} = \\frac{1}{4}\\left[(M^{2}+2M+1) - (M^{2}-2M+1)\\right] = \\frac{1}{4}(4M) = M.\n$$\n\nTherefore, the unique minimal-degree smooth polynomial splitting functions for convective terms on $|M|<1$ that satisfy continuity at $M=\\pm 1$, symmetry, exact mass flux recovery, and derivative matching at the sonic points are\n$$\n\\phi^{+}(M) = \\frac{1}{4}(M+1)^{2}, \\quad \\phi^{-}(M) = -\\frac{1}{4}(M-1)^{2}.\n$$\nThese are the desired subsonic splitting functions.",
            "answer": "$$\\boxed{\\begin{pmatrix}\\frac{1}{4}\\,(M+1)^{2} & -\\frac{1}{4}\\,(M-1)^{2}\\end{pmatrix}}$$"
        },
        {
            "introduction": "Practical fluid dynamics simulations are inherently multi-dimensional, and a robust numerical scheme must produce results that are independent of the chosen coordinate system. This practice guides you through the crucial extension of the van Leer splitting to multiple dimensions by leveraging the rotationally invariant normal Mach number, $M_n$. You will not only derive the multi-dimensional flux vectors but also programmatically verify their rotational invariance, a cornerstone property for any reliable CFD solver. ",
            "id": "3387357",
            "problem": "Consider the two-dimensional inviscid compressible Euler equations as a system of conservation laws for the state vector $U = [\\rho, \\rho u, \\rho v, \\rho E]^\\top$, where $\\rho$ is the density, $(u,v)$ are the Cartesian components of velocity, and $E$ is the specific total energy. Let the ratio of specific heats be denoted by $\\gamma$, the thermodynamic pressure be $p$, and the speed of sound be $a = \\sqrt{\\gamma p / \\rho}$. The specific total enthalpy is $H = E + p / \\rho$. The flux through a face with outward unit normal $\\mathbf{n} = (n_x, n_y)$ is the normal flux $F_n(U)$ obtained by projecting the physical flux onto the direction $\\mathbf{n}$.\n\nStarting from the Euler equations and the definitions of thermodynamic quantities, derive a multidimensional Flux Vector Splitting (FVS) in the sense of van Leer that depends only on the normal Mach number $M_n = (\\mathbf{u} \\cdot \\mathbf{n}) / a$ and thermodynamic scalars. Specifically, construct split fluxes $F_n^+(U)$ and $F_n^-(U)$ such that $F_n(U) = F_n^+(U) + F_n^-(U)$ and each split depends on the sign of wave propagation relative to the face normal direction, through $M_n$. Prove that when the split flux is written as $F_n^\\pm(U) = F^\\pm(U;\\,M_n)$, it is rotationally invariant in the sense that if the coordinate system is rotated by an orthogonal transformation and $\\mathbf{n}$ is rotated consistently, the split flux transforms as a proper vector in the momentum components, while mass and energy components remain invariant scalars.\n\nUse the following base:\n- Conservation form of the Euler equations and their rotational invariance.\n- Decomposition of the normal flux into convective and pressure work contributions, each expressible in terms of $\\rho$, $(u,v)$, $p$, $a$, $H$, and the face normal $\\mathbf{n}$.\n- Definition of the normal Mach number $M_n$ from the projection of velocity onto $\\mathbf{n}$.\n\nYou must not assume or state any pre-derived van Leer formulas in your derivation. You must develop them from first principles, ensuring consistency with the conservation form and characteristic speeds along the face normal.\n\nAfter deriving the multidimensional split flux and establishing its rotational invariance, implement a program that:\n- Constructs a uniform supersonic free stream of Mach $M_\\infty = 2$ with $\\gamma = 1.4$, density $\\rho_\\infty = 1.225$ kilograms per cubic meter, and pressure $p_\\infty = 101325$ pascals. Compute the corresponding speed of sound $a_\\infty$ and free-stream speed magnitude $U_\\infty = M_\\infty a_\\infty$.\n- Defines a Cartesian grid with outward face normals $\\mathbf{n}_x = (1,0)$ and $\\mathbf{n}_y = (0,1)$, and a free-stream velocity direction rotated by an angle $\\theta$ (in radians).\n- For each face normal and each test angle, computes the split fluxes $F_n^\\pm(U)$ using your multidimensional van Leer FVS, and independently computes them by rotating the state into the face-aligned frame, applying the one-dimensional split along the aligned normal, and rotating the momentum components of the split flux back to the original frame.\n- Reports, for each test angle, the maximum absolute difference (over both faces and both signs) between the directly computed split fluxes and the rotated-frame-computed split fluxes.\n\nAngle unit specification: use radians for all angles.\n\nYour program must implement the described method and produce the results for the following test suite of free-stream angles:\n- $\\theta_1 = 0$ (aligned with the $x$-axis),\n- $\\theta_2 = \\pi/3$ (normal Mach equal to $1$ for the $x$-face),\n- $\\theta_3 = \\pi/4$,\n- $\\theta_4 = -\\pi/6$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3,result4]\"). Each result must be a floating-point number equal to the maximum absolute difference described above. Since these differences are dimensionless, no physical units are required for the outputs. The program must be self-contained, must not read any input, and must use the specified runtime environment.",
            "solution": "The problem requires the derivation of a rotationally invariant multidimensional van Leer Flux Vector Splitting (FVS) for the two-dimensional Euler equations, a proof of its rotational invariance, and a numerical verification.\n\n### Part 1: Derivation of the Multidimensional van Leer Split Flux\n\nWe begin with the two-dimensional inviscid compressible Euler equations in conservation form:\n$$\n\\frac{\\partial U}{\\partial t} + \\frac{\\partial F_x(U)}{\\partial x} + \\frac{\\partial F_y(U)}{\\partial y} = 0\n$$\nwhere the state vector $U$ and the Cartesian flux vectors $F_x(U)$ and $F_y(U)$ are given by:\n$$\nU = \\begin{pmatrix} \\rho \\\\ \\rho u \\\\ \\rho v \\\\ \\rho E \\end{pmatrix}, \\quad\nF_x(U) = \\begin{pmatrix} \\rho u \\\\ \\rho u^2 + p \\\\ \\rho uv \\\\ \\rho u H \\end{pmatrix}, \\quad\nF_y(U) = \\begin{pmatrix} \\rho v \\\\ \\rho uv \\\\ \\rho v^2 + p \\\\ \\rho v H \\end{pmatrix}\n$$\nHere, $\\rho$ is the density, $\\mathbf{u} = (u,v)$ is the velocity vector, $p$ is the pressure, $E = \\frac{p}{(\\gamma-1)\\rho} + \\frac{1}{2}(u^2+v^2)$ is the specific total energy, $H = E + p/\\rho$ is the specific total enthalpy, and $\\gamma$ is the ratio of specific heats.\n\nThe flux through a surface with an outward unit normal vector $\\mathbf{n} = (n_x, n_y)$ is the normal flux $F_n(U)$, obtained by projecting the Cartesian fluxes onto $\\mathbf{n}$:\n$$\nF_n(U) = F_x(U) n_x + F_y(U) n_y = \\begin{pmatrix} \\rho(un_x + vn_y) \\\\ (\\rho u^2+p)n_x + (\\rho uv)n_y \\\\ (\\rho uv)n_x + (\\rho v^2+p)n_y \\\\ (\\rho u H)n_x + (\\rho v H)n_y \\end{pmatrix}\n$$\nLet $u_n = \\mathbf{u} \\cdot \\mathbf{n} = u n_x + v n_y$ be the normal component of the velocity. The normal flux can be written as:\n$$\nF_n(U) = \\begin{pmatrix} \\rho u_n \\\\ \\rho u u_n + p n_x \\\\ \\rho v u_n + p n_y \\\\ \\rho H u_n \\end{pmatrix}\n$$\nTo make the structure invariant under coordinate rotations, we express the momentum components using vector notation:\n$$\nF_n(U) = \\begin{pmatrix} \\rho u_n \\\\ \\rho \\mathbf{u} u_n + p \\mathbf{n} \\\\ \\rho H u_n \\end{pmatrix}\n$$\nThe goal of Flux Vector Splitting (FVS) is to decompose $F_n(U)$ into two parts, $F_n^+(U)$ and $F_n^-(U)$, such that $F_n(U) = F_n^+(U) + F_n^-(U)$. The splitting is based on the direction of information propagation normal to the face. The characteristic speeds of the Euler equations in the normal direction are the eigenvalues of the flux Jacobian $\\partial F_n / \\partial U$, which are $\\lambda_1 = u_n - a$, $\\lambda_{2,3} = u_n$, and $\\lambda_4 = u_n + a$, where $a = \\sqrt{\\gamma p / \\rho}$ is the speed of sound. The split fluxes $F_n^+$ and $F_n^-$ are constructed such that the Jacobian $\\partial F_n^+ / \\partial U$ has non-negative eigenvalues and $\\partial F_n^- / \\partial U$ has non-positive eigenvalues.\n\nThe van Leer splitting scheme accomplishes this by making the split dependent on the normal Mach number, $M_n = u_n / a$.\n\n**Supersonic Flow ($|M_n| \\ge 1$):**\nIn supersonic flow, all characteristic waves propagate in the same direction.\n- If $M_n \\ge 1$, the flow is downstream-running. All information moves with the flow, so the entire flux is associated with the positive direction.\n  $$ F_n^+(U) = F_n(U), \\quad F_n^-(U) = 0 $$\n- If $M_n \\le -1$, the flow is upstream-running. All information moves against the positive normal direction.\n  $$ F_n^+(U) = 0, \\quad F_n^-(U) = F_n(U) $$\n\n**Subsonic Flow ($|M_n| < 1$):**\nIn subsonic flow, the acoustic waves $(u_n \\pm a)$ travel in opposite directions. The flux must be split into components associated with these directions. We follow the principle of extending the one-dimensional van Leer splitting to a multidimensional, rotationally invariant form. The key is to construct the split flux vector from rotationally invariant scalars and properly transforming vectors.\n\nWe define a split mass flux, $f_m^\\pm$, and a split pressure, $p^\\pm$:\n1.  **Split Mass Flux:** The total mass flux is $f_m = \\rho u_n$. For $|M_n| < 1$, van Leer's polynomial split is:\n    $$ f_m^\\pm(M_n) = \\pm \\frac{1}{4} \\rho a (M_n \\pm 1)^2 $$\n    The sum correctly reconstructs the total mass flux: $f_m^+ + f_m^- = \\frac{1}{4}\\rho a[(M_n+1)^2 - (M_n-1)^2] = \\frac{1}{4}\\rho a[4M_n] = \\rho a M_n = \\rho u_n$.\n2.  **Split Pressure:** The total pressure contribution $p$ is split according to the propagation of acoustic waves. For $|M_n| < 1$, the polynomial split is:\n    $$ p^\\pm(M_n) = p \\cdot \\frac{1}{4} (M_n \\pm 1)^2 (2 \\mp M_n) $$\n    The sum correctly reconstructs the total pressure: $p^+ + p^- = \\frac{p}{4}[ (M_n^2+2M_n+1)(2-M_n) + (M_n^2-2M_n+1)(2+M_n) ] = \\frac{p}{4}[ (-M_n^3+3M_n+2) + (M_n^3-3M_n+2) ] = p$.\n\nUsing these split scalar quantities, we construct the multidimensional split flux vector $F_n^\\pm$ by generalizing the structure from the one-dimensional case. The total flux components can be interpreted as mass flux ($\\rho u_n$), momentum flux ($\\rho \\mathbf{u} u_n + p \\mathbf{n}$), and energy flux ($\\rho H u_n = (\\rho u_n) H$). We assemble the split fluxes analogously:\n$$\nF_n^\\pm(U) = \\begin{pmatrix} f_m^\\pm \\\\ f_m^\\pm \\mathbf{u} + p^\\pm \\mathbf{n} \\\\ f_m^\\pm H \\end{pmatrix}\n$$\nThis form combines the scalars $f_m^\\pm$ and $p^\\pm$ with the vectors $\\mathbf{u}$ and $\\mathbf{n}$. The terms are:\n- Mass component: $f_m^\\pm$\n- Momentum component: $f_m^\\pm \\mathbf{u} + p^\\pm \\mathbf{n}$\n- Energy component: $f_m^\\pm H$\n\nThe sum $F_n^+ + F_n^-$ correctly recovers the full flux $F_n(U)$ for $|M_n| < 1$. The splitting functions and the supersonic cutoff ensure continuity and differentiability of the split fluxes at $M_n = \\pm 1$.\n\n### Part 2: Proof of Rotational Invariance\n\nTo prove that the splitting is rotationally invariant, we must show that the form of the split flux remains consistent under an arbitrary orthogonal rotation of the coordinate system. Let $T$ be an orthogonal rotation matrix ($T^\\top T = I$). In the rotated frame, vectors transform as $\\mathbf{v}' = T\\mathbf{v}$, while scalars remain invariant.\n- Primed quantities denote the rotated frame.\n- Scalar thermodynamic properties are invariant: $\\rho' = \\rho$, $p' = p$, $a' = a$, $E' = E$, $H' = H$.\n- The velocity and normal vectors transform as: $\\mathbf{u}' = T\\mathbf{u}$ and $\\mathbf{n}' = T\\mathbf{n}$.\n\nThe crucial step is to check the transformation property of the normal Mach number, $M_n$. The normal velocity in the rotated frame is:\n$$\nu_n' = \\mathbf{u}' \\cdot \\mathbf{n}' = (T\\mathbf{u}) \\cdot (T\\mathbf{n}) = (T\\mathbf{u})^\\top (T\\mathbf{n}) = \\mathbf{u}^\\top T^\\top T \\mathbf{n} = \\mathbf{u}^\\top I \\mathbf{n} = \\mathbf{u} \\cdot \\mathbf{n} = u_n\n$$\nSince $u_n$ is a rotational invariant (a true scalar) and $a$ is also a scalar, the normal Mach number is invariant:\n$$\nM_n' = u_n' / a' = u_n / a = M_n\n$$\nBecause the split mass flux $f_m^\\pm$ and split pressure $p^\\pm$ depend only on $\\rho, p, a$, and $M_n$, which are all rotational invariants, these quantities are also invariant:\n$$\nf_m'^\\pm = f_m^\\pm, \\quad p'^\\pm = p^\\pm\n$$\nNow, we examine the transformation of the split flux vector $F_n^\\pm(U)$. Its components in the rotated frame, $F_{n'}^\\pm(U')$, are:\n$$\nF_{n'}^\\pm(U') = \\begin{pmatrix} f_m'^\\pm \\\\ f_m'^\\pm \\mathbf{u}' + p'^\\pm \\mathbf{n}' \\\\ f_m'^\\pm H' \\end{pmatrix}\n= \\begin{pmatrix} f_m^\\pm \\\\ f_m^\\pm (T\\mathbf{u}) + p^\\pm (T\\mathbf{n}) \\\\ f_m^\\pm H \\end{pmatrix}\n= \\begin{pmatrix} f_m^\\pm \\\\ T(f_m^\\pm \\mathbf{u} + p^\\pm \\mathbf{n}) \\\\ f_m^\\pm H \\end{pmatrix}\n$$\nThis result shows that:\n1.  The mass component, $f_m^\\pm$, is a scalar and correctly remains invariant.\n2.  The energy component, $f_m^\\pm H$, is a scalar and correctly remains invariant.\n3.  The momentum component, $f_m^\\pm \\mathbf{u} + p^\\pm \\mathbf{n}$, transforms as $T(f_m^\\pm \\mathbf{u} + p^\\pm \\mathbf{n})$, which is the proper transformation rule for a vector.\n\nThe structure of the splitting formulae is independent of the choice of coordinate system. It depends only on intrinsic, coordinate-free quantities (scalars and vectors). This completes the proof of rotational invariance. The numerical part of the problem will verify this property by comparing a direct computation with a computation involving explicit rotation.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and verifies the rotational invariance of a multidimensional\n    van Leer Flux Vector Splitting scheme for the 2D Euler equations.\n    \"\"\"\n\n    # 1. Define problem constants and free-stream conditions\n    gamma = 1.4\n    rho_inf = 1.225  # kg/m^3\n    p_inf = 101325.0  # Pa\n    M_inf = 2.0\n\n    a_inf = np.sqrt(gamma * p_inf / rho_inf)\n    U_inf_mag = M_inf * a_inf\n    E_inf = p_inf / ((gamma - 1) * rho_inf) + 0.5 * U_inf_mag**2\n    H_inf = E_inf + p_inf / rho_inf\n\n    # State primitives (constant for the free stream)\n    rho, p, a, E, H = rho_inf, p_inf, a_inf, E_inf, H_inf\n\n    test_cases = [\n        0.0,          # Aligned with x-axis\n        np.pi / 3,    # Mn = 1 for x-face\n        np.pi / 4,    # General supersonic case\n        -np.pi / 6,   # Mn = -1 for y-face\n    ]\n\n    normals = [\n        np.array([1.0, 0.0]),  # x-face\n        np.array([0.0, 1.0]),  # y-face\n    ]\n\n    results = []\n\n    def get_split_flux_direct(u_vec, n_vec):\n        \"\"\"Computes split fluxes F+ and F- directly using the multidimensional formula.\"\"\"\n        u, v = u_vec\n        nx, ny = n_vec\n\n        un = u * nx + v * ny\n        Mn = un / a\n\n        F_plus = np.zeros(4)\n        F_minus = np.zeros(4)\n\n        if Mn >= 1.0:\n            F_plus[0] = rho * un\n            F_plus[1] = rho * u * un + p * nx\n            F_plus[2] = rho * v * un + p * ny\n            F_plus[3] = rho * H * un\n        elif Mn <= -1.0:\n            F_minus[0] = rho * un\n            F_minus[1] = rho * u * un + p * nx\n            F_minus[2] = rho * v * un + p * ny\n            F_minus[3] = rho * H * un\n        else: # |Mn| < 1.0\n            # Split mass flux\n            fm_plus = rho * a * 0.25 * (Mn + 1.0)**2\n            fm_minus = -rho * a * 0.25 * (Mn - 1.0)**2\n            # Split pressure\n            p_plus = p * 0.25 * (Mn + 1.0)**2 * (2.0 - Mn)\n            p_minus = p * 0.25 * (Mn - 1.0)**2 * (2.0 + Mn)\n\n            # Assemble F+\n            F_plus[0] = fm_plus\n            F_plus[1] = fm_plus * u + p_plus * nx\n            F_plus[2] = fm_plus * v + p_plus * ny\n            F_plus[3] = fm_plus * H\n\n            # Assemble F-\n            F_minus[0] = fm_minus\n            F_minus[1] = fm_minus * u + p_minus * nx\n            F_minus[2] = fm_minus * v + p_minus * ny\n            F_minus[3] = fm_minus * H\n            \n        return F_plus, F_minus\n\n    def get_split_flux_rotated(u_vec, n_vec):\n        \"\"\"Computes split fluxes by rotating, applying 1D split, and rotating back.\"\"\"\n        u, v = u_vec\n        nx, ny = n_vec\n\n        # Rotated velocity components\n        un = u * nx + v * ny  # Normal velocity\n        ut = -u * ny + v * nx # Tangential velocity\n        Mn = un / a\n\n        F_plus_rot = np.zeros(4)\n        F_minus_rot = np.zeros(4)\n\n        if Mn >= 1.0:\n            F_plus_rot[0] = rho * un\n            F_plus_rot[1] = rho * un * un + p\n            F_plus_rot[2] = rho * un * ut\n            F_plus_rot[3] = rho * H * un\n        elif Mn <= -1.0:\n            F_minus_rot[0] = rho * un\n            F_minus_rot[1] = rho * un * un + p\n            F_minus_rot[2] = rho * un * ut\n            F_minus_rot[3] = rho * H * un\n        else: # |Mn| < 1.0\n            fm_plus = rho * a * 0.25 * (Mn + 1.0)**2\n            fm_minus = -rho * a * 0.25 * (Mn - 1.0)**2\n            p_plus = p * 0.25 * (Mn + 1.0)**2 * (2.0 - Mn)\n            p_minus = p * 0.25 * (Mn - 1.0)**2 * (2.0 + Mn)\n\n            # Assemble F+ in rotated frame\n            F_plus_rot[0] = fm_plus\n            F_plus_rot[1] = fm_plus * un + p_plus\n            F_plus_rot[2] = fm_plus * ut\n            F_plus_rot[3] = fm_plus * H\n\n            # Assemble F- in rotated frame\n            F_minus_rot[0] = fm_minus\n            F_minus_rot[1] = fm_minus * un + p_minus\n            F_minus_rot[2] = fm_minus * ut\n            F_minus_rot[3] = fm_minus * H\n\n        # Rotate momentum components back to original frame\n        F_plus_final = np.copy(F_plus_rot)\n        F_plus_final[1] = F_plus_rot[1] * nx - F_plus_rot[2] * ny\n        F_plus_final[2] = F_plus_rot[1] * ny + F_plus_rot[2] * nx\n\n        F_minus_final = np.copy(F_minus_rot)\n        F_minus_final[1] = F_minus_rot[1] * nx - F_minus_rot[2] * ny\n        F_minus_final[2] = F_minus_rot[1] * ny + F_minus_rot[2] * nx\n\n        return F_plus_final, F_minus_final\n\n    for theta in test_cases:\n        max_abs_diff_for_angle = 0.0\n        \n        # 2. Get free-stream velocity vector for the current angle\n        u = U_inf_mag * np.cos(theta)\n        v = U_inf_mag * np.sin(theta)\n        u_vec = np.array([u, v])\n\n        for n_vec in normals:\n            # 3. Method 1: Direct multidimensional calculation\n            F_plus_direct, F_minus_direct = get_split_flux_direct(u_vec, n_vec)\n\n            # 4. Method 2: Rotated frame calculation\n            F_plus_rotated, F_minus_rotated = get_split_flux_rotated(u_vec, n_vec)\n\n            # 5. Compare results and update max difference\n            diff_plus = np.max(np.abs(F_plus_direct - F_plus_rotated))\n            diff_minus = np.max(np.abs(F_minus_direct - F_minus_rotated))\n            \n            max_abs_diff_for_angle = max(max_abs_diff_for_angle, diff_plus, diff_minus)\n\n        results.append(max_abs_diff_for_angle)\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "A numerical scheme that appears correct on the surface can fail spectacularly if it violates fundamental mathematical properties. This exercise delves into the critical concept of monotonicity, which ensures that the scheme does not generate unphysical oscillations or permit phenomena like expansion shocks. By comparing the standard van Leer flux with a seemingly plausible but flawed alternative, you will develop a sharp intuition for why precise upwind-biasing at cell interfaces is essential for the scheme's stability and physical fidelity. ",
            "id": "3387415",
            "problem": "Consider the compressible Euler equations in conservation form in $d$ spatial dimensions, written as $\\partial_t \\boldsymbol{U} + \\nabla \\cdot \\boldsymbol{F}(\\boldsymbol{U}) = \\boldsymbol{0}$, with conservative state $\\boldsymbol{U}$, physical flux $\\boldsymbol{F}(\\boldsymbol{U})$, velocity $\\boldsymbol{u}$, and sound speed $a$. Let $\\boldsymbol{n}$ be the unit normal of a mesh face, $u_n = \\boldsymbol{u} \\cdot \\boldsymbol{n}$ the face-normal velocity, and $M = u_n / a$ the face-normal Mach number. At a face, denote the left and right states by $\\boldsymbol{U}_L$ and $\\boldsymbol{U}_R$, with corresponding $u_{n,L}$, $u_{n,R}$, $a_L$, $a_R$, and $M_L = u_{n,L}/a_L$, $M_R = u_{n,R}/a_R$.\n\nVan Leer flux vector splitting constructs a numerical flux of the form $\\widehat{\\boldsymbol{F}}(\\boldsymbol{U}_L, \\boldsymbol{U}_R; \\boldsymbol{n}) = \\boldsymbol{F}^+(\\boldsymbol{U}_L; M_L) + \\boldsymbol{F}^-(\\boldsymbol{U}_R; M_R)$, where the $+$ and $-$ contributions are associated with right- and left-moving characteristic fields relative to the face normal, respectively, and where the dependence on $M$ enforces a smooth transonic upwind bias. In particular, for each characteristic field with speed $\\lambda$ (eigenvalue of the normal flux Jacobian), the splitting weights satisfy the following qualitative properties as functions of the Mach number $M$: (i) for strongly right-going flow, the negative contribution vanishes, (ii) for strongly left-going flow, the positive contribution vanishes, and (iii) in subsonic regimes, both contributions are nonzero but biased consistently with the signs of the characteristic speeds. You may assume the Euler flux Jacobian in the face-normal direction has real eigenvalues $\\lambda_k \\in \\{u_n - a, u_n, u_n + a\\}$ and a complete set of right and left eigenvectors, so that along each characteristic the update behaves like a scalar conservation law advected with speed $\\lambda_k$.\n\nA commonly proposed variant computes an averaged face Mach number $M_{\\mathrm{avg}} = \\tfrac{M_L + M_R}{2}$ and uses it in both $\\boldsymbol{F}^+(\\boldsymbol{U}_L; M_{\\mathrm{avg}})$ and $\\boldsymbol{F}^-(\\boldsymbol{U}_R; M_{\\mathrm{avg}})$.\n\nUsing only the above fundamentals, reason from the characteristic structure and the monotonicity criterion for scalar numerical fluxes to address upwinding and monotonicity of the van Leer flux vector splitting. In particular:\n\n- Explain why using $M_L$ exclusively in $\\boldsymbol{F}^+(\\boldsymbol{U}_L; M_L)$ and $M_R$ exclusively in $\\boldsymbol{F}^-(\\boldsymbol{U}_R; M_R)$ preserves upwind directionality and yields, along each characteristic, a two-point flux that is nondecreasing in its left argument and nonincreasing in its right argument.\n\n- Explain why replacing $M_L$ and $M_R$ by the averaged $M_{\\mathrm{avg}}$ in both $\\boldsymbol{F}^+$ and $\\boldsymbol{F}^-$ can break these properties near transonic states (for example, $M_L > 0$ and $M_R  0$), and give a concrete scenario that illustrates the failure.\n\nSelect all statements that are necessarily true given your analysis:\n\nA. Using separate face-normal Mach numbers $M_L$ and $M_R$ in van Leer flux vector splitting yields a numerical flux whose Jacobian with respect to $\\boldsymbol{U}_L$ is positive semidefinite along right-going characteristic fields and whose Jacobian with respect to $\\boldsymbol{U}_R$ is negative semidefinite along left-going characteristic fields, thereby preserving upwind directionality and satisfying a discrete monotonicity condition when projected onto characteristic variables.\n\nB. Averaging the Mach number at the face, $M_{\\mathrm{avg}} = \\tfrac{M_L + M_R}{2}$, can violate the scalar monotonicity condition because the dependence of both $\\boldsymbol{F}^+$ and $\\boldsymbol{F}^-$ on $M_{\\mathrm{avg}}$ introduces cross-dependence on both $\\boldsymbol{U}_L$ and $\\boldsymbol{U}_R$; near transonic states this can flip the sign of a flux partial derivative with respect to $\\boldsymbol{U}_R$ or $\\boldsymbol{U}_L$.\n\nC. Using the averaged $M_{\\mathrm{avg}}$ can at most change the magnitude of numerical dissipation but cannot alter the upwind bias, because the sign of characteristic speeds is set by the sign of $u_n$ evaluated at the face regardless of how $M$ is computed.\n\nD. In a transonic rarefaction with $M_L > 0$ and $M_R  0$, the averaged $M_{\\mathrm{avg}}$ can be close to $0$, reducing the intended upwind diffusion and coupling both flux contributions to both states; this can produce a non-monotone flux that admits spurious expansion shocks.\n\nE. Using separate $M_L$ and $M_R$ violates conservation across faces in the Euler equations, whereas using $M_{\\mathrm{avg}}$ restores conservation.\n\nChoose the correct option or options.",
            "solution": "The problem statement poses a conceptual question regarding the properties of the van Leer flux vector splitting scheme for the compressible Euler equations, specifically focusing on upwinding and monotonicity for the standard formulation versus a variant that uses an averaged Mach number.\n\n### Problem Validation\n\nFirst, the problem statement must be validated for scientific soundness, self-consistency, and well-posedness.\n\n**Step 1: Extract Givens**\n\n-   **Governing Equations**: Compressible Euler equations in $d$ spatial dimensions, $\\partial_t \\boldsymbol{U} + \\nabla \\cdot \\boldsymbol{F}(\\boldsymbol{U}) = \\boldsymbol{0}$. $\\boldsymbol{U}$ is the conservative state, $\\boldsymbol{F}(\\boldsymbol{U})$ is the physical flux.\n-   **State Variables**: Velocity $\\boldsymbol{u}$, sound speed $a$.\n-   **Face Geometry and Flow**: $\\boldsymbol{n}$ is the face unit normal, $u_n = \\boldsymbol{u} \\cdot \\boldsymbol{n}$ is the face-normal velocity, $M = u_n / a$ is the face-normal Mach number.\n-   **Discrete States**: At a face, left state is $\\boldsymbol{U}_L$ and right state is $\\boldsymbol{U}_R$. This gives rise to $u_{n,L}$, $u_{n,R}$, $a_L$, $a_R$, $M_L = u_{n,L}/a_L$, and $M_R = u_{n,R}/a_R$.\n-   **Standard van Leer Flux**: $\\widehat{\\boldsymbol{F}}(\\boldsymbol{U}_L, \\boldsymbol{U}_R; \\boldsymbol{n}) = \\boldsymbol{F}^+(\\boldsymbol{U}_L; M_L) + \\boldsymbol{F}^-(\\boldsymbol{U}_R; M_R)$.\n-   **Properties of Split Fluxes**: $\\boldsymbol{F}^+$ is for right-moving fields, $\\boldsymbol{F}^-$ is for left-moving fields. For strongly right-going flow ($M \\gg 0$), $\\boldsymbol{F}^- \\to \\boldsymbol{0}$. For strongly left-going flow ($M \\ll 0$), $\\boldsymbol{F}^+ \\to \\boldsymbol{0}$. In subsonic flow, both are generally non-zero.\n-   **Eigenstructure**: The face-normal flux Jacobian has real eigenvalues $\\lambda_k \\in \\{u_n - a, u_n, u_n + a\\}$.\n-   **Variant Scheme**: A proposed modification uses an averaged Mach number, $M_{\\mathrm{avg}} = \\frac{M_L + M_R}{2}$, to define the flux: $\\widehat{\\boldsymbol{F}}_{\\mathrm{avg}} = \\boldsymbol{F}^+(\\boldsymbol{U}_L; M_{\\mathrm{avg}}) + \\boldsymbol{F}^-(\\boldsymbol{U}_R; M_{\\mathrm{avg}})$.\n-   **Monotonicity Criterion**: A scalar numerical flux $\\hat{f}(u_L, u_R)$ is monotone if it is nondecreasing in its left argument ($u_L$) and nonincreasing in its right argument ($u_R$).\n\n**Step 2: Validate Using Extracted Givens**\n\n-   **Scientifically Grounded**: The problem is firmly based on the standard theory of computational fluid dynamics (CFD), specifically the finite volume method and the well-known van Leer flux vector splitting scheme for the Euler equations. All concepts (Euler equations, flux splitting, eigenvalues, Mach number, monotonicity) are standard and correctly described.\n-   **Well-Posed**: The problem asks for a qualitative analysis and reasoning based on fundamental principles of numerical schemes. The questions are specific and can be answered by applying the theory of hyperbolic conservation laws.\n-   **Objective**: The phrasing is technical and precise. There are no subjective or ambiguous statements.\n-   **Checklist Review**: The problem statement is complete, consistent, scientifically sound, and well-posed. It does not violate any of the invalidity criteria.\n\n**Step 3: Verdict and Action**\n\nThe problem statement is **valid**. The solution process will proceed.\n\n### Derivation and Analysis\n\nThe problem asks for an analysis of two versions of the van Leer flux vector splitting, focusing on upwinding and monotonicity. Monotonicity for a scalar two-point flux $\\hat{f}(u_L, u_R)$ requires $\\frac{\\partial \\hat{f}}{\\partial u_L} \\ge 0$ and $\\frac{\\partial \\hat{f}}{\\partial u_R} \\le 0$. For a system of equations, this condition is typically interpreted in a characteristic-wise sense or through the eigenvalues of the flux Jacobians with respect to the left and right states.\n\n**Analysis of the Standard Scheme: $\\widehat{\\boldsymbol{F}} = \\boldsymbol{F}^+(\\boldsymbol{U}_L; M_L) + \\boldsymbol{F}^-(\\boldsymbol{U}_R; M_R)$**\n\n1.  **Upwinding**: The core idea of upwinding is that information propagates along characteristics. For a right-going wave (positive eigenvalue $\\lambda_k  0$), the numerical scheme should draw information from the \"upwind\" direction, which is the left state $\\boldsymbol{U}_L$. For a left-going wave (negative eigenvalue $\\lambda_k  0$), it should draw from the right state $\\boldsymbol{U}_R$. The van Leer splitting is constructed to embody this principle. The flux is split into $\\boldsymbol{F} = \\boldsymbol{F}^+ + \\boldsymbol{F}^-$, where the flux Jacobian of $\\boldsymbol{F}^+$ ($A^+ = d\\boldsymbol{F}^+/d\\boldsymbol{U}$) has non-negative eigenvalues, and the flux Jacobian of $\\boldsymbol{F}^-$ ($A^- = d\\boldsymbol{F}^-/d\\boldsymbol{U}$) has non-positive eigenvalues.\n    In the standard numerical flux $\\widehat{\\boldsymbol{F}} = \\boldsymbol{F}^+(\\boldsymbol{U}_L; M_L) + \\boldsymbol{F}^-(\\boldsymbol{U}_R; M_R)$, the right-going flux contribution $\\boldsymbol{F}^+$ depends *only* on the left state $\\boldsymbol{U}_L$ (and its derived quantity $M_L$). The left-going flux contribution $\\boldsymbol{F}^-$ depends *only* on the right state $\\boldsymbol{U}_R$ (and its derived quantity $M_R$). This strict separation ensures proper upwind directionality. Information for right-going waves comes only from the left, and for left-going waves only from the right.\n\n2.  **Monotonicity**: To check the monotonicity condition, we compute the Jacobians of the numerical flux with respect to $\\boldsymbol{U}_L$ and $\\boldsymbol{U}_R$:\n    $$ \\frac{\\partial \\widehat{\\boldsymbol{F}}}{\\partial \\boldsymbol{U}_L} = \\frac{\\partial}{\\partial \\boldsymbol{U}_L} \\left( \\boldsymbol{F}^+(\\boldsymbol{U}_L; M_L) \\right) = \\boldsymbol{A}^+(\\boldsymbol{U}_L; M_L) $$\n    $$ \\frac{\\partial \\widehat{\\boldsymbol{F}}}{\\partial \\boldsymbol{U}_R} = \\frac{\\partial}{\\partial \\boldsymbol{U}_R} \\left( \\boldsymbol{F}^-(\\boldsymbol{U}_R; M_R) \\right) = \\boldsymbol{A}^-(\\boldsymbol{U}_R; M_R) $$\n    By construction of flux vector splitting, the matrix $\\boldsymbol{A}^+(\\boldsymbol{U})$ has non-negative eigenvalues, and the matrix $\\boldsymbol{A}^-(\\boldsymbol{U})$ has non-positive eigenvalues. This is the system-level equivalent of the scalar monotonicity conditions. Thus, the standard van Leer scheme is monotone in this sense.\n\n**Analysis of the Variant Scheme: $\\widehat{\\boldsymbol{F}}_{\\mathrm{avg}} = \\boldsymbol{F}^+(\\boldsymbol{U}_L; M_{\\mathrm{avg}}) + \\boldsymbol{F}^-(\\boldsymbol{U}_R; M_{\\mathrm{avg}})$**\n\n1.  **Upwinding and Monotonicity Failure**: In this variant, both split fluxes $\\boldsymbol{F}^+$ and $\\boldsymbol{F}^-$ depend on both states $\\boldsymbol{U}_L$ and $\\boldsymbol{U}_R$ through the averaged Mach number $M_{\\mathrm{avg}} = \\frac{1}{2}(M_L + M_R)$. This introduces cross-dependencies that corrupt the upwind structure.\n    Let's examine the Jacobian with respect to $\\boldsymbol{U}_R$:\n    $$ \\frac{\\partial \\widehat{\\boldsymbol{F}}_{\\mathrm{avg}}}{\\partial \\boldsymbol{U}_R} = \\frac{\\partial}{\\partial \\boldsymbol{U}_R} \\left( \\boldsymbol{F}^+(\\boldsymbol{U}_L; M_{\\mathrm{avg}}) + \\boldsymbol{F}^-(\\boldsymbol{U}_R; M_{\\mathrm{avg}}) \\right) $$\n    Using the chain rule:\n    $$ \\frac{\\partial \\widehat{\\boldsymbol{F}}_{\\mathrm{avg}}}{\\partial \\boldsymbol{U}_R} = \\underbrace{\\frac{\\partial \\boldsymbol{F}^+}{\\partial M_{\\mathrm{avg}}} \\frac{\\partial M_{\\mathrm{avg}}}{\\partial \\boldsymbol{U}_R}}_{\\text{Incorrect coupling}} + \\underbrace{\\frac{\\partial \\boldsymbol{F}^-}{\\partial \\boldsymbol{U}_R}}_{\\text{Correct part}} + \\underbrace{\\frac{\\partial \\boldsymbol{F}^-}{\\partial M_{\\mathrm{avg}}} \\frac{\\partial M_{\\mathrm{avg}}}{\\partial \\boldsymbol{U}_R}}_{\\text{Modification}} $$\n    The term $\\frac{\\partial \\boldsymbol{F}^-}{\\partial \\boldsymbol{U}_R}$ has non-positive eigenvalues, as desired. However, the new term $\\frac{\\partial \\boldsymbol{F}^+}{\\partial M_{\\mathrm{avg}}} \\frac{\\partial M_{\\mathrm{avg}}}{\\partial \\boldsymbol{U}_R}$ is problematic. The flux $\\boldsymbol{F}^+$ increases with $M$, so the matrix $\\frac{\\partial \\boldsymbol{F}^+}{\\partial M_{\\mathrm{avg}}}$ generally has positive eigenvalues. In certain flow conditions, the product can have positive eigenvalues that dominate the negative eigenvalues from the correct term, causing the full Jacobian $\\frac{\\partial \\widehat{\\boldsymbol{F}}_{\\mathrm{avg}}}{\\partial \\boldsymbol{U}_R}$ to have a positive eigenvalue. This violates the monotonicity condition $\\frac{\\partial \\hat{f}}{\\partial u_R} \\le 0$.\n\n2.  **Concrete Failure Scenario**: Consider a transonic rarefaction, where the flow expands through the sound speed. For instance, $M_L = 0.2$ and $M_R = -0.2$.\n    -   In this case, $M_{\\mathrm{avg}} = \\frac{0.2 + (-0.2)}{2} = 0$.\n    -   The variant flux is $\\widehat{\\boldsymbol{F}}_{\\mathrm{avg}} = \\boldsymbol{F}^+(\\boldsymbol{U}_L; M=0) + \\boldsymbol{F}^-(\\boldsymbol{U}_R; M=0)$.\n    -   The van Leer splitting is constructed to transition smoothly from full upwinding for supersonic flow to a mixed-contribution flux for subsonic flow. The splitting functions are polynomials in $M$. For example, the contributions to the acoustic waves ($u_n \\pm a$) are weighted by factors like $\\frac{a}{4}(M \\pm 1)^2$. At $M=0$, these weights are equal, indicating an equal blending of upwind and downwind information. This behavior is characteristic of a central difference scheme, which lacks the numerical dissipation necessary to handle shocks and contact discontinuities properly.\n    -   The standard scheme would use $M_L=0.2$ and $M_R=-0.2$, providing a correct upwind bias based on the local flow on each side, thus introducing the necessary numerical dissipation. The variant scheme with $M_{\\mathrm{avg}}=0$ loses this crucial upwind bias. A scheme lacking sufficient numerical dissipation is not monotone and can permit unphysical solutions, such as expansion shocks, where a rarefaction wave incorrectly sharpens into a discontinuity.\n\n### Option-by-Option Evaluation\n\n**A. Using separate face-normal Mach numbers $M_L$ and $M_R$ in van Leer flux vector splitting yields a numerical flux whose Jacobian with respect to $\\boldsymbol{U}_L$ is positive semidefinite along right-going characteristic fields and whose Jacobian with respect to $\\boldsymbol{U}_R$ is negative semidefinite along left-going characteristic fields, thereby preserving upwind directionality and satisfying a discrete monotonicity condition when projected onto characteristic variables.**\nThis statement is a correct description of the properties of the standard van Leer splitting. As derived above, $\\partial \\widehat{\\boldsymbol{F}} / \\partial \\boldsymbol{U}_L = \\boldsymbol{A}^+(\\boldsymbol{U}_L)$ has non-negative eigenvalues, and $\\partial \\widehat{\\boldsymbol{F}} / \\partial \\boldsymbol{U}_R = \\boldsymbol{A}^-(\\boldsymbol{U}_R)$ has non-positive eigenvalues. \"Positive/negative semidefinite\" is the appropriate matrix terminology for this property, which ensures monotonicity.\n**Verdict: Correct.**\n\n**B. Averaging the Mach number at the face, $M_{\\mathrm{avg}} = \\tfrac{M_L + M_R}{2}$, can violate the scalar monotonicity condition because the dependence of both $\\boldsymbol{F}^+$ and $\\boldsymbol{F}^-$ on $M_{\\mathrm{avg}}$ introduces cross-dependence on both $\\boldsymbol{U}_L$ and $\\boldsymbol{U}_R$; near transonic states this can flip the sign of a flux partial derivative with respect to $\\boldsymbol{U}_R$ or $\\boldsymbol{U}_L$.**\nThis statement correctly identifies the failure mechanism. The cross-dependence introduced by $M_{\\mathrm{avg}}$ means $\\boldsymbol{F}^+$ depends on $\\boldsymbol{U}_R$ and $\\boldsymbol{F}^-$ depends on $\\boldsymbol{U}_L$. As shown in the analysis, this can lead to Jacobian matrices that violate the sign conditions required for monotonicity.\n**Verdict: Correct.**\n\n**C. Using the averaged $M_{\\mathrm{avg}}$ can at most change the magnitude of numerical dissipation but cannot alter the upwind bias, because the sign of characteristic speeds is set by the sign of $u_n$ evaluated at the face regardless of how $M$ is computed.**\nThis statement is incorrect. The upwind bias in van Leer's scheme is not simply binary; it is determined by weighting functions that depend on the Mach number $M$. In the transonic rarefaction case ($M_{avg} \\approx 0$), the upwind bias is effectively eliminated, and the scheme degenerates towards a central-type differencing for acoustic waves, which fundamentally alters its character, not just the magnitude of dissipation.\n**Verdict: Incorrect.**\n\n**D. In a transonic rarefaction with $M_L > 0$ and $M_R  0$, the averaged $M_{\\mathrm{avg}}$ can be close to $0$, reducing the intended upwind diffusion and coupling both flux contributions to both states; this can produce a non-monotone flux that admits spurious expansion shocks.**\nThis statement provides an accurate and specific example of the failure of the variant scheme. The analysis of the transonic rarefaction scenario confirms every part of this statement: $M_{\\mathrm{avg}} \\approx 0$ does reduce upwind diffusion (numerical dissipation), it does couple the fluxes incorrectly, and the resulting non-monotone behavior is known to permit expansion shocks.\n**Verdict: Correct.**\n\n**E. Using separate $M_L$ and $M_R$ violates conservation across faces in the Euler equations, whereas using $M_{\\mathrm{avg}}$ restores conservation.**\nThis statement is incorrect. Conservation in a finite volume method is guaranteed as long as the numerical flux at an interface, $\\widehat{\\boldsymbol{F}}_{i+1/2}$, is a unique function of the states on its left ($\\boldsymbol{U}_i$) and right ($\\boldsymbol{U}_{i+1}$), and the flux leaving cell $i$ is identical to the flux entering cell $i+1$. Both the standard scheme ($\\widehat{\\boldsymbol{F}}(\\boldsymbol{U}_L, \\boldsymbol{U}_R)$) and the variant ($\\widehat{\\boldsymbol{F}}_{\\mathrm{avg}}(\\boldsymbol{U}_L, \\boldsymbol{U}_R)$) define such a unique two-point flux function. Therefore, both schemes are fully conservative. The method of computing the Mach number does not affect the conservative property of the scheme.\n**Verdict: Incorrect.**",
            "answer": "$$\\boxed{ABD}$$"
        }
    ]
}