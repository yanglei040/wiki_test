{
    "hands_on_practices": [
        {
            "introduction": "The local Lax–Friedrichs scheme, also known as the Rusanov flux, is a cornerstone of finite volume methods for hyperbolic conservation laws. Its strength lies in its simplicity and robustness, providing stability by adding a carefully measured amount of numerical dissipation. This first exercise  provides a direct, hands-on calculation to solidify your understanding of how the scheme operates at the most fundamental level, guiding you through a single time step for the inviscid Burgers' equation.",
            "id": "3413890",
            "problem": "Consider the scalar conservation law $u_t + \\partial_x f(u) = 0$ with flux $f(u) = \\frac{u^2}{2}$ (inviscid Burgers equation) on a one-dimensional uniform mesh with spatial step size $\\Delta x$ and explicit time step $\\Delta t$. Starting from the integral form of conservation over a control volume and the finite volume update based on a consistent interface numerical flux, derive the first-order Lax–Friedrichs central scheme numerical flux for a scalar conservation law by enforcing consistency with $f(u)$ and adding a linear dissipative term scaled by a characteristic speed bound. Use the characteristic speed bound $\\alpha_{i+1/2}$ equal to the maximum of the absolute value of the local characteristic speeds on either side of the interface, where the characteristic speed for inviscid Burgers equation is $f'(u) = u$; that is, take $\\alpha_{i+1/2} = \\max(|u_i^n|, |u_{i+1}^n|)$.\n\nYou are given the discrete initial profile at time level $n=0$ for three neighboring cells: $u_4^0 = 1.2$, $u_5^0 = 0.4$, and $u_6^0 = -0.8$, together with $\\Delta x = 0.1$ and $\\Delta t = 0.05$. Using the finite volume explicit update based on the derived Lax–Friedrichs central scheme numerical flux, compute the updated value $u_5^1$ after one time step. Express the final answer as a single real number. No rounding is required.",
            "solution": "The user wants to solve a numerical problem involving the Lax-Friedrichs scheme for the inviscid Burgers' equation.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n-   Scalar conservation law: $u_t + \\partial_x f(u) = 0$.\n-   Flux function: $f(u) = \\frac{u^2}{2}$ (inviscid Burgers' equation).\n-   One-dimensional uniform mesh with spatial step size $\\Delta x$ and time step $\\Delta t$.\n-   Task 1: Derive the first-order Lax-Friedrichs central scheme numerical flux.\n    -   Start from the integral form of conservation.\n    -   Use a finite volume update based on a consistent interface numerical flux.\n    -   Add a linear dissipative term scaled by a characteristic speed bound.\n    -   Characteristic speed for the inviscid Burgers' equation is $f'(u) = u$.\n    -   The characteristic speed bound at interface $i+1/2$ is given by $\\alpha_{i+1/2} = \\max(|u_i^n|, |u_{i+1}^n|)$.\n-   Task 2: Compute the updated value $u_5^1$.\n-   Given discrete initial profile at $n=0$: $u_4^0 = 1.2$, $u_5^0 = 0.4$, and $u_6^0 = -0.8$.\n-   Given constants: $\\Delta x = 0.1$ and $\\Delta t = 0.05$.\n\n**Step 2: Validate Using Extracted Givens**\n-   **Scientifically Grounded:** The problem describes a standard application of the finite volume method (specifically, the local Lax-Friedrichs or Rusanov scheme) to a canonical hyperbolic conservation law (the inviscid Burgers' equation). All concepts are fundamental to the field of numerical partial differential equations. The problem is scientifically sound.\n-   **Well-Posed:** All necessary data ($u_i^0$ values, $\\Delta x$, $\\Delta t$), the flux function, and the specific definition of the numerical scheme are provided. The problem asks for the calculation of a single value, $u_5^1$, which is uniquely determined by the provided information.\n-   **Objective:** The problem is stated using precise, unambiguous mathematical language.\n\n**Step 3: Verdict and Action**\nThe problem is valid as it is scientifically grounded, well-posed, objective, and complete. I will proceed with the solution.\n\n### Derivation and Solution\n\nThe problem is divided into two parts: first, to derive the Lax-Friedrichs numerical flux, and second, to use it to compute a cell value after one time step.\n\n**Part 1: Derivation of the Lax–Friedrichs Scheme**\n\nWe begin with the integral form of the scalar conservation law $u_t + \\partial_x f(u) = 0$ over a control volume $C_i = [x_{i-1/2}, x_{i+1/2}]$ from time $t^n$ to $t^{n+1} = t^n + \\Delta t$.\n$$ \\int_{x_{i-1/2}}^{x_{i+1/2}} u(x, t^{n+1}) dx - \\int_{x_{i-1/2}}^{x_{i+1/2}} u(x, t^n) dx + \\int_{t^n}^{t^{n+1}} f(u(x_{i+1/2}, t)) dt - \\int_{t^n}^{t^{n+1}} f(u(x_{i-1/2}, t)) dt = 0 $$\nWe define the cell average of $u$ over cell $C_i$ at time $t^n$ as $u_i^n = \\frac{1}{\\Delta x} \\int_{x_{i-1/2}}^{x_{i+1/2}} u(x, t^n) dx$, where $\\Delta x = x_{i+1/2} - x_{i-1/2}$. Dividing the integral equation by $\\Delta x$ and using the cell average definition, we get:\n$$ u_i^{n+1} - u_i^n + \\frac{1}{\\Delta x} \\left( \\int_{t^n}^{t^{n+1}} f(u(x_{i+1/2}, t)) dt - \\int_{t^n}^{t^{n+1}} f(u(x_{i-1/2}, t)) dt \\right) = 0 $$\nWe introduce a numerical flux function $F_{i+1/2}$ that approximates the time-averaged flux at the cell interface $x_{i+1/2}$:\n$$ F_{i+1/2} \\approx \\frac{1}{\\Delta t} \\int_{t^n}^{t^{n+1}} f(u(x_{i+1/2}, t)) dt $$\nSubstituting this into the equation for the cell averages gives the general finite volume update scheme:\n$$ u_i^{n+1} = u_i^n - \\frac{\\Delta t}{\\Delta x} (F_{i+1/2} - F_{i-1/2}) $$\nThe Lax–Friedrichs scheme is based on a central approximation for the flux term, with an added artificial viscosity or dissipation term to ensure stability. The numerical flux $F_{i+1/2}$ at the interface between cell $i$ (left state $u_L = u_i^n$) and cell $i+1$ (right state $u_R = u_{i+1}^n$) is given by:\n$$ F_{i+1/2} = F(u_i^n, u_{i+1}^n) = \\frac{1}{2} [f(u_i^n) + f(u_{i+1}^n)] - \\frac{1}{2} \\alpha_{i+1/2} [u_{i+1}^n - u_i^n] $$\nHere, the term $\\frac{1}{2} [f(u_i^n) + f(u_{i+1}^n)]$ is a simple central average of the fluxes from the two adjacent cells. The second term, $-\\frac{1}{2} \\alpha_{i+1/2} [u_{i+1}^n - u_i^n]$, is the numerical dissipation. The coefficient $\\alpha_{i+1/2}$ must be a bound on the characteristic speed of propagation at the interface.\nThe problem specifies the flux from the inviscid Burgers' equation, $f(u) = \\frac{u^2}{2}$, for which the characteristic speed is $f'(u) = u$. The problem further specifies the local dissipation coefficient to be $\\alpha_{i+1/2} = \\max(|u_i^n|, |u_{i+1}^n|)$. This is a common choice, leading to the local Lax-Friedrichs scheme, also known as the Rusanov scheme.\n\n**Part 2: Computation of $u_5^1$**\n\nWe need to compute the value $u_5^1$ using the finite volume update formula:\n$$ u_5^1 = u_5^0 - \\frac{\\Delta t}{\\Delta x} (F_{5+1/2} - F_{4+1/2}) $$\nThe givens are: $u_4^0 = 1.2$, $u_5^0 = 0.4$, $u_6^0 = -0.8$, $\\Delta x = 0.1$, and $\\Delta t = 0.05$. The ratio of step sizes is $\\frac{\\Delta t}{\\Delta x} = \\frac{0.05}{0.1} = 0.5$.\n\nFirst, we calculate the numerical flux $F_{5+1/2}$ at the interface between cell $5$ and cell $6$.\nThe states are $u_L = u_5^0 = 0.4$ and $u_R = u_6^0 = -0.8$.\nThe physical fluxes are $f(u_5^0) = \\frac{(0.4)^2}{2} = \\frac{0.16}{2} = 0.08$ and $f(u_6^0) = \\frac{(-0.8)^2}{2} = \\frac{0.64}{2} = 0.32$.\nThe dissipation coefficient is $\\alpha_{5+1/2} = \\max(|u_5^0|, |u_6^0|) = \\max(|0.4|, |-0.8|) = \\max(0.4, 0.8) = 0.8$.\nNow we compute the flux $F_{5+1/2}$:\n$$ F_{5+1/2} = \\frac{1}{2} [f(u_5^0) + f(u_6^0)] - \\frac{1}{2} \\alpha_{5+1/2} [u_6^0 - u_5^0] $$\n$$ F_{5+1/2} = \\frac{1}{2} [0.08 + 0.32] - \\frac{1}{2} (0.8) [-0.8 - 0.4] $$\n$$ F_{5+1/2} = \\frac{1}{2} (0.40) - 0.4 (-1.2) $$\n$$ F_{5+1/2} = 0.20 + 0.48 = 0.68 $$\n\nNext, we calculate the numerical flux $F_{4+1/2}$ at the interface between cell $4$ and cell $5$.\nThe states are $u_L = u_4^0 = 1.2$ and $u_R = u_5^0 = 0.4$.\nThe physical fluxes are $f(u_4^0) = \\frac{(1.2)^2}{2} = \\frac{1.44}{2} = 0.72$ and $f(u_5^0) = \\frac{(0.4)^2}{2} = \\frac{0.16}{2} = 0.08$.\nThe dissipation coefficient is $\\alpha_{4+1/2} = \\max(|u_4^0|, |u_5^0|) = \\max(|1.2|, |0.4|) = \\max(1.2, 0.4) = 1.2$.\nNow we compute the flux $F_{4+1/2}$:\n$$ F_{4+1/2} = \\frac{1}{2} [f(u_4^0) + f(u_5^0)] - \\frac{1}{2} \\alpha_{4+1/2} [u_5^0 - u_4^0] $$\n$$ F_{4+1/2} = \\frac{1}{2} [0.72 + 0.08] - \\frac{1}{2} (1.2) [0.4 - 1.2] $$\n$$ F_{4+1/2} = \\frac{1}{2} (0.80) - 0.6 (-0.8) $$\n$$ F_{4+1/2} = 0.40 + 0.48 = 0.88 $$\n\nFinally, we update the value of $u_5^1$ using the fluxes we calculated:\n$$ u_5^1 = u_5^0 - \\frac{\\Delta t}{\\Delta x} (F_{5+1/2} - F_{4+1/2}) $$\n$$ u_5^1 = 0.4 - 0.5 \\times (0.68 - 0.88) $$\n$$ u_5^1 = 0.4 - 0.5 \\times (-0.20) $$\n$$ u_5^1 = 0.4 + 0.1 $$\n$$ u_5^1 = 0.5 $$\nThe updated value for cell $5$ after one time step is $0.5$.",
            "answer": "$$ \\boxed{0.5} $$"
        },
        {
            "introduction": "After applying the scheme, a critical next step is to analyze its behavior. The Lax–Friedrichs scheme achieves stability at the cost of introducing numerical errors, specifically dissipation (smearing) and dispersion (phase error). This practice  delves into the theoretical underpinnings of the scheme using von Neumann stability analysis on a linear advection equation, allowing you to derive the amplification factor and precisely quantify these error sources.",
            "id": "3375332",
            "problem": "Consider the one-dimensional linear advection equation $u_{t} + a\\,u_{x} = 0$ with constant advection speed $a > 0$, discretized on a uniform grid with spatial step $\\Delta x$ and time step $\\Delta t$. The Lax–Friedrichs scheme updates the grid function $u_{j}^{n}$ via\n$$\nu_{j}^{n+1} = \\frac{1}{2}\\left(u_{j+1}^{n} + u_{j-1}^{n}\\right) - \\frac{a\\,\\Delta t}{2\\,\\Delta x}\\left(u_{j+1}^{n} - u_{j-1}^{n}\\right).\n$$\nLet the Courant–Friedrichs–Lewy (CFL) number be $\\nu = \\dfrac{a\\,\\Delta t}{\\Delta x}$ and consider a discrete Fourier mode $u_{j}^{n} = \\hat{u}^{n}\\exp(i j \\theta)$, where $\\theta \\in \\mathbb{R}$ is the nondimensional wavenumber. Define the one-step amplification factor $G(\\theta)$ by $\\hat{u}^{n+1} = G(\\theta)\\,\\hat{u}^{n}$.\n\nStarting from the scheme definition and using the Fourier mode ansatz, derive the expression for $G(\\theta)$ and calculate its magnitude $|G(\\theta)|$ and its argument $\\arg(G(\\theta))$ (the principal value in $(-\\pi,\\pi]$) as closed-form analytic functions of $\\theta$ and $\\nu$. Your final answer must be given as two expressions: one for $|G(\\theta)|$ and one for $\\arg(G(\\theta))$. If you invoke a branch-sensitive formula for the argument, it must be written explicitly so that the value lies in $(-\\pi,\\pi]$. Express your final answer as a symbolic expression and do not include any units.",
            "solution": "The problem requires the derivation of the amplification factor $G(\\theta)$, its magnitude $|G(\\theta)|$, and its argument $\\arg(G(\\theta))$ for the Lax–Friedrichs scheme applied to the one-dimensional linear advection equation.\n\nThe linear advection equation is given by:\n$$\nu_{t} + a\\,u_{x} = 0\n$$\nwhere $a > 0$ is a constant.\n\nThe Lax–Friedrichs scheme is:\n$$\nu_{j}^{n+1} = \\frac{1}{2}\\left(u_{j+1}^{n} + u_{j-1}^{n}\\right) - \\frac{a\\,\\Delta t}{2\\,\\Delta x}\\left(u_{j+1}^{n} - u_{j-1}^{n}\\right)\n$$\nLet the Courant–Friedrichs–Lewy (CFL) number be $\\nu = \\frac{a\\,\\Delta t}{\\Delta x}$. The scheme can be written as:\n$$\nu_{j}^{n+1} = \\frac{1}{2}\\left(u_{j+1}^{n} + u_{j-1}^{n}\\right) - \\frac{\\nu}{2}\\left(u_{j+1}^{n} - u_{j-1}^{n}\\right)\n$$\n\nWe perform a von Neumann stability analysis by substituting the discrete Fourier mode $u_{j}^{n} = \\hat{u}^{n}\\exp(i j \\theta)$ into the scheme. The terms in the scheme become:\n- $u_{j}^{n+1} = \\hat{u}^{n+1}\\exp(i j \\theta)$\n- $u_{j+1}^{n} = \\hat{u}^{n}\\exp(i (j+1) \\theta) = \\hat{u}^{n}\\exp(i j \\theta)\\exp(i \\theta)$\n- $u_{j-1}^{n} = \\hat{u}^{n}\\exp(i (j-1) \\theta) = \\hat{u}^{n}\\exp(i j \\theta)\\exp(-i \\theta)$\n\nSubstituting these into the scheme equation:\n$$\n\\hat{u}^{n+1}\\exp(i j \\theta) = \\frac{1}{2}\\left(\\hat{u}^{n}\\exp(i j \\theta)\\exp(i \\theta) + \\hat{u}^{n}\\exp(i j \\theta)\\exp(-i \\theta)\\right) - \\frac{\\nu}{2}\\left(\\hat{u}^{n}\\exp(i j \\theta)\\exp(i \\theta) - \\hat{u}^{n}\\exp(i j \\theta)\\exp(-i \\theta)\\right)\n$$\nThe common factor $\\exp(i j \\theta)$ can be cancelled from every term:\n$$\n\\hat{u}^{n+1} = \\frac{\\hat{u}^{n}}{2}\\left(\\exp(i \\theta) + \\exp(-i \\theta)\\right) - \\frac{\\nu\\hat{u}^{n}}{2}\\left(\\exp(i \\theta) - \\exp(-i \\theta)\\right)\n$$\nBy definition, the amplification factor $G(\\theta)$ is such that $\\hat{u}^{n+1} = G(\\theta)\\hat{u}^{n}$. Dividing by $\\hat{u}^{n}$ (assuming $\\hat{u}^{n} \\neq 0$):\n$$\nG(\\theta) = \\frac{1}{2}\\left(\\exp(i \\theta) + \\exp(-i \\theta)\\right) - \\frac{\\nu}{2}\\left(\\exp(i \\theta) - \\exp(-i \\theta)\\right)\n$$\nUsing Euler's formulas, $\\cos(\\theta) = \\frac{\\exp(i \\theta) + \\exp(-i \\theta)}{2}$ and $\\sin(\\theta) = \\frac{\\exp(i \\theta) - \\exp(-i \\theta)}{2i}$, we can simplify the expression for $G(\\theta)$:\n$$\nG(\\theta) = \\cos(\\theta) - \\frac{\\nu}{2}(2i\\sin(\\theta))\n$$\n$$\nG(\\theta) = \\cos(\\theta) - i\\nu\\sin(\\theta)\n$$\n\nNext, we calculate the magnitude $|G(\\theta)|$. For a complex number $z = x+iy$, its magnitude is $|z| = \\sqrt{x^2 + y^2}$. Here, the real part is $\\mathrm{Re}(G(\\theta)) = \\cos(\\theta)$ and the imaginary part is $\\mathrm{Im}(G(\\theta)) = -\\nu\\sin(\\theta)$.\n$$\n|G(\\theta)| = \\sqrt{(\\cos(\\theta))^2 + (-\\nu\\sin(\\theta))^2} = \\sqrt{\\cos^2(\\theta) + \\nu^2\\sin^2(\\theta)}\n$$\nThis expression is correct, but it can be written in a more compact form using the double-angle identity for cosine. Using $\\cos^2(\\theta) = \\frac{1+\\cos(2\\theta)}{2}$ and $\\sin^2(\\theta) = \\frac{1-\\cos(2\\theta)}{2}$:\n$$\n|G(\\theta)|^2 = \\frac{1+\\cos(2\\theta)}{2} + \\nu^2\\left(\\frac{1-\\cos(2\\theta)}{2}\\right) = \\frac{1}{2}(1 + \\cos(2\\theta) + \\nu^2 - \\nu^2\\cos(2\\theta))\n$$\n$$\n|G(\\theta)|^2 = \\frac{1+\\nu^2}{2} + \\frac{1-\\nu^2}{2}\\cos(2\\theta)\n$$\nTherefore, the magnitude is:\n$$\n|G(\\theta)| = \\sqrt{\\frac{1+\\nu^2}{2} + \\frac{1-\\nu^2}{2}\\cos(2\\theta)}\n$$\nFor the scheme to be stable, we require $|G(\\theta)| \\le 1$ for all $\\theta$. This leads to the CFL condition $|\\nu| \\le 1$.\n\nFinally, we calculate the argument (or phase) of $G(\\theta)$, denoted as $\\arg(G(\\theta))$. The problem asks for the principal value, which lies in the interval $(-\\pi, \\pi]$. Let $\\phi(\\theta) = \\arg(G(\\theta))$. The argument is determined by the signs of the real and imaginary parts.\n- Real part: $X = \\cos(\\theta)$\n- Imaginary part: $Y = -\\nu\\sin(\\theta)$\nThe argument is given by the `atan2` function, $\\phi(\\theta) = \\mathrm{atan2}(Y, X) = \\mathrm{atan2}(-\\nu\\sin(\\theta), \\cos(\\theta))$. The problem requires this to be written as an explicit formula. We construct this formula piecewise for one period of $\\theta$, for instance $\\theta \\in (-\\pi, \\pi]$.\n1.  If $X > 0$, i.e., $\\cos(\\theta) > 0$, which for $\\theta \\in (-\\pi, \\pi]$ means $\\theta \\in (-\\pi/2, \\pi/2)$. The argument is $\\phi(\\theta) = \\arctan(Y/X) = \\arctan(-\\nu\\tan(\\theta))$.\n2.  If $X < 0$, i.e., $\\cos(\\theta) < 0$, which for $\\theta \\in (-\\pi, \\pi]$ means $\\theta \\in (\\pi/2, \\pi] \\cup (-\\pi, -\\pi/2)$.\n    - If $Y \\ge 0$, i.e., $-\\nu\\sin(\\theta) \\ge 0$, which implies $\\sin(\\theta) \\le 0$ as $\\nu > 0$. This corresponds to $\\theta \\in (-\\pi, -\\pi/2)$ or $\\theta=\\pi$. The argument is $\\phi(\\theta) = \\arctan(Y/X) + \\pi = \\arctan(-\\nu\\tan(\\theta)) + \\pi$. At $\\theta = \\pi$, $Y=0$ and $X=-1$, so $\\phi(\\pi) = \\pi$.\n    - If $Y < 0$, i.e., $-\\nu\\sin(\\theta) < 0$, which implies $\\sin(\\theta) > 0$. This corresponds to $\\theta \\in (\\pi/2, \\pi)$. The argument is $\\phi(\\theta) = \\arctan(Y/X) - \\pi = \\arctan(-\\nu\\tan(\\theta)) - \\pi$.\n3.  If $X = 0$, i.e., $\\cos(\\theta) = 0$, which for $\\theta \\in (-\\pi, \\pi]$ means $\\theta = \\pm \\pi/2$.\n    - If $\\theta = \\pi/2$, then $Y = -\\nu\\sin(\\pi/2) = -\\nu < 0$. The argument is $\\phi(\\pi/2) = -\\pi/2$.\n    - If $\\theta = -\\pi/2$, then $Y = -\\nu\\sin(-\\pi/2) = \\nu > 0$. The argument is $\\phi(-\\pi/2) = \\pi/2$.\n\nCombining these cases gives the explicit piecewise formula for $\\arg(G(\\theta))$ for $\\theta \\in (-\\pi, \\pi]$:\n$$\n\\arg(G(\\theta)) = \\begin{cases}\n \\arctan(-\\nu\\tan\\theta) + \\pi & \\text{if } \\theta \\in (-\\pi, -\\pi/2) \\\\\n \\pi/2 & \\text{if } \\theta = -\\pi/2 \\\\\n \\arctan(-\\nu\\tan\\theta) & \\text{if } \\theta \\in (-\\pi/2, \\pi/2) \\\\\n -\\pi/2 & \\text{if } \\theta = \\pi/2 \\\\\n \\arctan(-\\nu\\tan\\theta) - \\pi & \\text{if } \\theta \\in (\\pi/2, \\pi) \\\\\n \\pi & \\text{if } \\theta = \\pi\n\\end{cases}\n$$\nThis function correctly gives the principal argument in the interval $(-\\pi, \\pi]$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n|G(\\theta)| = \\sqrt{\\cos^2(\\theta) + \\nu^2\\sin^2(\\theta)} & \\arg(G(\\theta)) = \\begin{cases} \\arctan(-\\nu\\tan\\theta) + \\pi & \\text{for } \\cos\\theta < 0, \\sin\\theta < 0 \\\\ \\pi/2 & \\text{for } \\cos\\theta = 0, \\sin\\theta = -1 \\\\ \\arctan(-\\nu\\tan\\theta) & \\text{for } \\cos\\theta > 0 \\\\ -\\pi/2 & \\text{for } \\cos\\theta = 0, \\sin\\theta = 1 \\\\ \\arctan(-\\nu\\tan\\theta) - \\pi & \\text{for } \\cos\\theta < 0, \\sin\\theta > 0 \\\\ \\pi & \\text{for } \\cos\\theta = -1, \\sin\\theta = 0 \\end{cases} \\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "A primary drawback of the standard Lax–Friedrichs scheme is its tendency to be overly diffusive, which can smear important physical features like contact waves and shocks. To address this, advanced schemes often employ an adaptive numerical viscosity. This final exercise  explores such a strategy, where the dissipation parameter $\\alpha$ is dynamically adjusted based on local solution gradients, providing a powerful demonstration of how to balance the need for stability with the goal of high-fidelity simulation.",
            "id": "3375314",
            "problem": "Consider the scalar conservation law $u_t + (f(u))_x = 0$ with sufficiently smooth convex flux $f \\in C^2(\\mathbb{R})$ posed on the one-dimensional periodic domain $x \\in [0,1]$. Let $f(u) = \\tfrac{1}{2} u^2$ (inviscid Burgers equation), so that $f'(u) = u$. We discretize space with a uniform mesh of $N$ points with grid spacing $\\Delta x = \\tfrac{1}{N}$ and periodic indexing. Define the explicit finite volume update\n$$\nu_i^{n+1} = u_i^n - \\frac{\\Delta t}{\\Delta x}\\left(F_{i+\\tfrac{1}{2}}^n - F_{i-\\tfrac{1}{2}}^n\\right),\n$$\nwhere the numerical flux is the local Lax–Friedrichs (Rusanov) flux\n$$\nF_{i+\\tfrac{1}{2}}^n = \\frac{1}{2} \\left( f(u_i^n) + f(u_{i+1}^n) \\right) - \\frac{1}{2} \\alpha_{i+\\tfrac{1}{2}}^n \\left( u_{i+1}^n - u_i^n \\right).\n$$\nYou are to construct a space-time adaptive numerical viscosity $\\alpha(x,t)$ based on local flow features via\n$$\n\\alpha_{i+\\tfrac{1}{2}}^n = \\lambda\\, \\mathrm{Lip}_x\\!\\left( f'(u(\\cdot,t^n)) \\right)\\Big|_{[x_i,x_{i+1}]},\n$$\nwhere $\\lambda > 0$ is a tunable parameter and $\\mathrm{Lip}_x(\\cdot)\\big|_{[x_i,x_{i+1}]}$ denotes a consistent discrete estimate of the Lipschitz constant of $f'(u(x,t))$ on the local spatial interval $[x_i,x_{i+1}]$. Work within the following concrete and implementable approximation for the inviscid Burgers flux:\n$$\n\\mathrm{Lip}_x\\!\\left( f'(u(\\cdot,t^n)) \\right)\\Big|_{[x_i,x_{i+1}]} \\approx \\max\\!\\left( \\left|f'(u_i^n)\\right|, \\left|f'(u_{i+1}^n)\\right| \\right) + \\frac{\\Delta x}{2} \\frac{ \\left| f'(u_{i+1}^n) - f'(u_i^n) \\right| }{\\Delta x}.\n$$\nFor $f'(u) = u$, this reduces to\n$$\n\\alpha_{i+\\tfrac{1}{2}}^n = \\lambda \\left( \\max\\!\\left( \\left|u_i^n\\right|, \\left|u_{i+1}^n\\right| \\right) + \\frac{1}{2} \\left|u_{i+1}^n - u_i^n\\right| \\right).\n$$\nStarting from the definitions of scalar conservation laws, monotone numerical fluxes, and the Lax–Friedrichs scheme, do the following:\n\n- Derive the sufficient monotonicity and stability condition for the local Lax–Friedrichs scheme that ties $\\alpha_{i+\\tfrac{1}{2}}^n$ to the characteristic speed bound of the conservation law. Explain why the condition $\\alpha_{i+\\tfrac{1}{2}}^n \\ge \\sup_{\\xi \\in [u_i^n,u_{i+1}^n]} \\left| f'(\\xi) \\right|$ yields a monotone scheme that is nonlinearly stable in the $\\ell^1$ norm, and how the explicit Courant–Friedrichs–Lewy (CFL) time step restriction $\\Delta t \\le \\mathrm{CFL} \\, \\Delta x / \\max_{i} \\alpha_{i+\\tfrac{1}{2}}^n$ with $0 < \\mathrm{CFL} < 1$ arises.\n\n- Using the above discrete Lipschitz construction, prove that for $\\lambda \\ge 1$, the choice\n$$\n\\alpha_{i+\\tfrac{1}{2}}^n = \\lambda \\left( \\max\\!\\left( \\left|f'(u_i^n)\\right|, \\left|f'(u_{i+1}^n)\\right| \\right) + \\frac{\\Delta x}{2} \\cdot \\frac{ \\left| f'(u_{i+1}^n) - f'(u_i^n) \\right| }{\\Delta x} \\right)\n$$\nsatisfies the monotonicity bound $\\alpha_{i+\\tfrac{1}{2}}^n \\ge \\sup_{\\xi \\in [u_i^n,u_{i+1}^n]} \\left| f'(\\xi) \\right|$ and therefore yields a stable scheme. Argue that $\\lambda = 1$ minimizes numerical diffusion subject to stability at the interface level, while larger $\\lambda$ increases diffusion.\n\n- Provide a sensitivity analysis of the role of $\\lambda$ contrasting smooth regions (small spatial variation of $f'(u)$) versus shock regions (large spatial variation of $f'(u)$), quantifying how the added term $\\tfrac{\\Delta x}{2} \\left| f'(u_{i+1}^n) - f'(u_i^n) \\right| / \\Delta x$ inflates $\\alpha_{i+\\tfrac{1}{2}}^n$ near strong gradients and leaves it nearly unchanged in smooth zones.\n\nImplement the scheme and produce numerical evidence according to the test suite below. Use periodic boundary conditions. Let time step $\\Delta t$ be selected adaptively at each step by the CFL condition with $\\mathrm{CFL} = 0.9$.\n\nInitial data and parameters for the test suite:\n\n- Smooth case: $u(x,0) = \\tfrac{1}{2} + \\tfrac{1}{2} \\sin(2\\pi x)$, final time $T = 0.1$, number of grid points $N = 256$, parameter values $\\lambda \\in \\{ 0.8, 1.0, 2.0 \\}$.\n\n- Shock case: $u(x,0) = 1$ for $x < 0.5$ and $u(x,0) = 0$ for $x \\ge 0.5$, final time $T = 0.05$, number of grid points $N = 256$, parameter values $\\lambda \\in \\{ 0.8, 1.0, 2.0 \\}$.\n\nFor each run, compute the following quantitative diagnostics:\n\n- Total variation ratio $\\mathrm{TV}(u(\\cdot,T))/\\mathrm{TV}(u(\\cdot,0))$, where $\\mathrm{TV}(u) = \\sum_{i=0}^{N-1} \\left| u_{i+1} - u_i \\right|$ with periodic indexing. Report as a floating-point number.\n\n- Shock thickness proxy at final time for the shock case: the integer count of grid points where $u(x_i,T) \\in [0.1,0.9]$.\n\n- Maximum principle violation amplitude: $\\max\\!\\left( 0, \\max_i u_i(T) - \\max_i u_i(0) \\right) + \\max\\!\\left( 0, \\min_i u_i(0) - \\min_i u_i(T) \\right)$, reported as a floating-point number.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets in the following order:\n$$\n\\Big[ \\mathrm{TV}_{\\mathrm{smooth}}(\\lambda{=}0.8), \\mathrm{TV}_{\\mathrm{smooth}}(\\lambda{=}1.0), \\mathrm{TV}_{\\mathrm{smooth}}(\\lambda{=}2.0), \\mathrm{Thick}_{\\mathrm{shock}}(\\lambda{=}0.8), \\mathrm{Thick}_{\\mathrm{shock}}(\\lambda{=}1.0), \\mathrm{Thick}_{\\mathrm{shock}}(\\lambda{=}2.0), \\mathrm{MPV}_{\\mathrm{smooth}}(\\lambda{=}0.8), \\mathrm{MPV}_{\\mathrm{smooth}}(\\lambda{=}1.0), \\mathrm{MPV}_{\\mathrm{smooth}}(\\lambda{=}2.0), \\mathrm{MPV}_{\\mathrm{shock}}(\\lambda{=}0.8), \\mathrm{MPV}_{\\mathrm{shock}}(\\lambda{=}1.0), \\mathrm{MPV}_{\\mathrm{shock}}(\\lambda{=}2.0) \\Big].\n$$\nThe output must be a single line with numbers in the specified order, using the units and values induced by the nondimensional formulation above, with no additional text.",
            "solution": "The problem is valid as it is scientifically grounded in the theory of numerical methods for hyperbolic conservation laws, is well-posed, and provides a complete and consistent set of definitions and parameters for both theoretical analysis and numerical implementation.\n\nThe problem concerns the numerical solution of the scalar conservation law on a periodic domain $x \\in [0,1]$:\n$$\n\\frac{\\partial u}{\\partial t} + \\frac{\\partial f(u)}{\\partial x} = 0.\n$$\nFor this analysis, the flux function is the convex quadratic flux $f(u) = \\frac{1}{2}u^2$, corresponding to the inviscid Burgers' equation, for which the characteristic speed is $f'(u) = u$.\n\nThe domain is discretized into $N$ uniform cells of width $\\Delta x = 1/N$, with cell centers $x_i = i\\Delta x$ for $i=0, \\dots, N-1$. The solution in cell $i$ at time $t^n$ is denoted by $u_i^n$. The finite volume method updates the solution via the conservative formula:\n$$\nu_i^{n+1} = u_i^n - \\frac{\\Delta t}{\\Delta x}\\left(F_{i+\\tfrac{1}{2}}^n - F_{i-\\tfrac{1}{2}}^n\\right),\n$$\nwhere $u_i^{n+1}$ is the solution at time $t^{n+1} = t^n + \\Delta t$, and $F_{i\\pm\\tfrac{1}{2}}^n$ are numerical fluxes at the cell interfaces. The problem specifies the local Lax–Friedrichs (or Rusanov) numerical flux:\n$$\nF_{i+\\tfrac{1}{2}}^n = F(u_i^n, u_{i+1}^n) = \\frac{1}{2} \\left[ f(u_i^n) + f(u_{i+1}^n) \\right] - \\frac{1}{2} \\alpha_{i+\\tfrac{1}{2}}^n \\left[ u_{i+1}^n - u_i^n \\right],\n$$\nwhere $\\alpha_{i+\\tfrac{1}{2}}^n$ is the numerical viscosity coefficient at the interface between cells $i$ and $i+1$.\n\n### Monotonicity, Stability, and the CFL Condition\n\nA numerical scheme for a scalar conservation law is called monotone if the updated solution $u_i^{n+1}$ is a non-decreasing function of its stencil values at the previous time step, i.e., $u_i^{n+1} = H(u_{i-1}^n, u_i^n, u_{i+1}^n)$ where $\\frac{\\partial H}{\\partial u_j^n} \\ge 0$ for $j \\in \\{i-1, i, i+1\\}$.\n\nA sufficient condition for the scheme to be monotone is that the numerical flux function $F(u_L, u_R)$ must be a non-decreasing function of its first argument $u_L$ and a non-increasing function of its second argument $u_R$. Let us compute the partial derivatives of the given flux $F(u_L, u_R)$:\n$$\n\\frac{\\partial F}{\\partial u_L} = \\frac{1}{2} f'(u_L) + \\frac{1}{2} \\alpha.\n$$\n$$\n\\frac{\\partial F}{\\partial u_R} = \\frac{1}{2} f'(u_R) - \\frac{1}{2} \\alpha.\n$$\nThe conditions $\\frac{\\partial F}{\\partial u_L} \\ge 0$ and $\\frac{\\partial F}{\\partial u_R} \\le 0$ respectively imply:\n$$\n\\alpha \\ge -f'(u_L) \\quad \\text{and} \\quad \\alpha \\ge f'(u_R).\n$$\nTo satisfy both, the numerical viscosity $\\alpha$ for the interface between states $u_L$ and $u_R$ must satisfy $\\alpha \\ge \\max(f'(u_R), -f'(u_L))$. For stability, this must hold for any pair of adjacent states in the solution. A more general and robust condition that encompasses this is to require $\\alpha$ to be an upper bound on all possible characteristic speeds emerging from the Riemann problem between $u_L$ and $u_R$. For a convex scalar flux, the characteristic speeds $f'(\\xi)$ for $\\xi \\in [u_L, u_R]$ (or $[u_R, u_L]$) are monotonic. Therefore, the maximum absolute speed is achieved at the boundaries of this interval. The sufficient condition for a monotone flux is thus:\n$$\n\\alpha_{i+\\tfrac{1}{2}}^n \\ge \\sup_{\\xi \\in [u_i^n, u_{i+1}^n]} |f'(\\xi)| = \\max\\left(|f'(u_i^n)|, |f'(u_{i+1}^n)|\\right).\n$$\nThis is the condition required for the flux to be monotone. Now, let's analyze the full scheme's monotonicity. We have established that for $j=i\\pm 1$, $\\frac{\\partial H}{\\partial u_j^n} \\ge 0$. We must also check the coefficient of $u_i^n$:\n$u_i^{n+1} = H(u_{i-1}^n, u_i^n, u_{i+1}^n) = u_i^n - \\frac{\\Delta t}{\\Delta x}\\left(F(u_i^n, u_{i+1}^n) - F(u_{i-1}^n, u_i^n)\\right)$.\n$$\n\\frac{\\partial H}{\\partial u_i^n} = 1 - \\frac{\\Delta t}{\\Delta x}\\left(\\frac{\\partial F(u_i^n, u_{i+1}^n)}{\\partial u_i^n} - \\frac{\\partial F(u_{i-1}^n, u_i^n)}{\\partial u_i^n}\\right).\n$$\nUsing our previously computed partial derivatives, where for the second term $u_i^n$ is the \"right\" state:\n$$\n\\frac{\\partial H}{\\partial u_i^n} = 1 - \\frac{\\Delta t}{\\Delta x}\\left[ \\left(\\frac{1}{2}f'(u_i^n) + \\frac{1}{2}\\alpha_{i+\\tfrac{1}{2}}^n\\right) - \\left(\\frac{1}{2}f'(u_i^n) - \\frac{1}{2}\\alpha_{i-\\tfrac{1}{2}}^n\\right) \\right] = 1 - \\frac{\\Delta t}{2\\Delta x}\\left(\\alpha_{i+\\tfrac{1}{2}}^n + \\alpha_{i-\\tfrac{1}{2}}^n\\right).\n$$\nThe condition $\\frac{\\partial H}{\\partial u_i^n} \\ge 0$ leads to the time step restriction:\n$$\n\\Delta t \\le \\frac{2\\Delta x}{\\alpha_{i+\\tfrac{1}{2}}^n + \\alpha_{i-\\tfrac{1}{2}}^n}.\n$$\nTo ensure this holds for all cells $i$, a global restriction based on the maximum viscosity is imposed:\n$$\n\\Delta t \\le \\frac{\\Delta x}{\\max_i \\alpha_{i+\\tfrac{1}{2}}^n}.\n$$\nIn practice, a Courant–Friedrichs–Lewy (CFL) safety factor, $0 < \\mathrm{CFL} < 1$, is introduced, yielding the explicit time step restriction $\\Delta t \\le \\mathrm{CFL} \\, \\Delta x / \\max_{i} \\alpha_{i+\\tfrac{1}{2}}^n$.\n\nA monotone scheme satisfies a discrete maximum principle, ensuring that no new extrema are created, which implies stability in the $\\ell^\\infty$-norm. For a conservative scheme on a finite domain, $\\ell^\\infty$-stability implies $\\ell^1$-stability. Furthermore, by Harten's theorem, a monotone scheme is also Total Variation Diminishing (TVD). For scalar conservation laws, a consistent, conservative, and TVD scheme is guaranteed to converge to the unique weak entropy solution. Thus, proving monotonicity is key to establishing the stability and convergence properties of the scheme.\n\n### Validation of the Proposed Numerical Viscosity\n\nThe problem proposes a specific form for the numerical viscosity coefficient:\n$$\n\\alpha_{i+\\tfrac{1}{2}}^n = \\lambda \\left( \\max\\!\\left( \\left|f'(u_i^n)\\right|, \\left|f'(u_{i+1}^n)\\right| \\right) + \\frac{\\Delta x}{2} \\cdot \\frac{ \\left| f'(u_{i+1}^n) - f'(u_i^n) \\right| }{\\Delta x} \\right).\n$$\nWe must prove that for $\\lambda \\ge 1$, this choice satisfies the monotonicity condition $\\alpha_{i+\\tfrac{1}{2}}^n \\ge \\sup_{\\xi \\in [u_i^n,u_{i+1}^n]} | f'(\\xi) |$.\nAs established, for a convex flux, this simplifies to $\\alpha_{i+\\tfrac{1}{2}}^n \\ge \\max(|f'(u_i^n)|, |f'(u_{i+1}^n)|)$.\nLet $M_{i+\\tfrac{1}{2}} = \\max(|f'(u_i^n)|, |f'(u_{i+1}^n)|)$ and $\\Delta_{i+\\tfrac{1}{2}} = \\frac{1}{2} |f'(u_{i+1}^n) - f'(u_i^n)|$. The expression for $\\alpha$ simplifies to $\\alpha_{i+\\tfrac{1}{2}}^n = \\lambda (M_{i+\\tfrac{1}{2}} + \\Delta_{i+\\tfrac{1}{2}})$.\nWe need to show that $\\lambda (M_{i+\\tfrac{1}{2}} + \\Delta_{i+\\tfrac{1}{2}}) \\ge M_{i+\\tfrac{1}{2}}$.\nGiven $\\lambda \\ge 1$:\n$$\n\\lambda (M_{i+\\tfrac{1}{2}} + \\Delta_{i+\\tfrac{1}{2}}) \\ge 1 \\cdot (M_{i+\\tfrac{1}{2}} + \\Delta_{i+\\tfrac{1}{2}}) = M_{i+\\tfrac{1}{2}} + \\Delta_{i+\\tfrac{1}{2}}.\n$$\nSince $\\Delta_{i+\\tfrac{1}{2}} = \\frac{1}{2} |f'(u_{i+1}^n) - f'(u_i^n)| \\ge 0$, it follows that $M_{i+\\tfrac{1}{2}} + \\Delta_{i+\\tfrac{1}{2}} \\ge M_{i+\\tfrac{1}{2}}$.\nThus, for any $\\lambda \\ge 1$, the proposed viscosity coefficient satisfies the monotonicity condition, and the scheme is nonlinearly stable.\n\nThe magnitude of the numerical diffusion is directly proportional to $\\alpha_{i+\\tfrac{1}{2}}^n$. Since stability is guaranteed for $\\lambda \\ge 1$, the choice $\\lambda = 1$ provides the smallest value of $\\alpha_{i+\\tfrac{1}{2}}^n$ that satisfies the condition based on this formula. Therefore, $\\lambda = 1$ minimizes the numerical diffusion at the interface level, subject to maintaining a monotone scheme. Any $\\lambda > 1$ will increase the diffusion, leading to a more smeared representation of solution features like shocks and contact discontinuities.\n\n### Sensitivity Analysis of $\\lambda$\n\nThe viscosity is given by $\\alpha_{i+\\tfrac{1}{2}}^n = \\lambda \\left( M_{i+\\tfrac{1}{2}} + \\Delta_{i+\\tfrac{1}{2}} \\right)$. The term $\\Delta_{i+\\tfrac{1}{2}} = \\frac{1}{2}|f'(u_{i+1}^n) - f'(u_i^n)|$ is designed to be sensitive to local gradients in the characteristic speed $f'(u)$.\n\n-   **Smooth regions**: In regions where the solution $u$ is smooth, the variation between adjacent cells is small. Taylor expansion gives $u_{i+1}^n - u_i^n = u_x \\Delta x + O(\\Delta x^2)$. Similarly, $f'(u_{i+1}^n) - f'(u_i^n) \\approx f''(u_i^n)(u_{i+1}^n - u_i^n) = O(\\Delta x)$. The term $\\Delta_{i+\\tfrac{1}{2}}$ is $O(\\Delta x)$, making it a small correction. The viscosity is dominated by the leading term, $\\alpha_{i+\\tfrac{1}{2}}^n \\approx \\lambda M_{i+\\tfrac{1}{2}}$, which is the standard Rusanov viscosity scaled by $\\lambda$. The added term provides a minimal amount of extra diffusion.\n\n-   **Shock regions**: Near a discontinuity (shock), the jump $|u_{i+1}^n - u_i^n|$ is of order $O(1)$. Consequently, the term $\\Delta_{i+\\tfrac{1}{2}} = \\frac{1}{2}|f'(u_{i+1}^n) - f'(u_i^n)|$ is also of order $O(1)$. This term significantly inflates the numerical viscosity $\\alpha_{i+\\tfrac{1}{2}}^n$. The ratio of the augmented viscosity to the base Rusanov viscosity is\n$$\n\\frac{M_{i+\\tfrac{1}{2}} + \\Delta_{i+\\tfrac{1}{2}}}{M_{i+\\tfrac{1}{2}}} = 1 + \\frac{\\Delta_{i+\\tfrac{1}{2}}}{M_{i+\\tfrac{1}{2}}}.\n$$\nIn a shock region, both numerator and denominator of the fraction are $O(1)$, so the viscosity is increased by an $O(1)$ factor. This addition of substantial diffusion is localized to regions of high gradients, which is precisely where it is needed to suppress spurious oscillations (Gibbs phenomena) and stabilize the numerical solution, leading to a sharp but monotone shock profile. The parameter $\\lambda$ acts as a global scaling factor on this adaptive mechanism. $\\lambda < 1$ risks instability and oscillations, while $\\lambda > 1$ provides a wider, more diffuse shock than necessary for stability.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements the Lax-Friedrichs scheme with adaptive viscosity for the\n    inviscid Burgers' equation and runs a suite of tests.\n    \"\"\"\n\n    def run_simulation(u0, T_final, N, lam, cfl, is_shock_case):\n        \"\"\"\n        Runs a single simulation for a given set of parameters.\n        \"\"\"\n        dx = 1.0 / N\n        u = np.copy(u0)\n        t = 0.0\n        \n        # Initial diagnostics\n        u_max0 = np.max(u0)\n        u_min0 = np.min(u0)\n        tv0 = np.sum(np.abs(np.roll(u0, -1) - u0))\n        if tv0 == 0:\n            tv0 = 1.0 # Avoid division by zero for constant initial data\n\n        while t  T_final:\n            # Periodic boundary conditions for neighbors\n            u_right = np.roll(u, -1)  # u_{i+1}\n\n            # For Burgers' equation, f'(u) = u\n            f_prime_u = u\n            f_prime_u_right = u_right\n\n            # Calculate adaptive numerical viscosity alpha_{i+1/2}\n            alpha_half = lam * (\n                np.maximum(np.abs(f_prime_u), np.abs(f_prime_u_right)) +\n                0.5 * np.abs(f_prime_u_right - f_prime_u)\n            )\n\n            # Adaptive time step based on CFL condition\n            alpha_max = np.max(alpha_half)\n            if alpha_max == 0:\n                # If all velocities are zero, solution is static\n                dt = T_final - t\n            else:\n                dt = cfl * dx / alpha_max\n            \n            dt = min(dt, T_final - t)\n\n            # Flux calculation f(u) = 0.5 * u^2\n            f_u = 0.5 * u**2\n            f_u_right = 0.5 * u_right**2\n\n            # Lax-Friedrichs (Rusanov) numerical flux F_{i+1/2}\n            flux_half = 0.5 * (f_u + f_u_right) - 0.5 * alpha_half * (u_right - u)\n            \n            # Flux at the left interface F_{i-1/2}\n            flux_half_left = np.roll(flux_half, 1)\n\n            # Finite volume update\n            u = u - (dt / dx) * (flux_half - flux_half_left)\n            \n            t += dt\n\n        # Final diagnostics\n        tv_final = np.sum(np.abs(np.roll(u, -1) - u))\n        tv_ratio = tv_final / tv0\n        \n        mpv = max(0, np.max(u) - u_max0) + max(0, u_min0 - np.min(u))\n\n        if is_shock_case:\n            thickness = np.sum((u >= 0.1)  (u = 0.9))\n            return tv_ratio, thickness, mpv\n        else:\n            return tv_ratio, 0, mpv\n\n    # Test suite parameters\n    N = 256\n    T_smooth = 0.1\n    T_shock = 0.05\n    cfl = 0.9\n    lambdas = [0.8, 1.0, 2.0]\n    x = np.linspace(0, 1, N, endpoint=False)\n\n    # Test cases\n    test_cases = [\n        {\n            'name': 'smooth',\n            'ic': 0.5 + 0.5 * np.sin(2 * np.pi * x),\n            'T': T_smooth,\n            'is_shock_case': False\n        },\n        {\n            'name': 'shock',\n            'ic': np.where(x  0.5, 1.0, 0.0),\n            'T': T_shock,\n            'is_shock_case': True\n        }\n    ]\n\n    results_tv_smooth = []\n    results_thick_shock = []\n    results_mpv_smooth = []\n    results_mpv_shock = []\n\n    for case in test_cases:\n        for lam in lambdas:\n            tv_ratio, thickness, mpv = run_simulation(\n                case['ic'], case['T'], N, lam, cfl, case['is_shock_case']\n            )\n            if case['name'] == 'smooth':\n                results_tv_smooth.append(tv_ratio)\n                results_mpv_smooth.append(mpv)\n            elif case['name'] == 'shock':\n                results_thick_shock.append(thickness)\n                results_mpv_shock.append(mpv)\n    \n    # Assemble the final list in the specified order\n    final_results = (\n        results_tv_smooth +\n        results_thick_shock +\n        results_mpv_smooth +\n        results_mpv_shock\n    )\n\n    # Format the output as a comma-separated string in brackets\n    output_str = f\"[{','.join(map(str, final_results))}]\"\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}