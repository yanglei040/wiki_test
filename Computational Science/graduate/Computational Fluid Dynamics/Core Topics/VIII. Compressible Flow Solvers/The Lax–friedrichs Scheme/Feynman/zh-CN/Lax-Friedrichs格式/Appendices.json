{
    "hands_on_practices": [
        {
            "introduction": "掌握任何数值格式的第一步都是通过具体计算来熟悉其运作机制。本练习将引导您将有限体积法应用于无粘伯格斯方程——一个模拟非线性波现象的基本模型。您将亲手计算局部 Lax-Friedrichs（也称作 Rusanov）通量，并完成一次完整的时间步更新，从而巩固对该格式核心计算流程的理解。",
            "id": "3413890",
            "problem": "考虑标量守恒律 $u_t + \\partial_x f(u) = 0$，其通量为 $f(u) = \\frac{u^2}{2}$（无粘伯格斯方程），定义在一维均匀网格上，空间步长为 $\\Delta x$，显式时间步长为 $\\Delta t$。从控制体上的守恒积分形式和基于相容界面数值通量的有限体积更新出发，通过强制与 $f(u)$ 的相容性并添加一个由特征速度界缩放的线性耗散项，推导标量守恒律的一阶 Lax–Friedrichs 中心格式数值通量。使用特征速度界 $\\alpha_{i+1/2}$，其值等于界面两侧局部特征速度绝对值的最大值，其中无粘伯格斯方程的特征速度为 $f'(u) = u$；也就是说，取 $\\alpha_{i+1/2} = \\max(|u_i^n|, |u_{i+1}^n|)$。\n\n给定时间层 $n=0$ 时三个相邻单元的离散初始剖面：$u_4^0 = 1.2$，$u_5^0 = 0.4$，和 $u_6^0 = -0.8$，以及 $\\Delta x = 0.1$ 和 $\\Delta t = 0.05$。使用基于推导出的 Lax–Friedrichs 中心格式数值通量的有限体积显式更新，计算一个时间步长后更新的值 $u_5^1$。将最终答案表示为单个实数。不需要四舍五入。",
            "solution": "用户想要解决一个关于无粘伯格斯方程的 Lax-Friedrichs 格式的数值问题。\n\n### 问题验证\n\n**步骤 1：提取给定条件**\n-   标量守恒律：$u_t + \\partial_x f(u) = 0$。\n-   通量函数：$f(u) = \\frac{u^2}{2}$（无粘伯格斯方程）。\n-   一维均匀网格，空间步长为 $\\Delta x$，时间步长为 $\\Delta t$。\n-   任务1：推导一阶 Lax-Friedrichs 中心格式数值通量。\n    -   从守恒的积分形式出发。\n    -   使用基于相容界面数值通量的有限体积更新。\n    -   添加一个由特征速度界缩放的线性耗散项。\n    -   无粘伯格斯方程的特征速度为 $f'(u) = u$。\n    -   界面 $i+1/2$ 处的特征速度界由 $\\alpha_{i+1/2} = \\max(|u_i^n|, |u_{i+1}^n|)$ 给出。\n-   任务2：计算更新后的值 $u_5^1$。\n-   给定 $n=0$ 时的离散初始剖面：$u_4^0 = 1.2$，$u_5^0 = 0.4$，和 $u_6^0 = -0.8$。\n-   给定常数：$\\Delta x = 0.1$ 和 $\\Delta t = 0.05$。\n\n**步骤 2：使用提取的给定条件进行验证**\n-   **科学上成立：**该问题描述了有限体积法（特别是局部 Lax-Friedrichs 或 Rusanov 格式）在典型双曲守恒律（无粘伯格斯方程）上的标准应用。所有概念都是数值偏微分方程领域的基础。该问题在科学上是合理的。\n-   **适定的：**所有必要的数据（$u_i^0$ 值、$\\Delta x$、$\\Delta t$）、通量函数以及数值格式的具体定义都已提供。问题要求计算单个值 $u_5^1$，该值由所提供的信息唯一确定。\n-   **客观的：**问题使用精确、无歧义的数学语言陈述。\n\n**步骤 3：结论与行动**\n该问题是有效的，因为它在科学上成立、适定、客观且完整。我将继续进行求解。\n\n### 推导与求解\n\n问题分为两部分：首先，推导 Lax-Friedrichs 数值通量；其次，用它来计算一个时间步长后的单元值。\n\n**第一部分：Lax–Friedrichs 格式的推导**\n\n我们从标量守恒律 $u_t + \\partial_x f(u) = 0$ 在控制体 $C_i = [x_{i-1/2}, x_{i+1/2}]$ 上，从时间 $t^n$ 到 $t^{n+1} = t^n + \\Delta t$ 的积分形式开始。\n$$ \\int_{x_{i-1/2}}^{x_{i+1/2}} u(x, t^{n+1}) dx - \\int_{x_{i-1/2}}^{x_{i+1/2}} u(x, t^n) dx + \\int_{t^n}^{t^{n+1}} f(u(x_{i+1/2}, t)) dt - \\int_{t^n}^{t^{n+1}} f(u(x_{i-1/2}, t)) dt = 0 $$\n我们将时间 $t^n$ 时 $u$ 在单元 $C_i$ 上的单元平均定义为 $u_i^n = \\frac{1}{\\Delta x} \\int_{x_{i-1/2}}^{x_{i+1/2}} u(x, t^n) dx$，其中 $\\Delta x = x_{i+1/2} - x_{i-1/2}$。将积分方程除以 $\\Delta x$ 并使用单元平均的定义，我们得到：\n$$ u_i^{n+1} - u_i^n + \\frac{1}{\\Delta x} \\left( \\int_{t^n}^{t^{n+1}} f(u(x_{i+1/2}, t)) dt - \\int_{t^n}^{t^{n+1}} f(u(x_{i-1/2}, t)) dt \\right) = 0 $$\n我们引入一个数值通量函数 $F_{i+1/2}$，它近似于单元界面 $x_{i+1/2}$ 处的时间平均通量：\n$$ F_{i+1/2} \\approx \\frac{1}{\\Delta t} \\int_{t^n}^{t^{n+1}} f(u(x_{i+1/2}, t)) dt $$\n将其代入单元平均方程，得到通用的有限体积更新格式：\n$$ u_i^{n+1} = u_i^n - \\frac{\\Delta t}{\\Delta x} (F_{i+1/2} - F_{i-1/2}) $$\nLax–Friedrichs 格式基于对通量项的中心近似，并添加了人工粘性或耗散项以确保稳定性。在单元 $i$（左状态 $u_L = u_i^n$）和单元 $i+1$（右状态 $u_R = u_{i+1}^n$）之间的界面上的数值通量 $F_{i+1/2}$ 由下式给出：\n$$ F_{i+1/2} = F(u_i^n, u_{i+1}^n) = \\frac{1}{2} [f(u_i^n) + f(u_{i+1}^n)] - \\frac{1}{2} \\alpha_{i+1/2} [u_{i+1}^n - u_i^n] $$\n这里，项 $\\frac{1}{2} [f(u_i^n) + f(u_{i+1}^n)]$ 是来自两个相邻单元的通量的简单中心平均。第二项 $-\\frac{1}{2} \\alpha_{i+1/2} [u_{i+1}^n - u_i^n]$ 是数值耗散。系数 $\\alpha_{i+1/2}$ 必须是界面处传播特征速度的一个界。\n问题指明了无粘伯格斯方程的通量为 $f(u) = \\frac{u^2}{2}$，其特征速度为 $f'(u) = u$。问题进一步指定局部耗散系数为 $\\alpha_{i+1/2} = \\max(|u_i^n|, |u_{i+1}^n|)$。这是一个常见的选择，它导出了局部 Lax-Friedrichs 格式，也称为 Rusanov 格式。\n\n**第二部分：计算 $u_5^1$**\n\n我们需要使用有限体积更新公式计算 $u_5^1$ 的值：\n$$ u_5^1 = u_5^0 - \\frac{\\Delta t}{\\Delta x} (F_{5+1/2} - F_{4+1/2}) $$\n给定条件为：$u_4^0 = 1.2$，$u_5^0 = 0.4$，$u_6^0 = -0.8$，$\\Delta x = 0.1$，以及 $\\Delta t = 0.05$。步长比为 $\\frac{\\Delta t}{\\Delta x} = \\frac{0.05}{0.1} = 0.5$。\n\n首先，我们计算单元 5 和单元 6 之间界面上的数值通量 $F_{5+1/2}$。\n状态为 $u_L = u_5^0 = 0.4$ 和 $u_R = u_6^0 = -0.8$。\n物理通量为 $f(u_5^0) = \\frac{(0.4)^2}{2} = \\frac{0.16}{2} = 0.08$ 和 $f(u_6^0) = \\frac{(-0.8)^2}{2} = \\frac{0.64}{2} = 0.32$。\n耗散系数为 $\\alpha_{5+1/2} = \\max(|u_5^0|, |u_6^0|) = \\max(|0.4|, |-0.8|) = \\max(0.4, 0.8) = 0.8$。\n现在我们计算通量 $F_{5+1/2}$：\n$$ F_{5+1/2} = \\frac{1}{2} [f(u_5^0) + f(u_6^0)] - \\frac{1}{2} \\alpha_{5+1/2} [u_6^0 - u_5^0] $$\n$$ F_{5+1/2} = \\frac{1}{2} [0.08 + 0.32] - \\frac{1}{2} (0.8) [-0.8 - 0.4] $$\n$$ F_{5+1/2} = \\frac{1}{2} (0.40) - 0.4 (-1.2) $$\n$$ F_{5+1/2} = 0.20 + 0.48 = 0.68 $$\n\n接下来，我们计算单元 4 和单元 5 之间界面上的数值通量 $F_{4+1/2}$。\n状态为 $u_L = u_4^0 = 1.2$ 和 $u_R = u_5^0 = 0.4$。\n物理通量为 $f(u_4^0) = \\frac{(1.2)^2}{2} = \\frac{1.44}{2} = 0.72$ 和 $f(u_5^0) = \\frac{(0.4)^2}{2} = \\frac{0.16}{2} = 0.08$。\n耗散系数为 $\\alpha_{4+1/2} = \\max(|u_4^0|, |u_5^0|) = \\max(|1.2|, |0.4|) = \\max(1.2, 0.4) = 1.2$。\n现在我们计算通量 $F_{4+1/2}$：\n$$ F_{4+1/2} = \\frac{1}{2} [f(u_4^0) + f(u_5^0)] - \\frac{1}{2} \\alpha_{4+1/2} [u_5^0 - u_4^0] $$\n$$ F_{4+1/2} = \\frac{1}{2} [0.72 + 0.08] - \\frac{1}{2} (1.2) [0.4 - 1.2] $$\n$$ F_{4+1/2} = \\frac{1}{2} (0.80) - 0.6 (-0.8) $$\n$$ F_{4+1/2} = 0.40 + 0.48 = 0.88 $$\n\n最后，我们使用计算出的通量更新 $u_5^1$ 的值：\n$$ u_5^1 = u_5^0 - \\frac{\\Delta t}{\\Delta x} (F_{5+1/2} - F_{4+1/2}) $$\n$$ u_5^1 = 0.4 - 0.5 \\times (0.68 - 0.88) $$\n$$ u_5^1 = 0.4 - 0.5 \\times (-0.20) $$\n$$ u_5^1 = 0.4 + 0.1 $$\n$$ u_5^1 = 0.5 $$\n一个时间步长后单元 5 的更新值为 $0.5$。",
            "answer": "$$ \\boxed{0.5} $$"
        },
        {
            "introduction": "在掌握了基本计算之后，我们需深入分析数值格式的内在属性。本练习将从数值计算转向理论分析，运用冯·诺依曼稳定性分析来推导 Lax-Friedrichs 格式的放大因子。通过这个过程，您将学会如何量化一个格式如何引入数值误差，即振幅衰减（数值耗散）和相位偏移（数值色散），这是评估和比较不同数值方法性能的关键技能。",
            "id": "3375332",
            "problem": "考虑一维线性平流方程 $u_{t} + a\\,u_{x} = 0$，其中常数平流速度 $a > 0$。该方程在空间步长为 $\\Delta x$、时间步长为 $\\Delta t$ 的均匀网格上进行离散。Lax–Friedrichs 格式通过以下方式更新网格函数 $u_{j}^{n}$：\n$$\nu_{j}^{n+1} = \\frac{1}{2}\\left(u_{j+1}^{n} + u_{j-1}^{n}\\right) - \\frac{a\\,\\Delta t}{2\\,\\Delta x}\\left(u_{j+1}^{n} - u_{j-1}^{n}\\right).\n$$\n令 Courant–Friedrichs–Lewy (CFL) 数为 $\\nu = \\dfrac{a\\,\\Delta t}{\\Delta x}$，并考虑一个离散傅里叶模 $u_{j}^{n} = \\hat{u}^{n}\\exp(i j \\theta)$，其中 $\\theta \\in \\mathbb{R}$ 是无量纲波数。定义单步放大因子 $G(\\theta)$ 为 $\\hat{u}^{n+1} = G(\\theta)\\,\\hat{u}^{n}$。\n\n从该格式的定义出发，使用傅里叶模 ansatz，推导 $G(\\theta)$ 的表达式，并计算其幅值 $\\lvert G(\\theta)\\rvert$ 和其辐角 $\\arg(G(\\theta))$（在 $(-\\pi,\\pi]$ 内的主值），作为 $\\theta$ 和 $\\nu$ 的闭式解析函数。你的最终答案必须以两个表达式给出：一个用于 $\\lvert G(\\theta)\\rvert$，另一个用于 $\\arg(G(\\theta))$。如果你使用了一个分支敏感的辐角公式，必须明确写出，以确保其值落在 $(-\\pi,\\pi]$ 区间内。请将你的最终答案表示为符号表达式，并且不包含任何单位。",
            "solution": "该问题要求推导应用于一维线性平流方程的 Lax–Friedrichs 格式的放大因子 $G(\\theta)$、其幅值 $|G(\\theta)|$ 及其辐角 $\\arg(G(\\theta))$。\n\n线性平流方程由下式给出：\n$$\nu_{t} + a\\,u_{x} = 0\n$$\n其中 $a > 0$ 是一个常数。\n\nLax–Friedrichs 格式为：\n$$\nu_{j}^{n+1} = \\frac{1}{2}\\left(u_{j+1}^{n} + u_{j-1}^{n}\\right) - \\frac{a\\,\\Delta t}{2\\,\\Delta x}\\left(u_{j+1}^{n} - u_{j-1}^{n}\\right)\n$$\n令 Courant–Friedrichs–Lewy (CFL) 数为 $\\nu = \\frac{a\\,\\Delta t}{\\Delta x}$。该格式可以写成：\n$$\nu_{j}^{n+1} = \\frac{1}{2}\\left(u_{j+1}^{n} + u_{j-1}^{n}\\right) - \\frac{\\nu}{2}\\left(u_{j+1}^{n} - u_{j-1}^{n}\\right)\n$$\n\n我们通过将离散傅里葉模 $u_{j}^{n} = \\hat{u}^{n}\\exp(i j \\theta)$ 代入格式中来进行 von Neumann 稳定性分析。格式中的各项变为：\n- $u_{j}^{n+1} = \\hat{u}^{n+1}\\exp(i j \\theta)$\n- $u_{j+1}^{n} = \\hat{u}^{n}\\exp(i (j+1) \\theta) = \\hat{u}^{n}\\exp(i j \\theta)\\exp(i \\theta)$\n- $u_{j-1}^{n} = \\hat{u}^{n}\\exp(i (j-1) \\theta) = \\hat{u}^{n}\\exp(i j \\theta)\\exp(-i \\theta)$\n\n将这些代入格式方程中：\n$$\n\\hat{u}^{n+1}\\exp(i j \\theta) = \\frac{1}{2}\\left(\\hat{u}^{n}\\exp(i j \\theta)\\exp(i \\theta) + \\hat{u}^{n}\\exp(i j \\theta)\\exp(-i \\theta)\\right) - \\frac{\\nu}{2}\\left(\\hat{u}^{n}\\exp(i j \\theta)\\exp(i \\theta) - \\hat{u}^{n}\\exp(i j \\theta)\\exp(-i \\theta)\\right)\n$$\n公共因子 $\\exp(i j \\theta)$ 可以从每一项中消去：\n$$\n\\hat{u}^{n+1} = \\frac{\\hat{u}^{n}}{2}\\left(\\exp(i \\theta) + \\exp(-i \\theta)\\right) - \\frac{\\nu\\hat{u}^{n}}{2}\\left(\\exp(i \\theta) - \\exp(-i \\theta)\\right)\n$$\n根据定义，放大因子 $G(\\theta)$ 满足 $\\hat{u}^{n+1} = G(\\theta)\\hat{u}^{n}$。两边同除以 $\\hat{u}^{n}$（假设 $\\hat{u}^{n} \\neq 0$）：\n$$\nG(\\theta) = \\frac{1}{2}\\left(\\exp(i \\theta) + \\exp(-i \\theta)\\right) - \\frac{\\nu}{2}\\left(\\exp(i \\theta) - \\exp(-i \\theta)\\right)\n$$\n使用欧拉公式 $\\cos(\\theta) = \\frac{\\exp(i \\theta) + \\exp(-i \\theta)}{2}$ 和 $\\sin(\\theta) = \\frac{\\exp(i \\theta) - \\exp(-i \\theta)}{2i}$，我们可以简化 $G(\\theta)$ 的表达式：\n$$\nG(\\theta) = \\cos(\\theta) - \\frac{\\nu}{2}(2i\\sin(\\theta))\n$$\n$$\nG(\\theta) = \\cos(\\theta) - i\\nu\\sin(\\theta)\n$$\n\n接下来，我们计算幅值 $|G(\\theta)|$。对于一个复数 $z = x+iy$，其幅值为 $|z| = \\sqrt{x^2 + y^2}$。在这里，实部是 $\\mathrm{Re}(G(\\theta)) = \\cos(\\theta)$，虚部是 $\\mathrm{Im}(G(\\theta)) = -\\nu\\sin(\\theta)$。\n$$\n|G(\\theta)| = \\sqrt{(\\cos(\\theta))^2 + (-\\nu\\sin(\\theta))^2} = \\sqrt{\\cos^2(\\theta) + \\nu^2\\sin^2(\\theta)}\n$$\n这个表达式是正确的，但可以使用余弦的二倍角恒等式将其写成更紧凑的形式。使用 $\\cos^2(\\theta) = \\frac{1+\\cos(2\\theta)}{2}$ 和 $\\sin^2(\\theta) = \\frac{1-\\cos(2\\theta)}{2}$：\n$$\n|G(\\theta)|^2 = \\frac{1+\\cos(2\\theta)}{2} + \\nu^2\\left(\\frac{1-\\cos(2\\theta)}{2}\\right) = \\frac{1}{2}(1 + \\cos(2\\theta) + \\nu^2 - \\nu^2\\cos(2\\theta))\n$$\n$$\n|G(\\theta)|^2 = \\frac{1+\\nu^2}{2} + \\frac{1-\\nu^2}{2}\\cos(2\\theta)\n$$\n因此，幅值为：\n$$\n|G(\\theta)| = \\sqrt{\\frac{1+\\nu^2}{2} + \\frac{1-\\nu^2}{2}\\cos(2\\theta)}\n$$\n为使格式稳定，我们要求对所有 $\\theta$ 都有 $|G(\\theta)| \\le 1$。这导出了 CFL 条件 $|\\nu| \\le 1$。\n\n最后，我们计算 $G(\\theta)$ 的辐角（或相位），记作 $\\arg(G(\\theta))$。问题要求的是位于区间 $(-\\pi, \\pi]$ 内的主值。令 $\\phi(\\theta) = \\arg(G(\\theta))$。辐角由实部和虚部的符号决定。\n- 实部：$X = \\cos(\\theta)$\n- 虚部：$Y = -\\nu\\sin(\\theta)$\n辐角由 `atan2` 函数给出，$\\phi(\\theta) = \\mathrm{atan2}(Y, X) = \\mathrm{atan2}(-\\nu\\sin(\\theta), \\cos(\\theta))$。问题要求将其写成一个显式公式。我们为 $\\theta$ 的一个周期（例如 $\\theta \\in (-\\pi, \\pi]$）分段构建此公式。\n1.  如果 $X > 0$，即 $\\cos(\\theta) > 0$，对于 $\\theta \\in (-\\pi, \\pi]$ 这意味着 $\\theta \\in (-\\pi/2, \\pi/2)$。辐角为 $\\phi(\\theta) = \\arctan(Y/X) = \\arctan(-\\nu\\tan(\\theta))$。\n2.  如果 $X  0$，即 $\\cos(\\theta)  0$，对于 $\\theta \\in (-\\pi, \\pi]$ 这意味着 $\\theta \\in (\\pi/2, \\pi] \\cup (-\\pi, -\\pi/2)$。\n    - 如果 $Y \\ge 0$，即 $-\\nu\\sin(\\theta) \\ge 0$，由于 $\\nu > 0$，这意味着 $\\sin(\\theta) \\le 0$。这对应于 $\\theta \\in (-\\pi, -\\pi/2)$ 或 $\\theta=\\pi$。辐角为 $\\phi(\\theta) = \\arctan(Y/X) + \\pi = \\arctan(-\\nu\\tan(\\theta)) + \\pi$。在 $\\theta = \\pi$ 时，$Y=0$ 且 $X=-1$，所以 $\\phi(\\pi) = \\pi$。\n    - 如果 $Y  0$，即 $-\\nu\\sin(\\theta)  0$，这意味着 $\\sin(\\theta) > 0$。这对应于 $\\theta \\in (\\pi/2, \\pi)$。辐角为 $\\phi(\\theta) = \\arctan(Y/X) - \\pi = \\arctan(-\\nu\\tan(\\theta)) - \\pi$。\n3.  如果 $X = 0$，即 $\\cos(\\theta) = 0$，对于 $\\theta \\in (-\\pi, \\pi]$ 这意味着 $\\theta = \\pm \\pi/2$。\n    - 如果 $\\theta = \\pi/2$，则 $Y = -\\nu\\sin(\\pi/2) = -\\nu  0$。辐角为 $\\phi(\\pi/2) = -\\pi/2$。\n    - 如果 $\\theta = -\\pi/2$，则 $Y = -\\nu\\sin(-\\pi/2) = \\nu > 0$。辐角为 $\\phi(-\\pi/2) = \\pi/2$。\n\n综合这些情况，可以得到 $\\theta \\in (-\\pi, \\pi]$ 时 $\\arg(G(\\theta))$ 的显式分段公式：\n$$\n\\arg(G(\\theta)) = \\begin{cases}\n \\arctan(-\\nu\\tan\\theta) + \\pi   \\text{if } \\theta \\in (-\\pi, -\\pi/2) \\\\\n \\pi/2   \\text{if } \\theta = -\\pi/2 \\\\\n \\arctan(-\\nu\\tan\\theta)   \\text{if } \\theta \\in (-\\pi/2, \\pi/2) \\\\\n -\\pi/2   \\text{if } \\theta = \\pi/2 \\\\\n \\arctan(-\\nu\\tan\\theta) - \\pi   \\text{if } \\theta \\in (\\pi/2, \\pi) \\\\\n \\pi   \\text{if } \\theta = \\pi\n\\end{cases}\n$$\n这个函数正确地给出了区间 $(-\\pi, \\pi]$ 内的主辐角。",
            "answer": "$$\n\\boxed{\n\\begin{aligned}\n|G(\\theta)| = \\sqrt{\\cos^2(\\theta) + \\nu^2\\sin^2(\\theta)} \\\\\n\\arg(G(\\theta)) = \\begin{cases}\n \\arctan(-\\nu\\tan\\theta) + \\pi  \\text{当 } \\cos\\theta  0 \\text{ 且 } \\sin\\theta  0 \\\\\n \\pi/2  \\text{当 } \\cos\\theta = 0 \\text{ 且 } \\sin\\theta = -1 \\\\\n \\arctan(-\\nu\\tan\\theta)  \\text{当 } \\cos\\theta > 0 \\\\\n -\\pi/2  \\text{当 } \\cos\\theta = 0 \\text{ 且 } \\sin\\theta = 1 \\\\\n \\arctan(-\\nu\\tan\\theta) - \\pi  \\text{当 } \\cos\\theta  0 \\text{ 且 } \\sin\\theta > 0 \\\\\n \\pi  \\text{当 } \\cos\\theta = -1\n\\end{cases}\n\\end{aligned}\n}\n$$"
        },
        {
            "introduction": "为了连接简单标量模型与真实流体力学问题，本高级练习将探讨从标量平流方程分析中获得的见解如何应用于完整的可压缩欧拉方程。您将探索在何种条件下，特征分解格式（在接触间断处简化为简单的迎风或 Lax-Friedrichs 形式）能够完美地保持接触间断的形态。这项实践揭示了数值格式属性与物理现象之间深刻的联系，是理论走向应用的关键一步。",
            "id": "3375346",
            "problem": "考虑理想气体的一维可压缩欧拉方程，其比热容比为 $\\gamma$，\n$$\n\\partial_t U + \\partial_x F(U) = 0,\\quad U = \\begin{bmatrix} \\rho \\\\ \\rho u \\\\ E \\end{bmatrix},\\quad F(U) = \\begin{bmatrix} \\rho u \\\\ \\rho u^2 + p \\\\ u(E+p) \\end{bmatrix},\\quad p = (\\gamma - 1)\\left(E - \\tfrac{1}{2}\\rho u^2\\right).\n$$\n接触间断的特征是界面两侧的压力和速度恒定，即 $p_L = p_R$ 和 $u_L = u_R$，仅在密度 $\\rho$ 上存在跳跃。对于这种构型，黎曼问题的精确解以速度 $u$ 平流接触间断，其形状保持不变。\n\n你需要从第一性原理出发，推断使用 Lax–Friedrichs 通量的有限体积法的离散行为，并实现一个程序来量化接触间断的保持和耗散情况。Lax–Friedrichs 族通量在界面处可以写成以下形式：\n$$\n\\hat{F}_{\\text{LF}}(U_L,U_R) = \\tfrac{1}{2}\\left(F(U_L)+F(U_R)\\right) - \\tfrac{1}{2} \\alpha \\left(U_R-U_L\\right),\n$$\n其中 $\\alpha$ 是一个选定的非负耗散速度。考虑两种范式：\n- 标量 Lax–Friedrichs（也称为局部 Lax–Friedrichs 或 Rusanov）使用单一的 $\\alpha$，其值等于特征速度的上限（对于欧拉方程，$\\alpha \\ge \\max(|u|+c)$，其中 $c$ 是局部声速）。\n- 特征重构将跳跃转换到特征变量中，并对每个波族施加耗散，然后重构回来；假设采用 Roe 型线性化，则特征速度为 $\\lambda_1 = u - c$，$\\lambda_2 = u$ 和 $\\lambda_3 = u + c$。\n\n任务：\n1. 从欧拉方程出发，利用接触间断的定义性质（$p_L=p_R$, $u_L=u_R$），证明质量方程可简化为密度的标量平流方程，\n$$\n\\partial_t \\rho + u\\, \\partial_x \\rho = 0,\n$$\n并证明在接触间断处，声学特征跳跃在特征重构下会消失。\n2. 使用带有特征重构的 Lax–Friedrichs 形式，推导沿接触特征的离散更新。推导在均匀网格上离散格式能精确保持接触间断的充分必要条件。你的推导必须明确以下几点的作用：\n   - 压力和速度相等，\n   - Courant–Friedrichs–Lewy (CFL) 数 $\\sigma = \\dfrac{u\\, \\Delta t}{\\Delta x}$，\n   - 接触间断与网格单元面的对齐。\n3. 对于应用于常速 $a$ 的标量平流方程 $\\partial_t q + a\\, \\partial_x q = 0$ 的标量 Lax–Friedrichs 格式，分析离散傅里叶模式 $q_i^n = \\exp(\\mathrm{i} k x_i)$，其中 $x_i = i \\Delta x$ 且角度 $k \\Delta x$ 以弧度为单位。推导单步放大因子的模 $\\left|G(k \\Delta x)\\right|$，并通过与一个带有有效扩散系数 $D_{\\text{eff}}$（单位为 $\\mathrm{m}^2/\\mathrm{s}$）的修正方程进行匹配，得到小波数（$k \\Delta x \\ll 1$）下的渐近耗散率。\n4. 编写一个完整的程序，实现以下功能：\n   - 实现表示接触特征的密度标量平流的单步迎风格式更新，并通过将一个时间步后的数值结果与平移一个单元的精确解进行比较，来检查其精确保持性。返回一个布尔值，指示在机器精度内是否精确保持。\n   - 实现计算给定波数和参数下标量 Lax–Friedrichs 格式的放大因子模的函数，以及计算迎风情况（即 $\\alpha = |a|$ 的标量 Lax–Friedrichs 格式）下小波数有效扩散系数 $D_{\\text{eff}}$ 的函数。\n所有物理单位必须遵守：速度单位为 $\\mathrm{m}/\\mathrm{s}$，长度单位为 $\\mathrm{m}$，时间单位为 $\\mathrm{s}$，扩散系数单位为 $\\mathrm{m}^2/\\mathrm{s}$。角度单位必须是弧度。\n\n测试套件：\n使用以下测试用例来检验你的程序。对于每个用例，计算指定的结果类型。\n\n- 用例 A (接触间断保持性检查，布尔值)：$\\gamma = 1.4$, $u = 1\\,\\mathrm{m}/\\mathrm{s}$, $p_L = p_R = 10^5\\,\\mathrm{Pa}$, $\\rho_L = 1.0\\,\\mathrm{kg}/\\mathrm{m}^3$, $\\rho_R = 0.125\\,\\mathrm{kg}/\\mathrm{m}^3$，周期性域长度 $L = 1\\,\\mathrm{m}$，有 $N=100$ 个单元，因此 $\\Delta x = 0.01\\,\\mathrm{m}$，选择 $\\Delta t$ 使得 $\\sigma = \\dfrac{u \\Delta t}{\\Delta x} = 1$ (即 $\\Delta t = 0.01\\,\\mathrm{s}$)。将接触间断放置在与单元面重合的位置。返回一个布尔值，指示一步之后是否精确保持。\n- 用例 B (标量 Lax–Friedrichs 格式的放大因子模，浮点数)：$a = 1\\,\\mathrm{m}/\\mathrm{s}$, $\\alpha = a$, $\\Delta x = 0.01\\,\\mathrm{m}$，选择 $\\sigma = \\dfrac{a \\Delta t}{\\Delta x} = 0.5$，波数角 $k \\Delta x = \\dfrac{\\pi}{2}\\,\\mathrm{rad}$。以浮点数形式返回 $\\left|G\\right|$。\n- 用例 C (迎风格式的有效扩散 $D_{\\text{eff}}$，浮点数)：与用例 B 相同，使用小波数渐近法返回 $D_{\\text{eff}}$，单位为 $\\mathrm{m}^2/\\mathrm{s}$。\n- 用例 D (过耗散情况下的放大因子模，浮点数)：$a = 1\\,\\mathrm{m}/\\mathrm{s}$, $\\alpha = 2a$, $\\Delta x = 0.01\\,\\mathrm{m}$, $\\sigma = 0.5$，波数角 $k \\Delta x = \\dfrac{\\pi}{2}\\,\\mathrm{rad}$。以浮点数形式返回 $\\left|G\\right|$。\n- 用例 E ($\\sigma=1$ 时的放大因子模，浮点数)：$a = 1\\,\\mathrm{m}/\\mathrm{s}$, $\\alpha = a$, $\\Delta x = 0.01\\,\\mathrm{m}$, $\\sigma = 1$，波数角 $k \\Delta x = \\dfrac{\\pi}{3}\\,\\mathrm{rad}$。以浮点数形式返回 $\\left|G\\right|$。\n\n最终输出格式：你的程序应生成一行输出，其中包含用例 A–E 的结果，以逗号分隔的列表形式包含在方括号中，顺序为 [A,B,C,D,E]。例如，“[True,0.12,0.0034,0.09,1.0]”。",
            "solution": "经评估，该问题有效。它在科学上基于计算流体动力学原理和双曲守恒律理论。问题陈述清晰，为获得唯一解提供了所有必要的数据和定义。语言客观而精确。我现在将进行详细解答。\n\n### 第1部分：接触间断处的欧拉方程分析\n\n我们从理想气体的一维可压缩欧拉方程开始：\n$$\n\\partial_t U + \\partial_x F(U) = 0\n$$\n其中守恒变量向量 $U$ 和通量向量 $F(U)$ 由下式给出：\n$$\nU = \\begin{bmatrix} \\rho \\\\ \\rho u \\\\ E \\end{bmatrix}, \\quad F(U) = \\begin{bmatrix} \\rho u \\\\ \\rho u^2 + p \\\\ u(E+p) \\end{bmatrix}\n$$\n压力 $p$ 通过理想气体的状态方程与守恒变量相关联：\n$$\np = (\\gamma - 1)\\left(E - \\tfrac{1}{2}\\rho u^2\\right)\n$$\n接触间断由条件 $u_L = u_R = u$ 和 $p_L = p_R = p$ 定义，密度存在跳跃 $\\rho_L \\neq \\rho_R$。在此类波的附近，我们可以将速度 $u$ 和压力 $p$ 视为常数。\n\n欧拉方程组的第一个分量是质量守恒方程：\n$$\n\\partial_t \\rho + \\partial_x (\\rho u) = 0\n$$\n对通量项应用乘法法则求导，我们得到：\n$$\n\\partial_t \\rho + u\\,\\partial_x \\rho + \\rho\\,\\partial_x u = 0\n$$\n在接触间断的条件下，速度 $u$ 在界面两侧是恒定的，这意味着其空间导数为零，即 $\\partial_x u = 0$。因此，质量方程简化为密度的标量线性平流方程：\n$$\n\\partial_t \\rho + u\\,\\partial_x \\rho = 0\n$$\n这表明密度剖面仅以恒定速度 $u$ 进行平流。\n\n接下来，我们分析特征结构。跨越接触间断的状态向量跳跃 $\\Delta U = U_R - U_L$ 可以用给定条件表示。设 $\\Delta \\rho = \\rho_R - \\rho_L$。\n跳跃向量为：\n$$\n\\Delta U = \\begin{bmatrix} \\rho_R - \\rho_L \\\\ \\rho_R u - \\rho_L u \\\\ E_R - E_L \\end{bmatrix} = \\begin{bmatrix} \\Delta\\rho \\\\ u\\Delta\\rho \\\\ E_R - E_L \\end{bmatrix}\n$$\n根据压力条件 $p_L = p_R = p$，我们有：\n$$\n(\\gamma - 1)\\left(E_L - \\tfrac{1}{2}\\rho_L u^2\\right) = (\\gamma - 1)\\left(E_R - \\tfrac{1}{2}\\rho_R u^2\\right)\n$$\n这可以简化为 $E_R - E_L = \\frac{1}{2}(\\rho_R - \\rho_L)u^2 = \\frac{1}{2}(\\Delta\\rho)u^2$。\n将此代入跳跃向量，得到：\n$$\n\\Delta U = \\begin{bmatrix} \\Delta\\rho \\\\ u\\Delta\\rho \\\\ \\frac{1}{2}u^2\\Delta\\rho \\end{bmatrix} = \\Delta\\rho \\begin{bmatrix} 1 \\\\ u \\\\ \\frac{1}{2}u^2 \\end{bmatrix}\n$$\n欧拉系统雅可比矩阵的右特征向量，对应于 Roe 型线性化，与特征值 $\\lambda_1 = u-c$、$\\lambda_2 = u$ 和 $\\lambda_3 = u+c$ 相关联。接触波（特征值 $\\lambda_2 = u$）的特征向量是：\n$$\n\\vec{r}_2 = \\begin{bmatrix} 1 \\\\ u \\\\ \\frac{1}{2}u^2 \\end{bmatrix}\n$$\n（注意：某些定义对此向量进行了缩放，但方向才是关键）。\n通过观察可知，跳跃向量 $\\Delta U$ 正是特征向量 $\\vec{r}_2$ 的倍数：$\\Delta U = (\\Delta\\rho)\\vec{r}_2$。任何跳跃向量都可以分解为系统特征向量的线性组合：$\\Delta U = \\sum_{k=1}^3 \\alpha_k \\vec{r}_k$。系数 $\\alpha_k$ 代表每个特征场中的跳跃强度。由于接触间断处的跳跃完全与 $\\vec{r}_2$ 对齐，因此两个声波（与 $\\vec{r}_1$ 和 $\\vec{r}_3$ 相关）的系数必须为零：$\\alpha_1 = 0$ 和 $\\alpha_3 = 0$。因此，在接触间断处，声学特征跳跃消失。\n\n### 第2部分：接触间断的离散保持\n\n单元 $i$ 的有限体积更新由 $U_i^{n+1} = U_i^n - \\frac{\\Delta t}{\\Delta x}(\\hat{F}_{i+1/2} - \\hat{F}_{i-1/2})$ 给出。特征 Lax–Friedrichs 格式使用的数值通量会为每个波族增加特定的耗散。该通量可以写成：\n$$\n\\hat{F}(U_L, U_R) = \\tfrac{1}{2}\\left(F(U_L)+F(U_R)\\right) - \\tfrac{1}{2} \\sum_{k=1}^3 |\\tilde{\\lambda}_k| \\tilde{\\alpha}_k \\tilde{\\vec{r}}_k\n$$\n其中 $\\tilde{\\lambda}_k$ 是 Roe 平均特征值，$\\tilde{\\alpha}_k \\tilde{\\vec{r}}_k$ 是跳跃 $U_R-U_L$ 在特征向量上的分解。如第1部分所示，对于接触间断，只有对应于 $\\lambda_2=u$ 的特征场是活跃的。因此，求和可以简化为 $k=2$ 的单项：\n$$\n\\hat{F}(U_L, U_R) = \\tfrac{1}{2}\\left(F(U_L)+F(U_R)\\right) - \\tfrac{1}{2} |u| (U_R-U_L)\n$$\n这里我们利用了跳跃 $U_R-U_L$ 与特征向量 $\\vec{r}_2$ 成比例的事实。我们来分析这个通量。假设 $u>0$，则 $|u|=u$。通量差为 $F_R-F_L = u(U_R-U_L)$，所以 $F_R = F_L + u(U_R-U_L)$。将此代入数值通量：\n$$\n\\hat{F}(U_L, U_R) = \\tfrac{1}{2}\\left(F_L + F_L + u(U_R-U_L)\\right) - \\tfrac{1}{2}u(U_R-U_L) = F(U_L)\n$$\n这是一阶迎风通量。整个系统的更新格式变为 $U_i^{n+1} = U_i^n - \\frac{\\Delta t}{\\Delta x}(F(U_i^n) - F(U_{i-1}^n))$。\n\n为了精确保持，离散解必须与精确解匹配，即初始剖面的简单平移。设接触间断与单元面（索引为 $j-1/2$）对齐，使得当 $k  j$ 时 $U_k^n = U_L$，当 $k \\ge j$ 时 $U_k^n = U_R$。\n考虑单元 $j$（第一个状态为 $U_R$ 的单元）的更新：\n$$\nU_j^{n+1} = U_j^n - \\frac{\\Delta t}{\\Delta x}(F(U_j^n) - F(U_{j-1}^n)) = U_R - \\frac{\\Delta t}{\\Delta x}(F_R - F_L)\n$$\n使用 $F_R - F_L = u(U_R - U_L)$，上式变为：\n$$\nU_j^{n+1} = U_R - \\frac{u\\Delta t}{\\Delta x}(U_R - U_L) = U_R - \\sigma(U_R - U_L)\n$$\n其中 $\\sigma = u\\Delta t / \\Delta x$ 是 Courant 数。\n时间 $\\Delta t$ 后的精确解要求间断移动距离 $u\\Delta t$。为了在网格上实现精确保持，这个距离必须是单元宽度 $\\Delta x$ 的整数倍。最简单的非平凡情况是 $u\\Delta t = \\Delta x$，这意味着 Courant 数 $\\sigma=1$。\n如果我们设置 $\\sigma=1$，单元 $j$ 的更新为：\n$$\nU_j^{n+1} = U_R - 1 \\cdot (U_R - U_L) = U_L\n$$\n对于任何单元 $k  j$，有 $U_k^n=U_{k-1}^n=U_L$，因此 $F(U_k^n)-F(U_{k-1}^n)=0$ 且 $U_k^{n+1}=U_L$。\n对于任何单元 $k > j$，有 $U_k^n=U_{k-1}^n=U_R$，因此 $F(U_k^n)-F(U_{k-1}^n)=0$ 且 $U_k^{n+1}=U_R$。\n结果是单元 $j$ 的状态从 $U_R$ 变为 $U_L$，而所有其他单元的状态保持不变。这对应于间断在网格上完美平移一个单元。\n充分必要条件是：\n1.  压力和速度相等 ($p_L=p_R, u_L=u_R$): 这将跳跃隔离到接触特征场，从而将系统动力学简化为标量平流。\n2.  接触间断与单元面对齐: 这确保了初始条件在网格上是一个完美的阶跃函数。\n3.  Courant 数 $\\sigma = 1$: 这使得物理波速与网格同步，确保波前在每个时间步长内精确移动一个单元，与迎风格式的模板相匹配。\n\n### 第3部分：标量 Lax–Friedrichs 格式的傅里叶分析\n\n考虑标量平流方程 $\\partial_t q + a\\, \\partial_x q = 0$。标量 Lax-Friedrichs 有限体积格式可以通过向中心差分格式添加一个耗散项来写出：\n$$\nq_i^{n+1} = q_i^n - a \\frac{\\Delta t}{2\\Delta x}(q_{i+1}^n - q_{i-1}^n) + \\alpha \\frac{\\Delta t}{2\\Delta x}(q_{i+1}^n - 2q_i^n + q_{i-1}^n)\n$$\n我们代入一个傅里叶模式 $q_i^n = G^n e^{\\mathrm{i}k x_i}$，其中 $G$ 是放大因子，$x_i=i\\Delta x$。令 $\\theta = k\\Delta x$。\n$$\nG e^{\\mathrm{i}k x_i} = e^{\\mathrm{i}k x_i} - \\frac{a\\Delta t}{2\\Delta x}(e^{\\mathrm{i}k(x_i+\\Delta x)} - e^{\\mathrm{i}k(x_i-\\Delta x)}) + \\frac{\\alpha\\Delta t}{2\\Delta x}(e^{\\mathrm{i}k(x_i+\\Delta x)} - 2e^{\\mathrm{i}k x_i} + e^{\\mathrm{i}k(x_i-\\Delta x)})\n$$\n除以 $e^{\\mathrm{i}k x_i}$ 并使用定义 $\\sigma = a\\Delta t/\\Delta x$ 和 $\\nu = \\alpha\\Delta t/\\Delta x$：\n$$\nG = 1 - \\frac{\\sigma}{2}(e^{\\mathrm{i}\\theta} - e^{-\\mathrm{i}\\theta}) + \\frac{\\nu}{2}(e^{\\mathrm{i}\\theta} - 2 + e^{-\\mathrm{i}\\theta})\n$$\n使用欧拉恒等式 $e^{\\mathrm{i}\\theta} - e^{-\\mathrm{i}\\theta} = 2\\mathrm{i}\\sin\\theta$ 和 $e^{\\mathrm{i}\\theta} + e^{-\\mathrm{i}\\theta} - 2 = 2\\cos\\theta - 2 = -4\\sin^2(\\theta/2)$：\n$$\nG(\\theta) = 1 - \\sigma (\\mathrm{i}\\sin\\theta) - 2\\nu \\sin^2(\\theta/2) = \\left(1 - 2\\nu \\sin^2(\\frac{\\theta}{2})\\right) - \\mathrm{i} (\\sigma\\sin\\theta)\n$$\n放大因子的模为 $|G(\\theta)| = \\sqrt{\\text{Re}(G)^2 + \\text{Im}(G)^2}$：\n$$\n|G(\\theta)| = \\sqrt{\\left(1 - 2\\nu \\sin^2(\\frac{\\theta}{2})\\right)^2 + (\\sigma\\sin\\theta)^2}\n$$\n为了找到有效扩散系数，我们对格式进行泰勒级数展开以推导其修正方程。\n$$\n\\frac{q_i^{n+1}-q_i^n}{\\Delta t} = -a\\frac{q_{i+1}-q_{i-1}}{2\\Delta x} + \\frac{\\alpha\\Delta x}{2}\\frac{q_{i+1}-2q_i+q_{i-1}}{\\Delta x^2}\n$$\n在时间和空间上展开：\n$q_t + \\frac{\\Delta t}{2}q_{tt} + \\mathcal{O}(\\Delta t^2) = -a(q_x + \\frac{\\Delta x^2}{6}q_{xxx} + \\dots) + \\frac{\\alpha\\Delta x}{2}(q_{xx} + \\frac{\\Delta x^2}{12}q_{xxxx} + \\dots)$\n在主阶上，格式近似于 $q_t = -aq_x$。这使我们能够替换时间导数 $q_{tt} \\approx \\partial_t(-aq_x) = -a(q_t)_x \\approx -a(-aq_x)_x = a^2 q_{xx}$。将其代回：\n$$\nq_t + \\frac{a^2\\Delta t}{2}q_{xx} + \\dots = -aq_x + \\frac{\\alpha\\Delta x}{2}q_{xx} + \\dots\n$$\n重新排列以匹配平流-扩散形式 $\\partial_t q + a\\partial_x q = D_{\\text{eff}} \\partial_{xx} q$：\n$$\n\\partial_t q + a\\partial_x q = \\left(\\frac{\\alpha\\Delta x}{2} - \\frac{a^2\\Delta t}{2}\\right) \\partial_{xx} q + \\dots\n$$\n有效扩散系数是二阶导数项的系数：\n$$\nD_{\\text{eff}} = \\frac{\\alpha\\Delta x}{2} - \\frac{a^2\\Delta t}{2} = \\frac{\\Delta x}{2}(\\alpha - a \\frac{a\\Delta t}{\\Delta x}) = \\frac{\\Delta x}{2}(\\alpha - a\\sigma)\n$$\n对于迎风情况（假设 $a>0$），我们设置耗散速度 $\\alpha=|a|=a$。有效扩散变为：\n$$\nD_{\\text{eff}} = \\frac{a\\Delta x}{2}(1 - \\sigma)\n$$\n该系数在低波数下量化了格式引入的数值耗散（扩散）。\n\n### 第4部分：程序实现\n\n以下程序实现了解决测试用例所需的函数。\n- `check_contact_preservation` 实现了密度标量平流的一阶迎风格式，并验证了 $\\sigma=1$ 时的精确平移特性。\n- `amp_factor_mag` 计算标量 Lax-Friedrichs 格式的放大因子模 $|G|$。\n- `eff_diffusion_upwind` 计算迎风格式的有效扩散系数 $D_{\\text{eff}}$。\n然后，该程序执行指定的测试用例，并以要求的格式打印结果。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef check_contact_preservation(N, L, rho_L, rho_R, u, sigma):\n    \"\"\"\n    Checks for exact preservation of a contact discontinuity by the \n    first-order upwind scheme for one time step with sigma=1.\n\n    The problem states this check is for the scalar advection of density, \n    with a one-step upwind update. The characteristic-wise scheme for Euler's\n    equations reduces to this for the density component at a contact.\n    \"\"\"\n    dx = L / N\n    dt = sigma * dx / u\n    \n    # Initial condition: contact aligned at the center face\n    # rho_L for i  N/2, rho_R for i >= N/2\n    rho_initial = np.full(N, rho_R)\n    split_index = N // 2\n    rho_initial[:split_index] = rho_L\n    \n    # Exact solution after one time step (for sigma=1, it's a shift by one cell)\n    # np.roll performs a circular shift, which correctly models periodic boundaries.\n    rho_exact = np.roll(rho_initial, 1)\n\n    # Numerical solution after one time step using first-order upwind scheme\n    # rho_new[i] = rho_old[i] - sigma * (rho_old[i] - rho_old[i-1])\n    # For sigma=1, this simplifies to rho_new[i] = rho_old[i-1].\n    \n    rho_numerical = np.zeros_like(rho_initial)\n    for i in range(N):\n        # Periodic boundary for i-1\n        idx_prev = (i - 1 + N) % N\n        rho_numerical[i] = rho_initial[i] - sigma * (rho_initial[i] - rho_initial[idx_prev])\n        \n    # Check if numerical result is identical to exact result within machine precision\n    return np.allclose(rho_numerical, rho_exact)\n\ndef amp_factor_mag(a, alpha, dx, sigma, k_dx):\n    \"\"\"\n    Computes the magnitude of the amplification factor for the scalar Lax-Friedrichs scheme.\n    \"\"\"\n    # sigma = a * dt / dx\n    # nu = alpha * dt / dx\n    dt = sigma * dx / a if a != 0 else 0\n    nu = alpha * dt / dx if dx != 0 else 0\n    theta = k_dx\n\n    # G = (1 - 2*nu*sin^2(theta/2)) - i*(sigma*sin(theta))\n    real_part = 1 - 2 * nu * np.sin(theta / 2)**2\n    imag_part = -sigma * np.sin(theta)\n    \n    magnitude = np.sqrt(real_part**2 + imag_part**2)\n    return magnitude\n\ndef eff_diffusion_upwind(a, dx, sigma):\n    \"\"\"\n    Computes the effective diffusion coefficient for the upwind scheme.\n    This corresponds to scalar Lax-Friedrichs with alpha = |a|.\n    \"\"\"\n    # Formula derived from modified equation analysis: D_eff = |a|*dx/2 * (1-|sigma|)\n    return abs(a) * dx / 2.0 * (1.0 - abs(sigma))\n\ndef solve():\n    \"\"\"\n    Executes all test cases and prints the results.\n    \"\"\"\n    results = []\n    \n    # Case A: Contact preservation check\n    case_A_result = check_contact_preservation(\n        N=100, L=1.0, \n        rho_L=1.0, rho_R=0.125, \n        u=1.0, sigma=1.0\n    )\n    results.append(case_A_result)\n\n    # Case B: Amplification magnitude for upwind scheme\n    case_B_result = amp_factor_mag(\n        a=1.0, alpha=1.0, dx=0.01, \n        sigma=0.5, k_dx=np.pi/2\n    )\n    results.append(case_B_result)\n\n    # Case C: Effective diffusion for upwind scheme\n    case_C_result = eff_diffusion_upwind(\n        a=1.0, dx=0.01, sigma=0.5\n    )\n    results.append(case_C_result)\n\n    # Case D: Amplification magnitude with over-dissipation\n    case_D_result = amp_factor_mag(\n        a=1.0, alpha=2.0, dx=0.01,\n        sigma=0.5, k_dx=np.pi/2\n    )\n    results.append(case_D_result)\n    \n    # Case E: Amplification magnitude at sigma=1 (upwind)\n    case_E_result = amp_factor_mag(\n        a=1.0, alpha=1.0, dx=0.01,\n        sigma=1.0, k_dx=np.pi/3\n    )\n    results.append(case_E_result)\n\n    # Format the final output string\n    # E.g., \"[True,0.7071067811865476,0.0025,0.5,1.0]\"\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}