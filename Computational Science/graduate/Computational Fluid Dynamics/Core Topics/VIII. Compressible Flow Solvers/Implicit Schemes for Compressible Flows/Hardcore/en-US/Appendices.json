{
    "hands_on_practices": [
        {
            "introduction": "To master implicit methods, we begin with the fundamental building blocks. Compressible flows are characterized by phenomena occurring on vastly different time scales, such as slow-moving convective features and fast-moving acoustic waves. This exercise  introduces the concept of operator splitting, where we treat these components differently using Implicit-Explicit (IMEX) schemes. By deriving and comparing the amplification factors for IMEX, fully implicit, and fully explicit methods on a representative model, you will gain a foundational understanding of the mathematical structure and stability properties that underpin these powerful techniques.",
            "id": "3333921",
            "problem": "Consider the one-dimensional compressible Euler equations, linearized about a uniform base state with constant density $\\rho_{0}$, velocity $u_{0}$, and pressure $p_{0}$ for an ideal gas with ratio of specific heats $\\gamma$. In the linear regime, small perturbations decompose into characteristic waves with speeds $u_{0}-a_{0}$, $u_{0}$, and $u_{0}+a_{0}$, where $a_{0}=\\sqrt{\\gamma p_{0}/\\rho_{0}}$ is the sound speed. On a periodic domain, represent perturbations as a single Fourier mode with wavenumber $k$, so that spatial derivatives acting on this mode reduce to multiplication by $\\mathrm{i}k$. For time integration analysis, model the evolution of a single characteristic variable $q(t)$ associated with this Fourier mode under an additive operator splitting into a nonstiff convective part and a stiff acoustic part. Let the corresponding semi-discrete operator eigenvalues be $\\lambda_{c}=-\\mathrm{i}k\\,u_{0}$ for the convective contribution and $\\lambda_{a}=-\\mathrm{i}k\\,a_{0}$ for the acoustic contribution, so that the combined linear operator acting on the Fourier mode is represented by the scalar test equation\n$$\n\\frac{\\mathrm{d}q}{\\mathrm{d}t}=\\left(\\lambda_{c}+\\lambda_{a}\\right)q.\n$$\nUsing first-order Implicit-Explicit (IMEX) time integration, in which the convective contribution is treated explicitly and the acoustic contribution is treated implicitly, carry out a single time step of size $\\Delta t$ to derive the one-step amplification factor for $q$. Then, for the same semi-discrete model, derive the one-step amplification factors for the fully explicit forward Euler scheme and the fully implicit backward Euler scheme. Express all amplification factors purely in terms of $\\Delta t$, $\\lambda_{c}$, and $\\lambda_{a}$. Provide your final answer as a single row matrix containing the three amplification factors, in the order: IMEX, fully implicit, fully explicit. No numerical substitution or rounding is required; give the exact analytical expressions.",
            "solution": "The starting point is the one-dimensional compressible Euler equations, which express conservation of mass, momentum, and energy. Linearizing these equations about a uniform state $(\\rho_{0},u_{0},p_{0})$ for an ideal gas with ratio of specific heats $\\gamma$ yields a constant-coefficient system for small perturbations. The linearized system can be diagonalized in terms of characteristic variables, yielding three wave families propagating at speeds $u_{0}-a_{0}$, $u_{0}$, and $u_{0}+a_{0}$, where $a_{0}=\\sqrt{\\gamma p_{0}/\\rho_{0}}$ is the sound speed. For a single Fourier mode with wavenumber $k$, the spatial derivative operator acting on perturbations reduces to multiplication by $\\mathrm{i}k$. Consequently, the semi-discrete evolution for each characteristic variable is governed by an ordinary differential equation with a linear operator whose eigenvalues are $-\\mathrm{i}k$ times the corresponding wave speeds.\n\nTo analyze time integration, we adopt a scalar test equation that captures an additive splitting of the operator into a nonstiff convective part and a stiff acoustic part. Denote the convective eigenvalue by $\\lambda_{c}=-\\mathrm{i}k\\,u_{0}$ and the acoustic eigenvalue by $\\lambda_{a}=-\\mathrm{i}k\\,a_{0}$. The combined semi-discrete dynamics for a single characteristic variable $q(t)$ are modeled by\n$$\n\\frac{\\mathrm{d}q}{\\mathrm{d}t}=\\left(\\lambda_{c}+\\lambda_{a}\\right)q.\n$$\nThis scalar linear test equation provides the standard framework for deriving and comparing amplification factors of time integration schemes, particularly for Implicit-Explicit (IMEX) methods where different components are treated by different time discretizations.\n\nWe now derive the amplification factors for three schemes: first-order IMEX Euler (explicit for the convective part and implicit for the acoustic part), fully explicit forward Euler, and fully implicit backward Euler.\n\n$1.$ First-order IMEX Euler scheme. The IMEX Euler update treats the convective contribution explicitly and the acoustic contribution implicitly. Applied to the additive scalar test equation, the update from time level $n$ to $n+1$ with step size $\\Delta t$ is\n$$\nq^{n+1}=q^{n}+\\Delta t\\,\\lambda_{c}\\,q^{n}+\\Delta t\\,\\lambda_{a}\\,q^{n+1}.\n$$\nRearranging to solve for $q^{n+1}$ in terms of $q^{n}$ gives\n$$\n\\left(1-\\Delta t\\,\\lambda_{a}\\right)q^{n+1}=\\left(1+\\Delta t\\,\\lambda_{c}\\right)q^{n},\n$$\nand thus the one-step amplification factor $G_{\\mathrm{IMEX}}$ is\n$$\nG_{\\mathrm{IMEX}}=\\frac{q^{n+1}}{q^{n}}=\\frac{1+\\Delta t\\,\\lambda_{c}}{1-\\Delta t\\,\\lambda_{a}}.\n$$\n\n$2.$ Fully explicit forward Euler scheme. The forward Euler update for the combined operator is\n$$\nq^{n+1}=q^{n}+\\Delta t\\left(\\lambda_{c}+\\lambda_{a}\\right)q^{n},\n$$\nso the one-step amplification factor $G_{\\mathrm{FE}}$ is\n$$\nG_{\\mathrm{FE}}=\\frac{q^{n+1}}{q^{n}}=1+\\Delta t\\left(\\lambda_{c}+\\lambda_{a}\\right).\n$$\n\n$3.$ Fully implicit backward Euler scheme. The backward Euler update for the combined operator is\n$$\nq^{n+1}=q^{n}+\\Delta t\\left(\\lambda_{c}+\\lambda_{a}\\right)q^{n+1},\n$$\nwhich rearranges to\n$$\n\\left(1-\\Delta t\\left(\\lambda_{c}+\\lambda_{a}\\right)\\right)q^{n+1}=q^{n}.\n$$\nTherefore, the one-step amplification factor $G_{\\mathrm{BE}}$ is\n$$\nG_{\\mathrm{BE}}=\\frac{q^{n+1}}{q^{n}}=\\frac{1}{1-\\Delta t\\left(\\lambda_{c}+\\lambda_{a}\\right)}.\n$$\n\nCollecting these results, the amplification factors expressed purely in terms of $\\Delta t$, $\\lambda_{c}$, and $\\lambda_{a}$ are\n$$\nG_{\\mathrm{IMEX}}=\\frac{1+\\Delta t\\,\\lambda_{c}}{1-\\Delta t\\,\\lambda_{a}},\\qquad\nG_{\\mathrm{BE}}=\\frac{1}{1-\\Delta t\\left(\\lambda_{c}+\\lambda_{a}\\right)},\\qquad\nG_{\\mathrm{FE}}=1+\\Delta t\\left(\\lambda_{c}+\\lambda_{a}\\right).\n$$\nThese exact analytical expressions provide the requested comparison of single-step amplification for the three schemes under the specified operator splitting for the linearized one-dimensional Euler system.",
            "answer": "$$\\boxed{\\begin{pmatrix}\\frac{1+\\Delta t\\,\\lambda_{c}}{1-\\Delta t\\,\\lambda_{a}} & \\frac{1}{1-\\Delta t\\left(\\lambda_{c}+\\lambda_{a}\\right)} & 1+\\Delta t\\left(\\lambda_{c}+\\lambda_{a}\\right)\\end{pmatrix}}$$"
        },
        {
            "introduction": "Moving from symbolic analysis to quantitative application, this practice explores how implicit schemes handle physical dissipation. The viscous terms in the Navier-Stokes equations introduce diffusion, a classic source of stiffness that often dictates the stable time step for explicit methods. This exercise  challenges you to apply two workhorse implicit methods, Crank-Nicolson and Backward Euler, to a model diffusion problem. By calculating a time step based on a specific damping requirement and comparing the numerical properties of the two schemes, you will develop a practical intuition for how different implicit discretizations control numerical error and stability.",
            "id": "3333932",
            "problem": "Consider a one-dimensional, periodic, viscous-dominated compressible flow governed by the compressible Navierâ€“Stokes momentum equation linearized about a uniform base state. In the viscous-dominated limit (neglecting convection and pressure gradients for the perturbation dynamics), a single Fourier mode of the velocity perturbation $u'(x,t)$ with wavenumber $k$ evolves as a purely diffusive mode. Let the domain length be $L = 0.1$ m, the base density be $\\rho_{0} = 1.2$ kg/m$^{3}$, and the dynamic viscosity be $\\mu = 1.8 \\times 10^{-5}$ Pa$\\cdot$s. Consider the Fourier mode $u'(x,t) = \\hat{u}(t)\\exp(i k x)$ with integer mode index $m = 20$ so that $k = m \\, 2\\pi/L$. Denote the kinematic viscosity by $\\nu = \\mu/\\rho_{0}$.\n\nStarting from the linearized momentum equation in the viscous-dominated limit and the Fourier-mode representation above, derive the scalar ordinary differential equation for the mode amplitude $\\hat{u}(t)$ in terms of its decay rate $\\lambda$ and show that the dynamics can be written in the form $\\frac{d\\hat{u}}{dt} = -\\lambda \\hat{u}$ with $\\lambda = \\nu k^{2}$. Then, discretize this scalar decay law in time using the Crank-Nicolson (CN) method and derive the one-step amplification factor in terms of $\\lambda$ and the time step $\\Delta t$. Impose the requirement that the magnitude of the CN amplification factor over one time step be $g_{\\mathrm{CN}} = 0.3$, and compute the corresponding $\\Delta t$.\n\nFor the same $\\Delta t$, discretize the scalar decay law using the Backward Euler (BE) method and compute its one-step amplification factor. Briefly discuss which method introduces more numerical damping for the chosen parameters by comparing the magnitudes of the amplification factors.\n\nExpress the computed time step $\\Delta t$ in seconds. Provide your final answer as a two-entry row vector containing $(\\Delta t, \\text{BE amplification factor})$, with no units included in the vector. Round your final numeric values to four significant figures.",
            "solution": "The one-dimensional, linearized momentum equation in the viscous-dominated limit, where convection and pressure gradient terms are neglected for the perturbation $u'$, is given by:\n$$ \\rho_{0} \\frac{\\partial u'}{\\partial t} = \\mu \\frac{\\partial^2 u'}{\\partial x^2} $$\nWe substitute the Fourier mode representation $u'(x,t) = \\hat{u}(t)\\exp(ikx)$ into this equation. The required derivatives are:\n$$ \\frac{\\partial u'}{\\partial t} = \\frac{d\\hat{u}}{dt} \\exp(ikx) $$\n$$ \\frac{\\partial^2 u'}{\\partial x^2} = (ik)^2 \\hat{u}(t) \\exp(ikx) = -k^2 \\hat{u}(t) \\exp(ikx) $$\nSubstituting these into the governing equation yields:\n$$ \\rho_{0} \\left( \\frac{d\\hat{u}}{dt} \\exp(ikx) \\right) = \\mu \\left( -k^2 \\hat{u}(t) \\exp(ikx) \\right) $$\nDividing by the non-zero term $\\exp(ikx)$ and by the base density $\\rho_{0}$, we obtain the ordinary differential equation (ODE) for the mode amplitude $\\hat{u}(t)$:\n$$ \\frac{d\\hat{u}}{dt} = -\\frac{\\mu}{\\rho_{0}} k^2 \\hat{u}(t) $$\nUsing the definition of kinematic viscosity, $\\nu = \\mu/\\rho_{0}$, the equation becomes:\n$$ \\frac{d\\hat{u}}{dt} = -\\nu k^2 \\hat{u}(t) $$\nThis is of the form $\\frac{d\\hat{u}}{dt} = -\\lambda \\hat{u}$, where the decay rate $\\lambda$ is $\\lambda = \\nu k^2$.\n\nNext, we compute the numerical value of $\\lambda$.\nThe kinematic viscosity is:\n$$ \\nu = \\frac{\\mu}{\\rho_{0}} = \\frac{1.8 \\times 10^{-5} \\, \\text{Pa}\\cdot\\text{s}}{1.2 \\, \\text{kg/m}^3} = 1.5 \\times 10^{-5} \\, \\text{m}^2/\\text{s} $$\nThe wavenumber $k$ for mode index $m=20$ is:\n$$ k = m \\frac{2\\pi}{L} = 20 \\frac{2\\pi}{0.1 \\, \\text{m}} = 400\\pi \\, \\text{m}^{-1} $$\nThe decay rate $\\lambda$ is therefore:\n$$ \\lambda = \\nu k^2 = (1.5 \\times 10^{-5} \\, \\text{m}^2/\\text{s}) (400\\pi \\, \\text{m}^{-1})^2 = (1.5 \\times 10^{-5}) (160000 \\pi^2) \\, \\text{s}^{-1} = 2.4\\pi^2 \\, \\text{s}^{-1} $$\n\nNow, we discretize the ODE $\\frac{d\\hat{u}}{dt} = -\\lambda\\hat{u}$ using the Crank-Nicolson (CN) method. Let $\\hat{u}^n$ be the amplitude at time $t_n$ and $\\hat{u}^{n+1}$ be the amplitude at time $t_{n+1} = t_n + \\Delta t$.\n$$ \\frac{\\hat{u}^{n+1} - \\hat{u}^n}{\\Delta t} = -\\lambda \\frac{\\hat{u}^{n+1} + \\hat{u}^n}{2} $$\nThe one-step amplification factor is $g_{\\mathrm{CN}} = \\hat{u}^{n+1}/\\hat{u}^n$. Rearranging the equation to solve for this ratio:\n$$ \\hat{u}^{n+1} \\left(1 + \\frac{\\lambda \\Delta t}{2}\\right) = \\hat{u}^n \\left(1 - \\frac{\\lambda \\Delta t}{2}\\right) $$\n$$ g_{\\mathrm{CN}} = \\frac{\\hat{u}^{n+1}}{\\hat{u}^n} = \\frac{1 - \\frac{\\lambda \\Delta t}{2}}{1 + \\frac{\\lambda \\Delta t}{2}} $$\nThe problem imposes the condition that the magnitude of the amplification factor is $0.3$. Since $\\lambda > 0$ and $\\Delta t > 0$, $g_{\\mathrm{CN}}$ is real and positive, so $|g_{\\mathrm{CN}}| = g_{\\mathrm{CN}} = 0.3$. We solve for $\\Delta t$:\n$$ 0.3 = \\frac{1 - \\frac{\\lambda \\Delta t}{2}}{1 + \\frac{\\lambda \\Delta t}{2}} $$\n$$ 0.3 \\left(1 + \\frac{\\lambda \\Delta t}{2}\\right) = 1 - \\frac{\\lambda \\Delta t}{2} $$\n$$ 0.3 + 0.15 \\lambda \\Delta t = 1 - 0.5 \\lambda \\Delta t $$\n$$ (0.15 + 0.5) \\lambda \\Delta t = 1 - 0.3 $$\n$$ 0.65 \\lambda \\Delta t = 0.7 $$\n$$ \\lambda \\Delta t = \\frac{0.7}{0.65} = \\frac{70}{65} = \\frac{14}{13} $$\nNow we can compute the required time step $\\Delta t$:\n$$ \\Delta t = \\frac{14}{13\\lambda} = \\frac{14}{13 (2.4\\pi^2)} = \\frac{14}{31.2\\pi^2} \\, \\text{s} $$\nNumerically, this is:\n$$ \\Delta t \\approx \\frac{14}{31.2 \\times (9.8696044...)} \\approx 0.0454649... \\, \\text{s} $$\nRounding to four significant figures, $\\Delta t = 0.04546$ s.\n\nFor the same time step $\\Delta t$, we now use the Backward Euler (BE) method. The discretization is:\n$$ \\frac{\\hat{u}^{n+1} - \\hat{u}^n}{\\Delta t} = -\\lambda \\hat{u}^{n+1} $$\nRearranging to find the BE amplification factor, $g_{\\mathrm{BE}} = \\hat{u}^{n+1}/\\hat{u}^n$:\n$$ \\hat{u}^{n+1} (1 + \\lambda \\Delta t) = \\hat{u}^n $$\n$$ g_{\\mathrm{BE}} = \\frac{1}{1 + \\lambda \\Delta t} $$\nWe use the value of the non-dimensional group $\\lambda \\Delta t = 14/13$ found previously:\n$$ g_{\\mathrm{BE}} = \\frac{1}{1 + \\frac{14}{13}} = \\frac{1}{\\frac{27}{13}} = \\frac{13}{27} $$\nNumerically, this is:\n$$ g_{\\mathrm{BE}} = \\frac{13}{27} \\approx 0.48148148... $$\nRounding to four significant figures, the BE amplification factor is $0.4815$.\n\nFinally, we briefly discuss which method introduces more numerical damping. Numerical damping is inversely related to the magnitude of the amplification factor; a smaller magnitude implies more damping. For the chosen parameters, we have $|g_{\\mathrm{CN}}| = 0.3$ and $|g_{\\mathrm{BE}}| = 13/27 \\approx 0.4815$. Since $0.3 < 0.4815$, the Crank-Nicolson method introduces more numerical damping than the Backward Euler method for this specific $\\Delta t$.\n\nThe final answer requires the computed time step $\\Delta t$ and the BE amplification factor.\n$\\Delta t \\approx 0.04546$ s.\nBE amplification factor $\\approx 0.4815$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.04546 & 0.4815\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "This final practice connects the theory of linear stability to the practical reality of solving the full nonlinear equations of compressible flow. While implicit schemes offer superior stability, their effectiveness hinges on the robust convergence of a nonlinear solver, typically Newton's method. This exercise  delves into a critical detail: the \"entropy fix\" in approximate Riemann solvers like Roe's scheme. You will analyze how this modification not only ensures a physically correct solution but also smooths the implicit Jacobian matrix, a crucial step for stabilizing Newton iterations and achieving reliable convergence in complex simulations.",
            "id": "3333923",
            "problem": "Consider the one-dimensional compressible Euler equations written in conservative form for state vector $U = (\\rho, \\rho u, \\rho E)^\\mathsf{T}$ with pressure $p$ given by the ideal-gas equation of state $p = (\\gamma - 1)\\left(\\rho E - \\tfrac{1}{2}\\rho u^{2}\\right)$, where $\\rho$ is the density, $u$ is the velocity, $E$ is the specific total energy, and $\\gamma$ is the ratio of specific heats. The flux is $F(U) = (\\rho u, \\rho u^{2} + p, u(\\rho E + p))^\\mathsf{T}$. In a finite-volume discretization, an interface flux between left and right states, $U_{L}$ and $U_{R}$, is built by linearizing the flux about a Roe-averaged state, with Roe-averaged velocity $\\tilde{u}$, Roe-averaged speed of sound $\\tilde{a}$, and an associated right-eigenstructure of the flux Jacobian composed of eigenvalues $\\lambda_{1} = \\tilde{u} - \\tilde{a}$, $\\lambda_{2} = \\tilde{u}$, and $\\lambda_{3} = \\tilde{u} + \\tilde{a}$, and corresponding right-eigenvectors $r_{k}$. The wave strengths $\\alpha_{k}$ arise from projecting the jump $U_{R} - U_{L}$ onto the eigenvectors.\n\nNear sonic points, for transonic rarefactions where $\\lambda_{k}^{L} < 0 < \\lambda_{k}^{R}$ for a characteristic family $k$, the Roe linearization produces vanishing dissipation when $\\lambda_{k} \\approx 0$, leading to entropy-violating expansion shocks and non-differentiable absolute-value dissipation that can degrade the robustness of implicit nonlinear solvers.\n\nStarting from the conservation laws and the Roe linearization framework, derive an entropy-consistent modification of the dissipation magnitude for each characteristic family that regularizes the behavior for $|\\lambda_{k}|$ near $0$ by blending to a nonzero value over a transonic band. Then, using the definition of the residual $R(U)$ formed by the sum of interface fluxes over a control volume, $R(U) = \\sum_{f} F_{f}(U)$, reason about the contribution of this modification to the implicit Jacobian $J(U) = \\partial R / \\partial U$ in a backward-Euler or pseudo-time implicit scheme, and its impact on the stability of Newton iterations for solving $R(U) = 0$.\n\nWhich option correctly gives an entropy-fix functional form consistent with the above derivation and correctly characterizes its effect on the implicit Jacobian and Newton iteration stability?\n\nA. Replace the magnitude $|\\lambda_{k}|$ in the dissipation with a $C^{1}$ quadratic blending over a transonic band: for each family $k$,\n$$\n\\phi_{k}(\\lambda_{k}) =\n\\begin{cases}\n\\dfrac{1}{2}\\left(\\dfrac{\\lambda_{k}^{2}}{\\delta_{k}} + \\delta_{k}\\right), & |\\lambda_{k}| < \\delta_{k},\\\\[6pt]\n|\\lambda_{k}|, & |\\lambda_{k}| \\ge \\delta_{k},\n\\end{cases}\n$$\nwhere the band width is chosen as $\\delta_{k} = \\max\\!\\left(0,\\, \\lambda_{k}^{R} - \\lambda_{k}^{L}\\right)$, so the fix activates only in transonic rarefactions. This regularization yields a continuous first derivative $d\\phi_{k}/d\\lambda_{k}$ with $d\\phi_{k}/d\\lambda_{k} = \\lambda_{k}/\\delta_{k}$ in the band, ensuring a nonzero dissipative magnitude at $|\\lambda_{k}| = 0$ and a smooth Jacobian contribution. In the implicit Jacobian, this adds positive semidefinite viscosity-like terms near sonic points, improves diagonal dominance and conditioning, and stabilizes Newton iterations by preventing singular or indefinite updates associated with vanishing characteristic speeds.\n\nB. Clamp the magnitude according to $|\\lambda_{k}| \\rightarrow \\max\\!\\left(|\\lambda_{k}|, \\delta\\right)$ with a constant $\\delta$ chosen as a fixed fraction of the local speed of sound, and set the Jacobian derivative $d|\\lambda_{k}|/d\\lambda_{k}$ to zero wherever $|\\lambda_{k}| < \\delta$ because the flux is then constant in $\\lambda_{k}$. This plateau guarantees entropy satisfaction and leaves Newton iterations unaffected since the dissipation is piecewise constant and does not alter the linearization.\n\nC. Replace $|\\lambda_{k}|$ by a signed dissipation $d_{k}(\\lambda_{k}) = \\operatorname{sign}(\\lambda_{k})\\,|\\lambda_{k}| = \\lambda_{k}$ to avoid the non-differentiability of the absolute value at $0$. Because the dissipation is now linear in $\\lambda_{k}$, the Jacobian is everywhere smooth and this change improves the conditioning of Newton iterations without affecting entropy or shock capturing.\n\nD. Use a quadratic blending $\\psi(\\lambda) = \\tfrac{1}{2}\\left(\\lambda^{2}/\\delta + \\delta\\right)$ for $|\\lambda| < \\delta$ with $\\delta$ set to a small constant independent of left-right states, but note that the derivative $d\\psi/d\\lambda$ is discontinuous at $|\\lambda| = \\delta$ so the implicit Jacobian inherits a jump that can occasionally help Newton convergence by introducing artificial damping only away from sonic points; at the sonic point the dissipation remains zero so the entropy condition is still satisfied by the Roe linearization.",
            "solution": "The numerical flux for the Roe scheme at an interface between a left state $U_L$ and a right state $U_R$ is given by:\n$$ F_{1/2} = \\frac{1}{2}\\left(F(U_L) + F(U_R)\\right) - \\frac{1}{2} D $$\nwhere $D$ is the dissipation term. In matrix form, the dissipation is $D = |\\tilde{A}|(U_R - U_L)$, where $\\tilde{A}$ is the Roe-averaged Jacobian matrix. Using the eigendecomposition of $\\tilde{A} = \\tilde{R}\\tilde{\\Lambda}\\tilde{R}^{-1}$, where $\\tilde{\\Lambda} = \\text{diag}(\\tilde{\\lambda}_k)$ is the diagonal matrix of eigenvalues and $\\tilde{R}$ is the matrix of right-eigenvectors, the dissipation matrix is $|\\tilde{A}| = \\tilde{R}|\\tilde{\\Lambda}|\\tilde{R}^{-1}$. The dissipation term can be written as a sum over the characteristic waves:\n$$ D = \\sum_{k=1}^{3} |\\tilde{\\lambda}_k| \\tilde{\\alpha}_k \\tilde{r}_k $$\nwhere $\\tilde{\\alpha}_k$ are the wave strengths, obtained by projecting the state jump $U_R - U_L$ onto the basis of eigenvectors: $\\tilde{\\alpha} = \\tilde{R}^{-1}(U_R - U_L)$.\n\nThe problem, as stated, occurs in transonic rarefactions where a characteristic speed crosses zero, e.g., $\\lambda_k(U_L) < 0$ and $\\lambda_k(U_R) > 0$. In this case, the Roe-averaged eigenvalue $\\tilde{\\lambda}_k$ can be close to or equal to zero. This causes the dissipation term for that characteristic family, $|\\tilde{\\lambda}_k|\\tilde{\\alpha}_k\\tilde{r}_k$, to vanish. This lack of dissipation allows for the formation of non-physical expansion shocks, violating the second law of thermodynamics (the entropy condition).\n\nFurthermore, the term $|\\tilde{\\lambda}_k|$ is not differentiable at $\\tilde{\\lambda}_k = 0$. For an implicit scheme, the residual $R(U)$ is a function of the numerical fluxes. The Jacobian of the residual, $J = \\partial R / \\partial U$, will involve derivatives of the flux with respect to the state variables. The non-differentiability of $|\\tilde{\\lambda}_k|$ introduces a non-differentiability in the Jacobian, which can severely degrade the convergence of Newton-based iterative solvers.\n\nTo remedy this, we must replace $|\\lambda_k|$ with a modified function, let's call it $\\phi_k(\\lambda_k)$, that satisfies two criteria:\n1.  **Entropy Condition:** $\\phi_k(0) > 0$ to ensure there is always some dissipation at the sonic point.\n2.  **Smoothness:** $\\phi_k(\\lambda_k)$ should be continuously differentiable ($C^1$) to ensure the implicit Jacobian is a smooth function of the state $U$, which is critical for robust Newton convergence.\n\nA widely used and effective modification is the Harten-Hyman entropy fix. This involves defining a small parameter $\\delta_k > 0$ that specifies a \"transonic band\" $[-\\delta_k, \\delta_k]$. Inside this band, the absolute value function is replaced by a parabola that smoothly connects to the absolute value function at the boundaries of the band.\n\nLet's construct this function. We want a quadratic form $\\phi_k(\\lambda_k) = c_1 \\lambda_k^2 + c_2 \\lambda_k + c_3$ for $|\\lambda_k| < \\delta_k$. For symmetry, we require $\\phi_k(\\lambda_k) = \\phi_k(-\\lambda_k)$, so $c_2=0$. Thus, $\\phi_k(\\lambda_k) = c_1 \\lambda_k^2 + c_3$.\nWe enforce $C^1$ continuity at $\\lambda_k = \\delta_k$:\n-   Value continuity ($C^0$): $\\phi_k(\\delta_k) = |\\delta_k| = \\delta_k$. So, $c_1 \\delta_k^2 + c_3 = \\delta_k$.\n-   Derivative continuity ($C^1$): $\\phi_k'(\\delta_k) = \\frac{d}{d\\lambda_k}|\\lambda_k| \\big|_{\\lambda_k=\\delta_k} = 1$. So, $2c_1\\delta_k = 1$, which gives $c_1 = \\frac{1}{2\\delta_k}$.\n\nSubstituting $c_1$ into the value continuity equation:\n$\\left(\\frac{1}{2\\delta_k}\\right)\\delta_k^2 + c_3 = \\delta_k \\implies \\frac{\\delta_k}{2} + c_3 = \\delta_k \\implies c_3 = \\frac{\\delta_k}{2}$.\n\nSo, the quadratic blending function is $\\phi_k(\\lambda_k) = \\frac{\\lambda_k^2}{2\\delta_k} + \\frac{\\delta_k}{2} = \\frac{1}{2}\\left(\\frac{\\lambda_k^2}{\\delta_k} + \\delta_k\\right)$.\nThe complete entropy-fix function is:\n$$ \\phi_k(\\lambda_k) = \\begin{cases} \\frac{1}{2}\\left(\\frac{\\lambda_k^2}{\\delta_k} + \\delta_k\\right), & |\\lambda_k| < \\delta_k \\\\ |\\lambda_k|, & |\\lambda_k| \\ge \\delta_k \\end{cases} $$\nThe derivative of this function is:\n$$ \\frac{d\\phi_k}{d\\lambda_k} = \\begin{cases} \\frac{\\lambda_k}{\\delta_k}, & |\\lambda_k| < \\delta_k \\\\ \\text{sign}(\\lambda_k), & |\\lambda_k| > \\delta_k \\end{cases} $$\nThis derivative is continuous everywhere, including at $|\\lambda_k| = \\delta_k$ where it transitions smoothly from $\\pm \\delta_k / \\delta_k = \\pm 1$ to $\\text{sign}(\\pm \\delta_k) = \\pm 1$.\n\nA physically-motivated choice for the band width $\\delta_k$ is one that activates the fix only when necessary, i.e., in transonic rarefactions. This is achieved by setting $\\delta_k$ based on the spread of the characteristic speeds across the interface:\n$$ \\delta_k = \\max(0, \\lambda_k(U_R) - \\lambda_k(U_L)) $$\nThis ensures $\\delta_k > 0$ only when $\\lambda_k$ increases across the interface. For a wave moving from left to right (e.g., family 3, $\\lambda_3 = u+a$), this corresponds to a rarefaction. If such a wave is also transonic ($\\lambda_k(U_L) < 0 < \\lambda_k(U_R)$), this choice of $\\delta_k$ will be positive and invoke the fix.\n\n**Impact on the Implicit Jacobian and Newton Iterations:**\nThe residual $R(U)$ is a sum of fluxes, and the flux now depends on $\\phi_k(\\tilde{\\lambda}_k(U_L, U_R))$. The Jacobian $J(U) = \\partial R / \\partial U$ will now depend on the derivative $d\\phi_k/d\\lambda_k$. Since this derivative is continuous, the Jacobian $J(U)$ becomes a continuous function of the state $U$. This eliminates the pathological behavior of Newton's method near sonic points that arises from a discontinuous or non-differentiable Jacobian.\n\nThe dissipation matrix portion of the Jacobian is related to $|A|_{mod} = \\tilde{R}\\,\\text{diag}(\\phi_k(\\tilde{\\lambda}_k))\\,\\tilde{R}^{-1}$. The eigenvalues of this matrix are $\\phi_k(\\tilde{\\lambda}_k)$. When the fix is active, $\\phi_k \\ge \\delta_k/2 > 0$. Therefore, this modified dissipation matrix is positive definite. In the full-system Jacobian, the dissipation terms contribute to the diagonal blocks. A positive definite dissipation matrix enhances the magnitude of the terms on the main diagonal, a property known as diagonal dominance. A more diagonally dominant matrix is typically better conditioned (further from being singular) and leads to more stable and robust convergence of the linear solver used within each Newton iteration. Thus, the entropy fix stabilizes the Newton iterations by smoothing the Jacobian and improving its conditioning.\n\n### Option-by-Option Analysis\n\n**A.** This option presents the $C^1$ quadratic blending function $\\phi_{k}(\\lambda_{k}) = \\frac{1}{2}\\left(\\frac{\\lambda_{k}^{2}}{\\delta_{k}} + \\delta_{k}\\right)$ for $|\\lambda_{k}| < \\delta_{k}$, which matches our derivation. It correctly states that the derivative is continuous and equal to $\\lambda_{k}/\\delta_{k}$ in the band. It correctly notes that the dissipation magnitude is nonzero at $\\lambda_k=0$ (it is $\\delta_k/2$). It presents the appropriate choice for the band width $\\delta_{k} = \\max\\!\\left(0,\\, \\lambda_{k}^{R} - \\lambda_{k}^{L}\\right)$. Its analysis of the impact on the Jacobian is also correct: it adds positive (semi)definite viscosity-like terms, improves diagonal dominance and conditioning, and stabilizes Newton iterations. All statements in this option are consistent with the derivation.\n\n**Verdict: Correct.**\n\n**B.** This option proposes a clamping fix: $|\\lambda_{k}| \\rightarrow \\max\\!\\left(|\\lambda_{k}|, \\delta\\right)$. While this is a valid entropy fix in principle, it is not $C^1$; it has a kink at $|\\lambda_k| = \\delta$. The statement that this \"leaves Newton iterations unaffected\" is incorrect. The introduction of a new kink in the Jacobian can cause convergence issues, and freezing the Jacobian contribution as suggested is an approximation that sacrifices the quadratic convergence rate of Newton's method.\n\n**Verdict: Incorrect.**\n\n**C.** This option proposes replacing $|\\lambda_k|$ with $\\lambda_k$. As shown in the derivation, this leads to the numerical flux $F_{1/2} = F_L$. This is a fully upwind scheme which is only stable if all characteristics are positive ($\\lambda_k > 0$). If any characteristic is negative, it implies information propagating in the wrong direction, leading to instability. For transonic flows or shocks where characteristics have mixed signs, this scheme is catastrophically unstable and physically incorrect. It destroys shock capturing and does not satisfy the entropy condition.\n\n**Verdict: Incorrect.**\n\n**D.** This option presents the correct quadratic blending function but contains several critical errors in its analysis. It incorrectly claims the derivative $d\\psi/d\\lambda$ is *discontinuous*, which is false; the function is specifically constructed to be $C^1$. It then incorrectly claims that dissipation at the sonic point \"remains zero\", which is also false; the value is $\\delta/2$. This statement shows a complete misunderstanding of the purpose of the entropy fix. Finally, it wrongly claims the original Roe linearization satisfies the entropy condition, contradicting the premise of the entire problem.\n\n**Verdict: Incorrect.**",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}