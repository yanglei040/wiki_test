{
    "hands_on_practices": [
        {
            "introduction": "Computational fluid dynamics solvers frequently operate on nondimensional variables to improve numerical stability and generalize results. A critical step in developing or validating such a solver is to ensure that fundamental physical laws, like the perfect-gas equation of state, are correctly represented in this nondimensional framework. This first practice guides you through deriving the nondimensional form of the equation of state and implementing a programmatic check to verify its consistency across various flow conditions .",
            "id": "3351066",
            "problem": "You are validating a Computational Fluid Dynamics (CFD) solver’s nondimensional implementation of the perfect-gas equation of state. The solver nondimensionalizes variables using the reference density $\\rho_\\infty$, reference speed of sound $a_\\infty$, and reference temperature $T_\\infty$, with the perfect-gas assumption holding for a constant ratio of specific heats $\\gamma$. The solver uses nondimensional variables defined by $p^* = p / \\left(\\rho_\\infty a_\\infty^2\\right)$, $\\rho^* = \\rho / \\rho_\\infty$, and $T^* = T / T_\\infty$. The test you will implement should verify the nondimensional consistency of the perfect-gas equation of state across all computational cells in several prescribed test cases.\n\nStart from first principles and core definitions:\n- The perfect-gas equation of state is $p = \\rho R T$, where $R$ is the specific gas constant.\n- The speed of sound is defined by $a^2 = \\gamma R T$, and thus $a_\\infty^2 = \\gamma R T_\\infty$ at the reference state.\n\nFrom these, derive a nondimensional equation of state suitable for programmatic consistency checks on arrays of cell values. Then, implement a numerical check that, for each test case, computes the maximum absolute deviation from that nondimensional equation over all the cells in the case and returns a boolean indicating whether the condition holds within a prescribed tolerance.\n\nThere are no dimensional units in this task because all quantities are nondimensional by construction. Angles and percentages do not appear in this problem.\n\nYour program must:\n- Use the derived nondimensional equation of state to compute, for each cell $i$, the residual $r_i = p_i^* - \\left(\\rho_i^* T_i^* / \\gamma\\right)$.\n- Compute the maximum absolute residual $\\max_i |r_i|$ for each test case.\n- Compare this maximum to the given tolerance $\\tau$ for that test case, and return a boolean value indicating whether the maximum residual is less than or equal to the tolerance.\n\nTest Suite (use exactly the following data):\n1. Happy-path consistency under $\\gamma = 1.4$:\n   - $\\gamma = 1.4$\n   - $\\rho^* = \\{\\,0.9,\\,1.1,\\,0.7,\\,1.3\\,\\}$\n   - $T^* = \\{\\,0.8,\\,1.2,\\,3.5,\\,0.5\\,\\}$\n   - $p^*$ is set to $p^*_i = \\rho^*_i T^*_i / \\gamma + \\delta_i$ with $\\delta = \\{\\,10^{-12},\\,-5\\times 10^{-12},\\,2\\times 10^{-12},\\,-10^{-12}\\,\\}$\n   - Tolerance $\\tau = 10^{-10}$\n2. Clear failure with a single large perturbation under $\\gamma = 1.4$:\n   - $\\gamma = 1.4$\n   - $\\rho^* = \\{\\,0.9,\\,1.1,\\,0.7,\\,1.3\\,\\}$\n   - $T^* = \\{\\,0.8,\\,1.2,\\,3.5,\\,0.5\\,\\}$\n   - $p^*$ is set to $p^*_i = \\rho^*_i T^*_i / \\gamma$ for all $i$ except one cell with an added perturbation of $10^{-3}$ (apply it to the third entry)\n   - Tolerance $\\tau = 10^{-6}$\n3. Near-vacuum regime under $\\gamma = 1.4$:\n   - $\\gamma = 1.4$\n   - $\\rho^* = \\{\\,10^{-9},\\,2\\times 10^{-9},\\,3\\times 10^{-9}\\,\\}$\n   - $T^* = \\{\\,3\\times 10^{-9},\\,4\\times 10^{-9},\\,5\\times 10^{-9}\\,\\}$\n   - $p^*$ is set exactly to $p^*_i = \\rho^*_i T^*_i / \\gamma$\n   - Tolerance $\\tau = 10^{-20}$\n4. Monatomic gas consistency with $\\gamma = 5/3$:\n   - $\\gamma = 5/3$\n   - $\\rho^* = \\{\\,0.2,\\,2.0,\\,4.0\\,\\}$\n   - $T^* = \\{\\,10.0,\\,0.5,\\,0.125\\,\\}$\n   - $p^*$ is set exactly to $p^*_i = \\rho^*_i T^*_i / \\gamma$\n   - Tolerance $\\tau = 10^{-12}$\n5. Mixed-pass case with subtle violation under $\\gamma = 1.4$:\n   - $\\gamma = 1.4$\n   - $\\rho^* = \\{\\,1.0,\\,0.5,\\,2.0,\\,0.25,\\,3.0\\,\\}$\n   - $T^* = \\{\\,1.0,\\,2.0,\\,0.5,\\,4.0,\\,0.3333333333333333\\,\\}$\n   - $p^*$ is set to $p^*_i = \\rho^*_i T^*_i / \\gamma$ for all $i$, except the last entry which is increased by $5\\times 10^{-9}$\n   - Tolerance $\\tau = 10^{-10}$\n\nFinal Output Format:\n- Your program should produce a single line of output containing a list of booleans, one per test case, in order from test case $1$ to test case $5$. The output must be a comma-separated list enclosed in square brackets, e.g., $\\texttt{[True,False,True,True,False]}$.",
            "solution": "The objective is to validate the nondimensional formulation of the perfect-gas equation of state as implemented in a computational fluid dynamics (CFD) solver. This validation is performed by deriving the correct nondimensional relationship from first principles and then implementing a numerical check against a suite of test cases.\n\nThe analysis begins with the fundamental dimensional equations provided:\n1.  The perfect-gas equation of state:\n    $$p = \\rho R T$$\n    where $p$ is the pressure, $\\rho$ is the density, $T$ is the absolute temperature, and $R$ is the specific gas constant.\n2.  The definition for the speed of sound in a perfect gas:\n    $$a^2 = \\gamma R T$$\n    where $a$ is the speed of sound and $\\gamma$ is the constant ratio of specific heats.\n\nThe problem specifies that state variables are nondimensionalized using a set of constant reference values, denoted by the subscript $\\infty$. The nondimensional variables (denoted by a superscript $*$) are defined as:\n$$p^* = \\frac{p}{\\rho_\\infty a_\\infty^2}$$\n$$\\rho^* = \\frac{\\rho}{\\rho_\\infty}$$\n$$T^* = \\frac{T}{T_\\infty}$$\n\nAt the reference state, the speed of sound is given by:\n$$a_\\infty^2 = \\gamma R T_\\infty$$\n\nTo derive the nondimensional equation of state, we first express the dimensional variables in terms of their nondimensional counterparts:\n$$p = p^* \\rho_\\infty a_\\infty^2$$\n$$\\rho = \\rho^* \\rho_\\infty$$\n$$T = T^* T_\\infty$$\n\nSubstituting these expressions into the dimensional equation of state, $p = \\rho R T$, yields:\n$$(p^* \\rho_\\infty a_\\infty^2) = (\\rho^* \\rho_\\infty) R (T^* T_\\infty)$$\n\nThe reference density $\\rho_\\infty$ is a non-zero constant and can be canceled from both sides of the equation:\n$$p^* a_\\infty^2 = \\rho^* R T^* T_\\infty$$\n\nNext, we substitute the expression for the reference speed of sound squared, $a_\\infty^2 = \\gamma R T_\\infty$:\n$$p^* (\\gamma R T_\\infty) = \\rho^* R T^* T_\\infty$$\n\nThe terms $R$ and $T_\\infty$ are non-zero constants and can be canceled from both sides, leading to the remarkably simple relationship:\n$$p^* \\gamma = \\rho^* T^*$$\n\nRearranging this equation to express the nondimensional pressure $p^*$ as a function of the nondimensional density $\\rho^*$ and temperature $T^*$ gives the final form of the nondimensional perfect-gas equation of state:\n$$p^* = \\frac{\\rho^* T^*}{\\gamma}$$\n\nThis relationship must hold for a correctly implemented CFD solver under the perfect-gas assumption. The validation procedure involves checking the consistency of given sets of $(p_i^*, \\rho_i^*, T_i^*)$ values for a collection of computational cells, indexed by $i$.\n\nFor each cell $i$, we compute a residual, $r_i$, defined as the difference between the given nondimensional pressure $p_i^*$ and the value predicted by the derived nondimensional equation of state:\n$$r_i = p_i^* - \\frac{\\rho_i^* T_i^*}{\\gamma}$$\nThis definition matches the one provided in the problem statement.\n\nThe overall consistency of a test case is quantified by finding the maximum absolute residual across all cells:\n$$r_{\\max} = \\max_i |r_i|$$\n\nThe test case is considered to pass, indicating that the solver's state is consistent with the nondimensional equation of state, if this maximum residual is within a specified numerical tolerance, $\\tau$. The condition for passing the test is:\n$$r_{\\max} \\le \\tau$$\n\nThis process constitutes a rigorous, quantitative verification test, which is a critical component of software quality assurance in scientific computing. The following program implements this procedure for the provided test suite.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Validates the nondimensional perfect-gas equation of state for a set of test cases.\n    \"\"\"\n\n    # Test Suite (use exactly the following data):\n    test_cases = [\n        # Case 1: Happy-path consistency under gamma = 1.4\n        {\n            \"gamma\": 1.4,\n            \"rho_star\": np.array([0.9, 1.1, 0.7, 1.3]),\n            \"T_star\": np.array([0.8, 1.2, 3.5, 0.5]),\n            \"p_star_setup\": {\n                \"type\": \"relative\",\n                \"delta\": np.array([1e-12, -5e-12, 2e-12, -1e-12])\n            },\n            \"tolerance\": 1e-10\n        },\n        # Case 2: Clear failure with a single large perturbation under gamma = 1.4\n        {\n            \"gamma\": 1.4,\n            \"rho_star\": np.array([0.9, 1.1, 0.7, 1.3]),\n            \"T_star\": np.array([0.8, 1.2, 3.5, 0.5]),\n            \"p_star_setup\": {\n                \"type\": \"perturb\",\n                \"index\": 2,  # 0-based index for the third entry\n                \"perturbation\": 1e-3\n            },\n            \"tolerance\": 1e-6\n        },\n        # Case 3: Near-vacuum regime under gamma = 1.4\n        {\n            \"gamma\": 1.4,\n            \"rho_star\": np.array([1e-9, 2e-9, 3e-9]),\n            \"T_star\": np.array([3e-9, 4e-9, 5e-9]),\n            \"p_star_setup\": {\"type\": \"exact\"},\n            \"tolerance\": 1e-20\n        },\n        # Case 4: Monatomic gas consistency with gamma = 5/3\n        {\n            \"gamma\": 5.0 / 3.0,\n            \"rho_star\": np.array([0.2, 2.0, 4.0]),\n            \"T_star\": np.array([10.0, 0.5, 0.125]),\n            \"p_star_setup\": {\"type\": \"exact\"},\n            \"tolerance\": 1e-12\n        },\n        # Case 5: Mixed-pass case with subtle violation under gamma = 1.4\n        {\n            \"gamma\": 1.4,\n            \"rho_star\": np.array([1.0, 0.5, 2.0, 0.25, 3.0]),\n            \"T_star\": np.array([1.0, 2.0, 0.5, 4.0, 1.0/3.0]),\n            \"p_star_setup\": {\n                \"type\": \"perturb\",\n                \"index\": -1, # Last entry\n                \"perturbation\": 5e-9\n            },\n            \"tolerance\": 1e-10\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        gamma = case[\"gamma\"]\n        rho_star = case[\"rho_star\"]\n        T_star = case[\"T_star\"]\n        tolerance = case[\"tolerance\"]\n        \n        # Calculate the ideal nondimensional pressure\n        p_star_ideal = rho_star * T_star / gamma\n        \n        # Construct the given p_star based on the setup\n        setup = case[\"p_star_setup\"]\n        if setup[\"type\"] == \"exact\":\n            p_star = p_star_ideal\n        elif setup[\"type\"] == \"relative\":\n            p_star = p_star_ideal + setup[\"delta\"]\n        elif setup[\"type\"] == \"perturb\":\n            p_star = np.copy(p_star_ideal)\n            p_star[setup[\"index\"]] += setup[\"perturbation\"]\n        \n        # Compute the residual for each cell\n        # r_i = p_i^* - (rho_i^* * T_i^* / gamma)\n        residuals = p_star - p_star_ideal\n        \n        # Compute the maximum absolute residual\n        max_abs_residual = np.max(np.abs(residuals))\n        \n        # Compare with tolerance and record the boolean result\n        is_consistent = max_abs_residual = tolerance\n        results.append(is_consistent)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Having established how to represent the thermodynamic state, we now apply these principles to a classic compressible flow phenomenon: the normal shock wave. The abrupt changes in pressure, density, and temperature across a shock are dictated by the conservation laws, which rely on the equation of state for closure. This exercise involves deriving the pressure jump across a shock and then performing a sensitivity analysis to understand how the predicted shock strength depends on the specific heat ratio, $\\gamma$, a key parameter in the perfect-gas model .",
            "id": "3351075",
            "problem": "A steady, planar, one-dimensional normal shock wave in a calorically perfect gas with constant specific heat ratio $\\gamma$ is modeled in Computational Fluid Dynamics (CFD). The upstream state is uniform with Mach number $M_1$, and the gas obeys the ideal-gas equation of state $p=\\rho R T$. In practice, the value of $\\gamma$ used in a CFD simulation may be mis-specified. To assess the impact of this on the predicted shock strength, you will derive the pressure jump and its sensitivity to $\\gamma$.\n\nStarting strictly from the steady one-dimensional conservation laws of mass, momentum, and energy across the shock, together with the ideal-gas equation of state and the calorically perfect gas relation for specific enthalpy, derive an explicit expression for the pressure ratio $p_2/p_1$ across the shock as a function of $\\gamma$ and $M_1$, assuming $M_11$. Then, treating $M_1$ as fixed, compute the logarithmic sensitivity\n$$\nS \\equiv \\frac{\\partial \\ln\\!\\left(p_2/p_1\\right)}{\\partial \\ln \\gamma}\n$$\nevaluated at $M_1=2.5$ and $\\gamma=1.4$.\n\nExpress the final value of $S$ as a dimensionless number and round your answer to four significant figures.",
            "solution": "The problem requires the derivation of the pressure ratio across a steady, one-dimensional normal shock wave in a calorically perfect gas, followed by the calculation of the logarithmic sensitivity of this ratio with respect to the specific heat ratio, $\\gamma$.\n\nThe analysis begins with the fundamental conservation laws for a control volume enclosing the shock wave. Subscripts $1$ and $2$ denote the uniform states upstream and downstream of the shock, respectively.\n\nThe conservation of mass is given by:\n$$\n\\rho_1 u_1 = \\rho_2 u_2\n$$\n\nThe conservation of momentum is:\n$$\np_1 + \\rho_1 u_1^2 = p_2 + \\rho_2 u_2^2\n$$\n\nThe conservation of energy is:\n$$\nh_1 + \\frac{1}{2}u_1^2 = h_2 + \\frac{1}{2}u_2^2\n$$\nwhere $h$ is the specific enthalpy.\n\nThese are supplemented by the ideal-gas equation of state:\n$$\np = \\rho R T\n$$\nand the relation for the specific enthalpy of a calorically perfect gas:\n$$\nh = c_p T = \\frac{\\gamma R}{\\gamma-1} T\n$$\nThe speed of sound, $a$, is given by $a^2 = \\gamma R T$, and the Mach number is $M = u/a$.\n\nFirst, we derive the expression for the pressure ratio $p_2/p_1$. Rearranging the momentum equation gives:\n$$\np_2 - p_1 = \\rho_1 u_1^2 - \\rho_2 u_2^2\n$$\nUsing the mass conservation relation $u_2 = (\\rho_1/\\rho_2)u_1$, we can write:\n$$\np_2 - p_1 = \\rho_1 u_1^2 - \\rho_2 \\left(\\frac{\\rho_1 u_1}{\\rho_2}\\right)^2 = \\rho_1 u_1^2 \\left(1 - \\frac{\\rho_1}{\\rho_2}\\right)\n$$\nDividing by $p_1$ and using the relations $u_1^2 = M_1^2 a_1^2$ and $a_1^2 = \\gamma p_1/\\rho_1$, we find:\n$$\n\\frac{p_2}{p_1} - 1 = \\frac{\\rho_1 u_1^2}{p_1} \\left(1 - \\frac{\\rho_1}{\\rho_2}\\right) = \\frac{\\rho_1 (M_1^2 a_1^2)}{p_1} \\left(1 - \\frac{\\rho_1}{\\rho_2}\\right) = \\frac{\\rho_1 M_1^2 (\\gamma p_1/\\rho_1)}{p_1} \\left(1 - \\frac{\\rho_1}{\\rho_2}\\right)\n$$\nThis simplifies to:\n$$\n\\frac{p_2}{p_1} = 1 + \\gamma M_1^2 \\left(1 - \\frac{\\rho_1}{\\rho_2}\\right)\n$$\nThis is an intermediate result known as the Rankine-Hugoniot relation. To proceed, we need an expression for the density ratio. By combining all three conservation laws, one can derive the following relation between pressure and density across the shock for a calorically perfect gas:\n$$\n\\frac{\\rho_2}{\\rho_1} = \\frac{(\\gamma+1)\\frac{p_2}{p_1} + (\\gamma-1)}{(\\gamma-1)\\frac{p_2}{p_1} + (\\gamma+1)}\n$$\nSubstituting $\\rho_1/\\rho_2$ from this into the previous equation for $p_2/p_1$:\n$$\n\\frac{p_2}{p_1} = 1 + \\gamma M_1^2 \\left(1 - \\frac{(\\gamma-1)\\frac{p_2}{p_1} + (\\gamma+1)}{(\\gamma+1)\\frac{p_2}{p_1} + (\\gamma-1)}\\right)\n$$\nLet $P = p_2/p_1$.\n$$\nP - 1 = \\gamma M_1^2 \\left( \\frac{[(\\gamma+1)P + (\\gamma-1)] - [(\\gamma-1)P + (\\gamma+1)]}{(\\gamma+1)P + (\\gamma-1)} \\right)\n$$\n$$\nP - 1 = \\gamma M_1^2 \\left( \\frac{2P - 2}{(\\gamma+1)P + (\\gamma-1)} \\right) = 2 \\gamma M_1^2 \\frac{P - 1}{(\\gamma+1)P + (\\gamma-1)}\n$$\nFor a shock wave, $M_11$, which implies $p_2p_1$ and thus $P \\neq 1$. We can divide both sides by $P-1$:\n$$\n1 = \\frac{2 \\gamma M_1^2}{(\\gamma+1)P + (\\gamma-1)}\n$$\nSolving for $P$:\n$$\n(\\gamma+1)P + (\\gamma-1) = 2 \\gamma M_1^2\n$$\n$$\n(\\gamma+1)P = 2 \\gamma M_1^2 - (\\gamma-1)\n$$\n$$\n\\frac{p_2}{p_1} = \\frac{2 \\gamma M_1^2 - (\\gamma-1)}{\\gamma+1}\n$$\nThis is the required expression for the pressure ratio.\n\nNext, we compute the logarithmic sensitivity, $S$, defined as:\n$$\nS \\equiv \\frac{\\partial \\ln(p_2/p_1)}{\\partial \\ln \\gamma}\n$$\nUsing the chain rule for derivatives, this can be expressed as:\n$$\nS = \\gamma \\frac{\\partial}{\\partial \\gamma} \\left( \\ln\\left(\\frac{p_2}{p_1}\\right) \\right)\n$$\nLet $F(\\gamma, M_1) = p_2/p_1$.\n$$\n\\ln F = \\ln(2 \\gamma M_1^2 - \\gamma + 1) - \\ln(\\gamma+1)\n$$\nDifferentiating with respect to $\\gamma$ while holding $M_1$ constant:\n$$\n\\frac{\\partial (\\ln F)}{\\partial \\gamma} = \\frac{1}{2 \\gamma M_1^2 - \\gamma + 1} \\frac{\\partial}{\\partial \\gamma}(2 \\gamma M_1^2 - \\gamma + 1) - \\frac{1}{\\gamma+1} \\frac{\\partial}{\\partial \\gamma}(\\gamma+1)\n$$\n$$\n\\frac{\\partial (\\ln F)}{\\partial \\gamma} = \\frac{2 M_1^2 - 1}{2 \\gamma M_1^2 - \\gamma + 1} - \\frac{1}{\\gamma+1}\n$$\nPutting this over a common denominator:\n$$\n\\frac{\\partial (\\ln F)}{\\partial \\gamma} = \\frac{(2 M_1^2 - 1)(\\gamma+1) - (2 \\gamma M_1^2 - \\gamma + 1)}{(2 \\gamma M_1^2 - \\gamma + 1)(\\gamma+1)}\n$$\nExpanding the numerator:\n$$\n(2 M_1^2 \\gamma + 2 M_1^2 - \\gamma - 1) - (2 \\gamma M_1^2 - \\gamma + 1) = 2 M_1^2 \\gamma + 2 M_1^2 - \\gamma - 1 - 2 \\gamma M_1^2 + \\gamma - 1 = 2 M_1^2 - 2 = 2(M_1^2 - 1)\n$$\nSo the derivative is:\n$$\n\\frac{\\partial (\\ln F)}{\\partial \\gamma} = \\frac{2(M_1^2 - 1)}{(2 \\gamma M_1^2 - \\gamma + 1)(\\gamma+1)}\n$$\nThe sensitivity $S$ is $\\gamma$ times this expression:\n$$\nS = \\frac{2\\gamma(M_1^2 - 1)}{(2 \\gamma M_1^2 - \\gamma + 1)(\\gamma+1)}\n$$\nFinally, we evaluate $S$ for the given values $M_1=2.5$ and $\\gamma=1.4$.\nFirst, we compute the necessary terms:\n$$\nM_1 = 2.5 \\implies M_1^2 = 6.25\n$$\n$$\nM_1^2 - 1 = 5.25\n$$\n$$\n\\gamma = 1.4\n$$\n$$\n\\gamma+1 = 2.4\n$$\n$$\n\\gamma-1 = 0.4\n$$\nNow, substitute these into the expression for $S$.\nThe numerator is:\n$$\n2\\gamma(M_1^2 - 1) = 2 \\times 1.4 \\times 5.25 = 2.8 \\times 5.25 = 14.7\n$$\nThe denominator is:\n$$\n(2 \\gamma M_1^2 - (\\gamma - 1))(\\gamma+1) = ( (2 \\times 1.4 \\times 6.25) - (0.4) ) \\times (2.4)\n$$\n$$\n= ( (2.8 \\times 6.25) - 0.4 ) \\times 2.4\n$$\n$$\n= (17.5 - 0.4) \\times 2.4\n$$\n$$\n= 17.1 \\times 2.4 = 41.04\n$$\nThe sensitivity is the ratio of the numerator to the denominator:\n$$\nS = \\frac{14.7}{41.04} \\approx 0.35818713...\n$$\nRounding to four significant figures, the result is $0.3582$.",
            "answer": "$$\n\\boxed{0.3582}\n$$"
        },
        {
            "introduction": "The assumption of a calorically perfect gas, with constant specific heats, simplifies many analyses but has its limits, especially in high-temperature flows where properties like $c_p$ vary significantly. This final practice explores the consequences of this simplification by comparing predictions from a constant-property model against a more realistic temperature-dependent model for an isentropic nozzle flow. You will quantify the deviations in temperature, pressure, and acoustic speed, gaining crucial insight into the fidelity of the perfect-gas model and the methods needed to handle real gas effects .",
            "id": "3351072",
            "problem": "You are asked to design a program that quantifies the deviations induced by assuming constant specific heat at constant pressure and constant ratio of specific heats versus using temperature-dependent specific heat functions for a calorically imperfect but mechanically and thermally perfect gas, under isentropic nozzle expansion. The gas is dry air modeled as a single-component perfect gas with constant composition and a constant mass-specific gas constant. The program should compare the predicted static temperature, static pressure, and local acoustic speed for a nozzle exit at a specified Mach number using two models: (i) a constant-property model using specific heat at constant pressure and ratio of specific heats fixed at the stagnation temperature, and (ii) a temperature-dependent model using specific heat at constant pressure and specific heat at constant volume varying with temperature via a specified polynomial. Start from fundamental laws and core definitions only and do not rely on shortcut formulas. For all computations, use mass-specific quantities.\n\nAssumptions and base definitions:\n- The gas obeys the perfect-gas equation of state $p = \\rho R T$, where $p$ is pressure, $\\rho$ is density, $R$ is the mass-specific gas constant, and $T$ is temperature. Use $R = 287.058 \\, \\mathrm{J\\,kg^{-1}\\,K^{-1}}$ and treat $R$ as constant.\n- The specific heat at constant pressure $c_p(T)$ is temperature dependent according to a calibrated polynomial centered at a reference temperature. Use\n$$\nc_p(T) = a_0 + a_1 \\left(T - T_{\\mathrm{ref}}\\right) + a_2 \\left(T - T_{\\mathrm{ref}}\\right)^2,\n$$\nwith $T_{\\mathrm{ref}} = 300 \\, \\mathrm{K}$, $a_0 = 1005.0 \\, \\mathrm{J\\,kg^{-1}\\,K^{-1}}$, $a_1 = 0.1 \\, \\mathrm{J\\,kg^{-1}\\,K^{-2}}$, and $a_2 = 1\\times 10^{-4} \\, \\mathrm{J\\,kg^{-1}\\,K^{-3}}$. These coefficients are chosen to be scientifically plausible over the range of temperatures in the test suite and yield increasing $c_p$ with temperature. The specific heat at constant volume is $c_v(T) = c_p(T) - R$, and the ratio of specific heats is $\\gamma(T) = c_p(T)/c_v(T)$.\n- The isentropic expansion is adiabatic and reversible with no body forces, shaft work, or heat transfer, so the stagnation enthalpy is conserved along a streamline and the entropy is constant, implying $h_0 = h + u^2/2$ and $\\mathrm{d}s = 0$, where $h$ is specific enthalpy, $u$ is flow speed, and $s$ is specific entropy.\n- The local acoustic speed $a$ is defined from the thermodynamic identity $a^2 = \\left(\\frac{\\partial p}{\\partial \\rho}\\right)_s$, which for an ideal gas under isentropic conditions leads to $a(T) = \\sqrt{\\gamma(T) R T}$.\n\nYour task:\n- For each test case, compute the static temperature $T$, static pressure $p$, and local acoustic speed $a$ at the nozzle exit for a prescribed exit Mach number $M$, stagnation temperature $T_0$, and stagnation pressure $p_0$, using both of the following models:\n  1. Constant-property model: Fix $c_p$ and $\\gamma$ at $T_0$ (i.e., $c_{p,\\mathrm{const}} = c_p(T_0)$ and $\\gamma_{\\mathrm{const}} = \\gamma(T_0)$). Use the energy conservation and isentropic condition to determine $T$, $p$, and $a$ with these constants.\n  2. Temperature-dependent model: Use $c_p(T)$ and $c_v(T)$ as functions of $T$ in the energy and isentropic conditions. Solve the nonlinear temperature equation implied by $h_0 - h(T) = u^2/2$ with $u = M a(T)$ and $a(T) = \\sqrt{\\gamma(T) R T}$, and compute $p$ from the isentropic condition derived from $\\mathrm{d}s = 0$.\n- Quantify the deviations as relative differences, defined by $\\Delta T = \\left(T_{\\mathrm{const}} - T_{\\mathrm{var}}\\right) / T_{\\mathrm{var}}$, $\\Delta p = \\left(p_{\\mathrm{const}} - p_{\\mathrm{var}}\\right) / p_{\\mathrm{var}}$, and $\\Delta a = \\left(a_{\\mathrm{const}} - a_{\\mathrm{var}}\\right) / a_{\\mathrm{var}}$, where the subscript “const” refers to the constant-property model and “var” refers to the temperature-dependent model.\n\nImplementation guidance:\n- Compute enthalpy differences through $h_0 - h(T) = \\int_{T}^{T_0} c_p(\\tau)\\,\\mathrm{d}\\tau$ using numerical quadrature.\n- Use the isentropic condition $\\mathrm{d}s = 0$ expressed for a perfect gas with temperature-dependent $c_p(T)$ as $\\mathrm{d}s = c_p(T)\\,\\mathrm{d}T/T - R\\,\\mathrm{d}p/p = 0$, then integrate to obtain $p(T)$ relative to $p_0$. Use numerical quadrature for the integral $\\int c_p(T)/(R\\,T)\\, \\mathrm{d}T$.\n- Use a robust root finding method to solve the nonlinear temperature equation for the temperature-dependent model.\n- For the constant-property model, apply the same base laws with $c_p$ and $\\gamma$ held constant at $T_0$. Compute the acoustic speed from $a(T) = \\sqrt{\\gamma R T}$.\n\nUnits and output:\n- Express temperatures in $\\mathrm{K}$, pressures in $\\mathrm{Pa}$, and speeds in $\\mathrm{m/s}$ internally, but the program’s final output should contain unitless relative deviations as defined above.\n- The final output should be a single line containing the list of results for all test cases as a comma-separated list enclosed in square brackets. Each test case’s result is an inner list of three floats $\\left[\\Delta T, \\Delta p, \\Delta a\\right]$, for example, $\\left[[\\delta_{T,1}, \\delta_{p,1}, \\delta_{a,1}], [\\delta_{T,2}, \\delta_{p,2}, \\delta_{a,2}]\\right]$.\n\nTest suite to cover different regimes:\n- Case $1$: $T_0 = 1000 \\, \\mathrm{K}$, $p_0 = 200000 \\, \\mathrm{Pa}$, $M = 2.0$.\n- Case $2$: $T_0 = 300 \\, \\mathrm{K}$, $p_0 = 101325 \\, \\mathrm{Pa}$, $M = 0.05$.\n- Case $3$: $T_0 = 1500 \\, \\mathrm{K}$, $p_0 = 500000 \\, \\mathrm{Pa}$, $M = 5.0$.\n- Case $4$: $T_0 = 600 \\, \\mathrm{K}$, $p_0 = 300000 \\, \\mathrm{Pa}$, $M = 1.0$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $\\left[\\mathrm{result}_1,\\mathrm{result}_2,\\mathrm{result}_3,\\mathrm{result}_4\\right]$), where each $\\mathrm{result}_i$ is the inner list $\\left[\\Delta T, \\Delta p, \\Delta a\\right]$ for the $i$-th test case.",
            "solution": "The user requests a program to quantify the deviation between a constant-property gas model and a temperature-dependent property model for isentropic nozzle flow. Before constructing the program, the problem statement is validated.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n- **Equation of State**: Perfect gas, $p = \\rho R T$.\n- **Gas Constant**: $R = 287.058 \\, \\mathrm{J\\,kg^{-1}\\,K^{-1}}$.\n- **Specific Heat ($c_p$) Polynomial**: $c_p(T) = a_0 + a_1 (T - T_{\\mathrm{ref}}) + a_2 (T - T_{\\mathrm{ref}})^2$, with $T_{\\mathrm{ref}} = 300 \\, \\mathrm{K}$, $a_0 = 1005.0 \\, \\mathrm{J\\,kg^{-1}\\,K^{-1}}$, $a_1 = 0.1 \\, \\mathrm{J\\,kg^{-1}\\,K^{-2}}$, $a_2 = 1\\times 10^{-4} \\, \\mathrm{J\\,kg^{-1}\\,K^{-3}}$.\n- **Related Properties**: $c_v(T) = c_p(T) - R$, $\\gamma(T) = c_p(T)/c_v(T)$.\n- **Flow Conditions**: Isentropic expansion ($ds=0$), implying conservation of stagnation enthalpy ($h_0 = h + u^2/2$).\n- **Acoustic Speed**: $a(T) = \\sqrt{\\gamma(T) R T}$.\n- **Models**: \n  1. Constant-property: $c_p$ and $\\gamma$ fixed at their values at the stagnation temperature $T_0$.\n  2. Temperature-dependent: $c_p(T)$ and $\\gamma(T)$ are functions of the local static temperature $T$.\n- **Task**: For given $(T_0, p_0, M)$, calculate exit static temperature $T$, static pressure $p$, and acoustic speed $a$ for both models.\n- **Output**: Relative differences $\\Delta T = (T_{\\mathrm{const}} - T_{\\mathrm{var}}) / T_{\\mathrm{var}}$, $\\Delta p = (p_{\\mathrm{const}} - p_{\\mathrm{var}}) / p_{\\mathrm{var}}$, $\\Delta a = (a_{\\mathrm{const}} - a_{\\mathrm{var}}) / a_{\\mathrm{var}}$.\n- **Test Cases**: \n  1. ($T_0=1000\\,\\mathrm{K}, p_0=200000\\,\\mathrm{Pa}, M=2.0$)\n  2. ($T_0=300\\,\\mathrm{K}, p_0=101325\\,\\mathrm{Pa}, M=0.05$)\n  3. ($T_0=1500\\,\\mathrm{K}, p_0=500000\\,\\mathrm{Pa}, M=5.0$)\n  4. ($T_0=600\\,\\mathrm{K}, p_0=300000\\,\\mathrm{Pa}, M=1.0$)\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientific Grounding**: The problem is well-founded in classical thermodynamics and gas dynamics. The use of a calorically imperfect gas model is a standard, physically accurate extension of the simpler perfect gas model. The governing equations ($p=\\rho R T$, $h_0 = h+u^2/2$, $ds=0$) are fundamental principles. The polynomial for $c_p(T)$ and its coefficients are physically realistic for air at elevated temperatures.\n- **Well-Posedness**: The problem is well-posed. The combination of stagnation conditions ($T_0, p_0$) and an exit Mach number ($M$) for a one-dimensional isentropic flow provides sufficient information to uniquely determine the thermodynamic state at the exit. The nonlinear equation for temperature in the variable-property model can be shown to have a unique, physically meaningful solution.\n- **Objectivity**: The problem is stated in precise, objective, and quantitative terms, free from ambiguity or subjective claims.\n- **Completeness and Consistency**: The problem is self-contained and internally consistent. All necessary data, constants, and governing laws are explicitly provided.\n- **Other Criteria**: The problem is not trivial, tautological, or ill-structured. It represents a meaningful engineering and physics problem.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A solution will be developed based on the provided principles.\n\n### Derivation of Governing Equations\n\nThe solution requires solving for the nozzle exit state using two different models for gas properties. Both models stem from the same fundamental laws.\n\n**1. Fundamental Relations**\nFor an adiabatic, reversible (isentropic) flow of a perfect gas from a stagnation state ($T_0, p_0$) to an exit state ($T, p, u, M$):\n- **Energy Conservation**: The stagnation enthalpy is constant: $h_0 = h(T) + u^2/2$. The enthalpy difference is $h_0 - h(T) = \\int_{T}^{T_0} c_p(\\tau) d\\tau$. The flow velocity is $u=Ma(T)$. The speed of sound is $a(T)=\\sqrt{\\gamma(T)RT}$. Combining these gives the central energy balance:\n$$ \\int_{T}^{T_0} c_p(\\tau) \\,d\\tau = \\frac{1}{2} M^2 a(T)^2 = \\frac{1}{2} M^2 \\gamma(T) R T $$\n- **Entropy Conservation**: The entropy is constant ($ds=0$). For a perfect gas, $ds = c_p(T) \\frac{dT}{T} - R \\frac{dp}{p}$. Integrating from the exit state to the stagnation state:\n$$ \\int_T^{T_0} c_p(\\tau) \\frac{d\\tau}{\\tau} - \\int_p^{p_0} R \\frac{dp'}{p'} = 0 \\implies R \\ln\\left(\\frac{p_0}{p}\\right) = \\int_T^{T_0} \\frac{c_p(\\tau)}{\\tau} d\\tau $$\nThis yields the pressure $p$ once $T$ is known:\n$$ p = p_0 \\exp\\left( -\\frac{1}{R} \\int_T^{T_0} \\frac{c_p(\\tau)}{\\tau} d\\tau \\right) $$\n\n**2. Constant-Property Model (Subscript \"const\")**\nHere, $c_p$ and $\\gamma$ are constants evaluated at $T_0$: $c_{p, \\mathrm{const}} = c_p(T_0)$ and $\\gamma_{\\mathrm{const}} = \\gamma(T_0)$.\n- **Temperature**: The energy integral simplifies to $c_{p,\\mathrm{const}}(T_0 - T)$. Using the relation $c_p = \\frac{\\gamma R}{\\gamma-1}$, the energy equation becomes algebraic and yields the well-known isentropic relation:\n$$ \\frac{T_0}{T_{\\mathrm{const}}} = 1 + \\frac{\\gamma_{\\mathrm{const}}-1}{2} M^2 \\implies T_{\\mathrm{const}} = T_0 \\left(1 + \\frac{\\gamma_{\\mathrm{const}}-1}{2} M^2\\right)^{-1} $$\n- **Pressure**: The entropy integral simplifies to $c_{p, \\mathrm{const}}\\ln(T_0/T)$. This yields the standard pressure relation:\n$$ \\frac{p_0}{p_{\\mathrm{const}}} = \\left(\\frac{T_0}{T_{\\mathrm{const}}}\\right)^{\\frac{c_{p,\\mathrm{const}}}{R}} = \\left(\\frac{T_0}{T_{\\mathrm{const}}}\\right)^{\\frac{\\gamma_{\\mathrm{const}}}{\\gamma_{\\mathrm{const}}-1}} \\implies p_{\\mathrm{const}} = p_0 \\left(1 + \\frac{\\gamma_{\\mathrm{const}}-1}{2} M^2\\right)^{-\\frac{\\gamma_{\\mathrm{const}}}{\\gamma_{\\mathrm{const}}-1}} $$\n- **Acoustic Speed**: Evaluated at the exit temperature $T_{\\mathrm{const}}$ using the constant $\\gamma_{\\mathrm{const}}$:\n$$ a_{\\mathrm{const}} = \\sqrt{\\gamma_{\\mathrm{const}} R T_{\\mathrm{const}}} $$\n\n**3. Temperature-Dependent Model (Subscript \"var\")**\nHere, $c_p(T)$ and $\\gamma(T)$ vary with temperature.\n- **Temperature**: The static temperature $T_{\\mathrm{var}}$ must be found by numerically solving the nonlinear energy equation:\n$$ f(T) = \\int_T^{T_0} c_p(\\tau) \\,d\\tau - \\frac{1}{2} M^2 \\gamma(T) R T = 0 $$\nThe integral can be evaluated analytically for higher precision. Let $H(T)=\\int c_p(T)dT$. The equation is $H(T_0) - H(T_{\\mathrm{var}}) - \\frac{1}{2} M^2 \\gamma(T_{\\mathrm{var}}) R T_{\\mathrm{var}} = 0$. This requires a numerical root-finding algorithm.\n- **Pressure**: Once $T_{\\mathrm{var}}$ is found, $p_{\\mathrm{var}}$ is computed from the entropy relation, again using an analytical integral for precision. Let $S(T) = \\int \\frac{c_p(T)}{T} dT$. Then:\n$$ p_{\\mathrm{var}} = p_0 \\exp\\left( -\\frac{1}{R} (S(T_0) - S(T_{\\mathrm{var}})) \\right) $$\n- **Acoustic Speed**: Evaluated at the local exit temperature $T_{\\mathrm{var}}$ using properties at that temperature:\n$$ a_{\\mathrm{var}} = \\sqrt{\\gamma(T_{\\mathrm{var}}) R T_{\\mathrm{var}}} $$\n\n**4. Integral Formulations**\nGiven $c_p(T) = a_0 + a_1(T - T_{\\mathrm{ref}}) + a_2(T - T_{\\mathrm{ref}})^2$:\n- **Antiderivative of $c_p(T)$**: $H(T) = \\int c_p(T)dT = a_0 T + \\frac{a_1}{2}(T-T_{\\mathrm{ref}})^2 + \\frac{a_2}{3}(T-T_{\\mathrm{ref}})^3$.\n- **Antiderivative of $c_p(T)/T$**: $S(T) = \\int \\frac{c_p(T)}{T}dT = (a_1 - 2a2 T_{\\mathrm{ref}})T + \\frac{a_2}{2}T^2 + (a_0 - a_1 T_{\\mathrm{ref}} + a_2 T_{\\mathrm{ref}}^2) \\ln(T)$.\n\nThese analytical forms will be used in the implementation to solve for the state variables in the temperature-dependent model.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import root_scalar\n\ndef solve():\n    \"\"\"\n    Computes deviations between constant-property and temperature-dependent\n    gas models for isentropic nozzle expansion.\n    \"\"\"\n    # Define physical and gas property constants\n    R = 287.058  # J/kg/K, mass-specific gas constant for dry air\n    T_ref = 300.0  # K, reference temperature for c_p polynomial\n    a0 = 1005.0  # J/kg/K\n    a1 = 0.1  # J/kg/K^2\n    a2 = 1.0e-4  # J/kg/K^3\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (1000.0, 200000.0, 2.0), # T0 (K), p0 (Pa), M\n        (300.0, 101325.0, 0.05),\n        (1500.0, 500000.0, 5.0),\n        (600.0, 300000.0, 1.0),\n    ]\n\n    # --- Helper functions for gas properties ---\n\n    def get_cp(T):\n        \"\"\"Computes specific heat at constant pressure c_p(T).\"\"\"\n        return a0 + a1 * (T - T_ref) + a2 * (T - T_ref)**2\n\n    def get_gamma(T):\n        \"\"\"Computes ratio of specific heats gamma(T).\"\"\"\n        cp = get_cp(T)\n        cv = cp - R\n        return cp / cv\n\n    def enthalpy_antiderivative(T):\n        \"\"\"Analytic antiderivative of c_p(T), H(T) = integral(c_p(T) dT).\"\"\"\n        return a0 * T + (a1 / 2.0) * (T - T_ref)**2 + (a2 / 3.0) * (T - T_ref)**3\n\n    def entropy_integral_antiderivative(T):\n        \"\"\"Analytic antiderivative of c_p(T)/T, S(T) = integral(c_p(T)/T dT).\"\"\"\n        c0_s = a0 - a1 * T_ref + a2 * T_ref**2\n        c1_s = a1 - 2 * a2 * T_ref\n        c2_s = a2\n        return c1_s * T + (c2_s / 2.0) * T**2 + c0_s * np.log(T)\n\n    results = []\n    for T0, p0, M in test_cases:\n        # --- (i) Constant-Property Model Calculation ---\n        gamma_const = get_gamma(T0)\n        \n        temp_ratio_const = 1.0 + (gamma_const - 1.0) / 2.0 * M**2\n        \n        T_const = T0 / temp_ratio_const\n        \n        p_const = p0 / (temp_ratio_const)**(gamma_const / (gamma_const - 1.0))\n        \n        a_const = np.sqrt(gamma_const * R * T_const)\n        \n        # --- (ii) Temperature-Dependent Model Calculation ---\n        \n        # Define the function f(T) = 0 to be solved for T_var\n        H_T0 = enthalpy_antiderivative(T0)\n        def temp_root_func(T):\n            if T = 0: return np.inf # Avoid math domain errors\n            H_T = enthalpy_antiderivative(T)\n            enthalpy_diff = H_T0 - H_T\n            kinetic_energy = 0.5 * M**2 * get_gamma(T) * R * T\n            return enthalpy_diff - kinetic_energy\n\n        # Solve for T_var using a robust root-finding method\n        # Bracket [epsilon, T0] is safe as T_var must be  T0 for M>0\n        sol = root_scalar(temp_root_func, bracket=[1e-3, T0], method='brentq')\n        T_var = sol.root\n\n        # Calculate p_var using the found T_var\n        S_T0 = entropy_integral_antiderivative(T0)\n        S_T_var = entropy_integral_antiderivative(T_var)\n        p_var = p0 * np.exp(-(S_T0 - S_T_var) / R)\n        \n        # Calculate a_var\n        gamma_var = get_gamma(T_var)\n        a_var = np.sqrt(gamma_var * R * T_var)\n\n        # --- Quantify Deviations ---\n        delta_T = (T_const - T_var) / T_var\n        delta_p = (p_const - p_var) / p_var\n        delta_a = (a_const - a_var) / a_var\n        \n        results.append([delta_T, delta_p, delta_a])\n\n    # Final print statement in the exact required format.\n    # The default string representation of a list of lists matches the required format.\n    print(f\"{results}\")\n\nsolve()\n```"
        }
    ]
}