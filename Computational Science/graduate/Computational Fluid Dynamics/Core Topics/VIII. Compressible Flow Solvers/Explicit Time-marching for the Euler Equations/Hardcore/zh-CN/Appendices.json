{
    "hands_on_practices": [
        {
            "introduction": "对于像欧拉方程这样的双曲型系统，显式时间推进格式的时间步长 $\\Delta t$ 受到严格的稳定性约束。这个被称为 Courant-Friedrichs-Lewy (CFL) 条件的约束，确保了数值计算的依赖区域能够包含物理上的依赖区域。此条件中的关键因素是信息在流体中传播的最快速度。本练习  将引导您从第一性原理出发，推导这些特征速度，并计算出最大信号速度，这是估算欧拉方程任何显式模拟的稳定时间步长所需的基本量。",
            "id": "3317302",
            "problem": "考虑由守恒形式的欧拉方程控制的一维无粘可压缩流，\n$$\\frac{\\partial \\boldsymbol{U}}{\\partial t} + \\frac{\\partial \\boldsymbol{F}(\\boldsymbol{U})}{\\partial x} = \\boldsymbol{0},$$\n其中守恒变量为\n$$\\boldsymbol{U} = \\begin{pmatrix} \\rho \\\\ \\rho u \\\\ E \\end{pmatrix},$$\n通量为\n$$\\boldsymbol{F}(\\boldsymbol{U}) = \\begin{pmatrix} \\rho u \\\\ \\rho u^{2} + p \\\\ u(E + p) \\end{pmatrix}.$$\n假设为量热完全气体，其比热比 $\\gamma$ 为常数，热力学封闭关系为 $p = (\\gamma - 1)\\left(E - \\tfrac{1}{2}\\rho u^{2}\\right)$。在显式时间推进格式中，柯朗-弗里德里希-列维 (CFL) 条件要求时间步长受限于系统特征速度（通量雅可比矩阵的特征值）的最大模。从控制方程和理想气体假设出发，通过线性化和等熵热力学论证，推导一维欧拉系统的相关特征速度，确定声速，并确定在密度为 $\\rho$、速度为 $u$、压力为 $p$、比热比为 $\\gamma$ 的均匀状态下的最大特征速度。\n\n计算在状态 $\\rho = 1.2$ $\\mathrm{kg\\, m^{-3}}$，$u = 50$ $\\mathrm{m\\, s^{-1}}$，$p = 101325$ $\\mathrm{Pa}$ 和 $\\gamma = 1.4$ 下该最大特征速度的值。用 $\\mathrm{m\\, s^{-1}}$ 单位表示最终答案，并四舍五入到四位有效数字。",
            "solution": "本题要求推导一维欧拉方程的特征速度，确定声速，求出最大特征速度，并针对给定的流动状态进行计算。分析将从将欧拉方程从其守恒形式转换为非守恒（拟线性）形式开始，以确定通量雅可比矩阵及其特征值。\n\n守恒形式的一维欧拉方程由下式给出：\n$$\n\\frac{\\partial \\boldsymbol{U}}{\\partial t} + \\frac{\\partial \\boldsymbol{F}(\\boldsymbol{U})}{\\partial x} = \\boldsymbol{0}\n$$\n其中守恒变量向量 $\\boldsymbol{U}$ 和通量向量 $\\boldsymbol{F}$ 为：\n$$\n\\boldsymbol{U} = \\begin{pmatrix} \\rho \\\\ \\rho u \\\\ E \\end{pmatrix}, \\quad \\boldsymbol{F} = \\begin{pmatrix} \\rho u \\\\ \\rho u^2 + p \\\\ u(E + p) \\end{pmatrix}\n$$\n该系统通过量热完全气体的状态方程封闭：\n$$\np = (\\gamma - 1)\\left(E - \\frac{1}{2}\\rho u^2\\right)\n$$\n特征速度是通量雅可比矩阵 $\\boldsymbol{A} = \\frac{\\partial \\boldsymbol{F}}{\\partial \\boldsymbol{U}}$ 的特征值。直接计算该矩阵较为不便，更方便的方法是使用原始变量（如 $\\boldsymbol{W} = (\\rho, u, p)^T$）将系统转换为拟线性形式。该系统可以写作 $\\frac{\\partial \\boldsymbol{W}}{\\partial t} + \\boldsymbol{A}'(\\boldsymbol{W}) \\frac{\\partial \\boldsymbol{W}}{\\partial x} = \\boldsymbol{0}$，其中 $\\boldsymbol{A}'$ 的特征值与 $\\boldsymbol{A}$ 的特征值相同。\n\n我们使用乘法法则展开守恒形式的三个标量方程：\n1. 质量守恒：\n$$\n\\frac{\\partial \\rho}{\\partial t} + \\frac{\\partial (\\rho u)}{\\partial x} = 0 \\implies \\frac{\\partial \\rho}{\\partial t} + u \\frac{\\partial \\rho}{\\partial x} + \\rho \\frac{\\partial u}{\\partial x} = 0\n$$\n该方程已经是用原始变量的导数表示的。\n\n2. 动量守恒：\n$$\n\\frac{\\partial (\\rho u)}{\\partial t} + \\frac{\\partial (\\rho u^2 + p)}{\\partial x} = 0 \\implies \\rho \\frac{\\partial u}{\\partial t} + u \\frac{\\partial \\rho}{\\partial t} + 2 \\rho u \\frac{\\partial u}{\\partial x} + u^2 \\frac{\\partial \\rho}{\\partial x} + \\frac{\\partial p}{\\partial x} = 0\n$$\n从质量方程代入 $\\frac{\\partial \\rho}{\\partial t}$：\n$$\n\\rho \\frac{\\partial u}{\\partial t} + u \\left(-u \\frac{\\partial \\rho}{\\partial x} - \\rho \\frac{\\partial u}{\\partial x}\\right) + 2 \\rho u \\frac{\\partial u}{\\partial x} + u^2 \\frac{\\partial \\rho}{\\partial x} + \\frac{\\partial p}{\\partial x} = 0\n$$\n$$\n\\rho \\frac{\\partial u}{\\partial t} - u^2 \\frac{\\partial \\rho}{\\partial x} - \\rho u \\frac{\\partial u}{\\partial x} + 2 \\rho u \\frac{\\partial u}{\\partial x} + u^2 \\frac{\\partial \\rho}{\\partial x} + \\frac{\\partial p}{\\partial x} = 0\n$$\n化简后得到非守恒动量方程：\n$$\n\\rho \\frac{\\partial u}{\\partial t} + \\rho u \\frac{\\partial u}{\\partial x} + \\frac{\\partial p}{\\partial x} = 0 \\implies \\frac{\\partial u}{\\partial t} + u \\frac{\\partial u}{\\partial x} + \\frac{1}{\\rho}\\frac{\\partial p}{\\partial x} = 0\n$$\n\n3. 能量守恒：\n$$\n\\frac{\\partial E}{\\partial t} + \\frac{\\partial (u(E+p))}{\\partial x} = 0 \\implies \\frac{\\partial E}{\\partial t} + u \\frac{\\partial E}{\\partial x} + (E+p) \\frac{\\partial u}{\\partial x} + u \\frac{\\partial p}{\\partial x} = 0\n$$\n为了用 $(\\rho, u, p)$ 表示该方程，我们使用 $E = \\frac{p}{\\gamma-1} + \\frac{1}{2}\\rho u^2$。其导数为：\n$$\n\\frac{\\partial E}{\\partial t} = \\frac{1}{\\gamma-1} \\frac{\\partial p}{\\partial t} + \\frac{1}{2} u^2 \\frac{\\partial \\rho}{\\partial t} + \\rho u \\frac{\\partial u}{\\partial t}\n$$\n$$\n\\frac{\\partial E}{\\partial x} = \\frac{1}{\\gamma-1} \\frac{\\partial p}{\\partial x} + \\frac{1}{2} u^2 \\frac{\\partial \\rho}{\\partial x} + \\rho u \\frac{\\partial u}{\\partial x}\n$$\n将这些导数代入展开的能量方程。这个过程很冗长，但最终会得到简化的非守恒能量方程：\n$$\n\\frac{\\partial p}{\\partial t} + u \\frac{\\partial p}{\\partial x} + \\gamma p \\frac{\\partial u}{\\partial x} = 0\n$$\n\n现在我们将非守恒方程组写成矩阵形式 $\\frac{\\partial \\boldsymbol{W}}{\\partial t} + \\boldsymbol{A}' \\frac{\\partial \\boldsymbol{W}}{\\partial x} = \\boldsymbol{0}$，其中 $\\boldsymbol{W} = (\\rho, u, p)^T$：\n$$\n\\begin{pmatrix} \\frac{\\partial \\rho}{\\partial t} \\\\ \\frac{\\partial u}{\\partial t} \\\\ \\frac{\\partial p}{\\partial t} \\end{pmatrix} + \\begin{pmatrix} u  \\rho  0 \\\\ 0  u  \\frac{1}{\\rho} \\\\ 0  \\gamma p  u \\end{pmatrix} \\begin{pmatrix} \\frac{\\partial \\rho}{\\partial x} \\\\ \\frac{\\partial u}{\\partial x} \\\\ \\frac{\\partial p}{\\partial x} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n特征速度 $\\lambda$ 是矩阵 $\\boldsymbol{A}' = \\begin{pmatrix} u  \\rho  0 \\\\ 0  u  \\frac{1}{\\rho} \\\\ 0  \\gamma p  u \\end{pmatrix}$ 的特征值。\n通过求解特征方程 $\\det(\\boldsymbol{A}' - \\lambda \\boldsymbol{I}) = 0$ 来找到特征值：\n$$\n\\det \\begin{pmatrix} u-\\lambda  \\rho  0 \\\\ 0  u-\\lambda  \\frac{1}{\\rho} \\\\ 0  \\gamma p  u-\\lambda \\end{pmatrix} = (u-\\lambda) \\left[ (u-\\lambda)^2 - (\\gamma p) \\left(\\frac{1}{\\rho}\\right) \\right] = 0\n$$\n这得到 $(u-\\lambda) \\left[ (u-\\lambda)^2 - \\frac{\\gamma p}{\\rho} \\right] = 0$。\n三个特征值，即特征速度，是：\n$$\n\\lambda_1 = u, \\quad \\lambda_2 = u + \\sqrt{\\frac{\\gamma p}{\\rho}}, \\quad \\lambda_3 = u - \\sqrt{\\frac{\\gamma p}{\\rho}}\n$$\n这就完成了问题的第一部分。\n\n接下来，我们确定声速 $c$。根据热力学定义，声速是等熵压缩波或稀疏波的传播速度，由 $c^2 = \\left( \\frac{\\partial p}{\\partial \\rho} \\right)_s$ 给出，其中 $s$ 是比熵。对于经历等熵过程的量热完全气体，$p = K\\rho^\\gamma$，其中 $K$ 是一个常数。压力对密度求导得到：\n$$\n\\left( \\frac{\\partial p}{\\partial \\rho} \\right)_s = \\frac{d}{d\\rho}(K\\rho^\\gamma) = K \\gamma \\rho^{\\gamma-1} = \\gamma \\frac{p}{\\rho^\\gamma} \\rho^{\\gamma-1} = \\frac{\\gamma p}{\\rho}\n$$\n因此，声速为 $c = \\sqrt{\\frac{\\gamma p}{\\rho}}$。\n现在，特征速度可以用流速 $u$ 和声速 $c$ 表示：\n$$\n\\lambda_1 = u, \\quad \\lambda_2 = u+c, \\quad \\lambda_3 = u-c\n$$\n这些分别代表了以速度 $u$ 平流的熵/接触间断，以及相对于流体以速度 $\\pm c$ 传播的声波。\n\n显式格式的柯朗-弗里德里希-列维 (CFL) 条件取决于特征速度的最大模，$\\lambda_{\\text{max\\_mag}} = \\max(|\\lambda_1|, |\\lambda_2|, |\\lambda_3|)$。即：\n$$\n\\lambda_{\\text{max\\_mag}} = \\max(|u|, |u+c|, |u-c|)\n$$\n由于 $c > 0$，可以证明 $|u+c|$ 或 $|u-c|$ 将是最大值。$|u|+c$ 这一项涵盖了这两种可能性。对于任意实数 $u$ 和 $c$，三角不等式表明 $|u+c| \\leq |u|+|c|$ 和 $|u-c| \\leq |u|+|c|$。\n如果 $u \\ge 0$，则 $|u+c| = u+c$。因为 $c>0$，所以 $u+c > u = |u|$ 且 $u+c > |u-c|$。\n如果 $u  0$，则 $|u-c| = |-u+c| = |u|+c$。因为 $c>0$，所以 $|u|+c>|u|$ 且 $|u|+c>|u+c|$。\n在所有情况下，最大模都由绝对流速与声速之和给出：\n$$\n\\lambda_{\\text{max\\_mag}} = |u| + c\n$$\n\n最后，我们为给定状态计算这个最大特征速度：$\\rho = 1.2\\,\\mathrm{kg\\,m^{-3}}$，$u = 50\\,\\mathrm{m\\,s^{-1}}$，$p = 101325\\,\\mathrm{Pa}$，以及 $\\gamma = 1.4$。所有单位均为国际单位制（SI）。\n首先，计算声速 $c$：\n$$\nc = \\sqrt{\\frac{\\gamma p}{\\rho}} = \\sqrt{\\frac{(1.4)(101325\\,\\mathrm{Pa})}{1.2\\,\\mathrm{kg\\,m^{-3}}}} = \\sqrt{\\frac{141855}{1.2}}\\,\\mathrm{m\\,s^{-1}} = \\sqrt{118212.5}\\,\\mathrm{m\\,s^{-1}} \\approx 343.8204\\,\\mathrm{m\\,s^{-1}}\n$$\n现在，计算最大特征速度的模：\n$$\n\\lambda_{\\text{max\\_mag}} = |u| + c = |50\\,\\mathrm{m\\,s^{-1}}| + 343.8204\\,\\mathrm{m\\,s^{-1}} = 50\\,\\mathrm{m\\,s^{-1}} + 343.8204\\,\\mathrm{m\\,s^{-1}} = 393.8204\\,\\mathrm{m\\,s^{-1}}\n$$\n将结果四舍五入到四位有效数字，得到 $393.8\\,\\mathrm{m\\,s^{-1}}$。用科学记数法表示为 $3.938 \\times 10^2\\,\\mathrm{m\\,s^{-1}}$。",
            "answer": "$$\\boxed{3.938 \\times 10^{2}}$$"
        },
        {
            "introduction": "确定了稳定的时间步长 $\\Delta t$ 后，下一步就是将解在时间上向前推进。虽然简单的前向欧拉方法易于实现，但像 Runge-Kutta 家族这样的高阶方法能提供更好的精度和稳定性。本练习  聚焦于一种广泛使用的格式的内部机理：三阶强稳定性保持（SSPRK）方法。您将应用这种多阶段方法来更新一个单元的状态，从而具体地理解在现代高分辨率格式中，守恒变量是如何从一个时间层级演化到下一个的。",
            "id": "3317315",
            "problem": "考虑理想气体的一维可压缩欧拉方程，其比热比 $\\gamma=1.4$，在均匀网格上通过守恒型有限体积法进行离散。在给定单元中，线方法半离散系统的形式为 $\\frac{d}{dt}\\boldsymbol{U}(t)=\\boldsymbol{L}(\\boldsymbol{U}(t))$，其中 $\\boldsymbol{U}=[\\rho,\\ \\rho u,\\ E]^{\\mathsf{T}}$ 是守恒变量：密度 $\\rho$、动量 $\\rho u$ 和单位体积总能量 $E$。总能量通过 $E=\\frac{p}{\\gamma-1}+\\frac{1}{2}\\rho u^{2}$ 与原始变量相关。\n\n在时间 $t^{n}$，单元中的原始状态为 $\\rho^{n}=1.0\\ \\text{kg}\\,\\text{m}^{-3}$，$u^{n}=100\\ \\text{m}\\,\\text{s}^{-1}$，$p^{n}=1.0\\times 10^{5}\\ \\text{Pa}$。使用这些值构成守恒态 $\\boldsymbol{U}^{n}$。已执行高分辨率通量计算，并且对于此单元，在使用具有三阶段和三阶精度的标准三阶强稳定性保持龙格-库塔 (SSPRK) 方法 (SSPRK(3,3)) 时，半离散残差 $\\boldsymbol{L}(\\cdot)$ 已在出现的相关阶段状态下进行了数值评估。得到的残差向量（以国际单位制单位/秒表示）如下：\n- 在初始状态 $\\boldsymbol{U}^{n}$ 处：$\\boldsymbol{L}^{n}=\\begin{pmatrix}-0.80\\\\ 95.0\\\\ -1.20\\times 10^{5}\\end{pmatrix}$。\n- 在第一阶段状态（待计算）处：$\\boldsymbol{L}^{(1)}=\\begin{pmatrix}-0.75\\\\ 92.0\\\\ -1.18\\times 10^{5}\\end{pmatrix}$。\n- 在第二阶段状态（待计算）处：$\\boldsymbol{L}^{(2)}=\\begin{pmatrix}-0.79\\\\ 90.5\\\\ -1.16\\times 10^{5}\\end{pmatrix}$。\n\n取时间步长为 $\\Delta t=1.0\\times 10^{-4}\\ \\text{s}$。从基本守恒和线方法公式出发，使用 SSPRK(3,3) 显式时间推进框架，计算此单元的第一阶段、第二阶段和最终更新的守恒态。然后，报告更新后的密度 $\\rho^{n+1}$。\n\n将您的最终数值答案四舍五入到六位有效数字。以 $\\text{kg}\\,\\text{m}^{-3}$ 为单位表示最终密度。",
            "solution": "该问题要求使用显式时间推进格式计算一个时间步长后流体单元的更新状态。控制方程是一维可压缩欧拉方程，已使用守恒型有限体积法在空间上进行了半离散化。这导致每个单元产生一个常微分方程组 (ODE)，称为线方法公式：\n$$ \\frac{d}{dt}\\boldsymbol{U}(t) = \\boldsymbol{L}(\\boldsymbol{U}(t)) $$\n此处，$\\boldsymbol{U} = [\\rho, \\rho u, E]^{\\mathsf{T}}$ 是守恒变量的向量：密度 $\\rho$、动量 $\\rho u$ 和单位体积总能量 $E$。项 $\\boldsymbol{L}(\\boldsymbol{U}(t))$ 代表半离散空间算子，或称残差。\n\n首先，我们必须根据给定的原始变量：$\\rho^{n}=1.0\\ \\text{kg}\\,\\text{m}^{-3}$，$u^{n}=100\\ \\text{m}\\,\\text{s}^{-1}$ 和 $p^{n}=1.0\\times 10^{5}\\ \\text{Pa}$，计算时间 $t^n$ 时的初始状态向量 $\\boldsymbol{U}^n$。给定的比热比为 $\\gamma=1.4$。\n\n$\\boldsymbol{U}^n$ 的分量是：\n1.  密度：$\\rho^n = 1.0$\n2.  动量：$(\\rho u)^n = \\rho^n u^n = 1.0 \\times 100 = 100.0$\n3.  总能量：$E^n = \\frac{p^n}{\\gamma-1} + \\frac{1}{2}\\rho^n (u^n)^2$。\n代入给定值：\n$$ E^n = \\frac{1.0\\times 10^{5}}{1.4-1} + \\frac{1}{2}(1.0)(100)^2 = \\frac{1.0\\times 10^{5}}{0.4} + \\frac{1}{2}(10000) = 2.5\\times 10^{5} + 5000 = 255000 $$\n因此，初始守恒态向量为：\n$$ \\boldsymbol{U}^n = \\begin{pmatrix} 1.0 \\\\ 100.0 \\\\ 2.55 \\times 10^5 \\end{pmatrix} $$\n该问题指定使用标准的三阶强稳定性保持龙格-库塔 (SSPRK(3,3)) 方法将解从 $\\boldsymbol{U}^n$推进到 $\\boldsymbol{U}^{n+1}$。时间步长为 $\\Delta t = 1.0\\times 10^{-4}\\ \\text{s}$。SSPRK(3,3) 格式分三阶段进行：\n\n阶段 1：\n$$ \\boldsymbol{U}^{(1)} = \\boldsymbol{U}^{n} + \\Delta t \\boldsymbol{L}(\\boldsymbol{U}^{n}) $$\n阶段 2：\n$$ \\boldsymbol{U}^{(2)} = \\frac{3}{4}\\boldsymbol{U}^{n} + \\frac{1}{4}\\left(\\boldsymbol{U}^{(1)} + \\Delta t \\boldsymbol{L}(\\boldsymbol{U}^{(1)})\\right) $$\n阶段 3 (最终更新)：\n$$ \\boldsymbol{U}^{n+1} = \\frac{1}{3}\\boldsymbol{U}^{n} + \\frac{2}{3}\\left(\\boldsymbol{U}^{(2)} + \\Delta t \\boldsymbol{L}(\\boldsymbol{U}^{(2)})\\right) $$\n问题提供了必要的已评估残差向量：\n$$ \\boldsymbol{L}^{n} = \\boldsymbol{L}(\\boldsymbol{U}^{n}) = \\begin{pmatrix}-0.80\\\\ 95.0\\\\ -1.20\\times 10^{5}\\end{pmatrix}, \\quad \\boldsymbol{L}^{(1)} = \\boldsymbol{L}(\\boldsymbol{U}^{(1)}) = \\begin{pmatrix}-0.75\\\\ 92.0\\\\ -1.18\\times 10^{5}\\end{pmatrix}, \\quad \\boldsymbol{L}^{(2)} = \\boldsymbol{L}(\\boldsymbol{U}^{(2)}) = \\begin{pmatrix}-0.79\\\\ 90.5\\\\ -1.16\\times 10^{5}\\end{pmatrix} $$\n\n我们继续进行每个阶段的计算。\n\n**计算第一阶段状态 $\\boldsymbol{U}^{(1)}$：**\n我们首先计算增量 $\\Delta t \\boldsymbol{L}^n$：\n$$ \\Delta t \\boldsymbol{L}^n = 1.0\\times 10^{-4} \\begin{pmatrix}-0.80\\\\ 95.0\\\\ -1.20\\times 10^{5}\\end{pmatrix} = \\begin{pmatrix}-0.00008\\\\ 0.0095\\\\ -12.0\\end{pmatrix} $$\n现在，我们求 $\\boldsymbol{U}^{(1)}$：\n$$ \\boldsymbol{U}^{(1)} = \\boldsymbol{U}^{n} + \\Delta t \\boldsymbol{L}^n = \\begin{pmatrix} 1.0 \\\\ 100.0 \\\\ 2.55 \\times 10^5 \\end{pmatrix} + \\begin{pmatrix}-0.00008\\\\ 0.0095\\\\ -12.0\\end{pmatrix} = \\begin{pmatrix} 0.99992 \\\\ 100.0095 \\\\ 254988.0 \\end{pmatrix} $$\n\n**计算第二阶段状态 $\\boldsymbol{U}^{(2)}$：**\n首先，我们计算括号内的项：$\\boldsymbol{U}^{(1)} + \\Delta t \\boldsymbol{L}^{(1)}$。\n$$ \\Delta t \\boldsymbol{L}^{(1)} = 1.0\\times 10^{-4} \\begin{pmatrix}-0.75\\\\ 92.0\\\\ -1.18\\times 10^{5}\\end{pmatrix} = \\begin{pmatrix}-0.000075\\\\ 0.0092\\\\ -11.8\\end{pmatrix} $$\n$$ \\boldsymbol{U}^{(1)} + \\Delta t \\boldsymbol{L}^{(1)} = \\begin{pmatrix} 0.99992 \\\\ 100.0095 \\\\ 254988.0 \\end{pmatrix} + \\begin{pmatrix}-0.000075\\\\ 0.0092\\\\ -11.8\\end{pmatrix} = \\begin{pmatrix} 0.999845 \\\\ 100.0187 \\\\ 254976.2 \\end{pmatrix} $$\n现在，我们应用 $\\boldsymbol{U}^{(2)}$ 的系数：\n$$ \\boldsymbol{U}^{(2)} = \\frac{3}{4} \\begin{pmatrix} 1.0 \\\\ 100.0 \\\\ 2.55 \\times 10^5 \\end{pmatrix} + \\frac{1}{4} \\begin{pmatrix} 0.999845 \\\\ 100.0187 \\\\ 254976.2 \\end{pmatrix} $$\n$$ \\boldsymbol{U}^{(2)} = \\begin{pmatrix} 0.75 \\\\ 75.0 \\\\ 191250.0 \\end{pmatrix} + \\begin{pmatrix} 0.24996125 \\\\ 25.004675 \\\\ 63744.05 \\end{pmatrix} = \\begin{pmatrix} 0.99996125 \\\\ 100.004675 \\\\ 254994.05 \\end{pmatrix} $$\n\n**计算最终更新状态 $\\boldsymbol{U}^{n+1}$：**\n与前一阶段类似，我们首先计算项 $\\boldsymbol{U}^{(2)} + \\Delta t \\boldsymbol{L}^{(2)}$。\n$$ \\Delta t \\boldsymbol{L}^{(2)} = 1.0\\times 10^{-4} \\begin{pmatrix}-0.79\\\\ 90.5\\\\ -1.16\\times 10^{5}\\end{pmatrix} = \\begin{pmatrix}-0.000079\\\\ 0.00905\\\\ -11.6\\end{pmatrix} $$\n$$ \\boldsymbol{U}^{(2)} + \\Delta t \\boldsymbol{L}^{(2)} = \\begin{pmatrix} 0.99996125 \\\\ 100.004675 \\\\ 254994.05 \\end{pmatrix} + \\begin{pmatrix}-0.000079\\\\ 0.00905\\\\ -11.6\\end{pmatrix} = \\begin{pmatrix} 0.99988225 \\\\ 100.013725 \\\\ 254982.45 \\end{pmatrix} $$\n最后，我们应用 $\\boldsymbol{U}^{n+1}$ 的系数：\n$$ \\boldsymbol{U}^{n+1} = \\frac{1}{3} \\begin{pmatrix} 1.0 \\\\ 100.0 \\\\ 2.55 \\times 10^5 \\end{pmatrix} + \\frac{2}{3} \\begin{pmatrix} 0.99988225 \\\\ 100.013725 \\\\ 254982.45 \\end{pmatrix} $$\n$$ \\boldsymbol{U}^{n+1} = \\begin{pmatrix} 1/3 \\\\ 100/3 \\\\ 85000.0 \\end{pmatrix} + \\begin{pmatrix} 0.666588166... \\\\ 66.67581666... \\\\ 169988.3 \\end{pmatrix} = \\begin{pmatrix} 0.999921499... \\\\ 100.0091499... \\\\ 254988.3 \\end{pmatrix} $$\n问题特别要求更新后的密度 $\\rho^{n+1}$，这是最终状态向量 $\\boldsymbol{U}^{n+1}$ 的第一个分量。\n$$ \\rho^{n+1} \\approx 0.9999215 $$\n问题要求将此值四舍五入到六位有效数字。前六位有效数字是 $9, 9, 9, 9, 2, 1$。第七位数字是 $5$，这要求对最后一位有效数字进行向上取整。\n因此，四舍五入后的值为 $0.999922$。",
            "answer": "$$\\boxed{0.999922}$$"
        },
        {
            "introduction": "CFL 条件对于数值稳定性至关重要，但它并不总是足以保证得到物理上有意义的解。在气体动力学模拟中，像密度 $\\rho$ 和压力 $p$ 这样的基本物理量必须保持正值。这个高级练习  揭示了一个关键挑战：即使满足 CFL 条件，一个前向欧拉步也可能产生非物理的负压力。您将学习如何计算出能够保持解的正性（positivity）的最大允许时间步长，这是开发能够处理强激波和稀疏波的稳健激波捕捉格式时的一个关键考量。",
            "id": "3317292",
            "problem": "考虑一维可压缩欧拉方程的守恒形式，其变量为质量密度 $\\rho$、动量 $m=\\rho u$ 和总能量 $E$。理想气体状态方程为 $p=(\\gamma-1)\\left(E-\\tfrac{1}{2}\\dfrac{m^{2}}{\\rho}\\right)$，比热比 $\\gamma=1.4$。在间距为 $\\Delta x=0.01$ 的均匀网格上，使用位于界面 $x_{i\\pm \\frac{1}{2}}$ 的局部Lax-Friedrichs (LLF，也称为Rusanov) 数值通量，通过前向欧拉步进进行有限体积离散，\n$$\nF_{i+\\frac{1}{2}}=\\frac{1}{2}\\left(F(U_{i})+F(U_{i+1})\\right)-\\frac{1}{2}s_{i+\\frac{1}{2}}\\left(U_{i+1}-U_{i}\\right),\n$$\n其中波速界为 $s_{i+\\frac{1}{2}}=\\max\\left(|u_{i}|+a_{i},\\,|u_{i+1}|+a_{i+1}\\right)$，且 $a=\\sqrt{\\gamma p/\\rho}$。守恒通量为 $F(U)=\\left[m,\\,\\dfrac{m^{2}}{\\rho}+p,\\, (E+p)u\\right]^{\\top}$。单元 $i$ 中的半离散更新为\n$$\n\\frac{dU_{i}}{dt}=-\\frac{1}{\\Delta x}\\left(F_{i+\\frac{1}{2}}-F_{i-\\frac{1}{2}}\\right),\n$$\n并且前向欧拉步使用 $U_{i}^{n+1}=U_{i}^{n}+\\Delta t\\,\\Phi_{i}$，其中 $\\Phi_{i}$ 是右端项。\n\n给定时间层 $n$ 的以下原始变量状态：\n- 单元 $i-1$：$\\rho_{i-1}^{n}=1.2$, $u_{i-1}^{n}=150$, $p_{i-1}^{n}=120000$。\n- 单元 $i$：$\\rho_{i}^{n}=1.0$, $u_{i}^{n}=200$, $p_{i}^{n}=100000$。\n- 单元 $i+1$：$\\rho_{i+1}^{n}=0.8$, $u_{i+1}^{n}=300$, $p_{i+1}^{n}=80000$。\n\n假设使用理想气体內能关系式 $E=\\dfrac{p}{\\gamma-1}+\\dfrac{1}{2}\\rho u^{2}$ 来转换为守恒变量。仅使用控制守恒律、理想气体关系式以及上面定义的带有局部波速界的LLF通量，确定最大的时间步长 $\\Delta t_{\\max}>0$，使得单次前向欧拉更新后，单元 $i$ 中的压力 $p_{i}^{n+1}$ 保持严格为正，即 $p_{i}^{n+1}>0$。最终答案以秒为单位表示，并四舍五入至四位有效数字。",
            "solution": "用户想要找到最大时间步长 $\\Delta t_{\\max}$，使得对给定初始状态进行单次前向欧拉更新后，单元 $i$ 中的压力 $p_i^{n+1} > 0$ 保持为正。\n\n该问题由一维可压缩理想气体的欧拉方程控制：\n$$\n\\frac{\\partial U}{\\partial t} + \\frac{\\partial F(U)}{\\partial x} = 0\n$$\n其中 $U = [\\rho, m, E]^{\\top}$ 是守恒变量（密度、动量、总能量）的向量，$F(U)$ 是通量向量。压力由理想气体状态方程 $p = (\\gamma-1)(E - \\frac{1}{2}\\frac{m^2}{\\rho})$ 给出，其中 $\\gamma=1.4$。\n\n数值格式是带有前向欧拉时间步的有限体积法：\n$$\nU_i^{n+1} = U_i^n + \\Delta t \\Phi_i = U_i^n - \\frac{\\Delta t}{\\Delta x} (F_{i+1/2} - F_{i-1/2})\n$$\n其中 $F_{i\\pm 1/2}$ 是局部Lax-Friedrichs (LLF) 数值通量。我们需要计算右端项，更新状态向量 $U_i$，并求解满足条件 $p_i^{n+1} > 0$ 的 $\\Delta t$。\n\n**1. 将原始变量转换为守恒变量**\n我们被给予了时间层 $n$ 的原始变量 $(\\rho, u, p)$。我们使用 $m = \\rho u$ 和 $E = \\frac{p}{\\gamma-1} + \\frac{1}{2}\\rho u^2$ 将它们转换为守恒变量 $U=[\\rho, m, E]^\\top$。我们还计算声速 $a = \\sqrt{\\gamma p / \\rho}$。给定 $\\gamma=1.4$，我们有 $\\gamma-1 = 0.4$。\n\n- **单元 $i-1$**：$\\rho_{i-1}=1.2$, $u_{i-1}=150$, $p_{i-1}=120000$.\n$m_{i-1} = 1.2 \\times 150 = 180$.\n$E_{i-1} = \\frac{120000}{0.4} + \\frac{1}{2}(1.2)(150)^2 = 300000 + 13500 = 313500$.\n$a_{i-1} = \\sqrt{\\frac{1.4 \\times 120000}{1.2}} = \\sqrt{140000} = 100\\sqrt{14}$.\n$U_{i-1} = [1.2, 180, 313500]^\\top$.\n\n- **单元 $i$**：$\\rho_i=1.0$, $u_i=200$, $p_i=100000$.\n$m_i = 1.0 \\times 200 = 200$.\n$E_i = \\frac{100000}{0.4} + \\frac{1}{2}(1.0)(200)^2 = 250000 + 20000 = 270000$.\n$a_i = \\sqrt{\\frac{1.4 \\times 100000}{1.0}} = \\sqrt{140000} = 100\\sqrt{14}$.\n$U_i = [1.0, 200, 270000]^\\top$.\n\n- **单元 $i+1$**：$\\rho_{i+1}=0.8$, $u_{i+1}=300$, $p_{i+1}=80000$.\n$m_{i+1} = 0.8 \\times 300 = 240$.\n$E_{i+1} = \\frac{80000}{0.4} + \\frac{1}{2}(0.8)(300)^2 = 200000 + 36000 = 236000$.\n$a_{i+1} = \\sqrt{\\frac{1.4 \\times 80000}{0.8}} = \\sqrt{140000} = 100\\sqrt{14}$.\n$U_{i+1} = [0.8, 240, 236000]^\\top$.\n\n**2. 计算界面波速和物理通量**\nLLF波速为 $s_{j+1/2} = \\max(|u_j|+a_j, |u_{j+1}|+a_{j+1})$。\n$s_{i-1/2} = \\max(150+100\\sqrt{14}, 200+100\\sqrt{14}) = 200+100\\sqrt{14}$.\n$s_{i+1/2} = \\max(200+100\\sqrt{14}, 300+100\\sqrt{14}) = 300+100\\sqrt{14}$.\n\n物理通量为 $F(U) = [\\rho u, \\rho u^2+p, (E+p)u]^\\top$。\n$F(U_{i-1}) = [180, 1.2(150)^2+120000, (313500+120000)150]^\\top = [180, 147000, 65025000]^\\top$.\n$F(U_i) = [200, 1.0(200)^2+100000, (270000+100000)200]^\\top = [200, 140000, 74000000]^\\top$.\n$F(U_{i+1}) = [240, 0.8(300)^2+80000, (236000+80000)300]^\\top = [240, 152000, 94800000]^\\top$.\n\n**3. 计算LLF数值通量**\nLLF通量为 $F_{j+1/2} = \\frac{1}{2}(F(U_j)+F(U_{j+1})) - \\frac{1}{2}s_{j+1/2}(U_{j+1}-U_j)$。\n\n- **界面 $i-1/2$**：\n$F(U_{i-1})+F(U_i) = [380, 287000, 139025000]^\\top$.\n$U_i-U_{i-1} = [-0.2, 20, -43500]^\\top$.\n$s_{i-1/2}(U_i-U_{i-1}) = (200+100\\sqrt{14})[-0.2, 20, -43500]^\\top = [-40-20\\sqrt{14}, 4000+2000\\sqrt{14}, -8700000-4350000\\sqrt{14}]^\\top$.\n$F_{i-1/2} = \\frac{1}{2}[380, 287000, 139025000]^\\top - \\frac{1}{2}[-40-20\\sqrt{14}, ..., ...]^\\top$.\n$F_{i-1/2} = [190, 143500, 69512500]^\\top - [-20-10\\sqrt{14}, 2000+1000\\sqrt{14}, -4350000-2175000\\sqrt{14}]^\\top$.\n$F_{i-1/2} = [210+10\\sqrt{14}, 141500-1000\\sqrt{14}, 73862500+2175000\\sqrt{14}]^\\top$.\n\n- **界面 $i+1/2$**：\n$F(U_i)+F(U_{i+1}) = [440, 292000, 168800000]^\\top$.\n$U_{i+1}-U_i = [-0.2, 40, -34000]^\\top$.\n$s_{i+1/2}(U_{i+1}-U_i) = (300+100\\sqrt{14})[-0.2, 40, -34000]^\\top = [-60-20\\sqrt{14}, 12000+4000\\sqrt{14}, -10200000-3400000\\sqrt{14}]^\\top$.\n$F_{i+1/2} = \\frac{1}{2}[440, 292000, 168800000]^\\top - \\frac{1}{2}[-60-20\\sqrt{14}, ..., ...]^\\top$.\n$F_{i+1/2} = [220, 146000, 84400000]^\\top - [-30-10\\sqrt{14}, 6000+2000\\sqrt{14}, -5100000-1700000\\sqrt{14}]^\\top$.\n$F_{i+1/2} = [250+10\\sqrt{14}, 140000-2000\\sqrt{14}, 89500000+1700000\\sqrt{14}]^\\top$.\n\n**4. 计算更新项 $\\Phi_i$**\n$\\Phi_i = -\\frac{1}{\\Delta x}(F_{i+1/2} - F_{i-1/2})$，其中 $\\Delta x=0.01$。\n$F_{i+1/2}-F_{i-1/2} = [40, -1500-1000\\sqrt{14}, 15637500-475000\\sqrt{14}]^\\top$.\n$\\Phi_i = -100 \\times [40, -1500-1000\\sqrt{14}, 15637500-475000\\sqrt{14}]^\\top$.\n$\\Phi_i = [\\Phi_{\\rho,i}, \\Phi_{m,i}, \\Phi_{E,i}]^\\top = [-4000, 150000+100000\\sqrt{14}, -1563750000+47500000\\sqrt{14}]^\\top$.\n\n**5. 建立并求解压力不等式**\n单元 $i$ 在时间 $n+1$ 的压力为 $p_i^{n+1} = (\\gamma-1)(E_i^{n+1} - \\frac{1}{2}\\frac{(m_i^{n+1})^2}{\\rho_i^{n+1}})$。\n条件 $p_i^{n+1} > 0$ 等价于 $E_i^{n+1} - \\frac{1}{2}\\frac{(m_i^{n+1})^2}{\\rho_i^{n+1}} > 0$。\n假设 $\\rho_i^{n+1} > 0$，此不等式变为 $2\\rho_i^{n+1}E_i^{n+1} - (m_i^{n+1})^2 > 0$。\n代入前向欧拉更新 $U_i^{n+1} = U_i^n + \\Delta t \\Phi_i$：\n$2(\\rho_i^n + \\Delta t \\Phi_{\\rho,i})(E_i^n + \\Delta t \\Phi_{E,i}) - (m_i^n + \\Delta t \\Phi_{m,i})^2 > 0$。\n这是一个关于 $\\Delta t$ 的二次不等式，形式为 $A(\\Delta t)^2 + B\\Delta t + C > 0$，其中：\n$A = 2\\Phi_{\\rho,i}\\Phi_{E,i} - (\\Phi_{m,i})^2$\n$B = 2(\\rho_i^n\\Phi_{E,i} + E_i^n\\Phi_{\\rho,i}) - 2m_i^n\\Phi_{m,i}$\n$C = 2\\rho_i^n E_i^n - (m_i^n)^2$\n\n使用计算出的值：\n$U_i^n = [1, 200, 270000]^\\top$.\n$\\Phi_i \\approx [-4000, 524166, -1.38602 \\times 10^9]^\\top$.\n\n$C = 2(1)(270000) - (200)^2 = 540000 - 40000 = 500000$.\n\n$B = 2(1 \\cdot \\Phi_{E,i} + 270000 \\cdot \\Phi_{\\rho,i}) - 2(200) \\cdot \\Phi_{m,i}$\n$B = 2 \\Phi_{E,i} + 540000 \\Phi_{\\rho,i} - 400 \\Phi_{m,i}$\n$B = 2(-1563750000 + 47500000\\sqrt{14}) + 540000(-4000) - 400(150000 + 100000\\sqrt{14})$\n$B = -3127500000 + 95000000\\sqrt{14} - 2160000000 - 60000000 - 40000000\\sqrt{14}$\n$B = -5347500000 + 55000000\\sqrt{14} \\approx -5.14171 \\times 10^9$.\n\n$A = 2(-4000)\\Phi_{E,i} - (\\Phi_{m,i})^2$\n$A = -8000(-1563750000 + 47500000\\sqrt{14}) - (150000 + 100000\\sqrt{14})^2$\n$A = 12510000000000 - 380000000000\\sqrt{14} - (2.25 \\times 10^{10} + 3 \\times 10^{10}\\sqrt{14} + 1.4 \\times 10^{11})$\n$A = 1.23475 \\times 10^{13} - 4.1 \\times 10^{11}\\sqrt{14} \\approx 1.08134 \\times 10^{13}$.\n\n我们有 $A>0, B0, C>0$。抛物线 $f(\\Delta t) = A(\\Delta t)^2 + B\\Delta t + C$ 开口向上且 $f(0)=C>0$。根由 $\\Delta t = \\frac{-B \\pm \\sqrt{B^2-4AC}}{2A}$ 给出。两个根都是正的。不等式 $f(\\Delta t) > 0$ 在 $0 \\le \\Delta t  \\Delta t_1$ 和 $\\Delta t > \\Delta t_2$ 时成立，其中 $\\Delta t_1$ 是较小的根。我们正在寻找从 $\\Delta t = 0$ 开始的最大的 $\\Delta t > 0$，所以我们需要较小的根。\n$\\Delta t_1 = \\frac{-B - \\sqrt{B^2-4AC}}{2A}$.\n\n$B^2 \\approx (-5.14171 \\times 10^9)^2 \\approx 2.64371 \\times 10^{19}$.\n$4AC \\approx 4 (1.08134 \\times 10^{13}) (5 \\times 10^5) \\approx 2.16268 \\times 10^{19}$.\n$B^2-4AC \\approx (2.64371 - 2.16268) \\times 10^{19} = 4.8103 \\times 10^{18}$.\n$\\sqrt{B^2-4AC} \\approx \\sqrt{4.8103 \\times 10^{18}} \\approx 2.19324 \\times 10^9$.\n\n$\\Delta t_1 = \\frac{5.14171 \\times 10^9 - 2.19324 \\times 10^9}{2 \\times 1.08134 \\times 10^{13}} = \\frac{2.94847 \\times 10^9}{2.16268 \\times 10^{13}} \\approx 1.36334 \\times 10^{-4}$.\n\n使得 $p_i^{n+1}>0$ 的最大时间步长 $\\Delta t_{\\max}$ 是区间 $(0, \\Delta t_1)$ 的上确界，也就是 $\\Delta t_1$。\n$\\Delta t_{\\max} = \\Delta t_1 \\approx 1.36334 \\times 10^{-4}$ s.\n\n我们还必须确保密度保持为正：\n$\\rho_i^{n+1} = \\rho_i^n + \\Delta t \\Phi_{\\rho,i} = 1 - 4000 \\Delta t > 0$.\n这意味着 $\\Delta t  \\frac{1}{4000} = 2.5 \\times 10^{-4}$ s。\n来自压力正性的条件（$1.36334 \\times 10^{-4}$ s）比来自密度正性的条件（$2.5 \\times 10^{-4}$ s）更严格。因此，该限制由压力条件决定。\n\n四舍五入到四位有效数字，$\\Delta t_{\\max} = 1.363 \\times 10^{-4}$ s。",
            "answer": "$$\n\\boxed{1.363 \\times 10^{-4}}\n$$"
        }
    ]
}