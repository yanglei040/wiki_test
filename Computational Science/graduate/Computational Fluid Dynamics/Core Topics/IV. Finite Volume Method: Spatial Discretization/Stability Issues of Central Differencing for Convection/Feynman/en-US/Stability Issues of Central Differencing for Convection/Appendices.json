{
    "hands_on_practices": [
        {
            "introduction": "This first practice explores the fundamental instability that arises when coupling a central difference spatial scheme with a standard explicit time integration method for a pure convection problem. We will perform a rigorous von Neumann stability analysis for the 1D linear advection equation to demonstrate why this seemingly intuitive pairing is unconditionally unstable. This analysis is a cornerstone of numerical methods, revealing that stability depends critically on the interaction between the spatial and temporal discretizations .",
            "id": "3365179",
            "problem": "Consider the one-dimensional linear advection equation $u_{t} + a\\,u_{x} = 0$ with constant advection speed $a > 0$ on a uniform grid with spacing $\\Delta x$, subject to periodic boundary conditions. Let $u_{j}(t)$ denote the semi-discrete approximation at grid index $j \\in \\mathbb{Z}$, obtained by discretizing the spatial derivative with the second-order central difference operator. Under a Fourier mode analysis $u_{j}(t) = \\hat{u}(t)\\,\\exp(i\\,\\theta\\,j)$, where $\\theta \\in [-\\pi,\\pi]$ is the nondimensional wavenumber, the semi-discrete operator has eigenvalues $\\lambda(\\theta) = -i\\,a\\,\\sin(\\theta)/\\Delta x$.\n\nThe time integration is performed by a two-stage, second-order explicit Runge–Kutta (RK) method applied to the semi-discrete system $d\\hat{u}/dt = \\lambda(\\theta)\\,\\hat{u}$. For a general explicit two-stage, second-order Runge–Kutta method, its one-step update on the linear test equation $y' = \\lambda\\,y$ can be written in the form $y^{n+1} = R(z)\\,y^{n}$ with $z = \\lambda\\,\\Delta t$, where $R(z)$ is the method’s stability function determined solely by the order conditions.\n\nStarting from the governing equation and the spatial semi-discretization, and using the definition of the Courant–Friedrichs–Lewy (CFL) number $\\nu = a\\,\\Delta t/\\Delta x$, derive the stability function $R(z)$ from the second-order Runge–Kutta order conditions and analyze its intersection with the imaginary axis $z = i\\,y$, where $y \\in \\mathbb{R}$. Impose the von Neumann stability requirement $|R(\\lambda(\\theta)\\,\\Delta t)| \\le 1$ for all $\\theta \\in [-\\pi,\\pi]$, and determine the maximum admissible value of the dimensionless CFL number $\\nu$ for which the inequality holds.\n\nExpress your final answer as a single real number, without units. No rounding is required.",
            "solution": "The problem asks for the maximum admissible Courant–Friedrichs–Lewy (CFL) number, $\\nu$, for the one-dimensional linear advection equation, $u_{t} + a\\,u_{x} = 0$, discretized using a second-order central difference scheme in space and a general two-stage, second-order explicit Runge–Kutta (RK) method for time integration.\n\nThe stability of this fully discrete scheme is determined by applying the time integration method to the semi-discrete system, which, under a Fourier analysis, is given by $\\frac{d\\hat{u}}{dt} = \\lambda(\\theta)\\,\\hat{u}$. Here, $\\hat{u}$ is the Fourier mode amplitude, and $\\lambda(\\theta)$ are the eigenvalues of the spatial discretization operator. The problem provides these eigenvalues as $\\lambda(\\theta) = -\\frac{i\\,a\\,\\sin(\\theta)}{\\Delta x}$.\n\nThe stability of an explicit time-stepping method applied to the linear test equation $y' = \\lambda y$ is governed by its stability function, $R(z)$, where $z = \\lambda \\Delta t$. The scheme is stable if the amplification factor $g = R(z)$ satisfies $|g| \\le 1$. For our system, this von Neumann stability requirement translates to $|R(\\lambda(\\theta)\\,\\Delta t)| \\le 1$ for all nondimensional wavenumbers $\\theta \\in [-\\pi, \\pi]$.\n\nOur first step is to derive the stability function $R(z)$ for any two-stage, second-order explicit RK method. A general two-stage explicit RK method for the ODE $y' = f(y)$ is given by:\n$$k_1 = f(y^n)$$\n$$k_2 = f(y^n + \\alpha_{21} \\Delta t k_1)$$\n$$y^{n+1} = y^n + \\Delta t (b_1 k_1 + b_2 k_2)$$\nwhere $\\alpha_{21}$, $b_1$, and $b_2$ are the method's coefficients. For the linear test equation $y'=\\lambda y$, we have $f(y) = \\lambda y$. The stages become:\n$$k_1 = \\lambda y^n$$\n$$k_2 = \\lambda(y^n + \\alpha_{21} \\Delta t (\\lambda y^n)) = \\lambda y^n(1 + \\alpha_{21} \\lambda \\Delta t)$$\nThe one-step update is:\n$$y^{n+1} = y^n + \\Delta t (b_1 (\\lambda y^n) + b_2 (\\lambda y^n(1 + \\alpha_{21} \\lambda \\Delta t)))$$\n$$y^{n+1} = y^n \\left(1 + (b_1+b_2)\\lambda \\Delta t + b_2 \\alpha_{21} (\\lambda \\Delta t)^2\\right)$$\nThe stability function $R(z)$ is the amplification factor, where $z = \\lambda \\Delta t$:\n$$R(z) = 1 + (b_1+b_2)z + b_2 \\alpha_{21} z^2$$\nFor an RK method to be second-order accurate, its coefficients must satisfy the order conditions. The conditions for second-order are:\n$$ b_1 + b_2 = 1 $$\n$$ b_2 \\alpha_{21} = \\frac{1}{2} $$\nSubstituting these conditions into the expression for $R(z)$ uniquely determines the stability function for any two-stage, second-order explicit RK method:\n$$R(z) = 1 + z + \\frac{1}{2} z^2$$\n\nNext, we must find the region on the imaginary axis for which this method is stable. The eigenvalues of the spatial operator, $\\lambda(\\theta)$, are purely imaginary. Therefore, their product with $\\Delta t$, which is the argument $z$ of the stability function, is also purely imaginary. Let $z = iy$ for some real number $y$. We analyze the stability condition $|R(iy)| \\le 1$.\n$$R(iy) = 1 + (iy) + \\frac{1}{2}(iy)^2 = 1 + iy - \\frac{1}{2}y^2 = \\left(1 - \\frac{1}{2}y^2\\right) + i(y)$$\nThe squared magnitude of the amplification factor is:\n$$|R(iy)|^2 = \\left(1 - \\frac{1}{2}y^2\\right)^2 + y^2 = 1 - y^2 + \\frac{1}{4}y^4 + y^2 = 1 + \\frac{1}{4}y^4$$\nThe von Neumann stability condition $|R(iy)| \\le 1$ is equivalent to $|R(iy)|^2 \\le 1$.\n$$1 + \\frac{1}{4}y^4 \\le 1$$\nThis inequality simplifies to:\n$$\\frac{1}{4}y^4 \\le 0$$\nSince $y$ is a real number, $y^4$ is always non-negative. Therefore, the only way for this inequality to hold is if $y^4 = 0$, which implies $y=0$. This critical result shows that the stability region of any second-order explicit RK method intersects the imaginary axis only at the origin, $z=0$.\n\nFinally, we apply this finding to the specific problem. The argument of the stability function for our discretized system is:\n$$z(\\theta) = \\lambda(\\theta) \\Delta t = \\left(-\\frac{i\\,a\\,\\sin(\\theta)}{\\Delta x}\\right) \\Delta t = -i \\left(\\frac{a\\,\\Delta t}{\\Delta x}\\right) \\sin(\\theta)$$\nUsing the definition of the CFL number, $\\nu = \\frac{a\\,\\Delta t}{\\Delta x}$, we have:\n$$z(\\theta) = -i\\,\\nu\\,\\sin(\\theta)$$\nThe stability condition $|R(z(\\theta))| \\le 1$ must hold for all $\\theta \\in [-\\pi, \\pi]$.\nAs $\\theta$ varies over its domain, $\\sin(\\theta)$ spans the interval $[-1, 1]$. Consequently, the set of all values for $z(\\theta)$ is the segment on the imaginary axis from $-i\\nu$ to $i\\nu$.\n$$ \\{z(\\theta) \\mid \\theta \\in [-\\pi, \\pi]\\} = [-i\\nu, i\\nu] $$\nFor the scheme to be stable, this entire interval must lie within the stability region of the time-stepping method. We have already established that the stability region along the imaginary axis is the single point $\\{0\\}$. Therefore, we must satisfy the condition:\n$$[-i\\nu, i\\nu] \\subseteq \\{0\\}$$\nThis inclusion is only possible if the interval itself is just the point $\\{0\\}$, which requires its length to be zero. This means $\\nu$ must be equal to $0$.\n\nAny non-zero CFL number $\\nu > 0$ will produce non-zero eigenvalues (e.g., for $\\theta = \\frac{\\pi}{2}$, $z = -i\\nu$), for which $|R(-i\\nu)|^2 = 1 + \\frac{1}{4}\\nu^4 > 1$, indicating instability. Thus, the scheme is unconditionally unstable for any positive advection speed and time step.\n\nThe maximum admissible value of the CFL number $\\nu$ for which the stability inequality holds is $0$.",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "Having established that common explicit schemes like Runge-Kutta can fail with central differencing, we now investigate an alternative: the leapfrog time-stepping method. This practice demonstrates that stable solutions for pure convection are indeed possible with central differencing, but they come with their own constraints and unique phenomena. By deriving the Courant-Friedrichs-Lewy (CFL) condition and uncovering the existence of a \"computational mode,\" you will gain crucial insight into the trade-offs inherent in designing stable numerical schemes for wave-like phenomena .",
            "id": "3365230",
            "problem": "Consider the one-dimensional linear advection equation $u_{t} + a\\,u_{x} = 0$ for a constant advection speed $a$ on a periodic domain, discretized on a uniform spatial grid $x_{j} = j\\,\\Delta x$ with time levels $t^{n} = n\\,\\Delta t$, where $j$ and $n$ are integers and $\\Delta x, \\Delta t > 0$. Approximate the temporal derivative at $t^{n}$ by a centered difference over $[t^{n-1}, t^{n+1}]$ and the spatial derivative at $t^{n}$ by a centered difference over $x$, and define the Courant number $r = a\\,\\Delta t/\\Delta x$. Using a von Neumann Fourier mode $u_{j}^{n} = \\hat{u}^{n}\\,\\exp(i\\,\\theta\\,j)$ with dimensionless wavenumber angle $\\theta$ measured in radians, derive the amplification factor $G(\\theta,r)$ associated with leapfrog time stepping combined with central spatial differencing. Then, require uniform stability in the sense $|G(\\theta,r)| \\leq 1$ for all $\\theta \\in [-\\pi,\\pi]$ and determine the largest admissible magnitude of $r$ (the maximum Courant number) that satisfies this bound. Finally, examine the roots obtained for $G(\\theta,r)$ and infer whether a computational (parasitic) mode exists based on their algebraic relation, explaining the mechanism of its appearance. Provide as your final output the closed-form expression for $G(\\theta,r)$ and the single real number equal to the maximal admissible Courant number. No rounding is required, and there are no physical units to report; angles must be interpreted in radians.",
            "solution": "The problem statement is a valid and well-posed problem in the field of numerical analysis for partial differential equations. It requests the stability analysis of the leapfrog time-stepping scheme combined with a second-order central difference for the spatial derivative, applied to the one-dimensional linear advection equation. All necessary information is provided, and the problem is scientifically grounded.\n\nThe one-dimensional linear advection equation is given by:\n$$\n\\frac{\\partial u}{\\partial t} + a \\frac{\\partial u}{\\partial x} = 0\n$$\nwhere $u(x, t)$ is the transported quantity and $a$ is the constant advection speed.\n\nThe problem specifies a discretization on a uniform grid with spacing $\\Delta x$ and time step $\\Delta t$, where $u_j^n$ approximates $u(x_j, t^n)$. The temporal derivative $\\frac{\\partial u}{\\partial t}$ is approximated at time level $n$ by a centered difference (leapfrog scheme):\n$$\n\\left(\\frac{\\partial u}{\\partial t}\\right)_j^n \\approx \\frac{u_j^{n+1} - u_j^{n-1}}{2\\Delta t}\n$$\nThe spatial derivative $\\frac{\\partial u}{\\partial x}$ is approximated at grid point $j$ by a centered difference:\n$$\n\\left(\\frac{\\partial u}{\\partial x}\\right)_j^n \\approx \\frac{u_{j+1}^n - u_{j-1}^n}{2\\Delta x}\n$$\nSubstituting these approximations into the advection equation yields the finite difference equation:\n$$\n\\frac{u_j^{n+1} - u_j^{n-1}}{2\\Delta t} + a \\frac{u_{j+1}^n - u_{j-1}^n}{2\\Delta x} = 0\n$$\nTo perform the von Neumann stability analysis, we substitute a single Fourier mode $u_j^n = \\hat{u}^n \\exp(i\\theta j)$ into the finite difference equation. Here, $\\theta = k\\Delta x$ is the dimensionless wavenumber, where $k$ is the wavenumber.\n$$\n\\frac{\\hat{u}^{n+1}\\exp(i\\theta j) - \\hat{u}^{n-1}\\exp(i\\theta j)}{2\\Delta t} + a \\frac{\\hat{u}^{n}\\exp(i\\theta (j+1)) - \\hat{u}^{n}\\exp(i\\theta (j-1))}{2\\Delta x} = 0\n$$\nWe can divide the entire equation by the common factor $\\exp(i\\theta j)$:\n$$\n\\frac{\\hat{u}^{n+1} - \\hat{u}^{n-1}}{2\\Delta t} + a \\hat{u}^{n} \\frac{\\exp(i\\theta) - \\exp(-i\\theta)}{2\\Delta x} = 0\n$$\nUsing the Euler identity $\\sin(\\theta) = \\frac{\\exp(i\\theta) - \\exp(-i\\theta)}{2i}$, the equation becomes:\n$$\n\\frac{\\hat{u}^{n+1} - \\hat{u}^{n-1}}{2\\Delta t} + a \\hat{u}^{n} \\frac{2i\\sin(\\theta)}{2\\Delta x} = 0\n$$\nMultiplying by $2\\Delta t$ and rearranging gives a recurrence relation for the amplitude $\\hat{u}^n$:\n$$\n\\hat{u}^{n+1} - \\hat{u}^{n-1} = -2i \\left(\\frac{a\\Delta t}{\\Delta x}\\right) \\sin(\\theta) \\hat{u}^n\n$$\nIntroducing the Courant number $r = a\\Delta t / \\Delta x$, we have:\n$$\n\\hat{u}^{n+1} + \\left(2ir\\sin(\\theta)\\right)\\hat{u}^n - \\hat{u}^{n-1} = 0\n$$\nThe amplification factor $G$ is defined such that $\\hat{u}^{n+1} = G \\hat{u}^n$. Since this is a two-step method, the recurrence relates three time levels. We thus assume a solution of the form $\\hat{u}^n = (\\hat{u}^0)G^n$. Substituting this into the recurrence relation gives:\n$$\n(\\hat{u}^0)G^{n+1} + \\left(2ir\\sin(\\theta)\\right)(\\hat{u}^0)G^n - (\\hat{u}^0)G^{n-1} = 0\n$$\nDividing by $(\\hat{u}^0)G^{n-1}$ (assuming $G \\neq 0$ and $\\hat{u}^0 \\neq 0$), we obtain the characteristic equation for the amplification factor $G$:\n$$\nG^2 + (2ir\\sin(\\theta))G - 1 = 0\n$$\nThis is a quadratic equation for $G$. We solve for its roots using the quadratic formula:\n$$\nG(\\theta,r) = \\frac{-2ir\\sin(\\theta) \\pm \\sqrt{(2ir\\sin(\\theta))^2 - 4(1)(-1)}}{2}\n$$\n$$\nG(\\theta,r) = \\frac{-2ir\\sin(\\theta) \\pm \\sqrt{-4r^2\\sin^2(\\theta) + 4}}{2}\n$$\n$$\nG(\\theta,r) = -ir\\sin(\\theta) \\pm \\sqrt{1 - r^2\\sin^2(\\theta)}\n$$\nThis provides the expression for the two amplification factors associated with the scheme.\n\nFor the scheme to be stable, the magnitude of the amplification factor must satisfy $|G(\\theta,r)| \\leq 1$ for all real $\\theta$. We analyze the term under the square root, $1 - r^2\\sin^2(\\theta)$.\n\nCase 1: $1 - r^2\\sin^2(\\theta) \\geq 0$.\nIn this case, the square root is real. Let $A = r\\sin(\\theta)$ and $B = \\sqrt{1 - r^2\\sin^2(\\theta)}$. Then $G = -iA \\pm B$. The magnitude of $G$ is:\n$$\n|G| = \\sqrt{(\\pm B)^2 + (-A)^2} = \\sqrt{B^2 + A^2} = \\sqrt{(1 - r^2\\sin^2(\\theta)) + (r^2\\sin^2(\\theta))} = \\sqrt{1} = 1\n$$\nSo, if $1 - r^2\\sin^2(\\theta) \\geq 0$, the scheme is neutrally stable, which satisfies the stability requirement $|G| \\leq 1$. For this condition to hold for all $\\theta \\in [-\\pi, \\pi]$, we must check the worst case, which occurs when $|\\sin(\\theta)|$ is maximal. The maximum value of $\\sin^2(\\theta)$ is $1$. Therefore, we must have:\n$$\n1 - r^2(1) \\geq 0 \\implies r^2 \\leq 1 \\implies |r| \\leq 1\n$$\nThis is the Courant-Friedrichs-Lewy (CFL) condition for this scheme. The largest admissible magnitude of the Courant number $r$ is $1$.\n\nCase 2: $1 - r^2\\sin^2(\\theta) < 0$.\nThis occurs if $|r| > 1$, for a range of $\\theta$ values. In this case, the term under the square root is negative. We can write $\\sqrt{1 - r^2\\sin^2(\\theta)} = i\\sqrt{r^2\\sin^2(\\theta) - 1}$. The amplification factors are:\n$$\nG = -ir\\sin(\\theta) \\pm i\\sqrt{r^2\\sin^2(\\theta) - 1} = i\\left(-r\\sin(\\theta) \\pm \\sqrt{r^2\\sin^2(\\theta) - 1}\\right)\n$$\nThe magnitude of $G$ is $|-r\\sin(\\theta) \\pm \\sqrt{r^2\\sin^2(\\theta) - 1}|$. Let us consider the root with the plus sign for the term in parentheses (this choice leads to amplification). Its magnitude is $|-r\\sin(\\theta) + \\sqrt{r^2\\sin^2(\\theta) - 1}|$. If we assume $r>0$, we can choose $\\theta$ such that $\\sin(\\theta)<0$ to make the magnitude greater than 1. For example, if $r>1$, let's pick $\\theta = -\\pi/2$, so $\\sin(\\theta)=-1$. Then $G=i(r \\pm \\sqrt{r^2 - 1})$. The magnitude is $|r \\pm \\sqrt{r^2 - 1}|$. For the plus sign, the magnitude is $r + \\sqrt{r^2-1}$. Since $r > 1$, we have $r^2 - 1 > 0$, so $r + \\sqrt{r^2 - 1} > r > 1$. Thus, one of the roots has a magnitude greater than $1$, leading to exponential growth and instability.\n\nTherefore, the stability of the scheme for all wavenumbers requires $|r| \\leq 1$. The largest admissible magnitude of $r$ is $1$.\n\nFinally, we analyze the roots to understand the computational mode. The characteristic equation $G^2 + (2ir\\sin(\\theta))G - 1 = 0$ yields two distinct roots for $G$, let's call them $G_1$ and $G_2$. The original PDE is first-order in time, so its evolution should depend only on one 'mode'. The numerical scheme, being a three-level (two-step) method, is second-order in the time index $n$, which inherently introduces a second, unphysical solution. This spurious solution is the computational (or parasitic) mode. The algebraic relation between the two roots can be found using Vieta's formulas on the characteristic polynomial: the product of the roots $G_1 G_2$ is the constant term, which is $-1$.\n$$\nG_1 G_2 = -1\n$$\nIn the stable regime ($|r| \\leq 1$), we showed that both roots have magnitude $|G_1| = |G_2| = 1$. One root, $G_1$, approximates the physical wave propagation. For small $r\\theta$, $G_1 \\approx 1 - ir\\theta - \\frac{1}{2}(r\\theta)^2 \\approx \\exp(-ir\\theta)$, which corresponds to the true solution's amplification factor. The other root is $G_2 = -1/G_1 \\approx -\\exp(ir\\theta)$. For small wavenumbers ($\\theta \\to 0$), $G_1 \\to 1$ and $G_2 \\to -1$. This means the computational mode manifests as a high-frequency oscillation in time, flipping sign at every time step ($(-1)^n$), which can contaminate the numerical solution. The existence of this second root is a direct consequence of approximating a first-order temporal derivative with a second-order centered difference.\n\nThe final answer requires the expression for $G(\\theta,r)$ and the maximum admissible Courant number.",
            "answer": "$$\n\\boxed{\\begin{gathered}\nG(\\theta,r) = -ir\\sin(\\theta) \\pm \\sqrt{1 - r^2\\sin^2(\\theta)} \\\\\n\\text{Maximal Courant Number: } 1\n\\end{gathered}}\n$$"
        },
        {
            "introduction": "We now transition from theoretical analysis to computational practice, exploring how these stability issues manifest in a tangible simulation. This exercise focuses on the steady-state convection-diffusion equation, where the balance between convection and diffusion is quantified by the grid Peclet number, $Pe$. By implementing a finite volume scheme and solving the resulting linear system, you will directly observe the non-physical oscillations predicted by theory when central differencing is used in a convection-dominated regime, bridging the gap between mathematical stability criteria and practical numerical outcomes .",
            "id": "3365178",
            "problem": "Consider the one-dimensional, steady, linear convection–diffusion boundary value problem for a passive scalar field $\\phi(x)$ on the domain $[0,1]$ with constant material properties and constant velocity. The continuous governing equation is the balance of diffusive and convective fluxes written in conservative form,\n$$\n-\\frac{\\mathrm{d}}{\\mathrm{d}x}\\left(\\Gamma \\frac{\\mathrm{d}\\phi}{\\mathrm{d}x}\\right) + \\frac{\\mathrm{d}}{\\mathrm{d}x}\\left(\\rho u \\, \\phi\\right) = 0,\n$$\nwhere $\\Gamma&gt;0$ is the diffusion coefficient, $\\rho&gt;0$ is the density, and $u$ is a constant velocity that may be positive or negative. Dirichlet boundary conditions $\\phi(0)=\\phi_L$ and $\\phi(1)=\\phi_R$ are imposed. All quantities are to be treated as dimensionless. You must work entirely in dimensionless units.\n\nYour task is to construct a numerical example using the cell-centered finite volume method on a uniform grid of $N$ equal control volumes (with cell faces at $x_i = i \\Delta x$, where $\\Delta x = 1/N$ and $i=0,1,\\ldots,N$) and central differencing for the convective flux that illustrates the well-known stability issue: for grid Peclet number with magnitude greater than $2$, i.e., $|Pe| &gt; 2$, the central differencing scheme produces non-monotone interior oscillations even though the resulting linear system remains solvable.\n\nStarting from conservation over each control volume, discretize the equation using:\n- A second-order central difference for the diffusive fluxes at faces.\n- A second-order central difference for the convective mass fluxes at faces.\n\nDerive the resulting tri-diagonal linear system for interior cell-center values $\\phi_1,\\ldots,\\phi_{N-1}$ in terms of the diffusion conductance $D=\\Gamma/\\Delta x$, the mass flux $F=\\rho u$, and the grid Peclet number $Pe = F \\Delta x/\\Gamma$. Do not introduce any artificial dissipation or upwinding; use pure central differencing for both fluxes. Assemble the linear system with the Dirichlet boundary conditions incorporated into the right-hand side.\n\nDefine a quantitative detector of non-monotone interior oscillations as follows. Given the computed discrete solution $\\{\\phi_i\\}_{i=0}^N$ including boundaries, declare that an interior oscillation is present if at least one of the following conditions holds:\n- There exists an index $j \\in \\{1,\\ldots,N-1\\}$ such that $\\phi_j$ lies strictly outside the closed interval with endpoints $\\phi_L$ and $\\phi_R$.\n- There exists an index $j \\in \\{1,\\ldots,N-2\\}$ such that the product $(\\phi_{j+1}-\\phi_j)(\\phi_j-\\phi_{j-1}) &lt; 0$, i.e., the first difference changes sign, indicating a discrete interior extremum.\n\nImplement a program that:\n- Constructs and solves the linear system for the central-differencing finite volume scheme on a uniform grid as described above, for each specified test case.\n- Reports, for each case, a boolean indicating whether a non-monotone interior oscillation is detected by the above criterion.\n\nUse the following five test cases, each specified by the tuple $(N, Pe, \\phi_L, \\phi_R)$:\n- Case $1$: $(N, Pe, \\phi_L, \\phi_R) = (10, 0.5, 1, 0)$.\n- Case $2$: $(N, Pe, \\phi_L, \\phi_R) = (10, 4.0, 1, 0)$.\n- Case $3$: $(N, Pe, \\phi_L, \\phi_R) = (40, 4.0, 1, 0)$.\n- Case $4$: $(N, Pe, \\phi_L, \\phi_R) = (10, 2.0, 1, 0)$.\n- Case $5$: $(N, Pe, \\phi_L, \\phi_R) = (10, -4.0, 0, 1)$.\n\nNotes:\n- Fix $\\Gamma=1$ and $\\rho=1$ to make all quantities dimensionless. Then $D = 1/\\Delta x$ and $F = Pe/\\Delta x$. The uniform mesh spacing is $\\Delta x = 1/N$.\n- You must use the sign of $Pe$ consistently to determine the sign of the mass flux $F$.\n- The final linear system must be assembled exactly from the central-differencing finite volume formulation; do not regularize, limit, or modify coefficients.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the above five cases. For example, the output should be of the form $[r_1,r_2,r_3,r_4,r_5]$ where each $r_k$ is a boolean indicating whether an interior oscillation was detected for case $k$. No angles or physical units occur in this problem; all quantities are dimensionless. The only required output is this one line in the specified format.",
            "solution": "The user wants to analyze the stability of a central-differencing finite volume scheme for a 1D steady convection-diffusion problem.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n\n*   **Governing Equation:** $-\\frac{\\mathrm{d}}{\\mathrm{d}x}\\left(\\Gamma \\frac{\\mathrm{d}\\phi}{\\mathrm{d}x}\\right) + \\frac{\\mathrm{d}}{\\mathrm{d}x}\\left(\\rho u \\, \\phi\\right) = 0$ on the domain $x \\in [0,1]$.\n*   **Parameters:** Diffusion coefficient $\\Gamma > 0$, density $\\rho > 0$, and velocity $u$ are constant. All quantities are dimensionless.\n*   **Boundary Conditions (BCs):** Dirichlet, $\\phi(0)=\\phi_L$ and $\\phi(1)=\\phi_R$.\n*   **Numerical Discretization:**\n    *   Finite volume method on a uniform grid of $N$ control volumes.\n    *   Grid nodes are at $x_i = i \\Delta x$ for $i=0, \\ldots, N$, with $\\Delta x = 1/N$. The interior unknowns are $\\phi_1, \\ldots, \\phi_{N-1}$. This implies a vertex-centered scheme where $\\phi_i$ is the value at node $x_i$.\n    *   A second-order central difference is specified for both diffusive and convective fluxes at control volume faces.\n*   **Definitions:**\n    *   Diffusion conductance: $D = \\Gamma / \\Delta x$.\n    *   Mass flux: $F = \\rho u$.\n    *   Grid Peclet number: $Pe = F \\Delta x / \\Gamma$.\n*   **Constants:** Fixed values $\\Gamma=1$ and $\\rho=1$ are specified for the implementation.\n*   **Oscillation Detection:** An interior oscillation is present if at least one of two conditions is met:\n    1.  An interior solution value $\\phi_j$ (for $j \\in \\{1, \\ldots, N-1\\}$) is strictly outside the range $[\\min(\\phi_L, \\phi_R), \\max(\\phi_L, \\phi_R)]$.\n    2.  A discrete interior extremum exists, defined as $(\\phi_{j+1}-\\phi_j)(\\phi_j-\\phi_{j-1}) < 0$ for some index $j \\in \\{1, \\ldots, N-2\\}$.\n*   **Test Cases:**\n    1.  $(N, Pe, \\phi_L, \\phi_R) = (10, 0.5, 1, 0)$\n    2.  $(N, Pe, \\phi_L, \\phi_R) = (10, 4.0, 1, 0)$\n    3.  $(N, Pe, \\phi_L, \\phi_R) = (40, 4.0, 1, 0)$\n    4.  $(N, Pe, \\phi_L, \\phi_R) = (10, 2.0, 1, 0)$\n    5.  $(N, Pe, \\phi_L, \\phi_R) = (10, -4.0, 0, 1)$\n\n**Step 2: Validate Using Extracted Givens**\n\n*   **Scientific Grounding:** The problem is based on the canonical 1D convection-diffusion equation and standard finite volume methods, a fundamental topic in computational fluid dynamics. The investigation of numerical stability as a function of the grid Peclet number is a classic and crucial subject. The problem is scientifically sound.\n*   **Well-Posed:** The continuous problem is a well-posed linear boundary value problem. The discretization leads to a tridiagonal linear system. For the specified schemes and parameters, this system is non-singular, guaranteeing a unique solution. The question is well-posed.\n*   **Objective:** The problem is formulated with precise mathematical definitions, quantitative criteria, and specific numerical parameters. It is free from subjectivity and ambiguity.\n*   **Completeness:** All necessary information, including the governing equation, boundary conditions, discretization scheme, parameter definitions, and test cases, is provided. The problem is self-contained.\n*   **Consistency:** There are no contradictions. The definitions of $D$, $F$, and $Pe$ are mutually consistent. The structure of the desired linear system (for $\\phi_1, \\ldots, \\phi_{N-1}$) is consistent with a vertex-centered grid interpretation, despite the \"cell-centered\" terminology, which is a common point of mild terminological confusion but does not create a formal contradiction in the setup.\n\n**Step 3: Verdict and Action**\n\nThe problem is valid. A reasoned solution will be developed.\n\n### Principle-Based Solution\n\nThe task is to derive and solve the discretized form of the 1D steady convection-diffusion equation and to check the solution for non-physical oscillations.\n\n**1. Discretization via Finite Volume Method**\nThe governing equation in conservative form is $\\frac{\\mathrm{d}}{\\mathrm{d}x} J(x) = 0$, where $J(x)$ is the total flux, given by $J = -\\Gamma \\frac{\\mathrm{d}\\phi}{\\mathrm{d}x} + F\\phi$, with $F = \\rho u$. This implies that the total flux is constant throughout the domain.\n\nWe use a vertex-centered finite volume approach. The domain $[0,1]$ is divided into $N$ segments by $N+1$ nodes at locations $x_i = i\\Delta x$ for $i=0, 1, \\ldots, N$, where $\\Delta x = 1/N$. The unknowns are the values $\\phi_i$ at the interior nodes $i=1, \\ldots, N-1$. The boundary values are given: $\\phi_0 = \\phi_L$ and $\\phi_N = \\phi_R$.\n\nWe integrate the governing equation over a control volume (CV) centered around an interior node $x_i$. The CV extends from face $w$ at $x_i - \\Delta x/2$ to face $e$ at $x_i + \\Delta x/2$.\n$$ \\int_{x_i - \\Delta x/2}^{x_i + \\Delta x/2} \\frac{\\mathrm{d}J}{\\mathrm{d}x} \\mathrm{d}x = 0 $$\n$$ J_e - J_w = 0 $$\nwhere $J_e$ and $J_w$ are the total fluxes at the east and west faces of the CV, respectively.\n\n**2. Flux Approximation using Central Differencing**\nThe fluxes at the faces are approximated using second-order central differences for both diffusion and convection.\n\nAt the east face $e$ (midway between nodes $i$ and $i+1$):\nThe diffusive flux is approximated as:\n$$ \\left(-\\Gamma \\frac{\\mathrm{d}\\phi}{\\mathrm{d}x}\\right)_e \\approx -\\Gamma \\frac{\\phi_{i+1} - \\phi_i}{\\Delta x} = -D(\\phi_{i+1} - \\phi_i) $$\nwhere $D=\\Gamma/\\Delta x$.\nThe convective flux requires the value of $\\phi$ at the face, which is found by linear interpolation:\n$$ (F\\phi)_e \\approx F \\phi_e = F \\frac{\\phi_i + \\phi_{i+1}}{2} $$\nThe total flux at face $e$ is:\n$$ J_e \\approx F \\frac{\\phi_i + \\phi_{i+1}}{2} - D(\\phi_{i+1} - \\phi_i) = \\left(\\frac{F}{2} + D\\right)\\phi_i - \\left(D - \\frac{F}{2}\\right)\\phi_{i+1} $$\n\nSimilarly, at the west face $w$ (midway between nodes $i-1$ and $i$):\n$$ J_w \\approx F \\frac{\\phi_{i-1} + \\phi_i}{2} - D(\\phi_i - \\phi_{i-1}) = \\left(\\frac{F}{2} - D\\right)\\phi_i + \\left(\\frac{F}{2} + D\\right)\\phi_{i-1} $$\n\n**3. Derivation of the Algebraic Equation**\nSubstituting the flux approximations into the balance equation $J_e - J_w = 0$:\n$$ \\left[\\left(\\frac{F}{2} + D\\right)\\phi_i - \\left(D - \\frac{F}{2}\\right)\\phi_{i+1}\\right] - \\left[\\left(\\frac{F}{2} - D\\right)\\phi_i + \\left(\\frac{F}{2} + D\\right)\\phi_{i-1}\\right] = 0 $$\nCollecting terms for $\\phi_{i-1}$, $\\phi_i$, and $\\phi_{i+1}$:\n$$ -\\left(D + \\frac{F}{2}\\right)\\phi_{i-1} + \\left(2D\\right)\\phi_i - \\left(D - \\frac{F}{2}\\right)\\phi_{i+1} = 0 $$\nTo express this in terms of the grid Peclet number, $Pe = F\\Delta x/\\Gamma = F/D$, we divide the entire equation by $D$:\n$$ -\\left(1 + \\frac{Pe}{2}\\right)\\phi_{i-1} + 2\\phi_i - \\left(1 - \\frac{Pe}{2}\\right\\phi_{i+1} = 0 $$\nThis algebraic equation relates the value at node $i$ to its immediate neighbors.\n\n**4. Assembly of the Linear System**\nThis equation holds for all interior nodes $i=1, \\ldots, N-1$. We assemble a tridiagonal linear system of the form $A\\vec{\\phi} = \\vec{b}$ for the vector of unknowns $\\vec{\\phi} = [\\phi_1, \\ldots, \\phi_{N-1}]^T$.\n\nThe matrix $A$ is an $(N-1) \\times (N-1)$ tridiagonal matrix with the following coefficients:\n-   Main diagonal ($d_i$): $2$\n-   Lower diagonal ($a_i$): $-\\left(1 + \\frac{Pe}{2}\\right)$\n-   Upper diagonal ($c_i$): $-\\left(1 - \\frac{Pe}{2}\\right) = \\frac{Pe}{2} - 1$\n\nThe boundary conditions $\\phi_0 = \\phi_L$ and $\\phi_N = \\phi_R$ are incorporated into the right-hand side vector $\\vec{b}$.\nFor the first equation ($i=1$):\n$$ 2\\phi_1 - \\left(1 - \\frac{Pe}{2}\\right)\\phi_2 = \\left(1 + \\frac{Pe}{2}\\right)\\phi_0 = \\left(1 + \\frac{Pe}{2}\\right)\\phi_L $$\nThus, $b_1 = (1 + Pe/2)\\phi_L$.\n\nFor the last equation ($i=N-1$):\n$$ -\\left(1 + \\frac{Pe}{2}\\right)\\phi_{N-2} + 2\\phi_{N-1} = \\left(1 - \\frac{Pe}{2}\\right)\\phi_N = \\left(1 - \\frac{Pe}{2}\\right)\\phi_R $$\nThus, $b_{N-1} = (1 - Pe/2)\\phi_R$.\n\nFor all other equations ($i=2, \\ldots, N-2$), the right-hand side is zero, $b_i = 0$.\n\n**5. Stability and Oscillations**\nThe central differencing scheme is known to be stable and produce monotonic solutions only when the matrix $A$ is diagonally dominant. This requires $|d_i| \\geq |a_i| + |c_i|$, which translates to:\n$$ |2| \\geq \\left|-\\left(1 + \\frac{Pe}{2}\\right)\\right| + \\left|-\\left(1 - \\frac{Pe}{2}\\right)\\right| $$\n$$ 2 \\geq \\left|1 + \\frac{Pe}{2}\\right| + \\left|1 - \\frac{Pe}{2}\\right| $$\nThis inequality holds only if $|Pe/2| \\leq 1$, or $|Pe| \\leq 2$. When $|Pe| > 2$, diagonal dominance is lost, and the coefficients of the neighboring nodes in the stencil can become negative, leading to non-physical, oscillatory solutions. The problem asks to demonstrate this behavior.\n\n**6. Computational Procedure**\nThe program will implement the following steps for each test case:\n1.  Given $N$, $Pe$, $\\phi_L$, and $\\phi_R$.\n2.  Construct the $(N-1) \\times (N-1)$ tridiagonal matrix $A$ and the RHS vector $\\vec{b}$ as derived above.\n3.  Solve the linear system $A\\vec{\\phi} = \\vec{b}$ to find the interior solution values $\\phi_1, \\ldots, \\phi_{N-1}$.\n4.  Create the full solution array $\\{\\phi_i\\}_{i=0}^N$ by prepending $\\phi_L$ and appending $\\phi_R$.\n5.  Apply the two specified criteria to detect oscillations:\n    *   Check if any interior $\\phi_j$ is strictly outside $[\\min(\\phi_L, \\phi_R), \\max(\\phi_L, \\phi_R)]$.\n    *   Check if $(\\phi_{j+1}-\\phi_j)(\\phi_j-\\phi_{j-1}) < 0$ for any $j \\in \\{1, \\ldots, N-2\\}$.\n6.  Report `True` if an oscillation is detected, and `False` otherwise.",
            "answer": "[False,True,True,False,True]"
        }
    ]
}