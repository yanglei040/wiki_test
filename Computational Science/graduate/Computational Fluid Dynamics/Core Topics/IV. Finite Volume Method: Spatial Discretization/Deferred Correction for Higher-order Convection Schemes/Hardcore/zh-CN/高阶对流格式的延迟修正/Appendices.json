{
    "hands_on_practices": [
        {
            "introduction": "本节练习将带您深入了解延迟修正通量的核心构建过程。我们将从最基本的原理出发，通过多项式插值方法手动构建一个高阶通量，并将其与简单的一阶迎风通量相结合，从而组装成最终的延迟修正通量。这项练习旨在揭示构成延迟修正法的基本要素——低阶通量、高阶通量和修正项——并阐明它们是如何协同工作的，为后续更复杂的应用打下坚实的基础 。",
            "id": "3306429",
            "problem": "考虑在有限体积法 (FVM) 中，均匀网格上被动标量的纯一维稳态对流。设对流速度为正常数，因此索引为 $i$ 和 $i+1$ 的控制体之间的面的迎风单元为单元 $i$。假设无量纲化后，密度与面面积的乘积为1，因此面对流通量等于速度乘以被输运的值。您需要应用延迟修正 (DC) 框架，在面 $i+1/2$ 处构造一个高阶面通量。\n\n从控制体上的积分守恒定律以及对流面通量定义为法向速度与标量在面上的值的乘积开始。对于低阶 (LO) 格式，当速度为正时使用一阶迎风格式。对于高阶 (HO) 格式，不要假设任何预先给定的公式；而是通过在均匀网格上拟合通过四个连续单元中心 $x_{i-1}$、$x_{i}$、$x_{i+1}$ 和 $x_{i+2}$ 处标量值的立方多项式来构造面上的值，然后计算该多项式在面位置 $x_{i+1/2}$ 处的值。使用这个结果来获得高阶面通量。\n\n在 DC 框架中，隐式地组合低阶贡献，并将高阶修正的一部分显式地加到右侧。设 DC 混合因子为 $\\beta = 0.8$。\n\n给定离散标量值 $\\phi_{i-1} = 2$、$\\phi_{i} = 3$、$\\phi_{i+1} = 5$ 和 $\\phi_{i+2} = 7$，以及一个正速度 $u = 2.4$，执行以下操作：\n\n- 推导并计算低阶面通量 $F^{LO}_{i+1/2}$、高阶面通量 $F^{HO}_{i+1/2}$ 和延迟修正项 $\\delta F_{i+1/2} = F^{HO}_{i+1/2} - F^{LO}_{i+1/2}$。\n- 明确说明在 DC 中哪一部分是隐式组合的，哪一部分是显式添加的，并根据给定数据计算它们的数值。\n- 计算最终的延迟修正面通量 $F^{DC}_{i+1/2} = F^{LO}_{i+1/2} + \\beta\\,\\delta F_{i+1/2}$。\n\n报告最终答案，即单一数值 $F^{DC}_{i+1/2}$。将您的答案四舍五入到 $4$ 位有效数字。由于通量已经如所述进行了无量纲化，因此最终答案中不包含单位。",
            "solution": "该问题被验证为具有科学依据、适定、客观和完整。所有必要的数据和定义都已提供，可得出唯一解。我们可以开始求解。\n\n该问题考虑了被动标量 $\\phi$ 的一维稳态纯对流，其受守恒定律支配：\n$$\n\\frac{d}{dx}(\\rho u \\phi) = 0\n$$\n在有限体积法 (FVM) 中，此方程在从面 $i-1/2$ 到面 $i+1/2$ 的控制体 (CV) 上积分，得到：\n$$\n(\\rho u A \\phi)_{i+1/2} - (\\rho u A \\phi)_{i-1/2} = 0\n$$\n其中 $A$ 是面面积。问题说明密度 $\\rho$ 和面面积 $A$ 的乘积为1，且速度 $u$ 是恒定的。因此，穿过一个面的对流通量为 $F = u\\phi$。对于控制体 $i$，离散化的方程为：\n$$\nF_{i+1/2} - F_{i-1/2} = 0\n$$\n我们被要求使用延迟修正 (DC) 框架计算单元 $i$ 和 $i+1$ 之间的面 $i+1/2$ 处的通量 $F_{i+1/2}$。给定的数据是速度 $u = 2.4$ (正) 和单元中心的标量值 $\\phi_{i-1} = 2$、$\\phi_{i} = 3$、$\\phi_{i+1} = 5$ 和 $\\phi_{i+2} = 7$。DC 混合因子为 $\\beta = 0.8$。\n\n首先，我们确定低阶 (LO) 面通量 $F^{LO}_{i+1/2}$。问题指定了一阶迎风格式。由于速度 $u$ 为正，流动方向从左到右，因此面 $i+1/2$ 的迎风单元是单元 $i$。因此，面上的标量值取自迎风单元的中心：\n$$\n\\phi^{LO}_{i+1/2} = \\phi_i\n$$\n那么，低阶通量为：\n$$\nF^{LO}_{i+1/2} = u \\cdot \\phi^{LO}_{i+1/2} = u \\phi_i\n$$\n代入给定的数值：\n$$\nF^{LO}_{i+1/2} = (2.4)(3) = 7.2\n$$\n\n接下来，我们确定高阶 (HO) 面通量 $F^{HO}_{i+1/2}$。这需要通过拟合一个通过四个单元中心 $x_{i-1}$、$x_i$、$x_{i+1}$ 和 $x_{i+2}$ 处标量值的立方多项式来找到面上的值 $\\phi^{HO}_{i+1/2}$，然后在面位置 $x_{i+1/2}$ 处计算此多项式的值。\n\n我们定义一个以 $x_i$ 为中心并由均匀网格间距 $\\Delta x$ 缩放的局部坐标系 $\\xi$：$\\xi = (x - x_i) / \\Delta x$。单元中心位于 $\\xi_{i-1}=-1$、$\\xi_i=0$、$\\xi_{i+1}=1$ 和 $\\xi_{i+2}=2$。面 $i+1/2$ 位于 $x_{i+1/2} = x_i + \\Delta x/2$，这对应于 $\\xi_{i+1/2} = 1/2$。\n\n我们使用拉格朗日插值法来找到多项式在 $\\xi = 1/2$ 处的值。插值结果是节点值的线性组合：\n$$\n\\phi^{HO}_{i+1/2} = L_{i-1}(1/2)\\phi_{i-1} + L_i(1/2)\\phi_i + L_{i+1}(1/2)\\phi_{i+1} + L_{i+2}(1/2)\\phi_{i+2}\n$$\n拉格朗日基多项式 $L_k(\\xi)$ 在节点 $\\{-1, 0, 1, 2\\}$ 的 $\\xi=1/2$ 处计算：\n$$\nL_{i-1}(1/2) = \\frac{(1/2 - 0)(1/2 - 1)(1/2 - 2)}{(-1 - 0)(-1 - 1)(-1 - 2)} = \\frac{(1/2)(-1/2)(-3/2)}{(-1)(-2)(-3)} = \\frac{3/8}{-6} = -\\frac{1}{16}\n$$\n$$\nL_i(1/2) = \\frac{(1/2 - (-1))(1/2 - 1)(1/2 - 2)}{(0 - (-1))(0 - 1)(0 - 2)} = \\frac{(3/2)(-1/2)(-3/2)}{(1)(-1)(-2)} = \\frac{9/8}{2} = \\frac{9}{16}\n$$\n$$\nL_{i+1}(1/2) = \\frac{(1/2 - (-1))(1/2 - 0)(1/2 - 2)}{(1 - (-1))(1 - 0)(1 - 2)} = \\frac{(3/2)(1/2)(-3/2)}{(2)(1)(-1)} = \\frac{-9/8}{-2} = \\frac{9}{16}\n$$\n$$\nL_{i+2}(1/2) = \\frac{(1/2 - (-1))(1/2 - 0)(1/2 - 1)}{(2 - (-1))(2 - 0)(2 - 1)} = \\frac{(3/2)(1/2)(-1/2)}{(3)(2)(1)} = \\frac{-3/8}{6} = -\\frac{1}{16}\n$$\n系数之和为 $-1/16 + 9/16 + 9/16 - 1/16 = 16/16 = 1$，符合预期。\n\n现在，我们代入给定的标量值来求 $\\phi^{HO}_{i+1/2}$：\n$$\n\\phi^{HO}_{i+1/2} = -\\frac{1}{16}\\phi_{i-1} + \\frac{9}{16}\\phi_i + \\frac{9}{16}\\phi_{i+1} - \\frac{1}{16}\\phi_{i+2}\n$$\n$$\n\\phi^{HO}_{i+1/2} = \\frac{1}{16}[-1(2) + 9(3) + 9(5) - 1(7)] = \\frac{1}{16}[-2 + 27 + 45 - 7] = \\frac{63}{16} = 3.9375\n$$\n那么，高阶通量为：\n$$\nF^{HO}_{i+1/2} = u \\cdot \\phi^{HO}_{i+1/2} = (2.4)\\left(\\frac{63}{16}\\right) = \\left(\\frac{12}{5}\\right)\\left(\\frac{63}{16}\\right) = \\left(\\frac{3}{5}\\right)\\left(\\frac{63}{4}\\right) = \\frac{189}{20} = 9.45\n$$\n延迟修正项 $\\delta F_{i+1/2}$ 是高阶通量和低阶通量之间的差值：\n$$\n\\delta F_{i+1/2} = F^{HO}_{i+1/2} - F^{LO}_{i+1/2} = 9.45 - 7.2 = 2.25\n$$\n\n在延迟修正框架中，总通量被建模为 $F = F^{LO} + \\text{correction}$。低阶通量项 $F^{LO}$ 被隐式处理，意味着它依赖于未知的解变量，并贡献于系统矩阵的主对角线和非对角线元素。修正项被显式处理，意味着它是根据已知值（例如，来自上一次迭代的值）计算的，并移到代数系统的右侧（源项）。\n问题指出，添加了高阶修正的一小部分 $\\beta$。因此，通量分解为：\n$$\nF_{i+1/2} = \\underbrace{F^{LO}_{i+1/2}}_{\\text{隐式}} + \\underbrace{\\beta(F^{HO}_{i+1/2} - F^{LO}_{i+1/2})}_{\\text{显式}} = \\underbrace{F^{LO}_{i+1/2}}_{\\text{隐式}} + \\underbrace{\\beta\\,\\delta F_{i+1/2}}_{\\text{显式}}\n$$\n对于面 $i+1/2$ 隐式组合的部分是 $F^{LO}_{i+1/2} = 7.2$。\n显式添加到源项的部分是 $\\beta\\,\\delta F_{i+1/2}$。其数值为：\n$$\n\\beta\\,\\delta F_{i+1/2} = (0.8)(2.25) = 1.8\n$$\n注意，此项对单元 $i$ 的源项贡献为负号，对单元 $i+1$ 的源项贡献为正号。\n\n最后，我们计算总的延迟修正面通量 $F^{DC}_{i+1/2}$：\n$$\nF^{DC}_{i+1/2} = F^{LO}_{i+1/2} + \\beta\\,\\delta F_{i+1/2} = 7.2 + 1.8 = 9.0\n$$\n问题要求答案四舍五入到 $4$ 位有效数字。因此，$9.0$ 写为 $9.000$。",
            "answer": "$$\n\\boxed{9.000}\n$$"
        },
        {
            "introduction": "在追求高精度的同时，我们必须警惕其潜在的陷阱。高阶格式在处理不连续或尖锐梯度时，常常会引入非物理的振荡，即过冲（overshoot）和下冲（undershoot），这违反了数值解应遵循的物理界限。本练习通过一个理想化的阶跃间断场景，从解析上精确地揭示了一个无限制的延迟修正格式是如何导致过冲的，从而深刻地展示了任何实用的高阶格式都必须面对和解决的关键挑战 。",
            "id": "3306415",
            "problem": "考虑均匀网格上的被动标量的一维线性平流方程，\n$$\n\\frac{\\partial \\phi}{\\partial t} + a \\frac{\\partial \\phi}{\\partial x} = 0,\n$$\n其速度为恒定的正值 $a>0$。在由整数 $i \\in \\mathbb{Z}$ 索引、具有均匀间距 $\\Delta x$、时间步长 $\\Delta t$ 和库朗数 $C = a \\Delta t / \\Delta x$ 的单元上，使用守恒有限体积法和显式欧拉时间积分。单元 $i$ 和 $i+1$ 之间的单元面上的法向对流通量采用无任何非线性限制器（即无限制修正）的延迟修正构造：在 $i+1/2$ 面上的平流状态为\n$$\n\\phi_{i+1/2} = \\phi^{\\text{UD}}_{i+1/2} + \\alpha \\left( \\phi^{\\text{HO}}_{i+1/2} - \\phi^{\\text{UD}}_{i+1/2} \\right),\n$$\n其中，对于 $a>0$ 的迎风值为 $\\phi^{\\text{UD}}_{i+1/2} = \\phi_i$，高阶候选值为二阶中心插值 $\\phi^{\\text{HO}}_{i+1/2} = \\tfrac{1}{2}(\\phi_i + \\phi_{i+1})$，而 $\\alpha \\ge 0$ 是一个可调的修正权重。单元 $i$ 的显式欧拉有限体积更新公式为\n$$\n\\phi_i^{n+1} = \\phi_i^n - C \\left( \\phi_{i+1/2}^n - \\phi_{i-1/2}^n \\right),\n$$\n其中 $C \\in (0,1]$ 以保证迎风基准格式的数值稳定性。\n\n在时间层 $n$ 构造一个尖锐间断，其局部特征由以下值描述\n$$\n\\phi_{i-1}^n = 1,\\quad \\phi_i^n = 1,\\quad \\phi_{i+1}^n = 0,\\quad \\phi_{i+2}^n = 0,\n$$\n这对应于一个向右移动的单位阶跃。对于此配置，离散极值原理要求在 $i$ 处的更新解满足 $\\phi_i^{n+1} \\le \\max(\\phi_{i-1}^n,\\phi_i^n) = 1$。然而，无限制的高阶修正可能会违反此界限。您的任务是，对于单个显式欧拉步，计算单元 $i$ 处相对于上游最大值 $1$ 的过冲幅度，其定义为\n$$\n\\delta(\\alpha,C) = \\max\\left( 0,\\; \\phi_i^{n+1} - 1 \\right),\n$$\n对于不同的 $(\\alpha,C)$ 对。\n\n从上述守恒律和定义出发，推导一个算法，仅使用所描述的局部模板 $\\{i-1,i,i+1,i+2\\}$ 来评估单步的 $\\delta(\\alpha,C)$。将此算法实现为一个程序，为以下 $(\\alpha,C)$ 值的测试套件计算 $\\delta(\\alpha,C)$：\n- 测试 1：$\\alpha = 0$, $C = 0.8$。\n- 测试 2：$\\alpha = 0.5$, $C = 0.8$。\n- 测试 3：$\\alpha = 1$, $C = 0.8$。\n- 测试 4：$\\alpha = 1.5$, $C = 0.8$。\n- 测试 5：$\\alpha = 1$, $C = 1$。\n- 测试 6：$\\alpha = 2$, $C = 0.5$。\n\n所有量均为无量纲；不需要物理单位。您的程序应生成单行输出，其中包含六个测试的过冲幅度，格式为方括号内以逗号分隔的十进制数列表（例如 $[x_1,x_2,x_3,x_4,x_5,x_6]$），并按上述测试的顺序排列。每个条目的输出类型必须是浮点数。确保计算直接遵循所述的更新规则和面构造方法，不添加额外的限制器或人工耗散。",
            "solution": "该问题是适定的、有科学依据的，并包含了唯一解所需的所有必要信息。因此，我们可以进行推导。\n\n目标是根据给定的初始数据和数值格式，推导单个显式欧拉时间步后更新的单元值 $\\phi_i^{n+1}$ 的解析表达式，并进而推导过冲幅度 $\\delta(\\alpha,C)$。\n\n单元平均值 $\\phi_i$ 的有限体积更新规则由下式给出：\n$$\n\\phi_i^{n+1} = \\phi_i^n - C \\left( \\phi_{i+1/2}^n - \\phi_{i-1/2}^n \\right)\n$$\n其中 $C = a \\Delta t / \\Delta x$ 是库朗数，$\\phi_{j+1/2}^n$ 是在该时间步内穿过 $j+1/2$ 面的标量平流值。\n\n面值 $\\phi_{j+1/2}$ 使用延迟修正方法构造：\n$$\n\\phi_{j+1/2} = \\phi^{\\text{UD}}_{j+1/2} + \\alpha \\left( \\phi^{\\text{HO}}_{j+1/2} - \\phi^{\\text{UD}}_{j+1/2} \\right)\n$$\n这可以重写为迎风（UD）值和高阶（HO）值的加权混合：\n$$\n\\phi_{j+1/2} = (1-\\alpha) \\phi^{\\text{UD}}_{j+1/2} + \\alpha \\phi^{\\text{HO}}_{j+1/2}\n$$\n对于正速度 $a>0$，在 $j+1/2$ 面上的迎风值取自该面的迎风侧单元，即单元 $j$。\n$$\n\\phi^{\\text{UD}}_{j+1/2} = \\phi_j\n$$\n高阶候选值是共享该面的单元之间的二阶中心插值：\n$$\n\\phi^{\\text{HO}}_{j+1/2} = \\frac{1}{2}(\\phi_j + \\phi_{j+1})\n$$\n将这些定义代入混合面值表达式中，得到：\n$$\n\\phi_{j+1/2} = (1-\\alpha) \\phi_j + \\alpha \\left( \\frac{\\phi_j + \\phi_{j+1}}{2} \\right)\n$$\n简化此表达式可得到面值的模板：\n$$\n\\phi_{j+1/2} = \\left( (1-\\alpha) + \\frac{\\alpha}{2} \\right) \\phi_j + \\frac{\\alpha}{2} \\phi_{j+1} = \\left( 1 - \\frac{\\alpha}{2} \\right) \\phi_j + \\frac{\\alpha}{2} \\phi_{j+1}\n$$\n现在，我们将此通用面值公式应用于更新单元 $i$ 所需的特定面，即右侧的 $i+1/2$ 面和左侧的 $i-1/2$ 面。我们使用上标 $n$ 表示时间层。\n\n$i+1/2$ 面上的值为：\n$$\n\\phi_{i+1/2}^n = \\left( 1 - \\frac{\\alpha}{2} \\right) \\phi_i^n + \\frac{\\alpha}{2} \\phi_{i+1}^n\n$$\n$i-1/2$ 面上的值可以通过将索引 $j \\to i-1$ 找到：\n$$\n\\phi_{i-1/2}^n = \\left( 1 - \\frac{\\alpha}{2} \\right) \\phi_{i-1}^n + \\frac{\\alpha}{2} \\phi_i^n\n$$\n问题给出了时间层 $n$ 的局部初始状态：\n$$\n\\phi_{i-1}^n = 1, \\quad \\phi_i^n = 1, \\quad \\phi_{i+1}^n = 0\n$$\n我们将这些具体的数值代入面状态的表达式中：\n对于 $i+1/2$ 面：\n$$\n\\phi_{i+1/2}^n = \\left( 1 - \\frac{\\alpha}{2} \\right) (1) + \\frac{\\alpha}{2} (0) = 1 - \\frac{\\alpha}{2}\n$$\n对于 $i-1/2$ 面：\n$$\n\\phi_{i-1/2}^n = \\left( 1 - \\frac{\\alpha}{2} \\right) (1) + \\frac{\\alpha}{2} (1) = 1 - \\frac{\\alpha}{2} + \\frac{\\alpha}{2} = 1\n$$\n现在，我们将这些面值代回 $\\phi_i^{n+1}$ 的有限体积更新方程中：\n$$\n\\phi_i^{n+1} = \\phi_i^n - C \\left( \\phi_{i+1/2}^n - \\phi_{i-1/2}^n \\right)\n$$\n$$\n\\phi_i^{n+1} = 1 - C \\left( \\left(1 - \\frac{\\alpha}{2}\\right) - 1 \\right)\n$$\n简化括号内的表达式：\n$$\n\\phi_i^{n+1} = 1 - C \\left( -\\frac{\\alpha}{2} \\right)\n$$\n这就得到了单元 $i$ 中更新值的最终解析表达式：\n$$\n\\phi_i^{n+1} = 1 + \\frac{C\\alpha}{2}\n$$\n过冲幅度 $\\delta(\\alpha,C)$ 定义为 $\\phi_i^{n+1}$ 超出初始数据局部最大值 $1$ 的量。\n$$\n\\delta(\\alpha,C) = \\max\\left( 0, \\phi_i^{n+1} - 1 \\right)\n$$\n代入我们关于 $\\phi_i^{n+1}$ 的表达式：\n$$\n\\delta(\\alpha,C) = \\max\\left( 0, \\left(1 + \\frac{C\\alpha}{2}\\right) - 1 \\right) = \\max\\left( 0, \\frac{C\\alpha}{2} \\right)\n$$\n根据问题陈述，库朗数 $C$ 是正的（$C \\in (0,1]$），修正权重 $\\alpha$ 是非负的（$\\alpha \\ge 0$）。因此，乘积 $C\\alpha/2$ 总是非负的。\n过冲幅度的最终表达式为：\n$$\n\\delta(\\alpha,C) = \\frac{C\\alpha}{2}\n$$\n我们现在使用这个公式计算每个测试用例的过冲。\n- 测试 1：$(\\alpha, C) = (0, 0.8) \\implies \\delta = \\frac{0.8 \\times 0}{2} = 0.0$\n- 测试 2：$(\\alpha, C) = (0.5, 0.8) \\implies \\delta = \\frac{0.8 \\times 0.5}{2} = \\frac{0.4}{2} = 0.2$\n- 测试 3：$(\\alpha, C) = (1, 0.8) \\implies \\delta = \\frac{0.8 \\times 1}{2} = 0.4$\n- 测试 4：$(\\alpha, C) = (1.5, 0.8) \\implies \\delta = \\frac{0.8 \\times 1.5}{2} = \\frac{1.2}{2} = 0.6$\n- 测试 5：$(\\alpha, C) = (1, 1) \\implies \\delta = \\frac{1 \\times 1}{2} = 0.5$\n- 测试 6：$(\\alpha, C) = (2, 0.5) \\implies \\delta = \\frac{0.5 \\times 2}{2} = 0.5$\n得到的过冲幅度列表为 $[0.0, 0.2, 0.4, 0.6, 0.5, 0.5]$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import ...\n\ndef solve():\n    \"\"\"\n    Computes the overshoot magnitude delta(alpha, C) for a deferred correction\n    finite-volume scheme applied to the linear advection equation.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each tuple is of the form (alpha, C).\n    test_cases = [\n        (0.0, 0.8),   # Test 1\n        (0.5, 0.8),   # Test 2\n        (1.0, 0.8),   # Test 3\n        (1.5, 0.8),   # Test 4\n        (1.0, 1.0),   # Test 5\n        (2.0, 0.5),   # Test 6\n    ]\n\n    results = []\n    # The derived analytical expression for the overshoot is delta = C * alpha / 2.\n    # This comes from:\n    # phi_i^{n+1} = 1 + (C * alpha / 2)\n    # delta = max(0, phi_i^{n+1} - 1)\n    # Since C  0 and alpha = 0, the result is simply C * alpha / 2.\n    \n    for alpha, C in test_cases:\n        # Calculate the overshoot magnitude using the derived formula.\n        overshoot = (C * alpha) / 2.0\n        results.append(overshoot)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}