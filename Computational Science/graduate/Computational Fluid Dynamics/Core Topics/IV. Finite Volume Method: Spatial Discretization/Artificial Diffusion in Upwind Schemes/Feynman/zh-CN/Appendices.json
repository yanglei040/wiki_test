{
    "hands_on_practices": [
        {
            "introduction": "本练习将带您从头开始构建一阶迎风格式。您将推导出其守恒的通量差分形式，并运用修正方程分析来揭示其内在的数值耗散。这个过程对于理解人工扩散的来源至关重要，并为您提供了分析任何数值格式误差特性的基本工具。",
            "id": "3292605",
            "problem": "考虑一维线性平流方程 $u_{t} + a\\,u_{x} = 0$，其中波速 $a>0$ 为常数，定义在周期性区域上，并在均匀网格 $x_{i} = i\\,\\Delta x$ 和时间层 $t_{n} = n\\,\\Delta t$ 上进行离散化。定义库朗-弗里德里希斯-列维（CFL）数 $\\nu = a\\,\\Delta t/\\Delta x$。对于 $a>0$，显式一阶迎风法通过在迎风方向上进行差分，将网格中心值 $u_{i}^{n}$ 更新为 $u_{i}^{n+1}$。\n\n从这些基本原理出发，并且不引用任何预先给定的通量公式：\n- 推导更新的通量差分表示形式 $u_{i}^{n+1} = u_{i}^{n} - \\frac{\\Delta t}{\\Delta x}\\left(F_{i+1/2}^{\\,n} - F_{i-1/2}^{\\,n}\\right)$，并确定对于 $a>0$ 的相容数值通量 $F_{i+1/2}^{\\,n}$。\n- 仅使用此通量差分形式和周期性边界条件，通过计算 $M^{n+1} - M^{n}$（其中 $M^{n} = \\sum_{i} u_{i}^{n}\\,\\Delta x$）来证明总质量的离散守恒，并解释其守恒的机理。\n- 进行形式化的修正方程分析，保留至 $\\mathcal{O}(\\Delta x, \\Delta t)$ 阶项（含此阶项），以确定主导的人工扩散系数 $D_{\\mathrm{art}}$，使得数值解满足 $u_{t} + a\\,u_{x} = D_{\\mathrm{art}}\\,u_{xx} + \\text{高阶项}$。\n\n请以单个闭式符号表达式的形式给出 $D_{\\mathrm{art}}$ 的最终答案，用 $a$、$\\Delta x$ 和 $\\Delta t$ 表示。答案中不应包含单位，也不要进行数值计算。",
            "solution": "该问题陈述已经过验证，被认为是合理的。这是一个在偏微分方程数值分析领域（特别是计算流体力学）中标准的、适定的问题。它具有科学依据，是客观的，并包含了进行唯一且有意义的求解所需的所有信息。\n\n分析按要求分三部分进行：推导通量差分形式、证明离散质量守恒，以及进行修正方程分析以求得人工扩散系数。\n\n### 第一部分：通量差分形式的推导\n\n一维线性平流方程由下式给出：\n$$u_{t} + a\\,u_{x} = 0$$\n其中波速 $a$ 是一个正常数 ($a>0$)。\n\n我们在间距为 $\\Delta x$、时间步长为 $\\Delta t$ 的均匀网格上对此方程进行离散化。在网格点 $x_i = i\\,\\Delta x$ 和时间 $t_n = n\\,\\Delta t$ 上的解的值记为 $u_i^n$。\n\n对时间导数使用向前差分格式：\n$$u_t \\approx \\frac{u_{i}^{n+1} - u_{i}^{n}}{\\Delta t}$$\n\n对于空间导数 $u_x$，采用一阶迎风法。由于 $a > 0$，波从左向右传播，因此“迎风”方向是点 $x_i$ 的左侧。因此，我们使用一阶向后差分：\n$$u_x \\approx \\frac{u_{i}^{n} - u_{i-1}^{n}}{\\Delta x}$$\n\n将这些离散化代入偏微分方程，得到一阶迎风格式的有限差分方程：\n$$\\frac{u_{i}^{n+1} - u_{i}^{n}}{\\Delta t} + a\\left(\\frac{u_{i}^{n} - u_{i-1}^{n}}{\\Delta x}\\right) = 0$$\n\n重新整理以求解 $u_i^{n+1}$：\n$$u_{i}^{n+1} = u_{i}^{n} - \\frac{a\\,\\Delta t}{\\Delta x}\\left(u_{i}^{n} - u_{i-1}^{n}\\right)$$\n\n我们被要求将其表示为通量差分形式：\n$$u_{i}^{n+1} = u_{i}^{n} - \\frac{\\Delta t}{\\Delta x}\\left(F_{i+1/2}^{\\,n} - F_{i-1/2}^{\\,n}\\right)$$\n\n比较 $u_i^{n+1}$ 的两个表达式，我们可以令乘以 $\\frac{\\Delta t}{\\Delta x}$ 的项相等：\n$$F_{i+1/2}^{\\,n} - F_{i-1/2}^{\\,n} = a\\left(u_{i}^{n} - u_{i-1}^{n}\\right) = a\\,u_{i}^{n} - a\\,u_{i-1}^{n}$$\n\n通过观察，我们可以确定单元界面上的数值通量函数 $F$。在界面 $j+1/2$（单元 $j$ 和 $j+1$ 之间）的通量由下式给出：\n$$F_{j+1/2}^{\\,n} = a\\,u_{j}^{n}$$\n这是迎风通量，对于 $a>0$，它选择来自“上游”状态的值，即左侧状态 $u_j^n$。将此识别应用于我们的差分方程：\n- 单元 $i$ 右边界（界面 $i+1/2$）的通量为 $F_{i+1/2}^{\\,n} = a\\,u_{i}^{n}$。\n- 单元 $i$ 左边界（界面 $i-1/2$）的通量为 $F_{i-1/2}^{\\,n} = a\\,u_{i-1}^{n}$。\n\n将这些代入通量差分形式可以正确地重现该格式。因此，对于 $a>0$ 的一阶迎风格式，其相容的数值通量为 $F_{i+1/2}^{\\,n} = a\\,u_{i}^{n}$。\n\n### 第二部分：离散质量守恒\n\n在时间 $t_n$ 的总离散质量定义为 $M^{n} = \\sum_{i} u_{i}^{n}\\,\\Delta x$，其中求和遍历周期性区域中的所有网格单元。设该区域由 $N$ 个单元组成，索引从 $i=1$ 到 $N$。\n\n从时间 $t_n$ 到 $t_{n+1}$ 的总质量变化为：\n$$M^{n+1} - M^{n} = \\sum_i u_{i}^{n+1}\\,\\Delta x - \\sum_i u_{i}^{n}\\,\\Delta x = \\Delta x \\sum_i \\left(u_{i}^{n+1} - u_{i}^{n}\\right)$$\n\n使用第一部分推导的通量差分形式：\n$$u_{i}^{n+1} - u_{i}^{n} = -\\frac{\\Delta t}{\\Delta x}\\left(F_{i+1/2}^{\\,n} - F_{i-1/2}^{\\,n}\\right)$$\n\n将此代入质量变化的表达式中：\n$$M^{n+1} - M^{n} = \\Delta x \\sum_{i=1}^{N} \\left[-\\frac{\\Delta t}{\\Delta x}\\left(F_{i+1/2}^{\\,n} - F_{i-1/2}^{\\,n}\\right)\\right] = -\\Delta t \\sum_{i=1}^{N} \\left(F_{i+1/2}^{\\,n} - F_{i-1/2}^{\\,n}\\right)$$\n\n右侧的求和是一个裂项求和：\n$$\\sum_{i=1}^{N} \\left(F_{i+1/2}^{\\,n} - F_{i-1/2}^{\\,n}\\right) = (F_{3/2}^{\\,n} - F_{1/2}^{\\,n}) + (F_{5/2}^{\\,n} - F_{3/2}^{\\,n}) + \\dots + (F_{N+1/2}^{\\,n} - F_{N-1/2}^{\\,n})$$\n这可以简化为：\n$$\\sum_{i=1}^{N} \\left(F_{i+1/2}^{\\,n} - F_{i-1/2}^{\\,n}\\right) = F_{N+1/2}^{\\,n} - F_{1/2}^{\\,n}$$\n\n该区域是周期性的，这意味着网格点 $i=0$ 等价于 $i=N$，而 $i=N+1$ 等价于 $i=1$。因此，状态 $u_0^n = u_N^n$。通量 $F_{i+1/2}^{\\,n}$ 定义为 $a\\,u_i^n$。\n因此：\n-   $F_{N+1/2}^{\\,n} = a\\,u_{N}^{n}$\n-   $F_{1/2}^{\\,n} = a\\,u_{0}^{n}$\n\n由于周期性边界条件 $u_0^n = u_N^n$，我们有 $F_{1/2}^{\\,n} = F_{N+1/2}^{\\,n}$。该裂项求和的结果为零：\n$$\\sum_{i=1}^{N} \\left(F_{i+1/2}^{\\,n} - F_{i-1/2}^{\\,n}\\right) = a\\,u_{N}^{n} - a\\,u_{0}^{n} = 0$$\n\n因此，总质量的变化为零：\n$$M^{n+1} - M^{n} = -\\Delta t \\times 0 = 0$$\n这证明了 $M^{n+1} = M^n$，并且该格式在每个时间步都保持总质量守恒。\n\n守恒的机理是离散化的通量守恒形式。任何单元中量 $u$ 的变化都完全由穿过其边界的 $u$ 的净通量来解释。当对整个区域求和时，所有内部界面上的通量相互抵消。周期性边界条件确保了离开区域末端边界的通量与进入其起始边界的通量相同，从而导致完美的平衡和总积分量的净变化为零。\n\n### 第三部分：修正方程分析\n\n我们从离散更新方程开始：\n$$\\frac{u_{i}^{n+1} - u_{i}^{n}}{\\Delta t} + a \\frac{u_{i}^{n} - u_{i-1}^{n}}{\\Delta x} = 0$$\n\n为了找到修正方程，我们对 $u_i^{n+1}$ 和 $u_{i-1}^n$ 在点 $(x_i, t_n)$ 周围进行泰勒级数展开，假设 $u$ 是一个足够光滑的函数。令 $u(x_i, t_n)$ 及其导数记为 $u, u_t, u_x, u_{tt}, u_{xx}$ 等。\n\n对 $u_i^{n+1} = u(x_i, t_n + \\Delta t)$ 进行时间上的展开：\n$$u_i^{n+1} = u + \\Delta t\\, u_t + \\frac{(\\Delta t)^2}{2} u_{tt} + \\mathcal{O}(\\Delta t^3)$$\n\n对 $u_{i-1}^n = u(x_i - \\Delta x, t_n)$ 进行空间上的展开：\n$$u_{i-1}^n = u - \\Delta x\\, u_x + \\frac{(\\Delta x)^2}{2} u_{xx} - \\frac{(\\Delta x)^3}{6} u_{xxx} + \\mathcal{O}(\\Delta x^4)$$\n\n将这些展开式代入离散格式中：\n$$\\frac{1}{\\Delta t}\\left( \\Delta t\\, u_t + \\frac{(\\Delta t)^2}{2} u_{tt} + \\dots \\right) + \\frac{a}{\\Delta x}\\left( u - \\left(u - \\Delta x\\, u_x + \\frac{(\\Delta x)^2}{2} u_{xx} + \\dots \\right) \\right) = 0$$\n$$\\left( u_t + \\frac{\\Delta t}{2} u_{tt} + \\dots \\right) + \\frac{a}{\\Delta x}\\left( \\Delta x\\, u_x - \\frac{(\\Delta x)^2}{2} u_{xx} + \\dots \\right) = 0$$\n$$u_t + \\frac{\\Delta t}{2} u_{tt} + a\\, u_x - \\frac{a\\,\\Delta x}{2} u_{xx} + \\mathcal{O}(\\Delta t^2, (\\Delta x)^2) = 0$$\n\n重新整理各项得到“截断微分方程”：\n$$u_t + a\\, u_x = \\frac{a\\,\\Delta x}{2} u_{xx} - \\frac{\\Delta t}{2} u_{tt} + \\text{H.O.T.}$$\n其中 H.O.T. 代表高阶项（higher-order terms）。这个方程揭示了格式的截断误差。\n\n为了得到能更好地表示数值解行为的“修正方程”，我们必须消除高阶时间导数（如 $u_{tt}$），用空间导数来代替。我们通过对该方程本身反复求导并回代来实现这一点。\n从我们方程的最低阶近似（即原始偏微分方程）可知，$u_t = -a\\,u_x + \\mathcal{O}(\\Delta x, \\Delta t)$。\n对时间求导：\n$$u_{tt} = \\frac{\\partial}{\\partial t} (-a\\,u_x + \\dots) = -a\\,u_{xt} = -a\\,\\frac{\\partial}{\\partial x}(u_t)$$\n现在再次代入 $u_t = -a\\,u_x + \\dots$：\n$$u_{tt} = -a\\,\\frac{\\partial}{\\partial x}(-a\\,u_x + \\dots) = a^2 u_{xx} + \\mathcal{O}(\\Delta x, \\Delta t)$$\n\n现在，我们将这个 $u_{tt}$ 的表达式代回到截断微分方程中：\n$$u_t + a\\, u_x = \\frac{a\\,\\Delta x}{2} u_{xx} - \\frac{\\Delta t}{2} \\left(a^2 u_{xx} + \\mathcal{O}(\\Delta x, \\Delta t)\\right) + \\text{H.O.T.}$$\n$$u_t + a\\, u_x = \\frac{a\\,\\Delta x}{2} u_{xx} - \\frac{a^2 \\Delta t}{2} u_{xx} + \\text{H.O.T.}$$\n\n合并含有二阶空间导数 $u_{xx}$ 的项：\n$$u_t + a\\,u_x = \\left(\\frac{a\\,\\Delta x}{2} - \\frac{a^2 \\Delta t}{2}\\right) u_{xx} + \\text{H.O.T.}$$\n\n这就是修正方程，保留到二阶导数项。主导误差项具有扩散项 $D_{\\mathrm{art}}\\,u_{xx}$ 的形式。通过将我们的结果与目标形式 $u_t + a\\,u_x = D_{\\mathrm{art}}\\,u_{xx} + \\text{H.O.T.}$ 进行比较，我们确定人工扩散系数为：\n$$D_{\\mathrm{art}} = \\frac{a\\,\\Delta x}{2} - \\frac{a^2 \\Delta t}{2}$$\n这一项导致了一阶迎风格式固有的数值耗散。",
            "answer": "$$\\boxed{\\frac{a\\,\\Delta x}{2} - \\frac{a^{2}\\,\\Delta t}{2}}$$"
        },
        {
            "introduction": "在了解了迎风格式的数值扩散之后，我们现在将其与另一种经典的中心格式——Lax-Friedrichs 格式进行比较。本练习通过直接对比两种不同通量构造产生的数值误差，突显了数值方法设计中的权衡。它将加深您对格式的准确性与其通用性之间关系的理解。",
            "id": "3318493",
            "problem": "考虑一个关于被动标量的一维线性平流方程，\n$$\nu_{t} + a\\,u_{x} = 0,\n$$\n其平流速度 $a>0$ 为常数。该区域通过一个均匀网格进行离散化，空间步长为 $\\Delta x$，显式时间步长为 $\\Delta t$。一个守恒的有限体积法更新格式具有如下形式\n$$\nu_{i}^{n+1} = u_{i}^{n} - \\frac{\\Delta t}{\\Delta x}\\left(F_{i+\\frac{1}{2}}^{n} - F_{i-\\frac{1}{2}}^{n}\\right),\n$$\n其中 $F_{i\\pm\\frac{1}{2}}^{n}$ 是单元交界面上的数值通量。考虑两种通量选择：\n- 一阶迎风格式通量：对于 $a>0$，有 $F_{i+\\frac{1}{2}}^{n} = a\\,u_{i}^{n}$ 和 $F_{i-\\frac{1}{2}}^{n} = a\\,u_{i-1}^{n}$。\n- 原始 Lax–Friedrichs 格式通量：\n$$\nF_{i+\\frac{1}{2}}^{n} = \\frac{1}{2}\\big(a\\,u_{i}^{n} + a\\,u_{i+1}^{n}\\big) - \\frac{1}{2}\\frac{\\Delta x}{\\Delta t}\\big(u_{i+1}^{n} - u_{i}^{n}\\big),\n$$\n对于 $F_{i-\\frac{1}{2}}^{n}$，通过平移索引可得类似表达式。\n\n使用关于点 $(x_{i},t_{n})$ 的泰勒级数修正方程分析，并在右侧保留至二阶空间导数项，通过将离散更新格式与形如下式的等效连续方程进行匹配，定义每个格式的主阶数值耗散系数 $\\nu$\n$$\nu_{t} + a\\,u_{x} = \\nu\\,u_{xx} + \\text{更高阶项}.\n$$\n令 Courant–Friedrichs–Lewy (CFL) 数为 $C = \\dfrac{a\\,\\Delta t}{\\Delta x}$。推导两种格式的主阶数值耗散系数，然后计算其比值\n$$\nR(C) = \\frac{\\nu_{\\mathrm{LF}}}{\\nu_{\\mathrm{up}}},\n$$\n作为仅含 $C$ 的封闭形式表达式。以 $C$ 的单个解析表达式形式提供最终答案。在推导过程中，解释这两种通量所隐含的准确性和鲁棒性之间的权衡。最终表达式无需四舍五入，也不应包含单位。",
            "solution": "目标是推导应用于线性平流方程 $u_{t} + a\\,u_{x} = 0$（其中平流速度 $a > 0$）的一阶迎风格式和 Lax-Friedrichs 格式的主阶数值耗散系数。这通过修正方程分析来完成，该分析涉及将离散的有限体积更新格式展开为泰勒级数，以恢复该格式有效求解的连续偏微分方程。然后我们将计算这些系数的比值。\n\n有限体积更新格式由下式给出：\n$$\nu_{i}^{n+1} = u_{i}^{n} - \\frac{\\Delta t}{\\Delta x}\\left(F_{i+\\frac{1}{2}}^{n} - F_{i-\\frac{1}{2}}^{n}\\right)\n$$\n其中 $u_{i}^{n}$ 近似解 $u(x_i, t_n)$，$\\Delta x$ 是空间步长，$\\Delta t$ 是时间步长，$F$ 是数值通量。Courant–Friedrichs–Lewy (CFL) 数定义为 $C = \\frac{a\\,\\Delta t}{\\Delta x}$。\n\n首先，我们分析一阶迎风格式。对于 $a > 0$，迎风方向来自左侧，因此通量基于交界面左侧的单元平均值。\n通量由 $F_{i+\\frac{1}{2}}^{n} = a\\,u_{i}^{n}$ 和 $F_{i-\\frac{1}{2}}^{n} = a\\,u_{i-1}^{n}$ 给出。\n将它们代入有限体积更新公式：\n$$\nu_{i}^{n+1} = u_{i}^{n} - \\frac{\\Delta t}{\\Delta x}\\left(a\\,u_{i}^{n} - a\\,u_{i-1}^{n}\\right)\n$$\n使用 CFL 数 $C$ 的定义，上式简化为：\n$$\nu_{i}^{n+1} = u_{i}^{n} - C\\left(u_{i}^{n} - u_{i-1}^{n}\\right)\n$$\n为了进行修正方程分析，我们将每一项在点 $(x_{i}, t_{n})$ 周围展开为泰勒级数：\n$$\nu_{i}^{n+1} = u(x_i, t_n + \\Delta t) = u + \\Delta t\\,u_t + \\frac{(\\Delta t)^2}{2}u_{tt} + O((\\Delta t)^3)\n$$\n$$\nu_{i-1}^{n} = u(x_i - \\Delta x, t_n) = u - \\Delta x\\,u_x + \\frac{(\\Delta x)^2}{2}u_{xx} - \\frac{(\\Delta x)^3}{6}u_{xxx} + O((\\Delta x)^4)\n$$\n此处，$u$ 及其偏导数 $u_t, u_x, u_{tt}, \\dots$ 均在点 $(x_{i}, t_{n})$ 处取值。\n将这些展开式代入离散格式：\n$$\nu + \\Delta t\\,u_t + \\frac{(\\Delta t)^2}{2}u_{tt} + \\dots = u - C\\left(u - \\left(u - \\Delta x\\,u_x + \\frac{(\\Delta x)^2}{2}u_{xx} - \\dots\\right)\\right)\n$$\n$$\n\\Delta t\\,u_t + \\frac{(\\Delta t)^2}{2}u_{tt} + \\dots = -C\\left(\\Delta x\\,u_x - \\frac{(\\Delta x)^2}{2}u_{xx} + \\dots\\right)\n$$\n两边同除以 $\\Delta t$ 并代入 $C/\\Delta t = (a\\,\\Delta t/\\Delta x)/\\Delta t = a/\\Delta x$：\n$$\nu_t + \\frac{\\Delta t}{2}u_{tt} + \\dots = -\\frac{a}{\\Delta x}\\left(\\Delta x\\,u_x - \\frac{(\\Delta x)^2}{2}u_{xx} + \\dots\\right)\n$$\n$$\nu_t + \\frac{\\Delta t}{2}u_{tt} + \\dots = -a\\,u_x + \\frac{a\\,\\Delta x}{2}u_{xx} - \\dots\n$$\n整理以匹配目标形式 $u_t + a\\,u_x = \\nu\\,u_{xx} + \\dots$：\n$$\nu_t + a\\,u_x = -\\frac{\\Delta t}{2}u_{tt} + \\frac{a\\,\\Delta x}{2}u_{xx} + \\dots\n$$\n为了消去时间导数 $u_{tt}$，我们对修正方程的最低阶近似式 $u_t \\approx -a\\,u_x$ 进行微分。这得到 $u_{tt} \\approx -a(u_x)_t = -a(u_t)_x \\approx -a(-a\\,u_x)_x = a^2\\,u_{xx}$。\n将此关系代回方程中：\n$$\nu_t + a\\,u_x = -\\frac{\\Delta t}{2}(a^2\\,u_{xx}) + \\frac{a\\,\\Delta x}{2}u_{xx} + \\dots\n$$\n$$\nu_t + a\\,u_x = \\left(\\frac{a\\,\\Delta x}{2} - \\frac{a^2\\,\\Delta t}{2}\\right)u_{xx} + \\dots\n$$\n提出因子 $\\frac{a\\,\\Delta x}{2}$：\n$$\nu_t + a\\,u_x = \\frac{a\\,\\Delta x}{2}\\left(1 - \\frac{a\\,\\Delta t}{\\Delta x}\\right)u_{xx} + \\dots = \\frac{a\\,\\Delta x}{2}(1 - C)u_{xx} + \\dots\n$$\n通过将其与 $u_t + a\\,u_x = \\nu_{\\mathrm{up}}\\,u_{xx} + \\dots$进行比较，我们确定迎风格式的数值耗散系数为：\n$$\n\\nu_{\\mathrm{up}} = \\frac{a\\,\\Delta x}{2}(1-C)\n$$\n\n接下来，我们分析 Lax–Friedrichs (LF) 格式。其通量由下式给出：\n$$\nF_{i+\\frac{1}{2}}^{n} = \\frac{1}{2}\\left(a\\,u_{i}^{n} + a\\,u_{i+1}^{n}\\right) - \\frac{1}{2}\\frac{\\Delta x}{\\Delta t}\\left(u_{i+1}^{n} - u_{i}^{n}\\right)\n$$\n左侧交界面上的通量 $F_{i-\\frac{1}{2}}^{n}$ 可通过平移索引得到：\n$$\nF_{i-\\frac{1}{2}}^{n} = \\frac{1}{2}\\left(a\\,u_{i-1}^{n} + a\\,u_{i}^{n}\\right) - \\frac{1}{2}\\frac{\\Delta x}{\\Delta t}\\left(u_{i}^{n} - u_{i-1}^{n}\\right)\n$$\n通量差为：\n$$\nF_{i+\\frac{1}{2}}^{n} - F_{i-\\frac{1}{2}}^{n} = \\frac{a}{2}(u_{i+1}^{n} - u_{i-1}^{n}) - \\frac{\\Delta x}{2\\,\\Delta t}(u_{i+1}^{n} - 2u_i^n + u_{i-1}^{n})\n$$\n将此代入有限体积更新格式：\n$$\nu_{i}^{n+1} = u_{i}^{n} - \\frac{\\Delta t}{\\Delta x}\\left[\\frac{a}{2}(u_{i+1}^{n} - u_{i-1}^{n}) - \\frac{\\Delta x}{2\\,\\Delta t}(u_{i+1}^{n} - 2u_i^n + u_{i-1}^{n})\\right]\n$$\n$$\nu_{i}^{n+1} = u_{i}^{n} - \\frac{a\\,\\Delta t}{2\\,\\Delta x}(u_{i+1}^{n} - u_{i-1}^{n}) + \\frac{1}{2}(u_{i+1}^{n} - 2u_i^n + u_{i-1}^{n})\n$$\n这可以重排为 Lax-Friedrichs 格式的标准形式：\n$$\nu_{i}^{n+1} = \\frac{1}{2}(u_{i+1}^{n} + u_{i-1}^{n}) - \\frac{C}{2}(u_{i+1}^{n} - u_{i-1}^{n})\n$$\n现在我们将各项在 $(x_i, t_n)$ 周围展开为泰勒级数：\n$$\nu_{i \\pm 1}^{n} = u \\pm \\Delta x\\,u_x + \\frac{(\\Delta x)^2}{2}u_{xx} \\pm \\frac{(\\Delta x)^3}{6}u_{xxx} + O((\\Delta x)^4)\n$$\n这给出了以下组合：\n$$\n\\frac{1}{2}(u_{i+1}^{n} + u_{i-1}^{n}) = u + \\frac{(\\Delta x)^2}{2}u_{xx} + O((\\Delta x)^4)\n$$\n$$\n\\frac{1}{2}(u_{i+1}^{n} - u_{i-1}^{n}) = \\Delta x\\,u_x + \\frac{(\\Delta x)^3}{6}u_{xxx} + O((\\Delta x)^5)\n$$\n将它们代入格式中：\n$$\nu + \\Delta t\\,u_t + \\frac{(\\Delta t)^2}{2}u_{tt} + \\dots = \\left(u + \\frac{(\\Delta x)^2}{2}u_{xx}\\right) - C\\left(\\Delta x\\,u_x + \\frac{(\\Delta x)^3}{6}u_{xxx}\\right) + \\dots\n$$\n$$\n\\Delta t\\,u_t + \\frac{(\\Delta t)^2}{2}u_{tt} + \\dots = -C\\,\\Delta x\\,u_x + \\frac{(\\Delta x)^2}{2}u_{xx} + \\dots\n$$\n使用 $C\\,\\Delta x = (a\\,\\Delta t/\\Delta x)\\,\\Delta x = a\\,\\Delta t$ 并两边同除以 $\\Delta t$：\n$$\nu_t + \\frac{\\Delta t}{2}u_{tt} + \\dots = -a\\,u_x + \\frac{(\\Delta x)^2}{2\\,\\Delta t}u_{xx} + \\dots\n$$\n$$\nu_t + a\\,u_x = -\\frac{\\Delta t}{2}u_{tt} + \\frac{(\\Delta x)^2}{2\\,\\Delta t}u_{xx} + \\dots\n$$\n再次代入 $u_{tt} \\approx a^2\\,u_{xx}$：\n$$\nu_t + a\\,u_x = -\\frac{a^2\\,\\Delta t}{2}u_{xx} + \\frac{(\\Delta x)^2}{2\\,\\Delta t}u_{xx} + \\dots\n$$\n$$\nu_t + a\\,u_x = \\left(\\frac{(\\Delta x)^2}{2\\,\\Delta t} - \\frac{a^2\\,\\Delta t}{2}\\right)u_{xx} + \\dots\n$$\n提出因子 $\\frac{a\\,\\Delta x}{2}$：\n$$\nu_t + a\\,u_x = \\frac{a\\,\\Delta x}{2}\\left(\\frac{\\Delta x}{a\\,\\Delta t} - \\frac{a\\,\\Delta t}{\\Delta x}\\right)u_{xx} + \\dots = \\frac{a\\,\\Delta x}{2}\\left(\\frac{1}{C} - C\\right)u_{xx} + \\dots\n$$\n因此，Lax-Friedrichs 格式的数值耗散系数为：\n$$\n\\nu_{\\mathrm{LF}} = \\frac{a\\,\\Delta x}{2}\\left(\\frac{1}{C} - C\\right)\n$$\n\n最后，我们计算比值 $R(C) = \\nu_{\\mathrm{LF}} / \\nu_{\\mathrm{up}}$：\n$$\nR(C) = \\frac{\\frac{a\\,\\Delta x}{2}\\left(\\frac{1}{C} - C\\right)}{\\frac{a\\,\\Delta x}{2}(1-C)} = \\frac{\\frac{1-C^2}{C}}{1-C}\n$$\n对分子进行因式分解，$1 - C^2 = (1 - C)(1 + C)$。对于 $C \\neq 1$，我们可以简化：\n$$\nR(C) = \\frac{(1-C)(1+C)}{C(1-C)} = \\frac{1+C}{C}\n$$\n这个比值揭示了这两种格式的行为。\n两种格式的稳定性条件都要求 $0 < C \\le 1$。在此范围内，$R(C) = \\frac{1}{C} + 1 \\ge 2$。这表明 Lax-Friedrichs 格式的耗散性始终至少是一阶迎风格式的两倍。对于实际的 CFL 数（例如 $C$ 约为 $0.5$），$\\nu_{\\mathrm{LF}}$ 显著大于 $\\nu_{\\mathrm{up}}$。\n\n这种差异凸显了一个根本性的权衡。一阶迎风格式更准确，因为它引入的数值耗散较少，从而能更好地保持陡峭梯度。然而，它的构建依赖于知道波的传播方向（$a$ 的符号）。Lax-Friedrichs 格式更“鲁棒”或更通用，因为其公式是对称的，并且不需要关于波传播特性的信息。这使得它更容易应用于复杂的方程组或多维问题，在这些问题中确定迎风方向并非易事。这种通用性和简单性的代价是显著更高的数值耗散，这往往会过度抹平解。",
            "answer": "$$\n\\boxed{\\frac{1+C}{C}}\n$$"
        },
        {
            "introduction": "在前面的练习基础上，我们现在研究一种人工粘性更为明确的格式——Rusanov 格式。该格式包含一个可直接控制耗散量的参数，使我们能够从将数值扩散视为固有误差，转变为将其视为一种可调节的稳定化手段。通过分析 Rusanov 格式，您将学会如何量化和控制数值粘性，这是现代高分辨率格式设计的关键一步。",
            "id": "3292632",
            "problem": "考虑一维线性平流守恒律 $u_{t} + f(u)_{x} = 0$，其中 $f(u) = a u$，波速 $a \\in \\mathbb{R}$ 为常数。在步长为 $\\Delta x$ 的均匀空间网格和显式时间步长 $\\Delta t$ 上，Rusanov（也称为局部 Lax–Friedrichs）有限体积格式通过以下方式推进单元平均值 $u_{i}^{n}$：\n$$\nu_{i}^{n+1} = u_{i}^{n} - \\frac{\\Delta t}{\\Delta x} \\left( F_{i+\\frac{1}{2}}^{n} - F_{i-\\frac{1}{2}}^{n} \\right),\n$$\n其中数值通量为\n$$\nF_{i+\\frac{1}{2}}^{n} = \\frac{1}{2}\\left( f\\!\\left(u_{i}^{n}\\right) + f\\!\\left(u_{i+1}^{n}\\right) \\right) - \\frac{\\alpha}{2}\\left( u_{i+1}^{n} - u_{i}^{n} \\right),\n$$\n其中 $\\alpha \\ge 0$ 是一个给定的粘性参数（对于线性平流，通常取 $\\alpha \\ge |a|$，但此处保持 $\\alpha$ 为符号形式）。通过对 $u(x_{i}\\pm \\Delta x, t^{n})$ 和 $u(x_{i}, t^{n+1})$ 在点 $(x_{i}, t^{n})$ 处进行泰勒展开，并使用控制偏微分方程 $u_{t} + a u_{x} = 0$ 来消去时间导数，代之以空间导数，从而进行修正方程分析。保留截至并包含与 $u_{xx}$ 和 $u_{xxx}$ 成比例的项，并将得到的修正方程写成典范形式\n$$\nu_{t} + a\\,u_{x} = \\nu_{\\mathrm{eq}}\\,u_{xx} + \\mu_{\\mathrm{eq}}\\,u_{xxx} + \\text{更高阶项}.\n$$\n将等效扩散系数 $\\nu_{\\mathrm{eq}}$ 表示为由 $\\alpha$、$a$、$\\Delta x$ 和 $\\Delta t$ 构成的单一闭式解析表达式。无需进行数值计算，也无需四舍五入。你的最终答案必须仅为此表达式，不带单位。",
            "solution": "任务是从 Rusanov 有限体积格式对一维线性平流方程 $u_{t} + a u_{x} = 0$（其中 $a \\in \\mathbb{R}$ 是一个常数波速）的修正方程分析中，推导出等效扩散系数 $\\nu_{\\mathrm{eq}}$。\n\nRusanov 有限体积格式由下式给出：\n$$\nu_{i}^{n+1} = u_{i}^{n} - \\frac{\\Delta t}{\\Delta x} \\left( F_{i+\\frac{1}{2}}^{n} - F_{i-\\frac{1}{2}}^{n} \\right)\n$$\n其中 $u_{i}^{n}$ 表示在时间 $t^{n}$ 单元 $i$ 中解的单元平均值，$\\Delta x$ 是均匀空间网格步长，$\\Delta t$ 是时间步长。线性平流的通量函数为 $f(u) = a u$。Rusanov 数值通量为：\n$$\nF_{i+\\frac{1}{2}}^{n} = \\frac{1}{2}\\left( f(u_{i}^{n}) + f(u_{i+1}^{n}) \\right) - \\frac{\\alpha}{2}\\left( u_{i+1}^{n} - u_{i}^{n} \\right) = \\frac{a}{2}(u_{i}^{n} + u_{i+1}^{n}) - \\frac{\\alpha}{2}(u_{i+1}^{n} - u_{i}^{n})\n$$\n其中 $\\alpha \\ge 0$ 是一个粘性参数。单元 $i$ 左界面的通量为：\n$$\nF_{i-\\frac{1}{2}}^{n} = \\frac{a}{2}(u_{i-1}^{n} + u_{i}^{n}) - \\frac{\\alpha}{2}(u_{i}^{n} - u_{i-1}^{n})\n$$\n那么，穿过单元 $i$ 的通量差为：\n$$\nF_{i+\\frac{1}{2}}^{n} - F_{i-\\frac{1}{2}}^{n} = \\left[ \\frac{a}{2}(u_{i}^{n} + u_{i+1}^{n}) - \\frac{\\alpha}{2}(u_{i+1}^{n} - u_{i}^{n}) \\right] - \\left[ \\frac{a}{2}(u_{i-1}^{n} + u_{i}^{n}) - \\frac{\\alpha}{2}(u_{i}^{n} - u_{i-1}^{n}) \\right]\n$$\n合并同类项，我们得到：\n$$\nF_{i+\\frac{1}{2}}^{n} - F_{i-\\frac{1}{2}}^{n} = \\frac{a}{2}(u_{i+1}^{n} - u_{i-1}^{n}) - \\frac{\\alpha}{2}(u_{i+1}^{n} - 2u_{i}^{n} + u_{i-1}^{n})\n$$\n将此代入有限体积格式，得到显式更新法则：\n$$\nu_{i}^{n+1} - u_{i}^{n} = - \\frac{\\Delta t}{\\Delta x} \\left[ \\frac{a}{2}(u_{i+1}^{n} - u_{i-1}^{n}) - \\frac{\\alpha}{2}(u_{i+1}^{n} - 2u_{i}^{n} + u_{i-1}^{n}) \\right]\n$$\n为了进行修正方程分析，我们假设 $u_{i}^{n}$ 代表光滑解 $u(x, t)$ 在点 $(x_{i}, t^{n})$ 处的值。我们将所有项在点 $(x_{i}, t^{n})$ 附近进行泰勒级数展开。设 $u$ 及其偏导数（例如 $u_t, u_x, u_{xx}$）在 $(x_{i}, t^{n})$ 处取值。\n时间上的泰勒展开为：\n$$\nu_{i}^{n+1} = u(x_i, t^n + \\Delta t) = u + \\Delta t u_t + \\frac{(\\Delta t)^2}{2} u_{tt} + \\frac{(\\Delta t)^3}{6} u_{ttt} + O((\\Delta t)^4)\n$$\n空间上的展开为：\n$$\nu_{i\\pm1}^{n} = u(x_i \\pm \\Delta x, t^n) = u \\pm \\Delta x u_x + \\frac{(\\Delta x)^2}{2} u_{xx} \\pm \\frac{(\\Delta x)^3}{6} u_{xxx} + \\frac{(\\Delta x)^4}{24} u_{xxxx} \\pm \\dots\n$$\n由此，我们构造离散空间算子：\n$$\nu_{i+1}^{n} - u_{i-1}^{n} = 2\\Delta x u_x + \\frac{(\\Delta x)^3}{3} u_{xxx} + O((\\Delta x)^5)\n$$\n$$\nu_{i+1}^{n} - 2u_{i}^{n} + u_{i-1}^{n} = (\\Delta x)^2 u_{xx} + \\frac{(\\Delta x)^4}{12} u_{xxxx} + O((\\Delta x)^6)\n$$\n将这些展开式代入格式的更新法则：\n$$\n\\Delta t u_t + \\frac{(\\Delta t)^2}{2} u_{tt} + \\frac{(\\Delta t)^3}{6} u_{ttt} + \\dots = - \\frac{\\Delta t}{\\Delta x} \\left[ \\frac{a}{2}\\left(2\\Delta x u_x + \\frac{(\\Delta x)^3}{3} u_{xxx}\\right) - \\frac{\\alpha}{2}\\left((\\Delta x)^2 u_{xx}\\right) + \\text{h.o.t.} \\right]\n$$\n两边同除以 $\\Delta t$ 并化简右侧：\n$$\nu_t + \\frac{\\Delta t}{2} u_{tt} + \\frac{(\\Delta t)^2}{6} u_{ttt} + \\dots = - \\left[ a u_x - \\frac{\\alpha \\Delta x}{2} u_{xx} + \\frac{a(\\Delta x)^2}{6} u_{xxx} + \\dots \\right]\n$$\n下一步是使用控制偏微分方程 $u_t = -a u_x$ 将所有时间导数表示为空间导数的函数。\n$$\nu_{tt} = \\frac{\\partial}{\\partial t}(u_t) = \\frac{\\partial}{\\partial t}(-a u_x) = -a \\frac{\\partial}{\\partial t}(u_x) = -a \\frac{\\partial}{\\partial x}(u_t) = -a \\frac{\\partial}{\\partial x}(-a u_x) = a^2 u_{xx}\n$$\n$$\nu_{ttt} = \\frac{\\partial}{\\partial t}(u_{tt}) = \\frac{\\partial}{\\partial t}(a^2 u_{xx}) = a^2 \\frac{\\partial^2}{\\partial x^2}(u_t) = a^2 \\frac{\\partial^2}{\\partial x^2}(-a u_x) = -a^3 u_{xxx}\n$$\n将这些表达式代回展开后的方程：\n$$\nu_t + \\frac{\\Delta t}{2}(a^2 u_{xx}) + \\frac{(\\Delta t)^2}{6}(-a^3 u_{xxx}) + \\dots = -a u_x + \\frac{\\alpha \\Delta x}{2} u_{xx} - \\frac{a(\\Delta x)^2}{6} u_{xxx} - \\dots\n$$\n现在我们将方程重排为典范形式 $u_{t} + a u_{x} = \\nu_{\\mathrm{eq}} u_{xx} + \\mu_{\\mathrm{eq}} u_{xxx} + \\dots$：\n$$\nu_t + a u_x = \\left(\\frac{\\alpha \\Delta x}{2} - \\frac{a^2 \\Delta t}{2}\\right) u_{xx} + \\left(-\\frac{a(\\Delta x)^2}{6} + \\frac{a^3 (\\Delta t)^2}{6}\\right) u_{xxx} + \\text{h.o.t.}\n$$\n通过将 $u_{xx}$ 项的系数与典范形式进行比较，我们确定等效扩散系数 $\\nu_{\\mathrm{eq}}$：\n$$\n\\nu_{\\mathrm{eq}} = \\frac{\\alpha \\Delta x}{2} - \\frac{a^2 \\Delta t}{2}\n$$\n此表达式可以因式分解得到最终结果：\n$$\n\\nu_{\\mathrm{eq}} = \\frac{1}{2}(\\alpha \\Delta x - a^2 \\Delta t)\n$$\n这是格式的主阶误差项，代表了人为的数值扩散。",
            "answer": "$$\n\\boxed{\\frac{1}{2} \\left( \\alpha \\Delta x - a^{2} \\Delta t \\right)}\n$$"
        }
    ]
}