{
    "hands_on_practices": [
        {
            "introduction": "Understanding the accuracy of a numerical scheme is a fundamental skill in computational fluid dynamics. This first exercise provides a direct way to analyze this by applying the common second-order central differencing scheme to a simple linear scalar field. By deriving the discrete flux and comparing it to the exact value, you will analyze the truncation error and gain a concrete understanding of a scheme's order of accuracy and the conditions under which it can be exact. ",
            "id": "3316286",
            "problem": "Consider the one-dimensional advection of a passive scalar field on a uniform Cartesian mesh within the Finite Volume Method (FVM). Let the scalar field be given by the linear profile $\\phi(x)=\\phi_{0}+\\alpha x$ with constants $\\phi_{0}$ and $\\alpha$, and let the density $\\rho$ and the velocity $u$ be constant. Denote the cell centers by $x_{i}$ with uniform spacing $\\Delta x$, and the east face of cell $i$ by $x_{i+\\frac{1}{2}}=(x_{i}+x_{i+1})/2$. The convective flux through a face is defined by the standard FVM face integral of the advective transport, which for constant $\\rho$ and $u$ reduces to the product of the mass flux and the face value of $\\phi$.\n\nUsing second-order central differencing (CD) to approximate the face value of $\\phi$ at $x_{i+\\frac{1}{2}}$ in terms of neighboring cell-center values, derive the discrete convective flux through the east face of cell $i$, and compare it to the exact face flux obtained by evaluating $\\phi(x)$ at $x_{i+\\frac{1}{2}}$. Define the normalized truncation error at the east face by\n$$\n\\varepsilon_{i+\\frac{1}{2}}=\\frac{F_{i+\\frac{1}{2}}^{\\mathrm{CD}}-F_{i+\\frac{1}{2}}^{\\mathrm{exact}}}{\\rho\\,|u|\\,|\\alpha|\\,\\Delta x},\n$$\nwith the assumption that $u\\neq 0$ and $\\alpha\\neq 0$. Compute $\\varepsilon_{i+\\frac{1}{2}}$ and state whether the discrete convective operator based on CD is exact for such linear profiles by interpreting the value of $\\varepsilon_{i+\\frac{1}{2}}$. Express the final answer for $\\varepsilon_{i+\\frac{1}{2}}$ as a pure number without units; no rounding is required.",
            "solution": "The task is to compute the normalized truncation error $\\varepsilon_{i+1/2}$ for the convective flux of a linear scalar profile, where the flux is approximated using second-order central differencing. This requires deriving expressions for both the exact flux, $F_{i+1/2}^{\\mathrm{exact}}$, and the approximated flux, $F_{i+1/2}^{\\mathrm{CD}}$.\n\nFirst, we determine the exact convective flux through the east face of cell $i$, located at $x_{i+1/2}$. The flux is the product of the mass flux per unit area, $\\rho u$, and the exact value of the scalar $\\phi$ at the face.\nThe scalar field is given as $\\phi(x) = \\phi_0 + \\alpha x$.\nThe exact value of the scalar at the face $x_{i+1/2}$ is:\n$$\n\\phi^{\\mathrm{exact}}_{i+1/2} = \\phi(x_{i+1/2}) = \\phi_0 + \\alpha x_{i+1/2}\n$$\nTherefore, the exact convective flux is:\n$$\nF_{i+1/2}^{\\mathrm{exact}} = (\\rho u) \\phi^{\\mathrm{exact}}_{i+1/2} = (\\rho u) (\\phi_0 + \\alpha x_{i+1/2})\n$$\n\nNext, we determine the discrete convective flux, $F_{i+1/2}^{\\mathrm{CD}}$, using the second-order central differencing (CD) scheme to approximate the scalar value at the face. The CD scheme approximates the face value as the linear interpolation of the values at the two adjacent cell centers, $x_i$ and $x_{i+1}$.\n$$\n\\phi^{\\mathrm{CD}}_{i+1/2} = \\frac{\\phi_i + \\phi_{i+1}}{2}\n$$\nHere, $\\phi_i$ and $\\phi_{i+1}$ are the scalar values at the cell centers. Since we are analyzing the error of the scheme, these values are taken from the exact profile:\n$$\n\\phi_i = \\phi(x_i) = \\phi_0 + \\alpha x_i\n$$\n$$\n\\phi_{i+1} = \\phi(x_{i+1}) = \\phi_0 + \\alpha x_{i+1}\n$$\nSubstituting these into the CD formula:\n$$\n\\phi^{\\mathrm{CD}}_{i+1/2} = \\frac{(\\phi_0 + \\alpha x_i) + (\\phi_0 + \\alpha x_{i+1})}{2} = \\frac{2\\phi_0 + \\alpha(x_i + x_{i+1})}{2} = \\phi_0 + \\alpha \\left( \\frac{x_i + x_{i+1}}{2} \\right)\n$$\nFrom the problem definition, the face location is $x_{i+1/2} = (x_i + x_{i+1})/2$. Substituting this into the expression for $\\phi^{\\mathrm{CD}}_{i+1/2}$:\n$$\n\\phi^{\\mathrm{CD}}_{i+1/2} = \\phi_0 + \\alpha x_{i+1/2}\n$$\nThis shows that the value approximated by central differencing is identical to the exact value at the face for a linear profile.\nThe discrete convective flux is then:\n$$\nF_{i+1/2}^{\\mathrm{CD}} = (\\rho u) \\phi^{\\mathrm{CD}}_{i+1/2} = (\\rho u) (\\phi_0 + \\alpha x_{i+1/2})\n$$\nNow, we can compute the numerator of the normalized truncation error:\n$$\nF_{i+1/2}^{\\mathrm{CD}} - F_{i+1/2}^{\\mathrm{exact}} = (\\rho u) (\\phi_0 + \\alpha x_{i+1/2}) - (\\rho u) (\\phi_0 + \\alpha x_{i+1/2}) = 0\n$$\nFinally, we substitute this result into the definition of the normalized truncation error $\\varepsilon_{i+1/2}$:\n$$\n\\varepsilon_{i+1/2} = \\frac{F_{i+1/2}^{\\mathrm{CD}}-F_{i+1/2}^{\\mathrm{exact}}}{\\rho\\,|u|\\,|\\alpha|\\,\\Delta x} = \\frac{0}{\\rho\\,|u|\\,|\\alpha|\\,\\Delta x}\n$$\nGiven that $\\rho > 0$, $u \\neq 0$, $\\alpha \\neq 0$, and $\\Delta x > 0$, the denominator is non-zero. Therefore, the result is:\n$$\n\\varepsilon_{i+1/2} = 0\n$$\nThe interpretation of this result is that the normalized truncation error is zero. This means that the second-order central differencing scheme for the convective flux is exact for any scalar field that is a linear function of position. This is expected, as a second-order scheme is constructed from a Taylor series expansion truncated after the second-order term, and for a linear function, all derivatives of order two and higher are zero. The linear interpolation inherent in the CD scheme perfectly reconstructs the value of a linear function at the midpoint between two nodes.",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "Moving from idealized uniform grids to the practical, unstructured meshes used in most engineering applications requires more sophisticated techniques. When cell neighbors are arbitrarily arranged, simple interpolation between two points is often insufficient, especially when non-orthogonality is present. This practice introduces the robust weighted least-squares method to reconstruct the gradient of the scalar field at a cell's center, a crucial step for accurately extrapolating values to the face and a cornerstone of modern, second-order finite volume schemes. ",
            "id": "3316239",
            "problem": "Consider a two-dimensional finite-volume control volume in computational fluid dynamics (CFD). Let the scalar field be a passive species mass fraction $\\phi$ governed by a conserved transport equation. You are given a cell $P$ with centroid at $\\boldsymbol{x}_{P} = (\\,0,\\,0\\,)$ and four neighboring cell centroids with coordinates and scalar values:\n- East neighbor $E$: $\\boldsymbol{x}_{E} = (\\,1,\\,0\\,)$ with $\\phi_{E} = 0.5$,\n- West neighbor $W$: $\\boldsymbol{x}_{W} = (\\, -1,\\,0\\,)$ with $\\phi_{W} = 0.1$,\n- North neighbor $N$: $\\boldsymbol{x}_{N} = (\\,0,\\,2\\,)$ with $\\phi_{N} = 0.2$,\n- South neighbor $S$: $\\boldsymbol{x}_{S} = (\\,0,\\, -1\\,)$ with $\\phi_{S} = 0.35$,\nand the central value $\\phi_{P} = 0.3$.\n\nA face $f$ between $P$ and $E$ has centroid $\\boldsymbol{x}_{f} = (\\,0.5,\\,0.1\\,)$, which is offset from the line connecting $\\boldsymbol{x}_{P}$ and $\\boldsymbolx_{E}$. The face has unit normal vector $\\boldsymbol{n}_{f} = (\\,1,\\,0\\,)$ pointing from $P$ to $E$ and face length $A_{f} = 0.8~\\mathrm{m}$. The face-centered density and velocity are $\\rho_{f} = 1.2~\\mathrm{kg\\,m^{-3}}$ and $\\boldsymbol{u}_{f} = (\\,2.0,\\,0.3\\,)~\\mathrm{m\\,s^{-1}}$, respectively.\n\nStarting from the first-order Taylor expansion of $\\phi$ about $\\boldsymbol{x}_{P}$ and the definition of a weighted least-squares problem, derive the least-squares system for the gradient $\\nabla \\phi\\big|_{P}$ using neighbor differences with inverse-square-distance weights, and solve for the numerical value of $\\nabla \\phi\\big|_{P}$. Then, use the reconstructed gradient to linearly predict the face value $\\phi_{f}$ at $\\boldsymbol{x}_{f}$, and evaluate the convective species mass flow rate through face $f$,\n$$F_{\\mathrm{conv},f} \\;=\\; \\rho_{f}\\,\\left(\\boldsymbol{u}_{f}\\cdot \\boldsymbol{n}_{f}\\right)\\,A_{f}\\,\\phi_{f}.$$\nExpress the final convective flux in $\\mathrm{kg\\,s^{-1}}$ and round your answer to four significant figures.",
            "solution": "The problem requires the calculation of the convective flux of a passive scalar species through a cell face. This process involves three main steps: 1) reconstructing the gradient of the scalar field at the cell center using a weighted least-squares method, 2) extrapolating the scalar value to the face center using this gradient, and 3) calculating the convective flux using the given formula.\n\nThe core of the gradient reconstruction is the first-order Taylor series expansion of the scalar field $\\phi$ about the cell centroid $\\boldsymbol{x}_{P}$. For any neighboring cell $N_i$, its value $\\phi_{N_i}$ can be approximated as:\n$$\n\\phi_{N_i} \\approx \\phi_{P} + \\nabla \\phi\\big|_{P} \\cdot (\\boldsymbol{x}_{N_i} - \\boldsymbol{x}_{P})\n$$\nLet $\\nabla \\phi\\big|_{P} = \\boldsymbol{g} = (g_x, g_y)$, $\\boldsymbol{r}_{i} = \\boldsymbol{x}_{N_i} - \\boldsymbol{x}_{P} = ((\\Delta x)_i, (\\Delta y)_i)$, and $\\Delta \\phi_i = \\phi_{N_i} - \\phi_P$. The approximation for each neighbor is:\n$$\n\\Delta \\phi_i \\approx \\boldsymbol{g} \\cdot \\boldsymbol{r}_{i} = g_x (\\Delta x)_i + g_y (\\Delta y)_i\n$$\nWe have four neighbors ($E$, $W$, $N$, $S$), yielding an overdetermined system of linear equations for the two components of the gradient, $g_x$ and $g_y$. We solve this system by minimizing a weighted sum of squared residuals, $J$:\n$$\nJ(\\boldsymbol{g}) = \\sum_{i \\in \\{E,W,N,S\\}} w_i \\left( \\boldsymbol{g} \\cdot \\boldsymbol{r}_{i} - \\Delta \\phi_i \\right)^2\n$$\nThe weights $w_i$ are given as the inverse-square-distance, $w_i = |\\boldsymbol{r}_{i}|^{-2}$.\n\nLet us compute the required vectors, scalars, and weights. The central cell is at $\\boldsymbol{x}_{P} = (0, 0)$ with $\\phi_{P} = 0.3$.\nFor the East neighbor $E$:\n$\\boldsymbol{x}_{E} = (1, 0)$, $\\phi_{E} = 0.5$.\n$\\boldsymbol{r}_{E} = (1, 0)$, $\\Delta \\phi_E = 0.5 - 0.3 = 0.2$.\n$|\\boldsymbol{r}_{E}|^2 = 1^2 + 0^2 = 1$, so $w_E = 1/1 = 1$.\n\nFor the West neighbor $W$:\n$\\boldsymbol{x}_{W} = (-1, 0)$, $\\phi_{W} = 0.1$.\n$\\boldsymbol{r}_{W} = (-1, 0)$, $\\Delta \\phi_W = 0.1 - 0.3 = -0.2$.\n$|\\boldsymbol{r}_{W}|^2 = (-1)^2 + 0^2 = 1$, so $w_W = 1/1 = 1$.\n\nFor the North neighbor $N$:\n$\\boldsymbol{x}_{N} = (0, 2)$, $\\phi_{N} = 0.2$.\n$\\boldsymbol{r}_{N} = (0, 2)$, $\\Delta \\phi_N = 0.2 - 0.3 = -0.1$.\n$|\\boldsymbol{r}_{N}|^2 = 0^2 + 2^2 = 4$, so $w_N = 1/4 = 0.25$.\n\nFor the South neighbor $S$:\n$\\boldsymbol{x}_{S} = (0, -1)$, $\\phi_{S} = 0.35$.\n$\\boldsymbol{r}_{S} = (0, -1)$, $\\Delta \\phi_S = 0.35 - 0.3 = 0.05$.\n$|\\boldsymbol{r}_{S}|^2 = 0^2 + (-1)^2 = 1$, so $w_S = 1/1 = 1$.\n\nTo minimize $J$, we set its partial derivatives with respect to $g_x$ and $g_y$ to zero, yielding the normal equations:\n$$\n\\begin{pmatrix} \\sum_i w_i (\\Delta x)_i^2  \\sum_i w_i (\\Delta x)_i (\\Delta y)_i \\\\ \\sum_i w_i (\\Delta x)_i (\\Delta y)_i  \\sum_i w_i (\\Delta y)_i^2 \\end{pmatrix} \\begin{pmatrix} g_x \\\\ g_y \\end{pmatrix} = \\begin{pmatrix} \\sum_i w_i (\\Delta x)_i \\Delta \\phi_i \\\\ \\sum_i w_i (\\Delta y)_i \\Delta \\phi_i \\end{pmatrix}\n$$\nWe compute the components of the matrix and the right-hand side vector:\n$\\sum_i w_i (\\Delta x)_i^2 = w_E(1)^2 + w_W(-1)^2 + w_N(0)^2 + w_S(0)^2 = 1(1) + 1(1) + 0 + 0 = 2$.\n$\\sum_i w_i (\\Delta y)_i^2 = w_E(0)^2 + w_W(0)^2 + w_N(2)^2 + w_S(-1)^2 = 0 + 0 + 0.25(4) + 1(1) = 1 + 1 = 2$.\n$\\sum_i w_i (\\Delta x)_i (\\Delta y)_i = w_E(1)(0) + w_W(-1)(0) + w_N(0)(2) + w_S(0)(-1) = 0$.\n\n$\\sum_i w_i (\\Delta x)_i \\Delta \\phi_i = w_E(1)(0.2) + w_W(-1)(-0.2) + w_N(0)(-0.1) + w_S(0)(0.05) = 0.2 + 0.2 + 0 + 0 = 0.4$.\n$\\sum_i w_i (\\Delta y)_i \\Delta \\phi_i = w_E(0)(0.2) + w_W(0)(-0.2) + w_N(2)(-0.1) + w_S(-1)(0.05) = 0 + 0 + 0.25(-0.2) + 1(-0.05) = -0.05 - 0.05 = -0.1$.\n\nThe system of equations is:\n$$\n\\begin{pmatrix} 2  0 \\\\ 0  2 \\end{pmatrix} \\begin{pmatrix} g_x \\\\ g_y \\end{pmatrix} = \\begin{pmatrix} 0.4 \\\\ -0.1 \\end{pmatrix}\n$$\nSolving for $g_x$ and $g_y$:\n$2 g_x = 0.4 \\implies g_x = 0.2$.\n$2 g_y = -0.1 \\implies g_y = -0.05$.\nThus, the reconstructed gradient at the cell center is $\\nabla \\phi\\big|_{P} = (0.2, -0.05)$.\n\nNext, we use this gradient to linearly extrapolate the scalar value $\\phi_f$ at the face centroid $\\boldsymbol{x}_f = (0.5, 0.1)$.\nThe extrapolation formula is:\n$$\n\\phi_f = \\phi_P + \\nabla \\phi\\big|_{P} \\cdot (\\boldsymbol{x}_f - \\boldsymbol{x}_P)\n$$\nThe displacement vector is $\\boldsymbol{r}_{Pf} = \\boldsymbol{x}_f - \\boldsymbol{x}_P = (0.5, 0.1) - (0, 0) = (0.5, 0.1)$.\nSubstituting the values:\n$$\n\\phi_f = 0.3 + (0.2, -0.05) \\cdot (0.5, 0.1) = 0.3 + (0.2)(0.5) + (-0.05)(0.1)\n$$\n$$\n\\phi_f = 0.3 + 0.1 - 0.005 = 0.395\n$$\n\nFinally, we evaluate the convective species mass flow rate, $F_{\\mathrm{conv},f}$, through the face $f$. In a 2D simulation, the face area is the face length multiplied by a unit depth. The units of the calculation require $A_f$ to be treated as an area.\n$$\nF_{\\mathrm{conv},f} = \\rho_f (\\boldsymbol{u}_f \\cdot \\boldsymbol{n}_f) A_f \\phi_f\n$$\nThe given values are $\\rho_f = 1.2~\\mathrm{kg\\,m^{-3}}$, $\\boldsymbol{u}_f = (2.0, 0.3)~\\mathrm{m\\,s^{-1}}$, $\\boldsymbol{n}_f = (1, 0)$, and $A_f = 0.8~\\mathrm{m^2}$.\nFirst, we compute the normal component of the velocity at the face:\n$$\n\\boldsymbol{u}_f \\cdot \\boldsymbol{n}_f = (2.0, 0.3) \\cdot (1, 0) = (2.0)(1) + (0.3)(0) = 2.0~\\mathrm{m\\,s^{-1}}\n$$\nNow we can compute the flux:\n$$\nF_{\\mathrm{conv},f} = (1.2~\\mathrm{kg\\,m^{-3}}) \\times (2.0~\\mathrm{m\\,s^{-1}}) \\times (0.8~\\mathrm{m}^2) \\times 0.395\n$$\n$$\nF_{\\mathrm{conv},f} = 1.92~\\mathrm{kg\\,s^{-1}} \\times 0.395 = 0.7584~\\mathrm{kg\\,s^{-1}}\n$$\nThe problem requests the answer to be rounded to four significant figures. The calculated value $0.7584$ already has four significant figures.",
            "answer": "$$\n\\boxed{0.7584}\n$$"
        },
        {
            "introduction": "This final practice completes the picture for flux evaluation on unstructured grids by addressing the integration of the flux quantity over complex face geometries, such as triangles. While simple approximations might use a single point, achieving higher accuracy requires more advanced methods. This exercise guides you through the development of numerical quadrature rules that are exact for polynomial functions of a certain degree, offering insight into how CFD codes can maintain high accuracy even on the complex meshes needed for real-world geometries. ",
            "id": "3316240",
            "problem": "Consider a planar triangular face in an unstructured finite-volume mesh used in Computational Fluid Dynamics (CFD) within the Finite Volume Method (FVM). The convective flux of a passive scalar across a face with outward unit normal vector $\\mathbf{n}_f$ is given by the surface integral\n$$\n\\mathcal{F}_f \\;=\\; \\int_{A_f} \\rho\\,\\phi\\,\\left(\\mathbf{u}\\cdot\\mathbf{n}_f\\right)\\, dA,\n$$\nwhere $\\rho$ is the density, $\\phi$ is the scalar, $\\mathbf{u}$ is the velocity, and $A_f$ is the face area. Assume the face is flat so that $\\mathbf{n}_f$ is constant on $A_f$, and define the face integrand as $f(\\mathbf{x}) = \\rho(\\mathbf{x})\\,\\phi(\\mathbf{x})\\,\\left(\\mathbf{u}(\\mathbf{x})\\cdot\\mathbf{n}_f\\right)$.\n\nStarting from this integral representation and the requirement of exactness on low-degree polynomials, develop quadrature rules on a triangular face for evaluating $\\mathcal{F}_f$:\n- Derive a one-point formula that is exact for all linear $f$ on a triangle, and write its node location and weight in terms of the face area $A_f$.\n- Derive a symmetric three-point formula that is exact for all quadratic $f$ on a triangle, and write its node locations and weights in terms of the face area $A_f$.\n\nThen analyze the order of accuracy for both rules by performing a Taylor expansion of $f$ about the face centroid. Let the face have a characteristic length $h$ (for example, the diameter of the circumscribed circle), and assume $f$ is smooth on $A_f$. Determine how the absolute quadrature error scales with $h$ for the one-point and three-point rules.\n\nFinally, validate the constructions on the reference triangular face with vertices at $(0,0)$, $(1,0)$, $(0,1)$ (so its area is $A_f = \\frac{1}{2}$). On this face, take\n$$\nf(x,y) \\;=\\; 4 \\;+\\; 2x \\;-\\; 3y \\;+\\; 5xy \\;+\\; x^2 \\;+\\; 2y^2.\n$$\nCompute the exact integral $\\int_{A_f} f\\, dA$ and the one-point and three-point approximations obtained from your derived rules. Define the one-point error as the approximation minus the exact integral. Report, as your final answer, the one-point error for this specific test function and face as an exact rational number with no rounding and no units. Do not include any other quantity in your final answer.",
            "solution": "The face convective flux is\n$$\n\\mathcal{F}_f \\;=\\; \\int_{A_f} f(\\mathbf{x})\\, dA, \\quad f(\\mathbf{x}) \\;=\\; \\rho(\\mathbf{x})\\,\\phi(\\mathbf{x})\\,\\left(\\mathbf{u}(\\mathbf{x})\\cdot\\mathbf{n}_f\\right),\n$$\nwith constant $\\mathbf{n}_f$ on a planar face. We construct quadrature rules by enforcing exactness on polynomial test functions, leveraging the affine invariance of polynomial exactness under mappings from a reference triangle.\n\nOne-point rule exact for linear functions. Consider a triangular face with area $A_f$ and centroid $\\mathbf{x}_c$. For any affine function $f(\\mathbf{x}) = a + \\mathbf{b}\\cdot\\mathbf{x}$, the mean value property on simplices implies that the average of $f$ over the triangle equals $f$ evaluated at the centroid. Therefore, the one-point quadrature that is exact for linear $f$ is\n$$\n\\int_{A_f} f(\\mathbf{x})\\, dA \\;\\approx\\; A_f\\, f(\\mathbf{x}_c),\n$$\nwith node at the centroid $\\mathbf{x}_c$ and weight $A_f$.\n\nThree-point symmetric rule exact for quadratic functions. We derive a three-point rule by symmetry. On the reference triangle with vertices $(0,0)$, $(1,0)$, $(0,1)$ and area $A = \\frac{1}{2}$, we seek three nodes that are the permutations of a barycentric pattern $(a,b,b)$ with $a+2b=1$, and equal weights $w$. By affine invariance, transforming this rule to any physical triangle yields a rule of the same degree of exactness with weights scaled by the physical area.\n\nWe enforce exactness for the polynomial basis $\\{1, x, y, x^2, y^2, xy\\}$:\n- Exactness for the constant function gives\n$$\n3w \\;=\\; A \\;=\\; \\frac{1}{2} \\;\\Rightarrow\\; w \\;=\\; \\frac{1}{6}.\n$$\n- Exactness for $x$ and $y$ follows from symmetry and the barycentric constraint $a+2b=1$. For example, the quadrature for $x$ is\n$$\nQ[x] \\;=\\; w\\,(a + 2b) \\;=\\; w \\;=\\; \\frac{1}{6},\n$$\nmatching $\\int_{A} x\\, dA = \\frac{1}{6}$.\n- For quadratic terms, we need\n$$\nQ[x^2] \\;=\\; w\\,(a^2 + 2b^2) \\;=\\; \\int_{A} x^2\\, dA \\;=\\; \\frac{1}{12}, \\\\\nQ[xy] \\;=\\; w\\,(b^2 + 2ab) \\;=\\; \\int_{A} xy\\, dA \\;=\\; \\frac{1}{24}.\n$$\nUsing $w = \\frac{1}{6}$, these become\n$$\na^2 + 2b^2 \\;=\\; \\frac{1}{2}, \\qquad b^2 + 2ab \\;=\\; \\frac{1}{4},\n$$\nwith $a+2b=1$. Solving, one admissible solution with strictly interior points is\n$$\na \\;=\\; \\frac{2}{3}, \\qquad b \\;=\\; \\frac{1}{6}.\n$$\nThus the three nodes in Cartesian coordinates on the reference triangle (vertices $(0,0)$, $(1,0)$, $(0,1)$) are\n$$\n(x_1,y_1) \\;=\\; \\left(\\frac{1}{6},\\frac{1}{6}\\right), \\quad\n(x_2,y_2) \\;=\\; \\left(\\frac{2}{3},\\frac{1}{6}\\right), \\quad\n(x_3,y_3) \\;=\\; \\left(\\frac{1}{6},\\frac{2}{3}\\right),\n$$\neach with weight $w = \\frac{1}{6}$. On a general triangle with area $A_f$, the weights scale to $w_f = \\frac{A_f}{3}$ at the three affine images of these reference points.\n\nOrder-of-accuracy analysis via Taylor expansion. Let $\\mathbf{x}_c$ be the centroid of the physical face and let the face have characteristic length $h$. Expand $f$ about $\\mathbf{x}_c$:\n$$\nf(\\mathbf{x}_c + \\boldsymbol{\\xi}) \\;=\\; f(\\mathbf{x}_c) \\;+\\; \\nabla f(\\mathbf{x}_c)\\cdot \\boldsymbol{\\xi} \\;+\\; \\frac{1}{2}\\,\\boldsymbol{\\xi}^{\\top}\\,\\nabla^2 f(\\mathbf{x}_c)\\,\\boldsymbol{\\xi} \\;+\\; \\frac{1}{6}\\sum_{i,j,k} \\partial_{ijk} f(\\mathbf{x}_c)\\,\\xi_i \\xi_j \\xi_k \\;+\\; \\cdots,\n$$\nwhere $\\boldsymbol{\\xi}$ lies in the face plane and $|\\boldsymbol{\\xi}| = \\mathcal{O}(h)$. The exact integral is the integral of this series over the face domain. The one-point rule evaluates $A_f f(\\mathbfx_c)$, cancelling the constant and linear contributions because the first moments $\\int \\xi_i\\, dA$ vanish at the centroid. The leading error term comes from the quadratic term:\n$$\nE_{\\text{1pt}} \\;=\\; \\int_{A_f} f\\, dA \\;-\\; A_f f(\\mathbf{x}_c) \\;=\\; \\frac{1}{2}\\int_{A_f} \\boldsymbol{\\xi}^{\\top}\\,\\nabla^2 f(\\mathbf{x}_c)\\,\\boldsymbol{\\xi}\\, dA \\;+\\; \\mathcal{O}(h^5).\n$$\nSince $\\int_{A_f} \\xi_i \\xi_j\\, dA = \\mathcal{O}(h^4)$ and $A_f = \\mathcal{O}(h^2)$, the absolute error scales as\n$$\n|E_{\\text{1pt}}| \\;=\\; \\mathcal{O}(h^4).\n$$\nFor the three-point formula exact for all quadratics, the constant, linear, and quadratic terms are integrated exactly, so the leading error arises from cubic terms, whose area integrals are $\\mathcal{O}(h^5)$:\n$$\n|E_{\\text{3pt}}| \\;=\\; \\mathcal{O}(h^5).\n$$\n\nValidation on the reference triangle. Let the reference triangle be $T = \\{(x,y)\\,:\\, x\\ge 0,\\; y\\ge 0,\\; x+y\\le 1\\}$ with area $A = \\frac{1}{2}$. Consider\n$$\nf(x,y) \\;=\\; 4 \\;+\\; 2x \\;-\\; 3y \\;+\\; 5xy \\;+\\; x^2 \\;+\\; 2y^2.\n$$\nThe exact integral uses the known simplex-monomial formula\n$$\n\\int_{T} x^{i} y^{j}\\, dx\\,dy \\;=\\; \\frac{i!j!}{(i+j+2)!}.\n$$\nThus\n$$\n\\int_{T} 1\\, dA \\;=\\; \\frac{1}{2}, \\quad\n\\int_{T} x\\, dA \\;=\\; \\frac{1}{6}, \\quad\n\\int_{T} y\\, dA \\;=\\; \\frac{1}{6}, \\quad\n\\int_{T} xy\\, dA \\;=\\; \\frac{1}{24}, \\quad\n\\int_{T} x^2\\, dA \\;=\\; \\frac{1}{12}, \\quad\n\\int_{T} y^2\\, dA \\;=\\; \\frac{1}{12}.\n$$\nTherefore,\n$$\n\\int_{T} f\\, dA \\;=\\; 4\\cdot \\frac{1}{2} \\;+\\; 2\\cdot \\frac{1}{6} \\;-\\; 3\\cdot \\frac{1}{6} \\;+\\; 5\\cdot \\frac{1}{24} \\;+\\; 1\\cdot \\frac{1}{12} \\;+\\; 2\\cdot \\frac{1}{12}\n\\;=\\; 2 + \\frac{1}{3} - \\frac{1}{2} + \\frac{5}{24} + \\frac{1}{12} + \\frac{2}{12} = \\frac{48+8-12+5+2+4}{24} = \\frac{55}{24}.\n$$\nOne-point rule on $T$ uses the centroid $(x_c,y_c) = \\left(\\frac{1}{3},\\frac{1}{3}\\right)$ with weight $A = \\frac{1}{2}$:\n$$\nf\\!\\left(\\frac{1}{3},\\frac{1}{3}\\right) \\;=\\; 4 \\;+\\; \\frac{2}{3} \\;-\\; 1 \\;+\\; \\frac{5}{9} \\;+\\; \\frac{1}{9} \\;+\\; \\frac{2}{9} \\;=\\; 3 + \\frac{2}{3} + \\frac{8}{9} = \\frac{27+6+8}{9} = \\frac{41}{9},\n$$\nso\n$$\nQ_{\\text{1pt}}[f] \\;=\\; \\frac{1}{2}\\cdot \\frac{41}{9} \\;=\\; \\frac{41}{18}.\n$$\nBy definition, the one-point error (approximation minus exact) is\n$$\nE_{\\text{1pt}} \\;=\\; \\frac{41}{18} \\;-\\; \\frac{55}{24} \\;=\\; \\frac{164 - 165}{72} = -\\frac{1}{72}.\n$$\nFor completeness, the derived three-point rule has nodes\n$$\n\\left(\\frac{1}{6},\\frac{1}{6}\\right),\\quad \\left(\\frac{2}{3},\\frac{1}{6}\\right),\\quad \\left(\\frac{1}{6},\\frac{2}{3}\\right),\n$$\neach with weight $\\frac{1}{6}$. Evaluating and summing,\n$$\nQ_{\\text{3pt}}[f] \\;=\\; \\frac{1}{6}\\Big(f\\!\\left(\\tfrac{1}{6},\\tfrac{1}{6}\\right) + f\\!\\left(\\tfrac{2}{3},\\tfrac{1}{6}\\right) + f\\!\\left(\\tfrac{1}{6},\\tfrac{2}{3}\\right)\\Big) \\;=\\; \\frac{55}{24},\n$$\nwhich matches the exact integral as expected for a degree-two exact rule.\n\nTherefore, the requested one-point error for this test case is the exact rational value $-\\frac{1}{72}$.",
            "answer": "$$\\boxed{-\\frac{1}{72}}$$"
        }
    ]
}