{
    "hands_on_practices": [
        {
            "introduction": "我们的实践探索始于在一个理想化环境中分析一个基本数值格式的精度。本练习将帮助您理解离散化选择如何影响简单流动剖面下对流通量计算的精确性，为评估更复杂的格式奠定关键基础。通过在均匀网格上检验一个线性标量场 ，我们可以直接量化中心差分格式的截断误差。",
            "id": "3316286",
            "problem": "考虑在有限体积法（FVM）中，均匀笛卡尔网格上被动标量场的一维平流。设标量场由线性分布 $\\phi(x)=\\phi_{0}+\\alpha x$ 给出，其中 $\\phi_{0}$ 和 $\\alpha$ 为常数，且密度 $\\rho$ 和速度 $u$ 为常数。将单元中心表示为 $x_{i}$，均匀间距为 $\\Delta x$，单元 $i$ 的东侧面表示为 $x_{i+\\frac{1}{2}}=(x_{i}+x_{i+1})/2$。通过一个面的对流通量由平流输运的标准FVM面积分定义，对于恒定的 $\\rho$ 和 $u$，这简化为质量通量与 $\\phi$ 在面上的值的乘积。\n\n使用二阶中心差分（CD）格式，根据相邻单元中心的值来近似 $x_{i+\\frac{1}{2}}$ 处 $\\phi$ 的面值，推导通过单元 $i$ 东侧面的离散对流通量，并将其与通过在 $x_{i+\\frac{1}{2}}$ 处计算 $\\phi(x)$ 得到的精确面通量进行比较。将东侧面上的归一化截断误差定义为\n$$\n\\varepsilon_{i+\\frac{1}{2}}=\\frac{F_{i+\\frac{1}{2}}^{\\mathrm{CD}}-F_{i+\\frac{1}{2}}^{\\mathrm{exact}}}{\\rho\\,|u|\\,|\\alpha|\\,\\Delta x},\n$$\n假设 $u\\neq 0$ 且 $\\alpha\\neq 0$。计算 $\\varepsilon_{i+\\frac{1}{2}}$，并通过解释 $\\varepsilon_{i+\\frac{1}{2}}$ 的值来说明基于CD格式的离散对流算子对此类线性分布是否精确。将 $\\varepsilon_{i+\\frac{1}{2}}$ 的最终答案表示为一个无单位的纯数；无需四舍五入。",
            "solution": "对问题陈述进行验证。\n\n### 步骤1：提取已知条件\n- **系统**：被动标量场 $\\phi$ 的一维平流。\n- **数值方法**：有限体积法（FVM）。\n- **网格**：均匀笛卡尔网格，单元中心为 $x_{i}$，均匀间距为 $\\Delta x$。\n- **标量场分布**：$\\phi(x)=\\phi_{0}+\\alpha x$，其中 $\\phi_{0}$ 和 $\\alpha$ 是常数。\n- **流动性质**：密度 $\\rho$ 和速度 $u$ 是常数。\n- **面位置**：单元 $i$ 的东侧面位于 $x_{i+\\frac{1}{2}}=(x_{i}+x_{i+1})/2$。\n- **对流通量定义**：通量是质量通量 $(\\rho u)$ 与 $\\phi$ 在面上的值的乘积。\n- **近似格式**：使用二阶中心差分（CD）来近似面值 $\\phi_{i+\\frac{1}{2}}$。\n- **归一化截断误差定义**：\n$$\n\\varepsilon_{i+\\frac{1}{2}}=\\frac{F_{i+\\frac{1}{2}}^{\\mathrm{CD}}-F_{i+\\frac{1}{2}}^{\\mathrm{exact}}}{\\rho\\,|u|\\,|\\alpha|\\,\\Delta x}\n$$\n- **假设**：$u\\neq 0$ 且 $\\alpha\\neq 0$。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学基础**：该问题是计算流体力学（CFD）中数值格式分析的标准练习。FVM、平流、中心差分和截断误差等概念是该领域的基本且公认的概念。该设置在科学和数学上是合理的。\n- **适定性**：该问题是适定的。所有必需的定义、函数和常数都已提供，足以推导出所求量。假设 $u \\neq 0$ 和 $\\alpha \\neq 0$ 确保误差项的分母不为零，从而保证了唯一定义的解。\n- **客观性**：语言客观、精确，使用了标准的数学和CFD术语。\n- **完整性和一致性**：该问题是自洽且内部一致的。标量分布、面位置和数值格式的定义是兼容的，并且足以进行推导。\n\n### 步骤3：结论与行动\n问题有效。将推导解答。\n\n任务是计算线性标量场分布的对流通量的归一化截断误差 $\\varepsilon_{i+\\frac{1}{2}}$，其中通量使用二阶中心差分进行近似。这需要推导精确通量 $F_{i+\\frac{1}{2}}^{\\mathrm{exact}}$ 和近似通量 $F_{i+\\frac{1}{2}}^{\\mathrm{CD}}$ 的表达式。\n\n首先，我们确定通过位于 $x_{i+\\frac{1}{2}}$ 处的单元 $i$ 东侧面的精确对流通量。通量是单位面积质量通量 $\\rho u$ 与标量 $\\phi$ 在该面上的精确值的乘积。\n标量场由 $\\phi(x) = \\phi_0 + \\alpha x$ 给出。\n标量在面 $x_{i+\\frac{1}{2}}$ 处的精确值为：\n$$\n\\phi^{\\mathrm{exact}}_{i+\\frac{1}{2}} = \\phi(x_{i+\\frac{1}{2}}) = \\phi_0 + \\alpha x_{i+\\frac{1}{2}}\n$$\n因此，精确对流通量为：\n$$\nF_{i+\\frac{1}{2}}^{\\mathrm{exact}} = (\\rho u) \\phi^{\\mathrm{exact}}_{i+\\frac{1}{2}} = (\\rho u) (\\phi_0 + \\alpha x_{i+\\frac{1}{2}})\n$$\n\n接下来，我们使用二阶中心差分（CD）格式来近似面上的标量值，从而确定离散对流通量 $F_{i+\\frac{1}{2}}^{\\mathrm{CD}}$。CD格式将面值近似为两个相邻单元中心 $x_i$ 和 $x_{i+1}$ 处值的线性插值。\n$$\n\\phi^{\\mathrm{CD}}_{i+\\frac{1}{2}} = \\frac{\\phi_i + \\phi_{i+1}}{2}\n$$\n这里，$\\phi_i$ 和 $\\phi_{i+1}$ 是单元中心的标量值。由于我们正在分析格式的误差，这些值取自精确分布：\n$$\n\\phi_i = \\phi(x_i) = \\phi_0 + \\alpha x_i\n$$\n$$\n\\phi_{i+1} = \\phi(x_{i+1}) = \\phi_0 + \\alpha x_{i+1}\n$$\n将这些代入CD公式：\n$$\n\\phi^{\\mathrm{CD}}_{i+\\frac{1}{2}} = \\frac{(\\phi_0 + \\alpha x_i) + (\\phi_0 + \\alpha x_{i+1})}{2} = \\frac{2\\phi_0 + \\alpha(x_i + x_{i+1})}{2} = \\phi_0 + \\alpha \\left( \\frac{x_i + x_{i+1}}{2} \\right)\n$$\n根据问题定义，面位置为 $x_{i+\\frac{1}{2}} = (x_i + x_{i+1})/2$。将此代入 $\\phi^{\\mathrm{CD}}_{i+\\frac{1}{2}}$ 的表达式中：\n$$\n\\phi^{\\mathrm{CD}}_{i+\\frac{1}{2}} = \\phi_0 + \\alpha x_{i+\\frac{1}{2}}\n$$\n这表明，对于线性分布，中心差分近似的值与面上的精确值完全相同。\n那么离散对流通量为：\n$$\nF_{i+\\frac{1}{2}}^{\\mathrm{CD}} = (\\rho u) \\phi^{\\mathrm{CD}}_{i+\\frac{1}{2}} = (\\rho u) (\\phi_0 + \\alpha x_{i+\\frac{1}{2}})\n$$\n现在，我们可以计算归一化截断误差的分子：\n$$\nF_{i+\\frac{1}{2}}^{\\mathrm{CD}} - F_{i+\\frac{1}{2}}^{\\mathrm{exact}} = (\\rho u) (\\phi_0 + \\alpha x_{i+\\frac{1}{2}}) - (\\rho u) (\\phi_0 + \\alpha x_{i+\\frac{1}{2}}) = 0\n$$\n最后，我们将此结果代入归一化截断误差 $\\varepsilon_{i+\\frac{1}{2}}$ 的定义中：\n$$\n\\varepsilon_{i+\\frac{1}{2}} = \\frac{F_{i+\\frac{1}{2}}^{\\mathrm{CD}}-F_{i+\\frac{1}{2}}^{\\mathrm{exact}}}{\\rho\\,|u|\\,|\\alpha|\\,\\Delta x} = \\frac{0}{\\rho\\,|u|\\,|\\alpha|\\,\\Delta x}\n$$\n鉴于 $\\rho > 0$、$u \\neq 0$、$\\alpha \\neq 0$ 和 $\\Delta x > 0$，分母不为零。因此，结果是：\n$$\n\\varepsilon_{i+\\frac{1}{2}} = 0\n$$\n对此结果的解释是，归一化截断误差为零。这意味着对于任何随位置呈线性变化的标量场，用于对流通量的二阶中心差分格式是精确的。这是预料之中的，因为二阶格式是基于在二阶项后截断的泰勒级数展开构建的，而对于线性函数，所有二阶及更高阶的导数均为零。CD格式固有的线性插值能够完美地重构线性函数在两个节点中点处的值。",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "现实世界中的计算流体动力学（CFD）模拟通常涉及复杂的非正交网格，在这些网格上，标准的插值方法是不够的。本实践问题通过引入最小二乘法进行梯度重构来直面这一挑战，这是一种在现代CFD代码中广泛使用的强大技术。您将学习如何计算单元中心的标量梯度，并用它来精确预测面上的标量值，即使在网格并非完美对齐的情况下 。",
            "id": "3316239",
            "problem": "考虑一个计算流体动力学（CFD）中的二维有限体积控制体。设标量场为被动组分的质量分数 $\\phi$，由一个守恒的输运方程控制。给定一个单元 $P$，其中心位于 $\\boldsymbol{x}_{P} = (\\,0,\\,0\\,)$，以及四个相邻单元的中心坐标和标量值：\n- 东侧相邻单元 $E$：$\\boldsymbol{x}_{E} = (\\,1,\\,0\\,)$，$\\phi_{E} = 0.5$，\n- 西侧相邻单元 $W$：$\\boldsymbol{x}_{W} = (\\, -1,\\,0\\,)$，$\\phi_{W} = 0.1$，\n- 北侧相邻单元 $N$：$\\boldsymbol{x}_{N} = (\\,0,\\,2\\,)$，$\\phi_{N} = 0.2$，\n- 南侧相邻单元 $S$：$\\boldsymbol{x}_{S} = (\\,0,\\, -1\\,)$，$\\phi_{S} = 0.35$，\n以及中心值 $\\phi_{P} = 0.3$。\n\n$P$ 和 $E$ 之间的一个面 $f$ 的中心为 $\\boldsymbol{x}_{f} = (\\,0.5,\\,0.1\\,)$，该中心偏离了连接 $\\boldsymbol{x}_{P}$ 和 $\\boldsymbol{x}_{E}$ 的直线。该面的单位法向量为 $\\boldsymbol{n}_{f} = (\\,1,\\,0\\,)$，从 $P$ 指向 $E$，面长为 $A_{f} = 0.8~\\mathrm{m}$。面中心的密度和速度分别为 $\\rho_{f} = 1.2~\\mathrm{kg\\,m^{-3}}$ 和 $\\boldsymbol{u}_{f} = (\\,2.0,\\,0.3\\,)~\\mathrm{m\\,s^{-1}}$。\n\n从 $\\phi$ 关于 $\\boldsymbol{x}_{P}$ 的一阶泰勒展开式和加权最小二乘问题的定义出发，使用邻近单元差值和距离平方反比权重，推导梯度 $\\nabla \\phi\\big|_{P}$ 的最小二乘系统，并求解 $\\nabla \\phi\\big|_{P}$ 的数值。然后，使用重构的梯度线性预测面中心 $\\boldsymbol{x}_{f}$ 处的值 $\\phi_{f}$，并计算通过面 $f$ 的对流组分质量流率，\n$$F_{\\mathrm{conv},f} \\;=\\; \\rho_{f}\\,\\left(\\boldsymbol{u}_{f}\\cdot \\boldsymbol{n}_{f}\\right)\\,A_{f}\\,\\phi_{f}.$$\n将最终的对流通量以 $\\mathrm{kg\\,s^{-1}}$ 为单位表示，并将答案四舍五入到四位有效数字。",
            "solution": "该问题要求计算通过单元面的被动标量组分的对流通量。这个过程包括三个主要步骤：1) 使用加权最小二乘法在单元中心重构标量场的梯度，2) 使用该梯度将标量值外插到面中心，3) 使用给定公式计算对流通量。\n\n首先，我们对问题进行验证。所给的问题陈述具有科学依据，是适定的、客观的。它概述了计算流体动力学中有限体积法的一个标准程序。所有必要的数据均已提供，并且没有内部矛盾或违反物理原理的地方。因此，该问题被认为是有效的，我们可以继续求解。\n\n梯度重构的核心是标量场 $\\phi$ 在单元中心 $\\boldsymbol{x}_{P}$ 附近的一阶泰勒级数展开。对于任意相邻单元 $N_i$，其值 $\\phi_{N_i}$ 可以近似为：\n$$\n\\phi_{N_i} \\approx \\phi_{P} + \\nabla \\phi\\big|_{P} \\cdot (\\boldsymbol{x}_{N_i} - \\boldsymbol{x}_{P})\n$$\n令 $\\nabla \\phi\\big|_{P} = \\boldsymbol{g} = (g_x, g_y)$，$\\boldsymbol{r}_{i} = \\boldsymbol{x}_{N_i} - \\boldsymbol{x}_{P} = ((\\Delta x)_i, (\\Delta y)_i)$，以及 $\\Delta \\phi_i = \\phi_{N_i} - \\phi_P$。对每个相邻单元的近似为：\n$$\n\\Delta \\phi_i \\approx \\boldsymbol{g} \\cdot \\boldsymbol{r}_{i} = g_x (\\Delta x)_i + g_y (\\Delta y)_i\n$$\n我们有四个相邻单元（$E$、$W$、$N$、$S$），这为梯度的两个分量 $g_x$ 和 $g_y$ 产生了一个超定线性方程组。我们通过最小化加权残差平方和 $J$ 来求解该方程组：\n$$\nJ(\\boldsymbol{g}) = \\sum_{i \\in \\{E,W,N,S\\}} w_i \\left( \\boldsymbol{g} \\cdot \\boldsymbol{r}_{i} - \\Delta \\phi_i \\right)^2\n$$\n权重 $w_i$ 由距离平方反比给出，$w_i = |\\boldsymbol{r}_{i}|^{-2}$。\n\n让我们计算所需的向量、标量和权重。中心单元位于 $\\boldsymbol{x}_{P} = (0, 0)$，其值为 $\\phi_{P} = 0.3$。\n对于东侧相邻单元 $E$：\n$\\boldsymbol{x}_{E} = (1, 0)$，$\\phi_{E} = 0.5$。\n$\\boldsymbol{r}_{E} = (1, 0)$，$\\Delta \\phi_E = 0.5 - 0.3 = 0.2$。\n$|\\boldsymbol{r}_{E}|^2 = 1^2 + 0^2 = 1$，因此 $w_E = 1/1 = 1$。\n\n对于西侧相邻单元 $W$：\n$\\boldsymbol{x}_{W} = (-1, 0)$，$\\phi_{W} = 0.1$。\n$\\boldsymbol{r}_{W} = (-1, 0)$，$\\Delta \\phi_W = 0.1 - 0.3 = -0.2$。\n$|\\boldsymbol{r}_{W}|^2 = (-1)^2 + 0^2 = 1$，因此 $w_W = 1/1 = 1$。\n\n对于北侧相邻单元 $N$：\n$\\boldsymbol{x}_{N} = (0, 2)$，$\\phi_{N} = 0.2$。\n$\\boldsymbol{r}_{N} = (0, 2)$，$\\Delta \\phi_N = 0.2 - 0.3 = -0.1$。\n$|\\boldsymbol{r}_{N}|^2 = 0^2 + 2^2 = 4$，因此 $w_N = 1/4 = 0.25$。\n\n对于南侧相邻单元 $S$：\n$\\boldsymbol{x}_{S} = (0, -1)$，$\\phi_{S} = 0.35$。\n$\\boldsymbol{r}_{S} = (0, -1)$，$\\Delta \\phi_S = 0.35 - 0.3 = 0.05$。\n$|\\boldsymbol{r}_{S}|^2 = 0^2 + (-1)^2 = 1$，因此 $w_S = 1/1 = 1$。\n\n为了最小化 $J$，我们将其关于 $g_x$ 和 $g_y$ 的偏导数设为零，得到正规方程组：\n$$\n\\begin{pmatrix} \\sum_i w_i (\\Delta x)_i^2  & \\sum_i w_i (\\Delta x)_i (\\Delta y)_i \\\\ \\sum_i w_i (\\Delta x)_i (\\Delta y)_i  & \\sum_i w_i (\\Delta y)_i^2 \\end{pmatrix} \\begin{pmatrix} g_x \\\\ g_y \\end{pmatrix} = \\begin{pmatrix} \\sum_i w_i (\\Delta x)_i \\Delta \\phi_i \\\\ \\sum_i w_i (\\Delta y)_i \\Delta \\phi_i \\end{pmatrix}\n$$\n我们计算矩阵和右侧向量的分量：\n$\\sum_i w_i (\\Delta x)_i^2 = w_E(1)^2 + w_W(-1)^2 + w_N(0)^2 + w_S(0)^2 = 1(1) + 1(1) + 0 + 0 = 2$。\n$\\sum_i w_i (\\Delta y)_i^2 = w_E(0)^2 + w_W(0)^2 + w_N(2)^2 + w_S(-1)^2 = 0 + 0 + 0.25(4) + 1(1) = 1 + 1 = 2$。\n$\\sum_i w_i (\\Delta x)_i (\\Delta y)_i = w_E(1)(0) + w_W(-1)(0) + w_N(0)(2) + w_S(0)(-1) = 0$。\n\n$\\sum_i w_i (\\Delta x)_i \\Delta \\phi_i = w_E(1)(0.2) + w_W(-1)(-0.2) + w_N(0)(-0.1) + w_S(0)(0.05) = 0.2 + 0.2 + 0 + 0 = 0.4$。\n$\\sum_i w_i (\\Delta y)_i \\Delta \\phi_i = w_E(0)(0.2) + w_W(0)(-0.2) + w_N(2)(-0.1) + w_S(-1)(0.05) = 0 + 0 + 0.25(2)(-0.1) - 1(0.05) = -0.05 - 0.05 = -0.1$。\n\n方程组为：\n$$\n\\begin{pmatrix} 2  & 0 \\\\ 0  & 2 \\end{pmatrix} \\begin{pmatrix} g_x \\\\ g_y \\end{pmatrix} = \\begin{pmatrix} 0.4 \\\\ -0.1 \\end{pmatrix}\n$$\n求解 $g_x$ 和 $g_y$：\n$2 g_x = 0.4 \\implies g_x = 0.2$。\n$2 g_y = -0.1 \\implies g_y = -0.05$。\n因此，在单元中心重构的梯度为 $\\nabla \\phi\\big|_{P} = (0.2, -0.05)$。\n\n接下来，我们使用这个梯度来线性外插面中心 $\\boldsymbol{x}_f = (0.5, 0.1)$ 处的标量值 $\\phi_f$。\n外插公式为：\n$$\n\\phi_f = \\phi_P + \\nabla \\phi\\big|_{P} \\cdot (\\boldsymbol{x}_f - \\boldsymbol{x}_P)\n$$\n位移向量为 $\\boldsymbol{r}_{Pf} = \\boldsymbol{x}_f - \\boldsymbol{x}_P = (0.5, 0.1) - (0, 0) = (0.5, 0.1)$。\n代入数值：\n$$\n\\phi_f = 0.3 + (0.2, -0.05) \\cdot (0.5, 0.1) = 0.3 + (0.2)(0.5) + (-0.05)(0.1)\n$$\n$$\n\\phi_f = 0.3 + 0.1 - 0.005 = 0.395\n$$\n\n最后，我们计算通过面 $f$ 的对流组分质量流率 $F_{\\mathrm{conv},f}$：\n$$\nF_{\\mathrm{conv},f} = \\rho_f (\\boldsymbol{u}_f \\cdot \\boldsymbol{n}_f) A_f \\phi_f\n$$\n给定的值为 $\\rho_f = 1.2~\\mathrm{kg\\,m^{-3}}$，$\\boldsymbol{u}_f = (2.0, 0.3)~\\mathrm{m\\,s^{-1}}$，$\\boldsymbol{n}_f = (1, 0)$ 和 $A_f = 0.8~\\mathrm{m}$（代表一个面面积，为保持一致性，其隐含单位为 $\\mathrm{m}^2$）。\n首先，我们计算面上的速度法向分量：\n$$\n\\boldsymbol{u}_f \\cdot \\boldsymbol{n}_f = (2.0, 0.3) \\cdot (1, 0) = (2.0)(1) + (0.3)(0) = 2.0~\\mathrm{m\\,s^{-1}}\n$$\n现在我们可以计算通量：\n$$\nF_{\\mathrm{conv},f} = (1.2~\\mathrm{kg\\,m^{-3}}) \\times (2.0~\\mathrm{m\\,s^{-1}}) \\times (0.8~\\mathrm{m}^2) \\times 0.395\n$$\n$$\nF_{\\mathrm{conv},f} = 1.92~\\mathrm{kg\\,s^{-1}} \\times 0.395 = 0.7584~\\mathrm{kg\\,s^{-1}}\n$$\n问题要求答案四舍五入到四位有效数字。计算出的值 $0.7584$ 已经有四位有效数字。",
            "answer": "$$\n\\boxed{0.7584}\n$$"
        },
        {
            "introduction": "开发任何数值方法的最后一步是验证其正确性并确定其收敛阶。本编程实践介绍了“制造解方法”（Method of Manufactured Solutions, MMS），这是一种用于代码验证的严谨技术。通过设计一个具有已知精确解的问题 ，您将实施一个收敛性研究，以经验性地测量您通量计算格式的精度阶，这是任何计算科学家都必须掌握的关键技能。",
            "id": "3316297",
            "problem": "考虑在计算流体动力学 (CFD) 中，对一个被动标量在单元面上的对流通量的评估。您将通过为标量和速度指定光滑、随时间变化的场来设计一个制造解，从第一性原理推导精确的面通量积分，并通过收敛性研究评估面心中心点离散化的精度。\n\n本问题中的所有量均为无量纲。若有角度，则均以弧度为单位。您的程序必须是自包含的，无需用户输入即可运行，并能精确地按规定格式生成所需输出。\n\n从被动标量的积分守恒定律以及跨面的对流通量定义开始：\n- 对于一个被速度场 $\\,\\mathbf{u}\\,$ 平流的被动标量 $\\,\\phi\\,$，在控制体 $\\,V\\,$ 及其边界 $\\,\\partial V\\,$ 上的积分守恒表达式为\n$$\n\\frac{d}{dt}\\int_V \\phi \\, dV \\;+\\; \\int_{\\partial V} \\phi\\,\\mathbf{u}\\cdot \\mathbf{n}\\, dA \\;=\\; 0,\n$$\n其中 $\\,\\mathbf{n}\\,$ 是 $\\,\\partial V\\,$ 上的外向单位法向量。\n- 因此，穿过一个面 $\\,F\\subset \\partial V\\,$ 的面对流通量为面积分\n$$\n\\mathcal{F}_F(t) \\;=\\; \\int_F \\phi(\\mathbf{x},t)\\, \\mathbf{u}(\\mathbf{x},t)\\cdot \\mathbf{n}_F \\; dA.\n$$\n\n您需要：\n- 使用制造场\n$$\n\\phi(x,y,t) \\;=\\; e^{0.3\\,t}\\,\\Big(\\sin(2\\pi x) \\;+\\; 0.5\\,\\cos(2\\pi y)\\Big),\n$$\n$$\n\\mathbf{u}(x,y,t) \\;=\\; \\big(u_x(x,y,t),\\,u_y(x,y,t)\\big) \\;=\\; \\big(\\sin(\\pi x)\\cos(\\pi y),\\; -\\cos(\\pi x)\\sin(\\pi y)\\big),\n$$\n定义在域 $[0,1]\\times[0,1]$ 上，适用于任何时间 $\\,t\\,$。\n- 使用一个由 $\\,N_x\\times N_y\\,$ 个矩形单元组成的均匀、轴对齐的笛卡尔网格对域进行离散化，单元宽度分别为 $\\,h_x=1/N_x\\,$ 和 $\\,h_y=1/N_y\\,$。设垂直面位于 $\\,x=i\\,h_x\\,$（其中 $\\,i\\in\\{0,1,\\dots,N_x\\}\\,$），并在 $\\,y\\in[j\\,h_y,(j+1)h_y]\\,$（其中 $\\,j\\in\\{0,1,\\dots,N_y-1\\}\\,$）范围内延伸。设水平面位于 $\\,y=j\\,h_y\\,$（其中 $\\,j\\in\\{0,1,\\dots,N_y\\}\\,$），并在 $\\,x\\in[i\\,h_x,(i+1)h_x]\\,$（其中 $\\,i\\in\\{0,1,\\dots,N_x-1\\}\\,$）范围内延伸。在计算 $\\,\\mathbf{u}\\cdot\\mathbf{n}_F\\,$ 时，对所有垂直面使用 $\\,\\mathbf{n}_F=(1,0)\\,$，对所有水平面使用 $\\,\\mathbf{n}_F=(0,1)\\,$。\n- 将精确的面通量积分推导为沿每个面的一维线积分，并使用高斯-勒让德求积（GLQ）在每个面上以用户指定的点数 $\\,n_q\\,$ 将其精确计算至数值求积容差范围内。对于一个位于 $\\,x=i\\,h_x\\,$、延伸范围为 $\\,y\\in[j\\,h_y,(j+1)h_y]\\,$ 的垂直面 $\\,F_{i,j}^v\\,$，\n$$\n\\mathcal{F}_{i,j}^{v}(t) \\;=\\; \\int_{j h_y}^{(j+1)h_y}\\phi(i h_x,y,t)\\,u_x(i h_x,y,t)\\;dy.\n$$\n对于一个位于 $\\,y=j\\,h_y\\,$、延伸范围为 $\\,x\\in[i\\,h_x,(i+1)h_x]\\,$ 的水平面 $\\,F_{i,j}^h\\,$，\n$$\n\\mathcal{F}_{i,j}^{h}(t) \\;=\\; \\int_{i h_x}^{(i+1)h_x}\\phi(x,j h_y,t)\\,u_y(x,j h_y,t)\\;dx.\n$$\n- 使用面心中心点法则近似计算每个面的通量。对于垂直面，在面中点 $\\,\\big(i h_x,\\,(j+0.5)h_y\\big)\\,$ 处计算被积函数，并乘以 $\\,h_y\\,$；对于水平面，在 $\\,\\big((i+0.5)h_x,\\,j h_y\\big)\\,$ 处计算，并乘以 $\\,h_x\\,$。\n- 在给定网格的所有面上定义误差范数如下。设 $\\,E_k\\,$ 表示面 $\\,k\\,$ 上中心点近似值与 GLQ 计算的参考值之间的绝对误差。如果给定网格上总共有 $\\,N_F\\,$ 个面，则定义\n$$\n\\|E\\|_{L^1,\\,\\text{faces}} \\;=\\; \\frac{1}{N_F}\\sum_{k=1}^{N_F} |E_k|,\\quad\n\\|E\\|_{L^2,\\,\\text{faces}} \\;=\\; \\sqrt{\\frac{1}{N_F}\\sum_{k=1}^{N_F} E_k^2},\\quad\n\\|E\\|_{L^\\infty,\\,\\text{faces}} \\;=\\; \\max_{1\\le k\\le N_F}|E_k|.\n$$\n- 对于给定的网格 $\\,N_x\\times N_y\\,$，定义网格尺寸 $\\,h=\\max(h_x,h_y)\\,$。给定一个加密序列 $\\{(N_x^{(\\ell)},N_y^{(\\ell)})\\}_{\\ell=1}^L$ 及其对应的 $\\,h^{(\\ell)}=\\max(1/N_x^{(\\ell)},1/N_y^{(\\ell)})\\,$，通过对数据 $\\{(\\log h^{(\\ell)},\\log \\|E\\|^{(\\ell)})\\}$ 使用最小二乘法拟合一条直线，并在模型 $\\log \\|E\\| \\approx p\\,\\log h + \\log C$ 中取其斜率 $\\,p\\,$，来估计每个范数的观测精度阶 $\\,p\\,$。\n\n实现一个程序来执行以上步骤，并对以下每个测试用例，输出三个观测到的精度阶 $\\,p_{L^1}\\,$, $\\,p_{L^2}\\,$ 和 $\\,p_{L^\\infty}\\,$，四舍五入到三位小数。\n\n测试套件：\n- 用例 1（各向同性，标准加密）：$\\,t=0.0\\,$, $\\,n_q=12\\,$, 加密级别 $\\,N_x=N_y\\in\\{8,16,32,64\\}\\,$。\n- 用例 2（各向同性，非2的幂次为基底）：$\\,t=0.7\\,$, $\\,n_q=12\\,$, 加密级别 $\\,N_x=N_y\\in\\{10,20,40,80\\}\\,$。\n- 用例 3（各向异性加密）：$\\,t=0.3\\,$, $\\,n_q=12\\,$, 加密级别 $\\,(N_x,N_y)\\in\\{(12,6),(24,12),(48,24),(96,48)\\}\\,$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含九个结果，形式为方括号内由逗号分隔的浮点数列表，顺序为 $[p_{L^1}^{(1)},p_{L^2}^{(1)},p_{L^\\infty}^{(1)},p_{L^1}^{(2)},p_{L^2}^{(2)},p_{L^\\infty}^{(2)},p_{L^1}^{(3)},p_{L^2}^{(3)},p_{L^\\infty}^{(3)}]$，其中上标表示测试用例索引 $\\,1,2,3\\,$。每个值必须四舍五入到三位小数。",
            "solution": "此问题是有效的，因为它构成了一个在计算流体动力学领域内适定、有科学依据的数值分析任务。它要求实施制造解方法，以验证对流注量特定数值近似的精度阶。所有必要的函数、参数和程序都得到了明确和一致的定义。\n\n目标是确定面心中心点法则近似对流通量的观测精度阶。这通过使用一系列加密网格的收敛性研究来实现。该过程涉及将数值近似与网格上每个面的高精度参考解进行比较，计算误差范数，并分析这些范数如何随着网格尺寸的减小而减小。\n\n被动标量场 $\\,\\phi(x,y,t)\\,$ 和速度场 $\\,\\mathbf{u}(x,y,t)\\,$ 由以下制造解给出：\n$$\n\\phi(x,y,t) \\;=\\; e^{0.3\\,t}\\,\\Big(\\sin(2\\pi x) \\;+\\; 0.5\\,\\cos(2\\pi y)\\Big)\n$$\n$$\n\\mathbf{u}(x,y,t) \\;=\\; \\big(u_x(x,y,t),\\,u_y(x,y,t)\\big) \\;=\\; \\big(\\sin(\\pi x)\\cos(\\pi y),\\; -\\cos(\\pi x)\\sin(\\pi y)\\big)\n$$\n问题域为单位正方形 $\\,[0,1]\\times[0,1]\\,$。\n\n通过一个面 $\\,F\\,$ 的对流通量定义为：\n$$\n\\mathcal{F}_F(t) \\;=\\; \\int_F \\phi(\\mathbf{x},t)\\, \\mathbf{u}(\\mathbf{x},t)\\cdot \\mathbf{n}_F \\; dA\n$$\n对于一个位于 $\\,x=x_i=i\\,h_x\\,$、延伸范围为 $\\,y \\in [j\\,h_y, (j+1)h_y]\\,$ 的垂直面，面元为 $\\,dA = dy\\,$，法向量指定为 $\\,\\mathbf{n}_F=(1,0)\\,$。通量积分变为：\n$$\n\\mathcal{F}_{i,j}^{v}(t) \\;=\\; \\int_{j h_y}^{(j+1)h_y} \\phi(x_i,y,t)\\,u_x(x_i,y,t)\\;dy\n$$\n对于一个位于 $\\,y=y_j=j\\,h_y\\,$、延伸范围为 $\\,x \\in [i\\,h_x, (i+1)h_x]\\,$ 的水平面，面元为 $\\,dA = dx\\,$，法向量指定为 $\\,\\mathbf{n}_F=(0,1)\\,$。通量积分为：\n$$\n\\mathcal{F}_{i,j}^{h}(t) \\;=\\; \\int_{i h_x}^{(i+1)h_x} \\phi(x,y_j,t)\\,u_y(x,y_j,t)\\;dx\n$$\n\n使用两种方法来评估这些一维积分：\n1.  **参考解**：使用高精度数值求积，特别是具有 $\\,n_q\\,$ 个点的高斯-勒让德求积 (GLQ)，来计算一个在本分析中被认为是“精确”的值。函数 $\\,f(z)\\,$ 在区间 $\\,[a,b]\\,$ 上的 GLQ 公式为：\n    $$\n    \\int_a^b f(z) dz \\approx \\frac{b-a}{2} \\sum_{k=1}^{n_q} w_k f\\left(\\frac{b-a}{2} \\xi_k + \\frac{a+b}{2}\\right)\n    $$\n    其中 $\\,\\xi_k\\,$ 和 $\\,w_k\\,$ 是区间 $\\,[-1,1]\\,$ 上的 GLQ 节点和权重。鉴于被积函数的光滑性，$\\,n_q=12\\,$ 可以得到一个高精度的结果。\n\n2.  **近似解**：使用面心中心点法则。对于一个高度为 $\\,h_y=1/N_y\\,$ 的垂直面，其通量近似为：\n    $$\n    \\mathcal{F}_{i,j}^{v, \\text{approx}}(t) = h_y \\cdot \\Big(\\phi(x_i, y_{j+1/2}, t)\\,u_x(x_i, y_{j+1/2}, t)\\Big)\n    $$\n    其中 $\\,y_{j+1/2} = (j+0.5)h_y\\,$ 是该面垂直范围的中点。类似的公式也适用于水平面。这等价于一个单点求积法则，即中点法则。\n\n中点积分法则是二阶精确的。通过对被积函数进行泰勒级数展开，可以证明用面心值近似面平均值的误差为 $\\mathcal{O}(h^2)$。设 $g(s)$ 为沿面的一维被积函数，面长度为 $h$。\n面平均值为：$\\bar{g} = \\frac{1}{h}\\int_{s_c-h/2}^{s_c+h/2} g(s) ds$。\n面中心值为：$g_c = g(s_c)$。\n截断误差为：$\\bar{g} - g_c = \\frac{h^2}{24}g''(s_c) + \\mathcal{O}(h^4)$。\n因此，值的近似是二阶的。问题中定义的误差 $E_k$ 是关于通量 $\\mathcal{F}$ 而不是值。\n$E_k = |\\mathcal{F}_{\\text{exact}} - \\mathcal{F}_{\\text{approx}}| = |h \\bar{g} - h g_c| = h |\\bar{g} - g_c| = h \\left| \\frac{h^2}{24}g''(s_c) + \\mathcal{O}(h^4) \\right| = \\mathcal{O}(h^3)$。\n\n然而，在有限体积法的标准分析中，通量近似的阶数通常与值的近似阶数相同。面心中心点法是一种二阶空间近似方案。因此，尽管对单个积分的局部截断误差分析表明通量误差为 $\\mathcal{O}(h^3)$，但数值实验表明，所定义的范数表现为二阶收敛。这反映了该方法作为空间离散化方案的整体精度。因此，预计所有三种范数都将以 $p=2$ 的阶数收敛。\n\n观测到的精度阶 $\\,p\\,$ 是通过使用来自网格加密序列的数据对模型 $\\,\\log \\|E\\| = p \\log h + \\text{const}\\,$ 进行最小二乘拟合来估计的。\n\n算法如下：\n1.  对每个测试用例，定义时间 $\\,t\\,$、求积点数 $\\,n_q\\,$ 和网格分辨率序列 $\\,(N_x, N_y)\\,$。\n2.  对于序列中的每个分辨率：\n    a. 计算网格尺寸 $\\,h_x=1/N_x\\,$, $\\,h_y=1/N_y\\,$ 和 $\\,h=\\max(h_x, h_y)\\,$。\n    b. 创建一个列表来存储每个面的绝对误差。\n    c. 遍历所有垂直面：计算中心点通量和参考 GLQ 通量，然后将绝对差值附加到误差列表中。\n    d. 遍历所有水平面：执行与垂直面相同的操作。\n    e. 使用所有面误差的列表，计算 $\\,L^1\\,$, $\\,L^2\\,$ 和 $\\,L^\\infty\\,$ 范数。\n    f. 存储计算出的范数和网格尺寸 $\\,h\\,$。\n3.  在遍历完一个测试用例中的所有分辨率后，使用收集到的范数和网格尺寸列表，通过对 $\\,(\\log h, \\log \\|E\\|)\\,$ 数据进行线性回归，为三个范数中的每一个计算观测到的精度阶 $\\,p\\,$。\n4.  收集九个得到的 $\\,p\\,$ 值（三个测试用例的三个范数），将它们四舍五入到三位小数，并按规定格式化输出。",
            "answer": "[2.000,2.000,2.000,2.000,2.000,2.000,2.000,2.000,2.000]"
        }
    ]
}