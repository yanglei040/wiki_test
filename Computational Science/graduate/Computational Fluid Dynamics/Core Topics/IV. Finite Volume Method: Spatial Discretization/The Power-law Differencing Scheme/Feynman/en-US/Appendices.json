{
    "hands_on_practices": [
        {
            "introduction": "To master a numerical scheme, one must first understand its fundamental building blocks. This exercise deconstructs the power-law scheme's neighbor coefficient into its distinct convective and diffusive components. By performing a direct calculation for a convection-dominated flow (high Péclet number), you will see precisely how the scheme actively suppresses the diffusive flux and enforces an upwind bias, a mechanism crucial for ensuring numerical stability .",
            "id": "3378097",
            "problem": "Consider the steady one-dimensional convection–diffusion transport of a scalar field $\\phi(x)$ in a uniform grid within Computational Fluid Dynamics (CFD). Using the Finite Volume Method (FVM), focus on a control volume with centroid $P$ and its east face $e$ adjoining the neighbor node $E$. Let the east-face mass flux be $F_{e}$ and the diffusion conductance be $D_{e}$, so that the face Péclet number is $P_{e} = F_{e}/D_{e}$. In the power-law differencing scheme, the east-face neighbor coefficient $a_{E}$ comprises two parts: a diffusive contribution scaled by a suppression function of the Péclet number and an upwind convective contribution controlled by the sign of $F_{e}$.\n\nAssume $P_{e} = 5$ and that the mass flux is positive, $F_{e} > 0$. For this face, compute the value of the suppression function $A(P_{e})$ given by $A(P_{e}) = (1 - 0.1 \\times 5)^{5}$, determine the two contributions to $a_{E}$ from diffusion and upwind convection (that is, $D_{e} A(P_{e})$ and $\\max(-F_{e}, 0)$), and interpret the resulting balance between diffusion and upwind convection at the face in terms of the neighbor coupling.\n\nReport as your final answer the dimensionless neighbor coefficient $a_{E}/D_{e}$. No rounding is required, and the quantity is dimensionless (no units).",
            "solution": "The problem asks for the computation of the dimensionless neighbor coefficient $a_{E}/D_{e}$ for a specific case using the power-law differencing scheme in the context of the Finite Volume Method (FVM).\n\nThe problem states that the east-face neighbor coefficient $a_{E}$ is composed of a diffusive contribution and an upwind convective contribution. This can be written as:\n$$a_{E} = (\\text{diffusive contribution}) + (\\text{convective contribution})$$\n\nAccording to the problem description, these contributions are:\n1. Diffusive contribution: $D_{e} A(P_{e})$, where $A(P_{e})$ is a suppression function of the Péclet number $P_{e}$.\n2. Convective contribution: $\\max(-F_{e}, 0)$, which represents the upwind nature of the scheme. Here, $F_{e}$ is the mass flux at the east face.\n\nTherefore, the full expression for the neighbor coefficient $a_{E}$ is:\n$$a_{E} = D_{e} A(P_{e}) + \\max(-F_{e}, 0)$$\n\nWe are given the following information:\n- The face Péclet number is $P_{e} = 5$.\n- The mass flux is positive, $F_{e} > 0$.\n- The suppression function is defined for this case as $A(P_{e}) = (1 - 0.1 \\times 5)^{5}$. Note that the standard power-law scheme uses the absolute value of the Péclet number, i.e., $A(|P_e|)$. However, since $F_e > 0$ and the diffusion conductance $D_e$ is inherently positive, $P_e = F_e/D_e > 0$, so $|P_e| = P_e$.\n\nWe will now compute the two contributions to $a_{E}$ separately.\n\nFirst, we compute the value of the suppression function $A(P_{e})$:\n$$A(P_{e}) = A(5) = (1 - 0.1 \\times 5)^{5} = (1 - 0.5)^{5} = (0.5)^{5}$$\nExpressing $0.5$ as a fraction, we get:\n$$A(5) = \\left(\\frac{1}{2}\\right)^{5} = \\frac{1^{5}}{2^{5}} = \\frac{1}{32}$$\n\nThe diffusive contribution to $a_{E}$ is therefore:\n$$\\text{Diffusive contribution} = D_{e} A(5) = D_{e} \\times \\frac{1}{32} = \\frac{D_{e}}{32}$$\n\nNext, we compute the convective contribution. We are given that the mass flux is positive, $F_{e} > 0$. This implies that the term $-F_{e}$ is negative.\n$$\\text{Convective contribution} = \\max(-F_{e}, 0)$$\nSince $-F_{e} < 0$, the maximum of this value and $0$ is $0$.\n$$\\text{Convective contribution} = 0$$\n\nNow, we combine the two contributions to find the total neighbor coefficient $a_{E}$:\n$$a_{E} = \\frac{D_{e}}{32} + 0 = \\frac{D_{e}}{32}$$\n\nInterpretation of the result:\nThe Péclet number $P_{e} = 5$ indicates a flow where convection is significantly stronger than diffusion (a common threshold is $|P_{e}| > 2$). The power-law scheme responds to this by suppressing the diffusive flux. The suppression function $A(5) = 1/32$ reduces the diffusive coupling to only about $3.125\\%$ of what it would be in a pure diffusion scenario. The convective contribution to the neighbor coefficient $a_{E}$ is zero because the flow direction is positive ($F_{e} > 0$), meaning the flow is from node $P$ towards node $E$. In an upwind scheme, the downstream node $E$ does not convectively influence the interface $e$. Thus, the coupling between nodes $P$ and $E$ is purely due to the heavily suppressed diffusion.\n\nThe problem asks for the final answer to be the dimensionless neighbor coefficient $a_{E}/D_{e}$. We can compute this ratio using our expression for $a_{E}$:\n$$\\frac{a_{E}}{D_{e}} = \\frac{D_{e}/32}{D_{e}} = \\frac{1}{32}$$",
            "answer": "$$\n\\boxed{\\frac{1}{32}}\n$$"
        },
        {
            "introduction": "Numerical schemes for convection-diffusion are clever approximations of the true physical behavior. The power-law formulation, for instance, is a computationally inexpensive polynomial approximation of the exact exponential solution profile. This analytical exercise guides you through a formal error analysis, using Taylor series to derive the leading-order error introduced by this approximation . This process provides deep insight into why the scheme's accuracy is inherently tied to the local Péclet number, $P$.",
            "id": "3378094",
            "problem": "Consider steady, one-dimensional convection–diffusion of a passive scalar $\\phi(x)$ with constant density $\\rho$, constant velocity $u>0$, and constant diffusivity $\\Gamma$ on a uniform grid with nodes at $x_W$ and $x_P$ separated by distance $\\Delta x$. Let the west face $f$ be located at the midpoint $x_f = (x_W + x_P)/2$. The steady conservation law over $(x_W,x_P)$ reduces to the ordinary differential equation $\\Gamma \\,\\frac{d^2 \\phi}{dx^2} - \\rho u \\,\\frac{d \\phi}{dx} = 0$. The exact local solution on $(x_W,x_P)$ with boundary values $\\phi(x_W)=\\phi_W$ and $\\phi(x_P)=\\phi_P$ yields a face value of the form $\\phi_f^{\\mathrm{exact}} = \\phi_W + (\\phi_P - \\phi_W)\\,E(P)$, where $P \\equiv \\rho u \\Delta x / \\Gamma$ is the cell Péclet number and $E(P)$ is the exact midpoint weighting implied by the analytical solution. In practical differencing schemes for convection–diffusion, including the power-law differencing scheme, the exact weighting $E(P)$ is replaced by an approximation $A(P)$ that depends on $P$ but is not necessarily the exact exponential form. Define the local gradient approximation $g \\equiv (\\phi_P - \\phi_W)/\\Delta x$. Assume $A(P)$ is differentiable at $P=0$ and satisfies the diffusion-limit consistency $A(0)=\\tfrac{1}{2}$. Starting from the governing equation and the analytical solution on $(x_W,x_P)$, derive the leading-order modeling error in the face value,\n$$\\delta \\phi_f \\equiv \\phi_f^{A} - \\phi_f^{\\mathrm{exact}},$$\nas an explicit function of $P$, $g$, and the derivative $A'(0)$. Express your final answer as a single closed-form algebraic expression in terms of $P$, $g$, $\\Delta x$, and $A'(0)$. No numerical evaluation is required, and no units should be included in the final expression.",
            "solution": "The objective is to derive the leading-order modeling error in the face value of a passive scalar $\\phi$, defined as $\\delta \\phi_f \\equiv \\phi_f^{A} - \\phi_f^{\\mathrm{exact}}$. The error arises from using an approximate weighting function $A(P)$ in place of the exact weighting function $E(P)$.\n\nThe definitions for the exact and approximate face values are given as:\n$$ \\phi_f^{\\mathrm{exact}} = \\phi_W + (\\phi_P - \\phi_W)\\,E(P) $$\n$$ \\phi_f^{A} = \\phi_W + (\\phi_P - \\phi_W)\\,A(P) $$\nwhere $P \\equiv \\rho u \\Delta x / \\Gamma$ is the cell Péclet number, and $\\phi_W$ and $\\phi_P$ are the nodal values of the scalar.\n\nSubtracting the first equation from the second gives the modeling error:\n$$ \\delta \\phi_f = (\\phi_f^{A} - \\phi_f^{\\mathrm{exact}}) = \\left( \\phi_W + (\\phi_P - \\phi_W)A(P) \\right) - \\left( \\phi_W + (\\phi_P - \\phi_W)E(P) \\right) $$\n$$ \\delta \\phi_f = (\\phi_P - \\phi_W) \\left( A(P) - E(P) \\right) $$\n\nTo find the leading-order error for small $P$, we need to find the Taylor series expansions of $A(P)$ and $E(P)$ around $P=0$.\n\nFirst, we derive the exact weighting function $E(P)$. This requires solving the governing steady, one-dimensional convection–diffusion equation on the interval $(x_W, x_P)$:\n$$ \\Gamma \\,\\frac{d^2 \\phi}{dx^2} - \\rho u \\,\\frac{d \\phi}{dx} = 0 $$\nwith boundary conditions $\\phi(x_W) = \\phi_W$ and $\\phi(x_P) = \\phi_P$.\nLet us define a local coordinate $\\xi = x - x_W$, so that $\\xi$ ranges from $0$ to $\\Delta x$. The equation becomes:\n$$ \\frac{d^2 \\phi}{d\\xi^2} - \\frac{\\rho u}{\\Gamma} \\frac{d \\phi}{d\\xi} = 0 $$\nIntroducing the Péclet number $P = \\rho u \\Delta x / \\Gamma$, we have $\\rho u / \\Gamma = P / \\Delta x$. The ODE is:\n$$ \\frac{d^2 \\phi}{d\\xi^2} - \\frac{P}{\\Delta x} \\frac{d \\phi}{d\\xi} = 0 $$\nThis is a second-order linear homogeneous ordinary differential equation with constant coefficients. The characteristic equation is $r^2 - \\frac{P}{\\Delta x} r = 0$, with roots $r_1=0$ and $r_2=P/\\Delta x$.\nThe general solution is of the form:\n$$ \\phi(\\xi) = C_1 + C_2 \\exp\\left(\\frac{P}{\\Delta x}\\xi\\right) $$\nApplying the boundary conditions $\\phi(0) = \\phi_W$ and $\\phi(\\Delta x) = \\phi_P$:\nAt $\\xi=0$: $C_1 + C_2 = \\phi_W$.\nAt $\\xi=\\Delta x$: $C_1 + C_2 \\exp(P) = \\phi_P$.\nSolving this system for $C_1$ and $C_2$ yields:\n$$ C_2 = \\frac{\\phi_P - \\phi_W}{\\exp(P) - 1} $$\n$$ C_1 = \\phi_W - C_2 = \\phi_W - \\frac{\\phi_P - \\phi_W}{\\exp(P) - 1} = \\frac{\\phi_W \\exp(P) - \\phi_P}{\\exp(P) - 1} $$\nThe exact solution is:\n$$ \\phi(\\xi) = \\frac{\\phi_W \\exp(P) - \\phi_P}{\\exp(P) - 1} + \\frac{\\phi_P - \\phi_W}{\\exp(P) - 1} \\exp\\left(\\frac{P}{\\Delta x}\\xi\\right) $$\nWe are interested in the value at the face $f$, located at $x_f = (x_W + x_P)/2$, which corresponds to $\\xi_f = \\Delta x / 2$.\n$$ \\phi_f^{\\mathrm{exact}} = \\phi(\\Delta x / 2) = \\frac{\\phi_W \\exp(P) - \\phi_P}{\\exp(P) - 1} + \\frac{\\phi_P - \\phi_W}{\\exp(P) - 1} \\exp\\left(\\frac{P}{2}\\right) $$\nTo find $E(P)$, we rearrange this into the form $\\phi_W + (\\phi_P - \\phi_W)E(P)$:\n$$ \\phi_f^{\\mathrm{exact}} - \\phi_W = \\frac{\\phi_W \\exp(P) - \\phi_P + (\\phi_P - \\phi_W)\\exp(P/2) - \\phi_W(\\exp(P)-1)}{\\exp(P)-1} $$\n$$ \\phi_f^{\\mathrm{exact}} - \\phi_W = \\frac{-\\phi_P + \\phi_P\\exp(P/2) - \\phi_W\\exp(P/2) + \\phi_W}{\\exp(P)-1} $$\n$$ \\phi_f^{\\mathrm{exact}} - \\phi_W = \\frac{(\\phi_P-\\phi_W)\\exp(P/2) - (\\phi_P-\\phi_W)}{\\exp(P)-1} = (\\phi_P - \\phi_W) \\frac{\\exp(P/2) - 1}{\\exp(P) - 1} $$\nBy comparison with the definition of $\\phi_f^{\\mathrm{exact}}$, we identify the exact weighting function:\n$$ E(P) = \\frac{\\exp(P/2) - 1}{\\exp(P) - 1} $$\nThis can be simplified for $P \\ne 0$ to $E(P) = \\frac{1}{\\exp(P/2) + 1}$.\n\nNext, we find the Taylor series expansion for $E(P)$ around $P=0$.\n$$ E(0) = \\lim_{P\\to 0} \\frac{\\exp(P/2) - 1}{\\exp(P) - 1} = \\lim_{P\\to 0} \\frac{\\frac{1}{2}\\exp(P/2)}{\\exp(P)} = \\frac{1}{2} $$\nThe first derivative is $E'(P) = \\frac{d}{dP} \\left( (\\exp(P/2) + 1)^{-1} \\right) = -(\\exp(P/2) + 1)^{-2} \\cdot \\frac{1}{2}\\exp(P/2)$.\nEvaluating at $P=0$:\n$$ E'(0) = -\\frac{1}{2}\\frac{\\exp(0)}{(\\exp(0)+1)^2} = -\\frac{1}{2(1+1)^2} = -\\frac{1}{8} $$\nA property of $E(P)$ is that the function $E(P) - 1/2$ is an odd function of $P$. This implies that its Taylor series contains only odd powers of $P$, so the coefficient of $P^2$ is zero.\nThus, the expansion of $E(P)$ up to the first order is:\n$$ E(P) = E(0) + E'(0)P + O(P^3) = \\frac{1}{2} - \\frac{1}{8}P + O(P^3) $$\n\nFor the approximate weighting function $A(P)$, we are given that it is differentiable at $P=0$ and satisfies the diffusion-limit consistency $A(0) = 1/2$. Its Taylor series expansion is:\n$$ A(P) = A(0) + A'(0)P + O(P^2) = \\frac{1}{2} + A'(0)P + O(P^2) $$\n\nNow we can find the leading-order expression for the error $\\delta\\phi_f$:\n$$ \\delta \\phi_f = (\\phi_P - \\phi_W) (A(P) - E(P)) $$\n$$ \\delta \\phi_f = (\\phi_P - \\phi_W) \\left[ \\left(\\frac{1}{2} + A'(0)P + O(P^2)\\right) - \\left(\\frac{1}{2} - \\frac{1}{8}P + O(P^3)\\right) \\right] $$\n$$ \\delta \\phi_f = (\\phi_P - \\phi_W) \\left[ \\left(A'(0) + \\frac{1}{8}\\right)P + O(P^2) \\right] $$\nThe leading-order term of the error is the term proportional to $P$:\n$$ \\delta \\phi_f^{\\mathrm{leading}} = (\\phi_P - \\phi_W) \\left(A'(0) + \\frac{1}{8}\\right)P $$\n\nFinally, we use the definition of the local gradient, $g \\equiv (\\phi_P - \\phi_W)/\\Delta x$, to substitute for the difference in scalar values, $\\phi_P - \\phi_W = g \\Delta x$.\n$$ \\delta \\phi_f^{\\mathrm{leading}} = (g \\Delta x) \\left(A'(0) + \\frac{1}{8}\\right)P $$\nRearranging the terms gives the final expression for the leading-order modeling error:\n$$ \\delta \\phi_f^{\\mathrm{leading}} = \\left(A'(0) + \\frac{1}{8}\\right) P g \\Delta x $$",
            "answer": "$$\n\\boxed{\\left(A'(0) + \\frac{1}{8}\\right) P g \\Delta x}\n$$"
        },
        {
            "introduction": "Theoretical analysis provides indispensable insight, but its predictions must be confirmed through rigorous numerical testing. The Method of Manufactured Solutions (MMS) is the standard for verifying the implementation of a numerical method and measuring its convergence rate. This comprehensive coding practice challenges you to implement the power-law scheme and use MMS to conduct a scaling study . You will numerically verify the scheme's theoretical order of accuracy and observe how it transitions from second-order in diffusion-dominated flows to first-order when convection prevails.",
            "id": "3378103",
            "problem": "Consider the one-dimensional, steady convection–diffusion equation for a scalar field $\\phi(x)$ on a domain $[0,1]$ with constant density $\\rho$, constant velocity $u$, and constant diffusivity $\\Gamma$,\n$$\\frac{d}{dx}\\left(\\Gamma \\frac{d\\phi}{dx}\\right) - \\rho u \\frac{d\\phi}{dx} = S(x),$$\nwritten in a conservative finite volume form over a uniform grid of control volumes of width $\\Delta x$ with unit cross-sectional area. Let the west and east faces of a control volume be denoted by $w$ and $e$, respectively, and let the adjacent control volume centers be $W$, $P$, and $E$. Define the diffusive conductance at a face by $D = \\Gamma / \\Delta x$ and the mass flux at a face by $F = \\rho u$. The local face Peclet number is $P = F / D$. Use the following power-law function to model the effect of convection on the face interpolation:\n$$A(P) = \\max\\{0,\\left(1-0.1|P|\\right)^5\\}.$$\n\nTask 1 (Derivation): Starting from the conservative integral form and flux balance at control volume faces, derive the discrete coefficients $a_W$, $a_E$, and $a_P$ for the interior control volume $P$ when the source term is linearized in the form $S = S_u + S_P \\phi$ with $S_P = 0$, and the convective term uses upwind weighting at each face while the diffusive term is modulated by the power-law function $A(P)$. Express $a_W$, $a_E$, and $a_P$ in terms of $D$, $F$, and $A(P)$.\n\nTask 2 (Manufactured solution and truncation error): Construct a manufactured solution $\\phi(x)$ and source $S(x)$, and measure the truncation error produced by substituting the exact $\\phi$ into the discrete equation with the coefficients from Task 1. Use the manufactured solution\n$$\\phi(x) = \\sin(2\\pi x),$$\nand choose $S(x)$ such that the continuous equation is satisfied exactly for constant $\\rho$ and constant $\\Gamma$. Assume Dirichlet boundary conditions consistent with the manufactured solution, i.e., $\\phi(0)$ and $\\phi(1)$ equal to the exact values at the boundaries. Derive an exact expression for the control volume source contribution $S_u$ as the integral of $S(x)$ over the control volume $[x_w,x_e]$ where $x_w$ and $x_e$ are the west and east face positions. Define the truncation error at control volume $P$ by\n$$\\mathrm{TE}_P = a_W \\phi_W + a_E \\phi_E - a_P \\phi_P - S_u,$$\nwhere $\\phi_W$, $\\phi_P$, and $\\phi_E$ are the exact manufactured solution values at the west neighbor, current, and east neighbor control volume centers (with boundary values used where neighbors fall outside the domain). Use the root-mean-square norm of the truncation error over all control volumes to characterize its magnitude:\n$$\\|\\mathrm{TE}\\|_{\\mathrm{RMS}} = \\sqrt{\\frac{1}{N}\\sum_{i=1}^{N} \\left(\\mathrm{TE}_{i}\\right)^2},$$\nwhere $N$ is the number of control volumes.\n\nTask 3 (Scaling study across Peclet regimes): Study how $\\|\\mathrm{TE}\\|_{\\mathrm{RMS}}$ scales with $\\Delta x$ for three Peclet regimes. To isolate Peclet effects from grid refinement, enforce a target face Peclet number $P^\\star$ that is held constant across grid refinements by choosing the velocity $u$ such that $|P| = P^\\star$ for all faces, i.e.,\n$$u = \\frac{P^\\star \\Gamma}{\\rho \\Delta x}.$$\nUse constant properties $\\rho = 1$ and $\\Gamma = 1$, and a positive velocity $u$. Compute the scaling exponent $\\alpha$ that best fits\n$$\\|\\mathrm{TE}\\|_{\\mathrm{RMS}} \\approx C (\\Delta x)^\\alpha,$$\nby performing a least-squares linear regression of $\\log\\left(\\|\\mathrm{TE}\\|_{\\mathrm{RMS}}\\right)$ versus $\\log(\\Delta x)$ across a set of grid sizes. Report $\\alpha$ for each Peclet regime.\n\nTest suite specification:\n- Domain length $L = 1$.\n- Property values $\\rho = 1$ and $\\Gamma = 1$.\n- Manufactured solution $\\phi(x) = \\sin(2\\pi x)$ and Dirichlet boundary conditions $\\phi(0)$ and $\\phi(1)$ equal to the exact solution.\n- Grid sizes $N \\in \\{20,40,80,160,320\\}$, so that $\\Delta x = L/N$.\n- Target face Peclet numbers $P^\\star \\in \\{0.01, 2, 20\\}$ corresponding to $P \\ll 1$, $P \\sim \\mathcal{O}(1)$, and $P \\gg 1$, respectively.\n\nYour program must:\n- Implement the derivation by constructing the discrete coefficients in terms of $D$, $F$, and $A(P)$.\n- Compute the exact source $S(x)$ from the manufactured solution and integrate it exactly over each control volume to obtain $S_u$.\n- For each combination of $N$ and $P^\\star$, compute $\\|\\mathrm{TE}\\|_{\\mathrm{RMS}}$, then fit the scaling exponent $\\alpha$ across the set of $N$ values for each $P^\\star$.\n- Produce a single line of output containing the three fitted exponents $\\alpha$ for $P^\\star = 0.01$, $P^\\star = 2$, and $P^\\star = 20$, in that order. Express each $\\alpha$ as a dimensionless real number. The final output format must be a comma-separated list enclosed in square brackets, for example, \n$$[\\alpha_{0.01},\\alpha_{2},\\alpha_{20}].$$",
            "solution": "The user has provided a multi-part problem in the field of computational fluid dynamics, focusing on the analysis of a power-law differencing scheme. I will first validate the problem statement and then proceed to a complete solution.\n\n### Step 1: Extract Givens\n\n**Governing Equation:**\nThe one-dimensional, steady convection–diffusion equation for a scalar field $\\phi(x)$ is given as:\n$$ \\frac{d}{dx}\\left(\\Gamma \\frac{d\\phi}{dx}\\right) - \\rho u \\frac{d\\phi}{dx} = S(x) $$\non the domain $[0,1]$. The properties $\\rho$ (density), $u$ (velocity), and $\\Gamma$ (diffusivity) are constant.\n\n**Finite Volume Discretization:**\n- A uniform grid of $N$ control volumes (CVs) of width $\\Delta x$ is used.\n- Control volume centers are denoted by $W$ (west neighbor), $P$ (current), and $E$ (east neighbor).\n- Control volume faces are denoted by $w$ (west) and $e$ (east).\n- Diffusive conductance at a face: $D = \\Gamma / \\Delta x$.\n- Mass flux at a face: $F = \\rho u$.\n- Local face Peclet number: $P = F / D$.\n- The source term is linearized as $S = S_u + S_P \\phi$, with $S_P = 0$.\n- The power-law function for modulating diffusion is: $A(P) = \\max\\{0,\\left(1-0.1|P|\\right)^5\\}$.\n\n**Task 1 (Derivation):**\n- Derive the discrete coefficients $a_W$, $a_E$, and $a_P$ for an interior control volume $P$.\n- The formulation requires using upwind weighting for the convective term and modulating the diffusive term with $A(P)$.\n- The final discrete equation form is $a_W \\phi_W + a_E \\phi_E - a_P \\phi_P - S_u = 0$, where $S_u$ is the integrated source over the CV.\n\n**Task 2 (Manufactured Solution and Truncation Error):**\n- Manufactured solution: $\\phi(x) = \\sin(2\\pi x)$.\n- The source term $S(x)$ is to be chosen such that the continuous equation is exactly satisfied.\n- Dirichlet boundary conditions are $\\phi(0)$ and $\\phi(1)$, consistent with the exact solution.\n- The control volume source $S_u$ is the exact integral of $S(x)$ over the CV, $[x_w, x_e]$.\n- Truncation error definition for CV $P$: $\\mathrm{TE}_P = a_W \\phi_W + a_E \\phi_E - a_P \\phi_P - S_u$.\n- Root-mean-square norm of truncation error: $\\|\\mathrm{TE}\\|_{\\mathrm{RMS}} = \\sqrt{\\frac{1}{N}\\sum_{i=1}^{N} \\left(\\mathrm{TE}_{i}\\right)^2}$.\n\n**Task 3 (Scaling Study):**\n- Study the scaling of $\\|\\mathrm{TE}\\|_{\\mathrm{RMS}}$ with $\\Delta x$.\n- A target face Peclet number $P^\\star$ is held constant for each scaling study by setting the velocity $u = \\frac{P^\\star \\Gamma}{\\rho \\Delta x}$.\n- The velocity $u$ is positive.\n- A least-squares linear regression of $\\log\\left(\\|\\mathrm{TE}\\|_{\\mathrm{RMS}}\\right)$ vs. $\\log(\\Delta x)$ is used to find the scaling exponent $\\alpha$ in $\\|\\mathrm{TE}\\|_{\\mathrm{RMS}} \\approx C (\\Delta x)^\\alpha$.\n\n**Test Suite Specification:**\n- Domain length: $L = 1$.\n- Properties: $\\rho = 1$, $\\Gamma = 1$.\n- Boundary conditions: $\\phi(0) = \\sin(0) = 0$ and $\\phi(1) = \\sin(2\\pi) = 0$.\n- Grid sizes: $N \\in \\{20, 40, 80, 160, 320\\}$, with $\\Delta x = L/N$.\n- Target Peclet numbers: $P^\\star \\in \\{0.01, 2, 20\\}$.\n\n### Step 2: Validate Using Extracted Givens\n\n1.  **Scientific Groundedness**: The problem is grounded in the well-established field of computational fluid dynamics. The convection-diffusion equation is fundamental, and the finite volume method is a standard discretization technique. The power-law scheme is a known method for handling convection-dominated flows. The method of manufactured solutions is a rigorous, standard procedure for verifying numerical code and analyzing truncation error. All aspects are scientifically sound.\n2.  **Well-Posedness**: The tasks are clearly defined. The derivation in Task 1, while based on a slightly unconventional description of the scheme, leads to the standard power-law scheme coefficients, making it unambiguous. The analysis in Tasks 2 and 3 provides a clear path to a unique numerical result. The setup, including the manufactured solution and boundary conditions, is complete.\n3.  **Objectivity**: The problem is stated in precise, objective mathematical and computational terms. There are no subjective or opinion-based statements.\n4.  **Completeness and Consistency**: The problem provides all necessary data and definitions. There is a minor inconsistency where the preamble states \"$u$ is constant\", but Task 3 requires varying $u$ with $\\Delta x$. This is interpreted as a task-specific condition that overrides the general statement for the purpose of a particular numerical experiment. This is a common structure in academic problems and does not invalidate the problem; it simply defines a specific, non-standard scaling analysis.\n\n### Step 3: Verdict and Action\n\nThe problem is **valid**. It is a well-posed, scientifically sound, and comprehensive exercise in numerical analysis for CFD. I will proceed with the full solution.\n\n### Task 1: Derivation of Discrete Coefficients\n\nWe start by integrating the governing equation over a control volume $P$, from its west face $w$ at position $x_w$ to its east face $e$ at position $x_e$:\n$$ \\int_{x_w}^{x_e} \\frac{d}{dx}\\left(\\Gamma \\frac{d\\phi}{dx}\\right) dx - \\int_{x_w}^{x_e} \\rho u \\frac{d\\phi}{dx} dx = \\int_{x_w}^{x_e} S(x) dx $$\nApplying the fundamental theorem of calculus to the first term and recognizing the definition of $S_u$:\n$$ \\left(\\Gamma \\frac{d\\phi}{dx}\\right)_e - \\left(\\Gamma \\frac{d\\phi}{dx}\\right)_w - \\int_{x_w}^{x_e} \\rho u \\frac{d\\phi}{dx} dx = S_u $$\nThe problem states a non-standard formulation for the discretization. It asks to discretize the convective and diffusive parts separately.\n1.  **Diffusive Flux**: The diffusive flux term $\\Gamma \\frac{d\\phi}{dx}$ is approximated using a central difference scheme, modulated by the power-law function $A(P)$.\n    At face $e$: $\\left(\\Gamma \\frac{d\\phi}{dx}\\right)_e \\approx \\Gamma A(P_e) \\frac{\\phi_E - \\phi_P}{\\Delta x} = D A(P_e) (\\phi_E - \\phi_P)$.\n    At face $w$: $\\left(\\Gamma \\frac{d\\phi}{dx}\\right)_w \\approx \\Gamma A(P_w) \\frac{\\phi_P - \\phi_W}{\\Delta x} = D A(P_w) (\\phi_P - \\phi_W)$.\n    Since $\\rho, u, \\Gamma, \\Delta x$ are constant over the grid, $P_e=P_w=P$ and $D_e=D_w=D$.\n\n2.  **Convective Term**: The integrated convective term, $\\int_{x_w}^{x_e} \\rho u \\frac{d\\phi}{dx} dx$, is discretized using upwind weighting. The integral can be approximated as $(\\rho u)_P (\\phi_e - \\phi_w) = F(\\phi_e - \\phi_w)$. The upwind scheme sets the face values $\\phi_e$ and $\\phi_w$ based on the flow direction. For positive velocity $u>0$, we have $F>0$, and flow is from west to east. Thus, $\\phi_e = \\phi_P$ and $\\phi_w = \\phi_W$.\n    The convective term becomes: $F(\\phi_P - \\phi_W)$.\n\nSubstituting these discretizations into the integrated equation:\n$$ D A(P) (\\phi_E - \\phi_P) - D A(P) (\\phi_P - \\phi_W) - F(\\phi_P - \\phi_W) = S_u $$\nWe rearrange the equation to match the form $a_W \\phi_W + a_E \\phi_E - a_P \\phi_P = S_u$.\n$$ [D A(P) + F] \\phi_W + [D A(P)] \\phi_E - [D A(P) + D A(P) + F] \\phi_P = S_u $$\nComparing coefficients, we find for $F>0$:\n$$ a_W = D A(P) + F $$\n$$ a_E = D A(P) $$\n$$ a_P = F + 2 D A(P) $$\nIt can be verified that $a_P = a_W + a_E$, which is a required property for a scheme to be conservative in the absence of sources ($S_P=0$).\nThe description given in the problem statement uniquely defines the coefficients of the standard power-law scheme. For a general flow direction, the coefficients are:\n$$ a_W = D A(|P|) + \\max(F, 0) $$\n$$ a_E = D A(|P|) + \\max(-F, 0) $$\n$$ a_P = a_W + a_E = |F| + 2D A(|P|) $$\nSince the problem specifies $u>0$, we have $F>0$ and $|P|=P$, leading to the specific forms derived above.\n\n### Task 2: Manufactured Solution and Source Term\n\nThe manufactured solution is $\\phi(x) = \\sin(2\\pi x)$. To find the corresponding source term $S(x)$, we substitute $\\phi(x)$ into the continuous differential equation.\nFirst, we find the derivatives:\n$$ \\frac{d\\phi}{dx} = 2\\pi \\cos(2\\pi x) $$\n$$ \\frac{d^2\\phi}{dx^2} = -4\\pi^2 \\sin(2\\pi x) $$\nThe source term $S(x)$ is therefore:\n$$ S(x) = \\Gamma \\frac{d^2\\phi}{dx^2} - \\rho u \\frac{d\\phi}{dx} = -4\\pi^2 \\Gamma \\sin(2\\pi x) - 2\\pi \\rho u \\cos(2\\pi x) $$\nThe source contribution to a control volume $P_i$ (from $x_w = x_i - \\Delta x/2$ to $x_e = x_i + \\Delta x/2$) is the integral $S_{u,i}$:\n$$ S_{u,i} = \\int_{x_w}^{x_e} \\left( -4\\pi^2 \\Gamma \\sin(2\\pi x) - 2\\pi \\rho u \\cos(2\\pi x) \\right) dx $$\nPerforming the integration:\n$$ S_{u,i} = \\left[ -4\\pi^2 \\Gamma \\left(-\\frac{\\cos(2\\pi x)}{2\\pi}\\right) - 2\\pi \\rho u \\left(\\frac{\\sin(2\\pi x)}{2\\pi}\\right) \\right]_{x_w}^{x_e} $$\n$$ S_{u,i} = \\left[ 2\\pi \\Gamma \\cos(2\\pi x) - \\rho u \\sin(2\\pi x) \\right]_{x_w}^{x_e} $$\nThis exact expression for $S_{u,i}$ is used to calculate the truncation error.\n\n### Task 3: Truncation Error and Scaling Study\n\nThe truncation error for each control volume $P_i$ is computed by substituting the exact solution values into the discrete equation:\n$$ \\mathrm{TE}_i = a_W \\phi(x_{W,i}) + a_E \\phi(x_{E,i}) - a_P \\phi(x_{P,i}) - S_{u,i} $$\nwhere $x_{P,i}$ is the center of the $i$-th cell, and $x_{W,i}$ and $x_{E,i}$ are the centers of the neighboring cells. For the boundary cells ($i=1$ and $i=N$), the neighbor values outside the domain are taken as the boundary values, $\\phi(0)$ and $\\phi(1)$.\n- For cell $i=1$, $\\phi_W = \\phi(0)=0$.\n- For cell $i=N$, $\\phi_E = \\phi(1)=0$.\n\nThe study requires holding the Peclet number $P^\\star$ constant across grid refinements. The velocity is set as $u = \\frac{P^\\star \\Gamma}{\\rho \\Delta x}$. Given $\\rho=1, \\Gamma=1, L=1, \\Delta x=1/N$, this becomes $u = P^\\star N$.\nThe simulation parameters for a given $N$ and $P^\\star$ are:\n- $\\Delta x = 1/N$\n- $u = P^\\star N$\n- $D = \\Gamma / \\Delta x = N$\n- $F = \\rho u = P^\\star N$\n- The coefficients become:\n  $A(P^\\star) = \\max\\{0, (1 - 0.1 P^\\star)^5\\}$ (since $u>0$, $P>0$)\n  $a_W = N A(P^\\star) + P^\\star N = N(A(P^\\star) + P^\\star)$\n  $a_E = N A(P^\\star)$\n  $a_P = P^\\star N + 2N A(P^\\star) = N(P^\\star + 2 A(P^\\star))$\n\nFor each $P^\\star$, $\\|\\mathrm{TE}\\|_{\\mathrm{RMS}}$ is computed for each grid size $N$. Then, a linear fit to $\\log(\\|\\mathrm{TE}\\|_{\\mathrm{RMS}})$ versus $\\log(\\Delta x)$ is performed. The slope of this fit gives the scaling exponent $\\alpha$. This procedure is implemented in the following Python code.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import ...\n\ndef solve():\n    \"\"\"\n    Computes the scaling exponent of the truncation error for a power-law\n    differencing scheme applied to the 1D convection-diffusion equation.\n    \"\"\"\n    \n    # Test suite specifications\n    L = 1.0\n    rho = 1.0\n    gamma = 1.0\n    N_values = [20, 40, 80, 160, 320]\n    P_star_values = [0.01, 2.0, 20.0]\n\n    # Manufactured solution and its derivatives\n    def phi_exact(x):\n        return np.sin(2 * np.pi * x)\n\n    # Function to compute the power-law modulation factor\n    def A_power_law(P):\n        return np.maximum(0.0, (1 - 0.1 * np.abs(P))**5)\n\n    def calculate_rms_truncation_error(N, P_star):\n        \"\"\"\n        Calculates the RMS of the truncation error for a given grid size N\n        and target Peclet number P_star.\n        \"\"\"\n        # Grid and problem parameters\n        dx = L / N\n        u = (P_star * gamma) / (rho * dx)\n        D = gamma / dx\n        F = rho * u\n        P = F / D  # Should be equal to P_star\n\n        # Coefficients of the discrete equation (for u > 0)\n        A_p = A_power_law(P)\n        a_W = D * A_p + F\n        a_E = D * A_p\n        a_P = a_W + a_E  # Or F + 2 * D * A_p\n\n        # Cell centers and face positions\n        x_centers = (np.arange(N) + 0.5) * dx\n        x_faces_w = x_centers - 0.5 * dx\n        x_faces_e = x_centers + 0.5 * dx\n\n        # Exact solution at cell centers\n        phi_P_exact = phi_exact(x_centers)\n        \n        # Exact solution at neighbor centers, with boundary conditions\n        phi_W_exact = np.zeros(N)\n        phi_W_exact[1:] = phi_P_exact[:-1] # phi at a distance -dx\n        # phi_W_exact[0] is already 0, which is phi_exact(0)\n\n        phi_E_exact = np.zeros(N)\n        phi_E_exact[:-1] = phi_P_exact[1:] # phi at a distance +dx\n        # phi_E_exact[N-1] is already 0, which is phi_exact(L)\n\n        # Exact integrated source term S_u\n        # S_u = [2*pi*gamma*cos(2*pi*x) - rho*u*sin(2*pi*x)] from x_w to x_e\n        term_at_e = 2 * np.pi * gamma * np.cos(2 * np.pi * x_faces_e) - rho * u * np.sin(2 * np.pi * x_faces_e)\n        term_at_w = 2 * np.pi * gamma * np.cos(2 * np.pi * x_faces_w) - rho * u * np.sin(2 * np.pi * x_faces_w)\n        S_u_exact = term_at_e - term_at_w\n\n        # Truncation error for each cell\n        TE = a_W * phi_W_exact + a_E * phi_E_exact - a_P * phi_P_exact - S_u_exact\n        \n        # RMS norm of the truncation error\n        rms_TE = np.sqrt(np.mean(TE**2))\n        \n        return rms_TE\n\n    # --- Main logic ---\n    # Store the calculated scaling exponents\n    scaling_exponents = []\n\n    # Iterate over each Peclet number regime\n    for P_star in P_star_values:\n        rms_errors = []\n        log_dx_values = []\n        \n        # Iterate through grid refinements\n        for N in N_values:\n            dx = L / N\n            rms_error = calculate_rms_truncation_error(N, P_star)\n            \n            rms_errors.append(rms_error)\n            log_dx_values.append(np.log(dx))\n        \n        # Perform linear regression to find the scaling exponent alpha\n        # log(rms_error) = log(C) + alpha * log(dx)\n        log_rms_errors = np.log(rms_errors)\n        \n        # Use numpy.polyfit for linear regression (degree 1)\n        # It returns [slope, intercept]\n        alpha, _ = np.polyfit(log_dx_values, log_rms_errors, 1)        \n        scaling_exponents.append(alpha)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{exp:.15f}' for exp in scaling_exponents)}]\")\n\n\nsolve()\n```"
        }
    ]
}