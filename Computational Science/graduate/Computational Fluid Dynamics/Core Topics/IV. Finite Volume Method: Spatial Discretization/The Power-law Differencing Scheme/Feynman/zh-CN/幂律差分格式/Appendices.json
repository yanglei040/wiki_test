{
    "hands_on_practices": [
        {
            "introduction": "本节动手实践首先从一个基础计算开始，以巩固您对幂律格式核心机制的理解。在这个练习中，您将直接计算一个计算面上的离散方程系数，并观察在高佩克莱数（Péclet number, $P_e$）——即对流远强于扩散——的场景下，格式如何自动抑制扩散项的影响。通过这个练习 ()，您将为掌握该格式的内在平衡机制打下坚实的基础。",
            "id": "3378097",
            "problem": "考虑在计算流体动力学 (CFD) 的均匀网格中，标量场 $\\phi(x)$ 的稳态一维对流扩散输运。使用有限体积法 (FVM)，关注一个以 $P$ 为形心、其东侧面 $e$ 与相邻节点 $E$ 相接的控制体。设东侧面的质量通量为 $F_{e}$，扩散导率为 $D_{e}$，因此该侧面的佩克莱特数为 $P_{e} = F_{e}/D_{e}$。在幂律差分格式中，东侧面相邻节点系数 $a_{E}$ 由两部分组成：一个由佩克莱特数的抑制函数缩放的扩散贡献，以及一个由 $F_{e}$ 符号控制的迎风对流贡献。\n\n假设 $P_{e} = 5$ 且质量通量为正，$F_{e}  0$。对于该侧面，计算由 $A(P_{e}) = (1 - 0.1 \\times 5)^{5}$ 给出的抑制函数 $A(P_{e})$ 的值，确定扩散和迎风对流对 $a_{E}$ 的两个贡献（即 $D_{e} A(P_{e})$ 和 $\\max(-F_{e}, 0)$），并从业主-相邻节点耦合的角度解释该侧面上扩散和迎风对流之间的最终平衡。\n\n报告无量纲相邻节点系数 $a_{E}/D_{e}$ 作为最终答案。无需四舍五入，该量为无量纲（无单位）。",
            "solution": "本题要求在有限体积法 (FVM) 的背景下，使用幂律差分格式计算一个特定情况下的无量纲相邻节点系数 $a_{E}/D_{e}$。\n\n题目指出，东侧面相邻节点系数 $a_{E}$ 由一个扩散贡献和一个迎风对流贡献组成。这可以写作：\n$$a_{E} = (\\text{扩散贡献}) + (\\text{对流贡献})$$\n\n根据题目描述，这些贡献是：\n1. 扩散贡献：$D_{e} A(P_{e})$，其中 $A(P_{e})$ 是佩克莱特数 $P_{e}$ 的抑制函数。\n2. 对流贡献：$\\max(-F_{e}, 0)$，这代表了该格式的迎风特性。此处，$F_{e}$ 是东侧面的质量通量。\n\n因此，相邻节点系数 $a_{E}$ 的完整表达式为：\n$$a_{E} = D_{e} A(P_{e}) + \\max(-F_{e}, 0)$$\n\n我们已知以下信息：\n- 侧面佩克莱特数为 $P_{e} = 5$。\n- 质量通量为正，$F_{e}  0$。\n- 在此情况下，抑制函数定义为 $A(P_{e}) = (1 - 0.1 \\times 5)^{5}$。请注意，标准的幂律格式使用佩克莱特数的绝对值，即 $A(|P_e|)$。然而，由于 $F_e  0$ 且扩散导率 $D_e$ 固有为正，所以 $P_e = F_e/D_e  0$，因此 $|P_e| = P_e$。\n\n我们现在将分别计算对 $a_{E}$ 的两个贡献。\n\n首先，我们计算抑制函数 $A(P_{e})$ 的值：\n$$A(P_{e}) = A(5) = (1 - 0.1 \\times 5)^{5} = (1 - 0.5)^{5} = (0.5)^{5}$$\n将 $0.5$ 表示为分数，我们得到：\n$$A(5) = \\left(\\frac{1}{2}\\right)^{5} = \\frac{1^{5}}{2^{5}} = \\frac{1}{32}$$\n\n因此，对 $a_{E}$ 的扩散贡献为：\n$$\\text{扩散贡献} = D_{e} A(5) = D_{e} \\times \\frac{1}{32} = \\frac{D_{e}}{32}$$\n\n接下来，我们计算对流贡献。已知质量通量为正，$F_{e}  0$。这意味着项 $-F_{e}$ 为负。\n$$\\text{对流贡献} = \\max(-F_{e}, 0)$$\n由于 $-F_{e}  0$，该值与 $0$ 的最大值为 $0$。\n$$\\text{对流贡献} = 0$$\n\n现在，我们将两个贡献结合起来，求得总的相邻节点系数 $a_{E}$：\n$$a_{E} = \\frac{D_{e}}{32} + 0 = \\frac{D_{e}}{32}$$\n\n结果解释：\n佩克莱特数 $P_{e} = 5$ 表明流动中对流远强于扩散（一个常见的阈值是 $|P_{e}|  2$）。幂律格式通过抑制扩散通量来应对这种情况。抑制函数 $A(5) = 1/32$ 将扩散耦合降低至纯扩散情况下的约 $3.125\\%$。对相邻节点系数 $a_{E}$ 的对流贡献为零，因为流动方向为正 ($F_{e}  0$)，意味着流动是从节点 $P$ 指向节点 $E$。在迎风格式中，下游节点 $E$ 不会对界面 $e$ 产生对流影响。因此，节点 $P$ 和 $E$ 之间的耦合完全是由于被严重抑制的扩散造成的。\n\n题目要求的最终答案是无量纲相邻节点系数 $a_{E}/D_{e}$。我们可以用我们得到的 $a_{E}$ 的表达式来计算这个比率：\n$$\\frac{a_{E}}{D_{e}} = \\frac{D_{e}/32}{D_{e}} = \\frac{1}{32}$$",
            "answer": "$$\n\\boxed{\\frac{1}{32}}\n$$"
        },
        {
            "introduction": "在掌握了基本计算后，我们转向理论分析，深入探究幂律格式的精度来源。这个练习 () 要求您推导格式的建模误差，即将其与一维对流扩散方程的精确解进行比较。通过泰勒级数展开，您将量化由近似权重函数引入的主导误差项，从而深刻理解数值扩散的概念，以及格式的设计（例如在 $P=0$ 处的导数）如何决定其在低佩克莱数区域的性能。",
            "id": "3378094",
            "problem": "考虑一个稳态一维对流扩散问题，其中被动标量为 $\\phi(x)$，密度 $\\rho$、速度 $u0$ 和扩散系数 $\\Gamma$ 均为常数。该问题在一个均匀网格上进行分析，网格节点位于 $x_W$ 和 $x_P$，相距 $\\Delta x$。设西面 $f$ 位于中点 $x_f = (x_W + x_P)/2$。在区间 $(x_W,x_P)$ 上的稳态守恒律可简化为常微分方程 $\\Gamma \\,\\frac{d^2 \\phi}{dx^2} - \\rho u \\,\\frac{d \\phi}{dx} = 0$。在区间 $(x_W,x_P)$ 上，当边界值为 $\\phi(x_W)=\\phi_W$ 和 $\\phi(x_P)=\\phi_P$ 时，其精确局域解给出的面心值为 $\\phi_f^{\\mathrm{exact}} = \\phi_W + (\\phi_P - \\phi_W)\\,E(P)$ 的形式。其中，$P \\equiv \\rho u \\Delta x / \\Gamma$ 是网格佩克莱特数，$E(P)$ 是由解析解得到的精确中点权重。在实际的对流扩散差分格式中，包括幂律差分格式，精确权重 $E(P)$ 被一个近似值 $A(P)$ 替代。该近似值依赖于 $P$，但不必是精确的指数形式。定义局域梯度近似为 $g \\equiv (\\phi_P - \\phi_W)/\\Delta x$。假设 $A(P)$ 在 $P=0$ 处可微，并满足扩散极限一致性条件 $A(0)=\\tfrac{1}{2}$。从控制方程和在 $(x_W,x_P)$ 上的解析解出发，推导面心值的主阶模型误差 $$\\delta \\phi_f \\equiv \\phi_f^{A} - \\phi_f^{\\mathrm{exact}},$$ 并将其表示为 $P$、$g$ 和导数 $A'(0)$ 的显式函数。请将最终答案表示为关于 $P$、$g$、$\\Delta x$ 和 $A'(0)$ 的单个闭式代数表达式。无需进行数值计算，最终表达式中不应包含单位。",
            "solution": "目标是推导被动标量 $\\phi$ 在面心值上的主阶模型误差，其定义为 $\\delta \\phi_f \\equiv \\phi_f^{A} - \\phi_f^{\\mathrm{exact}}$。该误差源于使用近似权重函数 $A(P)$ 代替精确权重函数 $E(P)$。\n\n精确面心值和近似面心值的定义如下：\n$$ \\phi_f^{\\mathrm{exact}} = \\phi_W + (\\phi_P - \\phi_W)\\,E(P) $$\n$$ \\phi_f^{A} = \\phi_W + (\\phi_P - \\phi_W)\\,A(P) $$\n其中 $P \\equiv \\rho u \\Delta x / \\Gamma$ 是网格佩克莱特数，$\\phi_W$ 和 $\\phi_P$ 是标量的节点值。\n\n用第二个方程减去第一个方程，得到模型误差：\n$$ \\delta \\phi_f = (\\phi_f^{A} - \\phi_f^{\\mathrm{exact}}) = \\left( \\phi_W + (\\phi_P - \\phi_W)A(P) \\right) - \\left( \\phi_W + (\\phi_P - \\phi_W)E(P) \\right) $$\n$$ \\delta \\phi_f = (\\phi_P - \\phi_W) \\left( A(P) - E(P) \\right) $$\n\n为了找到小 $P$ 值下的主阶误差，我们需要求出 $A(P)$ 和 $E(P)$ 在 $P=0$ 附近的泰勒级数展开。\n\n首先，我们推导精确权重函数 $E(P)$。这需要求解在区间 $(x_W, x_P)$ 上的稳态一维对流扩散控制方程：\n$$ \\Gamma \\,\\frac{d^2 \\phi}{dx^2} - \\rho u \\,\\frac{d \\phi}{dx} = 0 $$\n边界条件为 $\\phi(x_W) = \\phi_W$ 和 $\\phi(x_P) = \\phi_P$。\n我们定义一个局部坐标 $\\xi = x - x_W$，因此 $\\xi$ 的范围是从 $0$ 到 $\\Delta x$。方程变为：\n$$ \\frac{d^2 \\phi}{d\\xi^2} - \\frac{\\rho u}{\\Gamma} \\frac{d \\phi}{d\\xi} = 0 $$\n引入佩克莱特数 $P = \\rho u \\Delta x / \\Gamma$，我们有 $\\rho u / \\Gamma = P / \\Delta x$。常微分方程（ODE）为：\n$$ \\frac{d^2 \\phi}{d\\xi^2} - \\frac{P}{\\Delta x} \\frac{d \\phi}{d\\xi} = 0 $$\n这是一个常系数二阶线性齐次常微分方程。其特征方程为 $r^2 - \\frac{P}{\\Delta x} r = 0$，根为 $r_1=0$ 和 $r_2=P/\\Delta x$。\n通解的形式为：\n$$ \\phi(\\xi) = C_1 + C_2 \\exp\\left(\\frac{P}{\\Delta x}\\xi\\right) $$\n应用边界条件 $\\phi(0) = \\phi_W$ 和 $\\phi(\\Delta x) = \\phi_P$：\n当 $\\xi=0$ 时：$C_1 + C_2 = \\phi_W$。\n当 $\\xi=\\Delta x$ 时：$C_1 + C_2 \\exp(P) = \\phi_P$。\n求解这个关于 $C_1$ 和 $C_2$ 的方程组，得到：\n$$ C_2 = \\frac{\\phi_P - \\phi_W}{\\exp(P) - 1} $$\n$$ C_1 = \\phi_W - C_2 = \\phi_W - \\frac{\\phi_P - \\phi_W}{\\exp(P) - 1} = \\frac{\\phi_W \\exp(P) - \\phi_P}{\\exp(P) - 1} $$\n精确解为：\n$$ \\phi(\\xi) = \\frac{\\phi_W \\exp(P) - \\phi_P}{\\exp(P) - 1} + \\frac{\\phi_P - \\phi_W}{\\exp(P) - 1} \\exp\\left(\\frac{P}{\\Delta x}\\xi\\right) $$\n我们关心的是面 $f$ 处的值，该面位于 $x_f = (x_W + x_P)/2$，对应于 $\\xi_f = \\Delta x / 2$。\n$$ \\phi_f^{\\mathrm{exact}} = \\phi(\\Delta x / 2) = \\frac{\\phi_W \\exp(P) - \\phi_P}{\\exp(P) - 1} + \\frac{\\phi_P - \\phi_W}{\\exp(P) - 1} \\exp\\left(\\frac{P}{2}\\right) $$\n为了求得 $E(P)$，我们将其整理为 $\\phi_W + (\\phi_P - \\phi_W)E(P)$ 的形式：\n$$ \\phi_f^{\\mathrm{exact}} - \\phi_W = \\frac{\\phi_W \\exp(P) - \\phi_P + (\\phi_P - \\phi_W)\\exp(P/2) - \\phi_W(\\exp(P)-1)}{\\exp(P)-1} $$\n$$ \\phi_f^{\\mathrm{exact}} - \\phi_W = \\frac{-\\phi_P + \\phi_P\\exp(P/2) - \\phi_W\\exp(P/2) + \\phi_W}{\\exp(P)-1} $$\n$$ \\phi_f^{\\mathrm{exact}} - \\phi_W = \\frac{(\\phi_P-\\phi_W)\\exp(P/2) - (\\phi_P-\\phi_W)}{\\exp(P)-1} = (\\phi_P - \\phi_W) \\frac{\\exp(P/2) - 1}{\\exp(P) - 1} $$\n通过与 $\\phi_f^{\\mathrm{exact}}$ 的定义进行比较，我们确定了精确权重函数：\n$$ E(P) = \\frac{\\exp(P/2) - 1}{\\exp(P) - 1} $$\n当 $P \\ne 0$ 时，该式可简化为 $E(P) = \\frac{1}{\\exp(P/2) + 1}$。\n\n接下来，我们求 $E(P)$ 在 $P=0$ 附近的泰勒级数展开。\n$$ E(0) = \\lim_{P\\to 0} \\frac{\\exp(P/2) - 1}{\\exp(P) - 1} = \\lim_{P\\to 0} \\frac{\\frac{1}{2}\\exp(P/2)}{\\exp(P)} = \\frac{1}{2} $$\n一阶导数为 $E'(P) = \\frac{d}{dP} \\left( (\\exp(P/2) + 1)^{-1} \\right) = -(\\exp(P/2) + 1)^{-2} \\cdot \\frac{1}{2}\\exp(P/2)$。\n在 $P=0$ 处求值：\n$$ E'(0) = -\\frac{1}{2}\\frac{\\exp(0)}{(\\exp(0)+1)^2} = -\\frac{1}{2(1+1)^2} = -\\frac{1}{8} $$\n$E(P)$ 的一个性质是函数 $E(P) - 1/2$ 是 $P$ 的奇函数。这意味着其泰勒级数只包含 $P$ 的奇次幂，因此 $P^2$ 项的系数为零。\n因此，$E(P)$ 的一阶展开式为：\n$$ E(P) = E(0) + E'(0)P + O(P^3) = \\frac{1}{2} - \\frac{1}{8}P + O(P^3) $$\n\n对于近似权重函数 $A(P)$，已知其在 $P=0$ 处可微，并满足扩散极限一致性条件 $A(0) = 1/2$。其泰勒级数展开为：\n$$ A(P) = A(0) + A'(0)P + O(P^2) = \\frac{1}{2} + A'(0)P + O(P^2) $$\n\n现在我们可以求出误差 $\\delta\\phi_f$ 的主阶表达式：\n$$ \\delta \\phi_f = (\\phi_P - \\phi_W) (A(P) - E(P)) $$\n$$ \\delta \\phi_f = (\\phi_P - \\phi_W) \\left[ \\left(\\frac{1}{2} + A'(0)P + O(P^2)\\right) - \\left(\\frac{1}{2} - \\frac{1}{8}P + O(P^3)\\right) \\right] $$\n$$ \\delta \\phi_f = (\\phi_P - \\phi_W) \\left[ \\left(A'(0) + \\frac{1}{8}\\right)P + O(P^2) \\right] $$\n误差的主阶项是与 $P$ 成正比的项：\n$$ \\delta \\phi_f^{\\mathrm{leading}} = (\\phi_P - \\phi_W) \\left(A'(0) + \\frac{1}{8}\\right)P $$\n\n最后，我们使用局域梯度的定义 $g \\equiv (\\phi_P - \\phi_W)/\\Delta x$，来替换标量值的差 $\\phi_P - \\phi_W = g \\Delta x$。\n$$ \\delta \\phi_f^{\\mathrm{leading}} = (g \\Delta x) \\left(A'(0) + \\frac{1}{8}\\right)P $$\n整理各项，得到主阶模型误差的最终表达式：\n$$ \\delta \\phi_f^{\\mathrm{leading}} = \\left(A'(0) + \\frac{1}{8}\\right) P g \\Delta x $$",
            "answer": "$$\n\\boxed{\\left(A'(0) + \\frac{1}{8}\\right) P g \\Delta x}\n$$"
        },
        {
            "introduction": "最后的综合性实践将理论与编程应用相结合。您需要在一个完整的计算流体动力学（CFD）验证流程中实现幂律格式。这个练习 () 采用“人造解方法”（Method of Manufactured Solutions, MMS），这是一种严格检验数值代码正确性与精度的标准技术。通过研究在不同佩克莱数（$P_e \\ll 1$, $P_e \\sim \\mathcal{O}(1)$, and $P_e \\gg 1$）区间内，截断误差如何随网格加密而变化，您将掌握衡量和分析数值格式性能的关键实践技能。",
            "id": "3378103",
            "problem": "考虑一个一维稳态对流扩散方程，描述了在区域 $[0,1]$ 上标量场 $\\phi(x)$ 的行为。该方程具有恒定的密度 $\\rho$、恒定的速度 $u$ 和恒定的扩散系数 $\\Gamma$：\n$$\\frac{d}{dx}\\left(\\Gamma \\frac{d\\phi}{dx}\\right) - \\rho u \\frac{d\\phi}{dx} = S(x),$$\n该方程以守恒型有限体积形式写出，作用于一个均匀的控制体网格上，其中控制体宽度为 $\\Delta x$，单位横截面积。设一个控制体的西侧面和东侧面分别表示为 $w$ 和 $e$，相邻的控制体中心分别表示为 $W$、$P$ 和 $E$。定义面上的扩散导纳为 $D = \\Gamma / \\Delta x$，面上的质量通量为 $F = \\rho u$。局部面佩克莱数（Peclet number）为 $P = F / D$。使用以下幂律函数来模拟对流对面插值的影响：\n$$A(P) = \\max\\{0, (1-0.1|P|)^5\\}.$$\n\n任务 1 (推导)：从守恒积分形式和控制体面的通量平衡出发，当源项以 $S = S_u + S_P \\phi$ 形式线性化且 $S_P = 0$ 时，推导内部控制体 $P$ 的离散系数 $a_W$、$a_E$ 和 $a_P$。其中，对流项在每个面上使用迎风加权，而扩散项由幂律函数 $A(P)$ 调节。用 $D$、$F$ 和 $A(P)$ 表示 $a_W$、$a_E$ 和 $a_P$。\n\n任务 2 (人工解与截断误差)：构造一个人工解 $\\phi(x)$ 和源项 $S(x)$，并通过将精确解 $\\phi$ 代入任务 1 中系数构成的离散方程来测量其产生的截断误差。使用人工解\n$$\\phi(x) = \\sin(2\\pi x),$$\n并选择 $S(x)$，使得在 $\\rho$ 和 $\\Gamma$ 恒定的情况下，连续方程得到精确满足。假设狄利克雷（Dirichlet）边界条件与人工解一致，即 $\\phi(0)$ 和 $\\phi(1)$ 等于边界处的精确值。将控制体源项贡献 $S_u$ 精确推导为 $S(x)$ 在控制体 $[x_w,x_e]$ 上的积分，其中 $x_w$ 和 $x_e$ 是西侧面和东侧面的位置。将控制体 $P$ 处的截断误差定义为\n$$\\mathrm{TE}_P = a_W \\phi_W + a_E \\phi_E - a_P \\phi_P - S_u,$$\n其中 $\\phi_W$、$\\phi_P$ 和 $\\phi_E$ 分别是西侧邻居、当前和东侧邻居控制体中心的精确人工解的值（当邻居超出区域时，使用边界值）。使用所有控制体上截断误差的均方根范数来表征其量级：\n$$\\|\\mathrm{TE}\\|_{\\mathrm{RMS}} = \\sqrt{\\frac{1}{N}\\sum_{i=1}^{N} \\left(\\mathrm{TE}_{i}\\right)^2},$$\n其中 $N$ 是控制体的数量。\n\n任务 3 (跨佩克莱数区间的标度研究)：研究 $\\|\\mathrm{TE}\\|_{\\mathrm{RMS}}$ 如何在三个佩克莱数区间内随 $\\Delta x$ 变化。为将佩克莱数效应与网格加密分离开，设定一个目标面佩克莱数 $P^\\star$，通过选择速度 $u$ 使得对所有面都有 $|P| = P^\\star$，从而在网格加密过程中保持 $P^\\star$ 不变，即\n$$u = \\frac{P^\\star \\Gamma}{\\rho \\Delta x}。$$\n使用恒定物性 $\\rho = 1$ 和 $\\Gamma = 1$，以及正速度 $u$。通过在一组网格尺寸上对 $\\log\\left(\\|\\mathrm{TE}\\|_{\\mathrm{RMS}}\\right)$ 与 $\\log(\\Delta x)$ 进行最小二乘线性回归，计算最能拟合\n$$\\|\\mathrm{TE}\\|_{\\mathrm{RMS}} \\approx C (\\Delta x)^\\alpha$$\n的标度指数 $\\alpha$。报告每个佩克莱数区间的 $\\alpha$。\n\n测试套件规范：\n- 区域长度 $L = 1$。\n- 物性值 $\\rho = 1$ 和 $\\Gamma = 1$。\n- 人工解 $\\phi(x) = \\sin(2\\pi x)$ 和狄利克雷边界条件 $\\phi(0)$ 与 $\\phi(1)$ 等于精确解。\n- 网格尺寸 $N \\in \\{20,40,80,160,320\\}$，因此 $\\Delta x = L/N$。\n- 目标面佩克莱数 $P^\\star \\in \\{0.01, 2, 20\\}$，分别对应 $P \\ll 1$、$P \\sim \\mathcal{O}(1)$ 和 $P \\gg 1$ 的情况。\n\n您的程序必须：\n- 通过构建以 $D$、$F$ 和 $A(P)$ 表示的离散系数来实现推导。\n- 根据人工解计算精确源项 $S(x)$，并对其在每个控制体上进行精确积分以获得 $S_u$。\n- 对于 $N$ 和 $P^\\star$ 的每种组合，计算 $\\|\\mathrm{TE}\\|_{\\mathrm{RMS}}$，然后对每个 $P^\\star$，在一组 $N$ 值上拟合标度指数 $\\alpha$。\n- 生成单行输出，其中包含针对 $P^\\star = 0.01$、$P^\\star = 2$ 和 $P^\\star = 20$ 拟合出的三个指数 $\\alpha$，按此顺序排列。每个 $\\alpha$ 表示为一个无量纲实数。最终输出格式必须是一个由方括号括起来的逗号分隔列表，例如，\n$$[\\alpha_{0.01}, \\alpha_{2}, \\alpha_{20}]。$$",
            "solution": "用户提供了一个计算流体力学领域的多部分问题，重点是分析一种幂律差分格式。我将首先验证问题陈述，然后进行完整解答。\n\n### 步骤1：提取给定条件\n\n**控制方程：**\n一维稳态对流扩散方程，用于描述标量场 $\\phi(x)$，给出如下：\n$$ \\frac{d}{dx}\\left(\\Gamma \\frac{d\\phi}{dx}\\right) - \\rho u \\frac{d\\phi}{dx} = S(x) $$\n作用于区域 $[0,1]$。物性 $\\rho$（密度）、$u$（速度）和 $\\Gamma$（扩散系数）为常数。\n\n**有限体积离散：**\n- 使用一个包含 $N$ 个宽度为 $\\Delta x$ 的控制体（CV）的均匀网格。\n- 控制体中心表示为 $W$（西侧邻居）、$P$（当前）和 $E$（东侧邻居）。\n- 控制体面表示为 $w$（西侧）和 $e$（东侧）。\n- 面上的扩散导纳：$D = \\Gamma / \\Delta x$。\n- 面上的质量通量：$F = \\rho u$。\n- 局部面佩克莱数：$P = F / D$。\n- 源项线性化为 $S = S_u + S_P \\phi$，其中 $S_P = 0$。\n- 用于调节扩散的幂律函数为：$A(P) = \\max\\{0, (1-0.1|P|)^5\\}$。\n\n**任务1（推导）：**\n- 推导内部控制体 $P$ 的离散系数 $a_W$、$a_E$ 和 $a_P$。\n- 该公式要求对流项使用迎风加权，并用 $A(P)$ 调节扩散项。\n- 最终的离散方程形式为 $a_W \\phi_W + a_E \\phi_E - a_P \\phi_P - S_u = 0$，其中 $S_u$ 是在控制体上积分的源项。\n\n**任务2（人工解与截断误差）：**\n- 人工解：$\\phi(x) = \\sin(2\\pi x)$。\n- 选择源项 $S(x)$，以使连续方程得到精确满足。\n- 狄利克雷边界条件为 $\\phi(0)$ 和 $\\phi(1)$，与精确解一致。\n- 控制体源项 $S_u$ 是 $S(x)$ 在控制体 $[x_w, x_e]$ 上的精确积分。\n- 控制体 $P$ 的截断误差定义：$\\mathrm{TE}_P = a_W \\phi_W + a_E \\phi_E - a_P \\phi_P - S_u$。\n- 截断误差的均方根范数：$\\|\\mathrm{TE}\\|_{\\mathrm{RMS}} = \\sqrt{\\frac{1}{N}\\sum_{i=1}^{N} \\left(\\mathrm{TE}_{i}\\right)^2}$。\n\n**任务3（标度研究）：**\n- 研究 $\\|\\mathrm{TE}\\|_{\\mathrm{RMS}}$ 随 $\\Delta x$ 的标度变化。\n- 在每次标度研究中，通过设置速度 $u = \\frac{P^\\star \\Gamma}{\\rho \\Delta x}$，保持目标面佩克莱数 $P^\\star$ 不变。\n- 速度 $u$ 为正。\n- 使用对 $\\log\\left(\\|\\mathrm{TE}\\|_{\\mathrm{RMS}}\\right)$ vs. $\\log(\\Delta x)$ 的最小二乘线性回归来找到 $\\|\\mathrm{TE}\\|_{\\mathrm{RMS}} \\approx C (\\Delta x)^\\alpha$ 中的标度指数 $\\alpha$。\n\n**测试套件规范：**\n- 区域长度：$L = 1$。\n- 物性：$\\rho = 1$, $\\Gamma = 1$。\n- 边界条件：$\\phi(0) = \\sin(0) = 0$ 和 $\\phi(1) = \\sin(2\\pi) = 0$。\n- 网格尺寸：$N \\in \\{20, 40, 80, 160, 320\\}$，其中 $\\Delta x = L/N$。\n- 目标佩克莱数：$P^\\star \\in \\{0.01, 2, 20\\}$。\n\n### 步骤2：使用提取的给定条件进行验证\n\n1.  **科学基础**：该问题植根于计算流体力学这一成熟领域。对流扩散方程是基础，有限体积法是标准的离散化技术。幂律格式是处理对流主导流动的已知方法。人工解方法是验证数值代码和分析截断误差的严谨标准程序。所有方面都具有科学合理性。\n2.  **适定性**：任务定义清晰。任务1中的推导，尽管基于一种略显非传统的格式描述，但最终导出了标准的幂律格式系数，使其明确无误。任务2和任务3中的分析为获得唯一的数值结果提供了清晰的路径。包括人工解和边界条件在内的设置是完整的。\n3.  **客观性**：问题以精确、客观的数学和计算术语陈述。没有主观或基于意见的陈述。\n4.  **完整性与一致性**：问题提供了所有必要的数据和定义。有一个微小的不一致之处，即前文声明“$u$ 是恒定的”，但任务3要求 $u$ 随 $\\Delta x$ 变化。这被解释为一个特定于任务的条件，为进行特定的数值实验而覆盖了一般性陈述。这在学术问题中是常见的结构，并不会使问题无效；它只是定义了一个特定的、非标准的标度分析。\n\n### 步骤3：结论与行动\n\n该问题是**有效的**。这是一个适定、科学合理且全面的CFD数值分析练习。我将继续进行完整解答。\n\n### 任务1：离散系数的推导\n\n我们首先将控制方程在一个控制体 $P$ 上进行积分，从其西侧面 $w$（位置 $x_w$）到东侧面 $e$（位置 $x_e$）：\n$$ \\int_{x_w}^{x_e} \\frac{d}{dx}\\left(\\Gamma \\frac{d\\phi}{dx}\\right) dx - \\int_{x_w}^{x_e} \\rho u \\frac{d\\phi}{dx} dx = \\int_{x_w}^{x_e} S(x) dx $$\n对第一项应用微积分基本定理，并识别出 $S_u$ 的定义：\n$$ \\left(\\Gamma \\frac{d\\phi}{dx}\\right)_e - \\left(\\Gamma \\frac{d\\phi}{dx}\\right)_w - \\int_{x_w}^{x_e} \\rho u \\frac{d\\phi}{dx} dx = S_u $$\n问题陈述了一种非标准的离散化表述。它要求分别离散化对流项和扩散项。\n1.  **扩散通量**：扩散通量项 $\\Gamma \\frac{d\\phi}{dx}$ 使用中心差分格式进行近似，并由幂律函数 $A(P)$ 进行调节。\n    在面 $e$ 处：$\\left(\\Gamma \\frac{d\\phi}{dx}\\right)_e \\approx \\Gamma A(P_e) \\frac{\\phi_E - \\phi_P}{\\Delta x} = D A(P_e) (\\phi_E - \\phi_P)$。\n    在面 $w$ 处：$\\left(\\Gamma \\frac{d\\phi}{dx}\\right)_w \\approx \\Gamma A(P_w) \\frac{\\phi_P - \\phi_W}{\\Delta x} = D A(P_w) (\\phi_P - \\phi_W)$。\n    由于 $\\rho, u, \\Gamma, \\Delta x$ 在整个网格上是恒定的，所以 $P_e=P_w=P$ 且 $D_e=D_w=D$。\n\n2.  **对流项**：积分后的对流项 $\\int_{x_w}^{x_e} \\rho u \\frac{d\\phi}{dx} dx$ 使用迎风加权进行离散。该积分可以近似为 $(\\rho u)_P (\\phi_e - \\phi_w) = F(\\phi_e - \\phi_w)$。迎风格式根据流动方向设置面值 $\\phi_e$ 和 $\\phi_w$。对于正速度 $u0$，我们有 $F0$，流动方向从西到东。因此，$\\phi_e = \\phi_P$ 和 $\\phi_w = \\phi_W$。\n    对流项变为：$F(\\phi_P - \\phi_W)$。\n\n将这些离散形式代入积分方程：\n$$ D A(P) (\\phi_E - \\phi_P) - D A(P) (\\phi_P - \\phi_W) - F(\\phi_P - \\phi_W) = S_u $$\n我们重新整理方程以匹配 $a_W \\phi_W + a_E \\phi_E - a_P \\phi_P = S_u$ 的形式。\n$$ [D A(P) + F] \\phi_W + [D A(P)] \\phi_E - [D A(P) + D A(P) + F] \\phi_P = S_u $$\n比较系数，我们发现对于 $F0$：\n$$ a_W = D A(P) + F $$\n$$ a_E = D A(P) $$\n$$ a_P = F + 2 D A(P) $$\n可以验证 $a_P = a_W + a_E$，这是格式在没有源项（$S_P=0$）时保持守恒性的一个必要属性。\n问题陈述中的描述唯一地定义了标准幂律格式的系数。对于一般流动方向，系数为：\n$$ a_W = D A(|P|) + \\max(F, 0) $$\n$$ a_E = D A(|P|) + \\max(-F, 0) $$\n$$ a_P = a_W + a_E = |F| + 2D A(|P|) $$\n由于问题指定 $u0$，我们有 $F0$ 和 $|P|=P$，从而得到上面推导的具体形式。\n\n### 任务2：人工解与源项\n\n人工解为 $\\phi(x) = \\sin(2\\pi x)$。为了找到相应的源项 $S(x)$，我们将 $\\phi(x)$ 代入连续微分方程。\n首先，我们求导数：\n$$ \\frac{d\\phi}{dx} = 2\\pi \\cos(2\\pi x) $$\n$$ \\frac{d^2\\phi}{dx^2} = -4\\pi^2 \\sin(2\\pi x) $$\n因此，源项 $S(x)$ 为：\n$$ S(x) = \\Gamma \\frac{d^2\\phi}{dx^2} - \\rho u \\frac{d\\phi}{dx} = -4\\pi^2 \\Gamma \\sin(2\\pi x) - 2\\pi \\rho u \\cos(2\\pi x) $$\n对一个控制体 $P_i$（从 $x_w = x_i - \\Delta x/2$ 到 $x_e = x_i + \\Delta x/2$）的源项贡献是积分 $S_{u,i}$：\n$$ S_{u,i} = \\int_{x_w}^{x_e} \\left( -4\\pi^2 \\Gamma \\sin(2\\pi x) - 2\\pi \\rho u \\cos(2\\pi x) \\right) dx $$\n进行积分：\n$$ S_{u,i} = \\left[ -4\\pi^2 \\Gamma \\left(-\\frac{\\cos(2\\pi x)}{2\\pi}\\right) - 2\\pi \\rho u \\left(\\frac{\\sin(2\\pi x)}{2\\pi}\\right) \\right]_{x_w}^{x_e} $$\n$$ S_{u,i} = \\left[ 2\\pi \\Gamma \\cos(2\\pi x) - \\rho u \\sin(2\\pi x) \\right]_{x_w}^{x_e} $$\n这个 $S_{u,i}$ 的精确表达式用于计算截断误差。\n\n### 任务3：截断误差与标度研究\n\n每个控制体 $P_i$ 的截断误差通过将精确解的值代入离散方程来计算：\n$$ \\mathrm{TE}_i = a_W \\phi(x_{W,i}) + a_E \\phi(x_{E,i}) - a_P \\phi(x_{P,i}) - S_{u,i} $$\n其中 $x_{P,i}$ 是第 $i$ 个单元的中心，而 $x_{W,i}$ 和 $x_{E,i}$ 是相邻单元的中心。对于边界单元（$i=1$ 和 $i=N$），区域外的邻居值取为边界值，即 $\\phi(0)$ 和 $\\phi(1)$。\n- 对于单元 $i=1$，$\\phi_W = \\phi(0)=0$。\n- 对于单元 $i=N$，$\\phi_E = \\phi(1)=0$。\n\n该研究要求在网格加密过程中保持佩克莱数 $P^\\star$ 不变。速度设置为 $u = \\frac{P^\\star \\Gamma}{\\rho \\Delta x}$。给定 $\\rho=1, \\Gamma=1, L=1, \\Delta x=1/N$，这变为 $u = P^\\star N$。\n对于给定的 $N$ 和 $P^\\star$，模拟参数为：\n- $\\Delta x = 1/N$\n- $u = P^\\star N$\n- $D = \\Gamma / \\Delta x = N$\n- $F = \\rho u = P^\\star N$\n- 系数变为：\n  $A(P^\\star) = \\max\\{0, (1 - 0.1 P^\\star)^5\\}$ (由于 $u0$, $P0$)\n  $a_W = N A(P^\\star) + P^\\star N = N(A(P^\\star) + P^\\star)$\n  $a_E = N A(P^\\star)$\n  $a_P = P^\\star N + 2N A(P^\\star) = N(P^\\star + 2 A(P^\\star))$\n\n对于每个 $P^\\star$，为每个网格尺寸 $N$ 计算 $\\|\\mathrm{TE}\\|_{\\mathrm{RMS}}$。然后，对 $\\log(\\|\\mathrm{TE}\\|_{\\mathrm{RMS}})$ 与 $\\log(\\Delta x)$ 进行线性拟合。此拟合的斜率即为标度指数 $\\alpha$。以下 Python 代码实现了此过程。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import ...\n\ndef solve():\n    \"\"\"\n    Computes the scaling exponent of the truncation error for a power-law\n    differencing scheme applied to the 1D convection-diffusion equation.\n    \"\"\"\n    \n    # Test suite specifications\n    L = 1.0\n    rho = 1.0\n    gamma = 1.0\n    N_values = [20, 40, 80, 160, 320]\n    P_star_values = [0.01, 2.0, 20.0]\n\n    # Manufactured solution and its derivatives\n    def phi_exact(x):\n        return np.sin(2 * np.pi * x)\n\n    # Function to compute the power-law modulation factor\n    def A_power_law(P):\n        return np.maximum(0.0, (1 - 0.1 * np.abs(P))**5)\n\n    def calculate_rms_truncation_error(N, P_star):\n        \"\"\"\n        Calculates the RMS of the truncation error for a given grid size N\n        and target Peclet number P_star.\n        \"\"\"\n        # Grid and problem parameters\n        dx = L / N\n        u = (P_star * gamma) / (rho * dx)\n        D = gamma / dx\n        F = rho * u\n        P = F / D  # Should be equal to P_star\n\n        # Coefficients of the discrete equation (for u  0)\n        A_p = A_power_law(P)\n        a_W = D * A_p + F\n        a_E = D * A_p\n        a_P = a_W + a_E  # Or F + 2 * D * A_p\n\n        # Cell centers and face positions\n        x_centers = (np.arange(N) + 0.5) * dx\n        x_faces_w = x_centers - 0.5 * dx\n        x_faces_e = x_centers + 0.5 * dx\n\n        # Exact solution at cell centers\n        phi_P_exact = phi_exact(x_centers)\n        \n        # Exact solution at neighbor centers, with boundary conditions\n        phi_W_exact = np.zeros(N)\n        phi_W_exact[1:] = phi_P_exact[:-1] # phi at a distance -dx\n        # phi_W_exact[0] is already 0, which is phi_exact(0)\n\n        phi_E_exact = np.zeros(N)\n        phi_E_exact[:-1] = phi_P_exact[1:] # phi at a distance +dx\n        # phi_E_exact[N-1] is already 0, which is phi_exact(L)\n\n        # Exact integrated source term S_u\n        # S_u = [2*pi*gamma*cos(2*pi*x) - rho*u*sin(2*pi*x)] from x_w to x_e\n        term_at_e = 2 * np.pi * gamma * np.cos(2 * np.pi * x_faces_e) - rho * u * np.sin(2 * np.pi * x_faces_e)\n        term_at_w = 2 * np.pi * gamma * np.cos(2 * np.pi * x_faces_w) - rho * u * np.sin(2 * np.pi * x_faces_w)\n        S_u_exact = term_at_e - term_at_w\n\n        # Truncation error for each cell\n        TE = a_W * phi_W_exact + a_E * phi_E_exact - a_P * phi_P_exact - S_u_exact\n        \n        # RMS norm of the truncation error\n        rms_TE = np.sqrt(np.mean(TE**2))\n        \n        return rms_TE\n\n    # --- Main logic ---\n    # Store the calculated scaling exponents\n    scaling_exponents = []\n\n    # Iterate over each Peclet number regime\n    for P_star in P_star_values:\n        rms_errors = []\n        log_dx_values = []\n        \n        # Iterate through grid refinements\n        for N in N_values:\n            dx = L / N\n            rms_error = calculate_rms_truncation_error(N, P_star)\n            \n            rms_errors.append(rms_error)\n            log_dx_values.append(np.log(dx))\n        \n        # Perform linear regression to find the scaling exponent alpha\n        # log(rms_error) = log(C) + alpha * log(dx)\n        log_rms_errors = np.log(rms_errors)\n        \n        # Use numpy.polyfit for linear regression (degree 1)\n        # It returns [slope, intercept]\n        alpha, _ = np.polyfit(log_dx_values, log_rms_errors, 1)        \n        scaling_exponents.append(alpha)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{exp:.15f}' for exp in scaling_exponents)}]\")\n\n\nsolve()\n```"
        }
    ]
}