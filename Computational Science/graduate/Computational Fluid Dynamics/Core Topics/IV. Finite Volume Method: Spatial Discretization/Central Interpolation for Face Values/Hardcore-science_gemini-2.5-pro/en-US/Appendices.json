{
    "hands_on_practices": [
        {
            "introduction": "Central interpolation is lauded for its straightforward implementation and second-order accuracy, but its application to convective transport is conditionally stable. This practice guides you through a foundational analysis to uncover this limitation by deriving the stability constraint for the Central Differencing Scheme (CDS). By completing this exercise , you will develop a critical understanding of the cell Peclet number, $Pe$, a dimensionless group that dictates whether a solution will be physically realistic or plagued by spurious oscillations.",
            "id": "3298459",
            "problem": "Consider a one-dimensional, steady convectionâ€“diffusion transport of a passive scalar $\\phi(x)$ on a uniform grid of control volumes with spacing $\\Delta x$ and unit cross-sectional area. The governing differential statement of conservation is\n$$\\frac{d}{dx}\\left(\\Gamma \\frac{d \\phi}{dx}\\right) - \\rho u \\frac{d \\phi}{dx} = 0,$$\nwhere $\\rho$ is the fluid density, $u$ is the constant velocity, and $\\Gamma$ is the diffusion coefficient for $\\phi$. Using the Finite Volume Method (FVM), integrate over a generic interior control volume $P$ bounded by faces $w$ (west) and $e$ (east), and discretize the diffusive fluxes with central gradients. For the convective fluxes, employ central interpolation for face values (the Central Differencing Scheme, CDS), meaning the face values are the arithmetic mean of adjacent cell-center values on a uniform grid. Define the face mass flux magnitude by $F \\equiv \\rho u$ (with unit area) and the diffusive conductance by $D \\equiv \\Gamma/\\Delta x$.\n\nA discrete scheme is said to be bounded if the coefficients multiplying neighboring unknowns in the linearized algebraic equation are nonnegative and the central coefficient satisfies the necessary dominance condition that precludes overshoots and undershoots in the discrete solution. Derive the coefficient constraints implied by CDS and express the boundedness requirement in terms of the dimensionless cell Peclet number\n$$Pe \\equiv \\frac{\\rho u \\,\\Delta x}{\\Gamma} = \\frac{F}{D}.$$\n\nThen, for the specific parameter values\n$$\\rho = 1.2 \\ \\text{kg}\\,\\text{m}^{-3}, \\quad u = 2 \\ \\text{m}\\,\\text{s}^{-1}, \\quad \\Gamma = 1.8 \\times 10^{-5} \\ \\text{kg}\\,\\text{m}^{-1}\\,\\text{s}^{-1}, \\quad \\Delta x = 1.0 \\times 10^{-2} \\ \\text{m},$$\ncompute the numerical value of $Pe$ and decide whether central interpolation is bounded for these conditions. Report your final answer as a row matrix $\\begin{pmatrix} Pe & b \\end{pmatrix}$, where $b=1$ if central interpolation is bounded and $b=0$ otherwise. Express $Pe$ as a pure number with no units and $b$ as a dimensionless indicator. No rounding is necessary; provide exact values whenever possible.",
            "solution": "The task is to derive the boundedness criterion for the Central Differencing Scheme (CDS) applied to the one-dimensional steady convection-diffusion equation and then to evaluate this criterion for a specific set of physical parameters.\n\nThe governing differential equation is given as:\n$$\n\\frac{d}{dx}\\left(\\Gamma \\frac{d\\phi}{dx}\\right) - \\rho u \\frac{d\\phi}{dx} = 0\n$$\nwhere $\\phi$ is the passive scalar, $\\Gamma$ is the diffusion coefficient, $\\rho$ is the density, and $u$ is the velocity.\n\nTo apply the Finite Volume Method (FVM), we integrate this equation over a generic control volume (CV) centered at a node $P$, bounded by a west face $w$ and an east face $e$. The volume of the CV is $\\Delta V = A \\Delta x$, where the cross-sectional area is given as unity ($A=1$) and the grid spacing is $\\Delta x$.\n$$\n\\int_{w}^{e} \\left[ \\frac{d}{dx}\\left(\\Gamma \\frac{d\\phi}{dx}\\right) - \\rho u \\frac{d\\phi}{dx} \\right] A \\, dx = 0\n$$\nSince $A=1$, we can write:\n$$\n\\int_{w}^{e} \\frac{d}{dx}\\left(\\Gamma \\frac{d\\phi}{dx}\\right) dx - \\int_{w}^{e} \\rho u \\frac{d\\phi}{dx} dx = 0\n$$\nApplying the fundamental theorem of calculus to the first term (the divergence of the diffusive flux) and assuming constant $\\rho$ and $u$ for the second term, we obtain the balance over the CV:\n$$\n\\left(A \\Gamma \\frac{d\\phi}{dx}\\right)_e - \\left(A \\Gamma \\frac{d\\phi}{dx}\\right)_w - \\rho u A (\\phi_e - \\phi_w) = 0\n$$\nAgain, with $A=1$:\n$$\n\\left(\\Gamma \\frac{d\\phi}{dx}\\right)_e - \\left(\\Gamma \\frac{d\\phi}{dx}\\right)_w - \\rho u (\\phi_e - \\phi_w) = 0\n$$\nThis equation represents the balance of diffusive and convective fluxes across the CV faces. The standard FVM approach treats the total flux at the faces. An equivalent, and more standard, starting point is the conservation law in divergence form, $\\frac{d}{dx}(\\rho u \\phi - \\Gamma \\frac{d\\phi}{dx}) = 0$. Integration gives $(\\rho u \\phi)_e - (\\Gamma \\frac{d\\phi}{dx})_e - [(\\rho u \\phi)_w - (\\Gamma \\frac{d\\phi}{dx})_w] = 0$. The discretization scheme specified in the problem leads to the same algebraic form as we will derive, confirming the consistency of the problem statement.\n\nWe now discretize the terms for a uniform grid where nodes are denoted by $W$ (west), $P$ (central), and $E$ (east), separated by $\\Delta x$.\nThe diffusive fluxes at the faces are approximated using central differences for the gradients:\n$$\n\\left(\\Gamma \\frac{d\\phi}{dx}\\right)_e \\approx \\Gamma_e \\frac{\\phi_E - \\phi_P}{\\Delta x} \\quad \\text{and} \\quad \\left(\\Gamma \\frac{d\\phi}{dx}\\right)_w \\approx \\Gamma_w \\frac{\\phi_P - \\phi_W}{\\Delta x}\n$$\nAssuming a constant diffusion coefficient, $\\Gamma_e = \\Gamma_w = \\Gamma$.\nFor the convective term, the problem specifies the use of CDS, where the value of the scalar $\\phi$ at a face is the arithmetic mean of the adjacent cell-center values:\n$$\n\\phi_e \\approx \\frac{\\phi_P + \\phi_E}{2} \\quad \\text{and} \\quad \\phi_w \\approx \\frac{\\phi_W + \\phi_P}{2}\n$$\nSubstituting these discretizations into the integrated equation yields:\n$$\n\\Gamma \\frac{\\phi_E - \\phi_P}{\\Delta x} - \\Gamma \\frac{\\phi_P - \\phi_W}{\\Delta x} - \\rho u \\left( \\frac{\\phi_P + \\phi_E}{2} - \\frac{\\phi_W + \\phi_P}{2} \\right) = 0\n$$\nSimplifying the terms:\n$$\n\\frac{\\Gamma}{\\Delta x}(\\phi_E - 2\\phi_P + \\phi_W) - \\frac{\\rho u}{2}(\\phi_E - \\phi_W) = 0\n$$\nWe introduce the definitions for diffusive conductance, $D \\equiv \\Gamma/\\Delta x$, and face mass flux, $F \\equiv \\rho u$:\n$$\nD(\\phi_E - 2\\phi_P + \\phi_W) - \\frac{F}{2}(\\phi_E - \\phi_W) = 0\n$$\nTo analyze the properties of the scheme, we rearrange this into the standard linear algebraic form, $a_P \\phi_P = a_W \\phi_W + a_E \\phi_E$:\n$$\n(D\\phi_E - \\frac{F}{2}\\phi_E) + (D\\phi_W + \\frac{F}{2}\\phi_W) - 2D\\phi_P = 0\n$$\n$$\n(2D)\\phi_P = \\left(D + \\frac{F}{2}\\right)\\phi_W + \\left(D - \\frac{F}{2}\\right)\\phi_E\n$$\nFrom this, we identify the coefficients:\n$$\na_W = D + \\frac{F}{2}\n$$\n$$\na_E = D - \\frac{F}{2}\n$$\n$$\na_P = 2D\n$$\nA numerical scheme is bounded if it does not produce unphysical overshoots or undershoots. A sufficient condition for boundedness is that all coefficients of the neighboring nodes ($a_W, a_E$) are non-negative. This ensures that $\\phi_P$ is a weighted average of $\\phi_W$ and $\\phi_E$.\n$$\na_W \\ge 0 \\implies D + \\frac{F}{2} \\ge 0\n$$\n$$\na_E \\ge 0 \\implies D - \\frac{F}{2} \\ge 0\n$$\nSince $D = \\Gamma/\\Delta x$ is inherently positive, these two inequalities combine to give $|F/2| \\le D$, or $|F| \\le 2D$.\n\nThis condition can be expressed using the dimensionless cell Peclet number, defined as $Pe \\equiv \\frac{\\rho u \\Delta x}{\\Gamma}$. We can rewrite $Pe$ using our definitions of $F$ and $D$:\n$$\nPe = \\frac{(\\rho u) \\Delta x}{\\Gamma} = \\frac{F}{(\\Gamma/\\Delta x)} = \\frac{F}{D}\n$$\nThe boundedness criterion $|F| \\le 2D$ can then be rewritten by dividing by $D$:\n$$\n\\frac{|F|}{D} \\le 2 \\implies |Pe| \\le 2\n$$\nThis is the celebrated constraint for the CDS: the scheme is bounded and guaranteed to be physically realistic only when the magnitude of the cell Peclet number is less than or equal to $2$.\n\nNext, we calculate the value of $Pe$ using the provided data:\n$\\rho = 1.2 \\ \\text{kg}\\,\\text{m}^{-3}$, $u = 2 \\ \\text{m}\\,\\text{s}^{-1}$, $\\Gamma = 1.8 \\times 10^{-5} \\ \\text{kg}\\,\\text{m}^{-1}\\,\\text{s}^{-1}$, and $\\Delta x = 1.0 \\times 10^{-2} \\ \\text{m}$.\n$$\nPe = \\frac{\\rho u \\Delta x}{\\Gamma} = \\frac{(1.2)(2)(1.0 \\times 10^{-2})}{1.8 \\times 10^{-5}} = \\frac{2.4 \\times 10^{-2}}{1.8 \\times 10^{-5}}\n$$\n$$\nPe = \\frac{2.4}{1.8} \\times 10^{-2 - (-5)} = \\frac{4}{3} \\times 10^3 = \\frac{4000}{3}\n$$\nThe calculated Peclet number is $Pe = \\frac{4000}{3} \\approx 1333.33$.\n\nFinally, we check this value against the boundedness criterion $|Pe| \\le 2$.\n$$\n\\left|\\frac{4000}{3}\\right| = \\frac{4000}{3} \\approx 1333.33\n$$\nClearly, $\\frac{4000}{3} > 2$. The condition is not met. Therefore, for this set of parameters, the central interpolation scheme is not bounded. This implies that the numerical solution is prone to spurious oscillations and may be physically meaningless. We set the boundedness indicator $b=0$.\n\nThe final answer is the row matrix $\\begin{pmatrix} Pe & b \\end{pmatrix}$.\nSubstituting our results, we get $\\begin{pmatrix} \\frac{4000}{3} & 0 \\end{pmatrix}$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{4000}{3} & 0\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "The accuracy of a finite volume scheme depends not only on the discretization of derivatives but also on the interpolation of material properties at cell faces. When a property like the diffusion coefficient, $\\Gamma$, varies continuously across the domain, a simple arithmetic mean may not be the most accurate choice. This exercise  demonstrates this crucial concept by prompting you to compare the flux computed using arithmetic interpolation against the more physically appropriate harmonic interpolation, thereby quantifying the resulting truncation error.",
            "id": "3298497",
            "problem": "Consider one-dimensional steady diffusion of a passive scalar field $\\phi(x)$ with a spatially varying diffusion coefficient $\\Gamma(x)$ in the framework of Computational Fluid Dynamics (CFD). Using the Finite Volume Method (FVM) on a uniform Cartesian mesh with cell centers located at $x_L$ and $x_R$ and a common interior face located at $x_f = \\frac{x_L + x_R}{2}$, the normal diffusive flux through the face is modeled as $F_f = - \\Gamma_f A_f \\left(\\frac{\\phi_R - \\phi_L}{\\Delta x}\\right)$, where $\\Delta x = x_R - x_L$ is the uniform cell spacing, $A_f$ is the face area, and $\\Gamma_f$ is a face value of the diffusion coefficient obtained by interpolation from cell-center values. For the purpose of isolating the error due solely to the interpolation of $\\Gamma_f$, take a test profile for the diffusion coefficient $\\Gamma(x) = \\Gamma_0 \\left(1 + \\alpha x\\right)$ with constants $\\Gamma_0 > 0$ and $\\alpha$, and a linear scalar field $\\phi(x) = G x$ with constant gradient $G$, so that the central difference $\\left(\\phi_R - \\phi_L\\right)/\\Delta x$ equals the exact gradient $G$.\n\nStarting from the governing constitutive relation $j(x) = - \\Gamma(x) \\frac{\\mathrm{d}\\phi}{\\mathrm{d}x}$ for diffusive flux, and the definition of the FVM face flux, derive the face diffusion coefficient obtained by arithmetic interpolation $\\Gamma_f^{A}$ and the face diffusion coefficient obtained by harmonic interpolation $\\Gamma_f^{H}$ for the given $\\Gamma(x)$ evaluated between the two adjacent control volumes with centers $x_L = x_f - \\frac{\\Delta x}{2}$ and $x_R = x_f + \\frac{\\Delta x}{2}$. Then, compute the truncation error in the face diffusive flux that arises when interpolating $\\Gamma_f$ arithmetically instead of harmonically, defined as $\\delta F \\equiv F_f^{A} - F_f^{H}$. Express your final answer as a single closed-form analytic expression in terms of $\\Gamma_0$, $\\alpha$, $\\Delta x$, and $x_f$, assuming $A_f = 1$ and $G = 1$. No rounding is required, and report the answer in nondimensional form.",
            "solution": "The problem requires the calculation of the difference in diffusive flux at a cell face, $\\delta F$, resulting from the use of arithmetic versus harmonic interpolation for the diffusion coefficient $\\Gamma$. The analysis is performed within the framework of the Finite Volume Method (FVM) for a one-dimensional steady diffusion problem.\n\nFirst, we establish the necessary cell-centered values for the diffusion coefficient, $\\Gamma(x)$. The problem specifies the diffusion coefficient profile as a linear function of position:\n$$\n\\Gamma(x) = \\Gamma_0 (1 + \\alpha x)\n$$\nwhere $\\Gamma_0$ and $\\alpha$ are constants.\n\nThe FVM discretization is on a uniform grid. We consider two adjacent cells with centers at $x_L$ and $x_R$, and a common face at $x_f$. The cell centers are located symmetrically with respect to the face:\n$$\nx_L = x_f - \\frac{\\Delta x}{2}\n$$\n$$\nx_R = x_f + \\frac{\\Delta x}{2}\n$$\nwhere $\\Delta x = x_R - x_L$ is the cell spacing.\n\nThe values of the diffusion coefficient at the cell centers, $\\Gamma_L$ and $\\Gamma_R$, are obtained by evaluating $\\Gamma(x)$ at $x_L$ and $x_R$, respectively:\n$$\n\\Gamma_L = \\Gamma(x_L) = \\Gamma_0 \\left(1 + \\alpha \\left(x_f - \\frac{\\Delta x}{2}\\right)\\right)\n$$\n$$\n\\Gamma_R = \\Gamma(x_R) = \\Gamma_0 \\left(1 + \\alpha \\left(x_f + \\frac{\\Delta x}{2}\\right)\\right)\n$$\n\nNext, we derive the face value of the diffusion coefficient, $\\Gamma_f$, using the two specified interpolation methods.\n\n**1. Arithmetic Interpolation**\nThe arithmetic mean interpolation for the face value $\\Gamma_f^A$ is defined as the simple average of the neighboring cell-center values:\n$$\n\\Gamma_f^A = \\frac{\\Gamma_L + \\Gamma_R}{2}\n$$\nSubstituting the expressions for $\\Gamma_L$ and $\\Gamma_R$:\n$$\n\\Gamma_f^A = \\frac{1}{2} \\left[ \\Gamma_0 \\left(1 + \\alpha x_f - \\frac{\\alpha \\Delta x}{2}\\right) + \\Gamma_0 \\left(1 + \\alpha x_f + \\frac{\\alpha \\Delta x}{2}\\right) \\right]\n$$\n$$\n\\Gamma_f^A = \\frac{\\Gamma_0}{2} \\left( 1 + \\alpha x_f - \\frac{\\alpha \\Delta x}{2} + 1 + \\alpha x_f + \\frac{\\alpha \\Delta x}{2} \\right)\n$$\n$$\n\\Gamma_f^A = \\frac{\\Gamma_0}{2} (2 + 2\\alpha x_f) = \\Gamma_0 (1 + \\alpha x_f)\n$$\nThis result shows that for a linearly varying coefficient, arithmetic interpolation exactly recovers the true value of the coefficient at the face location, $\\Gamma(x_f)$.\n\n**2. Harmonic Interpolation**\nThe harmonic mean interpolation for the face value $\\Gamma_f^H$ is generally used to ensure flux continuity in multidimensional problems and is exact for 1D steady diffusion through piecewise-constant media. It is defined as:\n$$\n\\Gamma_f^H = \\frac{2 \\Gamma_L \\Gamma_R}{\\Gamma_L + \\Gamma_R}\n$$\nFrom the arithmetic mean calculation, we already have the denominator: $\\Gamma_L + \\Gamma_R = 2 \\Gamma_0 (1 + \\alpha x_f)$.\nNow we compute the numerator term $\\Gamma_L \\Gamma_R$:\n$$\n\\Gamma_L \\Gamma_R = \\left[ \\Gamma_0 \\left(1 + \\alpha x_f - \\frac{\\alpha \\Delta x}{2}\\right) \\right] \\left[ \\Gamma_0 \\left(1 + \\alpha x_f + \\frac{\\alpha \\Delta x}{2}\\right) \\right]\n$$\n$$\n\\Gamma_L \\Gamma_R = \\Gamma_0^2 \\left[ \\left(1 + \\alpha x_f\\right) - \\frac{\\alpha \\Delta x}{2} \\right] \\left[ \\left(1 + \\alpha x_f\\right) + \\frac{\\alpha \\Delta x}{2} \\right]\n$$\nUsing the difference of squares identity, $(a-b)(a+b) = a^2 - b^2$:\n$$\n\\Gamma_L \\Gamma_R = \\Gamma_0^2 \\left[ (1 + \\alpha x_f)^2 - \\left(\\frac{\\alpha \\Delta x}{2}\\right)^2 \\right] = \\Gamma_0^2 \\left[ (1 + \\alpha x_f)^2 - \\frac{\\alpha^2 \\Delta x^2}{4} \\right]\n$$\nSubstituting the numerator and denominator into the formula for $\\Gamma_f^H$:\n$$\n\\Gamma_f^H = \\frac{2 \\Gamma_0^2 \\left[ (1 + \\alpha x_f)^2 - \\frac{\\alpha^2 \\Delta x^2}{4} \\right]}{2 \\Gamma_0 (1 + \\alpha x_f)}\n$$\n$$\n\\Gamma_f^H = \\frac{\\Gamma_0 \\left[ (1 + \\alpha x_f)^2 - \\frac{\\alpha^2 \\Delta x^2}{4} \\right]}{1 + \\alpha x_f} = \\Gamma_0 \\left( \\frac{(1 + \\alpha x_f)^2}{1 + \\alpha x_f} - \\frac{\\frac{\\alpha^2 \\Delta x^2}{4}}{1 + \\alpha x_f} \\right)\n$$\n$$\n\\Gamma_f^H = \\Gamma_0 \\left( (1 + \\alpha x_f) - \\frac{\\alpha^2 \\Delta x^2}{4(1 + \\alpha x_f)} \\right)\n$$\n\n**3. Truncation Error in Face Diffusive Flux**\nThe problem defines the FVM face flux as $F_f = - \\Gamma_f A_f \\left(\\frac{\\phi_R - \\phi_L}{\\Delta x}\\right)$.\nFor the specified linear scalar field $\\phi(x) = Gx$, the gradient term is exact: $\\frac{\\phi_R - \\phi_L}{\\Delta x} = G$.\nThe problem provides the conditions $A_f=1$ and $G=1$.\nTherefore, the flux expressions simplify to $F_f^A = -\\Gamma_f^A$ and $F_f^H = -\\Gamma_f^H$.\n\nThe truncation error is defined as $\\delta F \\equiv F_f^{A} - F_f^{H}$.\n$$\n\\delta F = (-\\Gamma_f^A) - (-\\Gamma_f^H) = \\Gamma_f^H - \\Gamma_f^A\n$$\nSubstituting the derived expressions for $\\Gamma_f^A$ and $\\Gamma_f^H$:\n$$\n\\delta F = \\left[ \\Gamma_0 \\left( (1 + \\alpha x_f) - \\frac{\\alpha^2 \\Delta x^2}{4(1 + \\alpha x_f)} \\right) \\right] - \\left[ \\Gamma_0 (1 + \\alpha x_f) \\right]\n$$\n$$\n\\delta F = \\Gamma_0 (1 + \\alpha x_f) - \\frac{\\Gamma_0 \\alpha^2 \\Delta x^2}{4(1 + \\alpha x_f)} - \\Gamma_0 (1 + \\alpha x_f)\n$$\nThe leading terms cancel, leaving the final expression for the error:\n$$\n\\delta F = - \\frac{\\Gamma_0 \\alpha^2 \\Delta x^2}{4(1 + \\alpha x_f)}\n$$\nThis expression represents the difference in the computed face flux when using arithmetic versus harmonic interpolation for a linearly varying diffusion coefficient and a linear scalar field. The error is second-order in the grid spacing $\\Delta x$ and vanishes if the diffusion coefficient is constant ($\\alpha = 0$), as expected.",
            "answer": "$$\n\\boxed{- \\frac{\\Gamma_0 \\alpha^{2} \\Delta x^{2}}{4(1 + \\alpha x_f)}}\n$$"
        },
        {
            "introduction": "After exploring the limitations of central interpolation, it is essential to verify its primary strength: second-order accuracy. The Method of Manufactured Solutions (MMS) provides a rigorous framework for such verification by testing a numerical scheme against a known analytical solution. In this computational practice , you will implement the central interpolation scheme, compute the error against a smooth manufactured solution, and numerically confirm the theoretical order of accuracy, bridging the gap between theory and practical code validation.",
            "id": "3298479",
            "problem": "Consider a one-dimensional, periodic domain $x \\in [0,1]$ with a smooth manufactured solution $\\phi(x) = \\sin(k x)$, where all angles are measured in radians. Let a family of uniform meshes be defined by the number of cells $N \\in \\{10, 20, 40, 80\\}$, and denote the mesh spacing by $\\Delta x = 1/N$. For each mesh, define cell-center positions $x_i = (i + 1/2)\\Delta x$ for $i \\in \\{0, 1, \\dots, N-1\\}$ and face positions $x_{f}^{(j)} = j \\Delta x$ for $j \\in \\{0, 1, \\dots, N-1\\}$, with periodic indexing such that face $j$ lies between the left cell $(j-1) \\bmod N$ and the right cell $j$.\n\nUsing only principles based on smoothness and symmetry about each face, construct a second-order accurate approximation $\\phi_f$ to the face value $\\phi(x_f^{(j)})$ by central interpolation from neighboring cell-center values. For each mesh, compute the discrete $L_2$ norm of the face interpolation error\n$$\n\\|e\\|_{L_2} = \\left( \\Delta x \\sum_{j=0}^{N-1} \\left[\\phi_f^{(j)} - \\phi\\!\\left(x_f^{(j)}\\right)\\right]^2 \\right)^{1/2},\n$$\nand then estimate the observed order of accuracy $p$ by fitting a straight line to the data $\\left(\\ln \\Delta x, \\ln \\|e\\|_{L_2}\\right)$ across the mesh family via least squares, taking $p$ as the slope.\n\nUse the following test suite of wavenumbers $k$:\n- $k = 2\\pi$ (one wavelength across the domain) as a general case,\n- $k = 8\\pi$ (four wavelengths) to probe higher frequency content,\n- $k = 32\\pi$ (sixteen wavelengths) to challenge resolution.\n\nAll angles must be in radians. If all computed errors for a test case are numerically zero for the entire mesh family, define the observed order $p$ to be $+\\infty$ for that case.\n\nYour program should produce a single line of output containing the three observed orders, in the same order as the test suite, as a comma-separated list enclosed in square brackets (e.g., $[p_1,p_2,p_3]$). The outputs must be real numbers (floating-point values); if a case yields an infinite observed order as per the rule above, print it as $+\\infty$ represented by the standard floating-point infinity.",
            "solution": "This problem requires a numerical verification of the order of accuracy for a central interpolation scheme using the Method of Manufactured Solutions (MMS). The solution proceeds in three main steps: implementing the scheme, computing the error on a series of refined meshes, and calculating the observed order of accuracy from the results.\n\n1.  **Interpolation Scheme Construction**: The problem specifies a uniform grid where each face $x_f^{(j)}$ is located at the exact midpoint between the centers of its neighboring cells, $(j-1) \\pmod N$ and $j$. For a smooth function, the simplest second-order accurate central interpolation scheme is the arithmetic mean of the values at the neighboring cell centers:\n    $$\n    \\phi_f^{(j)} = \\frac{\\phi_{(j-1) \\pmod N} + \\phi_j}{2}\n    $$\n    A Taylor series expansion confirms that the leading error term of this approximation is proportional to $\\Delta x^2$, making the scheme second-order accurate.\n\n2.  **Error Calculation Procedure**: For each wavenumber $k$ and for each mesh size $N$ in the specified families, we perform the following steps:\n    a.  Calculate the mesh spacing $\\Delta x = 1/N$.\n    b.  Compute the cell-centered values of the manufactured solution: $\\phi_i = \\sin(k x_i)$ for $i=0, \\dots, N-1$.\n    c.  Compute the interpolated values at each face using the arithmetic mean formula above, taking care to handle the periodic boundary at face $j=0$ (where the left neighbor is cell $N-1$).\n    d.  Compute the exact solution at each face: $\\phi(x_f^{(j)}) = \\sin(k x_f^{(j)})$.\n    e.  Calculate the discrete $L_2$ norm of the error using the given formula: $\\|e\\|_{L_2} = \\sqrt{\\Delta x \\sum_{j=0}^{N-1} (\\phi_f^{(j)} - \\phi(x_f^{(j)}))^2}$.\n\n3.  **Order of Accuracy Estimation**: After computing the $L_2$ error for each mesh size $N \\in \\{10, 20, 40, 80\\}$, we obtain four pairs of $(\\Delta x, \\|e\\|_{L_2})$ values. The theoretical error relationship is $\\|e\\|_{L_2} \\approx C(\\Delta x)^p$. Taking the natural logarithm gives $\\ln(\\|e\\|_{L_2}) \\approx p \\ln(\\Delta x) + \\ln(C)$. This is a linear relationship between $\\ln(\\|e\\|_{L_2})$ and $\\ln(\\Delta x)$, where the slope is the order of accuracy $p$. We find this slope by performing a linear least-squares regression on the four data points $(\\ln(\\Delta x), \\ln(\\|e\\|_{L_2}))$.\n\nThe Python code in the answer block implements this entire procedure. It iterates through the specified wavenumbers and mesh sizes, computes the errors, and then uses `numpy.polyfit` to determine the slope $p$ for each case. The results from running this code are the observed orders of accuracy for the three test cases.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import ...\n\ndef solve():\n    \"\"\"\n    Computes the observed order of accuracy for a central interpolation scheme.\n\n    The problem involves a 1D periodic domain with a manufactured solution\n    phi(x) = sin(k*x). The value at a cell face is interpolated from the two\n    neighboring cell centers using a second-order accurate central scheme, which\n    is the arithmetic mean of the neighboring values.\n\n    The L2 error of this interpolation is computed for a family of meshes. The\n    observed order of accuracy is then determined by a least-squares fit on\n    the log-log plot of the error vs. mesh size.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    k_values = [2 * np.pi, 8 * np.pi, 32 * np.pi]\n    N_values = [10, 20, 40, 80]\n    \n    # Store the observed order of accuracy for each k.\n    observed_orders = []\n\n    for k in k_values:\n        log_dx_list = []\n        log_error_list = []\n        errors_for_case = []\n        \n        for N in N_values:\n            # 1. Define mesh parameters and grid locations.\n            dx = 1.0 / N\n            # Cell centers: x_i = (i + 1/2) * dx\n            x_cell = (np.arange(N) + 0.5) * dx\n            # Face centers: x_f = j * dx\n            x_face = np.arange(N) * dx\n\n            # 2. Evaluate the manufactured solution.\n            # Cell-centered values of the solution.\n            phi_cell = np.sin(k * x_cell)\n            # Exact solution at face locations.\n            phi_face_exact = np.sin(k * x_face)\n\n            # 3. Perform central interpolation for face values.\n            # The scheme is phi_f[j] = 0.5 * (phi_cell[j-1] + phi_cell[j]).\n            # np.roll(phi_cell, 1) provides periodic shifting, so that\n            # phi_left[j] = phi_cell[j-1] (and phi_left[0] = phi_cell[N-1]).\n            phi_left_neighbor = np.roll(phi_cell, 1)\n            phi_right_neighbor = phi_cell\n            phi_face_interp = 0.5 * (phi_left_neighbor + phi_right_neighbor)\n\n            # 4. Compute the discrete L2 norm of the interpolation error.\n            error_vector = phi_face_interp - phi_face_exact\n            l2_error = np.sqrt(dx * np.sum(error_vector**2))\n            \n            errors_for_case.append(l2_error)\n            \n            # Store log-values for regression, avoiding log(0).\n            # A small tolerance is used to check for numerical zero.\n            if l2_error > 1e-16:\n                log_dx_list.append(np.log(dx))\n                log_error_list.append(np.log(l2_error))\n\n        # 5. Estimate the order of accuracy.\n        # Check for the special case of all errors being numerically zero.\n        if np.all(np.array(errors_for_case) < 1e-16):\n            order = np.inf\n        # Ensure at least two points for a meaningful line fit.\n        elif len(log_dx_list) >= 2:\n            # Perform a linear least-squares fit to find the slope.\n            # The model is log(error) = p * log(dx) + C.\n            # np.polyfit returns [slope, intercept].\n            p, _ = np.polyfit(log_dx_list, log_error_list, 1)\n            order = p\n        else:\n            # This case (fewer than 2 non-zero points) is unlikely but\n            # would mean the order cannot be determined from the fit.\n            # We'll assign NaN as a signal of this undefined state.\n            order = np.nan\n            \n        observed_orders.append(order)\n\n    # Final print statement in the exact required format.\n    # The default string representation of np.inf is 'inf', which is the\n    # standard representation for floating-point infinity.\n    print(f\"[{','.join(map(str, observed_orders))}]\")\n\nsolve()\n```"
        }
    ]
}