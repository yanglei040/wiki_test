{
    "hands_on_practices": [
        {
            "introduction": "中心插值方案因其二阶精度而在计算流体动力学中广受欢迎，这意味着其截断误差会随着网格尺寸的平方而减小。本练习将通过一种强大的技术——“制造解方法”(Method of Manufactured Solutions)，来实际验证这一理论特性 。通过在精细化的网格序列上计算插值误差，您将亲手确认该方案的收敛阶，这是验证CFD代码和数值方法可靠性的基本技能。",
            "id": "3298479",
            "problem": "考虑一个一维周期性域 $x \\in [0,1]$，其光滑人造解为 $\\phi(x) = \\sin(k x)$，其中所有角度均以弧度为单位。设一族均匀网格由单元数 $N \\in \\{10, 20, 40, 80\\}$ 定义，并用 $\\Delta x = 1/N$ 表示网格间距。对于每个网格，定义单元中心位置 $x_i = (i + 1/2)\\Delta x$（其中 $i \\in \\{0, 1, \\dots, N-1\\}$）和界面位置 $x_{f}^{(j)} = j \\Delta x$（其中 $j \\in \\{0, 1, \\dots, N-1\\}$），并采用周期性索引，使得界面 $j$ 位于左侧单元 $(j-1) \\bmod N$ 和右侧单元 $j$ 之间。\n\n仅使用基于每个界面的光滑性和对称性原理，通过对相邻单元中心值进行中心插值，构造界面值 $\\phi(x_f^{(j)})$ 的二阶精度近似 $\\phi_f$。对于每个网格，计算界面插值误差的离散 $L_2$ 范数\n$$\n\\|e\\|_{L_2} = \\left( \\Delta x \\sum_{j=0}^{N-1} \\left[\\phi_f^{(j)} - \\phi\\!\\left(x_f^{(j)}\\right)\\right]^2 \\right)^{1/2},\n$$\n然后通过最小二乘法对整个网格族的数据 $\\left(\\ln \\Delta x, \\ln \\|e\\|_{L_2}\\right)$ 进行直线拟合，以斜率作为观测精度阶 $p$ 的估计值。\n\n使用以下波数 $k$ 的测试集：\n- $k = 2\\pi$（一个波长穿过整个域）作为一般情况，\n- $k = 8\\pi$（四个波长）用于探测更高频率的内容，\n- $k = 32\\pi$（十六个波长）用于挑战分辨率。\n\n所有角度必须以弧度为单位。如果某个测试用例的所有计算误差对于整个网格族在数值上均为零，则将该用例的观测阶 $p$ 定义为 $+\\infty$。\n\n您的程序应生成单行输出，其中包含三个观测阶，其顺序与测试集相同，形式为方括号括起来的逗号分隔列表（例如 [p_1,p_2,p_3]）。输出必须是实数（浮点值）；如果根据上述规则，某个用例产生无穷大的观测阶，则将其打印为由标准浮点无穷大表示的 $+\\infty$。",
            "solution": "该问题是适定的、科学上合理的且内部一致的。它提出了一个计算流体动力学领域的标准数值分析任务，具体来说，是使用人造解方法（Method of Manufactured Solutions）对一个数值格式进行验证。所有必需的数据、定义和步骤都已明确提供，从而可以得到唯一且可验证的解。\n\n问题的核心是为变量 $\\phi$ 构建一个从单元中心值到界面位置的二阶精度中心插值格式，然后数值验证其精度阶。\n\n首先，我们根据指定的光滑性和对称性原理设计插值格式。考虑一个间距为 $\\Delta x = 1/N$ 的均匀一维网格。单元中心位于 $x_i = (i + 1/2)\\Delta x$（其中 $i \\in \\{0, 1, \\dots, N-1\\}$），界面位于 $x_{f}^{(j)} = j \\Delta x$（其中 $j \\in \\{0, 1, \\dots, N-1\\}$）。根据问题描述，界面 $j$ 位于单元 $(j-1) \\pmod N$ 和单元 $j$ 之间。这两个单元中心的位置分别为 $x_{j-1} = ((j-1) + 1/2)\\Delta x$ 和 $x_j = (j + 1/2)\\Delta x$。界面位置 $x_f^{(j)}$ 是这两个单元中心的中点：\n$$\n\\frac{x_{j-1} + x_j}{2} = \\frac{((j - 1/2) + (j + 1/2))\\Delta x}{2} = \\frac{2j\\Delta x}{2} = j\\Delta x = x_f^{(j)}\n$$\n鉴于底层函数 $\\phi(x)$ 是光滑的，且插值模板关于目标点 $x_f^{(j)}$ 对称，最简单、最自然的中心插值格式是两个相邻单元中心值 $\\phi_{j-1} = \\phi(x_{j-1})$ 和 $\\phi_j = \\phi(x_j)$ 之间的线性插值。由于 $x_f^{(j)}$ 是中点，这对应于算术平均值：\n$$\n\\phi_f^{(j)} = \\frac{\\phi_{j-1} + \\phi_j}{2}\n$$\n当 $j=0$ 时，使用周期性索引 $(j-1) \\pmod N$ 来找到“左侧”单元 $\\phi_{j-1}$。\n\n接下来，我们必须按要求验证该格式是二阶精度的。我们在界面位置 $x_f^{(j)}$ 附近对 $\\phi(x)$ 进行泰勒级数展开。相邻的单元中心距离界面的距离为 $\\pm \\Delta x/2$。\n$$\n\\phi_j = \\phi(x_j) = \\phi\\left(x_f^{(j)} + \\frac{\\Delta x}{2}\\right) = \\phi(x_f^{(j)}) + \\phi'(x_f^{(j)})\\frac{\\Delta x}{2} + \\frac{1}{2}\\phi''(x_f^{(j)})\\left(\\frac{\\Delta x}{2}\\right)^2 + \\frac{1}{6}\\phi'''(x_f^{(j)})\\left(\\frac{\\Delta x}{2}\\right)^3 + \\mathcal{O}(\\Delta x^4)\n$$\n$$\n\\phi_{j-1} = \\phi(x_{j-1}) = \\phi\\left(x_f^{(j)} - \\frac{\\Delta x}{2}\\right) = \\phi(x_f^{(j)}) - \\phi'(x_f^{(j)})\\frac{\\Delta x}{2} + \\frac{1}{2}\\phi''(x_f^{(j)})\\left(\\frac{\\Delta x}{2}\\right)^2 - \\frac{1}{6}\\phi'''(x_f^{(j)})\\left(\\frac{\\Delta x}{2}\\right)^3 + \\mathcal{O}(\\Delta x^4)\n$$\n将这些展开式代入插值公式：\n$$\n\\phi_f^{(j)} = \\frac{1}{2}(\\phi_{j-1} + \\phi_j) = \\frac{1}{2}\\left[2\\phi(x_f^{(j)}) + \\phi''(x_f^{(j)})\\frac{\\Delta x^2}{4} + \\mathcal{O}(\\Delta x^4)\\right] = \\phi(x_f^{(j)}) + \\frac{1}{8}\\phi''(x_f^{(j)})\\Delta x^2 + \\mathcal{O}(\\Delta x^4)\n$$\n界面 $j$ 处的插值误差（记为 $e_j$）是插值与精确值之差：\n$$\ne_j = \\phi_f^{(j)} - \\phi(x_f^{(j)}) = \\frac{1}{8}\\phi''(x_f^{(j)})\\Delta x^2 + \\mathcal{O}(\\Delta x^4)\n$$\n由于误差的主导项与 $\\Delta x^2$ 成正比，因此该格式是二阶精度的，满足了问题的要求。\n\n为了确定观测精度阶 $p$，我们为一系列逐渐加密的网格计算误差的 $L_2$ 范数 $\\|e\\|_{L_2}$。误差范数与网格间距之间的理论关系是 $\\|e\\|_{L_2} \\approx C(\\Delta x)^p$，其中 $C$ 是一个常数。对两边取自然对数，得到：\n$$\n\\ln(\\|e\\|_{L_2}) \\approx \\ln(C) + p \\ln(\\Delta x)\n$$\n该方程具有直线形式 $y = m x + b$，其中 $y = \\ln(\\|e\\|_{L_2})$，$x = \\ln(\\Delta x)$，斜率即为精度阶 $m=p$，y轴截距为 $b = \\ln(C)$。\n\n计算步骤如下：\n1. 对于测试集 $\\{2\\pi, 8\\pi, 32\\pi\\}$ 中的每个波数 $k$：\n2. 对于网格族 $\\{10, 20, 40, 80\\}$ 中的每个网格尺寸 $N$：\n    a. 计算网格间距 $\\Delta x = 1/N$。\n    b. 定义单元中心位置数组 $x_i$ 和界面位置数组 $x_f^{(j)}$。\n    c. 在单元中心处计算人造解 $\\phi(x) = \\sin(kx)$ 以获得 $\\{\\phi_i\\}$。\n    d. 在界面中心处计算精确解以获得 $\\{\\phi(x_f^{(j)})\\}$。\n    e. 使用 $\\phi_f^{(j)} = (\\phi_{(j-1)\\pmod N} + \\phi_j)/2$ 计算插值的界面值 $\\{\\phi_f^{(j)}\\}$。\n    f. 计算界面插值误差的离散 $L_2$ 范数：$\\|e\\|_{L_2} = \\left( \\Delta x \\sum_{j=0}^{N-1} [\\phi_f^{(j)} - \\phi(x_f^{(j)})]^2 \\right)^{1/2}$。\n    g. 存储数据对 $(\\ln \\Delta x, \\ln \\|e\\|_{L_2})$。\n3. 检查给定 $k$ 的所有计算误差是否在数值上为零。如果是，则设 $p = +\\infty$。\n4. 否则，对点集 $(\\ln \\Delta x, \\ln \\|e\\|_{L_2})$ 执行线性最小二乘回归，以找到斜率，即观测精度阶 $p$。\n\n对给定的三个波数分别执行此过程，以生成最终结果。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import ...\n\ndef solve():\n    \"\"\"\n    Computes the observed order of accuracy for a central interpolation scheme.\n\n    The problem involves a 1D periodic domain with a manufactured solution\n    phi(x) = sin(k*x). The value at a cell face is interpolated from the two\n    neighboring cell centers using a second-order accurate central scheme, which\n    is the arithmetic mean of the neighboring values.\n\n    The L2 error of this interpolation is computed for a family of meshes. The\n    observed order of accuracy is then determined by a least-squares fit on\n    the log-log plot of the error vs. mesh size.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    k_values = [2 * np.pi, 8 * np.pi, 32 * np.pi]\n    N_values = [10, 20, 40, 80]\n    \n    # Store the observed order of accuracy for each k.\n    observed_orders = []\n\n    for k in k_values:\n        log_dx_list = []\n        log_error_list = []\n        errors_for_case = []\n        \n        for N in N_values:\n            # 1. Define mesh parameters and grid locations.\n            dx = 1.0 / N\n            # Cell centers: x_i = (i + 1/2) * dx\n            x_cell = (np.arange(N) + 0.5) * dx\n            # Face centers: x_f = j * dx\n            x_face = np.arange(N) * dx\n\n            # 2. Evaluate the manufactured solution.\n            # Cell-centered values of the solution.\n            phi_cell = np.sin(k * x_cell)\n            # Exact solution at face locations.\n            phi_face_exact = np.sin(k * x_face)\n\n            # 3. Perform central interpolation for face values.\n            # The scheme is phi_f[j] = 0.5 * (phi_cell[j-1] + phi_cell[j]).\n            # np.roll(phi_cell, 1) provides periodic shifting, so that\n            # phi_left[j] = phi_cell[j-1] (and phi_left[0] = phi_cell[N-1]).\n            phi_left_neighbor = np.roll(phi_cell, 1)\n            phi_right_neighbor = phi_cell\n            phi_face_interp = 0.5 * (phi_left_neighbor + phi_right_neighbor)\n\n            # 4. Compute the discrete L2 norm of the interpolation error.\n            error_vector = phi_face_interp - phi_face_exact\n            l2_error = np.sqrt(dx * np.sum(error_vector**2))\n            \n            errors_for_case.append(l2_error)\n            \n            # Store log-values for regression, avoiding log(0).\n            # A small tolerance is used to check for numerical zero.\n            if l2_error > 1e-16:\n                log_dx_list.append(np.log(dx))\n                log_error_list.append(np.log(l2_error))\n\n        # 5. Estimate the order of accuracy.\n        # Check for the special case of all errors being numerically zero.\n        if np.all(np.array(errors_for_case)  1e-16):\n            order = np.inf\n        # Ensure at least two points for a meaningful line fit.\n        elif len(log_dx_list) >= 2:\n            # Perform a linear least-squares fit to find the slope.\n            # The model is log(error) = p * log(dx) + C.\n            # np.polyfit returns [slope, intercept].\n            p, _ = np.polyfit(log_dx_list, log_error_list, 1)\n            order = p\n        else:\n            # This case (fewer than 2 non-zero points) is unlikely but\n            # would mean the order cannot be determined from the fit.\n            # We'll assign NaN as a signal of this undefined state.\n            order = np.nan\n            \n        observed_orders.append(order)\n\n    # Final print statement in the exact required format.\n    # The default string representation of np.inf is 'inf', which is the\n    # standard representation for floating-point infinity.\n    print(f\"[{','.join(map(str, observed_orders))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "尽管中心差分格式具有二阶精度，但它有一个显著的局限性，即在对流主导的问题中可能会产生非物理的振荡。这个练习旨在揭示这一问题，您将通过推导著名的单元格佩克莱数（cell Peclet number）判据来量化这一限制 。理解这一判据对于判断何时可以安全使用中心插值以及何时需要更高级的格式至关重要。",
            "id": "3298459",
            "problem": "考虑在一个具有均匀控制体网格上，一个被动标量 $\\phi(x)$ 的一维稳态对流-扩散输运。网格间距为 $\\Delta x$，横截面积为单位面积。其控制微分守恒方程为\n$$\\frac{d}{dx}\\left(\\Gamma \\frac{d \\phi}{dx}\\right) - \\rho u \\frac{d \\phi}{dx} = 0,$$\n其中 $\\rho$ 是流体密度，$u$ 是恒定速度，$\\Gamma$ 是 $\\phi$ 的扩散系数。使用有限体积法 (FVM)，在一个以面 $w$ (西) 和 $e$ (东) 为界的通用内部控制体 $P$ 上进行积分，并用中心梯度离散化扩散通量。对于对流通量，采用中心插值法计算界面值（中心差分格式，CDS），这意味着在均匀网格上，界面值是相邻单元中心值的算术平均值。定义界面质量通量大小为 $F \\equiv \\rho u$（单位面积），扩散导率为 $D \\equiv \\Gamma/\\Delta x$。\n\n如果在线性化代数方程中，乘以相邻未知数的系数为非负，并且中心系数满足必要的优势条件以排除离散解中的过冲和下冲，则称离散格式有界。推导由 CDS 蕴含的系数约束，并用无量纲的单元佩克莱数 (Peclet number) 表示有界性要求\n$$Pe \\equiv \\frac{\\rho u \\,\\Delta x}{\\Gamma} = \\frac{F}{D}.$$\n\n然后，对于给定的参数值\n$$\\rho = 1.2 \\ \\text{kg}\\,\\text{m}^{-3}, \\quad u = 2 \\ \\text{m}\\,\\text{s}^{-1}, \\quad \\Gamma = 1.8 \\times 10^{-5} \\ \\text{kg}\\,\\text{m}^{-1}\\,\\text{s}^{-1}, \\quad \\Delta x = 1.0 \\times 10^{-2} \\ \\text{m},$$\n计算 $Pe$ 的数值，并判断在这些条件下中心插值是否是有界的。将最终答案以行矩阵 $\\begin{pmatrix} Pe  b \\end{pmatrix}$ 的形式报告，其中如果中心插值是有界的，则 $b=1$，否则 $b=0$。将 $Pe$ 表示为无单位的纯数，$b$ 表示为无量纲的指示符。无需四舍五入；尽可能提供精确值。",
            "solution": "本任务是推导应用于一维稳态对流-扩散方程的中心差分格式 (CDS) 的有界性准则，然后对一组特定的物理参数评估此准则。\n\n控制微分方程如下：\n$$\n\\frac{d}{dx}\\left(\\Gamma \\frac{d\\phi}{dx}\\right) - \\rho u \\frac{d\\phi}{dx} = 0\n$$\n其中 $\\phi$ 是被动标量，$\\Gamma$ 是扩散系数，$\\rho$ 是密度，而 $u$ 是速度。\n\n为应用有限体积法 (FVM)，我们将此方程在一个以节点 $P$ 为中心、以西面 $w$ 和东面 $e$ 为界的通用控制体 (CV) 上进行积分。控制体的体积为 $\\Delta V = A \\Delta x$，其中横截面积给定为单位面积 ($A=1$)，网格间距为 $\\Delta x$。\n$$\n\\int_{w}^{e} \\left[ \\frac{d}{dx}\\left(\\Gamma \\frac{d\\phi}{dx}\\right) - \\rho u \\frac{d\\phi}{dx} \\right] A \\, dx = 0\n$$\n由于 $A=1$，我们可以写成：\n$$\n\\int_{w}^{e} \\frac{d}{dx}\\left(\\Gamma \\frac{d\\phi}{dx}\\right) dx - \\int_{w}^{e} \\rho u \\frac{d\\phi}{dx} dx = 0\n$$\n对第一项（扩散通量的散度）应用微积分基本定理，并假设第二项的 $\\rho$ 和 $u$ 为常数，我们得到控制体上的平衡方程：\n$$\n\\left(A \\Gamma \\frac{d\\phi}{dx}\\right)_e - \\left(A \\Gamma \\frac{d\\phi}{dx}\\right)_w - \\rho u A (\\phi_e - \\phi_w) = 0\n$$\n再次，当 $A=1$ 时：\n$$\n\\left(\\Gamma \\frac{d\\phi}{dx}\\right)_e - \\left(\\Gamma \\frac{d\\phi}{dx}\\right)_w - \\rho u (\\phi_e - \\phi_w) = 0\n$$\n该方程表示穿过控制体界面的扩散通量和对流通量的平衡。标准的 FVM 方法处理界面上的总通量。一个等效且更标准的起点是散度形式的守恒律，$\\frac{d}{dx}(\\rho u \\phi - \\Gamma \\frac{d\\phi}{dx}) = 0$。积分得到 $(\\rho u \\phi)_e - (\\Gamma \\frac{d\\phi}{dx})_e - [(\\rho u \\phi)_w - (\\Gamma \\frac{d\\phi}{dx})_w] = 0$。问题中指定的离散格式将导致与我们即将推导的相同的代数形式，这证实了问题陈述的一致性。\n\n现在我们对一个均匀网格上的各项进行离散化，网格节点由 $W$ (西)、$P$ (中心) 和 $E$ (东) 表示，它们之间的距离为 $\\Delta x$。\n界面上的扩散通量使用中心差分来近似梯度：\n$$\n\\left(\\Gamma \\frac{d\\phi}{dx}\\right)_e \\approx \\Gamma_e \\frac{\\phi_E - \\phi_P}{\\Delta x} \\quad \\text{和} \\quad \\left(\\Gamma \\frac{d\\phi}{dx}\\right)_w \\approx \\Gamma_w \\frac{\\phi_P - \\phi_W}{\\Delta x}\n$$\n假设扩散系数恒定，$\\Gamma_e = \\Gamma_w = \\Gamma$。\n对于对流项，问题指定使用 CDS，其中界面上标量 $\\phi$ 的值是相邻单元中心值的算术平均值：\n$$\n\\phi_e \\approx \\frac{\\phi_P + \\phi_E}{2} \\quad \\text{和} \\quad \\phi_w \\approx \\frac{\\phi_W + \\phi_P}{2}\n$$\n将这些离散化形式代入积分方程中，得到：\n$$\n\\Gamma \\frac{\\phi_E - \\phi_P}{\\Delta x} - \\Gamma \\frac{\\phi_P - \\phi_W}{\\Delta x} - \\rho u \\left( \\frac{\\phi_P + \\phi_E}{2} - \\frac{\\phi_W + \\phi_P}{2} \\right) = 0\n$$\n简化各项：\n$$\n\\frac{\\Gamma}{\\Delta x}(\\phi_E - 2\\phi_P + \\phi_W) - \\frac{\\rho u}{2}(\\phi_E - \\phi_W) = 0\n$$\n我们引入扩散导率 $D \\equiv \\Gamma/\\Delta x$ 和界面质量通量 $F \\equiv \\rho u$ 的定义：\n$$\nD(\\phi_E - 2\\phi_P + \\phi_W) - \\frac{F}{2}(\\phi_E - \\phi_W) = 0\n$$\n为了分析该格式的性质，我们将其重排为标准的线性代数形式 $a_P \\phi_P = a_W \\phi_W + a_E \\phi_E$：\n$$\n(D\\phi_E - \\frac{F}{2}\\phi_E) + (D\\phi_W + \\frac{F}{2}\\phi_W) - 2D\\phi_P = 0\n$$\n$$\n(2D)\\phi_P = \\left(D + \\frac{F}{2}\\right)\\phi_W + \\left(D - \\frac{F}{2}\\right)\\phi_E\n$$\n由此，我们确定系数：\n$$\na_W = D + \\frac{F}{2}\n$$\n$$\na_E = D - \\frac{F}{2}\n$$\n$$\na_P = 2D\n$$\n如果一个数值格式不产生非物理的过冲或下冲，则它是有界的。有界性的一个充分条件是所有相邻节点的系数 ($a_W, a_E$) 都是非负的。这确保了 $\\phi_P$ 是 $\\phi_W$ 和 $\\phi_E$ 的加权平均值。\n$$\na_W \\ge 0 \\implies D + \\frac{F}{2} \\ge 0\n$$\n$$\na_E \\ge 0 \\implies D - \\frac{F}{2} \\ge 0\n$$\n由于 $D = \\Gamma/\\Delta x$ 内在地为正，这两个不等式合并得到 $|F/2| \\le D$，或 $|F| \\le 2D$。\n\n这个条件可以用无量纲的单元佩克莱数来表示，其定义为 $Pe \\equiv \\frac{\\rho u \\Delta x}{\\Gamma}$。我们可以用我们对 $F$ 和 $D$ 的定义来重写 $Pe$：\n$$\nPe = \\frac{(\\rho u) \\Delta x}{\\Gamma} = \\frac{F}{(\\Gamma/\\Delta x)} = \\frac{F}{D}\n$$\n有界性准则 $|F| \\le 2D$ 于是可以通过除以 $D$ 来重写：\n$$\n\\frac{|F|}{D} \\le 2 \\implies |Pe| \\le 2\n$$\n这就是 CDS 著名的约束条件：只有当单元佩克莱数的绝对值小于或等于 $2$ 时，该格式才是有界的，并保证是物理上真实的。\n\n接下来，我们使用所提供的数据计算 $Pe$ 的值：\n$\\rho = 1.2 \\ \\text{kg}\\,\\text{m}^{-3}$，$u = 2 \\ \\text{m}\\,\\text{s}^{-1}$，$\\Gamma = 1.8 \\times 10^{-5} \\ \\text{kg}\\,\\text{m}^{-1}\\,\\text{s}^{-1}$，以及 $\\Delta x = 1.0 \\times 10^{-2} \\ \\text{m}$。\n$$\nPe = \\frac{\\rho u \\Delta x}{\\Gamma} = \\frac{(1.2)(2)(1.0 \\times 10^{-2})}{1.8 \\times 10^{-5}} = \\frac{2.4 \\times 10^{-2}}{1.8 \\times 10^{-5}}\n$$\n$$\nPe = \\frac{2.4}{1.8} \\times 10^{-2 - (-5)} = \\frac{4}{3} \\times 10^3 = \\frac{4000}{3}\n$$\n计算出的佩克莱数为 $Pe = \\frac{4000}{3} \\approx 1333.33$。\n\n最后，我们将这个值与有界性准则 $|Pe| \\le 2$ 进行比较。\n$$\n\\left|\\frac{4000}{3}\\right| = \\frac{4000}{3} \\approx 1333.33\n$$\n显然，$\\frac{4000}{3}  2$。该条件不满足。因此，对于这组参数，中心插值格式是无界的。这意味着数值解容易出现伪振荡，并且可能在物理上是无意义的。我们将有界性指示符设为 $b=0$。\n\n最终答案是行矩阵 $\\begin{pmatrix} Pe  b \\end{pmatrix}$。\n代入我们的结果，得到 $\\begin{pmatrix} \\frac{4000}{3}  0 \\end{pmatrix}$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{4000}{3}  0\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "将数值方案应用于实际问题时，边界条件的处理是一个关键步骤。本练习将探讨如何在有限体积法中为中心插值方案正确施加狄利克雷（Dirichlet）边界条件，特别是在非均匀网格或边界处 。通过构建一个“虚拟单元”（ghost cell）的值，您将学习如何确保边界值被精确施加，同时保持插值方法的基本原理。",
            "id": "3298478",
            "problem": "在计算流体动力学（CFD）的有限体积法（FVM）中，考虑一个邻近边界的控制体积，其中输运着一个无量纲的被动标量场 $\\,\\phi\\,$。设控制体积的形心位于域内位置 $\\,x_{P}\\,$，一个平面边界面沿局部外法线坐标 $\\,x\\,$ 的形心位于位置 $\\,x_{f}\\,$。在域外沿同一法线构建一个虚拟点 $\\,G\\,$，其位置为 $\\,x_{G}\\,$，满足 $\\,x_{P}  x_{f}  x_{G}\\,$，并且面的插值将使用中心差分法，其方式对于任何线性函数 $\\,\\phi(x)\\,$ 都是精确的。一个狄利克雷（Dirichlet）边界条件在物理边界面形心 $\\,x_{f}\\,$ 处指定了面值为 $\\,\\phi_{f} = \\phi_{B}\\,$。\n\n仅从线性函数 $\\,\\phi(x) = a + b\\,x\\,$ 的定义出发，并利用当 $\\,\\phi(x)\\,$ 为线性时，内部形心 $\\,P\\,$ 和虚拟点 $\\,G\\,$ 之间的中心线性插值必须在 $\\,x_{f}\\,$ 处再现 $\\,\\phi_{f} = \\phi_{B}\\,$ 这一要求，推导虚拟点值 $\\,\\phi_{G}\\,$ 关于 $\\,\\phi_{P}\\,$, $\\,\\phi_{B}\\,$, $\\,x_{P}\\,$, $\\,x_{G}\\,$ 和 $\\,x_{f}\\,$ 的表达式。请将你的最终结果以 $\\,\\phi_{G}\\,$ 的单个简化解析表达式的形式给出。标量 $\\,\\phi\\,$ 是无量纲的，因此不需要物理单位。无需进行数值舍入。",
            "solution": "首先根据所需准则对问题进行验证。\n\n**步骤 1：提取已知条件**\n- 方法：计算流体动力学（CFD）的有限体积法（FVM）。\n- 场：一个无量纲的被动标量场，$\\phi$。\n- 几何实体及其沿局部外法线 $x$ 的坐标：\n    - 控制体积形心位于位置 $x_P$。\n    - 平面边界面形心位于位置 $x_f$。\n    - 虚拟点位于位置 $x_G$。\n- 几何顺序：$x_P  x_f  x_G$。\n- 边界条件：在面上的狄利克雷（Dirichlet）条件，$\\phi_f = \\phi_B$，其中 $\\phi_f$ 是 $\\phi$ 在 $x_f$ 处的值。\n- 插值要求：内部形心 $P$ 和虚拟点 $G$ 之间的中心线性插值必须在位置 $x_f$ 处再现值 $\\phi_f = \\phi_B$。此插值格式必须对任何线性剖面 $\\phi(x)$ 都精确。\n- 用于推导的函数形式：$\\phi(x) = a + b\\,x$。\n- 目标：推导虚拟点值 $\\phi_G$ 关于 $\\phi_P$、$\\phi_B$、$x_P$、$x_G$ 和 $x_f$ 的表达式。值 $\\phi_P$ 是形心 $P$ 处的标量值。\n\n**步骤 2：使用提取的已知条件进行验证**\n- **科学和事实的合理性**：该问题描述了在FVM中实现狄利克雷（Dirichlet）边界条件的虚拟单元法。这是计算物理学和工程学中一种标准且基础的技术。该设置在科学和数学上是合理的。\n- **适定性**：该问题是适定的。它提供了一个明确的目标和一组充分的约束条件，以确定目标变量 $\\phi_G$ 的唯一解析表达式。\n- **客观性**：该问题以精确、客观且无偏见的技术语言陈述。\n- **完整性和一致性**：该问题是自洽的。所提供的变量和条件对于推导是必要且充分的。几何顺序 $x_P  x_f  x_G$ 与内部单元、边界面和外部虚拟点的标准排列方式一致。\n- **现实性**：该设置是一个理想化的一维表示，这是分析和推导数值格式的标准方法。在数值方法的背景下，它是完全现实的。\n\n**步骤 3：结论与行动**\n- 问题被判定为**有效**。现在开始推导解答。\n\n推导从插值格式必须对任意线性标量场精确这一前提开始。设该场由函数 $\\phi(x) = a + b\\,x$ 表示，其中 $a$ 和 $b$ 是常数。\n\n标量场 $\\phi$ 在控制体积形心 $P$、边界面 $f$ 和虚拟点 $G$ 处的值，可通过在此线性函数中代入它们各自的位置 $x_P$、$x_f$ 和 $x_G$ 来得到：\n$$ \\phi_P = \\phi(x_P) = a + b\\,x_P $$\n$$ \\phi_B = \\phi(x_f) = a + b\\,x_f $$\n$$ \\phi_G = \\phi(x_G) = a + b\\,x_G $$\n\n此处，我们使用了给定的狄利克雷（Dirichlet）边界条件，$\\phi(x_f) = \\phi_B$。我们得到了一个包含两个未知系数 $a$ 和 $b$ 的三元线性方程组。目标是找到一个仅依赖于已知值 $\\phi_P$、$\\phi_B$ 和位置 $x_P$、$x_f$、$x_G$ 的 $\\phi_G$ 表达式。这需要从方程组中消去 $a$ 和 $b$。\n\n首先，我们可以解出系数 $b$，它代表线性场的梯度。从 $\\phi_B$ 的方程中减去 $\\phi_P$ 的方程：\n$$ \\phi_B - \\phi_P = (a + b\\,x_f) - (a + b\\,x_P) $$\n$$ \\phi_B - \\phi_P = b\\,x_f - b\\,x_P = b\\,(x_f - x_P) $$\n\n由于点 $P$ 和 $f$ 是不同的（$x_P  x_f$），项 $(x_f - x_P)$ 非零。因此我们可以解出 $b$：\n$$ b = \\frac{\\phi_B - \\phi_P}{x_f - x_P} $$\n\n接下来，我们可以解出系数 $a$。由第一个方程，我们有 $a = \\phi_P - b\\,x_P$。将 $b$ 的表达式代入此方程是可行的，但对于最后一步并非绝对必要。\n\n我们的目标是求 $\\phi_G$。让我们对 $\\phi_G$ 的方程进行变形，使其与 $\\phi_P$ 相关联。\n$$ \\phi_G = a + b\\,x_G $$\n我们可以通过加上再减去 $b\\,x_P$ 来重写此式：\n$$ \\phi_G = (a + b\\,x_P) + b\\,x_G - b\\,x_P $$\n注意到 $a + b\\,x_P = \\phi_P$，我们有：\n$$ \\phi_G = \\phi_P + b\\,(x_G - x_P) $$\n\n该表达式表明，虚拟点的值 $\\phi_G$ 是通过使用梯度 $b$ 在距离 $(x_G - x_P)$ 上从内部点的值 $\\phi_P$ 外插得到的。\n\n最后，我们代入先前推导出的梯度 $b$ 的表达式：\n$$ \\phi_G = \\phi_P + \\left( \\frac{\\phi_B - \\phi_P}{x_f - x_P} \\right) (x_G - x_P) $$\n\n这个表达式给出了所需的虚拟点值 $\\phi_G$ 关于已知量 $\\phi_P$、$\\phi_B$、$x_P$、$x_G$ 和 $x_f$ 的表达式。该表达式确保了在 $(x_P, \\phi_P)$ 和 $(x_G, \\phi_G)$ 之间的线性插值将在位置 $x_f$ 处精确得到值 $\\phi_B$。这满足了题目的要求。结果可以写成一个单一的简化解析表达式。",
            "answer": "$$\n\\boxed{\\phi_P + (\\phi_B - \\phi_P) \\frac{x_G - x_P}{x_f - x_P}}\n$$"
        }
    ]
}