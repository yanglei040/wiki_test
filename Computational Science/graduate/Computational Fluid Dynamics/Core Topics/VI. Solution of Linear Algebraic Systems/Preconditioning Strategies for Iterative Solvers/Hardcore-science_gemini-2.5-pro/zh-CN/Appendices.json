{
    "hands_on_practices": [
        {
            "introduction": "预处理器的应用从根本上改变了我们求解的线性系统。根据预处理器矩阵 $M$ 是从左侧、右侧还是两侧作用于原系统，我们会得到不同的预处理系统。这个练习将通过一个具体的计算任务，让你亲手实践左预处理和右预处理的广义最小残差法（GMRES）迭代过程。通过比较两种策略下产生的真实残差，你将深刻理解不同预处理方式对求解器行为和收敛轨迹的细微影响。",
            "id": "3352731",
            "problem": "考虑一个简化计算流体动力学离散化中出现的线性系统，\n$$\nA x = b,\n$$\n其中 $A \\in \\mathbb{R}^{3 \\times 3}$ 是非对称矩阵，$M \\in \\mathbb{R}^{3 \\times 3}$ 是一个可逆的预条件子。令\n$$\nA = \\begin{pmatrix}\n4  1  0 \\\\\n2  3  1 \\\\\n0  -1  2\n\\end{pmatrix}, \n\\quad\nM = \\begin{pmatrix}\n1  0  0 \\\\\n0  2  0 \\\\\n0  0  3\n\\end{pmatrix},\n\\quad\nb = \\begin{pmatrix}\n1 \\\\\n2 \\\\\n3\n\\end{pmatrix},\n\\quad\nx_0 = \\begin{pmatrix}\n0 \\\\\n0 \\\\\n0\n\\end{pmatrix}.\n$$\n广义最小残差 (GMRES) 方法通过在仿射克雷洛夫子空间上最小化相应的残差范数来计算 $x_k$，该子空间由算子和初始残差构成，具体取决于使用的是左预处理还是右预处理。对于左预处理，我们求解 $M^{-1} A x = M^{-1} b$ 并最小化预处理后的残差范数；对于右预处理，我们求解 $A M^{-1} y = b$（其中 $x = x_0 + M^{-1} y$）并最小化真实残差的范数。从 $x_0$ 出发，对两种预处理策略各使用仅 $k=1$ 个基向量（即，执行恰好一次 GMRES 迭代）：\n- 从第一性原理推导左预处理系统和右预处理系统的单步 GMRES 更新，\n- 在原始（未预处理）系统中，显式计算迭代后的残差 $r_{1,\\mathrm{L}} = b - A x_{1,\\mathrm{L}}$ 和 $r_{1,\\mathrm{R}} = b - A x_{1,\\mathrm{R}}$，\n- 计算欧几里得范数 $\\|r_{1,\\mathrm{L}}\\|_2$ 和 $\\|r_{1,\\mathrm{R}}\\|_2$。\n\n作为最终答案，给出比值 $\\|r_{1,\\mathrm{L}}\\|_2 \\big/ \\|r_{1,\\mathrm{R}}\\|_2$ 的精确值。不要四舍五入；以精确解析形式表示结果。",
            "solution": "用户提供了一个问题，要求对一个线性系统应用一次广义最小残差 (GMRES) 方法的迭代，并同时使用左预处理和右预处理策略。目标是计算所得真实残差的欧几里得范数之比。\n\n### 步骤 1：提取已知条件\n给定的矩阵和向量如下：\n- $A = \\begin{pmatrix} 4  1  0 \\\\ 2  3  1 \\\\ 0  -1  2 \\end{pmatrix}$\n- $M = \\begin{pmatrix} 1  0  0 \\\\ 0  2  0 \\\\ 0  0  3 \\end{pmatrix}$\n- $b = \\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\end{pmatrix}$\n- $x_0 = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}$\n问题指定执行一次 GMRES 迭代 ($k=1$）。\n\n### 步骤 2：使用提取的已知条件进行验证\n1.  **科学依据：** 该问题植根于数值线性代数，特别是使用带预处理的 GMRES 方法迭代求解线性系统。这些是计算科学与工程领域的标准且成熟的课题。没有违反科学或数学原理的地方。\n2.  **适定性：** 矩阵 $A$ 是非奇异的 ($\\det(A) = 4(6 - (-1)) - 1(4 - 0) = 4(7) - 4 = 24 \\neq 0$)。预条件子 $M$ 是一个对角线上元素非零的对角矩阵，因此是可逆的。初始状态和所需的计算都已明确定义。所有步骤都存在唯一解。\n3.  **客观性：** 问题使用精确的数学语言和符号陈述。没有主观或含糊的术语。\n4.  **自洽性与一致性：** 所有必要的数据（$A, M, b, x_0$）均已提供。问题内部是一致的。\n\n### 步骤 3：结论与行动\n该问题有效。将提供完整的解答。\n\n### 解题推导\n\n首先，我们计算预条件子 $M$ 的逆，因为它在两种情况下都会用到。\n$$M = \\begin{pmatrix} 1  0  0 \\\\ 0  2  0 \\\\ 0  0  3 \\end{pmatrix} \\implies M^{-1} = \\begin{pmatrix} 1  0  0 \\\\ 0  \\frac{1}{2}  0 \\\\ 0  0  \\frac{1}{3} \\end{pmatrix}$$\n\n#### 左预处理\n\n对于左预处理，我们求解系统 $M^{-1} A x = M^{-1} b$。令 $\\tilde{A} = M^{-1}A$ 且 $\\tilde{b} = M^{-1}b$。GMRES 方法应用于 $\\tilde{A}x = \\tilde{b}$。\n\n初始猜测为 $x_0 = (0, 0, 0)^T$。初始预处理残差为：\n$$\\tilde{r}_0 = \\tilde{b} - \\tilde{A}x_0 = \\tilde{b} = M^{-1}b = \\begin{pmatrix} 1  0  0 \\\\ 0  \\frac{1}{2}  0 \\\\ 0  0  \\frac{1}{3} \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix}$$\n一次 GMRES 迭代寻找一个解 $x_{1,\\mathrm{L}} \\in x_0 + \\mathcal{K}_1(\\tilde{A}, \\tilde{r}_0)$，其中 $\\mathcal{K}_1(\\tilde{A}, \\tilde{r}_0) = \\mathrm{span}\\{\\tilde{r}_0\\}$。\n因此，$x_{1,\\mathrm{L}} = x_0 + \\alpha_{\\mathrm{L}} \\tilde{r}_0 = \\alpha_{\\mathrm{L}} \\tilde{r}_0$。\n选择标量 $\\alpha_{\\mathrm{L}}$ 以最小化新的预处理残差的范数，即 $\\|\\tilde{r}_{1,\\mathrm{L}}\\|_2 = \\|\\tilde{b} - \\tilde{A}x_{1,\\mathrm{L}}\\|_2$。\n$$\\min_{\\alpha_{\\mathrm{L}}} \\|\\tilde{r}_0 - \\alpha_{\\mathrm{L}} \\tilde{A}\\tilde{r}_0\\|_2$$\n这是一个线性最小二乘问题，其解 $\\alpha_{\\mathrm{L}}$ 由正规方程给出：\n$$\\alpha_{\\mathrm{L}} = \\frac{\\langle \\tilde{A}\\tilde{r}_0, \\tilde{r}_0 \\rangle}{\\|\\tilde{A}\\tilde{r}_0\\|_2^2}$$\n我们计算各项：\n$$\\tilde{A} = M^{-1}A = \\begin{pmatrix} 1  0  0 \\\\ 0  \\frac{1}{2}  0 \\\\ 0  0  \\frac{1}{3} \\end{pmatrix} \\begin{pmatrix} 4  1  0 \\\\ 2  3  1 \\\\ 0  -1  2 \\end{pmatrix} = \\begin{pmatrix} 4  1  0 \\\\ 1  \\frac{3}{2}  \\frac{1}{2} \\\\ 0  -\\frac{1}{3}  \\frac{2}{3} \\end{pmatrix}$$\n$$\\tilde{A}\\tilde{r}_0 = \\begin{pmatrix} 4  1  0 \\\\ 1  \\frac{3}{2}  \\frac{1}{2} \\\\ 0  -\\frac{1}{3}  \\frac{2}{3} \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 5 \\\\ 1+\\frac{3}{2}+\\frac{1}{2} \\\\ -\\frac{1}{3}+\\frac{2}{3} \\end{pmatrix} = \\begin{pmatrix} 5 \\\\ 3 \\\\ \\frac{1}{3} \\end{pmatrix}$$\n现在我们求解 $\\alpha_{\\mathrm{L}}$：\n$$\\langle \\tilde{A}\\tilde{r}_0, \\tilde{r}_0 \\rangle = \\begin{pmatrix} 5 \\\\ 3 \\\\ \\frac{1}{3} \\end{pmatrix} \\cdot \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} = 5 + 3 + \\frac{1}{3} = \\frac{25}{3}$$\n$$\\|\\tilde{A}\\tilde{r}_0\\|_2^2 = 5^2 + 3^2 + \\left(\\frac{1}{3}\\right)^2 = 25 + 9 + \\frac{1}{9} = 34 + \\frac{1}{9} = \\frac{307}{9}$$\n$$\\alpha_{\\mathrm{L}} = \\frac{25/3}{307/9} = \\frac{25}{3} \\cdot \\frac{9}{307} = \\frac{75}{307}$$\n更新后的解为：\n$$x_{1,\\mathrm{L}} = \\frac{75}{307} \\tilde{r}_0 = \\frac{75}{307} \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix}$$\n真实（未预处理）残差为 $r_{1,\\mathrm{L}} = b - A x_{1,\\mathrm{L}}$：\n$$A \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 4  1  0 \\\\ 2  3  1 \\\\ 0  -1  2 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 5 \\\\ 6 \\\\ 1 \\end{pmatrix}$$\n$$r_{1,\\mathrm{L}} = \\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\end{pmatrix} - \\frac{75}{307} \\begin{pmatrix} 5 \\\\ 6 \\\\ 1 \\end{pmatrix} = \\frac{1}{307} \\left( \\begin{pmatrix} 307 \\\\ 614 \\\\ 921 \\end{pmatrix} - \\begin{pmatrix} 375 \\\\ 450 \\\\ 75 \\end{pmatrix} \\right) = \\frac{1}{307} \\begin{pmatrix} -68 \\\\ 164 \\\\ 846 \\end{pmatrix}$$\n该残差的范数平方为：\n$$\\|r_{1,\\mathrm{L}}\\|_2^2 = \\frac{1}{307^2} \\left( (-68)^2 + 164^2 + 846^2 \\right) = \\frac{4624 + 26896 + 715716}{307^2} = \\frac{747236}{307^2}$$\n\n#### 右预处理\n\n对于右预处理，我们求解系统 $A M^{-1} y = b$，然后找到 $x = x_0 + M^{-1}y$。令 $\\hat{A} = AM^{-1}$。GMRES 方法应用于 $\\hat{A}y = b$。\n\n$y$ 的初始猜测为 $y_0 = 0$（因为 $x_0 = 0$）。初始残差为：\n$$\\hat{r}_0 = b - \\hat{A}y_0 = b = \\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\end{pmatrix}$$\n一次 GMRES 迭代寻找一个解 $y_1 \\in y_0 + \\mathcal{K}_1(\\hat{A}, \\hat{r}_0) = \\mathrm{span}\\{\\hat{r}_0\\}$。因此，$y_1 = y_0 + \\alpha_{\\mathrm{R}} \\hat{r}_0 = \\alpha_{\\mathrm{R}} b$。\n选择标量 $\\alpha_{\\mathrm{R}}$ 以最小化新残差的范数，对于右预处理，这就是真实残差：$\\|\\hat{r}_{1,\\mathrm{R}}\\|_2 = \\|b - \\hat{A}y_1\\|_2$。\n$$\\min_{\\alpha_{\\mathrm{R}}} \\|b - \\alpha_{\\mathrm{R}} \\hat{A}b\\|_2$$\n解为：\n$$\\alpha_{\\mathrm{R}} = \\frac{\\langle \\hat{A}b, b \\rangle}{\\|\\hat{A}b\\|_2^2}$$\n我们计算各项：\n$$\\hat{A} = AM^{-1} = \\begin{pmatrix} 4  1  0 \\\\ 2  3  1 \\\\ 0  -1  2 \\end{pmatrix} \\begin{pmatrix} 1  0  0 \\\\ 0  \\frac{1}{2}  0 \\\\ 0  0  \\frac{1}{3} \\end{pmatrix} = \\begin{pmatrix} 4  \\frac{1}{2}  0 \\\\ 2  \\frac{3}{2}  \\frac{1}{3} \\\\ 0  -\\frac{1}{2}  \\frac{2}{3} \\end{pmatrix}$$\n$$\\hat{A}b = \\begin{pmatrix} 4  \\frac{1}{2}  0 \\\\ 2  \\frac{3}{2}  \\frac{1}{3} \\\\ 0  -\\frac{1}{2}  \\frac{2}{3} \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\end{pmatrix} = \\begin{pmatrix} 4(1) + \\frac{1}{2}(2) \\\\ 2(1) + \\frac{3}{2}(2) + \\frac{1}{3}(3) \\\\ -\\frac{1}{2}(2) + \\frac{2}{3}(3) \\end{pmatrix} = \\begin{pmatrix} 5 \\\\ 6 \\\\ 1 \\end{pmatrix}$$\n现在我们求解 $\\alpha_{\\mathrm{R}}$：\n$$\\langle \\hat{A}b, b \\rangle = \\begin{pmatrix} 5 \\\\ 6 \\\\ 1 \\end{pmatrix} \\cdot \\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\end{pmatrix} = 5 + 12 + 3 = 20$$\n$$\\|\\hat{A}b\\|_2^2 = 5^2 + 6^2 + 1^2 = 25 + 36 + 1 = 62$$\n$$\\alpha_{\\mathrm{R}} = \\frac{20}{62} = \\frac{10}{31}$$\n更新后的变量为 $y_1 = \\alpha_{\\mathrm{R}} b = \\frac{10}{31}b$。解 $x$ 为：\n$$x_{1,\\mathrm{R}} = x_0 + M^{-1}y_1 = M^{-1} \\left(\\frac{10}{31} b\\right) = \\frac{10}{31} M^{-1}b = \\frac{10}{31} \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix}$$\n真实残差为 $r_{1,\\mathrm{R}} = b - A x_{1,\\mathrm{R}}$：\n$$r_{1,\\mathrm{R}} = b - A \\left(\\frac{10}{31} \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix}\\right) = b - \\frac{10}{31} \\begin{pmatrix} 5 \\\\ 6 \\\\ 1 \\end{pmatrix} = \\frac{1}{31} \\left( \\begin{pmatrix} 31 \\\\ 62 \\\\ 93 \\end{pmatrix} - \\begin{pmatrix} 50 \\\\ 60 \\\\ 10 \\end{pmatrix} \\right) = \\frac{1}{31} \\begin{pmatrix} -19 \\\\ 2 \\\\ 83 \\end{pmatrix}$$\n该残差的范数平方为：\n$$\\|r_{1,\\mathrm{R}}\\|_2^2 = \\frac{1}{31^2} \\left( (-19)^2 + 2^2 + 83^2 \\right) = \\frac{361 + 4 + 6889}{31^2} = \\frac{7254}{31^2}$$\n由于 $7254 = 234 \\times 31$，我们有：\n$$\\|r_{1,\\mathrm{R}}\\|_2^2 = \\frac{234 \\times 31}{31^2} = \\frac{234}{31}$$\n\n#### 范数之比\n我们需要计算比值 $\\|r_{1,\\mathrm{L}}\\|_2 / \\|r_{1,\\mathrm{R}}\\|_2$。我们先计算平方的比值：\n$$\\frac{\\|r_{1,\\mathrm{L}}\\|_2^2}{\\|r_{1,\\mathrm{R}}\\|_2^2} = \\frac{747236 / 307^2}{234 / 31} = \\frac{747236 \\cdot 31}{234 \\cdot 307^2}$$\n通过认识到两个残差都具有 $b - c(AM^{-1}b)$ 的形式（对于不同的标量 $c$），可以简化计算。令 $v = AM^{-1}b = (5,6,1)^T$。\n$x_{1,\\mathrm{L}} = \\alpha_{\\mathrm{L}} \\tilde{r}_0 = \\frac{75}{307}M^{-1}b$，所以 $r_{1,\\mathrm{L}} = b - \\frac{75}{307}AM^{-1}b = b - \\frac{75}{307}v$。\n$x_{1,\\mathrm{R}} = \\frac{10}{31}M^{-1}b$，所以 $r_{1,\\mathrm{R}} = b - \\frac{10}{31}AM^{-1}b = b - \\frac{10}{31}v$。\n范数平方 $\\|b - \\alpha v\\|_2^2$ 是关于 $\\alpha$ 的二次函数：$\\|b\\|^2 - 2\\alpha \\langle b,v \\rangle + \\alpha^2 \\|v\\|^2$。\n最小值在 $\\alpha^* = \\langle b,v \\rangle / \\|v\\|^2 = 20/62 = 10/31$ 处取得。这恰好是右预处理情况下的系数。\n因此，$\\|b-\\alpha v\\|_2^2 = \\|b-\\alpha^* v\\|_2^2 + (\\alpha-\\alpha^*)^2\\|v\\|_2^2 = \\|r_{1,\\mathrm{R}}\\|_2^2 + (\\alpha-\\alpha^*)^2\\|v\\|_2^2$。\n对于左预处理情况，$\\alpha = \\alpha_{\\mathrm{L}} = 75/307$，所以：\n$$\\|r_{1,\\mathrm{L}}\\|_2^2 = \\|r_{1,\\mathrm{R}}\\|_2^2 + (\\alpha_{\\mathrm{L}} - \\alpha_{\\mathrm{R}})^2 \\|v\\|_2^2$$\n平方比为：\n$$\\frac{\\|r_{1,\\mathrm{L}}\\|_2^2}{\\|r_{1,\\mathrm{R}}\\|_2^2} = 1 + \\frac{(\\alpha_{\\mathrm{L}} - \\alpha_{\\mathrm{R}})^2 \\|v\\|_2^2}{\\|r_{1,\\mathrm{R}}\\|_2^2}$$\n我们计算各项：\n$$\\alpha_{\\mathrm{L}} - \\alpha_{\\mathrm{R}} = \\frac{75}{307} - \\frac{10}{31} = \\frac{75 \\cdot 31 - 10 \\cdot 307}{307 \\cdot 31} = \\frac{2325 - 3070}{9517} = -\\frac{745}{9517}$$\n$\\|v\\|_2^2 = 62$。 $\\|r_{1,\\mathrm{R}}\\|_2^2 = 234/31$。\n$$\\frac{(\\alpha_{\\mathrm{L}} - \\alpha_{\\mathrm{R}})^2 \\|v\\|_2^2}{\\|r_{1,\\mathrm{R}}\\|_2^2} = \\frac{(-745/9517)^2 \\cdot 62}{234/31} = \\frac{745^2}{(307 \\cdot 31)^2} \\frac{62 \\cdot 31}{234} = \\frac{745^2 \\cdot (2 \\cdot 31) \\cdot 31}{307^2 \\cdot 31^2 \\cdot 234} = \\frac{2 \\cdot 745^2}{234 \\cdot 307^2} = \\frac{745^2}{117 \\cdot 307^2}$$\n因此，平方比的简化表达式为：\n$$\\frac{\\|r_{1,\\mathrm{L}}\\|_2^2}{\\|r_{1,\\mathrm{R}}\\|_2^2} = 1 + \\frac{745^2}{117 \\cdot 307^2} = \\frac{117 \\cdot 307^2 + 745^2}{117 \\cdot 307^2}$$\n我们计算整数值：\n$745^2 = 555025$。\n$307^2 = 94249$。\n$117 \\cdot 94249 = 11027133$。\n$$\\frac{\\|r_{1,\\mathrm{L}}\\|_2^2}{\\|r_{1,\\mathrm{R}}\\|_2^2} = \\frac{11027133 + 555025}{11027133} = \\frac{11582158}{11027133}$$\n所求的比值是该值的平方根。\n$$\\frac{\\|r_{1,\\mathrm{L}}\\|_2}{\\|r_{1,\\mathrm{R}}\\|_2} = \\sqrt{\\frac{11582158}{11027133}}$$\n此分数为最简分数。",
            "answer": "$$\\boxed{\\sqrt{\\frac{11582158}{11027133}}}$$"
        },
        {
            "introduction": "一个优秀预处理器的核心价值在于改善原始矩阵的谱特性，从而加速迭代求解器的收敛。本练习旨在量化这种改善效果。你将学习如何利用预处理后系统的谱信息（特别是最小和最大特征值），来预测预处理共轭梯度法（PCG）达到指定精度所需的迭代次数。掌握这个经典的收敛性分析方法，是评估和比较不同预处理器性能的关键理论工具。",
            "id": "3352792",
            "problem": "考虑计算流体动力学中一个椭圆算子的对称强制离散化所产生的线性系统 $A x = b$，其中 $A \\in \\mathbb{R}^{n \\times n}$ 是对称正定 (SPD) 矩阵。设 $M \\in \\mathbb{R}^{n \\times n}$ 是一个 SPD 预条件子。从任意初始猜测 $x_{0}$ 开始，预条件共轭梯度 (PCG) 方法在精确算术下应用于预条件系统 $M^{-1} A x = M^{-1} b$。将 $A$-范数误差定义为 $\\|e_{k}\\|_{A} = \\sqrt{e_{k}^{\\top} A e_{k}}$，其中 $e_{k} = x_{\\star} - x_{k}$ 且 $x_{\\star}$ 是精确解。假设预条件算子 $M^{-1} A$ 的谱包含在区间 $\\left[\\lambda_{\\min}, \\lambda_{\\max}\\right]$ 内，其已知界为 $\\lambda_{\\min} = 0.5$ 和 $\\lambda_{\\max} = 20$。仅使用对称正定算子的基本性质和共轭梯度 (CG) 方法在能量范数下的最优性，确定最小的 PCG 迭代次数整数 $k$，以保证对于任意初始猜测 $x_{0}$，相对 $A$-范数误差满足\n$$\n\\frac{\\|e_{k}\\|_{A}}{\\|e_{0}\\|_{A}} \\leq 10^{-8}.\n$$\n请以迭代次数的整数形式给出最终答案。无需进行四舍五入，因为答案必须是满足要求的最小整数。",
            "solution": "问题背景是一个带 SPD 预条件子 $M$ 的 SPD 线性系统 $A x = b$。预条件共轭梯度 (PCG) 方法将共轭梯度 (CG) 算法应用于算子 $C = M^{-1} A$，该算子关于 $M$-内积 $\\langle u, v \\rangle_{M} = u^{\\top} M v$ 是对称正定的。在 $A$-范数下度量的误差 $\\|e\\|_{A} = \\sqrt{e^{\\top} A e}$ 是由 $A$ 诱导的自然能量范数，在 CG 和 PCG 的分析中是标准方法。\n\nCG 方法用于 SPD 算子的一个基本性质是其在多项式空间上关于能量范数的最优性：经过 $k$ 次迭代后，误差满足\n$$\ne_{k} = p_{k}(C) e_{0},\n$$\n其中 $p_{k}$ 是一个次数至多为 $k$ 且满足 $p_{k}(0) = 1$ 的多项式。因此，误差的 $A$-范数有如下界：\n$$\n\\frac{\\|e_{k}\\|_{A}}{\\|e_{0}\\|_{A}} \\leq \\min_{p \\in \\mathcal{P}_{k},\\, p(0)=1} \\max_{\\lambda \\in \\sigma(C)} |p(\\lambda)|,\n$$\n其中 $\\mathcal{P}_{k}$ 表示次数至多为 $k$ 的实多项式集合，$\\sigma(C)$ 是 $C$ 的谱。当谱已知位于区间 $\\left[\\lambda_{\\min}, \\lambda_{\\max}\\right]$ 内时，一个经典的极值（极小化极大）选择是使用缩放的第一类 Chebyshev 多项式。定义仿射映射\n$$\n\\theta(\\lambda) = \\frac{2 \\lambda - (\\lambda_{\\max} + \\lambda_{\\min})}{\\lambda_{\\max} - \\lambda_{\\min}},\n$$\n它将 $\\left[\\lambda_{\\min}, \\lambda_{\\max}\\right]$ 映射到 $\\left[-1, 1\\right]$。第一类 Chebyshev 多项式 $T_{k}(x)$ 满足：对于 $x \\in \\left[-1,1\\right]$ 有 $|T_{k}(x)| \\leq 1$，对于 $x \\geq 1$ 有 $T_{k}(x) = \\cosh\\!\\big(k\\, \\operatorname{arcosh}(x)\\big)$。在约束 $p(0)=1$ 下，（在极小化极大意义下）最优的多项式由下式给出：\n$$\np_{k}(\\lambda) = \\frac{T_{k}\\!\\big(\\theta(\\lambda)\\big)}{T_{k}\\!\\big(\\theta(0)\\big)}.\n$$\n因此，\n$$\n\\max_{\\lambda \\in [\\lambda_{\\min}, \\lambda_{\\max}]} |p_{k}(\\lambda)| \\leq \\frac{1}{\\left|T_{k}\\!\\big(\\theta(0)\\big)\\right|}.\n$$\n由于 $\\theta(0) = -\\dfrac{\\lambda_{\\max} + \\lambda_{\\min}}{\\lambda_{\\max} - \\lambda_{\\min}}  -1$，且 $|T_{k}(-x)| = |T_{k}(x)|$，我们在 $\\zeta = \\dfrac{\\lambda_{\\max} + \\lambda_{\\min}}{\\lambda_{\\max} - \\lambda_{\\min}}  1$ 处求值：\n$$\n\\left|T_{k}\\!\\big(\\theta(0)\\big)\\right| = T_{k}(\\zeta) = \\cosh\\!\\big(k\\, \\operatorname{arcosh}(\\zeta)\\big).\n$$\n使用恒等式\n$$\n\\zeta = \\frac{\\lambda_{\\max} + \\lambda_{\\min}}{\\lambda_{\\max} - \\lambda_{\\min}} = \\frac{\\kappa + 1}{\\kappa - 1},\n$$\n和标准的 Chebyshev 界，可以得到一个经过充分检验的、用条件数\n$$\n\\kappa = \\frac{\\lambda_{\\max}}{\\lambda_{\\min}},\n$$\n表示的 PCG 方法 $A$-范数收敛性估计，即\n$$\n\\frac{\\|e_{k}\\|_{A}}{\\|e_{0}\\|_{A}} \\leq 2 \\left(\\frac{\\sqrt{\\kappa} - 1}{\\sqrt{\\kappa} + 1}\\right)^{k}.\n$$\n这里，$\\kappa$ 是预条件算子 $M^{-1} A$ 的谱条件数。\n\n根据给定的数据，我们有\n$$\n\\lambda_{\\min} = 0.5,\\quad \\lambda_{\\max} = 20,\\quad \\kappa = \\frac{\\lambda_{\\max}}{\\lambda_{\\min}} = \\frac{20}{0.5} = 40,\n$$\n因此\n$$\n\\rho \\equiv \\frac{\\sqrt{\\kappa} - 1}{\\sqrt{\\kappa} + 1} = \\frac{\\sqrt{40} - 1}{\\sqrt{40} + 1}.\n$$\n为了保证对任意初始猜测都有\n$$\n\\frac{\\|e_{k}\\|_{A}}{\\|e_{0}\\|_{A}} \\leq 10^{-8}\n$$\n只需强制满足\n$$\n2\\, \\rho^{k} \\leq 10^{-8} \\quad \\Longleftrightarrow \\quad \\rho^{k} \\leq 5 \\times 10^{-9}.\n$$\n两边取自然对数，并注意到 $\\ln(\\rho)  0$，我们得到\n$$\nk \\geq \\frac{\\ln\\!\\big(5 \\times 10^{-9}\\big)}{\\ln(\\rho)}.\n$$\n计算这些量：\n$$\n\\sqrt{\\kappa} = \\sqrt{40} \\approx 6.324555320336759,\\quad\n\\rho = \\frac{6.324555320336759 - 1}{6.324555320336759 + 1} \\approx 0.726945,\n$$\n于是\n$$\n\\ln(\\rho) \\approx -0.318900,\\quad \\ln\\!\\big(5 \\times 10^{-9}\\big) = \\ln(5) - 9 \\ln(10) \\approx -19.113827.\n$$\n因此，\n$$\nk \\geq \\frac{-19.113827}{-0.318900} \\approx 59.90.\n$$\n满足此不等式的最小整数是\n$$\nk = 60.\n$$\n因此，在给定的谱界下，$60$ 次 PCG 迭代足以保证对于任何初始猜测，相对 $A$-范数误差至多为 $10^{-8}$。",
            "answer": "$$\\boxed{60}$$"
        },
        {
            "introduction": "在实际的高性能计算应用中，选择最佳预处理器不仅仅是理论问题，更是一个性能工程上的权衡。一个更强大的预处理器（如不完全LU分解）通常能显著减少迭代次数，但其自身的计算和通信开销也更大。这个练习将指导你建立一个简洁的性能模型，用于分析和决策。通过计算“盈亏平衡点”，你将学会如何在预处理器的强度（带来的收敛加速）和其计算成本之间做出明智的选择。",
            "id": "3352774",
            "problem": "考虑一个由不可压缩纳维-斯托克斯方程的有限体积离散化产生的线性系统，具体来说是其对称正定的压力泊松子问题。该系统在一台分布式内存计算机上使用预条件共轭梯度（PCG）方法求解。每次迭代的运行时间主要由浮点计算和节点间通信主导。预条件子会同时改变每次迭代的成本和达到固定残差容差所需的迭代次数。\n\n有两种预条件子可供选择：\n\n- 一种轻量级的块雅可比预条件子，记为 $P_{\\mathrm{J}}$，测得其每次迭代的计算时间为 $t_{\\mathrm{comp,J}} = 5.5 \\times 10^{-3}$，通信时间为 $t_{\\mathrm{comm,J}} = 3.1 \\times 10^{-3}$。在此配置下，观测到收敛所需的迭代次数为 $n_{\\mathrm{J}} = 750$。\n\n- 一种更强的带1阶填充的重叠不完全LU分解预条件子，记为 $P_{\\mathrm{ILU1}}$，测得其每次迭代的计算时间为 $t_{\\mathrm{comp,ILU1}} = 8.0 \\times 10^{-3}$，通信时间为 $t_{\\mathrm{comm,ILU1}} = 5.0 \\times 10^{-3}$。当使用 $P_{\\mathrm{ILU1}}$ 时，观测到达到相同容差的迭代次数相对于 $P_{\\mathrm{J}}$ 减少了一个因子 $\\alpha$，因此 $n_{\\mathrm{ILU1}} = \\alpha \\, n_{\\mathrm{J}}$，其中 $0  \\alpha  1$。\n\n假设预条件子的设置成本相对于累积的迭代运行时间可以忽略不计，并且每种选择的总求解时间可以建模为迭代次数与每次迭代时间（计算和通信部分之和）的乘积。从这些定义出发，推导临界缩减因子 $\\alpha_{\\star}$ 的通用表达式，使得使用 $P_{\\mathrm{ILU1}}$ 的总运行时间等于使用 $P_{\\mathrm{J}}$ 的总运行时间。然后，使用上面测得的量，对 $\\alpha_{\\star}$ 进行数值计算。\n\n将最终的阈值缩减因子 $\\alpha_{\\star}$ 表示为一个无量纲量。将您的数值结果四舍五入到四位有效数字。",
            "solution": "该问题已经过验证，被认为是科学上合理的、适定的和客观的。它展示了计算科学中一个标准的性能建模场景。所有必要的数据和简化假设都已提供，不存在矛盾或歧义。\n\n目标是找到临界迭代缩减因子 $\\alpha_{\\star}$，在该因子下，两种不同预条件子的总求解时间相同。设 $T_{\\mathrm{J}}$ 和 $T_{\\mathrm{ILU1}}$ 分别表示块雅可比（$P_{\\mathrm{J}}$）预条件子和不完全LU分解（$P_{\\mathrm{ILU1}}$）预条件子的总求解时间。\n\n根据问题陈述，总求解时间被建模为迭代次数和每次迭代时间的乘积。每次迭代的时间是计算和通信部分之和。\n\n对于块雅可比预条件子，总时间为：\n$$T_{\\mathrm{J}} = n_{\\mathrm{J}} (t_{\\mathrm{comp,J}} + t_{\\mathrm{comm,J}})$$\n其中，$n_{\\mathrm{J}}$ 是迭代次数，$t_{\\mathrm{comp,J}}$ 是每次迭代的计算时间，$t_{\\mathrm{comm,J}}$ 是每次迭代的通信时间。\n\n对于ILU(1)预条件子，总时间为：\n$$T_{\\mathrm{ILU1}} = n_{\\mathrm{ILU1}} (t_{\\mathrm{comp,ILU1}} + t_{\\mathrm{comm,ILU1}})$$\nILU(1)方法的迭代次数 $n_{\\mathrm{ILU1}}$ 通过一个缩减因子 $\\alpha$ 与雅可比方法的迭代次数相关：\n$$n_{\\mathrm{ILU1}} = \\alpha \\, n_{\\mathrm{J}}$$\n\n当总时间相等，即 $T_{\\mathrm{ILU1}} = T_{\\mathrm{J}}$ 时，达到临界条件。我们寻求满足此等式的 $\\alpha$ 的特定值，记为 $\\alpha_{\\star}$。\n$$n_{\\mathrm{ILU1}} (t_{\\mathrm{comp,ILU1}} + t_{\\mathrm{comm,ILU1}}) = n_{\\mathrm{J}} (t_{\\mathrm{comp,J}} + t_{\\mathrm{comm,J}})$$\n用 $\\alpha = \\alpha_{\\star}$ 代入 $n_{\\mathrm{ILU1}}$ 的表达式：\n$$(\\alpha_{\\star} \\, n_{\\mathrm{J}}) (t_{\\mathrm{comp,ILU1}} + t_{\\mathrm{comm,ILU1}}) = n_{\\mathrm{J}} (t_{\\mathrm{comp,J}} + t_{\\mathrm{comm,J}})$$\n雅可比方法的迭代次数 $n_{\\mathrm{J}}$ 给定为 $750$，非零。因此，我们可以将等式两边同时除以 $n_{\\mathrm{J}}$：\n$$\\alpha_{\\star} (t_{\\mathrm{comp,ILU1}} + t_{\\mathrm{comm,ILU1}}) = t_{\\mathrm{comp,J}} + t_{\\mathrm{comm,J}}$$\n解出 $\\alpha_{\\star}$，得到临界缩减因子的通用符号表达式：\n$$\\alpha_{\\star} = \\frac{t_{\\mathrm{comp,J}} + t_{\\mathrm{comm,J}}}{t_{\\mathrm{comp,ILU1}} + t_{\\mathrm{comm,ILU1}}}$$\n该表达式是较廉价的预条件子（$P_{\\mathrm{J}}$）每次迭代的总时间与较昂贵的预条件子（$P_{\\mathrm{ILU1}}$）每次迭代的总时间的比值。\n\n现在，我们使用所提供的数据对该表达式进行数值计算：\n- $t_{\\mathrm{comp,J}} = 5.5 \\times 10^{-3}$\n- $t_{\\mathrm{comm,J}} = 3.1 \\times 10^{-3}$\n- $t_{\\mathrm{comp,ILU1}} = 8.0 \\times 10^{-3}$\n- $t_{\\mathrm{comm,ILU1}} = 5.0 \\times 10^{-3}$\n\n首先，计算每种方法的每次迭代总时间。\n对于 $P_{\\mathrm{J}}$：\n$$t_{\\mathrm{comp,J}} + t_{\\mathrm{comm,J}} = 5.5 \\times 10^{-3} + 3.1 \\times 10^{-3} = 8.6 \\times 10^{-3}$$\n对于 $P_{\\mathrm{ILU1}}$：\n$$t_{\\mathrm{comp,ILU1}} + t_{\\mathrm{comm,ILU1}} = 8.0 \\times 10^{-3} + 5.0 \\times 10^{-3} = 13.0 \\times 10^{-3}$$\n\n将这些值代入 $\\alpha_{\\star}$ 的表达式中：\n$$\\alpha_{\\star} = \\frac{8.6 \\times 10^{-3}}{13.0 \\times 10^{-3}}$$\n分子和分母中的因子 $10^{-3}$ 相互抵消，剩下：\n$$\\alpha_{\\star} = \\frac{8.6}{13.0} \\approx 0.66153846...$$\n问题要求将结果保留四位有效数字。检查第五位有效数字为 $3$，因此舍去。\n$$\\alpha_{\\star} \\approx 0.6615$$\n这个无量纲因子就是阈值。如果更强的预条件子将迭代次数的缩减因子减小到小于 $0.6615$，那么它将是性能更好的选择。",
            "answer": "$$\\boxed{0.6615}$$"
        }
    ]
}