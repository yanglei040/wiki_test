{
    "hands_on_practices": [
        {
            "introduction": "高斯消元法是求解线性系统的基石。要真正掌握 LU 分解过程，首先必须能够手动执行其核心的正向消元步骤。 这个练习提供了一个源自典型对流-扩散问题的具体 $3 \\times 3$ 矩阵，让您能够一步一步地练习基本的行变换和乘数的计算。",
            "id": "3322964",
            "problem": "一个具有三个内部节点的均匀网格上的一维稳态对流-扩散边值问题，使用中心差分格式离散扩散项，使用一阶迎风格式离散对流项，从而得到一个关于内部未知向量 $\\boldsymbol{T} \\in \\mathbb{R}^{3}$ 的非对称三对角线性系统。所得系统的形式为 $A \\boldsymbol{T} = \\boldsymbol{b}$，其中\n$$\nA \\;=\\; \\begin{pmatrix}\n5  -1  0 \\\\\n-4  5  -1 \\\\\n0  -4  5\n\\end{pmatrix}, \n\\qquad\n\\boldsymbol{b} \\;=\\; \\begin{pmatrix}\n1 \\\\ 0 \\\\ 2\n\\end{pmatrix}.\n$$\n在计算流体力学（CFD）的背景下，高斯消去法的前向消元阶段通过应用初等行变换，以列主序消去次对角线元素，从而将矩阵 $A$ 转换为一个上三角矩阵 $U$。前向消元中使用的行变换可以由乘子 $m_{21}$、$m_{31}$ 和 $m_{32}$ 参数化，其中每个乘子 $m_{ij}$ 用于缩放第 $j$ 步的主元行，以消去位置 $(i,j)$ 处的元素。\n\n从线性系统的核心定义以及初等行变换保持解集不变的规则出发，进行无主元选择的前向消元，将矩阵 $A$ 转换为上三角矩阵 $U$，并获得经过相同行变换序列变换后的右端项 $\\widehat{\\boldsymbol{b}}$。明确指出乘子 $m_{21}$、$m_{31}$ 和 $m_{32}$，并报告最终的 $U$ 和 $\\widehat{\\boldsymbol{b}}$。\n\n最后，给出第二阶段乘子 $m_{32}$ 的精确值作为你的答案。以精确的有理数形式表示你的最终答案。不需要四舍五入，也不涉及单位。",
            "solution": "首先对问题陈述进行严格的验证过程。\n\n### 第1步：提取已知条件\n- 线性系统的形式为 $A \\boldsymbol{T} = \\boldsymbol{b}$。\n- 系数矩阵 $A$ 由下式给出：\n$$\nA \\;=\\; \\begin{pmatrix}\n5  -1  0 \\\\\n-4  5  -1 \\\\\n0  -4  5\n\\end{pmatrix}\n$$\n- 右端向量 $\\boldsymbol{b}$ 由下式给出：\n$$\n\\boldsymbol{b} \\;=\\; \\begin{pmatrix}\n1 \\\\ 0 \\\\ 2\n\\end{pmatrix}\n$$\n- 任务是对系统 $A \\boldsymbol{T} = \\boldsymbol{b}$ 进行无主元选择的前向消元，以获得一个上三角系统 $U \\boldsymbol{T} = \\widehat{\\boldsymbol{b}}$。\n- 该过程涉及确定乘子 $m_{21}$、$m_{31}$ 和 $m_{32}$，其中 $m_{ij}$ 用于通过缩放主元行 $j$ 来消去位置 $(i,j)$ 处的元素。\n- 最终要求回答的是乘子 $m_{32}$ 的精确值。\n\n### 第2步：使用提取的已知条件进行验证\n根据指定标准对问题进行评估：\n- **科学依据：** 该问题是数值线性代数中的一个标准练习，特别是高斯消去法的应用。这是科学计算（包括计算流体力学CFD）中的一个基本算法。所提供的关于系统物理来源（对流-扩散方程）的背景是恰当且现实的。该问题在数学上和科学上都是合理的。\n- **适定性：** 该问题是适定的。矩阵 $A$ 是非奇异的（其行列式为 $5(25 - 4) - (-1)(-20) = 5(21) - 20 = 85 \\neq 0$），保证了线性系统有唯一解。执行无主元选择的前向消元的指令构成了一个定义明确、无歧义的算法。\n- **客观性：** 该问题以精确、客观的数学语言陈述。\n- **完整性与一致性：** 所有必要的信息（矩阵 $A$、向量 $\\boldsymbol{b}$ 和解题步骤）都已提供。没有矛盾之处。\n- **不存在其他缺陷。** 该问题既不不切实际、不适定、微不足道，也非无法验证。\n\n### 第3步：结论与行动\n该问题是 **有效的**。将提供完整的解答。\n\n目标是使用前向消元法将线性系统 $A \\boldsymbol{T} = \\boldsymbol{b}$ 转换为等价的上三角系统 $U \\boldsymbol{T} = \\widehat{\\boldsymbol{b}}$。这是通过对增广矩阵 $[A | \\boldsymbol{b}]$ 应用初等行变换来实现的。\n\n初始增广矩阵为：\n$$\n[A | \\boldsymbol{b}]^{(0)} = \\left[\n\\begin{array}{ccc|c}\n5  -1  0  1 \\\\\n-4  5  -1  0 \\\\\n0  -4  5  2\n\\end{array}\n\\right]\n$$\n\n**第1步：对第 $j=1$ 列进行消元**\n\n目标是消去第一列的次对角线元素。主元是 $a_{11} = 5$。\n\n为消去元素 $a_{21} = -4$，我们定义乘子 $m_{21} = \\frac{a_{21}}{a_{11}}$。\n$$\nm_{21} = \\frac{-4}{5}\n$$\n相应的行变换是 $R_2 \\leftarrow R_2 - m_{21} R_1$，即 $R_2 \\leftarrow R_2 + \\frac{4}{5} R_1$。\n将此变换应用于增广矩阵的第二行：\n- 位置 $(2,1)$ 的新元素：$-4 + \\frac{4}{5}(5) = -4 + 4 = 0$。\n- 位置 $(2,2)$ 的新元素：$5 + \\frac{4}{5}(-1) = 5 - \\frac{4}{5} = \\frac{25-4}{5} = \\frac{21}{5}$。\n- 位置 $(2,3)$ 的新元素：$-1 + \\frac{4}{5}(0) = -1$。\n- 右端向量中的新元素：$0 + \\frac{4}{5}(1) = \\frac{4}{5}$。\n\n元素 $a_{31}$ 已经为 $0$。因此，不需要行变换来消去它。相应的乘子是：\n$$\nm_{31} = \\frac{a_{31}}{a_{11}} = \\frac{0}{5} = 0\n$$\n\n经过第一步消元后，增广矩阵变为：\n$$\n[A | \\boldsymbol{b}]^{(1)} = \\left[\n\\begin{array}{ccc|c}\n5  -1  0  1 \\\\\n0  \\frac{21}{5}  -1  \\frac{4}{5} \\\\\n0  -4  5  2\n\\end{array}\n\\right]\n$$\n\n**第2步：对第 $j=2$ 列进行消元**\n\n目标是消去第二列的次对角线元素。主元是位置 $(2,2)$ 上的新元素 $a'_{22} = \\frac{21}{5}$。\n\n为消去元素 $a'_{32} = -4$，我们定义乘子 $m_{32} = \\frac{a'_{32}}{a'_{22}}$。\n$$\nm_{32} = \\frac{-4}{\\frac{21}{5}} = -4 \\cdot \\frac{5}{21} = -\\frac{20}{21}\n$$\n相应的行变换是 $R_3 \\leftarrow R_3 - m_{32} R_2$，即 $R_3 \\leftarrow R_3 + \\frac{20}{21} R_2$。\n将此变换应用于矩阵 $[A | \\boldsymbol{b}]^{(1)}$ 的第三行：\n- 位置 $(3,1)$ 的新元素：$0 + \\frac{20}{21}(0) = 0$。\n- 位置 $(3,2)$ 的新元素：$-4 + \\frac{20}{21}\\left(\\frac{21}{5}\\right) = -4 + \\frac{20}{5} = -4 + 4 = 0$。\n- 位置 $(3,3)$ 的新元素：$5 + \\frac{20}{21}(-1) = 5 - \\frac{20}{21} = \\frac{105-20}{21} = \\frac{85}{21}$。\n- 右端向量中的新元素：$2 + \\frac{20}{21}\\left(\\frac{4}{5}\\right) = 2 + \\frac{80}{105} = 2 + \\frac{16}{21} = \\frac{42+16}{21} = \\frac{58}{21}$。\n\n前向消元过程现已完成。最终的增广矩阵 $[U | \\widehat{\\boldsymbol{b}}]$ 为：\n$$\n[U | \\widehat{\\boldsymbol{b}}] = \\left[\n\\begin{array}{ccc|c}\n5  -1  0  1 \\\\\n0  \\frac{21}{5}  -1  \\frac{4}{5} \\\\\n0  0  \\frac{85}{21}  \\frac{58}{21}\n\\end{array}\n\\right]\n$$\n\n得到的上三角矩阵 $U$ 和变换后的右端向量 $\\widehat{\\boldsymbol{b}}$ 分别是：\n$$\nU = \\begin{pmatrix}\n5  -1  0 \\\\\n0  \\frac{21}{5}  -1 \\\\\n0  0  \\frac{85}{21}\n\\end{pmatrix}, \\qquad\n\\widehat{\\boldsymbol{b}} = \\begin{pmatrix}\n1 \\\\\n\\frac{4}{5} \\\\\n\\frac{58}{21}\n\\end{pmatrix}\n$$\n\n在此过程中确定的乘子是：\n- $m_{21} = -\\frac{4}{5}$\n- $m_{31} = 0$\n- $m_{32} = -\\frac{20}{21}$\n\n题目要求给出第二阶段乘子 $m_{32}$ 的精确值。\n该值为 $-\\frac{20}{21}$。",
            "answer": "$$\n\\boxed{-\\frac{20}{21}}\n$$"
        },
        {
            "introduction": "高斯消元不仅是一种计算方法，更是一种强大的分析工具。计算流体力学中的许多物理问题，例如带有纯诺伊曼边界条件的压力泊松方程，会导致奇异线性系统。 这个练习将向您展示 LU 分解的数值过程如何揭示这些基本的数学特性。通过对一个轻微扰动后的奇异矩阵进行符号消元，您将观察到矩阵的秩亏损如何表现为一个趋近于零的主元，从而为一个抽象的数学概念提供了具体的数值信号。",
            "id": "3322974",
            "problem": "考虑一个代表不可压缩计算流体动力学（CFD）中压力泊松方程的稳态一维扩散算子，该算子为区间 $[0,1]$ 上的二阶导数算子 $\\partial_{xx}$，且两端均为齐次诺伊曼边界条件。在 $n$ 个均匀间隔的网格点上采用标准中心二阶有限差分格式，可以保持纯诺伊曼边界条件下连续算子的常数零空间。对于 $n=4$ 个网格点（包括边界点），为使代数表达清晰，省略公因子 $1/h^{2}$ 后，得到的按比例缩放的离散算子为以下 $4 \\times 4$ 矩阵\n$$\nA \\;=\\;\n\\begin{pmatrix}\n1  -1  0  0 \\\\\n-1  2  -1  0 \\\\\n0  -1  2  -1 \\\\\n0  0  -1  1\n\\end{pmatrix}.\n$$\n该矩阵模拟了一个纯诺伊曼问题，是奇异的，其一维零空间由常数向量张成。为了模拟 CFD 中弱固定压力（或势）以正则化奇异算子，同时最小化对物理过程的扰动的常见做法，我们考虑以下扰动矩阵\n$$\nA_{\\varepsilon} \\;=\\; A \\;+\\; \\varepsilon \\, e_{1} e_{1}^{\\top},\n$$\n其中 $\\varepsilon>0$ 是一个小数，而 $e_{1}$ 是第一个标准基向量。对 $A_{\\varepsilon}$ 执行带部分主元的高斯消去法，并在每一步中根据第一性原理（即，通过比较当前主元列中各项的大小）来证明主元选择的合理性。符号推导出最终主元（记为 $u_{44}(\\varepsilon)$，即通过带部分主元的高斯消去法得到的上三角因子中的 $(4,4)$ 对角线元素）作为 $\\varepsilon$ 函数的精确表达式。\n\n你的最终答案必须是 $u_{44}(\\varepsilon)$ 的单一简化闭式表达式。无需进行数值四舍五入，也无需单位。解释为什么当 $\\varepsilon \\to 0^{+}$ 时，$u_{44}(\\varepsilon)$ 的极限行为反映了 $A$ 的秩亏。",
            "solution": "问题陈述经核实具有科学依据、提法恰当、客观且完整。执行指定的代数过程和分析结果所需的所有信息都已提供。所提供的背景，即将该矩阵与计算流体动力学中的微分算子的有限差分格式相关联，在物理上和数学上都是合理的。矩阵 $A$ 具有所述的性质，即是奇异的，且其一维零空间由一个常数向量张成。所用的正则化技术是一种标准做法。因此，我将开始求解。\n\n问题要求对扰动矩阵 $A_{\\varepsilon}$ 执行带部分主元的高斯消去法，并求出最终主元 $u_{44}(\\varepsilon)$。矩阵 $A$ 由下式给出\n$$\nA \\;=\\;\n\\begin{pmatrix}\n1  -1  0  0 \\\\\n-1  2  -1  0 \\\\\n0  -1  2  -1 \\\\\n0  0  -1  1\n\\end{pmatrix}.\n$$\n扰动定义为 $A_{\\varepsilon} = A + \\varepsilon \\, e_{1} e_{1}^{\\top}$，其中 $\\varepsilon>0$ 是一个小参数，$e_{1} = (1, 0, 0, 0)^{\\top}$ 是第一个标准基向量。扰动项为\n$$\n\\varepsilon \\, e_{1} e_{1}^{\\top} \\;=\\; \\varepsilon \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} \\begin{pmatrix} 1  0  0  0 \\end{pmatrix} \\;=\\; \\begin{pmatrix} \\varepsilon  0  0  0 \\\\ 0  0  0  0 \\\\ 0  0  0  0 \\\\ 0  0  0  0 \\end{pmatrix}.\n$$\n因此，矩阵 $A_{\\varepsilon}$ 为\n$$\nA_{\\varepsilon} \\;=\\; \\begin{pmatrix} 1+\\varepsilon  -1  0  0 \\\\ -1  2  -1  0 \\\\ 0  -1  2  -1 \\\\ 0  0  -1  1 \\end{pmatrix}.\n$$\n将此矩阵记为 $A^{(1)}$。我们现在执行带部分主元的高斯消去法。\n\n**第1步：第1列的消去**\n$A^{(1)}$ 的第一列是 $(1+\\varepsilon, -1, 0, 0)^{\\top}$。我们必须选择绝对值最大的元素作为主元。候选元素是 $|1+\\varepsilon|$ 和 $|-1|=1$。因为 $\\varepsilon>0$，所以有 $1+\\varepsilon > 1$，因此 $|1+\\varepsilon| > |-1|$。主元是 $a^{(1)}_{11} = 1+\\varepsilon$。无需进行行交换。\n我们通过计算乘子 $m_{21} = \\frac{a^{(1)}_{21}}{a^{(1)}_{11}} = \\frac{-1}{1+\\varepsilon}$ 来消去元素 $a^{(1)}_{21}=-1$。\n第二行通过操作 $R_2 \\leftarrow R_2 - m_{21} R_1$ 进行更新。\n第二行的新元素为：\n$a^{(2)}_{21} = a^{(1)}_{21} - m_{21}a^{(1)}_{11} = -1 - \\left(\\frac{-1}{1+\\varepsilon}\\right)(1+\\varepsilon) = -1+1=0$。\n$a^{(2)}_{22} = a^{(1)}_{22} - m_{21}a^{(1)}_{12} = 2 - \\left(\\frac{-1}{1+\\varepsilon}\\right)(-1) = 2 - \\frac{1}{1+\\varepsilon} = \\frac{2(1+\\varepsilon)-1}{1+\\varepsilon} = \\frac{1+2\\varepsilon}{1+\\varepsilon}$。\n$a^{(2)}_{23} = a^{(1)}_{23} - m_{21}a^{(1)}_{13} = -1 - \\left(\\frac{-1}{1+\\varepsilon}\\right)(0) = -1$。\n$a^{(2)}_{24} = a^{(1)}_{24} - m_{21}a^{(1)}_{14} = 0 - \\left(\\frac{-1}{1+\\varepsilon}\\right)(0) = 0$。\n第一步之后的矩阵为\n$$\nA^{(2)} \\;=\\; \\begin{pmatrix} 1+\\varepsilon  -1  0  0 \\\\ 0  \\frac{1+2\\varepsilon}{1+\\varepsilon}  -1  0 \\\\ 0  -1  2  -1 \\\\ 0  0  -1  1 \\end{pmatrix}.\n$$\n\n**第2步：第2列的消去**\n当前主元列是第二列对角线下方的部分：$(\\frac{1+2\\varepsilon}{1+\\varepsilon}, -1)^{\\top}$。我们比较它们的大小来选择主元。\n$|a^{(2)}_{22}| = \\left|\\frac{1+2\\varepsilon}{1+\\varepsilon}\\right| = \\frac{1+2\\varepsilon}{1+\\varepsilon}$ 因为 $\\varepsilon>0$。\n$|a^{(2)}_{32}| = |-1| = 1$。\n对于 $\\varepsilon>0$，$1+2\\varepsilon > 1+\\varepsilon$，这意味着 $\\frac{1+2\\varepsilon}{1+\\varepsilon} > 1$。因此，$|a^{(2)}_{22}| > |a^{(2)}_{32}|$。主元是 $a^{(2)}_{22} = \\frac{1+2\\varepsilon}{1+\\varepsilon}$。无需行交换。\n我们用乘子 $m_{32} = \\frac{a^{(2)}_{32}}{a^{(2)}_{22}} = \\frac{-1}{(1+2\\varepsilon)/(1+\\varepsilon)} = -\\frac{1+\\varepsilon}{1+2\\varepsilon}$ 来消去 $a^{(2)}_{32}=-1$。\n第三行通过 $R_3 \\leftarrow R_3 - m_{32} R_2$ 更新。\n第三行的新元素：\n$a^{(3)}_{32} = a^{(2)}_{32} - m_{32}a^{(2)}_{22} = -1 - \\left(-\\frac{1+\\varepsilon}{1+2\\varepsilon}\\right)\\left(\\frac{1+2\\varepsilon}{1+\\varepsilon}\\right) = -1+1 = 0$。\n$a^{(3)}_{33} = a^{(2)}_{33} - m_{32}a^{(2)}_{23} = 2 - \\left(-\\frac{1+\\varepsilon}{1+2\\varepsilon}\\right)(-1) = 2 - \\frac{1+\\varepsilon}{1+2\\varepsilon} = \\frac{2(1+2\\varepsilon)-(1+\\varepsilon)}{1+2\\varepsilon} = \\frac{1+3\\varepsilon}{1+2\\varepsilon}$。\n$a^{(3)}_{34} = a^{(2)}_{34} - m_{32}a^{(2)}_{24} = -1 - \\left(-\\frac{1+\\varepsilon}{1+2\\varepsilon}\\right)(0) = -1$。\n第二步之后的矩阵为\n$$\nA^{(3)} \\;=\\; \\begin{pmatrix} 1+\\varepsilon  -1  0  0 \\\\ 0  \\frac{1+2\\varepsilon}{1+\\varepsilon}  -1  0 \\\\ 0  0  \\frac{1+3\\varepsilon}{1+2\\varepsilon}  -1 \\\\ 0  0  -1  1 \\end{pmatrix}.\n$$\n\n**第3步：第3列的消去**\n当前主元列是第三列对角线下方的部分：$(\\frac{1+3\\varepsilon}{1+2\\varepsilon}, -1)^{\\top}$。我们比较它们的大小。\n$|a^{(3)}_{33}| = \\left|\\frac{1+3\\varepsilon}{1+2\\varepsilon}\\right| = \\frac{1+3\\varepsilon}{1+2\\varepsilon}$ 因为 $\\varepsilon>0$。\n$|a^{(3)}_{43}| = |-1| = 1$。\n对于 $\\varepsilon>0$，$1+3\\varepsilon > 1+2\\varepsilon$，这意味着 $\\frac{1+3\\varepsilon}{1+2\\varepsilon} > 1$。因此，$|a^{(3)}_{33}| > |a^{(3)}_{43}|$。主元是 $a^{(3)}_{33} = \\frac{1+3\\varepsilon}{1+2\\varepsilon}$。无需行交换。\n我们用乘子 $m_{43} = \\frac{a^{(3)}_{43}}{a^{(3)}_{33}} = \\frac{-1}{(1+3\\varepsilon)/(1+2\\varepsilon)} = -\\frac{1+2\\varepsilon}{1+3\\varepsilon}$ 来消去 $a^{(3)}_{43}=-1$。\n第四行通过 $R_4 \\leftarrow R_4 - m_{43} R_3$ 更新。\n第四行第四列的新元素是：\n$a^{(4)}_{44} = a^{(3)}_{44} - m_{43}a^{(3)}_{34} = 1 - \\left(-\\frac{1+2\\varepsilon}{1+3\\varepsilon}\\right)(-1) = 1 - \\frac{1+2\\varepsilon}{1+3\\varepsilon} = \\frac{(1+3\\varepsilon)-(1+2\\varepsilon)}{1+3\\varepsilon} = \\frac{\\varepsilon}{1+3\\varepsilon}$。\n完成这最后一步后，高斯消去过程结束。得到的上三角矩阵，记为 $U$，是\n$$\nU \\;=\\; \\begin{pmatrix} 1+\\varepsilon  -1  0  0 \\\\ 0  \\frac{1+2\\varepsilon}{1+\\varepsilon}  -1  0 \\\\ 0  0  \\frac{1+3\\varepsilon}{1+2\\varepsilon}  -1 \\\\ 0  0  0  \\frac{\\varepsilon}{1+3\\varepsilon} \\end{pmatrix}.\n$$\n最终的主元是 $U$ 的 $(4,4)$ 对角线元素，即 $u_{44}(\\varepsilon)$。\n$$\nu_{44}(\\varepsilon) = \\frac{\\varepsilon}{1+3\\varepsilon}.\n$$\n\n**极限行为分析**\n当 $\\varepsilon \\to 0^{+}$ 时，$u_{44}(\\varepsilon)$ 的极限行为是\n$$\n\\lim_{\\varepsilon \\to 0^{+}} u_{44}(\\varepsilon) = \\lim_{\\varepsilon \\to 0^{+}} \\frac{\\varepsilon}{1+3\\varepsilon} = \\frac{0}{1+0} = 0.\n$$\n这种行为是原始矩阵 $A$ 奇异性的直接结果。矩阵的行列式是在高斯消去过程中得到的主元的乘积（其符号由行交换决定）。由于不需要行交换，$\\det(A_{\\varepsilon}) = u_{11}u_{22}u_{33}u_{44}$。\n$$\n\\det(A_{\\varepsilon}) = (1+\\varepsilon)\\left(\\frac{1+2\\varepsilon}{1+\\varepsilon}\\right)\\left(\\frac{1+3\\varepsilon}{1+2\\varepsilon}\\right)\\left(\\frac{\\varepsilon}{1+3\\varepsilon}\\right) = \\varepsilon.\n$$\n当 $\\varepsilon \\to 0^{+}$ 时，$A_{\\varepsilon} \\to A$，且 $\\det(A_{\\varepsilon}) \\to \\det(A)$。极限 $\\lim_{\\varepsilon \\to 0^{+}} \\det(A_{\\varepsilon})=0$ 证实了 $\\det(A)=0$，因此 $A$ 是一个奇异矩阵。\n矩阵的秩等于高斯消去法产生的非零主元的数量。对于任何 $\\varepsilon>0$，$A_{\\varepsilon}$ 的所有四个主元都是非零的，因此 $\\text{rank}(A_{\\varepsilon})=4$。然而，在 $\\varepsilon \\to 0^{+}$ 的极限下，$A_{\\varepsilon}$ 的主元收敛于 $A$ 的主元：\n$$\nu_{11} \\to 1, \\quad u_{22} \\to 1, \\quad u_{33} \\to 1, \\quad u_{44} \\to 0.\n$$\n矩阵 $A$ 在最终位置出现零主元，表明其秩为 $3$。对于一个 $n \\times n$ 矩阵，秩 $r  n$ 意味着其零空间的维数为 $n-r$。对于 $4 \\times 4$ 矩阵 $A$，秩为 $3$ 意味着其零空间的维数为 $4-3=1$。这与问题陈述中 $A$ 是秩亏的且具有一维零空间的说法完全一致。量 $u_{44}(\\varepsilon)$ 趋近于零，是 $A_{\\varepsilon}$ 作为一个奇异矩阵的小扰动的数值特征。",
            "answer": "$$\\boxed{\\frac{\\varepsilon}{1+3\\varepsilon}}$$"
        },
        {
            "introduction": "在计算流体力学的实际应用中，我们处理的是大型稀疏矩阵。对这类系统直接应用高斯消元法可能会因为“填充”（fill-in）——即在原本为零的位置上产生新的非零元——而导致计算量过大, 在计算上是不可行的。 这个实践将我们的重点从数值计算转移到矩阵结构上，这是高效稀疏求解器的关键。通过在压缩稀疏行（CSR）格式的矩阵上模拟一个消元步骤，您将亲身体验稀疏模式是如何演化的，并理解为什么管理填充对于求解大规模问题至关重要。",
            "id": "3322984",
            "problem": "考虑一个由计算流体力学 (CFD) 中椭圆算子的标准离散化产生的稀疏线性系统，其产生一个大型稀疏矩阵。给定一个压缩稀疏行 (CSR) 格式的矩阵，该矩阵由三个数组定义：行指针数组、列索引数组和数据数组。对于本任务，仅需要行指针数组和列索引数组。压缩稀疏行 (CSR) 格式为每一行存储一个连续的列索引块，用以指示非零元的位置。\n\n其基础是用于构造矩阵的下三角-上三角 (LU) 分解的经典高斯消元法。在索引为 $k$ 的消元步骤中，假设主元 $a_{kk}$ 非零且不进行行或列主元选取，该变换通过将主元行 $k$ 的倍数加到行 $i$ 上，来将所有满足 $i  k$ 的行 $i$ 中的元素 $a_{ik}$ 置为零。具体来说，乘数定义为 $l_{ik} = a_{ik} / a_{kk}$，行更新是对所有列 $j$ 应用线性操作 $a_{ij} \\leftarrow a_{ij} - l_{ik} \\, a_{kj}$。在用于预测填充的结构（仅模式）分析中，数值抵消被忽略：如果 $a_{kj}$ 在结构上非零并且执行了消元（意味着 $a_{ik}$ 在结构上非零），则更新后的 $a_{ij}$ 通常被视为非零。通过这种方式，该步骤引起的填充由稀疏模式的图论并集决定。\n\n你的任务是模拟一个单一的消元步骤，该步骤使用行 $k$ 的主元来消去目标行 $i$ 第 $k$ 列的元素，并相应地更新目标行 $i$ 的稀疏模式。请使用从零开始的索引。遵循以下结构模拟规则：\n- 如果目标行 $i$ 在第 $k$ 列不包含结构上非零的元素（也就是说，行 $i$ 的列索引列表中没有索引 $k$），则不执行消元，该行的稀疏模式保持不变。\n- 如果执行了消元，从目标行的稀疏模式中移除主元列 $k$，并在所有满足 $j  k$ 且主元行 $k$ 在第 $j$ 列有结构上非零元的列 $j$ 处插入填充，前提是这些列尚未存在于目标行中。保留目标行所有其他原始列。\n\n形式上，设行 $i$ 的原始列索引集合为 $S_i$，行 $k$ 的为 $S_k$。如果 $k \\in S_i$，则行 $i$ 更新后的结构模式为\n$$\nS_i^{\\text{new}} = \\big( S_i \\setminus \\{k\\} \\big) \\cup \\{\\, j \\in S_k \\mid j  k \\,\\}.\n$$\n如果 $k \\notin S_i$，则 $S_i^{\\text{new}} = S_i$。\n\n实现一个程序，对于每个测试用例，接收一个 CSR 矩阵和指定的 $(k,i)$ 对，执行上述单步消元的结构更新，并输出行 $i$ 更新后排好序的列索引列表。\n\n本任务不涉及物理单位、角度单位或百分比。\n\n使用以下测试套件。每个测试用例提供矩阵维度 $n$、CSR 行指针数组 $\\text{indptr}$、CSR 列索引数组 $\\text{indices}$ 以及消元参数 $(k,i)$。\n\n测试用例 $1$（发生填充）：\n- $n = 6$\n- $\\text{indptr} = [\\, 0,\\, 2,\\, 5,\\, 9,\\, 12,\\, 15,\\, 18 \\,]$\n- $\\text{indices} = [\\, 0,\\, 1,\\, 0,\\, 1,\\, 2,\\, 1,\\, 2,\\, 3,\\, 5,\\, 2,\\, 3,\\, 5,\\, 2,\\, 4,\\, 5,\\, 3,\\, 4,\\, 5 \\,]$\n- $(k,i) = (2,\\, 4)$\n\n测试用例 $2$（无填充；主元行的主元后列已存在于目标行中）：\n- $n = 5$\n- $\\text{indptr} = [\\, 0,\\, 2,\\, 5,\\, 7,\\, 10,\\, 12 \\,]$\n- $\\text{indices} = [\\, 0,\\, 1,\\, 0,\\, 1,\\, 2,\\, 1,\\, 2,\\, 1,\\, 2,\\, 3,\\, 3,\\, 4 \\,]$\n- $(k,i) = (1,\\, 3)$\n\n测试用例 $3$（跳过消元；目标行的主元列处为结构零）：\n- $n = 6$\n- $\\text{indptr} = [\\, 0,\\, 2,\\, 4,\\, 7,\\, 9,\\, 12,\\, 14 \\,]$\n- $\\text{indices} = [\\, 0,\\, 1,\\, 1,\\, 2,\\, 0,\\, 2,\\, 4,\\, 2,\\, 3,\\, 1,\\, 4,\\, 5,\\, 3,\\, 5 \\,]$\n- $(k,i) = (2,\\, 5)$\n\n测试用例 $4$（主元行没有主元后列；仅从目标行中移除主元列）：\n- $n = 6$\n- $\\text{indptr} = [\\, 0,\\, 2,\\, 5,\\, 7,\\, 9,\\, 11,\\, 14 \\,]$\n- $\\text{indices} = [\\, 0,\\, 1,\\, 1,\\, 2,\\, 4,\\, 2,\\, 3,\\, 3,\\, 4,\\, 1,\\, 4,\\, 2,\\, 4,\\, 5 \\,]$\n- $(k,i) = (4,\\, 5)$\n\n你的程序应生成单行输出，其中包含一个由方括号括起来的、逗号分隔的结果列表。每个结果必须是对应测试用例中行 $i$ 更新后排好序的列索引列表。例如，输出应如下所示\n$[\\, [\\dots],\\, [\\dots],\\, [\\dots],\\, [\\dots] \\,]$\n列表内没有空格。具体来说，你的程序必须以如下格式精确打印一行\n`[[case1],[case2],[case3],[case4]]`\n其中每个 $\\text{caseX}$ 是一个逗号分隔的整数列表。",
            "solution": "本题要求根据给定的结构更新规则，对四个独立的测试用例模拟单步高斯消元对稀疏模式的影响。我们将逐个分析每个案例。\n\n### 测试用例 1\n- 消元参数: $k=2, i=4$\n- 主元行 $k=2$ 的列索引集合: 从 `indptr` 数组可知，行 $2$ 的索引范围是 `indices[5:9]`，即 $S_2 = \\{1, 2, 3, 5\\}$。\n- 目标行 $i=4$ 的列索引集合: 行 $4$ 的索引范围是 `indices[12:15]`，即 $S_4 = \\{2, 4, 5\\}$。\n- **判断是否消元**: 由于主元列索引 $k=2$ 存在于目标行集合 $S_4$ 中，因此需要执行消元。\n- **应用更新规则**: $S_4^{\\text{new}} = ( S_4 \\setminus \\{2\\} ) \\cup \\{ j \\in S_2 \\mid j  2 \\}$\n    - $S_4 \\setminus \\{2\\} = \\{2, 4, 5\\} \\setminus \\{2\\} = \\{4, 5\\}$\n    - $\\{ j \\in S_2 \\mid j  2 \\} = \\{ j \\in \\{1, 2, 3, 5\\} \\mid j > 2 \\} = \\{3, 5\\}$\n    - $S_4^{\\text{new}} = \\{4, 5\\} \\cup \\{3, 5\\} = \\{3, 4, 5\\}$\n- **结果**: 排序后，行 $4$ 更新后的列索引为 `[3, 4, 5]`。\n\n### 测试用例 2\n- 消元参数: $k=1, i=3$\n- 主元行 $k=1$ 的列索引集合: $S_1 = \\text{indices}[2:5] = \\{0, 1, 2\\}$。\n- 目标行 $i=3$ 的列索引集合: $S_3 = \\text{indices}[7:10] = \\{1, 2, 3\\}$。\n- **判断是否消元**: $k=1$ 存在于 $S_3$ 中，需要执行消元。\n- **应用更新规则**: $S_3^{\\text{new}} = ( S_3 \\setminus \\{1\\} ) \\cup \\{ j \\in S_1 \\mid j > 1 \\}$\n    - $S_3 \\setminus \\{1\\} = \\{1, 2, 3\\} \\setminus \\{1\\} = \\{2, 3\\}$\n    - $\\{ j \\in S_1 \\mid j > 1 \\} = \\{ j \\in \\{0, 1, 2\\} \\mid j > 1 \\} = \\{2\\}$\n    - $S_3^{\\text{new}} = \\{2, 3\\} \\cup \\{2\\} = \\{2, 3\\}$\n- **结果**: 排序后，行 $3$ 更新后的列索引为 `[2, 3]`。\n\n### 测试用例 3\n- 消元参数: $k=2, i=5$\n- 主元行 $k=2$ 的列索引集合: $S_2 = \\text{indices}[4:7] = \\{0, 2, 4\\}$。\n- 目标行 $i=5$ 的列索引集合: $S_5 = \\text{indices}[12:14] = \\{3, 5\\}$。\n- **判断是否消元**: 主元列索引 $k=2$ 不存在于目标行集合 $S_5$ 中。因此，不执行消元操作。\n- **应用更新规则**: $S_5^{\\text{new}} = S_5 = \\{3, 5\\}$。\n- **结果**: 排序后，行 $5$ 更新后的列索引为 `[3, 5]`。\n\n### 测试用例 4\n- 消元参数: $k=4, i=5$\n- 主元行 $k=4$ 的列索引集合: $S_4 = \\text{indices}[9:11] = \\{1, 4\\}$。\n- 目标行 $i=5$ 的列索引集合: $S_5 = \\text{indices}[11:14] = \\{2, 4, 5\\}$。\n- **判断是否消元**: $k=4$ 存在于 $S_5$ 中，需要执行消元。\n- **应用更新规则**: $S_5^{\\text{new}} = ( S_5 \\setminus \\{4\\} ) \\cup \\{ j \\in S_4 \\mid j > 4 \\}$\n    - $S_5 \\setminus \\{4\\} = \\{2, 4, 5\\} \\setminus \\{4\\} = \\{2, 5\\}$\n    - $\\{ j \\in S_4 \\mid j > 4 \\} = \\{ j \\in \\{1, 4\\} \\mid j > 4 \\} = \\emptyset$ (空集)\n    - $S_5^{\\text{new}} = \\{2, 5\\} \\cup \\emptyset = \\{2, 5\\}$\n- **结果**: 排序后，行 $5$ 更新后的列索引为 `[2, 5]`。\n\n综合所有测试用例，最终的输出列表是 `[[3,4,5],[2,3],[3,5],[2,5]]`。",
            "answer": "[[3,4,5],[2,3],[3,5],[2,5]]"
        }
    ]
}