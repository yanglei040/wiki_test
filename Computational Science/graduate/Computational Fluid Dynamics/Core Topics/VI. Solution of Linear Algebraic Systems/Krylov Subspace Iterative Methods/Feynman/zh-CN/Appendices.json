{
    "hands_on_practices": [
        {
            "introduction": "共轭梯度（CG）法是求解对称正定（SPD）线性系统的基石。在计算流体力学中，诸如不可压缩流求解器中的压力泊松方程等问题，在离散化后常常会产生大型稀疏SPD系统。通过亲手执行共轭梯度法的前两次迭代，本练习旨在具体展示该算法如何通过构建$A$-共轭搜索方向来逐步逼近精确解，从而加深对CG方法核心机制的理解。",
            "id": "3338514",
            "problem": "在计算流体动力学中，对于不可压缩流的投影法，每个时间步的压力场是通过求解具有齐次狄利克雷边界条件的离散泊松方程得到的。考虑单位区间上的一个一维模型问题，其具有零狄利克雷边界条件，并在一个包含 $n=5$ 个内部点的均匀网格上进行离散化，这会导出一个使用标准三点差分格式的稀疏对称正定线性系统 $A x = b$。我们使用无量纲化的离散算子，它将网格间距因子吸收到右端项中，因此系数矩阵 $A \\in \\mathbb{R}^{5 \\times 5}$ 是一个主对角线元素为 $2$，第一副对角线和第一超对角线元素为 $-1$ 的三对角矩阵，即：\n$$\nA \\;=\\; \\begin{pmatrix}\n2  &-1  &0  &0  &0 \\\\\n-1  &2  &-1  &0  &0 \\\\\n0  &-1  &2  &-1  &0 \\\\\n0  &0  &-1  &2  &-1 \\\\\n0  &0  &0  &-1  &2\n\\end{pmatrix}.\n$$\n假设在第一个内部节点处有一个局部强迫项，因此右端项为 $b = \\begin{pmatrix} 1 & 0 & 0 & 0 & 0 \\end{pmatrix}^{T}$，并选择初始猜测值 $x_{0} = \\begin{pmatrix} 0 & 0 & 0 & 0 & 0 \\end{pmatrix}^{T}$。\n\n从克雷洛夫子空间迭代法和共轭梯度 (CG) 法的基本原理出发——即 $A$ 是对称正定的，残差为 $r_{k} = b - A x_{k}$，搜索方向是 A-共轭的，并且每一步都沿着仿射子空间最小化二次泛函 $\\phi(x) = \\tfrac{1}{2} x^{T} A x - b^{T} x$——推导应用于该系统的 CG 法的前两次迭代。具体来说，构造 $p_{0}$，通过实施沿 $p_{0}$ 方向的线搜索最小化来计算步长 $\\alpha_{0}$，更新 $x_{1}$ 和 $r_{1}$，通过实施 $p_{1}$ 与 $p_{0}$ 的 A-共轭性来推导系数 $\\beta_{0}$，然后计算 $\\alpha_{1}$、$x_{2}$ 和 $r_{2}$。\n\n按以下方式报告最终结果：\n- 给出 $x_{2}$ 的五个分量，后面跟着 $\\|r_{2}\\|_{2}$ 的值，所有值都表示为精确的有理数。\n- 使用括号将您的最终答案表示为单行，按顺序列出 $x_{2}$ 的各项，然后将 $\\|r_{2}\\|_{2}$ 作为最后一项，不带单位。",
            "solution": "问题陈述已经过验证，并被认为是有效的。它具有科学依据、是适定的、客观的，并包含推导出唯一解所需的所有必要信息。所描述的线性系统和共轭梯度 (CG) 方法是数值线性代数和计算科学中的标准课题。\n\n任务是计算线性系统 $A x = b$ 的共轭梯度 (CG) 法的前两次迭代，其中矩阵 $A$、右端向量 $b$ 和初始猜测值 $x_0$ 由下式给出：\n$$ A = \\begin{pmatrix} 2  &-1  &0  &0  &0 \\\\ -1  &2  &-1  &0  &0 \\\\ 0  &-1  &2  &-1  &0 \\\\ 0  &0  &-1  &2  &-1 \\\\ 0  &0  &0  &-1  &2 \\end{pmatrix}, \\quad b = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix}, \\quad x_0 = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\n矩阵 $A$ 是对称正定的，这是 CG 方法的一个先决条件。CG 算法迭代地构造一系列近似解 $x_k$，这些解能最小化二次泛函 $\\phi(x) = \\frac{1}{2} x^T A x - b^T x$。\n\n**初始化 ($k=0$)**\n\n首先，我们计算初始残差 $r_0$。残差定义为 $r_k = b - A x_k$。\n对于 $k=0$，我们有：\n$$ r_0 = b - A x_0 = b - A \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = b = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\n初始搜索方向 $p_0$ 被设为等于初始残差：\n$$ p_0 = r_0 = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\n\n**第一次迭代 ($k=0$)**\n\n第一步是计算使 $\\phi(x_0 + \\alpha_0 p_0)$ 最小化的最优步长 $\\alpha_0$。这个条件等价于使新残差 $r_1$ 与搜索方向 $p_0$ 正交，即 $r_1^T p_0 = 0$。由于 $r_1 = r_0 - \\alpha_0 A p_0$，我们有 $(r_0 - \\alpha_0 A p_0)^T p_0 = 0$，这给出了 $\\alpha_0$ 的公式：\n$$ \\alpha_0 = \\frac{r_0^T p_0}{p_0^T A p_0} $$\n由于 $p_0 = r_0$，这可以简化为 $\\alpha_0 = \\frac{r_0^T r_0}{p_0^T A p_0}$。首先，我们计算分子：\n$$ r_0^T r_0 = \\begin{pmatrix} 1 & 0 & 0 & 0 & 0 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = 1 $$\n接下来，我们计算矩阵-向量乘积 $A p_0$：\n$$ A p_0 = \\begin{pmatrix} 2  &-1  &0  &0  &0 \\\\ -1  &2  &-1  &0  &0 \\\\ 0  &-1  &2  &-1  &0 \\\\ 0  &0  &-1  &2  &-1 \\\\ 0  &0  &0  &-1  &2 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 2 \\\\ -1 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\n现在，我们计算 $\\alpha_0$ 的分母：\n$$ p_0^T A p_0 = \\begin{pmatrix} 1 & 0 & 0 & 0 & 0 \\end{pmatrix} \\begin{pmatrix} 2 \\\\ -1 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = 2 $$\n因此，步长 $\\alpha_0$ 为：\n$$ \\alpha_0 = \\frac{1}{2} $$\n我们现在可以更新解向量 $x_1$：\n$$ x_1 = x_0 + \\alpha_0 p_0 = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} + \\frac{1}{2} \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1/2 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\n以及残差向量 $r_1$：\n$$ r_1 = r_0 - \\alpha_0 A p_0 = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} - \\frac{1}{2} \\begin{pmatrix} 2 \\\\ -1 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1 - 1 \\\\ 0 - (-\\frac{1}{2}) \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 1/2 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\n\n**第二次迭代 ($k=1$)**\n\n首先，我们确定新的搜索方向 $p_1 = r_1 + \\beta_0 p_0$。选择系数 $\\beta_0$ 以确保 $p_1$ 和 $p_0$ 之间的 A-共轭性，即 $p_1^T A p_0 = 0$。\n$$ (r_1 + \\beta_0 p_0)^T A p_0 = 0 \\implies r_1^T A p_0 + \\beta_0 p_0^T A p_0 = 0 $$\n求解 $\\beta_0$：\n$$ \\beta_0 = - \\frac{r_1^T A p_0}{p_0^T A p_0} $$\n从上一步我们已经得到了向量 $r_1$、$A p_0$ 和值 $p_0^T A p_0=2$。分子是：\n$$ r_1^T A p_0 = \\begin{pmatrix} 0 & 1/2 & 0 & 0 & 0 \\end{pmatrix} \\begin{pmatrix} 2 \\\\ -1 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = -\\frac{1}{2} $$\n因此，$\\beta_0$ 是：\n$$ \\beta_0 = - \\frac{-1/2}{2} = \\frac{1}{4} $$\n一个常见的替代公式是 $\\beta_0 = (r_1^T r_1) / (r_0^T r_0)$。我们来验证一下：$r_1^T r_1 = (1/2)^2 = 1/4$ 且 $r_0^T r_0 = 1$，得到 $\\beta_0 = 1/4$，结果一致。\n\n现在我们构造新的搜索方向 $p_1$：\n$$ p_1 = r_1 + \\beta_0 p_0 = \\begin{pmatrix} 0 \\\\ 1/2 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} + \\frac{1}{4} \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1/4 \\\\ 1/2 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\n接下来，我们计算步长 $\\alpha_1$：\n$$ \\alpha_1 = \\frac{r_1^T r_1}{p_1^T A p_1} $$\n分子是 $r_1^T r_1 = 1/4$。对于分母，我们首先需要计算 $A p_1$：\n$$ A p_1 = \\begin{pmatrix} 2  &-1  &0  &0  &0 \\\\ -1  &2  &-1  &0  &0 \\\\ 0  &-1  &2  &-1  &0 \\\\ 0  &0  &-1  &2  &-1 \\\\ 0  &0  &0  &-1  &2 \\end{pmatrix} \\begin{pmatrix} 1/4 \\\\ 1/2 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 2(\\frac{1}{4}) - 1(\\frac{1}{2}) \\\\ -1(\\frac{1}{4}) + 2(\\frac{1}{2}) \\\\ 0 - 1(\\frac{1}{2}) \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 3/4 \\\\ -1/2 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\n然后，分母是：\n$$ p_1^T A p_1 = \\begin{pmatrix} 1/4 & 1/2 & 0 & 0 & 0 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 3/4 \\\\ -1/2 \\\\ 0 \\\\ 0 \\end{pmatrix} = (\\frac{1}{4})(0) + (\\frac{1}{2})(\\frac{3}{4}) = \\frac{3}{8} $$\n所以步长 $\\alpha_1$ 是：\n$$ \\alpha_1 = \\frac{1/4}{3/8} = \\frac{1}{4} \\cdot \\frac{8}{3} = \\frac{2}{3} $$\n我们更新解以得到 $x_2$：\n$$ x_2 = x_1 + \\alpha_1 p_1 = \\begin{pmatrix} 1/2 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} + \\frac{2}{3} \\begin{pmatrix} 1/4 \\\\ 1/2 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1/2 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} + \\begin{pmatrix} 1/6 \\\\ 1/3 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 3/6 + 1/6 \\\\ 1/3 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 2/3 \\\\ 1/3 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\n最后，我们计算新的残差 $r_2$：\n$$ r_2 = r_1 - \\alpha_1 A p_1 = \\begin{pmatrix} 0 \\\\ 1/2 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} - \\frac{2}{3} \\begin{pmatrix} 0 \\\\ 3/4 \\\\ -1/2 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 1/2 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} - \\begin{pmatrix} 0 \\\\ 1/2 \\\\ -1/3 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1/3 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\n问题要求 $x_2$ 的五个分量和 $r_2$ 的欧几里得范数，记作 $\\|r_2\\|_2$。\n$x_2$ 的分量是 $\\frac{2}{3}$、$\\frac{1}{3}$、$0$、$0$、$0$。\n$r_2$ 的范数是：\n$$ \\|r_2\\|_2 = \\sqrt{0^2 + 0^2 + (1/3)^2 + 0^2 + 0^2} = \\sqrt{\\frac{1}{9}} = \\frac{1}{3} $$\n最终结果由 $x_2$ 的五个分量和 $\\|r_2\\|_2$ 的值组成。",
            "answer": "$$ \\boxed{\\begin{pmatrix} \\frac{2}{3} & \\frac{1}{3} & 0 & 0 & 0 & \\frac{1}{3} \\end{pmatrix}} $$"
        },
        {
            "introduction": "当线性系统非对称时，共轭梯度法不再适用，此时需要更通用的方法。广义最小残差（GMRES）法是求解大规模非对称线性系统的主要迭代方法之一，在处理由对流-扩散方程产生的系统中尤为关键。本练习将引导你完成GMRES方法的单次迭代，通过在一个一维克雷洛夫子空间中求解一个最小二乘问题来最小化残差，让你直观地感受GMRES方法的核心思想。",
            "id": "3338495",
            "problem": "在计算流体动力学 (CFD) 中，输运-扩散算子的隐式时间积分和线性化会产生形如 $A x = b$ 的线性系统，该系统必须得到高效求解。克里洛夫子空间迭代法通过在由系统矩阵重复作用生成的空间中最小化残差来构造近似解。考虑由 $3 \\times 3$ 矩阵\n$$\nA = \\begin{pmatrix}\n4 & 1 & 0 \\\\\n0 & 3 & 1 \\\\\n0 & 0 & 2\n\\end{pmatrix}\n$$\n和右端项\n$$\nb = \\begin{pmatrix}\n1 \\\\\n1 \\\\\n1\n\\end{pmatrix},\n$$\n定义的线性系统，其初始近似解为 $x_{0} = \\begin{pmatrix}0 \\\\ 0 \\\\ 0\\end{pmatrix}$。使用广义最小残差 (GMRES) 方法，执行恰好一次迭代（即，构造一维克里洛夫子空间，并基于使用欧几里得内积的 Arnoldi 过程计算相应的 GMRES 更新），以获得 $x_{1}$。然后，计算残差 $r_{1} = b - A x_{1}$ 的欧几里得范数。\n\n以精确形式表示最终的残差范数，无需舍入。不需要物理单位。",
            "solution": "该问题定义明确，要求应用广义最小残差 (GMRES) 方法进行一次迭代。给定矩阵 $A$、右端向量 $b$ 和初始近似解 $x_0$。我们必须计算一次迭代后残差的欧几里得范数 $\\|r_1\\|_2$。\n\nGMRES 方法从仿射空间 $x_0 + \\mathcal{K}_m(A, r_0)$ 中生成近似解 $x_m$，其中 $\\mathcal{K}_m(A, r_0)$ 是 $m$ 阶克里洛夫子空间。选择解 $x_m$ 是为了最小化残差的欧几里得范数 $\\|b - A x_m\\|_2$。我们执行一次迭代的步骤，即 $m=1$。\n\n首先，我们计算初始残差 $r_0$。\n$$\nr_0 = b - A x_0\n$$\n给定 $x_0 = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}$，项 $A x_0$ 是零向量。因此，初始残差等于 $b$：\n$$\nr_0 = b = \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix}\n$$\n接下来，我们计算 $r_0$ 的欧几里得范数：\n$$\n\\|r_0\\|_2 = \\sqrt{1^2 + 1^2 + 1^2} = \\sqrt{3}\n$$\nGMRES 方法使用 Arnoldi 过程为克里洛夫子空间 $\\mathcal{K}_1(A, r_0) = \\text{span}\\{r_0\\}$ 构造一个标准正交基。对于 $m=1$，这个基由单个向量 $v_1$ 组成，它是归一化的初始残差。\n$$\nv_1 = \\frac{r_0}{\\|r_0\\|_2} = \\frac{1}{\\sqrt{3}} \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix}\n$$\n更新后的近似解 $x_1$ 的形式为 $x_1 = x_0 + z_1$，其中 $z_1 \\in \\mathcal{K}_1(A, r_0)$。这意味着 $z_1$可以写成 $v_1$ 的标量倍数，即对于某个标量 $y_1 \\in \\mathbb{R}$，有 $z_1 = y_1 v_1$。GMRES 方法通过求解一个最小二乘问题来找到最优的 $y_1$。\n近似解为 $x_1 = x_0 + y_1 v_1$。相应的残差为 $r_1 = b - A x_1 = b - A(x_0 + y_1 v_1) = (b - A x_0) - y_1 A v_1 = r_0 - y_1 A v_1$。选择系数 $y_1$ 以最小化 $\\|r_1\\|_2 = \\|r_0 - y_1 A v_1\\|_2$。这是一个经典的线性最小二乘问题，我们要在由 $A v_1$ 张成的子空间中找到向量 $r_0$ 的最佳近似。解 $y_1 A v_1$ 是 $r_0$ 在 $A v_1$ 上的正交投影。这导出了正规方程：\n$$\n(A v_1)^T (r_0 - y_1 A v_1) = 0\n$$\n求解 $y_1$ 可得：\n$$\ny_1 = \\frac{(A v_1)^T r_0}{\\|A v_1\\|_2^2}\n$$\n我们计算必要的组成部分。首先，向量 $A v_1$：\n$$\nA v_1 = \\begin{pmatrix} 4 & 1 & 0 \\\\ 0 & 3 & 1 \\\\ 0 & 0 & 2 \\end{pmatrix} \\left( \\frac{1}{\\sqrt{3}} \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} \\right) = \\frac{1}{\\sqrt{3}} \\begin{pmatrix} 4(1)+1(1)+0(1) \\\\ 0(1)+3(1)+1(1) \\\\ 0(1)+0(1)+2(1) \\end{pmatrix} = \\frac{1}{\\sqrt{3}} \\begin{pmatrix} 5 \\\\ 4 \\\\ 2 \\end{pmatrix}\n$$\n现在，我们计算 $y_1$ 表达式的分子：\n$$\n(A v_1)^T r_0 = \\left( \\frac{1}{\\sqrt{3}} \\begin{pmatrix} 5 & 4 & 2 \\end{pmatrix} \\right) \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} = \\frac{1}{\\sqrt{3}}(5 \\cdot 1 + 4 \\cdot 1 + 2 \\cdot 1) = \\frac{11}{\\sqrt{3}}\n$$\n接下来，我们计算分母：\n$$\n\\|A v_1\\|_2^2 = \\left\\| \\frac{1}{\\sqrt{3}} \\begin{pmatrix} 5 \\\\ 4 \\\\ 2 \\end{pmatrix} \\right\\|_2^2 = \\frac{1}{(\\sqrt{3})^2} (5^2 + 4^2 + 2^2) = \\frac{1}{3}(25 + 16 + 4) = \\frac{45}{3} = 15\n$$\n现在我们可以计算 $y_1$：\n$$\ny_1 = \\frac{11/\\sqrt{3}}{15} = \\frac{11}{15\\sqrt{3}}\n$$\n我们现在可以找到新的近似解 $x_1$：\n$$\nx_1 = x_0 + y_1 v_1 = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} + \\frac{11}{15\\sqrt{3}} \\left( \\frac{1}{\\sqrt{3}} \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} \\right) = \\frac{11}{15 \\cdot 3} \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} = \\frac{11}{45} \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix}\n$$\n问题要求计算残差 $r_1 = b - A x_1$ 的欧几里得范数。让我们来计算 $r_1$：\n$$\nA x_1 = \\begin{pmatrix} 4 & 1 & 0 \\\\ 0 & 3 & 1 \\\\ 0 & 0 & 2 \\end{pmatrix} \\left( \\frac{11}{45} \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} \\right) = \\frac{11}{45} \\begin{pmatrix} 4(1)+1(1)+0(1) \\\\ 0(1)+3(1)+1(1) \\\\ 0(1)+0(1)+2(1) \\end{pmatrix} = \\frac{11}{45} \\begin{pmatrix} 5 \\\\ 4 \\\\ 2 \\end{pmatrix}\n$$\n$$\nr_1 = b - A x_1 = \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} - \\frac{11}{45} \\begin{pmatrix} 5 \\\\ 4 \\\\ 2 \\end{pmatrix} = \\begin{pmatrix} 1 - \\frac{55}{45} \\\\ 1 - \\frac{44}{45} \\\\ 1 - \\frac{22}{45} \\end{pmatrix} = \\begin{pmatrix} \\frac{45-55}{45} \\\\ \\frac{45-44}{45} \\\\ \\frac{45-22}{45} \\end{pmatrix} = \\frac{1}{45} \\begin{pmatrix} -10 \\\\ 1 \\\\ 23 \\end{pmatrix}\n$$\n最后，我们计算 $r_1$ 的欧几里得范数：\n$$\n\\|r_1\\|_2 = \\left\\| \\frac{1}{45} \\begin{pmatrix} -10 \\\\ 1 \\\\ 23 \\end{{pmatrix} \\right\\|_2 = \\frac{1}{45} \\sqrt{(-10)^2 + 1^2 + 23^2}\n$$\n平方根内的各项是：\n$(-10)^2 = 100$\n$1^2 = 1$\n$23^2 = 529$\n将这些项相加得到 $100 + 1 + 529 = 630$。所以，\n$$\n\\|r_1\\|_2 = \\frac{\\sqrt{630}}{45}\n$$\n为了化简表达式，我们分解数字 $630$：\n$$\n630 = 63 \\times 10 = (9 \\times 7) \\times (2 \\times 5) = 3^2 \\times 70\n$$\n因此，$\\sqrt{630} = \\sqrt{3^2 \\times 70} = 3\\sqrt{70}$。\n将此代入范数的表达式中：\n$$\n\\|r_1\\|_2 = \\frac{3\\sqrt{70}}{45} = \\frac{\\sqrt{70}}{15}\n$$\n这是一次 GMRES 迭代后残差的欧几里得范数的最终精确值。",
            "answer": "$$\n\\boxed{\\frac{\\sqrt{70}}{15}}\n$$"
        },
        {
            "introduction": "对于现实世界中的大规模CFD问题，单独使用克雷洛夫子空间方法往往收敛速度过慢，预处理技术因此变得至关重要。不完全LU（ILU）分解是最常用和最有效的预处理技术之一，它通过构造一个易于求解的近似逆来加速收敛。本练习要求你为一个经典的二维泊松问题构建零填充不完全LU（ILU(0)）预处理器，这不仅能让你掌握ILU(0)的构造过程，还能让你深入理解稀疏性模式在预处理器设计中的核心作用。",
            "id": "3338499",
            "problem": "考虑单位正方形上的标准二维泊松方程，其带有齐次狄利克雷边界条件，并在一个包含 $3 \\times 3$ 个内部点的均匀网格上使用二阶中心差分法进行离散化。\n\n使用按行字典序（在每个固定的 $y$ 内，$x$ 递增）对 9 个未知数进行编号。所得线性系统的系数矩阵为 $A \\in \\mathbb{R}^{9 \\times 9}$，它是 5 点离散拉普拉斯算子，其对角线元素为 4，与网格图中直接邻居（左、右、上、下）对应的非对角线元素为 -1，其他位置元素为零。均匀网格间距因子是所有元素的公因子，可以省略。\n\n为了在计算流体力学中为 Krylov 子空间方法设计预条件子，请构造矩阵 $A$ 的零填充不完全 LU 分解 (ILU($0$))，得到单位下三角因子 $L$ 和上三角因子 $U$。根据 ILU(0) 的定义，该分解模拟高斯消元法，同时丢弃任何在 $A$ 原始稀疏模式之外的填充元素，并且 $L$ 被约束为单位对角矩阵。\n\n你的任务是：\n- 从第一性原理（即导出 5 点拉普拉斯算子的离散守恒平衡，以及 ILU(0) 作为一种保留 $A$ 稀疏模式、无舍弃容差的不完全分解的定义）出发，推导出在 ILU(0) 条件下确定 $L$ 和 $U$ 元素的消元关系式，并将其应用于指定排序下的这个 $9 \\times 9$ 问题。\n- 基于此推导，用网格邻居耦合的方式明确描述 $L$ 和 $U$ 的稀疏模式（即哪些邻居方向的元素存在于 $L$ 中，哪些存在于 $U$ 中，以及对角线的情况）。\n- 最后，计算不完全因子 $L$ 和 $U$ 中非零元素的总数，即将 $\\operatorname{nnz}(L) + \\operatorname{nnz}(U)$ 计算为一个整数。\n\n将最终答案表示为单个整数。无需四舍五入，也无需物理单位。",
            "solution": "所述问题具有科学依据、是良定且客观的。它描述了在数值线性代数中为一个著名的离散偏微分方程创建预条件子的标准过程。因此，我们可以着手求解。\n\n问题要求计算在一个 $3 \\times 3$ 内部点网格上的 5 点离散拉普拉斯算子的矩阵表示的 ILU(0) 分解因子中的非零元素总数。设 $x$ 和 $y$ 方向的内部网格点数分别为 $n_x=3$ 和 $n_y=3$。未知数的总数为 $N = n_x n_y = 3 \\times 3 = 9$。\n\n代表内部网格点 $(x_i, y_j)$（其中 $i,j \\in \\{1, 2, 3\\}$）处解的未知数 $u_{ij}$ 按行字典序进行排序。这种排序将二维网格索引 $(i,j)$ 映射为一维向量索引 $k$，其关系为 $k = (j-1)n_x + i$。\n网格点及其对应的索引 $k$ 如下：\n$k=7: (i=1, j=3)$, $k=8: (i=2, j=3)$, $k=9: (i=3, j=3)$\n$k=4: (i=1, j=2)$, $k=5: (i=2, j=2)$, $k=6: (i=3, j=2)$\n$k=1: (i=1, j=1)$, $k=2: (i=2, j=1)$, $k=3: (i=3, j=1)$\n\n泊松方程 $-\\nabla^2 u = f$ 在内部点 $(i,j)$ 处的二阶中心差分格式（按要求省略网格间距因子 $h^2$）可得到 5 点格式方程：\n$$4u_{i,j} - u_{i-1,j} - u_{i+1,j} - u_{i,j-1} - u_{i,j+1} = f_{i,j}$$\n这个结构定义了系数矩阵 $A \\in \\mathbb{R}^{9 \\times 9}$。对于与网格点 $(i,j)$ 对应的给定未知数 $k$，矩阵的第 $k$ 行将具有以下特征：\n- 一个对角元素 $A_{k,k} = 4$。\n- 如果未知数 $l$ 对应于 $(i,j)$ 的一个直接网格邻居，则非对角元素 $A_{k,l} = -1$。这些邻居是：\n  - 西: $(i-1, j)$, 索引为 $l=k-1$ (如果 $i>1$)。\n  - 东: $(i+1, j)$, 索引为 $l=k+1$ (如果 $i<3$)。\n  - 南: $(i, j-1)$, 索引为 $l=k-n_x = k-3$ (如果 $j>1$)。\n  - 北: $(i, j+1)$, 索引为 $l=k+n_x = k+3$ (如果 $j<3$)。\n\n矩阵 $A$ 的稀疏模式因此由其对角线和四个副对角线（偏移量为 $\\pm 1$ 和 $\\pm 3$）组成。\n- 对角线有 9 个非零元素。\n- 偏移量为 $\\pm 1$ 的副对角线各有 $N-1 = 8$ 个潜在位置，但由于行末断开，实际各有 $N-n_y = 9-3=6$ 个非零元素。\n- 偏移量为 $\\pm 3$ 的副对角线各有 $N-n_x = 9-3=6$ 个非零元素。\n由于 $A$ 是对称的，严格上三角部分和严格下三角部分的非零元素数量相同，均为 $6+6=12$ 个。\n$A$ 中的非零元素总数为 $9 (\\text{对角线}) + 12 (\\text{下三角}) + 12 (\\text{上三角}) = 33$ 个。\n\nILU(0) 分解 $A \\approx LU$ 的定义是，因子 $L$ 和 $U$ 的稀疏模式 $P(L)$ 和 $P(U)$ 被限制在原始矩阵 $A$ 的稀疏模式内，即 $P(L) \\cup P(U) \\subseteq P(A)$。对于 ILU(0)，我们精确地保留原始稀疏模式，即 $P(L) = P(A_{\\text{lower}})$ 且 $P(U) = P(A_{\\text{upper}})$，其中 $A_{\\text{lower}}$ 和 $A_{\\text{upper}}$ 分别是 $A$ 的下三角和上三角部分（包括对角线）。\n\n$L$ 是一个单位下三角矩阵（对角线元素为 1）。根据 ILU(0) 的定义，其稀疏模式与 $A$ 的下三角部分（包括对角线）相同。因此，其非零元素的数量等于其对角线上的元素数量（9 个）加上 $A$ 的严格下三角部分中的非零元素数量（12 个），总计为 $9 + 12 = 21$ 个。\n$U$ 是一个上三角矩阵，其稀疏模式与 $A$ 的上三角部分（包括对角线）相同。其非零元素的数量等于其对角线上的元素数量（9 个）加上 $A$ 的严格上三角部分中的非零元素数量（12 个），总计为 $9 + 12 = 21$ 个。\n因此，非零元素的总数为 $\\operatorname{nnz}(L) + \\operatorname{nnz}(U) = 21 + 21 = 42$。",
            "answer": "$$\\boxed{42}$$"
        }
    ]
}