{
    "hands_on_practices": [
        {
            "introduction": "衡量收敛性并非表面上看起来那么简单。不同的残差归一化方法可能会揭示截然不同的情况。这项动手编程练习  让您能够直接研究这个问题。通过为一个模型问题实现一个简单的迭代求解器，您将观察到不同的归一化选择如何与网格分辨率和物理参数的变化相互作用，从而揭示标准收敛监控中存在的潜在模糊性。",
            "id": "3305239",
            "problem": "你的任务是研究不同的残差归一化选择如何影响迭代线性求解器的感知收敛性，该求解器源于可压缩纳维-斯托克斯方程的牛顿线性化。在一个一维无量纲的设定下进行研究，该设定能捕捉对流和扩散输运的标度关系以及可压缩性稳定化的特征。其基础是以下广泛使用的过程：通过牛顿法求解非线性残差 $F(U) = 0$，在非线性迭代指数为 $m$ 时，产生一个线性系统 $J(U^{(m)}) \\,\\Delta U^{(m)} = -F(U^{(m)})$，其中 $J$ 是 $F$ 的雅可比矩阵。对于一个固定的非线性迭代解 $U^{(m)}$，内层线性迭代求解器维持一个当前迭代解 $x^{(k)}$，用于求解 $J x = b$（其中 $b = -F(U^{(m)})$），并定义线性残差为 $r^{(k)} = b - J x^{(k)}$。内层求解器的收敛通常通过检查一个归一化残差是否低于某个容差来判断。\n\n以此为基础，构建一个合成的线性化一维算子，并研究三种残差归一化策略：通过初始残差范数进行缩放、通过右端项范数进行缩放，以及通过雅可比矩阵的对角线进行缩放。使用来自带可压缩性稳定化的一维对流-扩散的基本标度关系，将 $J \\in \\mathbb{R}^{n \\times n}$ 定义为一个三对角矩阵：\n- 对角元为 $J_{ii} = \\alpha + \\dfrac{2 \\nu}{h^2}$。\n- 次对角元为 $J_{i,i-1} = -\\dfrac{\\nu}{h^2} - \\dfrac{U}{2 h}$，其中 $i \\geq 2$。\n- 超对角元为 $J_{i,i+1} = -\\dfrac{\\nu}{h^2} + \\dfrac{U}{2 h}$，其中 $i \\leq n-1$。\n此处，$h = \\dfrac{1}{n}$ 是单位区间上的网格间距，$U$ 是一个恒定的平流速度，$\\nu = \\dfrac{1}{Re}$ 是无量纲形式的运动粘度，其中 $Re$ 是雷诺数。参数 $\\alpha > 0$ 代表可压缩性或伪时间稳定化，并且可以取足够大的值以确保在整个测试套件中矩阵都是对角占优的。\n\n定义右端项为 $b_i = \\sin(\\pi x_i)$，其中 $x_i = i h$，$i = 1, \\dots, n$。使用初始猜测 $x^{(0)}_i = x_i$，$i = 1, \\dots, n$，因此 $r^{(0)} = b - J x^{(0)} \\neq b$。\n\n使用加权雅可比（WJ）迭代来推进线性求解：\n$$\nx^{(k+1)} = x^{(k)} + \\omega D^{-1} \\left(b - J x^{(k)}\\right),\n$$\n其中 $D = \\mathrm{diag}(J)$ 且 $\\omega \\in (0, 2)$ 是一个松弛因子。选择一个固定的内迭代次数 $K$ 和一个固定的松弛因子 $\\omega$，并假设 $D$ 的所有元素都严格为正。\n\n对于每个测试用例，在 $K$ 次迭代后，计算残差 $r^{(K)}$ 并评估以下三种归一化残差的定义：\n1. 按初始残差范数进行缩放：$R_{r_0} = \\dfrac{\\lVert r^{(K)} \\rVert_2}{\\lVert r^{(0)} \\rVert_2}$。\n2. 按右端项范数进行缩放：$R_{b} = \\dfrac{\\lVert r^{(K)} \\rVert_2}{\\lVert b \\rVert_2}$。\n3. 按雅可比矩阵对角线进行缩放（行平衡）：$R_{D} = \\dfrac{\\lVert D^{-1} r^{(K)} \\rVert_2}{\\lVert D^{-1} r^{(0)} \\rVert_2}$。\n\n此外，对于每种归一化，通过与固定容差 $\\tau$ 进行比较来定义一个布尔收敛标志：对于归一化 $R_{\\star}$，如果 $R_{\\star} \\le \\tau$，则设置 $C_{\\star} = \\mathrm{True}$，否则设置 $C_{\\star} = \\mathrm{False}$。\n\n你的程序必须使用以下固定参数来实现上述过程：\n- 使用 $U = 1$。\n- 使用 $\\alpha = 500$。\n- 使用 $\\omega = 1$。\n- 使用 $K = 30$。\n- 使用 $\\tau = 10^{-6}$。\n所有量都是无量纲的，且不使用角度。\n\n构建并运行以下测试套件，该套件旨在探究网格加密和雷诺数变化的影响：\n- 用例 1：$n = 50$, $Re = 50$。\n- 用例 2：$n = 200$, $Re = 50$。\n- 用例 3：$n = 50$, $Re = 1000$。\n- 用例 4：$n = 200$, $Re = 1000$。\n- 用例 5：$n = 50$, $Re = 5$。\n\n对于每个用例，你的程序必须返回一个列表，顺序为 $[R_{r_0}, R_b, R_D, C_{r_0}, C_b, C_D]$，包含三个浮点数和三个布尔值。将所有用例的结果聚合成一个单一列表，因此最终输出为一行，包含一个由逗号分隔的五个用例结果的列表，并用方括号括起来。例如，打印的行必须看起来像 $[\\,[\\dots],\\,[\\dots],\\,[\\dots],\\,[\\dots],\\,[\\dots]\\,]$，其中每个内部列表都按指定顺序排列。不得打印任何额外文本。",
            "solution": "该问题要求对用于评估迭代线性求解器收敛性的三种不同残差归一化策略进行审慎的检验。其背景是一个合成的一维问题，该问题代表了在计算流体动力学（CFD）中遇到的那些问题，特别是源于可压缩纳维-斯托克斯方程的牛顿线性化。分析将通过实现指定的数值格式并将其应用于一系列测试用例来进行。\n\n首先，我们对问题设置进行形式化。核心任务是迭代求解以下线性方程组：\n$$\nJ x = b\n$$\n此处，$J \\in \\mathbb{R}^{n \\times n}$ 是一个稀疏三对角矩阵，表示带有稳定项的离散化一维对流-扩散算子。其元素是基于单位区间上间距为 $h = \\dfrac{1}{n}$ 的均匀网格定义的。参数包括恒定的平流速度 $U$、运动粘度 $\\nu = \\dfrac{1}{Re}$（其中 $Re$ 是雷诺数）和一个稳定化参数 $\\alpha$。矩阵元素给定如下：\n- 对角元：$J_{ii} = \\alpha + \\dfrac{2 \\nu}{h^2}$\n- 次对角元：$J_{i,i-1} = -\\dfrac{\\nu}{h^2} - \\dfrac{U}{2 h}$，其中 $i = 2, \\dots, n$\n- 超对角元：$J_{i,i+1} = -\\dfrac{\\nu}{h^2} + \\dfrac{U}{2 h}$，其中 $i = 1, \\dots, n-1$\n\n右端项（RHS）向量 $b \\in \\mathbb{R}^n$ 通过在网格点 $x_i = i h$（$i=1, \\dots, n$）上评估一个光滑函数来定义：\n$$\nb_i = \\sin(\\pi x_i)\n$$\n迭代求解过程从一个初始猜测 $x^{(0)} \\in \\mathbb{R}^n$ 开始，该猜测被指定为网格坐标的向量：\n$$\nx^{(0)}_i = x_i\n$$\n\n所选的迭代求解器是加权雅可比（WJ）方法。解从迭代 $k$ 推进到 $k+1$ 使用以下公式：\n$$\nx^{(k+1)} = x^{(k)} + \\omega D^{-1} \\left(b - J x^{(k)}\\right)\n$$\n其中 $D = \\mathrm{diag}(J)$ 是 $J$ 的对角部分，$\\omega$ 是一个松弛因子，括号中的项是在第 $k$ 次迭代时的线性残差，定义为 $r^{(k)} = b - J x^{(k)}$。对于此问题，参数是固定的：$\\omega = 1$（这将该方法简化为标准的雅可比迭代），并且迭代次数固定为 $K = 30$。问题假设 $D$ 的元素严格为正，这个条件在此处是满足的，因为 $J_{ii} = \\alpha + \\frac{2\\nu}{h^2}$ 且 $\\alpha > 0$ 和 $\\nu > 0$。\n\n在执行 $K=30$ 次迭代后，我们得到最终状态 $x^{(K)}$ 和最终残差 $r^{(K)} = b - J x^{(K)}$。中心任务是评估三种不同的归一化残差：\n1.  **按初始残差范数进行缩放**：该度量 $R_{r_0}$ 衡量残差量值相对于其初始值的减小程度。初始残差为 $r^{(0)} = b - J x^{(0)}$。\n    $$\n    R_{r_0} = \\dfrac{\\lVert r^{(K)} \\rVert_2}{\\lVert r^{(0)} \\rVert_2}\n    $$\n2.  **按右端项范数进行缩放**：该度量 $R_{b}$ 衡量最终残差量值相对于强迫项 $b$ 的大小。\n    $$\n    R_{b} = \\dfrac{\\lVert r^{(K)} \\rVert_2}{\\lVert b \\rVert_2}\n    $$\n3.  **按雅可比矩阵对角线进行缩放（行平衡）**：该度量 $R_{D}$ 衡量预处理后残差范数的减小程度，其中预处理器是雅可比矩阵的对角线。这通常提供一个与尺度无关的收敛度量。\n    $$\n    R_{D} = \\dfrac{\\lVert D^{-1} r^{(K)} \\rVert_2}{\\lVert D^{-1} r^{(0)} \\rVert_2}\n    $$\n\n对于每个归一化残差 $R_{\\star}$，通过将其与固定容差 $\\tau = 10^{-6}$ 进行比较来确定一个布尔收敛标志 $C_{\\star}$。如果 $R_{\\star} \\le \\tau$，则该标志设置为 $\\mathrm{True}$，否则设置为 $\\mathrm{False}$。\n\n每个测试用例 $(n, Re)$ 的计算流程如下：\n1.  设置固定参数：$U = 1$, $\\alpha = 500$, $\\omega = 1$, $K = 30$, $\\tau = 10^{-6}$。\n2.  计算派生参数：$h = 1/n$ 和 $\\nu = 1/Re$。\n3.  构建 $n \\times n$ 的三对角矩阵 $J$。\n4.  构建网格向量 $x_{grid}$，其元素为 $x_i = i h$。\n5.  构建右端项向量 $b$，其元素为 $b_i = \\sin(\\pi x_i)$。\n6.  设置初始解向量 $x^{(0)} = x_{grid}$。\n7.  计算初始残差 $r^{(0)} = b - Jx^{(0)}$。\n8.  从 $J$ 中提取对角矩阵 $D$。\n9.  计算并存储分母的范数：$\\lVert r^{(0)} \\rVert_2$, $\\lVert b \\rVert_2$ 和 $\\lVert D^{-1} r^{(0)} \\rVert_2$。\n10. 执行雅可比迭代循环，从 $k = 0$ 到 $K-1=29$：\n    $x^{(k+1)} = x^{(k)} + \\omega D^{-1} (b - J x^{(k)})$。\n11. 完成后，计算最终残差 $r^{(K)} = b - J x^{(K)}$。\n12. 计算分子的范数：$\\lVert r^{(K)} \\rVert_2$ 和 $\\lVert D^{-1} r^{(K)} \\rVert_2$。\n13. 计算三个比率 $R_{r_0}$、$R_{b}$ 和 $R_{D}$。\n14. 确定三个布尔标志 $C_{r_0}$、$C_{b}$ 和 $C_{D}$。\n15. 将结果整理成一个形如 $[R_{r_0}, R_b, R_D, C_{r_0}, C_b, C_D]$ 的列表。\n\n此流程被系统地应用于所有指定的测试用例，并且最终结果被聚合成一个单一的列表。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef run_case(n, Re, U, alpha, omega, K, tau):\n    \"\"\"\n    Solves the 1D convection-diffusion problem for one test case.\n\n    Args:\n        n (int): Number of grid points.\n        Re (float): Reynolds number.\n        U (float): Advection speed.\n        alpha (float): Stabilization parameter.\n        omega (float): Weighted Jacobi relaxation parameter.\n        K (int): Number of iterations.\n        tau (float): Convergence tolerance.\n\n    Returns:\n        list: A list containing [R_r0, R_b, R_D, C_r0, C_b, C_D].\n    \"\"\"\n    # 1. Calculate derived parameters\n    h = 1.0 / n\n    nu = 1.0 / Re\n\n    # 2. Construct the tridiagonal Jacobian matrix J\n    J = np.zeros((n, n))\n    \n    # Diagonal term\n    diag_val = alpha + (2 * nu / h**2)\n    # Sub-diagonal term\n    sub_diag_val = -nu / h**2 - U / (2 * h)\n    # Super-diagonal term\n    sup_diag_val = -nu / h**2 + U / (2 * h)\n\n    # Fill the matrix J using np.diag\n    J += np.diag(np.full(n, diag_val))\n    J += np.diag(np.full(n - 1, sub_diag_val), k=-1)\n    J += np.diag(np.full(n - 1, sup_diag_val), k=1)\n    \n    # 3. Construct grid, RHS vector b, and initial guess x_k\n    # Grid points x_i = i*h for i=1,...,n, corresponding to array indices 0,...,n-1\n    x_grid = h * (np.arange(n) + 1)\n    \n    b = np.sin(np.pi * x_grid)\n    x_k = x_grid.copy() # Initial guess x^(0)\n\n    # 4. Extract diagonal D and compute its inverse\n    D = np.diag(J)\n    D_inv = 1.0 / D\n\n    # 5. Calculate initial residual r^(0) and required norms\n    r0 = b - J @ x_k\n    norm_r0 = np.linalg.norm(r0, 2)\n    norm_b = np.linalg.norm(b, 2)\n    \n    # Preconditioned initial residual and its norm\n    # D_inv is a 1D array, so we use element-wise multiplication\n    D_inv_r0 = D_inv * r0\n    norm_D_inv_r0 = np.linalg.norm(D_inv_r0, 2)\n    \n    # Edge case: If initial residual is zero, convergence is perfect.\n    if np.isclose(norm_r0, 0.0):\n        return [0.0, 0.0, 0.0, True, True, True]\n\n    # 6. Perform K iterations of the Weighted Jacobi method\n    for _ in range(K):\n        r_k = b - J @ x_k\n        x_k += omega * D_inv * r_k\n        \n    # 7. Compute final residual r^(K) and its norms\n    r_K = b - J @ x_k\n    norm_rK = np.linalg.norm(r_K, 2)\n    \n    D_inv_r_K = D_inv * r_K\n    norm_D_inv_r_K = np.linalg.norm(D_inv_r_K, 2)\n\n    # 8. Calculate the three normalized residual metrics\n    R_r0 = norm_rK / norm_r0\n    R_b = norm_rK / norm_b if norm_b > 0 else np.inf\n    # Handle division by zero for R_D, although norm_D_inv_r0 is unlikely to be zero\n    # if norm_r0 wasn't.\n    R_D = norm_D_inv_r_K / norm_D_inv_r0 if norm_D_inv_r0 > 0 else np.inf\n\n    # 9. Determine the convergence flags\n    C_r0 = R_r0 = tau\n    C_b = R_b = tau\n    C_D = R_D = tau\n\n    return [R_r0, R_b, R_D, C_r0, C_b, C_D]\n\ndef solve():\n    # Define the fixed parameters from the problem statement.\n    U = 1.0\n    alpha = 500.0\n    omega = 1.0\n    K = 30\n    tau = 1.0e-6\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (50, 50.0),    # Case 1\n        (200, 50.0),   # Case 2\n        (50, 1000.0),  # Case 3\n        (200, 1000.0), # Case 4\n        (50, 5.0),     # Case 5\n    ]\n\n    all_results = []\n    for n, Re in test_cases:\n        result = run_case(n, Re, U, alpha, omega, K, tau)\n        all_results.append(result)\n\n    # Final print statement in the exact required format.\n    # The string representation of a list of lists matches the required format.\n    print(str(all_results))\n\nsolve()\n\n```"
        },
        {
            "introduction": "“收益递减”是迭代求解中的一个核心问题。如果求解器得到的解已经比网格精度所能支持的更精确，那么继续迭代的意义何在？这项分析练习  深入探讨了这一基本问题。您将通过平衡迭代求解器产生的代数误差与离散格式固有的离散误差，推导出一个理性的停止准则，从而为收敛定义一个有意义的目标。",
            "id": "3305198",
            "problem": "在计算流体力学 (CFD) 中，考虑标量场 $u(x)$ 的稳态一维对流扩散问题，其在区间 $[0,1]$ 上由以下边值问题控制\n$$\n-\\nu\\,u''(x) + \\beta\\,u'(x) = f(x), \\qquad u(0)=0,\\quad u(1)=0,\n$$\n其中物理参数为常数：$\\nu0$ (扩散系数) 和 $\\beta0$ (对流速度)。取一个由 $f(x)=1$ 定义的构造右端项，使得连续解是光滑且适定的。在间距为 $h$ 的均匀网格上离散化空间导数，对流项 $\\beta\\,u'(x)$ 采用一阶迎风近似，扩散项 $-\\nu\\,u''(x)$ 采用二阶中心差分近似。该离散系统可以抽象地写为线性系统 $A\\,u_h=b$，其中 $A$ 是网格上的有限差分算子，$b$ 是组装后的源项。\n\n定义代数求解器误差为 $e_{\\mathrm{alg}}=u_h^{\\star}-u_h^{(k)}$，其中 $u_h^{\\star}$ 是离散系统的精确解，$u_h^{(k)}$ 是迭代线性求解器的当前迭代解。并定义代数残差为 $r^{(k)}=b-A\\,u_h^{(k)}$。令 $\\|\\cdot\\|$ 表示任意从属矩阵-向量范数。使用线性系统的基本不等式，\n$$\n\\|e_{\\mathrm{alg}}\\| \\le \\|A^{-1}\\|\\,\\|r^{(k)}\\|,\n$$\n以及所用有限差分格式的主阶相容性来刻画离散误差下限。具体来说，使用对 $\\beta\\,u'(x)$ 的一阶迎风格式的主阶局部截断误差（其与 $\\frac{\\beta h}{2}\\,u''(x)$ 成正比）来界定离散解 $u_h^{\\star}$ 的全局离散误差。\n\n从这些基本原理出发，并且不使用任何快捷公式，推导出一个闭式解析表达式，用于表示最小绝对残差容差 $\\tau^{\\star}$（使用与残差相同的范数）。当求解器容差收紧到低于 $\\tau^{\\star}$ 时，主导的主阶总误差无法进一步减小到渐近离散误差下限以下。您的表达式必须仅用物理参数 $\\beta$、$\\nu$ 和网格间距 $h$ 表示，并且应通过平衡主阶代数求解器误差与所选格式的截断误差分析所隐含的主阶离散误差来获得。将最终答案表示为单个解析表达式。不需要单位。",
            "solution": "用户要求我找到一个最优绝对残差容差 $\\tau^{\\star}$，用于求解离散化对流扩散问题的迭代求解器。最优性的标准是代数误差应与离散误差相平衡。\n\n首先，我理解问题陈述。控制方程是在区间 $x \\in [0, 1]$ 上的稳态一维对流扩散边值问题：\n$$\n-\\nu\\,u''(x) + \\beta\\,u'(x) = f(x), \\qquad u(0)=0,\\quad u(1)=0\n$$\n其中物理参数 $\\nu0$（扩散系数）和 $\\beta0$（对流速度）是常数，源项为 $f(x)=1$。尽管这些参数有物理名称，但使用 $f(x)=1$ 意味着问题是在无量纲框架下提出的，其中 $\\nu$、$\\beta$、$u$ 和 $x$ 都是无量纲量。我将基于此解释继续进行。\n\n在第 $k$ 次迭代时，数值解 $u_h^{(k)}$ 的总误差是网格节点 $x_i$ 上的精确连续解 $u(x_i)$ 与数值解向量 $u_h^{(k)}$ 之间的差。该误差可以分解为两个部分：\n1. 离散误差，$e_{\\mathrm{disc}} = u - u_h^{\\star}$，即精确连续解（在节点上取值）与离散系统 $A u_h = b$ 的精确解之差。\n2. 代数误差，$e_{\\mathrm{alg}} = u_h^{\\star} - u_h^{(k)}$，即精确离散解与求解器的当前迭代解之差。\n\n总误差是这两者之和：$u - u_h^{(k)} = e_{\\mathrm{disc}} + e_{\\mathrm{alg}}$。根据任意向量范数 $\\|\\cdot\\|$ 的三角不等式，总误差的大小有界：\n$$\n\\|u - u_h^{(k)}\\| \\le \\|e_{\\mathrm{disc}}\\| + \\|e_{\\mathrm{alg}}\\|\n$$\n\n代数误差与残差 $r^{(k)} = b - A u_h^{(k)}$ 相关。由于 $b = A u_h^{\\star}$，我们有 $r^{(k)} = A u_h^{\\star} - A u_h^{(k)} = A(u_h^{\\star} - u_h^{(k)}) = A e_{\\mathrm{alg}}$。这意味着 $e_{\\mathrm{alg}} = A^{-1} r^{(k)}$。取范数，我们得到问题陈述中给出的不等式：\n$$\n\\|e_{\\mathrm{alg}}\\| \\le \\|A^{-1}\\| \\|r^{(k)}\\|\n$$\n离散误差与局部截断误差 $\\tau_{\\mathrm{LTE}}$ 相关。截断误差定义为将精确连续解 $u$ 代入有限差分算子 $A_h$ 时得到的残差。让我们将 $u(x_i)$ 值的向量表示为 $u$。那么有 $A u = b + \\tau_{\\mathrm{LTE}}$。由于 $A u_h^{\\star} = b$，我们有 $A(u - u_h^{\\star}) = \\tau_{\\mathrm{LTE}}$，即 $A e_{\\mathrm{disc}} = \\tau_{\\mathrm{LTE}}$。这意味着 $e_{\\mathrm{disc}} = A^{-1} \\tau_{\\mathrm{LTE}}$，取范数给出其界限：\n$$\n\\|e_{\\mathrm{disc}}\\| \\le \\|A^{-1}\\| \\|\\tau_{\\mathrm{LTE}}\\|\n$$\n问题指定了对流项使用一阶迎风格式，扩散项使用二阶中心差分格式。整体精度受限于低阶格式，因此该方法是一阶的。局部截断误差的主阶项源自迎风近似，给出如下：\n$$\n\\tau_{\\mathrm{LTE}}(x) \\approx \\frac{\\beta h}{2} u''(x)\n$$\n其中 $h$ 是网格间距。\n\n迭代求解器的合理停止准则是当代数误差与离散误差处于同一量级时终止。进一步收紧求解器容差会消耗计算资源，但对总误差的减少微不足道，因为此时总误差由离散误差下限主导。这种平衡条件可以表示为 $\\|e_{\\mathrm{alg}}\\| \\sim \\|e_{\\mathrm{disc}}\\|$。使用上面推导出的界限：\n$$\n\\|A^{-1}\\| \\|r^{(k)}\\| \\sim \\|A^{-1}\\| \\|\\tau_{\\mathrm{LTE}}\\|\n$$\n$\\|A^{-1}\\|$ 项被消去，从而得出一个简洁的标准：最终残差的范数应与局部截断误差的范数量级相同。设 $\\tau^{\\star}$ 为所期望的残差容差。那么：\n$$\n\\tau^{\\star} \\sim \\|\\tau_{\\mathrm{LTE}}\\| \\approx \\left\\| \\frac{\\beta h}{2} u''(x) \\right\\|\n$$\n为了获得 $\\tau^{\\star}$ 的具体值，我们需要一个标量来度量范数。无穷范数是一个自然的选择，因为它代表了整个定义域上的最大误差。\n$$\n\\tau^{\\star} = \\frac{\\beta h}{2} \\|u''(x)\\|_{\\infty} = \\frac{\\beta h}{2} \\sup_{x \\in [0,1]} |u''(x)|\n$$\n为了计算这个值，我们必须求出精确解 $u(x)$ 的二阶导数。边值问题是 $-\\nu u'' + \\beta u' = 1$，且 $u(0)=u(1)=0$。这是一个常系数线性二阶常微分方程。\n齐次解是 $u_h(x) = C_1 + C_2 \\exp((\\beta/\\nu)x)$。一个特解是 $u_p(x) = x/\\beta$。通解是 $u(x) = C_1 + C_2 \\exp((\\beta/\\nu)x) + x/\\beta$。\n应用边界条件：$u(0)=0 \\implies C_1 + C_2 = 0 \\implies C_1 = -C_2$。$u(1)=0 \\implies C_1 + C_2 \\exp(\\beta/\\nu) + 1/\\beta = 0$。将 $C_1=-C_2$ 代入第二个方程，得到 $-C_2 + C_2 \\exp(\\beta/\\nu) + 1/\\beta = 0$，这得出 $C_2( \\exp(\\beta/\\nu) - 1 ) = -1/\\beta$。因此，$C_2 = -\\frac{1}{\\beta(\\exp(\\beta/\\nu)-1)}$。\n完整解是：\n$$\nu(x) = \\frac{1}{\\beta(\\exp(\\beta/\\nu)-1)} - \\frac{\\exp((\\beta/\\nu)x)}{\\beta(\\exp(\\beta/\\nu)-1)} + \\frac{x}{\\beta}\n$$\n现在，我们计算一阶和二阶导数：\n$$\nu'(x) = -\\frac{(\\beta/\\nu)\\exp((\\beta/\\nu)x)}{\\beta(\\exp(\\beta/\\nu)-1)} + \\frac{1}{\\beta} = -\\frac{\\exp((\\beta/\\nu)x)}{\\nu(\\exp(\\beta/\\nu)-1)} + \\frac{1}{\\beta}\n$$\n$$\nu''(x) = -\\frac{(\\beta/\\nu)\\exp((\\beta/\\nu)x)}{\\nu(\\exp(\\beta/\\nu)-1)} = -\\frac{\\beta}{\\nu^2} \\frac{\\exp((\\beta/\\nu)x)}{\\exp(\\beta/\\nu)-1}\n$$\n为了找到 $|u''(x)|$ 在 $[0,1]$ 上的上确界，我们考察其大小。由于 $\\beta0$ 且 $\\nu0$，项 $\\frac{\\beta}{\\nu^2} \\frac{1}{\\exp(\\beta/\\nu)-1}$ 是一个正常数。函数 $\\exp((\\beta/\\nu)x)$ 在 $x \\in [0,1]$ 上是正的且单调递增。因此，$u''(x)$ 的最大绝对值出现在 $x=1$ 处：\n$$\n\\|u''(x)\\|_{\\infty} = |u''(1)| = \\left| -\\frac{\\beta}{\\nu^2} \\frac{\\exp(\\beta/\\nu)}{\\exp(\\beta/\\nu)-1} \\right| = \\frac{\\beta}{\\nu^2} \\frac{\\exp(\\beta/\\nu)}{\\exp(\\beta/\\nu)-1}\n$$\n最后，我们将此表达式代回我们的 $\\tau^{\\star}$ 公式中：\n$$\n\\tau^{\\star} = \\frac{\\beta h}{2} \\|u''(x)\\|_{\\infty} = \\frac{\\beta h}{2} \\left( \\frac{\\beta}{\\nu^2} \\frac{\\exp(\\beta/\\nu)}{\\exp(\\beta/\\nu)-1} \\right)\n$$\n这可以简化为最优残差容差的最终闭式表达式：\n$$\n\\tau^{\\star} = \\frac{\\beta^2 h}{2\\nu^2} \\frac{\\exp(\\beta/\\nu)}{\\exp(\\beta/\\nu)-1}\n$$",
            "answer": "$$\n\\boxed{\\frac{\\beta^{2} h}{2\\nu^{2}} \\frac{\\exp(\\frac{\\beta}{\\nu})}{\\exp(\\frac{\\beta}{\\nu}) - 1}}\n$$"
        },
        {
            "introduction": "在工程应用中，我们最终关心的通常是某个具体物理量（如阻力或升力）的精度，而不仅仅是残差向量的 $L_2$ 范数。本练习  介绍了基于伴随方法的、功能强大的面向目标收敛性概念。您将计算一个特定的残差容差，以确保您所关注的工程量达到预期的精度水平，从而在数值分析与工程实际之间架起一座桥梁。",
            "id": "3305215",
            "problem": "在计算流体动力学（CFD）中，一个稳定、不可压缩的流动被离散化并求解。离散化的稳态方程具有线性代数形式 $A u = b$，其中 $A \\in \\mathbb{R}^{n \\times n}$ 是关于某个固定状态的离散化稳态 Navier–Stokes 算子的雅可比矩阵，$u \\in \\mathbb{R}^{n}$ 是无量纲化变量的离散状态向量，$b \\in \\mathbb{R}^{n}$ 是对应的右侧项。一个迭代线性求解器产生迭代解 $u_k$，其残差为 $r_k = b - A u_k$。我们感兴趣的量是无量纲阻力系数泛函 $J(u) \\in \\mathbb{R}$。离散伴随变量 $\\psi \\in \\mathbb{R}^{n}$ 的定义满足离散伴随方程 $A^{\\top} \\psi = \\nabla J(u)$，其中 $\\nabla J(u)$ 是 $J$ 关于 $u$ 的离散梯度。假设对于工作点处的线性化系统，以下各项是已知且固定的：\n- 算子范数界 $\\|A^{-1}\\|_{2} \\leq 4.0 \\times 10^{3}$，\n- 梯度范数 $\\|\\nabla J(u)\\|_{2} = 2.5$，\n- 所有范数均为欧几里得范数 $\\|\\cdot\\|_{2}$，\n- 所有变量均已无量纲化，且 $J(u)$ 是一个阻力系数。\n该应用要求终止时阻力系数预测的绝对误差满足 $|J(u_k) - J(u_{\\star})| \\leq \\Delta_{J}$，其中 $\\Delta_{J} = 1.0 \\times 10^{-4}$，$u_{\\star}$ 表示 $A u = b$ 的精确稳态解。从残差、误差和离散伴随的定义出发，在除了可微性之外不对 $J$ 的任何特定形式做假设的情况下，推导出一个关于残差范数 $\\|r_k\\|_{2}$ 的充分条件，以保证 $|J(u_k) - J(u_{\\star})| \\leq \\Delta_{J}$。该条件用 $\\|A^{-1}\\|_{2}$ 和 $\\|\\nabla J(u)\\|_{2}$ 表示。然后，根据所提供的数据计算 $\\|r_k\\|_{2}$ 的数值容差。将最终容差表示为一个无量纲数，并四舍五入到三位有效数字。",
            "solution": "该问题被验证为自洽、有科学依据且适定的。目标是推导出一个关于残差范数 $\\|r_k\\|_{2}$ 的充分条件，以保证我们感兴趣的量 $J(u)$ 达到期望的精度。这是一个在偏微分方程数值解的目标导向后验误差估计中的标准问题。\n\n令 $u_{\\star}$ 为离散线性系统 $A u = b$ 的精确解，因此 $A u_{\\star} = b$。令 $u_k$ 为迭代求解器在第 $k$ 次迭代时的近似解。状态误差向量定义为 $e_k = u_k - u_{\\star}$。残差向量定义为 $r_k = b - A u_k$。\n\n我们可以将误差向量 $e_k$ 与残差向量 $r_k$ 联系起来。\n将近似解的方程 $A u_k = b - r_k$ 从精确解的方程 $A u_{\\star} = b$ 中减去，我们得到：\n$$A u_{\\star} - A u_k = b - (b - r_k)$$\n$$A (u_{\\star} - u_k) = r_k$$\n$$-A e_k = r_k$$\n假设矩阵 $A$ 是可逆的，我们可以用残差表示误差向量：\n$$e_k = -A^{-1} r_k$$\n\n我们感兴趣的量是泛函 $J(u)$。我们关心的是这个泛函的绝对误差 $|J(u_k) - J(u_{\\star})|$。\n由于问题是在一个工作点附近的线性化系统的背景下提出的，我们可以使用一阶泰勒级数展开来近似泛函 $J$ 的变化。因此，泛函中的误差可以近似为泛函的梯度与状态向量误差的点积：\n$$J(u_k) - J(u_{\\star}) \\approx \\nabla J(u)^{\\top} (u_k - u_{\\star})$$\n其中 $\\nabla J(u)$ 是在线性化点 $u$ 处求值的泛函梯度。这是对偶加权残差误差估计的标准公式。令 $\\delta J = J(u_k) - J(u_{\\star})$。\n$$\\delta J \\approx \\nabla J(u)^{\\top} e_k$$\n\n代入 $e_k$ 的表达式：\n$$\\delta J \\approx \\nabla J(u)^{\\top} (-A^{-1} r_k) = - \\nabla J(u)^{\\top} A^{-1} r_k$$\n\n为了简化这个表达式，我们引入离散伴随变量 $\\psi$，它由离散伴随方程定义：\n$$A^{\\top} \\psi = \\nabla J(u)$$\n求解 $\\psi$，我们得到 $\\psi = (A^{\\top})^{-1} \\nabla J(u)$。\n我们想利用转置的性质来重写误差 $\\delta J$ 的表达式。回想一下，对于任何相容的矩阵 $X$ 和 $Y$，有 $(XY)^{\\top} = Y^{\\top}X^{\\top}$。令 $X = \\nabla J(u)^{\\top}$ 和 $Y=A^{-1}$。这不完全对。\n让我们重写 $\\nabla J(u)^{\\top} A^{-1}$ 这一项。让我们转置伴随方程：\n$$(A^{\\top} \\psi)^{\\top} = (\\nabla J(u))^{\\top}$$\n$$\\psi^{\\top} A = (\\nabla J(u))^{\\top}$$\n右乘 $A^{-1}$：\n$$\\psi^{\\top} A A^{-1} = (\\nabla J(u))^{\\top} A^{-1}$$\n$$\\psi^{\\top} = (\\nabla J(u))^{\\top} A^{-1}$$\n\n现在，我们将其代入 $\\delta J$ 的表达式中：\n$$\\delta J \\approx - \\psi^{\\top} r_k$$\n这表明我们感兴趣的泛函的误差约等于伴随解向量和残差向量的内积的负值。\n\n为了找到收敛的充分条件，我们取绝对值并应用欧几里得内积和范数（${\\|\\cdot\\|}_2$）的柯西-施瓦茨不等式：\n$$|\\delta J| = |J(u_k) - J(u_{\\star})| \\approx |-\\psi^{\\top} r_k| = |\\psi^{\\top} r_k| \\leq \\|\\psi\\|_{2} \\|r_k\\|_{2}$$\n\n为了使这个界限有用，我们需要界定 $\\|\\psi\\|_{2}$。根据伴随的定义，$\\psi = (A^{\\top})^{-1} \\nabla J(u)$。取其范数：\n$$\\|\\psi\\|_{2} = \\|(A^{\\top})^{-1} \\nabla J(u)\\|_{2}$$\n使用诱导矩阵范数的性质 $\\|Mx\\|_{2} \\leq \\|M\\|_{2} \\|x\\|_{2}$：\n$$\\|\\psi\\|_{2} \\leq \\|(A^{\\top})^{-1}\\|_{2} \\|\\nabla J(u)\\|_{2}$$\n对于欧几里得 2-范数，矩阵的范数与其转置的范数相等。此外，转置的逆的范数等于逆的转置的范数：$\\|(A^{\\top})^{-1}\\|_{2} = \\|(A^{-1})^{\\top}\\|_{2}$。因此：\n$$\\|(A^{\\top})^{-1}\\|_{2} = \\|A^{-1}\\|_{2}$$\n所以，伴随向量范数的界限是：\n$$\\|\\psi\\|_{2} \\leq \\|A^{-1}\\|_{2} \\|\\nabla J(u)\\|_{2}$$\n\n结合这些不等式，我们得到泛函误差的一个界限：\n$$|J(u_k) - J(u_{\\star})| \\lesssim \\|\\psi\\|_{2} \\|r_k\\|_{2} \\leq \\|A^{-1}\\|_{2} \\|\\nabla J(u)\\|_{2} \\|r_k\\|_{2}$$\n\n问题要求绝对误差不大于 $\\Delta_{J} = 1.0 \\times 10^{-4}$。为保证这一点，我们施加条件，使我们的上界小于或等于 $\\Delta_{J}$：\n$$\\|A^{-1}\\|_{2} \\|\\nabla J(u)\\|_{2} \\|r_k\\|_{2} \\leq \\Delta_{J}$$\n\n这就得出了关于残差范数 $\\|r_k\\|_{2}$ 的充分条件：\n$$\\|r_k\\|_{2} \\leq \\frac{\\Delta_{J}}{\\|A^{-1}\\|_{2} \\|\\nabla J(u)\\|_{2}}$$\n\n现在，我们代入给定的数值来计算所需的容差。给定：\n- $\\Delta_{J} = 1.0 \\times 10^{-4}$\n- $\\|A^{-1}\\|_{2} \\leq 4.0 \\times 10^{3}$\n- $\\|\\nabla J(u)\\|_{2} = 2.5$\n\n为确保不等式成立，我们必须使用分母可能的最大值，这意味着使用 $\\|A^{-1}\\|_{2}$ 的上界。\n$$\\|r_k\\|_{2} \\leq \\frac{1.0 \\times 10^{-4}}{(4.0 \\times 10^{3}) \\times 2.5}$$\n首先，计算分母中的乘积：\n$$ (4.0 \\times 10^{3}) \\times 2.5 = (4.0 \\times 2.5) \\times 10^{3} = 10.0 \\times 10^{3} = 1.0 \\times 10^{4} $$\n现在，执行除法：\n$$\\|r_k\\|_{2} \\leq \\frac{1.0 \\times 10^{-4}}{1.0 \\times 10^{4}} = 1.0 \\times 10^{-8}$$\n\n问题要求将数值容差四舍五入到三位有效数字。\n计算出的容差是 $1.0 \\times 10^{-8}$。用三位有效数字表示，即为 $1.00 \\times 10^{-8}$。\n这就是对残差的欧几里得范数所要求的数值容差。",
            "answer": "$$\n\\boxed{1.00 \\times 10^{-8}}\n$$"
        }
    ]
}