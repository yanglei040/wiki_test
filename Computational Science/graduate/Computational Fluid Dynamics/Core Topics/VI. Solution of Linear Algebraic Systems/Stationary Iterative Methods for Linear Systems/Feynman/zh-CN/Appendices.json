{
    "hands_on_practices": [
        {
            "introduction": "理查森迭代法是研究定常迭代法的一个理想起点。本练习旨在通过推导其误差传播关系，来揭示迭代收敛的核心机制。你将学习如何利用系统矩阵$A$的谱属性来确定迭代矩阵$T_{\\alpha}$的谱半径，并求解最优松弛因子$\\alpha^{\\ast}$，从而实现最快的收敛速度。这项实践将为你后续分析更复杂的迭代法打下坚实的理论基础。",
            "id": "3365915",
            "problem": "考虑在不可压缩流的投影法中出现的压力泊松子问题，该问题在一个具有均匀狄利克雷边界条件的结构化有限体积网格上进行离散化。得到的线性系统为 $A x = b$，其中 $A$ 是对称正定（SPD）矩阵。为了加速基准求解器的收敛，您应用了理查森定点迭代法 $x_{k+1} = x_k + \\alpha (b - A x_k)$，其中松弛参数 $\\alpha > 0$ 为常数。\n\n从定点迭代的定义和满足 $A x^{\\star} = b$ 的精确解 $x^{\\star}$ 出发，推导误差 $e_k = x_k - x^{\\star}$ 的线性误差传播关系，并证明该关系可以写成矩阵 $T_{\\alpha}$ 作用于 $e_k$ 的形式。仅使用 SPD 假设所保证的谱性质以及基本的线性代数事实（正交可对角化和谱定理），来根据 $A$ 的特征值刻画谱半径 $\\rho(T_{\\alpha})$。\n\n对于此离散化问题，在进行对称对角缩放（雅可比预条件）后，对网格和算子的分析得出了经过验证的 $A$ 的特征值谱界 $\\lambda_{\\min} = 0.5$ 和 $\\lambda_{\\max} = 1.0$。确定唯一的松弛参数 $\\alpha^{\\ast} > 0$，使得在所有常数 $\\alpha$ 的选择中，谱半径 $\\rho(T_{\\alpha})$ 最小。将您的最终答案 $\\alpha^{\\ast}$ 表示为一个精确的有理数。无需四舍五入。",
            "solution": "该问题是有效的，因为它具有科学依据、良定且客观，为得到唯一解提供了所有必要信息，没有任何矛盾或歧义。\n\nRichardson 定点迭代法由下式给出：\n$$\nx_{k+1} = x_k + \\alpha \\left(b - A x_k\\right)\n$$\n其中 $k$ 是迭代指数，$\\alpha > 0$ 是一个常数松弛参数，$A x = b$ 是待求解的线性系统。精确解（记为 $x^{\\star}$）满足方程 $A x^{\\star} = b$。\n\n为了推导误差传播关系，我们将第 $k$ 次迭代的误差定义为 $e_k = x_k - x^{\\star}$。\n从一个平凡的意义上说，精确解 $x^{\\star}$ 是迭代的一个不动点，因为 $b - A x^{\\star} = 0$，这意味着：\n$$\nx^{\\star} = x^{\\star} + \\alpha (b - A x^{\\star})\n$$\n从 $x_{k+1}$ 的迭代更新规则中减去这个关于精确解的方程，得到：\n$$\nx_{k+1} - x^{\\star} = \\left(x_k - x^{\\star}\\right) + \\alpha \\left( (b - A x_k) - (b - A x^{\\star}) \\right)\n$$\n代入误差 $e_k$ 和 $e_{k+1}$ 的定义：\n$$\ne_{k+1} = e_k + \\alpha \\left( A x^{\\star} - A x_k \\right)\n$$\n$$\ne_{k+1} = e_k - \\alpha A \\left( x_k - x^{\\star} \\right)\n$$\n$$\ne_{k+1} = e_k - \\alpha A e_k\n$$\n提出公因子 $e_k$，我们得到线性误差传播关系：\n$$\ne_{k+1} = (I - \\alpha A) e_k\n$$\n这表明误差根据迭代矩阵 $T_{\\alpha} = I - \\alpha A$ 进行传播。迭代收敛的充分必要条件是 $T_{\\alpha}$ 的谱半径（记为 $\\rho(T_{\\alpha})$）小于 $1$。\n\n接下来，我们利用 $A$ 的谱性质来刻画谱半径 $\\rho(T_{\\alpha})$。已知矩阵 $A$ 是对称正定（SPD）的。根据对称矩阵的谱定理，$A$ 是正交可对角化的，并拥有一组完备的标准正交特征向量 $v_i$ 及对应的实特征值 $\\lambda_i$。由于 $A$ 是正定的，其所有特征值均为正，即 $\\lambda_i > 0$。\n\n设 $(\\lambda_i, v_i)$ 是 $A$ 的一个特征对，使得 $A v_i = \\lambda_i v_i$。我们考察迭代矩阵 $T_{\\alpha}$ 对特征向量 $v_i$ 的作用：\n$$\nT_{\\alpha} v_i = (I - \\alpha A) v_i = I v_i - \\alpha A v_i = v_i - \\alpha \\lambda_i v_i = (1 - \\alpha \\lambda_i) v_i\n$$\n这表明 $T_{\\alpha}$ 的特征向量与 $A$ 的特征向量相同，而 $T_{\\alpha}$ 的特征值（记为 $\\mu_i$）由关系式 $\\mu_i = 1 - \\alpha \\lambda_i$ 给出。\n\n$T_{\\alpha}$ 的谱半径定义为其特征值绝对值的最大值：\n$$\n\\rho(T_{\\alpha}) = \\max_i |\\mu_i| = \\max_i |1 - \\alpha \\lambda_i|\n$$\n问题指出，$A$ 的特征值被限制在区间 $[\\lambda_{\\min}, \\lambda_{\\max}]$ 内，其中 $\\lambda_{\\min} = 0.5$，$ \\lambda_{\\max} = 1.0$。函数 $f(\\lambda) = 1 - \\alpha \\lambda$ 是关于 $\\lambda$ 的线性函数。对于固定的 $\\alpha > 0$，函数 $|f(\\lambda)| = |1 - \\alpha \\lambda|$ 将在闭区间 $[\\lambda_{\\min}, \\lambda_{\\max}]$ 的某个端点处达到其最大值。因此，谱半径可以表示为 $A$ 的极端特征值的形式：\n$$\n\\rho(T_{\\alpha}) = \\max\\left( |1 - \\alpha \\lambda_{\\min}|, |1 - \\alpha \\lambda_{\\max}| \\right)\n$$\n我们的目标是找到最优松弛参数 $\\alpha^{\\ast} > 0$ 来最小化此谱半径。我们需要解决以下极小化极大问题：\n$$\n\\min_{\\alpha > 0} \\rho(T_{\\alpha}) = \\min_{\\alpha > 0} \\max\\left( |1 - \\alpha \\lambda_{\\min}|, |1 - \\alpha \\lambda_{\\max}| \\right)\n$$\n当 `max` 函数的两个参数的绝对值相等时，达到最优值 $\\alpha^{\\ast}$。这种情况发生在：\n$$\n|1 - \\alpha \\lambda_{\\min}| = |1 - \\alpha \\lambda_{\\max}|\n$$\n由于 $\\lambda_{\\max} > \\lambda_{\\min} > 0$ 且 $\\alpha > 0$，我们有 $\\alpha \\lambda_{\\max} > \\alpha \\lambda_{\\min}$。因此，$1 - \\alpha \\lambda_{\\max}  1 - \\alpha \\lambda_{\\min}$。要使它们的绝对值相等，假设它们不都为零，则其中一个必须是另一个的相反数。我们关注的是两个值到零的距离相等的那一点。这种平衡发生在：\n$$\n1 - \\alpha \\lambda_{\\min} = -(1 - \\alpha \\lambda_{\\max})\n$$\n$$\n1 - \\alpha \\lambda_{\\min} = -1 + \\alpha \\lambda_{\\max}\n$$\n现在，我们求解 $\\alpha$：\n$$\n2 = \\alpha \\lambda_{\\max} + \\alpha \\lambda_{\\min}\n$$\n$$\n2 = \\alpha (\\lambda_{\\min} + \\lambda_{\\max})\n$$\n这给出了唯一的最优松弛参数 $\\alpha^{\\ast}$：\n$$\n\\alpha^{\\ast} = \\frac{2}{\\lambda_{\\min} + \\lambda_{\\max}}\n$$\n我们已知谱界为 $\\lambda_{\\min} = 0.5$ 和 $\\lambda_{\\max} = 1.0$。将这些值代入 $\\alpha^{\\ast}$ 的表达式中：\n$$\n\\alpha^{\\ast} = \\frac{2}{0.5 + 1.0} = \\frac{2}{1.5}\n$$\n为了将其表示为一个精确的有理数，我们将分母写成分数形式：\n$$\n\\alpha^{\\ast} = \\frac{2}{\\frac{3}{2}} = 2 \\cdot \\frac{2}{3} = \\frac{4}{3}\n$$\n对于给定的谱界，这是使 Richardson 迭代矩阵的谱半径最小的唯一的正松弛参数。",
            "answer": "$$\\boxed{\\frac{4}{3}}$$"
        },
        {
            "introduction": "在实际应用中，我们往往只能获得矩阵谱的粗略估计。本练习将理论与实践相结合，探讨如何在给定谱边界的情况下，确定保证收敛的“安全”参数区间。通过比较原始的理查森迭代与经过对角缩放预处理的加权雅可比迭代，你将定量地理解预处理如何显著提升算法的稳健性，即扩大有效参数的选择范围，这在求解复杂工程问题时至关重要。",
            "id": "3365965",
            "problem": "考虑在区间 $[0,1]$ 上的一维稳态扩散方程 $-u''(x) = f(x)$，其边界条件为齐次狄利克雷边界条件 $u(0) = 0$ 和 $u(1) = 0$，这是计算流体动力学 (CFD) 中的一个典型子问题。在一个具有 $n = 63$ 个内部点的均匀网格上，使用二阶中心差分来离散化算子 $-u''$，使得网格间距为 $h = 1/(n+1) = 1/64$。这会产生一个线性系统 $A x = b$，其中 $A \\in \\mathbb{R}^{n \\times n}$ 是一个对称正定 (SPD) 的三对角托普利茨矩阵，$A$ 的对角线元素为 $2/h^2$，次对角线和超对角线元素为 $-1/h^2$。\n\n给定矩阵 $A$ 的特征值的粗略、保守的界限：\n- 最小特征值 $\\lambda_{\\min}$ 的下界，即 $\\lambda_{\\min} \\geq 4$；\n- 最大特征值 $\\lambda_{\\max}$ 的上界，即 $\\lambda_{\\max} \\leq 16384$。\n\n对于静态理查森迭代 $x^{k+1} = x^k + \\alpha (b - A x^k)$ 和加权雅可比迭代 $x^{k+1} = x^k + \\omega D^{-1} (b - A x^k)$，其中 $D = \\operatorname{diag}(A)$，请确定参数 $\\alpha$ 和 $\\omega$ 的安全区间，以保证对于所有与给定界限一致的 SPD 矩阵 $A$ 都能收敛。仅使用所提供的界限和矩阵 $A$ 的结构来确定这些区间。\n\n然后，通过计算 $\\omega$（加权雅可比）和 $\\alpha$（理查森）的安全收敛区间的长度之比，来量化和比较这些方法的鲁棒性。将此鲁棒性比较表示为等于以下公式的单个实数\n$$\\text{鲁棒性比率} = \\frac{\\text{ω 的安全区间长度}}{\\text{α 的安全区间长度}}。$$\n将您的最终比率四舍五入到四位有效数字。",
            "solution": "该问题是良定的，且在科学上是合理的。我们开始进行求解。\n\n给定的静态迭代方法的一般形式为 $x^{k+1} = M x^{k} + c$，其中 $M$ 是迭代矩阵。对于任意初始猜测，该方法收敛的充要条件是迭代矩阵的谱半径 $\\rho(M)  1$。\n\n首先，我们分析理查森迭代：$x^{k+1} = x^k + \\alpha (b - A x^k)$。\n这可以重写为 $x^{k+1} = (I - \\alpha A) x^k + \\alpha b$。\n迭代矩阵为 $M_R = I - \\alpha A$。\n由于矩阵 $A$ 是对称正定 (SPD) 的，其特征值（记为 $\\lambda_j$）是正实数。迭代矩阵 $M_R$ 的特征值由 $\\mu_j = 1 - \\alpha \\lambda_j$ 给出。\n收敛条件 $\\rho(M_R)  1$ 要求对于 $A$ 的所有特征值 $\\lambda_j$，都有 $|\\mu_j|  1$。\n这意味着我们必须满足不等式：\n$$ -1  1 - \\alpha \\lambda_j  1 $$\n这个不等式等价于两个独立的不等式：\n1. $1 - \\alpha \\lambda_j  1 \\implies -\\alpha \\lambda_j  0$。由于 $A$ 是 SPD 矩阵，$\\lambda_j > 0$。因此，这表示 $\\alpha > 0$。\n2. $-1  1 - \\alpha \\lambda_j \\implies \\alpha \\lambda_j  2 \\implies \\alpha  \\frac{2}{\\lambda_j}$。\n\n为确保这对所有特征值都成立，$\\alpha$ 必须小于 $2/\\lambda_j$ 的最小值，这对应于最大特征值 $\\lambda_{\\max}$。因此，对于给定的矩阵 $A$，收敛条件是：\n$$ 0  \\alpha  \\frac{2}{\\lambda_{\\max}} $$\n问题要求一个*安全*的 $\\alpha$ 区间，以保证对任何满足所给特征值界限 $\\lambda_{\\max} \\leq 16384$ 的 SPD 矩阵 $A$ 都能收敛。为了保证对所有此类矩阵都收敛，我们必须选择一个 $\\alpha$ 的区间，该区间满足最坏情况下的条件，即 $\\lambda_{\\max}$ 的最大可能值。\n所以，我们必须强制 $0  \\alpha  \\frac{2}{16384}$，化简后为 $0  \\alpha  \\frac{1}{8192}$。\n$\\alpha$ 的安全区间是 $(\\,0, \\frac{1}{8192}\\,)$。该区间的长度为 $L_\\alpha = \\frac{1}{8192}$。\n\n接下来，我们分析加权雅可比迭代：$x^{k+1} = x^k + \\omega D^{-1} (b - A x^k)$。\n迭代矩阵为 $M_{WJ} = I - \\omega D^{-1} A$。\n问题指明矩阵 $A$ 来自有限差分离散化，并且是一个三对角托普利茨矩阵，其对角线元素等于 $2/h^2$。因此，对角矩阵 $D = \\operatorname{diag}(A)$ 由 $D = \\frac{2}{h^2} I$ 给出，其中 $I$ 是单位矩阵。\n我们已知 $h = 1/64$，所以 $h^2 = (1/64)^2 = 1/4096$。\n因此，$D = \\frac{2}{1/4096} I = 8192 I$。\n$D$ 的逆是 $D^{-1} = \\frac{1}{8192} I$。\n将此代入加权雅可比的迭代矩阵中，得到：\n$$ M_{WJ} = I - \\omega \\left(\\frac{1}{8192}\\right) A = I - \\left(\\frac{\\omega}{8192}\\right) A $$\n如果我们设定参数 $\\alpha = \\frac{\\omega}{8192}$，这在数学上与理查森迭代矩阵 $M_R = I - \\alpha A$ 是相同的。\n为理查森方法推导出的收敛条件可以直接应用：\n$$ 0  \\frac{\\omega}{8192}  \\frac{2}{\\lambda_{\\max}} $$\n由于 $8192$ 是正数，我们可以用它乘以该不等式而不改变不等号的方向：\n$$ 0  \\omega  \\frac{16384}{\\lambda_{\\max}} $$\n为了找到 $\\omega$ 的安全区间，我们再次使用最坏情况下的界限 $\\lambda_{\\max} \\leq 16384$。因此，安全条件是：\n$$ 0  \\omega  1 $$\n$\\omega$ 的安全区间是 $(\\,0, 1\\,)$。该区间的长度为 $L_\\omega = 1$。\n\n最后，我们计算鲁棒性比率，其定义为安全收敛区间长度的比值：\n$$ \\text{鲁棒性比率} = \\frac{L_\\omega}{L_\\alpha} = \\frac{1}{1/8192} = 8192 $$\n问题要求将此值四舍五入到四位有效数字。数字 $8192$ 本身就恰好有四位有效数字。",
            "answer": "$$\\boxed{8192}$$"
        },
        {
            "introduction": "尽管定常迭代法在理论上很优美，但它们在求解大规模问题时面临着根本性的效率瓶颈。本练习将引导你使用傅里叶分析这一强大工具，来定量地考察加权雅可比法对不同频率误差分量的阻尼效果。通过计算你会发现，这类方法虽然能快速消除高频（震荡）误差，但对低频（光滑）误差的衰减极其缓慢，且该问题随网格加密而恶化。这个深刻的洞见不仅揭示了定常迭代法作为独立求解器的局限性，也为其作为多重网格法中的“光滑器”奠定了理论基础。",
            "id": "3365941",
            "problem": "考虑将稳态加权雅可比方法应用于二维稳态扩散方程在矩形域上采用齐次狄利克雷边界条件进行标准有限差分离散后产生的线性系统。其控制偏微分方程为 $-\\nabla \\cdot (\\nabla u) = f$，作用于一个长度为 $L_x$ 和 $L_y$ 的矩形域上，使用二阶中心差分在一个均匀张量积网格上进行离散，该网格在 $x$ 方向有 $N_x$ 个内部点，在 $y$ 方向有 $N_y$ 个内部点。令 $h_x = L_x/(N_x+1)$ 和 $h_y = L_y/(N_y+1)$。将得到的线性系统记为 $A u = b$，其中 $A$ 是对应于离散拉普拉斯算子的对称正定矩阵。\n\n加权雅可比方法由迭代更新式 $u^{(k+1)} = u^{(k)} + \\omega D^{-1}(b - A u^{(k)})$ 定义，其中 $D$ 是 $A$ 的对角部分，$\\omega \\in (0,1)$ 是松弛参数。误差迭代为 $e^{(k+1)} = T e^{(k)}$，其中 $T = I - \\omega D^{-1} A$。在适用于均匀网格的傅里叶模态分析背景下，离散正弦变换基在此类网格上对角化了 $A$ 和迭代矩阵 $T$，从而能够通过谱表征来描述每个模态如何被单个雅可比步骤所衰减。\n\n任务：\n- 从中心差分离散和加权雅可比方法的定义出发，推导作用于低频误差分量的单次加权雅可比迭代的阻尼因子的谱估计。使用离散正弦模态基来表示离散算子的特征值，并获得作用于由整数 $p \\in \\{1,\\dots,N_x\\}$ 和 $q \\in \\{1,\\dots,N_y\\}$ 索引的模态的加权雅可比迭代矩阵的特征值的表达式。\n- 将“低频误差分量”定义为由索引为 $p \\in \\{1,2\\}$ 和 $q \\in \\{1,2\\}$ 的模态集合所张成的分量。使用谱估计，确定这些低频模态中的最差情况单步阻尼因子，并计算使这些低频分量的振幅减小 $10^{-6}$ 倍所需的迭代次数。假设初始误差仅存在于低频子空间中，并且迭代次数是使得最差情况阻尼因子的 $k$ 次幂最多为 $10^{-6}$ 的最小整数 $k$。\n- 比较几种拉伸网格配置所需的迭代次数，并利用您的谱估计解释为什么需要多重网格方法来实现网格无关的收敛性。您的解释应定量地联系低频阻尼因子如何依赖于 $N_x$、$N_y$、$L_x$、$L_y$ 和 $\\omega$。\n\n实现一个程序，对每个测试用例执行以下操作：\n- 计算索引为 $p \\in \\{1,2\\}$ 和 $q \\in \\{1,2\\}$ 的低频模态集合的单步加权雅可比阻尼因子。\n- 在这些低频模态中选择最大（最差情况）的阻尼因子。\n- 计算将低频分量减少 $10^{-6}$ 所需的最小整数迭代次数，即，使得最差情况阻尼因子的 $k$ 次幂小于或等于 $10^{-6}$ 的最小 $k$ 值。\n- 以整数形式输出迭代次数。\n\n使用以下参数值的测试套件，以确保覆盖均衡和拉伸的网格以及不同的松弛参数：\n- 测试用例 1（均衡网格，标准松弛）：$N_x = 64$，$N_y = 64$，$L_x = 1$，$L_y = 1$，$\\omega = 2/3$。\n- 测试用例 2（$x$ 方向拉伸）：$N_x = 128$，$N_y = 16$，$L_x = 1$，$L_y = 1$，$\\omega = 2/3$。\n- 测试用例 3（$y$ 方向拉伸）：$N_x = 16$，$N_y = 128$，$L_x = 1$，$L_y = 1$，$\\omega = 2/3$。\n- 测试用例 4（$x$ 方向极度拉伸）：$N_x = 256$，$N_y = 8$，$L_x = 1$，$L_y = 1$，$\\omega = 2/3$。\n- 测试用例 5（均衡网格，更强松弛）：$N_x = 64$，$N_y = 64$，$L_x = 1$，$L_y = 1$，$\\omega = 0.8$。\n\n您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，\"[result1,result2,result3,result4,result5]\"）。每个结果必须是相应测试用例所需的整数迭代次数。不涉及物理单位。如有角度，必须按弧度解释。",
            "solution": "用户提供的问题陈述已经过分析，并被确定为**有效**。它具有科学依据，是适定的、客观的，并包含进行唯一且有意义的求解所需的所有必要信息。\n\n### 步骤 1：离散化与矩阵构建\n\n控制偏微分方程是二维稳态扩散方程：\n$$ -\\nabla^2 u = -\\left(\\frac{\\partial^2 u}{\\partial x^2} + \\frac{\\partial^2 u}{\\partial y^2}\\right) = f(x, y) $$\n该方程作用于一个矩形域 $[0, L_x] \\times [0, L_y]$ 上，并带有齐次狄利克雷边界条件。我们在一个均匀网格上离散化此方程，该网格在 $x$ 和 $y$ 方向上分别有 $N_x$ 和 $N_y$ 个内部点。网格间距为 $h_x = L_x/(N_x+1)$ 和 $h_y = L_y/(N_y+1)$。\n\n对内部网格点 $(x_i, y_j)$ 处的偏导数使用二阶中心差分，我们得到：\n$$ -\\frac{u_{i-1,j} - 2u_{i,j} + u_{i+1,j}}{h_x^2} - \\frac{u_{i,j-1} - 2u_{i,j} + u_{i,j+1}}{h_y^2} = f_{i,j} $$\n整理这些项，得到关于未知数 $u_{i,j}$ 的方程：\n$$ \\left(\\frac{2}{h_x^2} + \\frac{2}{h_y^2}\\right)u_{i,j} - \\frac{1}{h_x^2}u_{i-1,j} - \\frac{1}{h_x^2}u_{i+1,j} - \\frac{1}{h_y^2}u_{i,j-1} - \\frac{1}{h_y^2}u_{i,j+1} = f_{i,j} $$\n针对所有内部点的这个线性方程组可以写成矩阵形式 $A u = b$。矩阵 $A$ 是离散拉普拉斯算子，它是对称且正定的。由于网格均匀且系数恒定，$A$ 的对角元素（构成矩阵 $D$）都相同：\n$$ D_{ii} = d = \\frac{2}{h_x^2} + \\frac{2}{h_y^2} $$\n因此，$D$ 是单位矩阵的一个标量倍数，即 $D = d \\cdot I$。\n\n### 步骤 2：加权雅可比迭代与阻尼因子\n\n加权雅可比方法由以下迭代更新式定义：\n$$ u^{(k+1)} = u^{(k)} + \\omega D^{-1}(b - A u^{(k)}) $$\n其中 $\\omega$ 是一个松弛参数。误差 $e^{(k)} = u - u^{(k)}$ 遵循以下迭代：\n$$ e^{(k+1)} = (I - \\omega D^{-1} A) e^{(k)} = T e^{(k)} $$\n矩阵 $T = I - \\omega D^{-1} A$ 是迭代矩阵。因为 $D = d \\cdot I$，我们可以写出 $T = I - \\frac{\\omega}{d} A$。\n\n收敛速度由 $T$ 的谱半径决定。$T$ 的特征值（记为 $\\mu$）与 $A$ 的特征值（记为 $\\lambda_A$）通过表达式 $\\mu = 1 - \\frac{\\omega}{d} \\lambda_A$ 相关。这些特征值 $\\mu$ 是对应误差特征模态的阻尼因子。\n\n### 步骤 3：离散算子的谱分析\n\n对于给定的问题几何形状和边界条件，离散拉普拉斯算子 $A$ 的特征向量由离散正弦变换基函数给出：\n$$ v^{(p,q)}_{i,j} = \\sin\\left(\\frac{p \\pi i}{N_x+1}\\right) \\sin\\left(\\frac{q \\pi j}{N_y+1}\\right) $$\n对于模态指标 $p \\in \\{1, \\dots, N_x\\}$ 和 $q \\in \\{1, \\dots, N_y\\}$。将离散算子 $A$ 应用于其特征向量 $v^{(p,q)}$，得到特征值 $\\lambda_A^{(p,q)}$：\n$$ \\lambda_A^{(p,q)} = \\frac{4}{h_x^2} \\sin^2\\left(\\frac{p \\pi}{2(N_x+1)}\\right) + \\frac{4}{h_y^2} \\sin^2\\left(\\frac{q \\pi}{2(N_y+1)}\\right) $$\n然后，将 $\\lambda_A^{(p,q)}$ 和 $d$ 代入 $T$ 的特征值表达式，可以找到模态 $(p,q)$ 的阻尼因子 $\\mu^{(p,q)}$：\n$$ \\mu^{(p,q)} = 1 - \\frac{\\omega}{d} \\lambda_A^{(p,q)} = 1 - \\omega \\frac{\\frac{4}{h_x^2} \\sin^2\\left(\\frac{p \\pi}{2(N_x+1)}\\right) + \\frac{4}{h_y^2} \\sin^2\\left(\\frac{q \\pi}{2(N_y+1)}\\right)}{\\frac{2}{h_x^2} + \\frac{2}{h_y^2}} $$\n$$ \\mu^{(p,q)} = 1 - 2\\omega \\frac{\\frac{1}{h_x^2} \\sin^2\\left(\\frac{p \\pi}{2(N_x+1)}\\right) + \\frac{1}{h_y^2} \\sin^2\\left(\\frac{q \\pi}{2(N_y+1)}\\right)}{\\frac{1}{h_x^2} + \\frac{1}{h_y^2}} $$\n这是单次加权雅可比迭代的阻尼因子的谱估计。\n\n### 步骤 4：低频模态分析\n\n问题将“低频误差分量”定义为对应于模态指标 $p \\in \\{1, 2\\}$ 和 $q \\in \\{1, 2\\}$ 的分量。这些模态中最差（最慢）的阻尼因子是绝对值最大的那个。由于 $\\omega \\in (0, 1)$ 且对于这些模态，正弦函数的参数很小，因此从 1 中减去的项是小的正数。因此，所有四个阻尼因子 $\\mu^{(1,1)}, \\mu^{(1,2)}, \\mu^{(2,1)}, \\mu^{(2,2)}$ 都将是接近 1 的正数。最差情况的因子因此是这四个值的最大值：\n$$ \\mu_{lf,max} = \\max_{p,q \\in \\{1,2\\}} \\left\\{ \\mu^{(p,q)} \\right\\} $$\n由于 $\\sin^2(x)$ 对于 $x \\in [0, \\pi/2]$ 是一个增函数，因此对于最小的模态指标 $(p,q)=(1,1)$，从 1 中减去的项最小。因此，$\\mu_{lf,max} = \\mu^{(1,1)}$。\n\n### 步骤 5：迭代次数计算\n\n我们需要找到将误差分量减少 $10^{-6}$ 倍所需的最小整数迭代次数 $k$。这表示为：\n$$ (\\mu_{lf,max})^k \\leq 10^{-6} $$\n对两边取以 10 为底的对数：\n$$ k \\log_{10}(\\mu_{lf,max}) \\leq -6 $$\n由于 $\\mu_{lf,max}  1$，其对数为负。用它相除会反转不等号：\n$$ k \\geq \\frac{-6}{\\log_{10}(\\mu_{lf,max})} $$\n满足此条件的最小整数 $k$ 是右侧表达式向上取整的值：\n$$ k = \\left\\lceil \\frac{-6}{\\log_{10}(\\mu_{lf,max})} \\right\\rceil $$\n\n### 步骤 6：多重网格方法的原理\n\n该分析揭示了像加权雅可比法这类简单迭代方法的基本缺陷。对于低频模态，阻尼因子 $\\mu^{(1,1)}$ 非常接近 1，表明收敛极其缓慢。为了定量地看到这一点，我们对小 $x$ 使用近似 $\\sin(x) \\approx x$。对于具有 $N_x=N_y=N$ 和 $L_x=L_y=L$（意味着 $h_x=h_y=h=L/(N+1)$）的均匀网格，最平滑模态的阻尼因子为：\n$$ \\mu^{(1,1)} = 1 - 2\\omega \\sin^2\\left(\\frac{\\pi}{2(N+1)}\\right) \\approx 1 - 2\\omega\\left(\\frac{\\pi}{2(N+1)}\\right)^2 = 1 - \\frac{\\omega\\pi^2}{2(N+1)^2} = 1 - O(h^2) $$\n随着网格的加密（$N \\to \\infty$ 或 $h \\to 0$），阻尼因子趋近于 1。可以使用 $\\log(1-x) \\approx -x$ 来近似迭代次数 $k$：\n$$ k \\approx \\frac{-6 \\ln(10)}{\\ln(1 - O(h^2))} \\approx \\frac{6 \\ln(10)}{O(h^2)} = O(h^{-2}) = O(N^2) $$\n为达到固定的误差减小量所需的迭代次数与 $N^2$ 成比例。由于每次迭代的计算量与网格点数成正比（$O(N^2)$），求解系统的总工作量与 $O(N^4)$ 成比例。这种网格相关的收敛性（即在更细的网格上收敛率恶化）使得简单迭代方法对于大规模问题不切实际。\n\n测试用例说明了这一点。对于案例 1 中的均衡网格（$N=64$），$k \\approx 1.8 \\times 10^4$。对于案例 2 中的拉伸网格（$N_x=128$），有效网格尺寸在一个方向上加倍，迭代次数也加倍到 $k \\approx 3.6 \\times 10^4$，这与基于最小网格间距的 $O(N^2)$ 缩放行为一致。案例 4（$N_x=256$）进一步证明了这一点，其中 $k \\approx 1.4 \\times 10^5$。\n\n多重网格方法可以规避这个问题。它们使用一个网格层级。在细网格上，像雅可比法这样的迭代方法（用作“光滑子”）能有效衰减高频误差分量，但对低频分量效果很差。多重网格将平滑的低频误差转移到更粗的网格上，在那里它相对于该网格的间距表现为频率更高、更振荡的误差。然后它可以在粗网格上被有效地衰减。通过在网格之间循环，多重网格方法能有效衰减所有频率的误差分量，实现几乎与网格尺寸 $N$ 无关的收敛率。这使得总工作量达到最优的 $O(N^2)$，使多重网格成为高效求解此类基于偏微分方程的线性系统的必要工具。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the number of weighted Jacobi iterations required to damp\n    low-frequency error components by a factor of 10^-6 for several\n    test cases of a 2D discretized diffusion problem.\n    \"\"\"\n    test_cases = [\n        # (Nx, Ny, Lx, Ly, omega)\n        (64, 64, 1, 1, 2/3),\n        (128, 16, 1, 1, 2/3),\n        (16, 128, 1, 1, 2/3),\n        (256, 8, 1, 1, 2/3),\n        (64, 64, 1, 1, 0.8),\n    ]\n\n    results = []\n    for case in test_cases:\n        Nx, Ny, Lx, Ly, omega = case\n        \n        # Calculate grid spacings\n        hx = Lx / (Nx + 1)\n        hy = Ly / (Ny + 1)\n        \n        # Calculate the diagonal term 'd' of the matrix A scaled by 1/2 for\n        # convenience, as it appears in the denominator of the damping factor formula.\n        denominator = 1/hx**2 + 1/hy**2\n        \n        damping_factors = []\n        low_freq_modes = [(1, 1), (1, 2), (2, 1), (2, 2)]\n        \n        for p, q in low_freq_modes:\n            # Calculate the two terms in the numerator of the damping factor formula.\n            # These correspond to the eigenvalues of the 1D Laplacian operators.\n            term_x = (1/hx**2) * np.sin(p * np.pi / (2 * (Nx + 1)))**2\n            term_y = (1/hy**2) * np.sin(q * np.pi / (2 * (Ny + 1)))**2\n            \n            numerator = term_x + term_y\n            \n            # The damping factor (eigenvalue of the iteration matrix T) for mode (p,q).\n            mu_pq = 1.0 - 2.0 * omega * numerator / denominator\n            damping_factors.append(mu_pq)\n            \n        # The worst-case damping factor for low frequencies is the one closest to 1.\n        # For this problem, the slowest converging mode is (1,1), which has the largest\n        # damping factor (closest to 1). So we take the max of the computed factors.\n        mu_lf_max = np.max(damping_factors)\n        \n        # Calculate the number of iterations k such that (mu_lf_max)^k = 10^-6.\n        # k >= -6 / log10(mu_lf_max). We take the ceiling to get the smallest integer k.\n        # A check for mu_lf_max >= 1 prevents log of non-positive numbers in edge cases.\n        if mu_lf_max >= 1.0:\n            # This would mean the iteration is non-convergent for this mode.\n            # We can represent this with a large number or an indicator.\n            # For this problem, it is not expected.\n            k = np.inf\n        else:\n            k = np.ceil(-6.0 / np.log10(mu_lf_max))\n        \n        results.append(int(k))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}