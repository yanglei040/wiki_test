{
    "hands_on_practices": [
        {
            "introduction": "要真正掌握共轭梯度法，最好的方法就是亲手计算一遍。这个练习将引导您从第一性原理出发，处理一个简单的对角系统，计算初始迭代步骤中的所有关键量。通过显式验证搜索方向的 $A$-共轭性 ，您将对该方法为何如此高效建立起深刻的直觉。",
            "id": "3371638",
            "problem": "考虑一个源于计算流体动力学 (CFD) 的线性系统，其中一个预条件扩散算子的局部对角块被建模为一个对称正定 (SPD) 矩阵。设二次泛函为 $f(x) = \\frac{1}{2} x^{T} A x - b^{T} x$，其中 $A = \\mathrm{diag}(1, 2, 3)$，$b = (1, 1, 1)^{T}$，初始猜测值为 $x_{0} = (0, 0, 0)^{T}$。从第一性原理出发——即通过最速下降法确定初始方向以最小化 $f(x)$，并对后续方向强制施加 $A$-共轭条件——执行以下操作：\n\n1. 应用于 $f(x)$ 的最速下降原理，计算初始残差 $r_{0}$ 和第一个搜索方向 $p_{0}$。\n2. 沿着 $p_{0}$ 方向通过精确线搜索确定步长 $\\alpha_{0}$，更新 $x_{1}$ 并计算新的残差 $r_{1}$。\n3. 通过在搜索方向之间强制施加 $A$-共轭条件来确定标量 $\\beta_{0}$，并据此构造 $p_{1}$。\n4. 明确验证 $p_{0}^{T} A p_{1} = 0$。\n\n将 $p_{0}^{T} A p_{1}$ 的值作为你的最终答案。无需四舍五入。将最终答案表示为不带单位的纯数字。",
            "solution": "该问题被验证为具有科学依据、良态、客观和完整。这是共轭梯度算法初始步骤的一个标准应用，该算法是求解线性系统的数值方法的基石，尤其是在计算流体动力学 (CFD) 等领域。所提供的矩阵 $A$ 是对称的，其特征值为对角线元素 $1$、$2$ 和 $3$，它们都是正数。因此，如题所述，$A$ 是对称正定 (SPD) 的，这确保了问题的良态性。我们可以开始求解。\n\n该问题要求从第一性原理出发，执行共轭梯度法的第一步迭代。目标是找到二次泛函 $f(x) = \\frac{1}{2} x^{T} A x - b^{T} x$ 的最小值。$f(x)$ 的最小化子是线性系统 $Ax = b$ 的解。该泛函的梯度是 $\\nabla f(x) = Ax - b$。系统的残差定义为 $r(x) = b - Ax$。因此，残差是负梯度，即 $r(x) = -\\nabla f(x)$，所以它指向 $f(x)$ 的最速下降方向。\n\n给定的数据是：\n矩阵 $A = \\begin{pmatrix} 1  0  0 \\\\ 0  2  0 \\\\ 0  0  3 \\end{pmatrix}$。\n向量 $b = \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix}$。\n初始猜测值 $x_{0} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}$。\n\n我们遵循要求的步骤。\n\n1.  计算初始残差 $r_{0}$ 和第一个搜索方向 $p_{0}$。\n\n初始残差 $r_0$ 是在初始猜测值 $x_0$ 处计算的：\n$$r_{0} = b - A x_{0}$$\n代入给定值：\n$$r_{0} = \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} - \\begin{pmatrix} 1  0  0 \\\\ 0  2  0 \\\\ 0  0  3 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} - \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix}$$\n在共轭梯度法中，第一个搜索方向 $p_0$ 取为最速下降方向，也就是初始残差 $r_0$：\n$$p_{0} = r_{0} = \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix}$$\n\n2.  确定步长 $\\alpha_{0}$，更新 $x_{1}$，并计算新的残差 $r_{1}$。\n\n下一个迭代值由 $x_{1} = x_{0} + \\alpha_{0} p_{0}$ 给出。最优步长 $\\alpha_0$ 是通过最小化 $f(x_1)$ 关于 $\\alpha_0$ 的值找到的。这是一个精确线搜索。我们将 $f(x_0 + \\alpha p_0)$ 关于 $\\alpha$ 的导数设为零。\n$$\\frac{d}{d\\alpha} f(x_{0} + \\alpha p_{0}) = \\nabla f(x_{0} + \\alpha p_{0})^{T} p_{0} = 0$$\n使用 $\\nabla f(x) = Ax - b$，我们得到：\n$$(A(x_{0} + \\alpha_{0} p_{0}) - b)^{T} p_{0} = 0$$\n$$(A x_{0} - b + \\alpha_{0} A p_{0})^{T} p_{0} = 0$$\n因为 $r_0 = b - Ax_0$ 且 $p_0 = r_0$：\n$$(-r_{0} + \\alpha_{0} A p_{0})^{T} p_{0} = 0$$\n$$-r_{0}^{T} p_{0} + \\alpha_{0} p_{0}^{T} A p_{0} = 0$$\n求解 $\\alpha_0$：\n$$\\alpha_{0} = \\frac{r_{0}^{T} p_{0}}{p_{0}^{T} A p_{0}}$$\n由于 $p_0=r_0$，这可以简化为：\n$$\\alpha_{0} = \\frac{r_{0}^{T} r_{0}}{r_{0}^{T} A r_{0}}$$\n我们计算所需的点积：\n$$r_{0}^{T} r_{0} = \\begin{pmatrix} 1  1  1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} = 1 \\cdot 1 + 1 \\cdot 1 + 1 \\cdot 1 = 3$$\n$$A r_{0} = \\begin{pmatrix} 1  0  0 \\\\ 0  2  0 \\\\ 0  0  3 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\end{pmatrix}$$\n$$r_{0}^{T} A r_{0} = \\begin{pmatrix} 1  1  1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\end{pmatrix} = 1 \\cdot 1 + 1 \\cdot 2 + 1 \\cdot 3 = 6$$\n步长是：\n$$\\alpha_{0} = \\frac{3}{6} = \\frac{1}{2}$$\n现在我们更新解向量 $x_1$：\n$$x_{1} = x_{0} + \\alpha_{0} p_{0} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} + \\frac{1}{2} \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{2} \\\\ \\frac{1}{2} \\\\ \\frac{1}{2} \\end{pmatrix}$$\n并计算新的残差 $r_1$：\n$$r_{1} = b - A x_{1} = \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} - \\begin{pmatrix} 1  0  0 \\\\ 0  2  0 \\\\ 0  0  3 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{2} \\\\ \\frac{1}{2} \\\\ \\frac{1}{2} \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} - \\begin{pmatrix} \\frac{1}{2} \\\\ 1 \\\\ \\frac{3}{2} \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{2} \\\\ 0 \\\\ -\\frac{1}{2} \\end{pmatrix}$$\n\n3.  确定标量 $\\beta_{0}$ 并构造 $p_{1}$。\n\n下一个搜索方向 $p_1$ 是新残差 $r_1$ 和前一个搜索方向 $p_0$ 的线性组合：\n$$p_{1} = r_{1} + \\beta_{0} p_{0}$$\n选择标量 $\\beta_0$ 以强制 $p_1$ 和 $p_0$ 之间满足 $A$-共轭（也称为 $A$-正交）条件，即 $p_{0}^{T} A p_{1} = 0$：\n$$p_{0}^{T} A (r_{1} + \\beta_{0} p_{0}) = 0$$\n$$p_{0}^{T} A r_{1} + \\beta_{0} p_{0}^{T} A p_{0} = 0$$\n求解 $\\beta_0$：\n$$\\beta_{0} = - \\frac{p_{0}^{T} A r_{1}}{p_{0}^{T} A p_{0}}$$\n由于 A 是对称的，$p_{0}^{T} A r_{1} = (A p_{0})^{T} r_{1}$。\n分母先前已计算过：$p_{0}^{T} A p_{0} = r_{0}^{T} A r_{0} = 6$。\n我们计算分子：\n$$A p_{0} = A r_0 = \\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\end{pmatrix}$$\n$$(A p_{0})^{T} r_{1} = \\begin{pmatrix} 1  2  3 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{2} \\\\ 0 \\\\ -\\frac{1}{2} \\end{pmatrix} = 1 \\cdot \\frac{1}{2} + 2 \\cdot 0 + 3 \\cdot \\left(-\\frac{1}{2}\\right) = \\frac{1}{2} - \\frac{3}{2} = -1$$\n因此，我们求得 $\\beta_0$：\n$$\\beta_{0} = - \\frac{-1}{6} = \\frac{1}{6}$$\n现在我们构造新的搜索方向 $p_1$：\n$$p_{1} = r_{1} + \\beta_{0} p_{0} = \\begin{pmatrix} \\frac{1}{2} \\\\ 0 \\\\ -\\frac{1}{2} \\end{pmatrix} + \\frac{1}{6} \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{2} + \\frac{1}{6} \\\\ 0 + \\frac{1}{6} \\\\ -\\frac{1}{2} + \\frac{1}{6} \\end{pmatrix} = \\begin{pmatrix} \\frac{3+1}{6} \\\\ \\frac{1}{6} \\\\ \\frac{-3+1}{6} \\end{pmatrix} = \\begin{pmatrix} \\frac{4}{6} \\\\ \\frac{1}{6} \\\\ -\\frac{2}{6} \\end{pmatrix} = \\begin{pmatrix} \\frac{2}{3} \\\\ \\frac{1}{6} \\\\ -\\frac{1}{3} \\end{pmatrix}$$\n\n4.  明确验证 $p_{0}^{T} A p_{1} = 0$。\n\n这最后一步确认了我们计算的 $\\beta_0$ 值正确地施加了 $A$-共轭性。我们用已求得的向量直接进行计算。\n$$p_{0} = \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} \\quad \\text{和} \\quad p_{1} = \\begin{pmatrix} \\frac{2}{3} \\\\ \\frac{1}{6} \\\\ -\\frac{1}{3} \\end{pmatrix}$$\n首先，计算 $A p_1$：\n$$A p_{1} = \\begin{pmatrix} 1  0  0 \\\\ 0  2  0 \\\\ 0  0  3 \\end{pmatrix} \\begin{pmatrix} \\frac{2}{3} \\\\ \\frac{1}{6} \\\\ -\\frac{1}{3} \\end{pmatrix} = \\begin{pmatrix} 1 \\cdot \\frac{2}{3} \\\\ 2 \\cdot \\frac{1}{6} \\\\ 3 \\cdot (-\\frac{1}{3}) \\end{pmatrix} = \\begin{pmatrix} \\frac{2}{3} \\\\ \\frac{2}{6} \\\\ -1 \\end{pmatrix} = \\begin{pmatrix} \\frac{2}{3} \\\\ \\frac{1}{3} \\\\ -1 \\end{pmatrix}$$\n现在，计算点积 $p_0^T (A p_1)$：\n$$p_{0}^{T} A p_{1} = \\begin{pmatrix} 1  1  1 \\end{pmatrix} \\begin{pmatrix} \\frac{2}{3} \\\\ \\frac{1}{3} \\\\ -1 \\end{pmatrix} = 1 \\cdot \\frac{2}{3} + 1 \\cdot \\frac{1}{3} + 1 \\cdot (-1) = \\frac{2}{3} + \\frac{1}{3} - 1 = \\frac{3}{3} - 1 = 1 - 1 = 0$$\n计算证实了 $p_0$ 和 $p_1$ 是 $A$-共轭的。表达式 $p_{0}^{T} A p_{1}$ 的值恰好为 $0$。",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "在计算流体动力学中，预估求解器所需的计算成本至关重要。这个练习将理论与实践联系起来，利用矩阵的谱条件数 $\\kappa(A)$ 来预测收敛速度。通过应用共轭梯度法的标准误差界 ，您将学会如何估算达到期望精度所需的迭代次数，这是一项在处理大规模问题时非常有价值的技能。",
            "id": "3371645",
            "problem": "考虑一个对称正定线性系统 $A x = b$，该系统源于在均匀网格上对不可压缩流中的稳态压力泊松方程进行以单元为中心的有限体积离散化，其中 $A \\in \\mathbb{R}^{n \\times n}$ 是对称正定矩阵，其谱条件数 $\\kappa(A)$ 定义为 $\\kappa(A) = \\lambda_{\\max}(A)/\\lambda_{\\min}(A)$。共轭梯度法（CG）在精确算术且无预处理的条件下应用于此系统。假设已知谱条件数为 $\\kappa(A) = 10^{4}$。使用共轭梯度法在 $A$-范数下关于 $\\kappa(A)$ 的标准最坏情况误差界，确定最小的整数迭代次数 $k$，使得该界保证从任意初始误差开始，$A$-范数误差缩减因子最多为 $10^{-6}$。将您的最终迭代次数表示为一个不带单位的整数。",
            "solution": "本题要求确定共轭梯度法（CG）对线性系统 $A x = b$ 保证达到指定误差缩减所需的最小整数迭代次数，记为 $k$。给定矩阵 $A \\in \\mathbb{R}^{n \\times n}$ 是对称正定的。此分析依赖于 CG 方法的标准最坏情况收敛界。\n\n第 $k$ 次迭代的误差定义为 $e_k = x_k - x$，其中 $x_k$ 是第 $k$ 次迭代的近似解，$x$ 是精确解。误差在 $A$-范数下度量，对于任意向量 $v \\in \\mathbb{R}^n$，A-范数定义为 $\\|v\\|_A = \\sqrt{v^T A v}$。CG 方法经过 $k$ 次迭代后，$A$-范数下相对误差缩减的经典上界由以下不等式给出：\n$$ \\frac{\\|e_k\\|_A}{\\|e_0\\|_A} \\leq 2 \\left( \\frac{\\sqrt{\\kappa(A)} - 1}{\\sqrt{\\kappa(A)} + 1} \\right)^k $$\n其中 $e_0$ 是初始误差，$\\kappa(A)$ 是矩阵 $A$ 的谱条件数，定义为其最大特征值与最小特征值之比，即 $\\kappa(A) = \\lambda_{\\max}(A) / \\lambda_{\\min}(A)$。\n\n题目提供了以下数据：\n1. 谱条件数为 $\\kappa(A) = 10^4$。\n2. 期望的误差缩减因子最多为 $10^{-6}$。这意味着我们寻求最小的 $k$，使得误差比的上界小于或等于此值：$\\frac{\\|e_k\\|_A}{\\|e_0\\|_A} \\leq 10^{-6}$。\n\n我们必须找到满足不等式的最小整数 $k$，当理论界的右侧受所需缩减因子约束时：\n$$ 2 \\left( \\frac{\\sqrt{\\kappa(A)} - 1}{\\sqrt{\\kappa(A)} + 1} \\right)^k \\leq 10^{-6} $$\n我们代入给定的值 $\\kappa(A) = 10^4$。首先，我们计算条件数的平方根：\n$$ \\sqrt{\\kappa(A)} = \\sqrt{10^4} = 10^2 = 100 $$\n将此值代入不等式，得到：\n$$ 2 \\left( \\frac{100 - 1}{100 + 1} \\right)^k \\leq 10^{-6} $$\n$$ 2 \\left( \\frac{99}{101} \\right)^k \\leq 10^{-6} $$\n为了求解整数 $k$，我们首先分离出以 $k$ 为幂的项：\n$$ \\left( \\frac{99}{101} \\right)^k \\leq \\frac{1}{2} \\times 10^{-6} $$\n接下来，我们对不等式两边取自然对数。由于自然对数 $\\ln(x)$ 对于 $x  0$ 是一个单调递增函数，不等号的方向保持不变：\n$$ \\ln\\left[ \\left( \\frac{99}{101} \\right)^k \\right] \\leq \\ln\\left( \\frac{1}{2} \\times 10^{-6} \\right) $$\n使用对数性质 $\\ln(a^b) = b \\ln(a)$，我们得到：\n$$ k \\ln\\left( \\frac{99}{101} \\right) \\leq \\ln\\left( \\frac{1}{2} \\right) + \\ln(10^{-6}) $$\n$$ k \\ln\\left( \\frac{99}{101} \\right) \\leq -\\ln(2) - 6 \\ln(10) $$\n项 $\\ln(99/101)$ 是负数，因为其参数 $99/101$ 小于 $1$。因此，当我们除以 $\\ln(99/101)$ 来分离 $k$ 时，我们必须反转不等号的方向：\n$$ k \\geq \\frac{-\\ln(2) - 6 \\ln(10)}{\\ln(99/101)} $$\n为了方便计算，可以将分子和分母同乘以 $-1$ 并使用性质 $-\\ln(x/y) = \\ln(y/x)$ 来简化此表达式：\n$$ k \\geq \\frac{\\ln(2) + 6 \\ln(10)}{\\ln(101/99)} $$\n为了求出 $k$ 的这个下界的数值，我们使用自然对数的标准值：$\\ln(2) \\approx 0.693147$ 和 $\\ln(10) \\approx 2.302585$。\n分子为：\n$$ \\ln(2) + 6 \\ln(10) \\approx 0.693147 + 6 \\times (2.302585) = 0.693147 + 13.81551 = 14.508657 $$\n分母为：\n$$ \\ln\\left(\\frac{101}{99}\\right) = \\ln(101) - \\ln(99) \\approx 4.6151205 - 4.5951198 = 0.0200007 $$\n现在，我们计算比率：\n$$ k \\geq \\frac{14.508657}{0.0200007} \\approx 725.409 $$\n迭代次数 $k$ 必须是整数。不等式 $k \\geq 725.409$ 要求我们找到满足此条件的最小整数。这可以通过对该数值上取整得到：\n$$ k = \\lceil 725.409 \\rceil = 726 $$\n因此，最坏情况界要保证误差缩减最多为 $10^{-6}$，至少需要 $726$ 次迭代。",
            "answer": "$$\\boxed{726}$$"
        },
        {
            "introduction": "当我们我们将共轭梯度法应用于实际问题时，预处理是必不可少的，但它也带来了新的复杂性。这个练习探讨了一个高级但至关重要的概念：如何正确评估收敛性 。通过分析预处理残差范数可能产生误导的场景，您将学会批判性地思考停止准则的选择，避免在实际应用中过早地终止计算。",
            "id": "3371613",
            "problem": "在计算流体力学中，当离散化椭圆算子（如压力泊松方程）时，会出现用于求解对称正定（SPD）线性系统的共轭梯度（CG）求解器。考虑不可压缩流压力修正的典型模型问题，即在具有齐次狄利克雷边界条件的矩形域上的压力泊松方程，由 $-\\nabla^{2} p = f$ 给出。在间距为 $h_x$ 和 $h_y$ 的均匀笛卡尔网格上进行标准的二阶中心有限差分离散，会得到一个具有五点模板的 SPD 线性系统 $A p = b$；对于一个内部节点，其对角元满足 $A_{ii} = 2\\left(h_x^{-2} + h_y^{-2}\\right)$，坐标方向上的非对角元为 $-h_x^{-2}$ 和 $-h_y^{-2}$。对于 $A p = b$，使用左预处理器 $M$（SPD）的预处理共轭梯度（PCG）方法会生成迭代解 $p_k$ 和残差 $r_k = b - A p_k$。一个常用的诊断量是预处理残差的欧几里得范数，即 $\\|M^{-1} r_k\\|_2$。\n\n仅从这些基本事实以及残差和预处理的定义出发，构建并评估一些场景，在这些场景中，预处理残差范数 $\\|M^{-1} r_k\\|_2$ 可能具有欺骗性地小，而真实残差范数 $\\|r_k\\|_2$ 却仍然大到不可接受。特别地，利用离散化算子的缩放、残差的定义以及算子范数不等式（如 $\\|M^{-1} r\\|_2 \\le \\|M^{-1}\\|_2 \\|r\\|_2$ 和 $r = M (M^{-1} r)$ 意味着 $\\|r\\|_2 \\le \\|M\\|_2 \\|M^{-1} r\\|_2$）从第一性原理进行推理。除了已说明的，不要假设任何特定的停止准则；相反，应检验 $\\|M^{-1} r_k\\|_2$ 的绝对阈值如何可能错误地表示收敛状态。\n\n下列哪个选项正确地构建了这样一个场景，并正确地解释了为什么基于 $\\|M^{-1} r_k\\|_2$ 的小绝对值的简单停止准则可能会产生误导？选择所有适用项。\n\nA. 对于五点拉普拉斯算子，在 $x$ 方向上使用各向异性拉伸网格，其中 $h_x = 10^{-3}$ 且 $h_y = 1$，并使用 Jacobi 预处理器 $M = \\mathrm{diag}(A)$。假设在某次迭代 $k$ 中，残差 $r_k$ 集中在单个内部节点上，其大小为 $\\|r_k\\|_2 \\approx 10^{3}$。那么 $M_{ii} \\approx 2\\left(h_x^{-2} + h_y^{-2}\\right) \\approx 2 \\cdot 10^{6}$，因此 $M^{-1} r_k$ 的相应分量被大约 $1/M_{ii}$ 缩小，得到 $\\|M^{-1} r_k\\|_2 \\approx 5 \\cdot 10^{-4}$，尽管 $\\|r_k\\|_2 \\approx 10^{3}$。基于 $\\|M^{-1} r_k\\|_2$ 的绝对阈值停止会过早地宣布收敛，尽管真实残差很大。\n\nB. 对于任何 SPD 预处理器 $M$，量 $\\|M^{-1} r_k\\|_2$ 都是 $\\|r_k\\|_2$ 的单调递减且可靠的替代指标，因此当 $\\|M^{-1} r_k\\|_2$ 很小时停止不会产生误导。\n\nC. 在 SPD 系统的左预处理下，A-能量范数下的真实误差 $\\|p_k - p_\\star\\|_{A} = \\sqrt{(p_k - p_\\star)^{\\top} A (p_k - p_\\star)}$ 总是满足形式为 $\\|p_k - p_\\star\\|_{A} \\le C \\|M^{-1} r_k\\|_2$ 的界，其中常数 $C$ 与 $M$ 无关，因此小的 $\\|M^{-1} r_k\\|_2$ 始终是收敛的可靠指标。\n\nD. 考虑一个极端但与 SPD 一致的选择 $A = I$（例如，在无量纲化和局部解耦子问题中的严格对角占优之后出现），并使用对角 SPD 预处理器 $M = \\mathrm{diag}(10^{6}, 1, \\dots, 1)$。从 $p_0 = 0$ 开始并取 $b = r_0 = 10^{3} e_1$ 会得到 $\\|r_0\\|_2 = 10^{3}$，而 $\\|M^{-1} r_0\\|_2 = 10^{-3}$。预处理器对第一个分量进行了如此强烈的重新缩放，以至于对 $\\|M^{-1} r_k\\|_2$ 的绝对停止测试会接受一个具有很大真实残差的解。",
            "solution": "用户希望在预处理共轭梯度（PCG）方法的背景下，对真实残差范数和预处理残差范数之间的关系进行批判性分析。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n\n-   **控制方程：** 在具有齐次狄利克雷边界条件的矩形域上的压力泊松方程 $-\\nabla^{2} p = f$。\n-   **离散化方法：** 在间距为 $h_x$ 和 $h_y$ 的均匀笛卡尔网格上的标准二阶中心有限差分。\n-   **线性系统：** 一个 SPD 线性系统 $A p = b$。\n-   **矩阵属性：** 对于内部节点 $i$，对角元为 $A_{ii} = 2\\left(h_x^{-2} + h_y^{-2}\\right)$，非对角元为 $-h_x^{-2}$ 和 $-h_y^{-2}$（五点模板）。\n-   **数值方法：** 使用左预处理器 $M$（SPD）的预处理共轭梯度（PCG）。\n-   **定义：** 迭代解为 $p_k$。残差为 $r_k = b - A p_k$。\n-   **收敛诊断：** 预处理残差的欧几里得范数 $\\|M^{-1} r_k\\|_2$。\n-   **核心任务：** 构建并评估 $\\|M^{-1} r_k\\|_2$ 具有欺骗性地小而真实残差范数 $\\|r_k\\|_2$ 仍然很大的场景。\n-   **分析工具：** 使用算子的缩放、残差的定义以及算子范数不等式 $\\|M^{-1} r\\|_2 \\le \\|M^{-1}\\|_2 \\|r\\|_2$ 和 $\\|r\\|_2 \\le \\|M\\|_2 \\|M^{-1} r\\|_2$。\n-   **约束：** 检验 $\\|M^{-1} r_k\\|_2$ 的绝对阈值如何可能产生误导。\n\n**步骤 2：使用提取的已知条件进行验证**\n\n-   **科学依据：** 问题陈述牢固地植根于求解偏微分方程的数值线性代数的标准理论和实践中。压力泊松方程、有限差分离散、由此产生的 SPD 矩阵结构以及 PCG 方法都是计算科学与工程中的经典课题。\n-   **适定性：** 作为一个概念分析任务，该问题是适定的。它要求基于一个明确定义的理论框架和数学关系来评估特定场景。基于这些原则，可以对每个选项得出明确的结论。\n-   **客观性：** 问题以精确、客观和技术性的语言陈述，没有歧义或主观性陈述。\n\n问题陈述内部一致、科学上合理且适定。未检测到任何缺陷。\n\n**步骤 3：结论和行动**\n\n问题有效。将继续进行求解过程。\n\n### 推导与选项分析\n\n问题的核心在于真实残差范数 $\\|r_k\\|_2$ 与预处理残差范数 $\\|M^{-1} r_k\\|_2$ 之间的关系。这两个量通过 SPD 预处理器 $M$ 相关联。根据定义，$r_k = M(M^{-1} r_k)$。应用诱导矩阵范数的性质，我们可以建立界限：\n$$\n\\|r_k\\|_2 = \\|M(M^{-1} r_k)\\|_2 \\le \\|M\\|_2 \\|M^{-1} r_k\\|_2\n$$\n$$\n\\|M^{-1} r_k\\|_2 \\le \\|M^{-1}\\|_2 \\|r_k\\|_2\n$$\n从第一个不等式可以明显看出，如果预处理器的谱范数 $\\|M\\|_2 = \\lambda_{\\max}(M)$ 很大，那么 $\\|r_k\\|_2$ 可能远大于 $\\|M^{-1} r_k\\|_2$。当 $\\|M\\|_2 \\gg 1$ 时，会出现“欺骗性地小”的预处理残差范数。在这种情况下，$\\|M^{-1} r_k\\|_2$ 的小值并不能保证 $\\|r_k\\|_2$ 的小值。基于 $\\|M^{-1} r_k\\|_2$ 绝对容差的停止准则变得不可靠，因为它忽略了 $M$ 的缩放效应。一个更稳健的停止准则会涉及相对范数，例如 $\\|M^{-1} r_k\\|_2 \\le \\text{tol} \\cdot \\|M^{-1} r_0\\|_2$，或者直接监控真实残差范数（会带来额外的计算成本）。\n\n我们现在基于此原则评估每个选项。\n\n**A. 对于五点拉普拉斯算子，在 $x$ 方向上使用各向异性拉伸网格，其中 $h_x = 10^{-3}$ 且 $h_y = 1$，并使用 Jacobi 预处理器 $M = \\mathrm{diag}(A)$。假设在某次迭代 $k$ 中，残差 $r_k$ 集中在单个内部节点上，其大小为 $\\|r_k\\|_2 \\approx 10^{3}$。那么 $M_{ii} \\approx 2\\left(h_x^{-2} + h_y^{-2}\\right) \\approx 2 \\cdot 10^{6}$，因此 $M^{-1} r_k$ 的相应分量被大约 $1/M_{ii}$ 缩小，得到 $\\|M^{-1} r_k\\|_2 \\approx 5 \\cdot 10^{-4}$，尽管 $\\|r_k\\|_2 \\approx 10^{3}$。基于 $\\|M^{-1} r_k\\|_2$ 的绝对阈值停止会过早地宣布收敛，尽管真实残差很大。**\n\nJacobi 预处理器定义为 $M = \\mathrm{diag}(A)$。对于内部节点 $i$，$A$ 的对角元由 $A_{ii} = 2(h_x^{-2} + h_y^{-2})$ 给出。\n使用给定的网格间距 $h_x = 10^{-3}$ 和 $h_y = 1$，我们有：\n$$\nA_{ii} = 2 \\left( (10^{-3})^{-2} + 1^{-2} \\right) = 2(10^6 + 1) \\approx 2 \\cdot 10^6\n$$\n预处理器 $M$ 是一个对角线上具有这些大值的对角矩阵。因此，它的逆 $M^{-1}$ 是一个对角矩阵，其元素为 $M^{-1}_{ii} = 1/A_{ii} \\approx 1/(2 \\cdot 10^6) = 5 \\cdot 10^{-7}$。\n该场景假设残差 $r_k$ 集中在单个节点（比如节点 $j$）上，使得 $\\|r_k\\|_2 \\approx 10^3$。这意味着 $r_k \\approx 10^3 e_j$，其中 $e_j$ 是标准基向量。\n预处理残差为 $M^{-1} r_k$。由于 $M^{-1}$ 和 $r_k$ 都是局域的，我们有：\n$$\nM^{-1} r_k \\approx M^{-1} (10^3 e_j) = 10^3 (M^{-1} e_j) = 10^3 (M^{-1}_{jj}) e_j \\approx 10^3 (5 \\cdot 10^{-7}) e_j = 5 \\cdot 10^{-4} e_j\n$$\n因此，预处理残差的范数为：\n$$\n\\|M^{-1} r_k\\|_2 \\approx \\|5 \\cdot 10^{-4} e_j\\|_2 = 5 \\cdot 10^{-4}\n$$\n计算是正确的。我们遇到了真实残差范数很大（$\\approx 10^3$）而预处理残差范数很小（$\\approx 5 \\cdot 10^{-4}$）的情况。这种差异是由预处理器 $M$ 中的大元素引起的，即一个大的 $\\|M\\|_2 \\approx 2 \\cdot 10^6$。像 $\\|M^{-1} r_k\\|_2  10^{-3}$ 这样的绝对停止准则将被满足，导致过早终止。此选项正确地构建了一个物理上相关的场景，并准确地解释了其机理。\n\n结论：**正确**。\n\n**B. 对于任何 SPD 预处理器 $M$，量 $\\|M^{-1} r_k\\|_2$ 都是 $\\|r_k\\|_2$ 的单调递减且可靠的替代指标，因此当 $\\|M^{-1} r_k\\|_2$ 很小时停止不会产生误导。**\n\n这个陈述提出了两个强有力的主张。首先，$\\|M^{-1} r_k\\|_2$ 是单调递减的。虽然 PCG 算法确保误差的 A-范数 $\\|p_k - p_\\star\\|_A$ 单调递减，从而残差的 $A^{-1}$-范数 $\\|r_k\\|_{A^{-1}}$ 也单调递减，但对于 $\\|M^{-1} r_k\\|_2$ 通常不能保证这一点。它可能会表现出非单调行为，尽管趋势是向下的。\n其次，更重要的是，它声称 $\\|M^{-1} r_k\\|_2$ 是 $\\|r_k\\|_2$ 的“可靠替代指标”。正如我们在最初的推导中确立的，关系是 $\\|r_k\\|_2 \\le \\|M\\|_2 \\|M^{-1} r_k\\|_2$。如果 $\\|M\\|_2$ 很大，那么在绝对意义上，$\\|M^{-1} r_k\\|_2$ 并不是 $\\|r_k\\|_2$ 的可靠替代指标。前者的小值并不意味着后者的小值。选项 A 为此主张提供了一个直接的反例。\n\n结论：**不正确**。\n\n**C. 在 SPD 系统的左预处理下，A-能量范数下的真实误差 $\\|p_k - p_\\star\\|_{A} = \\sqrt{(p_k - p_\\star)^{\\top} A (p_k - p_\\star)}$ 总是满足形式为 $\\|p_k - p_\\star\\|_{A} \\le C \\|M^{-1} r_k\\|_2$ 的界，其中常数 $C$ 与 $M$ 无关，因此小的 $\\|M^{-1} r_k\\|_2$ 始终是收敛的可靠指标。**\n\n让我们分析误差范数和预处理残差范数之间的关系。误差是 $e_k = p_k - p_\\star$，残差是 $r_k = b - Ap_k = A p_\\star - A p_k = -A e_k$。\n误差的 A-能量范数是 $\\|e_k\\|_A$。其平方为：\n$$\n\\|e_k\\|_A^2 = e_k^\\top A e_k = (-A^{-1} r_k)^\\top A (-A^{-1} r_k) = r_k^\\top A^{-1} A A^{-1} r_k = r_k^\\top A^{-1} r_k = \\|r_k\\|_{A^{-1}}^2\n$$\n这是一个标准恒等式。现在我们将其与 $\\|M^{-1} r_k\\|_2$ 联系起来。令 $z_k = M^{-1} r_k$，这意味着 $r_k = M z_k$。\n$$\n\\|e_k\\|_A^2 = (M z_k)^\\top A^{-1} (M z_k) = z_k^\\top M A^{-1} M z_k\n$$\n为了使其被 $C^2 \\|z_k\\|_2^2$ 界定，其中 $C$ 是一个常数，我们必须有：\n$$\nz_k^\\top M A^{-1} M z_k \\le C^2 (z_k^\\top z_k)\n$$\n根据诱导 2-范数（或瑞利商）的定义，对于所有 $z_k$ 都满足此式的 $C^2$ 的最小可能值是矩阵 $M A^{-1} M$ 的最大特征值。\n$$\nC^2 = \\lambda_{\\max}(M A^{-1} M) = \\|M A^{-1} M\\|_2\n$$\n这个常数 $C = \\sqrt{\\|M A^{-1} M\\|_2}$ 明确地依赖于预处理器 $M$。该陈述声称 $C$ 与 $M$ 无关是错误的。例如，如果我们将 $M$ 乘以一个因子 $\\alpha  0$，常数会变为 $C' = \\sqrt{\\|\\alpha M A^{-1} \\alpha M\\|_2} = \\alpha \\sqrt{\\|M A^{-1} M\\|_2} = \\alpha C$。\n\n结论：**不正确**。\n\n**D. 考虑一个极端但与 SPD 一致的选择 $A = I$（例如，在无量纲化和局部解耦子问题中的严格对角占优之后出现），并使用对角 SPD 预处理器 $M = \\mathrm{diag}(10^{6}, 1, \\dots, 1)$。从 $p_0 = 0$ 开始并取 $b = r_0 = 10^{3} e_1$ 会得到 $\\|r_0\\|_2 = 10^{3}$，而 $\\|M^{-1} r_0\\|_2 = 10^{-3}$。预处理器对第一个分量进行了如此强烈的重新缩放，以至于对 $\\|M^{-1} r_k\\|_2$ 的绝对停止测试会接受一个具有很大真实残差的解。**\n\n这个选项提供了一个清晰、抽象的测试用例。\n-   系统矩阵：$A = I$（单位矩阵），它是 SPD 的。\n-   预处理器：$M = \\mathrm{diag}(10^6, 1, \\dots, 1)$，它也是 SPD 的。\n-   初始状态：$p_0 = 0$。初始残差为 $r_0 = b - A p_0 = b$。\n-   右端项：$b = 10^3 e_1$，其中 $e_1$ 是第一个标准基向量。\n在迭代 $k=0$ 时的真实残差是 $r_0 = 10^3 e_1$。其欧几里得范数为：\n$$\n\\|r_0\\|_2 = \\|10^3 e_1\\|_2 = 10^3\n$$\n这是一个很大的残差。\n逆预处理器是 $M^{-1} = \\mathrm{diag}(10^{-6}, 1, \\dots, 1)$。\n在 $k=0$ 时的预处理残差是 $M^{-1} r_0$：\n$$\nM^{-1} r_0 = M^{-1} (10^3 e_1) = 10^3 (M^{-1} e_1) = 10^3 (10^{-6} e_1) = 10^{-3} e_1\n$$\n其欧几里得范数为：\n$$\n\\|M^{-1} r_0\\|_2 = \\|10^{-3} e_1\\|_2 = 10^{-3}\n$$\n这是一个很小的值。该场景构建正确。初始状态将满足像 $\\|M^{-1} r_k\\|_2  10^{-2}$ 这样的停止准则，导致算法立即终止并接受初始猜测 $p_0 = 0$ 作为解，尽管真实残差范数为 $10^3$。所提供的解释是准确的：$M$ 的巨大第一项（即，大的 $\\|M\\|_2 = 10^6$）导致了强烈的重新缩放以及范数之间的差异。\n\n结论：**正确**。",
            "answer": "$$\\boxed{AD}$$"
        }
    ]
}