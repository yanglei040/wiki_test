{
    "hands_on_practices": [
        {
            "introduction": "This first practice returns to the fundamental principles of projection methods. By starting with a given, non-solenoidal velocity field, you will derive the corresponding Pressure Poisson Equation and solve for the pressure field required to enforce incompressibility. This exercise solidifies the core concept of how the projection step mathematically removes divergence from the velocity field .",
            "id": "3321950",
            "problem": "Consider a two-dimensional, constant-density incompressible flow in a periodic domain governed by the incompressible Navier–Stokes equations. Work in nondimensional variables so that density is $1$ and the time step is $\\Delta t = 1$. The domain is $\\Omega = [0,2\\pi]\\times[0,2\\pi]$ with periodic boundary conditions in both directions. In a standard fractional-step projection method, a provisional velocity field $\\boldsymbol{u}^*$ is first advanced without pressure, and then corrected by a pressure update to enforce incompressibility.\n\nStart from the fundamental constraints of incompressible flow and the definition of the projection step: the corrected velocity satisfies $\\nabla\\cdot \\boldsymbol{u}^{n+1} = 0$ and is obtained from the provisional velocity by subtracting a pressure gradient over one time step. Use these foundations to derive the elliptic boundary value problem that the pressure must satisfy under periodic boundary conditions when enforcing incompressibility after the correction, without assuming any pre-derived formula.\n\nLet the given provisional velocity be\n$$\n\\boldsymbol{u}^*(x,y) = \\big(2\\sin(x)\\cos(y),\\; -\\cos(x)\\sin(y)\\big), \\quad (x,y)\\in\\Omega.\n$$\nImpose the standard zero-mean condition on the pressure over $\\Omega$ to ensure uniqueness.\n\nUsing the above, compute:\n- the pressure field $p(x,y)$ that enforces incompressibility after one projection step, and\n- the reduction factor $r$ in divergence defined by\n$$\nr \\equiv \\frac{\\|\\nabla\\cdot \\boldsymbol{u}^{n+1}\\|_{L^2(\\Omega)}}{\\|\\nabla\\cdot \\boldsymbol{u}^*\\|_{L^2(\\Omega)}},\n$$\nwhere $\\|f\\|_{L^2(\\Omega)} \\equiv \\left(\\int_{\\Omega} |f|^2\\, \\mathrm{d}x\\,\\mathrm{d}y\\right)^{1/2}$.\n\nReport your final answer as a pair consisting of the closed-form expression for $p(x,y)$ and the scalar $r$. No units are needed because of the nondimensionalization. The answer must be a single row matrix containing these two entries. No rounding is required.",
            "solution": "The user wants me to solve a problem in computational fluid dynamics involving a fractional-step projection method for incompressible flow.\n\n### Step 1: Extract Givens\n-   **Governing Equations**: Incompressible Navier–Stokes equations (implied).\n-   **Flow Properties**: Two-dimensional ($2$D), constant-density ($\\rho=1$).\n-   **Time Step**: $\\Delta t = 1$.\n-   **Domain**: $\\Omega = [0, 2\\pi] \\times [0, 2\\pi]$.\n-   **Boundary Conditions**: Periodic in both $x$ and $y$ directions.\n-   **Fractional-Step Method**: A provisional velocity $\\boldsymbol{u}^*$ is corrected to $\\boldsymbol{u}^{n+1}$.\n-   **Correction Step Definition**: $\\boldsymbol{u}^{n+1} = \\boldsymbol{u}^* - \\Delta t \\nabla p$.\n-   **Incompressibility Constraint**: $\\nabla \\cdot \\boldsymbol{u}^{n+1} = 0$.\n-   **Provisional Velocity Field**: $\\boldsymbol{u}^*(x,y) = (2\\sin(x)\\cos(y), -\\cos(x)\\sin(y))$.\n-   **Pressure Uniqueness Condition**: Zero-mean pressure over the domain, $\\int_{\\Omega} p(x,y)\\, \\mathrm{d}A = 0$.\n-   **Required Outputs**:\n    1.  The pressure field $p(x,y)$.\n    2.  The divergence reduction factor $r \\equiv \\frac{\\|\\nabla\\cdot \\boldsymbol{u}^{n+1}\\|_{L^2(\\Omega)}}{\\|\\nabla\\cdot \\boldsymbol{u}^*\\|_{L^2(\\Omega)}}$, where $\\|f\\|_{L^2(\\Omega)} \\equiv \\left(\\int_{\\Omega} |f|^2\\, \\mathrm{d}x\\,\\mathrm{d}y\\right)^{1/2}$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, being a standard exercise in the theory of projection methods for incompressible flows. It is well-posed; the domain, boundary conditions, and a uniqueness constraint for the pressure are all specified, which ensures a unique solution exists for the elliptic problem to be derived. The problem is objective and uses precise mathematical language. There are no contradictions, missing pieces of information, or violations of physical principles. The problem is, therefore, valid.\n\n### Step 3: Derivation and Solution\n\n**Part 1: Derivation of the Pressure Poisson Equation**\n\nThe projection method consists of two fundamental steps. First, an intermediate velocity field, $\\boldsymbol{u}^*$, is computed. Second, this field is projected onto the space of divergence-free vector fields to obtain the velocity at the next time step, $\\boldsymbol{u}^{n+1}$. This projection is achieved by subtracting the gradient of a scalar field, which is identified with the pressure $p$.\n\nThe relationship between the corrected velocity $\\boldsymbol{u}^{n+1}$ and the provisional velocity $\\boldsymbol{u}^*$ is given as:\n$$\n\\boldsymbol{u}^{n+1} = \\boldsymbol{u}^* - \\Delta t \\nabla p\n$$\nGiven that the time step is $\\Delta t = 1$, this simplifies to:\n$$\n\\boldsymbol{u}^{n+1} = \\boldsymbol{u}^* - \\nabla p\n$$\nThe corrected velocity field must satisfy the incompressibility constraint:\n$$\n\\nabla \\cdot \\boldsymbol{u}^{n+1} = 0\n$$\nTo find the equation governing the pressure $p$, we take the divergence of the correction-step equation:\n$$\n\\nabla \\cdot \\boldsymbol{u}^{n+1} = \\nabla \\cdot (\\boldsymbol{u}^* - \\nabla p)\n$$\nUsing the linearity of the divergence operator, we have:\n$$\n\\nabla \\cdot \\boldsymbol{u}^{n+1} = \\nabla \\cdot \\boldsymbol{u}^* - \\nabla \\cdot (\\nabla p)\n$$\nSubstituting the incompressibility constraint $\\nabla \\cdot \\boldsymbol{u}^{n+1} = 0$ and recognizing that $\\nabla \\cdot (\\nabla p)$ is the Laplacian $\\nabla^2 p$, we obtain:\n$$\n0 = \\nabla \\cdot \\boldsymbol{u}^* - \\nabla^2 p\n$$\nThis yields the elliptic boundary value problem for the pressure, known as the Pressure Poisson Equation (PPE):\n$$\n\\nabla^2 p = \\nabla \\cdot \\boldsymbol{u}^*\n$$\n\n**Part 2: Solving for the Pressure Field $p(x,y)$**\n\nFirst, we must compute the source term for the PPE, which is the divergence of the given provisional velocity field $\\boldsymbol{u}^* = (u^*, v^*)$.\nThe components of the provisional velocity are $u^*(x,y) = 2\\sin(x)\\cos(y)$ and $v^*(x,y) = -\\cos(x)\\sin(y)$.\nThe divergence is:\n$$\n\\nabla \\cdot \\boldsymbol{u}^* = \\frac{\\partial u^*}{\\partial x} + \\frac{\\partial v^*}{\\partial y} = \\frac{\\partial}{\\partial x}(2\\sin(x)\\cos(y)) + \\frac{\\partial}{\\partial y}(-\\cos(x)\\sin(y))\n$$\n$$\n\\nabla \\cdot \\boldsymbol{u}^* = 2\\cos(x)\\cos(y) - \\cos(x)\\cos(y) = \\cos(x)\\cos(y)\n$$\nThe PPE to be solved is therefore:\n$$\n\\nabla^2 p(x,y) = \\frac{\\partial^2 p}{\\partial x^2} + \\frac{\\partial^2 p}{\\partial y^2} = \\cos(x)\\cos(y)\n$$\nThe problem is defined on a periodic domain. Since the source term is trigonometric, we can seek a solution of a similar form, $p(x,y) = A\\cos(x)\\cos(y)$, where $A$ is a constant to be determined. This form automatically satisfies the periodic boundary conditions.\nWe compute the partial derivatives of this trial solution:\n$$\n\\frac{\\partial^2 p}{\\partial x^2} = \\frac{\\partial^2}{\\partial x^2} (A\\cos(x)\\cos(y)) = -A\\cos(x)\\cos(y)\n$$\n$$\n\\frac{\\partial^2 p}{\\partial y^2} = \\frac{\\partial^2}{\\partial y^2} (A\\cos(x)\\cos(y)) = -A\\cos(x)\\cos(y)\n$$\nSubstituting these into the PPE:\n$$\n\\nabla^2 p = -A\\cos(x)\\cos(y) - A\\cos(x)\\cos(y) = -2A\\cos(x)\\cos(y)\n$$\nWe equate this to the source term:\n$$\n-2A\\cos(x)\\cos(y) = \\cos(x)\\cos(y)\n$$\nThis implies $-2A = 1$, so $A = -\\frac{1}{2}$.\nThe general solution for the pressure is the sum of this particular solution and any solution to the homogeneous equation $\\nabla^2 p_h = 0$ with periodic boundary conditions. The only such solutions are constants. Thus, the general solution is:\n$$\np(x,y) = -\\frac{1}{2}\\cos(x)\\cos(y) + C\n$$\nTo find the constant $C$, we apply the zero-mean condition:\n$$\n\\int_{\\Omega} p(x,y) \\, \\mathrm{d}x\\,\\mathrm{d}y = \\int_{0}^{2\\pi} \\int_{0}^{2\\pi} \\left(-\\frac{1}{2}\\cos(x)\\cos(y) + C\\right) \\, \\mathrm{d}x\\,\\mathrm{d}y = 0\n$$\n$$\n-\\frac{1}{2} \\left( \\int_{0}^{2\\pi} \\cos(x) \\, \\mathrm{d}x \\right) \\left( \\int_{0}^{2\\pi} \\cos(y) \\, \\mathrm{d}y \\right) + C \\int_{0}^{2\\pi} \\int_{0}^{2\\pi} \\, \\mathrm{d}x\\,\\mathrm{d}y = 0\n$$\nThe definite integral of cosine over a full period is zero: $\\int_{0}^{2\\pi} \\cos(t) \\, \\mathrm{d}t = [\\sin(t)]_{0}^{2\\pi} = 0$.\nThe equation simplifies to:\n$$\n-\\frac{1}{2}(0)(0) + C \\cdot (2\\pi)^2 = 0 \\implies C = 0\n$$\nTherefore, the unique pressure field is:\n$$\np(x,y) = -\\frac{1}{2}\\cos(x)\\cos(y)\n$$\n\n**Part 3: Calculation of the Divergence Reduction Factor $r$**\n\nThe reduction factor is defined as $r = \\frac{\\|\\nabla\\cdot \\boldsymbol{u}^{n+1}\\|_{L^2(\\Omega)}}{\\|\\nabla\\cdot \\boldsymbol{u}^*\\|_{L^2(\\Omega)}}$.\n\nThe numerator involves the divergence of the corrected velocity field, $\\nabla \\cdot \\boldsymbol{u}^{n+1}$. By construction, the projection step is designed to enforce this to be zero. As shown in Part 1, $\\nabla \\cdot \\boldsymbol{u}^{n+1} = \\nabla \\cdot \\boldsymbol{u}^* - \\nabla^2 p$. Since we solved $\\nabla^2 p = \\nabla \\cdot \\boldsymbol{u}^*$, it follows that $\\nabla \\cdot \\boldsymbol{u}^{n+1} = 0$.\nThe $L^2$-norm of the zero function is zero:\n$$\n\\|\\nabla\\cdot \\boldsymbol{u}^{n+1}\\|_{L^2(\\Omega)} = \\|0\\|_{L^2(\\Omega)} = 0\n$$\n\nThe denominator requires the $L^2$-norm of the divergence of the provisional velocity, $\\nabla \\cdot \\boldsymbol{u}^* = \\cos(x)\\cos(y)$.\n$$\n\\|\\nabla\\cdot \\boldsymbol{u}^*\\|_{L^2(\\Omega)}^2 = \\int_{0}^{2\\pi} \\int_{0}^{2\\pi} |\\cos(x)\\cos(y)|^2 \\, \\mathrm{d}x\\,\\mathrm{d}y\n$$\n$$\n= \\int_{0}^{2\\pi} \\cos^2(x) \\, \\mathrm{d}x \\int_{0}^{2\\pi} \\cos^2(y) \\, \\mathrm{d}y\n$$\nTo evaluate the integral, we use the identity $\\cos^2(\\theta) = \\frac{1}{2}(1 + \\cos(2\\theta))$:\n$$\n\\int_{0}^{2\\pi} \\cos^2(\\theta) \\, \\mathrm{d}\\theta = \\int_{0}^{2\\pi} \\frac{1}{2}(1 + \\cos(2\\theta)) \\, \\mathrm{d}\\theta = \\frac{1}{2} \\left[ \\theta + \\frac{1}{2}\\sin(2\\theta) \\right]_{0}^{2\\pi} = \\frac{1}{2}(2\\pi - 0) = \\pi\n$$\nThus, the squared norm is:\n$$\n\\|\\nabla\\cdot \\boldsymbol{u}^*\\|_{L^2(\\Omega)}^2 = (\\pi)(\\pi) = \\pi^2\n$$\nThe norm itself is $\\|\\nabla\\cdot \\boldsymbol{u}^*\\|_{L^2(\\Omega)} = \\sqrt{\\pi^2} = \\pi$.\nThis value is non-zero, so the reduction factor $r$ is well-defined.\nSubstituting the numerator and denominator:\n$$\nr = \\frac{0}{\\pi} = 0\n$$\nThe reduction factor is $0$, which signifies that the projection step, when solved exactly, perfectly eliminates the divergence from the velocity field, as required by theory.\n\nThe final answer consists of the pair $(p(x,y), r)$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -\\frac{1}{2}\\cos(x)\\cos(y) & 0 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "Moving from continuous theory to a discrete implementation on a collocated grid can introduce numerical instabilities, most notably pressure-velocity decoupling. This exercise investigates the celebrated Rhie-Chow interpolation, a critical technique for ensuring a stable and physically meaningful coupling between pressure and velocity. Understanding this practice is essential for developing robust finite-volume or finite-difference solvers .",
            "id": "3322014",
            "problem": "Consider one-dimensional incompressible flow of constant density $\\rho$ on a periodic domain of length $L$ discretized by a uniform, collocated grid with $N$ cell centers at positions $x_i = i h$ for $i = 0, 1, \\dots, N-1$, where $h = L/N$. The incompressible Navier–Stokes equations are discretized by a fractional-step (projection) method: an intermediate velocity $u^*$ is obtained by advancing the momentum equation without the pressure gradient, and then the velocity is projected onto a divergence-free field by a pressure correction. The velocity correction is assumed linear in the pressure gradient,\n$$\nu^{n+1} = u^* - \\alpha \\nabla p,\n$$\nwhere $\\alpha = \\Delta t/\\rho$ with time-step $\\Delta t$ and constant density $\\rho$. On a collocated grid, the discrete continuity equation uses face-normal fluxes, so the face velocity entering the discrete divergence at a cell center is constructed by interpolation from cell-centered quantities.\n\nDefine the following discrete operators on the uniform grid:\n- The face-centered discrete gradient of pressure,\n$$\nG_{\\mathrm{face}} p\\big|_{i+\\frac{1}{2}} = \\frac{p_{i+1} - p_i}{h}.\n$$\n- The cell-centered discrete gradient of pressure,\n$$\nG_{\\mathrm{cell}} p\\big|_{i} = \\frac{p_{i+1} - p_{i-1}}{2 h}.\n$$\n- The linear face interpolation of the intermediate velocity,\n$$\n\\mathcal{I} u^*\\big|_{i+\\frac{1}{2}} = \\frac{u^*_i + u^*_{i+1}}{2}.\n$$\n- The cell-centered discrete divergence of face velocity,\n$$\nD u\\big|_{i} = \\frac{u\\big|_{i+\\frac{1}{2}} - u\\big|_{i-\\frac{1}{2}}}{h}.\n$$\n\nTo avoid pressure–velocity decoupling on collocated grids, a Rhie–Chow-type interpolation is introduced by blending the pressure gradient evaluated at faces and the average of cell-centered gradients. Specifically, consider the one-parameter family\n$$\ng_{i+\\frac{1}{2}}^{(\\theta)} = \\theta G_{\\mathrm{face}} p\\big|_{i+\\frac{1}{2}} + (1-\\theta) \\frac{G_{\\mathrm{cell}} p\\big|_{i} + G_{\\mathrm{cell}} p\\big|_{i+1}}{2},\n$$\nwith $\\theta \\in \\mathbb{R}$, and define the face velocity used in the continuity equation as\n$$\nu\\big|_{i+\\frac{1}{2}} = \\mathcal{I} u^*\\big|_{i+\\frac{1}{2}} - \\alpha g_{i+\\frac{1}{2}}^{(\\theta)}.\n$$\n\nStarting from the incompressibility constraint and the projection method, analyze the role of the above Rhie–Chow-type interpolation in suppressing pressure–velocity decoupling. Derive the discrete gradient–divergence consistency conditions under periodic boundary conditions (no boundaries), by requiring that the pressure contribution to the discrete divergence $D u$ generated by the correction $-\\alpha g_{i+\\frac{1}{2}}^{(\\theta)}$ coincides, for every discrete pressure field $p$, with the standard discrete Laplacian obtained by composing $D$ with $G_{\\mathrm{face}}$:\n$$\nD\\Big(-\\alpha G_{\\mathrm{face}} p\\Big) \\equiv D\\Big(-\\alpha g^{(\\theta)}\\Big).\n$$\n\nDetermine the unique scalar value of the blending parameter $\\theta$ that satisfies this consistency for all grid-resolved Fourier modes on the periodic grid. In your derivation, explicitly show how the choice of $\\theta$ affects the discrete operator applied to $p$ and explain how the Rhie–Chow construction avoids spurious odd–even (checkerboard) pressure–velocity decoupling. Your final answer must be the single real number $\\theta$; no units are required.",
            "solution": "The present task requires the determination of a specific parameter $\\theta$ in a Rhie–Chow-type interpolation scheme. The value of $\\theta$ must ensure that a discrete consistency condition is met for a fractional-step method applied to the one-dimensional incompressible Navier–Stokes equations on a periodic, collocated grid.\n\nFirst, we perform the mandatory validation of the problem statement.\n\n### Step 1: Extract Givens\n- **Flow and Fluid**: One-dimensional incompressible flow, constant density $\\rho$.\n- **Domain and Grid**: Periodic domain of length $L$, discretized by a uniform, collocated grid with $N$ cell centers at $x_i = i h$ for $i = 0, \\dots, N-1$, where $h = L/N$.\n- **Numerical Method**: Fractional-step projection method.\n- **Velocity Correction**: $u^{n+1} = u^* - \\alpha \\nabla p$, with $\\alpha = \\Delta t/\\rho$.\n- **Discrete Operators**:\n  - Face-centered gradient: $G_{\\mathrm{face}} p\\big|_{i+\\frac{1}{2}} = \\frac{p_{i+1} - p_i}{h}$.\n  - Cell-centered gradient: $G_{\\mathrm{cell}} p\\big|_{i} = \\frac{p_{i+1} - p_{i-1}}{2 h}$.\n  - Face interpolation of velocity: $\\mathcal{I} u^*\\big|_{i+\\frac{1}{2}} = \\frac{u^*_i + u^*_{i+1}}{2}$.\n  - Cell-centered divergence: $D u\\big|_{i} = \\frac{u\\big|_{i+\\frac{1}{2}} - u\\big|_{i-\\frac{1}{2}}}{h}$.\n- **Rhie–Chow Interpolation**:\n  - Blended pressure gradient: $g_{i+\\frac{1}{2}}^{(\\theta)} = \\theta G_{\\mathrm{face}} p\\big|_{i+\\frac{1}{2}} + (1-\\theta) \\frac{G_{\\mathrm{cell}} p\\big|_{i} + G_{\\mathrm{cell}} p\\big|_{i+1}}{2}$.\n  - Face velocity for continuity equation: $u\\big|_{i+\\frac{1}{2}} = \\mathcal{I} u^*\\big|_{i+\\frac{1}{2}} - \\alpha g_{i+\\frac{1}{2}}^{(\\theta)}$.\n- **Consistency Condition**: The pressure contribution to the discrete divergence must satisfy $D\\Big(-\\alpha G_{\\mathrm{face}} p\\Big) \\equiv D\\Big(-\\alpha g^{(\\theta)}\\Big)$ for every discrete pressure field $p$ under periodic boundary conditions.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientific Grounding**: The problem is firmly grounded in the field of computational fluid dynamics. The fractional-step method, collocated grid arrangement, pressure–velocity decoupling, and Rhie–Chow interpolation are standard, well-established concepts.\n- **Well-Posed**: The problem is well-posed. It provides clear definitions for all discrete operators and a precise mathematical condition to be satisfied. The goal is to find a unique parameter based on this condition.\n- **Objective**: The problem is stated objectively using precise mathematical and technical language.\n\nThe problem does not exhibit any of the flaws listed in the validation criteria (e.g., scientific unsoundness, incompleteness, ambiguity). It is a standard, non-trivial problem in numerical analysis for fluid dynamics.\n\n### Step 3: Verdict and Action\nThe problem is valid. We proceed to the solution.\n\nThe core of the problem is to find the value of $\\theta$ that satisfies the consistency condition:\n$$\nD\\Big(-\\alpha G_{\\mathrm{face}} p\\Big) = D\\Big(-\\alpha g^{(\\theta)}\\Big)\n$$\nThis identity must hold for any discrete pressure field $p$. The constant scalar factor $-\\alpha$ can be canceled from both sides, yielding the operator identity:\n$$\nD\\left(G_{\\mathrm{face}} p\\right) = D\\left(g^{(\\theta)}\\right)\n$$\nOur strategy is to derive the explicit stencils for the operators on both sides of this equation and then determine the value of $\\theta$ that makes them identical.\n\nFirst, we expand the left-hand side (LHS), which represents the standard discrete Laplacian operator.\n$$\n\\text{LHS} = D\\left(G_{\\mathrm{face}} p\\right)\\Big|_i = \\frac{G_{\\mathrm{face}} p\\big|_{i+\\frac{1}{2}} - G_{\\mathrm{face}} p\\big|_{i-\\frac{1}{2}}}{h}\n$$\nUsing the definition of $G_{\\mathrm{face}}$, we have $G_{\\mathrm{face}} p\\big|_{i+\\frac{1}{2}} = \\frac{p_{i+1} - p_i}{h}$ and $G_{\\mathrm{face}} p\\big|_{i-\\frac{1}{2}} = \\frac{p_i - p_{i-1}}{h}$. Substituting these into the expression for the divergence gives:\n$$\n\\text{LHS} = \\frac{1}{h} \\left( \\frac{p_{i+1} - p_i}{h} - \\frac{p_i - p_{i-1}}{h} \\right) = \\frac{p_{i+1} - 2p_i + p_{i-1}}{h^2}\n$$\nThis is the compact, three-point stencil for the second derivative.\n\nNext, we expand the right-hand side (RHS), which involves the blended gradient $g^{(\\theta)}$.\n$$\n\\text{RHS} = D\\left(g^{(\\theta)}\\right)\\Big|_i = \\frac{g_{i+\\frac{1}{2}}^{(\\theta)} - g_{i-\\frac{1}{2}}^{(\\theta)}}{h}\n$$\nWe must first write out the expression for $g_{i+\\frac{1}{2}}^{(\\theta)}$ in terms of the pressure values $p_j$.\n$$\ng_{i+\\frac{1}{2}}^{(\\theta)} = \\theta G_{\\mathrm{face}} p\\big|_{i+\\frac{1}{2}} + (1-\\theta) \\frac{G_{\\mathrm{cell}} p\\big|_{i} + G_{\\mathrm{cell}} p\\big|_{i+1}}{2}\n$$\nSubstituting the definitions for the gradient operators:\n$$\ng_{i+\\frac{1}{2}}^{(\\theta)} = \\theta \\left( \\frac{p_{i+1} - p_i}{h} \\right) + (1-\\theta) \\frac{1}{2} \\left( \\frac{p_{i+1} - p_{i-1}}{2h} + \\frac{p_{i+2} - p_i}{2h} \\right)\n$$\n$$\ng_{i+\\frac{1}{2}}^{(\\theta)} = \\frac{\\theta}{h}(p_{i+1} - p_i) + \\frac{1-\\theta}{4h}(p_{i+2} + p_{i+1} - p_i - p_{i-1})\n$$\nTo compute the divergence, we also need $g_{i-\\frac{1}{2}}^{(\\theta)}$, which is found by shifting the index $i$ to $i-1$:\n$$\ng_{i-\\frac{1}{2}}^{(\\theta)} = \\frac{\\theta}{h}(p_{i} - p_{i-1}) + \\frac{1-\\theta}{4h}(p_{i+1} + p_{i} - p_{i-1} - p_{i-2})\n$$\nNow, we compute the difference and divide by $h$:\n$$\n\\text{RHS} = \\frac{1}{h} \\left( g_{i+\\frac{1}{2}}^{(\\theta)} - g_{i-\\frac{1}{2}}^{(\\theta)} \\right)\n$$\nLet us separate the terms proportional to $\\theta$ and $(1-\\theta)$.\nThe term with $\\theta$:\n$$\n\\frac{1}{h} \\left[ \\frac{\\theta}{h}(p_{i+1} - p_i) - \\frac{\\theta}{h}(p_i - p_{i-1}) \\right] = \\frac{\\theta}{h^2} (p_{i+1} - 2p_i + p_{i-1})\n$$\nThe term with $(1-\\theta)$:\n$$\n\\frac{1}{h} \\left[ \\frac{1-\\theta}{4h}(p_{i+2} + p_{i+1} - p_i - p_{i-1}) - \\frac{1-\\theta}{4h}(p_{i+1} + p_i - p_{i-1} - p_{i-2}) \\right]\n$$\n$$\n= \\frac{1-\\theta}{4h^2} \\left[ (p_{i+2} + p_{i+1} - p_i - p_{i-1}) - (p_{i+1} + p_i - p_{i-1} - p_{i-2}) \\right]\n$$\n$$\n= \\frac{1-\\theta}{4h^2} (p_{i+2} - 2p_i + p_{i-2})\n$$\nCombining both terms, the full expression for the RHS is:\n$$\n\\text{RHS} = \\theta \\frac{p_{i+1} - 2p_i + p_{i-1}}{h^2} + (1-\\theta) \\frac{p_{i+2} - 2p_i + p_{i-2}}{4h^2}\n$$\nNow we enforce the consistency condition, LHS = RHS:\n$$\n\\frac{p_{i+1} - 2p_i + p_{i-1}}{h^2} = \\theta \\frac{p_{i+1} - 2p_i + p_{i-1}}{h^2} + (1-\\theta) \\frac{p_{i+2} - 2p_i + p_{i-2}}{4h^2}\n$$\nRearranging the terms, we get:\n$$\n(1-\\theta) \\frac{p_{i+1} - 2p_i + p_{i-1}}{h^2} = (1-\\theta) \\frac{p_{i+2} - 2p_i + p_{i-2}}{4h^2}\n$$\nThis equation must hold for any discrete pressure field $p$. The operators on both sides are different discrete approximations of the Laplacian. Let us denote $L_{3pt} p_i = \\frac{p_{i+1} - 2p_i + p_{i-1}}{h^2}$ and $L_{5pt} p_i = \\frac{p_{i+2} - 2p_i + p_{i-2}}{4h^2}$. The condition is $(1-\\theta) L_{3pt} p = (1-\\theta) L_{5pt} p$.\nThis can be rewritten as $(1-\\theta)(L_{3pt} - L_{5pt})p = 0$.\nThe operator $L_{3pt} - L_{5pt}$ is not the zero operator. For example, applying it to a quartic field $p_i = (ih)^4$ would yield a non-zero result. Since the equality must hold for an arbitrary field $p$, the only possibility is that the scalar coefficient is zero:\n$$\n1-\\theta = 0\n$$\nThus, the unique value of the blending parameter is $\\theta = 1$.\n\nFinally, we explain the role of this choice in suppressing pressure–velocity decoupling.\nOn a collocated grid, pressure–velocity decoupling manifests as an inability of the discrete system to control high-frequency, non-physical oscillations in the pressure field. A \"checkerboard\" pressure mode, where $p_i = C(-1)^i$ for some constant $C$, is the prime example. A naive discretization can lead to a discrete pressure Poisson operator that is insensitive to this mode, meaning the checkerboard mode lies in its null space. If so, a checkerboard pressure field can arise and grow without being penalized by the incompressibility constraint ($D u=0$), leading to spurious solutions.\n\nThe root of the problem is the operator used to form the pressure Poisson equation, $\\mathcal{L}_p p = D(\\dots)$. In a naive scheme, one might interpolate the cell-centered pressure gradient to the faces, which corresponds to the case $\\theta=0$ in the given family of interpolations. This results in an operator on pressure equivalent to $D \\circ \\mathcal{I} \\circ G_{\\text{cell}}$. Applying this operator to the checkerboard mode $p_i = (-1)^i$ yields:\n1. $G_{\\mathrm{cell}} p\\big|_i = \\frac{p_{i+1} - p_{i-1}}{2h} = \\frac{(-1)^{i+1} - (-1)^{i-1}}{2h} = \\frac{-(-1)^i - (-(-1)^i)}{2h} = 0$.\n2. Since the gradient is zero everywhere, its interpolation and subsequent divergence are also zero.\nThus, for $\\theta=0$, the resulting pressure Poisson operator has a null space containing the checkerboard mode, and the scheme is unstable.\n\nBy setting $\\theta = 1$, the consistency condition $D(g^{(1)}) = D(G_{\\mathrm{face}} p)$ is satisfied. The pressure Poisson equation that arises from the projection step is therefore $D(G_{\\mathrm{face}} p) = \\frac{1}{\\alpha} D(\\mathcal{I}u^*)$. The discrete Laplacian operator acting on the pressure is $\\mathcal{L}_p = D \\circ G_{\\mathrm{face}}$.\nLet's test this operator on the checkerboard mode $p_i = (-1)^i$:\n$$\n\\mathcal{L}_p p_i = \\frac{p_{i+1} - 2p_i + p_{i-1}}{h^2} = \\frac{(-1)^{i+1} - 2(-1)^i + (-1)^{i-1}}{h^2} = \\frac{-(-1)^i - 2(-1)^i - (-1)^i}{h^2} = -\\frac{4(-1)^i}{h^2}\n$$\nThis result is non-zero. The compact Laplacian operator $D \\circ G_{\\mathrm{face}}$ correctly \"sees\" and penalizes the checkerboard mode. By ensuring that the effective pressure operator is this specific, well-behaved discrete Laplacian, the Rhie–Chow interpolation with $\\theta = 1$ couples the pressure values at adjacent cells and eliminates the spurious checkerboard mode from the null space, thus stabilizing the collocated grid method.",
            "answer": "$$\n\\boxed{1}\n$$"
        },
        {
            "introduction": "A crucial step in developing any numerical solver is verifying its correctness. The Method of Manufactured Solutions (MMS) is a powerful and rigorous technique for this purpose. In this practice, you will work backward from a chosen analytical solution to derive the exact forcing terms and boundary conditions required to satisfy the governing equations, a fundamental skill for code validation .",
            "id": "3322036",
            "problem": "Consider the two-dimensional incompressible Navier–Stokes equations in nondimensional form for velocity field $\\mathbf{u}(x,y,t) = (u(x,y,t), v(x,y,t))$ and pressure $p(x,y,t)$ on the unit square domain $\\Omega = [0,1] \\times [0,1]$ with time $t \\ge 0$,\n$$\n\\frac{\\partial \\mathbf{u}}{\\partial t} + (\\mathbf{u}\\cdot\\nabla)\\mathbf{u} - \\nu \\nabla^{2}\\mathbf{u} + \\nabla p = \\mathbf{f}(x,y,t), \\qquad \\nabla\\cdot\\mathbf{u} = 0,\n$$\nwhere $\\nu > 0$ is the kinematic viscosity and $\\mathbf{f}(x,y,t)$ is a body force. Assume continuous boundary conditions are imposed on all four sides of $\\partial\\Omega$. You wish to test the splitting error of a fractional-step projection method by the Method of Manufactured Solutions.\n\nYou are given the manufactured solution defined by a streamfunction $\\psi(x,y,t)$,\n$$\n\\psi(x,y,t) = A \\sin(\\pi x)\\sin(\\pi y)\\cos(\\omega t),\n$$\nwith constants $A>0$ and $\\omega>0$, from which the velocity field is constructed as\n$$\nu(x,y,t) = \\frac{\\partial \\psi}{\\partial y} = A \\pi \\cos(\\pi y)\\sin(\\pi x)\\cos(\\omega t), \\qquad v(x,y,t) = -\\frac{\\partial \\psi}{\\partial x} = -A \\pi \\cos(\\pi x)\\sin(\\pi y)\\cos(\\omega t).\n$$\nThe pressure field is prescribed as\n$$\np(x,y,t) = B \\cos(\\pi x)\\sin(\\pi y)\\sin(\\omega t),\n$$\nwith constant $B>0$. The outward unit normal on the bottom boundary $y=0$ is $\\mathbf{n} = (0,-1)$.\n\nTasks:\n- Starting from the incompressible Navier–Stokes equations as the fundamental law, verify that the manufactured velocity field is solenoidal.\n- Derive the body force $\\mathbf{f}(x,y,t)$ so that the given $(\\mathbf{u},p)$ exactly satisfies the momentum equation in $\\Omega$ for all times $t\\ge 0$.\n- Enforcing the normal component of the momentum balance on the boundary, derive the Neumann boundary data for the pressure Poisson equation required in a classical projection step, i.e., the function $g(x,t)$ defined on $y=0$ such that $\\partial p/\\partial n = g(x,t)$ at $y=0$.\n\nExpress the final boundary data $g(x,t)$ as a single closed-form analytic expression in terms of $A$, $B$, $\\omega$, $\\nu$, $\\pi$, $x$, and $t$. No numerical evaluation is required. All quantities are nondimensional; do not include units in your expression.",
            "solution": "The problem requires the analysis of a given manufactured solution for the two-dimensional incompressible Navier-Stokes equations. The tasks are to verify the solenoidal condition for the velocity field, derive the corresponding body force term, and determine the Neumann boundary condition for the pressure on the bottom boundary of the domain.\n\nThe governing equations are the momentum equation and the incompressibility constraint:\n$$\n\\frac{\\partial \\mathbf{u}}{\\partial t} + (\\mathbf{u}\\cdot\\nabla)\\mathbf{u} - \\nu \\nabla^{2}\\mathbf{u} + \\nabla p = \\mathbf{f}(x,y,t)\n$$\n$$\n\\nabla\\cdot\\mathbf{u} = 0\n$$\n\nThe provided manufactured solution is defined by the streamfunction $\\psi(x,y,t) = A \\sin(\\pi x)\\sin(\\pi y)\\cos(\\omega t)$, from which the velocity field $\\mathbf{u} = (u,v)$ is derived:\n$$\nu(x,y,t) = \\frac{\\partial \\psi}{\\partial y} = A \\pi \\cos(\\pi y)\\sin(\\pi x)\\cos(\\omega t)\n$$\n$$\nv(x,y,t) = -\\frac{\\partial \\psi}{\\partial x} = -A \\pi \\cos(\\pi x)\\sin(\\pi y)\\cos(\\omega t)\n$$\nThe pressure field is given as:\n$$\np(x,y,t) = B \\cos(\\pi x)\\sin(\\pi y)\\sin(\\omega t)\n$$\n\nFirst, we address the three tasks in sequence.\n\n**Task 1: Verification of the Solenoidal Condition**\n\nThe velocity field $\\mathbf{u}$ is solenoidal if its divergence is zero, i.e., $\\nabla\\cdot\\mathbf{u} = 0$. In two dimensions, this is $\\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y} = 0$. We compute the partial derivatives of the velocity components:\n$$\n\\frac{\\partial u}{\\partial x} = \\frac{\\partial}{\\partial x} \\left( A \\pi \\cos(\\pi y)\\sin(\\pi x)\\cos(\\omega t) \\right) = A \\pi^2 \\cos(\\pi y)\\cos(\\pi x)\\cos(\\omega t)\n$$\n$$\n\\frac{\\partial v}{\\partial y} = \\frac{\\partial}{\\partial y} \\left( -A \\pi \\cos(\\pi x)\\sin(\\pi y)\\cos(\\omega t) \\right) = -A \\pi^2 \\cos(\\pi x)\\cos(\\pi y)\\cos(\\omega t)\n$$\nThe divergence is the sum of these two terms:\n$$\n\\nabla\\cdot\\mathbf{u} = \\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y} = A \\pi^2 \\cos(\\pi y)\\cos(\\pi x)\\cos(\\omega t) - A \\pi^2 \\cos(\\pi x)\\cos(\\pi y)\\cos(\\omega t) = 0\n$$\nThe velocity field is indeed solenoidal for all $(x,y,t)$. This result is expected, as any two-dimensional velocity field derived from a streamfunction $\\psi$ via $u = \\partial\\psi/\\partial y$ and $v = -\\partial\\psi/\\partial x$ automatically satisfies the incompressibility condition, provided $\\psi$ is twice continuously differentiable, by Clairaut's theorem on the equality of mixed partials: $\\frac{\\partial^2\\psi}{\\partial x \\partial y} = \\frac{\\partial^2\\psi}{\\partial y \\partial x}$.\n\n**Task 2: Derivation of the Body Force**\n\nThe body force $\\mathbf{f}(x,y,t)$ is determined by rearranging the momentum equation:\n$$\n\\mathbf{f} = \\frac{\\partial \\mathbf{u}}{\\partial t} + (\\mathbf{u}\\cdot\\nabla)\\mathbf{u} - \\nu \\nabla^{2}\\mathbf{u} + \\nabla p\n$$\nWe calculate each term on the right-hand side.\n\n1.  **Temporal derivative, $\\frac{\\partial \\mathbf{u}}{\\partial t}$**:\n    $$\n    \\frac{\\partial u}{\\partial t} = -A \\pi \\omega \\cos(\\pi y)\\sin(\\pi x)\\sin(\\omega t)\n    $$\n    $$\n    \\frac{\\partial v}{\\partial t} = A \\pi \\omega \\cos(\\pi x)\\sin(\\pi y)\\sin(\\omega t)\n    $$\n\n2.  **Convective term, $(\\mathbf{u}\\cdot\\nabla)\\mathbf{u}$**:\n    The components are $(u \\frac{\\partial u}{\\partial x} + v \\frac{\\partial u}{\\partial y})$ and $(u \\frac{\\partial v}{\\partial x} + v \\frac{\\partial v}{\\partial y})$. We need the partial derivatives of $\\mathbf{u}$ with respect to space:\n    $\\frac{\\partial u}{\\partial x} = A \\pi^2 \\cos(\\pi y)\\cos(\\pi x)\\cos(\\omega t)$\n    $\\frac{\\partial u}{\\partial y} = -A \\pi^2 \\sin(\\pi y)\\sin(\\pi x)\\cos(\\omega t)$\n    $\\frac{\\partial v}{\\partial x} = A \\pi^2 \\sin(\\pi x)\\sin(\\pi y)\\cos(\\omega t)$\n    $\\frac{\\partial v}{\\partial y} = -A \\pi^2 \\cos(\\pi x)\\cos(\\pi y)\\cos(\\omega t)$\n\n    x-component:\n    $u \\frac{\\partial u}{\\partial x} + v \\frac{\\partial u}{\\partial y} = (A \\pi \\cos(\\pi y)\\sin(\\pi x)\\cos(\\omega t))(A \\pi^2 \\cos(\\pi y)\\cos(\\pi x)\\cos(\\omega t)) + (-A \\pi \\cos(\\pi x)\\sin(\\pi y)\\cos(\\omega t))(-A \\pi^2 \\sin(\\pi y)\\sin(\\pi x)\\cos(\\omega t))$\n    $= A^2 \\pi^3 \\sin(\\pi x)\\cos(\\pi x)\\cos^2(\\omega t)[\\cos^2(\\pi y) + \\sin^2(\\pi y)] = A^2 \\pi^3 \\sin(\\pi x)\\cos(\\pi x)\\cos^2(\\omega t) = \\frac{1}{2} A^2 \\pi^3 \\sin(2\\pi x)\\cos^2(\\omega t)$\n\n    y-component:\n    $u \\frac{\\partial v}{\\partial x} + v \\frac{\\partial v}{\\partial y} = (A \\pi \\cos(\\pi y)\\sin(\\pi x)\\cos(\\omega t))(A \\pi^2 \\sin(\\pi x)\\sin(\\pi y)\\cos(\\omega t)) + (-A \\pi \\cos(\\pi x)\\sin(\\pi y)\\cos(\\omega t))(-A \\pi^2 \\cos(\\pi x)\\cos(\\pi y)\\cos(\\omega t))$\n    $= A^2 \\pi^3 \\sin(\\pi y)\\cos(\\pi y)\\cos^2(\\omega t)[\\sin^2(\\pi x) + \\cos^2(\\pi x)] = A^2 \\pi^3 \\sin(\\pi y)\\cos(\\pi y)\\cos^2(\\omega t) = \\frac{1}{2} A^2 \\pi^3 \\sin(2\\pi y)\\cos^2(\\omega t)$\n\n3.  **Viscous term, $-\\nu \\nabla^{2}\\mathbf{u}$**:\n    $\\nabla^2 u = \\frac{\\partial^2 u}{\\partial x^2} + \\frac{\\partial^2 u}{\\partial y^2} = -A \\pi^3 \\cos(\\pi y)\\sin(\\pi x)\\cos(\\omega t) - A \\pi^3 \\cos(\\pi y)\\sin(\\pi x)\\cos(\\omega t) = -2 \\pi^2 u$\n    $\\nabla^2 v = \\frac{\\partial^2 v}{\\partial x^2} + \\frac{\\partial^2 v}{\\partial y^2} = A \\pi^3 \\cos(\\pi x)\\sin(\\pi y)\\cos(\\omega t) + A \\pi^3 \\cos(\\pi x)\\sin(\\pi y)\\cos(\\omega t) = -2 \\pi^2 v$\n    So, $-\\nu \\nabla^2 \\mathbf{u} = 2\\nu\\pi^2\\mathbf{u}$.\n\n4.  **Pressure gradient, $\\nabla p$**:\n    $$\n    \\frac{\\partial p}{\\partial x} = -B \\pi \\sin(\\pi x)\\sin(\\pi y)\\sin(\\omega t)\n    $$\n    $$\n    \\frac{\\partial p}{\\partial y} = B \\pi \\cos(\\pi x)\\cos(\\pi y)\\sin(\\omega t)\n    $$\n\nCombining these terms gives the components of the body force $\\mathbf{f}=(f_x, f_y)$:\n$$\nf_x = -A \\pi \\omega \\cos(\\pi y)\\sin(\\pi x)\\sin(\\omega t) + \\frac{1}{2} A^2 \\pi^3 \\sin(2\\pi x)\\cos^2(\\omega t) + 2\\nu\\pi^2 u - B \\pi \\sin(\\pi x)\\sin(\\pi y)\\sin(\\omega t)\n$$\n$$\nf_y = A \\pi \\omega \\cos(\\pi x)\\sin(\\pi y)\\sin(\\omega t) + \\frac{1}{2} A^2 \\pi^3 \\sin(2\\pi y)\\cos^2(\\omega t) + 2\\nu\\pi^2 v + B \\pi \\cos(\\pi x)\\cos(\\pi y)\\sin(\\omega t)\n$$\n\n**Task 3: Derivation of the Pressure Neumann Boundary Condition**\n\nThe final task is to derive the Neumann boundary data for the pressure Poisson equation, $g(x,t)$, such that $\\frac{\\partial p}{\\partial n} = g(x,t)$ on the bottom boundary $y=0$. The outward unit normal on this boundary is $\\mathbf{n} = (0,-1)$.\n\nThe Neumann condition for pressure in a projection method is derived by enforcing the normal component of the momentum balance at the boundary. From the momentum equation, we have:\n$$\n\\nabla p = \\mathbf{f} - \\frac{\\partial \\mathbf{u}}{\\partial t} - (\\mathbf{u}\\cdot\\nabla)\\mathbf{u} + \\nu \\nabla^{2}\\mathbf{u}\n$$\nTaking the dot product with the normal vector $\\mathbf{n}$ gives the normal derivative of pressure:\n$$\n\\frac{\\partial p}{\\partial n} = \\mathbf{n} \\cdot \\nabla p = \\mathbf{n} \\cdot \\left( \\mathbf{f} - \\frac{\\partial \\mathbf{u}}{\\partial t} - (\\mathbf{u}\\cdot\\nabla)\\mathbf{u} + \\nu \\nabla^{2}\\mathbf{u} \\right)\n$$\nThis expression provides the Neumann boundary condition consistent with the dynamics. Since the manufactured solution $(\\mathbf{u}, p)$ is specified, and $\\mathbf{f}$ is defined to satisfy the momentum equation exactly, this expression must be identical to the value of $\\mathbf{n} \\cdot \\nabla p$ computed directly from the given pressure field $p(x,y,t)$. This provides a direct path to the solution.\n\nThe boundary data $g(x,t)$ is therefore:\n$$\ng(x,t) = \\frac{\\partial p}{\\partial n}\\bigg|_{y=0} = \\nabla p(x,0,t) \\cdot \\mathbf{n}\n$$\nWith $\\mathbf{n}=(0,-1)$, we have:\n$$\ng(x,t) = \\left( \\frac{\\partial p}{\\partial x}, \\frac{\\partial p}{\\partial y} \\right)\\bigg|_{y=0} \\cdot (0,-1) = - \\frac{\\partial p}{\\partial y}\\bigg|_{y=0}\n$$\nWe now compute the partial derivative of $p$ with respect to $y$ and evaluate it at $y=0$.\n$$\n\\frac{\\partial p}{\\partial y} = \\frac{\\partial}{\\partial y} \\left( B \\cos(\\pi x)\\sin(\\pi y)\\sin(\\omega t) \\right) = B \\pi \\cos(\\pi x)\\cos(\\pi y)\\sin(\\omega t)\n$$\nEvaluating this expression at $y=0$:\n$$\n\\frac{\\partial p}{\\partial y}\\bigg|_{y=0} = B \\pi \\cos(\\pi x)\\cos(0)\\sin(\\omega t) = B \\pi \\cos(\\pi x)\\sin(\\omega t)\n$$\nFinally, the Neumann boundary data $g(x,t)$ is the negative of this result:\n$$\ng(x,t) = - B \\pi \\cos(\\pi x)\\sin(\\omega t)\n$$\nThis is the function that must be prescribed as the Neumann boundary condition for pressure on the $y=0$ boundary in a numerical simulation to match the exact manufactured solution. The derivation is consistent with enforcing the momentum balance at the boundary.",
            "answer": "$$\\boxed{-B \\pi \\cos(\\pi x)\\sin(\\omega t)}$$"
        }
    ]
}