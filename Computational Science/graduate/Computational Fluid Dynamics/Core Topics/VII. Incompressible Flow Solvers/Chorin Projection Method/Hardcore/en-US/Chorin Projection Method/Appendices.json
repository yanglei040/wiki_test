{
    "hands_on_practices": [
        {
            "introduction": "To implement the Chorin projection method numerically, we must first translate the continuous differential operators of vector calculus into discrete matrix operators. This exercise provides foundational practice in this process by guiding you through the construction of the discrete divergence, gradient, and Laplacian matrices for a simple one-dimensional staggered grid . Mastering this translation from continuous to discrete is a cornerstone of building a finite-volume or finite-difference based flow solver.",
            "id": "3301246",
            "problem": "Consider the incompressible Navier–Stokes equations in one spatial dimension on a Marker-and-Cell (MAC) grid in a channel of length $L$ with no-slip walls at $x=0$ and $x=L$. The velocity is stored at face locations and the pressure at cell centers. Let there be $N$ uniformly sized control volumes (cells), with cell centers indexed by $i=1,\\dots,N$ and faces indexed by $j=0,\\dots,N$. The grid spacing is $h=L/N$. The velocity component aligned with the channel is denoted by $u$, and incompressibility requires a discrete divergence equal to zero in every cell after the projection. The projection step of Chorin’s method enforces incompressibility by solving a discrete Poisson equation for the pressure and then correcting the intermediate velocity.\n\nStarting from the finite-volume statement of mass conservation (discrete divergence of face-normal fluxes per cell) and a centered-difference approximation of the pressure gradient at interior faces (with homogeneous Neumann boundary conditions at the walls consistent with no-slip and zero normal pressure gradient), do the following for the specific case $N=4$, $L=1$ m, $h=L/N$, density $\\rho=1$ kg/m$^3$, and time step $\\Delta t=0.2$ s:\n\n1. Define the discrete divergence operator $D \\in \\mathbb{R}^{N \\times (N+1)}$ that maps face velocities $\\boldsymbol{u} \\in \\mathbb{R}^{N+1}$ to cell-centered divergences, using second-order finite-volume flux differences. Write its explicit matrix entries for the ordering $\\boldsymbol{u} = \\big(u_0,u_1,\\dots,u_N\\big)^{\\mathsf{T}}$ and $\\boldsymbol{d} = D \\boldsymbol{u}$ with $\\boldsymbol{d} \\in \\mathbb{R}^{N}$ ordered by cells $i=1,\\dots,N$.\n\n2. Define the discrete gradient operator $G \\in \\mathbb{R}^{(N+1) \\times N}$ that maps cell-centered pressures $\\boldsymbol{p} \\in \\mathbb{R}^{N}$ to face-centered pressure gradients, with centered differences on interior faces $j=1,\\dots,N-1$ and homogeneous Neumann conditions at boundary faces $j=0$ and $j=N$. Write its explicit matrix entries.\n\n3. Form the discrete pressure Laplacian $L = D G \\in \\mathbb{R}^{N \\times N}$ and write its explicit matrix form. State the solvability condition for the Neumann problem and the gauge constraint you will use to obtain a unique pressure.\n\n4. Given the intermediate face-velocity vector (in m/s)\n$$\n\\boldsymbol{u}^{\\ast} \\;=\\; \\big(0,\\;0.8,\\;-0.4,\\;0.6,\\;0\\big)^{\\mathsf{T}},\n$$\nderive from first principles the discrete Poisson equation for pressure in the projection step and solve for the unique mean-zero discrete pressure $\\boldsymbol{p} \\in \\mathbb{R}^{N}$ (in Pa). Then compute the corrected face velocities via the projection update that enforces no-slip at the walls.\n\nWhat is the value of the pressure at the second cell center, $p_2$ (in Pa)? Round your answer to four significant figures and express it in Pascals (Pa).",
            "solution": "The problem asks for the value of the pressure at the second cell center, $p_2$, as part of a projection step in Chorin's method for the incompressible Navier-Stokes equations. The problem is well-defined and provides all necessary data and boundary conditions. We shall proceed by systematically constructing the discrete operators and solving the resulting pressure Poisson equation.\n\nThe given parameters for the specific case are:\n- Number of cells: $N=4$\n- Channel length: $L=1$ m\n- Cell width: $h = \\frac{L}{N} = \\frac{1}{4} = 0.25$ m\n- Fluid density: $\\rho=1$ kg/m$^3$\n- Time step: $\\Delta t = 0.2$ s\n- Intermediate velocity vector: $\\boldsymbol{u}^{\\ast} = \\big(0, 0.8, -0.4, 0.6, 0\\big)^{\\mathsf{T}}$ m/s\n\n**1. Discrete Divergence Operator $D$**\n\nThe discrete divergence operator $D$ maps face-centered velocities $\\boldsymbol{u} = \\big(u_0, u_1, u_2, u_3, u_4\\big)^{\\mathsf{T}}$ to cell-centered divergences $\\boldsymbol{d} = \\big(d_1, d_2, d_3, d_4\\big)^{\\mathsf{T}}$. For a uniform grid, the divergence in cell $i$ (with faces $i-1$ and $i$) is the net flux per unit volume (or area in 2D, length in 1D), which is given by:\n$$\nd_i = (\\nabla \\cdot \\boldsymbol{u})_i = \\frac{u_i - u_{i-1}}{h}\n$$\nfor $i=1, \\dots, N$. This defines the rows of the $N \\times (N+1)$ matrix $D$. With $N=4$ and $h=0.25$, so $1/h=4$, the operator is:\n$$\n\\boldsymbol{d} = D\\boldsymbol{u} = \\frac{1}{h}\n\\begin{pmatrix}\n-1 & 1 & 0 & 0 & 0 \\\\\n0 & -1 & 1 & 0 & 0 \\\\\n0 & 0 & -1 & 1 & 0 \\\\\n0 & 0 & 0 & -1 & 1\n\\end{pmatrix}\n\\begin{pmatrix} u_0 \\\\ u_1 \\\\ u_2 \\\\ u_3 \\\\ u_4 \\end{pmatrix}\n=\n4\n\\begin{pmatrix}\n-1 & 1 & 0 & 0 & 0 \\\\\n0 & -1 & 1 & 0 & 0 \\\\\n0 & 0 & -1 & 1 & 0 \\\\\n0 & 0 & 0 & -1 & 1\n\\end{pmatrix}\n\\begin{pmatrix} u_0 \\\\ u_1 \\\\ u_2 \\\\ u_3 \\\\ u_4 \\end{pmatrix}\n$$\n\n**2. Discrete Gradient Operator $G$**\n\nThe discrete gradient operator $G$ maps cell-centered pressures $\\boldsymbol{p} = \\big(p_1, p_2, p_3, p_4\\big)^{\\mathsf{T}}$ to face-centered gradients $(\\nabla p)_j$.\n- For interior faces $j=1, \\dots, N-1$, a centered difference is used. The gradient at face $j$ (between cells $j$ and $j+1$) is:\n  $$ (\\nabla p)_j = \\frac{p_{j+1} - p_j}{h} $$\n- For boundary faces $j=0$ and $j=N=4$, homogeneous Neumann conditions $(\\nabla p)_0 = 0$ and $(\\nabla p)_N = 0$ are applied.\n\nThis defines the $(N+1) \\times N$ matrix $G$:\n$$\nG \\boldsymbol{p} = \\frac{1}{h}\n\\begin{pmatrix}\n0 & 0 & 0 & 0 \\\\\n-1 & 1 & 0 & 0 \\\\\n0 & -1 & 1 & 0 \\\\\n0 & 0 & -1 & 1 \\\\\n0 & 0 & 0 & 0\n\\end{pmatrix}\n\\begin{pmatrix} p_1 \\\\ p_2 \\\\ p_3 \\\\ p_4 \\end{pmatrix}\n=\n4\n\\begin{pmatrix}\n0 & 0 & 0 & 0 \\\\\n-1 & 1 & 0 & 0 \\\\\n0 & -1 & 1 & 0 \\\\\n0 & 0 & -1 & 1 \\\\\n0 & 0 & 0 & 0\n\\end{pmatrix}\n\\begin{pmatrix} p_1 \\\\ p_2 \\\\ p_3 \\\\ p_4 \\end{pmatrix}\n$$\nIt is a common property for such discretizations that $G$ is the negative transpose of $D$, i.e., $D = -G^{\\mathsf{T}}$, if we neglect the boundary conditions. The zero rows in $G$ represent the Neumann boundary conditions.\n\n**3. Discrete Pressure Laplacian $L = DG$**\n\nThe discrete Laplacian is an $N \\times N$ matrix formed by the product $L=DG$.\n$$\nL = DG = \\frac{1}{h^2}\n\\begin{pmatrix}\n-1 & 1 & 0 & 0 & 0 \\\\\n0 & -1 & 1 & 0 & 0 \\\\\n0 & 0 & -1 & 1 & 0 \\\\\n0 & 0 & 0 & -1 & 1\n\\end{pmatrix}\n\\begin{pmatrix}\n0 & 0 & 0 & 0 \\\\\n-1 & 1 & 0 & 0 \\\\\n0 & -1 & 1 & 0 \\\\\n0 & 0 & -1 & 1 \\\\\n0 & 0 & 0 & 0\n\\end{pmatrix}\n$$\nPerforming the matrix multiplication gives:\n$$\nL = \\frac{1}{h^2}\n\\begin{pmatrix}\n-1 & 1 & 0 & 0 \\\\\n1 & -2 & 1 & 0 \\\\\n0 & 1 & -2 & 1 \\\\\n0 & 0 & 1 & -1\n\\end{pmatrix}\n$$\nSubstituting $h=0.25$, we have $1/h^2 = 1/(0.0625) = 16$.\n$$\nL = 16\n\\begin{pmatrix}\n-1 & 1 & 0 & 0 \\\\\n1 & -2 & 1 & 0 \\\\\n0 & 1 & -2 & 1 \\\\\n0 & 0 & 1 & -1\n\\end{pmatrix}\n$$\nThis is the standard 1D finite-difference representation of the second derivative with Neumann boundary conditions. The sum of the entries in each row is zero, which implies that the matrix $L$ is singular. Its null space consists of constant vectors $\\boldsymbol{c} = (c, c, \\dots, c)^{\\mathsf{T}}$. The solvability condition for the Neumann problem $L\\boldsymbol{p} = \\boldsymbol{f}$ is that the right-hand-side vector $\\boldsymbol{f}$ must be orthogonal to the null space of $L^{\\mathsf{T}}$. Since $L$ is symmetric ($L=L^{\\mathsf{T}}$), this means $\\boldsymbol{f}$ must be orthogonal to the constant vectors, which requires the sum of its components to be zero: $\\sum_{i=1}^N f_i = 0$. To obtain a unique solution for $\\boldsymbol{p}$, a gauge constraint is imposed, such as fixing one pressure value or requiring the mean pressure to be zero, as requested: $\\sum_{i=1}^N p_i = 0$.\n\n**4. Solve for the Pressure**\n\nThe projection step involves solving a Poisson equation for the pressure, which corrects the intermediate velocity field $\\boldsymbol{u}^*$ to be divergence-free. The update step is $\\boldsymbol{u}^{n+1} = \\boldsymbol{u}^* - \\frac{\\Delta t}{\\rho} \\nabla p$. Requiring $\\nabla \\cdot \\boldsymbol{u}^{n+1}=0$ leads to the pressure Poisson equation:\n$$\n\\nabla^2 p = \\frac{\\rho}{\\Delta t} \\nabla \\cdot \\boldsymbol{u}^*\n$$\nIn discrete form, this is $L\\boldsymbol{p} = \\frac{\\rho}{\\Delta t} D\\boldsymbol{u}^*$.\n\nFirst, we compute the right-hand side, $\\boldsymbol{f} = \\frac{\\rho}{\\Delta t} D\\boldsymbol{u}^*$.\n$$\n\\frac{\\rho}{\\Delta t} = \\frac{1 \\text{ kg/m}^3}{0.2 \\text{ s}} = 5 \\text{ kg/(m}^3 \\cdot \\text{s)}\n$$\n$$\nD\\boldsymbol{u}^* = \\frac{1}{h}\n\\begin{pmatrix} u_1^* - u_0^* \\\\ u_2^* - u_1^* \\\\ u_3^* - u_2^* \\\\ u_4^* - u_3^* \\end{pmatrix}\n= 4\n\\begin{pmatrix} 0.8 - 0 \\\\ -0.4 - 0.8 \\\\ 0.6 - (-0.4) \\\\ 0 - 0.6 \\end{pmatrix}\n= 4\n\\begin{pmatrix} 0.8 \\\\ -1.2 \\\\ 1.0 \\\\ -0.6 \\end{pmatrix}\n=\n\\begin{pmatrix} 3.2 \\\\ -4.8 \\\\ 4.0 \\\\ -2.4 \\end{pmatrix} \\text{ s}^{-1}\n$$\nThe sum of the components is $3.2 - 4.8 + 4.0 - 2.4 = 0$, satisfying the solvability condition. Now, we calculate $\\boldsymbol{f}$:\n$$\n\\boldsymbol{f} = 5 \\times D\\boldsymbol{u}^* =\n5 \\begin{pmatrix} 3.2 \\\\ -4.8 \\\\ 4.0 \\\\ -2.4 \\end{pmatrix}\n=\n\\begin{pmatrix} 16 \\\\ -24 \\\\ 20 \\\\ -12 \\end{pmatrix} \\text{ Pa/m}^2\n$$\nThe linear system to solve is $L\\boldsymbol{p} = \\boldsymbol{f}$:\n$$\n16\n\\begin{pmatrix}\n-1 & 1 & 0 & 0 \\\\\n1 & -2 & 1 & 0 \\\\\n0 & 1 & -2 & 1 \\\\\n0 & 0 & 1 & -1\n\\end{pmatrix}\n\\begin{pmatrix} p_1 \\\\ p_2 \\\\ p_3 \\\\ p_4 \\end{pmatrix}\n=\n\\begin{pmatrix} 16 \\\\ -24 \\\\ 20 \\\\ -12 \\end{pmatrix}\n$$\nDividing by $16$ gives the system of equations:\n1.  $-p_1 + p_2 = 1$\n2.  $p_1 - 2p_2 + p_3 = -1.5$\n3.  $p_2 - 2p_3 + p_4 = 1.25$\n4.  $p_3 - p_4 = -0.75$\n\nWe supplement these with the mean-zero gauge constraint:\n5.  $p_1 + p_2 + p_3 + p_4 = 0$\n\nFrom equation (1), $p_1 = p_2 - 1$.\nFrom equation (4), $p_4 = p_3 + 0.75$.\nSubstitute $p_1$ into equation (2):\n$(p_2 - 1) - 2p_2 + p_3 = -1.5 \\implies -p_2 + p_3 = -0.5 \\implies p_3 = p_2 - 0.5$.\nNow express $p_4$ in terms of $p_2$:\n$p_4 = p_3 + 0.75 = (p_2 - 0.5) + 0.75 = p_2 + 0.25$.\n\nWe have expressed all pressures in terms of $p_2$:\n- $p_1 = p_2 - 1$\n- $p_2 = p_2$\n- $p_3 = p_2 - 0.5$\n- $p_4 = p_2 + 0.25$\n\nNow, substitute these into the gauge constraint (5):\n$$ (p_2 - 1) + p_2 + (p_2 - 0.5) + (p_2 + 0.25) = 0 $$\n$$ 4p_2 - 1.25 = 0 $$\n$$ 4p_2 = 1.25 $$\n$$ p_2 = \\frac{1.25}{4} = \\frac{5/4}{4} = \\frac{5}{16} = 0.3125 $$\nThe value of the pressure at the second cell center, $p_2$, is $0.3125$ Pa. The question asks for the answer rounded to four significant figures, which is precisely $0.3125$.\n\nAs a final verification, we can compute the corrected velocity field $\\boldsymbol{u}^{n+1} = \\boldsymbol{u}^* - \\frac{\\Delta t}{\\rho} G \\boldsymbol{p}$.\nThe pressure vector is $\\boldsymbol{p} = (-0.6875, 0.3125, -0.1875, 0.5625)^{\\mathsf{T}}$.\nThe pressure gradient term is:\n$$\n\\frac{\\Delta t}{\\rho} G \\boldsymbol{p} = 0.2 \\times 4 \\times\n\\begin{pmatrix}\n0 \\\\\np_2 - p_1 \\\\\np_3 - p_2 \\\\\np_4 - p_3 \\\\\n0\n\\end{pmatrix}\n= 0.8\n\\begin{pmatrix}\n0 \\\\\n0.3125 - (-0.6875) \\\\\n-0.1875 - 0.3125 \\\\\n0.5625 - (-0.1875) \\\\\n0\n\\end{pmatrix}\n= 0.8\n\\begin{pmatrix}\n0 \\\\\n1 \\\\\n-0.5 \\\\\n0.75 \\\\\n0\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0 \\\\\n0.8 \\\\\n-0.4 \\\\\n0.6 \\\\\n0\n\\end{pmatrix}\n$$\nThe corrected velocity is:\n$$\n\\boldsymbol{u}^{n+1} = \\boldsymbol{u}^* - \\frac{\\Delta t}{\\rho} G \\boldsymbol{p} = \\begin{pmatrix} 0 \\\\ 0.8 \\\\ -0.4 \\\\ 0.6 \\\\ 0 \\end{pmatrix} - \\begin{pmatrix} 0 \\\\ 0.8 \\\\ -0.4 \\\\ 0.6 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\nThe final velocity is zero everywhere. It is trivially divergence-free ($D\\boldsymbol{u}^{n+1} = \\boldsymbol{0}$) and satisfies the no-slip boundary conditions ($u_0^{n+1}=0, u_4^{n+1}=0$). This confirms the calculations.\n\nThe value of the pressure at the second cell center, $p_2$, is $0.3125$ Pa.",
            "answer": "$$\\boxed{0.3125}$$"
        },
        {
            "introduction": "In practice, the large linear system for the pressure Poisson equation, $L p = b$, is almost always solved iteratively rather than exactly. This introduces a residual error, and a natural question arises: how does the tolerance of our linear solver affect the physical property we aim to enforce—incompressibility? This practice establishes and verifies the direct mathematical link between the solver's residual and the final mass conservation error, demonstrating that the divergence of the corrected velocity field is directly proportional to the solver's tolerance .",
            "id": "3301215",
            "problem": "Consider the incompressible Navier–Stokes equations and an operator-splitting scheme where the velocity is updated by a projection step to enforce incompressibility. In Chorin’s projection method, one first advances to an intermediate velocity field $u^\\ast$ using the momentum equations without pressure, and then enforces incompressibility by solving a Poisson equation for a pressure-like variable $p$ and projecting:\n$$\nu^{n+1} \\leftarrow u^\\ast - \\frac{\\Delta t}{\\rho}\\,\\nabla p,\n$$\nwith the intent that the corrected velocity satisfies the discrete divergence-free constraint. Assume a uniform Cartesian grid on a periodic square domain $[0,1]^2$, with grid spacing $h = 1/N$ in each direction, using a staggered Marker-And-Cell (MAC) discretization: horizontal velocity components are located at horizontal face centers and vertical velocity components at vertical face centers, while pressure and divergence are at cell centers. Denote by $\\nabla_h \\cdot$ the MAC discrete divergence mapping face-centered velocity to cell centers, by $\\nabla_h$ the MAC discrete gradient mapping cell-centered pressure to faces, and by $L_h$ the standard five-point discrete Laplacian at cell centers. The MAC operators satisfy the compatibility identity $\\nabla_h \\cdot \\nabla_h p = L_h p$ under periodic boundary conditions. Let $\\|\\cdot\\|_{2}$ denote the unweighted Euclidean norm of a vector of all grid values, and let $\\|\\cdot\\|_{L^2_h}$ denote the discrete $L^2$ norm on the domain defined by\n$$\n\\|q\\|_{L^2_h} \\equiv \\left( \\sum_{i,j} |q_{i,j}|^2\\, h^2 \\right)^{1/2}.\n$$\nIn the pressure projection, the pressure-like variable $p_h$ is computed by solving the discrete Poisson equation\n$$\nL_h p_h = b_h, \\quad \\text{with} \\quad b_h = \\frac{\\rho}{\\Delta t} \\, (\\nabla_h \\cdot u^\\ast),\n$$\nbut suppose the linear solve is inexact and terminates when a residual $r_h = L_h p_h - b_h$ meets a stopping criterion. The projection is then performed with this inexact $p_h$. Two common stopping criteria are:\n1. Absolute tolerance: $\\|r_h\\|_{2} \\le \\varepsilon_{\\mathrm{abs}}$ for a prescribed $\\varepsilon_{\\mathrm{abs}} > 0$.\n2. Relative tolerance: $\\|r_h\\|_{2} \\le \\varepsilon_{\\mathrm{rel}} \\, \\|b_h\\|_{2}$ for a prescribed $\\varepsilon_{\\mathrm{rel}} > 0$.\n\nStarting only from the fundamental properties of the MAC discretization, the definition of the projection update, and the norms above, derive a quantitative relationship between the discrete mass conservation error in the corrected velocity, measured by the discrete $L^2$ norm $\\|\\nabla_h \\cdot u^{n+1}\\|_{L^2_h}$, the solver tolerance (either $\\varepsilon_{\\mathrm{abs}}$ or $\\varepsilon_{\\mathrm{rel}}$), and the grid spacing $h$. Use dimensionless units with $\\rho = 1$ and $\\Delta t = 1$.\n\nThen implement a program that constructs a smooth face-centered intermediate velocity field $u^\\ast_h$ on the MAC grid by sampling the continuous field\n$$\nu_x(x,y) = \\sin(2\\pi x)\\,\\sin(2\\pi y), \\qquad u_y(x,y) = \\cos(2\\pi x)\\,\\sin(2\\pi y),\n$$\nat the appropriate face locations on a uniform periodic grid, computes the corresponding $b_h = \\nabla_h \\cdot u^\\ast_h$ at cell centers, and evaluates the predicted discrete mass conservation error $\\|\\nabla_h \\cdot u^{n+1}\\|_{L^2_h}$ implied by the derived relationship under both stopping criteria, without actually solving the linear system. Use the identity that connects $\\nabla_h \\cdot u^{n+1}$ to the residual $r_h$ and the relation between the discrete norms to evaluate the error magnitude for a given tolerance.\n\nConstruct the following test suite to probe different scalings:\n- Absolute-tolerance scaling with tolerance at fixed grid resolution: fix $N = 64$ and compute the slope (base-$e$ logarithmic regression) of $\\log \\|\\nabla_h \\cdot u^{n+1}\\|_{L^2_h}$ versus $\\log \\varepsilon_{\\mathrm{abs}}$ using $\\varepsilon_{\\mathrm{abs}} \\in \\{10^{-6}, 5\\times 10^{-7}, 2.5\\times 10^{-7}\\}$.\n- Absolute-tolerance scaling with grid spacing at fixed tolerance: fix $\\varepsilon_{\\mathrm{abs}} = 10^{-6}$ and compute the slope of $\\log \\|\\nabla_h \\cdot u^{n+1}\\|_{L^2_h}$ versus $\\log h$ using $N \\in \\{32, 64, 128\\}$ (so $h \\in \\{1/32,1/64,1/128\\}$).\n- Relative-tolerance scaling with tolerance at fixed grid resolution: fix $N = 64$ and compute the slope of $\\log \\|\\nabla_h \\cdot u^{n+1}\\|_{L^2_h}$ versus $\\log \\varepsilon_{\\mathrm{rel}}$ using $\\varepsilon_{\\mathrm{rel}} \\in \\{10^{-6}, 5\\times 10^{-7}, 2.5\\times 10^{-7}\\}$.\n- Relative-tolerance scaling with grid spacing at fixed tolerance: fix $\\varepsilon_{\\mathrm{rel}} = 10^{-6}$ and compute the slope of $\\log \\|\\nabla_h \\cdot u^{n+1}\\|_{L^2_h}$ versus $\\log h$ using $N \\in \\{32, 64, 128\\}$.\n\nFor each of the four bullets above, estimate the slope by least-squares fitting of a line to the pairs $(\\log x,\\log y)$, where $x$ is $\\varepsilon_{\\mathrm{abs}}$, $h$, $\\varepsilon_{\\mathrm{rel}}$, or $h$ as appropriate, and $y$ is the corresponding $\\|\\nabla_h \\cdot u^{n+1}\\|_{L^2_h}$. Your program should output a single line containing the four slopes, in this order:\n- first, the absolute-tolerance slope with respect to $\\varepsilon_{\\mathrm{abs}}$,\n- second, the absolute-tolerance slope with respect to $h$,\n- third, the relative-tolerance slope with respect to $\\varepsilon_{\\mathrm{rel}}$,\n- fourth, the relative-tolerance slope with respect to $h$,\nrounded to three decimal places.\n\nFinal Output Format: Your program should produce a single line of output containing the four slopes as a comma-separated list enclosed in square brackets, for example, \"[s1,s2,s3,s4]\". Since the outputs are dimensionless slopes, no physical units are required.",
            "solution": "The user has provided a valid problem statement.\n\n### Step 1: Givens Extraction\n- **Governing Equations**: Incompressible Navier–Stokes equations.\n- **Numerical Method**: Chorin’s projection method.\n- **Projection Step**: $u^{n+1} \\leftarrow u^\\ast - \\frac{\\Delta t}{\\rho}\\,\\nabla p$.\n- **Domain and Grid**: Periodic square domain $[0,1]^2$, uniform Cartesian grid, spacing $h = 1/N$.\n- **Discretization**: Staggered Marker-And-Cell (MAC).\n- **Discrete Operators**: $\\nabla_h \\cdot$ (divergence), $\\nabla_h$ (gradient), $L_h$ (Laplacian).\n- **Operator Identity**: $\\nabla_h \\cdot \\nabla_h p = L_h p$ under periodic boundary conditions.\n- **Norms**:\n    - Euclidean norm: $\\|\\cdot\\|_{2}$.\n    - Discrete $L^2$ norm: $\\|q\\|_{L^2_h} \\equiv \\left( \\sum_{i,j} |q_{i,j}|^2\\, h^2 \\right)^{1/2}$.\n- **Pressure Poisson Problem**: $L_h p_h = b_h$, where $b_h = \\frac{\\rho}{\\Delta t} \\, (\\nabla_h \\cdot u^\\ast)$.\n- **Inexact Solve**: Residual is $r_h = L_h p_h - b_h$.\n- **Stopping Criteria**:\n    1.  Absolute: $\\|r_h\\|_{2} \\le \\varepsilon_{\\mathrm{abs}}$.\n    2.  Relative: $\\|r_h\\|_{2} \\le \\varepsilon_{\\mathrm{rel}} \\, \\|b_h\\|_{2}$.\n- **Constants**: Dimensionless units with $\\rho = 1$ and $\\Delta t = 1$.\n- **Objective 1 (Derivation)**: Derive the relationship between $\\|\\nabla_h \\cdot u^{n+1}\\|_{L^2_h}$, the tolerance ($\\varepsilon_{\\mathrm{abs}}$ or $\\varepsilon_{\\mathrm{rel}}$), and grid spacing $h$.\n- **Objective 2 (Implementation)**: Implement a program to compute the predicted mass conservation error for a given intermediate velocity field and test different scaling laws.\n- **Intermediate Velocity Field**: $u_x(x,y) = \\sin(2\\pi x)\\,\\sin(2\\pi y)$, $u_y(x,y) = \\cos(2\\pi x)\\,\\sin(2\\pi y)$.\n- **Test Cases**:\n    - Case 1: $N = 64$, $\\varepsilon_{\\mathrm{abs}} \\in \\{10^{-6}, 5\\times 10^{-7}, 2.5\\times 10^{-7}\\}$.\n    - Case 2: $\\varepsilon_{\\mathrm{abs}} = 10^{-6}$, $N \\in \\{32, 64, 128\\}$.\n    - Case 3: $N = 64$, $\\varepsilon_{\\mathrm{rel}} \\in \\{10^{-6}, 5\\times 10^{-7}, 2.5\\times 10^{-7}\\}$.\n    - Case 4: $\\varepsilon_{\\mathrm{rel}} = 10^{-6}$, $N \\in \\{32, 64, 128\\}$.\n- **Output**: Four slopes from base-$e$ logarithmic regression, rounded to three decimal places, in the format `[s1,s2,s3,s4]`.\n\n### Step 2: Problem Validation\nThe problem is scientifically grounded in the principles of computational fluid dynamics, specifically concerning projection methods for incompressible flow. It is well-posed, with all necessary definitions and data provided to perform the required derivation and numerical computation. The language is objective and unambiguous. The problem is a standard exercise in analyzing the properties of numerical schemes and is neither trivial nor ill-posed. All criteria for a valid problem are met.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\n### Principle-Based Solution\n\nThe objective is to derive a quantitative relationship between the discrete mass conservation error of the projected velocity field, $\\|\\nabla_h \\cdot u^{n+1}\\|_{L^2_h}$, and the parameters of the numerical method, namely the solver tolerance and grid spacing.\n\n**1. Connecting Divergence Error to the Poisson Solver Residual**\n\nThe projection method updates the velocity in two steps. We are concerned with the second step, the projection, which enforces the incompressibility constraint. The discrete update rule for the velocity field $u_h$ is given as:\n$$\nu_h^{n+1} = u_h^\\ast - \\frac{\\Delta t}{\\rho} \\nabla_h p_h\n$$\nwhere $u_h^{n+1}$ is the new velocity, $u_h^\\ast$ is the intermediate velocity, $\\nabla_h p_h$ is the discrete pressure gradient, $\\Delta t$ is the time step, and $\\rho$ is the density. The problem states to use dimensionless units where $\\rho = 1$ and $\\Delta t = 1$, simplifying the equation to:\n$$\nu_h^{n+1} = u_h^\\ast - \\nabla_h p_h\n$$\nTo assess the mass conservation of the new velocity field, we apply the discrete divergence operator, $\\nabla_h \\cdot$, to this equation. This operator maps face-centered velocity data to cell-centered divergence data.\n$$\n\\nabla_h \\cdot u_h^{n+1} = \\nabla_h \\cdot u_h^\\ast - \\nabla_h \\cdot (\\nabla_h p_h)\n$$\nThe problem provides the identity for the MAC discretization on a periodic domain: $\\nabla_h \\cdot \\nabla_h p_h = L_h p_h$, where $L_h$ is the discrete Laplacian operator on cell-centered data. Substituting this identity gives:\n$$\n\\nabla_h \\cdot u_h^{n+1} = \\nabla_h \\cdot u_h^\\ast - L_h p_h\n$$\nThe pressure-like variable $p_h$ is obtained by solving the discrete Poisson equation $L_h p_h = b_h$, where the source term is $b_h = \\frac{\\rho}{\\Delta t} \\nabla_h \\cdot u_h^\\ast$. With our unit constants, this becomes $b_h = \\nabla_h \\cdot u_h^\\ast$. The problem specifies that this linear system is solved inexactly, resulting in a non-zero residual $r_h$:\n$$\nr_h = L_h p_h - b_h\n$$\nWe can rearrange this definition of the residual to express $L_h p_h$ as $L_h p_h = b_h + r_h$. Substituting this and the definition of $b_h$ into the equation for the divergence of $u_h^{n+1}$:\n$$\n\\nabla_h \\cdot u_h^{n+1} = b_h - (b_h + r_h)\n$$\nThis simplifies to a fundamental identity for projection methods:\n$$\n\\nabla_h \\cdot u_h^{n+1} = -r_h\n$$\nThis result shows that the discrete divergence of the projected velocity field is exactly equal to the negative of the residual from the inexact pressure Poisson solve.\n\n**2. Relating Norms**\n\nThe problem requires us to quantify the error using the discrete $L^2_h$ norm. From the identity above, we have:\n$$\n\\|\\nabla_h \\cdot u_h^{n+1}\\|_{L^2_h} = \\|-r_h\\|_{L^2_h} = \\|r_h\\|_{L^2_h}\n$$\nThe stopping criteria for the linear solver are given in terms of the unweighted Euclidean norm, $\\|\\cdot\\|_2$. We must relate the $\\|\\cdot\\|_{L^2_h}$ norm to the $\\|\\cdot\\|_2$ norm. For any grid function $q_h$ defined on the $N \\times N$ cell centers, the definitions are:\n$$\n\\|q_h\\|_{L^2_h}^2 = \\sum_{i,j=0}^{N-1} |q_{h,i,j}|^2 h^2 \\quad \\text{and} \\quad \\|q_h\\|_2^2 = \\sum_{i,j=0}^{N-1} |q_{h,i,j}|^2\n$$\nBy factoring out the constant $h^2$ from the first sum, we find the direct relationship:\n$$\n\\|q_h\\|_{L^2_h}^2 = h^2 \\|q_h\\|_2^2 \\implies \\|q_h\\|_{L^2_h} = h \\|q_h\\|_2\n$$\nApplying this to the residual $r_h$, we obtain the central expression for the divergence error:\n$$\n\\|\\nabla_h \\cdot u_h^{n+1}\\|_{L^2_h} = h \\|r_h\\|_2\n$$\n\n**3. Analysis of Stopping Criteria**\n\nWe now analyze the two specified stopping criteria by substituting them into this expression. We assume the solver terminates at the boundary of the criterion, representing the worst-case scenario.\n\n**Case A: Absolute Tolerance**\nThe stopping criterion is $\\|r_h\\|_2 \\le \\varepsilon_{\\mathrm{abs}}$. At termination, we have $\\|r_h\\|_2 \\approx \\varepsilon_{\\mathrm{abs}}$. The divergence error is thus:\n$$\n\\|\\nabla_h \\cdot u_h^{n+1}\\|_{L^2_h} \\approx h \\varepsilon_{\\mathrm{abs}}\n$$\nThis relationship predicts the following scaling laws:\n- At a fixed grid resolution (fixed $h$), the error $\\|\\nabla_h \\cdot u_h^{n+1}\\|_{L^2_h}$ is directly proportional to $\\varepsilon_{\\mathrm{abs}}$. The slope of $\\log(\\|\\nabla_h \\cdot u_h^{n+1}\\|_{L^2_h})$ versus $\\log(\\varepsilon_{\\mathrm{abs}})$ is $1$.\n- At a fixed tolerance (fixed $\\varepsilon_{\\mathrm{abs}}$), the error is directly proportional to $h$. The slope of $\\log(\\|\\nabla_h \\cdot u_h^{n+1}\\|_{L^2_h})$ versus $\\log(h)$ is $1$.\n\n**Case B: Relative Tolerance**\nThe stopping criterion is $\\|r_h\\|_2 \\le \\varepsilon_{\\mathrm{rel}} \\|b_h\\|_2$. At termination, we have $\\|r_h\\|_2 \\approx \\varepsilon_{\\mathrm{rel}} \\|b_h\\|_2$. The divergence error is:\n$$\n\\|\\nabla_h \\cdot u_h^{n+1}\\|_{L^2_h} \\approx h \\varepsilon_{\\mathrm{rel}} \\|b_h\\|_2\n$$\nTo understand the scaling with respect to $h$, we must determine how $\\|b_h\\|_2$ depends on $h$. The term $b_h = \\nabla_h \\cdot u_h^\\ast$ is a discrete approximation of the continuous divergence $\\nabla \\cdot u$. For a smooth velocity field, the discrete operator $\\nabla_h \\cdot$ is consistent, meaning $(\\nabla_h \\cdot u_h^\\ast)(x,y) \\to (\\nabla \\cdot u)(x,y)$ as $h \\to 0$. The discrete $L^2_h$ norm is designed to approximate the continuous $L^2$ integral norm:\n$$\n\\|b_h\\|_{L^2_h}^2 = \\sum_{i,j} |b_{h,i,j}|^2 h^2 \\xrightarrow{h \\to 0} \\int_{[0,1]^2} |(\\nabla \\cdot u)(x,y)|^2 dx dy\n$$\nThe integral on the right is a constant for a given continuous field $u$. Therefore, for small $h$, $\\|b_h\\|_{L^2_h}$ is approximately constant. Using the relationship between norms, $\\|b_h\\|_2 = h^{-1}\\|b_h\\|_{L^2_h}$, we deduce the scaling:\n$$\n\\|b_h\\|_2 \\propto h^{-1}\n$$\nSubstituting this scaling back into the error expression for the relative tolerance case:\n$$\n\\|\\nabla_h \\cdot u_h^{n+1}\\|_{L^2_h} \\approx h \\varepsilon_{\\mathrm{rel}} (C h^{-1}) = C \\varepsilon_{\\mathrm{rel}}\n$$\nwhere $C$ is a constant related to the $L^2$ norm of the continuous divergence. This relationship predicts:\n- At a fixed grid resolution (fixed $h$), the error $\\|\\nabla_h \\cdot u_h^{n+1}\\|_{L^2_h}$ is directly proportional to $\\varepsilon_{\\mathrm{rel}}$. The slope of $\\log(\\|\\nabla_h \\cdot u_h^{n+1}\\|_{L^2_h})$ versus $\\log(\\varepsilon_{\\mathrm{rel}})$ is $1$.\n- At a fixed tolerance (fixed $\\varepsilon_{\\mathrm{rel}}$), the error is approximately independent of the grid spacing $h$. The slope of $\\log(\\|\\nabla_h \\cdot u_h^{n+1}\\|_{L^2_h})$ versus $\\log(h)$ is $0$.\n\nThe provided problem requires implementing a program to numerically verify these four predicted slopes.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_bh_norm2(N):\n    \"\"\"\n    Computes the Euclidean norm of the discrete divergence of the\n    intermediate velocity field u* on a MAC grid.\n\n    Args:\n        N (int): The number of grid cells in each direction.\n\n    Returns:\n        float: The Euclidean L2 norm of the discrete divergence vector b_h.\n    \"\"\"\n    h = 1.0 / N\n    \n    # Create grid indices for an N x N grid\n    j_idx, i_idx = np.indices((N, N))\n\n    # Define coordinates for the horizontal (u) velocity components\n    # ux is located at (i*h, (j+0.5)*h)\n    x_u = i_idx * h\n    y_u = (j_idx + 0.5) * h\n    \n    # Define coordinates for the vertical (v) velocity components\n    # uy is located at ((i+0.5)*h, j*h)\n    x_v = (i_idx + 0.5) * h\n    y_v = j_idx * h\n\n    # Sample the continuous velocity field to get the discrete intermediate velocity u*\n    # u_x(x,y) = sin(2*pi*x)*sin(2*pi*y)\n    # u_y(x,y) = cos(2*pi*x)*sin(2*pi*y)\n    ux_h = np.sin(2 * np.pi * x_u) * np.sin(2 * np.pi * y_u)\n    uy_h = np.cos(2 * np.pi * x_v) * np.sin(2 * np.pi * y_v)\n\n    # Compute the discrete divergence b_h = nabla_h . u* at cell centers.\n    # The divergence at cell (j,i) is (u_right - u_left)/h + (u_top - u_bottom)/h.\n    # On a periodic MAC grid, u_left of cell (j,i) is ux_h[j,i] and u_right is ux_h[j,(i+1)%N].\n    # Similarly, u_bottom is uy_h[j,i] and u_top is uy_h[(j+1)%N,i].\n    # We use np.roll for efficient periodic boundary handling.\n    # np.roll(ux_h, -1, axis=1) corresponds to ux_h[j, (i+1)%N]\n    # np.roll(uy_h, -1, axis=0) corresponds to uy_h[(j+1)%N, i]\n    b_h = ((np.roll(ux_h, -1, axis=1) - ux_h) + (np.roll(uy_h, -1, axis=0) - uy_h)) / h\n    \n    # The Euclidean norm ||b_h||_2 is equivalent to the Frobenius norm of the matrix\n    b_h_norm2 = np.linalg.norm(b_h)\n    \n    return b_h_norm2\n\ndef get_slope(x_values, y_values):\n    \"\"\"\n    Performs a linear regression on the base-e logarithm of the data.\n\n    Args:\n        x_values (np.ndarray): The independent variable values.\n        y_values (np.ndarray): The dependent variable values.\n\n    Returns:\n        float: The slope of the line fitted to (log(x), log(y)).\n    \"\"\"\n    log_x = np.log(x_values)\n    log_y = np.log(y_values)\n    # np.polyfit with degree 1 returns [slope, intercept]\n    slope, _ = np.polyfit(log_x, log_y, 1)\n    return slope\n\ndef solve():\n    \"\"\"\n    Main function to perform the four scaling tests and print the results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # 1. Absolute tolerance scaling with tol, fixed N\n        {'N_vals': np.array([64]), 'eps_vals': np.array([1e-6, 5e-7, 2.5e-7]), 'mode': 'abs_vs_eps'},\n        # 2. Absolute tolerance scaling with h, fixed tol\n        {'N_vals': np.array([32, 64, 128]), 'eps_vals': np.array([1e-6]), 'mode': 'abs_vs_h'},\n        # 3. Relative tolerance scaling with tol, fixed N\n        {'N_vals': np.array([64]), 'eps_vals': np.array([1e-6, 5e-7, 2.5e-7]), 'mode': 'rel_vs_eps'},\n        # 4. Relative tolerance scaling with h, fixed tol\n        {'N_vals': np.array([32, 64, 128]), 'eps_vals': np.array([1e-6]), 'mode': 'rel_vs_h'},\n    ]\n\n    results = []\n\n    # Case 1: Absolute tolerance vs. epsilon_abs\n    case1 = test_cases[0]\n    N1 = case1['N_vals'][0]\n    h1 = 1.0 / N1\n    eps_abs_vals = case1['eps_vals']\n    # Derived relationship: ||div u||_L2h = h * eps_abs\n    errors1 = h1 * eps_abs_vals\n    slope1 = get_slope(eps_abs_vals, errors1)\n    results.append(slope1)\n\n    # Case 2: Absolute tolerance vs. h\n    case2 = test_cases[1]\n    N_vals2 = case2['N_vals']\n    h_vals2 = 1.0 / N_vals2\n    eps_abs2 = case2['eps_vals'][0]\n    # Derived relationship: ||div u||_L2h = h * eps_abs\n    errors2 = h_vals2 * eps_abs2\n    slope2 = get_slope(h_vals2, errors2)\n    results.append(slope2)\n\n    # Case 3: Relative tolerance vs. epsilon_rel\n    case3 = test_cases[2]\n    N3 = case3['N_vals'][0]\n    h3 = 1.0 / N3\n    eps_rel_vals = case3['eps_vals']\n    b_h_norm2_N64 = compute_bh_norm2(N3)\n    # Derived relationship: ||div u||_L2h = h * eps_rel * ||b_h||_2\n    errors3 = h3 * eps_rel_vals * b_h_norm2_N64\n    slope3 = get_slope(eps_rel_vals, errors3)\n    results.append(slope3)\n\n    # Case 4: Relative tolerance vs. h\n    case4 = test_cases[3]\n    N_vals4 = case4['N_vals']\n    h_vals4 = 1.0 / N_vals4\n    eps_rel4 = case4['eps_vals'][0]\n    errors4 = []\n    for N_val in N_vals4:\n        h_val = 1.0 / N_val\n        b_h_norm2 = compute_bh_norm2(N_val)\n        # Derived relationship: ||div u||_L2h = h * eps_rel * ||b_h||_2\n        error = h_val * eps_rel4 * b_h_norm2\n        errors4.append(error)\n    errors4 = np.array(errors4)\n    slope4 = get_slope(h_vals4, errors4)\n    results.append(slope4)\n\n    # Final print statement in the exact required format.\n    print(f\"[{results[0]:.3f},{results[1]:.3f},{results[2]:.3f},{results[3]:.3f}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "The overall accuracy of Chorin's method is limited not just by the projection step, but also by the \"operator splitting error\" inherent in treating the pressure and advection-diffusion terms in separate stages. This advanced exercise uses the powerful Method of Manufactured Solutions to isolate and quantify this specific error . By comparing a case with a significant pressure gradient to one with none, you will numerically verify the theoretical convergence rates and gain a deeper understanding of the method's intrinsic limitations.",
            "id": "3301208",
            "problem": "Consider the two-dimensional incompressible Navier–Stokes equations as the fundamental base for Computational Fluid Dynamics (CFD): $$\\partial_t \\mathbf{u} + (\\mathbf{u}\\cdot\\nabla)\\mathbf{u} = -\\nabla p + \\nu \\Delta \\mathbf{u} + \\mathbf{f},\\quad \\nabla\\cdot \\mathbf{u} = 0,$$ where $\\mathbf{u}(x,y,t)$ is the velocity, $p(x,y,t)$ is the kinematic pressure, $\\nu$ is the kinematic viscosity, and $\\mathbf{f}(x,y,t)$ is a body force. Chorin’s projection method splits the time advancement by first computing a tentative (pre-projection) velocity $\\mathbf{u}^\\star$ that omits the pressure gradient contribution, and then projecting $\\mathbf{u}^\\star$ onto a divergence-free field via a Pressure Poisson Equation (PPE). The splitting error arises from the omission of $-\\nabla p$ in the tentative update.\n\nUsing the Method of Manufactured Solutions, define two smooth, divergence-free exact solutions on the periodic domain $[0,2\\pi]\\times[0,2\\pi]$:\n\n- Case A (Taylor–Green vortex): $$\\mathbf{u}(x,y,t) = \\begin{bmatrix} -U_0 \\cos(x)\\sin(y)\\, e^{-2\\nu t} \\\\ U_0 \\sin(x)\\cos(y)\\, e^{-2\\nu t} \\end{bmatrix},\\quad p(x,y,t) = \\frac{U_0^2}{4}\\big(\\cos(2x) + \\cos(2y)\\big) e^{-4\\nu t},\\quad \\mathbf{f}=\\mathbf{0}.$$\n\n- Case B (diffusing shear, zero pressure gradient): $$\\mathbf{u}(x,y,t) = \\begin{bmatrix} \\sin(y)\\, e^{-\\nu t} \\\\ 0 \\end{bmatrix},\\quad p(x,y,t) = \\text{constant},\\quad \\mathbf{f}=\\mathbf{0}.$$\n\nBoth cases satisfy the incompressible equations with the given $p$ and $\\mathbf{f}$ under periodic boundary conditions. Let the viscosity be $\\nu = 0.1$ and let $U_0=1$.\n\nDefine the Chorin tentative update at time $t^n$ with time step $\\Delta t$ by explicitly advancing the non-pressure terms only: $$\\mathbf{u}^\\star = \\mathbf{u}(t^n) + \\Delta t\\left(-(\\mathbf{u}\\cdot\\nabla)\\mathbf{u} + \\nu \\Delta \\mathbf{u} + \\mathbf{f}\\right)\\Big|_{t=t^n}.$$ Use the exact manufactured $\\mathbf{u}(t^n)$ to evaluate all spatial derivatives exactly (analytically), and do not perform the projection step. For each case, compute the error $$E(\\Delta t) = \\left\\|\\mathbf{u}^\\star - \\mathbf{u}(t^n+\\Delta t)\\right\\|_{L^2(\\Omega)},$$ where $\\Omega=[0,2\\pi]\\times[0,2\\pi]$ and the $L^2$ norm is taken over the domain with respect to area measure. This error isolates the splitting effect of omitting $-\\nabla p$ in the tentative step (Case A is expected to be dominated by a first-order $\\Delta t$ term due to nonzero $\\nabla p$, whereas Case B should exhibit higher-order decay because $\\nabla p=\\mathbf{0}$).\n\nYour program must:\n- Evaluate the $L^2$ error by numerical quadrature on a uniform grid over $[0,2\\pi]\\times[0,2\\pi]$ using periodic sampling and the exact analytical expressions for $(\\mathbf{u}\\cdot\\nabla)\\mathbf{u}$, $\\Delta \\mathbf{u}$, and $\\nabla p$ implied by the manufactured fields.\n- Use the time set $t^n = 0$.\n- Use the following test suite of time steps: $\\Delta t \\in \\{0.2, 0.1, 0.05, 0.025, 0.0125\\}$.\n- For each case, report the list of $L^2$ errors $E(\\Delta t)$ for the five $\\Delta t$ values, and then report the observed order of decay computed as the slope from a least-squares fit of $\\log E$ versus $\\log \\Delta t$ (i.e., estimate $q$ in $E \\approx C\\,\\Delta t^{\\,q}$).\n\nFinal output format:\n- Your program should produce a single line of output containing a comma-separated list enclosed in square brackets, with entries in the following order: first the five errors for Case A (Taylor–Green vortex) from largest to smallest $\\Delta t$, then the single float giving the estimated order for Case A, then the five errors for Case B (diffusing shear) from largest to smallest $\\Delta t$, then the single float giving the estimated order for Case B. For example, a line with the pattern \"[E_A(0.2),E_A(0.1),E_A(0.05),E_A(0.025),E_A(0.0125),q_A,E_B(0.2),E_B(0.1),E_B(0.05),E_B(0.025),E_B(0.0125),q_B]\".",
            "solution": "The user wants to analyze the splitting error of Chorin's projection method for two different manufactured solutions to the 2D incompressible Navier-Stokes equations.\n\n### Step 1: Extract Givens\n\n- **Governing Equations**:\n  - Momentum: $\\partial_t \\mathbf{u} + (\\mathbf{u}\\cdot\\nabla)\\mathbf{u} = -\\nabla p + \\nu \\Delta \\mathbf{u} + \\mathbf{f}$\n  - Incompressibility: $\\nabla\\cdot \\mathbf{u} = 0$\n- **Domain**: Periodic box $\\Omega = [0,2\\pi]\\times[0,2\\pi]$.\n- **Physical Parameters**: Kinematic viscosity $\\nu = 0.1$.\n- **Case A (Taylor-Green Vortex)**:\n  - Velocity: $\\mathbf{u}(x,y,t) = \\begin{bmatrix} -U_0 \\cos(x)\\sin(y)\\, e^{-2\\nu t} \\\\ U_0 \\sin(x)\\cos(y)\\, e^{-2\\nu t} \\end{bmatrix}$\n  - Pressure: $p(x,y,t) = \\frac{U_0^2}{4}\\big(\\cos(2x) + \\cos(2y)\\big) e^{-4\\nu t}$\n  - Forcing: $\\mathbf{f}=\\mathbf{0}$\n  - Amplitude: $U_0=1$\n- **Case B (Diffusing Shear)**:\n  - Velocity: $\\mathbf{u}(x,y,t) = \\begin{bmatrix} \\sin(y)\\, e^{-\\nu t} \\\\ 0 \\end{bmatrix}$\n  - Pressure: $p(x,y,t) = \\text{constant}$\n  - Forcing: $\\mathbf{f}=\\mathbf{0}$\n- **Numerical Method**: Chorin tentative velocity update (first step only).\n  - Update Formula: $\\mathbf{u}^\\star = \\mathbf{u}(t^n) + \\Delta t\\left(-(\\mathbf{u}\\cdot\\nabla)\\mathbf{u} + \\nu \\Delta \\mathbf{u} + \\mathbf{f}\\right)\\Big|_{t=t^n}$\n- **Problem Setup**:\n  - Time: $t^n = 0$.\n  - All spatial derivatives in the update formula are evaluated analytically using the manufactured solution.\n- **Error Metric**:\n  - Definition: $E(\\Delta t) = \\left\\|\\mathbf{u}^\\star - \\mathbf{u}(t^n+\\Delta t)\\right\\|_{L^2(\\Omega)}$\n- **Test Suite**:\n  - Time steps: $\\Delta t \\in \\{0.2, 0.1, 0.05, 0.025, 0.0125\\}$.\n- **Task**:\n  1. For each case, compute the $L^2$ error $E(\\Delta t)$ for all specified $\\Delta t$ values using numerical quadrature.\n  2. For each case, compute the observed order of decay, $q$, from a least-squares fit of $\\log E$ versus $\\log \\Delta t$.\n- **Output Format**: A single line `[E_A(0.2), ..., E_A(0.0125), q_A, E_B(0.2), ..., E_B(0.0125), q_B]`.\n\n### Step 2: Validate Using Extracted Givens\n\n- **Scientific Grounding**: The problem is rooted in the fundamental Navier-Stokes equations and a standard, widely used numerical algorithm (Chorin's projection method). The Method of Manufactured Solutions is a cornerstone technique for code verification in scientific computing. The chosen manufactured solutions (Taylor-Green vortex, diffusing shear) are classical and correct examples. The problem is scientifically and mathematically sound.\n- **Well-Posedness**: The task is to compute a well-defined error quantity based on analytically specified functions and parameters. The procedure for calculating the error and the order of convergence is explicitly described. A unique and meaningful solution exists.\n- **Objectivity**: The problem statement is precise, quantitative, and free of subjective or ambiguous language. All terms are formally defined.\n\nThe problem does not exhibit any of the invalidity flaws. It is self-contained, consistent, and scientifically grounded.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. I will proceed to generate the solution.\n\n### Principle-Based Design of the Solution\n\nThe solution requires calculating the error resulting from the first step of Chorin's projection method. This error isolates the effect of operator splitting, specifically the failure to account for the pressure gradient in the tentative velocity update.\n\nThe core of the problem lies in evaluating the error term $\\mathbf{e}(\\Delta t) = \\mathbf{u}^\\star - \\mathbf{u}(t^n + \\Delta t)$.\nThe tentative velocity $\\mathbf{u}^\\star$ is given by:\n$$ \\mathbf{u}^\\star = \\mathbf{u}(t^n) + \\Delta t \\left( -(\\mathbf{u}\\cdot\\nabla)\\mathbf{u} + \\nu \\Delta \\mathbf{u} + \\mathbf{f} \\right)\\Big|_{t=t^n} $$\nSince the manufactured solution exactly satisfies the Navier-Stokes equation, $\\partial_t \\mathbf{u} + (\\mathbf{u}\\cdot\\nabla)\\mathbf{u} = -\\nabla p + \\nu \\Delta \\mathbf{u} + \\mathbf{f}$, we can substitute the non-pressure terms:\n$$ -(\\mathbf{u}\\cdot\\nabla)\\mathbf{u} + \\nu \\Delta \\mathbf{u} + \\mathbf{f} = \\partial_t \\mathbf{u} + \\nabla p $$\nSubstituting this into the expression for $\\mathbf{u}^\\star$ gives a more direct form:\n$$ \\mathbf{u}^\\star = \\mathbf{u}(t^n) + \\Delta t \\left( \\partial_t \\mathbf{u} + \\nabla p \\right) \\Big|_{t=t^n} $$\nThe error vector is then:\n$$ \\mathbf{e}(\\Delta t) = \\left[ \\mathbf{u}(t^n) + \\Delta t \\left( \\partial_t \\mathbf{u} + \\nabla p \\right)\\Big|_{t=t^n} \\right] - \\mathbf{u}(t^n + \\Delta t) $$\nA Taylor series expansion of $\\mathbf{u}(t^n + \\Delta t)$ around $t^n$ is $\\mathbf{u}(t^n) + \\Delta t \\partial_t\\mathbf{u}|_{t^n} + \\frac{(\\Delta t)^2}{2} \\partial_{tt}\\mathbf{u}|_{t^n} + \\mathcal{O}((\\Delta t)^3)$.\nSubstituting this into the error expression yields the leading-order behavior of the error vector:\n$$ \\mathbf{e}(\\Delta t) = \\Delta t \\, \\nabla p|_{t^n} - \\frac{(\\Delta t)^2}{2} \\partial_{tt}\\mathbf{u}|_{t^n} + \\mathcal{O}((\\Delta t)^3) $$\nThis shows that the error is first-order in $\\Delta t$ if $\\nabla p \\neq 0$ and second-order if $\\nabla p = 0$.\n\nWe will now compute the necessary analytical terms for each case at $t^n = 0$.\n\n**Case A: Taylor-Green Vortex**\n- Parameters: $U_0=1$, $\\nu=0.1$.\n- Velocity at $t=0$: $\\mathbf{u}(0) = \\begin{bmatrix} -\\cos(x)\\sin(y) \\\\ \\sin(x)\\cos(y) \\end{bmatrix}$.\n- Exact velocity at $t=\\Delta t$: $\\mathbf{u}(\\Delta t) = \\mathbf{u}(0) e^{-2\\nu\\Delta t}$.\n- To find $\\mathbf{u}^\\star$, we need $\\partial_t \\mathbf{u}|_{t=0}$ and $\\nabla p|_{t=0}$.\n  - $\\partial_t \\mathbf{u} = -2\\nu \\mathbf{u}$, so $\\partial_t \\mathbf{u}|_{t=0} = -2\\nu \\mathbf{u}(0)$.\n  - $p(t=0) = \\frac{1}{4}(\\cos(2x) + \\cos(2y))$.\n  - $\\nabla p|_{t=0} = \\begin{bmatrix} -\\frac{1}{2}\\sin(2x) \\\\ -\\frac{1}{2}\\sin(2y) \\end{bmatrix}$.\n- Substituting into the simplified expression for $\\mathbf{u}^\\star$:\n  $$ \\mathbf{u}^\\star = \\mathbf{u}(0) + \\Delta t \\left( -2\\nu \\mathbf{u}(0) + \\nabla p|_{t=0} \\right) = (1-2\\nu\\Delta t)\\mathbf{u}(0) + \\Delta t \\nabla p|_{t=0} $$\n- The error vector is:\n  $$ \\mathbf{e}_A(\\Delta t) = \\mathbf{u}^\\star - \\mathbf{u}(\\Delta t) = \\left( (1-2\\nu\\Delta t)\\mathbf{u}(0) + \\Delta t \\nabla p|_{t=0} \\right) - \\left( \\mathbf{u}(0) e^{-2\\nu\\Delta t} \\right) $$\n  $$ \\mathbf{e}_A(\\Delta t) = (1-2\\nu\\Delta t - e^{-2\\nu\\Delta t})\\mathbf{u}(0) + \\Delta t \\nabla p|_{t=0} $$\n  The term multiplying $\\mathbf{u}(0)$ is $\\mathcal{O}((\\Delta t)^2)$, while the term involving $\\nabla p$ is $\\mathcal{O}(\\Delta t)$. The error is dominated by the pressure gradient term, as expected.\n\n**Case B: Diffusing Shear**\n- Parameters: $\\nu=0.1$.\n- Velocity at $t=0$: $\\mathbf{u}(0) = \\begin{bmatrix} \\sin(y) \\\\ 0 \\end{bmatrix}$.\n- Exact velocity at $t=\\Delta t$: $\\mathbf{u}(\\Delta t) = \\mathbf{u}(0) e^{-\\nu\\Delta t}$.\n- To find $\\mathbf{u}^\\star$, we need $\\partial_t \\mathbf{u}|_{t=0}$ and $\\nabla p|_{t=0}$.\n  - $\\partial_t \\mathbf{u} = -\\nu \\mathbf{u}$, so $\\partial_t \\mathbf{u}|_{t=0} = -\\nu \\mathbf{u}(0)$.\n  - $p = \\text{constant}$, so $\\nabla p = \\mathbf{0}$.\n- Substituting into the simplified expression for $\\mathbf{u}^\\star$:\n  $$ \\mathbf{u}^\\star = \\mathbf{u}(0) + \\Delta t ( -\\nu \\mathbf{u}(0) + \\mathbf{0} ) = (1-\\nu\\Delta t)\\mathbf{u}(0) $$\n- The error vector is:\n  $$ \\mathbf{e}_B(\\Delta t) = \\mathbf{u}^\\star - \\mathbf{u}(\\Delta t) = (1-\\nu\\Delta t)\\mathbf{u}(0) - \\mathbf{u}(0) e^{-\\nu\\Delta t} $$\n  $$ \\mathbf{e}_B(\\Delta t) = (1-\\nu\\Delta t - e^{-\\nu\\Delta t})\\mathbf{u}(0) $$\n  The term multiplying $\\mathbf{u}(0)$ is $\\mathcal{O}((\\Delta t)^2)$. The error is second-order, as expected.\n\n**Numerical Integration and Order Estimation**\nThe $L^2$ norm, $\\|f\\|_{L^2(\\Omega)} = \\left(\\int_\\Omega |f(x,y)|^2 \\,dx\\,dy\\right)^{1/2}$, is computed numerically. We discretize the domain $\\Omega=[0,2\\pi]\\times[0,2\\pi]$ into an $N \\times N$ grid with grid spacing $h = 2\\pi/N$. The integral is approximated by a sum over grid points $(x_i, y_j)$:\n$$ E^2(\\Delta t) = \\|\\mathbf{e}\\|^2_{L^2} \\approx \\sum_{i=0}^{N-1} \\sum_{j=0}^{N-1} \\|\\mathbf{e}(x_i, y_j, \\Delta t)\\|^2 h^2 $$\n$$ E(\\Delta t) \\approx h \\sqrt{\\sum_{i=0}^{N-1} \\sum_{j=0}^{N-1} (e_x^2 + e_y^2)\\big|_{(x_i,y_j)}} $$\nA sufficiently large $N$ (e.g., $N=256$) ensures accuracy.\n\nThe order of convergence, $q$, is estimated by fitting the model $E(\\Delta t) = C (\\Delta t)^q$. Taking the logarithm, we get a linear relationship: $\\log(E) = q \\log(\\Delta t) + \\log(C)$. The slope $q$ is found via a linear least-squares regression of $\\log(E)$ on $\\log(\\Delta t)$ over the given set of time steps. This will be accomplished using `scipy.stats.linregress`.",
            "answer": "```python\nimport numpy as np\nfrom scipy.stats import linregress\n\ndef solve():\n    \"\"\"\n    Computes the splitting error for Chorin's projection method for two\n    manufactured solutions and estimates the order of convergence.\n    \"\"\"\n    # Define problem parameters\n    nu = 0.1\n    U0 = 1.0\n    dts = np.array([0.2, 0.1, 0.05, 0.025, 0.0125])\n    \n    # Numerical quadrature parameters\n    N = 256\n    h = 2 * np.pi / N\n    x = np.linspace(0, 2 * np.pi, N, endpoint=False)\n    y = np.linspace(0, 2 * np.pi, N, endpoint=False)\n    X, Y = np.meshgrid(x, y)\n\n    # --- Case A: Taylor-Green Vortex ---\n    errors_A = []\n    \n    # Pre-compute spatial fields at t=0\n    u0_x_A = -U0 * np.cos(X) * np.sin(Y)\n    u0_y_A =  U0 * np.sin(X) * np.cos(Y)\n    grad_p_x_A = - (U0**2 / 2.0) * np.sin(2 * X)\n    grad_p_y_A = - (U0**2 / 2.0) * np.sin(2 * Y)\n\n    for dt in dts:\n        # Calculate terms for the error vector e = u* - u(dt)\n        # The equation for the error vector is:\n        # e = (1 - 2*nu*dt - exp(-2*nu*dt)) * u(0) + dt * grad_p(0)\n        \n        # Coefficient for the u(0) term\n        C1 = 1.0 - 2.0 * nu * dt - np.exp(-2.0 * nu * dt)\n        \n        # Components of the error vector field\n        e_x = C1 * u0_x_A + dt * grad_p_x_A\n        e_y = C1 * u0_y_A + dt * grad_p_y_A\n\n        # Compute L2 norm via numerical quadrature\n        sum_sq_error = np.sum(e_x**2 + e_y**2)\n        l2_error = h * np.sqrt(sum_sq_error)\n        errors_A.append(l2_error)\n        \n    # Estimate order of convergence q_A\n    log_dts = np.log(dts)\n    log_errors_A = np.log(np.array(errors_A))\n    # linregress returns a tuple, the slope is the first element\n    q_A = linregress(log_dts, log_errors_A).slope\n\n    # --- Case B: Diffusing Shear ---\n    errors_B = []\n\n    # Pre-compute spatial fields at t=0\n    u0_x_B = np.sin(Y)\n    # u0_y_B is zero everywhere\n\n    for dt in dts:\n        # Calculate terms for the error vector e = u* - u(dt)\n        # The equation for the error vector is:\n        # e = (1 - nu*dt - exp(-nu*dt)) * u(0)\n        # Note: grad_p(0) is zero for this case.\n\n        # Coefficient for the u(0) term\n        C2 = 1.0 - nu * dt - np.exp(-nu * dt)\n        \n        # Components of the error vector field\n        e_x = C2 * u0_x_B\n        # e_y is zero\n\n        # Compute L2 norm via numerical quadrature\n        sum_sq_error = np.sum(e_x**2) # e_y is zero\n        l2_error = h * np.sqrt(sum_sq_error)\n        errors_B.append(l2_error)\n\n    # Estimate order of convergence q_B\n    log_errors_B = np.log(np.array(errors_B))\n    q_B = linregress(log_dts, log_errors_B).slope\n    \n    # Combine all results into a single list\n    final_results = errors_A + [q_A] + errors_B + [q_B]\n\n    # Format and print the final output\n    print(f\"[{','.join(f'{val:.8f}' for val in final_results)}]\")\n\nsolve()\n\n```"
        }
    ]
}