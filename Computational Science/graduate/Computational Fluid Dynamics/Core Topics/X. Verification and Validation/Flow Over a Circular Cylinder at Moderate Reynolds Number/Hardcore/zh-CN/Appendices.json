{
    "hands_on_practices": [
        {
            "introduction": "在进行任何计算流体动力学（CFD）模拟之前，首要任务是创建一个能够准确捕捉流场关键物理特征的计算网格。对于绕圆柱流动这类壁面束缚流动，最重要的特征是边界层，即壁面附近速度梯度极大的薄层区域。本练习将引导你运用量纲分析和边界层理论中的基本标度律，来估算解析中等雷诺数下圆柱边界层所需的近壁网格尺寸。掌握这项技能对于设计可靠且经济高效的数值模拟至关重要，它将物理洞察力直接转化为CFD实践中的具体参数设置。",
            "id": "3319585",
            "problem": "考虑速度为 $U_{\\infty}$ 的均匀来流流经直径为 $D$ 的圆柱体，流动为不可压缩牛顿流，雷诺数 $Re=100$ 为中等水平。雷诺数的定义为 $Re = \\dfrac{U_{\\infty} D}{\\nu}$，其中 $\\nu$ 是运动粘度。您的任务是在计算流体力学 (CFD) 的更广阔背景下，为直接数值模拟 (DNS) 设计一个近壁法向网格间距。使用基于近壁区域对流与扩散平衡的第一性原理标度分析，定义一个粘性长度尺度 $\\,\\ell_{\\nu} = \\dfrac{\\nu}{U_{\\infty}}\\,$。从不可压缩的Navier–Stokes方程和圆柱表面附近的适当边界层标度出发，推导预期的层流边界层厚度 $\\delta$ 如何沿着圆柱上一个 $O(D)$ 的流向弧长随 $Re$ 变化。然后，使用粘性长度尺度作为近壁法向网格间距的要求（即，取近壁间距 $\\Delta n_w$ 为 $\\Delta n_w \\sim \\ell_{\\nu}$），在 $Re=100$ 时估算 $\\dfrac{\\Delta n_w}{D}$ 的值，并通过比率 $\\dfrac{\\delta}{\\ell_{\\nu}}$ 将此选择与穿越边界层厚度的预期网格点数联系起来。将您的最终答案表示为单一的无量纲量 $\\dfrac{\\Delta n_w}{D}$，不带单位。无需四舍五入。",
            "solution": "控制方程为不可压缩的Navier–Stokes方程，\n$$\n\\frac{\\partial \\boldsymbol{u}}{\\partial t} + \\boldsymbol{u}\\cdot\\nabla \\boldsymbol{u} = -\\frac{1}{\\rho}\\nabla p + \\nu \\nabla^{2}\\boldsymbol{u}, \\qquad \\nabla \\cdot \\boldsymbol{u} = 0,\n$$\n其中 $\\boldsymbol{u}$ 是速度场，$p$ 是压力，$\\rho$ 是密度，$\\nu$ 是运动粘度。在固体边界附近，壁面法向的梯度很大，层流边界层的标准标度分析平衡了流向对流与壁面法向的粘性扩散。用 $s$ 表示沿圆柱表面的特征流向弧长，用 $y$ 表示壁面法向坐标。对于流经特征流向距离为 $s = O(D)$ 的物体的层流，切向动量方程中的主导平衡项是\n$$\nU_{\\infty} \\frac{\\partial u}{\\partial s} \\sim \\nu \\frac{\\partial^{2} u}{\\partial y^{2}}.\n$$\n用特征尺度表示导数，其中 $\\partial/\\partial s \\sim 1/s$ 且 $\\partial/\\partial y \\sim 1/\\delta$（$\\delta$ 是边界层厚度），我们得到\n$$\nU_{\\infty} \\frac{U_{\\infty}}{s} \\sim \\nu \\frac{U_{\\infty}}{\\delta^{2}} \\quad \\Longrightarrow \\quad \\frac{U_{\\infty}^{2}}{s} \\sim \\nu \\frac{U_{\\infty}}{\\delta^{2}}.\n$$\n消去公因子 $U_{\\infty}$ 得到\n$$\n\\frac{U_{\\infty}}{s} \\sim \\frac{\\nu}{\\delta^{2}} \\quad \\Longrightarrow \\quad \\delta \\sim \\sqrt{\\frac{\\nu s}{U_{\\infty}}}.\n$$\n对于绕圆柱的流动，形成边界层的代表性流向距离为 $s = O(D)$，因此\n$$\n\\delta \\sim \\sqrt{\\frac{\\nu D}{U_{\\infty}}} = \\frac{D}{\\sqrt{Re}},\n$$\n因为 $Re = \\dfrac{U_{\\infty} D}{\\nu}$。\n\n为设定近壁法向网格间距，通过令对流时间尺度 $t_{c} \\sim \\dfrac{\\ell}{U_{\\infty}}$ 与扩散时间尺度 $t_{d} \\sim \\dfrac{\\ell^{2}}{\\nu}$ 相等来定义粘性长度尺度。令 $t_{c} \\sim t_{d}$ 得到 $\\ell \\sim \\dfrac{\\nu}{U_{\\infty}}$，我们将其记为\n$$\n\\ell_{\\nu} = \\frac{\\nu}{U_{\\infty}}.\n$$\n用圆柱直径 $D$ 对 $\\ell_{\\nu}$ 进行归一化，并使用雷诺数的定义，\n$$\n\\frac{\\ell_{\\nu}}{D} = \\frac{\\nu/U_{\\infty}}{D} = \\frac{1}{Re}.\n$$\n因此，在 $Re=100$ 时，\n$$\n\\frac{\\Delta n_{w}}{D} \\sim \\frac{\\ell_{\\nu}}{D} = \\frac{1}{100}.\n$$\n\n将此间距与预期的边界层厚度联系起来是很有用的。使用前面的标度分析，边界层厚度与粘性长度尺度的比值为\n$$\n\\frac{\\delta}{\\ell_{\\nu}} \\sim \\frac{D/\\sqrt{Re}}{D/Re} = \\sqrt{Re}.\n$$\n因此，选择 $\\Delta n_{w} \\sim \\ell_{\\nu}$ 会在边界层厚度上产生大约 $\\sqrt{Re}$ 个点。在 $Re=100$ 时，这得到\n$$\n\\frac{\\delta}{\\ell_{\\nu}} \\sim \\sqrt{100} = 10,\n$$\n这表明量级为 $\\ell_{\\nu}$ 的间距在边界层上产生大约10个点，这对于在此雷诺数下层流DNS中解析近壁梯度是一个合理的基准。因此，所要求的无量纲近壁间距是\n$$\n\\frac{\\Delta n_{w}}{D} = \\frac{1}{100}.\n$$",
            "answer": "$$\\boxed{\\frac{1}{100}}$$"
        },
        {
            "introduction": "在确定了空间离散化的网格后，接下来的核心挑战是为时间推进选择一个合适的时间步长 $\\Delta t$。对于显式时间积分格式，时间步长受到数值稳定性的严格限制，其本质要求是在单个时间步内，信息传播的距离（无论是通过对流还是扩散）不能超过一个网格单元。本练习将指导你推导并比较两种基本的时间步长限制：源于对流的Courant-Friedrichs-Lewy (CFL) 条件和源于黏性扩散的稳定性条件。通过这个实践，你将学会如何判断是哪个物理过程（对流或黏性）成为模拟效率的瓶颈，这是优化非定常CFD计算性能的关键一步。",
            "id": "3319645",
            "problem": "考虑一个中等雷诺数 $Re = 100$ 下，直径为 $D$ 的圆柱绕流问题，流体为非定常、二维、不可压缩流。其中雷诺数定义为 $Re \\equiv \\dfrac{\\rho U_{\\infty} D}{\\mu} = \\dfrac{U_{\\infty} D}{\\nu}$，$\\rho$ 为密度，$\\mu$ 为动力粘度，$\\nu$ 为运动粘度，$U_{\\infty}$ 为自由来流速度。控制方程为不可压缩 Navier–Stokes 方程。假设流动采用显式强稳定三阶 Runge–Kutta (SSP-RK3) 方法进行时间推进，其中粘性项使用二阶中心差分离散，对流项使用高分辨率迎风离散（例如，加权基本无振荡 (WENO) 格式）。环绕圆柱的近体计算网格为笛卡尔网格，且是均匀的，网格间距为 $\\Delta x = \\Delta y = D/100$。取 $D = 0.02$ 米 和 $U_{\\infty} = 0.5$ 米/秒。\n\n从第一性原理出发：\n- 利用 Courant–Friedrichs–Lewy (CFL) 准则推导对流时间步长限制。该准则指出，在显式格式中，对流携带的信息在一个时间步内不应穿过超过网格单元的一小部分 $c$。对于此求解器和离散格式，取保守的 Courant–Friedrichs–Lewy (CFL) 数 $c = 0.5$。\n- 独立地，对通过分离粘性项得到的半离散热传导方程进行 von Neumann 稳定性分析，以获得在二维网格上关于 $\\nu$、$\\Delta x$ 和 $\\Delta y$ 的粘性时间步长限制。该方程在均匀网格上使用二阶中心差分离散，并（作为 SSP-RK3 的内嵌部分）通过显式前向欧拉子步进行时间推进。\n\n对于给定的 $Re = 100$，首先根据其定义计算 $\\nu$。然后，利用所给数据数值计算对流和粘性时间步长限制，并确定哪个约束更严格。将最终的稳定时间步长 $\\Delta t_{\\text{stable}}$ 报告为两个限制中的最小值。答案以秒为单位表示，并四舍五入到四位有效数字。",
            "solution": "物理出发点是不可压缩 Navier–Stokes 方程，\n$$\n\\frac{\\partial \\boldsymbol{u}}{\\partial t} + \\boldsymbol{u}\\cdot\\nabla \\boldsymbol{u} = -\\frac{1}{\\rho}\\nabla p + \\nu \\nabla^{2}\\boldsymbol{u}, \\qquad \\nabla\\cdot\\boldsymbol{u} = 0,\n$$\n其中自由来流速度 $U_{\\infty}$ 和圆柱直径 $D$ 定义了雷诺数 $Re = \\dfrac{U_{\\infty} D}{\\nu}$。我们需要确定一个同时考虑对流和扩散的稳定显式时间步长。\n\n步骤 1：根据雷诺数的定义计算运动粘度。从 $Re = \\dfrac{U_{\\infty} D}{\\nu}$ 中求解 $\\nu$ 可得\n$$\n\\nu = \\frac{U_{\\infty} D}{Re}.\n$$\n当 $U_{\\infty} = 0.5$ 米/秒，$D = 0.02$ 米，以及 $Re = 100$ 时，我们得到\n$$\n\\nu = \\frac{0.5 \\times 0.02}{100} = 0.0001 \\text{ m}^{2}\\!/\\text{s} = 1.0\\times 10^{-4} \\text{ m}^{2}\\!/\\text{s}.\n$$\n\n步骤 2：根据 Courant–Friedrichs–Lewy (CFL) 准则推导对流时间步长限制。CFL 原理要求，在一个时间步内，平流输运不应穿过超过网格单元的一小部分 $c$：\n$$\n\\frac{U_{\\infty}\\,\\Delta t}{\\Delta x} \\le c \\quad \\Longrightarrow \\quad \\Delta t_{\\text{conv}} \\le \\frac{c\\,\\Delta x}{U_{\\infty}}.\n$$\n这里，$\\Delta x = \\Delta y = D/100$，所以\n$$\n\\Delta x = \\frac{D}{100} = \\frac{0.02}{100} = 2.0\\times 10^{-4} \\text{ m}.\n$$\n当 $c = 0.5$ 且 $U_{\\infty} = 0.5$ 米/秒时，对流限制的计算结果为\n$$\n\\Delta t_{\\text{conv}} \\le \\frac{0.5 \\times 2.0\\times 10^{-4}}{0.5} = 2.0\\times 10^{-4} \\text{ s}.\n$$\n\n步骤 3：通过对离散热传导方程进行 von Neumann 分析来推导粘性时间步长限制。考虑标量热传导方程 $u_{t} = \\nu\\left(u_{xx} + u_{yy}\\right)$，该方程在间距为 $\\Delta x$ 和 $\\Delta y$ 的均匀二维网格上使用二阶中心差分离散。半离散空间算子的傅里叶特征值为\n$$\n\\lambda(\\kappa_{x},\\kappa_{y}) = -\\nu\\left[\\frac{4}{\\Delta x^{2}}\\sin^{2}\\!\\left(\\frac{\\kappa_{x}\\Delta x}{2}\\right) + \\frac{4}{\\Delta y^{2}}\\sin^{2}\\!\\left(\\frac{\\kappa_{y}\\Delta y}{2}\\right)\\right].\n$$\n最严格（最负）的特征值幅度出现在最高可分辨波数处，即 $\\kappa_{x}\\Delta x = \\pi$ 和 $\\kappa_{y}\\Delta y = \\pi$，得到\n$$\n\\lambda_{\\min} = -\\nu\\left(\\frac{4}{\\Delta x^{2}} + \\frac{4}{\\Delta y^{2}}\\right).\n$$\n对于应用于 $y^{\\prime} = \\lambda y$（其中实数 $\\lambda \\le 0$）的显式前向欧拉步，稳定性要求 $|1 + \\lambda \\Delta t| \\le 1$，这可以化简为 $-2 \\le \\lambda \\Delta t \\le 0$，因此 $\\Delta t \\le \\dfrac{2}{|\\lambda_{\\min}|}$。将此应用于离散热算子，得到\n$$\n\\Delta t_{\\nu} \\le \\frac{2}{\\nu\\left(\\frac{4}{\\Delta x^{2}} + \\frac{4}{\\Delta y^{2}}\\right)} \\;=\\; \\frac{1}{2\\nu\\left(\\frac{1}{\\Delta x^{2}} + \\frac{1}{\\Delta y^{2}}\\right)}.\n$$\n强稳定三阶 Runge–Kutta (SSP-RK3) 方法对于单调空间离散格式能保持前向欧拉的稳定性限制，因此这个粘性约束对于 SSP-RK3 中内嵌的显式粘性更新来说，仍然是一个稳定性的保守充分条件。\n\n对于给定的网格，其中 $\\Delta x = \\Delta y$，该式简化为\n$$\n\\Delta t_{\\nu} \\le \\frac{\\Delta x^{2}}{4\\nu}.\n$$\n代入 $\\Delta x = 2.0\\times 10^{-4}$ 米 和 $\\nu = 1.0\\times 10^{-4}$ 米$^{2}$/秒，\n$$\n\\Delta t_{\\nu} \\le \\frac{(2.0\\times 10^{-4})^{2}}{4 \\times 1.0\\times 10^{-4}} = \\frac{4.0\\times 10^{-8}}{4.0\\times 10^{-4}} = 1.0\\times 10^{-4} \\text{ s}.\n$$\n\n步骤 4：选择更严格的限制作为稳定时间步长。我们有\n$$\n\\Delta t_{\\text{conv}} = 2.0\\times 10^{-4} \\text{ s}, \\qquad \\Delta t_{\\nu} = 1.0\\times 10^{-4} \\text{ s}.\n$$\n因此，\n$$\n\\Delta t_{\\text{stable}} = \\min\\left(\\Delta t_{\\text{conv}}, \\Delta t_{\\nu}\\right) = 1.0\\times 10^{-4} \\text{ s}.\n$$\n\n对 $Re = 100$ 时粘性约束的解释与补充讨论：在此中等雷诺数下，圆柱周围的边界层厚度尺度约为 $\\delta \\sim D/\\sqrt{Re} \\approx D/10$。要精确解析近壁梯度，通常要求垂直于壁面的网格间距 $\\Delta n \\ll \\delta$，这个间距可能远小于切向间距。由于粘性稳定性条件通过 $\\left(1/\\Delta x^{2} + 1/\\Delta y^{2}\\right)$ 项依赖于 $\\Delta n$，最小的局部间距（通常是法向壁面间距）通过 $\\Delta t_{\\nu} \\propto \\Delta_{\\min}^{2}/\\nu$ 控制全局显式时间步长。因此，即使对流 CFL 条件允许更大的步长，在 $Re = 100$ 且近壁网格精细加密的情况下，粘性约束也可能占主导地位。在本例中，由于 $\\Delta x = \\Delta y = D/100$，粘性约束确实更严格，并决定了稳定时间步长。\n\n数值与四舍五入：最终的稳定时间步长为 $\\Delta t_{\\text{stable}} = 1.0\\times 10^{-4}$ 秒。四舍五入到四位有效数字，即为 $1.000\\times 10^{-4}$ 秒。",
            "answer": "$$\\boxed{1.000 \\times 10^{-4}}$$"
        },
        {
            "introduction": "掌握了空间和时间离散化的基本原则后，我们现在可以应用这些概念来研究更复杂的物理现象，其中一个经典例子便是运动物体与流体之间的相互作用。当圆柱体在来流中被迫进行横向振荡时，其自身的涡脱落频率可能会与振荡频率同步，这种现象被称为“锁定”或频率同步。本高级练习将引导你使用一个降阶模型——范德波尔（van der Pol）振子——来模拟这一复杂的流固耦合问题。通过构建并求解这个能够捕捉尾流非定常特性的替身模型，你将亲手绘制出锁定发生的参数区域，从而深入理解非线性动力学在流体力学中的应用，这代表了现代CFD中一个重要的前沿方向。",
            "id": "3319624",
            "problem": "您的任务是为一个二维不可压缩流绕圆柱体流动的任意拉格朗日-欧拉（ALE）移动网格模拟构建一个有理论依据且计算高效的代理模型。该圆柱体正在进行指定的横向谐波振荡。目标是在中等雷诺数下，通过算法在振幅比和频率比构成的平面上绘制出锁定区域。\n\n物理背景如下。考虑一个直径为 $D$ 的圆柱体，置于速度为 $U_{\\infty}$ 的均匀自由来流中，雷诺数 $Re=200$，其中 $Re=\\rho U_{\\infty} D/\\mu$，$\\rho$ 为流体密度，$\\mu$ 为动力粘度。圆柱体被强制进行横向振荡，其运动规律为 $y(t)=A\\sin(2\\pi f t)$，其中 $A$ 是峰-峰振幅除以 2，$f$ 是强迫频率。对于固定圆柱体，其自然涡脱落频率为 $f_s = St \\, U_{\\infty}/D$，其中雷诺数 $Re=200$ 对应的斯特劳哈尔数 $St$ 取为 $St = 0.2$。您需要使用基于 $D$ 和 $U_{\\infty}$ 的无量纲对流单位进行计算，即无量纲时间为 $t^{*} = t\\,U_{\\infty}/D$，无量纲横向位移为 $y^{*} = y/D$，所有以每个无量纲时间单位（即每个 $t^{*}$）的周期数表示的频率为 $f^{*} = f \\, D/U_{\\infty}$。在这些单位下，自然脱落频率为 $f_s^{*}=St$，相应的角频率为 $\\omega_s = 2\\pi St$。\n\n在此问题中，直接在任意拉格朗日-欧拉框架下求解完整的纳维-斯托克斯方程计算成本很高。因此，我们假设主要的非定常升力动力学可以由一个范德波尔型的单自由度非线性全局模态振子表示，这是一种广泛用于尾流不稳定性的代理模型。具体来说，我们使用以下微分方程来模拟脉动升力系数 $C_L(t^{*})$：\n$$\n\\frac{d^2 C_L}{dt^{*2}} + \\varepsilon\\left(C_L^2-1\\right)\\frac{d C_L}{dt^{*}} + \\omega_s^2 C_L = K \\, \\frac{d^2 y^{*}}{dt^{*2}},\n$$\n其中 $\\varepsilon0$ 是非线性参数，控制无强迫时自激极限环的特性；$K0$ 是一个耦合系数，表示物体加速度对尾流动力学的影响；$\\omega_s=2\\pi St$ 是全局模态的自然角频率。指定的横向振荡为 $y^{*}(t^{*}) = (A/D)\\,\\sin(2\\pi f^{*} t^{*})$，其中 $A/D$ 是无量纲振幅，$f^{*}=(f/f_s)\\,St$ 是无量纲强迫频率。因此，横向加速度强迫项为：\n$$\n\\frac{d^2 y^{*}}{dt^{*2}} = -\\left(\\frac{A}{D}\\right) \\left(2\\pi f^{*}\\right)^2 \\sin\\left(2\\pi f^{*} t^{*}\\right).\n$$\n\n您的程序必须从第一性原理出发，实现以下步骤：\n\n1.  从质量和动量的基本守恒定律出发，论证在 $Re=200$ 时，固定圆柱体后方存在导致周期性涡脱落的全局不稳定性模态。使用斯特劳哈尔关系 $f_s = St \\, U_{\\infty}/D$（其中 $St=0.2$）来定义对流单位下的自然脱落频率。\n\n2.  论证并采用降阶的范德波尔振子代理模型来表示由施加的物体横向加速度驱动的脉动升力系数 $C_L(t^{*})$。该振子必须在无量纲时间 $t^{*}$ 内进行积分，并选择参数 $\\varepsilon$ 和 $K$ 以表示 $Re=200$ 时中等超临界状态的尾流。\n\n3.  对于下面的每个测试用例，将受迫振子从 $t^{*}=0$ 积分到 $t^{*}=T_{\\mathrm{end}}$，舍去初始的瞬态区间，并确定是否发生频率锁定。频率锁定的定义如下：计算分析窗口内 $C_L(t^{*})$ 的单边离散傅里叶变换，并用 $f_{\\max}$ 表示谱幅值达到最大的频率（单位为每个无量纲时间单位的周期数）。令 $f_f^{*}$ 为强迫频率，$f_s^{*}=St$ 为自然脱落频率。当且仅当以下两个条件同时满足时，宣告发生锁定：\n    - 主导频率满足 $\\left|f_{\\max} - f_f^{*}\\right|/f_f^{*} \\le 0.05$。\n    - 以 $f_f^{*}$ 为中心、宽度为 $\\Delta f$ 的窄带内的谱功率至少是以 $f_s^{*}$ 为中心、同等宽度频带内谱功率的 $1.5$ 倍。\n\n    为保证数值稳健性，在执行傅里叶变换前使用汉宁窗，移除 $C_L(t^{*})$ 的均值，采用恒定时间步长 $\\Delta t^{*}$进行均匀采样，并取 $\\Delta f$ 等于分析窗口的单点频率分辨率。使用 $T_{\\mathrm{end}}=400$，舍弃前半部分作为瞬态，分析后半部分。\n\n4.  除非另有说明，在对流单位中使用以下数值参数：$St=0.2$，$\\omega_s=2\\pi St$，$\\varepsilon=0.3$，$K=10$，$T_{\\mathrm{end}}=400$，以及均匀采样时间步长 $\\Delta t^{*}=0.02$。振子的初始条件为 $C_L(0)=10^{-2}$ 和 $d C_L/dt^{*}(0)=0$。\n\n您的程序必须对以下由振幅和频率比对指定的测试套件评估锁定准则，每个测试用例格式为 $\\left(A/D,\\; f/f_s\\right)$：\n\n- 案例 1：$\\left(0.05,\\; 0.70\\right)$\n- 案例 2：$\\left(0.20,\\; 0.95\\right)$\n- 案例 3：$\\left(0.10,\\; 1.15\\right)$\n- 案例 4：$\\left(0.02,\\; 0.95\\right)$\n- 案例 5：$\\left(0.30,\\; 0.85\\right)$\n- 案例 6：$\\left(0.15,\\; 0.50\\right)$\n\n此问题中的所有量均为无量纲。无需报告物理单位。对于每个用例，输出必须是一个布尔值，指示是否根据上述定义发生了锁定。\n\n最终输出规范：您的程序应生成单行输出，其中包含六个案例的布尔结果，按顺序排列，格式为逗号分隔的列表，并用方括号括起，例如 $[True,False,True,False,False,True]$。",
            "solution": "我们从不可压缩流的速度 $\\mathbf{u}(\\mathbf{x},t)$ 和压力 $p(\\mathbf{x},t)$ 的守恒形式纳维-斯托克斯方程开始：\n$$\n\\nabla\\cdot \\mathbf{u} = 0, \\qquad\n\\frac{\\partial \\mathbf{u}}{\\partial t} + (\\mathbf{u}\\cdot\\nabla)\\mathbf{u} = -\\frac{1}{\\rho}\\nabla p + \\nu \\nabla^2 \\mathbf{u},\n$$\n其中运动粘度 $\\nu=\\mu/\\rho$。对于雷诺数 $Re=\\rho U_{\\infty} D/\\mu = 200$ 时绕圆柱体的均匀来流，稳定的对称基流变得全局不稳定，产生一个反对称模态，从而导致周期性的涡脱落。大量的实验和模拟已经确定了一个近似线性的斯特劳哈尔关系 $St = f_s D/U_{\\infty}$，在 $Re=200$ 时 $St \\approx 0.2$，我们将其作为一个经过充分检验的事实来采用。在使用 $D$ 和 $U_{\\infty}$ 进行对流无量纲化后，自然脱落频率为 $f_s^{*}=St=0.2$，相应的角频率为 $\\omega_s = 2\\pi St$。\n\n当圆柱体进行指定的横向振荡 $y(t)=A\\sin(2\\pi f t)$ 时，瞬时物体加速度通过任意拉格朗日-欧拉（ALE）设置中的非定常边界条件来驱动近尾流。我们不移动计算网格，而是寻求一个能够捕捉全局尾流振荡核心物理及其被外部强迫捕获（entrainment）过程的降阶代理模型。一个广泛使用且有充分理论支持的方法是将脉动升力系数 $C_L(t^{*})$ 表示为一个自激非线性范德波尔型振子，其极限环对应于尾流的饱和全局模态。在我们的无量纲对流时间 $t^{*}$ 中，典型的受迫范德波尔方程为：\n$$\n\\frac{d^2 C_L}{dt^{*2}} + \\varepsilon\\left(C_L^2-1\\right)\\frac{d C_L}{dt^{*}} + \\omega_s^2 C_L = F(t^{*}),\n$$\n其中 $\\varepsilon0$ 控制非线性和极限环的饱和，而 $F(t^{*})$ 代表外部强迫。在指定的圆柱体横向运动 $y^{*}(t^{*}) = y(t)/D$ 的背景下，作用于尾流的主导惯性强迫与圆柱体的横向加速度成比例。因此，我们设置\n$$\nF(t^{*}) = K\\,\\frac{d^2 y^{*}}{dt^{*2}}, \\quad y^{*}(t^{*}) = \\left(\\frac{A}{D}\\right)\\sin\\left(2\\pi f^{*} t^{*}\\right),\n$$\n其中 $f^{*}=f D/U_{\\infty} = (f/f_s)\\,St$，$K0$ 是一个耦合系数。加速度为：\n$$\n\\frac{d^2 y^{*}}{dt^{*2}} = -\\left(\\frac{A}{D}\\right)\\left(2\\pi f^{*}\\right)^2 \\sin\\left(2\\pi f^{*} t^{*}\\right).\n$$\n\n算法流程如下。\n\n1.  参数选择：我们设置 $St=0.2$，因此 $\\omega_s=2\\pi St$。对于 $Re=200$ 时的中等超临界尾流，我们选择 $\\varepsilon=0.3$ 以获得一个温和的非线性极限环，选择 $K=10$ 以产生可观测但不过于强烈的横向加速度捕获效应。这些是无量纲的模型级参数，与先前关于中等雷诺数下尾流振子的研究一致。\n\n2.  时间积分：对于每个测试用例 $\\left(A/D, f/f_s\\right)$，计算 $f^{*} = (f/f_s)\\,St$，定义指定的 $y^{*}(t^{*})$ 及其二阶导数，并积分以下方程组：\n$$\n\\begin{cases}\n\\dot{C}_L = v,\\\\\n\\dot{v} = -\\varepsilon\\left(C_L^2 - 1\\right) v - \\omega_s^2 C_L + K \\,\\ddot{y}^{*}(t^{*}),\n\\end{cases}\n$$\n从 $t^{*}=0$ 到 $t^{*}=T_{\\mathrm{end}}$，其中 $T_{\\mathrm{end}}=400$，并使用步长 $\\Delta t^{*}=0.02$ 进行均匀采样。初始条件为 $C_L(0)=10^{-2}$ 和 $v(0)=0$。\n\n3.  用于锁定检测的频率分析：舍弃时间序列的前半部分以消除瞬态效应。对于剩余的窗口，从 $C_L$ 中减去样本均值以避免直流分量，应用汉宁窗以减少频谱泄漏，并执行单边离散傅里叶变换以获得谱幅值作为频率（单位为每个 $t^{*}$ 的周期数）的函数。令 $f_{\\max}$ 表示幅值达到最大的频率。\n\n4.  判定规则：令 $f_s^{*}=St$ 和 $f_f^{*}=(f/f_s)\\,St$。计算单点频率分辨率 $\\Delta f = 1/T_{\\mathrm{win}}$，其中 $T_{\\mathrm{win}}$ 是分析窗口的持续时间。令 $P(f_0)$ 表示频率位于 $[f_0-\\Delta f/2, f_0+\\Delta f/2]$ 区间内的频点上的谱功率之和。当且仅当以下条件成立时，宣告锁定：\n    - 主导频率接近性：$\\left|f_{\\max} - f_f^{*}\\right|/f_f^{*} \\le 0.05$。\n    - 强迫相对于自然模态的主导性：$P(f_f^{*}) \\ge 1.5 \\times P(f_s^{*})$。\n\n    这个由两部分组成的准则确保了响应既与强迫频率锁相，并且在分析带宽内，与强迫对齐的分量主导了自然脱落分量。\n\n5.  输出：对于每个测试用例，记录一个布尔值，指示是否发生锁定。\n\n测试套件详情：六个指定的用例如下：\n- 案例 1：$\\left(A/D, f/f_s\\right) = \\left(0.05, 0.70\\right)$，\n- 案例 2：$\\left(A/D, f/f_s\\right) = \\left(0.20, 0.95\\right)$，\n- 案例 3：$\\left(A/D, f/f_s\\right) = \\left(0.10, 1.15\\right)$，\n- 案例 4：$\\left(A/D, f/f_s\\right) = \\left(0.02, 0.95\\right)$，\n- 案例 5：$\\left(A/D, f/f_s\\right) = \\left(0.30, 0.85\\right)$，\n- 案例 6：$\\left(A/D, f/f_s\\right) = \\left(0.15, 0.50\\right)$。\n\n解释：当 $f/f_s \\approx 1$ 且 $A/D$ 较大时，由于与自然全局模态对齐的加速度强迫更强，预计会发生锁定；而远离单位频率比或 $A/D$ 非常小的用例预计不会锁定。然而，最终的判定由上述量化的频谱准则确定。\n\n最终的程序整合了这些步骤，使用指定的参数和数值设置求解振子，分析频谱，并打印一行包含对应上述案例的六个布尔值的列表。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\n# Surrogate model and analysis for lock-in mapping in forced transverse oscillation of a cylinder\n# using a forced van der Pol wake oscillator for fluctuating lift.\n\ndef simulate_wake_oscillator(a_over_d: float, r_freq: float,\n                             St: float = 0.2,\n                             epsilon: float = 0.3,\n                             K: float = 10.0,\n                             t_end: float = 400.0,\n                             dt: float = 0.02):\n    \"\"\"\n    Simulate the forced van der Pol oscillator for the fluctuating lift coefficient C_L\n    with prescribed transverse oscillation y* = (A/D) sin(2 pi f* t*).\n    Parameters:\n        a_over_d: non-dimensional amplitude A/D\n        r_freq: frequency ratio f/f_s\n        St: Strouhal number (f_s*), default 0.2 for Re=200\n        epsilon: van der Pol nonlinearity parameter\n        K: coupling coefficient for acceleration forcing\n        t_end: end time in convective units\n        dt: sampling time step for uniform output\n    Returns:\n        t: time samples (numpy array)\n        CL: fluctuating lift coefficient time series (numpy array)\n    \"\"\"\n    # Natural angular frequency in convective units\n    omega_s = 2.0 * np.pi * St\n    # Forcing frequency in convective units (cycles per t*) and angular frequency\n    f_forcing = r_freq * St\n    omega_f = 2.0 * np.pi * f_forcing\n\n    # Define prescribed motion and its second derivative\n    def y_ddot(t):\n        # y*(t) = a_over_d * sin(omega_f * t)\n        return -a_over_d * (omega_f ** 2) * np.sin(omega_f * t)\n\n    # ODE system: x = [C_L, v], where v = dC_L/dt\n    def rhs(t, x):\n        CL, v = x\n        dCLdt = v\n        dvdt = -epsilon * (CL**2 - 1.0) * v - (omega_s**2) * CL + K * y_ddot(t)\n        return [dCLdt, dvdt]\n\n    # Time grid for uniform sampling\n    t_eval = np.arange(0.0, t_end + 1e-12, dt)\n\n    # Initial conditions\n    x0 = [1e-2, 0.0]\n\n    sol = solve_ivp(rhs, (0.0, t_end), x0, method='RK45', t_eval=t_eval, rtol=1e-6, atol=1e-9)\n    if not sol.success:\n        # In the unlikely event of failure, fall back to zeros to avoid crashing\n        return t_eval, np.zeros_like(t_eval)\n\n    return sol.t, sol.y[0]\n\n\ndef hann_window(n: int):\n    \"\"\"Generate a Hann window of length n.\"\"\"\n    if n == 0:\n        return np.array([])\n    if n == 1:\n        return np.array([1.0])\n    return 0.5 - 0.5 * np.cos(2.0 * np.pi * np.arange(n) / (n - 1))\n\n\ndef spectral_lock_in(CL: np.ndarray, dt: float, St: float, r_freq: float,\n                     dominance_ratio: float = 1.5, freq_tol: float = 0.05):\n    \"\"\"\n    Decide lock-in based on spectral analysis of the lift coefficient signal.\n    Parameters:\n        CL: time series of fluctuating lift coefficient (numpy array)\n        dt: uniform sampling time step\n        St: Strouhal number (natural frequency in cycles per t*)\n        r_freq: forcing frequency ratio f/f_s\n        dominance_ratio: required ratio P(forcing)/P(natural) for lock-in\n        freq_tol: relative tolerance for dominant frequency proximity to forcing frequency\n    Returns:\n        lock_in: boolean\n    \"\"\"\n    n = CL.size\n    if n  8:\n        return False\n\n    # Remove mean to avoid DC component\n    x = CL - np.mean(CL)\n\n    # Apply Hann window\n    w = hann_window(n)\n    xw = x * w\n\n    # One-sided real FFT\n    X = np.fft.rfft(xw)\n    freqs = np.fft.rfftfreq(n, dt)\n    # Power spectral density (magnitude squared)\n    P = np.abs(X) ** 2\n\n    # Exclude zero frequency bin from consideration of dominant oscillatory component\n    if freqs.size > 1:\n        P[0] = 0.0\n\n    # Dominant frequency\n    idx_max = int(np.argmax(P))\n    f_max = freqs[idx_max]\n\n    # Define target frequencies\n    f_nat = St\n    f_forcing = r_freq * St\n\n    # Single-bin frequency resolution\n    if n * dt > 0:\n        df = 1.0 / (n * dt)\n    else:\n        df = 0.0\n\n    # Helper to compute band power in +/- half-bin around f0\n    def band_power(f0):\n        if df == 0:\n            return 0.0\n        # Indices whose frequencies are within half a bin width of f0\n        idxs = np.where(np.abs(freqs - f0) = (0.5 * df))[0]\n        if idxs.size == 0:\n            # fall back to nearest bin\n            idx = int(np.argmin(np.abs(freqs - f0)))\n            return float(P[idx])\n        return float(np.sum(P[idxs]))\n\n    P_forcing = band_power(f_forcing)\n    P_natural = band_power(f_nat)\n\n    # Conditions for lock-in\n    proximity = (abs(f_max - f_forcing) / f_forcing) = freq_tol if f_forcing > 0 else False\n    dominance = (P_forcing >= dominance_ratio * P_natural)\n\n    return bool(proximity and dominance)\n\n\ndef analyze_case(a_over_d: float, r_freq: float,\n                 St: float = 0.2, epsilon: float = 0.3, K: float = 10.0,\n                 t_end: float = 400.0, dt: float = 0.02) -> bool:\n    \"\"\"\n    Simulate and analyze a single test case for lock-in.\n    \"\"\"\n    t, CL = simulate_wake_oscillator(a_over_d, r_freq, St=St, epsilon=epsilon, K=K, t_end=t_end, dt=dt)\n    # Discard first half as transient\n    n = CL.size\n    start = n // 2\n    CL_win = CL[start:]\n    return spectral_lock_in(CL_win, dt, St, r_freq, dominance_ratio=1.5, freq_tol=0.05)\n\n\ndef solve():\n    # Define the test cases from the problem statement as (A/D, f/f_s).\n    test_cases = [\n        (0.05, 0.70),  # Case 1\n        (0.20, 0.95),  # Case 2\n        (0.10, 1.15),  # Case 3\n        (0.02, 0.95),  # Case 4\n        (0.30, 0.85),  # Case 5\n        (0.15, 0.50),  # Case 6\n    ]\n\n    # Fixed parameters for all cases\n    St = 0.2\n    epsilon = 0.3\n    K = 10.0\n    t_end = 400.0\n    dt = 0.02\n\n    results = []\n    for a_over_d, r_freq in test_cases:\n        lock_in = analyze_case(a_over_d, r_freq, St=St, epsilon=epsilon, K=K, t_end=t_end, dt=dt)\n        results.append(lock_in)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}