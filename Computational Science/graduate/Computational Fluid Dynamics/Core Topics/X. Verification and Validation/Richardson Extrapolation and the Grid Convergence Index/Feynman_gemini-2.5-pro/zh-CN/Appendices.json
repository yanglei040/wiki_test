{
    "hands_on_practices": [
        {
            "introduction": "掌握理查森外推法的关键在于理解其如何利用多组网格上的解来消除离散误差的主导项。本练习将引导你从最基本的情况入手：利用两个不同精度的网格解，并假设收敛阶数已知，推导并计算外推到无穷密网格的“真实”解。通过这个练习，你将掌握消除误差项、提高解的精度的核心思想。",
            "id": "3358975",
            "problem": "在一项稳态、层流的计算流体动力学（CFD）模拟中，您正在计算一个无量纲标量输出泛函（例如，由参考值缩放的阻力系数）。您使用几何相似的网格获得了两个网格解析估算值，其加密比为 $r = \\dfrac{h_{2}}{h_{1}} = 2$。离散格式在形式上为二阶，因此在渐近区域，可观测量 $u_{h}$ 满足标准的截断误差模型\n$$\nu_{h} \\;=\\; u_{\\infty} \\;+\\; C\\,h^{p} \\;+\\; \\mathcal{O}\\!\\left(h^{p+1}\\right),\n$$\n其中，$u_{\\infty}$ 是连续介质（网格无关）值，$C$ 是主误差系数，$h$ 是代表性网格间距，$p$ 是观测阶数（在渐近加密下等于形式阶数）。该渐近模型是 Richardson 外推法和网格收敛指数（GCI）的基础。\n\n使用两套最密的网格，您测得 $u_{h_{1}} = 0.9970$ 和 $u_{h_{2}} = 0.9920$，其中 $r = 2$ 且 $p = 2$。假设解处于渐近范围内，并且网格间距已通过细网格间距进行无量纲化，因此 $h_{1} = 1$。\n\n仅从上述渐近误差模型和加密比的定义出发，首先推导 $u_{\\infty}$ 和 $C$ 关于 $u_{h_{1}}$、$u_{h_{2}}$、$r$ 和 $p$ 的表达式。然后，用给定的数据对这些表达式求值。最后，根据网格解序列是从上方还是下方逼近 $u_{\\infty}$ 来解释 $C$ 的符号。\n\n报告两个数字：外推的连续介质值 $u_{\\infty}$ 和主误差系数 $C$。这两个量都是无量纲的。将您的数值结果四舍五入至六位有效数字。",
            "solution": "在进行求解之前，根据所需标准对问题陈述进行验证。\n\n### 步骤 1：提取已知条件\n从问题陈述中逐字提取的已知条件如下：\n-   一项稳态、层流的计算流体动力学（CFD）模拟，其对象是一个无量纲标量输出泛函。\n-   两个网格解析估算值，$u_{h_{1}}$ 和 $u_{h_{2}}$。\n-   网格是几何相似的。\n-   加密比：$r = \\dfrac{h_{2}}{h_{1}} = 2$。\n-   离散格式为形式上二阶。\n-   渐近截断误差模型为：$u_{h} = u_{\\infty} + C\\,h^{p} + \\mathcal{O}\\!\\left(h^{p+1}\\right)$。\n-   $u_{\\infty}$ 是连续介质（网格无关）值。\n-   $C$ 是主误差系数。\n-   $h$ 是代表性网格间距。\n-   $p$ 是观测阶数。\n-   假设：解处于渐近范围内，因此观测阶数 $p$ 等于形式阶数。\n-   数值数据：\n    -   $u_{h_{1}} = 0.9970$\n    -   $u_{h_{2}} = 0.9920$\n    -   $p = 2$\n    -   $r = 2$\n    -   $h_{1} = 1$（无量纲化）\n\n### 步骤 2：使用提取的已知条件进行验证\n对问题的有效性进行评估：\n-   **科学依据**：该问题基于数值方法中离散误差分析的标准理论，特别是 Richardson 外推法，这是 CFD 和其他计算科学中一种基本且被广泛接受的验证技术。所提供的渐近误差模型是该方法的理论基础。该问题在科学上是合理的。\n-   **适定性**：该问题提供了明确的目标：推导 $u_{\\infty}$ 和 $C$ 的表达式，用给定数据对其进行求值，并解释结果。所有必要的数据（$u_{h_{1}}$、$u_{h_{2}}$、$r$、$p$、$h_1$）均已提供，使得方程组对于两个未知数 $u_{\\infty}$ 和 $C$ 是可解的。该问题是适定的。\n-   **客观性**：该问题以精确、定量且无偏见的技术语言陈述。它不含主观或基于意见的内容。\n-   **完整性与一致性**：该问题是自洽的。所提供的数据是一致的，并且足以得到唯一解。明确说明了解处于渐近范围内的假设，这是该方法有效的必要条件。\n-   **其他缺陷**：该问题没有表现出任何其他无效性标志。它不是隐喻性的、琐碎的、结构不良的或基于事实不正确的假设。\n\n### 步骤 3：结论与行动\n该问题是**有效的**。将提供完整的解答。\n\n### $u_{\\infty}$ 和 $C$ 的推导\n我们从提供的渐近误差模型开始，忽略高阶项，因为问题假设我们处于渐近区域：\n$$u_{h} \\approx u_{\\infty} + C h^{p}$$\n我们可以为两个网格写出这个方程，其代表性网格间距分别为 $h_{1}$ 和 $h_{2}$：\n$$u_{h_{1}} = u_{\\infty} + C h_{1}^{p} \\quad (1)$$\n$$u_{h_{2}} = u_{\\infty} + C h_{2}^{p} \\quad (2)$$\n网格加密比给定为 $r = h_{2} / h_{1}$，这意味着 $h_{2} = r h_{1}$。将此代入方程（2）：\n$$u_{h_{2}} = u_{\\infty} + C (r h_{1})^{p} = u_{\\infty} + C r^{p} h_{1}^{p} \\quad (3)$$\n我们现在有一个关于两个未知数 $u_{\\infty}$ 和 $C$ 的由方程（1）和（3）组成的线性方程组。\n\n为了求 $u_{\\infty}$，我们消去 $C$。将方程（1）乘以 $r^{p}$：\n$$r^{p} u_{h_{1}} = r^{p} u_{\\infty} + r^{p} C h_{1}^{p}$$\n从这个结果中减去方程（3）得到：\n$$r^{p} u_{h_{1}} - u_{h_{2}} = (r^{p} u_{\\infty} - u_{\\infty}) + (r^{p} C h_{1}^{p} - r^{p} C h_{1}^{p})$$\n$$r^{p} u_{h_{1}} - u_{h_{2}} = u_{\\infty} (r^{p} - 1)$$\n求解 $u_{\\infty}$ 得到 Richardson 外推公式：\n$$u_{\\infty} = \\frac{r^{p} u_{h_{1}} - u_{h_{2}}}{r^{p} - 1}$$\n这也可以写成常见形式 $u_{\\infty} = u_{h_{1}} + \\frac{u_{h_{1}} - u_{h_{2}}}{r^{p} - 1}$。\n\n为了求 $C$，我们消去 $u_{\\infty}$。从方程（2）中减去方程（1）：\n$$u_{h_{2}} - u_{h_{1}} = (u_{\\infty} - u_{\\infty}) + (C h_{2}^{p} - C h_{1}^{p})$$\n使用 $h_{2} = r h_{1}$，我们得到：\n$$u_{h_{2}} - u_{h_{1}} = C ( (r h_{1})^{p} - h_{1}^{p} ) = C h_{1}^{p} (r^{p} - 1)$$\n求解 $C$：\n$$C = \\frac{u_{h_{2}} - u_{h_{1}}}{h_{1}^{p} (r^{p} - 1)}$$\n\n### 数值计算\n现在我们将给定的数值代入推导出的表达式中。已知条件为 $u_{h_{1}} = 0.9970$，$u_{h_{2}} = 0.9920$，$r = 2$，$p = 2$，$h_{1} = 1$。\n\n$u_{\\infty}$ 的计算：\n$$u_{\\infty} = \\frac{r^{p} u_{h_{1}} - u_{h_{2}}}{r^{p} - 1} = \\frac{2^{2} \\times 0.9970 - 0.9920}{2^{2} - 1}$$\n$$u_{\\infty} = \\frac{4 \\times 0.9970 - 0.9920}{4 - 1} = \\frac{3.9880 - 0.9920}{3}$$\n$$u_{\\infty} = \\frac{2.9960}{3} = 0.998666...$$\n四舍五入到六位有效数字，我们得到 $u_{\\infty} = 0.998667$。\n\n$C$ 的计算：\n$$C = \\frac{u_{h_{2}} - u_{h_{1}}}{h_{1}^{p} (r^{p} - 1)} = \\frac{0.9920 - 0.9970}{1^{2} (2^{2} - 1)}$$\n$$C = \\frac{-0.0050}{1 \\times (4 - 1)} = \\frac{-0.0050}{3}$$\n$$C = -0.001666...$$\n四舍五入到六位有效数字，我们得到 $C = -0.00166667$。\n\n### $C$ 符号的解释\n数值解 $u_{h}$ 的离散误差定义为 $E_{h} = u_{h} - u_{\\infty}$。根据渐近模型，该误差可由主项近似：\n$$E_{h} = u_{h} - u_{\\infty} \\approx C h^{p}$$\n由于网格间距 $h$ 是一个正数，对于任何阶数 $p$，$h^{p}$ 也为正。因此，误差 $E_{h}$ 的符号由主误差系数 $C$ 的符号决定。\n\n在本问题中，我们计算出 $C \\approx -0.00166667$，这是一个负值。负的 $C$ 意味着误差 $E_{h} = u_{h} - u_{\\infty}$ 是负的。\n$$u_{h} - u_{\\infty}  0 \\implies u_{h}  u_{\\infty}$$\n这意味着通过加密网格获得的数值解序列 $u_{h}$ 将从下方逼近精确的连续介质值 $u_{\\infty}$。这被称为从下方单调收敛。这个结论与给定的数据是一致的：粗网格上的解 $u_{h_{2}} = 0.9920$ 小于细网格上的解 $u_{h_{1}} = 0.9970$，并且两者都小于外推的连续介质值 $u_{\\infty} \\approx 0.998667$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.998667  -0.00166667\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在实际的数值模拟中，我们通常无法预先确定模拟是否已达到理论收敛阶。因此，仅依赖理论阶数进行外推可能并不可靠。本练习引入了一种更为稳健和通用的方法：三网格研究，它允许我们直接从数值结果中计算出“观测收敛阶”$p$。这一步骤不仅是进行可靠外推的前提，更是评估收敛行为质量的关键诊断工具。",
            "id": "3359001",
            "problem": "使用有限体积法模拟一个二维通道中的稳态、层流、不可压缩流动。从三个连续的、均匀加密比 $r=1.5$ 的系统性加密网格中，得到一个无量纲积分量，记为 $u_h$。在粗、中、细网格上的离散解分别为 $u_{h_1}=2.0015$、$u_{h_2}=1.9990$ 和 $u_{h_3}=1.9982$，其中 $h_1h_2h_3$ 且 $h_1/h_2=h_2/h_3=r$。假设数值解处于网格收敛的渐近区内，在这些网格上的主导离散误差由单一阶数 $p$ 主导，并且舍入误差污染可以忽略不计。\n\n从计算流体动力学中离散误差的基本原理出发，使用三网格方法推导观测到的精度阶 $p$，然后进行 Richardson 外推以估计渐近（网格无关）值 $u_{\\infty}$。简要评论该外推估计值的可靠性，需结合各网格间连续差值的大小及其与均匀加密的一致性进行讨论，并阐明其与网格收敛指数（GCI）概念的联系。将最终外推值 $u_{\\infty}$ 表示为一个无量纲数，并将您的答案四舍五入至六位有效数字。",
            "solution": "该问题要求从三个在系统性加密网格上获得的数值解中，确定观测到的精度阶 $p$ 和网格无关解 $u_{\\infty}$ 的 Richardson 外推估计值。\n\nRichardson 外推和网格收敛性研究的基本前提是，离散误差可以表示为网格间距 $h$ 的幂级数。假设解处于渐近区内，误差由主导项决定，我们可以将尺寸为 $h$ 的网格上的数值解 $u_h$ 与精确解（或网格无关解）$u_{\\infty}$ 之间的关系写为：\n$$u_h - u_{\\infty} \\approx C h^p$$\n其中 $C$ 是一个依赖于解的高阶导数但与 $h$ 无关的常数，而 $p$ 是数值方法的形式精度阶。\n\n我们已知在特征尺寸为 $h_1$、$h_2$ 和 $h_3$ 的网格上的三个解。这些网格是均匀加密的，因此网格间距通过一个恒定的加密比 $r$ 相关联。我们有 $h_1  h_2  h_3$，且 $h_1 = r h_2$ 和 $h_2 = r h_3$。给定的加密比为 $r=1.5$。对应的解为 $u_{h_1}=2.0015$、$u_{h_2}=1.9990$ 和 $u_{h_3}=1.9982$。\n\n我们可以为这三个网格分别写出误差方程：\n$$u_{h_1} - u_{\\infty} \\approx C h_1^p \\quad (1)$$\n$$u_{h_2} - u_{\\infty} \\approx C h_2^p \\quad (2)$$\n$$u_{h_3} - u_{\\infty} \\approx C h_3^p \\quad (3)$$\n\n为了确定观测到的精度阶 $p$，我们可以消去未知常数 $C$ 和 $u_{\\infty}$。我们首先将方程两两相减以消去 $u_{\\infty}$：\n$$u_{h_1} - u_{h_2} = (u_{h_1} - u_{\\infty}) - (u_{h_2} - u_{\\infty}) \\approx C(h_1^p - h_2^p)$$\n$$u_{h_2} - u_{h_3} = (u_{h_2} - u_{\\infty}) - (u_{h_3} - u_{\\infty}) \\approx C(h_2^p - h_3^p)$$\n\n利用网格间距之间的关系 $h_1 = r h_2$ 和 $h_2 = r h_3$，我们可以重写这些差值：\n$$u_{h_1} - u_{h_2} \\approx C((rh_2)^p - h_2^p) = C h_2^p (r^p - 1)$$\n$$u_{h_2} - u_{h_3} \\approx C((rh_3)^p - h_3^p) = C h_3^p (r^p - 1)$$\n\n现在，我们将这两个差值相除，以消去 $C$ 和项 $(r^p - 1)$：\n$$\\frac{u_{h_1} - u_{h_2}}{u_{h_2} - u_{h_3}} \\approx \\frac{C h_2^p (r^p - 1)}{C h_3^p (r^p - 1)} = \\left(\\frac{h_2}{h_3}\\right)^p = r^p$$\n\n这为我们提供了一个基于这三个解直接计算观测到的精度阶 $p$ 的公式：\n$$p = \\frac{\\ln\\left(\\frac{u_{h_1} - u_{h_2}}{u_{h_2} - u_{h_3}}\\right)}{\\ln(r)}$$\n\n代入给定的数值：\n$$u_{h_1} - u_{h_2} = 2.0015 - 1.9990 = 0.0025$$\n$$u_{h_2} - u_{h_3} = 1.9990 - 1.9982 = 0.0008$$\n$$r = 1.5$$\n\n差值之比为 $\\frac{0.0025}{0.0008} = 3.125$。\n因此，观测到的精度阶为：\n$$p = \\frac{\\ln(3.125)}{\\ln(1.5)} \\approx \\frac{1.139434}{0.405465} \\approx 2.80999$$\n\n接下来，我们进行 Richardson 外推来估计网格无关值 $u_{\\infty}$。外推通常基于两个最细的网格（在本例中为 $h_2$ 和 $h_3$），因为预期它们更深入渐近区。我们从方程（2）和（3）开始：\n$$u_{h_2} - u_{\\infty} \\approx C h_2^p$$\n$$u_{h_3} - u_{\\infty} \\approx C h_3^p = C \\left(\\frac{h_2}{r}\\right)^p = \\frac{1}{r^p} (C h_2^p)$$\n将第一个表达式代入第二个，得到：\n$$u_{h_3} - u_{\\infty} \\approx \\frac{1}{r^p} (u_{h_2} - u_{\\infty})$$\n$$r^p(u_{h_3} - u_{\\infty}) \\approx u_{h_2} - u_{\\infty}$$\n$$r^p u_{h_3} - r^p u_{\\infty} \\approx u_{h_2} - u_{\\infty}$$\n$$(r^p - 1) u_{\\infty} \\approx r^p u_{h_3} - u_{h_2}$$\n$$u_{\\infty} \\approx \\frac{r^p u_{h_3} - u_{h_2}}{r^p - 1}$$\n为了方便实际计算，该公式可以重新整理为：\n$$u_{\\infty} \\approx u_{h_3} + \\frac{u_{h_3} - u_{h_2}}{r^p - 1}$$\n我们已经计算了所有必需的项。$r^p$ 的值正是我们之前求得的差值之比：\n$$r^p = \\frac{u_{h_1} - u_{h_2}}{u_{h_2} - u_{h_3}} = 3.125$$\n细网格和中等网格解之间的差值为 $u_{h_3} - u_{h_2} = 1.9982 - 1.9990 = -0.0008$。\n现在，我们可以计算外推值 $u_{\\infty}$：\n$$u_{\\infty} \\approx 1.9982 + \\frac{-0.0008}{3.125 - 1} = 1.9982 - \\frac{0.0008}{2.125}$$\n$$u_{\\infty} \\approx 1.9982 - 0.000376470588...$$\n$$u_{\\infty} \\approx 1.997823529...$$\n按照要求四舍五入到六位有效数字，我们得到：\n$$u_{\\infty} \\approx 1.99782$$\n\n关于此估计值的可靠性，网格收敛指数（GCI）方法论为评估不确定性提供了一个框架。一个关键步骤是确定解是否处于渐近区内。收敛的先决条件是解随着网格加密单调变化，这一点在此处得到了验证，因为 $|u_{h_1}-u_{h_2}| = 0.0025  |u_{h_2}-u_{h_3}| = 0.0008$。分析的核心是基于单一误差项 $Ch^p$ 占主导地位的假设。通过将观测到的精度阶 $p$ 与格式的理论阶进行比较，可以检验该假设的一致性。对于典型的有限体积法，人们可能期望一个整数阶，如 $p=2$。我们计算出的观测阶为 $p \\approx 2.81$。这个值并不接近整数，这可能意味着网格尚未足够细以进入渐近区，且高阶误差项仍然显著。GCI 方法论使用观测到的 $p$ 来估计一个误差带，但当 $p$ 显著偏离预期的理论阶时，这个误差带的置信度会减弱。因此，虽然计算在形式上是正确的，并且与所提供的数据一致，但观测阶与预期整数值的偏差使人们对外推值的可靠性产生一些怀疑。应谨慎对待该估计值，因为渐近收敛的基本假设可能未被完全满足。",
            "answer": "$$\\boxed{1.99782}$$"
        },
        {
            "introduction": "获得一个更精确的外推解固然重要，但网格收敛性研究的最终目标是量化我们数值解中的离散不确定度。网格收敛指数（GCI）为此提供了一个标准化的框架。本练习将指导你应用GCI公式，结合安全系数，为精细网格解估算一个保守的误差范围。这是从定性评估收敛性迈向定量声明数值精度的关键一步。",
            "id": "3358960",
            "problem": "一项稳态计算流体动力学模拟研究粘性流动，产生了一个工程中关心的标量，记为 $u$。该标量在两个系统加密的网格上计算，其特征间距分别为 $h_1$（细网格）和 $h_2$（较粗的网格），加密比为 $r=h_2/h_11$。观测到的网格解为 $u_{h_1}=0.845$ 和 $u_{h_2}=0.832$，网格加密比为 $r=1.4$。对相同离散化方法进行的另一项独立的三套网格研究表明，观测到的精度阶为 $p=1.9$。假设模拟处于网格收敛的渐近区，离散误差随 $h$ 呈主阶幂律行为，且满足单调收敛。\n\n使用渐近误差模型和网格收敛指数 (GCI) 的定义，计算从细-粗网格对得到的网格收敛指数值 $GCI_{12}$，安全因子取 $F_s=1.25$。该指数被解释为细网格解 $u_{h_1}$ 的相对离散不确定度的一个界限。请将最终的 $GCI_{12}$ 表示为相对于 $u_{h_1}$ 的无量纲小数值，并将您的答案四舍五入到四位有效数字。此外，请用文字简要解释这个小数值作为相对于 $u_{h_1}$ 的不确定度的含义。",
            "solution": "其基本依据是，对于在间距为 $h$ 的网格上计算的某一关心的量 $u$，其渐近离散误差模型为：\n$$\nu_h \\;=\\; u \\;+\\; C h^{p} \\;+\\; \\mathcal{O}\\!\\left(h^{p+1}\\right),\n$$\n其中 $C$ 是一个与网格无关的误差系数，$p$ 是离散化的观测精度阶。当两套网格通过加密比 $r=h_2/h_11$ 相关联，并且解表现出单调、渐近收敛时，两套网格解之间的差异在主阶上近似为：\n$$\nu_{h_2} - u_{h_1} \\;\\approx\\; C\\left(h_2^{p} - h_1^{p}\\right) \\;=\\; C h_1^{p}\\left(r^{p} - 1\\right).\n$$\n细网格的离散误差大小为 $|u_{h_1}-u|\\approx |C| h_1^{p}$，因此，相对细网格误差可以近似为：\n$$\n\\frac{|u_{h_1}-u|}{|u_{h_1}|} \\;\\approx\\; \\frac{|C| h_1^{p}}{|u_{h_1}|} \\;\\approx\\; \\frac{|u_{h_2} - u_{h_1}|}{|u_{h_1}| \\left(r^{p} - 1\\right)}.\n$$\n网格收敛指数 (GCI) 引入了一个安全因子 $F_s$，以得出一个关于相对离散不确定度的保守界限。对于细-粗网格对 $(h_1,h_2)$，其定义为：\n$$\nGCI_{12} \\;=\\; F_s \\;\\frac{|u_{h_1} - u_{h_2}|}{|u_{h_1}| \\left(r^{p} - 1\\right)}.\n$$\n\n我们现在使用给定数据计算所需的量：\n- 细网格解 $u_{h_1}=0.845$，\n- 粗网格解 $u_{h_2}=0.832$，\n- 加密比 $r=1.4$，\n- 观测精度阶 $p=1.9$，\n- 安全因子 $F_s=1.25$。\n\n首先，计算解的差值的绝对值：\n$$\n|u_{h_1} - u_{h_2}| \\;=\\; |0.845 - 0.832| \\;=\\; 0.013.\n$$\n接下来，为保证精度，使用自然对数计算 $r^{p}$：\n$$\nr^{p} \\;=\\; 1.4^{1.9} \\;=\\; \\exp\\!\\left(1.9 \\,\\ln(1.4)\\right).\n$$\n使用 $\\ln(1.4)\\approx 0.3364722366$，我们有\n$$\n1.9\\,\\ln(1.4)\\;\\approx\\; 0.6392972496,\\quad \\exp(0.6392972496)\\;\\approx\\; 1.895148645,\n$$\n所以\n$$\nr^{p} - 1 \\;\\approx\\; 1.895148645 - 1 \\;=\\; 0.895148645.\n$$\n计算相对于细网格解的归一化差异：\n$$\n\\frac{|u_{h_1} - u_{h_2}|}{|u_{h_1}|} \\;=\\; \\frac{0.013}{0.845} \\;\\approx\\; 0.015384615.\n$$\n除以 $\\left(r^{p} - 1\\right)$：\n$$\n\\frac{|u_{h_1} - u_{h_2}|}{|u_{h_1}| \\left(r^{p} - 1\\right)} \\;\\approx\\; \\frac{0.015384615}{0.895148645} \\;\\approx\\; 0.0171867.\n$$\n应用安全因子 $F_s=1.25$：\n$$\nGCI_{12} \\;=\\; 1.25 \\times 0.0171867 \\;\\approx\\; 0.0214834.\n$$\n四舍五入到四位有效数字，从细-粗网格对计算出的网格收敛指数为：\n$$\nGCI_{12} \\;\\approx\\; 0.02148.\n$$\n\n解释：数值 $GCI_{12}\\approx 0.02148$ 是一个相对于 $u_{h_1}$ 的无量纲小数值，表明细网格解的离散不确定度的一个保守界限约为 $u_{h_1}$ 的 $0.02148$ 倍。换句话说，在渐近收敛的假设和选定的安全因子下，由离散化引起的围绕 $u_{h_1}$ 的估计不确定度区间在 $0.02148\\,u_{h_1}$ 的量级。",
            "answer": "$$\\boxed{0.02148}$$"
        }
    ]
}