{
    "hands_on_practices": [
        {
            "introduction": "为了掌握双时间步法，我们首先从一个基础问题开始。这个练习将探讨应用于线性平流方程的显式伪时间步法，这是双时间步法最简单的形式之一。通过推导其稳定性条件，你将亲手揭示伪时间步长与经典的Courant-Friedrichs-Lewy (CFL)条件之间的深刻联系，为理解更复杂的加速收敛技术奠定坚实的理论基础 。",
            "id": "3313256",
            "problem": "考虑一个长度为 $L$ 的周期性区域上的一维无粘标量守恒律，其具有恒定的正平流速度 $a0$，由 $\\frac{\\partial u}{\\partial t} + \\frac{\\partial f(u)}{\\partial x} = 0$（其中 $f(u) = a u$）描述。将该区域离散为 $N$ 个宽度为 $\\Delta x = \\frac{L}{N}$ 的均匀有限体积，并令 $u_i$ 表示单元 $i$ 中的单元平均状态。对 $a0$ 使用一阶迎风数值通量，并将每个单元 $i$ 中的有限体积半离散残差定义为 $R_i(U) = F_{i+\\frac{1}{2}} - F_{i-\\frac{1}{2}}$，其中 $U = (u_1,\\dots,u_N)^{\\top}$，且周期性边界条件将单元 $N$ 连接回单元 $1$。令质量矩阵 $M$ 为单元体积的对角矩阵，因此 $M_{ii} = \\Delta x$。\n\n为了加速收敛到稳态 $R(U) = 0$，引入一个伪时间 $\\tau$，并考虑对半离散常微分方程 $M \\frac{dU}{d\\tau} = - R(U)$ 在伪时间上进行显式前向欧拉积分。从基本的有限体积定义和 $a0$ 的一阶迎风通量出发，推导在第 $k$ 次迭代时，显式分量形式的伪时间更新 $u_i^{k+1}$ 作为 $u_i^k$ 及其相邻单元的函数。\n\n将第 $k$ 次迭代时的离散残差 $\\ell_1$ 范数定义为 $\\|R(U^k)\\|_1 = \\sum_{i=1}^{N} |R_i(U^k)|$。仅使用第一性原理和单调迎风离散化方案的经过充分检验的性质，找出一个关于伪时间步长 $\\Delta \\tau$ 的条件，该条件足以保证序列 $\\|R(U^k)\\|_1$ 关于 $k$ 是单調不增的。最后，根据此条件，确定能保证伪时间上残差范数单调不增的最大允许伪时间步长 $\\Delta \\tau_{\\max}$。请将 $\\Delta \\tau_{\\max}$ 的最终答案以封闭形式的解析表达式（无不等式）给出，单位为秒。",
            "solution": "首先根据指定标准验证问题。\n\n### 步骤 1：提取已知条件\n- **控制方程**：一维无粘标量守恒律，$\\frac{\\partial u}{\\partial t} + \\frac{\\partial f(u)}{\\partial x} = 0$。\n- **通量函数**：$f(u) = a u$，其中 $a  0$ 为恒定平流速度。\n- **区域**：长度为 $L$ 的周期性区域。\n- **离散化**：有限体积法，包含 $N$ 个宽度为 $\\Delta x = \\frac{L}{N}$ 的均匀单元。\n- **状态变量**：$u_i$ 是单元 $i$ 中的单元平均状态。$U = (u_1, \\dots, u_N)^{\\top}$。\n- **数值通量**：针对 $a0$ 的一阶迎风数值通量。\n- **半离散残差**：$R_i(U) = F_{i+\\frac{1}{2}} - F_{i-\\frac{1}{2}}$，其中 $F$ 是数值通量。\n- **边界条件**：周期性，将单元 $N$ 连接到单元 $1$。\n- **质量矩阵**：对角矩阵 $M$，其中 $M_{ii} = \\Delta x$。\n- **伪时间积分**：对常微分方程 $M \\frac{dU}{d\\tau} = -R(U)$ 的显式前向欧拉法，其中 $\\tau$ 是伪时间。\n- **残差范数**：第 $k$ 次迭代时的离散 $\\ell_1$ 范数为 $\\|R(U^k)\\|_1 = \\sum_{i=1}^{N} |R_i(U^k)|$。\n- **目标 1**：推导显式分量形式的伪时间更新 $u_i^{k+1}$。\n- **目标 2**：找到一个关于伪时间步长 $\\Delta \\tau$ 的条件，该条件足以保证 $\\|R(U^{k+1})\\|_1 \\leq \\|R(U^k)\\|_1$。\n- **目标 3**：根据此条件确定最大允许伪时间步长 $\\Delta \\tau_{\\max}$。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学性**：该问题描述了一种求解离散化偏微分方程（一维线性平流方程）稳态解的标准技术（使用显式欧拉法的双时间步法）。这是计算流体动力学（CFD）和数值分析中的一个经典课题。\n- **适定性**：该问题是适定的。它要求推导一个更新规则和一个稳定性条件，在所提供的框架下，这些都有唯一且有意义的解。\n- **客观性**：语言精确、数学化，没有任何主观或基于观点的陈述。\n- **完备性与一致性**：推导所需的所有要素都已提供：控制方程、通量、离散格式、时间步进方法和目标准则。整个设置是内部一致的。\n\n### 步骤 3：结论与行动\n问题有效。将提供详细解答。\n\n用于加速收敛至稳态的控制方程的半离散形式，通过引入伪时间变量 $\\tau$ 给出：\n$$\nM \\frac{dU}{d\\tau} = -R(U)\n$$\n在这里，$M$ 是对角质量矩阵，其元素为 $M_{ii} = \\Delta x$，$U$ 是单元平均状态的向量，$R(U)$ 是残差向量。将此方程写成单个单元 $i$ 的形式：\n$$\n\\Delta x \\frac{du_i}{d\\tau} = -R_i(U)\n$$\n使用显式前向欧拉法，以时间步长 $\\Delta \\tau$ 对此常微分方程在伪时间上进行离散化，得到：\n$$\n\\Delta x \\frac{u_i^{k+1} - u_i^k}{\\Delta \\tau} = -R_i(U^k)\n$$\n其中 $k$ 是伪时间迭代指数。求解更新后的状态 $u_i^{k+1}$，我们得到：\n$$\nu_i^{k+1} = u_i^k - \\frac{\\Delta \\tau}{\\Delta x} R_i(U^k)\n$$\n这是伪时间更新的一般形式。为了使其显式化，我们必须计算残差项 $R_i(U^k)$。单元 $i$ 的残差定义为其边界上的净通量：\n$$\nR_i(U) = F_{i+\\frac{1}{2}} - F_{i-\\frac{1}{2}}\n$$\n其中 $F_{i+\\frac{1}{2}}$ 是单元 $i$ 和单元 $i+1$ 之间界面上的数值通量。问题指定了一阶迎风格式。对于恒定的正平流速度 $a0$，“迎风”方向来自索引较小的单元。因此，用于计算界面 $i+\\frac{1}{2}$ 处通量的状态是单元 $i$ 中的状态，即 $u_i$。\n$$\nF_{i+\\frac{1}{2}} = f(u_i) = a u_i\n$$\n类似地，界面 $i-\\frac{1}{2}$（单元 $i-1$ 和单元 $i$ 之间）处的数值通量取决于单元 $i-1$ 中的状态：\n$$\nF_{i-\\frac{1}{2}} = f(u_{i-1}) = a u_{i-1}\n$$\n将这些通量表达式代入残差定义中，得到：\n$$\nR_i(U^k) = a u_i^k - a u_{i-1}^k = a(u_i^k - u_{i-1}^k)\n$$\n（由于周期性，$u_0$ 被理解为 $u_N$。）\n现在，我们将这个显式形式的残差代入伪时间更新方程，以获得第一个要求的结果：\n$$\nu_i^{k+1} = u_i^k - \\frac{\\Delta \\tau}{\\Delta x} a(u_i^k - u_{i-1}^k)\n$$\n\n接下来，我们寻求一个关于 $\\Delta \\tau$ 的条件，以保证离散残差 $\\ell_1$ 范数的单调不增，即 $\\|R(U^{k+1})\\|_1 \\le \\|R(U^k)\\|_1$。我们首先找到残差本身的演化方程。伪时间步 $k+1$ 时的残差是：\n$$\nR_i(U^{k+1}) = a(u_i^{k+1} - u_{i-1}^{k+1})\n$$\n我们代入 $u_i^{k+1}$ 和 $u_{i-1}^{k+1}$ 的更新表达式：\n$$\nu_i^{k+1} = u_i^k - \\frac{a \\Delta \\tau}{\\Delta x} (u_i^k - u_{i-1}^k) = u_i^k - \\frac{\\Delta \\tau}{\\Delta x} R_i(U^k)\n$$\n$$\nu_{i-1}^{k+1} = u_{i-1}^k - \\frac{a \\Delta \\tau}{\\Delta x} (u_{i-1}^k - u_{i-2}^k) = u_{i-1}^k - \\frac{\\Delta \\tau}{\\Delta x} R_{i-1}(U^k)\n$$\n将这些代入 $R_i(U^{k+1})$ 的表达式中：\n$$\nR_i(U^{k+1}) = a \\left[ \\left(u_i^k - \\frac{\\Delta \\tau}{\\Delta x} R_i(U^k)\\right) - \\left(u_{i-1}^k - \\frac{\\Delta \\tau}{\\Delta x} R_{i-1}(U^k)\\right) \\right]\n$$\n$$\nR_i(U^{k+1}) = a(u_i^k - u_{i-1}^k) - \\frac{a \\Delta \\tau}{\\Delta x} \\left( R_i(U^k) - R_{i-1}(U^k) \\right)\n$$\n注意到 $a(u_i^k - u_{i-1}^k) = R_i(U^k)$，我们有：\n$$\nR_i^{k+1} = R_i^k - \\frac{a \\Delta \\tau}{\\Delta x} (R_i^k - R_{i-1}^k)\n$$\n让我们定义无量纲参数 $C = \\frac{a \\Delta \\tau}{\\Delta x}$。重新整理 $R_i^{k+1}$ 的方程：\n$$\nR_i^{k+1} = (1 - C) R_i^k + C R_{i-1}^k\n$$\n这是一个用于残差自身平流的迎风格式。我们现在分析 $R^{k+1}$ 的 $\\ell_1$ 范数：\n$$\n\\|R^{k+1}\\|_1 = \\sum_{i=1}^{N} |R_i^{k+1}| = \\sum_{i=1}^{N} |(1 - C) R_i^k + C R_{i-1}^k|\n$$\n使用三角不等式 $|x+y| \\le |x|+|y|$：\n$$\n\\|R^{k+1}\\|_1 \\le \\sum_{i=1}^{N} \\left( |1 - C| |R_i^k| + |C| |R_{i-1}^k| \\right)\n$$\n分离求和项：\n$$\n\\|R^{k+1}\\|_1 \\le |1 - C| \\sum_{i=1}^{N} |R_i^k| + |C| \\sum_{i=1}^{N} |R_{i-1}^k|\n$$\n由于周期性边界条件，对平移索引 $i-1$ 的求和等于对索引 $i$ 的求和：$\\sum_{i=1}^{N} |R_{i-1}^k| = \\sum_{j=0}^{N-1} |R_j^k| = \\sum_{j=1}^{N} |R_j^k| = \\|R^k\\|_1$。\n因此，不等式变为：\n$$\n\\|R^{k+1}\\|_1 \\le (|1 - C| + |C|) \\|R^k\\|_1\n$$\n为了使残差范数单调不增（$\\|R^{k+1}\\|_1 \\le \\|R^k\\|_1$），一个充分条件是：\n$$\n|1 - C| + |C| \\le 1\n$$\n因为 $a  0$，$\\Delta \\tau  0$（对于前向步长），以及 $\\Delta x  0$，参数 $C = \\frac{a \\Delta \\tau}{\\Delta x}$ 严格为正。所以 $|C| = C$。条件变为：\n$$\n|1 - C| + C \\le 1\n$$\n我们对 $C  0$ 的情况分析此条件。\n- 如果 $0  C \\le 1$，那么 $1 - C \\ge 0$，所以 $|1 - C| = 1 - C$。条件是 $(1 - C) + C \\le 1$，简化为 $1 \\le 1$。这总是成立的。\n- 如果 $C  1$，那么 $1 - C  0$，所以 $|1 - C| = -(1 - C) = C - 1$。条件是 $(C - 1) + C \\le 1$，简化为 $2C - 1 \\le 1$，或 $2C \\le 2$，或 $C \\le 1$。这与 $C  1$ 的假设相矛盾。\n因此，残差范数单调不增的充分条件是 $0  C \\le 1$。用物理参数表示，即为：\n$$\n0  \\frac{a \\Delta \\tau}{\\Delta x} \\le 1\n$$\n最后，我们必须确定保证此条件的最大允许伪时间步长 $\\Delta \\tau_{\\max}$。该最大值在不等式的上边界处取得：\n$$\n\\frac{a \\Delta \\tau_{\\max}}{\\Delta x} = 1\n$$\n求解 $\\Delta \\tau_{\\max}$ 得到最终答案：\n$$\n\\Delta \\tau_{\\max} = \\frac{\\Delta x}{a}\n$$\n单位是 $[\\text{长度}] / ([\\text{长度}]/[\\text{时间}]) = [\\text{时间}]$，在国际单位制中是秒，符合要求。",
            "answer": "$$\\boxed{\\frac{\\Delta x}{a}}$$"
        },
        {
            "introduction": "在理解了稳定性的基本限制之后，我们自然会问：如何让收敛过程尽可能快？这个练习将你的技能从确保稳定性提升到追求最优效率。你将为一个由对流-扩散问题离散化得到的一般线性系统，推导出一个能使收敛速度达到最快的“最优”伪时间步长。通过这个练习，你将学会如何将迭代过程的收敛率与离散算子的谱特性（如条件数）联系起来，这是设计高效数值算法的核心技能 。",
            "id": "3313273",
            "problem": "考虑一个在有界域上离散化的稳态线性对流扩散边值问题，其带有狄利克雷边界条件，产生的代数残差形式为 $R(U)=A\\,U-b$，其中 $A \\in \\mathbb{R}^{n \\times n}$ 是一个由相容的二阶空间离散化产生的矩阵。假设 $A$ 可对角化，其所有特征值 $\\lambda$ 构成的谱为实的、正的，且其界限为 $0  \\lambda_{\\min}\\leq \\lambda \\leq \\lambda_{\\max}$。这是能产生 $M$-矩阵的对流扩散问题稳定离散化方法的一个典型性质。为了加速向稳态 $R(U)=0$ 的收敛，引入伪时间 $\\tau$，并考虑双时间步演化方程 $\\,\\frac{dU}{d\\tau}=-R(U)\\,$。使用伪时间步长为 $\\Delta \\tau0$ 的前向欧拉伪时间积分器，构建关于 $U(\\tau)$ 的线性定点迭代，并推导出以 $A$ 和 $\\Delta \\tau$ 表示的相应迭代矩阵。将伪时间 Courant–Friedrichs–Lewy (CFL) 数定义为 $\\,CFL_{\\tau}=\\Delta \\tau\\,\\rho(A)\\,$，其中 $\\rho(A)$ 是 $A$ 的谱半径。将迭代矩阵的谱半径表示为 $CFL_{\\tau}$ 和谱条件数 $\\kappa=\\frac{\\lambda_{\\max}}{\\lambda_{\\min}}$ 的函数。然后，假设 $\\lambda_{\\min}$ 和 $\\lambda_{\\max}$ 固定，确定在所有正的 $\\Delta \\tau$ 上使迭代矩阵谱半径最小化的 $CFL_{\\tau}$ 值。请以单一的、用 $\\kappa$ 表示的最优 $CFL_{\\tau}$ 的闭式表达式给出最终答案。答案是无量纲的。无需进行数值舍入；请以精确的解析形式表示最终答案。",
            "solution": "所述问题在科学上是合理的、自洽的且适定的。它描述了数值分析中用于加速线性系统迭代求解器收敛的一种标准方法，并置于计算流体动力学的背景下。所有术语都经过了形式化定义，且前提与既定的数学原理一致。因此，可以推导出解答。\n\n该问题旨在通过将线性方程组 $A\\,U - b = 0$ 重构为一个含时问题来求解其稳态解。状态向量 $U$ 的伪时间演化控制方程如下：\n$$\n\\frac{dU}{d\\tau} = -R(U)\n$$\n其中 $\\tau$ 是伪时间，$R(U) = A\\,U - b$ 是残差。代入残差的表达式，我们得到一个线性常微分方程：\n$$\n\\frac{dU}{d\\tau} = -(A\\,U - b) = b - A\\,U\n$$\n为了对该方程进行数值求解，我们应用伪时间步长为 $\\Delta \\tau  0$ 的前向欧拉法。设 $U^k$表示在伪时间 $\\tau_k = k\\,\\Delta \\tau$ 时 $U$ 的近似值。前向欧拉离散化为：\n$$\n\\frac{U^{k+1} - U^k}{\\Delta \\tau} = b - A\\,U^k\n$$\n整理该方程可得线性定点迭代：\n$$\nU^{k+1} = U^k + \\Delta \\tau (b - A\\,U^k) = (I - \\Delta \\tau A)U^k + \\Delta \\tau b\n$$\n这是一个形如 $U^{k+1} = G U^k + c$ 的迭代格式，其中迭代矩阵为 $G = I - \\Delta \\tau A$，且 $c = \\Delta \\tau b$。\n\n此迭代的收敛速度由迭代矩阵 $G$ 的谱半径（记为 $\\rho(G)$）决定。迭代收敛的充要条件是 $\\rho(G)  1$。为了达到最快的收敛速度，我们必须找到使 $\\rho(G)$ 最小化的 $\\Delta \\tau$ 值。\n\n已知矩阵 $A$ 可对角化，其特征值 $\\lambda$ 构成的谱为实的、正的，且满足 $0  \\lambda_{\\min} \\leq \\lambda \\leq \\lambda_{\\max}$。令 $\\sigma(A)$ 为 $A$ 的特征值集合。若 $\\lambda \\in \\sigma(A)$，则迭代矩阵 $G = I - \\Delta \\tau A$ 的相应特征值 $\\mu$ 由下式给出：\n$$\n\\mu = 1 - \\Delta \\tau \\lambda\n$$\n$G$ 的谱半径是其特征值的最大绝对值：\n$$\n\\rho(G) = \\max_{\\mu \\in \\sigma(G)} |\\mu| = \\max_{\\lambda \\in \\sigma(A)} |1 - \\Delta \\tau \\lambda|\n$$\n由于函数 $f(\\lambda) = 1 - \\Delta \\tau \\lambda$ 是关于 $\\lambda$ 的线性和单调函数，因此 $f(\\lambda)$ 在区间 $[\\lambda_{\\min}, \\lambda_{\\max}]$ 上的极值将出现在端点 $\\lambda_{\\min}$ 和 $\\lambda_{\\max}$ 处。因此，谱半径是这两个端点处函数值的绝对值的最大值：\n$$\n\\rho(G) = \\max \\left( |1 - \\Delta \\tau \\lambda_{\\min}|, |1 - \\Delta \\tau \\lambda_{\\max}| \\right)\n$$\n接下来，我们用伪时间 CFL 数 $CFL_{\\tau} = \\Delta \\tau\\,\\rho(A)$ 和谱条件数 $\\kappa = \\frac{\\lambda_{\\max}}{\\lambda_{\\min}}$ 来表示它。对于一个具有实正谱的矩阵 $A$，其谱半径为 $\\rho(A) = \\lambda_{\\max}$。因此，我们可以写出 $\\Delta \\tau = \\frac{CFL_{\\tau}}{\\lambda_{\\max}}$。我们还有 $\\lambda_{\\min} = \\frac{\\lambda_{\\max}}{\\kappa}$。\n\n将这些表达式代入 $\\rho(G)$ 的各项中：\n$$\n1 - \\Delta \\tau \\lambda_{\\min} = 1 - \\left(\\frac{CFL_{\\tau}}{\\lambda_{\\max}}\\right) \\left(\\frac{\\lambda_{\\max}}{\\kappa}\\right) = 1 - \\frac{CFL_{\\tau}}{\\kappa}\n$$\n$$\n1 - \\Delta \\tau \\lambda_{\\max} = 1 - \\left(\\frac{CFL_{\\tau}}{\\lambda_{\\max}}\\right) \\lambda_{\\max} = 1 - CFL_{\\tau}\n$$\n因此，迭代矩阵的谱半径作为 $CFL_{\\tau}$ 和 $\\kappa$ 的函数为：\n$$\n\\rho(G) = \\max\\left( \\left|1 - \\frac{CFL_{\\tau}}{\\kappa}\\right|, |1 - CFL_{\\tau}| \\right)\n$$\n我们的目标是找到使该函数最小化的 $CFL_{\\tau}  0$ 的值。两个函数的最大值的最小值通常在两个函数值相等的地方取得。我们试图平衡 $G$ 的两个极端特征值的模。为了保证稳定性，我们需要 $\\rho(G)  1$，这意味着 $|1 - CFL_{\\tau}|  1$，从而得出 $0  CFL_{\\tau}  2$。在此范围内，因为 $\\kappa \\geq 1$ 且 $CFL_{\\tau}  2$，所以 $\\frac{CFL_{\\tau}}{\\kappa}  2$，项 $1 - \\frac{CFL_{\\tau}}{\\kappa}$ 是正的。项 $1 - CFL_{\\tau}$ 可以是正的也可以是负的。当这两项的模相等并被最小化时，即可达到最优收敛速度。这种情况发生在这两项互为相反数时：\n$$\n1 - \\Delta \\tau \\lambda_{\\min} = -(1 - \\Delta \\tau \\lambda_{\\max})\n$$\n这确保了 $G$ 的谱区间 $[1 - \\Delta \\tau \\lambda_{\\max}, 1 - \\Delta \\tau \\lambda_{\\min}]$ 对称地以零为中心，从而最小化其最大绝对值。\n解此方程求 $\\Delta \\tau$：\n$$\n1 - \\Delta \\tau \\lambda_{\\min} = \\Delta \\tau \\lambda_{\\max} - 1\n$$\n$$\n2 = \\Delta \\tau (\\lambda_{\\min} + \\lambda_{\\max})\n$$\n$$\n\\Delta \\tau_{\\text{opt}} = \\frac{2}{\\lambda_{\\min} + \\lambda_{\\max}}\n$$\n现在，我们将这个最优伪时间步长转换为最优伪时间 CFL 数 $CFL_{\\tau, \\text{opt}}$：\n$$\nCFL_{\\tau, \\text{opt}} = \\Delta \\tau_{\\text{opt}} \\cdot \\rho(A) = \\left( \\frac{2}{\\lambda_{\\min} + \\lambda_{\\max}} \\right) \\lambda_{\\max} = \\frac{2\\lambda_{\\max}}{\\lambda_{\\min} + \\lambda_{\\max}}\n$$\n最后，为了用谱条件数 $\\kappa = \\frac{\\lambda_{\\max}}{\\lambda_{\\min}}$ 表示此结果，我们将分子和分母同除以 $\\lambda_{\\min}$：\n$$\nCFL_{\\tau, \\text{opt}} = \\frac{2 \\frac{\\lambda_{\\max}}{\\lambda_{\\min}}}{\\frac{\\lambda_{\\min}}{\\lambda_{\\min}} + \\frac{\\lambda_{\\max}}{\\lambda_{\\min}}} = \\frac{2\\kappa}{1 + \\kappa}\n$$\n这就是使前向欧拉迭代矩阵的谱半径最小化的伪时间 CFL 数值，从而最大化了向稳态解的收敛速度。",
            "answer": "$$\\boxed{\\frac{2\\kappa}{1+\\kappa}}$$"
        },
        {
            "introduction": "在计算流体力学中，我们经常遇到“刚性”问题，即系统中不同物理过程的时间尺度差异巨大，这给显式方法带来了巨大挑战。本练习通过一个简单的标量模型来模拟这种刚性效应，让你通过编码实践来直观地比较显式和隐式伪时间积分方案的性能。你将清楚地看到为何对于刚性系统，隐式方法不仅是更优选择，而且是唯一可行的选择，从而深刻理解在高级CFD应用中广泛采用隐式双时间步法的根本原因 。",
            "id": "3313197",
            "problem": "考虑单一线性化残差模式下，通过双时间步方法进行的稳态加速。设伪时间误差幅值 $e(\\tau)$ 遵循一个标量测试方程演化，该方程由残差算子围绕稳态解线性化得到，即常微分方程 $de/d\\tau = -\\lambda\\, e$，其中 $\\lambda \\gt 0$。内（伪时间）积分采用显式前向欧拉法或隐式后向欧拉法进行。从归一化初始条件 $e(0)=1$ 开始，确定所需的伪时间迭代次数，以使误差幅值减小至最多 $10^{-6}$。\n\n您必须从基本原理出发，推导迭代次数，从标量测试方程 $de/d\\tau = -\\lambda e$ 开始，然后应用每种时间积分格式的更新来获得每次迭代的误差放大因子。请使用以下定义和约束：\n- 伪时间步长固定为 $\\Delta \\tau = 10^{-5}$（秒）。\n- 对于显式前向欧拉格式，使用通过大小为 $\\Delta \\tau$ 的单个前向欧拉步长离散化 $de/d\\tau = -\\lambda e$ 所得的更新。\n- 对于隐式后向欧拉格式，使用通过大小为 $\\Delta \\tau$ 的单个后向欧拉步长离散化 $de/d\\tau = -\\lambda e$ 所得的更新。\n- 如果收敛，所需的迭代次数是使 $n$ 次迭代后误差的绝对值最多为 $10^{-6}$ 的最小整数 $n$。\n- 如果显式格式不能严格减小误差的绝对值（即，其放大因子的绝对值大于或等于 $1$），则将显式迭代次数声明为 $+\\infty$。\n\n测试套件：\n- 使用六个值 $\\lambda \\in \\{10^{2},\\,10^{4},\\,2\\times 10^{5},\\,3\\times 10^{5},\\,5\\times 10^{5},\\,10^{6}\\}$。\n- 对于上述集合中的每个 $\\lambda$，计算一对结果 $[n_{\\text{explicit}}, n_{\\text{implicit}}]$，其中每个条目是整数迭代次数（如果有限），或在不收敛时为 $+\\infty$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含六个测试用例的结果，形式为逗号分隔的数对列表，并用方括号括起来，且不含空格。例如，一种可接受的格式是 $[[a,b],[c,d],\\dots]$，其中每个 $a,b,c,d$ 是用十进制表示的非负整数或由浮点文字量 $inf$ 表示的符号 $\\infty$。\n- 输出是无量纲的计数；输出中不需要物理单位。",
            "solution": "该问题要求确定将线性化残差误差模式的幅值减小到其初始值的 $10^{-6}$ 所需的伪时间迭代次数 $n$。误差幅值 $e(\\tau)$ 由标量常微分方程（ODE）控制：\n$$\n\\frac{de}{d\\tau} = -\\lambda e(\\tau)\n$$\n其中特征值为实数且为正，$\\lambda  0$，初始条件为 $e(0)=1$。伪时间积分使用固定的步长 $\\Delta\\tau = 10^{-5}$，并采用两种不同的格式：显式前向欧拉法和隐式后向欧拉法。\n\n设 $e_k$ 表示 $e(k\\Delta\\tau)$ 的数值近似。两种格式的迭代过程都可以表示为 $e_{k+1} = G e_k$ 的形式，其中 $G$ 是放大因子。从 $e_0 = 1$ 开始，经过 $n$ 次迭代后的误差为 $e_n = G^n e_0 = G^n$。收敛准则是找到最小的整数 $n$ 使得 $|e_n| \\leq 10^{-6}$，这等价于 $|G|^n \\leq 10^{-6}$。\n\n如果 $|G|  1$，我们可以通过对两边取自然对数来求 $n$：\n$$\nn \\ln|G| \\leq \\ln(10^{-6})\n$$\n因为 $|G|  1$，所以 $\\ln|G|$ 是负数。用 $\\ln|G|$ 除两边会使不等号反向：\n$$\nn \\geq \\frac{\\ln(10^{-6})}{\\ln|G|}\n$$\n所需的迭代次数是满足此条件的最小整数，由向上取整函数给出：\n$$\nn = \\left\\lceil \\frac{\\ln(10^{-6})}{\\ln|G|} \\right\\rceil\n$$\n如果 $|G| \\geq 1$，误差不会减小，迭代次数被视为无穷大（$+\\infty$）。\n\n现在我们为每种格式推导放大因子 $G$。\n\n**1. 显式前向欧拉格式**\n\n前向欧拉法通过在当前时间层 $\\tau_k$ 近似导数来离散化常微分方程：\n$$\n\\frac{e_{k+1} - e_k}{\\Delta\\tau} = -\\lambda e_k\n$$\n求解 $e_{k+1}$，我们得到更新规则：\n$$\ne_{k+1} = e_k - \\lambda \\Delta\\tau e_k = (1 - \\lambda \\Delta\\tau) e_k\n$$\n因此，显式格式的放大因子为：\n$$\nG_{\\text{explicit}} = 1 - \\lambda \\Delta\\tau\n$$\n为保证收敛，放大因子的绝对值必须严格小于 $1$：\n$$\n|G_{\\text{explicit}}| = |1 - \\lambda \\Delta\\tau|  1\n$$\n由于 $\\lambda  0$ 和 $\\Delta\\tau  0$，乘积 $\\lambda\\Delta\\tau$ 是正的。该不等式等价于 $-1  1 - \\lambda\\Delta\\tau  1$。\n右侧不等式 $1 - \\lambda\\Delta\\tau  1$ 意味着 $-\\lambda\\Delta\\tau  0$，这总是成立的。\n左侧不等式 $-1  1 - \\lambda\\Delta\\tau$ 意味着 $\\lambda\\Delta\\tau  2$。\n因此，显式前向欧拉格式仅在 $\\lambda\\Delta\\tau  2$ 时稳定。根据问题陈述，如果不满足此条件（即，如果 $|G_{\\text{explicit}}| \\geq 1$，对应于 $\\lambda\\Delta\\tau \\geq 2$），则迭代次数为 $n_{\\text{explicit}} = +\\infty$。\n当格式稳定时，迭代次数为：\n$$\nn_{\\text{explicit}} = \\left\\lceil \\frac{\\ln(10^{-6})}{\\ln|1 - \\lambda\\Delta\\tau|} \\right\\rceil\n$$\n\n**2. 隐式后向欧拉格式**\n\n后向欧拉法通过在下一个时间层 $\\tau_{k+1}$ 近似导数来离散化常微分方程：\n$$\n\\frac{e_{k+1} - e_k}{\\Delta\\tau} = -\\lambda e_{k+1}\n$$\n求解 $e_{k+1}$：\n$$\ne_{k+1} + \\lambda \\Delta\\tau e_{k+1} = e_k \\implies e_{k+1}(1 + \\lambda\\Delta\\tau) = e_k\n$$\n这给出了更新规则：\n$$\ne_{k+1} = \\frac{1}{1 + \\lambda\\Delta\\tau} e_k\n$$\n隐式格式的放大因子为：\n$$\nG_{\\text{implicit}} = \\frac{1}{1 + \\lambda\\Delta\\tau}\n$$\n由于 $\\lambda  0$ 和 $\\Delta\\tau  0$，分母 $1 + \\lambda\\Delta\\tau$ 总是大于 $1$。因此，对于所有有效的问题参数，$0  G_{\\text{implicit}}  1$。对于此常微分方程，隐式后向欧拉格式是无条件稳定的。迭代次数总是有限的，由下式给出：\n$$\nn_{\\text{implicit}} = \\left\\lceil \\frac{\\ln(10^{-6})}{\\ln\\left(\\frac{1}{1 + \\lambda\\Delta\\tau}\\right)} \\right\\rceil = \\left\\lceil \\frac{\\ln(10^{-6})}{-\\ln(1 + \\lambda\\Delta\\tau)} \\right\\rceil = \\left\\lceil \\frac{-\\ln(10^{-6})}{\\ln(1 + \\lambda\\Delta\\tau)} \\right\\rceil\n$$\n\n**数值评估**\n\n我们将这些公式应用于给定的测试套件，其中 $\\Delta\\tau = 10^{-5}$，容差目标为 $10^{-6}$。\n\n- **情况 1：$\\lambda = 10^2$**\n  - $\\lambda\\Delta\\tau = 10^2 \\times 10^{-5} = 0.001$。这满足显式稳定性条件 $\\lambda\\Delta\\tau  2$。\n  - $n_{\\text{explicit}} = \\left\\lceil \\frac{\\ln(10^{-6})}{\\ln|1 - 0.001|} \\right\\rceil = \\left\\lceil \\frac{-13.8155}{-0.0010005} \\right\\rceil = \\lceil 13808.6 \\rceil = 13809$。\n  - $n_{\\text{implicit}} = \\left\\lceil \\frac{-\\ln(10^{-6})}{\\ln(1 + 0.001)} \\right\\rceil = \\left\\lceil \\frac{13.8155}{0.0009995} \\right\\rceil = \\lceil 13822.4 \\rceil = 13823$。\n  - 结果：$[13809, 13823]$\n\n- **情况 2：$\\lambda = 10^4$**\n  - $\\lambda\\Delta\\tau = 10^4 \\times 10^{-5} = 0.1$。这满足 $\\lambda\\Delta\\tau  2$。\n  - $n_{\\text{explicit}} = \\left\\lceil \\frac{\\ln(10^{-6})}{\\ln|1 - 0.1|} \\right\\rceil = \\left\\lceil \\frac{-13.8155}{-0.10536} \\right\\rceil = \\lceil 131.12 \\rceil = 132$。\n  - $n_{\\text{implicit}} = \\left\\lceil \\frac{-\\ln(10^{-6})}{\\ln(1 + 0.1)} \\right\\rceil = \\left\\lceil \\frac{13.8155}{0.09531} \\right\\rceil = \\lceil 144.95 \\rceil = 145$。\n  - 结果：$[132, 145]$\n\n- **情况 3：$\\lambda = 2 \\times 10^5$**\n  - $\\lambda\\Delta\\tau = 2 \\times 10^5 \\times 10^{-5} = 2$。这是稳定性极限。$|G_{\\text{explicit}}| = |1 - 2| = 1$。\n  - $n_{\\text{explicit}} = +\\infty$。\n  - $n_{\\text{implicit}} = \\left\\lceil \\frac{-\\ln(10^{-6})}{\\ln(1 + 2)} \\right\\rceil = \\left\\lceil \\frac{13.8155}{1.0986} \\right\\rceil = \\lceil 12.57 \\rceil = 13$。\n  - 结果：$[+\\infty, 13]$\n\n- **情况 4：$\\lambda = 3 \\times 10^5$**\n  - $\\lambda\\Delta\\tau = 3 \\times 10^5 \\times 10^{-5} = 3$。这违反了稳定性条件 $\\lambda\\Delta\\tau  2$。\n  - $n_{\\text{explicit}} = +\\infty$。\n  - $n_{\\text{implicit}} = \\left\\lceil \\frac{-\\ln(10^{-6})}{\\ln(1 + 3)} \\right\\rceil = \\left\\lceil \\frac{13.8155}{1.3863} \\right\\rceil = \\lceil 9.966 \\rceil = 10$。\n  - 结果：$[+\\infty, 10]$\n\n- **情况 5：$\\lambda = 5 \\times 10^5$**\n  - $\\lambda\\Delta\\tau = 5 \\times 10^5 \\times 10^{-5} = 5$。这违反了稳定性条件。\n  - $n_{\\text{explicit}} = +\\infty$。\n  - $n_{\\text{implicit}} = \\left\\lceil \\frac{-\\ln(10^{-6})}{\\ln(1 + 5)} \\right\\rceil = \\left\\lceil \\frac{13.8155}{1.7918} \\right\\rceil = \\lceil 7.71 \\rceil = 8$。\n  - 结果：$[+\\infty, 8]$\n\n- **情况 6：$\\lambda = 10^6$**\n  - $\\lambda\\Delta\\tau = 10^6 \\times 10^{-5} = 10$。这违反了稳定性条件。\n  - $n_{\\text{explicit}} = +\\infty$。\n  - $n_{\\text{implicit}} = \\left\\lceil \\frac{-\\ln(10^{-6})}{\\ln(1 + 10)} \\right\\rceil = \\left\\lceil \\frac{13.8155}{2.3979} \\right\\rceil = \\lceil 5.76 \\rceil = 6$。\n  - 结果：$[+\\infty, 6]$",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the number of pseudo-time iterations for error reduction\n    using explicit forward Euler and implicit backward Euler schemes.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        10**2,\n        10**4,\n        2 * 10**5,\n        3 * 10**5,\n        5 * 10**5,\n        10**6,\n    ]\n\n    delta_tau = 1e-5\n    tolerance = 1e-6\n    # Pre-calculate the natural logarithm of the tolerance for efficiency.\n    log_tolerance = np.log(tolerance)\n\n    results = []\n    for lam in test_cases:\n        # Calculate the dimensionless product lambda * delta_tau\n        lambda_dt = lam * delta_tau\n\n        # --- Explicit Forward Euler ---\n        # The stability condition for the explicit scheme is lambda * delta_tau  2.\n        # If lambda * delta_tau >= 2, the amplification factor's magnitude is >= 1,\n        # leading to non-convergence.\n        if lambda_dt >= 2.0:\n            n_explicit = np.inf\n        else:\n            # Amplification factor G = 1 - lambda * delta_tau\n            # We need |G|^n = tolerance, so n >= log(tolerance) / log(|G|).\n            # The result must be the smallest integer, hence the ceiling.\n            g_explicit = abs(1.0 - lambda_dt)\n            n_explicit = int(np.ceil(log_tolerance / np.log(g_explicit)))\n\n        # --- Implicit Backward Euler ---\n        # The implicit scheme is unconditionally stable for this problem.\n        # Amplification factor G = 1 / (1 + lambda * delta_tau)\n        # We need G^n = tolerance, so n >= log(tolerance) / log(G).\n        # log(G) = log(1 / (1 + lambda_dt)) = -log(1 + lambda_dt).\n        # Thus, n >= log(tolerance) / -log(1 + lambda_dt).\n        n_implicit = int(np.ceil(log_tolerance / -np.log(1.0 + lambda_dt)))\n\n        results.append((n_explicit, n_implicit))\n\n    # Format the output string to match the exact requirement: [[a,b],[c,d],...] with no spaces.\n    formatted_pairs = []\n    for n_exp, n_imp in results:\n        # np.inf stringifies to 'inf' by default, which is required.\n        s_exp = 'inf' if np.isinf(n_exp) else str(int(n_exp))\n        s_imp = str(int(n_imp))\n        formatted_pairs.append(f\"[{s_exp},{s_imp}]\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_pairs)}]\")\n\nsolve()\n```"
        }
    ]
}