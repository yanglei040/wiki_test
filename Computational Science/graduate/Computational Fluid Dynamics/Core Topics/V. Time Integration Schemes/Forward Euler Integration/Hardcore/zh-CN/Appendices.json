{
    "hands_on_practices": [
        {
            "introduction": "本练习将回归基础。我们将隔离一个扩散问题的单一模式，并从第一性原理出发，推导前向欧拉法的最大稳定时间步长。这个基础练习对于建立关于数值稳定性限制为何产生以及它们如何与系统物理特性相关的坚实直觉至关重要。",
            "id": "3321237",
            "problem": "考虑一个纯扩散偏微分方程的半离散模型，该模型源于热方程在周期性域上的相容空间离散化。该半离散系统是一个形式如下的线性常微分方程\n$$\n\\frac{d \\boldsymbol{u}}{dt} = \\boldsymbol{L}\\,\\boldsymbol{u},\n$$\n其中 $\\boldsymbol{L}$ 是一个实矩阵，由于扩散效应，其谱位于非正实轴上。设 $\\lambda$ 为 $\\boldsymbol{L}$ 的一个特征值，对应于非零特征向量 $\\boldsymbol{v}$，并假设 $\\lambda = -a$，其中 $a>0$。\n\n你使用显式前向欧拉法对该系统进行时间积分，其计算步骤定义为\n$$\n\\boldsymbol{u}^{n+1} = \\boldsymbol{u}^{n} + \\Delta t\\,\\boldsymbol{L}\\,\\boldsymbol{u}^{n}.\n$$\n假设初始条件恰好位于由 $\\boldsymbol{v}$ 张成的特征空间中，因此 $\\boldsymbol{u}^{0} = c\\,\\boldsymbol{v}$，其中 $c \\neq 0$。将此特征模态的线性稳定性定义为：离散解沿 $\\boldsymbol{v}$ 方向的幅值不随 $n$ 的增加而增长。\n\n仅从前向欧拉法的步长定义和特征对的代数性质出发，推导保证与 $\\lambda = -a$ 相关的特征模态在上述意义下线性稳定的最大时间步长 $\\Delta t_{\\max}$，并将其表示为关于 $a$ 的闭式解析表达式。\n\n你的最终答案必须是单个闭式表达式。不包含单位。不使用任何缩写。不要引用或假设任何已知的稳定区域；而是直接从前向欧拉更新和特征模态结构进行推理。",
            "solution": "半离散系统为\n$$\n\\frac{d \\boldsymbol{u}}{dt} = \\boldsymbol{L}\\,\\boldsymbol{u}.\n$$\n设 $\\lambda = -a$（其中 $a>0$）为 $\\boldsymbol{L}$ 的一个特征值，其特征向量为 $\\boldsymbol{v} \\neq \\boldsymbol{0}$，因此\n$$\n\\boldsymbol{L}\\,\\boldsymbol{v} = \\lambda\\,\\boldsymbol{v} = -a\\,\\boldsymbol{v}.\n$$\n前向欧拉法定义为\n$$\n\\boldsymbol{u}^{n+1} = \\boldsymbol{u}^{n} + \\Delta t\\,\\boldsymbol{L}\\,\\boldsymbol{u}^{n}.\n$$\n假设初始条件位于由 $\\boldsymbol{v}$ 张成的特征空间中，即 $\\boldsymbol{u}^{0} = c\\,\\boldsymbol{v}$，其中 $c \\neq 0$。由于右侧是线性的，且 $\\boldsymbol{v}$ 是一个特征向量，前向欧拉更新保持特征方向不变：如果 $\\boldsymbol{u}^{n} = y_{n}\\,\\boldsymbol{v}$（其中 $y_{n}$ 为某个标量），那么\n$$\n\\boldsymbol{u}^{n+1} = \\boldsymbol{u}^{n} + \\Delta t\\,\\boldsymbol{L}\\,\\boldsymbol{u}^{n}\n= y_{n}\\,\\boldsymbol{v} + \\Delta t\\,\\boldsymbol{L}\\,(y_{n}\\,\\boldsymbol{v})\n= y_{n}\\,\\boldsymbol{v} + \\Delta t\\,y_{n}\\,(\\boldsymbol{L}\\,\\boldsymbol{v})\n= y_{n}\\,\\boldsymbol{v} + \\Delta t\\,y_{n}\\,\\lambda\\,\\boldsymbol{v}.\n$$\n因此，\n$$\n\\boldsymbol{u}^{n+1} = \\left(1 + \\lambda\\,\\Delta t\\right) y_{n}\\,\\boldsymbol{v},\n$$\n这意味着存在如下标量递推关系\n$$\ny_{n+1} = \\left(1 + \\lambda\\,\\Delta t\\right) y_{n}.\n$$\n通过迭代，我们得到\n$$\ny_{n} = \\left(1 + \\lambda\\,\\Delta t\\right)^{n} y_{0}.\n$$\n此特征模态的线性稳定性的给定定义要求其幅值不随 $n$ 增长，即，\n$$\n\\left|y_{n}\\right| \\leq \\left|y_{0}\\right| \\quad \\text{for all integers } n \\geq 0.\n$$\n这等价于要求\n$$\n\\left|1 + \\lambda\\,\\Delta t\\right| \\leq 1.\n$$\n代入 $\\lambda = -a$（其中 $a>0$），我们得到\n$$\n\\left|1 - a\\,\\Delta t\\right| \\leq 1.\n$$\n对于实数自变量，不等式 $\\left|z\\right| \\leq 1$（其中 $z = 1 - a\\,\\Delta t$）等价于双重不等式\n$$\n-1 \\leq 1 - a\\,\\Delta t \\leq 1.\n$$\n整理左侧不等式 $-1 \\leq 1 - a\\,\\Delta t$ 得到\n$$\n-2 \\leq -a\\,\\Delta t \\quad \\Longleftrightarrow \\quad 2 \\geq a\\,\\Delta t \\quad \\Longleftrightarrow \\quad \\Delta t \\leq \\frac{2}{a}.\n$$\n整理右侧不等式 $1 - a\\,\\Delta t \\leq 1$ 得到\n$$\n-a\\,\\Delta t \\leq 0 \\quad \\Longleftrightarrow \\quad \\Delta t \\geq 0,\n$$\n对于时间步长 $\\Delta t \\geq 0$，该不等式自动满足。综合两者，稳定性条件为\n$$\n0 \\leq \\Delta t \\leq \\frac{2}{a}.\n$$\n因此，保证与 $\\lambda = -a$ 相关的特征模态线性稳定的最大时间步长是\n$$\n\\Delta t_{\\max} = \\frac{2}{a}.\n$$",
            "answer": "$$\\boxed{\\frac{2}{a}}$$"
        },
        {
            "introduction": "稳定性保证了计算不会失败，但精度决定了其有效性。本练习介绍理查德森外推法，这是一种通过比较两个不同时间步长的结果来估计数值误差的强大技术。掌握此方法可以帮助您验证代码实现并量化模拟的收敛阶。",
            "id": "3321231",
            "problem": "考虑一个在单一空间维度上进行纯粘性衰减的不可压缩Navier–Stokes方程的傅里叶模态。在空间上进行线方法半离散化后，模态振幅 $a(t)$ 遵循线性常微分方程 $a'(t) = -\\nu k^{2} a(t)$ 演化，其中 $\\nu$ 是运动粘度，$k$ 是波数。假设精确解是光滑的，并且初值问题是适定的。你使用前向欧拉时间积分法，以两个不同的时间步长，将此常微分方程积分到一个共同的终点时刻。\n\n物理参数为 $\\nu = 1.0 \\times 10^{-2}$ 和 $k = 10$，初始振幅 $a(0) = 1$，终点时刻 $T = 0.2$。使用时间步长 $\\Delta t = 0.05$ 的前向欧拉积分得到记录值 $a_{\\Delta t}(T) = 0.81450625$ (单位：米/秒)，第二次使用时间步长 $\\Delta t/2 = 0.025$ 的前向欧拉积分得到 $a_{\\Delta t/2}(T) = 0.816651803662262$ (单位：米/秒)。\n\n从应用于 $a'(t) = -\\nu k^{2} a(t)$ 的前向欧拉法的基本相容性和光滑性假设出发，推导全局时间积分误差相对于 $\\Delta t$ 的主阶标度关系。然后，利用该标度关系，通过结合上面给出的两个记录值 $a_{\\Delta t}(T)$ 和 $a_{\\Delta t/2}(T)$，为使用时间步长 $\\Delta t$ 计算的解构造一个在时刻 $T$ 的前向欧拉全局误差的Richardson外推估计。计算这个估计误差的数值。将你的答案四舍五入到六位有效数字。用米/秒 (m/s) 表示最终误差。",
            "solution": "用户希望找到全局误差的Richardson外推估计。\n\n### 步驟1：问题验证\n\n**1.1. 提取已知条件**\n- **控制方程**：单个傅里叶模态的振幅 $a(t)$ 遵循线性常微分方程 (ODE) $a'(t) = -\\nu k^{2} a(t)$ 演化。\n- **物理参数**：\n  - 运动粘度, $\\nu = 1.0 \\times 10^{-2}$。\n  - 波数, $k = 10$。\n- **初始和最终条件**：\n  - 初始振幅, $a(0) = 1$。\n  - 终点时刻, $T = 0.2$。\n- **数值方法**：前向欧拉时间积分。\n- **数值结果**：\n  - 时间步长 $\\Delta t = 0.05$ 时，终点时刻的计算值为 $a_{\\Delta t}(T) = 0.81450625$。\n  - 时间步长 $\\Delta t/2 = 0.025$ 时，终点时刻的计算值为 $a_{\\Delta t/2}(T) = 0.816651803662262$。\n- **任务**：\n  1. 推导全局时间积分误差相对于 $\\Delta t$ 的主阶标度关系。\n  2. 使用此标度关系为使用时间步长 $\\Delta t$ 计算的解构造一个全局误差的Richardson外推估计。\n  3. 计算此估计误差的数值，并将其四舍五入到六位有效数字。\n\n**1.2. 使用提取的已知条件进行验证**\n- **科学依据**：该问题描述了不可压缩Navier-Stokes方程中傅里叶模态的粘性衰减，这是流体动力学中的一个标准课题。模型ODE是此现象对于单个模态的简化但正确的表示。前向欧拉法和Richardson外推是数值分析中的基本技术。该设置在科学上和数学上都是合理的。\n- **适定性**：该问题提供了一个带初始条件的线性一阶ODE，这构成了一个适定的初值问题。该任务是一个定义明确的计算过程。\n- **客观性**：问题以精确、客观、无歧义的术语陈述。\n- **完整性和一致性**：所有必要的数据（$\\nu$, $k$, $a(0)$, $T$, $\\Delta t$ 和数值结果）都已提供。我们可以验证所提供的数值结果的一致性。ODE可以写为 $a'(t) = \\lambda a(t)$，其中 $\\lambda = -\\nu k^2 = -(1.0 \\times 10^{-2})(10^2) = -1$。前向欧拉格式为 $a_{n+1} = a_n + \\Delta t (\\lambda a_n) = a_n (1 - \\Delta t)$。\n  - 对于 $\\Delta t = 0.05$，步数为 $N = T/\\Delta t = 0.2/0.05 = 4$。数值解为 $a_{\\Delta t}(T) = a(0)(1 - \\Delta t)^N = 1 \\cdot (1 - 0.05)^4 = (0.95)^4 = 0.81450625$。这与提供的值相符。\n  - 对于 $\\Delta t/2 = 0.025$，步数为 $N' = T/(\\Delta t/2) = 0.2/0.025 = 8$。数值解为 $a_{\\Delta t/2}(T) = a(0)(1 - 0.025)^8 = (0.975)^8 \\approx 0.8166518036622619$，这与给定的值 $0.816651803662262$ 在给定精度下相符。\n问题内部一致且完整。\n\n**1.3. 结论与行动**\n问题是有效的。我们继续进行求解。\n\n### 步驟2：推导与求解\n\n问题要求我们首先推导前向欧拉法的全局误差的主阶标度关系，然后用它来估计误差。\n\n**2.1. 全局误差标度关系**\n设ODE写作 $a'(t) = \\lambda a(t)$，其中 $\\lambda = -\\nu k^2 = -(1.0 \\times 10^{-2})(10)^2 = -1$。\n该ODE的前向欧拉法由以下递推关系给出：\n$$a_{n+1} = a_n + \\Delta t \\cdot (\\lambda a_n) = (1 + \\lambda \\Delta t) a_n$$\n其中 $a_n$ 是对时刻 $t_n = n \\Delta t$ 的精确解 $a(t_n)$ 的数值近似。\n\n为了确定该方法的阶数，我们首先分析局部截断误差 $\\tau_{n+1}$，这是在假设步初解是精确的（即 $a_n = a(t_n)$）情况下，单步产生的误差。\n从 $t_n$ 到 $t_{n+1} = t_n + \\Delta t$ 的一个时间步长内的精确解是 $a(t_{n+1}) = a(t_n) \\exp(\\lambda \\Delta t)$。\n使用指数函数的泰勒级数展开，我们得到：\n$$a(t_{n+1}) = a(t_n) \\left(1 + \\lambda \\Delta t + \\frac{(\\lambda \\Delta t)^2}{2!} + \\frac{(\\lambda \\Delta t)^3}{3!} + \\dots \\right)$$\n一步之后的数值解是 $a_{n+1} = a_n(1 + \\lambda \\Delta t)$。\n局部截断误差是一步之后精确解与数值解之间的差：\n$$\\tau_{n+1} = a(t_{n+1}) - a_{n+1} = a(t_n) \\left(1 + \\lambda \\Delta t + \\frac{\\lambda^2 \\Delta t^2}{2} + O(\\Delta t^3)\\right) - a(t_n)(1 + \\lambda \\Delta t)$$\n$$\\tau_{n+1} = a(t_n) \\frac{\\lambda^2}{2} \\Delta t^2 + O(\\Delta t^3)$$\n局部截断误差的阶为 $O(\\Delta t^2)$。对于一个稳定的单步数值方法，阶为 $O(\\Delta t^{p+1})$ 的局部截断误差会导致阶为 $O(\\Delta t^p)$ 的全局误差。在这里，$p+1=2$，所以 $p=1$。因此，前向欧拉法是一阶方法，其全局误差 $E_{\\Delta t}(T)$ 在 $\\Delta t$ 较小时与时间步长 $\\Delta t$呈线性关系。\n\n我们可以将终点时刻 $T$ 的全局误差写成关于 $\\Delta t$ 幂次的渐近展开式：\n$$E_{\\Delta t}(T) = a_{\\Delta t}(T) - a_{exact}(T) = C_1 \\Delta t + C_2 \\Delta t^2 + O(\\Delta t^3)$$\n其中 $a_{\\Delta t}(T)$ 是使用步长 $\\Delta t$ 在时刻 $T$ 的数值解，$a_{exact}(T)$ 是真实解，而 $C_1, C_2, \\dots$ 是依赖于ODE和终点时刻 $T$ 但不依赖于 $\\Delta t$ 的常数。主阶标度关系是 $C_1 \\Delta t$，即 $O(\\Delta t)$。\n\n**2.2. 用于误差估计的Richardson外推**\n我们有两个数值解，一个时间步长为 $\\Delta t$，另一个为 $\\Delta t/2$。我们可以为精确解 $a_{exact}(T)$ 写出以下表达式：\n$$a_{exact}(T) = a_{\\Delta t}(T) - (C_1 \\Delta t + C_2 \\Delta t^2 + \\dots)$$\n$$a_{exact}(T) = a_{\\Delta t/2}(T) - \\left(C_1 \\frac{\\Delta t}{2} + C_2 \\left(\\frac{\\Delta t}{2}\\right)^2 + \\dots\\right)$$\n忽略 $O(\\Delta t^2)$ 及更高阶的项，我们得到一个关于两个未知数 $a_{exact}(T)$ 和 $C_1$ 的方程组：\n$$a_{\\Delta t}(T) \\approx a_{exact}(T) + C_1 \\Delta t$$\n$$a_{\\Delta t/2}(T) \\approx a_{exact}(T) + C_1 \\frac{\\Delta t}{2}$$\n第一个方程减去第二个方程得到：\n$$a_{\\Delta t}(T) - a_{\\Delta t/2}(T) \\approx \\left(a_{exact}(T) + C_1 \\Delta t\\right) - \\left(a_{exact}(T) + C_1 \\frac{\\Delta t}{2}\\right)$$\n$$a_{\\Delta t}(T) - a_{\\Delta t/2}(T) \\approx C_1 \\frac{\\Delta t}{2}$$\n使用时间步长 $\\Delta t$ 的解的全局误差是 $E_{\\Delta t}(T) = a_{\\Delta t}(T) - a_{exact}(T)$。在主阶上，这个误差是 $E_{\\Delta t}(T) \\approx C_1 \\Delta t$。我们寻求对这个量的估计。从前面的方程，我们可以写出：\n$$C_1 \\Delta t \\approx 2 \\left(a_{\\Delta t}(T) - a_{\\Delta t/2}(T)\\right)$$\n因此，对于使用时间步长 $\\Delta t$ 计算的解的全局误差的Richardson外推估计，我们记作 $E_{\\Delta t, \\text{est}}$，是：\n$$E_{\\Delta t, \\text{est}} = 2 \\left(a_{\\Delta t}(T) - a_{\\Delta t/2}(T)\\right)$$\n这应该是 $E_{\\Delta t, \\text{est}} \\approx a_{\\Delta t}(T) - a_{\\text{richardson}} = a_{\\Delta t}(T) - (2a_{\\Delta t/2}(T) - a_{\\Delta t}(T)) = 2(a_{\\Delta t}(T) - a_{\\Delta t/2}(T))$. The formula is correct.\n\n**2.3. 数值计算**\n我们得到以下数值：\n$$a_{\\Delta t}(T) = 0.81450625 \\text{ for } \\Delta t = 0.05$$\n$$a_{\\Delta t/2}(T) = 0.816651803662262 \\text{ for } \\Delta t/2 = 0.025$$\n将这些值代入我们的误差估计公式：\n$$E_{\\Delta t, \\text{est}} = a_{\\Delta t}(T) - a_{exact}(T) \\approx 2 (a_{\\Delta t/2}(T) - a_{\\Delta t}(T))$$\nWait, the signs are switched. Let's re-derive.\n$a_{\\Delta t} \\approx a_{exact} + C_1 \\Delta t$\n$a_{\\Delta t/2} \\approx a_{exact} + C_1 \\Delta t / 2$\n$a_{\\Delta t} - a_{\\Delta t/2} \\approx C_1 \\Delta t / 2$.\n$E_{\\Delta t} = a_{\\Delta t} - a_{exact} \\approx C_1 \\Delta t$.\n$C_1 \\Delta t \\approx 2(a_{\\Delta t} - a_{\\Delta t/2})$.\nSo the estimate for the error IS $2(a_{\\Delta t} - a_{\\Delta t/2})$.\n$$E_{\\Delta t, \\text{est}} = 2 (0.81450625 - 0.816651803662262)$$\n$$E_{\\Delta t, \\text{est}} = 2 (-0.002145553662262)$$\n$$E_{\\Delta t, \\text{est}} = -0.004291107324524$$\n问题要求将最终答案四舍五入到六位有效数字。第一位有效数字是 $4$。前六位有效数字是 $4, 2, 9, 1, 1, 0$。第七位有效数字是 $7$，所以我们将第六位有效数字向上舍入。\n$$E_{\\Delta t, \\text{est}} \\approx -0.00429111$$\n用科学记数法表示，这是 $-4.29111 \\times 10^{-3}$。问题指定振幅的单位是米/秒 (m/s)，所以误差也将具有这些单位。",
            "answer": "$$\\boxed{-4.29111 \\times 10^{-3}}$$"
        },
        {
            "introduction": "在实践中，时间积分方案的稳定性与其配对的空间离散化方案是密不可分的。这个高级练习使用冯·诺依曼分析来探讨对流方程的不同空间格式（从简单的迎风格式到中心差分）如何显著改变前向欧拉法的稳定性约束。这突显了计算流体力学中的一个关键教训：必须将数值格式作为一个整体进行分析。",
            "id": "3321238",
            "problem": "考虑线性平流方程 $u_{t} + a\\,u_{x} = 0$，其中波速为常数 $a > 0$，定义在周期性域上，并在间距为 $\\Delta x$ 的均匀网格上进行离散。令 $u_{j}(t)$ 表示网格索引 $j \\in \\mathbb{Z}$ 处的格点中心半离散解。你将分析应用于 $u_{x}$ 的三种不同空间离散化的前向欧拉时间积分方法：(i) 一阶迎风差分，(ii) 二阶中心差分，以及 (iii) 在其标准光滑解线性化下的五阶加权基本无振荡 (WENO) 有限差分格式（即，非线性权值被冻结在最优线性权值，且当 $a>0$ 时使用通量分裂，因此只有左偏重构有贡献）。\n\n从离散傅里叶（冯·诺依曼）分析的定义出发，将半离散系统视为 $u_{t} = \\mathcal{L}_{h} u$，并为每种空间离散化推导出复傅里叶符号 $\\Phi(\\theta)$（其中 $\\theta = k\\,\\Delta x \\in [0,\\pi]$，k 为整数波数），使得半离散特征值为 $\\lambda(\\theta) = -\\dfrac{a}{\\Delta x}\\,\\Phi(\\theta)$。然后，对于前向欧拉法，单步放大因子为 $G(\\theta) = 1 + \\Delta t\\,\\lambda(\\theta) = 1 - \\nu\\,\\Phi(\\theta)$，其中 $\\nu \\equiv \\dfrac{a\\,\\Delta t}{\\Delta x}$ 是库朗数。\n\n仅使用前向欧拉法的稳定域定义，即稳定性要求对所有 $\\theta \\in [0,\\pi]$ 都有 $|G(\\theta)| \\le 1$，执行以下操作：\n\n1. 对于一阶迎風差分 $D^{(1)} u_{j} = \\dfrac{u_{j} - u_{j-1}}{\\Delta x}$，推导 $\\Phi(\\theta)$ 以及由 $\\max_{\\theta} |G(\\theta)| \\le 1$ 强加的对 $\\nu$ 的相应稳定性限制。\n\n2. 对于二阶中心差分 $D^{(2)} u_{j} = \\dfrac{u_{j+1} - u_{j-1}}{2\\,\\Delta x}$，推导 $\\Phi(\\theta)$ 并确定是否存在任何 $\\nu > 0$ 可以满足 $\\max_{\\theta} |G(\\theta)| \\le 1$。\n\n3. 对于在光滑数据线性化、使用最优线性权值和通量分裂（对于 $a>0$）下的五阶加权基本无振荡 (WENO) 格式，首先构建半节点处的左偏五阶线性重构和由此产生的通量差分半离散算子。由此，推导相应的 $\\Phi(\\theta)$ 及其在小 $\\theta$ 下的 $\\Re \\Phi(\\theta)$ 和 $\\Im \\Phi(\\theta)$ 的渐近式。使用这些渐近式来判断是否存在任何 $\\nu > 0$ 满足 $\\max_{\\theta} |G(\\theta)| \\le 1$。\n\n最后，综合考虑这三种空间离散化，确定能够同时保证所有三种离散化前向欧拉稳定性的库朗数 $\\nu$ 的最紧上界。将您的最终答案表示为单个无量纲数 $\\nu_{\\max}$（即，不包括物理单位）。提供一个精确值。",
            "solution": "该问题要求分析应用于线性平流方程 $u_{t} + a\\,u_{x} = 0$（其中 $a > 0$）的前向欧拉时间积分方法在三种不同空间离散化下的稳定性。稳定性分析将使用离散傅里叶（冯·诺依曼）方法进行。\n\n方程的半离散形式为 $\\frac{d u_j}{dt} = \\mathcal{L}_h u_j$，其中 $u_j(t)$ 是网格点 $x_j = j\\Delta x$ 处的解。对于线性平流方程，算子 $\\mathcal{L}_h$ 是对 $-a \\frac{\\partial}{\\partial x}$ 的一个近似。将单个傅里叶模 $u_j(t) = \\hat{u}(k, t) e^{i k x_j} = \\hat{u}(t) e^{ij\\theta}$（其中 $\\theta = k\\Delta x$）代入半离散方程，得到关于振幅 $\\hat{u}(t)$ 的常微分方程：$\\frac{d\\hat{u}}{dt} = \\lambda(\\theta) \\hat{u}$。问题将特征值定义为复傅里叶符号 $\\Phi(\\theta)$ 的形式：$\\lambda(\\theta) = -\\frac{a}{\\Delta x}\\Phi(\\theta)$。\n\n应用前向欧拉法 $u^{n+1}_j = u^n_j + \\Delta t (\\mathcal{L}_h u^n)_j$，放大因子 $G(\\theta)$ 被确定为 $G(\\theta) = \\frac{\\hat{u}^{n+1}}{\\hat{u}^n} = 1 + \\Delta t \\lambda(\\theta)$。使用所提供的定义，这变为 $G(\\theta) = 1 - \\frac{a\\Delta t}{\\Delta x}\\Phi(\\theta) = 1 - \\nu\\Phi(\\theta)$，其中 $\\nu = \\frac{a\\Delta t}{\\Delta x}$ 是库朗数。\n\n数值稳定性的条件是 $|G(\\theta)| \\le 1$ 对所有相关波数成立，这对应于 $\\theta \\in [0, \\pi]$。该条件表明，所有缩放后的特征值集合 $z(\\theta) = \\Delta t \\lambda(\\theta) = -\\nu \\Phi(\\theta)$ 必须位于前向欧拉方法的稳定域内，即复平面中由 $|1+z| \\le 1$ 定义的圆盘。\n\n我们现在分析每一种空间离散化。\n\n### 1. 一阶迎风差分\n\n对于 $u_x$ 且 $a>0$，一阶迎风差分为 $D^{(1)} u_{j} = \\frac{u_{j} - u_{j-1}}{\\Delta x}$。半离散方程为 $\\frac{du_j}{dt} = -a D^{(1)} u_j = -a \\frac{u_j - u_{j-1}}{\\Delta x}$。\n代入傅里叶模 $u_j(t) = \\hat{u}(t) e^{ij\\theta}$：\n$$ \\frac{d\\hat{u}}{dt} e^{ij\\theta} = -\\frac{a}{\\Delta x} (\\hat{u}e^{ij\\theta} - \\hat{u}e^{i(j-1)\\theta}) = -\\frac{a}{\\Delta x} (1 - e^{-i\\theta}) \\hat{u}e^{ij\\theta} $$\n特征值为 $\\lambda(\\theta) = -\\frac{a}{\\Delta x}(1 - e^{-i\\theta})$。与 $\\lambda(\\theta) = -\\frac{a}{\\Delta x}\\Phi(\\theta)$ 比较，我们找到符号：\n$$ \\Phi^{(1)}(\\theta) = 1 - e^{-i\\theta} = 1 - (\\cos\\theta - i\\sin\\theta) = (1-\\cos\\theta) + i\\sin\\theta $$\n放大因子为 $G^{(1)}(\\theta) = 1 - \\nu \\Phi^{(1)}(\\theta)$。稳定性条件 $|G^{(1)}(\\theta)|^2 \\le 1$ 得出：\n$$ |1 - \\nu((1-\\cos\\theta) + i\\sin\\theta)|^2 \\le 1 $$\n$$ (1 - \\nu(1-\\cos\\theta))^2 + (-\\nu\\sin\\theta)^2 \\le 1 $$\n$$ 1 - 2\\nu(1-\\cos\\theta) + \\nu^2(1-\\cos\\theta)^2 + \\nu^2\\sin^2\\theta \\le 1 $$\n$$ -2\\nu(1-\\cos\\theta) + \\nu^2(1 - 2\\cos\\theta + \\cos^2\\theta + \\sin^2\\theta) \\le 0 $$\n$$ -2\\nu(1-\\cos\\theta) + \\nu^2(2 - 2\\cos\\theta) \\le 0 $$\n$$ 2\\nu(1-\\cos\\theta)(\\nu - 1) \\le 0 $$\n给定 $\\nu > 0$ 且 $1-\\cos\\theta \\ge 0$，此不等式对所有 $\\theta$ 成立当且仅当 $\\nu-1 \\le 0$，即 $\\nu \\le 1$。包括平凡情况 $\\nu=0$，稳定范围是 $0 \\le \\nu \\le 1$。\n\n### 2. 二阶中心差分\n\n二阶中心差分为 $D^{(2)} u_{j} = \\frac{u_{j+1} - u_{j-1}}{2\\Delta x}$。半离散方程为 $\\frac{du_j}{dt} = -a \\frac{u_{j+1} - u_{j-1}}{2\\Delta x}$。\n代入傅里叶模：\n$$ \\frac{d\\hat{u}}{dt} e^{ij\\theta} = -\\frac{a}{2\\Delta x} (\\hat{u}e^{i(j+1)\\theta} - \\hat{u}e^{i(j-1)\\theta}) = -\\frac{a}{2\\Delta x} (e^{i\\theta} - e^{-i\\theta}) \\hat{u}e^{ij\\theta} = -\\frac{a}{\\Delta x} (i\\sin\\theta) \\hat{u}e^{ij\\theta} $$\n特征值为 $\\lambda(\\theta) = -\\frac{a}{\\Delta x}(i\\sin\\theta)$，所以符号为：\n$$ \\Phi^{(2)}(\\theta) = i\\sin\\theta $$\n放大因子为 $G^{(2)}(\\theta) = 1 - \\nu(i\\sin\\theta) = 1 - i\\nu\\sin\\theta$。稳定性条件 $|G^{(2)}(\\theta)|^2 \\le 1$ 得出：\n$$ |1 - i\\nu\\sin\\theta|^2 = 1^2 + (-\\nu\\sin\\theta)^2 = 1 + \\nu^2\\sin^2\\theta \\le 1 $$\n这要求 $\\nu^2\\sin^2\\theta \\le 0$。因为 $\\nu$ 是实数，这只在 $\\nu\\sin\\theta = 0$ 时才成立。对于任何 $\\nu>0$，该条件对任意 $\\theta \\in (0, \\pi)$ 都不成立。因此，对于任何 $\\nu > 0$，此格式与前向欧拉法结合是无条件不稳定的。唯一稳定的值为 $\\nu=0$。\n\n### 3. 五阶线性化WENO格式\n\n半离散形式为 $\\frac{du_j}{dt} = - \\frac{1}{\\Delta x}(\\hat{f}_{j+1/2} - \\hat{f}_{j-1/2})$，其中 $\\hat{f}$ 是数值通量。对于 $f(u)=au$ 且 $a>0$，通量分裂得到 $\\hat{f}_{j+1/2} = a u^-_{j+1/2}$，其中 $u^-_{j+1/2}$ 是一个左偏重构。线性化的WENO5意味着使用最优线性权值 $\\gamma_0 = 0.1$, $\\gamma_1 = 0.6$, $\\gamma_2=0.3$ 来组合三个三阶重构。\n$ u^-_{j+1/2} = \\frac{1}{80}(3 u_{j-2} - 16 u_{j-1} + 60 u_j + 36 u_{j+1} - 3 u_{j+2}) $\n算子为 $\\frac{du_j}{dt} = -\\frac{a}{\\Delta x} (u^-_{j+1/2} - u^-_{j-1/2})$。这给出了一个有限差分算子，代入傅里叶模后，其符号为：\n$$ \\Phi^{(3)}(\\theta) = \\frac{1}{80}[-3e^{-3i\\theta} + 19e^{-2i\\theta} - 76e^{-i\\theta} + 24 + 39e^{i\\theta} - 3e^{2i\\theta}] $$\n我们分析其小 $\\theta$ 渐近式。\n$$ \\Im(\\Phi^{(3)}(\\theta)) = \\theta - \\frac{1}{24}\\theta^3 + O(\\theta^5) $$\n$$ \\Re(\\Phi^{(3)}(\\theta)) = -\\frac{1}{80}\\theta^4 + O(\\theta^6) $$\n虚部的首项 $\\theta$ 表明该格式与一阶导数一致。实部的首项是 $O(\\theta^4)$ 且为负。\n稳定性条件 $|1-\\nu\\Phi|^2 \\le 1$ 可简化为 $-2\\nu\\Re\\Phi + \\nu^2|\\Phi|^2 \\le 0$。对于 $\\nu>0$，此条件为 $-2\\Re\\Phi + \\nu|\\Phi|^2 \\le 0$。\n对于小的 $\\theta \\ne 0$ 使用渐近式：\n$$ -2(-\\frac{1}{80}\\theta^4) + \\nu(\\theta^2 + O(\\theta^4)) \\le 0 $$\n$$ \\frac{1}{40}\\theta^4 + \\nu\\theta^2 + O(\\nu\\theta^4) \\le 0 $$\n除以 $\\theta^2$:\n$$ \\frac{1}{40}\\theta^2 + \\nu + O(\\nu\\theta^2) \\le 0 $$\n对于任何 $\\nu>0$，存在一个足够小的 $\\theta_0$，使得对于所有 $0  |\\theta|  \\theta_0$，左侧为正，违反了稳定性条件。其根源在于，对于小的非零 $\\theta$，半离散特征值 $\\lambda(\\theta) = -\\frac{a}{\\Delta x}\\Phi(\\theta)$ 的实部为 $\\Re(\\lambda) \\approx -\\frac{a}{\\Delta x}(-\\frac{1}{80}\\theta^4) = \\frac{a}{80\\Delta x}\\theta^4 > 0$。一个具有正实部特征值的系统在物理上是不稳定的，因此没有任何稳定于左半平面的时间积分方法（如前向欧拉法）可以稳定它。因此，对于任何 $\\nu  0$，此格式与前向欧拉法结合是无条件不稳定的。唯一稳定的情况是平凡情况 $\\nu=0$。\n\n### 结论\n\n我们必须找到能够同时保证所有三种离散化都稳定的 $\\nu$ 的最紧上界。每种格式稳定的非负库朗数集合为：\n- 格式 1 (一阶迎风): $S_1 = [0, 1]$\n- 格式 2 (二阶中心): $S_2 = \\{0\\}$\n- 格式 3 (线性化五阶WENO): $S_3 = \\{0\\}$\n\n能保证所有三种格式都稳定的库朗数集合是这些集合的交集：\n$$ S = S_1 \\cap S_2 \\cap S_3 = [0, 1] \\cap \\{0\\} \\cap \\{0\\} = \\{0\\} $$\n问题要求 $\\nu$ 的最紧上界，即集合 $S$ 的上确界。\n$$ \\nu_{\\max} = \\sup(S) = \\sup(\\{0\\}) = 0 $$\n因此，不存在任何正的库朗数 $\\nu  0$ 使得在使用前向欧拉时间积分时所有三种格式都稳定。唯一可能性是平凡情况，即没有时间演化（$\\Delta t=0$）。",
            "answer": "$$\n\\boxed{0}\n$$"
        }
    ]
}