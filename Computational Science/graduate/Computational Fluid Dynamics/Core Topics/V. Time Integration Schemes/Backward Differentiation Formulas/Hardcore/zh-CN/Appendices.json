{
    "hands_on_practices": [
        {
            "introduction": "评估任何数值方法的首要步骤是量化其精度。本练习将通过泰勒级数展开，指导你推导二阶反向微分公式（BDF2）的局部截断误差。通过这个基本练习 ，你将能亲手验证该方法的二阶精度，并理解误差项与解的高阶导数之间的关系。",
            "id": "3293325",
            "problem": "考虑一个由计算流体动力学(CFD)中的线法产生的不可压缩Navier–Stokes方程的半离散格式，它导出了一个形式为 $y'(t) = f(t,y(t))$ 的常微分方程(ODE)组，其中 $y(t)$ 表示离散解变量的向量，$t$ 是时间，$f$ 集合了空间离散算子和源项。设使用均匀时间步长 $h  0$，且 $t_n = t_0 + n h$。二阶两步反向微分公式(BDF2)在时间 $t_n$ 应用如下\n$$\\frac{3 y_n - 4 y_{n-1} + y_{n-2}}{2 h} = f(t_n, y_n),$$\n其中 $y_k \\approx y(t_k)$。\n\n将归一化局部截断误差 $\\tau_n$ 定义为：将精确解 $y(t)$ 代入BDF2公式，并将右端项 $f(t_n,y_n)$ 替换为精确时间导数 $y'(t_n)$ 时产生的残差：\n$$\\tau_n := \\frac{3 y(t_n) - 4 y(t_{n-1}) + y(t_{n-2})}{2 h} - y'(t_n).$$\n\n从 $y(t)$ 关于 $t_n$ 的Taylor级数展开出发，并仅使用上述局部截断误差的基本定义，推导 $\\tau_n$ 的主阶项的显式表达式，并证明 $\\tau_n = O(h^2)$。你的最终答案必须是一个单一的闭式解析表达式，给出以 $h$ 和 $y^{(3)}(t_n)$ 表示的 $\\tau_n$ 的主阶项。",
            "solution": "问题要求推导两步反向微分公式(BDF2)的归一化局部截断误差 $\\tau_n$ 的主阶项。分析将通过把精确解 $y(t)$ 的Taylor级数展开代入 $\\tau_n$ 的定义来执行。\n\n首先，我们陈述给定的归一化局部截断误差的定义：\n$$ \\tau_n := \\frac{3 y(t_n) - 4 y(t_{n-1}) + y(t_{n-2})}{2 h} - y'(t_n) $$\n此处，$y(t)$ 是常微分方程 $y'(t) = f(t, y(t))$ 的精确解。时间点由 $t_k = t_0 + k h$ 定义，这意味着 $t_{n-1} = t_n - h$ 和 $t_{n-2} = t_n - 2h$。\n\n推导的核心是将项 $y(t_{n-1})$ 和 $y(t_{n-2})$ 在点 $t_n$ 附近展开为Taylor级数。我们假设解 $y(t)$ 足够光滑，在 $t_n$ 的邻域内至少具有三阶连续导数。展开式如下：\n\n对于 $y(t_{n-1}) = y(t_n - h)$:\n$$ y(t_{n-1}) = y(t_n) - h y'(t_n) + \\frac{h^2}{2!} y''(t_n) - \\frac{h^3}{3!} y^{(3)}(t_n) + O(h^4) $$\n$$ y(t_{n-1}) = y(t_n) - h y'(t_n) + \\frac{h^2}{2} y''(t_n) - \\frac{h^3}{6} y^{(3)}(t_n) + O(h^4) $$\n\n对于 $y(t_{n-2}) = y(t_n - 2h)$:\n$$ y(t_{n-2}) = y(t_n) - (2h) y'(t_n) + \\frac{(2h)^2}{2!} y''(t_n) - \\frac{(2h)^3}{3!} y^{(3)}(t_n) + O(h^4) $$\n$$ y(t_{n-2}) = y(t_n) - 2h y'(t_n) + \\frac{4h^2}{2} y''(t_n) - \\frac{8h^3}{6} y^{(3)}(t_n) + O(h^4) $$\n$$ y(t_{n-2}) = y(t_n) - 2h y'(t_n) + 2h^2 y''(t_n) - \\frac{4h^3}{3} y^{(3)}(t_n) + O(h^4) $$\n\n现在，我们将这些展开式代入 $\\tau_n$ 表达式的分子，即 $3 y(t_n) - 4 y(t_{n-1}) + y(t_{n-2})$。\n\n$$ 3 y(t_n) - 4 y(t_{n-1}) + y(t_{n-2}) = 3 y(t_n) $$\n$$ - 4 \\left( y(t_n) - h y'(t_n) + \\frac{h^2}{2} y''(t_n) - \\frac{h^3}{6} y^{(3)}(t_n) + O(h^4) \\right) $$\n$$ + \\left( y(t_n) - 2h y'(t_n) + 2h^2 y''(t_n) - \\frac{4h^3}{3} y^{(3)}(t_n) + O(h^4) \\right) $$\n\n让我们根据 $y(t)$ 在 $t_n$ 处导数的阶数来收集各项：\n$y(t_n)$ 的系数：\n$$ 3 - 4 + 1 = 0 $$\n$y'(t_n)$ 的系数：\n$$ -4(-h) + (-2h) = 4h - 2h = 2h $$\n$y''(t_n)$ 的系数：\n$$ -4\\left(\\frac{h^2}{2}\\right) + 2h^2 = -2h^2 + 2h^2 = 0 $$\n$y^{(3)}(t_n)$ 的系数：\n$$ -4\\left(-\\frac{h^3}{6}\\right) - \\frac{4h^3}{3} = \\frac{4h^3}{6} - \\frac{4h^3}{3} = \\frac{2h^3}{3} - \\frac{4h^3}{3} = -\\frac{2h^3}{3} $$\n\n更高阶的项是 $O(h^4)$ 阶。综合这些结果，分子变为：\n$$ 3 y(t_n) - 4 y(t_{n-1}) + y(t_{n-2}) = (0)y(t_n) + (2h)y'(t_n) + (0)y''(t_n) - \\frac{2h^3}{3}y^{(3)}(t_n) + O(h^4) $$\n$$ = 2h y'(t_n) - \\frac{2h^3}{3} y^{(3)}(t_n) + O(h^4) $$\n\n现在，我们将此结果代回 $\\tau_n$ 的公式中：\n$$ \\tau_n = \\frac{1}{2h} \\left( 2h y'(t_n) - \\frac{2h^3}{3} y^{(3)}(t_n) + O(h^4) \\right) - y'(t_n) $$\n除以 $2h$，我们得到：\n$$ \\tau_n = \\left( y'(t_n) - \\frac{h^2}{3} y^{(3)}(t_n) + O(h^3) \\right) - y'(t_n) $$\n$y'(t_n)$ 项相互抵消：\n$$ \\tau_n = - \\frac{h^2}{3} y^{(3)}(t_n) + O(h^3) $$\n\n这个 $\\tau_n$ 的显式表达式表明了两件事。首先，由于主项与 $h^2$ 成正比，局部截断误差是2阶的，即 $\\tau_n = O(h^2)$。这与BDF2方法是一个二阶精度格式的结论一致。\n\n其次，归一化局部截断误差 $\\tau_n$ 的主阶项由所得级数的第一项给出。该项即为问题所要求的答案。\n$\\tau_n$ 的主阶项是：\n$$ - \\frac{h^2}{3} y^{(3)}(t_n) $$",
            "answer": "$$\\boxed{-\\frac{h^2}{3} y^{(3)}(t_n)}$$"
        },
        {
            "introduction": "对于计算流体力学中常见的刚性问题，仅有精度是不够的；稳定性至关重要。本练习将带你深入研究BDF2方法的绝对稳定性，通过根轨迹法推导其稳定边界。完成此练习 后，你将能解释为何BDF2是求解刚性微分方程组的有力工具，并理解其A-稳定性的重要意义。",
            "id": "3293367",
            "problem": "在计算流体动力学中，隐式多步时间积分方法被广泛用于推进由守恒律空间离散化产生的半离散系统。考虑带有复参数 $\\lambda \\in \\mathbb{C}$ 的线性测试常微分方程 (ODE) $y' = \\lambda y$，以及称为二阶反向微分公式 (BDF2) 的二阶向后差分公式 (BDF)。线性多步法的绝对稳定性通过其放大方程来定义：对于一个固定的无量纲步长参数 $z = h \\lambda$，其中 $h > 0$ 是无量纲时间步长，稳定性要求特征多项式的所有根 $\\xi \\in \\mathbb{C}$ 都满足 $|\\xi| \\le 1$，而绝对稳定区域的边界由 $|\\xi| = 1$ 得到。\n\n从线性多步法的形式和 BDF2 方法的定义系数出发，推导测试问题 $y' = \\lambda y$ 的放大方程，并使用根轨迹法得到复 $z$-平面中稳定边界曲线的显式参数表达式 $z(\\theta)$，其中 $\\theta \\in [0, 2\\pi)$ 参数化了单位圆 $|\\xi| = 1$。\n\n然后，将 $\\lambda$ 限制为负实数（即 $\\lambda \\in \\mathbb{R}$ 且 $\\lambda  0$），并确定将 BDF2 方法应用于 $y' = \\lambda y$ 时，使其绝对稳定的最大稳定无量纲时间步长 $h$。将您的最终答案表示为：\n- $z(\\theta)$ 的显式公式，以及\n- 对于负实数 $\\lambda$，稳定 $h$ 的上确界。\n\n两者均以无单位的符号形式报告。如果需要任何数值舍入，将会以有效数字的形式指定；然而，本问题不需要舍入。",
            "solution": "本解答旨在分析二阶反向微分公式（BDF2）应用于测试方程 $y' = \\lambda y$ 时的绝对稳定性。\n\n用于常微分方程 $y' = f(t,y)$ 的一般的 $k$-步线性多步法 (LMM) 通常写作：\n$$ \\sum_{j=0}^{k} \\alpha_j y_{n+j} = h \\sum_{j=0}^{k} \\beta_j f_{n+j} $$\n二阶反向微分公式 (BDF2) 是一种两步法 ($k=2$)。其标准形式为：\n$$ y_{n+2} - \\frac{4}{3} y_{n+1} + \\frac{1}{3} y_n = \\frac{2}{3} h f_{n+2} $$\n由此，我们确定LMM的特征多项式 $\\rho(\\xi)$ 和 $\\sigma(\\xi)$:\n$$ \\rho(\\xi) = \\xi^2 - \\frac{4}{3} \\xi + \\frac{1}{3} $$\n$$ \\sigma(\\xi) = \\frac{2}{3} \\xi^2 $$\n将该方法应用于测试方程 $y'=\\lambda y$ (即 $f=\\lambda y$)，并寻找形如 $y_n = \\xi^n$ 的解，可得到该方法的特征方程（或称放大方程）：\n$$ \\rho(\\xi) - z \\sigma(\\xi) = 0 $$\n其中 $z = h\\lambda$ 是无量纲步长参数。代入 BDF2 的多项式，我们得到：\n$$ \\left(\\xi^2 - \\frac{4}{3} \\xi + \\frac{1}{3}\\right) - z \\left(\\frac{2}{3} \\xi^2\\right) = 0 $$\n绝对稳定区域是所有使得该方程的根 $\\xi$ 满足 $|\\xi| \\le 1$ 的 $z \\in \\mathbb{C}$ 的集合。该区域的边界是存在至少一个根满足 $|\\xi| = 1$ 的 $z$ 的集合。\n\n**第1部分：稳定边界 $z(\\theta)$ 的推导**\n\n为求稳定边界，我们对特征方程求解 $z$，并设 $|\\xi|=1$。\n$$ z = \\frac{\\rho(\\xi)}{\\sigma(\\xi)} = \\frac{\\xi^2 - \\frac{4}{3} \\xi + \\frac{1}{3}}{\\frac{2}{3} \\xi^2} $$\n简化此表达式：\n$$ z = \\frac{3}{2} \\left( \\frac{\\xi^2 - \\frac{4}{3} \\xi + \\frac{1}{3}}{\\xi^2} \\right) = \\frac{3}{2} \\left( 1 - \\frac{4}{3\\xi} + \\frac{1}{3\\xi^2} \\right) $$\n通过让 $\\xi$ 在复平面上沿单位圆移动，即令 $\\xi = e^{i\\theta}$ 对于 $\\theta \\in [0, 2\\pi)$，来参数化稳定边界。将此代入 $z$ 的表达式：\n$$ z(\\theta) = \\frac{3}{2} \\left( 1 - \\frac{4}{3}e^{-i\\theta} + \\frac{1}{3}e^{-i2\\theta} \\right) $$\n$$ z(\\theta) = \\frac{3}{2} - 2e^{-i\\theta} + \\frac{1}{2}e^{-i2\\theta} $$\n这就是稳定边界的显式参数表达式。\n\n**第2部分：对于负实数 $\\lambda$ 的最大稳定步长**\n\n现在，我们将 $\\lambda$ 限制为负实数（$\\lambda  0$）。由于步长 $h$ 是正数，参数 $z = h\\lambda$ 是一个负实数。我们需要确定对于哪些负实数值 $z$，BDF2 方法是绝对稳定的。这等价于找出位于稳定区域内的负实轴部分。\n\n我们考察稳定边界 $z(\\theta)$ 的实部：\n$$ \\text{Re}(z(\\theta)) = \\text{Re}\\left( \\frac{3}{2} - 2e^{-i\\theta} + \\frac{1}{2}e^{-i2\\theta} \\right) $$\n$$ \\text{Re}(z(\\theta)) = \\frac{3}{2} - 2\\cos(-\\theta) + \\frac{1}{2}\\cos(-2\\theta) = \\frac{3}{2} - 2\\cos(\\theta) + \\frac{1}{2}\\cos(2\\theta) $$\n使用恒等式 $\\cos(2\\theta) = 2\\cos^2(\\theta) - 1$：\n$$ \\text{Re}(z(\\theta)) = \\frac{3}{2} - 2\\cos(\\theta) + \\frac{1}{2}(2\\cos^2(\\theta) - 1) = \\cos^2(\\theta) - 2\\cos(\\theta) + 1 $$\n$$ \\text{Re}(z(\\theta)) = (1 - \\cos(\\theta))^2 $$\n由于 $\\cos(\\theta)$ 是一个介于 $-1$ 和 $1$ 之间的实数，所以 $(1 - \\cos(\\theta))^2 \\ge 0$。对于所有的 $\\theta$，稳定边界的实部都是非负的（仅在 $\\theta=0$ 时为零，对应于 $z=0$）。这意味着稳定区域的边界完全位于闭合的右半复平面 $\\text{Re}(z) \\ge 0$ 内。\n\n为了确定稳定区域是该边界曲线的内部还是外部，我们测试一个点。对于 $z \\to \\infty$，特征方程 $(1 - \\frac{2}{3}z)\\xi^2 - \\frac{4}{3}\\xi + \\frac{1}{3} = 0$ 近似为 $-\\frac{2}{3}z\\xi^2 \\approx 0$，这给出的根是 $\\xi \\approx 0$。由于 $|0| \\le 1$，无穷远点是稳定的。因此，绝对稳定区域是边界曲线 $z(\\theta)$ 的外部。\n\n由于边界包含在右半平面内，其外部必然包含整个开放的左半平面 $\\{z \\in \\mathbb{C} \\mid \\text{Re}(z)  0\\}$。因此，BDF2 是 A-稳定的。这意味着对于任何满足 $\\text{Re}(z)  0$ 的 $z$，该方法都是绝对稳定的。\n\n对于 $\\lambda  0$ 的特定情况，只要 $h>0$，参数 $z = h\\lambda$ 始终是一个负实数。任何这样的 $z$ 都位于开放的左半平面内。因此，对于任意 $h > 0$，BDF2 方法都是绝对稳定的。所有稳定步长 $h$ 的集合是 $(0, \\infty)$。这个集合的上确界（最小上界）是无穷大。",
            "answer": "$$\n\\boxed{\n\\begin{aligned}\n(\\theta) = \\frac{3}{2} - 2e^{-i\\theta} + \\frac{1}{2}e^{-i2\\theta} \\\\\n\\text{稳定步长 } h \\text{ 的上确界: } \\infty\n\\end{aligned}\n}\n$$"
        },
        {
            "introduction": "理论上的高阶精度在实际应用中可能会因不当的实现细节而丢失，尤其是在处理含时边界条件时。本练习模拟了一个典型场景：由于边界数据处理不一致，导致BDF格式出现阶数降低。通过分析并修正这个问题 ，你将学会一种重要技能，即如何确保数值格式在复杂问题中保持其设计的理论精度。",
            "id": "3293359",
            "problem": "考虑一维热方程，这是计算流体动力学（CFD）中的一个典型模型，由公式 $\\partial u/\\partial t = \\nu\\,\\partial^{2} u/\\partial x^{2}$ 给出，定义在空间区间 $[0,1]$上，并带有含时狄利克雷边界条件 $u(0,t)=g(t)$ 和 $u(1,t)=0$。设空间离散化通过具有 $N$ 个内部节点的二阶中心有限差分来执行，得到一个线法半离散系统 $y'(t)=A\\,y(t)+s(t)$，其中 $A\\in\\mathbb{R}^{N\\times N}$ 是乘以 $\\nu$ 的离散拉普拉斯算子，而 $s(t)$ 是 $g(t)$ 的线性函数，用于捕捉 $x=0$ 处的边界强迫项。假设 $g(t)$ 足够光滑，特别地，在所关心的时间区间上 $g \\in C^{k+1}$。\n\n对于时间积分，考虑一个 $k$ 步反向微分公式（BDF），其时间步长为常数 $\\Delta t0$，时间层为 $t_{n}=t_{0}+n\\,\\Delta t$。将 BDF 格式应用于该半离散系统，在 $t_{n+1}$ 处产生一个形式如下的隐式更新\n$$\n\\sum_{j=0}^{k}\\alpha_{j}\\,y^{n+1-j}=\\Delta t\\,\\left(A\\,y^{n+1}+s^{n+1}\\right),\n$$\n其中 $y^{m}\\approx y(t_{m})$，$s^{m}\\approx s(t_{m})$，系数 $\\alpha_{j}$ 对应于 $k$ 步 BDF。\n\n在许多实现中，通过使用 $g^{n}\\equiv g(t_{n})$ 而不是 $g^{n+1}\\equiv g(t_{n+1})$ 来设置 $s^{n+1}$，导致右侧的含时边界数据被不一致地处理。从半离散形式 $y'(t)=A\\,y(t)+s(t)$ 和 BDF 格式的定义出发，分析当 $A$ 是刚性（如扩散问题中）时，这种不一致的处理如何导致全局时间精度的阶数降低。使用 $g(t)$ 在 $t_{n}$ 附近的泰勒展开，来确定用 $s^{n}$ 替换 $s^{n+1}$ 所引起的主阶缺陷，并论证由此产生的有效精度阶。\n\n然后，通过基于过去在 $t_{n},t_{n-1},\\dots,t_{n-k}$ 处的边界值，构造一个 $k$ 次的 $g(t)$ 时间多项式外插，为边界数据推导一个与 BDF 格式的 $k$ 阶相一致的修正格式。假设时间步长均匀，并通过在归一化时间坐标中进行拉格朗日插值，从第一性原理推导出外插权重。最后，对于 $k=3$ 的具体情况，提供修正后边界值 $g^{n+1}$ 的显式外插公式，该公式仅用 $g^{n},g^{n-1},g^{n-2},g^{n-3}$ 表示。\n\n您的最终答案必须是给出 $g^{n+1}$ 关于 $g^{n},g^{n-1},g^{n-2},g^{n-3}$ 的单一闭式解析表达式。不需要进行数值舍入，也不需要包含任何物理单位。",
            "solution": "该问题被验证为具有科学依据、适定（well-posed）且客观的。它提出了偏微分方程数值分析中的一个标准情景，特别是关于由于边界条件实现不一致而导致的时间步进格式的阶数降低问题。任务定义清晰，可以使用既定的数学技术解决。\n\n按照要求，分析分三部分进行：分析阶数降低，推导通用修正格式，以及为 $k=3$ 的情况提供显式修正。\n\n### 阶数降低分析\n\n半离散系统由以下常微分方程（ODE）给出：\n$$\ny'(t) = A\\,y(t) + s(t)\n$$\n其中 $y(t) \\in \\mathbb{R}^{N}$ 是节点值的向量，$A$ 是刚性离散算子，$s(t)$ 是由含时边界条件 $g(t)$ 产生的源项。\n\n一个 $k$ 步反向微分公式（BDF）以 $k$ 阶精度逼近在时间 $t_{n+1}$ 处的导数 $y'(t)$。应用于导数项的 BDF 的局部截断误差（LTE）为 $O(\\Delta t^{k+1})$。该常微分方程的形式上正确的 BDF 格式为：\n$$\n\\sum_{j=0}^{k}\\alpha_{j}\\,y^{n+1-j} = \\Delta t\\,(A\\,y^{n+1}+s^{n+1})\n$$\n（这里我们采用了系数 $\\beta_0=1$ 的常见约定）。左侧是 $\\Delta t \\, y'(t_{n+1})$ 的 BDF 近似。将精确解 $y(t_{n+1-j})$ 代入此表达式，得到：\n$$\n\\sum_{j=0}^{k}\\alpha_{j}\\,y(t_{n+1-j}) = \\Delta t \\, y'(t_{n+1}) + O(\\Delta t^{k+1})\n$$\n使用控制常微分方程 $y'(t_{n+1}) = A\\,y(t_{n+1}) + s(t_{n+1})$，我们得到：\n$$\n\\sum_{j=0}^{k}\\alpha_{j}\\,y(t_{n+1-j}) = \\Delta t \\, (A\\,y(t_{n+1}) + s(t_{n+1})) + O(\\Delta t^{k+1})\n$$\n问题指出使用了一种不一致的实现，其中源项 $s^{n+1} = s(t_{n+1})$ 被替换为 $s^n = s(t_n)$。因此，实现的格式为：\n$$\n\\sum_{j=0}^{k}\\alpha_{j}\\,\\tilde{y}^{n+1-j} = \\Delta t\\,(A\\,\\tilde{y}^{n+1}+s^{n})\n$$\n其中 $\\tilde{y}$ 表示不一致格式的解。局部截断误差 $\\tau_{n+1}$ 是通过将精确解 $y(t)$ 代入实现的数值格式中得到的：\n$$\n\\tau_{n+1} = \\frac{1}{\\Delta t}\\sum_{j=0}^{k}\\alpha_{j}\\,y(t_{n+1-j}) - (A\\,y(t_{n+1})+s(t_{n}))\n$$\n代入 BDF 近似的表达式，我们有：\n$$\n\\tau_{n+1} = \\left( A\\,y(t_{n+1}) + s(t_{n+1}) + O(\\Delta t^k) \\right) - (A\\,y(t_{n+1})+s(t_n))\n$$\n$$\n\\tau_{n+1} = s(t_{n+1}) - s(t_n) + O(\\Delta t^k)\n$$\n假设 $s(t)$ 足够光滑（这是 $g(t) \\in C^{k+1}$ 的一个推论），我们对 $s(t_{n+1})$ 在 $t_n$ 附近进行泰勒展开：\n$$\ns(t_{n+1}) = s(t_n) + \\Delta t \\, s'(t_n) + O(\\Delta t^2)\n$$\n因此，主阶缺陷为：\n$$\ns(t_{n+1}) - s(t_n) = \\Delta t \\, s'(t_n) + O(\\Delta t^2)\n$$\n局部截断误差变为：\n$$\n\\tau_{n+1} = \\Delta t \\, s'(t_n) + O(\\Delta t^2) + O(\\Delta t^k)\n$$\n对于任何阶数 $k \\geq 1$ 的 BDF 方法，如果 $s'(t_n) \\neq 0$，主导误差项是 $\\Delta t \\, s'(t_n)$，即 $O(\\Delta t)$。对于一个稳定的方法，$O(\\Delta t^{p})$ 的局部截断误差通常导致 $O(\\Delta t^p)$ 的全局误差。这里，LTE 是 $O(\\Delta t)$（假设问题是良态的），这意味着全局误差是 $O(\\Delta t)$。因此，方法的全局精度降低到一阶，$O(\\Delta t)$，而与 BDF 格式的形式阶数 $k$ 无关。\n\n### 修正格式\n\n为了恢复 BDF 格式的 $k$ 阶精度，源项 $s(t_{n+1})$ 的近似误差必须至少为 $O(\\Delta t^k)$。由于 $s(t)$ 是 $g(t)$ 的线性函数，这要求对 $g(t_{n+1})$ 的近似误差不会降低整个格式的精度。一个满足 $g(t_{n+1}) - g^{n+1}_{\\text{approx}} = O(\\Delta t^{k+1})$ 的近似 $g^{n+1}_{\\text{approx}}$ 就足够了，因为这将在 LTE 中引入一个 $O(\\Delta t^{k+1})$ 的项，该项相对于 BDF 内在的 $O(\\Delta t^{k+1})$ 误差是同阶或更高阶的。\n\n我们构造一个 $k$ 次多项式 $P(t)$，它对最后 $k+1$ 个已知的边界值进行插值：$(t_{n-j}, g^{n-j})$，其中 $j = 0, 1, \\dots, k$。然后通过将此多项式外插到时间 $t_{n+1}$ 来获得修正后的边界值：\n$$\ng^{n+1}_{\\text{corr}} = P(t_{n+1})\n$$\n多项式插值/外插的误差由以下公式给出：\n$$\ng(t) - P(t) = \\frac{g^{(k+1)}(\\xi)}{(k+1)!} \\prod_{j=0}^{k} (t - t_{n-j})\n$$\n其中 $\\xi$ 位于点所跨越的时间区间内。在 $t = t_{n+1}$ 处求值：\n$$\ng(t_{n+1}) - P(t_{n+1}) = \\frac{g^{(k+1)}(\\xi)}{(k+1)!} \\prod_{j=0}^{k} (t_{n+1} - t_{n-j})\n$$\n在常数时间步长 $\\Delta t$下，$t_{m} = t_n + (m-n)\\Delta t$。乘积变为：\n$$\n\\prod_{j=0}^{k} ((n+1)\\Delta t - (n-j)\\Delta t) = \\prod_{j=0}^{k} (1+j)\\Delta t = (k+1)! (\\Delta t)^{k+1}\n$$\n因此，外插误差为：\n$$\ng(t_{n+1}) - g^{n+1}_{\\text{corr}} = \\frac{g^{(k+1)}(\\xi)}{(k+1)!} (k+1)! (\\Delta t)^{k+1} = g^{(k+1)}(\\xi) (\\Delta t)^{k+1} = O(\\Delta t^{k+1})\n$$\n这个修正足够精确，可以恢复 BDF 格式的形式阶数 $k$。\n\n### k=3 时的显式公式\n\n对于 $k=3$，我们需要找到一个通过点 $(t_n, g^n)$, $(t_{n-1}, g^{n-1})$, $(t_{n-2}, g^{n-2})$ 和 $(t_{n-3}, g^{n-3})$ 的 3 次多项式，并在 $t_{n+1}$ 处求值。我们使用拉格朗日插值。定义一个归一化时间坐标 $\\tau = (t - t_n)/\\Delta t$ 会很方便。插值节点为 $\\tau_j = -j$，其中 $j=0, 1, 2, 3$。我们需要外插到 $\\tau=1$。\n\n拉格朗日基多项式 $L_j(\\tau)$ 由 $L_j(\\tau) = \\prod_{i=0, i\\neq j}^{3} \\frac{\\tau - \\tau_i}{\\tau_j - \\tau_i}$ 给出。外插值为 $g^{n+1} = \\sum_{j=0}^{3} c_j g^{n-j}$，其中系数为 $c_j = L_j(1)$。\n\n让我们计算系数 $c_j$：\n对于 $j=0$ (节点 $\\tau_0=0$):\n$$\nc_0 = L_0(1) = \\frac{1-(-1)}{0-(-1)} \\cdot \\frac{1-(-2)}{0-(-2)} \\cdot \\frac{1-(-3)}{0-(-3)} = \\frac{2}{1} \\cdot \\frac{3}{2} \\cdot \\frac{4}{3} = 4\n$$\n对于 $j=1$ (节点 $\\tau_1=-1$):\n$$\nc_1 = L_1(1) = \\frac{1-0}{-1-0} \\cdot \\frac{1-(-2)}{-1-(-2)} \\cdot \\frac{1-(-3)}{-1-(-3)} = \\frac{1}{-1} \\cdot \\frac{3}{1} \\cdot \\frac{4}{2} = -6\n$$\n对于 $j=2$ (节点 $\\tau_2=-2$):\n$$\nc_2 = L_2(1) = \\frac{1-0}{-2-0} \\cdot \\frac{1-(-1)}{-2-(-1)} \\cdot \\frac{1-(-3)}{-2-(-3)} = \\frac{1}{-2} \\cdot \\frac{2}{-1} \\cdot \\frac{4}{1} = 4\n$$\n对于 $j=3$ (节点 $\\tau_3=-3$):\n$$\nc_3 = L_3(1) = \\frac{1-0}{-3-0} \\cdot \\frac{1-(-1)}{-3-(-1)} \\cdot \\frac{1-(-2)}{-3-(-2)} = \\frac{1}{-3} \\cdot \\frac{2}{-2} \\cdot \\frac{3}{-1} = -1\n$$\n结合这些系数，修正后边界值 $g^{n+1}$ 的显式外插公式为：\n$$\ng^{n+1} = c_0 g^n + c_1 g^{n-1} + c_2 g^{n-2} + c_3 g^{n-3} = 4g^n - 6g^{n-1} + 4g^{n-2} - g^{n-3}\n$$\n这个表达式为 $g(t_{n+1})$ 提供了用于三阶 BDF 格式所需的 $O(\\Delta t^4)$ 精度估计，从而恢复了该方法的预期精度。",
            "answer": "$$\n\\boxed{4g^{n} - 6g^{n-1} + 4g^{n-2} - g^{n-3}}\n$$"
        }
    ]
}