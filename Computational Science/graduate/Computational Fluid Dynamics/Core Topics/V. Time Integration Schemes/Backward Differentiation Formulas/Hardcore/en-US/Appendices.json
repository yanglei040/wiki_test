{
    "hands_on_practices": [
        {
            "introduction": "The usefulness of any numerical method begins with its accuracy. The Local Truncation Error (LTE) is our primary tool for quantifying this, measuring how well the exact solution satisfies the difference equation at a single step. This exercise is a foundational practice in numerical analysis; by deriving the LTE for the BDF2 scheme using Taylor series expansions, you will develop a rigorous understanding of what it means for a method to be \"second-order accurate\" and identify the source of its leading error term .",
            "id": "3293325",
            "problem": "Consider a semi-discrete formulation of the incompressible Navierâ€“Stokes equations arising from the method of lines in Computational Fluid Dynamics (CFD), which leads to an ordinary differential equation (ODE) system of the form $y'(t) = f(t,y(t))$, where $y(t)$ denotes the vector of discrete solution variables, $t$ is time, and $f$ collects the spatial discretization operators and source terms. Let a uniform time step $h > 0$ be used, with $t_n = t_0 + n h$. The two-step Backward Differentiation Formula (BDF) of order two (BDF2) is applied at time $t_n$ as\n$$\\frac{3 y_n - 4 y_{n-1} + y_{n-2}}{2 h} = f(t_n, y_n),$$\nwhere $y_k \\approx y(t_k)$.\n\nDefine the normalized local truncation error $\\tau_n$ as the residual incurred when the exact solution $y(t)$ is substituted into the BDF2 formula and the right-hand side $f(t_n,y_n)$ is replaced by the exact time derivative $y'(t_n)$:\n$$\\tau_n := \\frac{3 y(t_n) - 4 y(t_{n-1}) + y(t_{n-2})}{2 h} - y'(t_n).$$\n\nStarting from the Taylor series expansion of $y(t)$ about $t_n$ and using only the fundamental definition of the local truncation error as stated above, derive an explicit expression for the leading-order term of $\\tau_n$ and prove that $\\tau_n = \\mathcal{O}(h^2)$. Your final answer must be a single closed-form analytic expression giving the leading-order term of $\\tau_n$ in terms of $h$ and $y^{(3)}(t_n)$.",
            "solution": "The problem requires the derivation of the leading-order term for the normalized local truncation error, $\\tau_n$, of the two-step Backward Differentiation Formula (BDF2). The analysis will be performed by substituting the Taylor series expansion of the exact solution, $y(t)$, into the definition of $\\tau_n$.\n\nFirst, we state the given definition of the normalized local truncation error:\n$$ \\tau_n := \\frac{3 y(t_n) - 4 y(t_{n-1}) + y(t_{n-2})}{2 h} - y'(t_n) $$\nHere, $y(t)$ is the exact solution to the ordinary differential equation $y'(t) = f(t, y(t))$. The time points are defined by $t_k = t_0 + k h$, which implies $t_{n-1} = t_n - h$ and $t_{n-2} = t_n - 2h$.\n\nThe core of the derivation is to expand the terms $y(t_{n-1})$ and $y(t_{n-2})$ in a Taylor series around the point $t_n$. We assume that the solution $y(t)$ is sufficiently smooth, possessing at least three continuous derivatives in the neighborhood of $t_n$. The expansions are as follows:\n\nFor $y(t_{n-1}) = y(t_n - h)$:\n$$ y(t_{n-1}) = y(t_n) - h y'(t_n) + \\frac{h^2}{2!} y''(t_n) - \\frac{h^3}{3!} y^{(3)}(t_n) + \\mathcal{O}(h^4) $$\n$$ y(t_{n-1}) = y(t_n) - h y'(t_n) + \\frac{h^2}{2} y''(t_n) - \\frac{h^3}{6} y^{(3)}(t_n) + \\mathcal{O}(h^4) $$\n\nFor $y(t_{n-2}) = y(t_n - 2h)$:\n$$ y(t_{n-2}) = y(t_n) - (2h) y'(t_n) + \\frac{(2h)^2}{2!} y''(t_n) - \\frac{(2h)^3}{3!} y^{(3)}(t_n) + \\mathcal{O}(h^4) $$\n$$ y(t_{n-2}) = y(t_n) - 2h y'(t_n) + \\frac{4h^2}{2} y''(t_n) - \\frac{8h^3}{6} y^{(3)}(t_n) + \\mathcal{O}(h^4) $$\n$$ y(t_{n-2}) = y(t_n) - 2h y'(t_n) + 2h^2 y''(t_n) - \\frac{4h^3}{3} y^{(3)}(t_n) + \\mathcal{O}(h^4) $$\n\nNow, we substitute these expansions into the numerator of the expression for $\\tau_n$, which is $3 y(t_n) - 4 y(t_{n-1}) + y(t_{n-2})$.\n\n$$ 3 y(t_n) - 4 y(t_{n-1}) + y(t_{n-2}) = 3 y(t_n) $$\n$$ - 4 \\left( y(t_n) - h y'(t_n) + \\frac{h^2}{2} y''(t_n) - \\frac{h^3}{6} y^{(3)}(t_n) + \\mathcal{O}(h^4) \\right) $$\n$$ + \\left( y(t_n) - 2h y'(t_n) + 2h^2 y''(t_n) - \\frac{4h^3}{3} y^{(3)}(t_n) + \\mathcal{O}(h^4) \\right) $$\n\nLet's collect the terms based on the order of the derivatives of $y(t)$ at $t_n$:\nCoefficient of $y(t_n)$:\n$$ 3 - 4 + 1 = 0 $$\nCoefficient of $y'(t_n)$:\n$$ -4(-h) + (-2h) = 4h - 2h = 2h $$\nCoefficient of $y''(t_n)$:\n$$ -4\\left(\\frac{h^2}{2}\\right) + 2h^2 = -2h^2 + 2h^2 = 0 $$\nCoefficient of $y^{(3)}(t_n)$:\n$$ -4\\left(-\\frac{h^3}{6}\\right) - \\frac{4h^3}{3} = \\frac{4h^3}{6} - \\frac{4h^3}{3} = \\frac{2h^3}{3} - \\frac{4h^3}{3} = -\\frac{2h^3}{3} $$\n\nThe higher-order terms are of order $\\mathcal{O}(h^4)$. Combining these results, the numerator becomes:\n$$ 3 y(t_n) - 4 y(t_{n-1}) + y(t_{n-2}) = (0)y(t_n) + (2h)y'(t_n) + (0)y''(t_n) - \\frac{2h^3}{3}y^{(3)}(t_n) + \\mathcal{O}(h^4) $$\n$$ = 2h y'(t_n) - \\frac{2h^3}{3} y^{(3)}(t_n) + \\mathcal{O}(h^4) $$\n\nNow, we substitute this result back into the formula for $\\tau_n$:\n$$ \\tau_n = \\frac{1}{2h} \\left( 2h y'(t_n) - \\frac{2h^3}{3} y^{(3)}(t_n) + \\mathcal{O}(h^4) \\right) - y'(t_n) $$\nDividing by $2h$, we get:\n$$ \\tau_n = \\left( y'(t_n) - \\frac{h^2}{3} y^{(3)}(t_n) + \\mathcal{O}(h^3) \\right) - y'(t_n) $$\nThe $y'(t_n)$ terms cancel out:\n$$ \\tau_n = - \\frac{h^2}{3} y^{(3)}(t_n) + \\mathcal{O}(h^3) $$\n\nThis explicit expression for $\\tau_n$ shows two things. First, since the leading term is proportional to $h^2$, the local truncation error is of order $2$, i.e., $\\tau_n = \\mathcal{O}(h^2)$. This is consistent with the BDF2 method being a second-order accurate scheme.\n\nSecond, the leading-order term of the normalized local truncation error $\\tau_n$ is given by the first term in the resulting series. This term is the answer requested by the problem.\nThe leading-order term of $\\tau_n$ is:\n$$ - \\frac{h^2}{3} y^{(3)}(t_n) $$",
            "answer": "$$\\boxed{-\\frac{h^2}{3} y^{(3)}(t_n)}$$"
        },
        {
            "introduction": "While accuracy is essential, stability is paramount when solving the stiff systems of equations that commonly arise in Computational Fluid Dynamics. Backward Differentiation Formulas are prized for their excellent stability properties, which allow for much larger time steps than many explicit methods. In this exercise, you will explore the concept of absolute stability by applying BDF2 to the canonical linear test equation, demonstrating why this method is so robust for stiff problems .",
            "id": "3293367",
            "problem": "In computational fluid dynamics, implicit multistep time integrators are widely used to advance semi-discrete systems arising from spatial discretization of conservation laws. Consider the linear test ordinary differential equation (ODE) $y' = \\lambda y$ with complex parameter $\\lambda \\in \\mathbb{C}$, and the second-order Backward Differentiation Formula (BDF) known as the Backward Differentiation Formula of order $2$ (BDF2). The absolute stability of a linear multistep method is defined through its amplification equation: for a fixed non-dimensional step parameter $z = h \\lambda$, where $h > 0$ is the non-dimensional time step, stability requires that all roots $\\xi \\in \\mathbb{C}$ of the characteristic polynomial satisfy $|\\xi|  1$, and the boundary of the region of absolute stability is obtained as $|\\xi| = 1$.\n\nStarting from the linear multistep method form and the defining coefficients of the BDF2 method, derive the amplification equation for the test problem $y' = \\lambda y$ and use the root-locus construction to obtain an explicit parametric expression $z(\\theta)$ for the stability boundary curve in the complex $z$-plane, where $\\theta \\in [0, 2\\pi)$ parameterizes the unit circle $|\\xi| = 1$.\n\nThen, restrict to real negative $\\lambda$ (i.e., $\\lambda \\in \\mathbb{R}$ and $\\lambda  0$) and determine the largest stable non-dimensional time step $h$ for which the BDF2 method is absolutely stable when applied to $y' = \\lambda y$. Express your final answer as:\n- an explicit formula for $z(\\theta)$, and\n- the supremum of stable $h$ for real negative $\\lambda$.\n\nReport both in symbolic form without units. If any numerical rounding were required, it would be specified in terms of significant figures; however, this problem does not require rounding.",
            "solution": "The stability of a linear multistep method (LMM) is analyzed by applying it to the test equation $y'=\\lambda y$. The second-order Backward Differentiation Formula (BDF2) can be written as:\n$$ \\frac{3}{2} y_{n+2} - 2 y_{n+1} + \\frac{1}{2} y_n = h f_{n+2} $$\nBy normalizing the leading coefficient to 1, we can identify the first and second characteristic polynomials of the method, $\\rho(\\xi)$ and $\\sigma(\\xi)$:\n$$ \\rho(\\xi) = \\xi^2 - \\frac{4}{3} \\xi + \\frac{1}{3} $$\n$$ \\sigma(\\xi) = \\frac{2}{3} \\xi^2 $$\nApplying the method to $y'=\\lambda y$ and substituting the ansatz $y_n = \\xi^n$ and the non-dimensional parameter $z = h \\lambda$ yields the characteristic (or amplification) equation $\\rho(\\xi) - z \\sigma(\\xi) = 0$. For BDF2, this is:\n$$ \\left(\\xi^2 - \\frac{4}{3} \\xi + \\frac{1}{3}\\right) - z \\left(\\frac{2}{3} \\xi^2\\right) = 0 $$\nThe region of absolute stability is the set of $z \\in \\mathbb{C}$ for which all roots $\\xi$ of this equation satisfy $|\\xi|  1$. The boundary of this region is the set of $z$ for which there is at least one root with $|\\xi| = 1$.\n\n**Part 1: Derivation of the stability boundary $z(\\theta)$**\n\nTo find the stability boundary, we solve the amplification equation for $z$ and set $|\\xi|=1$:\n$$ z = \\frac{\\rho(\\xi)}{\\sigma(\\xi)} = \\frac{\\xi^2 - \\frac{4}{3} \\xi + \\frac{1}{3}}{\\frac{2}{3} \\xi^2} = \\frac{3}{2} \\left( 1 - \\frac{4}{3\\xi} + \\frac{1}{3\\xi^2} \\right) $$\nThe stability boundary is parameterized by letting $\\xi$ trace the unit circle in the complex plane, i.e., $\\xi = \\exp(i\\theta)$ for $\\theta \\in [0, 2\\pi)$. Substituting this gives the explicit parametric expression:\n$$ z(\\theta) = \\frac{3}{2} \\left( 1 - \\frac{4}{3}\\exp(-i\\theta) + \\frac{1}{3}\\exp(-i2\\theta) \\right) = \\frac{3}{2} - 2\\exp(-i\\theta) + \\frac{1}{2}\\exp(-i2\\theta) $$\nThis is the first part of the answer.\n\n**Part 2: Largest stable step size for real negative $\\lambda$**\n\nFor $\\lambda \\in \\mathbb{R}$ with $\\lambda  0$, the parameter $z = h\\lambda$ is a negative real number. To determine stability, we examine the real part of the stability boundary $z(\\theta)$:\n$$ \\operatorname{Re}(z(\\theta)) = \\frac{3}{2} - 2\\cos(\\theta) + \\frac{1}{2}\\cos(2\\theta) $$\nUsing the identity $\\cos(2\\theta) = 2\\cos^2(\\theta) - 1$, this simplifies to:\n$$ \\operatorname{Re}(z(\\theta)) = \\frac{3}{2} - 2\\cos(\\theta) + \\cos^2(\\theta) - \\frac{1}{2} = (1 - \\cos(\\theta))^2 $$\nSince $\\cos(\\theta) \\in [-1, 1]$, it follows that $(1 - \\cos(\\theta))^2 \\ge 0$. The real part of the stability boundary is non-negative, meaning the boundary lies in the closed right half-plane. To determine if the stability region is the interior or exterior of this boundary, we test a point. For $z \\to \\infty$, the amplification equation approximates to $-\\frac{2}{3}z\\xi^2 \\approx 0$, which gives roots $\\xi=0$. Since $|0|1$, the point at infinity is stable. Therefore, the region of absolute stability is the exterior of the boundary curve.\n\nSince the boundary is contained in the right half-plane, its exterior necessarily contains the entire open left half-plane. This property means BDF2 is A-stable. For any real negative $\\lambda$ and any step size $h > 0$, the parameter $z = h\\lambda$ is a negative real number and thus lies in the region of absolute stability. Therefore, the BDF2 method is absolutely stable for any $h > 0$. The set of stable step sizes is the interval $(0, \\infty)$, and its supremum is infinity.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{3}{2} - 2\\exp(-i\\theta) + \\frac{1}{2}\\exp(-i2\\theta)  \\infty \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "The theoretical order of accuracy of a numerical scheme is only realized if all aspects of the simulation, including boundary conditions, are treated with consistent precision. A common and subtle pitfall is the naive implementation of time-dependent boundary conditions, which can unexpectedly degrade a high-order scheme to first-order accuracy. This practical exercise demonstrates how this order reduction occurs and, more importantly, how to prevent it by designing a consistent, high-order treatment for the boundary data .",
            "id": "3293359",
            "problem": "Consider the one-dimensional heat equation, a canonical model in Computational Fluid Dynamics (CFD), given by $\\partial u/\\partial t = \\nu\\,\\partial^{2} u/\\partial x^{2}$ on the spatial interval $[0,1]$ with time-dependent Dirichlet boundary conditions $u(0,t)=g(t)$ and $u(1,t)=0$. Let the spatial discretization be performed by second-order centered finite differences with $N$ interior nodes, yielding a method-of-lines semi-discrete system $y'(t)=A\\,y(t)+s(t)$, where $A\\in\\mathbb{R}^{N\\times N}$ is the discrete Laplacian multiplied by $\\nu$, and $s(t)$ is a linear function of $g(t)$ capturing the boundary forcing at $x=0$. Assume $g(t)$ is sufficiently smooth, specifically $g \\in C^{k+1}$ on the time interval of interest.\n\nFor time integration, consider a $k$-step Backward Differentiation Formula (BDF) with constant time step $\\Delta t>0$ and time levels $t_{n}=t_{0}+n\\,\\Delta t$. The BDF scheme applied to the semi-discrete system yields an implicit update at $t_{n+1}$ of the form\n$$\n\\sum_{j=0}^{k}\\alpha_{j}\\,y^{n+1-j}=\\Delta t\\,\\left(A\\,y^{n+1}+s^{n+1}\\right),\n$$\nwhere $y^{m}\\approx y(t_{m})$, $s^{m}\\approx s(t_{m})$, and the coefficients $\\alpha_{j}$ correspond to the $k$-step BDF.\n\nIn many implementations, the time-dependent boundary data on the right-hand side is treated inconsistently by setting $s^{n+1}$ using $g^{n}\\equiv g(t_{n})$ instead of $g^{n+1}\\equiv g(t_{n+1})$. Starting from the semi-discrete form $y'(t)=A\\,y(t)+s(t)$ and the definition of the BDF scheme, analyze how such an inconsistent treatment induces order reduction in the global temporal accuracy when $A$ is stiff (as in diffusion). Use Taylor expansions of $g(t)$ around $t_{n}$ to identify the leading-order defect caused by replacing $s^{n+1}$ with $s^{n}$, and argue the resulting effective order of accuracy.\n\nThen, derive a corrective formulation for the boundary data consistent with the order $k$ of the BDF scheme by constructing a polynomial-in-time extrapolation of $g(t)$ of degree $k$ based on the past boundary values at $t_{n},t_{n-1},\\dots,t_{n-k}$. Assume uniform time steps and derive the extrapolation weights from first principles via Lagrange interpolation in the normalized time coordinate. Finally, for the specific case $k=3$, provide the explicit extrapolation formula for the corrected boundary value $g^{n+1}$ expressed solely in terms of $g^{n},g^{n-1},g^{n-2},g^{n-3}$.\n\nYour final answer must be the single closed-form analytic expression giving $g^{n+1}$ in terms of $g^{n},g^{n-1},g^{n-2},g^{n-3}$. No numerical rounding is required, and no physical units are to be included.",
            "solution": "The problem is validated as scientifically grounded, well-posed, and objective. It presents a standard scenario in the numerical analysis of partial differential equations, specifically concerning order reduction in time-stepping schemes due to inconsistent boundary condition implementation. The tasks are clearly defined and solvable using established mathematical techniques.\n\nThe analysis proceeds in three parts as requested: analyzing the order reduction, deriving a general corrective formulation, and providing the explicit correction for the $k=3$ case.\n\n### Analysis of Order Reduction\n\nThe semi-discrete system is given by the ordinary differential equation (ODE):\n$$\ny'(t) = A\\,y(t) + s(t)\n$$\nwhere $y(t) \\in \\mathbb{R}^{N}$ is the vector of nodal values, $A$ is the stiff discrete operator, and $s(t)$ is the source term arising from the time-dependent boundary condition $g(t)$.\n\nA $k$-step Backward Differentiation Formula (BDF) approximates the derivative $y'(t)$ at time $t_{n+1}$ with $k$-th order accuracy. The local truncation error (LTE) of the BDF applied to the derivative term is $\\mathcal{O}(\\Delta t^k)$. The formally correct BDF scheme for the ODE is:\n$$\n\\sum_{j=0}^{k}\\alpha_{j}\\,y^{n+1-j} = \\Delta t\\,\\beta_{0}(A\\,y^{n+1}+s^{n+1})\n$$\nThe problem statement simplifies the right-hand side, effectively absorbing the BDF coefficient $\\beta_0$ into the $\\alpha_j$ coefficients (i.e., setting $\\beta_0 = 1$), which is a common convention. Thus, the scheme is written as:\n$$\n\\sum_{j=0}^{k}\\alpha_{j}\\,y^{n+1-j} = \\Delta t\\,(A\\,y^{n+1}+s^{n+1})\n$$\nThe left-hand side is the BDF approximation of $\\Delta t \\, y'(t_{n+1})$. Substituting the exact solution $y(t_{n+1-j})$ into this expression yields:\n$$\n\\sum_{j=0}^{k}\\alpha_{j}\\,y(t_{n+1-j}) = \\Delta t \\, y'(t_{n+1}) + \\mathcal{O}(\\Delta t^{k+1})\n$$\nUsing the governing ODE, $y'(t_{n+1}) = A\\,y(t_{n+1}) + s(t_{n+1})$, we get:\n$$\n\\sum_{j=0}^{k}\\alpha_{j}\\,y(t_{n+1-j}) = \\Delta t \\, (A\\,y(t_{n+1}) + s(t_{n+1})) + \\mathcal{O}(\\Delta t^{k+1})\n$$\nThe problem states that an inconsistent implementation is used, where the source term $s^{n+1} = s(t_{n+1})$ is replaced by $s^n = s(t_n)$. The implemented scheme is therefore:\n$$\n\\sum_{j=0}^{k}\\alpha_{j}\\,\\tilde{y}^{n+1-j} = \\Delta t\\,(A\\,\\tilde{y}^{n+1}+s^{n})\n$$\nwhere $\\tilde{y}$ denotes the solution of the inconsistent scheme. The local truncation error, $\\tau_{n+1}$, is obtained by substituting the exact solution $y(t)$ into the implemented numerical scheme:\n$$\n\\tau_{n+1} = \\frac{1}{\\Delta t}\\sum_{j=0}^{k}\\alpha_{j}\\,y(t_{n+1-j}) - (A\\,y(t_{n+1})+s(t_{n}))\n$$\nSubstituting the expression for the BDF approximation, we have:\n$$\n\\tau_{n+1} = \\left( A\\,y(t_{n+1}) + s(t_{n+1}) + \\mathcal{O}(\\Delta t^k) \\right) - (A\\,y(t_{n+1})+s(t_n))\n$$\n$$\n\\tau_{n+1} = s(t_{n+1}) - s(t_n) + \\mathcal{O}(\\Delta t^k)\n$$\nAssuming $s(t)$ is sufficiently smooth (a consequence of $g(t) \\in C^{k+1}$), we perform a Taylor expansion of $s(t_{n+1})$ around $t_n$:\n$$\ns(t_{n+1}) = s(t_n) + \\Delta t \\, s'(t_n) + \\mathcal{O}(\\Delta t^2)\n$$\nThe leading-order defect is therefore:\n$$\ns(t_{n+1}) - s(t_n) = \\Delta t \\, s'(t_n) + \\mathcal{O}(\\Delta t^2)\n$$\nThe local truncation error becomes:\n$$\n\\tau_{n+1} = \\Delta t \\, s'(t_n) + \\mathcal{O}(\\Delta t^2) + \\mathcal{O}(\\Delta t^k)\n$$\nFor any BDF method of order $k \\geq 2$, the dominant error term is $\\Delta t \\, s'(t_n)$, which is $\\mathcal{O}(\\Delta t)$. For a stable method, a local truncation error of $\\mathcal{O}(\\Delta t^{p+1})$ typically leads to a global error of $\\mathcal{O}(\\Delta t^p)$. Here, the LTE contains a forcing error of $\\mathcal{O}(\\Delta t)$, which implies the global error will be $\\mathcal{O}(\\Delta t)$. Thus, the global accuracy of the method is reduced to first order, regardless of the formal order $k$ of the BDF scheme.\n\n### Corrective Formulation\n\nTo restore the $k$-th order accuracy of the BDF scheme, the source term $s(t_{n+1})$ must be approximated with an error of at least $\\mathcal{O}(\\Delta t^k)$. Since $s(t)$ is linear in $g(t)$, this requires approximating $g(t_{n+1})$ with an error that does not degrade the overall scheme. An approximation $g^{n+1}_{\\text{approx}}$ such that $g(t_{n+1}) - g^{n+1}_{\\text{approx}} = \\mathcal{O}(\\Delta t^{k+1})$ is sufficient, as this will introduce a term of $\\mathcal{O}(\\Delta t^{k+1})$ into the LTE, which is subdominant to the BDF's intrinsic $\\mathcal{O}(\\Delta t^k)$ error.\n\nWe construct a polynomial $P(t)$ of degree $k$ that interpolates the last $k+1$ known boundary values: $(t_{n-j}, g^{n-j})$ for $j = 0, 1, \\dots, k$. The corrected boundary value is then obtained by extrapolating this polynomial to time $t_{n+1}$:\n$$\ng^{n+1}_{\\text{corr}} = P(t_{n+1})\n$$\nThe error for polynomial interpolation/extrapolation is given by:\n$$\ng(t) - P(t) = \\frac{g^{(k+1)}(\\xi)}{(k+1)!} \\prod_{j=0}^{k} (t - t_{n-j})\n$$\nfor some $\\xi$ in the time interval spanned by the points. Evaluating at $t = t_{n+1}$:\n$$\ng(t_{n+1}) - P(t_{n+1}) = \\frac{g^{(k+1)}(\\xi)}{(k+1)!} \\prod_{j=0}^{k} (t_{n+1} - t_{n-j})\n$$\nWith a constant time step $\\Delta t$, $t_{m} = t_n + (m-n)\\Delta t$. The product becomes:\n$$\n\\prod_{j=0}^{k} ((n+1)\\Delta t - (n-j)\\Delta t) = \\prod_{j=0}^{k} (1+j)\\Delta t = (k+1)! (\\Delta t)^{k+1}\n$$\nThus, the extrapolation error is:\n$$\ng(t_{n+1}) - g^{n+1}_{\\text{corr}} = \\frac{g^{(k+1)}(\\xi)}{(k+1)!} (k+1)! (\\Delta t)^{k+1} = g^{(k+1)}(\\xi) (\\Delta t)^{k+1} = \\mathcal{O}(\\Delta t^{k+1})\n$$\nThis correction is sufficiently accurate to restore the formal order $k$ of the BDF scheme.\n\n### Explicit Formula for k=3\n\nFor $k=3$, we need to find the polynomial of degree $3$ that passes through the points $(t_n, g^n)$, $(t_{n-1}, g^{n-1})$, $(t_{n-2}, g^{n-2})$, and $(t_{n-3}, g^{n-3})$, and evaluate it at $t_{n+1}$. We use Lagrange interpolation. It is convenient to define a normalized time coordinate $\\tau = (t - t_n)/\\Delta t$. The interpolation nodes are $\\tau_j = -j$ for $j=0, 1, 2, 3$. We need to extrapolate to $\\tau=1$.\n\nThe Lagrange basis polynomials $L_j(\\tau)$ are given by $L_j(\\tau) = \\prod_{i=0, i\\neq j}^{3} \\frac{\\tau - \\tau_i}{\\tau_j - \\tau_i}$. The extrapolated value is $g^{n+1} = \\sum_{j=0}^{3} c_j g^{n-j}$, where the coefficients are $c_j = L_j(1)$.\n\nLet's compute the coefficients $c_j$:\nFor $j=0$ (node $\\tau_0=0$):\n$$\nc_0 = L_0(1) = \\frac{1-(-1)}{0-(-1)} \\cdot \\frac{1-(-2)}{0-(-2)} \\cdot \\frac{1-(-3)}{0-(-3)} = \\frac{2}{1} \\cdot \\frac{3}{2} \\cdot \\frac{4}{3} = 4\n$$\nFor $j=1$ (node $\\tau_1=-1$):\n$$\nc_1 = L_1(1) = \\frac{1-0}{-1-0} \\cdot \\frac{1-(-2)}{-1-(-2)} \\cdot \\frac{1-(-3)}{-1-(-3)} = \\frac{1}{-1} \\cdot \\frac{3}{1} \\cdot \\frac{4}{2} = -6\n$$\nFor $j=2$ (node $\\tau_2=-2$):\n$$\nc_2 = L_2(1) = \\frac{1-0}{-2-0} \\cdot \\frac{1-(-1)}{-2-(-1)} \\cdot \\frac{1-(-3)}{-2-(-3)} = \\frac{1}{-2} \\cdot \\frac{2}{-1} \\cdot \\frac{4}{1} = 4\n$$\nFor $j=3$ (node $\\tau_3=-3$):\n$$\nc_3 = L_3(1) = \\frac{1-0}{-3-0} \\cdot \\frac{1-(-1)}{-3-(-1)} \\cdot \\frac{1-(-2)}{-3-(-2)} = \\frac{1}{-3} \\cdot \\frac{2}{-2} \\cdot \\frac{3}{-1} = -1\n$$\nCombining these coefficients, the explicit extrapolation formula for the corrected boundary value $g^{n+1}$ is:\n$$\ng^{n+1} = c_0 g^n + c_1 g^{n-1} + c_2 g^{n-2} + c_3 g^{n-3} = 4g^n - 6g^{n-1} + 4g^{n-2} - g^{n-3}\n$$\nThis expression provides the necessary $\\mathcal{O}(\\Delta t^4)$-accurate estimate for $g(t_{n+1})$ to be used in a third-order BDF scheme, thus restoring the method's intended accuracy.",
            "answer": "$$\n\\boxed{4g^{n} - 6g^{n-1} + 4g^{n-2} - g^{n-3}}\n$$"
        }
    ]
}