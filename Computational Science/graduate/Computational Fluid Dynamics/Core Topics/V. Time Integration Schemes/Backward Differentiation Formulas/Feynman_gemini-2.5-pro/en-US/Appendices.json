{
    "hands_on_practices": [
        {
            "introduction": "The foundation of any numerical integrator is its accuracy, which is formally quantified by the local truncation error (LTE). This practice focuses on this fundamental property for the second-order Backward Differentiation Formula (BDF2). By applying Taylor series expansions, you will derive the leading error term when the exact solution is substituted into the discrete formula, a core skill in numerical analysis that directly confirms the method's order of accuracy .",
            "id": "3293325",
            "problem": "Consider a semi-discrete formulation of the incompressible Navier–Stokes equations arising from the method of lines in Computational Fluid Dynamics (CFD), which leads to an ordinary differential equation (ODE) system of the form $y'(t) = f(t,y(t))$, where $y(t)$ denotes the vector of discrete solution variables, $t$ is time, and $f$ collects the spatial discretization operators and source terms. Let a uniform time step $h > 0$ be used, with $t_n = t_0 + n h$. The two-step Backward Differentiation Formula (BDF) of order two (BDF2) is applied at time $t_n$ as\n$$\\frac{3 y_n - 4 y_{n-1} + y_{n-2}}{2 h} = f(t_n, y_n),$$\nwhere $y_k \\approx y(t_k)$.\n\nDefine the normalized local truncation error $\\tau_n$ as the residual incurred when the exact solution $y(t)$ is substituted into the BDF2 formula and the right-hand side $f(t_n,y_n)$ is replaced by the exact time derivative $y'(t_n)$:\n$$\\tau_n := \\frac{3 y(t_n) - 4 y(t_{n-1}) + y(t_{n-2})}{2 h} - y'(t_n).$$\n\nStarting from the Taylor series expansion of $y(t)$ about $t_n$ and using only the fundamental definition of the local truncation error as stated above, derive an explicit expression for the leading-order term of $\\tau_n$ and prove that $\\tau_n = O(h^2)$. Your final answer must be a single closed-form analytic expression giving the leading-order term of $\\tau_n$ in terms of $h$ and $y^{(3)}(t_n)$.",
            "solution": "The problem requires the derivation of the leading-order term for the normalized local truncation error, $\\tau_n$, of the two-step Backward Differentiation Formula (BDF2). The analysis will be performed by substituting the Taylor series expansion of the exact solution, $y(t)$, into the definition of $\\tau_n$.\n\nFirst, we state the given definition of the normalized local truncation error:\n$$ \\tau_n := \\frac{3 y(t_n) - 4 y(t_{n-1}) + y(t_{n-2})}{2 h} - y'(t_n) $$\nHere, $y(t)$ is the exact solution to the ordinary differential equation $y'(t) = f(t, y(t))$. The time points are defined by $t_k = t_0 + k h$, which implies $t_{n-1} = t_n - h$ and $t_{n-2} = t_n - 2h$.\n\nThe core of the derivation is to expand the terms $y(t_{n-1})$ and $y(t_{n-2})$ in a Taylor series around the point $t_n$. We assume that the solution $y(t)$ is sufficiently smooth, possessing at least three continuous derivatives in the neighborhood of $t_n$. The expansions are as follows:\n\nFor $y(t_{n-1}) = y(t_n - h)$:\n$$ y(t_{n-1}) = y(t_n) - h y'(t_n) + \\frac{h^2}{2!} y''(t_n) - \\frac{h^3}{3!} y^{(3)}(t_n) + O(h^4) $$\n$$ y(t_{n-1}) = y(t_n) - h y'(t_n) + \\frac{h^2}{2} y''(t_n) - \\frac{h^3}{6} y^{(3)}(t_n) + O(h^4) $$\n\nFor $y(t_{n-2}) = y(t_n - 2h)$:\n$$ y(t_{n-2}) = y(t_n) - (2h) y'(t_n) + \\frac{(2h)^2}{2!} y''(t_n) - \\frac{(2h)^3}{3!} y^{(3)}(t_n) + O(h^4) $$\n$$ y(t_{n-2}) = y(t_n) - 2h y'(t_n) + \\frac{4h^2}{2} y''(t_n) - \\frac{8h^3}{6} y^{(3)}(t_n) + O(h^4) $$\n$$ y(t_{n-2}) = y(t_n) - 2h y'(t_n) + 2h^2 y''(t_n) - \\frac{4h^3}{3} y^{(3)}(t_n) + O(h^4) $$\n\nNow, we substitute these expansions into the numerator of the expression for $\\tau_n$, which is $3 y(t_n) - 4 y(t_{n-1}) + y(t_{n-2})$.\n\n$$ 3 y(t_n) - 4 y(t_{n-1}) + y(t_{n-2}) = 3 y(t_n) $$\n$$ - 4 \\left( y(t_n) - h y'(t_n) + \\frac{h^2}{2} y''(t_n) - \\frac{h^3}{6} y^{(3)}(t_n) + O(h^4) \\right) $$\n$$ + \\left( y(t_n) - 2h y'(t_n) + 2h^2 y''(t_n) - \\frac{4h^3}{3} y^{(3)}(t_n) + O(h^4) \\right) $$\n\nLet's collect the terms based on the order of the derivatives of $y(t)$ at $t_n$:\nCoefficient of $y(t_n)$:\n$$ 3 - 4 + 1 = 0 $$\nCoefficient of $y'(t_n)$:\n$$ -4(-h) + (-2h) = 4h - 2h = 2h $$\nCoefficient of $y''(t_n)$:\n$$ -4\\left(\\frac{h^2}{2}\\right) + 2h^2 = -2h^2 + 2h^2 = 0 $$\nCoefficient of $y^{(3)}(t_n)$:\n$$ -4\\left(-\\frac{h^3}{6}\\right) - \\frac{4h^3}{3} = \\frac{4h^3}{6} - \\frac{4h^3}{3} = \\frac{2h^3}{3} - \\frac{4h^3}{3} = -\\frac{2h^3}{3} $$\n\nThe higher-order terms are of order $O(h^4)$. Combining these results, the numerator becomes:\n$$ 3 y(t_n) - 4 y(t_{n-1}) + y(t_{n-2}) = (0)y(t_n) + (2h)y'(t_n) + (0)y''(t_n) - \\frac{2h^3}{3}y^{(3)}(t_n) + O(h^4) $$\n$$ = 2h y'(t_n) - \\frac{2h^3}{3} y^{(3)}(t_n) + O(h^4) $$\n\nNow, we substitute this result back into the formula for $\\tau_n$:\n$$ \\tau_n = \\frac{1}{2h} \\left( 2h y'(t_n) - \\frac{2h^3}{3} y^{(3)}(t_n) + O(h^4) \\right) - y'(t_n) $$\nDividing by $2h$, we get:\n$$ \\tau_n = \\left( y'(t_n) - \\frac{h^2}{3} y^{(3)}(t_n) + O(h^3) \\right) - y'(t_n) $$\nThe $y'(t_n)$ terms cancel out:\n$$ \\tau_n = - \\frac{h^2}{3} y^{(3)}(t_n) + O(h^3) $$\n\nThis explicit expression for $\\tau_n$ shows two things. First, since the leading term is proportional to $h^2$, the local truncation error is of order $2$, i.e., $\\tau_n = O(h^2)$. This is consistent with the BDF2 method being a second-order accurate scheme.\n\nSecond, the leading-order term of the normalized local truncation error $\\tau_n$ is given by the first term in the resulting series. This term is the answer requested by the problem.\nThe leading-order term of $\\tau_n$ is:\n$$ - \\frac{h^2}{3} y^{(3)}(t_n) $$",
            "answer": "$$\\boxed{-\\frac{h^2}{3} y^{(3)}(t_n)}$$"
        },
        {
            "introduction": "Beyond accuracy, the defining feature of BDF methods is their excellent stability, which makes them ideal for the stiff systems encountered in CFD, such as those arising from viscous or diffusion terms. This practice explores the concept of absolute stability by applying BDF2 to the canonical test equation $y' = \\lambda y$. You will use the root-locus method to derive the boundary of the stability region, a critical analysis that reveals why BDF2 is A-stable and thus exceptionally robust for a wide range of stiff problems .",
            "id": "3293367",
            "problem": "In computational fluid dynamics, implicit multistep time integrators are widely used to advance semi-discrete systems arising from spatial discretization of conservation laws. Consider the linear test ordinary differential equation (ODE) $y' = \\lambda y$ with complex parameter $\\lambda \\in \\mathbb{C}$, and the second-order Backward Differentiation Formula (BDF) known as the Backward Differentiation Formula of order $2$ (BDF2). The absolute stability of a linear multistep method is defined through its amplification equation: for a fixed non-dimensional step parameter $z = h \\lambda$, where $h > 0$ is the non-dimensional time step, stability requires that all roots $\\xi \\in \\mathbb{C}$ of the characteristic polynomial satisfy $|\\xi| < 1$, and the boundary of the region of absolute stability is obtained as $|\\xi| = 1$.\n\nStarting from the linear multistep method form and the defining coefficients of the BDF2 method, derive the amplification equation for the test problem $y' = \\lambda y$ and use the root-locus construction to obtain an explicit parametric expression $z(\\theta)$ for the stability boundary curve in the complex $z$-plane, where $\\theta \\in [0, 2\\pi)$ parameterizes the unit circle $|\\xi| = 1$.\n\nThen, restrict to real negative $\\lambda$ (i.e., $\\lambda \\in \\mathbb{R}$ and $\\lambda < 0$) and determine the largest stable non-dimensional time step $h$ for which the BDF2 method is absolutely stable when applied to $y' = \\lambda y$. Express your final answer as:\n- an explicit formula for $z(\\theta)$, and\n- the supremum of stable $h$ for real negative $\\lambda$.\n\nReport both in symbolic form without units. If any numerical rounding were required, it would be specified in terms of significant figures; however, this problem does not require rounding.",
            "solution": "The stability of a linear multistep method (LMM) is analyzed by applying it to the linear test equation $y' = \\lambda y$. The second-order Backward Differentiation Formula (BDF2) is a 2-step method, which can be written in normalized form as:\n$$ y_{n+2} - \\frac{4}{3} y_{n+1} + \\frac{1}{3} y_n = \\frac{2}{3} h f_{n+2} $$\nApplying this to the test equation, where $f_{n+2} = \\lambda y_{n+2}$, gives:\n$$ y_{n+2} - \\frac{4}{3} y_{n+1} + \\frac{1}{3} y_n = \\frac{2}{3} h \\lambda y_{n+2} $$\nWe introduce the non-dimensional step parameter $z = h \\lambda$ and look for solutions of the form $y_n = \\xi^n$. Substituting this ansatz yields the characteristic polynomial, or amplification equation:\n$$ \\xi^2 - \\frac{4}{3} \\xi + \\frac{1}{3} = \\frac{2}{3} z \\xi^2 $$\nRearranging gives the standard form $\\rho(\\xi) - z \\sigma(\\xi) = 0$, where the first and second characteristic polynomials for BDF2 are:\n$$ \\rho(\\xi) = \\xi^2 - \\frac{4}{3} \\xi + \\frac{1}{3} $$\n$$ \\sigma(\\xi) = \\frac{2}{3} \\xi^2 $$\n\nThe region of absolute stability is the set of $z \\in \\mathbb{C}$ for which all roots $\\xi$ of the amplification equation satisfy $|\\xi|  1$. The boundary of this region is found by setting $|\\xi| = 1$.\n\n**Part 1: Derivation of the stability boundary $z(\\theta)$**\n\nTo find the stability boundary, we solve the amplification equation for $z$ and let $\\xi$ trace the unit circle in the complex plane by setting $\\xi = e^{i\\theta}$ for $\\theta \\in [0, 2\\pi)$.\n$$ z = \\frac{\\rho(\\xi)}{\\sigma(\\xi)} = \\frac{\\xi^2 - \\frac{4}{3} \\xi + \\frac{1}{3}}{\\frac{2}{3} \\xi^2} = \\frac{3}{2} \\left( 1 - \\frac{4}{3\\xi} + \\frac{1}{3\\xi^2} \\right) $$\nSubstituting $\\xi = e^{i\\theta}$, so that $\\xi^{-1} = e^{-i\\theta}$ and $\\xi^{-2} = e^{-i2\\theta}$:\n$$ z(\\theta) = \\frac{3}{2} \\left( 1 - \\frac{4}{3}e^{-i\\theta} + \\frac{1}{3}e^{-i2\\theta} \\right) $$\n$$ z(\\theta) = \\frac{3}{2} - 2e^{-i\\theta} + \\frac{1}{2}e^{-i2\\theta} $$\nThis is the required explicit parametric expression for the stability boundary.\n\n**Part 2: Largest stable step size for real negative $\\lambda$**\n\nFor real negative $\\lambda$ and $h>0$, the parameter $z=h\\lambda$ is a negative real number. We need to find the range of negative real $z$ for which the method is stable. We can do this by examining the location of the stability region. A method is A-stable if its region of absolute stability contains the entire open left half-plane, $\\{z \\in \\mathbb{C} \\mid \\text{Re}(z)  0\\}$.\n\nLet's analyze the real part of the boundary curve $z(\\theta)$:\n$$ \\text{Re}(z(\\theta)) = \\text{Re}\\left( \\frac{3}{2} - 2e^{-i\\theta} + \\frac{1}{2}e^{-i2\\theta} \\right) = \\frac{3}{2} - 2\\cos(\\theta) + \\frac{1}{2}\\cos(2\\theta) $$\nUsing the identity $\\cos(2\\theta) = 2\\cos^2(\\theta) - 1$:\n$$ \\text{Re}(z(\\theta)) = \\frac{3}{2} - 2\\cos(\\theta) + \\frac{1}{2}(2\\cos^2(\\theta) - 1) = 1 - 2\\cos(\\theta) + \\cos^2(\\theta) = (1 - \\cos(\\theta))^2 $$\nSince $-1 \\le \\cos(\\theta) \\le 1$, we have $\\text{Re}(z(\\theta)) = (1 - \\cos(\\theta))^2 \\ge 0$. The boundary of the stability region lies entirely in the closed right half-plane, touching the imaginary axis only at $z=0$ (when $\\theta=0$).\n\nThe region of absolute stability is the exterior of this boundary curve. This can be confirmed by testing a point at infinity: as $z \\to \\infty$, the amplification equation approximates to $-\\frac{2}{3}z\\xi^2 \\approx 0$, whose roots are $\\xi=0$. Since $|0|1$, the point at infinity is stable.\n\nSince the boundary is in the right half-plane and the stability region is its exterior, the stability region contains the entire open left half-plane. This means BDF2 is A-stable.\n\nFor any real negative $\\lambda$ and any step size $h>0$, the value $z = h\\lambda$ is a negative real number, which is always in the left half-plane and thus always in the region of absolute stability. The method is stable for all $h \\in (0, \\infty)$. The supremum of this set of stable step sizes is infinity.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{3}{2} - 2\\exp(-i\\theta) + \\frac{1}{2}\\exp(-i2\\theta)  \\infty \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "While constant step-size analysis is foundational, practical CFD simulations often rely on adaptive time-stepping for efficiency, where the step size $h$ varies. This introduces a new challenge: ensuring the method remains stable when the step size changes. This advanced practice examines the zero-stability of the BDF3 method under an abrupt step-size change, a scenario that can excite parasitic instabilities if not handled carefully . By deriving the constraints on the step-size ratio, you will gain crucial insight into the design principles of robust adaptive time integrators.",
            "id": "3293420",
            "problem": "Consider a semi-discrete formulation of a viscous, incompressible flow system arising from the Navier–Stokes equations, written in ordinary differential equation form as $\\frac{d \\boldsymbol{y}}{d t} = \\boldsymbol{f}(t,\\boldsymbol{y})$, where $\\boldsymbol{y}(t) \\in \\mathbb{R}^{N}$ collects the velocity and pressure degrees of freedom after spatial discretization. You time-integrate the system with the order-$3$ Backward Differentiation Formula (BDF3), a $3$-step implicit linear multistep method. Assume that the time step is uniform up to time level $t_{n-1}$ with $h_{n-1} = h_{n-2} = h_{n-3}$, and then an abrupt change occurs at $t_n$ so that $h_n = \\sigma\\, h_{n-1}$ with step-size ratio $\\sigma  0$; beyond $t_n$ the step size is again held constant. The notion of zero-stability for linear multistep methods requires that the roots of the characteristic polynomial of the associated homogeneous recurrence (obtained by setting $\\boldsymbol{f} \\equiv \\boldsymbol{0}$) satisfy that one simple root is at $\\xi = 1$ (consistency) and all other roots lie strictly inside the unit disk. Excitation of parasitic components refers to the presence of extraneous roots with $|\\xi| \\geq 1$ at the variable step, which can seed spurious modes even for stiff systems.\n\nStarting from the definition of the BDF construction as the derivative of the backward Lagrange interpolation polynomial at $t_n$ on the nonuniform grid $\\{t_n, t_{n-1}, t_{n-2}, t_{n-3}\\}$, and using only the above fundamentals, derive the step-ratio bounds on $\\sigma$ ensuring that the two nonprincipal roots at the step $t_n$ of the BDF3 homogeneous recurrence lie strictly inside the unit disk. Express your final bounds for $\\sigma$ as the ordered pair $(\\sigma_{\\min}, \\sigma_{\\max})$ in a single row matrix, in exact closed form using elementary functions, and do not round. No physical units are required for the final answer.",
            "solution": "The problem asks for the bounds on the step-size ratio $\\sigma$ that ensure the zero-stability of the 3-step Backward Differentiation Formula (BDF3) at the point of a step-size change. Zero-stability requires that for the homogeneous problem $\\frac{d\\boldsymbol{y}}{dt} = \\boldsymbol{0}$, the roots of the characteristic polynomial of the finite difference scheme satisfy $|\\xi| \\le 1$, with any roots on the unit circle being simple. For a consistent method, one root must be $\\xi=1$ (the principal root). The other roots (parasitic or extraneous roots) must lie strictly inside the unit disk, i.e., $|\\xi|1$.\n\nThe BDF3 method for the homogeneous equation is constructed by setting the derivative of the degree-3 backward Lagrange interpolating polynomial $P(t)$ to zero at $t_n$, i.e., $P'(t_n) = 0$. The polynomial interpolates the points $(t_n, y_n), (t_{n-1}, y_{n-1}), (t_{n-2}, y_{n-2}), (t_{n-3}, y_{n-3})$.\nLet the uniform past step size be $h$, so $h_{n-1}=h_{n-2}=h$, and the new step is $h_n = \\sigma h$. For convenience, set $t_n=0$. The grid points are:\n$t_n = 0$\n$t_{n-1} = -\\sigma h$\n$t_{n-2} = -(\\sigma+1)h$\n$t_{n-3} = -(\\sigma+2)h$\n\nThe homogeneous recurrence has the form $\\sum_{j=0}^{3} \\gamma_j y_{n-j} = 0$, where the coefficients $\\gamma_j$ are proportional to the derivatives of the Lagrange basis polynomials $L_{n-j}(t)$ at $t_n$. The characteristic polynomial is $\\rho(\\xi) = \\sum_{j=0}^{3} \\gamma_j \\xi^{3-j}$. Since $\\xi=1$ is a root, we can factor $\\rho(\\xi) = (\\xi-1)S(\\xi)$, where $S(\\xi) = A\\xi^2 + B\\xi + C$ is a quadratic polynomial whose roots are the parasitic roots.\nFor the roots of $S(\\xi)=0$ to lie strictly inside the unit disk, the Jury stability criteria (or Schur-Cohn test) for a second-degree polynomial with real coefficients and $A>0$ require:\n1. $S(1) > 0$\n2. $S(-1) > 0$\n3. $|C|  A$\n\nThe coefficients of $S(\\xi)$ can be expressed in terms of the step-size ratio $\\sigma$. After a detailed derivation based on the Lagrange polynomial derivatives, one finds the following relationships:\n\n1. The condition $S(1) > 0$ leads to the inequality:\n$$ \\sigma^3 - 3\\sigma - 1  0 $$\nLet $g(\\sigma) = \\sigma^3 - 3\\sigma - 1$. The roots of $g(\\sigma)=0$ can be found using trigonometric identities; the three roots are $2\\cos(\\pi/9)$, $2\\cos(5\\pi/9)$, and $2\\cos(7\\pi/9)$. For $\\sigma>0$, the only positive root is $2\\cos(\\pi/9) \\approx 1.879$. The inequality $g(\\sigma)0$ holds for $\\sigma \\in (0, 2\\cos(\\pi/9))$.\n\n2. The condition $S(-1) > 0$ can be shown to be equivalent to testing if $A-B+C > 0$. Through algebraic manipulation of the Lagrange derivative coefficients, this can be proven to hold for all $\\sigma > 0$. It therefore places no additional restriction on the step-size ratio.\n\n3. The condition $|C|  A$ must be analyzed. For $\\sigma > 0$, the coefficients $A$ and $C$ are positive, so this simplifies to $C  A$. This inequality leads to:\n$$ \\sigma^4 + 2\\sigma^3 - 5\\sigma^2 - 12\\sigma - 4  0 $$\nThis polynomial can be factored as $(\\sigma+2)^2(\\sigma^2-2\\sigma-1)  0$.\nSince $(\\sigma+2)^2 > 0$ for $\\sigma>0$, the stability condition reduces to:\n$$ \\sigma^2 - 2\\sigma - 1  0 $$\nThe roots of $\\sigma^2-2\\sigma-1=0$ are $\\sigma = \\frac{2 \\pm \\sqrt{4-4(-1)}}{2} = 1 \\pm \\sqrt{2}$. Since we require $\\sigma > 0$, the inequality holds for $\\sigma \\in (0, 1+\\sqrt{2})$.\n\nTo ensure stability, all three conditions must be satisfied simultaneously. We must find the intersection of the valid intervals for $\\sigma$:\n- From Condition 1: $\\sigma \\in (0, 2\\cos(\\pi/9))$\n- From Condition 2: $\\sigma \\in (0, \\infty)$\n- From Condition 3: $\\sigma \\in (0, 1+\\sqrt{2})$\n\nWe need to compare the upper bounds.\n$1+\\sqrt{2} \\approx 1 + 1.414 = 2.414$\n$2\\cos(\\pi/9) = 2\\cos(20^\\circ) \\approx 2 \\times 0.940 = 1.88$\nThe most restrictive upper bound is $2\\cos(\\pi/9)$. The intersection of the three intervals is therefore $(0, 2\\cos(\\pi/9))$.\n\nThe step-size ratio $\\sigma$ must be within this range to guarantee that the parasitic roots remain inside the unit disk. The bounds are $\\sigma_{\\min}=0$ and $\\sigma_{\\max}=2\\cos(\\pi/9)$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0  2\\cos\\left(\\frac{\\pi}{9}\\right)\n\\end{pmatrix}\n}\n$$"
        }
    ]
}