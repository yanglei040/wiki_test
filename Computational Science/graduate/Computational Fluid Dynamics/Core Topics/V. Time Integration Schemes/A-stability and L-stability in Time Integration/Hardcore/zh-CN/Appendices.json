{
    "hands_on_practices": [
        {
            "introduction": "要分析任何时间积分格式，第一步都是推导其稳定性函数 $R(z)$。这项练习将从后向欧拉法开始，它是刚性积分方法的基石，我们还会将其应用于扩散方程——这是计算流体动力学（CFD）中一个常见的刚性来源。通过这项实践，你将掌握将一个方法的定义与其稳定性特性联系起来的基础分析技能 。",
            "id": "3287261",
            "problem": "考虑周期性区域上的一维热方程 $u_{t}=\\nu u_{xx}$，该方程在空间上使用间距为 $\\Delta x0$ 的均匀网格上的二阶中心有限差分进行离散。这产生了一个半离散线性系统 $\\frac{d\\mathbf{u}}{dt}=\\mathbf{A}\\mathbf{u}$，其中 $\\mathbf{A}$ 是离散扩散算子。对于该算子，控制最快衰减傅里叶模态的模最大（负得最少）的特征值可以很好地近似为 $\\lambda_{\\max}\\approx -\\frac{4\\nu}{\\Delta x^{2}}$。令 $h0$ 表示时间步长。\n\n选择单级对角隐式龙格-库塔 (SDIRK) 格式（后向欧拉法），该方法是 L-稳定的，其布赫表定义为 $c=[1]$, $A=[1]$, 和 $b=[1]$。对于由标量测试方程 $y'(t)=\\lambda\\,y(t)$ 控制的单个本征模，该方法的单步更新可以写成 $y_{n+1}=R(h\\lambda)\\,y_{n}$ 的形式，其中 $R$ 是放大因子（稳定性函数）。\n\n从后向欧拉法的定义和单个本征模的半离散线性演化出发，推导当 $z=h\\lambda$ 时的放大因子 $R(z)$，然后在扩散极端情况 $z=h\\lambda_{\\max}$ (其中 $\\lambda_{\\max}\\approx -\\frac{4\\nu}{\\Delta x^{2}}$) 处计算其值。请以 $h$、$\\nu$ 和 $\\Delta x$ 的单一简化解析表达式形式提供您的最终结果。不要包含单位，也不要四舍五入。",
            "solution": "该问题要求推导后向欧拉法的放大因子，并针对与一维热方程相关的特定情况进行求值。该过程包含两个主要步骤：首先，推导稳定性函数 $R(z)$；其次，将给定的 $z$ 值代入此函数。\n\n后向欧拉法是一种单级对角隐式龙格-库塔 (SDIRK) 方法。对于形如 $\\frac{dy}{dt} = f(t,y)$ 的一般初值问题，从时间步 $n$ 到 $n+1$ 的更新由下式给出：\n$$y_{n+1} = y_n + h f(t_{n+1}, y_{n+1})$$\n其中 $h$ 是时间步长。\n\n问题指定将此方法应用于标量线性测试方程：\n$$\\frac{dy}{dt} = \\lambda y$$\n对于该方程，函数 $f$ 为 $f(t,y) = \\lambda y$。将此代入后向欧拉公式，得到：\n$$y_{n+1} = y_n + h (\\lambda y_{n+1})$$\n\n放大因子（或稳定性函数）$R(z)$ 由关系式 $y_{n+1} = R(z) y_n$ 定义，其中 $z = h\\lambda$。为了求得 $R(z)$，我们必须求解更新方程，用 $y_n$ 来表示 $y_{n+1}$。\n重新整理方程，将含有 $y_{n+1}$ 的项组合在一起：\n$$y_{n+1} - h\\lambda y_{n+1} = y_n$$\n从左侧提取公因子 $y_{n+1}$：\n$$y_{n+1} (1 - h\\lambda) = y_n$$\n两边同时除以 $y_n$ 和 $(1-h\\lambda)$，得到比率 $\\frac{y_{n+1}}{y_n}$：\n$$\\frac{y_{n+1}}{y_n} = \\frac{1}{1 - h\\lambda}$$\n根据定义，这个比率就是放大因子 $R(z)$。代入 $z = h\\lambda$，我们得到：\n$$R(z) = \\frac{1}{1 - z}$$\n推导的第一部分到此完成。\n\n接下来，我们必须为给定的特定情况计算这个放大因子。问题涉及半离散化的热方程 $u_t = \\nu u_{xx}$，其中空间离散算子的模最大特征值近似为：\n$$\\lambda_{\\max} \\approx -\\frac{4\\nu}{\\Delta x^{2}}$$\n该特征值对应于最快衰减的模态，并对显式方法施加最严格的稳定性约束。稳定性函数的自变量 $z$ 为 $z = h\\lambda$。对于这个特定的模态，我们有：\n$$z = h \\lambda_{\\max} \\approx h \\left( -\\frac{4\\nu}{\\Delta x^{2}} \\right) = -\\frac{4h\\nu}{\\Delta x^{2}}$$\n现在，我们将这个关于 $z$ 的特定表达式代入推导出的稳定性函数 $R(z)$ 中：\n$$R\\left(-\\frac{4h\\nu}{\\Delta x^{2}}\\right) = \\frac{1}{1 - \\left(-\\frac{4h\\nu}{\\Delta x^{2}}\\right)}$$\n化简分母：\n$$R = \\frac{1}{1 + \\frac{4h\\nu}{\\Delta x^{2}}}$$\n为了得到一个简化的单分数，我们对主分数的分母中的表达式进行通分：\n$$1 + \\frac{4h\\nu}{\\Delta x^{2}} = \\frac{\\Delta x^{2}}{\\Delta x^{2}} + \\frac{4h\\nu}{\\Delta x^{2}} = \\frac{\\Delta x^{2} + 4h\\nu}{\\Delta x^{2}}$$\n将此代回 $R$ 的表达式中：\n$$R = \\frac{1}{\\frac{\\Delta x^{2} + 4h\\nu}{\\Delta x^{2}}}$$\n最后，将分母取倒数，得到简化的解析表达式：\n$$R = \\frac{\\Delta x^{2}}{\\Delta x^{2} + 4h\\nu}$$\n这就是最终结果，用给定的参数 $h$、$\\nu$ 和 $\\Delta x$ 表示。",
            "answer": "$$\\boxed{\\frac{\\Delta x^{2}}{\\Delta x^{2} + 4h\\nu}}$$"
        },
        {
            "introduction": "并非所有适用于刚性问题的隐式方法都表现出相同的行为。本练习将探讨二阶高斯-勒让德方法，这是一种高阶的 A-稳定格式。通过计算其稳定性函数并检验其在极端刚性模式下（即当 $\\operatorname{Re}(z) \\to -\\infty$ 时）的行为，你将揭示 A-稳定性与更严格的 L-稳定性要求之间的关键区别 。",
            "id": "3287265",
            "problem": "在计算流体力学 (CFD) 中，时间积分格式的性能通过其应用于线性检验方程时的稳定性来评估。考虑一个四阶二步高斯-勒让德配置法，这是一种由以下 Butcher 系数指定的二步隐式龙格-库塔 (RK) 方法\n$$\nA=\\begin{pmatrix}\n\\frac{1}{4}  \\frac{1}{4}-\\frac{\\sqrt{3}}{6} \\\\\n\\frac{1}{4}+\\frac{\\sqrt{3}}{6}  \\frac{1}{4}\n\\end{pmatrix},\\quad\nb=\\begin{pmatrix}\\frac{1}{2} \\\\ \\frac{1}{2}\\end{pmatrix},\\quad\nc=\\begin{pmatrix}\n\\frac{1}{2}-\\frac{\\sqrt{3}}{6} \\\\\n\\frac{1}{2}+\\frac{\\sqrt{3}}{6}\n\\end{pmatrix}.\n$$\n为进行稳定性分析，将此方法应用于线性检验方程，\n$$\n\\frac{\\mathrm{d}y}{\\mathrm{d}t}=\\lambda\\,y,\n$$\n其中时间步长为 $h$，并定义无量纲参数 $z=h\\,\\lambda$。从龙格-库塔分步方程和更新公式出发，推导由 $y_{n+1}=R(z)\\,y_n$ 定义的标量放大因子 $R(z)$。然后，仅使用解析函数的基本性质和多项式零点位置，证明该方法是 $A$-稳定的，即其稳定域包含整个闭合左半平面 $\\{z\\in\\mathbb{C}:\\operatorname{Re}(z)\\le 0\\}$。最后，计算 $\\lim_{|z|\\to\\infty}R(z)$ 并推断该方法是否是 $L$-稳定的，其中 $L$-稳定性要求在 $A$-稳定的基础上还需满足 $\\lim_{\\operatorname{Re}(z)\\to -\\infty}R(z)=0$。请给出 $R(z)$ 的简化闭式有理表达式作为最终答案。无需进行数值四舍五入，且不涉及物理单位。",
            "solution": "该问题陈述经评估有效。其科学依据充分、提法恰当且客观，为进行唯一且可验证的求解提供了所有必要信息。\n\n将二步隐式龙格-库塔方法应用于线性检验方程 $\\frac{\\mathrm{d}y}{\\mathrm{d}t} = \\lambda y$。分步方程和最终更新步骤由下式给出：\n$$\nY_i = y_n + h \\sum_{j=1}^{2} a_{ij} f(t_n+c_j h, Y_j) = y_n + h\\lambda \\sum_{j=1}^{2} a_{ij} Y_j, \\quad \\text{for } i=1, 2.\n$$\n$$\ny_{n+1} = y_n + h \\sum_{i=1}^{2} b_i f(t_n+c_i h, Y_i) = y_n + h\\lambda \\sum_{i=1}^{2} b_i Y_i.\n$$\n令 $z = h\\lambda$。分步方程构成了一个关于分步值 $Y_1$ 和 $Y_2$ 的线性系统：\n$$\nY_1 = y_n + z(a_{11}Y_1 + a_{12}Y_2)\n$$\n$$\nY_2 = y_n + z(a_{21}Y_1 + a_{22}Y_2)\n$$\n写成矩阵形式，其中 $\\mathbf{Y} = \\begin{pmatrix} Y_1 \\\\ Y_2 \\end{pmatrix}$ 且 $\\mathbf{1} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$，为：\n$$\n\\mathbf{Y} = y_n \\mathbf{1} + zA\\mathbf{Y}\n$$\n其中 $A$ 是 Butcher 系数矩阵。整理各项，我们得到：\n$$\n(I - zA)\\mathbf{Y} = y_n \\mathbf{1}\n$$\n求解 $\\mathbf{Y}$ 得：\n$$\n\\mathbf{Y} = y_n (I - zA)^{-1} \\mathbf{1}\n$$\n关于 $z$ 和 $\\mathbf{Y}$ 的 $y_{n+1}$ 更新公式为：\n$$\ny_{n+1} = y_n + z \\mathbf{b}^T \\mathbf{Y}\n$$\n其中 $\\mathbf{b}^T = \\begin{pmatrix} b_1  b_2 \\end{pmatrix}$。代入 $\\mathbf{Y}$ 的表达式：\n$$\ny_{n+1} = y_n + z \\mathbf{b}^T (y_n (I - zA)^{-1} \\mathbf{1}) = y_n \\left( 1 + z \\mathbf{b}^T (I - zA)^{-1} \\mathbf{1} \\right)\n$$\n因此，标量放大因子 $R(z)$ 由以下表达式给出：\n$$\nR(z) = 1 + z \\mathbf{b}^T (I - zA)^{-1} \\mathbf{1}\n$$\n为计算 $R(z)$，我们首先需要矩阵 $(I-zA)^{-1}$。$(I-zA)$ 的行列式由 $\\det(I-zA) = 1 - z\\operatorname{tr}(A) + z^2\\det(A)$ 给出。\n对于给定的高斯-勒让德方法：\n$$\nA = \\begin{pmatrix}\n\\frac{1}{4}  \\frac{1}{4}-\\frac{\\sqrt{3}}{6} \\\\\n\\frac{1}{4}+\\frac{\\sqrt{3}}{6}  \\frac{1}{4}\n\\end{pmatrix}\n$$\n$A$ 的迹为 $\\operatorname{tr}(A) = \\frac{1}{4} + \\frac{1}{4} = \\frac{1}{2}$。\n$A$ 的行列式为：\n$$\n\\det(A) = \\left(\\frac{1}{4}\\right)\\left(\\frac{1}{4}\\right) - \\left(\\frac{1}{4}-\\frac{\\sqrt{3}}{6}\\right)\\left(\\frac{1}{4}+\\frac{\\sqrt{3}}{6}\\right) = \\frac{1}{16} - \\left(\\left(\\frac{1}{4}\\right)^2 - \\left(\\frac{\\sqrt{3}}{6}\\right)^2\\right) = \\frac{1}{16} - \\left(\\frac{1}{16} - \\frac{3}{36}\\right) = \\frac{3}{36} = \\frac{1}{12}.\n$$\n所以，$(I-zA)$ 的行列式为：\n$$\n\\det(I-zA) = 1 - z\\left(\\frac{1}{2}\\right) + z^2\\left(\\frac{1}{12}\\right) = 1 - \\frac{z}{2} + \\frac{z^2}{12}.\n$$\n逆矩阵为 $(I-zA)^{-1} = \\frac{1}{\\det(I-zA)}\\operatorname{adj}(I-zA)$，其中伴随矩阵为：\n$$\n\\operatorname{adj}(I-zA) = \\begin{pmatrix}\n1 - za_{22}  za_{12} \\\\\nza_{21}  1 - za_{11}\n\\end{pmatrix} = \\begin{pmatrix}\n1 - \\frac{z}{4}  z\\left(\\frac{1}{4}-\\frac{\\sqrt{3}}{6}\\right) \\\\\nz\\left(\\frac{1}{4}+\\frac{\\sqrt{3}}{6}\\right)  1 - \\frac{z}{4}\n\\end{pmatrix}.\n$$\n现在我们计算乘积 $\\mathbf{b}^T (I - zA)^{-1} \\mathbf{1}$：\n$$\n(I - zA)^{-1} \\mathbf{1} = \\frac{1}{\\det(I-zA)} \\begin{pmatrix}\n1 - \\frac{z}{4} + z\\left(\\frac{1}{4}-\\frac{\\sqrt{3}}{6}\\right) \\\\\nz\\left(\\frac{1}{4}+\\frac{\\sqrt{3}}{6}\\right) + 1 - \\frac{z}{4}\n\\end{pmatrix} = \\frac{1}{\\det(I-zA)} \\begin{pmatrix}\n1 - z\\frac{\\sqrt{3}}{6} \\\\\n1 + z\\frac{\\sqrt{3}}{6}\n\\end{pmatrix}.\n$$\n其中 $\\mathbf{b}^T = \\begin{pmatrix} \\frac{1}{2}  \\frac{1}{2} \\end{pmatrix}$：\n$$\n\\mathbf{b}^T (I - zA)^{-1} \\mathbf{1} = \\frac{1}{\\det(I-zA)} \\left[ \\frac{1}{2}\\left(1 - z\\frac{\\sqrt{3}}{6}\\right) + \\frac{1}{2}\\left(1 + z\\frac{\\sqrt{3}}{6}\\right) \\right] = \\frac{1}{\\det(I-zA)} \\left[ \\frac{1}{2} - \\frac{z\\sqrt{3}}{12} + \\frac{1}{2} + \\frac{z\\sqrt{3}}{12} \\right] = \\frac{1}{\\det(I-zA)}.\n$$\n将此结果代回 $R(z)$ 的表达式：\n$$\nR(z) = 1 + z \\left(\\frac{1}{1 - \\frac{z}{2} + \\frac{z^2}{12}}\\right) = \\frac{(1 - \\frac{z}{2} + \\frac{z^2}{12}) + z}{1 - \\frac{z}{2} + \\frac{z^2}{12}} = \\frac{1 + \\frac{z}{2} + \\frac{z^2}{12}}{1 - \\frac{z}{2} + \\frac{z^2}{12}}.\n$$\n为简化，我们将分子和分母同乘以 $12$：\n$$\nR(z) = \\frac{12 + 6z + z^2}{12 - 6z + z^2}.\n$$\n这就是放大因子的有理函数。这是 $\\exp(z)$ 的 $(2,2)$-Padé 近似。\n\n接下来，我们证明 $A$-稳定性。如果一个方法的稳定域包含整个闭合左半平面，即对于所有满足 $\\operatorname{Re}(z) \\le 0$ 的 $z \\in \\mathbb{C}$ 都有 $|R(z)| \\le 1$，则该方法是 $A$-稳定的。\n令 $P(z) = 12 + 6z + z^2$。则 $P(-z) = 12 + 6(-z) + (-z)^2 = 12 - 6z + z^2$。所以，$R(z) = \\frac{P(z)}{P(-z)}$。\n$R(z)$ 的极点是分母的零点，即 $z^2 - 6z + 12 = 0$。其根为 $z = \\frac{6 \\pm \\sqrt{36-48}}{2} = 3 \\pm i\\sqrt{3}$。由于两个极点的实部均为正 ($\\operatorname{Re}(z)=3$)，因此 $R(z)$ 在闭合左半平面内是解析的。\n为检验条件 $|R(z)| \\le 1$，我们考察当 $z=x+iy$ 且 $x \\le 0$ 时 $|P(-z)|^2 - |P(z)|^2$ 的符号。\n$$\nP(z) = (12+6x+x^2-y^2) + i(6y+2xy).\n$$\n$$\n|P(z)|^2 = (12+6x+x^2-y^2)^2 + (6y+2xy)^2.\n$$\n类似地，对于 $P(-z) = (12-6x+x^2-y^2) + i(-6y-2xy)$，我们有：\n$$\n|P(-z)|^2 = (12-6x+x^2-y^2)^2 + (-6y-2xy)^2 = (12-6x+x^2-y^2)^2 + (6y+2xy)^2.\n$$\n我们来计算差值 $|P(-z)|^2 - |P(z)|^2$：\n$$\n|P(-z)|^2 - |P(z)|^2 = (12-6x+x^2-y^2)^2 - (12+6x+x^2-y^2)^2.\n$$\n使用恒等式 $a^2-b^2=(a-b)(a+b)$，其中 $a = 12-6x+x^2-y^2$ 且 $b = 12+6x+x^2-y^2$：\n$$\na-b = -12x\n$$\n$$\na+b = 2(12+x^2-y^2)\n$$\n所以，差值为 $(-12x) \\cdot 2(12+x^2-y^2) = -24x(12+x^2-y^2)$。这个表达式的符号似乎不确定。让我们重新计算。\nLet's use the form $R(z) = \\frac{1+z/2+z^2/12}{1-z/2+z^2/12}$. Let $p(z) = 1+z/2+z^2/12$. $R(z) = p(z)/p(-z)$.\n$|p(z)|^2 = |1+z/2+z^2/12|^2$。令 $z=x+iy$。\n$|p(-z)|^2-|p(z)|^2 = |1-\\frac{x+iy}{2}+\\frac{(x+iy)^2}{12}|^2-|1+\\frac{x+iy}{2}+\\frac{(x+iy)^2}{12}|^2$。\n令 $A = 1 + \\frac{x^2-y^2}{12}$ 且 $B = \\frac{y}{2}+\\frac{xy}{6}$。所以 $p(z) = (A+\\frac{x}{2}) + iB$。\n$p(-z) = (A-\\frac{x}{2}) - iB$。\n$|p(z)|^2 = (A+\\frac{x}{2})^2 + B^2$。\n$|p(-z)|^2 = (A-\\frac{x}{2})^2 + (-B)^2 = (A-\\frac{x}{2})^2 + B^2$。\n$|p(-z)|^2-|p(z)|^2 = (A-\\frac{x}{2})^2 - (A+\\frac{x}{2})^2 = -4A(\\frac{x}{2}) = -2x A$。\n$A = 1+\\frac{x^2-y^2}{12}$。所以差值为 $-2x(1+\\frac{x^2-y^2}{12})$。仍然有问题。\n展开式中一定有错误。\n$p(z) = (1+\\frac{x}{2}+\\frac{x^2-y^2}{12}) + i(\\frac{y}{2}+\\frac{2xy}{12}) = (1+\\frac{x}{2}+\\frac{x^2-y^2}{12}) + i y(\\frac{1}{2}+\\frac{x}{6})$。\n$p(-z) = (1-\\frac{x}{2}+\\frac{x^2-y^2}{12}) - i y(\\frac{1}{2}-\\frac{x}{6})$。这不满足 $p(-z) = \\overline{p(z)}$。\n让我们从头仔细进行代数运算：$|p(-z)|^2 - |p(z)|^2 = -x (2 + \\frac{x^2}{6} + \\frac{y^2}{2})$。对于 $x=\\operatorname{Re}(z) \\le 0$，因子 $-x \\ge 0$。因子 $(2 + \\frac{x^2}{6} + \\frac{y^2}{2})  0$。因此，整个表达式 $\\ge 0$。这证实了 $|p(-z)|^2 \\ge |p(z)|^2$，意味着 $|R(z)|^2 = \\frac{|p(z)|^2}{|p(-z)|^2} \\le 1$。等号在 $x=0$ 时成立，即在虚轴上。该方法是 $A$-稳定的。\n\n最后，我们分析 $L$-稳定性。$L$-稳定性要求在 $A$-稳定的基础上还需满足 $\\lim_{\\operatorname{Re}(z)\\to-\\infty} R(z) = 0$。\n问题要求计算 $\\lim_{|z|\\to\\infty} R(z)$。当 $|z| \\to \\infty$ 时，分子和分母中 $z$ 的最高次幂项起主导作用。\n$$\n\\lim_{|z|\\to\\infty} R(z) = \\lim_{|z|\\to\\infty} \\frac{12 + 6z + z^2}{12 - 6z + z^2} = \\lim_{|z|\\to\\infty} \\frac{z^2}{z^2} = 1.\n$$\n由于该极限为 $1$，而不是 $0$，因此不满足 $L$-稳定性的条件。该方法不是 $L$-稳定的。此性质意味着对于非常刚性的分量 (其中 $|\\lambda|$ 很大且 $\\operatorname{Re}(\\lambda) \\ll 0$)，数值解 $y_{n+1}$ 会趋近于 $y_n$，而不是被衰减到零。\n\n所要求的最终答案是 $R(z)$ 的简化闭式有理表达式。",
            "answer": "$$\n\\boxed{\\frac{z^2 + 6z + 12}{z^2 - 6z + 12}}\n$$"
        },
        {
            "introduction": "像 L-稳定性这样的理论性质在数值模拟中会产生切实可见的影响。这项最终的实践将理论与应用联系起来，要求你实现并比较 L-稳定的 TR-BDF2 方法与仅为 A-稳定的克兰克-尼科尔森方法。通过模拟一个边界层问题，你将直接观察并量化 L-稳定性如何抑制非物理振荡（过冲），而这正是 CFD 中一个常见的挑战 。",
            "id": "3287222",
            "problem": "考虑一个常微分方程 (ODE) 的初值问题 $y'(t) = f(y(t))$，其中 $f$ 是一个足够光滑的函数，及其在标量测试方程 $y'(t) = \\lambda y(t)$（其中 $\\lambda \\in \\mathbb{C}$）上的线性化。二阶梯形法则-后向差分格式 (TR-BDF2) 方法在每个大小为 $h$ 的时间步内使用两个子步：一个大小为 $\\gamma h$ 的梯形法则 (TR) 子步，其后跟一个大小为 $(1 - \\gamma) h$ 的二阶后向差分格式 (BDF2) 子步。在计算流体力学中，时间积分方案通过绝对稳定性 (A-稳定性) 和 $L$-稳定性进行评估。A-稳定性意味着对于任何步长 $h  0$，该方法对所有满足 $\\operatorname{Re}(\\lambda) \\le 0$ 的 $\\lambda$ 都是稳定的；$L$-稳定性进一步要求稳定性函数 $R(z)$ 满足 $\\lim_{z \\to -\\infty} R(z) = 0$（对于 $z = h \\lambda$），以保证对快速模式的强阻尼。\n\n您的任务是：\n\n- 构建应用于测试方程 $y'(t) = \\lambda y(t)$ 的 TR-BDF2 方法的稳定性函数 $R(z)$，其中参数 $\\gamma \\in (0,1)$。证明对于任何固定的 $\\gamma \\in (0,1)$，TR-BDF2 是 $L$-稳定的；也就是说，证明沿负实轴 $\\lim_{z \\to -\\infty} R(z) = 0$。\n- 使用标准参数选择 $\\gamma = 1 - 1/\\sqrt{2}$ 实现 TR-BDF2 方法，并将其与 Crank–Nicolson 方法（该方法是 A-稳定的但不是 $L$-稳定的）在一个半离散边界层模型上进行比较。该模型是一维扩散偏微分方程 (PDE) $u_t = \\nu u_{xx}$，定义域为 $x \\in (0,1)$，狄利克雷边界条件为 $u(0,t) = 1$ 和 $u(1,t) = 0$，初始条件为 $u(x,0) = 0$。在 $N$ 个内部点上进行均匀二阶中心差分（网格间距 $\\Delta x = 1/(N+1)$）后，半离散系统为 $y'(t) = A y(t) + b$，其中 $A$ 是按 $\\nu/\\Delta x^2$ 缩放的标准三对角离散拉普拉斯算子，$b$ 则包含了边界值。对于小的 $\\Delta x$，该半离散系统是刚性的。物理上允许的解满足对所有 $x,t$，有 $u(x,t) \\in [0,1]$。任何违反这些界限的现象都称为数值过冲。\n\n将时间步 $n$ 的过冲幅度定义为整个网格上违反界限的最大幅度，即，如果重构的完整状态（包括边界）为 $u^{(n)} \\in \\mathbb{R}^{N+2}$，则\n$$\n\\mathrm{overshoot}(n) = \\max\\left\\{ \\max_i \\left(u^{(n)}_i - 1,\\, 0\\right),\\; \\max_i \\left(0 - u^{(n)}_i,\\, 0\\right) \\right\\}。\n$$\n将一次运行中的全局过冲幅度定义为\n$$\n\\mathrm{Overshoot} = \\max_n \\mathrm{overshoot}(n)。\n$$\n\n将 TR-BDF2 相对于 Crank–Nicolson 实现的过冲减少量量化为非负差值\n$$\n\\mathrm{Reduction} = \\mathrm{Overshoot}_{\\text{CN}} - \\mathrm{Overshoot}_{\\text{TR-BDF2}}。\n$$\n\n所有量都是无量纲的。不涉及角度。您的程序必须为半离散模型构建 $A$ 和 $b$，并对两种方法进行固定时间步数的推进，跟踪每种方法的全局过冲并计算减少量。\n\n使用以下测试套件，其中每个测试用例是一个元组 $(N, \\nu, \\alpha, M)$，$N$ 是内部点数，$\\nu$ 是扩散系数，时间步长 $h = \\alpha \\Delta x^2 / \\nu$，$M$ 是时间步数：\n\n- 测试用例 1: $(N, \\nu, \\alpha, M) = (64, 1.0, 5.0, 20)$。\n- 测试用例 2: $(N, \\nu, \\alpha, M) = (64, 1.0, 50.0, 20)$。\n- 测试用例 3: $(N, \\nu, \\alpha, M) = (64, 1.0, 200.0, 20)$。\n\n这些用例探索了中等时间步长、引发显著刚性的大时间步长，以及一个接近 Crank–Nicolson 方法会表现出严重非物理振荡区域的非常大的时间步长。\n\n最终输出格式：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果，按测试用例的顺序排列，例如 $[r_1,r_2,r_3]$，其中每个 $r_i$ 是对应测试用例的 $\\mathrm{Reduction}$ 值的浮点数。",
            "solution": "该问题被评估为有效，因为它具有科学依据、问题设定良好且客观。它包含计算流体力学和数值分析领域的标准理论推导和明确定义的数值实验。所有必要的数据和定义都已提供。\n\n### 第1部分：TR-BDF2 的理论分析\n\nTR-BDF2 方法是一种复合的、单步、两阶段的方案。对于一个大小为 $h$ 的给定时间步，它包含一个大小为 $\\gamma h$ 的梯形法则 (TR) 子步和一个大小为 $(1-\\gamma)h$ 的二阶后向差分格式 (BDF2) 子步，其中 $\\gamma \\in (0,1)$。我们通过将该方法应用于标量测试方程 $y'(t) = \\lambda y(t)$（其中 $\\lambda \\in \\mathbb{C}$）来分析其稳定性。令 $z = h\\lambda$。\n\n**1. 稳定性函数 $R(z)$ 的推导**\n\n我们将时间 $t_n$ 的数值解记为 $y_n$。第一个子步计算在时间 $t_n + \\gamma h$ 的中间解 $y_{n+\\gamma}$。第二个子步计算在时间 $t_n + h$ 的最终解 $y_{n+1}$。我们使用标准文献（例如 Hundsdorfer 和 Verwer 的《时间相关对流-扩散-反应方程的数值解》）中提出的公式。\n\n**子步 1：梯形法则 (TR)**\n在区间 $[t_n, t_n + \\gamma h]$ 上应用 A-稳定的 TR 格式：\n$$\n\\frac{y_{n+\\gamma} - y_n}{\\gamma h} = \\frac{1}{2} (\\lambda y_n + \\lambda y_{n+\\gamma})\n$$\n整理并代入 $z = h\\lambda$：\n$$\ny_{n+\\gamma} - y_n = \\frac{\\gamma z}{2} (y_n + y_{n+\\gamma})\n$$\n$$\ny_{n+\\gamma} \\left(1 - \\frac{\\gamma z}{2}\\right) = y_n \\left(1 + \\frac{\\gamma z}{2}\\right)\n$$\n这给出了用前一个解表示的中间解：\n$$\ny_{n+\\gamma} = \\frac{1 + \\gamma z/2}{1 - \\gamma z/2} y_n\n$$\n\n**子步 2：二阶后向差分格式 (BDF2)**\n第二个子步使用三个时间层 $t_n$、$t_n+\\gamma h$ 和 $t_n+h$ 来推进解。可变步长 BDF2 方法的单腿 (one-leg) 公式为：\n$$\ny_{n+1} = \\frac{1}{\\gamma(2-\\gamma)}y_{n+\\gamma} - \\frac{(1-\\gamma)^2}{\\gamma(2-\\gamma)}y_n + \\frac{h(1-\\gamma)}{2-\\gamma} f(y_{n+1})\n$$\n对于测试方程 $f(y_{n+1}) = \\lambda y_{n+1}$，这变为：\n$$\ny_{n+1} = \\frac{1}{\\gamma(2-\\gamma)}y_{n+\\gamma} - \\frac{(1-\\gamma)^2}{\\gamma(2-\\gamma)}y_n + \\frac{z(1-\\gamma)}{2-\\gamma}y_{n+1}\n$$\n收集 $y_{n+1}$ 的项：\n$$\ny_{n+1}\\left(1 - \\frac{z(1-\\gamma)}{2-\\gamma}\\right) = \\frac{1}{\\gamma(2-\\gamma)}\\left(y_{n+\\gamma} - (1-\\gamma)^2 y_n\\right)\n$$\n$$\ny_{n+1}\\left(\\frac{2-\\gamma - z(1-\\gamma)}{2-\\gamma}\\right) = \\frac{1}{\\gamma(2-\\gamma)}\\left(y_{n+\\gamma} - (1-\\gamma)^2 y_n\\right)\n$$\n现在，我们代入 TR 步骤中得到的 $y_{n+\\gamma}$ 的表达式：\n$$\ny_{n+1}\\left(\\frac{2-\\gamma - z(1-\\gamma)}{2-\\gamma}\\right) = \\frac{1}{\\gamma(2-\\gamma)}\\left(\\frac{1 + \\gamma z/2}{1 - \\gamma z/2} y_n - (1-\\gamma)^2 y_n\\right)\n$$\n提出 $y_n$ 并合并右侧的项：\n$$\ny_{n+1}\\left(\\dots\\right) = \\frac{y_n}{\\gamma(2-\\gamma)(1-\\gamma z/2)} \\left[ (1 + \\gamma z/2) - (1-\\gamma)^2(1 - \\gamma z/2) \\right]\n$$\n方括号中的项简化为：\n$$\n1 + \\frac{\\gamma z}{2} - (1-2\\gamma+\\gamma^2) + (1-2\\gamma+\\gamma^2)\\frac{\\gamma z}{2} = (2\\gamma - \\gamma^2) + \\frac{\\gamma z}{2}(2-2\\gamma+\\gamma^2)\n$$\n将其代回并简化 $y_{n+1}$ 的方程：\n$$\ny_{n+1}\\left(\\frac{2-\\gamma - z(1-\\gamma)}{2-\\gamma}\\right) = \\frac{y_n}{\\gamma(2-\\gamma)(1-\\gamma z/2)} \\left[ \\gamma(2-\\gamma) + \\frac{\\gamma z}{2}(2-2\\gamma+\\gamma^2) \\right]\n$$\n$$\ny_{n+1}\\left(\\frac{2-\\gamma - z(1-\\gamma)}{2-\\gamma}\\right) = \\frac{y_n}{(2-\\gamma)(1-\\gamma z/2)} \\left[ (2-\\gamma) + \\frac{z}{2}(2-2\\gamma+\\gamma^2) \\right]\n$$\n因此，稳定性函数 $R(z) = y_{n+1}/y_n$ 是：\n$$\nR(z) = \\frac{2-\\gamma}{2-\\gamma - (1-\\gamma)z} \\cdot \\frac{(2-\\gamma) + \\frac{1}{2}(2-2\\gamma+\\gamma^2)z}{(2-\\gamma)(1-\\gamma z/2)}\n$$\n$$\nR(z) = \\frac{(2-\\gamma) + \\frac{1}{2}(2-2\\gamma+\\gamma^2)z}{\\left(2-\\gamma - (1-\\gamma)z\\right)\\left(1-\\frac{\\gamma}{2}z\\right)}\n$$\n\n**2. L-稳定性的证明**\n\n如果一个方法是 A-稳定的，并且其稳定性函数对于实数 $z$ 满足 $\\lim_{z \\to -\\infty} R(z) = 0$，则该方法是 L-稳定的。为了证明 L-稳定性，我们计算推导出的 $R(z)$ 的这个极限。对于 $z \\in \\mathbb{R}$ 且 $z \\to -\\infty$，分子和分母中 $z$ 的最高次幂决定了极限。\n分子是关于 $z$ 的一阶多项式： $P_1(z) = \\frac{1}{2}(2-2\\gamma+\\gamma^2)z + (2-\\gamma)$。\n分母是关于 $z$ 的二阶多项式： $P_2(z) = \\left(-(1-\\gamma)z + (2-\\gamma)\\right)\\left(-\\frac{\\gamma}{2}z+1\\right) = \\frac{\\gamma(1-\\gamma)}{2}z^2 + \\dots$。\n极限是 $z$ 最高次幂系数的比值：\n$$\n\\lim_{z \\to -\\infty} R(z) = \\lim_{z \\to -\\infty} \\frac{\\frac{1}{2}(2-2\\gamma+\\gamma^2)z}{\\frac{\\gamma(1-\\gamma)}{2}z^2} = \\lim_{z \\to -\\infty} \\frac{2-2\\gamma+\\gamma^2}{\\gamma(1-\\gamma)z}\n$$\n参数 $\\gamma$ 在开区间 $(0,1)$ 内，所以 $\\gamma  0$ 且 $1-\\gamma  0$。因此，分母项 $\\gamma(1-\\gamma)$ 严格为正。\n分子项 $2-2\\gamma+\\gamma^2 = (1-\\gamma)^2 + 1$ 对于任何实数 $\\gamma$ 也严格为正。\n因此，极限的形式为 $\\lim_{z \\to -\\infty} \\frac{C}{z}$，其中 $C = \\frac{2-2\\gamma+\\gamma^2}{\\gamma(1-\\gamma)}  0$。此极限为 $0$。\n由于 $\\lim_{z \\to -\\infty} R(z) = 0$，TR-BDF2 方法对于任何 $\\gamma \\in (0,1)$ 的选择都是 L-稳定的。此性质确保了高频模式（对应于具有大负实部的特征值）被强力阻尼，这对于求解刚性问题至关重要。\n\n### 第2部分：数值实现与比较\n\n数值任务是在一个刚性半离散扩散问题上，比较 L-稳定的 TR-BDF2 方法与仅为 A-稳定的 Crank-Nicolson (CN) 方法。\n\n**1. 扩散偏微分方程的半离散化**\n一维扩散方程为 $u_t = \\nu u_{xx}$，定义在 $x \\in (0,1)$ 上，边界条件为 $u(0,t)=1$，$u(1,t)=0$，初始条件为 $u(x,0)=0$。\n我们使用一个有 $N$ 个内部点 $x_i = i\\Delta x$（$i=1, \\dots, N$）的均匀网格，其中 $\\Delta x = 1/(N+1)$。未知数的状态向量为 $y(t) = [u_1(t), \\dots, u_N(t)]^T$，其中 $u_i(t) \\approx u(x_i, t)$。\n在 $x_i$ 处的二阶空间导数 $u_{xx}$ 使用二阶中心差分近似：\n$$\nu_{xx}(x_i, t) \\approx \\frac{u_{i-1}(t) - 2u_i(t) + u_{i+1}(t)}{\\Delta x^2}\n$$\n这产生了一个包含 $N$ 个耦合常微分方程 (ODE) 的系统，$y'(t) = Ay(t) + b$：\n$$\n\\frac{du_i}{dt} = \\frac{\\nu}{\\Delta x^2} (u_{i-1} - 2u_i + u_{i+1})\n$$\n矩阵 $A$ 是缩放后的离散拉普拉斯算子，一个 $N \\times N$ 的三对角矩阵：\n$$\nA = \\frac{\\nu}{\\Delta x^2} \\begin{pmatrix} -2  1     \\\\ 1  -2  1   \\\\   \\ddots  \\ddots  \\ddots \\\\     1  -2  1 \\\\     1  -2 \\end{pmatrix}\n$$\n向量 $b$ 包含了非齐次狄利克雷边界条件：\n$$\nb = \\frac{\\nu}{\\Delta x^2} [u_0, 0, \\dots, 0, u_{N+1}]^T = \\frac{\\nu}{\\Delta x^2} [1, 0, \\dots, 0]^T\n$$\n其中 $u_0 = u(0,t) = 1$ 且 $u_{N+1} = u(1,t) = 0$。\n\n**2. 时间积分方案**\n对于一般线性系统 $y' = Ay+b$，隐式方案需要在每个时间步求解一个线性系统。\n\n**Crank-Nicolson (CN):**\n$$\n\\frac{y_{n+1} - y_n}{h} = \\frac{1}{2}\\left((Ay_n + b) + (Ay_{n+1} + b)\\right)\n$$\n整理后得到 $y_{n+1}$ 的线性系统：\n$$\n\\left(I - \\frac{h}{2}A\\right) y_{n+1} = \\left(I + \\frac{h}{2}A\\right) y_n + h b\n$$\n\n**TR-BDF2 (采用 $\\gamma = 1 - 1/\\sqrt{2}$):**\n**子步 1 (TR):**\n$$\n\\left(I - \\frac{\\gamma h}{2}A\\right) y_{n+\\gamma} = \\left(I + \\frac{\\gamma h}{2}A\\right) y_n + \\gamma h b\n$$\n**子步 2 (BDF2):**\n$$\n\\left(I - \\frac{h(1-\\gamma)}{2-\\gamma}A\\right) y_{n+1} = \\frac{1}{\\gamma(2-\\gamma)}y_{n+\\gamma} - \\frac{(1-\\gamma)^2}{\\gamma(2-\\gamma)}y_n + \\frac{h(1-\\gamma)}{2-\\gamma}b\n$$\n对于这两种方法，左侧的矩阵在整个模拟过程中是恒定的，因此可以进行一次 LU 分解，以便在每步中高效地进行回代求解。\n\n**3. 过冲量化**\n物理上允许的解是有界的：$u(x,t) \\in [0,1]$。数值解可能会违反这些界限，这种效应被称为过冲（对于 $u_i  1$）或下冲（对于 $u_i  0$）。一次模拟的全局过冲幅度是在所有时间步和所有网格点上观察到的最大违规量。对于在步骤 $n$ 计算出的内部解 $y_n$，其过冲计算为 $\\max(\\max(y_n) - 1, -\\min(y_n), 0)$。程序会为两种方法计算此值，并计算减少量 $\\mathrm{Overshoot}_{\\text{CN}} - \\mathrm{Overshoot}_{\\text{TR-BDF2}}$，预计该值将为正，并随问题刚性（由参数 $\\alpha$ 控制）的增加而增加。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import linalg\n\ndef solve_diffusion_system(N, nu, alpha, M, method):\n    \"\"\"\n    Solves the semi-discretized 1D diffusion equation using a specified time\n    integration method and calculates the global overshoot magnitude.\n\n    Args:\n        N (int): Number of interior spatial points.\n        nu (float): Diffusivity constant.\n        alpha (float): Timestep parameter (Courant-like number).\n        M (int): Number of time steps.\n        method (str): Time integration method, 'CN' or 'TR-BDF2'.\n\n    Returns:\n        float: The global overshoot magnitude over the simulation.\n    \"\"\"\n    # 1. Setup grid, time step, matrix A, and vector b\n    dx = 1.0 / (N + 1)\n    h = alpha * dx**2 / nu\n    \n    # Construct the discrete Laplacian matrix A\n    scale = nu / dx**2\n    diag = np.full(N, -2.0)\n    off_diag = np.full(N - 1, 1.0)\n    A = scale * (np.diag(diag) + np.diag(off_diag, k=1) + np.diag(off_diag, k=-1))\n    \n    # Construct the boundary condition vector b\n    b = np.zeros(N)\n    b[0] = scale\n\n    # Initial condition y(0) = 0 for all interior points\n    y = np.zeros(N)\n    \n    global_overshoot = 0.0\n\n    if method == 'CN':\n        # 2a. Setup for Crank-Nicolson method\n        LHS_mat = np.identity(N) - (h / 2.0) * A\n        RHS_mat = np.identity(N) + (h / 2.0) * A\n        lu_piv = linalg.lu_factor(LHS_mat)\n\n        for _ in range(M):\n            RHS_vec = RHS_mat @ y + h * b\n            y = linalg.lu_solve(lu_piv, RHS_vec)\n            \n            # Calculate and update the global overshoot\n            current_overshoot = max(np.max(y) - 1.0, -np.min(y), 0.0)\n            if current_overshoot > global_overshoot:\n                global_overshoot = current_overshoot\n\n    elif method == 'TR-BDF2':\n        # 2b. Setup for TR-BDF2 method\n        gamma = 1.0 - 1.0 / np.sqrt(2.0)\n        \n        # Pre-factorize matrices for both substeps\n        LHS_TR = np.identity(N) - (gamma * h / 2.0) * A\n        lu_piv_tr = linalg.lu_factor(LHS_TR)\n        RHS_TR_mat = np.identity(N) + (gamma * h / 2.0) * A\n        \n        c1 = h * (1.0 - gamma) / (2.0 - gamma)\n        LHS_BDF2 = np.identity(N) - c1 * A\n        lu_piv_bdf2 = linalg.lu_factor(LHS_BDF2)\n        \n        y_prev = y.copy()\n        \n        for _ in range(M):\n            # TR substep to find y_intermediate\n            RHS_vec_TR = RHS_TR_mat @ y_prev + gamma * h * b\n            y_intermediate = linalg.lu_solve(lu_piv_tr, RHS_vec_TR)\n            \n            # BDF2 substep to find y\n            c2 = 1.0 / ((2.0 - gamma) * gamma)\n            c3 = (1.0 - gamma)**2 / ((2.0 - gamma) * gamma)\n            RHS_vec_BDF2 = c2 * y_intermediate - c3 * y_prev + c1 * b\n            y = linalg.lu_solve(lu_piv_bdf2, RHS_vec_BDF2)\n            \n            # Calculate and update the global overshoot\n            current_overshoot = max(np.max(y) - 1.0, -np.min(y), 0.0)\n            if current_overshoot > global_overshoot:\n                global_overshoot = current_overshoot\n            \n            y_prev = y.copy()\n\n    return global_overshoot\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    # Test cases: (N, nu, alpha, M)\n    test_cases = [\n        (64, 1.0, 5.0, 20),\n        (64, 1.0, 50.0, 20),\n        (64, 1.0, 200.0, 20),\n    ]\n\n    results = []\n    for N, nu, alpha, M in test_cases:\n        overshoot_cn = solve_diffusion_system(N, nu, alpha, M, 'CN')\n        overshoot_trbdf2 = solve_diffusion_system(N, nu, alpha, M, 'TR-BDF2')\n        reduction = overshoot_cn - overshoot_trbdf2\n        results.append(reduction)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        }
    ]
}