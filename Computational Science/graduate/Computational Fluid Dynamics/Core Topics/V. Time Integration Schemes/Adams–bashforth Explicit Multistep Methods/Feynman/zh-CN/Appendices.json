{
    "hands_on_practices": [
        {
            "introduction": "在计算流体动力学中，选择时间积分方案往往需要在每步的计算成本和数值稳定性之间做出权衡。亚当斯-巴什福斯（Adams–Bashforth）等多步法每步的计算成本较低，但稳定性区域可能较小；而龙格-库塔（Runge–Kutta）等单步法每步成本较高，但通常具有更大的稳定性区域。本练习  将通过一个典型的一维线性平流问题，指导您量化这种权衡，通过比较三阶亚当斯-巴什福斯方法（AB3）和经典的三阶龙格-库塔方法（RK3）的计算效率，从而培养您在实际应用中选择最优算法的判断力。",
            "id": "3288534",
            "problem": "考虑一维线性平流方程 $u_{t} + a\\,u_{x} = 0$，其中平流速度 $a > 0$ 为常数，定义在长度为 $L$ 的周期性域上，该域由 $N$ 个点的均匀网格离散化，网格间距为 $h = L/N$。使用一阶迎风有限差分进行空间离散，以产生一个半离散常微分方程组。从后向差分算子的离散傅里叶模态分析出发，确定半离散算子的特征值集合，并找出对于显式方法时间步进最严格的特征值。\n\n您将比较三阶 Adams–Bashforth 显式多步法 (AB3) 与经典的三步三阶 Runge–Kutta 方法 (RK3)。利用每个时间积分器的线性绝对稳定域和您得到的最坏情况下的半离散特征值，计算每种方法的最大稳定时间步长 $\\Delta t_{\\max}$。然后，利用 AB3 每时间步的右端项 (RHS) 求值次数为 $1$ 次，而 RK3 为 $3$ 次这一事实，计算 AB3 与 RK3 之间每单位模拟时间的计算成本之比，定义为\n$$\n\\mathcal{R} \\equiv \\frac{\\text{AB3 每单位模拟时间的 RHS 求值次数}}{\\text{RK3 每单位模拟时间的 RHS 求值次数}}。\n$$\n假设每次 RHS 求值的计算成本相等，并且在长时间极限下，多步法的启动成本可以忽略不计。\n\n将 $\\mathcal{R}$ 的值报告为一个数字，四舍五入到四位有效数字。最终答案不需要单位。",
            "solution": "该问题是有效的，因为它科学地基于偏微分方程数值分析的原理，是适定的、客观的，并包含了推导唯一解所需的所有信息。\n\n该问题要求比较三阶 Adams–Bashforth (AB3) 方法和经典三步三阶 Runge–Kutta (RK3) 方法在一维线性平流方程 $u_{t} + a\\,u_{x} = 0$（其中平流速度 $a > 0$ 为常数）上的计算效率。分析按以下步骤进行：空间离散化、离散算子的特征值分析、时间积分器的稳定性分析，最后计算成本比率。\n\n**步骤 1：半离散化与特征值分析**\n空间域用间距为 $h$ 的均匀网格进行离散化。对于平流方程 $u_t = -a u_x$，其中 $a > 0$，一阶迎风有限差分格式使用一阶后向差分来计算空间导数 $u_x$。在网格点 $x_j$ 处，这由下式给出：\n$$\nu_x(x_j) \\approx \\frac{u_j - u_{j-1}}{h}\n$$\n其中 $u_j(t)$ 是对 $u(x_j, t)$ 的数值近似。将此代入偏微分方程，得到一个常微分方程组 (ODEs)，每个网格点 $j$ 对应一个方程：\n$$\n\\frac{d u_j}{dt} = -\\frac{a}{h} (u_j - u_{j-1})\n$$\n这是方程的半离散形式，可以写成向量形式 $\\frac{d\\mathbf{u}}{dt} = \\mathbf{L}\\mathbf{u}$，其中 $\\mathbf{L}$ 是空间离散算子。\n\n为了找到算子 $\\mathbf{L}$ 的特征值，我们进行离散傅里叶模态分析。我们将单个傅里叶模态视为解：\n$$\nu_j(t) = \\hat{u}_k(t) \\exp(i k x_j) = \\hat{u}_k(t) \\exp(i k j h)\n$$\n其中 $k$ 是波数，$\\hat{u}_k(t)$ 是该模态随时间变化的振幅。将此代入半离散方程得到：\n$$\n\\frac{d}{dt} \\left( \\hat{u}_k(t) \\exp(i k j h) \\right) = -\\frac{a}{h} \\left( \\hat{u}_k(t) \\exp(i k j h) - \\hat{u}_k(t) \\exp(i k (j-1) h) \\right)\n$$\n除以公因子 $\\exp(i k j h)$，得到模态振幅 $\\hat{u}_k(t)$ 的常微分方程：\n$$\n\\frac{d \\hat{u}_k}{dt} = -\\frac{a}{h} \\left( 1 - \\exp(-i k h) \\right) \\hat{u}_k(t)\n$$\n这具有 $\\frac{d\\hat{u}_k}{dt} = \\lambda_k \\hat{u}_k$ 的形式，其中 $\\lambda_k$ 是算子 $\\mathbf{L}$ 的特征值。令 $\\theta = kh$ 为无量纲波数，其范围从 $0$ 到 $2\\pi$，以完整表示网格可分辨的波。特征值由下式给出：\n$$\n\\lambda(\\theta) = -\\frac{a}{h} (1 - \\exp(-i\\theta)) = -\\frac{a}{h} (1 - \\cos\\theta + i\\sin\\theta)\n$$\n这些特征值位于复平面的一个圆上。为了证明这一点，令 $\\lambda = \\lambda_x + i\\lambda_y$。则 $\\lambda_x = -\\frac{a}{h}(1-\\cos\\theta)$ 且 $\\lambda_y = -\\frac{a}{h}\\sin\\theta$。整理后得到 $\\lambda_x + \\frac{a}{h} = \\frac{a}{h}\\cos\\theta$ 和 $\\lambda_y = -\\frac{a}{h}\\sin\\theta$。将这两个方程平方并相加，得到：\n$$\n\\left(\\lambda_x + \\frac{a}{h}\\right)^2 + \\lambda_y^2 = \\left(\\frac{a}{h}\\right)^2\n$$\n这是复平面中一个圆心为 $(-\\frac{a}{h}, 0)$、半径为 $\\frac{a}{h}$ 的圆的方程。特征值谱就是这个圆，它穿过原点（对于 $\\theta=0$）并延伸到负实轴上的点 $(-2a/h, 0)$（对于 $\\theta=\\pi$）。\n\n为了使显式时间积分方法稳定，对于所有特征值 $\\lambda_k$，量 $z_k = \\Delta t \\lambda_k$ 必须位于该方法的绝对稳定域 $S$ 内。缩放后的特征值集合 $\\{z_k\\}$ 也形成一个圆，由 $|z + \\nu| = \\nu$ 定义，其中 $\\nu = \\frac{a \\Delta t}{h}$ 是 Courant 数。为了保证稳定性，这个完整的圆必须包含在 $S$ 内。\n\n对于时间步进最严格的特征值是当 $\\Delta t$ 增加时最先导致不稳定的那个。对于像 AB 和 RK 方法这样的稳定域，其在负实轴上有界，这通常由离原点最远、位于负实轴上的特征值决定。这对应于 $\\theta = \\pi$：\n$$\n\\lambda_{\\text{worst}} = \\lambda(\\pi) = -\\frac{a}{h} (1 - \\exp(-i\\pi)) = -\\frac{a}{h} (1 - (-1)) = -\\frac{2a}{h}\n$$\n\n**步骤 2：稳定性极限与最大时间步长**\n显式方法的稳定域通常与负实轴相交于一个区间 $[-\\beta, 0]$。整个缩放特征值谱的稳定性要求圆 $|z+\\nu|=\\nu$ 的最左点 $z = -2\\nu$ 必须位于此区间内。这意味着 $|-2\\nu| \\le \\beta$，或：\n$$\n2\\nu \\le \\beta \\implies \\nu_{\\max} = \\frac{\\beta}{2}\n$$\n因此，最大稳定时间步长 $\\Delta t_{\\max}$ 与 $\\beta$ 的关系为：\n$$\n\\frac{a \\Delta t_{\\max}}{h} = \\nu_{\\max} = \\frac{\\beta}{2} \\implies \\Delta t_{\\max} = \\frac{h \\beta}{2a}\n$$\n现在我们需要 AB3 和 RK3 方法的稳定截距 $\\beta$。\n- 对于三阶 Adams-Bashforth (AB3) 方法，其在负实轴上的稳定边界是一个标准结果，$\\beta_{\\text{AB3}} = \\frac{6}{11}$。\n- 对于经典三步三阶 Runge-Kutta (RK3) 方法，其稳定函数为 $R(z) = 1 + z + \\frac{z^2}{2!} + \\frac{z^3}{3!}$。稳定边界 $\\beta_{\\text{RK3}}$ 是 $|R(-x)|=1$ 的正根，这导致方程 $x^3 - 3x^2 + 6x - 12 = 0$。其数值解为 $\\beta_{\\text{RK3}} \\approx 2.512745$。\n\n最大稳定时间步长为：\n$$\n\\Delta t_{\\max, \\text{AB3}} = \\frac{h \\beta_{\\text{AB3}}}{2a} = \\frac{h}{2a} \\frac{6}{11} = \\frac{3h}{11a}\n$$\n$$\n\\Delta t_{\\max, \\text{RK3}} = \\frac{h \\beta_{\\text{RK3}}}{2a} \\approx \\frac{h}{2a} (2.512745)\n$$\n\n**步骤 3：计算成本比率**\n计算成本由每单位模拟时间的右端项 (RHS) 求值次数来衡量。对于给定的方法，此成本为：\n$$\n\\text{成本} = \\frac{\\text{每时间步的 RHS 求值次数}}{\\text{每时间步的模拟时间}} = \\frac{N_{RHS}}{\\Delta t_{\\max}}\n$$\n我们已知 $N_{RHS, \\text{AB3}} = 1$ 和 $N_{RHS, \\text{RK3}} = 3$。比率 $\\mathcal{R}$ 定义为：\n$$\n\\mathcal{R} = \\frac{\\text{成本}_{\\text{AB3}}}{\\text{成本}_{\\text{RK3}}} = \\frac{N_{RHS, \\text{AB3}}/\\Delta t_{\\max, \\text{AB3}}}{N_{RHS, \\text{RK3}}/\\Delta t_{\\max, \\text{RK3}}} = \\frac{1/\\Delta t_{\\max, \\text{AB3}}}{3/\\Delta t_{\\max, \\text{RK3}}} = \\frac{1}{3} \\frac{\\Delta t_{\\max, \\text{RK3}}}{\\Delta t_{\\max, \\text{AB3}}}\n$$\n代入最大时间步长的表达式：\n$$\n\\mathcal{R} = \\frac{1}{3} \\frac{h \\beta_{\\text{RK3}} / (2a)}{h \\beta_{\\text{AB3}} / (2a)} = \\frac{1}{3} \\frac{\\beta_{\\text{RK3}}}{\\beta_{\\text{AB3}}}\n$$\n现在，我们代入 $\\beta_{\\text{AB3}}$ 和 $\\beta_{\\text{RK3}}$ 的值：\n$$\n\\mathcal{R} = \\frac{1}{3} \\frac{\\beta_{\\text{RK3}}}{6/11} = \\frac{11 \\beta_{\\text{RK3}}}{18}\n$$\n使用 $\\beta_{\\text{RK3}}$ 的数值：\n$$\n\\mathcal{R} = \\frac{11 \\times 2.512745}{18} \\approx \\frac{27.640195}{18} \\approx 1.53556638...\n$$\n四舍五入到四位有效数字，计算成本之比为 $1.536$。由于 $\\mathcal{R} > 1$，这意味着对于此特定问题，AB3 方法的计算成本（以每单位模拟时间的 RHS 求值次数衡量）高于 RK3 方法，因此 RK3 方法的计算效率更高。",
            "answer": "$$\\boxed{1.536}$$"
        },
        {
            "introduction": "虽然单一的数值方法具有固定的性能特征，但我们可以通过组合不同的方法来创造出性能更优越的新方案。预测-校正（Predictor-Corrector）方法就是一种强大的技术，它通过一个显式方法（预测步）来估计解，再用另一个方法（校正步）来提高解的精度或稳定性。本练习  将引导您构建一个以二阶亚当斯-巴什福斯（AB2）为预测子、梯形法则为校正子的PECE格式，并分析其稳定性，让您亲身体验如何通过巧妙的设计来改善数值方法的性能。",
            "id": "3288516",
            "problem": "考虑周期域上的一维平流-扩散初值问题，\n$$\n\\frac{\\partial u(x,t)}{\\partial t} + a\\,\\frac{\\partial u(x,t)}{\\partial x} = \\nu\\,\\frac{\\partial^2 u(x,t)}{\\partial x^2}, \\quad x \\in [0,L], \\quad t \\geq 0,\n$$\n其中网格间距 $h$ 均匀，平流速度 $a > 0$ 为常数，运动粘度 $\\nu > 0$。对一阶和二阶导数均使用标准的二阶中心有限差分进行空间半离散化，得到一个线性系统\n$$\n\\frac{d\\mathbf{u}(t)}{dt} = \\mathbf{A}\\,\\mathbf{u}(t),\n$$\n其中 $\\mathbf{A}$ 是半离散的平流-扩散算子。该算子的离散傅里叶分析得出，对于每个波数为 $k$ 的傅里叶模，其特征值为\n$$\n\\lambda(k) = -\\,i\\,a\\,\\frac{\\sin(k h)}{h}\\;-\\;4\\,\\nu\\,\\frac{\\sin^2\\!\\left(\\frac{k h}{2}\\right)}{h^2}.\n$$\n\n你将构建一个两步预测-评估-校正-评估 (PECE) 方法，该方法使用 Adams–Bashforth 两步预测格式 (AB2) 和一个梯形 (Crank–Nicolson) 校正格式，其中校正格式使用预测值进行显式计算。具体而言：\n- 预测格式为\n$$\n\\mathbf{u}_{n+1}^{p} = \\mathbf{u}_{n} + \\frac{\\Delta t}{2}\\left(3\\,\\mathbf{A}\\,\\mathbf{u}_{n} - \\mathbf{A}\\,\\mathbf{u}_{n-1}\\right).\n$$\n- 校正格式为\n$$\n\\mathbf{u}_{n+1} = \\mathbf{u}_{n} + \\frac{\\Delta t}{2}\\left(\\mathbf{A}\\,\\mathbf{u}_{n} + \\mathbf{A}\\,\\mathbf{u}_{n+1}^{p}\\right),\n$$\n在校正格式内部使用了最后的评估值 $\\mathbf{A}\\,\\mathbf{u}_{n+1}^{p}$。\n\n从 Adams–Bashforth 显式多步法和梯形法则的基本定义出发，推导满足线性测试方程 $y'(t) = \\lambda\\,y(t)$ 的单个傅里叶模 $y_n$ 的标量两步递推关系，其中 $\\lambda \\in \\mathbb{C}$ 是 $\\mathbf{A}$ 的一个特征值，且 $y_n \\approx y(t_n)$，$t_n = n\\,\\Delta t$。然后，使用线性冯·诺依曼分析，确定以下方法的绝对稳定性边界与负实轴的交点：\n1. 纯粹的 Adams–Bashforth 两步 (AB2) 法。\n2. 上面构建的 PECE 方法。\n\n定义无量纲扩散数\n$$\nr \\;=\\; \\frac{4\\,\\nu\\,\\Delta t}{h^2}.\n$$\n注意到扩散最严格的傅里叶模出现在 $k h = \\pi$ 处（此时 $\\sin^2(k h/2) = 1$ 且 $\\sin(k h) = 0$），根据与负实轴的交点 $z = \\lambda\\,\\Delta t \\in \\mathbb{R}_{-}$，推断出每种方法的最大稳定无量纲扩散数 $r_{\\max}$，并计算其比值\n$$\n\\frac{r_{\\max}^{\\text{PECE}}}{r_{\\max}^{\\text{AB2}}}.\n$$\n\n将最终答案表示为一个无量纲数。如果你选择提供小数，请不要四舍五入，给出精确值。在推导过程中，还需基于线性测试方程的局部截断误差分析，对 PECE 方法与纯 AB2 方法的形式精度阶数进行评论，不要使用任何预先记忆的公式。",
            "solution": "用户希望分析和比较两步 Adams–Bashforth (AB2) 方法与一种特定的预测-评估-校正-评估 (PECE) 方法在半离散化平流-扩散方程上的稳定性。\n\n### 问题验证\n**第一步：提取已知条件**\n- **偏微分方程 (PDE):** $\\frac{\\partial u(x,t)}{\\partial t} + a\\,\\frac{\\partial u(x,t)}{\\partial x} = \\nu\\,\\frac{\\partial^2 u(x,t)}{\\partial x^2}$，其中 $x \\in [0,L]$ (周期性)，$t \\geq 0$，$a > 0$，$\\nu > 0$。\n- **半离散化:** 在间距为 $h$ 的均匀网格上进行二阶中心有限差分空间离散化，得到 $\\frac{d\\mathbf{u}(t)}{dt} = \\mathbf{A}\\,\\mathbf{u}(t)$。\n- **A 的特征值:** 对于波数为 $k$ 的傅里叶模，其特征值为 $\\lambda(k) = -\\,i\\,a\\,\\frac{\\sin(k h)}{h}\\;-\\;4\\,\\nu\\,\\frac{\\sin^2\\!\\left(\\frac{k h}{2}\\right)}{h^2}$。\n- **预测格式 (AB2):** $\\mathbf{u}_{n+1}^{p} = \\mathbf{u}_{n} + \\frac{\\Delta t}{2}\\left(3\\,\\mathbf{A}\\,\\mathbf{u}_{n} - \\mathbf{A}\\,\\mathbf{u}_{n-1}\\right)$。\n- **校正格式 (显式梯形):** $\\mathbf{u}_{n+1} = \\mathbf{u}_{n} + \\frac{\\Delta t}{2}\\left(\\mathbf{A}\\,\\mathbf{u}_{n} + \\mathbf{A}\\,\\mathbf{u}_{n+1}^{p}\\right)$。\n- **无量纲数:** $r = \\frac{4\\,\\nu\\,\\Delta t}{h^2}$。\n- **目标:** 确定纯 AB2 方法和 PECE 方法的绝对稳定性边界与负实轴的交点。利用此结果求出每种方法的最大稳定无量纲扩散数 $r_{\\max}$，并考虑最严格的模 $k h = \\pi$。最后计算比值 $\\frac{r_{\\max}^{\\text{PECE}}}{r_{\\max}^{\\text{AB2}}}$。\n- **附加任务:** 评论 PECE 方法相对于 AB2 的形式精度阶数。\n\n**第二步：使用提取的已知条件进行验证**\n该问题在科学上和数学上是合理的。它涉及计算流体动力学和数值分析中的标准概念：平流-扩散方程、有限差分法、半离散化以及线性多步法的冯·诺依曼稳定性分析。特定的预测-校正格式定义明确。所有需要的数据和定义均已提供，且没有矛盾之处。问题是适定的、客观的，并且需要不平凡的数学推导。\n\n**第三步：结论与行动**\n问题被判定为**有效**。我们开始求解。\n\n### 求解推导\n通过将数值方法应用于线性测试方程 $y'(t) = \\lambda y(t)$ 来分析其稳定性，其中 $\\lambda \\in \\mathbb{C}$ 是空间离散算子 $\\mathbf{A}$ 的一个特征值。在时间 $t_n = n \\Delta t$ 的数值解记为 $y_n$。我们定义无量纲参数 $z = \\lambda \\Delta t$。\n\n#### 1. Adams–Bashforth 两步 (AB2) 法的分析\n\n将 AB2 方法应用于测试方程得到：\n$$\ny_{n+1} = y_n + \\frac{\\Delta t}{2} (3 \\lambda y_n - \\lambda y_{n-1})\n$$\n代入 $z = \\lambda \\Delta t$，我们得到标量两步递推关系：\n$$\ny_{n+1} = y_n + \\frac{z}{2} (3 y_n - y_{n-1})\n$$\n$$\ny_{n+1} - \\left(1 + \\frac{3}{2}z\\right) y_n + \\frac{z}{2} y_{n-1} = 0\n$$\n为分析稳定性，我们寻求 $y_n = g^n$ 形式的解，其中 $g$ 是增长因子。将其代入递推关系，得到关于 $g$ 的特征多项式：\n$$\ng^2 - \\left(1 + \\frac{3}{2}z\\right) g + \\frac{z}{2} = 0\n$$\n如果该多项式的所有根 $g$ 都满足 $|g| \\leq 1$，且任何模为 $1$ 的根都是单根，则该方法是绝对稳定的。稳定性边界是使得至少有一个根的模为 $|g|=1$ 的点 $z \\in \\mathbb{C}$ 的轨迹。\n我们关心的是该边界与负实轴的交点，因此我们设 $z \\in \\mathbb{R}_{-}$。稳定性边界穿过该轴的点对应于根 $g=-1$。将 $g=-1$ 代入特征多项式：\n$$\n(-1)^2 - \\left(1 + \\frac{3}{2}z\\right)(-1) + \\frac{z}{2} = 0\n$$\n$$\n1 + \\left(1 + \\frac{3}{2}z\\right) + \\frac{z}{2} = 0\n$$\n$$\n2 + \\frac{3}{2}z + \\frac{1}{2}z = 0\n$$\n$$\n2 + 2z = 0 \\implies z = -1\n$$\n因此，对于纯 AB2 方法，稳定性边界在 $z_{\\text{stab}}^{\\text{AB2}} = -1$ 处与负实轴相交。\n\n#### 2. PECE 方法的分析\n\nPECE 方法由一个预测步骤和一个校正步骤组成。\n\n**预测 (P):** 将 AB2 预测格式应用于 $y' = \\lambda y$ 得到预测值 $y_{n+1}^p$：\n$$\ny_{n+1}^p = y_n + \\frac{\\Delta t}{2} (3 \\lambda y_n - \\lambda y_{n-1}) = \\left(1 + \\frac{3}{2}z\\right) y_n - \\frac{z}{2} y_{n-1}\n$$\n\n**校正 (C):** 显式梯形校正格式使用预测值：\n$$\ny_{n+1} = y_n + \\frac{\\Delta t}{2} (\\lambda y_n + \\lambda y_{n+1}^p) = y_n + \\frac{z}{2} (y_n + y_{n+1}^p) = \\left(1 + \\frac{z}{2}\\right) y_n + \\frac{z}{2} y_{n+1}^p\n$$\n现在我们将 $y_{n+1}^p$ 的表达式代入校正方程，以获得关于 $y_{n+1}$ 的单一递推关系：\n$$\ny_{n+1} = \\left(1 + \\frac{z}{2}\\right) y_n + \\frac{z}{2} \\left[ \\left(1 + \\frac{3}{2}z\\right) y_n - \\frac{z}{2} y_{n-1} \\right]\n$$\n$$\ny_{n+1} = \\left[ 1 + \\frac{z}{2} + \\frac{z}{2}\\left(1 + \\frac{3}{2}z\\right) \\right] y_n - \\frac{z^2}{4} y_{n-1}\n$$\n$$\ny_{n+1} = \\left( 1 + z + \\frac{3}{4}z^2 \\right) y_n - \\frac{z^2}{4} y_{n-1}\n$$\n这就是 PECE 方法的标量两步递推关系。其特征多项式为：\n$$\ng^2 - \\left(1 + z + \\frac{3}{4}z^2\\right) g + \\frac{z^2}{4} = 0\n$$\n为了找到与负实轴的交点，我们可以再次测试模为 $|g|=1$ 的根。边界穿过轴的点通常对应于 $g=1$ 或 $g=-1$。\n我们测试 $g=1$：\n$$\n1 - \\left(1 + z + \\frac{3}{4}z^2\\right) + \\frac{z^2}{4} = 0\n$$\n$$\n-z - \\frac{3}{4}z^2 + \\frac{1}{4}z^2 = 0\n$$\n$$\n-z - \\frac{1}{2}z^2 = 0 \\implies -z\\left(1 + \\frac{1}{2}z\\right) = 0\n$$\n这给出了两个解：$z=0$（原点）和 $z=-2$。\n我们测试 $g=-1$：\n$$\n(-1)^2 - \\left(1 + z + \\frac{3}{4}z^2\\right)(-1) + \\frac{z^2}{4} = 0\n$$\n$$\n1 + 1 + z + \\frac{3}{4}z^2 + \\frac{z^2}{4} = 0\n$$\n$$\n2 + z + z^2 = 0\n$$\n根是 $z = \\frac{-1 \\pm \\sqrt{1-8}}{2} = \\frac{-1 \\pm i\\sqrt{7}}{2}$，它们不在实轴上。\n因此，PECE 方法的稳定性边界在 $z_{\\text{stab}}^{\\text{PECE}} = -2$ 处与负实轴相交。\n\n#### 3. 形式精度阶数\n\n多步法的阶数由其局部截断误差 (LTE) 决定。LTE 是通过将精确解代入数值格式的递推关系中得到的。\nPECE 方法的递推关系是 $y_{n+1} - (1+z+\\frac{3}{4}z^2)y_n + \\frac{z^2}{4}y_{n-1} = 0$。\n我们代入精确解的值 $y(t_n)$ 和 $y(t_{n\\pm1}) = y(t_n) \\exp(\\pm z)$，其中 $z=\\lambda \\Delta t$。余项 $L$ 为：\n$$\nL = y(t_n)\\exp(z) - \\left(1+z+\\frac{3}{4}z^2\\right)y(t_n) + \\frac{z^2}{4}y(t_n)\\exp(-z)\n$$\n我们考察 $L/y(t_n)$ 在 $z=0$ 附近的泰勒级数：\n$$\n\\frac{L}{y(t_n)} = \\left(1+z+\\frac{z^2}{2!}+\\frac{z^3}{3!}+\\dots\\right) - \\left(1+z+\\frac{3}{4}z^2\\right) + \\frac{z^2}{4}\\left(1-z+\\frac{z^2}{2!}-\\dots\\right)\n$$\n按 $z$ 的幂次收集项：\n- $z^0$ 次项：$1 - 1 = 0$\n- $z^1$ 次项：$z - z = 0$\n- $z^2$ 次项：$\\frac{z^2}{2} - \\frac{3z^2}{4} + \\frac{z^2}{4} = \\left(\\frac{1}{2} - \\frac{3}{4} + \\frac{1}{4}\\right)z^2 = 0$\n- $z^3$ 次项：$\\frac{z^3}{6} - \\frac{z^3}{4} = \\left(\\frac{1}{6} - \\frac{1}{4}\\right)z^3 = -\\frac{1}{12}z^3$\n余项的主导项是 $L \\approx -\\frac{1}{12}z^3 y(t_n) = -\\frac{1}{12}(\\lambda \\Delta t)^3 y(t_n)$。由于递推关系的余项是 $O(\\Delta t^3)$，局部截断误差是 $O(\\Delta t^3)$。因此该方法是二阶精度的。标准的 AB2 方法也已知是二阶精度的。因此，这种特定的 PECE 构造并没有提高预测格式的形式精度阶数，但它确实改变了稳定性和误差常数。\n\n#### 4. 最大稳定扩散数及其比值\n\n该问题要求相对于纯扩散模的稳定性。从给定的特征值表达式 $\\lambda(k) = -\\,i\\,a\\,\\frac{\\sin(k h)}{h}\\;-\\;4\\,\\nu\\,\\frac{\\sin^2(k h/2)}{h^2}$，当平流项为零时，出现纯扩散情况。这发生在网格上可表示的最高频率模，即 $k h = \\pi$。对于此模，$\\sin(k h) = \\sin(\\pi) = 0$ 且 $\\sin^2(k h/2) = \\sin^2(\\pi/2) = 1$。\n该模的特征值为纯负实数：\n$$\n\\lambda(k=\\pi/h) = -\\frac{4\\nu}{h^2}\n$$\n$z = \\lambda \\Delta t$ 相应的值为：\n$$\nz = -\\frac{4\\nu \\Delta t}{h^2}\n$$\n问题将无量纲扩散数定义为 $r = \\frac{4\\nu \\Delta t}{h^2}$。因此，对于这个最严格的模，我们有 $z = -r$。\n稳定性极限要求 $z$ 位于稳定区域内。对于扩散问题，关键约束在负实轴上。因此，我们必须有 $|z| \\leq |z_{\\text{stab}}|$。\n这给出了条件 $r \\leq |z_{\\text{stab}}| = -z_{\\text{stab}}$。最大稳定扩散数为 $r_{\\max} = -z_{\\text{stab}}$。\n\n对于 AB2 方法：\n$$\nr_{\\max}^{\\text{AB2}} = -z_{\\text{stab}}^{\\text{AB2}} = -(-1) = 1\n$$\n对于 PECE 方法：\n$$\nr_{\\max}^{\\text{PECE}} = -z_{\\text{stab}}^{\\text{PECE}} = -(-2) = 2\n$$\n最大稳定无量纲扩散数的比值为：\n$$\n\\frac{r_{\\max}^{\\text{PECE}}}{r_{\\max}^{\\text{AB2}}} = \\frac{2}{1} = 2\n$$\n与单独的 AB2 格式相比，PECE 格式在纯扩散问题上的稳定时间步长增加了一倍，同时保持了相同的形式精度阶数。",
            "answer": "$$\n\\boxed{2}\n$$"
        },
        {
            "introduction": "一个数值解并非其所求解的原始偏微分方程的精确解，而是另一个“修正方程”的精确解，这个修正方程包含了由离散化引入的数值误差项。通过推导此修正方程，我们可以精确地识别出数值格式引入的数值耗散和数值色散，这是理解数值方法行为的深刻方式。本练习  将指导您对二阶亚当斯-巴什福斯（AB2）方法进行修正方程分析，从而揭示其内在的误差结构，这是进行高级数值分析和算法设计的关键技能。",
            "id": "3288552",
            "problem": "在计算流体动力学 (CFD) 中，通常在线性测试常微分方程 (ODE) $y'=\\lambda y$ 上分析如 Adams–Bashforth 族之类的显式多步法，以理解其稳定性和误差传播特性。考虑应用于测试 ODE 的二阶 Adams–Bashforth 方法 (AB$2$)：\n$$\ny_{n+1} \\;=\\; y_n \\;+\\; h\\left(\\tfrac{3}{2} f_n \\;-\\; \\tfrac{1}{2} f_{n-1}\\right), \\quad \\text{with} \\quad f_k \\;=\\; \\lambda\\, y_k,\n$$\n其中 $h$ 是恒定时间步长，$\\lambda \\in \\mathbb{C}$ 是空间离散化算子的特征值，且 $y_n \\approx y(t_n)$，$t_n = n h$。假设存在一个形式为\n$$\ny'(t) \\;=\\; \\Lambda(h,\\lambda)\\, y(t),\n$$\n的修正连续时间 ODE，其在 $t_n$ 处采样的精确解能够精确地再现对于足够小的 $h$ 的 AB$2$ 离散解。从该方法的定义以及离散放大因子与线性 ODE 精确指数解之间的基本关系出发，通过将离散更新与单时间步内的精确指数传播相匹配，并按 $z \\equiv h \\lambda$ 的幂次展开，来推导 $\\Lambda(h,\\lambda)$。请从第一性原理出发系统地进行推导，不要假定任何预先计算好的修正方程。\n\n然后，对于纯振荡情况 $\\lambda = \\mathrm{i}\\,\\omega$（其中 $\\omega$ 为实数），通过分别识别 $\\Lambda(h,\\lambda)$ 的虚部和实部，用 $h \\omega$ 的幂次表示，来提取领阶色散和耗散贡献。您必须将 $\\Lambda(h,\\lambda)$ 的展开式推导至 $h^3$ 阶项。\n\n请提供您最终的答案，形式为 $\\Lambda(h,\\lambda)$ 的单个闭式解析表达式，截断到 $h^3$ 阶。无需单位，也无需四舍五入。您的最终答案必须仅为一个表达式。",
            "solution": "本题要求推导修正连续时间常微分方程 (ODE) $y'(t) = \\Lambda(h,\\lambda) y(t)$ 的算子 $\\Lambda(h,\\lambda)$，该方程的精确解对应于二阶 Adams–Bashforth (AB$2$) 方法生成的离散解。分析需要在 $\\Lambda$ 的最终表达式中按 $z \\equiv h \\lambda$ 的幂次展开到 $h^3$ 阶。\n\n应用于测试常微分方程 $y' = \\lambda y$ 的二阶 Adams–Bashforth 方法由下式给出：\n$$y_{n+1} = y_n + h\\left(\\frac{3}{2} f_n - \\frac{1}{2} f_{n-1}\\right)$$\n其中 $f_k = \\lambda y_k$。将此代入格式，我们得到离散解值 $y_k$ 的线性递推关系：\n$$y_{n+1} = y_n + h\\left(\\frac{3}{2} \\lambda y_n - \\frac{1}{2} \\lambda y_{n-1}\\right)$$\n\n修正方程方法的核心假设是，数值解 $\\{y_n\\}$ 精确地位于一个连续函数 $y(t)$ 的轨迹上，该函数是修正常微分方程 $y'(t) = \\Lambda y(t)$ 的解。算子 $\\Lambda$ 依赖于原始算子 $\\lambda$ 和步长 $h$。\n\n这个修正常微分方程的精确解满足 $y(t_2) = \\exp(\\Lambda(t_2-t_1)) y(t_1)$。因此，对于恒定步长 $h = t_{n+1} - t_n$，离散值之间的关系为：\n$$y_{n+1} = y(t_n+h) = \\exp(h\\Lambda) y(t_n) = \\exp(h\\Lambda) y_n$$\n$$y_{n-1} = y(t_n-h) = \\exp(-h\\Lambda) y(t_n) = \\exp(-h\\Lambda) y_n$$\n\n我们将这些关系代入 AB$2$ 递推关系中：\n$$\\exp(h\\Lambda) y_n = y_n + h\\lambda\\left(\\frac{3}{2} y_n - \\frac{1}{2} \\exp(-h\\Lambda) y_n\\right)$$\n假设 $y_n \\neq 0$，我们可以两边同除以 $y_n$ 以获得关于 $\\Lambda$ 的隐式方程：\n$$\\exp(h\\Lambda) = 1 + \\frac{3}{2} h\\lambda - \\frac{1}{2} h\\lambda \\exp(-h\\Lambda)$$\n为了求解 $\\Lambda$，我们引入无量纲变量 $Z = h\\Lambda$ 和 $z = h\\lambda$。方程变为：\n$$\\exp(Z) = 1 + \\frac{3}{2} z - \\frac{1}{2} z \\exp(-Z)$$\n现在我们将指数函数展开为泰勒级数。\n$$\\left(1 + Z + \\frac{Z^2}{2!} + \\frac{Z^3}{3!} + \\frac{Z^4}{4!} + \\dots\\right) = 1 + \\frac{3}{2} z - \\frac{1}{2} z \\left(1 - Z + \\frac{Z^2}{2!} - \\frac{Z^3}{3!} + \\dots\\right)$$\n化简右侧得到：\n$$Z + \\frac{Z^2}{2} + \\frac{Z^3}{6} + \\frac{Z^4}{24} + \\dots = z + \\frac{1}{2} zZ - \\frac{1}{4} zZ^2 + \\frac{1}{12} zZ^3 - \\dots$$\n为了用 $\\lambda$ 表示 $\\Lambda$，我们必须求出 $Z$ 作为 $z$ 的幂级数。我们假设其形式为：\n$$Z = c_1 z + c_2 z^2 + c_3 z^3 + c_4 z^4 + \\dots$$\n将此级数代入方程，并令 $z$ 的各次幂的系数相等：\n\n对于 $z^1$ 阶项：\n在左侧 (LHS)，唯一的项是 $c_1 z$。在右侧 (RHS)，唯一的项是 $z$。\n$$c_1 = 1$$\n这证实了该方法是一致的，因为当 $h \\to 0$ 时，$\\Lambda \\to \\lambda$。\n\n对于 $z^2$ 阶项：\nLHS: $c_2 z^2 + \\frac{1}{2}(c_1 z)^2 = (c_2 + \\frac{1}{2}c_1^2)z^2$\nRHS: $\\frac{1}{2} z(c_1 z) = \\frac{1}{2}c_1 z^2$\n令系数相等：$c_2 + \\frac{1}{2}c_1^2 = \\frac{1}{2}c_1$。由于 $c_1=1$，我们得到 $c_2+\\frac{1}{2}=\\frac{1}{2}$，这意味着 $c_2=0$。\n\n对于 $z^3$ 阶项：\nLHS: $c_3 z^3 + \\frac{1}{2}(2c_1c_2 z^3) + \\frac{1}{6}(c_1 z)^3 = (c_3 + c_1 c_2 + \\frac{1}{6}c_1^3)z^3$\nRHS: $\\frac{1}{2} z(c_2 z^2) - \\frac{1}{4} z(c_1 z)^2 = (\\frac{1}{2}c_2 - \\frac{1}{4}c_1^2)z^3$\n令系数相等：$c_3 + c_1 c_2 + \\frac{1}{6}c_1^3 = \\frac{1}{2}c_2 - \\frac{1}{4}c_1^2$。由于 $c_1=1$ 且 $c_2=0$：\n$c_3 + 0 + \\frac{1}{6} = 0 - \\frac{1}{4} \\implies c_3 = -\\frac{1}{4} - \\frac{1}{6} = -\\frac{3+2}{12} = -\\frac{5}{12}$。\n\n对于 $z^4$ 阶项：\nLHS: $c_4 z^4 + \\frac{1}{2}(c_2^2 + 2c_1c_3)z^4 + \\frac{1}{6}(3c_1^2c_2)z^4 + \\frac{1}{24}c_1^4 z^4 = (c_4 + c_1c_3 + \\frac{1}{2}c_2^2 + \\frac{1}{2}c_1^2c_2 + \\frac{1}{24}c_1^4)z^4$\nRHS: $\\frac{1}{2}z(c_3z^3) - \\frac{1}{4}z(2c_1c_2z^3) + \\frac{1}{12}z(c_1z)^3 = (\\frac{1}{2}c_3 - \\frac{1}{2}c_1c_2 + \\frac{1}{12}c_1^3)z^4$\n令系数相等并代入 $c_1=1$，$c_2=0$，$c_3=-5/12$：\nLHS: $c_4 + (1)(-\\frac{5}{12}) + 0 + 0 + \\frac{1}{24} = c_4 - \\frac{10}{24} + \\frac{1}{24} = c_4 - \\frac{9}{24}$\nRHS: $\\frac{1}{2}(-\\frac{5}{12}) - 0 + \\frac{1}{12} = -\\frac{5}{24} + \\frac{2}{24} = -\\frac{3}{24}$\n所以，$c_4 - \\frac{9}{24} = -\\frac{3}{24} \\implies c_4 = \\frac{6}{24} = \\frac{1}{4}$。\n\n收集系数，得到 $Z$ 的级数为：\n$$Z = z - \\frac{5}{12}z^3 + \\frac{1}{4}z^4 + \\mathcal{O}(z^5)$$\n将 $Z=h\\Lambda$ 和 $z=h\\lambda$ 代回：\n$$h\\Lambda(h,\\lambda) = h\\lambda - \\frac{5}{12}(h\\lambda)^3 + \\frac{1}{4}(h\\lambda)^4 + \\mathcal{O}(h^5)$$\n两边同除以 $h$，我们得到 $\\Lambda(h,\\lambda)$ 截断到 $h^3$ 阶的表达式：\n$$\\Lambda(h,\\lambda) = \\lambda - \\frac{5}{12}h^2\\lambda^3 + \\frac{1}{4}h^3\\lambda^4$$\n领头误差项是 $-\\frac{5}{12}h^2\\lambda^3$，这与 AB$2$ 方法是二阶精度相符。\n\n对于纯振荡情况，我们设 $\\lambda = i\\omega$，其中 $\\omega$ 是实频率且 $i^2 = -1$。\n$$\\Lambda(h,i\\omega) = i\\omega - \\frac{5}{12}h^2(i\\omega)^3 + \\frac{1}{4}h^3(i\\omega)^4$$\n使用 $i$ 的幂：$i^3 = -i$ 和 $i^4 = 1$。\n$$\\Lambda(h,i\\omega) = i\\omega - \\frac{5}{12}h^2(-i\\omega^3) + \\frac{1}{4}h^3(\\omega^4)$$\n$$\\Lambda(h,i\\omega) = \\frac{1}{4}h^3\\omega^4 + i\\left(\\omega + \\frac{5}{12}h^2\\omega^3\\right)$$\n$\\Lambda$ 的实部和虚部决定了数值解的行为。\n实部 $\\text{Re}(\\Lambda) = \\frac{1}{4}h^3\\omega^4$ 代表数值耗散或反耗散。由于它是正的，对应于一个增长因子 $\\exp(\\text{Re}(\\Lambda)t)$，数值格式会放大振荡的振幅，因此是反耗散的 (anti-dissipative)。其效应为 $h^3$ 阶，这是领阶反耗散贡献。\n虚部 $\\text{Im}(\\Lambda) = \\omega + \\frac{5}{12}h^2\\omega^3$ 代表修正后的振荡频率。项 $\\frac{5}{12}h^2\\omega^3$ 是领阶数值色散误差。由于它是正的，高频分量（较大的 $\\omega$）在数值上传播得比它们的真实速度快，导致相位误差。\n\n本题要求给出 $\\Lambda(h,\\lambda)$ 截断到 $h^3$ 阶的单个闭式表达式。这就是在对振荡情况进行具体分析之前推导出的表达式。",
            "answer": "$$\\boxed{\\lambda - \\frac{5}{12}h^2\\lambda^3 + \\frac{1}{4}h^3\\lambda^4}$$"
        }
    ]
}