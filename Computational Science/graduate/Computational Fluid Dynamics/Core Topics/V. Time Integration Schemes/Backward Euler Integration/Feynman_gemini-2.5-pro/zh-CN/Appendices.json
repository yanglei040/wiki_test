{
    "hands_on_practices": [
        {
            "introduction": "本练习将后向欧拉法应用于一个经典的流体动力学问题——斯托克斯第一问题，该问题可简化为一维扩散方程。通过为单个时间步建立并求解所产生的线性方程组，您将亲身体验隐式格式的核心操作机制。这个基础实践旨在巩固您对离散化过程以及如何从偏微分方程得到一个必须在每个时间步求解的代数系统的理解 。",
            "id": "3293764",
            "problem": "考虑一个不可压缩牛顿流体在突然启动的无限大平板上方所产生的斯托克斯第一问题。设在 $y=0$ 处的平板于时间 $t=0^{+}$ 时，以恒定速度 $U$ 沿 $x$ 方向开始运动，而在 $t=0$ 时，$y>0$ 区域的流体处于静止状态。在标准的单向流、流向均匀以及流向压力梯度为零的假设下，$x$ 方向的动量平衡方程简化为扩散偏微分方程（PDE）\n$$\\frac{\\partial u}{\\partial t}=\\nu\\,\\frac{\\partial^{2}u}{\\partial y^{2}},\\quad y\\ge 0,\\; t>0,$$\n其初始条件和边界条件为\n$$u(y,0)=0,\\quad u(0,t)=U,\\quad \\lim_{y\\to\\infty}u(y,t)=0.$$\n对于有限域数值近似，将域截断为 $y\\in[0,L]$，其中 $L$ 足够大，并施加 $u(L,t)=0$ 作为远场边界条件。将 $[0,L]$ 均匀离散为 $M$ 个等长子区间，每个子区间的长度为 $h=L/M$，从而得到网格点 $y_{j}=j\\,h$，其中 $j=0,1,\\dots,M$。设 $u_{j}^{n}\\approx u(y_{j},t^{n})$，其中 $t^{n}=n\\,\\Delta t$。使用后向欧拉法进行时间积分，并使用二阶中心有限差分法在空间上对内部节点 $j=1,\\dots,M-1$ 处的偏微分方程进行近似：\n$$\\frac{u_{j}^{n+1}-u_{j}^{n}}{\\Delta t}=\\nu\\,\\frac{u_{j+1}^{n+1}-2u_{j}^{n+1}+u_{j-1}^{n+1}}{h^{2}}.$$\n假设在新的时间层级上施加脉冲边界条件，$u_{0}^{n+1}=U$（对于 $n\\ge 0$），而远场边界条件为 $u_{M}^{n+1}=0$；初始内部状态为静止，$u_{j}^{0}=0$（对于 $j=1,\\dots,M-1$）。\n\n取以下具体的、物理上一致的参数\n$$\\nu=0.01\\,\\mathrm{m^{2}/s},\\quad U=1\\,\\mathrm{m/s},\\quad L=0.3\\,\\mathrm{m},\\quad M=3,\\quad \\Delta t=1\\,\\mathrm{s}.$$\n这些参数意味着 $h=L/M=0.1\\,\\mathrm{m}$ 以及 $y_{1}=0.1\\,\\mathrm{m}$，$y_{2}=0.2\\,\\mathrm{m}$。执行从 $t^{0}=0$ 到 $t^{1}=\\Delta t$ 的单步后向欧拉法，精确求解得到的关于内部未知数 $u_{1}^{1}$ 和 $u_{2}^{1}$ 的线性方程组。\n\n斯托克斯第一问题的精确解析解为\n$$u(y,t)=U\\,\\mathrm{erfc}\\!\\Bigg(\\frac{y}{2\\sqrt{\\nu t}}\\Bigg),$$\n其中 $\\mathrm{erfc}$ 表示互补误差函数。使用此解析解，计算在时间 $t^{1}$ 时内部节点上的离散均方根（RMS）误差，\n$$E_{\\mathrm{RMS}}=\\sqrt{\\frac{1}{M-1}\\sum_{j=1}^{M-1}\\Big(u_{j}^{1}-u(y_{j},t^{1})\\Big)^{2}}.$$\n\n计算指定参数下的 $E_{\\mathrm{RMS}}$。最终答案以 $\\mathrm{m/s}$ 为单位，并四舍五入到四位有效数字。",
            "solution": "首先对问题陈述进行严格的验证过程。\n\n### 步骤 1：提取已知条件\n-   **控制方程**：$x$ 方向动量平衡由扩散偏微分方程给出：\n    $$\\frac{\\partial u}{\\partial t}=\\nu\\,\\frac{\\partial^{2}u}{\\partial y^{2}},\\quad y\\ge 0,\\; t>0$$\n-   **初始和边界条件（解析）**：\n    -   初始条件：$u(y,0)=0$。\n    -   边界条件：$u(0,t)=U$，$\\lim_{y\\to\\infty}u(y,t)=0$。\n-   **数值离散化**：\n    -   截断域：$y\\in[0,L]$。\n    -   离散化参数：$M$ 个子区间，$h=L/M$，$y_j=j\\,h$（对于 $j=0,1,\\dots,M$）。\n    -   时间步长：$\\Delta t$，$t^n = n\\,\\Delta t$。\n    -   符号表示：$u_j^n \\approx u(y_j, t^n)$。\n    -   有限差分格式（时间上为后向欧拉法，空间上为二阶中心差分）：\n        $$\\frac{u_{j}^{n+1}-u_{j}^{n}}{\\Delta t}=\\nu\\,\\frac{u_{j+1}^{n+1}-2u_{j}^{n+1}+u_{j-1}^{n+1}}{h^{2}}$$\n    -   数值初始条件：$u_j^0 = 0$（对于 $j=1,\\dots,M-1$）。\n    -   数值边界条件：$u_0^{n+1}=U$（对于 $n\\ge 0$），$u_M^{n+1}=0$。\n-   **物理和数值参数**：\n    -   运动粘度：$\\nu=0.01\\,\\mathrm{m^{2}/s}$。\n    -   平板速度：$U=1\\,\\mathrm{m/s}$。\n    -   域长度：$L=0.3\\,\\mathrm{m}$。\n    -   子区间数量：$M=3$。\n    -   时间步长大小：$\\Delta t=1\\,\\mathrm{s}$。\n-   **精确解析解**：\n    $$u(y,t)=U\\,\\mathrm{erfc}\\!\\Bigg(\\frac{y}{2\\sqrt{\\nu t}}\\Bigg)$$\n-   **误差度量**：在 $t^1$ 时刻内部节点上的离散均方根（RMS）误差。\n    $$E_{\\mathrm{RMS}}=\\sqrt{\\frac{1}{M-1}\\sum_{j=1}^{M-1}\\Big(u_{j}^{1}-u(y_{j},t^{1})\\Big)^{2}}$$\n-   **任务**：计算给定参数下的 $E_{\\mathrm{RMS}}$，并四舍五入到四位有效数字。\n\n### 步骤 2：使用提取的已知条件进行验证\n1.  **科学依据**：该问题基于斯托克斯第一问题，这是纳维-斯托克斯方程的一个基本精确解，可用扩散（或热）方程建模。所使用的数值方法，后向欧拉法，是一种标准的、经过充分分析的隐式格式。所有原理在科学和数学上都是合理的。\n2.  **适定性**：该偏微分方程及其给定的初始和边界条件是一个经典的适定问题。数值任务也是适定的；后向欧拉法是无条件稳定的，对于给定的参数，它产生一个非奇异的线性方程组，保证了唯一解的存在。\n3.  **客观性**：问题以精确、定量和客观的语言陈述，没有歧义或主观论断。\n4.  **完整性和一致性**：提供了所有必要的数据、方程和条件。参数在物理上是一致的。任务定义清晰。\n5.  **非病态或结构不良**：问题结构清晰，引导求解者从数值设置到误差计算。问题没有歧义。\n\n### 步骤 3：结论与行动\n问题是**有效的**。这是一个计算流体力学和数值分析中的标准、定义明确的练习。现在开始求解过程。\n\n#### 在 $t^1$ 时的数值解\n所提供的有限差分格式为：\n$$\\frac{u_{j}^{n+1}-u_{j}^{n}}{\\Delta t}=\\nu\\,\\frac{u_{j+1}^{n+1}-2u_{j}^{n+1}+u_{j-1}^{n+1}}{h^{2}}$$\n我们重新整理这个方程，以分离出新时间层级 $n+1$ 的项：\n$$u_{j}^{n+1} - \\frac{\\nu \\Delta t}{h^2} \\left(u_{j+1}^{n+1}-2u_{j}^{n+1}+u_{j-1}^{n+1}\\right) = u_{j}^{n}$$\n令 $r = \\frac{\\nu \\Delta t}{h^2}$ 为扩散数。方程变为：\n$$-r u_{j-1}^{n+1} + (1+2r)u_{j}^{n+1} - r u_{j+1}^{n+1} = u_{j}^{n}$$\n给定参数 $\\nu=0.01\\,\\mathrm{m^2/s}$，$L=0.3\\,\\mathrm{m}$，$M=3$ 和 $\\Delta t=1\\,\\mathrm{s}$。空间网格间距 $h$ 为：\n$$h = \\frac{L}{M} = \\frac{0.3}{3} = 0.1\\,\\mathrm{m}$$\n扩散数 $r$ 为：\n$$r = \\frac{(0.01\\,\\mathrm{m^2/s})(1\\,\\mathrm{s})}{(0.1\\,\\mathrm{m})^2} = \\frac{0.01}{0.01} = 1$$\n我们想要求解第一个时间步 $t^1 = \\Delta t = 1\\,\\mathrm{s}$ 时的解。未知数是内部节点处的速度 $u_1^1$ 和 $u_2^1$（因为 $M=3$，内部节点为 $j=1,2$）。初始条件为 $u_1^0 = 0$ 和 $u_2^0 = 0$。在时间 $t^1$ 时的边界条件为 $u_0^1 = U = 1$ 和 $u_3^1 = 0$。\n\n我们为每个内部节点 $j=1,2$ 写出差分格式：\n对于 $j=1$：\n$$-r u_{0}^{1} + (1+2r)u_{1}^{1} - r u_{2}^{1} = u_{1}^{0}$$\n代入已知值（$r=1$，$u_0^1=1$，$u_1^0=0$）：\n$$-(1)(1) + (1+2(1))u_{1}^{1} - (1)u_{2}^{1} = 0 \\implies 3u_{1}^{1} - u_{2}^{1} = 1$$\n对于 $j=2$：\n$$-r u_{1}^{1} + (1+2r)u_{2}^{1} - r u_{3}^{1} = u_{2}^{0}$$\n代入已知值（$r=1$，$u_3^1=0$，$u_2^0=0$）：\n$$-(1)u_{1}^{1} + (1+2(1))u_{2}^{1} - (1)(0) = 0 \\implies -u_{1}^{1} + 3u_{2}^{1} = 0$$\n我们现在求解这个 $2 \\times 2$ 线性系统：\n$$3u_{1}^{1} - u_{2}^{1} = 1$$\n$$-u_{1}^{1} + 3u_{2}^{1} = 0$$\n从第二个方程得到 $u_{1}^{1} = 3u_{2}^{1}$。将其代入第一个方程：\n$$3(3u_{2}^{1}) - u_{2}^{1} = 1 \\implies 9u_2^1 - u_2^1 = 1 \\implies 8u_2^1 = 1 \\implies u_2^1 = \\frac{1}{8} = 0.125$$\n那么，$u_{1}^{1} = 3 \\left(\\frac{1}{8}\\right) = \\frac{3}{8} = 0.375$。\n数值解为 $u_1^1 = 0.375\\,\\mathrm{m/s}$ 和 $u_2^1 = 0.125\\,\\mathrm{m/s}$。\n\n#### 在 $t^1$ 时的精确解\n精确解为 $u(y,t)=U\\,\\mathrm{erfc}\\!\\left(\\frac{y}{2\\sqrt{\\nu t}}\\right)$。\n我们在 $t^1 = 1\\,\\mathrm{s}$ 时刻，对内部节点 $y_1=h=0.1\\,\\mathrm{m}$ 和 $y_2=2h=0.2\\,\\mathrm{m}$ 计算该解。\nerfc 函数的自变量为 $\\frac{y}{2\\sqrt{\\nu t}} = \\frac{y}{2\\sqrt{(0.01)(1)}} = \\frac{y}{0.2} = 5y$。\n当 $U=1$ 时，$u(y,1) = \\mathrm{erfc}(5y)$。\n\n对于 $j=1$ ($y_1=0.1\\,\\mathrm{m}$)：\n$$u(y_1, t^1) = \\mathrm{erfc}(5 \\times 0.1) = \\mathrm{erfc}(0.5) \\approx 0.47950012$$\n对于 $j=2$ ($y_2=0.2\\,\\mathrm{m}$)：\n$$u(y_2, t^1) = \\mathrm{erfc}(5 \\times 0.2) = \\mathrm{erfc}(1.0) \\approx 0.15729921$$\n\n#### 均方根误差计算\n均方根误差由下式给出：\n$$E_{\\mathrm{RMS}}=\\sqrt{\\frac{1}{M-1}\\sum_{j=1}^{M-1}\\Big(u_{j}^{1}-u(y_{j},t^{1})\\Big)^{2}} = \\sqrt{\\frac{1}{2}\\left[\\left(u_1^1 - u(y_1,t^1)\\right)^2 + \\left(u_2^1 - u(y_2,t^1)\\right)^2\\right]}$$\n每个节点上的误差为：\n$$e_1 = u_1^1 - u(y_1,t^1) = 0.375 - 0.47950012 = -0.10450012$$\n$$e_2 = u_2^1 - u(y_2,t^1) = 0.125 - 0.15729921 = -0.03229921$$\n现在我们计算均方根误差：\n$$E_{\\mathrm{RMS}} = \\sqrt{\\frac{1}{2}\\left[(-0.10450012)^2 + (-0.03229921)^2\\right]}$$\n$$E_{\\mathrm{RMS}} = \\sqrt{\\frac{1}{2}\\left[0.010920275 + 0.001043239\\right]}$$\n$$E_{\\mathrm{RMS}} = \\sqrt{\\frac{1}{2}(0.011963514)}$$\n$$E_{\\mathrm{RMS}} = \\sqrt{0.005981757}$$\n$$E_{\\mathrm{RMS}} \\approx 0.077341814\\,\\mathrm{m/s}$$\n四舍五入到四位有效数字，结果为 $0.07734$。",
            "answer": "$$ \\boxed{0.07734} $$"
        },
        {
            "introduction": "虽然稳定性是数值方法的一个关键特性，但仅有稳定性并不足以保证计算结果的准确性。本练习探讨了后向欧拉法在模拟振荡现象（如涡旋脱落）时的精度限制，这在计算流体动力学中至关重要。通过分析一个简化的线性振荡模型，您将量化数值阻尼（振幅误差）和相位误差，并确定为满足给定的精度要求，每个周期所需的最少时间步数 。",
            "id": "3293686",
            "problem": "在中等雷诺数下，二维圆柱尾流表现出与频率为 $f$ 的涡旋脱落相关的主导谐波。在与不可压缩Navier–Stokes方程围绕周期轨道线性化相一致的简化单模态表示中，主导脱落模态的复模态振幅 $a(t)$（在主阶上）由一个线性振荡常微分方程控制：\n$$\n\\frac{d a}{d t} = i \\, \\omega \\, a, \\quad \\omega = 2 \\pi f,\n$$\n其中 $i$ 是虚数单位，$\\omega$ 是角频率。考虑使用具有均匀时间步长 $\\Delta t$ 的后向欧拉方法对该模态进行时间积分。令 $N$ 表示在一个脱落周期 $T = 1/f$ 内所取的时间步数。\n\n仅使用后向欧拉方法的定义和复指数的基本性质，推导一个周期内的数值放大因子，并将一个周期后的累积振幅衰减和相位误差量化为无量纲步长 $z = \\omega \\Delta t$ 的函数。在一个周期内施加以下精度要求：\n- 相对振幅损失不得超过 $0.05$。\n- 绝对相位误差不得超过 $0.1$ 弧度。\n\n确定后向欧拉方法为满足这两个要求所需的每周期最小时间步数 $N_{\\min}$。将您的答案表示为一个给出每周期步数的实数，并将答案四舍五入到两位有效数字。最终答案中不需要物理单位。",
            "solution": "问题陈述经评估有效。这是一个在应用于计算流体动力学的数值分析领域中，提法恰当且具有科学依据的问题。它自成体系，提供了所有必要的数据和定义，并且没有矛盾或含糊之处。\n\n问题要求在使用后向欧拉方法积分一个线性常微分方程时，在数值振幅和相位误差的约束下，求出每周期的最小时间步数 $N_{\\min}$。\n\n控制复模态振幅 $a(t)$ 的常微分方程为：\n$$\n\\frac{d a}{d t} = i \\, \\omega \\, a\n$$\n其中 $i$ 是虚数单位，$\\omega$ 是实值角频率。\n\n后向欧拉方法是一种隐式一阶时间积分格式。对于一个通用的常微分方程 $\\frac{dy}{dt} = F(y)$，其离散化形式为：\n$$\n\\frac{y_{n+1} - y_n}{\\Delta t} = F(y_{n+1})\n$$\n其中 $\\Delta t$ 是时间步长，而 $y_n$ 是 $y(t_n)$ 的数值近似。将此应用于给定方程，我们得到：\n$$\n\\frac{a_{n+1} - a_n}{\\Delta t} = i \\, \\omega \\, a_{n+1}\n$$\n我们求解 $a_{n+1}$ 以确定数值放大因子 $G$，其定义为 $G = \\frac{a_{n+1}}{a_n}$。\n$$\na_{n+1} - a_n = i \\, \\omega \\, \\Delta t \\, a_{n+1}\n$$\n$$\na_{n+1} (1 - i \\, \\omega \\, \\Delta t) = a_n\n$$\n$$\nG = \\frac{a_{n+1}}{a_n} = \\frac{1}{1 - i \\, \\omega \\, \\Delta t}\n$$\n问题定义了一个无量纲步长 $z = \\omega \\Delta t$。放大因子变为：\n$$\nG = \\frac{1}{1 - i z}\n$$\n为了分析该格式的振幅和相位特性，我们将 $G$ 表示为极坐标形式，$G = |G| \\exp(i\\phi_{\\text{num}})$。模 $|G|$ 控制单步的振幅变化，而辐角 $\\phi_{\\text{num}}$ 是每步的数值相位变化。\n模为：\n$$\n|G| = \\left| \\frac{1}{1 - i z} \\right| = \\frac{1}{|1 - i z|} = \\frac{1}{\\sqrt{1^2 + (-z)^2}} = \\frac{1}{\\sqrt{1 + z^2}} = (1+z^2)^{-1/2}\n$$\n由于 $z = \\omega \\Delta t > 0$，我们有 $|G|  1$，这表明后向欧拉方法是数值耗散的，在每一步都会衰减振幅。\n\n相位为：\n$$\n\\phi_{\\text{num}} = \\arg(G) = \\arg(1) - \\arg(1 - i z) = 0 - \\arctan\\left(\\frac{-z}{1}\\right) = \\arctan(z)\n$$\n作为比较，常微分方程在一个时间步长内的精确解是 $a(t_n+\\Delta t) = a(t_n) \\exp(i \\omega \\Delta t)$。精确放大因子是 $G_{\\text{exact}} = \\exp(i z)$。其模为 $|G_{\\text{exact}}| = 1$，相位为 $\\phi_{\\text{exact}} = z$。后向欧拉方法同时引入了振幅误差（因为 $|G|  1$）和相位误差（因为 $\\phi_{\\text{num}} \\neq \\phi_{\\text{exact}}$）。\n\n我们现在必须评估一个脱落周期 $T = 1/f$ 内的累积误差。每周期的时间步数是 $N$，使得 $N \\Delta t = T$。一个关键关系是 $N z = N (\\omega \\Delta t) = \\omega (N \\Delta t) = \\omega T = (2\\pi f) (1/f) = 2\\pi$。\n\n经过 $N$ 步后，数值解为 $a_N = G^N a_0$。精确解为 $a(T) = \\exp(i\\omega T) a_0 = \\exp(i 2\\pi) a_0 = a_0$。\n\n**1. 振幅衰减约束**\n一个周期内的相对振幅损失定义为 $\\frac{|a_0| - |a_N|}{|a_0|} = 1 - \\frac{|a_N|}{|a_0|}$。这不得超过 $0.05$。\n$$\n1 - \\frac{|G^N a_0|}{|a_0|} = 1 - |G|^N \\le 0.05\n$$\n$$\n|G|^N \\ge 0.95\n$$\n代入 $|G| = (1+z^2)^{-1/2}$：\n$$\n((1+z^2)^{-1/2})^N \\ge 0.95 \\implies (1+z^2)^{-N/2} \\ge 0.95\n$$\n对两边取自然对数：\n$$\n-\\frac{N}{2} \\ln(1+z^2) \\ge \\ln(0.95)\n$$\n$$\nN \\ln(1+z^2) \\le -2 \\ln(0.95) = 2 \\ln\\left(\\frac{1}{0.95}\\right)\n$$\n对于大的步数 $N$，$z = 2\\pi/N$ 将会很小。我们对小的 $x$ 使用泰勒近似 $\\ln(1+x) \\approx x$。因此，$\\ln(1+z^2) \\approx z^2$。\n$$\nN z^2 \\le 2 \\ln\\left(\\frac{1}{0.95}\\right)\n$$\n代入 $z = 2\\pi/N$：\n$$\nN \\left( \\frac{2\\pi}{N} \\right)^2 \\le 2 \\ln\\left(\\frac{1}{0.95}\\right) \\implies \\frac{4\\pi^2}{N} \\le 2 \\ln\\left(\\frac{1}{0.95}\\right)\n$$\n求解 $N$ 得到振幅约束所要求的最小步数 $N_{\\text{amp}}$：\n$$\nN \\ge \\frac{2\\pi^2}{\\ln(1/0.95)} \\equiv N_{\\text{amp}}\n$$\n\n**2. 相位误差约束**\n一个周期内的累积数值相位是 $\\Phi_{\\text{num}} = N \\phi_{\\text{num}} = N \\arctan(z)$。精确相位是 $\\Phi_{\\text{exact}} = \\omega T = 2\\pi$。绝对相位误差是 $|\\Phi_{\\text{exact}} - \\Phi_{\\text{num}}|$，其不得超过 $0.1$ 弧度。\n$$\n|2\\pi - N \\arctan(z)| \\le 0.1\n$$\n代入 $N = 2\\pi/z$：\n$$\n\\left|2\\pi - \\frac{2\\pi}{z} \\arctan(z)\\right| \\le 0.1 \\implies 2\\pi \\left|1 - \\frac{\\arctan(z)}{z}\\right| \\le 0.1\n$$\n对于 $z > 0$，$\\arctan(z)  z$，所以绝对值内的项是正的。\n$$\n2\\pi \\left(1 - \\frac{\\arctan(z)}{z}\\right) \\le 0.1\n$$\n对于小的 $z$，我们使用泰勒级数 $\\arctan(z) \\approx z - z^3/3$。因此，$\\frac{\\arctan(z)}{z} \\approx 1 - z^2/3$。\n$$\n2\\pi \\left(1 - \\left(1 - \\frac{z^2}{3}\\right)\\right) \\approx 2\\pi \\frac{z^2}{3} \\le 0.1\n$$\n$$\nz^2 \\le \\frac{0.3}{2\\pi}\n$$\n代入 $z = 2\\pi/N$：\n$$\n\\left(\\frac{2\\pi}{N}\\right)^2 \\le \\frac{0.3}{2\\pi} \\implies \\frac{4\\pi^2}{N^2} \\le \\frac{0.3}{2\\pi}\n$$\n求解 $N$ 得到相位约束所要求的最小步数 $N_{\\text{phase}}$：\n$$\nN^2 \\ge \\frac{8\\pi^3}{0.3} \\implies N \\ge \\sqrt{\\frac{8\\pi^3}{0.3}} \\equiv N_{\\text{phase}}\n$$\n\n**3. 计算与结论**\n现在我们计算 $N_{\\text{amp}}$ 和 $N_{\\text{phase}}$ 的数值。\n对于振幅约束：\n$$\nN_{\\text{amp}} = \\frac{2\\pi^2}{\\ln(1/0.95)} \\approx \\frac{2(9.8696044)}{- (-0.05129329)} \\approx \\frac{19.7392088}{0.05129329} \\approx 384.84\n$$\n对于相位约束：\n$$\nN_{\\text{phase}} = \\sqrt{\\frac{8\\pi^3}{0.3}} \\approx \\sqrt{\\frac{8(31.006276)}{0.3}} \\approx \\sqrt{\\frac{248.0502}{0.3}} \\approx \\sqrt{826.834} \\approx 28.75\n$$\n为满足两个约束，$N$ 必须大于或等于两个下界的最大值：\n$$\nN_{\\min} = \\max(N_{\\text{amp}}, N_{\\text{phase}}) = \\max(384.84, 28.75) = 384.84\n$$\n问题要求将此值四舍五入到两位有效数字。数字 $384.84$ 用科学记数法表示为 $3.8484 \\times 10^2$。四舍五入到两位有效数字得到 $3.8 \\times 10^2$。",
            "answer": "$$\\boxed{3.8 \\times 10^{2}}$$"
        },
        {
            "introduction": "在处理包含不同时间尺度的物理过程时，例如刚性的扩散项和非刚性的对流项，隐式-显式（IMEX）方法提供了一种高效且稳定的解决方案。本练习要求您为一个一维对流-扩散问题开发并实现一个IMEX格式，并将其与完全隐式格式进行比较。通过理论分析其稳定性，并结合在傅里叶空间中的数值实现，您将深入探究不同格式在精度、稳定性和计算成本之间的权衡 。",
            "id": "3293758",
            "problem": "考虑周期域上的一维线性平流-扩散初值问题，\n$$\n\\frac{\\partial u}{\\partial t} + a \\frac{\\partial u}{\\partial x} = \\nu \\frac{\\partial^2 u}{\\partial x^2}, \\quad x \\in [0,L], \\quad t \\ge 0,\n$$\n其边界条件为周期性边界条件，初始条件为\n$$\nu(x,0) = \\sin\\!\\big(2\\pi k_0 x\\big).\n$$\n您将构建并分析一个隐式-显式 (IMEX) 时间积分方案，该方案使用后向欧拉法隐式处理扩散项，显式处理平流项；您还需要将其与一个使用后向欧拉法同时隐式处理平流项和扩散项的全隐式方案进行比较。空间离散化必须在均匀周期网格上使用相容的有限差分格式进行，时间步进必须应用于所得到的线方法半离散系统。\n\n您必须从第一性原理出发，按以下步骤进行。\n\n- 从偏微分方程出发，在具有 $N$ 个点和网格间距 $\\Delta x = L/N$ 的均匀周期网格上进行空间离散化。\n- 使用一阶迎风差分格式近似平流导数（假设 $a \\ge 0$）：\n$$\n\\left(\\frac{\\partial u}{\\partial x}\\right)_i \\approx \\frac{u_i - u_{i-1}}{\\Delta x}.\n$$\n- 使用标准的中心二阶差分格式近似扩散二阶导数：\n$$\n\\left(\\frac{\\partial^2 u}{\\partial x^2}\\right)_i \\approx \\frac{u_{i+1} - 2 u_i + u_{i-1}}{\\Delta x^2}.\n$$\n- 以线方法的方式，构建从 $t^n$ 到 $t^{n+1}=t^n+\\Delta t$ 的单个时间步长的 IMEX 后向欧拉-前向欧拉更新格式：\n$$\n\\big(I - \\Delta t \\, \\nu D_2\\big) \\, \\mathbf{u}^{n+1} = \\mathbf{u}^n - \\Delta t \\, a \\, D_\\text{up} \\, \\mathbf{u}^n,\n$$\n其中 $D_\\text{up}$ 是周期网格上的迎风一阶导数矩阵，$D_2$ 是中心二阶导数矩阵。\n- 构建同时隐式处理两项的全隐式后向欧拉更新格式：\n$$\n\\big(I + \\Delta t \\, a \\, D_\\text{up} - \\Delta t \\, \\nu D_2\\big) \\, \\mathbf{u}^{n+1} = \\mathbf{u}^n.\n$$\n\n通过冯·诺依曼稳定性分析，推导 IMEX 方案的显式平流稳定性限制，并证明时间步长必须满足\n$$\n\\Delta t \\le \\frac{\\Delta x}{|a|}.\n$$\n清晰地说明推导过程中使用的任何假设，并解释为何使用后向欧拉法处理扩散项时不会引入额外的限制。\n\n您将使用周期性均匀网格和周期性差分算子实现这两种方案。为了在周期网格上实现线性求解的效率和数值精确性，您必须通过离散傅里叶变换对循环算子进行对角化，并利用 $D_\\text{up}$ 和 $D_2$ 的符号，在傅里叶空间中逐模式地实现这些步骤：\n$$\n\\widehat{D_\\text{up}}(\\theta) = \\frac{1 - e^{-i\\theta}}{\\Delta x}, \\qquad \\widehat{D_2}(\\theta) = \\frac{e^{i\\theta} - 2 + e^{-i\\theta}}{\\Delta x^2} = -\\frac{4\\sin^2(\\theta/2)}{\\Delta x^2},\n$$\n其中 $\\theta = 2\\pi m/N$，$m \\in \\{0,1,\\dots,N-1\\}$。\n\n使用所选初始条件下连续问题的精确解，\n$$\nu_\\text{exact}(x,t) = \\exp\\!\\big(-\\nu (2\\pi k_0)^2 t\\big) \\, \\sin\\!\\big(2\\pi k_0 (x - a t)\\big),\n$$\n来计算最终时间 $T$ 的离散 $L^2$ 误差：\n$$\n\\|e\\|_2 = \\left(\\Delta x \\sum_{j=0}^{N-1} \\big(u_j(T) - u_\\text{exact}(x_j,T)\\big)^2 \\right)^{1/2}.\n$$\n\n您的程序必须实现以下具有共享参数和多种粘性系数方案的测试套件：\n- 共享参数：$L = 1$，$a = 1$，$k_0 = 2$，$N = 256$，$T = 0.5$。\n- 粘性系数值：$\\nu \\in \\{10^{-4}, 10^{-2}, 10^{-1}\\}$。\n\n对于测试套件中的每个粘性系数 $\\nu$：\n- 计算由您的推导所暗示的显式 Courant–Friedrichs–Lewy 时间步长限制 $\\Delta t_\\text{CFL} = \\Delta x / |a|$。\n- 运行 IMEX 方案，步长为 $\\Delta t = 0.9 \\, \\Delta t_\\text{CFL}$，使用均匀的步数以精确达到最终时间 $T$（即，选择步数 $M = \\lceil T/\\Delta t \\rceil$，然后设置 $\\Delta t = T/M$）。\n- 使用与 IMEX 运行相同的 $\\Delta t$ 和步数 $M$ 运行全隐式方案。\n- 此外，使用一个四倍大的名义步长 $\\tilde{\\Delta t} = 4 \\times 0.9 \\, \\Delta t_\\text{CFL}$ 运行全隐式方案，同样选择步数 $\\tilde{M} = \\lceil T/\\tilde{\\Delta t} \\rceil$，然后设置 $\\tilde{\\Delta t} = T/\\tilde{M}$。\n\n对于每个粘性系数 $\\nu$，报告以下七个量：\n- 稳定性限制 $\\Delta t_\\text{CFL}$。\n- IMEX 方案在时间 $T$ 时使用上述 $\\Delta t$ 的离散 $L^2$ 误差。\n- 全隐式方案在时间 $T$ 时使用相同 $\\Delta t$ 的离散 $L^2$ 误差。\n- 全隐式方案在时间 $T$ 时使用较粗步长 $\\tilde{\\Delta t}$ 的离散 $L^2$ 误差。\n- IMEX 运行使用的时间步数 $M$。\n- 全隐式运行在相同 $\\Delta t$ 下使用的时间步数 $M$。\n- 全隐式运行在较粗步长下使用的时间步数 $\\tilde{M}$。\n\n最终输出格式要求：\n- 您的程序应生成单行输出，其中包含所有粘性系数的结果，按测试套件中粘性系数的顺序连接，形式为用方括号括起来的逗号分隔列表。例如，输出应如下所示\n$$\n[\\Delta t_{\\text{CFL},1}, \\|e\\|_{\\text{IMEX},1}, \\|e\\|_{\\text{IMP},1}, \\|e\\|_{\\text{IMP-4x},1}, M_1, M_1, \\tilde{M}_1, \\Delta t_{\\text{CFL},2}, \\dots ].\n$$\n所有报告的值必须是实数或整数。本问题中不使用角度，并且由于所有参数都是无量纲构造的，因此无需报告物理单位。",
            "solution": "该问题要求对周期域上的一维线性平流-扩散方程构建、分析和实现两种数值方案。验证过程确认了该问题在科学上是合理的、适定的和自洽的，所有必要的参数、方程和方法都已明确指定。我们着手进行求解。\n\n### 1. 问题构建与空间离散化\n\n控制偏微分方程 (PDE) 是线性平流-扩散方程：\n$$\n\\frac{\\partial u}{\\partial t} + a \\frac{\\partial u}{\\partial x} = \\nu \\frac{\\partial^2 u}{\\partial x^2}\n$$\n对于 $x \\in [0,L]$ 和 $t \\ge 0$，其中平流系数 $a \\ge 0$，粘性系数 $\\nu \\ge 0$，并采用周期性边界条件。初始条件由单个正弦模态给出：\n$$\nu(x,0) = \\sin(2\\pi k_0 x)\n$$\n\n我们使用一个包含 $N$ 个点的均匀网格 $x_j = j \\Delta x$（$j=0, 1, \\dots, N-1$）对空间域 $[0,L]$ 进行离散化，网格间距为 $\\Delta x = L/N$。令 $u_j(t)$ 为 $u(x_j, t)$ 的数值近似。\n\n空间导数按指定使用有限差分进行近似：\n- 一阶平流导数使用一阶迎风格式近似（因为 $a \\ge 0$）：\n$$\na \\left(\\frac{\\partial u}{\\partial x}\\right)_{x_j} \\approx a \\frac{u_j(t) - u_{j-1}(t)}{\\Delta x}\n$$\n- 二阶扩散导数使用二阶中心差分格式近似：\n$$\n\\nu \\left(\\frac{\\partial^2 u}{\\partial x^2}\\right)_{x_j} \\approx \\nu \\frac{u_{j+1}(t) - 2u_j(t) + u_{j-1}(t)}{\\Delta x^2}\n$$\n由于周期性边界条件，索引按模 $N$ 计算，即 $u_{-1} \\equiv u_{N-1}$ 且 $u_N \\equiv u_0$。\n\n将这些近似代入 PDE，得到一个耦合常微分方程组 (ODEs)，这种技术称为线方法：\n$$\n\\frac{d u_j}{dt} = -a \\left(\\frac{u_j - u_{j-1}}{\\Delta x}\\right) + \\nu \\left(\\frac{u_{j+1} - 2u_j + u_{j-1}}{\\Delta x^2}\\right)\n$$\n该系统可以写成矩阵形式：\n$$\n\\frac{d\\mathbf{u}}{dt} = -a D_{\\text{up}} \\mathbf{u} + \\nu D_2 \\mathbf{u} \\equiv \\mathcal{L}(\\mathbf{u})\n$$\n其中 $\\mathbf{u}(t) = [u_0(t), u_1(t), \\dots, u_{N-1}(t)]^T$，$D_{\\text{up}}$ 和 $D_2$ 分别是表示迎风一阶导数和中心二阶导数算子的循环矩阵。\n\n### 2. 时间积分方案\n\n我们使用均匀的时间步长 $\\Delta t$ 进行时间离散化。令 $\\mathbf{u}^n$ 表示在时间 $t^n = n \\Delta t$ 的解向量。\n\n**a) IMEX 后向欧拉–前向欧拉方案**\n该方案对扩散项进行隐式处理（使用后向欧拉法以保证稳定性），对平流项进行显式处理（使用前向欧拉法以求简便）。从 $t^n$ 到 $t^{n+1}$ 的更新过程如下：\n$$\n\\frac{\\mathbf{u}^{n+1} - \\mathbf{u}^n}{\\Delta t} = -a D_{\\text{up}} \\mathbf{u}^n + \\nu D_2 \\mathbf{u}^{n+1}\n$$\n重新整理以求解未知状态 $\\mathbf{u}^{n+1}$：\n$$\n\\mathbf{u}^{n+1} - \\Delta t \\nu D_2 \\mathbf{u}^{n+1} = \\mathbf{u}^n - \\Delta t a D_{\\text{up}} \\mathbf{u}^n\n$$\n$$\n\\big(I - \\Delta t \\nu D_2\\big) \\mathbf{u}^{n+1} = \\big(I - \\Delta t a D_{\\text{up}}\\big) \\mathbf{u}^n\n$$\n这与问题陈述中给出的形式相匹配。\n\n**b) 全隐式后向欧拉方案**\n该方案同时对平流项和扩散项进行隐式处理：\n$$\n\\frac{\\mathbf{u}^{n+1} - \\mathbf{u}^n}{\\Delta t} = -a D_{\\text{up}} \\mathbf{u}^{n+1} + \\nu D_2 \\mathbf{u}^{n+1}\n$$\n重新整理以求解 $\\mathbf{u}^{n+1}$：\n$$\n\\mathbf{u}^{n+1} + \\Delta t a D_{\\text{up}} \\mathbf{u}^{n+1} - \\Delta t \\nu D_2 \\mathbf{u}^{n+1} = \\mathbf{u}^n\n$$\n$$\n\\big(I + \\Delta t a D_{\\text{up}} - \\Delta t \\nu D_2\\big) \\mathbf{u}^{n+1} = \\mathbf{u}^n\n$$\n这也与所提供的形式相匹配。\n\n### 3. IMEX 方案的冯·诺依曼稳定性分析\n\n为推导稳定性限制，我们进行冯·诺依曼分析。我们将单个傅里叶模态 $u_j^n = G^n e^{ikx_j} = G^n e^{ij\\theta}$ 代入离散化的 IMEX 更新规则中，其中 $G$ 是放大因子，$k$ 是波数，$\\theta = k\\Delta x$ 是归一化波数。\n\n单个分量 $u_j$ 的离散更新规则是：\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} = -a \\left( \\frac{u_j^n - u_{j-1}^n}{\\Delta x} \\right) + \\nu \\left( \\frac{u_{j+1}^{n+1} - 2u_j^{n+1} + u_{j-1}^{n+1}}{\\Delta x^2} \\right)\n$$\n代入傅里叶模态：\n$$\n\\frac{G - 1}{\\Delta t} e^{ij\\theta} = -a \\left( \\frac{e^{ij\\theta} - e^{i(j-1)\\theta}}{\\Delta x} \\right) + \\nu G \\left( \\frac{e^{i(j+1)\\theta} - 2e^{ij\\theta} + e^{i(j-1)\\theta}}{\\Delta x^2} \\right)\n$$\n除以 $e^{ij\\theta}$ 得：\n$$\n\\frac{G - 1}{\\Delta t} = -a \\left( \\frac{1 - e^{-i\\theta}}{\\Delta x} \\right) + \\nu G \\left( \\frac{e^{i\\theta} - 2 + e^{-i\\theta}}{\\Delta x^2} \\right)\n$$\n这可以用差分算子的符号（特征值）$\\widehat{D_{\\text{up}}}(\\theta)$ 和 $\\widehat{D_2}(\\theta)$ 来表示：\n$$\n\\frac{G - 1}{\\Delta t} = -a \\widehat{D_{\\text{up}}}(\\theta) + \\nu G \\widehat{D_2}(\\theta)\n$$\n求解放大因子 $G(\\theta)$：\n$$\nG(1 - \\Delta t \\nu \\widehat{D_2}(\\theta)) = 1 - \\Delta t a \\widehat{D_{\\text{up}}}(\\theta) \\implies G(\\theta) = \\frac{1 - \\Delta t a \\widehat{D_{\\text{up}}}(\\theta)}{1 - \\Delta t \\nu \\widehat{D_2}(\\theta)}\n$$\n为保证稳定性，我们要求对于所有 $\\theta \\in [0, 2\\pi)$，$|G(\\theta)| \\le 1$。\n\n我们来分析分母。二阶导数的符号为 $\\widehat{D_2}(\\theta) = \\frac{e^{i\\theta} - 2 + e^{-i\\theta}}{\\Delta x^2} = \\frac{2\\cos\\theta - 2}{\\Delta x^2} = -\\frac{4\\sin^2(\\theta/2)}{\\Delta x^2}$。对于所有 $\\theta$，这是一个实数且非正。由于 $\\Delta t \\ge 0$ 和 $\\nu \\ge 0$，分母 $1 - \\Delta t \\nu \\widehat{D_2}(\\theta) = 1 + \\Delta t \\nu \\frac{4\\sin^2(\\theta/2)}{\\Delta x^2}$ 是实数且始终大于或等于 1。这证明了对扩散项的隐式处理是无条件稳定的，其本身不会对 $\\Delta t$ 施加限制。\n\n稳定性条件 $|G(\\theta)| \\le 1$ 变为 $|1 - \\Delta t a \\widehat{D_{\\text{up}}}(\\theta)| \\le |1 - \\Delta t \\nu \\widehat{D_2}(\\theta)|$。由于分母的模至少为 1，一个充分的稳定性条件是分子的模至多为 1：\n$$\n|1 - \\Delta t a \\widehat{D_{\\text{up}}}(\\theta)| \\le 1\n$$\n令 $C = \\frac{a \\Delta t}{\\Delta x}$ 为库朗数。分子为：\n$1 - \\Delta t a \\frac{1 - e^{-i\\theta}}{\\Delta x} = 1 - C(1 - \\cos\\theta + i\\sin\\theta) = (1 - C + C\\cos\\theta) - iC\\sin\\theta$。\n其模的平方是：\n$$\n|1 - \\Delta t a \\widehat{D_{\\text{up}}}(\\theta)|^2 = (1 - C + C\\cos\\theta)^2 + (-C\\sin\\theta)^2\n$$\n$$\n= (1-C)^2 + 2C(1-C)\\cos\\theta + C^2\\cos^2\\theta + C^2\\sin^2\\theta\n$$\n$$\n= 1 - 2C + C^2 + 2C\\cos\\theta - 2C^2\\cos\\theta + C^2 = 1 - 2C(1-\\cos\\theta) + 2C^2(1-\\cos\\theta)\n$$\n$$\n= 1 + 2(C^2-C)(1-\\cos\\theta)\n$$\n为了使其小于或等于 1，我们需要 $2(C^2-C)(1-\\cos\\theta) \\le 0$。因为 $1-\\cos\\theta \\ge 0$，这要求 $C^2 - C \\le 0$，即 $C(C-1) \\le 0$。由于 $a \\ge 0$，我们有 $C \\ge 0$，因此条件简化为 $C \\le 1$。\n$$\n\\frac{a \\Delta t}{\\Delta x} \\le 1 \\implies \\Delta t \\le \\frac{\\Delta x}{a}\n$$\n对于一般的 $a$，分析将涉及 $|a|$，从而得出显式平流部分的最终稳定性限制：\n$$\n\\Delta t \\le \\frac{\\Delta x}{|a|}\n$$\n\n### 4. 在傅里叶空间中的实现\n\n矩阵 $D_{\\text{up}}$ 和 $D_2$ 是循环矩阵，这意味着它们可以被离散傅里叶变换 (DFT) 对角化。将 DFT 应用于时间步进方程，可将线性代数方程组转换为一组独立的标量方程，每个傅里叶模态对应一个。令 $\\widehat{\\mathbf{u}}$ 为 $\\mathbf{u}$ 的 DFT。\n\n在傅里叶空间中，IMEX 更新变为：\n$$\n\\big(1 - \\Delta t \\nu \\widehat{D_2}(\\theta_m)\\big) \\widehat{u}_m^{n+1} = \\big(1 - \\Delta t a \\widehat{D_{\\text{up}}}(\\theta_m)\\big) \\widehat{u}_m^n\n$$\n$$\n\\widehat{u}_m^{n+1} = \\frac{1 - \\Delta t a \\widehat{D_{\\text{up}}}(\\theta_m)}{1 - \\Delta t \\nu \\widehat{D_2}(\\theta_m)} \\widehat{u}_m^n\n$$\n\n在傅里叶空间中，全隐式更新变为：\n$$\n\\big(1 + \\Delta t a \\widehat{D_{\\text{up}}}(\\theta_m) - \\Delta t \\nu \\widehat{D_2}(\\theta_m)\\big) \\widehat{u}_m^{n+1} = \\widehat{u}_m^n\n$$\n$$\n\\widehat{u}_m^{n+1} = \\frac{1}{1 + \\Delta t a \\widehat{D_{\\text{up}}}(\\theta_m) - \\Delta t \\nu \\widehat{D_2}(\\theta_m)} \\widehat{u}_m^n\n$$\n这里，$\\theta_m = 2\\pi m / N$，其中 $m$ 是离散频率指数。模拟过程首先初始化 $\\widehat{\\mathbf{u}}^0 = \\text{DFT}(\\mathbf{u}(t=0))$，然后对所有傅里叶系数重复应用适当的标量更新规则，直至达到所选的时间步数。最后，通过逆 DFT 恢复物理空间中的解。\n\n误差是根据精确解 $u_\\text{exact}(x,t) = \\exp(-\\nu (2\\pi k_0)^2 t) \\sin(2\\pi k_0 (x - a t))$ 使用离散 $L^2$ 范数计算的：\n$$\n\\|e\\|_2 = \\left(\\Delta x \\sum_{j=0}^{N-1} \\big(u_j(T) - u_\\text{exact}(x_j,T)\\big)^2 \\right)^{1/2}\n$$\n实现将针对问题中指定的每个测试用例，遵循这种基于傅里叶的算法。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the 1D advection-diffusion equation using IMEX and fully implicit schemes\n    in Fourier space, and reports errors and performance metrics.\n    \"\"\"\n    # Shared parameters\n    L = 1.0\n    a = 1.0\n    k0 = 2.0\n    N = 256\n    T = 0.5\n\n    # Test suite viscosities\n    viscosities = [1e-4, 1e-2, 1e-1]\n\n    all_results = []\n\n    # Spatial grid and wavenumbers\n    delta_x = L / N\n    x = np.linspace(0, L, N, endpoint=False)\n    \n    # Discrete wavenumbers (k) and corresponding angles (theta = 2*pi*k*dx)\n    # k_freq corresponds to cycles per unit length\n    k_freq = np.fft.fftfreq(N, d=delta_x)\n    theta = 2 * np.pi * k_freq * delta_x\n\n    # Symbols of the finite difference operators in Fourier space\n    # First-order upwind difference symbol\n    # Using a small epsilon to avoid division by zero if delta_x is zero, though not an issue here\n    D_up_hat = (1 - np.exp(-1j * theta)) / (delta_x + 1e-16)\n    \n    # Second-order centered difference symbol\n    # This form is numerically stable for small theta\n    D2_hat = -4 * (np.sin(theta / 2)**2) / (delta_x**2)\n    \n    # Initial condition\n    u0 = np.sin(2 * np.pi * k0 * x)\n    u0_hat = np.fft.fft(u0)\n\n    # Exact solution function\n    def u_exact(t, nu):\n        return np.exp(-nu * (2 * np.pi * k0)**2 * t) * np.sin(2 * np.pi * k0 * (x - a * t))\n\n    for nu in viscosities:\n        # 1. Compute CFL condition\n        dt_cfl = delta_x / np.abs(a)\n\n        # 2. Setup for IMEX and small-step implicit runs\n        dt_nominal_small = 0.9 * dt_cfl\n        M = int(np.ceil(T / dt_nominal_small))\n        dt_small = T / M\n\n        # 3. Setup for large-step implicit run\n        dt_nominal_large = 4.0 * dt_nominal_small\n        M_tilde = int(np.ceil(T / dt_nominal_large))\n        dt_large = T / M_tilde\n        \n        # --- Run IMEX Scheme ---\n        u_hat = np.copy(u0_hat)\n        # Pre-compute amplification factor for IMEX\n        g_imex = (1 - dt_small * a * D_up_hat) / (1 - dt_small * nu * D2_hat)\n        for _ in range(M):\n            u_hat *= g_imex\n        u_imex_T = np.fft.ifft(u_hat).real\n\n        # --- Run Fully Implicit Scheme (small dt) ---\n        u_hat = np.copy(u0_hat)\n        # Pre-compute amplification factor for Fully Implicit\n        g_imp_small = 1.0 / (1 + dt_small * a * D_up_hat - dt_small * nu * D2_hat)\n        for _ in range(M):\n            u_hat *= g_imp_small\n        u_imp_small_T = np.fft.ifft(u_hat).real\n        \n        # --- Run Fully Implicit Scheme (large dt) ---\n        u_hat = np.copy(u0_hat)\n        # Pre-compute amplification factor for Fully Implicit (large step)\n        g_imp_large = 1.0 / (1 + dt_large * a * D_up_hat - dt_large * nu * D2_hat)\n        for _ in range(M_tilde):\n            u_hat *= g_imp_large\n        u_imp_large_T = np.fft.ifft(u_hat).real\n        \n        # --- Calculate Errors ---\n        u_exact_T = u_exact(T, nu)\n\n        def l2_error(u_num, u_ex):\n            return np.sqrt(delta_x * np.sum((u_num - u_ex)**2))\n\n        error_imex = l2_error(u_imex_T, u_exact_T)\n        error_imp_small = l2_error(u_imp_small_T, u_exact_T)\n        error_imp_large = l2_error(u_imp_large_T, u_exact_T)\n\n        # --- Collect results for this viscosity ---\n        all_results.extend([\n            dt_cfl,\n            error_imex,\n            error_imp_small,\n            error_imp_large,\n            M,\n            M,\n            M_tilde\n        ])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n\n```"
        }
    ]
}