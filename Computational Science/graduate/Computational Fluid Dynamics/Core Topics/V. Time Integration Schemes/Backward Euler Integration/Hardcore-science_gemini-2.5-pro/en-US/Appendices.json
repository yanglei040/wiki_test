{
    "hands_on_practices": [
        {
            "introduction": "We begin our hands-on exploration by applying the Backward Euler method to a canonical problem in fluid dynamics: the transient flow over an impulsively started plate. This scenario, known as Stokes' first problem, simplifies to the diffusion equation and provides a perfect test case for an implicit scheme. This practice  offers direct experience in formulating and solving the linear system of equations that arises at each time step, a core skill in computational fluid dynamics. By comparing the numerical results to a known analytical solution, you will also perform a fundamental validation step: quantifying the discretization error.",
            "id": "3293764",
            "problem": "Consider Stokes’ first problem for an incompressible Newtonian fluid above an impulsively started infinite flat plate. Let the plate at $y=0$ start moving at constant speed $U$ in the $x$-direction at time $t=0^{+}$, with quiescent fluid for $y>0$ at $t=0$. Under the standard unidirectional, streamwise-uniform assumptions and zero streamwise pressure gradient, the $x$-momentum balance reduces to the diffusion Partial Differential Equation (PDE)\n$$\\frac{\\partial u}{\\partial t}=\\nu\\,\\frac{\\partial^{2}u}{\\partial y^{2}},\\quad y\\ge 0,\\; t>0,$$\nwith initial and boundary conditions\n$$u(y,0)=0,\\quad u(0,t)=U,\\quad \\lim_{y\\to\\infty}u(y,t)=0.$$\nFor a finite-domain numerical approximation, truncate to $y\\in[0,L]$ with $L$ sufficiently large and impose $u(L,t)=0$ as a far-field boundary condition. Discretize $[0,L]$ uniformly with $M$ equal subintervals of size $h=L/M$, giving grid points $y_{j}=j\\,h$ for $j=0,1,\\dots,M$. Let $u_{j}^{n}\\approx u(y_{j},t^{n})$ with $t^{n}=n\\,\\Delta t$. Use backward Euler time integration and a second-order centered finite-difference in space to approximate the PDE at interior nodes $j=1,\\dots,M-1$:\n$$\\frac{u_{j}^{n+1}-u_{j}^{n}}{\\Delta t}=\\nu\\,\\frac{u_{j+1}^{n+1}-2u_{j}^{n+1}+u_{j-1}^{n+1}}{h^{2}}.$$\nAssume the impulsive boundary is enforced at the new time level, $u_{0}^{n+1}=U$ for $n\\ge 0$, while the far-field is $u_{M}^{n+1}=0$; the initial interior state is at rest, $u_{j}^{0}=0$ for $j=1,\\dots,M-1$.\n\nTake the specific, physically consistent parameters\n$$\\nu=0.01\\,\\mathrm{m^{2}/s},\\quad U=1\\,\\mathrm{m/s},\\quad L=0.3\\,\\mathrm{m},\\quad M=3,\\quad \\Delta t=1\\,\\mathrm{s}.$$\nThese imply $h=L/M=0.1\\,\\mathrm{m}$ and $y_{1}=0.1\\,\\mathrm{m}$, $y_{2}=0.2\\,\\mathrm{m}$. Perform a single backward Euler step from $t^{0}=0$ to $t^{1}=\\Delta t$, solving exactly the resulting linear system for the interior unknowns $u_{1}^{1}$ and $u_{2}^{1}$.\n\nThe exact analytic solution for Stokes’ first problem is\n$$u(y,t)=U\\,\\mathrm{erfc}\\!\\Bigg(\\frac{y}{2\\sqrt{\\nu t}}\\Bigg),$$\nwhere $\\mathrm{erfc}$ denotes the complementary error function. Using this analytic solution, evaluate the discrete root-mean-square (RMS) error over the interior nodes at time $t^{1}$,\n$$E_{\\mathrm{RMS}}=\\sqrt{\\frac{1}{M-1}\\sum_{j=1}^{M-1}\\Big(u_{j}^{1}-u(y_{j},t^{1})\\Big)^{2}}.$$\n\nCompute $E_{\\mathrm{RMS}}$ for the specified parameters. Express your final answer in $\\mathrm{m/s}$ and round your answer to four significant figures.",
            "solution": "The problem statement is first subjected to a rigorous validation process.\n\n### Step 1: Extract Givens\n-   **Governing Equation**: The $x$-momentum balance is given by the diffusion PDE:\n    $$\\frac{\\partial u}{\\partial t}=\\nu\\,\\frac{\\partial^{2}u}{\\partial y^{2}},\\quad y\\ge 0,\\; t>0$$\n-   **Initial and Boundary Conditions (Analytical)**:\n    -   Initial condition: $u(y,0)=0$.\n    -   Boundary conditions: $u(0,t)=U$, $\\lim_{y\\to\\infty}u(y,t)=0$.\n-   **Numerical Discretization**:\n    -   Truncated domain: $y\\in[0,L]$.\n    -   Discretization parameters: $M$ subintervals, $h=L/M$, $y_j=j\\,h$ for $j=0,1,\\dots,M$.\n    -   Time step: $\\Delta t$, $t^n = n\\,\\Delta t$.\n    -   Notation: $u_j^n \\approx u(y_j, t^n)$.\n    -   Finite-difference scheme (Backward-Euler in time, 2nd-order centered in space):\n        $$\\frac{u_{j}^{n+1}-u_{j}^{n}}{\\Delta t}=\\nu\\,\\frac{u_{j+1}^{n+1}-2u_{j}^{n+1}+u_{j-1}^{n+1}}{h^{2}}$$\n    -   Numerical initial conditions: $u_j^0 = 0$ for $j=1,\\dots,M-1$.\n    -   Numerical boundary conditions: $u_0^{n+1}=U$ for $n\\ge 0$, $u_M^{n+1}=0$.\n-   **Physical and Numerical Parameters**:\n    -   Kinematic viscosity: $\\nu=0.01\\,\\mathrm{m^{2}/s}$.\n    -   Plate speed: $U=1\\,\\mathrm{m/s}$.\n    -   Domain length: $L=0.3\\,\\mathrm{m}$.\n    -   Number of subintervals: $M=3$.\n    -   Time step size: $\\Delta t=1\\,\\mathrm{s}$.\n-   **Exact Analytical Solution**:\n    $$u(y,t)=U\\,\\mathrm{erfc}\\!\\Bigg(\\frac{y}{2\\sqrt{\\nu t}}\\Bigg)$$\n-   **Error Metric**: Discrete root-mean-square (RMS) error over interior nodes at $t^1$.\n    $$E_{\\mathrm{RMS}}=\\sqrt{\\frac{1}{M-1}\\sum_{j=1}^{M-1}\\Big(u_{j}^{1}-u(y_{j},t^{1})\\Big)^{2}}$$\n-   **Task**: Compute $E_{\\mathrm{RMS}}$ for the given parameters, rounded to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientifically Grounded**: The problem is based on Stokes' first problem, a fundamental exact solution to the Navier-Stokes equations, which is modeled by the diffusion (or heat) equation. The numerical method, backward Euler, is a standard, well-analyzed implicit scheme. All principles are scientifically and mathematically sound.\n2.  **Well-Posed**: The PDE with its given initial and boundary conditions is a classic well-posed problem. The numerical task is also well-posed; the backward Euler method is unconditionally stable, and for the given parameters, it results in a non-singular system of linear equations, guaranteeing a unique solution.\n3.  **Objective**: The problem is stated in precise, quantitative, and objective language, free of ambiguity or subjective claims.\n4.  **Complete and Consistent**: All necessary data, equations, and conditions are provided. The parameters are physically consistent. The task is clearly defined.\n5.  **Not Ill-Posed or Poorly Structured**: The problem is clearly structured, guiding the solver from the numerical setup to the error calculation. The question is unambiguous.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. It is a standard, well-defined exercise in computational fluid dynamics and numerical analysis. The solution process will now proceed.\n\n#### Numerical Solution at $t^1$\nThe provided finite-difference scheme is:\n$$\\frac{u_{j}^{n+1}-u_{j}^{n}}{\\Delta t}=\\nu\\,\\frac{u_{j+1}^{n+1}-2u_{j}^{n+1}+u_{j-1}^{n+1}}{h^{2}}$$\nWe rearrange this equation to isolate terms at the new time level, $n+1$:\n$$u_{j}^{n+1} - \\frac{\\nu \\Delta t}{h^2} \\left(u_{j+1}^{n+1}-2u_{j}^{n+1}+u_{j-1}^{n+1}\\right) = u_{j}^{n}$$\nLet $r = \\frac{\\nu \\Delta t}{h^2}$ be the diffusion number. The equation becomes:\n$$-r u_{j-1}^{n+1} + (1+2r)u_{j}^{n+1} - r u_{j+1}^{n+1} = u_{j}^{n}$$\nWe are given the parameters $\\nu=0.01\\,\\mathrm{m^2/s}$, $L=0.3\\,\\mathrm{m}$, $M=3$, and $\\Delta t=1\\,\\mathrm{s}$. The spatial grid spacing $h$ is:\n$$h = \\frac{L}{M} = \\frac{0.3}{3} = 0.1\\,\\mathrm{m}$$\nThe diffusion number $r$ is:\n$$r = \\frac{(0.01\\,\\mathrm{m^2/s})(1\\,\\mathrm{s})}{(0.1\\,\\mathrm{m})^2} = \\frac{0.01}{0.01} = 1$$\nWe want to find the solution at the first time step, $t^1 = \\Delta t = 1\\,\\mathrm{s}$. The unknowns are the velocities at the interior nodes, $u_1^1$ and $u_2^1$ (since $M=3$, interior nodes are $j=1,2$). The initial conditions are $u_1^0 = 0$ and $u_2^0 = 0$. The boundary conditions at time $t^1$ are $u_0^1 = U = 1$ and $u_3^1 = 0$.\n\nWe write the scheme for each interior node $j=1,2$:\nFor $j=1$:\n$$-r u_{0}^{1} + (1+2r)u_{1}^{1} - r u_{2}^{1} = u_{1}^{0}$$\nSubstituting known values ($r=1$, $u_0^1=1$, $u_1^0=0$):\n$$-(1)(1) + (1+2(1))u_{1}^{1} - (1)u_{2}^{1} = 0 \\implies 3u_{1}^{1} - u_{2}^{1} = 1$$\nFor $j=2$:\n$$-r u_{1}^{1} + (1+2r)u_{2}^{1} - r u_{3}^{1} = u_{2}^{0}$$\nSubstituting known values ($r=1$, $u_3^1=0$, $u_2^0=0$):\n$$-(1)u_{1}^{1} + (1+2(1))u_{2}^{1} - (1)(0) = 0 \\implies -u_{1}^{1} + 3u_{2}^{1} = 0$$\nWe now solve the $2 \\times 2$ linear system:\n$$3u_{1}^{1} - u_{2}^{1} = 1$$\n$$-u_{1}^{1} + 3u_{2}^{1} = 0$$\nFrom the second equation, $u_{1}^{1} = 3u_{2}^{1}$. Substituting into the first equation:\n$$3(3u_{2}^{1}) - u_{2}^{1} = 1 \\implies 9u_2^1 - u_2^1 = 1 \\implies 8u_2^1 = 1 \\implies u_2^1 = \\frac{1}{8} = 0.125$$\nThen, $u_{1}^{1} = 3 \\left(\\frac{1}{8}\\right) = \\frac{3}{8} = 0.375$.\nThe numerical solution is $u_1^1 = 0.375\\,\\mathrm{m/s}$ and $u_2^1 = 0.125\\,\\mathrm{m/s}$.\n\n#### Exact Solution at $t^1$\nThe exact solution is $u(y,t)=U\\,\\mathrm{erfc}\\!\\left(\\frac{y}{2\\sqrt{\\nu t}}\\right)$.\nWe evaluate this at $t^1 = 1\\,\\mathrm{s}$ for the interior nodes $y_1=h=0.1\\,\\mathrm{m}$ and $y_2=2h=0.2\\,\\mathrm{m}$.\nThe argument of the erfc function is $\\frac{y}{2\\sqrt{\\nu t}} = \\frac{y}{2\\sqrt{(0.01)(1)}} = \\frac{y}{0.2} = 5y$.\nWith $U=1$, $u(y,1) = \\mathrm{erfc}(5y)$.\n\nFor $j=1$ ($y_1=0.1\\,\\mathrm{m}$):\n$$u(y_1, t^1) = \\mathrm{erfc}(5 \\times 0.1) = \\mathrm{erfc}(0.5) \\approx 0.47950012$$\nFor $j=2$ ($y_2=0.2\\,\\mathrm{m}$):\n$$u(y_2, t^1) = \\mathrm{erfc}(5 \\times 0.2) = \\mathrm{erfc}(1.0) \\approx 0.15729921$$\n\n#### RMS Error Calculation\nThe RMS error is given by:\n$$E_{\\mathrm{RMS}}=\\sqrt{\\frac{1}{M-1}\\sum_{j=1}^{M-1}\\Big(u_{j}^{1}-u(y_{j},t^{1})\\Big)^{2}} = \\sqrt{\\frac{1}{2}\\left[\\left(u_1^1 - u(y_1,t^1)\\right)^2 + \\left(u_2^1 - u(y_2,t^1)\\right)^2\\right]}$$\nThe errors at each node are:\n$$e_1 = u_1^1 - u(y_1,t^1) = 0.375 - 0.47950012 = -0.10450012$$\n$$e_2 = u_2^1 - u(y_2,t^1) = 0.125 - 0.15729921 = -0.03229921$$\nNow we compute the RMS error:\n$$E_{\\mathrm{RMS}} = \\sqrt{\\frac{1}{2}\\left[(-0.10450012)^2 + (-0.03229921)^2\\right]}$$\n$$E_{\\mathrm{RMS}} = \\sqrt{\\frac{1}{2}\\left[0.010920275 + 0.001043239\\right]}$$\n$$E_{\\mathrm{RMS}} = \\sqrt{\\frac{1}{2}(0.011963514)}$$\n$$E_{\\mathrm{RMS}} = \\sqrt{0.005981757}$$\n$$E_{\\mathrm{RMS}} \\approx 0.077341814\\,\\mathrm{m/s}$$\nRounding to four significant figures, the result is $0.07734$.",
            "answer": "$$ \\boxed{0.07734} $$"
        },
        {
            "introduction": "While the Backward Euler method is celebrated for its unconditional stability, this property alone does not guarantee a useful solution. This exercise  delves into the crucial distinction between stability and accuracy by analyzing the method's performance on the linear advection equation. Through Fourier analysis, you will discover that even when the scheme is stable, large time steps can introduce excessive numerical damping, eroding the physical fidelity of the solution. This analysis reveals why accuracy considerations often impose a practical limit on the time step, a critical insight for simulating convection-dominated flows.",
            "id": "3293724",
            "problem": "Consider the one-dimensional conservation of a passive scalar in a uniform, incompressible flow, written as the linear advection equation $\\,\\partial_{t} u + U\\,\\partial_{x} u = 0\\,$, where $\\,U > 0\\,$ is a constant advection speed. Adopt a method-of-lines standpoint: treat space as continuous (so that the spatial derivative is exact), and discretize time using the backward Euler method. Let $\\,\\Delta t\\,$ be the time step and $\\,\\Delta x\\,$ the uniform grid spacing of a hypothetical spatial discretization that would ultimately sample $\\,u(x,t)\\,$. Define the Courant number $\\,\\alpha := U\\,\\Delta t/\\Delta x\\,$.\n\nYou will analyze the backward Euler update applied to individual spatial Fourier modes and derive an accuracy-oriented constraint on the Courant number of the form $\\,\\alpha \\le C_{\\text{acc}}\\,$, where the constant $\\,C_{\\text{acc}}\\,$ is chosen to limit the per-step amplitude error of advected Fourier content. Proceed as follows:\n\n- Starting from the governing equation and the backward Euler time discretization, perform a Fourier-mode analysis for a single wavenumber $\\,k\\,$. Work from first principles to obtain the one-step amplification factor and its magnitude for the backward Euler map acting on that mode.\n- Impose the requirement that the per-step relative amplitude error $\\,1 - |G(k)|\\,$ be no greater than a tolerance $\\,\\varepsilon\\,$ for all Fourier modes that are meaningfully represented on the grid. For definiteness, assume that the signal is adequately resolved with at least four grid points per wavelength, so the largest relevant nondimensional wavenumber satisfies $\\,\\theta_{\\max} := k_{\\max}\\,\\Delta x = \\pi/2\\,$. Use this worst-case $\\,k_{\\max}\\,$ in your bound.\n- Derive a closed-form expression for $\\,C_{\\text{acc}}\\,$ in terms of $\\,\\varepsilon\\,$ and $\\,\\theta_{\\max}\\,$, and then evaluate it numerically for $\\,\\varepsilon = 0.02\\,$ and $\\,\\theta_{\\max} = \\pi/2\\,$.\n\nIn addition, explain, using your derivation and appropriate mathematical reasoning, why this accuracy-oriented time step constraint persists even though backward Euler removes classical stability restrictions for convection-dominated problems.\n\nReport the final answer as the numerical value of $\\,C_{\\text{acc}}\\,$ (dimensionless). Round your answer to four significant figures.",
            "solution": "The problem asks for an analysis of the backward Euler time integration scheme applied to the one-dimensional linear advection equation, with a focus on deriving an accuracy-based constraint on the Courant number.\n\n### Step 1: Problem Validation\n\n**1.1. Extract Givens**\n- Governing Equation: $\\partial_{t} u + U\\,\\partial_{x} u = 0$, with $U > 0$ being a constant advection speed.\n- Time Discretization: Backward Euler method.\n- Spatial Treatment: Method-of-lines, with space treated as continuous (exact spatial derivative).\n- Definitions:\n    - Time step: $\\Delta t$.\n    - Grid spacing: $\\Delta x$.\n    - Courant number: $\\alpha := U\\,\\Delta t/\\Delta x$.\n- Analysis Task:\n    - Perform Fourier-mode analysis for a single wavenumber $k$.\n    - Derive the one-step amplification factor $G(k)$ and its magnitude $|G(k)|$.\n- Accuracy Constraint:\n    - Per-step relative amplitude error: $1 - |G(k)| \\le \\varepsilon$.\n    - Error tolerance: $\\varepsilon = 0.02$.\n    - Grid resolution assumption: At least four grid points per wavelength for the highest relevant frequency.\n    - Maximum meaningful nondimensional wavenumber: $\\theta_{\\max} := k_{\\max}\\,\\Delta x = \\pi/2$. This corresponds to a wavelength $\\lambda_{\\min} = 2\\pi/k_{\\max} = 2\\pi\\Delta x / \\theta_{\\max} = 2\\pi\\Delta x / (\\pi/2) = 4\\Delta x$.\n- Required Output:\n    - A closed-form expression for the accuracy-oriented Courant number limit, $C_{\\text{acc}}$, in terms of $\\varepsilon$ and $\\theta_{\\max}$.\n    - The numerical value of $C_{\\text{acc}}$ for the given parameters.\n    - An explanation for why such a constraint exists despite the unconditional stability of the backward Euler method.\n\n**1.2. Validate Using Extracted Givens**\nThe problem is scientifically grounded, well-posed, and objective.\n- **Scientific Grounding**: The linear advection equation is a fundamental model in fluid dynamics and physics. The backward Euler method and Fourier analysis are standard, well-established techniques in numerical analysis for partial differential equations. The concepts of Courant number, stability, and accuracy are central to this field. The problem statement is free of scientific flaws.\n- **Well-Posedness**: The problem is clearly structured with a sequence of logical steps leading to a unique analytical and numerical answer. All necessary definitions and parameters ($\\varepsilon$, $\\theta_{\\max}$) are provided.\n- **Objectivity**: The language is formal and precise, with no subjective or ambiguous terms.\n- **Completeness and Consistency**: The problem is self-contained and all givens are mutually consistent.\n- **Realism**: The scenario is a canonical textbook example used to teach the properties of numerical schemes. The values for $\\varepsilon$ and $\\theta_{\\max}$ are reasonable for such an analysis.\n\n**1.3. Verdict and Action**\nThe problem is valid. The solution will now be derived.\n\n### Step 2: Derivation of the Solution\n\nWe begin with the governing partial differential equation (PDE), the linear advection equation:\n$$\n\\partial_{t} u + U\\,\\partial_{x} u = 0\n$$\nWe discretize this equation in time using the backward Euler method. Let $u^n(x)$ denote the solution at time $t_n = n\\Delta t$. The backward Euler update from time $t_n$ to $t_{n+1}$ is:\n$$\n\\frac{u^{n+1}(x) - u^n(x)}{\\Delta t} + U\\,\\partial_{x} u^{n+1}(x) = 0\n$$\nFollowing the method-of-lines approach, the spatial derivative $\\partial_x$ remains an exact differential operator. Rearranging the equation to solve for $u^{n+1}$ gives:\n$$\nu^{n+1}(x) + U \\Delta t \\,\\partial_{x} u^{n+1}(x) = u^n(x)\n$$\nThis is a first-order ordinary differential equation in space for $u^{n+1}(x)$.\n\nTo analyze the properties of this scheme, we consider its effect on a single spatial Fourier mode of the form $u(x,t) = \\hat{u}(t)e^{ikx}$, where $k$ is the wavenumber and $i = \\sqrt{-1}$. For such a mode, the spatial differentiation operator acts as multiplication by $ik$:\n$$\n\\partial_x u(x,t) = ik\\,\\hat{u}(t)e^{ikx} = ik\\,u(x,t)\n$$\nSubstituting this into the semi-discrete equation, we obtain a relation between the Fourier mode amplitudes at time steps $n$ and $n+1$:\n$$\n\\hat{u}^{n+1} + U \\Delta t (ik \\hat{u}^{n+1}) = \\hat{u}^{n}\n$$\nFactoring out $\\hat{u}^{n+1}$:\n$$\n\\hat{u}^{n+1}(1 + ikU\\Delta t) = \\hat{u}^{n}\n$$\nThe one-step amplification factor, $G(k)$, is defined by the relation $\\hat{u}^{n+1} = G(k)\\hat{u}^{n}$. From the equation above, we find:\n$$\nG(k) = \\frac{1}{1 + ikU\\Delta t}\n$$\nTo make this expression non-dimensional, we introduce the Courant number $\\alpha = U\\Delta t/\\Delta x$ and the non-dimensional wavenumber $\\theta = k\\Delta x$. The product $kU\\Delta t$ can be rewritten as:\n$$\nkU\\Delta t = (k\\Delta x)\\left(\\frac{U\\Delta t}{\\Delta x}\\right) = \\theta \\alpha\n$$\nThus, the amplification factor as a function of $\\theta$ is:\n$$\nG(\\theta) = \\frac{1}{1 + i\\alpha\\theta}\n$$\nThe exact solution to the advection equation corresponds to pure translation, meaning the amplitude of any Fourier mode should be conserved. The exact amplification factor has magnitude $|G_{\\text{exact}}| = 1$. The numerical scheme's deviation from this behavior is captured by the magnitude of its amplification factor, $|G(\\theta)|$. We calculate this magnitude:\n$$\n|G(\\theta)| = \\left| \\frac{1}{1 + i\\alpha\\theta} \\right| = \\frac{|1|}{|1 + i\\alpha\\theta|} = \\frac{1}{\\sqrt{1^2 + (\\alpha\\theta)^2}} = \\frac{1}{\\sqrt{1 + (\\alpha\\theta)^2}}\n$$\nWe note that for any real $\\alpha > 0$ and $\\theta$, $|G(\\theta)| \\le 1$. This confirms that the backward Euler method is unconditionally stable for this problem; the amplitude of any mode will not grow unboundedly, regardless of the time step $\\Delta t$. However, for $\\alpha\\theta \\neq 0$, we have $|G(\\theta)| < 1$, which indicates that the scheme introduces numerical damping or dissipation.\n\nThe problem imposes a constraint on the accuracy of the scheme by limiting this numerical damping. The per-step relative amplitude error is defined as $1 - |G(\\theta)|$. This error must be no greater than a tolerance $\\varepsilon$:\n$$\n1 - |G(\\theta)| \\le \\varepsilon\n$$\nThis is equivalent to requiring $|G(\\theta)| \\ge 1 - \\varepsilon$. Substituting our expression for $|G(\\theta)|$:\n$$\n\\frac{1}{\\sqrt{1 + (\\alpha\\theta)^2}} \\ge 1 - \\varepsilon\n$$\nSince both sides are positive, we can take the reciprocal and reverse the inequality sign:\n$$\n\\sqrt{1 + (\\alpha\\theta)^2} \\le \\frac{1}{1 - \\varepsilon}\n$$\nSquaring both sides yields:\n$$\n1 + (\\alpha\\theta)^2 \\le \\frac{1}{(1 - \\varepsilon)^2}\n$$\nNow, we solve for $(\\alpha\\theta)^2$:\n$$\n(\\alpha\\theta)^2 \\le \\frac{1}{(1 - \\varepsilon)^2} - 1 = \\frac{1 - (1 - \\varepsilon)^2}{(1 - \\varepsilon)^2} = \\frac{1 - (1 - 2\\varepsilon + \\varepsilon^2)}{(1 - \\varepsilon)^2} = \\frac{2\\varepsilon - \\varepsilon^2}{(1 - \\varepsilon)^2}\n$$\nThis inequality must hold for all relevant wavenumbers. The magnitude of the term $(\\alpha\\theta)^2$ increases with $|\\theta|$. Therefore, the most restrictive constraint (i.e., the one that most limits $\\alpha$) occurs for the largest relevant wavenumber, which is specified as $\\theta_{\\max} = k_{\\max}\\Delta x$. We must satisfy the inequality at this worst-case wavenumber:\n$$\n(\\alpha\\theta_{\\max})^2 \\le \\frac{2\\varepsilon - \\varepsilon^2}{(1 - \\varepsilon)^2}\n$$\nSolving for the Courant number $\\alpha$:\n$$\n\\alpha \\le \\frac{1}{\\theta_{\\max}} \\frac{\\sqrt{2\\varepsilon - \\varepsilon^2}}{1 - \\varepsilon}\n$$\nThis gives the desired expression for the accuracy-oriented Courant number limit, $C_{\\text{acc}}$:\n$$\nC_{\\text{acc}} = \\frac{1}{\\theta_{\\max}} \\frac{\\sqrt{2\\varepsilon - \\varepsilon^2}}{1 - \\varepsilon}\n$$\nNow, we evaluate this expression for the given values $\\varepsilon = 0.02$ and $\\theta_{\\max} = \\pi/2$:\n$$\nC_{\\text{acc}} = \\frac{1}{\\pi/2} \\frac{\\sqrt{2(0.02) - (0.02)^2}}{1 - 0.02} = \\frac{2}{\\pi} \\frac{\\sqrt{0.04 - 0.0004}}{0.98}\n$$\n$$\nC_{\\text{acc}} = \\frac{2}{\\pi} \\frac{\\sqrt{0.0396}}{0.98}\n$$\nNumerically evaluating this expression:\n$$\nC_{\\text{acc}} \\approx \\frac{2}{3.14159...} \\frac{0.198997...}{0.98} \\approx 0.63662 \\times 0.203058... \\approx 0.12926343...\n$$\nRounding to four significant figures, we get $C_{\\text{acc}} = 0.1293$.\n\n### Explanation: Stability vs. Accuracy\n\nThe backward Euler method is an implicit scheme. For the linear advection equation, its amplification factor magnitude is $|G(\\theta)| = 1/\\sqrt{1 + (\\alpha\\theta)^2}$. Since this value is less than or equal to $1$ for any choice of Courant number $\\alpha \\ge 0$, the method is said to be unconditionally stable. A stability-based analysis places no upper limit on the time step $\\Delta t$; the solution will not amplify spuriously and \"blow up\" even for very large $\\alpha$.\n\nHowever, stability is merely a prerequisite for a useful numerical scheme; accuracy is the primary goal. The exact solution conserves wave amplitude ($|G_{\\text{exact}}| = 1$), whereas the backward Euler scheme introduces artificial damping ($|G(\\theta)| < 1$). This damping represents an accuracy error. Our derivation shows that the magnitude of this error is governed by the product $\\alpha\\theta$. For a fixed wavenumber $\\theta$, increasing the time step (and thus $\\alpha$) leads to a smaller value of $|G(\\theta)|$, meaning more severe damping. The highest wavenumbers (largest $\\theta$), which represent the finest details in the solution, are damped most severely.\n\nThe constraint $\\alpha \\le C_{\\text{acc}}$ is not derived from a stability requirement but from an accuracy requirement. It ensures that the numerical damping, an artifact of the method, remains within a prescribed tolerance $\\varepsilon$. If one were to use a very large time step (large $\\alpha \\gg C_{\\text{acc}}$), the simulation would remain stable, but the solution would become excessively smooth and lose its high-frequency content almost immediately, rendering it a highly inaccurate representation of the true physical process. Thus, even for unconditionally stable schemes, accuracy considerations almost always impose a practical limit on the time step size.",
            "answer": "$$\n\\boxed{0.1293}\n$$"
        },
        {
            "introduction": "Real-world fluid dynamics problems often involve multiple physical processes, such as advection and diffusion, which have different characteristic time scales. This presents an opportunity for more sophisticated numerical strategies like Implicit-Explicit (IMEX) methods, which treat stiff terms (like diffusion) implicitly and non-stiff terms (like advection) explicitly. This coding practice  guides you through the implementation and comparison of an IMEX scheme against a fully implicit Backward Euler scheme for the advection-diffusion equation. By examining the performance and accuracy across different physical regimes, you will develop an intuition for the practical trade-offs between computational cost and numerical stability, a key consideration in designing efficient CFD solvers.",
            "id": "3293758",
            "problem": "Consider the one-dimensional linear advection–diffusion initial value problem on a periodic domain,\n$$\n\\frac{\\partial u}{\\partial t} + a \\frac{\\partial u}{\\partial x} = \\nu \\frac{\\partial^2 u}{\\partial x^2}, \\quad x \\in [0,L], \\quad t \\ge 0,\n$$\nwith periodic boundary conditions and initial condition\n$$\nu(x,0) = \\sin\\!\\big(2\\pi k_0 x\\big).\n$$\nYou will formulate and analyze an Implicit–Explicit (IMEX) time integration scheme that treats diffusion implicitly with backward Euler and advection explicitly, and you will compare it against a fully implicit backward Euler scheme that treats both advection and diffusion implicitly. The spatial discretization must be performed on a uniform periodic grid using consistent finite-difference stencils, and the time-stepping must be applied to the resulting method-of-lines semi-discrete system.\n\nYou must proceed from first principles as follows.\n\n- Start from the partial differential equation and discretize space on a uniform periodic grid with $N$ points and grid spacing $\\Delta x = L/N$.\n- Approximate the advection derivative with the first-order upwind difference (assume $a \\ge 0$):\n$$\n\\left(\\frac{\\partial u}{\\partial x}\\right)_i \\approx \\frac{u_i - u_{i-1}}{\\Delta x}.\n$$\n- Approximate the diffusion second derivative with the standard centered second-order difference:\n$$\n\\left(\\frac{\\partial^2 u}{\\partial x^2}\\right)_i \\approx \\frac{u_{i+1} - 2 u_i + u_{i-1}}{\\Delta x^2}.\n$$\n- Formulate the IMEX backward Euler–forward Euler update for one time step from $t^n$ to $t^{n+1}=t^n+\\Delta t$ in the method-of-lines sense:\n$$\n\\big(I - \\Delta t \\, \\nu D_2\\big) \\, \\mathbf{u}^{n+1} = \\mathbf{u}^n - \\Delta t \\, a \\, D_\\text{up} \\, \\mathbf{u}^n,\n$$\nwhere $D_\\text{up}$ is the upwind first-derivative matrix and $D_2$ is the centered second-derivative matrix on the periodic grid.\n- Formulate the fully implicit backward Euler update that treats both terms implicitly:\n$$\n\\big(I + \\Delta t \\, a \\, D_\\text{up} - \\Delta t \\, \\nu D_2\\big) \\, \\mathbf{u}^{n+1} = \\mathbf{u}^n.\n$$\n\nDerive, from a von Neumann analysis, the explicit advection stability restriction for the IMEX scheme, and show that the time step must satisfy\n$$\n\\Delta t \\le \\frac{\\Delta x}{|a|}.\n$$\nState clearly any assumptions used in the derivation and why diffusion does not impose an additional restriction when treated with backward Euler.\n\nYou will implement both schemes using the periodic uniform grid and periodic difference operators. For efficiency and numerical exactness of the linear solves on the periodic grid, you must diagonalize the circulant operators by the discrete Fourier transform and implement the steps in Fourier space mode-by-mode, using the symbols of $D_\\text{up}$ and $D_2$:\n$$\n\\widehat{D_\\text{up}}(\\theta) = \\frac{1 - e^{-i\\theta}}{\\Delta x}, \\qquad \\widehat{D_2}(\\theta) = \\frac{e^{i\\theta} - 2 + e^{-i\\theta}}{\\Delta x^2} = -\\frac{4\\sin^2(\\theta/2)}{\\Delta x^2},\n$$\nwith $\\theta = 2\\pi m/N$ for $m \\in \\{0,1,\\dots,N-1\\}$.\n\nUse the exact solution of the continuous problem for the chosen initial condition,\n$$\nu_\\text{exact}(x,t) = \\exp\\!\\big(-\\nu (2\\pi k_0)^2 t\\big) \\, \\sin\\!\\big(2\\pi k_0 (x - a t)\\big),\n$$\nto compute a discrete $L^2$ error at final time $T$:\n$$\n\\|e\\|_2 = \\left(\\Delta x \\sum_{j=0}^{N-1} \\big(u_j(T) - u_\\text{exact}(x_j,T)\\big)^2 \\right)^{1/2}.\n$$\n\nYour program must implement the following test suite with shared parameters and multiple viscosity regimes:\n- Shared parameters: $L = 1$, $a = 1$, $k_0 = 2$, $N = 256$, $T = 0.5$.\n- Viscosity values: $\\nu \\in \\{10^{-4}, 10^{-2}, 10^{-1}\\}$.\n\nFor each viscosity $\\nu$ in the test suite:\n- Compute the explicit Courant–Friedrichs–Lewy time step bound $\\Delta t_\\text{CFL} = \\Delta x / |a|$ implied by your derivation.\n- Run the IMEX scheme with $\\Delta t = 0.9 \\, \\Delta t_\\text{CFL}$, using a uniform number of steps chosen to exactly reach $T$ (i.e., pick the number of steps $M = \\lceil T/\\Delta t \\rceil$ and then set $\\Delta t = T/M$).\n- Run the fully implicit scheme with the same $\\Delta t$ and number of steps $M$ as the IMEX run.\n- Additionally, run the fully implicit scheme with a four-times larger nominal step size $\\tilde{\\Delta t} = 4 \\times 0.9 \\, \\Delta t_\\text{CFL}$, again choosing the number of steps $\\tilde{M} = \\lceil T/\\tilde{\\Delta t} \\rceil$ and then setting $\\tilde{\\Delta t} = T/\\tilde{M}$.\n\nFor each viscosity $\\nu$, report the following seven quantities:\n- The stability bound $\\Delta t_\\text{CFL}$.\n- The discrete $L^2$ error of the IMEX scheme at $T$ with $\\Delta t$ as above.\n- The discrete $L^2$ error of the fully implicit scheme at $T$ with the same $\\Delta t$.\n- The discrete $L^2$ error of the fully implicit scheme at $T$ with the coarser step $\\tilde{\\Delta t}$.\n- The number of time steps used by the IMEX run, $M$.\n- The number of time steps used by the fully implicit run at the same $\\Delta t$, $M$.\n- The number of time steps used by the fully implicit run at the coarser step, $\\tilde{M}$.\n\nFinal output format requirement:\n- Your program should produce a single line of output containing the results for all viscosities, concatenated in order of the test suite viscosities, as a comma-separated list enclosed in square brackets. For example, the output should look like\n$$\n[\\Delta t_{\\text{CFL},1}, \\|e\\|_{\\text{IMEX},1}, \\|e\\|_{\\text{IMP},1}, \\|e\\|_{\\text{IMP-4x},1}, M_1, M_1, \\tilde{M}_1, \\Delta t_{\\text{CFL},2}, \\dots ].\n$$\nAll reported values must be real numbers or integers. Angles are not used in this problem, and there are no physical units to report because all parameters are dimensionless by construction.",
            "solution": "The problem requires the formulation, analysis, and implementation of two numerical schemes for the one-dimensional linear advection–diffusion equation on a periodic domain. The validation process confirms that the problem is scientifically sound, well-posed, and self-contained, with all necessary parameters, equations, and methods clearly specified. We proceed with the solution.\n\n### 1. Problem Formulation and Spatial Discretization\n\nThe governing partial differential equation (PDE) is the linear advection–diffusion equation:\n$$\n\\frac{\\partial u}{\\partial t} + a \\frac{\\partial u}{\\partial x} = \\nu \\frac{\\partial^2 u}{\\partial x^2}\n$$\nfor $x \\in [0,L]$ and $t \\ge 0$, with advection coefficient $a \\ge 0$, viscosity $\\nu \\ge 0$, and periodic boundary conditions. The initial condition is given by a single sinusoidal mode:\n$$\nu(x,0) = \\sin(2\\pi k_0 x)\n$$\n\nWe discretize the spatial domain $[0,L]$ using a uniform grid of $N$ points $x_j = j \\Delta x$ for $j=0, 1, \\dots, N-1$, with grid spacing $\\Delta x = L/N$. Let $u_j(t)$ be the numerical approximation of $u(x_j, t)$.\n\nThe spatial derivatives are approximated using finite differences as specified:\n- The first-order advection derivative is approximated using the first-order upwind scheme (since $a \\ge 0$):\n$$\na \\left(\\frac{\\partial u}{\\partial x}\\right)_{x_j} \\approx a \\frac{u_j(t) - u_{j-1}(t)}{\\Delta x}\n$$\n- The second-order diffusion derivative is approximated using the second-order centered difference scheme:\n$$\n\\nu \\left(\\frac{\\partial^2 u}{\\partial x^2}\\right)_{x_j} \\approx \\nu \\frac{u_{j+1}(t) - 2u_j(t) + u_{j-1}(t)}{\\Delta x^2}\n$$\nDue to the periodic boundary conditions, indices are taken modulo $N$, i.e., $u_{-1} \\equiv u_{N-1}$ and $u_N \\equiv u_0$.\n\nSubstituting these approximations into the PDE yields a system of coupled ordinary differential equations (ODEs), a technique known as the method of lines:\n$$\n\\frac{d u_j}{dt} = -a \\left(\\frac{u_j - u_{j-1}}{\\Delta x}\\right) + \\nu \\left(\\frac{u_{j+1} - 2u_j + u_{j-1}}{\\Delta x^2}\\right)\n$$\nThis system can be written in matrix form as:\n$$\n\\frac{d\\mathbf{u}}{dt} = -a D_{\\text{up}} \\mathbf{u} + \\nu D_2 \\mathbf{u} \\equiv \\mathcal{L}(\\mathbf{u})\n$$\nwhere $\\mathbf{u}(t) = [u_0(t), u_1(t), \\dots, u_{N-1}(t)]^T$, and $D_{\\text{up}}$ and $D_2$ are the circulant matrices representing the upwind first-derivative and centered second-derivative operators, respectively.\n\n### 2. Time Integration Schemes\n\nWe discretize in time using a uniform time step $\\Delta t$. Let $\\mathbf{u}^n$ denote the solution vector at time $t^n = n \\Delta t$.\n\n**a) IMEX Backward Euler–Forward Euler Scheme**\nThis scheme treats the diffusion term implicitly (using backward Euler for stability) and the advection term explicitly (using forward Euler for simplicity). The update from $t^n$ to $t^{n+1}$ is:\n$$\n\\frac{\\mathbf{u}^{n+1} - \\mathbf{u}^n}{\\Delta t} = -a D_{\\text{up}} \\mathbf{u}^n + \\nu D_2 \\mathbf{u}^{n+1}\n$$\nRearranging to solve for the unknown state $\\mathbf{u}^{n+1}$:\n$$\n\\mathbf{u}^{n+1} - \\Delta t \\nu D_2 \\mathbf{u}^{n+1} = \\mathbf{u}^n - \\Delta t a D_{\\text{up}} \\mathbf{u}^n\n$$\n$$\n\\big(I - \\Delta t \\nu D_2\\big) \\mathbf{u}^{n+1} = \\big(I - \\Delta t a D_{\\text{up}}\\big) \\mathbf{u}^n\n$$\nThis matches the form given in the problem statement.\n\n**b) Fully Implicit Backward Euler Scheme**\nThis scheme treats both advection and diffusion terms implicitly:\n$$\n\\frac{\\mathbf{u}^{n+1} - \\mathbf{u}^n}{\\Delta t} = -a D_{\\text{up}} \\mathbf{u}^{n+1} + \\nu D_2 \\mathbf{u}^{n+1}\n$$\nRearranging to solve for $\\mathbf{u}^{n+1}$:\n$$\n\\mathbf{u}^{n+1} + \\Delta t a D_{\\text{up}} \\mathbf{u}^{n+1} - \\Delta t \\nu D_2 \\mathbf{u}^{n+1} = \\mathbf{u}^n\n$$\n$$\n\\big(I + \\Delta t a D_{\\text{up}} - \\Delta t \\nu D_2\\big) \\mathbf{u}^{n+1} = \\mathbf{u}^n\n$$\nThis also matches the form provided.\n\n### 3. Von Neumann Stability Analysis of the IMEX Scheme\n\nTo derive the stability restriction, we perform a von Neumann analysis. We substitute a single Fourier mode $u_j^n = G^n e^{ikx_j} = G^n e^{ij\\theta}$ into the discretized IMEX update rule, where $G$ is the amplification factor, $k$ is the wavenumber, and $\\theta = k\\Delta x$ is the normalized wavenumber.\n\nThe discrete update rule for a single component $u_j$ is:\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} = -a \\left( \\frac{u_j^n - u_{j-1}^n}{\\Delta x} \\right) + \\nu \\left( \\frac{u_{j+1}^{n+1} - 2u_j^{n+1} + u_{j-1}^{n+1}}{\\Delta x^2} \\right)\n$$\nSubstituting the Fourier mode:\n$$\n\\frac{G - 1}{\\Delta t} e^{ij\\theta} = -a \\left( \\frac{e^{ij\\theta} - e^{i(j-1)\\theta}}{\\Delta x} \\right) + \\nu G \\left( \\frac{e^{i(j+1)\\theta} - 2e^{ij\\theta} + e^{i(j-1)\\theta}}{\\Delta x^2} \\right)\n$$\nDividing by $e^{ij\\theta}$ yields:\n$$\n\\frac{G - 1}{\\Delta t} = -a \\left( \\frac{1 - e^{-i\\theta}}{\\Delta x} \\right) + \\nu G \\left( \\frac{e^{i\\theta} - 2 + e^{-i\\theta}}{\\Delta x^2} \\right)\n$$\nThis can be written using the symbols (eigenvalues) of the difference operators, $\\widehat{D_{\\text{up}}}(\\theta)$ and $\\widehat{D_2}(\\theta)$:\n$$\n\\frac{G - 1}{\\Delta t} = -a \\widehat{D_{\\text{up}}}(\\theta) + \\nu G \\widehat{D_2}(\\theta)\n$$\nSolving for the amplification factor $G(\\theta)$:\n$$\nG(1 - \\Delta t \\nu \\widehat{D_2}(\\theta)) = 1 - \\Delta t a \\widehat{D_{\\text{up}}}(\\theta) \\implies G(\\theta) = \\frac{1 - \\Delta t a \\widehat{D_{\\text{up}}}(\\theta)}{1 - \\Delta t \\nu \\widehat{D_2}(\\theta)}\n$$\nFor stability, we require $|G(\\theta)| \\le 1$ for all $\\theta \\in [0, 2\\pi)$.\n\nLet's analyze the denominator. The symbol for the second derivative is $\\widehat{D_2}(\\theta) = \\frac{e^{i\\theta} - 2 + e^{-i\\theta}}{\\Delta x^2} = \\frac{2\\cos\\theta - 2}{\\Delta x^2} = -\\frac{4\\sin^2(\\theta/2)}{\\Delta x^2}$. This is a real and non-positive value for all $\\theta$. Since $\\Delta t \\ge 0$ and $\\nu \\ge 0$, the denominator $1 - \\Delta t \\nu \\widehat{D_2}(\\theta) = 1 + \\Delta t \\nu \\frac{4\\sin^2(\\theta/2)}{\\Delta x^2}$ is real and always greater than or equal to $1$. This proves that the implicit treatment of the diffusion term is unconditionally stable and does not itself impose a restriction on $\\Delta t$.\n\nThe stability condition $|G(\\theta)| \\le 1$ becomes $|1 - \\Delta t a \\widehat{D_{\\text{up}}}(\\theta)| \\le |1 - \\Delta t \\nu \\widehat{D_2}(\\theta)|$. Since the denominator's magnitude is at least $1$, a sufficient condition for stability is that the numerator's magnitude is at most $1$:\n$$\n|1 - \\Delta t a \\widehat{D_{\\text{up}}}(\\theta)| \\le 1\n$$\nLet $C = \\frac{a \\Delta t}{\\Delta x}$ be the Courant number. The numerator is:\n$1 - \\Delta t a \\frac{1 - e^{-i\\theta}}{\\Delta x} = 1 - C(1 - \\cos\\theta + i\\sin\\theta) = (1 - C + C\\cos\\theta) - iC\\sin\\theta$.\nThe squared magnitude is:\n$$\n|1 - \\Delta t a \\widehat{D_{\\text{up}}}(\\theta)|^2 = (1 - C + C\\cos\\theta)^2 + (-C\\sin\\theta)^2\n$$\n$$\n= (1-C)^2 + 2C(1-C)\\cos\\theta + C^2\\cos^2\\theta + C^2\\sin^2\\theta\n$$\n$$\n= 1 - 2C + C^2 + 2C\\cos\\theta - 2C^2\\cos\\theta + C^2 = 1 - 2C(1-\\cos\\theta) + 2C^2(1-\\cos\\theta)\n$$\n$$\n= 1 + 2(C^2-C)(1-\\cos\\theta)\n$$\nFor this to be less than or equal to $1$, we need $2(C^2-C)(1-\\cos\\theta) \\le 0$. Since $1-\\cos\\theta \\ge 0$, this requires $C^2 - C \\le 0$, or $C(C-1) \\le 0$. As $a \\ge 0$, we have $C \\ge 0$, so the condition simplifies to $C \\le 1$.\n$$\n\\frac{a \\Delta t}{\\Delta x} \\le 1 \\implies \\Delta t \\le \\frac{\\Delta x}{a}\n$$\nFor a general $a$, the analysis would involve $|a|$, leading to the final stability restriction for the explicit advection part:\n$$\n\\Delta t \\le \\frac{\\Delta x}{|a|}\n$$\n\n### 4. Implementation in Fourier Space\n\nThe matrices $D_{\\text{up}}$ and $D_2$ are circulant, which means they are diagonalized by the Discrete Fourier Transform (DFT). Applying the DFT to the time-stepping equations transforms the system of linear algebraic equations into a set of independent scalar equations, one for each Fourier mode. Let $\\widehat{\\mathbf{u}}$ be the DFT of $\\mathbf{u}$.\n\nThe IMEX update in Fourier space becomes:\n$$\n\\big(1 - \\Delta t \\nu \\widehat{D_2}(\\theta_m)\\big) \\widehat{u}_m^{n+1} = \\big(1 - \\Delta t a \\widehat{D_{\\text{up}}}(\\theta_m)\\big) \\widehat{u}_m^n\n$$\n$$\n\\widehat{u}_m^{n+1} = \\frac{1 - \\Delta t a \\widehat{D_{\\text{up}}}(\\theta_m)}{1 - \\Delta t \\nu \\widehat{D_2}(\\theta_m)} \\widehat{u}_m^n\n$$\n\nThe fully implicit update in Fourier space becomes:\n$$\n\\big(1 + \\Delta t a \\widehat{D_{\\text{up}}}(\\theta_m) - \\Delta t \\nu \\widehat{D_2}(\\theta_m)\\big) \\widehat{u}_m^{n+1} = \\widehat{u}_m^n\n$$\n$$\n\\widehat{u}_m^{n+1} = \\frac{1}{1 + \\Delta t a \\widehat{D_{\\text{up}}}(\\theta_m) - \\Delta t \\nu \\widehat{D_2}(\\theta_m)} \\widehat{u}_m^n\n$$\nHere, $\\theta_m = 2\\pi m / N$ for the discrete frequency index $m$. The simulation proceeds by initializing $\\widehat{\\mathbf{u}}^0 = \\text{DFT}(\\mathbf{u}(t=0))$, and then repeatedly applying the appropriate scalar update rule to all Fourier coefficients for the chosen number of time steps. Finally, the solution in physical space is recovered via an inverse DFT.\n\nThe error is computed against the exact solution, $u_\\text{exact}(x,t) = \\exp(-\\nu (2\\pi k_0)^2 t) \\sin(2\\pi k_0 (x - a t))$, using the discrete $L^2$ norm:\n$$\n\\|e\\|_2 = \\left(\\Delta x \\sum_{j=0}^{N-1} \\big(u_j(T) - u_\\text{exact}(x_j,T)\\big)^2 \\right)^{1/2}\n$$\nThe implementation will follow this Fourier-based algorithm for each test case specified in the problem.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the 1D advection-diffusion equation using IMEX and fully implicit schemes\n    in Fourier space, and reports errors and performance metrics.\n    \"\"\"\n    # Shared parameters\n    L = 1.0\n    a = 1.0\n    k0 = 2.0\n    N = 256\n    T = 0.5\n\n    # Test suite viscosities\n    viscosities = [1e-4, 1e-2, 1e-1]\n\n    all_results = []\n\n    # Spatial grid and wavenumbers\n    delta_x = L / N\n    x = np.linspace(0, L, N, endpoint=False)\n    \n    # Discrete wavenumbers (k) and corresponding angles (theta = 2*pi*k*dx)\n    # k_freq corresponds to cycles per unit length\n    k_freq = np.fft.fftfreq(N, d=delta_x)\n    theta = 2 * np.pi * k_freq * delta_x\n\n    # Symbols of the finite difference operators in Fourier space\n    # First-order upwind difference symbol\n    D_up_hat = (1 - np.exp(-1j * theta)) / (delta_x + 1e-16)\n    \n    # Second-order centered difference symbol\n    # This form is numerically stable for small theta\n    D2_hat = -4 * (np.sin(theta / 2)**2) / (delta_x**2)\n    \n    # Initial condition\n    u0 = np.sin(2 * np.pi * k0 * x)\n    u0_hat = np.fft.fft(u0)\n\n    # Exact solution function\n    def u_exact(t, nu):\n        return np.exp(-nu * (2 * np.pi * k0)**2 * t) * np.sin(2 * np.pi * k0 * (x - a * t))\n\n    for nu in viscosities:\n        # 1. Compute CFL condition\n        dt_cfl = delta_x / np.abs(a)\n\n        # 2. Setup for IMEX and small-step implicit runs\n        dt_nominal_small = 0.9 * dt_cfl\n        M = int(np.ceil(T / dt_nominal_small))\n        dt_small = T / M\n\n        # 3. Setup for large-step implicit run\n        dt_nominal_large = 4.0 * dt_nominal_small\n        M_tilde = int(np.ceil(T / dt_nominal_large))\n        dt_large = T / M_tilde\n        \n        # --- Run IMEX Scheme ---\n        u_hat = np.copy(u0_hat)\n        # Pre-compute amplification factor for IMEX\n        g_imex = (1 - dt_small * a * D_up_hat) / (1 - dt_small * nu * D2_hat)\n        for _ in range(M):\n            u_hat *= g_imex\n        u_imex_T = np.fft.ifft(u_hat).real\n\n        # --- Run Fully Implicit Scheme (small dt) ---\n        u_hat = np.copy(u0_hat)\n        # Pre-compute amplification factor for Fully Implicit\n        g_imp_small = 1.0 / (1 + dt_small * a * D_up_hat - dt_small * nu * D2_hat)\n        for _ in range(M):\n            u_hat *= g_imp_small\n        u_imp_small_T = np.fft.ifft(u_hat).real\n        \n        # --- Run Fully Implicit Scheme (large dt) ---\n        u_hat = np.copy(u0_hat)\n        # Pre-compute amplification factor for Fully Implicit (large step)\n        g_imp_large = 1.0 / (1 + dt_large * a * D_up_hat - dt_large * nu * D2_hat)\n        for _ in range(M_tilde):\n            u_hat *= g_imp_large\n        u_imp_large_T = np.fft.ifft(u_hat).real\n        \n        # --- Calculate Errors ---\n        u_exact_T = u_exact(T, nu)\n\n        def l2_error(u_num, u_ex):\n            return np.sqrt(delta_x * np.sum((u_num - u_ex)**2))\n\n        error_imex = l2_error(u_imex_T, u_exact_T)\n        error_imp_small = l2_error(u_imp_small_T, u_exact_T)\n        error_imp_large = l2_error(u_imp_large_T, u_exact_T)\n\n        # --- Collect results for this viscosity ---\n        all_results.extend([\n            dt_cfl,\n            error_imex,\n            error_imp_small,\n            error_imp_large,\n            M,\n            M,\n            M_tilde\n        ])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```"
        }
    ]
}