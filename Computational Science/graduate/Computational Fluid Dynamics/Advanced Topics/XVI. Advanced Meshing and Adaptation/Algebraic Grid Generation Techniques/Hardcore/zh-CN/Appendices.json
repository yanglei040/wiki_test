{
    "hands_on_practices": [
        {
            "introduction": "在任何网格生成技术中，评估所生成网格的质量至关重要。雅可比行列式 $J$ 是一个核心的数学工具，它不仅量化了从计算空间到物理空间的局部面积变化，其符号和大小还直接关系到网格单元的有效性（有无翻转）和质量（疏密与畸变）。通过为给定的代数映射推导并诠释雅可比行列式 ，您将练习一项基本技能：将抽象的数学变换与网格的物理特性联系起来，这是诊断和生成高质量网格的基石。",
            "id": "3290596",
            "problem": "在计算流体动力学（CFD）的代数网格生成中，通过构建从计算域到物理域的映射来控制网格间距和方向。考虑从单位计算正方形 $\\{(\\xi,\\eta)\\,|\\,0 \\le \\xi \\le 1,\\,0 \\le \\eta \\le 1\\}$ 到物理平面的解析映射，其表达式如下\n$$\nx(\\xi,\\eta) \\;=\\; \\xi \\;+\\; \\alpha\\,\\xi\\,(1-\\xi)\\,\\bigl(2\\eta - 1\\bigr),\\qquad\ny(\\xi,\\eta) \\;=\\; \\eta \\;+\\; \\beta\\,\\eta\\,(1-\\eta)\\,\\bigl(2\\xi - 1\\bigr),\n$$\n其中 $\\alpha$ 和 $\\beta$ 是控制内部代数混合的实数参数。\n\n从平面映射的雅可比行列式定义以及面积变换中的基本变量替换原理出发，推导该映射的雅可比行列式 $J(\\xi,\\eta)$ 的精确解析表达式。然后，运用第一性原理进行推理，解释 $|J(\\xi,\\eta)|$ 较小的区域在生成的网格中对应的局部单元面积压缩、偏斜度和潜在的近翻转，并说明 $J$ 的符号和大小与单元方向和畸变的关系。\n\n请以包含 $\\xi$、$\\eta$、$\\alpha$ 和 $\\beta$ 的单一闭式解析表达式形式给出 $J(\\xi,\\eta)$ 的最终结果。无需进行数值计算，也无需四舍五入。最终表达式中不应包含任何单位。",
            "solution": "该问题是有效的。这是一个计算流体动力学领域中关于代数网格生成的适定、具有科学依据的问题。它要求推导和解释给定坐标变换的雅可比行列式，这是一项标准且可形式化的任务。\n\n从计算坐标 $(\\xi, \\eta)$ 到物理坐标 $(x, y)$ 的变换由以下映射给出：\n$$\nx(\\xi,\\eta) = \\xi + \\alpha\\,\\xi\\,(1-\\xi)\\,(2\\eta - 1)\n$$\n$$\ny(\\xi,\\eta) = \\eta + \\beta\\,\\eta\\,(1-\\eta)\\,(2\\xi - 1)\n$$\n该变换的雅可比行列式 $J(\\xi, \\eta)$ 定义为：\n$$\nJ(\\xi, \\eta) = \\frac{\\partial(x,y)}{\\partial(\\xi,\\eta)} = \\det \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix} = \\frac{\\partial x}{\\partial \\xi} \\frac{\\partial y}{\\partial \\eta} - \\frac{\\partial x}{\\partial \\eta} \\frac{\\partial y}{\\partial \\xi}\n$$\n为了计算 $J(\\xi, \\eta)$，我们首先求出所需的四个偏导数。\n\n1.  将 $x(\\xi, \\eta)$ 对 $\\xi$ 求导：\n    $$\n    \\frac{\\partial x}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi} \\left[ \\xi + \\alpha(\\xi - \\xi^2)(2\\eta - 1) \\right] = 1 + \\alpha(1-2\\xi)(2\\eta - 1)\n    $$\n\n2.  将 $x(\\xi, \\eta)$ 对 $\\eta$ 求导：\n    $$\n    \\frac{\\partial x}{\\partial \\eta} = \\frac{\\partial}{\\partial \\eta} \\left[ \\xi + \\alpha\\xi(1-\\xi)(2\\eta - 1) \\right] = \\alpha\\xi(1-\\xi)(2) = 2\\alpha\\xi(1-\\xi)\n    $$\n\n3.  将 $y(\\xi, \\eta)$ 对 $\\xi$ 求导：\n    $$\n    \\frac{\\partial y}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi} \\left[ \\eta + \\beta\\eta(1-\\eta)(2\\xi - 1) \\right] = \\beta\\eta(1-\\eta)(2) = 2\\beta\\eta(1-\\eta)\n    $$\n\n4.  将 $y(\\xi, \\eta)$ 对 $\\eta$ 求导：\n    $$\n    \\frac{\\partial y}{\\partial \\eta} = \\frac{\\partial}{\\partial \\eta} \\left[ \\eta + \\beta(\\eta - \\eta^2)(2\\xi - 1) \\right] = 1 + \\beta(1-2\\eta)(2\\xi - 1)\n    $$\n\n接下来，我们将这些偏导数代入行列式公式。\n$$\nJ(\\xi, \\eta) = \\left[ 1 + \\alpha(1-2\\xi)(2\\eta - 1) \\right] \\left[ 1 + \\beta(1-2\\eta)(2\\xi - 1) \\right] - \\left[ 2\\alpha\\xi(1-\\xi) \\right] \\left[ 2\\beta\\eta(1-\\eta) \\right]\n$$\n为了简化此表达式，我们注意到 $(2\\eta-1) = -(1-2\\eta)$ 和 $(2\\xi-1) = -(1-2\\xi)$。\n我们可以重写乘积的前两项：\n$$\n\\alpha(1-2\\xi)(2\\eta-1) = -\\alpha(1-2\\xi)(1-2\\eta)\n$$\n$$\n\\beta(1-2\\eta)(2\\xi-1) = -\\beta(1-2\\eta)(1-2\\xi)\n$$\n乘积项变为：\n$$\n\\left[ 1 - \\alpha(1-2\\xi)(1-2\\eta) \\right] \\left[ 1 - \\beta(1-2\\xi)(1-2\\eta) \\right]\n$$\n展开此乘积得到：\n$$\n1 - \\beta(1-2\\xi)(1-2\\eta) - \\alpha(1-2\\xi)(1-2\\eta) + \\alpha\\beta(1-2\\xi)^2(1-2\\eta)^2\n$$\n$$\n= 1 - (\\alpha+\\beta)(1-2\\xi)(1-2\\eta) + \\alpha\\beta(1-2\\xi)^2(1-2\\eta)^2\n$$\n雅可比表达式的第二部分是：\n$$\n\\left[ 2\\alpha\\xi(1-\\xi) \\right] \\left[ 2\\beta\\eta(1-\\eta) \\right] = 4\\alpha\\beta\\xi(1-\\xi)\\eta(1-\\eta)\n$$\n合并所有部分，雅可比行列式的完整表达式为：\n$$\nJ(\\xi, \\eta) = 1 - (\\alpha+\\beta)(1-2\\xi)(1-2\\eta) + \\alpha\\beta(1-2\\xi)^2(1-2\\eta)^2 - 4\\alpha\\beta\\xi(1-\\xi)\\eta(1-\\eta)\n$$\n这就是雅可比行列式的最终精确解析表达式。虽然它可以写成不同的代数形式，但无法进行更基本的简化。\n\n问题的第二部分要求对此结果进行解释。\n根据多变量微积分的原理，雅可比行列式 $J(\\xi, \\eta)$ 将计算域中的无穷小面積元 $d\\xi d\\eta$ 与物理域中相应的无穷小面積元 $dA$ 联系起来。它们的关系是 $dA = |J(\\xi, \\eta)| d\\xi d\\eta$。\n\n1.  **大小与单元面积：** 大小 $|J(\\xi, \\eta)|$ 代表了物理单元面积与计算单元面积的局部比率。\n    - $|J(\\xi, \\eta)|$ 较小的区域对应于网格点密度高的区域，其中物理单元被高度压缩。对于计算域中的均匀网格，较小的 $|J|$ 意味着较小的物理单元。这通常是为了解析具有高物理梯度（如边界层）的区域而有意为之。\n    - 相反，$|J(\\xi, \\eta)|$ 的较大值表示物理单元大于计算单元的区域，对应于网格分辨率较低的区域。\n\n2.  **符号与单元方向：** $J(\\xi, \\eta)$ 的符号对网格的有效性至关重要。\n    - 正雅可比行列式，$J(\\xi, \\eta) > 0$，表示映射保持局部方向不变。一个右手坐标系 $(\\xi, \\eta)$ 被映射到一个右手坐标系 $(x, y)$。这对应于一个物理上有效、不重叠的网格单元。对于有效的数值模拟，雅可比行列式必须在整个域内为正。\n    - 负雅可比行列式，$J(\\xi, \\eta) < 0$，表示局部方向被反转。网格单元发生了“翻转”或“折叠”。这是网格中的一个致命缺陷，因为它会导致单元重叠，并且对于任何标准的CFD求解器都是不可接受的。\n    - 零雅可比行列式，$J(\\xi, \\eta) = 0$，代表映射中的一个奇异点。在此点，网格线完全共线，单元面积坍缩为零。这是有效网格（正 $J$）和无效网格（负 $J$）之间的边界。必须选择参数 $\\alpha$ 和 $\\beta$ 以确保在域中所有的 $(\\xi, \\eta)$ 都有 $J(\\xi, \\eta) > 0$。\n\n3.  **畸变与偏斜度：** 虽然雅可比行列式根本上是面积（或三维中的体积）的度量，但其行为与单元质量度量（如偏斜度和纵横比）密切相关。当网格线变得高度非正交（高偏斜度）或单元被过度拉伸（高纵横比）时，单元面积往往会减小。因此，$|J(\\xi, \\eta)|$ 较小的区域通常（但并非总是）是单元畸变严重的区域。条件 $J \\to 0$ 明确表明网格正在变得退化，这可能表现为极端的偏斜度、纵横比或两者兼有，最终在 $J<0$ 时导致网格线交叉和翻转。",
            "answer": "$$\n\\boxed{1 - (\\alpha+\\beta)(1-2\\xi)(1-2\\eta) + \\alpha\\beta(1-2\\xi)^2(1-2\\eta)^2 - 4\\alpha\\beta\\xi(1-\\xi)\\eta(1-\\eta)}\n$$"
        },
        {
            "introduction": "掌握了网格质量的分析工具后，下一步是学习如何构建网格。超限插值（Transfinite Interpolation, TFI）是一种强大而经典的代数方法，它能够生成完全贴合给定边界曲线的结构化网格。该方法的核心思想是利用布尔和（Boolean sum）原理，将边界信息平滑地“混合”到区域内部。本练习  要求您从第一性原理出发，为一组复杂的曲线边界构建TFI映射，并计算内部点的位置，这将使您对TFI的构造过程获得具体而深刻的理解。",
            "id": "3290639",
            "problem": "在计算流体力学的代数网格生成中，根据四条解析边界曲线，在一个单位正方形参数域 $[0,1] \\times [0,1]$ 上构建一个内部映射。其中两条边界曲线是水平参数 $\\xi$ 的函数，另外两条是垂直参数 $\\eta$ 的函数。考虑物理平面 $\\mathbb{R}^{2}$ 中的以下四条边界曲线：\n- 底边（由 $\\xi$ 参数化）：$\\mathbf{c}_{1}(\\xi) = \\big(\\,\\xi + \\xi^{2}, \\tfrac{1}{2}\\,\\xi\\,\\big)$。\n- 顶边（由 $\\xi$ 参数化）：$\\mathbf{c}_{2}(\\xi) = \\big(\\,1 + \\tfrac{1}{2}\\cos(\\pi \\xi),\\, 1 + \\tfrac{1}{2}\\sin(\\pi \\xi)\\,\\big)$。\n- 左边（由 $\\eta$ 参数化）：$\\mathbf{d}_{1}(\\eta) = \\big(\\,\\tfrac{3}{2}\\,\\eta^{2},\\, \\eta\\,\\big)$。\n- 右边（由 $\\eta$ 参数化）：$\\mathbf{d}_{2}(\\eta) = \\big(\\,2 - \\tfrac{3}{2}\\,\\eta,\\, \\tfrac{1}{2} + \\tfrac{1}{2}\\,\\eta\\,\\big)$。\n\n这些曲线在四个角点处是一致的，即 $\\mathbf{c}_{1}(0) = \\mathbf{d}_{1}(0)$，$\\mathbf{c}_{1}(1) = \\mathbf{d}_{2}(0)$，$\\mathbf{c}_{2}(0) = \\mathbf{d}_{1}(1)$ 和 $\\mathbf{c}_{2}(1) = \\mathbf{d}_{2}(1)$。\n\n仅使用以下基本方法：(i) 沿参数线的一维线性插值，以及 (ii) 用于校正重复计算的角点贡献的容斥原理，从第一性原理出发构建一个在 $[0,1] \\times [0,1]$ 上的二维代数映射 $\\mathbf{x}(\\xi,\\eta)$，该映射能够混合这些边界并在边界上精确地重现它们。证明您所构建的映射满足边界重现性质 $\\mathbf{x}(\\xi,0) = \\mathbf{c}_{1}(\\xi)$，$\\mathbf{x}(\\xi,1) = \\mathbf{c}_{2}(\\xi)$，$\\mathbf{x}(0,\\eta) = \\mathbf{d}_{1}(\\eta)$ 和 $\\mathbf{x}(1,\\eta) = \\mathbf{d}_{2}(\\eta)$。\n\n最后，在内部点 $(\\xi_{0},\\eta_{0}) = \\big(\\tfrac{1}{3}, \\tfrac{2}{5}\\big)$ 处，评估所得到的超限插值（TFI）映射，并将 $\\mathbf{x}(\\tfrac{1}{3}, \\tfrac{2}{5})$ 以精确解析表达式的形式给出。将您的最终答案表示为一个二分量行向量。不需要进行四舍五入。",
            "solution": "目标是推导出一个能够插值四条边界曲线并在边界上重现它们的二维代数映射。推导过程基于以下基本思想：\n\n1. 沿参数域中坐标线的一维线性插值。给定与 $\\eta=0$ 和 $\\eta=1$ 相关联的两个向量值函数 $\\mathbf{a}(\\xi)$ 和 $\\mathbf{b}(\\xi)$，沿 $\\eta$ 方向的线性混合为\n$$\n\\mathbf{L}_{\\eta}(\\xi,\\eta) = (1-\\eta)\\,\\mathbf{a}(\\xi) + \\eta\\,\\mathbf{b}(\\xi).\n$$\n类似地，给定与 $\\xi=0$ 和 $\\xi=1$ 相关联的两个向量值函数 $\\mathbf{p}(\\eta)$ 和 $\\mathbf{q}(\\eta)$，沿 $\\xi$ 方向的线性混合为\n$$\n\\mathbf{L}_{\\xi}(\\xi,\\eta) = (1-\\xi)\\,\\mathbf{p}(\\eta) + \\xi\\,\\mathbf{q}(\\eta).\n$$\n\n2. 容斥原理（或布尔和）用于校正重复计算。如果我们简单地将两个一维混合 $\\mathbf{L}_{\\eta}$ 和 $\\mathbf{L}_{\\xi}$ 相加，角点将被计算两次。为了消除重复计算，我们减去四个角点的双线性插值，其使用标准的双线性形函数 $N_{00}=(1-\\xi)(1-\\eta)$，$N_{10}=\\xi(1-\\eta)$，$N_{01}=(1-\\xi)\\eta$，$N_{11}=\\xi\\eta$。\n\n我们首先确定必须相互一致的角点：\n$$\n\\mathbf{x}_{00} = \\mathbf{c}_{1}(0) = \\mathbf{d}_{1}(0),\\quad\n\\mathbf{x}_{10} = \\mathbf{c}_{1}(1) = \\mathbf{d}_{2}(0),\\quad\n\\mathbf{x}_{01} = \\mathbf{c}_{2}(0) = \\mathbf{d}_{1}(1),\\quad\n\\mathbf{x}_{11} = \\mathbf{c}_{2}(1) = \\mathbf{d}_{2}(1).\n$$\n根据所给数据，\n$$\n\\mathbf{x}_{00} = (0,0),\\quad\n\\mathbf{x}_{10} = (2,\\tfrac{1}{2}),\\quad\n\\mathbf{x}_{01} = (\\tfrac{3}{2},1),\\quad\n\\mathbf{x}_{11} = (\\tfrac{1}{2},1).\n$$\n\n使用给定的边界构造一维混合：\n- 沿 $\\eta$ 方向，在 $\\mathbf{c}_{1}(\\xi)$ 和 $\\mathbf{c}_{2}(\\xi)$ 之间：\n$$\n\\mathbf{L}_{\\eta}(\\xi,\\eta) = (1-\\eta)\\,\\mathbf{c}_{1}(\\xi) + \\eta\\,\\mathbf{c}_{2}(\\xi).\n$$\n- 沿 $\\xi$ 方向，在 $\\mathbf{d}_{1}(\\eta)$ 和 $\\mathbf{d}_{2}(\\eta)$ 之间：\n$$\n\\mathbf{L}_{\\xi}(\\xi,\\eta) = (1-\\xi)\\,\\mathbf{d}_{1}(\\eta) + \\xi\\,\\mathbf{d}_{2}(\\eta).\n$$\n\n为了校正角点的重复计算，减去双线性角点插值\n$$\n\\mathbf{B}(\\xi,\\eta) = (1-\\xi)(1-\\eta)\\,\\mathbf{x}_{00} + \\xi(1-\\eta)\\,\\mathbf{x}_{10} + (1-\\xi)\\eta\\,\\mathbf{x}_{01} + \\xi\\eta\\,\\mathbf{x}_{11}.\n$$\n\n因此，从第一性原理构造的超限插值（TFI）映射为\n$$\n\\mathbf{x}(\\xi,\\eta) \\;=\\; \\mathbf{L}_{\\eta}(\\xi,\\eta) \\;+\\; \\mathbf{L}_{\\xi}(\\xi,\\eta) \\;-\\; \\mathbf{B}(\\xi,\\eta).\n$$\n\n现在我们验证边界重现性质：\n\n1. 底边 $\\eta=0$：\n代入 $\\eta=0$：\n$$\n\\mathbf{x}(\\xi,0) = (1-0)\\mathbf{c}_{1}(\\xi) + 0\\cdot \\mathbf{c}_{2}(\\xi) + (1-\\xi)\\mathbf{d}_{1}(0) + \\xi \\mathbf{d}_{2}(0) - \\big[(1-\\xi)(1-0)\\mathbf{x}_{00} + \\xi(1-0)\\mathbf{x}_{10} + (1-\\xi)0\\,\\mathbf{x}_{01} + \\xi 0\\,\\mathbf{x}_{11}\\big].\n$$\n由于 $\\mathbf{d}_{1}(0)=\\mathbf{x}_{00}$ 和 $\\mathbf{d}_{2}(0)=\\mathbf{x}_{10}$，后两项与双线性角点项完全抵消，剩下\n$$\n\\mathbf{x}(\\xi,0) = \\mathbf{c}_{1}(\\xi).\n$$\n\n2. 顶边 $\\eta=1$：\n类似地，\n$$\n\\mathbf{x}(\\xi,1) = (1-1)\\mathbf{c}_{1}(\\xi) + 1\\cdot \\mathbf{c}_{2}(\\xi) + (1-\\xi)\\mathbf{d}_{1}(1) + \\xi \\mathbf{d}_{2}(1) - \\big[(1-\\xi)0\\,\\mathbf{x}_{00} + \\xi 0\\,\\mathbf{x}_{10} + (1-\\xi)1\\,\\mathbf{x}_{01} + \\xi 1\\,\\mathbf{x}_{11}\\big].\n$$\n使用 $\\mathbf{d}_{1}(1)=\\mathbf{x}_{01}$ 和 $\\mathbf{d}_{2}(1)=\\mathbf{x}_{11}$，最后两项与减去的角点项抵消，得到\n$$\n\\mathbf{x}(\\xi,1) = \\mathbf{c}_{2}(\\xi).\n$$\n\n3. 左边 $\\xi=0$：\n$$\n\\mathbf{x}(0,\\eta) = (1-\\eta)\\mathbf{c}_{1}(0) + \\eta \\mathbf{c}_{2}(0) + (1-0)\\mathbf{d}_{1}(\\eta) + 0\\cdot \\mathbf{d}_{2}(\\eta) - \\big[(1-0)(1-\\eta)\\mathbf{x}_{00} + 0(1-\\eta)\\mathbf{x}_{10} + (1-0)\\eta\\,\\mathbf{x}_{01} + 0\\cdot \\eta\\,\\mathbf{x}_{11}\\big].\n$$\n使用 $\\mathbf{c}_{1}(0)=\\mathbf{x}_{00}$ 和 $\\mathbf{c}_{2}(0)=\\mathbf{x}_{01}$，相加的项与减去的双线性角点项抵消，得到\n$$\n\\mathbf{x}(0,\\eta) = \\mathbf{d}_{1}(\\eta).\n$$\n\n4. 右边 $\\xi=1$：\n$$\n\\mathbf{x}(1,\\eta) = (1-\\eta)\\mathbf{c}_{1}(1) + \\eta \\mathbf{c}_{2}(1) + (1-1)\\mathbf{d}_{1}(\\eta) + 1\\cdot \\mathbf{d}_{2}(\\eta) - \\big[(1-1)(1-\\eta)\\mathbf{x}_{00} + 1(1-\\eta)\\mathbf{x}_{10} + (1-1)\\eta\\,\\mathbf{x}_{01} + 1\\cdot \\eta\\,\\mathbf{x}_{11}\\big].\n$$\n使用 $\\mathbf{c}_{1}(1)=\\mathbf{x}_{10}$ 和 $\\mathbf{c}_{2}(1)=\\mathbf{x}_{11}$，这些项再次抵消，得到\n$$\n\\mathbf{x}(1,\\eta) = \\mathbf{d}_{2}(\\eta).\n$$\n因此，该映射精确地重现了所有四个边界。\n\n现在我们使用明确的数据在 $(\\xi,\\eta)=\\big(\\tfrac{1}{3},\\tfrac{2}{5}\\big)$ 处对 $\\mathbf{x}(\\xi,\\eta)$进行求值。\n\n计算在指定参数处的边界值：\n$$\n\\mathbf{c}_{1}\\!\\big(\\tfrac{1}{3}\\big) = \\Big(\\tfrac{1}{3} + \\tfrac{1}{9},\\, \\tfrac{1}{2}\\cdot \\tfrac{1}{3}\\Big) = \\Big(\\tfrac{4}{9},\\, \\tfrac{1}{6}\\Big),\n$$\n$$\n\\mathbf{c}_{2}\\!\\big(\\tfrac{1}{3}\\big) = \\Big(1 + \\tfrac{1}{2}\\cos\\tfrac{\\pi}{3},\\, 1 + \\tfrac{1}{2}\\sin\\tfrac{\\pi}{3}\\Big) = \\Big(1 + \\tfrac{1}{2}\\cdot \\tfrac{1}{2},\\, 1 + \\tfrac{1}{2}\\cdot \\tfrac{\\sqrt{3}}{2}\\Big) = \\Big(\\tfrac{5}{4},\\, 1 + \\tfrac{\\sqrt{3}}{4}\\Big),\n$$\n$$\n\\mathbf{d}_{1}\\!\\big(\\tfrac{2}{5}\\big) = \\Big(\\tfrac{3}{2}\\cdot \\big(\\tfrac{2}{5}\\big)^{2},\\, \\tfrac{2}{5}\\Big) = \\Big(\\tfrac{6}{25},\\, \\tfrac{2}{5}\\Big),\n$$\n$$\n\\mathbf{d}_{2}\\!\\big(\\tfrac{2}{5}\\big) = \\Big(2 - \\tfrac{3}{2}\\cdot \\tfrac{2}{5},\\, \\tfrac{1}{2} + \\tfrac{1}{2}\\cdot \\tfrac{2}{5}\\Big) = \\Big(\\tfrac{7}{5},\\, \\tfrac{7}{10}\\Big).\n$$\n角点为\n$$\n\\mathbf{x}_{00}=(0,0),\\quad \\mathbf{x}_{10}=(2,\\tfrac{1}{2}),\\quad \\mathbf{x}_{01}=(\\tfrac{3}{2},1),\\quad \\mathbf{x}_{11}=(\\tfrac{1}{2},1).\n$$\n\n当 $(\\xi,\\eta)=\\big(\\tfrac{1}{3},\\tfrac{2}{5}\\big)$ 时，该映射的计算结果为\n$$\n\\mathbf{x} = (1-\\eta)\\,\\mathbf{c}_{1}(\\xi) + \\eta\\,\\mathbf{c}_{2}(\\xi) + (1-\\xi)\\,\\mathbf{d}_{1}(\\eta) + \\xi\\,\\mathbf{d}_{2}(\\eta) \\;-\\; \\Big[(1-\\xi)(1-\\eta)\\,\\mathbf{x}_{00} + \\xi(1-\\eta)\\,\\mathbf{x}_{10} + (1-\\xi)\\eta\\,\\mathbf{x}_{01} + \\xi\\eta\\,\\mathbf{x}_{11}\\Big].\n$$\n计算标量权重：\n$$\n1-\\eta = \\tfrac{3}{5},\\quad 1-\\xi = \\tfrac{2}{3},\\quad \\xi = \\tfrac{1}{3},\\quad \\eta = \\tfrac{2}{5}.\n$$\n首先，是四个混合项：\n$$\n(1-\\eta)\\,\\mathbf{c}_{1}(\\xi) = \\tfrac{3}{5}\\,\\Big(\\tfrac{4}{9},\\,\\tfrac{1}{6}\\Big) = \\Big(\\tfrac{4}{15},\\,\\tfrac{1}{10}\\Big),\n$$\n$$\n\\eta\\,\\mathbf{c}_{2}(\\xi) = \\tfrac{2}{5}\\,\\Big(\\tfrac{5}{4},\\,1 + \\tfrac{\\sqrt{3}}{4}\\Big) = \\Big(\\tfrac{1}{2},\\, \\tfrac{2}{5} + \\tfrac{\\sqrt{3}}{10}\\Big),\n$$\n$$\n(1-\\xi)\\,\\mathbf{d}_{1}(\\eta) = \\tfrac{2}{3}\\,\\Big(\\tfrac{6}{25},\\,\\tfrac{2}{5}\\Big) = \\Big(\\tfrac{4}{25},\\,\\tfrac{4}{15}\\Big),\n$$\n$$\n\\xi\\,\\mathbf{d}_{2}(\\eta) = \\tfrac{1}{3}\\,\\Big(\\tfrac{7}{5},\\,\\tfrac{7}{10}\\Big) = \\Big(\\tfrac{7}{15},\\,\\tfrac{7}{30}\\Big).\n$$\n将这四项相加得到\n$$\n\\mathbf{S}_{1} = \\Big(\\tfrac{209}{150},\\, 1 + \\tfrac{\\sqrt{3}}{10}\\Big).\n$$\n\n接下来，是双线性角点减法项：\n$$\n(1-\\xi)(1-\\eta)\\,\\mathbf{x}_{00} = \\tfrac{2}{5}\\,(0,0) = (0,0),\n$$\n$$\n\\xi(1-\\eta)\\,\\mathbf{x}_{10} = \\tfrac{1}{5}\\,(2,\\tfrac{1}{2}) = \\Big(\\tfrac{2}{5},\\,\\tfrac{1}{10}\\Big),\n$$\n$$\n(1-\\xi)\\eta\\,\\mathbf{x}_{01} = \\tfrac{4}{15}\\,(\\tfrac{3}{2},1) = \\Big(\\tfrac{2}{5},\\,\\tfrac{4}{15}\\Big),\n$$\n$$\n\\xi\\eta\\,\\mathbf{x}_{11} = \\tfrac{2}{15}\\,(\\tfrac{1}{2},1) = \\Big(\\tfrac{1}{15},\\,\\tfrac{2}{15}\\Big).\n$$\n将这四项相加得到\n$$\n\\mathbf{S}_{2} = \\Big(\\tfrac{13}{15},\\, \\tfrac{1}{2}\\Big).\n$$\n\n因此，\n$$\n\\mathbf{x}\\!\\Big(\\tfrac{1}{3},\\tfrac{2}{5}\\Big) \\;=\\; \\mathbf{S}_{1} - \\mathbf{S}_{2} \\;=\\; \\Big(\\tfrac{209}{150} - \\tfrac{13}{15},\\, 1 + \\tfrac{\\sqrt{3}}{10} - \\tfrac{1}{2}\\Big) \\;=\\; \\Big(\\tfrac{79}{150},\\, \\tfrac{5+\\sqrt{3}}{10}\\Big).\n$$\n这是由所构造的超限插值映射产生的内部点的精确解析表达式，并且其边界重现性质已通过一维混合和容斥原理从第一性原理得到证实。",
            "answer": "$$\\boxed{\\begin{pmatrix}\\frac{79}{150} & \\frac{5+\\sqrt{3}}{10}\\end{pmatrix}}$$"
        },
        {
            "introduction": "理论与实践的结合是计算流体力学（CFD）研究的核心。在模拟中，精确解析固体表面附近的薄边界层至关重要，而这通常通过在垂直于壁面的方向上布置加密的网格来实现。本练习  将引导您为一个典型的CFD应用——边界层网格——编写程序，您将使用几何级数来控制网格的拉伸，并处理保证网格光滑性和数值稳定性的实际问题。这个实践将理论知识（几何级数）与CFD中的一个关键工程需求紧密地联系在一起。",
            "id": "3290607",
            "problem": "使用层厚度的等比数列，构建一个适用于计算流体动力学（CFD, Computational Fluid Dynamics）的一维、垂直于壁面的代数网格。在完全无量纲化的设置中进行操作，因此所有量均为无量纲。从以下基本基础开始：等比数列的定义和累加和的定义。设第一层厚度表示为 $\\Delta y_{1} > 0$，增长因子为 $r > 0$，节点总数为 $N \\in \\mathbb{N}$ 且 $N \\geq 1$。将层厚度序列 $\\{s_{k}\\}_{k=1}^{N-1}$ 定义为 $s_{1} = \\Delta y_{1}$ 和 $s_{k} = s_{1}\\, r^{k-1}$（对于 $k \\geq 2$）。定义节点索引 $k \\in \\{0,1,\\dots,N-1\\}$，设 $y_{0} = 0$，并定义节点位置为 $y_{k} = \\sum_{j=1}^{k} s_{j}$（对于 $k \\geq 1$）。同时定义相邻间距比 $q_{k} = s_{k}/s_{k-1}$（对于 $k \\geq 2$）。如果所有已定义的比率 $q_{k}$ 均位于给定的闭区间 $[\\underline{q},\\overline{q}]$ 内（其中 $\\underline{q} > 0$ 和 $\\overline{q} > 0$），则称该网格满足光滑性准则。\n\n任务：\n- 严格地从上述定义和经过充分检验的等比级数部分和公式出发，推导出当 $r \\neq 1$ 时 $y_{k}$ 的闭式表达式，以及当 $r \\to 1$ 时的极限表达式。实现一个在 $r$ 接近 $1$ 时依然精确的数值鲁棒计算。\n- 计算节点位置向量 $\\{y_{k}\\}_{k=0}^{N-1}$ 和最终高度 $H = y_{N-1}$。\n- 通过评估所有适用的比率 $q_{k}$（对于 $k \\in \\{2,\\dots,N-1\\}$）是否满足 $\\underline{q} \\le q_{k} \\le \\overline{q}$ 来评估光滑性。如果没有这样的 $q_{k}$（例如，如果 $N \\le 2$），则将光滑性准则视为满足。此外，确保序列 $\\{y_{k}\\}$ 是严格递增的，这与 $\\Delta y_{1} > 0$ 和 $r > 0$ 一致。\n\n您的程序必须实现以上要求，并为每个测试用例生成一个双元素列表 $[H,\\text{is\\_smooth}]$，其中 $H$ 是一个等于 $y_{N-1}$ 的浮点数，而 $\\text{is\\_smooth}$ 是一个布尔值，指示光滑性准则是否成立且节点是否严格递增。将所有测试用例的结果汇总到一个列表中，并打印包含此汇总列表的单行，采用标准 Python 列表语法。\n\n使用以下参数值测试套件，每个测试用例指定为 $(\\Delta y_{1}, r, N, \\underline{q}, \\overline{q})$：\n- 测试 A：$(\\Delta y_{1}, r, N, \\underline{q}, \\overline{q}) = (\\,0.02,\\, 1.2,\\, 6,\\, 1.1,\\, 1.3\\,)$。\n- 测试 B：$(\\Delta y_{1}, r, N, \\underline{q}, \\overline{q}) = (\\,0.015,\\, 1.0,\\, 5,\\, 0.98,\\, 1.02\\,)$。\n- 测试 C：$(\\Delta y_{1}, r, N, \\underline{q}, \\overline{q}) = (\\,0.01,\\, 0.8,\\, 8,\\, 0.75,\\, 0.85\\,)$。\n- 测试 D：$(\\Delta y_{1}, r, N, \\underline{q}, \\overline{q}) = (\\,0.02,\\, 1.5,\\, 7,\\, 1.1,\\, 1.4\\,)$。\n- 测试 E：$(\\Delta y_{1}, r, N, \\underline{q}, \\overline{q}) = (\\,0.01,\\, 1.3,\\, 1,\\, 1.0,\\, 1.5\\,)$。\n- 测试 F：$(\\Delta y_{1}, r, N, \\underline{q}, \\overline{q}) = (\\,0.02,\\, 1.0000000001,\\, 4,\\, 0.999999,\\, 1.000001\\,)$。\n\n最终输出格式：您的程序应生成单行输出，其中包含一个 Python 列表，该列表由每个测试的结果组成，每个测试结果本身是一个双元素列表 $[H,\\text{is\\_smooth}]$。例如，语法模板为 $[[H_{A},\\text{is\\_smooth}_{A}], [H_{B},\\text{is\\_smooth}_{B}], \\dots]$。所有输出均为无单位的实数和布尔值。不涉及角度，也不使用百分比。输出必须打印在单行上，不得包含任何附加文本。",
            "solution": "该问题要求构建并验证一个一维代数网格。解决方案首先从给定的定义中推导出必要的解析表达式，然后建立验证程序。\n\n网格节点的位置 $\\{y_{k}\\}_{k=0}^{N-1}$ 是相对于 $y_{0} = 0$ 处的壁面定义的。对于 $k \\geq 1$，$y_{k}$ 的位置是前面各层厚度的累加和。第 $j$ 层的厚度 $s_{j}$ 由一个等比数列给出：\n$$s_{j} = \\Delta y_{1} r^{j-1} \\quad \\text{for } j \\in \\{1, 2, \\dots, N-1\\}$$\n其中 $\\Delta y_{1} > 0$ 是第一层的厚度，$r > 0$ 是增长因子。\n\n因此，对于 $k \\geq 1$，$y_{k}$ 的位置是此等比数列的前 $k$ 项之和：\n$$y_{k} = \\sum_{j=1}^{k} s_{j} = \\sum_{j=1}^{k} \\Delta y_{1} r^{j-1} = \\Delta y_{1} \\sum_{j=0}^{k-1} r^{j}$$\n这是等比级数的部分和。\n\n对于增长因子 $r \\neq 1$ 的情况，该和有一个众所周知的闭式表达式：\n$$\\sum_{j=0}^{k-1} r^{j} = \\frac{1-r^{k}}{1-r}$$\n将此代入 $y_{k}$ 的表达式中可得：\n$$y_{k} = \\Delta y_{1} \\frac{1-r^{k}}{1-r} \\quad (r \\neq 1)$$\n\n对于 $r=1$ 的情况，所有层的厚度都相等，$s_{j} = \\Delta y_{1}$。和变为：\n$$y_{k} = \\sum_{j=1}^{k} \\Delta y_{1} = k \\Delta y_{1} \\quad (r=1)$$\n这个结果也可以通过对 $y_{k}$ 的通用表达式取 $r \\to 1$ 的极限得到。对 $0/0$ 的不定型使用 L'Hôpital 法则：\n$$\\lim_{r \\to 1} y_{k} = \\Delta y_{1} \\lim_{r \\to 1} \\frac{1-r^{k}}{1-r} = \\Delta y_{1} \\lim_{r \\to 1} \\frac{\\frac{d}{dr}(1-r^{k})}{\\frac{d}{dr}(1-r)} = \\Delta y_{1} \\lim_{r \\to 1} \\frac{-k r^{k-1}}{-1} = k \\Delta y_{1}$$\n\n对于数值实现，当 $r$ 接近 $1$ 时，由于分子和分母都趋近于零，用于 $r \\neq 1$ 的公式会遭受灾难性抵消。为了创建一个数值鲁棒的计算，我们可以用指数和对数函数重写该表达式：\n$$\\frac{1-r^{k}}{1-r} = \\frac{r^{k}-1}{r-1} = \\frac{\\exp(k \\ln r) - 1}{\\exp(\\ln r) - 1}$$\n使用专门的库函数如 `expm1(x)` 可以精确计算此形式，该函数能高精度地计算小 $x$ 的 $\\exp(x)-1$。这避免了有效数字的损失。实现将对所有 $r \\neq 1$ 使用此鲁棒公式。\n\n网格的总高度是 $H = y_{N-1}$，即最后一个节点的位置。\n\n网格的验证涉及两个准则：光滑性和单调性。\n\n首先，光滑性准则要求相邻间距比 $q_{k}$ 在所有适用索引的闭区间 $[\\underline{q}, \\overline{q}]$ 内。该比率定义为 $q_{k} = s_{k}/s_{k-1}$（对于 $k \\in \\{2, \\dots, N-1\\}$）。代入 $s_{k}$ 的定义：\n$$q_{k} = \\frac{s_{k}}{s_{k-1}} = \\frac{\\Delta y_{1} r^{k-1}}{\\Delta y_{1} r^{(k-1)-1}} = \\frac{r^{k-1}}{r^{k-2}} = r$$\n比率 $q_{k}$ 是恒定的，等于增长因子 $r$。因此，光滑性检查简化为验证 $\\underline{q} \\le r \\le \\overline{q}$ 是否成立。仅当索引集 $\\{2, \\dots, N-1\\}$ 非空时（即当 $N > 2$ 时）才执行此检查。如果 $N \\le 2$，则按照问题规定，光滑性准则被空泛地满足。\n\n其次，节点位置 $\\{y_{k}\\}$ 必须形成一个严格递增的序列。这要求对于所有 $k \\in \\{1, \\dots, N-1\\}$ 都有 $y_{k} > y_{k-1}$。相邻节点位置之间的差是：\n$$y_{k} - y_{k-1} = \\left(\\sum_{j=1}^{k} s_{j}\\right) - \\left(\\sum_{j=1}^{k-1} s_{j}\\right) = s_{k}$$\n因此，严格单调性的条件是对于 $k \\in \\{1, \\dots, N-1\\}$ 都有 $s_{k} > 0$。由于 $s_{k} = \\Delta y_{1} r^{k-1}$，且问题陈述 $\\Delta y_{1} > 0$ 和 $r > 0$，可以得出对于任何整数 $k \\geq 1$ 都有 $r^{k-1} > 0$。因此，$s_{k}$ 总是正数。所以，单调性条件由问题的约束条件内在地满足了。尽管如此，为了完全的严谨性，实现中将显式地检查此属性。\n\n每个测试用例的最终布尔结果是光滑性和单调性检查结果的逻辑与。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the algebraic grid generation problem for a suite of test cases.\n    \"\"\"\n    test_cases = [\n        # (delta_y1, r, N, q_min, q_max)\n        (0.02, 1.2, 6, 1.1, 1.3),\n        (0.015, 1.0, 5, 0.98, 1.02),\n        (0.01, 0.8, 8, 0.75, 0.85),\n        (0.02, 1.5, 7, 1.1, 1.4),\n        (0.01, 1.3, 1, 1.0, 1.5),\n        (0.02, 1.0000000001, 4, 0.999999, 1.000001),\n    ]\n\n    results = []\n    for case in test_cases:\n        delta_y1, r, N, q_min, q_max = case\n\n        # --- Node Position Calculation ---\n        y_nodes = np.zeros(N, dtype=np.float64)\n        \n        if N > 1:\n            if r == 1.0:\n                # Linear spacing for r = 1\n                for k in range(1, N):\n                    y_nodes[k] = k * delta_y1\n            else:\n                # Geometric spacing for r != 1, using a numerically robust formula\n                log_r = np.log(r)\n                expm1_log_r = np.expm1(log_r)\n                \n                for k in range(1, N):\n                    # Robust calculation of (r^k - 1) / (r - 1)\n                    factor = np.expm1(k * log_r) / expm1_log_r\n                    y_nodes[k] = delta_y1 * factor\n        \n        # The final height H is the position of the last node, y_{N-1}.\n        # For N=1, y_nodes is [0.], so y_nodes[-1] correctly yields 0.\n        H = y_nodes[-1]\n\n        # --- Validation ---\n        \n        # 1. Smoothness check\n        # The adjacent spacing ratio q_k is constant and equals r.\n        # The check only applies if N > 2, otherwise it's vacuously true.\n        is_smoothness_ok = True\n        if N > 2:\n            if not (q_min <= r <= q_max):\n                is_smoothness_ok = False\n        \n        # 2. Strict monotonicity check\n        # The constraint delta_y1 > 0 and r > 0 ensures this mathematically.\n        # This check is included for computational rigor.\n        is_monotonic = True\n        if N > 1:\n            for k in range(1, N):\n                if y_nodes[k] <= y_nodes[k-1]:\n                    is_monotonic = False\n                    break\n        \n        # Combine both conditions for the final boolean result\n        is_valid_grid = is_smoothness_ok and is_monotonic\n\n        results.append([H, is_valid_grid])\n\n    # Format the final list of results into the specified string format.\n    # The default str() for a list is '[item1, item2, ...]'\n    # The default str() for a float and bool match Python syntax.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}