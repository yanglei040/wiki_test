{
    "hands_on_practices": [
        {
            "introduction": "Effective boundary-layer meshing hinges on a fundamental trade-off: achieving sufficient resolution in the near-wall region while minimizing the total number of cells to maintain computational efficiency. This practice challenges you to formalize this trade-off as a constrained optimization problem, a core skill for any CFD practitioner. By deriving the optimal number of layers and growth rate based on standard constraints like the target wall-normal spacing ($y^+$) and total boundary-layer thickness ($\\delta$), you will gain insight into the mathematical principles that govern automated meshing algorithms .",
            "id": "3296993",
            "problem": "A boundary-layer mesh is to be generated using a geometric progression of wall-normal layer thicknesses. Let the first layer thickness be $\\Delta y_{1}$ and the $i$-th layer thickness be $\\Delta y_{i} = \\Delta y_{1}\\,r^{i-1}$, with growth factor $r>1$. The total thickness of a column of $N_{\\ell}$ layers is then $$\\sum_{i=1}^{N_{\\ell}} \\Delta y_{i} = \\Delta y_{1}\\,\\frac{r^{N_{\\ell}} - 1}{r - 1}.$$ You are tasked with minimizing the number of degrees of freedom (DOF) associated with the wall-normal layering, which in this column is proportional to the layer count $N_{\\ell}$, subject to two design constraints used in computational fluid dynamics boundary-layer mesh generation:\n\n1. The wall unit constraint on the first cell height, defined by the friction-velocity-based wall unit $y^{+}$, requires $y^{+}_{1} \\leq y^{+}_{\\max}$, where $$y^{+}_{1} = \\frac{\\Delta y_{1}\\,u_{\\tau}}{\\nu},$$ with $u_{\\tau}$ the friction velocity and $\\nu$ the kinematic viscosity.\n\n2. The total wall-normal coverage of the boundary-layer mesh must meet or exceed a target thickness $\\delta$, i.e., $$\\sum_{i=1}^{N_{\\ell}} \\Delta y_{i} \\geq \\delta.$$\n\nAdditionally, for mesh quality, the growth factor is bounded above by a prescribed limit $r_{\\max}>1$ (i.e., $1<r\\leq r_{\\max}$). Assume the flow parameters $u_{\\tau}$, $\\nu$, $y^{+}_{\\max}$, and the target coverage $\\delta$ are known positive constants, and that the DOF cost depends only on $N_{\\ell}$. For the purpose of continuous optimization, relax $N_{\\ell}\\in\\mathbb{N}$ to $N_{\\ell}\\in\\mathbb{R}_{+}$.\n\nFormulate the constrained optimization problem to minimize $N_{\\ell}$ with decision variables $N_{\\ell}$ and $r$, treating $\\Delta y_{1}$ as determined by the $y^{+}$ constraint, and derive the Karush–Kuhn–Tucker (KKT) conditions. Use these conditions, together with first principles and the geometric-series relation, to obtain a closed-form analytic expression for the optimal continuous layer count $N_{\\ell}^{\\ast}$ in terms of $\\delta$, $\\nu$, $u_{\\tau}$, $y^{+}_{\\max}$, and $r_{\\max}$. Express your final answer as a single analytic expression. No numerical evaluation is required. If any rounding were necessary, it would be specified via significant figures, but do not round here. The final answer is dimensionless and requires no units.",
            "solution": "The problem is subjected to validation before a solution is attempted.\n\n### Step 1: Extract Givens\n-   The thickness of the $i$-th layer is $\\Delta y_{i} = \\Delta y_{1}\\,r^{i-1}$, where $r>1$ is the growth factor.\n-   The total thickness of $N_{\\ell}$ layers is $\\sum_{i=1}^{N_{\\ell}} \\Delta y_{i} = \\Delta y_{1}\\,\\frac{r^{N_{\\ell}} - 1}{r - 1}$.\n-   The objective is to minimize the number of layers, $N_{\\ell}$.\n-   Constraint 1: Wall unit constraint, $y^{+}_{1} \\leq y^{+}_{\\max}$, where $y^{+}_{1} = \\frac{\\Delta y_{1}\\,u_{\\tau}}{\\nu}$.\n-   Constraint 2: Total thickness constraint, $\\sum_{i=1}^{N_{\\ell}} \\Delta y_{i} \\geq \\delta$.\n-   Constraint 3: Growth factor upper bound, $r \\leq r_{\\max}$, with $r>1$.\n-   Known positive constants: friction velocity $u_{\\tau}$, kinematic viscosity $\\nu$, maximum wall unit $y^{+}_{\\max}$, target thickness $\\delta$, and maximum growth factor $r_{\\max} > 1$.\n-   The layer count $N_{\\ell}$ is relaxed from $\\mathbb{N}$ to $\\mathbb{R}_{+}$.\n-   Decision variables are $N_{\\ell}$ and $r$.\n-   $\\Delta y_{1}$ is to be treated as determined by the $y^{+}$ constraint.\n\n### Step 2: Validate Using Extracted Givens\n-   **Scientifically Grounded:** The problem uses standard and correct formulae for a geometric progression of layer thicknesses in boundary-layer meshing, a common practice in Computational Fluid Dynamics (CFD). The $y^{+}$ constraint is a fundamental concept in wall-resolved turbulence modeling. The problem is scientifically sound.\n-   **Well-Posed:** The problem defines a clear objective function (minimize $N_{\\ell}$) and a set of well-defined constraints. The relaxation of $N_{\\ell}$ to a real number makes the problem amenable to continuous optimization methods like KKT. The existence and uniqueness of the solution depend on the problem parameters, which will be addressed in the solution, but the structure is well-posed.\n-   **Objective:** The language is formal, precise, and free of subjective statements.\n-   The problem is self-contained, with all necessary parameters defined. The constraints are not contradictory.\n\n### Step 3: Verdict and Action\nThe problem is deemed valid. A solution will be provided.\n\n### Solution Formulation and Derivation\n\nThe task is to solve a constrained optimization problem. The objective is to minimize the number of layers $N_{\\ell}$. The decision variables are $N_{\\ell} \\in \\mathbb{R}_{+}$ and the growth factor $r \\in (1, r_{\\max}]$.\n\nThe optimization problem can be stated as:\nMinimize $N_{\\ell}$\nSubject to:\n1.  $\\frac{\\Delta y_{1}\\,u_{\\tau}}{\\nu} \\leq y^{+}_{\\max}$\n2.  $\\Delta y_{1}\\,\\frac{r^{N_{\\ell}} - 1}{r - 1} \\geq \\delta$\n3.  $1 < r \\leq r_{\\max}$\n\nTo minimize $N_{\\ell}$, we should make each layer as thick as possible. This means we should choose the largest allowable value for the first layer thickness, $\\Delta y_{1}$. From constraint (1), the upper bound for $\\Delta y_{1}$ is found by setting the inequality to an equality:\n$$ \\frac{\\Delta y_{1}\\,u_{\\tau}}{\\nu} = y^{+}_{\\max} \\implies \\Delta y_{1} = \\frac{y^{+}_{\\max} \\nu}{u_{\\tau}} $$\nUsing this largest possible $\\Delta y_{1}$ will help satisfy the total thickness requirement (constraint 2) with the minimum number of layers. By making this choice, $\\Delta y_{1}$ is no longer a variable but a fixed value determined by the problem parameters.\n\nSimilarly, to minimize $N_{\\ell}$ for any given $r$ and $\\Delta y_1$, the total thickness generated by the formula must be as large as possible. This means the total thickness constraint should be active, i.e., an equality:\n$$ \\sum_{i=1}^{N_{\\ell}} \\Delta y_{i} = \\delta $$\nSubstituting the expressions for $\\Delta y_1$ and the sum into this equality yields:\n$$ \\left( \\frac{y^{+}_{\\max} \\nu}{u_{\\tau}} \\right) \\frac{r^{N_{\\ell}} - 1}{r - 1} = \\delta $$\nThis equation implicitly defines $N_{\\ell}$ as a function of $r$. We can solve for $N_{\\ell}(r)$:\n$$ \\frac{r^{N_{\\ell}} - 1}{r - 1} = \\frac{\\delta u_{\\tau}}{y^{+}_{\\max} \\nu} $$\nLet us define a dimensionless constant $C = \\frac{\\delta u_{\\tau}}{y^{+}_{\\max} \\nu}$. This constant represents the ratio of the target total thickness $\\delta$ to the maximum allowable first layer thickness $\\Delta y_1$. The equation becomes:\n$$ \\frac{r^{N_{\\ell}} - 1}{r - 1} = C $$\nSolving for $N_{\\ell}$:\n$$ r^{N_{\\ell}} - 1 = C(r-1) $$\n$$ r^{N_{\\ell}} = 1 + C(r-1) $$\n$$ N_{\\ell} \\ln(r) = \\ln(1 + C(r-1)) $$\n$$ N_{\\ell}(r) = \\frac{\\ln(1 + C(r-1))}{\\ln(r)} $$\nThe optimization problem has been reduced to finding the minimum value of the function $N_{\\ell}(r)$ over the interval $r \\in (1, r_{\\max}]$. To find the minimum, we analyze the derivative of $N_{\\ell}(r)$ with respect to $r$:\n$$ \\frac{dN_{\\ell}}{dr} = \\frac{\\frac{C}{1+C(r-1)}\\ln(r) - \\ln(1+C(r-1))\\frac{1}{r}}{\\left(\\ln(r)\\right)^2} $$\nThe sign of the derivative is determined by the sign of the numerator.\nFor a non-trivial boundary-layer mesh with multiple layers, the total thickness $\\delta$ must be greater than the first layer thickness $\\Delta y_1$. This physical requirement implies $\\frac{\\delta}{\\Delta y_1} > 1$, which means $C>1$. We proceed under this assumption, which ensures the problem is physically meaningful and well-posed.\n\nLet's analyze the sign of the derivative for $C>1$. Consider the function $k(r) = r^C - (1+C(r-1))$ for $r>1$. Its value at $r=1$ is $k(1)=1^C - (1+0) = 0$. Its derivative is $k'(r) = Cr^{C-1} - C = C(r^{C-1}-1)$. Since $C>1$ and $r>1$, we have $C-1>0$ and $r^{C-1}>1$, which implies $k'(r)>0$. Thus, $k(r)$ is a strictly increasing function for $r>1$. Since $k(1)=0$, we have $k(r)>0$ for all $r>1$.\nThe inequality $r^C > 1+C(r-1)$ for $r>1$ implies (by taking the logarithm):\n$$ C \\ln(r) > \\ln(1+C(r-1)) $$\nDividing by $\\ln(r)>0$, we get $C > \\frac{\\ln(1+C(r-1))}{\\ln(r)} = N_{\\ell}(r)$. While this provides a bound, we need the sign of the derivative $\\frac{dN_{\\ell}}{dr}$. The numerator of the derivative is proportional to $h(r) = Cr\\ln(r) - (1+C(r-1))\\ln(1+C(r-1))$. Analysis of $h(r)$ shows it is negative for $C>1$ and $r>1$. A simpler argument is based on the known result from convex analysis that for a concave function $f(x)$ with $f(0)=0$, the function $f(x)/x$ is decreasing. Applying this to related functions reveals that $N_{\\ell}(r)$ is a monotonically decreasing function of $r$ for $C>1$.\n\nSince $N_{\\ell}(r)$ is a monotonically decreasing function on the interval $(1, r_{\\max}]$, its minimum value will be at the rightmost boundary of the interval, i.e., at $r = r_{\\max}$.\nTherefore, the optimal growth factor is $r^* = r_{\\max}$.\n\nThe optimal number of layers, $N_{\\ell}^*$, is found by substituting $r=r_{\\max}$ into the expression for $N_{\\ell}(r)$:\n$$ N_{\\ell}^* = N_{\\ell}(r_{\\max}) = \\frac{\\ln(1 + C(r_{\\max}-1))}{\\ln(r_{\\max})} $$\nFinally, substituting the definition of $C$ back into the expression gives the closed-form solution for the optimal continuous layer count:\n$$ N_{\\ell}^* = \\frac{\\ln\\left(1 + \\frac{\\delta u_{\\tau}}{y^{+}_{\\max} \\nu} (r_{\\max} - 1)\\right)}{\\ln(r_{\\max})} $$\nThis expression provides the minimum number of layers (as a continuous variable) required to satisfy all design constraints.",
            "answer": "$$\\boxed{\\frac{\\ln\\left(1 + \\frac{\\delta u_{\\tau}}{y^{+}_{\\max} \\nu} (r_{\\max} - 1)\\right)}{\\ln(r_{\\max})}}$$"
        },
        {
            "introduction": "While designing a layer stack for a flat plate is straightforward, real-world geometries involve curvature, which introduces significant challenges for mesh generation. This exercise asks you to compare two common extrusion strategies for a wavy surface: a simple vertical extrusion and a more complex normal-projection method. By quantifying metrics for geometric accuracy, cell quality, and the resulting error in a wall shear stress calculation, you will develop a critical understanding of how meshing choices impact simulation fidelity .",
            "id": "3297008",
            "problem": "You are asked to compare two structured boundary-layer mesh generation strategies over a wavy wall in two spatial dimensions: transfinite interpolation extrusion aligned with a fixed vertical direction and normal-projection extrusion aligned with the physical wall normals. The wall surface is given by the single-valued function $z = a \\sin(k x)$, with $x$ measured in meters and $z$ in meters. Your task is to quantify geometric errors and the induced impact on the Jacobian determinant and on a model problem for wall shear stress estimation. You must implement a complete, runnable program that performs these computations for a prescribed test suite.\n\nStart from the following fundamental bases and core definitions:\n- The wall surface is the parametric curve $\\boldsymbol{r}_w(x) = (x, a \\sin(k x))$ with $x \\in [0, L]$, where $L = 2\\pi/k$.\n- The (unnormalized) tangent vector is $\\boldsymbol{t} = \\partial \\boldsymbol{r}_w/\\partial x = (1, a k \\cos(k x))$ and the outward unit normal is $\\hat{\\boldsymbol{n}} = \\boldsymbol{n}/\\|\\boldsymbol{n}\\|$ with $\\boldsymbol{n} = (-a k \\cos(k x), 1)$ and $\\|\\boldsymbol{n}\\| = \\sqrt{1 + (a k \\cos(k x))^2}$.\n- A structured boundary-layer mesh is built by extruding layers from the wall into the fluid. Let the number of discrete layers be $N \\in \\mathbb{N}$ and let the desired normal distance sequence be a geometric progression with first spacing $y_1$ and growth ratio $r > 1$, i.e., the unscaled layer increments are $\\Delta n_j^{\\text{raw}} = y_1 r^{j-1}$ for $j \\in \\{1,\\dots,N\\}$. The cumulative unscaled distance to layer $j$ is $S_j = \\sum_{m=1}^j \\Delta n_m^{\\text{raw}}$. To enforce a prescribed outer boundary-layer height $H$ (in meters), scale these distances by a factor $c = H/S_N$ so that the target cumulative normal distances are $n_j = c S_j$, with $n_0 = 0$ and $n_N = H$.\n- The transfinite-interpolation-aligned extrusion is defined here as a vertical-direction extrusion: at a given surface point $(x, z_w)$ the mesh node for layer $j$ is $\\boldsymbol{r}^{\\mathrm{TFI}}(x,j) = (x, z_w) + n_j \\,\\hat{\\boldsymbol{e}}_z$, where $\\hat{\\boldsymbol{e}}_z = (0,1)$.\n- The normal-projection extrusion is defined by $\\boldsymbol{r}^{\\mathrm{NP}}(x,j) = \\boldsymbol{r}_w(x) + n_j \\,\\hat{\\boldsymbol{n}}(x)$.\n- The computational coordinates are $(\\xi,\\eta)$ with $\\xi \\in [0,1]$ discretized uniformly into $N_x$ nodes mapped to $x \\in [0,L]$, and $\\eta$ implicitly indexing the layers $j \\in \\{0,\\dots,N\\}$.\n- The local mapped cell (between $(i,j-1)$ and $(i+1,j)$ in index space) has physical edge vectors $\\boldsymbol{E}_\\xi = \\boldsymbol{r}(i+1,j-1) - \\boldsymbol{r}(i,j-1)$ and $\\boldsymbol{E}_\\eta = \\boldsymbol{r}(i,j) - \\boldsymbol{r}(i,j-1)$. The discrete Jacobian magnitude for that cell is $J_{\\text{cell}} = |\\boldsymbol{E}_\\xi \\times \\boldsymbol{E}_\\eta|$, where the two-dimensional scalar cross product is $\\boldsymbol{a} \\times \\boldsymbol{b} = a_x b_z - a_z b_x$.\n- The true reference area scaling for one computational cell in an idealized orthogonal mapping is the product $\\Delta x \\,\\Delta n_j$, where $\\Delta x = L/(N_x-1)$ and $\\Delta n_j = n_j - n_{j-1}$.\n\nDefine and compute the following quantitative metrics:\n1) Geometric normal-distance error at nodes: for a mesh node $\\boldsymbol{r}(x,j)$, define the actual normal distance as $d_{\\perp}(x,j) = (\\boldsymbol{r}(x,j) - \\boldsymbol{r}_w(x)) \\cdot \\hat{\\boldsymbol{n}}(x)$. The nodewise geometric error is $e_n(x,j) = d_{\\perp}(x,j) - n_j$. For each mesh, compute the root-mean-square (RMS) over all streamwise locations and all off-wall layers,\n$$\nE_{n,\\mathrm{RMS}} = \\sqrt{\\frac{1}{N_x \\, N}\\sum_{i=1}^{N_x}\\sum_{j=1}^N e_n(x_i,j)^2}.\n$$\n\n2) Jacobian quality via normalized minimum Jacobian: for each mesh, compute the ratio\n$$\n\\rho_{i,j} = \\frac{J_{\\text{cell}}(i,j)}{\\Delta x \\,\\Delta n_j}\n$$\nfor all interior cells indexed by $i \\in \\{1,\\dots,N_x-1\\}$ and $j \\in \\{1,\\dots,N\\}$. Report the minimum value over the whole mesh,\n$$\n\\rho_{\\min} = \\min_{i,j} \\rho_{i,j}.\n$$\n\n3) Impact on wall shear stress estimation using a model near-wall tangential velocity profile. Let the analytic tangential velocity in wall-normal coordinates be $u_t(n) = U_\\infty\\left(1 - e^{-n/\\ell}\\right)$, with $U_\\infty$ in meters per second and $\\ell$ in meters. The true wall shear stress is $\\tau_w^{\\mathrm{true}} = \\mu \\,\\partial u_t/\\partial n|_{n=0} = \\mu\\, U_\\infty/\\ell$, with dynamic viscosity $\\mu$ in pascal-seconds and the shear in pascals. A common one-sided discrete estimator uses the first off-wall node. For each $x_i$, let $\\boldsymbol{v}_1 = \\boldsymbol{r}(x_i,1) - \\boldsymbol{r}_w(x_i)$, $n_1(x_i) = \\boldsymbol{v}_1 \\cdot \\hat{\\boldsymbol{n}}(x_i)$, and $d_1(x_i) = \\|\\boldsymbol{v}_1\\|$. Define\n$$\n\\tau_w^{\\mathrm{est}}(x_i) = \\mu \\,\\frac{u_t(n_1(x_i)) - u_t(0)}{d_1(x_i)} = \\mu \\, \\frac{U_\\infty \\left(1 - e^{-n_1(x_i)/\\ell}\\right)}{d_1(x_i)}.\n$$\nCompute the RMS relative error along the wall,\n$$\n\\varepsilon_{\\tau,\\mathrm{RMS}} = \\sqrt{\\frac{1}{N_x}\\sum_{i=1}^{N_x}\\left(\\frac{\\tau_w^{\\mathrm{est}}(x_i) - \\tau_w^{\\mathrm{true}}}{\\tau_w^{\\mathrm{true}}}\\right)^2}.\n$$\n\nImplementation requirements:\n- Build both meshes on the same streamwise grid of $N_x$ points uniformly spanning one wavelength $L = 2\\pi/k$.\n- Use the same layer distribution $\\{n_j\\}_{j=0}^N$ for both meshes, computed from the geometric progression and scaled so that $n_N = H$.\n- For the Jacobian ratios, use the same $\\Delta n_j$ for both meshes as the normalization.\n- For the wall shear stress model, use the same $U_\\infty$, $\\mu$, and $\\ell$ for all test cases. Answer the shear-related metric in pascals implicitly by forming a dimensionless relative error; the final reported metric must be dimensionless.\n\nTest suite:\nUse the following three parameter sets. All dimensional quantities are in the International System of Units (SI).\n- Case $1$: $a = 0$, $k = 2\\pi$, $H = 2.0\\times 10^{-2}$, $N = 40$, $N_x = 401$, $y_1 = 1.0\\times 10^{-5}$, $r = 1.2$, $U_\\infty = 1.0\\times 10^{1}$, $\\mu = 1.0\\times 10^{-3}$, $\\ell = 2.0\\times 10^{-4}$.\n- Case $2$: $a = 1.0\\times 10^{-2}$, $k = 1.0\\times 10^{1}$, $H = 2.0\\times 10^{-2}$, $N = 40$, $N_x = 401$, $y_1 = 1.0\\times 10^{-5}$, $r = 1.2$, $U_\\infty = 1.0\\times 10^{1}$, $\\mu = 1.0\\times 10^{-3}$, $\\ell = 2.0\\times 10^{-4}$.\n- Case $3$: $a = 2.0\\times 10^{-2}$, $k = 4.0\\times 10^{1}$, $H = 2.0\\times 10^{-2}$, $N = 40$, $N_x = 401$, $y_1 = 1.0\\times 10^{-5}$, $r = 1.2$, $U_\\infty = 1.0\\times 10^{1}$, $\\mu = 1.0\\times 10^{-3}$, $\\ell = 2.0\\times 10^{-4}$.\n\nFor each case, compute and report the following six floats in this exact order:\n- $E_{n,\\mathrm{RMS}}$ for the transfinite-interpolation-aligned extrusion.\n- $E_{n,\\mathrm{RMS}}$ for the normal-projection extrusion.\n- $\\rho_{\\min}$ for the transfinite-interpolation-aligned extrusion.\n- $\\rho_{\\min}$ for the normal-projection extrusion.\n- $\\varepsilon_{\\tau,\\mathrm{RMS}}$ for the transfinite-interpolation-aligned extrusion.\n- $\\varepsilon_{\\tau,\\mathrm{RMS}}$ for the normal-projection extrusion.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the cases ($1$ to $3$), with each case contributing its six floats in the order listed above. For example, the output must look like $[\\dots]$ with exactly $6 \\times 3 = 18$ comma-separated floats. All reported metrics are dimensionless real numbers except the geometric errors, which carry meters; nevertheless, report the numeric values as plain floats without units in the output.",
            "solution": "The present problem requires a comparative analysis of two structured boundary-layer mesh generation strategies—a vertical transfinite interpolation (TFI) extrusion and a normal-projection (NP) extrusion—over a sinusoidal wall. The comparison is to be performed by implementing an algorithm to compute three specific quantitative metrics: a geometric normal-distance error, a Jacobian-based cell quality metric, and an error metric for a model wall shear stress estimation.\n\nThe solution proceeds by first establishing the shared geometric and discretization parameters. Then, for each of the two meshing strategies, the node coordinates are computed. Finally, the specified metrics are calculated for both meshes and reported for a defined set of test cases.\n\n**1. Common Framework: Wall Geometry and Layer Distribution**\n\nThe physical domain is defined over a two-dimensional wavy wall given by the function $z_w(x) = a \\sin(k x)$. The analysis is restricted to a single wavelength, $x \\in [0, L]$, where $L = 2\\pi/k$. The discrete streamwise coordinates are uniformly spaced:\n$$\nx_i = i \\cdot \\Delta x, \\quad \\text{for } i \\in \\{0, 1, \\dots, N_x-1\\}\n$$\nwhere $\\Delta x = L/(N_x-1)$. For each point $\\boldsymbol{r}_w(x_i) = (x_i, z_w(x_i))$ on the wall, we need the outward unit normal vector, $\\hat{\\boldsymbol{n}}(x_i)$. The unnormalized normal vector is $\\boldsymbol{n} = (-z_w'(x), 1) = (-a k \\cos(k x), 1)$, and its magnitude is $\\|\\boldsymbol{n}\\| = \\sqrt{1 + (a k \\cos(k x))^2}$. Thus, the unit normal is:\n$$\n\\hat{\\boldsymbol{n}}(x) = \\frac{1}{\\sqrt{1 + (a k \\cos(k x))^2}} \\begin{pmatrix} -a k \\cos(k x) \\\\ 1 \\end{pmatrix}\n$$\n\nThe boundary layer mesh consists of $N$ layers extruded from the wall up to a total height of $H$. The desired normal distance from the wall to the $j$-th layer, $n_j$, is defined by a geometric progression. The unscaled thickness of the $j$-th layer is $\\Delta n_j^{\\text{raw}} = y_1 r^{j-1}$. The cumulative unscaled distance is the sum of a geometric series:\n$$\nS_j = \\sum_{m=1}^{j} \\Delta n_m^{\\text{raw}} = y_1 \\frac{r^j - 1}{r-1} \\quad (\\text{for } r \\neq 1)\n$$\nTo ensure the total height is exactly $H$, these distances are scaled by a factor $c = H/S_N$. The final target normal distances are $n_j = c S_j$ for $j \\in \\{0, \\dots, N\\}$, with $n_0 = 0$. This yields the explicit formula:\n$$\nn_j = H \\frac{r^j - 1}{r^N - 1}\n$$\nThe thickness of the $j$-th layer is $\\Delta n_j = n_j - n_{j-1}$.\n\n**2. Mesh Generation Strategies**\n\nGiven the wall points $\\boldsymbol{r}_w(x_i)$ and the layer distance distribution $\\{n_j\\}$, the two meshes are constructed as follows:\n\n- **Vertical TFI-Aligned Extrusion (TFI):** This method extrudes nodes along the fixed vertical direction $\\hat{\\boldsymbol{e}}_z = (0,1)$. The position of a node at streamwise location $x_i$ and layer $j$ is:\n$$\n\\boldsymbol{r}^{\\mathrm{TFI}}(x_i, j) = \\boldsymbol{r}_w(x_i) + n_j \\hat{\\boldsymbol{e}}_z = (x_i, a \\sin(k x_i) + n_j)\n$$\nThis method is simple but generates grids that are not orthogonal to the wall surface, unless the wall is flat ($a=0$).\n\n- **Normal-Projection Extrusion (NP):** This method extrudes nodes along the local wall normal vector $\\hat{\\boldsymbol{n}}(x_i)$ at each streamwise location. The node position is:\n$$\n\\boldsymbol{r}^{\\mathrm{NP}}(x_i, j) = \\boldsymbol{r}_w(x_i) + n_j \\hat{\\boldsymbol{n}}(x_i)\n$$\nThis method is designed to create a mesh that is perfectly orthogonal at the wall surface, thereby achieving the desired normal distances exactly.\n\n**3. Quantitative Metrics**\n\nFor each generated mesh, three metrics are computed to quantify its quality.\n\n**3.1. Geometric Normal-Distance Error, $E_{n,\\mathrm{RMS}}$**\nThis metric quantifies how well the mesh nodes adhere to the target normal distances $\\{n_j\\}$. For a node $\\boldsymbol{r}(x_i, j)$, its actual normal distance from the wall is the projection of the vector from the corresponding wall point onto the wall normal:\n$$\nd_{\\perp}(x_i, j) = (\\boldsymbol{r}(x_i, j) - \\boldsymbol{r}_w(x_i)) \\cdot \\hat{\\boldsymbol{n}}(x_i)\n$$\nThe nodewise error is $e_n(x_i, j) = d_{\\perp}(x_i, j) - n_j$. The Root-Mean-Square (RMS) of this error over all off-wall nodes provides a global measure of geometric accuracy:\n$$\nE_{n,\\mathrm{RMS}} = \\sqrt{\\frac{1}{N_x N}\\sum_{i=0}^{N_x-1}\\sum_{j=1}^N e_n(x_i, j)^2}\n$$\nBy construction, the NP mesh should yield $E_{n,\\mathrm{RMS}} = 0$ (within machine precision), as $d_{\\perp} = (n_j \\hat{\\boldsymbol{n}}) \\cdot \\hat{\\boldsymbol{n}} = n_j$. The TFI mesh will have non-zero error for a wavy wall, since $d_{\\perp} = (n_j \\hat{\\boldsymbol{e}}_z) \\cdot \\hat{\\boldsymbol{n}} = n_j (\\hat{\\boldsymbol{n}})_z$, and the $z$-component of the unit normal, $(\\hat{\\boldsymbol{n}})_z = 1/\\|\\boldsymbol{n}\\|$, is less than or equal to $1$.\n\n**3.2. Jacobian Quality, $\\rho_{\\min}$**\nThe Jacobian of the mapping from computational to physical space measures local cell area and orientation. A poor-quality mesh can have highly skewed or even inverted cells ($J \\le 0$). The quality is assessed using a normalized discrete Jacobian. For a cell originating at node $(i, j-1)$, the edge vectors are defined as $\\boldsymbol{E}_\\xi = \\boldsymbol{r}(x_{i+1}, j-1) - \\boldsymbol{r}(x_i, j-1)$ and $\\boldsymbol{E}_\\eta = \\boldsymbol{r}(x_i, j) - \\boldsymbol{r}(x_i, j-1)$. The scalar 2D cross product gives the area of the parallelogram formed by these vectors: $J_{\\text{cell}} = |E_{\\xi,x} E_{\\eta,z} - E_{\\xi,z} E_{\\eta,x}|$. This area is normalized by the ideal orthogonal cell area, $\\Delta x \\Delta n_j$. The quality metric is the minimum value of this ratio over the entire mesh:\n$$\n\\rho_{\\min} = \\min_{i,j} \\left( \\frac{J_{\\text{cell}}(i,j)}{\\Delta x \\Delta n_j} \\right)\n$$\nFor an ideal orthogonal mesh, $\\rho_{i,j} = 1$ everywhere. For the TFI mesh, the vector $\\boldsymbol{E}_\\eta$ is purely vertical, $(0, \\Delta n_j)$, while $\\boldsymbol{E}_\\xi = (\\Delta x, \\Delta z_w)$. This leads to $J_{\\text{cell}} = |\\Delta x \\cdot \\Delta n_j - \\Delta z_w \\cdot 0| = \\Delta x \\Delta n_j$, and thus $\\rho_{i,j}=1$ everywhere. For the NP mesh, the extrusion directions $\\hat{\\boldsymbol{n}}(x_i)$ and $\\hat{\\boldsymbol{n}}(x_{i+1})$ are not parallel if the wall is curved, leading to distorted cells and $\\rho_{i,j} \\neq 1$ away from the wall.\n\n**3.3. Wall Shear Stress Estimation Error, $\\varepsilon_{\\tau,\\mathrm{RMS}}$**\nThis metric evaluates the impact of mesh geometry on a finite-difference approximation of a physical quantity. The true wall shear stress for the model velocity profile $u_t(n) = U_\\infty(1 - e^{-n/\\ell})$ is $\\tau_w^{\\mathrm{true}} = \\mu \\frac{\\partial u_t}{\\partial n}\\big|_{n=0} = \\mu U_\\infty/\\ell$. A first-order, one-sided discrete estimate is:\n$$\n\\tau_w^{\\mathrm{est}}(x_i) = \\mu \\frac{u_t(n_1(x_i)) - u_t(0)}{d_1(x_i)}\n$$\nwhere $\\boldsymbol{v}_1 = \\boldsymbol{r}(x_i, 1) - \\boldsymbol{r}_w(x_i)$ is the vector to the first off-wall node, $d_1(x_i) = \\|\\boldsymbol{v}_1\\|$ is the geometric distance, and $n_1(x_i) = \\boldsymbol{v}_1 \\cdot \\hat{\\boldsymbol{n}}(x_i)$ is the actual normal distance. The term $u_t(n_1(x_i))$ uses the actual normal distance to evaluate the model velocity. The RMS relative error is:\n$$\n\\varepsilon_{\\tau,\\mathrm{RMS}} = \\sqrt{\\frac{1}{N_x}\\sum_{i=0}^{N_x-1}\\left(\\frac{\\tau_w^{\\mathrm{est}}(x_i) - \\tau_w^{\\mathrm{true}}}{\\tau_w^{\\mathrm{true}}}\\right)^2}\n$$\nFor the TFI mesh, $d_1 = n_1$ and $n_1(x_i) = n_1 (\\hat{\\boldsymbol{n}}(x_i))_z$, which varies with $x$. For the NP mesh, $d_1=n_1$ and $n_1(x_i)=n_1$, making the estimate independent of $x$ and identical to the flat plate case. This highlights how geometric error ($d_1 \\neq n_1$ or $n_1(x_i)$ varying) propagates into the stencil of the numerical scheme. However, in both TFI and NP definitions given, $d_1=n_1$, so the error is driven solely by the difference between the true normal distance $n_1(x_i)$ and the stencil distance $d_1(x_i)$.\n\nThe implementation computes these quantities for each case and method using vectorized `numpy` operations for efficiency.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef calculate_metrics(mesh_coords, params, wall_data, layer_data):\n    \"\"\"\n    Computes the three specified quality metrics for a given mesh.\n    \"\"\"\n    # Unpack parameters and pre-computed data\n    a, k, H, N, Nx = params['a'], params['k'], params['H'], params['N'], params['Nx']\n    U_inf, mu, l_scale = params['U_inf'], params['mu'], params['l']\n    \n    wall_nodes = wall_data['wall_nodes']\n    unit_normals = wall_data['unit_normals']\n    n_dist = layer_data['n_dist']\n    delta_n_layers = layer_data['delta_n']\n    L = 2 * np.pi / k\n\n    # Metric 1: Geometric normal-distance error (E_n_RMS)\n    # The sum is over i=1..Nx and j=1..N. In 0-based index: i=0..Nx-1, j=1..N\n    # We use all off-wall nodes: mesh_coords[:, 1:, :] which has shape (Nx, N, 2)\n    diff_vec = mesh_coords[:, 1:, :] - wall_nodes[:, np.newaxis, :]\n    unit_normals_bcast = unit_normals[:, np.newaxis, :]\n    d_perp = np.sum(diff_vec * unit_normals_bcast, axis=2)  # Dot product\n\n    n_dist_offwall = n_dist[1:]\n    e_n = d_perp - n_dist_offwall[np.newaxis, :]\n    e_n_rms = np.sqrt(np.mean(e_n**2))\n\n    # Metric 2: Jacobian quality (rho_min)\n    # The min is over i=1..Nx-1 and j=1..N. In 0-based: i=0..Nx-2, j=1..N\n    # These correspond to cells defined from nodes (i, j-1)\n    E_xi = mesh_coords[1:, :-1, :] - mesh_coords[:-1, :-1, :]\n    E_eta = mesh_coords[:-1, 1:, :] - mesh_coords[:-1, :-1, :]\n    \n    # 2D scalar cross product\n    j_cell = np.abs(E_xi[..., 0] * E_eta[..., 1] - E_xi[..., 1] * E_eta[..., 0])\n    \n    delta_x = L / (Nx-1)\n    ref_area = delta_x * delta_n_layers[np.newaxis, :] # delta_n_layers has length N\n    \n    # Avoid division by zero if ref_area is zero (e.g., H=0)\n    # Although not the case here, it's good practice.\n    rho = np.divide(j_cell, ref_area, out=np.ones_like(j_cell), where=ref_area!=0)\n    rho_min = np.min(rho)\n\n    # Metric 3: Wall shear stress estimation error (eps_tau_RMS)\n    # The sum is over i=1..Nx. In 0-based: i=0..Nx-1\n    tau_true = mu * U_inf / l_scale\n    \n    # Get vector to first off-wall node\n    v1 = mesh_coords[:, 1, :] - mesh_coords[:, 0, :]\n    d1 = np.linalg.norm(v1, axis=1)\n    \n    # Actual normal distance of first off-wall node\n    n1_actual = np.sum(v1 * unit_normals, axis=1) # Dot product\n\n    # Avoid division by zero. If d1 is zero, the estimate is ill-defined.\n    # In this problem, d1 = n_dist[1] > 0 always.\n    tau_est = mu * U_inf * (1 - np.exp(-n1_actual / l_scale)) / d1\n    \n    rel_error = (tau_est - tau_true) / tau_true\n    eps_tau_rms = np.sqrt(np.mean(rel_error**2))\n\n    return e_n_rms, rho_min, eps_tau_rms\n\ndef solve_case(params):\n    \"\"\"\n    Solves one test case, generating both meshes and computing all metrics.\n    \"\"\"\n    # Unpack parameters\n    a, k, H, N, Nx = params['a'], params['k'], params['H'], params['N'], params['Nx']\n    y1, r = params['y1'], params['r']\n\n    # Setup common grid and layer properties\n    L = 2.0 * np.pi / k\n    x_grid = np.linspace(0, L, Nx)\n\n    # Layer distribution\n    j_vals = np.arange(N + 1)\n    if r == 1.0:\n        n_dist = H * j_vals / N\n    else:\n        # This formula prevents potential overflow/underflow with large N\n        # by using log-exp properties, but direct computation is fine for N=40.\n        # It simplifies to: n_j = H * (r^j - 1) / (r^N - 1)\n        n_dist = H * (np.power(r, j_vals) - 1.0) / (np.power(r, N) - 1.0)\n    n_dist[0] = 0.0 # Ensure starts at zero\n    \n    delta_n_layers = n_dist[1:] - n_dist[:-1]\n    layer_data = {'n_dist': n_dist, 'delta_n': delta_n_layers}\n\n    # Wall properties\n    z_w = a * np.sin(k * x_grid)\n    wall_nodes = np.stack([x_grid, z_w], axis=-1)\n    \n    nx_unnormalized = -a * k * np.cos(k * x_grid)\n    nz_unnormalized = np.ones_like(x_grid)\n    norm_mag = np.sqrt(nx_unnormalized**2 + nz_unnormalized**2)\n    unit_normals = np.stack([nx_unnormalized / norm_mag, nz_unnormalized / norm_mag], axis=-1)\n    \n    wall_data = {'wall_nodes': wall_nodes, 'unit_normals': unit_normals}\n\n    # TFI Mesh Generation (Vertical Extrusion)\n    mesh_tfi = np.zeros((Nx, N + 1, 2))\n    mesh_tfi[:, :, 0] = x_grid[:, np.newaxis]\n    mesh_tfi[:, :, 1] = z_w[:, np.newaxis] + n_dist[np.newaxis, :]\n\n    # NP Mesh Generation (Normal Projection)\n    mesh_np = wall_nodes[:, np.newaxis, :] + n_dist[np.newaxis, :, np.newaxis] * unit_normals[:, np.newaxis, :]\n    \n    # Calculate metrics for both meshes\n    tfi_metrics = calculate_metrics(mesh_tfi, params, wall_data, layer_data)\n    np_metrics = calculate_metrics(mesh_np, params, wall_data, layer_data)\n    \n    return [tfi_metrics[0], np_metrics[0], tfi_metrics[1], np_metrics[1], tfi_metrics[2], np_metrics[2]]\n\ndef solve():\n    \"\"\"\n    Main entry point to run all test cases and print results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            'a': 0.0, 'k': 2.0 * np.pi, 'H': 2.0e-2, 'N': 40, 'Nx': 401,\n            'y1': 1.0e-5, 'r': 1.2, 'U_inf': 1.0e1, 'mu': 1.0e-3, 'l': 2.0e-4\n        },\n        {\n            'a': 1.0e-2, 'k': 1.0e1, 'H': 2.0e-2, 'N': 40, 'Nx': 401,\n            'y1': 1.0e-5, 'r': 1.2, 'U_inf': 1.0e1, 'mu': 1.0e-3, 'l': 2.0e-4\n        },\n        {\n            'a': 2.0e-2, 'k': 4.0e1, 'H': 2.0e-2, 'N': 40, 'Nx': 401,\n            'y1': 1.0e-5, 'r': 1.2, 'U_inf': 1.0e1, 'mu': 1.0e-3, 'l': 2.0e-4\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        case_results = solve_case(case)\n        results.extend(case_results)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "The most sophisticated meshing strategies adapt the cell size and shape based on the physics of the flow itself. This advanced practice connects mesh generation directly to classical fluid dynamics theory by using the Falkner-Skan similarity solution for laminar wedge flows. You will derive a wall-normal spacing criterion based on resolving the velocity gradient near the wall, and use this to construct an anisotropic mesh metric tensor, a foundational concept in solution-adaptive meshing .",
            "id": "3297059",
            "problem": "Consider a two-dimensional, steady, laminar wedge flow over a flat wall in the context of Computational Fluid Dynamics (CFD), where the external velocity is given by $U_{e}(x) = U_{0} \\left( \\frac{x}{L} \\right)^{m}$ with $m=1$. The fluid has kinematic viscosity $\\nu$, and the wall-normal coordinate is $y$. To construct an anisotropic prismatic boundary-layer mesh that prioritizes resolution of the wall-normal gradient of the streamwise velocity, adopt the Falkner–Skan similarity framework with similarity variable $\\eta = y \\alpha(x)$, velocity representation $u(x,y) = U_{e}(x) f'(\\eta)$, and the similarity ordinary differential equation\n$$\nf'''(\\eta) + f(\\eta) f''(\\eta) + \\beta \\left( 1 - f'(\\eta)^{2} \\right) = 0,\n$$\nsubject to $f(0) = 0$, $f'(0) = 0$, and $f'(\\eta) \\to 1$ as $\\eta \\to \\infty$, where $\\beta = \\frac{2m}{m+1}$ and $\\alpha(x)$ is defined by boundary-layer scaling. For $m=1$, this case corresponds to stagnation-point wedge flow with $\\beta = 1$ and $\\alpha(x) = \\sqrt{\\frac{U_{e}(x)}{\\nu x}}$.\n\nAn anisotropic mesh metric tensor $M(x)$ aligned with the wall-tangent and wall-normal directions is defined by\n$$\nM(x) = R(x)^{\\top} \\, \\mathrm{diag}\\!\\left( \\frac{1}{h_{t}(x)^{2}}, \\, \\frac{1}{h_{n}(x)^{2}} \\right) R(x),\n$$\nwhere $R(x)$ is an orthonormal rotation whose columns are the unit wall-tangent and wall-normal vectors, and $h_{t}(x)$ and $h_{n}(x)$ are the target mesh spacings in the tangent and normal directions respectively. The mesh is constrained so that the relative variation of the wall-normal gradient of $u$ across a wall-normal edge of length $h_{n}$ does not exceed a prescribed bound $\\varepsilon_{g}$, that is,\n$$\n\\frac{\\left| \\left( \\frac{\\partial^{2} u}{\\partial y^{2}} \\right)_{w} \\right| h_{n}}{\\left| \\left( \\frac{\\partial u}{\\partial y} \\right)_{w} \\right|} \\leq \\varepsilon_{g},\n$$\nand successive prismatic layer spacings obey a maximum growth factor $g_{\\max}$ in the wall-normal direction so that $h_{n,k+1} \\leq g_{\\max} \\, h_{n,k}$.\n\nStarting from the Falkner–Skan similarity formulation and its wall conditions, derive the expression for the wall-normal spacing constraint $h_{n}$ at the wall in terms of $U_{e}(x)$, $x$, $\\nu$, $\\varepsilon_{g}$, and the near-wall values $f''(0)$ and $f'''(0)$. Use this to construct $M(x)$ symbolically in terms of $h_{t}(x)$ and $h_{n}(x)$, and then compute the first-layer wall-normal spacing $h_{1}$ at $x=L$ for the stagnation-point case $m=1$ with $U_{0} = 30 \\,\\mathrm{m/s}$, $L = 1 \\,\\mathrm{m}$, $\\nu = 1.5 \\times 10^{-5} \\,\\mathrm{m^{2}/s}$, and $\\varepsilon_{g} = 0.05$. Assume the known Falkner–Skan wall values $f''(0) = 1$ and $f'''(0) = -\\beta$ at $\\eta=0$. Round your answer for $h_{1}$ to four significant figures and express it in meters.",
            "solution": "The problem statement is critically evaluated against the specified criteria before proceeding to a solution.\n\n### Step 1: Extract Givens\n-   **Flow Context**: Two-dimensional, steady, laminar wedge flow over a flat wall.\n-   **External Velocity**: $U_{e}(x) = U_{0} \\left( \\frac{x}{L} \\right)^{m}$ with $m=1$.\n-   **Fluid Property**: Kinematic viscosity $\\nu$.\n-   **Coordinates**: Wall-tangent coordinate $x$, wall-normal coordinate $y$.\n-   **Similarity Solution**: Falkner–Skan framework with similarity variable $\\eta = y \\alpha(x)$ and velocity representation $u(x,y) = U_{e}(x) f'(\\eta)$.\n-   **Governing ODE**: $f'''(\\eta) + f(\\eta) f''(\\eta) + \\beta \\left( 1 - f'(\\eta)^{2} \\right) = 0$.\n-   **Boundary Conditions**: $f(0) = 0$, $f'(0) = 0$, and $f'(\\eta) \\to 1$ as $\\eta \\to \\infty$.\n-   **Parameters**: $\\beta = \\frac{2m}{m+1}$ and $\\alpha(x) = \\sqrt{\\frac{U_{e}(x)}{\\nu x}}$.\n-   **Specific Case**: For $m=1$, the flow is stagnation-point wedge flow with $\\beta = 1$.\n-   **Assumed Wall Values**: For the case $m=1$, $f''(0) = 1$ and $f'''(0) = -\\beta$.\n-   **Mesh Metric Tensor**: $M(x) = R(x)^{\\top} \\, \\mathrm{diag}\\!\\left( \\frac{1}{h_{t}(x)^{2}}, \\, \\frac{1}{h_{n}(x)^{2}} \\right) R(x)$, where $R(x)$ is a rotation matrix for wall alignment, and $h_t(x)$, $h_n(x)$ are target mesh spacings.\n-   **Mesh Spacing Constraint**: $\\frac{\\left| \\left( \\frac{\\partial^{2} u}{\\partial y^{2}} \\right)_{w} \\right| h_{n}}{\\left| \\left( \\frac{\\partial u}{\\partial y} \\right)_{w} \\right|} \\leq \\varepsilon_{g}$.\n-   **Numerical Values**: $U_{0} = 30 \\,\\mathrm{m/s}$, $L = 1 \\,\\mathrm{m}$, $\\nu = 1.5 \\times 10^{-5} \\,\\mathrm{m^{2}/s}$, $\\varepsilon_{g} = 0.05$.\n-   **Target Calculation**: Compute the first-layer wall-normal spacing $h_{1}$ at $x=L$ and round to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is well-posed and scientifically grounded in the established theory of laminar boundary layers (specifically, Falkner-Skan similarity solutions) and its application to computational fluid dynamics mesh generation. All equations, definitions, and constraints are standard in this field. The provided parameters and conditions are self-contained and consistent.\n\nThe instruction to assume $f''(0)=1$ for the stagnation-point case ($m=1$, $\\beta=1$) is a simplification, as the numerically computed value is $f''(0) \\approx 1.232588$. However, providing a specific value to assume is a common pedagogical tool to make a problem analytically tractable and to test the derivation process itself without requiring external numerical data. This does not constitute a scientific flaw but is a defined premise of this self-contained problem. The relationship $f'''(0) = -\\beta$ is directly derivable from the Falkner-Skan ODE evaluated at $\\eta=0$ with the given boundary conditions $f(0)=0$ and $f'(0)=0$, confirming consistency.\n\nAll other data are physically realistic and dimensionally consistent. The problem is objective, unambiguous, and admits a unique, verifiable solution.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. A solution will be derived as requested.\n\n### Solution Derivation\nThe objective is threefold: first, to derive an expression for the wall-normal mesh spacing $h_{n}$ based on the given constraint; second, to construct the symbolic mesh metric tensor $M(x)$; and third, to compute the numerical value for the first-layer spacing $h_{1}$ at $x=L$.\n\nThe mesh spacing constraint is given as:\n$$\n\\frac{\\left| \\left( \\frac{\\partial^{2} u}{\\partial y^{2}} \\right)_{w} \\right| h_{n}}{\\left| \\left( \\frac{\\partial u}{\\partial y} \\right)_{w} \\right|} \\leq \\varepsilon_{g}\n$$\nwhere the subscript `$w$` denotes evaluation at the wall, i.e., at $y=0$. For the first layer of cells adjacent to the wall, we take the equality to determine the maximum allowable spacing, which we denote $h_n$ (or $h_1$ for the first layer).\n$$\nh_{n} = \\varepsilon_{g} \\frac{\\left| \\left( \\frac{\\partial u}{\\partial y} \\right)_{w} \\right|}{\\left| \\left( \\frac{\\partial^{2} u}{\\partial y^{2}} \\right)_{w} \\right|}\n$$\nTo evaluate this expression, we must find the wall-normal derivatives of the streamwise velocity $u(x,y)$. The velocity is given by the similarity solution $u(x,y) = U_{e}(x) f'(\\eta)$, where the similarity variable is $\\eta = y \\alpha(x)$. The term $\\alpha(x)$ is independent of $y$.\n\nWe use the chain rule to compute the derivatives with respect to $y$:\n$$\n\\frac{\\partial}{\\partial y} = \\frac{d\\eta}{dy} \\frac{d}{d\\eta} = \\alpha(x) \\frac{d}{d\\eta}\n$$\nThe first wall-normal derivative of $u$ is:\n$$\n\\frac{\\partial u}{\\partial y} = \\frac{\\partial}{\\partial y} \\left( U_{e}(x) f'(\\eta) \\right) = U_{e}(x) \\frac{\\partial}{\\partial y} f'(\\eta) = U_{e}(x) \\left( \\alpha(x) \\frac{d}{d \\eta} f'(\\eta) \\right) = U_{e}(x) \\alpha(x) f''(\\eta)\n$$\nThe second wall-normal derivative is:\n$$\n\\frac{\\partial^{2} u}{\\partial y^{2}} = \\frac{\\partial}{\\partial y} \\left( U_{e}(x) \\alpha(x) f''(\\eta) \\right) = U_{e}(x) \\alpha(x) \\frac{\\partial}{\\partial y} f''(\\eta) = U_{e}(x) \\alpha(x) \\left( \\alpha(x) \\frac{d}{d\\eta} f''(\\eta) \\right) = U_{e}(x) \\alpha(x)^{2} f'''(\\eta)\n$$\nNow, we evaluate these derivatives at the wall ($y=0$), which corresponds to $\\eta = 0$:\n$$\n\\left( \\frac{\\partial u}{\\partial y} \\right)_{w} = U_{e}(x) \\alpha(x) f''(0)\n$$\n$$\n\\left( \\frac{\\partial^{2} u}{\\partial y^{2}} \\right)_{w} = U_{e}(x) \\alpha(x)^{2} f'''(0)\n$$\nSubstituting these expressions back into the formula for $h_n$:\n$$\nh_{n} = \\varepsilon_{g} \\frac{\\left| U_{e}(x) \\alpha(x) f''(0) \\right|}{\\left| U_{e}(x) \\alpha(x)^{2} f'''(0) \\right|}\n$$\nSince $U_e(x)$ and $\\alpha(x)$ are positive for $x>0$, we can simplify this to:\n$$\nh_{n} = \\varepsilon_{g} \\frac{|f''(0)|}{\\alpha(x) |f'''(0)|}\n$$\nFinally, we substitute the definition of $\\alpha(x) = \\sqrt{\\frac{U_{e}(x)}{\\nu x}}$:\n$$\nh_{n}(x) = \\varepsilon_{g} \\frac{|f''(0)|}{|f'''(0)|} \\left( \\frac{U_{e}(x)}{\\nu x} \\right)^{-\\frac{1}{2}} = \\varepsilon_{g} \\frac{|f''(0)|}{|f'''(0)|} \\sqrt{\\frac{\\nu x}{U_{e}(x)}}\n$$\nThis is the desired expression for the wall-normal cell spacing at the wall as a function of $x$.\n\nNext, we construct the mesh metric tensor $M(x)$. The problem states the flow is over a flat wall. We can align our coordinate system such that the $x$-axis is tangent to the wall and the $y$-axis is normal to the wall. In this case, the unit tangent vector is $[1, 0]^T$ and the unit normal vector is $[0, 1]^T$. The rotation matrix $R(x)$ is therefore the identity matrix $I$.\n$$\nR(x) = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}\n$$\nThe metric tensor becomes:\n$$\nM(x) = I^{\\top} \\mathrm{diag}\\!\\left( \\frac{1}{h_{t}(x)^{2}}, \\, \\frac{1}{h_{n}(x)^{2}} \\right) I = \\begin{pmatrix} \\frac{1}{h_{t}(x)^{2}} & 0 \\\\ 0 & \\frac{1}{h_{n}(x)^{2}} \\end{pmatrix}\n$$\nSubstituting our derived expression for $h_n(x)$:\n$$\nM(x) = \\begin{pmatrix} \\frac{1}{h_{t}(x)^{2}} & 0 \\\\ 0 & \\left( \\frac{|f'''(0)|}{\\varepsilon_{g} |f''(0)|} \\right)^{2} \\frac{U_{e}(x)}{\\nu x} \\end{pmatrix}\n$$\n\nFinally, we compute the first-layer wall-normal spacing $h_1 = h_n(x=L)$ for the specified stagnation-point flow.\n-   Given $m=1$, the pressure gradient parameter is $\\beta = \\frac{2(1)}{1+1} = 1$.\n-   The external velocity is $U_e(x) = U_0 \\frac{x}{L}$. At $x=L$, this gives $U_e(L) = U_0 \\frac{L}{L} = U_0$.\n-   The wall values are given as $f''(0) = 1$ and $f'''(0) = -\\beta = -1$.\n-   The expression for the first-layer height $h_1$ at $x=L$ is:\n$$\nh_{1} = h_{n}(L) = \\varepsilon_{g} \\frac{|f''(0)|}{|f'''(0)|} \\sqrt{\\frac{\\nu L}{U_{e}(L)}} = \\varepsilon_{g} \\frac{|1|}{|-1|} \\sqrt{\\frac{\\nu L}{U_{0}}}\n$$\nNow, we substitute the numerical values:\n-   $U_{0} = 30 \\,\\mathrm{m/s}$\n-   $L = 1 \\,\\mathrm{m}$\n-   $\\nu = 1.5 \\times 10^{-5} \\,\\mathrm{m^{2}/s}$\n-   $\\varepsilon_{g} = 0.05$\n$$\nh_{1} = 0.05 \\times \\frac{1}{1} \\times \\sqrt{\\frac{(1.5 \\times 10^{-5} \\,\\mathrm{m^{2}/s}) \\times (1 \\,\\mathrm{m})}{30 \\,\\mathrm{m/s}}}\n$$\n$$\nh_{1} = 0.05 \\sqrt{\\frac{1.5 \\times 10^{-5}}{30} \\,\\mathrm{m^2}} = 0.05 \\sqrt{0.05 \\times 10^{-5} \\,\\mathrm{m^2}} = 0.05 \\sqrt{5 \\times 10^{-7} \\,\\mathrm{m^2}}\n$$\n$$\nh_{1} = 0.05 \\times \\sqrt{5} \\times 10^{-3.5} \\,\\mathrm{m} = 0.05 \\times \\sqrt{50 \\times 10^{-8}} \\,\\mathrm{m} = 0.05 \\times \\sqrt{50} \\times 10^{-4} \\,\\mathrm{m}\n$$\n$$\nh_{1} = 0.05 \\times (7.0710678...) \\times 10^{-4} \\,\\mathrm{m}\n$$\n$$\nh_{1} = 0.35355339... \\times 10^{-4} \\,\\mathrm{m} = 3.5355339... \\times 10^{-5} \\,\\mathrm{m}\n$$\nRounding to four significant figures, we get:\n$$\nh_{1} \\approx 3.536 \\times 10^{-5} \\,\\mathrm{m}\n$$",
            "answer": "$$ \\boxed{3.536 \\times 10^{-5}} $$"
        }
    ]
}