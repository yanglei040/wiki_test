{
    "hands_on_practices": [
        {
            "introduction": "设计棱柱形膨胀层网格并非随心所欲，而是必须遵循湍流边界层的物理原理。为了精确捕捉壁面束缚湍流，网格必须足够精细，以解析关键的物理结构。本练习  首先要求您基于近壁湍流条带的特征尺度，推导壁面解析大涡模拟（LES）中著名的网格划分准则，例如对壁面单位 $y^+$ 的要求。然后，您需要将这些准则应用于一个具体的工程场景，计算覆盖边界层所需的膨胀层数量。对于任何希望进行高保真湍流模拟的研究者来说，这项实践至关重要。",
            "id": "3354487",
            "problem": "考虑一个光滑平板上零压力梯度的湍流边界层，在距离前缘为 $x$ 的流向站位处。自由来流速度为 $U_{\\infty}$，运动粘度为 $\\nu$。将使用壁面解析大涡模拟（LES）进行计算，其中壁面附近使用棱柱形膨胀层，并向远离壁面的六面体核心网格过渡。网格必须以壁面单位指定，该单位基于摩擦速度 $u_{\\tau} \\equiv \\sqrt{\\tau_{w}/\\rho}$，其中 $\\tau_{w}$ 是壁面剪切应力，$\\rho$ 是流体密度。壁面单位的常规定义为 $y^{+} \\equiv y u_{\\tau}/\\nu$，$\\Delta x^{+} \\equiv \\Delta x\\, u_{\\tau}/\\nu$，以及 $\\Delta z^{+} \\equiv \\Delta z\\, u_{\\tau}/\\nu$。\n\n1) 从以下关于近壁面有界湍流和亚格子尺度模型的成熟事实出发：\n- 近壁循环表现出主导的含能条带，其展向间距为 $\\lambda_{z,\\mathrm{peak}}^{+} \\approx 100$；在 $y^{+} = \\mathcal{O}(10)$ 处，还表现出流向拉伸结构，其主导波长为 $\\lambda_{x,\\mathrm{peak}}^{+} \\approx 1000$。这一点由壁面剪切应力和流向速度脉动的预乘谱所支持。\n- 在壁面解析LES中，亚格子滤波宽度应在对数区（其中 $\\kappa \\approx 0.41$）保持小于局部剪切长度尺度 $L_{s} \\sim \\kappa y$，以避免对含能涡的过度亚格子建模。\n- 粘性子层的厚度为 $y^{+} \\lesssim 5$，缓冲层延伸至 $y^{+} \\approx 30$。\n仅使用这些事实和壁面单位的定义，推导壁面平行方向网格间距和离壁第一点的目标约束条件，以确保解析网格能够以每个主导波长合理数量的点来捕捉含能的近壁结构，并确保亚格子截止尺度不高于近壁的剪切长度尺度。证明这些推导出的范围与壁面解析LES的常用范围 $\\Delta x^{+} \\approx 50$–$150$、$\\Delta z^{+} \\approx 15$–$40$ 以及离壁第一点位于 $y^{+} \\approx 1$ 相符。\n\n2) 对于一个具体的平板算例，其中 $U_{\\infty} = 30\\ \\mathrm{m/s}$，$\\nu = 1.5 \\times 10^{-5}\\ \\mathrm{m^{2}/s}$，且 $x = 1.0\\ \\mathrm{m}$，使用站位 $x$ 处局部壁面摩擦系数 $C_{f,x}$ 的七分之一次方幂律关系式来估算局部壁面摩擦速度 $u_{\\tau}$，\n$$\nC_{f,x} \\equiv \\frac{2 \\tau_{w}}{\\rho U_{\\infty}^{2}} \\approx 0.026\\, \\mathrm{Re}_{x}^{-1/7}, \\quad \\mathrm{Re}_{x} \\equiv \\frac{U_{\\infty} x}{\\nu},\n$$\n并计算为达到 $y_{1}^{+} \\equiv \\Delta y_{1} u_{\\tau}/\\nu = 1$ 所需的第一层高度 $\\Delta y_{1}$。接下来，使用成熟的湍流平板关系式估算局部边界层厚度\n$$\n\\delta(x) \\approx 0.37\\, x\\, \\mathrm{Re}_{x}^{-1/5}.\n$$\n假设近壁棱柱形膨胀层堆栈在法向方向上具有几何增长因子 $r = 1.20$，从 $\\Delta y_{1}$ 开始，并按 $\\Delta y_{k} = \\Delta y_{1}\\, r^{k-1}$ (层索引 $k=1,2,\\dots$) 增长。确定棱柱形层的最小整数数量 $N$，使得累积膨胀厚度\n$$\n\\sum_{k=1}^{N} \\Delta y_{k} \\ge \\delta(x).\n$$\n将你的最终答案表示为最小整数 $N$（无单位）。不要报告任何其他量。如果任何中间数值步骤需要近似，请保持足够的精度，以在最后产生一个明确的整数 $N$。",
            "solution": "该问题分为两部分。第一部分要求从近壁湍流的基本原理推导壁面解析大涡模拟（LES）的通用网格划分准则。第二部分是相关经验公式的数值应用，以确定覆盖整个湍流边界层所需的膨胀层数量。\n\n该问题具有科学依据，提法恰当且客观。它提出了计算流体动力学（CFD）中的一个标准问题，该问题结合了理论理解与实际应用。所有提供的信息，包括物理常数、经验关系式和湍流现象学，都是该领域的标准和公认内容。因此，该问题是有效的。\n\n**第1部分：壁面解析LES网格约束的推导**\n\n目标是为壁面解析LES推导网格间距（$\\Delta x^{+}$、$\\Delta z^{+}$）和离壁第一网格点位置（$y_1^{+}$）的目标约束。该推导将基于所提供的关于近壁湍流结构和亚格子尺度建模原理的事实。\n\n1.  **离壁第一点 ($y_1^{+}$):** 问题指出，粘性子层占据 $y^{+} \\lesssim 5$ 的区域，在该区域中粘性起主导作用且速度剖面陡峭。为了精确捕捉该层内的物理现象，特别是作为整个尺度律基础的壁面剪切应力 $\\tau_w$，计算网格必须解析该区域。这意味着离壁的第一个网格点 $y_1$ 必须被放置在粘性子层深处。一个典型且通常严格的要求是将第一个单元中心放置在 $y_1^{+} = y_1 u_{\\tau}/\\nu \\approx 1$ 处。这确保了在子层深处至少有一个计算点，满足 $y_1^{+} \\lesssim 5$ 的条件。因此，准则 $y_1^{+} \\approx 1$ 是解析近壁粘性主导区域需求的直接结果。\n\n2.  **展向网格间距 ($\\Delta z^{+}$):** 问题提供了一个关键事实，即近壁湍流的特征是主导的含能结构，通常称为低速条带，其特征展向间距为 $\\lambda_{z,\\mathrm{peak}}^{+} \\approx 100$。要使LES成为“壁面解析”的，它必须解析这些含能涡，而不是对它们进行建模。为了解析某个波长的结构，网格间距必须是该波长的一小部分。设 $N_z$ 是用于解析展向波长 $\\lambda_{z,\\mathrm{peak}}^{+}$ 的网格点数。则网格间距为 $\\Delta z^{+} = \\lambda_{z,\\mathrm{peak}}^{+} / N_z$。为了充分捕捉这些条带的形状和动力学特性，$N_z$ 必须大于奈奎斯特准则的2。一个合理的解析度典型范围是 $N_z \\in [2.5, 7]$。\n    -   对于每个条带 $N_z=2.5$ 个点的最低解析度，展向间距为 $\\Delta z^{+} = 100 / 2.5 = 40$。\n    -   对于每个条带 $N_z \\approx 7$ 个点的更高解析度，间距为 $\\Delta z^{+} = 100 / 7 \\approx 14.3$。\n    这些界限直接导出了常被引用的范围 $\\Delta z^{+} \\approx 15$–$40$。\n\n3.  **流向网格间距 ($\\Delta x^{+}$):** 类似的论证也适用于流向。近壁结构被认为是高度拉伸的，其主流向波长为 $\\lambda_{x,\\mathrm{peak}}^{+} \\approx 1000$。设 $N_x$ 是用于解析该长度的网格点数。所需的流向网格间距为 $\\Delta x^{+} = \\lambda_{x,\\mathrm{peak}}^{+} / N_x$。尽管这些结构很长，但解析其时间演化和空间相干性非常重要。$N_x$ 的一个典型范围可能是 $N_x \\in [7, 20]$。\n    -   对于 $N_x = 7$ 个点，流向间距为 $\\Delta x^{+} = 1000 / 7 \\approx 143$。\n    -   对于 $N_x = 20$ 个点，间距为 $\\Delta x^{+} = 1000 / 20 = 50$。\n    这一推理路线导出了推荐的范围 $\\Delta x^{+} \\approx 50$–$150$。\n\n4.  **与剪切长度尺度准则的一致性:** 问题指出，在对数区（其中 $y^{+} \\gtrsim 30$ 且 $\\kappa \\approx 0.41$），亚格子滤波宽度 $\\Delta_{LES}$ 应保持小于局部剪切长度尺度 $L_s \\sim \\kappa y$。用壁面单位表示，即 $\\Delta_{LES}^{+}  \\kappa y^{+}$。滤波宽度 $\\Delta_{LES}$ 通常是局部单元尺寸的函数，例如 $\\Delta_{LES} = (\\Delta x \\Delta y \\Delta z)^{1/3}$。推导出的 $\\Delta x^{+}$ 和 $\\Delta z^{+}$ 解析度要求主要由解析缓冲层（$y^+ \\approx 5-30$）中大型含能涡的需求驱动，而不必然由对数层中的剪切长度尺度论证驱动。在实践中，$\\Delta x^{+}$ 和 $\\Delta z^{+}$ 的解析度要求可能与 $L_s$ 准则冲突，特别是在对数层的下边缘，那里的 $L_s$ 很小。例如，在 $y^+=30$ 处，$L_s^+ \\approx 0.41 \\times 30 = 12.3$。一个 $\\Delta z^+ = 30$ 的展向解析度将违反 $\\Delta z^+  L_s^+$。这反映了壁面解析LES中一个已知的折衷，即优先解析主导的近壁结构，而由于有限的计算资源，接受在对数层中对较小尺度的剪切生成涡进行一定的建模。因此，所推导的范围被理解为与壁面解析LES的总体目标是*一致的*，即使并非每个准则在流场中的每一点都得到严格满足。\n\n**第2部分：膨胀层数量的计算**\n\n这部分需要对一个特定的流动案例进行数值计算。给定参数为 $U_{\\infty} = 30\\ \\mathrm{m/s}$，$\\nu = 1.5 \\times 10^{-5}\\ \\mathrm{m^{2}/s}$，以及 $x = 1.0\\ \\mathrm{m}$。膨胀层增长率为 $r = 1.20$。\n\n1.  **计算站位 $x$ 处的雷诺数：**\n    $$ \\mathrm{Re}_{x} = \\frac{U_{\\infty} x}{\\nu} = \\frac{(30\\ \\mathrm{m/s})(1.0\\ \\mathrm{m})}{1.5 \\times 10^{-5}\\ \\mathrm{m^{2}/s}} = 2.0 \\times 10^6 $$\n\n2.  **计算局部壁面摩擦系数 $C_{f,x}$：**\n    $$ C_{f,x} \\approx 0.026\\, \\mathrm{Re}_{x}^{-1/7} = 0.026 \\times (2.0 \\times 10^6)^{-1/7} $$\n    $$ C_{f,x} \\approx 0.026 \\times (7.9455)^{-1} \\approx 0.003272 $$\n\n3.  **计算摩擦速度 $u_{\\tau}$：**\n    $C_{f,x}$ 的定义是 $C_{f,x} \\equiv \\frac{2 \\tau_{w}}{\\rho U_{\\infty}^{2}}$。摩擦速度是 $u_{\\tau} \\equiv \\sqrt{\\tau_{w}/\\rho}$。\n    $$ u_{\\tau} = \\sqrt{\\frac{\\tau_w}{\\rho}} = \\sqrt{\\frac{C_{f,x} \\rho U_{\\infty}^{2}}{2\\rho}} = U_{\\infty} \\sqrt{\\frac{C_{f,x}}{2}} $$\n    $$ u_{\\tau} \\approx 30\\ \\mathrm{m/s} \\times \\sqrt{\\frac{0.003272}{2}} = 30 \\times \\sqrt{0.001636} \\approx 30 \\times 0.040448 \\approx 1.2134\\ \\mathrm{m/s} $$\n\n4.  **计算第一层高度 $\\Delta y_1$：**\n    要求是第一个单元中心位于 $y_1^{+} = 1$。对于紧邻壁面的单元，我们近似认为 $y_1 \\approx \\Delta y_1 / 2$，但在这种情况下，通常的做法是设置第一个单元的高度 $\\Delta y_1$，使其中心 $y_1$ 位于目标 $y^+$ 位置，或者简单地满足 $y_1^+ = \\Delta y_1 u_\\tau / \\nu = 1$。问题陈述中使用了符号 $y_{1}^{+} \\equiv \\Delta y_{1} u_{\\tau}/\\nu = 1$。\n    $$ \\Delta y_{1} = \\frac{1 \\cdot \\nu}{u_{\\tau}} \\approx \\frac{1.5 \\times 10^{-5}\\ \\mathrm{m^2/s}}{1.2134\\ \\mathrm{m/s}} \\approx 1.236 \\times 10^{-5}\\ \\mathrm{m} $$\n\n5.  **计算边界层厚度 $\\delta(x)$：**\n    $$ \\delta(x) \\approx 0.37\\, x\\, \\mathrm{Re}_{x}^{-1/5} = 0.37 \\times (1.0\\ \\mathrm{m}) \\times (2.0 \\times 10^6)^{-1/5} $$\n    $$ (2.0 \\times 10^6)^{1/5} \\approx 18.2056 $$\n    $$ \\delta(x) \\approx 0.37 \\times (18.2056)^{-1} \\approx 0.020323\\ \\mathrm{m} $$\n\n6.  **确定最小层数 $N$：**\n    具有初始高度 $\\Delta y_1$ 和增长因子 $r$ 的 $N$ 个棱柱形层的累积厚度由几何级数的和给出：\n    $$ S_N = \\sum_{k=1}^{N} \\Delta y_k = \\sum_{k=1}^{N} \\Delta y_1 r^{k-1} = \\Delta y_1 \\frac{r^N - 1}{r - 1} $$\n    我们需要找到最小的整数 $N$，使得 $S_N \\ge \\delta(x)$。\n    $$ \\Delta y_1 \\frac{r^N - 1}{r - 1} \\ge \\delta(x) $$\n    代入已知值 ($r=1.20$)：\n    $$ (1.236 \\times 10^{-5}\\ \\mathrm{m}) \\times \\frac{1.20^N - 1}{1.20 - 1} \\ge 0.020323\\ \\mathrm{m} $$\n    $$ (1.236 \\times 10^{-5}) \\times \\frac{1.20^N - 1}{0.20} \\ge 0.020323 $$\n    $$ 6.18 \\times 10^{-5} \\times (1.20^N - 1) \\ge 0.020323 $$\n    $$ 1.20^N - 1 \\ge \\frac{0.020323}{6.18 \\times 10^{-5}} \\approx 328.85 $$\n    $$ 1.20^N \\ge 329.85 $$\n    为了求解 $N$，我们对两边取自然对数：\n    $$ N \\ln(1.20) \\ge \\ln(329.85) $$\n    $$ N \\ge \\frac{\\ln(329.85)}{\\ln(1.20)} \\approx \\frac{5.7986}{0.1823} \\approx 31.808 $$\n    由于 $N$ 必须是整数，所需的最小层数是大于或等于此值的下一个整数。\n    $$ N = 32 $$\n    用更高的精度进行计算可以证实这个结果：\n    $u_{\\tau} \\approx 1.2134555\\ \\mathrm{m/s}$, $\\Delta y_1 \\approx 1.23611 \\times 10^{-5}\\ \\mathrm{m}$, $\\delta(x) \\approx 0.0203232\\ \\mathrm{m}$。\n    $N \\ge \\frac{\\ln\\left(1 + \\frac{\\delta(x)(r-1)}{\\Delta y_1}\\right)}{\\ln(r)} = \\frac{\\ln\\left(1 + \\frac{0.0203232 \\times 0.2}{1.23611 \\times 10^{-5}}\\right)}{\\ln(1.2)} = \\frac{\\ln(1+328.825)}{\\ln(1.2)} = \\frac{\\ln(329.825)}{\\ln(1.2)} \\approx 31.804$.\n    最小整数是 $N=32$。",
            "answer": "$$\\boxed{32}$$"
        },
        {
            "introduction": "在建立了膨胀层设计的物理基础之后，我们现在转向其带来的数值影响。在实际应用中，棱柱层单元通常具有高拉伸比（高展弦比），并且在曲面附近可能存在非正交性。本练习  深入探讨了这些几何特性如何影响数值计算的精度。通过对拉普拉斯算子进行严格的截断误差分析，您将量化单元的展弦比 ($AR$) 和非正交性 ($\\theta$) 如何引入额外的误差项，从而深刻理解在膨胀层网格划分中所涉及的权衡。",
            "id": "3354533",
            "problem": "考虑位于 $y=\\pm H$ 的平行板之间的稳态、充分发展的层流通道流，其速度分布为经典的平面泊肃叶流 (Poiseuille) 基准剖面，并叠加了一个小的人为扰动，以便能够对截断误差进行严格的量化以用于验证。设流向速度为\n$$\nu(x,y) \\;=\\; U_{\\max}\\!\\left(1 - \\frac{y^{2}}{H^{2}}\\right) \\;+\\; \\varepsilon\\,\\cos(k x)\\,\\left(\\frac{y}{H}\\right)^{4},\n$$\n其中 $\\varepsilon$ 是一个小的无量纲振幅，$k$ 是一个实波数。你将使用局部均匀的结构化网格，分析流向动量平衡中粘性项里出现的拉普拉斯算子的二阶、单元中心有限体积离散化的截断误差。\n\n考虑两种局部均匀网格：\n- 一种与 $(x,y)$ 坐标轴对齐的正交、各向同性的六面体网格，其间距为 $\\Delta x=\\Delta y=\\Delta$。\n- 一种拉伸的棱柱形膨胀网格，其切向（平行于壁面）间距为 $\\Delta s$，法向（垂直于壁面）间距为 $\\Delta t$，纵横比为 $AR=\\Delta s/\\Delta t$。其局部网格线相对于 $(x,y)$ 坐标系旋转了一个非正交角 $\\theta$，因此切向坐标为 $s = x \\cos\\theta + y \\sin\\theta$，法向坐标为 $t = -x \\sin\\theta + y \\cos\\theta$。假设棱柱层网格具有与各向同性网格相同的法向间距，即 $\\Delta t = \\Delta$，且 $\\Delta s = AR\\,\\Delta$。\n\n采用基于高斯散度定理的均匀网格上拉普拉斯算子的二阶中心有限体积近似，该方法（在每个方向上）可简化为每个坐标方向上二阶导数的中心二阶差分近似。使用关于单元中心的泰勒展开，计算到 $\\Delta$ 的最低非零阶，并在需要时计算到 $\\theta$ 的最低阶。使用链式法则将 $(s,t)$ 中的导数与 $(x,y)$ 中的导数关联起来。\n\n将单元中心的局部截断误差定义为离散拉普拉斯算子与作用于 $u(x,y)$ 的连续拉普拉斯算子之差。用 $TE_{\\mathrm{hex}}$ 表示各向同性六面体网格上的最低阶截断误差，用 $TE_{\\mathrm{pris}}$ 表示拉伸旋转的棱柱形网格上的最低阶截断误差。在通道中心线 $y=0$ 处计算这两个误差。\n\n从第一性原理推导无量纲比率\n$$\nR(AR,\\theta) \\;=\\; \\frac{|TE_{\\mathrm{pris}}(y=0)|}{|TE_{\\mathrm{hex}}(y=0)|}\n$$\n的闭式解析表达式，其为 $AR$ 和 $\\theta$ 的函数，并消去除 $AR$ 和 $\\theta$ 之外的所有问题参数。\n\n你的最终答案必须是 $R(AR,\\theta)$ 的简化解析表达式，无单位。不要计算任何数值近似值。以单一闭式表达式的形式提供最终答案。",
            "solution": "该问题要求推导在两种不同类型的网格上，拉普拉斯算子的有限体积离散化所产生的最低阶截断误差的比率。设给定的流向速度为 $u(x,y) = U_{\\max}(1 - \\frac{y^{2}}{H^{2}}) + \\varepsilon\\,\\cos(k x)\\,(\\frac{y}{H})^{4}$。截断误差 $TE$ 定义为离散拉普拉斯算子 $(\\nabla^2)_{\\text{discrete}}$ 与连续拉普拉斯算子 $\\nabla^2 u = \\frac{\\partial^2 u}{\\partial x^2} + \\frac{\\partial^2 u}{\\partial y^2}$ 之差。我们需要在通道中心线 $y=0$ 处计算此误差的最低阶部分。\n\n首先，我们分析各向同性的六面体网格。该网格是正交的，并与 $(x,y)$ 坐标轴对齐，均匀间距为 $\\Delta x = \\Delta y = \\Delta$。问题指出，拉普拉斯算子的二阶、单元中心有限体积近似可简化为每个坐标方向上中心二阶差分算子之和。在单元中心 $(x,y)$ 处，其形式为：\n$$\n(\\nabla^2_{\\mathrm{hex}} u)(x,y) = \\frac{u(x+\\Delta, y) - 2u(x,y) + u(x-\\Delta, y)}{\\Delta^2} + \\frac{u(x, y+\\Delta) - 2u(x,y) + u(x, y-\\Delta)}{\\Delta^2}\n$$\n为了求得截断误差，我们对每一项在点 $(x,y)$ 附近进行泰勒级数展开。\n$$\nu(x\\pm\\Delta, y) = u \\pm \\Delta \\frac{\\partial u}{\\partial x} + \\frac{\\Delta^2}{2!} \\frac{\\partial^2 u}{\\partial x^2} \\pm \\frac{\\Delta^3}{3!} \\frac{\\partial^3 u}{\\partial x^3} + \\frac{\\Delta^4}{4!} \\frac{\\partial^4 u}{\\partial x^4} + O(\\Delta^6)\n$$\n$$\nu(x, y\\pm\\Delta) = u \\pm \\Delta \\frac{\\partial u}{\\partial y} + \\frac{\\Delta^2}{2!} \\frac{\\partial^2 u}{\\partial y^2} \\pm \\frac{\\Delta^3}{3!} \\frac{\\partial^3 u}{\\partial y^3} + \\frac{\\Delta^4}{4!} \\frac{\\partial^4 u}{\\partial y^4} + O(\\Delta^6)\n$$\n将这些展开式代入 $(\\nabla^2_{\\mathrm{hex}} u)$ 的表达式中：\n$$\n(\\nabla^2_{\\mathrm{hex}} u) = \\frac{1}{\\Delta^2}\\left(2\\frac{\\Delta^2}{2!} \\frac{\\partial^2 u}{\\partial x^2} + 2\\frac{\\Delta^4}{4!} \\frac{\\partial^4 u}{\\partial x^4} + \\dots \\right) + \\frac{1}{\\Delta^2}\\left(2\\frac{\\Delta^2}{2!} \\frac{\\partial^2 u}{\\partial y^2} + 2\\frac{\\Delta^4}{4!} \\frac{\\partial^4 u}{\\partial y^4} + \\dots \\right)\n$$\n$$\n(\\nabla^2_{\\mathrm{hex}} u) = \\left(\\frac{\\partial^2 u}{\\partial x^2} + \\frac{\\partial^2 u}{\\partial y^2}\\right) + \\frac{\\Delta^2}{12}\\left(\\frac{\\partial^4 u}{\\partial x^4} + \\frac{\\partial^4 u}{\\partial y^4}\\right) + O(\\Delta^4)\n$$\n最低阶截断误差 $TE_{\\mathrm{hex}}$ 是连续拉普拉斯算子之后的第一个非零项：\n$$\nTE_{\\mathrm{hex}} = (\\nabla^2_{\\mathrm{hex}} u) - \\nabla^2 u = \\frac{\\Delta^2}{12}\\left(\\frac{\\partial^4 u}{\\partial x^4} + \\frac{\\partial^4 u}{\\partial y^4}\\right)\n$$\n为了在 $y=0$ 处计算该误差，我们需要 $u(x,y)$ 的四阶导数。\n$$\n\\frac{\\partial^4 u}{\\partial x^4} = \\frac{\\partial^4}{\\partial x^4} \\left[ U_{\\max}\\!\\left(1 - \\frac{y^{2}}{H^{2}}\\right) \\;+\\; \\varepsilon\\,\\cos(k x)\\,\\left(\\frac{y}{H}\\right)^{4} \\right] = \\varepsilon k^4 \\cos(kx) \\left(\\frac{y}{H}\\right)^4\n$$\n$$\n\\frac{\\partial^4 u}{\\partial y^4} = \\frac{\\partial^4}{\\partial y^4} \\left[ U_{\\max}\\!\\left(1 - \\frac{y^{2}}{H^{2}}\\right) \\;+\\; \\varepsilon\\,\\cos(k x)\\,\\left(\\frac{y}{H}\\right)^{4} \\right] = 0 + \\frac{\\varepsilon}{H^4} \\cos(kx) \\frac{d^4}{dy^4}(y^4) = \\frac{24 \\varepsilon}{H^4} \\cos(kx)\n$$\n在 $y=0$ 处计算这些导数：\n$$\n\\left.\\frac{\\partial^4 u}{\\partial x^4}\\right|_{y=0} = 0, \\quad \\left.\\frac{\\partial^4 u}{\\partial y^4}\\right|_{y=0} = \\frac{24 \\varepsilon}{H^4} \\cos(kx)\n$$\n因此，六面体网格在中心线上的截断误差为：\n$$\nTE_{\\mathrm{hex}}(y=0) = \\frac{\\Delta^2}{12}\\left(0 + \\frac{24 \\varepsilon}{H^4} \\cos(kx)\\right) = \\frac{2 \\varepsilon \\Delta^2}{H^4} \\cos(kx)\n$$\n\n接下来，我们分析拉伸、旋转的棱柱形网格。局部网格坐标为 $(s,t)$，间距为 $\\Delta s$ 和 $\\Delta t$，相对于 $(x,y)$ 坐标系旋转了角度 $\\theta$。坐标变换为 $s = x \\cos\\theta + y \\sin\\theta$ 和 $t = -x \\sin\\theta + y \\cos\\theta$。离散拉普拉斯算子是沿着这些网格线应用的：\n$$\n(\\nabla^2_{\\mathrm{pris}} u)(s,t) = \\frac{u(s+\\Delta s, t) - 2u(s,t) + u(s-\\Delta s, t)}{(\\Delta s)^2} + \\frac{u(s, t+\\Delta t) - 2u(s,t) + u(s, t-\\Delta t)}{(\\Delta t)^2}\n$$\n与前一种情况类似，离散算子可以通过在 $(s,t)$ 坐标系下的泰勒级数来表示：\n$$\n(\\nabla^2_{\\mathrm{pris}} u) = \\left(\\frac{\\partial^2 u}{\\partial s^2} + \\frac{\\partial^2 u}{\\partial t^2}\\right) + \\frac{(\\Delta s)^2}{12}\\frac{\\partial^4 u}{\\partial s^4} + \\frac{(\\Delta t)^2}{12}\\frac{\\partial^4 u}{\\partial t^4} + \\dots\n$$\n拉普拉斯算子在旋转下是不变的，因此 $\\frac{\\partial^2 u}{\\partial s^2} + \\frac{\\partial^2 u}{\\partial t^2} = \\frac{\\partial^2 u}{\\partial x^2} + \\frac{\\partial^2 u}{\\partial y^2} = \\nabla^2 u$。所以，棱柱形网格的最低阶截断误差为：\n$$\nTE_{\\mathrm{pris}} = (\\nabla^2_{\\mathrm{pris}} u) - \\nabla^2 u = \\frac{(\\Delta s)^2}{12}\\frac{\\partial^4 u}{\\partial s^4} + \\frac{(\\Delta t)^2}{12}\\frac{\\partial^4 u}{\\partial t^4}\n$$\n我们需要用关于 $x$ 和 $y$ 的导数来表示关于 $s$ 和 $t$ 的导数。逆变换给出了链式法则算子：\n$$\n\\frac{\\partial}{\\partial s} = \\cos\\theta \\frac{\\partial}{\\partial x} + \\sin\\theta \\frac{\\partial}{\\partial y}, \\qquad \\frac{\\partial}{\\partial t} = -\\sin\\theta \\frac{\\partial}{\\partial x} + \\cos\\theta \\frac{\\partial}{\\partial y}\n$$\n我们必须在 $y=0$ 处计算 $\\frac{\\partial^4 u}{\\partial s^4}$ 和 $\\frac{\\partial^4 u}{\\partial t^4}$。在中心线上，任何包含对 $x$ 的一次或多次求导的 $u$ 的偏导数均为零。这是因为 $U_{\\max}$ 项与 $x$ 无关，而扰动项包含因子 $y^4$。此外，在 $y=0$ 处，关于 $y$ 的奇数阶导数也为零。\n具体来说，在 $y=0$ 处，如果 $m>0$ 或 $n$ 为奇数，则 $\\frac{\\partial^{m+n}u}{\\partial x^m \\partial y^n}=0$。在 $y=0$ 处，唯一不为零的四阶导数是 $\\frac{\\partial^4 u}{\\partial y^4}$ 形式的项。\n将算子 $\\frac{\\partial^4}{\\partial s^4} = (\\cos\\theta \\frac{\\partial}{\\partial x} + \\sin\\theta \\frac{\\partial}{\\partial y})^4$ 应用于 $u$ 并在 $y=0$ 处求值，二项式展开中所有包含 $\\frac{\\partial}{\\partial x}$ 算子的项都将消失。只有 $(\\sin\\theta \\frac{\\partial}{\\partial y})^4$ 这一项不为零：\n$$\n\\left.\\frac{\\partial^4 u}{\\partial s^4}\\right|_{y=0} = \\sin^4\\theta \\left.\\frac{\\partial^4 u}{\\partial y^4}\\right|_{y=0} = \\sin^4\\theta \\left(\\frac{24 \\varepsilon}{H^4} \\cos(kx)\\right)\n$$\n同样，对于 $\\frac{\\partial^4}{\\partial t^4} = (-\\sin\\theta \\frac{\\partial}{\\partial x} + \\cos\\theta \\frac{\\partial}{\\partial y})^4$：\n$$\n\\left.\\frac{\\partial^4 u}{\\partial t^4}\\right|_{y=0} = \\cos^4\\theta \\left.\\frac{\\partial^4 u}{\\partial y^4}\\right|_{y=0} = \\cos^4\\theta \\left(\\frac{24 \\varepsilon}{H^4} \\cos(kx)\\right)\n$$\n现在我们使用给定的网格约束条件 $\\Delta t = \\Delta$ 和 $\\Delta s = AR \\cdot \\Delta$ 来组合得到 $TE_{\\mathrm{pris}}(y=0)$。\n$$\nTE_{\\mathrm{pris}}(y=0) = \\frac{(AR \\cdot \\Delta)^2}{12} \\left(\\sin^4\\theta \\frac{24 \\varepsilon}{H^4} \\cos(kx)\\right) + \\frac{\\Delta^2}{12} \\left(\\cos^4\\theta \\frac{24 \\varepsilon}{H^4} \\cos(kx)\\right)\n$$\n$$\nTE_{\\mathrm{pris}}(y=0) = \\frac{2 \\varepsilon \\Delta^2}{H^4} \\cos(kx) \\left(AR^2 \\sin^4\\theta + \\cos^4\\theta\\right)\n$$\n\n最后，我们计算所要求的比率 $R(AR,\\theta)$。\n$$\nR(AR,\\theta) = \\frac{|TE_{\\mathrm{pris}}(y=0)|}{|TE_{\\mathrm{hex}}(y=0)|} = \\frac{\\left|\\frac{2 \\varepsilon \\Delta^2}{H^4} \\cos(kx) \\left(AR^2 \\sin^4\\theta + \\cos^4\\theta\\right)\\right|}{\\left|\\frac{2 \\varepsilon \\Delta^2}{H^4} \\cos(kx)\\right|}\n$$\n由于 $AR \\ge 0$ 且三角函数项的幂次为偶数，表达式 $AR^2 \\sin^4\\theta + \\cos^4\\theta$ 总是非负的。因此，其绝对值就是表达式本身。\n$$\nR(AR,\\theta) = AR^2 \\sin^4\\theta + \\cos^4\\theta\n$$\n按照要求，除了纵横比 $AR$ 和非正交角 $\\theta$ 之外的所有问题参数都已被消去。",
            "answer": "$$\\boxed{AR^{2} \\sin^{4}\\theta + \\cos^{4}\\theta}$$"
        },
        {
            "introduction": "前一个练习揭示了网格非正交性是离散误差的一个重要来源。这最后一个练习将展示许多CFD软件中采用的解决方案。您将探索有限体积法如何通过引入一个“非正交修正项”来补偿这种误差。在本练习  中，您将从第一性原理出发，推导用于扩散通量的非正交修正项，并编程实现它以量化其效果。这为理解求解器如何在真实工程模拟所使用的复杂、非理想网格上保持计算精度，提供了一个实践性的、代码层面的视角。",
            "id": "3354535",
            "problem": "在计算流体动力学 (CFD) 中，通常在曲面壁附近使用棱柱形或六面体膨胀层，以通过拉伸网格来解析壁面法向梯度，同时保持高展弦比。在标量场稳态扩散的单元中心有限体积法 (FVM) 离散化中，考虑两个相邻的控制体，其形心由大小为 $d$ 的向量 $\\boldsymbol{d}$ 连接，共享一个平面，该平面的面积矢量为 $\\boldsymbol{S}$（大小为 $A$），外向单位法向量为 $\\boldsymbol{n}$。设 $\\boldsymbol{S}$ 和 $\\boldsymbol{d}$ 之间的夹角为 $\\theta$，因此 $\\cos \\theta = \\dfrac{\\boldsymbol{S}\\cdot\\boldsymbol{d}}{A\\,d}$。假设存在一个局部线性标量场，其扩散系数为 $\\Gamma$（单位为 $\\text{m}^2/\\text{s}$），并将在面上的方向导数表示为 $g_d = \\nabla \\phi \\cdot \\boldsymbol{e}_d$ 和 $g_t = \\nabla \\phi \\cdot \\boldsymbol{e}_t$，其中 $\\boldsymbol{e}_d = \\boldsymbol{d}/d$，而 $\\boldsymbol{e}_t$ 是在由 $\\boldsymbol{S}$ 和 $\\boldsymbol{d}$ 张成的平面内与 $\\boldsymbol{e}_d$ 正交的单位向量（因此 $\\boldsymbol{S}$ 可以分解为一个平行于 $\\boldsymbol{e}_d$ 的分量和一个平行于 $\\boldsymbol{e}_t$ 的分量）。设单元中心值满足线性关系 $\\phi_N - \\phi_P = g_d\\, d$。（离开所属单元的）连续面积分扩散通量由 Fick 定律给出：$J_f = -\\Gamma \\int_{S} \\nabla \\phi \\cdot \\boldsymbol{n}\\, \\mathrm{d}S = -\\Gamma\\, \\boldsymbol{S}\\cdot \\nabla \\phi_f$，其中 $\\nabla \\phi_f$ 是线性假设下的面梯度。\n\n你的任务是：\n- 仅从上述基本原理出发，通过将 $\\boldsymbol{S}$ 分解为其沿 $\\boldsymbol{e}_d$ 的分量和在 $\\boldsymbol{e}_t$ 张成空间中的残余分量，推导出用 $A$、$\\theta$、$g_d$、$g_t$ 和 $\\Gamma$ 表示的精确面积分扩散通量。\n- 推导正交有限体积近似，该近似仅使用 $\\boldsymbol{S}$ 沿 $\\boldsymbol{e}_d$ 的投影以及 $\\phi_P$、$\\phi_N$ 和 $g_d$ 之间的线性关系，然后表示出加上后能恢复精确通量的非正交修正项。\n- 制定一个延迟非正交修正方案，其中权重 $\\omega \\in [0,1]$ 显式地应用于非正交项，并推导出正交近似的绝对误差以及应用加权延迟修正后的绝对误差的闭式表达式。使用符号约定，即正通量表示离开拥有者单元。\n- 实现这些表达式，为下方的每个测试用例计算两个量：正交近似的绝对误差和应用加权延迟非正交修正后的绝对误差。将两个误差都用 $\\text{m}^3/\\text{s}$ 表示。\n\n角度单位要求：\n- 在测试套件中，输入 $\\theta$ 使用度，在程序中进行任何三角函数求值时，需将其转换为弧度。\n\n测试套件和参数：\n- 案例 1 (正交性基准)：$\\Gamma = 1.5\\times 10^{-5}\\ \\text{m}^2/\\text{s}$，$A = 1.0\\times 10^{-4}\\ \\text{m}^2$，$d = 1.0\\times 10^{-4}\\ \\text{m}$，$\\theta = 0\\ \\text{deg}$，$g_d = 1.0\\times 10^{4}\\ \\text{m}^{-1}$，$g_t = 3.0\\times 10^{3}\\ \\text{m}^{-1}$，$\\omega = 1.0$。\n- 案例 2 (中等非正交性，完全修正)：$\\Gamma = 1.5\\times 10^{-5}\\ \\text{m}^2/\\text{s}$，$A = 1.0\\times 10^{-4}\\ \\text{m}^2$，$d = 2.0\\times 10^{-4}\\ \\text{m}$，$\\theta = 30\\ \\text{deg}$，$g_d = 8.0\\times 10^{3}\\ \\text{m}^{-1}$，$g_t = 5.0\\times 10^{3}\\ \\text{m}^{-1}$，$\\omega = 1.0$。\n- 案例 3 (高度非正交性，部分修正)：$\\Gamma = 1.5\\times 10^{-5}\\ \\text{m}^2/\\text{s}$，$A = 1.0\\times 10^{-4}\\ \\text{m}^2$，$d = 1.0\\times 10^{-4}\\ \\text{m}$，$\\theta = 75\\ \\text{deg}$，$g_d = 1.2\\times 10^{4}\\ \\text{m}^{-1}$，$g_t = -4.0\\times 10^{3}\\ \\text{m}^{-1}$，$\\omega = 0.7$。\n- 案例 4 (近退化角，完全修正)：$\\Gamma = 1.5\\times 10^{-5}\\ \\text{m}^2/\\text{s}$，$A = 1.0\\times 10^{-4}\\ \\text{m}^2$，$d = 8.0\\times 10^{-5}\\ \\text{m}$，$\\theta = 89\\ \\text{deg}$，$g_d = 5.0\\times 10^{3}\\ \\text{m}^{-1}$，$g_t = 1.0\\times 10^{4}\\ \\text{m}^{-1}$，$\\omega = 1.0$。\n\n最终输出规格：\n- 你的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表，顺序为 $[E^{(1)}_{\\text{orth}},E^{(1)}_{\\text{corr}},E^{(2)}_{\\text{orth}},E^{(2)}_{\\text{corr}},E^{(3)}_{\\text{orth}},E^{(3)}_{\\text{corr}},E^{(4)}_{\\text{orth}},E^{(4)}_{\\text{corr}}]$，其中 $E^{(k)}_{\\text{orth}}$ 是案例 $k$ 的正交近似的绝对误差，$E^{(k)}_{\\text{corr}}$ 是案例 $k$ 应用延迟非正交修正后的绝对误差。所有数字都代表 $\\text{m}^3/\\text{s}$，输出中不应出现单位符号。",
            "solution": "该问题要求推导和计算与单元中心有限体积法 (FVM) 中扩散通量的非正交离散化相关的误差。我们将首先推导通量的精确解析表达式，然后是常见的正交近似表达式和相应的非正交修正项。最后，我们将推导正交近似的绝对误差和加权延迟修正方案的绝对误差的表达式。\n\n设在由 $\\boldsymbol{S}$ 和 $\\boldsymbol{d}$ 定义的平面中的一组标准正交基向量为 $\\{\\boldsymbol{e}_d, \\boldsymbol{e}_t\\}$。向量 $\\boldsymbol{e}_d$ 是沿着连接单元形心线的单位向量，即 $\\boldsymbol{e}_d = \\boldsymbol{d}/d$。向量 $\\boldsymbol{e}_t$ 是在同一平面内与 $\\boldsymbol{e}_d$ 正交的单位向量，即 $\\boldsymbol{e}_t \\cdot \\boldsymbol{e}_d = 0$。\n\n标量场的梯度 $\\nabla \\phi$ 可以在此基下表示。由于其垂直于 $\\{\\boldsymbol{S}, \\boldsymbol{d}\\}$ 平面的分量对通量计算没有贡献（因为 $\\boldsymbol{S}$ 在此平面内），我们只需考虑其在此平面上的投影。给定方向导数 $g_d = \\nabla \\phi \\cdot \\boldsymbol{e}_d$ 和 $g_t = \\nabla \\phi \\cdot \\boldsymbol{e}_t$，梯度向量在此平面内为：\n$$\n\\nabla \\phi = g_d \\boldsymbol{e}_d + g_t \\boldsymbol{e}_t\n$$\n面面积矢量 $\\boldsymbol{S}$ 的大小为 $A$，方向沿着外向单位法向量 $\\boldsymbol{n}$，因此 $\\boldsymbol{S} = A\\boldsymbol{n}$。$\\boldsymbol{S}$ 和 $\\boldsymbol{d}$ 之间的夹角是 $\\theta$，这也是它们各自的单位向量 $\\boldsymbol{n}$ 和 $\\boldsymbol{e}_d$ 之间的夹角。我们可以在 $\\{\\boldsymbol{e}_d, \\boldsymbol{e}_t\\}$ 基中分解 $\\boldsymbol{n}$（以及 $\\boldsymbol{S}$）。根据构造，$\\boldsymbol{n}$ 和 $\\boldsymbol{e}_d$ 之间的夹角是 $\\theta$，$\\boldsymbol{n}$ 和 $\\boldsymbol{e}_t$ 之间的夹角是 $\\pi/2 - \\theta$。因此：\n$$\n\\boldsymbol{n} = (\\boldsymbol{n} \\cdot \\boldsymbol{e}_d) \\boldsymbol{e}_d + (\\boldsymbol{n} \\cdot \\boldsymbol{e}_t) \\boldsymbol{e}_t = \\cos\\theta \\, \\boldsymbol{e}_d + \\sin\\theta \\, \\boldsymbol{e}_t\n$$\n面积矢量为：\n$$\n\\boldsymbol{S} = A(\\cos\\theta \\, \\boldsymbol{e}_d + \\sin\\theta \\, \\boldsymbol{e}_t)\n$$\n\n离开所属单元的精确面积分扩散通量 $J_{f,exact}$ 由问题中陈述的 Fick 定律给出：\n$$\nJ_{f,exact} = -\\Gamma\\, \\boldsymbol{S}\\cdot \\nabla \\phi\n$$\n代入 $\\boldsymbol{S}$ 和 $\\nabla \\phi$ 的分解表达式：\n$$\nJ_{f,exact} = -\\Gamma \\left[ A(\\cos\\theta \\, \\boldsymbol{e}_d + \\sin\\theta \\, \\boldsymbol{e}_t) \\right] \\cdot \\left[ g_d \\boldsymbol{e}_d + g_t \\boldsymbol{e}_t \\right]\n$$\n利用基向量的标准正交性（$\\boldsymbol{e}_d \\cdot \\boldsymbol{e}_d = 1$，$\\boldsymbol{e}_t \\cdot \\boldsymbol{e}_t = 1$，$\\boldsymbol{e}_d \\cdot \\boldsymbol{e}_t = 0$）：\n$$\nJ_{f,exact} = -\\Gamma A(g_d \\cos\\theta + g_t \\sin\\theta)\n$$\n这是在局部线性标量场假设下扩散通量的精确表达式。\n\n接下来，我们推导通量的正交近似 $J_{f,orth}$。该近似只考虑沿单元中心连线方向的梯度分量，隐式地假设通量仅由该方向的梯度驱动。近似梯度为 $\\nabla \\phi_{orth} = g_d \\boldsymbol{e}_d$。相应的通量为：\n$$\nJ_{f,orth} = -\\Gamma\\, \\boldsymbol{S} \\cdot \\nabla \\phi_{orth} = -\\Gamma \\left[ A(\\cos\\theta \\, \\boldsymbol{e}_d + \\sin\\theta \\, \\boldsymbol{e}_t) \\right] \\cdot \\left[ g_d \\boldsymbol{e}_d \\right]\n$$\n$$\nJ_{f,orth} = -\\Gamma A g_d \\cos\\theta\n$$\n该项通常被称为通量的“正交”或“主要”部分，因为它与 $\\cos\\theta$ 成正比，并在 $\\theta = \\pi/2$（$90^\\circ$）时消失。它表示由沿单元中心连线的梯度分量 $g_d = (\\phi_N - \\phi_P)/d$ 驱动、通过投影面积 $A \\cos\\theta$ 的通量。\n\n非正交修正项 $J_ {f,noc}$ 是精确通量与正交近似之间的差值：\n$$\nJ_{f,noc} = J_{f,exact} - J_{f,orth} = \\left[ -\\Gamma A(g_d \\cos\\theta + g_t \\sin\\theta) \\right] - \\left[ -\\Gamma A g_d \\cos\\theta \\right]\n$$\n$$\nJ_{f,noc} = -\\Gamma A g_t \\sin\\theta\n$$\n该项解释了由梯度分量 $g_t$（横向于单元中心连线）驱动、穿过面的通量。它与 $\\sin\\theta$ 成正比，捕捉了网格的“非正交性”。\n\n在延迟修正方法中，非正交项通常被显式处理，使用上一次迭代或解的状态的值，并且可以使用权重 $\\omega \\in [0, 1]$ 进行欠松弛。求解器中使用的近似通量为：\n$$\nJ_{f,approx} = J_{f,orth} + \\omega J_{f,noc} = -\\Gamma A g_d \\cos\\theta - \\omega \\Gamma A g_t \\sin\\theta\n$$\n\n我们的任务是求两个误差量。第一个是纯正交近似的绝对误差 $E_{orth}$。这是该近似所忽略的通量分量的大小：\n$$\nE_{orth} = |J_{f,exact} - J_{f,orth}| = |J_{f,noc}| = |-\\Gamma A g_t \\sin\\theta| = |\\Gamma A g_t \\sin\\theta|\n$$\n第二个是应用加权延迟非正交修正后的绝对误差 $E_{corr}$：\n$$\nE_{corr} = |J_{f,exact} - J_{f,approx}| = |(J_{f,orth} + J_{f,noc}) - (J_{f,orth} + \\omega J_{f,noc})|\n$$\n$$\nE_{corr} = |(1-\\omega) J_{f,noc}| = |(1-\\omega)(-\\Gamma A g_t \\sin\\theta)| = |(1-\\omega)\\Gamma A g_t \\sin\\theta|\n$$\n值得注意的是，单元中心之间的距离 $d$ 并未出现在最终的误差表达式中，因为所需的梯度分量 $g_d$ 和 $g_t$ 是直接给出的。\n\n每个测试用例的计算将应用这两个最终公式：\n1.  正交近似的绝对误差：$E_{orth} = |\\Gamma A g_t \\sin\\theta|$\n2.  应用加权延迟非正交修正后的绝对误差：$E_{corr} = |(1-\\omega)\\Gamma A g_t \\sin\\theta|$\n\n以度为单位给出的角度 $\\theta$ 必须转换为弧度才能在三角函数 $\\sin\\theta$ 中使用。误差的单位将是 $(\\text{m}^2/\\text{s}) \\cdot (\\text{m}^2) \\cdot (\\text{m}^{-1}) = \\text{m}^3/\\text{s}$，符合要求。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the CFD non-orthogonal diffusion error problem based on the provided test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (Gamma, A, d, theta_deg, g_d, g_t, omega)\n    test_cases = [\n        # Case 1: Orthogonality baseline\n        (1.5e-5, 1.0e-4, 1.0e-4, 0, 1.0e4, 3.0e3, 1.0),\n        # Case 2: Moderate non-orthogonality, full correction\n        (1.5e-5, 1.0e-4, 2.0e-4, 30, 8.0e3, 5.0e3, 1.0),\n        # Case 3: High non-orthogonality, partial correction\n        (1.5e-5, 1.0e-4, 1.0e-4, 75, 1.2e4, -4.0e3, 0.7),\n        # Case 4: Near-degenerate angle, full correction\n        (1.5e-5, 1.0e-4, 8.0e-5, 89, 5.0e3, 1.0e4, 1.0),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        Gamma, A, d, theta_deg, g_d, g_t, omega = case\n\n        # Convert angle from degrees to radians for trigonometric functions\n        theta_rad = np.deg2rad(theta_deg)\n\n        # The core component of the non-orthogonal correction flux\n        # J_f,noc = -Gamma * A * g_t * sin(theta)\n        # The error of the orthogonal approximation is the absolute value of this term.\n        non_ortho_flux_component = Gamma * A * g_t * np.sin(theta_rad)\n\n        # E_orth = |J_f,noc| = |Gamma * A * g_t * sin(theta)|\n        e_orth = np.abs(non_ortho_flux_component)\n        \n        # The error after weighted correction is the absolute value of the un-applied portion\n        # of the non-orthogonal correction flux.\n        # Error = |(1-omega) * J_f,noc|\n        e_corr = np.abs((1.0 - omega) * non_ortho_flux_component)\n\n        results.append(e_orth)\n        results.append(e_corr)\n\n    # Format the final output as a comma-separated list in square brackets.\n    # This format matches: [E^(1)_orth, E^(1)_corr, E^(2)_orth, E^(2)_corr, ...]\n    # The default float-to-string conversion in Python should be sufficient.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}