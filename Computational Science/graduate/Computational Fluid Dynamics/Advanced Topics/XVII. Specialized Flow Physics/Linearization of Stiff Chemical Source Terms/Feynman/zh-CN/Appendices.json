{
    "hands_on_practices": [
        {
            "introduction": "在对一个系统进行线性化之前，我们必须首先明确地定义这个系统。本练习的核心任务是从第一性原理出发，推导出描述化学反应混合物的常微分方程(ODE)系统 $\\frac{dU}{dt} = S(U)$。理解如何从物种守恒和能量守恒定律构建源项向量 $S(U)$，是进行后续所有分析，包括线性化，不可或缺的第一步。",
            "id": "3341250",
            "problem": "考虑一个正在发生化学反应的空间均匀、恒压的理想气体混合物。设有 $N_{s}$ 个化学组分，其组分质量分数为 $Y_{k}$（$k=1,\\dots,N_{s}$），温度为 $T$。热力学压力 $p$ 是恒定的，且混合物遵循理想气体状态方程。记普适气体常数为 $R_{u}$，各组分的分子量为 $W_{k}$。定义混合物的平均分子量为 $W_{\\mathrm{mix}}(Y)=\\left(\\sum_{i=1}^{N_{s}}\\frac{Y_{i}}{W_{i}}\\right)^{-1}$，质量密度为 $\\rho(Y,T)=\\dfrac{p\\,W_{\\mathrm{mix}}(Y)}{R_{u}\\,T}$。在理想气体假设下，各组分的质量焓为 $h_{k}(T)$，混合物的定压比热为 $c_{p}(Y,T)=\\sum_{i=1}^{N_{s}}Y_{i}\\,c_{p,i}(T)$，其中 $c_{p,i}(T)$ 是各组分自身的、随温度变化的函数。\n\n假设有 $N_{r}$ 个基元反应，索引为 $r=1,\\dots,N_{r}$，其正向化学计量系数为 $\\nu_{i,r}^{f}\\ge 0$，逆向（产物）化学计量系数为 $\\nu_{i,r}^{b}\\ge 0$，并定义净化学计量系数为 $\\bar{\\nu}_{i,r}=\\nu_{i,r}^{b}-\\nu_{i,r}^{f}$。正向和逆向反应速率系数 $k_{f,r}(T)$ 和 $k_{r,r}(T)$ 遵循 Arrhenius 型依赖关系，根据质量作用定律，反应 $r$ 的净摩尔反应速率为\n$$\n\\dot{\\omega}_{r}(Y,T)=k_{f,r}(T)\\prod_{i=1}^{N_{s}}C_{i}(Y,T)^{\\nu_{i,r}^{f}}-k_{r,r}(T)\\prod_{i=1}^{N_{s}}C_{i}(Y,T)^{\\nu_{i,r}^{b}},\n$$\n其中 $C_{k}(Y,T)=\\dfrac{\\rho(Y,T)\\,Y_{k}}{W_{k}}$ 是组分 $k$ 的摩尔浓度。\n\n设单位体积的组分质量生成速率为 $\\dot{\\omega}_{k}(Y,T)=W_{k}\\sum_{r=1}^{N_{r}}\\bar{\\nu}_{k,r}\\,\\dot{\\omega}_{r}(Y,T)$，它自动满足 $\\sum_{k=1}^{N_{s}}\\dot{\\omega}_{k}(Y,T)=0$。在一个恒压均匀反应器中，状态向量为 $U=\\big(Y_{1},\\dots,Y_{N_{s}-1},T\\big)$，其中 $Y_{N_{s}}=1-\\sum_{i=1}^{N_{s}-1}Y_{i}$。\n\n从空间均匀、恒压系统的组分守恒和热力学第一定律出发，利用上述理想气体关系式，推导出常微分方程组 $\\dfrac{dU}{dt}=S(U)$ 中的源项向量 $S(U)$。该表达式需用自变量 $Y_{1},\\dots,Y_{N_{s}-1}$ 和 $T$，以及参数 $p$, $R_{u}$, $\\{W_{k}\\}$, $\\{h_{k}(T)\\}$, $\\{c_{p,k}(T)\\}$，和反应机理及速率系数 $\\{\\nu_{i,r}^{f},\\nu_{i,r}^{b},k_{f,r}(T),k_{r,r}(T)\\}$ 显式地写出。你的最终表达式必须通过 $Y_{N_{s}}=1-\\sum_{i=1}^{N_{s}-1}Y_{i}$ 消去 $Y_{N_{s}}$，代之以 $Y_{1},\\dots,Y_{N_{s}-1}$，并且必须通过 $\\rho(Y,T)$、$C_{i}(Y,T)$ 和 $c_{p}(Y,T)$ 显式地展示对 $Y$ 和 $T$ 的依赖关系。\n\n将你的最终答案表示为行向量 $S(U)$ 的单个解析表达式，并按顺序 $(S_{1},\\dots,S_{N_{s}-1},S_{T})$ 列出其分量。无需进行数值计算。",
            "solution": "用户提供了一个在化学动力学和热力学领域定义明确的问题，要求推导描述一个空间均匀、恒压化学反应器的常微分方程组（ODEs）的源项向量。\n\n### 步骤 1：问题验证\n\n**1.1. 提取已知条件：**\n- 状态向量：$U=\\big(Y_{1},\\dots,Y_{N_{s}-1},T\\big)$\n- 非独立的质量分数：$Y_{N_{s}}=1-\\sum_{i=1}^{N_{s}-1}Y_{i}$\n- 系统：空间均匀、恒压 ($p$) 的理想气体混合物。\n- 常数：普适气体常数 $R_{u}$，组分分子量 $W_{k}$。\n- 热力学性质：\n    - 混合物平均分子量：$W_{\\mathrm{mix}}(Y)=\\left(\\sum_{i=1}^{N_{s}}\\frac{Y_{i}}{W_{i}}\\right)^{-1}$\n    - 质量密度：$\\rho(Y,T)=\\dfrac{p\\,W_{\\mathrm{mix}}(Y)}{R_{u}\\,T}$\n    - 组分质量焓：$h_{k}(T)$\n    - 混合物定压比热：$c_{p}(Y,T)=\\sum_{i=1}^{N_{s}}Y_{i}\\,c_{p,i}(T)$\n- 反应动力学：\n    - 化学计量系数：$\\nu_{i,r}^{f}$, $\\nu_{i,r}^{b}$, $\\bar{\\nu}_{i,r}=\\nu_{i,r}^{b}-\\nu_{i,r}^{f}$\n    - 速率系数：$k_{f,r}(T)$, $k_{r,r}(T)$\n    - 摩尔浓度：$C_{k}(Y,T)=\\dfrac{\\rho(Y,T)\\,Y_{k}}{W_{k}}$\n    - 净摩尔反应速率：$\\dot{\\omega}_{r}(Y,T)=k_{f,r}(T)\\prod_{i=1}^{N_{s}}C_{i}(Y,T)^{\\nu_{i,r}^{f}}-k_{r,r}(T)\\prod_{i=1}^{N_{s}}C_{i}(Y,T)^{\\nu_{i,r}^{b}}$\n    - 组分质量生成速率：$\\dot{\\omega}_{k}(Y,T)=W_{k}\\sum_{r=1}^{N_{r}}\\bar{\\nu}_{k,r}\\,\\dot{\\omega}_{r}(Y,T)$\n- 控制方程形式：$\\dfrac{dU}{dt}=S(U)$\n\n**1.2. 使用提取的已知条件进行验证：**\n- **科学基础**：该问题牢固地植根于化学热力学、化学动力学以及守恒定律在燃烧学和化学工程中的应用原理。所有定义和方程都是该领域的标准。\n- **适定性**：该问题是一个标准的推导任务。它要求基于给定的物理定律和定义，得出一个特定的解析表达式，这会导向一个唯一的结果。\n- **客观性**：语言严谨且精确，使用了已确立的科学术语。\n- **缺陷检查表**：该问题没有表现出任何无效性缺陷。它在科学上是合理的、可形式化的、完整的、现实的、适定的、非平凡的，并且可通过标准教科书的推导进行验证。\n\n**1.3. 结论与行动：**\n问题是有效的。将提供一个完整的、有理有据的解法。\n\n### 步骤 2：源项向量 $S(U)$ 的推导\n\n问题要求推导常微分方程组 $\\frac{dU}{dt}=S(U)$ 的源向量 $S(U)$ 的分量，其中 $U=\\big(Y_{1},\\dots,Y_{N_{s}-1},T\\big)$。这涉及到求解 $k=1,\\dots,N_{s}-1$ 时的 $\\frac{dY_k}{dt}$ 以及 $\\frac{dT}{dt}$ 的表达式。\n\n**2.1. 组分守恒方程**\n\n对于一个空间均匀的系统，我们考虑一个控制质量（Lagrangian 描述）。组分 $k$ 的质量分数 $Y_k$ 的变化率由其单位体积的净质量生成速率 $\\dot{\\omega}_k$ 除以局部质量密度 $\\rho$ 决定。组分 $k$ 的守恒方程为：\n$$\n\\frac{dY_k}{dt} = \\frac{\\dot{\\omega}_k(Y, T)}{\\rho(Y, T)}\n$$\n此方程对所有组分 $k=1, \\dots, N_s$ 均有效。由于状态向量 $U$ 包含前 $N_s-1$ 个质量分数作为自变量，我们对这些组分使用此方程。源向量 $S(U)$ 的前 $N_s-1$ 个分量（记为 $S_k$，$k=1, \\dots, N_s-1$）可直接由以下公式给出：\n$$\nS_k(U) = \\frac{dY_k}{dt} = \\frac{\\dot{\\omega}_k(Y, T)}{\\rho(Y, T)}\n$$\n函数 $\\dot{\\omega}_k(Y, T)$ 和 $\\rho(Y, T)$ 依赖于完整的质量分数向量 $Y=(Y_1, \\dots, Y_{N_s})$ 和温度 $T$。根据问题规定，非独立的质量分数 $Y_{N_s}$ 应使用约束条件 $Y_{N_s} = 1 - \\sum_{i=1}^{N_s-1} Y_i$ 来计算。\n\n**2.2. 能量守恒方程**\n\n源向量的最后一个分量是关于温度的，$S_T = \\frac{dT}{dt}$。我们从热力学第一定律推导它。对于一个恒压、无外部热传递（绝热）且除了压力-体积功外不做其他功的封闭均匀系统，混合物的比焓 $h$ 是守恒的。\n混合物比焓是各组分比焓的质量加权和：\n$$\nh(Y, T) = \\sum_{i=1}^{N_s} Y_i h_i(T)\n$$\n焓守恒意味着其全时间导数为零：\n$$\n\\frac{dh}{dt} = 0\n$$\n应用微分的乘法法则：\n$$\n\\frac{d}{dt} \\left( \\sum_{i=1}^{N_s} Y_i h_i(T) \\right) = \\sum_{i=1}^{N_s} \\left( \\frac{dY_i}{dt} h_i(T) + Y_i \\frac{dh_i(T)}{dt} \\right) = 0\n$$\n根据热力学，组分 $i$ 的定压比热定义为 $c_{p,i}(T) = \\frac{dh_i(T)}{dT}$。使用链式法则，我们可以写出 $\\frac{dh_i(T)}{dt} = \\frac{dh_i(T)}{dT} \\frac{dT}{dt} = c_{p,i}(T) \\frac{dT}{dt}$。将此式和组分守恒方程 $\\frac{dY_i}{dt} = \\frac{\\dot{\\omega}_i}{\\rho}$ 代入焓守恒方程：\n$$\n\\sum_{i=1}^{N_s} \\left( \\frac{\\dot{\\omega}_i(Y, T)}{\\rho(Y, T)} h_i(T) \\right) + \\sum_{i=1}^{N_s} \\left( Y_i c_{p,i}(T) \\frac{dT}{dt} \\right) = 0\n$$\n提取公因式：\n$$\n\\frac{1}{\\rho(Y, T)} \\sum_{i=1}^{N_s} \\dot{\\omega}_i(Y, T) h_i(T) + \\left( \\sum_{i=1}^{N_s} Y_i c_{p,i}(T) \\right) \\frac{dT}{dt} = 0\n$$\n括号中的项是问题中定义的混合物平均定压比热 $c_p(Y, T)$。该方程简化为：\n$$\n\\frac{1}{\\rho(Y, T)} \\sum_{i=1}^{N_s} \\dot{\\omega}_i(Y, T) h_i(T) + c_p(Y, T) \\frac{dT}{dt} = 0\n$$\n求解 $\\frac{dT}{dt}$ 得到温度源项 $S_T(U)$：\n$$\nS_T(U) = \\frac{dT}{dt} = - \\frac{1}{\\rho(Y, T) c_p(Y, T)} \\sum_{i=1}^{N_s} \\dot{\\omega}_i(Y, T) h_i(T)\n$$\n这个表达式通过函数 $\\rho(Y,T)$、$c_p(Y,T)$ 和组分生成速率 $\\dot{\\omega}_i(Y,T)$ 依赖于状态变量，其中 $Y_{N_s}$ 由其他质量分数隐式地确定。\n\n**2.3. 组装源向量**\n\n源向量 $S(U)$ 由 $N_s-1$ 个组分源项和单个温度源项组成。它是一个长度为 $N_s$ 的行向量，分量为 $(S_1, \\dots, S_{N_s-1}, S_T)$。\n$$\nS(U) = \\left( \\frac{\\dot{\\omega}_1}{\\rho}, \\dots, \\frac{\\dot{\\omega}_{N_s-1}}{\\rho}, -\\frac{\\sum_{i=1}^{N_s} \\dot{\\omega}_i h_i}{\\rho c_p} \\right)\n$$\n为简洁起见，此处省略了每一项对 $(Y, T)$ 的依赖关系。在此表达式中，$Y$ 表示完整的质量分数向量 $(Y_1, \\dots, Y_{N_s})$，其中 $k=1, \\dots, N_s-1$ 的 $Y_k$ 是来自 $U$ 的自变量，并且 $Y_{N_s} = 1 - \\sum_{k=1}^{N_s-1} Y_k$。所有其他项，如 $\\rho$、$c_p$、$\\dot{\\omega}_k$，都使用问题陈述中提供的定义进行计算。推导出的向量 $S(U)$ 就是该常微分方程组所需的源项。",
            "answer": "$$\n\\boxed{ \\left( \\frac{\\dot{\\omega}_{1}(Y, T)}{\\rho(Y, T)}, \\dots, \\frac{\\dot{\\omega}_{N_{s}-1}(Y, T)}{\\rho(Y, T)}, -\\frac{\\sum_{i=1}^{N_{s}} \\dot{\\omega}_{i}(Y, T) h_{i}(T)}{\\rho(Y, T) c_{p}(Y, T)} \\right) }\n$$"
        },
        {
            "introduction": "线性化的核心是计算雅可比矩阵 $J = \\frac{\\partial S}{\\partial U}$。本练习将深入探讨计算该矩阵中一个关键但复杂的元素——物种生成速率对温度的偏导数 $\\frac{\\partial \\dot{\\omega}_k}{\\partial T}$ 的具体方法。通过这个过程，你将学会如何严谨地运用链式法则，以计及所有温度依赖性来源，包括阿伦尼乌斯速率常数和理想气体定律所决定的摩尔浓度。",
            "id": "3341240",
            "problem": "考虑在恒定压力 $p$ 下，一个发生化学反应的理想气体混合物中的单一可逆基元反应 $r$，以物种 $m \\in \\{1,2,\\dots,N\\}$ 表示为\n$$\n\\sum_{m=1}^{N} \\nu_{m,r}^{'} X_m \\;\\;\\rightleftharpoons\\;\\; \\sum_{m=1}^{N} \\nu_{m,r}^{''} X_m,\n$$\n其中 $X_m$ 表示物种 $m$，$\\nu_{m,r}^{'}$ 和 $\\nu_{m,r}^{''}$ 分别是正向（反应物侧）和逆向（产物侧）的化学计量系数。令 $\\dot{\\omega}_{k}$ 为物种 $k$ 因反应 $r$ 产生的净质量生成速率，根据标准的质量作用定律定义为\n$$\n\\dot{\\omega}_{k}(T,\\{C_m\\}) \\;=\\; W_{k} \\left( \\nu_{k,r}^{''} - \\nu_{k,r}^{'} \\right) \\left[ R_{r}^{+}(T,\\{C_m\\}) - R_{r}^{-}(T,\\{C_m\\}) \\right],\n$$\n其中 $W_{k}$ 是物种 $k$ 的分子量，$C_m$ 是物种 $m$ 的摩尔浓度，正向和逆向反应进程速率为\n$$\nR_{r}^{+}(T,\\{C_m\\}) \\;=\\; k_{r}^{+}(T)\\,\\prod_{m=1}^{N} C_{m}^{\\nu_{m,r}^{'}}, \n\\qquad\nR_{r}^{-}(T,\\{C_m\\}) \\;=\\; k_{r}^{-}(T)\\,\\prod_{m=1}^{N} C_{m}^{\\nu_{m,r}^{''}}.\n$$\n假设每个速率系数遵循阿伦尼乌斯形式，\n$$\nk_{r}^{\\pm}(T) \\;=\\; A_{r}^{\\pm}\\,T^{\\beta_{r}^{\\pm}}\\,\\exp\\!\\left( -\\frac{E_{r}^{\\pm}}{R_{u} T} \\right),\n$$\n其中 $A_{r}^{\\pm}$ 是指前因子，$\\beta_{r}^{\\pm}$ 是温度指数，$E_{r}^{\\pm}$ 是活化能，$R_{u}$ 是普适气体常数。该混合物是恒定压力 $p$ 下的理想气体，因此对于每个物种 $m$，其摩尔浓度满足 $C_{m} = X_{m}\\,p/(R_{u} T)$，其中 $X_{m}$ 是物种 $m$ 的摩尔分数。考虑在固定压力下温度的微小扰动，此时组分局部冻结，即在该扰动范围内，$X_{m}$ 被视为与 $T$ 无关。在此假设下，$C_m$ 对 $T$ 的依赖性源于理想气体定律。混合物的定压比热 $c_{p}(T)$ 可能随温度变化，但在组分冻结和理想气体行为的条件下，它不改变 $C_m(T)$；它只影响源项导数之外的能量耦合。\n\n从这些定义和假设出发，推导偏导数 $\\partial \\dot{\\omega}_{k}/\\partial T$ 的闭式解析表达式，该表达式应一致地包含：\n- 阿伦尼乌斯速率系数的温度依赖性 $\\partial k_{r}^{\\pm}/\\partial T$ 的贡献，以及\n- 在恒定压力下，通过理想气体定律和冻结组分得到的摩尔浓度的温度依赖性 $\\partial C_{m}/\\partial T$ 的贡献。\n\n最终答案应仅用 $W_{k}$、$\\nu_{m,r}^{'}$、$\\nu_{m,r}^{''}$、$R_{r}^{+}$、$R_{r}^{-}$、$A_{r}^{\\pm}$、$\\beta_{r}^{\\pm}$、$E_{r}^{\\pm}$、$R_{u}$、$T$ 以及化学计量系数集 $\\{\\nu_{m,r}^{'}\\}_{m}$ 和 $\\{\\nu_{m,r}^{''}\\}_{m}$ 表示。将 $\\partial \\dot{\\omega}_{k}/\\partial T$ 的最终表达式表述为单个闭式解析表达式。无需进行数值计算，最终方框内的答案不应包含单位。",
            "solution": "该问题被认为是有效的，因为它在科学上基于化学动力学和热力学原理，问题阐述清晰，目标明确，信息充分，并以精确、客观的语言表述。其中没有矛盾、歧义或事实错误。因此，我们可以进行推导。\n\n目标是在恒定压力 $p$ 和组分冻结的条件下，推导物种 $k$ 的净质量生成速率 $\\dot{\\omega}_{k}$ 对温度 $T$ 的偏导数的解析表达式。推导的起点是给定的 $\\dot{\\omega}_{k}$ 的定义：\n$$\n\\dot{\\omega}_{k}(T,\\{C_m\\}) \\;=\\; W_{k} \\left( \\nu_{k,r}^{''} - \\nu_{k,r}^{'} \\right) \\left[ R_{r}^{+}(T,\\{C_m\\}) - R_{r}^{-}(T,\\{C_m\\}) \\right]\n$$\n在这里，对于给定的物种 $k$ 和反应 $r$，分子量 $W_{k}$ 和化学计量系数 $\\nu_{k,r}^{'}$、$\\nu_{k,r}^{''}$ 均为常数。对温度 $T$ 求偏导，我们得到：\n$$\n\\frac{\\partial \\dot{\\omega}_{k}}{\\partial T} \\;=\\; W_{k} \\left( \\nu_{k,r}^{''} - \\nu_{k,r}^{'} \\right) \\left[ \\frac{\\partial R_{r}^{+}}{\\partial T} - \\frac{\\partial R_{r}^{-}}{\\partial T} \\right]\n$$\n推导的核心是求出 $\\partial R_{r}^{+}/\\partial T$ 和 $\\partial R_{r}^{-}/\\partial T$ 的表达式。我们考虑一个通用的反应进程速率 $R$，它可以代表 $R_{r}^{+}$ 或 $R_{r}^{-}$：\n$$\nR(T) \\;=\\; k(T) \\prod_{m=1}^{N} C_{m}(T)^{\\nu_m}\n$$\n其中 $\\nu_m$ 代表正向或逆向反应的化学计量系数集。由于此表达式是乘积形式，采用对数微分法是有利的。取 $R(T)$ 的自然对数：\n$$\n\\ln(R) \\;=\\; \\ln(k) + \\ln\\left( \\prod_{m=1}^{N} C_{m}^{\\nu_m} \\right) \\;=\\; \\ln(k) + \\sum_{m=1}^{N} \\nu_m \\ln(C_m)\n$$\n将此表达式对 $T$ 微分，得到：\n$$\n\\frac{1}{R} \\frac{\\partial R}{\\partial T} \\;=\\; \\frac{1}{k} \\frac{\\partial k}{\\partial T} + \\sum_{m=1}^{N} \\nu_m \\frac{1}{C_m} \\frac{\\partial C_m}{\\partial T}\n$$\n整理以求解 $\\frac{\\partial R}{\\partial T}$：\n$$\n\\frac{\\partial R}{\\partial T} \\;=\\; R \\left( \\frac{1}{k} \\frac{\\partial k}{\\partial T} + \\sum_{m=1}^{N} \\nu_m \\frac{1}{C_m} \\frac{\\partial C_m}{\\partial T} \\right)\n$$\n此表达式将问题分为两部分：求速率系数 $k(T)$ 的对数导数，以及求摩尔浓度 $C_m(T)$ 的对数导数。\n\n首先，我们处理速率系数项 $\\frac{1}{k} \\frac{\\partial k}{\\partial T}$。速率系数 $k(T)$ 由阿伦尼乌斯形式给出：\n$$\nk(T) \\;=\\; A\\,T^{\\beta}\\,\\exp\\!\\left( -\\frac{E}{R_{u} T} \\right)\n$$\n其中 $A$、$\\beta$、$E$ 和 $R_u$ 是常数。取自然对数：\n$$\n\\ln(k) \\;=\\; \\ln(A) + \\beta \\ln(T) - \\frac{E}{R_{u} T}\n$$\n对 $T$ 微分：\n$$\n\\frac{1}{k} \\frac{\\partial k}{\\partial T} \\;=\\; 0 + \\frac{\\beta}{T} - \\frac{E}{R_{u}} \\left( -\\frac{1}{T^{2}} \\right) \\;=\\; \\frac{\\beta}{T} + \\frac{E}{R_{u} T^{2}}\n$$\n这个结果对于任何阿伦尼乌斯类型的速率系数都是通用的。\n\n其次，我们处理浓度项 $\\frac{1}{C_m} \\frac{\\partial C_m}{\\partial T}$。摩尔浓度 $C_m$ 由恒定压力 $p$ 和冻结摩尔分数 $X_m$ 下的理想气体定律确定：\n$$\nC_{m}(T) \\;=\\; X_{m}\\frac{p}{R_{u} T}\n$$\n由于对于此偏导数，$X_m$、$p$ 和 $R_u$ 保持不变，我们可以将 $C_m$ 对 $T$ 微分：\n$$\n\\frac{\\partial C_m}{\\partial T} \\;=\\; \\frac{\\partial}{\\partial T} \\left( \\frac{X_m p}{R_u} T^{-1} \\right) \\;=\\; \\frac{X_m p}{R_u} (-1) T^{-2} \\;=\\; -\\frac{X_m p}{R_u T^{2}}\n$$\n为了得到对数导数，我们除以 $C_m$：\n$$\n\\frac{1}{C_m} \\frac{\\partial C_m}{\\partial T} \\;=\\; \\frac{-\\frac{X_m p}{R_u T^{2}}}{\\frac{X_m p}{R_u T}} \\;=\\; -\\frac{1}{T}\n$$\n这个简单的结果体现了恒压下温度对气体密度的影响。\n\n现在，我们将这两个中间结果代回到 $\\frac{\\partial R}{\\partial T}$ 的表达式中：\n$$\n\\frac{\\partial R}{\\partial T} \\;=\\; R \\left( \\left(\\frac{\\beta}{T} + \\frac{E}{R_{u} T^{2}}\\right) + \\sum_{m=1}^{N} \\nu_m \\left(-\\frac{1}{T}\\right) \\right)\n$$\n$$\n\\frac{\\partial R}{\\partial T} \\;=\\; R \\left( \\frac{\\beta}{T} + \\frac{E}{R_{u} T^{2}} - \\frac{1}{T} \\sum_{m=1}^{N} \\nu_m \\right)\n$$\n现在我们可以将这个通用公式应用于具体的正向（$+$）和逆向（$-$）反应进程速率。\n\n对于正向反应进程速率 $R_{r}^{+}$，我们使用正向化学计量系数 $\\nu_{m,r}^{'}$ 和正向阿伦尼乌斯参数 $\\beta_{r}^{+}$ 与 $E_{r}^{+}$：\n$$\n\\frac{\\partial R_{r}^{+}}{\\partial T} \\;=\\; R_{r}^{+} \\left( \\frac{\\beta_{r}^{+}}{T} + \\frac{E_{r}^{+}}{R_{u} T^{2}} - \\frac{1}{T} \\sum_{m=1}^{N} \\nu_{m,r}^{'} \\right)\n$$\n对于逆向反应进程速率 $R_{r}^{-}$，我们使用逆向化学计量系数 $\\nu_{m,r}^{''}$ 和逆向阿伦尼乌斯参数 $\\beta_{r}^{-}$ 与 $E_{r}^{-}$：\n$$\n\\frac{\\partial R_{r}^{-}}{\\partial T} \\;=\\; R_{r}^{-} \\left( \\frac{\\beta_{r}^{-}}{T} + \\frac{E_{r}^{-}}{R_{u} T^{2}} - \\frac{1}{T} \\sum_{m=1}^{N} \\nu_{m,r}^{''} \\right)\n$$\n最后，我们将这些表达式代回到 $\\frac{\\partial \\dot{\\omega}_{k}}{\\partial T}$ 的方程中：\n$$\n\\frac{\\partial \\dot{\\omega}_{k}}{\\partial T} \\;=\\; W_{k} \\left( \\nu_{k,r}^{''} - \\nu_{k,r}^{'} \\right) \\left[ R_{r}^{+} \\left( \\frac{\\beta_{r}^{+}}{T} + \\frac{E_{r}^{+}}{R_{u} T^{2}} - \\frac{1}{T} \\sum_{m=1}^{N} \\nu_{m,r}^{'} \\right) - R_{r}^{-} \\left( \\frac{\\beta_{r}^{-}}{T} + \\frac{E_{r}^{-}}{R_{u} T^{2}} - \\frac{1}{T} \\sum_{m=1}^{N} \\nu_{m,r}^{''} \\right) \\right]\n$$\n这就是所求偏导数的闭式解析表达式。为了紧凑地表示它，我们可以提出因子 $1/T$：\n$$\n\\frac{\\partial \\dot{\\omega}_{k}}{\\partial T} \\;=\\; \\frac{W_{k} \\left( \\nu_{k,r}^{''} - \\nu_{k,r}^{'} \\right)}{T} \\left[ R_{r}^{+} \\left( \\beta_{r}^{+} + \\frac{E_{r}^{+}}{R_{u} T} - \\sum_{m=1}^{N} \\nu_{m,r}^{'} \\right) - R_{r}^{-} \\left( \\beta_{r}^{-} + \\frac{E_{r}^{-}}{R_{u} T} - \\sum_{m=1}^{N} \\nu_{m,r}^{''} \\right) \\right]\n$$\n此表达式完全解释了在指定约束条件下，阿伦尼乌斯速率系数和摩尔浓度的温度依赖性。",
            "answer": "$$\n\\boxed{W_{k} \\left( \\nu_{k,r}^{''} - \\nu_{k,r}^{'} \\right) \\left[ R_{r}^{+} \\left( \\frac{\\beta_{r}^{+}}{T} + \\frac{E_{r}^{+}}{R_{u} T^{2}} - \\frac{1}{T} \\sum_{m=1}^{N} \\nu_{m,r}^{'} \\right) - R_{r}^{-} \\left( \\frac{\\beta_{r}^{-}}{T} + \\frac{E_{r}^{-}}{R_{u} T^{2}} - \\frac{1}{T} \\sum_{m=1}^{N} \\nu_{m,r}^{''} \\right) \\right]}\n$$"
        },
        {
            "introduction": "一个解析推导的雅可比矩阵只有在正确时才有用。最后一个练习将理论与实践相结合，要求你推导并数值验证能量方程雅可比矩阵的一个分量。通过将你的解析结果与高精度有限差分近似进行比较，你将掌握一项调试CFD中复杂模型的关键技能，并体会到为何一个完备的物理模型（如此处考虑的温度相关焓）对于精确线性化至关重要。",
            "id": "3341176",
            "problem": "考虑一个空间均匀、密度恒定的反应混合物，其中包含两种物种，记为物种 $\\mathrm{A}$ 和物种 $\\mathrm{B}$，它们经历一个单一的不可逆转换 $\\mathrm{A} \\rightarrow \\mathrm{B}$。设混合物密度为 $\\rho$（单位 $\\mathrm{kg/m^3}$），物种 $\\mathrm{A}$ 的质量分数为 $Y_{\\mathrm{A}}$。体积反应速率由一阶 Arrhenius 定律建模，其中温度为 $T$（单位 $\\mathrm{K}$），指前因子为 $A$（单位 $\\mathrm{s^{-1}}$），活化能为 $E_{\\mathrm{a}}$（单位 $\\mathrm{J/mol}$），普适气体常数为 $R_{\\mathrm{u}}$（单位 $\\mathrm{J/(mol \\cdot K)}$）。用于热能平衡的标量热释放源项被定义为物种显焓 $h_k(T)$（单位 $\\mathrm{J/kg}$，其中 $k \\in \\{\\mathrm{A},\\mathrm{B}\\}$）的函数。其基本定义为：体积能量源等于由化学产物输运的焓的负值：\n$$\nS(T) \\equiv -\\sum_{k \\in \\{\\mathrm{A},\\mathrm{B}\\}} h_k(T)\\,\\dot{\\omega}_k(T,Y_{\\mathrm{A}}),\n$$\n其中 $\\dot{\\omega}_k$ 是物种 $k$ 的单位体积生成速率（单位 $\\mathrm{kg/(m^3 \\cdot s)}$），且有 $\\dot{\\omega}_{\\mathrm{A}}(T,Y_{\\mathrm{A}}) = -\\rho\\,k_f(T)\\,Y_{\\mathrm{A}}$ 和 $\\dot{\\omega}_{\\mathrm{B}}(T,Y_{\\mathrm{A}}) = +\\rho\\,k_f(T)\\,Y_{\\mathrm{A}}$，并且\n$$\nk_f(T) = A \\exp\\!\\left(-\\frac{E_{\\mathrm{a}}}{R_{\\mathrm{u}}\\,T}\\right).\n$$\n假设显焓遵循相对于参考温度 $T_{\\mathrm{ref}}$ 的常规热力学定义：\n$$\nh_k(T) = h_k(T_{\\mathrm{ref}}) + \\int_{T_{\\mathrm{ref}}}^{T} c_{p,k}(\\theta)\\,d\\theta,\n$$\n其中 $c_{p,k}(T)$ 是随温度变化的定压比热（单位 $\\mathrm{J/(kg \\cdot K)}$）。为了数值闭合，采用以下多项式模型\n$$\nc_{p,\\mathrm{A}}(T) = a_{\\mathrm{A}} + b_{\\mathrm{A}}\\,T + c_{\\mathrm{A}}\\,T^2,\\quad\nc_{p,\\mathrm{B}}(T) = a_{\\mathrm{B}} + b_{\\mathrm{B}}\\,T + c_{\\mathrm{B}}\\,T^2,\n$$\n其中 $a_k$、$b_k$、$c_k$ 为常数。链式法则通过 $c_{p,k}(T)$ 将 $S(T)$ 经由 $h_k(T)$ 的温度依赖性联系起来，同时 $S(T)$ 也通过 $k_f(T)$ 依赖于 $T$。\n\n您的任务是：\n- 仅从上述基本定义出发，推导 $k \\in \\{\\mathrm{A},\\mathrm{B}\\}$ 时 $\\dfrac{\\partial S}{\\partial h_k}$ 的表达式，然后利用链式法则和 $\\dfrac{\\partial h_k}{\\partial T} = c_{p,k}(T)$，推导仅通过 $h_k(T)$ 的随温度变化的焓对 $\\dfrac{\\partial S}{\\partial T}$ 的贡献。另外，从 Arrhenius 定律推导 $\\dfrac{d k_f}{d T}$，并确定此路径对 $\\dfrac{\\partial S}{\\partial T}$ 的贡献。将这些贡献组合起来，构建完整的 $\\dfrac{\\partial S}{\\partial T}$。\n- 实现一个程序，在给定条件下计算三个解析推导出的量：1) 一个“朴素”解析导数，它仅包含 $k_f(T)$ 路径，其中 $h_k(T)$ 在计算温度下被视为与温度无关；2) 链式法则解析贡献，它仅包含通过 $c_{p,k}(T)$ 的 $h_k(T)$ 路径；3) 完整的解析导数，即前两个贡献之和。\n- 通过计算 $\\dfrac{\\partial S}{\\partial T}$ 的高精度中心有限差分近似来验证这些解析导数，其中使用对称温度扰动 $\\delta T$（单位 $\\mathrm{K}$）。确认完整的解析导数与有限差分近似值高度吻合，而单独的偏导数则不然。\n\n使用以下参数值和模型，所有单位均为国际单位制 (SI)：\n- 反应和热力学参数：\n  - $\\rho = 1.0$，\n  - $Y_{\\mathrm{A}} = 0.5$，\n  - $A = 1.0 \\times 10^{7}$，\n  - $E_{\\mathrm{a}} = 1.80 \\times 10^{5}$，\n  - $R_{\\mathrm{u}} = 8.314462618$，\n  - $T_{\\mathrm{ref}} = 298.15$，\n  - $h_{\\mathrm{A}}(T_{\\mathrm{ref}}) = 0$，\n  - $h_{\\mathrm{B}}(T_{\\mathrm{ref}}) = -5.0 \\times 10^{6}$。\n- 比热系数：\n  - $a_{\\mathrm{A}} = 1000.0$, $b_{\\mathrm{A}} = 0.1$, $c_{\\mathrm{A}} = -1.0 \\times 10^{-5}$，\n  - $a_{\\mathrm{B}} = 1100.0$, $b_{\\mathrm{B}} = 0.05$, $c_{\\mathrm{B}} = -0.5 \\times 10^{-5}$。\n- 用于有限差分的温度扰动：\n  - $\\delta T = 1.0 \\times 10^{-3}$。\n\n通过对多项式进行解析积分来定义显焓：\n$$\nh_k(T) = h_k(T_{\\mathrm{ref}}) + a_k\\,(T - T_{\\mathrm{ref}}) + \\frac{b_k}{2}\\,(T^2 - T_{\\mathrm{ref}}^2) + \\frac{c_k}{3}\\,(T^3 - T_{\\mathrm{ref}}^3).\n$$\n\n根据上述定义所蕴含的物种源项和焓来构建能量源，并对每个测试温度 $T$ 计算以下各项：\n- $\\dfrac{\\partial S}{\\partial T}$ 的中心有限差分近似：\n$$\n\\left.\\frac{\\partial S}{\\partial T}\\right|_{\\mathrm{FD}} \\approx \\frac{S(T+\\delta T) - S(T-\\delta T)}{2\\,\\delta T}.\n$$\n- 在相同温度 $T$ 下的三个解析量：仅包含 $S$ 通过 $k_f(T)$ 对 $T$ 依赖的“朴素”解析导数，仅包含通过 $c_{p,k}(T)$ 的 $h_k(T)$ 依赖的链式法则解析贡献，以及包含两者的完整解析导数。\n\n对每个测试温度 $T$，计算并报告这三个解析量相对于有限差分参考值的相对误差：\n$$\n\\varepsilon_{\\mathrm{naive}}(T) = \\frac{\\left|\\left.\\frac{\\partial S}{\\partial T}\\right|_{\\mathrm{naive}} - \\left.\\frac{\\partial S}{\\partial T}\\right|_{\\mathrm{FD}}\\right|}{\\max\\!\\left(\\left|\\left.\\frac{\\partial S}{\\partial T}\\right|_{\\mathrm{FD}}\\right|, \\epsilon\\right)},\n$$\n$$\n\\varepsilon_{\\mathrm{chain}}(T) = \\frac{\\left|\\left.\\frac{\\partial S}{\\partial T}\\right|_{\\mathrm{chain}} - \\left.\\frac{\\partial S}{\\partial T}\\right|_{\\mathrm{FD}}\\right|}{\\max\\!\\left(\\left|\\left.\\frac{\\partial S}{\\partial T}\\right|_{\\mathrm{FD}}\\right|, \\epsilon\\right)},\n$$\n$$\n\\varepsilon_{\\mathrm{full}}(T) = \\frac{\\left|\\left.\\frac{\\partial S}{\\partial T}\\right|_{\\mathrm{full}} - \\left.\\frac{\\partial S}{\\partial T}\\right|_{\\mathrm{FD}}\\right|}{\\max\\!\\left(\\left|\\left.\\frac{\\partial S}{\\partial T}\\right|_{\\mathrm{FD}}\\right|, \\epsilon\\right)},\n$$\n其中 $\\epsilon = 1.0 \\times 10^{-300}$ 是一个保护性小参数，以避免除以零。\n\n测试组温度（单位 $\\mathrm{K}$）旨在跨越从点火前到点火后的热状态：\n- $T_1 = 1000.0$，\n- $T_2 = 1400.0$，\n- $T_3 = 1800.0$，\n- $T_4 = 2200.0$。\n\n您的程序应生成单行输出，其中包含一个由方括号括起来的、以逗号分隔的列表，内含 $12$ 个相对误差，其值按以下顺序排列\n$$\n[\\varepsilon_{\\mathrm{naive}}(T_1),\\ \\varepsilon_{\\mathrm{chain}}(T_1),\\ \\varepsilon_{\\mathrm{full}}(T_1),\\ \\varepsilon_{\\mathrm{naive}}(T_2),\\ \\varepsilon_{\\mathrm{chain}}(T_2),\\ \\varepsilon_{\\mathrm{full}}(T_2),\\ \\varepsilon_{\\mathrm{naive}}(T_3),\\ \\varepsilon_{\\mathrm{chain}}(T_3),\\ \\varepsilon_{\\mathrm{full}}(T_3),\\ \\varepsilon_{\\mathrm{naive}}(T_4),\\ \\varepsilon_{\\mathrm{chain}}(T_4),\\ \\varepsilon_{\\mathrm{full}}(T_4)].\n$$\n每个值都必须以科学计数法的十进制浮点数输出，且恰好有 $8$ 位有效数字（例如，$1.2345678\\mathrm{e}{-03}$）。所有报告的量均为无量纲相对误差，因此输出不需要物理单位。程序必须完全自包含，无需任何输入，并且必须遵守所述的执行环境。",
            "solution": "用户提供了一个良构且有科学依据的问题。任务是推导化学能源项的解析雅可比矩阵，实现推导出的表达式，并与有限差分近似值进行比对验证。\n\n解决过程包括两个主要阶段：首先，根据给定的基本原理，解析推导所需的量；其次，进行实现和数值验证。\n\n### 解析推导\n\n体积能量源项 $S(T)$ 定义为：\n$$\nS(T) \\equiv -\\sum_{k \\in \\{\\mathrm{A},\\mathrm{B}\\}} h_k(T)\\,\\dot{\\omega}_k(T,Y_{\\mathrm{A}})\n$$\n物种生成速率由 $\\dot{\\omega}_{\\mathrm{A}}(T,Y_{\\mathrm{A}}) = -\\rho\\,k_f(T)\\,Y_{\\mathrm{A}}$ 和 $\\dot{\\omega}_{\\mathrm{B}}(T,Y_{\\mathrm{A}}) = +\\rho\\,k_f(T)\\,Y_{\\mathrm{A}}$ 给出。将这些代入 $S(T)$ 的定义中：\n$$\nS(T) = - \\left[ h_{\\mathrm{A}}(T) \\cdot (-\\rho\\,k_f(T)\\,Y_{\\mathrm{A}}) + h_{\\mathrm{B}}(T) \\cdot (+\\rho\\,k_f(T)\\,Y_{\\mathrm{A}}) \\right]\n$$\n提取公因式 $\\rho$、$k_f(T)$ 和 $Y_{\\mathrm{A}}$，得到 $S(T)$ 的简化表达式：\n$$\nS(T) = \\rho\\,Y_{\\mathrm{A}}\\,k_f(T)\\,[h_{\\mathrm{A}}(T) - h_{\\mathrm{B}}(T)]\n$$\n此表达式表明，$S(T)$ 是通过两个不同项依赖于温度 $T$ 的函数：Arrhenius 速率常数 $k_f(T)$ 和比焓 $h_k(T)$。为了求出 $S$ 对 $T$ 的全导数，我们应用多元函数的链式法则，将 $S$ 视为函数 $S(T, h_{\\mathrm{A}}(T), h_{\\mathrm{B}}(T))$：\n$$\n\\frac{dS}{dT} = \\frac{\\partial S}{\\partial T} + \\frac{\\partial S}{\\partial h_{\\mathrm{A}}}\\frac{dh_{\\mathrm{A}}}{dT} + \\frac{\\partial S}{\\partial h_{\\mathrm{B}}}\\frac{dh_{\\mathrm{B}}}{dT}\n$$\n项 $\\frac{\\partial S}{\\partial T}$ 表示在保持焓不变的情况下，对 $k_f(T)$ 中显式温度依赖性的导数。另外两项表示通过焓的隐式温度依赖性的导数。\n\n按照问题的要求，我们将分别推导这些贡献。\n\n**1. 来自反应动力学的贡献（“朴素”导数）**\n\n此贡献源于反应速率常数 $k_f(T)$ 的温度敏感性，同时在计算温度 $T$ 下将焓视为常数。这对应于偏导数 $\\frac{\\partial S}{\\partial T}$：\n$$\n\\left.\\frac{\\partial S}{\\partial T}\\right|_{\\mathrm{naive}} = \\frac{\\partial}{\\partial T} \\left( \\rho\\,Y_{\\mathrm{A}}\\,k_f(T)\\,[h_{\\mathrm{A}} - h_{\\mathrm{B}}] \\right) = \\rho\\,Y_{\\mathrm{A}}\\,[h_{\\mathrm{A}}(T) - h_{\\mathrm{B}}(T)]\\,\\frac{d k_f}{d T}\n$$\nArrhenius 速率常数 $k_f(T) = A \\exp(-E_{\\mathrm{a}}/(R_{\\mathrm{u}}T))$ 的导数为：\n$$\n\\frac{d k_f}{d T} = A \\exp\\left(-\\frac{E_{\\mathrm{a}}}{R_{\\mathrm{u}}T}\\right) \\cdot \\frac{d}{dT}\\left(-\\frac{E_{\\mathrm{a}}}{R_{\\mathrm{u}}T}\\right) = k_f(T)\\,\\frac{E_{\\mathrm{a}}}{R_{\\mathrm{u}}T^2}\n$$\n将其代回，我们得到朴素导数：\n$$\n\\left.\\frac{\\partial S}{\\partial T}\\right|_{\\mathrm{naive}} = \\rho\\,Y_{\\mathrm{A}}\\,k_f(T)\\,[h_{\\mathrm{A}}(T) - h_{\\mathrm{B}}(T)]\\,\\left(\\frac{E_{\\mathrm{a}}}{R_{\\mathrm{u}}T^2}\\right) = S(T)\\,\\frac{E_{\\mathrm{a}}}{R_{\\mathrm{u}}T^2}\n$$\n\n**2. 来自焓变的贡献（“链式法则”导数）**\n\n此贡献源于物种焓 $h_k(T)$ 的温度敏感性。根据链式法则，此贡献为 $\\sum_k \\frac{\\partial S}{\\partial h_k}\\frac{dh_k}{dT}$。\n首先，我们求出 $S$ 对各焓 $h_k$ 的偏导数：\n$$\n\\frac{\\partial S}{\\partial h_{\\mathrm{A}}} = \\frac{\\partial}{\\partial h_{\\mathrm{A}}} \\left( \\rho\\,Y_{\\mathrm{A}}\\,k_f(T)\\,[h_{\\mathrm{A}} - h_{\\mathrm{B}}] \\right) = \\rho\\,Y_{\\mathrm{A}}\\,k_f(T) = -\\dot{\\omega}_{\\mathrm{B}}\n$$\n$$\n\\frac{\\partial S}{\\partial h_{\\mathrm{B}}} = \\frac{\\partial}{\\partial h_{\\mathrm{B}}} \\left( \\rho\\,Y_{\\mathrm{A}}\\,k_f(T)\\,[h_{\\mathrm{A}} - h_{\\mathrm{B}}] \\right) = -\\rho\\,Y_{\\mathrm{A}}\\,k_f(T) = -\\dot{\\omega}_{\\mathrm{A}}\n$$\n根据热力学，比焓随温度的变化即为定压比热，$\\frac{dh_k}{dT} = c_{p,k}(T)$。\n因此，链式法则的贡献为：\n$$\n\\left.\\frac{\\partial S}{\\partial T}\\right|_{\\mathrm{chain}} = \\frac{\\partial S}{\\partial h_{\\mathrm{A}}}\\frac{dh_{\\mathrm{A}}}{dT} + \\frac{\\partial S}{\\partial h_{\\mathrm{B}}}\\frac{dh_{\\mathrm{B}}}{dT} = (\\rho\\,Y_{\\mathrm{A}}\\,k_f(T))\\,c_{p,\\mathrm{A}}(T) + (-\\rho\\,Y_{\\mathrm{A}}\\,k_f(T))\\,c_{p,\\mathrm{B}}(T)\n$$\n提取公因式可得：\n$$\n\\left.\\frac{\\partial S}{\\partial T}\\right|_{\\mathrm{chain}} = \\rho\\,Y_{\\mathrm{A}}\\,k_f(T)\\,[c_{p,\\mathrm{A}}(T) - c_{p,\\mathrm{B}}(T)]\n$$\n\n**3. 完整解析导数**\n\n全导数 $\\frac{dS}{dT}$ 是这两个贡献之和。注意，这恰好是对 $S(T) = \\rho\\,Y_{\\mathrm{A}}\\,k_f(T)\\,(h_{\\mathrm{A}}(T)-h_{\\mathrm{B}}(T))$ 应用乘积法则所得到的结果：\n$$\n\\left.\\frac{\\partial S}{\\partial T}\\right|_{\\mathrm{full}} = \\frac{dS}{dT} = \\left.\\frac{\\partial S}{\\partial T}\\right|_{\\mathrm{naive}} + \\left.\\frac{\\partial S}{\\partial T}\\right|_{\\mathrm{chain}}\n$$\n$$\n\\left.\\frac{\\partial S}{\\partial T}\\right|_{\\mathrm{full}} = \\rho\\,Y_{\\mathrm{A}} \\left( \\frac{d k_f}{d T}\\,[h_{\\mathrm{A}}(T) - h_{\\mathrm{B}}(T)] + k_f(T)\\,[c_{p,\\mathrm{A}}(T) - c_{p,\\mathrm{B}}(T)] \\right)\n$$\n\n### 数值实现与验证\n\n任务的数值部分涉及实现这些推导出的表达式并对其进行验证。\n\n**要实现的函数：**\n1.  Arrhenius 速率常数 $k_f(T) = A \\exp(-E_{\\mathrm{a}}/(R_{\\mathrm{u}}T))$ 的函数。\n2.  比热 $c_{p,k}(T) = a_k + b_k T + c_k T^2$ 的函数。\n3.  基于所提供的积分多项式形式的比焓 $h_k(T)$ 的函数：\n    $$\n    h_k(T) = h_k(T_{\\mathrm{ref}}) + a_k\\,(T - T_{\\mathrm{ref}}) + \\frac{b_k}{2}\\,(T^2 - T_{\\mathrm{ref}}^2) + \\frac{c_k}{3}\\,(T^3 - T_{\\mathrm{ref}}^3)\n    $$\n4.  使用简化形式 $S(T) = \\rho\\,Y_{\\mathrm{A}}\\,k_f(T)\\,[h_{\\mathrm{A}}(T) - h_{\\mathrm{B}}(T)]$ 的能量源项 $S(T)$ 的函数。\n\n**验证流程：**\n对每个测试温度 $T \\in \\{1000, 1400, 1800, 2200\\}$，执行以下步骤：\n1.  **有限差分近似：** 使用二阶中心差分公式和小扰动 $\\delta T = 1.0 \\times 10^{-3}\\,\\mathrm{K}$，计算导数的高精度参考值：\n    $$\n    \\left.\\frac{\\partial S}{\\partial T}\\right|_{\\mathrm{FD}} \\approx \\frac{S(T+\\delta T) - S(T-\\delta T)}{2\\,\\delta T}\n    $$\n2.  **解析导数：** 在温度 $T$ 下计算三个推导出的量：$\\left.\\frac{\\partial S}{\\partial T}\\right|_{\\mathrm{naive}}$、$\\left.\\frac{\\partial S}{\\partial T}\\right|_{\\mathrm{chain}}$ 和 $\\left.\\frac{\\partial S}{\\partial T}\\right|_{\\mathrm{full}}$。\n3.  **相对误差计算：** 使用以下公式计算每个解析导数相对于有限差分近似值的相对误差：\n    $$\n    \\varepsilon = \\frac{\\left|\\left.\\frac{\\partial S}{\\partial T}\\right|_{\\mathrm{analytic}} - \\left.\\frac{\\partial S}{\\partial T}\\right|_{\\mathrm{FD}}\\right|}{\\max\\!\\left(\\left|\\left.\\frac{\\partial S}{\\partial T}\\right|_{\\mathrm{FD}}\\right|, \\epsilon\\right)}\n    $$\n    其中 $\\epsilon = 1.0 \\times 10^{-300}$ 是一个防止除以零的小数。\n\n最终程序将对所有测试用例执行此流程，并以指定格式打印得到的 $12$ 个相对误差。预期 $\\varepsilon_{\\mathrm{full}}$ 将接近机器精度，从而证明完整解析导数的正确性；而 $\\varepsilon_{\\mathrm{naive}}$ 和 $\\varepsilon_{\\mathrm{chain}}$ 将显著更大，证实它们是全导数的不完整表示。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives, implements, and validates the Jacobian of a chemical energy source term.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [1000.0, 1400.0, 1800.0, 2200.0]\n\n    # Reaction and thermodynamic parameters (SI units)\n    rho = 1.0\n    Y_A = 0.5\n    A = 1.0e7\n    Ea = 1.80e5\n    Ru = 8.314462618\n    T_ref = 298.15\n    h_A_ref = 0.0\n    h_B_ref = -5.0e6\n\n    # Specific heat coefficients\n    # (a_k, b_k, c_k)\n    cp_A_coeffs = (1000.0, 0.1, -1.0e-5)\n    cp_B_coeffs = (1100.0, 0.05, -0.5e-5)\n\n    # Finite difference perturbation\n    delta_T = 1.0e-3\n    \n    # Safeguard for error calculation\n    epsilon = 1.0e-300\n\n    # Helper functions for thermodynamic and kinetic properties\n    def k_f(T):\n        \"\"\"Calculates the Arrhenius rate constant kf(T).\"\"\"\n        if T == 0:\n            return 0.0\n        return A * np.exp(-Ea / (Ru * T))\n\n    def c_p(T, coeffs):\n        \"\"\"Calculates the specific heat cp(T) from polynomial coefficients.\"\"\"\n        a, b, c = coeffs\n        return a + b * T + c * T**2\n\n    def h(T, h_ref, T_ref, coeffs):\n        \"\"\"Calculates the specific enthalpy h(T) by integrating cp(T).\"\"\"\n        a, b, c = coeffs\n        h_val = (h_ref +\n                 a * (T - T_ref) +\n                 (b / 2.0) * (T**2 - T_ref**2) +\n                 (c / 3.0) * (T**3 - T_ref**3))\n        return h_val\n\n    def S_source(T):\n        \"\"\"Calculates the volumetric energy source term S(T).\"\"\"\n        kf_T = k_f(T)\n        h_A_T = h(T, h_A_ref, T_ref, cp_A_coeffs)\n        h_B_T = h(T, h_B_ref, T_ref, cp_B_coeffs)\n        # S(T) = rho * Y_A * k_f(T) * (h_A(T) - h_B(T))\n        return rho * Y_A * kf_T * (h_A_T - h_B_T)\n\n    # Main logic to calculate the errors for each test case.\n    results = []\n    for T in test_cases:\n        # 1. Compute finite-difference approximation of dS/dT\n        S_plus = S_source(T + delta_T)\n        S_minus = S_source(T - delta_T)\n        dS_dT_fd = (S_plus - S_minus) / (2.0 * delta_T)\n\n        # 2. Compute analytical derivatives at T\n        # Intermediate values needed for the derivatives\n        kf_T = k_f(T)\n        h_A_T = h(T, h_A_ref, T_ref, cp_A_coeffs)\n        h_B_T = h(T, h_B_ref, T_ref, cp_B_coeffs)\n        cp_A_T = c_p(T, cp_A_coeffs)\n        cp_B_T = c_p(T, cp_B_coeffs)\n\n        # Naïve derivative (contribution from k_f(T) variation)\n        dkf_dT = kf_T * (Ea / (Ru * T**2))\n        dS_dT_naive = rho * Y_A * dkf_dT * (h_A_T - h_B_T)\n        \n        # Chain-rule derivative (contribution from h_k(T) variation)\n        d_delta_h_dT = cp_A_T - cp_B_T\n        dS_dT_chain = rho * Y_A * kf_T * d_delta_h_dT\n\n        # Full analytical derivative\n        dS_dT_full = dS_dT_naive + dS_dT_chain\n\n        # 3. Compute relative errors\n        denominator = max(abs(dS_dT_fd), epsilon)\n        \n        err_naive = abs(dS_dT_naive - dS_dT_fd) / denominator\n        err_chain = abs(dS_dT_chain - dS_dT_fd) / denominator\n        err_full = abs(dS_dT_full - dS_dT_fd) / denominator\n        \n        results.extend([err_naive, err_chain, err_full])\n\n    # Final print statement in the exact required format.\n    # The format \"{:.7e}\" produces a mantissa with 1 digit before the decimal\n    # and 7 after, for a total of 8 significant digits, matching the example.\n    formatted_results = [f\"{val:.7e}\" for val in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}