{
    "hands_on_practices": [
        {
            "introduction": "Before we can linearize a system, we must first define it. This foundational exercise  walks through the derivation of the governing ordinary differential equations (ODEs) for a homogeneous, constant-pressure reactor from the principles of mass and energy conservation. Correctly formulating the source term vector $S(U)$ in the system $\\dfrac{dU}{dt} = S(U)$ is the essential first step for any subsequent analysis, including the construction of its Jacobian for implicit time integration.",
            "id": "3341250",
            "problem": "Consider a spatially homogeneous, constant-pressure ideal-gas mixture undergoing chemical reactions. Let there be $N_{s}$ chemical species with species mass fractions $Y_{k}$ for $k=1,\\dots,N_{s}$ and temperature $T$. The thermodynamic pressure $p$ is constant, and the mixture obeys the ideal-gas equation of state. Denote the universal gas constant by $R_{u}$ and the species molecular weights by $W_{k}$. Define the mixture-averaged molecular weight by $W_{\\mathrm{mix}}(Y)=\\left(\\sum_{i=1}^{N_{s}}\\frac{Y_{i}}{W_{i}}\\right)^{-1}$ and the mass density by $\\rho(Y,T)=\\dfrac{p\\,W_{\\mathrm{mix}}(Y)}{R_{u}\\,T}$. Under the ideal-gas assumption, the species mass enthalpies are $h_{k}(T)$ and the mixture specific heat at constant pressure is $c_{p}(Y,T)=\\sum_{i=1}^{N_{s}}Y_{i}\\,c_{p,i}(T)$, where $c_{p,i}(T)$ are species-specific functions of temperature.\n\nAssume $N_{r}$ elementary reactions indexed by $r=1,\\dots,N_{r}$ with forward stoichiometric coefficients $\\nu_{i,r}^{f}\\ge 0$ and backward (product) stoichiometric coefficients $\\nu_{i,r}^{b}\\ge 0$, and define the net stoichiometric coefficient $\\bar{\\nu}_{i,r}=\\nu_{i,r}^{b}-\\nu_{i,r}^{f}$. The forward and reverse rate coefficients follow Arrhenius-type dependence, $k_{f,r}(T)$ and $k_{r,r}(T)$, and the law of mass action gives the net molar progress rate of reaction $r$ as\n$$\n\\dot{\\omega}_{r}(Y,T)=k_{f,r}(T)\\prod_{i=1}^{N_{s}}C_{i}(Y,T)^{\\nu_{i,r}^{f}}-k_{r,r}(T)\\prod_{i=1}^{N_{s}}C_{i}(Y,T)^{\\nu_{i,r}^{b}},\n$$\nwhere $C_{k}(Y,T)=\\dfrac{\\rho(Y,T)\\,Y_{k}}{W_{k}}$ is the molar concentration of species $k$.\n\nLet the species mass production rates per unit volume be $\\dot{\\omega}_{k}(Y,T)=W_{k}\\sum_{r=1}^{N_{r}}\\bar{\\nu}_{k,r}\\,\\dot{\\omega}_{r}(Y,T)$, which automatically satisfy $\\sum_{k=1}^{N_{s}}\\dot{\\omega}_{k}(Y,T)=0$. In a constant-pressure homogeneous reactor, the state vector is $U=\\big(Y_{1},\\dots,Y_{N_{s}-1},T\\big)$, with $Y_{N_{s}}=1-\\sum_{i=1}^{N_{s}-1}Y_{i}$.\n\nStarting from conservation of species and the first law of thermodynamics for a spatially homogeneous, constant-pressure system, and using the ideal-gas relations given above, derive the source term vector $S(U)$ in the ordinary differential equation system $\\dfrac{dU}{dt}=S(U)$, written explicitly in terms of the independent variables $Y_{1},\\dots,Y_{N_{s}-1}$ and $T$, together with parameters $p$, $R_{u}$, $\\{W_{k}\\}$, $\\{h_{k}(T)\\}$, $\\{c_{p,k}(T)\\}$, and the reaction mechanism and rate coefficients $\\{\\nu_{i,r}^{f},\\nu_{i,r}^{b},k_{f,r}(T),k_{r,r}(T)\\}$. Your final expression must eliminate $Y_{N_{s}}$ in favor of $Y_{1},\\dots,Y_{N_{s}-1}$ via $Y_{N_{s}}=1-\\sum_{i=1}^{N_{s}-1}Y_{i}$ and must explicitly show the dependence on $Y$ and $T$ through $\\rho(Y,T)$, $C_{i}(Y,T)$, and $c_{p}(Y,T)$.\n\nExpress your final answer as a single analytical expression for the row vector $S(U)$ listing the components $(S_{1},\\dots,S_{N_{s}-1},S_{T})$ in that order. No numerical evaluation is required.",
            "solution": "The user has provided a well-defined problem in chemical kinetics and thermodynamics, asking for the derivation of the source term vector for a system of ordinary differential equations (ODEs) describing a spatially homogeneous, constant-pressure chemical reactor.\n\n### Step 1: Problem Validation\n\n**1.1. Extract Givens:**\n- State vector: $U=\\big(Y_{1},\\dots,Y_{N_{s}-1},T\\big)$\n- Dependent mass fraction: $Y_{N_{s}}=1-\\sum_{i=1}^{N_{s}-1}Y_{i}$\n- System: Spatially homogeneous, constant-pressure ($p$) ideal-gas mixture.\n- Constants: Universal gas constant $R_{u}$, species molecular weights $W_{k}$.\n- Thermodynamic properties:\n    - Mixture-averaged molecular weight: $W_{\\mathrm{mix}}(Y)=\\left(\\sum_{i=1}^{N_{s}}\\frac{Y_{i}}{W_{i}}\\right)^{-1}$\n    - Mass density: $\\rho(Y,T)=\\dfrac{p\\,W_{\\mathrm{mix}}(Y)}{R_{u}\\,T}$\n    - Species mass enthalpies: $h_{k}(T)$\n    - Mixture specific heat at constant pressure: $c_{p}(Y,T)=\\sum_{i=1}^{N_{s}}Y_{i}\\,c_{p,i}(T)$\n- Reaction kinetics:\n    - Stoichiometric coefficients: $\\nu_{i,r}^{f}$, $\\nu_{i,r}^{b}$, $\\bar{\\nu}_{i,r}=\\nu_{i,r}^{b}-\\nu_{i,r}^{f}$\n    - Rate coefficients: $k_{f,r}(T)$, $k_{r,r}(T)$\n    - Molar concentration: $C_{k}(Y,T)=\\dfrac{\\rho(Y,T)\\,Y_{k}}{W_{k}}$\n    - Net molar progress rate: $\\dot{\\omega}_{r}(Y,T)=k_{f,r}(T)\\prod_{i=1}^{N_{s}}C_{i}(Y,T)^{\\nu_{i,r}^{f}}-k_{r,r}(T)\\prod_{i=1}^{N_{s}}C_{i}(Y,T)^{\\nu_{i,r}^{b}}$\n    - Species mass production rate: $\\dot{\\omega}_{k}(Y,T)=W_{k}\\sum_{r=1}^{N_{r}}\\bar{\\nu}_{k,r}\\,\\dot{\\omega}_{r}(Y,T)$\n- Governing equation form: $\\dfrac{dU}{dt}=S(U)$\n\n**1.2. Validate Using Extracted Givens:**\n- **Scientific Groundedness**: The problem is firmly rooted in the principles of chemical thermodynamics, chemical kinetics, and conservation laws as applied in combustion and chemical engineering. All definitions and equations are standard in the field.\n- **Well-Posedness**: The problem is a standard derivation task. It asks for a specific analytical expression based on given physical laws and definitions, which leads to a unique result.\n- **Objectivity**: The language is formal and precise, using established scientific terminology.\n- **Flaw Checklist**: The problem exhibits none of the invalidity flaws. It is scientifically sound, formalizable, complete, realistic, well-posed, non-trivial, and verifiable through standard textbook derivations.\n\n**1.3. Verdict and Action:**\nThe problem is valid. A complete, reasoned solution will be provided.\n\n### Step 2: Derivation of the Source Term Vector $S(U)$\n\nThe problem requires deriving the components of the source vector $S(U)$ for the ODE system $\\frac{dU}{dt}=S(U)$, where $U=\\big(Y_{1},\\dots,Y_{N_{s}-1},T\\big)$. This involves finding expressions for $\\frac{dY_k}{dt}$ for $k=1,\\dots,N_{s}-1$ and for $\\frac{dT}{dt}$.\n\n**2.1. Species Conservation Equations**\n\nFor a spatially homogeneous system, we consider a control mass (Lagrangian description). The rate of change of the mass fraction $Y_k$ of species $k$ is determined by its net mass production rate per unit volume, $\\dot{\\omega}_k$, divided by the local mass density, $\\rho$. The conservation equation for species $k$ is:\n$$\n\\frac{dY_k}{dt} = \\frac{\\dot{\\omega}_k(Y, T)}{\\rho(Y, T)}\n$$\nThis equation is valid for all species $k=1, \\dots, N_s$. Since the state vector $U$ contains the first $N_s-1$ mass fractions as independent variables, we use this equation for these species. The first $N_s-1$ components of the source vector $S(U)$, denoted by $S_k$ for $k=1, \\dots, N_s-1$, are directly given by:\n$$\nS_k(U) = \\frac{dY_k}{dt} = \\frac{\\dot{\\omega}_k(Y, T)}{\\rho(Y, T)}\n$$\nThe functions $\\dot{\\omega}_k(Y, T)$ and $\\rho(Y, T)$ depend on the full mass fraction vector $Y=(Y_1, \\dots, Y_{N_s})$ and the temperature $T$. As prescribed by the problem, the dependent mass fraction $Y_{N_s}$ is to be calculated using the constraint $Y_{N_s} = 1 - \\sum_{i=1}^{N_s-1} Y_i$.\n\n**2.2. Energy Conservation Equation**\n\nThe final component of the source vector is for the temperature, $S_T = \\frac{dT}{dt}$. We derive this from the first law of thermodynamics. For a closed, homogeneous system at constant pressure with no external heat transfer (adiabatic) and no work other than pressure-volume work, the specific enthalpy of the mixture, $h$, is conserved.\nThe mixture specific enthalpy is a mass-weighted sum of the species specific enthalpies:\n$$\nh(Y, T) = \\sum_{i=1}^{N_s} Y_i h_i(T)\n$$\nThe conservation of enthalpy implies that its total time derivative is zero:\n$$\n\\frac{dh}{dt} = 0\n$$\nApplying the product rule for differentiation:\n$$\n\\frac{d}{dt} \\left( \\sum_{i=1}^{N_s} Y_i h_i(T) \\right) = \\sum_{i=1}^{N_s} \\left( \\frac{dY_i}{dt} h_i(T) + Y_i \\frac{dh_i(T)}{dt} \\right) = 0\n$$\nFrom thermodynamics, the specific heat at constant pressure for species $i$ is defined as $c_{p,i}(T) = \\frac{dh_i(T)}{dT}$. Using the chain rule, we can write $\\frac{dh_i(T)}{dt} = \\frac{dh_i(T)}{dT} \\frac{dT}{dt} = c_{p,i}(T) \\frac{dT}{dt}$. Substituting this and the species conservation equation, $\\frac{dY_i}{dt} = \\frac{\\dot{\\omega}_i}{\\rho}$, into the enthalpy conservation equation:\n$$\n\\sum_{i=1}^{N_s} \\left( \\frac{\\dot{\\omega}_i(Y, T)}{\\rho(Y, T)} h_i(T) \\right) + \\sum_{i=1}^{N_s} \\left( Y_i c_{p,i}(T) \\frac{dT}{dt} \\right) = 0\n$$\nFactoring out common terms:\n$$\n\\frac{1}{\\rho(Y, T)} \\sum_{i=1}^{N_s} \\dot{\\omega}_i(Y, T) h_i(T) + \\left( \\sum_{i=1}^{N_s} Y_i c_{p,i}(T) \\right) \\frac{dT}{dt} = 0\n$$\nThe term in the parenthesis is the mixture-averaged specific heat at constant pressure, $c_p(Y, T)$, as defined in the problem. The equation simplifies to:\n$$\n\\frac{1}{\\rho(Y, T)} \\sum_{i=1}^{N_s} \\dot{\\omega}_i(Y, T) h_i(T) + c_p(Y, T) \\frac{dT}{dt} = 0\n$$\nSolving for $\\frac{dT}{dt}$ yields the temperature source term, $S_T(U)$:\n$$\nS_T(U) = \\frac{dT}{dt} = - \\frac{1}{\\rho(Y, T) c_p(Y, T)} \\sum_{i=1}^{N_s} \\dot{\\omega}_i(Y, T) h_i(T)\n$$\nThis expression depends on the state variables through the functions $\\rho(Y,T)$, $c_p(Y,T)$, and the species production rates $\\dot{\\omega}_i(Y,T)$, with $Y_{N_s}$ being implicitly determined by the other mass fractions.\n\n**2.3. Assembling the Source Vector**\n\nThe source vector $S(U)$ consists of the $N_s-1$ species source terms and the single temperature source term. It is a row vector of length $N_s$ with components $(S_1, \\dots, S_{N_s-1}, S_T)$.\n$$\nS(U) = \\left( \\frac{\\dot{\\omega}_1}{\\rho}, \\dots, \\frac{\\dot{\\omega}_{N_s-1}}{\\rho}, -\\frac{\\sum_{i=1}^{N_s} \\dot{\\omega}_i h_i}{\\rho c_p} \\right)\n$$\nwhere the dependence of each term on $(Y, T)$ is implied for conciseness. In this expression, $Y$ denotes the full vector of mass fractions $(Y_1, \\dots, Y_{N_s})$, where $Y_k$ for $k=1, \\dots, N_s-1$ are the independent variables from $U$, and $Y_{N_s} = 1 - \\sum_{k=1}^{N_s-1} Y_k$. All other terms, such as $\\rho$, $c_p$, $\\dot{\\omega}_k$, are evaluated using their definitions provided in the problem statement. The derived vector $S(U)$ is the required source term for the ODE system.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{\\dot{\\omega}_{1}(Y, T)}{\\rho(Y, T)}  \\cdots  \\frac{\\dot{\\omega}_{N_{s}-1}(Y, T)}{\\rho(Y, T)}  - \\frac{\\sum_{i=1}^{N_{s}} \\dot{\\omega}_{i}(Y, T) h_{i}(T)}{\\rho(Y, T) c_{p}(Y, T)} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "The heart of linearization lies in the accurate construction of the Jacobian matrix, $J = \\frac{\\partial S}{\\partial U}$. This practice  hones this skill by focusing on a critical and often subtle component: the derivative of a species production rate, $\\dot{\\omega}_k$, with respect to temperature. Successfully completing this derivation requires careful application of the chain rule to account for the temperature dependence of both the Arrhenius rate constants and the species molar concentrations under the ideal gas law, a detail crucial for robust solvers.",
            "id": "3341240",
            "problem": "Consider a single reversible elementary reaction $r$ in a chemically reacting ideal-gas mixture at constant pressure $p$, written in terms of species $m \\in \\{1,2,\\dots,N\\}$ as\n$$\n\\sum_{m=1}^{N} \\nu_{m,r}^{'} X_m \\;\\;\\rightleftharpoons\\;\\; \\sum_{m=1}^{N} \\nu_{m,r}^{''} X_m,\n$$\nwhere $X_m$ denotes species $m$, and $\\nu_{m,r}^{'}$ and $\\nu_{m,r}^{''}$ are the forward (reactant-side) and reverse (product-side) stoichiometric coefficients, respectively. Let $\\dot{\\omega}_{k}$ be the net mass production rate of species $k$ due to reaction $r$, defined by the standard mass-action law as\n$$\n\\dot{\\omega}_{k}(T,\\{C_m\\}) \\;=\\; W_{k} \\left( \\nu_{k,r}^{''} - \\nu_{k,r}^{'} \\right) \\left[ R_{r}^{+}(T,\\{C_m\\}) - R_{r}^{-}(T,\\{C_m\\}) \\right],\n$$\nwhere $W_{k}$ is the molecular weight of species $k$, $C_m$ is the molar concentration of species $m$, and the forward and reverse progress rates are\n$$\nR_{r}^{+}(T,\\{C_m\\}) \\;=\\; k_{r}^{+}(T)\\,\\prod_{m=1}^{N} C_{m}^{\\nu_{m,r}^{'}}, \n\\qquad\nR_{r}^{-}(T,\\{C_m\\}) \\;=\\; k_{r}^{-}(T)\\,\\prod_{m=1}^{N} C_{m}^{\\nu_{m,r}^{''}}.\n$$\nAssume that each rate coefficient follows an Arrhenius form,\n$$\nk_{r}^{\\pm}(T) \\;=\\; A_{r}^{\\pm}\\,T^{\\beta_{r}^{\\pm}}\\,\\exp\\!\\left( -\\frac{E_{r}^{\\pm}}{R_{u} T} \\right),\n$$\nwith pre-exponential factor $A_{r}^{\\pm}$, temperature exponent $\\beta_{r}^{\\pm}$, activation energy $E_{r}^{\\pm}$, and universal gas constant $R_{u}$. The mixture is an ideal gas at constant pressure $p$, so that for each species $m$ the molar concentration satisfies $C_{m} = X_{m}\\,p/(R_{u} T)$, where $X_{m}$ is the mole fraction of species $m$. Consider a small perturbation in temperature at fixed pressure for which the composition is locally frozen, i.e., $X_{m}$ is treated as independent of $T$ over the perturbation. Under this assumption, the dependence of $C_m$ on $T$ arises from the ideal-gas law. The mixture specific heat at constant pressure $c_{p}(T)$ may vary with temperature, but it does not alter $C_m(T)$ under frozen composition and ideal-gas behavior; it only affects the energy coupling outside the source-term derivative.\n\nStarting from these definitions and assumptions, derive the closed-form analytic expression for the partial derivative $\\partial \\dot{\\omega}_{k}/\\partial T$ that consistently includes:\n- the contribution from the temperature dependence of the Arrhenius rate coefficients $\\partial k_{r}^{\\pm}/\\partial T$, and\n- the contribution from the temperature dependence of the molar concentrations $\\partial C_{m}/\\partial T$ at constant pressure via the ideal-gas law with frozen composition.\n\nExpress your final answer solely in terms of $W_{k}$, $\\nu_{m,r}^{'}$, $\\nu_{m,r}^{''}$, $R_{r}^{+}$, $R_{r}^{-}$, $A_{r}^{\\pm}$, $\\beta_{r}^{\\pm}$, $E_{r}^{\\pm}$, $R_{u}$, $T$, and the stoichiometric sets $\\{\\nu_{m,r}^{'}\\}_{m}$ and $\\{\\nu_{m,r}^{''}\\}_{m}$. State the final expression for $\\partial \\dot{\\omega}_{k}/\\partial T$ as a single closed-form analytic expression. No numerical evaluation is required, and no units should be included in the final boxed answer.",
            "solution": "The problem is deemed valid as it is scientifically grounded in the principles of chemical kinetics and thermodynamics, is well-posed with a clear objective and sufficient information, and is expressed in precise, objective language. There are no contradictions, ambiguities, or factual inaccuracies. We may therefore proceed with the derivation.\n\nThe objective is to derive the analytical expression for the partial derivative of the net mass production rate of species $k$, $\\dot{\\omega}_{k}$, with respect to temperature, $T$, at constant pressure, $p$, and frozen composition. The starting point is the given definition for $\\dot{\\omega}_{k}$:\n$$\n\\dot{\\omega}_{k}(T,\\{C_m\\}) \\;=\\; W_{k} \\left( \\nu_{k,r}^{''} - \\nu_{k,r}^{'} \\right) \\left[ R_{r}^{+}(T,\\{C_m\\}) - R_{r}^{-}(T,\\{C_m\\}) \\right]\n$$\nHere, the molecular weight $W_{k}$ and the stoichiometric coefficients $\\nu_{k,r}^{'}$ and $\\nu_{k,r}^{''}$ are constants for a given species $k$ and reaction $r$. Applying the partial derivative with respect to temperature, $T$, we find:\n$$\n\\frac{\\partial \\dot{\\omega}_{k}}{\\partial T} \\;=\\; W_{k} \\left( \\nu_{k,r}^{''} - \\nu_{k,r}^{'} \\right) \\left[ \\frac{\\partial R_{r}^{+}}{\\partial T} - \\frac{\\partial R_{r}^{-}}{\\partial T} \\right]\n$$\nThe core of the derivation is to find the expressions for $\\partial R_{r}^{+}/\\partial T$ and $\\partial R_{r}^{-}/\\partial T$. Let us consider a generic reaction progress rate, $R$, which can represent either $R_{r}^{+}$ or $R_{r}^{-}$:\n$$\nR(T) \\;=\\; k(T) \\prod_{m=1}^{N} C_{m}(T)^{\\nu_m}\n$$\nwhere $\\nu_m$ represents the set of stoichiometric coefficients for either the forward or reverse reaction. Due to the product form of this expression, it is advantageous to employ logarithmic differentiation. Taking the natural logarithm of $R(T)$:\n$$\n\\ln(R) \\;=\\; \\ln(k) + \\ln\\left( \\prod_{m=1}^{N} C_{m}^{\\nu_m} \\right) \\;=\\; \\ln(k) + \\sum_{m=1}^{N} \\nu_m \\ln(C_m)\n$$\nDifferentiating this expression with respect to $T$ yields:\n$$\n\\frac{1}{R} \\frac{\\partial R}{\\partial T} \\;=\\; \\frac{1}{k} \\frac{\\partial k}{\\partial T} + \\sum_{m=1}^{N} \\nu_m \\frac{1}{C_m} \\frac{\\partial C_m}{\\partial T}\n$$\nRearranging to solve for $\\frac{\\partial R}{\\partial T}$:\n$$\n\\frac{\\partial R}{\\partial T} \\;=\\; R \\left( \\frac{1}{k} \\frac{\\partial k}{\\partial T} + \\sum_{m=1}^{N} \\nu_m \\frac{1}{C_m} \\frac{\\partial C_m}{\\partial T} \\right)\n$$\nThis expression separates the problem into two parts: finding the logarithmic derivative of the rate coefficient $k(T)$, and finding the logarithmic derivative of the molar concentrations $C_m(T)$.\n\nFirst, we address the rate coefficient term, $\\frac{1}{k} \\frac{\\partial k}{\\partial T}$. The rate coefficient $k(T)$ is given by the Arrhenius form:\n$$\nk(T) \\;=\\; A\\,T^{\\beta}\\,\\exp\\!\\left( -\\frac{E}{R_{u} T} \\right)\n$$\nwhere $A$, $\\beta$, $E$, and $R_u$ are constants. Taking the natural logarithm:\n$$\n\\ln(k) \\;=\\; \\ln(A) + \\beta \\ln(T) - \\frac{E}{R_{u} T}\n$$\nDifferentiating with respect to $T$:\n$$\n\\frac{1}{k} \\frac{\\partial k}{\\partial T} \\;=\\; 0 + \\frac{\\beta}{T} - \\frac{E}{R_{u}} \\left( -\\frac{1}{T^{2}} \\right) \\;=\\; \\frac{\\beta}{T} + \\frac{E}{R_{u} T^{2}}\n$$\nThis result is general for any Arrhenius-type rate coefficient.\n\nSecond, we address the concentration term, $\\frac{1}{C_m} \\frac{\\partial C_m}{\\partial T}$. The molar concentration $C_m$ is determined by the ideal-gas law at constant pressure $p$ and frozen mole fractions $X_m$:\n$$\nC_{m}(T) \\;=\\; X_{m}\\frac{p}{R_{u} T}\n$$\nSince $X_m$, $p$, and $R_u$ are held constant for this partial derivative, we can differentiate $C_m$ with respect to $T$:\n$$\n\\frac{\\partial C_m}{\\partial T} \\;=\\; \\frac{\\partial}{\\partial T} \\left( \\frac{X_m p}{R_u} T^{-1} \\right) \\;=\\; \\frac{X_m p}{R_u} (-1) T^{-2} \\;=\\; -\\frac{X_m p}{R_u T^{2}}\n$$\nTo obtain the logarithmic derivative, we divide by $C_m$:\n$$\n\\frac{1}{C_m} \\frac{\\partial C_m}{\\partial T} \\;=\\; \\frac{-\\frac{X_m p}{R_u T^{2}}}{\\frac{X_m p}{R_u T}} \\;=\\; -\\frac{1}{T}\n$$\nThis simple result captures the effect of temperature on gas density at constant pressure.\n\nNow, we substitute these two intermediate results back into the expression for $\\frac{\\partial R}{\\partial T}$:\n$$\n\\frac{\\partial R}{\\partial T} \\;=\\; R \\left( \\left(\\frac{\\beta}{T} + \\frac{E}{R_{u} T^{2}}\\right) + \\sum_{m=1}^{N} \\nu_m \\left(-\\frac{1}{T}\\right) \\right)\n$$\n$$\n\\frac{\\partial R}{\\partial T} \\;=\\; R \\left( \\frac{\\beta}{T} + \\frac{E}{R_{u} T^{2}} - \\frac{1}{T} \\sum_{m=1}^{N} \\nu_m \\right)\n$$\nWe can now apply this general formula to the specific forward ($+$) and reverse ($-$) progress rates.\n\nFor the forward progress rate, $R_{r}^{+}$, we use the forward stoichiometric coefficients $\\nu_{m,r}^{'}$ and the forward Arrhenius parameters $\\beta_{r}^{+}$ and $E_{r}^{+}$:\n$$\n\\frac{\\partial R_{r}^{+}}{\\partial T} \\;=\\; R_{r}^{+} \\left( \\frac{\\beta_{r}^{+}}{T} + \\frac{E_{r}^{+}}{R_{u} T^{2}} - \\frac{1}{T} \\sum_{m=1}^{N} \\nu_{m,r}^{'} \\right)\n$$\nFor the reverse progress rate, $R_{r}^{-}$, we use the reverse stoichiometric coefficients $\\nu_{m,r}^{''}$ and the reverse Arrhenius parameters $\\beta_{r}^{-}$ and $E_{r}^{-}$:\n$$\n\\frac{\\partial R_{r}^{-}}{\\partial T} \\;=\\; R_{r}^{-} \\left( \\frac{\\beta_{r}^{-}}{T} + \\frac{E_{r}^{-}}{R_{u} T^{2}} - \\frac{1}{T} \\sum_{m=1}^{N} \\nu_{m,r}^{''} \\right)\n$$\nFinally, we substitute these expressions back into the equation for $\\frac{\\partial \\dot{\\omega}_{k}}{\\partial T}$:\n$$\n\\frac{\\partial \\dot{\\omega}_{k}}{\\partial T} \\;=\\; W_{k} \\left( \\nu_{k,r}^{''} - \\nu_{k,r}^{'} \\right) \\left[ R_{r}^{+} \\left( \\frac{\\beta_{r}^{+}}{T} + \\frac{E_{r}^{+}}{R_{u} T^{2}} - \\frac{1}{T} \\sum_{m=1}^{N} \\nu_{m,r}^{'} \\right) - R_{r}^{-} \\left( \\frac{\\beta_{r}^{-}}{T} + \\frac{E_{r}^{-}}{R_{u} T^{2}} - \\frac{1}{T} \\sum_{m=1}^{N} \\nu_{m,r}^{''} \\right) \\right]\n$$\nThis is the closed-form analytic expression for the desired partial derivative. To present it compactly, we can factor out the term $1/T$:\n$$\n\\frac{\\partial \\dot{\\omega}_{k}}{\\partial T} \\;=\\; \\frac{W_{k} \\left( \\nu_{k,r}^{''} - \\nu_{k,r}^{'} \\right)}{T} \\left[ R_{r}^{+} \\left( \\beta_{r}^{+} + \\frac{E_{r}^{+}}{R_{u} T} - \\sum_{m=1}^{N} \\nu_{m,r}^{'} \\right) - R_{r}^{-} \\left( \\beta_{r}^{-} + \\frac{E_{r}^{-}}{R_{u} T} - \\sum_{m=1}^{N} \\nu_{m,r}^{''} \\right) \\right]\n$$\nThis expression fully accounts for the temperature dependence of both the Arrhenius rate coefficients and the molar concentrations under the specified constraints.",
            "answer": "$$\n\\boxed{W_{k} \\left( \\nu_{k,r}^{''} - \\nu_{k,r}^{'} \\right) \\left[ R_{r}^{+} \\left( \\frac{\\beta_{r}^{+}}{T} + \\frac{E_{r}^{+}}{R_{u} T^{2}} - \\frac{1}{T} \\sum_{m=1}^{N} \\nu_{m,r}^{'} \\right) - R_{r}^{-} \\left( \\frac{\\beta_{r}^{-}}{T} + \\frac{E_{r}^{-}}{R_{u} T^{2}} - \\frac{1}{T} \\sum_{m=1}^{N} \\nu_{m,r}^{''} \\right) \\right]}\n$$"
        },
        {
            "introduction": "An analytical Jacobian is only as good as its implementation. This final practice  bridges the gap between theory and code by tasking you with the implementation and validation of the energy source term's temperature derivative. By comparing your full analytical expression, which includes the oft-neglected temperature dependence of enthalpies and specific heats, against a numerical finite-difference approximation, you will gain confidence in your derivation and appreciate the practical importance of a complete and correct Jacobian.",
            "id": "3341176",
            "problem": "Consider a spatially homogeneous, constant-density reactive mixture with two species, denoted by species $\\mathrm{A}$ and species $\\mathrm{B}$, undergoing a single irreversible transformation $\\mathrm{A} \\rightarrow \\mathrm{B}$. Let the mixture density be $\\rho$ (in $\\mathrm{kg/m^3}$), and let the mass fraction of species $\\mathrm{A}$ be $Y_{\\mathrm{A}}$. The volumetric reaction rate is modeled by a first-order Arrhenius law with temperature $T$ (in $\\mathrm{K}$), pre-exponential factor $A$ (in $\\mathrm{s^{-1}}$), activation energy $E_{\\mathrm{a}}$ (in $\\mathrm{J/mol}$), and the universal gas constant $R_{\\mathrm{u}}$ (in $\\mathrm{J/(mol \\cdot K)}$). The scalar heat-release source term for the thermal energy balance is defined as a function of the species sensible enthalpies $h_k(T)$ (in $\\mathrm{J/kg}$), where $k \\in \\{\\mathrm{A},\\mathrm{B}\\}$, by the fundamental definition that the volumetric energy source equals the negative of the enthalpy transported by chemical production:\n$$\nS(T) \\equiv -\\sum_{k \\in \\{\\mathrm{A},\\mathrm{B}\\}} h_k(T)\\,\\dot{\\omega}_k(T,Y_{\\mathrm{A}}),\n$$\nwhere $\\dot{\\omega}_k$ is the species production rate per unit volume for species $k$ (in $\\mathrm{kg/(m^3 \\cdot s)}$), with $\\dot{\\omega}_{\\mathrm{A}}(T,Y_{\\mathrm{A}}) = -\\rho\\,k_f(T)\\,Y_{\\mathrm{A}}$ and $\\dot{\\omega}_{\\mathrm{B}}(T,Y_{\\mathrm{A}}) = +\\rho\\,k_f(T)\\,Y_{\\mathrm{A}}$, and where \n$$\nk_f(T) = A \\exp\\!\\left(-\\frac{E_{\\mathrm{a}}}{R_{\\mathrm{u}}\\,T}\\right).\n$$\nAssume sensible enthalpies follow the usual thermodynamic definition relative to a reference temperature $T_{\\mathrm{ref}}$:\n$$\nh_k(T) = h_k(T_{\\mathrm{ref}}) + \\int_{T_{\\mathrm{ref}}}^{T} c_{p,k}(\\theta)\\,d\\theta,\n$$\nwhere $c_{p,k}(T)$ is the temperature-dependent specific heat at constant pressure (in $\\mathrm{J/(kg \\cdot K)}$). For numerical closure, adopt the polynomial models\n$$\nc_{p,\\mathrm{A}}(T) = a_{\\mathrm{A}} + b_{\\mathrm{A}}\\,T + c_{\\mathrm{A}}\\,T^2,\\quad\nc_{p,\\mathrm{B}}(T) = a_{\\mathrm{B}} + b_{\\mathrm{B}}\\,T + c_{\\mathrm{B}}\\,T^2,\n$$\nwith constants $a_k$, $b_k$, $c_k$. The chain rule connects the temperature dependence of $S(T)$ through $h_k(T)$ via $c_{p,k}(T)$, and $S(T)$ also depends on $T$ through $k_f(T)$.\n\nYour tasks are:\n- Starting only from the fundamental definitions provided above, derive an expression for $\\dfrac{\\partial S}{\\partial h_k}$ for $k \\in \\{\\mathrm{A},\\mathrm{B}\\}$, and then, by the chain rule, derive the contribution of temperature-dependent enthalpy to $\\dfrac{\\partial S}{\\partial T}$ exclusively through $h_k(T)$ using $\\dfrac{\\partial h_k}{\\partial T} = c_{p,k}(T)$. Separately, derive $\\dfrac{d k_f}{d T}$ from the Arrhenius law and identify the contribution of this path to $\\dfrac{\\partial S}{\\partial T}$. Combine these to construct the full $\\dfrac{\\partial S}{\\partial T}$.\n- Implement a program that evaluates three analytically derived quantities at given conditions: \n  $1)$ a “naïve” analytic derivative that includes only the $k_f(T)$ pathway with $h_k(T)$ treated as temperature-independent at the evaluation temperature, \n  $2)$ the chain-rule analytic contribution that includes only the $h_k(T)$ pathway through $c_{p,k}(T)$, and \n  $3)$ the full analytic derivative that sums both contributions.\n- Validate these analytic derivatives by computing a high-accuracy central finite-difference approximation of $\\dfrac{\\partial S}{\\partial T}$ using a symmetric temperature perturbation $\\delta T$ (in $\\mathrm{K}$) and confirm that the full analytic derivative agrees with the finite-difference approximation to high accuracy, while the partial derivatives alone do not.\n\nUse the following parameter values and models, all in the International System of Units (SI):\n- Reaction and thermodynamic parameters:\n  - $\\rho = 1.0$,\n  - $Y_{\\mathrm{A}} = 0.5$,\n  - $A = 1.0 \\times 10^{7}$,\n  - $E_{\\mathrm{a}} = 1.80 \\times 10^{5}$,\n  - $R_{\\mathrm{u}} = 8.314462618$,\n  - $T_{\\mathrm{ref}} = 298.15$,\n  - $h_{\\mathrm{A}}(T_{\\mathrm{ref}}) = 0$,\n  - $h_{\\mathrm{B}}(T_{\\mathrm{ref}}) = -5.0 \\times 10^{6}$.\n- Specific heat coefficients:\n  - $a_{\\mathrm{A}} = 1000.0$, $b_{\\mathrm{A}} = 0.1$, $c_{\\mathrm{A}} = -1.0 \\times 10^{-5}$,\n  - $a_{\\mathrm{B}} = 1100.0$, $b_{\\mathrm{B}} = 0.05$, $c_{\\mathrm{B}} = -0.5 \\times 10^{-5}$.\n- Temperature perturbation for finite differences:\n  - $\\delta T = 1.0 \\times 10^{-3}$.\n\nDefine the sensible enthalpies by analytic integration of the polynomials:\n$$\nh_k(T) = h_k(T_{\\mathrm{ref}}) + a_k\\,(T - T_{\\mathrm{ref}}) + \\frac{b_k}{2}\\,(T^2 - T_{\\mathrm{ref}}^2) + \\frac{c_k}{3}\\,(T^3 - T_{\\mathrm{ref}}^3).\n$$\n\nConstruct the energy source from the species source terms and enthalpies implied by the definitions above, and evaluate the following for each test temperature $T$:\n- The central finite-difference approximation of $\\dfrac{\\partial S}{\\partial T}$:\n$$\n\\left.\\frac{\\partial S}{\\partial T}\\right|_{\\mathrm{FD}} \\approx \\frac{S(T+\\delta T) - S(T-\\delta T)}{2\\,\\delta T}.\n$$\n- The three analytic quantities at the same $T$: the “naïve” analytic derivative that includes only the dependence of $S$ on $T$ via $k_f(T)$, the chain-rule analytic contribution that includes only the dependence via $h_k(T)$ through $c_{p,k}(T)$, and the full analytic derivative that includes both.\n\nCompute and report, for each test temperature $T$, the relative errors of these three analytic quantities with respect to the finite-difference reference:\n$$\n\\varepsilon_{\\mathrm{naive}}(T) = \\frac{\\left|\\left.\\frac{\\partial S}{\\partial T}\\right|_{\\mathrm{naive}} - \\left.\\frac{\\partial S}{\\partial T}\\right|_{\\mathrm{FD}}\\right|}{\\max\\!\\left(\\left|\\left.\\frac{\\partial S}{\\partial T}\\right|_{\\mathrm{FD}}\\right|, \\epsilon\\right)},\n$$\n$$\n\\varepsilon_{\\mathrm{chain}}(T) = \\frac{\\left|\\left.\\frac{\\partial S}{\\partial T}\\right|_{\\mathrm{chain}} - \\left.\\frac{\\partial S}{\\partial T}\\right|_{\\mathrm{FD}}\\right|}{\\max\\!\\left(\\left|\\left.\\frac{\\partial S}{\\partial T}\\right|_{\\mathrm{FD}}\\right|, \\epsilon\\right)},\n$$\n$$\n\\varepsilon_{\\mathrm{full}}(T) = \\frac{\\left|\\left.\\frac{\\partial S}{\\partial T}\\right|_{\\mathrm{full}} - \\left.\\frac{\\partial S}{\\partial T}\\right|_{\\mathrm{FD}}\\right|}{\\max\\!\\left(\\left|\\left.\\frac{\\partial S}{\\partial T}\\right|_{\\mathrm{FD}}\\right|, \\epsilon\\right)},\n$$\nwith a safeguarding small parameter $\\epsilon = 1.0 \\times 10^{-300}$ to avoid division by zero.\n\nTest suite temperatures (in $\\mathrm{K}$) designed to span pre-ignition to post-ignition thermal regimes:\n- $T_1 = 1000.0$,\n- $T_2 = 1400.0$,\n- $T_3 = 1800.0$,\n- $T_4 = 2200.0$.\n\nYour program should produce a single line of output containing the $12$ relative errors as a comma-separated list enclosed in square brackets, with values ordered as\n$$\n[\\varepsilon_{\\mathrm{naive}}(T_1),\\ \\varepsilon_{\\mathrm{chain}}(T_1),\\ \\varepsilon_{\\mathrm{full}}(T_1),\\ \\varepsilon_{\\mathrm{naive}}(T_2),\\ \\varepsilon_{\\mathrm{chain}}(T_2),\\ \\varepsilon_{\\mathrm{full}}(T_2),\\ \\varepsilon_{\\mathrm{naive}}(T_3),\\ \\varepsilon_{\\mathrm{chain}}(T_3),\\ \\varepsilon_{\\mathrm{full}}(T_3),\\ \\varepsilon_{\\mathrm{naive}}(T_4),\\ \\varepsilon_{\\mathrm{chain}}(T_4),\\ \\varepsilon_{\\mathrm{full}}(T_4)].\n$$\nEach value must be output as a decimal floating-point number in scientific notation with exactly $8$ significant digits (for example, $1.2345678\\mathrm{e}{-03}$). All reported quantities are dimensionless relative errors, so no physical units are required for the output. The program must be entirely self-contained, require no input, and must adhere to the execution environment described.",
            "solution": "The user has provided a well-posed and scientifically grounded problem. The task is to derive the analytical Jacobian of a chemical energy source term, implement the derived expressions, and validate them against a finite-difference approximation.\n\nThe solution process involves two main stages: first, the analytical derivation of the required quantities from the fundamental principles given, and second, the implementation and numerical verification.\n\n### Analytical Derivation\n\nThe volumetric energy source term, $S(T)$, is defined as:\n$$\nS(T) \\equiv -\\sum_{k \\in \\{\\mathrm{A},\\mathrm{B}\\}} h_k(T)\\,\\dot{\\omega}_k(T,Y_{\\mathrm{A}})\n$$\nThe species production rates are given by $\\dot{\\omega}_{\\mathrm{A}}(T,Y_{\\mathrm{A}}) = -\\rho\\,k_f(T)\\,Y_{\\mathrm{A}}$ and $\\dot{\\omega}_{\\mathrm{B}}(T,Y_{\\mathrm{A}}) = +\\rho\\,k_f(T)\\,Y_{\\mathrm{A}}$. Substituting these into the definition of $S(T)$:\n$$\nS(T) = - \\left[ h_{\\mathrm{A}}(T) \\cdot (-\\rho\\,k_f(T)\\,Y_{\\mathrm{A}}) + h_{\\mathrm{B}}(T) \\cdot (+\\rho\\,k_f(T)\\,Y_{\\mathrm{A}}) \\right]\n$$\nFactoring out the common terms $\\rho$, $k_f(T)$, and $Y_{\\mathrm{A}}$ yields a simplified expression for $S(T)$:\n$$\nS(T) = \\rho\\,Y_{\\mathrm{A}}\\,k_f(T)\\,[h_{\\mathrm{A}}(T) - h_{\\mathrm{B}}(T)]\n$$\nThis expression shows that $S(T)$ is a function of temperature $T$ through two distinct terms: the Arrhenius rate constant, $k_f(T)$, and the specific enthalpies, $h_k(T)$. To find the total derivative of $S$ with respect to $T$, we apply the chain rule for multivariate functions, treating $S$ as a function $S(T, h_{\\mathrm{A}}(T), h_{\\mathrm{B}}(T))$:\n$$\n\\frac{dS}{dT} = \\frac{\\partial S}{\\partial T} + \\frac{\\partial S}{\\partial h_{\\mathrm{A}}}\\frac{dh_{\\mathrm{A}}}{dT} + \\frac{\\partial S}{\\partial h_{\\mathrm{B}}}\\frac{dh_{\\mathrm{B}}}{dT}\n$$\nThe term $\\frac{\\partial S}{\\partial T}$ represents the derivative with respect to the explicit temperature dependence in $k_f(T)$, holding the enthalpies constant. The other two terms represent the derivative with respect to the implicit temperature dependence through the enthalpies.\n\nFollowing the problem's request, we will derive these contributions separately.\n\n**1. Contribution from Reaction Rate Kinetics (The \"Naïve\" Derivative)**\n\nThis contribution arises from the temperature sensitivity of the reaction rate constant, $k_f(T)$, while treating the enthalpies as constant at the evaluation temperature $T$. This corresponds to the partial derivative $\\frac{\\partial S}{\\partial T}$:\n$$\n\\left.\\frac{\\partial S}{\\partial T}\\right|_{\\mathrm{naive}} = \\frac{\\partial}{\\partial T} \\left( \\rho\\,Y_{\\mathrm{A}}\\,k_f(T)\\,[h_{\\mathrm{A}} - h_{\\mathrm{B}}] \\right) = \\rho\\,Y_{\\mathrm{A}}\\,[h_{\\mathrm{A}}(T) - h_{\\mathrm{B}}(T)]\\,\\frac{d k_f}{d T}\n$$\nThe derivative of the Arrhenius rate constant, $k_f(T) = A \\exp(-E_{\\mathrm{a}}/(R_{\\mathrm{u}}T))$, is:\n$$\n\\frac{d k_f}{d T} = A \\exp\\left(-\\frac{E_{\\mathrm{a}}}{R_{\\mathrm{u}}T}\\right) \\cdot \\frac{d}{dT}\\left(-\\frac{E_{\\mathrm{a}}}{R_{\\mathrm{u}}T}\\right) = k_f(T)\\,\\frac{E_{\\mathrm{a}}}{R_{\\mathrm{u}}T^2}\n$$\nSubstituting this back, we get the naïve derivative:\n$$\n\\left.\\frac{\\partial S}{\\partial T}\\right|_{\\mathrm{naive}} = \\rho\\,Y_{\\mathrm{A}}\\,k_f(T)\\,[h_{\\mathrm{A}}(T) - h_{\\mathrm{B}}(T)]\\,\\left(\\frac{E_{\\mathrm{a}}}{R_{\\mathrm{u}}T^2}\\right) = S(T)\\,\\frac{E_{\\mathrm{a}}}{R_{\\mathrm{u}}T^2}\n$$\n\n**2. Contribution from Enthalpy Variation (The \"Chain-Rule\" Derivative)**\n\nThis contribution arises from the temperature sensitivity of the species enthalpies, $h_k(T)$. As per the chain rule, this contribution is $\\sum_k \\frac{\\partial S}{\\partial h_k}\\frac{dh_k}{dT}$.\nFirst, we find the partial derivatives of $S$ with respect to each enthalpy $h_k$:\n$$\n\\frac{\\partial S}{\\partial h_{\\mathrm{A}}} = \\frac{\\partial}{\\partial h_{\\mathrm{A}}} \\left( \\rho\\,Y_{\\mathrm{A}}\\,k_f(T)\\,[h_{\\mathrm{A}} - h_{\\mathrm{B}}] \\right) = \\rho\\,Y_{\\mathrm{A}}\\,k_f(T) = -\\dot{\\omega}_{\\mathrm{B}}\n$$\n$$\n\\frac{\\partial S}{\\partial h_{\\mathrm{B}}} = \\frac{\\partial}{\\partial h_{\\mathrm{B}}} \\left( \\rho\\,Y_{\\mathrm{A}}\\,k_f(T)\\,[h_{\\mathrm{A}} - h_{\\mathrm{B}}] \\right) = -\\rho\\,Y_{\\mathrm{A}}\\,k_f(T) = -\\dot{\\omega}_{\\mathrm{A}}\n$$\nFrom thermodynamics, the change in specific enthalpy with temperature is the specific heat at constant pressure, $\\frac{dh_k}{dT} = c_{p,k}(T)$.\nThe chain-rule contribution is therefore:\n$$\n\\left.\\frac{\\partial S}{\\partial T}\\right|_{\\mathrm{chain}} = \\frac{\\partial S}{\\partial h_{\\mathrm{A}}}\\frac{dh_{\\mathrm{A}}}{dT} + \\frac{\\partial S}{\\partial h_{\\mathrm{B}}}\\frac{dh_{\\mathrm{B}}}{dT} = (\\rho\\,Y_{\\mathrm{A}}\\,k_f(T))\\,c_{p,\\mathrm{A}}(T) + (-\\rho\\,Y_{\\mathrm{A}}\\,k_f(T))\\,c_{p,\\mathrm{B}}(T)\n$$\nFactoring out the common terms gives:\n$$\n\\left.\\frac{\\partial S}{\\partial T}\\right|_{\\mathrm{chain}} = \\rho\\,Y_{\\mathrm{A}}\\,k_f(T)\\,[c_{p,\\mathrm{A}}(T) - c_{p,\\mathrm{B}}(T)]\n$$\n\n**3. The Full Analytic Derivative**\n\nThe full derivative, $\\frac{dS}{dT}$, is the sum of the two contributions. Note that this is precisely what the product rule applied to $S(T) = \\rho\\,Y_{\\mathrm{A}}\\,k_f(T)\\,(h_{\\mathrm{A}}(T)-h_{\\mathrm{B}}(T))$ would yield:\n$$\n\\left.\\frac{\\partial S}{\\partial T}\\right|_{\\mathrm{full}} = \\frac{dS}{dT} = \\left.\\frac{\\partial S}{\\partial T}\\right|_{\\mathrm{naive}} + \\left.\\frac{\\partial S}{\\partial T}\\right|_{\\mathrm{chain}}\n$$\n$$\n\\left.\\frac{\\partial S}{\\partial T}\\right|_{\\mathrm{full}} = \\rho\\,Y_{\\mathrm{A}} \\left( \\frac{d k_f}{d T}\\,[h_{\\mathrm{A}}(T) - h_{\\mathrm{B}}(T)] + k_f(T)\\,[c_{p,\\mathrm{A}}(T) - c_{p,\\mathrm{B}}(T)] \\right)\n$$\n\n### Numerical Implementation and Verification\n\nThe numerical part of the task involves implementing these derived expressions and validating them.\n\n**Functions to Implement:**\n1.  A function for the Arrhenius rate constant $k_f(T) = A \\exp(-E_{\\mathrm{a}}/(R_{\\mathrm{u}}T))$.\n2.  A function for the specific heat $c_{p,k}(T) = a_k + b_k T + c_k T^2$.\n3.  A function for the specific enthalpy $h_k(T)$ based on the provided integrated polynomial form:\n    $$\n    h_k(T) = h_k(T_{\\mathrm{ref}}) + a_k\\,(T - T_{\\mathrm{ref}}) + \\frac{b_k}{2}\\,(T^2 - T_{\\mathrm{ref}}^2) + \\frac{c_k}{3}\\,(T^3 - T_{\\mathrm{ref}}^3)\n    $$\n4.  A function for the energy source term $S(T)$ using the simplified form $S(T) = \\rho\\,Y_{\\mathrm{A}}\\,k_f(T)\\,[h_{\\mathrm{A}}(T) - h_{\\mathrm{B}}(T)]$.\n\n**Verification Procedure:**\nFor each test temperature $T \\in \\{1000, 1400, 1800, 2200\\}$, the following steps are performed:\n1.  **Finite-Difference Approximation:** A high-accuracy reference value for the derivative is computed using a second-order central difference formula with a small perturbation $\\delta T = 1.0 \\times 10^{-3}\\,\\mathrm{K}$:\n    $$\n    \\left.\\frac{\\partial S}{\\partial T}\\right|_{\\mathrm{FD}} \\approx \\frac{S(T+\\delta T) - S(T-\\delta T)}{2\\,\\delta T}\n    $$\n2.  **Analytic Derivatives:** The three derived quantities, $\\left.\\frac{\\partial S}{\\partial T}\\right|_{\\mathrm{naive}}$, $\\left.\\frac{\\partial S}{\\partial T}\\right|_{\\mathrm{chain}}$, and $\\left.\\frac{\\partial S}{\\partial T}\\right|_{\\mathrm{full}}$, are evaluated at the temperature $T$.\n3.  **Relative Error Calculation:** The relative error of each analytic derivative with respect to the finite-difference approximation is calculated using the formula:\n    $$\n    \\varepsilon = \\frac{\\left|\\left.\\frac{\\partial S}{\\partial T}\\right|_{\\mathrm{analytic}} - \\left.\\frac{\\partial S}{\\partial T}\\right|_{\\mathrm{FD}}\\right|}{\\max\\!\\left(\\left|\\left.\\frac{\\partial S}{\\partial T}\\right|_{\\mathrm{FD}}\\right|, \\epsilon\\right)}\n    $$\n    where $\\epsilon = 1.0 \\times 10^{-300}$ is a small number to prevent division by zero.\n\nThe final program will execute this procedure for all test cases and print the resulting $12$ relative errors in the specified format. The expectation is that $\\varepsilon_{\\mathrm{full}}$ will be close to machine precision, demonstrating the correctness of the full analytic derivative, while $\\varepsilon_{\\mathrm{naive}}$ and $\\varepsilon_{\\mathrm{chain}}$ will be significantly larger, confirming that they are incomplete representations of the total derivative.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives, implements, and validates the Jacobian of a chemical energy source term.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [1000.0, 1400.0, 1800.0, 2200.0]\n\n    # Reaction and thermodynamic parameters (SI units)\n    rho = 1.0\n    Y_A = 0.5\n    A = 1.0e7\n    Ea = 1.80e5\n    Ru = 8.314462618\n    T_ref = 298.15\n    h_A_ref = 0.0\n    h_B_ref = -5.0e6\n\n    # Specific heat coefficients\n    # (a_k, b_k, c_k)\n    cp_A_coeffs = (1000.0, 0.1, -1.0e-5)\n    cp_B_coeffs = (1100.0, 0.05, -0.5e-5)\n\n    # Finite difference perturbation\n    delta_T = 1.0e-3\n    \n    # Safeguard for error calculation\n    epsilon = 1.0e-300\n\n    # Helper functions for thermodynamic and kinetic properties\n    def k_f(T):\n        \"\"\"Calculates the Arrhenius rate constant kf(T).\"\"\"\n        if T = 0:\n            return 0.0\n        return A * np.exp(-Ea / (Ru * T))\n\n    def c_p(T, coeffs):\n        \"\"\"Calculates the specific heat cp(T) from polynomial coefficients.\"\"\"\n        a, b, c = coeffs\n        return a + b * T + c * T**2\n\n    def h(T, h_ref, T_ref, coeffs):\n        \"\"\"Calculates the specific enthalpy h(T) by integrating cp(T).\"\"\"\n        a, b, c = coeffs\n        h_val = (h_ref +\n                 a * (T - T_ref) +\n                 (b / 2.0) * (T**2 - T_ref**2) +\n                 (c / 3.0) * (T**3 - T_ref**3))\n        return h_val\n\n    def S_source(T):\n        \"\"\"Calculates the volumetric energy source term S(T).\"\"\"\n        kf_T = k_f(T)\n        h_A_T = h(T, h_A_ref, T_ref, cp_A_coeffs)\n        h_B_T = h(T, h_B_ref, T_ref, cp_B_coeffs)\n        # S(T) = rho * Y_A * k_f(T) * (h_A(T) - h_B(T))\n        return rho * Y_A * kf_T * (h_A_T - h_B_T)\n\n    # Main logic to calculate the errors for each test case.\n    results = []\n    for T in test_cases:\n        # 1. Compute finite-difference approximation of dS/dT\n        S_plus = S_source(T + delta_T)\n        S_minus = S_source(T - delta_T)\n        dS_dT_fd = (S_plus - S_minus) / (2.0 * delta_T)\n\n        # 2. Compute analytical derivatives at T\n        # Intermediate values needed for the derivatives\n        kf_T = k_f(T)\n        h_A_T = h(T, h_A_ref, T_ref, cp_A_coeffs)\n        h_B_T = h(T, h_B_ref, T_ref, cp_B_coeffs)\n        cp_A_T = c_p(T, cp_A_coeffs)\n        cp_B_T = c_p(T, cp_B_coeffs)\n\n        # Naïve derivative (contribution from k_f(T) variation)\n        dkf_dT = kf_T * (Ea / (Ru * T**2))\n        dS_dT_naive = rho * Y_A * dkf_dT * (h_A_T - h_B_T)\n        \n        # Chain-rule derivative (contribution from h_k(T) variation)\n        d_delta_h_dT = cp_A_T - cp_B_T\n        dS_dT_chain = rho * Y_A * kf_T * d_delta_h_dT\n\n        # Full analytical derivative\n        dS_dT_full = dS_dT_naive + dS_dT_chain\n\n        # 3. Compute relative errors\n        denominator = max(abs(dS_dT_fd), epsilon)\n        \n        err_naive = abs(dS_dT_naive - dS_dT_fd) / denominator\n        err_chain = abs(dS_dT_chain - dS_dT_fd) / denominator\n        err_full = abs(dS_dT_full - dS_dT_fd) / denominator\n        \n        results.extend([err_naive, err_chain, err_full])\n\n    # Final print statement in the exact required format.\n    # The format \"{:.7e}\" produces a mantissa with 1 digit before the decimal\n    # and 7 after, for a total of 8 significant digits, matching the example.\n    formatted_results = [f\"{val:.7e}\" for val in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}