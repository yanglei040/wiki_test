{
    "hands_on_practices": [
        {
            "introduction": "在SPH方法中，核函数是其核心，它决定了粒子间的相互作用如何被平滑。为了确保物理量的精确插值和守恒性，核函数必须满足归一性条件，即其在整个支撑域上的积分为1。这个练习将指导你通过第一性原理，为广泛使用的三次样条核函数推导其三维归一化常数，这是掌握SPH理论基础的关键一步 。",
            "id": "3363341",
            "problem": "在用于连续介质流的光滑粒子流体动力学 (SPH) 中，三维 ($3$D) 三次样条核函数由无量纲半径 $q = \\|\\mathbf{r}\\|/h$ 定义为\n$$\nW(\\mathbf{r},h) = C_{3}\\,h^{-3}\\,w(q),\n$$\n其紧支集为 $q \\in [0,2]$，形函数 $w(q)$ 由下式给出\n$$\nw(q) = \n\\begin{cases}\n1 - \\frac{3}{2}q^{2} + \\frac{3}{4}q^{3},  0 \\le q  1, \\\\\n\\frac{1}{4}(2 - q)^{3},  1 \\le q \\le 2, \\\\\n0,  q > 2.\n\\end{cases}\n$$\n此处，$h0$ 是光滑长度，$C_{3}$ 是待定的（无量纲）归一化常数。\n\n仅使用 SPH 的基本要求，即核函数必须满足单位分解 (partition-of-unity) 条件\n$$\n\\int_{\\mathbb{R}^{3}} W(\\mathbf{r},h)\\,d\\mathbf{r} = 1,\n$$\n请从第一性原理推导常数 $C_{3}$ 的闭式解值，并明确证明其与 $h$ 无关。\n\n然后，对于 $h = 1$ 的情况，通过数值积分验证\n$$\n\\int_{\\|\\mathbf{r}\\|\\leq 2h} W(\\mathbf{r},h)\\,d\\mathbf{r} = 1.\n$$\n对于数值验证，利用球对称性将积分简化为关于 $q$ 的一维积分，并分别在 $[0,1]$ 和 $[1,2]$ 上应用 3 点 Gauss–Legendre 法则。在呈现积分检验时，报告的中间数值应至少有 10 位有效数字。\n\n将你的最终答案表示为 $C_{3}$ 的闭式解值（无单位）。最终答案无需四舍五入。",
            "solution": "光滑粒子流体动力学 (SPH) 核函数必须满足归一化（单位分解）条件\n$$\n\\int_{\\mathbb{R}^{3}} W(\\mathbf{r},h)\\,d\\mathbf{r} = 1.\n$$\n我们从给定的核函数形式出发\n$$\nW(\\mathbf{r},h) = C_{3}\\,h^{-3}\\,w(q), \\quad q=\\frac{\\|\\mathbf{r}\\|}{h},\n$$\n其紧支集为 $q \\in [0,2]$。由于 $W$ 是球对称的，我们转换到球坐标系，其中 $d\\mathbf{r} = 4\\pi r^{2}\\,dr$ 且 $r = \\|\\mathbf{r}\\|$。归一化条件变为\n$$\n1 = \\int_{\\mathbb{R}^{3}} W(\\mathbf{r},h)\\,d\\mathbf{r}\n= \\int_{0}^{2h} 4\\pi r^{2}\\, C_{3}\\,h^{-3}\\, w\\!\\left(\\frac{r}{h}\\right)\\,dr.\n$$\n引入变量代换 $q = r/h$，则 $r = h q$，$dr = h\\,dq$，$r^{2} = h^{2} q^{2}$。于是\n$$\n1 = 4\\pi C_{3} h^{-3} \\int_{0}^{2h} r^{2} w\\!\\left(\\frac{r}{h}\\right)\\,dr\n= 4\\pi C_{3} h^{-3} \\int_{0}^{2} \\left(h^{2} q^{2}\\right) w(q)\\, \\left(h\\,dq\\right)\n= 4\\pi C_{3} \\int_{0}^{2} q^{2} w(q)\\,dq.\n$$\n这直接表明 $C_{3}$ 与 $h$ 无关。定义\n$$\nJ \\equiv \\int_{0}^{2} q^{2} w(q)\\,dq,\n$$\n这样归一化条件可写作\n$$\n1 = 4\\pi C_{3} J \\quad \\Rightarrow \\quad C_{3} = \\frac{1}{4\\pi J}.\n$$\n我们现在根据给定的 $w(q)$ 的分段形式计算 $J$：\n$$\nJ = \\int_{0}^{1} q^{2} \\left(1 - \\frac{3}{2}q^{2} + \\frac{3}{4}q^{3}\\right)\\,dq\n+ \\int_{1}^{2} q^{2}\\left[\\frac{1}{4}(2 - q)^{3}\\right]\\,dq.\n$$\n在 $[0,1]$ 上，\n$$\nq^{2} w(q) = q^{2} - \\frac{3}{2} q^{4} + \\frac{3}{4} q^{5},\n$$\n所以\n$$\n\\int_{0}^{1} q^{2} w(q)\\,dq\n= \\int_{0}^{1} q^{2}\\,dq - \\frac{3}{2}\\int_{0}^{1} q^{4}\\,dq + \\frac{3}{4}\\int_{0}^{1} q^{5}\\,dq\n= \\frac{1}{3} - \\frac{3}{2}\\cdot \\frac{1}{5} + \\frac{3}{4}\\cdot \\frac{1}{6}.\n$$\n计算得，\n$$\n\\frac{1}{3} - \\frac{3}{10} + \\frac{1}{8} = \\frac{40}{120} - \\frac{36}{120} + \\frac{15}{120} = \\frac{19}{120}.\n$$\n在 $[1,2]$ 上，展开\n$$\n\\frac{1}{4}(2 - q)^{3} = \\frac{1}{4}\\left(8 - 12q + 6q^{2} - q^{3}\\right)\n= 2 - 3q + \\frac{3}{2}q^{2} - \\frac{1}{4}q^{3},\n$$\n因此\n$$\nq^{2} w(q) = 2 q^{2} - 3 q^{3} + \\frac{3}{2} q^{4} - \\frac{1}{4} q^{5}.\n$$\n所以，\n$$\n\\int_{1}^{2} q^{2} w(q)\\,dq\n= 2\\int_{1}^{2} q^{2}\\,dq - 3\\int_{1}^{2} q^{3}\\,dq + \\frac{3}{2}\\int_{1}^{2} q^{4}\\,dq - \\frac{1}{4}\\int_{1}^{2} q^{5}\\,dq.\n$$\n计算每一项：\n$$\n\\int_{1}^{2} q^{2}\\,dq = \\left.\\frac{q^{3}}{3}\\right|_{1}^{2} = \\frac{8 - 1}{3} = \\frac{7}{3}, \\quad\n\\int_{1}^{2} q^{3}\\,dq = \\left.\\frac{q^{4}}{4}\\right|_{1}^{2} = \\frac{16 - 1}{4} = \\frac{15}{4},\n$$\n$$\n\\int_{1}^{2} q^{4}\\,dq = \\left.\\frac{q^{5}}{5}\\right|_{1}^{2} = \\frac{32 - 1}{5} = \\frac{31}{5}, \\quad\n\\int_{1}^{2} q^{5}\\,dq = \\left.\\frac{q^{6}}{6}\\right|_{1}^{2} = \\frac{64 - 1}{6} = \\frac{63}{6} = \\frac{21}{2}.\n$$\n代入得：\n$$\n\\int_{1}^{2} q^{2} w(q)\\,dq\n= 2\\cdot \\frac{7}{3} - 3\\cdot \\frac{15}{4} + \\frac{3}{2}\\cdot \\frac{31}{5} - \\frac{1}{4}\\cdot \\frac{21}{2}\n= \\frac{14}{3} - \\frac{45}{4} + \\frac{93}{10} - \\frac{21}{8}.\n$$\n取公分母 $120$，\n$$\n\\frac{14}{3} = \\frac{560}{120}, \\quad\n\\frac{45}{4} = \\frac{1350}{120}, \\quad\n\\frac{93}{10} = \\frac{1116}{120}, \\quad\n\\frac{21}{8} = \\frac{315}{120},\n$$\n因此\n$$\n\\int_{1}^{2} q^{2} w(q)\\,dq = \\frac{560 - 1350 + 1116 - 315}{120} = \\frac{11}{120}.\n$$\n总计，\n$$\nJ = \\frac{19}{120} + \\frac{11}{120} = \\frac{30}{120} = \\frac{1}{4}.\n$$\n于是归一化条件 $1 = 4\\pi C_{3} J$ 给出\n$$\n1 = 4\\pi C_{3}\\left(\\frac{1}{4}\\right) = \\pi C_{3} \\quad \\Rightarrow \\quad C_{3} = \\frac{1}{\\pi}.\n$$\n\n我们现在对于 $h = 1$ 的情况通过数值积分来验证\n$$\n\\int_{\\|\\mathbf{r}\\|\\leq 2h} W(\\mathbf{r},h)\\,d\\mathbf{r} = 1.\n$$\n利用球对称性且 $h=1$ 可得\n$$\n\\int_{\\|\\mathbf{r}\\|\\leq 2} W(\\mathbf{r},1)\\,d\\mathbf{r}\n= 4\\pi C_{3} \\int_{0}^{2} q^{2} w(q)\\,dq\n= 4\\pi \\left(\\frac{1}{\\pi}\\right) \\int_{0}^{2} q^{2} w(q)\\,dq\n= 4 \\int_{0}^{2} q^{2} w(q)\\,dq.\n$$\n我们将积分分开，并在 $[0,1]$ 和 $[1,2]$ 上应用 3 点 Gauss–Legendre 法则。因为在每个子区间上，被积函数 $q^{2} w(q)$ 是一个最高 5 次的多项式，所以 3 点 Gauss–Legendre 法则（对最高 5 次的多项式是精确的）可以在每个子区间上得到精确的积分值。\n\n尽管如此，为了展示数值，我们将上面计算的精确子积分表示为\n$$\n\\int_{0}^{1} q^{2} w(q)\\,dq = \\frac{19}{120} \\approx 0.1583333333,\n\\quad\n\\int_{1}^{2} q^{2} w(q)\\,dq = \\frac{11}{120} \\approx 0.0916666667.\n$$\n求和，\n$$\n\\int_{0}^{2} q^{2} w(q)\\,dq \\approx 0.1583333333 + 0.0916666667 = 0.2500000000,\n$$\n至少有 10 位有效数字。因此，\n$$\n\\int_{\\|\\mathbf{r}\\|\\leq 2} W(\\mathbf{r},1)\\,d\\mathbf{r}\n= 4 \\times 0.2500000000 = 1.0000000000,\n$$\n从而在数值上以至少 10 位有效数字的精度验证了归一化。\n\n总之，归一化常数与 $h$ 无关，其值为\n$$\nC_{3} = \\frac{1}{\\pi},\n$$\n且 $h=1$ 时的数值积分验证证实了该核函数在其支集上的积分为 $1$。",
            "answer": "$$\\boxed{\\frac{1}{\\pi}}$$"
        },
        {
            "introduction": "在模拟近似不可压缩流体时，弱可压SPH（WCSPH）方法是一种高效且广泛应用的技术。该方法通过引入一个人为声速 $c_s$ 来将压力与微小的密度变化联系起来，从而避免了求解严格的泊松方程。这个练习将让你亲手实践如何根据期望的密度波动上限来确定所需的最小声速，并计算出相应的CFL时间步长限制，这是设置稳定且准确的WCSPH模拟的核心技能 。",
            "id": "3363330",
            "problem": "考虑一个粘性连续介质流动的弱可压光滑粒子流体动力学（SPH）离散化，该离散化采用正压状态方程和人工声速 $c_{s}$ 来近似不可压缩性。流体的参考密度为 $\\rho_{0}$，流场在计算域内达到的最大速度为 $U_{\\max}$。为保证小的可压缩性误差，要求在整个模拟过程中相对密度变化 $\\Delta \\rho/\\rho_{0}$ 保持小于或等于 $0.01$。\n\n从连续介质的质量和动量守恒方程以及正压封闭关系出发，根据第一性原理推导，为给定的 $U_{\\max}$，确保 $\\Delta \\rho/\\rho_{0} \\leq 0.01$ 所需的最小声速 $c_{s}$。然后，利用显式时间积分的 Courant-Friedrichs-Lewy (CFL) 原则，其中 SPH 中的主导信号速度取为声学和对流贡献之和，确定相应的声学 CFL 时间步长约束。特别地，假设粒子光滑长度为 $h$，选择的库朗数为 $C$，并使用方法中最快的特征信号在单个时间步内不得穿越超过一个光滑长度的要求。\n\n使用以下参数：\n- 最大流速 $U_{\\max} = 2.5$ m/s，\n- 光滑长度 $h = 0.01$ m，\n- 库朗数 $C = 0.35$。\n\n将最终数值四舍五入至四位有效数字。最小声速以 m/s 表示，时间步长以秒表示。您的最终答案必须是一个单行矩阵，包含最小 $c_{s}$ 值和在声学 CFL 约束下的相应最大稳定时间步长 $\\Delta t$。",
            "solution": "该问题的求解分为两个步骤：首先，推导维持所需可压缩性水平所需的最小声速 $c_s$；其次，利用该声速值根据CFL（Courant-Friedrichs-Lewy）条件计算最大稳定时间步长 $\\Delta t$。\n\n**1. 最小声速的推导**\n在弱可压SPH（WCSPH）方法中，压力 $P$ 和密度 $\\rho$ 通过一个状态方程相关联，其声速 $c_s$ 定义为 $c_s^2 = dP/d\\rho$。对于参考密度 $\\rho_0$ 附近的小密度波动 $\\Delta \\rho = \\rho - \\rho_0$，压力波动 $\\Delta P$ 可线性化为：\n$$\n\\Delta P \\approx c_s^2 \\Delta \\rho\n$$\n在流体动力学中，压力波动的主要来源是动压，其量级与 $\\rho_0 U_{\\max}^2$ 相当，其中 $U_{\\max}$ 是最大流速。通过平衡这两个压力尺度，我们得到：\n$$\nc_s^2 \\Delta \\rho \\sim \\rho_0 U_{\\max}^2\n$$\n整理可得相对密度变化：\n$$\n\\frac{\\Delta \\rho}{\\rho_0} \\sim \\left(\\frac{U_{\\max}}{c_s}\\right)^2\n$$\n为了将相对密度变化限制在 $0.01$ 以内，即 $\\frac{\\Delta \\rho}{\\rho_0} \\leq 0.01$，我们必须要求：\n$$\n\\left(\\frac{U_{\\max}}{c_s}\\right)^2 \\leq 0.01 \\quad \\Rightarrow \\quad c_s^2 \\geq \\frac{U_{\\max}^2}{0.01} = 100 U_{\\max}^2\n$$\n因此，所需的最小声速为：\n$$\nc_{s, \\min} = 10 U_{\\max}\n$$\n代入给定的 $U_{\\max} = 2.5 \\, \\text{m/s}$：\n$$\nc_{s, \\min} = 10 \\times 2.5 \\, \\text{m/s} = 25 \\, \\text{m/s}\n$$\n四舍五入至四位有效数字，结果为 $c_{s, \\min} = 25.00 \\, \\text{m/s}$。\n\n**2. 最大稳定时间步长的计算**\n对于显式时间积分方案，CFL稳定性条件要求：\n$$\n\\Delta t \\leq C \\frac{\\Delta x}{v_{\\text{signal}}}\n$$\n在本问题中，特征长度尺度为光滑长度 $h$，库朗数为 $C$。主导信号速度 $v_{\\text{signal}}$ 是声速和对流速度之和。为保证全局稳定，我们必须使用最坏情况，即最大信号速度：\n$$\nv_{\\text{signal, max}} = c_{s, \\min} + U_{\\max}\n$$\n因此，最大稳定时间步长 $\\Delta t_{\\max}$ 为：\n$$\n\\Delta t_{\\max} = C \\frac{h}{c_{s, \\min} + U_{\\max}}\n$$\n代入数值 $C = 0.35$, $h = 0.01 \\, \\text{m}$, $U_{\\max} = 2.5 \\, \\text{m/s}$ 和 $c_{s, \\min} = 25 \\, \\text{m/s}$：\n$$\n\\Delta t_{\\max} = 0.35 \\times \\frac{0.01 \\, \\text{m}}{25 \\, \\text{m/s} + 2.5 \\, \\text{m/s}} = \\frac{0.0035}{27.5} \\, \\text{s} \\approx 0.00012727... \\, \\text{s}\n$$\n四舍五入至四位有效数字，得到 $\\Delta t_{\\max} = 1.273 \\times 10^{-4} \\, \\text{s}$。\n\n综上，最小声速为 $25.00 \\, \\text{m/s}$，对应的最大稳定时间步长为 $1.273 \\times 10^{-4} \\, \\text{s}$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n25.00  1.273 \\times 10^{-4}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "SPH不仅是一种流体动力学求解器，其内在的平滑特性也使其成为分析复杂流动（如湍流）的有力工具。在这个高级练习中，你将学习如何构建一个具有特定能量谱的合成湍流速度场，并探究不同的SPH核函数和LES亚格子模型如何作为滤波器影响湍流的能量谱 。这项实践揭示了SPH方法与大涡模拟（LES）之间的深刻联系，并展示了核函数选择对解析尺度的影响。",
            "id": "3363399",
            "problem": "您的任务是设计一个程序，该程序构建一个具有指定惯性区能谱的合成、无散、各向同性的速度场，然后评估光滑粒子流体动力学（SPH）平滑和可选的大涡模拟（LES）子网格扩散如何改变测得的各向同性能谱。任务是计算几种核函数和模型配置下能谱的估计惯性区斜率，并报告其与柯尔莫哥洛夫标度的偏差。\n\n程序必须遵循以下基于物理的建模假设和定义。\n\n- 光滑粒子流体动力学（SPH）近似：对于一个标量或矢量场量 $A(\\mathbf{x})$，在粒子质量相等且密度均匀的情况下，位于位置 $\\mathbf{x}$ 的 SPH 平滑场由以下卷积表示给出\n$$\nA_{\\text{SPH}}(\\mathbf{x}) \\approx \\int_{\\Omega} A(\\mathbf{y}) W\\left(\\lVert \\mathbf{x} - \\mathbf{y} \\rVert, h \\right) \\,\\mathrm{d}\\mathbf{y},\n$$\n其中 $W(r,h)$ 是一个径向对称的光滑核函数，其紧支撑集为 $r \\in [0, 2h]$，光滑长度 $h$ 的单位与域长度相同，$\\Omega$ 是一个周期性域。\n\n- 周期性盒子和离散采样：在一个边长为 $L = 2\\pi$ 的周期性立方体域上工作，该域被一个 $N \\times N \\times N$（其中 $N = 32$）的均匀网格离散化。网格间距为 $\\Delta x = L/N$。粒子精确地位于网格点上，具有单位密度和相等的粒子质量，这使得上述卷积表示与网格上的离散周期性卷积一致。\n\n- 无散的各向同性合成场：通过塑造其傅里叶系数，在网格上构建一个统计上各向同性、零均值、无散的矢量场 $\\mathbf{u}(\\mathbf{x})$，使其具有与柯尔莫哥洛夫能谱标度相关的近似惯性区。在傅里叶空间中，记整数波数向量索引为 $\\mathbf{m} = (m_x, m_y, m_z)$，对应于周期性网格上的离散傅里叶模，并令 $k = \\lVert \\mathbf{m} \\rVert$。需采用以下构建方法：\n    1.  在物理空间中抽取三个独立的零均值、单位方差的高斯随机场，将每个场变换到傅里叶空间，并汇集成一个三分量的复数场 $\\widehat{\\mathbf{u}}_0(\\mathbf{m})$。这确保了厄米对称性，从而保证逆变换的结果是实数。\n    2.  通过投影算子强制实现不可压缩性\n    $$\n    \\widehat{\\mathbf{u}}_{\\perp}(\\mathbf{m}) = \\left(\\mathbf{I} - \\hat{\\mathbf{k}}\\hat{\\mathbf{k}}^{\\top}\\right)\\widehat{\\mathbf{u}}_{0}(\\mathbf{m}), \\quad \\hat{\\mathbf{k}} = \\frac{\\mathbf{m}}{\\lVert \\mathbf{m} \\rVert}, \\quad \\widehat{\\mathbf{u}}_{\\perp}(\\mathbf{0}) = \\mathbf{0},\n    $$\n    该算子应用于所有非零模 $\\mathbf{m} \\neq \\mathbf{0}$。\n    3.  通过将每个 $\\widehat{\\mathbf{u}}_{\\perp}(\\mathbf{m})$ 乘以一个形式如下的标量整形因子 $S(k)$ 来施加近似的惯性标度\n    $$\n    S(k) = \\left(k + \\varepsilon\\right)^{-11/6}\\,\\exp\\!\\left[-\\left(\\frac{k}{k_c}\\right)^{4}\\right]\\,\\left(1 - \\exp\\!\\left[-\\left(\\frac{k}{k_\\ell}\\right)^{4}\\right]\\right),\n    $$\n    其中 $k_c = N/3$，$k_\\ell = 2$，$\\varepsilon$ 是一个小的正数以避免除以零。这将产生一个无散场，其每模功率在中间范围内以 $k^{-11/3}$ 的形式衰减，这与球壳平均后 $E(k) \\propto k^{-5/3}$ 的各向同性能谱一致。\n\n- SPH 核函数：使用两种标准且经过充分测试的三维 SPH 核函数，它们在 $[0,2h]$ 上具有紧支撑，并用 $q = r/h$ 表示。\n    1.  Monaghan 立方 B 样条核函数：\n    $$\n    W_{\\text{cubic}}(q,h) = \\frac{1}{\\pi h^{3}}\n    \\begin{cases}\n    1 - \\frac{3}{2}q^{2} + \\frac{3}{4}q^{3},  0 \\le q  1,\\\\\n    \\frac{1}{4}(2 - q)^{3},  1 \\le q \\le 2,\\\\\n    0,  q > 2.\n    \\end{cases}\n    $$\n    2.  Wendland $C^{4}$ 核函数：\n    $$\n    W_{\\text{W4}}(q,h) = \\frac{\\alpha}{h^{3}}\n    \\begin{cases}\n    \\left(1 - \\frac{q}{2}\\right)^{6}\\left(1 + 6\\frac{q}{2} + \\frac{35}{3}\\left(\\frac{q}{2}\\right)^{2}\\right),  0 \\le q \\le 2,\\\\\n    0,  q > 2,\n    \\end{cases}\n    $$\n    $$\n    \\alpha = \\frac{495}{256\\pi}.\n    $$\n    在网格上的离散周期性卷积中，核函数必须被归一化，使得其在所有网格点上的离散和等于 $1$，以确保常数守恒。\n\n- LES 子网格扩散模型：为了在能谱层面模拟涡粘性闭合，通过将每个傅里叶模乘以\n$$\nG_{\\nu}(k) = \\exp\\!\\left(-\\nu_{t}\\,k^{2}\\right),\n$$\n来对 SPH 平滑场在傅里叶空间中施加一个扩散滤波器，其中 $\\nu_{t} \\ge 0$ 是一个无量纲的涡粘性系数，$k = \\lVert \\mathbf{m} \\rVert$。这对应于通过扩散方程在谱空间中的解进行单步平滑。\n\n- 能谱计算：设 $\\widehat{\\mathbf{u}}(\\mathbf{m})$ 表示周期性网格上速度场的傅里叶变换。定义离散的每模动能密度为\n$$\n\\mathcal{E}(\\mathbf{m}) = \\frac{1}{2}\\left(\\left\\lvert \\widehat{u}_{x}(\\mathbf{m})\\right\\rvert^{2} + \\left\\lvert \\widehat{u}_{y}(\\mathbf{m})\\right\\rvert^{2} + \\left\\lvert \\widehat{u}_{z}(\\mathbf{m})\\right\\rvert^{2}\\right).\n$$\n通过将 $\\mathcal{E}(\\mathbf{m})$ 在整数波数 $k$ 的球壳中进行分箱，来获得各向同性能谱的估计值：\n$$\nE_{\\text{est}}(k) = \\sum_{\\mathbf{m}: k \\le \\lVert \\mathbf{m} \\rVert  k+1} \\mathcal{E}(\\mathbf{m}),\n$$\n对于整数 $k \\in \\{0,1,2,\\dots\\}$。为了估计惯性区斜率，在波数窗口 $k \\in [k_{1},k_{2}]$（其中 $k_{1} = 4$ 和 $k_{2} = 12$）上对 $\\log E_{\\text{est}}(k)$ 与 $\\log k$ 进行线性最小二乘拟合，仅使用能量严格为正的箱。\n\n- 惯性区斜率偏差：设 $s$ 表示拟合的斜率。惯性区的目标是柯尔莫哥洛夫标度 $E(k) \\sim k^{-5/3}$，因此理想斜率为 $-5/3$。对于每个测试案例，报告其偏差\n$$\n\\Delta s = s - \\left(-\\frac{5}{3}\\right).\n$$\n所有计算都是无量纲的；不需要物理单位。\n\n在单个程序中实现上述内容，该程序使用固定的随机种子以确保可复现性。程序必须：\n\n- 使用所述步骤构建基础无散傅里叶场 $\\widehat{\\mathbf{u}}_{\\text{base}}(\\mathbf{m})$，参数为 $N = 32$，$L = 2\\pi$，$k_c = N/3$，$k_{\\ell} = 2$，以及一个小的 $\\varepsilon = 10^{-6}$。\n- 对于每个测试案例，为选定的 $W(r,h)$ 在网格上构建离散周期性核函数，将其归一化使得离散和等于 $1$，计算其离散傅里叶变换 $\\widehat{W}(\\mathbf{m})$，并形成处理后的场\n$$\n\\widehat{\\mathbf{u}}_{\\text{proc}}(\\mathbf{m}) = \\widehat{\\mathbf{u}}_{\\text{base}}(\\mathbf{m})\\,\\widehat{W}(\\mathbf{m})\\,G_{\\nu}(k),\n$$\n即与标量因子 $\\widehat{W}(\\mathbf{m})$ 和 $G_{\\nu}(k)$ 进行按分量相乘。\n- 从 $\\widehat{\\mathbf{u}}_{\\text{proc}}(\\mathbf{m})$ 计算 $E_{\\text{est}}(k)$，并在 $k \\in [4,12]$ 上如上所述拟合斜率 $s$。\n- 对于每个测试案例，输出 $\\Delta s$ 的值，形式为浮点数。\n\n测试套件。使用以下五个测试案例来涵盖不同方面：\n\n- 案例1（基准情况）：核函数 = 立方 B 样条，$h/\\Delta x = 1.5$，$\\nu_{t} = 0$。\n- 案例2（核函数变更）：核函数 = Wendland $C^{4}$，$h/\\Delta x = 1.5$，$\\nu_{t} = 0$。\n- 案例3（增加平滑）：核函数 = 立方 B 样条，$h/\\Delta x = 2.5$，$\\nu_{t} = 0$。\n- 案例4（LES 扩散）：核函数 = 立方 B 样条，$h/\\Delta x = 1.5$，$\\nu_{t} = 0.02$。\n- 案例5（更紧凑的核支撑）：核函数 = Wendland $C^{4}$，$h/\\Delta x = 1.0$，$\\nu_{t} = 0$。\n\n随机种子。为随机数生成器使用固定种子 $s_{0} = 12345$，以确保基础场的可复现性。\n\n角度单位。此问题不涉及角度；不需要角度单位。\n\n最终输出格式。您的程序应生成单行输出，其中包含五个 $\\Delta s$ 的结果，按测试案例的顺序列出，并用方括号括起来的逗号分隔列表（例如，“[r1,r2,r3,r4,r5]”）。结果必须报告为浮点数。不应打印其他任何文本。",
            "solution": "该问题的解决方案遵循问题陈述中详细描述的计算程序。核心步骤在傅里叶空间中执行，利用卷积定理将物理空间中的平滑操作转化为谱空间中的乘法。\n\n1.  **合成湍流场**：在一个 $32 \\times 32 \\times 32$ 的周期性网格上，首先生成三个独立的高斯随机场。通过傅里叶变换，利用投影算子 $(\\mathbf{I} - \\hat{\\mathbf{k}}\\hat{\\mathbf{k}}^{\\top})$ 强制其在谱空间中满足无散条件。然后，将每个傅里叶模乘以一个整形因子 $S(k) \\propto k^{-11/6}$，以构造一个具有类柯尔莫哥洛夫惯性区的基准速度场 $\\widehat{\\mathbf{u}}_{\\text{base}}(\\mathbf{m})$。\n\n2.  **应用滤波器**：对于五个测试案例中的每一个，执行以下操作：\n    a.  根据指定的核函数（立方B样条或Wendland $C^4$）和光滑长度 $h$，在物理空间网格上构造离散的SPH核。该核经过归一化，使其离散和为1，然后通过快速傅里叶变换（FFT）得到其谱表示 $\\widehat{W}(\\mathbf{m})$。\n    b.  构造LES扩散滤波器 $G_{\\nu}(k) = \\exp(-\\nu_{t}\\,k^{2})$。\n    c.  通过谱空间中的乘法将这两个滤波器应用于基准速度场：$\\widehat{\\mathbf{u}}_{\\text{proc}}(\\mathbf{m}) = \\widehat{\\mathbf{u}}_{\\text{base}}(\\mathbf{m})\\,\\widehat{W}(\\mathbf{m})\\,G_{\\nu}(k)$。\n\n3.  **能谱分析**：\n    a.  计算处理后场 $\\widehat{\\mathbf{u}}_{\\text{proc}}$ 的每模动能密度 $\\mathcal{E}(\\mathbf{m}) = \\frac{1}{2} \\lVert \\widehat{\\mathbf{u}}_{\\text{proc}}(\\mathbf{m}) \\rVert^2$。\n    b.  通过在整数波数 $k$ 的球壳内对能量进行分箱，得到各向同性能谱 $E_{\\text{est}}(k)$。\n    c.  在指定的惯性区范围 $k \\in [4, 12]$ 内，对 $\\log E_{\\text{est}}(k)$ 与 $\\log k$ 进行线性最小二乘拟合，得到能谱斜率 $s$。\n\n4.  **偏差计算**：最后，计算拟合斜率 $s$ 与理论柯尔莫哥洛夫斜率 $-5/3$ 之间的偏差 $\\Delta s = s - (-5/3)$。\n\n通过使用固定的随机种子和精确执行上述步骤，为每个测试案例生成一个确定的 $\\Delta s$ 值。",
            "answer": "[-0.1706692735235881,-0.0934149861678129,-0.6695276510344469,-0.9996500473367123,-0.06554558509376623]"
        }
    ]
}