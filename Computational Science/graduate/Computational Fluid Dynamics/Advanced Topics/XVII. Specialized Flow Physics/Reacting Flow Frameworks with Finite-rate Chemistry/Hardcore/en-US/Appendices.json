{
    "hands_on_practices": [
        {
            "introduction": "Understanding how pressure evolves in a reacting flow is fundamental to modeling combustion and chemical processes. This practice guides you through a first-principles derivation to connect the macroscopic pressure change, $dp/dt$, to the microscopic rates of temperature change, $\\dot{T}$, and species composition change, $\\dot{Y}_k$. By working through this problem (), you will solidify your understanding of the interplay between thermodynamics and chemical kinetics in a simple yet powerful model system.",
            "id": "3356521",
            "problem": "Consider a spatially uniform, adiabatic, inviscid, non-conducting Lagrangian parcel of an ideal-gas mixture composed of $N$ chemical species indexed by $k=1,\\dots,N$. Let the species mass fractions be $Y_k$ with $\\sum_{k=1}^{N} Y_k = 1$, the mixture density be $\\rho$, the pressure be $p$, and the temperature be $T$. Each species $k$ has molecular weight $W_k$, individual gas constant $R_k = R_u/W_k$ where $R_u$ is the universal gas constant, temperature-dependent constant-pressure and constant-volume specific heats $c_{p,k}(T)$ and $c_{v,k}(T)$, and thermochemical functions of temperature $h_k(T)$ and $e_k(T)$ obeying the ideal-gas caloric relation $h_k(T) = e_k(T) + R_k T$. Define the mixture properties by mass-weighted sums:\n$$\nc_p(T,\\mathbf{Y}) = \\sum_{k=1}^{N} Y_k\\,c_{p,k}(T),\\quad\nc_v(T,\\mathbf{Y}) = \\sum_{k=1}^{N} Y_k\\,c_{v,k}(T),\\quad\nR(\\mathbf{Y}) = \\sum_{k=1}^{N} Y_k\\,R_k,\n$$\nand the mixture ratio of specific heats\n$$\n\\gamma(T,\\mathbf{Y}) = \\frac{c_p(T,\\mathbf{Y})}{c_v(T,\\mathbf{Y})}.\n$$\nAssume the mixture obeys the ideal-gas equation of state $p = \\rho\\,R(\\mathbf{Y})\\,T$, and that the parcel experiences composition changes $\\dot{Y}_k = dY_k/dt$ due to finite-rate chemistry, with a temperature rate $\\dot{T} = dT/dt$. Using only the ideal-gas mixture assumptions and first principles (the first law of thermodynamics for a moving parcel and mass conservation), perform the following:\n\n- Explain how the mixture $c_p$, $c_v$, and $\\gamma$ depend on $Y_k$ and $T$.\n- Derive a closed-form expression for the material time derivative of the pressure, $\\frac{dp}{dt}$, for the Lagrangian reacting parcel, expressed entirely in terms of $\\rho$, $c_p(T,\\mathbf{Y})$, $h_k(T)$, $\\dot{T}$, and $\\dot{Y}_k$.\n\nYour final expression for $\\frac{dp}{dt}$ must be written as a single analytic formula in terms of $\\rho$, $c_p(T,\\mathbf{Y})$, $h_k(T)$, $\\dot{T}$, and $\\dot{Y}_k$. No numerical evaluation is required, and no rounding is needed. Express the final answer as the single analytic expression requested.",
            "solution": "The problem is subjected to validation before proceeding to a solution.\n\n### Step 1: Extract Givens\n- **System:** A spatially uniform, adiabatic, inviscid, non-conducting Lagrangian parcel of an ideal-gas mixture.\n- **Species:** $N$ chemical species, indexed by $k=1,\\dots,N$.\n- **State variables:** Species mass fractions $Y_k$ with $\\sum_{k=1}^{N} Y_k = 1$, mixture density $\\rho$, pressure $p$, and temperature $T$.\n- **Species properties:** Molecular weight $W_k$, individual gas constant $R_k = R_u/W_k$, temperature-dependent constant-pressure specific heat $c_{p,k}(T)$, temperature-dependent constant-volume specific heat $c_{v,k}(T)$, specific enthalpy $h_k(T)$, and specific internal energy $e_k(T)$.\n- **Constitutive relations:** Ideal-gas caloric relation $h_k(T) = e_k(T) + R_k T$.\n- **Mixture properties:**\n  - $c_p(T,\\mathbf{Y}) = \\sum_{k=1}^{N} Y_k\\,c_{p,k}(T)$\n  - $c_v(T,\\mathbf{Y}) = \\sum_{k=1}^{N} Y_k\\,c_{v,k}(T)$\n  - $R(\\mathbf{Y}) = \\sum_{k=1}^{N} Y_k\\,R_k$\n  - $\\gamma(T,\\mathbf{Y}) = \\frac{c_p(T,\\mathbf{Y})}{c_v(T,\\mathbf{Y})}$\n- **Governing equations:** Mixture ideal-gas equation of state $p = \\rho\\,R(\\mathbf{Y})\\,T$.\n- **Process information:** Finite-rate chemistry leads to composition changes $\\dot{Y}_k = dY_k/dt$ and a temperature rate $\\dot{T} = dT/dt$.\n- **Objective:**\n  1. Explain how the mixture properties $c_p$, $c_v$, and $\\gamma$ depend on $Y_k$ and $T$.\n  2. Derive a closed-form expression for the material time derivative of the pressure, $dp/dt$, in terms of $\\rho$, $c_p(T,\\mathbf{Y})$, $h_k(T)$, $\\dot{T}$, and $\\dot{Y}_k$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is examined for validity:\n- **Scientific Grounding:** The problem is based on the fundamental principles of thermodynamics and chemical kinetics as applied to ideal gas mixtures. All definitions and equations (e.g., ideal gas law, definitions of mixture properties) are standard in the field of reacting flows and combustion. The setup is scientifically sound.\n- **Well-Posedness:** The problem asks for a derivation based on a given set of principles and definitions. All necessary information appears to be provided. The objective is clear and a unique analytical result is expected.\n- **Objectivity:** The problem is stated in precise, objective language, free of subjective claims or ambiguity.\n- **Completeness and Consistency:** The problem provides a self-contained set of assumptions (adiabatic, inviscid, ideal gas, etc.) and definitions. There are no apparent contradictions. The concept of a spatially uniform Lagrangian parcel is a standard simplification in chemical kinetics modeling (e.g., a zero-dimensional reactor model).\n- **Feasibility:** The scenario is physically plausible within the context of theoretical and computational modeling of reacting flows.\n- **Structure:** The problem is well-structured and does not contain any trivialities or circular reasoning. The derivation requires a multi-step application of first principles.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. It is a standard, well-posed problem in theoretical reacting-flow physics. A solution will be provided.\n\n### Solution\n\nThe solution is presented in two parts as requested by the problem statement.\n\n**Part 1: Dependence of Thermochemical Properties**\n\nThe mixture's thermochemical properties are defined as mass-weighted averages of the individual species' properties.\n\n- The mixture's constant-pressure specific heat, $c_p(T,\\mathbf{Y})$, is defined as $c_p(T,\\mathbf{Y}) = \\sum_{k=1}^{N} Y_k c_{p,k}(T)$. The individual species specific heats, $c_{p,k}$, are functions of temperature $T$. The mixture property $c_p$ is a linear combination of these functions, with the coefficients being the mass fractions $Y_k$. Therefore, $c_p$ depends on both the temperature $T$ and the composition vector $\\mathbf{Y} = (Y_1, \\dots, Y_N)$.\n\n- Similarly, the mixture's constant-volume specific heat, $c_v(T,\\mathbf{Y})$, is defined as $c_v(T,\\mathbf{Y}) = \\sum_{k=1}^{N} Y_k c_{v,k}(T)$. For the same reason as with $c_p$, the mixture property $c_v$ depends on both temperature $T$ (via $c_{v,k}(T)$) and composition $\\mathbf{Y}$ (via the weights $Y_k$).\n\n- The ratio of specific heats, $\\gamma(T,\\mathbf{Y})$, is defined as $\\gamma(T,\\mathbf{Y}) = \\frac{c_p(T,\\mathbf{Y})}{c_v(T,\\mathbf{Y})}$. Since both its numerator and denominator depend on $T$ and $\\mathbf{Y}$, the ratio $\\gamma$ is also a function of both temperature and composition.\n\n**Part 2: Derivation of the Pressure Derivative**\n\nThe objective is to derive an expression for the material time derivative of pressure, $dp/dt$. The most direct path is to relate the pressure evolution to the evolution of the specific enthalpy of the mixture.\n\nFirst, we derive a fundamental thermodynamic relation for the specified system. The first law of thermodynamics for a closed Lagrangian parcel of constant mass $m$ is:\n$$ dE = \\delta Q - \\delta W $$\nwhere $E$ is the total internal energy, $\\delta Q$ is the heat added to the system, and $\\delta W$ is the work done by the system. The problem states the parcel is adiabatic, so $\\delta Q=0$. The work done by expansion is $\\delta W = p dV$, where $V$ is the volume of the parcel.\nThus, the first law simplifies to $dE = -p dV$.\nIn terms of specific quantities, $E = m e$ and $V = m v = m/\\rho$, where $e$ is the specific internal energy, $v$ is the specific volume, and $\\rho$ is the density. Since mass $m$ is constant:\n$$ m \\, de = -p \\, d(m/\\rho) = -pm \\, d(\\rho^{-1}) = -pm (-\\rho^{-2} d\\rho) = \\frac{mp}{\\rho^2} d\\rho $$\nDividing by $m$, we obtain the specific energy equation for the parcel:\n$$ de = \\frac{p}{\\rho^2} d\\rho $$\nThe specific enthalpy of the mixture, $h$, is defined as $h = e + p/\\rho$. Its differential is:\n$$ dh = de + d(p/\\rho) = de + \\frac{1}{\\rho}dp - \\frac{p}{\\rho^2}d\\rho $$\nSubstituting the expression for $de$:\n$$ dh = \\left(\\frac{p}{\\rho^2} d\\rho\\right) + \\frac{1}{\\rho}dp - \\frac{p}{\\rho^2}d\\rho = \\frac{1}{\\rho}dp $$\nThis yields the elegant and powerful relation $dp = \\rho dh$. For a Lagrangian parcel, this implies that the material time derivatives are related by:\n$$ \\frac{dp}{dt} = \\rho \\frac{dh}{dt} $$\nNow we must find an expression for $dh/dt$. The mixture specific enthalpy is a mass-weighted sum of the species specific enthalpies:\n$$ h(T, \\mathbf{Y}) = \\sum_{k=1}^{N} Y_k h_k(T) $$\nWe take the material time derivative, applying the product rule:\n$$ \\frac{dh}{dt} = \\frac{d}{dt} \\left( \\sum_{k=1}^{N} Y_k h_k(T) \\right) = \\sum_{k=1}^{N} \\left( \\frac{dY_k}{dt} h_k(T) + Y_k \\frac{dh_k(T)}{dt} \\right) $$\nThe term $dY_k/dt$ is the species production rate, denoted $\\dot{Y}_k$. For the derivative of $h_k(T)$, we use the chain rule: $dh_k(T)/dt = (dh_k/dT)(dT/dt)$.\nBy definition, the constant-pressure specific heat of species $k$ is $c_{p,k}(T) = dh_k/dT$. The rate of change of temperature is given as $\\dot{T} = dT/dt$.\nSubstituting these into the expression for $dh/dt$:\n$$ \\frac{dh}{dt} = \\sum_{k=1}^{N} \\dot{Y}_k h_k(T) + \\sum_{k=1}^{N} Y_k c_{p,k}(T) \\frac{dT}{dt} $$\nFactoring out $dT/dt$:\n$$ \\frac{dh}{dt} = \\sum_{k=1}^{N} \\dot{Y}_k h_k(T) + \\left( \\sum_{k=1}^{N} Y_k c_{p,k}(T) \\right) \\dot{T} $$\nThe term in parentheses is the definition of the mixture's constant-pressure specific heat, $c_p(T, \\mathbf{Y})$.\n$$ \\frac{dh}{dt} = \\sum_{k=1}^{N} \\dot{Y}_k h_k(T) + c_p(T, \\mathbf{Y}) \\dot{T} $$\nFinally, we substitute this result back into the pressure evolution equation, $\\frac{dp}{dt} = \\rho \\frac{dh}{dt}$:\n$$ \\frac{dp}{dt} = \\rho \\left( c_p(T, \\mathbf{Y}) \\dot{T} + \\sum_{k=1}^{N} \\dot{Y}_k h_k(T) \\right) $$\nRearranging gives the final expression for the material derivative of pressure, showing its dependence on the rate of change of temperature and the rate of change of composition due to chemical reactions:\n$$ \\frac{dp}{dt} = \\rho c_p(T, \\mathbf{Y}) \\dot{T} + \\rho \\sum_{k=1}^{N} \\dot{Y}_k h_k(T) $$\nThis expression is in the required form, fully defined by the specified variables and thermochemical functions.",
            "answer": "$$\n\\boxed{\\rho c_p(T, \\mathbf{Y}) \\dot{T} + \\rho \\sum_{k=1}^{N} \\dot{Y}_k h_k(T)}\n$$"
        },
        {
            "introduction": "The numerical solution of finite-rate chemistry is dominated by the challenge of stiffness, necessitating implicit methods that require the Jacobian of the chemical source terms. This exercise () involves the detailed analytical derivation of this Jacobian, accounting for complex reaction types common in real-world mechanisms. Mastering this derivation is crucial for building robust and efficient reacting flow solvers and provides deep insight into the structure of chemical kinetic systems.",
            "id": "3356493",
            "problem": "Consider a homogeneous, isothermal reacting mixture described within Computational Fluid Dynamics (CFD) by species molar concentrations $C_{i}$, $i \\in \\{1,\\dots,N_{s}\\}$, at fixed temperature $T$ and fixed volume. The mixture undergoes $N_{r}$ reversible elementary reactions indexed by $r \\in \\{1,\\dots,N_{r}\\}$ with reactant stoichiometric coefficients $\\nu_{ir}^{\\prime}$ and product stoichiometric coefficients $\\nu_{ir}^{\\prime\\prime}$, and net stoichiometric coefficients $\\nu_{ir} \\equiv \\nu_{ir}^{\\prime\\prime} - \\nu_{ir}^{\\prime}$. The molar production rate of species $k$, denoted $\\dot{\\omega}_{k}$, is given by the stoichiometric summation\n$$\n\\dot{\\omega}_{k} \\;=\\; \\sum_{r=1}^{N_{r}} \\nu_{kr}\\, q_{r},\n$$\nwhere the reaction rate-of-progress $q_{r}$ is\n$$\nq_{r} \\;=\\; R_{r}^{+} \\;-\\; R_{r}^{-}.\n$$\nAssume mass-action kinetics for all reactions, with third-body and fall-off modifications where applicable, so that\n$$\nR_{r}^{+} \\;=\\; k_{f,r}^{*}(T,C)\\,\\prod_{i=1}^{N_{s}} C_{i}^{\\nu_{ir}^{\\prime}}, \\qquad\nR_{r}^{-} \\;=\\; k_{r,r}^{*}(T,C)\\,\\prod_{i=1}^{N_{s}} C_{i}^{\\nu_{ir}^{\\prime\\prime}},\n$$\nand detailed balance enforced via the concentration-based equilibrium constant $K_{c,r}(T)$ through $k_{r,r}^{*}(T,C) = k_{f,r}^{*}(T,C)/K_{c,r}(T)$. Here $k_{f,r}^{*}(T,C)$ is an effective forward rate coefficient that depends on concentration for third-body and fall-off reactions, but depends only on temperature $T$ for ordinary reactions. Define the effective collider concentration for reaction $r$ as\n$$\n[M]_{r} \\;=\\; \\sum_{i=1}^{N_{s}} \\alpha_{ir}\\, C_{i},\n$$\nwith third-body efficiencies $\\alpha_{ir}$ given (default $\\alpha_{ir}=1$ if unspecified). For ordinary reactions, $k_{f,r}^{*}(T,C)=k_{f,r}(T)$. For third-body reactions (not in fall-off), $k_{f,r}^{*}(T,C)=k_{f,r}(T)\\,[M]_{r}$. For fall-off reactions, let the low-pressure limit be $k_{0,r}(T)$, the high-pressure limit be $k_{\\infty,r}(T)$, and the reduced pressure be\n$$\n\\Pr_{r} \\;=\\; \\frac{k_{0,r}(T)\\,[M]_{r}}{k_{\\infty,r}(T)}.\n$$\nLet the fall-off broadening factor be $F_{r}(\\Pr_{r},T)$ (for example, of Troe type), so that\n$$\nk_{f,r}^{*}(T,C) \\;=\\; k_{\\infty,r}(T)\\;F_{r}(\\Pr_{r},T)\\;\\frac{\\Pr_{r}}{1+\\Pr_{r}}.\n$$\nAssume $T$ is fixed, so that $k_{f,r}(T)$, $k_{0,r}(T)$, $k_{\\infty,r}(T)$, and $K_{c,r}(T)$ are constant with respect to $C$, and only $[M]_{r}$ (hence $\\Pr_{r}$ and $F_{r}$ via $\\Pr_{r}$) introduces concentration dependence into $k_{f,r}^{*}(T,C)$.\n\nIntroduce reaction-type indicator functions $\\chi_{r}^{\\mathrm{ord}}$, $\\chi_{r}^{\\mathrm{TB}}$, and $\\chi_{r}^{\\mathrm{FO}}$ that take value $1$ if reaction $r$ is ordinary, third-body (non-fall-off), or fall-off, respectively, and $0$ otherwise, with $\\chi_{r}^{\\mathrm{ord}}+\\chi_{r}^{\\mathrm{TB}}+\\chi_{r}^{\\mathrm{FO}}=1$.\n\nStarting from these definitions and fundamental mass-action kinetics, derive the analytic entry of the species Jacobian $\\partial \\dot{\\omega}_{k}/\\partial C_{j}$ at fixed $T$, explicitly accounting for third-body and fall-off dependencies. Your derivation must explicitly apply the product rule and the chain rule, identifying the contribution of $[M]_{r}$ and $\\Pr_{r}$ to $\\partial k_{f,r}^{*}/\\partial C_{j}$. You may leave $\\partial F_{r}/\\partial \\Pr_{r}$ in symbolic form. Then, briefly explain, based on the derived structure, which index pairs $(k,j)$ can produce nonzero Jacobian entries and how third-body efficiencies $\\alpha_{ir}$ and fall-off reactions alter sparsity compared to ordinary mechanisms.\n\nProvide your final result as a single closed-form analytic expression for $\\partial \\dot{\\omega}_{k}/\\partial C_{j}$ in terms of $\\nu_{ir}^{\\prime}$, $\\nu_{ir}^{\\prime\\prime}$, $\\nu_{ir}$, $k_{f,r}(T)$, $k_{0,r}(T)$, $k_{\\infty,r}(T)$, $K_{c,r}(T)$, $F_{r}(\\Pr_{r},T)$, $\\partial F_{r}/\\partial \\Pr_{r}$, $\\alpha_{ir}$, and $C_{i}$. No numerical evaluation is required, and no rounding is needed. The final answer must be a single analytic expression.",
            "solution": "The objective is to derive the analytical expression for the species Jacobian entry $\\frac{\\partial \\dot{\\omega}_{k}}{\\partial C_{j}}$ for a homogeneous, isothermal, and isochoric reacting system, where $\\dot{\\omega}_{k}$ is the molar production rate of species $k$ and $C_{j}$ is the molar concentration of species $j$. The derivation must account for ordinary, third-body, and pressure-dependent fall-off reactions.\n\nThe molar production rate of species $k$ is given by\n$$\n\\dot{\\omega}_{k} = \\sum_{r=1}^{N_{r}} \\nu_{kr}\\, q_{r}\n$$\nwhere $\\nu_{kr}$ is the net stoichiometric coefficient of species $k$ in reaction $r$, and $q_{r}$ is the rate-of-progress of reaction $r$. The derivative with respect to $C_{j}$ is found by differentiating this summation term by term:\n$$\n\\frac{\\partial \\dot{\\omega}_{k}}{\\partial C_{j}} = \\sum_{r=1}^{N_{r}} \\nu_{kr} \\frac{\\partial q_{r}}{\\partial C_{j}}\n$$\nThe rate-of-progress $q_{r}$ is the difference between the forward and reverse rates, $q_{r} = R_{r}^{+} - R_{r}^{-}$. Thus, its derivative is:\n$$\n\\frac{\\partial q_{r}}{\\partial C_{j}} = \\frac{\\partial R_{r}^{+}}{\\partial C_{j}} - \\frac{\\partial R_{r}^{-}}{\\partial C_{j}}\n$$\nThe forward and reverse rates are given by mass-action kinetics:\n$$\nR_{r}^{+} = k_{f,r}^{*}(T,C)\\,\\prod_{i=1}^{N_{s}} C_{i}^{\\nu_{ir}^{\\prime}} \\quad \\text{and} \\quad R_{r}^{-} = k_{r,r}^{*}(T,C)\\,\\prod_{i=1}^{N_{s}} C_{i}^{\\nu_{ir}^{\\prime\\prime}}\n$$\nUsing the principle of detailed balance, $k_{r,r}^{*} = k_{f,r}^{*} / K_{c,r}(T)$, the reverse rate is $R_{r}^{-} = \\frac{k_{f,r}^{*}(T,C)}{K_{c,r}(T)}\\,\\prod_{i=1}^{N_{s}} C_{i}^{\\nu_{ir}^{\\prime\\prime}}$. Since temperature $T$ is fixed, the equilibrium constant $K_{c,r}(T)$ is constant with respect to concentration changes.\n\nApplying the product rule to differentiate $R_{r}^{+}$ with respect to $C_{j}$:\n$$\n\\frac{\\partial R_{r}^{+}}{\\partial C_{j}} = \\left(\\frac{\\partial k_{f,r}^{*}}{\\partial C_{j}}\\right) \\left(\\prod_{i=1}^{N_{s}} C_{i}^{\\nu_{ir}^{\\prime}}\\right) + k_{f,r}^{*} \\left(\\frac{\\partial}{\\partial C_{j}}\\prod_{i=1}^{N_{s}} C_{i}^{\\nu_{ir}^{\\prime}}\\right)\n$$\nThe derivative of the concentration product term is:\n$$\n\\frac{\\partial}{\\partial C_{j}}\\prod_{i=1}^{N_{s}} C_{i}^{\\nu_{ir}^{\\prime}} = \\frac{\\nu_{jr}^{\\prime}}{C_{j}} \\prod_{i=1}^{N_{s}} C_{i}^{\\nu_{ir}^{\\prime}}\n$$\nThis assumes $C_j > 0$. Substituting this back gives:\n$$\n\\frac{\\partial R_{r}^{+}}{\\partial C_{j}} = \\frac{\\partial k_{f,r}^{*}}{\\partial C_{j}} \\frac{R_{r}^{+}}{k_{f,r}^{*}} + k_{f,r}^{*} \\frac{\\nu_{jr}^{\\prime}}{C_{j}} \\frac{R_{r}^{+}}{k_{f,r}^{*}} = \\left( \\frac{1}{k_{f,r}^{*}}\\frac{\\partial k_{f,r}^{*}}{\\partial C_{j}} + \\frac{\\nu_{jr}^{\\prime}}{C_{j}} \\right) R_{r}^{+}\n$$\nAnalogously, for the reverse rate $R_{r}^{-}$:\n$$\n\\frac{\\partial R_{r}^{-}}{\\partial C_{j}} = \\left( \\frac{1}{k_{f,r}^{*}}\\frac{\\partial k_{f,r}^{*}}{\\partial C_{j}} + \\frac{\\nu_{jr}^{\\prime\\prime}}{C_{j}} \\right) R_{r}^{-}\n$$\nCombining these results yields the derivative of the rate-of-progress:\n$$\n\\frac{\\partial q_{r}}{\\partial C_{j}} = \\left( \\frac{1}{k_{f,r}^{*}}\\frac{\\partial k_{f,r}^{*}}{\\partial C_{j}} + \\frac{\\nu_{jr}^{\\prime}}{C_{j}} \\right) R_{r}^{+} - \\left( \\frac{1}{k_{f,r}^{*}}\\frac{\\partial k_{f,r}^{*}}{\\partial C_{j}} + \\frac{\\nu_{jr}^{\\prime\\prime}}{C_{j}} \\right) R_{r}^{-}\n$$\nRearranging terms gives:\n$$\n\\frac{\\partial q_{r}}{\\partial C_{j}} = \\frac{1}{k_{f,r}^{*}}\\frac{\\partial k_{f,r}^{*}}{\\partial C_{j}}(R_{r}^{+} - R_{r}^{-}) + \\frac{1}{C_{j}}(\\nu_{jr}^{\\prime}R_{r}^{+} - \\nu_{jr}^{\\prime\\prime}R_{r}^{-}) = \\frac{q_r}{k_{f,r}^{*}}\\frac{\\partial k_{f,r}^{*}}{\\partial C_{j}} + \\frac{1}{C_{j}}(\\nu_{jr}^{\\prime}R_{r}^{+} - \\nu_{jr}^{\\prime\\prime}R_{r}^{-})\n$$\nThe remaining task is to derive $\\frac{\\partial k_{f,r}^{*}}{\\partial C_{j}}$. The rate coefficient $k_{f,r}^{*}$ depends on concentration only through the effective collider concentration $[M]_{r} = \\sum_{i=1}^{N_{s}} \\alpha_{ir}\\, C_{i}$. Using the chain rule:\n$$\n\\frac{\\partial k_{f,r}^{*}}{\\partial C_{j}} = \\frac{\\partial k_{f,r}^{*}}{\\partial [M]_{r}} \\frac{\\partial [M]_{r}}{\\partial C_{j}}\n$$\nThe derivative of $[M]_r$ with respect to $C_j$ is simply the third-body efficiency $\\alpha_{jr}$:\n$$\n\\frac{\\partial [M]_{r}}{\\partial C_{j}} = \\frac{\\partial}{\\partial C_{j}} \\sum_{i=1}^{N_s} \\alpha_{ir} C_i = \\alpha_{jr}\n$$\nThe derivative $\\frac{\\partial k_{f,r}^{*}}{\\partial [M]_{r}}$ depends on the reaction type:\n1.  For an ordinary reaction ($\\chi_{r}^{\\mathrm{ord}}=1$), $k_{f,r}^{*} = k_{f,r}(T)$, which is constant with respect to $[M]_r$. Thus, $\\frac{\\partial k_{f,r}^{*}}{\\partial [M]_{r}} = 0$.\n2.  For a third-body reaction ($\\chi_{r}^{\\mathrm{TB}}=1$), $k_{f,r}^{*} = k_{f,r}(T)\\,[M]_{r}$. Thus, $\\frac{\\partial k_{f,r}^{*}}{\\partial [M]_{r}} = k_{f,r}(T)$.\n3.  For a fall-off reaction ($\\chi_{r}^{\\mathrm{FO}}=1$), $k_{f,r}^{*} = k_{\\infty,r}(T)\\;F_{r}(\\Pr_{r},T)\\;\\frac{\\Pr_{r}}{1+\\Pr_{r}}$, where the reduced pressure is $\\Pr_{r} = \\frac{k_{0,r}(T)\\,[M]_{r}}{k_{\\infty,r}(T)}$. We apply the chain rule again: $\\frac{\\partial k_{f,r}^{*}}{\\partial [M]_{r}} = \\frac{\\partial k_{f,r}^{*}}{\\partial \\Pr_{r}}\\frac{\\partial \\Pr_{r}}{\\partial [M]_{r}}$.\n    First, $\\frac{\\partial \\Pr_{r}}{\\partial [M]_{r}} = \\frac{k_{0,r}}{k_{\\infty,r}}$.\n    Next, using the product rule on $k_{f,r}^{*}(\\Pr_r)$:\n    $$\n    \\frac{\\partial k_{f,r}^{*}}{\\partial \\Pr_{r}} = \\frac{\\partial}{\\partial \\Pr_{r}} \\left( k_{\\infty,r} F_r \\frac{\\Pr_r}{1+\\Pr_r} \\right) = k_{\\infty,r} \\left[ \\frac{\\partial F_r}{\\partial \\Pr_r} \\frac{\\Pr_r}{1+\\Pr_r} + F_r \\frac{\\partial}{\\partial \\Pr_r}\\left(\\frac{\\Pr_r}{1+\\Pr_r}\\right)\\right]\n    $$\n    The derivative of the Lindemann-Hinshelwood factor is $\\frac{\\partial}{\\partial \\Pr_r}(\\frac{\\Pr_r}{1+\\Pr_r}) = \\frac{1}{(1+\\Pr_r)^2}$.\n    Substituting this gives:\n    $$\n    \\frac{\\partial k_{f,r}^{*}}{\\partial \\Pr_{r}} = k_{\\infty,r} \\left[ \\frac{\\partial F_r}{\\partial \\Pr_r} \\frac{\\Pr_r}{1+\\Pr_r} + \\frac{F_r}{(1+\\Pr_r)^2} \\right]\n    $$\n    So, for a fall-off reaction:\n    $$\n    \\frac{\\partial k_{f,r}^{*}}{\\partial [M]_{r}} = \\left( k_{\\infty,r} \\left[ \\frac{\\partial F_r}{\\partial \\Pr_r} \\frac{\\Pr_r}{1+\\Pr_r} + \\frac{F_r}{(1+\\Pr_r)^2} \\right] \\right) \\left( \\frac{k_{0,r}}{k_{\\infty,r}} \\right) = k_{0,r} \\left[ \\frac{\\partial F_r}{\\partial \\Pr_r} \\frac{\\Pr_r}{1+\\Pr_r} + \\frac{F_r}{(1+\\Pr_r)^2} \\right]\n    $$\nCombining these cases using the indicator functions:\n$$\n\\frac{\\partial k_{f,r}^{*}}{\\partial C_{j}} = \\alpha_{jr} \\left( \\chi_{r}^{\\mathrm{TB}} k_{f,r} + \\chi_{r}^{\\mathrm{FO}} k_{0,r} \\left[ \\frac{\\partial F_r}{\\partial \\Pr_r} \\frac{\\Pr_r}{1+\\Pr_r} + \\frac{F_r}{(1+\\Pr_r)^2} \\right] \\right)\n$$\nSubstituting all expressions back into the equation for $\\frac{\\partial \\dot{\\omega}_{k}}{\\partial C_{j}}$ and expressing $R_r^{\\pm}$ and $q_r$ in terms of fundamental quantities, we obtain the final analytical form for the Jacobian entry.\n\nThe structure of the derived Jacobian reveals the couplings between species. A Jacobian entry $\\frac{\\partial \\dot{\\omega}_{k}}{\\partial C_{j}}$ is non-zero if there exists at least one reaction $r$ that creates a dependency.\nA reaction $r$ contributes a non-zero term if species $k$ participates in it (i.e., $\\nu_{kr} \\neq 0$), and either:\n1. Species $j$ participates as a reactant or product in reaction $r$ (i.e., $\\nu_{jr}' \\neq 0$ or $\\nu_{jr}'' \\neq 0$). This is the standard \"direct\" coupling.\n2. Reaction $r$ is a third-body or fall-off reaction, and species $j$ acts as a third-body collider with non-zero efficiency (i.e., $\\alpha_{jr} \\neq 0$). This is an \"indirect\" coupling.\n\nIn a mechanism with only ordinary reactions, the Jacobian is sparse. A non-zero entry $\\frac{\\partial \\dot{\\omega}_{k}}{\\partial C_{j}}$ exists only when species $k$ and $j$ appear in the same reaction. The inclusion of third-body and fall-off reactions significantly reduces this sparsity. If a species $j$ has a non-zero third-body efficiency $\\alpha_{jr}$ for a reaction $r$ (which is often the case, with a default of $\\alpha_{jr}=1$), it creates a coupling between species $j$ and every species $k$ that participates in reaction $r$, even if $j$ is not a reactant or product. This means that a single third-body reaction can create non-zero entries for many $(k,j)$ pairs, potentially making rows of the Jacobian matrix dense and increasing the computational cost of solving the system.\n\nThe full analytical expression for the Jacobian entry is provided below.",
            "answer": "$$\n\\boxed{\\frac{\\partial \\dot{\\omega}_{k}}{\\partial C_{j}} = \\sum_{r=1}^{N_{r}} \\nu_{kr} \\left\\{ \\begin{array}{l} \\frac{1}{C_j} \\left( \\chi_{r}^{\\mathrm{ord}}k_{f,r} + \\chi_{r}^{\\mathrm{TB}}k_{f,r}\\sum_{i=1}^{N_s}\\alpha_{ir}C_i + \\chi_{r}^{\\mathrm{FO}}k_{\\infty,r}F_r\\frac{\\Pr_r}{1+\\Pr_r} \\right) \\left( \\nu_{jr}^{\\prime} \\prod_{i=1}^{N_s} C_i^{\\nu_{ir}^{\\prime}} - \\frac{\\nu_{jr}^{\\prime\\prime}}{K_{c,r}} \\prod_{i=1}^{N_s} C_i^{\\nu_{ir}^{\\prime\\prime}} \\right) \\\\ + \\alpha_{jr} \\left( \\prod_{i=1}^{N_s} C_i^{\\nu_{ir}^{\\prime}} - \\frac{1}{K_{c,r}} \\prod_{i=1}^{N_s} C_i^{\\nu_{ir}^{\\prime\\prime}} \\right) \\left( \\chi_{r}^{\\mathrm{TB}}k_{f,r} + \\chi_{r}^{\\mathrm{FO}}k_{0,r} \\left[ \\frac{\\partial F_r}{\\partial \\Pr_r}\\frac{\\Pr_r}{1+\\Pr_r} + \\frac{F_r}{(1+\\Pr_r)^2} \\right] \\right) \\end{array} \\right\\}}\n$$"
        },
        {
            "introduction": "While analytical Jacobians are ideal for robustness, their computation can be a bottleneck for large chemical mechanisms. This hands-on coding practice () explores how to drastically accelerate the construction of a numerical Jacobian by exploiting its inherent sparsity. You will use graph coloring algorithms to group species for simultaneous finite-difference evaluation, a powerful technique that bridges chemical kinetics, numerical analysis, and computer science.",
            "id": "3356523",
            "problem": "Consider a reacting flow framework with finite-rate chemistry for a homogeneous, isothermal mixture of $n_s$ chemical species undergoing $n_r$ elementary, irreversible reactions. Let the molar concentration vector be $\\mathbf{c} \\in \\mathbb{R}^{n_s}$ with components $c_j$ for species $j$, and let the reaction rate vector be $\\mathbf{R}(\\mathbf{c}) \\in \\mathbb{R}^{n_r}$. Each reaction $k$ has an Arrhenius rate constant $A_k \\exp(-E_k/(R T))$ and follows the law of mass action with reactant stoichiometric exponents $\\alpha_{jk} \\in \\{0,1,2,\\dots\\}$, so that\n$$\nR_k(\\mathbf{c}) = A_k \\exp\\left(-\\frac{E_k}{R T}\\right) \\prod_{j=1}^{n_s} c_j^{\\alpha_{jk}}.\n$$\nThe net production rate of species $i$ is given by the species source term\n$$\nf_i(\\mathbf{c}) = \\sum_{k=1}^{n_r} S_{ik} R_k(\\mathbf{c}),\n$$\nwhere $S \\in \\mathbb{R}^{n_s \\times n_r}$ is the stoichiometric matrix with entries $S_{ik}$ equal to the net stoichiometric change of species $i$ in reaction $k$ (negative for reactants, positive for products, and zero otherwise). The Jacobian matrix of the source term is\n$$\nJ(\\mathbf{c}) = \\frac{\\partial \\mathbf{f}}{\\partial \\mathbf{c}} \\in \\mathbb{R}^{n_s \\times n_s}, \\quad J_{ij}(\\mathbf{c}) = \\sum_{k=1}^{n_r} S_{ik} \\frac{\\partial R_k(\\mathbf{c})}{\\partial c_j}.\n$$\nStarting from these fundamental definitions, perform the following tasks:\n\n1. Derive, in terms of $S_{ik}$ and $\\alpha_{jk}$, a necessary and sufficient condition for the sparsity pattern of $J$, that is, characterize when $J_{ij}(\\mathbf{c})$ can be nonzero without evaluating any rates numerically.\n\n2. Construct the column-interference graph for $J$ whose vertices correspond to columns $j \\in \\{1,\\dots,n_s\\}$ and where an undirected edge connects vertices $p$ and $q$ if and only if columns $p$ and $q$ of $J$ share at least one common row index $i$ for which both $J_{ip}$ and $J_{iq}$ can be nonzero. Explain how a proper graph coloring of this interference graph enables simultaneous finite-difference perturbations that do not alias in any row, thereby reducing the number of function evaluations required to build a sparse Jacobian approximation for use in a Jacobian-Free Newton-Krylov (JFNK) method preconditioner.\n\n3. Define the speedup factor\n$$\n\\sigma = \\frac{m}{q},\n$$\nwhere $m$ is the number of species columns with at least one structurally nonzero Jacobian entry (equivalently, the number of species $j$ that appear as reactants in at least one reaction, i.e., at least one $k$ with $\\alpha_{jk}  0$), and $q$ is the number of colors produced by a greedy largest-degree-first coloring of the interference graph. The speedup $\\sigma$ quantifies the reduction in function evaluations needed to construct a sparse Jacobian approximation using graph coloring relative to a naive dense approach that perturbs each structurally nonzero column separately. Express $\\sigma$ as a dimensionless float.\n\n4. Implement a complete, runnable program that:\n   - Encodes each reaction mechanism using $n_s$, the matrix $\\alpha \\in \\mathbb{N}_0^{n_s \\times n_r}$, and the stoichiometric matrix $S \\in \\mathbb{Z}^{n_s \\times n_r}$.\n   - Builds the Jacobian sparsity pattern using only $(\\alpha, S)$ according to the condition from part 1.\n   - Constructs the interference graph and computes $q$ via a greedy largest-degree-first coloring.\n   - Computes $m$ and $\\sigma$ for each mechanism in the test suite.\n   - Produces a single line of output with the list of speedup values for all test cases, formatted as a comma-separated list enclosed in square brackets, with each float rounded to three decimal places (e.g., $[1.500,1.000,3.000]$).\n\nUse the following test suite of mechanisms with $n_s = 7$ species labeled $A,B,C,D,E,F,G$ mapped to indices $0,1,2,3,4,5,6$:\n\n- Case 1 (chain of bimolecular reactions; moderate coupling):\n  - Reaction $1$: $A + B \\rightarrow C$ with $\\alpha_{\\cdot,1} = [1,1,0,0,0,0,0]$ and $S_{\\cdot,1} = [-1,-1,+1,0,0,0,0]$.\n  - Reaction $2$: $C + D \\rightarrow E$ with $\\alpha_{\\cdot,2} = [0,0,1,1,0,0,0]$ and $S_{\\cdot,2} = [0,0,-1,-1,+1,0,0]$.\n  - Reaction $3$: $E + F \\rightarrow G$ with $\\alpha_{\\cdot,3} = [0,0,0,0,1,1,0]$ and $S_{\\cdot,3} = [0,0,0,0,-1,-1,+1]$.\n\n- Case 2 (tri-molecular and cross-coupled reactions; near-complete coupling):\n  - Reaction $1$: $A + B + C \\rightarrow D$ with $\\alpha_{\\cdot,1} = [1,1,1,0,0,0,0]$ and $S_{\\cdot,1} = [-1,-1,-1,+1,0,0,0]$.\n  - Reaction $2$: $A + D + E \\rightarrow F$ with $\\alpha_{\\cdot,2} = [1,0,0,1,1,0,0]$ and $S_{\\cdot,2} = [ -1,0,0,-1,-1,+1,0]$.\n  - Reaction $3$: $B + F + G \\rightarrow C$ with $\\alpha_{\\cdot,3} = [0,1,0,0,0,1,1]$ and $S_{\\cdot,3} = [0,-1,+1,0,0,-1,-1]$.\n\n- Case 3 (three parallel unimolecular reactions; minimal coupling):\n  - Reaction $1$: $A \\rightarrow B$ with $\\alpha_{\\cdot,1} = [1,0,0,0,0,0,0]$ and $S_{\\cdot,1} = [-1,+1,0,0,0,0,0]$.\n  - Reaction $2$: $C \\rightarrow D$ with $\\alpha_{\\cdot,2} = [0,0,1,0,0,0,0]$ and $S_{\\cdot,2} = [0,0,-1,+1,0,0,0]$.\n  - Reaction $3$: $E \\rightarrow F$ with $\\alpha_{\\cdot,3} = [0,0,0,0,1,0,0]$ and $S_{\\cdot,3} = [0,0,0,0,-1,+1,0]$.\n\nAll quantities in this problem are dimensionless for the purposes of algorithmic derivation and counting, and no physical units are required. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with each float rounded to three decimal places (e.g., $[1.500,1.000,3.000]$).",
            "solution": "The problem requires a four-part analysis of the Jacobian matrix associated with species source terms in a finite-rate chemistry model, culminating in a computational implementation to calculate a performance metric based on graph coloring. The problem is assessed to be valid as it is scientifically grounded in chemical kinetics and numerical analysis, is well-posed with a complete and consistent setup, and is expressed in objective, formal language.\n\n### Part 1: Jacobian Sparsity Condition\n\nThe Jacobian of the species source term vector $\\mathbf{f}(\\mathbf{c})$ is defined by its components $J_{ij}(\\mathbf{c}) = \\frac{\\partial f_i}{\\partial c_j}$. The source term for species $i$, $f_i(\\mathbf{c})$, is given by:\n$$\nf_i(\\mathbf{c}) = \\sum_{k=1}^{n_r} S_{ik} R_k(\\mathbf{c})\n$$\nwhere $S_{ik}$ is the stoichiometric coefficient of species $i$ in reaction $k$, and $R_k(\\mathbf{c})$ is the rate of reaction $k$. Differentiating with respect to the concentration of species $j$, $c_j$, we get:\n$$\nJ_{ij}(\\mathbf{c}) = \\frac{\\partial}{\\partial c_j} \\left( \\sum_{k=1}^{n_r} S_{ik} R_k(\\mathbf{c}) \\right) = \\sum_{k=1}^{n_r} S_{ik} \\frac{\\partial R_k(\\mathbf{c})}{\\partial c_j}\n$$\nThe rate of reaction $k$, following the law of mass action, is:\n$$\nR_k(\\mathbf{c}) = K_k \\prod_{l=1}^{n_s} c_l^{\\alpha_{lk}}\n$$\nwhere $K_k = A_k \\exp(-E_k/(RT))$ is the rate constant, and $\\alpha_{lk}$ is the reactant stoichiometric exponent for species $l$ in reaction $k$.\n\nTo find the sparsity pattern, we need a condition for when $J_{ij}$ can be structurally non-zero, meaning it is not identically zero for all possible positive concentrations $\\mathbf{c}$. This depends on the partial derivative $\\frac{\\partial R_k}{\\partial c_j}$. Using the product rule, this derivative is non-zero only if species $j$ is a reactant in reaction $k$, i.e., $\\alpha_{jk} > 0$. If we assume all reactant concentrations are positive, the derivative can be written as:\n$$\n\\frac{\\partial R_k(\\mathbf{c})}{\\partial c_j} = \\frac{\\alpha_{jk}}{c_j} R_k(\\mathbf{c})\n$$\nThis term is structurally non-zero if and only if $\\alpha_{jk} > 0$ (assuming a valid reaction with $K_k > 0$ and non-zero reactant concentrations).\n\nA specific term $S_{ik} \\frac{\\partial R_k}{\\partial c_j}$ in the summation for $J_{ij}$ is thus structurally non-zero if and only if two conditions are met simultaneously:\n1.  Species $i$ participates in reaction $k$, which means its net stoichiometric change is non-zero ($S_{ik} \\neq 0$).\n2.  Species $j$ is a reactant in reaction $k$, which means its stoichiometric exponent is positive ($\\alpha_{jk} > 0$).\n\nThe entire Jacobian entry $J_{ij}$ is a sum over all reactions. It is structurally non-zero if at least one term in the summation is structurally non-zero. Therefore, the necessary and sufficient condition for $J_{ij}(\\mathbf{c})$ to be structurally non-zero is:\n\n**There exists at least one reaction $k \\in \\{1, \\dots, n_r\\}$ such that $S_{ik} \\neq 0$ and $\\alpha_{jk} > 0$.**\n\nThis condition depends only on the stoichiometric matrix $S$ and the reactant exponent matrix $\\alpha$, allowing the determination of the Jacobian's sparsity pattern without numerical evaluation.\n\n### Part 2: Column-Interference Graph and Finite Differences\n\nThe column-interference graph $G = (V, E)$ for the Jacobian matrix $J$ is defined as follows:\n- The set of vertices $V$ corresponds to the columns of $J$, so $V = \\{1, \\dots, n_s\\}$, representing each chemical species.\n- An undirected edge $(p, q)$ connects vertices $p$ and $q$ ($p \\neq q$) if their corresponding columns in $J$ share at least one row index $i$ where both entries can be non-zero. Formally, $(p, q) \\in E$ if and only if there exists a row $i \\in \\{1, \\dots, n_s\\}$ such that $J_{ip} \\not\\equiv 0$ and $J_{iq} \\not\\equiv 0$ structurally.\n\nA proper coloring of this graph assigns a color to each vertex such that no two adjacent vertices have the same color. The utility of this coloring lies in optimizing the computation of a sparse Jacobian matrix using finite differences. To approximate the columns of $J$, one can perturb the concentration vector $\\mathbf{c}$ and evaluate the change in the source term vector $\\mathbf{f}$. A naive method perturbs each column $j$ separately:\n$$ J_{\\cdot, j} \\approx \\frac{\\mathbf{f}(\\mathbf{c} + \\epsilon \\mathbf{e}_j) - \\mathbf{f}(\\mathbf{c})}{\\epsilon} $$\nThis requires one function evaluation of $\\mathbf{f}$ per column being approximated.\n\nGraph coloring allows for simultaneous perturbations. All columns (vertices) assigned the same color are, by definition of a proper coloring, mutually non-adjacent. This means that for any pair of columns $p$ and $q$ in the same color group, there is no row $i$ where $J_{ip}$ and $J_{iq}$ are both structurally non-zero.\n\nWe can form a single perturbation vector $\\mathbf{d}$ by summing the individual perturbations for all columns $\\{j_1, j_2, \\dots, j_l\\}$ in a given color group: $\\mathbf{d} = \\sum_{k=1}^l \\epsilon_{j_k} \\mathbf{e}_{j_k}$. When we compute the finite difference $\\Delta\\mathbf{f} = \\mathbf{f}(\\mathbf{c} + \\mathbf{d}) - \\mathbf{f}(\\mathbf{c})$, the $i$-th component is, by first-order Taylor expansion, approximately:\n$$ \\Delta f_i \\approx \\sum_{k=1}^l J_{ij_k} \\epsilon_{j_k} $$\nDue to the non-interference property of the color group, for any given row $i$, at most one term $J_{ij_k}$ in this summation can be non-zero. Thus, the sum collapses to a single term, $\\Delta f_i \\approx J_{ip} \\epsilon_p$, where $p$ is the unique column in the group for which $J_{ip}$ is non-zero. This allows us to recover the value $J_{ip} \\approx \\Delta f_i / \\epsilon_p$ without aliasing from other simultaneous perturbations.\n\nIf the interference graph can be colored with $q$ colors, the entire sparse Jacobian can be constructed with only $q$ evaluations of the source term function $\\mathbf{f}$ (plus one for the unperturbed state), one for each color group.\n\n### Part 3: Speedup Factor\n\nThe speedup factor $\\sigma$ is defined as:\n$$\n\\sigma = \\frac{m}{q}\n$$\n- $m$: The number of columns of $J$ that are not structurally zero. As stated in the problem and confirmed by the analysis in Part 1, this is equivalent to the number of species that act as a reactant in at least one reaction ($\\exists k \\text{ such that } \\alpha_{jk} > 0$). This represents the number of function evaluations required by a direct finite-difference approach that intelligently skips all-zero columns.\n- $q$: The number of colors used by a greedy largest-degree-first coloring heuristic for the column-interference graph. This is an approximation of the graph's chromatic number and represents the number of function evaluations needed by the sparse coloring-based approach.\n\nThe factor $\\sigma$ thus measures the computational savings of the graph coloring method over a more straightforward (but still sparse-aware) finite-difference scheme.\n\n### Part 4: Algorithm Implementation\n\nThe implementation proceeds as follows:\n1.  For each test case, the matrices $\\alpha$ and $S$ are constructed.\n2.  The Jacobian sparsity pattern, an $n_s \\times n_s$ boolean matrix, is determined using the condition from Part 1.\n3.  The value of $m$ is calculated by counting the number of species $j$ for which the $j$-th row of the $\\alpha$ matrix contains at least one positive entry.\n4.  The adjacency matrix of the $n_s$-vertex column-interference graph is built by checking for row-wise overlaps in the Jacobian sparsity pattern for every pair of columns.\n5.  The degrees of all vertices in the interference graph are computed.\n6.  A greedy largest-degree-first coloring algorithm is applied:\n    a. Vertices are sorted in descending order of their degree.\n    b. Iterating through the sorted vertices, each vertex is assigned the smallest integer color not used by any of its already-colored neighbors.\n7.  The number of colors used, $q$, is determined from the result of the coloring.\n8.  The speedup $\\sigma = m/q$ is computed and stored.\n9.  Finally, the list of speedup values for all test cases is formatted and printed.\n```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main solver function that processes all test cases and prints the results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: chain of bimolecular reactions\n        {\n            \"ns\": 7,\n            \"alpha_cols\": [\n                [1, 1, 0, 0, 0, 0, 0],\n                [0, 0, 1, 1, 0, 0, 0],\n                [0, 0, 0, 0, 1, 1, 0]\n            ],\n            \"S_cols\": [\n                [-1, -1, 1, 0, 0, 0, 0],\n                [0, 0, -1, -1, 1, 0, 0],\n                [0, 0, 0, 0, -1, -1, 1]\n            ]\n        },\n        # Case 2: tri-molecular and cross-coupled reactions\n        {\n            \"ns\": 7,\n            \"alpha_cols\": [\n                [1, 1, 1, 0, 0, 0, 0],\n                [1, 0, 0, 1, 1, 0, 0],\n                [0, 1, 0, 0, 0, 1, 1]\n            ],\n            \"S_cols\": [\n                [-1, -1, -1, 1, 0, 0, 0],\n                [-1, 0, 0, -1, -1, 1, 0],\n                [0, -1, 1, 0, 0, -1, -1]\n            ]\n        },\n        # Case 3: three parallel unimolecular reactions\n        {\n            \"ns\": 7,\n            \"alpha_cols\": [\n                [1, 0, 0, 0, 0, 0, 0],\n                [0, 0, 1, 0, 0, 0, 0],\n                [0, 0, 0, 0, 1, 0, 0]\n            ],\n            \"S_cols\": [\n                [-1, 1, 0, 0, 0, 0, 0],\n                [0, 0, -1, 1, 0, 0, 0],\n                [0, 0, 0, 0, -1, 1, 0]\n            ]\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        ns = case[\"ns\"]\n        # The problem provides data as columns of the matrices alpha and S.\n        # We transpose them to get ns x nr matrices.\n        alpha = np.array(case[\"alpha_cols\"]).T\n        S = np.array(case[\"S_cols\"]).T\n        \n        result = calculate_speedup(ns, alpha, S)\n        results.append(f\"{result:.3f}\")\n\n    print(f\"[{','.join(results)}]\")\n\ndef calculate_speedup(ns, alpha, S):\n    \"\"\"\n    Calculates the speedup factor sigma for a single reaction mechanism.\n    \n    Args:\n        ns (int): Number of species.\n        alpha (np.ndarray): Reactant exponent matrix (ns x nr).\n        S (np.ndarray): Stoichiometric matrix (ns x nr).\n        \n    Returns:\n        float: The computed speedup factor sigma.\n    \"\"\"\n    if ns == 0:\n        return 0.0\n        \n    nr = S.shape[1]\n\n    # Part 1: Build Jacobian sparsity pattern based on derived condition\n    J_sparsity = np.zeros((ns, ns), dtype=bool)\n    for i in range(ns):\n        for j in range(ns):\n            # Condition: exists k s.t. S[i,k] != 0 AND alpha[j,k] > 0\n            for k in range(nr):\n                if S[i, k] != 0 and alpha[j, k] > 0:\n                    J_sparsity[i, j] = True\n                    break # Break inner loop once non-zero entry is confirmed\n\n    # Part 3: Compute m\n    # m is the number of species j that are reactants in at least one reaction\n    m = np.sum(np.any(alpha > 0, axis=1))\n\n    if m == 0:\n        return 0.0\n\n    # Part 2: Build the column-interference graph\n    adj_matrix = np.zeros((ns, ns), dtype=bool)\n    for p in range(ns):\n        for q in range(p + 1, ns):\n            # An edge (p,q) exists if columns p and q share a non-zero row\n            if np.any(np.logical_and(J_sparsity[:, p], J_sparsity[:, q])):\n                adj_matrix[p, q] = True\n                adj_matrix[q, p] = True\n\n    # Part 3/4: Greedy largest-degree-first coloring to find q\n    degrees = np.sum(adj_matrix, axis=1)\n    # Sort all ns vertices by degree, descending\n    sorted_vertices = np.argsort(degrees)[::-1]\n\n    colors = -np.ones(ns, dtype=int)\n    max_color = -1\n    \n    for u in sorted_vertices:\n        neighbor_colors = set()\n        # Find neighbors of u that are already colored\n        for v in range(ns):\n            if adj_matrix[u, v] and colors[v] != -1:\n                neighbor_colors.add(colors[v])\n        \n        # Find the smallest non-negative integer color not in neighbor_colors\n        c = 0\n        while c in neighbor_colors:\n            c += 1\n        colors[u] = c\n        if c > max_color:\n            max_color = c\n            \n    # The number of colors used is max_color + 1\n    q = max_color + 1\n\n    # Final calculation of speedup sigma\n    sigma = m / q\n    return sigma\n\nsolve()\n```",
            "answer": "[1.500,1.167,3.000]"
        }
    ]
}