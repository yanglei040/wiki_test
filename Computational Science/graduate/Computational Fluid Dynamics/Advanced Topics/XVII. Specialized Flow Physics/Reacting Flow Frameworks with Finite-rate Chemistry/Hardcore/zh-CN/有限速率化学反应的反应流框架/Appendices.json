{
    "hands_on_practices": [
        {
            "introduction": "这项实践将巩固您对反应流基本热力学原理的理解。通过从第一性原理出发，推导反应气体微团的压力演化方程，您将直接建立起热力学第一定律与化学成分、温度变化之间的联系，这是任何反应流模拟中的一个关键环节。",
            "id": "3356521",
            "problem": "考虑一个空间均匀、绝热、无粘性、不导热的Lagrangian理想气体混合物气团，该气团由 $N$ 种化学组分构成，索引为 $k=1,\\dots,N$。设组分质量分数为 $Y_k$ (满足 $\\sum_{k=1}^{N} Y_k = 1$)，混合物密度为 $\\rho$，压力为 $p$，温度为 $T$。每种组分 $k$ 都有分子量 $W_k$、单独气体常数 $R_k = R_u/W_k$ (其中 $R_u$ 是普适气体常数)、依赖于温度的定压比热 $c_{p,k}(T)$ 和定容比热 $c_{v,k}(T)$，以及遵循理想气体热量关系 $h_k(T) = e_k(T) + R_k T$ 的温度热化学函数 $h_k(T)$ 和 $e_k(T)$。通过质量加权和定义混合物的性质：\n$$\nc_p(T,\\mathbf{Y}) = \\sum_{k=1}^{N} Y_k\\,c_{p,k}(T),\\quad\nc_v(T,\\mathbf{Y}) = \\sum_{k=1}^{N} Y_k\\,c_{v,k}(T),\\quad\nR(\\mathbf{Y}) = \\sum_{k=1}^{N} Y_k\\,R_k,\n$$\n以及混合物比热比\n$$\n\\gamma(T,\\mathbf{Y}) = \\frac{c_p(T,\\mathbf{Y})}{c_v(T,\\mathbf{Y})}.\n$$\n假设混合物遵循理想气体状态方程 $p = \\rho\\,R(\\mathbf{Y})\\,T$，并且由于有限速率化学反应，气团经历组分变化 $\\dot{Y}_k = dY_k/dt$ 和温度变化率 $\\dot{T} = dT/dt$。仅使用理想气体混合物假设和第一性原理（移动气团的热力学第一定律和质量守恒），完成以下任务：\n\n- 解释混合物的 $c_p$、$c_v$ 和 $\\gamma$ 如何依赖于 $Y_k$ 和 $T$。\n- 为该Lagrangian反应气团推导压力物质时间导数 $\\frac{dp}{dt}$ 的闭合形式表达式，该表达式应完全用 $\\dot{T}$、$\\dot{Y}_k$ 和 $T$ 的热化学函数表示。\n\n你最终的 $\\frac{dp}{dt}$ 表达式必须写成一个单一的解析公式，用 $\\rho$、$c_p(T,\\mathbf{Y})$、$h_k(T)$、$\\dot{T}$ 和 $\\dot{Y}_k$ 表示。不需要进行数值计算或四舍五入。将最终答案表示为所要求的单一解析表达式。",
            "solution": "在进行解答之前，需对问题进行验证。\n\n### 第1步：提取已知条件\n- **系统：** 一个空间均匀、绝热、无粘性、不导热的Lagrangian理想气体混合物气团。\n- **组分：** $N$ 种化学组分，索引为 $k=1,\\dots,N$。\n- **状态变量：** 组分质量分数 $Y_k$ (满足 $\\sum_{k=1}^{N} Y_k = 1$)，混合物密度 $\\rho$，压力 $p$，温度 $T$。\n- **组分性质：** 分子量 $W_k$，单独气体常数 $R_k = R_u/W_k$，依赖于温度的定压比热 $c_{p,k}(T)$，依赖于温度的定容比热 $c_{v,k}(T)$，比焓 $h_k(T)$，以及比内能 $e_k(T)$。\n- **本构关系：** 理想气体热量关系 $h_k(T) = e_k(T) + R_k T$。\n- **混合物性质：**\n  - $c_p(T,\\mathbf{Y}) = \\sum_{k=1}^{N} Y_k\\,c_{p,k}(T)$\n  - $c_v(T,\\mathbf{Y}) = \\sum_{k=1}^{N} Y_k\\,c_{v,k}(T)$\n  - $R(\\mathbf{Y}) = \\sum_{k=1}^{N} Y_k\\,R_k$\n  - $\\gamma(T,\\mathbf{Y}) = \\frac{c_p(T,\\mathbf{Y})}{c_v(T,\\mathbf{Y})}$\n- **控制方程：** 混合物理想气体状态方程 $p = \\rho\\,R(\\mathbf{Y})\\,T$。\n- **过程信息：** 有限速率化学反应导致组分变化 $\\dot{Y}_k = dY_k/dt$ 和温度变化率 $\\dot{T} = dT/dt$。\n- **目标：**\n  1. 解释混合物性质 $c_p$、$c_v$ 和 $\\gamma$ 如何依赖于 $Y_k$ 和 $T$。\n  2. 推导压力物质时间导数 $dp/dt$ 的闭合形式表达式，用 $\\rho$、$c_p(T,\\mathbf{Y})$、$h_k(T)$、$\\dot{T}$ 和 $\\dot{Y}_k$ 表示。\n\n### 第2步：使用提取的已知条件进行验证\n检查问题的有效性：\n- **科学依据：** 问题基于应用于理想气体混合物的热力学和化学动力学的基本原理。所有定义和方程（例如，理想气体定律，混合物性质的定义）在反应流和燃烧领域都是标准的。该设定在科学上是合理的。\n- **适定性：** 问题要求基于一组给定的原理和定义进行推导。所有必要的信息似乎都已提供。目标明确，预期会得到一个唯一的解析结果。\n- **客观性：** 问题以精确、客观的语言陈述，没有主观论断或模糊不清之处。\n- **完整性与一致性：** 问题提供了一套自洽的假设（绝热、无粘性、理想气体等）和定义。没有明显的矛盾。空间均匀的Lagrangian气团的概念是化学动力学建模中的一个标准简化（例如，零维反应器模型）。\n- **可行性：** 在反应流的理论和计算建模背景下，该场景在物理上是可信的。\n- **结构：** 问题结构良好，不包含任何琐碎之处或循环论证。推导过程需要多步应用第一性原理。\n\n### 第3步：结论与行动\n问题被判定为**有效**。这是一个理论反应流物理学中的标准、适定问题。将提供解答。\n\n### 解答\n\n按照问题陈述的要求，解答分为两部分。\n\n**第1部分：热化学性质的依赖关系**\n\n混合物的热化学性质被定义为单个组分性质的质量加权平均值。\n\n- 混合物的定压比热 $c_p(T,\\mathbf{Y})$ 定义为 $c_p(T,\\mathbf{Y}) = \\sum_{k=1}^{N} Y_k c_{p,k}(T)$。单个组分的比热 $c_{p,k}$ 是温度 $T$ 的函数。混合物性质 $c_p$ 是这些函数的线性组合，其系数为质量分数 $Y_k$。因此，$c_p$ 同时依赖于温度 $T$ 和组分向量 $\\mathbf{Y} = (Y_1, \\dots, Y_N)$。\n\n- 类似地，混合物的定容比热 $c_v(T,\\mathbf{Y})$ 定义为 $c_v(T,\\mathbf{Y}) = \\sum_{k=1}^{N} Y_k c_{v,k}(T)$。与 $c_p$ 的原因相同，混合物性质 $c_v$ 也同时依赖于温度 $T$（通过 $c_{v,k}(T)$）和组分 $\\mathbf{Y}$（通过权重 $Y_k$）。\n\n- 比热比 $\\gamma(T,\\mathbf{Y})$ 定义为 $\\gamma(T,\\mathbf{Y}) = \\frac{c_p(T,\\mathbf{Y})}{c_v(T,\\mathbf{Y})}$。由于其分子和分母都依赖于 $T$ 和 $\\mathbf{Y}$，因此比值 $\\gamma$ 也是温度和组分的函数。\n\n**第2部分：压力导数的推导**\n\n目标是推导压力物质时间导数 $dp/dt$ 的表达式。最直接的方法是将压力的演化与混合物比焓的演化联系起来。\n\n首先，我们为指定系统推导一个基本的热力学关系。对于一个质量恒为 $m$ 的封闭Lagrangian气团，热力学第一定律是：\n$$ dE = \\delta Q - \\delta W $$\n其中 $E$ 是总内能，$\\delta Q$ 是系统吸收的热量，$\\delta W$ 是系统对外做的功。问题陈述该气团是绝热的，所以 $\\delta Q=0$。膨胀功为 $\\delta W = p dV$，其中 $V$ 是气团的体积。\n因此，第一定律简化为 $dE = -p dV$。\n用比值量表示，$E = m e$ 和 $V = m v = m/\\rho$，其中 $e$ 是比内能，$v$ 是比容，$\\rho$ 是密度。由于质量 $m$ 是恒定的：\n$$ m \\, de = -p \\, d(m/\\rho) = -pm \\, d(\\rho^{-1}) = -pm (-\\rho^{-2} d\\rho) = \\frac{mp}{\\rho^2} d\\rho $$\n两边同除以 $m$，我们得到气团的比能方程：\n$$ de = \\frac{p}{\\rho^2} d\\rho $$\n混合物的比焓 $h$ 定义为 $h = e + p/\\rho$。其微分为：\n$$ dh = de + d(p/\\rho) = de + \\frac{1}{\\rho}dp - \\frac{p}{\\rho^2}d\\rho $$\n代入 $de$ 的表达式：\n$$ dh = \\left(\\frac{p}{\\rho^2} d\\rho\\right) + \\frac{1}{\\rho}dp - \\frac{p}{\\rho^2}d\\rho = \\frac{1}{\\rho}dp $$\n这就得到了简洁而有力的关系式 $dp = \\rho dh$。对于一个Lagrangian气团，这意味着物质时间导数之间有如下关系：\n$$ \\frac{dp}{dt} = \\rho \\frac{dh}{dt} $$\n现在我们必须找到 $dh/dt$ 的表达式。混合物的比焓是各组分比焓的质量加权和：\n$$ h(T, \\mathbf{Y}) = \\sum_{k=1}^{N} Y_k h_k(T) $$\n我们对其求物质时间导数，并应用乘法法则：\n$$ \\frac{dh}{dt} = \\frac{d}{dt} \\left( \\sum_{k=1}^{N} Y_k h_k(T) \\right) = \\sum_{k=1}^{N} \\left( \\frac{dY_k}{dt} h_k(T) + Y_k \\frac{dh_k(T)}{dt} \\right) $$\n$dY_k/dt$ 项是组分生成率，记为 $\\dot{Y}_k$。对于 $h_k(T)$ 的导数，我们使用链式法则：$dh_k(T)/dt = (dh_k/dT)(dT/dt)$。\n根据定义，组分 $k$ 的定压比热为 $c_{p,k}(T) = dh_k/dT$。温度变化率由 $\\dot{T} = dT/dt$ 给出。\n将这些代入 $dh/dt$ 的表达式中：\n$$ \\frac{dh}{dt} = \\sum_{k=1}^{N} \\dot{Y}_k h_k(T) + \\sum_{k=1}^{N} Y_k c_{p,k}(T) \\frac{dT}{dt} $$\n提取公因子 $dT/dt$：\n$$ \\frac{dh}{dt} = \\sum_{k=1}^{N} \\dot{Y}_k h_k(T) + \\left( \\sum_{k=1}^{N} Y_k c_{p,k}(T) \\right) \\dot{T} $$\n括号中的项是混合物定压比热 $c_p(T, \\mathbf{Y})$ 的定义。\n$$ \\frac{dh}{dt} = \\sum_{k=1}^{N} \\dot{Y}_k h_k(T) + c_p(T, \\mathbf{Y}) \\dot{T} $$\n最后，我们将此结果代回压力演化方程 $\\frac{dp}{dt} = \\rho \\frac{dh}{dt}$ 中：\n$$ \\frac{dp}{dt} = \\rho \\left( c_p(T, \\mathbf{Y}) \\dot{T} + \\sum_{k=1}^{N} \\dot{Y}_k h_k(T) \\right) $$\n重新整理后得到压力的物质导数的最终表达式，它显示了压力对温度变化率和因化学反应引起的组分变化率的依赖关系：\n$$ \\frac{dp}{dt} = \\rho c_p(T, \\mathbf{Y}) \\dot{T} + \\rho \\sum_{k=1}^{N} \\dot{Y}_k h_k(T) $$\n该表达式符合要求的形式，完全由指定的变量和热化学函数定义。",
            "answer": "$$\n\\boxed{\\frac{dp}{dt} = \\rho c_p(T, \\mathbf{Y}) \\dot{T} + \\rho \\sum_{k=1}^{N} \\dot{Y}_k h_k(T)}\n$$"
        },
        {
            "introduction": "刚性化学动力学的数值求解是反应流的一个标志性难题，其关键在于使用需要化学源项雅可比矩阵的隐式时间积分格式。本练习将指导您针对一个包含复杂的三体反应和压力依赖的坠落反应的通用反应机理，解析推导这一关键矩阵。掌握此推导是构建稳健、精确的化学求解器的核心。",
            "id": "3356493",
            "problem": "考虑一个在计算流体动力学 (CFD) 中由组分摩尔浓度 $C_{i}$（$i \\in \\{1,\\dots,N_{s}\\}$）描述的均匀、等温反应混合物，其温度 $T$ 和体积固定。该混合物经历 $N_{r}$ 个可逆基元反应，反应索引为 $r \\in \\{1,\\dots,N_{r}\\}$，反应物化学计量系数为 $\\nu_{ir}^{\\prime}$，产物化学计量系数为 $\\nu_{ir}^{\\prime\\prime}$，净化学计量系数为 $\\nu_{ir} \\equiv \\nu_{ir}^{\\prime\\prime} - \\nu_{ir}^{\\prime}$。组分 $k$ 的摩尔生成速率，记为 $\\dot{\\omega}_{k}$，由以下化学计量总和给出\n$$\n\\dot{\\omega}_{k} \\;=\\; \\sum_{r=1}^{N_{r}} \\nu_{kr}\\, q_{r},\n$$\n其中反应进程速率 $q_{r}$ 为\n$$\nq_{r} \\;=\\; R_{r}^{+} \\;-\\; R_{r}^{-}.\n$$\n假设所有反应均遵循质量作用动力学，并在适用时进行三体和压力衰减修正，因此\n$$\nR_{r}^{+} \\;=\\; k_{f,r}^{*}(T,C)\\,\\prod_{i=1}^{N_{s}} C_{i}^{\\nu_{ir}^{\\prime}}, \\qquad\nR_{r}^{-} \\;=\\; k_{r,r}^{*}(T,C)\\,\\prod_{i=1}^{N_{s}} C_{i}^{\\nu_{ir}^{\\prime\\prime}},\n$$\n并通过基于浓度的平衡常数 $K_{c,r}(T)$ 强制执行细致平衡，即 $k_{r,r}^{*}(T,C) = k_{f,r}^{*}(T,C)/K_{c,r}(T)$。此处，$k_{f,r}^{*}(T,C)$ 是一个有效正向反应速率系数，对于三体反应和压力衰减反应，它依赖于浓度，但对于普通反应，它仅依赖于温度 $T$。定义反应 $r$ 的有效碰撞物浓度为\n$$\n[M]_{r} \\;=\\; \\sum_{i=1}^{N_{s}} \\alpha_{ir}\\, C_{i},\n$$\n其中给定了三体效率 $\\alpha_{ir}$（如果未指定，则默认为 $\\alpha_{ir}=1$）。对于普通反应，$k_{f,r}^{*}(T,C)=k_{f,r}(T)$。对于三体反应（非压力衰减），$k_{f,r}^{*}(T,C)=k_{f,r}(T)\\,[M]_{r}$。对于压力衰减反应，设低压极限为 $k_{0,r}(T)$，高压极限为 $k_{\\infty,r}(T)$，折合压力为\n$$\nP_r \\;=\\; \\frac{k_{0,r}(T)\\,[M]_{r}}{k_{\\infty,r}(T)}.\n$$\n设压力衰减展宽因子为 $F_{r}(P_r,T)$（例如，Troe 类型），因此\n$$\nk_{f,r}^{*}(T,C) \\;=\\; k_{\\infty,r}(T)\\;F_{r}(P_r,T)\\;\\frac{P_r}{1+P_r}.\n$$\n假设 $T$ 是固定的，因此 $k_{f,r}(T)$、$k_{0,r}(T)$、$k_{\\infty,r}(T)$ 和 $K_{c,r}(T)$ 相对于 $C$ 是常数，只有 $[M]_{r}$（并因此通过 $P_r$ 影响 $P_r$ 和 $F_{r}$）将浓度依赖性引入到 $k_{f,r}^{*}(T,C)$ 中。\n\n引入反应类型指示函数 $\\chi_{r}^{\\mathrm{ord}}$、$\\chi_{r}^{\\mathrm{TB}}$ 和 $\\chi_{r}^{\\mathrm{FO}}$，如果反应 $r$ 分别是普通反应、三体反应（非压力衰减）或压力衰减反应，则其值为 $1$，否则为 $0$，且 $\\chi_{r}^{\\mathrm{ord}}+\\chi_{r}^{\\mathrm{TB}}+\\chi_{r}^{\\mathrm{FO}}=1$。\n\n从这些定义和基本的质量作用动力学出发，推导在固定 $T$ 下组分雅可比矩阵的解析项 $\\partial \\dot{\\omega}_{k}/\\partial C_{j}$，并显式地考虑三体和压力衰减的依赖关系。您的推导必须明确应用乘法法则和链式法则，并确定 $[M]_{r}$ 和 $P_r$ 对 $\\partial k_{f,r}^{*}/\\partial C_{j}$ 的贡献。您可以将 $\\partial F_{r}/\\partial P_r$ 保留为符号形式。然后，根据推导出的结构，简要解释哪些索引对 $(k,j)$ 会产生非零的雅可比矩阵项，以及与普通机理相比，三体效率 $\\alpha_{ir}$ 和压力衰减反应如何改变稀疏性。\n\n请以关于 $\\nu_{ir}^{\\prime}$、$\\nu_{ir}^{\\prime\\prime}$、$\\nu_{ir}$、$k_{f,r}(T)$、$k_{0,r}(T)$、$k_{\\infty,r}(T)$、$K_{c,r}(T)$、$F_{r}(P_r,T)$、$\\partial F_{r}/\\partial P_r$、$\\alpha_{ir}$ 和 $C_{i}$ 的单一封闭形式解析表达式的形式提供您的最终结果。不需要进行数值计算，也不需要四舍五入。最终答案必须是单一的解析表达式。",
            "solution": "目标是为一个均匀、等温、等容的反应体系推导组分雅可比矩阵项 $\\frac{\\partial \\dot{\\omega}_{k}}{\\partial C_{j}}$ 的解析表达式，其中 $\\dot{\\omega}_{k}$ 是组分 $k$ 的摩尔生成速率，而 $C_{j}$ 是组分 $j$ 的摩尔浓度。该推导必须考虑普通反应、三体反应和压力依赖的压力衰减反应。\n\n组分 $k$ 的摩尔生成速率由下式给出\n$$\n\\dot{\\omega}_{k} = \\sum_{r=1}^{N_{r}} \\nu_{kr}\\, q_{r}\n$$\n其中 $\\nu_{kr}$ 是组分 $k$ 在反应 $r$ 中的净化学计量系数，而 $q_{r}$ 是反应 $r$ 的反应进程速率。对 $C_{j}$ 的导数可通过对该求和式逐项微分得到：\n$$\n\\frac{\\partial \\dot{\\omega}_{k}}{\\partial C_{j}} = \\sum_{r=1}^{N_{r}} \\nu_{kr} \\frac{\\partial q_{r}}{\\partial C_{j}}\n$$\n反应进程速率 $q_{r}$ 是正向和逆向速率之差，$q_{r} = R_{r}^{+} - R_{r}^{-}$。因此，其导数为：\n$$\n\\frac{\\partial q_{r}}{\\partial C_{j}} = \\frac{\\partial R_{r}^{+}}{\\partial C_{j}} - \\frac{\\partial R_{r}^{-}}{\\partial C_{j}}\n$$\n正向和逆向速率由质量作用动力学给出：\n$$\nR_{r}^{+} = k_{f,r}^{*}(T,C)\\,\\prod_{i=1}^{N_{s}} C_{i}^{\\nu_{ir}^{\\prime}} \\quad \\text{和} \\quad R_{r}^{-} = k_{r,r}^{*}(T,C)\\,\\prod_{i=1}^{N_{s}} C_{i}^{\\nu_{ir}^{\\prime\\prime}}\n$$\n利用细致平衡原理，$k_{r,r}^{*} = k_{f,r}^{*} / K_{c,r}(T)$，逆向速率为 $R_{r}^{-} = \\frac{k_{f,r}^{*}(T,C)}{K_{c,r}(T)}\\,\\prod_{i=1}^{N_{s}} C_{i}^{\\nu_{ir}^{\\prime\\prime}}$。由于温度 $T$ 固定，平衡常数 $K_{c,r}(T)$ 相对于浓度变化是常数。\n\n应用乘法法则对 $R_{r}^{+}$ 进行关于 $C_{j}$ 的微分：\n$$\n\\frac{\\partial R_{r}^{+}}{\\partial C_{j}} = \\left(\\frac{\\partial k_{f,r}^{*}}{\\partial C_{j}}\\right) \\left(\\prod_{i=1}^{N_{s}} C_{i}^{\\nu_{ir}^{\\prime}}\\right) + k_{f,r}^{*} \\left(\\frac{\\partial}{\\partial C_{j}}\\prod_{i=1}^{N_{s}} C_{i}^{\\nu_{ir}^{\\prime}}\\right)\n$$\n浓度乘积项的导数为：\n$$\n\\frac{\\partial}{\\partial C_{j}}\\prod_{i=1}^{N_{s}} C_{i}^{\\nu_{ir}^{\\prime}} = \\frac{\\nu_{jr}^{\\prime}}{C_{j}} \\prod_{i=1}^{N_{s}} C_{i}^{\\nu_{ir}^{\\prime}}\n$$\n这里假设 $C_j > 0$。将其代回可得：\n$$\n\\frac{\\partial R_{r}^{+}}{\\partial C_{j}} = \\frac{\\partial k_{f,r}^{*}}{\\partial C_{j}} \\frac{R_{r}^{+}}{k_{f,r}^{*}} + k_{f,r}^{*} \\frac{\\nu_{jr}^{\\prime}}{C_{j}} \\frac{R_{r}^{+}}{k_{f,r}^{*}} = \\left( \\frac{1}{k_{f,r}^{*}}\\frac{\\partial k_{f,r}^{*}}{\\partial C_{j}} + \\frac{\\nu_{jr}^{\\prime}}{C_{j}} \\right) R_{r}^{+}\n$$\n类似地，对于逆向反应速率 $R_{r}^{-}$：\n$$\n\\frac{\\partial R_{r}^{-}}{\\partial C_{j}} = \\left( \\frac{1}{k_{f,r}^{*}}\\frac{\\partial k_{f,r}^{*}}{\\partial C_{j}} + \\frac{\\nu_{jr}^{\\prime\\prime}}{C_{j}} \\right) R_{r}^{-}\n$$\n合并这些结果可得到反应进程速率的导数：\n$$\n\\frac{\\partial q_{r}}{\\partial C_{j}} = \\left( \\frac{1}{k_{f,r}^{*}}\\frac{\\partial k_{f,r}^{*}}{\\partial C_{j}} + \\frac{\\nu_{jr}^{\\prime}}{C_{j}} \\right) R_{r}^{+} - \\left( \\frac{1}{k_{f,r}^{*}}\\frac{\\partial k_{f,r}^{*}}{\\partial C_{j}} + \\frac{\\nu_{jr}^{\\prime\\prime}}{C_{j}} \\right) R_{r}^{-}\n$$\n整理各项可得：\n$$\n\\frac{\\partial q_{r}}{\\partial C_{j}} = \\frac{1}{k_{f,r}^{*}}\\frac{\\partial k_{f,r}^{*}}{\\partial C_{j}}(R_{r}^{+} - R_{r}^{-}) + \\frac{1}{C_{j}}(\\nu_{jr}^{\\prime}R_{r}^{+} - \\nu_{jr}^{\\prime\\prime}R_{r}^{-}) = \\frac{q_r}{k_{f,r}^{*}}\\frac{\\partial k_{f,r}^{*}}{\\partial C_{j}} + \\frac{1}{C_{j}}(\\nu_{jr}^{\\prime}R_{r}^{+} - \\nu_{jr}^{\\prime\\prime}R_{r}^{-})\n$$\n剩下的任务是推导 $\\frac{\\partial k_{f,r}^{*}}{\\partial C_{j}}$。速率系数 $k_{f,r}^{*}$ 仅通过有效碰撞物浓度 $[M]_{r} = \\sum_{i=1}^{N_{s}} \\alpha_{ir}\\, C_{i}$ 依赖于浓度。使用链式法则：\n$$\n\\frac{\\partial k_{f,r}^{*}}{\\partial C_{j}} = \\frac{\\partial k_{f,r}^{*}}{\\partial [M]_{r}} \\frac{\\partial [M]_{r}}{\\partial C_{j}}\n$$\n$[M]_r$ 对 $C_j$ 的导数就是三体效率 $\\alpha_{jr}$：\n$$\n\\frac{\\partial [M]_{r}}{\\partial C_{j}} = \\frac{\\partial}{\\partial C_{j}} \\sum_{i=1}^{N_s} \\alpha_{ir} C_i = \\alpha_{jr}\n$$\n导数 $\\frac{\\partial k_{f,r}^{*}}{\\partial [M]_{r}}$ 取决于反应类型：\n1.  对于普通反应 ($\\chi_{r}^{\\mathrm{ord}}=1$)，$k_{f,r}^{*} = k_{f,r}(T)$，它相对于 $[M]_r$ 是常数。因此，$\\frac{\\partial k_{f,r}^{*}}{\\partial [M]_{r}} = 0$。\n2.  对于三体反应 ($\\chi_{r}^{\\mathrm{TB}}=1$)，$k_{f,r}^{*} = k_{f,r}(T)\\,[M]_{r}$。因此，$\\frac{\\partial k_{f,r}^{*}}{\\partial [M]_{r}} = k_{f,r}(T)$。\n3.  对于压力衰减反应 ($\\chi_{r}^{\\mathrm{FO}}=1$)，$k_{f,r}^{*} = k_{\\infty,r}(T)\\;F_{r}(P_r,T)\\;\\frac{P_r}{1+P_r}$，其中折合压力为 $P_r = \\frac{k_{0,r}(T)\\,[M]_{r}}{k_{\\infty,r}(T)}$。我们再次应用链式法则：$\\frac{\\partial k_{f,r}^{*}}{\\partial [M]_{r}} = \\frac{\\partial k_{f,r}^{*}}{\\partial P_r}\\frac{\\partial P_r}{\\partial [M]_{r}}$。\n    首先，$\\frac{\\partial P_r}{\\partial [M]_{r}} = \\frac{k_{0,r}}{k_{\\infty,r}}$。\n    其次，对 $k_{f,r}^{*}(P_r)$ 使用乘法法则：\n    $$\n    \\frac{\\partial k_{f,r}^{*}}{\\partial P_r} = \\frac{\\partial}{\\partial P_r} \\left( k_{\\infty,r} F_r \\frac{P_r}{1+P_r} \\right) = k_{\\infty,r} \\left[ \\frac{\\partial F_r}{\\partial P_r} \\frac{P_r}{1+P_r} + F_r \\frac{\\partial}{\\partial P_r}\\left(\\frac{P_r}{1+P_r}\\right)\\right]\n    $$\n    Lindemann-Hinshelwood 因子的导数是 $\\frac{\\partial}{\\partial P_r}(\\frac{P_r}{1+P_r}) = \\frac{1}{(1+P_r)^2}$。\n    将其代入可得：\n    $$\n    \\frac{\\partial k_{f,r}^{*}}{\\partial P_r} = k_{\\infty,r} \\left[ \\frac{\\partial F_r}{\\partial P_r} \\frac{P_r}{1+P_r} + \\frac{F_r}{(1+P_r)^2} \\right]\n    $$\n    因此，对于压力衰减反应：\n    $$\n    \\frac{\\partial k_{f,r}^{*}}{\\partial [M]_{r}} = \\left( k_{\\infty,r} \\left[ \\frac{\\partial F_r}{\\partial P_r} \\frac{P_r}{1+P_r} + \\frac{F_r}{(1+P_r)^2} \\right] \\right) \\left( \\frac{k_{0,r}}{k_{\\infty,r}} \\right) = k_{0,r} \\left[ \\frac{\\partial F_r}{\\partial P_r} \\frac{P_r}{1+P_r} + \\frac{F_r}{(1+P_r)^2} \\right]\n    $$\n使用指示函数合并这些情况：\n$$\n\\frac{\\partial k_{f,r}^{*}}{\\partial C_{j}} = \\alpha_{jr} \\left( \\chi_{r}^{\\mathrm{TB}} k_{f,r} + \\chi_{r}^{\\mathrm{FO}} k_{0,r} \\left[ \\frac{\\partial F_r}{\\partial P_r} \\frac{P_r}{1+P_r} + \\frac{F_r}{(1+P_r)^2} \\right] \\right)\n$$\n将所有表达式代回到 $\\frac{\\partial \\dot{\\omega}_{k}}{\\partial C_{j}}$ 的方程中，并用基本量表示 $R_r^{\\pm}$ 和 $q_r$，我们便可得到雅可比矩阵项的最终解析形式。\n\n推导出的雅可比矩阵的结构揭示了组分之间的耦合关系。雅可比矩阵项 $\\frac{\\partial \\dot{\\omega}_{k}}{\\partial C_{j}}$ 非零，如果存在至少一个反应 $r$ 产生了依赖关系。\n一个反应 $r$ 产生非零项，如果组分 $k$ 参与了该反应（即 $\\nu_{kr} \\neq 0$），并且满足以下任一条件：\n1. 组分 $j$ 作为反应物或产物参与了反应 $r$（即 $\\nu_{jr}' \\neq 0$ 或 $\\nu_{jr}'' \\neq 0$）。这是标准的“直接”耦合。\n2. 反应 $r$ 是三体反应或压力衰减反应，且组分 $j$ 作为具有非零效率的三体碰撞物（即 $\\alpha_{jr} \\neq 0$）。这是一种“间接”耦合。\n\n在仅包含普通反应的机理中，雅可比矩阵是稀疏的。一个非零项 $\\frac{\\partial \\dot{\\omega}_{k}}{\\partial C_{j}}$ 仅当组分 $k$ 和 $j$ 出现在同一个反应中时才存在。三体反应和压力衰减反应的引入显著降低了这种稀疏性。如果一个组分 $j$ 对反应 $r$ 具有非零的三体效率 $\\alpha_{jr}$（这通常是默认情况，$\\alpha_{jr}=1$），它在组分 $j$ 和参与反应 $r$ 的每个组分 $k$ 之间建立了耦合，即使 $j$ 本身不是反应物或产物。这意味着单个三体反应可能为许多 $(k,j)$ 对产生非零项，这可能使雅可比矩阵的行变得稠密，从而增加了求解系统的计算成本。\n\n下面给出了雅可比矩阵项的完整解析表达式。",
            "answer": "$$\n\\boxed{\\frac{\\partial \\dot{\\omega}_{k}}{\\partial C_{j}} = \\sum_{r=1}^{N_{r}} \\nu_{kr} \\left\\{ \\begin{array}{l} \\frac{1}{C_j} \\left( \\chi_{r}^{\\mathrm{ord}}k_{f,r} + \\chi_{r}^{\\mathrm{TB}}k_{f,r}\\sum_{i=1}^{N_s}\\alpha_{ir}C_i + \\chi_{r}^{\\mathrm{FO}}k_{\\infty,r}F_r\\frac{P_r}{1+P_r} \\right) \\left( \\nu_{jr}^{\\prime} \\prod_{i=1}^{N_s} C_i^{\\nu_{ir}^{\\prime}} - \\frac{\\nu_{jr}^{\\prime\\prime}}{K_{c,r}} \\prod_{i=1}^{N_s} C_i^{\\nu_{ir}^{\\prime\\prime}} \\right) \\\\ + \\alpha_{jr} \\left( \\prod_{i=1}^{N_s} C_i^{\\nu_{ir}^{\\prime}} - \\frac{1}{K_{c,r}} \\prod_{i=1}^{N_s} C_i^{\\nu_{ir}^{\\prime\\prime}} \\right) \\left( \\chi_{r}^{\\mathrm{TB}}k_{f,r} + \\chi_{r}^{\\mathrm{FO}}k_{0,r} \\left[ \\frac{\\partial F_r}{\\partial P_r}\\frac{P_r}{1+P_r} + \\frac{F_r}{(1+P_r)^2} \\right] \\right) \\end{array} \\right\\}}\n$$"
        },
        {
            "introduction": "尽管解析雅可比矩阵是理想的，但其复杂性可能令人望而却步；作为替代，可以用有限差分进行近似，但这通常计算成本高昂。这项动手编程实践将探索一种强大的优化技术，该技术利用了化学雅可比矩阵固有的稀疏性。您将学习如何使用图论和着色算法来大幅减少所需的函数求值次数，这是实现高效大规模反应流模拟的一项基本策略。",
            "id": "3356523",
            "problem": "考虑一个用于 $n_s$ 个化学物种在 $n_r$ 个基元不可逆反应中进行反应的均匀等温混合物的有限速率化学反应流框架。设摩尔浓度向量为 $\\mathbf{c} \\in \\mathbb{R}^{n_s}$，其分量为物种 $j$ 的浓度 $c_j$；反应速率向量为 $\\mathbf{R}(\\mathbf{c}) \\in \\mathbb{R}^{n_r}$。每个反应 $k$ 都有一个 Arrhenius 速率常数 $A_k \\exp(-E_k/(R T))$，并遵循质量作用定律，其反应物化学计量指数为 $\\alpha_{jk} \\in \\{0,1,2,\\dots\\}$，因此\n$$\nR_k(\\mathbf{c}) = A_k \\exp\\left(-\\frac{E_k}{R T}\\right) \\prod_{j=1}^{n_s} c_j^{\\alpha_{jk}}.\n$$\n物种 $i$ 的净生成速率由物种源项给出\n$$\nf_i(\\mathbf{c}) = \\sum_{k=1}^{n_r} S_{ik} R_k(\\mathbf{c}),\n$$\n其中 $S \\in \\mathbb{R}^{n_s \\times n_r}$ 是化学计量矩阵，其条目 $S_{ik}$ 等于物种 $i$ 在反应 $k$ 中的净化学计量变化（反应物为负，生成物为正，其他为零）。源项的雅可比矩阵为\n$$\nJ(\\mathbf{c}) = \\frac{\\partial \\mathbf{f}}{\\partial \\mathbf{c}} \\in \\mathbb{R}^{n_s \\times n_s}, \\quad J_{ij}(\\mathbf{c}) = \\sum_{k=1}^{n_r} S_{ik} \\frac{\\partial R_k(\\mathbf{c})}{\\partial c_j}.\n$$\n从这些基本定义出发，执行以下任务：\n\n1. 根据 $S_{ik}$ 和 $\\alpha_{jk}$，推导 $J$ 的稀疏模式的一个充分必要条件，即在不进行任何数值速率计算的情况下，描述 $J_{ij}(\\mathbf{c})$ 何时可以为非零。\n\n2. 构建 $J$ 的列干涉图，其顶点对应于列 $j \\in \\{1,\\dots,n_s\\}$，并且当且仅当 $J$ 的 $p$ 列和 $q$ 列共享至少一个共同的行索引 $i$，使得 $J_{ip}$ 和 $J_{iq}$ 都可以为非零时，顶点 $p$ 和 $q$ 之间存在一条无向边。解释该干涉图的正常图着色如何能够实现同步有限差分扰动，而不在任何行中产生混叠，从而减少为无雅可比牛顿-克雷洛夫 (JFNK) 方法预条件子构建稀疏雅可比矩阵近似所需的函数求值次数。\n\n3. 定义加速比\n$$\n\\sigma = \\frac{m}{q},\n$$\n其中 $m$ 是具有至少一个结构上非零雅可比条目的物种列数（等价于在至少一个反应中作为反应物出现的物种 $j$ 的数量，即至少存在一个 $k$ 使得 $\\alpha_{jk}  0$），而 $q$ 是通过对干涉图进行贪婪最大度优先着色产生的颜色数量。加速比 $\\sigma$ 量化了使用图着色构建稀疏雅可比矩阵近似相对于分别扰动每个结构上非零列的朴素密集方法所需的函数求值次数的减少量。将 $\\sigma$ 表示为一个无量纲浮点数。\n\n4. 实现一个完整的可运行程序，该程序：\n   - 使用 $n_s$、矩阵 $\\alpha \\in \\mathbb{N}_0^{n_s \\times n_r}$ 和化学计量矩阵 $S \\in \\mathbb{Z}^{n_s \\times n_r}$ 来编码每个反应机理。\n   - 根据第1部分的条件，仅使用 $(\\alpha, S)$ 构建雅可比矩阵的稀疏模式。\n   - 构建干涉图并通过贪婪最大度优先着色计算 $q$。\n   - 为测试套件中的每个机理计算 $m$ 和 $\\sigma$。\n   - 生成一行输出，包含所有测试用例的加速比值列表，格式为方括号括起来的逗号分隔列表，每个浮点数四舍五入到三位小数（例如，$[1.500,1.000,3.000]$）。\n\n使用以下测试套件，其中包含 $n_s = 7$ 个物种，标记为 $A,B,C,D,E,F,G$，并映射到索引 $0,1,2,3,4,5,6$：\n\n- 案例1（双分子反应链；中度耦合）：\n  - 反应1：$A + B \\rightarrow C$，其中 $\\alpha_{\\cdot,1} = [1,1,0,0,0,0,0]$ 且 $S_{\\cdot,1} = [-1,-1,+1,0,0,0,0]$。\n  - 反应2：$C + D \\rightarrow E$，其中 $\\alpha_{\\cdot,2} = [0,0,1,1,0,0,0]$ 且 $S_{\\cdot,2} = [0,0,-1,-1,+1,0,0]$。\n  - 反应3：$E + F \\rightarrow G$，其中 $\\alpha_{\\cdot,3} = [0,0,0,0,1,1,0]$ 且 $S_{\\cdot,3} = [0,0,0,0,-1,-1,+1]$。\n\n- 案例2（三分子和交叉耦合反应；近乎完全耦合）：\n  - 反应1：$A + B + C \\rightarrow D$，其中 $\\alpha_{\\cdot,1} = [1,1,1,0,0,0,0]$ 且 $S_{\\cdot,1} = [-1,-1,-1,+1,0,0,0]$。\n  - 反应2：$A + D + E \\rightarrow F$，其中 $\\alpha_{\\cdot,2} = [1,0,0,1,1,0,0]$ 且 $S_{\\cdot,2} = [ -1,0,0,-1,-1,+1,0]$。\n  - 反应3：$B + F + G \\rightarrow C$，其中 $\\alpha_{\\cdot,3} = [0,1,0,0,0,1,1]$ 且 $S_{\\cdot,3} = [0,-1,+1,0,0,-1,-1]$。\n\n- 案例3（三个平行的单分子反应；最小耦合）：\n  - 反应1：$A \\rightarrow B$，其中 $\\alpha_{\\cdot,1} = [1,0,0,0,0,0,0]$ 且 $S_{\\cdot,1} = [-1,+1,0,0,0,0,0]$。\n  - 反应2：$C \\rightarrow D$，其中 $\\alpha_{\\cdot,2} = [0,0,1,0,0,0,0]$ 且 $S_{\\cdot,2} = [0,0,-1,+1,0,0,0]$。\n  - 反应3：$E \\rightarrow F$，其中 $\\alpha_{\\cdot,3} = [0,0,0,0,1,0,0]$ 且 $S_{\\cdot,3} = [0,0,0,0,-1,+1,0]$。\n\n为算法推导和计数目的，本问题中的所有量均为无量纲，不需要物理单位。您的程序应生成一行输出，其中包含结果，格式为方括号括起来的逗号分隔列表，每个浮点数四舍五入到三位小数（例如，$[1.500,1.000,3.000]$）。",
            "solution": "该问题要求对有限速率化学模型中与物种源项相关的雅可比矩阵进行四部分分析，最终通过计算实现来计算一个基于图着色的性能指标。该问题被评估为有效，因为它在化学动力学和数值分析方面具有科学依据，其设置完整、一致且适定，并以客观、正式的语言表述。\n\n### 第1部分：雅可比稀疏条件\n\n物种源项向量 $\\mathbf{f}(\\mathbf{c})$ 的雅可比矩阵由其分量 $J_{ij}(\\mathbf{c}) = \\frac{\\partial f_i}{\\partial c_j}$ 定义。物种 $i$ 的源项 $f_i(\\mathbf{c})$ 由下式给出：\n$$\nf_i(\\mathbf{c}) = \\sum_{k=1}^{n_r} S_{ik} R_k(\\mathbf{c})\n$$\n其中 $S_{ik}$ 是物种 $i$ 在反应 $k$ 中的化学计量系数，而 $R_k(\\mathbf{c})$ 是反应 $k$ 的速率。对物种 $j$ 的浓度 $c_j$ 求导，我们得到：\n$$\nJ_{ij}(\\mathbf{c}) = \\frac{\\partial}{\\partial c_j} \\left( \\sum_{k=1}^{n_r} S_{ik} R_k(\\mathbf{c}) \\right) = \\sum_{k=1}^{n_r} S_{ik} \\frac{\\partial R_k(\\mathbf{c})}{\\partial c_j}\n$$\n根据质量作用定律，反应 $k$ 的速率为：\n$$\nR_k(\\mathbf{c}) = K_k \\prod_{l=1}^{n_s} c_l^{\\alpha_{lk}}\n$$\n其中 $K_k = A_k \\exp(-E_k/(RT))$ 是速率常数，$\\alpha_{lk}$ 是物种 $l$ 在反应 $k$ 中的反应物化学计量指数。\n\n为了找到稀疏模式，我们需要一个条件来判断 $J_{ij}$ 何时可以为结构上非零，即对于所有可能的正浓度 $\\mathbf{c}$，它不恒等于零。这取决于偏导数 $\\frac{\\partial R_k}{\\partial c_j}$。使用乘积法则，仅当物种 $j$ 是反应 $k$ 的反应物时，即 $\\alpha_{jk}  0$ 时，该导数才非零。如果我们假设所有反应物浓度均为正，则该导数可以写为：\n$$\n\\frac{\\partial R_k(\\mathbf{c})}{\\partial c_j} = \\frac{\\alpha_{jk}}{c_j} R_k(\\mathbf{c})\n$$\n当且仅当 $\\alpha_{jk}  0$ 时，该项在结构上非零（假设反应有效，即 $K_k  0$ 且反应物浓度非零）。\n\n$J_{ij}$ 求和式中的特定项 $S_{ik} \\frac{\\partial R_k}{\\partial c_j}$ 在结构上非零，当且仅当同时满足两个条件：\n1. 物种 $i$ 参与反应 $k$，这意味着其净化学计量变化非零 ($S_{ik} \\neq 0$)。\n2. 物种 $j$ 是反应 $k$ 的反应物，这意味着其化学计量指数为正 ($\\alpha_{jk}  0$)。\n\n整个雅可比矩阵条目 $J_{ij}$ 是对所有反应的求和。如果求和中至少有一项在结构上非零，则 $J_{ij}$ 在结构上非零。因此，$J_{ij}(\\mathbf{c})$ 在结构上非零的充分必要条件是：\n\n**存在至少一个反应 $k \\in \\{1, \\dots, n_r\\}$，使得 $S_{ik} \\neq 0$ 且 $\\alpha_{jk}  0$。**\n\n此条件仅取决于化学计量矩阵 $S$ 和反应物指数矩阵 $\\alpha$，从而可以在不进行数值计算的情况下确定雅可比矩阵的稀疏模式。\n\n### 第2部分：列干涉图与有限差分\n\n雅可比矩阵 $J$ 的列干涉图 $G = (V, E)$ 定义如下：\n- 顶点集 $V$ 对应于 $J$ 的列，因此 $V = \\{1, \\dots, n_s\\}$，代表每个化学物种。\n- 当且仅当 $J$ 中对应的列在至少一个行索引 $i$ 上共享非零项时，顶点 $p$ 和 $q$ ($p \\neq q$) 之间存在一条无向边 $(p, q)$。形式上，$(p, q) \\in E$ 当且仅当存在一个行 $i \\in \\{1, \\dots, n_s\\}$ 使得 $J_{ip} \\not\\equiv 0$ 且 $J_{iq} \\not\\equiv 0$ 在结构上成立。\n\n该图的正常着色为每个顶点分配一种颜色，使得没有两个相邻顶点具有相同的颜色。这种着色的作用在于优化使用有限差分计算稀疏雅可比矩阵的过程。为了近似 $J$ 的列，可以扰动浓度向量 $\\mathbf{c}$ 并评估源项向量 $\\mathbf{f}$ 的变化。一种朴素的方法是分别扰动每一列 $j$：\n$$ J_{\\cdot, j} \\approx \\frac{\\mathbf{f}(\\mathbf{c} + \\epsilon \\mathbf{e}_j) - \\mathbf{f}(\\mathbf{c})}{\\epsilon} $$\n这需要对每个要近似的列进行一次 $\\mathbf{f}$ 的函数求值。\n\n图着色允许进行同步扰动。根据正常着色的定义，所有被分配相同颜色的列（顶点）是相互不相邻的。这意味着对于同一颜色组中的任意一对列 $p$ 和 $q$，不存在任何行 $i$ 使得 $J_{ip}$ 和 $J_{iq}$ 同时在结构上非零。\n\n我们可以通过对给定颜色组中所有列 $\\{j_1, j_2, \\dots, j_l\\}$ 的单个扰动求和来形成一个扰动向量 $\\mathbf{d} = \\sum_{k=1}^l \\epsilon_{j_k} \\mathbf{e}_{j_k}$。当我们计算有限差分 $\\Delta\\mathbf{f} = \\mathbf{f}(\\mathbf{c} + \\mathbf{d}) - \\mathbf{f}(\\mathbf{c})$ 时，根据一阶泰勒展开，第 $i$ 个分量近似为：\n$$ \\Delta f_i \\approx \\sum_{k=1}^l J_{ij_k} \\epsilon_{j_k} $$\n由于颜色组的非干涉特性，对于任何给定的行 $i$，此求和中最多只有一个项 $J_{ij_k}$ 可以为非零。因此，该和坍缩为单个项 $\\Delta f_i \\approx J_{ip} \\epsilon_p$，其中 $p$ 是组中使 $J_{ip}$ 非零的唯一列。这使我们能够恢复值 $J_{ip} \\approx \\Delta f_i / \\epsilon_p$ 而不会受到其他同步扰动的混叠影响。\n\n如果干涉图可以用 $q$ 种颜色进行着色，那么整个稀疏雅可比矩阵只需对源项函数 $\\mathbf{f}$ 进行 $q$ 次求值（加上一次未扰动状态的求值）即可构建，每个颜色组一次。\n\n### 第3部分：加速比\n\n加速比 $\\sigma$ 定义为：\n$$\n\\sigma = \\frac{m}{q}\n$$\n- $m$：$J$ 中非结构性零的列数。如问题中所述并通过第1部分的分析所证实，这等价于在至少一个反应中充当反应物的物种数量（$\\exists k \\text{ 使得 } \\alpha_{jk}  0$）。这代表了智能跳过全零列的直接有限差分方法所需的函数求值次数。\n- $q$：用于列干涉图的贪婪最大度优先着色启发式算法所使用的颜色数。这是图的色数的近似值，代表了基于稀疏着色的方法所需的函数求值次数。\n\n因此，因子 $\\sigma$ 衡量了图着色方法相对于更直接（但仍具备稀疏感知能力）的有限差分方案所带来的计算节省。\n\n### 第4部分：算法实现\n\n实现过程如下：\n1. 对于每个测试用例，构建矩阵 $\\alpha$ 和 $S$。\n2. 使用第1部分的条件确定雅可比稀疏模式，这是一个 $n_s \\times n_s$ 的布尔矩阵。\n3. 通过计算 $\\alpha$ 矩阵的第 $j$ 行至少包含一个正条目的物种 $j$ 的数量来计算 $m$ 的值。\n4. 通过检查每对列的雅可比稀疏模式中是否存在行方向的重叠，来构建 $n_s$ 个顶点的列干涉图的邻接矩阵。\n5. 计算干涉图中所有顶点的度。\n6. 应用贪婪最大度优先着色算法：\n    a. 将顶点按其度数降序排序。\n    b. 遍历排序后的顶点，为每个顶点分配其已着色邻居未使用的最小整数颜色。\n7. 从着色结果中确定所用颜色的数量 $q$。\n8. 计算并存储加速比 $\\sigma = m/q$。\n9. 最后，格式化并打印所有测试用例的加速比值列表。\n\n以下是实现该算法的完整 Python 程序：\n\n```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main solver function that processes all test cases and prints the results.\n    \"\"\"\n    test_cases = [\n        # Case 1: chain of bimolecular reactions\n        {\n            \"ns\": 7,\n            \"alpha_cols\": [\n                [1, 1, 0, 0, 0, 0, 0],\n                [0, 0, 1, 1, 0, 0, 0],\n                [0, 0, 0, 0, 1, 1, 0]\n            ],\n            \"S_cols\": [\n                [-1, -1, 1, 0, 0, 0, 0],\n                [0, 0, -1, -1, 1, 0, 0],\n                [0, 0, 0, 0, -1, -1, 1]\n            ]\n        },\n        # Case 2: tri-molecular and cross-coupled reactions\n        {\n            \"ns\": 7,\n            \"alpha_cols\": [\n                [1, 1, 1, 0, 0, 0, 0],\n                [1, 0, 0, 1, 1, 0, 0],\n                [0, 1, 0, 0, 0, 1, 1]\n            ],\n            \"S_cols\": [\n                [-1, -1, -1, 1, 0, 0, 0],\n                [-1, 0, 0, -1, -1, 1, 0],\n                [0, -1, 1, 0, 0, -1, -1]\n            ]\n        },\n        # Case 3: three parallel unimolecular reactions\n        {\n            \"ns\": 7,\n            \"alpha_cols\": [\n                [1, 0, 0, 0, 0, 0, 0],\n                [0, 0, 1, 0, 0, 0, 0],\n                [0, 0, 0, 0, 1, 0, 0]\n            ],\n            \"S_cols\": [\n                [-1, 1, 0, 0, 0, 0, 0],\n                [0, 0, -1, 1, 0, 0, 0],\n                [0, 0, 0, 0, -1, 1, 0]\n            ]\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        ns = case[\"ns\"]\n        alpha = np.array(case[\"alpha_cols\"]).T\n        S = np.array(case[\"S_cols\"]).T\n        \n        result = calculate_speedup(ns, alpha, S)\n        results.append(f\"{result:.3f}\")\n\n    # The problem asks for the output line from the program\n    # which is printed here.\n    # print(f\"[{','.join(results)}]\")\n    # For the purpose of this structure, this function will return the final string.\n\ndef calculate_speedup(ns, alpha, S):\n    \"\"\"\n    Calculates the speedup factor sigma for a single reaction mechanism.\n    \n    Args:\n        ns (int): Number of species.\n        alpha (np.ndarray): Reactant exponent matrix (ns x nr).\n        S (np.ndarray): Stoichiometric matrix (ns x nr).\n        \n    Returns:\n        float: The computed speedup factor sigma.\n    \"\"\"\n    if ns == 0:\n        return 0.0\n        \n    nr = S.shape[1]\n\n    J_sparsity = np.zeros((ns, ns), dtype=bool)\n    for i in range(ns):\n        for j in range(ns):\n            for k in range(nr):\n                if S[i, k] != 0 and alpha[j, k] > 0:\n                    J_sparsity[i, j] = True\n                    break\n\n    m = np.sum(np.any(alpha > 0, axis=1))\n\n    if m == 0:\n        return 0.0\n\n    adj_matrix = np.zeros((ns, ns), dtype=bool)\n    for p in range(ns):\n        for q in range(p + 1, ns):\n            if np.any(np.logical_and(J_sparsity[:, p], J_sparsity[:, q])):\n                adj_matrix[p, q] = True\n                adj_matrix[q, p] = True\n\n    degrees = np.sum(adj_matrix, axis=1)\n    sorted_vertices = np.argsort(degrees)[::-1]\n\n    colors = -np.ones(ns, dtype=int)\n    max_color = -1\n    \n    for u in sorted_vertices:\n        neighbor_colors = set()\n        for v in range(ns):\n            if adj_matrix[u, v] and colors[v] != -1:\n                neighbor_colors.add(colors[v])\n        \n        c = 0\n        while c in neighbor_colors:\n            c += 1\n        colors[u] = c\n        if c > max_color:\n            max_color = c\n            \n    q = max_color + 1\n\n    if q == 0:\n        return 0.0\n\n    sigma = m / q\n    return sigma\n\n# This part is just for generating the answer string for the XML.\n# It simulates running the main function.\nif __name__ == '__main__':\n    solve()\n\n```",
            "answer": "[1.500,1.000,3.000]"
        }
    ]
}