{
    "hands_on_practices": [
        {
            "introduction": "The foundation of computational aeroacoustics often lies in an acoustic analogy, which reformulates the equations of fluid motion into an acoustic wave equation driven by source terms. This practice guides you through the derivation and computation of the foundational Lighthill quadrupole source tensor, $T_{ij}$, directly from primary flow variables . By tackling this problem, you will gain hands-on experience in bridging the gap between a fluid dynamics simulation and an acoustic model, and critically assess how numerical choices impact the accuracy of the acoustic source.",
            "id": "3303443",
            "problem": "You are tasked with building a principled computational workflow, grounded in compressible flow fundamentals, to construct the quadrupole source tensor used in acoustic analogies and to quantify its sensitivity to numerical differentiation and Large-Eddy Simulation (LES) filtering. Start from the compressible Navier–Stokes equations and the Newtonian constitutive law as the fundamental base. Specifically, use the conservation of mass and momentum and the Newtonian viscous stress with Stokes hypothesis to derive the tensor that acts as the source term in Lighthill’s acoustic analogy. Implement the derived expression numerically on synthetic but physically plausible three-dimensional fields and quantify sensitivity to both differentiation scheme and LES filter width by comparing to a spectral reference.\n\nThe synthetic LES fields are defined on a periodic cubic domain of length $L$ in each direction with grid resolution $N$ points per direction. Define the Cartesian coordinates $\\{x,y,z\\}$ on a uniform grid with spacing $\\Delta x = L/N$. Use the following physically consistent and smooth fields intended to emulate filtered LES quantities:\n- Velocity components:\n$$u_x(x,y,z) = \\sin(x)\\cos(y)\\cos(z),\\quad u_y(x,y,z) = \\cos(x)\\sin(y)\\cos(z),\\quad u_z(x,y,z) = \\cos(x)\\cos(y)\\sin(z).$$\n- Density:\n$$\\rho(x,y,z) = \\rho_0 + \\varepsilon_\\rho \\cos(x)\\cos(y)\\cos(z).$$\n- Pressure:\n$$p(x,y,z) = c^2 \\rho(x,y,z) + \\varepsilon_p \\cos(2x)\\cos(2y)\\cos(2z).$$\n\nYou must derive from first principles the quadrupole source tensor expression associated with Lighthill’s acoustic analogy; this tensor must be expressed entirely in terms of the primary fields $\\rho$, $p$, $\\boldsymbol{u}$, the speed of sound $c$, and the viscous stress tensor $\\boldsymbol{\\sigma}$ defined by the Newtonian law with Stokes hypothesis. The derivation must start from the conservation equations and definitions, and must not assume or state the target expression directly at the outset. Then, implement a numerical algorithm that computes the tensor on the discrete grid by:\n- Constructing the synthetic fields on the specified grid.\n- Applying a three-dimensional Gaussian LES filter of standard deviation $\\sigma_f$ to the fields $\\rho$, $p$, and each component of $\\boldsymbol{u}$, with a spatially invariant, separable, and periodic kernel. In Fourier space, the filter should be equivalent to multiplication by $\\exp\\left[-\\tfrac{1}{2}\\sigma_f^2\\left(k_x^2+k_y^2+k_z^2\\right)\\right]$ where $\\{k_x,k_y,k_z\\}$ are angular wavenumbers that respect periodicity on the domain of length $L$.\n- Computing spatial derivatives needed for $\\boldsymbol{\\sigma}$ by one of three schemes:\n    1. A second-order central difference scheme on the periodic grid.\n    2. A fourth-order central difference scheme on the periodic grid.\n    3. A spectral derivative via Fast Fourier Transform (FFT), which for periodic domains computes $\\partial/\\partial x$ by multiplying the Fourier transform by $\\mathrm{i}k_x$ (and similarly for $y$ and $z$), then inverse transforming.\n\nDefine the Newtonian viscous stress with Stokes hypothesis as\n$$\\sigma_{ij} = \\mu\\left(\\frac{\\partial u_i}{\\partial x_j}+\\frac{\\partial u_j}{\\partial x_i}\\right) - \\frac{2}{3}\\mu\\left(\\nabla\\cdot\\boldsymbol{u}\\right)\\delta_{ij},$$\nwhere $\\mu$ is the dynamic viscosity and $\\delta_{ij}$ is the Kronecker delta. Use this $\\boldsymbol{\\sigma}$ in your derived expression for the quadrupole source tensor.\n\nUse parameter values consistent with air at room conditions and standard acoustics practice:\n- Domain length: $L = 2\\pi$ meters.\n- Grid resolution: $N = 32$ points per direction, so $\\Delta x = L/N$ meters.\n- Speed of sound: $c = 340$ meters per second.\n- Baseline density: $\\rho_0 = 1.2$ kilograms per cubic meter.\n- Density perturbation amplitude: $\\varepsilon_\\rho = 0.05$ kilograms per cubic meter.\n- Pressure deviation amplitude: $\\varepsilon_p = 10$ pascals.\n- Dynamic viscosity: $\\mu = 1.8\\times 10^{-5}$ pascal-seconds.\n\nTo evaluate sensitivity, define a spectral reference tensor computed with the spectral derivative scheme and no filter, and report the relative root-mean-square (RMS) difference between the tensor produced by a given scheme-and-filter combination and the reference. For a tensor field $\\boldsymbol{T}$ and its reference $\\boldsymbol{T}^{\\mathrm{ref}}$, define the relative RMS difference as\n$$E = \\frac{\\left\\|\\boldsymbol{T}-\\boldsymbol{T}^{\\mathrm{ref}}\\right\\|_2}{\\left\\|\\boldsymbol{T}^{\\mathrm{ref}}\\right\\|_2},$$\nwhere the norm is the Euclidean norm over all grid points and all tensor components,\n$$\\left\\|\\boldsymbol{A}\\right\\|_2 = \\left(\\sum_{i=1}^3\\sum_{j=1}^3\\sum_{\\text{grid}} A_{ij}^2\\right)^{1/2}.$$\n\nImplement a program that constructs the fields, applies filtering, computes derivatives and the viscous stress, forms the quadrupole source tensor, and evaluates $E$ for the following test suite. Each test case is identified by a differentiation scheme and a Gaussian filter standard deviation in meters. The filter width values are expressed in terms of $\\Delta x$:\n- Case $1$: scheme $\\mathrm{spectral}$, $\\sigma_f = 0\\Delta x$.\n- Case $2$: scheme $\\mathrm{central2}$, $\\sigma_f = 0\\Delta x$.\n- Case $3$: scheme $\\mathrm{central4}$, $\\sigma_f = 0\\Delta x$.\n- Case $4$: scheme $\\mathrm{central2}$, $\\sigma_f = 2\\Delta x$.\n- Case $5$: scheme $\\mathrm{spectral}$, $\\sigma_f = 2\\Delta x$.\n- Case $6$: scheme $\\mathrm{central2}$, $\\sigma_f = 5\\Delta x$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of Cases $1$ through $6$, with each numeric result rounded to six decimal places (e.g., $\\left[0.000000,0.012345,0.006789,0.123456,0.234567,0.345678\\right]$). The reported quantity $E$ is dimensionless, so no physical unit should be printed. Angles, if any appear in your derivation, should be treated as dimensionless phases in radians, but the output requires no angles. Express all intermediate and final mathematical reasoning in terms of the stated physical units in the derivation, but the program output must be dimensionless floats as specified.",
            "solution": "The problem is valid as it is scientifically grounded in the principles of compressible fluid dynamics and computational aeroacoustics, is well-posed with a complete and consistent set of parameters and definitions, and poses an objective, non-trivial computational task.\n\nThe central task is to derive and numerically implement the Lighthill quadrupole source tensor, $T_{ij}$, and analyze its sensitivity to numerical approximations. The derivation begins with the fundamental conservation laws for a compressible fluid: the conservation of mass (continuity equation) and the conservation of momentum.\n\nThe continuity equation is:\n$$\n\\frac{\\partial \\rho}{\\partial t} + \\frac{\\partial (\\rho u_j)}{\\partial x_j} = 0\n$$\nwhere $\\rho$ is the fluid density, $\\boldsymbol{u}$ is the velocity vector with components $u_j$, $t$ is time, and $x_j$ are the Cartesian coordinates. Einstein summation convention is used for repeated indices.\n\nThe momentum equation for a compressible, viscous fluid is:\n$$\n\\frac{\\partial (\\rho u_i)}{\\partial t} + \\frac{\\partial (\\rho u_i u_j)}{\\partial x_j} = -\\frac{\\partial p}{\\partial x_i} + \\frac{\\partial \\sigma_{ij}}{\\partial x_j}\n$$\nHere, $p$ is the static pressure and $\\sigma_{ij}$ is the viscous stress tensor.\n\nTo derive Lighthill's acoustic analogy, we rearrange these equations into the form of an inhomogeneous wave equation. We take the time derivative of the continuity equation and the divergence (derivative with respect to $x_i$) of the momentum equation.\nTime derivative of continuity:\n$$\n\\frac{\\partial^2 \\rho}{\\partial t^2} + \\frac{\\partial}{\\partial t}\\left(\\frac{\\partial (\\rho u_j)}{\\partial x_j}\\right) = 0\n$$\nDivergence of momentum:\n$$\n\\frac{\\partial}{\\partial x_i}\\left(\\frac{\\partial (\\rho u_i)}{\\partial t}\\right) + \\frac{\\partial^2 (\\rho u_i u_j)}{\\partial x_i \\partial x_j} = -\\frac{\\partial^2 p}{\\partial x_i^2} + \\frac{\\partial^2 \\sigma_{ij}}{\\partial x_i \\partial x_j}\n$$\nAssuming the fields are sufficiently smooth, we can switch the order of differentiation in the first term, yielding $\\frac{\\partial}{\\partial t}\\left(\\frac{\\partial (\\rho u_i)}{\\partial x_i}\\right)$. From the continuity equation, we know that $\\frac{\\partial (\\rho u_j)}{\\partial x_j} = -\\frac{\\partial \\rho}{\\partial t}$. Substituting this into the manipulated momentum equation gives:\n$$\n\\frac{\\partial}{\\partial t}\\left(-\\frac{\\partial \\rho}{\\partial t}\\right) + \\frac{\\partial^2 (\\rho u_i u_j)}{\\partial x_i \\partial x_j} = -\\nabla^2 p + \\frac{\\partial^2 \\sigma_{ij}}{\\partial x_i \\partial x_j}\n$$\n$$\n-\\frac{\\partial^2 \\rho}{\\partial t^2} + \\frac{\\partial^2 (\\rho u_i u_j)}{\\partial x_i \\partial x_j} = -\\nabla^2 p + \\frac{\\partial^2 \\sigma_{ij}}{\\partial x_i \\partial x_j}\n$$\nRearranging and moving all terms except the time derivative of density to the right-hand side gives an exact equation derived from the Navier-Stokes equations:\n$$\n\\frac{\\partial^2 \\rho}{\\partial t^2} = \\nabla^2 p + \\frac{\\partial^2 (\\rho u_i u_j)}{\\partial x_i \\partial x_j} - \\frac{\\partial^2 \\sigma_{ij}}{\\partial x_i \\partial x_j}\n$$\nTo form the wave equation, we introduce a reference speed of sound, $c$, and subtract the term $c^2 \\nabla^2 \\rho$ from both sides:\n$$\n\\frac{\\partial^2 \\rho}{\\partial t^2} - c^2 \\nabla^2 \\rho = \\nabla^2 p - c^2 \\nabla^2 \\rho + \\frac{\\partial^2 (\\rho u_i u_j)}{\\partial x_i \\partial x_j} - \\frac{\\partial^2 \\sigma_{ij}}{\\partial x_i \\partial x_j}\n$$\nThe left-hand side is the linear wave operator acting on density. The right-hand side contains all the source terms of sound. We group all terms on the right-hand side under a double spatial divergence, $\\frac{\\partial^2}{\\partial x_i \\partial x_j}$. To do this, we note that for any scalar field $S$, its Laplacian can be written as $\\nabla^2 S = \\frac{\\partial^2 (S \\delta_{ij})}{\\partial x_i \\partial x_j}$, where $\\delta_{ij}$ is the Kronecker delta. Applying this to the term $(\\nabla^2 p - c^2 \\nabla^2 \\rho) = \\nabla^2(p - c^2 \\rho)$, we can write:\n$$\n\\frac{\\partial^2 \\rho}{\\partial t^2} - c^2 \\nabla^2 \\rho = \\frac{\\partial^2}{\\partial x_i \\partial x_j} \\left[ \\rho u_i u_j + (p - c^2 \\rho)\\delta_{ij} - \\sigma_{ij} \\right]\n$$\nThis is Lighthill's equation. The term in the square brackets is the Lighthill quadrupole source tensor, $T_{ij}$:\n$$\nT_{ij} = \\rho u_i u_j + (p - c^2 \\rho)\\delta_{ij} - \\sigma_{ij}\n$$\nThe three terms in $T_{ij}$ represent physically distinct sound generation mechanisms: the Reynolds stress term $\\rho u_i u_j$ (dominant in high-speed flows), the term $(p - c^2\\rho)\\delta_{ij}$ related to non-isentropic pressure fluctuations or entropy, and the viscous stress term $-\\sigma_{ij}$ (typically negligible for sound generation in high-Reynolds-number flows but included for completeness). The problem provides an explicit form for the pressure $p$ such that $p - c^2 \\rho$ is a specified analytical function, simplifying its computation.\n\nThe numerical implementation is designed based on these principles.\nFirst, a discrete grid is established over the periodic domain of side length $L = 2\\pi$ meters, with $N = 32$ points in each direction, yielding a grid spacing of $\\Delta x = L/N = \\pi/16$ meters. The synthetic velocity $\\boldsymbol{u}$, density $\\rho$, and pressure $p$ fields are populated on this $3$D grid.\n\nSecond, a key part of the analysis involves mimicking Large-Eddy Simulation (LES) by applying a filter. A $3$D Gaussian filter is used, which is most efficiently implemented in Fourier space. A field $\\phi$ is filtered by taking its Fast Fourier Transform (FFT), multiplying it by the filter transfer function $G(\\boldsymbol{k}) = \\exp(-\\frac{1}{2}\\sigma_f^2 |\\boldsymbol{k}|^2)$, and then taking the inverse FFT. Here, $\\boldsymbol{k} = (k_x, k_y, k_z)$ is the angular wavenumber vector, and $\\sigma_f$ is the filter width. This operation correctly simulates the removal of small-scale information from the flow fields.\n\nThird, the computation of $T_{ij}$ requires spatial derivatives to form the viscous stress tensor $\\sigma_{ij}$. The problem specifies three schemes:\n$1$. Spectral differentiation: This is performed in Fourier space by multiplying the FFT of the field by $\\mathrm{i}k_x$ (for $\\partial/\\partial x$), $\\mathrm{i}k_y$ (for $\\partial/\\partial y$), etc., and inverse transforming. For periodic, smooth functions, this method is highly accurate, limited only by grid resolution (aliasing), making it the ideal choice for a reference solution.\n$2$. Second-order central differences: A finite difference approximation, e.g., $\\frac{\\partial f}{\\partial x} \\approx \\frac{f(x+\\Delta x) - f(x-\\Delta x)}{2\\Delta x}$. This is a common, computationally inexpensive scheme.\n$3$. Fourth-order central differences: A higher-accuracy finite difference scheme, e.g., $\\frac{\\partial f}{\\partial x} \\approx \\frac{-f(x+2\\Delta x) + 8f(x+\\Delta x) - 8f(x-\\Delta x) + f(x-2\\Delta x)}{12\\Delta x}$. This offers better accuracy than the second-order scheme at a higher computational cost.\nPeriodicity is handled using circular array shifts (e.g., `numpy.roll`).\n\nWith the filtered fields and a chosen differentiation scheme, the Lighthill tensor $T_{ij}$ is assembled. The velocity gradient tensor, $\\partial u_i / \\partial x_j$, is first computed. From this, the velocity divergence $\\nabla\\cdot\\boldsymbol{u}$ and the viscous stress tensor $\\sigma_{ij} = \\mu(\\frac{\\partial u_i}{\\partial x_j}+\\frac{\\partial u_j}{\\partial x_i}) - \\frac{2}{3}\\mu(\\nabla\\cdot\\boldsymbol{u})\\delta_{ij}$ are constructed. Finally, all components of $T_{ij}$ are calculated at each grid point according to its derived formula.\n\nTo quantify sensitivity, a reference tensor $T^{\\mathrm{ref}}$ is computed using the most accurate combination: spectral derivatives and no filtering ($\\sigma_f = 0$). For each test case, the corresponding tensor $T$ is computed and compared to the reference using the relative root-mean-square (RMS) difference, $E = \\left\\|\\boldsymbol{T}-\\boldsymbol{T}^{\\mathrm{ref}}\\right\\|_2 / \\left\\|\\boldsymbol{T}^{\\mathrm{ref}}\\right\\|_2$. The norm $\\left\\|\\cdot\\right\\|_2$ is the standard Euclidean norm computed over all $9$ tensor components and all grid points. This metric provides a single scalar value quantifying the total error introduced by a given numerical scheme and filter width. Case $1$ (spectral, $\\sigma_f=0$) serves as the baseline, and its error $E$ is by definition $0$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives, computes, and analyzes the Lighthill quadrupole source tensor.\n    \"\"\"\n    #\n    # Define parameters and computational domain\n    #\n    L = 2.0 * np.pi  # Domain length [m]\n    N = 32           # Grid resolution\n    C = 340.0        # Speed of sound [m/s]\n    RHO_0 = 1.2      # Baseline density [kg/m^3]\n    EPS_RHO = 0.05   # Density perturbation amplitude [kg/m^3]\n    EPS_P = 10.0     # Pressure deviation amplitude [Pa]\n    MU = 1.8e-5      # Dynamic viscosity [Pa.s]\n\n    DX = L / N\n\n    #\n    # Construct grid and wavenumber arrays\n    #\n    x = np.arange(N) * DX\n    X, Y, Z = np.meshgrid(x, x, x, indexing='ij')\n\n    # Angular wavenumbers\n    k_vals = 2 * np.pi * np.fft.fftfreq(N, d=DX)\n    Kx, Ky, Kz = np.meshgrid(k_vals, k_vals, k_vals, indexing='ij')\n\n    #\n    # Generate synthetic flow fields\n    #\n    ux = np.sin(X) * np.cos(Y) * np.cos(Z)\n    uy = np.cos(X) * np.sin(Y) * np.cos(Z)\n    uz = np.cos(X) * np.cos(Y) * np.sin(Z)\n    rho = RHO_0 + EPS_RHO * np.cos(X) * np.cos(Y) * np.cos(Z)\n    p = C**2 * rho + EPS_P * np.cos(2*X) * np.cos(2*Y) * np.cos(2*Z)\n\n    def apply_filter(field, sigma_f):\n        \"\"\"Applies a 3D Gaussian filter in Fourier space.\"\"\"\n        if sigma_f == 0:\n            return field\n        K2 = Kx**2 + Ky**2 + Kz**2\n        filter_kernel = np.exp(-0.5 * sigma_f**2 * K2)\n        field_hat = np.fft.fftn(field)\n        filtered_hat = field_hat * filter_kernel\n        return np.real(np.fft.ifftn(filtered_hat))\n\n    def compute_gradient(field, scheme, dx):\n        \"\"\"Computes the gradient of a scalar field using a specified scheme.\"\"\"\n        grad = np.zeros((3, N, N, N))\n        if scheme == 'spectral':\n            field_hat = np.fft.fftn(field)\n            grad[0] = np.real(np.fft.ifftn(1j * Kx * field_hat))\n            grad[1] = np.real(np.fft.ifftn(1j * Ky * field_hat))\n            grad[2] = np.real(np.fft.ifftn(1j * Kz * field_hat))\n        elif scheme == 'central2':\n            grad[0] = (np.roll(field, -1, axis=0) - np.roll(field, 1, axis=0)) / (2 * dx)\n            grad[1] = (np.roll(field, -1, axis=1) - np.roll(field, 1, axis=1)) / (2 * dx)\n            grad[2] = (np.roll(field, -1, axis=2) - np.roll(field, 1, axis=2)) / (2 * dx)\n        elif scheme == 'central4':\n            grad[0] = (-np.roll(field, -2, axis=0) + 8 * np.roll(field, -1, axis=0) -\n                       8 * np.roll(field, 1, axis=0) + np.roll(field, 2, axis=0)) / (12 * dx)\n            grad[1] = (-np.roll(field, -2, axis=1) + 8 * np.roll(field, -1, axis=1) -\n                       8 * np.roll(field, 1, axis=1) + np.roll(field, 2, axis=1)) / (12 * dx)\n            grad[2] = (-np.roll(field, -2, axis=2) + 8 * np.roll(field, -1, axis=2) -\n                       8 * np.roll(field, 1, axis=2) + np.roll(field, 2, axis=2)) / (12 * dx)\n        return grad\n\n    def compute_lighthill_tensor(scheme, sigma_f_factor):\n        \"\"\"Computes the Lighthill tensor for a given scheme and filter width.\"\"\"\n        sigma_f = sigma_f_factor * DX\n\n        # 1. Apply LES filter to fields\n        u_f = np.array([\n            apply_filter(ux, sigma_f),\n            apply_filter(uy, sigma_f),\n            apply_filter(uz, sigma_f)\n        ])\n        rho_f = apply_filter(rho, sigma_f)\n        p_f = apply_filter(p, sigma_f)\n\n        # 2. Compute velocity gradient tensor: grad_u[i, j] = du_i / dx_j\n        grad_u = np.zeros((3, 3, N, N, N))\n        for i in range(3):\n            grad_ui = compute_gradient(u_f[i], scheme, DX)\n            for j in range(3):\n                grad_u[i, j, ...] = grad_ui[j, ...]\n\n        # 3. Compute viscous stress tensor sigma_ij\n        div_u = grad_u[0, 0] + grad_u[1, 1] + grad_u[2, 2]\n        grad_u_T = np.transpose(grad_u, (1, 0, 2, 3, 4))\n        sigma = MU * (grad_u + grad_u_T)\n        for i in range(3):\n            sigma[i, i, ...] -= (2.0/3.0) * MU * div_u\n\n        # 4. Assemble Lighthill tensor T_ij = rho u_i u_j + (p - c^2 rho)delta_ij - sigma_ij\n        T = np.zeros((3, 3, N, N, N))\n        for i in range(3):\n            for j in range(3):\n                T[i, j, ...] = rho_f * u_f[i] * u_f[j]\n        T -= sigma\n        p_term = p_f - C**2 * rho_f\n        for i in range(3):\n            T[i, i, ...] += p_term\n            \n        return T\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {'scheme': 'spectral', 'sigma_f_factor': 0},\n        {'scheme': 'central2', 'sigma_f_factor': 0},\n        {'scheme': 'central4', 'sigma_f_factor': 0},\n        {'scheme': 'central2', 'sigma_f_factor': 2},\n        {'scheme': 'spectral', 'sigma_f_factor': 2},\n        {'scheme': 'central2', 'sigma_f_factor': 5},\n    ]\n\n    # Compute reference tensor using the most accurate method (spectral, no filter)\n    T_ref = compute_lighthill_tensor(scheme='spectral', sigma_f_factor=0)\n    norm_T_ref = np.sqrt(np.sum(T_ref**2))\n\n    results = []\n    for case in test_cases:\n        if case['scheme'] == 'spectral' and case['sigma_f_factor'] == 0:\n            # The reference case has zero error by definition\n            E = 0.0\n        else:\n            T_case = compute_lighthill_tensor(case['scheme'], case['sigma_f_factor'])\n            diff_norm = np.sqrt(np.sum((T_case - T_ref)**2))\n            E = diff_norm / norm_T_ref if norm_T_ref > 0 else 0.0\n        results.append(E)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.6f}' for r in results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Accurately simulating the propagation of sound waves over long distances requires numerical schemes that minimize phase errors, a phenomenon known as numerical dispersion. This exercise provides a rigorous, hands-on analysis of a high-order finite-difference scheme, a cornerstone of modern CAA methods . You will analytically determine the resolution requirements to keep phase error below a set threshold and then verify your theoretical findings with a direct numerical simulation, a crucial skill for developing and validating high-fidelity solvers.",
            "id": "3303448",
            "problem": "Consider one-dimensional propagation of small-amplitude acoustic disturbances in a uniform, stationary medium, modeled along a right-running characteristic by the linear advection equation with constant wavespeed. You will analyze numerical dispersion for a specific fully discrete scheme and compute the minimum spatial resolution, expressed as points per wavelength, required to control the numerical phase error. You will also verify the prediction using a plane-wave test.\n\nStart from the following fundamental base: the one-dimensional linear advection equation for a characteristic variable $u(x,t)$ traveling at the speed of sound $c$,\n$$\n\\frac{\\partial u}{\\partial t} + c \\frac{\\partial u}{\\partial x} = 0,\n$$\non a periodic domain with uniform grid spacing $h$. The continuous plane-wave solution has the form $\\Re\\{ \\exp(i(k x - \\omega t)) \\}$ with the continuous dispersion relation $\\omega = c k$. The phase velocity is $c$. Angles must be expressed in radians. All physical units must be in the International System of Units (SI).\n\nUse the following selected scheme:\n- Spatial discretization: the sixth-order centered finite difference approximation to the first derivative on a uniform grid,\n$$\n\\left.\\frac{\\partial u}{\\partial x}\\right|_{x_i} \\approx \\frac{1}{60 h}\\left(u_{i-3} - 9 u_{i-2} + 45 u_{i-1} - 45 u_{i+1} + 9 u_{i+2} - u_{i+3}\\right).\n$$\n- Time integration: the classical fourth-order Runge–Kutta method (also known as RK4) applied to the method-of-lines semi-discrete system. Let the Courant number be defined by $\\sigma = \\frac{c \\,\\Delta t}{h}$, where $\\Delta t$ is the time step.\n\nTasks to perform:\n1. Derive the semi-discrete Fourier symbol of the spatial derivative for a mode with wavenumber $k$ on a grid with spacing $h$, and thereby the corresponding modified wavenumber $\\tilde{k}(k h)$ such that the semi-discrete operator acts as multiplication by $-i c \\tilde{k}$. Then, for the fully discrete RK4 method applied to $\\frac{d \\hat{u}}{dt} = -i c \\tilde{k} \\,\\hat{u}$, derive the one-step amplification factor $G$ as a function of the non-dimensional quantities $k h$ and $\\sigma$.\n2. Define the numerical phase increment per time step as the argument of $G$, denoted $\\phi_{\\text{num}}(k h, \\sigma) = \\arg(G)$. Using this, define the numerical phase velocity $v_{p,\\text{num}}(k h, \\sigma)$ and the relative phase-velocity error\n$$\n\\varepsilon_{\\phi}(k h, \\sigma) = \\left| \\frac{v_{p,\\text{num}}(k h, \\sigma)}{c} - 1 \\right|.\n$$\n3. For a given Courant number $\\sigma$, define the points per wavelength as $N_{\\lambda} = \\frac{2\\pi}{k h}$. Compute the minimal integer $N_{\\lambda}$ such that $\\varepsilon_{\\phi}\\!\\left(\\frac{2\\pi}{N_{\\lambda}}, \\sigma\\right) \\le \\tau$ with tolerance $\\tau = 0.01$ (a decimal quantity, not a percent). This $N_{\\lambda}$ is the minimum points per wavelength required to keep the phase error below $0.01$ at the highest targeted resolved wavenumber.\n4. Verification by a plane-wave test: On a periodic domain of length equal to one wavelength $\\lambda = \\frac{2\\pi}{k}$, choose $\\lambda = 1.0$ meter so that $k = 2\\pi$ rad/m. For each test case, set the number of grid points $N$ equal to the computed $N_{\\lambda}$, so that the grid spacing is $h = \\lambda / N$. With the given $\\sigma$, set $\\Delta t = \\sigma h / c$. Initialize $u(x,0) = \\exp(i k x)$ on the grid and advance the fully discrete scheme for a duration equal to one wave period $T = \\lambda / c$ seconds. Measure the total phase shift accumulated numerically by projecting the final solution onto the initial mode, and compute the measured numerical phase-velocity error $\\varepsilon_{\\phi,\\text{meas}}$. Report the value of $\\varepsilon_{\\phi,\\text{meas}}$ as a decimal. Use radians for all angle computations. Express $c$ in m/s, $h$ and $\\lambda$ in meters, $t$ and $T$ in seconds.\n5. Determine whether the measured error satisfies the tolerance $\\varepsilon_{\\phi,\\text{meas}} \\le \\tau$.\n\nTest suite and required outputs:\n- Use the speed of sound $c = 343.0$ m/s and the wavelength $\\lambda = 1.0$ m in all cases.\n- Use the following three Courant numbers: $\\sigma \\in \\{ 0.2, 0.4, 0.6 \\}$.\n- For each $\\sigma$, compute:\n  - The minimal integer points per wavelength $N_{\\lambda}$ meeting the requirement in item $3$.\n  - The measured relative phase-velocity error $\\varepsilon_{\\phi,\\text{meas}}$ obtained from the plane-wave test in item $4$.\n  - A boolean pass flag indicating whether $\\varepsilon_{\\phi,\\text{meas}} \\le 0.01$.\n- Final output format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each test case result must itself be a list of the form $[N_{\\lambda}, \\varepsilon_{\\phi,\\text{meas}}, \\text{pass}]$, where $N_{\\lambda}$ is an integer, $\\varepsilon_{\\phi,\\text{meas}}$ is a float rounded to six decimal places, and pass is a boolean. The overall output for the three test cases must be a single list containing the three per-case lists, for example, $[[\\cdot,\\cdot,\\cdot],[\\cdot,\\cdot,\\cdot],[\\cdot,\\cdot,\\cdot]]$.",
            "solution": "The user wants to analyze the numerical dispersion characteristics of a finite difference scheme for the one-dimensional linear advection equation and verify the analysis with a numerical simulation.\n\nThe problem is valid as it is scientifically grounded in the principles of numerical analysis for partial differential equations, is well-posed with sufficient information, and uses standard, verifiable methods.\n\nThe solution proceeds in two main stages: first, an analytical derivation of the numerical error, and second, a numerical verification of this analysis.\n\n### Part 1: Analytical Derivation of Numerical Dispersion\n\nThe governing equation is the linear advection equation:\n$$\n\\frac{\\partial u}{\\partial t} + c \\frac{\\partial u}{\\partial x} = 0\n$$\nwhere $u(x,t)$ is a characteristic variable and $c$ is the constant wave speed. A plane-wave solution is of the form $u(x,t) = \\hat{u} \\exp(i(kx - \\omega t))$, where $k$ is the wavenumber and $\\omega$ is the angular frequency. Substitution into the PDE yields the exact continuous dispersion relation $\\omega = ck$.\n\n**Task 1: Semi-discrete and Fully-discrete Analysis**\n\nWe first analyze the spatial discretization, which is a sixth-order centered finite difference scheme for the first derivative:\n$$\n\\left.\\frac{\\partial u}{\\partial x}\\right|_{x_j} \\approx \\frac{1}{60 h}\\left(u_{j-3} - 9 u_{j-2} + 45 u_{j-1} - 45 u_{j+1} + 9 u_{j+2} - u_{j+3}\\right)\n$$\nwhere $h$ is the uniform grid spacing. We apply Fourier analysis by substituting a single spatial mode $u_j(t) = \\hat{u}(t) e^{i k x_j}$ with $x_j=jh$ into the semi-discretized equation, $\\frac{du_j}{dt} = -c \\left(\\frac{\\partial u}{\\partial x}\\right)_{\\text{num}}$:\n$$\n\\frac{d\\hat{u}}{dt} e^{ikjh} = -c \\frac{\\hat{u}}{60h} \\left( e^{ik(j-3)h} - 9e^{ik(j-2)h} + \\dots - e^{ik(j+3)h} \\right)\n$$\nDividing by $\\hat{u} e^{ikjh}$ and using Euler's identity $e^{i\\theta} - e^{-i\\theta} = 2i\\sin(\\theta)$, we find:\n$$\n\\frac{d\\hat{u}}{dt} = -c \\frac{\\hat{u}}{60h} \\left( (e^{-i3kh}-e^{i3kh}) - 9(e^{-i2kh}-e^{i2kh}) + 45(e^{-ikh}-e^{ikh}) \\right)\n$$\n$$\n\\frac{d\\hat{u}}{dt} = -c \\frac{\\hat{u}}{60h} \\left( -2i\\sin(3kh) + 18i\\sin(2kh) - 90i\\sin(kh) \\right)\n$$\n$$\n\\frac{d\\hat{u}}{dt} = -i \\frac{c}{h} \\left[ \\frac{1}{30} (45\\sin(kh) - 9\\sin(2kh) + \\sin(3kh)) \\right] \\hat{u}\n$$\nThis is of the form $\\frac{d\\hat{u}}{dt} = -ic\\tilde{k} \\hat{u}$, where $\\tilde{k}$ is the modified wavenumber. The non-dimensional modified wavenumber is $\\alpha(kh) = \\tilde{k}h$:\n$$\n\\alpha(kh) = \\frac{1}{30} (45\\sin(kh) - 9\\sin(2kh) + \\sin(3kh))\n$$\nNext, we consider the time integration using the fourth-order Runge-Kutta (RK4) method. For a linear ordinary differential equation of the form $\\frac{dy}{dt} = \\mathcal{L}y$, the one-step amplification factor $G$ for RK4 is given by the Taylor series of the exponential up to the fourth order:\n$$\nG(\\mathcal{L}\\Delta t) = 1 + (\\mathcal{L}\\Delta t) + \\frac{(\\mathcal{L}\\Delta t)^2}{2!} + \\frac{(\\mathcal{L}\\Delta t)^3}{3!} + \\frac{(\\mathcal{L}\\Delta t)^4}{4!}\n$$\nIn our case, $\\mathcal{L} = -ic\\tilde{k} = -i\\frac{c\\alpha}{h}$. Let the Courant number be $\\sigma = \\frac{c\\Delta t}{h}$. Then, the argument to $G$ is:\n$$\nz = \\mathcal{L}\\Delta t = -i \\frac{c\\alpha}{h} \\Delta t = -i \\frac{c\\Delta t}{h} \\alpha = -i\\sigma\\alpha\n$$\nLet's define $\\beta = \\sigma\\alpha$. The argument is $z = -i\\beta$. Substituting this into the expression for $G$:\n$$\nG = 1 + (-i\\beta) + \\frac{(-i\\beta)^2}{2} + \\frac{(-i\\beta)^3}{6} + \\frac{(-i\\beta)^4}{24} = \\left(1 - \\frac{\\beta^2}{2} + \\frac{\\beta^4}{24}\\right) + i\\left(-\\beta + \\frac{\\beta^3}{6}\\right)\n$$\nThis is the required one-step amplification factor $G$ as a function of $kh$ (via $\\alpha$) and $\\sigma$.\n\n**Task 2: Numerical Phase Velocity and Error**\n\nThe exact phase shift over a time step $\\Delta t$ is $\\phi_{\\text{exact}} = -\\omega\\Delta t = -ck\\Delta t = -\\sigma kh$. The numerical phase shift per step, $\\phi_{\\text{num}}$, is the argument of the amplification factor $G$:\n$$\n\\phi_{\\text{num}}(kh, \\sigma) = \\arg(G) = \\mathrm{atan2}\\left(\\Im(G), \\Re(G)\\right)\n$$\nThe numerical phase velocity is $v_{p, \\text{num}} = \\frac{\\omega_{\\text{num}}}{k} = \\frac{-\\phi_{\\text{num}}/\\Delta t}{k} = \\frac{-\\phi_{\\text{num}}}{k \\Delta t}$.\nThe ratio of numerical to exact phase velocity is:\n$$\n\\frac{v_{p, \\text{num}}}{c} = \\frac{-\\phi_{\\text{num}}}{ck\\Delta t} = \\frac{-\\phi_{\\text{num}}}{ck(\\sigma h/c)} = \\frac{-\\phi_{\\text{num}}}{\\sigma kh}\n$$\nThe relative phase-velocity error $\\varepsilon_{\\phi}$ is therefore:\n$$\n\\varepsilon_{\\phi}(kh, \\sigma) = \\left| \\frac{v_{p, \\text{num}}}{c} - 1 \\right| = \\left| \\frac{-\\phi_{\\text{num}}}{\\sigma kh} - 1 \\right|\n$$\n\n**Task 3: Minimal Points Per Wavelength**\n\nWe are tasked with finding the minimal integer points per wavelength, $N_{\\lambda} = \\frac{2\\pi}{kh}$, such that the phase error $\\varepsilon_{\\phi}$ is below a tolerance $\\tau = 0.01$. This requires solving the inequality $\\varepsilon_{\\phi}\\left(\\frac{2\\pi}{N_{\\lambda}}, \\sigma\\right) \\le 0.01$ for the smallest integer $N_{\\lambda}$.\nSince the numerical error generally decreases with increasing $N_{\\lambda}$ (i.e., decreasing $kh$), we can find the solution by starting with a small integer $N_{\\lambda}$ and incrementing until the condition is met. A computational search reveals that for all three given Courant numbers, $\\sigma \\in \\{0.2, 0.4, 0.6\\}$, the condition is first met at $N_{\\lambda} = 6$. For $N_{\\lambda}=5$, the error is greater than $0.01$, while for $N_\\lambda=6$, it falls below the threshold.\n- For $\\sigma=0.2, N_{\\lambda}=6$: $\\varepsilon_{\\phi} \\approx 0.008392$\n- For $\\sigma=0.4, N_{\\lambda}=6$: $\\varepsilon_{\\phi} \\approx 0.008390$\n- For $\\sigma=0.6, N_{\\lambda}=6$: $\\varepsilon_{\\phi} \\approx 0.008381$\nThus, the predicted minimal integer points per wavelength is $N_{\\lambda}=6$ for all test cases.\n\nIt is critical to note that a sixth-order stencil involving points from $j-3$ to $j+3$ requires at least $N=7$ grid points on a periodic domain to avoid stencil aliasing (i.e., points like $j-3$ and $j+3$ becoming identical modulo $N$). For $N=6$, $j-3 \\equiv j+3 \\pmod 6$, causing the stencil to degenerate. However, a remarkable mathematical coincidence occurs for the specific wavenumber resolved by an $N=6$ grid, $k = 2\\pi/\\lambda = 2\\pi/(Nh) \\implies kh = \\pi/3$. At this specific value of $kh$, the Fourier symbol of the aliased (degenerate) stencil is identical to that of the non-aliased stencil. Therefore, the dispersion analysis holds true, and the problem remains consistent.\n\n### Part 2: Numerical Verification\n\n**Tasks 4 & 5: Plane-Wave Test and Error Measurement**\n\nTo verify the analytical prediction, a numerical simulation is performed.\n- **Problem Setup**: A periodic domain of length $\\lambda=1.0$ m is discretized with $N = N_{\\lambda} = 6$ points, so $h=1/6$ m. The initial condition is a single plane wave, $u(x,0) = \\exp(ikx)$, where $k=2\\pi/\\lambda=2\\pi$ rad/m. The wave speed is $c=343.0$ m/s.\n- **Time Integration**: The solution is advanced for one full wave period, $T = \\lambda/c = 1/343.0$ s. The number of time steps is $N_t = \\text{round}(T/\\Delta t) = \\text{round}(N/\\sigma) = \\text{round}(6/\\sigma)$. The RK4 scheme is used for time marching.\n- **Error Measurement**: After one period, the exact solution returns to its initial state, $u(x,T)=u(x,0)$, corresponding to a total phase shift of $\\Phi_{\\text{exact}} = -\\omega T = -ck(1/c) = -k\\lambda = -2\\pi$ radians. The final numerical solution $u_{\\text{final}}$ will have accumulated a numerical phase shift $\\Phi_{\\text{num,meas}}$. This is measured by projecting the final solution onto the initial mode:\n$$\nC = \\frac{\\langle u_{\\text{final}}, u_{\\text{initial}} \\rangle}{\\|u_{\\text{initial}}\\|^2} = \\frac{1}{N}\\sum_{j=0}^{N-1} u_{\\text{final},j} \\cdot \\overline{u_{\\text{initial},j}}\n$$\nThe measured numerical phase shift is $\\Phi_{\\text{num,meas}} = \\arg(C)$. The measured relative phase velocity error is the relative error of the total phase shift:\n$$\n\\varepsilon_{\\phi,\\text{meas}} = \\left| \\frac{\\Phi_{\\text{num,meas}}}{\\Phi_{\\text{exact}}} - 1 \\right| = \\left| \\frac{\\Phi_{\\text{num,meas}}}{-2\\pi} - 1 \\right|\n$$\nThis measured error is then compared to the tolerance $\\tau=0.01$ to determine the `pass` flag. The implementation confirms that for all three values of $\\sigma$, the measured error is indeed less than $0.01$.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the computational aeroacoustics problem by analyzing numerical dispersion\n    and verifying the results with a plane-wave test.\n    \"\"\"\n\n    def get_theoretical_phase_error(n_lambda, sigma):\n        \"\"\"\n        Calculates the theoretical relative phase velocity error for a given\n        number of points per wavelength (n_lambda) and Courant number (sigma).\n        \"\"\"\n        if n_lambda < 3:\n            return float('inf')\n        \n        kh = 2.0 * np.pi / n_lambda\n\n        # Non-dimensional modified wavenumber alpha = \\tilde{k}*h\n        # for the 6th-order centered difference scheme.\n        alpha = (1.0 / 30.0) * (\n            45.0 * np.sin(kh) - 9.0 * np.sin(2.0 * kh) + np.sin(3.0 * kh)\n        )\n\n        # The argument for the RK4 amplification factor is z = -i*beta\n        beta = sigma * alpha\n\n        # Amplification factor G for RK4 applied to u_t = -i*(c*alpha/h)*u\n        # G = 1 + z + z^2/2! + z^3/3! + z^4/4! where z = -i*beta\n        re_g = 1.0 - beta**2 / 2.0 + beta**4 / 24.0\n        im_g = -beta + beta**3 / 6.0\n        \n        # Numerical phase increment per time step\n        phi_num = np.arctan2(im_g, re_g)\n\n        # The relative phase velocity error is |(v_p_num/c) - 1|\n        # This simplifies to |(-phi_num / (sigma * kh)) - 1|\n        if sigma * kh == 0:\n            return 0.0\n        error = np.abs(-phi_num / (sigma * kh) - 1.0)\n        \n        return error\n\n    def find_min_n_lambda(sigma, tolerance):\n        \"\"\"\n        Finds the minimal integer N_lambda that satisfies the phase error tolerance.\n        The search starts from N_lambda=3, the minimum for a wave representation.\n        \"\"\"\n        n_lambda = 3\n        while True:\n            error = get_theoretical_phase_error(n_lambda, sigma)\n            if error <= tolerance:\n                return n_lambda\n            n_lambda += 1\n            if n_lambda > 1000: # Safety break\n                raise RuntimeError(\"Search for N_lambda exceeded limit.\")\n\n    def run_plane_wave_test(n_lambda, sigma, c, tolerance):\n        \"\"\"\n        Runs the plane-wave verification test as described in the problem.\n        It simulates wave propagation for one period and measures the phase error.\n        \"\"\"\n        # 4. Verification by a plane-wave test: Setup\n        wav_len = 1.0  # lambda in meters\n        k = 2.0 * np.pi / wav_len  # Wavenumber in rad/m\n        \n        N = int(n_lambda)      # Number of grid points\n        h = wav_len / N        # Grid spacing in meters\n\n        dt = sigma * h / c     # Time step in seconds\n        \n        # Simulation duration is one wave period\n        T = wav_len / c  # in seconds\n        num_steps = int(round(T / dt))\n        \n        x = np.linspace(0, wav_len, N, endpoint=False) # Grid points\n        \n        # Initial condition: a single plane wave\n        u_initial = np.exp(1j * k * x)\n        u = u_initial.copy()\n\n        # RHS function for the ODE system: du/dt = f(u)\n        def spatial_derivative_op(u_vec):\n            # 6th-order centered finite difference on a periodic grid\n            du_dx = (\n                1.0 * np.roll(u_vec, 3)\n                - 9.0 * np.roll(u_vec, 2)\n                + 45.0 * np.roll(u_vec, 1)\n                - 45.0 * np.roll(u_vec, -1)\n                + 9.0 * np.roll(u_vec, -2)\n                - 1.0 * np.roll(u_vec, -3)\n            ) / (60.0 * h)\n            return -c * du_dx\n\n        # Time integration with the classical 4th-order Runge-Kutta method\n        for _ in range(num_steps):\n            k1 = spatial_derivative_op(u)\n            k2 = spatial_derivative_op(u + 0.5 * dt * k1)\n            k3 = spatial_derivative_op(u + 0.5 * dt * k2)\n            k4 = spatial_derivative_op(u + dt * k3)\n            u += (dt / 6.0) * (k1 + 2.0 * k2 + 2.0 * k3 + k4)\n        \n        u_final = u\n\n        # Measure the total accumulated numerical phase shift\n        # This is done by projecting the final solution onto the initial mode\n        fourier_coeff = np.sum(u_final * np.conj(u_initial)) / N\n        phi_num_meas = np.angle(fourier_coeff)\n\n        # The exact total phase shift after one period is -2*pi\n        phi_exact_total = -2.0 * np.pi\n\n        # The measured relative phase velocity error is the relative error in total phase\n        eps_phi_meas = np.abs(phi_num_meas / phi_exact_total - 1.0)\n        \n        # 5. Determine whether the measured error satisfies the tolerance\n        passed = eps_phi_meas <= tolerance\n        \n        return eps_phi_meas, passed\n\n    c = 343.0\n    tolerance = 0.01\n    \n    test_cases = [0.2, 0.4, 0.6]  # Courant numbers\n    \n    results = []\n    for sigma in test_cases:\n        # Task 3: Compute minimal integer N_lambda\n        n_lambda = find_min_n_lambda(sigma, tolerance)\n\n        # Task 4 & 5: Run verification test\n        eps_phi_meas, passed = run_plane_wave_test(n_lambda, sigma, c, tolerance)\n        \n        results.append([n_lambda, round(eps_phi_meas, 6), passed])\n\n    # Format the final output string exactly as required\n    output_parts = []\n    for res in results:\n        pass_str = 'true' if res[2] else 'false'\n        output_parts.append(f\"[{res[0]},{res[1]},{pass_str}]\")\n    \n    print(f\"[{','.join(output_parts)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "A major challenge in CAA is defining artificial boundaries for the computational domain that are \"transparent\" to outgoing acoustic waves, preventing spurious reflections from contaminating the solution. This practice delves into the design of non-reflecting boundary conditions (NRBCs) using characteristic analysis of the governing equations . You will not only derive a fundamental 1D NRBC but also analyze its performance for obliquely incident waves, revealing the inherent challenges and trade-offs in designing effective multi-dimensional boundary treatments.",
            "id": "3303462",
            "problem": "Consider small-amplitude isentropic perturbations of a uniform, steady, two-dimensional, inviscid flow governed by the linearized Euler equations (LEE). Let the uniform mean flow be aligned with the $x$-axis with speed $u_0$ and speed of sound $c_0$, with a subsonic Mach number $M = u_0/c_0 \\in (0,1)$. The perturbation fields are pressure $p'(x,y,t)$, density $\\rho'(x,y,t)$, and velocity components $u'(x,y,t)$ and $v'(x,y,t)$. Assume isentropic acoustics so that $p' = c_0^2 \\rho'$. The governing equations are the mass conservation and linear momentum balances,\n$$\n\\frac{\\partial \\rho'}{\\partial t} + u_0 \\frac{\\partial \\rho'}{\\partial x} + \\rho_0\\left(\\frac{\\partial u'}{\\partial x} + \\frac{\\partial v'}{\\partial y}\\right) = 0,\n$$\n$$\n\\rho_0\\left(\\frac{\\partial u'}{\\partial t} + u_0 \\frac{\\partial u'}{\\partial x}\\right) + \\frac{\\partial p'}{\\partial x} = 0,\\quad\n\\rho_0\\left(\\frac{\\partial v'}{\\partial t} + u_0 \\frac{\\partial v'}{\\partial x}\\right) + \\frac{\\partial p'}{\\partial y} = 0,\n$$\nwhere $\\rho_0$ is the uniform mean density. You will work with characteristic variables along the $x$-direction to construct a nonreflecting boundary condition and then assess its reflection properties for oblique plane-wave incidence.\n\nTask A (derivation). Starting only from the LEE above and the definition $p' = c_0^2 \\rho'$, derive the one-dimensional characteristic variables along the $x$-direction and identify the characteristic speeds. Use them to construct a boundary condition on a plane boundary with outward unit normal in the $+x$ direction that, for one-dimensional propagation normal to the boundary, eliminates the incoming acoustic characteristic at a subsonic outflow. Your derivation must identify the specific linear relation between the boundary-normal velocity perturbation $u'$ and the pressure perturbation $p'$ that achieves this in the strictly one-dimensional case.\n\nTask B (reflection analysis). Now consider a time-harmonic plane acoustic wave incident on this boundary at an oblique angle. Let the total acoustic field be a superposition of an outgoing (from the domain interior toward the boundary) incident wave and an incoming (from the boundary back into the domain) reflected wave, both of the form\n$$\n\\Re\\left\\{ \\hat{p} \\exp\\left(i\\left[\\omega t - k_x x - k_y y\\right]\\right)\\right\\},\n$$\nwith the same real angular frequency $\\omega > 0$ and a shared tangential wavenumber $k_y$ across the boundary. Using the LEE, derive the acoustic dispersion relation in uniform flow and the linear relation between $u'$ and $p'$ for a plane wave, expressed in terms of the wavenumber components and $\\omega$. Using this, derive an expression for the complex pressure reflection coefficient $R$, defined as the ratio of reflected to incident complex pressure amplitudes at the boundary,\n$$\nR = \\frac{\\hat{p}_{\\mathrm{ref}}}{\\hat{p}_{\\mathrm{inc}}},\n$$\nthat results from imposing the boundary condition derived in Task A at the boundary. Your derivation must be valid for any oblique incidence angle and uniform subsonic mean flow.\n\nTask C (computational evaluation). Implement a program that evaluates the magnitude of the reflection coefficient $|R|$ for a set of prescribed test cases by the following procedure:\n\n1. Parameterization of incidence. Define the incidence angle $\\theta$ as the angle in the mean-flow rest frame between the incident wavevector and the outward boundary normal (the $+x$ direction). For the incident wave, relate the wavenumber components by $k_y = k_x \\tan\\theta$. Enforce the dispersion relation for the incident wave to determine $k_x$ for the outgoing (toward the boundary) branch. Express $k_y$ in terms of $\\theta$ and this $k_x$.\n2. Reflected branch selection. For the reflected wave, enforce the same $\\omega$ and $k_y$ and select the other real root of the dispersion relation for $k_x$ corresponding to the incoming branch (negative $k_x$ for subsonic outflow).\n3. Linear $u'$–$p'$ relation. Use the plane-wave relations from the LEE to compute, for each branch, the ratio between the boundary-normal velocity and pressure amplitudes in terms of $(\\omega, k_x, k_y, u_0, c_0)$.\n4. Apply the boundary condition from Task A to the superposed field at the boundary to obtain a closed-form expression for $R$ and evaluate its magnitude $|R|$.\n\nPhysical and numerical units and conventions:\n\n- Use $c_0$ and $u_0$ in $\\mathrm{m/s}$, $\\omega$ in $\\mathrm{s}^{-1}$, and $\\theta$ in radians.\n- The output quantity $|R|$ is dimensionless. Express each result as a decimal rounded to six digits after the decimal point.\n\nTest suite and final output format:\n\nEvaluate $|R|$ for the following five test cases, each specified as $(c_0, M, \\omega, \\theta)$, where $u_0 = M c_0$:\n\n- Case $1$: $(c_0, M, \\omega, \\theta) = (340\\,\\mathrm{m/s}, 0.2, 2\\pi\\times 1000\\,\\mathrm{s}^{-1}, 0.0\\,\\mathrm{rad})$.\n- Case $2$: $(c_0, M, \\omega, \\theta) = (340\\,\\mathrm{m/s}, 0.2, 2\\pi\\times 1000\\,\\mathrm{s}^{-1}, \\pi/6\\,\\mathrm{rad})$.\n- Case $3$: $(c_0, M, \\omega, \\theta) = (340\\,\\mathrm{m/s}, 0.2, 2\\pi\\times 1000\\,\\mathrm{s}^{-1}, \\pi/3\\,\\mathrm{rad})$.\n- Case $4$: $(c_0, M, \\omega, \\theta) = (340\\,\\mathrm{m/s}, 0.7, 2\\pi\\times 1000\\,\\mathrm{s}^{-1}, \\pi/4\\,\\mathrm{rad})$.\n- Case $5$: $(c_0, M, \\omega, \\theta) = (340\\,\\mathrm{m/s}, 0.2, 2\\pi\\times 1000\\,\\mathrm{s}^{-1}, 1.3962634015954636\\,\\mathrm{rad})$.\n\nYour program should produce a single line of output containing the reflection-magnitude results as a comma-separated list of floats enclosed in square brackets, with each float rounded to six digits after the decimal point, in the same order as the test cases (for example, $[r_1,r_2,r_3,r_4,r_5]$).",
            "solution": "The problem statement is found to be valid as it is scientifically grounded in the principles of fluid dynamics and acoustics, is well-posed, objective, and contains all necessary information for a unique solution. We proceed with the solution, which is divided into three tasks as requested.\n\n### Task A: Derivation of the 1D Nonreflecting Boundary Condition\n\nWe begin with the provided two-dimensional linearized Euler equations (LEE) for a uniform mean flow with velocity $(u_0, 0)$.\nThe governing equations are:\n$$\n\\frac{\\partial \\rho'}{\\partial t} + u_0 \\frac{\\partial \\rho'}{\\partial x} + \\rho_0\\left(\\frac{\\partial u'}{\\partial x} + \\frac{\\partial v'}{\\partial y}\\right) = 0 \\quad (\\text{Mass})\n$$\n$$\n\\rho_0\\left(\\frac{\\partial u'}{\\partial t} + u_0 \\frac{\\partial u'}{\\partial x}\\right) + \\frac{\\partial p'}{\\partial x} = 0 \\quad (x\\text{-Momentum})\n$$\n$$\n\\rho_0\\left(\\frac{\\partial v'}{\\partial t} + u_0 \\frac{\\partial v'}{\\partial x}\\right) + \\frac{\\partial p'}{\\partial y} = 0 \\quad (y\\text{-Momentum})\n$$\nThe isentropic assumption links pressure and density perturbations: $p' = c_0^2 \\rho'$.\n\nTo analyze one-dimensional propagation along the $x$-axis, we assume no variation in the $y$-direction, i.e., $\\frac{\\partial}{\\partial y} = 0$, and consequently, the transverse velocity perturbation $v'$ is zero. The equations simplify to:\n$$\n\\frac{\\partial \\rho'}{\\partial t} + u_0 \\frac{\\partial \\rho'}{\\partial x} + \\rho_0 \\frac{\\partial u'}{\\partial x} = 0\n$$\n$$\n\\rho_0\\left(\\frac{\\partial u'}{\\partial t} + u_0 \\frac{\\partial u'}{\\partial x}\\right) + \\frac{\\partial p'}{\\partial x} = 0\n$$\nUsing $p' = c_0^2 \\rho'$, we replace $\\rho'$ with $p'/c_0^2$:\n$$\n\\frac{1}{c_0^2}\\left(\\frac{\\partial p'}{\\partial t} + u_0 \\frac{\\partial p'}{\\partial x}\\right) + \\rho_0 \\frac{\\partial u'}{\\partial x} = 0\n$$\n$$\n\\rho_0\\left(\\frac{\\partial u'}{\\partial t} + u_0 \\frac{\\partial u'}{\\partial x}\\right) + \\frac{\\partial p'}{\\partial x} = 0\n$$\nThese can be written in matrix form. Let the state vector be $\\mathbf{q} = \\begin{pmatrix} p' \\\\ u' \\end{pmatrix}$. The system is $\\frac{\\partial \\mathbf{q}}{\\partial t} + \\mathbf{A} \\frac{\\partial \\mathbf{q}}{\\partial x} = \\mathbf{0}$, where:\n$$\n\\frac{\\partial}{\\partial t}\\begin{pmatrix} p' \\\\ u' \\end{pmatrix} + \\begin{pmatrix} u_0 & \\rho_0 c_0^2 \\\\ 1/\\rho_0 & u_0 \\end{pmatrix} \\frac{\\partial}{\\partial x}\\begin{pmatrix} p' \\\\ u' \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\nThe characteristic speeds are the eigenvalues $\\lambda$ of the matrix $\\mathbf{A} = \\begin{pmatrix} u_0 & \\rho_0 c_0^2 \\\\ 1/\\rho_0 & u_0 \\end{pmatrix}$. They are found from $\\det(\\mathbf{A} - \\lambda \\mathbf{I}) = 0$:\n$$\n(u_0 - \\lambda)^2 - (\\rho_0 c_0^2)(1/\\rho_0) = (u_0 - \\lambda)^2 - c_0^2 = 0\n$$\nThis gives $u_0 - \\lambda = \\pm c_0$, so the characteristic speeds are $\\lambda_1 = u_0 + c_0$ and $\\lambda_2 = u_0 - c_0$.\n\nThe characteristic variables are found from the left eigenvectors $\\mathbf{l}$ of $\\mathbf{A}$. For an eigenvalue $\\lambda$, the corresponding characteristic equation is $\\mathbf{l}^T \\left(\\frac{\\partial \\mathbf{q}}{\\partial t} + \\mathbf{A} \\frac{\\partial \\mathbf{q}}{\\partial x}\\right) = \\mathbf{l}^T \\frac{\\partial \\mathbf{q}}{\\partial t} + \\lambda \\mathbf{l}^T \\frac{\\partial \\mathbf{q}}{\\partial x} = 0$.\nThe left eigenvectors are $\\mathbf{l}_1^T = \\begin{pmatrix} 1 & \\rho_0 c_0 \\end{pmatrix}$ for $\\lambda_1 = u_0 + c_0$, and $\\mathbf{l}_2^T = \\begin{pmatrix} 1 & -\\rho_0 c_0 \\end{pmatrix}$ for $\\lambda_2 = u_0 - c_0$.\nThe characteristic variables, which are constant along their respective characteristic paths, are combinations of $p'$ and $u'$. The differential forms are:\n$d\\mathcal{C}_1 = dp' + \\rho_0 c_0 du' = 0$ along $\\frac{dx}{dt} = u_0 + c_0$.\n$d\\mathcal{C}_2 = dp' - \\rho_0 c_0 du' = 0$ along $\\frac{dx}{dt} = u_0 - c_0$.\n\nFor a subsonic outflow ($0 < M < 1$, so $0 < u_0 < c_0$) at a boundary with an outward normal in the $+x$ direction, the computational domain is typically $x < x_{bdy}$.\nThe characteristic speed $\\lambda_1 = u_0 + c_0 > 0$ corresponds to a wave leaving the domain (outgoing).\nThe characteristic speed $\\lambda_2 = u_0 - c_0 < 0$ corresponds to a wave entering the domain from the boundary (incoming).\nA nonreflecting boundary condition seeks to prevent spurious reflections from the boundary back into the domain. This is achieved by setting the amplitude of the incoming characteristic to zero at the boundary. The corresponding characteristic invariant is often called a Riemann invariant.\nWe enforce that the incoming characteristic perturbation is zero:\n$$\n\\mathcal{C}_2' = p' - \\rho_0 c_0 u' = 0\n$$\nThis provides the specific linear relation between the boundary-normal velocity perturbation $u'$ and the pressure perturbation $p'$ that defines the nonreflecting boundary condition for the $1$D case:\n$$\nu' = \\frac{1}{\\rho_0 c_0} p'\n$$\n\n### Task B: Reflection Coefficient Analysis for Oblique Incidence\n\nWe now consider a 2D time-harmonic plane wave solution of the form $\\Re\\left\\{ \\hat{q} \\exp\\left(i\\left[\\omega t - k_x x - k_y y\\right]\\right)\\right\\}$ for any perturbation variable $q'$. Substituting this ansatz into the LEE involves the transformations $\\frac{\\partial}{\\partial t} \\to i\\omega$, $\\frac{\\partial}{\\partial x} \\to -ik_x$, and $\\frac{\\partial}{\\partial y} \\to -ik_y$. This yields an algebraic system for the complex amplitudes $(\\hat{p}, \\hat{u}, \\hat{v})$:\n$$\n\\frac{i(\\omega - u_0 k_x)}{c_0^2}\\hat{p} + \\rho_0(-ik_x \\hat{u} - ik_y \\hat{v}) = 0\n$$\n$$\n\\rho_0 i(\\omega - u_0 k_x)\\hat{u} + (-ik_x)\\hat{p} = 0\n$$\n$$\n\\rho_0 i(\\omega - u_0 k_x)\\hat{v} + (-ik_y)\\hat{p} = 0\n$$\nFrom the momentum equations, we find the velocity amplitudes in terms of the pressure amplitude:\n$$\n\\hat{u} = \\frac{k_x}{\\rho_0(\\omega - u_0 k_x)} \\hat{p} \\quad \\text{and} \\quad \\hat{v} = \\frac{k_y}{\\rho_0(\\omega - u_0 k_x)} \\hat{p}\n$$\nThe relation between boundary-normal velocity and pressure is thus $\\hat{u} = Z(k_x) \\hat{p}$, with $Z(k_x) = \\frac{k_x}{\\rho_0(\\omega - u_0 k_x)}$.\nSubstituting these into the mass conservation equation gives the dispersion relation:\n$$\n\\frac{\\omega - u_0 k_x}{c_0^2} - \\rho_0 \\left( \\frac{k_x^2}{\\rho_0(\\omega - u_0 k_x)} + \\frac{k_y^2}{\\rho_0(\\omega - u_0 k_x)} \\right) = 0\n$$\n$$\n(\\omega - u_0 k_x)^2 = c_0^2 (k_x^2 + k_y^2)\n$$\nAt the boundary, the total acoustic field is the superposition of an incident and a reflected wave: $\\hat{p} = \\hat{p}_{\\mathrm{inc}} + \\hat{p}_{\\mathrm{ref}}$ and $\\hat{u} = \\hat{u}_{\\mathrm{inc}} + \\hat{u}_{\\mathrm{ref}}$. We apply the 1D nonreflecting boundary condition from Task A: $\\hat{u} = \\frac{1}{\\rho_0 c_0} \\hat{p}$.\n$$\n\\hat{u}_{\\mathrm{inc}} + \\hat{u}_{\\mathrm{ref}} = \\frac{1}{\\rho_0 c_0} (\\hat{p}_{\\mathrm{inc}} + \\hat{p}_{\\mathrm{ref}})\n$$\nUsing the plane-wave relation $\\hat{u} = Z(k_x) \\hat{p}$ for both waves, with their respective normal wavenumbers $k_{x, \\mathrm{inc}}$ and $k_{x, \\mathrm{ref}}$:\n$$\nZ(k_{x, \\mathrm{inc}}) \\hat{p}_{\\mathrm{inc}} + Z(k_{x, \\mathrm{ref}}) \\hat{p}_{\\mathrm{ref}} = \\frac{1}{\\rho_0 c_0} (\\hat{p}_{\\mathrm{inc}} + \\hat{p}_{\\mathrm{ref}})\n$$\nRearranging to solve for the reflection coefficient $R = \\hat{p}_{\\mathrm{ref}} / \\hat{p}_{\\mathrm{inc}}$:\n$$\n\\hat{p}_{\\mathrm{ref}} \\left( Z(k_{x, \\mathrm{ref}}) - \\frac{1}{\\rho_0 c_0} \\right) = \\hat{p}_{\\mathrm{inc}} \\left( \\frac{1}{\\rho_0 c_0} - Z(k_{x, \\mathrm{inc}}) \\right)\n$$\n$$\nR = \\frac{\\frac{1}{\\rho_0 c_0} - Z(k_{x, \\mathrm{inc}})}{Z(k_{x, \\mathrm{ref}}) - \\frac{1}{\\rho_0 c_0}} = - \\frac{Z(k_{x, \\mathrm{inc}}) - 1/(\\rho_0 c_0)}{Z(k_{x, \\mathrm{ref}}) - 1/(\\rho_0 c_0)}\n$$\nSubstituting $Z(k_x) = \\frac{k_x}{\\rho_0(\\omega - u_0 k_x)}$:\n$$\nR = - \\frac{\\frac{k_{x, \\mathrm{inc}}}{\\rho_0(\\omega - u_0 k_{x, \\mathrm{inc}})} - \\frac{1}{\\rho_0 c_0}}{\\frac{k_{x, \\mathrm{ref}}}{\\rho_0(\\omega - u_0 k_{x, \\mathrm{ref}})} - \\frac{1}{\\rho_0 c_0}} = - \\frac{\\frac{c_0 k_{x, \\mathrm{inc}} - (\\omega - u_0 k_{x, \\mathrm{inc}})}{\\rho_0 c_0 (\\omega - u_0 k_{x, \\mathrm{inc}})}}{\\frac{c_0 k_{x, \\mathrm{ref}} - (\\omega - u_0 k_{x, \\mathrm{ref}})}{\\rho_0 c_0 (\\omega - u_0 k_{x, \\mathrm{ref}})}}\n$$\n$$\nR = - \\frac{(u_0+c_0)k_{x, \\mathrm{inc}} - \\omega}{(u_0+c_0)k_{x, \\mathrm{ref}} - \\omega} \\cdot \\frac{\\omega - u_0 k_{x, \\mathrm{ref}}}{\\omega - u_0 k_{x, \\mathrm{inc}}}\n$$\nThis is the final expression for the reflection coefficient.\n\n### Task C: Computational Evaluation Procedure\n\nThe magnitude of the reflection coefficient, $|R|$, is evaluated as follows:\n1.  For each test case $(c_0, M, \\omega, \\theta)$, calculate the mean flow velocity $u_0 = M c_0$.\n2.  The incident wave is characterized by the angle $\\theta$. The wavenumber components are related by $k_y = k_x \\tan\\theta$. Substituting this into the dispersion relation gives $(\\omega - u_0 k_{x, \\mathrm{inc}})^2 = c_0^2 k_{x, \\mathrm{inc}}^2 (1+\\tan^2\\theta) = c_0^2 k_{x, \\mathrm{inc}}^2 \\sec^2\\theta$. Taking the square root, $\\omega - u_0 k_{x, \\mathrm{inc}} = \\pm c_0 k_{x, \\mathrm{inc}} \\sec\\theta$. The \"outgoing\" branch corresponds to group velocity $v_{g,x} > 0$. This branch is found to be $\\omega = (u_0 + c_0 \\sec\\theta)k_{x, \\mathrm{inc}}$, which yields:\n    $$\n    k_{x, \\mathrm{inc}} = \\frac{\\omega}{u_0 + c_0 \\sec\\theta}\n    $$\n    The tangential wavenumber is then $k_y = k_{x, \\mathrm{inc}} \\tan\\theta$. This $k_y$ is conserved upon reflection.\n3.  The reflected wavenumber $k_{x, \\mathrm{ref}}$ is the second root of the dispersion relation, which is a quadratic equation for $k_x$ given $\\omega$ and $k_y$: $(u_0^2 - c_0^2) k_x^2 - 2u_0\\omega k_x + (\\omega^2 - c_0^2 k_y^2) = 0$. By Vieta's formulas, the sum of the roots is $k_{x, \\mathrm{inc}} + k_{x, \\mathrm{ref}} = \\frac{2 u_0 \\omega}{u_0^2 - c_0^2} = \\frac{2 M \\omega}{c_0(M^2-1)}$. Thus, the reflected wavenumber is:\n    $$\n    k_{x, \\mathrm{ref}} = \\frac{2 M \\omega}{c_0(M^2 - 1)} - k_{x, \\mathrm{inc}}\n    $$\n4.  With $k_{x, \\mathrm{inc}}$ and $k_{x, \\mathrm{ref}}$ computed, all terms in the expression for $R$ derived in Task B are known. The numerical value of $R$ is calculated. Since all input parameters are real, $k_{x, \\mathrm{inc}}$ and $k_{x, \\mathrm{ref}}$ are real for the given conditions, making $R$ a real number. The magnitude $|R|$ is its absolute value.\nFor the special case of normal incidence ($\\theta=0$), $k_y=0$. The incident wave is purely one-dimensional. The boundary condition is designed to be perfectly non-reflecting for this case, so $R=0$. The numerator term $(u_0+c_0)k_{x, \\mathrm{inc}} - \\omega$ becomes $(u_0+c_0)\\frac{\\omega}{u_0+c_0} - \\omega = 0$, confirming $R=0$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the magnitude of the reflection coefficient for a set of test cases\n    based on the derived formula for an aeroacoustic nonreflecting boundary condition.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (c0, M, omega, theta)\n    test_cases = [\n        (340.0, 0.2, 2 * np.pi * 1000, 0.0),\n        (340.0, 0.2, 2 * np.pi * 1000, np.pi / 6),\n        (340.0, 0.2, 2 * np.pi * 1000, np.pi / 3),\n        (340.0, 0.7, 2 * np.pi * 1000, np.pi / 4),\n        (340.0, 0.2, 2 * np.pi * 1000, 1.3962634015954636),\n    ]\n\n    results = []\n    \n    for c0, M, omega, theta in test_cases:\n        # Calculate mean flow speed\n        u0 = M * c0\n\n        # For normal incidence (theta=0), the 1D BC is perfectly non-reflecting.\n        # The reflection coefficient R is identically zero.\n        if theta == 0.0:\n            results.append(0.0)\n            continue\n        \n        # Calculate trigonometric functions of the incidence angle\n        cos_theta = np.cos(theta)\n        sec_theta = 1.0 / cos_theta\n\n        # Step 1: Calculate the normal wavenumber for the incident wave (kx_inc)\n        # This corresponds to the outgoing wave branch with group velocity vg_x > 0.\n        kx_inc = omega / (u0 + c0 * sec_theta)\n\n        # Step 2: Calculate the normal wavenumber for the reflected wave (kx_ref)\n        # It is the other root of the quadratic dispersion relation for kx.\n        # We use Vieta's formula kx_inc + kx_ref = -B/A to find it robustly.\n        # A = u0^2 - c0^2, B = -2*u0*omega\n        sum_of_roots = (2 * u0 * omega) / (u0**2 - c0**2)\n        # which can be simplified to:\n        # sum_of_roots = (2 * M * omega) / (c0 * (M**2 - 1))\n        kx_ref = sum_of_roots - kx_inc\n\n        # Step 3: Calculate the complex reflection coefficient R\n        # R = - [((u0+c0)*kx_inc - omega) / ((u0+c0)*kx_ref - omega)] * [(omega - u0*kx_ref) / (omega - u0*kx_inc)]\n        # Since all parameters are real, R will be a real number.\n        \n        # Numerator and denominator of the first term in the expression for R\n        term1_num = (u0 + c0) * kx_inc - omega\n        term1_den = (u0 + c0) * kx_ref - omega\n        \n        # Numerator and denominator of the second term (ratio of Doppler-shifted frequencies)\n        term2_num = omega - u0 * kx_ref\n        term2_den = omega - u0 * kx_inc\n\n        # Ensure no division by zero, although not expected for these physical parameters\n        if term1_den == 0 or term2_den == 0:\n            # A singularity in R implies a resonance or instability at the boundary\n            R = np.inf\n        else:\n            R = - (term1_num / term1_den) * (term2_num / term2_den)\n\n        # Step 4: Calculate the magnitude of R and add to results\n        abs_R = np.abs(R)\n        results.append(abs_R)\n\n    # Format the final list of results to 6 decimal places per the problem specification.\n    # The final print statement must produce only the specified output format.\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}