{
    "hands_on_practices": [
        {
            "introduction": "这项基础练习旨在深入探讨由 Cahn-Hilliard 方程控制的相分离核心机制。通过对自由能势进行分析来研究均匀态的稳定性，您将揭示旋节线分解的原理，即均匀混合物自发分离为不同相的过程。本次实践对于建立关于复杂结构如何从简单初始状态中涌现的核心直觉至关重要，这是相场建模的基石。",
            "id": "3351744",
            "problem": "考虑一个由标量相场 $\\phi \\in [-1,1]$ 建模的二元混合物，其体自由能密度为 $f(\\phi) = \\dfrac{W}{4}(\\phi^{2}-1)^{2}$，其中 $W>0$ 是一个材料参数。总自由能是 Ginzburg–Landau 泛函\n$$\n\\mathcal{F}[\\phi] \\;=\\; \\int_{\\Omega} \\left( f(\\phi) + \\dfrac{\\kappa}{2}|\\nabla \\phi|^{2} \\right)\\,\\mathrm{d}V,\n$$\n其中梯度能量系数 $\\kappa>0$。动力学遵循 Cahn–Hilliard (CH) 方程，\n$$\n\\partial_{t}\\phi \\;=\\; \\nabla \\cdot \\left( M \\nabla \\mu \\right), \n\\qquad \n\\mu \\;=\\; \\dfrac{\\delta \\mathcal{F}}{\\delta \\phi},\n$$\n其中迁移率 $M>0$ 为常数，化学势 $\\mu$ 由 $\\mathcal{F}$ 的变分导数给出。考虑一个一维周期性区域 $\\Omega=[0,L]$。\n\n任务：\n- 找出 $f(\\phi)$ 的所有驻点，并仅使用基于导数的充要条件来确定哪些是极小值点。\n- 计算二阶导数 $f''(\\phi)$ 并求其在 $\\phi=\\pm 1$ 和 $\\phi=0$ 处的值。利用梯度流的线性化原理，解释在均匀态 $\\phi(x,t)=\\phi_{0}$ 下 $f''(\\phi_{0})$ 的符号如何与该状态相对于小扰动的局部稳定性相关。\n- 对 Cahn–Hilliard 动力学在均匀态 $\\phi_{0}=0$ 附近进行线性化，并推导波数为 $k$ 的傅里叶扰动模式的增长率 $\\sigma(k)$ 的色散关系。仅用 $W$ 和 $\\kappa$ 表示增长最快的不稳定模式的波数 $k_{\\max}$。\n\n答案规格：\n- 最终答案需为仅用 $W$ 和 $\\kappa$ 表示的 $k_{\\max}$ 的单一闭式解析表达式。\n- 不包含单位。\n- 无需四舍五入；提供精确表达式。",
            "solution": "该问题是对 Cahn–Hilliard 模型的标准理论分析，具有科学依据、适定且客观，因此被评估为有效。所有提供的信息都是自洽且一致的。我们接下来给出详细的解答。\n\n该问题要求完成与 Cahn–Hilliard 模型相关的三个不同任务。我们将按顺序逐一解决。\n\n首先，我们找出体自由能密度 $f(\\phi) = \\frac{W}{4}(\\phi^{2}-1)^{2}$ 的驻点并对其进行分类。驻点出现在函数对 $\\phi$ 的一阶导数为零的位置。一阶导数为：\n$$\nf'(\\phi) = \\frac{d}{d\\phi} \\left[ \\frac{W}{4}(\\phi^2 - 1)^2 \\right] = \\frac{W}{4} \\cdot 2(\\phi^2-1) \\cdot (2\\phi) = W\\phi(\\phi^2-1) = W(\\phi^3-\\phi)\n$$\n令 $f'(\\phi) = 0$ 得到 $W\\phi(\\phi^2-1) = 0$。由于 $W>0$，解为 $\\phi=0$ 和 $\\phi^2-1=0$，这给出了三个驻点 $\\phi = -1$, $\\phi = 0$ 和 $\\phi = 1$。\n\n为了确定这些驻点的性质（极小值点、极大值点或鞍点），我们使用二阶导数判别法。$f(\\phi)$ 的二阶导数是：\n$$\nf''(\\phi) = \\frac{d}{d\\phi} [W(\\phi^3-\\phi)] = W(3\\phi^2 - 1)\n$$\n我们计算 $f''(\\phi)$ 在每个驻点的值：\n- 对于 $\\phi = 0$：$f''(0) = W(3(0)^2 - 1) = -W$。由于 $W>0$，所以 $f''(0)  0$，这表明 $\\phi=0$ 是体自由能密度的一个局部极大值点。\n- 对于 $\\phi = 1$：$f''(1) = W(3(1)^2 - 1) = 2W$。由于 $W>0$，所以 $f''(1) > 0$，这表明 $\\phi=1$ 是一个局部极小值点。\n- 对于 $\\phi = -1$：$f''(-1) = W(3(-1)^2 - 1) = 2W$。由于 $W>0$，所以 $f''(-1) > 0$，这表明 $\\phi=-1$ 也是一个局部极小值点。\n\n位于 $\\phi = \\pm 1$ 的两个极小值点代表了二元混合物的稳定平衡相，而位于 $\\phi = 0$ 的极大值点代表了一个不稳定的混合态。\n\n其次，题目要求我们计算 $f''(\\phi)$ 在 $\\phi=\\pm 1$ 和 $\\phi=0$ 处的值，并解释其对均匀态稳定性的影响。如上计算：\n- $f''(\\pm 1) = 2W$\n- $f''(0) = -W$\n\n均匀态 $\\phi(x,t) = \\phi_0$ 的稳定性取决于系统对小扰动的响应。对于一个简单的非守恒梯度流（如 Allen–Cahn 方程），其动力学由 $\\partial_t \\phi \\propto -\\mu$ 描述。对一个小的、长波（空间均匀）的扰动 $\\delta\\phi$，在均匀态 $\\phi_0$（它是 $f$ 的驻点，所以 $f'(\\phi_0)=0$）附近进行线性化，我们有 $\\mu \\approx f''(\\phi_0)\\delta\\phi$。线性化的动力学变为 $\\partial_t \\delta\\phi \\propto -f''(\\phi_0)\\delta\\phi$。因此，扰动的增长率与 $-f''(\\phi_0)$ 成正比。\n- 如果 $f''(\\phi_0) > 0$ （如 $\\phi_0 = \\pm 1$ 的情况），增长率为负，小扰动会衰减。该均匀态是稳定的。这对应于系统处于一个稳定的平衡相。\n- 如果 $f''(\\phi_0)  0$ （如 $\\phi_0 = 0$ 的情况），增长率为正，小扰动会指数增长。该均匀态是不稳定的。这是旋节线分解的条件，即初始均匀的混合物会自发地分离成不同的相。\n\n第三，我们对 Cahn–Hilliard 动力学在均匀态 $\\phi_0=0$ 附近进行线性化，并推导色散关系。Cahn–Hilliard 方程为 $\\partial_t \\phi = \\nabla \\cdot (M \\nabla \\mu)$，其中化学势由变分导数给出：$\\mu = \\frac{\\delta \\mathcal{F}}{\\delta \\phi} = f'(\\phi) - \\kappa \\nabla^2 \\phi$。\n将两者结合得到：\n$$\n\\partial_t\\phi = M\\nabla^2(f'(\\phi) - \\kappa \\nabla^2\\phi)\n$$\n我们通过考虑一个小扰动 $\\delta\\phi(x,t)$，使得 $\\phi(x,t) = \\phi_0 + \\delta\\phi(x,t) = \\delta\\phi(x,t)$，来对该方程在均匀态 $\\phi_0=0$ 附近进行线性化。我们使用泰勒展开对非线性项 $f'(\\phi)$ 在 $\\phi_0=0$ 附近进行线性化：\n$$\nf'(\\phi) \\approx f'(0) + f''(0)(\\phi-0)\n$$\n如前所述，$f'(0)=0$ 且 $f''(0)=-W$。因此，线性化的表达式为 $f'(\\delta\\phi) \\approx -W\\delta\\phi$。\n将此代入 Cahn–Hilliard 方程，得到扰动 $\\delta\\phi$ 的线性化方程：\n$$\n\\partial_t \\delta\\phi = M\\nabla^2(-W\\delta\\phi - \\kappa\\nabla^2\\delta\\phi)\n$$\n在一维情况下，$\\nabla^2 = \\partial_x^2$，所以：\n$$\n\\partial_t \\delta\\phi = -M W \\frac{\\partial^2}{\\partial x^2}\\delta\\phi - M\\kappa\\frac{\\partial^4}{\\partial x^4}\\delta\\phi\n$$\n我们寻找傅里叶模式形式的解，$\\delta\\phi(x,t) = \\hat{\\phi}_k \\exp(\\sigma(k)t + ikx)$，其中 $k$ 是波数，$\\sigma(k)$ 是增长率。将此形式代入线性化的偏微分方程，我们替换时间和空间导数：\n$\\partial_t \\rightarrow \\sigma(k)$, $\\partial_x \\rightarrow ik$, $\\partial_x^2 \\rightarrow -k^2$, 以及 $\\partial_x^4 \\rightarrow k^4$。\n这会得到一个关于 $\\sigma(k)$ 的代数方程：\n$$\n\\sigma(k)\\hat{\\phi}_k = -M W (-k^2)\\hat{\\phi}_k - M\\kappa (k^4)\\hat{\\phi}_k\n$$\n两边除以 $\\hat{\\phi}_k$（非零），我们得到色散关系：\n$$\n\\sigma(k) = M W k^2 - M\\kappa k^4\n$$\n不稳定模式是指那些增长率为正的模式，即 $\\sigma(k)>0$。当 $M W k^2 > M \\kappa k^4$ 时出现这种情况，对于 $k \\ne 0$，可简化为 $k^2  W/\\kappa$。\n\n为了找到增长最快的不稳定模式的波数 $k_{\\max}$，我们必须找到使 $\\sigma(k)$ 最大化的 $k$ 值。我们计算 $\\sigma(k)$ 对 $k$ 的导数并将其设为零：\n$$\n\\frac{d\\sigma}{dk} = \\frac{d}{dk}(M W k^2 - M\\kappa k^4) = 2MWk - 4M\\kappa k^3\n$$\n将导数设为零：\n$$\n2MWk - 4M\\kappa k^3 = 2Mk(W - 2\\kappa k^2) = 0\n$$\n非平凡解（对于 $k>0$）是 $W - 2\\kappa k^2 = 0$，这给出：\n$$\nk^2 = \\frac{W}{2\\kappa}\n$$\n因此，增长最快的模式的波数是：\n$$\nk_{\\max} = \\sqrt{\\frac{W}{2\\kappa}}\n$$\n为了确认这是一个极大值，我们检查二阶导数的符号：\n$$\n\\frac{d^2\\sigma}{dk^2} = 2MW - 12M\\kappa k^2\n$$\n在 $k^2 = W/(2\\kappa)$ 处求值：\n$$\n\\frac{d^2\\sigma}{dk^2}\\bigg|_{k=k_{\\max}} = 2MW - 12M\\kappa \\left(\\frac{W}{2\\kappa}\\right) = 2MW - 6MW = -4MW\n$$\n由于 $M>0$ 和 $W>0$，二阶导数为负，这确认了 $k_{\\max}$ 对应于一个最大增长率。最终答案按要求仅依赖于 $W$ 和 $\\kappa$。",
            "answer": "$$\\boxed{\\sqrt{\\frac{W}{2\\kappa}}}$$"
        },
        {
            "introduction": "一个具有预测能力的模型需要与物理现实建立坚实的联系。本练习将指导您完成参数化 Cahn-Hilliard 模型的关键过程，将其抽象的系数（如 $\\kappa$ 和 $W$）与可测量的物理量（如界面张力 $\\sigma$ 和界面厚度 $\\xi$）联系起来。掌握这项技能使您能够配置与特定材料体系在数量上匹配的模拟，从而将理论模型应用于实际工程问题。",
            "id": "3351760",
            "problem": "考虑一个由 Cahn–Hilliard (CH) 相场理论建模的对称二元混合物。设序参量为无量纲标量 $\\phi$，其体相值为 $\\phi=\\pm 1$。单位面外深度的亥姆霍兹自由能泛函为\n$$\n\\mathcal{F}[\\phi] \\;=\\; \\int_{\\Omega} \\left[ \\frac{W}{4}\\left(\\phi^{2}-1\\right)^{2} \\;+\\; \\frac{\\kappa}{2}|\\nabla \\phi|^{2} \\right] \\,\\mathrm{d}V,\n$$\n其中 $\\kappa>0$ 为梯度能量系数，$W>0$ 为双阱势的高度参数。在没有流动的情况下，两个体相之间会形成一个平面的、平坦的平衡界面。界面张力 $\\sigma$ 等于该界面单位面积的过剩自由能。\n\n仅从该自由能结构和界面张力作为单位面积过剩自由能的定义出发，推导连接 $\\phi=-1$ 和 $\\phi=+1$ 的一维平衡剖面 $\\phi(x)$，以及联系 $\\sigma$、弥散界面长度尺度 $\\xi$ 与材料参数 $\\kappa$ 和 $W$ 的两个关系式。此处，将 $\\xi$ 定义为您所获得精确平衡剖面 $\\phi(x)$ 中出现的特征长度。\n\n您的任务是设计一个相场模型，以匹配目标界面张力 $\\sigma = 0.05\\,\\mathrm{N/m}$，同时选择弥散界面长度尺度 $\\xi = 5\\,\\mathrm{\\mu m}$。使用您推导出的关系式，计算出一对可行的参数 $(\\kappa, W)$。\n\n此外，对于在均匀笛卡尔网格上的数值模拟，要求界面的厚度（定义为在精确平衡剖面中 $\\phi$ 从 $\\phi=-0.9$ 变化到 $\\phi=+0.9$ 的距离）上至少由 $N=6$ 个网格点解析。确定满足此解析度准则的最大允许网格间距 $\\Delta x_{\\max}$。\n\n将您的最终结果表示为一个单行向量 $(\\kappa, W, \\Delta x_{\\max})$，四舍五入至四位有效数字。将 $\\kappa$ 的单位表示为 $\\mathrm{J/m}$，$W$ 的单位表示为 $\\mathrm{J/m^{3}}$，$\\Delta x_{\\max}$ 的单位表示为 $\\mathrm{\\mu m}$。",
            "solution": "首先验证该问题，以确保其科学上成立、适定且客观。所提供的 Cahn-Hilliard 自由能泛函是热力学和材料科学中的一个标准模型。在此框架内，界面张力的定义和所提出的问题都是标准的。单位是一致的：如果自由能 $\\mathcal{F}$ 的单位是焦耳（$J$），那么被积函数必须具有能量密度单位 $J/m^3$。由于 $\\phi$ 是无量纲的，这要求参数 $W$ 的单位为 $J/m^3$，梯度能量系数 $\\kappa$ 的单位为 $J/m$。目标界面张力 $\\sigma$ 以 $N/m$ 给出，这等同于 $J/m^2$，是单位面积能量的正确单位。所有参数和问题在物理上和数学上都是合理的。该问题被认定为有效。\n\n解答过程分为三个主要部分：1) 推导平衡剖面以及材料参数与物理性质之间的关系，2) 计算具体的材料参数 $(\\kappa, W)$，以及 3) 确定所需的网格间距 $\\Delta x_{\\max}$。\n\n### 第 1 部分：推导平衡剖面和物理关系\n\n我们考虑一个沿 $x$ 坐标变化的一维平面界面。序参量 $\\phi$ 仅是 $x$ 的函数，即 $\\phi = \\phi(x)$。梯度项变为 $|\\nabla \\phi|^2 = (d\\phi/dx)^2$。界面张力 $\\sigma$ 是界面单位面积的过剩自由能。对于一维剖面，这由自由能密度沿界面法线方向的积分给出：\n$$\n\\sigma = \\int_{-\\infty}^{\\infty} \\left[ \\frac{W}{4}\\left(\\phi^{2}-1\\right)^{2} + \\frac{\\kappa}{2}\\left(\\frac{d\\phi}{dx}\\right)^{2} \\right] \\,dx\n$$\n平衡剖面 $\\phi(x)$ 是使该积分最小化的函数。这是一个经典的变分法问题。被积函数是拉格朗日量 $L(\\phi, \\phi')$，其中 $\\phi' = d\\phi/dx$：\n$$\nL(\\phi, \\phi') = \\frac{W}{4}(\\phi^2 - 1)^2 + \\frac{\\kappa}{2}(\\phi')^2\n$$\n平衡剖面必须满足欧拉-拉格朗日方程：\n$$\n\\frac{d}{dx}\\left(\\frac{\\partial L}{\\partial \\phi'}\\right) - \\frac{\\partial L}{\\partial \\phi} = 0\n$$\n计算偏导数：\n$$\n\\frac{\\partial L}{\\partial \\phi'} = \\kappa \\phi' \\quad \\implies \\quad \\frac{d}{dx}\\left(\\frac{\\partial L}{\\partial \\phi'}\\right) = \\kappa \\phi''\n$$\n$$\n\\frac{\\partial L}{\\partial \\phi} = \\frac{W}{4} \\cdot 2(\\phi^2-1) \\cdot 2\\phi = W\\phi(\\phi^2-1)\n$$\n将这些代入欧拉-拉格朗日方程，得到平衡剖面的控制性常微分方程 (ODE)：\n$$\n\\kappa\\phi''(x) - W\\phi(x)(\\phi(x)^2 - 1) = 0\n$$\n为了求解这个具有边界条件 $\\phi(x \\to -\\infty) = -1$ 和 $\\phi(x \\to \\infty) = +1$ 的常微分方程，我们将其乘以 $\\phi'$ 并对 $x$ 积分。这是寻找第一运动积分的标准方法。\n$$\n\\int \\left( \\kappa\\phi''\\phi' - W\\phi(\\phi^2-1)\\phi' \\right) \\,dx = C_1\n$$\n$$\n\\frac{\\kappa}{2}(\\phi')^2 - \\frac{W}{4}(\\phi^2 - 1)^2 = C_1\n$$\n积分常数 $C_1$ 由边界条件确定。在远离界面的体相中 ($x \\to \\pm\\infty$)，我们有 $\\phi \\to \\pm 1$ 且剖面是平坦的，因此 $\\phi' \\to 0$。应用这些条件：\n$$\n\\frac{\\kappa}{2}(0)^2 - \\frac{W}{4}((\\pm 1)^2 - 1)^2 = 0 - 0 = C_1 \\quad \\implies \\quad C_1 = 0\n$$\n这得出了平衡路径上自由能密度两项之间的关键关系：\n$$\n\\frac{\\kappa}{2}(\\phi')^2 = \\frac{W}{4}(\\phi^2 - 1)^2\n$$\n该方程表明，对于平衡界面，梯度能量密度等于体势能密度。取平方根得到一个一阶可分离常微分方程：\n$$\n\\frac{d\\phi}{dx} = \\sqrt{\\frac{W}{2\\kappa}} (1 - \\phi^2)\n$$\n我们选择正根，因为我们希望 $\\phi$ 随 $x$ 从 $-1$ 增加到 $1$。分离变量并积分：\n$$\n\\int \\frac{d\\phi}{1 - \\phi^2} = \\int \\sqrt{\\frac{W}{2\\kappa}} \\,dx\n$$\n左边的积分是 $\\text{arctanh}(\\phi)$。\n$$\n\\text{arctanh}(\\phi) = \\sqrt{\\frac{W}{2\\kappa}} x + C_2\n$$\n我们将界面中心设置在 $x=0$ 处，此处 $\\phi=0$。这意味着 $\\text{arctanh}(0) = 0$，因此积分常数 $C_2=0$。\n求解 $\\phi(x)$：\n$$\n\\phi(x) = \\tanh\\left(\\sqrt{\\frac{W}{2\\kappa}} x\\right)\n$$\n问题将 $\\xi$ 定义为此剖面中的特征长度尺度。通过观察，我们确定：\n$$\n\\frac{1}{\\xi} = \\sqrt{\\frac{W}{2\\kappa}} \\quad \\implies \\quad \\xi = \\sqrt{\\frac{2\\kappa}{W}}\n$$\n这是第一个寻求的关系式。平衡剖面可以简洁地写为 $\\phi(x) = \\tanh(x/\\xi)$。\n\n接下来，我们推导界面张力 $\\sigma$ 的表达式。利用在平衡状态下两个能量密度项相等的事实：\n$$\n\\sigma = \\int_{-\\infty}^{\\infty} \\left( \\frac{\\kappa}{2}(\\phi')^2 + \\frac{\\kappa}{2}(\\phi')^2 \\right) \\,dx = \\int_{-\\infty}^{\\infty} \\kappa (\\phi')^2 \\,dx\n$$\n由 $\\phi(x) = \\tanh(x/\\xi)$，我们有 $\\phi'(x) = (1/\\xi) \\text{sech}^2(x/\\xi)$。\n$$\n\\sigma = \\int_{-\\infty}^{\\infty} \\kappa \\left( \\frac{1}{\\xi^2} \\text{sech}^4\\left(\\frac{x}{\\xi}\\right) \\right) \\,dx\n$$\n令 $u=x/\\xi$，则 $dx = \\xi du$。\n$$\n\\sigma = \\frac{\\kappa}{\\xi} \\int_{-\\infty}^{\\infty} \\text{sech}^4(u) \\,du\n$$\n该定积分的计算结果为：\n$$\n\\int_{-\\infty}^{\\infty} \\text{sech}^4(u) \\,du = \\left[ \\tanh(u) - \\frac{1}{3}\\tanh^3(u) \\right]_{-\\infty}^{\\infty} = \\left(1 - \\frac{1}{3}\\right) - \\left(-1 - \\frac{1}{3}(-1)^3\\right) = \\frac{2}{3} - \\left(-\\frac{2}{3}\\right) = \\frac{4}{3}\n$$\n因此，界面张力为：\n$$\n\\sigma = \\frac{\\kappa}{\\xi}\\frac{4}{3}\n$$\n通过将 $\\kappa = W\\xi^2/2$ 代入 $\\sigma$ 的表达式，可以找到另一个关系式：\n$$\n\\sigma = \\frac{4}{3\\xi}\\left(\\frac{W\\xi^2}{2}\\right) = \\frac{2}{3}W\\xi\n$$\n推导出的两个关系式是 $\\xi = \\sqrt{2\\kappa/W}$ 和 $\\sigma = \\frac{2}{3}W\\xi$。\n\n### 第 2 部分：模型参数 $(\\kappa, W)$ 的计算\n\n我们需要为 $\\sigma = 0.05\\,\\mathrm{N/m}$ 和 $\\xi = 5\\,\\mathrm{\\mu m} = 5 \\times 10^{-6}\\,\\mathrm{m}$ 计算 $\\kappa$ 和 $W$。我们首先重新排列推导出的关系式以求解 $\\kappa$ 和 $W$：\n由 $\\sigma = \\frac{2}{3}W\\xi$ 可得：\n$$\nW = \\frac{3\\sigma}{2\\xi}\n$$\n由 $\\sigma = \\frac{4\\kappa}{3\\xi}$ 可得：\n$$\n\\kappa = \\frac{3\\sigma\\xi}{4}\n$$\n代入给定值（注意 $1\\,\\mathrm{N/m} = 1\\,\\mathrm{J/m^2}$）：\n$$\nW = \\frac{3 \\times (0.05\\,\\mathrm{J/m^2})}{2 \\times (5 \\times 10^{-6}\\,\\mathrm{m})} = \\frac{0.15\\,\\mathrm{J/m^2}}{10 \\times 10^{-6}\\,\\mathrm{m}} = 1.5 \\times 10^4\\,\\mathrm{J/m^3}\n$$\n$$\n\\kappa = \\frac{3 \\times (0.05\\,\\mathrm{J/m^2}) \\times (5 \\times 10^{-6}\\,\\mathrm{m})}{4} = \\frac{0.75 \\times 10^{-6}\\,\\mathrm{J/m}}{4} = 0.1875 \\times 10^{-6}\\,\\mathrm{J/m} = 1.875 \\times 10^{-7}\\,\\mathrm{J/m}\n$$\n\n### 第 3 部分：最大网格间距 $\\Delta x_{\\max}$ 的计算\n\n数值解析度要求在界面厚度（定义为 $\\phi$ 从 $-0.9$ 变化到 $+0.9$ 的距离）上至少有 $N=6$ 个网格点。设此厚度为 $L_{0.9}$。\n我们需要找到 $x_1$ 和 $x_2$ 使得 $\\phi(x_1) = -0.9$ 和 $\\phi(x_2) = +0.9$。\n$$\n-0.9 = \\tanh(x_1/\\xi) \\quad \\implies \\quad x_1 = \\xi \\cdot \\text{arctanh}(-0.9) = -\\xi \\cdot \\text{arctanh}(0.9)\n$$\n$$\n+0.9 = \\tanh(x_2/\\xi) \\quad \\implies \\quad x_2 = \\xi \\cdot \\text{arctanh}(0.9)\n$$\n厚度为 $L_{0.9} = x_2 - x_1 = 2\\xi \\cdot \\text{arctanh}(0.9)$。\n使用恒等式 $\\text{arctanh}(z) = \\frac{1}{2}\\ln\\left(\\frac{1+z}{1-z}\\right)$：\n$$\n\\text{arctanh}(0.9) = \\frac{1}{2}\\ln\\left(\\frac{1+0.9}{1-0.9}\\right) = \\frac{1}{2}\\ln\\left(\\frac{1.9}{0.1}\\right) = \\frac{1}{2}\\ln(19)\n$$\n因此，界面厚度为：\n$$\nL_{0.9} = 2\\xi \\left(\\frac{1}{2}\\ln(19)\\right) = \\xi\\ln(19)\n$$\n最大允许网格间距 $\\Delta x_{\\max}$ 是此厚度除以最小网格点数 $N$：\n$$\n\\Delta x_{\\max} = \\frac{L_{0.9}}{N} = \\frac{\\xi\\ln(19)}{6}\n$$\n代入 $\\xi=5\\,\\mathrm{\\mu m}$：\n$$\n\\Delta x_{\\max} = \\frac{(5\\,\\mathrm{\\mu m})\\ln(19)}{6} \\approx \\frac{5 \\times 2.944439}{6}\\,\\mathrm{\\mu m} \\approx 2.453699\\,\\mathrm{\\mu m}\n$$\n\n### 最终结果总结\n所需值四舍五入到四位有效数字为：\n- $\\kappa = 1.875 \\times 10^{-7}\\,\\mathrm{J/m}$\n- $W = 1.500 \\times 10^4\\,\\mathrm{J/m^3}$\n- $\\Delta x_{\\max} = 2.454\\,\\mathrm{\\mu m}$\n\n最终结果以行向量 $(\\kappa, W, \\Delta x_{\\max})$ 的形式给出。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1.875 \\times 10^{-7}  1.500 \\times 10^{4}  2.454\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "由于需要在广阔的计算域中解析薄界面，相场模拟常常面临计算瓶颈。这项高级计算实践将探讨一种强大的解决方案：自适应网格加密 (AMR)。您将基于化学势残差设计并评估一个误差指标，并将其有效性与更简单的梯度指标进行比较，从而深入了解如何构建高效、智能的现代数值求解器。",
            "id": "3351809",
            "problem": "要求你使用纯数学和算法的表述，为Cahn–Hilliard相场模型设计并评估一个自适应网格加密指标。从化学势的变分定义开始。设自由能泛函为\n$$\n\\mathcal{F}[\\phi] = \\int_{\\Omega} \\left( f(\\phi) + \\frac{\\kappa}{2} \\lvert \\nabla \\phi \\rvert^2 \\right)\\, \\mathrm{d}x,\n$$\n其中双阱体自由能密度为\n$$\nf(\\phi) = \\frac{1}{4}\\left(\\phi^2 - 1\\right)^2,\n$$\n因此化学势由变分导数给出\n$$\n\\mu = \\frac{\\delta \\mathcal{F}}{\\delta \\phi} = f'(\\phi) - \\kappa \\Delta \\phi.\n$$\n考虑一维周期性区域 $\\Omega = [0,1]$ 以及平衡态界面分布\n$$\n\\phi^\\star(x) = \\tanh\\!\\left(\\frac{x - 1/2}{\\sqrt{2}\\, \\mathrm{Cn}}\\right),\n$$\n其中 $\\mathrm{Cn}  0$ 是控制扩散界面厚度的Cahn数，并设置 $\\kappa = \\mathrm{Cn}^2$，从而在连续设定中，平衡态时有 $\\mu \\equiv 0$。将在网格点 $x_i$ 处的离散化学势残差定义为\n$$\nr_\\mu(x_i) = \\mu(x_i) - f'(\\phi(x_i)) + \\kappa\\, \\Delta_h \\phi(x_i),\n$$\n其中 $\\mu(x_i) \\equiv 0$，$\\Delta_h$ 是在包含 $N$ 个点、间距为 $h = 1/N$ 的均匀网格上，带有周期性边界条件的标准二阶中心差分拉普拉斯算子，即\n$$\n\\Delta_h \\phi(x_i) = \\frac{\\phi(x_{i-1}) - 2\\phi(x_i) + \\phi(x_{i+1})}{h^2}.\n$$\n你将在这个均匀网格上构建并比较两个基于单元的指标：\n- 一个基于残差的指标\n$$\n\\eta_i = h\\, \\lvert r_\\mu(x_i) \\rvert,\n$$\n- 一个基于梯度的指标\n$\n\\gamma_i = h\\, \\lvert \\nabla_h \\phi(x_i) \\rvert\n$ 其中\n$\n\\nabla_h \\phi(x_i) = \\frac{\\phi(x_{i+1}) - \\phi(x_{i-1})}{2h}\n$。\n对于给定的预算分数 $\\beta \\in (0,1)$，将所选索引集 $S_\\eta$（相应地为 $S_\\gamma$）定义为具有最大 $\\eta_i$（相应地为 $\\gamma_i$）值的 $\\lceil \\beta N \\rceil$ 个索引。将“基准真相”界面索引集定义为\n$$\nI = \\left\\{ i \\in \\{0,1,\\dots,N-1\\} : \\lvert \\phi(x_i) \\rvert \\le \\phi_{\\mathrm{th}} \\right\\},\n$$\n阈值为 $\\phi_{\\mathrm{th}} = 0.9$。定义精确率 $P = \\lvert S \\cap I \\rvert / \\lvert S \\rvert$，召回率 $R = \\lvert S \\cap I \\rvert / \\lvert I \\rvert$，以及F1分数\n$$\n\\mathrm{F1}(S) = \\begin{cases}\n\\displaystyle \\frac{2PR}{P+R},  \\text{if } P+R0,\\\\[6pt]\n0,  \\text{otherwise}.\n\\end{cases}\n$$\n你的任务是：\n- 在具有周期性边界条件的 $N$ 点均匀网格上实现上述内容，对 $i = 0,1,\\dots,N-1$ 在网格点 $x_i = i h$ 处使用精确的解析分布 $\\phi^\\star(x)$。\n- 计算 $\\eta_i$ 和 $\\gamma_i$，为每个测试用例的预算选择 $S_\\eta$ 和 $S_\\gamma$，并评估 $\\mathrm{F1}(S_\\eta)$ 和 $\\mathrm{F1}(S_\\gamma)$。\n- 对于每个测试用例，输出差值 $\\Delta \\mathrm{F1} = \\mathrm{F1}(S_\\eta) - \\mathrm{F1}(S_\\gamma)$，结果为一个四舍五入到六位小数的浮点数。\n\n使用以下参数三元组 $(\\mathrm{Cn}, N, \\beta)$ 的测试套件，这些测试探测了不同的区域，包括相对于网格分辨率和选择预算而言的典型情况、较薄界面和非常薄的界面：\n- 测试 1：$(\\mathrm{Cn}, N, \\beta) = (0.02, 2000, 0.05)$，\n- 测试 2：$(\\mathrm{Cn}, N, \\beta) = (0.01, 2000, 0.02)$，\n- 测试 3：$(\\mathrm{Cn}, N, \\beta) = (0.005, 2000, 0.01)$。\n\n此问题中的所有量均为无量纲。你的程序应生成单行输出，其中包含用方括号括起来的、以逗号分隔的结果列表，结果按上述测试用例的顺序排列，每项均四舍五入到六位小数（例如，$[0.123456,-0.010000,0.000000]$）。",
            "solution": "该问题要求在一维情况下为Cahn–Hilliard相场模型设计和评估两种自适应网格加密指标。比较将在离散化的解析平衡解上进行，并使用F1分数作为评估指标。\n\n该过程从给定的相场变量 $\\phi$ 的自由能泛函开始：\n$$\n\\mathcal{F}[\\phi] = \\int_{\\Omega} \\left( f(\\phi) + \\frac{\\kappa}{2} \\lvert \\nabla \\phi \\rvert^2 \\right)\\, \\mathrm{d}x\n$$\n其中 $f(\\phi) = \\frac{1}{4}(\\phi^2 - 1)^2$ 是双阱势，$\\kappa$ 是梯度能量系数。化学势 $\\mu$ 是 $\\mathcal{F}$ 关于 $\\phi$ 的变分导数：\n$$\n\\mu = \\frac{\\delta \\mathcal{F}}{\\delta \\phi} = f'(\\phi) - \\kappa \\Delta \\phi\n$$\n体自由能密度的导数为 $f'(\\phi) = \\phi^3 - \\phi$。\n问题考虑了在周期性区域 $\\Omega = [0,1]$ 上的一维解析平衡分布：\n$$\n\\phi^\\star(x) = \\tanh\\!\\left(\\frac{x - 1/2}{\\sqrt{2}\\, \\mathrm{Cn}}\\right)\n$$\n其中 $\\mathrm{Cn}$ 是Cahn数。通过设置 $\\kappa = \\mathrm{Cn}^2$，可以确保对于这个连续分布，化学势恒等于零，即对于所有 $x \\in \\Omega$ 都有 $\\mu(x) = f'(\\phi^\\star(x)) - \\kappa \\Delta \\phi^\\star(x) = 0$。\n\n问题的核心在于分析该系统在离散网格上的行为。我们定义一个包含 $N$ 个点 $x_i = i h$（$i = 0, 1, \\dots, N-1$）的均匀网格，网格间距为 $h = 1/N$。在这些点上对解析解进行采样，以获得 $\\phi_i = \\phi^\\star(x_i)$。\n\n在这个离散网格上，连续导数被有限差分近似所取代。问题定义了化学势方程的一个离散残差，该残差的产生是由于将离散算子应用于解析解时，它们不能完全抵消。这个残差可作为误差指标。\n离散残差由下式给出：\n$$\nr_\\mu(x_i) = \\mu(x_i) - f'(\\phi(x_i)) + \\kappa\\, \\Delta_h \\phi(x_i)\n$$\n假设平衡条件为 $\\mu(x_i) = 0$，则残差简化为：\n$$\nr_\\mu(x_i) = \\kappa\\, \\Delta_h \\phi(x_i) - f'(\\phi(x_i))\n$$\n这里，$\\Delta_h$ 是具有周期性边界条件的拉普拉斯算子的二阶中心差分近似：\n$$\n\\Delta_h \\phi(x_i) = \\frac{\\phi_{i-1} - 2\\phi_i + \\phi_{i+1}}{h^2}\n$$\n其中索引对 $N$ 取模以实现周期性。这个残差 $r_\\mu(x_i)$ 代表了稳态Cahn-Hilliard方程有限差分格式的截断误差。\n\n构建了两种加密指标：\n1.  一种基于残差的指标，其理论动机源于后验误差分析：\n    $$\n    \\eta_i = h\\, \\lvert r_\\mu(x_i) \\rvert\n    $$\n2.  一种更简单的基于梯度的指标，它启发式地针对解变化剧烈的区域：\n    $$\n    \\gamma_i = h\\, \\lvert \\nabla_h \\phi(x_i) \\rvert\n    $$\n    其中 $\\nabla_h$ 是梯度的二阶中心差分近似：\n    $$\n    \\nabla_h \\phi(x_i) = \\frac{\\phi_{i+1} - \\phi_{i-1}}{2h}\n    $$\n    具有周期性边界条件。\n\n这些指标的性能通过它们识别“界面”区域的能力来评估。对于给定的预算分数 $\\beta \\in (0,1)$，我们选择与 $\\lceil \\beta N \\rceil$ 个最大指标值相对应的索引集。这样就得到了集合 $S_\\eta$ 和 $S_\\gamma$。\n\n“基准真相”界面区域被定义为索引集 $I$，其中相场变量的值介于两个阈值之间：\n$$\nI = \\left\\{ i \\in \\{0,1,\\dots,N-1\\} : \\lvert \\phi(x_i) \\rvert \\le \\phi_{\\mathrm{th}} \\right\\}, \\quad \\text{其中 } \\phi_{\\mathrm{th}} = 0.9.\n$$\n为了量化所选集合 $S$（$S_\\eta$ 或 $S_\\gamma$）与基准真相集合 $I$ 之间的重叠程度，我们使用精确率（$P$）和召回率（$R$）这两个指标：\n$$\nP(S,I) = \\frac{\\lvert S \\cap I \\rvert}{\\lvert S \\rvert}, \\quad R(S,I) = \\frac{\\lvert S \\cap I \\rvert}{\\lvert I \\rvert}\n$$\n将它们组合成F1分数，即精确率和召回率的调和平均数：\n$$\n\\mathrm{F1}(S) = \\begin{cases}\n\\displaystyle \\frac{2 P R}{P+R},  \\text{if } P+R0,\\\\[6pt]\n0,  \\text{otherwise}.\n\\end{cases}\n$$\n最后的任务是为三个不同的测试用例计算F1分数的差值 $\\Delta \\mathrm{F1} = \\mathrm{F1}(S_\\eta) - \\mathrm{F1}(S_\\gamma)$。\n\n对于每个测试用例 $(\\mathrm{Cn}, N, \\beta)$，算法按以下步骤进行：\n1.  初始化网格：定义 $h=1/N$ 和网格点 $x_i = ih$，其中 $i=0, \\dots, N-1$。\n2.  评估解析分布：为所有 $i$ 计算 $\\phi_i = \\tanh((x_i - 0.5) / (\\sqrt{2}\\,\\mathrm{Cn}))$。\n3.  计算指标：\n    a. 使用周期性边界条件计算离散拉普拉斯算子 $\\Delta_h \\phi_i$ 和梯度 $\\nabla_h \\phi_i$。\n    b. 计算 $f'(\\phi_i) = \\phi_i^3 - \\phi_i$。\n    c. 设置 $\\kappa = \\mathrm{Cn}^2$。\n    d. 计算残差 $r_{\\mu,i} = \\kappa \\Delta_h \\phi_i - f'(\\phi_i)$。\n    e. 计算 $\\eta_i = h \\lvert r_{\\mu,i} \\rvert$ 和 $\\gamma_i = h \\lvert \\nabla_h \\phi_i \\rvert$。\n4.  确定索引集：\n    a. 计算选择预算 $k = \\lceil \\beta N \\rceil$。\n    b. 找到 $\\eta_i$ 的 $k$ 个最大值的索引，以构成集合 $S_\\eta$。\n    c. 找到 $\\gamma_i$ 的 $k$ 个最大值的索引，以构成集合 $S_\\gamma$。\n    d. 找到满足 $\\lvert \\phi_i \\rvert \\le 0.9$ 的索引，以构成集合 $I$。\n5.  计算F1分数：\n    a. 对于每个集合 $S \\in \\{S_\\eta, S_\\gamma\\}$，计算交集 $S \\cap I$ 以及大小 $\\lvert S \\cap I \\rvert$、$\\lvert S \\rvert$ 和 $\\lvert I \\rvert$。\n    b. 计算精确率 $P$ 和召回率 $R$。如果 $\\lvert S \\rvert=0$ 或 $\\lvert I \\rvert=0$，需特别注意避免除零错误，此时将相应的指标设为 $0$。\n    c. 使用各自的 $P$ 和 $R$ 值计算 $\\mathrm{F1}(S_\\eta)$ 和 $\\mathrm{F1}(S_\\gamma)$。\n6.  计算最终结果：$\\Delta \\mathrm{F1} = \\mathrm{F1}(S_\\eta) - \\mathrm{F1}(S_\\gamma)$。\n\n此过程是确定性的，并提供了理论驱动的基于残差的指标与启发式的基于梯度的指标之间的定量比较。",
            "answer": "[0.005013,-0.006931,-0.003509]"
        }
    ]
}