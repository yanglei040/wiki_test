{
    "hands_on_practices": [
        {
            "introduction": "Understanding the Cahn-Hilliard model begins with analyzing its core driver: the free energy landscape. This first practice invites you to explore the fundamental principles of spinodal decomposition by performing a linear stability analysis . By investigating the curvature of the bulk free-energy potential, $f''(\\phi)$, and deriving the dispersion relation for perturbations, you will uncover the mechanism that selects a characteristic length scale during the initial stages of phase separation.",
            "id": "3351744",
            "problem": "Consider a binary mixture modeled by a scalar phase field $\\,\\phi\\,\\in [-1,1]\\,$ with bulk free-energy density $\\,f(\\phi) = \\dfrac{W}{4}\\,(\\phi^{2}-1)^{2}\\,$, where $\\,W>0\\,$ is a material parameter. The total free energy is the Ginzburg–Landau functional\n$$\n\\mathcal{F}[\\phi] \\;=\\; \\int_{\\Omega} \\left( f(\\phi) + \\dfrac{\\kappa}{2}\\,|\\nabla \\phi|^{2} \\right)\\,\\mathrm{d}V,\n$$\nwith gradient-energy coefficient $\\,\\kappa>0\\,$. The dynamics follow the Cahn–Hilliard (CH) equation,\n$$\n\\partial_{t}\\phi \\;=\\; \\nabla \\cdot \\left( M \\,\\nabla \\mu \\right), \n\\qquad \n\\mu \\;=\\; \\dfrac{\\delta \\mathcal{F}}{\\delta \\phi},\n$$\nwith constant mobility $\\,M>0\\,$ and chemical potential $\\,\\mu\\,$ given by the variational derivative of $\\,\\mathcal{F}\\,$. Consider a one-dimensional periodic domain $\\,\\Omega=[0,L]\\,$.\n\nTasks:\n- Identify all stationary points of $\\,f(\\phi)\\,$ and determine which are minima by using only necessary and sufficient conditions based on derivatives.\n- Compute the second derivative $\\,f''(\\phi)\\,$ and evaluate it at $\\,\\phi=\\pm 1\\,$ and $\\,\\phi=0\\,$. Explain, using linearization principles for gradient flows, how the sign of $\\,f''(\\phi_{0})\\,$ at a homogeneous state $\\,\\phi(x,t)=\\phi_{0}\\,$ relates to local stability of that state with respect to small perturbations.\n- Linearize the Cahn–Hilliard dynamics about the homogeneous state $\\,\\phi_{0}=0\\,$ and derive the dispersion relation for the growth rate $\\,\\sigma(k)\\,$ of a Fourier perturbation mode with wave number $\\,k\\,$. Determine the wave number $\\,k_{\\max}\\,$ of the fastest-growing unstable mode in terms of $\\,W\\,$ and $\\,\\kappa\\,$ only.\n\nAnswer specification:\n- Provide your final answer as the single closed-form analytic expression for $\\,k_{\\max}\\,$ in terms of $\\,W\\,$ and $\\,\\kappa\\,$ only.\n- Do not include units.\n- No rounding is required; provide an exact expression.",
            "solution": "The problem is assessed to be valid as it represents a standard theoretical analysis of the Cahn–Hilliard model, which is scientifically grounded, well-posed, and objective. All provided information is self-contained and consistent. We proceed with a detailed solution.\n\nThe problem asks for three distinct tasks related to the Cahn–Hilliard model. We will address them in sequence.\n\nFirst, we identify the stationary points of the bulk free-energy density $f(\\phi) = \\frac{W}{4}(\\phi^{2}-1)^{2}$ and classify them. Stationary points occur where the first derivative of the function with respect to $\\phi$ is zero. The first derivative is:\n$$\nf'(\\phi) = \\frac{d}{d\\phi} \\left[ \\frac{W}{4}(\\phi^2 - 1)^2 \\right] = \\frac{W}{4} \\cdot 2(\\phi^2-1) \\cdot (2\\phi) = W\\phi(\\phi^2-1) = W(\\phi^3-\\phi)\n$$\nSetting $f'(\\phi) = 0$ gives $W\\phi(\\phi^2-1) = 0$. Since $W>0$, the solutions are $\\phi=0$ and $\\phi^2-1=0$, which yields the three stationary points $\\phi = -1$, $\\phi = 0$, and $\\phi = 1$.\n\nTo determine the nature of these stationary points (minima, maxima, or saddle points), we use the second derivative test. The second derivative of $f(\\phi)$ is:\n$$\nf''(\\phi) = \\frac{d}{d\\phi} [W(\\phi^3-\\phi)] = W(3\\phi^2 - 1)\n$$\nWe evaluate $f''(\\phi)$ at each stationary point:\n- For $\\phi = 0$: $f''(0) = W(3(0)^2 - 1) = -W$. Since $W>0$, $f''(0)  0$, which indicates that $\\phi=0$ is a local maximum of the bulk free-energy density.\n- For $\\phi = 1$: $f''(1) = W(3(1)^2 - 1) = 2W$. Since $W>0$, $f''(1) > 0$, which indicates that $\\phi=1$ is a local minimum.\n- For $\\phi = -1$: $f''(-1) = W(3(-1)^2 - 1) = 2W$. Since $W>0$, $f''(-1) > 0$, which indicates that $\\phi=-1$ is also a local minimum.\n\nThe two minima at $\\phi = \\pm 1$ represent the stable, equilibrium phases of the binary mixture, while the maximum at $\\phi = 0$ represents an unstable, mixed state.\n\nSecond, we are asked to evaluate $f''(\\phi)$ at $\\phi=\\pm 1$ and $\\phi=0$ and explain the implication for the stability of homogeneous states. As calculated above:\n- $f''(\\pm 1) = 2W$\n- $f''(0) = -W$\n\nThe stability of a homogeneous state $\\phi(x,t) = \\phi_0$ depends on the system's response to small perturbations. For a simple non-conserved gradient flow (like the Allen–Cahn equation), dynamics are described by $\\partial_t \\phi \\propto -\\mu$. Linearizing around a homogeneous state $\\phi_0$ (which is a stationary point of $f$, so $f'(\\phi_0)=0$) for a small, long-wavelength (spatially uniform) perturbation $\\delta\\phi$, we have $\\mu \\approx f''(\\phi_0)\\delta\\phi$. The linearized dynamics become $\\partial_t \\delta\\phi \\propto -f''(\\phi_0)\\delta\\phi$. The growth rate of the perturbation is thus proportional to $-f''(\\phi_0)$.\n- If $f''(\\phi_0) > 0$ (as for $\\phi_0 = \\pm 1$), the growth rate is negative, and small perturbations decay. The homogeneous state is stable. This corresponds to the system being in a stable equilibrium phase.\n- If $f''(\\phi_0)  0$ (as for $\\phi_0 = 0$), the growth rate is positive, and small perturbations grow exponentially. The homogeneous state is unstable. This is the condition for spinodal decomposition, where an initially homogeneous mixture spontaneously separates into distinct phases.\n\nThird, we linearize the Cahn–Hilliard dynamics about the homogeneous state $\\phi_0=0$ and derive the dispersion relation. The Cahn–Hilliard equation is $\\partial_t \\phi = \\nabla \\cdot (M \\nabla \\mu)$, with the chemical potential given by the variational derivative $\\mu = \\frac{\\delta \\mathcal{F}}{\\delta \\phi} = f'(\\phi) - \\kappa \\nabla^2 \\phi$.\nCombining these gives:\n$$\n\\partial_t\\phi = M\\nabla^2(f'(\\phi) - \\kappa \\nabla^2\\phi)\n$$\nWe linearize this equation around the homogeneous state $\\phi_0=0$ by considering a small perturbation $\\delta\\phi(x,t)$, such that $\\phi(x,t) = \\phi_0 + \\delta\\phi(x,t) = \\delta\\phi(x,t)$. We linearize the non-linear term $f'(\\phi)$ using a Taylor expansion around $\\phi_0=0$:\n$$\nf'(\\phi) \\approx f'(0) + f''(0)(\\phi-0)\n$$\nAs established, $f'(0)=0$ and $f''(0)=-W$. Thus, the linearized expression is $f'(\\delta\\phi) \\approx -W\\delta\\phi$.\nSubstituting this into the Cahn–Hilliard equation yields the linearized equation for the perturbation $\\delta\\phi$:\n$$\n\\partial_t \\delta\\phi = M\\nabla^2(-W\\delta\\phi - \\kappa\\nabla^2\\delta\\phi)\n$$\nIn one dimension, $\\nabla^2 = \\partial_x^2$, so:\n$$\n\\partial_t \\delta\\phi = -M W \\frac{\\partial^2}{\\partial x^2}\\delta\\phi - M\\kappa\\frac{\\partial^4}{\\partial x^4}\\delta\\phi\n$$\nWe seek solutions in the form of Fourier modes, $\\delta\\phi(x,t) = \\hat{\\phi}_k \\exp(\\sigma(k)t + ikx)$, where $k$ is the wave number and $\\sigma(k)$ is the growth rate. Substituting this form into the linearized PDE, we replace temporal and spatial derivatives:\n$\\partial_t \\rightarrow \\sigma(k)$, $\\partial_x \\rightarrow ik$, $\\partial_x^2 \\rightarrow -k^2$, and $\\partial_x^4 \\rightarrow k^4$.\nThis yields an algebraic equation for $\\sigma(k)$:\n$$\n\\sigma(k)\\hat{\\phi}_k = -M W (-k^2)\\hat{\\phi}_k - M\\kappa (k^4)\\hat{\\phi}_k\n$$\nDividing by $\\hat{\\phi}_k$ (which is non-zero), we obtain the dispersion relation:\n$$\n\\sigma(k) = M W k^2 - M\\kappa k^4\n$$\nUnstable modes are those for which the growth rate is positive, $\\sigma(k)>0$. This occurs when $M W k^2 > M \\kappa k^4$, which simplifies to $k^2  W/\\kappa$ for $k \\ne 0$.\n\nTo find the wave number $k_{\\max}$ of the fastest-growing unstable mode, we must find the value of $k$ that maximizes $\\sigma(k)$. We compute the derivative of $\\sigma(k)$ with respect to $k$ and set it to zero:\n$$\n\\frac{d\\sigma}{dk} = \\frac{d}{dk}(M W k^2 - M\\kappa k^4) = 2MWk - 4M\\kappa k^3\n$$\nSetting the derivative to zero:\n$$\n2MWk - 4M\\kappa k^3 = 2Mk(W - 2\\kappa k^2) = 0\n$$\nThe non-trivial solution (for $k>0$) is $W - 2\\kappa k^2 = 0$, which gives:\n$$\nk^2 = \\frac{W}{2\\kappa}\n$$\nThe wave number of the fastest-growing mode is therefore:\n$$\nk_{\\max} = \\sqrt{\\frac{W}{2\\kappa}}\n$$\nTo confirm this is a maximum, we check the sign of the second derivative:\n$$\n\\frac{d^2\\sigma}{dk^2} = 2MW - 12M\\kappa k^2\n$$\nEvaluating at $k^2 = W/(2\\kappa)$:\n$$\n\\frac{d^2\\sigma}{dk^2}\\bigg|_{k=k_{\\max}} = 2MW - 12M\\kappa \\left(\\frac{W}{2\\kappa}\\right) = 2MW - 6MW = -4MW\n$$\nSince $M>0$ and $W>0$, the second derivative is negative, confirming that $k_{\\max}$ corresponds to a maximum growth rate. The final answer depends only on $W$ and $\\kappa$ as requested.",
            "answer": "$$\\boxed{\\sqrt{\\frac{W}{2\\kappa}}}$$"
        },
        {
            "introduction": "A powerful theoretical model is only useful if its parameters can be related to physical reality. This practice bridges the gap between the abstract Cahn-Hilliard formulation and its application by guiding you through the process of parameterizing the model to match specific material properties . You will derive the classic relationships between the model coefficients, $\\kappa$ and $W$, and physical quantities like interfacial tension, $\\sigma$, and interface thickness, $\\xi$, a critical skill for any quantitative simulation.",
            "id": "3351760",
            "problem": "Consider a symmetric binary mixture modeled by the Cahn–Hilliard (CH) phase-field theory. Let the order parameter be a nondimensional scalar $\\,\\phi\\,$ taking bulk values $\\,\\phi=\\pm 1\\,$. The Helmholtz free energy functional per unit depth in the out-of-plane direction is\n$$\n\\mathcal{F}[\\phi] \\;=\\; \\int_{\\Omega} \\left[ \\frac{W}{4}\\left(\\phi^{2}-1\\right)^{2} \\;+\\; \\frac{\\kappa}{2}|\\nabla \\phi|^{2} \\right] \\,\\mathrm{d}V,\n$$\nwith $\\,\\kappa>0\\,$ the gradient-energy coefficient and $\\,W>0\\,$ the height parameter of the double-well potential. In the absence of flow, a planar, flat equilibrium interface forms between the two bulk phases. The interfacial tension $\\,\\sigma\\,$ equals the excess free energy per unit area of this interface.\n\nStarting only from this free-energy structure and the definition of interfacial tension as excess free energy per unit area, derive the one-dimensional equilibrium profile $\\,\\phi(x)\\,$ connecting $\\,\\phi=-1\\,$ to $\\,\\phi=+1\\,$ and the two relations linking $\\,\\sigma\\,$, the diffuse-interface length scale $\\,\\xi\\,$, and the material parameters $\\,\\kappa\\,$ and $\\,W\\,$. Here, define $\\,\\xi\\,$ as the characteristic length appearing in the exact equilibrium profile $\\,\\phi(x)\\,$ you obtain.\n\nYou are tasked to design a phase-field model to match a target interfacial tension $\\,\\sigma = 0.05\\,\\mathrm{N/m}\\,$ while choosing a diffuse-interface length scale $\\,\\xi = 5\\,\\mathrm{\\mu m}\\,$. Using your derived relations, compute a feasible parameter pair $\\,(\\kappa, W)\\,$.\n\nAdditionally, for numerical simulation on a uniform Cartesian mesh, require that the interface be resolved by at least $\\,N=6\\,$ grid points across the thickness defined as the distance over which $\\,\\phi\\,$ changes from $\\,\\phi=-0.9\\,$ to $\\,\\phi=+0.9\\,$ in the exact equilibrium profile. Determine the maximum allowable grid spacing $\\,\\Delta x_{\\max}\\,$ that satisfies this resolution criterion.\n\nProvide your final result as a single row vector $\\,(\\kappa,\\,W,\\,\\Delta x_{\\max})\\,$, rounded to four significant figures. Express $\\,\\kappa\\,$ in $\\mathrm{J/m}$, $\\,W\\,$ in $\\mathrm{J/m^{3}}$, and $\\,\\Delta x_{\\max}\\,$ in $\\mathrm{\\mu m}$.",
            "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, and objective. The provided Cahn-Hilliard free energy functional is a standard model in thermodynamics and materials science. The definitions of interfacial tension and the questions posed are standard within this framework. The units are consistent: if the free energy $\\mathcal{F}$ is in Joules ($J$), then the integrand must have units of energy density, $J/m^3$. With $\\phi$ being dimensionless, this requires the parameter $W$ to have units of $J/m^3$ and the gradient energy coefficient $\\kappa$ to have units of $J/m$. The target interfacial tension $\\sigma$ is given in $N/m$, which is equivalent to $J/m^2$, the correct unit for energy per area. All parameters and questions are physically and mathematically sound. The problem is deemed valid.\n\nThe solution proceeds in three main parts: 1) derivation of the equilibrium profile and the relations between material parameters and physical properties, 2) calculation of the specific material parameters $(\\kappa, W)$, and 3) determination of the required grid spacing $\\Delta x_{\\max}$.\n\n### Part 1: Derivation of the Equilibrium Profile and Physical Relations\n\nWe are considering a one-dimensional, planar interface varying along the $x$-coordinate. The order parameter $\\phi$ is a function of $x$ only, i.e., $\\phi = \\phi(x)$. The gradient term becomes $|\\nabla \\phi|^2 = (d\\phi/dx)^2$. The interfacial tension, $\\sigma$, is the excess free energy per unit area of the interface. For a 1D profile, this is given by the integral of the free energy density along the direction normal to the interface:\n$$\n\\sigma = \\int_{-\\infty}^{\\infty} \\left[ \\frac{W}{4}\\left(\\phi^{2}-1\\right)^{2} + \\frac{\\kappa}{2}\\left(\\frac{d\\phi}{dx}\\right)^{2} \\right] \\,dx\n$$\nThe equilibrium profile $\\phi(x)$ is the function that minimizes this integral. This is a classic problem in the calculus of variations. The integrand is the Lagrangian $L(\\phi, \\phi')$, where $\\phi' = d\\phi/dx$:\n$$\nL(\\phi, \\phi') = \\frac{W}{4}(\\phi^2 - 1)^2 + \\frac{\\kappa}{2}(\\phi')^2\n$$\nThe equilibrium profile must satisfy the Euler-Lagrange equation:\n$$\n\\frac{d}{dx}\\left(\\frac{\\partial L}{\\partial \\phi'}\\right) - \\frac{\\partial L}{\\partial \\phi} = 0\n$$\nCalculating the partial derivatives:\n$$\n\\frac{\\partial L}{\\partial \\phi'} = \\kappa \\phi' \\quad \\implies \\quad \\frac{d}{dx}\\left(\\frac{\\partial L}{\\partial \\phi'}\\right) = \\kappa \\phi''\n$$\n$$\n\\frac{\\partial L}{\\partial \\phi} = \\frac{W}{4} \\cdot 2(\\phi^2-1) \\cdot 2\\phi = W\\phi(\\phi^2-1)\n$$\nSubstituting these into the Euler-Lagrange equation gives the governing ordinary differential equation (ODE) for the equilibrium profile:\n$$\n\\kappa\\phi''(x) - W\\phi(x)(\\phi(x)^2 - 1) = 0\n$$\nTo solve this ODE with boundary conditions $\\phi(x \\to -\\infty) = -1$ and $\\phi(x \\to \\infty) = +1$, we multiply by $\\phi'$ and integrate with respect to $x$. This is a standard method to find a first integral of motion.\n$$\n\\int \\left( \\kappa\\phi''\\phi' - W\\phi(\\phi^2-1)\\phi' \\right) \\,dx = C_1\n$$\n$$\n\\frac{\\kappa}{2}(\\phi')^2 - \\frac{W}{4}(\\phi^2 - 1)^2 = C_1\n$$\nThe integration constant $C_1$ is determined from the boundary conditions. In the bulk phases, far from the interface ($x \\to \\pm\\infty$), we have $\\phi \\to \\pm 1$ and the profile is flat, so $\\phi' \\to 0$. Applying these conditions:\n$$\n\\frac{\\kappa}{2}(0)^2 - \\frac{W}{4}((\\pm 1)^2 - 1)^2 = 0 - 0 = C_1 \\quad \\implies \\quad C_1 = 0\n$$\nThis yields a key relation between the two terms of the free energy density along the equilibrium path:\n$$\n\\frac{\\kappa}{2}(\\phi')^2 = \\frac{W}{4}(\\phi^2 - 1)^2\n$$\nThis equation indicates that for the equilibrium interface, the gradient energy density is equal to the bulk potential energy density. Taking the square root gives a first-order separable ODE:\n$$\n\\frac{d\\phi}{dx} = \\sqrt{\\frac{W}{2\\kappa}} (1 - \\phi^2)\n$$\nWe choose the positive root because we want $\\phi$ to increase with $x$ from $-1$ to $1$. Separating variables and integrating:\n$$\n\\int \\frac{d\\phi}{1 - \\phi^2} = \\int \\sqrt{\\frac{W}{2\\kappa}} \\,dx\n$$\nThe integral on the left is $\\text{arctanh}(\\phi)$.\n$$\n\\text{arctanh}(\\phi) = \\sqrt{\\frac{W}{2\\kappa}} x + C_2\n$$\nWe set the center of the interface at $x=0$, where $\\phi=0$. This implies $\\text{arctanh}(0) = 0$, so the integration constant $C_2=0$.\nSolving for $\\phi(x)$:\n$$\n\\phi(x) = \\tanh\\left(\\sqrt{\\frac{W}{2\\kappa}} x\\right)\n$$\nThe problem defines $\\xi$ as the characteristic length scale in this profile. By inspection, we identify:\n$$\n\\frac{1}{\\xi} = \\sqrt{\\frac{W}{2\\kappa}} \\quad \\implies \\quad \\xi = \\sqrt{\\frac{2\\kappa}{W}}\n$$\nThis is the first sought-after relation. The equilibrium profile is compactly written as $\\phi(x) = \\tanh(x/\\xi)$.\n\nNext, we derive the expression for the interfacial tension $\\sigma$. Using the fact that the two energy density terms are equal at equilibrium:\n$$\n\\sigma = \\int_{-\\infty}^{\\infty} \\left( \\frac{\\kappa}{2}(\\phi')^2 + \\frac{\\kappa}{2}(\\phi')^2 \\right) \\,dx = \\int_{-\\infty}^{\\infty} \\kappa (\\phi')^2 \\,dx\n$$\nFrom $\\phi(x) = \\tanh(x/\\xi)$, we have $\\phi'(x) = (1/\\xi) \\text{sech}^2(x/\\xi)$.\n$$\n\\sigma = \\int_{-\\infty}^{\\infty} \\kappa \\left( \\frac{1}{\\xi^2} \\text{sech}^4\\left(\\frac{x}{\\xi}\\right) \\right) \\,dx\n$$\nLet $u=x/\\xi$, so $dx = \\xi du$.\n$$\n\\sigma = \\frac{\\kappa}{\\xi} \\int_{-\\infty}^{\\infty} \\text{sech}^4(u) \\,du\n$$\nThe definite integral evaluates to:\n$$\n\\int_{-\\infty}^{\\infty} \\text{sech}^4(u) \\,du = \\left[ \\tanh(u) - \\frac{1}{3}\\tanh^3(u) \\right]_{-\\infty}^{\\infty} = \\left(1 - \\frac{1}{3}\\right) - \\left(-1 - \\frac{1}{3}(-1)^3\\right) = \\frac{2}{3} - \\left(-\\frac{2}{3}\\right) = \\frac{4}{3}\n$$\nSo, the interfacial tension is:\n$$\n\\sigma = \\frac{4\\kappa}{3\\xi}\n$$\nAn alternative second relation can be found by substituting $\\kappa = W\\xi^2/2$ into the expression for $\\sigma$:\n$$\n\\sigma = \\frac{4}{3\\xi}\\left(\\frac{W\\xi^2}{2}\\right) = \\frac{2}{3}W\\xi\n$$\nThe two derived relations are $\\xi = \\sqrt{2\\kappa/W}$ and $\\sigma = \\frac{2}{3}W\\xi$.\n\n### Part 2: Calculation of Model Parameters $(\\kappa, W)$\n\nWe need to compute $\\kappa$ and $W$ for $\\sigma = 0.05\\,\\mathrm{N/m}$ and $\\xi = 5\\,\\mathrm{\\mu m} = 5 \\times 10^{-6}\\,\\mathrm{m}$. We first rearrange the derived relations to solve for $\\kappa$ and $W$:\nFrom $\\sigma = \\frac{2}{3}W\\xi$, we get:\n$$\nW = \\frac{3\\sigma}{2\\xi}\n$$\nFrom $\\sigma = \\frac{4\\kappa}{3\\xi}$, we get:\n$$\n\\kappa = \\frac{3\\sigma\\xi}{4}\n$$\nSubstituting the given values (noting $1\\,\\mathrm{N/m} = 1\\,\\mathrm{J/m^2}$):\n$$\nW = \\frac{3 \\times (0.05\\,\\mathrm{J/m^2})}{2 \\times (5 \\times 10^{-6}\\,\\mathrm{m})} = \\frac{0.15\\,\\mathrm{J/m^2}}{10 \\times 10^{-6}\\,\\mathrm{m}} = 1.5 \\times 10^4\\,\\mathrm{J/m^3}\n$$\n$$\n\\kappa = \\frac{3 \\times (0.05\\,\\mathrm{J/m^2}) \\times (5 \\times 10^{-6}\\,\\mathrm{m})}{4} = \\frac{0.75 \\times 10^{-6}\\,\\mathrm{J/m}}{4} = 0.1875 \\times 10^{-6}\\,\\mathrm{J/m} = 1.875 \\times 10^{-7}\\,\\mathrm{J/m}\n$$\n\n### Part 3: Calculation of Maximum Grid Spacing $\\Delta x_{\\max}$\n\nThe numerical resolution requires at least $N=6$ grid points across the interface thickness, defined as the distance over which $\\phi$ changes from $-0.9$ to $+0.9$. Let this thickness be $L_{0.9}$.\nWe need to find $x_1$ and $x_2$ such that $\\phi(x_1) = -0.9$ and $\\phi(x_2) = +0.9$.\n$$\n-0.9 = \\tanh(x_1/\\xi) \\quad \\implies \\quad x_1 = \\xi \\cdot \\text{arctanh}(-0.9) = -\\xi \\cdot \\text{arctanh}(0.9)\n$$\n$$\n+0.9 = \\tanh(x_2/\\xi) \\quad \\implies \\quad x_2 = \\xi \\cdot \\text{arctanh}(0.9)\n$$\nThe thickness is $L_{0.9} = x_2 - x_1 = 2\\xi \\cdot \\text{arctanh}(0.9)$.\nUsing the identity $\\text{arctanh}(z) = \\frac{1}{2}\\ln\\left(\\frac{1+z}{1-z}\\right)$:\n$$\n\\text{arctanh}(0.9) = \\frac{1}{2}\\ln\\left(\\frac{1+0.9}{1-0.9}\\right) = \\frac{1}{2}\\ln\\left(\\frac{1.9}{0.1}\\right) = \\frac{1}{2}\\ln(19)\n$$\nSo, the interface thickness is:\n$$\nL_{0.9} = 2\\xi \\left(\\frac{1}{2}\\ln(19)\\right) = \\xi\\ln(19)\n$$\nThe maximum allowable grid spacing $\\Delta x_{\\max}$ is this thickness divided by the minimum number of grid points $N$:\n$$\n\\Delta x_{\\max} = \\frac{L_{0.9}}{N} = \\frac{\\xi\\ln(19)}{6}\n$$\nSubstituting $\\xi=5\\,\\mathrm{\\mu m}$:\n$$\n\\Delta x_{\\max} = \\frac{(5\\,\\mathrm{\\mu m})\\ln(19)}{6} \\approx \\frac{5 \\times 2.944439}{6}\\,\\mathrm{\\mu m} \\approx 2.453699\\,\\mathrm{\\mu m}\n$$\n\n### Final Result Summary\nThe required values rounded to four significant figures are:\n- $\\kappa = 1.875 \\times 10^{-7}\\,\\mathrm{J/m}$\n- $W = 1.500 \\times 10^4\\,\\mathrm{J/m^3}$\n- $\\Delta x_{\\max} = 2.454\\,\\mathrm{\\mu m}$\n\nThe final result is provided as the row vector $(\\kappa, W, \\Delta x_{\\max})$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1.875 \\times 10^{-7}  1.500 \\times 10^{4}  2.454\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Efficiently simulating the sharp, moving interfaces characteristic of phase separation is a significant computational challenge. This practice delves into the advanced topic of adaptive mesh refinement (AMR) by asking you to design and test an error indicator based on the chemical potential residual . By comparing its performance against a simpler gradient-based method, you will gain practical, hands-on experience in developing intelligent numerical strategies that are crucial for tackling complex, multiscale phase-field simulations.",
            "id": "3351809",
            "problem": "You are asked to design and evaluate an adaptive mesh refinement indicator for the Cahn–Hilliard phase-field model using a purely mathematical and algorithmic formulation. Begin from the variational definition of the chemical potential. Let the free energy functional be\n$$\n\\mathcal{F}[\\phi] = \\int_{\\Omega} \\left( f(\\phi) + \\frac{\\kappa}{2} \\lvert \\nabla \\phi \\rvert^2 \\right)\\, \\mathrm{d}x,\n$$\nwith the double-well bulk free energy density\n$$\nf(\\phi) = \\frac{1}{4}\\left(\\phi^2 - 1\\right)^2,\n$$\nso that the chemical potential is given by the variational derivative\n$$\n\\mu = \\frac{\\delta \\mathcal{F}}{\\delta \\phi} = f'(\\phi) - \\kappa \\Delta \\phi.\n$$\nConsider a one-dimensional periodic domain $\\Omega = [0,1]$ and the equilibrium interface profile\n$$\n\\phi^\\star(x) = \\tanh\\!\\left(\\frac{x - 1/2}{\\sqrt{2}\\, \\mathrm{Cn}}\\right),\n$$\nwhere $\\mathrm{Cn} > 0$ is the Cahn number controlling the diffuse interface thickness, and set $\\kappa = \\mathrm{Cn}^2$ so that $\\mu \\equiv 0$ at equilibrium in the continuous setting. Define the discrete chemical potential residual at grid point $x_i$ as\n$$\nr_\\mu(x_i) = \\mu(x_i) - f'(\\phi(x_i)) + \\kappa\\, \\Delta_h \\phi(x_i),\n$$\nwhere $\\mu(x_i) \\equiv 0$ and $\\Delta_h$ is the standard second-order central-difference Laplacian with periodic boundary conditions on a uniform grid of $N$ points and spacing $h = 1/N$, that is,\n$$\n\\Delta_h \\phi(x_i) = \\frac{\\phi(x_{i-1}) - 2\\phi(x_i) + \\phi(x_{i+1})}{h^2}.\n$$\nYou will construct and compare two per-cell indicators on this uniform grid:\n- A residual-based indicator\n$$\n\\eta_i = h\\, \\lvert r_\\mu(x_i) \\rvert,\n$$\n- A gradient-based indicator\n$$\n\\gamma_i = h\\, \\lvert \\nabla_h \\phi(x_i) \\rvert\n$$ with\n$$\n\\nabla_h \\phi(x_i) = \\frac{\\phi(x_{i+1}) - \\phi(x_{i-1})}{2h}\n.\n$$\nFor a given budget fraction $\\beta \\in (0,1)$, define the selected set of indices $S_\\eta$ (respectively $S_\\gamma$) as the $\\lceil \\beta N \\rceil$ indices with the largest values of $\\eta_i$ (respectively $\\gamma_i$). Define the “ground-truth” interface index set as\n$$\nI = \\left\\{ i \\in \\{0,1,\\dots,N-1\\} : \\lvert \\phi(x_i) \\rvert \\le \\phi_{\\mathrm{th}} \\right\\},\n$$\nwith threshold $\\phi_{\\mathrm{th}} = 0.9$. Define the precision $P = \\lvert S \\cap I \\rvert / \\lvert S \\rvert$, the recall $R = \\lvert S \\cap I \\rvert / \\lvert I \\rvert$, and the F1 score\n$$\n\\mathrm{F1}(S) = \\begin{cases}\n\\displaystyle \\frac{2PR}{P+R},  \\text{if } P+R>0, \\\\\n0,  \\text{otherwise}.\n\\end{cases}\n$$\nYour task is to:\n- Implement the above on a uniform grid of $N$ points with periodic boundary conditions, using the exact analytical profile $\\phi^\\star(x)$ at grid points $x_i = i h$ for $i = 0,1,\\dots,N-1$.\n- Compute $\\eta_i$ and $\\gamma_i$, select $S_\\eta$ and $S_\\gamma$ for each test case budget, and evaluate $\\mathrm{F1}(S_\\eta)$ and $\\mathrm{F1}(S_\\gamma)$.\n- For each test case, output the difference $\\Delta \\mathrm{F1} = \\mathrm{F1}(S_\\eta) - \\mathrm{F1}(S_\\gamma)$ as a floating-point number rounded to six decimal places.\n\nUse the following test suite of parameter triples $(\\mathrm{Cn}, N, \\beta)$ that probe different regimes, including a typical case, a thinner interface, and a very thin interface relative to the grid resolution and selection budget:\n- Test $1$: $(\\mathrm{Cn}, N, \\beta) = (0.02, 2000, 0.05)$,\n- Test $2$: $(\\mathrm{Cn}, N, \\beta) = (0.01, 2000, 0.02)$,\n- Test $3$: $(\\mathrm{Cn}, N, \\beta) = (0.005, 2000, 0.01)$.\n\nAll quantities are non-dimensional in this problem. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the above test cases, with each entry rounded to six decimal places (for example, $[0.123456,-0.010000,0.000000]$).",
            "solution": "The problem requires the design and evaluation of two adaptive mesh refinement indicators for the Cahn–Hilliard phase-field model in one dimension. The comparison is to be performed on a discretized analytical equilibrium solution, using the F1 score as the evaluation metric.\n\nThe process begins with the given free energy functional for a phase-field variable $\\phi$:\n$$\n\\mathcal{F}[\\phi] = \\int_{\\Omega} \\left( f(\\phi) + \\frac{\\kappa}{2} \\lvert \\nabla \\phi \\rvert^2 \\right)\\, \\mathrm{d}x\n$$\nwhere $f(\\phi) = \\frac{1}{4}(\\phi^2 - 1)^2$ is the double-well potential and $\\kappa$ is the gradient energy coefficient. The chemical potential $\\mu$ is the variational derivative of $\\mathcal{F}$ with respect to $\\phi$:\n$$\n\\mu = \\frac{\\delta \\mathcal{F}}{\\delta \\phi} = f'(\\phi) - \\kappa \\Delta \\phi\n$$\nThe derivative of the bulk free energy density is $f'(\\phi) = \\phi^3 - \\phi$.\nThe problem considers the one-dimensional analytical equilibrium profile on the periodic domain $\\Omega = [0,1]$:\n$$\n\\phi^\\star(x) = \\tanh\\!\\left(\\frac{x - 1/2}{\\sqrt{2}\\, \\mathrm{Cn}}\\right)\n$$\nwhere $\\mathrm{Cn}$ is the Cahn number. By setting $\\kappa = \\mathrm{Cn}^2$, it is ensured that for this continuous profile, the chemical potential is identically zero, i.e., $\\mu(x) = f'(\\phi^\\star(x)) - \\kappa \\Delta \\phi^\\star(x) = 0$ for all $x \\in \\Omega$.\n\nThe core of the problem lies in analyzing the behavior of this system on a discrete grid. We define a uniform grid of $N$ points $x_i = i h$ for $i = 0, 1, \\dots, N-1$, with grid spacing $h = 1/N$. The analytical solution is sampled at these points to obtain $\\phi_i = \\phi^\\star(x_i)$.\n\nOn this discrete grid, the continuous derivatives are replaced by finite difference approximations. The problem defines a discrete residual of the chemical potential equation, which arises because the discrete operators do not perfectly cancel when applied to the analytical solution. This residual serves as an error indicator.\nThe discrete residual is given by:\n$$\nr_\\mu(x_i) = \\mu(x_i) - f'(\\phi(x_i)) + \\kappa\\, \\Delta_h \\phi(x_i)\n$$\nAssuming the equilibrium condition $\\mu(x_i) = 0$, the residual simplifies to:\n$$\nr_\\mu(x_i) = \\kappa\\, \\Delta_h \\phi(x_i) - f'(\\phi(x_i))\n$$\nHere, $\\Delta_h$ is the second-order central difference approximation of the Laplacian with periodic boundary conditions:\n$$\n\\Delta_h \\phi(x_i) = \\frac{\\phi_{i-1} - 2\\phi_i + \\phi_{i+1}}{h^2}\n$$\nwhere indices are taken modulo $N$ to enforce periodicity. This residual, $r_\\mu(x_i)$, represents the truncation error of the finite difference scheme for the steady-state Cahn-Hilliard equation.\n\nTwo refinement indicators are constructed:\n1.  A residual-based indicator, which is theoretically motivated by a-posteriori error analysis:\n    $$\n    \\eta_i = h\\, \\lvert r_\\mu(x_i) \\rvert\n    $$\n2.  A simpler gradient-based indicator, which heuristically targets regions of high solution variation:\n    $$\n    \\gamma_i = h\\, \\lvert \\nabla_h \\phi(x_i) \\rvert\n    $$\n    where $\\nabla_h$ is the second-order central difference approximation of the gradient:\n    $$\n    \\nabla_h \\phi(x_i) = \\frac{\\phi_{i+1} - \\phi_{i-1}}{2h}\n    $$\n    with periodic boundary conditions.\n\nThe performance of these indicators is evaluated by their ability to identify the \"interface\" region. For a given budget fraction $\\beta \\in (0,1)$, we select the set of indices corresponding to the $\\lceil \\beta N \\rceil$ largest indicator values. This yields the sets $S_\\eta$ and $S_\\gamma$.\n\nThe \"ground-truth\" interface region is defined as the set of indices $I$ where the phase-field variable is between two thresholds:\n$$\nI = \\left\\{ i \\in \\{0,1,\\dots,N-1\\} : \\lvert \\phi(x_i) \\rvert \\le \\phi_{\\mathrm{th}} \\right\\}, \\quad \\text{with } \\phi_{\\mathrm{th}} = 0.9.\n$$\nTo quantify the overlap between a selected set $S$ (either $S_\\eta$ or $S_\\gamma$) and the ground-truth set $I$, we use the metrics of Precision ($P$) and Recall ($R$):\n$$\nP(S,I) = \\frac{\\lvert S \\cap I \\rvert}{\\lvert S \\rvert}, \\quad R(S,I) = \\frac{\\lvert S \\cap I \\rvert}{\\lvert I \\rvert}\n$$\nThese are combined into the F1 score, which is the harmonic mean of precision and recall:\n$$\n\\mathrm{F1}(S) = \\begin{cases}\n\\displaystyle \\frac{2 P R}{P+R},  \\text{if } P+R>0,\\\\\n0,  \\text{otherwise}.\n\\end{cases}\n$$\nThe final task is to compute the difference in F1 scores, $\\Delta \\mathrm{F1} = \\mathrm{F1}(S_\\eta) - \\mathrm{F1}(S_\\gamma)$, for three distinct test cases.\n\nThe algorithm proceeds as follows for each test case $(\\mathrm{Cn}, N, \\beta)$:\n1.  Initialize the grid: define $h=1/N$ and the grid points $x_i = ih$ for $i=0, \\dots, N-1$.\n2.  Evaluate the analytical profile: compute $\\phi_i = \\tanh((x_i - 0.5) / (\\sqrt{2}\\,\\mathrm{Cn}))$ for all $i$.\n3.  Compute the indicators:\n    a. Calculate the discrete Laplacian $\\Delta_h \\phi_i$ and gradient $\\nabla_h \\phi_i$ using periodic boundary conditions.\n    b. Calculate $f'(\\phi_i) = \\phi_i^3 - \\phi_i$.\n    c. Set $\\kappa = \\mathrm{Cn}^2$.\n    d. Compute the residual $r_{\\mu,i} = \\kappa \\Delta_h \\phi_i - f'(\\phi_i)$.\n    e. Compute $\\eta_i = h \\lvert r_{\\mu,i} \\rvert$ and $\\gamma_i = h \\lvert \\nabla_h \\phi_i \\rvert$.\n4.  Determine the index sets:\n    a. Calculate the selection budget $k = \\lceil \\beta N \\rceil$.\n    b. Find the indices of the $k$ largest values of $\\eta_i$ to form the set $S_\\eta$.\n    c. Find the indices of the $k$ largest values of $\\gamma_i$ to form the set $S_\\gamma$.\n    d. Find the indices where $\\lvert \\phi_i \\rvert \\le 0.9$ to form the set $I$.\n5.  Calculate F1 scores:\n    a. For each set $S \\in \\{S_\\eta, S_\\gamma\\}$, compute the intersection $S \\cap I$ and the sizes $\\lvert S \\cap I \\rvert$, $\\lvert S \\rvert$, and $\\lvert I \\rvert$.\n    b. Calculate precision $P$ and recall $R$. Special care is taken if $\\lvert S \\rvert=0$ or $\\lvert I \\rvert=0$ to avoid division by zero, setting the corresponding metric to $0$.\n    c. Compute $\\mathrm{F1}(S_\\eta)$ and $\\mathrm{F1}(S_\\gamma)$ using their respective $P$ and $R$ values.\n6.  Compute the final result: $\\Delta \\mathrm{F1} = \\mathrm{F1}(S_\\eta) - \\mathrm{F1}(S_\\gamma)$.\n\nThis procedure is deterministic and provides a quantitative comparison between the theoretically-motivated residual-based indicator and the heuristic gradient-based indicator.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import ...\n\ndef solve():\n    \"\"\"\n    Solves the problem of comparing two mesh refinement indicators for the\n    Cahn-Hilliard equation based on a 1D analytical equilibrium profile.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (Cn, N, beta)\n        (0.02, 2000, 0.05),\n        (0.01, 2000, 0.02),\n        (0.005, 2000, 0.01),\n    ]\n\n    results = []\n    \n    def calculate_f1_score(selected_indices, interface_indices):\n        \"\"\"\n        Calculates the F1 score given a set of selected indices and\n        ground-truth interface indices.\n        \"\"\"\n        num_selected = selected_indices.size\n        num_interface = interface_indices.size\n        \n        if num_selected == 0 and num_interface == 0:\n            return 1.0 # Or undefined, but let's be consistent. 0/0 -> P=1, R=1 can be argued. Let's make it more robust.\n        \n        num_intersection = np.intersect1d(selected_indices, interface_indices).size\n        \n        if num_selected == 0:\n            precision = 0.0\n        else:\n            precision = num_intersection / num_selected\n            \n        if num_interface == 0:\n            recall = 0.0 # No true positives to find, so recall is 0.\n        else:\n            recall = num_intersection / num_interface\n            \n        if precision + recall == 0:\n            return 0.0\n        else:\n            return 2 * (precision * recall) / (precision + recall)\n\n    for Cn, N, beta in test_cases:\n        # 1. Grid and Profile Setup\n        h = 1.0 / N\n        x = np.arange(N) * h\n        phi = np.tanh((x - 0.5) / (np.sqrt(2) * Cn))\n\n        # 2. Indicator Calculation\n        kappa = Cn**2\n        \n        # Derivatives using periodic boundaries via np.roll\n        phi_prev = np.roll(phi, 1)\n        phi_next = np.roll(phi, -1)\n        \n        # Discrete Laplacian\n        lap_phi = (phi_prev - 2*phi + phi_next) / h**2\n        # f'(phi)\n        f_prime_phi = phi**3 - phi\n        \n        # Residual\n        r_mu = kappa * lap_phi - f_prime_phi\n        \n        # Residual-based indicator\n        eta = h * np.abs(r_mu)\n        \n        # Discrete Gradient\n        grad_phi = (phi_next - phi_prev) / (2 * h)\n        \n        # Gradient-based indicator\n        gamma = h * np.abs(grad_phi)\n\n        # 3. Select cells and define ground truth\n        num_to_select = int(np.ceil(beta * N))\n        \n        # Get indices of the k largest values\n        # np.argsort sorts in ascending order, so we take the last k elements\n        s_eta_indices = np.argsort(eta)[-num_to_select:]\n        s_gamma_indices = np.argsort(gamma)[-num_to_select:]\n        \n        # Ground-truth interface set\n        phi_th = 0.9\n        interface_indices = np.where(np.abs(phi) = phi_th)[0]\n\n        # 4. Evaluate F1 scores\n        f1_eta = calculate_f1_score(s_eta_indices, interface_indices)\n        f1_gamma = calculate_f1_score(s_gamma_indices, interface_indices)\n        \n        # 5. Compute difference\n        delta_f1 = f1_eta - f1_gamma\n        results.append(delta_f1)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{res:.6f}' for res in results)}]\")\n\nsolve()\n```"
        }
    ]
}