{
    "hands_on_practices": [
        {
            "introduction": "本练习至关重要，它要求您推导Oldroyd-B流体（稀聚合物溶液的基石模型之一）的稳态应力响应。通过这个过程，您将亲眼见证粘弹性如何引出法向应力差，这是牛顿流体所不具备的标志性非牛顿效应。这是理解粘弹性本构方程预测能力的关键第一步。",
            "id": "3349184",
            "problem": "一种由 Oldroyd-B 本构框架建模的不可压缩等温聚合物溶液，承受着均匀、稳态的简单剪切流。在此模型中，总偏应力是牛顿溶剂贡献和聚合物贡献之和。溶剂贡献由黏度为 $\\eta_s$ 的牛顿定律给出。聚合物微观结构由胡克哑铃的对称正定构象张量 $\\boldsymbol{C}$ 表示，该张量根据上随体方程演化\n$$\n\\boldsymbol{C}^{\\triangledown} \\equiv \\frac{\\mathrm{D}\\boldsymbol{C}}{\\mathrm{D}t} - \\nabla \\boldsymbol{u}\\,\\boldsymbol{C} - \\boldsymbol{C}\\,(\\nabla \\boldsymbol{u})^{\\mathsf{T}} \\;=\\; -\\frac{1}{\\lambda}\\left(\\boldsymbol{C} - \\boldsymbol{I}\\right),\n$$\n其中 $\\lambda$ 是聚合物弛豫时间，$\\boldsymbol{u}$ 是速度场，$\\boldsymbol{I}$ 是单位张量。聚合物偏应力通过以下关系与构象相关：\n$$\n\\boldsymbol{\\tau}_p \\;=\\; G\\left(\\boldsymbol{C} - \\boldsymbol{I}\\right),\n$$\n其中 $G$ 是聚合物弹性模量，$\\eta_p \\equiv G \\lambda$ 是聚合物黏度。该流动是均匀、稳态的简单剪切流，速度场为 $\\boldsymbol{u} = (\\dot{\\gamma}\\, y,\\, 0,\\, 0)$，其中 $\\dot{\\gamma}$ 是恒定的剪切速率。假设在此流动中所有应力和构象分量都是空间均匀的。\n\n仅使用上述定义和不可压缩流的质量守恒 ($\\nabla \\cdot \\boldsymbol{u} = 0$)，推导第一法向应力差 $N_1 \\equiv \\sigma_{xx} - \\sigma_{yy}$ 和第二法向应力差 $N_2 \\equiv \\sigma_{yy} - \\sigma_{zz}$，以及稳态剪切黏度 $\\eta \\equiv \\tau_{xy}/\\dot{\\gamma}$ 的闭式表达式，其中 $\\boldsymbol{\\sigma}$ 是总柯西应力，$\\boldsymbol{\\tau}$ 是总偏应力（溶剂和聚合物贡献之和）。将您的最终答案表示为一个单行矩阵，其中按顺序包含 $N_1$、$N_2$ 和 $\\eta$，并用 $\\eta_s$、$\\eta_p$、$\\lambda$ 和 $\\dot{\\gamma}$ 表示。无需进行数值计算；请提供精确的解析表达式。最终答案中不要包含单位。",
            "solution": "我们从给定的 Oldroyd-B 流体的本构结构开始。总偏应力是牛顿溶剂贡献和聚合物贡献之和：\n$$\n\\boldsymbol{\\tau} \\;=\\; \\boldsymbol{\\tau}_s + \\boldsymbol{\\tau}_p, \\qquad \\boldsymbol{\\tau}_s \\;=\\; 2 \\eta_s \\boldsymbol{D}, \\qquad \\boldsymbol{\\tau}_p \\;=\\; G(\\boldsymbol{C}-\\boldsymbol{I}),\n$$\n其中 $\\boldsymbol{D} \\equiv \\tfrac{1}{2}\\left(\\nabla \\boldsymbol{u} + (\\nabla \\boldsymbol{u})^{\\mathsf{T}}\\right)$ 是变形速率张量。聚合物构象张量 $\\boldsymbol{C}$ 满足上随体方程\n$$\n\\boldsymbol{C}^{\\triangledown} \\equiv \\frac{\\mathrm{D}\\boldsymbol{C}}{\\mathrm{D}t} - \\nabla \\boldsymbol{u}\\,\\boldsymbol{C} - \\boldsymbol{C}\\,(\\nabla \\boldsymbol{u})^{\\mathsf{T}} \\;=\\; -\\frac{1}{\\lambda}\\left(\\boldsymbol{C} - \\boldsymbol{I}\\right).\n$$\n对于速度场为 $\\boldsymbol{u} = (\\dot{\\gamma}\\, y,\\, 0,\\, 0)$ 的均匀、稳态简单剪切流，$\\boldsymbol{C}$ 的所有空间导数都为零，且 $\\partial \\boldsymbol{C}/\\partial t = 0$，因此 $\\mathrm{D}\\boldsymbol{C}/\\mathrm{D}t = 0$，构象方程简化为以下代数张量方程：\n$$\n\\nabla \\boldsymbol{u}\\,\\boldsymbol{C} + \\boldsymbol{C}\\,(\\nabla \\boldsymbol{u})^{\\mathsf{T}} \\;=\\; \\frac{1}{\\lambda}\\left(\\boldsymbol{C} - \\boldsymbol{I}\\right).\n$$\n该流动的速度梯度为：\n$$\n\\nabla \\boldsymbol{u} \\;=\\; \\begin{pmatrix} 0  \\dot{\\gamma}  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix}.\n$$\n根据对称性和流动结构，稳态的 $\\boldsymbol{C}$ 具有以下形式：\n$$\n\\boldsymbol{C} \\;=\\; \\begin{pmatrix} a  b  0 \\\\ b  c  0 \\\\ 0  0  d \\end{pmatrix},\n$$\n其中 $a$、$b$、$c$ 和 $d$ 是未知标量。我们现在计算左侧。首先，\n$$\n\\nabla \\boldsymbol{u}\\,\\boldsymbol{C} \\;=\\; \\begin{pmatrix} 0  \\dot{\\gamma}  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix} \\begin{pmatrix} a  b  0 \\\\ b  c  0 \\\\ 0  0  d \\end{pmatrix} \\;=\\; \\begin{pmatrix} \\dot{\\gamma} b  \\dot{\\gamma} c  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix},\n$$\n并且\n$$\n\\boldsymbol{C}\\,(\\nabla \\boldsymbol{u})^{\\mathsf{T}} \\;=\\; \\begin{pmatrix} a  b  0 \\\\ b  c  0 \\\\ 0  0  d \\end{pmatrix} \\begin{pmatrix} 0  0  0 \\\\ \\dot{\\gamma}  0  0 \\\\ 0  0  0 \\end{pmatrix} \\;=\\; \\begin{pmatrix} \\dot{\\gamma} b  0  0 \\\\ \\dot{\\gamma} c  0  0 \\\\ 0  0  0 \\end{pmatrix}.\n$$\n求和得到：\n$$\n\\nabla \\boldsymbol{u}\\,\\boldsymbol{C} + \\boldsymbol{C}\\,(\\nabla \\boldsymbol{u})^{\\mathsf{T}} \\;=\\; \\begin{pmatrix} 2 \\dot{\\gamma} b  \\dot{\\gamma} c  0 \\\\ \\dot{\\gamma} c  0  0 \\\\ 0  0  0 \\end{pmatrix}.\n$$\n因此，稳态构象方程的分量形式为：\n$$\n\\begin{pmatrix} 2 \\dot{\\gamma} b  \\dot{\\gamma} c  0 \\\\ \\dot{\\gamma} c  0  0 \\\\ 0  0  0 \\end{pmatrix} \\;=\\; \\frac{1}{\\lambda} \\begin{pmatrix} a-1  b  0 \\\\ b  c-1  0 \\\\ 0  0  d-1 \\end{pmatrix}.\n$$\n令各分量相等，得到以下线性方程组：\n$$\n2 \\dot{\\gamma} b \\;=\\; \\frac{1}{\\lambda}(a-1), \\qquad \\dot{\\gamma} c \\;=\\; \\frac{1}{\\lambda} b, \\qquad 0 \\;=\\; \\frac{1}{\\lambda}(c-1), \\qquad 0 \\;=\\; \\frac{1}{\\lambda}(d-1).\n$$\n依次求解，\n$$\nc \\;=\\; 1, \\qquad d \\;=\\; 1, \\qquad b \\;=\\; \\lambda \\dot{\\gamma} c \\;=\\; \\lambda \\dot{\\gamma}, \\qquad a \\;=\\; 1 + 2 \\lambda \\dot{\\gamma} b \\;=\\; 1 + 2 (\\lambda \\dot{\\gamma})^{2}.\n$$\n因此\n$$\n\\boldsymbol{C} \\;=\\; \\begin{pmatrix} 1 + 2 (\\lambda \\dot{\\gamma})^{2}  \\lambda \\dot{\\gamma}  0 \\\\ \\lambda \\dot{\\gamma}  1  0 \\\\ 0  0  1 \\end{pmatrix}.\n$$\n聚合物偏应力为 $\\boldsymbol{\\tau}_p = G(\\boldsymbol{C}-\\boldsymbol{I})$，并使用 $\\eta_p = G \\lambda$，\n$$\n\\tau_{p,xx} \\;=\\; G\\left(2 (\\lambda \\dot{\\gamma})^{2}\\right) \\;=\\; 2 \\eta_p \\lambda \\dot{\\gamma}^{2}, \\qquad \\tau_{p,yy} \\;=\\; 0, \\qquad \\tau_{p,zz} \\;=\\; 0, \\qquad \\tau_{p,xy} \\;=\\; G(\\lambda \\dot{\\gamma}) \\;=\\; \\eta_p \\dot{\\gamma}.\n$$\n溶剂偏应力是牛顿型的，$\\boldsymbol{\\tau}_s = 2 \\eta_s \\boldsymbol{D}$，对于简单剪切流 $\\boldsymbol{u} = (\\dot{\\gamma} y,0,0)$，$\\boldsymbol{D}$ 的唯一非零分量是 $D_{xy} = D_{yx} = \\dot{\\gamma}/2$，所以\n$$\n\\tau_{s,xy} \\;=\\; \\eta_s \\dot{\\gamma}, \\qquad \\tau_{s,xx} \\;=\\; \\tau_{s,yy} \\;=\\; \\tau_{s,zz} \\;=\\; 0.\n$$\n因此，所需的总偏应力分量为：\n$$\n\\tau_{xy} \\;=\\; \\tau_{s,xy} + \\tau_{p,xy} \\;=\\; (\\eta_s + \\eta_p)\\,\\dot{\\gamma}, \\qquad \\tau_{xx} \\;=\\; 2 \\eta_p \\lambda \\dot{\\gamma}^{2}, \\qquad \\tau_{yy} \\;=\\; 0, \\qquad \\tau_{zz} \\;=\\; 0.\n$$\n第一和第二法向应力差定义为 $N_1 \\equiv \\sigma_{xx} - \\sigma_{yy}$ 和 $N_2 \\equiv \\sigma_{yy} - \\sigma_{zz}$。各向同性压力在这些差值中被抵消，因此 $N_1$ 和 $N_2$ 由偏应力分量决定：\n$$\nN_1 \\;=\\; \\tau_{xx} - \\tau_{yy} \\;=\\; 2 \\eta_p \\lambda \\dot{\\gamma}^{2}, \\qquad N_2 \\;=\\; \\tau_{yy} - \\tau_{zz} \\;=\\; 0.\n$$\n稳态剪切黏度定义为 $\\eta \\equiv \\tau_{xy}/\\dot{\\gamma}$，因此\n$$\n\\eta \\;=\\; \\eta_s + \\eta_p.\n$$\n按要求的顺序 $(N_1, N_2, \\eta)$ 收集结果，即可得到用 $\\eta_s$、$\\eta_p$、$\\lambda$ 和 $\\dot{\\gamma}$ 表示的所需闭式表达式。",
            "answer": "$$\\boxed{\\begin{pmatrix}2\\,\\eta_p\\,\\lambda\\,\\dot{\\gamma}^{2}  0  \\eta_s+\\eta_p\\end{pmatrix}}$$"
        },
        {
            "introduction": "在Oldroyd-B模型的基础上，本问题探讨其在不同运动学背景下的行为：单轴拉伸流。您将推导拉伸粘度，并发现它在临界拉伸速率下会预测出一个非物理的无限大应力。这种“线圈-拉伸转变”奇异性是著名的“高Weissenberg数难题”的理论根源，该难题困扰着粘弹性CFD模拟。",
            "id": "3349156",
            "problem": "考虑在计算流体动力学 (CFD) 框架内，由 Oldroyd-B (OB) 本构方程建模的稀聚合物溶液。总柯西应力由 $\\boldsymbol{\\sigma} = -p \\mathbf{I} + 2 \\eta_{s} \\mathbf{D} + \\boldsymbol{\\tau}$ 给出，其中 $p$ 是压力，$\\mathbf{I}$ 是单位张量，$\\eta_{s}$ 是溶剂粘度，$\\mathbf{D} = \\frac{1}{2}\\left(\\nabla \\mathbf{v} + \\left(\\nabla \\mathbf{v}\\right)^{\\top}\\right)$ 是变形率张量，$\\boldsymbol{\\tau}$ 是聚合物附加应力，满足 Oldroyd-B 关系的上随流 Maxwell 形式，\n$$\n\\boldsymbol{\\tau} + \\lambda \\boldsymbol{\\tau}^{\\nabla} = 2 \\eta_{p} \\mathbf{D},\n$$\n其中 $\\lambda$ 是松弛时间，$\\eta_{p}$ 是聚合物粘度。上随流导数定义为\n$$\n\\boldsymbol{\\tau}^{\\nabla} = \\frac{\\partial \\boldsymbol{\\tau}}{\\partial t} + \\mathbf{v} \\cdot \\nabla \\boldsymbol{\\tau} - ((\\nabla \\mathbf{v}) \\cdot \\boldsymbol{\\tau} + \\boldsymbol{\\tau} \\cdot (\\nabla \\mathbf{v})^{\\top}).\n$$\n考虑一个不可压缩、稳态、均匀的单轴拉伸流，沿 $z$ 轴拉伸，其速度场为\n$$\n\\mathbf{v} = \\left(-\\tfrac{1}{2} \\dot{\\epsilon} x,\\ -\\tfrac{1}{2} \\dot{\\epsilon} y,\\ \\dot{\\epsilon} z\\right),\n$$\n其中 $\\dot{\\epsilon}$ 是恒定拉伸率，且 $\\nabla \\cdot \\mathbf{v} = 0$。仅使用这些定义和基本连续介质力学，推导 Oldroyd-B 流体的单轴拉伸粘度\n$$\n\\eta_{E}(\\dot{\\epsilon}) = \\frac{\\sigma_{zz} - \\tfrac{1}{2}\\left(\\sigma_{xx} + \\sigma_{yy}\\right)}{\\dot{\\epsilon}}\n$$\n的解析表达式。然后，通过检验你的表达式，确定 $\\eta_{E}$ 发散时 $\\dot{\\epsilon}$ 的值，并从弹性不稳定性的角度解释该发散的物理意义。将 $\\eta_{E}(\\dot{\\epsilon})$ 的最终答案表示为 $\\eta_{s}$、$\\eta_{p}$、$\\lambda$ 和 $\\dot{\\epsilon}$ 的封闭形式符号函数，单位为帕斯卡-秒 (Pa·s)。无需进行数值计算。",
            "solution": "所述问题是有效的。这是一个在非牛顿流体力学领域内适定且有科学依据的问题，基于标准定义和已建立的物理模型。所有必要信息均已提供。我们可以开始推导。\n\n我们的目标是推导在稳态、均匀单轴拉伸流条件下，由 Oldroyd-B 本构模型控制的流体的单轴拉伸粘度 $\\eta_{E}(\\dot{\\epsilon})$ 的解析表达式。\n\n速度场由 $\\mathbf{v} = \\left(-\\tfrac{1}{2} \\dot{\\epsilon} x,\\ -\\tfrac{1}{2} \\dot{\\epsilon} y,\\ \\dot{\\epsilon} z\\right)$ 给出。第一步是计算速度梯度张量 $\\nabla \\mathbf{v}$。\n$$\n\\nabla \\mathbf{v} =\n\\begin{pmatrix}\n\\frac{\\partial v_x}{\\partial x}  \\frac{\\partial v_x}{\\partial y}  \\frac{\\partial v_x}{\\partial z} \\\\\n\\frac{\\partial v_y}{\\partial x}  \\frac{\\partial v_y}{\\partial y}  \\frac{\\partial v_y}{\\partial z} \\\\\n\\frac{\\partial v_z}{\\partial x}  \\frac{\\partial v_z}{\\partial y}  \\frac{\\partial v_z}{\\partial z}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n-\\frac{1}{2}\\dot{\\epsilon}  0  0 \\\\\n0  -\\frac{1}{2}\\dot{\\epsilon}  0 \\\\\n0  0  \\dot{\\epsilon}\n\\end{pmatrix}\n$$\n该张量是对角张量，因此其转置等于自身：$(\\nabla \\mathbf{v})^{\\top} = \\nabla \\mathbf{v}$。\n\n接下来，我们计算变形率张量 $\\mathbf{D}$，其定义为 $\\mathbf{D} = \\frac{1}{2}\\left(\\nabla \\mathbf{v} + \\left(\\nabla \\mathbf{v}\\right)^{\\top}\\right)$。\n$$\n\\mathbf{D} = \\frac{1}{2}\\left(\\nabla \\mathbf{v} + \\nabla \\mathbf{v}\\right) = \\nabla \\mathbf{v} =\n\\begin{pmatrix}\n-\\frac{1}{2}\\dot{\\epsilon}  0  0 \\\\\n0  -\\frac{1}{2}\\dot{\\epsilon}  0 \\\\\n0  0  \\dot{\\epsilon}\n\\end{pmatrix}\n$$\n\n聚合物附加应力 $\\boldsymbol{\\tau}$ 由 Oldroyd-B 方程 $\\boldsymbol{\\tau} + \\lambda \\boldsymbol{\\tau}^{\\nabla} = 2 \\eta_{p} \\mathbf{D}$ 控制。我们必须针对给定的流动条件简化上随流导数 $\\boldsymbol{\\tau}^{\\nabla} = \\frac{\\partial \\boldsymbol{\\tau}}{\\partial t} + \\mathbf{v} \\cdot \\nabla \\boldsymbol{\\tau} - ((\\nabla \\mathbf{v}) \\cdot \\boldsymbol{\\tau} + \\boldsymbol{\\tau} \\cdot (\\nabla \\mathbf{v})^{\\top})$。\n流动是稳态的，所以时间导数为零：$\\frac{\\partial \\boldsymbol{\\tau}}{\\partial t} = \\mathbf{0}$。\n流动是均匀的，意味着应力场 $\\boldsymbol{\\tau}$ 在空间上是均匀的，所以其梯度为零：$\\nabla \\boldsymbol{\\tau} = \\mathbf{0}$。因此，对流项 $\\mathbf{v} \\cdot \\nabla \\boldsymbol{\\tau}$ 也为零。\n简化的上随流导数变为：\n$$\n\\boldsymbol{\\tau}^{\\nabla} = - ((\\nabla \\mathbf{v}) \\cdot \\boldsymbol{\\tau} + \\boldsymbol{\\tau} \\cdot (\\nabla \\mathbf{v})^{\\top})\n$$\n将此代入 Oldroyd-B 方程，得到一个纯代数张量方程：\n$$\n\\boldsymbol{\\tau} - \\lambda ((\\nabla \\mathbf{v}) \\cdot \\boldsymbol{\\tau} + \\boldsymbol{\\tau} \\cdot (\\nabla \\mathbf{v})^{\\top}) = 2 \\eta_{p} \\mathbf{D}\n$$\n由于 $\\nabla \\mathbf{v}$ 和 $\\mathbf{D}$ 是对角张量，我们可以假设 $\\boldsymbol{\\tau}$ 也是对角的。任何非对角分量 $\\tau_{ij}$ (对于 $i \\neq j$) 都将满足 $\\tau_{ij} - \\lambda ((\\nabla \\mathbf{v})_{ii} \\tau_{ij} + \\tau_{ij} (\\nabla \\mathbf{v})_{jj}) = 0$，这意味着 $\\tau_{ij} = 0$，除非其系数为零。例如，$\\tau_{12}(1 - \\lambda(-\\frac{1}{2}\\dot{\\epsilon} - \\frac{1}{2}\\dot{\\epsilon})) = \\tau_{12}(1 + \\lambda\\dot{\\epsilon}) = 0$，所以 $\\tau_{12}=0$ (因为 $\\dot{\\epsilon}  0$)。因此，$\\boldsymbol{\\tau}$ 是对角张量。设 $\\boldsymbol{\\tau} = \\mathrm{diag}(\\tau_{xx}, \\tau_{yy}, \\tau_{zz})$。\n\n我们现在求解对角分量：\n对于 $(xx)$ 分量：\n$\\tau_{xx} - \\lambda \\left((\\nabla \\mathbf{v})_{xx} \\tau_{xx} + \\tau_{xx} (\\nabla \\mathbf{v})_{xx}\\right) = 2 \\eta_{p} D_{xx}$\n$\\tau_{xx} \\left(1 - 2\\lambda (\\nabla \\mathbf{v})_{xx}\\right) = 2 \\eta_{p} D_{xx}$\n代入 $(\\nabla \\mathbf{v})_{xx} = D_{xx} = -\\frac{1}{2}\\dot{\\epsilon}$：\n$\\tau_{xx} \\left(1 - 2\\lambda (-\\tfrac{1}{2}\\dot{\\epsilon})\\right) = 2 \\eta_{p} (-\\tfrac{1}{2}\\dot{\\epsilon})$\n$\\tau_{xx} \\left(1 + \\lambda\\dot{\\epsilon}\\right) = -\\eta_{p}\\dot{\\epsilon}$\n$$\n\\tau_{xx} = -\\frac{\\eta_{p}\\dot{\\epsilon}}{1 + \\lambda\\dot{\\epsilon}}\n$$\n由于流动的轴对称性，$\\tau_{yy} = \\tau_{xx}$。\n\n对于 $(zz)$ 分量：\n$\\tau_{zz} \\left(1 - 2\\lambda (\\nabla \\mathbf{v})_{zz}\\right) = 2 \\eta_{p} D_{zz}$\n代入 $(\\nabla \\mathbf{v})_{zz} = D_{zz} = \\dot{\\epsilon}$：\n$\\tau_{zz} \\left(1 - 2\\lambda \\dot{\\epsilon}\\right) = 2 \\eta_{p} \\dot{\\epsilon}$\n$$\n\\tau_{zz} = \\frac{2\\eta_{p}\\dot{\\epsilon}}{1 - 2\\lambda\\dot{\\epsilon}}\n$$\n现在我们求总柯西应力张量 $\\boldsymbol{\\sigma} = -p \\mathbf{I} + 2 \\eta_{s} \\mathbf{D} + \\boldsymbol{\\tau}$ 的分量。\n$\\sigma_{xx} = -p + 2\\eta_s D_{xx} + \\tau_{xx} = -p - \\eta_s \\dot{\\epsilon} - \\frac{\\eta_{p}\\dot{\\epsilon}}{1 + \\lambda\\dot{\\epsilon}}$\n$\\sigma_{yy} = \\sigma_{xx}$\n$\\sigma_{zz} = -p + 2\\eta_s D_{zz} + \\tau_{zz} = -p + 2\\eta_s \\dot{\\epsilon} + \\frac{2\\eta_{p}\\dot{\\epsilon}}{1 - 2\\lambda\\dot{\\epsilon}}$\n\n单轴拉伸粘度定义为 $\\eta_{E}(\\dot{\\epsilon}) = \\frac{\\sigma_{zz} - \\tfrac{1}{2}\\left(\\sigma_{xx} + \\sigma_{yy}\\right)}{\\dot{\\epsilon}}$。鉴于 $\\sigma_{xx}=\\sigma_{yy}$，这可以简化为 $\\eta_{E}(\\dot{\\epsilon}) = \\frac{\\sigma_{zz} - \\sigma_{xx}}{\\dot{\\epsilon}}$。\n我们来计算法向应力差 $\\sigma_{zz} - \\sigma_{xx}$：\n$$\n\\sigma_{zz} - \\sigma_{xx} = \\left(-p + 2\\eta_s \\dot{\\epsilon} + \\frac{2\\eta_{p}\\dot{\\epsilon}}{1 - 2\\lambda\\dot{\\epsilon}}\\right) - \\left(-p - \\eta_s \\dot{\\epsilon} - \\frac{\\eta_{p}\\dot{\\epsilon}}{1 + \\lambda\\dot{\\epsilon}}\\right)\n$$\n压力 $p$ 被消掉，这对于不可压缩流体的应力差是预期的结果。\n$$\n\\sigma_{zz} - \\sigma_{xx} = 3\\eta_s \\dot{\\epsilon} + \\left( \\frac{2\\eta_{p}}{1 - 2\\lambda\\dot{\\epsilon}} + \\frac{\\eta_{p}}{1 + \\lambda\\dot{\\epsilon}} \\right) \\dot{\\epsilon}\n$$\n我们合并括号中的项：\n$$\n\\frac{2\\eta_{p}(1+\\lambda\\dot{\\epsilon}) + \\eta_{p}(1-2\\lambda\\dot{\\epsilon})}{(1 - 2\\lambda\\dot{\\epsilon})(1 + \\lambda\\dot{\\epsilon})} = \\frac{2\\eta_{p} + 2\\eta_{p}\\lambda\\dot{\\epsilon} + \\eta_{p} - 2\\eta_{p}\\lambda\\dot{\\epsilon}}{(1 - 2\\lambda\\dot{\\epsilon})(1 + \\lambda\\dot{\\epsilon})} = \\frac{3\\eta_{p}}{(1 - 2\\lambda\\dot{\\epsilon})(1 + \\lambda\\dot{\\epsilon})}\n$$\n所以应力差为：\n$$\n\\sigma_{zz} - \\sigma_{xx} = 3\\eta_s \\dot{\\epsilon} + \\frac{3\\eta_{p}\\dot{\\epsilon}}{(1 - 2\\lambda\\dot{\\epsilon})(1 + \\lambda\\dot{\\epsilon})}\n$$\n最后，除以 $\\dot{\\epsilon}$ 得到拉伸粘度：\n$$\n\\eta_{E}(\\dot{\\epsilon}) = 3\\eta_s + \\frac{3\\eta_{p}}{(1 - 2\\lambda\\dot{\\epsilon})(1 + \\lambda\\dot{\\epsilon})}\n$$\n该表达式给出了作为材料参数 $\\eta_s$、$\\eta_p$、$\\lambda$ 和拉伸率 $\\dot{\\epsilon}$ 的函数的拉伸粘度。由于 $\\eta_s$ 和 $\\eta_p$ 的单位是粘度（例如 Pa·s），而第二项是粘度乘以一个无量纲因子，因此得到的 $\\eta_{E}(\\dot{\\epsilon})$ 具有正确的粘度单位。\n\n为了分析此函数的行为，我们检查其奇点。当聚合物贡献项的分母变为零时，拉伸粘度 $\\eta_{E}$ 发散。这在 $1 - 2\\lambda\\dot{\\epsilon} = 0$ 或 $1 + \\lambda\\dot{\\epsilon} = 0$ 时发生。由于拉伸率 $\\dot{\\epsilon}$ 和松弛时间 $\\lambda$ 是正的物理量，条件 $1 + \\lambda\\dot{\\epsilon} = 0$ 无法满足。因此，发散仅由以下条件确定：\n$$\n1 - 2\\lambda\\dot{\\epsilon} = 0 \\implies \\dot{\\epsilon} = \\frac{1}{2\\lambda}\n$$\n在临界拉伸率 $\\dot{\\epsilon}_c = \\frac{1}{2\\lambda}$ 时，拉伸粘度变为无穷大。\n\n这种发散的物理意义与溶液中聚合物链的行为有关，这可由 Oldroyd-B 理论的基础哑铃模型来描述。参数 $\\lambda$ 是聚合物线团在受到扰动后恢复到其平衡构象的特征松弛时间。量 $2\\lambda\\dot{\\epsilon}$ 通常与 Weissenberg 数相关，它比较了聚合物松弛的时间尺度 ($\\lambda$) 与流动变形的时间尺度 ($\\frac{1}{2\\dot{\\epsilon}}$)。当拉伸率较低 ($\\dot{\\epsilon} \\ll \\frac{1}{2\\lambda}$) 时，聚合物链被流动拉伸，但有足够的时间松弛，导致粘度有限且适度增加。然而，当 $\\dot{\\epsilon}$ 接近临界速率 $\\dot{\\epsilon}_c$ 时，流动使聚合物链变形的速度超过了它们松弛的速度。在临界速率下，流动施加的拉伸力克服了聚合物链的熵恢复力。该模型预测聚合物链会从无规线团解开成完全伸展的状态，这种现象被称为线团-拉伸转变。这种转变导致聚合物应力 $\\tau_{zz}$ 急剧增加，从而导致拉伸粘度发散。虽然无穷大的值是模型简化的线性弹簧定律所导致的一种非物理假象，但这一预测正确地捕捉到了在稀聚合物溶液经受强拉伸流时实验观察到的剧烈应变硬化行为。",
            "answer": "$$\n\\boxed{3\\eta_{s} + \\frac{3\\eta_{p}}{(1 - 2\\lambda\\dot{\\epsilon})(1 + \\lambda\\dot{\\epsilon})}}\n$$"
        },
        {
            "introduction": "在上一练习中识别出理论挑战后，这最后一个实践从分析转向计算。您的任务是实现并比较两种用于求解Oldroyd-B构象张量演化方程的数值方法。该练习演示了一个简单的数值格式在高Weissenberg数下如何失效，以及一个更复杂的、基于物理的“能量稳定”格式如何保持应力张量的正定性，从而在简单方法崩溃的情况下实现稳定模拟。",
            "id": "3349230",
            "problem": "要求您使用计算流体动力学原理，在高魏森伯格数下研究一个典型的非牛顿粘弹性模型，并设计和测试时间积分方案，这些方案能够在不使用对数构象方法的情况下，诊断并缓解应力正定性的破坏。请在 Oldroyd–B 框架内，针对聚合物构象张量和恒定速度梯度流进行研究。\n\n从以下基本基础开始：\n- 聚合物构象张量 $A(t)$ 是对称正定的，并根据 Oldroyd–B 模型中的上随流导数进行演化，该导数源自连续介质力学运动学和线性弹性哑铃模型。对于一个恒定的速度梯度张量 $L$（速度的空间梯度），$A(t)$ 的控制方程是一个线性的仿射矩阵常微分方程，它结合了运动学和向单位张量 $I$（平衡构象）的松弛。\n- 聚合物松弛时间为 $\\lambda$（单位为秒）。魏森伯格数定义为 $Wi = \\lambda \\alpha$，其中 $\\alpha$ 是特征应变率的大小（单位为 $\\mathrm{s}^{-1}$）。对于具有恒定 $L$ 的平面流，使用与施加速率相等的 $\\alpha$（拉伸流为 $\\kappa$，简单剪切流为 $\\dot{\\gamma}$）。\n\n您的任务：\n1. 从第一性原理推导在恒定 $L$ 下 $2\\times 2$ 构象张量 $A(t)$ 的演化定律，并识别由 $L$ 引起的运动学贡献以及由 $\\lambda$ 引起的朝向 $I$ 的松弛贡献。确保推导从上随流导数和 Oldroyd–B 模型的定义开始，并且不假设任何预先推导的离散时间公式。\n2. 为 $A(t)$ 方程在有限时间域 $t\\in[0,T]$ 上实现两种时间积分器：\n   - 一种基准一阶显式方法，该方法在时间步长 $\\Delta t$ 上直接离散化 $A(t)$ 的连续时间方程，其方式对于控制该方程的仿射线性矩阵常微分方程是自然的。\n   - 一种能量稳定分裂积分器，该积分器在每个 $\\Delta t$ 内通过分离的子步处理由 $L$ 引起的运动学输运和朝向 $I$ 的松弛，每个子步都精确地从连续时间动力学推导而来。只要初始 $A(0)$ 是对称正定的且 $L$ 是恒定的，该积分器必须对任何 $\\Delta t0$ 保持 $A(t)$ 的对称性和正定性。\n3. 在不使用任何对数构象变换的情况下，编写一个程序，该程序：\n   - 初始化 $A(0) = I$。\n   - 对于给定的流类型和参数，使用每个积分器在固定的时间域 $[0,T]$ 上，以规定的 $\\Delta t$ 和恒定的 $L$ 来推进 $A(t)$。\n   - 在每一步，通过检查 $A$ 的最小特征值是否保持严格大于一个小的容差阈值来诊断正定性的丧失。\n   - 对于一组给定的测试场景，报告在整个时间域内是否保持了正定性，以及最终时间的最小特征值。\n   - 对于一个场景，在一系列 $Wi$ 值中搜索，找到基准方法在整个时间域内保持正定性的最大 $Wi$ 值（记为 $Wi_{\\max}$），并将其与能量稳定积分器对应的 $Wi_{\\max}$ 进行比较。\n\n物理和数值规格：\n- 使用具有恒定 $L$ 的 $2\\times 2$ 平面流：\n  - 平面拉伸流：$L = \\mathrm{diag}(\\kappa,-\\kappa)$，其中 $\\kappa$ 是拉伸率（单位为 $\\mathrm{s}^{-1}$），$Wi = \\lambda \\kappa$。\n  - 简单剪切流：$L = \\begin{pmatrix}0  \\dot{\\gamma}\\\\ 0  0\\end{pmatrix}$，其中 $\\dot{\\gamma}$ 是剪切率（单位为 $\\mathrm{s}^{-1}$），$Wi = \\lambda \\dot{\\gamma}$。\n- 时间步长 $\\Delta t$ 单位为秒，时间域 $T$ 单位为秒，松弛时间 $\\lambda$ 单位为秒。\n- 正定性通过要求 $A$ 的最小特征值超过一个固定的容差 $\\varepsilon$ 来确定；将 $\\varepsilon$ 视为一个小的无量纲数，例如 $\\varepsilon = 10^{-12}$。\n\n测试套件：\n提供并解决以下场景。每个场景必须对两种积分器都执行。当一个场景指定单个 $Wi$ 值时，输出一个列表，其中包含：指示基准积分器是否在整个时间域内保持正定性的布尔值，指示能量稳定积分器是否保持正定性的布尔值，基准积分器在最终时间的最小特征值，以及能量稳定积分器在最终时间的最小特征值。当一个场景指定一个 $Wi$ 值列表时，输出一个列表，其中包含：列表中基准积分器保持正定性的最大 $Wi$ 值，以及能量稳定积分器对应的最大 $Wi$ 值。所有输出都是无量纲数或布尔值。程序必须将所有场景的输出聚合到单行中，格式为一个用方括号括起来的逗号分隔列表，其中每个场景的输出本身也用方括号括起来。\n\n场景：\n- 场景 A (平面拉伸流搜索)：\n  - $\\lambda = 1.0$ (秒)。\n  - $\\Delta t = 0.2$ (秒)。\n  - $T = 2.0$ (秒)。\n  - $Wi$ 列表：$[0.1, 0.5, 1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 8.0, 10.0]$。\n  - 使用 $L = \\mathrm{diag}(\\kappa,-\\kappa)$，其中 $\\kappa = Wi/\\lambda$。\n  - 输出：$[Wi_{\\max,\\mathrm{baseline}}, Wi_{\\max,\\mathrm{stable}}]$。\n- 场景 B (简单剪切流固定 $Wi$)：\n  - $\\lambda = 0.05$ (秒)。\n  - $Wi = 2.0$ (无量纲)。\n  - $\\Delta t = 0.01$ (秒)。\n  - $T = 0.5$ (秒)。\n  - 使用 $L = \\begin{pmatrix}0  \\dot{\\gamma}\\\\ 0  0\\end{pmatrix}$，其中 $\\dot{\\gamma} = Wi/\\lambda$。\n  - 输出：$[\\mathrm{PD}_{\\mathrm{baseline}}, \\mathrm{PD}_{\\mathrm{stable}}, \\lambda_{\\min,\\mathrm{baseline}}(T), \\lambda_{\\min,\\mathrm{stable}}(T)]$。\n- 场景 C (平面拉伸流高 $Wi$，小时间步长)：\n  - $\\lambda = 1.0$ (秒)。\n  - $Wi = 20.0$ (无量纲)。\n  - $\\Delta t = 0.001$ (秒)。\n  - $T = 0.1$ (秒)。\n  - 使用 $L = \\mathrm{diag}(\\kappa,-\\kappa)$，其中 $\\kappa = Wi/\\lambda$。\n  - 输出：$[\\mathrm{PD}_{\\mathrm{baseline}}, \\mathrm{PD}_{\\mathrm{stable}}, \\lambda_{\\min,\\mathrm{baseline}}(T), \\lambda_{\\min,\\mathrm{stable}}(T)]$。\n- 场景 D (平面拉伸流中等 $Wi$，大时间步长)：\n  - $\\lambda = 1.0$ (秒)。\n  - $Wi = 1.0$ (无量纲)。\n  - $\\Delta t = 0.5$ (秒)。\n  - $T = 1.0$ (秒)。\n  - 使用 $L = \\mathrm{diag}(\\kappa,-\\kappa)$，其中 $\\kappa = Wi/\\lambda$。\n  - 输出：$[\\mathrm{PD}_{\\mathrm{baseline}}, \\mathrm{PD}_{\\mathrm{stable}}, \\lambda_{\\min,\\mathrm{baseline}}(T), \\lambda_{\\min,\\mathrm{stable}}(T)]$。\n\n最终输出规格：\n您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个场景的结果是一个子列表。例如：$[[1.0, 10.0],[\\mathrm{True},\\mathrm{True},0.5,0.6],\\ldots]$。程序必须完全自包含，不需要外部输入，并使用您推导和实现的积分器计算这些结果。在内部，所有数值以无量纲形式表示，所有时间和速率以秒和 $\\mathrm{s}^{-1}$ 表示；打印的输出是无量纲浮点数和布尔值。",
            "solution": "我们从连续介质力学的运动学和用于聚合物液体的 Oldroyd–B 模型出发。聚合物构象张量 $A(t)$ 被定义为线性弹性哑铃端到端矢量并矢积的系综平均，在没有热涨落的情况下，$A$ 的演化由上随流导数控制。对于一个恒定的速度梯度张量 $L = \\nabla \\mathbf{u}$，构象张量的 Oldroyd–B 演化方程为\n$$\n\\overset{\\triangledown}{A} \\equiv \\frac{\\mathrm{d}A}{\\mathrm{d}t} - L A - A L^{\\top} = -\\frac{1}{\\lambda}\\left(A - I\\right),\n$$\n其中 $\\lambda$ 是聚合物松弛时间，而 $I$ 是单位张量。整理后得到线性的仿射常微分方程，\n$$\n\\frac{\\mathrm{d}A}{\\mathrm{d}t} = L A + A L^{\\top} - \\frac{1}{\\lambda}(A - I).\n$$\n对于正定的初始条件 $A(0)\\succ 0$，该方程在连续时间设置下保持 $A(t)$ 的对称性和正定性，因为运动学项 $L A + A L^{\\top}$ 是一个合同算子（保持对称性），而松弛项 $-(1/\\lambda)(A - I)$ 是一个朝向 $I \\succ 0$ 的线性收缩。\n\n定义魏森伯格数 $Wi = \\lambda \\alpha$，其中 $\\alpha$ 是特征应变率的大小。对于恒定平面流：\n- 拉伸率为 $\\kappa$ 的平面拉伸流使用 $L = \\mathrm{diag}(\\kappa,-\\kappa)$，因此 $Wi = \\lambda \\kappa$。\n- 剪切率为 $\\dot{\\gamma}$ 的简单剪切流使用 $L = \\begin{pmatrix}0  \\dot{\\gamma}\\\\ 0  0\\end{pmatrix}$，因此 $Wi = \\lambda \\dot{\\gamma}$。\n\n我们现在推导两种时间离散积分器。\n\n基准显式积分器：\n我们通过离散化时间导数并在当前时间步 $t_n$ 评估右侧项来构建一个一阶显式欧拉格式：\n$$\nA_{n+1} = A_n + \\Delta t \\left( L A_n + A_n L^{\\top} - \\frac{1}{\\lambda}(A_n - I) \\right).\n$$\n该格式很简单，但通常情况下，对于大的 $\\Delta t$ 或大的 $Wi$，它不能保持正定性，因为仿射右端项可能由于对强运动学拉伸或松弛不平衡的分辨率不足而产生使最小特征值非正的步长更新。\n\n能量稳定分裂积分器：\n对于恒定的 $L$，我们将动力学分离为两个可交换的子问题：\n1. 运动学输运子问题（无松弛）：\n$$\n\\frac{\\mathrm{d}A}{\\mathrm{d}t} = L A + A L^{\\top}.\n$$\n对于恒定的 $L$，该子问题在一个时间步 $\\Delta t$ 内的精确解为：\n$$\nA^{\\star} = \\exp(\\Delta t\\, L)\\, A_n\\, \\exp(\\Delta t\\, L^{\\top}),\n$$\n其中 $\\exp$ 表示矩阵指数。由于 $A_n \\succ 0$ 且更新是与可逆矩阵 $\\exp(\\Delta t\\, L)$ 的矩阵合同，结果 $A^{\\star}$ 保持对称正定。\n\n2. 松弛子问题（无运动学）：\n$$\n\\frac{\\mathrm{d}A}{\\mathrm{d}t} = -\\frac{1}{\\lambda}(A - I).\n$$\n这个类线性的标量松弛方程在 $\\Delta t$ 内的精确解为：\n$$\nA_{n+1} = I + \\exp\\left(-\\frac{\\Delta t}{\\lambda}\\right)\\left( A^{\\star} - I \\right).\n$$\n此更新是 $I$ 和 $A^{\\star}$ 的凸组合，权重为 $\\exp(-\\Delta t/\\lambda)\\in(0,1)$，因此只要 $A^{\\star}\\succ 0$，$A_{n+1}$ 就保持对称正定。\n\n将这两个精确的子步结合起来，可以得到一个（对于恒定 $L$）无条件保持正定性的积分器，其底层的自由能 $E(A) = \\mathrm{tr}(A - \\log A - I)$ 在松弛子步下是非增的，并在运动学子步下被保守输运。在实践中，这种分裂通常被称为能量稳定的，因为它避免了时间离散化引起的人为增长，并保持了连续时间的定性性质。\n\n算法设计：\n- 初始化 $A_0 = I$。\n- 对于每个时间步 $n$：\n  - 基准显式法：应用显式欧拉更新并计算 $A_{n+1}$ 的特征值；如果最小特征值低于容差 $\\varepsilon$，则标记正定性丧失。\n  - 能量稳定分裂法：计算 $E = \\exp(\\Delta t\\, L)$，构成 $A^{\\star} = E A_n E^{\\top}$，然后 $A_{n+1} = I + \\exp(-\\Delta t/\\lambda)(A^{\\star} - I)$。类似地检查特征值。\n- 对于搜索场景，遍历给定的 $Wi$ 值列表，找到基准方法在 $[0,T]$ 的每个时间步上都保持正定性的最大 $Wi$ 值，并对能量稳定方法做同样的操作。使用 $\\kappa = Wi/\\lambda$（对于拉伸流）或 $\\dot{\\gamma} = Wi/\\lambda$（对于剪切流）来定义 $L$。\n- 使用一个小的数值容差 $\\varepsilon = 10^{-12}$ 来为计算出的浮点特征值定义正定性。\n\n场景的预期定性结果：\n- 场景 A (拉伸流搜索)，参数为 $\\lambda = 1.0$, $\\Delta t = 0.2$, $T = 2.0$，随着 $Wi$ 增大，运动学效应越来越强。基准显式积分器应在某个中到大的 $Wi$ 值时因步长限制而失去正定性，而分裂积分器应在整个测试范围内保持正定性，从而得出后者有严格更大的 $Wi_{\\max}$。\n- 场景 B (简单剪切流，参数 $Wi=2.0$, $\\lambda=0.05$, $\\Delta t=0.01$, $T=0.5$) 测试了高剪切率和中等时间步长；预计两种积分器都将保持正定性，分裂积分器通常会产生更大的最终时间最小特征值。\n- 场景 C (拉伸流，参数 $Wi=20.0$, $\\Delta t=0.001$, $T=0.1$) 使用非常小的时间步长和短的时间域；基准显式积分器应能保持正定性，因为时间分辨率相对于运动学足够高，能量稳定积分器也将保持正定性。\n- 场景 D (拉伸流，参数 $Wi=1.0$, $\\Delta t=0.5$, $T=1.0$) 使用一个大的时间步长，可能导致基准显式积分器早期产生一个奇异或不定的 $A$（例如，从 $A_0 = I$ 和 $L = \\mathrm{diag}(1,-1)$ 开始，第一个显式步长导致 $A_1 = \\mathrm{diag}(2,0)$，由于一个零特征值而违反了严格正定性），而分裂积分器则保持正定性。\n\n实现说明：\n- 使用可靠的例程计算 $2\\times 2$ 矩阵的矩阵指数 $\\exp(\\Delta t\\, L)$。\n- 对于每个场景，按照指定格式组装最终输出：单行打印一个顶级列表，其中每个场景的结果是一个子列表。条目是无量纲浮点数和布尔值。不要打印任何附加文本。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import expm, eigvalsh\n\ndef make_L(flow_type: str, rate: float) - np.ndarray:\n    \"\"\"\n    Construct the 2x2 constant velocity-gradient tensor L for the given flow type and rate.\n    flow_type: 'extensional' or 'shear'\n    rate: kappa for extensional, gamma_dot for shear (in s^-1)\n    \"\"\"\n    if flow_type == 'extensional':\n        # Planar extensional: L = diag(kappa, -kappa)\n        return np.array([[rate, 0.0],\n                         [0.0, -rate]], dtype=float)\n    elif flow_type == 'shear':\n        # Simple shear: L = [[0, gamma_dot], [0, 0]]\n        return np.array([[0.0, rate],\n                         [0.0, 0.0]], dtype=float)\n    else:\n        raise ValueError(\"Unsupported flow_type\")\n\ndef explicit_euler_step(A: np.ndarray, L: np.ndarray, dt: float, lam: float) - np.ndarray:\n    \"\"\"\n    One explicit Euler step for dA/dt = L A + A L^T - (1/lam)(A - I)\n    \"\"\"\n    I = np.eye(2)\n    return A + dt * (L @ A + A @ L.T - (1.0 / lam) * (A - I))\n\ndef energy_stable_split_step(A: np.ndarray, L: np.ndarray, dt: float, lam: float) - np.ndarray:\n    \"\"\"\n    One splitting step:\n      1) Kinematics exact: A* = exp(dt L) A exp(dt L^T)\n      2) Relaxation exact: A_{n+1} = I + exp(-dt/lam) (A* - I)\n    \"\"\"\n    I = np.eye(2)\n    E = expm(dt * L)\n    A_star = E @ A @ E.T\n    return I + np.exp(-dt / lam) * (A_star - I)\n\ndef simulate(A0: np.ndarray, L: np.ndarray, dt: float, T: float, lam: float, method: str, tol: float=1e-12):\n    \"\"\"\n    Simulate over [0, T] with step dt using the specified method: 'explicit' or 'stable'.\n    Returns (pd_all, min_eig_final).\n    \"\"\"\n    steps = int(np.round(T / dt))\n    # Ensure we hit the horizon exactly\n    T_eff = steps * dt\n    A = A0.copy()\n    pd_all = True\n    for _ in range(steps):\n        if method == 'explicit':\n            A = explicit_euler_step(A, L, dt, lam)\n        elif method == 'stable':\n            A = energy_stable_split_step(A, L, dt, lam)\n        else:\n            raise ValueError(\"Unknown method\")\n        # Symmetrize defensively to remove tiny asymmetries\n        A = 0.5 * (A + A.T)\n        # Check SPD via smallest eigenvalue\n        min_eig = float(np.min(eigvalsh(A)))\n        if min_eig = tol or not np.isfinite(min_eig):\n            pd_all = False\n            # Continue stepping to obtain final-time eigenvalue (or break early). We'll break to save time.\n            break\n    # If we broke early, compute min eig at current A; else compute at final A (already current)\n    min_eig_final = float(np.min(eigvalsh(A)))\n    return pd_all, min_eig_final\n\ndef search_Wi_max(flow_type: str, lam: float, dt: float, T: float, Wi_list):\n    \"\"\"\n    For given flow type and parameters, search the largest Wi in Wi_list for which PD is preserved\n    for the entire horizon, for both explicit (baseline) and stable integrators.\n    Returns (Wi_max_explicit, Wi_max_stable).\n    \"\"\"\n    A0 = np.eye(2)\n    Wi_max_explicit = None\n    Wi_max_stable = None\n    for Wi in Wi_list:\n        rate = Wi / lam\n        L = make_L(flow_type, rate)\n        pd_explicit, _ = simulate(A0, L, dt, T, lam, method='explicit')\n        pd_stable, _ = simulate(A0, L, dt, T, lam, method='stable')\n        if pd_explicit:\n            Wi_max_explicit = Wi if (Wi_max_explicit is None or Wi  Wi_max_explicit) else Wi_max_explicit\n        # Even if not PD for explicit, we still test stable independently\n        if pd_stable:\n            Wi_max_stable = Wi if (Wi_max_stable is None or Wi  Wi_max_stable) else Wi_max_stable\n    # If none are PD, set to 0.0\n    if Wi_max_explicit is None:\n        Wi_max_explicit = 0.0\n    if Wi_max_stable is None:\n        Wi_max_stable = 0.0\n    return float(Wi_max_explicit), float(Wi_max_stable)\n\ndef scenario_fixed_Wi(flow_type: str, lam: float, Wi: float, dt: float, T: float, tol: float=1e-12):\n    \"\"\"\n    Run both integrators for a fixed Wi, return:\n    [pd_explicit, pd_stable, min_eig_explicit_final, min_eig_stable_final]\n    \"\"\"\n    A0 = np.eye(2)\n    rate = Wi / lam\n    L = make_L(flow_type, rate)\n    pd_explicit, min_eig_explicit = simulate(A0, L, dt, T, lam, method='explicit', tol=tol)\n    pd_stable, min_eig_stable = simulate(A0, L, dt, T, lam, method='stable', tol=tol)\n    return [pd_explicit, pd_stable, float(min_eig_explicit), float(min_eig_stable)]\n\ndef solve():\n    # Define the test cases from the problem statement.\n\n    # Scenario A: Planar extensional Wi search\n    lam_A = 1.0\n    dt_A = 0.2\n    T_A = 2.0\n    Wi_list_A = [0.1, 0.5, 1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 8.0, 10.0]\n    Wi_max_explicit_A, Wi_max_stable_A = search_Wi_max('extensional', lam_A, dt_A, T_A, Wi_list_A)\n    result_A = [Wi_max_explicit_A, Wi_max_stable_A]\n\n    # Scenario B: Simple shear fixed Wi\n    lam_B = 0.05\n    Wi_B = 2.0\n    dt_B = 0.01\n    T_B = 0.5\n    result_B = scenario_fixed_Wi('shear', lam_B, Wi_B, dt_B, T_B)\n\n    # Scenario C: Extensional high Wi, small dt\n    lam_C = 1.0\n    Wi_C = 20.0\n    dt_C = 0.001\n    T_C = 0.1\n    result_C = scenario_fixed_Wi('extensional', lam_C, Wi_C, dt_C, T_C)\n\n    # Scenario D: Extensional moderate Wi, large dt\n    lam_D = 1.0\n    Wi_D = 1.0\n    dt_D = 0.5\n    T_D = 1.0\n    result_D = scenario_fixed_Wi('extensional', lam_D, Wi_D, dt_D, T_D)\n\n    results = [result_A, result_B, result_C, result_D]\n\n    # Final print statement in the exact required format.\n    def format_item(x):\n        if isinstance(x, bool):\n            return \"True\" if x else \"False\"\n        else:\n            # Format floats with full precision but concise\n            return str(x)\n\n    def format_list(lst):\n        return \"[\" + \",\".join(format_item(x) for x in lst) + \"]\"\n\n    print(\"[\" + \",\".join(format_list(res) for res in results) + \"]\")\n\nsolve()\n```"
        }
    ]
}