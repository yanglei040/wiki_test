{
    "hands_on_practices": [
        {
            "introduction": "在基于水平集（Level Set）等界面捕捉方法的多相流模拟中，表面张力起着至关重要的作用，而其计算的准确性直接取决于界面曲率的精确估算。本练习旨在引导您深入理解将连续的曲率算子离散化为网格上的计算公式时所引入的误差。通过对一个理想化的正弦波界面进行泰勒级数展开分析 ()，您将能够亲手推导出离散曲率的截断误差，并揭示其与网格尺寸和界面几何形态之间的定量关系，这是评估和改进CFD数值算法的一项基本功。",
            "id": "3312819",
            "problem": "考虑在使用水平集方法对液滴破碎与合并过程中的毛细力进行建模时，界面曲率的计算。设界面由水平集函数 $\\phi(x,y)$ 隐式表示，曲率由几何恒等式 $\\kappa = \\nabla \\cdot \\left( \\frac{\\nabla \\phi}{|\\nabla \\phi|} \\right)$ 定义，其中 $\\nabla$ 表示空间梯度， $|\\cdot|$ 表示欧几里得范数。我们在间距为 $\\Delta x = \\Delta y = h$ 的均匀笛卡尔网格上进行计算。\n\n基于此定义，从第一性原理出发，按如下方式构建一个二阶中心差分离散曲率估计量：使用二阶中心差分计算网格节点 $(i,j)$ 处的离散梯度分量，将节点 $(i,j)$ 处的归一化梯度构成离散单位法向量，然后计算此离散单位法向量的中心差分散度，作为节点 $(i,j)$ 处的离散曲率。\n\n现在，考虑一个由水平集 $\\phi(x,y) = y - \\varepsilon \\cos(\\alpha x)$ 隐式参数化的二维正弦界面，其中 $\\varepsilon$ 是物理振幅（量纲为长度），$\\alpha$ 是波数（量纲为长度的倒数）。我们关注位于 $x=0$ 处的波峰，界面通过该点 $(x,y)=(0,\\varepsilon)$。假设该界面点是一个网格节点。\n\n使用关于波峰的 Taylor 展开和上述离散化步骤，对波峰处的离散曲率进行截断误差分析。引入无量纲参数 $\\tilde{\\varepsilon} \\equiv \\alpha \\varepsilon$ 和 $\\delta \\equiv \\alpha h$，并将无量纲离散曲率展开为\n$\\kappa_h / \\alpha = \\tilde{\\varepsilon} + C(\\tilde{\\varepsilon}) \\, \\delta^2 + \\mathcal{O}(\\delta^4)$，\n其中 $\\kappa_h$ 是通过二阶中心差分程序计算出的离散曲率。\n\n推导系数 $C(\\tilde{\\varepsilon})$ 的闭式解析表达式。请以 $C(\\tilde{\\varepsilon})$ 的精确解析表达式的形式报告您的最终答案，不带任何单位。无需进行数值舍入，最终答案中不应包含任何物理单位。",
            "solution": "用户希望找到离散曲率计算的截断误差展开式中的系数 $C(\\tilde{\\varepsilon})$。\n该问题提法明确，在计算流体动力学和数值分析方面有坚实的科学基础，所有术语定义清晰。问题设定自成体系且前后一致。此问题有效。\n\n首先，我们来确定位于点 $(x,y)=(0, \\varepsilon)$ 的界面波峰处的解析曲率。水平集函数由 $\\phi(x,y) = y - \\varepsilon \\cos(\\alpha x)$ 给出。曲率定义为 $\\kappa = \\nabla \\cdot \\mathbf{n}$，其中 $\\mathbf{n} = \\frac{\\nabla \\phi}{|\\nabla \\phi|}$。\n\n水平集函数的梯度为：\n$$\n\\nabla \\phi = \\left( \\frac{\\partial \\phi}{\\partial x}, \\frac{\\partial \\phi}{\\partial y} \\right) = (\\alpha \\varepsilon \\sin(\\alpha x), 1)\n$$\n梯度的模为：\n$$\n|\\nabla \\phi| = \\sqrt{(\\alpha \\varepsilon \\sin(\\alpha x))^2 + 1^2} = \\sqrt{1 + \\alpha^2 \\varepsilon^2 \\sin^2(\\alpha x)}\n$$\n单位法向量场 $\\mathbf{n} = (n_x, n_y)$ 为：\n$$\n\\mathbf{n} = \\frac{(\\alpha \\varepsilon \\sin(\\alpha x), 1)}{\\sqrt{1 + \\alpha^2 \\varepsilon^2 \\sin^2(\\alpha x)}}\n$$\n曲率 $\\kappa$ 是 $\\mathbf{n}$ 的散度：\n$$\n\\kappa = \\frac{\\partial n_x}{\\partial x} + \\frac{\\partial n_y}{\\partial y}\n$$\n$n_y$ 分量不依赖于 $y$，因此 $\\frac{\\partial n_y}{\\partial y} = 0$。我们只需要计算 $\\frac{\\partial n_x}{\\partial x}$。\n$$\n\\frac{\\partial n_x}{\\partial x} = \\frac{\\partial}{\\partial x} \\left( \\frac{\\alpha \\varepsilon \\sin(\\alpha x)}{\\left(1 + \\alpha^2 \\varepsilon^2 \\sin^2(\\alpha x)\\right)^{1/2}} \\right)\n$$\n使用商法则，在波峰处，即 $x=0$ 处，我们有 $\\sin(0)=0$ 和 $\\cos(0)=1$。导数的分子是 $(\\alpha^2 \\varepsilon \\cos(\\alpha x))(1 + \\alpha^2 \\varepsilon^2 \\sin^2(\\alpha x))^{1/2}$，而分母则包含 $\\sin(\\alpha x)$ 的高阶项。表达式显著简化为：\n$$\n\\kappa(0) = \\left. \\frac{\\partial n_x}{\\partial x} \\right|_{x=0} = \\frac{(\\alpha^2 \\varepsilon \\cos(0))(1 + 0)^{1/2} - (\\dots) \\sin(0)}{1+0} = \\alpha^2 \\varepsilon\n$$\n无量纲解析曲率为 $\\kappa(0) / \\alpha = \\alpha\\varepsilon = \\tilde{\\varepsilon}$。这证实了问题展开式中的领头项。\n\n现在，我们将遵循离散化步骤，在间距为 $h$ 的均匀网格上进行计算。我们感兴趣的点 $(0, \\varepsilon)$ 是一个网格节点，我们将其记为 $(i,j)$。离散曲率为 $\\kappa_h = (\\nabla_h \\cdot \\mathbf{n}_h)_{i,j}$，其中 $\\mathbf{n}_h$ 是离散单位法向量。中心差分散度为：\n$$\n\\kappa_h = \\frac{(n_x)_{i+1,j} - (n_x)_{i-1,j}}{2h} + \\frac{(n_y)_{i,j+1} - (n_y)_{i,j-1}}{2h}\n$$\n这需要计算 $(i,j)$ 四个邻近节点上的离散法向量 $\\mathbf{n}_h$。离散法向量定义为 $\\mathbf{n}_h = \\frac{\\nabla_h \\phi}{|\\nabla_h \\phi|}$，其中 $\\nabla_h \\phi$ 使用中心差分计算。这意味着我们首先需要计算这些邻近节点上的离散梯度。\n\n我们先计算 $y$ 分量项。在节点 $(i, j+1)=(0, \\varepsilon+h)$ 处，离散梯度分量为：\n$$\n(\\phi_x)_h|_{i,j+1} = \\frac{\\phi(h, \\varepsilon+h) - \\phi(-h, \\varepsilon+h)}{2h} = \\frac{[(\\varepsilon+h)-\\varepsilon\\cos(\\alpha h)] - [(\\varepsilon+h)-\\varepsilon\\cos(-\\alpha h)]}{2h} = 0\n$$\n$$\n(\\phi_y)_h|_{i,j+1} = \\frac{\\phi(0, \\varepsilon+2h) - \\phi(0, \\varepsilon)}{2h} = \\frac{[(\\varepsilon+2h)-\\varepsilon] - [(\\varepsilon)-\\varepsilon]}{2h} = \\frac{2h}{2h} = 1\n$$\n因此，$\\nabla_h \\phi|_{i,j+1}=(0,1)$，这导致 $\\mathbf{n}_h|_{i,j+1}=(0,1)$，所以 $(n_y)_{i,j+1}=1$。\n类似地，在节点 $(i,j-1)=(0, \\varepsilon-h)$ 处，\n$$\n(\\phi_x)_h|_{i,j-1} = 0\n$$\n$$\n(\\phi_y)_h|_{i,j-1} = \\frac{\\phi(0, \\varepsilon) - \\phi(0, \\varepsilon-2h)}{2h} = \\frac{0 - [(\\varepsilon-2h)-\\varepsilon]}{2h} = \\frac{2h}{2h}=1\n$$\n因此，$\\mathbf{n}_h|_{i,j-1}=(0,1)$ 且 $(n_y)_{i,j-1}=1$。对 $\\kappa_h$ 的 $y$ 方向贡献为 $\\frac{1-1}{2h} = 0$。\n\n现在来计算 $x$ 分量项。我们需要节点 $(i+1,j)=(h,\\varepsilon)$ 和 $(i-1,j)=(-h,\\varepsilon)$ 处的 $\\mathbf{n}_h$。\n我们来求节点 $(i+1,j)$ 处的离散梯度：\n$$\n(\\phi_x)_h|_{i+1,j} = \\frac{\\phi(2h, \\varepsilon) - \\phi(0, \\varepsilon)}{2h} = \\frac{[\\varepsilon-\\varepsilon\\cos(2\\alpha h)] - 0}{2h} = \\frac{\\varepsilon(1-\\cos(2\\alpha h))}{2h}\n$$\n$$\n(\\phi_y)_h|_{i+1,j} = \\frac{\\phi(h, \\varepsilon+h) - \\phi(h, \\varepsilon-h)}{2h} = \\frac{[(\\varepsilon+h)-\\varepsilon\\cos(\\alpha h)] - [(\\varepsilon-h)-\\varepsilon\\cos(\\alpha h)]}{2h} = \\frac{2h}{2h} = 1\n$$\n根据对称性，在节点 $(i-1,j)$ 处，$(\\phi_x)_h|_{i-1,j} = -(\\phi_x)_h|_{i+1,j}$ 且 $(\\phi_y)_h|_{i-1,j} = 1$。\n\n令 $G_x = (\\phi_x)_h|_{i+1,j}$。我们使用 Taylor 级数 $\\cos(z) = 1 - \\frac{z^2}{2!} + \\frac{z^4}{4!} - \\mathcal{O}(z^6)$ 对小 $h$ 的 $G_x$ 进行展开：\n$$\n1-\\cos(2\\alpha h) = 1 - \\left(1 - \\frac{(2\\alpha h)^2}{2} + \\frac{(2\\alpha h)^4}{24} - \\dots\\right) = 2\\alpha^2 h^2 - \\frac{2}{3}\\alpha^4 h^4 + \\mathcal{O}(h^6)\n$$\n$$\nG_x = \\frac{\\varepsilon}{2h}\\left(2\\alpha^2 h^2 - \\frac{2}{3}\\alpha^4 h^4 + \\mathcal{O}(h^6)\\right) = \\varepsilon\\alpha^2 h - \\frac{1}{3}\\varepsilon\\alpha^4 h^3 + \\mathcal{O}(h^5)\n$$\n法向量的 $x$ 分量 $(n_x)_{i+1,j}$ 由下式给出：\n$$\n(n_x)_{i+1,j} = \\frac{G_x}{\\sqrt{G_x^2 + 1^2}} = G_x (1+G_x^2)^{-1/2}\n$$\n使用二项式展开 $(1+z)^{-1/2} = 1 - \\frac{1}{2}z + \\mathcal{O}(z^2)$，其中 $z=G_x^2$：\n$$\n(n_x)_{i+1,j} = G_x \\left(1 - \\frac{1}{2}G_x^2 + \\mathcal{O}(G_x^4)\\right) = G_x - \\frac{1}{2}G_x^3 + \\mathcal{O}(G_x^5)\n$$\n$G_x$ 的领头项是 $\\mathcal{O}(h)$，因此 $G_x^3$ 是 $\\mathcal{O}(h^3)$。在 $(n_x)_{i+1,j}$ 的展开式中，我们需要保留到 $h^3$ 的项：\n$$\nG_x = \\varepsilon\\alpha^2 h - \\frac{1}{3}\\varepsilon\\alpha^4 h^3 + \\mathcal{O}(h^5)\n$$\n$$\nG_x^3 = \\left(\\varepsilon\\alpha^2 h\\right)^3 + \\mathcal{O}(h^5) = \\varepsilon^3\\alpha^6 h^3 + \\mathcal{O}(h^5)\n$$\n将这些代入 $(n_x)_{i+1,j}$ 的表达式中：\n$$\n(n_x)_{i+1,j} = \\left(\\varepsilon\\alpha^2 h - \\frac{1}{3}\\varepsilon\\alpha^4 h^3\\right) - \\frac{1}{2}\\left(\\varepsilon^3\\alpha^6 h^3\\right) + \\mathcal{O}(h^5)\n$$\n$$\n(n_x)_{i+1,j} = \\varepsilon\\alpha^2 h - \\left(\\frac{1}{3}\\varepsilon\\alpha^4 + \\frac{1}{2}\\varepsilon^3\\alpha^6\\right)h^3 + \\mathcal{O}(h^5)\n$$\n由于对称性，$(\\nabla_h\\phi)|_{i-1,j} = (-G_x, 1)$，因此 $(n_x)_{i-1,j} = \\frac{-G_x}{\\sqrt{G_x^2+1}} = -(n_x)_{i+1,j}$。\n现在我们组合离散曲率 $\\kappa_h$：\n$$\n\\kappa_h = \\frac{(n_x)_{i+1,j} - (-(n_x)_{i+1,j})}{2h} + 0 = \\frac{2(n_x)_{i+1,j}}{2h} = \\frac{(n_x)_{i+1,j}}{h}\n$$\n$$\n\\kappa_h = \\frac{1}{h}\\left[\\varepsilon\\alpha^2 h - \\left(\\frac{1}{3}\\varepsilon\\alpha^4 + \\frac{1}{2}\\varepsilon^3\\alpha^6\\right)h^3 + \\mathcal{O}(h^5)\\right]\n$$\n$$\n\\kappa_h = \\varepsilon\\alpha^2 - \\left(\\frac{1}{3}\\varepsilon\\alpha^4 + \\frac{1}{2}\\varepsilon^3\\alpha^6\\right)h^2 + \\mathcal{O}(h^4)\n$$\n问题要求将无量纲曲率 $\\kappa_h / \\alpha$ 展开为以 $\\tilde{\\varepsilon} = \\alpha\\varepsilon$ 和 $\\delta = \\alpha h$ 表示的级数。\n$$\n\\frac{\\kappa_h}{\\alpha} = \\varepsilon\\alpha - \\frac{1}{\\alpha}\\left(\\frac{1}{3}\\varepsilon\\alpha^4 + \\frac{1}{2}\\varepsilon^3\\alpha^6\\right)h^2 + \\mathcal{O}(h^4)\n$$\n让我们使用无量纲变量重写括号中的项：\n$$\n\\frac{1}{3}\\varepsilon\\alpha^4 = \\frac{1}{3}(\\alpha\\varepsilon)\\alpha^3 = \\frac{1}{3}\\tilde{\\varepsilon}\\alpha^3\n$$\n$$\n\\frac{1}{2}\\varepsilon^3\\alpha^6 = \\frac{1}{2}(\\alpha\\varepsilon)^3\\alpha^3 = \\frac{1}{2}\\tilde{\\varepsilon}^3\\alpha^3\n$$\n将此代回 $\\kappa_h/\\alpha$ 的展开式：\n$$\n\\frac{\\kappa_h}{\\alpha} = \\tilde{\\varepsilon} - \\frac{1}{\\alpha}\\left(\\frac{1}{3}\\tilde{\\varepsilon}\\alpha^3 + \\frac{1}{2}\\tilde{\\varepsilon}^3\\alpha^3\\right)h^2 + \\mathcal{O}(h^4)\n$$\n$$\n\\frac{\\kappa_h}{\\alpha} = \\tilde{\\varepsilon} - \\left(\\frac{1}{3}\\tilde{\\varepsilon}\\alpha^2 + \\frac{1}{2}\\tilde{\\varepsilon}^3\\alpha^2\\right)h^2 + \\mathcal{O}(h^4)\n$$\n现在，代入 $h^2 = \\delta^2/\\alpha^2$：\n$$\n\\frac{\\kappa_h}{\\alpha} = \\tilde{\\varepsilon} - \\left(\\frac{1}{3}\\tilde{\\varepsilon}\\alpha^2 + \\frac{1}{2}\\tilde{\\varepsilon}^3\\alpha^2\\right)\\frac{\\delta^2}{\\alpha^2} + \\mathcal{O}(\\delta^4)\n$$\n$$\n\\frac{\\kappa_h}{\\alpha} = \\tilde{\\varepsilon} - \\left(\\frac{1}{3}\\tilde{\\varepsilon} + \\frac{1}{2}\\tilde{\\varepsilon}^3\\right)\\delta^2 + \\mathcal{O}(\\delta^4)\n$$\n将其与给定形式 $\\kappa_h / \\alpha = \\tilde{\\varepsilon} + C(\\tilde{\\varepsilon}) \\, \\delta^2 + \\mathcal{O}(\\delta^4)$ 进行比较，我们可以确定系数 $C(\\tilde{\\varepsilon})$：\n$$\nC(\\tilde{\\varepsilon}) = -\\left(\\frac{1}{3}\\tilde{\\varepsilon} + \\frac{1}{2}\\tilde{\\varepsilon}^3\\right)\n$$\n此表达式也可以写成 $-\\frac{\\tilde{\\varepsilon}}{6}(2+3\\tilde{\\varepsilon}^2)$。",
            "answer": "$$\\boxed{-\\left(\\frac{1}{3}\\tilde{\\varepsilon} + \\frac{1}{2}\\tilde{\\varepsilon}^3\\right)}$$"
        },
        {
            "introduction": "数值计算中不可避免的曲率误差，究竟会对我们关心的宏观物理预测（例如液滴的破碎）产生多大影响？本练习将局部曲率误差与决定液滴稳定性的关键无量纲参数——临界韦伯数（Weber number）直接关联起来。通过分析空气动力与表面张力之间的竞争平衡，您将推导出一个理论模型，用以预测数值误差如何改变模拟所得的临界韦伯数，并进一步建立一个后验的网格划分标准 ()，从而确保模拟结果的误差在可接受的范围内。",
            "id": "3312887",
            "problem": "一个直径为 $D$ 的液滴被放置在均匀不可压缩流中，并受到流体动力作用，当惯性力克服毛细管阻力时，可能导致袋状破裂。考虑不可压缩的 Navier–Stokes 方程，其中表面张力由连续表面力（CSF）模型表示，毛细管力密度为 $\\mathbf{f}_{\\sigma}=\\sigma \\kappa \\mathbf{n} \\delta_{\\Gamma}$，其中 $\\sigma$ 为表面张力，$\\kappa$ 为平均曲率，$\\mathbf{n}$ 为单位法向量，$\\delta_{\\Gamma}$ 为表面狄拉克δ分布。将韦伯数（Weber number）定义为 $We=\\rho U^{2} D / \\sigma$，其中 $\\rho$ 是密度，$U$ 是特征速度，$D$ 是液滴直径。假设袋状破裂的起始主要由气动力和毛细管阻力之间的平衡决定。\n\n多相流的数值方法必须重构曲率。设重构曲率 $\\kappa_{\\text{num}}$ 相对于真实曲率 $\\kappa$ 的相对误差为 $\\varepsilon_{\\kappa}$：$\\kappa_{\\text{num}}=(1+\\varepsilon_{\\kappa})\\kappa$。曲率误差取决于网格尺寸 $h$ 和局部曲率半径 $R=1/|\\kappa|$。考虑两种界面捕捉方法：\n- 流体体积法（VOF）：对于良好解析的高度函数曲率，将曲率误差建模为 $\\varepsilon_{\\kappa}^{\\text{VOF}}=\\alpha_{\\text{V}} (h/R)^{2}$，其中 $\\alpha_{\\text{V}}>0$ 为正常数。\n- 水平集法（LS）：将曲率误差建模为 $\\varepsilon_{\\kappa}^{\\text{LS}}=\\alpha_{\\text{L}} (h/R)^{2} - \\beta_{\\text{L}} (W/R)^{2}$，其中 $W=k_{W} h$ 是弥散界面厚度，$\\alpha_{\\text{L}}>0$，$\\beta_{\\text{L}}\\ge 0$，且 $k_{W}\\ge 1$ 表示以单元格数计的界面厚度。\n\n假设在真实物理情况中（具有精确的表面张力），临界韦伯数为 $We_{\\text{crit,true}}$。利用无量纲化和力平衡的第一性原理，并将曲率误差视为动量方程中毛细管项的有效乘法扰动，推导：\n1) 用 $We_{\\text{crit,true}}$ 和 $\\varepsilon_{\\kappa}$ 表示数值预测的临界韦伯数 $We_{\\text{crit,pred}}$ 的表达式。\n2) 一个后验网格准则，该准则确保预测的临界韦伯数的相对误差满足目标界限，即 $|We_{\\text{crit,pred}}-We_{\\text{crit,true}}|/We_{\\text{crit,true}}\\le \\tau$，其中 $\\tau \\in (0,1)$ 是预设的容差。将曲率尺度建立在毛细管长度 $l_{\\sigma}=\\sqrt{\\sigma/(\\rho a)}$ 的基础上，其中 $a$ 是一个在变形过程中设定曲率尺度的特征加速度。将你的界限表示为关于 $h$（单位为米）的不等式，形式为 $h \\le h_{\\max}$，并用 $\\tau$、$l_{\\sigma}$ 和特定方法的误差系数来表示。使用满足所假设模型的最小非负系数 $C_{\\text{eff}}$，使得 $|\\varepsilon_{\\kappa}|\\le C_{\\text{eff}} (h/l_{\\sigma})^{2}$ 成立，并以米为单位报告 $h_{\\max}$。\n\n使用您推导的表达式，编写一个程序，为下面的测试套件中的每个案例计算：\n- 预测的临界韦伯数 $We_{\\text{crit,pred}}$（无量纲）。\n- 使用毛细管长度准则，保证容差 $\\tau$ 的最大允许网格尺寸 $h_{\\max}$（单位为米）。\n- 一个通过指示符，如果给定的网格尺寸 $h$ 满足 $h \\le h_{\\max}$，则其值为 $1$，否则为 $0$。\n\n所有物理输入必须以国际单位制（SI）解释：米（m）、千克（kg）、秒（s）。不使用角度。所有报告的 $h_{\\max}$ 值必须以米为单位，所有 $We$ 值均为无量纲。将所有浮点输出四舍五入到六位小数。\n\n测试套件（每行定义一个案例，形式为元组 $(\\text{方法}, We_{\\text{crit,true}}, R, h, \\alpha, \\beta, k_{W}, \\sigma, \\rho, a, \\tau)$）：\n- 案例 A（正常路径，VOF）：$(\"VOF\", 12.0, 1.0\\times 10^{-3}, 2.0\\times 10^{-4}, 0.5, 0.0, 1.0, 0.072, 1000.0, 30.0, 0.05)$\n- 案例 B（粗网格，可能存在负偏差，LS）：$(\"LS\", 12.0, 5.0\\times 10^{-4}, 2.5\\times 10^{-4}, 0.2, 0.15, 1.5, 0.072, 1000.0, 200.0, 0.03)$\n- 案例 C（近零误差，精细VOF）：$(\"VOF\", 15.0, 1.5\\times 10^{-3}, 1.5\\times 10^{-5}, 0.5, 0.0, 1.0, 0.072, 1000.0, 5.0, 0.01)$\n- 案例 D（不满足网格准则，LS）：$(\"LS\", 12.0, 1.0\\times 10^{-3}, 8.0\\times 10^{-4}, 0.25, 0.05, 2.0, 0.072, 1000.0, 500.0, 0.02)$\n\n最终输出格式：您的程序应生成单行输出，其中包含以逗号分隔的案例结果列表，每个案例结果都是 $[We_{\\text{crit,pred}}, h_{\\max}, \\text{pass}]$ 形式的三元素列表，浮点数条目四舍五入到六位小数，通过指示符为整数 $0$ 或 $1$。例如：$[[x_{1},y_{1},z_{1}],[x_{2},y_{2},z_{2}],\\dots]$。",
            "solution": "所陈述的问题具有科学依据，是自洽且适定的。它提出了一个在多相流数值方法分析中的标准问题，特别关注曲率估计误差对物理不稳定性预测的影响。曲率误差模型虽然经过简化，但代表了在流体体积法（VOF）和水平集法（LS）中观察到的行为。所有需要的数据和定义均已提供。因此，该问题是有效的，可以构建解决方案。\n\n按要求，解决方案分为两部分推导。首先，我们推导预测的临界韦伯数 $We_{\\text{crit,pred}}$ 的表达式。其次，我们推导一个网格细化准则，以限制此预测中的数值误差。\n\n**第一部分：预测临界韦伯数 $We_{\\text{crit,pred}}$ 的推导**\n\n液滴破裂的起始由不稳定的惯性力（其量级为 $F_{\\text{inertial}} \\propto \\rho U^2 D^2$）和稳定的毛细管力（其量级为 $F_{\\text{capillary}} \\propto \\sigma D$）之间的平衡决定。韦伯数 $We = \\rho U^2 D / \\sigma$ 是这两种力的比值。当 $We$ 达到一个临界值 $We_{\\text{crit,true}}$ 时，会发生物理破裂。这个临界值是由底层流体动力学决定的一个常数，代表了一个特定的临界力比。\n\n在数值模拟中，毛细管力是基于数值估计的曲率 $\\kappa_{\\text{num}}$ 计算的。问题陈述，毛细管力密度由连续表面力（CSF）模型给出，即 $\\mathbf{f}_{\\sigma}=\\sigma \\kappa \\mathbf{n} \\delta_{\\Gamma}$。因此，该力的数值实现为 $\\mathbf{f}_{\\sigma, \\text{num}}=\\sigma \\kappa_{\\text{num}} \\mathbf{n} \\delta_{\\Gamma}$。\n\n数值曲率通过相对误差 $\\varepsilon_{\\kappa}$ 与真实曲率 $\\kappa$ 相关联：\n$$\n\\kappa_{\\text{num}} = (1 + \\varepsilon_{\\kappa}) \\kappa\n$$\n将此代入数值力表达式可得：\n$$\n\\mathbf{f}_{\\sigma, \\text{num}} = \\sigma (1 + \\varepsilon_{\\kappa}) \\kappa \\mathbf{n} \\delta_{\\Gamma} = (1 + \\varepsilon_{\\kappa}) \\mathbf{f}_{\\sigma}\n$$\n这表明数值方法实际上是使用一个修正的或有效的表面张力 $\\sigma_{\\text{eff}}$ 进行运算：\n$$\n\\sigma_{\\text{eff}} = \\sigma (1 + \\varepsilon_{\\kappa})\n$$\n当惯性力与其*计算出的*毛细管力之比达到真实的物理临界阈值 $We_{\\text{crit,true}}$ 时，数值模拟将预测破裂。设 $U_{\\text{pred}}$ 为模拟预测破裂时的临界速度。在数值世界中的平衡关系是：\n$$\n\\frac{\\rho U_{\\text{pred}}^2 D}{\\sigma_{\\text{eff}}} = We_{\\text{crit,true}}\n$$\n根据定义，预测的临界韦伯数使用*真实的*物理参数表示：\n$$\nWe_{\\text{crit,pred}} = \\frac{\\rho U_{\\text{pred}}^2 D}{\\sigma}\n$$\n从数值平衡方程，我们可以写出 $\\rho U_{\\text{pred}}^2 D = We_{\\text{crit,true}} \\cdot \\sigma_{\\text{eff}}$。将此代入 $We_{\\text{crit,pred}}$ 的定义中可得：\n$$\nWe_{\\text{crit,pred}} = \\frac{We_{\\text{crit,true}} \\cdot \\sigma_{\\text{eff}}}{\\sigma} = \\frac{We_{\\text{crit,true}} \\cdot \\sigma(1 + \\varepsilon_{\\kappa})}{\\sigma}\n$$\n这简化为所需的表达式：\n$$\nWe_{\\text{crit,pred}} = We_{\\text{crit,true}} (1 + \\varepsilon_{\\kappa})\n$$\n相对误差 $\\varepsilon_{\\kappa}$ 使用给定的模型计算。对于 VOF 方法，它是：\n$$\n\\varepsilon_{\\kappa} = \\varepsilon_{\\kappa}^{\\text{VOF}} = \\alpha_{\\text{V}} \\left(\\frac{h}{R}\\right)^2\n$$\n对于 LS 方法，它是：\n$$\n\\varepsilon_{\\kappa} = \\varepsilon_{\\kappa}^{\\text{LS}} = \\alpha_{\\text{L}} \\left(\\frac{h}{R}\\right)^2 - \\beta_{\\text{L}} \\left(\\frac{W}{R}\\right)^2 = \\alpha_{\\text{L}} \\left(\\frac{h}{R}\\right)^2 - \\beta_{\\text{L}} \\left(\\frac{k_{W}h}{R}\\right)^2 = (\\alpha_{\\text{L}} - \\beta_{\\text{L}} k_{W}^2) \\left(\\frac{h}{R}\\right)^2\n$$\n\n**第二部分：网格准则的推导**\n\n目标是找到关于网格尺寸 $h$ 的一个条件，以确保预测的临界韦伯数的相对误差受容差 $\\tau$ 的限制：\n$$\n\\frac{|We_{\\text{crit,pred}} - We_{\\text{crit,true}}|}{We_{\\text{crit,true}}} \\le \\tau\n$$\n代入第一部分中 $We_{\\text{crit,pred}}$ 的表达式：\n$$\n\\frac{|We_{\\text{crit,true}} (1 + \\varepsilon_{\\kappa}) - We_{\\text{crit,true}}|}{We_{\\text{crit,true}}} \\le \\tau\n$$\n$$\n\\frac{|We_{\\text{crit,true}} \\cdot \\varepsilon_{\\kappa}|}{We_{\\text{crit,true}}} \\le \\tau\n$$\n假设 $We_{\\text{crit,true}} > 0$，这简化为关于曲率误差大小的条件：\n$$\n|\\varepsilon_{\\kappa}| \\le \\tau\n$$\n该问题要求将网格准则建立在毛细管长度 $l_{\\sigma} = \\sqrt{\\sigma/(\\rho a)}$ 的基础上，并将其作为特征曲率半径，即 $R = l_{\\sigma}$。我们必须找到最小的非负系数 $C_{\\text{eff}}$，使得 $|\\varepsilon_{\\kappa}| \\le C_{\\text{eff}} (h/l_{\\sigma})^2$。这可以通过将 $R=l_{\\sigma}$ 代入误差模型来实现。\n\n对于 VOF：\n$$\n|\\varepsilon_{\\kappa}^{\\text{VOF}}| = \\left|\\alpha_{\\text{V}} \\left(\\frac{h}{l_{\\sigma}}\\right)^2\\right| = \\alpha_{\\text{V}} \\left(\\frac{h}{l_{\\sigma}}\\right)^2 \\quad (\\text{因为 } \\alpha_{\\text{V}} > 0)\n$$\n因此，对于 VOF，$C_{\\text{eff}} = \\alpha_{\\text{V}}$。\n\n对于 LS：\n$$\n|\\varepsilon_{\\kappa}^{\\text{LS}}| = \\left|(\\alpha_{\\text{L}} - \\beta_{\\text{L}} k_{W}^2) \\left(\\frac{h}{l_{\\sigma}}\\right)^2\\right| = |\\alpha_{\\text{L}} - \\beta_{\\text{L}} k_{W}^2| \\left(\\frac{h}{l_{\\sigma}}\\right)^2\n$$\n因此，对于 LS，$C_{\\text{eff}} = |\\alpha_{\\text{L}} - \\beta_{\\text{L}} k_{W}^2|$。\n\n误差约束 $|\\varepsilon_{\\kappa}| \\le \\tau$ 变为：\n$$\nC_{\\text{eff}} \\left(\\frac{h}{l_{\\sigma}}\\right)^2 \\le \\tau\n$$\n如果 $C_{\\text{eff}} > 0$，我们可以求解 $h$：\n$$\nh^2 \\le \\frac{\\tau \\cdot l_{\\sigma}^2}{C_{\\text{eff}}}\n$$\n$$\nh \\le l_{\\sigma} \\sqrt{\\frac{\\tau}{C_{\\text{eff}}}}\n$$\n这给出了最大允许网格尺寸 $h_{\\max}$：\n$$\nh_{\\max} = l_{\\sigma} \\sqrt{\\frac{\\tau}{C_{\\text{eff}}}} = \\sqrt{\\frac{\\sigma}{\\rho a}} \\sqrt{\\frac{\\tau}{C_{\\text{eff}}}}\n$$\n如果 $C_{\\text{eff}} = 0$，对于 $\\tau \\in (0,1)$，不等式 $0 \\le \\tau$ 始终成立，这意味着任何网格尺寸都是可接受的。在这种情况下，$h_{\\max} \\to \\infty$。\n\n**程序计算步骤摘要**\n\n对于每个测试案例：\n1.  识别方法（`VOF` 或 `LS`）并解包参数 $(\\text{方法}, We_{\\text{crit,true}}, R, h, \\alpha, \\beta, k_{W}, \\sigma, \\rho, a, \\tau)$。对于 VOF，$\\alpha = \\alpha_{\\text{V}}$。对于 LS，$\\alpha = \\alpha_{\\text{L}}$ 且 $\\beta = \\beta_{\\text{L}}$。\n2.  计算曲率误差 $\\varepsilon_{\\kappa}$。\n    - 如果方法为 `VOF`：$\\varepsilon_{\\kappa} = \\alpha (h/R)^2$。\n    - 如果方法为 `LS`：$\\varepsilon_{\\kappa} = (\\alpha - \\beta k_{W}^2) (h/R)^2$。\n3.  计算预测的临界韦伯数：$We_{\\text{crit,pred}} = We_{\\text{crit,true}}(1 + \\varepsilon_{\\kappa})$。\n4.  计算毛细管长度：$l_{\\sigma} = \\sqrt{\\sigma/(\\rho a)}$。\n5.  计算有效误差系数 $C_{\\text{eff}}$。\n    - 如果方法为 `VOF`：$C_{\\text{eff}} = \\alpha$。\n    - 如果方法为 `LS`：$C_{\\text{eff}} = |\\alpha - \\beta k_{W}^2|$。\n6.  计算最大网格尺寸 $h_{\\max}$。\n    - 如果 $C_{\\text{eff}} > 0$：$h_{\\max} = l_{\\sigma} \\sqrt{\\tau / C_{\\text{eff}}}$。\n    - 如果 $C_{\\text{eff}} = 0$：$h_{\\max} = \\infty$。\n7.  确定通过指示符：如果给定的网格尺寸 $h$ 满足 $h \\le h_{\\max}$，则设置为 $1$，否则设置为 $0$。\n8.  将结果格式化为 $[We_{\\text{crit,pred}}, h_{\\max}, \\text{pass}]$，浮点数值四舍五入到六位小数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# No other libraries are imported.\n\ndef solve():\n    \"\"\"\n    Solves the droplet breakup problem for the given test suite.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (method, We_crit_true, R, h, alpha, beta, k_W, sigma, rho, a, tau)\n        (\"VOF\", 12.0, 1.0e-3, 2.0e-4, 0.5, 0.0, 1.0, 0.072, 1000.0, 30.0, 0.05),\n        (\"LS\", 12.0, 5.0e-4, 2.5e-4, 0.2, 0.15, 1.5, 0.072, 1000.0, 200.0, 0.03),\n        (\"VOF\", 15.0, 1.5e-3, 1.5e-5, 0.5, 0.0, 1.0, 0.072, 1000.0, 5.0, 0.01),\n        (\"LS\", 12.0, 1.0e-3, 8.0e-4, 0.25, 0.05, 2.0, 0.072, 1000.0, 500.0, 0.02)\n    ]\n\n    results = []\n    for case in test_cases:\n        method, we_crit_true, R_val, h_val, alpha, beta, k_w, sigma, rho, a_val, tau = case\n\n        # 1. Calculate the relative curvature error, epsilon_kappa\n        h_over_R = h_val / R_val\n        if method == \"VOF\":\n            # For VOF, epsilon_kappa = alpha_V * (h/R)^2\n            epsilon_kappa = alpha * (h_over_R**2)\n        elif method == \"LS\":\n            # For LS, epsilon_kappa = (alpha_L - beta_L * k_W^2) * (h/R)^2\n            epsilon_kappa = (alpha - beta * k_w**2) * (h_over_R**2)\n        else:\n            raise ValueError(\"Unknown method specified.\")\n\n        # 2. Calculate the predicted critical Weber number, We_crit_pred\n        we_crit_pred = we_crit_true * (1.0 + epsilon_kappa)\n\n        # 3. Calculate the maximum admissible mesh size, h_max\n        # Calculate capillary length, l_sigma\n        l_sigma = np.sqrt(sigma / (rho * a_val))\n        \n        # Calculate the effective error coefficient, C_eff\n        if method == \"VOF\":\n            c_eff = alpha\n        elif method == \"LS\":\n            c_eff = np.abs(alpha - beta * k_w**2)\n        \n        # Calculate h_max, handling the case C_eff = 0\n        if c_eff > 0:\n            h_max = l_sigma * np.sqrt(tau / c_eff)\n        else:\n            # If c_eff is 0, the error is always 0, so any mesh size is permitted.\n            h_max = float('inf')\n\n        # 4. Determine the pass indicator\n        pass_indicator = 1 if h_val = h_max else 0\n        \n        # Store the rounded results for the current case\n        results.append([\n            round(we_crit_pred, 6),\n            round(h_max, 6),\n            pass_indicator\n        ])\n\n    # Final print statement in the exact required format.\n    # The format is a list of lists, represented as a string.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        },
        {
            "introduction": "直接追踪成千上万个液滴的界面在计算上可能极其昂贵，尤其是在模拟喷雾等大规模系统时。一种高效的替代方案是采用统计模型，转而描述液滴群的尺寸分布演化。本练习将带您进入群体平衡方程（PBE）的世界，并实践一种强大的数值方法——直接矩量法（DQMOM），该方法通过追踪分布的各阶矩（如总数、总面积、总体积）来表征液滴群。您将亲手构建并求解一个线性系统，以确保数值格式严格遵守破碎过程中的体积守恒定律 ()，从而深入理解矩量法的核心思想及其在保证物理守恒性方面的重要性。",
            "id": "3312856",
            "problem": "考虑仅有破碎过程的、以液滴直径 $d$ 为坐标的总体平衡方程 (PBE)，其中液滴体积的守恒对应于三阶矩 $M_3$ 的守恒。令 $n(d,t)$ 表示数密度函数。仅有破碎过程的 PBE 为\n$$\n\\frac{\\partial n(d,t)}{\\partial t} = -a(d)\\,n(d,t) + \\int_{d}^{\\infty} a(d')\\,n(d',t)\\,\\beta(d\\mid d')\\,\\mathrm{d}d',\n$$\n其中 $a(d)$ 是破碎频率，$\\beta(d\\mid d')$ 是子体分布密度，表示一个直径为 $d'$ 的母体破碎后，在 $[d,d+\\mathrm{d}d]$ 范围内产生的碎片的期望数量。假设子体分布为二元等体积解析分布\n$$\n\\beta(d\\mid d') = 2\\,\\delta\\!\\left(d - 2^{-1/3} d'\\right),\n$$\n这意味着三阶矩 $M_3$ 是守恒的，因为\n$$\n\\int_{0}^{d'} d^3 \\,\\beta(d\\mid d')\\,\\mathrm{d}d = 2\\,(2^{-1/3} d')^3 = d'^3.\n$$\n令破碎频率为幂律形式 $a(d) = a_0\\, d^\\alpha$，其中 $a_00$ 且 $\\alpha \\in \\mathbb{R}$。矩定义为 $M_k(t) = \\int_0^\\infty d^k\\,n(d,t)\\,\\mathrm{d}d$。\n\n使用直接矩量正交法 (DQMOM)，其中数密度由 $N$ 个节点的狄拉克-德尔塔函数的加权和来近似：\n$$\nn(d,t) \\approx \\sum_{i=1}^{N} w_i(t)\\,\\delta(d - d_i(t)).\n$$\n这里，$w_i(t)$ 是权重，$d_i(t)$ 是横坐标。于是矩表示为 $M_k(t) = \\sum_{i=1}^{N} w_i(t)\\,d_i(t)^k$。\n\n$k$ 阶矩的精确破碎源项为\n$$\nS_k^{\\mathrm{exact}} = \\int_0^\\infty a(d)\\,n(d)\\left[\\int_0^{d} d'^k\\,\\beta(d'\\mid d)\\,\\mathrm{d}d' - d^k\\right]\\mathrm{d}d.\n$$\n在 DQMOM 近似和给定的 $\\beta(d\\mid d')$ 条件下，该项可简化为\n$$\nS_k^{\\mathrm{exact}} = \\sum_{i=1}^{N} w_i\\,a(d_i)\\left[2\\,(2^{-1/3} d_i)^k - d_i^k\\right].\n$$\n定义权重和横坐标的 DQMOM 源项为 $s_i = \\frac{\\mathrm{d}w_i}{\\mathrm{d}t}$ 和 $r_i = \\frac{\\mathrm{d}d_i}{\\mathrm{d}t}$。强制矩一致性，对于 $k = 0,1,\\dots,2N-1$，可得\n$$\n\\sum_{i=1}^{N}\\left[s_i\\,d_i^k + k\\,w_i\\,d_i^{k-1}\\,r_i\\right] = \\sum_{i=1}^{N} w_i\\,a(d_i)\\left(2\\,(2^{-1/3} d_i)^k - d_i^k\\right).\n$$\n这是一个关于未知数 $\\{s_i\\}_{i=1}^{N}$ 和 $\\{r_i\\}_{i=1}^{N}$ 的 $2N \\times 2N$ 线性系统。求解该系统可得到 DQMOM 源项，根据构造，这些源项匹配了由破碎引起的前 $2N$ 个矩的演化。特别地，对于指定的 $\\beta(d\\mid d')$，通过 $k=3$ 的方程强制了三阶矩 $M_3$ 的守恒，因为\n$$\nS_3^{\\mathrm{exact}} = \\sum_{i=1}^{N} w_i\\,a(d_i)\\left[2\\,(2^{-1/3} d_i)^3 - d_i^3\\right] = \\sum_{i=1}^{N} w_i\\,a(d_i)\\left[d_i^3 - d_i^3\\right] = 0.\n$$\n\n您的任务是：\n- 实现一个程序，给定 $N$、权重 $\\{w_i\\}$、横坐标 $\\{d_i\\}$、破碎频率参数 $a_0$ 和 $\\alpha$，根据上述 $k = 0,1,\\dots,2N-1$ 的方程，构建并求解关于 $\\{s_i\\}$ 和 $\\{r_i\\}$ 的 $2N \\times 2N$ 线性系统。\n- 对每个测试案例，计算以下两个误差指标：\n  - 在 $k = 0,1,\\dots,2N-1$ 范围内的最大绝对矩残差，\n    $$\n    e_{\\max} = \\max_{0 \\le k \\le 2N-1} \\left|\\sum_{i=1}^{N}\\left[s_i\\,d_i^k + k\\,w_i\\,d_i^{k-1}\\,r_i\\right] - \\sum_{i=1}^{N} w_i\\,a(d_i)\\left(2\\,(2^{-1/3} d_i)^k - d_i^k\\right)\\right|.\n    $$\n  - 由 DQMOM 源项预测的 $M_3$ 变化率的绝对值，\n    $$\n    \\left|\\frac{\\mathrm{d}M_3}{\\mathrm{d}t}\\right| = \\left|\\sum_{i=1}^{N}\\left[s_i\\,d_i^3 + 3\\,w_i\\,d_i^{2}\\,r_i\\right]\\right|.\n    $$\n  在此问题设定中，两个指标都是无量纲的。\n\n使用以下测试套件，其中所有量均为无量纲：\n- 测试案例 1 (理想情况):\n  - $N=2$, $\\{w_i\\} = [1.3, 0.7]$, $\\{d_i\\} = [0.9, 1.7]$, $a_0 = 2.5$, $\\alpha = 0$。\n- 测试案例 2 (更高分辨率，非恒定速率):\n  - $N=3$, $\\{w_i\\} = [0.8, 0.4, 1.1]$, $\\{d_i\\} = [0.6, 1.2, 2.4]$, $a_0 = 0.75$, $\\alpha = 1$。\n- 测试案例 3 (包含一个非常小液滴的边界情况):\n  - $N=2$, $\\{w_i\\} = [2.0, 0.2]$, $\\{d_i\\} = [0.05, 3.0]$, $a_0 = 1.8$, $\\alpha = 0.2$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个测试案例贡献一个二元列表 $[e_{\\max},\\,|\\mathrm{d}M_3/\\mathrm{d}t|]$。例如，输出格式必须如下：\n$$\n\\bigl[\\,[x_1,y_1],[x_2,y_2],[x_3,y_3]\\,\\bigr],\n$$\n其中每个 $x_j$ 和 $y_j$ 都以浮点数形式打印，且无任何附加文本。",
            "solution": "用户提供的问题已经过分析并被确定为**有效**。这是一个在计算流体动力学领域内提法得当、有科学依据的问题，具体涉及使用直接矩量正交法 (DQMOM) 对总体平衡方程 (PBEs) 进行数值求解。问题陈述是自洽的，提供了构建和求解指定量所需的所有必要方程、参数和定义。任务是实现给定的数学模型，该模型是该学科内的标准且正确的表述。\n\n问题的核心是确定一个经历纯破碎过程的液滴群的 DQMOM 权重的时间变化率 $s_i = \\frac{\\mathrm{d}w_i}{\\mathrm{d}t}$ 和横坐标的时间变化率 $r_i = \\frac{\\mathrm{d}d_i}{\\mathrm{d}t}$。这通过强制 DQMOM 近似的前 $2N$ 个矩的变化率与从 PBE 推导出的精确变化率相匹配来实现。这导出了一个包含 $2N$ 个未知数 $\\{s_i\\}_{i=1}^{N}$ 和 $\\{r_i\\}_{i=1}^{N}$ 的 $2N$ 个线性代数方程组。\n\n对于 $k = 0, 1, \\dots, 2N-1$，控制方程组为：\n$$\n\\sum_{i=1}^{N}\\left[s_i\\,d_i^k + k\\,w_i\\,d_i^{k-1}\\,r_i\\right] = \\sum_{i=1}^{N} w_i\\,a(d_i)\\left[2\\,(2^{-1/3} d_i)^k - d_i^k\\right]\n$$\n这可以写成标准矩阵形式 $A\\mathbf{x} = \\mathbf{b}$，其中 $\\mathbf{x}$ 是未知数向量，$A$ 是系数矩阵，$\\mathbf{b}$ 是右侧（源）向量。\n\n未知数向量 $\\mathbf{x}$ 排列如下：\n$$\n\\mathbf{x} = [s_1, s_2, \\dots, s_N, r_1, r_2, \\dots, r_N]^T\n$$\n这是一个大小为 $2N$ 的列向量。\n\n系数矩阵 $A$ 是一个 $2N \\times 2N$ 的矩阵。其元素由第 $k$ 阶矩方程中未知数 $s_i$ 和 $r_i$ 的系数确定。设行由 $k \\in \\{0, 1, \\dots, 2N-1\\}$ 索引，列由 $j \\in \\{0, 1, \\dots, 2N-1\\}$ 索引。\n$s_i$ 的系数（对应于矩阵的第 $j=i-1$ 列，$i=1,\\dots,N$）为：\n$$\nA_{k, i-1} = d_i^k\n$$\n$r_i$ 的系数（对应于矩阵的第 $j=N+i-1$ 列，$i=1,\\dots,N$）为：\n$$\nA_{k, N+i-1} = k\\,w_i\\,d_i^{k-1}\n$$\n对于 $k=0$，此项正确地计算为 $0$。\n\n右侧向量 $\\mathbf{b}$ 是一个大小为 $2N$ 的列向量。其第 $k$ 个元素 $b_k$ 是在 DQMOM 近似下第 $k$ 阶矩的精确源项：\n$$\nb_k = S_k^{\\mathrm{exact}} = \\sum_{i=1}^{N} w_i\\,a(d_i)\\left[2\\,(2^{-1/3} d_i)^k - d_i^k\\right]\n$$\n代入给定的幂律破碎频率 $a(d) = a_0\\, d^\\alpha$，我们得到：\n$$\nb_k = a_0 \\left(2^{1-k/3} - 1\\right) \\sum_{i=1}^{N} w_i\\,d_i^{k+\\alpha}\n$$\n值得注意的是，对于 $k=3$，因子 $(2^{1-3/3} - 1) = (2^0 - 1) = 0$，因此 $b_3 = 0$。这在数学上保证了线性系统层面上的三阶矩守恒（体积守恒）。\n\n每个测试案例的计算过程如下：\n1.  **构建矩阵 A**：给定 $N$、$\\{w_i\\}$ 和 $\\{d_i\\}$，根据上述公式填充 $2N \\times 2N$ 的矩阵 $A$。\n2.  **构建向量 b**：给定相同的参数以及 $a_0$ 和 $\\alpha$，计算向量 $\\mathbf{b}$ 的 $2N$ 个元素。\n3.  **求解系统**：使用标准的数值线性代数库例程求解线性系统 $A\\mathbf{x} = \\mathbf{b}$ 以得到 $\\mathbf{x}$。这将得出 $\\{s_i\\}$ 和 $\\{r_i\\}$ 的数值。\n4.  **计算误差指标**：\n    - 最大绝对矩残差 $e_{\\max}$，通过使用计算出的解 $\\mathbf{x}_{\\text{sol}}$ 计算残差向量 $\\mathbf{res} = A\\mathbf{x}_{\\text{sol}} - \\mathbf{b}$，并找出其分量中的最大绝对值来计算：$e_{\\max} = \\max_k |\\mathbf{res}_k|$。该指标量化了线性求解器的准确性。\n    - $M_3$ 的变化率的绝对值 $|\\mathrm{d}M_3/\\mathrm{d}t}|$，使用求解出的源项进行计算：$|\\frac{\\mathrm{d}M_3}{\\mathrm{d}t}| = \\left|\\sum_{i=1}^{N}\\left[s_i\\,d_i^3 + 3\\,w_i\\,d_i^{2}\\,r_i\\right]\\right|$。由于 $k=3$ 的线性系统将此量设为 $0$，因此其计算值是强制体积守恒约束时数值误差的一个特定度量。\n\n对每个提供的测试案例实施此过程，以获得所需结果。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import solve as solve_linear_system\n\ndef compute_dqmom_sources(N, w, d, a0, alpha):\n    \"\"\"\n    Constructs and solves the DQMOM linear system for breakup source terms\n    and computes the required error metrics.\n\n    Args:\n        N (int): Number of quadrature nodes.\n        w (list or np.ndarray): Weights of the quadrature.\n        d (list or np.ndarray): Abscissas (diameters) of the quadrature.\n        a0 (float): Breakup frequency pre-factor.\n        alpha (float): Breakup frequency power-law exponent.\n\n    Returns:\n        list: A list containing [e_max, |dM3/dt|].\n    \"\"\"\n    # Cast inputs to numpy arrays for vectorized operations.\n    # Use float64 for precision.\n    w = np.array(w, dtype=np.float64)\n    d = np.array(d, dtype=np.float64)\n\n    # Initialize the coefficient matrix A and the right-hand side vector b.\n    dim = 2 * N\n    A = np.zeros((dim, dim), dtype=np.float64)\n    b = np.zeros(dim, dtype=np.float64)\n\n    # Constant from binary equal-volume daughter distribution.\n    cbrt2_inv = 2**(-1.0/3.0)\n\n    # Populate the matrix A and vector b row by row (k = 0 to 2N-1).\n    for k in range(dim):\n        # Part 1: Populate the k-th row of the matrix A.\n        # Columns 0 to N-1 correspond to s_i coefficients.\n        for i in range(N):\n            A[k, i] = d[i]**k\n\n        # Columns N to 2N-1 correspond to r_i coefficients.\n        for i in range(N):\n            if k == 0:\n                A[k, N + i] = 0.0\n            else:\n                A[k, N + i] = k * w[i] * d[i]**(k - 1)\n\n        # Part 2: Calculate the k-th component of the RHS vector b.\n        # This is the exact moment source term S_k^exact.\n        b_k_val = 0.0\n        for i in range(N):\n            breakup_freq = a0 * d[i]**alpha\n            birth_term = 2 * (cbrt2_inv * d[i])**k\n            death_term = d[i]**k\n            b_k_val += w[i] * breakup_freq * (birth_term - death_term)\n        b[k] = b_k_val\n\n    # Solve the linear system A * x = b for x = [s_1,..,s_N, r_1,..,r_N]^T.\n    try:\n        x_sol = solve_linear_system(A, b)\n    except np.linalg.LinAlgError:\n        # This case should not be reached with the given test data.\n        return [np.nan, np.nan]\n\n    # Extract source terms s_i and r_i from the solution vector.\n    s = x_sol[:N]\n    r = x_sol[N:]\n\n    # Calculate the two specified error metrics.\n\n    # Metric 1: Maximum absolute moment residual.\n    # This measures the accuracy of the numerical solution of the linear system.\n    residual_vector = A @ x_sol - b\n    e_max = np.max(np.abs(residual_vector))\n\n    # Metric 2: Absolute value of the rate of change of the third moment M_3.\n    # This specifically checks how well volume conservation is enforced.\n    dM3_dt = np.sum(s * d**3 + 3 * w * d**2 * r)\n    abs_dM3_dt = np.abs(dM3_dt)\n\n    return [e_max, abs_dM3_dt]\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {'N': 2, 'w': [1.3, 0.7], 'd': [0.9, 1.7], 'a0': 2.5, 'alpha': 0},\n        {'N': 3, 'w': [0.8, 0.4, 1.1], 'd': [0.6, 1.2, 2.4], 'a0': 0.75, 'alpha': 1},\n        {'N': 2, 'w': [2.0, 0.2], 'd': [0.05, 3.0], 'a0': 1.8, 'alpha': 0.2}\n    ]\n\n    results = []\n    for case in test_cases:\n        result = compute_dqmom_sources(case['N'], case['w'], case['d'], case['a0'], case['alpha'])\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    output_str = f\"[{','.join(f'[{res[0]},{res[1]}]' for res in results)}]\"\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}