{
    "hands_on_practices": [
        {
            "introduction": "Before simulating a full spray containing millions of droplets, we must first ensure that our numerical implementation for a single droplet's evolution is correct. This practice introduces the Method of Manufactured Solutions (MMS), a rigorous code verification technique where we define an analytical solution and derive the necessary source terms to make it exact . By implementing a numerical solver and measuring its error against this known solution, you will gain hands-on experience in quantifying and verifying the accuracy of your code, a critical skill in computational science.",
            "id": "3364871",
            "problem": "Consider an evaporating spherical droplet parcel modeled by conservation of mass and energy under convective heat and mass transfer to a surrounding gas. The parcel is assumed to be dilute such that inter-droplet interactions are negligible, the gas-phase properties are constant, and the droplet remains spherical. Let $t$ denote time. Let the droplet liquid density be $\\rho_\\ell$, liquid specific heat capacity be $c_{p,\\ell}$, latent heat of vaporization be $L_v$, gas density be $\\rho_g$, gas dynamic viscosity be $\\mu_g$, gas thermal conductivity be $k_g$, gas specific heat capacity be $c_{p,g}$, binary diffusion coefficient of vapor in gas be $D_v$, universal gas constant be $R_u$, vapor molecular weight be $M_v$, air molecular weight be $M_{air}$, ambient gas pressure be $p$, ambient gas temperature be $T_g$, and ambient vapor mass fraction be $Y_{v,\\infty}$. The droplet mass is $m(t)$, droplet diameter is $d(t)$, and droplet temperature is $T_d(t)$. The droplet area is $A(t) = \\pi d(t)^2$, and the mass is related to diameter by $m(t) = \\rho_\\ell \\frac{\\pi}{6} d(t)^3$. The relative gas-droplet velocity magnitude is $u_{rel}$.\n\nThe governing ordinary differential equations (ODEs) for an evaporating droplet parcel with additive source terms for the Method of Manufactured Solutions (MMS) are:\n- Mass balance: $$\\frac{dm}{dt} = -\\dot{m}_e + S_m(t),$$\n- Energy balance: $$m c_{p,\\ell} \\frac{dT_d}{dt} = h A (T_g - T_d) - \\dot{m}_e L_v + S_T(t),$$\nwhere $\\dot{m}_e$ is the evaporation mass rate, $h$ is the convective heat transfer coefficient, and $S_m(t)$ and $S_T(t)$ are manufactured source terms chosen to make prescribed functions $d(t)$ and $T_d(t)$ exact solutions of the ODEs.\n\nUse standard correlations for mass and heat transfer around a sphere:\n- Reynolds number: $$Re = \\frac{\\rho_g u_{rel} d}{\\mu_g},$$\n- Schmidt number: $$Sc = \\frac{\\mu_g}{\\rho_g D_v},$$\n- Prandtl number: $$Pr = \\frac{\\mu_g c_{p,g}}{k_g},$$\n- Sherwood number: $$Sh = 2 + 0.6 Re^{1/2} Sc^{1/3},$$\n- Nusselt number: $$Nu = 2 + 0.6 Re^{1/2} Pr^{1/3},$$\n- Mass transfer coefficient: $$k_m = \\frac{Sh D_v}{d},$$\n- Heat transfer coefficient: $$h = \\frac{Nu k_g}{d}.$$\n\nAssume a vapor mass fraction at the droplet surface determined by an equilibrium saturation pressure using the integrated Clausius–Clapeyron relation with constant latent heat:\n- Vapor specific gas constant: $$R_v = \\frac{R_u}{M_v},$$\n- Saturation pressure: $$p_{sat}(T_d) = p_{ref} \\exp\\left(-\\frac{L_v}{R_v}\\left(\\frac{1}{T_d} - \\frac{1}{T_{ref}}\\right)\\right),$$\nwith prescribed reference values $p_{ref}$ and $T_{ref}$,\n- Surface vapor mass fraction: $$Y_{v,s}(T_d) = \\frac{M_v p_{sat}(T_d)}{M_v p_{sat}(T_d) + M_{air} \\left(p - p_{sat}(T_d)\\right)}.$$\nThe evaporation rate is modeled as a convective mass transfer flux:\n$$\\dot{m}_e = k_m A \\rho_g \\left(Y_{v,s}(T_d) - Y_{v,\\infty}\\right).$$\n\nManufactured solutions and sources. Prescribe the diameter and droplet temperature as manufactured solutions:\n- Diameter: $$d(t) = d_0 \\sqrt{1 - \\alpha t}, \\quad \\text{for } 0 \\le t < \\frac{1}{\\alpha},$$\n- Droplet temperature: $$T_d(t) = T_{mean} + \\gamma \\sin(\\omega t).$$\nDefine the droplet mass using the geometric relation $m(t) = \\rho_\\ell \\frac{\\pi}{6} d(t)^3$. Using these manufactured $d(t)$ and $T_d(t)$, enforce exactness by defining source terms $S_m(t)$ and $S_T(t)$ as functions of time only such that the above ODEs are satisfied identically by the manufactured solutions. Derive $S_m(t)$ and $S_T(t)$ starting from the fundamental balances:\n- Compute $\\frac{dm}{dt}$ from $m(t)$ and $d(t)$,\n- Compute $\\frac{dT_d}{dt}$ from $T_d(t)$,\n- Evaluate $\\dot{m}_e(t)$ and $h(t)$ using the manufactured $d(t)$ and $T_d(t)$ in the correlations,\n- Solve the balances for $S_m(t)$ and $S_T(t)$, respectively.\n\nNumerical verification. Implement a second-order explicit Runge–Kutta scheme (also known as the midpoint method) to numerically integrate the ODE system with the time-dependent sources $S_m(t)$ and $S_T(t)$:\n- The ODE system to integrate numerically is:\n$$\\frac{dm}{dt} = -\\dot{m}_e(m,T_d,u_{rel}) + S_m(t),$$\n$$\\frac{dT_d}{dt} = \\frac{h(m,u_{rel}) A(m) (T_g - T_d) - \\dot{m}_e(m,T_d,u_{rel}) L_v + S_T(t)}{m c_{p,\\ell}},$$\nwhere $A(m) = \\pi d(m)^2$ and $d(m) = \\left(\\frac{6 m}{\\pi \\rho_\\ell}\\right)^{1/3}$, and $\\dot{m}_e$ and $h$ use the correlations with the instantaneous numerical $d$ and $T_d$.\n\nCompute the discrete time histories $d_{num}(t_i)$ and $T_{num}(t_i)$ from the numerical $m(t_i)$ and $T_d(t_i)$ and compare against the exact manufactured $d(t_i)$ and $T_d(t_i)$ evaluated at the same time grid. For each test case, report two dimensionless measures of accuracy:\n- The relative discrete $L^2$ error in diameter,\n$$\\varepsilon_d = \\sqrt{\\frac{\\sum_{i=1}^{N} \\left(d_{num}(t_i) - d(t_i)\\right)^2}{\\sum_{i=1}^{N} d(t_i)^2}},$$\n- The relative discrete $L^2$ error in droplet temperature,\n$$\\varepsilon_T = \\sqrt{\\frac{\\sum_{i=1}^{N} \\left(T_{num}(t_i) - T_d(t_i)\\right)^2}{\\sum_{i=1}^{N} T_d(t_i)^2}}.$$\nThese errors are dimensionless floats.\n\nParameter values. Use the following physically realistic constants (all in International System of Units (SI)):\n- $\\rho_\\ell = 1000 \\,\\mathrm{kg/m^3}$, $c_{p,\\ell} = 4180 \\,\\mathrm{J/(kg\\cdot K)}$, $L_v = 2.26\\times 10^6 \\,\\mathrm{J/kg}$,\n- $\\rho_g = 1.2 \\,\\mathrm{kg/m^3}$, $\\mu_g = 1.8\\times 10^{-5} \\,\\mathrm{Pa\\cdot s}$, $k_g = 0.026 \\,\\mathrm{W/(m\\cdot K)}$, $c_{p,g} = 1005 \\,\\mathrm{J/(kg\\cdot K)}$,\n- $D_v = 2.5\\times 10^{-5} \\,\\mathrm{m^2/s}$, $R_u = 8.314462618 \\,\\mathrm{J/(mol\\cdot K)}$, $M_v = 18.01528\\times 10^{-3} \\,\\mathrm{kg/mol}$, $M_{air} = 28.97\\times 10^{-3} \\,\\mathrm{kg/mol}$,\n- $p = 101325 \\,\\mathrm{Pa}$, $T_g = 800 \\,\\mathrm{K}$, $Y_{v,\\infty} = 0.01$,\n- Clausius–Clapeyron reference: $p_{ref} = 611 \\,\\mathrm{Pa}$ at $T_{ref} = 273.15 \\,\\mathrm{K}$.\n\nManufactured solution parameters:\n- $d_0 = 100\\times 10^{-6} \\,\\mathrm{m}$, $\\alpha = 20 \\,\\mathrm{s^{-1}}$,\n- $T_{mean} = 300 \\,\\mathrm{K}$, $\\gamma = 10 \\,\\mathrm{K}$, $\\omega = 50 \\,\\mathrm{s^{-1}}$.\n\nInitial conditions for numerical integration are $m(0)$ and $T_d(0)$ taken from the manufactured solution at $t=0$.\n\nTest suite. Use three distinct parameter sets to test solver accuracy:\n- Case 1 (happy path): $u_{rel} = 1.0 \\,\\mathrm{m/s}$, time step $\\Delta t = 1.0\\times 10^{-4} \\,\\mathrm{s}$, final time $T_{end} = 0.02 \\,\\mathrm{s}$,\n- Case 2 (boundary, low convection): $u_{rel} = 0.0 \\,\\mathrm{m/s}$, time step $\\Delta t = 5.0\\times 10^{-5} \\,\\mathrm{s}$, final time $T_{end} = 0.02 \\,\\mathrm{s}$,\n- Case 3 (edge, coarse time step): $u_{rel} = 1.0 \\,\\mathrm{m/s}$, time step $\\Delta t = 1.0\\times 10^{-3} \\,\\mathrm{s}$, final time $T_{end} = 0.02 \\,\\mathrm{s}$.\n\nYour tasks:\n1. Derive explicit formulas for $S_m(t)$ and $S_T(t)$ that make the prescribed $d(t)$ and $T_d(t)$ exact manufactured solutions to the ODEs.\n2. Implement a program that:\n   - Constructs $S_m(t)$ and $S_T(t)$ as time-dependent functions using the prescribed manufactured solution and the given physical correlations,\n   - Integrates the ODEs using a second-order explicit Runge–Kutta method for each test case,\n   - Computes the relative discrete $L^2$ errors $\\varepsilon_d$ and $\\varepsilon_T$ for each case.\n3. Express the errors as dimensionless floats.\n\nFinal output format. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order:\n$$[\\varepsilon_{d,1}, \\varepsilon_{T,1}, \\varepsilon_{d,2}, \\varepsilon_{T,2}, \\varepsilon_{d,3}, \\varepsilon_{T,3}].$$",
            "solution": "The user has provided a problem that requires the application of the Method of Manufactured Solutions (MMS) to verify a numerical solver for a system of ordinary differential equations (ODEs) describing the evaporation of a spray droplet. The process involves two main stages: first, deriving the analytical source terms required by MMS, and second, implementing a numerical solver to integrate the ODEs with these source terms and compute the error against the known manufactured solution.\n\n### Part 1: Derivation of Manufactured Source Terms\n\nThe goal is to find the source terms, $S_m(t)$ and $S_T(t)$, that make the prescribed manufactured solutions, $d(t)$ and $T_d(t)$, exact solutions to the governing ODEs.\n\nThe governing ODEs are:\n1.  Mass balance: $\\frac{dm}{dt} = -\\dot{m}_e + S_m(t)$\n2.  Energy balance: $m c_{p,\\ell} \\frac{dT_d}{dt} = h A (T_g - T_d) - \\dot{m}_e L_v + S_T(t)$\n\nWe can rearrange these to solve for the source terms:\n$$S_m(t) = \\frac{dm}{dt} + \\dot{m}_e(t)$$\n$$S_T(t) = m(t) c_{p,\\ell} \\frac{dT_d}{dt} - h(t) A(t) (T_g - T_d(t)) + \\dot{m}_e(t) L_v$$\nTo evaluate these expressions, every term on the right-hand side must be expressed as a function of time, $t$, by substituting the manufactured solutions.\n\n**Manufactured Solutions:**\n-   Diameter: $d(t) = d_0 \\sqrt{1 - \\alpha t}$\n-   Temperature: $T_d(t) = T_{mean} + \\gamma \\sin(\\omega t)$\n\n**Step 1.1: Time Derivatives of Manufactured Solutions**\nThe droplet mass is related to the diameter by $m(t) = \\rho_\\ell \\frac{\\pi}{6} d(t)^3$.\nFirst, we find the time derivative of the diameter, $\\frac{dd}{dt}$:\n$$\\frac{dd}{dt} = \\frac{d}{dt}\\left(d_0 (1 - \\alpha t)^{1/2}\\right) = d_0 \\left(\\frac{1}{2}\\right) (1 - \\alpha t)^{-1/2} (-\\alpha) = -\\frac{\\alpha d_0}{2\\sqrt{1 - \\alpha t}}$$\nSince $d(t) = d_0 \\sqrt{1 - \\alpha t}$, we can write $\\sqrt{1 - \\alpha t} = d(t)/d_0$. Substituting this gives:\n$$\\frac{dd}{dt} = -\\frac{\\alpha d_0}{2 (d(t)/d_0)} = -\\frac{\\alpha d_0^2}{2 d(t)}$$\nUsing the chain rule, we find the time derivative of mass, $\\frac{dm}{dt}$:\n$$\\frac{dm}{dt} = \\frac{d}{dt}\\left(\\rho_\\ell \\frac{\\pi}{6} d(t)^3\\right) = \\rho_\\ell \\frac{\\pi}{6} \\cdot 3d(t)^2 \\frac{dd}{dt} = \\rho_\\ell \\frac{\\pi}{2} d(t)^2 \\left(-\\frac{\\alpha d_0^2}{2 d(t)}\\right)$$\n$$\\frac{dm}{dt}(t) = -\\frac{\\pi}{4} \\rho_\\ell \\alpha d_0^2 d(t)$$\n\nThe time derivative of the droplet temperature, $\\frac{dT_d}{dt}$, is straightforward:\n$$\\frac{dT_d}{dt}(t) = \\frac{d}{dt}\\left(T_{mean} + \\gamma \\sin(\\omega t)\\right) = \\gamma \\omega \\cos(\\omega t)$$\n\n**Step 1.2: Physical Properties based on Manufactured Solutions**\nAll physical properties must be evaluated using $d(t)$ and $T_d(t)$. Let's denote these time-dependent properties with a subscript 'man' for clarity.\n- Reynolds number: $Re_{man}(t) = \\frac{\\rho_g u_{rel} d(t)}{\\mu_g}$\n- Dimensionless numbers $Sc = \\frac{\\mu_g}{\\rho_g D_v}$ and $Pr = \\frac{\\mu_g c_{p,g}}{k_g}$ are constants.\n- Sherwood number: $Sh_{man}(t) = 2 + 0.6 Re_{man}(t)^{1/2} Sc^{1/3}$\n- Nusselt number: $Nu_{man}(t) = 2 + 0.6 Re_{man}(t)^{1/2} Pr^{1/3}$\n- Droplet surface area: $A(t) = \\pi d(t)^2$\n\nThe evaporation rate $\\dot{m}_e(t)$ is given by $\\dot{m}_e = k_m A \\rho_g (Y_{v,s} - Y_{v,\\infty})$.\n- Mass transfer coefficient: $k_{m,man}(t) = \\frac{Sh_{man}(t) D_v}{d(t)}$\n- $\\dot{m}_{e,man}(t) = \\left(\\frac{Sh_{man}(t) D_v}{d(t)}\\right) (\\pi d(t)^2) \\rho_g (Y_{v,s,man}(t) - Y_{v,\\infty})$\n$$\\dot{m}_{e,man}(t) = \\pi D_v \\rho_g d(t) Sh_{man}(t) (Y_{v,s,man}(t) - Y_{v,\\infty})$$\nwhere $Y_{v,s,man}(t)$ is the vapor mass fraction at the surface, which depends on $T_d(t)$ via the Clausius-Clapeyron relation:\n- Vapor saturation pressure: $p_{sat,man}(t) = p_{ref} \\exp\\left(-\\frac{L_v}{R_v}\\left(\\frac{1}{T_d(t)} - \\frac{1}{T_{ref}}\\right)\\right)$\n- Surface vapor mass fraction: $Y_{v,s,man}(t) = \\frac{M_v p_{sat,man}(t)}{M_v p_{sat,man}(t) + M_{air} (p - p_{sat,man}(t))}$\n\nThe heat transfer term $h(t)A(t)$ is similarly evaluated:\n- Heat transfer coefficient: $h_{man}(t) = \\frac{Nu_{man}(t) k_g}{d(t)}$\n- Heat transfer term: $(hA)_{man}(t) = \\left(\\frac{Nu_{man}(t) k_g}{d(t)}\\right)(\\pi d(t)^2) = \\pi k_g d(t) Nu_{man}(t)$\n\n**Step 1.3: Final Expressions for Source Terms**\nSubstituting these time-dependent expressions into the equations for $S_m(t)$ and $S_T(t)$:\n$$S_m(t) = -\\frac{\\pi}{4} \\rho_\\ell \\alpha d_0^2 d(t) + \\dot{m}_{e,man}(t)$$\n$$S_T(t) = \\left(\\rho_\\ell \\frac{\\pi}{6} d(t)^3\\right) c_{p,\\ell} (\\gamma \\omega \\cos(\\omega t)) - (hA)_{man}(t) (T_g - T_d(t)) + \\dot{m}_{e,man}(t) L_v$$\n\nThese equations provide the explicit, time-dependent source terms needed for the MMS verification.\n\n### Part 2: Numerical Integration and Error Analysis\n\nThe task is to integrate the original ODE system numerically using the second-order explicit Runge-Kutta (midpoint) method. The state vector is $\\mathbf{y} = [m, T_d]^T$. The system is $\\frac{d\\mathbf{y}}{dt} = \\mathbf{f}(t, \\mathbf{y})$.\n\n**Step 2.1: The ODE System for Numerical Integration**\nThe function $\\mathbf{f}(t, \\mathbf{y})$ represents the right-hand side of the ODEs:\n$$\\mathbf{f}(t, \\mathbf{y}) = \\begin{bmatrix} f_m(t, m, T_d) \\\\ f_T(t, m, T_d) \\end{bmatrix}$$\nwhere:\n$$f_m(t, m, T_d) = -\\dot{m}_e(m, T_d) + S_m(t)$$\n$$f_T(t, m, T_d) = \\frac{h(m) A(m) (T_g - T_d) - \\dot{m}_e(m, T_d) L_v + S_T(t)}{m c_{p,\\ell}}$$\nHere, the physical terms $\\dot{m}_e$ and $hA$ are calculated using the *current numerical state* $(m, T_d)$ at each stage of the integration, while the source terms $S_m(t)$ and $S_T(t)$ are evaluated using the *analytical manufactured solutions* at the corresponding time $t$.\n\n**Step 2.2: The Midpoint Method (RK2)**\nFor a time step $\\Delta t$, the state at $t_{i+1} = t_i + \\Delta t$ is advanced from the state $\\mathbf{y}_i$ at $t_i$ as follows:\n1.  Compute the slope at the beginning of the interval:\n    $$\\mathbf{k}_1 = \\mathbf{f}(t_i, \\mathbf{y}_i)$$\n2.  Estimate the state at the midpoint of the interval:\n    $$\\mathbf{y}_{mid} = \\mathbf{y}_i + \\frac{\\Delta t}{2} \\mathbf{k}_1$$\n3.  Compute the slope at the midpoint:\n    $$\\mathbf{k}_2 = \\mathbf{f}(t_i + \\frac{\\Delta t}{2}, \\mathbf{y}_{mid})$$\n4.  Advance the solution to the next time step:\n    $$\\mathbf{y}_{i+1} = \\mathbf{y}_i + \\Delta t \\mathbf{k}_2$$\n\n**Step 2.3: Implementation and Error Calculation**\nThe numerical procedure is as follows:\n1.  Initialize the numerical solution at $t=0$ using the manufactured solution: $m_{num}(0) = m(0)$ and $T_{d,num}(0) = T_d(0)$.\n2.  Create a time grid $t_i = i\\Delta t$ for $i=0, 1, \\ldots, N$, where $N=T_{end}/\\Delta t$.\n3.  Iterate from $i=0$ to $N-1$, applying the RK2 method at each step to find $\\mathbf{y}_{i+1}$ from $\\mathbf{y}_i$.\n4.  Store the numerical results $d_{num}(t_i)$ and $T_{d,num}(t_i)$, where $d_{num}$ is derived from $m_{num}$ using $d = (6m/(\\pi\\rho_\\ell))^{1/3}$.\n5.  Also, compute and store the exact values $d(t_i)$ and $T_d(t_i)$ on the same grid.\n6.  Finally, compute the relative discrete $L^2$ errors, $\\varepsilon_d$ and $\\varepsilon_T$, using the specified formulas over the time points $t_1, \\ldots, t_N$.\n\nThis process will be repeated for each of the three test cases, which vary in $u_{rel}$ and $\\Delta t$, to assess the accuracy of the numerical scheme under different conditions. The expected behavior for a second-order scheme is that the error decreases quadratically with the time step $\\Delta t$. Comparing Case 1 ($\\Delta t = 10^{-4}$) and Case 3 ($\\Delta t = 10^{-3}$, a 10x larger step), we expect the errors in Case 3 to be roughly $10^2 = 100$ times larger than in Case 1.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the droplet evaporation MMS problem, calculates errors for three test cases,\n    and prints the results in the specified format.\n    \"\"\"\n\n    class Params:\n        # Liquid properties (water)\n        rho_l = 1000.0  # kg/m^3\n        c_p_l = 4180.0  # J/(kg.K)\n        L_v = 2.26e6   # J/kg\n\n        # Gas properties (air)\n        rho_g = 1.2      # kg/m^3\n        mu_g = 1.8e-5    # Pa.s\n        k_g = 0.026      # W/(m.K)\n        c_p_g = 1005.0   # J/(kg.K)\n\n        # Mass transfer properties\n        D_v = 2.5e-5     # m^2/s\n        R_u = 8.314462618 # J/(mol.K)\n        M_v = 18.01528e-3 # kg/mol (water)\n        M_air = 28.97e-3  # kg/mol\n\n        # Ambient conditions\n        p_inf = 101325.0 # Pa\n        T_g = 800.0      # K\n        Y_v_inf = 0.01   # kg/kg\n\n        # Clausius-Clapeyron reference\n        p_ref = 611.0    # Pa\n        T_ref = 273.15   # K\n\n        # Manufactured solution parameters\n        d0 = 100.0e-6    # m\n        alpha = 20.0     # 1/s\n        T_mean = 300.0   # K\n        gamma = 10.0     # K\n        omega = 50.0     # 1/s\n\n        # Calculated constants\n        R_v = R_u / M_v\n        Sc = mu_g / (rho_g * D_v)\n        Pr = mu_g * c_p_g / k_g\n\n    p = Params()\n\n    # --- Manufactured Solutions and their Derivatives ---\n    def d_man(t):\n        val = 1.0 - p.alpha * t\n        if val < 0: return 0.0\n        return p.d0 * np.sqrt(val)\n\n    def Td_man(t):\n        return p.T_mean + p.gamma * np.sin(p.omega * t)\n\n    def m_man(t):\n        return p.rho_l * np.pi / 6.0 * d_man(t)**3\n\n    def dmdt_man(t):\n        return - (np.pi / 4.0) * p.rho_l * p.alpha * p.d0**2 * d_man(t)\n\n    def dTd_dt_man(t):\n        return p.gamma * p.omega * np.cos(p.omega * t)\n\n    # --- Core Physics Calculation ---\n    def calc_phys_props(d_val, Td_val, u_rel):\n        if d_val <= 0:\n            return 0.0, 0.0\n\n        # Reynolds number\n        Re = p.rho_g * u_rel * d_val / p.mu_g\n\n        # Sherwood and Nusselt numbers\n        Sh = 2.0 + 0.6 * np.sqrt(Re) * p.Sc**(1/3)\n        Nu = 2.0 + 0.6 * np.sqrt(Re) * p.Pr**(1/3)\n\n        # Vapor saturation pressure\n        p_sat = p.p_ref * np.exp(-(p.L_v / p.R_v) * (1.0 / Td_val - 1.0 / p.T_ref))\n\n        # Surface vapor mass fraction\n        Y_v_s_num = p.M_v * p_sat\n        Y_v_s_den = Y_v_s_num + p.M_air * (p.p_inf - p_sat)\n        Y_v_s = Y_v_s_num / Y_v_s_den if Y_v_s_den != 0 else 0\n\n        # Evaporation rate\n        m_dot_e = np.pi * p.D_v * p.rho_g * d_val * Sh * (Y_v_s - p.Y_v_inf)\n        \n        # Heat transfer term h*A\n        hA = np.pi * p.k_g * d_val * Nu\n\n        return m_dot_e, hA\n\n    # --- Manufactured Source Terms ---\n    def S_m(t, u_rel):\n        d_val = d_man(t)\n        if d_val <= 0: return 0.0\n        \n        m_dot_e_man, _ = calc_phys_props(d_val, Td_man(t), u_rel)\n        return dmdt_man(t) + m_dot_e_man\n\n    def S_T(t, u_rel):\n        d_val = d_man(t)\n        if d_val <= 0: return 0.0\n        \n        Td_val = Td_man(t)\n        m_val = m_man(t)\n        \n        m_dot_e_man, hA_man = calc_phys_props(d_val, Td_val, u_rel)\n        \n        term1 = m_val * p.c_p_l * dTd_dt_man(t)\n        term2 = hA_man * (p.T_g - Td_val)\n        term3 = m_dot_e_man * p.L_v\n        \n        return term1 - term2 + term3\n\n    # --- ODE System RHS ---\n    def ode_rhs(t, y, u_rel):\n        m_num, Td_num = y\n        \n        if m_num <= 0:\n            return np.array([0.0, 0.0])\n        \n        d_num = (6.0 * m_num / (np.pi * p.rho_l))**(1/3)\n        \n        m_dot_e_num, hA_num = calc_phys_props(d_num, Td_num, u_rel)\n        \n        dmdt = -m_dot_e_num + S_m(t, u_rel)\n        dTd_dt = (hA_num * (p.T_g - Td_num) - m_dot_e_num * p.L_v + S_T(t, u_rel)) / (m_num * p.c_p_l)\n        \n        return np.array([dmdt, dTd_dt])\n\n    # --- Main Loop for a Single Test Case ---\n    def run_case(u_rel, dt, T_end):\n        num_steps = int(round(T_end / dt))\n        times = np.linspace(0, T_end, num_steps + 1)\n        \n        # Initialize arrays for numerical and exact solutions\n        y_num = np.zeros((num_steps + 1, 2))\n        d_num = np.zeros(num_steps + 1)\n        \n        d_exact = np.zeros(num_steps + 1)\n        Td_exact = np.zeros(num_steps + 1)\n        \n        # Initial conditions from manufactured solution\n        y_num[0, 0] = m_man(0.0)\n        y_num[0, 1] = Td_man(0.0)\n        \n        # RK2 (Midpoint method) integration loop\n        for i in range(num_steps):\n            t_i = times[i]\n            y_i = y_num[i]\n            \n            k1 = ode_rhs(t_i, y_i, u_rel)\n            y_mid = y_i + 0.5 * dt * k1\n            k2 = ode_rhs(t_i + 0.5 * dt, y_mid, u_rel)\n            \n            y_num[i+1] = y_i + dt * k2\n\n        # Post-process to get all diameter and temperature histories\n        for i in range(num_steps + 1):\n            m_i = y_num[i, 0]\n            d_num[i] = (6.0 * m_i / (np.pi * p.rho_l))**(1/3) if m_i > 0 else 0\n            d_exact[i] = d_man(times[i])\n            Td_exact[i] = Td_man(times[i])\n        \n        Td_num = y_num[:, 1]\n        \n        # Calculate L2 relative errors (excluding the initial point at t=0)\n        d_err_sq_sum = np.sum((d_num[1:] - d_exact[1:])**2)\n        d_exact_sq_sum = np.sum(d_exact[1:]**2)\n        eps_d = np.sqrt(d_err_sq_sum / d_exact_sq_sum) if d_exact_sq_sum > 0 else 0\n\n        T_err_sq_sum = np.sum((Td_num[1:] - Td_exact[1:])**2)\n        T_exact_sq_sum = np.sum(Td_exact[1:]**2)\n        eps_T = np.sqrt(T_err_sq_sum / T_exact_sq_sum) if T_exact_sq_sum > 0 else 0\n\n        return eps_d, eps_T\n\n    test_cases = [\n        {'u_rel': 1.0, 'dt': 1.0e-4, 'T_end': 0.02}, # Case 1\n        {'u_rel': 0.0, 'dt': 5.0e-5, 'T_end': 0.02}, # Case 2\n        {'u_rel': 1.0, 'dt': 1.0e-3, 'T_end': 0.02}, # Case 3\n    ]\n\n    results = []\n    for case in test_cases:\n        eps_d, eps_T = run_case(case['u_rel'], case['dt'], case['T_end'])\n        results.extend([eps_d, eps_T])\n\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "The Lagrangian parcel method approximates a continuous spray with a finite number of discrete parcels, which inherently introduces statistical sampling error into the simulation. This exercise demonstrates how to quantify this uncertainty and determine the number of parcels required to achieve a desired level of accuracy in the computed source terms . Through this practice, you will explore the fundamental trade-off between computational cost and statistical convergence, a central challenge in all particle-based simulation methods.",
            "id": "3364885",
            "problem": "A single Computational Fluid Dynamics (CFD) cell receives a vapor mass source during a time step due to evaporation of injected liquid represented by Lagrangian parcels. The liquid injection rate is $\\dot{m}_{\\ell} = 5.0 \\times 10^{-4}\\,\\mathrm{kg}\\,\\mathrm{s}^{-1}$ and the time step is $\\Delta t = 5.0 \\times 10^{-3}\\,\\mathrm{s}$. In one time step, $N$ parcels are injected and each parcel carries equal liquid mass $m_{p} = \\dot{m}_{\\ell}\\,\\Delta t / N$. For a given cell, the evaporated fraction of each parcel’s liquid mass inside the cell over the time step is modeled by independent and identically distributed random variables $X_{i}$ with mean $\\mu_{f} = 0.70$ and standard deviation $\\sigma_{f} = 0.21$, independent of $m_{p}$. The estimated vapor mass source added to the cell in one time step is the sum of evaporated masses $\\sum_{i=1}^{N} m_{p} X_{i}$, divided by the cell volume, but for the purpose of stochastic accuracy, only the relative variability of the source estimate matters.\n\nDefine the coefficient of variation $\\epsilon$ of the estimated source in a single time step to be the ratio of the standard deviation to the mean of the estimator. Starting from the fundamental definitions of the mean and variance of the sum of independent and identically distributed random variables, and the definition of coefficient of variation, derive an expression for $\\epsilon$ as a function of $N$, $\\mu_{f}$, and $\\sigma_{f}$. Using this relationship, determine the number of parcels per time step required to achieve a target coefficient of variation $\\epsilon = 3.0 \\times 10^{-2}$. Additionally, a preliminary run using $N_{\\text{ref}} = 25$ parcels per time step yielded a coefficient of variation consistent with the given $X_{i}$ statistics. Use the preliminary run to cross-check your result via a reference-scaling argument.\n\nExpress the final answer as a single integer value for $N$ (dimensionless). No rounding is required beyond exact evaluation.",
            "solution": "The problem requires the determination of the number of Lagrangian parcels, $N$, needed to achieve a specified level of statistical accuracy in a CFD simulation of spray evaporation. The accuracy is quantified by the coefficient of variation, $\\epsilon$, of the estimated vapor mass source in a cell.\n\nFirst, we must validate the problem statement.\nStep 1: Extract Givens.\n- Liquid injection rate: $\\dot{m}_{\\ell} = 5.0 \\times 10^{-4}\\,\\mathrm{kg}\\,\\mathrm{s}^{-1}$\n- Time step: $\\Delta t = 5.0 \\times 10^{-3}\\,\\mathrm{s}$\n- Number of injected parcels per time step: $N$\n- Mass of a single parcel: $m_{p} = \\dot{m}_{\\ell}\\,\\Delta t / N$\n- Evaporated fraction of a parcel's mass: $X_{i}$, where $i$ ranges from $1$ to $N$. These are independent and identically distributed (i.i.d.) random variables.\n- Mean of the evaporated fraction: $\\mu_{f} = 0.70$\n- Standard deviation of the evaporated fraction: $\\sigma_{f} = 0.21$\n- Target coefficient of variation: $\\epsilon = 3.0 \\times 10^{-2}$\n- Reference number of parcels: $N_{\\text{ref}} = 25$\n\nStep 2: Validate Using Extracted Givens.\nThe problem is scientifically grounded, employing standard concepts from statistical mechanics and computational fluid dynamics (CFD), specifically Lagrangian parcel tracking and stochastic source term modeling. It is well-posed, providing all necessary information to derive a unique solution. The parameters are physically plausible for a spray evaporation scenario. The problem is objective and uses precise terminology. There are no internal contradictions, ambiguities, or violations of scientific principles.\n\nStep 3: Verdict and Action.\nThe problem is valid. We proceed with the solution.\n\nThe total mass of liquid evaporated within the cell during one time step, $\\Delta t$, is the sum of the evaporated masses from each of the $N$ parcels present in the cell. This total evaporated mass, let's call it $M_{evap}$, is a random variable given by:\n$$M_{evap} = \\sum_{i=1}^{N} m_{p} X_{i}$$\nThe problem states that the estimated vapor mass source for the cell is proportional to this quantity (specifically, $M_{evap}$ divided by the cell volume). The coefficient of variation, $\\epsilon$, is defined as the ratio of the standard deviation of this estimator to its mean. Since the cell volume is a constant, it will cancel out from this ratio. Therefore, we can define $\\epsilon$ directly in terms of $M_{evap}$:\n$$\\epsilon = \\frac{\\sqrt{Var(M_{evap})}}{E[M_{evap}]}$$\nHere, $E[\\cdot]$ denotes the expected value (mean) and $Var(\\cdot)$ denotes the variance.\n\nFirst, we compute the mean of $M_{evap}$. Using the linearity of expectation:\n$$E[M_{evap}] = E\\left[\\sum_{i=1}^{N} m_{p} X_{i}\\right]$$\nSince $m_{p}$ is a constant for a given $N$, it can be factored out of the expectation:\n$$E[M_{evap}] = \\sum_{i=1}^{N} E[m_{p} X_{i}] = \\sum_{i=1}^{N} m_{p} E[X_{i}]$$\nThe random variables $X_i$ are identically distributed with mean $\\mu_f$. Thus, $E[X_i] = \\mu_f$ for all $i$.\n$$E[M_{evap}] = \\sum_{i=1}^{N} m_{p} \\mu_{f} = N m_{p} \\mu_{f}$$\n\nNext, we compute the variance of $M_{evap}$. Since the random variables $X_i$ are independent, the variance of their sum is the sum of their variances:\n$$Var(M_{evap}) = Var\\left(\\sum_{i=1}^{N} m_{p} X_{i}\\right) = \\sum_{i=1}^{N} Var(m_{p} X_{i})$$\nUsing the property $Var(aY) = a^2 Var(Y)$ for a constant $a$ and random variable $Y$, we have:\n$$Var(M_{evap}) = \\sum_{i=1}^{N} m_{p}^2 Var(X_{i})$$\nThe random variables $X_i$ are identically distributed with standard deviation $\\sigma_f$, so their variance is $Var(X_i) = \\sigma_{f}^2$.\n$$Var(M_{evap}) = \\sum_{i=1}^{N} m_{p}^2 \\sigma_{f}^2 = N m_{p}^2 \\sigma_{f}^2$$\n\nThe standard deviation of $M_{evap}$ is the square root of its variance:\n$$\\sqrt{Var(M_{evap})} = \\sqrt{N m_{p}^2 \\sigma_{f}^2} = m_{p} \\sigma_{f} \\sqrt{N}$$\n\nNow we can derive the expression for the coefficient of variation, $\\epsilon$:\n$$\\epsilon = \\frac{\\sqrt{Var(M_{evap})}}{E[M_{evap}]} = \\frac{m_{p} \\sigma_{f} \\sqrt{N}}{N m_{p} \\mu_{f}}$$\nThe parcel mass $m_p$ cancels out, which is expected as $\\epsilon$ is a measure of relative variability.\n$$\\epsilon = \\frac{\\sigma_{f} \\sqrt{N}}{N \\mu_{f}} = \\frac{\\sigma_{f}}{\\mu_{f} \\sqrt{N}}$$\nThis is the desired relationship between $\\epsilon$, $N$, $\\mu_f$, and $\\sigma_f$.\n\nTo find the number of parcels $N$ required to achieve a target coefficient of variation $\\epsilon$, we rearrange the equation:\n$$\\sqrt{N} = \\frac{\\sigma_{f}}{\\mu_{f} \\epsilon}$$\n$$N = \\left(\\frac{\\sigma_{f}}{\\mu_{f} \\epsilon}\\right)^2$$\nWe are given the values $\\mu_f = 0.70$, $\\sigma_f = 0.21$, and the target $\\epsilon = 3.0 \\times 10^{-2}$. Substituting these values:\n$$N = \\left(\\frac{0.21}{0.70 \\times (3.0 \\times 10^{-2})}\\right)^2$$\n$$N = \\left(\\frac{0.21}{0.70 \\times 0.03}\\right)^2 = \\left(\\frac{0.21}{0.021}\\right)^2 = (10)^2 = 100$$\nSo, $100$ parcels per time step are required.\n\nFinally, we perform the cross-check using the reference-scaling argument. The derived relationship $\\epsilon = \\frac{\\sigma_f / \\mu_f}{\\sqrt{N}}$ implies that $\\epsilon \\propto 1/\\sqrt{N}$. Therefore, for two different runs with $(N_1, \\epsilon_1)$ and $(N_2, \\epsilon_2)$, the following scaling law holds:\n$$\\epsilon_1 \\sqrt{N_1} = \\epsilon_2 \\sqrt{N_2}$$\nLet the reference run be state $1$, with $N_1 = N_{\\text{ref}} = 25$. The coefficient of variation for this run, $\\epsilon_{\\text{ref}}$, is:\n$$\\epsilon_{\\text{ref}} = \\frac{\\sigma_{f}}{\\mu_{f} \\sqrt{N_{\\text{ref}}}} = \\frac{0.21}{0.70 \\sqrt{25}} = \\frac{0.3}{5} = 0.06$$\nLet the target run be state $2$, with $\\epsilon_2 = \\epsilon = 0.03 = 3.0 \\times 10^{-2}$. We need to find $N_2 = N$.\nUsing the scaling law:\n$$N = N_2 = N_1 \\left(\\frac{\\epsilon_1}{\\epsilon_2}\\right)^2 = N_{\\text{ref}} \\left(\\frac{\\epsilon_{\\text{ref}}}{\\epsilon}\\right)^2$$\n$$N = 25 \\left(\\frac{0.06}{0.03}\\right)^2 = 25 \\times (2)^2 = 25 \\times 4 = 100$$\nThe cross-check confirms the result obtained from the direct calculation. The required number of parcels per time step is $100$.",
            "answer": "$$\\boxed{100}$$"
        },
        {
            "introduction": "A crucial step in spray simulation is the accurate transfer of mass, momentum, and energy from the discrete Lagrangian parcels to the continuous Eulerian gas-phase grid. This practice addresses the common scenario where a fast-moving parcel traverses multiple grid cells within a single time step, posing a challenge to numerical conservation . You will learn how to properly partition a parcel's source contributions among the cells it visits, ensuring that the fundamental principles of conservation are precisely maintained in the coupling scheme.",
            "id": "3364858",
            "problem": "A single Lagrangian spray parcel in a one-dimensional Computational Fluid Dynamics (CFD) domain crosses multiple Eulerian cells during one global time step. Local conservation of mass and energy in each finite-volume cell demands that the Eulerian source terms due to parcel evaporation and heat exchange equal the temporally accumulated parcel exchanges while the parcel resides inside that cell. The domain is partitioned into three adjacent cells with interfaces at positions $x = 0$, $x = 2.0 \\times 10^{-3}\\ \\text{m}$, $x = 5.0 \\times 10^{-3}\\ \\text{m}$, and $x = 9.0 \\times 10^{-3}\\ \\text{m}$. A Lagrangian parcel initially at position $x(0) = 1.0 \\times 10^{-3}\\ \\text{m}$ moves at constant speed $u_{p} = 2.0\\ \\text{m/s}$ for a single Eulerian time step of duration $\\Delta t = 4.0 \\times 10^{-3}\\ \\text{s}$. Thus, the parcel sequentially traverses cell $1$, cell $2$, and cell $3$ within the time interval $t \\in [0,\\Delta t]$.\n\nThe parcel’s evaporation mass-loss rate (from liquid to gas) is a prescribed function of time $t$ during this step, given by $\\dot{m}_{e}(t) = \\alpha + \\beta t$ with $\\alpha = 8.0 \\times 10^{-7}\\ \\text{kg/s}$ and $\\beta = 1.0 \\times 10^{-4}\\ \\text{kg/s}^2$. The parcel’s net enthalpy transfer rate to the gas phase (including sensible and latent effects lumped together as a single net heat transfer from the parcel to the gas) is $\\dot{Q}(t) = \\eta - \\zeta t$ with $\\eta = 1.25\\ \\text{W}$ and $\\zeta = 50.0\\ \\text{W/s}$. Assume the gas flow is quiescent relative to the parcel motion for the purposes of residence-time calculation, and neglect any feedback of the Eulerian fields on $\\dot{m}_{e}(t)$ and $\\dot{Q}(t)$ within this time step.\n\nUsing conservation of mass and energy and kinematic residence times implied by $x(t) = x(0) + u_{p} t$, determine for each cell the fraction of the total evaporated mass and the fraction of the total transferred enthalpy that must be assigned to that cell so that the sum across the traversed cells matches exactly the parcel’s total exchanges over $[0,\\Delta t]$. Provide the six dimensionless fractions in the order $\\left(f_{1}^{(m)}, f_{2}^{(m)}, f_{3}^{(m)}, f_{1}^{(Q)}, f_{2}^{(Q)}, f_{3}^{(Q)}\\right)$, where $f_{i}^{(m)}$ are the mass fractions and $f_{i}^{(Q)}$ are the enthalpy fractions for cells $i = 1,2,3$.\n\nRound each fraction to six significant figures. Express your answer as a single row matrix. The fractions are dimensionless; do not include units in the final numerical values.",
            "solution": "The appropriate fundamental bases are the conservation of mass and the first law of thermodynamics (energy conservation) applied to each finite-volume cell over a time interval, together with kinematics for parcel motion. For a Lagrangian parcel exchanging mass and energy with an Eulerian control volume, the Eulerian source terms over a time interval equal the time integrals of the parcel exchange rates while the parcel resides in that control volume. Therefore, if cell $i$ is occupied by the parcel during a time subinterval $I_{i} \\subset [0,\\Delta t]$, then the mass and enthalpy added to the gas in that cell are\n$$\n\\Delta m_{i} = \\int_{I_{i}} \\dot{m}_{e}(t)\\, dt,\\qquad \\Delta Q_{i} = \\int_{I_{i}} \\dot{Q}(t)\\, dt.\n$$\nThe total exchanges over the step are\n$$\n\\Delta m_{\\text{tot}} = \\int_{0}^{\\Delta t} \\dot{m}_{e}(t)\\, dt,\\qquad \\Delta Q_{\\text{tot}} = \\int_{0}^{\\Delta t} \\dot{Q}(t)\\, dt.\n$$\nTo enforce exact conservation, the fractions to be assigned to each cell are\n$$\nf_{i}^{(m)} = \\frac{\\Delta m_{i}}{\\Delta m_{\\text{tot}}},\\qquad f_{i}^{(Q)} = \\frac{\\Delta Q_{i}}{\\Delta Q_{\\text{tot}}}.\n$$\n\nWe first determine the residence-time subintervals from kinematics. The parcel position is $x(t) = x(0) + u_{p} t$ with $x(0) = 1.0 \\times 10^{-3}\\,\\text{m}$ and $u_p = 2.0\\,\\text{m/s}$. The times when the parcel crosses the cell interfaces are the solutions of $x(t) = 2.0 \\times 10^{-3}\\ \\text{m}$, $x(t) = 5.0 \\times 10^{-3}\\ \\text{m}$, and $x(t) = 9.0 \\times 10^{-3}\\ \\text{m}$. These are\n$$\nt_{1} = \\frac{2.0 \\times 10^{-3} - 1.0 \\times 10^{-3}}{2.0} = 5.0 \\times 10^{-4}\\ \\text{s},\\quad\nt_{2} = \\frac{5.0 \\times 10^{-3} - 1.0 \\times 10^{-3}}{2.0} = 2.0 \\times 10^{-3}\\ \\text{s},\\quad\nt_{3} = \\frac{9.0 \\times 10^{-3} - 1.0 \\times 10^{-3}}{2.0} = 4.0 \\times 10^{-3}\\ \\text{s}.\n$$\nHence the subintervals are $I_{1} = [0,\\, 5.0 \\times 10^{-4}]$, $I_{2} = [5.0 \\times 10^{-4},\\, 2.0 \\times 10^{-3}]$, and $I_{3} = [2.0 \\times 10^{-3},\\, 4.0 \\times 10^{-3}]$.\n\nNext, we evaluate the time integrals of the given rates on each subinterval. For the evaporation rate $\\dot{m}_{e}(t) = \\alpha + \\beta t$ with $\\alpha = 8.0 \\times 10^{-7}\\,\\text{kg/s}$ and $\\beta = 1.0 \\times 10^{-4}\\,\\text{kg/s}^2$, we have\n$$\n\\int_{a}^{b} (\\alpha + \\beta t)\\, dt = \\alpha (b-a) + \\frac{1}{2}\\beta\\left(b^{2} - a^{2}\\right).\n$$\nUsing $I_{1}$ with $a_{1} = 0$ and $b_{1} = 5.0 \\times 10^{-4}$,\n$$\n\\Delta m_{1} = \\alpha (5.0 \\times 10^{-4} - 0) + \\frac{1}{2}\\beta\\left((5.0 \\times 10^{-4})^{2} - 0^{2}\\right) = (8.0 \\times 10^{-7})(5.0 \\times 10^{-4}) + \\frac{1}{2}(1.0 \\times 10^{-4})(2.5 \\times 10^{-7}).\n$$\nNumerically,\n$$\n\\Delta m_{1} = 4.0 \\times 10^{-10} + 1.25 \\times 10^{-11} = 4.125 \\times 10^{-10}.\n$$\nFor $I_{2}$ with $a_{2} = 5.0 \\times 10^{-4}$ and $b_{2} = 2.0 \\times 10^{-3}$,\n$$\n\\Delta m_{2} = \\alpha (1.5 \\times 10^{-3}) + \\frac{1}{2}\\beta\\left((2.0 \\times 10^{-3})^{2} - (5.0 \\times 10^{-4})^{2}\\right) = (8.0 \\times 10^{-7})(1.5 \\times 10^{-3}) + \\frac{1}{2}(1.0 \\times 10^{-4})(3.75 \\times 10^{-6}),\n$$\nso\n$$\n\\Delta m_{2} = 1.2 \\times 10^{-9} + 1.875 \\times 10^{-10} = 1.3875 \\times 10^{-9}.\n$$\nFor $I_{3}$ with $a_{3} = 2.0 \\times 10^{-3}$ and $b_{3} = 4.0 \\times 10^{-3}$,\n$$\n\\Delta m_{3} = \\alpha (2.0 \\times 10^{-3}) + \\frac{1}{2}\\beta\\left((4.0 \\times 10^{-3})^{2} - (2.0 \\times 10^{-3})^{2}\\right) = (8.0 \\times 10^{-7})(2.0 \\times 10^{-3}) + \\frac{1}{2}(1.0 \\times 10^{-4})(12.0 \\times 10^{-6}),\n$$\ngiving\n$$\n\\Delta m_{3} = 1.6 \\times 10^{-9} + 6.0 \\times 10^{-10} = 2.2 \\times 10^{-9}.\n$$\nThe total mass transfer is\n$$\n\\Delta m_{\\text{tot}} = \\alpha \\Delta t + \\frac{1}{2}\\beta \\Delta t^{2} = (8.0 \\times 10^{-7})(4.0 \\times 10^{-3}) + \\frac{1}{2}(1.0 \\times 10^{-4})(16.0 \\times 10^{-6}) = 3.2 \\times 10^{-9} + 0.8 \\times 10^{-9} = 4.0 \\times 10^{-9}.\n$$\nTherefore, the mass fractions are\n$$\nf_{1}^{(m)} = \\frac{4.125 \\times 10^{-10}}{4.0 \\times 10^{-9}} = 0.103125,\\quad\nf_{2}^{(m)} = \\frac{1.3875 \\times 10^{-9}}{4.0 \\times 10^{-9}} = 0.346875,\\quad\nf_{3}^{(m)} = \\frac{2.2 \\times 10^{-9}}{4.0 \\times 10^{-9}} = 0.55.\n$$\n\nFor the enthalpy rate $\\dot{Q}(t) = \\eta - \\zeta t$ with $\\eta = 1.25\\,\\text{W}$ and $\\zeta = 50.0\\,\\text{W/s}$, the integral over $[a,b]$ is\n$$\n\\int_{a}^{b} (\\eta - \\zeta t)\\, dt = \\eta (b-a) - \\frac{1}{2}\\zeta\\left(b^{2} - a^{2}\\right).\n$$\nOver $I_{1}$,\n$$\n\\Delta Q_{1} = \\eta (5.0 \\times 10^{-4}) - \\frac{1}{2}\\zeta\\left((5.0 \\times 10^{-4})^{2} - 0^{2}\\right) = (1.25)(5.0 \\times 10^{-4}) - \\frac{1}{2}(50.0)(2.5 \\times 10^{-7}),\n$$\nso\n$$\n\\Delta Q_{1} = 6.25 \\times 10^{-4} - 6.25 \\times 10^{-6} = 6.1875 \\times 10^{-4}.\n$$\nOver $I_{2}$,\n$$\n\\Delta Q_{2} = \\eta (1.5 \\times 10^{-3}) - \\frac{1}{2}\\zeta\\left((2.0 \\times 10^{-3})^{2} - (5.0 \\times 10^{-4})^{2}\\right) = (1.25)(1.5 \\times 10^{-3}) - \\frac{1}{2}(50.0)(3.75 \\times 10^{-6}),\n$$\nyielding\n$$\n\\Delta Q_{2} = 1.875 \\times 10^{-3} - 9.375 \\times 10^{-5} = 1.78125 \\times 10^{-3}.\n$$\nOver $I_{3}$,\n$$\n\\Delta Q_{3} = \\eta (2.0 \\times 10^{-3}) - \\frac{1}{2}\\zeta\\left((4.0 \\times 10^{-3})^{2} - (2.0 \\times 10^{-3})^{2}\\right) = (1.25)(2.0 \\times 10^{-3}) - \\frac{1}{2}(50.0)(12.0 \\times 10^{-6}),\n$$\ngiving\n$$\n\\Delta Q_{3} = 2.5 \\times 10^{-3} - 3.0 \\times 10^{-4} = 2.2 \\times 10^{-3}.\n$$\nThe total enthalpy transfer is\n$$\n\\Delta Q_{\\text{tot}} = \\eta \\Delta t - \\frac{1}{2}\\zeta \\Delta t^{2} = (1.25)(4.0 \\times 10^{-3}) - \\frac{1}{2}(50.0)(16.0 \\times 10^{-6}) = 5.0 \\times 10^{-3} - 4.0 \\times 10^{-4} = 4.6 \\times 10^{-3}.\n$$\nTherefore, the enthalpy fractions are\n$$\nf_{1}^{(Q)} = \\frac{6.1875 \\times 10^{-4}}{4.6 \\times 10^{-3}} \\approx 0.134510869565,\\quad\nf_{2}^{(Q)} = \\frac{1.78125 \\times 10^{-3}}{4.6 \\times 10^{-3}} \\approx 0.387228260870,\\quad\nf_{3}^{(Q)} = \\frac{2.2 \\times 10^{-3}}{4.6 \\times 10^{-3}} = \\frac{11}{23} \\approx 0.478260869565.\n$$\nBy construction, $\\sum_{i=1}^{3} f_{i}^{(m)} = 1$ and $\\sum_{i=1}^{3} f_{i}^{(Q)} = 1$, satisfying conservation. Rounding each fraction to six significant figures yields\n$$\nf_{1}^{(m)} = 0.103125,\\quad f_{2}^{(m)} = 0.346875,\\quad f_{3}^{(m)} = 0.550000,\\quad f_{1}^{(Q)} = 0.134511,\\quad f_{2}^{(Q)} = 0.387228,\\quad f_{3}^{(Q)} = 0.478261.\n$$\nThe required output is the single row matrix in the specified order.",
            "answer": "$$\\boxed{\\begin{pmatrix}0.103125 & 0.346875 & 0.550000 & 0.134511 & 0.387228 & 0.478261\\end{pmatrix}}$$"
        }
    ]
}