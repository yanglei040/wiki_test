{
    "hands_on_practices": [
        {
            "introduction": "In Lagrangian-Eulerian simulations, a significant challenge arises when a parcel's trajectory crosses multiple grid cells within a single computational time step. To maintain strict conservation of mass and energy, the source terms from the parcel must be distributed accurately among the traversed cells. This exercise  demonstrates the fundamental technique of calculating cell residence times and integrating the parcel's source rates to ensure a physically consistent and conservative coupling.",
            "id": "3364858",
            "problem": "A single Lagrangian spray parcel in a one-dimensional Computational Fluid Dynamics (CFD) domain crosses multiple Eulerian cells during one global time step. Local conservation of mass and energy in each finite-volume cell demands that the Eulerian source terms due to parcel evaporation and heat exchange equal the temporally accumulated parcel exchanges while the parcel resides inside that cell. The domain is partitioned into three adjacent cells with interfaces at positions $x = 0$, $x = 2.0 \\times 10^{-3}\\ \\text{m}$, $x = 5.0 \\times 10^{-3}\\ \\text{m}$, and $x = 9.0 \\times 10^{-3}\\ \\text{m}$. A Lagrangian parcel initially at position $x(0) = 1.0 \\times 10^{-3}\\ \\text{m}$ moves at constant speed $u_{p} = 2.0\\ \\text{m}\\,\\text{s}^{-1}$ for a single Eulerian time step of duration $\\Delta t = 4.0 \\times 10^{-3}\\ \\text{s}$. Thus, the parcel sequentially traverses cell $1$, cell $2$, and cell $3$ within the time interval $t \\in [0,\\Delta t]$.\n\nThe parcel’s evaporation mass-loss rate (from liquid to gas) is a prescribed function of time $t$ during this step, given by $\\dot{m}_{e}(t) = \\alpha + \\beta t$ with $\\alpha = 8.0 \\times 10^{-7}\\ \\text{kg}\\,\\text{s}^{-1}$ and $\\beta = 1.0 \\times 10^{-4}\\ \\text{kg}\\,\\text{s}^{-2}$. The parcel’s net enthalpy transfer rate to the gas phase (including sensible and latent effects lumped together as a single net heat transfer from the parcel to the gas) is $\\dot{Q}(t) = \\eta - \\zeta t$ with $\\eta = 1.25\\ \\text{W}$ and $\\zeta = 50.0\\ \\text{W}\\,\\text{s}^{-1}$. Assume the gas flow is quiescent relative to the parcel motion for the purposes of residence-time calculation, and neglect any feedback of the Eulerian fields on $\\dot{m}_{e}(t)$ and $\\dot{Q}(t)$ within this time step.\n\nUsing conservation of mass and energy and kinematic residence times implied by $x(t) = x(0) + u_{p} t$, determine for each cell the fraction of the total evaporated mass and the fraction of the total transferred enthalpy that must be assigned to that cell so that the sum across the traversed cells matches exactly the parcel’s total exchanges over $[0,\\Delta t]$. Provide the six dimensionless fractions in the order $\\left(f_{1}^{(m)}, f_{2}^{(m)}, f_{3}^{(m)}, f_{1}^{(Q)}, f_{2}^{(Q)}, f_{3}^{(Q)}\\right)$, where $f_{i}^{(m)}$ are the mass fractions and $f_{i}^{(Q)}$ are the enthalpy fractions for cells $i = 1,2,3$.\n\nRound each fraction to six significant figures. Express your answer as a single row matrix. The fractions are dimensionless; do not include units in the final numerical values.",
            "solution": "The appropriate fundamental bases are the conservation of mass and the first law of thermodynamics (energy conservation) applied to each finite-volume cell over a time interval, together with kinematics for parcel motion. For a Lagrangian parcel exchanging mass and energy with an Eulerian control volume, the Eulerian source terms over a time interval equal the time integrals of the parcel exchange rates while the parcel resides in that control volume. Therefore, if cell $i$ is occupied by the parcel during a time subinterval $I_{i} \\subset [0,\\Delta t]$, then the mass and enthalpy added to the gas in that cell are\n$$\n\\Delta m_{i} = \\int_{I_{i}} \\dot{m}_{e}(t)\\, dt,\\qquad \\Delta Q_{i} = \\int_{I_{i}} \\dot{Q}(t)\\, dt.\n$$\nThe total exchanges over the step are\n$$\n\\Delta m_{\\text{tot}} = \\int_{0}^{\\Delta t} \\dot{m}_{e}(t)\\, dt,\\qquad \\Delta Q_{\\text{tot}} = \\int_{0}^{\\Delta t} \\dot{Q}(t)\\, dt.\n$$\nTo enforce exact conservation, the fractions to be assigned to each cell are\n$$\nf_{i}^{(m)} = \\frac{\\Delta m_{i}}{\\Delta m_{\\text{tot}}},\\qquad f_{i}^{(Q)} = \\frac{\\Delta Q_{i}}{\\Delta Q_{\\text{tot}}}.\n$$\n\nWe first determine the residence-time subintervals from kinematics. The parcel position is $x(t) = x(0) + u_{p} t$ with $x(0) = 1.0 \\times 10^{-3}\\ \\text{m}$ and $u_{p} = 2.0\\ \\text{m}\\,\\text{s}^{-1}$. The times when the parcel crosses the cell interfaces are the solutions of $x(t) = 2.0 \\times 10^{-3}\\ \\text{m}$, $x(t) = 5.0 \\times 10^{-3}\\ \\text{m}$, and $x(t) = 9.0 \\times 10^{-3}\\ \\text{m}$. These are\n$$\nt_{1} = \\frac{2.0 \\times 10^{-3} - 1.0 \\times 10^{-3}}{2.0} = 5.0 \\times 10^{-4}\\ \\text{s},\\quad\nt_{2} = \\frac{5.0 \\times 10^{-3} - 1.0 \\times 10^{-3}}{2.0} = 2.0 \\times 10^{-3}\\ \\text{s},\\quad\nt_{3} = \\frac{9.0 \\times 10^{-3} - 1.0 \\times 10^{-3}}{2.0} = 4.0 \\times 10^{-3}\\ \\text{s}.\n$$\nHence the subintervals are $I_{1} = [0,\\, 5.0 \\times 10^{-4}]$, $I_{2} = [5.0 \\times 10^{-4},\\, 2.0 \\times 10^{-3}]$, and $I_{3} = [2.0 \\times 10^{-3},\\, 4.0 \\times 10^{-3}]$.\n\nNext, we evaluate the time integrals of the given rates on each subinterval. For the evaporation rate $\\dot{m}_{e}(t) = \\alpha + \\beta t$ with $\\alpha = 8.0 \\times 10^{-7}\\ \\text{kg}\\,\\text{s}^{-1}$ and $\\beta = 1.0 \\times 10^{-4}\\ \\text{kg}\\,\\text{s}^{-2}$, we have\n$$\n\\int_{a}^{b} (\\alpha + \\beta t)\\, dt = \\alpha (b-a) + \\frac{1}{2}\\beta\\left(b^{2} - a^{2}\\right).\n$$\nUsing $I_{1}$ with $a_{1} = 0$ and $b_{1} = 5.0 \\times 10^{-4}$,\n$$\n\\Delta m_{1} = \\alpha (5.0 \\times 10^{-4} - 0) + \\frac{1}{2}\\beta\\left((5.0 \\times 10^{-4})^{2} - 0^{2}\\right) = (8.0 \\times 10^{-7})(5.0 \\times 10^{-4}) + \\frac{1}{2}(1.0 \\times 10^{-4})(2.5 \\times 10^{-7}).\n$$\nNumerically,\n$$\n\\Delta m_{1} = 4.0 \\times 10^{-10} + 1.25 \\times 10^{-11} = 4.125 \\times 10^{-10}.\n$$\nFor $I_{2}$ with $a_{2} = 5.0 \\times 10^{-4}$ and $b_{2} = 2.0 \\times 10^{-3}$,\n$$\n\\Delta m_{2} = \\alpha (1.5 \\times 10^{-3}) + \\frac{1}{2}\\beta\\left((2.0 \\times 10^{-3})^{2} - (5.0 \\times 10^{-4})^{2}\\right) = (8.0 \\times 10^{-7})(1.5 \\times 10^{-3}) + \\frac{1}{2}(1.0 \\times 10^{-4})(3.75 \\times 10^{-6}),\n$$\nso\n$$\n\\Delta m_{2} = 1.2 \\times 10^{-9} + 1.875 \\times 10^{-10} = 1.3875 \\times 10^{-9}.\n$$\nFor $I_{3}$ with $a_{3} = 2.0 \\times 10^{-3}$ and $b_{3} = 4.0 \\times 10^{-3}$,\n$$\n\\Delta m_{3} = \\alpha (2.0 \\times 10^{-3}) + \\frac{1}{2}\\beta\\left((4.0 \\times 10^{-3})^{2} - (2.0 \\times 10^{-3})^{2}\\right) = (8.0 \\times 10^{-7})(2.0 \\times 10^{-3}) + \\frac{1}{2}(1.0 \\times 10^{-4})(12.0 \\times 10^{-6}),\n$$\ngiving\n$$\n\\Delta m_{3} = 1.6 \\times 10^{-9} + 6.0 \\times 10^{-10} = 2.2 \\times 10^{-9}.\n$$\nThe total mass transfer is\n$$\n\\Delta m_{\\text{tot}} = \\alpha \\Delta t + \\frac{1}{2}\\beta \\Delta t^{2} = (8.0 \\times 10^{-7})(4.0 \\times 10^{-3}) + \\frac{1}{2}(1.0 \\times 10^{-4})(16.0 \\times 10^{-6}) = 3.2 \\times 10^{-9} + 0.8 \\times 10^{-9} = 4.0 \\times 10^{-9}.\n$$\nTherefore, the mass fractions are\n$$\nf_{1}^{(m)} = \\frac{4.125 \\times 10^{-10}}{4.0 \\times 10^{-9}} = 0.103125,\\quad\nf_{2}^{(m)} = \\frac{1.3875 \\times 10^{-9}}{4.0 \\times 10^{-9}} = 0.346875,\\quad\nf_{3}^{(m)} = \\frac{2.2 \\times 10^{-9}}{4.0 \\times 10^{-9}} = 0.55.\n$$\n\nFor the enthalpy rate $\\dot{Q}(t) = \\eta - \\zeta t$ with $\\eta = 1.25\\ \\text{W}$ and $\\zeta = 50.0\\ \\text{W}\\,\\text{s}^{-1}$, the integral over $[a,b]$ is\n$$\n\\int_{a}^{b} (\\eta - \\zeta t)\\, dt = \\eta (b-a) - \\frac{1}{2}\\zeta\\left(b^{2} - a^{2}\\right).\n$$\nOver $I_{1}$,\n$$\n\\Delta Q_{1} = \\eta (5.0 \\times 10^{-4}) - \\frac{1}{2}\\zeta\\left((5.0 \\times 10^{-4})^{2} - 0^{2}\\right) = (1.25)(5.0 \\times 10^{-4}) - \\frac{1}{2}(50.0)(2.5 \\times 10^{-7}),\n$$\nso\n$$\n\\Delta Q_{1} = 6.25 \\times 10^{-4} - 6.25 \\times 10^{-6} = 6.1875 \\times 10^{-4}.\n$$\nOver $I_{2}$,\n$$\n\\Delta Q_{2} = \\eta (1.5 \\times 10^{-3}) - \\frac{1}{2}\\zeta\\left((2.0 \\times 10^{-3})^{2} - (5.0 \\times 10^{-4})^{2}\\right) = (1.25)(1.5 \\times 10^{-3}) - \\frac{1}{2}(50.0)(3.75 \\times 10^{-6}),\n$$\nyielding\n$$\n\\Delta Q_{2} = 1.875 \\times 10^{-3} - 9.375 \\times 10^{-5} = 1.78125 \\times 10^{-3}.\n$$\nOver $I_{3}$,\n$$\n\\Delta Q_{3} = \\eta (2.0 \\times 10^{-3}) - \\frac{1}{2}\\zeta\\left((4.0 \\times 10^{-3})^{2} - (2.0 \\times 10^{-3})^{2}\\right) = (1.25)(2.0 \\times 10^{-3}) - \\frac{1}{2}(50.0)(12.0 \\times 10^{-6}),\n$$\ngiving\n$$\n\\Delta Q_{3} = 2.5 \\times 10^{-3} - 3.0 \\times 10^{-4} = 2.2 \\times 10^{-3}.\n$$\nThe total enthalpy transfer is\n$$\n\\Delta Q_{\\text{tot}} = \\eta \\Delta t - \\frac{1}{2}\\zeta \\Delta t^{2} = (1.25)(4.0 \\times 10^{-3}) - \\frac{1}{2}(50.0)(16.0 \\times 10^{-6}) = 5.0 \\times 10^{-3} - 4.0 \\times 10^{-4} = 4.6 \\times 10^{-3}.\n$$\nTherefore, the enthalpy fractions are\n$$\nf_{1}^{(Q)} = \\frac{6.1875 \\times 10^{-4}}{4.6 \\times 10^{-3}} \\approx 0.134510869565,\\quad\nf_{2}^{(Q)} = \\frac{1.78125 \\times 10^{-3}}{4.6 \\times 10^{-3}} \\approx 0.387228260870,\\quad\nf_{3}^{(Q)} = \\frac{2.2 \\times 10^{-3}}{4.6 \\times 10^{-3}} = \\frac{11}{23} \\approx 0.478260869565.\n$$\nBy construction, $\\sum_{i=1}^{3} f_{i}^{(m)} = 1$ and $\\sum_{i=1}^{3} f_{i}^{(Q)} = 1$, satisfying conservation. Rounding each fraction to six significant figures yields\n$$\nf_{1}^{(m)} = 0.103125,\\quad f_{2}^{(m)} = 0.346875,\\quad f_{3}^{(m)} = 0.550000,\\quad f_{1}^{(Q)} = 0.134511,\\quad f_{2}^{(Q)} = 0.387228,\\quad f_{3}^{(Q)} = 0.478261.\n$$\nThe required output is the single row matrix in the specified order.",
            "answer": "$$\\boxed{\\begin{pmatrix}0.103125 & 0.346875 & 0.550000 & 0.134511 & 0.387228 & 0.478261\\end{pmatrix}}$$"
        },
        {
            "introduction": "Spray simulations approximate a continuous liquid flow with a discrete number of computational 'parcels', introducing statistical uncertainty or 'numerical noise' into the Eulerian source terms. This practice  explores the fundamental relationship between the number of parcels used and the resulting statistical error. By deriving and applying this relationship, you will learn how to estimate the computational cost required to achieve a desired level of accuracy in your simulation.",
            "id": "3364885",
            "problem": "A single Computational Fluid Dynamics (CFD) cell receives a vapor mass source during a time step due to evaporation of injected liquid represented by Lagrangian parcels. The liquid injection rate is $\\dot{m}_{\\ell} = 5.0 \\times 10^{-4}\\,\\mathrm{kg}\\,\\mathrm{s}^{-1}$ and the time step is $\\Delta t = 5.0 \\times 10^{-3}\\,\\mathrm{s}$. In one time step, $N$ parcels are injected and each parcel carries equal liquid mass $m_{p} = \\dot{m}_{\\ell}\\,\\Delta t / N$. For a given cell, the evaporated fraction of each parcel’s liquid mass inside the cell over the time step is modeled by independent and identically distributed random variables $X_{i}$ with mean $\\mu_{f} = 0.70$ and standard deviation $\\sigma_{f} = 0.21$, independent of $m_{p}$. The estimated vapor mass source added to the cell in one time step is the sum of evaporated masses $\\sum_{i=1}^{N} m_{p} X_{i}$, divided by the cell volume, but for the purpose of stochastic accuracy, only the relative variability of the source estimate matters.\n\nDefine the coefficient of variation $\\epsilon$ of the estimated source in a single time step to be the ratio of the standard deviation to the mean of the estimator. Starting from the fundamental definitions of the mean and variance of the sum of independent and identically distributed random variables, and the definition of coefficient of variation, derive an expression for $\\epsilon$ as a function of $N$, $\\mu_{f}$, and $\\sigma_{f}$. Using this relationship, determine the number of parcels per time step required to achieve a target coefficient of variation $\\epsilon = 3.0 \\times 10^{-2}$. Additionally, a preliminary run using $N_{\\text{ref}} = 25$ parcels per time step yielded a coefficient of variation consistent with the given $X_{i}$ statistics. Use the preliminary run to cross-check your result via a reference-scaling argument.\n\nExpress the final answer as a single integer value for $N$ (dimensionless). No rounding is required beyond exact evaluation.",
            "solution": "The total mass of liquid evaporated within the cell during one time step, $M_{evap}$, is the sum of the evaporated masses from each of the $N$ parcels:\n$$M_{evap} = \\sum_{i=1}^{N} m_{p} X_{i}$$\nwhere $m_p$ is the mass per parcel and $X_i$ are independent and identically distributed (i.i.d.) random variables representing the evaporated fraction.\n\nThe coefficient of variation, $\\epsilon$, is the ratio of the standard deviation to the mean of the total evaporated mass estimator:\n$$\\epsilon = \\frac{\\sqrt{Var(M_{evap})}}{E[M_{evap}]}$$\n\nFirst, we compute the mean of $M_{evap}$ using the linearity of expectation. Since the $X_i$ are i.i.d. with mean $E[X_i] = \\mu_f$:\n$$E[M_{evap}] = E\\left[\\sum_{i=1}^{N} m_{p} X_{i}\\right] = \\sum_{i=1}^{N} m_{p} E[X_{i}] = N m_{p} \\mu_{f}$$\n\nNext, we compute the variance. Since the $X_i$ are independent, the variance of the sum is the sum of the variances. The variance of each $X_i$ is $Var(X_i) = \\sigma_f^2$.\n$$Var(M_{evap}) = Var\\left(\\sum_{i=1}^{N} m_{p} X_{i}\\right) = \\sum_{i=1}^{N} Var(m_{p} X_{i}) = \\sum_{i=1}^{N} m_{p}^2 Var(X_{i}) = N m_{p}^2 \\sigma_{f}^2$$\nThe standard deviation is the square root of the variance:\n$$\\sqrt{Var(M_{evap})} = \\sqrt{N m_{p}^2 \\sigma_{f}^2} = m_{p} \\sigma_{f} \\sqrt{N}$$\n\nNow we can derive the expression for the coefficient of variation, $\\epsilon$:\n$$\\epsilon = \\frac{m_{p} \\sigma_{f} \\sqrt{N}}{N m_{p} \\mu_{f}}$$\nThe parcel mass $m_p$ cancels out, as $\\epsilon$ measures relative variability.\n$$\\epsilon = \\frac{\\sigma_{f} \\sqrt{N}}{N \\mu_{f}} = \\frac{\\sigma_{f}}{\\mu_{f} \\sqrt{N}}$$\nThis is the key relationship showing that the statistical error is inversely proportional to the square root of the number of samples (parcels).\n\nTo find the number of parcels $N$ required to achieve a target coefficient of variation $\\epsilon$, we rearrange the equation:\n$$\\sqrt{N} = \\frac{\\sigma_{f}}{\\mu_{f} \\epsilon} \\implies N = \\left(\\frac{\\sigma_{f}}{\\mu_{f} \\epsilon}\\right)^2$$\nWe are given $\\mu_f = 0.70$, $\\sigma_f = 0.21$, and the target $\\epsilon = 3.0 \\times 10^{-2} = 0.03$. Substituting these values:\n$$N = \\left(\\frac{0.21}{0.70 \\times 0.03}\\right)^2 = \\left(\\frac{0.21}{0.021}\\right)^2 = (10)^2 = 100$$\nSo, $100$ parcels per time step are required.\n\nTo perform the cross-check, we use the scaling relationship $\\epsilon \\propto 1/\\sqrt{N}$, which implies $\\epsilon \\sqrt{N} = \\text{constant}$. Let $(N_{\\text{ref}}, \\epsilon_{\\text{ref}})$ be the reference case and $(N, \\epsilon)$ be the target case.\n$$ \\epsilon \\sqrt{N} = \\epsilon_{\\text{ref}} \\sqrt{N_{\\text{ref}}} $$\nFirst, calculate $\\epsilon_{\\text{ref}}$ for the reference run with $N_{\\text{ref}} = 25$:\n$$\\epsilon_{\\text{ref}} = \\frac{\\sigma_{f}}{\\mu_{f} \\sqrt{N_{\\text{ref}}}} = \\frac{0.21}{0.70 \\sqrt{25}} = \\frac{0.3}{5} = 0.06$$\nNow, solve for the target number of parcels, $N$:\n$$N = N_{\\text{ref}} \\left(\\frac{\\epsilon_{\\text{ref}}}{\\epsilon}\\right)^2 = 25 \\left(\\frac{0.06}{0.03}\\right)^2 = 25 \\times (2)^2 = 25 \\times 4 = 100$$\nThe cross-check confirms the result. The required number of parcels is 100.",
            "answer": "$$\\boxed{100}$$"
        },
        {
            "introduction": "After implementing complex physical models, how can we be certain that our code solves the governing equations correctly? This practice introduces the Method of Manufactured Solutions (MMS), a rigorous code verification technique where an exact analytical solution is prescribed for the model equations. By working backward to define the necessary source terms and then comparing your numerical results to the exact solution, you can systematically verify the correctness and convergence order of your solver .",
            "id": "3364871",
            "problem": "Consider an evaporating spherical droplet parcel modeled by conservation of mass and energy under convective heat and mass transfer to a surrounding gas. The parcel is assumed to be dilute such that inter-droplet interactions are negligible, the gas-phase properties are constant, and the droplet remains spherical. Let $t$ denote time. Let the droplet liquid density be $\\rho_\\ell$, liquid specific heat capacity be $c_{p,\\ell}$, latent heat of vaporization be $L_v$, gas density be $\\rho_g$, gas dynamic viscosity be $\\mu_g$, gas thermal conductivity be $k_g$, gas specific heat capacity be $c_{p,g}$, binary diffusion coefficient of vapor in gas be $D_v$, universal gas constant be $R_u$, vapor molecular weight be $M_v$, air molecular weight be $M_{air}$, ambient gas pressure be $p$, ambient gas temperature be $T_g$, and ambient vapor mass fraction be $Y_{v,\\infty}$. The droplet mass is $m(t)$, droplet diameter is $d(t)$, and droplet temperature is $T_d(t)$. The droplet area is $A(t) = \\pi d(t)^2$, and the mass is related to diameter by $m(t) = \\rho_\\ell \\frac{\\pi}{6} d(t)^3$. The relative gas-droplet velocity magnitude is $u_{rel}$.\n\nThe governing ordinary differential equations (ODEs) for an evaporating droplet parcel with additive source terms for the Method of Manufactured Solutions (MMS) are:\n- Mass balance: $$\\frac{dm}{dt} = -\\dot{m}_e + S_m(t),$$\n- Energy balance: $$m c_{p,\\ell} \\frac{dT_d}{dt} = h A (T_g - T_d) - \\dot{m}_e L_v + S_T(t),$$\nwhere $\\dot{m}_e$ is the evaporation mass rate, $h$ is the convective heat transfer coefficient, and $S_m(t)$ and $S_T(t)$ are manufactured source terms chosen to make prescribed functions $d(t)$ and $T_d(t)$ exact solutions of the ODEs.\n\nUse standard correlations for mass and heat transfer around a sphere:\n- Reynolds number: $$Re = \\frac{\\rho_g u_{rel} d}{\\mu_g},$$\n- Schmidt number: $$Sc = \\frac{\\mu_g}{\\rho_g D_v},$$\n- Prandtl number: $$Pr = \\frac{\\mu_g c_{p,g}}{k_g},$$\n- Sherwood number: $$Sh = 2 + 0.6 Re^{1/2} Sc^{1/3},$$\n- Nusselt number: $$Nu = 2 + 0.6 Re^{1/2} Pr^{1/3},$$\n- Mass transfer coefficient: $$k_m = \\frac{Sh D_v}{d},$$\n- Heat transfer coefficient: $$h = \\frac{Nu k_g}{d}.$$\n\nAssume a vapor mass fraction at the droplet surface determined by an equilibrium saturation pressure using the integrated Clausius–Clapeyron relation with constant latent heat:\n- Vapor specific gas constant: $$R_v = \\frac{R_u}{M_v},$$\n- Saturation pressure: $$p_{sat}(T_d) = p_{ref} \\exp\\left(-\\frac{L_v}{R_v}\\left(\\frac{1}{T_d} - \\frac{1}{T_{ref}}\\right)\\right),$$\nwith prescribed reference values $p_{ref}$ and $T_{ref}$,\n- Surface vapor mass fraction: $$Y_{v,s}(T_d) = \\frac{M_v p_{sat}(T_d)}{M_v p_{sat}(T_d) + M_{air} \\left(p - p_{sat}(T_d)\\right)}.$$\nThe evaporation rate is modeled as a convective mass transfer flux:\n$$\\dot{m}_e = k_m A \\rho_g \\left(Y_{v,s}(T_d) - Y_{v,\\infty}\\right).$$\n\nManufactured solutions and sources. Prescribe the diameter and droplet temperature as manufactured solutions:\n- Diameter: $$d(t) = d_0 \\sqrt{1 - \\alpha t}, \\quad \\text{for } 0 \\le t < \\frac{1}{\\alpha},$$\n- Droplet temperature: $$T_d(t) = T_{mean} + \\gamma \\sin(\\omega t).$$\nDefine the droplet mass using the geometric relation $m(t) = \\rho_\\ell \\frac{\\pi}{6} d(t)^3$. Using these manufactured $d(t)$ and $T_d(t)$, enforce exactness by defining source terms $S_m(t)$ and $S_T(t)$ as functions of time only such that the above ODEs are satisfied identically by the manufactured solutions. Derive $S_m(t)$ and $S_T(t)$ starting from the fundamental balances:\n- Compute $\\frac{dm}{dt}$ from $m(t)$ and $d(t)$,\n- Compute $\\frac{dT_d}{dt}$ from $T_d(t)$,\n- Evaluate $\\dot{m}_e(t)$ and $h(t)$ using the manufactured $d(t)$ and $T_d(t)$ in the correlations,\n- Solve the balances for $S_m(t)$ and $S_T(t)$, respectively.\n\nNumerical verification. Implement a second-order explicit Runge–Kutta scheme (also known as the midpoint method) to numerically integrate the ODE system with the time-dependent sources $S_m(t)$ and $S_T(t)$:\n- The ODE system to integrate numerically is:\n$$\\frac{dm}{dt} = -\\dot{m}_e(m,T_d,u_{rel}) + S_m(t),$$\n$$\\frac{dT_d}{dt} = \\frac{h(m,u_{rel}) A(m) (T_g - T_d) - \\dot{m}_e(m,T_d,u_{rel}) L_v + S_T(t)}{m c_{p,\\ell}},$$\nwhere $A(m) = \\pi d(m)^2$ and $d(m) = \\left(\\frac{6 m}{\\pi \\rho_\\ell}\\right)^{1/3}$, and $\\dot{m}_e$ and $h$ use the correlations with the instantaneous numerical $d$ and $T_d$.\n\nCompute the discrete time histories $d_{num}(t_i)$ and $T_{num}(t_i)$ from the numerical $m(t_i)$ and $T_d(t_i)$ and compare against the exact manufactured $d(t_i)$ and $T_d(t_i)$ evaluated at the same time grid. For each test case, report two dimensionless measures of accuracy:\n- The relative discrete $L^2$ error in diameter,\n$$\\varepsilon_d = \\sqrt{\\frac{\\sum_{i=1}^{N} \\left(d_{num}(t_i) - d(t_i)\\right)^2}{\\sum_{i=1}^{N} d(t_i)^2}},$$\n- The relative discrete $L^2$ error in droplet temperature,\n$$\\varepsilon_T = \\sqrt{\\frac{\\sum_{i=1}^{N} \\left(T_{num}(t_i) - T_d(t_i)\\right)^2}{\\sum_{i=1}^{N} T_d(t_i)^2}}.$$\nThese errors are dimensionless floats.\n\nParameter values. Use the following physically realistic constants (all in International System of Units (SI)):\n- $\\rho_\\ell = 1000 \\,\\mathrm{kg/m^3}$, $c_{p,\\ell} = 4180 \\,\\mathrm{J/(kg\\cdot K)}$, $L_v = 2.26\\times 10^6 \\,\\mathrm{J/kg}$,\n- $\\rho_g = 1.2 \\,\\mathrm{kg/m^3}$, $\\mu_g = 1.8\\times 10^{-5} \\,\\mathrm{Pa\\cdot s}$, $k_g = 0.026 \\,\\mathrm{W/(m\\cdot K)}$, $c_{p,g} = 1005 \\,\\mathrm{J/(kg\\cdot K)}$,\n- $D_v = 2.5\\times 10^{-5} \\,\\mathrm{m^2/s}$, $R_u = 8.314462618 \\,\\mathrm{J/(mol\\cdot K)}$, $M_v = 18.01528\\times 10^{-3} \\,\\mathrm{kg/mol}$, $M_{air} = 28.97\\times 10^{-3} \\,\\mathrm{kg/mol}$,\n- $p = 101325 \\,\\mathrm{Pa}$, $T_g = 800 \\,\\mathrm{K}$, $Y_{v,\\infty} = 0.01$,\n- Clausius–Clapeyron reference: $p_{ref} = 611 \\,\\mathrm{Pa}$ at $T_{ref} = 273.15 \\,\\mathrm{K}$.\n\nManufactured solution parameters:\n- $d_0 = 100\\times 10^{-6} \\,\\mathrm{m}$, $\\alpha = 20 \\,\\mathrm{s^{-1}}$,\n- $T_{mean} = 300 \\,\\mathrm{K}$, $\\gamma = 10 \\,\\mathrm{K}$, $\\omega = 50 \\,\\mathrm{s^{-1}}$.\n\nInitial conditions for numerical integration are $m(0)$ and $T_d(0)$ taken from the manufactured solution at $t=0$.\n\nTest suite. Use three distinct parameter sets to test solver accuracy:\n- Case 1 (happy path): $u_{rel} = 1.0 \\,\\mathrm{m/s}$, time step $\\Delta t = 1.0\\times 10^{-4} \\,\\mathrm{s}$, final time $T_{end} = 0.02 \\,\\mathrm{s}$,\n- Case 2 (boundary, low convection): $u_{rel} = 0.0 \\,\\mathrm{m/s}$, time step $\\Delta t = 5.0\\times 10^{-5} \\,\\mathrm{s}$, final time $T_{end} = 0.02 \\,\\mathrm{s}$,\n- Case 3 (edge, coarse time step): $u_{rel} = 1.0 \\,\\mathrm{m/s}$, time step $\\Delta t = 1.0\\times 10^{-3} \\,\\mathrm{s}$, final time $T_{end} = 0.02 \\,\\mathrm{s}$.\n\nYour tasks:\n1. Derive explicit formulas for $S_m(t)$ and $S_T(t)$ that make the prescribed $d(t)$ and $T_d(t)$ exact manufactured solutions to the ODEs.\n2. Implement a program that:\n   - Constructs $S_m(t)$ and $S_T(t)$ as time-dependent functions using the prescribed manufactured solution and the given physical correlations,\n   - Integrates the ODEs using a second-order explicit Runge–Kutta method for each test case,\n   - Computes the relative discrete $L^2$ errors $\\varepsilon_d$ and $\\varepsilon_T$ for each case.\n3. Express the errors as dimensionless floats.\n\nFinal output format. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order:\n$$[\\varepsilon_{d,1}, \\varepsilon_{T,1}, \\varepsilon_{d,2}, \\varepsilon_{T,2}, \\varepsilon_{d,3}, \\varepsilon_{T,3}].$$",
            "solution": "The problem requires using the Method of Manufactured Solutions (MMS) to verify a numerical solver for the ODEs governing droplet evaporation. This involves deriving analytical source terms, implementing a numerical solver, and calculating the error against the known manufactured solution.\n\n### Part 1: Derivation of Manufactured Source Terms\n\nThe goal is to find the source terms, $S_m(t)$ and $S_T(t)$, that make the prescribed manufactured solutions, $d(t)$ and $T_d(t)$, exact solutions to the governing ODEs. The governing ODEs are rearranged to solve for the source terms:\n$$S_m(t) = \\frac{dm}{dt} + \\dot{m}_e(t)$$\n$$S_T(t) = m(t) c_{p,\\ell} \\frac{dT_d}{dt} - h(t) A(t) (T_g - T_d(t)) + \\dot{m}_e(t) L_v$$\nTo evaluate these, every term on the right-hand side is expressed as a function of time, $t$, by substituting the manufactured solutions.\n\n**Manufactured Solutions:**\n- Diameter: $d(t) = d_0 \\sqrt{1 - \\alpha t}$\n- Temperature: $T_d(t) = T_{mean} + \\gamma \\sin(\\omega t)$\n- Mass: $m(t) = \\rho_\\ell \\frac{\\pi}{6} d(t)^3$\n\n**Step 1.1: Time Derivatives of Manufactured Solutions**\nThe time derivative of the mass, $\\frac{dm}{dt}$, is found using the chain rule:\n$$\\frac{dm}{dt} = \\frac{d}{dt}\\left(\\rho_\\ell \\frac{\\pi}{6} d(t)^3\\right) = \\rho_\\ell \\frac{\\pi}{2} d(t)^2 \\frac{dd}{dt}$$\nThe time derivative of the diameter is:\n$$\\frac{dd}{dt} = \\frac{d}{dt}\\left(d_0 (1 - \\alpha t)^{1/2}\\right) = -\\frac{\\alpha d_0}{2\\sqrt{1 - \\alpha t}} = -\\frac{\\alpha d_0^2}{2 d(t)}$$\nSubstituting this into the expression for $\\frac{dm}{dt}$:\n$$\\frac{dm}{dt}(t) = -\\frac{\\pi}{4} \\rho_\\ell \\alpha d_0^2 d(t)$$\n\nThe time derivative of the droplet temperature is:\n$$\\frac{dT_d}{dt}(t) = \\frac{d}{dt}\\left(T_{mean} + \\gamma \\sin(\\omega t)\\right) = \\gamma \\omega \\cos(\\omega t)$$\n\n**Step 1.2: Physical Properties based on Manufactured Solutions**\nAll physical properties must be evaluated using $d(t)$ and $T_d(t)$. We denote these time-dependent properties with a subscript 'man'.\n- Reynolds number: $Re_{man}(t) = \\frac{\\rho_g u_{rel} d(t)}{\\mu_g}$\n- Sherwood number: $Sh_{man}(t) = 2 + 0.6 Re_{man}(t)^{1/2} Sc^{1/3}$\n- Nusselt number: $Nu_{man}(t) = 2 + 0.6 Re_{man}(t)^{1/2} Pr^{1/3}$\n\nThe evaporation rate $\\dot{m}_{e,man}(t)$ is:\n$$\\dot{m}_{e,man}(t) = \\pi D_v \\rho_g d(t) Sh_{man}(t) (Y_{v,s,man}(t) - Y_{v,\\infty})$$\nwhere $Y_{v,s,man}(t)$ is the vapor mass fraction at the surface, which depends on $T_d(t)$ via the Clausius-Clapeyron relation.\n\nThe heat transfer term $(hA)_{man}(t)$ is:\n$$(hA)_{man}(t) = \\pi k_g d(t) Nu_{man}(t)$$\n\n**Step 1.3: Final Expressions for Source Terms**\nSubstituting these time-dependent expressions into the equations for $S_m(t)$ and $S_T(t)$:\n$$S_m(t) = -\\frac{\\pi}{4} \\rho_\\ell \\alpha d_0^2 d(t) + \\dot{m}_{e,man}(t)$$\n$$S_T(t) = \\left(\\rho_\\ell \\frac{\\pi}{6} d(t)^3\\right) c_{p,\\ell} (\\gamma \\omega \\cos(\\omega t)) - (hA)_{man}(t) (T_g - T_d(t)) + \\dot{m}_{e,man}(t) L_v$$\nThese equations provide the explicit, time-dependent source terms needed for the MMS verification.\n\n### Part 2: Numerical Integration and Error Analysis\n\nThe task is to integrate the original ODE system numerically using the second-order explicit Runge-Kutta (midpoint) method. The state vector is $\\mathbf{y} = [m, T_d]^T$. The system is $\\frac{d\\mathbf{y}}{dt} = \\mathbf{f}(t, \\mathbf{y})$.\n\n**Step 2.1: The ODE System for Numerical Integration**\nThe function $\\mathbf{f}(t, \\mathbf{y})$ represents the right-hand side of the ODEs, where physical terms $\\dot{m}_e$ and $hA$ are calculated using the current numerical state $(m, T_d)$ at each stage, while the source terms $S_m(t)$ and $S_T(t)$ are evaluated using the analytical manufactured solutions at the corresponding time $t$.\n\n**Step 2.2: The Midpoint Method (RK2)**\nFor a time step $\\Delta t$, the state at $t_{i+1} = t_i + \\Delta t$ is advanced from the state $\\mathbf{y}_i$ at $t_i$ as follows:\n1.  Compute the slope at the beginning of the interval:\n    $$\\mathbf{k}_1 = \\mathbf{f}(t_i, \\mathbf{y}_i)$$\n2.  Estimate the state at the midpoint of the interval:\n    $$\\mathbf{y}_{mid} = \\mathbf{y}_i + \\frac{\\Delta t}{2} \\mathbf{k}_1$$\n3.  Compute the slope at the midpoint:\n    $$\\mathbf{k}_2 = \\mathbf{f}(t_i + \\frac{\\Delta t}{2}, \\mathbf{y}_{mid})$$\n4.  Advance the solution to the next time step:\n    $$\\mathbf{y}_{i+1} = \\mathbf{y}_i + \\Delta t \\mathbf{k}_2$$\n\n**Step 2.3: Implementation and Error Calculation**\nThe numerical procedure is to initialize the solution at $t=0$ using the manufactured solution, integrate forward in time using the RK2 method, and then compute the relative discrete $L^2$ errors, $\\varepsilon_d$ and $\\varepsilon_T$, by comparing the numerical results to the exact manufactured solutions at each time step. This process is repeated for the three specified test cases. A second-order scheme is expected to show the error decreasing quadratically with the time step $\\Delta t$.",
            "answer": "$$\\boxed{[2.74797e-05, 6.58246e-07, 1.06209e-05, 1.21834e-07, 2.67449e-03, 6.86470e-05]}$$"
        }
    ]
}