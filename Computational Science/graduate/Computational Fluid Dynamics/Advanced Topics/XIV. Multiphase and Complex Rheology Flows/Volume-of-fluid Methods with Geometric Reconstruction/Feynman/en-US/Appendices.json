{
    "hands_on_practices": [
        {
            "introduction": "The fundamental challenge in geometric reconstruction is to determine the precise position of the interface, represented by the scalar $\\alpha$, from the known volume fraction $F$ within a computational cell. This first practice provides a concrete entry point into this inverse problem by examining a two-dimensional case . By working through the geometry in a unit square, you will see firsthand how the area occupied by the fluid is a piecewise function of $\\alpha$, and you will develop the analytical skills needed to solve for the interface position in different geometric regimes.",
            "id": "3388618",
            "problem": "Consider a single two-dimensional square computational cell of side length $1$ occupying the domain $\\{(x,y)\\,|\\,0 \\leq x \\leq 1,\\; 0 \\leq y \\leq 1\\}$. In a Volume-of-Fluid (VOF) method with Piecewise Linear Interface Calculation (PLIC), the reconstructed interface in this cell is represented by the straight line $\\mathbf{n}\\cdot \\mathbf{x}=\\alpha$, where $\\mathbf{n}=(\\cos\\theta,\\sin\\theta)$ is the unit normal. The fluid region is taken to be the subset of the cell satisfying $\\mathbf{n}\\cdot \\mathbf{x}\\leq \\alpha$. The volume fraction $F$ equals the area of the fluid region in this unit square.\n\nStarting from the definition of volume fraction as the area of the region $\\{(x,y)\\in[0,1]^2 \\,|\\, \\mathbf{n}\\cdot\\mathbf{x}\\leq \\alpha\\}$ and basic geometric reasoning, derive the piecewise expression for the area as a function of $\\alpha$ by identifying which cell edges are intersected by the line $\\mathbf{n}\\cdot \\mathbf{x}=\\alpha$ as $\\alpha$ varies. Then, for $\\theta=\\pi/3$ and $F=0.3$, determine the correct geometric case based on the relative position of $\\alpha$ to the line intercepts and solve for $\\alpha$.\n\nRound your final $\\alpha$ to four significant figures. Express the answer as a pure number without units.",
            "solution": "The problem requires the derivation of a piecewise expression for the fluid area (volume fraction) $F$ within a unit square computational cell, and then to solve for the interface position parameter $\\alpha$ given a specific fluid fraction $F$ and interface normal angle $\\theta$.\n\nThe computational cell is the unit square defined by $\\{(x,y) \\in \\mathbb{R}^2 \\,|\\, 0 \\leq x \\leq 1, 0 \\leq y \\leq 1\\}$.\nThe interface is a line given by the equation $\\mathbf{n} \\cdot \\mathbf{x} = \\alpha$, where $\\mathbf{x}=(x,y)$ is the position vector and $\\mathbf{n}=(\\cos\\theta, \\sin\\theta)$ is the unit normal vector. This equation can be written as $x\\cos\\theta + y\\sin\\theta = \\alpha$.\nThe fluid region is defined as the set of points within the cell where $\\mathbf{n} \\cdot \\mathbf{x} \\leq \\alpha$. The volume fraction $F$ is the area of this region.\n\nTo derive the expression for the area $F$ as a function of $\\alpha$, we analyze how the line $x\\cos\\theta + y\\sin\\theta = \\alpha$ intersects the unit square as $\\alpha$ varies. The geometry of the fluid region changes as the line passes through the vertices of the square: $(0,0)$, $(1,0)$, $(0,1)$, and $(1,1)$. The values of the function $g(x,y) = x\\cos\\theta + y\\sin\\theta$ at these vertices determine the range of $\\alpha$ for which the line intersects the square.\n$g(0,0) = 0$\n$g(1,0) = \\cos\\theta$\n$g(0,1) = \\sin\\theta$\n$g(1,1) = \\cos\\theta + \\sin\\theta$\n\nThe problem specifies $\\theta = \\pi/3$. Since $0 < \\pi/3 < \\pi/2$, both $\\cos\\theta$ and $\\sin\\theta$ are positive. For $\\theta = \\pi/3$, we have $\\pi/4 < \\theta < \\pi/2$, which implies $\\cos\\theta < \\sin\\theta$. Specifically, $\\cos(\\pi/3) = 1/2$ and $\\sin(\\pi/3) = \\sqrt{3}/2$.\nThe ordered critical values of $\\alpha$ are $0$, $\\cos\\theta$, $\\sin\\theta$, and $\\cos\\theta+\\sin\\theta$. We analyze the area $F(\\alpha)$ in three distinct regimes based on these values.\n\n**Case 1: $0 \\leq \\alpha \\leq \\cos\\theta$**\nIn this regime, the line $x\\cos\\theta + y\\sin\\theta = \\alpha$ intersects the bottom edge ($y=0$) and the left edge ($x=0$) of the square.\nThe intercept on the x-axis is $x_{int} = \\alpha/\\cos\\theta$. Since $\\alpha \\leq \\cos\\theta$, we have $0 \\leq x_{int} \\leq 1$.\nThe intercept on the y-axis is $y_{int} = \\alpha/\\sin\\theta$. Since $\\cos\\theta < \\sin\\theta$, we have $\\alpha < \\sin\\theta$, so $0 \\leq y_{int} < 1$.\nThe fluid region is a right-angled triangle with vertices at $(0,0)$, $(\\alpha/\\cos\\theta, 0)$, and $(0, \\alpha/\\sin\\theta)$.\nThe area of this triangle is:\n$$F(\\alpha) = \\frac{1}{2} \\left(\\frac{\\alpha}{\\cos\\theta}\\right) \\left(\\frac{\\alpha}{\\sin\\theta}\\right) = \\frac{\\alpha^2}{2\\cos\\theta\\sin\\theta} = \\frac{\\alpha^2}{\\sin(2\\theta)}$$\n\n**Case 2: $\\cos\\theta < \\alpha \\leq \\sin\\theta$**\nIn this regime, the x-intercept $x_{int} = \\alpha/\\cos\\theta > 1$, so the line no longer intersects the bottom edge of the square (segment $[0,1]$ on the x-axis). It now intersects the right edge ($x=1$).\nThe y-intercept $y_{int} = \\alpha/\\sin\\theta \\leq 1$, so the line still intersects the left edge ($x=0$).\nThe fluid region is the area within the square bounded by the line $y = (\\alpha - x\\cos\\theta)/\\sin\\theta$ and the axes. This area can be calculated by integrating the height of the fluid region from $x=0$ to $x=1$.\n$$F(\\alpha) = \\int_0^1 \\frac{\\alpha - x\\cos\\theta}{\\sin\\theta} \\,dx$$\nSince $\\alpha \\leq \\sin\\theta$, the maximum height at $x=0$ is $\\alpha/\\sin\\theta \\leq 1$, so the line does not exit through the top of the square.\n$$F(\\alpha) = \\frac{1}{\\sin\\theta} \\left[\\alpha x - \\frac{x^2}{2}\\cos\\theta\\right]_0^1 = \\frac{1}{\\sin\\theta}\\left(\\alpha - \\frac{1}{2}\\cos\\theta\\right) = \\frac{2\\alpha - \\cos\\theta}{2\\sin\\theta}$$\n\n**Case 3: $\\sin\\theta < \\alpha \\leq \\cos\\theta + \\sin\\theta$**\nIn this regime, both intercepts $x_{int} = \\alpha/\\cos\\theta > 1$ and $y_{int} = \\alpha/\\sin\\theta > 1$. The line intersects the right edge ($x=1$) and the top edge ($y=1$).\nThe fluid now occupies most of the cell. It is simpler to calculate the area of the non-fluid region, where $x\\cos\\theta + y\\sin\\theta > \\alpha$, and subtract it from the total area of the cell, which is $1$.\nThe non-fluid region is a small triangle at the top-right corner, with vertices at $(1,1)$, $((\\alpha-\\sin\\theta)/\\cos\\theta, 1)$, and $(1, (\\alpha-\\cos\\theta)/\\sin\\theta)$.\nA coordinate transformation simplifies this. Let $x' = 1-x$ and $y' = 1-y$. The non-fluid region is $(1-x')\\cos\\theta + (1-y')\\sin\\theta > \\alpha$, which simplifies to $x'\\cos\\theta + y'\\sin\\theta < \\cos\\theta + \\sin\\theta - \\alpha$.\nLet $\\alpha' = \\cos\\theta + \\sin\\theta - \\alpha$. The area of the non-fluid region is given by the formula from Case 1 with $\\alpha'$ instead of $\\alpha$:\n$$A_{\\text{non-fluid}} = \\frac{(\\alpha')^2}{2\\cos\\theta\\sin\\theta} = \\frac{(\\cos\\theta + \\sin\\theta - \\alpha)^2}{2\\cos\\theta\\sin\\theta}$$\nThe fluid area is then:\n$$F(\\alpha) = 1 - A_{\\text{non-fluid}} = 1 - \\frac{(\\cos\\theta + \\sin\\theta - \\alpha)^2}{2\\cos\\theta\\sin\\theta}$$\n\nNow, we apply this framework to the specific problem where $\\theta = \\pi/3$ and $F = 0.3$.\nFirst, we determine the values of $F$ at the boundaries of the regimes.\nThe critical values for $\\alpha$ are $\\alpha_1 = \\cos(\\pi/3) = 1/2$ and $\\alpha_2 = \\sin(\\pi/3) = \\sqrt{3}/2$.\nThe value of $\\sin(2\\theta) = \\sin(2\\pi/3) = \\sqrt{3}/2$.\nThe value of $F$ at the first boundary $\\alpha = \\alpha_1 = 1/2$ is:\n$$F(\\alpha_1) = \\frac{\\alpha_1^2}{\\sin(2\\theta)} = \\frac{(1/2)^2}{\\sqrt{3}/2} = \\frac{1/4}{\\sqrt{3}/2} = \\frac{1}{2\\sqrt{3}} = \\frac{\\sqrt{3}}{6} \\approx 0.2887$$\nThe value of $F$ at the second boundary $\\alpha = \\alpha_2 = \\sqrt{3}/2$ is:\n$$F(\\alpha_2) = \\frac{2\\alpha_2 - \\cos\\theta}{2\\sin\\theta} = \\frac{2(\\sqrt{3}/2) - (1/2)}{2(\\sqrt{3}/2)} = \\frac{\\sqrt{3} - 1/2}{\\sqrt{3}} = 1 - \\frac{1}{2\\sqrt{3}} = 1 - \\frac{\\sqrt{3}}{6} \\approx 0.7113$$\n\nWe are given $F=0.3$. Comparing this to the boundary values:\n$F(\\alpha_1) \\approx 0.2887 < 0.3 < 0.7113 \\approx F(\\alpha_2)$.\nThis means the problem falls into **Case 2**, where $\\cos\\theta < \\alpha \\leq \\sin\\theta$.\nThe applicable formula for the area is:\n$$F = \\frac{2\\alpha - \\cos\\theta}{2\\sin\\theta}$$\nWe must solve this equation for $\\alpha$:\n$$2F\\sin\\theta = 2\\alpha - \\cos\\theta$$\n$$2\\alpha = 2F\\sin\\theta + \\cos\\theta$$\n$$\\alpha = F\\sin\\theta + \\frac{1}{2}\\cos\\theta$$\nSubstituting the given values $F=0.3$ and $\\theta=\\pi/3$:\n$$\\alpha = (0.3)\\sin(\\pi/3) + \\frac{1}{2}\\cos(\\pi/3)$$\n$$\\alpha = (0.3)\\left(\\frac{\\sqrt{3}}{2}\\right) + \\frac{1}{2}\\left(\\frac{1}{2}\\right)$$\n$$\\alpha = 0.15\\sqrt{3} + 0.25$$\nNow, we compute the numerical value:\n$$\\alpha \\approx 0.15 \\times (1.7320508) + 0.25$$\n$$\\alpha \\approx 0.25980762 + 0.25$$\n$$\\alpha \\approx 0.50980762$$\nRounding the result to four significant figures gives:\n$$\\alpha \\approx 0.5098$$\nThis value lies in the expected range for Case 2: $1/2 < 0.5098 \\leq \\sqrt{3}/2$, or $0.5 < 0.5098 \\leq 0.866$, which is true.",
            "answer": "$$\\boxed{0.5098}$$"
        },
        {
            "introduction": "While many reconstruction problems require numerical methods, certain symmetric configurations permit elegant analytical solutions. This exercise challenges you to leverage symmetry to deduce the interface position for a classic 3D case: a fluid-filled portion of a cube cut by a plane with a diagonal normal vector where the volume fraction $F=0.5$ . This practice emphasizes the power of physical intuition in simplifying complex problems and solidifies the concept by requiring a rigorous verification through the derivation of the explicit volume function.",
            "id": "3388584",
            "problem": "Consider the Volume-of-Fluid (VOF) method with Piecewise Linear Interface Calculation (PLIC) reconstruction in a single cubic control volume of side length $1$ (the unit cube $[0,1]^{3}$). The interface inside the cell is represented by the plane with unit normal $\\mathbf{n}=\\left(1,1,1\\right)/\\sqrt{3}$ via $\\mathbf{n}\\cdot\\mathbf{x}=\\alpha$, and the fluid occupies the half-space $\\mathbf{n}\\cdot\\mathbf{x}\\le \\alpha$ intersected with the unit cube. The volume fraction is prescribed as $F=0.5$.\n\nUsing only fundamental definitions of the VOF volume fraction and geometric symmetry, do the following:\n\n1. Argue from symmetry what the value of $\\alpha$ must be, without evaluating any complicated integrals.\n2. Then verify your result by deriving an explicit analytic expression for the volume $V(\\alpha)$ of the region $\\{\\mathbf{x}\\in[0,1]^{3}:\\mathbf{n}\\cdot\\mathbf{x}\\le \\alpha\\}$ in terms of $\\alpha$, using first principles. Your derivation must reduce the volume to a scalar integral over a cross-sectional area and evaluate it piecewise for the relevant range of $\\alpha$.\n3. From your explicit volume formula, confirm that the value of $\\alpha$ found by symmetry gives $V(\\alpha)=F$.\n\nExpress the final answer for $\\alpha$ as a single exact expression. No rounding is required and no units should be included in the final answer.",
            "solution": "We begin from the definition of the Volume-of-Fluid (VOF) fraction. In a control volume $\\Omega=[0,1]^{3}$, with an interface plane $\\mathbf{n}\\cdot\\mathbf{x}=\\alpha$ and unit normal $\\mathbf{n}=\\left(1,1,1\\right)/\\sqrt{3}$, the fluid region is the set\n$$\n\\Omega_{f}(\\alpha)=\\{\\mathbf{x}\\in[0,1]^{3}:\\mathbf{n}\\cdot\\mathbf{x}\\le \\alpha\\}.\n$$\nThe VOF fraction $F$ satisfies\n$$\nF=\\frac{\\mathrm{meas}\\left(\\Omega_{f}(\\alpha)\\right)}{\\mathrm{meas}([0,1]^{3})}=\\mathrm{meas}\\left(\\Omega_{f}(\\alpha)\\right),\n$$\nbecause the cell volume is $1$. Here $\\mathrm{meas}(\\cdot)$ denotes the Lebesgue measure (volume). With $\\mathbf{n}=\\left(1,1,1\\right)/\\sqrt{3}$, the plane condition $\\mathbf{n}\\cdot\\mathbf{x}\\le \\alpha$ is equivalent to\n$$\n\\frac{x+y+z}{\\sqrt{3}}\\le \\alpha\\quad\\Longleftrightarrow\\quad x+y+z\\le s,\\quad s:=\\sqrt{3}\\,\\alpha.\n$$\nThus the fluid volume is\n$$\nV(s)=\\mathrm{meas}\\left(\\{(x,y,z)\\in[0,1]^{3}:x+y+z\\le s\\}\\right),\n$$\nand $F=V(s)$ with $s=\\sqrt{3}\\,\\alpha$.\n\nStep $1$ (symmetry argument). Consider the transformation $T:[0,1]^{3}\\to[0,1]^{3}$ given by $T(x,y,z)=(1-x,1-y,1-z)$. This is a measure-preserving bijection. Under $T$, the inequality $x+y+z\\le s$ becomes\n$$\n(1-x)+(1-y)+(1-z)\\le s\\quad\\Longleftrightarrow\\quad 3-(x+y+z)\\le s\\quad\\Longleftrightarrow\\quad x+y+z\\ge 3-s.\n$$\nTherefore, the complement of $\\{x+y+z\\le s\\}$ in the cube maps onto $\\{x+y+z\\le 3-s\\}$. Hence the volume satisfies the symmetry relation\n$$\nV(s)+V(3-s)=1.\n$$\nIt follows immediately that $V(3/2)=1/2$, and by monotonicity of $V(s)$ in $s$, the unique $s$ such that $V(s)=1/2$ is\n$$\ns=\\frac{3}{2}.\n$$\nTherefore,\n$$\n\\alpha=\\frac{s}{\\sqrt{3}}=\\frac{3}{2\\sqrt{3}}=\\frac{\\sqrt{3}}{2}.\n$$\n\nStep $2$ (explicit formula for $V(s)$ and verification). To derive $V(s)$ from first principles, write\n$$\nV(s)=\\iiint_{[0,1]^{3}}\\mathbf{1}_{\\{x+y+z\\le s\\}}\\,\\mathrm{d}x\\,\\mathrm{d}y\\,\\mathrm{d}z,\n$$\nwhere $\\mathbf{1}_{A}$ is the indicator of set $A$. For fixed $z\\in[0,1]$, define $t:=s-z$ and consider the cross-sectional area in the unit square:\n$$\nA(t)=\\iint_{[0,1]^{2}}\\mathbf{1}_{\\{x+y\\le t\\}}\\,\\mathrm{d}x\\,\\mathrm{d}y.\n$$\nThis area is a standard piecewise quadratic function:\n- For $t\\le 0$, $A(t)=0$.\n- For $0\\le t\\le 1$, the subregion is a right triangle with legs of length $t$, so $A(t)=\\frac{t^2}{2}$.\n- For $1\\le t\\le 2$, the subregion is the unit square minus a right triangle of legs $2-t$, hence $A(t)=1-\\frac{(2-t)^2}{2}$.\n- For $t\\ge 2$, $A(t)=1$.\n\nThen\n$$\nV(s)=\\int_{0}^{1}A(s-z)\\,\\mathrm{d}z.\n$$\nFor our case, by the symmetry result we expect $s=3/2$, which lies in the intermediate range $1\\le s\\le 2$. We therefore derive $V(s)$ for $1\\le s\\le 2$. On this interval, as $z$ runs from $0$ to $1$, $t=s-z$ runs from $s$ down to $s-1$, traversing $[1,2]$ and $[0,1]$. Splitting the integral at $z=s-1$ separates the two forms of $A(t)$:\n$$\nV(s)=\\int_{0}^{s-1}\\left(1-\\frac{(2-(s-z))^2}{2}\\right)\\mathrm{d}z+\\int_{s-1}^{1}\\frac{(s-z)^2}{2}\\mathrm{d}z,\\quad 1\\le s\\le 2.\n$$\nChange variables from $z$ to $t$ with $\\mathrm{d}t=-\\mathrm{d}z$:\n$$\nV(s)=\\int_{1}^{s}\\left(1-\\frac{(2-t)^2}{2}\\right)\\mathrm{d}t+\\int_{s-1}^{1}\\frac{t^2}{2}\\mathrm{d}t,\\quad 1\\le s\\le 2.\n$$\nEvaluating,\n$$\n\\int_{1}^{s}\\left(1-\\frac{(2-t)^2}{2}\\right)\\mathrm{d}t=\\left[t+\\frac{(2-t)^3}{6}\\right]_{t=1}^{t=s}=\\left(s+\\frac{(2-s)^3}{6}\\right)-\\left(1+\\frac{1}{6}\\right)=s+\\frac{(2-s)^3}{6}-\\frac{7}{6},\n$$\n$$\n\\int_{s-1}^{1}\\frac{t^{2}}{2}\\,\\mathrm{d}t=\\left[\\frac{t^{3}}{6}\\right]_{t=s-1}^{t=1}=\\frac{1}{6}-\\frac{(s-1)^{3}}{6}.\n$$\nCombining,\n$$\nV(s)=s+\\frac{(2-s)^3}{6}-\\frac{7}{6}+\\frac{1}{6}-\\frac{(s-1)^3}{6} = s-1 + \\frac{(8-12s+6s^2-s^3) - (s^3-3s^2+3s-1)}{6} = s-1+\\frac{-2s^3+9s^2-15s+9}{6}=-\\frac{s^3}{3}+\\frac{3}{2}s^2-\\frac{3}{2}s+\\frac{1}{2},\\quad 1\\le s\\le 2.\n$$\n\nStep $3$ (confirmation at the symmetric value). Substituting $s=3/2$ gives\n$$\nV\\!\\left(\\frac{3}{2}\\right)=-\\frac{(3/2)^{3}}{3}+\\frac{3}{2}\\left(\\frac{3}{2}\\right)^{2}-\\frac{3}{2}\\left(\\frac{3}{2}\\right)+\\frac{1}{2}=-\\frac{27}{24}+\\frac{27}{8}-\\frac{9}{4}+\\frac{1}{2}=\\frac{1}{2}.\n$$\nTherefore $V(s)=F$ at $s=3/2$, and with $s=\\sqrt{3}\\,\\alpha$ we obtain\n$$\n\\alpha=\\frac{s}{\\sqrt{3}}=\\frac{3}{2\\sqrt{3}}=\\frac{\\sqrt{3}}{2}.\n$$\n\nThus both the symmetry argument and the explicit volume calculation confirm the unique PLIC plane constant $\\alpha=\\sqrt{3}/2$ for $F=0.5$ and $\\mathbf{n}=(1,1,1)/\\sqrt{3}$ in the unit cube.",
            "answer": "$$\\boxed{\\frac{\\sqrt{3}}{2}}$$"
        },
        {
            "introduction": "Practical applications of VOF methods require a robust and general algorithm for finding $\\alpha$ for any given normal vector $\\mathbf{n}$ and volume fraction $F$. This final practice guides you through the construction of such a solver, which is the computational core of PLIC reconstruction . You will first derive the analytical expression for the derivative $\\frac{dV}{d\\alpha}$ and then design a hybrid Newton-bisection algorithm to solve the nonlinear equation $V(\\alpha; \\mathbf{n}) - F = 0$, bridging the gap between theoretical geometry and practical implementation.",
            "id": "3388660",
            "problem": "Consider a Piecewise Linear Interface Calculation (PLIC) in three dimensions for a unit cube domain, defined as the Cartesian product $[0,1]\\times[0,1]\\times[0,1]$, and a plane interface described by the half-space $\\{\\mathbf{x}\\in\\mathbb{R}^3 \\mid \\mathbf{n}\\cdot\\mathbf{x} \\le \\alpha\\}$, where $\\mathbf{n}\\in\\mathbb{R}^3$ is a nonzero normal vector and $\\alpha\\in\\mathbb{R}$ is a scalar plane constant. Define the function $V(\\alpha;\\mathbf{n})$ to be the volume of the intersection of the unit cube with the half-space, that is,\n$$\nV(\\alpha;\\mathbf{n}) \\;=\\; \\int_{[0,1]^3} H\\!\\left(\\alpha - \\mathbf{n}\\cdot\\mathbf{x}\\right) \\, d\\mathbf{x},\n$$\nwhere $H(\\cdot)$ is the Heaviside step function. In Volume-of-Fluid reconstruction, given a desired volume fraction $F\\in[0,1]$ (dimensionless), one must determine $\\alpha$ such that $V(\\alpha;\\mathbf{n}) - F = 0$.\n\nYour tasks are:\n- Starting from the integral definition above and fundamental calculus, derive the expression for the derivative $dV/d\\alpha$ that is required to perform a Newton iteration for solving $V(\\alpha;\\mathbf{n}) - F = 0$.\n- Outline and implement a robust Newton iteration to solve for $\\alpha$ for general $\\mathbf{n}$ in a unit cube, using your derived $dV/d\\alpha$ and a numerically stable computation of $V(\\alpha;\\mathbf{n})$.\n\nImplementation requirements:\n- The program must treat the cube as $[0,1]^3$ and treat $\\mathbf{n}$ as a general nonzero vector (not necessarily unit length and with arbitrary signs).\n- The quantity $V(\\alpha;\\mathbf{n})$ must be computed numerically in a scientifically sound manner. You are required to compute $V(\\alpha;\\mathbf{n})$ by integrating the cross-sectional area $A(s;\\mathbf{n})$ of the polygon given by the intersection of the plane $\\mathbf{n}\\cdot\\mathbf{x}=s$ with the cube, from the minimal intersection level to $s=\\alpha$. That is, $V(\\alpha;\\mathbf{n})$ must be approximated via a composite numerical quadrature of the form\n$$\nV(\\alpha;\\mathbf{n}) \\approx \\int_{\\alpha_{\\min}}^{\\alpha} \\frac{A(s;\\mathbf{n})}{\\|\\mathbf{n}\\|}\\, ds,\n$$\nwhere $\\alpha_{\\min}$ is the minimal value of $\\mathbf{n}\\cdot\\mathbf{x}$ over the cube.\n- The derivative $dV/d\\alpha$ must be computed using the area of the slice at the level $\\alpha$.\n- The program must implement a combined Newton–bisection scheme to ensure convergence for all admissible cases, enforcing the bracket $[\\alpha_{\\min},\\alpha_{\\max}]$, where $\\alpha_{\\min}$ and $\\alpha_{\\max}$ are the minimum and maximum of $\\mathbf{n}\\cdot\\mathbf{x}$ over the cube, respectively.\n\nInitial guess and bracketing:\n- Use the monotone mapping initial guess\n$$\n\\alpha_0 \\;=\\; \\alpha_{\\min} + F\\,(\\alpha_{\\max} - \\alpha_{\\min}).\n$$\n- Maintain a bracket $[\\alpha_{\\min},\\alpha_{\\max}]$ with $V(\\alpha_{\\min};\\mathbf{n})=0$ and $V(\\alpha_{\\max};\\mathbf{n})=1$, and perform bisection whenever the Newton update leaves the bracket or does not reduce the residual.\n\nNumerical details:\n- The area $A(s;\\mathbf{n})$ of the intersection polygon must be computed by intersecting the plane $\\mathbf{n}\\cdot\\mathbf{x}=s$ with all $12$ cube edges to collect polygon vertices, followed by a projection to an orthonormal basis of the plane and evaluation of the polygon area via the shoelace formula. If there are fewer than $3$ intersection points, define $A(s;\\mathbf{n})=0$.\n- Define the tolerance for solving $V(\\alpha;\\mathbf{n}) - F = 0$ as $10^{-8}$ and the maximum number of Newton iterations as $50$. Use a composite Simpson’s rule with an even number of subintervals to evaluate the integral for $V(\\alpha;\\mathbf{n})$.\n\nTest suite:\n- Use the following set of test cases, each specified as a pair $(\\mathbf{n},F)$, where all quantities are dimensionless floats:\n  - Case $1$: $\\mathbf{n}=(0.3,\\,0.5,\\,0.4)$, $F=0.237$.\n  - Case $2$: $\\mathbf{n}=(-1.0,\\,0.5,\\,2.0)$, $F=0.5$.\n  - Case $3$: $\\mathbf{n}=(0.0,\\,1.0,\\,0.0)$, $F=0.25$.\n  - Case $4$: $\\mathbf{n}=(1.0,\\,-1.0,\\,0.0)$, $F=0.0$.\n  - Case $5$: $\\mathbf{n}=(2.0,\\,0.0,\\,-1.0)$, $F=1.0$.\n\nAnswer specification:\n- For each test case, compute the scalar $\\alpha$ that solves $V(\\alpha;\\mathbf{n}) - F = 0$ using your Newton–bisection solver. The final results must be returned as floats.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example, $[\\alpha_1,\\alpha_2,\\alpha_3,\\alpha_4,\\alpha_5]$.\n\nThere are no physical units involved in this problem; all quantities are dimensionless. Express all outputs as floats.",
            "solution": "The user wants to solve for a plane constant `alpha` that defines a specific volume fraction `F` inside a unit cube, as part of a Piecewise Linear Interface Calculation (PLIC) method. This involves two main tasks: deriving the derivative of the volume with respect to `alpha`, and implementing a numerical solver.\n\n### Problem Validation\nThe problem is first validated against the specified criteria.\n\n- **Givens Extraction**:\n  - Domain: Unit cube $[0,1]^3$.\n  - Interface: Half-space $\\{\\mathbf{x}\\in\\mathbb{R}^3 \\mid \\mathbf{n}\\cdot\\mathbf{x} \\le \\alpha\\}$.\n  - Volume function: $V(\\alpha;\\mathbf{n}) = \\int_{[0,1]^3} H(\\alpha - \\mathbf{n}\\cdot\\mathbf{x}) \\, d\\mathbf{x}$.\n  - Goal: Solve for $\\alpha$ such that $V(\\alpha;\\mathbf{n}) = F$ for a given volume fraction $F \\in [0,1]$ and normal vector $\\mathbf{n}$.\n  - Numerical Method: A hybrid Newton-bisection method is required.\n  - Volume computation: $V(\\alpha;\\mathbf{n})$ must be approximated numerically by integrating the cross-sectional area, $V(\\alpha;\\mathbf{n}) \\approx \\int_{\\alpha_{\\min}}^{\\alpha} \\frac{A(s;\\mathbf{n})}{\\|\\mathbf{n}\\|} ds$, using composite Simpson's rule.\n  - Derivative computation: $dV/d\\alpha$ is to be computed from the area of the slice at $\\alpha$.\n  - Initial Guess and Bracketing: The initial guess is $\\alpha_0 = \\alpha_{\\min} + F(\\alpha_{\\max} - \\alpha_{\\min})$, with the bracket $[\\alpha_{\\min}, \\alpha_{\\max}]$.\n  - Area computation: $A(s;\\mathbf{n})$ is found by intersecting the plane $\\mathbf{n}\\cdot\\mathbf{x}=s$ with the 12 cube edges, projecting the resulting vertices, and using the shoelace formula.\n  - Test cases and tolerances are specified.\n\n- **Validation Check**:\n  - The problem is **scientifically grounded** in computational fluid dynamics and VOF methods.\n  - It is **well-posed**; the volume function $V(\\alpha;\\mathbf{n})$ is continuous and monotonically increasing with $\\alpha$, guaranteeing a unique solution for $\\alpha$ for any given $F \\in [0,1]$.\n  - The description is **objective** and provides precise mathematical and algorithmic constraints.\n  - The provided formulation for $V(\\alpha;\\mathbf{n})$ as an integral of cross-sectional area is consistent with the integral definition involving the Heaviside function, as can be shown via the coarea formula. All definitions and constraints are self-consistent and complete.\n\n- **Verdict**: The problem is **valid**.\n\n### Part 1: Derivation of the Derivative $dV/d\\alpha$\n\nThe volume of the fluid, $V(\\alpha;\\mathbf{n})$, is defined by the integral of the scaled cross-sectional area function from the minimum possible value of $\\mathbf{n}\\cdot\\mathbf{x}$ up to the level $\\alpha$:\n$$\nV(\\alpha;\\mathbf{n}) = \\int_{\\alpha_{\\min}}^{\\alpha} \\frac{A(s;\\mathbf{n})}{\\|\\mathbf{n}\\|} ds\n$$\nwhere $A(s;\\mathbf{n})$ is the area of the polygon formed by the intersection of the plane $\\mathbf{n}\\cdot\\mathbf{x}=s$ with the unit cube, and $\\alpha_{\\min} = \\min_{\\mathbf{x} \\in [0,1]^3} (\\mathbf{n}\\cdot\\mathbf{x})$.\n\nTo find the derivative $dV/d\\alpha$, we apply the Leibniz integral rule for differentiating an integral with respect to its upper limit. Specifically, this is an application of the First Fundamental Theorem of Calculus.\nLet the integrand be $g(s) = \\frac{A(s;\\mathbf{n})}{\\|\\mathbf{n}\\|}$. The volume function is $V(\\alpha;\\mathbf{n}) = \\int_{\\alpha_{\\min}}^{\\alpha} g(s) ds$.\nThe derivative with respect to the upper limit $\\alpha$ is given by:\n$$\n\\frac{dV}{d\\alpha} = \\frac{d}{d\\alpha} \\left( \\int_{\\alpha_{\\min}}^{\\alpha} g(s) ds \\right)\n$$\nAssuming the integrand $g(s)$ is continuous at $s=\\alpha$, the theorem states that the derivative is simply the integrand evaluated at $\\alpha$:\n$$\n\\frac{dV}{d\\alpha} = g(\\alpha)\n$$\nSubstituting the expression for $g(s)$, we obtain the required derivative:\n$$\n\\frac{dV}{d\\alpha} = \\frac{A(\\alpha;\\mathbf{n})}{\\|\\mathbf{n}\\|}\n$$\nThis expression is fundamental to the Newton iteration, as it represents the rate of change of volume with respect to the plane's position, which is precisely the area of the cutting plane inside the domain, scaled by $1/\\|\\mathbf{n}\\|$ due to the projection inherent in the definition of $\\alpha$.\n\n### Part 2: Algorithmic Design and Implementation\n\nThe goal is to solve the nonlinear equation $f(\\alpha) = V(\\alpha;\\mathbf{n}) - F = 0$. A robust hybrid Newton-bisection algorithm is implemented.\n\n**1. Newton-Bisection Solver (`solve_for_alpha`)**\nThe solver iteratively finds the root $\\alpha$.\n- **Initialization**:\n  - The extrema $\\alpha_{\\min} = \\sum_i \\min(0, n_i)$ and $\\alpha_{\\max} = \\sum_i \\max(0, n_i)$ are computed. These define the search bracket $[\\alpha_{\\min}, \\alpha_{\\max}]$.\n  - Trivial cases $F=0$ and $F=1$ are handled directly, returning $\\alpha_{\\min}$ and $\\alpha_{\\max}$ respectively.\n  - The initial guess is set to $\\alpha_0 = \\alpha_{\\min} + F(\\alpha_{\\max} - \\alpha_{\\min})$.\n- **Iteration**: The loop continues until the residual $|V(\\alpha) - F|$ is below a tolerance ($10^{-8}$) or a maximum number of iterations ($50$) is reached.\n  - In each step $k$, the residual $f(\\alpha_k) = V(\\alpha_k;\\mathbf{n}) - F$ is computed.\n  - The derivative $f'(\\alpha_k) = dV/d\\alpha|_{\\alpha_k} = A(\\alpha_k;\\mathbf{n})/\\|\\mathbf{n}\\|$ is calculated.\n  - A Newton step is proposed: $\\alpha_{N} = \\alpha_k - f(\\alpha_k)/f'(\\alpha_k)$.\n  - **Hybrid Strategy**: If the Newton step $\\alpha_N$ falls outside the current bracket $[\\alpha_{\\text{low}}, \\alpha_{\\text{high}}]$ or if the derivative $f'(\\alpha_k)$ is close to zero, the method reverts to a bisection step: $\\alpha_{\\text{next}} = (\\alpha_{\\text{low}} + \\alpha_{\\text{high}})/2$. Otherwise, the Newton step is accepted: $\\alpha_{\\text{next}} = \\alpha_N$.\n  - **Bracket Update**: The bracket is narrowed by comparing the sign of the residual at the current iterate $\\alpha_k$. If $f(\\alpha_k) < 0$, $\\alpha_k$ becomes the new lower bound $\\alpha_{\\text{low}}$; otherwise, it becomes the new upper bound $\\alpha_{\\text{high}}$.\n\n**2. Volume Computation (`compute_volume`)**\nThis function numerically computes $V(\\alpha;\\mathbf{n}) = \\int_{\\alpha_{\\min}}^{\\alpha} \\frac{A(s;\\mathbf{n})}{\\|\\mathbf{n}\\|} ds$.\n- It uses the composite Simpson's rule with a fixed number of even subintervals ($N=100$) for high accuracy. The function to be integrated, $A(s;\\mathbf{n})$, is piecewise quadratic, making Simpson's rule a highly effective choice.\n- The function discretizes the integration interval $[\\alpha_{\\min}, \\alpha]$ into $N$ subintervals and applies the weighted sum of integrand values at the sample points $s_i$. The integrand at each point is $\\frac{A(s_i;\\mathbf{n})}{\\|\\mathbf{n}\\|}$.\n\n**3. Cross-Sectional Area Computation (`compute_area`)**\nThis function is the geometric core of the algorithm. It computes $A(s;\\mathbf{n})$, the area of the polygon formed by the intersection of the plane $\\mathbf{n}\\cdot\\mathbf{x}=s$ and the unit cube.\n- **Vertex Finding**: The polygon's vertices are the intersection points of the plane with the $12$ edges of the cube. For each edge, parameterized as $\\mathbf{p}_0 + t\\mathbf{d}$ with $t \\in [0,1]$, the intersection parameter $t = (s - \\mathbf{n}\\cdot\\mathbf{p}_0)/(\\mathbf{n}\\cdot\\mathbf{d})$ is calculated. If $t \\in [0,1]$, the point is a vertex of the polygon. A small tolerance is used to handle floating-point inaccuracies. Duplicate vertices (arising from the plane intersecting a cube vertex) are removed.\n- **Area Calculation**: If fewer than $3$ vertices are found, the area is $0$. Otherwise:\n  - **Projection**: The 3D vertices are projected onto a 2D coordinate system. This is done by first defining an orthonormal basis $\\{\\mathbf{u}, \\mathbf{v}\\}$ for the plane.\n  - **Sorting**: The 2D vertices are sorted in angular order (e.g., counter-clockwise) around their centroid. This is essential for the shoelace formula. The angle is computed using `atan2`.\n  - **Shoelace Formula**: The area of the ordered 2D polygon $(x_0, y_0), \\dots, (x_{m-1}, y_{m-1})$ is calculated as Area $= \\frac{1}{2} |\\sum_{i=0}^{m-1} (x_i y_{i+1} - x_{i+1} y_i)|$, where $(x_m, y_m) = (x_0, y_0)$.\n\nThis structured, principle-based approach ensures a robust and accurate solution to the PLIC volume fraction problem.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print the results.\n    \"\"\"\n\n    # Cube vertices and edges for geometry calculations\n    CUBE_VERTICES = np.array([\n        [0, 0, 0], [1, 0, 0], [1, 1, 0], [0, 1, 0],\n        [0, 0, 1], [1, 0, 1], [1, 1, 1], [0, 1, 1]\n    ], dtype=float)\n\n    CUBE_EDGES = [\n        (0, 1), (1, 2), (2, 3), (3, 0),  # Bottom face\n        (4, 5), (5, 6), (6, 7), (7, 4),  # Top face\n        (0, 4), (1, 5), (2, 6), (3, 7)   # Vertical edges\n    ]\n\n    def get_alpha_minmax(n):\n        \"\"\"\n        Computes the minimum and maximum of n.x over the unit cube.\n        \"\"\"\n        alpha_min = sum(n[i] for i in range(3) if n[i] < 0)\n        alpha_max = sum(n[i] for i in range(3) if n[i] > 0)\n        return alpha_min, alpha_max\n\n    def get_plane_basis(n):\n        \"\"\"\n        Computes an orthonormal basis {u, v} for the plane with normal n.\n        \"\"\"\n        n_norm = np.linalg.norm(n)\n        if n_norm < 1e-12:\n            return None, None\n        n_hat = n / n_norm\n        \n        min_idx = np.argmin(np.abs(n_hat))\n        e = np.zeros(3)\n        e[min_idx] = 1.0\n        \n        u = np.cross(n_hat, e)\n        u /= np.linalg.norm(u)\n        \n        v = np.cross(n_hat, u)\n        return u, v\n\n    memo_area = {}\n    def compute_area(s, n):\n        \"\"\"\n        Computes the area of the polygon formed by intersecting the plane\n        n.x = s with the unit cube.\n        \"\"\"\n        n_tuple = tuple(n)\n        if (s, n_tuple) in memo_area:\n             return memo_area[(s, n_tuple)]\n\n        epsilon = 1e-9\n        intersection_points = []\n        \n        for v_start_idx, v_end_idx in CUBE_EDGES:\n            p0 = CUBE_VERTICES[v_start_idx]\n            d = CUBE_VERTICES[v_end_idx] - p0\n            \n            n_dot_d = np.dot(n, d)\n            \n            if abs(n_dot_d) < epsilon:\n                continue\n                \n            t = (s - np.dot(n, p0)) / n_dot_d\n            \n            if -epsilon <= t <= 1 + epsilon:\n                point = p0 + t * d\n                point = np.clip(point, 0, 1)\n\n                is_duplicate = any(np.linalg.norm(point - p_exist) < epsilon for p_exist in intersection_points)\n                if not is_duplicate:\n                    intersection_points.append(point)\n\n        if len(intersection_points) < 3:\n            return 0.0\n\n        u, v = get_plane_basis(n)\n        if u is None: return 0.0\n\n        p0_ref = intersection_points[0]\n        projected_points = []\n        for p in intersection_points:\n            dp = p - p0_ref\n            projected_points.append((np.dot(dp, u), np.dot(dp, v)))\n        \n        centroid = np.mean(projected_points, axis=0)\n        projected_points.sort(key=lambda p: np.arctan2(p[1] - centroid[1], p[0] - centroid[0]))\n        \n        area = 0.0\n        num_verts = len(projected_points)\n        for i in range(num_verts):\n            p1 = projected_points[i]\n            p2 = projected_points[(i + 1) % num_verts]\n            area += p1[0] * p2[1] - p2[0] * p1[1]\n            \n        result = 0.5 * abs(area)\n        memo_area[(s, n_tuple)] = result\n        return result\n\n    memo_volume = {}\n    def compute_volume(alpha, n, N_simpson, F_ref):\n        \"\"\"\n        Computes the volume V(alpha; n) using composite Simpson's rule.\n        A reference F is passed to handle degenerate cases.\n        \"\"\"\n        n_tuple = tuple(n)\n        if (alpha, n_tuple) in memo_volume:\n            return memo_volume[(alpha, n_tuple)]\n\n        alpha_min, alpha_max = get_alpha_minmax(n)\n        norm_n = np.linalg.norm(n)\n\n        if norm_n < 1e-12: return 0.5 if F_ref > 0.5 else 0.0\n        if alpha <= alpha_min + 1e-9: return 0.0\n        if alpha >= alpha_max - 1e-9: return 1.0\n\n        h = (alpha - alpha_min) / N_simpson\n        s_points = np.linspace(alpha_min, alpha, N_simpson + 1)\n        \n        integrand_values = np.array([compute_area(s, n) for s in s_points]) / norm_n\n        \n        integral = integrand_values[0] + integrand_values[-1]\n        integral += 4 * np.sum(integrand_values[1:-1:2])\n        integral += 2 * np.sum(integrand_values[2:-2:2])\n        \n        result = integral * h / 3.0\n        memo_volume[(alpha, n_tuple)] = result\n        return result\n\n    def solve_for_alpha(n, F):\n        \"\"\"\n        Solves V(alpha; n) = F for alpha using a hybrid Newton-Bisection method.\n        \"\"\"\n        n = np.asarray(n, dtype=float)\n        alpha_min, alpha_max = get_alpha_minmax(n)\n\n        if F <= 1e-9: return alpha_min\n        if F >= 1.0 - 1e-9: return alpha_max\n\n        tol = 1e-8\n        max_iter = 50\n        N_simpson = 100\n\n        alpha_low, alpha_high = alpha_min, alpha_max\n        alpha_k = alpha_min + F * (alpha_max - alpha_min)\n        \n        norm_n = np.linalg.norm(n)\n        if norm_n < 1e-12:\n            return 0.0 # Degenerate case, n=0 -> n.x=0, V is step function at alpha=0\n\n        # Clear memos for each new case\n        memo_area.clear()\n        memo_volume.clear()\n\n        for _ in range(max_iter):\n            V_k = compute_volume(alpha_k, n, N_simpson=N_simpson, F_ref=F)\n            residual = V_k - F\n            \n            if abs(residual) < tol:\n                return alpha_k\n            \n            # Update bracket based on the current point\n            if residual < 0:\n                alpha_low = alpha_k\n            else:\n                alpha_high = alpha_k\n\n            # Propose next step\n            area_k = compute_area(alpha_k, n)\n            dV_dalpha = area_k / norm_n if norm_n > 0 else 0.0\n            \n            use_bisection = False\n            if abs(dV_dalpha) < 1e-12:\n                use_bisection = True\n            else:\n                delta_alpha = -residual / dV_dalpha\n                alpha_next_newton = alpha_k + delta_alpha\n                if not (alpha_low < alpha_next_newton < alpha_high):\n                    use_bisection = True\n            \n            if use_bisection:\n                alpha_k = (alpha_low + alpha_high) / 2.0\n            else:\n                alpha_k = alpha_next_newton\n        \n        return alpha_k\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        ((0.3, 0.5, 0.4), 0.237),\n        ((-1.0, 0.5, 2.0), 0.5),\n        ((0.0, 1.0, 0.0), 0.25),\n        ((1.0, -1.0, 0.0), 0.0),\n        ((2.0, 0.0, -1.0), 1.0),\n    ]\n\n    results = []\n    for n, F in test_cases:\n        alpha = solve_for_alpha(n, F)\n        results.append(alpha)\n\n    # Final print statement in the exact required format.\n    # Using 7 decimal places for consistent formatting, as requested by 'float' type\n    print(f\"[{','.join(f'{r:.7f}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}