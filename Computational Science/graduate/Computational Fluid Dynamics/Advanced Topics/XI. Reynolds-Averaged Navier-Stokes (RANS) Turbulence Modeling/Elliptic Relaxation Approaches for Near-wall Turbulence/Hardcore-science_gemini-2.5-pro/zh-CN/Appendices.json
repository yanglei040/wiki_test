{
    "hands_on_practices": [
        {
            "introduction": "椭圆松弛方法的核心是求解一个特定的椭圆偏微分方程，以模拟壁面边界对湍流的非局部阻尼效应。本练习将通过在一个二维边界层场景中应用有限体积法，为您提供离散化和求解该方程的第一手经验。掌握这项技能是实现这些高级湍流模型的基础，并有助于深入理解非局部项的数学行为 。",
            "id": "3313959",
            "problem": "考虑平板上二维定常边界层中的近壁湍流的椭圆松弛模型。令松弛变量表示为 $\\alpha(x,y)$，松弛长度尺度由已知场 $L(x,y)$ 指定。该定常非局部松弛过程通过以下线性椭圆偏微分方程建模：\n$$\n\\nabla\\cdot\\left(L^2(x,y)\\,\\nabla \\alpha(x,y)\\right) - \\alpha(x,y) = -\\alpha_{\\mathrm{eq}}(x,y),\n$$\n该方程定义在矩形域 $[0,L_x]\\times[0,L_y]$ 上，并具有与平板边界层一致的以下边界条件：在 $y=0$ 处的无滑移壁面意味着狄利克雷(Dirichlet)条件 $\\alpha(x,0)=0$；在外边界 $y=L_y$ 处的对称或自由流条件意味着齐次诺伊曼(Neumann)条件 $\\partial \\alpha/\\partial y=0$；在入口 $x=0$ 处意味着齐次诺伊曼条件 $\\partial \\alpha/\\partial x=0$；在出口 $x=L_x$ 处意味着齐次诺伊曼条件 $\\partial \\alpha/\\partial x=0$。平衡目标被指定为\n$$\n\\alpha_{\\mathrm{eq}}(x,y) = \\alpha_\\infty\\left(1-\\exp\\left(-\\frac{y}{c_\\delta\\,\\delta(x)}\\right)\\right),\n$$\n其中层流边界层厚度代理为\n$$\n\\delta(x) = C_\\delta \\sqrt{\\frac{\\nu x}{U_\\infty}}.\n$$\n这里 $U_\\infty$ 是自由流速度，$\\nu$ 是运动粘度，$\\alpha_\\infty$ 是无量纲的外部平衡值，$C_\\delta$ 和 $c_\\delta$ 是无量纲常数。\n\n您的任务是，在一个均匀的结构化网格上，使用保守的二阶有限体积法离散化来数值计算 $\\alpha(x,y)$。其中，面中心的扩散系数由相邻单元中心的 $L^2(x,y)$ 值的调和平均值构成。使用以网格点为中心的控制体，网格间距为 $\\Delta x=L_x/(N_x-1)$ 和 $\\Delta y=L_y/(N_y-1)$。通过在相应边界面上施加零法向扩散通量来实现齐次诺伊曼条件；通过在壁面节点上逐点强制赋值来实现狄利克雷条件。构建生成的稀疏线性系统并求解内部未知数。假设 $\\alpha_\\infty=1$ 和 $c_\\delta=1$。\n\n为将计算出的 $\\alpha(x,y)$ 场与边界层厚度关联以进行解释，对于三个流向站位 $x\\in\\{x_1,x_2,x_3\\}$，将穿透高度 $y_{95}(x)$ 定义为满足 $\\alpha(x,y)\\ge 0.95\\,\\alpha(x,L_y)$ 的最小壁面法向位置。计算无量纲比率\n$$\nr(x) = \\frac{y_{95}(x)}{\\delta(x)},\n$$\n并对下方的每个测试用例，报告指定站位上三个比率的算术平均值，即：\n$$\n\\bar r = \\frac{1}{3}\\sum_{m=1}^3 r(x_m).\n$$\n\n在所有计算中统一使用以下物理和数值参数：$U_\\infty=10$，$ \\nu=1.5\\times 10^{-5}$，$L_x=1.0$，$L_y=0.2$，$N_x=81$，$N_y=81$，$C_\\delta=5.0$，$x_1=0.1$，$x_2=0.5$，$x_3=0.9$。松弛长度 $L(x,y)$ 在不同用例中有所不同，具体如下。\n\n需要实现和评估的测试套件：\n- 用例A（正常路径，带饱和的壁面标度）：$L(x,y)=\\min\\{\\kappa\\,y,\\,L_\\infty\\}$，其中 $\\kappa=0.41$ 且 $L_\\infty=0.03$。\n- 用例B（边缘情况，非常小的饱和尺度）：$L(x,y)=\\min\\{\\kappa\\,y,\\,L_\\infty\\}$，其中 $\\kappa=0.41$ 且 $L_\\infty=0.001$。\n- 用例C（覆盖性情况，均匀松弛尺度）：$L(x,y)=L_0$，其中 $L_0=0.03$。\n\n您的程序必须：\n- 在相同的网格上离散并求解每个用例所述的椭圆问题。\n- 为每个用例计算如上定义的 $\\bar r$。\n- 生成单行输出，其中包含三个结果，形式为方括号内以逗号分隔的列表，每个数字四舍五入到六位小数，顺序为用例 A、用例 B、用例 C（例如 `[a,b,c]`）。\n\n因为所要求的输出是无量纲比率，所以最终的数值输出不需要物理单位。程序必须是自包含的，不依赖任何外部输入。",
            "solution": "用户提供了一个来自计算流体力学领域的适定问题，具体涉及近壁湍流的椭圆松弛模型。该问题具有科学依据，内容自洽，所有参数均已定义。验证通过，我们可以着手求解。\n\n该问题要求对以下定常、线性、椭圆偏微分方程（PDE）进行数值求解：\n$$\n\\nabla\\cdot\\left(L^2(x,y)\\,\\nabla \\alpha(x,y)\\right) - \\alpha(x,y) = -\\,\\alpha_{\\mathrm{eq}}(x,y)\n$$\n该方程模拟了湍流变量 $\\alpha(x,y)$ 的非局部松弛过程。项 $L^2(x,y)$ 是松弛长度的平方，作为空间变化的扩散系数。项 $-\\alpha(x,y)$ 是一个局部汇或“松弛”项，而 $\\alpha_{\\mathrm{eq}}(x,y)$ 是 $\\alpha$ 松弛趋向的预设平衡态。\n\n解将通过在一个均匀的、以节点为中心的网格上使用二阶、保守的有限体积法获得。域 $[0,L_x]\\times[0,L_y]$ 被离散为 $N_x \\times N_y$ 个节点，间距为 $\\Delta x = L_x/(N_x-1)$ 和 $\\Delta y = L_y/(N_y-1)$。\n\n围绕位于 $(x_i, y_j)$ 的每个网格节点 $(i,j)$ 定义一个控制体（CV）。PDE在每个CV上进行积分。对于一个内部CV，这得到：\n$$\n\\int_{y_{j-1/2}}^{y_{j+1/2}} \\int_{x_{i-1/2}}^{x_{i+1/2}} \\left[ \\nabla\\cdot(D\\nabla \\alpha) - \\alpha \\right] dx\\,dy = \\int_{y_{j-1/2}}^{y_{j+1/2}} \\int_{x_{i-1/2}}^{x_{i+1/2}} (-\\alpha_{\\mathrm{eq}}) dx\\,dy\n$$\n其中 $D(x,y) = L^2(x,y)$。应用散度定理并使用中点法则值（即单元中心值）近似积分，可得到跨CV面的通量平衡以及积分后的源/汇项：\n$$\n(F_e - F_w) + (F_n - F_s) - \\alpha_{i,j}\\Delta x\\Delta y = -\\alpha_{\\mathrmeq, i,j}\\Delta x\\Delta y\n$$\n这里，$F_e, F_w, F_n, F_s$ 分别是流出东、西、北、南四个面的总扩散通量。以东面为例，通量为 $F_e = D_e (\\partial\\alpha/\\partial x)_e \\Delta y$，其中 $D_e$ 是面上的扩散系数。导数通过中心差分近似，例如 $(\\partial\\alpha/\\partial x)_e \\approx (\\alpha_{i+1,j} - \\alpha_{i,j})/\\Delta x$。问题规定，面中心的扩散系数使用相邻单元中心值的调和平均值计算，例如 $D_e = 2D_{i,j}D_{i+1,j}/(D_{i,j}+D_{i+1,j})$。\n\n结合这些近似并除以CV体积 $\\Delta x \\Delta y$，为每个未知数 $\\alpha_{i,j}$ 得到一个线性代数方程：\n$$\na_W \\alpha_{i-1,j} + a_E \\alpha_{i+1,j} + a_S \\alpha_{i,j-1} + a_N \\alpha_{i,j+1} + a_P \\alpha_{i,j} = -\\alpha_{\\mathrmeq,i,j}\n$$\n其中系数定义为：$a_W = D_w/\\Delta x^2$，$a_E = D_e/\\Delta x^2$，$a_S = D_s/\\Delta y^2$，$a_N = D_n/\\Delta y^2$，中心系数为 $a_P = -(a_W+a_E+a_S+a_N+1)$。$a_P$ 中的项 '$-1$' 来自PDE中的松弛项 $-\\alpha$。\n\n边界条件按如下方式并入：\n1.  **$y=0$ 处的狄利克雷(Dirichlet)条件**：通过为所有 $i=0,\\dots,N_x-1$ 设置 $\\alpha_{i,0}=0$ 来强制执行条件 $\\alpha(x,0)=0$。这些节点不是未知数。对于 $j=1$ 处的相邻节点，南侧相邻项 $a_S \\alpha_{i,0}$ 是一个已知量（本例中为零），并被移到代数方程的右侧。一个关键的物理细节是，对于用例A和B，$L(x,0)=0$，这意味着 $D(x,0)=0$。在 $j=1$ 和 $j=0$ 之间的面上，$D_s$ 的调和平均值变为零，从而在扩散项中自动将 $j=1$ 的节点与壁面解耦。\n2.  **$x=0, x=L_x, y=L_y$ 处的齐次诺伊曼(Neumann)条件**：零法向扩散通量的条件通过使用虚拟单元技术实现。例如，在左边界 $x=0$ 处，假设 $i=-1$ 处的虚拟节点的值为 $\\alpha_{-1,j} = \\alpha_{0,j}$。对于 $i=0$ 处的单元，向西的通量与 $D_w (\\alpha_{0,j} - \\alpha_{-1,j})$ 成正比，该值变为零。这有效地消除了西侧相邻项的耦合，并对边界节点的模板进行了相应修改。具体来说，$a_W$ 项从方程中消失。相同的逻辑应用于东边界和北边界。\n\n这些离散方程构成一个大型、稀疏、对角占优的线性系统，形式为 $\\mathbf{A}\\mathbf{x}=\\mathbf{b}$，其中 $\\mathbf{x}$ 是包含 $\\alpha$ 的 $N_x \\times (N_y-1)$ 个未知节点值的向量。该系统被构建起来，然后使用稀疏直接求解器 `scipy.sparse.linalg.spsolve` 高效求解。\n\n在获得解场 $\\alpha(x,y)$ 后，对每个用例执行以下后处理步骤：\n1.  在每个指定的流向站位 $x_m \\in \\{0.1, 0.5, 0.9\\}$，确定相应的列索引 $i_m$。\n2.  提取垂直剖面 $\\alpha(x_m, y)$。局部外部值为 $\\alpha(x_m, L_y) = \\alpha_{i_m, N_y-1}$。\n3.  找到穿透高度 $y_{95}(x_m)$，其定义为 $\\alpha$ 达到其外部值 $95\\%$ 时的 $y$ 位置。这是通过对离散剖面进行线性插值来计算的。\n4.  计算局部边界层厚度代理 $\\delta(x_m) = C_\\delta \\sqrt{\\nu x_m / U_\\infty}$。\n5.  计算无量纲比率 $r(x_m) = y_{95}(x_m)/\\delta(x_m)$。\n6.  最终报告的值 $\\bar{r}$ 是三个比率 $r(x_1)$、$r(x_2)$ 和 $r(x_3)$ 的算术平均值。\n\n对三个测试用例中的每一个都重复此过程，这些用例改变了松弛长度尺度 $L(x,y)$ 的定义，并报告所得的 $\\bar{r}$ 值。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.sparse import lil_matrix\nfrom scipy.sparse.linalg import spsolve\n\ndef solve():\n    \"\"\"\n    Main function to orchestrate the solution for the three test cases\n    and print the final output in the required format.\n    \"\"\"\n    test_cases = [\n        {'type': 'A', 'kappa': 0.41, 'L_inf': 0.03},\n        {'type': 'B', 'kappa': 0.41, 'L_inf': 0.001},\n        {'type': 'C', 'L0': 0.03}\n    ]\n\n    results = []\n    for case_params in test_cases:\n        result = solve_case(case_params)\n        results.append(f\"{result:.6f}\")\n\n    print(f\"[{','.join(results)}]\")\n\ndef solve_case(case_params):\n    \"\"\"\n    Discretizes and solves the elliptic PDE for a single test case,\n    then computes and returns the required average ratio.\n    \"\"\"\n    # Physical and numerical parameters\n    U_inf = 10.0\n    nu = 1.5e-5\n    Lx = 1.0\n    Ly = 0.2\n    Nx = 81\n    Ny = 81\n    C_delta = 5.0\n    alpha_inf = 1.0\n    c_delta = 1.0\n    x_stations = np.array([0.1, 0.5, 0.9])\n\n    # Grid setup\n    dx = Lx / (Nx - 1)\n    dy = Ly / (Ny - 1)\n    x = np.linspace(0, Lx, Nx)\n    y = np.linspace(0, Ly, Ny)\n    X, Y = np.meshgrid(x, y, indexing='ij')\n\n    # Pre-calculate auxiliary fields: delta(x), alpha_eq(x,y), L(x,y), D(x,y)\n    delta_x = np.zeros_like(x)\n    non_zero_x_mask = x > 0\n    delta_x[non_zero_x_mask] = C_delta * np.sqrt(nu * x[non_zero_x_mask] / U_inf)\n\n    alpha_eq = np.zeros((Nx, Ny))\n    for i in range(Nx):\n        if delta_x[i] > 1e-15:\n            alpha_eq[i, 1:] = alpha_inf * (1.0 - np.exp(-y[1:] / (c_delta * delta_x[i])))\n        else: # Handle x=0 where delta=0\n            alpha_eq[i, 1:] = alpha_inf\n    # By default, alpha_eq(x,0) remains 0.\n\n    case_type = case_params.get('type')\n    if case_type in ['A', 'B']:\n        kappa = case_params['kappa']\n        L_inf = case_params['L_inf']\n        L = np.minimum(kappa * Y, L_inf)\n    elif case_type == 'C':\n        L0 = case_params['L0']\n        L = np.full((Nx, Ny), L0)\n    \n    D = L**2\n\n    # Assemble the sparse linear system A*x=b\n    num_unknowns = Nx * (Ny - 1)\n    A = lil_matrix((num_unknowns, num_unknowns))\n    b = np.zeros(num_unknowns)\n\n    for i in range(Nx):\n        for j in range(1, Ny):\n            k = i * (Ny - 1) + (j - 1)\n            b[k] = -alpha_eq[i, j]\n\n            A_p_contrib = 0.0\n\n            # West neighbor (i-1, j)\n            if i > 0:\n                D_w_den = D[i,j] + D[i-1,j]\n                D_w = (2.0 * D[i,j] * D[i-1,j]) / D_w_den if D_w_den > 1e-15 else 0.0\n                A_w = D_w / dx**2\n                k_w = (i - 1) * (Ny - 1) + (j - 1)\n                A[k, k_w] = A_w\n                A_p_contrib -= A_w\n            \n            # East neighbor (i+1, j)\n            if i  Nx - 1:\n                D_e_den = D[i,j] + D[i+1,j]\n                D_e = (2.0 * D[i,j] * D[i+1,j]) / D_e_den if D_e_den > 1e-15 else 0.0\n                A_e = D_e / dx**2\n                k_e = (i + 1) * (Ny - 1) + (j - 1)\n                A[k, k_e] = A_e\n                A_p_contrib -= A_e\n\n            # South neighbor (i, j-1)\n            D_s_den = D[i,j] + D[i,j-1]\n            D_s = (2.0 * D[i,j] * D[i,j-1]) / D_s_den if D_s_den > 1e-15 else 0.0\n            A_s = D_s / dy**2\n            if j > 1:\n                k_s = i * (Ny - 1) + (j - 2)\n                A[k, k_s] = A_s\n            # For j=1, neighbor alpha_i0=0 is known. Its contribution A_s*alpha_i0=0 to RHS is nil.\n            A_p_contrib -= A_s\n\n            # North neighbor (i, j+1)\n            if j  Ny - 1:\n                D_n_den = D[i,j] + D[i,j+1]\n                D_n = (2.0 * D[i,j] * D[i,j+1]) / D_n_den if D_n_den > 1e-15 else 0.0\n                A_n = D_n / dy**2\n                k_n = i * (Ny - 1) + j\n                A[k, k_n] = A_n\n                A_p_contrib -= A_n\n                \n            # Diagonal entry, including the local relaxation term '-1'\n            A[k, k] = A_p_contrib - 1.0\n\n    # Solve the system and reconstruct the full solution field\n    alpha_vec = spsolve(A.tocsc(), b)\n    alpha = np.zeros((Nx, Ny))\n    alpha[:, 1:] = alpha_vec.reshape((Nx, Ny - 1))\n\n    # Post-process to find the mean ratio\n    ratios = []\n    x_indices = [np.argmin(np.abs(x - xs)) for xs in x_stations]\n\n    for i_stat in x_indices:\n        x_m = x[i_stat]\n        delta_m = C_delta * np.sqrt(nu * x_m / U_inf) if x_m > 0 else 0.0\n\n        alpha_profile = alpha[i_stat, :]\n        alpha_outer = alpha_profile[-1]\n        target_alpha = 0.95 * alpha_outer\n\n        if target_alpha  1e-9: # Robustness for near-zero solutions\n            y95 = 0.0\n        else:\n            y95 = np.interp(target_alpha, alpha_profile, y)\n\n        if delta_m > 1e-15:\n            r_m = y95 / delta_m\n            ratios.append(r_m)\n\n    return np.mean(ratios)\n\nif __name__ == \"__main__\":\n    solve()\n\n```"
        },
        {
            "introduction": "任何计算流体动力学模拟的准确性都严重依赖于计算网格的质量，尤其是在需要精确捕捉壁面附近物理现象的近壁湍流模型中。本练习将指导您如何通过截断误差分析，从理论上推导出解析椭圆松弛层所需的网格分辨率要求。通过这项实践，您将学会如何为壁面解析模拟设计合适的网格，确保数值解的精度和可靠性 。",
            "id": "3314002",
            "problem": "考虑湍流边界层的一个一维壁面法向切片，其中近壁湍流由一个针对通用松弛变量 $f$ 的椭圆松弛方程建模，该方法用于速度脉动到阻尼 ($v^2-f$) 的研究中。在粘性子层和缓冲层中，椭圆松弛行为的齐次部分可以很好地由以下壁面法向常微分方程表示\n$$\nL^2 \\frac{d^2 f}{dy^2} - f \\approx 0,\n$$\n其中 $y$ 是壁面法向坐标，壁面处 $y=0$，$L$ 是一个椭圆松弛长度尺度，其为正值且在近壁区变化足够缓慢，可在松弛层上被视作常数。近壁区的物理相关解是指数衰减的，因此 $f$ 在一个数量级为 $L$ 的长度上会显著减小。\n\n您必须设计一个能够解析椭圆松弛层的壁面法向网格，其意义在于，由二阶导数的二阶中心差分近似引入的局部截断误差，与作用于 $f$ 的椭圆算子的特征量级相比，保持在预设的相对容差 $\\varepsilon$ 以下。对于均匀间距 $\\Delta y$，二阶导数的中心差分近似的局部截断误差与 $\\Delta y^2$ 乘以四阶导数成正比。对于指数解，截断误差贡献 $L^2 \\left(\\text{truncation error of } d^2 f/dy^2\\right)$ 与特征算子量级 $f$ 的比值约为\n$$\n\\left(\\frac{\\Delta y^2}{12}\\right)\\frac{1}{L^2}.\n$$\n施加要求，使该比值小于或等于预设容差 $\\varepsilon$，并确定均匀间距 $\\Delta y$ 的一个界限，该界限足以确保在整个松弛层中都满足误差约束。\n\n使用标准湍流壁面标度 $y^+ = y u_\\tau / \\nu$ 来定义无量纲壁面单位 $y^+$，其中 $u_\\tau$ 是摩擦速度，$\\nu$ 是运动粘度。假设采用单元中心离散化，其中第一个内部点位于 $y = \\Delta y/2$。需要解析的松弛层范围定义为距离 $y_\\alpha$，在此距离处，指数解已衰减至其邻近壁面量值的预设分数 $\\alpha$。使用指数衰减模型，此松弛层范围为\n$$\ny_\\alpha = L \\ln\\left(\\frac{1}{\\alpha}\\right).\n$$\n\n您的任务是，对下面的每个测试用例：\n- 推导并计算满足截断误差要求的最大允许均匀间距 $\\Delta y$。\n- 计算第一个单元中心的壁面单位 $y^+_{\\text{first}} = (\\Delta y/2) u_\\tau / \\nu$（无量纲）。\n- 确定使用间距 $\\Delta y$ 覆盖松弛层厚度 $y_\\alpha$ 所需的最小整数个均匀间隔点 $N_{\\text{relax}}$，即\n$$\nN_{\\text{relax}} = \\left\\lceil \\frac{y_\\alpha}{\\Delta y} \\right\\rceil.\n$$\n\n假设在松弛层之外，网格加密可以放宽，因此您只需报告 $0 \\le y \\le y_\\alpha$ 范围内的均匀近壁网格加密情况。\n\n将第一个单元的 $y^+$ 值表示为小数（无量纲），点数 $N_{\\text{relax}}$ 表示为整数。本问题不涉及角度。下面给出的所有输入参数均使用国际单位制 (SI)：壁面法向长度单位为米，运动粘度单位为 $\\mathrm{m^2/s}$，摩擦速度单位为 $\\mathrm{m/s}$，容差和分数是无量纲小数。\n\n测试套件：\n1. 案例A（类空气边界层）：\n   - $u_\\tau = 0.5~\\mathrm{m/s}$，\n   - $\\nu = 1.5\\times 10^{-5}~\\mathrm{m^2/s}$，\n   - $L = 1.2\\times 10^{-3}~\\mathrm{m}$，\n   - $\\delta = 5.0\\times 10^{-2}~\\mathrm{m}$（外部边界层厚度，供参考），\n   - $\\varepsilon = 1.0\\times 10^{-4}$，\n   - $\\alpha = 1.0\\times 10^{-2}$。\n2. 案例B（类水边界层）：\n   - $u_\\tau = 4.0\\times 10^{-2}~\\mathrm{m/s}$，\n   - $\\nu = 1.0\\times 10^{-6}~\\mathrm{m^2/s}$，\n   - $L = 2.5\\times 10^{-4}~\\mathrm{m}$，\n   - $\\delta = 1.5\\times 10^{-2}~\\mathrm{m}$，\n   - $\\varepsilon = 5.0\\times 10^{-5}$，\n   - $\\alpha = 1.0\\times 10^{-3}$。\n3. 案例C（低速类空气边界层）：\n   - $u_\\tau = 2.0\\times 10^{-1}~\\mathrm{m/s}$，\n   - $\\nu = 1.8\\times 10^{-5}~\\mathrm{m^2/s}$，\n   - $L = 8.0\\times 10^{-4}~\\mathrm{m}$，\n   - $\\delta = 3.0\\times 10^{-2}~\\mathrm{m}$，\n   - $\\varepsilon = 2.0\\times 10^{-4}$，\n   - $\\alpha = 2.0\\times 10^{-2}$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。列表中的每个元素都是一个包含两个项目的列表 $[y^+_{\\text{first}}, N_{\\text{relax}}]$，按上述顺​​序对应于每个测试用例。例如，输出格式必须是\n$$\n[ [y^+_{\\text{first},A}, N_{\\text{relax},A}], [y^+_{\\text{first},B}, N_{\\text{relax},B}], [y^+_{\\text{first},C}, N_{\\text{relax},C}] ].\n$$\n将每个 $y^+_{\\text{first}}$ 四舍五入到6位小数。整数 $N_{\\text{relax}}$ 必须是精确值。",
            "solution": "该问题经评估是有效的，因为它在科学上基于计算流体动力学和湍流模型的原理，其定义和数据完整且一致，问题是适定的，并以客观、正式的语言表述。所提供的物理参数对于指定的流动条件是现实的。任务是为简化的近壁湍流模型推导和计算网格分辨率要求。\n\n对于每个测试用例，推导过程分三步进行：a) 确定最大允许均匀网格间距 $\\Delta y$，b) 计算无量纲的第一个单元中心的壁面坐标 $y^+_{\\text{first}}$，以及 c) 求出解析近壁松弛层所需的最小网格点数 $N_{\\text{relax}}$。\n\n近壁区域中松弛变量 $f$ 的控制常微分方程如下所示：\n$$\nL^2 \\frac{d^2 f}{dy^2} - f \\approx 0\n$$\n其中 $y$ 是壁面法向坐标，$L$ 是恒定的椭圆松弛长度尺度。物理上相关的解是指数衰减解，$f(y) \\propto e^{-y/L}$。\n\n**步骤1：最大网格间距 $\\Delta y$ 的推导**\n\n问题对数值格式的局部截断误差提出了要求。由二阶中心差分格式产生的截断误差贡献与算子的特征量级之比近似为 $\\left(\\frac{\\Delta y^2}{12}\\right)\\frac{1}{L^2}$。该比值必须小于或等于预设的相对容差 $\\varepsilon$。我们建立以下约束条件：\n$$\n\\frac{(\\Delta y)^2}{12 L^2} \\le \\varepsilon\n$$\n为了求出最大允许间距，我们对 $\\Delta y$ 解此不等式：\n$$\n(\\Delta y)^2 \\le 12 \\varepsilon L^2\n$$\n由于 $\\Delta y$ 必须是正长度，我们对两边取平方根：\n$$\n\\Delta y \\le \\sqrt{12 \\varepsilon L^2}\n$$\n因此，我们将用于网格的最大均匀间距为：\n$$\n\\Delta y_{\\text{max}} = L \\sqrt{12 \\varepsilon}\n$$\n在余下的分析中，我们设置网格间距为 $\\Delta y = \\Delta y_{\\text{max}}$。\n\n**步骤2：第一个单元中心的壁面单位 $y^+_{\\text{first}}$ 的计算**\n\n无量纲壁面单位 $y^+$ 定义为：\n$$\ny^+ = \\frac{y u_\\tau}{\\nu}\n$$\n其中 $u_\\tau$ 是摩擦速度，$\\nu$ 是运动粘度。问题指定了单元中心离散化，其中第一个内部点位于 $y_{\\text{first}} = \\Delta y / 2$。将此代入 $y^+$ 的定义，得到第一个单元中心的壁面单位 $y^+_{\\text{first}}$：\n$$\ny^+_{\\text{first}} = \\frac{(\\Delta y / 2) u_\\tau}{\\nu} = \\frac{\\Delta y u_\\tau}{2 \\nu}\n$$\n代入 $\\Delta y = \\Delta y_{\\text{max}}$ 的表达式，得到：\n$$\ny^+_{\\text{first}} = \\frac{(L \\sqrt{12 \\varepsilon}) u_\\tau}{2 \\nu}\n$$\n\n**步骤3：最小点数 $N_{\\text{relax}}$ 的确定**\n\n松弛层由其厚度 $y_\\alpha$ 定义，这是解 $f$ 从壁面处衰减到其邻近壁面值的 $\\alpha$ 分数时的距离。该距离由下式给出：\n$$\ny_\\alpha = L \\ln\\left(\\frac{1}{\\alpha}\\right)\n$$\n覆盖此距离所需的尺寸为 $\\Delta y$ 的均匀间隔网格单元数量为比率 $y_\\alpha / \\Delta y$。由于点数必须为整数且必须覆盖整个层，我们对此比率进行向上取整：\n$$\nN_{\\text{relax}} = \\left\\lceil \\frac{y_\\alpha}{\\Delta y} \\right\\rceil\n$$\n代入 $y_\\alpha$ 和 $\\Delta y = \\Delta y_{\\text{max}}$ 的表达式：\n$$\nN_{\\text{relax}} = \\left\\lceil \\frac{L \\ln(1/\\alpha)}{L \\sqrt{12 \\varepsilon}} \\right\\rceil = \\left\\lceil \\frac{\\ln(1/\\alpha)}{\\sqrt{12 \\varepsilon}} \\right\\rceil\n$$\n此结果表明，解析松弛层所需的点数与特定的长度尺度 $L$ 和流动参数 $u_\\tau$ 及 $\\nu$ 无关，仅取决于数值容差 $\\varepsilon$ 和衰减定义 $\\alpha$。\n\n**测试用例计算**\n\n现在将推导出的公式应用于三个指定的测试用例。\n\n**案例 A:**\n给定参数：$u_\\tau = 0.5~\\mathrm{m/s}$，$\\nu = 1.5 \\times 10^{-5}~\\mathrm{m^2/s}$，$L = 1.2 \\times 10^{-3}~\\mathrm{m}$，$\\varepsilon = 1.0 \\times 10^{-4}$，$\\alpha = 1.0 \\times 10^{-2}$。\n$$\n\\Delta y = (1.2 \\times 10^{-3}) \\sqrt{12 \\times (1.0 \\times 10^{-4})} \\approx 4.15692 \\times 10^{-5}~\\mathrm{m}\n$$\n$$\ny^+_{\\text{first}} = \\frac{(4.15692 \\times 10^{-5}) \\times 0.5}{2 \\times (1.5 \\times 10^{-5})} \\approx 0.692820\n$$\n$$\nN_{\\text{relax}} = \\left\\lceil \\frac{\\ln(1 / (1.0 \\times 10^{-2}))}{\\sqrt{12 \\times (1.0 \\times 10^{-4})}} \\right\\rceil = \\left\\lceil \\frac{\\ln(100)}{\\sqrt{0.0012}} \\right\\rceil = \\lceil 132.937 \\rceil = 133\n$$\n\n**案例 B:**\n给定参数：$u_\\tau = 4.0 \\times 10^{-2}~\\mathrm{m/s}$，$\\nu = 1.0 \\times 10^{-6}~\\mathrm{m^2/s}$，$L = 2.5 \\times 10^{-4}~\\mathrm{m}$，$\\varepsilon = 5.0 \\times 10^{-5}$，$\\alpha = 1.0 \\times 10^{-3}$。\n$$\n\\Delta y = (2.5 \\times 10^{-4}) \\sqrt{12 \\times (5.0 \\times 10^{-5})} \\approx 6.12372 \\times 10^{-6}~\\mathrm{m}\n$$\n$$\ny^+_{\\text{first}} = \\frac{(6.12372 \\times 10^{-6}) \\times (4.0 \\times 10^{-2})}{2 \\times (1.0 \\times 10^{-6})} \\approx 0.122474\n$$\n$$\nN_{\\text{relax}} = \\left\\lceil \\frac{\\ln(1 / (1.0 \\times 10^{-3}))}{\\sqrt{12 \\times (5.0 \\times 10^{-5})}} \\right\\rceil = \\left\\lceil \\frac{\\ln(1000)}{\\sqrt{0.0006}} \\right\\rceil = \\lceil 281.996 \\rceil = 282\n$$\n\n**案例 C:**\n给定参数：$u_\\tau = 2.0 \\times 10^{-1}~\\mathrm{m/s}$，$\\nu = 1.8 \\times 10^{-5}~\\mathrm{m^2/s}$，$L = 8.0 \\times 10^{-4}~\\mathrm{m}$，$\\varepsilon = 2.0 \\times 10^{-4}$，$\\alpha = 2.0 \\times 10^{-2}$。\n$$\n\\Delta y = (8.0 \\times 10^{-4}) \\sqrt{12 \\times (2.0 \\times 10^{-4})} \\approx 3.91918 \\times 10^{-5}~\\mathrm{m}\n$$\n$$\ny^+_{\\text{first}} = \\frac{(3.91918 \\times 10^{-5}) \\times (2.0 \\times 10^{-1})}{2 \\times (1.8 \\times 10^{-5})} \\approx 0.217732\n$$\n$$\nN_{\\text{relax}} = \\left\\lceil \\frac{\\ln(1 / (2.0 \\times 10^{-2}))}{\\sqrt{12 \\times (2.0 \\times 10^{-4})}} \\right\\rceil = \\left\\lceil \\frac{\\ln(50)}{\\sqrt{0.0024}} \\right\\rceil = \\lceil 79.853 \\rceil = 80\n$$\n\n这些计算得出了每个测试用例所需的值，这些值将被格式化为最终的程序输出。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates near-wall grid resolution requirements for an elliptic relaxation model.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each tuple contains: (u_tau, nu, L, epsilon, alpha)\n    test_cases = [\n        # Case A (air-like boundary layer)\n        (0.5, 1.5e-5, 1.2e-3, 1.0e-4, 1.0e-2),\n        # Case B (water-like boundary layer)\n        (4.0e-2, 1.0e-6, 2.5e-4, 5.0e-5, 1.0e-3),\n        # Case C (low-speed air-like boundary layer)\n        (2.0e-1, 1.8e-5, 8.0e-4, 2.0e-4, 2.0e-2),\n    ]\n\n    results = []\n    for case in test_cases:\n        # Unpack parameters for the current case\n        u_tau, nu, L, epsilon, alpha = case\n\n        # Step 1: Compute the maximum permissible uniform spacing delta_y\n        # delta_y = L * sqrt(12 * epsilon)\n        delta_y = L * np.sqrt(12 * epsilon)\n\n        # Step 2: Compute the first-cell-center wall unit y_plus_first\n        # y_plus_first = (delta_y / 2) * u_tau / nu\n        y_plus_first = (delta_y * u_tau) / (2 * nu)\n\n        # Step 3: Determine the minimal integer number of points N_relax\n        # N_relax = ceil(y_alpha / delta_y), where y_alpha = L * ln(1/alpha)\n        # This simplifies to ceil(ln(1/alpha) / sqrt(12 * epsilon))\n        n_relax = np.ceil(np.log(1 / alpha) / np.sqrt(12 * epsilon))\n\n        # Format the results as specified:\n        # - y_plus_first rounded to 6 decimal places.\n        # - n_relax as an integer.\n        # The result for each case is a two-item list.\n        result = [round(y_plus_first, 6), int(n_relax)]\n        results.append(result)\n\n    # Final print statement in the exact required format: [[y1, N1], [y2, N2], ...]\n    # The default string representation of a list of lists in Python matches the required output format.\n    print(results)\n\nsolve()\n```"
        },
        {
            "introduction": "湍流模型的最终价值在于其预测工程关键参数（如壁面摩擦系数）的准确性。本练习将理论与应用联系起来，展示了如何利用椭圆松弛模型产生的速度剖面来计算皮肤摩擦系数 $C_f$。您将通过一个实际的后处理工作流程，学习如何验证模型预测，并评估模型对参数变化的敏感性，这在模型开发和验证中至关重要 。",
            "id": "3313995",
            "problem": "考虑在间距为 $2h$ 的两个平行板之间的不可压缩牛顿流体的充分发展的湍流平面槽道流，平均流沿流向，且在流向或展向上没有平均变化。设运动粘度为 $\\nu$，密度为 $\\rho$。定义表面摩擦系数为 $C_f = 2 \\tau_w / (\\rho U_b^2)$，其中 $\\tau_w$ 是壁面剪切应力，$U_b$ 是总体（截面平均）平均速度。目标是根据给定的 $v^2-f$（速度方差平方减去椭圆松弛函数）模型的近壁湍流模型代理计算 $C_f$，评估其对椭圆松弛长度尺度定义 $L$ 的敏感性，然后与直接数值模拟（DNS）启发的复合相关式进行比较。\n\n从充分发展槽道的雷诺平均纳维-斯托克斯（RANS）平均动量平衡、无滑移条件和壁面律标度出发。使用基本事实 $u_\\tau = \\sqrt{\\tau_w/\\rho}$（摩擦速度）、$U_b = \\frac{1}{h} \\int_0^h U(y) \\, dy$ 和 $C_f = 2 \\left( \\frac{u_\\tau}{U_b} \\right)^2$。将以下平均速度剖面的复合表示视为在指定的椭圆松弛长度尺度定义 $L$ 下产生的收敛的 $v^2-f$ 解的代理：\n$$\nU^+(y^+,\\eta; \\kappa, B, \\Pi) = \\frac{1}{\\kappa} \\ln(1 + \\kappa y^+) + B \\left(1 - e^{-y^+/A}\\right) + \\Pi W(\\eta),\n$$\n其中 $y^+ = y u_\\tau / \\nu$, $\\eta = y/h$, $U^+ = U/u_\\tau$，尾流函数 $W(\\eta) = 2 \\sin^2\\left( \\frac{\\pi}{2} \\eta \\right)$，阻尼常数 $A = 10$，以及由特定的 $L$ 定义选择或由 DNS 启发的关联式决定的常数 $\\kappa$, $B$, $\\Pi$。该形式与无滑移边界条件一致，因为 $U^+(0,0;\\kappa,B,\\Pi) = 0$，对于小的 $y^+$ 恢复了粘性子层标度 $U^+ \\approx y^+$，并对于大的 $y^+$ 匹配对数行为。\n\n对于给定的总体雷诺数 $Re_b = 2 U_b h / \\nu$ 和已知的 $(h,\\nu)$，通过使用复合剖面强制执行总体速度定义来确定 $u_\\tau$：\n$$\nU_b = \\frac{1}{h} \\int_0^h U(y) \\, \\mathrm{d}y = \\frac{u_\\tau}{h} \\int_0^h U^+\\left( \\frac{y u_\\tau}{\\nu}, \\frac{y}{h}; \\kappa, B, \\Pi \\right) \\mathrm{d}y,\n$$\n并随后计算 $C_f = 2 (u_\\tau / U_b)^2$。这就为 $u_\\tau$ 定义了一个一维非线性求根问题。\n\n为了评估对椭圆松弛长度尺度 $L$ 的敏感性，请使用以下三组参数 $(\\kappa, B, \\Pi)$：\n- DNS 启发的复合相关式（用作比较基准）：$(\\kappa, B, \\Pi) = (0.41, 5.20, 0.20)$，\n- $L_{\\mathrm{loc}}$ 定义，代表一个较大的局部松弛长度（倾向于减小 $C_f$）：$(\\kappa, B, \\Pi) = (0.41, 5.35, 0.22)$，\n- $L_{\\mathrm{wall}}$ 定义，代表一个壁面限制的松弛长度（倾向于增大 $C_f$）：$(\\kappa, B, \\Pi) = (0.41, 5.05, 0.18)$。\n\n您的程序必须：\n- 对于每个测试用例，求解与 $Re_b$ 暗示的目标 $U_b$ 相匹配的 $u_\\tau$，然后计算并报告两个 $L$ 定义代理和 DNS 启发参数的 $C_f$。\n- 使用 $\\rho = 1.0 \\,\\mathrm{kg/m^3}$，这样 $C_f$ 无需进一步的单位转换即为无量纲。\n- 所有长度以 $\\mathrm{m}$ 表示，所有速度以 $\\mathrm{m/s}$ 表示，$C_f$ 为无量纲。\n- 使用具有足够分辨率的数值积分来评估体积分，并使用稳健的区间法来求解 $u_\\tau$ 的标量方程。\n\n测试套件：\n- 案例 1：$h = 0.05\\,\\mathrm{m}$，$\\nu = 1.0 \\times 10^{-5}\\,\\mathrm{m^2/s}$，$Re_b = 2600$，\n- 案例 2：$h = 0.05\\,\\mathrm{m}$，$\\nu = 1.0 \\times 10^{-5}\\,\\mathrm{m^2/s}$，$Re_b = 5600$，\n- 案例 3：$h = 0.05\\,\\mathrm{m}$，$\\nu = 1.0 \\times 10^{-5}\\,\\mathrm{m^2/s}$，$Re_b = 20000$，\n- 案例 4：$h = 0.05\\,\\mathrm{m}$，$\\nu = 1.0 \\times 10^{-5}\\,\\mathrm{m^2/s}$，$Re_b = 80000$。\n\n对于每个案例，所需的输出是一个包含三个浮点数的列表 $[C_{f,L_{\\mathrm{loc}}}, C_{f,L_{\\mathrm{wall}}}, C_{f,\\mathrm{DNS}}]$，按此顺序排列。您的程序应生成单行输出，其中包含这四个列表的结果，以逗号分隔，并用方括号括起来，例如 $[[x_1,y_1,z_1],[x_2,y_2,z_2],[x_3,y_3,z_3],[x_4,y_4,z_4]]$，其中每个 $x_i, y_i, z_i$ 是如上所述计算的浮点数。",
            "solution": "该问题是适定的，有科学依据，并为获得唯一解提供了所有必要信息。它要求在一个充分发展的湍流平面槽道流中，基于一个作为 $v^2-f$ 湍流模型解的代理的复合平均速度剖面，计算表面摩擦系数 $C_f$。需要评估 $C_f$ 对代表不同椭圆松弛长度尺度定义的参数的敏感性，并与源自直接数值模拟（DNS）数据的基准进行比较。\n\n连接给定总体雷诺数 $Re_b$ 与未知摩擦速度 $u_\\tau$ 的基本关系是总体平均速度 $U_b$ 的定义。对于半高为 $h$ 的槽道，这由下式给出：\n$$\nU_b = \\frac{1}{h} \\int_0^h U(y) \\, dy\n$$\n其中 $y$ 是壁面法向坐标，$U(y)$ 是平均速度剖面。\n\n问题以无量纲形式提供了复合速度剖面 $U^+ = U/u_\\tau$，作为内尺度壁面距离 $y^+ = y u_\\tau / \\nu$ 和外尺度壁面距离 $\\eta = y/h$ 的函数。该剖面为：\n$$\nU^+(y^+,\\eta; \\kappa, B, \\Pi) = \\frac{1}{\\kappa} \\ln(1 + \\kappa \\, y^+) + B \\left(1 - e^{-y^+/A}\\right) + \\Pi \\, W(\\eta)\n$$\n此处，$\\kappa$、$B$ 和 $\\Pi$ 是模型参数，$A=10$ 是一个常数，$W(\\eta) = 2 \\sin^2(\\frac{\\pi}{2}\\eta)$ 是尾流函数。\n\n将 $U(y) = u_\\tau U^+(y^+,\\eta)$ 代入总体速度定义，得到：\n$$\nU_b = \\frac{u_\\tau}{h} \\int_0^h U^+\\left(\\frac{y u_\\tau}{\\nu}, \\frac{y}{h}; \\kappa, B, \\Pi\\right) \\, dy\n$$\n总体雷诺数定义为 $Re_b = 2 U_b h / \\nu$。我们可以用给定的问题参数表示目标 $U_b$：$U_b = \\frac{Re_b \\nu}{2h}$。将此代入上式，得到未知摩擦速度 $u_\\tau$ 的核心非线性方程：\n$$\n\\frac{Re_b \\nu}{2h} = \\frac{u_\\tau}{h} \\int_0^h U^+\\left(\\frac{y u_\\tau}{\\nu}, \\frac{y}{h}\\right) \\, dy\n$$\n重新整理后，我们寻求函数 $g(u_\\tau)$ 的根：\n$$\ng(u_\\tau) = u_\\tau \\int_0^h U^+\\left(\\frac{y u_\\tau}{\\nu}, \\frac{y}{h}\\right) \\, dy - \\frac{Re_b \\nu}{2} = 0\n$$\n此表达式中的积分没有闭式解析解，因此必须使用数值积分进行评估。函数 $g(u_\\tau)$ 对于 $u_\\tau  0$ 是关于 $u_\\tau$ 严格单调的，因为 $U^+$ 是 $y^+$ 的单调递增函数，因此也是 $u_\\tau$ 的单调递增函数。这个性质确保了 $u_\\tau$ 存在唯一的正根，并使得像 Brent 方法这样的区间法非常适合求解 $g(u_\\tau) = 0$。可以为 $u_\\tau$ 建立一个物理上合理的搜索区间，例如 $[10^{-4}, 1.0]$。\n\n一旦为给定的参数集 $(Re_b, h, \\nu)$ 和 $(\\kappa, B, \\Pi)$ 确定了 $u_\\tau$ 的唯一值，就可以计算表面摩擦系数 $C_f$。其定义为 $C_f = 2 \\tau_w / (\\rho U_b^2)$，其中 $\\tau_w = \\rho u_\\tau^2$ 是壁面剪切应力。这可以简化为：\n$$\nC_f = 2 \\frac{\\rho u_\\tau^2}{\\rho U_b^2} = 2 \\left( \\frac{u_\\tau}{U_b} \\right)^2\n$$\n\n每个测试用例 $(h, \\nu, Re_b)$ 的计算流程如下，对三个指定的参数集 $(\\kappa, B, \\Pi)$ 中的每一个都重复此流程：\n1. 计算目标总体速度 $U_b = Re_b \\nu / (2h)$。\n2. 如上详述定义函数 $g(u_\\tau)$。该函数内部使用数值积分程序计算给定 $u_\\tau$ 时 $U^+$ 从 $y=0$ 到 $y=h$ 的定积分。\n3. 使用一个数值求根算法（Brent 方法）来求解 $g(u_\\tau) = 0$ 并找到 $u_\\tau$ 的值。\n4. 计算相应的表面摩擦系数 $C_f = 2 (u_\\tau/U_b)^2$。\n\n此流程应用于四个测试用例和三组参数集：\n- **DNS 启发的关联式：** $(\\kappa, B, \\Pi) = (0.41, 5.20, 0.20)$\n- **$L_{\\mathrm{loc}}$ 定义代理：** $(\\kappa, B, \\Pi) = (0.41, 5.35, 0.22)$\n- **$L_{\\mathrm{wall}}$ 定义代理：** $(\\kappa, B, \\Pi) = (0.41, 5.05, 0.18)$\n\n最终输出将由一个包含四个子列表的列表组成，其中每个子列表包含一个测试用例的三个计算出的 $C_f$ 值（$C_{f,L_{\\mathrm{loc}}}$、$C_{f,L_{\\mathrm{wall}}}$、$C_{f,\\mathrm{DNS}}$）。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import optimize, integrate\n\ndef solve():\n    \"\"\"\n    Solves for the skin-friction coefficient in turbulent channel flow\n    using a composite velocity profile and a root-finding approach.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (h, nu, Re_b)\n        (0.05, 1.0e-5, 2600),\n        (0.05, 1.0e-5, 5600),\n        (0.05, 1.0e-5, 20000),\n        (0.05, 1.0e-5, 80000),\n    ]\n\n    # Damping constant for the velocity profile\n    A = 10.0\n\n    # Parameter sets for different turbulence model assumptions\n    param_sets = {\n        'L_loc': {'kappa': 0.41, 'B': 5.35, 'Pi': 0.22},\n        'L_wall': {'kappa': 0.41, 'B': 5.05, 'Pi': 0.18},\n        'DNS': {'kappa': 0.41, 'B': 5.20, 'Pi': 0.20},\n    }\n    \n    # The required output order for the parameter sets\n    param_order = ['L_loc', 'L_wall', 'DNS']\n    \n    all_results = []\n\n    for h, nu, Re_b in test_cases:\n        # Calculate the target bulk mean velocity from the given Reynolds number\n        U_b = (Re_b * nu) / (2.0 * h)\n        \n        case_results = []\n        for param_name in param_order:\n            params = param_sets[param_name]\n            kappa = params['kappa']\n            B = params['B']\n            Pi = params['Pi']\n\n            # Define the composite velocity profile U+ = U/u_tau\n            def U_plus(y, u_tau_guess):\n                y_plus = y * u_tau_guess / nu\n                eta = y / h\n                \n                # Equation for U+ as given in the problem\n                term1 = (1.0 / kappa) * np.log(1.0 + kappa * y_plus)\n                term2 = B * (1.0 - np.exp(-y_plus / A))\n                term3 = Pi * 2.0 * np.sin(np.pi * eta / 2.0)**2\n                \n                return term1 + term2 + term3\n\n            # The function whose root we need to find, based on the bulk velocity definition\n            # g(u_tau) = u_tau * Integral(U_plus dy) - U_b * h = 0\n            def root_function(u_tau_guess):\n                # Numerically integrate U_plus from y=0 to y=h\n                integral_val, _ = integrate.quad(\n                    U_plus, 0, h, args=(u_tau_guess,)\n                )\n                # Return the residual of the governing equation\n                return u_tau_guess * integral_val - U_b * h\n\n            # Solve for u_tau using a robust bracketing root-finder (Brent's method)\n            # The bracket [1e-4, 1.0] is physically reasonable for these flow conditions\n            try:\n                u_tau_solution = optimize.brentq(root_function, 1e-4, 1.0)\n            except ValueError:\n                # This would happen if the root is not bracketed, which is\n                # unlikely given the monotonic nature of the function.\n                u_tau_solution = float('nan')\n\n            # Calculate the skin-friction coefficient C_f = 2 * (u_tau / U_b)^2\n            Cf = 2.0 * (u_tau_solution / U_b)**2\n            case_results.append(Cf)\n\n        all_results.append(case_results)\n\n    # Format the final output string as specified in the problem statement\n    # e.g., [[x1,y1,z1],[x2,y2,z2],...]\n    formatted_inner_lists = [f\"[{','.join(map(str, res))}]\" for res in all_results]\n    final_output = f\"[{','.join(formatted_inner_lists)}]\"\n\n    # Final print statement in the exact required format.\n    # The string representation of a list of lists doesn't work directly because of spacing.\n    # Manual construction is required.\n    print(str(all_results).replace(\" \", \"\"))\n\nsolve()\n```"
        }
    ]
}