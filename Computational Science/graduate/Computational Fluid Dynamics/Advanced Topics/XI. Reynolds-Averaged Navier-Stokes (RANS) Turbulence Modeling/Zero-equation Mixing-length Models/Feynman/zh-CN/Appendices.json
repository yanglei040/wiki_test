{
    "hands_on_practices": [
        {
            "introduction": "从基础理论转向实际应用，我们现在来探讨计算流体力学 (CFD) 的一个基石：壁面模型。作为混合长度理论在惯性子层中的直接成果，壁面律的对数律提供了一种优雅的方法，可以避免对近壁区域进行成本高昂的精细解析。本练习要求您推导出一个“壁面函数”——这是一种在几乎所有工业雷诺平均模拟 (RANS) 中都至关重要的算法——以根据第一个离壁网格单元中的速度值来计算壁面剪切应力 。",
            "id": "3392562",
            "problem": "考虑在计算流体动力学 (CFD) 中，使用零方程混合长度方法研究流经光滑平壁的稳态、不可压缩、充分发展的湍流。设第一个离壁计算单元的近壁中心距离壁面的法向距离为 $y_{P} > 0$，此处的平均流向速度为 $U_{P} > 0$。流体密度 $\\rho > 0$ 和运动粘度 $\\nu > 0$ 是已知常数。摩阻速度定义为 $u_{\\tau} = \\sqrt{\\tau_{w}/\\rho}$，其中 $\\tau_{w}$ 是壁面剪切应力。引入内尺度变量 $U^{+} = U/u_{\\tau}$ 和 $y^{+} = y\\,u_{\\tau}/\\nu$。在光滑壁面平衡湍流边界层的惯性（对数）区域中，平均速度满足对数律 $U^{+} = (1/\\kappa)\\,\\ln(y^{+}) + B$，其中 $\\kappa > 0$ 是 von Kármán 常数，B 是光滑壁面附加常数。\n\n从上述定义和经过充分检验的公式出发，通过在位置 $y=y_{P}$ 和 $U=U_{P}$ 处反解对数律，推导出以 $U_{P}$、$y_{P}$、$\\rho$、$\\nu$、$\\kappa$ 和 $B$ 表示的 $\\tau_{w}$ 的闭式解析表达式。你可以使用由 $W(z)\\,\\exp(W(z)) = z$ 隐式定义的 Lambert W 函数（也称为乘积对数）来表示最终结果。请以符号形式给出 $\\tau_{w}$ 的最终表达式。此外，请说明在光滑壁面上应用零方程混合长度模型时，此壁面函数关系在何种物理上合适的 $y_{P}^{+}$ 范围内有效。如果需要对 Lambert W 函数进行分支选择，请说明物理上一致的选择。最终答案必须是 $\\tau_{w}$ 的一个单一闭式解析表达式；不要提供数值。单位是隐含地与 $\\tau_{w}$ 相关联的国际单位制基本单位（帕斯卡）。",
            "solution": "本题要求基于应用于光滑壁面邻近的第一个计算单元中心的壁面湍流对数律（对数律），推导壁面剪切应力 $\\tau_w$ 的闭式解析表达式。解将用给定的物理量和模型常数表示。推导过程是通过反解对数律来求解摩阻速度 $u_{\\tau}$，并随后求解 $\\tau_w$。\n\n给定的条件是：\n-   在法向距离 $y_P > 0$ 处的平均流向速度 $U_P > 0$。\n-   流体密度 $\\rho > 0$ 和运动粘度 $\\nu > 0$。\n-   von Kármán 常数 $\\kappa > 0$ 和光滑壁面附加常数 $B$。\n-   内尺度变量的定义：$U^{+} = U/u_{\\tau}$ 和 $y^{+} = y u_{\\tau}/\\nu$。\n-   摩阻速度的定义：$u_{\\tau} = \\sqrt{\\tau_{w}/\\rho}$。\n-   惯性区域中平均速度剖面的对数律：$U^{+} = \\frac{1}{\\kappa}\\ln(y^{+}) + B$。\n-   Lambert W 函数的定义：$W(z)\\exp(W(z)) = z$。\n\n推导始于将对数律应用于指定点 $P$，在该点 $U = U_P$ 且 $y = y_P$。用内尺度变量表示，即为 $U_P^{+} = U_P/u_{\\tau}$ 和 $y_P^{+} = y_P u_{\\tau}/\\nu$。将这些代入对数律，得到：\n$$\n\\frac{U_P}{u_{\\tau}} = \\frac{1}{\\kappa} \\ln\\left(\\frac{y_P u_{\\tau}}{\\nu}\\right) + B\n$$\n这是一个关于未知摩阻速度 $u_{\\tau}$ 的超越方程。我们的目标是求解 $u_{\\tau}$。为此，我们将方程重新整理成可以使用 Lambert W 函数求解的形式。\n\n首先，我们分离对数项：\n$$\n\\frac{U_P}{u_{\\tau}} - B = \\frac{1}{\\kappa} \\ln\\left(\\frac{y_P u_{\\tau}}{\\nu}\\right)\n$$\n两边乘以 $\\kappa$ 得：\n$$\n\\kappa \\frac{U_P}{u_{\\tau}} - \\kappa B = \\ln\\left(\\frac{y_P u_{\\tau}}{\\nu}\\right)\n$$\n为消除对数，我们对等式两边取指数：\n$$\n\\exp\\left(\\kappa \\frac{U_P}{u_{\\tau}} - \\kappa B\\right) = \\frac{y_P u_{\\tau}}{\\nu}\n$$\n使用性质 $\\exp(a-b) = \\exp(a)\\exp(-b)$，我们可以写成：\n$$\n\\exp\\left(\\kappa \\frac{U_P}{u_{\\tau}}\\right) \\exp(-\\kappa B) = \\frac{y_P u_{\\tau}}{\\nu}\n$$\n现在我们重新整理这个方程，将所有涉及 $u_{\\tau}$ 的项组合在一起，以匹配 Lambert W 函数所要求的结构。我们希望得到 $A\\exp(A) = C$ 的形式，其中 $A$ 是 $u_{\\tau}$ 的函数，$C$ 是从已知参数导出的常数。\n$$\n\\exp\\left(\\kappa \\frac{U_P}{u_{\\tau}}\\right) = \\frac{y_P u_{\\tau}}{\\nu} \\exp(\\kappa B)\n$$\n为了构造 $A\\exp(A)$ 的形式，我们可以分离常数项。定义一个变量 $A = \\kappa \\frac{U_P}{u_{\\tau}}$ 会很有帮助。根据这个定义，我们可以看到需要将方程乘以 $A$ 来构造 $A \\exp(A)$。首先，我们将 $u_{\\tau}$ 移到左侧，稍作改写方程：\n$$\n\\frac{1}{u_{\\tau}} \\exp\\left(\\frac{\\kappa U_P}{u_{\\tau}}\\right) = \\frac{y_P}{\\nu} \\exp(\\kappa B)\n$$\n现在，两边都乘以 $\\kappa U_P$：\n$$\n\\left(\\frac{\\kappa U_P}{u_{\\tau}}\\right) \\exp\\left(\\frac{\\kappa U_P}{u_{\\tau}}\\right) = \\frac{y_P \\kappa U_P}{\\nu} \\exp(\\kappa B)\n$$\n这个方程现在精确地是 $A \\exp(A) = C$ 的形式，其中：\n$$\nA = \\frac{\\kappa U_P}{u_{\\tau}}\n$$\n$$\nC = \\frac{y_P \\kappa U_P}{\\nu} \\exp(\\kappa B)\n$$\n$A$ 的解由 Lambert W 函数给出：\n$$\nA = W(C)\n$$\n代入 $A$ 和 $C$ 的表达式：\n$$\n\\frac{\\kappa U_P}{u_{\\tau}} = W\\left(\\frac{y_P \\kappa U_P}{\\nu} \\exp(\\kappa B)\\right)\n$$\n题目说明 $y_P > 0$，$\\kappa > 0$，$U_P > 0$，$\\nu > 0$ 且 $\\rho > 0$。常数 $B$ 也是正的（通常 $B \\approx 5.2$）。因此，Lambert W 函数的自变量 $C$ 严格为正。对于正的自变量，Lambert W 函数只有一个实值分支，即主分支，记为 $W_0(z)$ 或简写为 $W(z)$。这意味着存在一个唯一的、具有物理意义的 $u_{\\tau}$ 解。因此，物理上一致的选择是 Lambert W 函数的主分支。\n\n现在，我们求解 $u_{\\tau}$：\n$$\nu_{\\tau} = \\frac{\\kappa U_P}{W\\left(\\frac{y_P \\kappa U_P}{\\nu} \\exp(\\kappa B)\\right)}\n$$\n最后，我们可以使用壁面剪切应力 $\\tau_w$ 以摩阻速度表示的定义 $\\tau_w = \\rho u_{\\tau}^2$ 来求得它：\n$$\n\\tau_w = \\rho \\left( \\frac{\\kappa U_P}{W\\left(\\frac{y_P \\kappa U_P}{\\nu} \\exp(\\kappa B)\\right)} \\right)^2\n$$\n化简为：\n$$\n\\tau_w = \\rho \\frac{\\left(\\kappa U_P\\right)^2}{\\left[ W\\left(\\frac{y_P \\kappa U_P}{\\nu} \\exp(\\kappa B)\\right) \\right]^2}\n$$\n这就是 $\\tau_w$ 的闭式解析表达式。\n\n关于此关系式在物理上合适的 $y_P^{+}$ 范围，对数律是湍流边界层中惯性子层（或对数区域）内有效的渐近近似。该区域通常被定义为无量纲壁面距离 $y^{+}$ 足够远离壁面，以至于处于粘性子层（$y^{+}  5$）和缓冲层（$5  y^{+}  30$）之外，但又足够近以至于不受边界层外部尾流区的影响。对数律有效性，以及因此该壁面函数应用的通常被接受的范围是 $30 \\lesssim y_P^{+} \\lesssim 500$。在实践中，使用此类壁面函数的 CFD 代码要求壁面附近的网格足够粗糙，以使第一个单元中心 $y_P$ 落入此范围内。",
            "answer": "$$\n\\boxed{\\rho \\frac{\\left(\\kappa U_P\\right)^2}{\\left[ W\\left(\\frac{y_P \\kappa U_P}{\\nu} \\exp(\\kappa B)\\right) \\right]^2}}\n$$"
        },
        {
            "introduction": "模型的优劣取决于其参数的准确性，但这些参数从何而来？最后的这个实践将理论性的混合长度模型与高保真数据的经验世界联系起来。您将使用湍流槽道流的直接数值模拟 (DNS) 数据来校准对数律的两个关键参数：von Kármán 常数 $\\kappa$ 和截距 $B$。这个练习展示了模型验证和参数拟合的基本过程，突显了 RANS 闭合模型的半经验性质 。",
            "id": "3392611",
            "problem": "您的任务是推导并在完全发展的湍流槽道流中实现一个零方程混合长度模型，并使用最小二乘法拟合以壁面单位表示的无量纲平均速度。目标是根据给定的直接数值模拟（DNS）数据，估算冯·卡门常数和壁面律对数律的截距。本问题中的所有物理量均以壁面单位进行无量纲化，因此输出结果将是无单位的。\n\n从基本原理出发：稳态、完全发展、不可压缩的槽道流遵循雷诺平均的流向动量平衡，其中总剪切应力为常数，并采用 Boussinesq 涡粘性假设，其中混合长度与壁面距离成正比。利用这些基础，推导以壁面单位表示的平均速度作为壁面法向坐标（同样以壁面单位表示）的函数模型。请勿假设或引入任何无法从上述原理推导出的模型表达式。\n\n然后，给定摩擦雷诺数 $Re_{\\tau}=395$ 下的 DNS 平均速度剖面，通过最小化在 $50  y^{+}  300$ 的范围内的残差平方和，确定 $\\kappa$ 和 $B$ 的最佳拟合值。请对每个提供的测试用例执行此操作。",
            "solution": "### 第 1 部分：对数速度剖面的推导\n\n推导始于用于稳态、完全发展、不可压缩湍流槽道流的雷诺平均纳维-斯托克斯（RANS）方程。\n\n$1$. **总剪切应力剖面**：对于这种流动，流向动量方程简化为平均压力梯度与总剪切应力 $\\tau_{total}$ 的散度之间的平衡。问题陈述指示我们假设“总剪切应力恒定”。这是近壁区域（“恒应力层”）的标准近似，在该区域，总应力约等于壁面处的应力 $\\tau_w$。\n$$\n\\tau_{total}(y) \\approx \\tau_w\n$$\n在壁面单位中，物理量通过摩擦速度 $u_{\\tau} = \\sqrt{\\tau_w/\\rho}$ 和粘性长度尺度 $\\delta_{\\nu} = \\nu/u_{\\tau}$ 进行无量纲化，上式变为：\n$$\n\\tau_{total}^{+} = \\frac{\\tau_{total}}{\\tau_w} = 1\n$$\n\n$2$. **Boussinesq 假设**：总剪切应力是粘性应力 $\\tau_{visc}$ 和湍流雷诺应力 $\\tau_{turb}$ 的和：\n$$\n\\tau_{total} = \\tau_{visc} + \\tau_{turb} = \\mu \\frac{dU}{dy} - \\rho \\overline{u'v'}\n$$\n此处，$U$ 是平均速度，$\\mu$ 是动力粘度，$\\rho$ 是密度，$-\\rho \\overline{u'v'}$ 是雷诺剪切应力。Boussinesq 假设使用涡粘性 $\\mu_t$ 来类比粘性应力，对雷诺应力进行建模：\n$$\n-\\rho \\overline{u'v'} = \\mu_t \\frac{dU}{dy}\n$$\n于是总应力表示为：\n$$\n\\tau_{total} = (\\mu + \\mu_t) \\frac{dU}{dy}\n$$\n用运动粘度 $\\nu = \\mu/\\rho$ 和 $\\nu_t = \\mu_t/\\rho$ 表示，并在壁面单位下，该表达式变为：\n$$\n\\tau_{total}^{+} = \\left(1 + \\frac{\\nu_t}{\\nu}\\right) \\frac{dU^{+}}{dy^{+}}\n$$\n其中 $U^{+} = U/u_{\\tau}$ 且 $y^{+} = y u_{\\tau}/\\nu$。\n\n$3$. **混合长度模型**：问题指定了一个零方程混合长度模型，其中混合长度 $l_m$ 与到壁面的距离 $y$ 成正比。这是 Prandtl 对于近壁区域的混合长度假设：\n$$\nl_m = \\kappa y\n$$\n此处，$\\kappa$ 是冯·卡门常数。涡粘性 $\\nu_t$ 通过以下关系与混合长度和平均速度梯度相关联：\n$$\n\\nu_t = l_m^2 \\left| \\frac{dU}{dy} \\right|\n$$\n对于底壁上的边界层，$dU/dy > 0$，因此上式简化为：\n$$\n\\nu_t = (\\kappa y)^2 \\frac{dU}{dy}\n$$\n\n$4$. **组合模型**：我们关心的是对数层，其拟合范围由 $50  y^{+}  300$ 指定。在此区域内，湍流输运主导粘性效应，意味着 $\\tau_{turb} \\gg \\tau_{visc}$，或等效地，$\\nu_t \\gg \\nu$。因此，我们可以将应力关系近似为：\n$$\n\\tau_{total}^{+} \\approx \\frac{\\nu_t}{\\nu} \\frac{dU^{+}}{dy^{+}}\n$$\n根据我们的初始假设，令 $\\tau_{total}^{+} = 1$：\n$$\n1 \\approx \\frac{\\nu_t}{\\nu} \\frac{dU^{+}}{dy^{+}}\n$$\n现在，代入 $\\nu_t$ 的混合长度表达式：\n$$\n\\nu_t = (\\kappa y)^2 \\frac{dU}{dy} = (\\kappa y)^2 \\left(\\frac{u_{\\tau}^2}{\\nu} \\frac{dU^{+}}{dy^{+}}\\right)\n$$\n将此代入应力方程得到：\n$$\n1 \\approx \\frac{1}{\\nu} \\left[ (\\kappa y)^2 \\frac{u_{\\tau}^2}{\\nu} \\frac{dU^{+}}{dy^{+}} \\right] \\frac{dU^{+}}{dy^{+}} = \\left( \\frac{\\kappa y u_{\\tau}}{\\nu} \\right)^2 \\left( \\frac{dU^{+}}{dy^{+}} \\right)^2\n$$\n认识到 $y^{+} = y u_{\\tau}/\\nu$，我们有：\n$$\n1 \\approx (\\kappa y^{+})^2 \\left( \\frac{dU^{+}}{dy^{+}} \\right)^2\n$$\n取正平方根（因为 $dU^{+}/dy^{+} > 0$）：\n$$\n1 = \\kappa y^{+} \\frac{dU^{+}}{dy^{+}}\n$$\n这是一个关于 $U^{+}(y^{+})$ 的一阶常微分方程。\n\n$5$. **求解速度剖面**：我们通过分离变量法求解：\n$$\ndU^{+} = \\frac{1}{\\kappa} \\frac{dy^{+}}{y^{+}}\n$$\n积分得到著名的壁面律对数律：\n$$\n\\int dU^{+} = \\frac{1}{\\kappa} \\int \\frac{1}{y^{+}} dy^{+} \\implies U^{+}(y^{+}) = \\frac{1}{\\kappa} \\ln(y^{+}) + B\n$$\n其中 $B$ 是积分常数，称为对数律截距。\n\n### 第 2 部分：最小二乘参数估计\n\n推导出的模型 $U^{+} = \\frac{1}{\\kappa} \\ln(y^{+}) + B$ 在变换坐标 $X = \\ln(y^{+})$ 下是线性的。令 $Y = U^{+}$，$m = 1/\\kappa$，$c = B$。模型就变成一个简单的线性方程：\n$$\nY = mX + c\n$$\n我们的任务是找到最能拟合所提供 DNS 数据 $(y_i^{+}, U_{i, \\mathrm{DNS}}^{+})$ 的参数 $\\kappa$ 和 $B$。这是一个标准的线性回归问题。我们寻求使残差平方和 $S$ 最小化的斜率 $m$ 和截距 $c$：\n$$\nS(m, c) = \\sum_{i} \\left( U_{i, \\mathrm{DNS}}^{+} - \\left(m \\ln(y_i^{+}) + c\\right) \\right)^2\n$$\n这个问题通过构建一个法方程组来解决。给定一组 $N$ 个数据点，我们可以建立一个最小二乘意义下的矩阵方程 $A \\mathbf{x} = \\mathbf{b}$，其中：\n$$\nA = \\begin{pmatrix}\n\\ln(y_1^{+})  1 \\\\\n\\ln(y_2^{+})  1 \\\\\n\\vdots  \\vdots \\\\\n\\ln(y_N^{+})  1\n\\end{pmatrix}, \\quad\n\\mathbf{x} = \\begin{pmatrix} m \\\\ c \\end{pmatrix}, \\quad\n\\mathbf{b} = \\begin{pmatrix}\nU_{1, \\mathrm{DNS}}^{+} \\\\\nU_{2, \\mathrm{DNS}}^{+} \\\\\n\\vdots \\\\\nU_{N, \\mathrm{DNS}}^{+}\n\\end{pmatrix}\n$$\n包含最佳拟合参数 $(m, c)$ 的解向量 $\\mathbf{x}$ 可以使用标准数值库可靠地计算出来。一旦找到 $m$ 和 $c$，物理参数可恢复为：\n$$\n\\kappa = \\frac{1}{m} \\quad \\text{和} \\quad B = c\n$$",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and fits a zero-equation mixing-length model to DNS data.\n\n    The function implements a least-squares fit to estimate the von Kármán\n    constant (kappa) and the log-law intercept (B) from given mean velocity\n    profiles in a turbulent channel flow, as per the problem description.\n    The model U+ = (1/kappa) * ln(y+) + B is used, which is linearized by\n    setting Y = U+, X = ln(y+), slope m = 1/kappa, and intercept c = B.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test Case 1: Nominal log-layer-like profile\n        (\n            [55, 70, 85, 100, 120, 140, 160, 180, 200, 230, 260, 300],\n            [14.764, 15.344, 15.822, 16.224, 16.665, 17.026, 17.359, 17.645, 17.905, 18.243, 18.536, 18.897]\n        ),\n        # Test Case 2: Small oscillatory deviations\n        (\n            [55, 70, 85, 100, 120, 140, 160, 180, 200, 230, 260, 300],\n            [14.844, 15.444, 15.872, 16.244, 16.665, 16.996, 17.309, 17.625, 17.915, 18.283, 18.596, 18.977]\n        ),\n        # Test Case 3: Mild outer-layer curvature\n        (\n            [55, 70, 85, 100, 120, 140, 160, 180, 200, 230, 260, 300],\n            [14.790, 15.376, 15.860, 16.268, 16.716, 17.085, 17.424, 17.716, 17.981, 18.326, 18.625, 18.992]\n        ),\n        # Test Case 4: Boundary case with minimum samples\n        (\n            [55, 300],\n            [15.085, 19.439]\n        )\n    ]\n\n    results = []\n    for y_plus_data, U_plus_data in test_cases:\n        y_plus = np.array(y_plus_data)\n        U_plus = np.array(U_plus_data)\n\n        # Transform data for linear regression: X = ln(y+), Y = U+\n        X = np.log(y_plus)\n        Y = U_plus\n\n        # Set up the Vandermonde-like matrix A for the linear system A*x = Y\n        # where x = [slope, intercept]^T.\n        # This is equivalent to finding m and c in Y = m*X + c.\n        A = np.vstack([X, np.ones(len(X))]).T\n\n        # Solve the least-squares problem to find the slope (m) and intercept (c)\n        m, c = np.linalg.lstsq(A, Y, rcond=None)[0]\n\n        # Calculate kappa and B from the fitted slope and intercept\n        # m = 1/kappa, c = B\n        kappa = 1.0 / m\n        B = c\n        \n        # Round the results to four decimal places as required\n        kappa_rounded = round(kappa, 4)\n        B_rounded = round(B, 4)\n        \n        results.append(f\"[{kappa_rounded:.4f},{B_rounded:.4f}]\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}