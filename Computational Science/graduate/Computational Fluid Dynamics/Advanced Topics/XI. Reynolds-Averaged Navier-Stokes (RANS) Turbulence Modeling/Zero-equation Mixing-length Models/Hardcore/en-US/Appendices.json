{
    "hands_on_practices": [
        {
            "introduction": "To build a solid foundation, our first practice starts with the basics. This exercise challenges you to derive the expression for eddy viscosity, $\\nu_t$, from the core assumptions of Prandtl's mixing-length model in a simplified shear flow . By directly connecting the mixing length, $l_m$, and the mean velocity gradient to the resulting turbulent viscosity, you will reinforce your understanding of the fundamental mechanism of this zero-equation model.",
            "id": "3392581",
            "problem": "Consider a statistically steady, incompressible, plane shear flow of a constant-density fluid with mean velocity $U(y)$ varying only in the wall-normal coordinate $y$. Let the Reynolds-averaged streamwise momentum be modeled using the Boussinesq eddy-viscosity hypothesis and Prandtl’s zero-equation mixing-length concept. Assume the mean shear is uniform, $dU/dy = S_0$, where $S_0$ is a real constant, and the mixing length distribution is $l_m(y) = C y$, where $C$ is a positive dimensionless constant. \n\nStarting from (i) the Reynolds decomposition and definition of turbulent shear stress $-\\overline{u'v'}$, (ii) the Boussinesq eddy-viscosity hypothesis relating $-\\overline{u'v'}$ to the mean shear through a kinematic eddy viscosity, and (iii) the mixing-length idea that relates velocity fluctuations to the local mean gradient over a characteristic length scale $l_m(y)$, derive an expression for the kinematic eddy viscosity $\\nu_t(y)$ in terms of $y$, $C$, and $S_0$. Then, analyze the scaling of $\\nu_t(y)$ relative to the molecular kinematic viscosity $\\nu$ as $y$ increases, and determine the functional form of the ratio $\\nu_t(y)/\\nu$. \n\nReport your final answer as a single closed-form analytic expression for the dimensionless ratio $\\nu_t(y)/\\nu$. No numerical evaluation is required. If absolute values are needed to ensure physical realizability (nonnegative eddy viscosity), include them explicitly. Express the final ratio in dimensionless form; no units are required in the final boxed answer.",
            "solution": "The problem requires the derivation of the kinematic eddy viscosity $\\nu_t(y)$ and its ratio to the molecular kinematic viscosity $\\nu$. The derivation follows from the three principles given.\n\n1.  **Boussinesq Hypothesis:** The turbulent shear stress is related to the mean shear rate via the eddy viscosity:\n    $$\n    -\\rho \\overline{u'v'} = \\rho \\nu_t \\frac{dU}{dy}\n    $$\n    Dividing by density $\\rho$, we get the kinematic relationship:\n    $$\n    -\\overline{u'v'} = \\nu_t \\frac{dU}{dy}\n    $$\n\n2.  **Prandtl's Mixing-Length Hypothesis:** This provides a model for the eddy viscosity. The characteristic velocity fluctuations $u'$ and $v'$ are assumed to be proportional to the change in mean velocity over the mixing length $l_m$:\n    $$\n    u' \\sim v' \\sim l_m \\left| \\frac{dU}{dy} \\right|\n    $$\n    The turbulent shear stress is therefore modeled as being proportional to $\\rho l_m^2 (dU/dy)^2$. Equating the Boussinesq form with this scaling leads to the model for $\\nu_t$:\n    $$\n    \\nu_t = l_m^2 \\left| \\frac{dU}{dy} \\right|\n    $$\n    The absolute value is crucial to ensure that the eddy viscosity $\\nu_t$ is always non-negative, a fundamental physical realizability constraint.\n\n3.  **Applying the Given Conditions:** The problem specifies the mean shear and mixing length distributions:\n    *   Mean shear: $\\frac{dU}{dy} = S_0$ (a constant)\n    *   Mixing length: $l_m(y) = C y$ (where $C > 0$)\n\n    Substituting these into the mixing-length formula for $\\nu_t$:\n    $$\n    \\nu_t(y) = (C y)^2 |S_0| = C^2 y^2 |S_0|\n    $$\n    This is the expression for the kinematic eddy viscosity as a function of $y$, $C$, and $S_0$.\n\n4.  **Dimensionless Ratio:** The final step is to find the ratio of the eddy viscosity to the molecular kinematic viscosity, $\\nu$:\n    $$\n    \\frac{\\nu_t(y)}{\\nu} = \\frac{C^2 y^2 |S_0|}{\\nu}\n    $$\n    This dimensionless ratio shows that, according to this simple model, the turbulent viscosity grows quadratically with the distance from the wall, $y$. As $y$ increases, the ratio $\\nu_t/\\nu$ also increases, indicating the growing dominance of turbulent transport over molecular transport.",
            "answer": "$$\\boxed{\\frac{C^{2} y^{2} |S_0|}{\\nu}}$$"
        },
        {
            "introduction": "Building on the fundamentals, we now turn to a critical application in computational fluid dynamics: the wall function. This practice requires you to derive an analytical expression for wall shear stress, $\\tau_w$, by inverting the famous logarithmic law of the wall . This procedure is essential for modeling high-Reynolds-number wall-bounded flows efficiently, allowing us to bypass the need to resolve the fine scales within the viscous sublayer.",
            "id": "3392562",
            "problem": "Consider a steady, incompressible, fully developed turbulent flow over a smooth flat wall in Computational Fluid Dynamics (CFD) using a zero-equation mixing-length approach. Let the near-wall center of the first off-wall computational cell be at a wall-normal distance $y_{P}  0$ from the wall, where the mean streamwise velocity is $U_{P}  0$. The fluid density $\\rho  0$ and kinematic viscosity $\\nu  0$ are known constants. The friction velocity is defined by $u_{\\tau} = \\sqrt{\\tau_{w}/\\rho}$, where $\\tau_{w}$ is the wall shear stress. Introduce the inner-scaled variables $U^{+} = U/u_{\\tau}$ and $y^{+} = y\\,u_{\\tau}/\\nu$. In the inertial (logarithmic) region of a smooth-wall equilibrium turbulent boundary layer, the mean velocity satisfies the log law $U^{+} = (1/\\kappa)\\,\\ln(y^{+}) + B$, where $\\kappa  0$ is the von Kármán constant and $B$ is the smooth-wall additive constant.\n\nStarting from the above definitions and well-tested formulas, derive a closed-form analytic expression for $\\tau_{w}$ in terms of $U_{P}$, $y_{P}$, $\\rho$, $\\nu$, $\\kappa$, and $B$ by inverting the log law at the location $y=y_{P}$ and $U=U_{P}$. You may use the Lambert $W$ function (also known as the Product Log), defined implicitly by $W(z)\\,\\exp(W(z)) = z$, to express the final result. Provide your final expression for $\\tau_{w}$ in symbolic form. In addition, state the physically appropriate range of $y_{P}^{+}$ under which this wall-function relation is valid for zero-equation mixing-length models applied at smooth walls. If any branch selection of the Lambert $W$ function is required, state the physically consistent choice. The final answer must be a single closed-form analytic expression for $\\tau_{w}$; do not provide a numerical value. Units are SI base units (pascals) implicitly associated with $\\tau_{w}$.",
            "solution": "The problem requires the derivation of a closed-form analytic expression for the wall shear stress, $\\tau_w$, based on the logarithmic law of the wall (log law) applied at the center of the first computational cell adjacent to a smooth wall. The solution will be expressed in terms of the given physical quantities and model constants. The derivation proceeds by inverting the log law to solve for the friction velocity, $u_{\\tau}$, and subsequently for $\\tau_w$.\n\nThe givens are:\n-   The mean streamwise velocity $U_P  0$ at a wall-normal distance $y_P  0$.\n-   The fluid density $\\rho  0$ and kinematic viscosity $\\nu  0$.\n-   The von Kármán constant $\\kappa  0$ and the smooth-wall additive constant $B$.\n-   The definitions of inner-scaled variables: $U^{+} = U/u_{\\tau}$ and $y^{+} = y u_{\\tau}/\\nu$.\n-   The definition of the friction velocity: $u_{\\tau} = \\sqrt{\\tau_{w}/\\rho}$.\n-   The log law for the mean velocity profile in the inertial region: $U^{+} = \\frac{1}{\\kappa}\\ln(y^{+}) + B$.\n-   The definition of the Lambert $W$ function: $W(z)\\exp(W(z)) = z$.\n\nThe derivation begins by applying the log law at the specified point $P$, where $U = U_P$ and $y = y_P$. In inner-scaled variables, this is $U_P^{+} = U_P/u_{\\tau}$ and $y_P^{+} = y_P u_{\\tau}/\\nu$. Substituting these into the log law gives:\n$$\n\\frac{U_P}{u_{\\tau}} = \\frac{1}{\\kappa} \\ln\\left(\\frac{y_P u_{\\tau}}{\\nu}\\right) + B\n$$\nThis is a transcendental equation for the unknown friction velocity $u_{\\tau}$. Our goal is to solve for $u_{\\tau}$. To do this, we will rearrange the equation into a form that can be solved using the Lambert $W$ function.\n\nFirst, we isolate the logarithmic term:\n$$\n\\frac{U_P}{u_{\\tau}} - B = \\frac{1}{\\kappa} \\ln\\left(\\frac{y_P u_{\\tau}}{\\nu}\\right)\n$$\nMultiplying by $\\kappa$ yields:\n$$\n\\kappa \\frac{U_P}{u_{\\tau}} - \\kappa B = \\ln\\left(\\frac{y_P u_{\\tau}}{\\nu}\\right)\n$$\nTo eliminate the logarithm, we exponentiate both sides of the equation:\n$$\n\\exp\\left(\\kappa \\frac{U_P}{u_{\\tau}} - \\kappa B\\right) = \\frac{y_P u_{\\tau}}{\\nu}\n$$\nUsing the property $\\exp(a-b) = \\exp(a)\\exp(-b)$, we can write:\n$$\n\\exp\\left(\\kappa \\frac{U_P}{u_{\\tau}}\\right) \\exp(-\\kappa B) = \\frac{y_P u_{\\tau}}{\\nu}\n$$\nWe now rearrange this equation to group all terms involving $u_{\\tau}$ and match the structure required by the Lambert $W$ function. We wish to achieve the form $A\\exp(A) = C$, where $A$ is a function of $u_{\\tau}$ and $C$ is a constant derived from the known parameters.\n$$\n\\exp\\left(\\kappa \\frac{U_P}{u_{\\tau}}\\right) = \\frac{y_P u_{\\tau}}{\\nu} \\exp(\\kappa B)\n$$\nTo create the $A\\exp(A)$ form, we can isolate the constant terms. It is helpful to define a variable $A = \\kappa \\frac{U_P}{u_{\\tau}}$. With this definition, we can see that we need to multiply the equation by $A$ to create $A \\exp(A)$. First, we rewrite the equation slightly by moving $u_{\\tau}$ to the left side:\n$$\n\\frac{1}{u_{\\tau}} \\exp\\left(\\frac{\\kappa U_P}{u_{\\tau}}\\right) = \\frac{y_P}{\\nu} \\exp(\\kappa B)\n$$\nNow multiply both sides by $\\kappa U_P$:\n$$\n\\left(\\frac{\\kappa U_P}{u_{\\tau}}\\right) \\exp\\left(\\frac{\\kappa U_P}{u_{\\tau}}\\right) = \\frac{y_P \\kappa U_P}{\\nu} \\exp(\\kappa B)\n$$\nThis equation is now precisely in the form $A \\exp(A) = C$, where:\n$$\nA = \\frac{\\kappa U_P}{u_{\\tau}}\n$$\n$$\nC = \\frac{y_P \\kappa U_P}{\\nu} \\exp(\\kappa B)\n$$\nThe solution for $A$ is given by the Lambert $W$ function:\n$$\nA = W(C)\n$$\nSubstituting the expressions for $A$ and $C$:\n$$\n\\frac{\\kappa U_P}{u_{\\tau}} = W\\left(\\frac{y_P \\kappa U_P}{\\nu} \\exp(\\kappa B)\\right)\n$$\nThe problem states that $y_P  0$, $\\kappa  0$, $U_P  0$, $\\nu  0$, and $\\rho  0$. The constant $B$ is also positive (typically $B \\approx 5.2$). Therefore, the argument of the Lambert $W$ function, $C$, is strictly positive. For a positive argument, the Lambert $W$ function has a single real-valued branch, the principal branch, denoted $W_0(z)$ or simply $W(z)$. This means a unique physically meaningful solution for $u_{\\tau}$ exists. Thus, the physically consistent choice is the principal branch of the Lambert $W$ function.\n\nNow, we solve for $u_{\\tau}$:\n$$\nu_{\\tau} = \\frac{\\kappa U_P}{W\\left(\\frac{y_P \\kappa U_P}{\\nu} \\exp(\\kappa B)\\right)}\n$$\nFinally, we can find the wall shear stress $\\tau_w$ using its definition in terms of the friction velocity, $\\tau_w = \\rho u_{\\tau}^2$:\n$$\n\\tau_w = \\rho \\left( \\frac{\\kappa U_P}{W\\left(\\frac{y_P \\kappa U_P}{\\nu} \\exp(\\kappa B)\\right)} \\right)^2\n$$\nThis simplifies to:\n$$\n\\tau_w = \\rho \\frac{\\left(\\kappa U_P\\right)^2}{\\left[ W\\left(\\frac{y_P \\kappa U_P}{\\nu} \\exp(\\kappa B)\\right) \\right]^2}\n$$\nThis is the closed-form analytic expression for $\\tau_w$.\n\nRegarding the physically appropriate range of $y_P^{+}$ for this relation, the log law is an asymptotic approximation valid in the inertial sublayer (or logarithmic region) of a turbulent boundary layer. This region is typically defined by the non-dimensional wall distance $y^{+}$ being sufficiently far from the wall to be outside the viscous sublayer ($y^{+}  5$) and buffer layer ($5  y^{+}  30$), but close enough not to be affected by the outer wake region of the boundary layer. A commonly accepted range for the validity of the log law, and thus for the application of this wall function, is $30 \\lesssim y_P^{+} \\lesssim 500$. In practice, CFD codes using such wall functions require the mesh to be coarse enough near the wall such that the first cell center $y_P$ falls into this range.",
            "answer": "$$\n\\boxed{\\rho \\frac{\\left(\\kappa U_P\\right)^2}{\\left[ W\\left(\\frac{y_P \\kappa U_P}{\\nu} \\exp(\\kappa B)\\right) \\right]^2}}\n$$"
        },
        {
            "introduction": "A model is only as good as its underlying assumptions, and a key skill for any engineer or scientist is to understand its limitations. This final hands-on practice moves into the practical realm of computational analysis by asking you to quantify the error that arises when a logarithmic wall function is misapplied to grid points within the buffer layer . By comparing the model's prediction to a more complete law of the wall, you will gain a concrete appreciation for the importance of near-wall grid resolution and the concept of $y^+$ in CFD.",
            "id": "3392554",
            "problem": "You are asked to formalize and quantify the error introduced by applying a pure logarithmic-law wall function within a zero-equation mixing-length model when the first grid point lies in the buffer layer, defined by $5  y_P^+  30$. Work in the setting of fully developed turbulent wall-bounded flow in the inner layer, under the usual assumptions of the equilibrium boundary layer. Start from the following fundamental base: (i) the definition of friction velocity $u_\\tau$ through $\\tau_w = \\rho u_\\tau^2$, (ii) the definition of skin-friction coefficient (C_f) as $C_f = \\tau_w / \\left(\\tfrac{1}{2} \\rho U_{\\mathrm{ref}}^2\\right)$, (iii) the definition of wall units $y^+ = y u_\\tau / \\nu$ and $U^+ = U/u_\\tau$, and (iv) the zero-equation mixing-length concept with mixing length $l = \\kappa y$, where $\\kappa$ is the von Kármán constant. From these bases, derive a consistent procedure for predicting the wall shear stress from a first-cell velocity $U_P$ at the distance $y_P$ from the wall with kinematic viscosity $\\nu$, assuming the local inner-layer equilibrium. Then, quantify the error incurred when using a pure logarithmic-law wall function for $U^+(y^+)$ as compared against a composite law-of-the-wall that smoothly covers the viscous sublayer, buffer layer, and logarithmic layer.\n\nYour program should do the following for each test case:\n- Using the pure logarithmic-law wall function derived from the zero-equation mixing-length closure, solve for the friction velocity $u_{\\tau,\\log}$ that is consistent with a given pair $(U_P, y_P)$, and compute $C_{f,\\log}$.\n- Using a scientifically accepted composite law-of-the-wall (for example, a smooth analytical law that recovers $U^+ \\approx y^+$ for small $y^+$ and $U^+ \\approx \\tfrac{1}{\\kappa} \\ln y^+ + B$ for large $y^+$) as the reference, solve for the friction velocity $u_{\\tau,\\mathrm{true}}$ that is consistent with the same $(U_P, y_P)$, and compute $C_{f,\\mathrm{true}}$.\n- Report the relative error as the decimal fraction $(C_{f,\\log} - C_{f,\\mathrm{true}})/C_{f,\\mathrm{true}}$.\n\nPhysical units must be strictly observed: $U_P$ and $U_{\\mathrm{ref}}$ in $\\mathrm{m/s}$, $y_P$ in $\\mathrm{m}$, and $\\nu$ in $\\mathrm{m^2/s}$. Express $C_f$ and the relative error as dimensionless decimal numbers. Angles are not involved. Use the von Kármán constant $\\kappa = 0.41$ and a log-law intercept $B = 5.2$.\n\nTest Suite:\nProvide results for the following scientifically consistent parameter sets, chosen so that the true first-grid-point wall unit $y_P^+$ lies within or at the boundaries of the buffer layer. Each tuple lists $(y_P, U_P, \\nu, U_{\\mathrm{ref}})$:\n1. Case A (buffer-layer interior, $y_P^+ \\approx 15$): $(y_P = 1.0\\times 10^{-4}\\,\\mathrm{m},\\, U_P = 1.5375\\,\\mathrm{m/s},\\, \\nu = 1.0\\times 10^{-6}\\,\\mathrm{m^2/s},\\, U_{\\mathrm{ref}} = 10.0\\,\\mathrm{m/s})$.\n2. Case B (lower buffer boundary, $y_P^+ \\approx 5$): $(y_P = 5.0\\times 10^{-5}\\,\\mathrm{m},\\, U_P = 0.4880\\,\\mathrm{m/s},\\, \\nu = 1.0\\times 10^{-6}\\,\\mathrm{m^2/s},\\, U_{\\mathrm{ref}} = 10.0\\,\\mathrm{m/s})$.\n3. Case C (upper buffer boundary, $y_P^+ \\approx 30$): $(y_P = 2.0\\times 10^{-4}\\,\\mathrm{m},\\, U_P = 1.9200\\,\\mathrm{m/s},\\, \\nu = 1.0\\times 10^{-6}\\,\\mathrm{m^2/s},\\, U_{\\mathrm{ref}} = 10.0\\,\\mathrm{m/s})$.\n4. Case D (buffer-layer interior, $y_P^+ \\approx 10$): $(y_P = 8.0\\times 10^{-5}\\,\\mathrm{m},\\, U_P = 1.0469\\,\\mathrm{m/s},\\, \\nu = 1.0\\times 10^{-6}\\,\\mathrm{m^2/s},\\, U_{\\mathrm{ref}} = 10.0\\,\\mathrm{m/s})$.\n\nFinal Output Format:\nYour program should produce a single line of output containing the relative errors for Cases A–D as a comma-separated list of decimal numbers rounded to six decimal places and enclosed in square brackets, for example, $[e_A,e_B,e_C,e_D]$, where each $e_\\cdot$ is $(C_{f,\\log} - C_{f,\\mathrm{true}})/C_{f,\\mathrm{true}}$ computed for the corresponding case.",
            "solution": "The user's problem is first assessed for validity.\n\n## Problem Validation\n\n### Step 1: Extract Givens\n- **Fundamental Bases:**\n  - (i) Friction velocity $u_\\tau$: $\\tau_w = \\rho u_\\tau^2$\n  - (ii) Skin-friction coefficient $C_f$: $C_f = \\tau_w / \\left(\\tfrac{1}{2} \\rho U_{\\mathrm{ref}}^2\\right)$\n  - (iii) Wall units: $y^+ = y u_\\tau / \\nu$, $U^+ = U/u_\\tau$\n  - (iv) Zero-equation mixing-length concept: $l = \\kappa y$\n- **Task Definitions:**\n  - Model 1 (Log-law): Use a pure logarithmic-law wall function for $U^+(y^+)$.\n  - Model 2 (Reference \"True\" Law): Use a composite law-of-the-wall that is accurate in the viscous sublayer, buffer layer, and logarithmic layer.\n  - Objective: For a given first-cell velocity $U_P$ at a distance $y_P$ from the wall with kinematic viscosity $\\nu$ and reference velocity $U_{\\mathrm{ref}}$:\n    1. Solve for $u_{\\tau,\\log}$ and compute $C_{f,\\log}$ using Model 1.\n    2. Solve for $u_{\\tau,\\mathrm{true}}$ and compute $C_{f,\\mathrm{true}}$ using Model 2.\n    3. Report the relative error: $(C_{f,\\log} - C_{f,\\mathrm{true}})/C_{f,\\mathrm{true}}$.\n- **Constants:**\n  - von Kármán constant: $\\kappa = 0.41$\n  - Log-law intercept: $B = 5.2$\n- **Physical Units:**\n  - Velocity ($U_P, U_{\\mathrm{ref}}$): $\\mathrm{m/s}$\n  - Length ($y_P$): $\\mathrm{m}$\n  - Kinematic viscosity ($\\nu$): $\\mathrm{m^2/s}$\n- **Test Suite:**\n  - Case A: $(y_P = 1.0\\times 10^{-4}\\,\\mathrm{m},\\, U_P = 1.5375\\,\\mathrm{m/s},\\, \\nu = 1.0\\times 10^{-6}\\,\\mathrm{m^2/s},\\, U_{\\mathrm{ref}} = 10.0\\,\\mathrm{m/s})$\n  - Case B: $(y_P = 5.0\\times 10^{-5}\\,\\mathrm{m},\\, U_P = 0.4880\\,\\mathrm{m/s},\\, \\nu = 1.0\\times 10^{-6}\\,\\mathrm{m^2/s},\\, U_{\\mathrm{ref}} = 10.0\\,\\mathrm{m/s})$\n  - Case C: $(y_P = 2.0\\times 10^{-4}\\,\\mathrm{m},\\, U_P = 1.9200\\,\\mathrm{m/s},\\, \\nu = 1.0\\times 10^{-6}\\,\\mathrm{m^2/s},\\, U_{\\mathrm{ref}} = 10.0\\,\\mathrm{m/s})$\n  - Case D: $(y_P = 8.0\\times 10^{-5}\\,\\mathrm{m},\\, U_P = 1.0469\\,\\mathrm{m/s},\\, \\nu = 1.0\\times 10^{-6}\\,\\mathrm{m^2/s},\\, U_{\\mathrm{ref}} = 10.0\\,\\mathrm{m/s})$\n\n### Step 2: Validate Using Extracted Givens\nThe problem is evaluated against the established criteria:\n- **Scientifically Grounded:** The problem is rooted in the fundamental principles of turbulent boundary layer theory and computational fluid dynamics (CFD). The definitions of $u_\\tau$, $C_f$, $y^+$, $U^+$, and the mixing-length model are standard and correct. The use of wall functions and composite laws is a cornerstone of Reynolds-Averaged Navier-Stokes (RANS) modeling. The chosen constants $\\kappa=0.41$ and $B=5.2$ are widely accepted values.\n- **Well-Posed:** The problem is well-posed. It requires solving for a single unknown, the friction velocity $u_\\tau$, from a set of consistent physical parameters. The underlying physical relationships ensure that a unique and stable solution exists for $u_\\tau$. The objective, calculating a relative error, is a clear and meaningful mathematical task.\n- **Objective:** The language is precise, quantitative, and free of bias or subjective claims. All terms are standard within the field of fluid mechanics.\n- **Completeness and Consistency:** The problem provides all necessary data and relationships to proceed with a solution. The test cases are physically consistent and well-constructed to probe the buffer layer as specified. There are no internal contradictions.\n- **Realism:** The problem is a realistic and practical exercise in CFD, reflecting the common challenge of modeling the near-wall region of a turbulent flow. The provided values for velocity, length, and viscosity are physically plausible.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. It is a well-defined, scientifically sound, and self-contained exercise in applied fluid dynamics. The solution process may proceed.\n\n## Solution\n\nThe core of the problem is to determine the wall shear stress, represented by the friction velocity $u_\\tau$, from a known velocity $U_P$ at a known distance $y_P$ from the wall. This is achieved by inverting the law-of-the-wall relationship. The general form of this relationship, expressed in wall units, is $U^+ = f(y^+)$, where $U^+ = U/u_\\tau$ and $y^+ = y u_\\tau / \\nu$. Evaluating this at the point $P$ gives:\n$$ \\frac{U_P}{u_\\tau} = f\\left(\\frac{y_P u_\\tau}{\\nu}\\right) \\implies U_P = u_\\tau f\\left(\\frac{y_P u_\\tau}{\\nu}\\right) $$\nThis is a non-linear, transcendental equation for the unknown $u_\\tau$, which must be solved numerically. We will solve this equation using two different models for the function $f(y^+)$: a pure logarithmic law and a more accurate composite law.\n\nFirst, we define the relationship between the skin-friction coefficient $C_f$ and the friction velocity $u_\\tau$. From the given definitions:\n$$ C_f = \\frac{\\tau_w}{\\frac{1}{2}\\rho U_{\\mathrm{ref}}^2} = \\frac{\\rho u_\\tau^2}{\\frac{1}{2}\\rho U_{\\mathrm{ref}}^2} = 2 \\left(\\frac{u_\\tau}{U_{\\mathrm{ref}}}\\right)^2 $$\nThe relative error in $C_f$ can therefore be expressed directly in terms of the solved friction velocities:\n$$ \\text{Error} = \\frac{C_{f,\\log} - C_{f,\\mathrm{true}}}{C_{f,\\mathrm{true}}} = \\frac{2(u_{\\tau,\\log}/U_{\\mathrm{ref}})^2 - 2(u_{\\tau,\\mathrm{true}}/U_{\\mathrm{ref}})^2}{2(u_{\\tau,\\mathrm{true}}/U_{\\mathrm{ref}})^2} = \\frac{u_{\\tau,\\log}^2}{u_{\\tau,\\mathrm{true}}^2} - 1 $$\n\n### Model 1: Pure Logarithmic-Law Wall Function\nThe zero-equation mixing-length model, assuming local equilibrium in the fully turbulent region, leads to the logarithmic law for the mean velocity profile:\n$$ U^+(y^+) = \\frac{1}{\\kappa} \\ln(y^+) + B $$\nHere, $\\kappa=0.41$ is the von Kármán constant and $B=5.2$ is the log-law intercept. Applying this model, we obtain the equation for $u_{\\tau,\\log}$:\n$$ U_P = u_{\\tau,\\log} \\left[ \\frac{1}{\\kappa} \\ln\\left(\\frac{y_P u_{\\tau,\\log}}{\\nu}\\right) + B \\right] $$\nThis equation is solved numerically for $u_{\\tau,\\log}$ for each test case.\n\n### Model 2: Composite Law-of-the-Wall (Reference \"True\" Model)\nTo serve as a scientifically accurate reference, a composite law that smoothly transitions from the linear viscous sublayer ($U^+ = y^+$ for $y^+ \\to 0$) to the logarithmic layer is required. A well-established and robust choice is Spalding's law of the wall. It is an implicit relationship between $y^+$ and $U^+$:\n$$ y^+ = U^+ + E \\left( e^{\\kappa U^+} - 1 - \\kappa U^+ - \\frac{(\\kappa U^+)^2}{2} - \\frac{(\\kappa U^+)^3}{6} \\right) $$\nwhere the constant $E$ is related to the log-law constants by $E = e^{-\\kappa B}$. With $\\kappa=0.41$ and $B=5.2$, we have $E \\approx 0.1186$. To find the \"true\" friction velocity, $u_{\\tau,\\mathrm{true}}$, we substitute $y^+ = y_P u_{\\tau,\\mathrm{true}} / \\nu$ and $U^+ = U_P / u_{\\tau,\\mathrm{true}}$ into Spalding's law:\n$$ \\frac{y_P u_{\\tau,\\mathrm{true}}}{\\nu} = \\frac{U_P}{u_{\\tau,\\mathrm{true}}} + E \\left( e^{\\kappa U_P/u_{\\tau,\\mathrm{true}}} - 1 - \\frac{\\kappa U_P}{u_{\\tau,\\mathrm{true}}} - \\frac{1}{2}\\left(\\frac{\\kappa U_P}{u_{\\tau,\\mathrm{true}}}\\right)^2 - \\frac{1}{6}\\left(\\frac{\\kappa U_P}{u_{\\tau,\\mathrm{true}}}\\right)^3 \\right) $$\nThis equation is also solved numerically for $u_{\\tau,\\mathrm{true}}$ for each test case.\n\n### Computational Procedure\nFor each test case tuple $(y_P, U_P, \\nu, U_{\\mathrm{ref}})$, the following steps are executed:\n1. Define a function $F_{\\log}(u_\\tau) = u_\\tau \\left[ \\frac{1}{\\kappa} \\ln\\left(\\frac{y_P u_\\tau}{\\nu}\\right) + B \\right] - U_P$.\n2. Use a numerical root-finding algorithm (e.g., Brent's method) to find the root of $F_{\\log}(u_\\tau) = 0$, which gives $u_{\\tau,\\log}$.\n3. Define a function $F_{\\mathrm{true}}(u_\\tau)$ based on the rearranged Spalding's law:\n   $F_{\\mathrm{true}}(u_\\tau) = \\frac{U_P}{u_\\tau} + E \\left( \\dots \\right) - \\frac{y_P u_\\tau}{\\nu}$.\n4. Use the same root-finding algorithm to find the root of $F_{\\mathrm{true}}(u_\\tau) = 0$, which gives $u_{\\tau,\\mathrm{true}}$.\n5. Calculate the relative error using the derived formula: $\\text{Error} = (u_{\\tau,\\log}/u_{\\tau,\\mathrm{true}})^2 - 1$.\n\nThis procedure accurately quantifies the error incurred by inappropriately applying the pure logarithmic law in the buffer layer, where viscous effects are still significant and cause the true velocity profile to deviate below the logarithmic prediction. As expected, this leads to an underprediction of the friction velocity by the log-law model ($u_{\\tau,\\log}  u_{\\tau,\\mathrm{true}}$), resulting in a negative relative error for $C_f$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import root_scalar\n\ndef solve():\n    \"\"\"\n    Calculates the relative error in skin friction coefficient when using a pure\n    log-law wall function in the buffer layer compared to a composite law.\n    \"\"\"\n    # Define physical constants\n    KAPPA = 0.41  # von Kármán constant\n    B = 5.2       # Log-law intercept\n\n    # Pre-calculate constant for Spalding's law\n    E = np.exp(-KAPPA * B)\n\n    # Define the test cases from the problem statement.\n    # Each tuple is (y_P, U_P, nu, U_ref)\n    test_cases = [\n        (1.0e-4, 1.5375, 1.0e-6, 10.0),  # Case A\n        (5.0e-5, 0.4880, 1.0e-6, 10.0),  # Case B\n        (2.0e-4, 1.9200, 1.0e-6, 10.0),  # Case C\n        (8.0e-5, 1.0469, 1.0e-6, 10.0),  # Case D\n    ]\n\n    results = []\n    # Set a robust search bracket for friction velocity u_tau\n    u_tau_bracket = [0.01, 1.0]\n\n    for case in test_cases:\n        y_P, U_P, nu, U_ref = case\n\n        # --- Part 1: Solve for u_tau using the pure logarithmic law ---\n        def log_law_residual(u_tau):\n            \"\"\"Residual function for the log-law equation: f(u_tau) = 0\"\"\"\n            # Ensure u_tau is positive to have a valid log argument\n            if u_tau = 0:\n                # Return a large value to guide the solver away from non-physical domain\n                return U_P \n            \n            y_plus = y_P * u_tau / nu\n            \n            # The pure log law is technically undefined at y_plus=0\n            # and can be problematic for very small y_plus.\n            if y_plus = 1e-12:\n                return U_P\n                \n            u_plus_model = (1 / KAPPA) * np.log(y_plus) + B\n            return u_tau * u_plus_model - U_P\n\n        sol_log = root_scalar(log_law_residual, bracket=u_tau_bracket, method='brentq')\n        u_tau_log = sol_log.root\n\n        # --- Part 2: Solve for u_tau using the composite Spalding's law ---\n        def spalding_law_residual(u_tau):\n            \"\"\"Residual function for Spalding's law: g(u_tau) = 0\"\"\"\n            if u_tau = 1e-12:\n                return 1e6 # Return large positive to guide solver\n            \n            u_plus = U_P / u_tau\n            kappa_u_plus = KAPPA * u_plus\n            \n            # Check for potential overflow with the exponential term, though unlikely for these cases\n            if kappa_u_plus > np.log(np.finfo(float).max) - 1:\n                return 1e6\n\n            # Spalding's law form: y_plus_model = f(u_plus)\n            exp_term = np.exp(kappa_u_plus)\n            poly_term = 1 + kappa_u_plus + (kappa_u_plus**2) / 2 + (kappa_u_plus**3) / 6\n            y_plus_model = u_plus + E * (exp_term - poly_term)\n            \n            # Actual y_plus from problem parameters\n            y_plus_actual = y_P * u_tau / nu\n            \n            return y_plus_model - y_plus_actual\n        \n        sol_true = root_scalar(spalding_law_residual, bracket=u_tau_bracket, method='brentq')\n        u_tau_true = sol_true.root\n\n        # --- Part 3: Calculate the relative error ---\n        # Relative error in C_f is (u_tau_log^2 / u_tau_true^2) - 1\n        rel_error = (u_tau_log**2 / u_tau_true**2) - 1\n        results.append(rel_error)\n\n    # Format the final output as specified\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}