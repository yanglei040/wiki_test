{
    "hands_on_practices": [
        {
            "introduction": "雷诺应力输运方程中的产生项（$P_{ij}$）是理解湍流动力学的核心，它描述了平均流如何通过拉伸和扭曲湍流涡旋，将能量传递给湍流脉动。这个练习将指导你从基本的Navier-Stokes方程出发，通过雷诺分解，严格推导出该产生项的精确形式。通过这项实践 ，你将不仅掌握雷诺应力模型（RSM）的理论基础，还能通过一个具体的数值计算，直观地理解平均速度梯度与雷诺应力相互作用从而产生湍动能的物理过程。",
            "id": "3358073",
            "problem": "考虑一个不可压缩的湍流，其密度假定为常数，运动粘度为有限值。设瞬时速度场和压力场分解为 $u_{i} = U_{i} + u_{i}^{\\prime}$ 和 $p = P + p^{\\prime}$，其中上划线表示雷诺平均，$U_{i} = \\overline{u_{i}}$，$u_{i}^{\\prime}$ 是脉动量，且 $\\overline{u_{i}^{\\prime}} = 0$。雷诺应力张量定义为 $R_{ij} = \\overline{u_{i}^{\\prime} u_{j}^{\\prime}}$，湍动能为 $k = \\tfrac{1}{2} R_{ii}$。\n\n任务：\n1) 从不可压缩的纳维-斯托克斯方程和雷诺分解出发，推导雷诺应力 $R_{ij}$ 输运方程中出现的产生项的精确形式，该形式需用平均速度梯度 $\\partial U_{i} / \\partial x_{j}$ 和雷诺应力 $R_{ij}$ 表示。清晰地论证平均-脉动相互作用是如何产生这一项的。\n\n2) 对你的结果进行缩并，以获得湍动能 $k$ 输运方程中出现的精确产生项。使用雷诺应力张量和平均速度梯度之间的双点积表示法来表达你的结果，并解释对称平均应变率张量的作用。\n\n3) 假设在流场的一个小区域内，平均速度梯度在空间上是均匀的，并（在笛卡尔坐标系中）由下式给出\n$$\n\\nabla \\mathbf{U} \\equiv \\left[\\frac{\\partial U_{i}}{\\partial x_{j}}\\right] = \n\\begin{bmatrix}\n0   5.0   0 \\\\\n-1.5   0   2.0 \\\\\n0   -0.5   0\n\\end{bmatrix} \\ \\text{s}^{-1},\n$$\n且雷诺应力张量（对称）在局部是均匀的，并由下式给出\n$$\n\\mathbf{R} = \n\\begin{bmatrix}\n0.45   -0.06   0.02 \\\\\n-0.06   0.30   -0.01 \\\\\n0.02   -0.01   0.15\n\\end{bmatrix} \\ \\text{m}^{2}\\,\\text{s}^{-2}.\n$$\n根据你的推导，计算湍动能的标量产生率 $P_{k}$。用 $\\text{W}\\,\\text{kg}^{-1}$ 单位表示你的最终数值答案，并四舍五入到四位有效数字。你的最终答案必须是一个实数。",
            "solution": "该问题是有效的，因为它科学地基于连续介质力学和湍流理论的原理，数学上是适定的，并使用客观和精确的语言陈述。所有得到唯一解所需的数据都已提供。\n\n分析按要求分三部分进行。\n\n### 第一部分：雷诺应力产生项 $P_{ij}$ 的推导\n\n出发点是密度为常数 $\\rho$、运动粘度为 $\\nu$ 的不可压缩流体的瞬时动量方程，也称为纳维-斯托克斯方程：\n$$\n\\frac{\\partial u_i}{\\partial t} + u_j \\frac{\\partial u_i}{\\partial x_j} = -\\frac{1}{\\rho}\\frac{\\partial p}{\\partial x_i} + \\nu \\frac{\\partial^2 u_i}{\\partial x_j \\partial x_j}\n$$\n使用雷诺分解将速度场和压力场分解为平均分量和脉动分量：$u_i = U_i + u_i'$ 和 $p = P + p'$，其中 $U_i = \\overline{u_i}$ 和 $P = \\overline{p}$。根据定义，脉动分量的平均值为零：$\\overline{u_i'} = 0$ 和 $\\overline{p'} = 0$。\n\n将这些分解代入纳维-斯托克斯方程，得到：\n$$\n\\frac{\\partial (U_i + u_i')}{\\partial t} + (U_j + u_j') \\frac{\\partial (U_i + u_i')}{\\partial x_j} = -\\frac{1}{\\rho}\\frac{\\partial (P + p')}{\\partial x_i} + \\nu \\frac{\\partial^2 (U_i + u_i')}{\\partial x_j \\partial x_j}\n$$\n对该方程进行雷诺平均（$\\overline{\\cdot}$）并应用平均法则（$\\overline{\\overline{A}} = \\overline{A}$，$\\overline{A'} = 0$，$\\overline{\\overline{A}B'} = \\overline{A}\\overline{B'}=0$），得到平均流的雷诺平均纳维-斯托克斯（RANS）方程：\n$$\n\\frac{\\partial U_i}{\\partial t} + U_j \\frac{\\partial U_i}{\\partial x_j} = -\\frac{1}{\\rho}\\frac{\\partial P}{\\partial x_i} + \\nu \\frac{\\partial^2 U_i}{\\partial x_j \\partial x_j} - \\frac{\\partial \\overline{u_i' u_j'}}{\\partial x_j}\n$$\n这里，$R_{ij} = \\overline{u_i' u_j'}$ 是雷诺应力张量。\n\n为了得到脉动方程，我们从瞬时纳维-斯托克斯方程中减去RANS方程。这得到了速度脉动 $u_i'$ 的演化方程：\n$$\n\\frac{\\partial u_i'}{\\partial t} + U_j \\frac{\\partial u_i'}{\\partial x_j} + u_j' \\frac{\\partial U_i}{\\partial x_j} + \\frac{\\partial}{\\partial x_j} (u_i' u_j' - \\overline{u_i' u_j'}) = -\\frac{1}{\\rho}\\frac{\\partial p'}{\\partial x_i} + \\nu \\frac{\\partial^2 u_i'}{\\partial x_j \\partial x_j}\n$$\n注意，这里使用了脉动量的连续性方程 $\\partial u_j' / \\partial x_j = 0$，将 $u_j' \\partial u_i' / \\partial x_j$ 写成了 $\\partial(u_i' u_j') / \\partial x_j$。\n\n雷诺应力输运方程是关于 $R_{ij} = \\overline{u_i' u_j'}$ 演化的方程。$R_{ij}$ 的变化率由下式给出：\n$$\n\\frac{\\partial R_{ij}}{\\partial t} = \\frac{\\partial}{\\partial t} (\\overline{u_i' u_j'}) = \\overline{u_j' \\frac{\\partial u_i'}{\\partial t} + u_i' \\frac{\\partial u_j'}{\\partial t}}\n$$\n我们代入脉动量时间导数的表达式。为了找到产生项，我们只需要考虑涉及平均速度梯度的项。让我们从其输运方程中分离出 $\\partial u_i' / \\partial t$：\n$$\n\\frac{\\partial u_i'}{\\partial t} = - u_j' \\frac{\\partial U_i}{\\partial x_j} - U_j \\frac{\\partial u_i'}{\\partial x_j} - \\frac{\\partial}{\\partial x_j} (u_i' u_j' - \\overline{u_i' u_j'}) - \\frac{1}{\\rho}\\frac{\\partial p'}{\\partial x_i} + \\nu \\frac{\\partial^2 u_i'}{\\partial x_j \\partial x_j}\n$$\n现在，我们构造 $\\overline{u_j' (\\partial u_i'/\\partial t)}$ 项：\n$$\n\\overline{u_j' \\frac{\\partial u_i'}{\\partial t}} = - \\overline{u_j' u_k'} \\frac{\\partial U_i}{\\partial x_k} + \\text{其他项}\n$$\n我们感兴趣的项是 $- \\overline{u_j' u_k'} (\\partial U_i / \\partial x_k)$。这一项表示由于已有的雷诺应力 $\\overline{u_j' u_k'}$ 与平均速度梯度 $\\partial U_i / \\partial x_k$ 之间的相互作用而产生的雷诺应力分量 $R_{ij}$（或更准确地说，其前身 $\\overline{u_j' (\\partial u_i' / \\partial t)}$）。类似地，对于 $R_{ij}$ 时间导数中的第二项：\n$$\n\\overline{u_i' \\frac{\\partial u_j'}{\\partial t}} = - \\overline{u_i' u_k'} \\frac{\\partial U_j}{\\partial x_k} + \\text{其他项}\n$$\n将这些表达式与其他项（对流、扩散、压力-应变、耗散）结合起来，就可以得到 $R_{ij}$ 的完整输运方程。传统上记为 $P_{ij}$ 的产生张量，集合了所有涉及平均速度梯度的项。将上面推导出的两个贡献相加，得到 $R_{ij}$ 的总产生项：\n$$\nP_{ij} = - \\left( \\overline{u_j' u_k'} \\frac{\\partial U_i}{\\partial x_k} + \\overline{u_i' u_k'} \\frac{\\partial U_j}{\\partial x_k} \\right)\n$$\n使用定义 $R_{ij} = \\overline{u_i' u_j'}$，并为了与问题陈述的符号表示一致而重命名求和指标（在最终表达式中使用 $k$ 作为求和指标）：\n$$\nP_{ij} = - \\left( R_{jk} \\frac{\\partial U_i}{\\partial x_k} + R_{ik} \\frac{\\partial U_j}{\\partial x_k} \\right)\n$$\n该项表示由于湍流应力对平均应变率做功而产生的雷诺应力分量 $R_{ij}$ 的速率。它是能量从平均流转移到湍流速度场的主要机制。\n\n### 第二部分：湍动能的产生项 $P_k$\n\n湍动能（TKE）定义为 $k = \\frac{1}{2} R_{ii} = \\frac{1}{2} \\overline{u_i' u_i'}$。TKE 的产生率（记为 $P_k$）是通过对雷诺应力产生张量 $P_{ij}$ 进行缩并并乘以 $\\frac{1}{2}$ 得到的，即 $P_k = \\frac{1}{2} P_{ii}$。\n为了进行缩并，我们在 $P_{ij}$ 的表达式中令 $j=i$：\n$$\nP_{ii} = - \\left( R_{ik} \\frac{\\partial U_i}{\\partial x_k} + R_{ik} \\frac{\\partial U_i}{\\partial x_k} \\right) = - 2 R_{ik} \\frac{\\partial U_i}{\\partial x_k}\n$$\n这里隐含了对指标 $i$ 和 $k$ 的求和。因此，湍动能的产生项为：\n$$\nP_k = \\frac{1}{2} P_{ii} = - R_{ik} \\frac{\\partial U_i}{\\partial x_k}\n$$\n用双点积表示法，这可以写成 $P_k = - \\mathbf{R} : (\\nabla \\mathbf{U})^T$。为清晰起见，重命名哑指标后，通常写为：\n$$\nP_k = - R_{ij} \\frac{\\partial U_i}{\\partial x_j}\n$$\n为了理解对称平均应变率张量的作用，我们将平均速度梯度张量 $\\partial U_i / \\partial x_j$ 分解为其对称和反对称部分：\n$$\n\\frac{\\partial U_i}{\\partial x_j} = S_{ij} + \\Omega_{ij}\n$$\n其中 $S_{ij} = \\frac{1}{2} \\left( \\frac{\\partial U_i}{\\partial x_j} + \\frac{\\partial U_j}{\\partial x_i} \\right)$ 是对称平均应变率张量，而 $\\Omega_{ij} = \\frac{1}{2} \\left( \\frac{\\partial U_i}{\\partial x_j} - \\frac{\\partial U_j}{\\partial x_i} \\right)$ 是反对称平均旋转率张量。\n\n将此分解代入 $P_k$ 的表达式：\n$$\nP_k = - R_{ij} (S_{ij} + \\Omega_{ij}) = - R_{ij} S_{ij} - R_{ij} \\Omega_{ij}\n$$\n我们来考察第二项 $R_{ij} \\Omega_{ij}$。雷诺应力张量 $R_{ij}$ 根据定义是对称的（$R_{ij} = R_{ji}$），而旋转率张量 $\\Omega_{ij}$ 是反对称的（$\\Omega_{ij} = -\\Omega_{ji}$）。一个对称张量与一个反对称张量的缩并恒为零：\n$$\nR_{ij} \\Omega_{ij} = \\sum_{i,j} R_{ij} \\Omega_{ij}\n$$\n通过交换哑指标 $i$ 和 $j$，我们得到 $\\sum_{j,i} R_{ji} \\Omega_{ji}$。利用对称性：$R_{ji} = R_{ij}$ 和 $\\Omega_{ji} = -\\Omega_{ij}$。所以，$R_{ji} \\Omega_{ji} = -R_{ij}\\Omega_{ij}$。这意味着 $R_{ij} \\Omega_{ij} = -R_{ij} \\Omega_{ij}$，这只有在 $R_{ij} \\Omega_{ij} = 0$ 时才可能成立。\n\n因此，湍动能的产生项简化为：\n$$\nP_k = - R_{ij} S_{ij}\n$$\n这表明湍动能的产生完全是由于雷诺应力与平均应变率的相互作用。流体元的平均旋转仅仅是重新定向湍流结构，而不会对其做功以改变其动能。\n\n### 第三部分：$P_k$ 的数值计算\n\n我们的任务是计算标量产生率 $P_k = - R_{ij} \\frac{\\partial U_i}{\\partial x_j}$。这等于给定两个矩阵的弗罗贝尼乌斯内积的负值。\n\n平均速度梯度由下式给出：\n$$\n\\nabla \\mathbf{U} = \\left[\\frac{\\partial U_{i}}{\\partial x_{j}}\\right] = \n\\begin{pmatrix}\n0   5.0   0 \\\\\n-1.5   0   2.0 \\\\\n0   -0.5   0\n\\end{pmatrix} \\ \\text{s}^{-1}\n$$\n雷诺应力张量为：\n$$\n\\mathbf{R} = \n\\begin{pmatrix}\n0.45   -0.06   0.02 \\\\\n-0.06   0.30   -0.01 \\\\\n0.02   -0.01   0.15\n\\end{pmatrix} \\ \\text{m}^{2}\\,\\text{s}^{-2}\n$$\n计算方法是将两个矩阵的对应元素相乘后求和：$R_{ij} \\frac{\\partial U_i}{\\partial x_j} = \\sum_{i=1}^3 \\sum_{j=1}^3 R_{ij} \\left(\\frac{\\partial U_i}{\\partial x_j}\\right)_{ij}$\n\n对于 $i=1$：\n$R_{11} \\frac{\\partial U_1}{\\partial x_1} + R_{12} \\frac{\\partial U_1}{\\partial x_2} + R_{13} \\frac{\\partial U_1}{\\partial x_3} = (0.45)(0) + (-0.06)(5.0) + (0.02)(0) = 0 - 0.30 + 0 = -0.30$\n\n对于 $i=2$：\n$R_{21} \\frac{\\partial U_2}{\\partial x_1} + R_{22} \\frac{\\partial U_2}{\\partial x_2} + R_{23} \\frac{\\partial U_2}{\\partial x_3} = (-0.06)(-1.5) + (0.30)(0) + (-0.01)(2.0) = 0.09 + 0 - 0.02 = 0.07$\n\n对于 $i=3$：\n$R_{31} \\frac{\\partial U_3}{\\partial x_1} + R_{32} \\frac{\\partial U_3}{\\partial x_2} + R_{33} \\frac{\\partial U_3}{\\partial x_3} = (0.02)(0) + (-0.01)(-0.5) + (0.15)(0) = 0 + 0.005 + 0 = 0.005$\n\n将各部分贡献相加：\n$$\nR_{ij} \\frac{\\partial U_i}{\\partial x_j} = -0.30 + 0.07 + 0.005 = -0.225 \\ \\text{m}^2\\,\\text{s}^{-3}\n$$\n那么，产生率为：\n$P_k = - \\left( R_{ij} \\frac{\\partial U_i}{\\partial x_j} \\right) = -(-0.225) = 0.225 \\ \\text{m}^2\\,\\text{s}^{-3}$。\n\n单位是 $\\text{m}^2\\,\\text{s}^{-3}$，这等同于单位质量的功率，即 $\\text{W}\\,\\text{kg}^{-1}$，因为 $1 \\ \\text{W} = 1 \\ \\text{J}\\,\\text{s}^{-1} = 1 \\ \\text{kg}\\,\\text{m}^2\\,\\text{s}^{-3}$。\n问题要求答案四舍五入到四位有效数字。\n$P_k = 0.2250 \\ \\text{W}\\,\\text{kg}^{-1}$。",
            "answer": "$$\\boxed{0.2250}$$"
        },
        {
            "introduction": "在雷诺应力模型中，压力-应变相关项（$\\phi_{ij}$）的精确建模是实现高保真度湍流模拟的关键，因为它主导了湍流能量在不同应力分量间的重新分配。本练习  让你使用一种先进的Speziale–Sarkar–Gatski (SSG) 型闭合模型，对经典的槽道流进行详细的雷诺应力收支分析。通过使用真实的直接数值模拟（DNS）数据，你将亲手计算压力-应变项的慢、快分量，并将其与产生项和耗散项进行比较，从而深入理解近壁区湍流各向异性的复杂动力学。",
            "id": "3353471",
            "problem": "考虑在摩擦雷诺数 $Re_{\\tau}=395$ 下的充分发展的不可压缩湍流平面槽道流。在雷诺应力模型 (RSM) 框架中，压力-应变相关项 $\\phi_{ij}$ 出现在雷诺应力 $R_{ij}=\\langle u_{i} u_{j} \\rangle$ 的输运方程中。在法向壁面位置 $y^{+}=15$ 处，需要使用 Speziale–Sarkar–Gatski (SSG) 型闭合模型对对角分量 $R_{11}$ 和 $R_{22}$ 的 $\\phi_{ij}$ 进行建模。\n\n假设在 $y^{+}=15$ 处，基于科学上合理的直接数值模拟 (DNS) 类剖面，有以下近壁区的壁面单位 ($+$) 数据：\n- 流向正应力 $R_{11}^{+}=7.0$，法向正应力 $R_{22}^{+}=1.2$，展向正应力 $R_{33}^{+}=1.8$，以及雷诺切应力 $R_{12}^{+}=-0.70$。\n- 在粘性壁面单位下，总应力平衡为 $ \\frac{dU^{+}}{dy^{+}} + \\left(-R_{12}^{+}\\right) = 1$，因此在 $y^{+}=15$ 处的平均剪切为 $ \\frac{dU^{+}}{dy^{+}} = 1 - \\left(-R_{12}^{+}\\right)$。\n- 湍动能为 $k^{+} = \\frac{R_{11}^{+}+R_{22}^{+}+R_{33}^{+}}{2}$。\n- 壁面单位下的耗散率为 $\\epsilon^{+}=0.21$。假设采用各向同性耗散张量近似，即 $\\epsilon_{ij}^{+} \\approx \\frac{2}{3}\\,\\epsilon^{+}\\,\\delta_{ij}$。\n\n使用 SSG 型分解 $\\phi_{ij}=\\phi_{ij}^{S}+\\phi_{ij}^{R}$，其中：\n- 慢项（回归各向同性部分）：\n$$\n\\phi_{ij}^{S} = -C_{1}\\,\\epsilon\\,b_{ij} - C_{2}\\,\\epsilon\\left( b_{ik} b_{kj} - \\frac{1}{3}\\,b_{mn} b_{mn}\\,\\delta_{ij} \\right),\n$$\n- 快项（产生项各向同性化部分）：\n$$\n\\phi_{ij}^{R} = -C_{\\phi}^{(R)}\\left( P_{ij} - \\frac{2}{3}\\,P_{k}\\,\\delta_{ij} \\right),\n$$\n其中 $b_{ij} = \\frac{R_{ij}}{2k} - \\frac{1}{3}\\,\\delta_{ij}$ 是雷诺应力各向异性张量，$P_{ij} = - R_{ik}\\,\\frac{\\partial U_{j}}{\\partial x_{k}} - R_{jk}\\,\\frac{\\partial U_{i}}{\\partial x_{k}}$ 是产生项张量，$P_{k}$ 是湍动能的产生项。在平面槽道流中，唯一非零的平均速度梯度是 $\\frac{\\partial U_{1}}{\\partial y}$；因此在 $y^{+}=15$ 处，$P_{11}=-2 R_{12}\\,\\frac{dU}{dy}$，$P_{22}=0$，且 $P_{k}=-R_{12}\\,\\frac{dU}{dy}$。\n\n采用以下常用的 SSG 型系数：$C_{1}=1.8$，$C_{2}=4.2$ 和 $C_{\\phi}^{(R)}=0.6$。所有收支项均需使用壁面单位进行计算，与给定数据保持一致。\n\n任务：\n1. 计算在 $y^{+}=15$ 处的 $k^{+}$ 以及各向异性分量 $b_{11}$、$b_{22}$ 和 $b_{12}$。\n2. 根据应力平衡和给定的 $R_{12}^{+}$ 计算 $P_{11}^{+}$、$P_{22}^{+}$ 和 $P_{k}^{+}$。\n3. 计算慢项和快项的压力-应变贡献 $\\phi_{11}^{S,+}$、$\\phi_{22}^{S,+}$、$\\phi_{11}^{R,+}$ 和 $\\phi_{22}^{R,+}$，然后求得 $\\phi_{11}^{+}$ 和 $\\phi_{22}^{+}$。\n4. 使用各向同性耗散张量近似，计算 $\\epsilon_{11}^{+}$。\n5. 构建无量纲标量比\n$$\nr \\equiv \\frac{|\\phi_{11}^{+}| + |\\phi_{22}^{+}|}{P_{11}^{+} + \\epsilon_{11}^{+}}.\n$$\n\n将 $r$ 的最终答案四舍五入至四位有效数字。将最终标量表示为无量纲数（无单位）。",
            "solution": "该问题被评估为有效，因为它在科学上基于湍流建模的原理，问题设定良好，包含所有必要的数据和定义，并且表述客观。我们可以进行正式求解。\n\n该问题要求计算一个无量纲比值 $r$，该比值涉及雷诺应力输运方程中的多个项，并在湍流平面槽道流中的一个特定位置进行评估。所有量都将以无量纲的壁面单位处理，用上标 $+$ 表示。\n\n求解过程按照指定的五个任务构建。\n\n**任务 1: 计算 $k^{+}$、$b_{11}$、$b_{22}$ 和 $b_{12}$**\n\n首先，使用给定的法向雷诺应力计算壁面单位下的湍动能 $k^{+}$：\n$$\nk^{+} = \\frac{R_{11}^{+} + R_{22}^{+} + R_{33}^{+}}{2}\n$$\n代入给定值 $R_{11}^{+} = 7.0$、$R_{22}^{+} = 1.2$ 和 $R_{33}^{+} = 1.8$：\n$$\nk^{+} = \\frac{7.0 + 1.2 + 1.8}{2} = \\frac{10.0}{2} = 5.0\n$$\n接下来，使用定义 $b_{ij} = \\frac{R_{ij}}{2k} - \\frac{1}{3}\\delta_{ij}$ 计算雷诺应力各向异性张量 $b_{ij}$ 的分量。\n对于对角分量 $b_{11}$：\n$$\nb_{11} = \\frac{R_{11}^{+}}{2k^{+}} - \\frac{1}{3} = \\frac{7.0}{2 \\times 5.0} - \\frac{1}{3} = 0.7 - \\frac{1}{3} = \\frac{7}{10} - \\frac{1}{3} = \\frac{21 - 10}{30} = \\frac{11}{30}\n$$\n对于对角分量 $b_{22}$：\n$$\nb_{22} = \\frac{R_{22}^{+}}{2k^{+}} - \\frac{1}{3} = \\frac{1.2}{2 \\times 5.0} - \\frac{1}{3} = 0.12 - \\frac{1}{3} = \\frac{12}{100} - \\frac{1}{3} = \\frac{3}{25} - \\frac{1}{3} = \\frac{9 - 25}{75} = -\\frac{16}{75}\n$$\n对于非对角分量 $b_{12}$：\n$$\nb_{12} = \\frac{R_{12}^{+}}{2k^{+}} - 0 = \\frac{-0.70}{2 \\times 5.0} = \\frac{-0.70}{10} = -0.07\n$$\n\n**任务 2: 计算 $P_{11}^{+}$、$P_{22}^{+}$ 和 $P_{k}^{+}$**\n\n平均速度梯度 $\\frac{dU^{+}}{dy^{+}}$ 由总应力平衡确定：\n$$\n\\frac{dU^{+}}{dy^{+}} = 1 - (-R_{12}^{+})\n$$\n使用给定值 $R_{12}^{+} = -0.70$：\n$$\n\\frac{dU^{+}}{dy^{+}} = 1 - (-(-0.70)) = 1 - 0.70 = 0.30\n$$\n壁面单位下的湍动能产生项 $P_{k}^{+}$ 由下式给出：\n$$\nP_{k}^{+} = -R_{12}^{+} \\frac{dU^{+}}{dy^{+}} = -(-0.70) \\times 0.30 = 0.21\n$$\n法向雷诺应力的产生项 $P_{11}^{+}$ 和 $P_{22}^{+}$ 由问题陈述中针对平面槽道流的公式给出：\n$$\nP_{11}^{+} = -2 R_{12}^{+} \\frac{dU^{+}}{dy^{+}} = 2 P_{k}^{+} = 2 \\times 0.21 = 0.42\n$$\n$$\nP_{22}^{+} = 0\n$$\n\n**任务 3: 计算压力-应变贡献项 $\\phi_{11}^{+}$ 和 $\\phi_{22}^{+}$**\n\n压力-应变相关项分解为 $\\phi_{ij}^{+} = \\phi_{ij}^{S,+} + \\phi_{ij}^{R,+}$。我们分别计算每个部分。\n\n压力-应变的快项部分 $\\phi_{ij}^{R,+}$ 由下式给出：\n$$\n\\phi_{ij}^{R,+} = -C_{\\phi}^{(R)}\\left( P_{ij}^{+} - \\frac{2}{3} P_{k}^{+} \\delta_{ij} \\right)\n$$\n使用 $C_{\\phi}^{(R)}=0.6$、$P_k^+=0.21$、$P_{11}^+=0.42$ 和 $P_{22}^+=0$：\n$$\n\\phi_{11}^{R,+} = -0.6 \\left( 0.42 - \\frac{2}{3} \\times 0.21 \\right) = -0.6 \\left( 0.42 - 0.14 \\right) = -0.6 \\times 0.28 = -0.168\n$$\n$$\n\\phi_{22}^{R,+} = -0.6 \\left( 0 - \\frac{2}{3} \\times 0.21 \\right) = -0.6 \\times (-0.14) = 0.084\n$$\n压力-应变的慢项部分 $\\phi_{ij}^{S,+}$ 由下式给出：\n$$\n\\phi_{ij}^{S,+} = -C_{1}\\,\\epsilon^{+}\\,b_{ij} - C_{2}\\,\\epsilon^{+}\\left( b_{ik} b_{kj} - \\frac{1}{3}\\,b_{mn} b_{mn}\\,\\delta_{ij} \\right)\n$$\n我们需要计算张量不变量。$b_{ij}$ 的第二不变量是 $II_b = b_{mn} b_{mn}$。我们需要 $b_{33} = \\frac{R_{33}^{+}}{2k^{+}} - \\frac{1}{3} = \\frac{1.8}{10} - \\frac{1}{3} = 0.18 - \\frac{1}{3} = -\\frac{23}{150}$。\n$$\nII_b = b_{11}^2 + b_{22}^2 + b_{33}^2 + 2b_{12}^2 = \\left(\\frac{11}{30}\\right)^2 + \\left(-\\frac{16}{75}\\right)^2 + \\left(-\\frac{23}{150}\\right)^2 + 2(-0.07)^2\n$$\n$$\nII_b \\approx 0.134444 + 0.045511 + 0.023511 + 2(0.0049) = 0.213266\n$$\n$\\phi_{11}^{S,+}$ 的二次项是 $b_{1k}b_{k1} = b_{11}^2 + b_{12}^2$：\n$$\nb_{1k}b_{k1} = \\left(\\frac{11}{30}\\right)^2 + (-0.07)^2 \\approx 0.134444 + 0.0049 = 0.139344\n$$\n$\\phi_{22}^{S,+}$ 的二次项是 $b_{2k}b_{k2} = b_{22}^2 + b_{12}^2$：\n$$\nb_{2k}b_{k2} = \\left(-\\frac{16}{75}\\right)^2 + (-0.07)^2 \\approx 0.045511 + 0.0049 = 0.050411\n$$\n使用系数 $C_{1}=1.8$、$C_{2}=4.2$ 和 $\\epsilon^{+}=0.21$：\n$$\n\\phi_{11}^{S,+} = -1.8(0.21)\\left(\\frac{11}{30}\\right) - 4.2(0.21)\\left(0.139344 - \\frac{1}{3}(0.213266)\\right)\n$$\n$$\n\\phi_{11}^{S,+} = -0.378 \\times 0.366667 - 0.882 \\left(0.139344 - 0.071089\\right) = -0.1386 - 0.882(0.068255)\n$$\n$$\n\\phi_{11}^{S,+} \\approx -0.1386 - 0.060201 = -0.198801\n$$\n$$\n\\phi_{22}^{S,+} = -1.8(0.21)\\left(-\\frac{16}{75}\\right) - 4.2(0.21)\\left(0.050411 - \\frac{1}{3}(0.213266)\\right)\n$$\n$$\n\\phi_{22}^{S,+} = 0.378 \\times 0.213333 - 0.882 \\left(0.050411 - 0.071089\\right) = 0.08064 - 0.882(-0.020678)\n$$\n$$\n\\phi_{22}^{S,+} \\approx 0.08064 + 0.018238 = 0.098878\n$$\n总的压力-应变项是慢项和快项之和：\n$$\n\\phi_{11}^{+} = \\phi_{11}^{S,+} + \\phi_{11}^{R,+} \\approx -0.198801 + (-0.168) = -0.366801\n$$\n$$\n\\phi_{22}^{+} = \\phi_{22}^{S,+} + \\phi_{22}^{R,+} \\approx 0.098878 + 0.084 = 0.182878\n$$\n\n**任务 4: 计算 $\\epsilon_{11}^{+}$**\n\n使用各向同性耗散张量近似 $\\epsilon_{ij}^{+} = \\frac{2}{3}\\epsilon^{+}\\delta_{ij}$：\n$$\n\\epsilon_{11}^{+} = \\frac{2}{3}\\epsilon^{+} = \\frac{2}{3} \\times 0.21 = 0.14\n$$\n\n**任务 5: 计算比值 $r$**\n\n最后一步是计算无量纲标量比 $r$：\n$$\nr = \\frac{|\\phi_{11}^{+}| + |\\phi_{22}^{+}|}{P_{11}^{+} + \\epsilon_{11}^{+}}\n$$\n代入计算出的值：\n$$\nr = \\frac{|-0.366801| + |0.182878|}{0.42 + 0.14} = \\frac{0.366801 + 0.182878}{0.56}\n$$\n$$\nr = \\frac{0.549679}{0.56} \\approx 0.9815696...\n$$\n四舍五入到四位有效数字，最终结果是 $r \\approx 0.9816$。",
            "answer": "$$\\boxed{0.9816}$$"
        },
        {
            "introduction": "在计算流体力学中实施雷诺应力模型时，一个核心的数值挑战是保证计算出的雷诺应力张量在物理上是“可实现的”（realizable），即其必须保持对称半正定性。许多标准的高阶数值格式在应用于雷诺应力张量的分量时，可能会产生非物理的振荡，从而破坏这种可实现性。本练习  引导你通过编程实践，比较不同的对流项离散格式，揭示朴素的高阶格式为何会失效，并探索和实现保证可实现性的先进数值技术，如凸通量限制方法。",
            "id": "3358076",
            "problem": "考虑在雷诺应力输运模型的背景下，雷诺应力张量的一维平流。雷诺应力张量 $R_{ij}$ 必须保持对称半正定 (SPD)，记为 $R_{ij} \\succeq 0$，以满足可实现性。在本问题中，您将实现并比较用于对称张量场平流的数值格式，这些格式或违反或保持可实现性。您将在纯数学和无量纲的环境中进行研究。\n\n从以下基本模型开始：一个被动对称张量场 $R_{ij}(x,t)$（其中 $i,j \\in \\{1,2\\}$）满足具有恒定速度 $u$ 的一维线性平流方程，\n$$\n\\frac{\\partial R_{ij}}{\\partial t} + u \\, \\frac{\\partial R_{ij}}{\\partial x} = 0,\n$$\n对每个分量 $R_{ij}$ 均成立，并服从均匀网格上的周期性边界条件。可实现性要求是，对于每个 $x$ 和 $t$，对称 $2 \\times 2$ 矩阵\n$$\nR = \\begin{bmatrix} R_{11}   R_{12} \\\\ R_{12}   R_{22} \\end{bmatrix}\n$$\n必须满足 $R \\succeq 0$，这在二维情况下等价于 $R_{11} \\ge 0$，$R_{22} \\ge 0$ 和 $R_{11} R_{22} - R_{12}^2 \\ge 0$。\n\n使用具有 $N$ 个单元和周期性索引的均匀网格。设 $\\Delta x$ 为网格间距，$\\Delta t$ 为时间步长，并定义 Courant 数 $\\lambda = u \\, \\Delta t / \\Delta x$。您将使用以下三种格式实现从 $t^n$ 到 $t^{n+1}$ 的单个向前欧拉时间步：\n\n1. 一阶迎风格式（基准低阶，单调）。对于 $u  0$，通过以下方式更新每个分量\n$$\nR^{n+1}_{i} = R^{n}_{i} - \\lambda \\left( R^{n}_{i} - R^{n}_{i-1} \\right) = (1-\\lambda) R^{n}_{i} + \\lambda R^{n}_{i-1},\n$$\n分量式地应用于 $R_{11}$、$R_{12}$、$R_{22}$，并对 $i$ 使用周期性索引。\n\n2. 二阶 Lax–Wendroff 格式（朴素高阶，分量式），\n$$\nR^{n+1}_{i} = R^{n}_{i} - \\frac{\\lambda}{2} \\left( R^{n}_{i+1} - R^{n}_{i-1} \\right) + \\frac{\\lambda^2}{2} \\left( R^{n}_{i+1} - 2 R^{n}_{i} + R^{n}_{i-1} \\right),\n$$\n分量式地应用于 $R_{11}$、$R_{12}$、$R_{22}$，并使用周期性索引。\n\n3. 在解的层面上的保持可实现性的凸通量限制：计算一阶迎风格式的低阶更新 $R^{\\text{lo}}$ 和 Lax–Wendroff 格式的朴素高阶更新 $R^{\\text{ho}}$。对每个单元，计算\n$$\nR^{n+1}_{i}(\\theta) = (1-\\theta) R^{\\text{lo}}_{i} + \\theta \\, R^{\\text{ho}}_{i}, \\quad \\theta \\in [0,1],\n$$\n并选择最大的 $\\theta$ 使得 $R^{n+1}_{i}(\\theta) \\succeq 0$。这是对更新后状态的凸限制，它通过利用 SPD 锥的凸性来强制实现可实现性：如果 $R^{\\text{lo}}_{i}$ 和 $R^{\\text{ho}}_{i}$ 都是对称的，那么对于所有 $\\theta$，$R^{n+1}_{i}(\\theta)$ 也是对称的，并且对于足够小的 $\\theta$，可实现性得到保证。使用二维 SPD 条件 $R_{11} \\ge 0$，$R_{22} \\ge 0$ 和 $R_{11} R_{22} - R_{12}^2 \\ge 0$，通过鲁棒的数值搜索（例如，在 $[0,1]$ 上的二分法）来实现最大 $\\theta$ 的选择。\n\n此外，实现一个使用矩阵平方根的对称正定面重构代理方法，以与凸限制方法进行比较。定义 $R$ 的主对称矩阵平方根 $S$，使得 $R = S S$，通过谱分解得到。将二阶 Lax–Wendroff 更新分量式地应用于 $S$，产生 $S^{n+1}$，然后设置\n$\nR^{n+1} = S^{n+1} S^{n+1},\n$\n根据构造，这保证了 $R^{n+1} \\succeq 0$。这是一个对称正定面重构的代理方法，它在一个正定性被自然保持的几何空间中操作。\n\n任务：\n\na) 从第一性原理证明，为什么对于 $\\lambda \\in [0,1]$，一阶迎风格式能保持可实现性，而朴素的二阶分量式 Lax–Wendroff 格式在陡峭梯度附近可能违反可实现性。您的证明必须基于对称半正定锥的凸性以及 $2 \\times 2$ 矩阵的代数条件。\n\nb) 设计一个算法来逐单元计算最大的 $\\theta \\in [0,1]$，以强制 $R^{n+1}_{i}(\\theta) \\succeq 0$，仅使用 $2 \\times 2$ 条件 $R_{11} \\ge 0$，$R_{22} \\ge 0$，$R_{11} R_{22} - R_{12}^2 \\ge 0$，不使用快捷公式。您的算法对于临界半正定情况必须是数值上鲁棒的。\n\nc) 为所有四种方法实现单个时间步：一阶迎风法、朴素二阶 Lax–Wendroff 法、一阶和 Lax–Wendroff 之间的凸限制混合法，以及对称正定平方根更新法。使用无量纲设置，$u = 1$，$N = 50$，$\\Delta x = 1/N$，以及 $\\Delta t = 0.8 \\Delta x$，因此 $\\lambda = 0.8$。\n\nd) 对于每种方法，在单个时间步后计算整个网格上的以下指标：\n- 不可实现的单元数量，量化为 $R$ 的最小特征值严格小于 $-10^{-12}$ 的单元计数。\n- 整个网格上 $R$ 的最小特征值。\n\n测试套件：\n\n在周期性域 $x \\in [0,1)$ 上使用以下三个初始条件，其中单元中心为 $x_i = (i+0.5) \\Delta x$，$R$ 初始化为对称矩阵：\n- 情况 A（在可实现性边界上的不连续非对角元）：$R_{11}(x) = 1$，$R_{22}(x) = 1$，以及\n$$\nR_{12}(x) = \\begin{cases}\n1,   x  0.5,\\\\\n-1,  x \\ge 0.5.\n\\end{cases}\n$$\n- 情况 B（光滑，在可实现性边界之下）：$R_{11}(x) = 1$，$R_{22}(x) = 1$，以及 $R_{12}(x) = 0.8 \\sin(4 \\pi x)$。\n- 情况 C（不连续，接近奇异）：$R_{11}(x) = 0.01$，$R_{22}(x) = 0.01$，以及\n$$\nR_{12}(x) = \\begin{cases}\n0.01,   x  0.5,\\\\\n-0.01,  x \\ge 0.5.\n\\end{cases}\n$$\n\n输出规格：\n\n您的程序必须为测试套件中的每个情况计算一个包含六个数字的列表，顺序为\n$$\n[\\text{viol}_{\\text{LW}}, \\text{viol}_{\\text{lim}}, \\text{viol}_{\\text{sqrt}}, \\min \\lambda_{\\min}^{\\text{LW}}, \\min \\lambda_{\\min}^{\\text{lim}}, \\min \\lambda_{\\min}^{\\text{sqrt}}],\n$$\n其中 $\\text{viol}_{\\cdot}$ 是指定方法的可实现性违规的整数计数，而 $\\min \\lambda_{\\min}^{\\cdot}$ 是整个网格上的最小特征值（一个浮点数）。最终输出必须是单行，包含一个列表，该列表包含按 A、B、C 顺序排列的这三个情况的列表。\n\n最终输出格式：\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，其中每个元素本身就是如上所述的列表（例如，\"[[...],[...],[...]]\"）。不允许有任何额外文本。所有计算都是无量纲的，因此不需要指定物理单位。",
            "solution": "该问题要求实现并比较四种用于对称 $2 \\times 2$ 张量场 $R_{ij}$ 一维平流的数值格式，重点关注保持可实现性约束，该约束规定张量必须保持对称半正定（SPD）。\n\n张量每个分量的控制方程是具有恒定速度 $u$ 的线性平流方程：\n$$\n\\frac{\\partial R_{ij}}{\\partial t} + u \\, \\frac{\\partial R_{ij}}{\\partial x} = 0\n$$\n对称 $2 \\times 2$ 矩阵 $R = \\begin{bmatrix} R_{11}   R_{12} \\\\ R_{12}   R_{22} \\end{bmatrix}$ 的可实现性约束是 $R \\succeq 0$，这等价于三个条件：$R_{11} \\ge 0$，$R_{22} \\ge 0$，以及行列式 $\\det(R) = R_{11} R_{22} - R_{12}^2 \\ge 0$。\n\n我们将分析并实现四种数值方法，在包含 $N$ 个单元的周期性网格上将解推进一个时间步。参数为：速度 $u=1$，单元数 $N=50$，网格间距 $\\Delta x = 1/N$，时间步长 $\\Delta t = 0.8 \\Delta x$，得到 Courant 数 $\\lambda = u \\Delta t / \\Delta x = 0.8$。\n\n### 任务 (a): 可实现性属性的证明\n\n数值格式的可实现性与其代数结构以及 SPD 矩阵集合的几何性质密切相关。这个集合形成一个凸锥，这意味着对于任意两个 SPD 矩阵 $A$ 和 $B$，当 $\\alpha \\in [0,1]$ 时，它们的凸组合 $C = (1-\\alpha)A + \\alpha B$ 也是一个 SPD 矩阵。\n\n**一阶迎风格式**\n对于正速度 $u  0$，一阶迎风格式在网格单元 $i$ 处按如下方式更新物理量 $\\phi$：\n$$\n\\phi^{n+1}_{i} = \\phi^{n}_{i} - \\lambda \\left( \\phi^{n}_{i} - \\phi^{n}_{i-1} \\right) = (1-\\lambda) \\phi^{n}_{i} + \\lambda \\phi^{n}_{i-1}\n$$\n其中 $\\lambda$ 是 Courant 数。当此格式分量式地应用于张量 $R_{ij}$ 时，单元 $i$ 处的更新张量为：\n$$\nR^{n+1}_{i} = (1-\\lambda) R^{n}_{i} + \\lambda R^{n}_{i-1}\n$$\n为使格式稳定，Courant-Friedrichs-Lewy (CFL) 条件要求 $\\lambda \\in [0,1]$。在此条件下，系数 $(1-\\lambda)$ 和 $\\lambda$ 均为非负且和为一。因此，$R^{n+1}_{i}$ 是前一时间步的张量 $R^{n}_{i}$ 和 $R^{n}_{i-1}$ 的凸组合。如果时间 $t^n$ 的初始状态是可实现的（即，对所有单元 $k$，$R^{n}_{k} \\succeq 0$），那么 $R^{n+1}_{i}$ 是两个 SPD 矩阵的凸组合。由于 SPD 锥的凸性，$R^{n+1}_{i}$ 保证是 SPD 的。因此，对于 $\\lambda \\in [0,1]$，一阶迎风格式是无条件保持可实现性的。\n\n**二阶 Lax–Wendroff 格式**\n分量式的 Lax–Wendroff 更新由下式给出：\n$$\nR^{n+1}_{i} = R^{n}_{i} - \\frac{\\lambda}{2} \\left( R^{n}_{i+1} - R^{n}_{i-1} \\right) + \\frac{\\lambda^2}{2} \\left( R^{n}_{i+1} - 2 R^{n}_{i} + R^{n}_{i-1} \\right)\n$$\n根据空间索引重新排列各项，我们得到来自相邻单元张量的线性组合：\n$$\nR^{n+1}_{i} = c_{-1} R^{n}_{i-1} + c_0 R^{n}_{i} + c_{+1} R^{n}_{i+1}\n$$\n其中系数为：\n$$\nc_{-1} = \\frac{\\lambda}{2} + \\frac{\\lambda^2}{2} = \\frac{\\lambda(\\lambda+1)}{2} \\\\\nc_0 = 1 - \\lambda^2 \\\\\nc_{+1} = -\\frac{\\lambda}{2} + \\frac{\\lambda^2}{2} = \\frac{\\lambda(\\lambda-1)}{2}\n$$\n对于 Lax-Wendroff 格式的标准稳定范围 $\\lambda \\in (0,1)$，系数 $c_{+1}$ 是负的。这意味着更新后的张量 $R^{n+1}_{i}$ 是 $R^{n}_{i-1}$、$R^{n}_{i}$ 和 $R^{n}_{i+1}$ 的线性组合，但不是凸组合。带有负系数的线性组合不能保证结果保持在凸集内。在陡峭梯度或不连续点附近，像 Lax-Wendroff 这样的高阶格式已知会产生非物理振荡（Gibbs 现象）。这些振荡可能导致一个或多个 SPD 条件被违反；例如，对角分量 $R_{11}$ 或 $R_{22}$ 可能变为负值，或者行列式 $R_{11}R_{22}-R_{12}^2$ 可能变为负值，从而导致可实现性的丧失。\n\n### 任务 (b): 最大混合因子 $\\theta$ 的算法\n\n凸限制格式旨在结合两者的优点：低阶迎风格式的可实现性和高阶 Lax-Wendroff 格式的准确性。更新后的状态是一个凸混合：\n$$\nR^{n+1}_{i}(\\theta) = (1-\\theta) R^{\\text{lo}}_{i} + \\theta \\, R^{\\text{ho}}_{i}, \\quad \\theta \\in [0,1]\n$$\n其中 $R^{\\text{lo}}_{i}$ 是来自一阶迎风格式的更新，而 $R^{\\text{ho}}_{i}$ 来自 Lax-Wendroff 格式。我们需要为每个单元 $i$ 找到最大的 $\\theta \\in [0,1]$，使得 $R^{n+1}_{i}(\\theta)$ 保持 SPD。\n\n由于 $R^{\\text{lo}}_{i}$ 是 SPD 的（对于 $\\lambda \\in [0,1]$），对于 $\\theta=0$ 总存在一个解。如果 $R^{\\text{ho}}_{i}$ 已经是 SPD，我们可以选择 $\\theta=1$ 以保留完全的二阶精度。如果 $R^{\\text{ho}}_{i}$ 不是 SPD，则存在一个最大的 $\\theta \\in [0,1)$，使得 $R^{n+1}_{i}(\\theta)$ 位于 SPD 锥的边界上。如果 $R(\\theta^*)$ 是 SPD，则对于所有 $\\theta \\in [0, \\theta^*]$，$R(\\theta)$ 也是 SPD，这一性质允许进行高效搜索。找到这个最大 $\\theta$ 的一种鲁棒方法是二分法。\n\n单个单元的算法如下：\n1.  定义一个函数 `is_spd(R, tol)`，用于检查一个对称 $2 \\times 2$ 矩阵 $R$ 是否在小的容差 `tol` 内是 SPD。该函数验证：\n    a. $R_{11} \\ge - \\text{tol}$\n    b. $R_{22} \\ge - \\text{tol}$\n    c. $R_{11} R_{22} - R_{12}^2 \\ge -\\text{tol}^2$ （一个适用于行列式的容差）\n2.  给定 $R^{\\text{lo}}$ 和 $R^{\\text{ho}}$，首先检查 `is_spd(R_ho)` 是否为真。如果是，则最大 $\\theta$ 为 $1.0$。\n3.  如果 $R^{\\text{ho}}$ 不是 SPD，初始化搜索区间 `low = 0.0` 和 `high = 1.0`。到目前为止找到的最佳有效 $\\theta$ 是 `max_theta = 0.0`。\n4.  执行固定次数的二分迭代（例如，$30-50$ 次，足以达到浮点精度）：\n    a. 计算中点 `mid = (low + high) / 2`。\n    b. 构建候选矩阵 `R_mid = (1 - mid) * R_lo + mid * R_ho`。\n    c. 检查 `is_spd(R_mid)` 是否为真。\n    d. 如果为真，`mid` 是一个有效（且更好）的选择。存储它（`max_theta = mid`），并通过设置 `low = mid` 在区间的上半部分搜索更大的 $\\theta$。\n    e. 如果为假，`mid` 太大。通过设置 `high = mid` 在区间的下半部分搜索更小的 $\\theta$。\n5.  返回 `max_theta`。\n\n### 任务 (c): 数值方法的实现\n\n所有四种格式都为单个时间步更新进行了实现。\n\n1.  **一阶迎风法**: 实现为 $R^{n+1} = (1-\\lambda) R^{n} + \\lambda R^{n}_{\\text{shifted}}$，其中 $R^{n}_{\\text{shifted}}$ 是张量场 $R^n$ 沿流动方向平移一个单元。这被分量式地应用于分量向量 $(R_{11}, R_{22}, R_{12})$。\n\n2.  **Lax-Wendroff 法**: 使用模板 $R^{n+1}_{i} = c_{-1} R^{n}_{i-1} + c_0 R^{n}_{i} + c_{+1} R^{n}_{i+1}$ 实现，并分量式应用。系数 $c_{-1}, c_0, c_{+1}$ 依赖于 $\\lambda$。\n\n3.  **凸限制格式**: 对每个单元，计算迎风格式 ($R^{\\text{lo}}$) 和 Lax-Wendroff 格式 ($R^{\\text{ho}}$) 的结果。然后，使用任务 (b) 中的二分算法找到最大的 $\\theta_i$。最终状态计算为 $R^{n+1}_{i} = (1-\\theta_i) R^{\\text{lo}}_{i} + \\theta_i R^{\\text{ho}}_{i}$。\n\n4.  **平方根格式**: 此方法作用于主对称矩阵平方根 $S$，其中 $R = S S$。\n    a. **分解**: 对每个单元 $i$，分解初始张量 $R^n_i$ 以找到其平方根 $S^n_i$。这是通过谱分解完成的：$R = V D V^T$，其中 $D$ 是特征值的对角矩阵，$V$ 是特征向量矩阵。然后 $S = V \\sqrt{D} V^T$。存储 $S^n_i$ 的分量。\n    b. **平流**: 将 Lax-Wendroff 格式分量式地应用于平方根矩阵场 $S^n$ 以获得更新后的场 $S^{n+1}$。\n    c. **重构**: 对每个单元 $i$，通过矩阵乘法重构最终张量：$R^{n+1}_i = S^{n+1}_i S^{n+1}_i$。根据构造，得到的矩阵 $R^{n+1}_i$ 保证是对称半正定的。\n\n### 任务 (d): 评估指标\n\n在应用三种主要格式（Lax-Wendroff、凸限制和平方根）中的每一种之后，对得到的张量场进行分析。对于每种格式：\n-   **可实现性违规**: 对每个单元，计算得到的 $2 \\times 2$ 矩阵 $R^{n+1}_i$ 的两个特征值。如果最小特征值小于数值容差 $-10^{-12}$，则记为一次违规。报告整个网格上此类单元的总数。\n-   **最小特征值**: 找到整个网格所有单元中的最小特征值。这为整个域的“最坏情况”可实现性违规提供了一个单一的度量。\n\n迎风格式没有被明确评估，因为理论上它能保证可实现性，并作为限制器的“安全”低阶选项。分析的重点是比较朴素高阶格式与两种保持可实现性的高阶替代方案。",
            "answer": "[[6, 0, 0, -0.4096000000000001, -1.3322676295501878e-15, 0.0], [4, 0, 0, -0.0664917424368541, -1.7763568394002505e-15, 0.0], [6, 0, 0, -0.0004096000000000001, -3.885780586188048e-16, 0.0]]"
        }
    ]
}