{
    "hands_on_practices": [
        {
            "introduction": "Before diving into the complexities of turbulence, it's crucial to understand the baseline case where the Reynolds-Averaged Navier-Stokes (RANS) framework elegantly simplifies. For a flow that is stable and laminar, there are no true velocity fluctuations, only a steady mean flow. This foundational practice first asks you to prove that under these conditions, the Reynolds stress term $\\overline{u_i' u_j'}$ vanishes, and the RANS equations reduce to the original Navier-Stokes equations. \n\nThe exercise then transitions from theory to practice by tackling a critical issue in data analysis: distinguishing genuine turbulent fluctuations from the inevitable numerical or measurement noise. You will create a synthetic laminar signal, contaminate it with noise, and implement a statistical filter to demonstrate how to objectively identify and remove spurious correlations that are not physically meaningful.",
            "id": "3357793",
            "problem": "Consider an incompressible fluid with density $\\rho$ and kinematic viscosity $\\nu$ governed by the instantaneous Navier–Stokes equations. Define the Reynolds decomposition $u_i = \\overline{u_i} + u_i'$ and $p = \\overline{p} + p'$, where the overbar denotes an averaging operator that is linear and commutes with differentiation on sufficiently smooth fields, and the prime denotes fluctuations with $\\overline{u_i'} = 0$. Reynolds-Averaged Navier–Stokes (RANS) is obtained by applying this averaging operator to the instantaneous equations. Assume a canonical bounded flow with fixed boundary conditions, smooth data, and below the critical Reynolds number $Re_{crit}$ such that for $Re  Re_{crit}$ the laminar solution is unique and asymptotically stable in time.\n\nTask A (derivation). Starting strictly from the incompressible instantaneous equations and the properties of the averaging operator, prove that for laminar, asymptotically steady flows with $Re  Re_{crit}$, the decomposition yields $u_i' = 0$, and the averaged equations reduce to the instantaneous Navier–Stokes equations without any additional stress terms. Your proof must rely only on the stated principles and definitions and must justify why the Reynolds stress $\\overline{u_i' u_j'}$ vanishes under the stated conditions.\n\nTask B (numerical test and filtering). Construct a synthetic nondimensional laminar channel-flow signal as follows. Let the deterministic mean streamwise velocity at a fixed wall-normal location $y$ be $u(y) = 1 - y^2$ and the mean cross-stream velocity be $v(y) = 0$. Sample the velocity at a fixed $y$ over $N$ timesteps to form time series $u(t_n)$ and $v(t_n)$, $n = 1,\\dots,N$, then contaminate each component with discretization noise modeled as zero-mean Gaussian perturbations with standard deviations $\\sigma_u$ and $\\sigma_v$; optionally introduce a controllable correlation between the noise components parameterized by a correlation coefficient $\\rho \\in [-1,1]$. For each synthetic dataset, compute the empirical Reynolds stress estimate $\\overline{u' v'}$ by subtracting sample means to form $u' = u - \\overline{u}$ and $v' = v - \\overline{v}$ and averaging the product $u' v'$ over the $N$ samples. Then implement a statistically principled filter that, under the assumption of independent, zero-mean Gaussian noise contaminating a steady laminar signal, treats $\\overline{u' v'}$ as indistinguishable from $0$ whenever its magnitude is not statistically significant at a user-specified two-sided level $\\alpha$, using a threshold computed from the estimated component variances and $N$. When the estimate is not significant, set the filtered value to exactly $0$; otherwise, retain the unfiltered estimate.\n\nYour program must:\n- Generate three test cases that exercise different facets of the problem:\n  1. A \"happy path\" with large $N$ and small uncorrelated noise: $N = 10^5$, $\\sigma_u = 10^{-3}$, $\\sigma_v = 10^{-3}$, $\\rho = 0$, $\\alpha = 10^{-2}$, $y = 0.3$.\n  2. A boundary case with moderate $N$ and larger uncorrelated noise: $N = 2 \\times 10^3$, $\\sigma_u = 5 \\times 10^{-3}$, $\\sigma_v = 5 \\times 10^{-3}$, $\\rho = 0$, $\\alpha = 10^{-2}$, $y = 0.3$.\n  3. An edge case with mild correlated noise that can appear as discretization coupling: $N = 5 \\times 10^3$, $\\sigma_u = 10^{-3}$, $\\sigma_v = 10^{-3}$, $\\rho = 0.2$, $\\alpha = 10^{-2}$, $y = 0.3$.\n- Use nondimensional variables throughout; no physical units are required.\n- For each test case, compute the absolute value of the unfiltered estimate $|\\overline{u' v'}|$ and the absolute value after filtering.\n- Produce a single line of output containing all results as a comma-separated list enclosed in square brackets, ordered as $[|\\overline{u' v'}|_{1,\\text{pre}},|\\overline{u' v'}|_{1,\\text{post}},|\\overline{u' v'}|_{2,\\text{pre}},|\\overline{u' v'}|_{2,\\text{post}},|\\overline{u' v'}|_{3,\\text{pre}},|\\overline{u' v'}|_{3,\\text{post}}]$, where the subscript denotes the test case index and \"pre\"/\"post\" refer to before and after filtering, respectively.\n\nThe program must be self-contained and must not read input or write files. All random number generation in the synthetic data must be seeded to ensure deterministic outputs.",
            "solution": "The problem presents two tasks. Task A is a theoretical proof demonstrating that for a steady laminar flow, the Reynolds decomposition simplifies, and the Reynolds stress term vanishes. Task B is a numerical problem to implement a statistical filter to remove spurious Reynolds stress values that arise from numerical noise in a synthetic laminar flow signal.\n\n### Task A: Proof for Laminar Flow\n\nWe begin with the instantaneous incompressible Navier-Stokes equations for a fluid with constant density $\\rho$ and kinematic viscosity $\\nu$. In index notation, these are the momentum and continuity equations:\n$$\n\\frac{\\partial u_i}{\\partial t} + u_j \\frac{\\partial u_i}{\\partial x_j} = -\\frac{1}{\\rho}\\frac{\\partial p}{\\partial x_i} + \\nu \\frac{\\partial^2 u_i}{\\partial x_j \\partial x_j}\n$$\n$$\n\\frac{\\partial u_i}{\\partial x_i} = 0\n$$\nThe velocity $u_i$ and pressure $p$ are decomposed into mean and fluctuating components: $u_i = \\overline{u_i} + u_i'$ and $p = \\overline{p} + p'$. The averaging operator, denoted by the overbar, is linear, commutes with derivatives, and satisfies $\\overline{u_i'} = 0$.\n\nApplying the averaging operator to the momentum equation yields:\n$$\n\\overline{\\frac{\\partial (\\overline{u_i} + u_i')}{\\partial t}} + \\overline{(\\overline{u_j} + u_j') \\frac{\\partial (\\overline{u_i} + u_i')}{\\partial x_j}} = \\overline{-\\frac{1}{\\rho}\\frac{\\partial (\\overline{p} + p')}{\\partial x_i} + \\nu \\frac{\\partial^2 (\\overline{u_i} + u_i')}{\\partial x_j \\partial x_j}}\n$$\nUsing the linearity of the operator and its commutation with derivatives, we simplify each term. The time derivative term becomes:\n$$\n\\overline{\\frac{\\partial \\overline{u_i}}{\\partial t} + \\frac{\\partial u_i'}{\\partial t}} = \\frac{\\partial \\overline{u_i}}{\\partial t} + \\frac{\\partial \\overline{u_i'}}{\\partial t} = \\frac{\\partial \\overline{u_i}}{\\partial t}\n$$\nThe nonlinear advection term expands to four terms:\n$$\n\\overline{\\overline{u_j}\\frac{\\partial \\overline{u_i}}{\\partial x_j} + \\overline{u_j}\\frac{\\partial u_i'}{\\partial x_j} + u_j'\\frac{\\partial \\overline{u_i}}{\\partial x_j} + u_j'\\frac{\\partial u_i'}{\\partial x_j}} = \\overline{u_j}\\frac{\\partial \\overline{u_i}}{\\partial x_j} + \\overline{u_j}\\frac{\\partial \\overline{u_i'}}{\\partial x_j} + \\overline{u_j'}\\frac{\\partial \\overline{u_i}}{\\partial x_j} + \\overline{u_j'\\frac{\\partial u_i'}{\\partial x_j}}\n$$\nUsing $\\overline{u_i'} = 0$ and assuming the mean of a product with one fluctuating term is zero (e.g., $\\overline{A'B}=0$), this simplifies to:\n$$\n\\overline{u_j}\\frac{\\partial \\overline{u_i}}{\\partial x_j} + \\overline{u_j'\\frac{\\partial u_i'}{\\partial x_j}}\n$$\nFrom the continuity equation for fluctuations ($\\partial u_j' / \\partial x_j = 0$), we can write $\\overline{u_j' \\frac{\\partial u_i'}{\\partial x_j}} = \\overline{\\frac{\\partial (u_i' u_j')}{\\partial x_j}}$. Applying the averaging operator, this becomes $\\frac{\\partial \\overline{u_i' u_j'}}{\\partial x_j}$.\n\nThe pressure and viscous terms simplify to $-\\frac{1}{\\rho}\\frac{\\partial \\overline{p}}{\\partial x_i}$ and $\\nu \\frac{\\partial^2 \\overline{u_i}}{\\partial x_j \\partial x_j}$, respectively. Combining all terms gives the Reynolds-Averaged Navier-Stokes (RANS) equations:\n$$\n\\frac{\\partial \\overline{u_i}}{\\partial t} + \\overline{u_j}\\frac{\\partial \\overline{u_i}}{\\partial x_j} = -\\frac{1}{\\rho}\\frac{\\partial \\overline{p}}{\\partial x_i} + \\nu \\frac{\\partial^2 \\overline{u_i}}{\\partial x_j \\partial x_j} - \\frac{\\partial \\overline{u_i' u_j'}}{\\partial x_j}\n$$\nThe term $-\\rho \\overline{u_i' u_j'}$ is the Reynolds stress tensor, which represents the effect of fluctuations on the mean flow.\n\nNow, we consider the specific conditions given: a laminar, asymptotically steady flow for a Reynolds number $Re  Re_{crit}$. For such flows, the theory of hydrodynamic stability guarantees that the solution to the Navier-Stokes equations is unique and globally asymptotically stable. This means that from any sufficiently smooth initial condition, the flow field $u_i(\\mathbf{x}, t)$ converges to a single, time-independent (steady) solution, which we denote as $u_i^{lam}(\\mathbf{x})$, as $t \\to \\infty$.\n\nAn \"asymptotically steady\" flow is one that has reached this steady state. Thus, for the times under consideration, the instantaneous velocity field is identical to the steady laminar solution:\n$$\nu_i(\\mathbf{x}, t) = u_i^{lam}(\\mathbf{x})\n$$\nThe averaging operator, when applied to a time-independent field, simply returns the field itself. Therefore, the mean velocity is:\n$$\n\\overline{u_i} = \\overline{u_i^{lam}(\\mathbf{x})} = u_i^{lam}(\\mathbf{x})\n$$\nBy definition, the fluctuating component is the difference between the instantaneous and mean fields:\n$$\nu_i' = u_i - \\overline{u_i} = u_i^{lam}(\\mathbf{x}) - u_i^{lam}(\\mathbf{x}) = 0\n$$\nSince the fluctuating velocity components $u_i'$ are identically zero for a steady laminar flow, their product $u_i' u_j'$ is also identically zero. Consequently, the average of this product, which constitutes the Reynolds stress term, must be zero:\n$$\n\\overline{u_i' u_j'} = \\overline{0} = 0\n$$\nWith the Reynolds stress term vanishing and the flow being steady ($\\partial \\overline{u_i} / \\partial t = 0$), the RANS equations reduce to:\n$$\n\\overline{u_j}\\frac{\\partial \\overline{u_i}}{\\partial x_j} = -\\frac{1}{\\rho}\\frac{\\partial \\overline{p}}{\\partial x_i} + \\nu \\frac{\\partial^2 \\overline{u_i}}{\\partial x_j \\partial x_j}\n$$\nSince $\\overline{u_i} = u_i$ and $\\overline{p} = p$ for this steady flow, this equation is identical to the steady, instantaneous Navier-Stokes equations. This completes the proof.\n\n### Task B: Numerical Test and Filtering Protocol\n\nThis task involves generating a synthetic time series representing a steady laminar flow contaminated by noise and then applying a statistical filter to the computed empirical Reynolds stress.\n\nFirst, a synthetic dataset is generated. The true, underlying flow is a steady, nondimensional channel flow with velocity components $u(y) = 1 - y^2$ and $v(y) = 0$ at a fixed wall-normal position $y$. For each test case, $N$ time samples are generated. The true velocities, $\\mu_u = 1 - y^2$ and $\\mu_v = 0$, are contaminated with noise drawn from a bivariate Gaussian distribution with mean $[0, 0]$ and a specified covariance matrix:\n$$\n\\Sigma = \\begin{pmatrix} \\sigma_u^2  \\rho \\sigma_u \\sigma_v \\\\ \\rho \\sigma_u \\sigma_v  \\sigma_v^2 \\end{pmatrix}\n$$\nThis yields two time series, $u(t_n)$ and $v(t_n)$, for $n=1, \\dots, N$.\n\nNext, the empirical Reynolds stress, $\\overline{u'v'}$, is computed. This quantity is the sample covariance between the $u$ and $v$ signals. We first compute the sample means, $\\overline{u} = \\frac{1}{N}\\sum_{n=1}^{N} u(t_n)$ and $\\overline{v} = \\frac{1}{N}\\sum_{n=1}^{N} v(t_n)$. Then, the fluctuations are found: $u'(t_n) = u(t_n) - \\overline{u}$ and $v'(t_n) = v(t_n) - \\overline{v}$. The empirical Reynolds stress is the average of their product:\n$$\n\\overline{u'v'} = \\frac{1}{N}\\sum_{n=1}^{N} u'(t_n) v'(t_n)\n$$\nThe absolute value of this quantity, $|\\overline{u'v'}|$, is the pre-filter result.\n\nFinally, a statistical filter is applied. The filter is designed under the null hypothesis, $H_0$, that the true signal is steady and contaminated by *independent*, zero-mean Gaussian noise. Under $H_0$, the true covariance between the $u$ and $v$ signals is $0$. Any non-zero sample covariance is due to random sampling variability.\n\nAccording to the Central Limit Theorem, for large $N$, the sample covariance $\\overline{u'v'}$ is approximately normally distributed. Under $H_0$, its mean is $0$ and its variance is $\\text{Var}(\\overline{u'v'}) \\approx \\frac{\\sigma_u^2 \\sigma_v^2}{N}$. The corresponding standard error ($SE$) is $\\frac{\\sigma_u \\sigma_v}{\\sqrt{N}}$. In practice, the true population standard deviations $\\sigma_u$ and $\\sigma_v$ are unknown and are estimated by the sample standard deviations $\\hat{\\sigma}_u$ and $\\hat{\\sigma}_v$. The test statistic is thus $Z = \\overline{u'v'} / (\\hat{\\sigma}_u \\hat{\\sigma}_v / \\sqrt{N})$, which follows an approximate standard normal distribution $N(0,1)$.\n\nTo perform a two-sided hypothesis test at a significance level $\\alpha$, we compare the magnitude of the test statistic $|Z|$ to the critical value $z_{\\alpha/2}$, which is the $(1-\\alpha/2)$-quantile of the standard normal distribution. We fail to reject $H_0$ if $|Z| \\le z_{\\alpha/2}$. This is equivalent to comparing the magnitude of the empirical Reynolds stress $|\\overline{u'v'}|$ to a threshold $T$:\n$$\nT = z_{\\alpha/2} \\frac{\\hat{\\sigma}_u \\hat{\\sigma}_v}{\\sqrt{N}}\n$$\nThe critical value $z_{\\alpha/2}$ is computed using `scipy.stats.norm.ppf(1 - \\alpha/2)`. Sample standard deviations are computed with a denominator of $N-1$ (Bessel's correction).\n\nThe filtering rule is:\n1. If $|\\overline{u'v'}| \\le T$, the computed stress is considered statistically indistinguishable from $0$. The filtered value is set to exactly $0.0$.\n2. If $|\\overline{u'v'}|  T$, the value is statistically significant. We reject $H_0$ and retain the original unfiltered value.\n\nThe absolute value of the filtered result is the post-filter result. This procedure is applied to each of the three test cases, which are designed to probe the filter's behavior under different conditions of sample size, noise level, and noise correlation.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import norm\n\ndef solve():\n    \"\"\"\n    Solves the numerical part of the problem: generates synthetic velocity data,\n    computes empirical Reynolds stress, and applies a statistical filter.\n    \"\"\"\n    # Set a seed for the random number generator to ensure deterministic output.\n    np.random.seed(42)\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # 1. \"Happy path\": large N, small uncorrelated noise.\n        #    Expect noise-induced stress to be statistically insignificant.\n        {'N': 100000, 'sigma_u': 1e-3, 'sigma_v': 1e-3, 'rho': 0.0, 'alpha': 0.01, 'y': 0.3},\n        \n        # 2. \"Boundary case\": moderate N, larger uncorrelated noise.\n        #    Higher chance of spurious correlation, tests filter robustness.\n        {'N': 2000, 'sigma_u': 5e-3, 'sigma_v': 5e-3, 'rho': 0.0, 'alpha': 0.01, 'y': 0.3},\n        \n        # 3. \"Edge case\": mild correlated noise.\n        #    Tests filter's ability to detect a true, small, non-zero correlation.\n        {'N': 5000, 'sigma_u': 1e-3, 'sigma_v': 1e-3, 'rho': 0.2, 'alpha': 0.01, 'y': 0.3}\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        N = case['N']\n        sigma_u = case['sigma_u']\n        sigma_v = case['sigma_v']\n        rho = case['rho']\n        alpha = case['alpha']\n        y = case['y']\n\n        # Step 1: Generate synthetic data\n        # True mean velocity components for the laminar profile at y\n        mu_u = 1.0 - y**2\n        mu_v = 0.0\n\n        # Construct the covariance matrix for the bivariate Gaussian noise\n        cov_matrix = [\n            [sigma_u**2,                rho * sigma_u * sigma_v],\n            [rho * sigma_u * sigma_v,   sigma_v**2               ]\n        ]\n        \n        # Generate N samples of noise and add to the mean signal\n        noise = np.random.multivariate_normal([0.0, 0.0], cov_matrix, size=N)\n        u_signal = mu_u + noise[:, 0]\n        v_signal = mu_v + noise[:, 1]\n\n        # Step 2: Compute the unfiltered empirical Reynolds stress\n        # The empirical Reynolds stress is the sample covariance, using 1/N.\n        u_mean = np.mean(u_signal)\n        v_mean = np.mean(v_signal)\n        u_prime = u_signal - u_mean\n        v_prime = v_signal - v_mean\n        \n        # Calculate as the mean of the product of fluctuations\n        unfiltered_stress = np.mean(u_prime * v_prime)\n        \n        abs_pre = abs(unfiltered_stress)\n        results.append(abs_pre)\n\n        # Step 3: Implement and apply the statistical filter\n        # The filter is based on a hypothesis test where the null hypothesis\n        # assumes uncorrelated noise.\n\n        # Estimate sample standard deviations (with ddof=1 for unbiased estimate)\n        s_u = np.std(u_signal, ddof=1)\n        s_v = np.std(v_signal, ddof=1)\n\n        # Calculate the critical value z_{alpha/2} for a two-sided test\n        z_alpha_2 = norm.ppf(1.0 - alpha / 2.0)\n\n        # Calculate the significance threshold\n        # SE for sample covariance under H0 is approx. s_u * s_v / sqrt(N)\n        threshold = z_alpha_2 * s_u * s_v / np.sqrt(N)\n        \n        # Apply the filter: if the estimate is not statistically significant,\n        # set it to zero. Otherwise, keep it.\n        if abs_pre  threshold:\n            filtered_stress_abs = 0.0\n        else:\n            filtered_stress_abs = abs_pre\n            \n        results.append(filtered_stress_abs)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "The central challenge in RANS modeling is to accurately represent the dynamic interaction between the mean flow and the turbulent fluctuations. This practice begins by deriving the transport equation for the mean flow's kinetic energy, allowing you to formally identify the production term, $-\\overline{u_i' u_j'} \\partial_j \\overline{u}_i$. This crucial term quantifies the rate at which kinetic energy is transferred between the large-scale mean motion and the turbulent eddies. \n\nFollowing the derivation, you will engage in a computational experiment to explore the behavior of this term. You will see how in typical shear flows, energy is transferred from the mean flow to turbulence, but also investigate physically important scenarios involving counter-gradient transport, where energy flows from the fluctuations back to the mean flow. This phenomenon, known as \"backscatter,\" highlights a fundamental limitation of simple eddy-viscosity models, which are inherently unable to capture such physics.",
            "id": "3357831",
            "problem": "Consider a constant-density, incompressible, Newtonian fluid governed by the fundamental momentum balance and mass conservation. The fundamental base you must start from is the following:\n\n- Incompressible continuity: $\\partial_i u_i = 0$.\n- Newtonian momentum equation: $\\partial_t u_i + u_j \\partial_j u_i = -\\frac{1}{\\rho} \\partial_i p + \\nu \\partial_j \\partial_j u_i + f_i$, where $\\rho$ is density, $\\nu$ is kinematic viscosity, and $f_i$ is a body force per unit mass.\n\nTask A (derivation): Applying Reynolds decomposition $u_i = \\bar{u}_i + u_i'$ and $p = \\bar{p} + p'$ and an averaging operator satisfying Reynolds rules, derive the mean kinetic energy equation for the mean flow of the Reynolds-Averaged Navier-Stokes (RANS) system. Your derivation must begin from the stated fundamental base and use only mathematically valid manipulations and identities consistent with incompressibility. Identify the term that transfers kinetic energy between the mean field and turbulent fluctuations, and express this term in a coordinate-free tensor contraction with the mean velocity gradient. Do not use any shortcut formula; your derivation must be from first principles.\n\nTask B (controlled experiment and computation): Design a controlled, spatially uniform experiment in which the transfer term of Task A changes sign by varying the sign of the Reynolds stress relative to the mean velocity gradient. For mathematical concreteness, represent the mean velocity gradient by a constant tensor $G_{ij} = \\partial_j \\bar{u}_i$ (units $\\mathrm{s}^{-1}$) and the Reynolds stress by a constant symmetric tensor $R_{ij} = \\overline{u_i' u_j'}$ (units $\\mathrm{m}^2\\,\\mathrm{s}^{-2}$). For each case, the instantaneous rate of mean-to-turbulence kinetic energy transfer per unit mass is defined as the scalar\n$$\nP \\equiv -\\sum_{i=1}^3 \\sum_{j=1}^3 R_{ij} \\, G_{ij},\n$$\nwith units $\\mathrm{m}^2\\,\\mathrm{s}^{-3}$.\n\nAdditionally, to assess a common modeling response, compute the prediction of the Boussinesq eddy viscosity closure, which assumes $R_{ij}^{\\text{model}} \\approx -2 \\nu_t S_{ij}$ where $S_{ij} \\equiv \\tfrac{1}{2}(G_{ij}+G_{ji})$ is the mean rate-of-strain tensor and $\\nu_t \\ge 0$ is a scalar eddy viscosity. For a given $(R_{ij},G_{ij})$, define the least-squares best-fit eddy viscosity\n$$\n\\nu_t^\\star \\equiv -\\frac{\\sum_{i,j} R_{ij}\\, S_{ij}}{2 \\sum_{i,j} S_{ij}\\, S_{ij}},\n$$\nand constrain the model to $\\nu_t = \\max(0,\\nu_t^\\star)$. The corresponding modeled transfer rate is then\n$$\nP_{\\text{model}} \\equiv 2 \\nu_t \\sum_{i,j} S_{ij}\\, S_{ij}.\n$$\n\nYou must implement a program that, for each test case, computes the pair $(P, P_{\\text{model}})$ and a boolean flag indicating whether $P$ is negative (sign change relative to the canonical positive mean-to-turbulence transfer). All computed transfer rates must be expressed in $\\mathrm{m}^2\\,\\mathrm{s}^{-3}$, rounded to six decimal places.\n\nTest Suite: Use the following five scientifically plausible cases (all tensors are $3 \\times 3$ with entries in SI units):\n\n- Case $1$ (canonical plane shear, positive transfer): $G = \\begin{bmatrix} 0  5  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{bmatrix}\\,\\mathrm{s}^{-1}$, $R = \\begin{bmatrix} 0  -0.02  0 \\\\ -0.02  0  0 \\\\ 0  0  0 \\end{bmatrix}\\,\\mathrm{m}^2\\,\\mathrm{s}^{-2}$.\n- Case $2$ (counter-gradient, negative transfer): $G = \\begin{bmatrix} 0  5  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{bmatrix}\\,\\mathrm{s}^{-1}$, $R = \\begin{bmatrix} 0  0.005  0 \\\\ 0.005  0  0 \\\\ 0  0  0 \\end{bmatrix}\\,\\mathrm{m}^2\\,\\mathrm{s}^{-2}$.\n- Case $3$ (zero shear boundary case): $G = \\begin{bmatrix} 0  0  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{bmatrix}\\,\\mathrm{s}^{-1}$, $R = \\begin{bmatrix} 0  -0.01  0 \\\\ -0.01  0  0 \\\\ 0  0  0 \\end{bmatrix}\\,\\mathrm{m}^2\\,\\mathrm{s}^{-2}$.\n- Case $4$ (three-dimensional mixed gradients with anisotropic stress): $G = \\begin{bmatrix} 0  4  0 \\\\ 2  0  -3 \\\\ 0  0  0 \\end{bmatrix}\\,\\mathrm{s}^{-1}$, $R = \\begin{bmatrix} 0.10  -0.03  0.00 \\\\ -0.03  0.08  0.01 \\\\ 0.00  0.01  0.05 \\end{bmatrix}\\,\\mathrm{m}^2\\,\\mathrm{s}^{-2}$.\n- Case $5$ (closure-consistent shear with known eddy viscosity): $G = \\begin{bmatrix} 0  10  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{bmatrix}\\,\\mathrm{s}^{-1}$, with a known eddy viscosity $\\nu_t = 0.01\\,\\mathrm{m}^2\\,\\mathrm{s}^{-1}$ used to define $R$ via $R = -2 \\nu_t S$ where $S = \\tfrac{1}{2}(G+G^\\top)$; explicitly $R = \\begin{bmatrix} 0  -0.10  0 \\\\ -0.10  0  0 \\\\ 0  0  0 \\end{bmatrix}\\,\\mathrm{m}^2\\,\\mathrm{s}^{-2}$.\n\nAnswer specification and final output format: Your program must produce a single line containing a list of results, one per test case, where each result is the list $[P, P_{\\text{model}}, \\text{is\\_negative}]$ with $P$ and $P_{\\text{model}}$ rounded to six decimal places and $\\text{is\\_negative}$ a boolean indicating whether $P  0$. The overall output must be a single list enclosing the five case results, formatted exactly as a comma-separated list enclosed in square brackets, for example\n$[[P_1,P_{\\text{model},1},\\text{is\\_negative}_1],[P_2,P_{\\text{model},2},\\text{is\\_negative}_2],\\dots]$,\nwith all $P$ and $P_{\\text{model}}$ in $\\mathrm{m}^2\\,\\mathrm{s}^{-3}$.",
            "solution": "We begin from the incompressible mass conservation $\\partial_i u_i = 0$ and the Newtonian momentum equation $\\partial_t u_i + u_j \\partial_j u_i = -\\frac{1}{\\rho} \\partial_i p + \\nu \\partial_j \\partial_j u_i + f_i$. Introduce Reynolds decomposition $u_i = \\bar{u}_i + u_i'$ and $p = \\bar{p} + p'$, and apply an averaging operator with Reynolds rules, $\\overline{u_i'} = 0$, $\\overline{\\bar{u}_i} = \\bar{u}_i$, linearity, and commutation with differentiation for statistically stationary averages. The Reynolds-Averaged Navier-Stokes (RANS) mean momentum equation is\n$$\n\\partial_t \\bar{u}_i + \\bar{u}_j \\partial_j \\bar{u}_i = -\\frac{1}{\\rho} \\partial_i \\bar{p} + \\nu \\partial_j \\partial_j \\bar{u}_i - \\partial_j \\overline{u_i' u_j'} + \\bar{f}_i,\n$$\nwith $\\partial_i \\bar{u}_i = 0$.\n\nTo derive the mean kinetic energy equation, multiply the mean momentum equation by $\\bar{u}_i$, and use product rules and incompressibility. Define the mean kinetic energy per unit mass $K \\equiv \\tfrac{1}{2} \\bar{u}_i \\bar{u}_i$. The time derivative term becomes $\\bar{u}_i \\partial_t \\bar{u}_i = \\partial_t K$. The mean convection term is $\\bar{u}_i \\bar{u}_j \\partial_j \\bar{u}_i = \\bar{u}_j \\partial_j K$ by the chain rule. Pressure work combines into a divergence using $\\bar{u}_i \\partial_i \\bar{p} = \\partial_i (\\bar{p}\\,\\bar{u}_i) - \\bar{p} \\partial_i \\bar{u}_i = \\partial_i (\\bar{p}\\,\\bar{u}_i)$ due to $\\partial_i \\bar{u}_i = 0$. Viscous work splits into a sum of a dissipation-like term and a divergence: $\\nu \\bar{u}_i \\partial_j \\partial_j \\bar{u}_i = \\nu \\partial_j (\\bar{u}_i \\partial_j \\bar{u}_i) - \\nu (\\partial_j \\bar{u}_i) (\\partial_j \\bar{u}_i)$. Body force work is $\\bar{f}_i \\bar{u}_i$. The Reynolds stress transport term contributes $\\bar{u}_i \\left(-\\partial_j \\overline{u_i' u_j'}\\right) = -\\partial_j(\\bar{u}_i \\overline{u_i' u_j'}) + \\overline{u_i' u_j'} \\partial_j \\bar{u}_i$ by product rules.\n\nCollecting terms into a conservative form,\n$$\n\\partial_t K + \\bar{u}_j \\partial_j K + \\partial_j\\left(\\frac{\\bar{p}}{\\rho}\\bar{u}_j + \\nu \\bar{u}_i \\partial_j \\bar{u}_i - \\bar{u}_i \\overline{u_i' u_j'}\\right)\n= -\\nu (\\partial_j \\bar{u}_i)(\\partial_j \\bar{u}_i) - \\overline{u_i' u_j'}\\,\\partial_j \\bar{u}_i + \\bar{f}_i \\bar{u}_i.\n$$\nHere, the scalar term $-\\overline{u_i' u_j'}\\,\\partial_j \\bar{u}_i$ transfers kinetic energy between mean and turbulent fields: when it is positive, mean kinetic energy is lost (a sink) and turbulent kinetic energy is produced; when it is negative, turbulent fluctuations feed energy back into the mean flow (a source for the mean). Because the Reynolds stress tensor $R_{ij} \\equiv \\overline{u_i' u_j'}$ is symmetric, and the mean velocity gradient $\\partial_j \\bar{u}_i$ can be decomposed into the symmetric rate-of-strain $S_{ij} \\equiv \\tfrac{1}{2}(\\partial_j \\bar{u}_i + \\partial_i \\bar{u}_j)$ and the antisymmetric rotation $W_{ij} \\equiv \\tfrac{1}{2}(\\partial_j \\bar{u}_i - \\partial_i \\bar{u}_j)$, the contraction simplifies to $-\\overline{u_i' u_j'}\\,\\partial_j \\bar{u}_i = -R_{ij} S_{ij}$ because $R_{ij} W_{ij} = 0$.\n\nFor the controlled experiment, we choose spatially uniform $G_{ij} \\equiv \\partial_j \\bar{u}_i$ and $R_{ij}$ to form five test cases. The transfer rate per unit mass is defined as\n$$\nP \\equiv -\\sum_{i=1}^3 \\sum_{j=1}^3 R_{ij}\\,G_{ij},\n$$\nwith units $\\mathrm{m}^2\\,\\mathrm{s}^{-3}$. To assess the model response, adopt the Boussinesq eddy viscosity closure for the modeled Reynolds stress, $R_{ij}^{\\text{model}} \\approx -2 \\nu_t S_{ij}$, where $S_{ij} = \\tfrac{1}{2}(G_{ij}+G_{ji})$ and $\\nu_t \\ge 0$. For a given $(R,G)$, the least-squares fit for a scalar $\\nu_t^\\star$ minimizing $\\|R + 2 \\nu_t S\\|_F^2$ yields\n$$\n\\nu_t^\\star = -\\frac{\\sum_{i,j} R_{ij} S_{ij}}{2 \\sum_{i,j} S_{ij} S_{ij}},\n$$\nand constraining the model $\\nu_t = \\max(0,\\nu_t^\\star)$ ensures nonnegative modeled production. The modeled transfer rate is\n$$\nP_{\\text{model}} = 2 \\nu_t \\sum_{i,j} S_{ij} S_{ij}.\n$$\n\nThe five test cases are as specified, all expressed in SI units. The computational algorithm for each case is:\n\n- Compute $P = -\\sum_{i,j} R_{ij} G_{ij}$.\n- Compute $S = \\tfrac{1}{2}(G + G^\\top)$, the Frobenius norm squared $||S||_F^2 = \\sum_{i,j} S_{ij} S_{ij}$, and the inner product $\\langle R,S \\rangle = \\sum_{i,j} R_{ij} S_{ij}$.\n- If $||S||_F^2 = 0$, set $P_{\\text{model}} = 0$. Otherwise, compute $\\nu_t^\\star = -\\langle R,S\\rangle / (2 ||S||_F^2)$ and $\\nu_t = \\max(0,\\nu_t^\\star)$, then $P_{\\text{model}} = 2 \\nu_t ||S||_F^2$.\n- The boolean flag $\\text{is\\_negative}$ is true if $P  0$.\n\nInterpretation and physical plausibility: In canonical shear-driven turbulence, the cross-correlation $R_{12} = \\overline{u' v'}$ is typically opposite in sign to the mean shear $G_{12} = \\partial_y \\bar{u}$, so $P$ is positive, indicating transfer from the mean to turbulence. Counter-gradient momentum transport can occur in strongly rotating shear flows (e.g., low absolute vorticity) or in flows with strong curvature or nonlocal history effects, causing $R_{12}$ to have the same sign as $G_{12}$, rendering $P$ negative. The scalar eddy viscosity Boussinesq closure enforces $\\nu_t \\ge 0$, implying $P_{\\text{model}} \\ge 0$ and thus cannot represent negative $P$; in the least-squares fit, this manifests as $\\nu_t^\\star  0$ being truncated to $0$, yielding $P_{\\text{model}} = 0$ where the true transfer $P$ is negative. The boundary case with zero shear has $S_{ij} = 0$ and both $P$ and $P_{\\text{model}}$ equal to $0$, consistent with no mean-to-turbulence transfer.\n\nFinally, your program must implement these computations for the specified test suite, and print a single line containing a list of five results, each as $[P, P_{\\text{model}}, \\text{is\\_negative}]$ with $P$ and $P_{\\text{model}}$ rounded to six decimal places and units $\\mathrm{m}^2\\,\\mathrm{s}^{-3}$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_production(R: np.ndarray, G: np.ndarray) - float:\n    \"\"\"\n    Compute mean-to-turbulence kinetic energy transfer rate:\n    P = - sum_{i,j} R_ij * G_ij\n    Units: m^2/s^3\n    \"\"\"\n    return float(-np.sum(R * G))\n\ndef compute_model_production(R: npndarray, G: np.ndarray) - float:\n    \"\"\"\n    Compute modeled transfer rate using Boussinesq eddy viscosity closure with\n    nonnegative least-squares best-fit nu_t.\n    S = 0.5 * (G + G^T)\n    nu_t* = - R,S / (2 S,S)\n    nu_t = max(0, nu_t*)\n    P_model = 2 * nu_t * S,S\n    Edge case: if S,S == 0, return 0.\n    \"\"\"\n    S = 0.5 * (G + G.T)\n    denom = float(np.sum(S * S))\n    if denom == 0.0:\n        return 0.0\n    numerator = float(np.sum(R * S))\n    nu_t_star = - numerator / (2.0 * denom)\n    nu_t = max(0.0, nu_t_star)\n    return float(2.0 * nu_t * denom)\n\ndef format_result_list(results):\n    \"\"\"\n    Format the results as a single-line string of nested lists,\n    with floats rounded to six decimals and booleans as True/False.\n    \"\"\"\n    def fmt_float(x):\n        return f\"{x:.6f}\"\n    parts = []\n    for p_true, p_model, is_neg in results:\n        parts.append(f\"[{fmt_float(p_true)},{fmt_float(p_model)},{str(is_neg)}]\")\n    return \"[\" + \",\".join(parts) + \"]\"\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case is a tuple (R, G) with 3x3 numpy arrays.\n    test_cases = [\n        # Case 1: canonical plane shear, positive transfer\n        (\n            np.array([[0.0, -0.02, 0.0],\n                      [-0.02, 0.0,  0.0],\n                      [0.0,  0.0,  0.0]]),\n            np.array([[0.0, 5.0, 0.0],\n                      [0.0, 0.0, 0.0],\n                      [0.0, 0.0, 0.0]])\n        ),\n        # Case 2: counter-gradient, negative transfer\n        (\n            np.array([[0.0, 0.005, 0.0],\n                      [0.005, 0.0,  0.0],\n                      [0.0,  0.0,  0.0]]),\n            np.array([[0.0, 5.0, 0.0],\n                      [0.0, 0.0, 0.0],\n                      [0.0, 0.0, 0.0]])\n        ),\n        # Case 3: zero shear boundary case\n        (\n            np.array([[0.0, -0.01, 0.0],\n                      [-0.01, 0.0,  0.0],\n                      [0.0,  0.0,  0.0]]),\n            np.zeros((3,3))\n        ),\n        # Case 4: three-dimensional mixed gradients with anisotropic stress\n        (\n            np.array([[0.10, -0.03, 0.00],\n                      [-0.03, 0.08, 0.01],\n                      [0.00, 0.01, 0.05]]),\n            np.array([[0.0, 4.0, 0.0],\n                      [2.0, 0.0, -3.0],\n                      [0.0, 0.0, 0.0]])\n        ),\n        # Case 5: closure-consistent shear with known eddy viscosity nu_t=0.01\n        (\n            np.array([[0.0, -0.10, 0.0],\n                      [-0.10, 0.0,  0.0],\n                      [0.0,  0.0,  0.0]]),\n            np.array([[0.0, 10.0, 0.0],\n                      [0.0,  0.0, 0.0],\n                      [0.0,  0.0, 0.0]])\n        ),\n    ]\n\n    results = []\n    for R, G in test_cases:\n        p_true = compute_production(R, G)\n        p_model = compute_model_production(R, G)\n        is_negative = p_true  0.0\n        results.append((p_true, p_model, is_negative))\n\n    # Final print statement in the exact required format.\n    print(format_result_list(results))\n\nsolve()\n```"
        },
        {
            "introduction": "Having seen that simple turbulence models can fail to capture important physics, we must establish fundamental principles that any physically sound model must obey. One of the most important of these is \"realizability,\" a constraint ensuring that a model does not predict impossible physical states. A key realizability condition is that the normal Reynolds stress component in any direction, which represents a mean-square velocity fluctuation $\\overline{(a_k u'_k)^2}$, must be non-negative. \n\nThis exercise makes the abstract concept of realizability tangible and clear. By analyzing a hypothetical but mathematically simple closure for the Reynolds stress anisotropy tensor, you will demonstrate how an improperly constructed model can violate this fundamental principle. You will explicitly calculate a negative value for a normal stress, thereby proving the model is unphysical and gaining a deeper appreciation for the constraints that guide modern turbulence model development.",
            "id": "3357813",
            "problem": "Consider an incompressible turbulent flow governed by the Reynolds-Averaged Navier–Stokes (RANS) equations. Let the instantaneous velocity be decomposed by Reynolds decomposition as $u_{i} = U_{i} + u_{i}'$, where $U_{i}$ is the mean velocity and $u_{i}'$ is the fluctuation. The Reynolds stress tensor is defined as $R_{ij} = \\overline{u_{i}' u_{j}'}$, and the turbulent kinetic energy is defined as $k = \\frac{1}{2} R_{ii}$. The Reynolds stress anisotropy tensor is defined by $b_{ij} = \\frac{R_{ij}}{2k} - \\frac{1}{3} \\delta_{ij}$, where $\\delta_{ij}$ is the Kronecker delta.\n\nFrom the covariance structure of $R_{ij}$, realizability requires that for any unit vector $a_{i}$, the quadratic form $a_{i} R_{ij} a_{j}$ be nonnegative, because it equals the mean square of the scalar projection of the fluctuations along $a_{i}$. In this problem, you will construct a hypothetical closure that violates this realizability.\n\nSuppose one proposes the following hypothetical closure for the anisotropy:\n$$\nb_{ij} = -\\gamma\\, \\delta_{ij},\n$$\nwith a constant $\\gamma  0$. Then the modeled Reynolds stress is\n$$\nR_{ij} = 2k\\, b_{ij} + \\frac{2}{3}k\\, \\delta_{ij}.\n$$\nAssume $k  0$, and let the unit vector be $a_{i} = (1,0,0)$, so that $a_{i} a_{j} \\delta_{ij} = 1$ and $a_{i} a_{j} b_{ij} = b_{11}$.\n\nUsing only the definitions above and the requirement that $a_{i} R_{ij} a_{j}$ represent a mean square, first justify why realizability demands $a_{i} R_{ij} a_{j} \\ge 0$ for any unit vector $a_{i}$. Then, for the specific hypothetical closure with $\\gamma = \\frac{1}{2}$, compute the dimensionless quantity\n$$\nr \\equiv \\frac{a_{i} R_{ij} a_{j}}{k}\n$$\nfor the choice $a_{i} = (1,0,0)$, and show explicitly that this value violates realizability. Express the final answer as the pure number $r$ with no units.",
            "solution": "The problem statement is validated as scientifically grounded, well-posed, and objective. It is a standard pedagogical exercise in the field of turbulence modeling to demonstrate the concept of realizability. All necessary information is provided, and the task is clearly defined.\n\nThe problem asks for three items: first, a justification for the realizability condition; second, the calculation of a specific dimensionless quantity for a hypothetical turbulence model; and third, a demonstration that this model violates realizability.\n\nFirst, we justify the realizability condition, which states that for any unit vector $a_{i}$, the quadratic form $a_{i} R_{ij} a_{j}$ must be non-negative. The Reynolds stress tensor $R_{ij}$ is defined as the time average of the product of velocity fluctuations, $R_{ij} = \\overline{u_{i}' u_{j}'}$. Let $a_{i}$ be a constant unit vector representing a specific spatial direction. The quadratic form is then:\n$$\na_{i} R_{ij} a_{j} = a_{i} (\\overline{u_{i}' u_{j}'}) a_{j}\n$$\nSince the averaging operator is linear and the components of $a_{i}$ are constants, we can bring them inside the average:\n$$\na_{i} R_{ij} a_{j} = \\overline{(a_{i} u_{i}') (a_{j} u_{j}')}\n$$\nLet us define a scalar quantity $v'$ as the scalar projection of the fluctuating velocity vector $u_{k}'$ onto the direction specified by the unit vector $a_{k}$. Using index notation, this is $v' = a_{k} u_{k}'$. The expression above can then be rewritten as:\n$$\na_{i} R_{ij} a_{j} = \\overline{(v')^2}\n$$\nThis quantity, $\\overline{(v')^2}$, represents the mean square of the fluctuating velocity component in the direction of $a_{i}$. As the time average of a squared real number, it must be non-negative. Therefore, any physically realistic Reynolds stress tensor must satisfy the condition $a_{i} R_{ij} a_{j} \\ge 0$ for any choice of unit vector $a_{i}$. This property is known as realizability.\n\nSecond, we compute the dimensionless quantity $r \\equiv \\frac{a_{i} R_{ij} a_{j}}{k}$ for the specified hypothetical closure. The problem provides the modeled Reynolds stress tensor as:\n$$\nR_{ij} = 2k\\, b_{ij} + \\frac{2}{3}k\\, \\delta_{ij}\n$$\nwhere the anisotropy tensor $b_{ij}$ is given by the hypothetical closure:\n$$\nb_{ij} = -\\gamma\\, \\delta_{ij}\n$$\nwith the constant $\\gamma = \\frac{1}{2}$. We substitute the expression for $R_{ij}$ into the definition of $r$:\n$$\nr = \\frac{a_{i} \\left( 2k\\, b_{ij} + \\frac{2}{3}k\\, \\delta_{ij} \\right) a_{j}}{k}\n$$\nGiven that the turbulent kinetic energy $k$ is a scalar and $k  0$, we can factor it out from the numerator and cancel it with the denominator:\n$$\nr = a_{i} \\left( 2\\, b_{ij} + \\frac{2}{3}\\, \\delta_{ij} \\right) a_{j} = 2 a_{i} b_{ij} a_{j} + \\frac{2}{3} a_{i} \\delta_{ij} a_{j}\n$$\nNow, we substitute the hypothetical closure for $b_{ij}$:\n$$\nr = 2 a_{i} (-\\gamma\\, \\delta_{ij}) a_{j} + \\frac{2}{3} a_{i} \\delta_{ij} a_{j}\n$$\nFactoring out the common term $a_{i} \\delta_{ij} a_{j}$:\n$$\nr = \\left( -2\\gamma + \\frac{2}{3} \\right) (a_{i} \\delta_{ij} a_{j})\n$$\nThe term $a_{i} \\delta_{ij} a_{j}$ simplifies to $a_{i} a_{i}$, which is the squared magnitude of the vector $a_{i}$. Since $a_{i}$ is a unit vector, its magnitude is $1$, and its squared magnitude is also $1$. The problem confirms this for the specific choice $a_{i} = (1,0,0)$ by stating $a_{i} a_{j} \\delta_{ij} = 1$. Thus, the expression for $r$ simplifies to:\n$$\nr = -2\\gamma + \\frac{2}{3}\n$$\nThe problem specifies the value $\\gamma = \\frac{1}{2}$. Substituting this value:\n$$\nr = -2 \\left(\\frac{1}{2}\\right) + \\frac{2}{3} = -1 + \\frac{2}{3} = -\\frac{1}{3}\n$$\n\nThird, we show that this result violates realizability. The realizability condition is $a_{i} R_{ij} a_{j} \\ge 0$. Since we are given $k  0$, this condition is equivalent to requiring the dimensionless quantity $r = \\frac{a_{i} R_{ij} a_{j}}{k}$ to be non-negative, i.e., $r \\ge 0$. Our calculation for the hypothetical model with $\\gamma = \\frac{1}{2}$ yielded the result $r = -\\frac{1}{3}$. Since $-\\frac{1}{3}  0$, the non-negativity condition is violated. This demonstrates explicitly that the proposed closure $b_{ij} = -\\gamma\\, \\delta_{ij}$ with $\\gamma = \\frac{1}{2}$ is unphysical because it leads to a negative mean-square fluctuating velocity component, which is impossible.",
            "answer": "$$\\boxed{-\\frac{1}{3}}$$"
        }
    ]
}