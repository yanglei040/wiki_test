{
    "hands_on_practices": [
        {
            "introduction": "要深刻理解湍流，核心在于掌握能量如何在平均流与脉动流之间传递。这项练习将引导你从第一性原理出发，推导平均动能方程，并识别出湍流生成项。通过一个精心设计的数值实验，你将亲自探索该项如何改变符号，从而揭示一种重要的非平衡湍流现象——能量“逆梯度”输运，并检验标准涡粘模型在此类情况下的预测能力。",
            "id": "3357831",
            "problem": "考虑一个由基本动量平衡和质量守恒控制的恒定密度、不可压缩的牛顿流体。您必须从以下基本方程出发：\n\n- 不可压缩连续性方程：$\\partial_i u_i = 0$。\n- 牛顿动量方程：$\\partial_t u_i + u_j \\partial_j u_i = -\\frac{1}{\\rho} \\partial_i p + \\nu \\partial_j \\partial_j u_i + f_i$，其中 $\\rho$ 是密度，$\\nu$ 是运动粘度，而 $f_i$ 是单位质量的体力。\n\n任务A（推导）：应用雷诺分解 $u_i = \\bar{u}_i + u_i'$ 和 $p = \\bar{p} + p'$ 以及满足雷诺法则的平均算子，推导雷诺平均纳维-斯托克斯 (RANS) 系统中平均流的平均动能方程。您的推导必须从上述基本方程出发，并且只能使用与不可压缩性一致的、数学上有效的操作和恒等式。识别在平均场和湍流脉动之间传递动能的项，并用该项与平均速度梯度的无坐标张量缩并形式表示。不要使用任何快捷公式；您的推导必须从第一性原理出发。\n\n任务B（受控实验与计算）：设计一个受控的、空间均匀的实验，在该实验中，通过改变雷诺应力相对于平均速度梯度的符号，使任务A中的能量转移项改变符号。为了数学上的具体性，将平均速度梯度表示为一个常数张量 $G_{ij} = \\partial_j \\bar{u}_i$（单位为 $\\mathrm{s}^{-1}$），将雷诺应力表示为一个常数对称张量 $R_{ij} = \\overline{u_i' u_j'}$（单位为 $\\mathrm{m}^2\\,\\mathrm{s}^{-2}$）。对于每种情况，单位质量的平均动能向湍流动能的瞬时转移率定义为标量\n$$\nP \\equiv -\\sum_{i=1}^3 \\sum_{j=1}^3 R_{ij} \\, G_{ij},\n$$\n单位为 $\\mathrm{m}^2\\,\\mathrm{s}^{-3}$。\n\n此外，为了评估一种常见的模型响应，计算 Boussinesq 涡粘性封闭的预测结果，该模型假设 $R_{ij}^{\\text{model}} \\approx -2 \\nu_t S_{ij}$，其中 $S_{ij} \\equiv \\tfrac{1}{2}(G_{ij}+G_{ji})$ 是平均应变率张量，$\\nu_t \\ge 0$ 是一个标量涡粘性。对于给定的 $(R_{ij},G_{ij})$，定义最小二乘最佳拟合的涡粘性\n$$\n\\nu_t^\\star \\equiv -\\frac{\\sum_{i,j} R_{ij}\\, S_{ij}}{2 \\sum_{i,j} S_{ij}\\, S_{ij}},\n$$\n并将模型约束为 $\\nu_t = \\max(0,\\nu_t^\\star)$。相应的模型化转移率则为\n$$\nP_{\\text{model}} \\equiv 2 \\nu_t \\sum_{i,j} S_{ij}\\, S_{ij}.\n$$\n\n您必须实现一个程序，对于每个测试用例，计算数组 $(P, P_{\\text{model}})$ 和一个布尔标志，该标志指示 $P$ 是否为负（相对于典型的正平均动能到湍流动能转移的符号变化）。所有计算出的转移率必须以 $\\mathrm{m}^2\\,\\mathrm{s}^{-3}$ 为单位表示，并四舍五入到六位小数。\n\n测试套件：使用以下五个科学上合理的案例（所有张量均为 $3 \\times 3$，其分量采用国际单位制）：\n\n- 案例1（典型平面剪切，正转移）：$G = \\begin{bmatrix} 0  5  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{bmatrix}\\,\\mathrm{s}^{-1}$，$R = \\begin{bmatrix} 0  -0.02  0 \\\\ -0.02  0  0 \\\\ 0  0  0 \\end{bmatrix}\\,\\mathrm{m}^2\\,\\mathrm{s}^{-2}$。\n- 案例2（逆梯度，负转移）：$G = \\begin{bmatrix} 0  5  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{bmatrix}\\,\\mathrm{s}^{-1}$，$R = \\begin{bmatrix} 0  0.005  0 \\\\ 0.005  0  0 \\\\ 0  0  0 \\end{bmatrix}\\,\\mathrm{m}^2\\,\\mathrm{s}^{-2}$。\n- 案例3（零剪切边界情况）：$G = \\begin{bmatrix} 0  0  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{bmatrix}\\,\\mathrm{s}^{-1}$，$R = \\begin{bmatrix} 0  -0.01  0 \\\\ -0.01  0  0 \\\\ 0  0  0 \\end{bmatrix}\\,\\mathrm{m}^2\\,\\mathrm{s}^{-2}$。\n- 案例4（具有各向异性应力的三维混合梯度）：$G = \\begin{bmatrix} 0  4  0 \\\\ 2  0  -3 \\\\ 0  0  0 \\end{bmatrix}\\,\\mathrm{s}^{-1}$，$R = \\begin{bmatrix} 0.10  -0.03  0.00 \\\\ -0.03  0.08  0.01 \\\\ 0.00  0.01  0.05 \\end{bmatrix}\\,\\mathrm{m}^2\\,\\mathrm{s}^{-2}$。\n- 案例5（与已知涡粘性的封闭模型一致的剪切）：$G = \\begin{bmatrix} 0  10  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{bmatrix}\\,\\mathrm{s}^{-1}$，使用已知的涡粘性 $\\nu_t = 0.01\\,\\mathrm{m}^2\\,\\mathrm{s}^{-1}$ 通过 $R = -2 \\nu_t S$ 定义 $R$，其中 $S = \\tfrac{1}{2}(G+G^\\top)$；具体为 $R = \\begin{bmatrix} 0  -0.10  0 \\\\ -0.10  0  0 \\\\ 0  0  0 \\end{bmatrix}\\,\\mathrm{m}^2\\,\\mathrm{s}^{-2}$。\n\n答案规范和最终输出格式：您的程序必须生成单行输出，包含一个结果列表，每个测试用例一个结果，其中每个结果都是一个列表 $[P, P_{\\text{model}}, \\text{is\\_negative}]$，其中 $P$ 和 $P_{\\text{model}}$ 四舍五入到六位小数，$\\text{is\\_negative}$ 是一个布尔值，指示是否 $P  0$。总输出必须是一个包含五个案例结果的列表，其格式严格为方括号内用逗号分隔的列表，例如\n$[[P_1,P_{\\text{model},1},\\text{is\\_negative}_1],[P_2,P_{\\text{model},2},\\text{is\\_negative}_2],\\dots]$，\n其中所有的 $P$ 和 $P_{\\text{model}}$ 均以 $\\mathrm{m}^2\\,\\mathrm{s}^{-3}$ 为单位。",
            "solution": "我们从不可压缩质量守恒方程 $\\partial_i u_i = 0$ 和牛顿动量方程 $\\partial_t u_i + u_j \\partial_j u_i = -\\frac{1}{\\rho} \\partial_i p + \\nu \\partial_j \\partial_j u_i + f_i$ 出发。引入雷诺分解 $u_i = \\bar{u}_i + u_i'$ 和 $p = \\bar{p} + p'$，并对统计平稳平均应用满足雷诺法则（$\\overline{u_i'} = 0$，$\\overline{\\bar{u}_i} = \\bar{u}_i$，线性，以及与微分算子可交换）的平均算子。雷诺平均纳维-斯托克斯 (RANS) 平均动量方程为\n$$\n\\partial_t \\bar{u}_i + \\bar{u}_j \\partial_j \\bar{u}_i = -\\frac{1}{\\rho} \\partial_i \\bar{p} + \\nu \\partial_j \\partial_j \\bar{u}_i - \\partial_j \\overline{u_i' u_j'} + \\bar{f}_i,\n$$\n其中 $\\partial_i \\bar{u}_i = 0$。\n\n为了推导平均动能方程，将平均动量方程乘以 $\\bar{u}_i$，并使用乘法法则和不可压缩性条件。定义单位质量的平均动能 $K \\equiv \\tfrac{1}{2} \\bar{u}_i \\bar{u}_i$。时间导数项变为 $\\bar{u}_i \\partial_t \\bar{u}_i = \\partial_t K$。平均对流项根据链式法则是 $\\bar{u}_i \\bar{u}_j \\partial_j \\bar{u}_i = \\bar{u}_j \\partial_j K$。压力功项使用 $\\bar{u}_i \\partial_i \\bar{p} = \\partial_i (\\bar{p}\\,\\bar{u}_i) - \\bar{p} \\partial_i \\bar{u}_i = \\partial_i (\\bar{p}\\,\\bar{u}_i)$（由于 $\\partial_i \\bar{u}_i = 0$）合并为一个散度项。粘性功项分裂为一个类耗散项和一个散度项的和：$\\nu \\bar{u}_i \\partial_j \\partial_j \\bar{u}_i = \\nu \\partial_j (\\bar{u}_i \\partial_j \\bar{u}_i) - \\nu (\\partial_j \\bar{u}_i) (\\partial_j \\bar{u}_i)$。体力功是 $\\bar{f}_i \\bar{u}_i$。雷诺应力输运项根据乘法法则贡献了 $\\bar{u}_i \\left(-\\partial_j \\overline{u_i' u_j'}\\right) = -\\partial_j(\\bar{u}_i \\overline{u_i' u_j'}) + \\overline{u_i' u_j'} \\partial_j \\bar{u}_i$。\n\n将各项整理成守恒形式，\n$$\n\\partial_t K + \\bar{u}_j \\partial_j K + \\partial_j\\left(\\frac{\\bar{p}}{\\rho}\\bar{u}_j + \\nu \\bar{u}_i \\partial_j \\bar{u}_i - \\bar{u}_i \\overline{u_i' u_j'}\\right)\n= -\\nu (\\partial_j \\bar{u}_i)(\\partial_j \\bar{u}_i) - \\overline{u_i' u_j'}\\,\\partial_j \\bar{u}_i + \\bar{f}_i \\bar{u}_i.\n$$\n此处，标量项 $-\\overline{u_i' u_j'}\\,\\partial_j \\bar{u}_i$ 在平均场和湍流场之间传递动能：当其为正时，平均动能损失（一个汇），湍流动能产生；当其为负时，湍流脉动将能量反馈给平均流（平均流的一个源）。因为雷诺应力张量 $R_{ij} \\equiv \\overline{u_i' u_j'}$ 是对称的，而平均速度梯度 $\\partial_j \\bar{u}_i$ 可以分解为对称的应变率 $S_{ij} \\equiv \\tfrac{1}{2}(\\partial_j \\bar{u}_i + \\partial_i \\bar{u}_j)$ 和反对称的旋转 $W_{ij} \\equiv \\tfrac{1}{2}(\\partial_j \\bar{u}_i - \\partial_i \\bar{u}_j)$，所以该缩并简化为 $-\\overline{u_i' u_j'}\\,\\partial_j \\bar{u}_i = -R_{ij} S_{ij}$，因为 $R_{ij} W_{ij} = 0$。\n\n对于受控实验，我们选择空间均匀的 $G_{ij} \\equiv \\partial_j \\bar{u}_i$ 和 $R_{ij}$ 来构建五个测试用例。单位质量的转移率定义为\n$$\nP \\equiv -\\sum_{i=1}^3 \\sum_{j=1}^3 R_{ij}\\,G_{ij},\n$$\n单位为 $\\mathrm{m}^2\\,\\mathrm{s}^{-3}$。为了评估模型响应，我们采用 Boussinesq 涡粘性封闭来模拟雷诺应力，$R_{ij}^{\\text{model}} \\approx -2 \\nu_t S_{ij}$，其中 $S_{ij} = \\tfrac{1}{2}(G_{ij}+G_{ji})$ 且 $\\nu_t \\ge 0$。对于给定的 $(R,G)$，最小化 $\\|R + 2 \\nu_t S\\|_F^2$ 的标量 $\\nu_t^\\star$ 的最小二乘拟合得出\n$$\n\\nu_t^\\star = -\\frac{\\sum_{i,j} R_{ij} S_{ij}}{2 \\sum_{i,j} S_{ij} S_{ij}},\n$$\n并且约束模型 $\\nu_t = \\max(0,\\nu_t^\\star)$ 确保了非负的模型化产生项。模型化的转移率为\n$$\nP_{\\text{model}} = 2 \\nu_t \\sum_{i,j} S_{ij} S_{ij}.\n$$\n\n五个测试用例已如前述指定，均以国际单位制表示。每个用例的计算算法如下：\n\n- 计算 $P = -\\sum_{i,j} R_{ij} G_{ij}$。\n- 计算 $S = \\tfrac{1}{2}(G + G^\\top)$，弗罗贝尼乌斯范数的平方 $||S||_F^2 = \\sum_{i,j} S_{ij} S_{ij}$，以及内积 $\\langle R,S \\rangle = \\sum_{i,j} R_{ij} S_{ij}$。\n- 如果 $||S||_F^2 = 0$，则设置 $P_{\\text{model}} = 0$。否则，计算 $\\nu_t^\\star = -\\langle R,S\\rangle / (2 ||S||_F^2)$ 和 $\\nu_t = \\max(0,\\nu_t^\\star)$，然后 $P_{\\text{model}} = 2 \\nu_t ||S||_F^2$。\n- 如果 $P  0$，布尔标志 $\\text{is\\_negative}$ 为真。\n\n解释和物理合理性：在典型的剪切驱动湍流中，互相关 $R_{12} = \\overline{u' v'}$ 的符号通常与平均剪切 $G_{12} = \\partial_y \\bar{u}$ 的符号相反，因此 $P$ 为正，表示能量从平均流向湍流转移。逆梯度动量输运可能发生在强旋转剪切流中（例如，低绝对涡度）或具有强曲率或非局部历史效应的流中，导致 $R_{12}$ 与 $G_{12}$ 符号相同，使得 $P$ 为负。标量涡粘性 Boussinesq 封闭强制 $\\nu_t \\ge 0$，意味着 $P_{\\text{model}} \\ge 0$，因此无法表示负的 $P$；在最小二乘拟合中，这表现为 $\\nu_t^\\star  0$ 被截断为 $0$，导致在真实转移 $P$ 为负的情况下，$P_{\\text{model}} = 0$。零剪切的边界情况具有 $S_{ij} = 0$，且 $P$ 和 $P_{\\text{model}}$ 均为 $0$，这与没有平均动能向湍流动能的转移相一致。\n\n最后，您的程序必须为指定的测试套件实现这些计算，并打印一行包含五个结果的列表，每个结果形如 $[P, P_{\\text{model}}, \\text{is\\_negative}]$，其中 $P$ 和 $P_{\\text{model}}$ 四舍五入到六位小数，单位为 $\\mathrm{m}^2\\,\\mathrm{s}^{-3}$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_production(R: np.ndarray, G: np.ndarray) -> float:\n    \"\"\"\n    Compute mean-to-turbulence kinetic energy transfer rate:\n    P = - sum_{i,j} R_ij * G_ij\n    Units: m^2/s^3\n    \"\"\"\n    return float(-np.sum(R * G))\n\ndef compute_model_production(R: np.ndarray, G: np.ndarray) -> float:\n    \"\"\"\n    Compute modeled transfer rate using Boussinesq eddy viscosity closure with\n    nonnegative least-squares best-fit nu_t.\n    S = 0.5 * (G + G^T)\n    nu_t* = -sum(R_ij * S_ij) / (2 * sum(S_ij * S_ij))\n    \"\"\"\n    S = 0.5 * (G + G.T)\n    S_F_sq = np.sum(S * S)\n    \n    if S_F_sq == 0:\n        return 0.0\n    \n    R_S_inner_product = np.sum(R * S)\n    nu_t_star = -R_S_inner_product / (2 * S_F_sq)\n    nu_t = max(0, nu_t_star)\n    \n    P_model = 2 * nu_t * S_F_sq\n    return P_model\n\ndef solve_p1():\n    \"\"\"\n    Main function to run all test cases and print the results.\n    \"\"\"\n    test_cases = [\n        # Case 1\n        {\"G\": np.array([[0, 5, 0], [0, 0, 0], [0, 0, 0]], dtype=float), \"R\": np.array([[0, -0.02, 0], [-0.02, 0, 0], [0, 0, 0]], dtype=float)},\n        # Case 2\n        {\"G\": np.array([[0, 5, 0], [0, 0, 0], [0, 0, 0]], dtype=float), \"R\": np.array([[0, 0.005, 0], [0.005, 0, 0], [0, 0, 0]], dtype=float)},\n        # Case 3\n        {\"G\": np.array([[0, 0, 0], [0, 0, 0], [0, 0, 0]], dtype=float), \"R\": np.array([[0, -0.01, 0], [-0.01, 0, 0], [0, 0, 0]], dtype=float)},\n        # Case 4\n        {\"G\": np.array([[0, 4, 0], [2, 0, -3], [0, 0, 0]], dtype=float), \"R\": np.array([[0.10, -0.03, 0.00], [-0.03, 0.08, 0.01], [0.00, 0.01, 0.05]], dtype=float)},\n        # Case 5\n        {\"G\": np.array([[0, 10, 0], [0, 0, 0], [0, 0, 0]], dtype=float), \"R\": np.array([[0, -0.10, 0], [-0.10, 0, 0], [0, 0, 0]], dtype=float)}\n    ]\n    \n    final_results = []\n    for case in test_cases:\n        G, R = case[\"G\"], case[\"R\"]\n        P = compute_production(R, G)\n        P_model = compute_model_production(R, G)\n        is_negative = P  0\n        final_results.append([round(P, 6), round(P_model, 6), is_negative])\n    \n    # Format output as a single line string `[[...],[...],...]`\n    inner_strs = [f\"[{p},{pm},{str(neg)}]\" for p, pm, neg in final_results]\n    print(f\"[{','.join(inner_strs)}]\")\n\n# Execute the solution\nsolve_p1()\n```"
        },
        {
            "introduction": "在识别并量化了线性模型的误差之后，我们自然会寻求更先进的湍流封闭方案。这项最终的综合练习将带你进入非线性涡粘模型的世界，在一个对工程应用至关重要的场景——分离流再附点的预测中，对比线性和非线性模型的表现。通过实现和评估这些包含应变率和涡量率张量二次项的模型，你将直观地看到更复杂的物理假设如何能显著提升对复杂流动现象的预测精度。",
            "id": "3357832",
            "problem": "您的任务是构建并分析两种用于三维、定常、不可压缩、壁面有界分离流中湍流剪切应力的Reynolds平均Navier-Stokes (RANS) 闭合模型的纯代数、先验比较，该比较沿着近壁面的一条流向线进行评估。从第一性原理出发，使用Reynolds分解和Reynolds平均动量方程作为理论基础。然后，构建湍流剪切应力的模型预测，并评估添加依赖于平均应变率和平均旋转率张量的二次不变量的非线性张量项是否能改进对流向再附着点位置的预测。\n\n基本原理和设置：\n- 设瞬时速度分解为 $u_i = U_i + u_i'$，其中 $U_i$ 是Reynolds平均速度，$u_i'$ 是脉动。对于密度为 $\\rho$ 的定常、不可压缩流体，其Reynolds平均动量方程为\n$$\nU_j \\frac{\\partial U_i}{\\partial x_j} \\;=\\; -\\frac{1}{\\rho} \\frac{\\partial \\overline{P}}{\\partial x_i} \\;+\\; \\nu \\frac{\\partial^2 U_i}{\\partial x_j \\partial x_j} \\;-\\; \\frac{\\partial}{\\partial x_j}\\left( -\\,\\overline{u_i' u_j'}\\right),\n$$\n其中 $\\nu$ 是运动粘度。定义平均应变率张量 $S_{ij} = \\tfrac{1}{2}\\left(\\partial U_i/\\partial x_j + \\partial U_j/\\partial x_i\\right)$ 和平均旋转率张量 $W_{ij} = \\tfrac{1}{2}\\left(\\partial U_i/\\partial x_j - \\partial U_j/\\partial x_i\\right)$。湍流应力张量为 $T_{ij} = -\\,\\overline{u_i' u_j'}$。\n\n用于比较的闭合模型：\n- 线性涡粘性闭合模型使用一个标量涡粘性系数 $\\nu_t$，并将 $T_{ij}$ 与 $S_{ij}$ 成比例关联。\n- 非线性涡粘性闭合模型在线性项的基础上，增加了由 $S_{ij}$ 和 $W_{ij}$ 构造的二次张量项，特别是通过乘积 $S_{ik} W_{kj}$、$S_{ik} S_{kj}$ 和 $W_{ik} W_{kj}$ 形成的对称张量组合。\n\n任务：\n- 对于每个提供的测试用例，您必须：\n  1. 根据沿流向坐标 $x$ 给定的场，在每个 $x$ 处构建完整的三维张量 $S_{ij}(x)$ 和 $W_{ij}(x)$、标量涡粘性系数 $\\nu_t(x)$ 以及合成的“真值”壁面剪切应力 $\\tau_w^{\\mathrm{true}}(x)$。\n  2. 使用线性涡粘性模型的定义以及 $T_{ij}$ 和 $S_{ij}$ 之间的关系，推导并实现线性闭合模型对壁面剪切应力分量 $T_{12}^{\\mathrm{L}}(x)$ 的预测。\n  3. 使用由 $S_{ij}$ 和 $W_{ij}$ 构建的、直到二阶的二次张量基展开，结合给定的常数系数，并使用 $\\nu_t(x)$ 作为湍流尺度以保证量纲一致性，推导并实现非线性闭合模型对壁面剪切应力分量 $T_{12}^{\\mathrm{NL}}(x)$ 的预测。\n  4. 将流向再附着点位置 $x_r$ 定义为剪切应力从负值穿过零点变为正值的最小 $x$ 值。对于 $T_{12}^{\\mathrm{L}}(x)$、$T_{12}^{\\mathrm{NL}}(x)$ 和合成真值 $\\tau_w^{\\mathrm{true}}(x)$ 中的每一个，检测第一个从负到正的过零点，并通过在相邻采样点之间进行线性插值来估计其位置。如果采样域中不存在这样的过零点，则将预测的再附着点位置视为“非数值”(not-a-number)。\n  5. 对于每个测试用例，计算绝对误差 $|x_r^{\\mathrm{L}} - x_r^{\\mathrm{true}}|$ 和 $|x_r^{\\mathrm{NL}} - x_r^{\\mathrm{true}}|$。报告非线性模型是否严格减小了绝对误差，即 $|x_r^{\\mathrm{NL}} - x_r^{\\mathrm{true}}|  |x_r^{\\mathrm{L}} - x_r^{\\mathrm{true}}|$ 是否成立。\n\n需实现的模型规格：\n- 线性涡粘性模型：假设 $T_{ij}^{\\mathrm{L}}(x)$ 与 $S_{ij}(x)$ 成正比，比例由 $\\nu_t(x)$ 控制，并提取壁面应力所需的剪切分量。\n- 非线性涡粘性模型：构造\n$$\nT_{ij}^{\\mathrm{NL}}(x) \\;=\\; 2\\,\\nu_t(x)\\,S_{ij}(x) \\;+\\; a_1\\,\\nu_t^2(x)\\,\\left[S(x)W(x) + W(x)S(x)\\right]_{ij} \\;+\\; a_2\\,\\nu_t^2(x)\\,\\left[S(x)S(x)\\right]_{ij} \\;+\\; a_3\\,\\nu_t^2(x)\\,\\left[W(x)W(x)\\right]_{ij},\n$$\n并使用其 $i{=}1,j{=}2$ 分量作为壁面剪切应力。常数为 $a_1 = 0.3$，$a_2 = -0.2$，$a_3 = 0.1$ (均为无量纲)。注意，在这些表达式中，矩阵乘积是普通的张量缩并，例如 $\\left[S(x)W(x)\\right]_{ij} = S_{ik}(x)\\,W_{kj}(x)$，其他乘积类似；和 $S(x)W(x) + W(x)S(x)$ 通过构造是对称的。密度取为单位1，因此在一致的单位下，壁面剪切应力大小等于湍流剪切分量 $T_{12}$。\n- 用于评估的合成“真值”壁面剪切应力定义为\n$$\n\\tau_w^{\\mathrm{true}}(x) \\;=\\; 2\\,\\nu_t(x)\\,S_{12}(x) \\;+\\; a_1^{\\mathrm{true}}\\,\\nu_t^2(x)\\,\\left[S(x)W(x) + W(x)S(x)\\right]_{12} \\;+\\; a_2^{\\mathrm{true}}\\,\\nu_t^2(x)\\,\\left[S(x)S(x)\\right]_{12} \\;+\\; a_3^{\\mathrm{true}}\\,\\nu_t^2(x)\\,\\left[W(x)W(x)\\right]_{12} \\;+\\; c_3\\,\\nu_t^3(x)\\,\\left[S(x)W(x)S(x)\\right]_{12},\n$$\n其中 $(a_1^{\\mathrm{true}},a_2^{\\mathrm{true}},a_3^{\\mathrm{true}},c_3)$ 将在下面针对每个测试用例提供。最后的三次项代表了未建模的物理过程。\n\n测试套件：\n- 使用均匀流向网格 $x_k = k\\,\\Delta x$，其中 $\\Delta x = 0.5$，$k = 0,1,\\dots,20$，因此域为 $x \\in [0,10]$。\n- 对于每个测试用例，将给出 $S_{ij}(x)$ 和 $W_{ij}(x)$ 的非零分量作为 $x$ 的标量函数。使用对称性组装完整的 $3 \\times 3$ 张量：$S_{ij}(x) = S_{ji}(x)$ 和 $W_{ij}(x) = -W_{ji}(x)$，未指定的分量等于零。通过设置 $S_{33}(x) = -\\left(S_{11}(x) + S_{22}(x)\\right)$ 来强制不可压缩性。\n\n测试用例1 (具有中等三维性的一般分离流):\n- $S_{12}(x) = s(x) = s_0 \\tanh\\!\\left(\\dfrac{x - x_0}{L_s}\\right)$，其中 $s_0 = 0.5$, $x_0 = 5.0$, $L_s = 1.2$。\n- $S_{11}(x) = a(x) = 0.06 \\exp\\!\\left(-\\dfrac{(x - 5.0)^2}{4.0}\\right) - 0.03$。\n- $S_{22}(x) = d(x) = -0.5\\,a(x) + 0.01 \\sin\\!\\left(0.5\\,x\\right)$。\n- $S_{13}(x) = t(x) = 0.05 \\cos\\!\\left(0.7\\,x\\right)\\exp\\!\\left(-\\dfrac{(x - 5.0)^2}{12.0}\\right)$ 且 $S_{23}(x) = q(x) = -0.04 \\sin\\!\\left(0.5\\,x\\right)\\exp\\!\\left(-\\dfrac{(x - 6.0)^2}{10.0}\\right)$。\n- $W_{12}(x) = w(x) = 0.7\\,s(x) + 0.05 \\sin(x)$，$W_{13}(x) = z(x) = 0.03 \\cos\\!\\left(0.3\\,x\\right)$，$W_{23}(x) = y(x) = -0.025 \\sin\\!\\left(0.4\\,x\\right)$。\n- $\\nu_t(x) = 0.02 + 0.06 \\exp\\!\\left(-\\dfrac{(x - 5.5)^2}{2.0}\\right)$。\n- 真值系数：$a_1^{\\mathrm{true}} = 0.35$，$a_2^{\\mathrm{true}} = -0.25$，$a_3^{\\mathrm{true}} = 0.10$，$c_3 = 0.08$。\n\n测试用例2 (弱非线性，准二维行为):\n- $S_{12}(x) = s(x) = s_0 \\tanh\\!\\left(\\dfrac{x - x_0}{L_s}\\right)$，其中 $s_0 = 0.35$, $x_0 = 4.0$, $L_s = 1.0$。\n- $S_{11}(x) = a(x) = 0.03 \\exp\\!\\left(-\\dfrac{(x - 4.0)^2}{3.0}\\right) - 0.015$。\n- $S_{22}(x) = d(x) = -0.6\\,a(x) + 0.005 \\cos\\!\\left(0.4\\,x\\right)$。\n- $S_{13}(x) = t(x) = 0.02 \\cos\\!\\left(0.5\\,x\\right)\\exp\\!\\left(-\\dfrac{(x - 5.0)^2}{10.0}\\right)$ 且 $S_{23}(x) = q(x) = 0.02 \\sin\\!\\left(0.3\\,x\\right)\\exp\\!\\left(-\\dfrac{(x - 5.0)^2}{10.0}\\right)$。\n- $W_{12}(x) = w(x) = 0.9\\,s(x) + 0.02 \\sin\\!\\left(0.8\\,x\\right)$，$W_{13}(x) = z(x) = 0.015 \\cos\\!\\left(0.35\\,x\\right)$，$W_{23}(x) = y(x) = 0.015 \\sin\\!\\left(0.25\\,x\\right)$。\n- $\\nu_t(x) = 0.015 + 0.04 \\exp\\!\\left(-\\dfrac{(x - 4.5)^2}{1.5}\\right)$。\n- 真值系数：$a_1^{\\mathrm{true}} = 0.32$，$a_2^{\\mathrm{true}} = -0.18$，$a_3^{\\mathrm{true}} = 0.08$，$c_3 = 0.02$。\n\n测试用例3 (线性模型可能无法预测再附着的挑战性情况):\n- $S_{12}(x) = s(x) = -0.25 + 0.03 \\tanh\\!\\left(\\dfrac{x - 6.0}{1.0}\\right)$。\n- $S_{11}(x) = a(x) = 0.05 \\exp\\!\\left(-\\dfrac{(x - 7.0)^2}{2.0}\\right) - 0.02$。\n- $S_{22}(x) = d(x) = -0.7\\,a(x) + 0.01 \\cos\\!\\left(0.6\\,x\\right)$。\n- $S_{13}(x) = t(x) = 0.06 \\exp\\!\\left(-\\dfrac{(x - 8.0)^2}{3.0}\\right)\\cos\\!\\left(0.5\\,x\\right)$ 且 $S_{23}(x) = q(x) = -0.05 \\exp\\!\\left(-\\dfrac{(x - 7.5)^2}{2.5}\\right)\\sin\\!\\left(0.4\\,x\\right)$。\n- $W_{12}(x) = w(x) = 0.40 + 0.05 \\sin\\!\\left(0.7\\,x\\right)$，$W_{13}(x) = z(x) = 0.05 \\cos\\!\\left(0.4\\,x\\right)$，$W_{23}(x) = y(x) = -0.05 \\sin\\!\\left(0.3\\,x\\right)$。\n- $\\nu_t(x) = 0.02 + 0.05 \\exp\\!\\left(-\\dfrac{(x - 7.0)^2}{1.2}\\right)$。\n- 真值系数：$a_1^{\\mathrm{true}} = 0.40$，$a_2^{\\mathrm{true}} = -0.30$，$a_3^{\\mathrm{true}} = 0.12$，$c_3 = 0.12$。\n\n重要实现说明：\n- 对于每个 $x$，使用上述分量组装 $S(x)$ 和 $W(x)$，所有其他元素为零，同时遵守对称性/反对称性以及 $S_{33}(x) = -\\left(S_{11}(x) + S_{22}(x)\\right)$。\n- 使用标准张量缩并规则计算矩阵乘积，如 $S(x)W(x)$、$W(x)S(x)$、$S(x)S(x)$、$W(x)W(x)$ 和 $S(x)W(x)S(x)$。\n- 通过扫描查找第一个满足 $\\tau(x_k) \\le 0$ 和 $\\tau(x_{k+1})  0$ 的索引 $k$ 来检测再附着点位置，并在 $x_k$ 和 $x_{k+1}$ 之间对过零点进行线性插值。如果不存在这样的索引，则再附着点位置为非数值 (not-a-number)。\n\n最终输出规格：\n- 对于三个测试用例中的每一个，计算一个布尔值，以指示与线性模型相比，非线性模型是否严格减小了再附着点预测的绝对误差。您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表，例如 $\\left[\\mathrm{True},\\mathrm{False},\\mathrm{True}\\right]$。由于输出是布尔值，最终输出中不需要物理单位。",
            "solution": "用户想要解决一个计算流体动力学问题。\n\n### 步骤1：提取已知条件\n- **Reynolds分解**：$u_i = U_i + u_i'$，其中 $U_i$ 是平均速度，$u_i'$ 是脉动。\n- **RANS方程**：定常、不可压缩的Reynolds平均动量方程为 $U_j \\frac{\\partial U_i}{\\partial x_j} = -\\frac{1}{\\rho} \\frac{\\partial \\overline{P}}{\\partial x_i} + \\nu \\frac{\\partial^2 U_i}{\\partial x_j \\partial x_j} - \\frac{\\partial}{\\partial x_j}\\left( -\\,\\overline{u_i' u_j'}\\right)$。\n- **定义**：\n  - 平均应变率张量：$S_{ij} = \\tfrac{1}{2}\\left(\\partial U_i/\\partial x_j + \\partial U_j/\\partial x_i\\right)$。\n  - 平均旋转率张量：$W_{ij} = \\tfrac{1}{2}\\left(\\partial U_i/\\partial x_j - \\partial U_j/\\partial x_i\\right)$。\n  - 湍流应力张量：$T_{ij} = -\\,\\overline{u_i' u_j'}$。\n- **线性模型**：$T_{ij}^{\\mathrm{L}}(x)$ 与 $S_{ij}(x)$ 成比例，比例由 $\\nu_t(x)$ 控制。根据非线性模型的形式，这意味着 $T_{ij}^{\\mathrm{L}}(x) = 2 \\nu_t(x) S_{ij}(x)$。\n- **非线性模型**：$T_{ij}^{\\mathrm{NL}}(x) = 2\\,\\nu_t(x)\\,S_{ij}(x) + a_1\\,\\nu_t^2(x)\\,\\left[S(x)W(x) + W(x)S(x)\\right]_{ij} + a_2\\,\\nu_t^2(x)\\,\\left[S(x)S(x)\\right]_{ij} + a_3\\,\\nu_t^2(x)\\,\\left[W(x)W(x)\\right]_{ij}$。\n- **非线性模型常数**：$a_1 = 0.3$，$a_2 = -0.2$，$a_3 = 0.1$。\n- **合成真值模型**：$\\tau_w^{\\mathrm{true}}(x) = 2\\,\\nu_t(x)\\,S_{12}(x) + a_1^{\\mathrm{true}}\\,\\nu_t^2(x)\\,\\left[S(x)W(x) + W(x)S(x)\\right]_{12} + a_2^{\\mathrm{true}}\\,\\nu_t^2(x)\\,\\left[S(x)S(x)\\right]_{12} + a_3^{\\mathrm{true}}\\,\\nu_t^2(x)\\,\\left[W(x)W(x)\\right]_{12} + c_3\\,\\nu_t^3(x)\\,\\left[S(x)W(x)S(x)\\right]_{12}$。\n- **物理常数**：密度 $\\rho=1$。\n- **再附着点定义**：$x_r$ 是剪切应力从负值穿过零点变为正值的最小 $x$ 值。通过线性插值进行估计。如果没有过零点，$x_r$ 为“非数值”(`NaN`)。\n- **评估指标**：对于每个用例，确定 $|x_r^{\\mathrm{NL}} - x_r^{\\mathrm{true}}|  |x_r^{\\mathrm{L}} - x_r^{\\mathrm{true}}|$ 是否成立。\n- **网格**：均匀网格 $x_k = k\\,\\Delta x$，其中 $\\Delta x = 0.5$，$k = 0,1,\\dots,20$ (域 $x \\in [0,10]$)。\n- **张量组装规则**：\n  - $S_{ij}(x) = S_{ji}(x)$。\n  - $W_{ij}(x) = -W_{ji}(x)$。\n  - 未指定的张量分量为零。\n  - 不可压缩性：$S_{33}(x) = -\\left(S_{11}(x) + S_{22}(x)\\right)$。\n- **测试用例1**：\n  - 分量：$S_{12}(x) = 0.5 \\tanh((x - 5.0)/1.2)$，$S_{11}(x) = 0.06 \\exp(-(x - 5.0)^2/4.0) - 0.03$，$S_{22}(x) = -0.5 S_{11}(x) + 0.01 \\sin(0.5x)$，$S_{13}(x) = 0.05 \\cos(0.7x)\\exp(-(x - 5.0)^2/12.0)$，$S_{23}(x) = -0.04 \\sin(0.5x)\\exp(-(x - 6.0)^2/10.0)$，$W_{12}(x) = 0.7 S_{12}(x) + 0.05 \\sin(x)$，$W_{13}(x) = 0.03 \\cos(0.3x)$，$W_{23}(x) = -0.025 \\sin(0.4x)$。\n  - 涡粘性系数：$\\nu_t(x) = 0.02 + 0.06 \\exp(-(x - 5.5)^2/2.0)$。\n  - 真值系数：$a_1^{\\mathrm{true}} = 0.35$，$a_2^{\\mathrm{true}} = -0.25$，$a_3^{\\mathrm{true}} = 0.10$，$c_3 = 0.08$。\n- **测试用例2**：\n  - 分量：$S_{12}(x) = 0.35 \\tanh((x - 4.0)/1.0)$，$S_{11}(x) = 0.03 \\exp(-(x - 4.0)^2/3.0) - 0.015$，$S_{22}(x) = -0.6 S_{11}(x) + 0.005 \\cos(0.4x)$，$S_{13}(x) = 0.02 \\cos(0.5x)\\exp(-(x - 5.0)^2/10.0)$，$S_{23}(x) = 0.02 \\sin(0.3x)\\exp(-(x - 5.0)^2/10.0)$，$W_{12}(x) = 0.9 S_{12}(x) + 0.02 \\sin(0.8x)$，$W_{13}(x) = 0.015 \\cos(0.35x)$，$W_{23}(x) = 0.015 \\sin(0.25x)$。\n  - 涡粘性系数：$\\nu_t(x) = 0.015 + 0.04 \\exp(-(x - 4.5)^2/1.5)$。\n  - 真值系数：$a_1^{\\mathrm{true}} = 0.32$，$a_2^{\\mathrm{true}} = -0.18$，$a_3^{\\mathrm{true}} = 0.08$，$c_3 = 0.02$。\n- **测试用例3**：\n  - 分量：$S_{12}(x) = -0.25 + 0.03 \\tanh((x - 6.0)/1.0)$，$S_{11}(x) = 0.05 \\exp(-(x - 7.0)^2/2.0) - 0.02$，$S_{22}(x) = -0.7 S_{11}(x) + 0.01 \\cos(0.6x)$，$S_{13}(x) = 0.06 \\exp(-(x - 8.0)^2/3.0)\\cos(0.5x)$，$S_{23}(x) = -0.05 \\exp(-(x - 7.5)^2/2.5)\\sin(0.4x)$，$W_{12}(x) = 0.40 + 0.05 \\sin(0.7x)$，$W_{13}(x) = 0.05 \\cos(0.4x)$，$W_{23}(x) = -0.05 \\sin(0.3x)$。\n  - 涡粘性系数：$\\nu_t(x) = 0.02 + 0.05 \\exp(-(x - 7.0)^2/1.2)$。\n  - 真值系数：$a_1^{\\mathrm{true}} = 0.40$，$a_2^{\\mathrm{true}} = -0.30$，$a_3^{\\mathrm{true}} = 0.12$，$c_3 = 0.12$。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学依据**：该问题牢固地植根于针对Reynolds平均Navier-Stokes (RANS) 方程的湍流建模理论。使用基于雷诺应力各向异性张量基展开的线性和非线性涡粘性模型是计算流体动力学中的一种标准且有据可查的方法。尽管函数形式是合成的，但它们的选择旨在模仿真实的流动特征。\n- **良态的**：该问题是一个直接的计算任务。所有必要的函数、常数和算法都已明确定义，确保可以计算出唯一的解。\n- **客观的**：问题以精确的数学语言陈述，没有主观性或歧义。\n- **不完整或矛盾的设置**：问题是自洽的。提供了所有必要的模型形式、系数和输入数据。张量组装规则是完整的，并与标准的流体动力学惯例（例如，$S_{ij}$ 的对称性，$W_{ij}$ 的反对称性，以及不可压缩流的 $S_{ij}$ 的无迹性）一致。\n- **不切实际或不可行**：该设置是一个合成的代数测试用例，而不是对完整流场的模拟。在此背景下，条件和数据对于湍流模型的先验分析是合理的。没有违反物理或量纲一致性的地方。\n- **病态或结构不良**：结构是合乎逻辑的，从基本定义到模型构建，最终到定量比较。再附着准则定义明确。\n- **伪深刻、琐碎或同义反复**：该问题并非微不足道。它需要在一个离散域上仔细实现张量代数，一个数值搜索与插值算法，以及对特殊情况（例如，未能预测再附着）的逻辑处理。这是理解和实现代数应力模型的一个有效练习。\n\n### 步骤3：结论与行动\n该问题是有效的。这是一个在湍流建模领域中定义明确、具有科学依据的计算练习。将提供完整的解决方案。\n\n---\n\n### 解题策略\n\n该问题要求对一个线性和一个非线性涡粘性模型进行比较分析，以预测分离流中的流向再附着点，并与一个合成的“真值”进行对比。该分析纯粹是代数的，并且沿着单一空间坐标 $x$ 执行。密度 $\\rho$ 取为1，因此湍流应力 $T_{ij}$ 在数值上等于剪切应力。壁面剪切应力所关注的分量是 $T_{12}$。\n\n**1. 剪切应力 $T_{12}$ 的模型公式**\n\n首先，我们为三个模型中的每一个定义特定的分量 $T_{12}$。\n\n*   **线性涡粘性模型 (LEVM)**：该模型基于Boussinesq假设，该假设假定雷诺应力张量和平均应变率张量之间存在线性关系。对于剪切分量 $T_{12}$，模型为：\n    $$\n    T_{12}^{\\mathrm{L}}(x) = 2 \\nu_t(x) S_{12}(x)\n    $$\n    这里，$\\nu_t(x)$ 是标量涡粘性系数。\n\n*   **非线性涡粘性模型 (NLEVM)**：该模型通过包含由平均应变率张量 $S(x)$ 和平均旋转率张量 $W(x)$ 构成的非线性二次项来扩展LEVM。其 $ij$ 分量由下式给出：\n    $$\n    T_{ij}^{\\mathrm{NL}}(x) = 2\\,\\nu_t(x)\\,S_{ij}(x) + a_1\\,\\nu_t^2(x)\\,\\left[S(x)W(x) + W(x)S(x)\\right]_{ij} + a_2\\,\\nu_t^2(x)\\,\\left[S(x)^2\\right]_{ij} + a_3\\,\\nu_t^2(x)\\,\\left[W(x)^2\\right]_{ij}\n    $$\n    其中 $[S(x)W(x)]_{ij} = S_{ik}(x)W_{kj}(x)$ 表示张量缩并（矩阵乘法）。为求得 $T_{12}^{\\mathrm{NL}}(x)$，我们计算和中每一项的 $(i,j)=(1,2)$ 分量。最可靠的计算方法是首先构造完整的 $3 \\times 3$ 矩阵 $S(x)$ 和 $W(x)$，然后执行指定的矩阵乘法。\n\n*   **合成真值模型**：这是NLEVM的扩展，具有不同的系数和一个额外的三次项，旨在代表一个更复杂的“基准真值”，以便与其他模型进行比较。\n    $$\n    \\tau_w^{\\mathrm{true}}(x) = T_{12}^{\\mathrm{true}}(x) = T_{12}^{\\mathrm{NL}}(x)\\Big|_{a_i \\to a_i^{\\mathrm{true}}} + c_3\\,\\nu_t^3(x)\\,\\left[S(x)W(x)S(x)\\right]_{12}\n    $$\n    同样，三次项 $[S(x)W(x)S(x)]_{12}$ 的 $(1,2)$ 分量是通过矩阵乘法计算的。\n\n**2. 计算流程**\n\n对于每个测试用例，执行以下步骤：\n\n1.  **离散化域**：定义一个均匀网格 $x_k = k \\cdot (0.5)$，$k = 0, 1, \\ldots, 20$。\n2.  **组装张量**：在每个网格点 $x_k$ 处，填充 $3 \\times 3$ 张量 $S(x_k)$ 和 $W(x_k)$。给定的函数定义了非零分量。利用对称性 ($S_{ij}=S_{ji}$) 和反对称性 ($W_{ij}=-W_{ji}$) 来填充其余指定分量。通过设置 $S_{33}(x_k) = -(S_{11}(x_k) + S_{22}(x_k))$ 来强制执行不可压缩性约束。任何未明确定义或无法通过对称性推导的分量都设置为零。例如，由于反对称性，$W_{11}, W_{22}, W_{33}$ 均为零。\n3.  **计算剪切应力剖面**：对于网格上的每个点 $x_k$：\n    *   评估函数以得到 $S_{ij}(x_k)$、$W_{ij}(x_k)$ 和 $\\nu_t(x_k)$ 的值。\n    *   组装矩阵 $S(x_k)$ 和 $W(x_k)$。\n    *   执行所需的矩阵乘法：$S^2$、$W^2$、$SW$、$WS$ 和 $SWS$。\n    *   使用结果计算标量值 $T_{12}^{\\mathrm{L}}(x_k)$、$T_{12}^{\\mathrm{NL}}(x_k)$ 和 $T_{12}^{\\mathrm{true}}(x_k)$，并将它们存储在数组中。\n\n**3. 再附着点检测**\n\n再附着点 $x_r$ 是壁面剪切应力在经历负值后变为正值的位置，标志着流动分离泡的结束。对于计算出的三个应力剖面（$\\tau^{\\mathrm{L}}$, $\\tau^{\\mathrm{NL}}$, $\\tau^{\\mathrm{true}}$）中的每一个：\n\n1.  **扫描过零点**：从 $k=0$ 到 $k=19$ 遍历网格。找到第一个索引 $k$ 使得 $\\tau(x_k) \\le 0$ 且 $\\tau(x_{k+1})  0$。\n2.  **线性插值**：如果找到这样一个区间 $[x_k, x_{k+1}]$，则使用线性插值估计过零点：\n    $$\n    x_r = x_k - \\tau(x_k) \\frac{x_{k+1} - x_k}{\\tau(x_{k+1}) - \\tau(x_k)}\n    $$\n3.  **无再附着**：如果循环完成而没有找到这样的过零点，则意味着在域 $[0, 10]$ 内没有发生再附着。在这种情况下，再附着位置 $x_r$ 被赋予“非数值”(`NaN`)。\n\n**4. 误差分析与比较**\n\n最后一步是确定NLEVM是否比LEVM更准确地预测再附着位置。\n\n1.  **计算绝对误差**：计算线性和非线性模型相对于合成真值的绝对误差：\n    $$\n    E_{\\mathrm{L}} = |x_r^{\\mathrm{L}} - x_r^{\\mathrm{true}}|\n    $$\n    $$\n    E_{\\mathrm{NL}} = |x_r^{\\mathrm{NL}} - x_r^{\\mathrm{true}}|\n    $$\n2.  **评估改进情况**：确定严格不等式 $E_{\\mathrm{NL}}  E_{\\mathrm{L}}$ 的布尔值。`NaN` 值的处理至关重要：\n    *   如果一个模型未能预测再附着（$x_r$ 为 `NaN`），而真值模型预测了再附着，则其误差被认为是无限大。\n    *   如果LEVM失败（误差无限大）而NLEVM成功（误差有限），则NLEVM严格更优。条件为 `True`。\n    *   如果NLEVM失败，则无论LEVM的表现如何，它都不能严格更优。条件为 `False`。\n    *   如果两个模型都预测了有限的再附着位置，则直接比较它们的有限误差。\n\n此过程应用于三个测试用例中的每一个，为每个用例产生一个布尔结果。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the RANS model comparison problem for all test cases.\n    \"\"\"\n\n    test_cases = [\n        {\n            \"name\": \"Test case 1 (general separated flow with moderate three-dimensionality)\",\n            \"params\": {\"s0\": 0.5, \"x0\": 5.0, \"Ls\": 1.2},\n            \"S12_f\": lambda x, p: p[\"s0\"] * np.tanh((x - p[\"x0\"]) / p[\"Ls\"]),\n            \"S11_f\": lambda x, p: 0.06 * np.exp(-(x - 5.0)**2 / 4.0) - 0.03,\n            \"S22_f\": lambda x, p: -0.5 * (0.06 * np.exp(-(x - 5.0)**2 / 4.0) - 0.03) + 0.01 * np.sin(0.5 * x),\n            \"S13_f\": lambda x, p: 0.05 * np.cos(0.7 * x) * np.exp(-(x - 5.0)**2 / 12.0),\n            \"S23_f\": lambda x, p: -0.04 * np.sin(0.5 * x) * np.exp(-(x - 6.0)**2 / 10.0),\n            \"W12_f\": lambda x, p: 0.7 * (p[\"s0\"] * np.tanh((x - p[\"x0\"]) / p[\"Ls\"])) + 0.05 * np.sin(x),\n            \"W13_f\": lambda x, p: 0.03 * np.cos(0.3 * x),\n            \"W23_f\": lambda x, p: -0.025 * np.sin(0.4 * x),\n            \"nut_f\": lambda x, p: 0.02 + 0.06 * np.exp(-(x - 5.5)**2 / 2.0),\n            \"truth_coeffs\": {\"a1\": 0.35, \"a2\": -0.25, \"a3\": 0.10, \"c3\": 0.08},\n        },\n        {\n            \"name\": \"Test case 2 (weak nonlinearity, quasi-two-dimensional behavior)\",\n            \"params\": {\"s0\": 0.35, \"x0\": 4.0, \"Ls\": 1.0},\n            \"S12_f\": lambda x, p: p[\"s0\"] * np.tanh((x - p[\"x0\"]) / p[\"Ls\"]),\n            \"S11_f\": lambda x, p: 0.03 * np.exp(-(x - 4.0)**2 / 3.0) - 0.015,\n            \"S22_f\": lambda x, p: -0.6 * (0.03 * np.exp(-(x - 4.0)**2 / 3.0) - 0.015) + 0.005 * np.cos(0.4 * x),\n            \"S13_f\": lambda x, p: 0.02 * np.cos(0.5 * x) * np.exp(-(x - 5.0)**2 / 10.0),\n            \"S23_f\": lambda x, p: 0.02 * np.sin(0.3 * x) * np.exp(-(x - 5.0)**2 / 10.0),\n            \"W12_f\": lambda x, p: 0.9 * (p[\"s0\"] * np.tanh((x - p[\"x0\"]) / p[\"Ls\"])) + 0.02 * np.sin(0.8 * x),\n            \"W13_f\": lambda x, p: 0.015 * np.cos(0.35 * x),\n            \"W23_f\": lambda x, p: 0.015 * np.sin(0.25 * x),\n            \"nut_f\": lambda x, p: 0.015 + 0.04 * np.exp(-(x - 4.5)**2 / 1.5),\n            \"truth_coeffs\": {\"a1\": 0.32, \"a2\": -0.18, \"a3\": 0.08, \"c3\": 0.02},\n        },\n        {\n            \"name\": \"Test case 3 (challenging case where linear model may miss reattachment)\",\n            \"params\": {},\n            \"S12_f\": lambda x, p: -0.25 + 0.03 * np.tanh((x - 6.0) / 1.0),\n            \"S11_f\": lambda x, p: 0.05 * np.exp(-(x - 7.0)**2 / 2.0) - 0.02,\n            \"S22_f\": lambda x, p: -0.7 * (0.05 * np.exp(-(x - 7.0)**2 / 2.0) - 0.02) + 0.01 * np.cos(0.6 * x),\n            \"S13_f\": lambda x, p: 0.06 * np.exp(-(x - 8.0)**2 / 3.0) * np.cos(0.5 * x),\n            \"S23_f\": lambda x, p: -0.05 * np.exp(-(x - 7.5)**2 / 2.5) * np.sin(0.4 * x),\n            \"W12_f\": lambda x, p: 0.40 + 0.05 * np.sin(0.7 * x),\n            \"W13_f\": lambda x, p: 0.05 * np.cos(0.4 * x),\n            \"W23_f\": lambda x, p: -0.05 * np.sin(0.3 * x),\n            \"nut_f\": lambda x, p: 0.02 + 0.05 * np.exp(-(x - 7.0)**2 / 1.2),\n            \"truth_coeffs\": {\"a1\": 0.40, \"a2\": -0.30, \"a3\": 0.12, \"c3\": 0.12},\n        }\n    ]\n\n    nl_model_coeffs = {\"a1\": 0.3, \"a2\": -0.2, \"a3\": 0.1}\n\n    results = []\n    for case in test_cases:\n        result = run_case(case, nl_model_coeffs)\n        results.append(result)\n\n    # Format the output as specified: [True,False,True]\n    # The str() of a list of booleans is already in the correct format\n    print(str(results).replace(\" \", \"\"))\n\ndef find_reattachment(x_grid, stress_profile):\n    \"\"\"\n    Finds the reattachment point by linear interpolation.\n    Returns NaN if no reattachment is found.\n    \"\"\"\n    for i in range(len(x_grid) - 1):\n        if stress_profile[i] = 0 and stress_profile[i+1] > 0:\n            x1, y1 = x_grid[i], stress_profile[i]\n            x2, y2 = x_grid[i+1], stress_profile[i+1]\n            return x1 - y1 * (x2 - x1) / (y2 - y1)\n    return np.nan\n\ndef run_case(case_data, nl_coeffs):\n    \"\"\"\n    Executes a single test case.\n    \"\"\"\n    # Setup grid\n    dx = 0.5\n    x = np.arange(0, 10 + dx, dx)\n    n_points = len(x)\n    params = case_data[\"params\"]\n    \n    # Evaluate tensor components and nu_t on the grid\n    nu_t = case_data[\"nut_f\"](x, params)\n    S11 = case_data[\"S11_f\"](x, params)\n    S12 = case_data[\"S12_f\"](x, params)\n    S13 = case_data[\"S13_f\"](x, params)\n    S22 = case_data[\"S22_f\"](x, params)\n    S23 = case_data[\"S23_f\"](x, params)\n    S33 = -(S11 + S22)\n    \n    W12 = case_data[\"W12_f\"](x, params)\n    W13 = case_data[\"W13_f\"](x, params)\n    W23 = case_data[\"W23_f\"](x, params)\n\n    # Initialize stress arrays\n    tau_L = np.zeros(n_points)\n    tau_NL = np.zeros(n_points)\n    tau_true = np.zeros(n_points)\n    \n    # Calculate stresses at each grid point\n    for k in range(n_points):\n        S = np.array([\n            [S11[k], S12[k], S13[k]],\n            [S12[k], S22[k], S23[k]],\n            [S13[k], S23[k], S33[k]]\n        ])\n        \n        W = np.array([\n            [0, W12[k], W13[k]],\n            [-W12[k], 0, W23[k]],\n            [-W13[k], -W23[k], 0]\n        ])\n        \n        # Linear model stress\n        T_L_12 = 2 * nu_t[k] * S12[k]\n        \n        # Nonlinear terms\n        S_sq = S @ S\n        W_sq = W @ W\n        SW = S @ W\n        WS = W @ S\n        \n        # Nonlinear model stress\n        T_NL_12 = T_L_12 + \\\n                  nl_coeffs[\"a1\"] * nu_t[k]**2 * (SW + WS)[0, 1] + \\\n                  nl_coeffs[\"a2\"] * nu_t[k]**2 * S_sq[0, 1] + \\\n                  nl_coeffs[\"a3\"] * nu_t[k]**2 * W_sq[0, 1]\n\n        # Truth model stress\n        SWS = S @ W @ S\n        truth = case_data[\"truth_coeffs\"]\n        T_true_12 = T_L_12 + \\\n                    truth[\"a1\"] * nu_t[k]**2 * (SW + WS)[0, 1] + \\\n                    truth[\"a2\"] * nu_t[k]**2 * S_sq[0, 1] + \\\n                    truth[\"a3\"] * nu_t[k]**2 * W_sq[0, 1] + \\\n                    truth[\"c3\"] * nu_t[k]**3 * SWS[0, 1]\n                    \n        tau_L[k] = T_L_12\n        tau_NL[k] = T_NL_12\n        tau_true[k] = T_true_12\n\n    # Find reattachment points\n    xr_L = find_reattachment(x, tau_L)\n    xr_NL = find_reattachment(x, tau_NL)\n    xr_true = find_reattachment(x, tau_true)\n\n    # Compare errors, handling NaN cases\n    is_L_nan = np.isnan(xr_L)\n    is_NL_nan = np.isnan(xr_NL)\n    is_true_nan = np.isnan(xr_true)\n\n    if is_true_nan:\n        # If truth has no reattachment, comparison is ambiguous. Default to False.\n        return False\n    \n    if is_NL_nan:\n        # NL model failed, so it cannot be strictly better.\n        return False\n    \n    if is_L_nan:\n        # L model failed, but NL model succeeded. NL is strictly better.\n        return True\n\n    # Both models found reattachment, compare finite errors.\n    err_L = abs(xr_L - xr_true)\n    err_NL = abs(xr_NL - xr_true)\n    \n    return err_NL  err_L\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}