{
    "hands_on_practices": [
        {
            "introduction": "The core assumption of the Boussinesq hypothesis is that the Reynolds stress anisotropy tensor, $a_{ij}$, is linearly proportional to the mean strain-rate tensor, $S_{ij}$. This exercise provides a direct and quantitative way to test this fundamental alignment. By decomposing the stress tensor and computing a \"captured fraction,\" you will assess how well this foundational assumption holds across different canonical flows, revealing the model's strengths and weaknesses .",
            "id": "3371295",
            "problem": "You are to implement a complete program that decomposes the Reynolds stress tensor into isotropic and deviatoric parts, further decomposes the deviatoric part into components aligned with the mean rate-of-strain and misaligned with it, and then quantifies the fraction of the deviatoric content captured by the Boussinesq eddy-viscosity hypothesis. This task must be posed and solved in purely mathematical terms and must be scientifically consistent with computational fluid dynamics.\n\nUse the following definitions and requirements. Let the Reynolds stress tensor be denoted by $R_{ij}$, the mean turbulent kinetic energy by $k$, the identity tensor by $\\delta_{ij}$, and the mean rate-of-strain tensor by $S_{ij}$. Assume all tensors are $3 \\times 3$, real-valued, and symmetric. Define the turbulent kinetic energy as $k = \\frac{1}{2} R_{kk}$ and the isotropic part as $R^{\\mathrm{iso}}_{ij} = \\frac{2}{3} k \\delta_{ij}$. Define the deviatoric part by $a_{ij} = R_{ij} - R^{\\mathrm{iso}}_{ij}$. Equip the space of second-order tensors with the Frobenius inner product $\\langle A, B \\rangle = A_{ij} B_{ij}$ and the Frobenius norm $\\|A\\|_F = \\sqrt{\\langle A, A \\rangle}$.\n\nDecompose $a_{ij}$ into the sum of two components $a_{ij}^{\\parallel}$ and $a_{ij}^{\\perp}$, where $a_{ij}^{\\parallel}$ is the orthogonal projection of $a_{ij}$ onto the one-dimensional subspace spanned by $S_{ij}$, and $a_{ij}^{\\perp}$ is the remainder orthogonal to $S_{ij}$ in the Frobenius inner product. Specifically, if $\\langle S, S \\rangle > 0$, define the projection coefficient $c = \\frac{\\langle a, S \\rangle}{\\langle S, S \\rangle}$ and set $a_{ij}^{\\parallel} = c S_{ij}$ and $a_{ij}^{\\perp} = a_{ij} - a_{ij}^{\\parallel}$. If $\\langle S, S \\rangle = 0$, set $a_{ij}^{\\parallel} = 0$ and $a_{ij}^{\\perp} = a_{ij}$.\n\nDefine the captured fraction $f$ as the fraction of the deviatoric magnitude that is aligned with $S_{ij}$:\n$$\nf = \n\\begin{cases}\n\\frac{\\|a^{\\parallel}\\|_F^2}{\\|a\\|_F^2}, & \\text{if } \\|a\\|_F > 0, \\\\\n1, & \\text{if } \\|a\\|_F = 0,\n\\end{cases}\n$$\nwith the convention that if $\\langle S, S \\rangle = 0$ and $\\|a\\|_F > 0$, then $f = 0$. The value $f$ is dimensionless (unitless). The scientific interpretation is that $f$ quantifies the fraction of the deviatoric Reynolds stress that can be represented by an eddy-viscosity model based on alignment with the mean rate-of-strain.\n\nImplement this decomposition and fraction computation for the following test suite, which includes distinct flow archetypes and Reynolds numbers (Reynolds number is provided as metadata and is dimensionless). Each case specifies $R_{ij}$ and $S_{ij}$ numerically:\n\n- Case $1$ (shear, moderate Reynolds number $Re = 10^4$):\n  - $R = \\begin{bmatrix} 1.0 & -0.6 & 0.0 \\\\ -0.6 & 1.0 & 0.0 \\\\ 0.0 & 0.0 & 1.0 \\end{bmatrix}$\n  - $S = \\begin{bmatrix} 0.0 & 10.0 & 0.0 \\\\ 10.0 & 0.0 & 0.0 \\\\ 0.0 & 0.0 & 0.0 \\end{bmatrix}$\n- Case $2$ (solid-body swirl, high Reynolds number $Re = 10^5$):\n  - $R = \\begin{bmatrix} 1.1333333333333333 & 0.0 & 0.0 \\\\ 0.0 & 1.1333333333333333 & 0.0 \\\\ 0.0 & 0.0 & 1.7333333333333334 \\end{bmatrix}$\n  - $S = \\begin{bmatrix} 0.0 & 0.0 & 0.0 \\\\ 0.0 & 0.0 & 0.0 \\\\ 0.0 & 0.0 & 0.0 \\end{bmatrix}$\n- Case $3$ (curved shear, very high Reynolds number $Re = 2 \\times 10^5$):\n  - $R = \\begin{bmatrix} 0.4666666666666667 & 0.3 & 0.0 \\\\ 0.3 & 1.2 & 0.0 \\\\ 0.0 & 0.0 & 0.6666666666666666 \\end{bmatrix}$\n  - $S = \\begin{bmatrix} 5.0 & 0.0 & 0.0 \\\\ 0.0 & -5.0 & 0.0 \\\\ 0.0 & 0.0 & 0.0 \\end{bmatrix}$\n- Case $4$ (misaligned anisotropy with shear, Reynolds number $Re = 3 \\times 10^4$):\n  - $R = \\begin{bmatrix} 0.5333333333333333 & 0.0 & 0.0 \\\\ 0.0 & 1.1333333333333333 & 0.0 \\\\ 0.0 & 0.0 & 0.5333333333333333 \\end{bmatrix}$\n  - $S = \\begin{bmatrix} 0.0 & 10.0 & 0.0 \\\\ 10.0 & 0.0 & 0.0 \\\\ 0.0 & 0.0 & 0.0 \\end{bmatrix}$\n- Case $5$ (isotropic turbulence with nonzero mean strain, Reynolds number $Re = 5 \\times 10^3$):\n  - $R = \\begin{bmatrix} 0.4 & 0.0 & 0.0 \\\\ 0.0 & 0.4 & 0.0 \\\\ 0.0 & 0.0 & 0.4 \\end{bmatrix}$\n  - $S = \\begin{bmatrix} 2.0 & 0.0 & 0.0 \\\\ 0.0 & -2.0 & 0.0 \\\\ 0.0 & 0.0 & 0.0 \\end{bmatrix}$\n\nYour program must:\n- For each case, compute $k$, $R^{\\mathrm{iso}}_{ij}$, $a_{ij}$, $a_{ij}^{\\parallel}$, $a_{ij}^{\\perp}$, and the captured fraction $f$ as defined above.\n- Implement the boundary conventions exactly as stated.\n- Produce a single line of output containing the captured fractions for all test cases as a comma-separated list enclosed in square brackets. Each fraction must be rounded to six decimal places. For example, the output format must be exactly of the form $[f_1,f_2,f_3,f_4,f_5]$ with each $f_i$ printed as a decimal rounded to six digits after the decimal point.\n- The fractions are unitless, so no physical units are required in the output.\n\nAngles are not involved in this task. No percentages are involved; the fractions must be printed as decimals as specified. Ensure scientific realism and internal consistency with the definitions and conventions above. The algorithm must be numerically robust for the provided inputs, including boundary cases where $S_{ij}$ is the zero tensor or $a_{ij}$ is the zero tensor.",
            "solution": "The problem requires the implementation of a procedure to quantify the alignment between the Reynolds stress anisotropy tensor and the mean rate-of-strain tensor. This quantification is a crucial step in validating the Boussinesq eddy-viscosity hypothesis, a cornerstone of many turbulence models in computational fluid dynamics (CFD). The hypothesis posits a linear relationship between the deviatoric part of the Reynolds stress tensor, $a_{ij}$, and the mean rate-of-strain tensor, $S_{ij}$, via an eddy viscosity $\\nu_t$: $a_{ij} = -2\\nu_t S_{ij}$. This implies that the tensor $a_{ij}$ is perfectly aligned with (i.e., proportional to) the tensor $S_{ij}$. The \"captured fraction,\" $f$, measures the degree to which this assumed alignment holds true for given flow data.\n\nThe solution proceeds by first formalizing the mathematical framework and then applying it to each specified test case. All tensors are assumed to be $3 \\times 3$, real, and symmetric.\n\nFirst, we define the necessary quantities based on the provided Reynolds stress tensor, $R_{ij}$. The mean turbulent kinetic energy, $k$, is half the trace of $R_{ij}$:\n$$k = \\frac{1}{2} R_{kk} = \\frac{1}{2} \\text{tr}(R)$$\nThe Reynolds stress tensor $R_{ij}$ can be decomposed into an isotropic part, $R^{\\mathrm{iso}}_{ij}$, and a deviatoric (or anisotropic) part, $a_{ij}$. The isotropic part is defined as:\n$$R^{\\mathrm{iso}}_{ij} = \\frac{2}{3} k \\delta_{ij}$$\nwhere $\\delta_{ij}$ is the Kronecker delta (identity tensor). The deviatoric part, $a_{ij}$, is what remains:\n$$a_{ij} = R_{ij} - R^{\\mathrm{iso}}_{ij}$$\nBy this construction, the tensor $a_{ij}$ is always traceless, i.e., $a_{kk} = 0$.\n\nTo measure the \"size\" of and \"angle\" between tensors, we use the Frobenius inner product and its induced norm. For two tensors $A$ and $B$, the inner product is the sum of the products of their corresponding components:\n$$\\langle A, B \\rangle = A_{ij} B_{ij} = \\sum_{i,j} A_{ij} B_{ij}$$\nThe Frobenius norm of a tensor $A$ is given by:\n$$\\|A\\|_F = \\sqrt{\\langle A, A \\rangle} = \\sqrt{\\sum_{i,j} A_{ij}^2}$$\n\nThe core of the problem is to decompose the anisotropy tensor $a_{ij}$ into a component $a_{ij}^{\\parallel}$ that is aligned with the mean rate-of-strain tensor $S_{ij}$, and a component $a_{ij}^{\\perp}$ that is orthogonal to it. This is achieved by an orthogonal projection of $a_{ij}$ onto the one-dimensional subspace spanned by $S_{ij}$.\nThe aligned component $a_{ij}^{\\parallel}$ is found by:\n$$a_{ij}^{\\parallel} = \\text{proj}_{S}(a) = \\frac{\\langle a, S \\rangle}{\\langle S, S \\rangle} S_{ij} = c S_{ij}$$\nwhere $c$ is the projection coefficient. This is valid if $\\langle S, S \\rangle = \\|S\\|_F^2 > 0$. If $S_{ij}$ is the zero tensor, $\\langle S, S \\rangle = 0$, then the projection is defined to be zero, so $a_{ij}^{\\parallel} = 0$.\n\nThe captured fraction, $f$, is defined as the ratio of the squared magnitude of the aligned component to the squared magnitude of the total anisotropy tensor:\n$$f = \\frac{\\|a^{\\parallel}\\|_F^2}{\\|a\\|_F^2}$$\nThis expression is valid when $\\|a\\|_F > 0$. If $\\|a\\|_F = 0$ (i.e., the flow is isotropic), the fraction is defined as $f=1$.\nWe can derive a more direct computational formula for $f$. Substituting the expression for $a^{\\parallel}$:\n$$\\|a^{\\parallel}\\|_F^2 = \\|c S\\|_F^2 = c^2 \\|S\\|_F^2 = \\left(\\frac{\\langle a, S \\rangle}{\\|S\\|_F^2}\\right)^2 \\|S\\|_F^2 = \\frac{\\langle a, S \\rangle^2}{\\|S\\|_F^2}$$\nThus, the captured fraction becomes:\n$$f = \\frac{\\langle a, S \\rangle^2}{\\|a\\|_F^2 \\|S\\|_F^2}$$\nThis is equivalent to the squared cosine of the angle between the tensors $a$ and $S$ when viewed as vectors in the nine-dimensional space of $3 \\times 3$ matrices. This formula is used for calculations when both $\\|a\\|_F > 0$ and $\\|S\\|_F > 0$.\n\nThe complete algorithm is as follows:\n1.  Given tensors $R$ and $S$.\n2.  Calculate $k = \\frac{1}{2} \\text{tr}(R)$.\n3.  Calculate $a = R - \\frac{2}{3} k I$, where $I$ is the identity matrix.\n4.  Calculate $\\|a\\|_F^2 = \\sum_{i,j} a_{ij}^2$.\n5.  If $\\|a\\|_F^2$ is close to zero, $f=1$.\n6.  Calculate $\\|S\\|_F^2 = \\sum_{i,j} S_{ij}^2$.\n7.  If $\\|S\\|_F^2$ is close to zero (and $\\|a\\|_F^2$ is not), $f=0$.\n8.  Otherwise, calculate $\\langle a, S \\rangle = \\sum_{i,j} a_{ij} S_{ij}$.\n9.  Compute $f = \\frac{\\langle a, S \\rangle^2}{\\|a\\|_F^2 \\|S\\|_F^2}$.\n\nWe now apply this procedure to each test case.\n\n**Case 1:**\n$R = \\begin{bmatrix} 1.0 & -0.6 & 0.0 \\\\ -0.6 & 1.0 & 0.0 \\\\ 0.0 & 0.0 & 1.0 \\end{bmatrix}$, $S = \\begin{bmatrix} 0.0 & 10.0 & 0.0 \\\\ 10.0 & 0.0 & 0.0 \\\\ 0.0 & 0.0 & 0.0 \\end{bmatrix}$\n1.  $k = \\frac{1}{2} (1.0 + 1.0 + 1.0) = 1.5$.\n2.  $R^{\\mathrm{iso}} = \\frac{2}{3}(1.5)I = 1.0 I$.\n3.  $a = R - I = \\begin{bmatrix} 0.0 & -0.6 & 0.0 \\\\ -0.6 & 0.0 & 0.0 \\\\ 0.0 & 0.0 & 0.0 \\end{bmatrix}$.\n4.  $\\|a\\|_F^2 = (-0.6)^2 + (-0.6)^2 = 0.36 + 0.36 = 0.72$.\n5.  $\\|S\\|_F^2 = (10.0)^2 + (10.0)^2 = 100 + 100 = 200$.\n6.  $\\langle a, S \\rangle = (-0.6)(10.0) + (-0.6)(10.0) = -12.0$.\n7.  $f_1 = \\frac{(-12.0)^2}{(0.72)(200)} = \\frac{144}{144} = 1.0$.\n\n**Case 2:**\n$R = \\begin{bmatrix} 1.133... & 0.0 & 0.0 \\\\ 0.0 & 1.133... & 0.0 \\\\ 0.0 & 0.0 & 1.733... \\end{bmatrix}$, $S = \\begin{bmatrix} 0.0 & 0.0 & 0.0 \\\\ 0.0 & 0.0 & 0.0 \\\\ 0.0 & 0.0 & 0.0 \\end{bmatrix}$\n1.  $\\text{tr}(R) \\approx 1.133333 + 1.133333 + 1.733334 = 4.0$. $k = \\frac{1}{2}(4.0) = 2.0$.\n2.  $R^{\\mathrm{iso}} = \\frac{2}{3}(2.0)I = \\frac{4}{3}I$. $4/3 \\approx 1.333333$.\n3.  $a_{11} = a_{22} = 1.133333 - 1.333333 = -0.2$. $a_{33} = 1.733334 - 1.333333 \\approx 0.4$.\n    $a = \\begin{bmatrix} -0.2 & 0.0 & 0.0 \\\\ 0.0 & -0.2 & 0.0 \\\\ 0.0 & 0.0 & 0.4 \\end{bmatrix}$.\n4.  $\\|a\\|_F^2 = (-0.2)^2 + (-0.2)^2 + (0.4)^2 = 0.04 + 0.04 + 0.16 = 0.24 > 0$.\n5.  $S$ is the zero tensor, so $\\|S\\|_F^2 = 0$.\n6.  According to the problem convention for $\\|a\\|_F > 0$ and $\\|S\\|_F = 0$, $f_2 = 0.0$.\n\n**Case 3:**\n$R = \\begin{bmatrix} 0.466... & 0.3 & 0.0 \\\\ 0.3 & 1.2 & 0.0 \\\\ 0.0 & 0.0 & 0.666... \\end{bmatrix}$, $S = \\begin{bmatrix} 5.0 & 0.0 & 0.0 \\\\ 0.0 & -5.0 & 0.0 \\\\ 0.0 & 0.0 & 0.0 \\end{bmatrix}$\n1.  $\\text{tr}(R) \\approx 0.466667 + 1.2 + 0.666667 = 2.333334 = 7/3$. $k = \\frac{1}{2}(7/3) = 7/6$.\n2.  $R^{\\mathrm{iso}} = \\frac{2}{3}(7/6)I = \\frac{7}{9}I$. $7/9 \\approx 0.777778$.\n3.  $a_{11} \\approx 0.466667 - 0.777778 = -0.311111 = -14/45$.\n    $a_{22} = 1.2 - 0.777778 = 0.422222 = 19/45$.\n    $a_{33} \\approx 0.666667 - 0.777778 = -0.111111 = -1/9 = -5/45$.\n    $a_{12}=a_{21}=0.3$.\n4.  $\\|a\\|_F^2 = (-14/45)^2 + (19/45)^2 + (-5/45)^2 + 2(0.3)^2 = \\frac{196+361+25}{2025} + 0.18 = \\frac{582}{2025} + 0.18 = \\frac{631}{1350} \\approx 0.467407$.\n5.  $\\|S\\|_F^2 = 5^2 + (-5)^2 = 50$.\n6.  $\\langle a, S \\rangle = (-14/45)(5) + (19/45)(-5) = \\frac{-70-95}{45} = \\frac{-165}{45} = -11/3$.\n7.  $f_3 = \\frac{(-11/3)^2}{(631/1350)(50)} = \\frac{121/9}{631/27} = \\frac{121}{9}\\frac{27}{631} = \\frac{363}{631} \\approx 0.575277$.\n\n**Case 4:**\n$R = \\begin{bmatrix} 0.533... & 0.0 & 0.0 \\\\ 0.0 & 1.133... & 0.0 \\\\ 0.0 & 0.0 & 0.533... \\end{bmatrix}$, $S = \\begin{bmatrix} 0.0 & 10.0 & 0.0 \\\\ 10.0 & 0.0 & 0.0 \\\\ 0.0 & 0.0 & 0.0 \\end{bmatrix}$\n1.  $\\text{tr}(R) \\approx 0.533333 + 1.133333 + 0.533333 = 2.2$. $k = \\frac{1}{2}(2.2) = 1.1$.\n2.  $R^{\\mathrm{iso}} = \\frac{2}{3}(1.1)I = \\frac{2.2}{3}I = \\frac{11}{15}I$. $11/15 \\approx 0.733333$.\n3.  $a_{11} \\approx 0.533333 - 0.733333 = -0.2$.\n    $a_{22} \\approx 1.133333 - 0.733333 = 0.4$.\n    $a_{33} \\approx 0.533333 - 0.733333 = -0.2$. Off-diagonals are zero.\n4.  $\\|a\\|_F^2 = (-0.2)^2 + (0.4)^2 + (-0.2)^2 = 0.04 + 0.16 + 0.04 = 0.24$.\n5.  $\\|S\\|_F^2 = (10.0)^2 + (10.0)^2 = 200$.\n6.  $\\langle a, S \\rangle = a_{12}S_{12} + a_{21}S_{21} = (0)(10) + (0)(10) = 0$.\n7.  $f_4 = \\frac{0^2}{(0.24)(200)} = 0.0$.\n\n**Case 5:**\n$R = \\begin{bmatrix} 0.4 & 0.0 & 0.0 \\\\ 0.0 & 0.4 & 0.0 \\\\ 0.0 & 0.0 & 0.4 \\end{bmatrix}$, $S = \\begin{bmatrix} 2.0 & 0.0 & 0.0 \\\\ 0.0 & -2.0 & 0.0 \\\\ 0.0 & 0.0 & 0.0 \\end{bmatrix}$\n1.  $k = \\frac{1}{2}(0.4 + 0.4 + 0.4) = 0.6$.\n2.  $R^{\\mathrm{iso}} = \\frac{2}{3}(0.6)I = 0.4I$.\n3.  $a = R - R^{\\mathrm{iso}} = 0.4I - 0.4I = \\mathbf{0}$.\n4.  $\\|a\\|_F^2 = 0$.\n5.  According to the problem convention for $\\|a\\|_F = 0$, $f_5 = 1.0$.\n\nThe final computed values are $f_1 = 1.0$, $f_2 = 0.0$, $f_3 \\approx 0.575277$, $f_4 = 0.0$, and $f_5 = 1.0$.",
            "answer": "```python\nimport numpy as np\n\ndef calculate_captured_fraction(R: np.ndarray, S: np.ndarray) -> float:\n    \"\"\"\n    Computes the fraction of the deviatoric Reynolds stress captured by a\n    Boussinesq-type linear model aligned with the mean rate-of-strain.\n\n    Args:\n        R: The 3x3 Reynolds stress tensor.\n        S: The 3x3 mean rate-of-strain tensor.\n\n    Returns:\n        The captured fraction f, a dimensionless value between 0 and 1.\n    \"\"\"\n    # Ensure inputs are numpy arrays with double precision for accuracy.\n    R = np.array(R, dtype=np.float64)\n    S = np.array(S, dtype=np.float64)\n\n    # 1. Calculate turbulent kinetic energy k = 0.5 * tr(R)\n    k = 0.5 * np.trace(R)\n\n    # 2. Calculate the isotropic part of the Reynolds stress tensor\n    # R_iso = (2/3) * k * I, where I is the 3x3 identity matrix.\n    R_iso = (2.0 / 3.0) * k * np.identity(3)\n\n    # 3. Calculate the deviatoric Reynolds stress (anisotropy) tensor a\n    # a = R - R_iso\n    a = R - R_iso\n\n    # 4. Calculate the squared Frobenius norm of the anisotropy tensor a\n    # This is equivalent to <a, a>.\n    norm_a_sq = np.sum(a**2)\n\n    # 5. Handle the special case where a is the zero tensor (isotropic turbulence).\n    # Per the problem statement, if ||a||_F = 0, then f = 1.\n    # A small tolerance is used for floating-point comparison.\n    if norm_a_sq < 1e-15:\n        return 1.0\n\n    # 6. Calculate the squared Frobenius norm of the mean rate-of-strain tensor S.\n    # This is equivalent to <S, S>.\n    norm_s_sq = np.sum(S**2)\n\n    # 7. Handle the special case where S is the zero tensor (no mean strain).\n    # Per the problem statement, if <S, S> = 0 and ||a||_F > 0, then f = 0.\n    if norm_s_sq < 1e-15:\n        return 0.0\n\n    # 8. Calculate the Frobenius inner product of a and S.\n    # <a, S> = sum(a_ij * S_ij)\n    inner_prod_a_s = np.sum(a * S)\n    \n    # 9. Compute the captured fraction f.\n    # f = <a,S>^2 / (||a||_F^2 * ||S||_F^2)\n    # This is the squared cosine of the angle between the tensors a and S.\n    f = (inner_prod_a_s**2) / (norm_a_sq * norm_s_sq)\n    \n    return f\n\ndef solve():\n    \"\"\"\n    Defines the test cases from the problem statement, computes the captured\n    fraction for each, and prints the results in the required format.\n    \"\"\"\n    test_cases = [\n        # Case 1: shear\n        {\n            \"R\": np.array([\n                [1.0, -0.6, 0.0],\n                [-0.6, 1.0, 0.0],\n                [0.0, 0.0, 1.0]\n            ]),\n            \"S\": np.array([\n                [0.0, 10.0, 0.0],\n                [10.0, 0.0, 0.0],\n                [0.0, 0.0, 0.0]\n            ])\n        },\n        # Case 2: solid-body swirl (zero strain)\n        {\n            \"R\": np.array([\n                [1.1333333333333333, 0.0, 0.0],\n                [0.0, 1.1333333333333333, 0.0],\n                [0.0, 0.0, 1.7333333333333334]\n            ]),\n            \"S\": np.array([\n                [0.0, 0.0, 0.0],\n                [0.0, 0.0, 0.0],\n                [0.0, 0.0, 0.0]\n            ])\n        },\n        # Case 3: curved shear\n        {\n            \"R\": np.array([\n                [0.4666666666666667, 0.3, 0.0],\n                [0.3, 1.2, 0.0],\n                [0.0, 0.0, 0.6666666666666666]\n            ]),\n            \"S\": np.array([\n                [5.0, 0.0, 0.0],\n                [0.0, -5.0, 0.0],\n                [0.0, 0.0, 0.0]\n            ])\n        },\n        # Case 4: misaligned anisotropy with shear\n        {\n            \"R\": np.array([\n                [0.5333333333333333, 0.0, 0.0],\n                [0.0, 1.1333333333333333, 0.0],\n                [0.0, 0.0, 0.5333333333333333]\n            ]),\n            \"S\": np.array([\n                [0.0, 10.0, 0.0],\n                [10.0, 0.0, 0.0],\n                [0.0, 0.0, 0.0]\n            ])\n        },\n        # Case 5: isotropic turbulence\n        {\n            \"R\": np.array([\n                [0.4, 0.0, 0.0],\n                [0.0, 0.4, 0.0],\n                [0.0, 0.0, 0.4]\n            ]),\n            \"S\": np.array([\n                [2.0, 0.0, 0.0],\n                [0.0, -2.0, 0.0],\n                [0.0, 0.0, 0.0]\n            ])\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        R_val = case[\"R\"]\n        S_val = case[\"S\"]\n        f = calculate_captured_fraction(R_val, S_val)\n        results.append(f)\n\n    # Format the output string as a comma-separated list of values\n    # rounded to six decimal places, enclosed in square brackets.\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        },
        {
            "introduction": "While the Boussinesq hypothesis offers a simple and often effective model, its assumption of a purely local relationship between stress and strain is a significant simplification. This practice explores a classic scenario where this locality breaks down, leading to incorrect predictions. By analyzing a manufactured flow field, you will discover how non-local pressure effects and indirect production mechanisms can generate Reynolds stresses in ways that a simple eddy-viscosity model cannot capture .",
            "id": "3371215",
            "problem": "Consider an incompressible, homogeneous turbulent flow subjected to a spatially uniform mean velocity gradient generated by the manufactured mean velocity field\n$$\n\\boldsymbol{U}(\\boldsymbol{x}) = \\big(U_1,U_2,U_3\\big) = \\big(a\\, y,\\; b\\, z,\\; c\\, y\\big),\n$$\nwith constants $a \\neq 0$ and $b+c \\neq 0$. Let the instantaneous velocity be decomposed as $u_i = U_i + u_i'$, where angle brackets denote Reynolds averaging and the Reynolds stress is $R_{ij} = \\langle u_i' u_j' \\rangle$. The mean strain-rate tensor is\n$$\nS_{ij} = \\frac{1}{2}\\left(\\frac{\\partial U_i}{\\partial x_j} + \\frac{\\partial U_j}{\\partial x_i}\\right).\n$$\nAssume unit density, constant molecular viscosity, and periodic boundary conditions so that spatial homogeneity holds. The linear eddy-viscosity hypothesis of Boussinesq posits a linear proportionality between the deviatoric Reynolds stress and the mean strain-rate tensor. A Direct Numerical Simulation (DNS) is understood to solve the incompressible Navier–Stokes equations without modeling, thereby including the exact pressure–velocity coupling and pressure–strain effects.\n\nUsing only the stated base definitions and fundamental consequences of incompressible flow, and taking the manufactured mean field above as given, determine which of the following statements are necessarily true.\n\nA. In this mean flow, the Boussinesq eddy-viscosity hypothesis necessarily predicts $R_{13} = 0$ for any positive eddy viscosity.\n\nB. Because $S_{13} = 0$, the exact Reynolds-stress transport equation forbids any production or redistribution into $R_{13}$; therefore a DNS must give $R_{13} = 0$ in statistically steady state.\n\nC. The isotropic part of the Reynolds stress, $(2/3)\\,k\\,\\delta_{ij}$ with $k = \\tfrac{1}{2} R_{mm}$, cannot generate a non-zero $R_{13}$; hence any non-zero $R_{13}$ must arise from non-isotropic mechanisms in the transport equation.\n\nD. The nonlocality of incompressible turbulence enters through the elliptic pressure Poisson equation, which allows the pressure–strain correlation to redistribute energy and contribute to a non-zero $R_{13}$ even when $S_{13} = 0$.\n\nE. Any algebraic stress model that is a purely local function of the mean strain-rate tensor $\\boldsymbol{S}$ alone (with no dependence on the mean rotation-rate tensor or on spatial nonlocality) will necessarily predict $R_{13} = 0$ in this flow.\n\nF. In the exact Reynolds-stress transport equation, the production term for $R_{13}$ is $P_{13} = - a\\, R_{23} - c\\, R_{12}$, which can be non-zero when $R_{12}$ and $R_{23}$ are non-zero; thus $R_{13}$ can be generated even if $S_{13}=0$.\n\nSelect all that apply.",
            "solution": "The problem statement has been validated and is determined to be a valid, well-posed, and scientifically grounded problem in the field of turbulence theory and modeling. We may proceed with the solution.\n\nFirst, we compute the necessary tensors from the given mean velocity field, $\\boldsymbol{U}(\\boldsymbol{x}) = (U_1, U_2, U_3) = (a\\,y, b\\,z, c\\,y)$, where $y=x_2$ and $z=x_3$. The constraints are $a \\neq 0$ and $b+c \\neq 0$.\n\nThe mean velocity gradient tensor, $\\partial U_i / \\partial x_j$, is:\n$$\n\\frac{\\partial U_i}{\\partial x_j} = \n\\begin{pmatrix}\n\\frac{\\partial (ay)}{\\partial x} & \\frac{\\partial (ay)}{\\partial y} & \\frac{\\partial (ay)}{\\partial z} \\\\\n\\frac{\\partial (bz)}{\\partial x} & \\frac{\\partial (bz)}{\\partial y} & \\frac{\\partial (bz)}{\\partial z} \\\\\n\\frac{\\partial (cy)}{\\partial x} & \\frac{\\partial (cy)}{\\partial y} & \\frac{\\partial (cy)}{\\partial z}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0 & a & 0 \\\\\n0 & 0 & b \\\\\n0 & c & 0\n\\end{pmatrix}\n$$\nThe mean strain-rate tensor, $S_{ij} = \\frac{1}{2}(\\partial U_i / \\partial x_j + \\partial U_j / \\partial x_i)$, is:\n$$\n\\boldsymbol{S} = \\frac{1}{2} \\left( \n\\begin{pmatrix}\n0 & a & 0 \\\\\n0 & 0 & b \\\\\n0 & c & 0\n\\end{pmatrix}\n+\n\\begin{pmatrix}\n0 & 0 & 0 \\\\\na & 0 & c \\\\\n0 & b & 0\n\\end{pmatrix}\n\\right)\n= \\frac{1}{2}\n\\begin{pmatrix}\n0 & a & 0 \\\\\na & 0 & b+c \\\\\n0 & b+c & 0\n\\end{pmatrix}\n$$\nThe components of the mean strain-rate tensor are:\n$S_{11} = 0$, $S_{22} = 0$, $S_{33} = 0$.\n$S_{12} = S_{21} = a/2$.\n$S_{23} = S_{32} = (b+c)/2$.\n$S_{13} = S_{31} = 0$.\nThe crucial observation is that the $(1,3)$ component of the mean strain-rate tensor is zero, $S_{13} = 0$.\n\nNow we evaluate each statement.\n\n**A. In this mean flow, the Boussinesq eddy-viscosity hypothesis necessarily predicts $R_{13} = 0$ for any positive eddy viscosity.**\n\nThe linear eddy-viscosity hypothesis of Boussinesq relates the deviatoric Reynolds stress, $R_{ij} - \\frac{1}{3}R_{mm}\\delta_{ij}$, to the mean strain-rate tensor. Using the problem's notation where $k = \\frac{1}{2}R_{mm}$ is the turbulent kinetic energy, the isotropic part is $\\frac{2}{3}k\\delta_{ij}$. The hypothesis is:\n$$R_{ij} - \\frac{2}{3}k\\delta_{ij} = -2\\nu_t S_{ij}$$\nwhere $\\nu_t$ is the scalar eddy viscosity. This can be written for any component as:\n$$R_{ij} = \\frac{2}{3}k\\delta_{ij} - 2\\nu_t S_{ij}$$\nFor the component $R_{13}$, we have $i=1, j=3$. The Kronecker delta $\\delta_{13}$ is $0$.\n$$R_{13} = \\frac{2}{3}k\\delta_{13} - 2\\nu_t S_{13} = \\frac{2}{3}k(0) - 2\\nu_t S_{13} = -2\\nu_t S_{13}$$\nWe have calculated that for this specific mean flow, $S_{13} = 0$. Substituting this into the equation:\n$$R_{13} = -2\\nu_t (0) = 0$$\nThis result is independent of the value of the eddy viscosity $\\nu_t$, as long as it is finite. Thus, for any positive $\\nu_t$, the model predicts $R_{13} = 0$.\nVerdict: **Correct**.\n\n**B. Because $S_{13} = 0$, the exact Reynolds-stress transport equation forbids any production or redistribution into $R_{13}$; therefore a DNS must give $R_{13} = 0$ in statistically steady state.**\n\nThis statement is incorrect. The generation of Reynolds stresses is governed by the Reynolds-stress transport equation (RSTE). For a homogeneous flow, the equation is $\\frac{d R_{ij}}{dt} = P_{ij} + \\Pi_{ij} - \\varepsilon_{ij}$. The production term is $P_{ij} = -R_{ik}\\frac{\\partial U_j}{\\partial x_k} - R_{jk}\\frac{\\partial U_i}{\\partial x_k}$. Let's calculate the production of $R_{13}$:\n$$P_{13} = -R_{1k}\\frac{\\partial U_3}{\\partial x_k} - R_{3k}\\frac{\\partial U_1}{\\partial x_k}$$\nUsing the components of the mean velocity gradient tensor, whose only non-zero components are $\\partial U_1/\\partial x_2=a$, $\\partial U_2/\\partial x_3=b$, and $\\partial U_3/\\partial x_2=c$:\n$$P_{13} = -\\left( R_{12}\\frac{\\partial U_3}{\\partial x_2} \\right) - \\left( R_{32}\\frac{\\partial U_1}{\\partial x_2} \\right)$$\n$$P_{13} = -R_{12}(c) - R_{32}(a) = -c R_{12} - a R_{23}$$\nSince $S_{12}=a/2 \\neq 0$ and $S_{23}=(b+c)/2 \\neq 0$, we expect that these flows will generate non-zero Reynolds stresses $R_{12}$ and $R_{23}$. Therefore, the production term $P_{13}$ is generally non-zero. This is a mechanism of indirect production, where a Reynolds stress component is generated via other non-zero stress components and velocity gradients, even when its corresponding mean strain-rate component is zero. Since production is not forbidden, the premise of the statement is false. Consequently, a DNS, which solves the exact equations, would not be constrained to yield $R_{13}=0$.\nVerdict: **Incorrect**.\n\n**C. The isotropic part of the Reynolds stress, $(2/3)\\,k\\,\\delta_{ij}$ with $k = \\tfrac{1}{2} R_{mm}$, cannot generate a non-zero $R_{13}$; hence any non-zero $R_{13}$ must arise from non-isotropic mechanisms in the transport equation.**\n\nThe Reynolds stress tensor $R_{ij}$ can be decomposed into an isotropic part and an anisotropic (or deviatoric) part, $a_{ij}$:\n$$R_{ij} = \\frac{2}{3}k\\delta_{ij} + a_{ij}$$\nBy definition, the isotropic part $\\frac{2}{3}k\\delta_{ij}$ has non-zero components only when $i=j$. For any off-diagonal component such as $R_{13}$ (where $i \\neq j$), $\\delta_{13}=0$, so the isotropic part is zero. Any non-zero value of $R_{13}$ is thus purely a feature of the anisotropic part, $a_{13}=R_{13}$. The mechanisms in the RSTE ($P_{ij}$, $\\Pi_{ij}$, $\\varepsilon_{ij}$) describe the dynamics of the full stress tensor. The production term $P_{ij}$ is directly linked to the interaction of existing stress anisotropies with the mean shear. The pressure-strain term $\\Pi_{ij}$ serves to redistribute energy among the components of the stress tensor, driving the turbulence towards isotropy (in its \"slow\" part) and responding to the mean shear (in its \"rapid\" part). Thus, the generation and maintenance of an anisotropic component like $R_{13}$ fundamentally rely on these anisotropic physical mechanisms. The statement is conceptually sound.\nVerdict: **Correct**.\n\n**D. The nonlocality of incompressible turbulence enters through the elliptic pressure Poisson equation, which allows the pressure–strain correlation to redistribute energy and contribute to a non-zero $R_{13}$ even when $S_{13} = 0$.**\n\nIn an incompressible flow, the pressure fluctuation field $p'$ is governed by a Poisson equation, $\\nabla^2 p' = -\\rho \\nabla \\cdot \\nabla \\cdot (\\boldsymbol{u}' \\boldsymbol{u}' - \\langle \\boldsymbol{u}' \\boldsymbol{u}' \\rangle) - 2\\rho \\nabla \\boldsymbol{U} : \\nabla\\boldsymbol{u}'$. Being an elliptic equation, the solution for $p'$ at any given point depends on the source terms (velocity fluctuations) throughout the entire domain. This makes pressure a non-local quantity. The pressure-strain correlation term, $\\Pi_{ij} = \\langle p'(\\partial u_i'/\\partial x_j + \\partial u_j'/\\partial x_i) \\rangle$, inherits this non-locality. Its role in the RSTE is to redistribute turbulent kinetic energy among the different Reynolds stress components. In the steady-state equation for $R_{13}$, $0 = P_{13} + \\Pi_{13} - \\varepsilon_{13}$. As established in the analysis of option B, the production term $P_{13}$ can be non-zero. To achieve a balance, $\\Pi_{13}$ (and/or $\\varepsilon_{13}$) must also be non-zero. The pressure-strain term acts as a key mechanism that redistributes the energy produced via $P_{12}$ and $P_{23}$ into the $R_{13}$ component (among others). This statement correctly identifies the non-local nature of pressure and the redistributive role of the pressure-strain term in sustaining $R_{13}$.\nVerdict: **Correct**.\n\n**E. Any algebraic stress model that is a purely local function of the mean strain-rate tensor $\\boldsymbol{S}$ alone (with no dependence on the mean rotation-rate tensor or on spatial nonlocality) will necessarily predict $R_{13} = 0$ in this flow.**\n\nAn algebraic stress model (ASM) provides an explicit expression for the Reynolds stresses. A model that is a function of the tensor $\\boldsymbol{S}$ alone can be expressed, via representation theorems for isotropic tensor functions, as a polynomial in $\\boldsymbol{S}$:\n$$\\boldsymbol{R} = f(\\boldsymbol{S}) = \\alpha_0 \\boldsymbol{I} + \\alpha_1 \\boldsymbol{S} + \\alpha_2 \\boldsymbol{S}^2$$\nwhere $\\boldsymbol{I}$ is the identity tensor and the coefficients $\\alpha_n$ are scalar functions of the invariants of $\\boldsymbol{S}$. Let's examine the $(1,3)$ component of this expression:\n$$R_{13} = \\alpha_0 I_{13} + \\alpha_1 S_{13} + \\alpha_2 (S^2)_{13}$$\nWe know $I_{13}=0$ and $S_{13}=0$. We must compute the $(1,3)$ component of $\\boldsymbol{S}^2$:\n$$\n\\boldsymbol{S}^2 = \\frac{1}{4}\n\\begin{pmatrix}\n0 & a & 0 \\\\\na & 0 & b+c \\\\\n0 & b+c & 0\n\\end{pmatrix}\n\\begin{pmatrix}\n0 & a & 0 \\\\\na & 0 & b+c \\\\\n0 & b+c & 0\n\\end{pmatrix}\n= \\frac{1}{4}\n\\begin{pmatrix}\na^2 & 0 & a(b+c) \\\\\n0 & a^2+(b+c)^2 & 0 \\\\\na(b+c) & 0 & (b+c)^2\n\\end{pmatrix}\n$$\nThe $(1,3)$ component is $(S^2)_{13} = \\frac{1}{4}a(b+c)$. Since $a \\neq 0$ and $b+c \\neq 0$, $(S^2)_{13} \\neq 0$.\nThe model prediction for $R_{13}$ becomes:\n$$R_{13} = \\alpha_2 \\left(\\frac{1}{4}a(b+c)\\right)$$\nWhile the linear Boussinesq model corresponds to $\\alpha_2=0$ and correctly predicts $R_{13}=0$ (as per option A), a non-linear ASM can have $\\alpha_2 \\neq 0$. Such non-linear models exist and are designed to capture effects that linear models miss. Since a non-linear local function of $\\boldsymbol{S}$ can predict a non-zero $R_{13}$, the statement that *any* such model *necessarily* predicts $R_{13}=0$ is false.\nVerdict: **Incorrect**.\n\n**F. In the exact Reynolds-stress transport equation, the production term for $R_{13}$ is $P_{13} = - a\\, R_{23} - c\\, R_{12}$, which can be non-zero when $R_{12}$ and $R_{23}$ are non-zero; thus $R_{13}$ can be generated even if $S_{13}=0$.**\n\nThis statement presents the result of the calculation for the production term $P_{13}$. As derived in the analysis for option B, the production term for $R_{ij}$ is $P_{ij} = -R_{ik}\\frac{\\partial U_j}{\\partial x_k} - R_{jk}\\frac{\\partial U_i}{\\partial x_k}$. For $i=1, j=3$, this yields:\n$$P_{13} = -R_{1k}\\frac{\\partial U_3}{\\partial x_k} - R_{3k}\\frac{\\partial U_1}{\\partial x_k}$$\nSubstituting the known non-zero velocity gradients $\\partial U_1/\\partial x_2 = a$ and $\\partial U_3/\\partial x_2=c$:\n$$P_{13} = -R_{12}\\frac{\\partial U_3}{\\partial x_2} - R_{32}\\frac{\\partial U_1}{\\partial x_2} = -R_{12}(c) - R_{23}(a) = -a R_{23} - c R_{12}$$\n(noting symmetry $R_{32}=R_{23}$). This expression for $P_{13}$ is identical to the one given in the statement. Since the mean strain-rate components $S_{12}$ and $S_{23}$ are non-zero, it is expected that $R_{12}$ and $R_{23}$ will be produced and sustained at non-zero values. Consequently, $P_{13}$ will generally be non-zero, acting as a source term in the transport equation for $R_{13}$ and allowing it to be generated even though its corresponding strain-rate component $S_{13}$ is zero. This statement accurately describes this critical physical mechanism.\nVerdict: **Correct**.",
            "answer": "$$\\boxed{ACDF}$$"
        },
        {
            "introduction": "The theoretical limitations of the Boussinesq hypothesis, such as its local nature, manifest as practical failures in certain types of flows. This final exercise investigates one of the most well-known issues: the model's poor performance in strong irrotational strains, such as those found near a stagnation point. You will derive and implement a test for \"realizability\" to see how the model can predict physically impossible stress states, a critical failure mode known as violating the two-component limit .",
            "id": "3371220",
            "problem": "Consider a three-dimensional incompressible turbulent flow whose mean-velocity gradient tensor has vanishing mean-rotation tensor and strong mean-strain tensor, representative of a stagnation-point boundary layer. Let the mean-strain tensor be denoted by $S_{ij}$ and the mean-rotation tensor by $\\Omega_{ij}$. Assume $\\Omega_{ij} \\approx 0$ and that $S_{ij}$ is diagonalizable with one strongly compressive principal direction aligned with the $x$-axis. For a simple canonical representation, take\n$$\nS_{ij} = \\mathrm{diag}(-a,\\; a,\\; 0),\n$$\nwith $a>0$ and $\\mathrm{tr}(S)=0$.\n\nThe Boussinesq eddy-viscosity hypothesis models the Reynolds stress tensor as\n$$\nR_{ij} \\equiv \\langle u_i' u_j' \\rangle \\approx \\frac{2}{3}k \\, \\delta_{ij} - 2 \\nu_t S_{ij},\n$$\nwhere $k$ is the turbulent kinetic energy and $\\nu_t$ is the turbulent (eddy) kinematic viscosity. Define the anisotropy tensor $b_{ij}$ by\n$$\nb_{ij} \\equiv \\frac{R_{ij}}{2k} - \\frac{1}{3}\\delta_{ij}.\n$$\nA necessary realizability condition for turbulence is that the eigenvalues of $b_{ij}$ lie in the closed interval $[-1/3,\\,2/3]$, which implies the physical bounds $0 \\le R_{ii} \\le 2k$ for each normal stress component $R_{ii}$.\n\nYou will examine two questions in this irrotational strong-strain setting:\n\n1) Overprediction of the streamwise normal stress: Using only the definitions above and the realizability bounds, derive a condition on $(a, k, \\nu_t)$ under which the Boussinesq hypothesis predicts a streamwise normal stress $R_{xx}$ that exceeds its realizability-consistent maximum along the $x$-direction. Implement this as a boolean test that returns true if and only if such an overprediction occurs.\n\n2) Underprediction of passive-scalar heat transfer with a specified turbulent Prandtl number: For a passive scalar with mean gradient $\\partial \\theta / \\partial x \\equiv G_x$, the gradient-diffusion closure gives the turbulent scalar flux along $x$ as\n$$\nq_x \\equiv \\langle u_x' \\theta' \\rangle \\approx - \\alpha_t \\, G_x, \\quad \\alpha_t \\equiv \\frac{\\nu_t}{\\mathrm{Pr}_t},\n$$\nwhere $\\mathrm{Pr}_t$ is the turbulent Prandtl number. It is a well-tested empirical fact that in strong-strain, stagnation-dominated flows with $\\Omega_{ij} \\approx 0$, the effective turbulent Prandtl number decreases toward values near $0.7$, while in weak-strain flows it remains near $0.85$. For the purpose of this problem, model this trend with the following piecewise-constant rule based on the dimensionless strain parameter\n$$\n\\chi \\equiv \\frac{\\nu_t \\, a}{k}:\n$$\n- If $\\chi \\ge 0.5$, set the effective value $\\mathrm{Pr}_{t,\\mathrm{true}} = 0.7$.\n- If $\\chi < 0.5$, set $\\mathrm{Pr}_{t,\\mathrm{true}} = 0.85$.\n\nGiven a user-specified model value $\\mathrm{Pr}_{t,\\mathrm{model}}$, declare that the model underpredicts heat transfer along $x$ if and only if the magnitude of the modeled turbulent heat flux is smaller than the magnitude of the turbulent heat flux using the effective value, that is,\n$$\n\\left|\\frac{\\nu_t}{\\mathrm{Pr}_{t,\\mathrm{model}}} G_x\\right| < \\left|\\frac{\\nu_t}{\\mathrm{Pr}_{t,\\mathrm{true}}} G_x\\right|.\n$$\n\nYour task is to write a program that, for each test case below, computes two booleans:\n- The first boolean indicates whether Boussinesq overpredicts $R_{xx}$ in the sense of violating the realizability-consistent maximum.\n- The second boolean indicates whether the specified $\\mathrm{Pr}_{t,\\mathrm{model}}$ underpredicts the magnitude of the modeled turbulent heat flux compared to the effective $\\mathrm{Pr}_{t,\\mathrm{true}}$ determined from $\\chi$.\n\nAll quantities are to be treated as dimensionless numbers; do not use physical units.\n\nTest suite (each case is given as $(a, k, \\nu_t, \\mathrm{Pr}_{t,\\mathrm{model}}, G_x)$):\n- Case 1 (happy path, weak strain): $(10.0,\\; 1.0,\\; 0.04,\\; 0.85,\\; 1.0)$.\n- Case 2 (moderately strong strain, below overprediction threshold): $(10.0,\\; 1.0,\\; 0.06,\\; 0.85,\\; 1.0)$.\n- Case 3 (boundary for $R_{xx}$ overprediction): $(10.0,\\; 1.0,\\; 0.06666666666666667,\\; 0.85,\\; 1.0)$.\n- Case 4 (strong strain, clear $R_{xx}$ overprediction): $(10.0,\\; 1.0,\\; 0.08,\\; 0.90,\\; 1.0)$.\n- Case 5 (very strong strain, model with low $\\mathrm{Pr}_{t,\\mathrm{model}}$): $(10.0,\\; 1.0,\\; 0.12,\\; 0.70,\\; 1.0)$.\n\nFinal output format requirement:\n- Your program should produce a single line of output containing the results as a comma-separated list of pairs, each pair being a two-element list $[b_1,b_2]$ of booleans for one test case, and the whole list enclosed in square brackets. For example, an output for three cases might look like: \"[[True,False],[False,False],[True,True]]\".",
            "solution": "The problem statement is validated as scientifically grounded, well-posed, and objective. It is rooted in the standard theory of turbulence modeling and presents a clear, solvable set of tasks. We proceed to the derivation and solution.\n\nThe solution requires the evaluation of two conditions for each test case provided. The first concerns a realizability violation by the Boussinesq eddy-viscosity model, and the second concerns the accuracy of a scalar-flux model.\n\n**1. Condition for Overprediction of Streamwise Normal Stress ($R_{xx}$)**\n\nThe Boussinesq hypothesis models the Reynolds stress tensor, $R_{ij} \\equiv \\langle u_i' u_j' \\rangle$, as a linear function of the mean-strain tensor, $S_{ij}$:\n$$\nR_{ij} = \\frac{2}{3}k \\, \\delta_{ij} - 2\\nu_t S_{ij}\n$$\nHere, $k$ is the turbulent kinetic energy, $\\nu_t$ is the eddy viscosity, and $\\delta_{ij}$ is the Kronecker delta. The problem specifies a mean-strain tensor for an irrotational stagnation-point flow:\n$$\nS_{ij} = \\mathrm{diag}(-a, a, 0)\n$$\nwith $a > 0$. We are tasked with finding the condition under which the model-predicted streamwise normal stress, $R_{xx}$, exceeds its realizability-consistent maximum value of $2k$. The component $R_{xx}$ corresponds to $i=1$ and $j=1$. Using the provided definition for $S_{ij}$, we have $S_{11} = -a$. The Kronecker delta $\\delta_{11}$ is $1$. Substituting these into the Boussinesq formula yields:\n$$\nR_{xx} = R_{11} = \\frac{2}{3}k \\cdot (1) - 2\\nu_t (-a) = \\frac{2}{3}k + 2\\nu_t a\n$$\nThe model is said to overpredict this stress if it violates the realizability bound $R_{xx} \\le 2k$. The condition for overprediction is therefore:\n$$\nR_{xx} > 2k\n$$\nSubstituting our expression for the modeled $R_{xx}$:\n$$\n\\frac{2}{3}k + 2\\nu_t a > 2k\n$$\nWe solve this inequality for the dimensionless parameters. Assuming $k>0$, we subtract $\\frac{2}{3}k$ from both sides:\n$$\n2\\nu_t a > 2k - \\frac{2}{3}k\n$$\n$$\n2\\nu_t a > \\frac{4}{3}k\n$$\nDividing by $2$ and then by $k$ (since $k>0$), we obtain the condition in terms of the dimensionless strain parameter $\\chi \\equiv \\frac{\\nu_t a}{k}$:\n$$\n\\frac{\\nu_t a}{k} > \\frac{2}{3}\n$$\nThe first boolean result for each test case, $b_1$, is `True` if and only if $\\chi > \\frac{2}{3}$.\n\n**2. Condition for Underprediction of Passive Scalar Flux**\n\nThe turbulent scalar flux along the $x$-direction, $q_x$, is modeled using the gradient-diffusion hypothesis:\n$$\nq_x \\equiv \\langle u_x' \\theta' \\rangle \\approx -\\alpha_t G_x = -\\frac{\\nu_t}{\\mathrm{Pr}_t} G_x\n$$\nwhere $\\mathrm{Pr}_t$ is the turbulent Prandtl number and $G_x$ is the mean scalar gradient. Underprediction of the heat transfer magnitude is defined to occur when the magnitude of the flux calculated with a user-specified model value, $\\mathrm{Pr}_{t,\\mathrm{model}}$, is less than the magnitude of the flux calculated with an empirically determined \"true\" value, $\\mathrm{Pr}_{t,\\mathrm{true}}$:\n$$\n\\left|-\\frac{\\nu_t}{\\mathrm{Pr}_{t,\\mathrm{model}}} G_x\\right| < \\left|-\\frac{\\nu_t}{\\mathrm{Pr}_{t,\\mathrm{true}}} G_x\\right|\n$$\nGiven that $\\nu_t$, $\\mathrm{Pr}_t$, and $|\\mathrm{G}_x|$ (for a non-trivial gradient) are positive, we can simplify this inequality:\n$$\n\\frac{\\nu_t}{\\mathrm{Pr}_{t,\\mathrm{model}}} < \\frac{\\nu_t}{\\mathrm{Pr}_{t,\\mathrm{true}}}\n$$\nDividing by $\\nu_t$ and taking the reciprocal of both sides reverses the inequality sign:\n$$\n\\mathrm{Pr}_{t,\\mathrm{model}} > \\mathrm{Pr}_{t,\\mathrm{true}}\n$$\nThis simple inequality is the condition for underprediction. The value of $\\mathrm{Pr}_{t,\\mathrm{true}}$ is determined by a piecewise-constant function of the dimensionless strain parameter $\\chi = \\frac{\\nu_t a}{k}$:\n$$\n\\mathrm{Pr}_{t,\\mathrm{true}} =\n\\begin{cases}\n    0.7  & \\text{if } \\chi \\ge 0.5 \\\\\n    0.85 & \\text{if } \\chi < 0.5\n\\end{cases}\n$$\nThe second boolean result, $b_2$, is `True` if and only if the given $\\mathrm{Pr}_{t,\\mathrm{model}}$ is greater than the $\\mathrm{Pr}_{t,\\mathrm{true}}$ value determined by this rule.\n\nThe algorithm to be implemented will, for each test case, first compute $\\chi = \\frac{\\nu_t a}{k}$, then evaluate the two boolean conditions derived above.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes two boolean flags for each test case according to the problem statement.\n    1. Boussinesq model overprediction of streamwise normal stress.\n    2. Model underprediction of passive scalar heat transfer.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (a, k, nu_t, Pr_t_model, G_x)\n    test_cases = [\n        (10.0, 1.0, 0.04, 0.85, 1.0),\n        (10.0, 1.0, 0.06, 0.85, 1.0),\n        (10.0, 1.0, 0.06666666666666667, 0.85, 1.0),\n        (10.0, 1.0, 0.08, 0.90, 1.0),\n        (10.0, 1.0, 0.12, 0.70, 1.0),\n    ]\n\n    results = []\n    \n    # Define constants used in the analysis.\n    RXX_OVERPREDICTION_THRESHOLD = 2.0 / 3.0\n    CHI_PRT_THRESHOLD = 0.5\n    PRT_TRUE_HIGH_STRAIN = 0.7\n    PRT_TRUE_LOW_STRAIN = 0.85\n\n    for case in test_cases:\n        a, k, nu_t, pr_t_model, g_x = case\n\n        # Calculate the dimensionless strain parameter chi.\n        # Assuming k is not zero, which is physically required for turbulence.\n        chi = (nu_t * a) / k\n\n        # Part 1: Check for R_xx overprediction.\n        # The condition derived is chi > 2/3.\n        b1 = chi > RXX_OVERPREDICTION_THRESHOLD\n        \n        # Part 2: Check for heat transfer underprediction.\n        # First, determine the \"true\" turbulent Prandtl number based on chi.\n        if chi >= CHI_PRT_THRESHOLD:\n            pr_t_true = PRT_TRUE_HIGH_STRAIN\n        else:\n            pr_t_true = PRT_TRUE_LOW_STRAIN\n        \n        # The condition for underprediction is Pr_t_model > Pr_t_true.\n        b2 = pr_t_model > pr_t_true\n\n        results.append([b1, b2])\n\n    # Final print statement in the exact required format.\n    # The `map(str, results)` automatically handles the list-to-string conversion\n    # including the boolean capitalization as 'True' or 'False'.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}