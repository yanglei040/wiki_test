{
    "hands_on_practices": [
        {
            "introduction": "To effectively address the challenges of added mass in Fluid-Structure Interaction (FSI) simulations, we must first understand its physical origin. This exercise grounds our understanding by returning to first principles, guiding you through the classic derivation of the added mass for a 2D cylinder in an ideal fluid . By connecting the fluid's kinetic energy to the body's motion, you will see how this inertial effect is not an abstract concept but a direct consequence of displacing and accelerating the surrounding fluid.",
            "id": "3288867",
            "problem": "An infinitely long circular cylinder of radius $R$ translates with a prescribed small-amplitude velocity $U(t)$ in an otherwise quiescent, incompressible, inviscid fluid of constant density $\\rho$. Assume two-dimensional ($2$D) irrotational flow with velocity field $\\boldsymbol{u}=\\nabla \\phi$ and potential $\\phi$ that satisfies Laplace’s equation in the fluid domain exterior to the cylinder. Impose the no-penetration boundary condition on the cylinder surface and require the disturbance velocity to decay to zero at infinity. Using first principles for potential flow and the kinetic energy definition of added mass, derive a closed-form expression for the added mass per unit length $m_{a}'$ associated with translation of the cylinder in a direction perpendicular to its axis by equating the fluid kinetic energy to $\\tfrac{1}{2} m_{a}' U^{2}$ for constant $U$. Express your final result symbolically in terms of $\\rho$ and $R$ only.\n\nThen, explain briefly why dimensionality matters by contrasting the qualitative outcome for a two-dimensional cylinder with that for a three-dimensional ($3$D) sphere, and interpret the implication for Fluid-Structure Interaction (FSI) stability in partitioned coupling when the structural mass per unit length $m_{s}'$ is comparable to, or smaller than, the fluid added mass.\n\nProvide only the symbolic expression for $m_{a}'$ as your final answer. Do not include units in the final answer box.",
            "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, and objective.\n\n### Step 1: Extract Givens\n-   Geometry: Infinitely long circular cylinder of radius $R$.\n-   Fluid Properties: Quiescent, incompressible, inviscid fluid of constant density $\\rho$.\n-   Flow Conditions: Two-dimensional ($2$D), irrotational flow.\n-   Velocity Field: $\\boldsymbol{u}=\\nabla \\phi$, where $\\phi$ is the velocity potential.\n-   Governing Equation: $\\nabla^2 \\phi = 0$ in the fluid domain exterior to the cylinder.\n-   Cylinder Motion: Translation with a prescribed velocity $U(t)$. For the added mass calculation, this is taken as a constant $U$.\n-   Boundary Conditions:\n    1.  No-penetration on the cylinder surface ($r=R$).\n    2.  Disturbance velocity decays to zero at infinity ($\\boldsymbol{u} \\to 0$ as $r \\to \\infty$).\n-   Task: Derive the added mass per unit length, $m_{a}'$, by equating the fluid kinetic energy per unit length to $\\frac{1}{2} m_{a}' U^{2}$.\n-   Final Expression: Express $m_{a}'$ symbolically in terms of $\\rho$ and $R$.\n-   Additional Task: Briefly explain the effect of dimensionality and the implication for Fluid-Structure Interaction (FSI) stability.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is a classic and fundamental exercise in potential flow theory, a well-established subfield of fluid dynamics. All givens are scientifically sound and describe a standard idealization.\n-   **Scientifically Grounded**: The problem relies entirely on the principles of potential flow for an ideal fluid, governed by Laplace's equation. These are core, non-controversial concepts in fluid dynamics.\n-   **Well-Posed**: The problem is well-posed. The governing partial differential equation (Laplace's equation) combined with the specified boundary conditions (no-penetration and decay at infinity) for the given geometry ensures that a unique and stable solution for the velocity potential $\\phi$ exists.\n-   **Objective**: The language is precise, using standard mathematical and physical terminology without any subjectivity.\n-   **Completeness and Consistency**: All necessary information is provided. There are no contradictions. The request to use the kinetic energy definition of added mass is a standard and valid approach.\n-   **Other Flaws**: The problem is free of any of the listed flaws. It is a well-defined theoretical physics problem, not metaphorical, incomplete, or unrealistic within its stated idealizations.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. A full solution will be provided.\n\n### Solution Derivation\n\nWe seek to find the added mass per unit length, $m_a'$, of the cylinder. The method prescribed is to calculate the kinetic energy of the fluid per unit length, $KE'$, and equate it to the definition $KE' = \\frac{1}{2} m_a' U^2$.\n\nLet's establish a polar coordinate system $(r, \\theta)$ with its origin at the center of the cylinder's cross-section. The cylinder translates with velocity $U$ along the $x$-axis, which corresponds to the $\\theta=0$ direction.\n\nThe velocity potential $\\phi(r, \\theta)$ must satisfy Laplace's equation in the fluid domain ($r>R$):\n$$\n\\nabla^2 \\phi = \\frac{1}{r} \\frac{\\partial}{\\partial r} \\left( r \\frac{\\partial \\phi}{\\partial r} \\right) + \\frac{1}{r^2} \\frac{\\partial^2 \\phi}{\\partial \\theta^2} = 0\n$$\n\nThe boundary conditions are:\n1.  **No-penetration at the cylinder surface ($r=R$):** The radial component of the fluid velocity, $u_r = \\frac{\\partial \\phi}{\\partial r}$, must equal the radial component of the cylinder's surface velocity. The cylinder's velocity vector is $\\boldsymbol{U} = U \\hat{\\boldsymbol{i}}$. In polar coordinates, $\\hat{\\boldsymbol{i}} = \\cos\\theta \\hat{\\boldsymbol{e}}_r - \\sin\\theta \\hat{\\boldsymbol{e}}_\\theta$. Thus, the radial component of the cylinder's velocity at its surface is $U \\cos\\theta$. The boundary condition is:\n    $$\n    \\left. \\frac{\\partial \\phi}{\\partial r} \\right|_{r=R} = U \\cos\\theta\n    $$\n2.  **Far-field condition ($r \\to \\infty$):** The fluid is quiescent at infinity, so the disturbance velocity $\\boldsymbol{u} = \\nabla\\phi$ must vanish.\n    $$\n    \\nabla\\phi \\to 0 \\quad \\text{as} \\quad r \\to \\infty\n    $$\n\nThe general solution to Laplace's equation in polar coordinates obtained by separation of variables is a superposition of terms of the form $r^{\\pm n} \\cos(n\\theta)$ and $r^{\\pm n} \\sin(n\\theta)$. Given the $\\cos\\theta$ dependence in the surface boundary condition, we seek a solution of the form $\\phi(r, \\theta) = f(r) \\cos\\theta$. Substituting this into Laplace's equation yields the Cauchy-Euler equation for $f(r)$:\n$$\nr^2 f''(r) + r f'(r) - f(r) = 0\n$$\nThe general solution for $f(r)$ is $f(r) = A r + B r^{-1}$. Thus, the potential is:\n$$\n\\phi(r, \\theta) = \\left(A r + \\frac{B}{r}\\right) \\cos\\theta\n$$\nNow, we apply the boundary conditions to determine the constants $A$ and $B$.\nThe velocity field is $\\boldsymbol{u} = \\nabla\\phi = \\frac{\\partial\\phi}{\\partial r}\\hat{\\boldsymbol{e}}_r + \\frac{1}{r}\\frac{\\partial\\phi}{\\partial\\theta}\\hat{\\boldsymbol{e}}_\\theta$.\n$$\n\\boldsymbol{u} = \\left(A - \\frac{B}{r^2}\\right) \\cos\\theta \\, \\hat{\\boldsymbol{e}}_r - \\frac{1}{r}\\left(A r + \\frac{B}{r}\\right) \\sin\\theta \\, \\hat{\\boldsymbol{e}}_\\theta\n$$\nFor the velocity to vanish as $r \\to \\infty$, the constant $A$ must be zero. Otherwise, a uniform flow component would remain. So, $A=0$.\nThe potential simplifies to $\\phi(r, \\theta) = \\frac{B}{r} \\cos\\theta$.\n\nApplying the no-penetration condition at $r=R$:\n$$\n\\left. \\frac{\\partial \\phi}{\\partial r} \\right|_{r=R} = \\left. -\\frac{B}{r^2} \\cos\\theta \\right|_{r=R} = -\\frac{B}{R^2} \\cos\\theta\n$$\nWe equate this to $U \\cos\\theta$:\n$$\n-\\frac{B}{R^2} \\cos\\theta = U \\cos\\theta \\quad \\implies \\quad B = -U R^2\n$$\nThe final expression for the velocity potential is:\n$$\n\\phi(r, \\theta) = -U \\frac{R^2}{r} \\cos\\theta\n$$\nNext, we calculate the kinetic energy of the fluid per unit length, $KE'$.\n$$\nKE' = \\frac{1}{2} \\rho \\iint_{\\text{fluid domain}} |\\boldsymbol{u}|^2 \\, dA = \\frac{1}{2} \\rho \\int_0^{2\\pi} \\int_R^\\infty |\\nabla\\phi|^2 \\, r \\, dr \\, d\\theta\n$$\nWe find the squared magnitude of the velocity field:\n$$\n|\\nabla\\phi|^2 = \\left(\\frac{\\partial\\phi}{\\partial r}\\right)^2 + \\left(\\frac{1}{r}\\frac{\\partial\\phi}{\\partial\\theta}\\right)^2\n$$\nThe derivatives are:\n$$\n\\frac{\\partial\\phi}{\\partial r} = U \\frac{R^2}{r^2} \\cos\\theta \\quad \\text{and} \\quad \\frac{1}{r}\\frac{\\partial\\phi}{\\partial\\theta} = \\frac{1}{r} \\left( U \\frac{R^2}{r} \\sin\\theta \\right) = U \\frac{R^2}{r^2} \\sin\\theta\n$$\nTheir squared sum is:\n$$\n|\\nabla\\phi|^2 = \\left(U \\frac{R^2}{r^2}\\right)^2 (\\cos^2\\theta + \\sin^2\\theta) = U^2 \\frac{R^4}{r^4}\n$$\nNow, we substitute this into the integral for $KE'$:\n$$\nKE' = \\frac{1}{2} \\rho \\int_0^{2\\pi} \\int_R^\\infty \\left( U^2 \\frac{R^4}{r^4} \\right) r \\, dr \\, d\\theta = \\frac{1}{2} \\rho U^2 R^4 \\int_0^{2\\pi} d\\theta \\int_R^\\infty r^{-3} \\, dr\n$$\nEvaluating the integrals:\n$$\n\\int_0^{2\\pi} d\\theta = 2\\pi\n$$\n$$\n\\int_R^\\infty r^{-3} \\, dr = \\left[ -\\frac{1}{2r^2} \\right]_R^\\infty = 0 - \\left(-\\frac{1}{2R^2}\\right) = \\frac{1}{2R^2}\n$$\nSubstituting these results back into the expression for $KE'$:\n$$\nKE' = \\frac{1}{2} \\rho U^2 R^4 (2\\pi) \\left(\\frac{1}{2R^2}\\right) = \\frac{1}{2} \\rho U^2 (\\pi R^2)\n$$\nBy the definition of added mass, $KE' = \\frac{1}{2} m_a' U^2$. Equating the two expressions for $KE'$:\n$$\n\\frac{1}{2} m_a' U^2 = \\frac{1}{2} \\rho U^2 (\\pi R^2)\n$$\nThis gives the added mass per unit length:\n$$\nm_a' = \\rho \\pi R^2\n$$\nThis result is exactly the mass of the fluid displaced by the cylinder per unit length.\n\n### Discussion on Dimensionality and FSI Stability\n\n1.  **Dimensionality Contrast**: For the 2D cylinder, we found $m_a' = \\rho \\pi R^2$. The volume of displaced fluid per unit length is $V' = \\pi R^2$, so $m_a'$ is equal to the mass of the displaced fluid. For a 3D sphere of radius $R$, a similar derivation yields an added mass of $m_a = \\frac{1}{2} \\rho \\left(\\frac{4}{3}\\pi R^3\\right)$. The added mass is half the mass of the displaced fluid. The underlying reason for this difference is the \"room\" the fluid has to move out of the way. In the 2D case, the fluid is constrained to move around the cylinder in a plane. In the 3D case, the fluid can flow around the sphere in all directions (up, down, and sideways), which presents less of an obstruction. This reduced impedance to motion in 3D results in a smaller added mass coefficient.\n\n2.  **Implication for FSI Stability**: This difference has significant implications for the numerical stability of partitioned FSI simulations, especially in light-structure systems. In a partitioned scheme, the fluid and solid domains are solved sequentially. The stability of such a scheme is notoriously poor when the structural density is comparable to or smaller than the fluid density. This is known as the \"added mass instability.\" The stability is often related to the mass ratio $m_s' / m_a'$ (for the 2D case). If the structural mass $m_s'$ is much smaller than the added mass $m_a'$, a fluid force calculated at one time step can produce a very large, non-physical structural acceleration, as the explicit coupling does not implicitly account for the inertial resistance of the fluid that must be accelerated with the structure. This leads to numerical oscillations and divergence.\n\n    Since the 2D cylinder has a larger added mass coefficient (1) compared to the 3D sphere (0.5), the stability problem is more severe for the 2D case, all else being equal. A structure with density $\\rho_s$ has mass per unit length $m_s' = \\rho_s \\pi R^2$. The mass ratio is $m_s' / m_a' = (\\rho_s \\pi R^2) / (\\rho \\pi R^2) = \\rho_s / \\rho$. The system is prone to instability when $\\rho_s / \\rho \\approx 1$ or less. The larger added mass in the 2D case tightens the stability constraint, requiring smaller time steps or more robust (e.g., implicit) coupling schemes compared to an equivalent 3D problem.",
            "answer": "$$\\boxed{\\rho \\pi R^2}$$"
        },
        {
            "introduction": "Now that we have a theoretical grasp of added mass, we can explore its most notorious consequence: numerical instability in partitioned FSI schemes. This problem provides a simplified one-dimensional model of a piston in a fluid-filled tube, creating an intuitive analog for complex FSI systems . By deriving the equation of motion for this combined mass-spring-fluid system and analyzing the stability of an explicit time-stepping scheme, you will directly quantify how the ratio of fluid-to-solid mass can doom a simulation to failure if not handled properly.",
            "id": "3288890",
            "problem": "Consider a one-degree-of-freedom Fluid-Structure Interaction (FSI) system consisting of a rigid, frictionless piston of mass $m_{s}$ that moves axially within a straight, rigid tube of length $L$ and constant cross-sectional area $A$. The tube is completely filled with an incompressible, inviscid fluid of density $\\rho$. The piston is attached to a linear spring with stiffness $k_{s}$ that exerts a restoring force proportional to the piston displacement $x(t)$. Assume no leakage and no slip at the wall, and idealize the fluid motion as a uniform plug flow so that the fluid velocity field is spatially uniform and equal to the piston velocity.\n\nStarting from Newton’s second law and the definition of kinetic energy, treat the fluid inertia as an added mass acting on the piston. Then, consider explicit time integration of the resulting monolithic mass-spring system using the central-difference scheme. Derive the largest stable time step for this scheme by analyzing the discrete-time amplification factor and imposing the condition for bounded oscillatory solutions.\n\nYour tasks:\n- Derive the added mass $m_{a}$ using first principles.\n- Derive the largest stable time step $\\Delta t_{\\max}$ for the explicit central-difference scheme applied to the combined mass-spring system.\n\nExpress the added mass in kilograms and the time step in seconds. Provide your final answers in closed form in terms of $m_{s}$, $\\rho$, $A$, $L$, and $k_{s}$. No numerical evaluation is required, and no rounding should be applied.",
            "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, and objective.\n\n**Step 1: Extract Givens**\n- System: One-degree-of-freedom Fluid-Structure Interaction (FSI) system.\n- Components: Rigid, frictionless piston of mass $m_s$; straight, rigid tube of length $L$ and constant cross-sectional area $A$; linear spring of stiffness $k_s$.\n- Fluid: Incompressible, inviscid fluid of density $\\rho$ completely fills the tube.\n- Piston Motion: Axial displacement $x(t)$.\n- Force: Spring restoring force $F_s = -k_s x(t)$.\n- Flow Conditions: No leakage; \"idealize the fluid motion as a uniform plug flow so that the fluid velocity field is spatially uniform and equal to the piston velocity.\"\n- Numerical Method: Explicit central-difference time integration scheme.\n- Task 1: Derive the added mass, $m_a$.\n- Task 2: Derive the largest stable time step, $\\Delta t_{\\max}$, for the central-difference scheme.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is a standard, albeit simplified, model of FSI.\n- **Scientifically Grounded**: The concepts of added mass, Newton's second law, and stability analysis of numerical schemes are fundamental principles in physics and computational mechanics. The plug-flow model, although a simplification, is a valid and common idealization for one-dimensional incompressible flow.\n- **Well-Posed**: The problem provides all necessary parameters ($m_s$, $\\rho$, $A$, $L$, $k_s$) to derive the requested quantities ($m_a$, $\\Delta t_{\\max}$). It asks for a unique, deterministic result based on the provided model.\n- **Objective**: The problem is stated in precise, quantitative terms, free of subjective language. The instruction to \"idealize the fluid motion as a uniform plug flow\" resolves any ambiguity that might arise from other physical descriptions (e.g., \"no slip at the wall\" which is characteristic of viscous flow, but the fluid is specified as inviscid).\n\n**Step 3: Verdict and Action**\nThe problem is deemed **valid**. A full, reasoned solution will be provided.\n\n**Derivation of Added Mass ($m_a$)**\n\nThe added mass, $m_a$, is a concept used to account for the inertia of the fluid that is accelerated by the moving structure. It is defined such that the kinetic energy of the fluid, $T_{fluid}$, can be expressed in terms of the structure's velocity. The kinetic energy of the fluid is given by:\n$$\nT_{fluid} = \\frac{1}{2} \\int_V \\rho |\\vec{v}|^2 dV\n$$\nwhere $V$ is the volume of the fluid and $\\vec{v}$ is the fluid velocity field.\n\nThe problem states that the fluid motion is a uniform plug flow, meaning the velocity is spatially uniform throughout the fluid volume and equal to the piston's velocity, $\\dot{x}(t)$. Let the direction of motion be along the z-axis, so $\\vec{v} = \\dot{x}(t) \\hat{k}$. The magnitude of the velocity is $|\\vec{v}| = |\\dot{x}(t)|$.\nThe volume of the fluid in the tube is $V = A L$.\nSubstituting these into the kinetic energy integral:\n$$\nT_{fluid} = \\frac{1}{2} \\int_V \\rho (\\dot{x}(t))^2 dV\n$$\nSince $\\rho$ and $\\dot{x}(t)$ are constant with respect to the spatial integration, we can take them out of the integral:\n$$\nT_{fluid} = \\frac{1}{2} \\rho (\\dot{x}(t))^2 \\int_V dV = \\frac{1}{2} \\rho (\\dot{x}(t))^2 (AL)\n$$\nRe-arranging this expression:\n$$\nT_{fluid} = \\frac{1}{2} (\\rho A L) (\\dot{x}(t))^2\n$$\nBy definition, the added mass $m_a$ is the coefficient that relates the fluid's kinetic energy to the square of the piston's velocity in the form:\n$$\nT_{fluid} = \\frac{1}{2} m_a (\\dot{x}(t))^2\n$$\nComparing the two expressions for $T_{fluid}$, we can directly identify the added mass:\n$$\nm_a = \\rho A L\n$$\n\n**Derivation of the Largest Stable Time Step ($\\Delta t_{\\max}$)**\n\nFirst, we establish the equation of motion for the combined piston-fluid system. This is a monolithic system where the total inertia is the sum of the piston's structural mass, $m_s$, and the fluid's added mass, $m_a$. The total effective mass is:\n$$\nm_{eff} = m_s + m_a = m_s + \\rho A L\n$$\nThe only force acting on the system is the restoring force from the spring, $F_s = -k_s x(t)$. According to Newton's second law, $F = ma$:\n$$\nm_{eff} \\ddot{x}(t) + k_s x(t) = 0\n$$\nThis is the equation for an undamped simple harmonic oscillator. The natural angular frequency, $\\omega_n$, of the system is:\n$$\n\\omega_n = \\sqrt{\\frac{k_s}{m_{eff}}} = \\sqrt{\\frac{k_s}{m_s + \\rho A L}}\n$$\nNext, we apply the explicit central-difference scheme for time integration. The acceleration at time step $n$, $\\ddot{x}_n$, is approximated as:\n$$\n\\ddot{x}_n \\approx \\frac{x_{n+1} - 2x_n + x_{n-1}}{(\\Delta t)^2}\n$$\nwhere $x_n = x(t_n)$ and $\\Delta t$ is the time step.\nSubstituting this approximation into the equation of motion, $m_{eff} \\ddot{x}_n + k_s x_n = 0$:\n$$\nm_{eff} \\left( \\frac{x_{n+1} - 2x_n + x_{n-1}}{(\\Delta t)^2} \\right) + k_s x_n = 0\n$$\nTo find the update rule for $x_{n+1}$, we rearrange the equation:\n$$\nm_{eff} (x_{n+1} - 2x_n + x_{n-1}) = -k_s x_n (\\Delta t)^2\n$$\n$$\nx_{n+1} - 2x_n + x_{n-1} = -\\frac{k_s}{m_{eff}} (\\Delta t)^2 x_n\n$$\n$$\nx_{n+1} = \\left(2 - \\frac{k_s}{m_{eff}} (\\Delta t)^2 \\right) x_n - x_{n-1}\n$$\nSubstituting $\\omega_n^2 = k_s/m_{eff}$, the recurrence relation becomes:\n$$\nx_{n+1} = (2 - (\\omega_n \\Delta t)^2) x_n - x_{n-1}\n$$\nFor stability analysis, we assume a solution of the form $x_n = \\lambda^n$. Substituting this into the recurrence relation yields the characteristic equation for the amplification factor $\\lambda$:\n$$\n\\lambda^{n+1} = (2 - (\\omega_n \\Delta t)^2) \\lambda^n - \\lambda^{n-1}\n$$\nDividing by $\\lambda^{n-1}$ (assuming $\\lambda \\neq 0$):\n$$\n\\lambda^2 - (2 - (\\omega_n \\Delta t)^2) \\lambda + 1 = 0\n$$\nFor the solution to remain bounded (i.e., for the scheme to be stable), the magnitude of the roots $\\lambda$ must be less than or equal to one, $|\\lambda| \\le 1$. For an undamped system, the energy should be conserved, which corresponds to roots that are a complex-conjugate pair with magnitude equal to one, $|\\lambda| = 1$. This occurs when the discriminant of the quadratic characteristic equation is non-positive:\n$$\n\\text{Discriminant} = (2 - (\\omega_n \\Delta t)^2)^2 - 4(1)(1) \\le 0\n$$\n$$\n(2 - (\\omega_n \\Delta t)^2)^2 \\le 4\n$$\nTaking the square root of both sides:\n$$\n|2 - (\\omega_n \\Delta t)^2| \\le 2\n$$\nThis inequality is equivalent to:\n$$\n-2 \\le 2 - (\\omega_n \\Delta t)^2 \\le 2\n$$\nThe right-hand side of the inequality, $2 - (\\omega_n \\Delta t)^2 \\le 2$, simplifies to $-(\\omega_n \\Delta t)^2 \\le 0$, which is always true for real $\\omega_n$ and $\\Delta t$.\nThe left-hand side of the inequality gives the stability limit:\n$$\n-2 \\le 2 - (\\omega_n \\Delta t)^2\n$$\n$$\n(\\omega_n \\Delta t)^2 \\le 4\n$$\n$$\n\\omega_n \\Delta t \\le 2\n$$\nThe largest stable time step, $\\Delta t_{\\max}$, corresponds to the equality:\n$$\n\\Delta t_{\\max} = \\frac{2}{\\omega_n}\n$$\nSubstituting the expression for $\\omega_n$:\n$$\n\\Delta t_{\\max} = 2 \\sqrt{\\frac{m_{eff}}{k_s}}\n$$\nFinally, substituting the expression for the effective mass, $m_{eff} = m_s + \\rho A L$:\n$$\n\\Delta t_{\\max} = 2 \\sqrt{\\frac{m_s + \\rho A L}{k_s}}\n$$\nThis is the final expression for the largest stable time step.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\rho A L & 2 \\sqrt{\\frac{m_s + \\rho A L}{k_s}}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Analytical solutions provide crucial benchmarks, but in real-world engineering, physical quantities like added mass are often computed numerically from complex geometries. This practice bridges theory and application by tasking you with developing a numerical routine to compute the added mass of a sphere and analyze its convergence . By comparing your discrete results against the known analytical value, you will gain hands-on experience with numerical integration on a surface mesh and the critical process of verifying the accuracy and convergence rate of your implementation.",
            "id": "3288878",
            "problem": "Consider an incompressible, inviscid fluid with constant density $\\rho$ surrounding a rigid sphere of radius $R$. The sphere undergoes linear acceleration along the $z$-axis with prescribed translational acceleration $\\dot{U}$ (units: $\\mathrm{m/s^2}$). The fluid motion is irrotational and governed by a scalar velocity potential $\\phi(\\mathbf{x},t)$ satisfying the Laplace equation and the no-penetration boundary condition on the sphere. The fluid-structure interaction (FSI) problem is considered in the regime where the added-mass effect dominates the coupling, and the acceleration-induced pressure field determines the hydrodynamic force on the sphere.\n\nStarting from fundamental laws and definitions:\n- Newton's second law: $F = m a$.\n- Continuity for incompressible flow: $\\nabla \\cdot \\mathbf{v} = 0$.\n- Irrotational flow: $\\mathbf{v} = \\nabla \\phi$ and $\\nabla^2 \\phi = 0$ in the fluid domain exterior to the sphere.\n- Linearized unsteady Bernoulli equation: $p = -\\rho \\frac{\\partial \\phi}{\\partial t} + C(t)$ (take $C(t)$ such that the far-field pressure reference is zero).\n\nDerive the exact added mass $m_a$ of the sphere by imposing the boundary condition that the normal fluid velocity at the surface equals the normal component of the sphere’s velocity, and by integrating the pressure-induced traction over the sphere’s surface to obtain the net hydrodynamic force along the $z$-axis. The analytic added mass $m_a$ is defined by the relation $F_z = - m_a \\, \\dot{U}$.\n\nThen, define a discrete approximation $m_a(h)$ on a latitude–longitude mesh of the sphere surface using the midpoint rule in both polar angle $\\theta \\in [0,\\pi]$ and azimuthal angle $\\varphi \\in [0,2\\pi)$. Let $N_\\theta$ and $N_\\varphi$ denote the number of uniform subdivisions in $\\theta$ and $\\varphi$, respectively, with midpoints $\\theta_i = \\left(i + \\frac{1}{2}\\right)\\Delta\\theta$ and $\\varphi_j = \\left(j + \\frac{1}{2}\\right)\\Delta\\varphi$, where $\\Delta\\theta = \\frac{\\pi}{N_\\theta}$ and $\\Delta\\varphi = \\frac{2\\pi}{N_\\varphi}$. Use the midpoint rule to approximate the surface integral of the pressure traction projected onto the $z$-axis, and thereby define $m_a(h)$ such that $F_z^{\\text{disc}} = - m_a(h) \\, \\dot{U}$. The mesh parameter $h$ must be taken as $h = R \\max(\\Delta\\theta, \\Delta\\varphi)$ (units: $\\mathrm{m}$).\n\nYour program must:\n- Compute the analytic added mass $m_a$ in $\\mathrm{kg}$.\n- For each test case, compute the discrete added mass $m_a(h)$ in $\\mathrm{kg}$ using the midpoint rule on the specified latitude–longitude mesh.\n- Compute the absolute error $e(h) = |m_a(h) - m_a|$.\n- Compute the observed convergence rate between successive refinements as $p = \\frac{\\ln(e(h_1)/e(h_2))}{\\ln(h_1/h_2)}$.\n- Produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order: the discrete added masses for all test cases followed by the observed rates between successive cases.\n\nPhysical units:\n- Use $R$ in $\\mathrm{m}$, $\\rho$ in $\\mathrm{kg/m^3}$, $\\dot{U}$ in $\\mathrm{m/s^2}$, and report all added masses in $\\mathrm{kg}$.\n- Angles must be in radians.\n\nTest suite parameters:\n- Sphere radius: $R = 0.5 \\ \\mathrm{m}$.\n- Fluid density: $\\rho = 1000 \\ \\mathrm{kg/m^3}$.\n- Sphere acceleration: $\\dot{U} = 1.0 \\ \\mathrm{m/s^2}$.\n- Mesh refinements $(N_\\theta, N_\\varphi)$:\n  1. $(2,4)$\n  2. $(4,8)$\n  3. $(8,16)$\n  4. $(16,32)$\n  5. $(32,64)$\n  6. $(8,64)$\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[m_1,m_2,m_3,m_4,m_5,m_6,p_{12},p_{23},p_{34},p_{45},p_{56}]$), where each $m_i$ is the discrete added mass in $\\mathrm{kg}$ for the $i$-th test case, and $p_{ij}$ is the observed convergence rate between the $i$-th and $j$-th cases.",
            "solution": "The problem requires the derivation of the analytic and a discrete approximation of the added mass of an accelerating sphere in an ideal fluid, followed by a numerical computation of the discrete approximation and its convergence properties.\n\n### Step 1: Problem Validation\n\nThe problem statement is parsed and validated against the specified criteria.\n\n**Givens Extracted Verbatim:**\n- Fluid: incompressible, inviscid, constant density $\\rho$.\n- Structure: rigid sphere of radius $R$.\n- Motion: linear acceleration along the $z$-axis with prescribed translational acceleration $\\dot{U}$.\n- Flow Model: irrotational, $\\mathbf{v} = \\nabla \\phi$, $\\nabla^2 \\phi = 0$.\n- Boundary Condition: no-penetration on the sphere surface.\n- Pressure Equation: Linearized unsteady Bernoulli equation, $p = -\\rho \\frac{\\partial \\phi}{\\partial t} + C(t)$, with far-field pressure reference zero.\n- Added Mass Definition: $F_z = - m_a \\, \\dot{U}$.\n- Discretization Scheme: latitude–longitude mesh, midpoint rule for surface integration.\n- Mesh Parameters: $N_\\theta, N_\\varphi$ subdivisions in polar angle $\\theta \\in [0,\\pi]$ and azimuthal angle $\\varphi \\in [0,2\\pi)$; $\\Delta\\theta = \\frac{\\pi}{N_\\theta}$, $\\Delta\\varphi = \\frac{2\\pi}{N_\\varphi}$.\n- Midpoints: $\\theta_i = \\left(i + \\frac{1}{2}\\right)\\Delta\\theta$, $\\varphi_j = \\left(j + \\frac{1}{2}\\right)\\Delta\\varphi$.\n- Discrete Added Mass Definition: $F_z^{\\text{disc}} = - m_a(h) \\, \\dot{U}$.\n- Mesh Size Parameter: $h = R \\max(\\Delta\\theta, \\Delta\\varphi)$.\n- Error Definition: $e(h) = |m_a(h) - m_a|$.\n- Convergence Rate Definition: $p = \\frac{\\ln(e(h_1)/e(h_2))}{\\ln(h_1/h_2)}$.\n- Physical Constants: $R = 0.5 \\ \\mathrm{m}$, $\\rho = 1000 \\ \\mathrm{kg/m^3}$, $\\dot{U} = 1.0 \\ \\mathrm{m/s^2}$.\n- Test Cases $(N_\\theta, N_\\varphi)$: $(2,4)$, $(4,8)$, $(8,16)$, $(16,32)$, $(32,64)$, $(8,64)$.\n\n**Validation Verdict:**\nThe problem is **valid**. It is a well-posed, scientifically grounded problem from classical fluid dynamics (potential flow theory). All parameters, equations, and conditions are provided, forming a self-contained and consistent set of requirements. The numerical task is clearly defined and based on standard methods.\n\n### Step 2: Derivation of the Analytic Added Mass ($m_a$)\n\nThe fluid motion is described by a velocity potential $\\phi$ that must satisfy Laplace's equation, $\\nabla^2 \\phi = 0$, in the domain exterior to the sphere ($r > R$).\n\nThe boundary conditions are:\n1.  The fluid is quiescent at infinity: $\\nabla \\phi \\to 0$ as $r \\to \\infty$.\n2.  The normal component of the fluid velocity must match the normal component of the sphere's velocity at its surface ($r=R$). The sphere's velocity is $\\mathbf{U}(t) = U(t)\\hat{\\mathbf{z}}$. The outward normal from the sphere is $\\hat{\\mathbf{n}} = \\hat{\\mathbf{r}}$ in spherical coordinates.\n    $$ \\frac{\\partial \\phi}{\\partial r} \\bigg|_{r=R} = \\mathbf{U}(t) \\cdot \\hat{\\mathbf{r}} = (U(t)\\hat{\\mathbf{z}}) \\cdot \\hat{\\mathbf{r}} $$\n    In spherical coordinates, $\\hat{\\mathbf{z}} = \\cos\\theta \\hat{\\mathbf{r}} - \\sin\\theta \\hat{\\mathbf{\\theta}}$, so $\\hat{\\mathbf{z}} \\cdot \\hat{\\mathbf{r}} = \\cos\\theta$. The boundary condition at the surface becomes:\n    $$ \\frac{\\partial \\phi}{\\partial r} \\bigg|_{r=R} = U(t) \\cos\\theta $$\nThe general solution to Laplace's equation that is regular at infinity and has a $\\cos\\theta$ dependence (proportional to the Legendre polynomial $P_1(\\cos\\theta)$) is of the form $\\phi(r, \\theta, t) = A(t) r^{-2} \\cos\\theta$. Applying the surface boundary condition to determine $A(t)$:\n$$ \\frac{\\partial}{\\partial r} \\left( A(t) r^{-2} \\cos\\theta \\right) \\bigg|_{r=R} = -2 A(t) R^{-3} \\cos\\theta = U(t) \\cos\\theta $$\nThis yields $A(t) = -\\frac{1}{2}U(t)R^3$. The velocity potential is thus:\n$$ \\phi(r, \\theta, t) = -\\frac{U(t)R^3}{2r^2}\\cos\\theta $$\nThe pressure field is given by the linearized unsteady Bernoulli equation, $p = -\\rho \\frac{\\partial \\phi}{\\partial t}$. We are interested in the force due to acceleration, $\\dot{U} = dU/dt$.\n$$ \\frac{\\partial\\phi}{\\partial t} = -\\frac{\\dot{U}(t)R^3}{2r^2}\\cos\\theta $$\nOn the sphere's surface ($r=R$), the pressure is:\n$$ p_S(\\theta,t) = p(R,\\theta,t) = -\\rho \\left(-\\frac{\\dot{U}(t)R^3}{2R^2}\\cos\\theta\\right) = \\frac{1}{2}\\rho \\dot{U} R \\cos\\theta $$\nThe hydrodynamic force on the sphere is the integral of the pressure traction, $d\\mathbf{F} = -p_S \\hat{\\mathbf{n}} dS = -p_S \\hat{\\mathbf{r}} dS$, over the entire surface $S$. We need the component along the $z$-axis, $F_z$:\n$$ F_z = \\int_S d\\mathbf{F} \\cdot \\hat{\\mathbf{z}} = \\int_S (-p_S \\hat{\\mathbf{r}}) \\cdot \\hat{\\mathbf{z}} \\, dS = \\int_S -p_S(\\hat{\\mathbf{r}} \\cdot \\hat{\\mathbf{z}}) \\, dS $$\nWith $\\hat{\\mathbf{r}} \\cdot \\hat{\\mathbf{z}} = \\cos\\theta$ and the area element $dS = R^2 \\sin\\theta \\, d\\theta \\, d\\varphi$:\n$$ F_z = \\int_{0}^{2\\pi} \\int_{0}^{\\pi} -\\left(\\frac{1}{2}\\rho \\dot{U} R \\cos\\theta\\right)(\\cos\\theta)(R^2 \\sin\\theta \\, d\\theta \\, d\\varphi) $$\n$$ F_z = -\\frac{1}{2}\\rho \\dot{U} R^3 \\int_{0}^{2\\pi}d\\varphi \\int_{0}^{\\pi} \\cos^2\\theta \\sin\\theta \\,d\\theta $$\nThe integrals evaluate to $\\int_{0}^{2\\pi}d\\varphi = 2\\pi$ and $\\int_{0}^{\\pi} \\cos^2\\theta \\sin\\theta \\,d\\theta = \\left[-\\frac{\\cos^3\\theta}{3}\\right]_0^\\pi = \\frac{2}{3}$.\nSubstituting these results gives the total force:\n$$ F_z = -\\frac{1}{2}\\rho \\dot{U} R^3 (2\\pi) \\left(\\frac{2}{3}\\right) = -\\left(\\frac{2}{3}\\pi\\rho R^3\\right) \\dot{U} $$\nFrom the definition $F_z = -m_a \\dot{U}$, the analytic added mass is:\n$$ m_a = \\frac{2}{3}\\pi\\rho R^3 $$\n\n### Step 3: Derivation of the Discrete Added Mass ($m_a(h)$)\n\nThe discrete added mass is derived by approximating the integral for $F_z$ using the midpoint rule on the specified latitude-longitude grid. The integral is:\n$$ F_z = \\int_0^{2\\pi} \\int_0^\\pi g(\\theta, \\varphi) \\, d\\theta \\, d\\varphi, \\quad \\text{where} \\quad g(\\theta, \\varphi) = -\\frac{1}{2}\\rho \\dot{U} R^3 \\cos^2\\theta \\sin\\theta $$\nThe midpoint rule approximates this integral as a sum:\n$$ F_z^{\\text{disc}} = \\sum_{j=0}^{N_\\varphi-1} \\sum_{i=0}^{N_\\theta-1} g(\\theta_i, \\varphi_j) \\Delta\\theta \\Delta\\varphi $$\nwhere $\\theta_i = (i+1/2)\\Delta\\theta$ and $\\varphi_j = (j+1/2)\\Delta\\varphi$. Since $g(\\theta, \\varphi)$ is independent of $\\varphi$, the sum over $j$ simplifies:\n$$ \\sum_{j=0}^{N_\\varphi-1} g(\\theta_i, \\varphi_j) = N_\\varphi \\, g(\\theta_i) $$\nSubstituting this into the sum for $F_z^{\\text{disc}}$:\n$$ F_z^{\\text{disc}} = \\Delta\\theta \\Delta\\varphi N_\\varphi \\sum_{i=0}^{N_\\theta-1} \\left(-\\frac{1}{2}\\rho \\dot{U} R^3 \\cos^2\\theta_i \\sin\\theta_i\\right) $$\nUsing $\\Delta\\varphi = 2\\pi/N_\\varphi$, the term $\\Delta\\varphi N_\\varphi$ becomes $2\\pi$.\n$$ F_z^{\\text{disc}} = \\Delta\\theta (2\\pi) \\left(-\\frac{1}{2}\\rho \\dot{U} R^3\\right) \\sum_{i=0}^{N_\\theta-1} \\cos^2\\theta_i \\sin\\theta_i $$\n$$ F_z^{\\text{disc}} = - \\left( \\pi\\rho R^3 \\Delta\\theta \\sum_{i=0}^{N_\\theta-1} \\cos^2\\theta_i \\sin\\theta_i \\right) \\dot{U} $$\nFrom the definition $F_z^{\\text{disc}} = -m_a(h)\\dot{U}$, the discrete added mass is:\n$$ m_a(h) = \\pi\\rho R^3 \\Delta\\theta \\sum_{i=0}^{N_\\theta-1} \\cos^2\\left(\\left(i+\\frac{1}{2}\\right)\\Delta\\theta\\right) \\sin\\left(\\left(i+\\frac{1}{2}\\right)\\Delta\\theta\\right) $$\nwith $\\Delta\\theta = \\pi/N_\\theta$. Note that $m_a(h)$ depends only on $N_\\theta$, not $N_\\varphi$.\n\n### Step 4: Numerical Calculation and Convergence Analysis\n\nThe provided test cases are used to compute $m_a(h)$ for different mesh resolutions.\n- The analytic added mass $m_a$ is calculated using $R = 0.5 \\ \\mathrm{m}$ and $\\rho = 1000 \\ \\mathrm{kg/m^3}$:\n  $m_a = \\frac{2}{3}\\pi (1000) (0.5)^3 = \\frac{250}{3}\\pi \\approx 261.79938779 \\ \\mathrm{kg}$.\n- For each test case $(N_\\theta, N_\\varphi)$, the discrete added mass $m_a(h)$ is calculated using the formula derived in Step 3.\n- The mesh size $h = R \\max(\\pi/N_\\theta, 2\\pi/N_\\varphi)$ is determined for each case.\n- The absolute error $e(h) = |m_a(h) - m_a|$ is computed.\n- The observed convergence rate $p$ between successive refinements $(h_1, e_1)$ and $(h_2, e_2)$ is calculated as $p = \\ln(e_1/e_2) / \\ln(h_1/h_2)$. For the midpoint rule, the theoretical error is proportional to $h^2$, so the expected rate is $p=2$.\n\nThe Python program below implements these calculations, computes the required quantities for all test cases, and formats the output as specified.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the analytic and discrete added mass of a sphere,\n    and analyzes the convergence of the discrete approximation.\n    \"\"\"\n\n    # Physical parameters\n    R = 0.5  # Sphere radius in meters\n    rho = 1000.0  # Fluid density in kg/m^3\n\n    # Test suite parameters: list of (N_theta, N_phi) tuples\n    test_cases = [\n        (2, 4),\n        (4, 8),\n        (8, 16),\n        (16, 32),\n        (32, 64),\n        (8, 64),\n    ]\n\n    # --- Analytic Solution ---\n    # The analytic added mass for a sphere is m_a = (2/3) * pi * rho * R^3.\n    # This is half the mass of the displaced fluid.\n    m_a_analytic = (2.0 / 3.0) * np.pi * rho * R**3\n\n    # --- Numerical Computation ---\n    discrete_masses = []\n    mesh_sizes = []\n\n    for N_theta, N_phi in test_cases:\n        # Calculate mesh spacings\n        delta_theta = np.pi / N_theta\n        \n        # The discrete added mass formula derived from the midpoint rule\n        # only depends on the integration over theta.\n        # m_a(h) = pi * rho * R^3 * sum_{i=0}^{N_theta-1} cos^2(theta_i)sin(theta_i) * delta_theta\n        \n        # Create an array of theta midpoint values\n        i = np.arange(N_theta)\n        theta_mid = (i + 0.5) * delta_theta\n        \n        # Calculate the sum part of the formula\n        integrand_values = (np.cos(theta_mid)**2) * np.sin(theta_mid)\n        integral_approx = np.sum(integrand_values) * delta_theta\n        \n        # Calculate the discrete added mass\n        m_a_h = np.pi * rho * R**3 * integral_approx\n        discrete_masses.append(m_a_h)\n        \n        # Calculate the mesh parameter h\n        delta_phi = 2.0 * np.pi / N_phi\n        h = R * max(delta_theta, delta_phi)\n        mesh_sizes.append(h)\n\n    # --- Error and Convergence Analysis ---\n    errors = np.abs(np.array(discrete_masses) - m_a_analytic)\n    \n    rates = []\n    # Calculate observed convergence rate between successive cases\n    for i in range(len(test_cases) - 1):\n        h1 = mesh_sizes[i]\n        h2 = mesh_sizes[i+1]\n        e1 = errors[i]\n        e2 = errors[i+1]\n        \n        # The rate p is defined as p = log(e1/e2) / log(h1/h2)\n        # Add a small epsilon to the denominator to avoid division by zero\n        # if h1 and h2 happen to be identical (though not in these test cases).\n        rate = np.log(e1 / e2) / np.log(h1 / h2 + 1e-18)\n        rates.append(rate)\n\n    # --- Format and Print Output ---\n    # Combine results into a single list\n    all_results = discrete_masses + rates\n    \n    # Format the list into the required string format\n    output_str = f\"[{','.join(f'{x:.8f}' for x in all_results)}]\"\n    \n    print(output_str)\n\nsolve()\n```"
        }
    ]
}