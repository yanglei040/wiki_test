{
    "hands_on_practices": [
        {
            "introduction": "In any moving mesh simulation, we must define a single, effective velocity for each control volume face, even as its vertices move independently. This practice establishes the fundamental definition of face-normal velocity, $w_f$, for a simple triangular face. By requiring that the volumetric flux from this effective velocity matches the true volume swept by the deforming face, you will derive the unique and intuitive formula that forms a cornerstone of Arbitrary Lagrangian-Eulerian (ALE) methods .",
            "id": "3344771",
            "problem": "Consider a three-dimensional Arbitrary Lagrangian-Eulerian (ALE) discretization of a moving control volume bounded by planar faces. Let one such face be a triangle with vertices at positions $\\boldsymbol{x}_{1}(t)$, $\\boldsymbol{x}_{2}(t)$, and $\\boldsymbol{x}_{3}(t)$ that remain non-collinear for all $t$ in a given interval, so the face is planar at each instant. Let the vertex velocities $\\boldsymbol{v}_{i}(t) = \\frac{d\\boldsymbol{x}_{i}}{dt}$ be linear functions of time over this interval. Define the instantaneous unit normal $\\boldsymbol{n}_{f}(t)$ and area $A_{f}(t)$ of the triangular face by the oriented area vector $\\boldsymbol{S}_{f}(t) = \\frac{1}{2}\\left(\\boldsymbol{x}_{2}(t)-\\boldsymbol{x}_{1}(t)\\right)\\times\\left(\\boldsymbol{x}_{3}(t)-\\boldsymbol{x}_{1}(t)\\right)$ with $\\boldsymbol{n}_{f}(t) = \\boldsymbol{S}_{f}(t)/\\|\\boldsymbol{S}_{f}(t)\\|$ and $A_{f}(t) = \\|\\boldsymbol{S}_{f}(t)\\|$. Assume the grid (mesh) velocity on the face is distributed linearly in space using the standard barycentric shape functions of the triangle, that is, for any $\\boldsymbol{x}$ on the face at time $t$,\n$$\n\\boldsymbol{v}_{g}(\\boldsymbol{x},t) = N_{1}(\\boldsymbol{x},t)\\,\\boldsymbol{v}_{1}(t) + N_{2}(\\boldsymbol{x},t)\\,\\boldsymbol{v}_{2}(t) + N_{3}(\\boldsymbol{x},t)\\,\\boldsymbol{v}_{3}(t),\n$$\nwhere $N_{i}(\\boldsymbol{x},t)$ are the linear shape functions satisfying $N_{i}(\\boldsymbol{x}_{j}(t),t) = \\delta_{ij}$ and $N_{1}+N_{2}+N_{3}=1$ on the face at time $t$.\n\nStarting from the Reynolds transport theorem and the geometric conservation law, derive an exact scalar face-normal velocity $w_{f}(t)$ such that the instantaneous volumetric rate contributed by the moving face equals the surface integral of the normal component of the grid velocity,\n$$\nA_{f}(t)\\,w_{f}(t) = \\int_{A_{f}(t)} \\boldsymbol{v}_{g}(\\boldsymbol{x},t)\\cdot \\boldsymbol{n}_{f}(t)\\, dA,\n$$\nfor all times in the interval. Then prove that, under the stated assumptions of linear-in-time vertex motion and linear-in-space interpolation on the face, this $w_{f}(t)$ is unique among all scalar mappings from $\\{\\boldsymbol{v}_{1}(t),\\boldsymbol{v}_{2}(t),\\boldsymbol{v}_{3}(t)\\}$ to a face-normal velocity that reproduce the same instantaneous swept volume for every possible choice of vertex velocities.\n\nExpress your final answer as a closed-form analytic expression for $w_{f}(t)$ in terms of $\\boldsymbol{n}_{f}(t)$ and $\\boldsymbol{v}_{i}(t)$, $i=1,2,3$.",
            "solution": "The problem is well-posed and scientifically grounded within the field of computational fluid dynamics, specifically concerning the Arbitrary Lagrangian-Eulerian (ALE) formulation and the geometric conservation law (GCL). The assumptions provided are standard for developing and analyzing second-order accurate numerical schemes on moving meshes. We can therefore proceed with the derivation and proof.\n\nThe problem is divided into two parts: first, to derive an expression for the scalar face-normal velocity $w_f(t)$, and second, to prove the uniqueness of this expression under the given conditions.\n\n**Part 1: Derivation of the Face-Normal Velocity $w_f(t)$**\n\nWe begin with the defining equation provided in the problem statement relating the scalar face velocity $w_f(t)$ to the grid velocity field $\\boldsymbol{v}_g(\\boldsymbol{x}, t)$ on the face:\n$$\nA_{f}(t)\\,w_{f}(t) = \\int_{A_{f}(t)} \\boldsymbol{v}_{g}(\\boldsymbol{x},t)\\cdot \\boldsymbol{n}_{f}(t)\\, dA\n$$\nHere, $A_f(t)$ is the area of the triangular face, and $\\boldsymbol{n}_f(t)$ is its unit normal vector.\n\nThe grid velocity $\\boldsymbol{v}_g$ at any point $\\boldsymbol{x}$ on the face is given as a linear interpolation of the vertex velocities $\\boldsymbol{v}_i(t)$ using barycentric shape functions $N_i(\\boldsymbol{x},t)$:\n$$\n\\boldsymbol{v}_{g}(\\boldsymbol{x},t) = \\sum_{i=1}^{3} N_{i}(\\boldsymbol{x},t)\\,\\boldsymbol{v}_{i}(t)\n$$\nSubstituting this expression for $\\boldsymbol{v}_g(\\boldsymbol{x}, t)$ into the integral equation gives:\n$$\nA_{f}(t)\\,w_{f}(t) = \\int_{A_{f}(t)} \\left( \\sum_{i=1}^{3} N_{i}(\\boldsymbol{x},t)\\,\\boldsymbol{v}_{i}(t) \\right) \\cdot \\boldsymbol{n}_{f}(t)\\, dA\n$$\nThe vertex velocities $\\boldsymbol{v}_i(t)$ and the face normal vector $\\boldsymbol{n}_f(t)$ are functions of time $t$, but they are constant with respect to the spatial integration variable $\\boldsymbol{x}$ over the face $A_f(t)$ at any given instant. Therefore, we can move them outside the integral. By linearity of the integral and the dot product:\n$$\nA_{f}(t)\\,w_{f}(t) = \\sum_{i=1}^{3} \\left( \\int_{A_{f}(t)} N_{i}(\\boldsymbol{x},t) \\, dA \\right) (\\boldsymbol{v}_{i}(t) \\cdot \\boldsymbol{n}_{f}(t))\n$$\nThe next step is to evaluate the integral of the shape functions over the area of the triangle. For a linear triangular element, the shape function $N_i$ is identical to the barycentric coordinate corresponding to vertex $i$. A standard result in finite element theory is that the integral of the $i$-th barycentric coordinate over the area of a triangle is one-third of the total area. That is:\n$$\n\\int_{A_{f}(t)} N_{i}(\\boldsymbol{x},t) \\, dA = \\frac{A_{f}(t)}{3}\n$$\nfor each $i \\in \\{1, 2, 3\\}$. This can be understood by noting that the average value of the linear function $N_i$ over the triangle is its value at the centroid, which is $1/3$.\n\nSubstituting this result back into our equation for $w_f(t)$:\n$$\nA_{f}(t)\\,w_{f}(t) = \\sum_{i=1}^{3} \\left( \\frac{A_{f}(t)}{3} \\right) (\\boldsymbol{v}_{i}(t) \\cdot \\boldsymbol{n}_{f}(t))\n$$\nThe problem states that the vertices remain non-collinear, which ensures that the face area $A_f(t)$ is strictly positive. We can therefore divide both sides by $A_f(t)$:\n$$\nw_{f}(t) = \\sum_{i=1}^{3} \\frac{1}{3} (\\boldsymbol{v}_{i}(t) \\cdot \\boldsymbol{n}_{f}(t))\n$$\nThis can be written more compactly by factoring out the constant and the normal vector:\n$$\nw_{f}(t) = \\frac{1}{3} \\left( \\boldsymbol{v}_{1}(t) + \\boldsymbol{v}_{2}(t) + \\boldsymbol{v}_{3}(t) \\right) \\cdot \\boldsymbol{n}_{f}(t)\n$$\nThis expression defines the scalar face-normal velocity as the component of the average velocity of the face's vertices in the direction normal to the face. Note that the assumption of linear-in-time vertex motion was not required for this derivation of the instantaneous velocity.\n\n**Part 2: Uniqueness Proof**\n\nWe now prove that the derived expression for $w_f(t)$ is unique among all possible scalar mappings from the set of vertex velocities $\\{\\boldsymbol{v}_1(t), \\boldsymbol{v}_2(t), \\boldsymbol{v}_3(t)\\}$ to a face-normal velocity, under the condition that the mapping must reproduce the correct instantaneous swept volume rate for *every* possible choice of vertex velocities.\n\nLet the scalar mapping be denoted by $\\mathcal{W}$, such that $w_f(t) = \\mathcal{W}(\\boldsymbol{v}_1(t), \\boldsymbol{v}_2(t), \\boldsymbol{v}_3(t))$. The instantaneous volumetric rate swept by the face is given by the kinematic definition, which is the surface integral of the normal component of the velocity field over that surface. In the context of an ALE method with the specified grid velocity interpolation, this rate is:\n$$\n\\dot{V}_f(t) = \\int_{A_{f}(t)} \\boldsymbol{v}_{g}(\\boldsymbol{x},t)\\cdot \\boldsymbol{n}_{f}(t)\\, dA\n$$\nThe problem requires that the scalar velocity $w_f(t)$ generated by the mapping $\\mathcal{W}$ reproduces this same rate:\n$$\nA_f(t) w_f(t) = \\dot{V}_f(t)\n$$\nTherefore, the condition on the mapping $\\mathcal{W}$ is:\n$$\nA_f(t) \\mathcal{W}(\\boldsymbol{v}_1(t), \\boldsymbol{v}_2(t), \\boldsymbol{v}_3(t)) = \\int_{A_{f}(t)} \\boldsymbol{v}_{g}(\\boldsymbol{x},t)\\cdot \\boldsymbol{n}_{f}(t)\\, dA\n$$\nAs established in Part 1, the integral on the right-hand side evaluates to:\n$$\n\\int_{A_{f}(t)} \\boldsymbol{v}_{g}(\\boldsymbol{x},t)\\cdot \\boldsymbol{n}_{f}(t)\\, dA = \\frac{A_f(t)}{3} \\left( \\boldsymbol{v}_{1}(t) + \\boldsymbol{v}_{2}(t) + \\boldsymbol{v}_{3}(t) \\right) \\cdot \\boldsymbol{n}_{f}(t)\n$$\nSubstituting this into the condition for $\\mathcal{W}$:\n$$\nA_f(t) \\mathcal{W}(\\boldsymbol{v}_1(t), \\boldsymbol{v}_2(t), \\boldsymbol{v}_3(t)) = \\frac{A_f(t)}{3} \\left( \\boldsymbol{v}_{1}(t) + \\boldsymbol{v}_{2}(t) + \\boldsymbol{v}_{3}(t) \\right) \\cdot \\boldsymbol{n}_{f}(t)\n$$\nSince $A_f(t) \\neq 0$, we can divide by it to obtain the explicit functional form that $\\mathcal{W}$ must take:\n$$\n\\mathcal{W}(\\boldsymbol{v}_1(t), \\boldsymbol{v}_2(t), \\boldsymbol{v}_3(t)) = \\frac{1}{3} \\left( \\boldsymbol{v}_{1}(t) + \\boldsymbol{v}_{2}(t) + \\boldsymbol{v}_{3}(t) \\right) \\cdot \\boldsymbol{n}_{f}(t)\n$$\nThis equation specifies the exact value that the mapping $\\mathcal{W}$ must produce for any given input set of velocities $\\{\\boldsymbol{v}_1, \\boldsymbol{v}_2, \\boldsymbol{v}_3\\}$. Since the condition must hold for *all* possible choices of these velocities, this functional form is uniquely determined. Any other mapping $\\mathcal{W}'$ that yielded a different value for any set of velocities would violate the fundamental requirement of reproducing the correct instantaneous swept volume rate as defined by the integral of the linearly interpolated grid velocity.\n\nTherefore, the derived expression for $w_f(t)$ is not just a valid choice, but the unique one consistent with the stated premises.",
            "answer": "$$\n\\boxed{\\frac{1}{3} \\boldsymbol{n}_{f}(t) \\cdot \\left(\\boldsymbol{v}_{1}(t) + \\boldsymbol{v}_{2}(t) + \\boldsymbol{v}_{3}(t)\\right)}\n$$"
        },
        {
            "introduction": "The theoretical principles of mesh motion have direct, practical consequences on the stability of a simulation. Unconstrained mesh deformation, particularly near sharp geometric features, can cause cells to tangle and invert, leading to non-physical negative volumes and solver failure. This exercise translates the abstract kinematics of mesh velocity into a concrete stability analysis, challenging you to derive the maximum allowable time step, $\\Delta t_{\\max}$, to prevent cell collapse in a common corner-flow scenario .",
            "id": "3344805",
            "problem": "A two-dimensional wedge domain with interior angle $\\phi$ is discretized by a body-fitted mesh for an Arbitrary Lagrangian–Eulerian (ALE) formulation of the incompressible Navier–Stokes equations. The wedge consists of two straight walls meeting at a sharp corner at the origin. Each wall is a ray parameterized by the polar angle $\\theta=\\pm \\phi/2$ and radius $r \\ge 0$. The walls undergo a prescribed rigid boundary motion that is purely normal to each wall, directed into the wedge interior, with constant speed $V_{n}>0$ and no tangential component.\n\nYou will impose mesh motion on the walls compatible with this boundary motion, for two physical boundary types:\n\n- No-slip wall: the fluid velocity equals the wall velocity at the boundary.\n- Slip (no-penetration) wall: the normal component of the fluid velocity equals the wall’s normal velocity, but the tangential component is unconstrained by this kinematic condition.\n\nUsing only first principles of kinematics and geometric conservation, proceed as follows.\n\n1) Starting from the ALE mapping $\\boldsymbol{x}=\\boldsymbol{\\chi}(\\boldsymbol{X},t)$ and the definition of the mesh velocity $\\boldsymbol{w}=\\frac{\\partial \\boldsymbol{\\chi}}{\\partial t}$, derive the kinematic compatibility conditions for the mesh velocity on a moving wall for each boundary type. Do not assume any specific mesh solver; express the wall constraints entirely in terms of the prescribed wall velocity $\\boldsymbol{U}_{w}$ and the unit normal $\\boldsymbol{n}$ and tangent $\\boldsymbol{t}$.\n\n2) Consider the lowest adjacent triangular cell near the corner formed by three mesh nodes: the corner node at the origin and two wall-adjacent nodes located at the same fixed radius $r_{0}$ on the two walls ($\\theta=\\pm \\phi/2$), connected by a straight interior edge (the “base”) between these two wall nodes. Assume an explicit forward Euler mesh update $\\boldsymbol{x}^{n+1}=\\boldsymbol{x}^{n}+\\Delta t\\,\\boldsymbol{w}^{n}$ and that the two wall-adjacent nodes move exactly with the wall velocity dictated by the constraints from part 1). Using only kinematics and the geometric conservation principle (namely, that the rate of change of a control volume equals the boundary integral of the mesh normal velocity), derive a closed-form expression for the largest time step $\\Delta t_{\\max}$ that guarantees this triangular cell does not invert within one Euler update, i.e., that its base segment does not collapse to negative length. Your expression must be written in terms of $r_{0}$, $\\phi$, and $V_{n}$.\n\n3) Evaluate your expression numerically for $r_{0}=1.00\\,\\mathrm{cm}$, $\\phi=20\\,\\mathrm{degrees}$, and $V_{n}=0.50\\,\\mathrm{m/s}$. Round your final numerical answer for $\\Delta t_{\\max}$ to four significant figures. Express the time in seconds. All angles used within trigonometric functions must be in radians.",
            "solution": "The problem is assessed to be valid. It is scientifically grounded in the principles of computational fluid dynamics and mesh kinematics, is mathematically well-posed, and contains all necessary information for a unique solution.\n\n\\subsection*{Part 1: Kinematic Compatibility Conditions}\nLet $\\boldsymbol{x}$ be the position of a point on a moving wall, and let $\\boldsymbol{U}_w$ be the velocity of that point on the wall. The problem states this motion is purely normal to the wall, directed into the wedge interior, with a constant speed $V_n > 0$. Thus, we can write the wall velocity as $\\boldsymbol{U}_w = V_n \\boldsymbol{n}$, where $\\boldsymbol{n}$ is the unit normal vector to the wall pointing into the fluid domain.\n\nThe mesh velocity, denoted by $\\boldsymbol{w}$, is defined as the time rate of change of the position of a mesh node, $\\boldsymbol{w} = \\frac{\\partial \\boldsymbol{\\chi}}{\\partial t}$, where $\\boldsymbol{x} = \\boldsymbol{\\chi}(\\boldsymbol{X}, t)$ is the ALE mapping from the reference coordinate $\\boldsymbol{X}$ to the physical coordinate $\\boldsymbol{x}$. For the mesh to conform to the moving boundary, the mesh nodes on the boundary must move in a way that is compatible with the boundary's motion. The required compatibility conditions depend on the physical boundary condition imposed on the fluid.\n\n\\textbf{No-slip wall:}\nFor a no-slip wall, the fluid velocity $\\boldsymbol{u}$ at the wall must be equal to the wall velocity $\\boldsymbol{U}_w$.\n$$ \\boldsymbol{u}|_{\\text{wall}} = \\boldsymbol{U}_w $$\nIn an ALE framework, it is common to enforce a Lagrangian-like behavior for the mesh nodes on such a boundary, meaning the mesh velocity is set equal to the local fluid velocity. This ensures that mesh nodes on the boundary track the same fluid particles.\n$$ \\boldsymbol{w}|_{\\text{wall}} = \\boldsymbol{u}|_{\\text{wall}} $$\nCombining these conditions gives the kinematic constraint for the mesh velocity on a no-slip wall:\n$$ \\boldsymbol{w} = \\boldsymbol{U}_w $$\nSubstituting the given wall velocity, the condition is $\\boldsymbol{w} = V_n \\boldsymbol{n}$. This is a full vector constraint, determining both the normal and tangential components of the mesh velocity.\n\n\\textbf{Slip (no-penetration) wall:}\nFor a slip wall, the constraint is that the normal component of the relative velocity between the fluid and the wall is zero. The fluid is free to move tangentially along the wall. The condition is:\n$$ (\\boldsymbol{u} - \\boldsymbol{U}_w) \\cdot \\boldsymbol{n} = 0 \\implies \\boldsymbol{u} \\cdot \\boldsymbol{n} = \\boldsymbol{U}_w \\cdot \\boldsymbol{n} $$\nFrom a purely geometric perspective, for the mesh to remain on the boundary, the normal component of the mesh velocity must match the normal component of the wall's velocity. The tangential motion of the mesh nodes along the boundary is unconstrained by this kinematic requirement and can be specified by the mesh motion solver, typically to optimize mesh quality.\nThe kinematic compatibility condition is therefore only on the normal component of the mesh velocity:\n$$ \\boldsymbol{w} \\cdot \\boldsymbol{n} = \\boldsymbol{U}_w \\cdot \\boldsymbol{n} $$\nSubstituting the given wall velocity, this is $\\boldsymbol{w} \\cdot \\boldsymbol{n} = (V_n \\boldsymbol{n}) \\cdot \\boldsymbol{n} = V_n$. The tangential component, $\\boldsymbol{w} \\cdot \\boldsymbol{t}$, where $\\boldsymbol{t}$ is the unit tangent vector, remains arbitrary.\n\n\\subsection*{Part 2: Derivation of the Maximum Time Step $\\Delta t_{\\max}$}\nWe are asked to consider a specific scenario where wall-adjacent nodes \"move exactly with the wall velocity dictated by the constraints from part 1)\". The physical wall motion is prescribed as being purely normal with no tangential component. For the no-slip case, $\\boldsymbol{w} = \\boldsymbol{U}_w = V_n \\boldsymbol{n}$. For the slip case, while $\\boldsymbol{w} \\cdot \\boldsymbol{t}$ is kinematically free, the most direct interpretation consistent with the prescribed physical motion (which has zero tangential velocity) is to set $\\boldsymbol{w} \\cdot \\boldsymbol{t} = 0$. Thus, for the purpose of this problem, the velocity of the wall nodes is taken as $\\boldsymbol{w} = V_n \\boldsymbol{n}$ for both boundary conditions.\n\nLet's establish a Cartesian coordinate system with the origin at the wedge corner and the $x$-axis bisecting the wedge angle $\\phi$.\nThe three nodes of the triangular cell at time $t^n$ are:\n$P_0$: the corner node, $\\boldsymbol{x}_0^n = (0, 0)$.\n$P_1$: the upper-wall node, at radius $r_0$ and angle $\\theta = \\phi/2$. $\\boldsymbol{x}_1^n = (r_0 \\cos(\\phi/2), r_0 \\sin(\\phi/2))$.\n$P_2$: the lower-wall node, at radius $r_0$ and angle $\\theta = -\\phi/2$. $\\boldsymbol{x}_2^n = (r_0 \\cos(\\phi/2), -r_0 \\sin(\\phi/2))$.\n\nThe corner node $P_0$ is stationary, so its mesh velocity is $\\boldsymbol{w}_0 = \\boldsymbol{0}$.\nFor the upper wall ($\\theta=\\phi/2$), the outward-pointing tangent vector is $(\\cos(\\phi/2), \\sin(\\phi/2))$. The inward-pointing unit normal vector is $\\boldsymbol{n}_1 = (\\sin(\\phi/2), -\\cos(\\phi/2))$. The mesh velocity of $P_1$ is $\\boldsymbol{w}_1 = V_n \\boldsymbol{n}_1 = V_n (\\sin(\\phi/2), -\\cos(\\phi/2))$.\nFor the lower wall ($\\theta=-\\phi/2$), the outward-pointing tangent is $(\\cos(-\\phi/2), \\sin(-\\phi/2))$. The inward-pointing unit normal vector is $\\boldsymbol{n}_2 = (\\sin(\\phi/2), \\cos(\\phi/2))$. The mesh velocity of $P_2$ is $\\boldsymbol{w}_2 = V_n \\boldsymbol{n}_2 = V_n (\\sin(\\phi/2), \\cos(\\phi/2))$.\n\nUsing the explicit forward Euler update, the node positions at time $t^{n+1} = t^n + \\Delta t$ are:\n$\\boldsymbol{x}_0^{n+1} = \\boldsymbol{x}_0^n = (0, 0)$.\n$\\boldsymbol{x}_1^{n+1} = \\boldsymbol{x}_1^n + \\Delta t \\, \\boldsymbol{w}_1 = (r_0 \\cos(\\phi/2) + \\Delta t V_n \\sin(\\phi/2), r_0 \\sin(\\phi/2) - \\Delta t V_n \\cos(\\phi/2))$.\n$\\boldsymbol{x}_2^{n+1} = \\boldsymbol{x}_2^n + \\Delta t \\, \\boldsymbol{w}_2 = (r_0 \\cos(\\phi/2) + \\Delta t V_n \\sin(\\phi/2), -r_0 \\sin(\\phi/2) + \\Delta t V_n \\cos(\\phi/2))$.\n\nCell inversion occurs when the cell's area becomes zero or negative. A convenient way to check this is to examine the length of the triangle's base, which is the interior edge connecting $P_1$ and $P_2$.\nThe vector representing the base at time $t^{n+1}$ is $\\vec{P_2P_1}^{n+1} = \\boldsymbol{x}_1^{n+1} - \\boldsymbol{x}_2^{n+1}$.\nThe $x$-components of $\\boldsymbol{x}_1^{n+1}$ and $\\boldsymbol{x}_2^{n+1}$ are identical. The difference in the $y$-components is:\n$y_1^{n+1} - y_2^{n+1} = (r_0 \\sin(\\phi/2) - \\Delta t V_n \\cos(\\phi/2)) - (-r_0 \\sin(\\phi/2) + \\Delta t V_n \\cos(\\phi/2))$\n$= 2 r_0 \\sin(\\phi/2) - 2 \\Delta t V_n \\cos(\\phi/2)$.\nSo, $\\vec{P_2P_1}^{n+1} = (0, 2 r_0 \\sin(\\phi/2) - 2 \\Delta t V_n \\cos(\\phi/2))$.\nThe length of the base, $L^{n+1}$, is the magnitude of this vector. Initially, for $\\Delta t=0$, the term is positive (for $0 < \\phi < \\pi$). The base collapses to zero length when this term becomes zero.\n$2 r_0 \\sin(\\phi/2) - 2 \\Delta t_{\\max} V_n \\cos(\\phi/2) = 0$.\n$r_0 \\sin(\\phi/2) = \\Delta t_{\\max} V_n \\cos(\\phi/2)$.\nSolving for the largest time step $\\Delta t_{\\max}$ before collapse gives:\n$\\Delta t_{\\max} = \\frac{r_0 \\sin(\\phi/2)}{V_n \\cos(\\phi/2)} = \\frac{r_0}{V_n} \\tan(\\frac{\\phi}{2})$.\nThis result is derived directly from the geometric consequences of the forward Euler update on the nodal positions, as requested. The reference to the Geometric Conservation Law (GCL) reinforces that the core issue is the preservation of positive cell volume (area), which in this specific geometry is guaranteed by preventing the base from collapsing.\n\n\\subsection*{Part 3: Numerical Evaluation}\nWe are given the following values:\n$r_0 = 1.00 \\, \\mathrm{cm} = 0.01 \\, \\mathrm{m}$.\n$\\phi = 20 \\, \\mathrm{degrees}$.\n$V_n = 0.50 \\, \\mathrm{m/s}$.\n\nThe formula for $\\Delta t_{\\max}$ requires the angle in radians. The wedge half-angle is $\\phi/2 = 10 \\, \\mathrm{degrees}$.\nIn radians, this is $\\frac{\\phi}{2} = 10 \\times \\frac{\\pi}{180} = \\frac{\\pi}{18}$ radians.\n\nSubstituting the values into the derived expression:\n$\\Delta t_{\\max} = \\frac{0.01 \\, \\mathrm{m}}{0.50 \\, \\mathrm{m/s}} \\tan(10^{\\circ}) = 0.02 \\tan(\\frac{\\pi}{18}) \\, \\mathrm{s}$.\nNow, we compute the numerical value:\n$\\tan(\\frac{\\pi}{18}) \\approx 0.17632698$.\n$\\Delta t_{\\max} \\approx 0.02 \\times 0.17632698 \\, \\mathrm{s} \\approx 0.0035265396 \\, \\mathrm{s}$.\nRounding the result to four significant figures, we get:\n$\\Delta t_{\\max} \\approx 0.003527 \\, \\mathrm{s}$.\nIn scientific notation this is $3.527 \\times 10^{-3} \\, \\mathrm{s}$.",
            "answer": "$$\\boxed{3.527 \\times 10^{-3}}$$"
        },
        {
            "introduction": "Satisfying the Geometric Conservation Law is not just a spatial problem, but also a temporal one. When a simulation advances over a discrete time step, $\\Delta t$, the change in cell volume calculated by the mesh motion solver must exactly match the total geometric flux integrated by the flow solver. This exercise explores this \"space-time GCL,\" asking you to analyze how different time integration strategies in partitioned ALE solvers can either preserve or violate this critical conservation principle .",
            "id": "3344776",
            "problem": "A compressible flow solver is written in an Arbitrary Lagrangian–Eulerian (ALE) finite volume form on a deforming mesh. Let a control volume be denoted by $K(t)$ with outward unit normals $\\boldsymbol{n}_f(t)$ on faces $f$, face areas $A_f(t)$, and face mesh velocity $\\boldsymbol{v}_{m,f}(t)$. The update of the conserved state $\\boldsymbol{U}$ over a time step $[t^n, t^{n+1}]$ of size $\\Delta t$ is performed by a partitioned algorithm: the mesh motion is advanced by one time integrator and the flow unknowns are advanced by another, possibly with different time nodes and weights. Assume the fluxes are evaluated on the moving control volume, and that the flow solver reduces to a pure geometric effect when $\\boldsymbol{U}$ is a uniform freestream.\n\nStarting from the Reynolds transport theorem and the integral conservation form for a moving control volume, argue that freestream preservation imposes a discrete condition coupling the time integration of the mesh motion with the time integration of the flow update. Consider the following statements about explicit versus implicit time integration for mesh motion and flow update, and about conditions under which a partitioned approach violates the space–time geometric conservation law (GCL). Select all statements that are correct.\n\nA. If the time nodes and weights used to integrate the flow residual are identical to those used to evolve the mesh geometry, and the geometric data supplied to each flow stage are taken at exactly the same abscissae, then the discrete space–time GCL holds irrespective of whether either subsystem is implemented explicitly or implicitly.\n\nB. Choosing an implicit time integrator for the mesh motion while using an explicit Runge–Kutta method for the flow always preserves the space–time GCL, because the implicit method more accurately resolves the mesh kinematics.\n\nC. A partitioned algorithm violates the space–time GCL whenever the temporal quadrature used for the geometric flux in the flow residual differs from the quadrature used to update the control volume geometry, so that the discrete time derivative of cell volume and the net mesh flux through the boundary are not matched by the same time weights and abscissae.\n\nD. If the mesh motion within each time step is exactly linear in time and all faces undergo rigid motion, then any pairing of second–order accurate integrators (for example, trapezoidal rule for the flow and a backward differentiation formula of order $2$ for the mesh) automatically satisfies the space–time GCL even if the flow residual uses geometric data lagged to $t^n$.\n\nE. The only way to ensure the space–time GCL is to employ a monolithic coupled advance in which the flow state and mesh coordinates are solved simultaneously at each implicit stage; otherwise a partitioned approach necessarily violates the GCL.\n\nYour reasoning must begin from the integral conservation statement on a moving control volume and the definition of freestream preservation, and proceed to the discrete condition that must be satisfied by the time integration and geometric data. Then evaluate each option in light of this condition. Answer by choosing all correct options.",
            "solution": "The problem requires an analysis of the Geometric Conservation Law (GCL) for a partitioned Arbitrary Lagrangian-Eulerian (ALE) finite volume scheme, specifically in the context of preserving a uniform freestream flow.\n\n### Derivation of the Geometric Conservation Law (GCL)\n\nThe integral form of a conservation law for a quantity $\\boldsymbol{U}$ over a time-dependent control volume $K(t)$ is given by the Reynolds transport theorem, incorporated into a conservation statement:\n$$\n\\frac{d}{dt} \\int_{K(t)} \\boldsymbol{U} \\, dV + \\oint_{\\partial K(t)} [\\boldsymbol{f}(\\boldsymbol{U}) - \\boldsymbol{U} \\boldsymbol{v}_m^T] \\cdot \\boldsymbol{n} \\, dS = 0\n$$\nwhere $\\boldsymbol{f}(\\boldsymbol{U})$ is the standard Eulerian flux tensor and $\\boldsymbol{v}_m$ is the velocity of the boundary of the control volume (the mesh velocity).\n\nThe principle of freestream preservation states that if the initial condition is a uniform flow, $\\boldsymbol{U}(\\boldsymbol{x}, t=0) = \\boldsymbol{U}_\\infty = \\text{constant}$, the solution must remain $\\boldsymbol{U}(\\boldsymbol{x}, t) = \\boldsymbol{U}_\\infty$ for all time, regardless of the mesh motion $\\boldsymbol{v}_m(\\boldsymbol{x}, t)$.\n\nSubstituting the constant state $\\boldsymbol{U} = \\boldsymbol{U}_\\infty$ into the conservation law, both $\\boldsymbol{U}_\\infty$ and the corresponding Eulerian flux $\\boldsymbol{f}(\\boldsymbol{U}_\\infty)$ are constant throughout the domain. They can be factored out of the spatial integrals:\n$$\n\\frac{d}{dt} (\\boldsymbol{U}_\\infty V_K(t)) + \\boldsymbol{f}(\\boldsymbol{U}_\\infty) \\cdot \\oint_{\\partial K(t)} \\boldsymbol{n} \\, dS - \\boldsymbol{U}_\\infty \\oint_{\\partial K(t)} (\\boldsymbol{v}_m \\cdot \\boldsymbol{n}) \\, dS = 0\n$$\nwhere $V_K(t) = \\int_{K(t)} 1 \\, dV$ is the volume of the control volume.\n\nFrom the divergence theorem, the integral of the normal vector over a closed surface is zero: $\\oint_{\\partial K(t)} \\boldsymbol{n} \\, dS = 0$. The equation simplifies to:\n$$\n\\boldsymbol{U}_\\infty \\frac{d V_K(t)}{dt} - \\boldsymbol{U}_\\infty \\oint_{\\partial K(t)} (\\boldsymbol{v}_m \\cdot \\boldsymbol{n}) \\, dS = 0\n$$\nSince this must hold for any non-trivial freestream $\\boldsymbol{U}_\\infty \\neq 0$, the remaining expression must be zero:\n$$\n\\frac{d V_K(t)}{dt} - \\oint_{\\partial K(t)} (\\boldsymbol{v}_m \\cdot \\boldsymbol{n}) \\, dS = 0 \\quad \\implies \\quad \\frac{d V_K(t)}{dt} = \\oint_{\\partial K(t)} \\boldsymbol{v}_m \\cdot \\boldsymbol{n} \\, dS\n$$\nThis is the **continuous space-time Geometric Conservation Law (GCL)**. It is a purely geometric constraint stating that the rate of change of the volume must equal the net flux of the boundary velocity.\n\n### Discrete GCL and Partitioned Schemes\n\nNow, we consider the discretized form. For a finite volume cell $K_i$, the semi-discrete conservation law is:\n$$\n\\frac{d(V_i \\boldsymbol{U}_i)}{dt} + \\sum_{f \\in \\partial K_i} \\left( \\mathcal{F}(\\boldsymbol{U}_L, \\boldsymbol{U}_R) - \\mathcal{U}_f (\\boldsymbol{v}_{m,f} \\cdot \\boldsymbol{n}_f A_f) \\right) = 0\n$$\nwhere $\\mathcal{F}$ is the numerical inviscid flux and $\\mathcal{U}_f$ is the state used for the geometric flux term at face $f$. Integrating from time $t^n$ to $t^{n+1} = t^n + \\Delta t$:\n$$\n(V_i \\boldsymbol{U}_i)^{n+1} - (V_i \\boldsymbol{U}_i)^{n} + \\int_{t^n}^{t^{n+1}} \\left( \\sum_{f \\in \\partial K_i} \\left( \\mathcal{F}_f - \\mathcal{U}_f (\\boldsymbol{v}_{m,f} \\cdot \\boldsymbol{n}_f A_f) \\right) \\right) dt = 0\n$$\nFor freestream preservation, we set $\\boldsymbol{U}_i^n = \\boldsymbol{U}_\\infty$ and require $\\boldsymbol{U}_i^{n+1} = \\boldsymbol{U}_\\infty$. In a uniform flow, $\\mathcal{F}_f = \\boldsymbol{f}(\\boldsymbol{U}_\\infty) \\cdot \\boldsymbol{n}_f A_f$ and $\\mathcal{U}_f = \\boldsymbol{U}_\\infty$. The equation becomes:\n$$\nV_i^{n+1} \\boldsymbol{U}_\\infty - V_i^n \\boldsymbol{U}_\\infty + \\int_{t^n}^{t^{n+1}} \\left( \\boldsymbol{f}(\\boldsymbol{U}_\\infty) \\cdot \\sum_{f \\in \\partial K_i} \\boldsymbol{n}_f A_f - \\boldsymbol{U}_\\infty \\sum_{f \\in \\partial K_i} (\\boldsymbol{v}_{m,f} \\cdot \\boldsymbol{n}_f A_f) \\right) dt = 0\n$$\nAssuming the discrete geometry is closed at all times, $\\sum_{f \\in \\partial K_i} \\boldsymbol{n}_f A_f = 0$, the flux term vanishes. We are left with:\n$$\n\\boldsymbol{U}_\\infty \\left( (V_i^{n+1} - V_i^n) - \\int_{t^n}^{t^{n+1}} \\sum_{f \\in \\partial K_i} (\\boldsymbol{v}_{m,f} \\cdot \\boldsymbol{n}_f A_f) \\, dt \\right) = 0\n$$\nThis leads to the **discrete space-time GCL**:\n$$\nV_i^{n+1} - V_i^n = \\int_{t^n}^{t^{n+1}} \\sum_{f \\in \\partial K_i} (\\boldsymbol{v}_{m,f} \\cdot \\boldsymbol{n}_f A_f) \\, dt\n$$\nIn a partitioned scheme, the left-hand side, $V_i^{n+1} - V_i^n$, is determined by the time integrator used to advance the mesh geometry. The right-hand side is the time integral of the geometric flux, which is computed by the time integrator of the flow solver. The GCL is satisfied if and only if these two computations yield the exact same result. A violation occurs if the numerical quadrature (time nodes and weights) used to calculate the volume change from the mesh motion is not identical to the quadrature used to integrate the geometric flux term in the flow residual.\n\n### Evaluation of Options\n\n**A. If the time nodes and weights used to integrate the flow residual are identical to those used to evolve the mesh geometry, and the geometric data supplied to each flow stage are taken at exactly the same abscissae, then the discrete space–time GCL holds irrespective of whether either subsystem is implemented explicitly or implicitly.**\n\nThis statement describes a perfectly synchronized partitioned scheme. Let the time integration for both mesh and flow be defined by a quadrature rule with weights $w_k$ and nodes at times $t_k$. The mesh is advanced to $t^{n+1}$, resulting in a volume $V_i^{n+1}$. The flow solver computes the integral of the geometric flux using the same quadrature: $\\Delta t \\sum_k w_k (\\sum_f \\boldsymbol{v}_{m,f} \\cdot \\boldsymbol{n}_f A_f)_{t=t_k}$. If the geometric data $(\\boldsymbol{v}_{m,f}, \\boldsymbol{n}_f, A_f)$ used by the flow solver at each stage $k$ is consistent with the geometry produced by the mesh integrator at the same stage, and if the discrete volume calculation itself is consistent with the boundary motion (i.e., the discrete divergence theorem holds for the geometry), then the calculated change in volume will exactly match the calculated integrated flux. The specific nature of the integrator (explicit or implicit) is irrelevant as long as this synchronization is maintained. This describes the principle behind so-called \"GCL-consistent\" partitioned schemes.\n**Verdict: Correct.**\n\n**B. Choosing an implicit time integrator for the mesh motion while using an explicit Runge–Kutta method for the flow always preserves the space–time GCL, because the implicit method more accurately resolves the mesh kinematics.**\n\nThis statement is incorrect. The GCL is a matter of consistency, not accuracy. An implicit integrator (like backward Euler) for the mesh effectively uses a one-point quadrature at $t^{n+1}$ to determine the volume change $V^{n+1}-V^n$. An explicit multi-stage Runge-Kutta method for the flow uses a multi-point quadrature rule with specific intermediate time nodes and weights to integrate the flux residual. These two quadrature rules are fundamentally different. The mesh solver's computation of $V^{n+1}-V^n$ will not match the flow solver's computation of the integrated geometric flux. Therefore, the GCL will be violated. The higher accuracy of an implicit method is irrelevant to this consistency requirement.\n**Verdict: Incorrect.**\n\n**C. A partitioned algorithm violates the space–time GCL whenever the temporal quadrature used for the geometric flux in the flow residual differs from the quadrature used to update the control volume geometry, so that the discrete time derivative of cell volume and the net mesh flux through the boundary are not matched by the same time weights and abscissae.**\n\nThis statement is a precise articulation of the condition for GCL violation derived above. The \"discrete time derivative of cell volume\" represents the calculation of $(V_i^{n+1}-V_i^n)/\\Delta t$ as performed by the mesh evolution scheme. The \"net mesh flux through the boundary\" refers to the time-averaged value $\\frac{1}{\\Delta t} \\int_{t^n}^{t^{n+1}} \\sum_f (\\boldsymbol{v}_{m,f} \\cdot \\boldsymbol{n}_f A_f) dt$ as computed by the flow solver. If the underlying numerical quadratures (defined by time weights and abscissae) are different for these two calculations, their results will not be equal, and the GCL will be violated.\n**Verdict: Correct.**\n\n**D. If the mesh motion within each time step is exactly linear in time and all faces undergo rigid motion, then any pairing of second–order accurate integrators (for example, trapezoidal rule for the flow and a backward differentiation formula of order $2$ for the mesh) automatically satisfies the space–time GCL even if the flow residual uses geometric data lagged to $t^n$.**\n\nThis statement contains several flaws. First, assuming the mesh motion is exactly linear in time (constant velocity) is inconsistent with using a general multi-step integrator like BDF2 to advance the mesh dynamics, which would only produce linear motion under highly contrived circumstances. Second, and more critically, using geometric data lagged at $t^n$ is a primary source of GCL error. If the geometric flux rate is not constant in time, the flow solver would approximate the integral as $(\\text{flux rate at } t^n) \\times \\Delta t$, while the actual volume change from $t^n$ to $t^{n+1}$ would be different. Even under the restrictive assumption of linear motion (constant flux rate, say $C$), where the exact integral is $C \\Delta t$ and the lagged approximation is $C^n \\Delta t = C \\Delta t$, the statement that \"any pairing\" of integrators works is too strong and overlooks the contradiction in its own premise. The claim is not generally true.\n**Verdict: Incorrect.**\n\n**E. The only way to ensure the space–time GCL is to employ a monolithic coupled advance in which the flow state and mesh coordinates are solved simultaneously at each implicit stage; otherwise a partitioned approach necessarily violates the GCL.**\n\nThis statement is too strong and factually incorrect. While monolithic (fully coupled) schemes inherently satisfy the GCL by solving for geometry and flow state within a single system of equations, they are not the \"only way\". As established in the analysis of option A, partitioned schemes can be constructed to satisfy the GCL perfectly. These are often called \"sequentially consistent\" or \"kinematically consistent\" partitioned schemes, where the sub-problems (mesh and flow) are advanced using the same time integration formula and consistent data is passed at every stage. Therefore, a partitioned approach does not \"necessarily\" violate the GCL.\n**Verdict: Incorrect.**",
            "answer": "$$\\boxed{AC}$$"
        }
    ]
}