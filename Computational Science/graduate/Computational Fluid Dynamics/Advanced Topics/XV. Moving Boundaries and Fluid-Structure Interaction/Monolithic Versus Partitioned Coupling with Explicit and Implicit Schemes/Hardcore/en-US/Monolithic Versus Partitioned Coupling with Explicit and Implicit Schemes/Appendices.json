{
    "hands_on_practices": [
        {
            "introduction": "This model, a simple spring-mass system interacting with a fluid, serves as a cornerstone for understanding fluid-structure interaction (FSI) stability. By stripping away geometric complexity, this exercise allows for an analytical investigation of the so-called \"added-mass instability,\" a critical failure mode for many explicit partitioned schemes. You will derive the exact stability boundary and contrast it with the unconditional stability of a monolithic approach, providing a clear, foundational insight into the coupling problem. ",
            "id": "3346884",
            "problem": "A one-dimensional spring–mass coupled-to-fluid benchmark is proposed for assessing coupling stability in Computational Fluid Dynamics (CFD) and Fluid–Structure Interaction (FSI). A structural mass with mass $m_s$ is attached to a linear spring of stiffness $k$ and moves in a quiescent incompressible fluid that contributes a constant added mass $m_a$ along the motion direction due to potential-flow acceleration effects. Assume $m_s>0$, $m_a\\ge 0$, and $k>0$. Neglect viscous damping and any drag forces; the sole fluid effect is inertial, modeled by added mass. The exact coupled continuum ordinary differential equation for the displacement $x(t)$ of the mass is therefore\n$$\n\\left(m_s + m_a\\right)\\,\\ddot{x}(t) + k\\,x(t) = 0,\n$$\nwhich follows from Newton’s second law and the standard linear added-mass closure for potential flow.\n\nTwo time-integration/coupling strategies are to be compared for stability:\n\n- Monolithic implicit: Apply a fully implicit Newmark family time integrator with parameters $\\beta=\\tfrac{1}{4}$ and $\\gamma=\\tfrac{1}{2}$ directly to the combined equation $\\left(m_s+m_a\\right)\\ddot{x} + kx=0$.\n\n- Partitioned explicit: Use a single-iteration, staggered Dirichlet–Neumann coupling with a central-difference structural update. At discrete time level $n$ with uniform step $\\Delta t$, define the structural acceleration by the central difference\n$$\na^n := \\frac{x^{n+1} - 2 x^n + x^{n-1}}{\\Delta t^2}.\n$$\nLet the fluid traction be modeled by the added-mass force $F_f=-m_a \\ddot{x}$ but evaluated explicitly with one-step lag, i.e., $F_f^n=-m_a a^{n-1}$. Advance the structure by\n$$\nm_s\\,a^n + k\\,x^n = F_f^n,\n$$\nwith no sub-iterations.\n\nTasks:\n\n1. Starting only from Newton’s law, the added-mass definition, and the stated discrete formulas, derive the homogeneous linear recurrence that governs $\\{x^n\\}$ for the partitioned explicit scheme.\n\n2. Perform a von Neumann amplification-factor analysis by inserting $x^n=\\hat{x}\\,\\rho^n$ with complex $\\rho$ to obtain the stability boundary on the unit circle $|\\rho|=1$. Determine the necessary and sufficient condition on $\\Delta t$ for stability of the partitioned explicit scheme in the form $\\Delta t < \\Delta t_{\\max}(m_s,m_a,k)$, and identify any constraint on the mass ratio that must hold for a nonzero $\\Delta t_{\\max}$ to exist.\n\n3. For the monolithic implicit Newmark scheme with $\\beta=\\tfrac{1}{4}$, $\\gamma=\\tfrac{1}{2}$ applied to the combined mass $\\left(m_s+m_a\\right)$, state whether a time-step restriction exists for linear conservative dynamics.\n\nProvide as your final result a single closed-form analytic expression for $\\Delta t_{\\max}(m_s,m_a,k)$ for the partitioned explicit scheme. Do not substitute numerical values. You do not need to include units in the final boxed expression; express your answer purely in terms of $m_s$, $m_a$, and $k$.",
            "solution": "The user-provided problem statement has been critically reviewed and is determined to be **valid**. It is scientifically grounded, well-posed, objective, and contains all necessary information to derive the requested results. The problem is a standard, albeit simplified, benchmark for analyzing the numerical stability of fluid-structure interaction (FSI) coupling schemes.\n\nThe solution proceeds by addressing each of the three tasks in order.\n\n### Task 1: Derivation of the Recurrence Relation\n\nThe partitioned explicit scheme is defined by three discrete equations:\n1.  The structural time-advancement equation:\n    $$m_s a^n + k x^n = F_f^n$$\n2.  The explicit coupling for the fluid force, which is lagged by one time step:\n    $$F_f^n = -m_a a^{n-1}$$\n3.  The second-order central difference approximation for acceleration:\n    $$a^k := \\frac{x^{k+1} - 2x^k + x^{k-1}}{\\Delta t^2}$$\n    where $k$ is a generic time-level index and $\\Delta t$ is the constant time step size.\n\nWe begin by substituting the fluid force definition (2) into the structural equation (1):\n$$m_s a^n + k x^n = -m_a a^{n-1}$$\nNext, we substitute the central difference formula for acceleration (3) for both $a^n$ and $a^{n-1}$:\n$$m_s \\left( \\frac{x^{n+1} - 2x^n + x^{n-1}}{\\Delta t^2} \\right) + k x^n = -m_a \\left( \\frac{x^n - 2x^{n-1} + x^{n-2}}{\\Delta t^2} \\right)$$\nTo eliminate the denominator $\\Delta t^2$, we multiply the entire equation by $\\Delta t^2$:\n$$m_s (x^{n+1} - 2x^n + x^{n-1}) + k \\Delta t^2 x^n = -m_a (x^n - 2x^{n-1} + x^{n-2})$$\nThe final step is to rearrange this equation into a homogeneous linear recurrence relation by gathering all terms on the left-hand side and grouping them by their time index:\n$$m_s x^{n+1} + (-2m_s x^n + m_s x^{n-1}) + k \\Delta t^2 x^n + (m_a x^n - 2m_a x^{n-1} + m_a x^{n-2}) = 0$$\n$$m_s x^{n+1} + (-2m_s + k \\Delta t^2 + m_a)x^n + (m_s - 2m_a)x^{n-1} + m_a x^{n-2} = 0$$\nThis is the required homogeneous linear recurrence relation that governs the discrete displacement $\\{x^n\\}$.\n\n### Task 2: Stability Analysis of the Partitioned Explicit Scheme\n\nTo perform a von Neumann stability analysis, we assume a solution of the form $x^n = \\hat{x} \\rho^n$, where $\\rho$ is the complex amplification factor. Substituting this into the recurrence relation yields:\n$$m_s \\hat{x} \\rho^{n+1} + (m_a - 2m_s + k \\Delta t^2) \\hat{x} \\rho^n + (m_s - 2m_a) \\hat{x} \\rho^{n-1} + m_a \\hat{x} \\rho^{n-2} = 0$$\nDividing by $\\hat{x} \\rho^{n-2}$ (assuming $\\hat{x} \\neq 0$ and $\\rho \\neq 0$), we obtain the characteristic polynomial for the amplification factor $\\rho$:\n$$P(\\rho) = m_s \\rho^3 + (m_a - 2m_s + k \\Delta t^2) \\rho^2 + (m_s - 2m_a) \\rho + m_a = 0$$\nFor the scheme to be stable, all roots $\\rho_i$ of this polynomial must satisfy the condition $|\\rho_i| \\le 1$. The stability boundary occurs when at least one root lies on the unit circle, i.e., $|\\rho|=1$. A common stability limit for explicit schemes of this type occurs when a real root crosses the unit circle at $\\rho=-1$.\n\nLet's evaluate the characteristic polynomial at $\\rho = -1$:\n$$P(-1) = m_s(-1)^3 + (m_a - 2m_s + k \\Delta t^2)(-1)^2 + (m_s - 2m_a)(-1) + m_a$$\n$$P(-1) = -m_s + (m_a - 2m_s + k \\Delta t^2) - (m_s - 2m_a) + m_a$$\n$$P(-1) = -m_s + m_a - 2m_s + k \\Delta t^2 - m_s + 2m_a + m_a$$\n$$P(-1) = (-m_s - 2m_s - m_s) + (m_a + 2m_a + m_a) + k \\Delta t^2$$\n$$P(-1) = -4m_s + 4m_a + k \\Delta t^2$$\nA more formal approach using the Jury stability criteria for a cubic polynomial requires, for a stable system (all roots inside the unit circle), that $(-1)^3 P(-1) > 0$, which simplifies to $P(-1) < 0$.\n$$-4m_s + 4m_a + k \\Delta t^2 < 0$$\n$$k \\Delta t^2 < 4(m_s - m_a)$$\nFor this inequality to be possible with a positive $\\Delta t^2$, the right-hand side must be positive. Given $k>0$, this imposes a critical constraint on the masses:\n$$m_s - m_a > 0 \\implies m_s > m_a$$\nThis is the necessary constraint on the mass ratio for a non-zero stable time step $\\Delta t_{\\max}$ to exist. If $m_s \\le m_a$, the partitioned explicit scheme is unconditionally unstable.\n\nAssuming $m_s > m_a$, the stability condition is:\n$$\\Delta t^2 < \\frac{4(m_s - m_a)}{k}$$\nThe stability boundary is therefore defined by the maximum allowable time step, $\\Delta t_{\\max}$:\n$$\\Delta t_{\\max} = \\sqrt{\\frac{4(m_s - m_a)}{k}} = 2\\sqrt{\\frac{m_s - m_a}{k}}$$\nThis result, derived from the $\\rho=-1$ condition, is indeed the tightest constraint, as confirmed by a full application of the Jury stability criteria.\n\n### Task 3: Stability of the Monolithic Implicit Scheme\n\nThe monolithic scheme applies a single time integrator to the fully coupled equation of motion:\n$$(m_s + m_a)\\ddot{x}(t) + k x(t) = 0$$\nThis is a standard linear, undamped, single-degree-of-freedom oscillator equation with total mass $M = m_s + m_a$ and stiffness $K=k$.\nThe specified time integrator is the Newmark method with parameters $\\beta=\\frac{1}{4}$ and $\\gamma=\\frac{1}{2}$. This specific choice of parameters corresponds to the constant average acceleration method, which is mathematically equivalent to the trapezoidal rule for second-order systems.\nIt is a well-established result in numerical analysis and structural dynamics that the constant average acceleration method is unconditionally stable for linear systems. This means that for any choice of time step $\\Delta t > 0$, the numerical solution will not exhibit unbounded growth, regardless of how large $\\Delta t$ is in relation to the natural period of the system.\nTherefore, for the monolithic implicit Newmark scheme, **no time-step restriction exists** for stability.\n\nThe final answer requested is the expression for $\\Delta t_{\\max}$ from Task 2.",
            "answer": "$$\n\\boxed{2\\sqrt{\\frac{m_s - m_a}{k}}}\n$$"
        },
        {
            "introduction": "Building on the analytical insights from the spring-mass model, this practice moves into the computational realm. You will investigate the added-mass instability in a more realistic scenario of a compliant channel wall, a common feature in biomechanics and aerospace applications. By numerically constructing and analyzing the amplification matrices for both partitioned and monolithic schemes, you will directly observe how stability depends on the density ratio and choice of coupling strategy. ",
            "id": "3346901",
            "problem": "Consider a simplified Fluid-Structure Interaction (FSI) model for a two-dimensional channel with a compliant wall segment of length $L$ and unit out-of-plane width. The wall is modeled as a single-degree-of-freedom line mass per unit length $m_s$ coupled to a linear spring of stiffness per unit length $k_s$ and a linear dashpot of damping per unit length $c_s$. The surrounding incompressible fluid of density $\\rho_f$ induces an inertial reaction that can be represented, in the small-amplitude, linearized regime, as an added mass per unit length $M_a = C_a \\rho_f L^2$, where $C_a$ is a dimensionless geometry-dependent added-mass coefficient. The displacement of the wall in the normal direction is $y(t)$, and the interaction force from the fluid acts to resist the interface acceleration. The density ratio is defined as $r = m_s / (\\rho_f L^2)$, which is dimensionless.\n\nStart from Newton's second law for the compliant wall with the fluid reaction modeled as added mass. In the continuous setting, this leads to an ordinary differential equation (ODE) for $y(t)$ that couples the structural inertia $m_s$ and the fluid-induced inertia $M_a$, along with damping $c_s$ and stiffness $k_s$ terms. You will compare two numerical coupling strategies:\n\n1. A partitioned explicit interface update that advances the structure using the fluid inertial reaction evaluated at the previous time step. Use a first-order Forward Euler time discretization for the structure. In this setting, the discrete fluid force at time step $n$ must be modeled as the reaction due to the previous-step acceleration, i.e., as $-M_a a^{n-1}$ resisting the motion.\n\n2. A monolithic implicit Newton coupling that treats the structure and fluid reaction together at the new time. Use a first-order Backward Euler time discretization and treat the coupled inertia $(m_s + M_a)$ implicitly at time step $n+1$.\n\nFrom these principles, derive the linear, time-step-to-time-step amplification operator for each scheme, written as an explicit matrix that maps the state at time step $n$ to the state at time step $n+1$. For the partitioned explicit scheme, the state must be chosen to accommodate the lag of one-step acceleration in the fluid reaction. For the monolithic implicit scheme, directly eliminate the acceleration using the Backward Euler velocity update and the displacement update to form a closed amplification matrix in the displacement–velocity variables. For both schemes, the discrete-time system is stable if and only if the spectral radius (maximum absolute value of the eigenvalues) of the amplification matrix is strictly less than $1$.\n\nYour program must implement the following steps:\n\n- For each test case, compute the added mass per unit length as $M_a = C_a \\rho_f L^2$.\n- Construct the amplification matrix for the partitioned explicit scheme under Forward Euler using the lagged fluid reaction $-M_a a^{n-1}$, with the state vector containing displacement $y^n$, velocity $v^n$, and the previous-step acceleration $a^{n-1}$.\n- Construct the amplification matrix for the monolithic implicit scheme under Backward Euler with $(m_s + M_a)$ treated implicitly, with the state vector containing $y^n$ and $v^n$.\n- Compute the spectral radius for each amplification matrix and decide stability for each scheme by checking whether the spectral radius is strictly less than $1$ (true means stable, false means not stable).\n- Aggregate the results as a list of pairs $[s_{\\mathrm{part}}, s_{\\mathrm{mono}}]$ per test case, where $s_{\\mathrm{part}}$ and $s_{\\mathrm{mono}}$ are booleans indicating stability of the partitioned explicit and monolithic implicit schemes, respectively.\n\nPhysical and numerical units:\n\n- $L$ in $\\mathrm{m}$, $\\rho_f$ in $\\mathrm{kg/m^3}$, $m_s$ in $\\mathrm{kg/m}$, $k_s$ in $\\mathrm{N/m^2}$, $c_s$ in $\\mathrm{N\\cdot s/m^2}$, $C_a$ dimensionless, time step $\\Delta t$ in $\\mathrm{s}$.\n\nTest suite:\n\n- Case $1$: $L = 0.1\\,\\mathrm{m}$, $\\rho_f = 1000\\,\\mathrm{kg/m^3}$, $m_s = 0.1\\,\\mathrm{kg/m}$, $k_s = 1.0\\times 10^4\\,\\mathrm{N/m^2}$, $c_s = 100\\,\\mathrm{N\\cdot s/m^2}$, $C_a = 1.0$, $\\Delta t = 0.005\\,\\mathrm{s}$.\n- Case $2$ (undamped boundary-type): $L = 0.1\\,\\mathrm{m}$, $\\rho_f = 1000\\,\\mathrm{kg/m^3}$, $m_s = 10.0\\,\\mathrm{kg/m}$, $k_s = 1.0\\times 10^4\\,\\mathrm{N/m^2}$, $c_s = 0\\,\\mathrm{N\\cdot s/m^2}$, $C_a = 0.8$, $\\Delta t = 0.02\\,\\mathrm{s}$.\n- Case $3$ (heavy structure): $L = 0.1\\,\\mathrm{m}$, $\\rho_f = 1000\\,\\mathrm{kg/m^3}$, $m_s = 100.0\\,\\mathrm{kg/m}$, $k_s = 5.0\\times 10^3\\,\\mathrm{N/m^2}$, $c_s = 200\\,\\mathrm{N\\cdot s/m^2}$, $C_a = 0.3$, $\\Delta t = 0.05\\,\\mathrm{s}$.\n- Case $4$ (large added mass): $L = 0.1\\,\\mathrm{m}$, $\\rho_f = 1000\\,\\mathrm{kg/m^3}$, $m_s = 1.0\\,\\mathrm{kg/m}$, $k_s = 8.0\\times 10^3\\,\\mathrm{N/m^2}$, $c_s = 50\\,\\mathrm{N\\cdot s/m^2}$, $C_a = 1.5$, $\\Delta t = 0.02\\,\\mathrm{s}$.\n\nRequired final output format:\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each entry is itself a two-element list of booleans per test case in the order given above; for example, $[[\\mathrm{True},\\mathrm{False}],\\ldots]$.",
            "solution": "The user has requested an analysis of numerical stability for a simplified fluid-structure interaction (FSI) problem. This analysis requires the derivation and implementation of amplification operators for two distinct coupling schemes: a partitioned explicit scheme and a monolithic implicit scheme. The problem is scientifically sound, well-posed, and all necessary parameters are provided for a complete analysis.\n\n### Governing Equation\nThe problem describes a single-degree-of-freedom mechanical system for the compliant wall's displacement, $y(t)$. The wall segment has a structural mass per unit length $m_s$, is restrained by a spring of stiffness $k_s$ and a dashpot with damping $c_s$. The fluid's reaction is modeled as an added mass, $M_a$, which contributes an inertial force opposing the wall's acceleration, $a(t) = \\ddot{y}(t)$.\n\nApplying Newton's second law, the sum of forces equals mass times acceleration. The forces acting on the structure are the spring force ($-k_s y$), the damping force ($-c_s v$, where $v=\\dot{y}$), and the fluid force ($-M_a a$).\n$$\nm_s a(t) = -k_s y(t) - c_s v(t) - M_a a(t)\n$$\nRearranging the terms to form the standard second-order linear ordinary differential equation (ODE) for the fully-coupled system gives:\n$$\n(m_s + M_a) a(t) + c_s v(t) + k_s y(t) = 0\n$$\nThis equation represents a damped harmonic oscillator with an effective mass $M_{eff} = m_s + M_a$. We will now discretize this system using the two specified schemes.\n\n### Scheme 1: Partitioned Explicit Scheme\nThis scheme uses a Forward Euler method for the structural time integration and treats the fluid force explicitly, based on the acceleration from the previous time step, $a^{n-1}$. This is a-priori a source of potential instability known as the \"added-mass instability\".\n\nThe discrete equations are:\n1.  Newton's second law at time step $n$, with the lagged fluid force:\n    $$\n    m_s a^n = -k_s y^n - c_s v^n - M_a a^{n-1}\n    $$\n2.  Forward Euler updates for velocity and displacement:\n    $$\n    v^{n+1} = v^n + \\Delta t \\cdot a^n\n    $$\n    $$\n    y^{n+1} = y^n + \\Delta t \\cdot v^n\n    $$\n\nTo construct the amplification matrix, we first express the current acceleration, $a^n$, in terms of the state at time step $n$ and $n-1$:\n$$\na^n = -\\frac{k_s}{m_s} y^n - \\frac{c_s}{m_s} v^n - \\frac{M_a}{m_s} a^{n-1}\n$$\nThe problem specifies a state vector $\\mathbf{z}^n$ that includes the lagged acceleration: $\\mathbf{z}^n = [y^n, v^n, a^{n-1}]^T$. The state at the next time step is $\\mathbf{z}^{n+1} = [y^{n+1}, v^{n+1}, a^n]^T$.\n\nThe update equations for the components of $\\mathbf{z}^{n+1}$ are:\n$$\ny^{n+1} = 1 \\cdot y^n + \\Delta t \\cdot v^n + 0 \\cdot a^{n-1}\n$$\n$$\nv^{n+1} = v^n + \\Delta t \\left( -\\frac{k_s}{m_s} y^n - \\frac{c_s}{m_s} v^n - \\frac{M_a}{m_s} a^{n-1} \\right) = -\\frac{k_s \\Delta t}{m_s} y^n + \\left(1 - \\frac{c_s \\Delta t}{m_s}\\right) v^n - \\frac{M_a \\Delta t}{m_s} a^{n-1}\n$$\n$$\na^{n} = -\\frac{k_s}{m_s} y^n - \\frac{c_s}{m_s} v^n - \\frac{M_a}{m_s} a^{n-1}\n$$\nThese equations can be written in matrix form $\\mathbf{z}^{n+1} = \\mathbf{A}_{\\mathrm{part}} \\mathbf{z}^n$, where the partitioned explicit amplification matrix $\\mathbf{A}_{\\mathrm{part}}$ is:\n$$\n\\mathbf{A}_{\\mathrm{part}} =\n\\begin{pmatrix}\n1 & \\Delta t & 0 \\\\\n-\\frac{k_s \\Delta t}{m_s} & 1 - \\frac{c_s \\Delta t}{m_s} & -\\frac{M_a \\Delta t}{m_s} \\\\\n-\\frac{k_s}{m_s} & -\\frac{c_s}{m_s} & -\\frac{M_a}{m_s}\n\\end{pmatrix}\n$$\n\n### Scheme 2: Monolithic Implicit Scheme\nThis scheme uses a Backward Euler method, treating the entire system, including the fluid added mass, implicitly at time step $n+1$.\n\nThe fully implicit discrete equation of motion is evaluated at time $n+1$:\n$$\n(m_s + M_a) a^{n+1} + c_s v^{n+1} + k_s y^{n+1} = 0\n$$\nThe Backward Euler updates relate the state at $n+1$ to the state at $n$:\n$$\ny^{n+1} = y^n + \\Delta t \\cdot v^{n+1}\n$$\n$$\nv^{n+1} = v^n + \\Delta t \\cdot a^{n+1} \\implies a^{n+1} = \\frac{v^{n+1} - v^n}{\\Delta t}\n$$\nThe state vector for this scheme is $\\mathbf{z}^n = [y^n, v^n]^T$. To find the amplification matrix, we must express $\\mathbf{z}^{n+1} = [y^{n+1}, v^{n+1}]^T$ as a function of $\\mathbf{z}^n$. We substitute the expressions for $y^{n+1}$ and $a^{n+1}$ into the implicit equation of motion:\n$$\nM_{eff} \\left( \\frac{v^{n+1} - v^n}{\\Delta t} \\right) + c_s v^{n+1} + k_s (y^n + \\Delta t \\cdot v^{n+1}) = 0\n$$\nwhere $M_{eff} = m_s + M_a$. We now solve for $v^{n+1}$:\n$$\n\\left( \\frac{M_{eff}}{\\Delta t} + c_s + k_s \\Delta t \\right) v^{n+1} = -k_s y^n + \\frac{M_{eff}}{\\Delta t} v^n\n$$\nLet $D = \\frac{M_{eff}}{\\Delta t} + c_s + k_s \\Delta t$. Then:\n$$\nv^{n+1} = \\left(-\\frac{k_s}{D}\\right) y^n + \\left(\\frac{M_{eff}/\\Delta t}{D}\\right) v^n\n$$\nNow, we find $y^{n+1}$ using its update rule:\n$$\ny^{n+1} = y^n + \\Delta t \\cdot v^{n+1} = y^n + \\Delta t \\left[ \\left(-\\frac{k_s}{D}\\right) y^n + \\left(\\frac{M_{eff}/\\Delta t}{D}\\right) v^n \\right]\n$$\n$$\ny^{n+1} = \\left(1 - \\frac{k_s \\Delta t}{D}\\right) y^n + \\left(\\frac{M_{eff}}{D}\\right) v^n\n$$\nThese equations form the matrix system $\\mathbf{z}^{n+1} = \\mathbf{A}_{\\mathrm{mono}} \\mathbf{z}^n$, where the monolithic implicit amplification matrix $\\mathbf{A}_{\\mathrm{mono}}$ is:\n$$\n\\mathbf{A}_{\\mathrm{mono}} =\n\\begin{pmatrix}\n1 - \\frac{k_s \\Delta t}{D} & \\frac{M_{eff}}{D} \\\\\n-\\frac{k_s}{D} & \\frac{M_{eff}/\\Delta t}{D}\n\\end{pmatrix}\n$$\n\n### Stability Analysis\nFor both schemes, the numerical method is stable if and only if the system state does not grow unboundedly in time. For a linear time-invariant system of the form $\\mathbf{z}^{n+1} = \\mathbf{A} \\mathbf{z}^n$, this requires that the spectral radius of the amplification matrix $\\mathbf{A}$, denoted $\\rho(\\mathbf{A})$, is strictly less than $1$. The spectral radius is defined as the maximum absolute value of the eigenvalues of $\\mathbf{A}$:\n$$\n\\rho(\\mathbf{A}) = \\max_{i} |\\lambda_i(\\mathbf{A})|\n$$\nThe stability criterion is $\\rho(\\mathbf{A}) < 1$. The program will compute this value for each matrix and test case to determine stability.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Analyzes the stability of partitioned explicit and monolithic implicit\n    schemes for a simplified fluid-structure interaction problem.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: L, rho_f, m_s, k_s, c_s, C_a, dt\n        (0.1, 1000.0, 0.1, 1.0e4, 100.0, 1.0, 0.005),\n        # Case 2: undamped boundary-type\n        (0.1, 1000.0, 10.0, 1.0e4, 0.0, 0.8, 0.02),\n        # Case 3: heavy structure\n        (0.1, 1000.0, 100.0, 5.0e3, 200.0, 0.3, 0.05),\n        # Case 4: large added mass\n        (0.1, 1000.0, 1.0, 8.0e3, 50.0, 1.5, 0.02),\n    ]\n\n    results = []\n    for L, rho_f, m_s, k_s, c_s, C_a, dt in test_cases:\n        # Compute added mass per unit length\n        M_a = C_a * rho_f * L**2\n\n        # --- Scheme 1: Partitioned Explicit ---\n        # Construct the amplification matrix A_part\n        # State vector: [y^n, v^n, a^(n-1)]\n        # A_part maps state at n to state at n+1\n        if m_s <= 0:\n            # Avoid division by zero, though not expected in test cases\n            is_stable_part = False\n        else:\n            A_part = np.array([\n                [1.0, dt, 0.0],\n                [-k_s * dt / m_s, 1.0 - c_s * dt / m_s, -M_a * dt / m_s],\n                [-k_s / m_s, -c_s / m_s, -M_a / m_s]\n            ], dtype=np.float64)\n            \n            # Compute spectral radius and check stability\n            eigvals_part = np.linalg.eigvals(A_part)\n            rho_part = np.max(np.abs(eigvals_part))\n            is_stable_part = rho_part < 1.0\n\n        # --- Scheme 2: Monolithic Implicit ---\n        # Construct the amplification matrix A_mono\n        # State vector: [y^n, v^n]\n        # A_mono maps state at n to state at n+1\n        M_eff = m_s + M_a\n        D = M_eff / dt + c_s + k_s * dt\n        \n        if D <= 0:\n            # Avoid division by zero, not expected for physical parameters\n            is_stable_mono = False\n        else:\n            A_mono = np.array([\n                [1.0 - k_s * dt / D, M_eff / D],\n                [-k_s / D, (M_eff / dt) / D]\n            ], dtype=np.float64)\n\n            # Compute spectral radius and check stability\n            eigvals_mono = np.linalg.eigvals(A_mono)\n            rho_mono = np.max(np.abs(eigvals_mono))\n            is_stable_mono = rho_mono < 1.0\n        \n        results.append([is_stable_part, is_stable_mono])\n\n    # Final print statement in the exact required format.\n    # The required format \"[[True,False],...]\" is the standard string\n    # representation of a list of lists of booleans in Python, with spaces removed.\n    print(str(results).replace(\" \", \"\"))\n\nsolve()\n```"
        },
        {
            "introduction": "Beyond stability, the accuracy of a coupling scheme is paramount for predictive simulations. This exercise quantifies the accuracy of partitioned versus monolithic coupling by analyzing how well they model wave propagation across a fluid-structure interface. You will compute the spurious numerical reflections generated by each scheme and compare them to the exact physical solution, demonstrating how monolithic formulations can better preserve the interface impedance and lead to more physically faithful results. ",
            "id": "3346902",
            "problem": "Consider a one-dimensional, small-amplitude plane acoustic wave in a compressible fluid of density $\\rho$ and sound speed $c$ incident on a flexible panel at $x=0$ with area $A$, lumped mass $m$, and linear stiffness $k$. Assume linear acoustics and a single-degree-of-freedom structural model for the panel. Let the incident particle-velocity wave be $u_{\\text{inc}}(t)$ and the reflected component be $u_{\\text{ref}}(t)$; the total interface velocity is $v(t) = u_{\\text{inc}}(t) + u_{\\text{ref}}(t)$. The fluid’s characteristic relation at the interface is $p(t) = \\rho c \\big(u_{\\text{inc}}(t) - u_{\\text{ref}}(t)\\big)$, with $p(t)$ the interface pressure acting on the panel. The panel displacement $\\xi(t)$ satisfies $m \\ddot{\\xi}(t) + k \\xi(t) = A p(t)$ and $v(t) = \\dot{\\xi}(t)$. Work in the frequency domain for time-harmonic excitation, and define the velocity-reflection coefficient $R(\\omega) = U_{\\text{ref}}(\\omega) / U_{\\text{inc}}(\\omega)$, where $U_{\\text{inc}}(\\omega)$ and $U_{\\text{ref}}(\\omega)$ are the complex amplitudes of $u_{\\text{inc}}(t)$ and $u_{\\text{ref}}(t)$ at angular frequency $\\omega$.\n\nTask 1: From the above fundamental relations, derive the continuous-time frequency response $H_{\\text{cont}}(\\omega) = V(\\omega)/P(\\omega)$ of the panel and then the continuous-time reflection coefficient $R_{\\text{phys}}(\\omega)$ in terms of $\\rho$, $c$, $A$, $m$, $k$, and $\\omega$.\n\nTask 2: Consider a partitioned explicit one-step-lag coupling in discrete time with uniform time step $\\Delta t$. Assume discrete-time harmonic signals with complex multiplier $z = e^{i \\omega \\Delta t}$. The fluid update uses the lagged structure velocity so that the interface pressure is $p^n = \\rho c \\big(2 u_{\\text{inc}}^n - v^{n-1}\\big)$. The structure is advanced by an explicit Euler scheme:\n- $\\xi^n = \\xi^{n-1} + \\Delta t\\, v^{n-1}$,\n- $v^n = v^{n-1} + \\frac{\\Delta t}{m}\\big(A p^n - k \\xi^{n-1}\\big)$.\nUsing linear, time-harmonic analysis in $z$, derive the discrete transfer function $H_{\\text{part}}(z) = V/P$ of the structure and the resulting discrete reflection coefficient $R_{\\text{part}}(\\omega)$.\n\nTask 3: Consider instead a monolithic trapezoidal (Crank–Nicolson) time-integration with interface-consistent mass coupling, without lag between fluid and structure at the same time level:\n- $m \\frac{v^n - v^{n-1}}{\\Delta t} = \\frac{A}{2}\\big(p^n + p^{n-1}\\big) - \\frac{k}{2}\\big(\\xi^n + \\xi^{n-1}\\big)$,\n- $\\xi^n - \\xi^{n-1} = \\frac{\\Delta t}{2}\\big(v^n + v^{n-1}\\big)$,\n- $p^n = \\rho c \\big(2 u_{\\text{inc}}^n - v^n\\big)$.\nUsing linear, time-harmonic analysis in $z = e^{i \\omega \\Delta t}$, derive $H_{\\text{mono}}(z) = V/P$ and the resulting discrete reflection coefficient $R_{\\text{mono}}(\\omega)$.\n\nTask 4: For a given set of physical parameters and time steps, define the spurious-reflection error magnitude for each discrete scheme as $E_{\\text{part}} = |R_{\\text{part}}(\\omega) - R_{\\text{phys}}(\\omega)|$ and $E_{\\text{mono}} = |R_{\\text{mono}}(\\omega) - R_{\\text{phys}}(\\omega)|$, where $|\\cdot|$ denotes the complex modulus. Interpret $R_{\\text{phys}}$ as the ideal continuous-time target and compare the discrete schemes to it. This quantifies how partitioned one-step lag propagates error across the interface and how monolithic, interface-consistent mass coupling reduces spurious reflections. This setting models the small-amplitude, linear perturbations riding on a shock–panel interaction, where accurate impedance matching at the interface controls unphysical reflections.\n\nNumerical requirements and units:\n- Use International System of Units (SI) for all inputs: $\\rho$ in kilograms per cubic meter, $c$ in meters per second, $A$ in square meters, $m$ in kilograms, $k$ in newtons per meter, $\\Delta t$ in seconds. Frequencies are given as either $f$ in hertz (cycles per second) or $\\omega$ in radians per second with $\\omega = 2 \\pi f$; use radians for all angular quantities in calculations.\n- The final outputs are dimensionless floats.\n\nTest suite to implement and evaluate:\n- Case $1$ (happy path, air, moderate frequency): $\\rho = 1.2$, $c = 340$, $A = 1.0$, $m = 2.0$, $k = 5 \\times 10^{4}$, $\\Delta t = 5 \\times 10^{-4}$, $f = 80$. Use $\\omega = 2 \\pi f$.\n- Case $2$ (structural resonance): $\\rho = 1.2$, $c = 340$, $A = 1.0$, $m = 1.0$, $k = 1 \\times 10^{5}$, $\\Delta t = 1 \\times 10^{-3}$, $\\omega = \\sqrt{k/m}$.\n- Case $3$ (near-Nyquist excitation): $\\rho = 1.2$, $c = 340$, $A = 1.0$, $m = 2.0$, $k = 5 \\times 10^{4}$, $\\Delta t = 1 \\times 10^{-4}$, $\\omega = 0.8 \\pi / \\Delta t$.\n- Case $4$ (strong fluid impedance, water-like, moderate area): $\\rho = 1000$, $c = 1500$, $A = 1.0 \\times 10^{-2}$, $m = 0.2$, $k = 1 \\times 10^{5}$, $\\Delta t = 2 \\times 10^{-4}$, $f = 500$. Use $\\omega = 2 \\pi f$.\n- Case $5$ (stiff, light panel, high frequency): $\\rho = 1.2$, $c = 340$, $A = 1.0$, $m = 0.5$, $k = 1 \\times 10^{7}$, $\\Delta t = 5 \\times 10^{-5}$, $f = 2000$. Use $\\omega = 2 \\pi f$.\n\nProgram specification:\n- Implement the derived formulas to compute $R_{\\text{phys}}(\\omega)$, $R_{\\text{part}}(\\omega)$, and $R_{\\text{mono}}(\\omega)$ for each case, then compute $E_{\\text{part}}$ and $E_{\\text{mono}}$.\n- For each case, compute the improvement factor $I = E_{\\text{part}}/E_{\\text{mono}}$. A value greater than $1$ indicates that the monolithic, interface-consistent mass coupling reduces spurious reflections relative to the partitioned lagged scheme.\n- Your program should produce a single line of output containing the $5$ improvement factors as a comma-separated list enclosed in square brackets (e.g., $\"[I_1,I_2,I_3,I_4,I_5]\"$). Each $I_j$ must be a floating-point number in decimal form.",
            "solution": "This solution addresses a problem in computational fluid-structure interaction (FSI). The core task is to derive and compare the frequency-domain reflection coefficients for a one-dimensional acoustic-structure interaction problem under three different models: $1)$ the exact continuous-time physical model, $2)$ a discrete-time partitioned explicit coupling scheme with a one-step lag, and $3)$ a discrete-time monolithic implicit coupling scheme. The comparison quantifies the spurious reflections introduced by the numerical schemes.\n\nThe analysis is performed in the frequency domain. For continuous time, we use the Fourier transform where the time derivative $\\frac{d}{dt}$ is replaced by multiplication with $i\\omega$, for an angular frequency $\\omega$. For discrete time, we use the Z-transform, where a time series $x^n$ is represented by its complex amplitude $X$ and the time-stepping operator is $z=e^{i\\omega\\Delta t}$, with $\\Delta t$ being the time step.\n\n### Task 1: Continuous-Time Physical Model Derivation\n\nThe dynamics of the flexible panel are described by the single-degree-of-freedom equation of motion:\n$$m \\ddot{\\xi}(t) + k \\xi(t) = A p(t)$$\nwhere $\\xi(t)$ is the panel displacement, $m$ is the mass, $k$ is the stiffness, $A$ is the area, and $p(t)$ is the interface pressure. The interface velocity is $v(t) = \\dot{\\xi}(t)$.\n\nIn the frequency domain, these become:\n$$V(\\omega) = i\\omega \\Xi(\\omega) \\quad \\implies \\quad \\Xi(\\omega) = \\frac{V(\\omega)}{i\\omega}$$\n$$(i\\omega)^2 = -\\omega^2$$\nSubstituting these into the equation of motion gives:\n$$m(-\\omega^2) \\frac{V(\\omega)}{i\\omega} + k \\frac{V(\\omega)}{i\\omega} = A P(\\omega)$$\n$$\\left( k - m\\omega^2 \\right) \\frac{V(\\omega)}{i\\omega} = A P(\\omega)$$\nThe continuous-time frequency response, or admittance, $H_{\\text{cont}}(\\omega) = V(\\omega)/P(\\omega)$ is:\n$$H_{\\text{cont}}(\\omega) = \\frac{i\\omega A}{k - m\\omega^2}$$\nNext, we derive the reflection coefficient $R_{\\text{phys}}(\\omega) = U_{\\text{ref}}(\\omega) / U_{\\text{inc}}(\\omega)$. The interface relations are:\n$$V(\\omega) = U_{\\text{inc}}(\\omega) + U_{\\text{ref}}(\\omega) \\quad (1)$$\n$$P(\\omega) = \\rho c \\left(U_{\\text{inc}}(\\omega) - U_{\\text{ref}}(\\omega)\\right) \\quad (2)$$\nwhere $\\rho$ is the fluid density and $c$ is the speed of sound. From $(1)$, we have $U_{\\text{ref}}(\\omega) = V(\\omega) - U_{\\text{inc}}(\\omega)$. Substituting this into $(2)$:\n$$P(\\omega) = \\rho c \\left(U_{\\text{inc}}(\\omega) - (V(\\omega) - U_{\\text{inc}}(\\omega))\\right) = \\rho c \\left(2U_{\\text{inc}}(\\omega) - V(\\omega)\\right)$$\nUsing the admittance relation $V(\\omega) = H_{\\text{cont}}(\\omega) P(\\omega)$, we can write:\n$$P(\\omega) = \\rho c \\left(2U_{\\text{inc}}(\\omega) - H_{\\text{cont}}(\\omega) P(\\omega)\\right)$$\n$$P(\\omega) \\left(1 + \\rho c H_{\\text{cont}}(\\omega)\\right) = 2 \\rho c U_{\\text{inc}}(\\omega)$$\nSolving for $V(\\omega)$:\n$$V(\\omega) = H_{\\text{cont}}(\\omega) P(\\omega) = \\frac{2 \\rho c H_{\\text{cont}}(\\omega)}{1 + \\rho c H_{\\text{cont}}(\\omega)} U_{\\text{inc}}(\\omega)$$\nFinally, solving for the reflection coefficient:\n$$R_{\\text{phys}}(\\omega) = \\frac{U_{\\text{ref}}(\\omega)}{U_{\\text{inc}}(\\omega)} = \\frac{V(\\omega) - U_{\\text{inc}}(\\omega)}{U_{\\text{inc}}(\\omega)} = \\frac{2 \\rho c H_{\\text{cont}}(\\omega)}{1 + \\rho c H_{\\text{cont}}(\\omega)} - 1$$\n$$R_{\\text{phys}}(\\omega) = \\frac{2 \\rho c H_{\\text{cont}}(\\omega) - \\left(1 + \\rho c H_{\\text{cont}}(\\omega)\\right)}{1 + \\rho c H_{\\text{cont}}(\\omega)} = \\frac{\\rho c H_{\\text{cont}}(\\omega) - 1}{1 + \\rho c H_{\\text{cont}}(\\omega)}$$\n\n### Task 2: Partitioned Explicit Scheme Derivation\n\nThe discrete equations for the partitioned scheme are:\n$$ \\xi^n = \\xi^{n-1} + \\Delta t\\, v^{n-1} \\quad (3) $$\n$$ v^n = v^{n-1} + \\frac{\\Delta t}{m}\\big(A p^n - k \\xi^{n-1}\\big) \\quad (4) $$\n$$ p^n = \\rho c \\big(2 u_{\\text{inc}}^n - v^{n-1}\\big) \\quad (5) $$\nWe assume harmonic signals of the form $q^n = Q z^n$, where $z=e^{i\\omega\\Delta t}$. Applying this to equations $(3)$ and $(4)$:\nFrom $(3)$: $\\Xi z^n - \\Xi z^{n-1} = \\Delta t V z^{n-1} \\implies \\Xi z^{n-1}(z-1) = \\Delta t V z^{n-1} \\implies \\Xi(z-1) = \\Delta t V \\implies \\Xi = \\frac{\\Delta t}{z-1} V$.\nFrom $(4)$: $V z^n - V z^{n-1} = \\frac{\\Delta t}{m}(A P z^n - k \\Xi z^{n-1})$. Dividing by $z^{n-1}$:\n$$V(z-1) = \\frac{\\Delta t}{m}(A P z - k \\Xi)$$\nSubstituting the expression for $\\Xi$:\n$$V(z-1) = \\frac{\\Delta t}{m} \\left(A P z - k \\frac{\\Delta t}{z-1} V\\right)$$\n$$V\\left[(z-1) + \\frac{k (\\Delta t)^2}{m(z-1)}\\right] = \\frac{A \\Delta t z}{m} P$$\n$$V\\left[\\frac{(z-1)^2 + \\frac{k}{m}(\\Delta t)^2}{z-1}\\right] = \\frac{A \\Delta t z}{m} P$$\nThe discrete transfer function $H_{\\text{part}}(z) = V/P$ is:\n$$H_{\\text{part}}(z) = \\frac{A \\Delta t z}{m} \\frac{z-1}{(z-1)^2 + \\frac{k}{m}(\\Delta t)^2}$$\nNext, we derive the discrete reflection coefficient. From $(5)$:\n$$P z^n = \\rho c (2 U_{\\text{inc}} z^n - V z^{n-1}) \\implies P = \\rho c (2 U_{\\text{inc}} - V z^{-1})$$\nThe kinematic relation $v^n = u_{\\text{inc}}^n + u_{\\text{ref}}^n$ gives $V=U_{\\text{inc}}+U_{\\text{ref}}$ at any time step.\nUsing $V = H_{\\text{part}}(z) P$:\n$$P = \\rho c (2 U_{\\text{inc}} - H_{\\text{part}}(z) P z^{-1})$$\n$$P \\left(1 + \\rho c z^{-1} H_{\\text{part}}(z)\\right) = 2 \\rho c U_{\\text{inc}}$$\n$$V = H_{\\text{part}}(z)P = \\frac{2 \\rho c H_{\\text{part}}(z)}{1 + \\rho c z^{-1} H_{\\text{part}}(z)} U_{\\text{inc}}$$\n$$R_{\\text{part}}(\\omega) = \\frac{V - U_{\\text{inc}}}{U_{\\text{inc}}} = \\frac{2 \\rho c H_{\\text{part}}(z)}{1 + \\rho c z^{-1} H_{\\text{part}}(z)} - 1 = \\frac{2 \\rho c H_{\\text{part}}(z) - (1 + \\rho c z^{-1} H_{\\text{part}}(z))}{1 + \\rho c z^{-1} H_{\\text{part}}(z)}$$\n$$R_{\\text{part}}(\\omega) = \\frac{\\rho c H_{\\text{part}}(z) (2 - z^{-1}) - 1}{1 + \\rho c z^{-1} H_{\\text{part}}(z)}$$\n\n### Task 3: Monolithic Trapezoidal Scheme Derivation\n\nThe discrete equations for the monolithic scheme are:\n$$ m \\frac{v^n - v^{n-1}}{\\Delta t} = \\frac{A}{2}\\big(p^n + p^{n-1}\\big) - \\frac{k}{2}\\big(\\xi^n + \\xi^{n-1}\\big) \\quad (6) $$\n$$ \\xi^n - \\xi^{n-1} = \\frac{\\Delta t}{2}\\big(v^n + v^{n-1}\\big) \\quad (7) $$\n$$ p^n = \\rho c \\big(2 u_{\\text{inc}}^n - v^n\\big) \\quad (8) $$\nApplying the harmonic signal assumption to $(6)$ and $(7)$:\nFrom $(7)$: $\\Xi(z-1) = \\frac{\\Delta t}{2}V(z+1) \\implies \\Xi = V \\frac{\\Delta t}{2} \\frac{z+1}{z-1}$.\nFrom $(6)$: $m \\frac{V(z-1)}{\\Delta t} = \\frac{A}{2}P(z+1) - \\frac{k}{2}\\Xi(z+1)$.\nSubstitute $\\Xi$:\n$$ m \\frac{V(z-1)}{\\Delta t} = \\frac{A}{2}P(z+1) - \\frac{k}{2} \\left(V \\frac{\\Delta t}{2} \\frac{z+1}{z-1}\\right) (z+1) $$\n$$ V \\left[ \\frac{m(z-1)}{\\Delta t} + \\frac{k \\Delta t (z+1)^2}{4(z-1)} \\right] = P \\frac{A(z+1)}{2} $$\n$$ V \\left[ \\frac{4m(z-1)^2 + k (\\Delta t)^2 (z+1)^2}{4 \\Delta t (z-1)} \\right] = P \\frac{A(z+1)}{2} $$\nThe discrete transfer function $H_{\\text{mono}}(z) = V/P$ is:\n$$H_{\\text{mono}}(z) = \\frac{A(z+1)}{2} \\frac{4 \\Delta t (z-1)}{4m(z-1)^2 + k (\\Delta t)^2 (z+1)^2} = \\frac{2 A \\Delta t (z^2-1)}{4m(z-1)^2 + k (\\Delta t)^2 (z+1)^2}$$\nNext, we derive the corresponding reflection coefficient. From $(8)$:\n$$P z^n = \\rho c (2 U_{\\text{inc}} z^n - V z^n) \\implies P = \\rho c (2 U_{\\text{inc}} - V)$$\nThis relation is identical in form to the continuous case. Therefore, following the same derivation as in Task $1$, we find:\n$$R_{\\text{mono}}(\\omega) = \\frac{\\rho c H_{\\text{mono}}(z) - 1}{1 + \\rho c H_{\\text{mono}}(z)}$$\nThis form highlights that the monolithic scheme preserves the structure of the physical impedance relationship, with the numerical error being confined to the approximation of the system's admittance, $H_{\\text{mono}}(z) \\approx H_{\\text{cont}}(\\omega)$.\n\n### Task 4: Error Metrics\n\nThe spurious-reflection errors for the partitioned and monolithic schemes are defined as the magnitude of the difference between the discrete and physical reflection coefficients:\n$$E_{\\text{part}} = \\left|R_{\\text{part}}(\\omega) - R_{\\text{phys}}(\\omega)\\right|$$\n$$E_{\\text{mono}} = \\left|R_{\\text{mono}}(\\omega) - R_{\\text{phys}}(\\omega)\\right|$$\nThe improvement factor, $I$, is the ratio of these errors, which quantifies the relative accuracy of the monolithic scheme compared to the partitioned one for this problem:\n$$I = \\frac{E_{\\text{part}}}{E_{\\text{mono}}}$$\nA value $I > 1$ indicates that the monolithic scheme produces a smaller spurious reflection error. The following program implements these formulas to compute $I$ for the given test cases.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the improvement factor of a monolithic vs. partitioned FSI coupling scheme\n    for five different test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (rho, c, A, m, k, dt, f, omega_expr)\n        {'rho': 1.2, 'c': 340, 'A': 1.0, 'm': 2.0, 'k': 5e4, 'dt': 5e-4, 'f': 80, 'omega_expr': None},\n        {'rho': 1.2, 'c': 340, 'A': 1.0, 'm': 1.0, 'k': 1e5, 'dt': 1e-3, 'f': None, 'omega_expr': 'sqrt(k/m)'},\n        {'rho': 1.2, 'c': 340, 'A': 1.0, 'm': 2.0, 'k': 5e4, 'dt': 1e-4, 'f': None, 'omega_expr': '0.8*pi/dt'},\n        {'rho': 1000, 'c': 1500, 'A': 1.0e-2, 'm': 0.2, 'k': 1e5, 'dt': 2e-4, 'f': 500, 'omega_expr': None},\n        {'rho': 1.2, 'c': 340, 'A': 1.0, 'm': 0.5, 'k': 1e7, 'dt': 5e-5, 'f': 2000, 'omega_expr': None},\n    ]\n\n    improvement_factors = []\n    \n    for case in test_cases:\n        rho, c, A, m, k, dt = case['rho'], case['c'], case['A'], case['m'], case['k'], case['dt']\n        f, omega_expr = case['f'], case['omega_expr']\n\n        if f is not None:\n            omega = 2 * np.pi * f\n        elif omega_expr == 'sqrt(k/m)':\n            omega = np.sqrt(k / m)\n        elif omega_expr == '0.8*pi/dt':\n            omega = 0.8 * np.pi / dt\n        else:\n            raise ValueError(\"Invalid case setup for omega calculation.\")\n\n        # Use 1j for imaginary unit\n        j = 1j\n\n        # Task 1: Continuous-time physical model (R_phys)\n        H_cont_denom = k - m * omega**2\n        \n        # At resonance (omega = sqrt(k/m)), H_cont is infinite and R_phys limits to 1.\n        if np.isclose(H_cont_denom, 0):\n            R_phys = 1.0 + 0.0j\n        else:\n            H_cont = (j * omega * A) / H_cont_denom\n            R_phys = (rho * c * H_cont - 1) / (rho * c * H_cont + 1)\n\n        # Common discrete-time variable z\n        z = np.exp(j * omega * dt)\n\n        # Task 2: Partitioned explicit scheme (R_part)\n        H_part_denom = (z - 1)**2 + (k / m) * dt**2\n        H_part = (A * dt / m) * (z * (z - 1)) / H_part_denom\n        R_part_num = rho * c * H_part * (2 - 1/z) - 1\n        R_part_den = 1 + rho * c * (1/z) * H_part\n        R_part = R_part_num / R_part_den\n\n        # Task 3: Monolithic trapezoidal scheme (R_mono)\n        H_mono_denom = 4 * m * (z - 1)**2 + k * dt**2 * (z + 1)**2\n        H_mono = (2 * A * dt * (z**2 - 1)) / H_mono_denom\n        R_mono = (rho * c * H_mono - 1) / (rho * c * H_mono + 1)\n\n        # Task 4: Errors and improvement factor\n        E_part = np.abs(R_part - R_phys)\n        E_mono = np.abs(R_mono - R_phys)\n\n        # The improvement factor I = E_part / E_mono\n        if np.isclose(E_mono, 0.0):\n            # If mono error is zero (or near-zero), improvement is effectively infinite if part has error.\n            # If both are zero, improvement is 1 (no difference).\n            improvement_factor = 1.0 if np.isclose(E_part, 0.0) else np.inf\n        else:\n            improvement_factor = E_part / E_mono\n            \n        improvement_factors.append(improvement_factor)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, improvement_factors))}]\")\n\nsolve()\n```"
        }
    ]
}