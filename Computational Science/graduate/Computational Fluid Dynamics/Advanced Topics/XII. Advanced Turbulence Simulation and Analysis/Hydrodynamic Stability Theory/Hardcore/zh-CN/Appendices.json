{
    "hands_on_practices": [
        {
            "introduction": "在深入研究流体动力学中复杂的Navier-Stokes方程之前，通过分析一个简化的“玩具模型”来掌握核心概念是非常有益的。这个练习使用一个一维的平流-扩散-反应方程，清晰地展示了时间稳定性和空间稳定性之间的区别。通过这个模型，我们可以理解一个扰动是如何在固定的位置随时间增长（时间不稳定性），或者在固定的时间随空间演化（空间不稳定性），这两种分析视角是稳定性理论的基石。",
            "id": "3331813",
            "problem": "考虑扰动包络 $A(x,t)$ 的一维线性化平流-扩散-反应模型，\n$$\n\\frac{\\partial A}{\\partial t} + U\\,\\frac{\\partial A}{\\partial x} = \\mu\\,A + D\\,\\frac{\\partial^2 A}{\\partial x^2},\n$$\n其中 $U0$ 是常数平流速度，$D0$ 是常数扩散系数，$\\mu$ 是常数实增长参数。假设正规模形式为 $A(x,t)=\\hat{A}\\,\\exp\\!\\big(i(\\alpha x-\\omega t)\\big)$，其中 $\\alpha\\in\\mathbb{C}$ 和 $\\omega\\in\\mathbb{C}$ 分别是复波数和复频率。\n\n从这个偏微分方程和正规模拟设出发，推导连接 $\\omega$ 和 $\\alpha$ 的色散关系。然后，对于无量纲参数集 $U=1$，$D=1$ 和 $\\mu=0.1$，执行以下操作：\n\n1) 固定实波数的时间分析：取实波数 $\\alpha=\\alpha_r=0.5$，并计算时间增长率 $\\omega_i=\\operatorname{Im}(\\omega)$。\n\n2) 固定实频率的空间分析：取实频率 $\\omega=\\omega_r=0$，通过求解 $\\omega\\in\\mathbb{R}$ 时的色散关系得到 $\\alpha$，计算空间增长率 $\\alpha_i=\\operatorname{Im}(\\alpha)$，选择以正群速 $c_g=\\partial \\omega_r/\\partial \\alpha_r0$ 为特征的向下游传播的分支。\n\n判断扰动是时间不稳定的（如果在指定的实数 $\\alpha$ 下 $\\omega_i0$）还是空间不稳定的（如果在指定的实数 $\\omega$ 下，选定的 $\\alpha_i0$）。定义不稳定性指标 $U_{\\text{code}}$ 如下：\n- 如果仅时间不稳定，$U_{\\text{code}}=1$，\n- 如果仅空间不稳定，$U_{\\text{code}}=2$，\n- 如果既时间不稳定又空间不稳定，$U_{\\text{code}}=3$，\n- 如果既非时间不稳定也非空间不稳定，$U_{\\text{code}}=0$。\n\n将您的最终答案以行矩阵 $\\big(\\omega_i,\\ \\alpha_i,\\ U_{\\text{code}}\\big)$ 的形式报告。所有变量都是无量纲的，因此不需要单位。请提供精确值，不要四舍五入。",
            "solution": "该问题陈述构成了流体动力学稳定性理论领域中一个有效、适定的问题。它具有科学依据，内容自洽，且没有矛盾或含糊之处。因此，我将给出完整的解答。\n\n扰动包络 $A(x,t)$ 的控制偏微分方程由下式给出：\n$$\n\\frac{\\partial A}{\\partial t} + U\\,\\frac{\\partial A}{\\partial x} = \\mu\\,A + D\\,\\frac{\\partial^2 A}{\\partial x^2}\n$$\n其中 $U0$ 是平流速度，$D0$ 是扩散系数，$\\mu$ 是实增长参数。\n\n我们假设一个正规模解的形式为：\n$$\nA(x,t) = \\hat{A}\\,\\exp\\big(i(\\alpha x-\\omega t)\\big)\n$$\n其中 $\\alpha \\in \\mathbb{C}$ 是复波数，$\\omega \\in \\mathbb{C}$ 是复频率。为了找到色散关系，我们计算 $A(x,t)$ 的偏导数：\n$$\n\\frac{\\partial A}{\\partial t} = -i\\omega \\hat{A}\\,\\exp\\big(i(\\alpha x-\\omega t)\\big) = -i\\omega A\n$$\n$$\n\\frac{\\partial A}{\\partial x} = i\\alpha \\hat{A}\\,\\exp\\big(i(\\alpha x-\\omega t)\\big) = i\\alpha A\n$$\n$$\n\\frac{\\partial^2 A}{\\partial x^2} = (i\\alpha)^2 \\hat{A}\\,\\exp\\big(i(\\alpha x-\\omega t)\\big) = -\\alpha^2 A\n$$\n将这些表达式代入控制偏微分方程，我们得到：\n$$\n(-i\\omega) A + U (i\\alpha) A = \\mu A + D (-\\alpha^2) A\n$$\n对于非平凡解（$A \\neq 0$），我们可以两边同除以 $A$ 来获得连接 $\\omega$ 和 $\\alpha$ 的代数色散关系：\n$$\n-i\\omega + iU\\alpha = \\mu - D\\alpha^2\n$$\n这个关系可以重排，以解出作为 $\\alpha$ 函数的 $\\omega$：\n$$\ni\\omega = iU\\alpha - \\mu + D\\alpha^2\n$$\n$$\n\\omega(\\alpha) = U\\alpha + i(\\mu - D\\alpha^2)\n$$\n这就是色散关系。\n\n问题指定了无量纲参数集 $U=1$，$D=1$ 和 $\\mu=0.1$。\n\n**1) 固定实波数的时间分析**\n\n在时间分析中，波数 $\\alpha$ 被假定为实数，即 $\\alpha = \\alpha_r$，并计算复频率 $\\omega = \\omega_r + i\\omega_i$。虚部 $\\omega_i = \\operatorname{Im}(\\omega)$ 的符号决定了稳定性。如果 $\\omega_i > 0$，扰动随时间增长，对应于时间不稳定性。\n\n给定 $\\alpha = \\alpha_r = 0.5$。将参数和 $\\alpha$ 代入色散关系：\n$$\n\\omega = (1)(0.5) + i(0.1 - (1)(0.5)^2)\n$$\n$$\n\\omega = 0.5 + i(0.1 - 0.25)\n$$\n$$\n\\omega = 0.5 - 0.15i\n$$\n时间增长率是 $\\omega$ 的虚部：\n$$\n\\omega_i = -0.15 = -\\frac{15}{100} = -\\frac{3}{20}\n$$\n由于 $\\omega_i  0$，扰动是时间稳定的。\n\n**2) 固定实频率的空间分析**\n\n在空间分析中，频率 $\\omega$ 被假定为实数，即 $\\omega = \\omega_r$，并计算复波数 $\\alpha = \\alpha_r + i\\alpha_i$。虚部 $\\alpha_i = \\operatorname{Im}(\\alpha)$ 的符号决定了空间上的增长或衰减。扰动振幅随空间以 $\\exp(-α_i x)$ 的形式变化。如果 $\\alpha_i  0$，振幅在正 $x$ 方向（对于 $U>0$ 为下游）增长，对应于空间不稳定性。\n\n给定 $\\omega = \\omega_r = 0$。我们将此值和参数代入色散关系 $-i\\omega + iU\\alpha = \\mu - D\\alpha^2$：\n$$\n-i(0) + i(1)\\alpha = 0.1 - (1)\\alpha^2\n$$\n$$\ni\\alpha = 0.1 - \\alpha^2\n$$\n这可以重排成一个关于 $\\alpha$ 的二次方程：\n$$\n\\alpha^2 + i\\alpha - 0.1 = 0\n$$\n我们使用二次公式 $\\alpha = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$ 求解 $\\alpha$，其中 $a=1$，$b=i$，$c=-0.1$：\n$$\n\\alpha = \\frac{-i \\pm \\sqrt{(i)^2 - 4(1)(-0.1)}}{2}\n$$\n$$\n\\alpha = \\frac{-i \\pm \\sqrt{-1 + 0.4}}{2}\n$$\n$$\n\\alpha = \\frac{-i \\pm \\sqrt{-0.6}}{2} = \\frac{-i \\pm i\\sqrt{0.6}}{2}\n$$\n让我们将 $\\sqrt{0.6}$ 表示为有理形式：$\\sqrt{0.6} = \\sqrt{\\frac{6}{10}} = \\sqrt{\\frac{3}{5}} = \\frac{\\sqrt{3}}{\\sqrt{5}} = \\frac{\\sqrt{15}}{5}$。\n$$\n\\alpha = \\frac{-i \\pm i\\frac{\\sqrt{15}}{5}}{2}\n$$\n这给出了 $\\alpha$ 的两个根：\n$$\n\\alpha_1 = \\frac{-i + i\\frac{\\sqrt{15}}{5}}{2} = i\\left(\\frac{\\sqrt{15}-5}{10}\\right)\n$$\n$$\n\\alpha_2 = \\frac{-i - i\\frac{\\sqrt{15}}{5}}{2} = -i\\left(\\frac{\\sqrt{15}+5}{10}\\right)\n$$\n我们必须选择向下游传播的分支，其特征是正群速，$c_g = \\frac{\\partial \\omega_r}{\\partial \\alpha_r} > 0$。复群速可以通过对色散关系 $\\omega(\\alpha)$ 求导得到：\n$$\n\\frac{d\\omega}{d\\alpha} = \\frac{d}{d\\alpha}\\left(U\\alpha + i(\\mu - D\\alpha^2)\\right) = U - 2iD\\alpha\n$$\n这个复群速的实部 $\\operatorname{Re}(\\frac{d\\omega}{d\\alpha})$ 决定了波包包络的传播速度。对于 $\\alpha = \\alpha_r + i\\alpha_i$，这个实部是 $\\operatorname{Re}(U - 2iD(\\alpha_r + i\\alpha_i)) = U + 2D\\alpha_i$。我们对每个根计算这个值，其中 $U=1$ 和 $D=1$。两个根的 $\\alpha_r$ 都为 0。\n\n对于 $\\alpha_1$：$\\alpha_i = \\frac{\\sqrt{15}-5}{10}$。\n$$\n\\operatorname{Re}\\left(\\frac{d\\omega}{d\\alpha}\\right)_1 = 1 + 2(1)\\left(\\frac{\\sqrt{15}-5}{10}\\right) = 1 + \\frac{\\sqrt{15}-5}{5} = \\frac{5 + \\sqrt{15} - 5}{5} = \\frac{\\sqrt{15}}{5}\n$$\n由于 $\\sqrt{15} > 0$，这个速度是正的。\n\n对于 $\\alpha_2$：$\\alpha_i = -\\frac{\\sqrt{15}+5}{10}$。\n$$\n\\operatorname{Re}\\left(\\frac{d\\omega}{d\\alpha}\\right)_2 = 1 + 2(1)\\left(-\\frac{\\sqrt{15}+5}{10}\\right) = 1 - \\frac{\\sqrt{15}+5}{5} = \\frac{5 - \\sqrt{15} - 5}{5} = -\\frac{\\sqrt{15}}{5}\n$$\n这个速度是负的。\n\n向下游传播的分支对应于正群速，所以我们选择 $\\alpha_1$。空间增长率是 $\\alpha_1$ 的虚部：\n$$\n\\alpha_i = \\frac{\\sqrt{15}-5}{10}\n$$\n由于 $\\sqrt{15} \\approx 3.873$，我们有 $\\sqrt{15}-5  0$，因此 $\\alpha_i  0$。这表明扰动是空间不稳定的（它在正 $x$ 方向上增长）。\n\n**3) 不稳定性分类**\n\n- 时间分析得出 $\\omega_i = -3/20 \\le 0$，表明时间稳定。\n- 空间分析得出 $\\alpha_i = (\\sqrt{15}-5)/10  0$，表明空间不稳定。\n\n根据所提供的 $U_{\\text{code}}$ 定义：\n- 系统不是时间不稳定的。\n- 系统是空间不稳定的。\n这对应于“仅空间不稳定”的情况。因此，$U_{\\text{code}} = 2$。\n\n最终答案是行矩阵 $(\\omega_i, \\alpha_i, U_{\\text{code}})$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -\\frac{3}{20}  \\frac{\\sqrt{15}-5}{10}  2 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在通过简化模型理解了稳定性的基本概念之后，下一步是处理真实流动的完整问题。本练习的核心任务是为经典的平面泊肃叶流（plane Poiseuille flow）推导出著名的Orr–Sommerfeld方程。这个推导是平行剪切流线性稳定性理论的基石，它将由Navier-Stokes方程描述的物理问题转化为一个可以求解的数学特征值问题，是理论分析的关键一步。",
            "id": "3331850",
            "problem": "考虑一不可压缩的粘性流体，其密度和运动粘度 $\\nu$ 均为常数，被限制在位于 $y=-1$ 和 $y=1$ 的两个平行板之间。层流基本流是沿流向坐标 $x$ 的平面泊肃叶剖面 $U(y)=1-y^{2}$。设流体满足围绕基本流线性化的不可压缩纳维-斯托克斯方程和连续性方程。假设无穷小扰动具有流向-展向简正模的形式，其壁面法向速度振幅为 $v(y)$，时空依赖关系为 $\\exp\\!\\left(i\\alpha x + i\\beta z - i\\omega t\\right)$，其中 $\\alpha$ 是流向波数，$\\beta$ 是展向波数，$\\omega$ 是复时间频率。定义雷诺数 $\\mathrm{Re}$，其基于通道半高和特征速度尺度，并令 $D \\equiv \\frac{d}{dy}$，$k^{2} \\equiv \\alpha^{2}+\\beta^{2}$，以及复相速度 $c \\equiv \\omega/\\alpha$。\n\n从线性化的不可压缩纳维-斯托克斯方程和连续性方程出发，消去压力和流向/展向速度扰动，以获得关于 $v(y)$ 的标量特征值问题，即著名的奥尔-索末菲方程。根据此推导，将奥尔-索末菲算子 $\\mathcal{L}_{\\mathrm{OS}}$ 写成标准广义特征值形式\n$$\n\\left[\\mathcal{L}_{\\mathrm{OS}}\\right] v \\;=\\; -\\,c\\,\\left(D^{2}-k^{2}\\right) v,\n$$\n并将给定的基本流 $U(y)=1-y^{2}$ 的所有相关性显式地代入。同时，指明由不可穿透和无滑移边界条件得出的在两壁面 $y=\\pm 1$ 处关于 $v$ 和 $Dv$ 的边界条件。\n\n你的最终答案必须是一个单一的闭合形式解析表达式，其中包含算子（已代入 $U(y)$）和边界条件。不需要进行数值计算。将 $D$ 表示为 $d/dy$，并保持 $\\alpha$、$\\beta$、$k$ 和 $\\mathrm{Re}$ 为符号形式。",
            "solution": "用户希望针对特定的流动剖面推导奥尔-索末菲方程，并以标准的广义特征值形式及其边界条件呈现。\n\n### 步骤1：问题验证\n\n**1.1. 提取已知条件**\n- **流体：** 不可压缩，密度恒定，运动粘度 $\\nu$ 恒定。\n- **几何：** 限制在位于 $y=-1$ 和 $y=1$ 的两个平行板之间。\n- **基本流：** 流向 ($x$) 上的平面泊肃叶剖面 $U(y) = 1-y^2$。\n- **控制方程：** 线性化的不可压缩纳维-斯托克斯方程和连续性方程。\n- **扰动形式：** 流向-展向简正模，形式为 $\\exp(i\\alpha x + i\\beta z - i\\omega t)$。壁面法向速度扰动振幅记为 $v(y)$。\n- **定义：**\n    - 雷诺数：$\\mathrm{Re}$（基于通道半高和中心线速度）。\n    - 算子：$D \\equiv \\frac{d}{dy}$。\n    - 波数平方：$k^2 \\equiv \\alpha^2 + \\beta^2$。\n    - 复相速度：$c \\equiv \\omega/\\alpha$。\n- **任务：**\n    1. 推导关于 $v(y)$ 的奥尔-索末菲方程。\n    2. 将奥尔-索末菲算子 $\\mathcal{L}_{\\mathrm{OS}}$ 写成 $[\\mathcal{L}_{\\mathrm{OS}}] v = -c(D^2 - k^2)v$ 的形式，并代入具体的基本流 $U(y)=1-y^2$。\n    3. 指明在 $y=\\pm 1$ 处对应于不可穿透、无滑移壁面的关于 $v$ 和 $Dv$ 的边界条件。\n    4. 最终答案必须是包含算子和边界条件的单个表达式。\n\n**1.2. 验证**\n该问题是流体力学稳定性领域的一个标准推导，该领域是流体力学和计算流体动力学的一个子学科。\n- **科学依据：** 该问题基于流体力学的基本原理，特别是纳维-斯托克斯方程的稳定性分析。奥尔-索末菲方程是该理论的基石。该设置在科学上和事实上都是合理的。\n- **适定性：** 提供了所有必要的信息（基本流、扰动形式、边界类型、控制方程）。任务是执行一个标准的、尽管不平凡的推导，从而得到算子和边界条件的唯一解析表达式。\n- **客观性：** 该问题使用流体力学领域精确、标准且无偏见的术语进行陈述。\n\n该问题没有表现出说明中列出的任何无效性缺陷。它是一个有效、适定且科学上合理的问题。\n\n### 步骤2：奥尔-索末菲方程的推导\n\n我们从叠加在基本流 $\\mathbf{U} = (U(y), 0, 0)$ 上的扰动 $(\\mathbf{u}', p') = (u,v,w,p)$ 的无量纲线性化不可压缩纳维-斯托克斯方程和连续性方程开始：\n$$\n\\frac{\\partial u}{\\partial t} + U \\frac{\\partial u}{\\partial x} + v \\frac{dU}{dy} = - \\frac{\\partial p}{\\partial x} + \\frac{1}{\\mathrm{Re}} \\nabla^2 u\n$$\n$$\n\\frac{\\partial v}{\\partial t} + U \\frac{\\partial v}{\\partial x} = - \\frac{\\partial p}{\\partial y} + \\frac{1}{\\mathrm{Re}} \\nabla^2 v\n$$\n$$\n\\frac{\\partial w}{\\partial t} + U \\frac{\\partial w}{\\partial x} = - \\frac{\\partial p}{\\partial z} + \\frac{1}{\\mathrm{Re}} \\nabla^2 w\n$$\n$$\n\\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y} + \\frac{\\partial w}{\\partial z} = 0\n$$\n雷诺数是 $\\mathrm{Re} = U_c h / \\nu$，其中 $U_c$ 是中心线速度，$h$ 是通道半高。对于给定的无量纲流动 $U(y)=1-y^2$，我们有 $U_c=1$ 和 $h=1$。\n\n我们引入简正模扰动，其形式为：\n$$\n(u, v, w, p) = (\\hat{u}(y), \\hat{v}(y), \\hat{w}(y), \\hat{p}(y)) \\exp(i\\alpha x + i\\beta z - i\\omega t)\n$$\n根据问题陈述，我们将 $\\hat{v}(y)$ 简记为 $v(y)$。导数变换如下：\n$\\partial_t \\to -i\\omega$、$\\partial_x \\to i\\alpha$、$\\partial_z \\to i\\beta$、$\\partial_y \\to D$，以及 $\\nabla^2 \\to D^2 - \\alpha^2 - \\beta^2 = D^2 - k^2$。\n使用定义 $c=\\omega/\\alpha$，项 $(\\partial_t + U\\partial_x)$ 变为 $-i\\omega + i\\alpha U = i\\alpha(U-c)$。\n\n关于振幅的常微分方程组变为：\n$$\n(1) \\quad i\\alpha \\hat{u} + D v + i\\beta \\hat{w} = 0\n$$\n$$\n(2) \\quad i\\alpha(U-c)\\hat{u} + v U' = -i\\alpha \\hat{p} + \\frac{1}{\\mathrm{Re}}(D^2-k^2)\\hat{u}\n$$\n$$\n(3) \\quad i\\alpha(U-c)v = -D\\hat{p} + \\frac{1}{\\mathrm{Re}}(D^2-k^2)v\n$$\n$$\n(4) \\quad i\\alpha(U-c)\\hat{w} = -i\\beta \\hat{p} + \\frac{1}{\\mathrm{Re}}(D^2-k^2)\\hat{w}\n$$\n其中 $U' = dU/dy$。我们的目标是消去 $\\hat{u}$、$\\hat{w}$ 和 $\\hat{p}$，以获得一个关于 $v$ 的单一方程。\n\n从方程(3)，我们可以表示压力梯度 $D\\hat{p}$：\n$$\n(5) \\quad D\\hat{p} = -i\\alpha(U-c)v + \\frac{1}{\\mathrm{Re}}(D^2-k^2)v\n$$\n接下来，我们在方程(1)、(2)和(4)之间消去 $\\hat{u}$ 和 $\\hat{w}$，以找到 $\\hat{p}$ 的表达式。将(2)式乘以 $i\\alpha$，(4)式乘以 $i\\beta$，然后相加：\n$$\ni\\alpha(U-c)(i\\alpha\\hat{u} + i\\beta\\hat{w}) + i\\alpha v U' = - (i\\alpha)^2 \\hat{p} - (i\\beta)^2 \\hat{p} + \\frac{1}{\\mathrm{Re}}(D^2-k^2)(i\\alpha\\hat{u} + i\\beta\\hat{w})\n$$\n使用连续性方程(1)，$i\\alpha\\hat{u}+i\\beta\\hat{w} = -Dv$。代入此式：\n$$\ni\\alpha(U-c)(-Dv) + i\\alpha v U' = (\\alpha^2+\\beta^2)\\hat{p} + \\frac{1}{\\mathrm{Re}}(D^2-k^2)(-Dv)\n$$\n$$\n-i\\alpha(U-c)Dv + i\\alpha v U' = k^2\\hat{p} - \\frac{1}{\\mathrm{Re}}D(D^2-k^2)v\n$$\n求解 $k^2 \\hat{p}$：\n$$\n(6) \\quad k^2\\hat{p} = -i\\alpha(U-c)Dv + i\\alpha U'v + \\frac{1}{\\mathrm{Re}}D(D^2-k^2)v\n$$\n为了消去 $\\hat{p}$，我们对(6)式作用算子 $D$，并将(5)式中的 $D\\hat{p}$ 代入左侧（$D(k^2\\hat{p}) = k^2 D\\hat{p}$）：\n$$\nk^2\\left[-i\\alpha(U-c)v + \\frac{1}{\\mathrm{Re}}(D^2-k^2)v\\right] = D\\left[-i\\alpha(U-c)Dv + i\\alpha U'v + \\frac{1}{\\mathrm{Re}}D(D^2-k^2)v\\right]\n$$\n右侧的导数是：\n$$\n-i\\alpha(U'Dv + (U-c)D^2v) + i\\alpha(U''v + U'Dv) + \\frac{1}{\\mathrm{Re}}D^2(D^2-k^2)v\n$$\n$$\n= -i\\alpha(U-c)D^2v + i\\alpha U''v + \\frac{1}{\\mathrm{Re}}(D^4-k^2D^2)v\n$$\n令两侧相等：\n$$\n-i\\alpha k^2(U-c)v + \\frac{k^2}{\\mathrm{Re}}(D^2-k^2)v = -i\\alpha(U-c)D^2v + i\\alpha U''v + \\frac{1}{\\mathrm{Re}}(D^4-k^2D^2)v\n$$\n整理各项：\n$$\ni\\alpha(U-c)(D^2-k^2)v - i\\alpha U''v = \\frac{1}{\\mathrm{Re}}(D^4-2k^2D^2+k^4)v\n$$\n$$\ni\\alpha(U-c)(D^2-k^2)v - i\\alpha U''v = \\frac{1}{\\mathrm{Re}}(D^2-k^2)^2v\n$$\n这就是奥尔-索末菲方程。为了匹配所要求的形式 $[\\mathcal{L}_{\\mathrm{OS}}] v = -c(D^2 - k^2)v$，我们重新整理它，以分离出包含相速度 $c$ 的项：\n$$\n(i\\alpha U(D^2-k^2) - i\\alpha U'')v - \\frac{1}{\\mathrm{Re}}(D^2-k^2)^2v = i\\alpha c(D^2-k^2)v\n$$\n除以 $i\\alpha$：\n$$\n(U(D^2-k^2) - U'')v + \\frac{i}{\\alpha\\mathrm{Re}}(D^2-k^2)^2v = c(D^2-k^2)v\n$$\n乘以 $-1$ 以匹配所需形式：\n$$\n(-U(D^2-k^2) + U'')v - \\frac{i}{\\alpha\\mathrm{Re}}(D^2-k^2)^2v = -c(D^2-k^2)v\n$$\n因此，奥尔-索末菲算子 $\\mathcal{L}_{\\mathrm{OS}}$ 是：\n$$\n\\mathcal{L}_{\\mathrm{OS}} = -U(D^2-k^2) + U'' - \\frac{i}{\\alpha\\mathrm{Re}}(D^2-k^2)^2\n$$\n代入给定的基本流 $U(y)=1-y^2$，我们得到 $U'(y)=-2y$ 和 $U''(y)=-2$。\n$$\n\\mathcal{L}_{\\mathrm{OS}} = -(1-y^2)\\left(\\frac{d^2}{dy^2}-k^2\\right) - 2 - \\frac{i}{\\alpha\\mathrm{Re}}\\left(\\frac{d^2}{dy^2}-k^2\\right)^2\n$$\n\n### 步骤3：边界条件\n\n流体被限制在位于 $y=\\pm 1$ 的不可穿透、无滑移的壁面之间。\n- **无滑移条件：** 在壁面处，流体的切向速度分量必须为零。总速度为 $(U+u, v, w)$。由于壁面是静止的，$(U+u)|_{y=\\pm 1}=0$ 且 $w|_{y=\\pm 1}=0$。基本流 $U(y)=1-y^2$ 已经满足 $U(\\pm 1)=0$，因此扰动速度必须为零：$u(\\pm 1)=0$ 和 $w(\\pm 1)=0$。这意味着它们的振幅也为零：$\\hat{u}(\\pm 1)=0$ 和 $\\hat{w}(\\pm 1)=0$。\n- **不可穿透条件：** 在壁面处，法向速度分量必须为零：$v|_{y=\\pm 1}=0$。这直接给出了振幅 $v(y)$ 的边界条件：\n$$v(\\pm 1) = 0$$\n为了找到第二个边界条件，我们使用振幅的连续性方程：$i\\alpha \\hat{u} + Dv + i\\beta \\hat{w} = 0$。在壁面 $y=\\pm 1$ 处，由于 $\\hat{u}(\\pm 1)=0$ 和 $\\hat{w}(\\pm 1)=0$，连续性方程简化为：\n$$Dv(\\pm 1) = 0 \\quad \\implies \\quad \\frac{dv}{dy}(\\pm 1) = 0$$\n因此，四个边界条件是 $v(1)=0$，$v(-1)=0$，$dv/dy(1)=0$ 和 $dv/dy(-1)=0$。\n\n### 最终表达式\n\n按照要求，将推导出的算子和边界条件组合成一个单一的陈述。\n算子是：\n$$\n\\mathcal{L}_{\\mathrm{OS}} = -(1-y^2)\\left(\\frac{d^2}{dy^2}-k^2\\right) - 2 - \\frac{i}{\\alpha\\mathrm{Re}}\\left(\\frac{d^2}{dy^2}-k^2\\right)^2\n$$\n边界条件是：\n$$\nv(\\pm 1) = 0, \\quad \\frac{dv}{dy}(\\pm 1) = 0\n$$",
            "answer": "$$\n\\boxed{\n\\mathcal{L}_{\\mathrm{OS}} = -(1-y^2)\\left(\\frac{d^2}{dy^2}-k^2\\right) - 2 - \\frac{i}{\\alpha\\mathrm{Re}}\\left(\\frac{d^2}{dy^2}-k^2\\right)^2; \\quad v(\\pm 1)=0, \\frac{dv}{dy}(\\pm 1)=0\n}\n$$"
        },
        {
            "introduction": "虽然推导Orr–Sommerfeld方程是至关重要的理论步骤，但要获得定量的稳定性预测，则必须对其进行求解。由于该方程的解析解极为罕见，因此数值方法变得不可或缺。这项高级练习将指导您实现一种功能强大的谱配置法（spectral collocation method）来求解Orr–Sommerfeld方程，从而将抽象的理论与实际的、定量的稳定性分析联系起来，这是计算流体力学研究生的必备技能。",
            "id": "3331826",
            "problem": "考虑由线性化 Navier–Stokes 方程控制的不可压缩平行剪切流的时间线性稳定性，假设存在形式为 $\\exp(i \\alpha x - i \\omega t)$ 的二维扰动，其中 $\\alpha$ 是实数流向波数，$\\omega$ 是复数时间频率。基流是在壁面法向区间 $y \\in [-1, 1]$ 上定义的无量纲平面泊肃叶剖面 $U(y) = 1 - y^2$。壁面法向速度扰动 $v(y)$ 满足从线性化控制方程和不可压缩性推导出的 Orr–Sommerfeld 方程，以及无滑移边界条件，即 $v(\\pm 1) = 0$ 和 $Dv(\\pm 1) = 0$，其中 $D$ 表示对 $y$ 的微分。\n\n从线性化动量和连续性方程以及 Orr–Sommerfeld 算子的定义出发，当通过 Chebyshev 配置法离散化时，$v(y)$ 的时间 Orr–Sommerfeld 方程可以写成广义特征值形式 $A \\mathbf{x} = \\lambda B \\mathbf{x}$，其中 $\\mathbf{x}$ 是 $v(y)$ 的节点值向量，$\\lambda$ 是复相速度 $c = \\omega / \\alpha$，$A$ 和 $B$ 是表示离散算子的复数矩阵。设 $D$ 表示在 $N+1$ 个 Chebyshev–Gauss–Lobatto 点 $y_j = \\cos(\\pi j / N)$（$j = 0, 1, \\dots, N$）上的 Chebyshev 一阶微分矩阵，设 $D^2$ 为二阶微分矩阵。定义离散算子\n$$L_2 = D^2 - \\alpha^2 I, \\quad L_4 = L_2^2,$$\n其中 $I$ 是尺寸为 $(N+1) \\times (N+1)$ 的单位矩阵。对于平面泊肃叶基流 $U(y) = 1 - y^2$，有 $U''(y) = -2$。用 $\\operatorname{diag}(U)$ 表示在配置点上采样的基流的对角矩阵，用 $\\operatorname{diag}(U'')$ 表示在配置点上采样的 $U''$ 的对角矩阵。连续 Orr–Sommerfeld 方程\n$$(D^2 - \\alpha^2)^2 v + i \\alpha \\operatorname{Re} \\left[(U - c)(D^2 - \\alpha^2) v - U'' v\\right] = 0$$\n被离散化为广义特征值问题\n$$A \\mathbf{x} = c\\, B \\mathbf{x},$$\n其中\n$$A = L_4 + i \\alpha \\operatorname{Re} \\left(\\operatorname{diag}(U) L_2 - \\operatorname{diag}(U'')\\right), \\qquad B = i \\alpha \\operatorname{Re} \\, L_2.$$\n\n您的任务是编写一个完整、独立的程序，该程序：\n1. 构造 Chebyshev–Gauss–Lobatto 网格和相应的尺寸为 $(N+1) \\times (N+1)$ 的一阶微分矩阵 $D$，并通过矩阵乘法获得 $D^2$。\n2. 对于给定的 $\\alpha$ 和雷诺数 $\\operatorname{Re}$，构建离散算子 $L_2$ 和 $L_4$ 并组装如上定义的矩阵 $A$ 和 $B$。\n3. 如下所述，通过替换 $A$ 和 $B$ 中的特定行来施加边界条件 $v(\\pm 1) = 0$ 和 $Dv(\\pm 1) = 0$，以获得一个适定的广义特征值问题：\n   - 通过将 $A$ 的第 0 行替换为选取 $y=1$ 处值的行向量（即第一个标准基行向量），并把 $B$ 的第 0 行设置为零行，来强制 $v(1) = 0$。\n   - 通过将 $A$ 的第 $N$ 行替换为选取 $y=-1$ 处值的行向量（即最后一个标准基行向量），并把 $B$ 的第 $N$ 行设置为零行，来强制 $v(-1) = 0$。\n   - 通过将 $A$ 的第 1 行替换为微分矩阵 $D$ 的第 0 行（这对应于在 $y=1$ 处计算的导数），并把 $B$ 的第 1 行设置为零行，来强制 $Dv(1) = 0$。\n   - 通过将 $A$ 的第 $N-1$ 行替换为微分矩阵 $D$ 的第 $N$ 行（这对应于在 $y=-1$ 处计算的导数），并把 $B$ 的第 $N-1$ 行设置为零行，来强制 $Dv(-1) = 0$。\n4. 求解广义特征值问题 $A \\mathbf{x} = c B \\mathbf{x}$ 以获得复特征值 $c$。对于每个测试用例，计算由 $g = \\alpha \\,\\operatorname{Im}(c)$ 定义的无量纲时间增长率，其中 $\\operatorname{Im}(c)$ 表示 $c$ 的虚部，并取所有有限大小特征值中 $g$ 的最大值。\n5. 生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。每个数字必须是对应一个测试用例的最大增长率 $g$，表示为四舍五入到六位小数的十进制浮点数，单位为无量纲单位。\n\n使用以下参数值测试套件来评估并报告结果：\n- 情况 1 (一般情况，在足够大的 $\\operatorname{Re}$ 下预期不稳定): $N = 64$, $\\alpha = 1.0$, $\\operatorname{Re} = 10000$。\n- 情况 2 (较低波数和中等 $\\operatorname{Re}$): $N = 64$, $\\alpha = 0.5$, $\\operatorname{Re} = 5000$。\n- 情况 3 (高 $\\operatorname{Re}$ 下的较高波数): $N = 48$, $\\alpha = 2.0$, $\\operatorname{Re} = 10000$。\n- 情况 4 (小波数和非常高的 $\\operatorname{Re}$ 的边缘情况): $N = 40$, $\\alpha = 0.2$, $\\operatorname{Re} = 20000$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如：\"[0.123456,-0.000789,0.000000,0.004321]\"），其中每个条目是按上面列出的顺序对应测试用例的最大 $g$ 值，四舍五入到六位小数，单位为无量纲单位。本问题不使用角度，所有输出均为无单位的实数。",
            "solution": "该问题要求确定平面泊肃叶流中小的二维扰动的最大时间增长率。这是流体动力学稳定性理论中的一个经典问题。分析基于 Orr–Sommerfeld 方程，这是一个控制壁面法向速度扰动 $v(y)$ 演化的四阶常微分方程。该解是通过使用 Chebyshev 配置（谱）方法对该方程进行数值离散化得到的，该方法将微分特征值问题转换为广义矩阵特征值问题。\n\n基流是平面泊肃叶流，由域 $y \\in [-1, 1]$ 上的无量纲速度剖面 $U(y) = 1 - y^2$ 给出。扰动被假定为形式 $\\phi(x,y,t) = \\hat{\\phi}(y) e^{i(\\alpha x - \\omega t)}$，其中 $\\alpha$ 是实数流向波数，$\\omega = \\omega_r + i\\omega_i$ 是复角频率。扰动的时间增长率由 $g = \\omega_i = \\alpha \\operatorname{Im}(c)$ 给出，其中 $c = \\omega/\\alpha$ 是复相速度。正增长率（$g  0$）表示随时间增长的不稳定模态，而负增长率表示稳定的衰减模态。\n\n控制方程是壁面法向速度幅值 $v(y)$ 的 Orr–Sommerfeld 方程。当离散化时，它呈现广义特征值问题的形式：\n$$A \\mathbf{x} = c B \\mathbf{x}$$\n其中 $\\mathbf{x}$ 是在配置点处的扰动速度 $v$ 的向量，$c$ 是特征值。矩阵 $A$ 和 $B$ 是基于离散化的微分算子构建的。\n\n解决此问题的步骤如下：\n\n1.  **Chebyshev 配置和微分矩阵**：\n    该问题在 Chebyshev–Gauss–Lobatto 网格点上离散化，该网格点定义为 $y_j = \\cos(\\frac{\\pi j}{N})$（$j = 0, 1, \\dots, N$）。这种点的选择能够高精度地逼近函数及其导数。\n    第一步是构造 $(N+1) \\times (N+1)$ 的 Chebyshev 一阶微分矩阵 $D$。该矩阵的项由解析公式给出：\n    $$\n    D_{ij} =\n    \\begin{cases}\n    \\frac{c_i}{c_j} \\frac{(-1)^{i+j}}{y_i - y_j}  i \\neq j \\\\\n    -\\frac{y_j}{2(1-y_j^2)}  1 \\le j \\le N-1 \\\\\n    \\frac{2N^2+1}{6}  i=j=0 \\\\\n    -\\frac{2N^2+1}{6}  i=j=N\n    \\end{cases}\n    $$\n    其中 $c_0 = c_N = 2$ 且 $c_j = 1$（$1 \\le j \\le N-1$）。然后通过矩阵乘法计算二阶微分矩阵 $D^2$：$D^2 = D \\cdot D$。\n\n2.  **系统矩阵的组装**：\n    离散算子 $L_2$ 和 $L_4$ 定义为：\n    $$L_2 = D^2 - \\alpha^2 I$$\n    $$L_4 = L_2^2 = (D^2 - \\alpha^2 I)^2$$\n    其中 $I$ 是尺寸为 $(N+1) \\times (N+1)$ 的单位矩阵。广义特征值问题的矩阵 $A$ 和 $B$ 定义为：\n    $$A = L_4 + i \\alpha \\operatorname{Re} \\left( \\operatorname{diag}(U) L_2 - \\operatorname{diag}(U'') \\right)$$\n    $$B = i \\alpha \\operatorname{Re} L_2$$\n    此处，$\\operatorname{diag}(U)$ 是一个对角矩阵，其对角线上的元素为基流速度 $U(y_j) = 1 - y_j^2$。基流的二阶导数是常数 $U''(y) = -2$，因此 $\\operatorname{diag}(U'')$ 是一个对角线上元素为 $-2$ 的对角矩阵，即 $-2I$。\n\n3.  **边界条件的施加**：\n    流体被限制在 $y = \\pm 1$ 的两个壁面之间。无滑移和无穿透边界条件要求扰动速度及其法向导数在壁面处为零：\n    $$v(\\pm 1) = 0, \\quad Dv(\\pm 1) = 0$$\n    这四个条件通过替换矩阵 $A$ 和 $B$ 的四行来施加到离散系统上。点 $y_0 = 1$ 和 $y_N = -1$ 对应于壁面。\n    -   $v(1)=0$：顶壁点（$j=0$）的方程被替换。$A$ 的第 0 行被设置为 $[1, 0, \\dots, 0]$，$B$ 的第 0 行被设置为零向量。\n    -   $v(-1)=0$：底壁点（$j=N$）的方程被替换。$A$ 的第 $N$ 行被设置为 $[0, \\dots, 0, 1]$，$B$ 的第 $N$ 行被设置为零向量。\n    -   $Dv(1)=0$：邻近顶壁的点（$j=1$）的方程被顶壁处的导数条件替换。$A$ 的第 1 行被设置为微分矩阵 $D$ 的第 0 行，$B$ 的第 1 行被设置为零向量。\n    -   $Dv(-1)=0$：邻近底壁的点（$j=N-1$）的方程被底壁处的导数条件替换。$A$ 的第 $N-1$ 行被设置为 $D$ 的第 $N$ 行，$B$ 的第 $N-1$ 行被设置为零向量。\n    此过程使矩阵 $B$ 的四行为零，使其成为奇异矩阵。\n\n4.  **特征值计算与后处理**：\n    使用标准广义特征值求解器求解修改后的系统 $A \\mathbf{x} = c B \\mathbf{x}$。由于 $B$ 的奇异性，求解器会产生无穷大的伪特征值。这些必须被滤除。剩余的有限特征值 $c$ 代表系统的物理模态。\n    对于每个有限特征值 $c$，时间增长率计算为 $g = \\alpha \\operatorname{Im}(c)$。任务是找到所有物理模态中的最大增长率，$g_{\\max} = \\max(\\alpha \\operatorname{Im}(c))$。对每个指定的测试用例重复此过程。",
            "answer": "```python\nimport numpy as np\nfrom scipy.linalg import eig\n\ndef solve():\n    \"\"\"\n    Solves the Orr-Sommerfeld equation for plane Poiseuille flow\n    using a Chebyshev collocation method to find the maximum temporal growth rate.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (N, alpha, Re)\n        (64, 1.0, 10000),\n        (64, 0.5, 5000),\n        (48, 2.0, 10000),\n        (40, 0.2, 20000),\n    ]\n\n    results = []\n    for N, alpha, Re in test_cases:\n        # Step 1: Construct Chebyshev grid and differentiation matrix D\n        n_points = N + 1\n        y = np.cos(np.pi * np.arange(n_points) / N)\n        \n        D = np.zeros((n_points, n_points))\n        c = np.ones(n_points)\n        c[0] = 2.0\n        c[-1] = 2.0\n\n        for i in range(n_points):\n            for j in range(n_points):\n                if i == j:\n                    if i == 0:\n                        D[i, j] = (2 * N**2 + 1) / 6.0\n                    elif i == N:\n                        D[i, j] = -(2 * N**2 + 1) / 6.0\n                    else:\n                        D[i, j] = -y[i] / (2 * (1 - y[i]**2))\n                else:\n                    D[i, j] = (c[i] / c[j]) * ((-1)**(i + j)) / (y[i] - y[j])\n        \n        D2 = D @ D\n        I = np.eye(n_points)\n\n        # Step 2: Build discrete operators and assemble matrices A and B\n        L2 = D2 - alpha**2 * I\n        L4 = L2 @ L2\n        \n        U = 1 - y**2\n        diag_U = np.diag(U)\n        \n        # U'' = -2, so diag(U'') = -2 * I\n        diag_U_pp = -2.0 * I\n        \n        A = L4 + 1j * alpha * Re * (diag_U @ L2 - diag_U_pp)\n        B = 1j * alpha * Re * L2\n\n        # Step 3: Impose boundary conditions v(+-1) = 0, Dv(+-1) = 0\n        # v(1)=0 corresponds to y[0]. Replace row 0.\n        A[0, :] = 0.0\n        A[0, 0] = 1.0\n        B[0, :] = 0.0\n        \n        # Dv(1)=0. Replace row 1.\n        A[1, :] = D[0, :]\n        B[1, :] = 0.0\n\n        # Dv(-1)=0 corresponds to y[N]. Replace row N-1.\n        A[N - 1, :] = D[N, :]\n        B[N - 1, :] = 0.0\n        \n        # v(-1)=0. Replace row N.\n        A[N, :] = 0.0\n        A[N, N] = 1.0\n        B[N, :] = 0.0\n\n        # Step 4: Solve the generalized eigenvalue problem and find max growth rate\n        evals, evecs = eig(A, B)\n        \n        # Filter out spurious infinite eigenvalues\n        finite_evals = evals[np.isfinite(evals)]\n        \n        if len(finite_evals) == 0:\n            # Handles cases where no finite eigenvalues are found\n            max_g = -np.inf\n        else:\n            # Calculate growth rate g = alpha * Im(c)\n            growth_rates = alpha * finite_evals.imag\n            max_g = np.max(growth_rates)\n        \n        results.append(f\"{max_g:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}