{
    "hands_on_practices": [
        {
            "introduction": "The cornerstone of linear hydrodynamic stability theory is the Orr-Sommerfeld equation. Before we can analyze or numerically solve for the stability of a flow, we must first be able to derive this governing equation from the fundamental Navier-Stokes equations. This foundational exercise () will guide you through the process of linearizing the governing equations, introducing normal modes, and eliminating variables to arrive at the canonical eigenvalue problem for the wall-normal velocity disturbance in plane Poiseuille flow.",
            "id": "3331850",
            "problem": "Consider an incompressible viscous fluid of constant density and kinematic viscosity $\\nu$ confined between two parallel plates located at $y=-1$ and $y=1$. The laminar base flow is the plane Poiseuille profile $U(y)=1-y^{2}$ directed along the streamwise coordinate $x$. Let the fluid satisfy the incompressible Navier–Stokes equations and continuity, linearized about the base flow. Assume infinitesimal disturbances of the form of streamwise–spanwise normal modes, with wall-normal velocity amplitude $v(y)$, whose space–time dependence is $\\exp\\!\\left(i\\alpha x + i\\beta z - i\\omega t\\right)$, where $\\alpha$ is the streamwise wavenumber, $\\beta$ is the spanwise wavenumber, and $\\omega$ is the complex temporal frequency. Define the Reynolds number $\\mathrm{Re}$ based on the channel half-height and a characteristic velocity scale, and let $D \\equiv \\frac{d}{dy}$, $k^{2} \\equiv \\alpha^{2}+\\beta^{2}$, and $c \\equiv \\omega/\\alpha$ be the complex phase speed.\n\nStarting from the linearized incompressible Navier–Stokes equations and continuity, eliminate the pressure and the streamwise/spanwise velocity perturbations to obtain the scalar eigenvalue problem in $v(y)$ known as the Orr–Sommerfeld equation. From this derivation, write the Orr–Sommerfeld operator $\\mathcal{L}_{\\mathrm{OS}}$ in the standard generalized eigenvalue form\n$$\n\\left[\\mathcal{L}_{\\mathrm{OS}}\\right] v \\;=\\; -\\,c\\,\\left(D^{2}-k^{2}\\right) v,\n$$\nwith all dependence on the given base flow $U(y)=1-y^{2}$ inserted explicitly. Also, specify the boundary conditions on $v$ and $Dv$ at both walls $y=\\pm 1$ that follow from impermeable and no-slip boundaries.\n\nYour final answer must be a single closed-form analytic expression that contains both the operator (with $U(y)$ substituted) and the boundary conditions. No numerical evaluation is required. Express $D$ as $d/dy$ and keep $\\alpha$, $\\beta$, $k$, and $\\mathrm{Re}$ symbolic.",
            "solution": "The user wants to derive the Orr-Sommerfeld equation for a specific flow profile and present it in a standard generalized eigenvalue form, along with its boundary conditions.\n\n### Step 1: Problem Validation\n\n**1.1. Extraction of Givens**\n- **Fluid:** Incompressible, constant density, constant kinematic viscosity $\\nu$.\n- **Geometry:** Confined between two parallel plates at $y=-1$ and $y=1$.\n- **Base Flow:** Plane Poiseuille profile $U(y) = 1-y^2$ in the streamwise ($x$) direction.\n- **Governing Equations:** Linearized incompressible Navier–Stokes and continuity equations.\n- **Disturbance Form:** Streamwise–spanwise normal modes of the form $\\exp(i\\alpha x + i\\beta z - i\\omega t)$. The wall-normal velocity perturbation amplitude is denoted by $v(y)$.\n- **Definitions:**\n    - Reynolds number: $\\mathrm{Re}$ (based on channel half-height and centerline velocity).\n    - Operator: $D \\equiv \\frac{d}{dy}$.\n    - Wavenumber squared: $k^2 \\equiv \\alpha^2 + \\beta^2$.\n    - Complex phase speed: $c \\equiv \\omega/\\alpha$.\n- **Task:**\n    1. Derive the Orr-Sommerfeld equation for $v(y)$.\n    2. Write the Orr-Sommerfeld operator $\\mathcal{L}_{\\mathrm{OS}}$ in the form $[\\mathcal{L}_{\\mathrm{OS}}] v = -c(D^2 - k^2)v$, with the specific base flow $U(y)=1-y^2$ substituted.\n    3. Specify the boundary conditions on $v$ and $Dv$ at $y=\\pm 1$ corresponding to impermeable, no-slip walls.\n    4. The final answer must be a single expression containing the operator and boundary conditions.\n\n**1.2. Validation**\nThe problem is a standard derivation in the field of hydrodynamic stability, a sub-discipline of fluid mechanics and computational fluid dynamics.\n- **Scientific Grounding:** The problem is based on the fundamental principles of fluid dynamics, specifically the stability analysis of the Navier-Stokes equations. The Orr-Sommerfeld equation is a cornerstone of this theory. The setup is scientifically and factually sound.\n- **Well-Posedness:** All necessary information (base flow, disturbance form, boundary types, governing equations) is provided. The task is to perform a standard, albeit non-trivial, derivation which leads to a unique analytical expression for the operator and boundary conditions.\n- **Objectivity:** The problem is stated using precise, standard, and unbiased terminology from the field of fluid mechanics.\n\nThe problem does not exhibit any of the invalidity flaws listed in the instructions. It is a valid, well-posed, and scientifically sound problem.\n\n### Step 2: Derivation of the Orr-Sommerfeld Equation\n\nWe begin with the non-dimensional linearized incompressible Navier-Stokes and continuity equations for a disturbance $(\\mathbf{u}', p') = (u,v,w,p)$ superposed on a base flow $\\mathbf{U} = (U(y), 0, 0)$:\n$$\n\\frac{\\partial u}{\\partial t} + U \\frac{\\partial u}{\\partial x} + v \\frac{dU}{dy} = - \\frac{\\partial p}{\\partial x} + \\frac{1}{\\mathrm{Re}} \\nabla^2 u\n$$\n$$\n\\frac{\\partial v}{\\partial t} + U \\frac{\\partial v}{\\partial x} = - \\frac{\\partial p}{\\partial y} + \\frac{1}{\\mathrm{Re}} \\nabla^2 v\n$$\n$$\n\\frac{\\partial w}{\\partial t} + U \\frac{\\partial w}{\\partial x} = - \\frac{\\partial p}{\\partial z} + \\frac{1}{\\mathrm{Re}} \\nabla^2 w\n$$\n$$\n\\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y} + \\frac{\\partial w}{\\partial z} = 0\n$$\nThe Reynolds number is $\\mathrm{Re} = U_c h / \\nu$, where $U_c$ is the centerline velocity and $h$ is the channel half-height. For the given dimensionless flow $U(y)=1-y^2$, we have $U_c=1$ and $h=1$.\n\nWe introduce normal mode disturbances of the form:\n$$\n(u, v, w, p) = (\\hat{u}(y), \\hat{v}(y), \\hat{w}(y), \\hat{p}(y)) \\exp(i\\alpha x + i\\beta z - i\\omega t)\n$$\nAs per the problem statement, we denote $\\hat{v}(y)$ simply as $v(y)$. The derivatives transform as:\n$\\partial_t \\to -i\\omega$, $\\partial_x \\to i\\alpha$, $\\partial_z \\to i\\beta$, $\\partial_y \\to D$, and $\\nabla^2 \\to D^2 - \\alpha^2 - \\beta^2 = D^2 - k^2$.\nUsing the definition $c=\\omega/\\alpha$, the term $(\\partial_t + U\\partial_x)$ becomes $-i\\omega + i\\alpha U = i\\alpha(U-c)$.\n\nThe system of ordinary differential equations for the amplitudes becomes:\n$$\n(1) \\quad i\\alpha \\hat{u} + D v + i\\beta \\hat{w} = 0\n$$\n$$\n(2) \\quad i\\alpha(U-c)\\hat{u} + v U' = -i\\alpha \\hat{p} + \\frac{1}{\\mathrm{Re}}(D^2-k^2)\\hat{u}\n$$\n$$\n(3) \\quad i\\alpha(U-c)v = -D\\hat{p} + \\frac{1}{\\mathrm{Re}}(D^2-k^2)v\n$$\n$$\n(4) \\quad i\\alpha(U-c)\\hat{w} = -i\\beta \\hat{p} + \\frac{1}{\\mathrm{Re}}(D^2-k^2)\\hat{w}\n$$\nwhere $U' = dU/dy$. Our goal is to eliminate $\\hat{u}$, $\\hat{w}$, and $\\hat{p}$ to obtain a single equation for $v$.\n\nFrom equation (3), we can express the pressure gradient $D\\hat{p}$:\n$$\n(5) \\quad D\\hat{p} = -i\\alpha(U-c)v + \\frac{1}{\\mathrm{Re}}(D^2-k^2)v\n$$\nNext, we eliminate $\\hat{u}$ and $\\hat{w}$ between equations (1), (2), and (4) to find an expression for $\\hat{p}$. Multiply (2) by $i\\alpha$ and (4) by $i\\beta$ and add them:\n$$\ni\\alpha(U-c)(i\\alpha\\hat{u} + i\\beta\\hat{w}) + i\\alpha v U' = - (i\\alpha)^2 \\hat{p} - (i\\beta)^2 \\hat{p} + \\frac{1}{\\mathrm{Re}}(D^2-k^2)(i\\alpha\\hat{u} + i\\beta\\hat{w})\n$$\nUsing the continuity equation (1), $i\\alpha\\hat{u}+i\\beta\\hat{w} = -Dv$. Substituting this:\n$$\ni\\alpha(U-c)(-Dv) + i\\alpha v U' = (\\alpha^2+\\beta^2)\\hat{p} + \\frac{1}{\\mathrm{Re}}(D^2-k^2)(-Dv)\n$$\n$$\n-i\\alpha(U-c)Dv + i\\alpha v U' = k^2\\hat{p} - \\frac{1}{\\mathrm{Re}}D(D^2-k^2)v\n$$\nSolving for $k^2 \\hat{p}$:\n$$\n(6) \\quad k^2\\hat{p} = -i\\alpha(U-c)Dv + i\\alpha U'v + \\frac{1}{\\mathrm{Re}}D(D^2-k^2)v\n$$\nTo eliminate $\\hat{p}$, we operate with $D$ on equation (6) and substitute $D\\hat{p}$ from equation (5) into the left-hand side ($D(k^2\\hat{p}) = k^2 D\\hat{p}$):\n$$\nk^2\\left[-i\\alpha(U-c)v + \\frac{1}{\\mathrm{Re}}(D^2-k^2)v\\right] = D\\left[-i\\alpha(U-c)Dv + i\\alpha U'v + \\frac{1}{\\mathrm{Re}}D(D^2-k^2)v\\right]\n$$\nThe derivative of the right-hand side is:\n$$\n-i\\alpha(U'Dv + (U-c)D^2v) + i\\alpha(U''v + U'Dv) + \\frac{1}{\\mathrm{Re}}D^2(D^2-k^2)v\n$$\n$$\n= -i\\alpha(U-c)D^2v + i\\alpha U''v + \\frac{1}{\\mathrm{Re}}(D^4-k^2D^2)v\n$$\nEquating the two sides:\n$$\n-i\\alpha k^2(U-c)v + \\frac{k^2}{\\mathrm{Re}}(D^2-k^2)v = -i\\alpha(U-c)D^2v + i\\alpha U''v + \\frac{1}{\\mathrm{Re}}(D^4-k^2D^2)v\n$$\nRearranging terms:\n$$\ni\\alpha(U-c)(D^2-k^2)v - i\\alpha U''v = \\frac{1}{\\mathrm{Re}}(D^4-2k^2D^2+k^4)v\n$$\n$$\ni\\alpha(U-c)(D^2-k^2)v - i\\alpha U''v = \\frac{1}{\\mathrm{Re}}(D^2-k^2)^2v\n$$\nThis is the Orr-Sommerfeld equation. To match the requested form $[\\mathcal{L}_{\\mathrm{OS}}] v = -c(D^2 - k^2)v$, we rearrange it to isolate the terms involving the phase speed $c$:\n$$\n(i\\alpha U(D^2-k^2) - i\\alpha U'')v - \\frac{1}{\\mathrm{Re}}(D^2-k^2)^2v = i\\alpha c(D^2-k^2)v\n$$\nDividing by $i\\alpha$:\n$$\n(U(D^2-k^2) - U'')v + \\frac{i}{\\alpha\\mathrm{Re}}(D^2-k^2)^2v = c(D^2-k^2)v\n$$\nMultiplying by $-1$ to match the required form:\n$$\n(-U(D^2-k^2) + U'')v - \\frac{i}{\\alpha\\mathrm{Re}}(D^2-k^2)^2v = -c(D^2-k^2)v\n$$\nThus, the Orr-Sommerfeld operator $\\mathcal{L}_{\\mathrm{OS}}$ is:\n$$\n\\mathcal{L}_{\\mathrm{OS}} = -U(D^2-k^2) + U'' - \\frac{i}{\\alpha\\mathrm{Re}}(D^2-k^2)^2\n$$\nSubstituting the given base flow $U(y)=1-y^2$, we get $U'(y)=-2y$ and $U''(y)=-2$.\n$$\n\\mathcal{L}_{\\mathrm{OS}} = -(1-y^2)\\left(\\frac{d^2}{dy^2}-k^2\\right) - 2 - \\frac{i}{\\alpha\\mathrm{Re}}\\left(\\frac{d^2}{dy^2}-k^2\\right)^2\n$$\n\n### Step 3: Boundary Conditions\n\nThe fluid is confined between impermeable, no-slip walls at $y=\\pm 1$.\n- **No-slip condition:** The tangential velocity components of the fluid must be zero at the walls. The total velocity is $(U+u, v, w)$. Since the walls are stationary, $(U+u)|_{y=\\pm 1}=0$ and $w|_{y=\\pm 1}=0$. The base flow $U(y)=1-y^2$ already satisfies $U(\\pm 1)=0$, so the perturbation velocities must vanish: $u(\\pm 1)=0$ and $w(\\pm 1)=0$. This implies their amplitudes also vanish: $\\hat{u}(\\pm 1)=0$ and $\\hat{w}(\\pm 1)=0$.\n- **Impermeable condition:** The normal velocity component must be zero at the walls: $v|_{y=\\pm 1}=0$. This directly gives the boundary condition for the amplitude $v(y)$:\n$$v(\\pm 1) = 0$$\nTo find the second boundary condition, we use the continuity equation for the amplitudes: $i\\alpha \\hat{u} + Dv + i\\beta \\hat{w} = 0$.\nAt the walls $y=\\pm 1$, since $\\hat{u}(\\pm 1)=0$ and $\\hat{w}(\\pm 1)=0$, the continuity equation reduces to:\n$$Dv(\\pm 1) = 0 \\quad \\implies \\quad \\frac{dv}{dy}(\\pm 1) = 0$$\nThe four boundary conditions are therefore $v(1)=0$, $v(-1)=0$, $dv/dy(1)=0$, and $dv/dy(-1)=0$.\n\n### Final Expression\n\nCombining the derived operator and the boundary conditions into a single statement as requested.\nThe operator is:\n$$\n\\mathcal{L}_{\\mathrm{OS}} = -(1-y^2)\\left(\\frac{d^2}{dy^2}-k^2\\right) - 2 - \\frac{i}{\\alpha\\mathrm{Re}}\\left(\\frac{d^2}{dy^2}-k^2\\right)^2\n$$\nThe boundary conditions are:\n$$\nv(\\pm 1) = 0, \\quad \\frac{dv}{dy}(\\pm 1) = 0\n$$",
            "answer": "$$\n\\boxed{\n\\mathcal{L}_{\\mathrm{OS}} = -(1-y^2)\\left(\\frac{d^2}{dy^2}-k^2\\right) - 2 - \\frac{i}{\\alpha\\mathrm{Re}}\\left(\\frac{d^2}{dy^2}-k^2\\right)^2; \\quad v(\\pm 1)=0, \\frac{dv}{dy}(\\pm 1)=0\n}\n$$"
        },
        {
            "introduction": "Instabilities can be viewed from two different perspectives: growing in time at a fixed location (temporal instability) or growing in space at a fixed moment in time (spatial instability). This distinction is crucial for understanding phenomena like boundary layers and jets. This problem () provides a simplified model that isolates the core mathematical concepts, allowing you to practice converting between the temporal and spatial frameworks using the dispersion relation and to interpret the physical meaning of the resulting growth rates.",
            "id": "3331813",
            "problem": "Consider the one-dimensional linearized advection–diffusion–reaction model for a disturbance envelope $A(x,t)$,\n$$\n\\frac{\\partial A}{\\partial t} + U\\,\\frac{\\partial A}{\\partial x} = \\mu\\,A + D\\,\\frac{\\partial^2 A}{\\partial x^2},\n$$\nwhere $U>0$ is a constant advection speed, $D>0$ is a constant diffusivity, and $\\mu$ is a constant real growth parameter. Assume normal modes of the form $A(x,t)=\\hat{A}\\,\\exp\\!\\big(i(\\alpha x-\\omega t)\\big)$, where $\\alpha\\in\\mathbb{C}$ and $\\omega\\in\\mathbb{C}$ are the complex wavenumber and complex frequency, respectively.\n\nStarting from this partial differential equation and the normal-mode ansatz, derive the dispersion relation linking $\\omega$ and $\\alpha$. Then, for the nondimensional parameter set $U=1$, $D=1$, and $\\mu=0.1$, carry out the following:\n\n1) Temporal analysis at fixed real wavenumber: Take the real wavenumber $\\alpha=\\alpha_r=0.5$ and compute the temporal growth rate $\\omega_i=\\operatorname{Im}(\\omega)$.\n\n2) Spatial analysis at fixed real frequency: Take the real frequency $\\omega=\\omega_r=0$ and compute the spatial growth rate $\\alpha_i=\\operatorname{Im}(\\alpha)$ by solving the dispersion relation for $\\alpha$ with $\\omega\\in\\mathbb{R}$, selecting the downstream-propagating branch characterized by positive group velocity $c_g=\\partial \\omega_r/\\partial \\alpha_r>0$.\n\nDecide whether the disturbance is temporally unstable (if $\\omega_i>0$ at the specified real $\\alpha$) or spatially unstable (if the selected $\\alpha_i<0$ at the specified real $\\omega$). Define the instability indicator $U_{\\text{code}}$ by\n- $U_{\\text{code}}=1$ if temporally unstable only,\n- $U_{\\text{code}}=2$ if spatially unstable only,\n- $U_{\\text{code}}=3$ if both temporally and spatially unstable,\n- $U_{\\text{code}}=0$ if neither temporally nor spatially unstable.\n\nReport your final answer as the row matrix $\\big(\\omega_i,\\ \\alpha_i,\\ U_{\\text{code}}\\big)$. All variables are nondimensional, so no units are required. Provide exact values; do not round.",
            "solution": "The problem statement constitutes a valid, well-posed problem in the field of hydrodynamic stability theory. It is scientifically grounded, self-contained, and free of contradictions or ambiguities. I will therefore proceed with a full solution.\n\nThe governing partial differential equation for the disturbance envelope $A(x,t)$ is given by:\n$$\n\\frac{\\partial A}{\\partial t} + U\\,\\frac{\\partial A}{\\partial x} = \\mu\\,A + D\\,\\frac{\\partial^2 A}{\\partial x^2}\n$$\nwhere $U>0$ is the advection speed, $D>0$ is the diffusivity, and $\\mu$ is a real growth parameter.\n\nWe assume a normal-mode solution of the form:\n$$\nA(x,t) = \\hat{A}\\,\\exp\\big(i(\\alpha x-\\omega t)\\big)\n$$\nwhere $\\alpha \\in \\mathbb{C}$ is the complex wavenumber and $\\omega \\in \\mathbb{C}$ is the complex frequency. To find the dispersion relation, we compute the partial derivatives of $A(x,t)$:\n$$\n\\frac{\\partial A}{\\partial t} = -i\\omega \\hat{A}\\,\\exp\\big(i(\\alpha x-\\omega t)\\big) = -i\\omega A\n$$\n$$\n\\frac{\\partial A}{\\partial x} = i\\alpha \\hat{A}\\,\\exp\\big(i(\\alpha x-\\omega t)\\big) = i\\alpha A\n$$\n$$\n\\frac{\\partial^2 A}{\\partial x^2} = (i\\alpha)^2 \\hat{A}\\,\\exp\\big(i(\\alpha x-\\omega t)\\big) = -\\alpha^2 A\n$$\nSubstituting these expressions into the governing PDE, we get:\n$$\n(-i\\omega) A + U (i\\alpha) A = \\mu A + D (-\\alpha^2) A\n$$\nFor a non-trivial solution ($A \\neq 0$), we can divide by $A$ to obtain the algebraic dispersion relation linking $\\omega$ and $\\alpha$:\n$$\n-i\\omega + iU\\alpha = \\mu - D\\alpha^2\n$$\nThis relation can be rearranged to solve for $\\omega$ as a function of $\\alpha$:\n$$\ni\\omega = iU\\alpha - \\mu + D\\alpha^2\n$$\n$$\n\\omega(\\alpha) = U\\alpha + i(\\mu - D\\alpha^2)\n$$\nThis is the dispersion relation.\n\nThe problem specifies the nondimensional parameter set $U=1$, $D=1$, and $\\mu=0.1$.\n\n**1) Temporal analysis at fixed real wavenumber**\n\nIn temporal analysis, the wavenumber $\\alpha$ is assumed to be real, $\\alpha = \\alpha_r$, and the complex frequency $\\omega = \\omega_r + i\\omega_i$ is calculated. The sign of the imaginary part, $\\omega_i = \\operatorname{Im}(\\omega)$, determines stability. If $\\omega_i > 0$, the disturbance grows in time, corresponding to temporal instability.\n\nWe are given $\\alpha = \\alpha_r = 0.5$. Substituting the parameters and $\\alpha$ into the dispersion relation:\n$$\n\\omega = (1)(0.5) + i(0.1 - (1)(0.5)^2)\n$$\n$$\n\\omega = 0.5 + i(0.1 - 0.25)\n$$\n$$\n\\omega = 0.5 - 0.15i\n$$\nThe temporal growth rate is the imaginary part of $\\omega$:\n$$\n\\omega_i = -0.15 = -\\frac{15}{100} = -\\frac{3}{20}\n$$\nSince $\\omega_i < 0$, the disturbance is temporally stable.\n\n**2) Spatial analysis at fixed real frequency**\n\nIn spatial analysis, the frequency $\\omega$ is assumed to be real, $\\omega = \\omega_r$, and the complex wavenumber $\\alpha = \\alpha_r + i\\alpha_i$ is calculated. The sign of the imaginary part, $\\alpha_i = \\operatorname{Im}(\\alpha)$, determines spatial growth or decay. The disturbance amplitude varies with space as $\\exp(-α_i x)$. If $\\alpha_i < 0$, the amplitude grows in the positive $x$ direction (downstream for $U>0$), corresponding to spatial instability.\n\nWe are given $\\omega = \\omega_r = 0$. We substitute this and the parameters into the dispersion relation $-i\\omega + iU\\alpha = \\mu - D\\alpha^2$:\n$$\n-i(0) + i(1)\\alpha = 0.1 - (1)\\alpha^2\n$$\n$$\ni\\alpha = 0.1 - \\alpha^2\n$$\nThis can be rearranged into a quadratic equation for $\\alpha$:\n$$\n\\alpha^2 + i\\alpha - 0.1 = 0\n$$\nWe solve for $\\alpha$ using the quadratic formula, $\\alpha = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$, with $a=1$, $b=i$, and $c=-0.1$:\n$$\n\\alpha = \\frac{-i \\pm \\sqrt{(i)^2 - 4(1)(-0.1)}}{2}\n$$\n$$\n\\alpha = \\frac{-i \\pm \\sqrt{-1 + 0.4}}{2}\n$$\n$$\n\\alpha = \\frac{-i \\pm \\sqrt{-0.6}}{2} = \\frac{-i \\pm i\\sqrt{0.6}}{2}\n$$\nLet's express $\\sqrt{0.6}$ in a rational form: $\\sqrt{0.6} = \\sqrt{\\frac{6}{10}} = \\sqrt{\\frac{3}{5}} = \\frac{\\sqrt{3}}{\\sqrt{5}} = \\frac{\\sqrt{15}}{5}$.\n$$\n\\alpha = \\frac{-i \\pm i\\frac{\\sqrt{15}}{5}}{2}\n$$\nThis gives two roots for $\\alpha$:\n$$\n\\alpha_1 = \\frac{-i + i\\frac{\\sqrt{15}}{5}}{2} = i\\left(\\frac{\\sqrt{15}-5}{10}\\right)\n$$\n$$\n\\alpha_2 = \\frac{-i - i\\frac{\\sqrt{15}}{5}}{2} = -i\\left(\\frac{\\sqrt{15}+5}{10}\\right)\n$$\nWe must select the downstream-propagating branch, characterized by a positive group velocity, $c_g = \\frac{\\partial \\omega_r}{\\partial \\alpha_r} > 0$. The complex group velocity is found by differentiating the dispersion relation $\\omega(\\alpha)$:\n$$\n\\frac{d\\omega}{d\\alpha} = \\frac{d}{d\\alpha}\\left(U\\alpha + i(\\mu - D\\alpha^2)\\right) = U - 2iD\\alpha\n$$\nThe real part of this complex group velocity, $\\operatorname{Re}(\\frac{d\\omega}{d\\alpha})$, determines the propagation speed of the wave packet's envelope. For $\\alpha = \\alpha_r + i\\alpha_i$, this is $\\operatorname{Re}(U - 2iD(\\alpha_r + i\\alpha_i)) = U + 2D\\alpha_i$. We evaluate this for each root, with $U=1$ and $D=1$. Both roots have $\\alpha_r = 0$.\n\nFor $\\alpha_1$: $\\alpha_i = \\frac{\\sqrt{15}-5}{10}$.\n$$\n\\operatorname{Re}\\left(\\frac{d\\omega}{d\\alpha}\\right)_1 = 1 + 2(1)\\left(\\frac{\\sqrt{15}-5}{10}\\right) = 1 + \\frac{\\sqrt{15}-5}{5} = \\frac{5 + \\sqrt{15} - 5}{5} = \\frac{\\sqrt{15}}{5}\n$$\nSince $\\sqrt{15} > 0$, this velocity is positive.\n\nFor $\\alpha_2$: $\\alpha_i = -\\frac{\\sqrt{15}+5}{10}$.\n$$\n\\operatorname{Re}\\left(\\frac{d\\omega}{d\\alpha}\\right)_2 = 1 + 2(1)\\left(-\\frac{\\sqrt{15}+5}{10}\\right) = 1 - \\frac{\\sqrt{15}+5}{5} = \\frac{5 - \\sqrt{15} - 5}{5} = -\\frac{\\sqrt{15}}{5}\n$$\nThis velocity is negative.\n\nThe downstream-propagating branch corresponds to the positive group velocity, so we select $\\alpha_1$. The spatial growth rate is the imaginary part of $\\alpha_1$:\n$$\n\\alpha_i = \\frac{\\sqrt{15}-5}{10}\n$$\nSince $\\sqrt{15} \\approx 3.873$, we have $\\sqrt{15}-5 < 0$, so $\\alpha_i < 0$. This indicates that the disturbance is spatially unstable (it grows in the positive $x$ direction).\n\n**3) Instability Classification**\n\n- Temporal analysis yielded $\\omega_i = -3/20 \\le 0$, indicating temporal stability.\n- Spatial analysis yielded $\\alpha_i = (\\sqrt{15}-5)/10 < 0$, indicating spatial instability.\n\nAccording to the provided definitions for $U_{\\text{code}}$:\n- The system is not temporally unstable.\n- The system is spatially unstable.\nThis corresponds to the case of being \"spatially unstable only\". Therefore, $U_{\\text{code}} = 2$.\n\nThe final answer is the row matrix $(\\omega_i, \\alpha_i, U_{\\text{code}})$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -\\frac{3}{20} & \\frac{\\sqrt{15}-5}{10} & 2 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "While analytical derivations are fundamental, most real-world stability problems are too complex to be solved with pen and paper. Modern stability analysis relies heavily on robust numerical methods. This capstone exercise () takes you into the realm of computational stability analysis, guiding you through the implementation of a Chebyshev spectral collocation method to solve the full Orr-Sommerfeld equation. This practice provides direct experience with the techniques used to generate the classic stability diagrams found in research literature.",
            "id": "3331826",
            "problem": "Consider the temporal linear stability of an incompressible parallel shear flow governed by the linearized Navier–Stokes equations under the assumption of two-dimensional disturbances of the form $\\exp(i \\alpha x - i \\omega t)$, where $\\alpha$ is the real streamwise wavenumber and $\\omega$ is the complex temporal frequency. The base flow is the dimensionless plane Poiseuille profile $U(y) = 1 - y^2$ defined on the wall-normal interval $y \\in [-1, 1]$. The wall-normal velocity disturbance $v(y)$ satisfies the Orr–Sommerfeld equation derived from the linearized governing equations and incompressibility, together with the no-slip boundary conditions implying $v(\\pm 1) = 0$ and $Dv(\\pm 1) = 0$, where $D$ denotes differentiation with respect to $y$.\n\nStarting from the linearized momentum and continuity equations and the definition of the Orr–Sommerfeld operator, the temporal Orr–Sommerfeld equation for $v(y)$ can be written in the generalized eigenvalue form $A \\mathbf{x} = \\lambda B \\mathbf{x}$ when discretized by Chebyshev collocation, where $\\mathbf{x}$ is the vector of nodal values of $v(y)$, $\\lambda$ is the complex phase speed $c = \\omega / \\alpha$, and $A$ and $B$ are complex matrices representing the discrete operators. Let $D$ denote the Chebyshev first differentiation matrix on $N+1$ Chebyshev–Gauss–Lobatto points $y_j = \\cos(\\pi j / N)$ for $j = 0, 1, \\dots, N$, and let $D^2$ be the second differentiation matrix. Define the discrete operators\n$$L_2 = D^2 - \\alpha^2 I, \\quad L_4 = L_2^2,$$\nwhere $I$ is the identity matrix of size $(N+1) \\times (N+1)$. For the plane Poiseuille base flow $U(y) = 1 - y^2$, one has $U''(y) = -2$. Denote by $\\operatorname{diag}(U)$ the diagonal matrix of the base flow sampled at the collocation points and by $\\operatorname{diag}(U'')$ the diagonal matrix of $U''$ sampled at the collocation points. The continuous Orr–Sommerfeld equation\n$$(D^2 - \\alpha^2)^2 v + i \\alpha Re \\left[(U - c)(D^2 - \\alpha^2) v - U'' v\\right] = 0$$\nis discretized into the generalized eigenvalue problem\n$$A \\mathbf{x} = c\\, B \\mathbf{x},$$\nwith\n$$A = L_4 + i \\alpha Re \\left(\\operatorname{diag}(U) L_2 - \\operatorname{diag}(U'')\\right), \\qquad B = i \\alpha Re \\, L_2.$$\n\nYour task is to write a complete, self-contained program that:\n1. Constructs the Chebyshev–Gauss–Lobatto grid and the corresponding first differentiation matrix $D$ of size $(N+1) \\times (N+1)$, and obtains $D^2$ by matrix multiplication.\n2. Builds the discrete operators $L_2$ and $L_4$ and assembles the matrices $A$ and $B$ as defined above for given $\\alpha$ and Reynolds number $Re$.\n3. Imposes the boundary conditions $v(\\pm 1) = 0$ and $Dv(\\pm 1) = 0$ by replacing specific rows in $A$ and $B$ as follows to obtain a well-posed generalized eigenvalue problem:\n   - Enforce $v(1) = 0$ by replacing row $0$ of $A$ with the row vector that selects the value at $y = 1$ (i.e., the first canonical basis row), and set row $0$ of $B$ to the zero row.\n   - Enforce $v(-1) = 0$ by replacing row $N$ of $A$ with the row vector that selects the value at $y = -1$ (i.e., the last canonical basis row), and set row $N$ of $B$ to the zero row.\n   - Enforce $Dv(1) = 0$ by replacing row $1$ of $A$ with row $0$ of the differentiation matrix $D$ (which corresponds to the derivative evaluated at $y = 1$), and set row $1$ of $B$ to the zero row.\n   - Enforce $Dv(-1) = 0$ by replacing row $N-1$ of $A$ with row $N$ of the differentiation matrix $D$ (which corresponds to the derivative evaluated at $y = -1$), and set row $N-1$ of $B$ to the zero row.\n4. Solves the generalized eigenvalue problem $A \\mathbf{x} = c B \\mathbf{x}$ for the complex eigenvalues $c$. For each test case, compute the dimensionless temporal growth rate defined by $g = \\alpha \\,\\operatorname{Im}(c)$, where $\\operatorname{Im}(c)$ denotes the imaginary part of $c$, and take the maximum value of $g$ over all eigenvalues with finite magnitude.\n5. Produces a single line of output containing the results as a comma-separated list enclosed in square brackets. Each number must be the maximum growth rate $g$ for one test case, expressed as a decimal float rounded to six decimal places, in dimensionless units.\n\nUse the following test suite of parameter values to evaluate and report the results:\n- Case 1 (general case with expected instability at sufficient $Re$): $N = 64$, $\\alpha = 1.0$, $Re = 10000$.\n- Case 2 (lower wavenumber and moderate $Re$): $N = 64$, $\\alpha = 0.5$, $Re = 5000$.\n- Case 3 (higher wavenumber at high $Re$): $N = 48$, $\\alpha = 2.0$, $Re = 10000$.\n- Case 4 (edge case with small wavenumber and very high $Re$): $N = 40$, $\\alpha = 0.2$, $Re = 20000$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[0.123456,-0.000789,0.000000,0.004321]\"), where each entry is the maximum $g$ for the corresponding test case in the order listed above, rounded to six decimal places, in dimensionless units. Angles are not used in this problem, and all outputs are unitless real numbers.",
            "solution": "The problem requires the determination of the maximum temporal growth rate for small two-dimensional disturbances in plane Poiseuille flow. This is a classic problem in hydrodynamic stability theory. The analysis is based on the Orr–Sommerfeld equation, which is a fourth-order ordinary differential equation governing the evolution of the wall-normal velocity disturbance, $v(y)$. The solution is obtained numerically by discretizing the equation using a Chebyshev collocation (spectral) method, which converts the differential eigenvalue problem into a generalized matrix eigenvalue problem.\n\nThe base flow is the plane Poiseuille flow, given by the dimensionless velocity profile $U(y) = 1 - y^2$ on the domain $y \\in [-1, 1]$. The disturbances are assumed to be of the form $\\phi(x,y,t) = \\hat{\\phi}(y) e^{i(\\alpha x - \\omega t)}$, where $\\alpha$ is the real streamwise wavenumber and $\\omega = \\omega_r + i\\omega_i$ is the complex angular frequency. The temporal growth rate of the disturbance is given by $g = \\omega_i = \\alpha \\operatorname{Im}(c)$, where $c = \\omega/\\alpha$ is the complex phase speed. A positive growth rate ($g > 0$) indicates an unstable mode that grows in time, while a negative growth rate indicates a stable, decaying mode.\n\nThe governing equation is the Orr–Sommerfeld equation for the wall-normal velocity amplitude $v(y)$. When discretized, it takes the form of a generalized eigenvalue problem:\n$$A \\mathbf{x} = c B \\mathbf{x}$$\nwhere $\\mathbf{x}$ is the vector of the disturbance velocity $v$ at the collocation points, and $c$ is the eigenvalue. The matrices $A$ and $B$ are constructed based on the discretized differential operators.\n\nThe steps to solve this problem are as follows:\n\n1.  **Chebyshev Collocation and Differentiation Matrices**:\n    The problem is discretized on the Chebyshev–Gauss–Lobatto grid points, defined by $y_j = \\cos(\\frac{\\pi j}{N})$ for $j = 0, 1, \\dots, N$. This choice of points allows for highly accurate approximation of functions and their derivatives.\n    The first step is to construct the $(N+1) \\times (N+1)$ Chebyshev first differentiation matrix, $D$. The entries of this matrix are given by the analytical formulas:\n    $$\n    D_{ij} =\n    \\begin{cases}\n    \\frac{c_i}{c_j} \\frac{(-1)^{i+j}}{y_i - y_j} & i \\neq j \\\\\n    -\\frac{y_j}{2(1-y_j^2)} & 1 \\le j \\le N-1 \\\\\n    \\frac{2N^2+1}{6} & i=j=0 \\\\\n    -\\frac{2N^2+1}{6} & i=j=N\n    \\end{cases}\n    $$\n    where $c_0 = c_N = 2$ and $c_j = 1$ for $1 \\le j \\le N-1$. The second differentiation matrix, $D^2$, is then computed by matrix multiplication: $D^2 = D \\cdot D$.\n\n2.  **Assembly of System Matrices**:\n    The discrete operators $L_2$ and $L_4$ are defined as:\n    $$L_2 = D^2 - \\alpha^2 I$$\n    $$L_4 = L_2^2 = (D^2 - \\alpha^2 I)^2$$\n    where $I$ is the identity matrix of size $(N+1) \\times (N+1)$. The matrices $A$ and $B$ for the generalized eigenvalue problem are defined as:\n    $$A = L_4 + i \\alpha Re \\left( \\operatorname{diag}(U) L_2 - \\operatorname{diag}(U'') \\right)$$\n    $$B = i \\alpha Re L_2$$\n    Here, $\\operatorname{diag}(U)$ is a diagonal matrix with the base flow velocities $U(y_j) = 1 - y_j^2$ on its diagonal. The second derivative of the base flow is constant, $U''(y) = -2$, so $\\operatorname{diag}(U'')$ is a diagonal matrix with $-2$ on its diagonal, i.e., $-2I$.\n\n3.  **Imposition of Boundary Conditions**:\n    The flow is confined between two walls at $y = \\pm 1$. The no-slip and no-penetration boundary conditions require that the disturbance velocity and its normal derivative are zero at the walls:\n    $$v(\\pm 1) = 0, \\quad Dv(\\pm 1) = 0$$\n    These four conditions are imposed on the discrete system by replacing four rows of the matrices $A$ and $B$. The points $y_0 = 1$ and $y_N = -1$ correspond to the walls.\n    -   $v(1)=0$: The equation for the top wall point ($j=0$) is replaced. Row $0$ of $A$ is set to $[1, 0, \\dots, 0]$ and row $0$ of $B$ is set to a zero vector.\n    -   $v(-1)=0$: The equation for the bottom wall point ($j=N$) is replaced. Row $N$ of $A$ is set to $[0, \\dots, 0, 1]$ and row $N$ of $B$ is set to a zero vector.\n    -   $Dv(1)=0$: The equation for the point adjacent to the top wall ($j=1$) is replaced with the derivative condition at the top wall. Row $1$ of $A$ is set to row $0$ of the differentiation matrix $D$, and row $1$ of $B$ is set to a zero vector.\n    -   $Dv(-1)=0$: The equation for the point adjacent to the bottom wall ($j=N-1$) is replaced with the derivative condition at the bottom wall. Row $N-1$ of $A$ is set to row $N$ of $D$, and row $N-1$ of $B$ is set to a zero vector.\n    This procedure renders four rows of matrix $B$ zero, making it singular.\n\n4.  **Eigenvalue Computation and Post-processing**:\n    The modified system $A \\mathbf{x} = c B \\mathbf{x}$ is solved using a standard generalized eigenvalue solver. Due to the singularity of $B$, the solver will produce spurious eigenvalues of infinite magnitude. These must be filtered out. The remaining finite eigenvalues $c$ represent the physical modes of the system.\n    For each finite eigenvalue $c$, the temporal growth rate is calculated as $g = \\alpha \\operatorname{Im}(c)$. The task is to find the maximum growth rate among all physical modes, $g_{\\max} = \\max(\\alpha \\operatorname{Im}(c))$. This procedure is repeated for each test case specified.",
            "answer": "```python\nimport numpy as np\nfrom scipy.linalg import eig\n\ndef solve():\n    \"\"\"\n    Solves the Orr-Sommerfeld equation for plane Poiseuille flow\n    using a Chebyshev collocation method to find the maximum temporal growth rate.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (N, alpha, Re)\n        (64, 1.0, 10000),\n        (64, 0.5, 5000),\n        (48, 2.0, 10000),\n        (40, 0.2, 20000),\n    ]\n\n    results = []\n    for N, alpha, Re in test_cases:\n        # Step 1: Construct Chebyshev grid and differentiation matrix D\n        n_points = N + 1\n        y = np.cos(np.pi * np.arange(n_points) / N)\n        \n        D = np.zeros((n_points, n_points))\n        c = np.ones(n_points)\n        c[0] = 2.0\n        c[-1] = 2.0\n\n        for i in range(n_points):\n            for j in range(n_points):\n                if i == j:\n                    if i == 0:\n                        D[i, j] = (2 * N**2 + 1) / 6.0\n                    elif i == N:\n                        D[i, j] = -(2 * N**2 + 1) / 6.0\n                    else:\n                        D[i, j] = -y[i] / (2 * (1 - y[i]**2))\n                else:\n                    D[i, j] = (c[i] / c[j]) * ((-1)**(i + j)) / (y[i] - y[j])\n        \n        D2 = D @ D\n        I = np.eye(n_points)\n\n        # Step 2: Build discrete operators and assemble matrices A and B\n        L2 = D2 - alpha**2 * I\n        L4 = L2 @ L2\n        \n        U = 1 - y**2\n        diag_U = np.diag(U)\n        \n        # U'' = -2, so diag(U'') = -2 * I\n        diag_U_pp = -2.0 * I\n        \n        A = L4 + 1j * alpha * Re * (diag_U @ L2 - diag_U_pp)\n        B = 1j * alpha * Re * L2\n\n        # Step 3: Impose boundary conditions v(+-1) = 0, Dv(+-1) = 0\n        # v(1)=0 corresponds to y[0]. Replace row 0.\n        A[0, :] = 0.0\n        A[0, 0] = 1.0\n        B[0, :] = 0.0\n        \n        # Dv(1)=0. Replace row 1.\n        A[1, :] = D[0, :]\n        B[1, :] = 0.0\n\n        # Dv(-1)=0 corresponds to y[N]. Replace row N-1.\n        A[N - 1, :] = D[N, :]\n        B[N - 1, :] = 0.0\n        \n        # v(-1)=0. Replace row N.\n        A[N, :] = 0.0\n        A[N, N] = 1.0\n        B[N, :] = 0.0\n\n        # Step 4: Solve the generalized eigenvalue problem and find max growth rate\n        evals, evecs = eig(A, B)\n        \n        # Filter out spurious infinite eigenvalues\n        finite_evals = evals[np.isfinite(evals)]\n        \n        if len(finite_evals) == 0:\n            # Handles cases where no finite eigenvalues are found\n            max_g = -np.inf\n        else:\n            # Calculate growth rate g = alpha * Im(c)\n            growth_rates = alpha * finite_evals.imag\n            max_g = np.max(growth_rates)\n        \n        results.append(f\"{max_g:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}