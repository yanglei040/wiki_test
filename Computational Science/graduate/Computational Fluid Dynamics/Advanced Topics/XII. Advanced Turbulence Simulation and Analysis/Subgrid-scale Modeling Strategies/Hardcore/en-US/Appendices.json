{
    "hands_on_practices": [
        {
            "introduction": "Many subgrid-scale models aim to approximate the SGS stress by first reconstructing an estimate of the unfiltered velocity field. This practice introduces the core concept behind Approximate Deconvolution Models (ADM) through the Van Cittert iteration . By implementing this method and analyzing its error, you will gain hands-on experience with the process of filter inversion, which is fundamental to this class of structural SGS models.",
            "id": "3367130",
            "problem": "Implement an approximate deconvolution large-eddy simulation (LES) reconstruction using $N$-th order Van Cittert iterations and quantify the normalized reconstruction error versus the iteration order $N$ and the filter width $\\Delta$ for a known linear filter on a one-dimensional periodic domain.\n\nFundamental base and setting:\n- Consider a periodic interval of length $L$, discretized uniformly with $n$ points and grid spacing $h = L/n$. Let $u(x)$ be a smooth, dimensionless scalar field on this interval. Define a linear, translation-invariant filter $\\mathcal{G}_\\Delta$ acting on $u$ by convolution with a kernel of width $\\Delta$, equivalently by multiplication with a real, nonnegative Fourier transfer function $G(k,\\Delta)$ in spectral space. For a Gaussian filter, the transfer function is $G(k,\\Delta) = \\exp\\!\\big(-\\tfrac{1}{2} (k \\Delta)^2\\big)$, where $k$ is the angular wavenumber. The filtered field is $\\overline{u} = \\mathcal{G}_\\Delta u$.\n- The task is to approximately invert the filter via the Van Cittert iteration built from the Neumann-series framework for bounded linear operators, using the iteration order $N$ and the operator $\\mathcal{G}_\\Delta$.\n\nYour program must do the following:\n1. Domain and field specification:\n   - Use a one-dimensional periodic domain of length $L = 2\\pi$ with $n = 2048$ equally spaced grid points and $h = L/n$. Define a deterministic, smooth, dimensionless “true” field\n     $$u(x) = \\sin(3x) + 0.5 \\cos(7x + 0.3) + 0.25 \\sin(20x) + 0.125 \\cos(50x - 0.7) + 0.0625 \\sin(120x),$$\n     for $x \\in [0,L)$ sampled at the grid points.\n2. Filtering:\n   - Implement $\\mathcal{G}_\\Delta$ in Fourier space using the discrete Fourier transform on the periodic grid. For $L = 2\\pi$, the angular wavenumbers are the standard discrete Fourier wavenumbers. Apply the Gaussian transfer function $G(k,\\Delta) = \\exp\\!\\big(-\\tfrac{1}{2} (k \\Delta)^2\\big)$ mode-by-mode to obtain $\\overline{u} = \\mathcal{G}_\\Delta u$.\n3. Approximate deconvolution via Van Cittert iterations:\n   - Starting from the filtered field $\\overline{u}$, construct the $N$-th order Van Cittert approximate deconvolution $u^{(N)}$ by iterating the linear fixed-point update that follows from the Neumann-series inversion of a bounded contraction:\n     - Initialize with $u^{(0)} = \\overline{u}$.\n     - For each integer $n \\ge 0$, update\n       $$u^{(n+1)} = u^{(n)} + \\left(\\overline{u} - \\mathcal{G}_\\Delta u^{(n)}\\right),$$\n       and stop after $N$ iterations to obtain $u^{(N)}$.\n4. Error metric:\n   - For each reconstruction $u^{(N)}$, compute the normalized discrete $L^2$ error relative to the true field $u$:\n     $$E(N,\\Delta) = \\frac{\\left\\|u^{(N)} - u\\right\\|_2}{\\left\\|u\\right\\|_2},$$\n     where the discrete $L^2$ norm is defined by $\\left\\|w\\right\\|_2 = \\sqrt{h \\sum_{j=0}^{n-1} \\left|w_j\\right|^2}$.\n5. Test suite:\n   - Use the following $7$ test cases, where each pair denotes $(N,\\Delta)$ with $\\Delta$ expressed as a multiple of the grid spacing $h$:\n     - Case $1$: $(0, 8h)$\n     - Case $2$: $(2, 8h)$\n     - Case $3$: $(8, 8h)$\n     - Case $4$: $(32, 8h)$\n     - Case $5$: $(8, 2h)$\n     - Case $6$: $(1, 4h)$\n     - Case $7$: $(8, 0h)$\n6. Output:\n   - Your program should produce a single line of output containing the $7$ values $E(N,\\Delta)$ for the above test cases, as a comma-separated list enclosed in square brackets. Round each value to $8$ decimal places. For example, an output with $3$ hypothetical values would look like $[0.12345678,0.23456789,0.34567890]$.\n\nAll quantities are dimensionless; no physical units are required. Angles are in radians. The program must be self-contained and require no input.",
            "solution": "The user-provided problem is valid. It is scientifically grounded in the field of computational fluid dynamics, specifically concerning subgrid-scale modeling for large-eddy simulation (LES). The problem is well-posed, with all parameters, functions, and procedures explicitly and consistently defined. It is objective and free of ambiguity. Therefore, a reasoned solution will be provided.\n\nThe objective is to implement an approximate deconvolution of a filtered one-dimensional scalar field using Van Cittert iterations and to quantify the reconstruction error $E$ as a function of the iteration order $N$ and the filter width $\\Delta$.\n\n**1. Domain, Field, and Spectral Representation**\nThe physical domain is a periodic interval $x \\in [0, L)$ with length $L=2\\pi$. This domain is discretized using $n=2048$ equally spaced points, resulting in a grid spacing of $h = L/n = 2\\pi/2048 = \\pi/1024$. The discrete grid points are given by $x_j = j h$ for $j = 0, 1, \\dots, n-1$.\n\nThe \"true\" scalar field $u(x)$ is a superposition of sinusoids, defined as:\n$$u(x) = \\sin(3x) + 0.5 \\cos(7x + 0.3) + 0.25 \\sin(20x) + 0.125 \\cos(50x - 0.7) + 0.0625 \\sin(120x)$$\nThis continuous function is sampled at the grid points $x_j$ to create the discrete true field vector, denoted as $u$.\n\nThe filter $\\mathcal{G}_\\Delta$ is a linear, translation-invariant operator, which acts as a simple multiplication in Fourier space. We employ the Discrete Fourier Transform (DFT) to map fields from physical space to spectral space. Given the domain length $L=2\\pi$, the corresponding discrete angular wavenumbers $k$ are integers, which for a DFT of size $n$ are typically represented by the set $\\{0, \\pm 1, \\dots, \\pm (n/2-1), -n/2\\}$.\n\n**2. Filtering Operation in Fourier Space**\nThe filter $\\mathcal{G}_\\Delta$ is a Gaussian filter characterized by its spectral transfer function:\n$$G(k, \\Delta) = \\exp\\left(-\\frac{1}{2} (k \\Delta)^2\\right)$$\nwhere $\\Delta$ is the characteristic filter width. Applying the filter to the field $u$ to obtain the filtered field $\\overline{u} = \\mathcal{G}_\\Delta u$ is performed in Fourier space by an element-wise multiplication of their spectral representations:\n$$\\hat{\\overline{u}}(k) = G(k, \\Delta) \\hat{u}(k)$$\nwhere $\\hat{u}(k)$ and $\\hat{\\overline{u}}(k)$ are the DFTs of $u$ and $\\overline{u}$, respectively. The filtered field $\\overline{u}$ in physical space is then recovered via the inverse DFT (IDFT) of $\\hat{\\overline{u}}(k)$.\n\n**3. Van Cittert Deconvolution Method**\nThe problem prescribes the Van Cittert iterative method to approximate the deconvolution (i.e., the inversion of $\\mathcal{G}_\\Delta$). Starting with $u^{(0)} = \\overline{u}$, the scheme is:\n$$u^{(m+1)} = u^{(m)} + \\left(\\overline{u} - \\mathcal{G}_\\Delta u^{(m)}\\right), \\quad \\text{for } m = 0, 1, \\dots, N-1$$\nThis iterative procedure can be analyzed in Fourier space, leading to a more computationally efficient non-iterative formulation. The update rule in spectral space is:\n$$\\hat{u}^{(m+1)}(k) = \\hat{u}^{(m)}(k) + \\hat{\\overline{u}}(k) - G(k, \\Delta) \\hat{u}^{(m)}(k) = (1 - G(k, \\Delta)) \\hat{u}^{(m)}(k) + \\hat{\\overline{u}}(k)$$\nThis is a first-order linear recurrence relation for each wavenumber $k$. With the initial condition $\\hat{u}^{(0)}(k) = \\hat{\\overline{u}}(k)$, the explicit solution after $N$ iterations can be found by summing the corresponding geometric series:\n$$\\hat{u}^{(N)}(k) = \\left( \\sum_{j=0}^{N} (1 - G(k, \\Delta))^j \\right) \\hat{\\overline{u}}(k) = \\frac{1 - (1 - G(k, \\Delta))^{N+1}}{G(k, \\Delta)} \\hat{\\overline{u}}(k)$$\nBy substituting $\\hat{\\overline{u}}(k) = G(k, \\Delta) \\hat{u}(k)$, we obtain the direct mapping from the true field to the reconstructed field in spectral space:\n$$\\hat{u}^{(N)}(k) = \\left( 1 - (1 - G(k, \\Delta))^{N+1} \\right) \\hat{u}(k)$$\nThis closed-form expression for the $N$-th iterate is mathematically equivalent to the iterative procedure but avoids the computational cost of $N$ successive filtering operations (each involving a DFT/IDFT pair). This efficient spectral approach will be used for the implementation. The final reconstructed field $u^{(N)}$ is obtained by applying the IDFT to $\\hat{u}^{(N)}(k)$.\n\n**4. Error Quantification**\nThe accuracy of the reconstruction is measured by the normalized discrete $L^2$ error, $E(N, \\Delta)$:\n$$E(N, \\Delta) = \\frac{\\|u^{(N)} - u\\|_2}{\\|u\\|_2}$$\nwhere the discrete $L^2$ norm is given by $\\|w\\|_2 = \\sqrt{h \\sum_{j=0}^{n-1} |w_j|^2}$. Since the scaling factor $\\sqrt{h}$ appears in both the numerator and the denominator, it cancels. The error can thus be computed as the ratio of the standard Euclidean vector norms:\n$$E(N, \\Delta) = \\frac{\\sqrt{\\sum_{j=0}^{n-1} |u^{(N)}_j - u_j|^2}}{\\sqrt{\\sum_{j=0}^{n-1} |u_j|^2}}$$\n\n**5. Implementation Strategy**\nFor each given test case pair $(N, \\Delta)$:\n1. Define the spatial grid $x_j$ and the corresponding angular wavenumbers $k$.\n2. Generate the discrete true field $u$ from its analytical formula.\n3. Compute the DFT of the true field, $\\hat{u}(k)$.\n4. Calculate the Gaussian filter transfer function $G(k, \\Delta)$.\n5. Determine the total transfer function for the reconstruction, $H_N(k, \\Delta) = 1 - (1 - G(k, \\Delta))^{N+1}$.\n6. Calculate the DFT of the reconstructed field, $\\hat{u}^{(N)}(k) = H_N(k, \\Delta) \\hat{u}(k)$.\n7. Obtain the reconstructed field $u^{(N)}$ by applying the IDFT to $\\hat{u}^{(N)}(k)$.\n8. Compute the normalized error $E(N, \\Delta)$ using standard vector norm functions and format the result.\nThe special case $\\Delta=0$ implies $G(k,0)=1$ for all $k$, which leads to $H_N(k,0)=1$. Thus, $u^{(N)}=u$ and the error $E(N,0)=0$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements and evaluates the Van Cittert approximate deconvolution method\n    for a 1D scalar field on a periodic domain.\n    \"\"\"\n\n    # 1. Domain and field specification\n    L = 2.0 * np.pi\n    n = 2048\n    h = L / n\n    x = np.arange(n) * h\n\n    # For a periodic domain of length L=2*pi, the discrete angular wavenumbers k\n    # are integers. These can be generated using np.fft.fftfreq.\n    # k = 2*pi*fftfreq(n, d=h) simplifies to k = n*fftfreq(n) because h=L/n=2*pi/n.\n    k = np.fft.fftfreq(n) * n\n\n    # Define the \"true\" scalar field u(x)\n    u_true = (np.sin(3 * x) +\n              0.5 * np.cos(7 * x + 0.3) +\n              0.25 * np.sin(20 * x) +\n              0.125 * np.cos(50 * x - 0.7) +\n              0.0625 * np.sin(120 * x))\n\n    # Pre-compute the DFT of the true field and its norm for efficiency.\n    u_true_hat = np.fft.fft(u_true)\n    norm_u_true = np.linalg.norm(u_true)\n\n    # 5. Test suite\n    # Each tuple represents (N, delta), where delta is given as a multiple of h.\n    test_cases = [\n        (0, 8 * h),   # Case 1\n        (2, 8 * h),   # Case 2\n        (8, 8 * h),   # Case 3\n        (32, 8 * h),  # Case 4\n        (8, 2 * h),   # Case 5\n        (1, 4 * h),   # Case 6\n        (8, 0 * h),   # Case 7\n    ]\n\n    results = []\n    for N, delta in test_cases:\n        # The reconstructed field u_recon is computed based on the efficient\n        # spectral formulation derived from the Van Cittert iteration.\n\n        # The case delta=0 is trivial: the filter is the identity operator,\n        # so the filtered field is the true field, and reconstruction is perfect.\n        if delta == 0.0:\n            u_recon = u_true\n        else:\n            # 2. Filtering: Define the Gaussian transfer function G(k, delta)\n            Gk = np.exp(-0.5 * (k * delta)**2)\n\n            # 3. Approximate deconvolution: Calculate the total transfer function H_N\n            # from the true field u to the reconstructed field u_recon.\n            # H_N(k) = 1 - (1 - G(k))^(N+1)\n            H_N_k = 1.0 - (1.0 - Gk)**(N + 1)\n            \n            # Apply the total transfer function to the true field's spectrum\n            u_recon_hat = H_N_k * u_true_hat\n            \n            # Transform the reconstructed spectrum back to physical space.\n            # Use np.real to discard negligible imaginary parts from numerical error.\n            u_recon = np.real(np.fft.ifft(u_recon_hat))\n\n        # 4. Error metric: Compute the normalized discrete L2 error.\n        # The sqrt(h) factor in the a discrete L2 norm definition cancels out,\n        # so we can use the standard vector 2-norm (np.linalg.norm).\n        norm_diff = np.linalg.norm(u_recon - u_true)\n        \n        # Avoid division by zero if u_true happens to be a zero field.\n        if norm_u_true == 0:\n            error = 0.0 if norm_diff == 0 else np.inf\n        else:\n            error = norm_diff / norm_u_true\n        \n        results.append(error)\n\n    # 6. Output: Format results as a comma-separated list of strings,\n    # with each value formatted to 8 decimal places, enclosed in brackets.\n    formatted_results = [f\"{res:.8f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\n\nif __name__ == \"__main__\":\n    solve()\n```"
        },
        {
            "introduction": "In practical simulations, grids are often non-uniform to resolve complex geometries or boundary layers, which introduces a complication: filtering and differentiation no longer commute. This exercise explores the commutation error that arises from spatially varying filter widths . Deriving and calculating this error will highlight a crucial term that is often neglected in LES formulations, providing insight into potential sources of modeling error in realistic applications.",
            "id": "3367139",
            "problem": "Consider a one-dimensional Large-Eddy Simulation (LES) of an incompressible flow, where subgrid-scale effects are represented by spatial filtering of the velocity field. Let the physical coordinate be $x \\in [0,1]$ and the computational coordinate be $\\xi \\in [0,1]$, related by the stretched-grid mapping $x(\\xi) = \\xi^{3}$. Assume the uniform computational spacing is $\\Delta_{\\xi} = 0.02$ (dimensionless), and the physical filter is the position-dependent top-hat:\n$$\n\\bar{u}(x) = \\frac{1}{\\Delta(x)} \\int_{x - \\Delta(x)/2}^{x + \\Delta(x)/2} u(s) \\, ds,\n$$\nwhere $\\Delta(x)$ is the local physical filter width induced by the mapping, defined by $\\Delta(x) = \\Delta_{\\xi} \\, \\frac{dx}{d\\xi}\\big|_{\\xi(x)}$, with $\\xi(x)$ satisfying $\\xi^{3} = x$. The commutation error between filtering and differentiation is defined as\n$$\nC(x) = \\overline{\\partial_{x} u}(x) - \\partial_{x} \\bar{u}(x).\n$$\nStarting from the operator definitions above and without invoking any shortcut formulas, derive the leading-order asymptotic expression for $C(x)$ in terms of $\\Delta(x)$, $\\partial_{x} \\Delta(x)$, and derivatives of $u(x)$, under the assumption that $\\Delta(x)$ is small compared to the characteristic length scales of $u(x)$. Then evaluate $C(x)$ at $x_{0} = 0.5$ for the velocity field $u(x) = U_{0} \\sin(k x)$ with $U_{0} = 1.2 \\, \\mathrm{m/s}$ and $k = 5 \\, \\mathrm{m}^{-1}$, using the mapping above to compute $\\Delta(x)$ and $\\partial_{x} \\Delta(x)$ at $x_{0}$. \n\nDiscuss briefly how such commutation errors influence modeled subgrid-scale stresses in LES closures, but provide as the final answer only the numerical value of $C(x_{0})$. Express the final value in $\\mathrm{s}^{-1}$ and round your result to six significant figures.",
            "solution": "The problem is first validated against the specified criteria.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n-   **System**: One-dimensional Large-Eddy Simulation (LES) of an incompressible flow.\n-   **Coordinates**: Physical coordinate $x \\in [0,1]$, computational coordinate $\\xi \\in [0,1]$.\n-   **Mapping**: $x(\\xi) = \\xi^{3}$.\n-   **Computational Spacing**: $\\Delta_{\\xi} = 0.02$ (dimensionless).\n-   **Filter Definition**: Position-dependent top-hat filter $\\bar{u}(x) = \\frac{1}{\\Delta(x)} \\int_{x - \\Delta(x)/2}^{x + \\Delta(x)/2} u(s) \\, ds$.\n-   **Filter Width**: $\\Delta(x) = \\Delta_{\\xi} \\, \\frac{dx}{d\\xi}\\big|_{\\xi(x)}$, where $\\xi(x)$ is defined by $\\xi^{3} = x$.\n-   **Commutation Error**: $C(x) = \\overline{\\partial_{x} u}(x) - \\partial_{x} \\bar{u}(x)$.\n-   **Assumption**: $\\Delta(x)$ is small compared to characteristic length scales of $u(x)$.\n-   **Task 1**: Derive the leading-order asymptotic expression for $C(x)$ in terms of $\\Delta(x)$, $\\partial_{x} \\Delta(x)$, and derivatives of $u(x)$.\n-   **Task 2**: Evaluate $C(x_0)$ at $x_0 = 0.5$.\n-   **Velocity Field**: $u(x) = U_{0} \\sin(k x)$, with $U_{0} = 1.2 \\, \\mathrm{m/s}$ and $k = 5 \\, \\mathrm{m}^{-1}$.\n-   **Final Answer Requirement**: Numerical value of $C(x_{0})$ in $\\mathrm{s}^{-1}$ rounded to six significant figures.\n\n**Step 2: Validate Using Extracted Givens**\n-   **Scientific Grounding**: The problem is well-grounded in the theory of computational fluid dynamics, specifically Large-Eddy Simulation. The concepts of grid transformation, spatial filtering, and commutation error are standard topics in this field. The mathematical methods required are Taylor series expansions and calculus, which are fundamental.\n-   **Well-Posedness**: The problem is self-contained and provides all necessary functions, parameters, and conditions to derive the expression and compute the numerical value. A unique solution exists.\n-   **Objectivity**: The language is technical, precise, and free of any subjective or opinion-based statements.\n-   **Dimensional Consistency**: The given values for $U_0$ and $k$ imply that $x$ has units of meters. The domain $x \\in [0,1]$ is interpreted as the physical domain of interest being $[0,1]$ meters. Under this interpretation, the units are consistent, leading to a final answer for $C(x)$ in $\\mathrm{s}^{-1}$ as requested.\n\n**Step 3: Verdict and Action**\nThe problem is valid. It is scientifically sound, well-posed, objective, and contains no ambiguities or contradictions. A complete solution will be provided.\n\n### Derivation of the Commutation Error\n\nThe commutation error is defined as $C(x) = \\overline{\\partial_{x} u}(x) - \\partial_{x} \\bar{u}(x)$. We will analyze each term separately using Taylor series expansions under the assumption that the filter width $\\Delta(x)$ is small.\n\n**First term: $\\overline{\\partial_{x} u}(x)$**\nLet $f(s) = \\partial_s u(s)$. The filtered value of $f(x)$ is:\n$$\n\\overline{f}(x) = \\frac{1}{\\Delta(x)} \\int_{x - \\Delta(x)/2}^{x + \\Delta(x)/2} f(s) \\, ds\n$$\nWe expand $f(s)$ in a Taylor series around $s=x$:\n$$\nf(s) = f(x) + (s-x) f'(x) + \\frac{(s-x)^2}{2!} f''(x) + \\mathcal{O}((s-x)^3)\n$$\nSubstituting this into the integral:\n$$\n\\int_{x - \\Delta/2}^{x + \\Delta/2} f(s) \\, ds = \\int_{x - \\Delta/2}^{x + \\Delta/2} \\left[ f(x) + (s-x) f'(x) + \\frac{(s-x)^2}{2} f''(x) + \\dots \\right] ds\n$$\nThe integral of odd powers of $(s-x)$ over the symmetric interval is zero. We evaluate the remaining terms:\n$$\n\\int_{x - \\Delta/2}^{x + \\Delta/2} f(x) \\, ds = f(x) \\Delta(x)\n$$\n$$\n\\int_{x - \\Delta/2}^{x + \\Delta/2} \\frac{(s-x)^2}{2} f''(x) \\, ds = \\frac{f''(x)}{2} \\left[ \\frac{(s-x)^3}{3} \\right]_{x - \\Delta/2}^{x + \\Delta/2} = \\frac{f''(x)}{6} \\left[ \\left(\\frac{\\Delta}{2}\\right)^3 - \\left(-\\frac{\\Delta}{2}\\right)^3 \\right] = \\frac{f''(x)}{6} \\frac{2\\Delta^3}{8} = \\frac{\\Delta^3}{24} f''(x)\n$$\nThus, the integral is $f(x) \\Delta(x) + \\frac{\\Delta(x)^3}{24} f''(x) + \\mathcal{O}(\\Delta^5)$.\nDividing by $\\Delta(x)$, we get the filtered value:\n$$\n\\overline{f}(x) = f(x) + \\frac{\\Delta(x)^2}{24} f''(x) + \\mathcal{O}(\\Delta^4)\n$$\nSubstituting $f(x) = \\partial_x u(x)$, we have:\n$$\n\\overline{\\partial_x u}(x) = \\partial_x u(x) + \\frac{\\Delta(x)^2}{24} \\partial_x^3 u(x) + \\mathcal{O}(\\Delta^4)\n$$\n\n**Second term: $\\partial_{x} \\bar{u}(x)$**\nWe start with the definition of $\\bar{u}(x)$ and differentiate with respect to $x$ using the Leibniz integral rule:\n$$\n\\partial_x \\bar{u}(x) = \\partial_x \\left[ \\frac{1}{\\Delta(x)} \\int_{x - \\Delta(x)/2}^{x + \\Delta(x)/2} u(s) \\, ds \\right]\n$$\n$$\n= \\left( \\partial_x \\frac{1}{\\Delta(x)} \\right) \\int_{x - \\Delta/2}^{x + \\Delta/2} u(s) \\, ds + \\frac{1}{\\Delta(x)} \\partial_x \\left( \\int_{x - \\Delta/2}^{x + \\Delta/2} u(s) \\, ds \\right)\n$$\nUsing the product rule and chain rule, $\\partial_x (1/\\Delta) = -(\\partial_x \\Delta)/\\Delta^2$. Let $\\Delta' = \\partial_x \\Delta$.\nThe Leibniz rule for the second part gives:\n$$\n\\partial_x \\left( \\int_{x - \\Delta/2}^{x + \\Delta/2} u(s) \\, ds \\right) = u(x+\\Delta/2) \\partial_x(x+\\Delta/2) - u(x-\\Delta/2) \\partial_x(x-\\Delta/2)\n$$\n$$\n= u(x+\\Delta/2) \\left(1 + \\frac{\\Delta'}{2}\\right) - u(x-\\Delta/2) \\left(1 - \\frac{\\Delta'}{2}\\right)\n$$\nWe perform Taylor expansions for $u(s)$ around $s=x$ up to third order:\n$$\nu(s) = u(x) + (s-x)\\partial_x u(x) + \\frac{(s-x)^2}{2}\\partial_x^2 u(x) + \\frac{(s-x)^3}{6}\\partial_x^3 u(x) + \\mathcal{O}((s-x)^4)\n$$\nThe terms $u(x\\pm\\Delta/2)$ are:\n$$\nu(x+\\Delta/2) = u + \\frac{\\Delta}{2}u' + \\frac{\\Delta^2}{8}u'' + \\frac{\\Delta^3}{48}u''' + \\mathcal{O}(\\Delta^4)\n$$\n$$\nu(x-\\Delta/2) = u - \\frac{\\Delta}{2}u' + \\frac{\\Delta^2}{8}u'' - \\frac{\\Delta^3}{48}u''' + \\mathcal{O}(\\Delta^4)\n$$\nThe integral term can be approximated as we did for $\\overline{f}(x)$:\n$$\n\\int_{x - \\Delta/2}^{x + \\Delta/2} u(s) \\, ds = u\\Delta + \\frac{\\Delta^3}{24}u'' + \\mathcal{O}(\\Delta^5)\n$$\nThe first part of $\\partial_x \\bar{u}(x)$ is:\n$$\n-\\frac{\\Delta'}{\\Delta^2} \\left( u\\Delta + \\frac{\\Delta^3}{24}u'' \\right) = -\\frac{u\\Delta'}{\\Delta} - \\frac{\\Delta\\Delta'}{24}u'' + \\mathcal{O}(\\Delta^3)\n$$\nFor the second part, we evaluate the boundary terms:\n$$\n\\frac{1}{\\Delta} \\left[ u(x+\\Delta/2) \\left(1 + \\frac{\\Delta'}{2}\\right) - u(x-\\Delta/2) \\left(1 - \\frac{\\Delta'}{2}\\right) \\right] = \\frac{1}{\\Delta} \\left[ (u(x+\\Delta/2) - u(x-\\Delta/2)) + \\frac{\\Delta'}{2}(u(x+\\Delta/2) + u(x-\\Delta/2)) \\right]\n$$\nThe difference and sum are:\n$$\nu(x+\\Delta/2) - u(x-\\Delta/2) = \\Delta u' + \\frac{\\Delta^3}{24}u''' + \\mathcal{O}(\\Delta^5)\n$$\n$$\nu(x+\\Delta/2) + u(x-\\Delta/2) = 2u + \\frac{\\Delta^2}{4}u'' + \\mathcal{O}(\\Delta^4)\n$$\nSubstituting these into the bracketed expression:\n$$\n\\left( \\Delta u' + \\frac{\\Delta^3}{24}u''' \\right) + \\frac{\\Delta'}{2}\\left( 2u + \\frac{\\Delta^2}{4}u'' \\right) = \\Delta u' + u\\Delta' + \\frac{\\Delta^2\\Delta'}{8}u'' + \\frac{\\Delta^3}{24}u''' + \\dots\n$$\nDividing by $\\Delta$, the second part of $\\partial_x \\bar{u}(x)$ becomes:\n$$\nu' + \\frac{u\\Delta'}{\\Delta} + \\frac{\\Delta\\Delta'}{8}u'' + \\frac{\\Delta^2}{24}u''' + \\mathcal{O}(\\Delta^3)\n$$\nCombining both parts of $\\partial_x \\bar{u}(x)$:\n$$\n\\partial_x \\bar{u}(x) = \\left(-\\frac{u\\Delta'}{\\Delta} - \\frac{\\Delta\\Delta'}{24}u'' \\right) + \\left(u' + \\frac{u\\Delta'}{\\Delta} + \\frac{\\Delta\\Delta'}{8}u'' + \\frac{\\Delta^2}{24}u''' \\right) + \\mathcal{O}(\\Delta^3)\n$$\n$$\n\\partial_x \\bar{u}(x) = u' + \\left(\\frac{1}{8} - \\frac{1}{24}\\right)\\Delta\\Delta'u'' + \\frac{\\Delta^2}{24}u''' + \\dots = u' + \\frac{2}{24}\\Delta\\Delta'u'' + \\frac{\\Delta^2}{24}u''' + \\dots\n$$\n$$\n\\partial_x \\bar{u}(x) = \\partial_x u(x) + \\frac{\\Delta(x)\\partial_x\\Delta(x)}{12}\\partial_x^2 u(x) + \\frac{\\Delta(x)^2}{24}\\partial_x^3 u(x) + \\mathcal{O}(\\Delta^3)\n$$\n\n**Commutation Error Expression**\nFinally, we compute $C(x)$ by subtracting the two derived expressions:\n$$\nC(x) = \\left( \\partial_x u + \\frac{\\Delta^2}{24} \\partial_x^3 u \\right) - \\left( \\partial_x u + \\frac{\\Delta \\partial_x\\Delta}{12} \\partial_x^2 u + \\frac{\\Delta^2}{24} \\partial_x^3 u \\right) + \\mathcal{O}(\\Delta^3)\n$$\nThe leading-order asymptotic expression for the commutation error is:\n$$\nC(x) = - \\frac{\\Delta(x) \\partial_x\\Delta(x)}{12} \\partial_x^2 u(x)\n$$\n\n### Numerical Evaluation at $x_0 = 0.5$\n\nWe need to evaluate $\\Delta(x)$, $\\partial_x \\Delta(x)$, and $\\partial_x^2 u(x)$ at $x_0 = 0.5$.\n\n1.  **Filter Width and its Derivative**:\n    -   Mapping: $x = \\xi^3 \\implies \\xi(x) = x^{1/3}$.\n    -   Jacobian: $\\frac{dx}{d\\xi} = 3\\xi^2$.\n    -   Filter width: $\\Delta(x) = \\Delta_{\\xi} \\frac{dx}{d\\xi}|_{\\xi(x)} = 0.02 \\cdot (3\\xi(x)^2) = 0.06 \\, (x^{1/3})^2 = 0.06 \\, x^{2/3}$.\n    -   Derivative of filter width: $\\partial_x \\Delta(x) = \\frac{d}{dx}(0.06 \\, x^{2/3}) = 0.06 \\cdot \\frac{2}{3} x^{-1/3} = 0.04 \\, x^{-1/3}$.\n\n    At $x_0 = 0.5$:\n    -   $\\Delta(0.5) = 0.06 \\cdot (0.5)^{2/3}$.\n    -   $\\partial_x \\Delta(0.5) = 0.04 \\cdot (0.5)^{-1/3}$.\n\n2.  **Velocity Field Derivatives**:\n    -   $u(x) = U_0 \\sin(kx)$ with $U_0 = 1.2 \\, \\mathrm{m/s}$ and $k = 5 \\, \\mathrm{m}^{-1}$.\n    -   $\\partial_x u(x) = k U_0 \\cos(kx)$.\n    -   $\\partial_x^2 u(x) = -k^2 U_0 \\sin(kx)$.\n\n    At $x_0 = 0.5$:\n    -   $\\partial_x^2 u(0.5) = -(5 \\, \\mathrm{m}^{-1})^2 (1.2 \\, \\mathrm{m/s}) \\sin(5 \\cdot 0.5) = -25 \\cdot 1.2 \\sin(2.5) \\, \\mathrm{s}^{-1} \\mathrm{m}^{-1} = -30 \\sin(2.5) \\, \\mathrm{s}^{-1} \\mathrm{m}^{-1}$. The argument of the sine function is in radians.\n\n3.  **Compute $C(x_0)$**:\n    Substituting these values into the expression for $C(x)$:\n    $$\n    C(0.5) = - \\frac{\\left[0.06 \\cdot (0.5)^{2/3}\\right] \\left[0.04 \\cdot (0.5)^{-1/3}\\right]}{12} \\left[-30 \\sin(2.5)\\right]\n    $$\n    The units are $[m] \\cdot [1] \\cdot [s^{-1} m^{-1}] = [s^{-1}]$.\n    $$\n    C(0.5) = \\frac{0.06 \\cdot 0.04 \\cdot (0.5)^{(2/3 - 1/3)}}{12} \\cdot 30 \\sin(2.5)\n    $$\n    $$\n    C(0.5) = \\frac{0.0024 \\cdot (0.5)^{1/3}}{12} \\cdot 30 \\sin(2.5)\n    $$\n    $$\n    C(0.5) = \\frac{0.072}{12} (0.5)^{1/3} \\sin(2.5) = 0.006 \\cdot (0.5)^{1/3} \\sin(2.5)\n    $$\n    Numerically:\n    $$\n    C(0.5) \\approx 0.006 \\cdot (0.793700526) \\cdot (0.598472144) \\approx 0.0028503126 \\, \\mathrm{s}^{-1}\n    $$\n    Rounding to six significant figures, the value is $0.00285031 \\, \\mathrm{s}^{-1}$.\n\n### Discussion of Influence on Subgrid-Scale Stresses\n\nIn LES, the governing Navier-Stokes equations are filtered to separate the large, resolved scales from the small, subgrid-scales (SGS). The non-linear advection term, $\\partial_j (u_i u_j)$, becomes $\\overline{\\partial_j (u_i u_j)}$ after filtering. On a non-uniform grid, the filter width $\\Delta(x)$ is position-dependent, and as a result, the filtering and differentiation operators do not commute. The commutation error, $C_j(f) = \\overline{\\partial_j f} - \\partial_j \\bar{f}$, quantifies this non-commutativity.\n\nThe filtered advection term is properly written as:\n$$\n\\overline{\\partial_j (u_i u_j)} = \\partial_j \\overline{u_i u_j} - C_j(u_i u_j)\n$$\nThe filtered momentum equation thus contains an additional term related to this commutation error:\n$$\n\\partial_t \\bar{u}_i + \\partial_j \\overline{u_i u_j} = \\dots \\implies \\partial_t \\bar{u}_i + \\partial_j (\\bar{u}_i \\bar{u}_j) = -\\partial_j \\tau_{ij} + C_j(u_i u_j) + \\dots\n$$\nwhere $\\tau_{ij} = \\overline{u_i u_j} - \\bar{u}_i \\bar{u}_j$ is the SGS stress tensor. The term $C_j(u_i u_j)$ appears as a source or sink in the momentum equation for the resolved field $\\bar{u}_i$. This term, which is non-zero for non-uniform filter widths (as shown in the derivation), represents a physical effect of how large-scale eddies are distorted by the spatially varying filter. In many LES implementations, this commutation error is neglected for simplicity, which can lead to significant inaccuracies, particularly in regions of high grid anisotropy or stretching, such as near solid boundaries. An accurate LES must therefore account for and model these commutation-error terms alongside the standard SGS stress tensor.",
            "answer": "$$\n\\boxed{2.85031 \\times 10^{-3}}\n$$"
        },
        {
            "introduction": "The choice of an SGS strategy has profound implications not just for physical accuracy but also for the numerical stability and computational cost of a simulation. This practice compares an explicit eddy-viscosity model with an Implicit LES (ILES) approach, where numerical dissipation provides the subgrid-scale effect . By deriving and comparing the time-step limitations for each strategy, you will understand the practical trade-offs between explicit modeling and relying on the implicit damping of the numerical scheme.",
            "id": "3367156",
            "problem": "Consider a one-dimensional, incompressible, large-eddy simulation (LES) of a homogeneous shear flow, linearized about a uniform mean advection. The resolved velocity fluctuation $u(x,t)$ satisfies the linear convection–diffusion model\n$$\n\\frac{\\partial u}{\\partial t} + U \\frac{\\partial u}{\\partial x} = \\frac{\\partial}{\\partial x}\\left[\\left(\\nu + \\nu_{t}\\right)\\frac{\\partial u}{\\partial x}\\right],\n$$\non a uniform grid with spacing $\\Delta$. The molecular kinematic viscosity is $\\nu$, the mean advection speed is $U$, and the subgrid-scale eddy viscosity is modeled by the Smagorinsky form $\\nu_{t} = C_{s}^{2}\\,\\Delta^{2}\\,|S|$, where $C_{s}$ is the Smagorinsky coefficient and $|S|$ is a prescribed constant magnitude of the resolved strain rate tensor. The spatial discretization uses second-order central differences for the diffusive operator, and a monotone first-order upwind flux for the convective operator (assume $U0$ so that upwind is taken from the left). Time advancement uses the classical third-order Strong Stability Preserving Runge–Kutta (SSP–RK$3$) method.\n\nTwo subgrid-scale strategies are considered:\n\n- Strategy A (explicit LES): use the explicit Smagorinsky eddy viscosity with $\\nu_{t} = C_{s}^{2}\\,\\Delta^{2}\\,|S|$.\n- Strategy B (implicit numerical damping, also called implicit LES): set $\\nu_{t}=0$ but rely on the numerical dissipation of the upwind flux, which for linear advection is equivalent, at leading order in wavenumber, to an effective viscosity $\\nu_{\\text{num}} = \\kappa\\,U\\,\\Delta$ with a given scheme-dependent constant $\\kappa0$.\n\nStarting from the linear convection–diffusion equation, the von Neumann Fourier symbol of the second-order discrete Laplacian, and the monotonicity condition for forward Euler time stepping of linear advection with first-order upwind flux, derive the forward Euler stability constraints for explicit integration of the semi-discrete system. Then, using the defining property of Strong Stability Preserving Runge–Kutta methods, deduce the maximum stable time step under SSP–RK$3$ for each strategy as the minimum of an advective bound and a diffusive bound. Express the diffusive bound in terms of the effective viscosity $\\nu_{\\text{eff}}$ (equal to $\\nu+\\nu_{t}$ in Strategy A and to $\\nu+\\nu_{\\text{num}}$ in Strategy B).\n\nUse the following parameter values:\n- $U = 2\\,\\text{m}\\,\\text{s}^{-1}$,\n- $\\nu = 1.0 \\times 10^{-5}\\,\\text{m}^{2}\\,\\text{s}^{-1}$,\n- $\\Delta = 1.0 \\times 10^{-3}\\,\\text{m}$,\n- $C_{s} = 0.17$,\n- $|S| = 5.0 \\times 10^{4}\\,\\text{s}^{-1}$,\n- $\\kappa = \\tfrac{1}{2}$.\n\nDefine the maximum stable time steps $\\Delta t_{\\text{A}}$ and $\\Delta t_{\\text{B}}$ for Strategies A and B, respectively, as the minima of their advective and diffusive bounds. Compute the ratio\n$$\nR \\equiv \\frac{\\Delta t_{\\text{B}}}{\\Delta t_{\\text{A}}},\n$$\nand report the value of $R$ rounded to three significant figures. Because $R$ is dimensionless, do not include any units in your final numerical answer.",
            "solution": "The problem requires the derivation of stability constraints for a one-dimensional linear convection-diffusion equation, discretized using specific numerical methods, under two different subgrid-scale modeling strategies. The final goal is to compute the ratio of the maximum stable time steps for these two strategies.\n\nThe governing equation for the resolved velocity fluctuation $u(x,t)$ is\n$$\n\\frac{\\partial u}{\\partial t} + U \\frac{\\partial u}{\\partial x} = \\frac{\\partial}{\\partial x}\\left[\\nu_{\\text{eff}}\\frac{\\partial u}{\\partial x}\\right]\n$$\nwhere $\\nu_{\\text{eff}}$ is the effective kinematic viscosity.\n\nThe spatial domain is discretized on a uniform grid with spacing $\\Delta$. The spatial operators are discretized as follows:\n1.  The convective term $\\frac{\\partial u}{\\partial x}$ is approximated using a first-order upwind scheme. For a mean advection speed $U0$, the operator at grid node $j$ is $\\frac{u_j - u_{j-1}}{\\Delta}$.\n2.  The diffusive term $\\frac{\\partial^2 u}{\\partial x^2}$ is approximated using a second-order central difference scheme: $\\frac{u_{j+1} - 2u_j + u_{j-1}}{\\Delta^2}$.\n\nSubstituting these discretizations into the governing equation yields the semi-discrete ordinary differential equation (ODE) for the velocity at node $j$:\n$$\n\\frac{du_j}{dt} = -U \\frac{u_j - u_{j-1}}{\\Delta} + \\nu_{\\text{eff}} \\frac{u_{j+1} - 2u_j + u_{j-1}}{\\Delta^2}\n$$\nThis system of ODEs is to be integrated in time using the third-order Strong Stability Preserving Runge-Kutta (SSP-RK$3$) method.\n\nThe problem directs us to first derive the stability constraints for the simpler forward Euler time-stepping method, and then use this result to deduce the constraint for SSP-RK$3$. For a linear problem decomposed into advective and diffusive parts, the overall stability constraint is typically taken as the minimum of the constraints imposed by each part.\n\nFirst, let's derive the forward Euler stability constraints.\n\n**Advective Stability Constraint:**\nConsider the pure advection equation, $ \\frac{\\partial u}{\\partial t} + U \\frac{\\partial u}{\\partial x} = 0$. The semi-discrete form using first-order upwind is $\\frac{du_j}{dt} = -U \\frac{u_j - u_{j-1}}{\\Delta}$. Applying the forward Euler method with time step $\\Delta t$:\n$$\nu_j^{n+1} = u_j^n - \\frac{U \\Delta t}{\\Delta} (u_j^n - u_{j-1}^n) = \\left(1 - \\frac{U \\Delta t}{\\Delta}\\right)u_j^n + \\frac{U \\Delta t}{\\Delta} u_{j-1}^n\n$$\nThe problem specifies using the monotonicity condition for stability. For the scheme to be monotone (i.e., not create new extrema), the coefficients of $u^n$ terms on the right-hand side must be non-negative. This requires:\n$$\n1 - \\frac{U \\Delta t}{\\Delta} \\ge 0 \\implies \\frac{U \\Delta t}{\\Delta} \\le 1\n$$\nThis gives the advective Courant-Friedrichs-Lewy (CFL) condition:\n$$\n\\Delta t \\le \\frac{\\Delta}{U} \\equiv \\Delta t_{\\text{adv}}\n$$\n\n**Diffusive Stability Constraint:**\nConsider the pure diffusion equation, $\\frac{\\partial u}{\\partial t} = \\nu_{\\text{eff}} \\frac{\\partial^2 u}{\\partial x^2}$. The semi-discrete form using second-order central differences is $\\frac{du_j}{dt} = \\nu_{\\text{eff}} \\frac{u_{j+1} - 2u_j + u_{j-1}}{\\Delta^2}$. Applying the forward Euler method:\n$$\nu_j^{n+1} = u_j^n + \\frac{\\nu_{\\text{eff}} \\Delta t}{\\Delta^2} (u_{j+1}^n - 2u_j^n + u_{j-1}^n)\n$$\nWe use von Neumann stability analysis. For a Fourier mode $u_j^n = g^n \\exp(ik j \\Delta)$, the amplification factor $g(k) = \\frac{u_j^{n+1}}{u_j^n}$ is:\n$$\ng(k) = 1 + \\frac{\\nu_{\\text{eff}} \\Delta t}{\\Delta^2} (\\exp(ik\\Delta) - 2 + \\exp(-ik\\Delta)) = 1 + \\frac{2\\nu_{\\text{eff}} \\Delta t}{\\Delta^2} (\\cos(k\\Delta) - 1)\n$$\nUsing the identity $\\cos(k\\Delta) - 1 = -2\\sin^2(\\frac{k\\Delta}{2})$, we get:\n$$\ng(k) = 1 - \\frac{4\\nu_{\\text{eff}} \\Delta t}{\\Delta^2} \\sin^2\\left(\\frac{k\\Delta}{2}\\right)\n$$\nFor stability, we require $|g(k)| \\le 1$ for all wavenumbers $k$. Since $g(k) \\le 1$, we only need to enforce $g(k) \\ge -1$. The minimum value of $g(k)$ occurs when $\\sin^2(\\frac{k\\Delta}{2}) = 1$ (i.e., for the highest frequency mode $k\\Delta = \\pi$).\n$$\ng_{\\text{min}} = 1 - \\frac{4\\nu_{\\text{eff}} \\Delta t}{\\Delta^2} \\ge -1 \\implies 2 \\ge \\frac{4\\nu_{\\text{eff}} \\Delta t}{\\Delta^2}\n$$\nThis gives the diffusive stability condition:\n$$\n\\Delta t \\le \\frac{2\\Delta^2}{4\\nu_{\\text{eff}}} = \\frac{\\Delta^2}{2\\nu_{\\text{eff}}} \\equiv \\Delta t_{\\text{diff}}\n$$\n\n**SSP-RK3 Stability Constraint:**\nThe problem states to use the defining property of SSP methods. A key property of SSP methods is that they preserve the stability properties (like monotonicity or total variation diminishing) of the forward Euler method under the same CFL constraint, potentially scaled by an SSP coefficient $C_{SSP}$. For the classical SSP-RK$3$ method, this coefficient is $C_{SSP}=1$. This implies that the stability constraints derived for the forward Euler method are sufficient for the SSP-RK$3$ method. Therefore, we take the maximum stable time step for the full convection-diffusion problem as the minimum of the advective and diffusive bounds:\n$$\n\\Delta t_{\\text{stable}} \\le \\min(\\Delta t_{\\text{adv}}, \\Delta t_{\\text{diff}}) = \\min\\left(\\frac{\\Delta}{U}, \\frac{\\Delta^2}{2\\nu_{\\text{eff}}}\\right)\n$$\n\nNow we apply this framework to the two strategies, using the given parameter values:\n- $U = 2\\,\\text{m}\\,\\text{s}^{-1}$\n- $\\nu = 1.0 \\times 10^{-5}\\,\\text{m}^{2}\\,\\text{s}^{-1}$\n- $\\Delta = 1.0 \\times 10^{-3}\\,\\text{m}$\n- $C_{s} = 0.17$\n- $|S| = 5.0 \\times 10^{4}\\,\\text{s}^{-1}$\n- $\\kappa = \\frac{1}{2}$\n\nThe advective time step limit is the same for both strategies, as it only depends on $U$ and $\\Delta$:\n$$\n\\Delta t_{\\text{adv}} = \\frac{\\Delta}{U} = \\frac{1.0 \\times 10^{-3}\\,\\text{m}}{2\\,\\text{m}\\,\\text{s}^{-1}} = 5.0 \\times 10^{-4}\\,\\text{s}\n$$\n\n**Strategy A: Explicit LES**\nThe effective viscosity $\\nu_{\\text{eff, A}}$ is the sum of molecular and subgrid-scale eddy viscosities:\n$$\n\\nu_{\\text{eff, A}} = \\nu + \\nu_t = \\nu + C_{s}^{2}\\,\\Delta^{2}\\,|S|\n$$\nSubstituting the values:\n$$\n\\nu_t = (0.17)^2 \\times (1.0 \\times 10^{-3}\\,\\text{m})^2 \\times (5.0 \\times 10^{4}\\,\\text{s}^{-1}) = 0.0289 \\times 10^{-6}\\,\\text{m}^2 \\times 5.0 \\times 10^{4}\\,\\text{s}^{-1} = 1.445 \\times 10^{-3}\\,\\text{m}^2\\,\\text{s}^{-1}\n$$\n$$\n\\nu_{\\text{eff, A}} = 1.0 \\times 10^{-5}\\,\\text{m}^2\\,\\text{s}^{-1} + 1.445 \\times 10^{-3}\\,\\text{m}^2\\,\\text{s}^{-1} = (0.01 + 1.445) \\times 10^{-3}\\,\\text{m}^2\\,\\text{s}^{-1} = 1.455 \\times 10^{-3}\\,\\text{m}^2\\,\\text{s}^{-1}\n$$\nThe diffusive time step limit for Strategy A is:\n$$\n\\Delta t_{\\text{diff, A}} = \\frac{\\Delta^2}{2\\nu_{\\text{eff, A}}} = \\frac{(1.0 \\times 10^{-3}\\,\\text{m})^2}{2 \\times 1.455 \\times 10^{-3}\\,\\text{m}^2\\,\\text{s}^{-1}} = \\frac{1.0 \\times 10^{-6}\\,\\text{m}^2}{2.91 \\times 10^{-3}\\,\\text{m}^2\\,\\text{s}^{-1}} \\approx 3.4364 \\times 10^{-4}\\,\\text{s}\n$$\nThe maximum stable time step for Strategy A is the minimum of the two bounds:\n$$\n\\Delta t_{\\text{A}} = \\min(\\Delta t_{\\text{adv}}, \\Delta t_{\\text{diff, A}}) = \\min(5.0 \\times 10^{-4}\\,\\text{s}, 3.4364 \\times 10^{-4}\\,\\text{s}) = 3.4364 \\times 10^{-4}\\,\\text{s}\n$$\n\n**Strategy B: Implicit LES (ILES)**\nIn this strategy, $\\nu_t=0$ and the effective viscosity $\\nu_{\\text{eff, B}}$ is the sum of molecular and numerical viscosities:\n$$\n\\nu_{\\text{eff, B}} = \\nu + \\nu_{\\text{num}} = \\nu + \\kappa\\,U\\,\\Delta\n$$\nSubstituting the values:\n$$\n\\nu_{\\text{num}} = \\frac{1}{2} \\times (2\\,\\text{m}\\,\\text{s}^{-1}) \\times (1.0 \\times 10^{-3}\\,\\text{m}) = 1.0 \\times 10^{-3}\\,\\text{m}^2\\,\\text{s}^{-1}\n$$\n$$\n\\nu_{\\text{eff, B}} = 1.0 \\times 10^{-5}\\,\\text{m}^2\\,\\text{s}^{-1} + 1.0 \\times 10^{-3}\\,\\text{m}^2\\,\\text{s}^{-1} = (0.01 + 1.0) \\times 10^{-3}\\,\\text{m}^2\\,\\text{s}^{-1} = 1.01 \\times 10^{-3}\\,\\text{m}^2\\,\\text{s}^{-1}\n$$\nThe diffusive time step limit for Strategy B is:\n$$\n\\Delta t_{\\text{diff, B}} = \\frac{\\Delta^2}{2\\nu_{\\text{eff, B}}} = \\frac{(1.0 \\times 10^{-3}\\,\\text{m})^2}{2 \\times 1.01 \\times 10^{-3}\\,\\text{m}^2\\,\\text{s}^{-1}} = \\frac{1.0 \\times 10^{-6}\\,\\text{m}^2}{2.02 \\times 10^{-3}\\,\\text{m}^2\\,\\text{s}^{-1}} \\approx 4.9505 \\times 10^{-4}\\,\\text{s}\n$$\nThe maximum stable time step for Strategy B is the minimum of the two bounds:\n$$\n\\Delta t_{\\text{B}} = \\min(\\Delta t_{\\text{adv}}, \\Delta t_{\\text{diff, B}}) = \\min(5.0 \\times 10^{-4}\\,\\text{s}, 4.9505 \\times 10^{-4}\\,\\text{s}) = 4.9505 \\times 10^{-4}\\,\\text{s}\n$$\n\n**Ratio of Time Steps**\nFinally, we compute the ratio $R \\equiv \\frac{\\Delta t_{\\text{B}}}{\\Delta t_{\\text{A}}}$:\n$$\nR = \\frac{4.9505 \\times 10^{-4}\\,\\text{s}}{3.4364 \\times 10^{-4}\\,\\text{s}} \\approx 1.44058\n$$\nRounding to three significant figures, the result is $1.44$.\n\nIn this problem, the explicit Smagorinsky model (Strategy A) introduces a larger effective viscosity than the numerical dissipation from the upwind scheme (Strategy B), with $\\nu_{\\text{eff, A}}  \\nu_{\\text{eff, B}}$. The diffusive time step constraint is more restrictive for larger viscosities ($\\Delta t_{\\text{diff}} \\propto 1/\\nu_{\\text{eff}}$). For both strategies, the diffusive limit was more restrictive than the advective one. Consequently, Strategy A, having the larger viscosity, is subject to a more stringent time step constraint, resulting in a ratio $R  1$.",
            "answer": "$$\n\\boxed{1.44}\n$$"
        }
    ]
}