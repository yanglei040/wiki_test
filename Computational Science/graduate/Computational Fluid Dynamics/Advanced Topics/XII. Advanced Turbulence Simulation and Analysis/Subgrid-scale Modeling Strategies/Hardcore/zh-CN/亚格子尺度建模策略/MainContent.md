## 引言
[大涡模拟](@entry_id:153702)（Large-Eddy Simulation, LES）作为一种先进的[湍流](@entry_id:151300)计算方法，在高保真度流场预测中扮演着日益重要的角色，它在计算成本与解析精度之间取得了精妙的平衡。与[直接数值模拟](@entry_id:149543)（DNS）试图解析所有尺度的[湍流](@entry_id:151300)运动不同，LES的核心思想是直接计算那些携带大部分能量的大尺度涡结构，而将小尺度的、更具普适性的[湍流](@entry_id:151300)脉动对大尺度运动的影响通过一个模型来参数化。这一模型的成败，即亚格子尺度（Subgrid-Scale, SGS）模型，直接决定了整个模拟的准确性和可靠性。

然而，如何精确地为这些未被解析的尺度建立模型，是LES方法中的核心“封闭问题”（closure problem）。一个理想的[SGS模型](@entry_id:754720)不仅需要正确地从可解尺度中耗散能量以维持数值稳定，还应能反映复杂的物理过程，如局部能量从SGS尺度到可解尺度的回传（即[反向散射](@entry_id:142561)）。本文旨在系统性地梳理和剖析各种SGS建模策略，填补从基础理论到前沿应用的知识鸿沟。

在接下来的内容中，读者将踏上一段从理论到实践的旅程。**第一章“原理与机制”**将深入探讨SGS建模的理论基石，从[空间滤波](@entry_id:202429)的数学性质出发，详细阐述函数型、结构型及动态模型等主流方法的构建原理和物理内涵。**第二章“应用与跨学科连接”**将展示这些模型如何在工程壁[湍流](@entry_id:151300)、地球物理流体以及与数据科学[交叉](@entry_id:147634)等多样化场景中得到应用和发展。最后，**第三章“动手实践”**将通过一系列精心设计的问题，引导读者将理论知识转化为解决实际问题的能力。

## 原理与机制

继前一章介绍了[大涡模拟](@entry_id:153702) (Large-Eddy Simulation, LES) 的基本思想之后，本章将深入探讨亚格子尺度 (Subgrid-Scale, SGS) 建模策略的核心原理与关键机制。LES 的精髓在于，它不试图解析[湍流](@entry_id:151300)中的所有尺度，而是通过[空间滤波](@entry_id:202429)将流场划分为可解的大尺度结构和需要建模的小尺度结构。这种划分的成功与否，以及整个模拟的物理保真度和数值稳定性，都高度依赖于我们如何精确地描述和建模亚格子尺度对可解尺度运动的影响。本章将系统性地阐述从滤波操作的数学基础，到各类主流 SGS 模型的物理假设、构造方法及其在[湍流能量级串](@entry_id:194234)中的作用。

### 亚格子尺度建模的理论基础：[空间滤波](@entry_id:202429)

LES 的数学框架始于对瞬时纳维-斯托克斯 (Navier-Stokes) 方程应用一个低通[空间滤波](@entry_id:202429)器。此操作旨在分离出大尺度的、能量主要的涡结构，同时平滑掉小尺度的、更具普遍性的[湍流](@entry_id:151300)运动。

#### 滤波操作及其性质

一个物理量 $\phi(\mathbf{x}, t)$ 的滤波过程通常定义为一个[卷积积分](@entry_id:155865)：
$$
\bar{\phi}(\mathbf{x},t) = \int G(\mathbf{x}-\mathbf{r}; \Delta)\,\phi(\mathbf{r},t)\,d\mathbf{r}
$$
其中 $G$ 是滤波核，$\Delta$ 是特征滤波宽度，它定义了可解尺度与亚格子尺度之间的界限。为了确保滤波后的方程在形式上保持一致且物理意义明确，滤波操作本身必须满足一系列关键性质 。

首先，滤波必须是 **线性** 的，即 $\overline{a\phi + b\psi} = a\bar{\phi} + b\bar{\psi}$。这保证了我们可以将滤波操作逐项应用于控制方程的各项。

其次，为了保持常数的性质，滤波核必须是 **归一化** 的，即 $\int G(\mathbf{r}; \Delta) d\mathbf{r} = 1$。这一性质确保了对一个常数场进行滤波会得到其自身，例如 $\overline{c} = c$。这在处理像密度 $\rho$ 或粘性系数 $\nu$ 这样的常数系数时至关重要。

再次，为了推导出不含额外交换误差项的滤波后方程，滤波操作必须与时间和空间导数 **可交换**。当滤波核 $G$ 及其宽度 $\Delta$ 不随时间变化时，滤波与时间导数可交换 ($\overline{\partial_t \phi} = \partial_t \bar{\phi}$)。当滤波核具有空间平移不变性（即 $G(\mathbf{x}, \mathbf{r}) = G(\mathbf{x}-\mathbf{r})$）且滤波宽度 $\Delta$ 在空间上为常数时，滤波与空间导数可交换 ($\overline{\nabla \phi} = \nabla \bar{\phi}$)。这一性质直接保证了滤波后的[速度场散度](@entry_id:178755)为零（对于不可压流动），即由 $\nabla \cdot \mathbf{u} = 0$ 可以直接得到 $\nabla \cdot \bar{\mathbf{u}} = 0$ 。

然而，LES 的核心挑战源于滤波操作与[非线性](@entry_id:637147)项的 **不可交换性**。具体而言，[对流](@entry_id:141806)项的滤波结果 $\overline{u_i u_j}$ 不等于滤波后速度乘积 $\bar{u}_i \bar{u}_j$。这种差异产生了必须被建模的 **亚格子尺度 (SGS) [应力张量](@entry_id:148973)** $\tau_{ij}$：
$$
\tau_{ij} \equiv \overline{u_i u_j} - \bar{u}_i \bar{u}_j
$$
这个张量代表了未解析的亚格子尺度运动通过[动量输运](@entry_id:139628)对已解析的可解尺度运动产生的影响。如何为 $\tau_{ij}$ 构建一个仅依赖于可解尺度场 $\bar{\mathbf{u}}$ 的封闭模型，是 LES 的核心问题，即 **封闭问题 (closure problem)**。

#### 滤波宽度的定义

滤波宽度 $\Delta$ 在物理上代表了可解尺度与亚格子尺度之间的[分界线](@entry_id:175112)。在实际的 LES 计算中，滤波通常是隐式地由计算网格提供的，因此 $\Delta$ 与网格尺寸直接相关。对于各向同性的笛卡尔网格，$\Delta$ 通常取为网格边长。然而，在处理复杂几何时，网格往往是各向异性的，即在不同方向上具有不同的网格间距 $(\Delta x, \Delta y, \Delta z)$。在这种情况下，如何为各向同性的 SGS 模型定义一个标量的滤波宽度 $\Delta$ 是一个重要问题 。

一个普遍接受且理论上合理的做法是采用“等效体积”原理。这可以从物理空间和[波数](@entry_id:172452)空间两个角度来理解：
- **物理空间角度**：一个各向异性的网格单元体积为 $V_{\text{cell}} = \Delta x \Delta y \Delta z$。这可以被看作是能够解析的最小湍流涡的体积。如果我们用一个等效的各向同性立方体来代表这个解析能力，其体积为 $\Delta^3$，那么令两者相等，即 $\Delta^3 = \Delta x \Delta y \Delta z$，便得到 $\Delta = (\Delta x \Delta y \Delta z)^{1/3}$。
- **[波数](@entry_id:172452)空间角度**：根据[采样理论](@entry_id:268394)，一个间距为 $\Delta x_i$ 的网格最多能解析到奈奎斯特[波数](@entry_id:172452) $|k_i| \le \pi/\Delta x_i$。因此，[各向异性网格](@entry_id:746450)所能解析的波数空间是一个长方体。一个各向同性的 SGS 模型则隐含地假设了一个球形的[波数](@entry_id:172452)截断 $| \mathbf{k} | \le k_c$。为了保留相同数量的解析模式，我们可以令球体体积与长方体体积相等，由此推导出 $k_c \propto (\Delta x \Delta y \Delta z)^{-1/3}$。由于滤波宽度与截断波数成反比（例如 $\Delta \propto \pi/k_c$），这同样导出了 $\Delta$ 与几何平均值 $(\Delta x \Delta y \Delta z)^{1/3}$ 成正比的结论。

因此，将滤波宽度定义为网格尺寸的几何平均值，是在[各向异性网格](@entry_id:746450)上应用各向同性 SGS 模型的标准做法。

### 亚格子尺度应力与能量级串

SGS [应力张量](@entry_id:148973) $\tau_{ij}$ 不仅仅是一个数学上的余项，它在物理上扮演着至关重要的角色：调节可解尺度与亚格子尺度之间的能量交换。

#### 能量交换与[反向散射](@entry_id:142561)

为了理解这一点，我们推导可解尺度动能 $K = \frac{1}{2} \bar{u}_i \bar{u}_i$ 的输运方程。通过将滤波后的动量方程与 $\bar{u}_i$ 做[内积](@entry_id:158127)，可以得到可解尺度动能的演化方程，其中包含一个源项，代表了 SGS 应力所做的功：
$$
\Pi = - \tau_{ij} \bar{S}_{ij}
$$
其中 $\bar{S}_{ij} = \frac{1}{2}(\partial_j \bar{u}_i + \partial_i \bar{u}_j)$ 是可解尺度[应变率张量](@entry_id:266108)。$\Pi$ 这个量描述了单位时间内从可解尺度到亚格子尺度的动能[传递率](@entry_id:756124)，通常被称为 **SGS 耗散**。

根据三维[湍流](@entry_id:151300)的能量级串理论，能量主要从大尺度[涡流](@entry_id:271366)向小尺度涡，并最终在黏性尺度上耗散。因此，我们期望在宏观上，能量是从可解尺度流向亚格子尺度的，即空间和[时间平均](@entry_id:267915)的 $\langle \Pi \rangle > 0$。这个过程被称为 **正向散射 (forward scatter)**。

然而，[湍流](@entry_id:151300)的瞬时动力学要复杂得多。在局部区域，小尺度涡可能组织起来，将其能量反馈给大尺度涡。这种从亚格子尺度到可解尺度的能量回传过程，对应于 $\Pi  0$，被称为 **[反向散射](@entry_id:142561) (backscatter)** 。虽然在统计平均意义下次要，但[反向散射](@entry_id:142561)是[湍流](@entry_id:151300)物理中一个真实且重要的现象。对于 SGS 模型而言，能否准确地描述这种双向能量交换，是衡量其物理保真度的重要标准。

从数值角度看，正向散射（耗散）起到稳定作用，它从可解尺度中移除了能量，防止了能量在网格截断[波数](@entry_id:172452)附近的过度堆积。相反，[反向散射](@entry_id:142561)（能量注入）则可能导致数值不稳定。如果一个模型允许无限制的[反向散射](@entry_id:142561)，就可能导致能量在最高[波数](@entry_id:172452)处无限累积，最终使模拟发散 。

### 函数型模型：涡粘性概念

最古老也最广泛的一类 SGS 模型是函数型模型 (functional models)，其核心思想是将 SGS 应力的作用类比于分子粘性的作用，即假设小尺度[湍流](@entry_id:151300)对大尺度运动的影响表现为一种增强的耗散。

#### Smagorinsky 模型

这一思想的数学体现是 **涡粘性假说 (eddy-viscosity hypothesis)**，它假设 SGS 应力的各向异性部分与可解尺度[应变率张量](@entry_id:266108)成正比：
$$
\tau_{ij} - \frac{1}{3}\tau_{kk}\delta_{ij} = -2\nu_t \bar{S}_{ij}
$$
这里，$\nu_t$ 是涡粘性系数，它不是流体的物理属性，而是依赖于流动状态的量。

在不可压流动中，SGS 应力的迹 $\tau_{kk} = \overline{u_k u_k} - \bar{u}_k \bar{u}_k$（代表两倍的亚格子尺度动能）的作用可以通过将其并入压力项来处理。滤波后的[动量方程](@entry_id:197225)中的 SGS 项 $-\partial_j \tau_{ij}$ 可以被分解为：
$$
-\partial_j \tau_{ij} = -\partial_j \left( \tau_{ij} - \frac{1}{3}\tau_{kk}\delta_{ij} \right) - \partial_i \left( \frac{1}{3}\tau_{kk} \right)
$$
后一项是一个标量的梯度，可以与[压力梯度](@entry_id:274112)合并，定义一个修正后的压力 $\pi^* = \bar{p}/\rho + \frac{1}{3}\tau_{kk}$。因此，在不可压 LES 中，我们通常只需要为 SGS 应力的各向异性部分建模 。

**Smagorinsky 模型** 是最早也是最经典的涡粘性模型。它通过量纲分析构建了 $\nu_t$ 的表达式。在一个仅由滤波宽度 $\Delta$（长度尺度）和可解尺度[应变率](@entry_id:154778)大小 $|\bar{S}| = (2\bar{S}_{mn}\bar{S}_{mn})^{1/2}$（时间尺度的倒数）决定的系统中，唯一能凑出运动粘度单位 ($L^2 T^{-1}$) 的组合是 $\Delta^2 |\bar{S}|$。因此，Smagorinsky 模型定义：
$$
\nu_t = (C_s \Delta)^2 |\bar{S}|
$$
其中 $C_s$ 是一个无量纲的 Smagorinsky 常数。

Smagorinsky 模型的优点是简单、鲁棒且具有强耗散性，能有效抑制[数值不稳定性](@entry_id:137058)。然而，其主要缺点也正源于此：它是一个纯耗散模型。由于 $\nu_t \ge 0$ 且 $\bar{S}_{ij}\bar{S}_{ij} \ge 0$，其对应的 SGS 耗散 $\Pi = 2\nu_t \bar{S}_{ij}\bar{S}_{ij}$ 永远为非负值。这意味着 Smagorinsky 模型无法描述物理上存在的[反向散射](@entry_id:142561)现象，并因此倾向于在可解尺度上造成过度耗散 。

### 结[构型模型](@entry_id:747676)：[尺度相似性](@entry_id:754548)概念

为了克服涡粘性模型的局限性，特别是其无法描述真实 SGS 应力结构和[反向散射](@entry_id:142561)的问题，另一类被称为结[构型模型](@entry_id:747676) (structural models) 的方法被提出来。

#### Bardina 模型

结[构型模型](@entry_id:747676)的核心是 **[尺度相似性](@entry_id:754548)假说**：即在[惯性子区](@entry_id:273327)内，[湍流](@entry_id:151300)具有自相似的结构，因此紧邻[截断尺度](@entry_id:748127)之下（即亚格子尺度）的应力结构，应与紧邻[截断尺度](@entry_id:748127)之上（即可解的最小尺度）的应力结构相似。

**Bardina 模型** 是这一思想的直接体现 。它利用一个比网格滤波 $\Delta$ 更粗的 **测试滤波器** (test filter) $\tilde{\Delta} = \alpha \Delta$（其中 $\alpha>1$）来探测可解尺度范围内的应力。作用在可解尺度场 $\bar{u}_i$ 上的测试滤波器（用波浪号 $\sim$ 表示）会产生一个“可解的”应力张量，通常称为 **伦纳德应力 (Leonard stress)**：
$$
L_{ij} = \widetilde{\bar{u}_i \bar{u}_j} - \tilde{\bar{u}}_i \tilde{\bar{u}}_j
$$
这个张量 $L_{ij}$ 是完全可计算的，因为它只依赖于已知的可解场 $\bar{u}_i$。[尺度相似性](@entry_id:754548)假说认为，未知的 SGS 应力 $\tau_{ij}$ 可以由这个可计算的 $L_{ij}$ 来近似。因此，Bardina 模型为：
$$
\tau_{ij}^{\mathrm{B}} = L_{ij} = \widetilde{\bar{u}_i \bar{u}_j} - \tilde{\bar{u}}_i \tilde{\bar{u}}_j
$$
Bardina 模型的优点在于，它与真实的 SGS 应力有很高的相关性，并且能够自然地产生正和负的 SGS 耗散，即可以描述[反向散射](@entry_id:142561)。然而，它的缺点是耗散性不足，单独使用时往往无法提供足够的能量耗散来维持[数值稳定性](@entry_id:146550)。

### 先进建模策略

现代 SGS 建模的趋势是将函数型模型的稳定性和结[构型模型](@entry_id:747676)的物理保真度结合起来，或者发展出能够自适应地调整模型参数的策略。

#### [混合模型](@entry_id:266571)

一个直接的思路是构建 **[混合模型](@entry_id:266571) (mixed model)**，将 Bardina 模型和一个涡粘性模型线性组合：
$$
\tau_{ij}^{\mathrm{mix}} = \tau_{ij}^{\mathrm{B}} - 2 \nu_t \bar{S}_{ij}
$$
其对应的 SGS 耗散为 $\Pi^{\mathrm{mix}} = -\tau_{ij}^{\mathrm{B}}\bar{S}_{ij} + 2\nu_t \bar{S}_{ij}\bar{S}_{ij}$ 。在这个模型中，$\tau_{ij}^{\mathrm{B}}$ 部分负责提供正确的应力结构和描述[反向散射](@entry_id:142561)（$-\tau_{ij}^{\mathrm{B}}\bar{S}_{ij}$ 项可正可负），而涡粘性部分则提供一个恒为正的背景耗散（$2\nu_t \bar{S}_{ij}\bar{S}_{ij} \ge 0$），以保证整体模型的[数值稳定性](@entry_id:146550)。通过合理选择 $\nu_t$（可以是一个常数，或通过更先进的方法确定），混合模型可以在捕捉物理真实性的同时避免模拟发散。

#### 动态模型

**动态程序 (dynamic procedure)** 是 LES 发展史上的一个里程碑。它利用[尺度相似性](@entry_id:754548)的思想，但不是直接用可解应力来建模，而是用它来动态地、实时地确定涡粘性模型中的系数。

其理论基础是 **Germano 恒等式**。通过引入测试滤波器，可以建立一个连接不同尺度应力的精确关系：$L_{ij} = T_{ij} - \tilde{\tau}_{ij}$，其中 $T_{ij} = \widetilde{u_i u_j} - \tilde{u}_i \tilde{u}_j$ 是测试尺度上的 SGS 应力。如果我们假设某个模型形式（如 Smagorinsky 模型）在网格尺度和测试尺度上都成立，只是模型系数相同，就可以将模型代入 Germano 恒等式，从而得到一个关于模型系数的[代数方程](@entry_id:272665)。这个方程的解（通常通过[最小二乘法](@entry_id:137100)获得）依赖于瞬时可解流场，因此模型系数可以随时间和空间自适应地变化。

对可解应力 $L_{ij}$ 的进一步分解，有助于理解不同尺度间的相互作用。将可解速度分解为测试滤波[部分和](@entry_id:162077)残余部分 $\bar{u}_i = \tilde{\bar{u}}_i + r_i$，可以把 $L_{ij}$ 分解为三部分 ：
- **伦纳德分量** $L_{ij} = \widetilde{\tilde{\bar{u}}_i \tilde{\bar{u}}_j} - \tilde{\bar{u}}_i \tilde{\bar{u}}_j$ （大-大尺度相互作用）
- **[交叉](@entry_id:147634)分量** $C_{ij} = \widetilde{\tilde{\bar{u}}_i r_j} + \widetilde{r_i \tilde{\bar{u}}_j}$ （大-小尺度相互作用）
- **雷诺兹分量** $R_{ij} = \widetilde{r_i r_j}$ （小-小尺度相互作用）
这个分解清晰地展示了可解尺度内部的[非线性](@entry_id:637147)相互作用是如何产生应力的。

动态程序的一个显著特点是，它计算出的涡粘性系数可能是负的。从 SGS 耗散 $\Pi = 2\nu_t \bar{S}_{ij}\bar{S}_{ij}$ 的角度看，$\nu_t  0$ 恰恰对应于物理上的[反向散射](@entry_id:142561) 。这使得动态模型能够比标准 Smagorinsky 模型更真实地反映能量交换过程。

然而，允许负粘性也带来了数值稳定性的挑战。实践中，必须对动态计算出的系数进行某种形式的“约束”或“裁剪 (clipping)”。简单的局部裁剪，如 $\nu_t^{\text{clip}} = \max(0, \nu_t^{\text{dyn}})$，虽然能保证稳定性，但系统性地移除了所有[反向散射](@entry_id:142561)，引入了偏误。更先进的策略是采用全局约束，例如，只在积分意义上要求总的 SGS 耗散为正。一种精巧的方法是计算全场总的正耗散贡献 $P$ 和总的负耗散贡献 $N$，如果 $N>P$，则将所有负粘性区域的系[数乘](@entry_id:155971)以一个小于1的因子 $\alpha = P/N$，从而恰好使总耗散为零。这种方法在保证整体稳定性的同时，最大限度地保留了动态程序预测的物理行为 。

### 理论扩展与复杂因素

以上讨论主要基于不可压流动和均匀滤波。在更实际的应用中，这些假设需要被放宽。

#### [可压缩流](@entry_id:747589)动

对于可压缩流动，密度 $\rho$ 成为变量，这给滤波操作带来了额外的复杂性。为了简化滤波后的方程，通常采用 **Favre 滤波** 或质量加权滤波，其定义为 $\tilde{\phi} \equiv \overline{\rho\phi}/\bar{\rho}$。

Favre 滤波的主要优势在于，它使得滤波后的[连续性方程](@entry_id:195013)中不出现 SGS 项 。SGS 质量通量 $m_i \equiv \overline{\rho u_i} - \bar{\rho} \tilde{u}_i$ 根据定义恒为零。然而，在动量和能量方程中仍会出现新的 SGS 项：
- **Favre 滤波 SGS 应力**：$\tau_{ij}^{\mathrm{F}} = \overline{\rho u_i u_j} - \bar{\rho} \tilde{u}_i \tilde{u}_j$
- **SGS [热通量](@entry_id:138471)**：$q_i^{\text{sgs}}$，源于速度与[热力学变量](@entry_id:160587)（如焓或温度）的未解析关联。

对这些项的建模也遵循与不可压情况类似的思路。$\tau_{ij}^{\mathrm{F}}$ 通常通过可压缩涡粘性模型来封闭，其形式需考虑可压缩效应，包含各向同性部分（与 SGS 动能相关）和依赖于可解应变率张量 $\tilde{S}_{ij}$ 的各向异性部分。SGS 热通量则通常采用[梯度扩散假说](@entry_id:156064)，通过引入一个 **[湍流普朗特数](@entry_id:153739)** $Pr_t$ 将其与涡粘性系数联系起来：
$$
q_i^{\text{sgs}} \approx - \frac{\mu_t c_p}{Pr_t} \partial_i \tilde{T}
$$
其中 $\mu_t = \bar{\rho}\nu_t$ 是涡[动力粘度](@entry_id:268228) 。

#### 变化的滤波宽度

在[非均匀网格](@entry_id:752607)上进行 LES 时，隐式的滤波宽度 $\Delta$ 会随空间位置 $\mathbf{x}$ 变化。这导致了一个重要的数学复杂性：滤波操作不再与空间导数交换。其 **交换误差** 定义为 $\mathcal{E}_i[f] \equiv \overline{\partial_i f} - \partial_i \bar{f}$。

这个误差项会在滤波后的控制方程中作为额外的源项出现。例如，滤波后的连续性方程变为 $\partial_i \bar{u}_i = -\mathcal{E}_i[u_i]$。对于高斯滤波，可以推导出交换误差的领头阶表达式 ：
$$
\mathcal{E}_i[f](\boldsymbol{x}) \approx \frac{1}{2} \frac{\partial(\sigma^2)}{\partial x_i} \nabla^2 f(\boldsymbol{x})
$$
其中 $\sigma(\mathbf{x})$ 是与 $\Delta(\mathbf{x})$ 成正比的高斯核宽度。此表达式表明，交换误差在滤波宽度梯度大且被滤波[场曲](@entry_id:162957)率大的区域最为显著。

一个典型的例子是近壁区的[湍流](@entry_id:151300)。为了解析壁面附近的剧烈梯度，LES 网格必须在法向方向上急剧加密，导致 $\partial(\sigma^2)/\partial y$ 很大。同时，平均速度剖面在近壁区（特别是[缓冲层](@entry_id:160164)）具有很强的曲率 $\partial_{yy} U_x$。这两者的乘积使得交换误差项变得非常重要，若被忽略，将导致对壁面[摩擦力](@entry_id:171772)等关键物理量的预测出现严重偏差。例如，对于一个二次[速度剖面](@entry_id:266404) $u_x = Sy^2$ 和[幂律](@entry_id:143404)变化的滤波宽度 $\sigma = \kappa y^p$，可以精确计算出交换误差为 $\mathcal{E}_y[u_x] = 2 S p \kappa^2 y^{2p-1}$，这清晰地量化了该效应的大小 。在先进的 LES 方法中，必须对这些交换误差项进行建模或通过特殊[数值格式](@entry_id:752822)来处理。