{
    "hands_on_practices": [
        {
            "introduction": "在大尺度模拟（LES）的理论推导中，我们通常假设滤波算子和微分算子是可交换的。然而，在实际的计算流体动力学应用中，为了解析边界层等区域的复杂流动，非均匀网格的使用非常普遍。在此类网格上，滤波宽度随空间位置变化，导致滤波与微分不再可交换，从而产生“交换误差”。这个练习将指导你通过泰勒级数展开，亲手推导并量化这一重要误差，帮助你深刻理解在非均匀网格上实现高保真度LES所面临的挑战 ()。",
            "id": "3367139",
            "problem": "考虑一个不可压缩流的一维大涡模拟 (LES)，其中亚格子尺度效应通过对速度场进行空间滤波来表示。设物理坐标为 $x \\in [0,1]$，计算坐标为 $\\xi \\in [0,1]$，它们通过拉伸网格映射 $x(\\xi) = \\xi^{3}$ 相关联。假设均匀计算间距为 $\\Delta_{\\xi} = 0.02$ (无量纲)，物理滤波器为与位置相关的顶帽滤波器：\n$$\n\\bar{u}(x) = \\frac{1}{\\Delta(x)} \\int_{x - \\Delta(x)/2}^{x + \\Delta(x)/2} u(s) \\, ds,\n$$\n其中 $\\Delta(x)$ 是由该映射引起的局部物理滤波宽度，定义为 $\\Delta(x) = \\Delta_{\\xi} \\, \\frac{dx}{d\\xi}\\big|_{\\xi(x)}$，其中 $\\xi(x)$ 满足 $\\xi^{3} = x$。滤波和微分之间的交换误差定义为\n$$\nC(x) = \\overline{\\partial_{x} u}(x) - \\partial_{x} \\bar{u}(x).\n$$\n从上述算子定义出发，且不使用任何快捷公式，推导 $C(x)$ 关于 $\\Delta(x)$、$\\partial_{x} \\Delta(x)$ 和 $u(x)$ 的导数的主阶渐近表达式，假设 $\\Delta(x)$ 相对于 $u(x)$ 的特征长度尺度很小。然后，对于速度场 $u(x) = U_{0} \\sin(k x)$（其中 $U_{0} = 1.2 \\, \\mathrm{m/s}$，$k = 5 \\, \\mathrm{m}^{-1}$），使用上述映射计算 $x_0$ 处的 $\\Delta(x)$ 和 $\\partial_{x} \\Delta(x)$，从而计算 $C(x)$ 在 $x_{0} = 0.5$ 处的值。\n\n简要讨论此类交换误差如何影响 LES 封闭模型中建模的亚格子尺度应力，但最终答案仅提供 $C(x_{0})$ 的数值。最终值以 $\\mathrm{s}^{-1}$ 为单位表示，并将结果四舍五入到六位有效数字。",
            "solution": "首先根据指定标准对问题进行验证。\n\n### 问题验证\n\n**第1步：提取已知条件**\n-   **系统**：不可压缩流的一维大涡模拟 (LES)。\n-   **坐标**：物理坐标 $x \\in [0,1]$，计算坐标 $\\xi \\in [0,1]$。\n-   **映射**：$x(\\xi) = \\xi^{3}$。\n-   **计算间距**：$\\Delta_{\\xi} = 0.02$ (无量纲)。\n-   **滤波器定义**：与位置相关的顶帽滤波器 $\\bar{u}(x) = \\frac{1}{\\Delta(x)} \\int_{x - \\Delta(x)/2}^{x + \\Delta(x)/2} u(s) \\, ds$。\n-   **滤波宽度**：$\\Delta(x) = \\Delta_{\\xi} \\, \\frac{dx}{d\\xi}\\big|_{\\xi(x)}$，其中 $\\xi(x)$ 由 $\\xi^{3} = x$ 定义。\n-   **交换误差**：$C(x) = \\overline{\\partial_{x} u}(x) - \\partial_{x} \\bar{u}(x)$。\n-   **假设**：$\\Delta(x)$ 相对于 $u(x)$ 的特征长度尺度很小。\n-   **任务1**：推导 $C(x)$ 关于 $\\Delta(x)$、$\\partial_{x} \\Delta(x)$ 和 $u(x)$ 的导数的主阶渐近表达式。\n-   **任务2**：计算 $C(x_0)$ 在 $x_0 = 0.5$ 处的值。\n-   **速度场**：$u(x) = U_{0} \\sin(k x)$，其中 $U_{0} = 1.2 \\, \\mathrm{m/s}$，$k = 5 \\, \\mathrm{m}^{-1}$。\n-   **最终答案要求**：$C(x_{0})$ 的数值，以 $\\mathrm{s}^{-1}$ 为单位，四舍五入到六位有效数字。\n\n**第2步：使用提取的已知条件进行验证**\n-   **科学依据**：该问题在计算流体动力学理论，特别是大涡模拟领域，有充分的科学依据。网格变换、空间滤波和交换误差等概念是该领域的标准课题。所需的数学方法是泰勒级数展开和微积分，这些都是基础。\n-   **适定性**：该问题是自洽的，提供了推导表达式和计算数值所需的所有必要函数、参数和条件。存在唯一解。\n-   **客观性**：语言技术性强、精确，且不含任何主观或基于观点的陈述。\n-   **量纲一致性**：给定的 $U_0$ 和 $k$ 值意味着 $x$ 的单位是米。域 $x \\in [0,1]$ 被解释为感兴趣的物理域为 $[0,1]$ 米。在此解释下，单位是一致的，最终将按要求得出 $C(x)$ 的单位为 $\\mathrm{s}^{-1}$。\n\n**第3步：结论与行动**\n该问题有效。它在科学上是合理的、适定的、客观的，并且不包含任何模糊或矛盾之处。将提供完整的解答。\n\n### 交换误差的推导\n\n交换误差定义为 $C(x) = \\overline{\\partial_{x} u}(x) - \\partial_{x} \\bar{u}(x)$。我们将在滤波宽度 $\\Delta(x)$ 很小的假设下，使用泰勒级数展开分别分析每一项。\n\n**第一项：$\\overline{\\partial_{x} u}(x)$**\n令 $f(s) = \\partial_s u(s)$。$f(x)$ 滤波后的值为：\n$$\n\\overline{f}(x) = \\frac{1}{\\Delta(x)} \\int_{x - \\Delta(x)/2}^{x + \\Delta(x)/2} f(s) \\, ds\n$$\n我们将 $f(s)$ 在 $s=x$ 附近展开为泰勒级数：\n$$\nf(s) = f(x) + (s-x) f'(x) + \\frac{(s-x)^2}{2!} f''(x) + \\mathcal{O}((s-x)^3)\n$$\n将其代入积分：\n$$\n\\int_{x - \\Delta/2}^{x + \\Delta/2} f(s) \\, ds = \\int_{x - \\Delta/2}^{x + \\Delta/2} \\left[ f(x) + (s-x) f'(x) + \\frac{(s-x)^2}{2} f''(x) + \\dots \\right] ds\n$$\n$(s-x)$ 的奇次幂在对称区间上的积分为零。我们计算其余各项：\n$$\n\\int_{x - \\Delta/2}^{x + \\Delta/2} f(x) \\, ds = f(x) \\Delta(x)\n$$\n$$\n\\int_{x - \\Delta/2}^{x + \\Delta/2} \\frac{(s-x)^2}{2} f''(x) \\, ds = \\frac{f''(x)}{2} \\left[ \\frac{(s-x)^3}{3} \\right]_{x - \\Delta/2}^{x + \\Delta/2} = \\frac{f''(x)}{6} \\left[ \\left(\\frac{\\Delta}{2}\\right)^3 - \\left(-\\frac{\\Delta}{2}\\right)^3 \\right] = \\frac{f''(x)}{6} \\frac{2\\Delta^3}{8} = \\frac{\\Delta^3}{24} f''(x)\n$$\n因此，积分为 $f(x) \\Delta(x) + \\frac{\\Delta(x)^3}{24} f''(x) + \\mathcal{O}(\\Delta^5)$。\n除以 $\\Delta(x)$，我们得到滤波后的值：\n$$\n\\overline{f}(x) = f(x) + \\frac{\\Delta(x)^2}{24} f''(x) + \\mathcal{O}(\\Delta^4)\n$$\n代入 $f(x) = \\partial_x u(x)$，我们有：\n$$\n\\overline{\\partial_x u}(x) = \\partial_x u(x) + \\frac{\\Delta(x)^2}{24} \\partial_x^3 u(x) + \\mathcal{O}(\\Delta^4)\n$$\n\n**第二项：$\\partial_{x} \\bar{u}(x)$**\n我们从 $\\bar{u}(x)$ 的定义开始，使用莱布尼茨积分法则对 $x$ 求导：\n$$\n\\partial_x \\bar{u}(x) = \\partial_x \\left[ \\frac{1}{\\Delta(x)} \\int_{x - \\Delta(x)/2}^{x + \\Delta(x)/2} u(s) \\, ds \\right]\n$$\n$$\n= \\left( \\partial_x \\frac{1}{\\Delta(x)} \\right) \\int_{x - \\Delta/2}^{x + \\Delta/2} u(s) \\, ds + \\frac{1}{\\Delta(x)} \\partial_x \\left( \\int_{x - \\Delta/2}^{x + \\Delta/2} u(s) \\, ds \\right)\n$$\n使用乘法法则和链式法则，$\\partial_x (1/\\Delta) = -(\\partial_x \\Delta)/\\Delta^2$。令 $\\Delta' = \\partial_x \\Delta$。\n对第二部分使用莱布尼茨法则可得：\n$$\n\\partial_x \\left( \\int_{x - \\Delta/2}^{x + \\Delta/2} u(s) \\, ds \\right) = u(x+\\Delta/2) \\partial_x(x+\\Delta/2) - u(x-\\Delta/2) \\partial_x(x-\\Delta/2)\n$$\n$$\n= u(x+\\Delta/2) \\left(1 + \\frac{\\Delta'}{2}\\right) - u(x-\\Delta/2) \\left(1 - \\frac{\\Delta'}{2}\\right)\n$$\n我们将 $u(s)$ 在 $s=x$ 附近进行泰勒展开，直到三阶：\n$$\nu(s) = u(x) + (s-x)\\partial_x u(x) + \\frac{(s-x)^2}{2}\\partial_x^2 u(x) + \\frac{(s-x)^3}{6}\\partial_x^3 u(x) + \\mathcal{O}((s-x)^4)\n$$\n$u(x\\pm\\Delta/2)$ 项为：\n$$\nu(x+\\Delta/2) = u + \\frac{\\Delta}{2}u' + \\frac{\\Delta^2}{8}u'' + \\frac{\\Delta^3}{48}u''' + \\mathcal{O}(\\Delta^4)\n$$\n$$\nu(x-\\Delta/2) = u - \\frac{\\Delta}{2}u' + \\frac{\\Delta^2}{8}u'' - \\frac{\\Delta^3}{48}u''' + \\mathcal{O}(\\Delta^4)\n$$\n积分项可以像我们处理 $\\overline{f}(x)$ 那样进行近似：\n$$\n\\int_{x - \\Delta/2}^{x + \\Delta/2} u(s) \\, ds = u\\Delta + \\frac{\\Delta^3}{24}u'' + \\mathcal{O}(\\Delta^5)\n$$\n$\\partial_x \\bar{u}(x)$ 的第一部分是：\n$$\n-\\frac{\\Delta'}{\\Delta^2} \\left( u\\Delta + \\frac{\\Delta^3}{24}u'' \\right) = -\\frac{u\\Delta'}{\\Delta} - \\frac{\\Delta\\Delta'}{24}u'' + \\mathcal{O}(\\Delta^3)\n$$\n对于第二部分，我们计算边界项：\n$$\n\\frac{1}{\\Delta} \\left[ u(x+\\Delta/2) \\left(1 + \\frac{\\Delta'}{2}\\right) - u(x-\\Delta/2) \\left(1 - \\frac{\\Delta'}{2}\\right) \\right] = \\frac{1}{\\Delta} \\left[ (u(x+\\Delta/2) - u(x-\\Delta/2)) + \\frac{\\Delta'}{2}(u(x+\\Delta/2) + u(x-\\Delta/2)) \\right]\n$$\n差和和分别为：\n$$\nu(x+\\Delta/2) - u(x-\\Delta/2) = \\Delta u' + \\frac{\\Delta^3}{24}u''' + \\mathcal{O}(\\Delta^5)\n$$\n$$\nu(x+\\Delta/2) + u(x-\\Delta/2) = 2u + \\frac{\\Delta^2}{4}u'' + \\mathcal{O}(\\Delta^4)\n$$\n将这些代入括号内的表达式：\n$$\n\\left( \\Delta u' + \\frac{\\Delta^3}{24}u''' \\right) + \\frac{\\Delta'}{2}\\left( 2u + \\frac{\\Delta^2}{4}u'' \\right) = \\Delta u' + u\\Delta' + \\frac{\\Delta^2\\Delta'}{8}u'' + \\frac{\\Delta^3}{24}u''' + \\dots\n$$\n除以 $\\Delta$，$\\partial_x \\bar{u}(x)$ 的第二部分变为：\n$$\nu' + \\frac{u\\Delta'}{\\Delta} + \\frac{\\Delta\\Delta'}{8}u'' + \\frac{\\Delta^2}{24}u''' + \\mathcal{O}(\\Delta^3)\n$$\n合并 $\\partial_x \\bar{u}(x)$ 的两个部分：\n$$\n\\partial_x \\bar{u}(x) = \\left(-\\frac{u\\Delta'}{\\Delta} - \\frac{\\Delta\\Delta'}{24}u'' \\right) + \\left(u' + \\frac{u\\Delta'}{\\Delta} + \\frac{\\Delta\\Delta'}{8}u'' + \\frac{\\Delta^2}{24}u''' \\right) + \\mathcal{O}(\\Delta^3)\n$$\n$$\n\\partial_x \\bar{u}(x) = u' + \\left(\\frac{1}{8} - \\frac{1}{24}\\right)\\Delta\\Delta'u'' + \\frac{\\Delta^2}{24}u''' + \\dots = u' + \\frac{2}{24}\\Delta\\Delta'u'' + \\frac{\\Delta^2}{24}u''' + \\dots\n$$\n$$\n\\partial_x \\bar{u}(x) = \\partial_x u(x) + \\frac{\\Delta(x)\\partial_x\\Delta(x)}{12}\\partial_x^2 u(x) + \\frac{\\Delta(x)^2}{24}\\partial_x^3 u(x) + \\mathcal{O}(\\Delta^3)\n$$\n\n**交换误差表达式**\n最后，我们通过减去两个推导出的表达式来计算 $C(x)$：\n$$\nC(x) = \\left( \\partial_x u + \\frac{\\Delta^2}{24} \\partial_x^3 u \\right) - \\left( \\partial_x u + \\frac{\\Delta \\partial_x\\Delta}{12} \\partial_x^2 u + \\frac{\\Delta^2}{24} \\partial_x^3 u \\right) + \\mathcal{O}(\\Delta^3)\n$$\n交换误差的主阶渐近表达式为：\n$$\nC(x) = - \\frac{\\Delta(x) \\partial_x\\Delta(x)}{12} \\partial_x^2 u(x)\n$$\n\n### 在 $x_0 = 0.5$ 处的数值计算\n\n我们需要计算在 $x_0 = 0.5$ 处的 $\\Delta(x)$、$\\partial_x \\Delta(x)$ 和 $\\partial_x^2 u(x)$。\n\n1.  **滤波宽度及其导数**：\n    -   映射：$x = \\xi^3 \\implies \\xi(x) = x^{1/3}$。\n    -   雅可比：$\\frac{dx}{d\\xi} = 3\\xi^2$。\n    -   滤波宽度：$\\Delta(x) = \\Delta_{\\xi} \\frac{dx}{d\\xi}|_{\\xi(x)} = 0.02 \\cdot (3\\xi(x)^2) = 0.06 \\, (x^{1/3})^2 = 0.06 \\, x^{2/3}$。\n    -   滤波宽度的导数：$\\partial_x \\Delta(x) = \\frac{d}{dx}(0.06 \\, x^{2/3}) = 0.06 \\cdot \\frac{2}{3} x^{-1/3} = 0.04 \\, x^{-1/3}$。\n\n    在 $x_0 = 0.5$ 处：\n    -   $\\Delta(0.5) = 0.06 \\cdot (0.5)^{2/3}$。\n    -   $\\partial_x \\Delta(0.5) = 0.04 \\cdot (0.5)^{-1/3}$。\n\n2.  **速度场导数**：\n    -   $u(x) = U_0 \\sin(kx)$，其中 $U_0 = 1.2 \\, \\mathrm{m/s}$，$k = 5 \\, \\mathrm{m}^{-1}$。\n    -   $\\partial_x u(x) = k U_0 \\cos(kx)$。\n    -   $\\partial_x^2 u(x) = -k^2 U_0 \\sin(kx)$。\n\n    在 $x_0 = 0.5$ 处：\n    -   $\\partial_x^2 u(0.5) = -(5 \\, \\mathrm{m}^{-1})^2 (1.2 \\, \\mathrm{m/s}) \\sin(5 \\cdot 0.5) = -25 \\cdot 1.2 \\sin(2.5) \\, \\mathrm{s}^{-1} \\mathrm{m}^{-1} = -30 \\sin(2.5) \\, \\mathrm{s}^{-1} \\mathrm{m}^{-1}$。正弦函数的参数以弧度为单位。\n\n3.  **计算 $C(x_0)$**：\n    将这些值代入 $C(x)$ 的表达式：\n    $$\n    C(0.5) = - \\frac{\\left[0.06 \\cdot (0.5)^{2/3}\\right] \\left[0.04 \\cdot (0.5)^{-1/3}\\right]}{12} \\left[-30 \\sin(2.5)\\right]\n    $$\n    单位是 $[m] \\cdot [1] \\cdot [s^{-1} m^{-1}] = [s^{-1}]$。\n    $$\n    C(0.5) = \\frac{0.06 \\cdot 0.04 \\cdot (0.5)^{(2/3 - 1/3)}}{12} \\cdot 30 \\sin(2.5)\n    $$\n    $$\n    C(0.5) = \\frac{0.0024 \\cdot (0.5)^{1/3}}{12} \\cdot 30 \\sin(2.5)\n    $$\n    $$\n    C(0.5) = \\frac{0.072}{12} (0.5)^{1/3} \\sin(2.5) = 0.006 \\cdot (0.5)^{1/3} \\sin(2.5)\n    $$\n    数值计算：\n    $$\n    C(0.5) \\approx 0.006 \\cdot (0.793700526) \\cdot (0.598472144) \\approx 0.0028503126 \\, \\mathrm{s}^{-1}\n    $$\n    四舍五入到六位有效数字，值为 $0.00285031 \\, \\mathrm{s}^{-1}$。\n\n### 关于对亚格子尺度应力影响的讨论\n\n在 LES 中，对控制方程纳维-斯托克斯方程进行滤波，以分离大的、可解的尺度和小的、亚格子尺度 (SGS)。非线性对流项 $\\partial_j (u_i u_j)$ 在滤波后变为 $\\overline{\\partial_j (u_i u_j)}$。在非均匀网格上，滤波宽度 $\\Delta(x)$ 与位置相关，因此，滤波和微分算子不可交换。交换误差 $C_j(f) = \\overline{\\partial_j f} - \\partial_j \\bar{f}$ 量化了这种非交换性。\n\n滤波后的对流项应写作：\n$$\n\\overline{\\partial_j (u_i u_j)} = \\partial_j \\overline{u_i u_j} - C_j(u_i u_j)\n$$\n因此，滤波后的动量方程包含一个与此交换误差相关的附加项：\n$$\n\\partial_t \\bar{u}_i + \\partial_j \\overline{u_i u_j} = \\dots \\implies \\partial_t \\bar{u}_i + \\partial_j (\\bar{u}_i \\bar{u}_j) = -\\partial_j \\tau_{ij} + C_j(u_i u_j) + \\dots\n$$\n其中 $\\tau_{ij} = \\overline{u_i u_j} - \\bar{u}_i \\bar{u}_j$ 是亚格子尺度应力张量。项 $C_j(u_i u_j)$ 在可解场 $\\bar{u}_i$ 的动量方程中表现为源项或汇项。该项对于非均匀滤波宽度是非零的（如推导所示），它代表了大尺度涡如何被空间变化的滤波器扭曲的物理效应。在许多 LES 的实现中，为了简化，这个交换误差被忽略了，这可能导致显著的不准确性，特别是在网格各向异性或拉伸程度高的区域，例如靠近固体边界的地方。因此，一个精确的 LES 必须在标准的亚格子尺度应力张量之外，同时考虑并建模这些交换误差项。",
            "answer": "$$\n\\boxed{2.85031 \\times 10^{-3}}\n$$"
        },
        {
            "introduction": "亚格子尺度（SGS）模型的一个核心任务是耗散掉那些无法被网格解析的小尺度能量，以模仿真实的湍流级串过程。实现这一目标主要有两种策略：显式LES（explicit LES）和隐式LES（implicit LES）。前者通过引入一个明确的亚格子应力项（如Smagorinsky模型）来增加耗散，而后者则巧妙地利用数值格式自身的耗散特性。这个练习提供了一个绝佳的机会，让你通过冯·诺依曼稳定性分析，亲手计算并比较这两种策略在显式时间积分格式下的稳定性约束，从而直观地理解模型选择如何直接影响模拟的计算效率和时间步长限制 ()。",
            "id": "3367156",
            "problem": "考虑一个均匀剪切流的一维、不可压缩大涡模拟（LES），该模型围绕一个均匀的平均平流进行了线性化。解析的速度脉动 $u(x,t)$ 满足线性对流-扩散模型\n$$\n\\frac{\\partial u}{\\partial t} + U \\frac{\\partial u}{\\partial x} = \\frac{\\partial}{\\partial x}\\left[\\left(\\nu + \\nu_{t}\\right)\\frac{\\partial u}{\\partial x}\\right],\n$$\n该模型建立在间距为 $\\Delta$ 的均匀网格上。分子运动黏度为 $\\nu$，平均平流速度为 $U$，亚网格尺度涡黏度由 Smagorinsky 形式 $\\nu_{t} = C_{s}^{2}\\,\\Delta^{2}\\,|S|$ 建模，其中 $C_{s}$ 是 Smagorinsky 系数， $|S|$ 是给定的解析应变率张量的常数大小。空间离散化对扩散算子使用二阶中心差分，对对流算子使用单调一阶迎风通量（假设 $U>0$，因此迎风方向取自左侧）。时间推进使用经典的三阶强保稳 Runge–Kutta（SSP–RK$3$）方法。\n\n考虑两种亚网格尺度策略：\n\n- 策略 A（显式 LES）：使用显式 Smagorinsky 涡黏度 $\\nu_{t} = C_{s}^{2}\\,\\Delta^{2}\\,|S|$。\n- 策略 B（隐式数值阻尼，也称为隐式 LES）：设置 $\\nu_{t}=0$，但依赖于迎风格式的数值耗散。对于线性平流，在波数的主导阶上，这等效于一个有效黏度 $\\nu_{\\text{num}} = \\kappa\\,U\\,\\Delta$，其中 $\\kappa>0$ 是一个给定的与格式相关的常数。\n\n从线性对流-扩散方程、二阶离散拉普拉斯算子的 von Neumann Fourier 符号，以及使用一阶迎风通量的线性平流的前向 Euler 时间步进的单调性条件出发，推导半离散系统显式积分的前向 Euler 稳定性约束。然后，利用强保稳 Runge–Kutta 方法的定义特性，推导出每种策略在 SSP–RK$3$ 下的最大稳定时间步长，即平流界限和扩散界限的最小值。用有效黏度 $\\nu_{\\text{eff}}$（在策略 A 中等于 $\\nu+\\nu_{t}$，在策略 B 中等于 $\\nu+\\nu_{\\text{num}}$）来表示扩散界限。\n\n使用以下参数值：\n- $U = 2\\,\\text{m}\\,\\text{s}^{-1}$，\n- $\\nu = 1.0 \\times 10^{-5}\\,\\text{m}^{2}\\,\\text{s}^{-1}$，\n- $\\Delta = 1.0 \\times 10^{-3}\\,\\text{m}$，\n- $C_{s} = 0.17$，\n- $|S| = 5.0 \\times 10^{4}\\,\\text{s}^{-1}$，\n- $\\kappa = \\tfrac{1}{2}$。\n\n将策略 A 和 B 的最大稳定时间步长 $\\Delta t_{\\text{A}}$ 和 $\\Delta t_{\\text{B}}$ 分别定义为其平流界限和扩散界限的最小值。计算比率\n$$\nR \\equiv \\frac{\\Delta t_{\\text{B}}}{\\Delta t_{\\text{A}}},\n$$\n并报告保留三位有效数字的 $R$ 值。由于 $R$ 是无量纲的，最终数值答案中不要包含任何单位。",
            "solution": "该问题要求针对一个一维线性对流-扩散方程，在使用特定数值方法离散化以及两种不同亚网格尺度建模策略的情况下，推导其稳定性约束。最终目标是计算这两种策略的最大稳定时间步长之比。\n\n解析的速度脉动 $u(x,t)$ 的控制方程为\n$$\n\\frac{\\partial u}{\\partial t} + U \\frac{\\partial u}{\\partial x} = \\frac{\\partial}{\\partial x}\\left[\\nu_{\\text{eff}}\\frac{\\partial u}{\\partial x}\\right]\n$$\n其中 $\\nu_{\\text{eff}}$ 是有效运动黏度。\n\n空间域在间距为 $\\Delta$ 的均匀网格上离散化。空间算子离散化如下：\n1.  对流项 $\\frac{\\partial u}{\\partial x}$ 使用一阶迎风格式近似。对于平均平流速度 $U>0$，在网格节点 $j$ 处的算子为 $\\frac{u_j - u_{j-1}}{\\Delta}$。\n2.  扩散项 $\\frac{\\partial^2 u}{\\partial x^2}$ 使用二阶中心差分格式近似：$\\frac{u_{j+1} - 2u_j + u_{j-1}}{\\Delta^2}$。\n\n将这些离散格式代入控制方程，得到节点 $j$ 处速度的半离散常微分方程（ODE）：\n$$\n\\frac{du_j}{dt} = -U \\frac{u_j - u_{j-1}}{\\Delta} + \\nu_{\\text{eff}} \\frac{u_{j+1} - 2u_j + u_{j-1}}{\\Delta^2}\n$$\n该常微分方程组将使用三阶强保稳 Runge-Kutta（SSP-RK$3$）方法进行时间积分。\n\n问题引导我们首先为更简单的前向 Euler 时间步进方法推导稳定性约束，然后利用该结果推断 SSP-RK$3$ 的约束。对于一个分解为平流和扩散部分的线性问题，整体稳定性约束通常取为各部分施加的约束的最小值。\n\n首先，我们来推导前向 Euler 稳定性约束。\n\n**平流稳定性约束：**\n考虑纯平流方程 $ \\frac{\\partial u}{\\partial t} + U \\frac{\\partial u}{\\partial x} = 0$。使用一阶迎风格式的半离散形式为 $\\frac{du_j}{dt} = -U \\frac{u_j - u_{j-1}}{\\Delta}$。应用时间步长为 $\\Delta t$ 的前向 Euler 方法：\n$$\nu_j^{n+1} = u_j^n - \\frac{U \\Delta t}{\\Delta} (u_j^n - u_{j-1}^n) = \\left(1 - \\frac{U \\Delta t}{\\Delta}\\right)u_j^n + \\frac{U \\Delta t}{\\Delta} u_{j-1}^n\n$$\n问题指明使用单调性条件来保证稳定性。为使格式是单调的（即不产生新的极值），右侧 $u^n$ 项的系数必须为非负。这要求：\n$$\n1 - \\frac{U \\Delta t}{\\Delta} \\ge 0 \\implies \\frac{U \\Delta t}{\\Delta} \\le 1\n$$\n这给出了平流 Courant-Friedrichs-Lewy（CFL）条件：\n$$\n\\Delta t \\le \\frac{\\Delta}{U} \\equiv \\Delta t_{\\text{adv}}\n$$\n\n**扩散稳定性约束：**\n考虑纯扩散方程 $\\frac{\\partial u}{\\partial t} = \\nu_{\\text{eff}} \\frac{\\partial^2 u}{\\partial x^2}$。使用二阶中心差分的半离散形式为 $\\frac{du_j}{dt} = \\nu_{\\text{eff}} \\frac{u_{j+1} - 2u_j + u_{j-1}}{\\Delta^2}$。应用前向 Euler 方法：\n$$\nu_j^{n+1} = u_j^n + \\frac{\\nu_{\\text{eff}} \\Delta t}{\\Delta^2} (u_{j+1}^n - 2u_j^n + u_{j-1}^n)\n$$\n我们使用 von Neumann 稳定性分析。对于一个 Fourier 模 $u_j^n = g^n \\exp(ik j \\Delta)$，放大因子 $g(k) = \\frac{u_j^{n+1}}{u_j^n}$ 为：\n$$\ng(k) = 1 + \\frac{\\nu_{\\text{eff}} \\Delta t}{\\Delta^2} (\\exp(ik\\Delta) - 2 + \\exp(-ik\\Delta)) = 1 + \\frac{2\\nu_{\\text{eff}} \\Delta t}{\\Delta^2} (\\cos(k\\Delta) - 1)\n$$\n使用恒等式 $\\cos(k\\Delta) - 1 = -2\\sin^2(\\frac{k\\Delta}{2})$，我们得到：\n$$\ng(k) = 1 - \\frac{4\\nu_{\\text{eff}} \\Delta t}{\\Delta^2} \\sin^2\\left(\\frac{k\\Delta}{2}\\right)\n$$\n为了保证稳定性，我们需要对所有波数 $k$ 都有 $|g(k)| \\le 1$。由于 $g(k) \\le 1$，我们只需强制 $g(k) \\ge -1$。$g(k)$ 的最小值出现在 $\\sin^2(\\frac{k\\Delta}{2}) = 1$ 时（即对于最高频率模 $k\\Delta = \\pi$）。\n$$\ng_{\\text{min}} = 1 - \\frac{4\\nu_{\\text{eff}} \\Delta t}{\\Delta^2} \\ge -1 \\implies 2 \\ge \\frac{4\\nu_{\\text{eff}} \\Delta t}{\\Delta^2}\n$$\n这给出了扩散稳定性条件：\n$$\n\\Delta t \\le \\frac{2\\Delta^2}{4\\nu_{\\text{eff}}} = \\frac{\\Delta^2}{2\\nu_{\\text{eff}}} \\equiv \\Delta t_{\\text{diff}}\n$$\n\n**SSP-RK3 稳定性约束：**\n问题陈述使用 SSP 方法的定义特性。SSP 方法的一个关键特性是，它们在前向 Euler 方法的相同 CFL 约束下（可能按一个 SSP 系数 $C_{SSP}$ 缩放），能保持其稳定性属性（如单调性或总变差递减性）。对于经典的 SSP-RK$3$ 方法，该系数为 $C_{SSP}=1$。这意味着为前向 Euler 方法推导出的稳定性约束对于 SSP-RK$3$ 方法是充分的。因此，我们将完整对流-扩散问题的最大稳定时间步长取为平流界限和扩散界限的最小值：\n$$\n\\Delta t_{\\text{stable}} \\le \\min(\\Delta t_{\\text{adv}}, \\Delta t_{\\text{diff}}) = \\min\\left(\\frac{\\Delta}{U}, \\frac{\\Delta^2}{2\\nu_{\\text{eff}}}\\right)\n$$\n\n现在我们将此框架应用于两种策略，并使用给定的参数值：\n- $U = 2\\,\\text{m}\\,\\text{s}^{-1}$\n- $\\nu = 1.0 \\times 10^{-5}\\,\\text{m}^{2}\\,\\text{s}^{-1}$\n- $\\Delta = 1.0 \\times 10^{-3}\\,\\text{m}$\n- $C_{s} = 0.17$\n- $|S| = 5.0 \\times 10^{4}\\,\\text{s}^{-1}$\n- $\\kappa = \\frac{1}{2}$\n\n两种策略的平流时间步长限制是相同的，因为它仅取决于 $U$ 和 $\\Delta$：\n$$\n\\Delta t_{\\text{adv}} = \\frac{\\Delta}{U} = \\frac{1.0 \\times 10^{-3}\\,\\text{m}}{2\\,\\text{m}\\,\\text{s}^{-1}} = 5.0 \\times 10^{-4}\\,\\text{s}\n$$\n\n**策略 A：显式 LES**\n有效黏度 $\\nu_{\\text{eff, A}}$ 是分子黏度和亚网格尺度涡黏度之和：\n$$\n\\nu_{\\text{eff, A}} = \\nu + \\nu_t = \\nu + C_{s}^{2}\\,\\Delta^{2}\\,|S|\n$$\n代入数值：\n$$\n\\nu_t = (0.17)^2 \\times (1.0 \\times 10^{-3}\\,\\text{m})^2 \\times (5.0 \\times 10^{4}\\,\\text{s}^{-1}) = 0.0289 \\times 10^{-6}\\,\\text{m}^2 \\times 5.0 \\times 10^{4}\\,\\text{s}^{-1} = 1.445 \\times 10^{-3}\\,\\text{m}^2\\,\\text{s}^{-1}\n$$\n$$\n\\nu_{\\text{eff, A}} = 1.0 \\times 10^{-5}\\,\\text{m}^2\\,\\text{s}^{-1} + 1.445 \\times 10^{-3}\\,\\text{m}^2\\,\\text{s}^{-1} = (0.01 + 1.445) \\times 10^{-3}\\,\\text{m}^2\\,\\text{s}^{-1} = 1.455 \\times 10^{-3}\\,\\text{m}^2\\,\\text{s}^{-1}\n$$\n策略 A 的扩散时间步长限制为：\n$$\n\\Delta t_{\\text{diff, A}} = \\frac{\\Delta^2}{2\\nu_{\\text{eff, A}}} = \\frac{(1.0 \\times 10^{-3}\\,\\text{m})^2}{2 \\times 1.455 \\times 10^{-3}\\,\\text{m}^2\\,\\text{s}^{-1}} = \\frac{1.0 \\times 10^{-6}\\,\\text{m}^2}{2.91 \\times 10^{-3}\\,\\text{m}^2\\,\\text{s}^{-1}} \\approx 3.4364 \\times 10^{-4}\\,\\text{s}\n$$\n策略 A 的最大稳定时间步长是两个界限的最小值：\n$$\n\\Delta t_{\\text{A}} = \\min(\\Delta t_{\\text{adv}}, \\Delta t_{\\text{diff, A}}) = \\min(5.0 \\times 10^{-4}\\,\\text{s}, 3.4364 \\times 10^{-4}\\,\\text{s}) = 3.4364 \\times 10^{-4}\\,\\text{s}\n$$\n\n**策略 B：隐式 LES (ILES)**\n在此策略中，$\\nu_t=0$，有效黏度 $\\nu_{\\text{eff, B}}$ 是分子黏度和数值黏度之和：\n$$\n\\nu_{\\text{eff, B}} = \\nu + \\nu_{\\text{num}} = \\nu + \\kappa\\,U\\,\\Delta\n$$\n代入数值：\n$$\n\\nu_{\\text{num}} = \\frac{1}{2} \\times (2\\,\\text{m}\\,\\text{s}^{-1}) \\times (1.0 \\times 10^{-3}\\,\\text{m}) = 1.0 \\times 10^{-3}\\,\\text{m}^2\\,\\text{s}^{-1}\n$$\n$$\n\\nu_{\\text{eff, B}} = 1.0 \\times 10^{-5}\\,\\text{m}^2\\,\\text{s}^{-1} + 1.0 \\times 10^{-3}\\,\\text{m}^2\\,\\text{s}^{-1} = (0.01 + 1.0) \\times 10^{-3}\\,\\text{m}^2\\,\\text{s}^{-1} = 1.01 \\times 10^{-3}\\,\\text{m}^2\\,\\text{s}^{-1}\n$$\n策略 B 的扩散时间步长限制为：\n$$\n\\Delta t_{\\text{diff, B}} = \\frac{\\Delta^2}{2\\nu_{\\text{eff, B}}} = \\frac{(1.0 \\times 10^{-3}\\,\\text{m})^2}{2 \\times 1.01 \\times 10^{-3}\\,\\text{m}^2\\,\\text{s}^{-1}} = \\frac{1.0 \\times 10^{-6}\\,\\text{m}^2}{2.02 \\times 10^{-3}\\,\\text{m}^2\\,\\text{s}^{-1}} \\approx 4.9505 \\times 10^{-4}\\,\\text{s}\n$$\n策略 B 的最大稳定时间步长是两个界限的最小值：\n$$\n\\Delta t_{\\text{B}} = \\min(\\Delta t_{\\text{adv}}, \\Delta t_{\\text{diff, B}}) = \\min(5.0 \\times 10^{-4}\\,\\text{s}, 4.9505 \\times 10^{-4}\\,\\text{s}) = 4.9505 \\times 10^{-4}\\,\\text{s}\n$$\n\n**时间步长之比**\n最后，我们计算比率 $R \\equiv \\frac{\\Delta t_{\\text{B}}}{\\Delta t_{\\text{A}}}$：\n$$\nR = \\frac{4.9505 \\times 10^{-4}\\,\\text{s}}{3.4364 \\times 10^{-4}\\,\\text{s}} \\approx 1.44058\n$$\n保留三位有效数字，结果为 $1.44$。\n\n在此问题中，显式 Smagorinsky 模型（策略 A）引入的有效黏度大于迎风格式产生的数值耗散（策略 B），即 $\\nu_{\\text{eff, A}} > \\nu_{\\text{eff, B}}$。对于较大的黏度，扩散时间步长约束更为严格（$\\Delta t_{\\text{diff}} \\propto 1/\\nu_{\\text{eff}}$）。对于这两种策略，扩散限制都比平流限制更严格。因此，黏度较大的策略 A 受到更严格的时间步长约束，导致比率 $R > 1$。",
            "answer": "$$\n\\boxed{1.44}\n$$"
        },
        {
            "introduction": "传统的亚格子模型通常依赖于普适的、预先设定的模型常数，但这限制了模型在复杂流动中的适应性。动态模型通过引入“测试滤波”这一巧妙思想，利用已解析尺度上的信息来动态地、局部地确定模型系数，从而极大地提升了模型的预测精度。本练习将引导你完整地推导并实现一个用于标量输运的动态湍流普朗特数模型，从Germano恒等式的建立到最小二乘法求解，最终在一个合成的槽道湍流中验证你的程序 ()。这是一个高级实践，能让你深入掌握现代LES方法的核心精髓。",
            "id": "3367196",
            "problem": "考虑不可压流中的标量输运的大涡模拟（LES），具体场景为受热湍流槽道流。从滤波后的标量输运方程和亚格子尺度（SGS）标量通量的定义出发。利用应用于均匀方向的测试滤波器，基于标量通量的类Germano恒等式，从第一性原理推导湍流普朗特数 $Pr_t(\\mathbf{x},t)$ 的动态模型。您的推导必须从滤波后的输运方程和模型假设开始，最终得到一个可实现的表达式，该表达式以最小二乘最优的方式确定当地湍流普朗特数的倒数。然后，在一个合成的受热湍流槽道中，实现所推导的表达式，以计算沿壁面法向的平面平均 $Pr_t$ 值，其中需使用科学上合理的平均剖面和脉动。\n\n物理和数学背景、定义和要求：\n\n- 使用不可压流的滤波标量输运方程，并定义亚格子尺度（SGS）标量通量 $ \\tau_{\\theta,i} = \\overline{u_i \\theta} - \\bar{u}_i \\bar{\\theta} $。通过菲克涡扩散率对SGS标量通量进行建模，$ \\tau_{\\theta,i}^{m} = - \\kappa_t \\, \\partial_i \\bar{\\theta} $，其中 $ \\kappa_t = \\nu_t / Pr_t $，$ \\nu_t $ 是涡粘性系数，$ Pr_t $ 是待动态确定的湍流普朗特数。\n- 为标量引入一个类Germano恒等式，利用一个沿均匀方向施加的测试滤波器（在已滤波变量上用帽子符号表示）。定义可解测试尺度标量通量，并推导一个在网格尺度和测试尺度上连接已求解量和模型量的恒等式。\n- 获得当地湍流普朗特数倒数 $ \\alpha(\\mathbf{x},t) = 1/Pr_t(\\mathbf{x},t) $ 的最小二乘表达式。最终表达式必须包含滤波后的相关项 $ L_i $ 和一个模型核 $ M_i $，该模型核由 $ \\nu_t $、$ \\bar{\\theta} $ 及其梯度的滤波组合（使用测试滤波器）构建而成。\n- 在实现方面，考虑一个半高为 $ h $、摩擦雷诺数 $ Re_\\tau $、摩擦速度缩放为 $ u_\\tau = 1 $、运动粘度 $ \\nu = u_\\tau h / Re_\\tau $ 的受热湍流槽道。构造平均剖面：\n  - 流向平均速度 $ U(y) $，用壁面单位下的对数律近似，其中包含 von Kármán 常数 $ \\kappa $ 和相加常数 $ B $，\n  - 平均标量（温度）$ \\Theta(y) $，在整个槽道高度 $ 2h $ 上具有恒定梯度。\n  通过添加指定幅度的均匀随机脉动来模拟湍流，并使用固定的随机种子确保可复现性。使用基于到最近壁面距离 $ y_w $ 和壁面单位 $ y^+ $ 的 van Driest 阻尼混合长度公式 $ \\ell(y) = \\kappa y_w \\left(1 - \\exp(-y^+/A^+)\\right) $ 计算 $ \\nu_t(y) $，并根据对数律的斜率近似 $ \\partial_y U $。\n- 仅沿流向和展向应用周期性均匀箱式滤波器作为测试滤波器；不要沿壁面法向进行滤波。在流向和展向使用具有周期性边界条件的二阶精度有限差分，在壁面处对壁面法向导数使用单边差分。\n- 为计算 $ Pr_t(y) $，在均匀方向上进行平面平均，以在每个壁面法向位置 $ y $ 处评估 $ \\alpha(y) = 1/Pr_t(y) $ 的最小二乘最优解。通过以下方式强制实现物理真实性：\n  - 当最小二乘分母低于一个小阈值或计算出的 $ \\alpha(y) $ 为非正数时，使用备用值 $ Pr_t^0 $，\n  - 在对 $ y $ 方向进行平均之前，将 $ Pr_t(y) $ 裁剪到预设的物理合理区间 $ [Pr_{t,\\min}, Pr_{t,\\max}] $ 内。\n- 将最终的标量结果表示为无量纲数。\n\n数值配置：\n\n- 计算域：$ x \\in [0, L_x] $, $ y \\in [0, 2h] $, $ z \\in [0, L_z] $，其中 $ h = 1 $，$ L_x = 2\\pi $，$ L_z = \\pi $。\n- 离散化：在所有方向上使用均匀网格，点数为 $ N_x $、$ N_y $、$ N_z $；在 $ x $ 和 $ z $ 方向为周期性，在 $ y=0 $ 和 $ y=2h $ 处的无滑移条件，在平均速度剖面构建中近似处理。\n- 测试滤波器：在 $ x $ 和 $ z $ 方向宽度为 $ m $（奇数）的周期性箱式滤波器。\n\n您的程序必须实现所推导的动态过程，并为以下每个测试用例返回平面平均的 $ Pr_t $。对所有随机场使用固定的随机种子 $ 42 $。\n\n测试套件（每个元组为 $(Re_\\tau, m, A_u, A_\\theta, Pr_t^0, Pr_{t,\\min}, Pr_{t,\\max}, N_x, N_y, N_z)$）：\n\n1. $(180, 5, 0.10, 0.05, 0.70, 0.20, 2.00, 32, 33, 32)$，代表性的理想路径湍流强度和中等大小的测试滤波器。\n2. $(180, 7, 0.05, 1\\times 10^{-4}, 0.90, 0.20, 2.00, 32, 33, 32)$，接近简并的标量脉动以触发备用行为。\n3. $(180, 3, 0.20, 0.20, 0.70, 0.20, 2.00, 32, 33, 32)$，高脉动幅度和小编号测试滤波器以测试裁剪功能。\n\n最终输出规范：\n\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表，每个值四舍五入到三位小数，并与测试套件的顺序相同，例如，“[result1,result2,result3]”。\n- 每个结果必须是单个无量纲浮点数，等于该测试用例的壁面法向平面平均 $ Pr_t $。",
            "solution": "推导始于大涡模拟（LES）框架下不可压流中被动标量（温度）的滤波守恒方程。设 $ \\bar{\\theta} $ 为滤波后的标量，$ \\bar{u}_i $ 为滤波后的速度。滤波后的标量输运方程可写为\n$$\n\\frac{\\partial \\bar{\\theta}}{\\partial t} + \\frac{\\partial (\\bar{u}_i \\bar{\\theta})}{\\partial x_i} = \\frac{\\partial}{\\partial x_i} \\left( \\alpha \\frac{\\partial \\bar{\\theta}}{\\partial x_i} \\right) - \\frac{\\partial \\tau_{\\theta,i}}{\\partial x_i},\n$$\n其中 $ \\alpha $ 是分子扩散率，亚格子尺度（SGS）标量通量为\n$$\n\\tau_{\\theta,i} = \\overline{u_i \\theta} - \\bar{u}_i \\bar{\\theta}。\n$$\n一个常见的模型假设是SGS通量采用菲克形式，\n$$\n\\tau_{\\theta,i}^{m} = - \\kappa_t \\, \\partial_i \\bar{\\theta},\n$$\n其中 $ \\kappa_t = \\nu_t / Pr_t $，$ \\nu_t $ 是SGS涡粘性系数，$ Pr_t $ 是待建模的湍流普朗特数。\n\n为了动态确定 $ Pr_t $，我们引入一个应用于已滤波变量的、在更大测试滤波器尺度（用帽子符号 $ \\hat{\\cdot} $ 表示）上的类Germano标量通量恒等式。考虑可解的测试滤波相关项\n$$\nL_i \\equiv \\widehat{\\bar{u}_i \\bar{\\theta}} - \\hat{\\bar{u}}_i \\hat{\\bar{\\theta}}。\n$$\n该量表示在测试尺度上，滤波后乘积与滤波后场量乘积之间的差值；它类似于动量的Germano恒等式，但此处是为标量相关性而构建的。我们也可以在网格尺度上定义模型化的SGS通量为 $ \\tau_{\\theta,i}^{m} = - \\kappa_t \\, \\partial_i \\bar{\\theta} $，在测试尺度上定义为 $ T_{\\theta,i}^{m} = - \\tilde{\\kappa}_t \\, \\partial_i \\hat{\\bar{\\theta}} $（使用相同的 $ Pr_t $ 以避免重复计算），其中在同样的菲克假设下 $ \\tilde{\\kappa}_t = \\hat{\\nu}_t / Pr_t $。将测试滤波器应用于模型化的网格尺度通量，得到 $ \\widehat{\\tau_{\\theta,i}^{m}} = - \\widehat{ \\kappa_t \\, \\partial_i \\bar{\\theta} } $。\n\n于是，测试尺度上的类Germano标量通量恒等式可以写成已求解量和模型量之间的关系：\n$$\nL_i \\approx T_{\\theta,i}^{m} - \\widehat{\\tau_{\\theta,i}^{m}}。\n$$\n代入模型后得到\n$$\nL_i \\approx - \\frac{\\hat{\\nu}_t}{Pr_t} \\, \\partial_i \\hat{\\bar{\\theta}} + \\frac{1}{Pr_t} \\, \\widehat{ \\nu_t \\, \\partial_i \\bar{\\theta} }。\n$$\n引入未知的当地湍流普朗特数倒数 $ \\alpha = 1/Pr_t $，并定义模型核\n$$\nM_i \\equiv \\hat{\\nu}_t \\, \\partial_i \\hat{\\bar{\\theta}} - \\widehat{ \\nu_t \\, \\partial_i \\bar{\\theta} }。\n$$\n这样，恒等式变为\n$$\nL_i \\approx - \\alpha \\, M_i。\n$$\n\n为了在存在数值噪声和三个方向 $ i \\in \\{x,y,z\\} $ 变化的情况下稳健地确定 $ \\alpha $，我们在均匀方向上采用最小二乘法最小化（此处是在固定的壁面法向位置 $ y $，对流向 $ x $ 和展向 $ z $ 进行平面平均）。定义误差泛函\n$$\nE(\\alpha) = \\sum_{i} \\left\\langle \\left( L_i + \\alpha \\, M_i \\right)^2 \\right\\rangle_{x,z},\n$$\n其中 $ \\langle \\cdot \\rangle_{x,z} $ 表示在固定 $ y $ 处的平面平均。对 $ E $ 关于 $ \\alpha $ 进行最小化，得到正规方程\n$$\n\\frac{dE}{d\\alpha} = 2 \\sum_{i} \\left\\langle \\left( L_i + \\alpha \\, M_i \\right) M_i \\right\\rangle_{x,z} = 0,\n$$\n由此可得\n$$\n\\alpha(y) = - \\frac{ \\sum_{i} \\left\\langle L_i M_i \\right\\rangle_{x,z} }{ \\sum_{i} \\left\\langle M_i M_i \\right\\rangle_{x,z} }。\n$$\n那么 $ Pr_t(y) = 1 / \\alpha(y) $。\n\n为保证物理真实性和数值稳定性，我们采取以下保障措施：\n- 如果分母 $ \\sum_{i} \\langle M_i M_i \\rangle_{x,z} $ 在某个给定的 $ y $ 处低于一个小阈值（接近简并情况）或 $ \\alpha(y) \\le 0 $，我们赋予防备用值 $ Pr_t^0 $，\n- 否则，我们将 $ Pr_t(y) $ 裁剪到区间 $ [Pr_{t,\\min}, Pr_{t,\\max}] $ 内。\n\n受热湍流槽道的实现细节：\n- 几何：槽道半高 $ h = 1 $，总高 $ 2h $，在 $ x $ 和 $ z $ 方向上周期性，长度分别为 $ L_x = 2\\pi $，$ L_z = \\pi $。\n- 离散化：使用均匀网格，点数为 $ N_x $、$ N_y $、$ N_z $。在 $ x $ 和 $ z $ 方向为周期性边界条件，在 $ y=0 $ 和 $ y=2h $ 处为壁面边界。\n- 平均剖面：流向平均速度 $ U(y) $ 用壁面单位下的对数律近似，包含 von Kármán 常数 $ \\kappa $ 和相加常数 $ B $。设 $ y_w = \\min(y, 2h - y) $ 为到最近壁面的距离，$ u_\\tau = 1 $，以及 $ \\nu = u_\\tau h / Re_\\tau $。定义壁面坐标 $ y^+ = y_w u_\\tau / \\nu = y_w Re_\\tau / h $。使用 $ U^+ = (1/\\kappa) \\ln( y^+ + \\varepsilon ) + B $，其中 $ \\varepsilon $ 是一个小数以避免奇异点，则 $ U(y) = u_\\tau U^+ $。由对数律斜率近似的壁面法向导数 $ \\partial_y U $ 为\n$$\n\\frac{\\partial U}{\\partial y} \\approx \\frac{u_\\tau^2}{\\kappa \\, \\nu \\, (y^+ + \\varepsilon)}。\n$$\n- 通过 van Driest 阻尼混合长度计算涡粘性系数：\n$$\n\\ell(y) = \\kappa \\, y_w \\left(1 - \\exp\\left(-\\frac{y^+}{A^+}\\right)\\right), \\quad \\nu_t(y) = \\ell(y)^2 \\, \\left| \\frac{\\partial U}{\\partial y} \\right|。\n$$\n此处 $ A^+ $ 是一个阻尼常数。\n- 平均标量：在槽道上施加一个恒定的平均温降 $ \\Delta \\Theta $，$ \\Theta(y) = \\Theta_0 - \\Delta \\Theta \\, y/(2h) $。\n- 脉动：为速度分量添加幅度为 $ A_u $、为温度添加幅度为 $ A_\\theta $ 的均匀高斯脉动，并使用固定的随机种子以保证可复现性。\n\n计算步骤：\n1. 生成 $ U(y) $、$ \\Theta(y) $ 和 $ \\nu_t(y) $ 剖面；组装三维场 $ u(x,y,z) = U(y) + \\text{脉动} $，类似地处理 $ v, w $ 和 $ \\theta(x,y,z) = \\Theta(y) + \\text{脉动} $。\n2. 计算梯度 $ \\partial_x \\bar{\\theta}, \\partial_y \\bar{\\theta}, \\partial_z \\bar{\\theta} $，内部点使用二阶中心差分，$ x $ 和 $ z $ 方向为周期性，在 $ y $ 边界处使用单边差分。\n3. 沿 $ x $ 和 $ z $ 方向应用宽度为 $ m $ 的周期性箱式测试滤波器（不在 $ y $ 方向滤波），以计算 $ \\hat{\\bar{u}}_i $、$ \\hat{\\bar{\\theta}} $、$ \\widehat{\\bar{u}_i \\bar{\\theta}} $、$ \\hat{\\nu}_t $ 和 $ \\widehat{\\nu_t \\partial_i \\bar{\\theta}} $。\n4. 构造 $ L_i $ 和 $ M_i $，并对每个 $ y $ 通过最小二乘法和在 $ x,z $ 上的平面平均计算 $ \\alpha(y) $。\n5. 应用备用值和裁剪方法得到 $ Pr_t(y) $，并计算壁面法向平均值 $ \\overline{Pr_t} $。\n\n验证原理：\n- 在湍流槽道流中，动态获得的 $ Pr_t $ 通常为1的数量级，其值取决于雷诺数和标量边界条件，对于许多工程流动，该值通常在 $ [0.4, 1.0] $ 区间内。保障措施即使在简并或含噪声的合成数据中也能确保物理真实性。测试套件涵盖了一个代表性案例、一个应回退到备用值 $ Pr_t^0 $ 的近简并标量脉动案例，以及一个用于测试裁剪功能的含噪声案例。\n\n最终程序为提供的测试套件实现这些步骤，并为每个测试用例打印平面平均的 $ Pr_t $，输出为单行列表，包含四舍五入到三位小数的浮点数。以下是实现此过程的Python代码。\n\n```python\nimport numpy as np\n\ndef box_filter_xz(arr: np.ndarray, m: int) -> np.ndarray:\n    \"\"\"对x和z轴进行周期性箱式（均匀）滤波。不对y轴进行滤波。\"\"\"\n    w = m // 2\n    # 先沿x轴（axis=0）滤波\n    tmp = np.zeros_like(arr)\n    for dx in range(-w, w + 1):\n        tmp += np.roll(arr, shift=dx, axis=0)\n    tmp /= m\n    # 再沿z轴（axis=2）滤波\n    out = np.zeros_like(arr)\n    for dz in range(-w, w + 1):\n        out += np.roll(tmp, shift=dz, axis=2)\n    out /= m\n    return out\n\ndef gradients_theta(theta: np.ndarray, Lx: float, Ly: float, Lz: float) -> tuple:\n    \"\"\"计算theta的梯度：(dtheta/dx, dtheta/dy, dtheta/dz)\"\"\"\n    Nx, Ny, Nz = theta.shape\n    dx = Lx / Nx\n    dy = Ly / (Ny - 1) if Ny > 1 else Ly\n    dz = Lz / Nz\n    \n    dth_dx = (np.roll(theta, -1, axis=0) - np.roll(theta, 1, axis=0)) / (2.0 * dx)\n    dth_dz = (np.roll(theta, -1, axis=2) - np.roll(theta, 1, axis=2)) / (2.0 * dz)\n    \n    dth_dy = np.zeros_like(theta)\n    if Ny > 1:\n        dth_dy[:, 1:-1, :] = (theta[:, 2:, :] - theta[:, :-2, :]) / (2.0 * dy)\n        dth_dy[:, 0, :] = (theta[:, 1, :] - theta[:, 0, :]) / dy\n        dth_dy[:, -1, :] = (theta[:, -1, :] - theta[:, -2, :]) / dy\n    \n    return dth_dx, dth_dy, dth_dz\n\ndef generate_channel_fields(Re_tau, Nx, Ny, Nz, Lx, Lz, h, Au, Ath, seed=42, delta_theta=1.0, kappa=0.41, B_const=5.2, Aplus=26.0):\n    \"\"\"生成合成的湍流槽道场\"\"\"\n    rng = np.random.default_rng(seed)\n    y = np.linspace(0.0, 2.0 * h, Ny)\n    y_w = np.minimum(y, 2.0 * h - y)\n    \n    u_tau = 1.0\n    nu = u_tau * h / Re_tau\n    eps = 1e-12\n    y_plus = y_w * u_tau / (nu + eps)\n    \n    U_plus = (1.0 / kappa) * np.log(y_plus + 1.0) + B_const\n    U_y = u_tau * U_plus\n    \n    dU_dy = (u_tau ** 2) / (kappa * nu * (y_plus + 1.0) + eps)\n    \n    l_mix = kappa * y_w * (1.0 - np.exp(-y_plus / Aplus))\n    nu_t_y = l_mix ** 2 * np.abs(dU_dy)\n    \n    theta_mean_y = 1.0 - (y / (2.0 * h)) * delta_theta\n    \n    U = U_y[None, :, None] * np.ones((Nx, 1, Nz))\n    nu_t = nu_t_y[None, :, None] * np.ones((Nx, 1, Nz))\n    theta_mean = theta_mean_y[None, :, None] * np.ones((Nx, 1, Nz))\n    \n    u_fluc = Au * rng.normal(size=(Nx, Ny, Nz))\n    v_fluc = Au * rng.normal(size=(Nx, Ny, Nz))\n    w_fluc = Au * rng.normal(size=(Nx, Ny, Nz))\n    theta_fluc = Ath * rng.normal(size=(Nx, Ny, Nz))\n    \n    u = U + u_fluc\n    v = v_fluc\n    w = w_fluc\n    theta = theta_mean + theta_fluc\n    \n    return u, v, w, theta, nu_t, nu\n\ndef compute_dynamic_prt(u, v, w, theta, nu_t, Lx, Ly, Lz, m, prt0, prt_min, prt_max):\n    \"\"\"使用类Germano恒等式计算平面平均的动态湍流普朗特数\"\"\"\n    Nx, Ny, Nz = theta.shape\n    u_hat = box_filter_xz(u, m)\n    v_hat = box_filter_xz(v, m)\n    w_hat = box_filter_xz(w, m)\n    theta_hat = box_filter_xz(theta, m)\n    utheta_hat = box_filter_xz(u * theta, m)\n    vtheta_hat = box_filter_xz(v * theta, m)\n    wtheta_hat = box_filter_xz(w * theta, m)\n    \n    Lx_term = utheta_hat - u_hat * theta_hat\n    Ly_term = vtheta_hat - v_hat * theta_hat\n    Lz_term = wtheta_hat - w_hat * theta_hat\n    \n    dth_dx, dth_dy, dth_dz = gradients_theta(theta, Lx, Ly, Lz)\n    dthhat_dx, dthhat_dy, dthhat_dz = gradients_theta(theta_hat, Lx, Ly, Lz)\n    \n    nu_t_hat = box_filter_xz(nu_t, m)\n    Px_hat = box_filter_xz(nu_t * dth_dx, m)\n    Py_hat = box_filter_xz(nu_t * dth_dy, m)\n    Pz_hat = box_filter_xz(nu_t * dth_dz, m)\n    \n    Mx_term = nu_t_hat * dthhat_dx - Px_hat\n    My_term = nu_t_hat * dthhat_dy - Py_hat\n    Mz_term = nu_t_hat * dthhat_dz - Pz_hat\n    \n    eps_den = 1e-12\n    prt_y = np.zeros(Ny)\n    \n    for j in range(Ny):\n        num = np.mean(Lx_term[:,j,:]*Mx_term[:,j,:]) + np.mean(Ly_term[:,j,:]*My_term[:,j,:]) + np.mean(Lz_term[:,j,:]*Mz_term[:,j,:])\n        den = np.mean(Mx_term[:,j,:]**2) + np.mean(My_term[:,j,:]**2) + np.mean(Mz_term[:,j,:]**2)\n        \n        if den  eps_den:\n            prt_y[j] = prt0\n        else:\n            alpha = -num / den\n            if alpha = 0:\n                prt_y[j] = prt0\n            else:\n                prt_y[j] = 1.0 / alpha\n        \n        prt_y[j] = np.clip(prt_y[j], prt_min, prt_max)\n        \n    return float(np.mean(prt_y))\n\ndef run_test_case(case):\n    Re_tau, m, Au, Ath, prt0, prt_min, prt_max, Nx, Ny, Nz = case\n    h = 1.0\n    Lx = 2.0 * np.pi\n    Lz = 1.0 * np.pi\n    Ly = 2.0 * h\n    \n    u, v, w, theta, nu_t, nu = generate_channel_fields(Re_tau, Nx, Ny, Nz, Lx, Lz, h, Au, Ath, seed=42)\n    prt_mean = compute_dynamic_prt(u, v, w, theta, nu_t, Lx, Ly, Lz, m, prt0, prt_min, prt_max)\n    return prt_mean\n\ndef solve():\n    test_cases = [\n        (180, 5, 0.10, 0.05, 0.70, 0.20, 2.00, 32, 33, 32),\n        (180, 7, 0.05, 1e-4, 0.90, 0.20, 2.00, 32, 33, 32),\n        (180, 3, 0.20, 0.20, 0.70, 0.20, 2.00, 32, 33, 32),\n    ]\n    results = [f\"{run_test_case(case):.3f}\" for case in test_cases]\n    return f\"[{','.join(results)}]\"\n\n# This block is for generating the answer. It is not part of the solution text.\n# if __name__ == \"__main__\":\n#     print(solve())\n```",
            "answer": "[0.835,0.900,0.730]"
        }
    ]
}