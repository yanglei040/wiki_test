{
    "hands_on_practices": [
        {
            "introduction": "本练习将机器学习修正这一抽象概念与湍动能（TKE）收支的具体物理过程联系起来。通过推导TKE收支方程，并计算一个简单的机器学习模型对涡粘性的影响，学生可以直观地看到模型如何改变控制体积内的能量产生、耗散和输运。这项基础练习有助于培养关于机器学习增强项如何与底层雷诺平均Navier-Stokes（RANS）方程相互作用的物理直觉。",
            "id": "3342944",
            "problem": "考虑一个由雷诺平均纳维-斯托克斯 (RANS) 方程控制的不可压缩湍流。令湍动能 (TKE) 定义为 $k = \\frac{1}{2} \\langle u_{i}' u_{i}' \\rangle$，其中 $\\langle \\cdot \\rangle$ 表示雷诺平均，$u_{i}'$ 是脉动速度。从 $k$ 的精确雷诺平均输运方程出发，推导其收支分解，包括产生项、耗散项和输运项。使用 Boussinesq 涡粘性近似 $- \\langle u_{i}' u_{j}' \\rangle = 2 \\nu_{t} S_{ij} - \\frac{2}{3} k \\delta_{ij}$，将模化的产生项 $P_{k}$ 表示为涡粘性 $\\nu_{t}$ 和平均应变率张量 $S_{ij}$ 的函数，其中 $\\nu_{t}$ 是涡粘性，$S_{ij} = \\frac{1}{2} \\left( \\frac{\\partial U_{i}}{\\partial x_{j}} + \\frac{\\partial U_{j}}{\\partial x_{i}} \\right)$ 是平均应变率张量。使用 $T_{j} = - \\left( \\nu + \\frac{\\nu_{t}}{\\sigma_{k}} \\right) \\frac{\\partial k}{\\partial x_{j}}$ 将输运项模化为具有有效扩散系数的梯度扩散，其中 $\\nu$ 是运动粘度，$\\sigma_{k}$ 是一个正常数。\n\n然后，在一个矩形控制体积上对 $k$ 方程进行积分，该控制体积在流向和展向具有周期性边界，并在 $y = 0$ 和 $y = H$ 处有不可渗透的壁面。控制体积的宽度、长度和高度分别为 $L_{z}$、$L_{x}$ 和 $H$，其中 $L_{x} = 1\\,\\mathrm{m}$，$L_{z} = 0.5\\,\\mathrm{m}$，$H = 0.1\\,\\mathrm{m}$。平均流具有空间均匀的剪切 $\\frac{\\partial U_{x}}{\\partial y} = S$，其中 $S = 100\\,\\mathrm{s^{-1}}$，其他平均梯度为零。假设耗散项 $\\varepsilon$ 是均匀的，$\\varepsilon = 4\\,\\mathrm{m^{2}\\,s^{-3}}$，并且 $k$ 的梯度也是均匀的，$\\frac{\\partial k}{\\partial y} = -10\\,\\mathrm{m^{2}\\,s^{-2}\\,m^{-1}}$。分子粘度为 $\\nu = 1.0 \\times 10^{-6}\\,\\mathrm{m^{2}\\,s^{-1}}$，基线涡粘性（未经增强）在空间上是均匀的，为 $\\nu_{t,0} = 5.0 \\times 10^{-4}\\,\\mathrm{m^{2}\\,s^{-1}}$。令 $\\sigma_{k} = 1.0$。\n\n一个机器学习 (ML) 修正在涡粘性上进行增强，形式为 $\\nu_{t}^{\\mathrm{ML}}(y) = \\nu_{t,0} \\left[ 1 + \\alpha \\, \\phi(y) \\right]$，其中 $\\alpha = 0.2$，特征为 $\\phi(y) = \\frac{y}{H}$。使用推导出的全局（控制体积积分）$k$ 收支，计算在 ML 修正下，控制体积积分的湍动能的瞬时变化率 $\\frac{\\mathrm{d}}{\\mathrm{d}t} \\int_{V} k \\,\\mathrm{d}V$。将您的最终答案以 $\\mathrm{m^{5}\\,s^{-3}}$ 为单位表示，并四舍五入到四位有效数字。",
            "solution": "该问题要求在特定的流动配置下，计算体积积分的湍动能 (TKE) 的瞬时变化率。这需要推导积分后的 TKE 收支方程，然后使用给定的模型和参数计算每一项。\n\n湍动能 $k = \\frac{1}{2} \\langle u_{i}' u_{i}' \\rangle$ 的精确雷诺平均输运方程为：\n$$\n\\frac{\\partial k}{\\partial t} + U_j \\frac{\\partial k}{\\partial x_j} = P_k - \\varepsilon + \\mathcal{D}_k\n$$\n其中 $U_j$ 是平均速度，$P_k = - \\langle u_{i}' u_{j}' \\rangle \\frac{\\partial U_{i}}{\\partial x_{j}}$ 是 TKE 的产生率，$\\varepsilon = \\nu \\langle \\frac{\\partial u_{i}'}{\\partial x_{j}} \\frac{\\partial u_{i}'}{\\partial x_{j}} \\rangle$ 是耗散率，$\\mathcal{D}_k$ 是输运项，包括湍流、压力和粘性扩散效应。输运项可以写成散度形式，$\\mathcal{D}_k = \\frac{\\partial T_{j}^{\\text{total}}}{\\partial x_j}$。问题为此总输运通量 $T_j$ 提供了一个模型。\n\n使用不可压缩条件 $\\frac{\\partial U_j}{\\partial x_j} = 0$，对流项可以写成 $U_j \\frac{\\partial k}{\\partial x_j} = \\frac{\\partial (U_j k)}{\\partial x_j}$。因此，模化的 TKE 方程为：\n$$\n\\frac{\\partial k}{\\partial t} + \\frac{\\partial (U_j k)}{\\partial x_j} = P_k - \\varepsilon + \\frac{\\partial T_j}{\\partial x_j}\n$$\n其中 $T_j = - \\left( \\nu + \\frac{\\nu_{t}}{\\sigma_{k}} \\right) \\frac{\\partial k}{\\partial x_{j}}$。\n\n首先，我们使用 Boussinesq 涡粘性近似 $- \\langle u_{i}' u_{j}' \\rangle = 2 \\nu_{t} S_{ij} - \\frac{2}{3} k \\delta_{ij}$ 来表示产生项 $P_k$。产生项可以写为 $P_k = - \\langle u_i' u_j' \\rangle S_{ij}$，因为对称张量（$\\langle u_i' u_j' \\rangle$）与反对称张量（平均旋转速率张量）的乘积为零。\n代入 Boussinesq 模型：\n$$\nP_k = \\left( 2 \\nu_t S_{ij} - \\frac{2}{3} k \\delta_{ij} \\right) S_{ij} = 2 \\nu_t S_{ij} S_{ij} - \\frac{2}{3} k \\delta_{ij} S_{ij}\n$$\n对于不可压缩流，平均应变率张量的迹为零：$S_{ii} = \\frac{\\partial U_i}{\\partial x_i} = 0$。由于 $\\delta_{ij} S_{ij} = S_{ii}$，第二项消失。这得到了模化的产生项：\n$$\nP_k = 2 \\nu_t S_{ij} S_{ij}\n$$\n\n接下来，我们在控制体积 $V$ 上对模化的 TKE 方程进行积分：\n$$\n\\int_V \\frac{\\partial k}{\\partial t} \\, \\mathrm{d}V + \\int_V \\frac{\\partial (U_j k)}{\\partial x_j} \\, \\mathrm{d}V = \\int_V P_k \\, \\mathrm{d}V - \\int_V \\varepsilon \\, \\mathrm{d}V + \\int_V \\frac{\\partial T_j}{\\partial x_j} \\, \\mathrm{d}V\n$$\n令 $\\mathcal{K} = \\int_V k \\, \\mathrm{d}V$。我们必须计算的项是 $\\frac{\\mathrm{d}\\mathcal{K}}{\\mathrm{d}t} = \\int_V \\frac{\\partial k}{\\partial t} \\, \\mathrm{d}V$。\n对对流项和输运项应用散度定理：\n$$\n\\frac{\\mathrm{d}\\mathcal{K}}{\\mathrm{d}t} + \\oint_A (U_j k) n_j \\, \\mathrm{d}A = \\int_V P_k \\, \\mathrm{d}V - \\int_V \\varepsilon \\, \\mathrm{d}V + \\oint_A T_j n_j \\, \\mathrm{d}A\n$$\n其中 $A$ 是控制体积的表面。在流向 ($x$) 和展向 ($z$) 的周期性边界上的面积分相互抵消。在不可渗透的壁面（$y=0$ 和 $y=H$）处，法向速度 $U_y$ 为零。因此，对流项的面积分 $\\oint (U_j k) n_j \\, \\mathrm{d}A$ 为零。输运项的剩余面积分为：\n$$\n\\oint_A T_j n_j \\, \\mathrm{d}A = \\int_{0}^{L_z}\\int_{0}^{L_x} [T_y|_{y=H} - T_y|_{y=0}] \\, \\mathrm{d}x\\mathrm{d}z = L_x L_z [T_y(H) - T_y(0)]\n$$\n积分后的 TKE 收支方程为：\n$$\n\\frac{\\mathrm{d}\\mathcal{K}}{\\mathrm{d}t} = \\underbrace{\\int_V P_k \\, \\mathrm{d}V}_{\\mathcal{P}} - \\underbrace{\\int_V \\varepsilon \\, \\mathrm{d}V}_{\\mathcal{E}} + \\underbrace{L_x L_z [T_y(H) - T_y(0)]}_{\\mathcal{T}}\n$$\n我们现在计算右侧的每一项。\n控制体积为 $V = L_x L_z H = (1)(0.5)(0.1) = 0.05\\,\\mathrm{m^3}$。\n\n1.  **积分产生项, $\\mathcal{P}$**：\n    平均流是简单剪切流，$\\frac{\\partial U_x}{\\partial y} = S = 100\\,\\mathrm{s^{-1}}$，所有其他平均速度梯度均为零。应变率张量分量为 $S_{12} = S_{21} = \\frac{1}{2}S$，其余分量均为零。\n    因此，$S_{ij} S_{ij} = S_{12}^2 + S_{21}^2 = (\\frac{S}{2})^2 + (\\frac{S}{2})^2 = \\frac{S^2}{2}$。\n    产生率为 $P_k(y) = 2 \\nu_t(y) (\\frac{S^2}{2}) = \\nu_t(y) S^2$。\n    涡粘性由 ML 增强模型给出：$\\nu_t(y) = \\nu_{t,0} \\left( 1 + \\alpha \\frac{y}{H} \\right)$。\n    我们在体积上对 $P_k$ 进行积分：\n    $$\n    \\mathcal{P} = \\int_V \\nu_t(y) S^2 \\, \\mathrm{d}V = S^2 L_x L_z \\int_0^H \\nu_{t,0} \\left( 1 + \\alpha \\frac{y}{H} \\right) \\mathrm{d}y\n    $$\n    $$\n    \\mathcal{P} = S^2 L_x L_z \\nu_{t,0} \\left[ y + \\frac{\\alpha y^2}{2H} \\right]_0^H = S^2 L_x L_z \\nu_{t,0} \\left( H + \\frac{\\alpha H^2}{2H} \\right) = S^2 (L_x L_z H) \\nu_{t,0} \\left( 1 + \\frac{\\alpha}{2} \\right)\n    $$\n    代入给定值：$S=100\\,\\mathrm{s^{-1}}$，$V=0.05\\,\\mathrm{m^3}$，$\\nu_{t,0} = 5.0 \\times 10^{-4}\\,\\mathrm{m^{2}\\,s^{-1}}$，以及 $\\alpha=0.2$。\n    $$\n    \\mathcal{P} = (100^2)(0.05)(5.0 \\times 10^{-4}) \\left( 1 + \\frac{0.2}{2} \\right) = (10000)(0.05)(5.0 \\times 10^{-4})(1.1) = (500)(5.0 \\times 10^{-4})(1.1) = 0.25 \\times 1.1 = 0.275\\,\\mathrm{m^{5}\\,s^{-3}}\n    $$\n2.  **积分耗散项, $\\mathcal{E}$**：\n    耗散率 $\\varepsilon$ 是均匀的，$\\varepsilon = 4\\,\\mathrm{m^{2}\\,s^{-3}}$。\n    $$\n    \\mathcal{E} = \\int_V \\varepsilon \\, \\mathrm{d}V = \\varepsilon V = (4)(0.05) = 0.2\\,\\mathrm{m^{5}\\,s^{-3}}\n    $$\n3.  **净输运项, $\\mathcal{T}$**：\n    输运贡献来自通过壁面的净通量。我们需要计算 $T_y(H) - T_y(0)$。\n    通量为 $T_y(y) = - \\left( \\nu + \\frac{\\nu_t(y)}{\\sigma_k} \\right) \\frac{\\partial k}{\\partial y}$。TKE 梯度 $\\frac{\\partial k}{\\partial y}$ 是均匀的，为 $-10\\,\\mathrm{m\\,s^{-2}}$。\n    $$\n    T_y(y) = - \\left( \\nu + \\frac{\\nu_{t,0}}{\\sigma_k} \\left(1 + \\alpha \\frac{y}{H}\\right) \\right) \\frac{\\partial k}{\\partial y}\n    $$\n    差值为：\n    $$\n    T_y(H) - T_y(0) = - \\left( \\nu + \\frac{\\nu_{t,0}(1+\\alpha)}{\\sigma_k} \\right)\\frac{\\partial k}{\\partial y} - \\left[ - \\left( \\nu + \\frac{\\nu_{t,0}}{\\sigma_k} \\right)\\frac{\\partial k}{\\partial y} \\right]\n    $$\n    $$\n    T_y(H) - T_y(0) = \\left( -\\nu - \\frac{\\nu_{t,0}}{\\sigma_k} - \\frac{\\alpha \\nu_{t,0}}{\\sigma_k} + \\nu + \\frac{\\nu_{t,0}}{\\sigma_k} \\right) \\frac{\\partial k}{\\partial y} = - \\frac{\\alpha \\nu_{t,0}}{\\sigma_k} \\frac{\\partial k}{\\partial y}\n    $$\n    总输运项为 $\\mathcal{T} = L_x L_z [T_y(H) - T_y(0)] = - L_x L_z \\frac{\\alpha \\nu_{t,0}}{\\sigma_k} \\frac{\\partial k}{\\partial y}$。\n    代入数值：$L_x=1\\,\\mathrm{m}$，$L_z=0.5\\,\\mathrm{m}$，$\\alpha=0.2$，$\\nu_{t,0}=5.0 \\times 10^{-4}\\,\\mathrm{m^{2}\\,s^{-1}}$，$\\sigma_k=1.0$，和 $\\frac{\\partial k}{\\partial y}=-10\\,\\mathrm{m\\,s^{-2}}$。\n    $$\n    \\mathcal{T} = -(1)(0.5) \\frac{(0.2)(5.0 \\times 10^{-4})}{1.0} (-10) = -(0.5)(1.0 \\times 10^{-4})(-10) = (0.5)(1.0 \\times 10^{-3}) = 0.0005\\,\\mathrm{m^{5}\\,s^{-3}}\n    $$\n最后，我们计算积分 TKE 的总变化率：\n$$\n\\frac{\\mathrm{d}\\mathcal{K}}{\\mathrm{d}t} = \\mathcal{P} - \\mathcal{E} + \\mathcal{T} = 0.275 - 0.2 + 0.0005 = 0.0755\\,\\mathrm{m^{5}\\,s^{-3}}\n$$\n问题要求将答案四舍五入到四位有效数字。\n$$\n\\frac{\\mathrm{d}\\mathcal{K}}{\\mathrm{d}t} = 0.07550\\,\\mathrm{m^{5}\\,s^{-3}}\n$$",
            "answer": "$$\n\\boxed{0.07550}\n$$"
        },
        {
            "introduction": "机器学习模型的原始输出不一定保证物理上有效。本练习旨在解决构建稳健的机器学习封闭模型中的一个关键步骤：确保预测的雷诺应力张量是“可实现的”。学生将设计一个投影层，在保持湍动能守恒的同时，强制该张量具有正半定性，这一过程对于防止模拟中出现非物理结果至关重要。",
            "id": "3342977",
            "problem": "要求您为雷诺平均纳维-斯托克斯（RANS）建模中的机器学习（ML）增强湍流闭合模型设计和评估一个可实现性层。该可实现性层必须将预测的雷诺应力张量投影到半正定张量锥上，同时保持湍动能。评估必须量化该投影如何改变均匀剪切流中模拟的生成项，以及它如何影响相对于基准张量的准确性。\n\n基于第一性原理的出发点和定义：\n- 雷诺应力张量 $R_{ij}$ 定义为 $R_{ij} = \\overline{u_i' u_j'}$，它是对称的，单位为 $\\mathrm{m^2/s^2}$。\n- 湍动能 $k$ 满足 $R_{ii} = 2k$；等效地，迹约束为 $\\mathrm{tr}(R) = 2k$。\n- 一个张量 $R$ 是可实现的，如果它是半正定（PSD）的，即对于所有向量 $a$ 都有 $a_i R_{ij} a_j \\ge 0$。对于对称张量，这等价于其所有特征值均为非负。\n- 在平均速度场为 $U_1 = S y$，$U_2 = 0$，$U_3 = 0$ 的均匀平面剪切流中，其中 $S$ 是单位为 $\\mathrm{s^{-1}}$ 的恒定剪切率，单位质量的湍流生成项为 $P = -R_{ij} \\partial U_i/\\partial x_j = -R_{12} S$，单位为 $\\mathrm{m^2/s^3}$。\n\n设计任务：\n- 给定一个预测的对称 $3 \\times 3$ 张量 $R_{ij}^{\\mathrm{pred}}$（可能非半正定且 $\\mathrm{tr}(R^{\\mathrm{pred}}) \\ne 2k$），设计一个可实现性层来计算\n$$\nR^{\\mathrm{proj}} = \\underset{R}{\\arg\\min}\\ \\lVert R - R^{\\mathrm{pred}}\\rVert_F\n\\quad\\text{subject to}\\quad\nR = R^\\top,\\ R \\succeq 0,\\ \\mathrm{tr}(R)=2k,\n$$\n其中 $\\lVert \\cdot \\rVert_F$ 是弗罗贝尼乌斯范数，$R \\succeq 0$ 表示半正定。通过将问题简化为特征值空间中的欧几里得投影并重构 $R^{\\mathrm{proj}}$ 来实现此投影。\n\n评估任务：\n- 为均匀平面剪切流定义一个基准张量为\n$$\nR^{\\mathrm{true}} = \\begin{bmatrix}\n\\frac{2k}{3}  -c\\frac{2k}{3}  0 \\\\\n-c\\frac{2k}{3}  \\frac{2k}{3}  0 \\\\\n0  0  \\frac{2k}{3}\n\\end{bmatrix},\n$$\n其中 $c \\in [0,1]$ 是一个无量纲的剪切应力系数。当 $|R^{\\mathrm{true}}_{12}| \\le \\frac{2k}{3}$ 时，该张量是对称且半正定的。\n- 对于每个测试用例，计算以下量：\n  1. $P^{\\mathrm{pred}} = -R^{\\mathrm{pred}}_{12} S$，单位为 $\\mathrm{m^2/s^3}$，\n  2. $P^{\\mathrm{proj}} = -R^{\\mathrm{proj}}_{12} S$，单位为 $\\mathrm{m^2/s^3}$，\n  3. 投影引起的耗散等效量 $\\Delta P = P^{\\mathrm{pred}} - P^{\\mathrm{proj}}$，单位为 $\\mathrm{m^2/s^3}$，\n  4. 相对弗罗贝尼乌斯误差 $e_F = \\lVert R^{\\mathrm{proj}} - R^{\\mathrm{true}}\\rVert_F / \\lVert R^{\\mathrm{true}}\\rVert_F$ (无量纲)，\n  5. 相对剪切应力误差 $e_{12} = \\lvert R^{\\mathrm{proj}}_{12} - R^{\\mathrm{true}}_{12}\\rvert / \\lvert R^{\\mathrm{true}}_{12}\\rvert$ (无量纲)。\n\n数值规格和单位要求：\n- 使用单位为 $\\mathrm{m^2/s^2}$ 的 $k$ 和单位为 $\\mathrm{s^{-1}}$ 的 $S$。将 $\\Delta P$ 以 $\\mathrm{m^2/s^3}$ 为单位表示，并四舍五入到六位小数。将 $e_F$ 和 $e_{12}$ 表示为小数，并四舍五入到六位小数。此问题中不涉及角度。不要使用百分号；所有比率必须是小数。\n\n测试套件：\n提供以下四个测试用例，每个用例由 $(k, S, c, R^{\\mathrm{pred}})$ 指定，其中 $R^{\\mathrm{pred}}$ 由其元素给出。在投影之前，程序必须首先通过 $(R^{\\mathrm{pred}} + (R^{\\mathrm{pred}})^\\top)/2$ 对 $R^{\\mathrm{pred}}$ 进行对称化处理。\n- 用例 1 (理想路径，轻度不可实现)：\n  - $k = 0.5$, $S = 10$, $c = 0.8$,\n  - $R^{\\mathrm{pred}} = \\begin{bmatrix} 0.30  -0.30  0.00 \\\\ -0.31  0.32  0.00 \\\\ 0.00  0.00  0.35 \\end{bmatrix}$.\n- 用例 2 (边界情况，已可实现且迹正确)：\n  - $k = 0.3$, $S = 5$, $c = 0.5$,\n  - $R^{\\mathrm{pred}} = \\begin{bmatrix} 0.20  -0.10  0.00 \\\\ -0.10  0.20  0.00 \\\\ 0.00  0.00  0.20 \\end{bmatrix}$.\n- 用例 3 (严重违规，具有负法向应力和过大的剪切应力)：\n  - $k = 0.8$, $S = 20$, $c = 0.9$,\n  - $R^{\\mathrm{pred}} = \\begin{bmatrix} 0.90  -0.70  0.20 \\\\ -0.70  -0.10  -0.10 \\\\ 0.20  -0.10  0.70 \\end{bmatrix}$.\n- 用例 4 (边缘情况，零剪切率)：\n  - $k = 1.0$, $S = 0$, $c = 0.6$,\n  - $R^{\\mathrm{pred}} = \\begin{bmatrix} 1.80  -0.90  0.00 \\\\ -0.90  0.10  0.00 \\\\ 0.00  0.00  0.30 \\end{bmatrix}$.\n\n计算要求：\n- 将可实现性层实现为对称化的 $R^{\\mathrm{pred}}$ 的特征值到非负单纯形 $\\{x \\in \\mathbb{R}^3: x_i \\ge 0,\\ \\sum_i x_i = 2k\\}$ 上的欧几里得投影，然后使用相同的特征向量重构 $R^{\\mathrm{proj}}$。\n- 对于每个测试用例，根据上述单位规格计算三元组 $(\\Delta P, e_F, e_{12})$。将每个值四舍五入到六位小数。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，结果按以下顺序排列：\n$[\\Delta P_1, e_{F,1}, e_{12,1}, \\Delta P_2, e_{F,2}, e_{12,2}, \\Delta P_3, e_{F,3}, e_{12,3}, \\Delta P_4, e_{F,4}, e_{12,4}]$，\n每个浮点数按要求四舍五入到六位小数。",
            "solution": "用户要求为雷诺平均纳维-斯托克斯（RANS）湍流模型设计和评估一个可实现性层。解决该问题的方法是首先验证其科学和数学上的完整性，然后给出一个详细的、基于原理的解决方案。\n\n### 问题验证\n\n**第1步：提取的已知条件**\n- 雷诺应力张量：$R_{ij} = \\overline{u_i' u_j'}$，对称，单位 $\\mathrm{m^2/s^2}$。\n- 迹约束：$\\mathrm{tr}(R) = R_{ii} = 2k$，其中 $k$ 是湍动能。\n- 可实现性约束：$R$ 必须是半正定（$R \\succeq 0$），等价于具有非负特征值。\n- 流动配置：平均速度场为 $U_1 = S y$, $U_2 = 0$, $U_3 = 0$ 的均匀平面剪切流。\n- 湍流生成项：$P = -R_{12} S$，单位 $\\mathrm{m^2/s^3}$。\n- 优化问题：寻找 $R^{\\mathrm{proj}} = \\underset{R}{\\arg\\min}\\ \\lVert R - R^{\\mathrm{pred}}\\rVert_F$，约束条件为 $R = R^\\top$，$R \\succeq 0$ 和 $\\mathrm{tr}(R)=2k$。\n- 实现规格：投影将在对称化的 $R^{\\mathrm{pred}}$ 的特征值空间中执行。\n- 基准张量：$R^{\\mathrm{true}} = \\begin{bmatrix} \\frac{2k}{3}  -c\\frac{2k}{3}  0 \\\\ -c\\frac{2k}{3}  \\frac{2k}{3}  0 \\\\ 0  0  \\frac{2k}{3} \\end{bmatrix}$，其中 $c \\in [0,1]$。\n- 评估指标：$P^{\\mathrm{pred}} = -R^{\\mathrm{pred}}_{12} S$, $P^{\\mathrm{proj}} = -R^{\\mathrm{proj}}_{12} S$, $\\Delta P = P^{\\mathrm{pred}} - P^{\\mathrm{proj}}$, $e_F = \\lVert R^{\\mathrm{proj}} - R^{\\mathrm{true}}\\rVert_F / \\lVert R^{\\mathrm{true}}\\rVert_F$, $e_{12} = \\lvert R^{\\mathrm{proj}}_{12} - R^{\\mathrm{true}}_{12}\\rvert / \\lvert R^{\\mathrm{true}}_{12}\\rvert$。\n- 预处理：$R^{\\mathrm{pred}}$ 必须首先通过 $(R^{\\mathrm{pred}} + (R^{\\mathrm{pred}})^\\top)/2$ 进行对称化。\n- 指定了四个测试用例，包含 $(k, S, c, R^{\\mathrm{pred}})$ 的数值。\n- 数值精度：$\\Delta P$、$e_F$ 和 $e_{12}$ 必须四舍五入到六位小数。\n\n**第2步：使用提取的已知条件进行验证**\n- **科学性和事实性**：该问题在连续介质力学和湍流理论的原理上有坚实的基础。雷诺应力张量、湍动能、生成项以及可实现性约束（$R \\succeq 0$, $\\mathrm{tr}(R)=2k$）的定义在计算流体力学中是标准的。数学公式是正确的。\n- **适定性**：该优化问题构成了在希尔伯特空间（具有弗罗贝尼乌斯内积的对称 $3 \\times 3$ 矩阵空间）中对一个非空、闭合、凸集上的投影。这保证了解 $R^{\\mathrm{proj}}$ 的存在性和唯一性。\n- **完整性和一致性**：问题提供了所有必要的数据，包括物理参数、模型预测以及每个测试用例的明确基准定义。约束条件是一致的，评估指标的定义是明确的。通过特征值投影的指定实现方法是解决该问题的标准且正确的方法。\n\n**第3步：结论与行动**\n- 该问题是**有效的**。它在科学上是合理的，数学上是适定的，并且是完整的。我们着手进行求解。\n\n### 基于原理的解决方案\n\n任务的核心是将一个给定的对称 $3 \\times 3$ 张量 $R^{\\mathrm{pred}}$ 投影到物理上可实现的雷诺应力张量空间上。一个可实现的张量必须是对称的、半正定的，并满足迹约束。\n\n**1. 对称化**\n我们的投影算子的定义域是对称矩阵空间。来自机器学习模型的初始输入，此处表示为 $R^{\\mathrm{raw}}$，可能由于数值伪影或模型架构而不是完全对称的。第一步是找到其最接近的对称对应物，这通过将其与其转置矩阵取平均值来实现：\n$$\nR^{\\mathrm{pred}} = \\frac{1}{2} (R^{\\mathrm{raw}} + (R^{\\mathrm{raw}})^\\top)\n$$\n此操作将 $R^{\\mathrm{raw}}$ 投影到对称矩阵的子空间上。\n\n**2. 投影到可实现锥上**\n问题是找到 $R^{\\mathrm{proj}}$ 来解决：\n$$\n\\underset{R}{\\text{minimize}} \\quad \\frac{1}{2}\\lVert R - R^{\\mathrm{pred}}\\rVert_F^2 \\quad \\text{subject to} \\quad R = R^\\top, \\quad R \\succeq 0, \\quad \\mathrm{tr}(R)=2k\n$$\n这个约束优化问题可以通过将其转换到特征值空间来高效求解。由于 $R^{\\mathrm{pred}}$ 是对称的，它可以进行谱分解：\n$$\nR^{\\mathrm{pred}} = Q \\Lambda^{\\mathrm{pred}} Q^\\top\n$$\n其中 $Q$ 是一个正交矩阵，其列是 $R^{\\mathrm{pred}}$ 的特征向量，$\\Lambda^{\\mathrm{pred}} = \\mathrm{diag}(\\lambda_1^{\\mathrm{pred}}, \\lambda_2^{\\mathrm{pred}}, \\lambda_3^{\\mathrm{pred}})$ 是对应特征值的对角矩阵。\n\n弗罗贝尼乌斯范数是酉不变的，即对于任何正交矩阵 $U$，$\\lVert A \\rVert_F = \\lVert U A U^\\top \\rVert_F$。这个性质允许我们用特征值重写优化问题。我们寻求一个投影后的张量 $R$，它与 $R^{\\mathrm{pred}}$ 共享相同的特征向量，因此 $R = Q \\Lambda Q^\\top$。问题于是简化为寻找投影后的特征值对角矩阵 $\\Lambda = \\mathrm{diag}(\\lambda_1, \\lambda_2, \\lambda_3)$：\n$$\n\\underset{\\vec{\\lambda}}{\\text{minimize}} \\quad \\frac{1}{2}\\lVert \\vec{\\lambda} - \\vec{\\lambda}^{\\mathrm{pred}}\\rVert_2^2 \\quad \\text{subject to} \\quad \\lambda_i \\ge 0 \\;\\forall i, \\quad \\sum_{i=1}^3 \\lambda_i = 2k\n$$\n其中 $\\vec{\\lambda} = (\\lambda_1, \\lambda_2, \\lambda_3)$ 和 $\\vec{\\lambda}^{\\mathrm{pred}} = (\\lambda_1^{\\mathrm{pred}}, \\lambda_2^{\\mathrm{pred}}, \\lambda_3^{\\mathrm{pred}})$。这是一个将点 $\\vec{\\lambda}^{\\mathrm{pred}}$ 投影到概率单纯形上的标准欧几里得投影问题，并按因子 $2k$ 进行缩放。\n\n**3. 投影到单纯形上的算法**\n存在一个高效的算法来完成这个投影。对于一个向量 $y \\in \\mathbb{R}^n$ 和一个目标和 $s$，到 $\\{x \\in \\mathbb{R}^n | x_i \\ge 0, \\sum x_i = s\\}$ 上的投影 $x$ 由 $x_i = \\max(0, y_i - \\theta)$ 给出，其中 $\\theta$ 是一个恒定的位移。找到这个位移 $\\theta$ 以满足约束条件。算法如下：\n1. 将向量 $\\vec{\\lambda}^{\\mathrm{pred}}$ 的分量按降序排序：$u_1 \\ge u_2 \\ge u_3$。\n2. 找到最大的整数 $\\rho \\in \\{1, 2, 3\\}$ 使得 $u_\\rho - \\frac{1}{\\rho}(\\sum_{j=1}^\\rho u_j - 2k) > 0$。\n3. 计算阈值 $\\theta = \\frac{1}{\\rho}(\\sum_{j=1}^\\rho u_j - 2k)$。\n4. 投影后的特征值由 $\\lambda_i^{\\mathrm{proj}} = \\max(0, \\lambda_i^{\\mathrm{pred}} - \\theta)$ 给出。\n\n该算法有效地从较大的特征值中“削去”一个恒定值，并将任何产生的负值截断为零，同时确保满足总和约束 $\\sum \\lambda_i^{\\mathrm{proj}} = 2k$。\n\n**4. 重构与评估**\n在计算出投影后的特征值 $\\vec{\\lambda}^{\\mathrm{proj}}$ 后，最终的可实现张量 $R^{\\mathrm{proj}}$ 使用原始的特征向量 $Q$ 进行重构：\n$$\nR^{\\mathrm{proj}} = Q \\, \\mathrm{diag}(\\vec{\\lambda}^{\\mathrm{proj}}) \\, Q^\\top\n$$\n得到 $R^{\\mathrm{proj}}$ 后，按规定计算评估指标：\n- 计算生成项 $P^{\\mathrm{pred}} = -R^{\\mathrm{pred}}_{12} S$ 和 $P^{\\mathrm{proj}} = -R^{\\mathrm{proj}}_{12} S$。\n- 确定投影引起的变化 $\\Delta P = P^{\\mathrm{pred}} - P^{\\mathrm{proj}}$。\n- 为给定的 $k$ 和 $c$ 构建基准张量 $R^{\\mathrm{true}}$。\n- 计算弗罗贝尼乌斯范数（$e_F$）和剪切应力分量（$e_{12}$）的相对误差，以量化投影张量相对于基准张量的准确性。\n\n此过程应用于所提供的四个测试用例中的每一个。",
            "answer": "$$\n\\boxed{[0.000000,0.118742,0.100000,0.000000,0.000000,0.000000,5.776650,0.563032,0.589838,0.000000,0.707107,0.353553]}\n$$"
        },
        {
            "introduction": "如果与之耦合的CFD求解器无法收敛，那么一个物理上可实现的模型也毫无用处。本练习深入探讨了构建稳定的机器学习-RANS系统所需的数值分析。通过应用压缩映射原理，学生将推导出一个关于机器学习修正项的约束条件（即Lipschitz界），以保证迭代求解器的收敛性，这是模型在实际应用中的一个关键考量。",
            "id": "3342976",
            "problem": "考虑在有限维空间上离散化的稳态雷诺平均纳维-斯托克斯 (RANS) 方程，其动量平衡具有代数形式 $\\,\\mathcal{L} u = b + \\mathcal{C}(u)\\,$，其中 $\\,u \\in \\mathbb{R}^{n}\\,$ 是离散的平均速度向量，$\\,\\mathcal{L} \\in \\mathbb{R}^{n \\times n}\\,$ 是由对流、扩散和压力耦合产生的离散线性算子，$\\,b \\in \\mathbb{R}^{n}\\,$ 是一个已知的强迫向量，而 $\\,\\mathcal{C} : \\mathbb{R}^{n} \\to \\mathbb{R}^{n}\\,$ 编码了基线湍流封闭贡献（例如，涡粘性残差）。为了增广该封闭，假设添加一个机器学习 (ML) 校正项 $\\,\\Delta \\mathcal{C} : \\mathbb{R}^{n} \\to \\mathbb{R}^{n}\\,$，使得增广后的平衡方程变为 $\\,\\mathcal{L} u = b + \\mathcal{C}(u) + \\Delta \\mathcal{C}(u)\\,$。\n\n该增广系统的一个不动点迭代定义为\n$$\nu^{k+1} \\;=\\; T(u^{k}) \\;\\equiv\\; \\mathcal{L}^{-1}\\!\\big( b + \\mathcal{C}(u^{k}) + \\Delta \\mathcal{C}(u^{k}) \\big).\n$$\n假设如下：\n- 算子 $\\,\\mathcal{L}\\,$ 是对称正定的，其最小特征值为 $\\,\\alpha > 0\\,$，并且所有范数均为向量 $2$-范数和诱导算子 $2$-范数。\n- 基线封闭映射 $\\,\\mathcal{C}\\,$ 是全局利普希茨的，其利普希茨常数为 $\\,K_{0} \\ge 0\\,$，即对于所有 $\\,u,v \\in \\mathbb{R}^{n}\\,$，满足 $\\,\\|\\mathcal{C}(u) - \\mathcal{C}(v)\\|_{2} \\le K_{0}\\|u-v\\|_{2}\\,$。\n- 机器学习校正项 $\\,\\Delta \\mathcal{C}\\,$ 被设计为全局利普希茨的，其利普希茨常数为 $\\,L \\ge 0\\,$，即对于所有 $\\,u,v \\in \\mathbb{R}^{n}\\,$，满足 $\\,\\|\\Delta \\mathcal{C}(u) - \\Delta \\mathcal{C}(v)\\|_{2} \\le L\\|u-v\\|_{2}\\,$。\n\n从压缩映射原理（巴拿赫不动点定理）、利普希茨连续性的基本定义以及对称正定算子的性质出发，推导机器学习校正项允许的最大利普希茨常数 $\\,L_{\\max}\\,$，使得迭代映射 $\\,T\\,$ 在 2-范数下是严格压缩的。将你的最终结果表示为仅含 $\\,\\alpha\\,$ 和 $\\,K_{0}\\,$ 的单个闭式解析表达式。不需要进行数值评估。你的最终答案必须仅为该表达式，不含不等式或其他额外文本。",
            "solution": "问题要求求解机器学习 (ML) 校正项 $\\Delta \\mathcal{C}$ 允许的最大利普希茨常数（记为 $L_{\\max}$），使得给定的雷诺平均纳维-斯托克斯 (RANS) 方程的不动点迭代是严格压缩的。首先评估问题陈述的有效性。\n\n### 步骤 1：提取已知条件\n问题提供了以下信息：\n- 增广 RANS 系统由 $\\mathcal{L} u = b + \\mathcal{C}(u) + \\Delta \\mathcal{C}(u)$ 给出，其中 $u \\in \\mathbb{R}^{n}$，$ \\mathcal{L} \\in \\mathbb{R}^{n \\times n}$，$b \\in \\mathbb{R}^{n}$，$\\mathcal{C} : \\mathbb{R}^{n} \\to \\mathbb{R}^{n}$，以及 $\\Delta \\mathcal{C} : \\mathbb{R}^{n} \\to \\mathbb{R}^{n}$。\n- 不动点迭代由映射 $T : \\mathbb{R}^{n} \\to \\mathbb{R}^{n}$ 定义为 $u^{k+1} = T(u^{k}) \\equiv \\mathcal{L}^{-1}\\big( b + \\mathcal{C}(u^{k}) + \\Delta \\mathcal{C}(u^{k}) \\big)$。\n- 算子 $\\mathcal{L}$ 是对称正定的，其最小特征值为 $\\alpha > 0$。\n- 所有范数均为向量 2-范数 $\\|\\cdot\\|_{2}$ 和诱导算子 2-范数。\n- 基线封闭映射 $\\mathcal{C}$ 是全局利普希茨连续的，其利普希茨常数为 $K_{0} \\ge 0$，对所有 $u, v \\in \\mathbb{R}^{n}$ 满足 $\\|\\mathcal{C}(u) - \\mathcal{C}(v)\\|_{2} \\le K_{0}\\|u-v\\|_{2}$。\n- 机器学习校正映射 $\\Delta \\mathcal{C}$ 是全局利普希茨连续的，其利普希茨常数为 $L \\ge 0$，对所有 $u, v \\in \\mathbb{R}^{n}$ 满足 $\\|\\Delta \\mathcal{C}(u) - \\Delta \\mathcal{C}(v)\\|_{2} \\le L\\|u-v\\|_{2}$。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据，植根于计算流体力学和求解非线性方程组的迭代格式的数值分析。这是科学计算和工程领域的一个标准课题。问题是良定的、客观的和自洽的，提供了推导所要求条件所需的所有数学定义和约束（对称正定算子、利普希茨连续性）。不存在矛盾、模糊或事实错误。该问题是一个基于既定原则的形式化数学练习。\n\n### 步骤 3：结论与行动\n问题被判定为有效。将推导解答。\n\n### 解答推导\n根据压缩映射原理（巴拿赫不动点定理），如果存在一个常数 $\\gamma \\in [0, 1)$，使得对于任意两个向量 $u, v \\in \\mathbb{R}^{n}$，以下不等式成立，则迭代映射 $T$ 是一个严格压缩：\n$$\n\\|T(u) - T(v)\\|_{2} \\le \\gamma \\|u - v\\|_{2}\n$$\n满足条件的最小常数 $\\gamma$ 是映射 $T$ 的利普希茨常数。我们的目标是找到 $L$ 需满足的条件，以确保 $T$ 的利普希茨常数严格小于 1。\n\n我们来考虑差值 $T(u) - T(v)$:\n$$\nT(u) - T(v) = \\mathcal{L}^{-1}\\big( b + \\mathcal{C}(u) + \\Delta \\mathcal{C}(u) \\big) - \\mathcal{L}^{-1}\\big( b + \\mathcal{C}(v) + \\Delta \\mathcal{C}(v) \\big)\n$$\n利用算子 $\\mathcal{L}^{-1}$ 的线性性质，我们可以合并这些项：\n$$\nT(u) - T(v) = \\mathcal{L}^{-1} \\big[ \\big(\\mathcal{C}(u) - \\mathcal{C}(v)\\big) + \\big(\\Delta \\mathcal{C}(u) - \\Delta \\mathcal{C}(v)\\big) \\big]\n$$\n现在，我们对两边取 2-范数，并应用诱导算子范数的性质，即 $\\|Ax\\|_{2} \\le \\|A\\|_{2}\\|x\\|_{2}$：\n$$\n\\|T(u) - T(v)\\|_{2} \\le \\|\\mathcal{L}^{-1}\\|_{2} \\left\\| \\big(\\mathcal{C}(u) - \\mathcal{C}(v)\\big) + \\big(\\Delta \\mathcal{C}(u) - \\Delta \\mathcal{C}(v)\\big) \\right\\|_{2}\n$$\n接下来，我们对右侧应用向量范数的三角不等式 $\\|x+y\\|_{2} \\le \\|x\\|_{2} + \\|y\\|_{2}$：\n$$\n\\|T(u) - T(v)\\|_{2} \\le \\|\\mathcal{L}^{-1}\\|_{2} \\left( \\|\\mathcal{C}(u) - \\mathcal{C}(v)\\|_{2} + \\|\\Delta \\mathcal{C}(u) - \\Delta \\mathcal{C}(v)\\|_{2} \\right)\n$$\n已知 $\\mathcal{C}$ 和 $\\Delta \\mathcal{C}$ 的利普希茨条件：\n$$\n\\|\\mathcal{C}(u) - \\mathcal{C}(v)\\|_{2} \\le K_{0}\\|u-v\\|_{2}\n$$\n$$\n\\|\\Delta \\mathcal{C}(u) - \\Delta \\mathcal{C}(v)\\|_{2} \\le L\\|u-v\\|_{2}\n$$\n将这些不等式代入我们的主表达式中，得到：\n$$\n\\|T(u) - T(v)\\|_{2} \\le \\|\\mathcal{L}^{-1}\\|_{2} \\left( K_{0}\\|u-v\\|_{2} + L\\|u-v\\|_{2} \\right)\n$$\n提出公因子 $\\|u-v\\|_{2}$：\n$$\n\\|T(u) - T(v)\\|_{2} \\le \\|\\mathcal{L}^{-1}\\|_{2} (K_{0} + L) \\|u-v\\|_{2}\n$$\n这个不等式表明映射 $T$ 的利普希茨常数是 $\\gamma = \\|\\mathcal{L}^{-1}\\|_{2} (K_{0} + L)$。要使 $T$ 成为严格压缩，我们必须有 $\\gamma  1$：\n$$\n\\|\\mathcal{L}^{-1}\\|_{2} (K_{0} + L)  1\n$$\n下一步是确定 $\\|\\mathcal{L}^{-1}\\|_{2}$。已知 $\\mathcal{L}$ 是一个对称矩阵。对于对称矩阵，其诱导 2-范数等于其谱半径，即最大特征值的绝对值。设 $\\lambda_{i}(\\mathcal{L})$ 为 $\\mathcal{L}$ 的特征值。\n$$\n\\|\\mathcal{L}\\|_{2} = \\rho(\\mathcal{L}) = \\max_{i} |\\lambda_{i}(\\mathcal{L})|\n$$\n由于 $\\mathcal{L}$ 是正定的，其所有特征值都是实数且为正，因此对所有 $i$ 都有 $\\lambda_{i}(\\mathcal{L})  0$。逆矩阵 $\\mathcal{L}^{-1}$ 的特征值是 $\\mathcal{L}$ 特征值的倒数，即 $\\lambda_{i}(\\mathcal{L}^{-1}) = 1/\\lambda_{i}(\\mathcal{L})$。算子 $\\mathcal{L}^{-1}$ 也是对称正定的。因此，它的 2-范数是其最大特征值：\n$$\n\\|\\mathcal{L}^{-1}\\|_{2} = \\rho(\\mathcal{L}^{-1}) = \\max_{i} \\lambda_{i}(\\mathcal{L}^{-1}) = \\max_{i} \\left( \\frac{1}{\\lambda_{i}(\\mathcal{L})} \\right) = \\frac{1}{\\min_{i} \\lambda_{i}(\\mathcal{L})}\n$$\n已知 $\\mathcal{L}$ 的最小特征值是 $\\alpha$。因此：\n$$\n\\|\\mathcal{L}^{-1}\\|_{2} = \\frac{1}{\\alpha}\n$$\n将此结果代回压缩条件中：\n$$\n\\frac{1}{\\alpha}(K_{0} + L)  1\n$$\n由于 $\\alpha > 0$，我们可以在不等式两边同乘以 $\\alpha$ 而不改变不等号方向：\n$$\nK_{0} + L  \\alpha\n$$\n解出 $L$，我们得到使映射成为严格压缩 $L$ 必须满足的条件：\n$$\nL  \\alpha - K_{0}\n$$\n问题要求的是允许的最大利普希茨常数 $L_{\\max}$。这是所有满足严格不等式和给定约束 $L \\ge 0$ 的 $L$ 的可能值集合的上确界。$L$ 的允许值集合是区间 $[0, \\alpha - K_{0})$。该集合的上确界是 $\\alpha - K_{0}$。为使该区间非空，要求 $\\alpha  K_0$，这意味着基线迭代（$L=0$时）必须已经是一个严格压缩。推导出的表达式仍然是 $L$ 的上界。\n因此，允许的最大利普希茨常数是 $L_{\\max} = \\alpha - K_{0}$。",
            "answer": "$$\n\\boxed{\\alpha - K_{0}}\n$$"
        }
    ]
}