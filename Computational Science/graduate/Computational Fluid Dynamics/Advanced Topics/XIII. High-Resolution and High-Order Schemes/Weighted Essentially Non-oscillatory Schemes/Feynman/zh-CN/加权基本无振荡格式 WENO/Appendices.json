{
    "hands_on_practices": [
        {
            "introduction": "要真正掌握加权基本无振荡（WENO）格式的精髓，我们必须首先理解其前身——基本无振荡（ENO）格式。这个基础练习将引导您理解所有无振荡方法所依赖的核心原则：模板选择。通过分析ENO格式如何离散地选择“最光滑”的模板以避免跨越间断，您将为WENO格式通过连续加权来改进和增强的“无振荡”特性建立起坚实的直觉 。",
            "id": "3391790",
            "problem": "考虑一个一维均匀网格，其节点为 $x_j = x_0 + j\\,\\Delta x$（其中 $j$ 为整数），网格间距为常数 $\\Delta x > 0$。设 $u(x)$ 是分段光滑的，具体来说，在每个不包含间断点的开区间上 $u \\in C^2$。并假设 $u(x)$ 在单元 $[x_i, x_{i+1}]$ 内部严格存在一个量值非零的跳跃间断点。将逐点数据记为 $u_j := u(x_j)$，其中 $j$ 为所有整数。在加权基本无振荡 (WENO) 格式所基于的框架中，为了达到二阶精度，原始的基本无振荡 (ENO) 重构在界面 $x_{i+1/2} := x_i + \\tfrac{1}{2}\\Delta x$ 处考虑两个候选模板 $S_L = \\{x_{i-1}, x_i\\}$ 和 $S_R = \\{x_i, x_{i+1}\\}$ 来构建一个1次多项式插值。ENO 模板选择原则是在每个决策步骤中，选择其相关局部差商的量值较小的候选模板，从而避免使用跨越间断点的模板。\n\n假设仅基于以下基本事实：(i) 在 $u \\in C^2$ 的区间上，其一阶导数的量值受某个有限常数限制；(ii) 跨越一个包含跳跃间断点的区间的一阶差商的量值，与跳跃量值除以区间长度成比例。请确定 ENO 过程会选择两个候选模板 $S_L$ 和 $S_R$ 中的哪一个来重构在 $x_{i+1/2}$ 处的左偏值 $u(x_{i+1/2}^-)$。然后，使用所选的模板，推导出在 $x_{i+1/2}$ 处的二阶 ENO 左偏重构值，并将其表示为节点值 $u_{i-1}$ 和 $u_i$ 或 $u_i$ 和 $u_{i+1}$ 的封闭形式线性组合。将您的最终答案表示为该线性组合（一个解析表达式）。",
            "solution": "该问题是有效的。这是一个基于偏微分方程数值分析中既定原则的适定问题，具体涉及基本无振荡 (ENO) 格式中的模板选择机制。所有术语都有定义，前提在科学上是合理的，且目标明确。\n\n任务是确定在函数 $u(x)$ 在单元 $[x_i, x_{i+1}]$ 内部严格存在一个跳跃间断点的情况下，二阶 ENO 过程会选择两个候选模板 $S_L$ 和 $S_R$ 中的哪一个来重构单元界面 $x_{i+1/2} := x_i + \\frac{1}{2}\\Delta x$ 处的值 $u(x_{i+1/2}^-)$。随后，我们必须使用所选的模板推导出该重构值。\n\n对于以界面 $x_{i+1/2}$ 为中心的二阶（1次多项式）重构，两个候选模板是 $S_L = \\{x_{i-1}, x_i\\}$ 和 $S_R = \\{x_i, x_{i+1}\\}$。ENO 选择原则规定选择与最小量值的差商相关联的模板。对于二阶格式，我们考察一阶差商。\n\n左模板 $S_L$ 的一阶差商为：\n$$\nu[x_{i-1}, x_i] = \\frac{u_i - u_{i-1}}{x_i - x_{i-1}} = \\frac{u_i - u_{i-1}}{\\Delta x}\n$$\n右模板 $S_R$ 的一阶差商为：\n$$\nu[x_i, x_{i+1}] = \\frac{u_{i+1} - u_i}{x_{i+1} - x_i} = \\frac{u_{i+1} - u_i}{\\Delta x}\n$$\nENO 过程的核心在于比较这两个量的绝对值：$|u[x_{i-1}, x_i]|$ 和 $|u[x_i, x_{i+1}]|$。\n\n根据题目，函数 $u(x)$ 在区间 $[x_i, x_{i+1}]$ 内部严格存在一个跳跃间断点。这意味着函数 $u(x)$ 在区间 $[x_{i-1}, x_i]$ 上是光滑的（至少是 $C^2$），该区间对应于模板 $S_L$。\n\n在光滑区间 $[x_{i-1}, x_i]$ 上，根据中值定理，存在一点 $\\xi \\in (x_{i-1}, x_i)$，使得差商等于该点的导数：\n$$\nu[x_{i-1}, x_i] = u'(\\xi)\n$$\n根据问题陈述（假设i），在光滑区域，导数的量值是有界的，即 $|u'(x)| \\le C_1$（其中 $C_1$ 为某个有限常数）。因此，在光滑模板上的差商的量值表现为：\n$$\n|u[x_{i-1}, x_i]| = |u'(\\xi)| = O(1)\n$$\n这意味着其量值是有界的，并且不会随着网格间距 $\\Delta x$ 的减小而增长。\n\n对于模板 $S_R$，区间 $[x_i, x_{i+1}]$ 包含跳跃间断点。根据问题陈述（假设ii），跨越一个量值为 $[u]$ 的跳跃间断点的一阶差商的量值，与跳跃量值除以区间长度成比例。因此，对于一个非零跳跃 $[u] \\neq 0$：\n$$\n|u[x_i, x_{i+1}]| = \\left| \\frac{u_{i+1} - u_i}{\\Delta x} \\right| \\approx \\frac{|[u]|}{\\Delta x} = O(\\Delta x^{-1})\n$$\n随着网格加密，即当 $\\Delta x \\to 0$ 时，该项会无界增长。\n\n现在，我们应用 ENO 选择准则：选择与较小量值的差商相对应的模板。我们比较它们的量值：\n$$\n|u[x_{i-1}, x_i]| = O(1) \\quad \\text{vs.} \\quad |u[x_i, x_{i+1}]| = O(\\Delta x^{-1})\n$$\n对于足够小的网格间距 $\\Delta x > 0$，以下关系式明确无疑地成立：\n$$\nO(1) \\ll O(\\Delta x^{-1})\n$$\n因此，有 $|u[x_{i-1}, x_i]| \\ll |u[x_i, x_{i+1}]|$。ENO 算法会选择避开间断点的模板，即 $S_L = \\{x_{i-1}, x_i\\}$。\n\n选定模板 $S_L$ 后，我们构建通过点 $(x_{i-1}, u_{i-1})$ 和 $(x_i, u_i)$ 的唯一线性插值多项式 $p(x)$。使用以 $x_i$ 为中心的牛顿形式插值多项式：\n$$\np(x) = u_i + (x - x_i) u[x_{i-1}, x_i] = u_i + (x - x_i) \\frac{u_i - u_{i-1}}{\\Delta x}\n$$\n界面处的二阶 ENO 左偏重构值 $u_{i+1/2}^-$，可以通过在 $x = x_{i+1/2} = x_i + \\frac{1}{2}\\Delta x$ 处计算该多项式的值来获得。\n$$\nu_{i+1/2}^- = p(x_{i+1/2}) = u_i + (x_{i+1/2} - x_i) \\frac{u_i - u_{i-1}}{\\Delta x}\n$$\n代入 $x_{i+1/2} - x_i = \\frac{1}{2}\\Delta x$：\n$$\nu_{i+1/2}^- = u_i + \\left(\\frac{1}{2}\\Delta x\\right) \\frac{u_i - u_{i-1}}{\\Delta x}\n$$\n$\\Delta x$ 项相互消去，得到：\n$$\nu_{i+1/2}^- = u_i + \\frac{1}{2}(u_i - u_{i-1})\n$$\n化简此表达式，得到节点值的最终线性组合：\n$$\nu_{i+1/2}^- = u_i + \\frac{1}{2}u_i - \\frac{1}{2}u_{i-1} = \\frac{3}{2}u_i - \\frac{1}{2}u_{i-1}\n$$\n这就是从左侧在 $x_{i+1/2}$ 处的二阶 ENO 重构值，它是从为避开已知间断点而选择的模板推导出来的。",
            "answer": "$$\n\\boxed{\\frac{3}{2}u_i - \\frac{1}{2}u_{i-1}}\n$$"
        },
        {
            "introduction": "在ENO的离散选择原则基础上，WENO格式引入了一种更为复杂的机制，它通过对所有候选模板进行基于其光滑度的凸组合加权。本实践提供了一个在精确解析的激波处进行五阶WENO重构的直接、动手计算，让您亲眼见证非线性加权机制的运作方式。您将计算光滑度指示因子，并观察它们如何有效地“关闭”来自跨越间断的模板的贡献，从而在不引入伪振荡的情况下保持解的锐利性 。",
            "id": "3391791",
            "problem": "考虑均匀一维网格上的标量守恒律 $u_{t} + f(u)_{x} = 0$。网格单元为 $\\mathcal{C}_{i} = [x_{i-1/2}, x_{i+1/2}]$，网格中心为 $x_{i}$，间距为 $\\Delta x$。有限体积 (FV) 近似通过依赖于界面处重构的左右状态的单元间通量来演化单元平均值 $\\bar{u}_{i}(t)$。假设单元平均值为分片常数，且在界面 $x_{1/2}$ 处存在一个精确对齐的跳跃：\n$$\n\\bar{u}_{i} = \\begin{cases}\n1.8,  & i \\leq 0, \\\\\n-0.6, & i \\geq 1.\n\\end{cases}\n$$\n使用标准的五阶加权本质无振荡 (WENO) 有限体积重构方法，该方法在均匀网格上采用 Jiang–Shu 光滑度指示子和线性权重。在间断界面 $x_{1/2}$ 处，从左侧单元重构左状态 $u_{1/2}^{-}$，从右侧单元重构右状态 $u_{1/2}^{+}$。取非线性参数 $\\epsilon = 1.0 \\times 10^{-6}$。从单元平均值的有限体积重构定义以及基于光滑度指示子的非线性凸组合权重概念出发，确定这两个重构的界面状态，并提供一个基于这些原理的简要推导，以解释为什么 WENO 有限体积格式能在这个对齐的跳跃处保持无振荡行为，并在有限体积更新中保持守恒性。请用精确值（无四舍五入）表示最终答案，并使用指定格式将其写成一个包含两个元素的行。",
            "solution": "问题陈述经评估有效。它提出了一个计算流体力学领域内适定的、有科学依据的问题，特别是关于加权本质无振荡 (WENO) 格式的行为。所有求解唯一解所需的数据和参数都已提供。\n\n问题要求求解在使用五阶有限体积 (FV) WENO 格式求解标量守恒律时，界面 $x_{1/2}$ 左侧 ($u_{1/2}^{-}$) 和右侧 ($u_{1/2}^{+}$) 的重构状态。初始条件由分片常数的单元平均值构成：\n$$\n\\bar{u}_{i} = \\begin{cases}\n1.8,  & i \\leq 0, \\\\\n-0.6, & i \\geq 1.\n\\end{cases}\n$$\n间断点与单元界面 $x_{1/2}$ 完全对齐。\n\n**1. 左状态 $u_{1/2}^{-}$ 的重构**\n\n左重构状态 $u_{1/2}^{-}$ 是使用界面 $x_{1/2}$ 左偏的模板计算的。对于五阶方法，这涉及以单元 $\\mathcal{C}_0$ 为中心的三个 3-单元候选模板的组合。相关的单元平均值为 $\\bar{u}_{-2} = 1.8$，$\\bar{u}_{-1} = 1.8$，$\\bar{u}_0 = 1.8$，$\\bar{u}_1 = -0.6$ 和 $\\bar{u}_2 = -0.6$。\n\n在界面 $x_{i+1/2}$（本例中 $i=0$）处重构的三个候选模板 $S_k$ 是：\n- $S_0 = \\{ \\mathcal{C}_{-2}, \\mathcal{C}_{-1}, \\mathcal{C}_{0} \\}$，其平均值为 $\\{1.8, 1.8, 1.8\\}$。\n- $S_1 = \\{ \\mathcal{C}_{-1}, \\mathcal{C}_{0}, \\mathcal{C}_{1} \\}$，其平均值为 $\\{1.8, 1.8, -0.6\\}$。\n- $S_2 = \\{ \\mathcal{C}_{0}, \\mathcal{C}_{1}, \\mathcal{C}_{2} \\}$，其平均值为 $\\{1.8, -0.6, -0.6\\}$。\n\n每个模板 $S_k$ 在界面处产生一个三阶候选重构值 $u_{1/2}^{(k)}$：\n- $u_{1/2}^{(0)} = \\frac{1}{3}\\bar{u}_{-2} - \\frac{7}{6}\\bar{u}_{-1} + \\frac{11}{6}\\bar{u}_0 = (\\frac{2}{6} - \\frac{7}{6} + \\frac{11}{6}) \\times 1.8 = \\frac{6}{6} \\times 1.8 = 1.8$。\n- $u_{1/2}^{(1)} = -\\frac{1}{6}\\bar{u}_{-1} + \\frac{5}{6}\\bar{u}_0 + \\frac{1}{3}\\bar{u}_1 = -\\frac{1}{6}(1.8) + \\frac{5}{6}(1.8) + \\frac{1}{3}(-0.6) = \\frac{4}{6}(1.8) - 0.2 = 1.2 - 0.2 = 1.0$。\n- $u_{1/2}^{(2)} = \\frac{1}{3}\\bar{u}_0 + \\frac{5}{6}\\bar{u}_1 - \\frac{1}{6}\\bar{u}_2 = \\frac{1}{3}(1.8) + \\frac{5}{6}(-0.6) - \\frac{1}{6}(-0.6) = 0.6 - 0.5 + 0.1 = 0.2$。\n\n接下来，我们为每个模板计算 Jiang-Shu 光滑度指示子 $\\beta_k$：\n- 模板 $S_0$ 包含常数数据，因此其导数为零。所以 $\\beta_0 = 0$。\n- 对于 $S_1$：$\\beta_1 = \\frac{13}{12}(\\bar{u}_{-1} - 2\\bar{u}_0 + \\bar{u}_1)^2 + \\frac{1}{4}(\\bar{u}_{-1} - \\bar{u}_1)^2 = \\frac{13}{12}(1.8 - 2(1.8) - 0.6)^2 + \\frac{1}{4}(1.8 - (-0.6))^2 = \\frac{13}{12}(-2.4)^2 + \\frac{1}{4}(2.4)^2 = (\\frac{13}{12} + \\frac{3}{12})(5.76) = \\frac{4}{3}(5.76) = 7.68$。\n- 对于 $S_2$：$\\beta_2 = \\frac{13}{12}(\\bar{u}_0 - 2\\bar{u}_1 + \\bar{u}_2)^2 + \\frac{1}{4}(3\\bar{u}_0 - 4\\bar{u}_1 + \\bar{u}_2)^2 = \\frac{13}{12}(1.8 - 2(-0.6) - 0.6)^2 + \\frac{1}{4}(3(1.8) - 4(-0.6) - 0.6)^2 = \\frac{13}{12}(2.4)^2 + \\frac{1}{4}(7.2)^2 = 6.24 + 12.96 = 19.2$。\n\n非线性权重 $\\omega_k$ 由 $\\omega_k = \\alpha_k / \\sum_j \\alpha_j$ 给出，其中 $\\alpha_k = \\gamma_k / (\\epsilon + \\beta_k)^2$。对于左偏重构，理想线性权重为 $\\gamma_0=0.1$, $\\gamma_1=0.6$, $\\gamma_2=0.3$。参数 $\\epsilon = 1.0 \\times 10^{-6}$ 是一个为避免除以零而设的小数。\n- $\\alpha_0 = \\frac{0.1}{(\\epsilon + 0)^2} = \\frac{0.1}{\\epsilon^2} = 0.1 \\times 10^{12}$。\n- $\\alpha_1 = \\frac{0.6}{(\\epsilon + 7.68)^2} \\approx \\frac{0.6}{7.68^2} \\approx 0.0102$。\n- $\\alpha_2 = \\frac{0.3}{(\\epsilon + 19.2)^2} \\approx \\frac{0.3}{19.2^2} \\approx 0.0008$。\n\n$\\alpha_0$ 的值比 $\\alpha_1$ 和 $\\alpha_2$ 大几个数量级。因此，非线性权重 $\\omega_0 = \\alpha_0 / (\\alpha_0 + \\alpha_1 + \\alpha_2)$ 趋近于 $1$，而 $\\omega_1$ 和 $\\omega_2$ 趋近于 $0$。\n最终的重构状态是候选值的凸组合：\n$u_{1/2}^{-} = \\omega_0 u_{1/2}^{(0)} + \\omega_1 u_{1/2}^{(1)} + \\omega_2 u_{1/2}^{(2)} \\approx 1 \\times 1.8 + 0 \\times 1.0 + 0 \\times 0.2 = 1.8$。\n\n**2. 右状态 $u_{1/2}^{+}$ 的重构**\n\n右重构状态 $u_{1/2}^{+}$ 是使用界面右偏的模板计算的。这可以通过考虑 WENO 重构的对称性来分析。右重构 $u_{1/2}^{+}(\\{\\bar{u}_k\\})$ 等价于左重构 $u_{-1/2}^{-}(\\{\\bar{v}_k\\})$，其中数据是空间反射的，即 $\\bar{v}_k = \\bar{u}_{-k}$。\n反射后的数据为：\n$$\n\\bar{v}_{k} = \\begin{cases}\n-0.6,  & k \\leq -1, \\\\\n1.8,  & k \\geq 0.\n\\end{cases}\n$$\n我们为这个新数据 $\\{\\bar{v}_k\\}$ 计算左重构状态 $u_{-1/2}^{-}$。这需要以单元 $\\mathcal{C}_{-1}$ 为中心的模板。\n- $S_0 = \\{ \\mathcal{C}_{-3}, \\mathcal{C}_{-2}, \\mathcal{C}_{-1} \\}$，其平均值为 $\\{-0.6, -0.6, -0.6\\}$。\n- $S_1 = \\{ \\mathcal{C}_{-2}, \\mathcal{C}_{-1}, \\mathcal{C}_{0} \\}$，其平均值为 $\\{-0.6, -0.6, 1.8\\}$。\n- $S_2 = \\{ \\mathcal{C}_{-1}, \\mathcal{C}_{0}, \\mathcal{C}_{1} \\}$，其平均值为 $\\{-0.6, 1.8, 1.8\\}$。\n\n在 $x_{-1/2}$ 处（对于 $i=-1$）的候选值为：\n- $v_{-1/2}^{(0)} = \\frac{1}{3}\\bar{v}_{-3} - \\frac{7}{6}\\bar{v}_{-2} + \\frac{11}{6}\\bar{v}_{-1} = (\\frac{2-7+11}{6})(-0.6) = -0.6$。\n由于数据是常数，该模板的光滑度指示子为 $\\beta_0=0$。\n另外两个模板 $S_1$ 和 $S_2$ 跨越了间断，因此它们的光滑度指示子 $\\beta_1$ 和 $\\beta_2$ 会很大。按照与 $u_{1/2}^{-}$ 相同的逻辑，非线性权重 $\\omega_0$ 将趋近于 $1$，格式将选择来自最光滑模板的值。\n因此，$u_{-1/2}^{-}(\\{\\bar{v}_k\\}) \\approx v_{-1/2}^{(0)} = -0.6$。\n根据对称性，原始问题的右重构状态为 $u_{1/2}^{+} = -0.6$。\n\n**3. 无振荡行为与守恒性**\n\nWENO 格式之所以是无振荡的，正是因为上述的非线性加权机制。光滑度指示子 $\\beta_k$ 充当了间断的检测器。当一个模板跨越激波时，其 $\\beta_k$ 值会变得很大，从而急剧减小其在最终重构中的相应权重 $\\omega_k$。该格式自适应地将大部分权重分配给最光滑的候选模板，这实际上意味着它避免了在跳跃处进行高阶多项式插值。这防止了吉布斯现象，并保持了尖锐、无振荡的剖面。在本例中，格式退化为仅基于间断点左侧（对于 $u_{1/2}^{-}$）或右侧（对于 $u_{1/2}^{+}$）的光滑数据进行的重构。\n\n守恒性是有限体积列式本身的一个基本属性，而不是重构步骤的属性。有限体积格式通过通量差分公式来更新离散的单元平均值 $\\bar{u}_i$：\n$$\n\\frac{d \\bar{u}_i}{dt} + \\frac{1}{\\Delta x} (F_{i+1/2} - F_{i-1/2}) = 0\n$$\n在这里，$F_{i+1/2}$ 是界面上的数值通量，它是重构状态 $u_{i+1/2}^{-}$ 和 $u_{i+1/2}^{+}$ 的函数。WENO 重构是获得这些状态的一种方法。当更新方程在整个计算域上求和时，通量项形成一个伸缩级数：$\\sum_i (F_{i+1/2} - F_{i-1/2})$。对于具有周期性或透射边界条件的区域，该和抵消为零，从而确保总质量 $\\sum_i \\bar{u}_i \\Delta x$ 随时间守恒。WENO 过程决定了格式的精度和稳定性，但不会改变其固有的守恒性。\n\n因此，最终的重构状态就是跳跃处光滑侧的精确值。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1.8 & -0.6\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "尽管WENO格式是为处理激波而设计的，但它们在光滑区域的性能同样至关重要，因为它们必须恢复高阶精度才能保证计算效率。这个计算练习要求您实现WENO-5格式，并对一个光滑函数进行标准的收敛阶分析，这是数值程序验证中的一项关键技能。通过测试不同的小参数 $\\epsilon$ 取值策略，您还将探索它在平衡稳定性与在远离间断处实现格式最优精度方面的微妙而重要的作用 。",
            "id": "3391768",
            "problem": "考虑在一维均匀周期性网格上通过有限体积法离散化的标量守恒律。本题旨在研究加权基本无振荡 (WENO, Weighted Essentially Non-Oscillatory) 重构的 Jiang–Shu 公式中，其非线性权系数里的小正参数对光滑目标函数计算精度的影响。您将需要实现使用 Jiang–Shu (JS) 非线性权系数的五阶加权基本无振荡 (WENO) 格式，在权系数定义中采用幂次 $p=2$，并比较三种不同的小参数策略下的误差和观测收敛阶。\n\n基本设置与核心定义：\n- 在周期性定义域 $[0,1]$ 上进行计算。\n- 使用包含 $N$ 个控制体的均匀网格，网格间距为 $\\Delta x = 1/N$。单元中心位于 $x_i = \\left(i+\\tfrac{1}{2}\\right)\\Delta x$（其中 $i=0,\\dots,N-1$），单元界面位于 $x_{i+\\frac{1}{2}} = (i+1)\\Delta x$。\n- 设光滑测试函数为 $\\phi(x) = \\sin(2\\pi x)$，其中参数以弧度为单位。\n- 设 $\\bar{\\phi}_i$ 表示函数 $\\phi$ 在单元 $i$ 上的精确单元平均值，即 $\\bar{\\phi}_i = \\frac{1}{\\Delta x}\\int_{x_{i-\\frac{1}{2}}}^{x_{i+\\frac{1}{2}}}\\phi(x)\\,dx$。为保证数值计算的公平性并避免求积效应，请通过解析计算积分定义来获得 $\\bar{\\phi}_i$（即，不要对积分进行数值近似）。\n- 在每个界面 $x_{i+\\frac{1}{2}}$ 处，使用包含 Jiang–Shu 非线性权系数（幂次 $p=2$）的五阶 WENO 重构方法，从单元平均值集合 $\\{\\bar{\\phi}_{i-2},\\bar{\\phi}_{i-1},\\bar{\\phi}_{i},\\bar{\\phi}_{i+1},\\bar{\\phi}_{i+2}\\}$ 中重构左偏界面值。当索引超出范围时，应用周期性边界条件。\n- 将界面上的误差定义为重构的左偏值与精确点值 $\\phi(x_{i+\\frac{1}{2}})$ 之间的差。将全局误差度量定义为 $\\ell^1$ 范数\n$$\nE_1(N) = \\Delta x \\sum_{i=0}^{N-1} \\left| \\phi^{-}_{i+\\frac{1}{2}} - \\phi(x_{i+\\frac{1}{2}}) \\right|.\n$$\n- 对于两次连续的网格加密（网格数分别为 $N$ 和 $2N$），将观测到的精度阶定义为\n$$\nr(N \\to 2N) = \\frac{\\log\\left(E_1(N)/E_1(2N)\\right)}{\\log(2)}.\n$$\n\nJiang–Shu 非线性权系数的小参数策略：\n- 策略 A：常数 $\\epsilon = 10^{-6}$。\n- 策略 B：常数 $\\epsilon = 10^{-12}$。\n- 策略 C：依赖于网格的 $\\epsilon = c\\,\\Delta x^2$，其中 $c=1$。\n\n任务：\n1. 实现使用 Jiang–Shu 非线性权系数（幂次 $p=2$）的五阶 WENO 重构。您的实现必须基于有限体积框架：利用定义在三个相邻三点模板上的三个二次候选多项式，并使用 Jiang–Shu 光滑度指示子来形成非线性凸组合权系数，然后使用这些权系数组合候选多项式，从而从单元平均值重构出左偏界面值。\n2. 使用通过对 $\\phi(x)$ 在每个单元上进行解析积分得到的精确单元平均值 $\\bar{\\phi}_i$。\n3. 对于策略 A、B、C 中的每一种 $\\epsilon$ 策略，以及网格尺寸集合 $\\{40,80,160,320\\}$ 中的每一个 $N$，计算 $E_1(N)$。\n4. 对于每种 $\\epsilon$ 策略，根据相应的 $E_1(N)$ 值计算观测到的精度阶 $r(40\\to 80)$、 $r(80\\to 160)$ 和 $r(160\\to 320)$。\n\n测试套件与覆盖范围：\n- 使用四种网格尺寸 $N \\in \\{40,80,160,320\\}$，以覆盖渐近前和渐近状态。\n- 使用上述所有三种小参数策略 A、B 和 C，这些策略用于测试对两种不同尺度的常数 $\\epsilon$ 以及对随 $\\Delta x^2$ 变化的 $\\epsilon$ 的敏感性。\n- 所有三角函数求值时，角度必须以弧度为单位。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表，结果按以下顺序排列：\n  - 首先，对于策略 A ($\\epsilon=10^{-6}$)：$E_1(40)$、$E_1(80)$、$E_1(160)$、$E_1(320)$、$r(40\\to 80)$、$r(80\\to 160)$、$r(160\\to 320)$。\n  - 其次，对于策略 B ($\\epsilon=10^{-12}$)：$E_1(40)$、$E_1(80)$、$E_1(160)$、$E_1(320)$、$r(40\\to 80)$、$r(80\\to 160)$、$r(160\\to 320)$。\n  - 再次，对于策略 C ($\\epsilon=c\\,\\Delta x^2$，其中 $c=1$)：$E_1(40)$、$E_1(80)$、$E_1(160)$、$E_1(320)$、$r(40\\to 80)$、$r(80\\to 160)$、$r(160\\to 320)$。\n- 所有条目必须是浮点数。该行必须在一对方括号内包含恰好 $3\\times(4+3)=21$ 个逗号分隔的数字，不得包含任何其他文本。",
            "solution": "经过严格的验证过程，用户提供的问题被评估为**有效**。该问题在科学上基于已建立的加权基本无振荡 (WENO) 格式理论，其定义完整、一致，问题本身是适定的且完全客观。任务是实现带有 Jiang-Shu (JS) 权系数的五阶 WENO 格式，以研究小参数 $\\epsilon$ 对光滑函数数值精度的影响。\n\n该解决方案基于有限体积 WENO 方法的原理进行开发。\n\n**1. 离散化与单元平均值**\n\n问题定义在一个一维周期性定义域 $[0,1]$ 上，使用包含 $N$ 个单元的均匀网格。单元宽度为 $\\Delta x = 1/N$。单元中心位于 $x_i = (i+\\frac{1}{2})\\Delta x$（其中 $i=0, \\dots, N-1$），而界面位于 $x_{i+\\frac{1}{2}} = (i+1)\\Delta x$。\n\n有限体积法的核心是使用单元平均值。测试函数为 $\\phi(x) = \\sin(2\\pi x)$。其在单元 $i$ 上的精确单元平均值（记为 $\\bar{\\phi}_i$）通过解析计算得出，以避免在分析中引入数值积分误差。\n$$\n\\bar{\\phi}_i = \\frac{1}{\\Delta x}\\int_{x_{i-\\frac{1}{2}}}^{x_{i+\\frac{1}{2}}} \\phi(x)\\,dx = \\frac{1}{\\Delta x}\\int_{i\\Delta x}^{(i+1)\\Delta x} \\sin(2\\pi x)\\,dx\n$$\n计算该积分：\n$$\n\\bar{\\phi}_i = \\frac{1}{\\Delta x} \\left[ -\\frac{\\cos(2\\pi x)}{2\\pi} \\right]_{i\\Delta x}^{(i+1)\\Delta x} = -\\frac{1}{2\\pi\\Delta x} \\left( \\cos(2\\pi(i+1)\\Delta x) - \\cos(2\\pi i\\Delta x) \\right)\n$$\n使用三角恒等式 $\\cos(A) - \\cos(B) = -2\\sin\\left(\\frac{A+B}{2}\\right)\\sin\\left(\\frac{A-B}{2}\\right)$，上式可简化为：\n$$\n\\bar{\\phi}_i = \\frac{\\sin(\\pi\\Delta x)}{\\pi\\Delta x} \\sin(2\\pi x_i)\n$$\n该公式提供了重构所需的精确单元平均值。\n\n**2. 五阶 WENO-JS 重构**\n\n目标是从相邻单元的平均值重构函数在单元界面 $x_{i+\\frac{1}{2}}$ 处的值。具体来说，我们使用一个由单元平均值组成的 5 点模板：$\\{\\bar{\\phi}_{i-2}, \\bar{\\phi}_{i-1}, \\bar{\\phi}_{i}, \\bar{\\phi}_{i+1}, \\bar{\\phi}_{i+2}\\}$，来计算左偏值，记为 $\\phi^{-}_{i+1/2}$。\n\nWENO-5-JS 过程包括以下步骤：\n\n**a. 候选重构：** 将 5 点模板划分为三个重叠的 3 点子模板，每个子模板用于定义一个二次多项式。在界面 $x_{i+1/2}$ 处计算这些多项式的值，可得到三个候选重构值：\n\\begin{align*}\n\\hat{\\phi}^{(0)}_{i+\\frac{1}{2}} &= \\frac{2}{6}\\bar{\\phi}_{i-2} - \\frac{7}{6}\\bar{\\phi}_{i-1} + \\frac{11}{6}\\bar{\\phi}_{i} \\\\\n\\hat{\\phi}^{(1)}_{i+\\frac{1}{2}} &= -\\frac{1}{6}\\bar{\\phi}_{i-1} + \\frac{5}{6}\\bar{\\phi}_{i} + \\frac{2}{6}\\bar{\\phi}_{i+1} \\\\\n\\hat{\\phi}^{(2)}_{i+\\frac{1}{2}} &= \\frac{2}{6}\\bar{\\phi}_{i} + \\frac{5}{6}\\bar{\\phi}_{i+1} - \\frac{1}{6}\\bar{\\phi}_{i+2}\n\\end{align*}\n\n**b. 光滑度指示子：** 每个子模板上数据的光滑度通过一个光滑度指示子 $\\beta_k$ 来衡量。对于 WENO-5-JS 格式，它们是：\n\\begin{align*}\n\\beta_0 &= \\frac{13}{12}(\\bar{\\phi}_{i-2} - 2\\bar{\\phi}_{i-1} + \\bar{\\phi}_{i})^2 + \\frac{1}{4}(3\\bar{\\phi}_{i-2} - 4\\bar{\\phi}_{i-1} + \\bar{\\phi}_{i})^2 \\\\\n\\beta_1 &= \\frac{13}{12}(\\bar{\\phi}_{i-1} - 2\\bar{\\phi}_{i} + \\bar{\\phi}_{i+1})^2 + \\frac{1}{4}(\\bar{\\phi}_{i-1} - \\bar{\\phi}_{i+1})^2 \\\\\n\\beta_2 &= \\frac{13}{12}(\\bar{\\phi}_{i} - 2\\bar{\\phi}_{i+1} + \\bar{\\phi}_{i+2})^2 + \\frac{1}{4}(3\\bar{\\phi}_{i} - 4\\bar{\\phi}_{i+1} + \\bar{\\phi}_{i+2})^2\n\\end{align*}\n注意：一些文献在右偏重构的定义中，会将 $\\beta_0$ 和 $\\beta_2$ 的系数互换。以上形式对于计算左偏值 $\\phi^{-}_{i+1/2}$ 是正确的。\n\n**c. 非线性权系数：** 最终的重构值是候选重构值的凸组合。这些权系数非线性地依赖于光滑度指示子。首先，定义理想（或线性）权系数，对于光滑函数，它们可以产生最优的 5 阶精度：\n$$\nd_0 = \\frac{1}{10}, \\quad d_1 = \\frac{6}{10}, \\quad d_2 = \\frac{3}{10}\n$$\n未归一化的非线性权系数 $\\alpha_k$ 计算如下：\n$$\n\\alpha_k = \\frac{d_k}{(\\epsilon + \\beta_k)^p}, \\quad k=0,1,2\n$$\n题目指定幂次 $p=2$。参数 $\\epsilon$ 是一个小正数，用于在模板完全光滑（$\\beta_k=0$）时防止除以零。$\\epsilon$ 的选择是本研究的主题。\n\n最终的非线性权系数 $\\omega_k$ 通过对 $\\alpha_k$ 进行归一化得到：\n$$\n\\omega_k = \\frac{\\alpha_k}{\\alpha_0 + \\alpha_1 + \\alpha_2}\n$$\n\n**d. 最终重构值：** 左偏界面值是候选值的加权平均：\n$$\n\\phi^{-}_{i+1/2} = \\omega_0 \\hat{\\phi}^{(0)}_{i+\\frac{1}{2}} + \\omega_1 \\hat{\\phi}^{(1)}_{i+\\frac{1}{2}} + \\omega_2 \\hat{\\phi}^{(2)}_{i+\\frac{1}{2}}\n$$\n\n**3. 误差与收敛阶计算**\n\n重构的精度通过重构界面值与精确点值 $\\phi(x_{i+\\frac{1}{2}})$ 之间误差的 $\\ell^1$ 范数来衡量。\n$$\nE_1(N) = \\Delta x \\sum_{i=0}^{N-1} \\left| \\phi^{-}_{i+\\frac{1}{2}} - \\phi(x_{i+\\frac{1}{2}}) \\right|\n$$\n观测到的精度阶 $r$ 是根据在两个连续加密的网格（分别为 $N$ 和 $2N$）上计算出的误差得到的：\n$$\nr(N \\to 2N) = \\frac{\\log\\left(E_1(N)/E_1(2N)\\right)}{\\log(2)}\n$$\n\n**4. Epsilon 策略与实现**\n\n该分析针对三种不同的 $\\epsilon$ 选择策略进行：\n- 策略 A：一个常数 $\\epsilon = 10^{-6}$。\n- 策略 B：一个更小的常数 $\\epsilon = 10^{-12}$。\n- 策略 C：一个依赖于网格的 $\\epsilon = c\\,\\Delta x^2$，其中 $c=1$。\n\n实现过程使用 Python 语言及其 `numpy` 库，以进行高效的向量化计算。周期性边界条件通过使用 `np.roll` 创建单元平均值数组的移位版本来处理，从而可以同时计算所有界面值。对每个网格尺寸 $N \\in \\{40, 80, 160, 320\\}$ 和每种 $\\epsilon$ 策略重复此过程。最后，计算并按规定格式报告误差和收敛阶。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements the 5th-order WENO-JS reconstruction to study the influence\n    of the epsilon parameter on accuracy for a smooth function.\n    \"\"\"\n    # Define mesh sizes and epsilon strategies\n    N_vals = [40, 80, 160, 320]\n    strategies = {\n        'A': lambda dx: 1e-6,\n        'B': lambda dx: 1e-12,\n        'C': lambda dx: dx**2,\n    }\n    \n    # WENO-5-JS constants\n    d0, d1, d2 = 0.1, 0.6, 0.3\n    p = 2.0\n\n    all_results = []\n\n    # Iterate over the three specified strategies for epsilon\n    for strategy_name in ['A', 'B', 'C']:\n        epsilon_func = strategies[strategy_name]\n        errors = []\n        \n        # Iterate over the specified mesh resolutions\n        for N in N_vals:\n            dx = 1.0 / N\n            epsilon = epsilon_func(dx)\n\n            # Grid setup\n            # Cell centers x_i = (i + 0.5)*dx\n            x_i = (np.arange(N, dtype=float) + 0.5) * dx\n            # Cell interfaces x_{i+1/2} = (i + 1)*dx\n            x_iph = (np.arange(N, dtype=float) + 1.0) * dx\n\n            # Exact values\n            # Pointwise value of phi(x) = sin(2*pi*x) at interfaces\n            phi_exact_interface = np.sin(2.0 * np.pi * x_iph)\n\n            # Analytical cell averages of phi(x)\n            # The formula is (sin(pi*dx)/(pi*dx)) * sin(2*pi*x_i)\n            sinc_val = np.sin(np.pi * dx) / (np.pi * dx)\n            phi_bar = sinc_val * np.sin(2.0 * np.pi * x_i)\n\n            # Vectorized WENO-5 reconstruction\n            # The stencil for interface i+1/2 uses phi_bar at indices\n            # {i-2, i-1, i, i+1, i+2}. We use np.roll for periodic boundaries.\n            v_m2 = np.roll(phi_bar, 2)\n            v_m1 = np.roll(phi_bar, 1)\n            v_0 = phi_bar\n            v_p1 = np.roll(phi_bar, -1)\n            v_p2 = np.roll(phi_bar, -2)\n\n            # Smoothness indicators (beta_k)\n            beta0 = (13.0/12.0) * (v_m2 - 2.0*v_m1 + v_0)**2 + (1.0/4.0) * (v_m2 - 4.0*v_m1 + 3.0*v_0)**2\n            beta1 = (13.0/12.0) * (v_m1 - 2.0*v_0 + v_p1)**2 + (1.0/4.0) * (v_m1 - v_p1)**2\n            beta2 = (13.0/12.0) * (v_0 - 2.0*v_p1 + v_p2)**2 + (1.0/4.0) * (3.0*v_0 - 4.0*v_p1 + v_p2)**2\n\n            # Nonlinear weights (omega_k)\n            alpha0 = d0 / (epsilon + beta0)**p\n            alpha1 = d1 / (epsilon + beta1)**p\n            alpha2 = d2 / (epsilon + beta2)**p\n            alpha_sum = alpha0 + alpha1 + alpha2\n\n            w0 = alpha0 / alpha_sum\n            w1 = alpha1 / alpha_sum\n            w2 = alpha2 / alpha_sum\n\n            # Candidate reconstructions (phi_hat_k)\n            phi_hat0 = (2.0/6.0)*v_m2 - (7.0/6.0)*v_m1 + (11.0/6.0)*v_0\n            phi_hat1 = (-1.0/6.0)*v_m1 + (5.0/6.0)*v_0 + (2.0/6.0)*v_p1\n            phi_hat2 = (2.0/6.0)*v_0 + (5.0/6.0)*v_p1 - (1.0/6.0)*v_p2\n\n            # Reconstructed values at interfaces (phi_minus_{i+1/2})\n            phi_recon = w0 * phi_hat0 + w1 * phi_hat1 + w2 * phi_hat2\n\n            # L1 Error\n            l1_error = dx * np.sum(np.abs(phi_recon - phi_exact_interface))\n            errors.append(l1_error)\n\n        # Observed order of accuracy\n        rates = []\n        for i in range(len(N_vals) - 1):\n            # rate = log(E1(N)/E1(2N)) / log(2)\n            rate = np.log(errors[i] / errors[i+1]) / np.log(2.0)\n            rates.append(rate)\n        \n        all_results.extend(errors)\n        all_results.extend(rates)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```"
        }
    ]
}