{
    "hands_on_practices": [
        {
            "introduction": "掌握紧致格式的第一步是理解它们是如何被构建的。本练习将引导你使用泰勒级数展开来推导一个针对二阶导数的四阶精度紧致格式的系数。这个过程，也被称为待定系数法或矩匹配法，是设计数值格式的一项基本技能，它揭示了高精度与隐式耦合之间的内在联系。",
            "id": "3302438",
            "problem": "考虑一个在均匀网格 $x_i = x_0 + i \\,\\Delta x$（间距 $\\Delta x > 0$）上采样得到的光滑函数 $u(x)$。在计算流体动力学（CFD）的空间离散化背景下，一种紧致有限差分格式通过隐式地耦合相邻点的导数值来近似导数。请你推导一个关于网格点 $i$ 处二阶导数 $u_{xx}$ 的四阶精确紧致关系式，其形式为\n$$\n\\alpha \\, u''_{i-1} + u''_{i} + \\alpha \\, u''_{i+1}\n=\na \\,\\frac{u_{i+1} - 2 u_i + u_{i-1}}{\\Delta x^2}\n+\nb \\,\\frac{u_{i+2} - 2 u_i + u_{i-2}}{4\\,\\Delta x^2},\n$$\n其中 $u_i \\equiv u(x_i)$ 和 $u''_i \\equiv u_{xx}(x_i)$，并且 $\\alpha$、$a$、$b$ 是与 $i$ 和 $\\Delta x$ 无关的实常数。从在 $x_i$ 处的泰勒级数展开和相容性定义出发，确定 $\\alpha$、$a$ 和 $b$ 的值，使得当 $\\Delta x \\to 0$ 时，截断误差为 $\\mathcal{O}(\\Delta x^4)$。在所有满足四阶精度的系数三元组 $(\\alpha,a,b)$ 中，施加一个额外的设计选择，即通过取 $b=0$ 使右侧模板尽可能窄。你的最终答案必须是精确表示为有理数的有序三元组 $(\\alpha, a, b)$。不需要四舍五入，也不需要单位。",
            "solution": "该问题要求推导用于二阶导数 $u_{xx}$ 的紧致有限差分格式的系数 $\\alpha$、$a$ 和 $b$，其关系式如下：\n$$\n\\alpha \\, u''_{i-1} + u''_{i} + \\alpha \\, u''_{i+1}\n=\na \\,\\frac{u_{i+1} - 2 u_i + u_{i-1}}{\\Delta x^2}\n+\nb \\,\\frac{u_{i+2} - 2 u_i + u_{i-2}}{4\\,\\Delta x^2}\n$$\n该格式必须具有 $\\mathcal{O}(\\Delta x^4)$ 的截断误差，并且我们需要选择 $b=0$ 的特定格式。推导过程是通过对每一项在网格点 $x_i$ 处进行泰勒级数展开。为方便起见，我们令 $h = \\Delta x$，并使用记号 $u^{(n)}$ 来表示 $u(x)$ 在 $x_i$ 处求得的 $n$ 阶导数。\n\n函数值 $u_{i \\pm k}$ 的泰勒级数展开为：\n$$ u_{i \\pm k} = u(x_i \\pm k h) = u_i \\pm (kh) u^{(1)} + \\frac{(kh)^2}{2!} u^{(2)} \\pm \\frac{(kh)^3}{3!} u^{(3)} + \\frac{(kh)^4}{4!} u^{(4)} \\pm \\frac{(kh)^5}{5!} u^{(5)} + \\frac{(kh)^6}{6!} u^{(6)} + \\mathcal{O}(h^7) $$\n二阶导数值 $u''_{i \\pm 1}$ 的泰勒级数展开为：\n$$ u''_{i \\pm 1} = u^{(2)}(x_i \\pm h) = u^{(2)} \\pm h u^{(3)} + \\frac{h^2}{2!} u^{(4)} \\pm \\frac{h^3}{3!} u^{(5)} + \\frac{h^4}{4!} u^{(6)} \\pm \\frac{h^5}{5!} u^{(7)} + \\mathcal{O}(h^6) $$\n\n首先，我们展开给定关系式的左侧（LHS）：\n$$ \\text{LHS} = \\alpha (u''_{i-1} + u''_{i+1}) + u''_i $$\n使用 $u''_{i \\pm 1}$ 的展开式：\n$$ u''_{i-1} + u''_{i+1} = \\left(u^{(2)} - h u^{(3)} + \\frac{h^2}{2} u^{(4)} - \\frac{h^3}{6} u^{(5)} + \\frac{h^4}{24} u^{(6)}\\right) + \\left(u^{(2)} + h u^{(3)} + \\frac{h^2}{2} u^{(4)} + \\frac{h^3}{6} u^{(5)} + \\frac{h^4}{24} u^{(6)}\\right) + \\mathcal{O}(h^6) $$\n$$ u''_{i-1} + u''_{i+1} = 2u^{(2)} + h^2 u^{(4)} + \\frac{h^4}{12} u^{(6)} + \\mathcal{O}(h^6) $$\n将此代回 LHS 表达式中：\n$$ \\text{LHS} = \\alpha \\left(2u^{(2)} + h^2 u^{(4)} + \\frac{h^4}{12} u^{(6)} \\right) + u^{(2)} + \\mathcal{O}(h^6) $$\n$$ \\text{LHS} = (1 + 2\\alpha) u^{(2)} + \\alpha h^2 u^{(4)} + \\frac{\\alpha h^4}{12} u^{(6)} + \\mathcal{O}(h^6) $$\n\n接下来，我们展开关系式的右侧（RHS）。我们分别分析两个有限差分项。\n对于第一项，涉及点 $i-1, i, i+1$：\n$$ u_{i+1} - 2u_i + u_{i-1} = \\left(u_i + h u^{(1)} + \\frac{h^2}{2} u^{(2)} + \\frac{h^3}{6} u^{(3)} + \\dots\\right) - 2u_i + \\left(u_i - h u^{(1)} + \\frac{h^2}{2} u^{(2)} - \\frac{h^3}{6} u^{(3)} + \\dots\\right) $$\n通过合并 $h$ 的偶次幂项，我们得到：\n$$ u_{i+1} - 2u_i + u_{i-1} = h^2 u^{(2)} + \\frac{h^4}{12} u^{(4)} + \\frac{h^6}{360} u^{(6)} + \\mathcal{O}(h^8) $$\n所以 RHS 上的第一项是：\n$$ a \\frac{u_{i+1} - 2u_i + u_{i-1}}{h^2} = a \\left( u^{(2)} + \\frac{h^2}{12} u^{(4)} + \\frac{h^4}{360} u^{(6)} \\right) + \\mathcal{O}(h^6) $$\n对于第二项，涉及点 $i-2, i, i+2$，我们在上述中心差分公式中用 $2h$ 替换 $h$：\n$$ u_{i+2} - 2u_i + u_{i-2} = (2h)^2 u^{(2)} + \\frac{(2h)^4}{12} u^{(4)} + \\frac{(2h)^6}{360} u^{(6)} + \\mathcal{O}(h^8) $$\n$$ u_{i+2} - 2u_i + u_{i-2} = 4h^2 u^{(2)} + \\frac{4h^4}{3} u^{(4)} + \\frac{8h^6}{45} u^{(6)} + \\mathcal{O}(h^8) $$\n所以 RHS 上的第二项是：\n$$ b \\frac{u_{i+2} - 2u_i + u_{i-2}}{4h^2} = b \\left( u^{(2)} + \\frac{h^2}{3} u^{(4)} + \\frac{2h^4}{45} u^{(6)} \\right) + \\mathcal{O}(h^6) $$\n合并这两项以构成完整的 RHS：\n$$ \\text{RHS} = (a+b) u^{(2)} + \\left(\\frac{a}{12} + \\frac{b}{3}\\right) h^2 u^{(4)} + \\left(\\frac{a}{360} + \\frac{2b}{45}\\right) h^4 u^{(6)} + \\mathcal{O}(h^6) $$\n\n对于一个四阶精确的格式，LHS 和 RHS 的泰勒级数展开式必须在直到并包括 $u^{(4)}$ 的项上都匹配。这意味着定义为 $\\text{LHS} - \\text{RHS}$ 的截断误差必须是 $\\mathcal{O}(h^4)$。通过令 LHS 和 RHS 上相应导数项的系数相等，我们得到一个关于系数 $\\alpha$、$a$ 和 $b$ 的线性方程组。\n\n匹配 $u^{(2)}$ 的系数：\n$$ 1 + 2\\alpha = a + b \\quad (1) $$\n这个条件确保了格式对于二阶导数是相容的。\n\n匹配 $h^2 u^{(4)}$ 的系数：\n$$ \\alpha = \\frac{a}{12} + \\frac{b}{3} \\quad (2) $$\n满足此条件消除了 $\\mathcal{O}(h^2)$ 误差项，将格式的精度提升至至少四阶。\n\n问题施加了设计选择，即 RHS 模板需尽可能窄，这通过设置 $b=0$ 实现。将 $b=0$ 代入方程 $(1)$ 和 $(2)$：\n$$ 1 + 2\\alpha = a \\quad (1') $$\n$$ \\alpha = \\frac{a}{12} \\quad (2') $$\n这是一个关于两个未知数 $\\alpha$ 和 $a$ 的二元方程组。我们可以通过将 $(1')$ 中的 $a$ 的表达式代入 $(2')$ 来解这个方程组：\n$$ \\alpha = \\frac{1 + 2\\alpha}{12} $$\n两边乘以 12：\n$$ 12\\alpha = 1 + 2\\alpha $$\n$$ 10\\alpha = 1 $$\n$$ \\alpha = \\frac{1}{10} $$\n现在我们使用方程 $(1')$ 求 $a$：\n$$ a = 1 + 2\\alpha = 1 + 2\\left(\\frac{1}{10}\\right) = 1 + \\frac{1}{5} = \\frac{6}{5} $$\n因此，系数为 $\\alpha = \\frac{1}{10}$、$a = \\frac{6}{5}$ 和 $b=0$。\n\n为了验证精度阶，我们检查主误差项，即截断误差 $\\text{LHS} - \\text{RHS}$ 中 $h^4 u^{(6)}$ 的系数：\n$$ C = \\left(\\frac{\\alpha}{12}\\right) - \\left(\\frac{a}{360} + \\frac{2b}{45}\\right) $$\n代入推导出的系数值：\n$$ C = \\frac{1/10}{12} - \\left(\\frac{6/5}{360} + 0\\right) = \\frac{1}{120} - \\frac{6}{1800} = \\frac{1}{120} - \\frac{1}{300} $$\n$$ C = \\frac{5}{600} - \\frac{2}{600} = \\frac{3}{600} = \\frac{1}{200} $$\n由于该系数非零，截断误差的主项是 $\\frac{1}{200} u^{(6)} \\Delta x^4$，因此该格式确实是四阶精确的，即截断误差为 $\\mathcal{O}(\\Delta x^4)$。\n\n最终的有序三元组 $(\\alpha, a, b)$ 是 $(\\frac{1}{10}, \\frac{6}{5}, 0)$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{10} & \\frac{6}{5} & 0\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在学会如何构建一个特定阶数的格式之后，一个自然的问题是：对于给定的模板宽度，我们能否获得任意高的精度？本练习旨在探讨这一理论边界问题，分析可用系数的数量与可实现的最大精度阶数之间的关系。通过这个思辨练习，你将深入理解设计这些先进数值方法时所面临的基本代数约束。",
            "id": "3302468",
            "problem": "考虑一个光滑一维场 $u(x)$ 上的均匀网格，网格间距为 $h$，这在计算流体力学（CFD）中很常见。对于内部节点 $x_i$ 处的一阶导数，一族三对角紧致有限差分格式定义如下：其将左侧的三个未知导数值与右侧一个固定宽度的函数值模板耦合起来：\n$$\n\\alpha\\,u'_{i-1} + u'_i + \\alpha\\,u'_{i+1} \\;=\\; \\frac{1}{h}\\sum_{k=-R}^{R} \\beta_k\\,u_{i+k},\n$$\n其中 $R$ 是一个固定的正整数，$\\alpha$ 和 $\\{\\beta_k\\}_{k=-R}^{R}$ 是与 $i$ 和 $h$ 无关的常系数，而 $u'_i$ 表示精确导数 $u^{(1)}(x_i)$。假设是远离边界的内部点，$u(x)$ 是光滑的，并且这是一个用于一阶导数的中心格式，其右侧具有奇对称性（即 $\\beta_{-k}=-\\beta_k$ 且 $\\beta_0=0$），旨在避免虚假的偶数阶污染。\n\n根据局部截断误差的定义（即离散算子作用于光滑函数时与精确导数之间的差值），并使用关于 $x_i$ 的泰勒级数展开，\n$$\nu_{i+k} \\;=\\; \\sum_{m=0}^{\\infty} \\frac{u^{(m)}(x_i)}{m!}(kh)^m,\\quad\nu'_{i\\pm1} \\;=\\; \\sum_{m=0}^{\\infty} \\frac{u^{(m+1)}(x_i)}{m!}(\\pm h)^m,\n$$\n论证对于固定的右侧模板半宽 $R$，是否可以通过调整系数 $(\\alpha,\\{\\beta_k\\})$ 来使这种三对角紧致格式达到任意高的形式阶 $p$。请指出用 $R$ 表示的最大可实现阶数的限制性约束，并根据一阶导数近似的泰勒级数矩匹配要求、相容性和对称性来解释这些约束的来源。\n\n选择唯一的最佳选项：\n\nA. 对于任意固定的 $R$，仅通过优化 $\\alpha$ 即可实现任意高的形式阶 $p$；在均匀网格上，右侧的宽度不限制阶数。\n\nB. 对于固定的 $R$，无法实现任意高的阶数。最大形式阶满足 $p \\le 2R+2$。限制性约束源于使用有限数量的自由系数进行泰勒级数矩匹配、为消除 $h^{-1}$ 项而设的相容性条件 $\\sum_{k=-R}^{R}\\beta_k=0$、迫使偶数矩为零的奇对称性 $\\beta_{-k}=-\\beta_k$，以及要求一组有限的奇数矩 $\\mu_{2m+1}=\\sum_{k=-R}^{R}\\beta_k k^{2m+1}$ 匹配由三对角左侧决定的线性序列。\n\nC. 如果施加周期性边界条件，在固定的 $R$ 下可以实现任意高的阶数，因为离散傅里叶分析意味着指数级精度，且与模板宽度无关。\n\nD. 阶数仅受右侧系数数量的限制，为 $p \\le R+1$；左侧系数不参与三对角紧致格式的阶数条件。\n\nE. 实现任意高阶需要违反相容性；设置 $\\sum_{k=-R}^{R}\\beta_k\\neq 0$ 可以抵消主导误差，从而即使对于固定的 $R$ 也能实现无界阶数。",
            "solution": "用户要求对问题陈述进行严格验证，然后对所提供的选项进行完整推导和评估。\n\n### 第 1 步：提取已知条件\n\n-   **格式定义：** 一个三对角紧致有限差分格式由以下关系式给出：\n    $$\n    \\alpha\\,u'_{i-1} + u'_i + \\alpha\\,u'_{i+1} \\;=\\; \\frac{1}{h}\\sum_{k=-R}^{R} \\beta_k\\,u_{i+k}\n    $$\n-   **网格和场：** 该格式应用于均匀网格上的光滑一维场 $u(x)$，网格间距为 $h$。分析针对内部节点 $x_i$。\n-   **系数：** $\\alpha$ 和 $\\{\\beta_k\\}_{k=-R}^{R}$ 是常数。$R$ 是一个固定的正整数。\n-   **对称性：** 该格式是中心的，右侧具有奇对称性，意味着 $\\beta_{-k}=-\\beta_k$ 且 $\\beta_0=0$。\n-   **记号：** $u'_i$ 表示精确的一阶导数 $u^{(1)}(x_i)$。\n-   **泰勒级数：** 问题提供了 $u_{i+k}$ 和 $u'_{i\\pm1}$ 关于点 $x_i$ 的标准泰勒级数展开式。\n    $$\n    u_{i+k} \\;=\\; \\sum_{m=0}^{\\infty} \\frac{u^{(m)}(x_i)}{m!}(kh)^m\n    $$\n    $$\n    u'_{i\\pm1} \\;=\\; \\sum_{m=0}^{\\infty} \\frac{u^{(m+1)}(x_i)}{m!}(\\pm h)^m\n    $$\n-   **目标：** 确定对于固定的 $R$，是否可以通过调整系数达到任意高的形式阶 $p$。识别出限制性约束。\n\n### 第 2 步：使用提取的已知条件进行验证\n\n-   **科学依据：** 该问题牢固地植根于偏微分方程的标准数值分析中，特别是在有限差分格式的推导和分析方面。使用泰勒级数确定局部截断误差并由此确定精度阶是该领域的基石。所有术语和概念都是标准的。该问题在科学上是合理的。\n-   **适定性：** 该问题是适定的。它要求确定一个特定格式族作为模板宽度的函数所能达到的最大阶数，这是数值分析中的一个标准且可解的问题。所提供的信息足以推导出一个唯一的结论。\n-   **客观性：** 问题以精确、客观和数学化的语言陈述。没有主观或含糊的陈述。\n\n### 第 3 步：结论与行动\n\n问题陈述是有效的。这是一个数值分析中的标准、适定的问题。现在开始求解过程。\n\n### 推导\n\n形式精度阶是通过分析局部截断误差来确定的。局部截断误差是通过将精确解 $u(x)$ 代入有限差分公式，并将所有项在点 $x_i$ 周围展开成泰勒级数得到的。阶数 $p$ 是残差中 $h$ 的最低次幂。\n\n我们来展开给定格式的左侧（LHS）和右侧（RHS）。\n\n**左侧（LHS）展开：**\nLHS 是 $\\alpha\\,u'_{i-1} + u'_i + \\alpha\\,u'_{i+1}$。我们将 $u'_{i-1}$ 和 $u'_{i+1}$ 在 $x_i$ 周围展开。\n$$\nu'_{i-1} = u'_i - h u''_i + \\frac{h^2}{2!} u'''_i - \\frac{h^3}{3!} u^{(4)}_i + \\dots = \\sum_{m=0}^{\\infty} \\frac{u^{(m+1)}_i}{m!} (-h)^m\n$$\n$$\nu'_{i+1} = u'_i + h u''_i + \\frac{h^2}{2!} u'''_i + \\frac{h^3}{3!} u^{(4)}_i + \\dots = \\sum_{m=0}^{\\infty} \\frac{u^{(m+1)}_i}{m!} (h)^m\n$$\n将这些代入 LHS 表达式：\n$$\n\\text{LHS} = \\alpha \\left( \\sum_{m=0}^{\\infty} \\frac{u^{(m+1)}_i}{m!} (-h)^m \\right) + u'_i + \\alpha \\left( \\sum_{m=0}^{\\infty} \\frac{u^{(m+1)}_i}{m!} (h)^m \\right)\n$$\n$$\n\\text{LHS} = u'_i + \\sum_{m=0}^{\\infty} \\alpha \\frac{u^{(m+1)}_i}{m!} h^m ((-1)^m + 1)\n$$\n项 $((-1)^m + 1)$ 在 $m$ 为偶数时为 2，在 $m$ 为奇数时为 0。求和遍及 $m=0, 2, 4, \\dots$。令 $m=2j$。\n$$\n\\text{LHS} = u'_i + \\sum_{j=0}^{\\infty} \\alpha \\frac{u^{(2j+1)}_i}{(2j)!} h^{2j} (2) = u'_i + 2\\alpha u'_i + 2\\alpha \\sum_{j=1}^{\\infty} \\frac{h^{2j}}{(2j)!} u^{(2j+1)}_i\n$$\n$$\n\\text{LHS} = (1+2\\alpha)u'_i + 2\\alpha \\left( \\frac{h^2}{2!}u'''_i + \\frac{h^4}{4!}u^{(5)}_i + \\frac{h^6}{6!}u^{(7)}_i + \\dots \\right)\n$$\n\n**右侧（RHS）展开：**\nRHS 是 $\\frac{1}{h}\\sum_{k=-R}^{R} \\beta_k\\,u_{i+k}$。我们代入 $u_{i+k}$ 的泰勒展开：\n$$\n\\text{RHS} = \\frac{1}{h} \\sum_{k=-R}^{R} \\beta_k \\left( \\sum_{m=0}^{\\infty} \\frac{u^{(m)}_i}{m!} (kh)^m \\right)\n$$\n交换求和顺序并定义矩 $\\mu_m = \\sum_{k=-R}^{R} \\beta_k k^m$：\n$$\n\\text{RHS} = \\frac{1}{h} \\sum_{m=0}^{\\infty} \\frac{u^{(m)}_i h^m}{m!} \\left( \\sum_{k=-R}^{R} \\beta_k k^m \\right) = \\sum_{m=0}^{\\infty} \\frac{\\mu_m}{m!} h^{m-1} u^{(m)}_i\n$$\n问题指明了奇对称性，即 $\\beta_{-k} = -\\beta_k$ 和 $\\beta_0=0$。这对矩 $\\mu_m$ 有重要影响：\n- 对于偶数幂 $m=2j$：\n$$\n\\mu_{2j} = \\sum_{k=-R}^{R} \\beta_k k^{2j} = \\beta_0 \\cdot 0^{2j} + \\sum_{k=1}^{R} (\\beta_k k^{2j} + \\beta_{-k}(-k)^{2j}) = 0 + \\sum_{k=1}^{R} (\\beta_k k^{2j} - \\beta_k k^{2j}) = 0\n$$\n所有偶数矩都为零。这包括 $\\mu_0 = \\sum \\beta_k = 0$，这是零阶相容性条件，可防止出现 $O(h^{-1})$ 误差。\n- 对于奇数幂 $m=2j+1$：\n$$\n\\mu_{2j+1} = \\sum_{k=1}^{R} (\\beta_k k^{2j+1} + \\beta_{-k}(-k)^{2j+1}) = \\sum_{k=1}^{R} (\\beta_k k^{2j+1} - \\beta_k (-1) k^{2j+1}) = 2\\sum_{k=1}^{R} \\beta_k k^{2j+1}\n$$\nRHS 展开式简化为仅包含奇数阶导数的项：\n$$\n\\text{RHS} = \\frac{\\mu_1}{1!} u'_i + \\frac{\\mu_3}{3!} h^2 u'''_i + \\frac{\\mu_5}{5!} h^4 u^{(5)}_i + \\dots = \\sum_{j=0}^{\\infty} \\frac{\\mu_{2j+1}}{(2j+1)!} h^{2j} u^{(2j+1)}_i\n$$\n\n**高阶的矩匹配：**\n为了实现高精度阶，LHS 和 RHS 的泰勒级数展开必须在尽可能多的 $h$ 的幂次上逐项匹配。\n令 $h^{2j} u^{(2j+1)}_i$ 的系数相等：\n- 对于 $j=0$（$u'_i$ 的系数）：\n$$1+2\\alpha = \\mu_1$$\n- 对于 $j \\geq 1$（$h^{2j} u^{(2j+1)}_i$ 的系数）：\n$$\\frac{2\\alpha}{(2j)!} = \\frac{\\mu_{2j+1}}{(2j+1)!} \\implies 2\\alpha(2j+1) = \\mu_{2j+1}$$\n代入 $\\mu_{2j+1}$ 的表达式：\n$$ \\alpha(2j+1) = \\sum_{k=1}^{R} \\beta_k k^{2j+1} $$\n\n为了达到 $p=2N+2$ 的精度阶，我们必须满足 $j=0, 1, \\dots, N$ 的匹配条件。这给出了一个包含 $N+1$ 个线性方程的方程组：\n1.  ($j=0$): $1+2\\alpha = 2\\sum_{k=1}^{R} \\beta_k k$\n2.  ($j=1$): $3\\alpha = \\sum_{k=1}^{R} \\beta_k k^3$\n3.  ($j=2$): $5\\alpha = \\sum_{k=1}^{R} \\beta_k k^5$\n   ...\n$(N+1)$. ($j=N$): $(2N+1)\\alpha = \\sum_{k=1}^{R} \\beta_k k^{2N+1}$\n\n我们可以调整的未知数是系数 $\\alpha, \\beta_1, \\beta_2, \\dots, \\beta_R$。这给了我们总共 $R+1$ 个自由参数。\n如果方程的数量不超过独立未知数的数量，线性方程组通常有解。因此，为了能够求解这些系数，我们必须有：\n$$\nN+1 \\le R+1 \\implies N \\le R\n$$\n我们可以选择的最大值是 $N=R$。这使我们能够满足前 $R+1$ 个矩匹配条件（对于 $j=0, \\dots, R$）。\n当 $N=R$ 时，最低阶的误差项将是我们没有抵消的第一个项，对应于 $j=R+1$。泰勒级数展开的残差将是：\n$$\n\\tau_i = \\left( \\frac{2\\alpha}{(2(R+1))!} - \\frac{\\mu_{2(R+1)+1}}{(2(R+1)+1)!} \\right) h^{2(R+1)} u^{(2(R+1)+1)}_i + \\text{h.o.t.}\n$$\n$$\n\\tau_i = O(h^{2R+2})\n$$\n因此，该格式的阶为 $p=2R+2$。\n\n由于 $R$ 是一个固定的正整数，最大可实现的阶 $p_{max}=2R+2$ 也是固定且有限的。无法实现任意高的阶数，因为只有有限数量的自由参数（$R+1$ 个）可用于满足无限多个潜在的矩匹配条件。\n\n### 逐项分析选项\n\n**A. 任意高的形式阶 $p$ 对于任意固定的 $R$ 都是可以实现的，仅通过优化 $\\alpha$ 即可；在均匀网格上，右侧的宽度不限制阶数。**\n这个说法不正确。推导表明，最大阶数限制为 $p = 2R+2$。由 $R$ 决定的可用 RHS 系数的数量，与 $\\alpha$ 一起，从根本上限制了可以抵消的误差项的数量。仅优化 $\\alpha$ 是不够的；它只是用于满足方程组的 $R+1$ 个参数之一。\n**结论：不正确。**\n\n**B. 对于固定的 $R$，无法实现任意高的阶数。最大形式阶满足 $p \\le 2R+2$。限制性约束源于使用有限数量的自由系数进行泰勒级数矩匹配、为消除 $h^{-1}$ 项而设的相容性条件 $\\sum_{k=-R}^{R}\\beta_k=0$、迫使偶数矩为零的奇对称性 $\\beta_{-k}=-\\beta_k$，以及要求一组有限的奇数矩 $\\mu_{2m+1}=\\sum_{k=-R}^{R}\\beta_k k^{2m+1}$ 匹配由三对角左侧决定的线性序列。**\n这个说法是对推导过程全面而准确的总结。\n- 它正确地指出无法实现任意高的阶数。\n- 它正确地指出了最大阶数为 $p \\le 2R+2$（我们的推导表明 $p_{max}=2R+2$）。\n- 它正确地指出了限制是可用于矩匹配的系数数量有限。\n- 它正确地指出条件 $\\sum\\beta_k=0$（我已证明其为 $\\mu_0=0$）是奇对称性的结果，并消除了 $O(h^{-1})$ 误差。\n- 它正确地注意到奇对称性迫使偶数矩为零，从而消除了与偶数阶导数成比例的误差项。\n- 它正确地指出奇数矩 $\\mu_{2m+1}$ 必须满足由 LHS（具体来说，由参数 $\\alpha$）决定的一组关系。\n**结论：正确。**\n\n**C. 如果施加周期性边界条件，在固定的 $R$ 下可以实现任意高的阶数，因为离散傅里叶分析意味着指数级精度，且与模板宽度无关。**\n这个说法不正确。它混淆了有限差分法和伪谱法。有限差分格式的形式阶是由内部点的泰勒级数分析决定的局部性质。它与边界条件无关。虽然伪谱法可以对光滑的周期函数实现非常高（所谓的“无穷”或指数级）的阶数，但所讨论的格式是一个局部的有限差分算子，其阶数在代数上受其模板宽度的限制。\n**结论：不正确。**\n\n**D. 阶数仅受右侧系数数量的限制，为 $p \\le R+1$；左侧系数不参与三对角紧致格式的阶数条件。**\n这个说法不正确，原因有二。首先，推导出的最大阶数是 $p=2R+2$，而不是 $R+1$。阶数加倍的效果来自于奇对称性，它自动消除了一半的误差项。其次，LHS 系数 $\\alpha$ 是一个关键的自由参数，它积极参与矩匹配方程组。它不是一个被动的旁观者。\n**结论：不正确。**\n\n**E. 实现任意高阶需要违反相容性；设置 $\\sum_{k=-R}^{R}\\beta_k\\neq 0$ 可以抵消主导误差，从而即使对于固定的 $R$ 也能实现无界阶数。**\n这个说法从根本上是错误的。条件 $\\sum \\beta_k = 0$（即 $\\mu_0=0$）通过消除一个 $O(h^{-1})$ 阶的误差项来确保格式是相容的。违反这个条件将导致截断误差在 $h \\to 0$ 时发散，使该方法无效。它是任何有意义的精度概念的先决条件，而不是障碍。\n**结论：不正确。**",
            "answer": "$$\\boxed{B}$$"
        },
        {
            "introduction": "一个高阶精度的格式如果是不稳定的，那它在实际应用中将毫无价值。最后的这个动手实践将空间离散（一个六阶紧致格式）与时间积分方法（四阶龙格-库塔法）相结合，要求你分析整个全离散格式的稳定性。通过编程实现冯·诺依曼稳定性分析，你将亲手计算出最大稳定 $CFL$ 数，这是任何计算流体力学（CFD）模拟中的一个关键参数。",
            "id": "3302440",
            "problem": "考虑一维线性平流方程 $u_t + a u_x = 0$，该方程定义在一个具有 $N$ 个点、网格间距为 $\\Delta x$ 的均匀周期性网格上，其中 $a$ 为恒定的平流速度。半离散空间导数 $u_x$ 由六阶三对角紧致有限差分 (Padé) 格式近似。定义 Courant–Friedrichs–Lewy (CFL) 数为 $\\nu = a \\Delta t / \\Delta x$，其中 $\\Delta t$ 是时间步长，时间积分采用经典的四阶 Runge-Kutta 方法 (RK4)。使用 von Neumann 分析来估算最大稳定 CFL 数 $\\nu_{\\max}$，使得全离散格式对于网格上所有可分辨的傅里叶模式保持线性稳定。\n\n从线性平流方程出发，对于紧致格式，假设一阶导数在周期性网格上满足以下隐式关系：\n$$\n\\alpha f'_{j-1} + f'_j + \\alpha f'_{j+1} = \\frac{c_1}{2 \\Delta x}\\left(f_{j+1}-f_{j-1}\\right) + \\frac{c_2}{4 \\Delta x}\\left(f_{j+2}-f_{j-2}\\right),\n$$\n其中系数为 $\\alpha = 1/3$，$c_1 = 14/9$，$c_2 = 1/9$。在傅里叶模式 ansatz $f_j = \\exp(i j \\theta)$ 下，其中 $\\theta \\in [0,\\pi]$ 是以弧度为单位的离散角波数，该紧致格式意味着一个由下式定义的修正波数 $\\kappa(\\theta)$：\n$$\n\\kappa(\\theta) = \\frac{c_1 \\sin(\\theta) + \\frac{c_2}{2} \\sin(2\\theta)}{1 + 2 \\alpha \\cos(\\theta)}.\n$$\n线性平流方程的半离散算子具有特征值 $\\lambda(\\theta) = -i a \\kappa(\\theta)/\\Delta x$。经典的四阶 Runge-Kutta 方法具有稳定函数\n$$\nR(z) = 1 + z + \\frac{z^2}{2} + \\frac{z^3}{6} + \\frac{z^4}{24}.\n$$\n对于给定的傅里叶模式 $\\theta$，稳定性要求 $\\lvert R(\\lambda(\\theta) \\Delta t) \\rvert \\le 1$。因此，最大稳定 CFL 数是使得 $\\lvert R(-i \\nu \\kappa(\\theta)) \\rvert \\le 1$ 对网格上所有可分辨波数 $\\theta$ 都成立的最大 $\\nu$。\n\n你的任务是实现一个程序，该程序能够：\n- 对限制在虚轴上的 RK4 稳定函数，数值计算 $s_{\\max} = \\sup\\left\\{ s \\ge 0 \\; \\middle| \\; \\lvert R(i s) \\rvert \\le 1 \\right\\}$。\n- 对于每个指定的网格尺寸 $N$，计算可分辨离散波数集合 $\\theta_m = 2\\pi m/N$（其中整数 $m \\in \\{1,2,\\dots,\\lfloor N/2 \\rfloor\\}$，以弧度为单位），然后使用上述公式计算 $\\kappa(\\theta_m)$。\n- 确定 $\\kappa_{\\max}(N) = \\max_{m} \\lvert \\kappa(\\theta_m) \\rvert$。\n- 返回 $\\nu_{\\max}(N) = s_{\\max} / \\kappa_{\\max}(N)$。\n\n请根据所述的基本原理设计你的算法，不要使用任何预先制表的稳定性边界。所有角度都必须以弧度表示。\n\n测试套件：\n- 案例 1：$N = 8$。\n- 案例 2：$N = 16$。\n- 案例 3：$N = 64$。\n- 案例 4：$N = 512$。\n\n对于每个案例，生成 $\\nu_{\\max}(N)$ 的浮点数值，并四舍五入到十位小数。\n\n最终输出格式：\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，列表项按测试套件案例的顺序列出。例如，输出应为 $[\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4]$ 的形式，其中每个 $\\text{result}_k$ 是一个四舍五入到十位小数的浮点数。",
            "solution": "该问题要求确定应用于一维线性平流方程 $u_t + a u_x = 0$ 的全离散数值格式的最大稳定 Courant–Friedrichs–Lewy (CFL) 数，记为 $\\nu_{\\max}$。该格式结合了用于空间离散化的六阶紧致有限差分法和用于时间积分的经典四阶 Runge-Kutta (RK4) 方法。分析将使用 von Neumann 稳定性方法进行。\n\n这个过程包含三个主要步骤：\n1.  确定 RK4 方法在虚轴上的稳定区域。\n2.  分析空间离散算子的谱性质，特别是其修正波数。\n3.  综合这些结果，求出全离散格式的稳定性极限，该极限是网格尺寸 $N$ 的函数。\n\n首先，我们分析时间积分格式。应用于半离散方程 $\\frac{d\\hat{u}}{dt} = \\lambda \\hat{u}$ 的显式时间步进法的稳定性由稳定函数 $R(z)$ 决定，其中 $z = \\lambda \\Delta t$。为使格式稳定，放大因子 $G = R(z)$ 必须满足 $|G| \\le 1$。\n\n在周期性网格上使用指定的六阶紧致格式进行空间离散化，得到半离散的傅里叶空间表示 $\\frac{d\\hat{u}(\\theta)}{dt} = -i \\frac{a}{\\Delta x} \\kappa(\\theta) \\hat{u}(\\theta)$，其中 $\\hat{u}(\\theta)$ 是解在波数 $\\theta$ 处的傅里叶系数。因此，半离散算子的特征值是纯虚数：$\\lambda(\\theta) = -i \\frac{a \\kappa(\\theta)}{\\Delta x}$。对于实数 $\\theta$，修正波数 $\\kappa(\\theta)$ 是一个实值函数，由下式给出：\n$$\n\\kappa(\\theta) = \\frac{c_1 \\sin(\\theta) + \\frac{c_2}{2} \\sin(2\\theta)}{1 + 2 \\alpha \\cos(\\theta)}\n$$\n系数由 $\\alpha = 1/3$，$c_1 = 14/9$ 和 $c_2 = 1/9$ 给出。\n\n稳定函数的自变量为 $z = \\lambda(\\theta) \\Delta t = -i \\frac{a \\kappa(\\theta)}{\\Delta x} \\Delta t$。定义 CFL 数为 $\\nu = \\frac{a \\Delta t}{\\Delta x}$，则 $z = -i \\nu \\kappa(\\theta)$。每个傅里叶模式的稳定性条件是 $|R(-i \\nu \\kappa(\\theta))| \\le 1$。\n\nRK4 方法的稳定函数如下：\n$$\nR(z) = 1 + z + \\frac{z^2}{2!} + \\frac{z^3}{3!} + \\frac{z^4}{4!}\n$$\n我们需要找到纯虚自变量 $z = is$（其中 $s$ 为实数）的稳定性极限。对于实系数多项式，由于其具有 $R(\\bar{z}) = \\overline{R(z)}$ 的性质，因此有 $|R(-is)| = |R(is)|$，所以我们可以不失一般性地对 $s \\ge 0$ 进行分析。\n将 $z=is$ 代入 $R(z)$:\n$$\nR(is) = 1 + (is) + \\frac{(is)^2}{2} + \\frac{(is)^3}{6} + \\frac{(is)^4}{24} = 1 + is - \\frac{s^2}{2} - i\\frac{s^3}{6} + \\frac{s^4}{24}\n$$\n分别组合实部和虚部：\n$$\nR(is) = \\left(1 - \\frac{s^2}{2} + \\frac{s^4}{24}\\right) + i\\left(s - \\frac{s^3}{6}\\right)\n$$\n稳定性条件为 $|R(is)|^2 \\le 1$:\n$$\n|R(is)|^2 = \\left(1 - \\frac{s^2}{2} + \\frac{s^4}{24}\\right)^2 + \\left(s - \\frac{s^3}{6}\\right)^2 \\le 1\n$$\n展开各项：\n$$\n|R(is)|^2 = \\left(1 - s^2 + \\frac{s^4}{3} - \\frac{s^6}{24} + \\frac{s^8}{576}\\right) + \\left(s^2 - \\frac{s^4}{3} + \\frac{s^6}{36}\\right)\n$$\n$$\n|R(is)|^2 = 1 + \\left(-\\frac{1}{24} + \\frac{1}{36}\\right)s^6 + \\frac{s^8}{576} = 1 - \\frac{s^6}{72} + \\frac{s^8}{576}\n$$\n稳定性不等式变为：\n$$\n1 - \\frac{s^6}{72} + \\frac{s^8}{576} \\le 1 \\implies \\frac{s^8}{576} - \\frac{s^6}{72} \\le 0\n$$\n对于 $s > 0$，我们可以用 $s^6$ 去除：\n$$\n\\frac{s^2}{576} - \\frac{1}{72} \\le 0 \\implies s^2 \\le \\frac{576}{72} = 8\n$$\n这得到 $s \\le \\sqrt{8} = 2\\sqrt{2}$。因此，使得 RK4 格式在虚轴上稳定的 $s \\ge 0$ 的上确界为 $s_{\\max} = 2\\sqrt{2}$。\n\n稳定函数的自变量是 $z = -i\\nu\\kappa(\\theta)$。其模为 $|z| = |\\nu\\kappa(\\theta)|$。为保证稳定性，对于网格上所有活跃的傅里叶模式，此模必须小于或等于 $s_{\\max}$。\n$$\n|\\nu \\kappa(\\theta_m)| \\le s_{\\max} \\quad \\text{for all } m\n$$\n其中 $\\theta_m = \\frac{2\\pi m}{N}$，对于 $m \\in \\{1, 2, \\dots, \\lfloor N/2 \\rfloor\\}$。\n由于 $\\nu$ 是一个正常数，此条件等价于：\n$$\n\\nu \\cdot |\\kappa(\\theta_m)| \\le s_{\\max} \\implies \\nu \\le \\frac{s_{\\max}}{|\\kappa(\\theta_m)|}\n$$\n为确保所有模式同时稳定，$\\nu$ 必须小于或等于所有 $m$ 对应的这些上界中的最小值。这取决于使 $|\\kappa(\\theta_m)|$ 最大化的模式：\n$$\n\\nu_{\\max}(N) = \\frac{s_{\\max}}{\\max_{m} |\\kappa(\\theta_m)|} = \\frac{s_{\\max}}{\\kappa_{\\max}(N)}\n$$\n其中 $\\kappa_{\\max}(N) = \\max_{m \\in \\{1, \\dots, \\lfloor N/2 \\rfloor\\}} |\\kappa(\\theta_m)|$。\n\n解决该问题的算法如下：\n1.  计算 RK4 的虚轴稳定性边界，$s_{\\max} = 2\\sqrt{2}$。\n2.  使用给定的系数 $\\alpha$、$c_1$ 和 $c_2$ 定义修正波数 $\\kappa(\\theta)$ 的函数。\n3.  对于测试套件中提供的每个网格尺寸 $N$：\n    a. 生成离散波数集合 $\\theta_m = \\frac{2\\pi m}{N}$，其中 $m$ 从 $1$ 到 $\\lfloor N/2 \\rfloor$。\n    b. 对所有这些波数求值 $\\kappa(\\theta_m)$。\n    c. 在此集合中找到最大绝对值 $\\kappa_{\\max}(N)$。\n    d. 计算最大稳定 CFL 数 $\\nu_{\\max}(N) = \\frac{s_{\\max}}{\\kappa_{\\max}(N)}$。\n    e. 将结果四舍五入到十位小数。\n4.  收集结果并将其格式化为逗号分隔的列表。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the maximum stable CFL number for a sixth-order compact finite\n    difference scheme with RK4 time integration for the 1D linear advection\n    equation on various grid sizes.\n    \"\"\"\n    \n    # Define the test cases for grid size N\n    test_cases = [8, 16, 64, 512]\n    \n    # Coefficients for the sixth-order compact finite difference scheme\n    alpha = 1.0 / 3.0\n    c1 = 14.0 / 9.0\n    c2 = 1.0 / 9.0\n    \n    # Maximum extent of the stability region of RK4 on the imaginary axis\n    s_max = 2.0 * np.sqrt(2.0)\n    \n    def kappa(theta):\n        \"\"\"\n        Calculates the modified wavenumber for the compact scheme.\n        \n        Args:\n            theta: The discrete angular wavenumber in radians.\n        \n        Returns:\n            The modified wavenumber.\n        \"\"\"\n        numerator = c1 * np.sin(theta) + (c2 / 2.0) * np.sin(2.0 * theta)\n        denominator = 1.0 + 2.0 * alpha * np.cos(theta)\n        return numerator / denominator\n\n    results = []\n    for N in test_cases:\n        # Generate the discrete wavenumbers theta_m for m = 1, 2, ..., floor(N/2)\n        # m must be integers, so we use arange.\n        m_values = np.arange(1, np.floor(N / 2) + 1)\n        theta_values = 2.0 * np.pi * m_values / N\n        \n        # Calculate the modified wavenumbers for all theta values\n        kappa_values = kappa(theta_values)\n        \n        # Find the maximum absolute modified wavenumber\n        kappa_max_N = np.max(np.abs(kappa_values))\n        \n        # Calculate the maximum stable CFL number\n        nu_max_N = s_max / kappa_max_N\n        \n        # Round the result to 10 decimal places and append\n        results.append(nu_max_N)\n        \n    # Format the results for output as specified: \"[res1,res2,res3,res4]\"\n    # using an f-string to handle rounding to 10 decimal places correctly.\n    formatted_results = [f\"{r:.10f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n\n```"
        }
    ]
}