{
    "hands_on_practices": [
        {
            "introduction": "The foundation of the spectral element method lies in its ability to represent complex fields with high-order polynomials defined on a set of specific nodes. This first exercise provides direct practice with these core mechanics, focusing on the one-dimensional reference element. By interpolating data at Gauss-Lobatto-Legendre (GLL) nodes, you will gain hands-on experience with the Lagrange basis and also explore how the Lebesgue constant provides a bound on interpolation errors, a key concept for numerical stability.",
            "id": "3381169",
            "problem": "In a one-dimensional spectral element discretization of a scalar field over the reference interval $[-1,1]$, consider polynomial interpolation of degree $N=4$ using the Gauss–Lobatto–Legendre (GLL) points. The GLL nodes for $N=4$ are the endpoints together with the roots of the derivative of the degree-$4$ Legendre polynomial, namely\n$$x_{0}=-1,\\quad x_{1}=-\\sqrt{\\frac{3}{7}},\\quad x_{2}=0,\\quad x_{3}=\\sqrt{\\frac{3}{7}},\\quad x_{4}=1.$$\nSuppose the nodal data (e.g., pointwise values of a conservative variable) at these nodes are\n$$u_{0}=\\frac{13}{10},\\quad u_{1}=u_{3}=\\frac{93}{98},\\quad u_{2}=\\frac{3}{5},\\quad u_{4}=\\frac{13}{10}.$$\nUsing the Lagrange interpolant built on these GLL nodes, evaluate the interpolant at the point $x=0.3$. Assume the nodal data used in the computation may be perturbed by measurement and round-off errors of absolute magnitude at most $\\varepsilon=2.0\\times 10^{-4}$. Using the degree-$4$ Lebesgue constant (the supremum over $[-1,1]$ of the Lebesgue function $\\Lambda_{4}(x)=\\sum_{i=0}^{4}|l_{i}(x)|$ built from these GLL nodes), provide an upper bound for the induced interpolation error at $x=0.3$ expressed in terms of $\\Lambda_{4}$. Round the interpolant value to six significant figures. No physical units are involved in this computation.",
            "solution": "The goal is to evaluate the degree-4 Lagrange interpolant $I_4[u](x)$ at $x=0.3$.\n\nA direct but computationally intensive approach is to evaluate each Lagrange basis function $l_i(x)$ at $x=0.3$ and compute the sum $I_4[u](0.3) = \\sum_{i=0}^4 u_i l_i(0.3)$. A more efficient method exploits the problem's structure.\n\nThe GLL nodes are symmetric about the origin, and the provided nodal data $\\{u_i\\}$ is also symmetric ($u_0=u_4$ and $u_1=u_3$). This implies that the unique degree-4 polynomial interpolant, $I_4[u](x)$, must be an even function. An even polynomial of degree 4 can be written in the form:\n$$I_4[u](x) = ax^4 + bx^2 + c$$\n\nWe can determine the coefficients $a$, $b$, and $c$ by enforcing that the polynomial passes through three of the distinct nodal points.\n1.  Using the node $x_2=0$:\n    $$I_4[u](0) = a(0)^4 + b(0)^2 + c = c = u_2 = \\frac{3}{5} = 0.6$$\n2.  Using the node $x_4=1$:\n    $$I_4[u](1) = a(1)^4 + b(1)^2 + c = a+b+0.6 = u_4 = \\frac{13}{10} = 1.3$$\n    This gives the first equation: $a+b = 0.7$.\n3.  Using the node $x_3=\\sqrt{3/7}$:\n    $$I_4[u](\\sqrt{3/7}) = a(\\sqrt{3/7})^4 + b(\\sqrt{3/7})^2 + c = a\\left(\\frac{9}{49}\\right) + b\\left(\\frac{3}{7}\\right) + 0.6 = u_3 = \\frac{93}{98}$$\n    This gives the second equation: $a\\left(\\frac{9}{49}\\right) + b\\left(\\frac{21}{49}\\right) = \\frac{93}{98} - \\frac{3}{5} = \\frac{465 - 294}{490} = \\frac{171}{490}$.\n    Multiplying by 49 gives: $9a + 21b = \\frac{171 \\times 49}{490} = \\frac{171}{10} = 17.1$.\n\nWe now solve the linear system:\n(i) $a + b = 0.7$\n(ii) $9a + 21b = 17.1$\n\nFrom (i), $a = 0.7 - b$. Substituting into (ii):\n$$9(0.7 - b) + 21b = 17.1$$\n$$6.3 - 9b + 21b = 17.1$$\n$$12b = 10.8 \\implies b = 0.9$$\nSubstituting $b$ back into (i):\n$$a + 0.9 = 0.7 \\implies a = -0.2$$\nThe interpolating polynomial is:\n$$I_4[u](x) = -0.2x^4 + 0.9x^2 + 0.6$$\n\nNow, we evaluate this polynomial at $x=0.3$:\n$$I_4[u](0.3) = -0.2(0.3)^4 + 0.9(0.3)^2 + 0.6$$\n$$I_4[u](0.3) = -0.2(0.0081) + 0.9(0.09) + 0.6$$\n$$I_4[u](0.3) = -0.00162 + 0.081 + 0.6 = 0.67938$$\nRounded to six significant figures, the value is $0.679380$.\n\nFor the second part, if the nodal values $\\{u_i\\}$ are perturbed by $\\{\\delta u_i\\}$ with $|\\delta u_i| \\le \\varepsilon$, the error in the interpolant at any point $x$ is bounded by:\n$$|I_4[u+\\delta u](x) - I_4[u](x)| = \\left|\\sum_{i=0}^{4} \\delta u_i \\, l_i(x)\\right| \\le \\sum_{i=0}^{4} |\\delta u_i| |l_i(x)| \\le \\varepsilon \\sum_{i=0}^{4} |l_i(x)|$$\nThe sum $\\sum_{i=0}^{4} |l_i(x)|$ is the Lebesgue function $\\Lambda_4(x)$. The maximum value of this function over the interval is the Lebesgue constant, $\\Lambda_4$. Therefore, the error is bounded by:\n$$|\\text{Error at } x=0.3| \\le \\varepsilon \\Lambda_4(0.3) \\le \\varepsilon \\Lambda_4 = (2.0 \\times 10^{-4}) \\Lambda_4$$\nThis gives the requested upper bound.",
            "answer": "$$\\boxed{\\begin{pmatrix}0.679380 & 2.0 \\times 10^{-4}\\,\\Lambda_{4}\\end{pmatrix}}$$"
        },
        {
            "introduction": "Building on the principles of interpolation, this practice explores the crucial consequences of applying the spectral element method to nonlinear partial differential equations, using the inviscid Burgers' equation as a fundamental example. The primary challenge in such problems is the generation of higher-degree polynomial terms that cannot be integrated exactly by the standard GLL quadrature rule. This exercise guides you through a calculation of the discrete energy budget, allowing you to quantify the aliasing error and witness firsthand how naive collocation can violate fundamental conservation laws.",
            "id": "3381178",
            "problem": "Consider the one-dimensional viscous Burgers equation in conservation form on the reference element $[-1,1]$,\n$$\n\\frac{\\partial u}{\\partial t} + \\frac{\\partial}{\\partial x}\\left(\\frac{u^{2}}{2}\\right) = \\nu \\frac{\\partial^{2} u}{\\partial x^{2}},\n$$\nwith kinematic viscosity $\\nu$. Adopt a single-element Spectral Element Method (SEM) with polynomial degree $p=3$ using Gauss–Lobatto–Legendre (GLL) collocation. Let the GLL nodes be $x_{0}=-1$, $x_{1}=-1/\\sqrt{5}$, $x_{2}=1/\\sqrt{5}$, $x_{3}=1$, and the associated quadrature weights be $w_{0}=w_{3}=1/6$, $w_{1}=w_{2}=5/6$. Let $W=\\operatorname{diag}(w_{0},w_{1},w_{2},w_{3})$ be the diagonal mass matrix resulting from mass lumping at the GLL points, and let $D$ be the GLL differentiation matrix with entries $D_{ij}=\\ell_{j}'(x_{i})$, where $\\ell_{j}(x)$ are the Lagrange polynomials associated with the GLL nodes. The nonlinear flux is collocated naively as $f=\\frac{1}{2}u\\odot u$, where $\\odot$ denotes componentwise multiplication.\n\nAssume periodic boundaries for the convective operator such that the continuous convective energy transfer is boundary-neutral on $[-1,1]$ when $u(-1)=u(1)$. Consider the inviscid case $\\nu=0$ and initialize the nodal values by sampling the polynomial field $u(x)=x^{3}-x$ at the GLL nodes, so that $u(-1)=u(1)=0$.\n\nDefine the discrete energy as\n$$\nE_{h}(t)=\\frac{1}{2} u(t)^{\\top} W\\, u(t),\n$$\nand the semi-discrete strong-form collocation SEM as\n$$\nW\\,\\frac{d u}{dt} + W\\,D\\,f = 0,\\qquad f=\\frac{1}{2}u\\odot u.\n$$\nThus, the discrete convective contribution to the energy rate is\n$$\n\\frac{dE_{h}}{dt} = -\\,u^{\\top} W\\,D\\,f.\n$$\nTreat the difference between $\\frac{dE_{h}}{dt}$ and the exact inviscid, periodic convective energy transfer (which is zero for this field on $[-1,1]$) as the aliasing error introduced by naive collocation of the nonlinear term.\n\nCompute the exact scalar value of the aliasing error,\n$$\n\\mathcal{R} \\equiv -\\,u^{\\top} W\\,D\\,f,\n$$\nfor the specified setup. Express your final answer as a single exact number. No rounding is required and no units are needed.",
            "solution": "The problem asks for the computation of the aliasing error, $\\mathcal{R} \\equiv -u^{\\top} W D f$, for a spectral element discretization of the inviscid Burgers' equation.\n\n**Step 1: Determine Nodal Values**\nFirst, we find the vector of nodal values, $u$, by evaluating the polynomial $u(x) = x^3 - x$ at the $p=3$ GLL nodes:\n-   $u_0 = u(-1) = (-1)^3 - (-1) = 0$\n-   $u_1 = u(-1/\\sqrt{5}) = (-1/\\sqrt{5})^3 - (-1/\\sqrt{5}) = -1/(5\\sqrt{5}) + 1/\\sqrt{5} = 4/(5\\sqrt{5})$\n-   $u_2 = u(1/\\sqrt{5}) = (1/\\sqrt{5})^3 - (1/\\sqrt{5}) = 1/(5\\sqrt{5}) - 1/\\sqrt{5} = -4/(5\\sqrt{5})$\n-   $u_3 = u(1) = (1)^3 - 1 = 0$\nThe vector of nodal values is $u = \\begin{pmatrix} 0 & 4/(5\\sqrt{5}) & -4/(5\\sqrt{5}) & 0 \\end{pmatrix}^{\\top}$.\n\n**Step 2: Determine Nodal Flux Values**\nNext, we compute the collocated nonlinear flux vector $f = \\frac{1}{2} u \\odot u$:\n-   $f_0 = \\frac{1}{2} u_0^2 = 0$\n-   $f_1 = \\frac{1}{2} u_1^2 = \\frac{1}{2} (4/(5\\sqrt{5}))^2 = \\frac{1}{2} (16/125) = 8/125$\n-   $f_2 = \\frac{1}{2} u_2^2 = \\frac{1}{2} (-4/(5\\sqrt{5}))^2 = 8/125$\n-   $f_3 = \\frac{1}{2} u_3^2 = 0$\nThe flux vector is $f = \\begin{pmatrix} 0 & 8/125 & 8/125 & 0 \\end{pmatrix}^{\\top}$.\n\n**Step 3: Relate the Discrete Sum to a Continuous Integral**\nThe quantity to compute is $\\mathcal{R} = -u^{\\top} W D f = - \\sum_{i=0}^3 u_i w_i (Df)_i$. The term $(Df)_i$ represents the derivative of the polynomial interpolant of $f$, let's call it $f_I(x)$, evaluated at node $x_i$. The entire sum is the GLL quadrature approximation of the integral $-\\int_{-1}^1 u_I(x) f_I'(x) dx$, where $u_I(x)$ is the interpolant of $u$.\n-   Since $u(x)$ is a degree-3 polynomial and we are using degree-3 interpolation, $u_I(x) = u(x) = x^3 - x$.\n-   The flux values $f_i$ are interpolated by a polynomial $f_I(x)$ of degree at most 3.\n-   The derivative $f_I'(x)$ is a polynomial of degree at most 2.\n-   The integrand $u_I(x) f_I'(x)$ is a polynomial of degree at most $3 + 2 = 5$.\nThe GLL quadrature rule with $p+1=4$ points is exact for polynomials of degree up to $2p-1 = 2(3)-1=5$. Therefore, the discrete sum is exactly equal to the continuous integral:\n$$ \\mathcal{R} = - \\int_{-1}^{1} u_I(x) f_I'(x) \\, dx $$\n\n**Step 4: Find the Interpolating Flux Polynomial $f_I(x)$**\nWe need the polynomial $f_I(x)$ of degree $\\le 3$ passing through the points $(x_i, f_i)$. Since the nodes are symmetric and the data is symmetric ($f_1=f_2, f_0=f_3$), $f_I(x)$ must be an even function of the form $f_I(x) = Ax^2 + B$.\n-   Using $(x_3, f_3) = (1, 0)$: $A(1)^2 + B = 0 \\implies B=-A$. So, $f_I(x) = A(x^2-1)$.\n-   Using $(x_2, f_2) = (1/\\sqrt{5}, 8/125)$: $A((1/\\sqrt{5})^2 - 1) = 8/125 \\implies A(1/5 - 1) = 8/125 \\implies A(-4/5) = 8/125$.\n-   Solving for $A$: $A = \\frac{8}{125} \\left(-\\frac{5}{4}\\right) = -\\frac{2}{25}$.\nThe flux polynomial is $f_I(x) = -\\frac{2}{25}(x^2-1) = \\frac{2}{25}(1-x^2)$. Its derivative is $f_I'(x) = -\\frac{4}{25}x$.\n\n**Step 5: Compute the Integral**\nSubstitute $u_I(x)$ and $f_I'(x)$ into the integral:\n$$ \\mathcal{R} = - \\int_{-1}^{1} (x^3 - x) \\left(-\\frac{4}{25}x\\right) \\, dx = \\frac{4}{25} \\int_{-1}^{1} (x^4 - x^2) \\, dx $$\nThe integrand is even, so we can simplify:\n$$ \\mathcal{R} = \\frac{4}{25} \\cdot 2 \\int_{0}^{1} (x^4 - x^2) \\, dx = \\frac{8}{25} \\left[ \\frac{x^5}{5} - \\frac{x^3}{3} \\right]_{0}^{1} $$\n$$ \\mathcal{R} = \\frac{8}{25} \\left( \\frac{1}{5} - \\frac{1}{3} \\right) = \\frac{8}{25} \\left( \\frac{3 - 5}{15} \\right) = \\frac{8}{25} \\left( -\\frac{2}{15} \\right) $$\n$$ \\mathcal{R} = -\\frac{16}{375} $$",
            "answer": "$$\\boxed{-\\frac{16}{375}}$$"
        },
        {
            "introduction": "Many problems in fluid dynamics involve systems of coupled equations, which introduce unique stability requirements beyond those seen in scalar equations. This advanced practice confronts the challenge of pressure-velocity coupling in the incompressible Stokes equations, a cornerstone of computational fluid dynamics. By algebraically constructing the discrete divergence operator for an equal-order element and searching for non-trivial vectors in its null space, you will demonstrate the existence of spurious pressure modes, providing a concrete link between the theoretical Ladyzhenskaya-Babuška-Brezzi (LBB) condition and its practical implications for numerical stability.",
            "id": "3381222",
            "problem": "Consider the incompressible Stokes equations on the unit square domain $\\Omega = [0,1]^2$ with periodic boundary conditions, where the velocity field is denoted by $\\mathbf{u}$ and the pressure field by $p$. The continuous weak formulation seeks $\\mathbf{u} \\in \\mathbf{V}$ and $p \\in Q$ such that\n$$\n\\int_{\\Omega} \\nabla \\mathbf{u} : \\nabla \\mathbf{v} \\, d\\Omega - \\int_{\\Omega} p \\, \\nabla \\cdot \\mathbf{v} \\, d\\Omega = \\int_{\\Omega} \\mathbf{f} \\cdot \\mathbf{v} \\, d\\Omega \\quad \\text{for all } \\mathbf{v} \\in \\mathbf{V},\n$$\nand\n$$\n\\int_{\\Omega} q \\, \\nabla \\cdot \\mathbf{u} \\, d\\Omega = 0 \\quad \\text{for all } q \\in Q,\n$$\nwhere $\\mathbf{V}$ is the appropriate Sobolev space for velocity and $Q$ is the appropriate space for pressure. Stability of mixed formulations is governed by the Ladyzhenskaya–Babuška–Brezzi (LBB) condition, also known as the inf–sup condition, which requires a positive lower bound on the discrete inf–sup constant for the chosen discretization of $\\mathbf{V}$ and $Q$.\n\nIn the Spectral Element Method (SEM), with Gauss–Lobatto–Legendre (GLL) quadrature and nodal basis functions, an equal-order choice $Q_p/Q_p$ (velocity and pressure spaces of the same polynomial degree $p$) on a structured mesh is known to admit spurious pressure modes that violate the inf–sup condition. In particular, for $p = 1$ (bilinear nodal basis on element corners) with diagonal (mass-lumped) quadrature using $2 \\times 2$ GLL points, a classic “checkerboard” pressure mode persists under mesh refinement on structured grids.\n\nYour task is to construct, purely in algebraic terms, laughable discrete divergence coupling operator for the equal-order SEM on a structured, periodic mesh of the unit square using $p = 1$, and to demonstrate the existence and persistence of a spurious pressure mode under mesh refinement. Proceed as follows.\n\n1. Discretize $\\Omega$ into $M \\times M$ identical square spectral elements, with $M$ even, so that the element size is $h_x = h_y = h = 1/M$. Use GLL nodes at the element corners, which, under periodic identification, induce a global structured grid of $M \\times M$ unique nodal points indexed by $(i,j)$ with $i \\in \\{0,1,\\dots,M-1\\}$ and $j \\in \\{0,1,\\dots,M-1\\}$. Use equal-order, continuous nodal basis functions for velocity and pressure defined at these global nodes.\n\n2. Let the global velocity vector be ordered as two components per node, so the number of velocity degrees of freedom is $n_u = 2 M^2$, and the number of pressure degrees of freedom is $n_p = M^2$. Define the discrete divergence coupling matrix $\\mathbf{B} \\in \\mathbb{R}^{n_p \\times n_u}$ purely algebraically by SEM collocation with GLL quadrature:\n   - On the reference element $[-1,1]^2$, the $2$-point one-dimensional GLL nodes are at $\\xi = -1$ and $\\xi = +1$ with weights $w = 1$ and the differentiation matrix\n     $$\n     \\mathbf{D}^{(1\\text{D})} = \\begin{bmatrix} -\\tfrac{1}{2} & \\tfrac{1}{2} \\\\ -\\tfrac{1}{2} & \\tfrac{1}{2} \\end{bmatrix}.\n     $$\n   - The physical derivatives scale as $\\partial/\\partial x = \\tfrac{2}{h} \\, \\partial/\\partial \\xi$ and $\\partial/\\partial y = \\tfrac{2}{h} \\, \\partial/\\partial \\eta$.\n   - For each element with lower-left corner at $(i,j)$ in the global index space, and for each of its four local nodes $(s,t) \\in \\{0,1\\} \\times \\{0,1\\}$ corresponding to reference coordinates $(\\xi_s, \\eta_t) \\in \\{-1,+1\\} \\times \\{-1,+1\\}$, the discrete divergence at that local node induced by global velocity nodal values is defined by\n     $$\n     \\big(\\nabla \\cdot \\mathbf{u}\\big)_{(s,t)} = \\frac{2}{h} \\sum_{k=0}^{1} \\mathbf{D}^{(1\\text{D})}_{s,k} \\, u_x\\big(k,t\\big) \\;+\\; \\frac{2}{h} \\sum_{k=0}^{1} \\mathbf{D}^{(1\\text{D})}_{t,k} \\, u_y\\big(s,k\\big),\n     $$\n     where $u_x(k,t)$ and $u_y(s,k)$ are the velocity nodal values at the appropriate global nodes on that element. Assemble these contributions to a global collocated divergence operator by summing element-wise contributions at shared global nodes under periodic identification. Then, define $\\mathbf{B}$ by mass-lumped GLL quadrature as\n     $$\n     \\mathbf{B} = h^2 \\, \\mathbf{D}_{\\text{glob}},\n     $$\n     where $\\mathbf{D}_{\\text{glob}}$ maps global velocity degrees of freedom to the divergence evaluated at global pressure nodes, and $h^2$ is the quadrature weight accumulated per global node (each node is shared by four elements and each element contributes $(h^2)/4$ per corner with $2 \\times 2$ GLL).\n\n3. Define the checkerboard pressure vector $\\mathbf{p}_{\\text{alt}} \\in \\mathbb{R}^{n_p}$ at global node $(i,j)$ by\n   $$\n   \\big(\\mathbf{p}_{\\text{alt}}\\big)_{i,j} = (-1)^{i+j}.\n   $$\n   This vector is well-defined on the periodic grid only for even $M$.\n\n4. Demonstrate spurious pressure mode persistence under mesh refinement by computing, for $M \\in \\{2,4,8\\}$:\n   - The Euclidean norm $\\left\\| \\mathbf{B}^\\top \\mathbf{p}_{\\text{alt}} \\right\\|_2$ and reporting whether it is below a threshold $\\varepsilon = 10^{-12}$ (a boolean result).\n   - The number of singular values of $\\mathbf{B}$ less than or equal to $\\varepsilon$, minus $1$ to remove the trivial nullspace associated with constant pressure. This yields a nonnegative integer that counts spurious pressure modes beyond the constant-pressure mode.\n\n5. Your program must implement the above assembly exactly as specified and produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The list must be ordered as\n   $$\n   \\big[ b_{2}, b_{4}, b_{8}, c_{2}, c_{4}, c_{8} \\big],\n   $$\n   where $b_M$ is the boolean indicating whether $\\left\\| \\mathbf{B}^\\top \\mathbf{p}_{\\text{alt}} \\right\\|_2 \\le \\varepsilon$ for the given $M$, and $c_M$ is the integer count of spurious pressure modes as described above for that $M$. No physical units are involved in this computation. Angles are not present. Percentages are not present. The program must print exactly one line with the specified format.\n\nThe test suite is given by the parameter values $M \\in \\{2,4,8\\}$ and threshold $\\varepsilon = 10^{-12}$. Ensure numerical robustness and exact assembly so that the discrete algebra reflects the specified SEM collocation and quadrature model.",
            "solution": "This problem requires constructing the discrete divergence operator $\\mathbf{B}$ for an equal-order $Q_1/Q_1$ spectral element discretization and demonstrating the existence of a spurious pressure mode. The solution involves two main parts: deriving the algebraic form of $\\mathbf{B}$ and then analyzing its null space.\n\n**1. Derivation of the Global Divergence Operator**\nThe global operator $\\mathbf{D}_{\\text{glob}}$ is assembled by summing contributions from each element. On a periodic $M \\times M$ grid, each global node $(i,j)$ is shared by four elements. Let's find the expression for the divergence at node $(i,j)$ by summing the contributions from the elements with lower-left corners at $(i,j)$, $(i-1,j)$, $(i,j-1)$, and $(i-1,j-1)$ (with all indices taken modulo $M$).\n\nConsider the contribution to $\\partial u_x / \\partial x$ at global node $(i,j)$:\n-   For the element with LL corner $(i,j)$, node $(i,j)$ is its local node $(0,0)$. The contribution is $\\frac{2}{h}\\left(-\\frac{1}{2}u_x(i,j) + \\frac{1}{2}u_x(i+1,j)\\right)$.\n-   For the element with LL corner $(i-1,j)$, node $(i,j)$ is its local node $(1,0)$. The contribution is $\\frac{2}{h}\\left(-\\frac{1}{2}u_x(i-1,j) + \\frac{1}{2}u_x(i,j)\\right)$.\n-   For the element with LL corner $(i,j-1)$, node $(i,j)$ is its local node $(0,1)$. The contribution is $\\frac{2}{h}\\left(-\\frac{1}{2}u_x(i,j) + \\frac{1}{2}u_x(i+1,j)\\right)$.\n-   For the element with LL corner $(i-1,j-1)$, node $(i,j)$ is its local node $(1,1)$. The contribution is $\\frac{2}{h}\\left(-\\frac{1}{2}u_x(i-1,j) + \\frac{1}{2}u_x(i,j)\\right)$.\n\nSumming these four contributions gives the total discrete derivative at node $(i,j)$:\n$$ (\\partial_x u_x)_{i,j} = \\frac{1}{h} \\left[ (u_{x,i+1,j} - u_{x,i,j}) + (u_{x,i,j} - u_{x,i-1,j}) + (u_{x,i+1,j} - u_{x,i,j}) + (u_{x,i,j} - u_{x,i-1,j}) \\right] = \\frac{2}{h} (u_{x,i+1,j} - u_{x,i-1,j}) $$\nBy symmetry, the contribution from the $y$-derivative is $(\\partial_y u_y)_{i,j} = \\frac{2}{h} (u_{y,i,j+1} - u_{y,i,j-1})$.\nThe collocated divergence at node $(i,j)$ is the sum of these, which is a second-order accurate centered difference stencil:\n$$ (\\mathbf{D}_{\\text{glob}}\\mathbf{u})_{i,j} = \\frac{2}{h} (u_{x,i+1,j} - u_{x,i-1,j}) + \\frac{2}{h} (u_{y,i,j+1} - u_{y,i,j-1}) $$\nThe matrix $\\mathbf{B}$ is defined as $\\mathbf{B} = h^2 \\mathbf{D}_{\\text{glob}}$. Thus, the entries in $\\mathbf{B}$ corresponding to this stencil are $\\pm 2h$.\n\n**2. Analysis of the Spurious Pressure Mode**\nWe must test if the checkerboard pressure mode $\\mathbf{p}_{\\text{alt}}$ with components $(\\mathbf{p}_{\\text{alt}})_{i,j} = (-1)^{i+j}$ is a spurious mode. A spurious pressure mode is a non-constant pressure vector that lies in the null space of the discrete gradient operator, $\\mathbf{B}^\\top$. We compute $\\mathbf{g} = \\mathbf{B}^\\top \\mathbf{p}_{\\text{alt}}$. Let's find the component of $\\mathbf{g}$ corresponding to the velocity degree of freedom $u_{x,k,l}$:\n$$ g_{u_{x,k,l}} = (\\mathbf{B}^\\top \\mathbf{p}_{\\text{alt}})_{u_{x,k,l}} = \\sum_{i,j} B_{(i,j), u_{x,k,l}} (\\mathbf{p}_{\\text{alt}})_{i,j} $$\nThe column of $\\mathbf{B}$ for $u_{x,k,l}$ has only two non-zero entries: a value of $+2h$ in row $(k-1,l)$ and $-2h$ in row $(k+1,l)$. Therefore, the sum collapses to:\n$$ g_{u_{x,k,l}} = (+2h) (\\mathbf{p}_{\\text{alt}})_{k-1,l} + (-2h) (\\mathbf{p}_{\\text{alt}})_{k+1,l} $$\n$$ g_{u_{x,k,l}} = 2h \\left( (-1)^{(k-1)+l} - (-1)^{(k+1)+l} \\right) = 2h (-1)^{k+l} \\left( (-1)^{-1} - (-1)^{1} \\right) = 2h (-1)^{k+l} (-1 - (-1)) = 0 $$\nThe same calculation shows the components for $u_{y,k,l}$ are also zero. Thus, $\\mathbf{B}^\\top \\mathbf{p}_{\\text{alt}} = \\mathbf{0}$ exactly. This analytically confirms that the checkerboard mode is in the null space of $\\mathbf{B}^\\top$, so $\\left\\| \\mathbf{B}^\\top \\mathbf{p}_{\\text{alt}} \\right\\|_2$ should be numerically zero for all even $M$.\n\nThe number of spurious modes is the dimension of the null space of $\\mathbf{B}^\\top$ minus one (for the constant pressure mode). For this specific discretization on a periodic grid with even $M$, it is known that there are four such modes: the constant mode $(1)$, the x-checkerboard $((-1)^i)$, the y-checkerboard $((-1)^j)$, and the xy-checkerboard $((-1)^{i+j})$. The null space of $\\mathbf{B}^\\top$ has dimension 4. Therefore, the number of spurious modes is $4-1=3$. This result is independent of the mesh size $M$ (for even $M$).\n\nThe Python code implements this algebraic construction and performs the required numerical analysis (norm and SVD computation), which confirms these analytical predictions.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Constructs the discrete divergence operator for an equal-order SEM discretization\n    of the Stokes equations and identifies spurious pressure modes.\n    \"\"\"\n    test_cases = [2, 4, 8]\n    epsilon = 1e-12\n\n    b_results = []\n    c_results = []\n\n    for M in test_cases:\n        # Define grid and problem size parameters\n        h = 1.0 / M\n        n_p = M * M\n        n_u = 2 * n_p\n        \n        # 1. Assemble the discrete divergence coupling matrix B.\n        # B has dimensions n_p x n_u (M^2 x 2M^2).\n        B = np.zeros((n_p, n_u))\n\n        # Loop over each pressure degree of freedom (row of B), which corresponds \n        # to a global node (i, j).\n        for i in range(M):\n            for j in range(M):\n                # The row index corresponds to the pressure DOF at node (i, j).\n                p_idx = i * M + j\n                \n                # Determine neighbor indices with periodic boundary conditions.\n                i_p1 = (i + 1) % M\n                i_m1 = (i - 1 + M) % M\n                j_p1 = (j + 1) % M\n                j_m1 = (j - 1 + M) % M\n\n                # The problem statement defines D_glob by summing local contributions. This results\n                # in a global stencil for the divergence at node (i,j):\n                # (div u)_ij = 2/h * (u_x(i+1,j) - u_x(i-1,j)) + 2/h * (u_y(i,j+1) - u_y(i,j-1)).\n                # The matrix B is defined as B = h^2 * D_glob.\n                # The coefficients in B are thus h^2 * (±2/h) = ±2h.\n                \n                # For M=2, i_p1 becomes equal to i_m1, causing terms to cancel exactly.\n                # The code handles this case correctly, resulting in B being the zero matrix.\n\n                # u_x contributions to the divergence at (i,j)\n                # Global column index for u_x at node (i+1, j)\n                col_ux_ip1 = 2 * (i_p1 * M + j)\n                # Global column index for u_x at node (i-1, j)\n                col_ux_im1 = 2 * (i_m1 * M + j)\n                \n                B[p_idx, col_ux_ip1] += 2 * h\n                B[p_idx, col_ux_im1] -= 2 * h\n\n                # u_y contributions to the divergence at (i,j)\n                # Global column index for u_y at node (i, j+1)\n                col_uy_jp1 = 2 * (i * M + j_p1) + 1\n                # Global column index for u_y at node (i, j-1)\n                col_uy_jm1 = 2 * (i * M + j_m1) + 1\n                \n                B[p_idx, col_uy_jp1] += 2 * h\n                B[p_idx, col_uy_jm1] -= 2 * h\n        \n        # 2. Define the checkerboard pressure vector p_alt.\n        p_alt = np.zeros(n_p)\n        for idx in range(n_p):\n            i = idx // M\n            j = idx % M\n            p_alt[idx] = (-1)**(i + j)\n\n        # 3. Compute ||B^T * p_alt||_2 and check against the threshold.\n        # This vector is the discrete gradient of the checkerboard pressure.\n        Bt_p_alt = B.T @ p_alt\n        norm_Bt_p_alt = np.linalg.norm(Bt_p_alt)\n        b_M = norm_Bt_p_alt = epsilon\n\n        # 4. Compute the singular values of B to find the dimension of the null space of B^T.\n        # Spurious pressure modes correspond to vectors in the null space of B^T.\n        singular_values = np.linalg.svd(B, compute_uv=False)\n        \n        # Count singular values that are numerically zero.\n        num_zero_sv = np.sum(singular_values = epsilon)\n        \n        # The number of spurious modes is the dimension of the null space minus 1\n        # (to remove the trivial constant pressure mode).\n        c_M = num_zero_sv - 1\n        \n        b_results.append(str(b_M))\n        c_results.append(str(c_M))\n\n    # Combine results into the specified order: [b2, b4, b8, c2, c4, c8]\n    final_results = b_results + c_results\n    print(f\"[{','.join(final_results)}]\")\n\nsolve()\n```"
        }
    ]
}