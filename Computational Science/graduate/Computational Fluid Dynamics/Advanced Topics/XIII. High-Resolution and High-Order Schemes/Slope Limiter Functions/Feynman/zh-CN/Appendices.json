{
    "hands_on_practices": [
        {
            "introduction": "第一个练习将引导您使用基础的 `minmod` 限制器进行直接、分步的计算。这个练习旨在巩固核心机制：如何根据局部单元格数据确定限制斜率，并用它来重构交界面上的值——这是MUSCL格式的核心思想。通过这个具体的计算，您将对限制器如何防止在不连续点附近产生新的伪振荡有一个直观的认识。",
            "id": "3362632",
            "problem": "考虑一维空间中的线性平流守恒律 $\\partial_t U + a\\,\\partial_x U = 0$，该方程在一个间距为 $\\Delta x$、单元中心位于 $x_i$ 的均匀网格上，通过守恒的有限体积法进行离散。为在保持总变差递减 (TVD) 特性的同时实现二阶空间精度，在每个单元 $i$ 中采用分段线性重构，使用由 minmod 限制器作用于未除的单边差分得到的限制斜率 $s_i$。具体来说，设单元平均值由 $U_{i-1}=0$、$U_i=1$ 和 $U_{i+1}=2$ 给出。定义未除的后向和前向差分分别为 $\\Delta^- \\equiv U_i - U_{i-1}$ 和 $\\Delta^+ \\equiv U_{i+1} - U_i$。使用 minmod 限制器从 $\\Delta^-$ 和 $\\Delta^+$ 确定限制斜率 $s_i$，然后，对于正的平流速度 $a>0$，构建从单元 $i$ 出现在左、右界面上的界面状态，即 $U_{i-1/2}^{+}$ 和 $U_{i+1/2}^{-}$，使其与均匀网格上的分段线性重构一致。\n\n将您的最终答案以行矩阵的形式报告，按顺序包含三个量 $(s_i, U_{i-1/2}^{+}, U_{i+1/2}^{-})$。无需四舍五入。",
            "solution": "该问题要求我们使用 minmod 限制器计算给定单元数据的限制斜率和界面重构值。\n\n**1. 提取已知数据**\n*   单元平均值：$U_{i-1}=0$，$U_i=1$，$U_{i+1}=2$。\n*   平流速度 $a>0$，意味着信息从左向右传播。\n\n**2. 计算单边差分**\n根据定义，我们计算当前单元 $i$ 的后向和前向差分：\n*   后向差分：$\\Delta^- \\equiv U_i - U_{i-1} = 1 - 0 = 1$。\n*   前向差分：$\\Delta^+ \\equiv U_{i+1} - U_i = 2 - 1 = 1$。\n\n**3. 应用 Minmod 限制器**\nminmod 函数定义为：\n$$\n\\text{minmod}(a, b) = \n\\begin{cases} \n\\text{sgn}(a) \\min(|a|, |b|)  \\text{if } ab > 0 \\\\\n0  \\text{if } ab \\le 0\n\\end{cases}\n$$\n我们将差分值代入 minmod 函数来计算限制后的斜率（在此处为限制后的差分）$s_i$：\n$$\ns_i = \\text{minmod}(\\Delta^-, \\Delta^+) = \\text{minmod}(1, 1)\n$$\n由于两个参数均为正，它们符号相同，我们取绝对值较小的一个。因为它们相等，所以结果是 1。\n$$\ns_i = 1\n$$\n\n**4. 重构界面值**\n分段线性重构在单元 $i$ 内的形式为 $U(x) = U_i + \\frac{s_i}{\\Delta x}(x - x_i)$。我们需要计算在单元 $i$ 的左界面 ($x_{i-1/2}$) 和右界面 ($x_{i+1/2}$) 上的重构值。\n*   在左界面 ($x = x_{i-1/2} = x_i - \\Delta x / 2$) 上的值 $U_{i-1/2}^{+}$：\n    $$\n    U_{i-1/2}^{+} = U_i + s_i \\left(\\frac{x_{i-1/2} - x_i}{\\Delta x}\\right) = U_i + s_i \\left(\\frac{-\\Delta x / 2}{\\Delta x}\\right) = U_i - \\frac{s_i}{2}\n    $$\n    代入数值：$U_{i-1/2}^{+} = 1 - \\frac{1}{2} = \\frac{1}{2}$。\n\n*   在右界面 ($x = x_{i+1/2} = x_i + \\Delta x / 2$) 上的值 $U_{i+1/2}^{-}$：\n    $$\n    U_{i+1/2}^{-} = U_i + s_i \\left(\\frac{x_{i+1/2} - x_i}{\\Delta x}\\right) = U_i + s_i \\left(\\frac{+\\Delta x / 2}{\\Delta x}\\right) = U_i + \\frac{s_i}{2}\n    $$\n    代入数值：$U_{i+1/2}^{-} = 1 + \\frac{1}{2} = \\frac{3}{2}$。\n\n**5. 最终结果**\n按顺序将三个量 $(s_i, U_{i-1/2}^{+}, U_{i+1/2}^{-})$ 组合成行矩阵：\n$$\n(1, \\frac{1}{2}, \\frac{3}{2})\n$$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1  \\frac{1}{2}  \\frac{3}{2}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在掌握了基本计算之后，本练习将引入一种更通用的限制器表示方法——$\\phi(r)$ 框架，并探讨一种更具“压缩性”的限制器 `superbee`。此练习旨在揭示不同限制器如何表现出不同的行为，在本例中是一种“压缩”或“陡峭化”效应。理解这种效应对于在数值模拟中精确捕捉尖锐间断至关重要。",
            "id": "3362620",
            "problem": "考虑一维线性平流方程，这是一个标量守恒律，\n$$\n\\frac{\\partial U}{\\partial t} + a \\frac{\\partial U}{\\partial x} = 0\n$$\n其波速 $a>0$ 为常数，并在以 $i \\in \\mathbb{Z}$ 为索引的网格中心上进行离散化的均匀网格上求解。使用带有总变差递减（TVD）斜率限制器的二阶分段线性重构来获得左右界面状态 $U_{i+1/2}^{-}$ 和 $U_{i-1/2}^{+}$，这些状态被用于计算迎风数值通量。在高分辨率通量限制器格式中，重构使用了比率\n$$\nr_i \\equiv \\frac{U_i - U_{i-1}}{U_{i+1} - U_i},\n$$\n并结合一个限制器函数 $\\phi(r)$，通过以下方式定义单侧限制斜率和右界面处的左状态\n$$\nU_{i+1/2}^{-} = U_i + \\frac{1}{2}\\,\\phi(r_i)\\,\\left(U_i - U_{i-1}\\right),\n$$\n（此式适用于 $a>0$）。Superbee 限制器定义为\n$$\n\\phi_{\\mathrm{SB}}(r) = \\max\\!\\left(0,\\, \\min\\!\\left(2r,1\\right),\\, \\min\\!\\left(r,2\\right)\\right).\n$$\n假设局部网格平均值为 $U_{i-1}=0$，$U_i=2$，$U_{i+1}=3$。仅使用上述定义和对 $a>0$ 的迎风要求，计算 $r_i$，求出 $\\phi_{\\mathrm{SB}}(r_i)$ 的值，并构造 $U_{i+1/2}^{-}$。用一句话简要论证得到的界面状态在此配置下是否表明限制器具有压缩（陡峭化）行为。\n\n最终答案只报告 $U_{i+1/2}^{-}$ 的数值。不包括单位。不要四舍五入。",
            "solution": "该问题被验证为自洽的、有科学依据且适定的。求解所需的所有定义和数据均已提供，并且它们与守恒律数值方法的既有理论，特别是带通量限制器的有限体积法，相一致。\n\n已知条件如下：\n1.  一维线性平流方程：$\\frac{\\partial U}{\\partial t} + a \\frac{\\partial U}{\\partial x} = 0$，其中 $a > 0$。\n2.  网格平均值：$U_{i-1}=0$，$U_i=2$，$U_{i+1}=3$。\n3.  连续梯度比率的定义：$r_i \\equiv \\frac{U_i - U_{i-1}}{U_{i+1} - U_i}$。\n4.  Superbee 限制器函数：$\\phi_{\\mathrm{SB}}(r) = \\max\\!\\left(0,\\, \\min\\!\\left(2r,1\\right),\\, \\min\\!\\left(r,2\\right)\\right)$。\n5.  右界面处左状态的重构公式：$U_{i+1/2}^{-} = U_i + \\frac{1}{2}\\,\\phi(r_i)\\,\\left(U_i - U_{i-1}\\right)$。\n\n步骤是根据这些定义顺序计算所需的量。\n\n首先，我们使用给定的网格平均值计算比率 $r_i$。\n分子是迎风差分：$U_i - U_{i-1} = 2 - 0 = 2$。\n分母是顺风差分：$U_{i+1} - U_i = 3 - 2 = 1$。\n将这些值代入 $r_i$ 的定义中：\n$$\nr_i = \\frac{U_i - U_{i-1}}{U_{i+1} - U_i} = \\frac{2}{1} = 2\n$$\n\n接下来，我们在 $r=r_i=2$ 处计算 Superbee 限制器函数 $\\phi_{\\mathrm{SB}}(r)$ 的值。\n其定义为 $\\phi_{\\mathrm{SB}}(r) = \\max\\!\\left(0,\\, \\min\\!\\left(2r,1\\right),\\, \\min\\!\\left(r,2\\right)\\right)$。\n代入 $r=2$：\n$$\n\\phi_{\\mathrm{SB}}(2) = \\max\\!\\left(0,\\, \\min\\!\\left(2 \\cdot 2, 1\\right),\\, \\min\\!\\left(2, 2\\right)\\right)\n$$\n我们计算内部各项的值：\n$\\min(2 \\cdot 2, 1) = \\min(4, 1) = 1$。\n$\\min(2, 2) = 2$。\n所以表达式变为：\n$$\n\\phi_{\\mathrm{SB}}(2) = \\max(0, 1, 2) = 2\n$$\n\n最后，我们使用其定义构造界面状态 $U_{i+1/2}^{-}$，其中 $\\phi(r_i) = \\phi_{\\mathrm{SB}}(2) = 2$。\n公式为：\n$$\nU_{i+1/2}^{-} = U_i + \\frac{1}{2}\\,\\phi(r_i)\\,\\left(U_i - U_{i-1}\\right)\n$$\n代入已知值 $U_i=2$，$U_{i-1}=0$ 和 $\\phi(r_i)=2$：\n$$\nU_{i+1/2}^{-} = 2 + \\frac{1}{2} \\cdot 2 \\cdot \\left(2 - 0\\right) = 2 + 1 \\cdot 2 = 4\n$$\n\n为了论证其行为，我们观察结果。局部网格平均值为 $U_{i-1}=0$，$U_i=2$ 和 $U_{i+1}=3$。界面处的重构值 $U_{i+1/2}^{-} = 4$ 大于任何一个局部网格平均值。这种超出局部极值的外插是压缩（或陡峭化）行为的特征，这也是 Superbee 限制器在解剖面为凸（如此处，$U_i - U_{i-1} > U_{i+1} - U_i$）的区域的主要特性。\n\n问题只要求给出 $U_{i+1/2}^{-}$ 的数值。",
            "answer": "$$\n\\boxed{4}\n$$"
        },
        {
            "introduction": "最后的练习将您从手动计算带入完整的计算实现中，这是计算流体力学（CFD）从业者的最终目标。通过对一个标准测试案例编程并比较几种经典的限制器（`minmod`, `superbee`, `van Leer`），您将获得关于它们相对性能的实践洞察。同时，您也会观察到这些格式在处理理想化初始数据时的一个关键行为特性。",
            "id": "3362630",
            "problem": "考虑一维线性平流方程 $u_t + a u_x = 0$，其具有恒定的平流速度 $a > 0$。该方程在一个由 $N$ 个有限体积单元组成的均匀网格上求解，该网格覆盖空间域 $[x_{\\min}, x_{\\max}]$，单元宽度为 $\\Delta x = (x_{\\max} - x_{\\min}) / N$，单元中心为 $x_i = x_{\\min} + \\left(i + \\tfrac{1}{2}\\right)\\Delta x$（$i = 0, 1, \\dots, N-1$）。初始数据是一个陡峭的阶跃：\n$$\nu(x, 0) = \n\\begin{cases}\nu_L  x  x_0 \\\\\nu_R  x \\ge x_0\n\\end{cases}\n$$\n其中 $u_L$ 和 $u_R$ 是给定的常数，$x_0$ 是间断位置。使用带有分段线性重构的守恒型有限体积法，计算数值解的一个显式时间步。时间步长 $\\Delta t$ 由 Courant–Friedrichs–Lewy (CFL) 数 $\\lambda$ 决定，其定义为 $\\lambda = a \\Delta t / \\Delta x$，因此 $\\Delta t = \\lambda \\Delta x / a$。假设 $a > 0$，因此迎风数值通量在左侧界面状态处进行计算。\n\n从基本的有限体积更新公式开始\n$$\n\\bar{u}_i^{n+1} = \\bar{u}_i^n - \\frac{\\Delta t}{\\Delta x}\\left(F_{i+\\frac{1}{2}} - F_{i-\\frac{1}{2}}\\right),\n$$\n其中线性平流通量为 $F(u) = a u$。在每个单元中使用带有受限斜率 $\\sigma_i$ 的分段线性重构，将 $x_{i+\\frac{1}{2}}$ 处的左侧界面状态定义为\n$$\nu_{i+\\frac{1}{2}}^- = \\bar{u}_i + \\frac{1}{2}\\,\\sigma_i,\n$$\n并根据以下公式进行更新\n$$\n\\bar{u}_i^{n+1} = \\bar{u}_i^n - \\lambda \\left(u_{i+\\frac{1}{2}}^- - u_{i-\\frac{1}{2}}^-\\right).\n$$\n将不受限的后向和前向差分定义为 $\\Delta_- \\bar{u}_i = \\bar{u}_i - \\bar{u}_{i-1}$ 和 $\\Delta_+ \\bar{u}_i = \\bar{u}_{i+1} - \\bar{u}_i$，并在有意义的情况下定义比率 $r_i = \\Delta_- \\bar{u}_i / \\Delta_+ \\bar{u}_i$。斜率 $\\sigma_i$ 必须使用 Sweby 族中的以下总变差不增 (TVD) 斜率限制器函数之一来选择：\n- minmod 限制器，\n- superbee 限制器，\n- van Leer 限制器。\n\n实现所有三种限制器，并使用它们为每种限制器计算相应的三组界面状态 $u_{i+\\frac{1}{2}}^-$ 和单步更新 $\\bar{u}_i^{n+1}$。在计算 $r_i$ 时，采用一种鲁棒的约定，即如果 $\\Delta_+ \\bar{u}_i = 0$ 或 $\\Delta_- \\bar{u}_i \\cdot \\Delta_+ \\bar{u}_i \\le 0$，则该单元的限制器应返回零斜率（即 $\\sigma_i = 0$）。\n\n通过计算更新后的解 $\\bar{u}_i^{n+1}$ 严格位于左右状态附近的两个阈值之间（即 $u_{\\text{low}} + \\varepsilon$ 和 $u_{\\text{high}} - \\varepsilon$）的单元数量，来量化一个时间步后的数值激波厚度。其中 $u_{\\text{low}} = \\min(u_L, u_R)$，$u_{\\text{high}} = \\max(u_L, u_R)$，且 $\\varepsilon = 10^{-3}\\,(u_{\\text{high}} - u_{\\text{low}})$。数值激波厚度应报告为过渡单元的整数数量，无需物理单位。\n\n使用以下参数集测试套件，每个集合指定 $(N, x_{\\min}, x_{\\max}, a, \\lambda, u_L, u_R, x_0)$:\n- 测试 1：$(200, -1, 1, 1, 0.5, 1, 0, 0)$。\n- 测试 2：$(200, -1, 1, 1, 0.99, 1, 0, 0)$。\n- 测试 3：$(200, -1, 1, 1, 0.5, 1, 0.8, 0)$。\n- 测试 4：$(200, -1, 1, 1, 0.5, 0, 1, 0)$。\n\n对于每个测试，按以下顺序为每个限制器计算一个时间步后的整数数值激波厚度：minmod、superbee、van Leer。您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个元素是对应于一个测试用例的三个整数的列表。例如，输出格式必须是\n$$\n[[t_{1,\\text{mm}},t_{1,\\text{sb}},t_{1,\\text{vl}}],[t_{2,\\text{mm}},t_{2,\\text{sb}},t_{2,\\text{vl}}],[t_{3,\\text{mm}},t_{3,\\text{sb}},t_{3,\\text{vl}}],[t_{4,\\text{mm}},t_{4,\\text{sb}},t_{4,\\text{vl}}]]\n$$\n所有条目均为整数。本问题不涉及角度或百分比，报告的厚度也无需物理单位。",
            "solution": "用户要求我解决一个计算流体力学问题。\n\n我的计划如下：\n1.  **验证问题陈述**：我需要完成强制性验证清单。\n    *   **第1步：提取已知条件**：我将列出问题中提供的所有方程、定义、参数和测试用例。\n    *   **第2步：使用提取的已知条件进行验证**：我将检查科学合理性、适定性、客观性、完整性等。该问题似乎描述了一种求解线性平流方程的标准高分辨率有限体积法。这是偏微分方程计算方法中的一个经典课题。数值格式、斜率限制器以及激波厚度的度量标准都是标准且明确定义的。\n    *   **第3步：结论和行动**：如果问题有效，我将继续求解。如果无效，我将说明原因并终止。\n\n2.  **求解问题（如果有效）**：\n    *   **概念大纲**：问题的核心是为一维线性平流方程实现一个二阶有限体积格式。一个时间步的关键步骤如下：\n        1.  **离散化区域**：建立单元中心 $x_i$ 和单元宽度 $\\Delta x$ 的网格。\n        2.  **初始化解**：将初始条件 $u(x, 0)$ 投影到网格上，得到初始单元平均值 $\\bar{u}_i^n$。由于初始条件是阶跃函数，单元平均值 $\\bar{u}_i^0$ 是 $u(x, 0)$ 在单元 $[x_i - \\Delta x/2, x_i + \\Delta x/2]$ 上的平均值。\n        3.  **遍历单元计算斜率**：对每个内部单元 $i$，我需要计算比率 $r_i = (\\bar{u}_i - \\bar{u}_{i-1}) / (\\bar{u}_{i+1} - \\bar{u}_i)$。\n        4.  **应用斜率限制器**：使用计算出的 $r_i$ 来找到 minmod、superbee 和 van Leer 的限制器函数 $\\phi(r_i)$。\n        5.  **计算受限斜率**：受限斜率为 $\\sigma_i = \\phi(r_i) \\Delta_+ \\bar{u}_i$。请注意，问题陈述似乎将斜率定义为对单元平均值的修正，而非物理斜率。重构为 $u(x) = \\bar{u}_i + \\frac{\\sigma_i}{\\Delta x}(x - x_i)$。在界面 $x_{i+1/2}$ 处的值为 $u_{i+1/2}^- = \\bar{u}_i + \\frac{\\sigma_i}{\\Delta x}(x_{i+1/2} - x_i) = \\bar{u}_i + \\frac{\\sigma_i}{\\Delta x}(\\frac{\\Delta x}{2}) = \\bar{u}_i + \\frac{1}{2}\\sigma_i$。这与问题陈述相符。这意味着 $\\sigma_i$ 本身不是斜率，而是 $\\sigma_i = s_i \\Delta x$，其中 $s_i$ 是斜率。问题以差分形式定义了 $\\sigma_i$，所以我们遵循其定义。\n        限制器 $\\phi(r)$ 的形式如下：\n        *   **Minmod**：$\\phi_{\\text{mm}}(r) = \\max(0, \\min(1, r))$。\n        *   **Superbee**：$\\phi_{\\text{sb}}(r) = \\max(0, \\min(2, r), \\min(1, 2r))$。\n        *   **Van Leer**：$\\phi_{\\text{vl}}(r) = \\frac{r + |r|}{1 + r}$。对于 $r \\le 0$，该值为 $0$。对于 $r>0$，该值为 $\\frac{2r}{1+r}$。\n        问题还有一个条件：`如果 $\\Delta_+ \\bar{u}_i = 0$ 或 $\\Delta_- \\bar{u}_i \\cdot \\Delta_+ \\bar{u}_i \\le 0$，则该单元的限制器应返回零斜率（即 $\\sigma_i = 0$）`。这个条件通过限制器函数 $\\phi(r)$ 的标准形式自然处理，这些函数在 $r \\le 0$ 时值为零，并通过对分母 $\\Delta_+ \\bar{u}_i = 0$ 的显式检查来处理。\n        6.  **计算界面值**：$u_{i+1/2}^- = \\bar{u}_i + \\frac{1}{2}\\sigma_i$。\n        7.  **时间更新**：$\\bar{u}_i^{n+1} = \\bar{u}_i^n - \\lambda (u_{i+1/2}^- - u_{i-1/2}^-)$。\n        8.  **边界条件**：对于单元 $i=0$ 和 $i=N-1$ 的斜率计算，需要虚拟单元。给定 $a>0$，信息从左向右传播。一个标准的边界条件选择是在左侧虚拟单元（$i=-1$）中设置值为流入值 $\\bar{u}_{-1} = u_L$，并对右侧虚拟单元（$i=N$）使用零阶外推，即 $\\bar{u}_N = \\bar{u}_{N-1}$。通过区域左边界 $x_{-1/2}$ 的通量由流入条件决定，因此那里的重构值为 $u_{-1/2}^- = u_L$。\n        9.  **量化激波厚度**：计算更新后的解 $\\bar{u}_i^{n+1}$ 严格介于 $u_{\\text{low}} + \\varepsilon$ 和 $u_{\\text{high}} - \\varepsilon$ 之间的单元数量。\n\n我对测试用例的分析表明，由于网格参数和间断位置 $x_0=0$ 的特定选择，投影到网格上的初始条件导致了一个正好位于单元界面上的完美陡峭阶跃。这种特定配置导致所有单元和所有三种限制器的斜率都为零（$\\sigma_i=0$）。因此，对于第一个时间步，高分辨率格式退化为一阶迎风（Godunov）格式，从而对 minmod、superbee 和 van Leer 产生相同的结果。因此，该问题是有效的，但突显了一种特定情况，即这些限制器之间没有差异。我将采用这个正确但可能有些反直觉的结果继续。\n\n---\n### 第1步：问题验证\n\n#### 第1.1步：提取已知条件\n- **方程**：一维线性平流方程，$u_t + a u_x = 0$，具有恒定速度 $a > 0$。\n- **网格**：均匀，$N$ 个单元，区域 $[x_{\\min}, x_{\\max}]$，单元宽度 $\\Delta x = (x_{\\max} - x_{\\min}) / N$，单元中心 $x_i = x_{\\min} + \\left(i + \\tfrac{1}{2}\\right)\\Delta x$（$i = 0, \\dots, N-1$）。\n- **初始条件**：阶跃函数，$u(x, 0) = u_L$（$x  x_0$）和 $u(x, 0) = u_R$（$x \\ge x_0$）。\n- **数值方法**：守恒型有限体积更新：$\\bar{u}_i^{n+1} = \\bar{u}_i^n - \\frac{\\Delta t}{\\Delta x}\\left(F_{i+\\frac{1}{2}} - F_{i-\\frac{1}{2}}\\right)$。\n- **时间步长**：$\\Delta t = \\lambda \\Delta x / a$，其中 $\\lambda$ 是 CFL 数。\n- **通量**：对于 $a>0$ 的迎风通量是 $F_{i+\\frac{1}{2}} = a u_{i+\\frac{1}{2}}^-$。\n- **重构**：分段线性，$u_{i+\\frac{1}{2}}^- = \\bar{u}_i + \\frac{1}{2}\\sigma_i$。\n- **最终更新公式**：$\\bar{u}_i^{n+1} = \\bar{u}_i^n - \\lambda \\left(u_{i+\\frac{1}{2}}^- - u_{i-\\frac{1}{2}}^-\\right)$。\n- **斜率限制器定义**：\n    - 差分：$\\Delta_- \\bar{u}_i = \\bar{u}_i - \\bar{u}_{i-1}$，$\\Delta_+ \\bar{u}_i = \\bar{u}_{i+1} - \\bar{u}_i$。\n    - 比率：$r_i = \\Delta_- \\bar{u}_i / \\Delta_+ \\bar{u}_i$。\n    - 斜率 $\\sigma_i$ 使用 minmod、superbee 或 van Leer 限制器计算。\n    - 条件：如果 $\\Delta_+ \\bar{u}_i = 0$ 或 $\\Delta_- \\bar{u}_i \\cdot \\Delta_+ \\bar{u}_i \\le 0$，则 $\\sigma_i = 0$。\n- **输出度量**：数值激波厚度，定义为满足 $u_{\\text{low}} + \\varepsilon  \\bar{u}_i^{n+1}  u_{\\text{high}} - \\varepsilon$ 的单元数，其中 $u_{\\text{low}} = \\min(u_L, u_R)$，$u_{\\text{high}} = \\max(u_L, u_R)$，且 $\\varepsilon = 10^{-3}(u_{\\text{high}} - u_{\\text{low}})$。\n- **测试用例**：\n    1. $(N, x_{\\min}, x_{\\max}, a, \\lambda, u_L, u_R, x_0) = (200, -1, 1, 1, 0.5, 1, 0, 0)$。\n    2. $(N, x_{\\min}, x_{\\max}, a, \\lambda, u_L, u_R, x_0) = (200, -1, 1, 1, 0.99, 1, 0, 0)$。\n    3. $(N, x_{\\min}, x_{\\max}, a, \\lambda, u_L, u_R, x_0) = (200, -1, 1, 1, 0.5, 1, 0.8, 0)$。\n    4. $(N, x_{\\min}, x_{\\max}, a, \\lambda, u_L, u_R, x_0) = (200, -1, 1, 1, 0.5, 0, 1, 0)$。\n- **输出格式**：`[[t1_mm,t1_sb,t1_vl],[t2_mm,t2_sb,t2_vl],[t3_mm,t3_sb,t3_vl],[t4_mm,t4_sb,t4_vl]]`。\n\n#### 第1.2步：使用提取的已知条件进行验证\n1.  **科学基础**：该问题描述了一种求解线性双曲型偏微分方程的标准高分辨率有限体积法（MUSCL格式）。方程、限制器函数（minmod、superbee、van Leer）和数值概念（CFL条件、TVD性质）都是计算流体力学和数值分析中的基本且成熟的内容。该问题在科学上是合理的。\n2.  **适定性**：该问题是适定的。具有阶跃初始条件的线性平流方程有唯一、稳定的解（一个平移的阶跃）。数值方法是标准的。边界条件没有明确说明，这可能是一个模糊点。然而，对于 $a>0$ 的线性平流问题，标准且明确的选择是在左边界（$x_{\\min}$）设置流入条件，在右边界（$x_{\\max}$）设置流出条件。假设采用这些标准实践，该问题是适定的。\n3.  **客观性**：问题以精确的数学和算法术语陈述。待计算的量由客观公式定义，测试参数是明确的。\n4.  **完整性和一致性**：在对边界条件进行标准解释的情况下，该问题是自洽的，没有矛盾。提供的更新公式 $\\bar{u}_i^{n+1} = \\bar{u}_i^n - \\lambda (u_{i+\\frac{1}{2}}^- - u_{i-\\frac{1}{2}}^-)$ 是一个轻微的简化，因为右侧项应为 $u_{i-\\frac{1}{2}}^- = \\bar{u}_{i-1} + \\frac{1}{2}\\sigma_{i-1}$，但这代表了迎风格式的常见实现选择，并不构成不一致。\n5.  **未检测到其他缺陷**：问题并非微不足道或同义反复，尽管特定的测试数据导致了简化的结果。它是对正确实现的一个有效测试。\n\n#### 第1.3步：结论和行动\n该问题是**有效的**。继续求解。\n\n### 第2步：求解\n\n该问题要求实现一个二阶精度、TVD的有限体积格式来求解一维线性平流方程 $u_t + a u_x = 0$（$a>0$）。对几个测试用例，解推进一个时间步，并量化数值激波的厚度。该方法的核心是在每个单元内对解进行分段线性重构，其中重构的斜率受到限制以防止在间断附近产生伪振荡。\n\n**1. 离散化和初始条件**\n对于所有测试用例，区域为 $[x_{\\min}, x_{\\max}] = [-1, 1]$，有 $N=200$ 个单元。单元宽度为 $\\Delta x = (1 - (-1))/200 = 0.01$。单元界面位于 $x_{i-1/2} = -1 + i \\Delta x$。初始间断在 $x_0=0$。\n对应于 $i=100$ 的单元界面位于 $x_{99.5} = -1 + 100 \\times 0.01 = 0$。因此，间断与单元边界完全对齐。\n初始条件为 $u(x,0) = u_L$（$x0$）和 $u(x,0) = u_R$（$x \\ge 0$）。\n单元 $i$ 的初始单元平均值 $\\bar{u}_i^0$ 是 $u(x,0)$ 在单元区域 $[x_{i-1/2}, x_{i+1/2}]$ 上的平均值。\n- 对于单元 $i100$，区域完全在 $x0$ 内，因此 $\\bar{u}_i^0 = u_L$。\n- 对于单元 $i \\ge 100$，区域完全在 $x \\ge 0$ 内，因此 $\\bar{u}_i^0 = u_R$。\n初始离散解是网格上的一个完美阶跃函数：$\\bar{u}_i^0 = u_L$（$i \\le 99$）和 $\\bar{u}_i^0 = u_R$（$i \\ge 100$）。\n\n**2. 斜率限制**\n单元 $i$ 中的受限斜率 $\\sigma_i$ 是基于连续网格差分的比率 $r_i = \\Delta_- \\bar{u}_i / \\Delta_+ \\bar{u}_i = (\\bar{u}_i - \\bar{u}_{i-1}) / (\\bar{u}_{i+1} - \\bar{u}_i)$ 来计算的。三种限制器通过一个函数 $\\phi(r)$ 定义，使得 $\\sigma_i = \\phi(r_i) \\Delta_+ \\bar{u}_i$。\n- **Minmod**：$\\phi_{\\text{mm}}(r) = \\max(0, \\min(1, r))$。\n- **Superbee**：$\\phi_{\\text{sb}}(r) = \\max(0, \\min(1, 2r), \\min(2, r))$。\n- **Van Leer**：$\\phi_{\\text{vl}}(r) = \\frac{r + |r|}{1+r}$（$r>0$），否则为 $0$。\n\n对于初始网格数据，它是一个完美的阶跃（`..., u_L, u_L, u_R, u_R, ...`），让我们分析斜率。阶跃发生在单元 $i=99$ 和 $i=100$ 之间。\n- 对于任何单元 $i \\le 98$，其邻居具有相同的值 $u_L$。因此，$\\Delta_- \\bar{u}_i = 0$ 且 $\\Delta_+ \\bar{u}_i = 0$。斜率 $\\sigma_i=0$。\n- 对于单元 $i=99$：$\\bar{u}_{98}=u_L, \\bar{u}_{99}=u_L, \\bar{u}_{100}=u_R$。\n  $\\Delta_-\\bar{u}_{99} = \\bar{u}_{99} - \\bar{u}_{98} = u_L - u_L = 0$。\n  $\\Delta_+\\bar{u}_{99} = \\bar{u}_{100} - \\bar{u}_{99} = u_R - u_L$。\n  比率为 $r_{99} = 0 / (u_R - u_L) = 0$（假设 $u_R \\ne u_L$）。对于 $r=0$，所有限制器函数都给出 $\\phi(0)=0$。因此，$\\sigma_{99}=0$。\n- 对于单元 $i=100$：$\\bar{u}_{99}=u_L, \\bar{u}_{100}=u_R, \\bar{u}_{101}=u_R$。\n  $\\Delta_+\\bar{u}_{100} = \\bar{u}_{101} - \\bar{u}_{100} = u_R - u_R = 0$。\n  根据问题规则，如果 $\\Delta_+ \\bar{u}_i = 0$，则 $\\sigma_i = 0$。因此，$\\sigma_{100}=0$。\n- 对于任何单元 $i \\ge 101$，其邻居具有相同的值 $u_R$，因此 $\\sigma_i=0$。\n\n关键是，对于所有单元 $i=0, \\dots, N-1$ 和所有三种限制器选择，计算出的斜率都是 $\\sigma_i=0$。这是初始条件在网格上完全陡峭的直接结果。\n\n**3. 时间更新**\n由于所有斜率 $\\sigma_i=0$，界面处的重构简化为 $u_{i+\\frac{1}{2}}^- = \\bar{u}_i + \\frac{1}{2}(0) = \\bar{u}_i$。该格式退化为一阶迎风（Godunov）方法。\n更新公式变为：\n$\\bar{u}_i^{n+1} = \\bar{u}_i^n - \\lambda (u_{i+\\frac{1}{2}}^- - u_{i-\\frac{1}{2}}^-) = \\bar{u}_i^n - \\lambda (\\bar{u}_i^n - \\bar{u}_{i-1}^n)$。\n这个更新对于所有三种限制器都是相同的。\n- 对于 $i \\le 99$，$\\bar{u}_i^n = \\bar{u}_{i-1}^n = u_L$。更新为 $\\bar{u}_i^{n+1} = u_L - \\lambda(u_L-u_L) = u_L$。（在 $i=0$ 处，流入边界条件给出 $\\bar{u}_{-1}=u_L$，得到相同的结果）。\n- 对于 $i \\ge 101$，$\\bar{u}_i^n = \\bar{u}_{i-1}^n = u_R$。更新为 $\\bar{u}_i^{n+1} = u_R - \\lambda(u_R-u_R) = u_R$。\n- 对于 $i=100$，$\\bar{u}_{100}^n=u_R$ 且 $\\bar{u}_{99}^n=u_L$。更新产生一个新的中间状态：\n  $\\bar{u}_{100}^{n+1} = \\bar{u}_{100}^n - \\lambda(\\bar{u}_{100}^n - \\bar{u}_{99}^n) = u_R - \\lambda(u_R - u_L)$。\n\n**4. 激波厚度计算**\n我们将此应用于每个测试用例，以找出过渡单元 $i=100$ 中的值，然后计算落在阈值之间的单元数。\n阈值为 $T_{\\text{low}} = u_{\\text{low}} + \\varepsilon$ 和 $T_{\\text{high}} = u_{\\text{high}} - \\varepsilon$。\n- **测试 1**：$(u_L, u_R, \\lambda) = (1, 0, 0.5)$。\n  $\\bar{u}_{100}^{n+1} = 0 - 0.5(0-1) = 0.5$。新状态为 $\\{..., 1, 1, 0.5, 0, 0, ...\\}$。\n  $u_{\\text{low}}=0, u_{\\text{high}}=1, \\varepsilon=0.001$。阈值为 $(0.001, 0.999)$。\n  只有 $\\bar{u}_{100}^{n+1}=0.5$ 在此范围内。厚度 $= 1$。\n- **测试 2**：$(u_L, u_R, \\lambda) = (1, 0, 0.99)$。\n  $\\bar{u}_{100}^{n+1} = 0 - 0.99(0-1) = 0.99$。新状态为 $\\{..., 1, 1, 0.99, 0, 0, ...\\}$。\n  $u_{\\text{low}}=0, u_{\\text{high}}=1, \\varepsilon=0.001$。阈值为 $(0.001, 0.999)$。\n  $\\bar{u}_{100}^{n+1}=0.99$ 在此范围内。厚度 $= 1$。\n- **测试 3**：$(u_L, u_R, \\lambda) = (1, 0.8, 0.5)$。\n  $\\bar{u}_{100}^{n+1} = 0.8 - 0.5(0.8-1) = 0.8 + 0.1 = 0.9$。新状态为 $\\{..., 1, 1, 0.9, 0.8, 0.8, ...\\}$。\n  $u_{\\text{low}}=0.8, u_{\\text{high}}=1, \\varepsilon=0.0002$。阈值为 $(0.8002, 0.9998)$。\n  $\\bar{u}_{100}^{n+1}=0.9$ 在此范围内。厚度 $= 1$。\n- **测试 4**：$(u_L, u_R, \\lambda) = (0, 1, 0.5)$。\n  $\\bar{u}_{100}^{n+1} = 1 - 0.5(1-0) = 0.5$。新状态为 $\\{..., 0, 0, 0.5, 1, 1, ...\\}$。\n  $u_{\\text{low}}=0, u_{\\text{high}}=1, \\varepsilon=0.001$。阈值为 $(0.001, 0.999)$。\n  $\\bar{u}_{100}^{n+1}=0.5$ 在此范围内。厚度 $= 1$。\n\n在所有四个测试用例中，一个时间步后的数值激波厚度对于所有三种限制器都为 $1$。这导致最终结果为 `[[1,1,1],[1,1,1],[1,1,1],[1,1,1]]`。",
            "answer": "$$\n\\text{[[1,1,1],[1,1,1],[1,1,1],[1,1,1]]}\n$$"
        }
    ]
}