{
    "hands_on_practices": [
        {
            "introduction": "The heart of the Flux Reconstruction (FR) method lies in its unique procedure for constructing a high-order, continuous flux function from a discontinuous solution representation within each element. This foundational exercise guides you through the essential mechanics of this process from first principles. By manually constructing the differentiation matrix for a simple case, you will gain a concrete understanding of how the FR framework translates discrete solution point values into the flux derivatives that drive the simulation forward .",
            "id": "3320594",
            "problem": "Consider the one-dimensional reference element $\\xi \\in [-1,1]$ for the scalar conservation law $\\partial_{t} u + \\partial_{\\xi} f(u) = 0$, where the flux function is $f(u) = u$. In the Flux Reconstruction (FR) unifying framework, reconstruct a polynomial flux using $p+2$ flux points from the solution represented at $p+1$ solution points. Let $p=2$, with solution points located at $\\xi = -1, 0, 1$ and flux points located at $\\xi = -1, -\\frac{1}{2}, \\frac{1}{2}, 1$. Assume periodicity or matched common interface fluxes so that the boundary corrections vanish on this single reference element; equivalently, use the interpolated local flux at the boundaries.\n\nDefine the degree-$p$ solution interpolant $u(\\xi)$ via Lagrange polynomials at the solution points, evaluate the flux $f(u)$ at the flux points, reconstruct the degree-$p+1$ flux polynomial by Lagrange interpolation on the flux points, and then compute its derivative at the solution points. Derive, from first principles, the differentiation matrix $\\mathbf{D} \\in \\mathbb{R}^{3 \\times 3}$ such that the vector of derivatives of the reconstructed flux at the solution points, $\\left[\\partial_{\\xi} F(-1), \\partial_{\\xi} F(0), \\partial_{\\xi} F(1)\\right]^{\\mathsf{T}}$, is equal to $\\mathbf{D} \\left[u(-1), u(0), u(1)\\right]^{\\mathsf{T}}$.\n\nExpress all entries of the differentiation matrix as exact rational numbers. No rounding is required, and no physical units are involved in the final expression.",
            "solution": "The objective is to derive the differentiation matrix $\\mathbf{D} \\in \\mathbb{R}^{3 \\times 3}$, which maps the vector of solution values at the solution points, $\\mathbf{u}_S = \\left[u(-1), u(0), u(1)\\right]^{\\mathsf{T}}$, to the vector of reconstructed flux derivatives at the same points, $\\mathbf{F}'_S = \\left[\\partial_{\\xi} F(-1), \\partial_{\\xi} F(0), \\partial_{\\xi} F(1)\\right]^{\\mathsf{T}}$, according to the relationship $\\mathbf{F}'_S = \\mathbf{D} \\mathbf{u}_S$. The derivation will follow the steps outlined in the problem statement.\n\nThe polynomial degree is $p=2$. The solution points are $\\xi_S = \\{-1, 0, 1\\}$, and the flux points are $\\xi_F = \\{-1, -\\frac{1}{2}, \\frac{1}{2}, 1\\}$. The flux function is $f(u) = u$.\n\nStep 1: Define the degree-$p$ solution interpolant $u(\\xi)$.\nThe solution is represented by a degree $p=2$ polynomial, $u(\\xi)$, which interpolates the solution values $u_0 = u(-1)$, $u_1 = u(0)$, and $u_2 = u(1)$ at the solution points $\\xi_{S,0}=-1$, $\\xi_{S,1}=0$, $\\xi_{S,2}=1$. Using Lagrange interpolation:\n$$u(\\xi) = \\sum_{i=0}^{2} u_i L_{S,i}(\\xi)$$\nwhere $L_{S,i}(\\xi)$ are the Lagrange basis polynomials for the solution points:\n$L_{S,0}(\\xi) = \\frac{(\\xi - 0)(\\xi - 1)}{(-1 - 0)(-1 - 1)} = \\frac{1}{2}(\\xi^2 - \\xi)$\n$L_{S,1}(\\xi) = \\frac{(\\xi - (-1))(\\xi - 1)}{(0 - (-1))(0 - 1)} = 1 - \\xi^2$\n$L_{S,2}(\\xi) = \\frac{(\\xi - (-1))(\\xi - 0)}{(1 - (-1))(1 - 0)} = \\frac{1}{2}(\\xi^2 + \\xi)$\nThus, the solution interpolant is:\n$$u(\\xi) = u_0 \\left(\\frac{1}{2}(\\xi^2 - \\xi)\\right) + u_1 \\left(1 - \\xi^2\\right) + u_2 \\left(\\frac{1}{2}(\\xi^2 + \\xi)\\right)$$\n\nStep 2: Evaluate the flux $f(u)$ at the flux points.\nThe flux function is $f(u) = u$, so the flux values at any location $\\xi$ are simply $f(u(\\xi)) = u(\\xi)$. We evaluate these at the four flux points $\\xi_{F,0}=-1$, $\\xi_{F,1}=-1/2$, $\\xi_{F,2}=1/2$, $\\xi_{F,3}=1$. Let the vector of flux values be $\\mathbf{f}_F = [f_0, f_1, f_2, f_3]^{\\mathsf{T}}$.\n$f_0 = u(-1) = u_0$\n$f_1 = u(-1/2) = u_0 \\frac{1}{2}(\\frac{1}{4}+\\frac{1}{2}) + u_1(1-\\frac{1}{4}) + u_2 \\frac{1}{2}(\\frac{1}{4}-\\frac{1}{2}) = \\frac{3}{8}u_0 + \\frac{3}{4}u_1 - \\frac{1}{8}u_2$\n$f_2 = u(1/2) = u_0 \\frac{1}{2}(\\frac{1}{4}-\\frac{1}{2}) + u_1(1-\\frac{1}{4}) + u_2 \\frac{1}{2}(\\frac{1}{4}+\\frac{1}{2}) = -\\frac{1}{8}u_0 + \\frac{3}{4}u_1 + \\frac{3}{8}u_2$\n$f_3 = u(1) = u_2$\nThis relationship can be expressed in matrix form as $\\mathbf{f}_F = \\mathbf{M} \\mathbf{u}_S$:\n$$\\begin{pmatrix} f_0 \\\\ f_1 \\\\ f_2 \\\\ f_3 \\end{pmatrix} = \\begin{pmatrix} 1 & 0 & 0 \\\\ \\frac{3}{8} & \\frac{3}{4} & -\\frac{1}{8} \\\\ -\\frac{1}{8} & \\frac{3}{4} & \\frac{3}{8} \\\\ 0 & 0 & 1 \\end{pmatrix} \\begin{pmatrix} u_0 \\\\ u_1 \\\\ u_2 \\end{pmatrix}$$\n\nStep 3: Reconstruct the degree-$p+1$ flux polynomial $F(\\xi)$.\nThe flux polynomial $F(\\xi)$ is of degree $p+1=3$ and interpolates the flux values $\\mathbf{f}_F$ at the flux points $\\xi_F$. Using Lagrange interpolation:\n$$F(\\xi) = \\sum_{j=0}^{3} f_j L_{F,j}(\\xi)$$\nwhere $L_{F,j}(\\xi)$ are the Lagrange basis polynomials for the flux points.\n\nStep 4: Compute the derivative of the reconstructed flux at the solution points.\nThe derivative of the flux polynomial is:\n$$\\partial_{\\xi} F(\\xi) = \\sum_{j=0}^{3} f_j \\frac{d L_{F,j}}{d\\xi}(\\xi)$$\nWe require the values of this derivative at the solution points $\\xi_S=\\{-1, 0, 1\\}$. This can be written as a matrix-vector product, $\\mathbf{F}'_S = \\mathbf{L}' \\mathbf{f}_F$, where $\\mathbf{L}'$ is a $3 \\times 4$ matrix whose entries are $\\mathbf{L}'_{ij} = \\frac{d L_{F,j}}{d\\xi}(\\xi_{S,i})$. Let's evaluate the derivatives of the flux basis polynomials $L_{F,j}(\\xi)$ at the solution points.\nThe derivatives of the basis polynomials are:\n$\\frac{d L_{F,0}}{d\\xi} = \\frac{d}{d\\xi} \\left( -\\frac{2}{3}(\\xi^3 - \\xi^2 - \\frac{1}{4}\\xi + \\frac{1}{4}) \\right) = -\\frac{2}{3}(3\\xi^2 - 2\\xi - \\frac{1}{4})$\n$\\frac{d L_{F,1}}{d\\xi} = \\frac{d}{d\\xi} \\left( \\frac{4}{3}(\\xi^3 - \\frac{1}{2}\\xi^2 - \\xi + \\frac{1}{2}) \\right) = \\frac{4}{3}(3\\xi^2 - \\xi - 1)$\n$\\frac{d L_{F,2}}{d\\xi} = \\frac{d}{d\\xi} \\left( -\\frac{4}{3}(\\xi^3 + \\frac{1}{2}\\xi^2 - \\xi - \\frac{1}{2}) \\right) = -\\frac{4}{3}(3\\xi^2 + \\xi - 1)$\n$\\frac{d L_{F,3}}{d\\xi} = \\frac{d}{d\\xi} \\left( \\frac{2}{3}(\\xi^3 + \\xi^2 - \\frac{1}{4}\\xi - \\frac{1}{4}) \\right) = \\frac{2}{3}(3\\xi^2 + 2\\xi - \\frac{1}{4})$\n\nEvaluating these at $\\xi_S = \\{-1, 0, 1\\}$:\nFor $\\xi = -1$:\n$\\frac{d L_{F,0}}{d\\xi}(-1) = -\\frac{2}{3}(3+2-\\frac{1}{4}) = -\\frac{19}{6}$, $\\frac{d L_{F,1}}{d\\xi}(-1) = \\frac{4}{3}(3+1-1) = 4$, $\\frac{d L_{F,2}}{d\\xi}(-1) = -\\frac{4}{3}(3-1-1) = -\\frac{4}{3}$, $\\frac{d L_{F,3}}{d\\xi}(-1) = \\frac{2}{3}(3-2-\\frac{1}{4}) = \\frac{1}{2}$.\nFor $\\xi = 0$:\n$\\frac{d L_{F,0}}{d\\xi}(0) = -\\frac{2}{3}(-\\frac{1}{4}) = \\frac{1}{6}$, $\\frac{d L_{F,1}}{d\\xi}(0) = \\frac{4}{3}(-1) = -\\frac{4}{3}$, $\\frac{d L_{F,2}}{d\\xi}(0) = -\\frac{4}{3}(-1) = \\frac{4}{3}$, $\\frac{d L_{F,3}}{d\\xi}(0) = \\frac{2}{3}(-\\frac{1}{4}) = -\\frac{1}{6}$.\nFor $\\xi = 1$:\n$\\frac{d L_{F,0}}{d\\xi}(1) = -\\frac{2}{3}(3-2-\\frac{1}{4}) = -\\frac{1}{2}$, $\\frac{d L_{F,1}}{d\\xi}(1) = \\frac{4}{3}(3-1-1) = \\frac{4}{3}$, $\\frac{d L_{F,2}}{d\\xi}(1) = -\\frac{4}{3}(3+1-1) = -4$, $\\frac{d L_{F,3}}{d\\xi}(1) = \\frac{2}{3}(3+2-\\frac{1}{4}) = \\frac{19}{6}$.\n\nThis gives the matrix $\\mathbf{L}'$:\n$$\\mathbf{L}' = \\begin{pmatrix} -\\frac{19}{6} & 4 & -\\frac{4}{3} & \\frac{1}{2} \\\\ \\frac{1}{6} & -\\frac{4}{3} & \\frac{4}{3} & -\\frac{1}{6} \\\\ -\\frac{1}{2} & \\frac{4}{3} & -4 & \\frac{19}{6} \\end{pmatrix}$$\n\nFinally, derive the differentiation matrix $\\mathbf{D}$.\nWe have $\\mathbf{F}'_S = \\mathbf{L}' \\mathbf{f}_F$ and $\\mathbf{f}_F = \\mathbf{M} \\mathbf{u}_S$. Combining these yields $\\mathbf{F}'_S = (\\mathbf{L}' \\mathbf{M}) \\mathbf{u}_S$. The differentiation matrix is therefore $\\mathbf{D} = \\mathbf{L}' \\mathbf{M}$.\n$$\\mathbf{D} = \\begin{pmatrix} -\\frac{19}{6} & 4 & -\\frac{4}{3} & \\frac{1}{2} \\\\ \\frac{1}{6} & -\\frac{4}{3} & \\frac{4}{3} & -\\frac{1}{6} \\\\ -\\frac{1}{2} & \\frac{4}{3} & -4 & \\frac{19}{6} \\end{pmatrix} \\begin{pmatrix} 1 & 0 & 0 \\\\ \\frac{3}{8} & \\frac{3}{4} & -\\frac{1}{8} \\\\ -\\frac{1}{8} & \\frac{3}{4} & \\frac{3}{8} \\\\ 0 & 0 & 1 \\end{pmatrix}$$\nPerforming the matrix multiplication:\n$D_{11} = (-\\frac{19}{6})(1) + (4)(\\frac{3}{8}) + (-\\frac{4}{3})(-\\frac{1}{8}) = -\\frac{19}{6} + \\frac{3}{2} + \\frac{1}{6} = -\\frac{18}{6} + \\frac{3}{2} = -3 + \\frac{3}{2} = -\\frac{3}{2}$\n$D_{12} = (4)(\\frac{3}{4}) + (-\\frac{4}{3})(\\frac{3}{4}) = 3 - 1 = 2$\n$D_{13} = (4)(-\\frac{1}{8}) + (-\\frac{4}{3})(\\frac{3}{8}) + (\\frac{1}{2})(1) = -\\frac{1}{2} - \\frac{1}{2} + \\frac{1}{2} = -\\frac{1}{2}$\n\n$D_{21} = (\\frac{1}{6})(1) + (-\\frac{4}{3})(\\frac{3}{8}) + (\\frac{4}{3})(-\\frac{1}{8}) = \\frac{1}{6} - \\frac{1}{2} - \\frac{1}{6} = -\\frac{1}{2}$\n$D_{22} = (-\\frac{4}{3})(\\frac{3}{4}) + (\\frac{4}{3})(\\frac{3}{4}) = -1 + 1 = 0$\n$D_{23} = (-\\frac{4}{3})(-\\frac{1}{8}) + (\\frac{4}{3})(\\frac{3}{8}) + (-\\frac{1}{6})(1) = \\frac{1}{6} + \\frac{1}{2} - \\frac{1}{6} = \\frac{1}{2}$\n\n$D_{31} = (-\\frac{1}{2})(1) + (\\frac{4}{3})(\\frac{3}{8}) + (-4)(-\\frac{1}{8}) = -\\frac{1}{2} + \\frac{1}{2} + \\frac{1}{2} = \\frac{1}{2}$\n$D_{32} = (\\frac{4}{3})(\\frac{3}{4}) + (-4)(\\frac{3}{4}) = 1 - 3 = -2$\n$D_{33} = (\\frac{4}{3})(-\\frac{1}{8}) + (-4)(\\frac{3}{8}) + (\\frac{19}{6})(1) = -\\frac{1}{6} - \\frac{3}{2} + \\frac{19}{6} = \\frac{18}{6} - \\frac{3}{2} = 3 - \\frac{3}{2} = \\frac{3}{2}$\n\nThe resulting differentiation matrix $\\mathbf{D}$ is:\n$$\\mathbf{D} = \\begin{pmatrix} -\\frac{3}{2} & 2 & -\\frac{1}{2} \\\\ -\\frac{1}{2} & 0 & \\frac{1}{2} \\\\ \\frac{1}{2} & -2 & \\frac{3}{2} \\end{pmatrix}$$",
            "answer": "$$ \\boxed{ \\begin{pmatrix} -\\frac{3}{2} & 2 & -\\frac{1}{2} \\\\ -\\frac{1}{2} & 0 & \\frac{1}{2} \\\\ \\frac{1}{2} & -2 & \\frac{3}{2} \\end{pmatrix} } $$"
        },
        {
            "introduction": "Moving from abstract theory to practical application, this problem addresses one of the most critical aspects of computational fluid dynamics: the treatment of physical boundaries. For complex nonlinear systems like the Euler equations, boundary conditions cannot be imposed naively. This practice demonstrates the weak imposition of boundary conditions using characteristic theory, a sophisticated and robust technique central to high-order methods like FR . Deriving the subsonic inflow state for the Euler equations connects the FR framework's numerical flux mechanism to the fundamental physics of wave propagation in compressible flow.",
            "id": "3320624",
            "problem": "Consider the one-dimensional inviscid compressible Euler equations for an ideal gas with constant ratio of specific heats $\\gamma$, written in conservative form as $\\partial_t \\mathbf{U} + \\partial_x \\mathbf{F}(\\mathbf{U}) = 0$, where $\\mathbf{U} = (\\rho, \\rho u, E)^{\\mathsf{T}}$ and $\\mathbf{F}(\\mathbf{U}) = (\\rho u, \\rho u^{2} + p, u(E + p))^{\\mathsf{T}}$, with equation of state $p = (\\gamma - 1)\\left(E - \\tfrac{1}{2}\\rho u^{2}\\right)$. In the Flux Reconstruction (FR) unifying framework, the elementwise residual couples to its neighbors and physical boundaries through a numerical flux $\\hat{f}^{n}$ that is consistent with the physical flux projected onto the outward unit normal $\\mathbf{n}$, i.e., $\\hat{f}^{n}(\\mathbf{U}^{-}, \\mathbf{U}^{+}) \\approx \\mathbf{F}(\\mathbf{U}) \\cdot \\mathbf{n}$. At a physical boundary, weak imposition of a boundary condition is performed by evaluating $\\hat{f}^{n}$ at the interior trace $\\mathbf{U}^{-}$ and at a boundary-exterior state $\\mathbf{U}_{b}$ that encodes the physical boundary information via a hyperbolically admissible construction.\n\n(a) Starting from the integral conservation law and the definition of a consistent approximate Riemann solver $\\hat{f}^{n}(\\cdot,\\cdot)$, state how weak imposition of a boundary condition enters the FR residual at a boundary face and explain why choosing $\\mathbf{U}_{b}$ via characteristic information ensures upwind stability for subsonic inflow.\n\n(b) Consider a left boundary at $x = 0$ of a semi-infinite domain $x > 0$ with subsonic inflow directed into the domain, i.e., $u > 0$ and $0 < M < 1$, where $M = |u|/c$ and $c = \\sqrt{\\gamma p/\\rho}$ is the speed of sound. Let the interior primitive state at the boundary be $\\mathbf{w}^{-} = (\\rho^{-}, u^{-}, p^{-})^{\\mathsf{T}}$. Let the exterior (prescribed inflow) primitive data be $\\mathbf{w}_{\\infty} = (\\rho_{\\infty}, u_{\\infty}, p_{\\infty})^{\\mathsf{T}}$. Using only the hyperbolic structure of the Euler equations and the ideal-gas relations, construct the boundary primitive state $\\mathbf{w}_{b} = (\\rho_{b}, u_{b}, p_{b})^{\\mathsf{T}}$ by enforcing that the characteristic information associated with the incoming waves is taken from $\\mathbf{w}_{\\infty}$, while the characteristic information associated with the outgoing wave is taken from $\\mathbf{w}^{-}$. Then, express $\\mathbf{w}_{b}$ as a closed-form analytic expression in terms of $(\\rho^{-}, u^{-}, p^{-})$, $(\\rho_{\\infty}, u_{\\infty}, p_{\\infty})$, and $\\gamma$. Your final answer must be the boundary primitive state vector $\\mathbf{w}_{b}$ written as a single row matrix. No numerical evaluation is required; provide the exact symbolic expressions. Do not include any units in the final result.",
            "solution": "(a) Weak Imposition of Boundary Conditions in Flux Reconstruction and Stability\n\nThe Flux Reconstruction (FR) method is formulated from the integral form of the conservation law, $\\partial_t \\mathbf{U} + \\partial_x \\mathbf{F}(\\mathbf{U}) = 0$, over a computational element $I_j = [x_L, x_R]$. For a test function $\\phi_k(x)$, the weak form is:\n$$ \\int_{I_j} \\phi_k (\\partial_t \\mathbf{U}_h + \\partial_x \\mathbf{F}_h) \\,dx = 0 $$\nwhere $\\mathbf{U}_h$ and $\\mathbf{F}_h$ are the polynomial approximations of the solution and flux within the element. Integrating the flux term by parts yields:\n$$ \\int_{I_j} \\phi_k \\partial_t \\mathbf{U}_h \\,dx + \\left[ \\phi_k \\mathbf{F}_h \\right]_{x_L}^{x_R} - \\int_{I_j} (\\partial_x \\phi_k) \\mathbf{F}_h \\,dx = 0 $$\nThe solution $\\mathbf{U}_h$ is represented continuously within the element but is discontinuous between elements. This leads to a discontinuous flux $\\mathbf{F}_h$ at the element interfaces. To ensure conservation and provide coupling, the potentially two-valued flux at an interface is replaced by a single-valued numerical flux, denoted $\\hat{\\mathbf{F}}$. This numerical flux is a function of the states on either side of the interface, $\\mathbf{U}^{-}$ (interior value) and $\\mathbf{U}^{+}$ (exterior value). The weak form becomes:\n$$ \\int_{I_j} \\phi_k \\partial_t \\mathbf{U}_h \\,dx + \\phi_k(x_R) \\hat{\\mathbf{F}}(x_R) - \\phi_k(x_L) \\hat{\\mathbf{F}}(x_L) - \\int_{I_j} (\\partial_x \\phi_k) \\mathbf{F}_h \\,dx = 0 $$\nThe element residual is the spatial part of this equation.\n\nAt a physical boundary, say at the left face $x_L = 0$, the interior state is the solution trace from within the computational domain, $\\mathbf{U}^{-}(0)$. The \"exterior\" state, which would normally come from a neighboring element, does not exist. Instead, we must construct a ghost state, $\\mathbf{U}_b$, that encodes the physical boundary condition. The numerical flux at this boundary face is then computed as $\\hat{\\mathbf{F}}(0) = \\hat{f}^n(\\mathbf{U}^{-}(0), \\mathbf{U}_b)$, where $\\hat{f}^n$ is an approximate Riemann solver. The weak imposition of the boundary condition thus enters the element residual through the boundary flux term, $\\phi_k(0) \\hat{f}^n(\\mathbf{U}^{-}(0), \\mathbf{U}_b)$.\n\nThe stability of this procedure is ensured by a \"hyperbolically admissible\" construction of $\\mathbf{U}_b$, which relies on the characteristic structure of the governing hyperbolic system. For the one-dimensional Euler equations, the flux Jacobian $\\mathbf{A} = \\partial \\mathbf{F} / \\partial \\mathbf{U}$ has three real eigenvalues corresponding to characteristic speeds: $\\lambda_1 = u-c$, $\\lambda_2 = u$, and $\\lambda_3 = u+c$. The sign of an eigenvalue indicates the direction of information propagation along the corresponding characteristic.\n\nFor subsonic inflow at a left boundary ($x=0$, domain $x>0$), we have $u > 0$ and Mach number $M = u/c < 1$. The eigenvalues are:\n- $\\lambda_1 = u-c < 0$: Information propagates from inside the domain ($x>0$) towards the boundary. This is an **outgoing** wave.\n- $\\lambda_2 = u > 0$: Information propagates from outside the domain ($x<0$) into the domain. This is an **incoming** wave.\n- $\\lambda_3 = u+c > 0$: Information also propagates from outside into the domain. This is an **incoming** wave.\n\nFor a well-posed boundary value problem for a hyperbolic system, the number of boundary conditions to specify must equal the number of incoming characteristics. Here, there are two incoming waves. The information associated with outgoing waves must be determined from the solution inside the domain.\n\nBy constructing $\\mathbf{U}_b$ such that the characteristic variables associated with incoming waves ($\\lambda_2, \\lambda_3$) are determined from the prescribed exterior data $\\mathbf{w}_{\\infty}$, and the characteristic variable associated with the outgoing wave ($\\lambda_1$) is determined from the interior solution trace $\\mathbf{w}^{-}$, we are correctly setting the boundary condition according to hyperbolic theory. This \"upwind\" treatment of characteristic information ensures that the boundary absorbs outgoing waves without spurious reflection and correctly imposes the external state information, preventing the artificial generation of energy that would lead to numerical instability.\n\n(b) Construction of the Boundary State $\\mathbf{w}_b$\n\nWe construct the boundary primitive state $\\mathbf{w}_b = (\\rho_b, u_b, p_b)^{\\mathsf{T}}$ by setting the values of the characteristic variables according to their direction of propagation. The characteristic variables are derived from the Riemann invariants of the Euler equations. For flows where entropy variations are advected along pathlines and acoustic waves are treated as isentropic, the relevant characteristic quantities are:\n1. $u - \\frac{2c}{\\gamma-1}$, associated with the outgoing wave ($\\lambda_1 = u-c$).\n2. $p/\\rho^\\gamma$, associated with the incoming wave ($\\lambda_2 = u$).\n3. $u + \\frac{2c}{\\gamma-1}$, associated with the incoming wave ($\\lambda_3 = u+c$).\n\nHere, $c$ is the local speed of sound, $c=\\sqrt{\\gamma p/\\rho}$. According to the principle of characteristic-based boundary conditions, the state $\\mathbf{w}_b$ must satisfy:\n1. Outgoing information from the interior state $\\mathbf{w}^{-}$:\n   $$ u_b - \\frac{2c_b}{\\gamma-1} = u^{-} - \\frac{2c^{-}}{\\gamma-1} $$\n2. Incoming information from the prescribed exterior state $\\mathbf{w}_{\\infty}$:\n   $$ \\frac{p_b}{\\rho_b^\\gamma} = \\frac{p_{\\infty}}{\\rho_{\\infty}^\\gamma} $$\n3. Incoming information from the prescribed exterior state $\\mathbf{w}_{\\infty}$:\n   $$ u_b + \\frac{2c_b}{\\gamma-1} = u_{\\infty} + \\frac{2c_{\\infty}}{\\gamma-1} $$\n\nHere, $c_b = \\sqrt{\\gamma p_b/\\rho_b}$, $c^{-} = \\sqrt{\\gamma p^{-}/\\rho^{-}}$, and $c_{\\infty} = \\sqrt{\\gamma p_{\\infty}/\\rho_{\\infty}}$. We have a system of three equations for the three unknowns $(\\rho_b, u_b, p_b)$.\n\nFirst, we solve for $u_b$ and $c_b$ using the two acoustic invariant equations (1) and (3).\nAdding equation (1) and (3):\n$$ 2u_b = (u_{\\infty} + u^{-}) + \\frac{2c_{\\infty}}{\\gamma-1} - \\frac{2c^{-}}{\\gamma-1} \\implies u_b = \\frac{1}{2}(u_{\\infty} + u^{-}) + \\frac{c_{\\infty} - c^{-}}{\\gamma-1} $$\nSubtracting equation (1) from (3):\n$$ \\frac{4c_b}{\\gamma-1} = (u_{\\infty} - u^{-}) + \\frac{2c_{\\infty}}{\\gamma-1} + \\frac{2c^{-}}{\\gamma-1} \\implies c_b = \\frac{\\gamma-1}{4}(u_{\\infty} - u^{-}) + \\frac{1}{2}(c_{\\infty} + c^{-}) $$\n\nNow we use equation (2) and the definition of the speed of sound to find $\\rho_b$ and $p_b$.\nFrom (2), we have $p_b = p_{\\infty} \\left( \\frac{\\rho_b}{\\rho_{\\infty}} \\right)^\\gamma$.\nFrom the definition of $c_b$, we have $p_b = \\frac{\\rho_b c_b^2}{\\gamma}$.\nEquating these two expressions for $p_b$:\n$$ \\frac{\\rho_b c_b^2}{\\gamma} = p_{\\infty} \\left( \\frac{\\rho_b}{\\rho_{\\infty}} \\right)^\\gamma = \\frac{p_{\\infty}}{\\rho_{\\infty}^\\gamma} \\rho_b^\\gamma $$\n$$ \\rho_b^{1-\\gamma} = \\frac{\\gamma p_{\\infty}}{c_b^2 \\rho_{\\infty}^\\gamma} = \\frac{\\gamma p_{\\infty}}{c_b^2 \\rho_{\\infty}^\\gamma} \\frac{\\rho_{\\infty}}{\\rho_{\\infty}} = \\frac{\\gamma p_{\\infty}/\\rho_{\\infty}}{c_b^2} \\frac{1}{\\rho_{\\infty}^{\\gamma-1}} = \\frac{c_{\\infty}^2}{c_b^2} \\rho_{\\infty}^{1-\\gamma} $$\n$$ \\rho_b = \\left( \\frac{c_{\\infty}^2}{c_b^2} \\rho_{\\infty}^{1-\\gamma} \\right)^{\\frac{1}{1-\\gamma}} = \\left( \\frac{c_{\\infty}}{c_b} \\right)^{\\frac{2}{1-\\gamma}} \\rho_{\\infty} = \\rho_{\\infty} \\left( \\frac{c_b}{c_{\\infty}} \\right)^{\\frac{2}{\\gamma-1}} $$\nFinally, substituting this expression for $\\rho_b$ back into the entropy relation from equation (2):\n$$ p_b = p_{\\infty} \\left( \\frac{\\rho_b}{\\rho_{\\infty}} \\right)^\\gamma = p_{\\infty} \\left( \\left( \\frac{c_b}{c_{\\infty}} \\right)^{\\frac{2}{\\gamma-1}} \\right)^\\gamma = p_{\\infty} \\left( \\frac{c_b}{c_{\\infty}} \\right)^{\\frac{2\\gamma}{\\gamma-1}} $$\n\nThe full expressions for $\\mathbf{w}_b = (\\rho_b, u_b, p_b)^{\\mathsf{T}}$ are obtained by substituting the expressions for $c_b$, $c^{-}$, and $c_{\\infty}$.",
            "answer": "$$ \\boxed{\\begin{pmatrix} \\rho_{\\infty} \\left( \\frac{\\frac{1}{2}(\\sqrt{\\frac{\\gamma p_{\\infty}}{\\rho_{\\infty}}} + \\sqrt{\\frac{\\gamma p^{-}}{\\rho^{-}}}) + \\frac{\\gamma - 1}{4}(u_{\\infty} - u^{-})}{\\sqrt{\\frac{\\gamma p_{\\infty}}{\\rho_{\\infty}}}} \\right)^{\\frac{2}{\\gamma-1}} & \\frac{1}{2}(u_{\\infty} + u^{-}) + \\frac{1}{\\gamma-1}\\left(\\sqrt{\\frac{\\gamma p_{\\infty}}{\\rho_{\\infty}}} - \\sqrt{\\frac{\\gamma p^{-}}{\\rho^{-}}}\\right) & p_{\\infty} \\left( \\frac{\\frac{1}{2}(\\sqrt{\\frac{\\gamma p_{\\infty}}{\\rho_{\\infty}}} + \\sqrt{\\frac{\\gamma p^{-}}{\\rho^{-}}}) + \\frac{\\gamma - 1}{4}(u_{\\infty} - u^{-})}{\\sqrt{\\frac{\\gamma p_{\\infty}}{\\rho_{\\infty}}}} \\right)^{\\frac{2\\gamma}{\\gamma-1}} \\end{pmatrix}} $$"
        },
        {
            "introduction": "Once the spatial operator is defined, the method of lines transforms the partial differential equation into a system of ordinary differential equations (ODEs) to be solved in time. When using explicit time integration schemes, the stability of the entire simulation hinges on choosing a sufficiently small time step, $\\Delta t$. This exercise explores the crucial link between the spatial discretization, whose properties are captured by the spectral radius $\\rho(\\boldsymbol{L})$ of the discrete operator, and the stability region of the chosen time integrator . You will implement the standard procedure for calculating the maximum stable time step, revealing the characteristic scaling $\\Delta t \\propto h/p^2$ that governs high-order FR methods.",
            "id": "3320625",
            "problem": "You are asked to write a complete, runnable program that computes the maximum stable time step for explicit Runge–Kutta (RK) time integration of a semi-discrete linear system obtained from a Flux Reconstruction (FR) spatial discretization. The fundamental base is the method-of-lines formulation and linear stability theory for ordinary differential equations.\n\nConsider the method-of-lines semi-discrete system\n$$\n\\frac{d \\boldsymbol{u}}{dt} = \\boldsymbol{L}\\,\\boldsymbol{u},\n$$\nwhere $\\boldsymbol{L}$ is a linear operator produced by a Flux Reconstruction (FR) spatial discretization of a one-dimensional linear advection equation with constant advection speed $a$. Let $\\lambda_i$ denote the eigenvalues of $\\boldsymbol{L}$ and let the spectral radius be\n$$\n\\rho(\\boldsymbol{L}) = \\max_i |\\lambda_i|.\n$$\nFor an explicit Runge–Kutta (RK) method applied to the semi-discrete system, stability requires that for all eigenvalues $\\lambda_i$, the product $z_i = \\Delta t \\,\\lambda_i$ lies within the absolute stability region of the RK method. Along the negative real axis, define the one-dimensional stability bound\n$$\nr_{\\mathrm{RK}} = \\sup\\{ x \\ge 0 \\,:\\, |R(-x)| \\le 1 \\},\n$$\nwhere $R(z)$ is the stability function (amplification polynomial) of the RK method. For explicit Euler, $R(z) = 1 + z$; for classical third-order Runge–Kutta, $R(z) = 1 + z + \\frac{z^2}{2} + \\frac{z^3}{6}$; and for classical fourth-order Runge–Kutta, $R(z) = 1 + z + \\frac{z^2}{2} + \\frac{z^3}{6} + \\frac{z^4}{24}$. The largest stable time step for the semi-discrete system is then\n$$\n\\Delta t_{\\max} = \\frac{r_{\\mathrm{RK}}}{\\rho(\\boldsymbol{L})}.\n$$\n\nYour program must:\n- Numerically compute $r_{\\mathrm{RK}}$ for a given RK method by solving $|R(-x)| = 1$ for the largest $x \\ge 0$.\n- Given the spectral radius $\\rho(\\boldsymbol{L})$, compute $\\Delta t_{\\max} = r_{\\mathrm{RK}} / \\rho(\\boldsymbol{L})$.\n\nThe Flux Reconstruction (FR) framework induces a characteristic scaling of the spectral radius for linear advection on a uniform mesh of element size $h$:\n$$\n\\rho(\\boldsymbol{L}) = \\frac{|a|}{h} \\,\\alpha_p,\n$$\nwhere $\\alpha_p$ is a dimensionless constant set by the polynomial degree $p$ and the chosen FR correction function. By polynomial approximation theory, $\\alpha_p$ typically grows like $\\mathcal{O}(p^2)$ for canonical choices of basis and correction, implying the time step scaling\n$$\n\\Delta t_{\\max} \\sim \\frac{h}{|a|}\\,\\frac{r_{\\mathrm{RK}}}{\\alpha_p} \\propto \\frac{h}{p^2}.\n$$\nYou should not hard-code any shortcut formula for $r_{\\mathrm{RK}}$; rather, determine it numerically from $|R(-x)| = 1$.\n\nTest Suite:\nFor each test case below, you are given the RK method and the spectral radius $\\rho(\\boldsymbol{L})$ in $\\mathrm{s}^{-1}$. These spectral radii have been constructed using $\\rho(\\boldsymbol{L}) = \\frac{|a|}{h}\\,\\alpha_p$ with representative choices $(a,h,p)$ and $\\alpha_p = (p+1)^2$ to reflect a typical $\\mathcal{O}(p^2)$ scaling, but your program must use only the given $\\rho(\\boldsymbol{L})$ values.\n\n- Test case $1$: RK method is classical fourth-order Runge–Kutta, $\\rho(\\boldsymbol{L}) = 160.0\\,\\mathrm{s}^{-1}$ (constructed from $a = 1\\,\\mathrm{m/s}$, $h = 0.1\\,\\mathrm{m}$, $p = 3$, $\\alpha_p = 16$).\n- Test case $2$: RK method is classical fourth-order Runge–Kutta, $\\rho(\\boldsymbol{L}) = 640.0\\,\\mathrm{s}^{-1}$ (constructed from $a = 1\\,\\mathrm{m/s}$, $h = 0.1\\,\\mathrm{m}$, $p = 7$, $\\alpha_p = 64$).\n- Test case $3$: RK method is classical third-order Runge–Kutta, $\\rho(\\boldsymbol{L}) = 640.0\\,\\mathrm{s}^{-1}$ (constructed from $a = 1\\,\\mathrm{m/s}$, $h = 0.025\\,\\mathrm{m}$, $p = 3$, $\\alpha_p = 16$).\n- Test case $4$: RK method is explicit Euler, $\\rho(\\boldsymbol{L}) = 80.0\\,\\mathrm{s}^{-1}$ (constructed from $a = 2\\,\\mathrm{m/s}$, $h = 0.1\\,\\mathrm{m}$, $p = 1$, $\\alpha_p = 4$).\n- Test case $5$: RK method is classical fourth-order Runge–Kutta, $\\rho(\\boldsymbol{L}) = 36300.0\\,\\mathrm{s}^{-1}$ (constructed from $a = 3\\,\\mathrm{m/s}$, $h = 0.01\\,\\mathrm{m}$, $p = 10$, $\\alpha_p = 121$).\n\nAngle units are not applicable. Express the final time step values in seconds. Your program should output each $\\Delta t_{\\max}$ rounded to exactly $9$ decimal places (i.e., nanosecond resolution), as a list of floats in the following order corresponding to the five test cases above.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example,\n$$\n[\\Delta t_1,\\Delta t_2,\\Delta t_3,\\Delta t_4,\\Delta t_5]\n$$\nwith each $\\Delta t_i$ rounded to $9$ decimal places and expressed in seconds (unit $\\mathrm{s}$).",
            "solution": "The solution proceeds by first determining the stability bound $r_{\\mathrm{RK}}$ for each specified Runge-Kutta (RK) method and then applying the given formula for the maximum stable time step, $\\Delta t_{\\max}$.\n\nThe governing stability relationship is given by:\n$$\n\\Delta t_{\\max} = \\frac{r_{\\mathrm{RK}}}{\\rho(\\boldsymbol{L})}\n$$\nwhere $\\rho(\\boldsymbol{L})$ is the spectral radius of the spatial discretization operator $\\boldsymbol{L}$, and $r_{\\mathrm{RK}}$ is the stability bound of the RK time integration scheme along the negative real axis. The bound $r_{\\mathrm{RK}}$ is defined as:\n$$\nr_{\\mathrm{RK}} = \\sup\\{ x \\ge 0 \\,:\\, |R(-x)| \\le 1 \\}\n$$\nwhere $R(z)$ is the stability function of the RK method. We find $r_{\\mathrm{RK}}$ by solving $|R(-x)| = 1$ for the largest positive real root $x$.\n\nWe will now determine $r_{\\mathrm{RK}}$ for each of the three specified methods.\n\n1.  **Explicit Euler Method**\n    The stability function is $R(z) = 1 + z$. We need to solve $|R(-x)| = 1$ for $x \\ge 0$.\n    $$\n    |1 - x| = 1\n    $$\n    This equation has two solutions: $1 - x = 1 \\implies x = 0$ and $1 - x = -1 \\implies x = 2$.\n    The largest value of $x$ for which this holds is $x=2$.\n    Thus, for the explicit Euler method, $r_{\\mathrm{Euler}} = 2$.\n\n2.  **Classical Third-Order Runge-Kutta (RK3) Method**\n    The stability function is $R(z) = 1 + z + \\frac{z^2}{2} + \\frac{z^3}{6}$. We solve $|R(-x)| = 1$ for $x \\ge 0$.\n    $$\n    \\left|1 - x + \\frac{x^2}{2} - \\frac{x^3}{6}\\right| = 1\n    $$\n    This implies one of two polynomial equations must hold:\n    a) $1 - x + \\frac{x^2}{2} - \\frac{x^3}{6} = 1 \\implies -x + \\frac{x^2}{2} - \\frac{x^3}{6} = 0$. This gives $x( -1 + \\frac{x}{2} - \\frac{x^2}{6} ) = 0$. One solution is $x=0$. The quadratic factor has no real roots.\n    b) $1 - x + \\frac{x^2}{2} - \\frac{x^3}{6} = -1 \\implies x^3 - 3x^2 + 6x - 12 = 0$.\n    This equation has one real, positive root, which we find numerically to be $x \\approx 2.51274533$.\n    Thus, $r_{\\mathrm{RK3}} \\approx 2.51274533$.\n\n3.  **Classical Fourth-Order Runge-Kutta (RK4) Method**\n    The stability function is $R(z) = 1 + z + \\frac{z^2}{2} + \\frac{z^3}{6} + \\frac{z^4}{24}$. We solve $|R(-x)| = 1$ for $x \\ge 0$.\n    $$\n    \\left|1 - x + \\frac{x^2}{2} - \\frac{x^3}{6} + \\frac{x^4}{24}\\right| = 1\n    $$\n    This again leads to two cases, with the stability bound being determined by the single positive real root of $x^3 - 4x^2 + 12x - 24 = 0$.\n    Numerically solving yields the root $x \\approx 2.78529434$.\n    Thus, $r_{\\mathrm{RK4}} \\approx 2.78529434$.\n\nWith the stability bounds determined, we now compute $\\Delta t_{\\max}$ for each test case.\n\n**Test Case 1:**\n- RK method: Classical fourth-order Runge-Kutta, $r_{\\mathrm{RK4}} \\approx 2.78529434$.\n- Spectral radius: $\\rho(\\boldsymbol{L}) = 160.0\\,\\mathrm{s}^{-1}$.\n- $\\Delta t_{\\max} = \\frac{r_{\\mathrm{RK4}}}{\\rho(\\boldsymbol{L})} \\approx \\frac{2.78529434}{160.0} \\approx 0.017408090\\,\\mathrm{s}$.\n\n**Test Case 2:**\n- RK method: Classical fourth-order Runge-Kutta, $r_{\\mathrm{RK4}} \\approx 2.78529434$.\n- Spectral radius: $\\rho(\\boldsymbol{L}) = 640.0\\,\\mathrm{s}^{-1}$.\n- $\\Delta t_{\\max} = \\frac{r_{\\mathrm{RK4}}}{\\rho(\\boldsymbol{L})} \\approx \\frac{2.78529434}{640.0} \\approx 0.004352022\\,\\mathrm{s}$.\n\n**Test Case 3:**\n- RK method: Classical third-order Runge-Kutta, $r_{\\mathrm{RK3}} \\approx 2.51274533$.\n- Spectral radius: $\\rho(\\boldsymbol{L}) = 640.0\\,\\mathrm{s}^{-1}$.\n- $\\Delta t_{\\max} = \\frac{r_{\\mathrm{RK3}}}{\\rho(\\boldsymbol{L})} \\approx \\frac{2.51274533}{640.0} \\approx 0.003926165\\,\\mathrm{s}$.\n\n**Test Case 4:**\n- RK method: Explicit Euler, $r_{\\mathrm{Euler}} = 2.0$.\n- Spectral radius: $\\rho(\\boldsymbol{L}) = 80.0\\,\\mathrm{s}^{-1}$.\n- $\\Delta t_{\\max} = \\frac{r_{\\mathrm{Euler}}}{\\rho(\\boldsymbol{L})} = \\frac{2.0}{80.0} = 0.025\\,\\mathrm{s}$.\n\n**Test Case 5:**\n- RK method: Classical fourth-order Runge-Kutta, $r_{\\mathrm{RK4}} \\approx 2.78529434$.\n- Spectral radius: $\\rho(\\boldsymbol{L}) = 36300.0\\,\\mathrm{s}^{-1}$.\n- $\\Delta t_{\\max} = \\frac{r_{\\mathrm{RK4}}}{\\rho(\\boldsymbol{L})} \\approx \\frac{2.78529434}{36300.0} \\approx 0.000076730\\,\\mathrm{s}$.",
            "answer": "[0.017408090,0.004352022,0.003926165,0.025000000,0.000076730]"
        }
    ]
}