{
    "hands_on_practices": [
        {
            "introduction": "Maintaining positivity is a critical challenge for high-order numerical methods, as unphysical negative values for quantities like density or concentration can arise even when the underlying physics forbids it. This first exercise introduces the foundational concept of a positivity-preserving limiter in a clear and simple setting. By calculating a scaling factor $\\theta$ for a bilinear interpolation on a single element, you will develop a concrete understanding of how to pull a solution towards its cell average to restore positivity with minimal modification .",
            "id": "3352405",
            "problem": "Consider a single two-dimensional finite element of quadrilateral shape used to interpolate a transported nonnegative scalar field in computational fluid dynamics. The physical coordinates of the four vertices (ordered counterclockwise) are given by $\\boldsymbol{x}_{1}=(0,0)$, $\\boldsymbol{x}_{2}=(2,0.5)$, $\\boldsymbol{x}_{3}=(2.5,1.5)$, and $\\boldsymbol{x}_{4}=(0.5,1.0)$. This is a skewed parallelogram, so the isoparametric mapping from the reference square with coordinates $(\\xi,\\eta)\\in[-1,1]^{2}$ is affine and orientation-preserving. On the reference square, use the standard bilinear (first-order) Lagrange shape functions $N_{i}(\\xi,\\eta)$ associated with the four vertices. The nodal values of the scalar are prescribed as $u_{1}=0.80$, $u_{2}=0.30$, $u_{3}=-0.10$, and $u_{4}=0.40$.\n\nStarting from the definitions of the bilinear shape functions and the basic requirement of positivity for a transported scalar, answer the following:\n\n1. Determine whether the bilinear interpolant $u_{h}(\\boldsymbol{x})=\\sum_{i=1}^{4}N_{i}(\\xi(\\boldsymbol{x}),\\eta(\\boldsymbol{x}))\\,u_{i}$ becomes negative at any point in the element.\n\n2. To enforce positivity with minimal loss of high-order accuracy, consider the global scaling limiter defined by $u_{h}^{\\text{lim}}(\\boldsymbol{x})=u_{\\text{avg}}+\\theta\\left(u_{h}(\\boldsymbol{x})-u_{\\text{avg}}\\right)$ with a single parameter $\\theta\\in[0,1]$ applied uniformly in the element, where $u_{\\text{avg}}$ is the cell average of $u_{h}$ over the physical element. Assuming an affine mapping (hence a constant Jacobian), compute the minimal scaling factor $\\theta$ that guarantees $u_{h}^{\\text{lim}}(\\boldsymbol{x})\\ge 0$ for all $\\boldsymbol{x}$ in the element.\n\nExpress your final scaling factor as an exact fraction. No rounding is required. The final answer must be a single number.",
            "solution": "The problem asks for two main results regarding a bilinear interpolation on a quadrilateral finite element: first, to determine if the interpolated scalar field $u_h$ becomes negative, and second, to compute a scaling factor $\\theta$ for a positivity-preserving limiter.\n\nThe analysis is performed on the reference element, a square defined by $(\\xi, \\eta) \\in [-1,1]^2$. The isoparametric mapping to the physical element with vertices $\\boldsymbol{x}_{1}=(0,0)$, $\\boldsymbol{x}_{2}=(2,0.5)$, $\\boldsymbol{x}_{3}=(2.5,1.5)$, and $\\boldsymbol{x}_{4}=(0.5,1.0)$ is affine because the physical element is a parallelogram. This is confirmed by verifying that $\\boldsymbol{x}_{2}-\\boldsymbol{x}_{1} = \\boldsymbol{x}_{3}-\\boldsymbol{x}_{4} = (2, 0.5)$ and $\\boldsymbol{x}_{4}-\\boldsymbol{x}_{1} = \\boldsymbol{x}_{3}-\\boldsymbol{x}_{2} = (0.5, 1.0)$.\n\nThe bilinear interpolant $u_h$ is defined using the standard Lagrange shape functions on the reference square, which correspond to the vertices numbered counterclockwise starting from $(\\xi,\\eta)=(-1,-1)$:\n$N_{1}(\\xi,\\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta)$\n$N_{2}(\\xi,\\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta)$\n$N_{3}(\\xi,\\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta)$\n$N_{4}(\\xi,\\eta) = \\frac{1}{4}(1-\\xi)(1+\\eta)$\n\nThe interpolated scalar field is given by $u_{h}(\\xi,\\eta) = \\sum_{i=1}^{4}N_{i}(\\xi,\\eta)\\,u_{i}$, where the nodal values are $u_{1}=0.80$, $u_{2}=0.30$, $u_{3}=-0.10$, and $u_{4}=0.40$.\n\nPart 1: Determination of positivity of $u_h(\\boldsymbol{x})$.\nTo find the minimum value of the bilinear interpolant $u_h$ over the element, we must evaluate it across the entire reference domain $(\\xi,\\eta) \\in [-1,1]^2$. The extrema of a bilinear function on a rectangle can occur at the vertices or at an interior critical point. In this specific problem, expanding the sum reveals that the $\\xi\\eta$ term vanishes, meaning the interpolant is actually a linear function of $\\xi$ and $\\eta$. The extrema of a linear function on a convex domain (like a square) must occur at its vertices. Therefore, the minimum value is simply the minimum of the four nodal values.\nThe minimum value of the interpolant, $u_{\\min}$, is:\n$$u_{\\min} = \\min_{(\\xi,\\eta) \\in [-1,1]^2} u_h(\\xi, \\eta) = \\min\\{u_1, u_2, u_3, u_4\\}$$\nSubstituting the given nodal values:\n$$u_{\\min} = \\min\\{0.80, 0.30, -0.10, 0.40\\} = -0.10$$\nSince $u_{\\min} = -0.10$, which is less than $0$, the bilinear interpolant $u_h(\\boldsymbol{x})$ does become negative at a point in the element. Specifically, the minimum occurs at the vertex $(\\xi,\\eta)=(1,1)$, which corresponds to the physical vertex $\\boldsymbol{x}_3$.\n\nPart 2: Computation of the scaling factor $\\theta$.\nThe positivity-preserving limiter is defined as $u_{h}^{\\text{lim}}(\\boldsymbol{x})=u_{\\text{avg}}+\\theta\\left(u_{h}(\\boldsymbol{x})-u_{\\text{avg}}\\right)$, where $\\theta \\in [0,1]$. We must enforce $u_{h}^{\\text{lim}}(\\boldsymbol{x}) \\ge 0$ for all $\\boldsymbol{x}$ in the element.\n\nFirst, we compute the cell average $u_{\\text{avg}}$. Since the mapping is affine, the Jacobian of the transformation is constant. The cell average in physical space is equal to the average over the reference element:\n$$u_{\\text{avg}} = \\frac{\\int_E u_h d\\boldsymbol{x}}{\\int_E d\\boldsymbol{x}} = \\frac{\\int_{-1}^1 \\int_{-1}^1 u_h(\\xi,\\eta) J d\\xi d\\eta}{\\int_{-1}^1 \\int_{-1}^1 J d\\xi d\\eta} = \\frac{1}{4} \\int_{-1}^1 \\int_{-1}^1 u_h(\\xi,\\eta) d\\xi d\\eta$$\nSubstituting the definition of $u_h$:\n$$u_{\\text{avg}} = \\frac{1}{4} \\int_{-1}^1 \\int_{-1}^1 \\left(\\sum_{i=1}^4 N_i(\\xi, \\eta) u_i\\right) d\\xi d\\eta = \\sum_{i=1}^4 u_i \\left(\\frac{1}{4} \\int_{-1}^1 \\int_{-1}^1 N_i(\\xi, \\eta) d\\xi d\\eta\\right)$$\nThe integral of any bilinear shape function over the reference element is $\\int_{-1}^1 \\int_{-1}^1 N_i(\\xi, \\eta) d\\xi d\\eta = 1$. Thus, the cell average is the arithmetic mean of the nodal values:\n$$u_{\\text{avg}} = \\frac{1}{4} \\sum_{i=1}^{4} u_{i} = \\frac{1}{4}(0.80 + 0.30 - 0.10 + 0.40) = \\frac{1.40}{4} = 0.35$$\nThe condition $u_{h}^{\\text{lim}} \\ge 0$ is $u_{\\text{avg}}+\\theta\\left(u_{h}(\\boldsymbol{x})-u_{\\text{avg}}\\right) \\ge 0$.\nThis inequality must be satisfied for all points in the element. The most restrictive case occurs at the point where $u_h$ is minimal, i.e., at $u_{\\min} = -0.10$.\nWe must thus satisfy:\n$$u_{\\text{avg}} + \\theta(u_{\\min} - u_{\\text{avg}}) \\ge 0$$\nPlugging in the values for $u_{\\text{avg}}$ and $u_{\\min}$:\n$$0.35 + \\theta(-0.10 - 0.35) \\ge 0$$\n$$0.35 - 0.45\\theta \\ge 0$$\n$$0.35 \\ge 0.45\\theta$$\nThis yields an upper bound for $\\theta$:\n$$\\theta \\le \\frac{0.35}{0.45}$$\nAny $\\theta$ in the range $[0, \\frac{0.35}{0.45}]$ guarantees a non-negative solution. The problem asks for the factor that enforces positivity \"with minimal loss of high-order accuracy.\" Minimal loss of accuracy is achieved by applying the least possible amount of limiting, which corresponds to choosing the largest possible value for $\\theta$. This critical upper bound is the value that makes the limited solution just non-negative at its minimum.\n$$\\theta = \\frac{0.35}{0.45} = \\frac{35}{45}$$\nExpressing this as an exact fraction in simplest form:\n$$\\theta = \\frac{5 \\times 7}{5 \\times 9} = \\frac{7}{9}$$\nThis is the required scaling factor.",
            "answer": "$$\\boxed{\\frac{7}{9}}$$"
        },
        {
            "introduction": "Moving from a single scalar equation to a system of conservation laws, such as the compressible Euler equations, adds a new layer of complexity to positivity preservation. Not only must density $\\rho$ remain positive, but derived thermodynamic variables like pressure $p$ must also satisfy physical bounds, creating a coupled set of constraints. This practice challenges you to find a single, unified limiting factor $\\theta$ that guarantees the admissibility of the entire state vector at different points within a computational cell, a common and essential task in modern CFD .",
            "id": "3352416",
            "problem": "Consider the one-dimensional compressible Euler equations with an ideal-gas equation of state, where the conservative state is $U = (\\rho, m, E)^{\\top}$, with $m = \\rho u$, and the pressure is given by $p = (\\gamma - 1)\\left(E - \\tfrac{1}{2}\\dfrac{m^{2}}{\\rho}\\right)$. In a single cell of a Discontinuous Galerkin (DG) method, the cell-average state is known to be strictly admissible. You will enforce positivity at the quadrature points by linearly scaling all conservative fields toward the cell average with a single factor $\\theta \\in [0,1]$.\n\nData for this cell are as follows:\n- Ratio of specific heats: $\\gamma = 1.4$.\n- Positivity threshold: $\\varepsilon = 0.05$.\n- Cell-average variables: $\\bar{\\rho} = 1$, $\\bar{u} = 0.2$, $\\bar{p} = 1$. Use these to determine $\\bar{m}$ and $\\bar{E}$.\n- At two quadrature points $x_{1}$ and $x_{2}$, you are given the unlimited nodal values $(\\rho, p)$:\n  - At $x_{1}$: $\\rho_{1} = 0.01$, $p_{1} = 0.02$.\n  - At $x_{2}$: $\\rho_{2} = 1.8$, $p_{2} = 0.5$.\n- Assume the pointwise velocity is equal to the cell-average velocity, i.e., $u(x_{1}) = u(x_{2}) = \\bar{u}$.\n\nDefine the limited state at each quadrature point by\n$$\nU_{\\theta}(x_{j}) = \\bar{U} + \\theta\\big(U(x_{j}) - \\bar{U}\\big), \\quad j \\in \\{1,2\\},\n$$\nwith $U = (\\rho, m, E)^{\\top}$, $m = \\rho u$, and $E$ determined from the ideal-gas relation using the given $(\\rho, p)$ and the assumed velocity. Determine the single largest $\\theta \\in [0,1]$ such that, simultaneously at both quadrature points, the limited values satisfy the admissibility conditions\n$$\n\\rho_{\\theta}(x_{j}) \\ge \\varepsilon, \n\\quad\np_{\\theta}(x_{j}) \\ge \\varepsilon,\n\\quad j \\in \\{1,2\\}.\n$$\n\nYour final answer must be the numerical value of this cell-wise limiting factor $\\theta$. Give the exact value if possible. If you choose to report a decimal, round your answer to six significant figures.",
            "solution": "The objective is to find the single largest scaling factor $\\theta \\in [0,1]$ such that the linearly scaled state, $U_{\\theta}(x_j) = \\bar{U} + \\theta(U(x_j) - \\bar{U})$, satisfies the admissibility conditions $\\rho_{\\theta}(x_j) \\ge \\varepsilon$ and $p_{\\theta}(x_j) \\ge \\varepsilon$ simultaneously for two quadrature points $j \\in \\{1,2\\}$.\n\nFirst, we must determine the conservative state vectors for the cell average, $\\bar{U}$, and at the quadrature points, $U(x_1)$ and $U(x_2)$. The conservative state vector is $U = (\\rho, m, E)^{\\top}$, where $\\rho$ is the density, $m = \\rho u$ is the momentum, and $E$ is the total energy per unit volume. The pressure $p$ is given by the ideal gas equation of state: $p = (\\gamma - 1)(E - \\frac{1}{2}\\frac{m^2}{\\rho})$.\n\nThe given data includes the ratio of specific heats $\\gamma = 1.4$ and the positivity threshold $\\varepsilon = 0.05$.\n\n**Step 1: Calculate the cell-average conservative state $\\bar{U}$**\nWe are given the cell-average primitive variables: $\\bar{\\rho} = 1$, $\\bar{u} = 0.2$, and $\\bar{p} = 1$.\nThe cell-average momentum is $\\bar{m} = \\bar{\\rho}\\bar{u} = 1 \\times 0.2 = 0.2$.\nThe cell-average total energy $\\bar{E}$ is found from the pressure relation:\n$$\n\\bar{p} = (\\gamma - 1)\\left(\\bar{E} - \\frac{1}{2}\\bar{\\rho}\\bar{u}^2\\right)\n$$\n$$\n1 = (1.4 - 1)\\left(\\bar{E} - \\frac{1}{2}(1)(0.2)^2\\right)\n$$\n$$\n1 = 0.4(\\bar{E} - 0.02)\n$$\n$$\n\\bar{E} = \\frac{1}{0.4} + 0.02 = 2.5 + 0.02 = 2.52\n$$\nThus, the cell-average conservative state is $\\bar{U} = (1, 0.2, 2.52)^{\\top}$.\n\n**Step 2: Calculate the unlimited conservative states $U(x_1)$ and $U(x_2)$**\nAt both quadrature points, we assume the velocity is equal to the cell-average velocity, $u(x_j) = \\bar{u} = 0.2$.\n\nAt quadrature point $x_1$:\nGiven primitive variables are $\\rho_1 = 0.01$ and $p_1 = 0.02$. The velocity is $u_1 = \\bar{u} = 0.2$.\nThe momentum is $m_1 = \\rho_1 u_1 = 0.01 \\times 0.2 = 0.002$.\nThe total energy $E_1$ is found from the pressure relation:\n$$\np_1 = (\\gamma - 1)\\left(E_1 - \\frac{1}{2}\\rho_1 u_1^2\\right)\n$$\n$$\n0.02 = (1.4 - 1)\\left(E_1 - \\frac{1}{2}(0.01)(0.2)^2\\right)\n$$\n$$\n0.02 = 0.4(E_1 - 0.0002)\n$$\n$$\nE_1 = \\frac{0.02}{0.4} + 0.0002 = 0.05 + 0.0002 = 0.0502\n$$\nThus, the unlimited conservative state at $x_1$ is $U(x_1) = (0.01, 0.002, 0.0502)^{\\top}$.\n\nAt quadrature point $x_2$:\nGiven primitive variables are $\\rho_2 = 1.8$ and $p_2 = 0.5$. The velocity is $u_2 = \\bar{u} = 0.2$.\nThe momentum is $m_2 = \\rho_2 u_2 = 1.8 \\times 0.2 = 0.36$.\nThe total energy $E_2$ is found from the pressure relation:\n$$\np_2 = (\\gamma - 1)\\left(E_2 - \\frac{1}{2}\\rho_2 u_2^2\\right)\n$$\n$$\n0.5 = (1.4 - 1)\\left(E_2 - \\frac{1}{2}(1.8)(0.2)^2\\right)\n$$\n$$\n0.5 = 0.4(E_2 - 0.036)\n$$\n$$\nE_2 = \\frac{0.5}{0.4} + 0.036 = 1.25 + 0.036 = 1.286\n$$\nThus, the unlimited conservative state at $x_2$ is $U(x_2) = (1.8, 0.36, 1.286)^{\\top}$.\n\n**Step 3: Formulate and solve the admissibility constraints**\nThe limited state is $U_{\\theta}(x_j) = (1-\\theta)\\bar{U} + \\theta U(x_j)$. The admissibility conditions are $\\rho_{\\theta}(x_j) \\ge \\varepsilon$ and $p_{\\theta}(x_j) \\ge \\varepsilon$.\n\nConstraint on density $\\rho_{\\theta}$:\nThe limited density is $\\rho_{\\theta}(x_j) = \\bar{\\rho} + \\theta(\\rho_j - \\bar{\\rho})$. The condition $\\rho_{\\theta}(x_j) \\ge \\varepsilon$ must hold.\nIf $\\rho_j \\ge \\bar{\\rho}$, then $\\rho_\\theta(x_j) \\ge \\bar{\\rho} = 1 > \\varepsilon = 0.05$ for $\\theta \\in [0,1]$, so no constraint on $\\theta$ (other than $\\theta \\le 1$) is imposed.\nIf $\\rho_j < \\bar{\\rho}$, the condition becomes $\\theta(\\bar{\\rho} - \\rho_j) \\le \\bar{\\rho} - \\varepsilon$, which implies $\\theta \\le \\frac{\\bar{\\rho} - \\varepsilon}{\\bar{\\rho} - \\rho_j}$.\n\nFor $x_1$: $\\rho_1 = 0.01 < \\bar{\\rho} = 1$. The condition is active.\n$$\n\\theta \\le \\frac{\\bar{\\rho} - \\varepsilon}{\\bar{\\rho} - \\rho_1} = \\frac{1 - 0.05}{1 - 0.01} = \\frac{0.95}{0.99} = \\frac{95}{99}\n$$\nFor $x_2$: $\\rho_2 = 1.8 > \\bar{\\rho} = 1$. The condition imposes no constraint on $\\theta$ other than $\\theta \\le 1$.\n\nConstraint on pressure $p_{\\theta}$:\nA crucial simplification arises from the assumption that $u(x_j) = \\bar{u}$. Let's show that this implies pressure scales linearly with $\\theta$.\nThe limited variables are $\\rho_{\\theta} = \\bar{\\rho} + \\theta(\\rho_j - \\bar{\\rho})$, $m_{\\theta} = \\bar{m} + \\theta(m_j - \\bar{m})$, and $E_{\\theta} = \\bar{E} + \\theta(E_j - \\bar{E})$.\nSince $m_j = \\rho_j u_j = \\rho_j \\bar{u}$ and $\\bar{m} = \\bar{\\rho}\\bar{u}$, we have:\n$m_{\\theta} = \\bar{\\rho}\\bar{u} + \\theta(\\rho_j\\bar{u} - \\bar{\\rho}\\bar{u}) = (\\bar{\\rho} + \\theta(\\rho_j - \\bar{\\rho}))\\bar{u} = \\rho_{\\theta}\\bar{u}$.\nThis means the velocity of the limited state is constant: $u_{\\theta} = m_{\\theta}/\\rho_{\\theta} = \\bar{u}$.\nThe limited pressure is then:\n$p_{\\theta}(x_j) = (\\gamma - 1)(E_{\\theta} - \\frac{1}{2}\\rho_{\\theta}\\bar{u}^2) = (\\gamma - 1)[(\\bar{E} + \\theta(E_j - \\bar{E})) - \\frac{1}{2}(\\bar{\\rho} + \\theta(\\rho_j - \\bar{\\rho}))\\bar{u}^2]$.\nRearranging terms:\n$p_{\\theta}(x_j) = (\\gamma - 1)[(\\bar{E} - \\frac{1}{2}\\bar{\\rho}\\bar{u}^2) + \\theta((E_j - \\frac{1}{2}\\rho_j\\bar{u}^2) - (\\bar{E} - \\frac{1}{2}\\bar{\\rho}\\bar{u}^2))]$.\nRecognizing that $p_j = (\\gamma - 1)(E_j - \\frac{1}{2}\\rho_j u_j^2) = (\\gamma - 1)(E_j - \\frac{1}{2}\\rho_j \\bar{u}^2)$ and $\\bar{p} = (\\gamma-1)(\\bar{E} - \\frac{1}{2}\\bar{\\rho}\\bar{u}^2)$, we get:\n$p_{\\theta}(x_j) = \\bar{p} + \\theta(p_j - \\bar{p})$.\nThus, pressure scales linearly. The condition $p_{\\theta}(x_j) \\ge \\varepsilon$ is handled similarly to the density constraint.\nIf $p_j \\ge \\bar{p}$, no constraint on $\\theta$.\nIf $p_j < \\bar{p}$, we need $\\theta \\le \\frac{\\bar{p} - \\varepsilon}{\\bar{p} - p_j}$.\n\nFor $x_1$: $p_1 = 0.02 < \\bar{p} = 1$. The condition is active.\n$$\n\\theta \\le \\frac{\\bar{p} - \\varepsilon}{\\bar{p} - p_1} = \\frac{1 - 0.05}{1 - 0.02} = \\frac{0.95}{0.98} = \\frac{95}{98}\n$$\nFor $x_2$: $p_2 = 0.5 < \\bar{p} = 1$. The condition is active.\n$$\n\\theta \\le \\frac{\\bar{p} - \\varepsilon}{\\bar{p} - p_2} = \\frac{1 - 0.05}{1 - 0.5} = \\frac{0.95}{0.5} = 1.9\n$$\n\n**Step 4: Determine the final value of $\\theta$**\nThe single factor $\\theta$ must satisfy all constraints simultaneously, including $\\theta \\in [0,1]$.\nThe constraints derived are:\n1. From $\\rho_{\\theta}(x_1)$: $\\theta \\le \\frac{95}{99}$\n2. From $p_{\\theta}(x_1)$: $\\theta \\le \\frac{95}{98}$\n3. From $\\rho_{\\theta}(x_2)$: No constraint apart from $\\theta \\le 1$.\n4. From $p_{\\theta}(x_2)$: $\\theta \\le 1.9$, which together with $\\theta \\in [0,1]$ means $\\theta \\le 1$.\n\nWe must find the largest $\\theta$ satisfying all these, so we take the minimum of all upper bounds:\n$$\n\\theta \\le \\min\\left(1, \\frac{95}{99}, \\frac{95}{98}, 1.9\\right)\n$$\nComparing the fractions $\\frac{95}{99}$ and $\\frac{95}{98}$, since the numerators are identical, the fraction with the larger denominator is smaller. Thus, $\\frac{95}{99} < \\frac{95}{98}$. Both fractions are less than $1$.\nThe most restrictive constraint is $\\theta \\le \\frac{95}{99}$.\nThe single largest value for the limiting factor $\\theta$ is therefore $\\frac{95}{99}$.\n\nAs a decimal rounded to six significant figures, this is $0.959596$. The problem requests the exact value if possible.",
            "answer": "$$ \\boxed{\\frac{95}{99}} $$"
        },
        {
            "introduction": "While uniform scaling limiters are effective, more sophisticated, physically-motivated corrections can offer a more surgical approach. This advanced exercise shifts the focus from applying a limiter to designing one for the specific and crucial problem of negative pressure in the Euler equations. You will derive the minimal correction to the total energy $E$ required to restore pressure positivity and, importantly, analyze the thermodynamic consequence of this numerical intervention by calculating the resulting change in specific entropy $s$ .",
            "id": "3352445",
            "problem": "Consider the compressible Euler equations for a calorically perfect ideal gas with ratio of specific heats $\\gamma>1$. Let the conservative variables be the density $\\rho>0$, the momentum vector $\\boldsymbol{m}\\in\\mathbb{R}^{d}$, and the total energy $E>0$. The thermodynamic pressure is given by the equation of state $p=(\\gamma-1)\\left(E-\\dfrac{|\\boldsymbol{m}|^{2}}{2\\rho}\\right)$. In a high-order reconstruction, it can happen that a pointwise reconstructed conservative state $(\\rho,\\boldsymbol{m},E)$ yields a pressure $p$ that violates a given positivity threshold $\\varepsilon>0$, possibly with $p<0$. You are tasked with designing a single-variable correction to enforce $p\\ge\\varepsilon$ while keeping $\\rho$ and $\\boldsymbol{m}$ unchanged, and with analyzing the entropy implications of this correction.\n\nStarting from the equation of state and the definition of specific entropy for a calorically perfect ideal gas, $s=c_{v}\\ln(p)-c_{v}\\gamma\\ln(\\rho)+s_{0}$, where $c_{v}>0$ is the specific heat at constant volume and $s_{0}$ is a constant reference, do the following:\n\n1. Among all corrections that modify only the total energy by an additive amount $\\delta E$ while keeping $\\rho$ and $\\boldsymbol{m}$ fixed, derive the explicit expression for the minimal correction $\\delta E_{\\min}$ required to ensure $p\\ge\\varepsilon$. Argue why the minimality is attained at the boundary $p=\\varepsilon$.\n\n2. For the case where the uncorrected pressure satisfies $0<p<\\varepsilon$, derive the resulting change in specific entropy $\\Delta s=s_{\\text{new}}-s_{\\text{old}}$ when the correction from part $1$ is applied. Express $\\Delta s$ in terms of $c_{v}$, $\\varepsilon$, $p$, and show that $\\Delta s\\ge 0$ under the stated condition. Discuss briefly what happens to the entropy definition when the uncorrected pressure is $p\\le 0$.\n\nProvide your final answer as a single closed-form expression for the minimal energy correction $\\delta E_{\\min}$ in terms of $\\rho$, $\\boldsymbol{m}$, $E$, $\\gamma$, and $\\varepsilon$. No numerical evaluation is required and no units should be included in the final answer.",
            "solution": "The solution is presented in two parts as requested.\n\nPart 1: Derivation of the minimal energy correction.\n\nLet the given pointwise reconstructed state be denoted by the conservative variables $(\\rho, \\boldsymbol{m}, E)$, where $\\rho > 0$ is the density, $\\boldsymbol{m} \\in \\mathbb{R}^{d}$ is the momentum vector, and $E > 0$ is the total energy per unit volume. The thermodynamic pressure $p$ for a calorically perfect ideal gas is given by the equation of state:\n$$p = (\\gamma-1)\\left(E - \\frac{|\\boldsymbol{m}|^{2}}{2\\rho}\\right)$$\nHere, $\\gamma > 1$ is the ratio of specific heats. The problem states that this uncorrected pressure $p$ may violate a positivity threshold $\\varepsilon > 0$, meaning it is possible that $p < \\varepsilon$.\n\nThe correction procedure involves modifying only the total energy $E$ by an additive amount $\\delta E$, while keeping the density $\\rho$ and the momentum vector $\\boldsymbol{m}$ unchanged. Let the new, corrected total energy be $E_{\\text{new}}$ and the new pressure be $p_{\\text{new}}$.\nThe corrected state is $(\\rho, \\boldsymbol{m}, E_{\\text{new}})$, where $E_{\\text{new}} = E + \\delta E$.\nThe new pressure $p_{\\text{new}}$ is given by:\n$$p_{\\text{new}} = (\\gamma-1)\\left(E_{\\text{new}} - \\frac{|\\boldsymbol{m}|^{2}}{2\\rho}\\right)$$\nSubstituting $E_{\\text{new}} = E + \\delta E$ into this expression, we have:\n$$p_{\\text{new}} = (\\gamma-1)\\left((E + \\delta E) - \\frac{|\\boldsymbol{m}|^{2}}{2\\rho}\\right)$$\nWe can separate the terms to relate the new pressure to the old pressure:\n$$p_{\\text{new}} = (\\gamma-1)\\left(E - \\frac{|\\boldsymbol{m}|^{2}}{2\\rho}\\right) + (\\gamma-1)\\delta E$$\nRecognizing the first term as the uncorrected pressure $p$, we obtain the linear relationship:\n$$p_{\\text{new}} = p + (\\gamma-1)\\delta E$$\nThe goal of the correction is to ensure that the new pressure satisfies the positivity constraint $p_{\\text{new}} \\ge \\varepsilon$. Substituting the expression for $p_{\\text{new}}$, we get the following inequality for $\\delta E$:\n$$p + (\\gamma-1)\\delta E \\ge \\varepsilon$$\nSolving for $\\delta E$, we find:\n$$(\\gamma-1)\\delta E \\ge \\varepsilon - p$$\nSince $\\gamma > 1$, the term $(\\gamma-1)$ is strictly positive. We can divide by it without changing the direction of the inequality:\n$$\\delta E \\ge \\frac{\\varepsilon - p}{\\gamma - 1}$$\nWe are asked to find the minimal correction, $\\delta E_{\\min}$, that satisfies this condition. The set of all valid corrections $\\delta E$ is a closed interval unbounded above. The minimum value in this set is its lower bound. Therefore, the minimal correction is achieved when equality holds:\n$$\\delta E_{\\min} = \\frac{\\varepsilon - p}{\\gamma - 1}$$\nThe minimality of this correction is a direct consequence of the monotonic relationship between $p_{\\text{new}}$ and $\\delta E$. The derivative $\\frac{dp_{\\text{new}}}{d(\\delta E)} = \\gamma-1 > 0$, indicating that $p_{\\text{new}}$ is a strictly increasing function of $\\delta E$. To satisfy the constraint $p_{\\text{new}} \\ge \\varepsilon$ with the smallest possible change $\\delta E$, one must choose the value of $\\delta E$ that results in the new pressure being exactly at the boundary of the admissible region, i.e., $p_{\\text{new}} = \\varepsilon$. This is precisely the correction $\\delta E_{\\min}$ derived above.\n\nTo express $\\delta E_{\\min}$ in terms of the primary variables $(\\rho, \\boldsymbol{m}, E, \\gamma, \\varepsilon)$, we substitute the original expression for $p$ into the formula for $\\delta E_{\\min}$:\n$$\\delta E_{\\min} = \\frac{\\varepsilon - (\\gamma-1)\\left(E - \\frac{|\\boldsymbol{m}|^{2}}{2\\rho}\\right)}{\\gamma - 1}$$\nDistributing the denominator, we get:\n$$\\delta E_{\\min} = \\frac{\\varepsilon}{\\gamma - 1} - \\left(E - \\frac{|\\boldsymbol{m}|^{2}}{2\\rho}\\right)$$\nThus, the final expression for the minimal energy correction is:\n$$\\delta E_{\\min} = \\frac{\\varepsilon}{\\gamma-1} - E + \\frac{|\\boldsymbol{m}|^{2}}{2\\rho}$$\n\nPart 2: Entropy analysis.\n\nThe specific entropy $s$ for a calorically perfect ideal gas is given by:\n$$s = c_{v}\\ln(p) - c_{v}\\gamma\\ln(\\rho) + s_{0}$$\nwhere $c_v > 0$ is the specific heat at constant volume and $s_0$ is a reference constant. This can be rewritten as $s = c_{v}\\ln\\left(\\frac{p}{\\rho^{\\gamma}}\\right) + s_{0}$.\n\nWe consider the case where the uncorrected pressure $p$ satisfies $0 < p < \\varepsilon$. The initial, uncorrected state has a well-defined entropy $s_{\\text{old}}$:\n$$s_{\\text{old}} = c_{v}\\ln(p) - c_{v}\\gamma\\ln(\\rho) + s_{0}$$\nThe correction is applied, keeping $\\rho$ fixed and changing the pressure from $p$ to $p_{\\text{new}} = \\varepsilon$ (since the minimal correction is used). The entropy of the new state, $s_{\\text{new}}$, is:\n$$s_{\\text{new}} = c_{v}\\ln(p_{\\text{new}}) - c_{v}\\gamma\\ln(\\rho) + s_{0} = c_{v}\\ln(\\varepsilon) - c_{v}\\gamma\\ln(\\rho) + s_{0}$$\nThe change in specific entropy, $\\Delta s = s_{\\text{new}} - s_{\\text{old}}$, is:\n$$\\Delta s = \\left(c_{v}\\ln(\\varepsilon) - c_{v}\\gamma\\ln(\\rho) + s_{0}\\right) - \\left(c_{v}\\ln(p) - c_{v}\\gamma\\ln(\\rho) + s_{0}\\right)$$\nThe terms involving $\\rho$ and $s_0$ cancel, leaving:\n$$\\Delta s = c_{v}\\ln(\\varepsilon) - c_{v}\\ln(p) = c_{v}\\left(\\ln(\\varepsilon) - \\ln(p)\\right)$$\nUsing the properties of logarithms, we express this as:\n$$\\Delta s = c_{v}\\ln\\left(\\frac{\\varepsilon}{p}\\right)$$\nWe must show that $\\Delta s \\ge 0$. The problem specifies the condition $0 < p < \\varepsilon$. Dividing this inequality by $p$ (which is positive) yields:\n$$1 < \\frac{\\varepsilon}{p}$$\nThe natural logarithm function, $\\ln(x)$, is a strictly increasing function for $x>0$. Therefore, applying the logarithm to the inequality gives:\n$$\\ln(1) < \\ln\\left(\\frac{\\varepsilon}{p}\\right) \\implies 0 < \\ln\\left(\\frac{\\varepsilon}{p}\\right)$$\nSince we are given that $c_v > 0$, the product $c_v\\ln\\left(\\frac{\\varepsilon}{p}\\right)$ must be strictly positive.\n$$\\Delta s = c_v\\ln\\left(\\frac{\\varepsilon}{p}\\right) > 0$$\nEquality, $\\Delta s=0$, would only occur if $\\varepsilon/p=1$, i.e., $p=\\varepsilon$. In this case, no correction is needed ($\\delta E_{\\min} = 0$), and no entropy is generated. For any $p < \\varepsilon$ requiring a correction, the process is irreversible and generates entropy, so $\\Delta s > 0$. The condition $\\Delta s \\ge 0$ is therefore satisfied.\n\nFinally, we discuss the case where the uncorrected pressure is $p \\le 0$. The definition of specific entropy involves the term $\\ln(p)$. The natural logarithm is only defined for positive real arguments. If $p \\le 0$, the term $\\ln(p)$ is undefined in the domain of real numbers. Consequently, the specific entropy $s_{\\text{old}}$ of the uncorrected state is not a well-defined physical quantity. Such a state is thermodynamically inadmissible. While the correction algorithm can still be formally applied to produce a new state with a valid pressure $p_{\\text{new}} = \\varepsilon$, one cannot speak of a \"change\" in entropy, $\\Delta s$, because the initial entropy state is ill-defined. The procedure should be interpreted not as a thermodynamic process, but as a mathematical projection from an unphysical state to the nearest state in the set of physically admissible states (in the sense of this specific correction).",
            "answer": "$$\\boxed{\\frac{\\varepsilon}{\\gamma-1} - E + \\frac{|\\boldsymbol{m}|^{2}}{2\\rho}}$$"
        }
    ]
}