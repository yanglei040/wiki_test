{
    "hands_on_practices": [
        {
            "introduction": "Understanding the design of Total Variation Diminishing (TVD) schemes begins with a concrete, hands-on calculation. This practice guides you through the core mechanics of a Flux-Corrected Transport (FCT) scheme, a foundational approach for constructing oscillation-free numerical methods. By manually applying the limiter to a sharp discontinuity, you will directly observe how the scheme prevents spurious oscillations by ensuring the corrected solution remains within local bounds .",
            "id": "3307932",
            "problem": "Consider the linear advection equation in conservative form for a scalar cell average $u$, given by $u_{t} + a\\,u_{x} = 0$ with constant wave speed $a > 0$. Use a one-dimensional conservative finite-volume discretization on a uniform grid with cell width $\\Delta x$ and time step $\\Delta t$. Assume $a = 1$, $\\Delta x = 1$, and $\\Delta t = 0.3$, so that the Courant number is $C = a\\,\\Delta t/\\Delta x = 0.3$. The initial data are a unit step: $u_{i}^{n} = 1$ for all $i \\le -1$ and $u_{i}^{n} = 0$ for all $i \\ge 0$. Focus on the interfacial region $i \\in \\{-2,-1,0,1,2\\}$, and assume that outside this region the state remains at its far-field constant values.\n\nAdopt a Flux-Corrected Transport (FCT) framework in which a first-order monotone low-order scheme is corrected toward a higher-order scheme and the correction is limited by design criteria that enforce the Total Variation Diminishing (TVD) property. Use the following components:\n- The low-order scheme is the first-order upwind finite-volume method with numerical flux $F_{i+\\frac{1}{2}}^{L}$ determined by the upwind state.\n- The high-order candidate is the second-order Lax–Wendroff scheme, cast in flux-difference form and used only to define the anti-diffusive flux (the difference between high-order and low-order numerical fluxes).\n\nImplement a single FCT time step as follows. First, compute the low-order update $u_{i}^{L}$ from the upwind fluxes. Next, form the interface anti-diffusive fluxes $A_{i+\\frac{1}{2}}$ as the difference between the Lax–Wendroff and upwind fluxes. Then, apply a limiter constrained by the TVD design criterion, namely that the corrected solution $u_{i}^{n+1}$ must not create new local extrema relative to its neighboring data at time level $n$. Use the standard local neighbor bounds drawn from the three-point stencil $\\{i-1,i,i+1\\}$ at time level $n$ to guarantee TVD monotonicity, and enforce conservation by using a single limited flux $\\tilde{A}_{i+\\frac{1}{2}}$ at each interface common to the two adjacent cells. In particular, for each cell, compute the allowable positive and negative correction budgets implied by the neighbor bounds and the low-order value $u_{i}^{L}$, and then limit the anti-diffusive flux at each face so that neither adjacent cell exceeds its allowable budget; take the final limiter at a face to be the most restrictive of its two adjacent cells.\n\nCarry out this complete procedure for the interfaces and cells near the discontinuity, determine the limited anti-diffusive flux at the interface $i+\\tfrac{1}{2} = -\\tfrac{1}{2}$, and compute the corrected cell averages $u_{i}^{n+1}$ for $i \\in \\{-1,0,1\\}$. Report as your final answer the updated cell average at $i=0$ after this single limited FCT step. Provide your final answer as a single number. No rounding is required.",
            "solution": "The user wants to solve a problem in computational fluid dynamics, specifically applying a Flux-Corrected Transport (FCT) scheme to a simple advection problem.\nThe problem statement is validated as scientifically sound, well-posed, and containing all necessary information for a unique solution. It is a standard exercise in numerical methods for conservation laws. We proceed with the solution.\n\nThe governing equation is the linear advection equation in conservative form:\n$$u_t + (au)_x = 0$$\nwhere $u$ is the conserved scalar quantity and $a$ is the constant wave speed.\nThe problem provides the following parameters:\n- Wave speed: $a=1$.\n- Grid spacing: $\\Delta x = 1$.\n- Time step: $\\Delta t = 0.3$.\n- The Courant number is $C = \\frac{a \\Delta t}{\\Delta x} = \\frac{1 \\cdot 0.3}{1} = 0.3$.\n\nThe initial condition is a unit step function discretized as cell averages:\n$$u_i^n = \\begin{cases} 1 & \\text{for } i \\le -1 \\\\ 0 & \\text{for } i \\ge 0 \\end{cases}$$\nWe are interested in the cells around the discontinuity, specifically for $i \\in \\{-2, -1, 0, 1, 2\\}$. The initial values are:\n$u_{-2}^n = 1$\n$u_{-1}^n = 1$\n$u_0^n = 0$\n$u_1^n = 0$\n$u_2^n = 0$\n\nThe FCT procedure consists of several steps, which we will follow meticulously.\n\n**Step 1: Low-Order Update**\nThe low-order scheme is the first-order upwind method. The finite-volume update is given by:\n$$u_i^L = u_i^n - \\frac{\\Delta t}{\\Delta x} (F_{i+1/2}^L - F_{i-1/2}^L)$$\nSince the wave speed $a=1 > 0$, the upwind numerical flux is $F_{i+1/2}^L = a u_i^n = u_i^n$.\nThe update equation becomes:\n$$u_i^L = u_i^n - \\frac{\\Delta t}{\\Delta x} (u_i^n - u_{i-1}^n) = u_i^n - C(u_i^n - u_{i-1}^n)$$\nWe compute the low-order solution $u_i^L$ for the cells of interest:\n- For $i=-1$: $u_{-1}^L = u_{-1}^n - C(u_{-1}^n - u_{-2}^n) = 1 - 0.3(1 - 1) = 1$.\n- For $i=0$: $u_0^L = u_0^n - C(u_0^n - u_{-1}^n) = 0 - 0.3(0 - 1) = 0.3$.\n- For $i=1$: $u_1^L = u_1^n - C(u_1^n - u_0^n) = 0 - 0.3(0 - 0) = 0$.\n\nThe low-order solution field after one time step is: $u_{-1}^L = 1$, $u_0^L = 0.3$, $u_1^L = 0$.\n\n**Step 2: Anti-diffusive Fluxes**\nThe anti-diffusive flux $A_{i+1/2}$ is the difference between the high-order (Lax-Wendroff) flux $F_{i+1/2}^H$ and the low-order (upwind) flux $F_{i+1/2}^L$:\n$$A_{i+1/2} = F_{i+1/2}^H - F_{i+1/2}^L$$\nThe Lax-Wendroff flux for linear advection is $F_{i+1/2}^H = \\frac{a}{2}(u_i^n + u_{i+1}^n) - \\frac{a^2 \\Delta t}{2 \\Delta x}(u_{i+1}^n - u_i^n) = \\frac{a}{2}(1-C)u_{i+1}^n + \\frac{a}{2}(1+C)u_i^n$.\nThe upwind flux is $F_{i+1/2}^L = a u_i^n$.\nThe anti-diffusive flux is therefore:\n$$A_{i+1/2} = \\left(\\frac{a}{2}(1-C)u_{i+1}^n + \\frac{a}{2}(1+C)u_i^n\\right) - a u_i^n = \\frac{a}{2}(1-C)(u_{i+1}^n - u_i^n)$$\nSubstituting the given values $a=1$ and $C=0.3$:\n$$A_{i+1/2} = \\frac{1}{2}(1-0.3)(u_{i+1}^n - u_i^n) = 0.35(u_{i+1}^n - u_i^n)$$\nWe compute the anti-diffusive fluxes at the interfaces relevant to cells $i \\in \\{-1, 0, 1\\}$, which are interfaces $i \\in \\{-3/2, -1/2, 1/2, 3/2\\}$.\n- $A_{-3/2} = 0.35(u_{-1}^n - u_{-2}^n) = 0.35(1 - 1) = 0$.\n- $A_{-1/2} = 0.35(u_0^n - u_{-1}^n) = 0.35(0 - 1) = -0.35$.\n- $A_{1/2} = 0.35(u_1^n - u_0^n) = 0.35(0 - 0) = 0$.\n- $A_{3/2} = 0.35(u_2^n - u_1^n) = 0.35(0 - 0) = 0$.\nThe only non-zero anti-diffusive flux is at the interface $i=-1/2$.\n\n**Step 3: Limiter Application**\nThe final corrected solution $u_i^{n+1}$ is computed by adding a limited portion of the anti-diffusive correction to the low-order solution:\n$$u_i^{n+1} = u_i^L - \\frac{\\Delta t}{\\Delta x}(\\tilde{A}_{i+1/2} - \\tilde{A}_{i-1/2})$$\nwhere $\\tilde{A}$ is the limited anti-diffusive flux. The term $\\frac{\\Delta t}{\\Delta x}\\tilde{A}_{i-1/2}$ represents anti-diffusion entering cell $i$ from the left, while $\\frac{\\Delta t}{\\Delta x}\\tilde{A}_{i+1/2}$ represents anti-diffusion leaving cell $i$ to the right. A positive flux $\\tilde{A}_{j+1/2}$ moves \"correction mass\" from cell $j$ to cell $j+1$.\n\nThe TVD constraint requires that no new local extrema are created. The updated value $u_i^{n+1}$ must lie within the bounds set by its neighbors at time level $n$:\n$$u_i^{\\min} \\le u_i^{n+1} \\le u_i^{\\max}$$\nwhere $u_i^{\\min} = \\min(u_{i-1}^n, u_i^n, u_{i+1}^n)$ and $u_i^{\\max} = \\max(u_{i-1}^n, u_i^n, u_{i+1}^n)$.\nFrom these bounds, we define the available \"room\" for correction for cell $i$ relative to its low-order state $u_i^L$:\n- Maximum allowed increase (positive budget): $Q_i^+ = u_i^{\\max} - u_i^L$.\n- Maximum allowed decrease (negative budget): $Q_i^- = u_i^L - u_i^{\\min}$.\n\nLet's compute these for the cells adjacent to the non-zero flux $A_{-1/2}$, i.e., cells $i=-1$ and $i=0$.\n- For $i=-1$:\n  $u_{-1}^{\\min} = \\min(u_{-2}^n, u_{-1}^n, u_0^n) = \\min(1, 1, 0) = 0$.\n  $u_{-1}^{\\max} = \\max(u_{-2}^n, u_{-1}^n, u_0^n) = \\max(1, 1, 0) = 1$.\n  $u_{-1}^L = 1$.\n  $Q_{-1}^+ = u_{-1}^{\\max} - u_{-1}^L = 1 - 1 = 0$.\n  $Q_{-1}^- = u_{-1}^L - u_{-1}^{\\min} = 1 - 0 = 1$.\n- For $i=0$:\n  $u_0^{\\min} = \\min(u_{-1}^n, u_0^n, u_1^n) = \\min(1, 0, 0) = 0$.\n  $u_0^{\\max} = \\max(u_{-1}^n, u_0^n, u_1^n) = \\max(1, 0, 0) = 1$.\n  $u_0^L = 0.3$.\n  $Q_0^+ = u_0^{\\max} - u_0^L = 1 - 0.3 = 0.7$.\n  $Q_0^- = u_0^L - u_0^{\\min} = 0.3 - 0 = 0.3$.\n\nNow we limit the flux $A_{-1/2} = -0.35$.\nThe change in cell $i$ due to the anti-diffusive fluxes is $\\delta_i = -\\frac{\\Delta t}{\\Delta x}(\\tilde{A}_{i+1/2} - \\tilde{A}_{i-1/2}) = -0.3(\\tilde{A}_{i+1/2} - \\tilde{A}_{i-1/2})$.\nThe flux $A_{-1/2}$ is negative, indicating a transfer of \"correction mass\" from cell $i=0$ (donor) to cell $i=-1$ (receiver).\nThe amount of correction mass to be transferred is $M = \\frac{\\Delta t}{\\Delta x} |A_{-1/2}| = 0.3 \\times |-0.35| = 0.105$.\nThis transfer attempts to increase $u_{-1}$ by $0.105$ and decrease $u_0$ by $0.105$.\n\nWe check this against the budgets of the two cells:\n- The receiving cell is $i=-1$. Its capacity to increase is $Q_{-1}^+ = 0$. The requested increase is $0.105$. Since $0.105 > 0$, the receiver cell cannot accommodate this transfer. The maximum it can accept is $0$.\n- The donating cell is $i=0$. Its capacity to decrease is $Q_0^- = 0.3$. The requested decrease is $0.105$. Since $0.105 \\le 0.3$, the donor cell can afford this transfer.\n\nThe final limited flux must be acceptable to both adjacent cells. We take the most restrictive constraint. The amount of \"correction mass\" transferred, $M^*$, must be no more than what the donor can give and no more than what the receiver can accept.\n$$M^* = \\min(\\text{requested transfer, donor capacity, receiver capacity})$$\n$$M^* = \\min(M, Q_0^-, Q_{-1}^+) = \\min(0.105, 0.3, 0) = 0$$\nThe limited transfer amount is $M^*=0$. This implies that the limited flux which causes this transfer must be zero.\nThe limited transfer is related to the limited flux by $M^* = \\frac{\\Delta t}{\\Delta x} |\\tilde{A}_{-1/2}|$.\nSince $M^* = 0$, we have $\\tilde{A}_{-1/2} = 0$.\n\nAll other anti-diffusive fluxes were already zero, so their limited counterparts are also zero. $\\tilde{A}_{i+1/2} = 0$ for all $i$.\n\n**Step 4: Final Update**\nWe compute the corrected cell averages using the limited fluxes.\n$$u_i^{n+1} = u_i^L - 0.3(\\tilde{A}_{i+1/2} - \\tilde{A}_{i-1/2})$$\nSince all $\\tilde{A}_{i+1/2}$ are zero, the correction term is zero for all cells. The final solution is simply the low-order solution.\n$$u_i^{n+1} = u_i^L$$\n- For $i=-1$: $u_{-1}^{n+1} = u_{-1}^L = 1$.\n- For $i=0$: $u_0^{n+1} = u_0^L = 0.3$.\n- For $i=1$: $u_1^{n+1} = u_1^L = 0$.\n\nThe updated cell average at $i=0$ is $u_0^{n+1} = 0.3$.\nThis result is characteristic of TVD schemes at sharp discontinuities; the anti-compressive nature of the higher-order scheme is fully suppressed by the monotonicity constraint, causing the scheme to revert locally to its first-order diffusive component.\nThe final answer required is the value of $u_0^{n+1}$.",
            "answer": "$$\\boxed{0.3}$$"
        },
        {
            "introduction": "Beyond the mechanics, the design of a robust TVD scheme hinges on respecting the underlying physics of information flow. This exercise challenges you to reason from first principles about the definition of the \"smoothness indicator,\" $r$, which is used to modulate the scheme's accuracy. You will discover why this indicator must be defined relative to the upwind direction to correctly interpret the local solution profile, a critical concept for building schemes that are stable for complex problems where wave directions can change .",
            "id": "3307900",
            "problem": "Consider the scalar conservation law $u_t + f(u)_x = 0$ on a uniform grid with spatial spacing $\\Delta x$ and time step $\\Delta t$. The local characteristic speed is $a = f'(u)$, which may change sign in space and time. Define the left and right one-sided differences $\\Delta^- u_i = u_i - u_{i-1}$ and $\\Delta^+ u_i = u_{i+1} - u_i$. A high-resolution flux-limited finite volume scheme builds interfacial states by a piecewise linear reconstruction with a limited slope, and advances the solution using upwind-biased numerical fluxes. The slope limiter is a function $\\phi(r)$ of a smoothness indicator $r$; the numerical Total Variation Diminishing (TVD) property requires the limiter design and the definition of $r$ to be consistent with the direction of information propagation.\n\nStarting from the conservation law and the finite volume update $u_i^{n+1} = u_i^n - \\lambda\\left(F_{i+1/2} - F_{i-1/2}\\right)$, where $\\lambda = \\Delta t / \\Delta x$ and $F_{i\\pm1/2}$ are upwind fluxes constructed from reconstructed left/right states, derive from first principles why the definition of the smoothness indicator $r$ must be aligned with the upwind direction. In particular, focus on how the sign of the characteristic speed $a$ determines whether left- or right-biased differences are upwind. Use the discrete form of the total variation $\\mathrm{TV}(u^n) = \\sum_i \\left|u_{i+1}^n - u_i^n\\right|$ and the monotonicity criteria for three-point schemes to argue which definitions of $r$ maintain the TVD property when $a$ changes sign, and which do not. Then, choose the option that correctly provides symmetric definitions of $r$ for right-going and left-going waves and a justification that ensures TVD across sign changes in $a$.\n\nA. Use $r_i = \\dfrac{\\Delta^- u_i}{\\Delta^+ u_i}$ for all interfaces and all signs of $a$, and apply the same limiter $\\phi(r)$ everywhere. The symmetry of the ratio ensures the TVD property regardless of the sign of $a$.\n\nB. For right-going waves with $a>0$ at an interface, use $r_i^{(+)} = \\dfrac{\\Delta^- u_i}{\\Delta^+ u_i}$; for left-going waves with $a<0$, use $r_i^{(-)} = \\dfrac{\\Delta^+ u_i}{\\Delta^- u_i}$. Choose a limiter $\\phi(r)$ that satisfies the standard TVD constraints on the smoothness diagram for $r \\ge 0$ and set $\\phi(r) = 0$ when $r \\le 0$. This aligns the limiter’s correction with the upwind gradient and preserves TVD when $a$ changes sign.\n\nC. Use $r_i = \\dfrac{\\left|\\Delta^- u_i\\right|}{\\left|\\Delta^+ u_i\\right|}$ for all interfaces, so that $r_i \\ge 0$ always. Select any monotone nondecreasing limiter function $\\phi(r)$; the positivity of $r$ guarantees TVD irrespective of the sign of $a$.\n\nD. Define $r_i$ using central differences, $r_i = \\dfrac{u_{i+1} - u_{i-1}}{u_{i+2} - u_i}$, to make $r_i$ independent of the sign of $a$. With this direction-free smoothness indicator, any standard limiter $\\phi(r)$ will maintain TVD even when $a$ changes sign.",
            "solution": "The user wants me to validate the problem statement and, if valid, provide a detailed solution.\n\n### Step 1: Extract Givens\nThe problem provides the following information:\n- A scalar conservation law: $u_t + f(u)_x = 0$.\n- A uniform grid with spatial spacing $\\Delta x$ and time step $\\Delta t$.\n- The local characteristic speed: $a = f'(u)$.\n- One-sided difference operators: $\\Delta^- u_i = u_i - u_{i-1}$ and $\\Delta^+ u_i = u_{i+1} - u_i$.\n- A finite volume update rule: $u_i^{n+1} = u_i^n - \\lambda\\left(F_{i+1/2} - F_{i-1/2}\\right)$, where $\\lambda = \\Delta t / \\Delta x$.\n- The numerical fluxes $F_{i\\pm1/2}$ are constructed using upwind biasing and a high-resolution, flux-limited approach with a piecewise linear reconstruction.\n- The reconstruction uses a slope limiter, which is a function $\\phi(r)$ of a smoothness indicator $r$.\n- The definition of total variation is given as $\\mathrm{TV}(u^n) = \\sum_i \\left|u_{i+1}^n - u_i^n\\right|$.\n- The core task is to derive from first principles why the definition of the smoothness indicator $r$ must be aligned with the upwind direction, determined by the sign of the characteristic speed $a$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem statement is scrutinized based on the validation criteria.\n\n- **Scientifically Grounded**: The problem is firmly rooted in the theory of numerical methods for hyperbolic partial differential equations, a major topic in computational fluid dynamics and applied mathematics. The concept of Total Variation Diminishing (TVD) schemes, flux limiters, and upwinding are standard and fundamental to the field. All provided equations and definitions are standard.\n- **Well-Posed**: The problem is well-posed. It asks for the derivation of a key design principle for TVD schemes (the upwind-dependent definition of the smoothness indicator $r$) and to apply this principle to evaluate the given options. The premise is clear, and a unique, logically derivable answer exists.\n- **Objective**: The problem is stated in precise, objective, and technical language common to the field. Terms like \"characteristic speed,\" \"flux-limited,\" and \"smoothness indicator\" have well-defined meanings.\n\nThe problem statement does not exhibit any of the flaws listed in the validation checklist. It is not scientifically unsound, non-formalizable, incomplete, unrealistic, ill-posed, trivial, or unverifiable.\n\n### Step 3: Verdict and Action\nThe problem statement is **valid**. I will now proceed with the derivation and solution.\n\n### Derivation from First Principles\nThe goal of a high-resolution scheme for a hyperbolic conservation law is to achieve at least second-order accuracy in smooth regions of the solution while preventing spurious oscillations (Gibbs phenomena) near discontinuities. The Total Variation Diminishing (TVD) property, $\\mathrm{TV}(u^{n+1}) \\le \\mathrm{TV}(u^n)$, is a sufficient condition for preventing such oscillations.\n\nHigh-resolution schemes achieve this by blending a low-order (first-order) monotone scheme with a high-order scheme. The first-order upwind scheme is the canonical example of a monotone (and thus TVD) scheme, but it is highly diffusive. Higher-order schemes like Lax-Wendroff are less diffusive but can introduce oscillations. The blending is controlled by a flux limiter function, $\\phi$, which depends on a \"smoothness indicator,\" $r$.\n\nThe essence of the method lies in the term \"upwind.\" Hyperbolic equations describe the propagation of information along characteristics. The direction of this propagation is given by the sign of the characteristic speed, $a = f'(u)$. A stable numerical scheme must respect this directionality; this is the principle of upwinding.\n\nLet's analyze the role of the smoothness indicator $r$. It is designed to measure the local \"smoothness\" of the solution profile by comparing consecutive gradients. Where the solution is smooth (e.g., a straight line or a gentle curve), consecutive gradients are nearly equal, and their ratio $r$ should be close to $1$. In such regions, the limiter $\\phi(r)$ should allow for a higher-order correction. Near extrema or discontinuities, consecutive gradients differ significantly in magnitude or sign, causing $r$ to be far from $1$ or negative. In these regions, the limiter $\\phi(r)$ must reduce or eliminate the higher-order correction, forcing the scheme to revert locally to the robust first-order upwind method to maintain monotonicity.\n\nThe crucial insight is that the comparison of gradients must be consistent with the direction of information flow. The ratio $r$ should always be defined as:\n$$\nr = \\frac{\\text{gradient upwind of the wave}}{\\text{gradient downwind of the wave}}\n$$\nLet's consider the reconstruction within cell $i$, which is used to determine the fluxes $F_{i-1/2}$ and $F_{i+1/2}$. The relevant gradients are the backward difference, representing the gradient to the left, $\\frac{\\Delta^- u_i}{\\Delta x} = \\frac{u_i - u_{i-1}}{\\Delta x}$, and the forward difference, representing the gradient to the right, $\\frac{\\Delta^+ u_i}{\\Delta x} = \\frac{u_{i+1} - u_i}{\\Delta x}$.\n\nCase 1: Right-going wave ($a > 0$)\nInformation propagates from left to right. For the reconstruction in cell $i$, the \"upwind\" direction is from the left (from cell $i-1$). The \"downwind\" direction is to the right (towards cell $i+1$). Therefore, the upwind gradient is proportional to $\\Delta^- u_i$ and the downwind gradient is proportional to $\\Delta^+ u_i$. The smoothness indicator $r_i$ for cell $i$ must be defined as:\n$$\nr_i = \\frac{\\text{upwind gradient}}{\\text{downwind gradient}} = \\frac{u_i - u_{i-1}}{u_{i+1} - u_i} = \\frac{\\Delta^- u_i}{\\Delta^+ u_i}\n$$\n\nCase 2: Left-going wave ($a < 0$)\nInformation propagates from right to left. For the reconstruction in cell $i$, the \"upwind\" direction is now from the right (from cell $i+1$). The \"downwind\" direction is to the left (towards cell $i-1$). The upwind gradient is now proportional to $\\Delta^+ u_i$ and the downwind gradient is proportional to $\\Delta^- u_i$. To maintain the physical meaning of $r$ as the ratio of upwind to downwind gradients, its definition must be inverted:\n$$\nr_i = \\frac{\\text{upwind gradient}}{\\text{downwind gradient}} = \\frac{u_{i+1} - u_i}{u_i - u_{i-1}} = \\frac{\\Delta^+ u_i}{\\Delta^- u_i}\n$$\n\nThus, the definition of $r$ must depend on the sign of $a$ to correctly identify the upwind and downwind gradients. Using a single definition for all $a$ would mean that for one of the cases ($a>0$ or $a<0$), $r$ would be defined as the ratio of downwind-to-upwind gradients. A limiter function $\\phi(r)$ designed based on the standard upwind-to-downwind ratio would then be applied to an incorrect input, leading to a breakdown of the TVD property and likely causing numerical instability or oscillations. The condition that $\\phi(r)=0$ for $r \\le 0$ ensures monotonicity by switching off the high-order correction at extrema, where consecutive gradients have opposite signs.\n\n### Option-by-Option Analysis\n\n**A. Use $r_i = \\dfrac{\\Delta^- u_i}{\\Delta^+ u_i}$ for all interfaces and all signs of $a$, and apply the same limiter $\\phi(r)$ everywhere. The symmetry of the ratio ensures the TVD property regardless of the sign of $a$.**\nThis approach is fundamentally flawed. As derived above, this definition of $r_i$ is correct only for right-going waves ($a > 0$). For left-going waves ($a < 0$), it represents the ratio of the downwind gradient to the upwind gradient. Applying a standard limiter function $\\phi(r)$ to this inverted ratio will not satisfy the TVD conditions. The claim about \"symmetry\" is unsubstantiated and incorrect.\n**Verdict: Incorrect.**\n\n**B. For right-going waves with $a>0$ at an interface, use $r_i^{(+)} = \\dfrac{\\Delta^- u_i}{\\Delta^+ u_i}$; for left-going waves with $a<0$, use $r_i^{(-)} = \\dfrac{\\Delta^+ u_i}{\\Delta^- u_i}$. Choose a limiter $\\phi(r)$ that satisfies the standard TVD constraints on the smoothness diagram for $r \\ge 0$ and set $\\phi(r) = 0$ when $r \\le 0$. This aligns the limiter’s correction with the upwind gradient and preserves TVD when $a$ changes sign.**\nThis option correctly implements the principle derived from first principles. It defines the smoothness indicator $r$ as the ratio of the upwind gradient to the downwind gradient, with the definition switching based on the sign of the characteristic speed $a$. This ensures that the limiter function $\\phi(r)$ always receives a physically meaningful input, allowing it to correctly regulate the numerical flux and maintain the TVD property across regions where the wave direction changes. The condition $\\phi(r) = 0$ for $r \\le 0$ is also a standard and necessary part of the TVD limiter design to handle non-monotonic regions.\n**Verdict: Correct.**\n\n**C. Use $r_i = \\dfrac{\\left|\\Delta^- u_i\\right|}{\\left|\\Delta^+ u_i\\right|}$ for all interfaces, so that $r_i \\ge 0$ always. Select any monotone nondecreasing limiter function $\\phi(r)$; the positivity of $r$ guarantees TVD irrespective of the sign of $a$.**\nThis option is incorrect for multiple reasons. First, by taking absolute values, it discards crucial information about the signs of the gradients. The condition $r<0$ is the primary signal of a local extremum, where the limiter must be most aggressive (i.e., $\\phi(r)=0$). This definition makes $r$ positive at extrema, potentially leading to the creation of new oscillations. Second, even in monotonic regions, this definition is equivalent to option A and thus fails to adapt to the upwind direction for $a < 0$. Third, the claim that any monotone non-decreasing limiter guarantees TVD is false; limiters must lie within a specific region in the $\\phi-r$ plane (the TVD region), and being monotone non-decreasing is not a sufficient condition.\n**Verdict: Incorrect.**\n\n**D. Define $r_i$ using central differences, $r_i = \\dfrac{u_{i+1} - u_{i-1}}{u_{i+2} - u_i}$, to make $r_i$ independent of the sign of $a$. With this direction-free smoothness indicator, any standard limiter $\\phi(r)$ will maintain TVD even when $a$ changes sign.**\nThis option misunderstands the fundamental principle of upwinding. The goal is not to be \"direction-free.\" The physics of hyperbolic problems is directional, and the numerical method must respect this. Attempting to create a direction-independent indicator negates the very concept of an upwind-biased scheme. The proposed definition of $r_i$ is non-standard, compares gradients over an unusual stencil, and has no clear physical interpretation in the context of upwinding. There is no theoretical basis to suggest that applying a standard limiter $\\phi$ to this unorthodox ratio $r_i$ would result in a TVD scheme.\n**Verdict: Incorrect.**",
            "answer": "$$\\boxed{B}$$"
        },
        {
            "introduction": "A complete numerical method consists of both a spatial discretization and a time integrator, and both must cooperate to preserve the desired stability properties. This practice focuses on the temporal aspect of TVD scheme design, exploring how the choice of time-stepping algorithm affects the overall scheme's stability limit. By analyzing and comparing a multi-derivative method with a modern Strong Stability Preserving (SSP) Runge-Kutta method, you will learn the criteria that time integrators must satisfy to guarantee the TVD property established by the spatial operator .",
            "id": "3307906",
            "problem": "Consider the linear advection equation $u_{t} + a\\,u_{x} = 0$ with $a>0$ on a uniform periodic grid with spacing $\\Delta x$, discretized in space by the first-order upwind semi-discretization\n$$\n\\frac{d u_{j}}{d t} \\;=\\; L(u)_{j} \\;=\\; -\\frac{a}{\\Delta x}\\left(u_{j}-u_{j-1}\\right),\n$$\nwhere $u_{j}(t)$ approximates $u(x_{j},t)$ and $x_{j}=j\\,\\Delta x$. It is known that the forward Euler method $u^{n+1} = u^{n} + \\Delta t\\,L(u^{n})$ is Total Variation Diminishing (TVD) for Courant number $\\nu = a\\,\\Delta t/\\Delta x$ in the range $0 \\le \\nu \\le 1$. In the context of designing TVD schemes, two time integrators are considered:\n\n- A two-derivative Taylor time integrator defined by\n$$\nu^{n+1} \\;=\\; u^{n} \\;+\\; \\Delta t\\,L(u^{n}) \\;+\\; \\frac{1}{2}\\,\\Delta t^{2}\\,L^{2}(u^{n}),\n$$\nwith $L^{2}$ denoting the composition $L\\circ L$ applied to the semi-discrete operator $L$.\n\n- The third-order Strong Stability Preserving (SSP) Runge–Kutta (RK) method (order $3$, $3$ stages), which, when written in Shu–Osher form, is constructed as a convex combination of forward Euler updates.\n\nUsing only the fundamental definition of the TVD property in terms of total variation of piecewise constant cell averages, and standard facts about monotone linear schemes, do the following:\n\n1. Establish a necessary and sufficient constraint on the Courant number $\\nu$ under which the two-derivative Taylor time integrator applied to the given spatial semi-discretization is TVD. Your argument should be based on representing the fully discrete update as a linear convex combination of grid-point values with nonnegative coefficients that sum to $1$, and explaining why this suffices for the TVD property for linear scalar problems.\n\n2. For the third-order SSP RK method described above, determine the largest $\\Delta t$ for which TVD is guaranteed, given that the spatial operator is TVD under forward Euler whenever $0 \\le \\nu \\le 1$. Your reasoning should rely on the convex combination (Shu–Osher) structure that expresses each stage as a convex combination of forward Euler steps.\n\nFinally, let $\\Delta t_{\\max,\\mathrm{TD}}$ denote the maximal time step that ensures TVD for the two-derivative Taylor method on this problem, and let $\\Delta t_{\\max,\\mathrm{SSPRK3}}$ denote the maximal time step that ensures TVD for the third-order SSP RK method on this problem. Compute the ratio\n$$\n\\mathcal{R} \\;=\\; \\frac{\\Delta t_{\\max,\\mathrm{TD}}}{\\Delta t_{\\max,\\mathrm{SSPRK3}}}\n$$\nas a single real number. No rounding is required; give the exact value with no units.",
            "solution": "We begin from the method-of-lines semi-discretization\n$$\n\\frac{d u_{j}}{d t} \\;=\\; L(u)_{j} \\;=\\; -\\frac{a}{\\Delta x}\\left(u_{j}-u_{j-1}\\right),\n$$\nwith $a>0$, and define the Courant number $\\nu = a\\,\\Delta t/\\Delta x$. The Total Variation Diminishing (TVD) property for linear scalar schemes on a uniform mesh can be guaranteed by monotonicity: a linear update of the form\n$$\nu^{n+1}_{j} \\;=\\; \\sum_{k} \\alpha_{k}\\,u^{n}_{j-k}\n$$\nwith coefficients $\\alpha_{k} \\ge 0$ and $\\sum_{k}\\alpha_{k} = 1$ is a contraction in the discrete bounded variation seminorm $\\mathrm{TV}(u) = \\sum_{j} |u_{j} - u_{j-1}|$, and thus is TVD. This follows from the convexity of the $\\ell_{1}$ norm and the shift-invariance of the stencil: if $\\mathbf{A}$ is a Toeplitz matrix with nonnegative entries and row sums equal to $1$, then $\\|\\mathbf{D}\\mathbf{A}\\|_{1} \\le \\|\\mathbf{D}\\|_{1}$, where $\\mathbf{D}$ is the first-difference operator, implying $\\mathrm{TV}(u^{n+1}) \\le \\mathrm{TV}(u^{n})$.\n\nStep 1: TVD condition for the two-derivative Taylor time integrator.\n\nThe two-derivative Taylor integrator is\n$$\nu^{n+1} \\;=\\; u^{n} \\;+\\; \\Delta t\\,L(u^{n}) \\;+\\; \\frac{1}{2}\\,\\Delta t^{2}\\,L^{2}(u^{n}).\n$$\nFor the given linear constant-coefficient operator $L$, we can compute $L^{2}$. First,\n$$\nL(u)_{j} \\;=\\; -\\frac{a}{\\Delta x}\\left(u_{j}-u_{j-1}\\right).\n$$\nThen\n$$\nL^{2}(u)_{j} \\;=\\; L(L(u))_{j} \\;=\\; -\\frac{a}{\\Delta x}\\left(L(u)_{j}-L(u)_{j-1}\\right)\n\\;=\\; -\\frac{a}{\\Delta x}\\left(-\\frac{a}{\\Delta x}(u_{j}-u_{j-1}) + \\frac{a}{\\Delta x}(u_{j-1}-u_{j-2})\\right)\n\\;=\\; \\frac{a^{2}}{\\Delta x^{2}}\\left(u_{j}-2u_{j-1}+u_{j-2}\\right).\n$$\nTherefore,\n$$\nu^{n+1}_{j}\n= u^{n}_{j} + \\Delta t\\left(-\\frac{a}{\\Delta x}(u^{n}_{j}-u^{n}_{j-1})\\right) + \\frac{1}{2}\\Delta t^{2}\\,\\frac{a^{2}}{\\Delta x^{2}}\\left(u^{n}_{j}-2u^{n}_{j-1}+u^{n}_{j-2}\\right).\n$$\nIntroducing $\\nu = a\\,\\Delta t/\\Delta x$, we obtain the explicit three-point stencil\n$$\nu^{n+1}_{j} \\;=\\; c_{0}(\\nu)\\,u^{n}_{j} \\;+\\; c_{1}(\\nu)\\,u^{n}_{j-1} \\;+\\; c_{2}(\\nu)\\,u^{n}_{j-2},\n$$\nwith coefficients\n$$\nc_{0}(\\nu) \\;=\\; 1 - \\nu + \\frac{1}{2}\\nu^{2},\\qquad\nc_{1}(\\nu) \\;=\\; \\nu - \\nu^{2},\\qquad\nc_{2}(\\nu) \\;=\\; \\frac{1}{2}\\nu^{2}.\n$$\nThese coefficients satisfy\n$$\nc_{0}(\\nu) + c_{1}(\\nu) + c_{2}(\\nu) \\;=\\; 1\n$$\nfor all $\\nu$. To ensure TVD via monotonicity, we require $c_{k}(\\nu) \\ge 0$ for $k \\in \\{0,1,2\\}$. The conditions are:\n- $c_{2}(\\nu) = \\frac{1}{2}\\nu^{2} \\ge 0$ for all $\\nu$ (trivially true).\n- $c_{1}(\\nu) = \\nu - \\nu^{2} \\ge 0$ if and only if $0 \\le \\nu \\le 1$.\n- $c_{0}(\\nu) = 1 - \\nu + \\frac{1}{2}\\nu^{2} \\ge 0$ holds for all $\\nu$, since this quadratic has discriminant $\\Delta = (-1)^{2} - 2 = -1 < 0$ and its leading coefficient is positive, implying $c_{0}(\\nu) > 0$ for all real $\\nu$; equivalently, its minimum occurs at $\\nu = 1$ with value $c_{0}(1) = \\frac{1}{2}$.\n\nThus, the two-derivative Taylor update is a convex combination with nonnegative coefficients if and only if $0 \\le \\nu \\le 1$. By the monotonicity argument, this condition is both necessary and sufficient for TVD of this fully discrete scheme on the given semi-discretization. Translating $\\nu \\le 1$ into a time-step bound yields\n$$\n\\Delta t_{\\max,\\mathrm{TD}} \\;=\\; \\frac{\\Delta x}{a}.\n$$\n\nStep 2: TVD condition and maximal $\\Delta t$ for the third-order Strong Stability Preserving Runge–Kutta method.\n\nThe third-order Strong Stability Preserving (SSP) Runge–Kutta method with three stages can be written in Shu–Osher form as a convex combination of forward Euler steps applied to intermediate states. Concretely, its stages can be expressed as\n$$\n\\begin{aligned}\nu^{(1)} \\;=&\\; u^{n} + \\Delta t\\,L(u^{n}),\\\\\nu^{(2)} \\;=&\\; \\frac{3}{4}\\,u^{n} + \\frac{1}{4}\\left(u^{(1)} + \\Delta t\\,L(u^{(1)})\\right),\\\\\nu^{n+1} \\;=&\\; \\frac{1}{3}\\,u^{n} + \\frac{2}{3}\\left(u^{(2)} + \\Delta t\\,L(u^{(2)})\\right).\n\\end{aligned}\n$$\nAt each appearance, the forward Euler building block has the same time step $\\Delta t$. If the forward Euler update $u \\mapsto u + \\Delta t\\,L(u)$ is TVD for $0 \\le \\nu \\le 1$, then each stage, being a convex combination of TVD operations, is also TVD provided $\\Delta t \\le \\Delta t_{\\mathrm{FE}}$, where $\\Delta t_{\\mathrm{FE}} = \\Delta x/a$ is the forward Euler limit dictated by $0 \\le \\nu \\le 1$. Since the Shu–Osher form does not amplify $\\Delta t$ beyond the forward Euler value in any stage, the largest $\\Delta t$ that guarantees TVD for this SSP RK method is exactly the forward Euler limit:\n$\n\\Delta t_{\\max,\\mathrm{SSPRK3}} = \\Delta t_{\\mathrm{FE}} = \\Delta x/a.\n$\n\nFinal ratio.\n\nFrom Step $1$ and Step $2$, we have\n$$\n\\Delta t_{\\max,\\mathrm{TD}} \\;=\\; \\frac{\\Delta x}{a},\\qquad\n\\Delta t_{\\max,\\mathrm{SSPRK3}} \\;=\\; \\frac{\\Delta x}{a}.\n$$\nTherefore,\n$$\n\\mathcal{R} \\;=\\; \\frac{\\Delta t_{\\max,\\mathrm{TD}}}{\\Delta t_{\\max,\\mathrm{SSPRK3}}} \\;=\\; \\frac{\\Delta x/a}{\\Delta x/a} \\;=\\; 1.\n$$\nThis value is exact and needs no rounding.",
            "answer": "$$\\boxed{1}$$"
        }
    ]
}