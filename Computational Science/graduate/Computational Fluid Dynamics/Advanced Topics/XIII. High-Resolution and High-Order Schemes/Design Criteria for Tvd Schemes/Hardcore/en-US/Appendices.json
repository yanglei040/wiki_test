{
    "hands_on_practices": [
        {
            "introduction": "This exercise provides a step-by-step application of the Flux-Corrected Transport (FCT) algorithm, a pioneering TVD method. By manually calculating the solution for a simple advected step-wave , you will gain direct experience with how a high-order correction is limited to prevent oscillations, reinforcing the core mechanism of monotonicity enforcement.",
            "id": "3307932",
            "problem": "Consider the linear advection equation in conservative form for a scalar cell average $u$, given by $u_{t} + a\\,u_{x} = 0$ with constant wave speed $a  0$. Use a one-dimensional conservative finite-volume discretization on a uniform grid with cell width $\\Delta x$ and time step $\\Delta t$. Assume $a = 1$, $\\Delta x = 1$, and $\\Delta t = 0.3$, so that the Courant number is $C = a\\,\\Delta t/\\Delta x = 0.3$. The initial data are a unit step: $u_{i}^{n} = 1$ for all $i \\le -1$ and $u_{i}^{n} = 0$ for all $i \\ge 0$. Focus on the interfacial region $i \\in \\{-2,-1,0,1,2\\}$, and assume that outside this region the state remains at its far-field constant values.\n\nAdopt a Flux-Corrected Transport (FCT) framework in which a first-order monotone low-order scheme is corrected toward a higher-order scheme and the correction is limited by design criteria that enforce the Total Variation Diminishing (TVD) property. Use the following components:\n- The low-order scheme is the first-order upwind finite-volume method with numerical flux $F_{i+\\frac{1}{2}}^{L}$ determined by the upwind state.\n- The high-order candidate is the second-order Lax–Wendroff scheme, cast in flux-difference form and used only to define the anti-diffusive flux (the difference between high-order and low-order numerical fluxes).\n\nImplement a single FCT time step as follows. First, compute the low-order update $u_{i}^{L}$ from the upwind fluxes. Next, form the interface anti-diffusive fluxes $A_{i+\\frac{1}{2}}$ as the difference between the Lax–Wendroff and upwind fluxes. Then, apply a limiter constrained by the TVD design criterion, namely that the corrected solution $u_{i}^{n+1}$ must not create new local extrema relative to its neighboring data at time level $n$. Use the standard local neighbor bounds drawn from the three-point stencil $\\{i-1,i,i+1\\}$ at time level $n$ to guarantee TVD monotonicity, and enforce conservation by using a single limited flux $\\tilde{A}_{i+\\frac{1}{2}}$ at each interface common to the two adjacent cells. In particular, for each cell, compute the allowable positive and negative correction budgets implied by the neighbor bounds and the low-order value $u_{i}^{L}$, and then limit the anti-diffusive flux at each face so that neither adjacent cell exceeds its allowable budget; take the final limiter at a face to be the most restrictive of its two adjacent cells.\n\nCarry out this complete procedure for the interfaces and cells near the discontinuity, determine the limited anti-diffusive flux at the interface $i+\\tfrac{1}{2} = -\\tfrac{1}{2}$, and compute the corrected cell averages $u_{i}^{n+1}$ for $i \\in \\{-1,0,1\\}$. Report as your final answer the updated cell average at $i=0$ after this single limited FCT step. Provide your final answer as a single number. No rounding is required.",
            "solution": "The governing equation is the linear advection equation in conservative form:\n$$u_t + (au)_x = 0$$\nwhere $u$ is the conserved scalar quantity and $a$ is the constant wave speed.\nThe problem provides the following parameters:\n- Wave speed: $a=1$.\n- Grid spacing: $\\Delta x = 1$.\n- Time step: $\\Delta t = 0.3$.\n- The Courant number is $C = \\frac{a \\Delta t}{\\Delta x} = \\frac{1 \\cdot 0.3}{1} = 0.3$.\n\nThe initial condition is a unit step function discretized as cell averages:\n$$u_i^n = \\begin{cases} 1  \\text{for } i \\le -1 \\\\ 0  \\text{for } i \\ge 0 \\end{cases}$$\nWe are interested in the cells around the discontinuity, specifically for $i \\in \\{-2, -1, 0, 1, 2\\}$. The initial values are:\n$u_{-2}^n = 1$\n$u_{-1}^n = 1$\n$u_0^n = 0$\n$u_1^n = 0$\n$u_2^n = 0$\n\nThe FCT procedure consists of several steps, which we will follow meticulously.\n\n**Step 1: Low-Order Update**\nThe low-order scheme is the first-order upwind method. The finite-volume update is given by:\n$$u_i^L = u_i^n - \\frac{\\Delta t}{\\Delta x} (F_{i+1/2}^L - F_{i-1/2}^L)$$\nSince the wave speed $a=1  0$, the upwind numerical flux is $F_{i+1/2}^L = a u_i^n = u_i^n$.\nThe update equation becomes:\n$$u_i^L = u_i^n - \\frac{\\Delta t}{\\Delta x} (u_i^n - u_{i-1}^n) = u_i^n - C(u_i^n - u_{i-1}^n)$$\nWe compute the low-order solution $u_i^L$ for the cells of interest:\n- For $i=-1$: $u_{-1}^L = u_{-1}^n - C(u_{-1}^n - u_{-2}^n) = 1 - 0.3(1 - 1) = 1$.\n- For $i=0$: $u_0^L = u_0^n - C(u_0^n - u_{-1}^n) = 0 - 0.3(0 - 1) = 0.3$.\n- For $i=1$: $u_1^L = u_1^n - C(u_1^n - u_0^n) = 0 - 0.3(0 - 0) = 0$.\n\nThe low-order solution field after one time step is: $u_{-1}^L = 1$, $u_0^L = 0.3$, $u_1^L = 0$.\n\n**Step 2: Anti-diffusive Fluxes**\nThe anti-diffusive flux $A_{i+1/2}$ is the difference between the high-order (Lax-Wendroff) flux $F_{i+1/2}^H$ and the low-order (upwind) flux $F_{i+1/2}^L$:\n$$A_{i+1/2} = F_{i+1/2}^H - F_{i+1/2}^L$$\nThe Lax-Wendroff flux for linear advection is $F_{i+1/2}^H = \\frac{a}{2}(u_i^n + u_{i+1}^n) - \\frac{a^2 \\Delta t}{2 \\Delta x}(u_{i+1}^n - u_i^n) = \\frac{a}{2}(1-C)u_{i+1}^n + \\frac{a}{2}(1+C)u_i^n$.\nThe upwind flux is $F_{i+1/2}^L = a u_i^n$.\nThe anti-diffusive flux is therefore:\n$$A_{i+1/2} = \\left(\\frac{a}{2}(1-C)u_{i+1}^n + \\frac{a}{2}(1+C)u_i^n\\right) - a u_i^n = \\frac{a}{2}(1-C)(u_{i+1}^n - u_i^n)$$\nSubstituting the given values $a=1$ and $C=0.3$:\n$$A_{i+1/2} = \\frac{1}{2}(1-0.3)(u_{i+1}^n - u_i^n) = 0.35(u_{i+1}^n - u_i^n)$$\nWe compute the anti-diffusive fluxes at the interfaces relevant to cells $i \\in \\{-1, 0, 1\\}$, which are interfaces $i \\in \\{-3/2, -1/2, 1/2, 3/2\\}$.\n- $A_{-3/2} = 0.35(u_{-1}^n - u_{-2}^n) = 0.35(1 - 1) = 0$.\n- $A_{-1/2} = 0.35(u_0^n - u_{-1}^n) = 0.35(0 - 1) = -0.35$.\n- $A_{1/2} = 0.35(u_1^n - u_0^n) = 0.35(0 - 0) = 0$.\n- $A_{3/2} = 0.35(u_2^n - u_1^n) = 0.35(0 - 0) = 0$.\nThe only non-zero anti-diffusive flux is at the interface $i=-1/2$.\n\n**Step 3: Limiter Application**\nThe final corrected solution $u_i^{n+1}$ is computed by adding a limited portion of the anti-diffusive correction to the low-order solution:\n$$u_i^{n+1} = u_i^L - \\frac{\\Delta t}{\\Delta x}(\\tilde{A}_{i+1/2} - \\tilde{A}_{i-1/2})$$\nwhere $\\tilde{A}$ is the limited anti-diffusive flux. The term $\\frac{\\Delta t}{\\Delta x}\\tilde{A}_{i-1/2}$ represents anti-diffusion entering cell $i$ from the left, while $\\frac{\\Delta t}{\\Delta x}\\tilde{A}_{i+1/2}$ represents anti-diffusion leaving cell $i$ to the right. A positive flux $\\tilde{A}_{j+1/2}$ moves \"correction mass\" from cell $j$ to cell $j+1$.\n\nThe TVD constraint requires that no new local extrema are created. The updated value $u_i^{n+1}$ must lie within the bounds set by its neighbors at time level $n$:\n$$u_i^{\\min} \\le u_i^{n+1} \\le u_i^{\\max}$$\nwhere $u_i^{\\min} = \\min(u_{i-1}^n, u_i^n, u_{i+1}^n)$ and $u_i^{\\max} = \\max(u_{i-1}^n, u_i^n, u_{i+1}^n)$.\nFrom these bounds, we define the available \"room\" for correction for cell $i$ relative to its low-order state $u_i^L$:\n- Maximum allowed increase (positive budget): $Q_i^+ = u_i^{\\max} - u_i^L$.\n- Maximum allowed decrease (negative budget): $Q_i^- = u_i^L - u_i^{\\min}$.\n\nLet's compute these for the cells adjacent to the non-zero flux $A_{-1/2}$, i.e., cells $i=-1$ and $i=0$.\n- For $i=-1$:\n  $u_{-1}^{\\min} = \\min(u_{-2}^n, u_{-1}^n, u_0^n) = \\min(1, 1, 0) = 0$.\n  $u_{-1}^{\\max} = \\max(u_{-2}^n, u_{-1}^n, u_0^n) = \\max(1, 1, 0) = 1$.\n  $u_{-1}^L = 1$.\n  $Q_{-1}^+ = u_{-1}^{\\max} - u_{-1}^L = 1 - 1 = 0$.\n  $Q_{-1}^- = u_{-1}^L - u_{-1}^{\\min} = 1 - 0 = 1$.\n- For $i=0$:\n  $u_0^{\\min} = \\min(u_{-1}^n, u_0^n, u_1^n) = \\min(1, 0, 0) = 0$.\n  $u_0^{\\max} = \\max(u_{-1}^n, u_0^n, u_1^n) = \\max(1, 0, 0) = 1$.\n  $u_0^L = 0.3$.\n  $Q_0^+ = u_0^{\\max} - u_0^L = 1 - 0.3 = 0.7$.\n  $Q_0^- = u_0^L - u_0^{\\min} = 0.3 - 0 = 0.3$.\n\nNow we limit the flux $A_{-1/2} = -0.35$.\nThe change in cell $i$ due to the anti-diffusive fluxes is $\\delta_i = -\\frac{\\Delta t}{\\Delta x}(\\tilde{A}_{i+1/2} - \\tilde{A}_{i-1/2}) = -0.3(\\tilde{A}_{i+1/2} - \\tilde{A}_{i-1/2})$.\nThe flux $A_{-1/2}$ is negative, indicating a transfer of \"correction mass\" from cell $i=0$ (donor) to cell $i=-1$ (receiver).\nThe amount of correction mass to be transferred is $M = \\frac{\\Delta t}{\\Delta x} |A_{-1/2}| = 0.3 \\times |-0.35| = 0.105$.\nThis transfer attempts to increase $u_{-1}$ by $0.105$ and decrease $u_0$ by $0.105$.\n\nWe check this against the budgets of the two cells:\n- The receiving cell is $i=-1$. Its capacity to increase is $Q_{-1}^+ = 0$. The requested increase is $0.105$. Since $0.105  0$, the receiver cell cannot accommodate this transfer. The maximum it can accept is $0$.\n- The donating cell is $i=0$. Its capacity to decrease is $Q_0^- = 0.3$. The requested decrease is $0.105$. Since $0.105 \\le 0.3$, the donor cell can afford this transfer.\n\nThe final limited flux must be acceptable to both adjacent cells. We take the most restrictive constraint. The amount of \"correction mass\" transferred, $M^*$, must be no more than what the donor can give and no more than what the receiver can accept.\n$$M^* = \\min(\\text{requested transfer, donor capacity, receiver capacity})$$\n$$M^* = \\min(M, Q_0^-, Q_{-1}^+) = \\min(0.105, 0.3, 0) = 0$$\nThe limited transfer amount is $M^*=0$. This implies that the limited flux which causes this transfer must be zero.\nThe limited transfer is related to the limited flux by $M^* = \\frac{\\Delta t}{\\Delta x} |\\tilde{A}_{-1/2}|$.\nSince $M^* = 0$, we have $\\tilde{A}_{-1/2} = 0$.\n\nAll other anti-diffusive fluxes were already zero, so their limited counterparts are also zero. $\\tilde{A}_{i+1/2} = 0$ for all $i$.\n\n**Step 4: Final Update**\nWe compute the corrected cell averages using the limited fluxes.\n$$u_i^{n+1} = u_i^L - 0.3(\\tilde{A}_{i+1/2} - \\tilde{A}_{i-1/2})$$\nSince all $\\tilde{A}_{i+1/2}$ are zero, the correction term is zero for all cells. The final solution is simply the low-order solution.\n$$u_i^{n+1} = u_i^L$$\n- For $i=-1$: $u_{-1}^{n+1} = u_{-1}^L = 1$.\n- For $i=0$: $u_0^{n+1} = u_0^L = 0.3$.\n- For $i=1$: $u_1^{n+1} = u_1^L = 0$.\n\nThe updated cell average at $i=0$ is $u_0^{n+1} = 0.3$.\nThis result is characteristic of TVD schemes at sharp discontinuities; the anti-compressive nature of the higher-order scheme is fully suppressed by the monotonicity constraint, causing the scheme to revert locally to its first-order diffusive component.\nThe final answer required is the value of $u_0^{n+1}$.",
            "answer": "$$\\boxed{0.3}$$"
        },
        {
            "introduction": "High-resolution TVD schemes rely on flux limiters that intelligently switch between high- and low-order methods based on local solution smoothness. This practice challenges you to think critically about the fundamental design of these limiters, specifically why the smoothness indicator, $r$, must be defined relative to the upwind direction to maintain stability in problems where the wave direction can change .",
            "id": "3307900",
            "problem": "Consider the scalar conservation law $u_t + f(u)_x = 0$ on a uniform grid with spatial spacing $\\Delta x$ and time step $\\Delta t$. The local characteristic speed is $a = f'(u)$, which may change sign in space and time. Define the left and right one-sided differences $\\Delta^- u_i = u_i - u_{i-1}$ and $\\Delta^+ u_i = u_{i+1} - u_i$. A high-resolution flux-limited finite volume scheme builds interfacial states by a piecewise linear reconstruction with a limited slope, and advances the solution using upwind-biased numerical fluxes. The slope limiter is a function $\\phi(r)$ of a smoothness indicator $r$; the numerical Total Variation Diminishing (TVD) property requires the limiter design and the definition of $r$ to be consistent with the direction of information propagation.\n\nStarting from the conservation law and the finite volume update $u_i^{n+1} = u_i^n - \\lambda\\left(F_{i+1/2} - F_{i-1/2}\\right)$, where $\\lambda = \\Delta t / \\Delta x$ and $F_{i\\pm1/2}$ are upwind fluxes constructed from reconstructed left/right states, derive from first principles why the definition of the smoothness indicator $r$ must be aligned with the upwind direction. In particular, focus on how the sign of the characteristic speed $a$ determines whether left- or right-biased differences are upwind. Use the discrete form of the total variation $\\mathrm{TV}(u^n) = \\sum_i \\left|u_{i+1}^n - u_i^n\\right|$ and the monotonicity criteria for three-point schemes to argue which definitions of $r$ maintain the TVD property when $a$ changes sign, and which do not. Then, choose the option that correctly provides symmetric definitions of $r$ for right-going and left-going waves and a justification that ensures TVD across sign changes in $a$.\n\nA. Use $r_i = \\dfrac{\\Delta^- u_i}{\\Delta^+ u_i}$ for all interfaces and all signs of $a$, and apply the same limiter $\\phi(r)$ everywhere. The symmetry of the ratio ensures the TVD property regardless of the sign of $a$.\n\nB. For right-going waves with $a0$ at an interface, use $r_i^{(+)} = \\dfrac{\\Delta^- u_i}{\\Delta^+ u_i}$; for left-going waves with $a0$, use $r_i^{(-)} = \\dfrac{\\Delta^+ u_i}{\\Delta^- u_i}$. Choose a limiter $\\phi(r)$ that satisfies the standard TVD constraints on the smoothness diagram for $r \\ge 0$ and set $\\phi(r) = 0$ when $r \\le 0$. This aligns the limiter’s correction with the upwind gradient and preserves TVD when $a$ changes sign.\n\nC. Use $r_i = \\dfrac{\\left|\\Delta^- u_i\\right|}{\\left|\\Delta^+ u_i\\right|}$ for all interfaces, so that $r_i \\ge 0$ always. Select any monotone nondecreasing limiter function $\\phi(r)$; the positivity of $r$ guarantees TVD irrespective of the sign of $a$.\n\nD. Define $r_i$ using central differences, $r_i = \\dfrac{u_{i+1} - u_{i-1}}{u_{i+2} - u_i}$, to make $r_i$ independent of the sign of $a$. With this direction-free smoothness indicator, any standard limiter $\\phi(r)$ will maintain TVD even when $a$ changes sign.",
            "solution": "The goal of a high-resolution scheme for a hyperbolic conservation law is to achieve at least second-order accuracy in smooth regions of the solution while preventing spurious oscillations (Gibbs phenomena) near discontinuities. The Total Variation Diminishing (TVD) property, $\\mathrm{TV}(u^{n+1}) \\le \\mathrm{TV}(u^n)$, is a sufficient condition for preventing such oscillations.\n\nHigh-resolution schemes achieve this by blending a low-order (first-order) monotone scheme with a high-order scheme. The first-order upwind scheme is the canonical example of a monotone (and thus TVD) scheme, but it is highly diffusive. Higher-order schemes like Lax-Wendroff are less diffusive but can introduce oscillations. The blending is controlled by a flux limiter function, $\\phi$, which depends on a \"smoothness indicator,\" $r$.\n\nThe essence of the method lies in the term \"upwind.\" Hyperbolic equations describe the propagation of information along characteristics. The direction of this propagation is given by the sign of the characteristic speed, $a = f'(u)$. A stable numerical scheme must respect this directionality; this is the principle of upwinding.\n\nThe role of the smoothness indicator $r$ is to measure the local \"smoothness\" of the solution profile by comparing consecutive gradients. Where the solution is smooth, consecutive gradients are nearly equal, and their ratio $r$ should be close to $1$. In such regions, the limiter $\\phi(r)$ should allow for a higher-order correction. Near extrema or discontinuities, consecutive gradients differ significantly in magnitude or sign, causing $r$ to be far from $1$ or negative. In these regions, the limiter $\\phi(r)$ must reduce or eliminate the higher-order correction, forcing the scheme to revert locally to the robust first-order upwind method to maintain monotonicity.\n\nThe crucial insight is that the comparison of gradients must be consistent with the direction of information flow. The ratio $r$ should always be defined as:\n$$\nr = \\frac{\\text{gradient upwind of the wave}}{\\text{gradient downwind of the wave}}\n$$\nLet's consider the reconstruction within cell $i$, which is used to determine the fluxes $F_{i-1/2}$ and $F_{i+1/2}$. The relevant gradients are the backward difference, representing the gradient to the left, $\\frac{\\Delta^- u_i}{\\Delta x} = \\frac{u_i - u_{i-1}}{\\Delta x}$, and the forward difference, representing the gradient to the right, $\\frac{\\Delta^+ u_i}{\\Delta x} = \\frac{u_{i+1} - u_i}{\\Delta x}$.\n\n**Case 1: Right-going wave ($a > 0$)**\nInformation propagates from left to right. For the reconstruction in cell $i$, the \"upwind\" direction is from the left (from cell $i-1$). The \"downwind\" direction is to the right (towards cell $i+1$). Therefore, the upwind gradient is proportional to $\\Delta^- u_i$ and the downwind gradient is proportional to $\\Delta^+ u_i$. The smoothness indicator $r_i$ for cell $i$ must be defined as:\n$$\nr_i = \\frac{\\text{upwind gradient}}{\\text{downwind gradient}} = \\frac{u_i - u_{i-1}}{u_{i+1} - u_i} = \\frac{\\Delta^- u_i}{\\Delta^+ u_i}\n$$\n\n**Case 2: Left-going wave ($a  0$)**\nInformation propagates from right to left. For the reconstruction in cell $i$, the \"upwind\" direction is now from the right (from cell $i+1$). The \"downwind\" direction is to the left (towards cell $i-1$). The upwind gradient is now proportional to $\\Delta^+ u_i$ and the downwind gradient is proportional to $\\Delta^- u_i$. To maintain the physical meaning of $r$ as the ratio of upwind to downwind gradients, its definition must be inverted:\n$$\nr_i = \\frac{\\text{upwind gradient}}{\\text{downwind gradient}} = \\frac{u_{i+1} - u_i}{u_i - u_{i-1}} = \\frac{\\Delta^+ u_i}{\\Delta^- u_i}\n$$\n\nThus, the definition of $r$ must depend on the sign of $a$ to correctly identify the upwind and downwind gradients. Using a single definition for all $a$ would mean that for one of the cases ($a0$ or $a0$), $r$ would be defined as the ratio of downwind-to-upwind gradients. A limiter function $\\phi(r)$ designed based on the standard upwind-to-downwind ratio would then be applied to an incorrect input, leading to a breakdown of the TVD property and likely causing numerical instability or oscillations. The condition that $\\phi(r)=0$ for $r \\le 0$ ensures monotonicity by switching off the high-order correction at extrema, where consecutive gradients have opposite signs.\n\n### Option-by-Option Analysis\n\n**A. Use $r_i = \\dfrac{\\Delta^- u_i}{\\Delta^+ u_i}$ for all interfaces and all signs of $a$, and apply the same limiter $\\phi(r)$ everywhere. The symmetry of the ratio ensures the TVD property regardless of the sign of $a$.**\nThis approach is fundamentally flawed. As derived above, this definition of $r_i$ is correct only for right-going waves ($a  0$). For left-going waves ($a  0$), it represents the ratio of the downwind gradient to the upwind gradient. Applying a standard limiter function $\\phi(r)$ to this inverted ratio will not satisfy the TVD conditions. The claim about \"symmetry\" is unsubstantiated and incorrect.\n**Verdict: Incorrect.**\n\n**B. For right-going waves with $a0$ at an interface, use $r_i^{(+)} = \\dfrac{\\Delta^- u_i}{\\Delta^+ u_i}$; for left-going waves with $a0$, use $r_i^{(-)} = \\dfrac{\\Delta^+ u_i}{\\Delta^- u_i}$. Choose a limiter $\\phi(r)$ that satisfies the standard TVD constraints on the smoothness diagram for $r \\ge 0$ and set $\\phi(r) = 0$ when $r \\le 0$. This aligns the limiter’s correction with the upwind gradient and preserves TVD when $a$ changes sign.**\nThis option correctly implements the principle derived from first principles. It defines the smoothness indicator $r$ as the ratio of the upwind gradient to the downwind gradient, with the definition switching based on the sign of the characteristic speed $a$. This ensures that the limiter function $\\phi(r)$ always receives a physically meaningful input, allowing it to correctly regulate the numerical flux and maintain the TVD property across regions where the wave direction changes. The condition $\\phi(r) = 0$ for $r \\le 0$ is also a standard and necessary part of the TVD limiter design to handle non-monotonic regions.\n**Verdict: Correct.**\n\n**C. Use $r_i = \\dfrac{\\left|\\Delta^- u_i\\right|}{\\left|\\Delta^+ u_i\\right|}$ for all interfaces, so that $r_i \\ge 0$ always. Select any monotone nondecreasing limiter function $\\phi(r)$; the positivity of $r$ guarantees TVD irrespective of the sign of $a$.**\nThis option is incorrect for multiple reasons. First, by taking absolute values, it discards crucial information about the signs of the gradients. The condition $r \\le 0$ is the primary signal of a local extremum, where the limiter must be most aggressive (i.e., $\\phi(r)=0$). This definition makes $r$ positive at extrema, potentially leading to the creation of new oscillations. Second, even in monotonic regions, this definition is equivalent to option A and thus fails to adapt to the upwind direction for $a  0$. Third, the claim that any monotone non-decreasing limiter guarantees TVD is false; limiters must lie within a specific region in the $\\phi-r$ plane (the TVD region), and being monotone non-decreasing is not a sufficient condition.\n**Verdict: Incorrect.**\n\n**D. Define $r_i$ using central differences, $r_i = \\dfrac{u_{i+1} - u_{i-1}}{u_{i+2} - u_i}$, to make $r_i$ independent of the sign of $a$. With this direction-free smoothness indicator, any standard limiter $\\phi(r)$ will maintain TVD even when $a$ changes sign.**\nThis option misunderstands the fundamental principle of upwinding. The goal is not to be \"direction-free.\" The physics of hyperbolic problems is directional, and the numerical method must respect this. Attempting to create a direction-independent indicator negates the very concept of an upwind-biased scheme. The proposed definition of $r_i$ is non-standard, compares gradients over an unusual stencil, and has no clear physical interpretation in the context of upwinding. There is no theoretical basis to suggest that applying a standard limiter $\\phi$ to this unorthodox ratio $r_i$ would result in a TVD scheme.\n**Verdict: Incorrect.**",
            "answer": "$$\\boxed{B}$$"
        },
        {
            "introduction": "Moving from mathematical theory to a functional computer code often reveals challenges not apparent in exact arithmetic, such as divisions by near-zero numbers. This problem addresses the crucial issue of numerical robustness in TVD schemes, asking you to evaluate different strategies to stabilize the calculation of the smoothness ratio $r$ in the presence of floating-point errors, ensuring the scheme's integrity in a real-world implementation .",
            "id": "3307923",
            "problem": "Consider the one-dimensional linear advection equation $u_t + a \\, u_x = 0$ with $a  0$ on a uniform mesh with spacing $\\Delta x$ and a forward Euler time step $\\Delta t$ such that the Courant number $\\nu = a \\, \\Delta t / \\Delta x$ lies in $(0,1]$. A high-resolution Monotonic Upstream-centered Scheme for Conservation Laws (MUSCL) flux with a flux-limiter function $\\phi$ is employed at each interface $x_{i+1/2}$, using a piecewise-linear reconstruction of left states based on the local slope ratio $r_i$. Let $\\Delta_- u_i = u_i - u_{i-1}$ and $\\Delta_+ u_i = u_{i+1} - u_i$, and let the numerical flux at $x_{i+1/2}$ be\n$$\nF_{i+1/2} = a \\, u_i + \\tfrac{1}{2} \\, a \\, (1 - \\nu) \\, \\phi(r_i) \\, \\Delta_+ u_i,\n$$\nwith an analogous expression at $x_{i-1/2}$ based on $r_{i-1}$. The fully discrete update is $u_i^{n+1} = u_i^n - \\nu \\, (F_{i+1/2} - F_{i-1/2}) / a$.\n\nThe Total Variation Diminishing (TVD) requirement is that the discrete total variation $\\mathrm{TV}(u^n) = \\sum_i |u_{i+1}^n - u_i^n|$ satisfies $\\mathrm{TV}(u^{n+1}) \\le \\mathrm{TV}(u^n)$ for all $n$.\n\nIn exact arithmetic, classical TVD constraints on $\\phi$ (for example, those summarized in the Sweby diagram for this flux form) ensure TVD when $r_i = \\Delta_- u_i / \\Delta_+ u_i$. In finite precision arithmetic, however, when $|\\Delta_+ u_i|$ and $|\\Delta_- u_i|$ are very small (near constant states), rounding can perturb the sign and magnitude of $r_i$ severely, potentially violating the conditions needed to guarantee TVD.\n\nYou are asked to assess the following design proposals intended to improve robustness under finite precision while maintaining TVD. Assume $\\nu \\in (0,1]$ is fixed and $a  0$.\n\nWhich of the following proposals, if adopted, guarantees the scheme remains TVD for all data and all $\\nu \\in (0,1]$ in floating-point computations where rounding may perturb $r$ near zero? Select all that apply.\n\nA. Epsilon-regularized ratio preserving sign:\nDefine $r_{i,\\varepsilon} = \\dfrac{\\Delta_- u_i}{\\Delta_+ u_i + \\varepsilon \\, \\mathrm{sign}(\\Delta_+ u_i)}$ with a fixed $\\varepsilon  0$ and $\\mathrm{sign}(x) = +1$ if $x \\ge 0$ and $\\mathrm{sign}(x) = -1$ otherwise. Use any limiter $\\phi$ that is nondecreasing, satisfies $\\phi(r) = 0$ for $r \\le 0$, and for $r \\ge 0$ satisfies $0 \\le \\phi(r) \\le \\min\\{2 r, 2\\}$, with the flux unchanged except that $r_i$ is replaced by $r_{i,\\varepsilon}$. Claim: this yields a TVD scheme for all $\\nu \\in (0,1]$.\n\nB. Epsilon-offset denominator without sign control:\nDefine $r_{i,\\varepsilon} = \\dfrac{\\Delta_- u_i}{\\Delta_+ u_i + \\varepsilon}$ with a fixed $\\varepsilon  0$ and use any limiter $\\phi$ satisfying the same pointwise bounds as in option A, with the flux unchanged except that $r_i$ is replaced by $r_{i,\\varepsilon}$. Claim: this yields a TVD scheme for all $\\nu \\in (0,1]$.\n\nC. Thresholded slope-limiter in slope-space (ratio-free):\nReplace the ratio-based limiter by a slope-limiter defined directly on increments,\n$$\ns_{i,\\varepsilon} = \n\\begin{cases}\n\\mathrm{minmod}(\\Delta_- u_i, \\Delta_+ u_i),  \\text{if } \\max\\{|\\Delta_- u_i|, |\\Delta_+ u_i|\\}  \\varepsilon,\\\\\n0,  \\text{otherwise,}\n\\end{cases}\n$$\nwith $\\varepsilon  0$, and set $F_{i+1/2} = a \\, u_i + \\tfrac{1}{2} \\, a \\, (1 - \\nu) \\, s_{i,\\varepsilon}$, i.e., the high-order correction is the limited slope itself rather than $\\phi(r_i) \\, \\Delta_+ u_i$. Claim: this yields a TVD scheme for all $\\nu \\in (0,1]$.\n\nD. Smooth van Albada limiter without special handling for $r \\le 0$:\nUse $\\phi_{\\mathrm{va}}(r) = \\dfrac{r^2 + r}{r^2 + 1}$ computed from the floating-point ratio $r_i = \\Delta_- u_i / \\Delta_+ u_i$ with no $\\varepsilon$ regularization and no clipping for $r \\le 0$. Claim: the scheme remains TVD for all $\\nu \\in (0,1]$ because $\\phi_{\\mathrm{va}}$ is smooth near $r = 0$.\n\nYour answer should be the set of options that are guaranteed TVD under the stated conditions. To justify your choices, reason from the definition of total variation and the structure of the numerical flux, not by appeal to authority or implementation folklore. Scientific realism is required: any counterexample must be consistent with the given scheme and admissible parameter ranges.",
            "solution": "The problem asks to evaluate four proposals for modifying a MUSCL-type scheme to ensure it remains Total Variation Diminishing (TVD) in finite precision arithmetic.\n\nFirst, we establish the theoretical basis for the TVD property of the given scheme in exact arithmetic. The scheme is defined by the one-dimensional linear advection equation $u_t + a \\, u_x = 0$ with $a  0$. The fully discrete update is given by:\n$$u_i^{n+1} = u_i^n - \\frac{\\Delta t}{\\Delta x} (F_{i+1/2} - F_{i-1/2})$$\nUsing the Courant number $\\nu = a \\Delta t / \\Delta x$, this becomes:\n$$u_i^{n+1} = u_i^n - \\frac{\\nu}{a} (F_{i+1/2} - F_{i-1/2})$$\nThe numerical flux at the interface $x_{i+1/2}$ is given as:\n$$F_{i+1/2} = a \\, u_i + \\tfrac{1}{2} \\, a \\, (1 - \\nu) \\, \\phi(r_i) \\, \\Delta_+ u_i$$\nwhere $\\Delta_+ u_i = u_{i+1} - u_i$ and the slope ratio is $r_i = \\Delta_- u_i / \\Delta_+ u_i = (u_i - u_{i-1}) / (u_{i+1} - u_i)$.\nThe flux at $x_{i-1/2}$ is analogously $F_{i-1/2} = a \\, u_{i-1} + \\tfrac{1}{2} \\, a \\, (1 - \\nu) \\, \\phi(r_{i-1}) \\, \\Delta_+ u_{i-1}$.\n\nSubstituting the flux definitions into the update equation, we obtain the scheme in difference form:\n$$u_i^{n+1} = u_i^n - \\frac{\\nu}{a} \\left[ \\left( a u_i + \\frac{a(1-\\nu)}{2} \\phi(r_i) \\Delta_+ u_i \\right) - \\left( a u_{i-1} + \\frac{a(1-\\nu)}{2} \\phi(r_{i-1}) \\Delta_+ u_{i-1} \\right) \\right]$$\n$$u_i^{n+1} = u_i^n - \\nu (u_i - u_{i-1}) - \\frac{\\nu(1-\\nu)}{2} \\left[ \\phi(r_i) \\Delta_+ u_i - \\phi(r_{i-1}) \\Delta_+ u_{i-1} \\right]$$\nUsing $\\Delta_+ u_{i-1} = u_i - u_{i-1} = \\Delta_- u_i$, we get:\n$$u_i^{n+1} = u_i^n - \\nu \\Delta_- u_i - \\frac{\\nu(1-\\nu)}{2} \\left[ \\phi(r_i) \\Delta_+ u_i - \\phi(r_{i-1}) \\Delta_- u_i \\right]$$\n\nThe TVD property, $\\mathrm{TV}(u^{n+1}) \\le \\mathrm{TV}(u^n)$, is guaranteed if the scheme does not create new local extrema and does not amplify existing extrema. For this family of flux-limiter schemes, a crucial condition for preventing the creation of new extrema is that the high-order correction term, which acts as an anti-diffusive flux, must be deactivated at local extrema. A local extremum at cell $i$ implies that $\\Delta_- u_i$ and $\\Delta_+ u_i$ have opposite signs (or one is zero), which means $r_i \\le 0$. Thus, a fundamental necessary condition for the scheme to be TVD is:\n$$\\phi(r) = 0 \\quad \\text{for} \\quad r \\le 0$$\nFurther conditions, mentioned in option A as being part of the classical constraints for this flux form, are:\n$$0 \\le \\phi(r) \\le 2r \\quad \\text{for} \\quad r  0$$\n$$0 \\le \\phi(r) \\le 2 \\quad \\text{for} \\quad r  0$$\nThese can be summarized as $0 \\le \\phi(r) \\le \\min(2r, 2)$ for $r0$.\n\nThe core of the problem is that in finite precision arithmetic, when $\\Delta_+ u_i$ is close to zero, the computed value of $r_i$ can have an incorrect magnitude and, critically, an incorrect sign. An incorrect sign can lead to a non-zero $\\phi(r_i)$ where it should be zero, introducing spurious oscillations and violating the TVD property. We now evaluate each proposal's ability to remedy this issue.\n\n**Analysis of Option A:**\nThe proposed regularization is $r_{i,\\varepsilon} = \\dfrac{\\Delta_- u_i}{\\Delta_+ u_i + \\varepsilon \\, \\mathrm{sign}(\\Delta_+ u_i)}$, with a non-standard $\\mathrm{sign}(x) = +1$ if $x \\ge 0$ and $-1$ otherwise.\nLet's analyze the denominator $D = \\Delta_+ u_i + \\varepsilon \\, \\mathrm{sign}(\\Delta_+ u_i)$.\n\\begin{itemize}\n    \\item If $\\Delta_+ u_i  0$, $D = \\Delta_+ u_i + \\varepsilon  \\varepsilon$.\n    \\item If $\\Delta_+ u_i  0$, $D = \\Delta_+ u_i - \\varepsilon  -\\varepsilon$.\n    \\item If $\\Delta_+ u_i = 0$, $D = 0 + \\varepsilon \\cdot 1 = \\varepsilon  0$.\n\\end{itemize}\nIn all cases, the denominator's magnitude is bounded below by $\\varepsilon$, which prevents division by a number close to zero. Most importantly, this regularization preserves the sign of the denominator relative to $\\Delta_+ u_i$. Specifically, $\\mathrm{sign}(D) = \\mathrm{sign}(\\Delta_+ u_i)$ for all $\\Delta_+ u_i \\neq 0$ (and is positive for $\\Delta_+ u_i=0$). Consequently, the sign of the regularized ratio $r_{i,\\varepsilon}$ is the same as the sign of the exact ratio $r_i = \\Delta_- u_i / \\Delta_+ u_i$.\nBecause the sign is correctly maintained, the condition $\\phi(r \\le 0) = 0$ is robustly enforced. If the true solution has an extremum ($r_i \\le 0$), the regularized scheme will also compute a non-positive ratio and correctly set the anti-diffusive correction to zero. In smooth regions ($r_i  0$), a well-behaved, non-zero limiter value is used. The limiter function $\\phi$ itself satisfies the TVD bounds. By feeding it a robustly computed argument $r_{i,\\varepsilon}$, the scheme's TVD property, which depends critically on these conditions, is preserved.\nThe claim is that for any limiter $\\phi$ satisfying the stated TVD bounds, this modification yields a TVD scheme. This holds because the modification correctly identifies monotonicity ($r0$) vs. extremum ($r \\le 0$) even under floating point uncertainty, allowing the limiter to function as intended by the TVD theory.\nVerdict: **Correct**.\n\n**Analysis of Option B:**\nThe proposed regularization is $r_{i,\\varepsilon} = \\dfrac{\\Delta_- u_i}{\\Delta_+ u_i + \\varepsilon}$.\nThis form also prevents division by zero by ensuring the denominator is at least $\\varepsilon$ in magnitude, provided that $\\Delta_+ u_i \\ge -\\varepsilon$. However, it fails to preserve the sign of the ratio in a critical scenario.\nConsider a local maximum where $\\Delta_- u_i  0$ and $\\Delta_+ u_i$ is small and negative. For example, let $\\Delta_+ u_i = -\\delta$ where $0  \\delta  \\varepsilon$. The exact ratio is $r_i = \\Delta_- u_i / (-\\delta)  0$. The TVD property requires $\\phi(r_i) = 0$.\nWith the regularization, the denominator becomes $D = -\\delta + \\varepsilon  0$. The regularized ratio is $r_{i,\\varepsilon} = \\dfrac{\\Delta_- u_i}{-\\delta + \\varepsilon}  0$.\nThe scheme will then compute $\\phi(r_{i,\\varepsilon})  0$ (assuming $\\Delta_-u_i \\neq 0$), applying an anti-diffusive correction at a local maximum. This is precisely what a TVD scheme must prevent, as it can generate overshoots and spurious oscillations. Therefore, this proposal does not guarantee the scheme remains TVD.\nVerdict: **Incorrect**.\n\n**Analysis of Option C:**\nThis proposal replaces the ratio-based flux limiter with a direct \"slope-limiter\" formulation. The limited quantity is $s_{i,\\varepsilon}$, which is a limited difference.\nThe proposed high-order correction term in the flux is $\\tfrac{1}{2} \\, a \\, (1 - \\nu) \\, s_{i,\\varepsilon}$.\nThe term it replaces is $\\tfrac{1}{2} \\, a \\, (1 - \\nu) \\, \\phi(r_i) \\, \\Delta_+ u_i$.\nTherefore, this proposal is equivalent to setting $\\phi(r_i) \\, \\Delta_+ u_i = s_{i,\\varepsilon}$.\nLet's analyze $s_{i,\\varepsilon}$. Without the threshold, $s_i = \\mathrm{minmod}(\\Delta_- u_i, \\Delta_+ u_i)$.\nThe minmod function is defined such that $\\mathrm{minmod}(a,b) = a$ if $|a|  |b|$ and $ab0$; $b$ if $|b|  |a|$ and $ab0$; and $0$ if $ab \\le 0$.\nLet's compare this to $\\phi(r_i) \\Delta_+ u_i$ for a standard minmod flux limiter, for which $\\phi_{\\text{minmod}}(r) = \\max(0, \\min(r,1))$.\nIf $r_i  0$, then $\\Delta_- u_i$ and $\\Delta_+ u_i$ have the same sign.\n\\begin{itemize}\n    \\item If $0  r_i \\le 1$, then $\\phi_{\\text{minmod}}(r_i) = r_i$. The term is $r_i \\Delta_+ u_i = (\\Delta_- u_i / \\Delta_+ u_i) \\Delta_+ u_i = \\Delta_- u_i$. In this case, $|\\Delta_- u_i| \\le |\\Delta_+ u_i|$, so $\\mathrm{minmod}(\\Delta_- u_i, \\Delta_+ u_i) = \\Delta_- u_i$.\n    \\item If $r_i  1$, then $\\phi_{\\text{minmod}}(r_i) = 1$. The term is $1 \\cdot \\Delta_+ u_i = \\Delta_+ u_i$. In this case, $|\\Delta_- u_i|  |\\Delta_+ u_i|$, so $\\mathrm{minmod}(\\Delta_- u_i, \\Delta_+ u_i) = \\Delta_+ u_i$.\n\\end{itemize}\nIf $r_i \\le 0$, then $\\phi_{\\text{minmod}}(r_i) = 0$. The term is $0$. In this case, $\\Delta_- u_i$ and $\\Delta_+ u_i$ have opposite signs or one is zero, so $\\mathrm{minmod}(\\Delta_- u_i, \\Delta_+ u_i) = 0$.\nThus, $s_i = \\mathrm{minmod}(\\Delta_- u_i, \\Delta_+ u_i)$ is mathematically identical to $\\phi_{\\text{minmod}}(r_i) \\Delta_+ u_i$.\nThe minmod limiter $\\phi_{\\text{minmod}}(r)$ satisfies the TVD conditions given in the problem statement ($0 \\le \\phi(r) \\le \\min(2r,2)$ and $\\phi(r \\le 0) = 0$).\nThis proposal's main advantage is that it computes the limited difference directly, completely avoiding the calculation of the ratio $r_i$ and thus sidestepping the division-by-near-zero problem. This is a computationally robust method. The added threshold, which sets $s_{i,\\varepsilon}=0$ when slopes are small, simply forces the scheme to be first-order in near-constant regions, which is a safe operation that preserves the TVD property.\nTherefore, this is a valid and robust way to implement a TVD scheme.\nVerdict: **Correct**.\n\n**Analysis of Option D:**\nThe proposal suggests using the van Albada limiter, $\\phi_{\\mathrm{va}}(r) = \\dfrac{r^2 + r}{r^2 + 1}$, without any special handling for $r \\le 0$. The justification given is its smoothness near $r=0$.\nThe TVD property, however, is not guaranteed by smoothness. It relies on a set of algebraic inequalities. The most fundamental of these is that the limiter must be zero for non-positive ratios, $\\phi(r \\le 0) = 0$, to prevent the growth of new extrema.\nLet's check this condition for the given $\\phi_{\\mathrm{va}}(r)$. For $r \\in (-1, 0)$, $r^2  0$ and $r  0$, with $|r|  |r^2|$, so $r^2+r  0$. Thus $\\phi_{\\mathrm{va}}(r)  0$. For $r  -1$, $r^2+r  0$, so $\\phi_{\\mathrm{va}}(r)0$. For example, $\\phi_{\\mathrm{va}}(-2) = (4-2)/(4+1) = 2/5 \\neq 0$.\nThe function is clearly not zero for all $r \\le 0$. It violates a necessary condition for the scheme to be TVD, even in exact arithmetic. The fact that floating-point errors may occur is secondary to this fundamental flaw. The claim that smoothness at $r=0$ ensures the TVD property is a non-sequitur; smoothness is related to accuracy in resolving extrema, not to the prevention of their growth.\nVerdict: **Incorrect**.",
            "answer": "$$\\boxed{AC}$$"
        }
    ]
}