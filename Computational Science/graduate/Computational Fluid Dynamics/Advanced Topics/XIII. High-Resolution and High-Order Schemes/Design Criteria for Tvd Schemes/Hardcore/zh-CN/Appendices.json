{
    "hands_on_practices": [
        {
            "introduction": "高分辨率TVD格式的核心在于通量限制器，它能智能地添加数值耗散以防止振荡。本练习将引导你实践经典的通量修正输运（Flux-Corrected Transport, FCT）方法。通过为一个急剧的间断手动计算被限制的反扩散通量，你将具体理解这些格式如何动态地在高阶和低阶精度之间切换，以保持解的单调性。",
            "id": "3307932",
            "problem": "考虑标量单元平均值 $u$ 的守恒形式线性平流方程 $u_{t} + a\\,u_{x} = 0$，其中波速 $a > 0$ 为常数。在单元宽度为 $\\Delta x$、时间步长为 $\\Delta t$ 的均匀网格上，使用一维守恒有限体积离散化方法。假设 $a = 1$, $\\Delta x = 1$ 和 $\\Delta t = 0.3$，因此库朗数 $C = a\\,\\Delta t/\\Delta x = 0.3$。初始数据为单位阶跃：对于所有 $i \\le -1$，$u_{i}^{n} = 1$；对于所有 $i \\ge 0$，$u_{i}^{n} = 0$。重点关注交界面区域 $i \\in \\{-2,-1,0,1,2\\}$，并假设在该区域之外，状态保持其远场常数值。\n\n采用通量修正输运 (FCT) 框架，其中一阶单调低阶格式被修正以逼近高阶格式，且该修正受旨在强制执行总变差递减 (TVD) 属性的设计标准所限制。使用以下组成部分：\n- 低阶格式为一阶迎风有限体积法，其数值通量 $F_{i+\\frac{1}{2}}^{L}$ 由迎风状态确定。\n- 高阶候选格式为二阶Lax–Wendroff格式，以通量差分形式表示，且仅用于定义反扩散通量（高阶和低阶数值通量之差）。\n\n按如下方式执行单个 FCT 时间步。首先，根据迎风通量计算低阶更新值 $u_{i}^{L}$。接着，将 Lax–Wendroff 通量与迎风通量之差作为界面反扩散通量 $A_{i+\\frac{1}{2}}$。然后，应用受 TVD 设计准则约束的限制器，即修正后的解 $u_{i}^{n+1}$ 相对于时间层 $n$ 的相邻数据不得产生新的局部极值。使用从时间层 $n$ 的三点模板 $\\{i-1,i,i+1\\}$ 得到的标准局部邻居界限来保证 TVD 单调性，并通过在两个相邻单元共有的每个界面上使用单个受限通量 $\\tilde{A}_{i+\\frac{1}{2}}$ 来强制守恒。具体而言，对每个单元，计算由邻居界限和低阶值 $u_{i}^{L}$ 所隐含的允许的正、负修正预算，然后限制每个面上的反扩散通量，以确保两个相邻单元均不超过其允许的预算；将一个面上的最终限制器取为其两个相邻单元中最严格的那个。\n\n对间断附近的界面和单元执行此完整过程，确定界面 $i+\\tfrac{1}{2} = -\\tfrac{1}{2}$ 处的受限反扩散通量，并计算 $i \\in \\{-1,0,1\\}$ 的修正后单元平均值 $u_{i}^{n+1}$。将经过这单个受限 FCT 步后在 $i=0$ 处的更新后单元平均值作为最终答案报告。请以单个数字形式提供最终答案。无需四舍五入。",
            "solution": "用户希望解决一个计算流体动力学问题，具体是将通量修正输运 (FCT) 格式应用于一个简单的平流问题。\n该问题陈述经核实是科学上合理、良定的，并包含得出唯一解所需的所有信息。这是守恒律数值方法中的一个标准练习。我们开始求解。\n\n控制方程是守恒形式的线性平流方程：\n$$u_t + (au)_x = 0$$\n其中 $u$ 是守恒标量，$a$ 是恒定波速。\n问题给出了以下参数：\n- 波速：$a=1$。\n- 网格间距：$\\Delta x = 1$。\n- 时间步长：$\\Delta t = 0.3$。\n- 库朗数为 $C = \\frac{a \\Delta t}{\\Delta x} = \\frac{1 \\cdot 0.3}{1} = 0.3$。\n\n初始条件是离散为单元平均值的单位阶跃函数：\n$$u_i^n = \\begin{cases} 1  \\text{for } i \\le -1 \\\\ 0  \\text{for } i \\ge 0 \\end{cases}$$\n我们关心的是间断附近的单元，特别是 $i \\in \\{-2, -1, 0, 1, 2\\}$。初始值为：\n$u_{-2}^n = 1$\n$u_{-1}^n = 1$\n$u_0^n = 0$\n$u_1^n = 0$\n$u_2^n = 0$\n\nFCT 过程包含几个步骤，我们将细致地遵循这些步骤。\n\n**步骤1：低阶更新**\n低阶格式是一阶迎風法。有限体积更新由下式给出：\n$$u_i^L = u_i^n - \\frac{\\Delta t}{\\Delta x} (F_{i+1/2}^L - F_{i-1/2}^L)$$\n由于波速 $a=1 > 0$，迎风数值通量为 $F_{i+1/2}^L = a u_i^n = u_i^n$。\n更新方程变为：\n$$u_i^L = u_i^n - \\frac{\\Delta t}{\\Delta x} (u_i^n - u_{i-1}^n) = u_i^n - C(u_i^n - u_{i-1}^n)$$\n我们计算我们感兴趣的单元的低阶解 $u_i^L$：\n- 对于 $i=-1$：$u_{-1}^L = u_{-1}^n - C(u_{-1}^n - u_{-2}^n) = 1 - 0.3(1 - 1) = 1$。\n- 对于 $i=0$：$u_0^L = u_0^n - C(u_0^n - u_{-1}^n) = 0 - 0.3(0 - 1) = 0.3$。\n- 对于 $i=1$：$u_1^L = u_1^n - C(u_1^n - u_0^n) = 0 - 0.3(0 - 0) = 0$。\n\n一个时间步后的低阶解场为：$u_{-1}^L = 1$, $u_0^L = 0.3$, $u_1^L = 0$。\n\n**步骤2：反扩散通量**\n反扩散通量 $A_{i+1/2}$ 是高阶（Lax-Wendroff）通量 $F_{i+1/2}^H$ 和低阶（迎风）通量 $F_{i+1/2}^L$ 之间的差值：\n$$A_{i+1/2} = F_{i+1/2}^H - F_{i+1/2}^L$$\n线性平流的 Lax-Wendroff 通量为 $F_{i+1/2}^H = \\frac{a}{2}(u_i^n + u_{i+1}^n) - \\frac{a^2 \\Delta t}{2 \\Delta x}(u_{i+1}^n - u_i^n) = \\frac{a}{2}(1-C)u_{i+1}^n + \\frac{a}{2}(1+C)u_i^n$。\n迎风通量为 $F_{i+1/2}^L = a u_i^n$。\n因此，反扩散通量为：\n$$A_{i+1/2} = \\left(\\frac{a}{2}(1-C)u_{i+1}^n + \\frac{a}{2}(1+C)u_i^n\\right) - a u_i^n = \\frac{a}{2}(1-C)(u_{i+1}^n - u_i^n)$$\n代入给定值 $a=1$ 和 $C=0.3$：\n$$A_{i+1/2} = \\frac{1}{2}(1-0.3)(u_{i+1}^n - u_i^n) = 0.35(u_{i+1}^n - u_i^n)$$\n我们计算与单元 $i \\in \\{-1, 0, 1\\}$ 相关的界面处的反扩散通量，这些界面为 $i \\in \\{-3/2, -1/2, 1/2, 3/2\\}$。\n- $A_{-3/2} = 0.35(u_{-1}^n - u_{-2}^n) = 0.35(1 - 1) = 0$。\n- $A_{-1/2} = 0.35(u_0^n - u_{-1}^n) = 0.35(0 - 1) = -0.35$。\n- $A_{1/2} = 0.35(u_1^n - u_0^n) = 0.35(0 - 0) = 0$。\n- $A_{3/2} = 0.35(u_2^n - u_1^n) = 0.35(0 - 0) = 0$。\n唯一非零的反扩散通量位于界面 $i=-1/2$ 处。\n\n**步骤3：限制器应用**\n通过将反扩散修正的受限部分加到低阶解上，计算出最终修正解 $u_i^{n+1}$：\n$$u_i^{n+1} = u_i^L - \\frac{\\Delta t}{\\Delta x}(\\tilde{A}_{i+1/2} - \\tilde{A}_{i-1/2})$$\n其中 $\\tilde{A}$ 是受限反扩散通量。项 $\\frac{\\Delta t}{\\Delta x}\\tilde{A}_{i-1/2}$ 表示从左侧进入单元 $i$ 的反扩散，而 $\\frac{\\Delta t}{\\Delta x}\\tilde{A}_{i+1/2}$ 表示离开单元 $i$ 进入右侧的反扩散。一个正通量 $\\tilde{A}_{j+1/2}$ 将“修正质量”从单元 $j$ 移动到单元 $j+1$。\n\nTVD 约束要求不产生新的局部极值。更新后的值 $u_i^{n+1}$ 必须位于其在时间层 $n$ 的邻居所设定的界限内：\n$$u_i^{\\min} \\le u_i^{n+1} \\le u_i^{\\max}$$\n其中 $u_i^{\\min} = \\min(u_{i-1}^n, u_i^n, u_{i+1}^n)$ 且 $u_i^{\\max} = \\max(u_{i-1}^n, u_i^n, u_{i+1}^n)$。\n根据这些界限，我们定义相对于其低阶状态 $u_i^L$ 而言，单元 $i$ 可用的修正“空间”：\n- 最大允许增量（正预算）：$Q_i^+ = u_i^{\\max} - u_i^L$。\n- 最大允许减量（负预算）：$Q_i^- = u_i^L - u_i^{\\min}$。\n\n让我们为与非零通量 $A_{-1/2}$ 相邻的单元（即单元 $i=-1$ 和 $i=0$）计算这些值。\n- 对于 $i=-1$：\n  $u_{-1}^{\\min} = \\min(u_{-2}^n, u_{-1}^n, u_0^n) = \\min(1, 1, 0) = 0$。\n  $u_{-1}^{\\max} = \\max(u_{-2}^n, u_{-1}^n, u_0^n) = \\max(1, 1, 0) = 1$。\n  $u_{-1}^L = 1$。\n  $Q_{-1}^+ = u_{-1}^{\\max} - u_{-1}^L = 1 - 1 = 0$。\n  $Q_{-1}^- = u_{-1}^L - u_{-1}^{\\min} = 1 - 0 = 1$。\n- 对于 $i=0$：\n  $u_0^{\\min} = \\min(u_{-1}^n, u_0^n, u_1^n) = \\min(1, 0, 0) = 0$。\n  $u_0^{\\max} = \\max(u_{-1}^n, u_0^n, u_1^n) = \\max(1, 0, 0) = 1$。\n  $u_0^L = 0.3$。\n  $Q_0^+ = u_0^{\\max} - u_0^L = 1 - 0.3 = 0.7$。\n  $Q_0^- = u_0^L - u_0^{\\min} = 0.3 - 0 = 0.3$。\n\n现在我们限制通量 $A_{-1/2} = -0.35$。\n单元 $i$ 中由反扩散通量引起的变化为 $\\delta_i = -\\frac{\\Delta t}{\\Delta x}(\\tilde{A}_{i+1/2} - \\tilde{A}_{i-1/2}) = -0.3(\\tilde{A}_{i+1/2} - \\tilde{A}_{i-1/2})$。\n通量 $A_{-1/2}$ 为负，表示“修正质量”从单元 $i=0$（供给单元）转移到单元 $i=-1$（接收单元）。\n待转移的修正质量量为 $M = \\frac{\\Delta t}{\\Delta x} |A_{-1/2}| = 0.3 \\times |-0.35| = 0.105$。\n此转移试图将 $u_{-1}$ 增加 $0.105$ 并将 $u_0$ 减少 $0.105$。\n\n我们用这两个单元的预算来核对此转移：\n- 接收单元是 $i=-1$。其增加的能力是 $Q_{-1}^+ = 0$。请求的增量是 $0.105$。由于 $0.105 > 0$，接收单元无法容纳此转移。它能接受的最大值为 $0$。\n- 供给单元是 $i=0$。其减少的能力是 $Q_0^- = 0.3$。请求的减量是 $0.105$。由于 $0.105 \\le 0.3$，供给单元可以承受此转移。\n\n最终受限通量必须对两个相邻单元都是可接受的。我们取最严格的约束。转移的“修正质量”量 $M^*$ 不得超过供给单元能给出的量，也不得超过接收单元能接受的量。\n$$M^* = \\min(\\text{请求转移量, 供给单元能力, 接收单元能力})$$\n$$M^* = \\min(M, Q_0^-, Q_{-1}^+) = \\min(0.105, 0.3, 0) = 0$$\n受限转移量为 $M^*=0$。这意味着导致此转移的受限通量必须为零。\n受限转移量通过 $M^* = \\frac{\\Delta t}{\\Delta x} |\\tilde{A}_{-1/2}|$ 与受限通量相关联。由于 $M^* = 0$，我们有 $\\tilde{A}_{-1/2} = 0$。\n\n所有其他反扩散通量本来就为零，因此它们对应的受限值也为零。对于所有 $i$，$\\tilde{A}_{i+1/2} = 0$。\n\n**步骤4：最终更新**\n我们使用受限通量计算修正后的单元平均值。\n$$u_i^{n+1} = u_i^L - 0.3(\\tilde{A}_{i+1/2} - \\tilde{A}_{i-1/2})$$\n由于所有的 $\\tilde{A}_{i+1/2}$ 都为零，因此所有单元的修正项都为零。最终解就是低阶解。\n$$u_i^{n+1} = u_i^L$$\n- 对于 $i=-1$：$u_{-1}^{n+1} = u_{-1}^L = 1$。\n- 对于 $i=0$：$u_0^{n+1} = u_0^L = 0.3$。\n- 对于 $i=1$：$u_1^{n+1} = u_1^L = 0$。\n\n在 $i=0$ 处的更新后单元平均值为 $u_0^{n+1} = 0.3$。\n这个结果是 TVD 格式在尖锐间断处的典型特征；高阶格式的反压缩特性被单调性约束完全抑制，导致格式局部退化为其一阶扩散部分。\n所要求的最终答案是 $u_0^{n+1}$ 的值。",
            "answer": "$$\\boxed{0.3}$$"
        },
        {
            "introduction": "尽管TVD格式因其能无伪振荡地捕捉尖锐梯度而备受青睐，但精确理解TVD保证的范围至关重要。本练习旨在探究总变差递减（Total Variation Diminishing, TVD）属性与逐点极值原理之间的微妙关系，尤其是在存在源项的情况下。通过这个反例的演算，你将发现一个严格满足TVD条件的格式仍可能产生新的解的极大值，从而澄清这一概念的一个关键限制。",
            "id": "3307938",
            "problem": "考虑一维周期性区域上的标量对流-反应方程 $u_{t} + a\\,u_{x} = \\kappa\\,(1 - u)$，该区域具有均匀的单元中心，索引为 $i \\in \\{1,2,3,4,5\\}$，间距为 $\\Delta x$。设初始单元中心数据为 $u_{1}^{0} = 0.1$, $u_{2}^{0} = 0.2$, $u_{3}^{0} = 0.4$, $u_{4}^{0} = 0.2$, $u_{5}^{0} = 0.1$，并采用周期性条件 $u_{6}^{0} \\equiv u_{1}^{0}$ 和 $u_{0}^{0} \\equiv u_{5}^{0}$。使用一个时间步长 $\\Delta t$ 内的双算子分裂格式，定义如下：\n1. 对于 $a > 0$ 的情况，通过一阶迎风守恒离散进行对流更新，\n$$\nu_{i}^{\\ast} \\;=\\; u_{i}^{n} \\;-\\; \\nu \\,\\big(u_{i}^{n} - u_{i-1}^{n}\\big), \\quad \\nu \\equiv \\frac{a\\,\\Delta t}{\\Delta x},\n$$\n已知该格式在 $0 \\le \\nu \\le 1$ 时是总变差递减 (TVD) 的。\n2. 一个局部逐点源项更新，精确地应用于每个单元，\n$$\nu_{i}^{n+1} \\;=\\; 1 \\;-\\; \\big(1 - u_{i}^{\\ast}\\big)\\,\\exp\\!\\big(-\\kappa\\,\\Delta t\\big).\n$$\n\n设 $a = 1$, $\\Delta x = 1$, $\\Delta t = 0.4$ 且 $\\kappa = 2$，因此 $\\nu = 0.4$ 且 $\\exp(-\\kappa\\,\\Delta t) = \\exp(-0.8)$。将周期性网格上的离散总变差定义为\n$$\n\\mathrm{TV}\\!\\left(u^{n}\\right) \\;=\\; \\sum_{i=1}^{5} \\big|u_{i+1}^{n} - u_{i}^{n}\\big|, \\quad u_{6}^{n} \\equiv u_{1}^{n}.\n$$\n将逐点极值原理定义为要求 $\\max_{i} u_{i}^{n+1} \\le \\max_{i} u_{i}^{n}$。\n\n从上述基本定义出发，不使用任何预先推导的高分辨率公式，使用所述的格式和参数执行单个时间步。证明对流迎风步和精确源项步相对于所述的 $\\mathrm{TV}$ 度量都是总变差递减的，但复合的单步更新 $u^{0} \\mapsto u^{1}$ 不满足严格的逐点极值原理。计算过冲量\n$$\n\\delta \\;\\equiv\\; \\max_{i} u_{i}^{1} \\;-\\; \\max_{i} u_{i}^{0}.\n$$\n将 $\\delta$ 的最终数值四舍五入到四位有效数字。将过冲量表示为无量纲数。",
            "solution": "首先对问题陈述进行严格的验证。\n\n### 步骤 1：提取已知条件\n问题陈述中提供的数据、定义和条件如下：\n- **控制方程：** 标量对流-反应方程 $u_{t} + a\\,u_{x} = \\kappa\\,(1 - u)$。\n- **区域与网格：** 一维周期性区域，有 $5$ 个均匀的单元中心，索引为 $i \\in \\{1,2,3,4,5\\}$，间距为 $\\Delta x$。\n- **初始数据 ($n=0$)：** $u_{1}^{0} = 0.1$, $u_{2}^{0} = 0.2$, $u_{3}^{0} = 0.4$, $u_{4}^{0} = 0.2$, $u_{5}^{0} = 0.1$。\n- **周期性：** $u_{6}^{n} \\equiv u_{1}^{n}$ 和 $u_{0}^{n} \\equiv u_{5}^{n}$。\n- **数值格式：** 一个时间步长 $\\Delta t$ 内的双算子分裂格式。\n    1. **对流步：** $u_{i}^{\\ast} \\;=\\; u_{i}^{n} \\;-\\; \\nu \\,\\big(u_{i}^{n} - u_{i-1}^{n}\\big)$，其中 $\\nu \\equiv \\frac{a\\,\\Delta t}{\\Delta x}$。这是针对 $a > 0$ 的一阶迎风守恒离散。已知在 $0 \\le \\nu \\le 1$ 时是总变差递减 (TVD) 的。\n    2. **源项步：** $u_{i}^{n+1} \\;=\\; 1 \\;-\\; \\big(1 - u_{i}^{\\ast}\\big)\\,\\exp\\!\\big(-\\kappa\\,\\Delta t\\big)$。这是对常微分方程 $u_t = \\kappa(1-u)$ 的精确更新。\n- **参数：** $a = 1$, $\\Delta x = 1$, $\\Delta t = 0.4$, $\\kappa = 2$。\n- **导出参数：** $\\nu = \\frac{1 \\cdot 0.4}{1} = 0.4$，以及 $\\exp(-\\kappa\\,\\Delta t) = \\exp(-2 \\cdot 0.4) = \\exp(-0.8)$。\n- **定义：**\n    - **离散总变差：** $\\mathrm{TV}\\!\\left(u^{n}\\right) \\;=\\; \\sum_{i=1}^{5} \\big|u_{i+1}^{n} - u_{i}^{n}\\big|$，其中 $u_{6}^{n} \\equiv u_{1}^{n}$。\n    - **逐点极值原理：** $\\max_{i} u_{i}^{n+1} \\le \\max_{i} u_{i}^{n}$。\n- **要求任务：**\n    1. 执行从 $u^0$ 到 $u^1$ 的一个时间步更新。\n    2. 证明对流步和源项步都是 TVD 的。\n    3. 证明复合更新违反了逐点极值原理。\n    4. 计算过冲量 $\\delta \\;\\equiv\\; \\max_{i} u_{i}^{1} \\;-\\; \\max_{i} u_{i}^{0}$ 并四舍五入到四位有效数字。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据：** 该问题牢固地植根于偏微分方程数值分析领域，特别是计算流体动力学。对流-反应方程、算子分裂、迎风格式以及对总变差递减 (TVD) 和极值原理等性质的分析都是标准的、成熟的概念。\n- **适定性：** 该问题是完全指定的。它提供了一套清晰的初始数据、参数、定义和计算步骤序列。任务是明确的，并导向一个唯一的、可验证的解。\n- **客观性：** 问题以精确、客观的数学语言陈述。它要求基于给定定义进行计算和逻辑证明，没有主观解释的余地。\n- **一致性与完整性：** 所提供的数据是自洽的。例如，计算出的库朗数 $\\nu = 0.4$ 落在为迎风格式所述的稳定性和 TVD 范围 $0 \\le \\nu \\le 1$ 内。提供了求解所需的所有信息。\n\n### 步骤 3：结论与行动\n问题是有效的，因为它在科学上是合理的、适定的、客观的和自洽的。现在开始求解过程。\n\n### 求解\n\n求解过程包括执行单个时间步更新 $u^0 \\mapsto u^1$ 并按要求分析每个子步骤的性质。\n\n**初始状态分析**\n首先，我们计算初始数据 $u^0$ 的总变差和最大值。\n初始数据向量为 $u^0 = (u_{1}^{0}, u_{2}^{0}, u_{3}^{0}, u_{4}^{0}, u_{5}^{0}) = (0.1, 0.2, 0.4, 0.2, 0.1)$。\n相邻单元之间的差值，包括周期性环绕 ($u_{6}^{0} \\equiv u_1^0$)，为：\n$u_{2}^{0} - u_{1}^{0} = 0.2 - 0.1 = 0.1$\n$u_{3}^{0} - u_{2}^{0} = 0.4 - 0.2 = 0.2$\n$u_{4}^{0} - u_{3}^{0} = 0.2 - 0.4 = -0.2$\n$u_{5}^{0} - u_{4}^{0} = 0.1 - 0.2 = -0.1$\n$u_{6}^{0} - u_{5}^{0} = u_{1}^{0} - u_{5}^{0} = 0.1 - 0.1 = 0.0$\n\n初始总变差是这些差值绝对值的和：\n$$\n\\mathrm{TV}(u^{0}) = |0.1| + |0.2| + |-0.2| + |-0.1| + |0.0| = 0.1 + 0.2 + 0.2 + 0.1 + 0.0 = 0.6\n$$\n初始数据的最大值为：\n$$\n\\max_{i} u_{i}^{0} = u_{3}^{0} = 0.4\n$$\n\n**步骤 1：对流更新**\n第一步是使用一阶迎风格式进行对流更新。当 $\\nu = 0.4$ 时，公式为：\n$u_{i}^{\\ast} = u_{i}^{0} - 0.4(u_{i}^{0} - u_{i-1}^{0}) = 0.6 u_{i}^{0} + 0.4 u_{i-1}^{0}$。\n我们使用周期性条件 $u_{0}^{0} \\equiv u_5^0$，为每个单元 $i=1, \\ldots, 5$ 计算 $u_{i}^{\\ast}$。\n$u_{1}^{\\ast} = 0.6 u_{1}^{0} + 0.4 u_{0}^{0} = 0.6 u_{1}^{0} + 0.4 u_{5}^{0} = 0.6(0.1) + 0.4(0.1) = 0.06 + 0.04 = 0.1$\n$u_{2}^{\\ast} = 0.6 u_{2}^{0} + 0.4 u_{1}^{0} = 0.6(0.2) + 0.4(0.1) = 0.12 + 0.04 = 0.16$\n$u_{3}^{\\ast} = 0.6 u_{3}^{0} + 0.4 u_{2}^{0} = 0.6(0.4) + 0.4(0.2) = 0.24 + 0.08 = 0.32$\n$u_{4}^{\\ast} = 0.6 u_{4}^{0} + 0.4 u_{3}^{0} = 0.6(0.2) + 0.4(0.4) = 0.12 + 0.16 = 0.28$\n$u_{5}^{\\ast} = 0.6 u_{5}^{0} + 0.4 u_{4}^{0} = 0.6(0.1) + 0.4(0.2) = 0.06 + 0.08 = 0.14$\n中间状态为 $u^{\\ast} = (0.1, 0.16, 0.32, 0.28, 0.14)$。\n\n**证明对流步是 TVD 的**\n我们现在计算中间状态 $u^{\\ast}$ 的总变差。差值为：\n$u_{2}^{\\ast} - u_{1}^{\\ast} = 0.16 - 0.1 = 0.06$\n$u_{3}^{\\ast} - u_{2}^{\\ast} = 0.32 - 0.16 = 0.16$\n$u_{4}^{\\ast} - u_{3}^{\\ast} = 0.28 - 0.32 = -0.04$\n$u_{5}^{\\ast} - u_{4}^{\\ast} = 0.14 - 0.28 = -0.14$\n$u_{6}^{\\ast} - u_{5}^{\\ast} = u_{1}^{\\ast} - u_{5}^{\\ast} = 0.1 - 0.14 = -0.04$\n总变差为：\n$$\n\\mathrm{TV}(u^{\\ast}) = |0.06| + |0.16| + |-0.04| + |-0.14| + |-0.04| = 0.06 + 0.16 + 0.04 + 0.14 + 0.04 = 0.44\n$$\n与初始总变差相比，我们有 $\\mathrm{TV}(u^{\\ast}) = 0.44 \\le 0.6 = \\mathrm{TV}(u^{0})$。这证明了对于这个特定情况，对流步是总变差递减的，正如预期。\n\n**步骤 2：源项更新**\n第二步是源项更新，逐点应用于 $u^{\\ast}$ 的每个单元：\n$u_{i}^{1} = 1 - (1 - u_{i}^{\\ast}) \\exp(-\\kappa \\Delta t)$。\n当 $\\exp(-\\kappa \\Delta t) = \\exp(-0.8)$ 时，我们计算 $u_{i}^{1}$：\n$u_{1}^{1} = 1 - (1 - 0.1) \\exp(-0.8) = 1 - 0.9 \\exp(-0.8)$\n$u_{2}^{1} = 1 - (1 - 0.16) \\exp(-0.8) = 1 - 0.84 \\exp(-0.8)$\n$u_{3}^{1} = 1 - (1 - 0.32) \\exp(-0.8) = 1 - 0.68 \\exp(-0.8)$\n$u_{4}^{1} = 1 - (1 - 0.28) \\exp(-0.8) = 1 - 0.72 \\exp(-0.8)$\n$u_{5}^{1} = 1 - (1 - 0.14) \\exp(-0.8) = 1 - 0.86 \\exp(-0.8)$\n\n**证明源项步是 TVD 的**\n设源项更新由函数 $f(v) = 1 - (1-v)E$ 表示，其中 $E = \\exp(-\\kappa \\Delta t)$。在 n+1 时间层，相邻单元之间的差值为：\n$u_{i+1}^{1} - u_{i}^{1} = f(u_{i+1}^{\\ast}) - f(u_{i}^{\\ast}) = [1 - (1 - u_{i+1}^{\\ast})E] - [1 - (1 - u_{i}^{\\ast})E] = E(u_{i+1}^{\\ast} - u_{i}^{\\ast})$。\n由于 $E = \\exp(-0.8) > 0$，差值的绝对值为 $|u_{i+1}^{1} - u_{i}^{1}| = E |u_{i+1}^{\\ast} - u_{i}^{\\ast}|$。\n那么总变差为：\n$$\n\\mathrm{TV}(u^{1}) = \\sum_{i=1}^{5} |u_{i+1}^{1} - u_{i}^{1}| = \\sum_{i=1}^{5} E |u_{i+1}^{\\ast} - u_{i}^{\\ast}| = E \\sum_{i=1}^{5} |u_{i+1}^{\\ast} - u_{i}^{\\ast}| = E \\cdot \\mathrm{TV}(u^{\\ast})\n$$\n由于 $\\kappa = 2 > 0$ 且 $\\Delta t = 0.4 > 0$，我们有 $E = \\exp(-0.8)  1$。因此，$\\mathrm{TV}(u^{1})  \\mathrm{TV}(u^{\\ast})$。\n数值上，$\\mathrm{TV}(u^{1}) = \\exp(-0.8) \\times 0.44 \\approx 0.449329 \\times 0.44 \\approx 0.1977$。\n由于 $\\mathrm{TV}(u^{1}) \\approx 0.1977  0.44 = \\mathrm{TV}(u^{\\ast})$，这证明了源项步也是总变差递减的。\n\n**证明违反极值原理**\n逐点极值原理要求 $\\max_{i} u_{i}^{1} \\le \\max_{i} u_{i}^{0}$。\n我们确定了 $\\max_{i} u_{i}^{0} = 0.4$。\n现在我们求 $\\max_{i} u_{i}^{1}$。源项更新函数 $f(v) = 1 - (1-v)E$ 是其自变量 $v$ 的单调递增函数，因为其导数 $f'(v) = E > 0$。因此，$u^1$ 的最大值将出现在与 $u^{\\ast}$ 最大值相同的单元索引 $i$ 处。\n从对流步可知，中间状态的最大值为 $\\max_{i} u_{i}^{\\ast} = u_{3}^{\\ast} = 0.32$。\n因此，最终状态的最大值为：\n$$\n\\max_{i} u_{i}^{1} = u_{3}^{1} = 1 - (1 - u_{3}^{\\ast})\\exp(-0.8) = 1 - (1 - 0.32)\\exp(-0.8) = 1 - 0.68 \\exp(-0.8)\n$$\n为了证明违反了该原理，我们必须证明 $1 - 0.68 \\exp(-0.8) > 0.4$。\n这个不等式等价于 $0.6 > 0.68 \\exp(-0.8)$。\n使用数值 $\\exp(-0.8) \\approx 0.449329$：\n$0.68 \\exp(-0.8) \\approx 0.68 \\times 0.449329 \\approx 0.305544$。\n不等式变为 $0.6 > 0.305544$，这是成立的。\n因此，$\\max_{i} u_{i}^{1} > \\max_{i} u_{i}^{0}$，并且复合单步更新不满足逐点极值原理。源项将解推向稳态 $u=1$，是导致这个增长超过初始最大值的原因。\n\n**计算过冲量**\n过冲量 $\\delta$ 定义为 $\\delta = \\max_{i} u_{i}^{1} - \\max_{i} u_{i}^{0}$。\n使用上面推导的表达式：\n$$\n\\delta = \\left(1 - 0.68 \\exp(-0.8)\\right) - 0.4 = 0.6 - 0.68 \\exp(-0.8)\n$$\n代入 $\\exp(-0.8)$ 的值：\n$$\n\\delta \\approx 0.6 - 0.68 \\times 0.449328964 \\approx 0.6 - 0.30554369552 = 0.29445630448\n$$\n将此结果四舍五入到四位有效数字，得到：\n$$\n\\delta \\approx 0.2945\n$$",
            "answer": "$$\\boxed{0.2945}$$"
        },
        {
            "introduction": "一个完全离散的TVD格式需要将合适的空间算子与能够保持其无振荡特性的时间积分方法相结合。本练习深入探讨了不同的时间积分器，如多导数方法和强稳定性保持（Strong Stability Preserving, SSP）龙格-库塔格式，在与一个TVD半离散化格式耦合时，如何维持TVD属性。你将分析并比较它们的稳定性限制，从而深入理解如何从整体上设计鲁棒的高分辨率数值方法。",
            "id": "3307906",
            "problem": "考虑线性平流方程 $u_{t} + a\\,u_{x} = 0$（其中 $a>0$），该方程定义在间距为 $\\Delta x$ 的均匀周期性网格上，并使用一阶迎风半离散化方法在空间上进行离散\n$$\n\\frac{d u_{j}}{d t} \\;=\\; L(u)_{j} \\;=\\; -\\frac{a}{\\Delta x}\\left(u_{j}-u_{j-1}\\right),\n$$\n其中 $u_{j}(t)$ 近似 $u(x_{j},t)$ 且 $x_{j}=j\\,\\Delta x$。已知对于 Courant 数 $\\nu = a\\,\\Delta t/\\Delta x$ 在范围 $0 \\le \\nu \\le 1$ 内，前向 Euler 方法 $u^{n+1} = u^{n} + \\Delta t\\,L(u^{n})$ 是总变差减小（Total Variation Diminishing, TVD）的。在设计 TVD 格式的背景下，考虑以下两种时间积分器：\n\n- 一种由下式定义的二阶导数 Taylor 时间积分器\n$$\nu^{n+1} \\;=\\; u^{n} \\;+\\; \\Delta t\\,L(u^{n}) \\;+\\; \\frac{1}{2}\\,\\Delta t^{2}\\,L^{2}(u^{n}),\n$$\n其中 $L^{2}$ 表示将半离散算子 $L$ 进行复合运算 $L\\circ L$。\n\n- 三阶强稳定保持（Strong Stability Preserving, SSP）Runge–Kutta（RK）方法（3 阶，3 级），当写成 Shu–Osher 形式时，它被构造为前向 Euler 更新的凸组合。\n\n仅使用 TVD 性质关于分段常数单元平均值总变差的基本定义，以及关于单调线性格式的标准事实，完成以下任务：\n\n1. 对 Courant 数 $\\nu$ 建立一个必要且充分的约束条件，在该条件下，应用于给定空间半离散化的二阶导数 Taylor 时间积分器是 TVD 的。你的论证应基于将全离散更新表示为网格点值的线性凸组合（其非负系数之和为 1），并解释为什么对于线性标量问题，这足以保证 TVD 性质。\n\n2. 对于上述三阶 SSP RK 方法，给定空间算子在前向 Euler 方法下当 $0 \\le \\nu \\le 1$ 时是 TVD 的，确定保证 TVD 的最大 $\\Delta t$。你的推理应依赖于将其每个阶段表示为前向 Euler 步长的凸组合的凸组合（Shu–Osher）结构。\n\n最后，令 $\\Delta t_{\\max,\\mathrm{TD}}$ 表示确保二阶导数 Taylor 方法在此问题上为 TVD 的最大时间步长，令 $\\Delta t_{\\max,\\mathrm{SSPRK3}}$ 表示确保三阶 SSP RK 方法在此问题上为 TVD 的最大时间步长。计算比率\n$$\n\\mathcal{R} \\;=\\; \\frac{\\Delta t_{\\max,\\mathrm{TD}}}{\\Delta t_{\\max,\\mathrm{SSPRK3}}}\n$$\n结果为一个实数。无需四舍五入；给出无单位的精确值。",
            "solution": "我们从常微分方程组法（method-of-lines）的半离散化开始\n$$\n\\frac{d u_{j}}{d t} \\;=\\; L(u)_{j} \\;=\\; -\\frac{a}{\\Delta x}\\left(u_{j}-u_{j-1}\\right),\n$$\n其中 $a>0$，并定义 Courant 数 $\\nu = a\\,\\Delta t/\\Delta x$。对于均匀网格上的线性标量格式，总变差减小（TVD）性质可以通过单调性来保证：一个形如\n$$\nu^{n+1}_{j} \\;=\\; \\sum_{k} \\alpha_{k}\\,u^{n}_{j-k}\n$$\n的线性更新，若其系数满足 $\\alpha_{k} \\ge 0$ 且 $\\sum_{k}\\alpha_{k} = 1$，则它在离散有界变差半范数 $\\mathrm{TV}(u) = \\sum_{j} |u_{j} - u_{j-1}|$ 下是收缩的，因此是 TVD 的。这可由 $\\ell_{1}$ 范数的凸性和模板的平移不变性得出：如果 $\\mathbf{A}$ 是一个具有非负元素且行和为 1 的 Toeplitz 矩阵，那么 $\\|\\mathbf{D}\\mathbf{A}\\|_{1} \\le \\|\\mathbf{D}\\|_{1}$，其中 $\\mathbf{D}$ 是一阶差分算子，这意味着 $\\mathrm{TV}(u^{n+1}) \\le \\mathrm{TV}(u^{n})$。\n\n步骤 1：二阶导数 Taylor 时间积分器的 TVD 条件。\n\n二阶导数 Taylor 积分器为\n$$\nu^{n+1} \\;=\\; u^{n} \\;+\\; \\Delta t\\,L(u^{n}) \\;+\\; \\frac{1}{2}\\,\\Delta t^{2}\\,L^{2}(u^{n}).\n$$\n对于给定的线性常系数算子 $L$，我们可以计算 $L^{2}$。首先，\n$$\nL(u)_{j} \\;=\\; -\\frac{a}{\\Delta x}\\left(u_{j}-u_{j-1}\\right).\n$$\n然后\n$$\nL^{2}(u)_{j} \\;=\\; L(L(u))_{j} \\;=\\; -\\frac{a}{\\Delta x}\\left(L(u)_{j}-L(u)_{j-1}\\right)\n\\;=\\; -\\frac{a}{\\Delta x}\\left(-\\frac{a}{\\Delta x}(u_{j}-u_{j-1}) + \\frac{a}{\\Delta x}(u_{j-1}-u_{j-2})\\right)\n\\;=\\; \\frac{a^{2}}{\\Delta x^{2}}\\left(u_{j}-2u_{j-1}+u_{j-2}\\right).\n$$\n因此，\n$$\nu^{n+1}_{j}\n= u^{n}_{j} + \\Delta t\\left(-\\frac{a}{\\Delta x}(u^{n}_{j}-u^{n}_{j-1})\\right) + \\frac{1}{2}\\Delta t^{2}\\,\\frac{a^{2}}{\\Delta x^{2}}\\left(u^{n}_{j}-2u^{n}_{j-1}+u^{n}_{j-2}\\right).\n$$\n引入 $\\nu = a\\,\\Delta t/\\Delta x$，我们得到显式三点模板\n$$\nu^{n+1}_{j} \\;=\\; c_{0}(\\nu)\\,u^{n}_{j} \\;+\\; c_{1}(\\nu)\\,u^{n}_{j-1} \\;+\\; c_{2}(\\nu)\\,u^{n}_{j-2},\n$$\n其系数为\n$$\nc_{0}(\\nu) \\;=\\; 1 - \\nu + \\frac{1}{2}\\nu^{2},\\qquad\nc_{1}(\\nu) \\;=\\; \\nu - \\nu^{2},\\qquad\nc_{2}(\\nu) \\;=\\; \\frac{1}{2}\\nu^{2}.\n$$\n这些系数对所有 $\\nu$ 都满足\n$$\nc_{0}(\\nu) + c_{1}(\\nu) + c_{2}(\\nu) \\;=\\; 1\n$$\n。为了通过单调性保证 TVD，我们要求对于 $k \\in \\{0,1,2\\}$，有 $c_{k}(\\nu) \\ge 0$。条件如下：\n- $c_{2}(\\nu) = \\frac{1}{2}\\nu^{2} \\ge 0$ 对所有 $\\nu$ 成立（平凡成立）。\n- $c_{1}(\\nu) = \\nu - \\nu^{2} \\ge 0$ 当且仅当 $0 \\le \\nu \\le 1$。\n- $c_{0}(\\nu) = 1 - \\nu + \\frac{1}{2}\\nu^{2} \\ge 0$ 对所有 $\\nu$ 成立，因为这个二次式的判别式 $\\Delta = (-1)^{2} - 2 = -1  0$ 且其首项系数为正，这意味着对所有实数 $\\nu$ 都有 $c_{0}(\\nu) > 0$；等价地，其最小值在 $\\nu = 1$ 处取得，值为 $c_{0}(1) = \\frac{1}{2}$。\n\n因此，二阶导数 Taylor 更新是带有非负系数的凸组合，当且仅当 $0 \\le \\nu \\le 1$。根据单调性论证，对于给定的半离散化，该条件是此全离散格式为 TVD 的充分必要条件。将 $\\nu \\le 1$ 转化为时间步长约束，得到\n$$\n\\Delta t_{\\max,\\mathrm{TD}} \\;=\\; \\frac{\\Delta x}{a}.\n$$\n\n步骤 2：三阶强稳定保持 Runge–Kutta 方法的 TVD 条件和最大 $\\Delta t$。\n\n三阶三级的强稳定保持（SSP）Runge–Kutta 方法可以写成 Shu–Osher 形式，即作用于中间状态的前向 Euler 步长的凸组合。具体来说，其各个阶段可以表示为\n$$\n\\begin{aligned}\nu^{(1)} \\;=\\; u^{n} + \\Delta t\\,L(u^{n}),\\\\\nu^{(2)} \\;=\\; \\frac{3}{4}\\,u^{n} + \\frac{1}{4}\\left(u^{(1)} + \\Delta t\\,L(u^{(1)})\\right),\\\\\nu^{n+1} \\;=\\; \\frac{1}{3}\\,u^{n} + \\frac{2}{3}\\left(u^{(2)} + \\Delta t\\,L(u^{(2)})\\right).\n\\end{aligned}\n$$\n每次出现时，前向 Euler 这个基本构造块都使用相同的时间步长 $\\Delta t$。如果前向 Euler 更新 $u \\mapsto u + \\Delta t\\,L(u)$ 在 $0 \\le \\nu \\le 1$ 时是 TVD 的，那么每个阶段，作为 TVD 运算的凸组合，在 $\\Delta t \\le \\Delta t_{\\mathrm{FE}}$ 的条件下也是 TVD 的，其中 $\\Delta t_{\\mathrm{FE}} = \\Delta x/a$ 是由 $0 \\le \\nu \\le 1$ 决定的前向 Euler 极限。由于 Shu–Osher 形式在任何阶段都没有将 $\\Delta t$ 放大到超过前向 Euler 的值，因此保证此 SSP RK 方法为 TVD 的最大 $\\Delta t$ 正是前向 Euler 极限：\n$\n\\Delta t_{\\max,\\mathrm{SSPRK3}} = \\Delta t_{\\mathrm{FE}} = \\Delta x/a.\n$\n\n最终比率。\n\n根据步骤 1 和步骤 2，我们有\n$$\n\\Delta t_{\\max,\\mathrm{TD}} \\;=\\; \\frac{\\Delta x}{a},\\qquad\n\\Delta t_{\\max,\\mathrm{SSPRK3}} \\;=\\; \\frac{\\Delta x}{a}.\n$$\n因此，\n$$\n\\mathcal{R} \\;=\\; \\frac{\\Delta t_{\\max,\\mathrm{TD}}}{\\Delta t_{\\max,\\mathrm{SSPRK3}}} \\;=\\; \\frac{\\Delta x/a}{\\Delta x/a} \\;=\\; 1.\n$$\n该值为精确值，无需四舍五入。",
            "answer": "$$\\boxed{1}$$"
        }
    ]
}