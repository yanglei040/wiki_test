{
    "hands_on_practices": [
        {
            "introduction": "This first exercise establishes the fundamental mechanism of slope limiting in Discontinuous Galerkin (DG) methods. We will explore the `minmod` limiter, a classic tool used to enforce monotonicity and prevent the formation of non-physical oscillations near sharp gradients or discontinuities. By applying this limiter to a hypothetical set of cell averages, you will gain hands-on experience with the core logic of Total Variation Diminishing (TVD) reconstructions. ",
            "id": "3443823",
            "problem": "Consider the one-dimensional scalar conservation law $u_{t} + f(u)_{x} = 0$ discretized on a uniform mesh of cells $\\{I_{i}\\}$ with spacing $h>0$ and cell centers $x_{i}$. In a piecewise linear Discontinuous Galerkin (DG) approximation, the local polynomial representation in cell $I_{i}$ is $p_{i}(x) = \\bar{u}_{i} + s_{i}(x - x_{i})$, where $\\bar{u}_{i}$ denotes the cell average and $s_{i}$ is a slope estimated from the modal coefficient. To suppress spurious oscillations while preserving a discrete maximum principle under a monotone numerical flux and a Forward Euler time update, one enforces that the reconstructed interfacial values $p_{i}(x_{i\\pm\\frac{1}{2}}) = \\bar{u}_{i} \\pm \\frac{h}{2}s_{i}$ lie between neighboring cell averages, which implies that the admissible slope must be sign-consistent with the one-sided discrete gradients and must not exceed their magnitudes.\n\nStarting from the above monotonicity constraint and the requirement for Total Variation Diminishing (TVD) behavior, derive the limiting rule for the slope $s_{i}$ in terms of the one-sided differences $(\\bar{u}_{i} - \\bar{u}_{i-1})/h$ and $(\\bar{u}_{i+1} - \\bar{u}_{i})/h$, and then apply this rule to compute the limited slope $s_{i}^{\\ell}$ in the following specific configuration:\n- Neighboring cell averages are given by $\\bar{u}_{i-1} = 1$, $\\bar{u}_{i} = 0.2$, and $\\bar{u}_{i+1} = 0.3$.\n- The local unconstrained slope estimate is $s_{i} = 0.9$.\n\nAssume $h>0$ and that the limiter is constructed using the classical minmod mechanism applied to the set $\\{s_{i}, (\\bar{u}_{i} - \\bar{u}_{i-1})/h, (\\bar{u}_{i+1} - \\bar{u}_{i})/h\\}$. Provide the final value of $s_{i}^{\\ell}$ as an exact number with no rounding, and do not include any physical units.",
            "solution": "The problem requires the derivation of a slope limiting rule for a piecewise linear Discontinuous Galerkin (DG) method and its application to a specific case. The validation of the problem statement is the first step.\n\n**Problem Validation**\n\nStep 1: Extract Givens\n-   The one-dimensional scalar conservation law is $u_{t} + f(u)_{x} = 0$.\n-   The computational grid consists of uniform cells $\\{I_{i}\\}$ with spacing $h > 0$ and centers $x_{i}$.\n-   The local DG approximation in cell $I_{i}$ is a linear polynomial $p_{i}(x) = \\bar{u}_{i} + s_{i}(x - x_{i})$, where $\\bar{u}_{i}$ is the cell average and $s_{i}$ is the slope.\n-   A monotonicity constraint is imposed: the reconstructed interfacial values $p_{i}(x_{i\\pm\\frac{1}{2}}) = \\bar{u}_{i} \\pm \\frac{h}{2}s_{i}$ must lie between neighboring cell averages.\n-   This constraint implies that the admissible slope must be sign-consistent with the one-sided discrete gradients, $(\\bar{u}_{i} - \\bar{u}_{i-1})/h$ and $(\\bar{u}_{i+1} - \\bar{u}_{i})/h$, and must not exceed their magnitudes.\n-   The specific numerical values for the computation are: $\\bar{u}_{i-1} = 1$, $\\bar{u}_{i} = 0.2$, $\\bar{u}_{i+1} = 0.3$.\n-   The local unconstrained slope estimate is $s_{i} = 0.9$.\n-   The limiter to be used is the classical minmod mechanism applied to the set $\\{s_{i}, (\\bar{u}_{i} - \\bar{u}_{i-1})/h, (\\bar{u}_{i+1} - \\bar{u}_{i})/h\\}$.\n\nStep 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, as it deals with standard slope-limiting techniques (specifically, a TVD-type limiter) for DG methods, which is a well-established area within numerical analysis for partial differential equations. The problem is well-posed, providing all necessary data and a clear objective. The terminology is precise and objective. There are no contradictions, missing data, or scientifically unsound premises. The problem is a standard exercise in the field of computational fluid dynamics and numerical methods.\n\nStep 3: Verdict and Action\nThe problem is deemed valid. A complete solution will be provided.\n\n**Derivation of the Limiting Rule**\n\nThe objective of a slope limiter in this context is to enforce a monotonicity principle, preventing the creation of new local extrema in the numerical solution, which is crucial for obtaining physically meaningful, non-oscillatory solutions to hyperbolic conservation laws. The problem statement provides the core constraints for the limited slope, which we will formalize.\n\nLet $s_i^\\ell$ denote the limited slope. The one-sided discrete gradients (or finite difference slopes) are defined as:\n-   Backward difference slope: $\\Delta_i^- = \\frac{\\bar{u}_{i} - \\bar{u}_{i-1}}{h}$\n-   Forward difference slope: $\\Delta_i^+ = \\frac{\\bar{u}_{i+1} - \\bar{u}_{i}}{h}$\n\nThe constraints on $s_i^\\ell$ are given as:\n1.  **Sign Consistency**: The slope $s_i^\\ell$ must have the same sign as both $\\Delta_i^-$ and $\\Delta_i^+$. This is only possible if $\\Delta_i^-$ and $\\Delta_i^+$ have the same sign. If their signs differ, which occurs at a local extremum (a peak or a trough), no non-zero slope can be sign-consistent with both. In this case, to prevent overshoot or undershoot, the reconstruction must be made constant, implying the slope must be zero. So, if $\\text{sign}(\\Delta_i^-) \\neq \\text{sign}(\\Delta_i^+)$, then $s_i^\\ell = 0$.\n2.  **Magnitude Constraint**: The magnitude of the slope must not exceed the magnitudes of the one-sided discrete gradients. This translates to $|s_i^\\ell| \\le |\\Delta_i^-|$ and $|s_i^\\ell| \\le |\\Delta_i^+|$. Combining these, we get $|s_i^\\ell| \\le \\min(|\\Delta_i^-|, |\\Delta_i^+|)$.\n\nThese conditions are precisely encapsulated by the minmod function, which is defined for a set of arguments $\\{a_1, a_2, \\dots, a_n\\}$ as:\n$$\n\\text{minmod}(a_1, a_2, \\dots, a_n) =\n\\begin{cases}\n\\min(a_1, \\dots, a_n) & \\text{if } a_j > 0 \\text{ for all } j \\\\\n\\max(a_1, \\dots, a_n) & \\text{if } a_j < 0 \\text{ for all } j \\\\\n0 & \\text{otherwise}\n\\end{cases}\n$$\nApplying this to the two discrete gradients, the maximum slope satisfying the monotonicity bounds derived from neighbors is $s'_{i} = \\text{minmod}(\\Delta_i^-, \\Delta_i^+)$.\n\nThe final step is to limit the original, unconstrained slope $s_{i}$. The principle of limiting is to modify the original slope as little as possible. The limited slope $s_i^\\ell$ must satisfy the monotonicity conditions derived above, while also not having a magnitude greater than the original slope, i.e., $|s_i^\\ell| \\le |s_i|$. This is achieved by including the original slope $s_i$ as an argument in the minmod function. The resulting limited slope is:\n$$ s_i^\\ell = \\text{minmod}(s_i, s'_{i}) = \\text{minmod}\\left(s_i, \\text{minmod}(\\Delta_i^-, \\Delta_i^+)\\right) $$\nBy the properties of the minmod function, this is equivalent to:\n$$ s_i^\\ell = \\text{minmod}(s_i, \\Delta_i^-, \\Delta_i^+) = \\text{minmod}\\left(s_i, \\frac{\\bar{u}_i - \\bar{u}_{i-1}}{h}, \\frac{\\bar{u}_{i+1} - \\bar{u}_i}{h}\\right) $$\nThis confirms the validity of the rule specified in the problem statement.\n\n**Application to the Specific Configuration**\n\nWe are asked to compute the limited slope $s_i^\\ell$ for the given data. The arguments for the minmod function are:\n1.  The unconstrained slope: $s_i = 0.9$.\n2.  The backward difference slope: $\\Delta_i^- = \\frac{\\bar{u}_i - \\bar{u}_{i-1}}{h} = \\frac{0.2 - 1}{h} = -\\frac{0.8}{h}$.\n3.  The forward difference slope: $\\Delta_i^+ = \\frac{\\bar{u}_{i+1} - \\bar{u}_i}{h} = \\frac{0.3 - 0.2}{h} = \\frac{0.1}{h}$.\n\nThe three arguments to the minmod function are $\\{0.9, -0.8/h, 0.1/h\\}$. We must determine their signs. Since $h>0$ is given:\n-   $s_i = 0.9$ is positive.\n-   $\\Delta_i^- = -0.8/h$ is negative.\n-   $\\Delta_i^+ = 0.1/h$ is positive.\n\nThe set of arguments $\\{0.9, -0.8/h, 0.1/h\\}$ contains both positive and negative values. According to the definition of the minmod function, if the arguments do not all have the same sign, the result is zero. This situation corresponds to cell $I_i$ being a local minimum ($\\bar{u}_i$ is less than both $\\bar{u}_{i-1}$ and $\\bar{u}_{i+1}$), and the limiter correctly flattens the reconstruction to a constant value ($\\bar{u}_{i}$) to prevent the creation of a new, non-physical minimum (undershoot).\n\nTherefore, the limited slope is:\n$$ s_i^\\ell = \\text{minmod}\\left(0.9, -\\frac{0.8}{h}, \\frac{0.1}{h}\\right) = 0 $$\nThe final value is independent of the mesh spacing $h$.",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "Building upon the principles of interior cell limiting, this practice addresses the critical task of applying limiters at domain boundaries. We will derive and apply consistent one-sided limiting strategies for inflow and outflow boundaries, which are essential for stable and accurate simulations. This exercise highlights how numerical methods must respect the physical direction of information flow, as dictated by the governing equation's characteristics. ",
            "id": "3362961",
            "problem": "Consider the linear scalar advection equation in one spatial dimension,\n$$\nu_{t} + a\\,u_{x} = 0,\n$$\nwith constant advection speed $a \\in \\mathbb{R}$, posed on a finite interval $[0,L]$ with appropriate boundary conditions at $x=0$ and $x=L$. Let a Discontinuous Galerkin (DG) method of polynomial degree one (piecewise linear) be used to approximate $u(x,t)$ on a uniform mesh with cell size $\\Delta x$, where the $i$-th cell is $I_{i} = [x_{i-\\frac{1}{2}},\\,x_{i+\\frac{1}{2}}]$ and has center $x_{i}$. The DG representation in each cell is taken as\n$$\nu_{h}(x)\\big|_{I_{i}} = \\bar{u}_{i} + s_{i}\\,(x - x_{i}),\n$$\nwhere $\\bar{u}_{i}$ is the cell average and $s_{i}$ is the cell slope prior to limiting. A Total Variation Diminishing (TVD) slope limiter acts on $s_{i}$ to prevent creation of new extrema. For interior cells, a classical choice is the minmod limiter acting on the set of local slopes and discrete gradients,\n$$\ns_{i}^{L} = \\operatorname{minmod}\\!\\left(s_{i},\\,D_{i}^{-},\\,D_{i}^{+}\\right),\n$$\nwhere\n$$\nD_{i}^{-} = \\frac{\\bar{u}_{i} - \\bar{u}_{i-1}}{\\Delta x}, \\qquad D_{i}^{+} = \\frac{\\bar{u}_{i+1} - \\bar{u}_{i}}{\\Delta x},\n$$\nand the minmod function is defined by\n$$\n\\operatorname{minmod}(z_{1},\\dots,z_{m}) =\n\\begin{cases}\n\\min\\{z_{1},\\dots,z_{m}\\}, & \\text{if } z_{j} > 0 \\text{ for all } j, \\\\[6pt]\n\\max\\{z_{1},\\dots,z_{m}\\}, & \\text{if } z_{j}  0 \\text{ for all } j, \\\\[6pt]\n0,  \\text{otherwise.}\n\\end{cases}\n$$\nAt boundary cells, fewer neighboring cell averages are available. Derive, from first principles based on characteristic inflow and outflow and upwind numerical fluxes, consistent one-sided discrete gradients for use in slope limiting at inflow and outflow boundaries:\n- For a left boundary at $x=0$ with $a  0$ (inflow), express $D_{0}^{-}$ in terms of the boundary state $g(t)$ and demonstrate its consistency with a smooth linear profile.\n- For a right boundary at $x=L$ with $a  0$ (outflow), justify that $D_{N-1}^{+}$ should not be used and provide a consistent one-sided limiting formula for $s_{N-1}^{L}$ based on available interior data.\n\nThen, with $a  0$ and the following numerical data at some fixed time:\n$$\n\\Delta x = 0.05 \\text{ m}, \\quad \\bar{u}_{N-2} = 1.25, \\quad \\bar{u}_{N-1} = 1.30, \\quad s_{N-1} = 3.5 \\text{ m}^{-1},\n$$\ncompute the limited slope $s_{N-1}^{L}$ for the rightmost boundary cell using your derived outflow one-sided limiter. Express the final slope in $\\text{m}^{-1}$. No rounding is necessary.",
            "solution": "The user wants me to analyze and solve a problem related to slope limiting for a Discontinuous Galerkin (DG) method on boundary cells.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n- **Governing Equation**: Linear scalar advection equation $u_{t} + a\\,u_{x} = 0$, with constant speed $a \\in \\mathbb{R}$.\n- **Domain**: One-dimensional interval $[0,L]$.\n- **Numerical Method**: Discontinuous Galerkin (DG) with piecewise linear polynomials ($p=1$).\n- **Mesh**: Uniform grid with cell size $\\Delta x$. The $i$-th cell is $I_{i} = [x_{i-\\frac{1}{2}},\\,x_{i+\\frac{1}{2}}]$ with center $x_{i}$.\n- **DG Solution Representation**: Within cell $I_i$, the solution is $u_{h}(x)\\big|_{I_{i}} = \\bar{u}_{i} + s_{i}\\,(x - x_{i})$, where $\\bar{u}_{i}$ is the cell average and $s_{i}$ is the (unlimited) slope.\n- **Slope Limiter (Interior)**: A Total Variation Diminishing (TVD) limiter of the form $s_{i}^{L} = \\operatorname{minmod}\\!\\left(s_{i},\\,D_{i}^{-},\\,D_{i}^{+}\\right)$.\n- **Discrete Gradients (Interior)**: $D_{i}^{-} = \\frac{\\bar{u}_{i} - \\bar{u}_{i-1}}{\\Delta x}$ and $D_{i}^{+} = \\frac{\\bar{u}_{i+1} - \\bar{u}_{i}}{\\Delta x}$.\n- **Minmod Function Definition**:\n$$\n\\operatorname{minmod}(z_{1},\\dots,z_{m}) =\n\\begin{cases}\n\\min\\{z_{1},\\dots,z_{m}\\},  \\text{if } z_{j} > 0 \\text{ for all } j,\\\\\n\\max\\{z_{1},\\dots,z_{m}\\},  \\text{if } z_{j}  0 \\text{ for all } j,\\\\\n0,  \\text{otherwise.}\n\\end{cases}\n$$\n- **Task 1 (Inflow Boundary)**: For the left boundary at $x=0$ (cell $I_0$) with $a  0$, derive an expression for $D_{0}^{-}$ using the boundary state $u(0,t) = g(t)$ and show its consistency.\n- **Task 2 (Outflow Boundary)**: For the right boundary at $x=L$ (cell $I_{N-1}$) with $a  0$, justify why $D_{N-1}^{+}$ should not be used and propose a consistent one-sided limiter for $s_{N-1}^{L}$.\n- **Task 3 (Calculation)**: Given $a  0$ and the data:\n  - $\\Delta x = 0.05 \\text{ m}$\n  - $\\bar{u}_{N-2} = 1.25$\n  - $\\bar{u}_{N-1} = 1.30$\n  - $s_{N-1} = 3.5 \\text{ m}^{-1}$\n  Calculate the limited slope $s_{N-1}^{L}$.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientific Grounding**: The problem is located within the well-established field of numerical methods for partial differential equations, specifically computational fluid dynamics. The advection equation, DG methods, and TVD slope limiters are standard topics. The problem is scientifically sound.\n- **Well-Posed**: The problem is well-posed. It requests specific derivations and a calculation based on a provided set of data and definitions. The questions are clear and have unique, derivable answers based on standard practices in the field.\n- **Objective**: The problem is stated using formal, objective mathematical language.\n- **Completeness and Consistency**: The problem is self-contained. It provides all necessary definitions (DG approximation, minmod function, discrete gradients) and data to perform the requested derivations and the final calculation. The physical setup ($a0$ corresponding to inflow at $x=0$ and outflow at $x=L$) is consistent with the theory of characteristics for the advection equation.\n- **Feasibility**: All given values are realistic for a numerical simulation. The tasks are standard exercises in a graduate-level numerical analysis course.\n\n**Step 3: Verdict and Action**\nThe problem is valid. It is a well-posed, scientifically sound problem in numerical analysis. I will proceed with the solution.\n\n### Solution\n\nThe problem requires the derivation of boundary treatments for a slope limiter in a DG context and a subsequent calculation. We will address each part in sequence.\n\n**Part 1: Inflow Boundary Condition (Left Boundary, $x=0$, $a0$)**\n\nFor the advection equation $u_t + a u_x = 0$ with $a0$, information propagates from left to right. At an inflow boundary such as $x=0$, the solution is determined by the prescribed boundary data, $u(0,t) = g(t)$. The numerical scheme must respect this flow of information.\n\nThe limiter for the first cell, $I_0 = [0, \\Delta x]$, requires the term $D_0^{-} = \\frac{\\bar{u}_{0} - \\bar{u}_{-1}}{\\Delta x}$. This involves the cell average $\\bar{u}_{-1}$ of a fictitious \"ghost\" cell $I_{-1} = [-\\Delta x, 0]$ outside the computational domain. The value of $\\bar{u}_{-1}$ must be defined in a way that is consistent with the boundary condition $g(t)$.\n\nA standard method to define this ghost cell average is to assume the solution profile extends smoothly across the boundary. Let us consider a linear profile $u(x) = c_1 x + c_0$ in the vicinity of the boundary.\nThe boundary condition at $x=0$ implies $u(0) = c_0 = g(t)$.\nThe cell average in $I_0$ (centered at $x_0 = \\frac{\\Delta x}{2}$) is:\n$$\n\\bar{u}_0 = \\frac{1}{\\Delta x} \\int_{0}^{\\Delta x} (c_1 x + c_0) \\,dx = \\frac{1}{\\Delta x} \\left[ c_1 \\frac{x^2}{2} + c_0 x \\right]_0^{\\Delta x} = c_1 \\frac{\\Delta x}{2} + c_0\n$$\nThe cell average in the hypothetical ghost cell $I_{-1}$ (centered at $x_{-1} = -\\frac{\\Delta x}{2}$) would be:\n$$\n\\bar{u}_{-1} = \\frac{1}{\\Delta x} \\int_{-\\Delta x}^{0} (c_1 x + c_0) \\,dx = \\frac{1}{\\Delta x} \\left[ c_1 \\frac{x^2}{2} + c_0 x \\right]_{-\\Delta x}^{0} = -c_1 \\frac{\\Delta x}{2} + c_0\n$$\nFrom the expression for $\\bar{u}_0$, we find $c_1 \\frac{\\Delta x}{2} = \\bar{u}_0 - c_0$. Substituting this into the expression for $\\bar{u}_{-1}$:\n$$\n\\bar{u}_{-1} = -(\\bar{u}_0 - c_0) + c_0 = 2c_0 - \\bar{u}_0\n$$\nSince $c_0 = g(t)$, we define the ghost cell average as $\\bar{u}_{-1} = 2g(t) - \\bar{u}_0$.\n\nNow we can write the expression for the one-sided discrete gradient $D_0^{-}$:\n$$\nD_0^{-} = \\frac{\\bar{u}_0 - \\bar{u}_{-1}}{\\Delta x} = \\frac{\\bar{u}_0 - (2g(t) - \\bar{u}_0)}{\\Delta x} = \\frac{2(\\bar{u}_0 - g(t))}{\\Delta x}\n$$\nTo demonstrate consistency, we check if this formula recovers the exact slope for a linear profile $u(x) = c_1 x + c_0$. For such a profile, $u_x = c_1$, $g(t) = c_0$, and $\\bar{u}_0 = c_1 \\frac{\\Delta x}{2} + c_0$. Substituting these into our derived formula:\n$$\nD_0^{-} = \\frac{2 \\left( \\left(c_1 \\frac{\\Delta x}{2} + c_0 \\right) - c_0 \\right)}{\\Delta x} = \\frac{2 \\left(c_1 \\frac{\\Delta x}{2} \\right)}{\\Delta x} = c_1\n$$\nThe formula correctly recovers the exact slope, demonstrating its consistency for linear profiles.\n\n**Part 2: Outflow Boundary Condition (Right Boundary, $x=L$, $a0$)**\n\nAt an outflow boundary, the characteristics are leaving the domain. The solution is determined by the information propagating from the interior. There is no physical basis for imposing an external boundary condition. Any numerical boundary condition must reflect this \"do no harm\" principle and use only data from within the domain (i.e., upstream).\n\nThe limiter for the rightmost cell, $I_{N-1}$, would nominally involve $D_{N-1}^{+} = \\frac{\\bar{u}_{N} - \\bar{u}_{N-1}}{\\Delta x}$. This requires the average $\\bar{u}_{N}$ of a ghost cell $I_N$ outside the domain at the outflow boundary. Since information flows out, there is no data from $x  L$ that should influence the solution inside $[0,L]$. Any choice for $\\bar{u}_N$ would be artificial and would incorrectly propagate information against the flow direction, contaminating the numerical solution. Therefore, the discrete gradient $D_{N-1}^{+}$ should not be used.\n\nTo obtain a consistent one-sided limiter, we must rely solely on available interior data. For cell $I_{N-1}$, the unlimited slope is $s_{N-1}$ and the only available, physically meaningful discrete gradient is the backward one, $D_{N-1}^{-} = \\frac{\\bar{u}_{N-1} - \\bar{u}_{N-2}}{\\Delta x}$. This uses data from cells $I_{N-1}$ and $I_{N-2}$, both of which are inside the domain.\n\nA consistent and standard choice for the limited slope at the outflow boundary is to apply the minmod function only to the available arguments that are based on interior data. This leads to the one-sided limiting formula:\n$$\ns_{N-1}^{L} = \\operatorname{minmod}\\!\\left(s_{N-1},\\, D_{N-1}^{-}\\right)\n$$\nThis ensures the limited slope does not introduce new oscillations by comparing it only with the trend from the upstream data.\n\n**Part 3: Calculation for the Outflow Cell**\n\nWe are asked to compute the limited slope $s_{N-1}^{L}$ for the rightmost cell given the following data:\n- $\\Delta x = 0.05 \\text{ m}$\n- $\\bar{u}_{N-2} = 1.25$\n- $\\bar{u}_{N-1} = 1.30$\n- $s_{N-1} = 3.5 \\text{ m}^{-1}$\n\nWe use the derived one-sided outflow limiter formula: $s_{N-1}^{L} = \\operatorname{minmod}(s_{N-1}, D_{N-1}^{-})$.\n\nFirst, we compute the backward discrete gradient $D_{N-1}^{-}$:\n$$\nD_{N-1}^{-} = \\frac{\\bar{u}_{N-1} - \\bar{u}_{N-2}}{\\Delta x} = \\frac{1.30 - 1.25}{0.05} = \\frac{0.05}{0.05} = 1.0 \\text{ m}^{-1}\n$$\nNow, we apply the minmod function to the arguments $z_1 = s_{N-1} = 3.5 \\text{ m}^{-1}$ and $z_2 = D_{N-1}^{-} = 1.0 \\text{ m}^{-1}$.\n$$\ns_{N-1}^{L} = \\operatorname{minmod}(3.5, 1.0)\n$$\nSince both arguments ($3.5$ and $1.0$) are positive, the minmod function returns their minimum value:\n$$\n\\operatorname{minmod}(3.5, 1.0) = \\min\\{3.5, 1.0\\} = 1.0\n$$\nThus, the limited slope for the rightmost boundary cell is $s_{N-1}^{L} = 1.0 \\text{ m}^{-1}$.",
            "answer": "$$\n\\boxed{1.0}\n$$"
        },
        {
            "introduction": "This final practice extends the concept of slope limiting to a more realistic and challenging scenario: a two-dimensional simulation on a non-uniform, stretched mesh. You will learn how to correctly transform gradients between the computational reference element and the physical domain using the mapping Jacobian. This exercise demonstrates how to design a metric-aware limiter that accounts for geometric complexities to ensure robustness and accuracy in practical CFD applications. ",
            "id": "3362937",
            "problem": "Consider a two-dimensional scalar conservation law discretized by the Discontinuous Galerkin (DG) method of polynomial degree $p=1$ on a nonuniform, stretched quadrilateral mesh in computational fluid dynamics. On a given cell, the reference element is the square with coordinates $(\\xi,\\eta)\\in[-1,1]^2$, and the physical mapping is affine, defined by\n$$\n\\begin{pmatrix}\nx \\\\\ny\n\\end{pmatrix}\n=\n\\begin{pmatrix}\nx_c \\\\\ny_c\n\\end{pmatrix}\n+\nJ\n\\begin{pmatrix}\n\\xi \\\\\n\\eta\n\\end{pmatrix},\\quad\nJ=\n\\begin{pmatrix}\n\\frac{h_x}{2}  s \\\\\n0  \\frac{h_y}{2}\n\\end{pmatrix},\n$$\nwith $h_x=\\frac{3}{10}$, $h_y=3$, and $s=\\frac{3}{10}$. The DG solution on the reference element is\n$$\nu(\\xi,\\eta) = a_0 + a_1\\,\\xi + a_2\\,\\eta,\n$$\nwith coefficients $a_0=\\frac{6}{5}$, $a_1=\\frac{4}{5}$, and $a_2=\\frac{3}{2}$.\n\nA slope limiter is to be designed such that the linear reconstruction does not create new extrema across each face. The fundamental monotonicity requirement is that, for the value predicted at the center of a face by the linear reconstruction,\n$$\nu_{\\text{pred},f} = \\bar{u} + \\theta\\,\\nabla_{x} u \\cdot \\boldsymbol{r}_f,\n$$\nwhere $\\bar{u}$ is the cell average, $\\nabla_{x} u$ is the physical gradient, $\\boldsymbol{r}_f$ is the physical vector from the cell centroid to the face centroid, and $\\theta\\in[0,1]$ is a limiter parameter, the predicted value must lie in the range spanned by the two cell averages sharing that face. This limiter must account for the metric $J$ so that the stretched direction is not over-limited.\n\nYou are given the neighbor cell averages for the four faces of the cell: left neighbor $u_L=\\frac{9}{10}$, right neighbor $u_R=\\frac{12}{5}$, bottom neighbor $u_B=\\frac{3}{10}$, and top neighbor $u_T=\\frac{27}{10}$.\n\nStarting from first principles:\n1. Use the chain rule to express the physical gradient $\\nabla_{x} u$ in terms of the reference gradient $\\nabla_{\\xi} u$ and the mapping Jacobian $J$, and then compute $\\nabla_x u$ for the given $J$ and $(a_1,a_2)$.\n2. Derive a face-based expression for $\\theta$ that enforces the monotonicity requirement on each face using the metric-aware face-center increments $\\delta u_f = \\nabla_{x} u \\cdot \\boldsymbol{r}_f$. Show explicitly how metric scaling enters, and evaluate $\\delta u_f$ for each face in terms of $(a_1,a_2)$ and $J$. Then determine the admissible $\\theta$ from each face and take the minimum over all faces.\n\nProvide the final value of the limiter parameter $\\theta$ for this cell. The final answer must be a single real number. No rounding is required.",
            "solution": "The user has provided a well-posed problem in computational fluid dynamics, specifically concerning the application of a slope limiter for a Discontinuous Galerkin (DG) method on a stretched quadrilateral cell. The problem is scientifically grounded, internally consistent, and contains all necessary data for a unique solution. The validation process concludes that the problem is valid.\n\nThe objective is to compute the limiter parameter $\\theta$ for the given cell. This requires two main steps: first, computing the physical gradient $\\nabla_x u$ of the solution, and second, using this gradient to derive and evaluate the admissible limiter parameter for each face, ultimately finding the minimum value for the cell.\n\nFirst, we establish the cell-average value of the solution. For a DG method with a polynomial basis that includes a constant term, the cell-average value $\\bar{u}$ is simply the coefficient of the constant basis function. In this case, the basis on the reference element is $\\{1, \\xi, \\eta\\}$, and the solution is $u(\\xi, \\eta) = a_0 + a_1\\xi + a_2\\eta$. The cell average $\\bar{u}$ is therefore the coefficient $a_0$.\nGiven $a_0 = \\frac{6}{5}$, we have:\n$$\n\\bar{u} = \\frac{6}{5}\n$$\n\n**1. Computation of the Physical Gradient $\\nabla_x u$**\n\nThe physical gradient $\\nabla_x u = \\begin{pmatrix} \\partial u / \\partial x \\\\ \\partial u / \\partial y \\end{pmatrix}$ is related to the reference gradient $\\nabla_{\\xi} u = \\begin{pmatrix} \\partial u / \\partial \\xi \\\\ \\partial u / \\partial \\eta \\end{pmatrix}$ via the chain rule, which involves the Jacobian matrix $J$ of the mapping from reference coordinates $\\boldsymbol{\\xi} = (\\xi, \\eta)^T$ to physical coordinates $\\boldsymbol{x} = (x, y)^T$. The relation is:\n$$\n\\nabla_{\\xi} u = J^T \\nabla_x u\n$$\nTo find the physical gradient, we must invert this relationship:\n$$\n\\nabla_x u = (J^T)^{-1} \\nabla_{\\xi} u = (J^{-1})^T \\nabla_{\\xi} u\n$$\nFirst, we compute the reference gradient from the given solution polynomial $u(\\xi, \\eta) = a_0 + a_1\\xi + a_2\\eta$. The coefficients are given as $a_1=\\frac{4}{5}$ and $a_2=\\frac{3}{2}$.\n$$\n\\nabla_{\\xi} u = \\begin{pmatrix} \\frac{\\partial u}{\\partial \\xi} \\\\ \\frac{\\partial u}{\\partial \\eta} \\end{pmatrix} = \\begin{pmatrix} a_1 \\\\ a_2 \\end{pmatrix} = \\begin{pmatrix} \\frac{4}{5} \\\\ \\frac{3}{2} \\end{pmatrix}\n$$\nNext, we evaluate the Jacobian matrix $J$ using the provided geometric parameters $h_x=\\frac{3}{10}$, $h_y=3$, and $s=\\frac{3}{10}$:\n$$\nJ = \\begin{pmatrix} \\frac{h_x}{2}  s \\\\ 0  \\frac{h_y}{2} \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{2}(\\frac{3}{10})  \\frac{3}{10} \\\\ 0  \\frac{1}{2}(3) \\end{pmatrix} = \\begin{pmatrix} \\frac{3}{20}  \\frac{3}{10} \\\\ 0  \\frac{3}{2} \\end{pmatrix}\n$$\nWe then compute the inverse of $J$. The determinant is $\\det(J) = (\\frac{3}{20})(\\frac{3}{2}) - (0)(\\frac{3}{10}) = \\frac{9}{40}$.\n$$\nJ^{-1} = \\frac{1}{\\det(J)} \\begin{pmatrix} \\frac{3}{2}  -\\frac{3}{10} \\\\ 0  \\frac{3}{20} \\end{pmatrix} = \\frac{40}{9} \\begin{pmatrix} \\frac{3}{2}  -\\frac{3}{10} \\\\ 0  \\frac{3}{20} \\end{pmatrix} = \\begin{pmatrix} \\frac{40 \\cdot 3}{9 \\cdot 2}  -\\frac{40 \\cdot 3}{9 \\cdot 10} \\\\ 0  \\frac{40 \\cdot 3}{9 \\cdot 20} \\end{pmatrix} = \\begin{pmatrix} \\frac{20}{3}  -\\frac{4}{3} \\\\ 0  \\frac{2}{3} \\end{pmatrix}\n$$\nNow we find the physical gradient $\\nabla_x u$:\n$$\n\\nabla_x u = (J^{-1})^T \\nabla_{\\xi} u = \\begin{pmatrix} \\frac{20}{3}  0 \\\\ -\\frac{4}{3}  \\frac{2}{3} \\end{pmatrix} \\begin{pmatrix} \\frac{4}{5} \\\\ \\frac{3}{2} \\end{pmatrix} = \\begin{pmatrix} (\\frac{20}{3})(\\frac{4}{5}) + (0)(\\frac{3}{2}) \\\\ (-\\frac{4}{3})(\\frac{4}{5}) + (\\frac{2}{3})(\\frac{3}{2}) \\end{pmatrix} = \\begin{pmatrix} \\frac{16}{3} \\\\ -\\frac{16}{15} + 1 \\end{pmatrix} = \\begin{pmatrix} \\frac{16}{3} \\\\ -\\frac{1}{15} \\end{pmatrix}\n$$\n\n**2. Derivation and Evaluation of the Limiter Parameter $\\theta$**\n\nThe monotonicity requirement states that the predicted solution value at a face centroid, $u_{\\text{pred},f} = \\bar{u} + \\theta \\, \\delta u_f$, where $\\delta u_f = \\nabla_x u \\cdot \\boldsymbol{r}_f$, must lie within the range defined by the cell's own average $\\bar{u}$ and its neighbor's average $\\bar{u}_f$. Let $\\Delta u_f = \\bar{u}_f - \\bar{u}$. The condition is $\\min(\\bar{u}, \\bar{u}_f) \\le \\bar{u} + \\theta \\, \\delta u_f \\le \\max(\\bar{u}, \\bar{u}_f)$.\n\nThis leads to a limiter $\\theta_f$ for each face, which can be defined as:\n$$\n\\theta_f =\n\\begin{cases}\n    \\min\\left(1, \\frac{\\Delta u_f}{\\delta u_f}\\right)  \\text{if } \\Delta u_f \\cdot \\delta u_f  0 \\\\\n    0  \\text{if } \\Delta u_f \\cdot \\delta u_f \\le 0 \\text{ and } \\delta u_f \\ne 0 \\\\\n    1  \\text{if } \\delta u_f = 0\n\\end{cases}\n$$\nThe overall limiter for the cell is then $\\theta = \\min(\\theta_L, \\theta_R, \\theta_B, \\theta_T)$.\n\nWe must first compute the \"metric-aware\" increments $\\delta u_f$. This requires the physical vectors $\\boldsymbol{r}_f$ from the cell centroid to the face centroids. These are found by mapping the reference face centroids $\\boldsymbol{\\xi}_f$ using $J$. The reference centroids are $\\boldsymbol{\\xi}_L=(-1,0)^T$, $\\boldsymbol{\\xi}_R=(1,0)^T$, $\\boldsymbol{\\xi}_B=(0,-1)^T$, and $\\boldsymbol{\\xi}_T=(0,1)^T$.\nThe physical vectors are $\\boldsymbol{r}_f = J \\boldsymbol{\\xi}_f$:\n- Left face (L): $\\boldsymbol{r}_L = \\begin{pmatrix} \\frac{3}{20}  \\frac{3}{10} \\\\ 0  \\frac{3}{2} \\end{pmatrix}\\begin{pmatrix} -1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} -\\frac{3}{20} \\\\ 0 \\end{pmatrix}$\n- Right face (R): $\\boldsymbol{r}_R = \\begin{pmatrix} \\frac{3}{20}  \\frac{3}{10} \\\\ 0  \\frac{3}{2} \\end{pmatrix}\\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} \\frac{3}{20} \\\\ 0 \\end{pmatrix}$\n- Bottom face (B): $\\boldsymbol{r}_B = \\begin{pmatrix} \\frac{3}{20}  \\frac{3}{10} \\\\ 0  \\frac{3}{2} \\end{pmatrix}\\begin{pmatrix} 0 \\\\ -1 \\end{pmatrix} = \\begin{pmatrix} -\\frac{3}{10} \\\\ -\\frac{3}{2} \\end{pmatrix}$\n- Top face (T): $\\boldsymbol{r}_T = \\begin{pmatrix} \\frac{3}{20}  \\frac{3}{10} \\\\ 0  \\frac{3}{2} \\end{pmatrix}\\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} \\frac{3}{10} \\\\ \\frac{3}{2} \\end{pmatrix}$\n\nNow, we compute the increments $\\delta u_f = \\nabla_x u \\cdot \\boldsymbol{r}_f$:\n- $\\delta u_L = \\begin{pmatrix} \\frac{16}{3} \\\\ -\\frac{1}{15} \\end{pmatrix} \\cdot \\begin{pmatrix} -\\frac{3}{20} \\\\ 0 \\end{pmatrix} = (\\frac{16}{3})(-\\frac{3}{20}) = -\\frac{16}{20} = -\\frac{4}{5}$\n- $\\delta u_R = \\begin{pmatrix} \\frac{16}{3} \\\\ -\\frac{1}{15} \\end{pmatrix} \\cdot \\begin{pmatrix} \\frac{3}{20} \\\\ 0 \\end{pmatrix} = (\\frac{16}{3})(\\frac{3}{20}) = \\frac{16}{20} = \\frac{4}{5}$\n- $\\delta u_B = \\begin{pmatrix} \\frac{16}{3} \\\\ -\\frac{1}{15} \\end{pmatrix} \\cdot \\begin{pmatrix} -\\frac{3}{10} \\\\ -\\frac{3}{2} \\end{pmatrix} = (\\frac{16}{3})(-\\frac{3}{10}) + (-\\frac{1}{15})(-\\frac{3}{2}) = -\\frac{16}{10} + \\frac{3}{30} = -\\frac{16}{10} + \\frac{1}{10} = -\\frac{15}{10} = -\\frac{3}{2}$\n- $\\delta u_T = \\begin{pmatrix} \\frac{16}{3} \\\\ -\\frac{1}{15} \\end{pmatrix} \\cdot \\begin{pmatrix} \\frac{3}{10} \\\\ \\frac{3}{2} \\end{pmatrix} = (\\frac{16}{3})(\\frac{3}{10}) + (-\\frac{1}{15})(\\frac{3}{2}) = \\frac{16}{10} - \\frac{3}{30} = \\frac{16}{10} - \\frac{1}{10} = \\frac{15}{10} = \\frac{3}{2}$\n\nNext, we compute the difference with neighbor averages, $\\Delta u_f = \\bar{u}_f - \\bar{u}$. Given $\\bar{u} = \\frac{6}{5}$ and neighbor averages $u_L=\\frac{9}{10}$, $u_R=\\frac{12}{5}$, $u_B=\\frac{3}{10}$, $u_T=\\frac{27}{10}$:\n- $\\Delta u_L = \\frac{9}{10} - \\frac{6}{5} = \\frac{9-12}{10} = -\\frac{3}{10}$\n- $\\Delta u_R = \\frac{12}{5} - \\frac{6}{5} = \\frac{6}{5}$\n- $\\Delta u_B = \\frac{3}{10} - \\frac{6}{5} = \\frac{3-12}{10} = -\\frac{9}{10}$\n- $\\Delta u_T = \\frac{27}{10} - \\frac{6}{5} = \\frac{27-12}{10} = \\frac{15}{10} = \\frac{3}{2}$\n\nFinally, we compute $\\theta_f$ for each face:\n- Face L: $\\delta u_L = -\\frac{4}{5}$, $\\Delta u_L = -\\frac{3}{10}$. Since $\\Delta u_L \\cdot \\delta u_L  0$:\n  $\\theta_L = \\min\\left(1, \\frac{-3/10}{-4/5}\\right) = \\min\\left(1, \\frac{3}{10} \\cdot \\frac{5}{4}\\right) = \\min\\left(1, \\frac{15}{40}\\right) = \\min\\left(1, \\frac{3}{8}\\right) = \\frac{3}{8}$.\n- Face R: $\\delta u_R = \\frac{4}{5}$, $\\Delta u_R = \\frac{6}{5}$. Since $\\Delta u_R \\cdot \\delta u_R  0$:\n  $\\theta_R = \\min\\left(1, \\frac{6/5}{4/5}\\right) = \\min\\left(1, \\frac{6}{4}\\right) = \\min\\left(1, \\frac{3}{2}\\right) = 1$.\n- Face B: $\\delta u_B = -\\frac{3}{2}$, $\\Delta u_B = -\\frac{9}{10}$. Since $\\Delta u_B \\cdot \\delta u_B  0$:\n  $\\theta_B = \\min\\left(1, \\frac{-9/10}{-3/2}\\right) = \\min\\left(1, \\frac{9}{10} \\cdot \\frac{2}{3}\\right) = \\min\\left(1, \\frac{18}{30}\\right) = \\min\\left(1, \\frac{3}{5}\\right) = \\frac{3}{5}$.\n- Face T: $\\delta u_T = \\frac{3}{2}$, $\\Delta u_T = \\frac{3}{2}$. Since $\\Delta u_T \\cdot \\delta u_T  0$:\n  $\\theta_T = \\min\\left(1, \\frac{3/2}{3/2}\\right) = \\min(1, 1) = 1$.\n\nThe final limiter parameter $\\theta$ for the cell is the minimum of the face-based values:\n$$\n\\theta = \\min(\\theta_L, \\theta_R, \\theta_B, \\theta_T) = \\min\\left(\\frac{3}{8}, 1, \\frac{3}{5}, 1\\right)\n$$\nTo find the minimum, we compare $\\frac{3}{8}$ and $\\frac{3}{5}$. With a common denominator of $40$, we have $\\frac{3}{8} = \\frac{15}{40}$ and $\\frac{3}{5} = \\frac{24}{40}$. Thus, $\\frac{3}{8}$ is the smaller value.\n$$\n\\theta = \\frac{3}{8}\n$$",
            "answer": "$$\\boxed{\\frac{3}{8}}$$"
        }
    ]
}