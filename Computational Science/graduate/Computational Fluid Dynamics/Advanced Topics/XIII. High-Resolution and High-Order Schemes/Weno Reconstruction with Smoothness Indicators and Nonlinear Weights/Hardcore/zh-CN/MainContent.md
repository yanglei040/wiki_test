## 引言
在[计算流体力学](@entry_id:747620)及其他科学与工程领域，准确模拟包含激波、[接触间断](@entry_id:194702)等不连续性的[复杂流动](@entry_id:747569)现象，是求解[双曲守恒律](@entry_id:147752)方程时面临的核心挑战。传统的[高阶数值方法](@entry_id:142601)在间断附近容易产生非物理的[吉布斯振荡](@entry_id:749902)，而低阶方法虽然稳定，却会过度耗散掉流场的精细结构。为了同时实现[高阶精度](@entry_id:750325)和非[振荡](@entry_id:267781)性，[加权基本不振荡](@entry_id:756683)（WENO）重构应运而生，成为现代计算科学中一种功能强大且应用广泛的数值技术。

本文旨在深入剖析[WENO重构](@entry_id:756703)的内在机理与应用[范式](@entry_id:161181)。我们将从其基本思想出发，逐步揭示其成功的奥秘。在“原理与机制”一章中，您将学习WENO如何通过精巧设计的光滑度指示子和[非线性权重](@entry_id:752658)，在光滑与非光滑区域之间进行自适应切换，从而兼顾精度与稳定性。接着，在“应用与交叉学科联系”一章中，我们将展示WENO框架如何从简单的标量问题扩展到复杂的[欧拉方程组](@entry_id:143098)，如何与[曲线网格](@entry_id:748122)及[自适应网格](@entry_id:164379)（AMR）等先进计算框架集成，并探讨其在处理含[源项](@entry_id:269111)方程和保证物理解时的改进策略。最后，通过一系列“动手实践”的练习，您将有机会将理论知识付诸实践，加深对WENO方法核心概念的理解。

## 原理与机制

在上一章中，我们介绍了求解[双曲守恒律](@entry_id:147752)的[高阶数值方法](@entry_id:142601)的基本需求。本章将深入探讨一种强大的技术——[加权基本不振荡](@entry_id:756683)（WENO）重构——的原理与机制。我们将从其在[有限体积法](@entry_id:749372)中的作用开始，逐步剖析其核心思想，详细阐述其数学构造，并讨论其在[复杂流动](@entry_id:747569)问题中的应用与改进。

### 在[有限体积法](@entry_id:749372)中的作用：为何需要重构？

我们从一维[标量守恒律](@entry_id:754532)的半离散有限体积格式出发：
$$
\frac{d\bar{u}_i}{dt} = - \frac{1}{\Delta x} \left( \hat{f}_{i+1/2} - \hat{f}_{i-1/2} \right)
$$
其中，$\bar{u}_i$ 是单元 $I_i = [x_{i-1/2}, x_{i+1/2}]$ 上的解的平均值，而 $\hat{f}_{i+1/2}$ 是通过单元交界面 $x_{i+1/2}$ 的数值通量。这种形式天然满足守恒性，因为离开一个单元的通量就是进入相邻单元的通量。

数值通量的计算是该方法的核心。为了稳定地处理可能出现的间断（如激波）并尊重信息的物理传播方向（即[迎风原理](@entry_id:756377)），[数值通量](@entry_id:752791)通常由一个[黎曼求解器](@entry_id:754362) $\mathcal{F}$ 计算。[黎曼求解器](@entry_id:754362)需要该交界面左右两侧的状态作为输入：
$$
\hat{f}_{i+1/2} = \mathcal{F}(u_{i+1/2}^{-}, u_{i+1/2}^{+})
$$
这里的 $u_{i+1/2}^{-}$ 和 $u_{i+1/2}^{+}$ 分别是解在交界面 $x_{i+1/2}$ 处的[左极限](@entry_id:139055)和[右极限](@entry_id:140515)的点值。然而，在有限体积法中，我们唯一已知的数据是在时间 $t^n$ 时的一系列单元平均值 $\{\bar{u}_j(t^n)\}$。

因此，核心挑战在于：如何从离散的、低阶的单元平均值信息中，精确地“重构”出单元交界面处高阶精确的点值？这正是**重构**（reconstruction）步骤的由来。WENO 就是一种先进的重构方法。

重构的阶数直接决定了整个数值格式的空间精度。假设我们采用一个 $p$ 阶的重构方法，在解的光滑区域，这意味着我们得到的交界面值与真实值的误差为 $p$ 阶：
$$
u_{i\pm 1/2}^\mp = u(x_{i\pm 1/2}, t^n) + \mathcal{O}(\Delta x^p)
$$
由于[数值通量](@entry_id:752791)函数 $\mathcal{F}$ 是相容的（即 $\mathcal{F}(v,v) = f(v)$）且连续的，重构值的精度直接传递给了数值通量：
$$
\hat{f}_{i\pm 1/2} = f(u(x_{i\pm 1/2}, t^n)) + \mathcal{O}(\Delta x^p)
$$
这使得空间离散算子的[截断误差](@entry_id:140949)为 $\mathcal{O}(\Delta x^{p-1})$，而整个[半离散格式](@entry_id:165671)的精度为 $\mathcal{O}(\Delta x^p)$。当与一个 $q$ 阶的[时间积分方法](@entry_id:136323)（如[龙格-库塔法](@entry_id:140014)）结合使用时，整个全离散格式的最终精度将为 $\min\{p,q\}$。因此，为了实现一个整体高阶的格式，高阶的空间重构是必不可少的。

### 从ENO到WENO：核心思想的演进

直接使用一个包含多个点的高阶多项式进行重构，在解包含间断时会引发灾难性的吉布斯（Gibbs）[振荡](@entry_id:267781)。为了解决这个问题，**基本不[振荡](@entry_id:267781)（ENO）**格式被提了出来。

ENO的核心思想是**自适应模板选择**。对于每个需要重构的交界面，我们准备多个候选的重构模板（stencil），每个模板都由一组相邻的单元组成。然后，通过一个判据来评估哪个模板上的解“最光滑”，并**只选用**这个最[光滑模](@entry_id:752104)板上的多项式进行重构。通过这种方式，ENO格式巧妙地避免了在插值模板中跨越间断，从而抑制了[振荡](@entry_id:267781)。

然而，ENO格式存在两个主要缺点：首先，模板的切换可能不够平滑，会在光滑区域引入微小的数值噪声；其次，它没有充分利用所有可用信息。例如，一个三阶ENO格式在所有候选模板都光滑时，也只使用其中一个模板，其精度固定为三阶，而不能达到更高。

**[加权基本不振荡](@entry_id:756683)（WENO）**格式正是为了克服这些缺点而设计的。WENO不再是“非此即彼”地选择一个模板，而是对所有候选模板上的多项式进行**加权平均**。其关键创新在于，这些权重是**[非线性](@entry_id:637147)**的，并根据每个模板的光滑程度动态调整：

*   在解的光滑区域，所有候选模板都同样光滑。WENO设计的权重会趋向于一组“最优权重”，使得加权组合得到的重构多项式达到比任何单个候选多项式都高的精度（例如，对于WENO5，组合三个二次多项式可以得到五阶精度）。
*   在解的间断附近，包含间断的模板会变得非常“不光滑”。WENO的权重机制会自动赋予这些模板极小的权重（趋近于零），而将权重集中在那些不包含间断的[光滑模](@entry_id:752104)板上。在这种情况下，[WENO格式](@entry_id:145935)自动退化为ENO格式的行为，从而有效地抑制了[振荡](@entry_id:267781)。

通过这种方式，WENO巧妙地结合了[高阶精度](@entry_id:750325)和无[振荡](@entry_id:267781)两个优点，成为现代[计算流体力学](@entry_id:747620)中捕捉激波和[复杂流动](@entry_id:747569)结构的主流方法之一。

### WENO机制剖析：光滑度指示子与[非线性权重](@entry_id:752658)

为了具体理解WENO的工作机制，我们以最经典和广泛使用的五阶[WENO格式](@entry_id:145935)（WENO5-JS，由Jiang和Shu提出）为例。假设我们要从单元平均值 $\{\bar{u}_j\}$ 重构交界面 $x_{i+1/2}$ 的左侧值 $u_{i+1/2}^{-}$。

**1. 候选多项式**

WENO5使用三个候选的二次多项式 ($r-1=2, r=3$)。这三个多项式分别构建在三个不同的、包含三个点的重叠子模板上：
*   $S_0 = \{I_{i-2}, I_{i-1}, I_i\}$
*   $S_1 = \{I_{i-1}, I_i, I_{i+1}\}$
*   $S_2 = \{I_i, I_{i+1}, I_{i+2}\}$

对于每个[子模](@entry_id:148922)板 $S_k$，我们都可以构建一个唯一的二次多项式 $p_k(x)$，使其在模板内各个单元上的积分为已知的单元平均值。对这些多项式在交界面 $x_{i+1/2}$ 处求值，我们得到三个三阶精度的候选重构值 $u_{i+1/2}^{(k)}$。例如，在均匀网格上，若我们用点值 $u_j$ 代替单元平均值 $\bar{u}_j$ (这在有限差分框架下是直接的)，这些候选值为：
$$
\begin{align*}
u_{i+1/2}^{(0)} = \frac{1}{3}u_{i-2} - \frac{7}{6}u_{i-1} + \frac{11}{6}u_i \\
u_{i+1/2}^{(1)} = -\frac{1}{6}u_{i-1} + \frac{5}{6}u_i + \frac{1}{3}u_{i+1} \\
u_{i+1/2}^{(2)} = \frac{1}{3}u_i + \frac{5}{6}u_{i+1} - \frac{1}{6}u_{i+2}
\end{align*}
$$
最终的[WENO重构](@entry_id:756703)值是这三个候选值的凸组合：
$$
u_{i+1/2}^- = \sum_{k=0}^{2} \omega_k u_{i+1/2}^{(k)}
$$
其中 $\omega_k$ 就是[非线性权重](@entry_id:752658)。

**2. 光滑度指示子 $\beta_k$**

为了确定权重，我们首先需要一种量化每个候选模板“光滑度”的方法。这通过**光滑度指示子（smoothness indicators）** $\beta_k$ 实现。一个自然的想法是，函数越光滑，其导数越小。因此，$\beta_k$ 被定义为候选多项式 $p_k(x)$ 的各阶导数的平方在目标单元上的积分之和，并进行了适当的尺度缩放：
$$
\beta_k = \sum_{\ell=1}^{2} \int_{x_{i-1/2}}^{x_{i+1/2}} \Delta x^{2\ell - 1} \left( \frac{d^\ell p_k(x)}{dx^\ell} \right)^2 dx
$$
这个定义本质上是 $p_k(x)$ 在单元 $I_i$ 内导数的 $L^2$ 范数的加权和。如果一个模板上的函数接近常数或线性，其导数很小，$\beta_k$ 的值也就很小。如果模板跨越了一个间断，那么 $p_k(x)$ 将会剧烈变化，其导数值会很大，导致 $\beta_k$ 变得很大。

对于WENO5，将上述积分定义应用到每个二次多项式上，可以推导出 $\beta_k$ 关于网格点值的具体离散表达式。例如，在均匀网格上，这些表达式为：
$$
\begin{align*}
\beta_0 = \frac{13}{12}(u_{i-2} - 2u_{i-1} + u_i)^2 + \frac{1}{4}(u_{i-2} - 4u_{i-1} + 3u_i)^2 \\
\beta_1 = \frac{13}{12}(u_{i-1} - 2u_i + u_{i+1})^2 + \frac{1}{4}(u_{i-1} - u_{i+1})^2 \\
\beta_2 = \frac{13}{12}(u_i - 2u_{i+1} + u_{i+2})^2 + \frac{1}{4}(3u_i - 4u_{i+1} + u_{i+2})^2
\end{align*}
$$
这些表达式中的差分项分别近似于解的二阶和一阶导数，这再次印证了 $\beta_k$ 是对局部函数变化剧烈程度的度量。

**3. [非线性权重](@entry_id:752658) $\omega_k$**

有了光滑度指示子 $\beta_k$，我们就可以构造[非线性权重](@entry_id:752658) $\omega_k$。WENO-JS格式的权重构造分为两步：
$$
\alpha_k = \frac{d_k}{(\varepsilon + \beta_k)^p}, \quad \omega_k = \frac{\alpha_k}{\sum_{j=0}^{2} \alpha_j}
$$
这里面的每个参数都有其明确的物理和数学意义：

*   **理想权重 $d_k$**（或写作 $\gamma_k$）：这些是预先计算好的常数，用于在光滑区域实现最高精度。对于WENO5的左偏重构，它们是 $d_0=0.1, d_1=0.6, d_2=0.3$。可以证明，当权重精确等于这些值时，三个三阶精度的候选值组合在一起，其低阶误差项会相互抵消，从而得到一个五阶精度的重构。这些理想权重是WENO实现[高阶精度](@entry_id:750325)的关键。

*   **光滑度指示子 $\beta_k$**: 如前所述，它是权重公式的核心。当模板 $k$ 包含间断时，$\beta_k$ 会变得很大（$\mathcal{O}(1)$），这使得分母变得极大，从而 $\alpha_k$ 和 $\omega_k$ 趋近于零。这就实现了对不[光滑模](@entry_id:752104)板的“惩罚”，将其从重构中排除。

*   **指数 $p$**: 这个参数控制了对不[光滑模](@entry_id:752104)板的惩罚力度。$p$ 值越大，$\omega_k$ 对 $\beta_k$ 的变化就越敏感。对于较大的 $\beta_k$ 值，更大的 $p$ 会更迅速地将其权重压低到零。在WENO5-JS中，通常取 $p=2$。

*   **正则化参数 $\varepsilon$**: 这是一个很小的正常数（例如 $10^{-6}$）。它的主要作用是防止分母为零。当解在某个模板上是完美的线性函数时，其对应的 $\beta_k$ 可能精确为零。如果没有 $\varepsilon$，将会导致除零错误。此外，它对处理[临界点](@entry_id:144653)处的精度下降问题也有微妙的影响。

总结来说，WENO的整个机制就像一个精密的自适应系统：利用 $\beta_k$ “感知”流场的局部光滑度，然后通过[非线性权重](@entry_id:752658)公式“决策”，在光滑区域组合所有信息以达到最高精度，在间断区域则果断放弃污染信息以保证[数值稳定性](@entry_id:146550)。

### 针对一般守恒律的应用

上述机制是针对标量函数重构的。要将其应用于求解一般的[守恒律方程组](@entry_id:755768)，还需要考虑两个关键问题：[迎风](@entry_id:756372)特性和多物理波的耦合。

**1. [通量分裂](@entry_id:637102)与[迎风](@entry_id:756372)思想**

[WENO重构](@entry_id:756703)本身是带有偏[向性](@entry_id:144651)的（例如，我们上面讨论的是左偏重构）。这种偏[向性](@entry_id:144651)必须与[物理信息](@entry_id:152556)的传播方向相匹配，即满足[迎风原理](@entry_id:756377)。对于[标量守恒律](@entry_id:754532) $u_t + f(u)_x = 0$，信息传播的速度由特征速度 $a(u) = f'(u)$ 决定。

*   如果 $a(u) > 0$，信息从左向右传播，我们应该使用左偏模板（如上述的 $u_{i+1/2}^{-}$ 重构）。
*   如果 $a(u)  0$，信息从右向左传播，我们应该使用[右偏](@entry_id:180351)模板。

对于一般的[非线性](@entry_id:637147)问题（例如[Burgers方程](@entry_id:177995)），[特征速度](@entry_id:165394) $f'(u)$ 的符号可能随解 $u$ 的变化而变化。在一个计算区域内，可能同时存在正向和负向传播的波。在这种情况下，我们不能对物理通量 $f(u)$ 本身使用单一偏向的重构。

解决方案是**[通量分裂](@entry_id:637102)（flux splitting）**。我们将物理通量 $f(u)$ 分解为两部分：$f(u) = f^+(u) + f^-(u)$，并要求分裂后的通量具有确定的传播方向，即：
$$
\frac{d f^+(u)}{du} \ge 0 \quad \text{和} \quad \frac{d f^-(u)}{du} \le 0
$$
一个简单而稳健的分裂方法是**全局Lax-Friedrichs分裂**。我们引入一个参数 $\alpha$，它必须大于或等于整个求解域中可能出现的最大特征波速的[绝对值](@entry_id:147688)，即 $\alpha \ge \max|f'(u)|$。然后定义：
$$
f^{\pm}(u) = \frac{1}{2}(f(u) \pm \alpha u)
$$
通过这个定义，我们可以验证 $\frac{d f^+}{du} = \frac{1}{2}(f'(u)+\alpha) \ge 0$ 和 $\frac{d f^-}{du} = \frac{1}{2}(f'(u)-\alpha) \le 0$ 总是成立的。

完成分裂后，我们就可以安全地对 $f^+(u)$ 进行左偏[WENO重构](@entry_id:756703)，对 $f^-(u)$ 进行[右偏](@entry_id:180351)[WENO重构](@entry_id:756703)，然后将两者在交界面处的结果相加，得到最终的数值通量。这样就保证了在任何情况下都正确地考虑了信息的传播方向。

**2. 系统方程：[特征分解](@entry_id:181333)重构**

对于[守恒律方程组](@entry_id:755768)，如欧拉方程，$u$ 和 $f(u)$ 都是向量。此时，信息传播由通量雅可比矩阵 $A(u) = \partial f / \partial u$ 的[特征值](@entry_id:154894)和[特征向量](@entry_id:151813)决定。一个直接的方法是对 $u$ 或 $f(u)$ 的每个分量（例如，对 $\rho, \rho u, E$）独立地进行[WENO重构](@entry_id:756703)，这称为**分量式重构**。

然而，分量式重构存在一个严重问题。在物理上，一个间断（如激波）通常只与一个特定的特征场（或波族）相关联。但是，由于物理变量（如密度、动量、能量）是[特征变量](@entry_id:747282)的[线性组合](@entry_id:154743)，一个单一物理波的间断会“污染”所有分量，使得它们看起来都不光滑。当WENO应用于这些分量时，它会在所有分量上都启动[振荡](@entry_id:267781)抑制机制，这可能导致不必要的[数值耗散](@entry_id:168584)，并可能在不同波族之间产生[伪振荡](@entry_id:152404)。

更物理、更精确的方法是**特征式重构**。其思想是在重构之前，先将[问题转换](@entry_id:274273)到与物理波传播方向对齐的[坐标系](@entry_id:156346)中。具体步骤如下：
1.  在每个需要重构的交界面 $x_{i+1/2}$ 处，计算一个平均状态 $\bar{u}$，并求出该状态下的通量雅可比矩阵 $A(\bar{u})$。
2.  对 $A(\bar{u})$ 进行[特征分解](@entry_id:181333)：$A = R \Lambda L$，其中 $R$ 和 $L$ 分别是右、左[特征向量](@entry_id:151813)矩阵，$L=R^{-1}$，$\Lambda$ 是包含[特征值](@entry_id:154894)（[特征速度](@entry_id:165394)）的对角矩阵。
3.  将交界面附近模板上的[守恒变量](@entry_id:747720) $u_j$ 投影到**[特征变量](@entry_id:747282)**空间：$v_j = L u_j$。
4.  对[特征变量](@entry_id:747282) $v$ 的每个分量进行独立的标量[WENO重构](@entry_id:756703)。因为在这个空间里，不同的物理波被解耦了，一个激波只会让一个或少数几个特征分量变得不光滑，而其他分量的重构可以保持最高精度。
5.  将重构得到的交界面[特征变量](@entry_id:747282) $v_{i+1/2}^{\pm}$ 转换回[守恒变量](@entry_id:747720)空间：$u_{i+1/2}^{\pm} = R v_{i+1/2}^{\pm}$。
6.  使用这些重构后的[守恒变量](@entry_id:747720) $u_{i+1/2}^{\pm}$ 计算数值通量。

特征式重构通过将数值重构与物理波结构对齐，显著减少了数值[伪振荡](@entry_id:152404)，能够更清晰地分辨不同类型的波（如激波、接触间断和[稀疏波](@entry_id:168428)），是求解[复杂流动](@entry_id:747569)问题的首选方法。

### 高级主题与改进

**1. 理论性质：非TVD但基本不[振荡](@entry_id:267781)**

一个常见的误解是，像WENO这样优秀的激波捕捉格式应该是总变差递减（TVD）的。然而，根据Godunov定理，任何线性的[TVD格式](@entry_id:164079)其精度最高只能是一阶。WENO作为[高阶格式](@entry_id:150564)，必然不是线性的，并且也不是严格的[TVD格式](@entry_id:164079)。

[WENO格式](@entry_id:145935)的[非线性权重](@entry_id:752658)使其无法满足TVD的充分条件。事实上，在某些情况下，[WENO格式](@entry_id:145935)的总变差（TV）可能会略微增加。一个经典的例子是，当用[WENO格式](@entry_id:145935)演化一个光滑的[正弦波](@entry_id:274998)时，在其极值点附近，由于局部精度会从五阶降至三阶或四阶，可能会导致波峰被轻微地“削尖”，从而使得离散总变差 $TV_d[u^n] = \sum_i |u_{i+1}^n - u_i^n|$ 出现微小的增长。

尽管如此，WENO被称为**基本不[振荡](@entry_id:267781)**（Essentially Non-Oscillatory）是恰当的。因为在间断处，其自适应权重机制能够有效地抑制与[吉布斯现象](@entry_id:138701)相关的、幅度为 $\mathcal{O}(1)$ 的剧烈[振荡](@entry_id:267781)。总变差的微小增长通常发生在光滑区域，其量级与格式的截断误差相当，并不会发展成不稳定的[伪振荡](@entry_id:152404)。

**2. WENO-JS的精度退化问题**

尽管WENO-JS格式非常成功，但它在一个特定的情况下会意外地损失精度：在光滑解的**[临界点](@entry_id:144653)（critical points）**处。一个 $q$ 阶[临界点](@entry_id:144653)是指在该点处，函数的前 $q$ 阶导数均为零，但第 $q+1$ 阶导数不为零。

考虑WENO5，当它遇到一个二阶[临界点](@entry_id:144653)（$u'(x_i)=0, u''(x_i)=0, u'''(x_i) \neq 0$）时，例如函数 $u(x) = (x-x_0)^3$ 在 $x_0$ 点。通过[泰勒展开](@entry_id:145057)分析可以发现，此时三个光滑度指示子 $\beta_k$ 的渐进行为如下：
$$
\beta_0 \sim \mathcal{O}(\Delta x^6), \quad \beta_1 \sim \mathcal{O}(\Delta x^6), \quad \beta_2 \sim \mathcal{O}(\Delta x^6)
$$
它们都以相同的阶数趋于零。然而，它们前面的系数却不相同，具体来说 $\beta_0$ 和 $\beta_2$ 的系数远大于 $\beta_1$ 的系数。这会“误导”权重公式，使其认为中间模板 $S_1$ 比两边的模板 $S_0, S_2$ “光滑得多”。结果是，[非线性权重](@entry_id:752658) $\omega_k$ 不再趋向于最优权重 $d_k$，而是几乎将所有权重都分配给了模板 $S_1$（即 $\omega_1 \to 1$）。

这意味着WENO5格式在这一点上退化为只使用中心模板的单个三阶重构，其精度也从设计的五阶骤降至三阶或四阶。对于需要长时间[精确模拟](@entry_id:749142)复杂光滑流动的应用（如[湍流](@entry_id:151300)和声波传播），这种精度损失是不可接受的。

**3. 改进方案：WENO-Z**

为了解决WENO-JS在[临界点](@entry_id:144653)处的精度下降问题，研究者们提出了多种改进方案，其中一种著名的方法是**WENO-Z**格式。其核心思想是在权重计算中引入一个**全局光滑度指示子**，以“校正”原始权重在[临界点](@entry_id:144653)处的行为。

WENO-Z的[非线性权重](@entry_id:752658)公式修改为：
$$
\alpha_k^Z = d_k \left( 1 + \left( \frac{\tau_5}{\beta_k + \varepsilon} \right)^p \right)
$$
这里的关键是新引入的 $\tau_5 = |\beta_0 - \beta_2|$。这个量度量了整个五点大模板上的对称性，因此被看作一个更高阶的全局光滑度指示子。

我们来分析其工作原理：
*   **在[临界点](@entry_id:144653)处**：如前所述，$u'(x_i)=u''(x_i)=0$，此时 $\beta_k \sim \mathcal{O}(\Delta x^4)$ 而 $\tau_5 \sim \mathcal{O}(\Delta x^5)$。因此，比值 $\tau_5 / (\beta_k+\varepsilon)$ 的量级为 $\mathcal{O}(\Delta x)$。修正项 $(\tau_5 / (\beta_k+\varepsilon))^p$ 的量级为 $\mathcal{O}(\Delta x^p)$（当 $p=2$ 时为 $\mathcal{O}(\Delta x^2)$）。这个高阶小量加到1上，保证了修正后的 $\alpha_k^Z$ 仍然非常接近理想权重 $d_k$。经过归一化后，$\omega_k - d_k$ 的量级满足恢复五阶精度的要求，从而解决了精度退化问题。

*   **在间断处**：WENO-Z依然保持优良的无[振荡](@entry_id:267781)特性。如果模板 $S_k$ 包含间断，其 $\beta_k$ 会变得很大（$\mathcal{O}(1)$），而 $\tau_5$ 和其他[光滑模](@entry_id:752104)板的 $\beta_j$ 仍然很小。这使得不[光滑模](@entry_id:752104)板 $S_k$ 的修正项 $\tau_5/(\beta_k+\varepsilon)$ 趋近于零，其权重 $\alpha_k^Z$ 几乎不变。而对于[光滑模](@entry_id:752104)板，它们的修正项会变得很大，从而增大了它们的权重。最终结果仍然是将权重集中在[光滑模](@entry_id:752104)板上，保证了格式的稳定性。

通过这种巧妙的设计，WENO-Z等改进格式在保持经典[WENO格式](@entry_id:145935)鲁棒性的同时，提升了其在光滑区域（特别是[临界点](@entry_id:144653)）的精度，使其成为一个更全面、更可靠的数值工具。