{
    "hands_on_practices": [
        {
            "introduction": "要真正理解总变差递减（TVD）格式的工作原理，一个富有启发性的方法是暂时告别复杂的编程，转而用解析方法分析一个简单的“玩具问题”。通过这个练习，我们能在一个时间步内精确地观察到通量限制器如何作用于一个局部不连续点，从而控制总变差的增长，并揭示不同限制器在最基本的层面上的行为差异 。",
            "id": "3383794",
            "problem": "考虑标量线性平流方程 $u_{t} + a\\,u_{x} = 0$，其中常数波速 $a > 0$。该方程在一个间距为 $\\Delta x$ 的均匀一维网格上，通过大小为 $\\Delta t$ 的显式前向欧拉步进行时间推进。令库朗-弗里德里希斯-列维数为 $\\lambda = a\\,\\Delta t/\\Delta x \\in [0,1]$。使用守恒有限体积更新\n$$\nu_{i}^{n+1} = u_{i}^{n} - \\lambda\\left(F_{i+\\frac{1}{2}}^{n} - F_{i-\\frac{1}{2}}^{n}\\right),\n$$\n其中，由于 $a>0$，迎风通量为 $F_{i+\\frac{1}{2}}^{n} = a\\,u_{i+\\frac{1}{2}}^{-}$，左状态通过线性重构（守恒律的单调上游中心格式，MUSCL）得到\n$$\nu_{i+\\frac{1}{2}}^{-} = u_{i}^{n} + \\frac{1}{2}\\,(1-\\lambda)\\,\\phi(r_{i})\\,(u_{i}^{n} - u_{i-1}^{n}),\n$$\n其中比率 $r_{i}$ 定义为\n$$\nr_{i} = \\frac{u_{i+1}^{n} - u_{i}^{n}}{u_{i}^{n} - u_{i-1}^{n}},\n$$\n而 $\\phi(r)$ 是一个斜率限制器函数。考虑三种总变差减小 (TVD) 限制器：\n- Superbee: $\\phi_{\\mathrm{SB}}(r) = \\max\\!\\left(0,\\,\\min(2r,1),\\,\\min(r,2)\\right)$,\n- van Leer: $\\phi_{\\mathrm{VL}}(r) = \\frac{r + |r|}{1 + |r|}$,\n- Monotonized Central (MC): $\\phi_{\\mathrm{MC}}(r) = \\max\\!\\left(0,\\,\\min\\!\\left(\\frac{1+r}{2},\\,2,\\,2r\\right)\\right)$.\n\n在一个四单元的周期性域上，给定锯齿状初始数据（在时间层 $n$ 的单元平均值）\n$$\nu_{0}^{n} = 0,\\quad u_{1}^{n} = 1,\\quad u_{2}^{n} = 3,\\quad u_{3}^{n} = 2,\n$$\n并以周期 $4$ 进行周期性延拓。将时间层 $n$ 的总变差定义为\n$$\nTV(u^{n}) = \\sum_{i=0}^{3} \\left|u_{i+1}^{n} - u_{i}^{n}\\right|,\n$$\n其中下标以 $4$ 为模。\n\n从以上定义和有限体积更新出发，分析性地追踪该格式的一个时间步，从而为每种限制器获得总变差之比 $TV(u^{n+1})/TV(u^{n})$ 作为库朗数 $\\lambda$ 的函数的闭式表达式。将你的最终答案表示为顺序为 $\\left[\\text{superbee},\\,\\text{van Leer},\\,\\text{MC}\\right]$ 的单个行矩阵。无需四舍五入。最终答案必须是单个闭式解析表达式。",
            "solution": "该问题经验证具有科学依据、良定、客观且自洽。要求是确定在特定数值格式和初始条件下，一个时间步内总变差的比率。\n\n对于标量线性平流方程 $u_t + a u_x = 0$（其中 $a>0$），其有限体积更新由下式给出：\n$$\nu_{i}^{n+1} = u_{i}^{n} - \\lambda\\left(F_{i+\\frac{1}{2}}^{n} - F_{i-\\frac{1}{2}}^{n}\\right)\n$$\n问题陈述了数值通量与重构状态的关系为 $F_{i+\\frac{1}{2}}^{n} = a\\,u_{i+\\frac{1}{2}}^{-}$。更新项 $\\lambda\\left(F_{i+\\frac{1}{2}}^{n} - F_{i-\\frac{1}{2}}^{n}\\right)$ 必须与 $u_i$ 具有相同的物理单位。由于 $\\lambda = a \\Delta t / \\Delta x$ 是无量纲的，而 $F$ 的单位是 $a$ 乘以 $u$，因此所提供的更新方程在量纲上似乎不一致。一个标准的守恒格式写作 $u_{i}^{n+1} = u_{i}^{n} - \\frac{\\Delta t}{\\Delta x}\\left(f_{i+\\frac{1}{2}}^{n} - f_{i-\\frac{1}{2}}^{n}\\right)$，其中 $f$ 是数值通量，单位为 $a \\cdot u$。使用 $f_{i+\\frac{1}{2}}^{n} = F_{i+\\frac{1}{2}}^{n} = a u_{i+\\frac{1}{2}}^{-}$，这变为 $u_{i}^{n+1} = u_{i}^{n} - \\frac{a \\Delta t}{\\Delta x}\\left(u_{i+\\frac{1}{2}}^{-} - u_{i-\\frac{1}{2}}^{-}\\right) = u_{i}^{n} - \\lambda \\left(u_{i+\\frac{1}{2}}^{-} - u_{i-\\frac{1}{2}}^{-}\\right)$。我们将问题的更新公式解释为 $u_{i}^{n+1} = u_{i}^{n} - \\lambda(u_{i+\\frac{1}{2}}^{-} - u_{i-\\frac{1}{2}}^{-})$，这实际上是假设问题符号中的 $F$ 代表 $f/a$。\n\n重构的左状态由下式给出：\n$$\nu_{i+\\frac{1}{2}}^{-} = u_{i}^{n} + \\frac{1}{2}(1-\\lambda)\\phi(r_{i})(u_{i}^{n} - u_{i-1}^{n})\n$$\n将此代入更新规则，得到 $u_{i}^{n+1}$ 的表达式：\n$$\nu_{i}^{n+1} = u_{i}^{n} - \\lambda \\left[ \\left(u_{i}^{n} + \\frac{1}{2}(1-\\lambda)\\phi(r_{i})(u_{i}^{n} - u_{i-1}^{n})\\right) - \\left(u_{i-1}^{n} + \\frac{1}{2}(1-\\lambda)\\phi(r_{i-1})(u_{i-1}^{n} - u_{i-2}^{n})\\right) \\right]\n$$\n我们定义后向差分 $\\Delta_i^n = u_i^n - u_{i-1}^n$。公式变为：\n$$\nu_{i}^{n+1} = u_{i}^{n} - \\lambda \\left[ (u_i^n-u_{i-1}^n) + \\frac{1-\\lambda}{2}\\phi(r_i)\\Delta_i^n - \\frac{1-\\lambda}{2}\\phi(r_{i-1})\\Delta_{i-1}^n \\right]\n$$\n$$\nu_{i}^{n+1} = u_i^n - \\lambda \\Delta_i^n - \\frac{\\lambda(1-\\lambda)}{2} \\left( \\phi(r_i)\\Delta_i^n - \\phi(r_{i-1})\\Delta_{i-1}^n \\right)\n$$\n\n接下来，我们计算在 $4$ 单元周期性域上给定初始状态的各个量：$u_{0}^{n} = 0$，$u_{1}^{n} = 1$，$u_{2}^{n} = 3$，$u_{3}^{n} = 2$。\n后向差分 $\\Delta_i^n = u_i^n - u_{i-1}^n$ 是（使用周期性 $u_{-1}^n = u_3^n=2$ 等）：\n$\\Delta_0^n = u_0^n - u_{-1}^n = 0 - 2 = -2$\n$\\Delta_1^n = u_1^n - u_0^n = 1 - 0 = 1$\n$\\Delta_2^n = u_2^n - u_1^n = 3 - 1 = 2$\n$\\Delta_3^n = u_3^n - u_2^n = 2 - 3 = -1$\n\n时间层 $n$ 的总变差是：\n$$\nTV(u^n) = \\sum_{i=0}^{3} |u_{i+1}^n - u_i^n| = |u_1^n-u_0^n| + |u_2^n-u_1^n| + |u_3^n-u_2^n| + |u_0^n-u_3^n|\n$$\n$$\nTV(u^n) = |1| + |2| + |-1| + |-2| = 1+2+1+2=6\n$$\n比率 $r_i = \\frac{u_{i+1}^n - u_i^n}{u_i^n - u_{i-1}^n}$ 是：\n$r_0 = \\frac{u_1^n-u_0^n}{u_0^n-u_{-1}^n} = \\frac{1}{-2} = -\\frac{1}{2}$\n$r_1 = \\frac{u_2^n-u_1^n}{u_1^n-u_0^n} = \\frac{2}{1} = 2$\n$r_2 = \\frac{u_3^n-u_2^n}{u_2^n-u_1^n} = \\frac{-1}{2} = -\\frac{1}{2}$\n$r_3 = \\frac{u_0^n-u_3^n}{u_3^n-u_2^n} = \\frac{-2}{-1} = 2$\n\n现在，我们计算当 $r \\in \\{-\\frac{1}{2}, 2\\}$ 时限制器函数 $\\phi(r)$ 的值。\n当 $r = -\\frac{1}{2}$ 时：\n$\\phi_{\\mathrm{SB}}(-\\frac{1}{2}) = \\max(0, \\min(-1, 1), \\min(-\\frac{1}{2}, 2)) = \\max(0, -1, -\\frac{1}{2}) = 0$\n$\\phi_{\\mathrm{VL}}(-\\frac{1}{2}) = \\frac{-1/2 + |-1/2|}{1+|-1/2|} = 0$\n$\\phi_{\\mathrm{MC}}(-\\frac{1}{2}) = \\max(0, \\min(\\frac{1-1/2}{2}, 2, -1)) = \\max(0, -1) = 0$\n因此，对于所有三种限制器，$\\phi(-\\frac{1}{2})=0$。从而，$\\phi(r_0)=0$ 且 $\\phi(r_2)=0$。\n\n当 $r = 2$ 时：\n$\\phi_{\\mathrm{SB}}(2) = \\max(0, \\min(4, 1), \\min(2, 2)) = \\max(0, 1, 2) = 2$\n$\\phi_{\\mathrm{VL}}(2) = \\frac{2+|2|}{1+|2|} = \\frac{4}{3}$\n$\\phi_{\\mathrm{MC}}(2) = \\max(0, \\min(\\frac{1+2}{2}, 2, 4)) = \\max(0, \\frac{3}{2}) = \\frac{3}{2}$\n因此，对于所有三种限制器，$\\phi(r_1)=\\phi(r_3)=\\phi(2)$，其中 $\\phi(2)$ 是每种限制器的特定值。\n\n现在我们计算在时间 $n+1$ 时的差值 $ \\delta_i^{n+1} = u_{i+1}^{n+1} - u_i^{n+1}$。\n$$\n\\delta_i^{n+1} = (u_{i+1}^n - u_i^n) - \\lambda(\\Delta_{i+1}^n - \\Delta_i^n) - \\frac{\\lambda(1-\\lambda)}{2}[\\phi(r_{i+1})\\Delta_{i+1}^n - 2\\phi(r_i)\\Delta_i^n + \\phi(r_{i-1})\\Delta_{i-1}^n]\n$$\n注意 $u_{i+1}^n - u_i^n = \\Delta_{i+1}^n$。\n$$\n\\delta_i^{n+1} = \\Delta_{i+1}^n(1-\\lambda) + \\lambda\\Delta_i^n - \\frac{\\lambda(1-\\lambda)}{2}[\\phi(r_{i+1})\\Delta_{i+1}^n - 2\\phi(r_i)\\Delta_i^n + \\phi(r_{i-1})\\Delta_{i-1}^n]\n$$\n让我们逐一计算。令 $\\phi(2)$ 表示限制器的值。\n对于 $i=0$：$\\Delta_0=-2, \\Delta_1=1, \\Delta_3=-1, \\Delta_4=\\Delta_0=-2$。$r_0=-1/2 \\implies \\phi(r_0)=0$, $r_1=2 \\implies \\phi(r_1)=\\phi(2)$, $r_3=2 \\implies \\phi(r_3)=\\phi(2)$。\n$\\delta_0^{n+1} = \\Delta_1(1-\\lambda) + \\lambda\\Delta_0 - \\frac{\\lambda(1-\\lambda)}{2}[\\phi(r_1)\\Delta_1 - 2\\phi(r_0)\\Delta_0 + \\phi(r_3)\\Delta_3]$\n$\\delta_0^{n+1} = 1(1-\\lambda) + \\lambda(-2) - \\frac{\\lambda(1-\\lambda)}{2}[\\phi(2)(1) - 2(0)(-2) + \\phi(2)(-1)] = 1-\\lambda-2\\lambda - 0 = 1-3\\lambda$。\n\n对于 $i=1$：$\\Delta_1=1, \\Delta_2=2$。$r_1=2 \\implies \\phi(r_1)=\\phi(2)$, $r_2=-1/2 \\implies \\phi(r_2)=0$, $r_0=-1/2 \\implies \\phi(r_0)=0$。\n$\\delta_1^{n+1} = \\Delta_2(1-\\lambda) + \\lambda\\Delta_1 - \\frac{\\lambda(1-\\lambda)}{2}[\\phi(r_2)\\Delta_2 - 2\\phi(r_1)\\Delta_1 + \\phi(r_0)\\Delta_0]$\n$\\delta_1^{n+1} = 2(1-\\lambda) + \\lambda(1) - \\frac{\\lambda(1-\\lambda)}{2}[0(2) - 2\\phi(2)(1) + 0(-2)] = 2-2\\lambda+\\lambda - \\frac{\\lambda(1-\\lambda)}{2}(-2\\phi(2))$\n$\\delta_1^{n+1} = 2-\\lambda + \\lambda(1-\\lambda)\\phi(2)$。\n\n对于 $i=2$：$\\Delta_2=2, \\Delta_3=-1$。$r_2=-1/2, r_3=2, r_1=2$。$\\phi(r_2)=0, \\phi(r_3)=\\phi(2), \\phi(r_1)=\\phi(2)$。\n$\\delta_2^{n+1} = \\Delta_3(1-\\lambda) + \\lambda\\Delta_2 - \\frac{\\lambda(1-\\lambda)}{2}[\\phi(r_3)\\Delta_3 - 2\\phi(r_2)\\Delta_2 + \\phi(r_1)\\Delta_1]$\n$\\delta_2^{n+1} = -1(1-\\lambda) + \\lambda(2) - \\frac{\\lambda(1-\\lambda)}{2}[\\phi(2)(-1) - 2(0)(2) + \\phi(2)(1)] = -1+\\lambda+2\\lambda - 0 = -1+3\\lambda$。\n\n对于 $i=3$：$\\Delta_3=-1, \\Delta_0=-2$。$r_3=2, r_0=-1/2, r_2=-1/2$。$\\phi(r_3)=\\phi(2), \\phi(r_0)=0, \\phi(r_2)=0$。\n$\\delta_3^{n+1} = \\Delta_0(1-\\lambda) + \\lambda\\Delta_3 - \\frac{\\lambda(1-\\lambda)}{2}[\\phi(r_0)\\Delta_0 - 2\\phi(r_3)\\Delta_3 + \\phi(r_2)\\Delta_2]$\n$\\delta_3^{n+1} = -2(1-\\lambda) + \\lambda(-1) - \\frac{\\lambda(1-\\lambda)}{2}[0(-2) - 2\\phi(2)(-1) + 0(2)] = -2+2\\lambda-\\lambda - \\frac{\\lambda(1-\\lambda)}{2}(2\\phi(2))$\n$\\delta_3^{n+1} = -2+\\lambda - \\lambda(1-\\lambda)\\phi(2)$。\n\n新的总变差为 $TV(u^{n+1}) = \\sum_{i=0}^3|\\delta_i^{n+1}|$。\n注意到 $\\delta_2^{n+1} = -(1-3\\lambda) = -\\delta_0^{n+1}$ 且 $\\delta_3^{n+1} = -(2-\\lambda+\\lambda(1-\\lambda)\\phi(2)) = -\\delta_1^{n+1}$。\n所以，$TV(u^{n+1}) = |\\delta_0^{n+1}| + |\\delta_1^{n+1}| + |-\\delta_0^{n+1}| + |-\\delta_1^{n+1}| = 2|\\delta_0^{n+1}| + 2|\\delta_1^{n+1}|$。\n$TV(u^{n+1}) = 2|1-3\\lambda| + 2|2-\\lambda+\\lambda(1-\\lambda)\\phi(2)|$。\n对于 $\\lambda \\in [0,1]$，项 $2-\\lambda > 0$。项 $\\lambda(1-\\lambda) \\ge 0$。限制器值 $\\phi(2)$ 均为正。因此，$2-\\lambda+\\lambda(1-\\lambda)\\phi(2) > 0$。\n所以，$|2-\\lambda+\\lambda(1-\\lambda)\\phi(2)| = 2-\\lambda+\\lambda(1-\\lambda)\\phi(2)$。\n$TV(u^{n+1}) = 2|1-3\\lambda| + 2(2-\\lambda+\\lambda(1-\\lambda)\\phi(2))$。\n比率 $TV(u^{n+1})/TV(u^n)$ 为：\n$$\n\\frac{TV(u^{n+1})}{TV(u^{n})} = \\frac{2|1-3\\lambda| + 4 - 2\\lambda + 2\\lambda(1-\\lambda)\\phi(2)}{6} = \\frac{|1-3\\lambda| + 2 - \\lambda + \\lambda(1-\\lambda)\\phi(2)}{3}\n$$\n我们现在为每种限制器代入 $\\phi(2)$ 的具体值。\n\n1.  Superbee: $\\phi_{\\mathrm{SB}}(2) = 2$。\n    $\\frac{|1-3\\lambda| + 2 - \\lambda + \\lambda(1-\\lambda)(2)}{3} = \\frac{|1-3\\lambda| + 2 - \\lambda + 2\\lambda - 2\\lambda^2}{3} = \\frac{|1-3\\lambda| + 2 + \\lambda - 2\\lambda^2}{3}$。\n\n2.  van Leer: $\\phi_{\\mathrm{VL}}(2) = \\frac{4}{3}$。\n    $\\frac{|1-3\\lambda| + 2 - \\lambda + \\lambda(1-\\lambda)(\\frac{4}{3})}{3} = \\frac{|1-3\\lambda| + 2 - \\lambda + \\frac{4}{3}\\lambda - \\frac{4}{3}\\lambda^2}{3} = \\frac{|1-3\\lambda| + 2 + \\frac{1}{3}\\lambda - \\frac{4}{3}\\lambda^2}{3}$。为清晰起见，这可以重写为 $\\frac{3|1-3\\lambda| + 6 + \\lambda - 4\\lambda^2}{9}$。\n\n3.  Monotonized Central (MC): $\\phi_{\\mathrm{MC}}(2) = \\frac{3}{2}$。\n    $\\frac{|1-3\\lambda| + 2 - \\lambda + \\lambda(1-\\lambda)(\\frac{3}{2})}{3} = \\frac{|1-3\\lambda| + 2 - \\lambda + \\frac{3}{2}\\lambda - \\frac{3}{2}\\lambda^2}{3} = \\frac{|1-3\\lambda| + 2 + \\frac{1}{2}\\lambda - \\frac{3}{2}\\lambda^2}{3}$。这可以重写为 $\\frac{2|1-3\\lambda| + 4 + \\lambda - 3\\lambda^2}{6}$。\n\n这些就是总变差比率的最终表达式。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{|1-3\\lambda| + 2 + \\lambda - 2\\lambda^2}{3}, & \\frac{3|1-3\\lambda| + 6 + \\lambda - 4\\lambda^2}{9}, & \\frac{2|1-3\\lambda| + 4 + \\lambda - 3\\lambda^2}{6}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在通过解析方法建立了对 TVD 机制的微观理解后，我们将视角转向宏观效应。这项实践要求我们通过编写程序，数值模拟一个阶跃波的平流过程，并比较多种经典通量限制器（如 minmod, MC 和 superbee）对解的影响 。这将帮助我们直观地认识到不同限制器的“侵略性”（aggressiveness）如何转化为解的清晰度（压缩特性）与光滑度（耗散特性）之间的权衡。",
            "id": "3383804",
            "problem": "考虑一个标量场 $u(x,t)$ 在守恒形式下的线性平流方程，其平流速度 $a$ 为常数，\n$$\n\\frac{\\partial u}{\\partial t} + \\frac{\\partial}{\\partial x}\\left(a\\,u\\right) = 0,\n$$\n该方程定义在一个长度为 $L$ 的周期性区域上。设初始条件为一个单位阶跃，其左状态为 $u_L$，右状态为 $u_R$，位于点 $x_s \\in [0,L)$，并设空间网格是均匀的，有 $N_x$ 个控制体积。目标是使用三种不同的通量限制器：minmod、Monotonized Central (MC) 和 superbee，来数值研究总变差在高分辨率二阶总变差减小 (TVD) 守恒律单调上游中心格式 (MUSCL) 下的演化情况。\n\n您的推导和实现应基于以下基本原理和事实：\n- 对单元平均值 $u_i^n$ 使用守恒律有限体积法进行更新，其数值通量 $F_{i+1/2}^n$ 是一致的，\n$$\nu_i^{n+1} = u_i^n - \\frac{\\Delta t}{\\Delta x}\\left(F_{i+1/2}^n - F_{i-1/2}^n\\right).\n$$\n- 库朗数 $C$ 由 $C = a\\,\\Delta t / \\Delta x$ 给出。\n- 周期性网格上，网格函数 $u^n = \\{u_i^n\\}$ 的总变差为\n$$\nTV(u^n) = \\sum_{i=0}^{N_x-1} \\left|u_{i+1}^n - u_i^n\\right|,\n$$\n其中使用周期性索引，使得 $u_{N_x}^n \\equiv u_0^n$。\n- 对于常数 $a>0$，一个与 Sweby 框架一致的高分辨率 TVD 通量限制器方法，将一个上游单调通量与一个受限的高阶修正项结合起来。该修正项取决于局部光滑度比率 $r_i$ 和一个限制器函数 $\\phi(r)$，使得该格式在光滑区域是二阶精确的，而在间断附近则退化为单调上游格式。假设采用标准的 MUSCL 型重构，其中 $r_i$ 由单侧离散梯度定义，并且限制器 $\\phi(r)$ 属于经典的 TVD 容许集。\n\n使用以下定义在光滑度比率 $r$ 上的限制器函数（约定如果 $r$ 的分母为零，则使用 $r=0$）：\n- Minmod 限制器：$\\phi_{\\text{MM}}(r) = \\max\\left(0, \\min\\left(1, r\\right)\\right)$。\n- Monotonized Central 限制器：$\\phi_{\\text{MC}}(r) = \\max\\left(0, \\min\\left(\\frac{1+r}{2}, 2, 2r\\right)\\right)$。\n- Superbee 限制器：$\\phi_{\\text{SB}}(r) = \\max\\left(0, \\min\\left(2r,1\\right), \\min\\left(r,2\\right)\\right)$。\n\n您的任务是：\n- 为线性平流方程推导一个守恒的二阶 MUSCL 型 TVD 离散格式，使用上述限制器，并确保在容许范围内的库朗数 $C$ 下，该格式满足总变差减小性质。\n- 实现所推导的方法，并在所有三种限制器使用相同库朗数的条件下，计算周期性阶跃初始条件在选定时间步下的总变差 $TV(u^n)$，以通过总变差的演化来比较限制器的压缩性。\n\n本研究需使用的实现细节：\n- 区域：周期性区间 $[0,L)$，其中 $L = 1$。\n- 平流速度：$a = 1$。\n- 网格单元数：$N_x = 400$。\n- 初始条件：当 $x  x_s$ 时，$u(x,0) = u_L$；当 $x \\ge x_s$ 时，$u(x,0) = u_R$。其中 $u_L = 1$，$u_R = 0$，$x_s = 0.3$。\n- 时间积分：根据守恒有限体积法进行显式单步更新，使用与上述原理一致的 MUSCL 型 TVD 数值通量。必须强制执行周期性边界条件。\n- 库朗数和采样计划（测试套件）：\n    - 测试 A（理想情况）：$C = 0.8$，演化 $N_{\\text{steps}} = 80$ 个时间步，并记录时间步 $n \\in \\{0,10,20,40,80\\}$ 处的总变差。\n    - 测试 B（耗散边缘）：$C = 0.2$，演化 $N_{\\text{steps}} = 80$ 个时间步，并记录在相同时间步集合 $n \\in \\{0,10,20,40,80\\}$ 处的 $TV(u^n)$。\n    - 测试 C（CFL 边界）：$C = 1.0$，演化 $N_{\\text{steps}} = 80$ 个时间步，并记录在相同时间步集合 $n \\in \\{0,10,20,40,80\\}$ 处的 $TV(u^n)$。\n- 对每项测试，按 minmod、MC、superbee 的顺序计算并报告每个限制器的总变差序列。\n\n您的程序必须生成单行输出，其中包含一个扁平化的浮点值列表，该列表聚合了所有结果。其排序方式如下：对于 A、B、C 顺序中的每个测试，以及在每个测试中对于 minmod、MC、superbee 顺序中的每个限制器，按 $n$ 的递增顺序附加在时间步 $n \\in \\{0,10,20,40,80\\}$ 的总变差值。最终输出格式必须是单行的 Python 风格列表，例如，\n\"[v_1,v_2, ... , v_M]\",\n其中每个 $v_k$ 是一个表示一次测量的总变差的浮点数。由于 $TV(u^n)$ 是无量纲的，因此输出不需要物理单位。",
            "solution": "我们从一个标量 $u(x,t)$ 的线性平流方程开始，其平流速度 $a$ 为常数，\n$$\n\\frac{\\partial u}{\\partial t} + \\frac{\\partial}{\\partial x}\\left(a\\,u\\right) = 0,\n$$\n定义在一个周期性区域上。守恒有限体积法通过以下公式更新单元平均值 $u_i^n$：\n$$\nu_i^{n+1} = u_i^n - \\frac{\\Delta t}{\\Delta x}\\left(F_{i+1/2}^n - F_{i-1/2}^n\\right),\n$$\n其中 $F_{i+1/2}^n$ 是一个一致的数值通量，用于近似单元 $i$ 和 $i+1$ 之间界面上的 $a\\,u$。对于常数 $a0$，一个单调上游通量为 $F_{i+1/2}^{\\text{up}} = a\\,u_i^n$。这产生了一个一阶方法，该方法是总变差减小 (TVD) 的，但具有耗散性。为了在光滑区域恢复二阶精度，同时在间断附近保持 TVD 性质，我们采用一种与 Sweby 框架一致的高分辨率 MUSCL (守恒律单调上游中心格式) 通量限制器方法。\n\n库朗数为 $C = a\\,\\Delta t/\\Delta x$，对于 $0 \\le C \\le 1$，可以使用合适的限制器来确保 TVD 性质。关键思想是通过一个基于局部光滑度的受限高阶项来修正上游通量。定义前向差分 $\\Delta^+ u_i = u_{i+1}^n - u_i^n$ 和后向差分 $\\Delta^- u_i = u_i^n - u_{i-1}^n$，并定义光滑度比率\n$$\nr_i = \\frac{\\Delta^- u_i}{\\Delta^+ u_i},\n$$\n约定当 $\\Delta^+ u_i = 0$ 时 $r_i = 0$，以避免除以零，并在平坦区域保持在 TVD 单调上游基线内。对于 $a0$，一个与 Sweby 图一致的通用二阶 TVD 通量具有以下形式\n$$\nF_{i+1/2}^n = a\\,u_i^n + \\frac{1}{2}\\,a\\,\\left(1 - C\\right)\\,\\phi(r_i)\\,\\left(u_{i+1}^n - u_i^n\\right),\n$$\n其中 $\\phi(r)$ 是一个被约束在 TVD 容许区域内的限制器函数，使得得到的格式对于 $0 \\le C \\le 1$ 是 TVD 的。总变差减小性质可理解为\n$$\nTV(u^{n+1}) \\le TV(u^n),\n$$\n其中对于周期性数据\n$$\nTV(u^n) = \\sum_{i=0}^{N_x-1} \\left|u_{i+1}^n - u_i^n\\right|, \\quad u_{N_x}^n \\equiv u_0^n.\n$$\n\n我们采用三种经典的限制器函数：\n- Minmod: $\\phi_{\\text{MM}}(r) = \\max\\left(0,\\min\\left(1,r\\right)\\right)$，它会进行强力限制以避免伪振荡，因此相对于其他 TVD 限制器会引入更多的数值耗散。\n- Monotonized Central (MC): $\\phi_{\\text{MC}}(r) = \\max\\left(0, \\min\\left(\\frac{1+r}{2}, 2, 2r\\right)\\right)$，这是一个平衡的限制器，具有中等的压缩性，在光滑区域有良好的精度。\n- Superbee: $\\phi_{\\text{SB}}(r) = \\max\\left(0,\\min\\left(2r,1\\right),\\min\\left(r,2\\right)\\right)$，这是一个高压缩性限制器，能最好地保持尖锐的间断，同时在 $0 \\le C \\le 1$ 的条件下保持 TVD 特性。\n\n基于原理的论证：\n- 该离散格式通过构造是守恒的，因为它通过通量差分进行更新，确保了在周期性边界条件下，区域积分量 $\\sum_i u_i^n$ 是守恒的。\n- TVD 性质源于 Harten 定理，该定理适用于带有受 Sweby 约束限制的反耗散修正项的单调通量。当 $0 \\le C \\le 1$ 且 $\\phi(r)$ 位于容许集内时，选择 $F_{i+1/2}^n = F_{i+1/2}^{\\text{up}} +$ 受限修正项可使修正后的格式保持在 TVD 类别中。\n- 当 $C = 1$ 时，高阶修正项消失，格式精确地退化为上游格式 $u_i^{n+1} = u_{i-1}^n$，即纯粹地移动一个单元，这能精确地保持总变差。对于 $0  C  1$，修正项在光滑区域提供二阶精度，而限制器在间断附近强制实现非振荡行为。\n\n算法设计：\n- 在 $[0,1)$ 上初始化一个包含 $N_x = 400$ 个单元的均匀网格，单元中心为 $x_i = \\left(i + \\frac{1}{2}\\right)\\Delta x$，其中 $\\Delta x = L/N_x$ 且 $L=1$。\n- 初始化 $u_i^0 = u_L$（如果 $x_i  x_s$）或 $u_R$（否则），其中 $u_L = 1$，$u_R = 0$，$x_s = 0.3$。在周期性条件下，这会产生两个跳跃，因此 $TV(u^0) \\approx 2$。\n- 对于每个测试库朗数 $C \\in \\{0.8,0.2,1.0\\}$，设置 $\\Delta t = C\\,\\Delta x/a$ 且 $a=1$。通过重复以下步骤演化 $N_{\\text{steps}} = 80$ 次：\n    - 计算周期性的前向差分 $\\Delta^+ u_i$ 和后向差分 $\\Delta^- u_i$。\n    - 构造 $r_i = \\Delta^- u_i/\\Delta^+ u_i$（当 $\\Delta^+ u_i \\ne 0$ 时），否则设 $r_i=0$。\n    - 为所选的限制器计算 $\\phi(r_i)$。\n    - 使用周期性索引，为所有界面组装通量 $F_{i+1/2}^n = a\\,u_i^n + \\frac{1}{2}a(1-C)\\phi(r_i)\\,\\Delta^+ u_i$。\n    - 使用周期性平移来获得 $F_{i-1/2}^n$，并更新 $u_i^{n+1} = u_i^n - \\frac{\\Delta t}{\\Delta x}\\left(F_{i+1/2}^n - F_{i-1/2}^n\\right)$。\n    - 在指定的时间步 $n \\in \\{0,10,20,40,80\\}$，通过对所有 $i$ 使用周期性索引求和 $|\\Delta^+ u_i|$ 来计算 $TV(u^n)$。\n- 对每种限制器选择（minmod、MC、superbee）重复上述过程。\n\n预期定性行为：\n- 对于 $C = 0.8$（理想情况），minmod 会更强烈地抑制总变差，MC 会保留更多的变差，而 superbee 将在保持 TVD 的同时最大程度地保留变差和最陡峭的波前。\n- 对于 $C = 0.2$（由于库朗数较小而更具耗散性），所有限制器都将显示出更显著的总变差衰减，其压缩性顺序不变：minmod 最具耗散性，superbee 最弱。\n- 对于 $C = 1.0$（Courant–Friedrichs–Lewy 边界），修正项消失，该方法退化为每个时间步移动一个单元的纯上游平移，对于此线性问题能精确地保持 $TV$。\n\n测试套件和输出：\n- 测试 A：$C=0.8$，按 minmod、MC、superbee 的顺序记录在 $n \\in \\{0,10,20,40,80\\}$ 处的 $TV$。\n- 测试 B：$C=0.2$，采样方式相同。\n- 测试 C：$C=1.0$，采样方式相同。\n- 程序必须输出单行，包含一个扁平化的 Python 风格浮点值列表，其排序如下：测试 A 的 minmod 序列，测试 A 的 MC 序列，测试 A 的 superbee 序列，然后是同样顺序的测试 B，最后是同样顺序的测试 C。\n\n由于 $TV(u^n)$ 是无量纲的，最终答案中不需要单位。所述的数值格式和采样足以计算所有要求的值，总变差减小行为应表现为每个限制器采样时间内的非增序列，与 MC 和 minmod 相比，superbee 限制器在相同时间范围内应显示出最小的总变差衰减。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef phi_minmod(r):\n    \"\"\"Minmod limiter function.\"\"\"\n    return np.maximum(0.0, np.minimum(1.0, r))\n\ndef phi_mc(r):\n    \"\"\"Monotonized Central (MC) limiter function.\"\"\"\n    return np.maximum(0.0, np.minimum(2.0 * r, np.minimum((1.0 + r) / 2.0, 2.0)))\n\ndef phi_superbee(r):\n    \"\"\"Superbee limiter function.\"\"\"\n    return np.maximum(0.0, np.maximum(np.minimum(2.0 * r, 1.0), np.minimum(r, 2.0)))\n\ndef compute_tv(u):\n    \"\"\"Total variation on a periodic grid.\"\"\"\n    return np.sum(np.abs(np.roll(u, -1) - u))\n\ndef muscl_tvd_advection_tv_sequence(C, limiter_name, Nx=400, L=1.0, a=1.0, nsteps=80, checkpoints=(0,10,20,40,80), xs=0.3, uL=1.0, uR=0.0):\n    \"\"\"\n    Computes the Total Variation (TV) sequence for the linear advection equation\n    using a MUSCL-type TVD flux-limiter scheme on a periodic domain.\n    \"\"\"\n    dx = L / Nx\n    # Create cell-centered grid\n    x = dx * (np.arange(Nx) + 0.5)\n    dt = C * dx / a\n\n    # Initial condition: step function\n    u = np.full(Nx, uL)\n    u[x >= xs] = uR\n\n    tv_values = []\n    \n    limiters = {\n        'minmod': phi_minmod,\n        'mc': phi_mc,\n        'superbee': phi_superbee\n    }\n    phi = limiters[limiter_name]\n\n    for n in range(nsteps + 1):\n        if n in checkpoints:\n            tv_values.append(compute_tv(u))\n\n        if n == nsteps:\n            break\n            \n        # Periodic boundary conditions are handled by np.roll\n        u_plus = np.roll(u, -1)  # u_{i+1}\n        u_minus = np.roll(u, 1)   # u_{i-1}\n        \n        delta_plus = u_plus - u     # Forward difference\n        delta_minus = u - u_minus   # Backward difference\n        \n        # Smoothness ratio r_i = delta_minus / delta_plus\n        # Handle division by zero according to the problem description (r=0)\n        r = np.zeros_like(u)\n        non_zero_den = delta_plus != 0.0\n        r[non_zero_den] = delta_minus[non_zero_den] / delta_plus[non_zero_den]\n        \n        # Apply the limiter function\n        phi_vals = phi(r)\n\n        # Calculate numerical flux at interface i+1/2\n        # F_{i+1/2} = a*u_i + 0.5*a*(1-C)*phi(r_i)*(u_{i+1}-u_i)\n        flux_i_plus_half = a * u + 0.5 * a * (1.0 - C) * phi_vals * delta_plus\n        \n        # Flux at i-1/2 is a rolled version of F_{i+1/2}\n        flux_i_minus_half = np.roll(flux_i_plus_half, 1)\n        \n        # Update cell averages using the conservative formula\n        u = u - (dt / dx) * (flux_i_plus_half - flux_i_minus_half)\n\n    return tv_values\n\ndef main():\n    \"\"\"Main function to run all tests and print the results.\"\"\"\n    all_results = []\n    checkpoints = (0, 10, 20, 40, 80)\n    nsteps = 80\n    \n    # Test A: C = 0.8\n    for limiter in ['minmod', 'mc', 'superbee']:\n        all_results.extend(muscl_tvd_advection_tv_sequence(C=0.8, limiter_name=limiter, nsteps=nsteps, checkpoints=checkpoints))\n        \n    # Test B: C = 0.2\n    for limiter in ['minmod', 'mc', 'superbee']:\n        all_results.extend(muscl_tvd_advection_tv_sequence(C=0.2, limiter_name=limiter, nsteps=nsteps, checkpoints=checkpoints))\n        \n    # Test C: C = 1.0\n    for limiter in ['minmod', 'mc', 'superbee']:\n        all_results.extend(muscl_tvd_advection_tv_sequence(C=1.0, limiter_name=limiter, nsteps=nsteps, checkpoints=checkpoints))\n        \n    # Print the final flattened list as a string\n    print(str(all_results))\n\nif __name__ == '__main__':\n    main()\n```"
        },
        {
            "introduction": "为了将我们的数值观察与严谨的理论联系起来，我们最终转向修正方程分析。这项高级技术揭示了我们的离散格式实际上在求解的等效连续偏微分方程，其与原始方程的差异体现在高阶导数项中 。通过计算这些主导误差项——即数值黏性与数值色散——我们能够定量地解释并预测在光滑解区域观察到的数值行为，从而深刻理解格式的精度本质。",
            "id": "3383815",
            "problem": "考虑常平流速度 $a0$ 的线性平流方程 $u_{t} + a\\,u_{x} = 0$，其定义在间距为 $\\Delta x$、时间步长为 $\\Delta t$ 的均匀网格上。定义库朗数 $C \\equiv a \\Delta t/\\Delta x$。考虑一个针对线性通量 $f(u)=a\\,u$ 的有限体积总变差递减 (TVD) 守恒律的单调上游中心格式 (MUSCL) 离散化，其以规范的通量限制器形式写出：\n$$\nu_{i}^{n+1} \\;=\\; u_{i}^{n} \\;-\\; \\frac{\\Delta t}{\\Delta x}\\,\\Big(f_{i+\\frac{1}{2}} - f_{i-\\frac{1}{2}}\\Big), \n\\qquad\nf_{i+\\frac{1}{2}} \\;=\\; a\\,u_{i} \\;+\\; \\frac{a}{2}\\,(1-C)\\,\\phi(r_{i})\\,\\big(u_{i+1}-u_{i}\\big),\n$$\n其中标准光滑度指示器为\n$$\nr_{i} \\;=\\; \\frac{u_{i}-u_{i-1}}{u_{i+1}-u_{i}},\n$$\n限制器函数 $\\phi(r)$ 从以下总变差递减 (TVD) 集合中选取：\n- minmod: $\\phi_{\\mathrm{mm}}(r) = \\max\\!\\big(0, \\min(1,r)\\big)$，\n- 单调中心 (MC): $\\phi_{\\mathrm{MC}}(r) = \\max\\!\\big(0, \\min\\big(2r, \\frac{1+r}{2}, 2\\big)\\big)$，\n- van Leer: $\\phi_{\\mathrm{vL}}(r) = \\frac{r+|r|}{1+|r|}$。\n\n假设在求值点处有一个光滑、单调、凸的局部剖面，具体为 $u_{x}0$ 和 $u_{xx}0$，因此 $r_{i}$ 位于 $1$ 下方的一个邻域内。进行修正方程分析，保留到并包括 $O(\\Delta x^{2})$ 的项，将限制器在 $r=1$ 附近进行线性化，并且只保留 $u_{x}$、$u_{xx}$ 和 $u_{xxx}$ 的线性项（即忽略诸如 $u_{xx}^{2}/u_{x}$ 的乘积项）。换句话说，寻求以下形式的连续方程\n$$\nu_{t} + a\\,u_{x} \\;=\\; \\nu_{\\mathrm{num}}(C)\\,\\Delta x\\,u_{xx} \\;+\\; \\mu_{\\mathrm{num}}(C)\\,\\Delta x^{2}\\,u_{xxx} \\;+\\; O(\\Delta x^{3}),\n$$\n并计算上述每种限制器的主阶数值粘性系数 $\\nu_{\\mathrm{num}}(C)$ 和数值色散系数 $\\mu_{\\mathrm{num}}(C)$，将结果表示为关于 $C$ 和 $a$ 的闭式解析函数。将你的最终答案以一个单行矩阵的形式给出，其中依次包含 minmod 的系数对、MC 的系数对和 van Leer 的系数对：\n$$\n\\big(\\nu_{\\mathrm{mm}}(C),\\,\\mu_{\\mathrm{mm}}(C),\\,\\nu_{\\mathrm{MC}}(C),\\,\\mu_{\\mathrm{MC}}(C),\\,\\nu_{\\mathrm{vL}}(C),\\,\\mu_{\\mathrm{vL}}(C)\\big).\n$$\n不需要进行数值计算；给出精确的解析表达式。最终答案必须是无单位的解析表达式。",
            "solution": "用户希望对线性平流方程的一个特定的总变差递减 (TVD) 守恒律的单调上游中心格式 (MUSCL) 离散进行修正方程分析。\n\n### 第一步：问题验证\n\n**提取的已知条件：**\n- 控制方程：$u_t + a u_x = 0$，其中平流速度 $a  0$ 为常数。\n- 网格：均匀网格，单元尺寸为 $\\Delta x$，时间步长为 $\\Delta t$。\n- 库朗数：$C = a \\frac{\\Delta t}{\\Delta x}$。\n- 离散格式：\n  $$ u_{i}^{n+1} = u_{i}^{n} - \\frac{\\Delta t}{\\Delta x}\\left(f_{i+\\frac{1}{2}} - f_{i-\\frac{1}{2}}\\right) $$\n- 数值通量：\n  $$ f_{i+\\frac{1}{2}} = a u_i + \\frac{a}{2}(1-C)\\phi(r_i)(u_{i+1}-u_i) $$\n- 光滑度指示器：\n  $$ r_i = \\frac{u_i - u_{i-1}}{u_{i+1} - u_i} $$\n- 通量限制器：\n  - minmod: $\\phi_{\\mathrm{mm}}(r) = \\max(0, \\min(1,r))$\n  - MC: $\\phi_{\\mathrm{MC}}(r) = \\max(0, \\min(2r, \\frac{1+r}{2}, 2))$\n  - van Leer: $\\phi_{\\mathrm{vL}}(r) = \\frac{r+|r|}{1+|r|}$\n- 假设：解是光滑、单调且凸的 ($u_x  0, u_{xx}  0$)，这意味着 $r_i$ 接近于 $1$ 且小于 $1$。\n- 目标：在修正方程中找到系数 $\\nu_{\\mathrm{num}}(C)$ 和 $\\mu_{\\mathrm{num}}(C)$：\n  $$ u_t + a u_x = \\nu_{\\mathrm{num}}(C) \\Delta x u_{xx} + \\mu_{\\mathrm{num}}(C) \\Delta x^2 u_{xxx} + O(\\Delta x^3) $$\n- 附加说明：分析涉及将 $\\phi(r)$ 在 $r=1$ 附近线性化，并忽略导数的非线性项（例如 $u_{xx}^2/u_x$）。\n\n**验证结论：**\n该问题是**有效的**。这是一个计算流体力学领域的标准适定问题，涉及数值格式的精度分析。所有提供的信息在科学上都是合理的、自洽的，并且可以形式化。任务是进行严谨的数学推导，这是该领域的标准流程。\n\n### 第二步：求解推导\n\n该分析通过对离散方程的各项应用泰勒级数展开，来推导其连续的（或修正的）对应方程。\n\n离散格式为：\n$$\n\\frac{u_i^{n+1} - u_i^n}{\\Delta t} = -\\frac{1}{\\Delta x}\\left(f_{i+\\frac{1}{2}} - f_{i-\\frac{1}{2}}\\right)\n$$\n\n**左侧 (LHS) 展开：**\n我们将 $u_i^{n+1} = u(x_i, t_n + \\Delta t)$ 在 $(x_i, t_n)$ 附近进行泰勒级数展开：\n$$\n\\frac{u_i^{n+1} - u_i^n}{\\Delta t} = u_t + \\frac{\\Delta t}{2}u_{tt} + \\frac{\\Delta t^2}{6}u_{ttt} + O(\\Delta t^3)\n$$\n为了用空间导数表示时间导数，我们使用修正方程本身，$u_t = -a u_x + O(\\Delta x)$。\n$u_{tt} = \\frac{\\partial}{\\partial t}(-a u_x + \\dots) = -a u_{xt} = -a \\frac{\\partial}{\\partial x}(u_t) \\approx -a \\frac{\\partial}{\\partial x}(-a u_x) = a^2 u_{xx}$。\n$u_{ttt} \\approx \\frac{\\partial}{\\partial t}(a^2 u_{xx}) = -a^3 u_{xxx}$。\n代入这些并使用 $C = a \\Delta t / \\Delta x$：\n$$\nLHS = u_t + \\frac{a^2 \\Delta t}{2}u_{xx} - \\frac{a^3 \\Delta t^2}{6}u_{xxx} + \\dots = u_t + \\frac{a C \\Delta x}{2}u_{xx} - \\frac{a C^2 \\Delta x^2}{6}u_{xxx} + \\dots\n$$\n\n**右侧 (RHS) 展开：**\nRHS 涉及数值通量的散度。通量差为：\n$$\nf_{i+\\frac{1}{2}} - f_{i-\\frac{1}{2}} = \\left[a u_i + \\frac{a(1-C)}{2}\\phi(r_i)(u_{i+1}-u_i)\\right] - \\left[a u_{i-1} + \\frac{a(1-C)}{2}\\phi(r_{i-1})(u_i-u_{i-1})\\right]\n$$\n$$\n= a(u_i - u_{i-1}) + \\frac{a(1-C)}{2}\\left[\\phi(r_i)(u_{i+1}-u_i) - \\phi(r_{i-1})(u_i-u_{i-1})\\right]\n$$\n我们将所有项在 $x_i$ 附近展开，用 $u_x, u_{xx}$ 等表示 $u$ 在 $x_i$ 处的导数。\n$$\nu_{i \\pm k} = u \\pm k\\Delta x u_x + \\frac{(k\\Delta x)^2}{2}u_{xx} \\pm \\frac{(k\\Delta x)^3}{6}u_{xxx} + \\dots\n$$\n差分项为：\n$$\nu_i - u_{i-1} = \\Delta x u_x - \\frac{\\Delta x^2}{2} u_{xx} + \\frac{\\Delta x^3}{6} u_{xxx} + O(\\Delta x^4)\n$$\n$$\nu_{i+1} - u_i = \\Delta x u_x + \\frac{\\Delta x^2}{2} u_{xx} + \\frac{\\Delta x^3}{6} u_{xxx} + O(\\Delta x^4)\n$$\n光滑度指示器 $r_i$ 展开为：\n$$\nr_i = \\frac{u_i - u_{i-1}}{u_{i+1} - u_i} = \\frac{1 - \\frac{\\Delta x}{2}\\frac{u_{xx}}{u_x} + \\frac{\\Delta x^2}{6}\\frac{u_{xxx}}{u_x} - \\dots}{1 + \\frac{\\Delta x}{2}\\frac{u_{xx}}{u_x} + \\frac{\\Delta x^2}{6}\\frac{u_{xxx}}{u_x} + \\dots} \\approx 1 - \\Delta x \\frac{u_{xx}}{u_x} + O(\\Delta x^2)\n$$\n根据要求，我们忽略了导数的乘积项。这意味着 $r_i - 1 \\approx -\\Delta x \\frac{u_{xx}}{u_x}$。\n限制器函数在 $r=1$ 附近线性化：$\\phi(r_i) \\approx \\phi(1) + \\phi'(1)(r_i-1)$。对于所有指定的限制器，在区域 $r \\to 1^-$ 中，$\\phi(1)=1$。\n$$\n\\phi(r_i) \\approx 1 - \\phi'(1)\\Delta x \\frac{u_{xx}}{u_x}\n$$\n类似地，$r_{i-1} = r(x_i - \\Delta x) \\approx r(x_i) - \\Delta x \\frac{dr}{dx}|_{x_i}$。\n$$\n\\frac{dr}{dx} \\approx \\frac{d}{dx}\\left(-\\Delta x \\frac{u_{xx}}{u_x}\\right) \\approx -\\Delta x \\frac{u_{xxx}}{u_x}\n$$\n所以，$r_{i-1} \\approx \\left(1 - \\Delta x \\frac{u_{xx}}{u_x}\\right) - \\Delta x \\left(-\\Delta x \\frac{u_{xxx}}{u_x}\\right) = 1 - \\Delta x \\frac{u_{xx}}{u_x} + \\Delta x^2 \\frac{u_{xxx}}{u_x}$。\n$$\n\\phi(r_{i-1}) \\approx 1 + \\phi'(1)(r_{i-1}-1) = 1 + \\phi'(1)\\left(-\\Delta x \\frac{u_{xx}}{u_x} + \\Delta x^2 \\frac{u_{xxx}}{u_x}\\right)\n$$\n现在我们展开通量差中的括号项，称之为 $T$：\n$$\nT = \\phi(r_i)(u_{i+1}-u_i) - \\phi(r_{i-1})(u_i-u_{i-1})\n$$\n$$\n\\phi(r_i)(u_{i+1}-u_i) \\approx \\left(1-\\phi'(1)\\Delta x \\frac{u_{xx}}{u_x}\\right)\\left(\\Delta x u_x + \\frac{\\Delta x^2}{2}u_{xx} + \\dots\\right) \\approx \\Delta x u_x + \\left(\\frac{1}{2}-\\phi'(1)\\right)\\Delta x^2 u_{xx} + \\dots\n$$\n$$\n\\phi(r_{i-1})(u_i-u_{i-1}) \\approx \\left(1-\\phi'(1)\\Delta x \\frac{u_{xx}}{u_x} + \\phi'(1)\\Delta x^2\\frac{u_{xxx}}{u_x}\\right)\\left(\\Delta x u_x - \\frac{\\Delta x^2}{2}u_{xx} + \\frac{\\Delta x^3}{6}u_{xxx}\\right)\n$$\n$$\n\\approx \\Delta x u_x - \\left(\\frac{1}{2}+\\phi'(1)\\right)\\Delta x^2 u_{xx} + \\left(\\frac{1}{6}+\\phi'(1)\\right)\\Delta x^3 u_{xxx} + \\dots\n$$\n将这两个表达式相减得到：\n$$\nT \\approx \\Delta x^2 u_{xx} - \\phi'(1)\\Delta x^3 u_{xxx}\n$$\n将其代入通量差表达式：\n$$\nf_{i+\\frac{1}{2}} - f_{i-\\frac{1}{2}} = a\\left(\\Delta x u_x - \\frac{\\Delta x^2}{2}u_{xx} + \\frac{\\Delta x^3}{6}u_{xxx}\\right) + \\frac{a(1-C)}{2}\\left(\\Delta x^2 u_{xx} - \\phi'(1)\\Delta x^3 u_{xxx}\\right)\n$$\n$$\n= a\\Delta x u_x + \\left(-\\frac{a}{2} + \\frac{a(1-C)}{2}\\right)\\Delta x^2 u_{xx} + \\left(\\frac{a}{6} - \\frac{a(1-C)\\phi'(1)}{2}\\right)\\Delta x^3 u_{xxx}\n$$\n$$\n= a\\Delta x u_x - \\frac{aC}{2}\\Delta x^2 u_{xx} + a\\left(\\frac{1}{6} - \\frac{(1-C)\\phi'(1)}{2}\\right)\\Delta x^3 u_{xxx}\n$$\n离散方程的 RHS 为：\n$$\nRHS = -\\frac{1}{\\Delta x}(f_{i+\\frac{1}{2}} - f_{i-\\frac{1}{2}}) = -a u_x + \\frac{aC}{2}\\Delta x u_{xx} - a\\left(\\frac{1}{6} - \\frac{(1-C)\\phi'(1)}{2}\\right)\\Delta x^2 u_{xxx}\n$$\n令展开后的 LHS 和 RHS 相等：\n$$\nu_t + \\frac{a C \\Delta x}{2}u_{xx} - \\frac{a C^2 \\Delta x^2}{6}u_{xxx} = -a u_x + \\frac{aC}{2}\\Delta x u_{xx} - a\\left(\\frac{1}{6} - \\frac{(1-C)\\phi'(1)}{2}\\right)\\Delta x^2 u_{xxx}\n$$\n整理成所需形式 $u_t + a u_x = \\dots$：\n$$\nu_t + a u_x = \\left(\\frac{aC}{2}\\Delta x - \\frac{aC\\Delta x}{2}\\right)u_{xx} + \\left[\\frac{a C^2 \\Delta x^2}{6} - a\\left(\\frac{1}{6} - \\frac{(1-C)\\phi'(1)}{2}\\right)\\Delta x^2\\right]u_{xxx}\n$$\n$u_{xx}$ 项的系数（数值粘性）为零：\n$$\n\\nu_{\\mathrm{num}}(C)\\Delta x = 0 \\implies \\nu_{\\mathrm{num}}(C) = 0\n$$\n这是预期的结果，因为该格式在光滑区域被设计为空间二阶精度。\n\n$u_{xxx}$ 项的系数（数值色散）为：\n$$\n\\mu_{\\mathrm{num}}(C)\\Delta x^2 = \\left[\\frac{aC^2}{6} - \\frac{a}{6} + \\frac{a(1-C)\\phi'(1)}{2}\\right]\\Delta x^2\n$$\n$$\n\\mu_{\\mathrm{num}}(C) = \\frac{a}{6}[C^2 - 1 + 3(1-C)\\phi'(1)]\n$$\n\n**对每种限制器进行评估：**\n我们需要为每种限制器在 $r\\to 1^-$ 时求出 $\\phi'(1)$。\n1.  **minmod:** 对于 $0  r  1$，$\\phi_{\\mathrm{mm}}(r) = r$。因此，$\\phi'_{\\mathrm{mm}}(1) = 1$。\n2.  **MC:** 对于接近 $1$ 的 $r$，$\\frac{1+r}{2}$ 是 `min` 函数中最小的参数。$\\phi_{\\mathrm{MC}}(r) = \\frac{1+r}{2}$。因此，$\\phi'_{\\mathrm{MC}}(1) = \\frac{1}{2}$。\n3.  **van Leer:** 对于 $r  0$，$\\phi_{\\mathrm{vL}}(r) = \\frac{2r}{1+r}$。其导数为 $\\phi'_{\\mathrm{vL}}(r) = \\frac{2}{(1+r)^2}$。因此，$\\phi'_{\\mathrm{vL}}(1) = \\frac{2}{(1+1)^2} = \\frac{1}{2}$。\n\n将这些值代入 $\\mu_{\\mathrm{num}}(C)$ 的表达式中：\n- **minmod ($\\phi'(1)=1$):**\n  $$\n  \\mu_{\\mathrm{mm}}(C) = \\frac{a}{6}[C^2 - 1 + 3(1-C)] = \\frac{a}{6}[C^2 - 3C + 2] = \\frac{a}{6}(C-1)(C-2)\n  $$\n- **MC ($\\phi'(1)=\\frac{1}{2}$):**\n  $$\n  \\mu_{\\mathrm{MC}}(C) = \\frac{a}{6}\\left[C^2 - 1 + 3(1-C)\\frac{1}{2}\\right] = \\frac{a}{6}\\left[C^2 - 1 + \\frac{3}{2} - \\frac{3}{2}C\\right] = \\frac{a}{6}\\left[C^2 - \\frac{3}{2}C + \\frac{1}{2}\\right] = \\frac{a}{12}(2C^2 - 3C + 1) = \\frac{a}{12}(2C-1)(C-1)\n  $$\n- **van Leer ($\\phi'(1)=\\frac{1}{2}$):**\n  结果与 MC 限制器相同。\n  $$\n  \\mu_{\\mathrm{vL}}(C) = \\frac{a}{12}(2C-1)(C-1)\n  $$\n\n所要求的六个系数是：\n- $\\nu_{\\mathrm{mm}}(C) = 0$\n- $\\mu_{\\mathrm{mm}}(C) = \\frac{a}{6}(C-1)(C-2)$\n- $\\nu_{\\mathrm{MC}}(C) = 0$\n- $\\mu_{\\mathrm{MC}}(C) = \\frac{a}{12}(2C-1)(C-1)$\n- $\\nu_{\\mathrm{vL}}(C) = 0$\n- $\\mu_{\\mathrm{vL}}(C) = \\frac{a}{12}(2C-1)(C-1)$\n将它们组合成一个单行矩阵作为最终答案。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0,  \\frac{a}{6}(C-1)(C-2),  0,  \\frac{a}{12}(2C-1)(C-1),  0,  \\frac{a}{12}(2C-1)(C-1) \\end{pmatrix}}\n$$"
        }
    ]
}