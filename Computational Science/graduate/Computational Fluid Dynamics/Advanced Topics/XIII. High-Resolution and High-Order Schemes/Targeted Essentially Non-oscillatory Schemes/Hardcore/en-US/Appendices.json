{
    "hands_on_practices": [
        {
            "introduction": "This first exercise goes to the heart of the Targeted Essentially Non-Oscillatory (TENO) scheme: its stencil selection mechanism. By applying the TENO discontinuity detector to a set of hypothetical smoothness indicators, you will perform the crucial calculation that determines which candidate stencils are admitted into the final high-order reconstruction. This practice provides a concrete numerical example of how TENO distinguishes \"smooth\" stencils from those potentially contaminated by discontinuities, forming the basis for its non-oscillatory behavior. ",
            "id": "3369887",
            "problem": "Consider a one-dimensional conservative hyperbolic partial differential equation, and a high-order finite-volume reconstruction at a cell interface that employs multiple candidate stencils $\\{S_k\\}$, indexed by $k \\in \\{0,1,2,3\\}$. The Targeted Essentially Non-Oscillatory (TENO) paradigm aims to enforce the essentially non-oscillatory property near discontinuities by excluding stencils that exhibit non-smooth behavior, while retaining only those deemed sufficiently smooth. Let $\\beta_k$ denote the smoothness indicator associated with stencil $S_k$ (as used in Weighted Essentially Non-Oscillatory (WENO) methodology), $\\tau$ a global smoothness reference scale, $q$ a sensitivity exponent, $C_T$ a cut-off threshold, and $\\epsilon$ a small positive regularization parameter.\n\nDefine the TENO discontinuity detector\n$$\\delta_k = \\left(\\frac{\\tau}{\\beta_k + \\epsilon}\\right)^{q},$$\nand the binary admission mask\n$$\\chi_k = \\begin{cases}\n1, & \\delta_k > C_T,\\\\\n0, & \\delta_k \\le C_T,\n\\end{cases}$$\nso that only stencils with $\\chi_k = 1$ are admitted into the reconstruction.\n\nStarting from the principle that an admissible stencil must be demonstrably smoother than the global reference, reason why the above detector serves as an appropriate monotone selection mechanism, and then evaluate the resulting $\\chi_k$ with the following numerical inputs:\n$$(\\beta_0,\\beta_1,\\beta_2,\\beta_3) = \\left(1.0 \\times 10^{-6},\\, 1.0 \\times 10^{-3},\\, 5.0 \\times 10^{-2},\\, 0.5\\right),$$\n$$\\tau = 0.5,\\quad q = 4,\\quad C_T = 1.0 \\times 10^{3},\\quad \\epsilon = 1.0 \\times 10^{-10}.$$\n\nDetermine the subset of admitted stencils $\\{k:\\chi_k=1\\}$ and express your final answer as a single row matrix whose first four entries are $\\chi_0,\\chi_1,\\chi_2,\\chi_3$, followed by the indices of the admitted stencils in increasing order. No rounding is required, and no physical units apply.",
            "solution": "The problem is first subjected to a validation check.\n\n### Step 1: Extract Givens\n- **Context**: One-dimensional conservative hyperbolic partial differential equation, high-order finite-volume reconstruction.\n- **Candidate Stencils**: $\\{S_k\\}$ indexed by $k \\in \\{0,1,2,3\\}$.\n- **Smoothness Indicator**: $\\beta_k$ for each stencil $S_k$.\n- **Global Smoothness Reference Scale**: $\\tau$.\n- **Sensitivity Exponent**: $q$.\n- **Cut-off Threshold**: $C_T$.\n- **Regularization Parameter**: $\\epsilon$.\n- **TENO Discontinuity Detector**: $\\delta_k = \\left(\\frac{\\tau}{\\beta_k + \\epsilon}\\right)^{q}$.\n- **Binary Admission Mask**: $\\chi_k = \\begin{cases} 1, & \\delta_k > C_T,\\\\ 0, & \\delta_k \\le C_T. \\end{cases}$\n- **Numerical Inputs**:\n  - $(\\beta_0,\\beta_1,\\beta_2,\\beta_3) = \\left(1.0 \\times 10^{-6},\\, 1.0 \\times 10^{-3},\\, 5.0 \\times 10^{-2},\\, 0.5\\right)$\n  - $\\tau = 0.5$\n  - $q = 4$\n  - $C_T = 1.0 \\times 10^{3}$\n  - $\\epsilon = 1.0 \\times 10^{-10}$\n- **Task**:\n  1. Explain why the detector is an appropriate monotone selection mechanism based on the principle that admissible stencils must be demonstrably smoother than the global reference.\n  2. Evaluate $\\chi_k$ for the given inputs.\n  3. Determine the subset of admitted stencils $\\{k:\\chi_k=1\\}$.\n  4. Express the final answer as a single row matrix containing $(\\chi_0,\\chi_1,\\chi_2,\\chi_3)$ followed by the indices of the admitted stencils.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientific Grounding**: The problem is grounded in the well-established field of computational fluid dynamics, specifically concerning high-order numerical methods for hyperbolic conservation laws. The Targeted Essentially Non-Oscillatory (TENO) scheme, its parameters ($\\beta_k$, $\\tau$, $q$, $C_T$), and the defined detector are standard and accurately represented as per the scientific literature (e.g., Fu et al., Journal of Computational Physics, 2016).\n- **Well-Posedness**: The problem is fully specified. All definitions, parameters, and numerical values required for a unique solution are provided.\n- **Objectivity**: The problem statement is expressed in precise, objective, and technical language, free from any subjectivity or bias.\n- **Completeness and Consistency**: The setup is complete and internally consistent. There are no missing data or contradictory constraints.\n- **Topic Relevance**: The problem is explicitly and correctly centered on the topic of \"Targeted Essentially Non-Oscillatory schemes\".\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. A full solution will be provided.\n\n### Solution and Reasoning\n\nThe core principle of the Targeted Essentially Non-Oscillatory (TENO) scheme is to build a high-order reconstruction using a combination of candidate stencils, but only after filtering out any stencils that are contaminated by discontinuities or strong gradients. The smoothness indicator, $\\beta_k$, quantifies the level of oscillatory behavior within the solution on stencil $S_k$. A smaller value of $\\beta_k$ indicates a smoother function on that stencil, whereas a larger value suggests the presence of oscillations or a discontinuity.\n\nThe problem states that an admissible stencil must be \"demonstrably smoother than the global reference\". This means we require $\\beta_k$ to be significantly smaller than the global smoothness reference scale $\\tau$. The TENO discontinuity detector, $\\delta_k = \\left(\\frac{\\tau}{\\beta_k + \\epsilon}\\right)^{q}$, is designed to measure this relative smoothness.\n\nLet's analyze the function $\\delta_k(\\beta_k)$.\n1.  **Ratio**: The term $\\frac{\\tau}{\\beta_k + \\epsilon}$ compares stencil smoothness to the reference scale. The regularization parameter $\\epsilon$ is a small positive constant to prevent division by zero when $\\beta_k = 0$, which occurs for constant or linear fields. If stencil $S_k$ is very smooth (i.e., $\\beta_k \\ll \\tau$), this ratio will be a large positive number. If the stencil is not smooth (i.e., $\\beta_k$ is on the order of $\\tau$ or larger), this ratio will be of order $1$ or less.\n2.  **Sensitivity Exponent**: The exponent $q$ (with $q > 1$, here $q=4$) serves to amplify the separation between \"smooth\" and \"non-smooth\" stencils. A ratio greater than $1$ becomes much larger when raised to the power $q$, while a ratio less than $1$ becomes much smaller. This creates a sharper, more decisive criterion for admission.\n3.  **Monotonicity**: The detector $\\delta_k$ is a strictly monotonically decreasing function of the smoothness indicator $\\beta_k$. To prove this formally, we can examine its derivative with respect to $\\beta_k$:\n    $$ \\frac{d\\delta_k}{d\\beta_k} = \\frac{d}{d\\beta_k} \\left[ \\left(\\frac{\\tau}{\\beta_k + \\epsilon}\\right)^{q} \\right] = q \\left(\\frac{\\tau}{\\beta_k + \\epsilon}\\right)^{q-1} \\cdot \\left( -\\frac{\\tau}{(\\beta_k + \\epsilon)^2} \\right) = -q \\frac{\\tau^q}{(\\beta_k + \\epsilon)^{q+1}} $$\n    Since $\\tau > 0$, $q > 0$, and $\\beta_k + \\epsilon > 0$, the derivative $\\frac{d\\delta_k}{d\\beta_k}$ is always negative. This confirms that as a stencil becomes less smooth (i.e., $\\beta_k$ increases), the value of its detector $\\delta_k$ decreases.\n\nThis monotonic relationship makes $\\delta_k$ an ideal selection mechanism. A simple threshold test, $\\delta_k > C_T$, directly translates to an upper bound on the acceptable non-smoothness $\\beta_k$. By setting a large cut-off threshold $C_T$, the TENO scheme ensures that only stencils that are significantly smoother than the reference scale (resulting in a very large $\\delta_k$) are admitted, thereby robustly preventing spurious oscillations near discontinuities.\n\nNow, we evaluate the admission mask $\\chi_k$ for each stencil using the provided numerical inputs:\n- $\\tau = 0.5$\n- $q = 4$\n- $C_T = 1.0 \\times 10^{3}$\n- $\\epsilon = 1.0 \\times 10^{-10}$\n- $(\\beta_0, \\beta_1, \\beta_2, \\beta_3) = (1.0 \\times 10^{-6}, 1.0 \\times 10^{-3}, 5.0 \\times 10^{-2}, 0.5)$\n\nFor each $k \\in \\{0,1,2,3\\}$, we calculate $\\delta_k$ and compare it to $C_T$. The term $\\epsilon$ is many orders of magnitude smaller than any given $\\beta_k$ (except potentially for an ideal case not presented here), thus $\\beta_k + \\epsilon \\approx \\beta_k$.\n\n- **Stencil $S_0$ ($k=0$):**\n  $\\beta_0 = 1.0 \\times 10^{-6}$\n  $$ \\delta_0 = \\left(\\frac{0.5}{1.0 \\times 10^{-6} + 1.0 \\times 10^{-10}}\\right)^4 \\approx \\left(\\frac{0.5}{1.0 \\times 10^{-6}}\\right)^4 = (5.0 \\times 10^5)^4 = 625 \\times 10^{20} = 6.25 \\times 10^{22} $$\n  Since $6.25 \\times 10^{22} > 1.0 \\times 10^{3}$, we have $\\delta_0 > C_T$. Therefore, $\\chi_0 = 1$. Stencil $S_0$ is admitted.\n\n- **Stencil $S_1$ ($k=1$):**\n  $\\beta_1 = 1.0 \\times 10^{-3}$\n  $$ \\delta_1 = \\left(\\frac{0.5}{1.0 \\times 10^{-3} + 1.0 \\times 10^{-10}}\\right)^4 \\approx \\left(\\frac{0.5}{1.0 \\times 10^{-3}}\\right)^4 = (5.0 \\times 10^2)^4 = 625 \\times 10^8 = 6.25 \\times 10^{10} $$\n  Since $6.25 \\times 10^{10} > 1.0 \\times 10^{3}$, we have $\\delta_1 > C_T$. Therefore, $\\chi_1 = 1$. Stencil $S_1$ is admitted.\n\n- **Stencil $S_2$ ($k=2$):**\n  $\\beta_2 = 5.0 \\times 10^{-2}$\n  $$ \\delta_2 = \\left(\\frac{0.5}{5.0 \\times 10^{-2} + 1.0 \\times 10^{-10}}\\right)^4 \\approx \\left(\\frac{0.5}{5.0 \\times 10^{-2}}\\right)^4 = \\left(\\frac{5.0 \\times 10^{-1}}{5.0 \\times 10^{-2}}\\right)^4 = (10)^4 = 1.0 \\times 10^4 $$\n  Since $1.0 \\times 10^4 > 1.0 \\times 10^{3}$, we have $\\delta_2 > C_T$. Therefore, $\\chi_2 = 1$. Stencil $S_2$ is admitted.\n\n- **Stencil $S_3$ ($k=3$):**\n  $\\beta_3 = 0.5$\n  $$ \\delta_3 = \\left(\\frac{0.5}{0.5 + 1.0 \\times 10^{-10}}\\right)^4 \\approx \\left(\\frac{0.5}{0.5}\\right)^4 = 1^4 = 1 $$\n  Since $1 \\le 1.0 \\times 10^{3}$, we have $\\delta_3 \\le C_T$. Therefore, $\\chi_3 = 0$. Stencil $S_3$ is rejected.\n\nThe resulting binary admission mask vector is $(\\chi_0, \\chi_1, \\chi_2, \\chi_3) = (1, 1, 1, 0)$.\nThe subset of admitted stencils corresponds to the indices where $\\chi_k=1$, which is $\\{k: \\chi_k = 1\\} = \\{0, 1, 2\\}$.\n\nThe final answer requires a row matrix containing the components of the admission mask followed by the indices of the admitted stencils in increasing order. This corresponds to the sequence $(1, 1, 1, 0, 0, 1, 2)$.",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 1 & 1 & 1 & 0 & 0 & 1 & 2 \\end{pmatrix} } $$"
        },
        {
            "introduction": "Building on the selection mechanism, this practice explores the direct consequences of stencil rejection on the scheme's accuracy. You will analyze a scenario where the TENO admission mask excludes one of the candidate stencils, forcing a re-normalization of the reconstruction weights. This exercise requires a Taylor series analysis to determine the formal order of accuracy of the resulting scheme, offering critical insight into the trade-offs between stability and accuracy inherent in the TENO framework. ",
            "id": "3369863",
            "problem": "Consider the constant-coefficient linear advection equation $u_{t} + a\\,u_{x} = 0$ with $a > 0$ on a uniform grid with spacing $\\Delta x$ and grid points $x_{i} = i\\,\\Delta x$. In a finite difference (FD) formulation, the numerical flux at the right interface $x_{i+\\frac{1}{2}}$ is reconstructed from cell-centered point values $\\{u_{i+m}\\}$ using a Targeted Essentially Non-Oscillatory (TENO) scheme of formal order five (TENO5). The TENO5 reconstruction employs three candidate quadratic polynomials built on the following three-point stencils:\n- $S_{0} = \\{i-2, i-1, i\\}$,\n- $S_{1} = \\{i-1, i, i+1\\}$,\n- $S_{2} = \\{i, i+1, i+2\\}$.\n\nDefine the three candidate interface reconstructions at $x_{i+\\frac{1}{2}}$ by Lagrange interpolation on these stencils:\n- $p_{0} = \\frac{3}{8}\\,u_{i-2} - \\frac{5}{4}\\,u_{i-1} + \\frac{15}{8}\\,u_{i}$,\n- $p_{1} = -\\frac{1}{8}\\,u_{i-1} + \\frac{3}{4}\\,u_{i} + \\frac{3}{8}\\,u_{i+1}$,\n- $p_{2} = \\frac{3}{8}\\,u_{i} + \\frac{3}{4}\\,u_{i+1} - \\frac{1}{8}\\,u_{i+2}$.\n\nThe optimal linear weights that deliver the fifth-order linear upwind flux when all three candidates are admitted are given by $d_{0} = \\frac{1}{10}$, $d_{1} = \\frac{6}{10}$, and $d_{2} = \\frac{3}{10}$. In the targeted selection step of TENO, an admission mask $\\boldsymbol{\\chi}$ retains or excludes candidate stencils prior to normalization of the weights. Consider the specific admission mask\n$$\n\\boldsymbol{\\chi} = [\\,1,\\,1,\\,0\\,],\n$$\nwhich excludes the right-biased stencil $S_{2}$ while admitting $S_{0}$ and $S_{1}$.\n\nTasks:\n1. Compute the recomputed linear weights $\\tilde{d}_{k}$ for the admitted stencils by normalizing $\\{d_{0}, d_{1}\\}$ over the admitted set and setting the excluded weight to zero.\n2. Using a Taylor series analysis about $x_{i+\\frac{1}{2}}$, determine the leading power of $\\Delta x$ in the truncation error of the interface reconstruction formed by the convex combination $\\tilde{d}_{0}\\,p_{0} + \\tilde{d}_{1}\\,p_{1}$, and thus the resulting formal order $p$ of accuracy of this interface value in smooth regions.\n\nExpress the final answer as a single row matrix containing the three recomputed weights in the order $(\\tilde{d}_{0}, \\tilde{d}_{1}, \\tilde{d}_{2})$ followed by the integer $p$. No rounding is required and no units are necessary.",
            "solution": "The user wants to solve a problem based on a specific numerical scheme.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n-   **Equation:** Constant-coefficient linear advection equation $u_{t} + a\\,u_{x} = 0$ with $a > 0$.\n-   **Grid:** Uniform grid with spacing $\\Delta x$ and points $x_{i} = i\\,\\Delta x$.\n-   **Scheme:** Targeted Essentially Non-Oscillatory (TENO) scheme of formal order five (TENO5).\n-   **Candidate Stencils:**\n    -   $S_{0} = \\{i-2, i-1, i\\}$\n    -   $S_{1} = \\{i-1, i, i+1\\}$\n    -   $S_{2} = \\{i, i+1, i+2\\}$\n-   **Candidate Reconstructions at $x_{i+\\frac{1}{2}}$:**\n    -   $p_{0} = \\frac{3}{8}\\,u_{i-2} - \\frac{5}{4}\\,u_{i-1} + \\frac{15}{8}\\,u_{i}$\n    -   $p_{1} = -\\frac{1}{8}\\,u_{i-1} + \\frac{3}{4}\\,u_{i} + \\frac{3}{8}\\,u_{i+1}$\n    -   $p_{2} = \\frac{3}{8}\\,u_{i} + \\frac{3}{4}\\,u_{i+1} - \\frac{1}{8}\\,u_{i+2}$\n-   **Optimal Linear Weights for Fifth-Order:** $d_{0} = \\frac{1}{10}$, $d_{1} = \\frac{6}{10}$, $d_{2} = \\frac{3}{10}$.\n-   **Admission Mask:** $\\boldsymbol{\\chi} = [\\,1,\\,1,\\,0\\,]$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, well-posed, and objective. It is a standard analysis problem within the field of computational fluid dynamics, specifically concerning high-order finite difference methods. All provided data, including the Lagrange interpolation coefficients for the candidate stencils and the optimal linear weights, are consistent with the established literature on TENO and WENO schemes. The tasks are clearly defined and all necessary information is provided. Therefore, the problem is valid.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A complete solution will be provided.\n\n### Solution\n\n**Part 1: Compute the recomputed linear weights $\\tilde{d}_{k}$**\n\nThe initial set of linear weights for the fifth-order scheme is $\\{d_{0}, d_{1}, d_{2}\\} = \\{\\frac{1}{10}, \\frac{6}{10}, \\frac{3}{10}\\}$. The admission mask $\\boldsymbol{\\chi} = [\\,1,\\,1,\\,0\\,]$ indicates that candidate stencils $S_{0}$ and $S_{1}$ are admitted, while $S_{2}$ is excluded.\n\nAccording to the procedure described, the recomputed weights $\\{\\tilde{d}_{k}\\}$ are found by normalizing the original weights of the admitted stencils. The weight for the excluded stencil is set to zero.\n\nThe sum of the original weights for the admitted stencils is:\n$$\nd_{\\text{admitted}} = d_{0} + d_{1} = \\frac{1}{10} + \\frac{6}{10} = \\frac{7}{10}\n$$\nThe recomputed weights for the admitted stencils are:\n$$\n\\tilde{d}_{0} = \\frac{d_{0}}{d_{\\text{admitted}}} = \\frac{1/10}{7/10} = \\frac{1}{7}\n$$\n$$\n\\tilde{d}_{1} = \\frac{d_{1}}{d_{\\text{admitted}}} = \\frac{6/10}{7/10} = \\frac{6}{7}\n$$\nThe weight for the excluded stencil is set to zero:\n$$\n\\tilde{d}_{2} = 0\n$$\nThus, the vector of recomputed weights is $(\\tilde{d}_{0}, \\tilde{d}_{1}, \\tilde{d}_{2}) = (\\frac{1}{7}, \\frac{6}{7}, 0)$.\n\n**Part 2: Determine the formal order of accuracy $p$**\n\nThe new interface reconstruction, $u_{i+\\frac{1}{2}}^{\\text{recon}}$, is a convex combination of the admitted candidate reconstructions:\n$$\nu_{i+\\frac{1}{2}}^{\\text{recon}} = \\tilde{d}_{0}\\,p_{0} + \\tilde{d}_{1}\\,p_{1} + \\tilde{d}_{2}\\,p_{2} = \\frac{1}{7}\\,p_{0} + \\frac{6}{7}\\,p_{1}\n$$\nSubstituting the expressions for $p_{0}$ and $p_{1}$:\n$$\nu_{i+\\frac{1}{2}}^{\\text{recon}} = \\frac{1}{7} \\left( \\frac{3}{8}\\,u_{i-2} - \\frac{5}{4}\\,u_{i-1} + \\frac{15}{8}\\,u_{i} \\right) + \\frac{6}{7} \\left( -\\frac{1}{8}\\,u_{i-1} + \\frac{3}{4}\\,u_{i} + \\frac{3}{8}\\,u_{i+1} \\right)\n$$\nWe collect the coefficients for each point value $u_{j}$:\n-   Coefficient of $u_{i-2}$: $\\frac{1}{7} \\cdot \\frac{3}{8} = \\frac{3}{56}$\n-   Coefficient of $u_{i-1}$: $\\frac{1}{7} \\left(-\\frac{5}{4}\\right) + \\frac{6}{7} \\left(-\\frac{1}{8}\\right) = -\\frac{5}{28} - \\frac{6}{56} = -\\frac{10}{56} - \\frac{6}{56} = -\\frac{16}{56}$\n-   Coefficient of $u_{i}$: $\\frac{1}{7} \\left(\\frac{15}{8}\\right) + \\frac{6}{7} \\left(\\frac{3}{4}\\right) = \\frac{15}{56} + \\frac{18}{28} = \\frac{15}{56} + \\frac{36}{56} = \\frac{51}{56}$\n-   Coefficient of $u_{i+1}$: $\\frac{6}{7} \\left(\\frac{3}{8}\\right) = \\frac{18}{56}$\n\nThe reconstruction is therefore:\n$$\nu_{i+\\frac{1}{2}}^{\\text{recon}} = c_{i-2}u_{i-2} + c_{i-1}u_{i-1} + c_{i}u_{i} + c_{i+1}u_{i+1}\n$$\nwhere $\\{c_{i-2}, c_{i-1}, c_i, c_{i+1}\\} = \\{\\frac{3}{56}, -\\frac{16}{56}, \\frac{51}{56}, \\frac{18}{56}\\}$.\n\nTo find the order of accuracy, we perform a Taylor series expansion of each $u_{j}$ around the interface point $x_{i+\\frac{1}{2}}$. Let $u(x)$ be a smooth function. The value $u_{j} = u(x_{j})$ can be expanded around $x_{i+\\frac{1}{2}}$:\n$$\nu_{j} = u(x_{i+\\frac{1}{2}} + (j-i-\\frac{1}{2})\\Delta x) = \\sum_{k=0}^{\\infty} \\frac{u^{(k)}(x_{i+\\frac{1}{2}})}{k!} \\left((j-i-\\frac{1}{2})\\Delta x\\right)^k\n$$\nThe reconstruction $u_{i+\\frac{1}{2}}^{\\text{recon}}$ approximates the true value $u(x_{i+\\frac{1}{2}})$. The truncation error $E$ is $u_{i+\\frac{1}{2}}^{\\text{recon}} - u(x_{i+\\frac{1}{2}})$.\n$$\nE = \\left(\\sum_{j} c_{j} - 1\\right) u + \\left(\\sum_{j} c_{j} s_{j} \\right) u' \\Delta x + \\frac{1}{2!} \\left(\\sum_{j} c_{j} s_{j}^{2} \\right) u'' (\\Delta x)^{2} + \\frac{1}{3!} \\left(\\sum_{j} c_{j} s_{j}^{3} \\right) u''' (\\Delta x)^{3} + \\dots\n$$\nwhere $u$ and its derivatives are evaluated at $x_{i+\\frac{1}{2}}$, and $s_j$ are the non-dimensional distances of the grid points from the interface:\n-   $s_{i-2} = \\frac{x_{i-2} - x_{i+\\frac{1}{2}}}{\\Delta x} = (i-2) - (i+\\frac{1}{2}) = -\\frac{5}{2}$\n-   $s_{i-1} = \\frac{x_{i-1} - x_{i+\\frac{1}{2}}}{\\Delta x} = (i-1) - (i+\\frac{1}{2}) = -\\frac{3}{2}$\n-   $s_{i} = \\frac{x_{i} - x_{i+\\frac{1}{2}}}{\\Delta x} = i - (i+\\frac{1}{2}) = -\\frac{1}{2}$\n-   $s_{i+1} = \\frac{x_{i+1} - x_{i+\\frac{1}{2}}}{\\Delta x} = (i+1) - (i+\\frac{1}{2}) = \\frac{1}{2}$\n\nWe compute the moments $\\sum c_{j} s_{j}^{k}$:\n-   $k=0$: $\\sum c_{j} = \\frac{3 - 16 + 51 + 18}{56} = \\frac{56}{56} = 1$. The coefficient of $u$ in the error is $1-1=0$.\n-   $k=1$: $\\sum c_{j} s_{j} = \\frac{1}{56} \\left[ 3(-\\frac{5}{2}) - 16(-\\frac{3}{2}) + 51(-\\frac{1}{2}) + 18(\\frac{1}{2}) \\right] = \\frac{1}{112} [-15 + 48 - 51 + 18] = \\frac{0}{112} = 0$.\n-   $k=2$: $\\sum c_{j} s_{j}^{2} = \\frac{1}{56} \\left[ 3(-\\frac{5}{2})^{2} - 16(-\\frac{3}{2})^{2} + 51(-\\frac{1}{2})^{2} + 18(\\frac{1}{2})^{2} \\right] = \\frac{1}{56 \\cdot 4} [3(25) - 16(9) + 51(1) + 18(1)] = \\frac{1}{224} [75 - 144 + 51 + 18] = \\frac{144 - 144}{224} = 0$.\n-   $k=3$: $\\sum c_{j} s_{j}^{3} = \\frac{1}{56} \\left[ 3(-\\frac{5}{2})^{3} - 16(-\\frac{3}{2})^{3} + 51(-\\frac{1}{2})^{3} + 18(\\frac{1}{2})^{3} \\right] = \\frac{1}{56 \\cdot 8} [3(-125) - 16(-27) + 51(-1) + 18(1)] = \\frac{1}{448} [-375 + 432 - 51 + 18] = \\frac{450 - 426}{448} = \\frac{24}{448} = \\frac{3}{56}$.\n\nSince the moment for $k=3$ is the first non-zero moment, the leading term in the truncation error is:\n$$\nE = \\frac{1}{3!} \\left(\\sum_{j} c_{j} s_{j}^{3} \\right) u'''(\\Delta x)^{3} + O((\\Delta x)^{4}) = \\frac{1}{6} \\left(\\frac{3}{56}\\right) u'''(\\Delta x)^{3} + O((\\Delta x)^{4}) = \\frac{1}{112} u'''(\\Delta x)^{3} + O((\\Delta x)^{4})\n$$\nThe leading power of $\\Delta x$ in the truncation error is $3$. Therefore, the formal order of accuracy of the interface reconstruction is $p=3$.\n\nThe final answer combines the recomputed weights and the order of accuracy into a single row matrix: $(\\tilde{d}_{0}, \\tilde{d}_{1}, \\tilde{d}_{2}, p)$.\n$$\n(\\frac{1}{7}, \\frac{6}{7}, 0, 3)\n$$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{7} & \\frac{6}{7} & 0 & 3\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "This final practice integrates theory and implementation into a comprehensive numerical verification exercise. You will implement a full TENO5 scheme and use the Method of Manufactured Solutions (MMS) to conduct a grid refinement study, a standard and rigorous technique in code verification. This task allows you to numerically measure the scheme's order of accuracy under different conditions, including a case designed to deliberately trigger the order-reduction phenomenon, thereby confirming our theoretical understanding with computational results. ",
            "id": "3369896",
            "problem": "Consider the one-dimensional linear advection equation with periodic boundary conditions,\n$$\\frac{\\partial u}{\\partial t} + a \\frac{\\partial u}{\\partial x} = 0,$$\non the domain $[0,1]$ with constant advection speed $a>0$. Let a smooth manufactured solution be given by\n$$u(x,t) = \\sin\\left(2\\pi\\left(x - a t\\right)\\right) + 0.1 \\sin\\left(4\\pi\\left(x - a t\\right)\\right),$$\nand consider its time derivative at $t=0$, which satisfies\n$$\\left.\\frac{\\partial u}{\\partial t}\\right|_{t=0} = -a \\left.\\frac{\\partial u}{\\partial x}\\right|_{t=0}, \\quad \\left.\\frac{\\partial u}{\\partial x}\\right|_{t=0} = 2\\pi \\cos(2\\pi x) + 0.4\\pi \\cos(4\\pi x).$$\n\nA uniform grid with $N$ points is used, with grid spacing $\\Delta x = 1/N$ and grid nodes $x_i = i \\Delta x$ for $i = 0,1,\\dots,N-1$. Define a semi-discrete finite-difference flux-difference operator\n$$\\mathcal{L}_h(u)_i = -\\frac{F_{i+\\frac{1}{2}} - F_{i-\\frac{1}{2}}}{\\Delta x},$$\nwhere $F_{i+\\frac{1}{2}}$ is a numerical flux at interface $x_{i+\\frac{1}{2}}$. For $a>0$, use a left-biased reconstruction of $u$ to obtain $u_{i+\\frac{1}{2}}^{-}$ and set $F_{i+\\frac{1}{2}} = a\\,u_{i+\\frac{1}{2}}^{-}$. The reconstruction must employ the fifth-order Targeted Essentially Non-Oscillatory (TENO) scheme (TENO5). The TENO5 reconstruction at $x_{i+\\frac{1}{2}}$ uses three three-point sub-stencils,\n$$S_0=\\{i-2,i-1,i\\},\\quad S_1=\\{i-1,i,i+1\\},\\quad S_2=\\{i,i+1,i+2\\},$$\nwith the following candidate interface values,\n$$p_0 = \\frac{2u_{i-2} - 7u_{i-1} + 11u_i}{6},\\quad p_1 = \\frac{-u_{i-1} + 5u_i + 2u_{i+1}}{6},\\quad p_2 = \\frac{2u_i + 5u_{i+1} - u_{i+2}}{6},$$\nand corresponding linear weights\n$$d_0 = \\frac{1}{10},\\quad d_1 = \\frac{6}{10},\\quad d_2 = \\frac{3}{10}.$$\nThe Jiangâ€“Shu smoothness indicators are\n$$\\beta_0 = \\frac{13}{12}(u_{i-2} - 2u_{i-1} + u_i)^2 + \\frac{1}{4}(u_{i-2} - 4u_{i-1} + 3u_i)^2,$$\n$$\\beta_1 = \\frac{13}{12}(u_{i-1} - 2u_i + u_{i+1})^2 + \\frac{1}{4}(u_{i-1} - u_{i+1})^2,$$\n$$\\beta_2 = \\frac{13}{12}(u_i - 2u_{i+1} + u_{i+2})^2 + \\frac{1}{4}(3u_i - 4u_{i+1} + u_{i+2})^2,$$\nand the global smoothness indicator is\n$$\\tau_5 = |\\beta_0 - \\beta_2|.$$\nDefine WENO-Z-like pre-weights with exponent $q$ and small parameter $\\epsilon$ as\n$$\\tilde{w}_k = d_k \\left(1 + \\left(\\frac{\\tau_5}{\\beta_k + \\epsilon}\\right)^q\\right), \\quad k\\in\\{0,1,2\\},$$\nthen normalize to obtain\n$$w_k = \\frac{\\tilde{w}_k}{\\sum_{j=0}^{2} \\tilde{w}_j}.$$\nThe TENO stencil-rejection mechanism introduces a cutoff $C_T \\in (0,1)$ and defines a binary selector\n$$\\chi_k = \\begin{cases}\n1, & w_k \\ge C_T,\\\\\n0, & w_k < C_T.\n\\end{cases}$$\nThe final TENO weights are\n$$\\alpha_k = \\frac{d_k \\chi_k}{\\sum_{j=0}^{2} d_j \\chi_j},$$\nwith the convention that if $\\sum_{j=0}^{2} d_j \\chi_j = 0$, then no stencil is selected and one falls back to the linear weights, that is, $\\alpha_k = d_k$. The reconstructed interface value is\n$$u_{i+\\frac{1}{2}}^{-} = \\sum_{k=0}^{2} \\alpha_k\\, p_k.$$\n\nDefine the residual-based error at grid node $x_i$ by\n$$\\mathcal{E}_i = \\mathcal{L}_h(u)_i - \\left.\\frac{\\partial u}{\\partial t}\\right|_{t=0,i},$$\nand measure the discrete $L^1$-norm of the residual\n$$E(N) = \\sum_{i=0}^{N-1} |\\mathcal{E}_i| \\,\\Delta x.$$\nAssume periodic extension for all indices outside $[0,N-1]$.\n\nImplement a program that, for a set of grid sizes and three reconstruction modes, computes the experimental order of accuracy by least-squares fitting of $\\log(E(N))$ versus $\\log(\\Delta x)$ to a line whose slope is the observed order. The three modes are:\n- Mode A (TENO5 standard): Targeted Essentially Non-Oscillatory with cutoff $C_T = 0.01$, exponent $q = 6$, small parameter $\\epsilon = 10^{-40}$, and $a = 1$.\n- Mode B (Linear5 no-rejection): No stencil rejection, that is, set $\\chi_k = 1$ for all $k$, with the same $a = 1$.\n- Mode C (Aggressive TENO5): Same as Mode A but with a larger cutoff $C_T = 0.2$ to induce stencil rejection in smooth regions.\n\nUse the grid sizes $N \\in \\{40,80,160,320\\}$. For each mode, compute the list of residual norms $E(N)$ for all $N$ and determine the observed order as the slope of the best-fit line in the $\\left(\\log(\\Delta x), \\log(E(N))\\right)$ space.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order $\\left[\\text{order}_{\\text{A}}, \\text{order}_{\\text{B}}, \\text{order}_{\\text{C}}\\right]$, where each entry is a floating-point number. For example, a valid output format is $[\\text{float},\\text{float},\\text{float}]$.\n\nTest suite to implement:\n- Manufactured solution parameters: amplitudes $1$ and $0.1$, wavenumbers $2\\pi$ and $4\\pi$, advection speed $a=1$.\n- Modes and parameters: Mode A with $C_T=0.01$, $q=6$, $\\epsilon=10^{-40}$; Mode B with no rejection; Mode C with $C_T=0.2$, $q=6$, $\\epsilon=10^{-40}$.\n- Grid sizes: $N=\\{40,80,160,320\\}$.\n\nAll numerical results are dimensionless; no physical units are required. The final outputs must be floating-point numbers. The residual-based observed orders for the three modes must be reported in the single-line format specified above.",
            "solution": "The problem requires the implementation and verification of a fifth-order Targeted Essentially Non-Oscillatory (TENO5) scheme for the one-dimensional linear advection equation, $\\frac{\\partial u}{\\partial t} + a \\frac{\\partial u}{\\partial x} = 0$, with a constant advection speed $a > 0$. The verification is performed using the Method of Manufactured Solutions (MMS), where a smooth analytical solution is prescribed and substituted into the governing equation to define source terms or, as in this case, initial and exact derivative values. The goal is to compute the experimental order of accuracy of the numerical discretization.\n\nThe problem is discretized on a uniform grid with $N$ points $x_i = i \\Delta x$, where $\\Delta x = 1/N$. The semi-discrete form of the PDE at each grid node $i$ is $\\frac{d u_i}{dt} = \\mathcal{L}_h(u)_i$, where $\\mathcal{L}_h(u)_i$ is a numerical approximation to the spatial derivative term $-a \\frac{\\partial u}{\\partial x}$. For this problem, $\\mathcal{L}_h(u)_i$ is defined by a conservative finite-difference flux-difference formula:\n$$\n\\mathcal{L}_h(u)_i = -\\frac{F_{i+\\frac{1}{2}} - F_{i-\\frac{1}{2}}}{\\Delta x}\n$$\nThe numerical flux $F_{i+\\frac{1}{2}}$ at the interface $x_{i+\\frac{1}{2}}$ between cells $i$ and $i+1$ is determined using an upwind approach. Since the advection speed $a > 0$, information propagates from left to right, and the flux is defined as $F_{i+\\frac{1}{2}} = a\\,u_{i+\\frac{1}{2}}^{-}$, where $u_{i+\\frac{1}{2}}^{-}$ is a high-order reconstruction of the solution $u$ at the interface, using data from upwind stencils.\n\nThe core of the problem lies in computing this reconstructed value $u_{i+\\frac{1}{2}}^{-}$ using the TENO5 scheme. This scheme is designed to achieve high order in smooth regions of the solution while avoiding spurious oscillations near discontinuities. It operates in several steps:\n1.  **Candidate Stencils**: For a fifth-order reconstruction, a five-point stencil is required. TENO5 builds upon the foundation of WENO schemes by considering three smaller, three-point sub-stencils: $S_0=\\{i-2,i-1,i\\}$, $S_1=\\{i-1,i,i+1\\}$, and $S_2=\\{i,i+1,i+2\\}$. Each sub-stencil $S_k$ is used to construct a quadratic polynomial, which is then evaluated at the interface $x_{i+\\frac{1}{2}}$ to yield a candidate reconstruction $p_k$. A specific linear combination of these candidates, $u_{lin} = \\sum_{k=0}^{2} d_k p_k$, where $d_k$ are the optimal linear weights, recovers the fifth-order upwind reconstruction. For the given left-biased stencil, the weights are $d_0=0.1$, $d_1=0.6$, and $d_2=0.3$.\n\n2.  **Smoothness Measurement**: The smoothness of the solution within each sub-stencil $S_k$ is measured by the Jiang-Shu smoothness indicators, $\\beta_k$. These are sums of squared scaled derivatives of the interpolating polynomials for each stencil. In smooth regions, $\\beta_k = O((\\Delta x)^4)$.\n\n3.  **Non-Linear Weight Calculation**: The TENO5 scheme, like WENO schemes, computes non-linear weights $w_k$ that depend on the smoothness indicators $\\beta_k$. A large $\\beta_k$ (indicating a less smooth stencil, possibly containing a shock) results in a small $w_k$. The problem specifies WENO-Z-like weights, which also incorporate a global smoothness indicator $\\tau_5 = |\\beta_0 - \\beta_2|$, improving accuracy near critical points.\n\n4.  **Stencil Selection (The TENO Mechanism)**: This is the defining feature of TENO. Instead of blending all candidate stencils like WENO, TENO aims to use the optimal linear weights if the solution is smooth and discard stencils that are contaminated by discontinuities. A binary selector $\\chi_k$ is defined based on a cutoff threshold $C_T$:\n    $$\n    \\chi_k = \\begin{cases} 1, & w_k \\ge C_T \\\\ 0, & w_k < C_T \\end{cases}\n    $$\n    This acts as a filter. If a stencil's non-linear weight $w_k$ is greater than or equal to the threshold, it is considered \"good enough\" to be included in the final reconstruction.\n\n5.  **Final Reconstruction**: The final TENO weights, $\\alpha_k$, are obtained by renormalizing the linear weights of the selected stencils: $\\alpha_k = d_k \\chi_k / \\sum_j d_j \\chi_j$. If no stencils are selected (i.e., $\\sum_j d_j \\chi_j = 0$), the scheme falls back to the fifth-order linear scheme ($\\alpha_k=d_k$) to ensure robustness. The final reconstructed value is $u_{i+\\frac{1}{2}}^{-} = \\sum_{k=0}^{2} \\alpha_k p_k$.\n\nThe error is quantified by the residual $\\mathcal{E}_i = \\mathcal{L}_h(u)_i - \\left.\\frac{\\partial u}{\\partial t}\\right|_{t=0,i}$, where the values for $u$ in $\\mathcal{L}_h(u)_i$ and the exact derivative $\\left.\\frac{\\partial u}{\\partial t}\\right|_{t=0,i}$ are obtained from the manufactured solution $u(x,t) = \\sin(2\\pi(x - at)) + 0.1 \\sin(4\\pi(x - at))$ at time $t=0$. The overall error is the discrete $L^1$-norm, $E(N) = \\sum_{i=0}^{N-1} |\\mathcal{E}_i| \\,\\Delta x$.\n\nThe order of accuracy, $p$, is determined experimentally from the relation $E(N) \\approx C (\\Delta x)^p$, which implies $\\log(E) \\approx \\log(C) + p \\log(\\Delta x)$. By computing $E(N)$ for a sequence of grid sizes $N \\in \\{40,80,160,320\\}$, we can perform a linear least-squares regression on the $(\\log(\\Delta x), \\log(E))$ data. The slope of the resulting line is the experimental order of accuracy $p$.\n\nThe three modes test different aspects of the scheme:\n-   **Mode A (TENO5 standard)**: With $C_T=0.01$, all linear weights $d_k$ are larger than $C_T$. For a smooth solution, the non-linear weights $w_k$ will converge to $d_k$. Thus, all stencils will be selected ($\\chi_k=1$), and the scheme will revert to the fifth-order linear scheme, yielding an expected order of accuracy close to $5$.\n-   **Mode B (Linear5 no-rejection)**: This mode forces $\\chi_k=1$, making $\\alpha_k = d_k$ explicitly. This is the pure fifth-order upwind linear scheme, which should demonstrate an order of accuracy of $5$.\n-   **Mode C (Aggressive TENO5)**: With a high cutoff $C_T=0.2$, the linear weight $d_0=0.1$ is smaller than $C_T$. In smooth regions, $w_0 \\approx d_0$, leading to the rejection of stencil $S_0$ ($\\chi_0=0$). The final reconstruction is then formed from a re-weighting of $p_1$ and $p_2$, which, as can be shown by Taylor series analysis, degrades the local reconstruction to second-order accuracy. This is expected to result in an overall scheme accuracy of order $2$.\n\nThe implementation will be vectorized using `numpy` for efficiency. For each mode, the $L^1$ error will be calculated for each grid size. Then, `scipy.stats.linregress` will be used to find the slope of the log-log error plot, which provides the desired order of accuracy.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import stats\n\ndef solve():\n    \"\"\"\n    Computes the experimental order of accuracy for TENO5 and related schemes\n    applied to the 1D linear advection equation using a manufactured solution.\n    \"\"\"\n\n    # --------------- Helper Functions ---------------\n\n    def u_exact(x, t, a):\n        \"\"\"Calculates the manufactured solution u(x,t).\"\"\"\n        return np.sin(2 * np.pi * (x - a * t)) + 0.1 * np.sin(4 * np.pi * (x - a * t))\n\n    def dudt_exact_t0(x, a):\n        \"\"\"Calculates the exact time derivative at t=0.\"\"\"\n        # dudx at t=0\n        dudx_t0 = 2 * np.pi * np.cos(2 * np.pi * x) + 0.4 * np.pi * np.cos(4 * np.pi * x)\n        # dudt = -a * dudx\n        return -a * dudx_t0\n\n    def compute_l1_residual(N, mode_params):\n        \"\"\"\n        Computes the L1-norm of the residual for a given grid size N and scheme mode.\n        \"\"\"\n        a = mode_params['a']\n        CT = mode_params['CT']\n        q = mode_params['q']\n        eps = mode_params['eps']\n        no_rejection = mode_params.get('no_rejection', False)\n\n        # 1. Grid and Initial Condition\n        dx = 1.0 / N\n        x = np.arange(N) * dx\n        u0 = u_exact(x, 0, a)\n        dudt_grid = dudt_exact_t0(x, a)\n\n        # 2. Vectorized Reconstruction\n        # Get stencil values with periodic boundary conditions using np.roll\n        u_im2 = np.roll(u0, 2)\n        u_im1 = np.roll(u0, 1)\n        u_i = u0\n        u_ip1 = np.roll(u0, -1)\n        u_ip2 = np.roll(u0, -2)\n\n        # Candidate reconstructions (polynomials p_k)\n        p0 = (2*u_im2 - 7*u_im1 + 11*u_i) / 6.0\n        p1 = (-u_im1 + 5*u_i + 2*u_ip1) / 6.0\n        p2 = (2*u_i + 5*u_ip1 - u_ip2) / 6.0\n        p_matrix = np.vstack([p0, p1, p2])\n\n        # Linear weights\n        d_weights = np.array([0.1, 0.6, 0.3]).reshape(3, 1)\n\n        if no_rejection:\n            # Mode B: corresponds to a standard 5th-order linear upwind scheme\n            alpha_weights = d_weights\n        else:\n            # Modes A and C: TENO5 scheme logic\n            # Smoothness indicators beta_k\n            b0 = (13./12.) * (u_im2 - 2*u_im1 + u_i)**2 + 0.25 * (u_im2 - 4*u_im1 + 3*u_i)**2\n            b1 = (13./12.) * (u_im1 - 2*u_i + u_ip1)**2 + 0.25 * (u_im1 - u_ip1)**2\n            b2 = (13./12.) * (u_i - 2*u_ip1 + u_ip2)**2 + 0.25 * (3*u_i - 4*u_ip1 + u_ip2)**2\n            beta_matrix = np.vstack([b0, b1, b2])\n\n            # Global smoothness indicator tau_5\n            tau5 = np.abs(b0 - b2)\n\n            # WENO-Z-like unnormalized weights\n            w_tilde = d_weights * (1.0 + (tau5 / (beta_matrix + eps))**q)\n            \n            # Normalized weights w_k\n            w_sum = np.sum(w_tilde, axis=0)\n            w_sum[w_sum == 0] = 1.0  # Avoid division by zero\n            w = w_tilde / w_sum\n\n            # TENO selector chi_k\n            chi = (w >= CT).astype(float)\n            \n            # Final TENO weights alpha_k\n            d_chi = d_weights * chi\n            sum_d_chi = np.sum(d_chi, axis=0)\n            \n            alpha_weights = np.zeros_like(d_chi)\n            \n            # Identify indices for fallback and standard TENO\n            zero_mask = (sum_d_chi == 0)\n            nonzero_mask = ~zero_mask\n            \n            # Apply TENO weights for non-fallback cases\n            if np.any(nonzero_mask):\n                alpha_weights[:, nonzero_mask] = d_chi[:, nonzero_mask] / sum_d_chi[nonzero_mask]\n            \n            # Apply fallback (linear weights) where no stencils were selected\n            if np.any(zero_mask):\n                alpha_weights[:, zero_mask] = d_weights\n\n        # 3. Compute Fluxes and Residual\n        # Reconstructed interface values u_{i+1/2}^{-}\n        u_iphalf = np.sum(alpha_weights * p_matrix, axis=0)\n\n        # Numerical fluxes F_{i+1/2}\n        F_iphalf = a * u_iphalf\n        \n        # Fluxes at i-1/2 are a periodic shift of F_{i+1/2}\n        F_imhalf = np.roll(F_iphalf, 1)\n        \n        # Semi-discrete operator L_h(u)\n        Lh = -(F_iphalf - F_imhalf) / dx\n        \n        # Residual error at each node\n        error_i = Lh - dudt_grid\n        \n        # L1 norm of the residual\n        l1_norm = np.sum(np.abs(error_i)) * dx\n        \n        return l1_norm\n\n    # ------------------- Main Logic -------------------\n\n    # Define the grid sizes for the convergence study\n    N_vals = np.array([40, 80, 160, 320])\n    dx_vals = 1.0 / N_vals\n    \n    # Define the parameters for the three test modes\n    test_cases = [\n        {'name': 'A', 'a': 1.0, 'CT': 0.01, 'q': 6, 'eps': 1e-40},\n        {'name': 'B', 'a': 1.0, 'no_rejection': True, 'CT': 0, 'q': 1, 'eps': 1e-40},\n        {'name': 'C', 'a': 1.0, 'CT': 0.2, 'q': 6, 'eps': 1e-40},\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        errors = []\n        for N in N_vals:\n            error = compute_l1_residual(N, case)\n            errors.append(error)\n        \n        errors = np.array(errors)\n        \n        # Perform linear regression on log-log data to find the order of accuracy\n        log_dx = np.log(dx_vals)\n        log_errors = np.log(errors)\n        \n        # The slope of the line is the experimental order of accuracy\n        slope, _, _, _, _ = stats.linregress(log_dx, log_errors)\n        \n        results.append(slope)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}