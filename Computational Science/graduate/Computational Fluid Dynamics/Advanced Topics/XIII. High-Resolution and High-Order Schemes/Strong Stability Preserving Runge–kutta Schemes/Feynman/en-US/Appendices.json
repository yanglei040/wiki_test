{
    "hands_on_practices": [
        {
            "introduction": "This first practice is about understanding Strong Stability Preserving (SSP) schemes from the ground up. The core principle of SSP methods is that a high-order scheme can be written as a convex combination of stable, first-order forward Euler steps. This exercise  will guide you through deriving the stability condition for a popular third-order SSP Runge-Kutta method by recasting it into its fundamental Euler components, solidifying your understanding of the SSP coefficient.",
            "id": "3350094",
            "problem": "Consider the one-dimensional linear advection equation $u_{t} + a\\,u_{x} = 0$ on a periodic domain discretized on a uniform mesh of spacing $\\Delta x$, with a conservative first-order upwind finite-volume approximation for $a>0$. The semi-discrete system at cell centers is\n$$\n\\frac{d u_{i}}{dt} \\;=\\; \\mathcal{N}(u)_i \\;=\\; -\\frac{a}{\\Delta x}\\left(u_{i} - u_{i-1}\\right).\n$$\nLet the numerical solution be advanced in time using the standard three-stage third-order Strong Stability Preserving (SSP) Runge-Kutta (RK) method in Shu-Osher form. Assume that forward Euler is strongly stable (for example, nonincreasing in a convex monotonicity norm such as total variation) under the time-step restriction $\\Delta t \\le \\Delta t_{\\mathrm{FE}}$, where for this spatial discretization $\\Delta t_{\\mathrm{FE}} = \\Delta x/a$.\n\nStarting only from the foundational definition of Strong Stability Preserving (SSP) time integrators as convex combinations of forward Euler steps applied to the semi-discrete operator $\\mathcal{N}(\\cdot)$, do the following:\n\n1. Write the three-stage third-order SSP Runge-Kutta scheme applied to $\\dot{u}=\\mathcal{N}(u)$ in Shu-Osher form.\n2. Recast each stage as an explicit convex combination of either the current state or a forward Euler update with the same time step $\\Delta t$.\n3. Using this representation and the given forward Euler strong-stability bound $\\Delta t \\le \\Delta t_{\\mathrm{FE}}$, derive the largest allowable $\\Delta t$ such that the same strong-stability property is guaranteed for the three-stage third-order SSP Runge-Kutta method.\n4. Evaluate this allowable time step for $a = 1.7\\,\\mathrm{m/s}$ and $\\Delta x = 6.2 \\times 10^{-3}\\,\\mathrm{m}$.\n\nExpress the final allowable time step in seconds and round your answer to four significant figures.",
            "solution": "The problem requires the derivation of the strong stability time step restriction for a specific three-stage, third-order Strong Stability Preserving (SSP) Runge-Kutta method applied to a semi-discrete system, starting from the foundational definition of SSP methods.\n\nThe problem is first validated.\n\n### Step 1: Extract Givens\n- **Governing Equation**: One-dimensional linear advection equation, $u_{t} + a\\,u_{x} = 0$, with $a > 0$.\n- **Domain and Mesh**: Periodic domain, uniform mesh with spacing $\\Delta x$.\n- **Spatial Discretization**: Conservative first-order upwind finite-volume approximation.\n- **Semi-Discrete System**: $\\frac{d u_{i}}{dt} = \\mathcal{N}(u)_i = -\\frac{a}{\\Delta x}\\left(u_{i} - u_{i-1}\\right)$.\n- **Time Integrator**: Standard three-stage third-order SSP Runge-Kutta (SSP(3,3)) method in Shu-Osher form.\n- **Forward Euler Stability**: The forward Euler method, $u^{n+1} = u^n + \\Delta t \\mathcal{N}(u^n)$, is strongly stable (e.g., total variation non-increasing) if its time step $\\Delta t$ satisfies $\\Delta t \\le \\Delta t_{\\mathrm{FE}}$, where $\\Delta t_{\\mathrm{FE}} = \\frac{\\Delta x}{a}$.\n- **Numerical Values**: $a = 1.7\\,\\mathrm{m/s}$ and $\\Delta x = 6.2 \\times 10^{-3}\\,\\mathrm{m}$.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem is based on standard, well-established concepts in numerical analysis and computational fluid dynamics, including the linear advection equation, finite-volume methods, upwind schemes, and SSP Runge-Kutta methods. The formulation is correct and physically sound.\n- **Well-Posed**: The problem is well-posed. It provides a clear set of definitions and a known stable method (Forward Euler) as a building block. The task is to derive the stability limit for a more complex method constructed from these blocks, which leads to a unique, meaningful solution.\n- **Objective**: The problem is stated in precise, objective mathematical language, free of ambiguity or subjective claims.\n\n### Step 3: Verdict and Action\nThe problem is scientifically grounded, well-posed, objective, and self-contained. It is therefore deemed **valid**. A full solution will be provided.\n\n### Solution Derivation\n\nThe solution proceeds by following the four steps outlined in the problem statement.\n\n**1. The SSP(3,3) Runge-Kutta Scheme in Shu-Osher Form**\n\nThe task is to apply the specified time integrator to the general semi-discrete ordinary differential equation (ODE) system $\\frac{du}{dt} = \\mathcal{N}(u)$, where $u$ represents the vector of cell-centered values $\\{u_i\\}$. The standard three-stage, third-order SSP Runge-Kutta scheme, often denoted SSP(3,3), is given in the Shu-Osher form as follows:\n$$u^{(0)} = u^n$$\n$$u^{(1)} = u^{(0)} + \\Delta t \\, \\mathcal{N}(u^{(0)})$$\n$$u^{(2)} = \\frac{3}{4} u^{(0)} + \\frac{1}{4} \\left( u^{(1)} + \\Delta t \\, \\mathcal{N}(u^{(1)}) \\right)$$\n$$u^{n+1} = \\frac{1}{3} u^{(0)} + \\frac{2}{3} \\left( u^{(2)} + \\Delta t \\, \\mathcal{N}(u^{(2)}) \\right)$$\nwhere $u^n$ is the solution at time $t_n$, and $u^{n+1}$ is the solution at the next time level, $t_{n+1} = t_n + \\Delta t$. The vectors $u^{(1)}$ and $u^{(2)}$ represent intermediate stage values.\n\n**2. Recasting Stages as Convex Combinations of Forward Euler Steps**\n\nThe foundational principle of SSP methods is that they can be expressed as a convex combination of forward Euler steps. A method is a convex combination if it can be written in the form $\\sum_{k} \\alpha_k \\mathcal{O}_k$, where the operators $\\mathcal{O}_k$ are themselves strongly stable and the coefficients satisfy $\\alpha_k \\ge 0$ and $\\sum_k \\alpha_k = 1$. The base stable operator is the forward Euler (FE) step.\n\nLet's define the forward Euler operator with a time step $\\delta t$ as:\n$$E(w; \\delta t) = w + \\delta t \\, \\mathcal{N}(w)$$\nThe problem states that this operator is strongly stable under some convex semi-norm $\\|\\cdot\\|$ (e.g., total variation, $\\|u\\|_{\\text{TV}} = \\sum_i |u_{i+1}-u_i|$), meaning $\\|E(w; \\delta t)\\| \\le \\|w\\|$, provided that $\\delta t \\le \\Delta t_{\\mathrm{FE}}$.\n\nWe now recast each stage of the SSP(3,3) scheme using this operator.\n\n*   **Stage 1:**\n    The first stage is already in the form of a forward Euler step applied to $u^n = u^{(0)}$ with a time step $\\Delta t$:\n    $$u^{(1)} = u^{(0)} + \\Delta t \\, \\mathcal{N}(u^{(0)}) = E(u^{(0)}; \\Delta t)$$\n    This is a trivial convex combination. For this step to be stable, we must have $\\Delta t \\le \\Delta t_{\\mathrm{FE}}$.\n\n*   **Stage 2:**\n    The second stage is:\n    $$u^{(2)} = \\frac{3}{4} u^{(0)} + \\frac{1}{4} \\left( u^{(1)} + \\Delta t \\, \\mathcal{N}(u^{(1)}) \\right)$$\n    Recognizing the term in parentheses as a forward Euler step on $u^{(1)}$ with time step $\\Delta t$, we can write:\n    $$u^{(2)} = \\frac{3}{4} u^{(0)} + \\frac{1}{4} E(u^{(1)}; \\Delta t)$$\n    This expression represents $u^{(2)}$ as a convex combination of the states $u^{(0)}$ and $E(u^{(1)}; \\Delta t)$, since the coefficients are non-negative ($\\frac{3}{4} \\ge 0, \\frac{1}{4} \\ge 0$) and sum to unity ($\\frac{3}{4} + \\frac{1}{4} = 1$). For the overall stage to preserve stability, the operator $E(u^{(1)}; \\Delta t)$ must be stable. This requires its time step $\\Delta t$ to satisfy $\\Delta t \\le \\Delta t_{\\mathrm{FE}}$.\n\n*   **Stage 3 (Final Stage):**\n    The final stage gives the new solution $u^{n+1}$:\n    $$u^{n+1} = \\frac{1}{3} u^{(0)} + \\frac{2}{3} \\left( u^{(2)} + \\Delta t \\, \\mathcal{N}(u^{(2)}) \\right)$$\n    Similarly, we identify the term in parentheses as a forward Euler step on $u^{(2)}$ with time step $\\Delta t$:\n    $$u^{n+1} = \\frac{1}{3} u^{(0)} + \\frac{2}{3} E(u^{(2)}; \\Delta t)$$\n    This expresses $u^{n+1}$ as a convex combination of $u^{(0)}$ and $E(u^{(2)}; \\Delta t)$, with non-negative coefficients ($\\frac{1}{3} \\ge 0, \\frac{2}{3} \\ge 0$) that sum to unity ($\\frac{1}{3} + \\frac{2}{3} = 1$). For this step to preserve stability, the operator $E(u^{(2)}; \\Delta t)$ must be stable, which demands that its time step $\\Delta t$ satisfies $\\Delta t \\le \\Delta t_{\\mathrm{FE}}$.\n\n**3. Derivation of the Largest Allowable Time Step**\n\nThe stability of the entire SSP(3,3) method requires that every forward Euler operation within its structure is stable. We have analyzed each stage and found that the forward Euler operator $E$ is always applied with the full time step $\\Delta t$ of the Runge-Kutta method.\n\n- From Stage 1, we require $\\Delta t \\le \\Delta t_{\\mathrm{FE}}$.\n- From Stage 2, we require $\\Delta t \\le \\Delta t_{\\mathrm{FE}}$.\n- From Stage 3, we require $\\Delta t \\le \\Delta t_{\\mathrm{FE}}$.\n\nTo satisfy all these conditions simultaneously, the time step $\\Delta t$ must be bounded by the most restrictive of these constraints. Since all constraints are identical, the overall stability condition for the SSP(3,3) method is:\n$$\\Delta t \\le \\Delta t_{\\mathrm{FE}}$$\nThe largest allowable time step, $\\Delta t_{\\max}$, is therefore equal to the forward Euler stability limit:\n$$\\Delta t_{\\max} = \\Delta t_{\\mathrm{FE}}$$\nThis result means that the SSP coefficient for this particular third-order Runge-Kutta scheme is $C=1$.\n\n**4. Evaluation of the Allowable Time Step**\n\nThe problem provides the expression for the forward Euler stability limit for the given spatial discretization:\n$$\\Delta t_{\\mathrm{FE}} = \\frac{\\Delta x}{a}$$\nTherefore, the largest allowable time step for the SSP(3,3) method is:\n$$\\Delta t_{\\max} = \\frac{\\Delta x}{a}$$\nWe are given the numerical values $a = 1.7\\,\\mathrm{m/s}$ and $\\Delta x = 6.2 \\times 10^{-3}\\,\\mathrm{m}$. Substituting these values, we get:\n$$\\Delta t_{\\max} = \\frac{6.2 \\times 10^{-3}\\,\\mathrm{m}}{1.7\\,\\mathrm{m/s}}$$\n$$\\Delta t_{\\max} \\approx 3.6470588... \\times 10^{-3}\\,\\mathrm{s}$$\nRounding the result to four significant figures, as requested:\n$$\\Delta t_{\\max} \\approx 3.647 \\times 10^{-3}\\,\\mathrm{s}$$",
            "answer": "$$\\boxed{3.647 \\times 10^{-3}}$$"
        },
        {
            "introduction": "Having understood the theoretical construction of SSP schemes, it is crucial to see why they are indispensable in practice, especially for advection-dominated problems. This computational exercise  directly contrasts a second-order SSP Runge-Kutta method with a non-SSP counterpart for solving a simple advection equation. By observing the behavior of each scheme, you will gain a tangible appreciation for how SSP methods preserve physical properties like the maximum principle, preventing the formation of non-physical oscillations that can corrupt a simulation.",
            "id": "3287729",
            "problem": "Consider the scalar conservation law $u_t + f(u)_x = 0$ on a periodic one-dimensional domain with $x \\in [0,1]$. Discretize the spatial domain into $N$ uniform cells with $\\Delta x = 1/N$, and denote by $u_j(t)$ the cell-average approximation in cell index $j$ at time $t$, with periodic indexing. Use a finite volume semi-discretization with a monotone numerical flux $\\hat{f}$ so that the semi-discrete operator $L(u)$ is defined componentwise by\n$$\n\\left[L(u)\\right]_j = -\\frac{\\hat{f}_{j+1/2} - \\hat{f}_{j-1/2}}{\\Delta x}.\n$$\nLet the physical flux be $f(u) = a\\,u$, where $a$ is a constant advection speed. Use the local Lax-Friedrichs flux, which for this linear flux reduces to the first-order upwind flux:\n- If $a > 0$, set $\\hat{f}_{j+1/2} = a\\,u_j$.\n- If $a < 0$, set $\\hat{f}_{j+1/2} = a\\,u_{j+1}$.\nThis yields a monotone semi-discrete operator.\n\nInitialize the data with a single-cell spike respecting the maximum principle bounds:\n$$\nu_j^0 = \\begin{cases}\n1 & \\text{if } j = j^\\star,\\\\\n0 & \\text{otherwise},\n\\end{cases}\n$$\nwhere $j^\\star = \\lfloor N/2 \\rfloor$.\n\nDefine the Courant-Friedrichs-Lewy number by $r = \\frac{|a|\\,\\Delta t}{\\Delta x}$, and compute the time step $\\Delta t = r\\,\\frac{\\Delta x}{|a|}$.\n\nImplement two explicit Runge-Kutta time integrators for a single time step:\n1. The explicit midpoint method (second-order, non-Strong Stability Preserving):\n   - Stage $1$: $u^{(1)} = u^n + \\Delta t\\,L(u^n)$,\n   - Update: $u^{n+1} = u^n + \\Delta t\\,L(u^{(1)})$.\n2. The Strong Stability Preserving (SSP) Runge-Kutta method of order two (Heun's method):\n   - Stage $1$: $u^{(1)} = u^n + \\Delta t\\,L(u^n)$,\n   - Stage $2$: $\\tilde{u}^{(2)} = u^{(1)} + \\Delta t\\,L(u^{(1)})$,\n   - Update: $u^{n+1} = \\tfrac{1}{2}\\,u^n + \\tfrac{1}{2}\\,\\tilde{u}^{(2)}$.\n\nFor each test case below, perform exactly one time step with each integrator starting from the specified initial data and spatial discretization. For each resulting solution $u^{n+1}$, check the maximum principle with respect to the initial bounds $[0,1]$:\n- Compute $\\min_j u_j^{n+1}$ and $\\max_j u_j^{n+1}$.\n- Declare the maximum principle preserved if $\\min_j u_j^{n+1} \\ge 0$ and $\\max_j u_j^{n+1} \\le 1$ (use a numerical tolerance of $10^{-12}$ for these comparisons).\n\nTest suite:\n- Use $N = 100$ and $j^\\star = \\lfloor N/2 \\rfloor$ for all tests.\n- Consider the following $(a,r)$ pairs:\n  1. $(a,r) = (1.0, 0.25)$,\n  2. $(a,r) = (1.0, 0.50)$,\n  3. $(a,r) = (1.0, 0.60)$,\n  4. $(a,r) = (1.0, 0.95)$,\n  5. $(a,r) = (-1.0, 0.60)$,\n  6. $(a,r) = (1.0, 1.05)$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with two boolean entries per test case indicating whether the maximum principle is preserved for the explicit midpoint method and the Strong Stability Preserving (SSP) Runge-Kutta method of order two, respectively. The final output must be in the exact order of the test suite and method pairing, namely:\n$$\n\\left[\\text{MP}_{\\text{midpoint},1},\\text{MP}_{\\text{SSP2},1},\\text{MP}_{\\text{midpoint},2},\\text{MP}_{\\text{SSP2},2},\\ldots,\\text{MP}_{\\text{midpoint},6},\\text{MP}_{\\text{SSP2},6}\\right],\n$$\nwhere $\\text{MP}_{\\text{method},k}$ is the boolean result for the $k$-th test case and the specified method. No physical units are involved; all quantities are dimensionless.",
            "solution": "The problem requires an analysis of the maximum principle preservation property for two different second-order explicit Runge-Kutta time integration schemes applied to a semi-discretized linear advection equation. The analysis will be performed by implementing the schemes and testing them against a suite of parameters.\n\nThe governing partial differential equation is the scalar linear advection equation, a specific form of a conservation law:\n$$\n\\frac{\\partial u}{\\partial t} + \\frac{\\partial f(u)}{\\partial x} = 0\n$$\nwhere the physical flux function is $f(u) = a\\,u$, with $a$ being a constant advection speed. The spatial domain is $x \\in [0,1]$ with periodic boundary conditions.\n\nThe domain is discretized into $N$ uniform cells of width $\\Delta x = 1/N$. The solution within each cell $j$ is represented by its cell average, $u_j(t)$. The semi-discrete form of the equation, using a finite volume method, is:\n$$\n\\frac{du_j}{dt} = L(u)_j = -\\frac{\\hat{f}_{j+1/2} - \\hat{f}_{j-1/2}}{\\Delta x}\n$$\nwhere $\\hat{f}_{j+1/2}$ is the numerical flux at the interface between cell $j$ and cell $j+1$. The problem specifies the first-order upwind flux, which depends on the sign of the advection speed $a$.\n\nCase 1: $a > 0$ (advection to the right)\nThe flux at the interface $j+1/2$ is determined by the value in the upwind cell, which is cell $j$.\n$$\n\\hat{f}_{j+1/2} = a\\,u_j\n$$\nThe semi-discrete operator for cell $j$ becomes:\n$$\nL(u)_j = -\\frac{a\\,u_j - a\\,u_{j-1}}{\\Delta x} = -\\frac{a}{\\Delta x}(u_j - u_{j-1})\n$$\n\nCase 2: $a < 0$ (advection to the left)\nThe flux at the interface $j+1/2$ is determined by the value in the upwind cell, which is cell $j+1$.\n$$\n\\hat{f}_{j+1/2} = a\\,u_{j+1}\n$$\nThe semi-discrete operator for cell $j$ becomes:\n$$\nL(u)_j = -\\frac{a\\,u_{j+1} - a\\,u_j}{\\Delta x} = -\\frac{a}{\\Delta x}(u_{j+1} - u_j)\n$$\n\nThe time step $\\Delta t$ is defined via the Courant-Friedrichs-Lewy (CFL) number, $r$:\n$$\nr = \\frac{|a|\\,\\Delta t}{\\Delta x} \\implies \\Delta t = r \\frac{\\Delta x}{|a|}\n$$\nThe quantity $\\Delta t \\, L(u)$ appears in the time-stepping schemes. We can simplify this term.\n\nFor $a > 0$, $|a|=a$:\n$$\n\\Delta t\\, L(u)_j = \\left(r \\frac{\\Delta x}{a}\\right) \\left(-\\frac{a}{\\Delta x}(u_j - u_{j-1})\\right) = -r(u_j - u_{j-1}) = r(u_{j-1} - u_j)\n$$\n\nFor $a < 0$, $|a|=-a$:\n$$\n\\Delta t\\, L(u)_j = \\left(r \\frac{\\Delta x}{-a}\\right) \\left(-\\frac{a}{\\Delta x}(u_{j+1} - u_j)\\right) = r(u_{j+1} - u_j)\n$$\nThese expressions can be implemented efficiently using vector operations with periodic shifts, for which `numpy.roll` is well-suited.\n\nThe initial condition is a discrete spike: $u_j^0 = 1$ for $j=j^\\star = \\lfloor N/2 \\rfloor$ and $u_j^0=0$ otherwise. The initial data lies within the interval $[0,1]$. The maximum principle is said to be preserved if the solution at the next time step, $u_j^{n+1}$, also remains within these bounds for all $j$: $0 \\le u_j^{n+1} \\le 1$. A numerical tolerance of $10^{-12}$ is used for this check.\n\nWe now implement the two specified Runge-Kutta schemes for a single time step from $u^n = u^0$ to $u^{n+1}$.\n\n1.  **Explicit Midpoint Method** (as defined in the problem):\n    - Stage $1$: $u^{(1)} = u^n + \\Delta t\\,L(u^n)$\n    - Update: $u^{n+1} = u^n + \\Delta t\\,L(u^{(1)})$\n    This method is of second-order accuracy but is not generally Strong Stability Preserving (SSP). For the upwind semi-discretization, it preserves the maximum principle only under a restrictive CFL condition, theoretically $r \\le 0.5$.\n\n2.  **Strong Stability Preserving (SSP) Runge-Kutta method of order two (Heun's method)** (as defined in the problem):\n    - Stage $1$: $u^{(1)} = u^n + \\Delta t\\,L(u^n)$\n    - Stage $2$: $\\tilde{u}^{(2)} = u^{(1)} + \\Delta t\\,L(u^{(1)})$\n    - Update: $u^{n+1} = \\tfrac{1}{2}\\,u^n + \\tfrac{1}{2}\\,\\tilde{u}^{(2)}$\n    This method can be interpreted as a convex combination of the initial state and the state after applying two forward Euler steps. The forward Euler method is maximum principle preserving for this semi-discretization if $r \\le 1$. Since this SSP scheme is a convex combination of operations that preserve the maximum principle (under the condition $r \\le 1$), the full scheme is also maximum principle preserving under the same condition $r \\le 1$.\n\nThe solution procedure is as follows: for each $(a, r)$ pair in the test suite, we initialize the state vector $u^0$. Then, for each of the two time integrators, we compute the state $u^{n+1}$ after one time step. We then check if the minimum and maximum values of the resulting vector $u^{n+1}$ lie within $[0,1]$ (with tolerance). The boolean results (True for preserved, False for violated) are collected for each method and test case.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of checking maximum principle preservation for two RK methods.\n    \"\"\"\n    # Define problem parameters\n    N = 100\n    # j_star needs to be an integer for array indexing\n    j_star = int(np.floor(N / 2))\n    # Numerical tolerance for checking the maximum principle\n    tol = 1e-12\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (a, r) pairs\n        (1.0, 0.25),\n        (1.0, 0.50),\n        (1.0, 0.60),\n        (1.0, 0.95),\n        (-1.0, 0.60),\n        (1.0, 1.05),\n    ]\n\n    results = []\n\n    # Define the operator L_op(u, a, r) which computes delta_t * L(u).\n    # This operator directly uses the CFL number r.\n    def apply_L_times_dt(u, a, r):\n        \"\"\"\n        Applies the semi-discrete operator multiplied by the time step.\n        L(u) = - (f_j+1/2 - f_j-1/2) / dx\n        delta_t * L(u) is computed using the CFL number r.\n        \"\"\"\n        if a > 0:\n            # Upwind flux for positive advection (a > 0)\n            # Stencil uses u_j and u_{j-1}. np.roll(u, 1) gets u_{j-1}.\n            return r * (np.roll(u, 1) - u)\n        else: # a  0\n            # Upwind flux for negative advection (a  0)\n            # Stencil uses u_j and u_{j+1}. np.roll(u, -1) gets u_{j+1}.\n            return r * (np.roll(u, -1) - u)\n\n    # Define a helper function to check the maximum principle.\n    def check_mp(u, tolerance):\n        \"\"\"\n        Checks if the solution u respects the maximum principle bounds [0, 1].\n        \"\"\"\n        min_u = np.min(u)\n        max_u = np.max(u)\n        # The condition is that all values u_j must be in [0, 1].\n        # We use a tolerance for floating-point comparisons.\n        is_preserved = (min_u >= -tolerance) and (max_u = 1.0 + tolerance)\n        return is_preserved\n\n    # Main loop over test cases\n    for a, r in test_cases:\n        # Initialize the data with a single-cell spike\n        u0 = np.zeros(N, dtype=float)\n        u0[j_star] = 1.0\n\n        # 1. Explicit Midpoint Method\n        # Stage 1: u^(1) = u^n + dt*L(u^n)\n        u1_mid = u0 + apply_L_times_dt(u0, a, r)\n        # Update: u^{n+1} = u^n + dt*L(u^(1))\n        u_final_mid = u0 + apply_L_times_dt(u1_mid, a, r)\n        results.append(check_mp(u_final_mid, tol))\n\n        # 2. Strong Stability Preserving (SSP) Runge-Kutta method of order two\n        # Stage 1: u^(1) = u^n + dt*L(u^n)\n        u1_ssp = u0 + apply_L_times_dt(u0, a, r)\n        # Stage 2: u_tilde^(2) = u^(1) + dt*L(u^(1))\n        u2_tilde_ssp = u1_ssp + apply_L_times_dt(u1_ssp, a, r)\n        # Update: u^{n+1} = 0.5*u^n + 0.5*u_tilde^(2)\n        u_final_ssp = 0.5 * u0 + 0.5 * u2_tilde_ssp\n        results.append(check_mp(u_final_ssp, tol))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "The power of the SSP framework lies in its generality. This final practice  extends the concept to a more complex advection-diffusion equation with nonlinear viscosity, a common model in fluid dynamics. Your task will be to first derive the stability constraint for a forward Euler step applied to this new, combined spatial operator, and then use that to determine the stable time step for a high-order SSP method, demonstrating the modular and powerful nature of this numerical design philosophy.",
            "id": "3366832",
            "problem": "Consider the one-dimensional scalar conservation law with nonlinear diffusion\n$$\nu_t + a\\,u_x \\;=\\; \\big(\\nu(u)\\,u_x\\big)_x,\n$$\nposed on the periodic interval $[0,1)$ with constant advection speed $a \\in \\mathbb{R}$ and nonlinear diffusion coefficient $\\nu(u) \\ge 0$. Adopt a method-of-lines semi-discretization on a uniform grid with $N$ cells and grid spacing $\\Delta x = 1/N$, using:\n- First-order upwind differencing for the advection operator $a\\,u_x$; that is, $-a D_h(u)$ with upwind bias depending on the sign of $a$.\n- A conservative flux-form discretization for the diffusion operator $(\\nu(u)\\,u_x)_x$ with interface values computed by arithmetic averages of cell-centered $\\nu(u)$, specifically\n$$\n\\big(\\nu(u)\\,u_x\\big)\\big|_{x_{i+\\frac12}} \\approx \\nu_{i+\\frac12} \\frac{u_{i+1}-u_i}{\\Delta x},\\quad \\nu_{i+\\frac12} = \\tfrac12\\big(\\nu(u_i)+\\nu(u_{i+1})\\big),\n$$\nso that\n$$\n\\big(\\nu(u)\\,u_x\\big)_x\\Big|_{x_i} \\approx \\frac{1}{\\Delta x}\\left(\\nu_{i+\\frac12} \\frac{u_{i+1}-u_i}{\\Delta x} - \\nu_{i-\\frac12}\\frac{u_i-u_{i-1}}{\\Delta x}\\right).\n$$\nDefine the semi-discrete operator $L(u)$ to represent the right-hand side, resulting in the system of ordinary differential equations $u'(t)=L(u(t))$.\n\nYou will use the Strong Stability Preserving Runge–Kutta method of order three with three stages (SSPRK(3,3)) in Shu–Osher form for time stepping:\n- Stage one: $u^{(1)} = u^n + \\Delta t\\,L(u^n)$.\n- Stage two: $u^{(2)} = \\tfrac34 u^n + \\tfrac14\\left(u^{(1)} + \\Delta t\\,L\\big(u^{(1)}\\big)\\right)$.\n- Stage three: $u^{n+1} = \\tfrac13 u^n + \\tfrac23\\left(u^{(2)} + \\Delta t\\,L\\big(u^{(2)}\\big)\\right)$.\n\nTask A. Starting from the discrete maximum principle and the requirement that forward Euler time stepping applied to $u'(t)=L(u(t))$ be a convex combination of neighbor values for monotonicity, derive a sufficient bound on the forward Euler time step $\\Delta t$ that depends on the grid spacing $\\Delta x$, the advection speed magnitude $|a|$, and the maximum diffusion coefficient over the grid at the current time,\n$$\n\\nu_{\\max} = \\max_i \\nu(u_i).\n$$\nYour derivation must start from the coefficients of the explicit forward Euler update with the specified spatial discretizations, impose the nonnegativity of all weights in the tri-diagonal stencil, and arrive at a scalar inequality of the form $\\Delta t \\le f(\\Delta x, |a|, \\nu_{\\max})$.\n\nTask B. Implement a program that:\n- Uses the domain $[0,1)$ with periodic boundary conditions and $N=400$ uniform cells, so that $\\Delta x = 1/400$.\n- Uses the nonlinear diffusion $\\nu(u) = \\varepsilon + \\alpha |u|$ with $\\varepsilon = 10^{-6}$ and $\\alpha = 1$.\n- Initializes $u(x,0)$ to a top-hat (rectangular) profile of amplitude $s$ centered at $x=0.5$ with width $w=0.2$:\n  $$\n  u(x,0) = \\begin{cases}\n  s,  \\text{if } |x-0.5| \\le 0.1\\ \\text{(interpreting periodicity)},\\\\\n  0,  \\text{otherwise}.\n  \\end{cases}\n  $$\n  Implement the periodic interpretation in a way consistent with the discrete grid.\n- Computes the forward Euler time step bound from Task A using $\\nu_{\\max}$ evaluated on the initial data $u^n$.\n- For each test case below, sets the time step $\\Delta t = m\\,\\Delta t_{\\mathrm{FE}}$ where $m$ is the multiplier for that case, advances the solution by exactly one SSPRK(3,3) step, and evaluates whether the discrete total variation has not increased:\n  $$\n  \\mathrm{TV}(u) \\;=\\; \\sum_{i=0}^{N-1} \\big|u_{i+1} - u_i\\big|,\\quad \\text{with }u_N:=u_0.\n  $$\n  Report a boolean value that is true if and only if $\\mathrm{TV}(u^{n+1}) \\le \\mathrm{TV}(u^n)$ (within a numerical tolerance of $10^{-12}$).\n- Aggregates the boolean results for all test cases into a single line of output containing the results as a comma-separated list enclosed in square brackets.\n\nTest Suite. Use the following five test cases, each specified by the triplet $(a,s,m)$:\n1. $(a,s,m) = (1.0,\\,10^{-3},\\,0.95)$\n2. $(a,s,m) = (1.0,\\,10^{-3},\\,1.00)$\n3. $(a,s,m) = (1.0,\\,10^{-3},\\,1.50)$\n4. $(a,s,m) = (0.0,\\,1.0,\\,1.00)$\n5. $(a,s,m) = (0.0,\\,1.0,\\,2.00)$\n\nFinal Output Format. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, \"[True,False,True,True,False]\") corresponding to the five test cases in the order listed above. No other text should be printed.",
            "solution": "This solution addresses a problem in computational fluid dynamics concerning the numerical solution of a one-dimensional scalar advection-diffusion equation. The task is twofold: first, to derive a sufficient time-step restriction for the forward Euler method to be monotone, and second, to implement a higher-order Strong Stability Preserving Runge-Kutta (SSPRK) scheme to verify the theoretical stability properties related to total variation.\n\n### Task A: Derivation of the Forward Euler Time-Step Bound\n\nThe problem considers the one-dimensional scalar conservation law with nonlinear diffusion:\n$$\nu_t + a\\,u_x \\;=\\; \\big(\\nu(u)\\,u_x\\big)_x\n$$\nThis can be written in the form $u_t = L(u)$, where $L(u)$ is the spatial operator:\n$$\nL(u) = -a\\,u_x + \\big(\\nu(u)\\,u_x\\big)_x\n$$\nWe perform a method-of-lines semi-discretization on a uniform grid with spacing $\\Delta x$. Let $u_i(t)$ be the approximation of $u(x_i, t)$ at grid point $x_i = i\\Delta x$. The semi-discrete system of ordinary differential equations is $u_i'(t) = L_h(u)_i$, where $L_h$ is the discrete spatial operator.\n\n**1. Spatial Discretization**\n\nThe operator $L_h(u)_i$ is composed of an advection part, $L_{adv}$, and a diffusion part, $L_{diff}$.\n\n- **Advection term $L_{adv}(u)_i = -a\\,(u_x)_i$**: Using first-order upwind differencing, the approximation depends on the sign of the advection speed $a$.\n  - If $a  0$, the information travels from left to right, so we use a backward difference:\n    $$\n    L_{adv}(u)_i = -a \\frac{u_i - u_{i-1}}{\\Delta x}\n    $$\n  - If $a  0$, the information travels from right to left, so we use a forward difference:\n    $$\n    L_{adv}(u)_i = -a \\frac{u_{i+1} - u_i}{\\Delta x}\n    $$\n- **Diffusion term $L_{diff}(u)_i = \\big((\\nu(u)u_x)_x\\big)_i$**: Using the specified conservative central difference scheme:\n  $$\n  L_{diff}(u)_i = \\frac{1}{\\Delta x}\\left(\\nu_{i+\\frac12} \\frac{u_{i+1}-u_i}{\\Delta x} - \\nu_{i-\\frac12}\\frac{u_i-u_{i-1}}{\\Delta x}\\right)\n  $$\n  where $\\nu_{i+\\frac12} = \\frac{1}{2}\\big(\\nu(u_i)+\\nu(u_{i+1})\\big)$.\n\n**2. Forward Euler Update and Monotonicity**\n\nThe forward Euler time-stepping method for $u_i' = L_h(u)_i$ is given by:\n$$\nu_i^{n+1} = u_i^n + \\Delta t L_h(u^n)_i\n$$\nTo ensure monotonicity (which implies the discrete maximum principle and is a sufficient condition for being total variation diminishing for conservation laws), the update for $u_i^{n+1}$ must be a convex combination of its neighbors at time $n$, i.e., $u_{i-1}^n$, $u_i^n$, and $u_{i+1}^n$. This means we can write:\n$$\nu_i^{n+1} = C_{i-1} u_{i-1}^n + C_{i} u_i^n + C_{i+1} u_{i+1}^n\n$$\nwith non-negative coefficients $C_{i-1}, C_i, C_{i+1} \\ge 0$ that sum to one.\n\nLet's express $L_h(u^n)_i$ in terms of the stencil values $u_{i-1}^n, u_i^n, u_{i+1}^n$. The contribution of the upwind advection and central diffusion terms to the coefficient of $u_i$ is $-\\frac{|a|}{\\Delta x}$ and $-\\frac{\\nu_{i+\\frac12} + \\nu_{i-\\frac12}}{\\Delta x^2}$, respectively, regardless of the sign of $a$.\nThe full operator can be written as:\n$$\nL_h(u)_i = (\\text{...})u_{i-1} - \\left(\\frac{|a|}{\\Delta x} + \\frac{\\nu_{i+\\frac12} + \\nu_{i-\\frac12}}{\\Delta x^2}\\right)u_i + (\\text{...})u_{i+1}\n$$\nSubstituting this into the forward Euler formula and focusing on the coefficient of $u_i^n$:\n$$\nu_i^{n+1} = \\dots + \\underbrace{\\left(1 - \\Delta t \\left(\\frac{|a|}{\\Delta x} + \\frac{\\nu_{i+\\frac12} + \\nu_{i-\\frac12}}{\\Delta x^2}\\right)\\right)}_{C_i} u_i^n + \\dots\n$$\nThe coefficients of $u_{i-1}^n$ and $u_{i+1}^n$ will be non-negative for $\\Delta t  0$ due to the nature of the upwind and diffusion stencils (where off-diagonal entries are non-negative). Thus, for the update to be a convex combination, the critical constraint for monotonicity comes from requiring the coefficient $C_i$ to be non-negative:\n$$\n1 - \\Delta t \\left(\\frac{|a|}{\\Delta x} + \\frac{\\nu_{i+\\frac12} + \\nu_{i-\\frac12}}{\\Delta x^2}\\right) \\ge 0\n$$\nThis inequality must hold for all grid points $i$. Solving for $\\Delta t$:\n$$\n\\Delta t \\le \\frac{1}{\\frac{|a|}{\\Delta x} + \\frac{\\nu_{i+\\frac12} + \\nu_{i-\\frac12}}{\\Delta x^2}}\n$$\nTo obtain a single time-step constraint valid for the entire grid, we must satisfy this inequality for the \"worst case\" denominator over all $i$. This is achieved by maximizing the denominator. The term $\\nu_{i+\\frac12} + \\nu_{i-\\frac12}$ can be expanded and bounded. Let $\\nu_{\\max} = \\max_j \\nu(u_j^n)$ be the maximum value of the diffusion coefficient over the grid at the current time $t_n$. We can establish an upper bound:\n$$\n\\nu_{i+\\frac12} = \\frac{\\nu(u_i)+\\nu(u_{i+1})}{2} \\le \\frac{\\nu_{\\max}+\\nu_{\\max}}{2} = \\nu_{\\max}\n$$\nTherefore:\n$$\n\\nu_{i+\\frac12} + \\nu_{i-\\frac12} \\le \\nu_{\\max} + \\nu_{\\max} = 2\\nu_{\\max}\n$$\nSubstituting this bound into the inequality for $\\Delta t$ gives a more restrictive, but sufficient, global condition:\n$$\n\\Delta t \\le \\frac{1}{\\frac{|a|}{\\Delta x} + \\frac{2\\nu_{\\max}}{\\Delta x^2}}\n$$\nThis can be rearranged to the final form, which represents the sufficient time-step bound for the forward Euler method to be monotone:\n$$\n\\Delta t \\le \\frac{\\Delta x^2}{|a|\\Delta x + 2\\nu_{\\max}}\n$$\nThis bound is analogous to a combined CFL condition for advection ($\\Delta t \\le \\Delta x/|a|$) and a von Neumann stability condition for diffusion ($\\Delta t \\le \\Delta x^2/(2\\nu_{\\max})$).\n\n### Task B: Numerical Verification\n\nThe second task is to numerically verify the properties of the SSPRK(3,3) method. SSP methods are designed such that if the forward Euler (FE) step with time step $\\Delta t_{FE}$ satisfies a certain stability property (like being total variation diminishing, TVD), then the higher-order SSPRK step also satisfies that property, provided the time step $\\Delta t$ is bounded by $\\Delta t \\le c \\cdot \\Delta t_{FE}$, where $c$ is the SSP coefficient. For the given SSPRK(3,3) method, the coefficient is $c=1$.\nOur derived bound is for monotonicity, which is a sufficient condition for the TVD property. We will therefore use $\\Delta t_{\\mathrm{FE}} = \\frac{\\Delta x^2}{|a|\\Delta x + 2\\nu_{\\max}}$. The numerical experiment will test if the scheme is TVD (i.e., $\\mathrm{TV}(u^{n+1}) \\le \\mathrm{TV}(u^n)$) for $\\Delta t = m \\cdot \\Delta t_{\\mathrm{FE}}$ with various multipliers $m$. We expect the property to hold for $m \\le 1$ and fail for $m  1$. The implementation will thus compute the solution after one SSPRK(3,3) step for five test cases and report whether the total variation has not increased.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the 1D advection-diffusion problem using SSPRK(3,3) and verifies\n    the Total Variation Diminishing (TVD) property for several test cases.\n    \"\"\"\n    \n    # --- Problem Parameters ---\n    N = 400\n    DX = 1.0 / N\n    EPS = 1e-6\n    ALPHA = 1.0\n    TOL = 1e-12\n\n    # --- Test Cases (a, s, m) ---\n    test_cases = [\n        (1.0, 1e-3, 0.95),\n        (1.0, 1e-3, 1.00),\n        (1.0, 1e-3, 1.50),\n        (0.0, 1.0, 1.00),\n        (0.0, 1.0, 2.00)\n    ]\n\n    results = []\n\n    # --- Grid Setup ---\n    # Finite difference grid points x_i = i * Delta x\n    x = np.arange(N) * DX\n\n    def L_operator(u, a):\n        \"\"\"\n        Computes the semi-discrete spatial operator L(u) = -a*u_x + (nu(u)*u_x)_x.\n        \"\"\"\n        # Periodic boundary conditions using numpy.roll\n        u_im1 = np.roll(u, 1)\n        u_ip1 = np.roll(u, -1)\n        \n        # --- Advection Term (First-Order Upwind) ---\n        if a > 0:\n            L_adv = -a * (u - u_im1) / DX\n        elif a  0:\n            L_adv = -a * (u_ip1 - u) / DX\n        else: # a == 0\n            L_adv = np.zeros_like(u)\n\n        # --- Diffusion Term (Conservative Finite Difference) ---\n        nu_u = EPS + ALPHA * np.abs(u)\n        nu_u_ip1 = np.roll(nu_u, -1)\n        \n        # Interface diffusion coefficients (arithmetic mean)\n        nu_ip1_2 = 0.5 * (nu_u + nu_u_ip1)\n        \n        # Interface fluxes\n        flux_diff_ip1_2 = nu_ip1_2 * (u_ip1 - u) / DX\n        flux_diff_im1_2 = np.roll(flux_diff_ip1_2, 1)\n        \n        L_diff = (flux_diff_ip1_2 - flux_diff_im1_2) / DX\n        \n        return L_adv + L_diff\n\n    def total_variation(u):\n        \"\"\"\n        Computes the discrete total variation of a periodic array u.\n        TV(u) = sum |u_{i+1} - u_i|\n        \"\"\"\n        u_ip1 = np.roll(u, -1)\n        return np.sum(np.abs(u_ip1 - u))\n\n    for case in test_cases:\n        a, s, m = case\n\n        # --- Initial Condition: Top-hat profile ---\n        # u(x,0) = s if |x-0.5| = 0.1, else 0.\n        # This corresponds to x in [0.4, 0.6].\n        u_n = np.zeros(N)\n        # We interpret |x-0.5| = 0.1 to mean x inclusive of 0.4 and 0.6.\n        # This implies grid points with index i s.t. x_i is in [0.4, 0.6].\n        u_n[np.where(np.logical_and(x >= 0.4, x = 0.6))] = s\n\n        # --- Time Step Calculation ---\n        # Evaluate nu_max on initial data\n        nu_on_u = EPS + ALPHA * np.abs(u_n)\n        nu_max = np.max(nu_on_u)\n        \n        # Forward Euler time step bound from Task A\n        denominator = np.abs(a) * DX + 2 * nu_max\n        if denominator  1e-15: # Avoid division by zero if a=0 and nu_max is close to 0\n            dt_fe = float('inf')\n        else:\n            dt_fe = DX**2 / denominator\n        \n        dt = m * dt_fe\n        \n        # --- TVD Check ---\n        tv_n = total_variation(u_n)\n\n        # --- SSPRK(3,3) single step ---\n        # Stage 1\n        L0 = L_operator(u_n, a)\n        u1 = u_n + dt * L0\n        \n        # Stage 2\n        L1 = L_operator(u1, a)\n        u2 = 0.75 * u_n + 0.25 * (u1 + dt * L1)\n        \n        # Stage 3\n        L2 = L_operator(u2, a)\n        u_n1 = (1.0/3.0) * u_n + (2.0/3.0) * (u2 + dt * L2)\n        \n        tv_n1 = total_variation(u_n1)\n        \n        # Check if TV has not increased, within a tolerance\n        is_tvd = tv_n1 = tv_n + TOL\n        results.append(is_tvd)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        }
    ]
}