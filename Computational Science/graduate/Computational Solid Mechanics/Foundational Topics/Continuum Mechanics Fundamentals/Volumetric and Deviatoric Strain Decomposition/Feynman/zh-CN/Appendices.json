{
    "hands_on_practices": [
        {
            "introduction": "第一个练习旨在经典的小应变框架下巩固我们的理解。我们将探索应变张量的不变量 $I_1$ 和 $J_2$，它们分别是描述体积改变和形状畸变的基本物理量。通过从主应变出发推导这些表达式，并分析一个特殊的静水压力状态，你将为体积应变和偏应变的物理意义建立起坚实的直觉 。",
            "id": "3609723",
            "problem": "在一个三维实体的主坐标系中观察到一个均匀小应变状态，其中对称小应变张量的主分量为 $\\varepsilon_1$、$\\varepsilon_2$ 和 $\\varepsilon_3$。从小应变张量、迹算子、二阶张量的偏量部分以及由双点积定义的不变量的基本定义出发，推导应变张量第一不变量 $I_1$ 和偏应变张量第二不变量 $J_2$ 关于 $\\varepsilon_1$、$\\varepsilon_2$ 和 $\\varepsilon_3$ 的闭式表达式。然后，在体积应变和偏应变分解的背景下，解释 $\\varepsilon_1=\\varepsilon_2=\\varepsilon_3$ 这种特殊情况，说明变形的哪个方面存在或缺失。\n\n将 $I_1$ 和 $J_2$ 的最终表达式以单行矩阵的形式一起提供。由于应变是无量纲的，因此不需要单位。无需进行数值四舍五入；请以精确的解析形式给出答案。解释应包含在您的推导过程中，而不是在最终答案中。",
            "solution": "该问题是有效的，因为它在科学上基于连续介质力学的原理，是适定的，有唯一的解可以从给定条件中推导出来，并且使用了标准术语进行客观陈述。\n\n我们首先在其主坐标系中表示对称小应变张量 $\\boldsymbol{\\varepsilon}$。由于主应变为 $\\varepsilon_1$、$\\varepsilon_2$ 和 $\\varepsilon_3$，非对角分量为零，该张量可以写成矩阵形式：\n$$\n\\boldsymbol{\\varepsilon} = \\begin{pmatrix} \\varepsilon_1  0  0 \\\\ 0  \\varepsilon_2  0 \\\\ 0  0  \\varepsilon_3 \\end{pmatrix}\n$$\n\n应变张量的第一不变量 $I_1$ 定义为张量的迹，$\\text{tr}(\\boldsymbol{\\varepsilon})$。迹是矩阵表示中对角元素的和。\n$$\nI_1 = \\text{tr}(\\boldsymbol{\\varepsilon}) = \\sum_{i=1}^{3} \\varepsilon_{ii}\n$$\n对于给定的主应变状态，这变为：\n$$\nI_1 = \\varepsilon_1 + \\varepsilon_2 + \\varepsilon_3\n$$\n该不变量与体积应变 $\\varepsilon_v = I_1$ 直接相关，对于小应变，它近似于材料单元的相对体积变化，$\\frac{\\Delta V}{V_0} \\approx \\varepsilon_v$。\n\n接下来，我们推导偏应变张量的第二不变量 $J_2$。应变张量 $\\boldsymbol{\\varepsilon}$ 可以加法分解为一个体积（或球形）部分 $\\boldsymbol{\\varepsilon}_{vol}$ 和一个偏量部分 $\\boldsymbol{\\varepsilon}_{dev}$。\n$$\n\\boldsymbol{\\varepsilon} = \\boldsymbol{\\varepsilon}_{vol} + \\boldsymbol{\\varepsilon}_{dev}\n$$\n体积部分代表纯粹的体积变化而没有形状变化，定义为：\n$$\n\\boldsymbol{\\varepsilon}_{vol} = \\frac{1}{3} \\text{tr}(\\boldsymbol{\\varepsilon}) \\mathbf{I} = \\frac{1}{3} I_1 \\mathbf{I}\n$$\n其中 $\\mathbf{I}$ 是二阶单位张量。因此，代表在恒定体积下形状变化（畸变）的偏量部分为：\n$$\n\\boldsymbol{\\varepsilon}_{dev} = \\boldsymbol{\\varepsilon} - \\boldsymbol{\\varepsilon}_{vol} = \\boldsymbol{\\varepsilon} - \\frac{1}{3} I_1 \\mathbf{I}\n$$\n偏应变张量的迹恒为零：$\\text{tr}(\\boldsymbol{\\varepsilon}_{dev}) = \\text{tr}(\\boldsymbol{\\varepsilon}) - \\text{tr}(\\frac{1}{3} I_1 \\mathbf{I}) = I_1 - \\frac{1}{3} I_1 \\text{tr}(\\mathbf{I}) = I_1 - \\frac{1}{3} I_1 (3) = 0$。\n\n在主坐标系中，偏应变张量的矩阵为：\n$$\n\\boldsymbol{\\varepsilon}_{dev} = \\begin{pmatrix} \\varepsilon_1  0  0 \\\\ 0  \\varepsilon_2  0 \\\\ 0  0  \\varepsilon_3 \\end{pmatrix} - \\frac{1}{3} (\\varepsilon_1 + \\varepsilon_2 + \\varepsilon_3) \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix}\n$$\n$$\n\\boldsymbol{\\varepsilon}_{dev} = \\begin{pmatrix} \\varepsilon_1 - \\frac{I_1}{3}  0  0 \\\\ 0  \\varepsilon_2 - \\frac{I_1}{3}  0 \\\\ 0  0  \\varepsilon_3 - \\frac{I_1}{3} \\end{pmatrix}\n$$\n对角分量是主偏应变，我们可以表示为 $e_1$、$e_2$ 和 $e_3$。\n\n偏应变张量的第二不变量 $J_2$ 定义为：\n$$\nJ_2 = \\frac{1}{2} (\\boldsymbol{\\varepsilon}_{dev} : \\boldsymbol{\\varepsilon}_{dev}) = \\frac{1}{2} \\sum_{i=1}^{3} \\sum_{j=1}^{3} (\\varepsilon_{dev})_{ij} (\\varepsilon_{dev})_{ji}\n$$\n由于该张量在主基底下是对称且对角的，这简化为其主值的平方和：\n$$\nJ_2 = \\frac{1}{2} (e_1^2 + e_2^2 + e_3^2) = \\frac{1}{2} \\left[ \\left(\\varepsilon_1 - \\frac{I_1}{3}\\right)^2 + \\left(\\varepsilon_2 - \\frac{I_1}{3}\\right)^2 + \\left(\\varepsilon_3 - \\frac{I_1}{3}\\right)^2 \\right]\n$$\n展开平方项并回顾 $I_1 = \\varepsilon_1 + \\varepsilon_2 + \\varepsilon_3$：\n$$\nJ_2 = \\frac{1}{2} \\left[ (\\varepsilon_1^2 + \\varepsilon_2^2 + \\varepsilon_3^2) - \\frac{2}{3}I_1(\\varepsilon_1 + \\varepsilon_2 + \\varepsilon_3) + 3\\left(\\frac{I_1^2}{9}\\right) \\right]\n$$\n$$\nJ_2 = \\frac{1}{2} \\left[ (\\varepsilon_1^2 + \\varepsilon_2^2 + \\varepsilon_3^2) - \\frac{2}{3}I_1^2 + \\frac{1}{3}I_1^2 \\right] = \\frac{1}{2} \\left[ (\\varepsilon_1^2 + \\varepsilon_2^2 + \\varepsilon_3^2) - \\frac{1}{3}I_1^2 \\right]\n$$\n将 $I_1 = \\varepsilon_1 + \\varepsilon_2 + \\varepsilon_3$ 代回此表达式可得：\n$$\nJ_2 = \\frac{1}{2} \\left[ \\varepsilon_1^2 + \\varepsilon_2^2 + \\varepsilon_3^2 - \\frac{1}{3}(\\varepsilon_1 + \\varepsilon_2 + \\varepsilon_3)^2 \\right]\n$$\n$$\nJ_2 = \\frac{1}{2} \\left[ \\varepsilon_1^2 + \\varepsilon_2^2 + \\varepsilon_3^2 - \\frac{1}{3}(\\varepsilon_1^2 + \\varepsilon_2^2 + \\varepsilon_3^2 + 2\\varepsilon_1\\varepsilon_2 + 2\\varepsilon_2\\varepsilon_3 + 2\\varepsilon_3\\varepsilon_1) \\right]\n$$\n$$\nJ_2 = \\frac{1}{2} \\left[ \\frac{2}{3}(\\varepsilon_1^2 + \\varepsilon_2^2 + \\varepsilon_3^2) - \\frac{2}{3}(\\varepsilon_1\\varepsilon_2 + \\varepsilon_2\\varepsilon_3 + \\varepsilon_3\\varepsilon_1) \\right]\n$$\n$$\nJ_2 = \\frac{1}{3} (\\varepsilon_1^2 + \\varepsilon_2^2 + \\varepsilon_3^2 - \\varepsilon_1\\varepsilon_2 - \\varepsilon_2\\varepsilon_3 - \\varepsilon_3\\varepsilon_1)\n$$\n通过认识到 $(\\varepsilon_1 - \\varepsilon_2)^2 + (\\varepsilon_2 - \\varepsilon_3)^2 + (\\varepsilon_3 - \\varepsilon_1)^2 = 2(\\varepsilon_1^2 + \\varepsilon_2^2 + \\varepsilon_3^2 - \\varepsilon_1\\varepsilon_2 - \\varepsilon_2\\varepsilon_3 - \\varepsilon_3\\varepsilon_1)$，该表达式可以重写为更具洞察力的形式。因此，$J_2$ 可以表示为：\n$$\nJ_2 = \\frac{1}{6} \\left[ (\\varepsilon_1 - \\varepsilon_2)^2 + (\\varepsilon_2 - \\varepsilon_3)^2 + (\\varepsilon_3 - \\varepsilon_1)^2 \\right]\n$$\n这个最终形式清楚地表明 $J_2$ 与主应变之间的差异有关。\n\n最后，我们解释 $\\varepsilon_1 = \\varepsilon_2 = \\varepsilon_3 = \\varepsilon_0$ 的特殊情况。\n在这种情况下，我们评估应变的体积和偏量分量。\n第一不变量 $I_1$ 变为：\n$$\nI_1 = \\varepsilon_0 + \\varepsilon_0 + \\varepsilon_0 = 3\\varepsilon_0\n$$\n由于体积应变 $\\varepsilon_v = I_1$，一个非零的 $\\varepsilon_0$ 意味着体积发生了变化。这是变形的体积方面，是存在的。\n\n现在我们检查偏量分量。主偏应变为 $e_i = \\varepsilon_i - \\frac{1}{3}I_1$。\n$$\ne_1 = \\varepsilon_1 - \\frac{1}{3}(3\\varepsilon_0) = \\varepsilon_0 - \\varepsilon_0 = 0\n$$\n$$\ne_2 = \\varepsilon_2 - \\frac{1}{3}(3\\varepsilon_0) = \\varepsilon_0 - \\varepsilon_0 = 0\n$$\n$$\ne_3 = \\varepsilon_3 - \\frac{1}{3}(3\\varepsilon_0) = \\varepsilon_0 - \\varepsilon_0 = 0\n$$\n偏应变张量 $\\boldsymbol{\\varepsilon}_{dev}$ 是零张量。因此，其第二不变量 $J_2$ 也必须为零，这可以通过我们推导的公式得到证实：\n$$\nJ_2 = \\frac{1}{6} \\left[ (\\varepsilon_0 - \\varepsilon_0)^2 + (\\varepsilon_0 - \\varepsilon_0)^2 + (\\varepsilon_0 - \\varepsilon_0)^2 \\right] = 0\n$$\n应变的偏量部分代表了材料单元的畸变或形状变化。由于 $\\boldsymbol{\\varepsilon}_{dev} = \\mathbf{0}$ 且 $J_2 = 0$，在这种情况下完全**缺失**的变形方面是偏应变，这意味着没有畸变或形状变化。应变状态是纯体积性的（或静水/球形的），对应于所有方向上的均匀膨胀或收缩。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\varepsilon_1 + \\varepsilon_2 + \\varepsilon_3  \\frac{1}{6} \\left[ (\\varepsilon_1 - \\varepsilon_2)^2 + (\\varepsilon_2 - \\varepsilon_3)^2 + (\\varepsilon_3 - \\varepsilon_1)^2 \\right] \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "现实世界的问题常常涉及大变形，此时小应变假设不再适用。本练习将体积-偏应变分解的概念推广到更复杂的领域，即使用对数应变（Hencky应变）的大变形理论。你将看到，分离体积变化与形状改变这一基本原则如何在有限应变理论中得到巧妙地处理，并验证偏应变张量的一个关键特性 。",
            "id": "3609701",
            "problem": "考虑一个由变形梯度 $\\mathbf{F}$ 表征的均匀变形，其极分解为 $\\mathbf{F} = \\mathbf{R}\\,\\mathbf{U}$，其中 $\\mathbf{R}$ 是一个真正交旋转，$\\mathbf{U}$ 是右伸长张量，它是对称正定（SPD）的。主伸长 $\\lambda_1$、$\\lambda_2$ 和 $\\lambda_3$ 是 $\\mathbf{U}$ 的特征值，而对数（Hencky）应变张量通过对SPD张量上的矩阵对数进行谱映射定义为 $\\mathbf{h} = \\ln \\mathbf{U}$。任何二阶张量的体积-偏量分解是其分解为球量部分和偏量部分的加法分解，其中球量部分为 $(\\operatorname{tr}\\mathbf{h}/3)\\,\\mathbf{I}$，偏量部分为 $\\mathbf{h}^{\\text{dev}} = \\mathbf{h} - (\\operatorname{tr}\\mathbf{h}/3)\\,\\mathbf{I}$。\n\n仅从这些定义和事实出发，推导偏量对数应变的主分量，并用它们计算在特定主伸长下的主偏量对数应变：\n$$\n\\lambda_1 = 4,\\quad \\lambda_2 = 1,\\quad \\lambda_3 = 2.\n$$\n然后，利用行列式和对数的基本性质，证明它们之和为零。\n\n将最终答案表示为一个行向量，其中包含三个主偏量对数应变，使用自然对数以精确形式表示。无需四舍五入，最终答案中不应包含任何单位。",
            "solution": "该问题是有效的，因为它在连续介质力学中有科学依据，问题提法清晰，且是客观的。它为唯一解提供了所有必要的信息。我们将首先推导主偏量对数应变的一般表达式，然后计算给定主伸长下的具体值，最后证明它们的和为零。\n\n右伸长张量 $\\mathbf{U}$ 是对称正定（SPD）的。因此，它可以根据其特征值 $\\lambda_i$（主伸长）及其对应的标准正交特征向量 $\\mathbf{n}_i$（主方向）进行谱分解：\n$$\n\\mathbf{U} = \\sum_{i=1}^{3} \\lambda_i \\mathbf{n}_i \\otimes \\mathbf{n}_i\n$$\n对数（Hencky）应变张量 $\\mathbf{h}$ 定义为 $\\mathbf{h} = \\ln \\mathbf{U}$。这个运算是通过谱定理进行的，该定理指出 $\\mathbf{h}$ 与 $\\mathbf{U}$ 共享相同的主方向 $\\mathbf{n}_i$，其特征值（主对数应变，$h_i$）是 $\\mathbf{U}$ 特征值的自然对数：\n$$\nh_i = \\ln \\lambda_i\n$$\n因此，$\\mathbf{h}$ 的谱分解为：\n$$\n\\mathbf{h} = \\sum_{i=1}^{3} (\\ln \\lambda_i) \\mathbf{n}_i \\otimes \\mathbf{n}_i\n$$\n张量的迹是一个不变量，等于其特征值之和。因此，对数应变张量的迹是其主值之和：\n$$\n\\operatorname{tr}(\\mathbf{h}) = \\sum_{i=1}^{3} h_i = \\sum_{i=1}^{3} \\ln \\lambda_i\n$$\n利用对数的性质，即对数之和等于乘积的对数，我们有：\n$$\n\\operatorname{tr}(\\mathbf{h}) = \\ln(\\lambda_1 \\lambda_2 \\lambda_3)\n$$\n矩阵的特征值之积等于其行列式。因此，$\\lambda_1 \\lambda_2 \\lambda_3 = \\det(\\mathbf{U})$。此外，根据极分解 $\\mathbf{F} = \\mathbf{R}\\mathbf{U}$ 以及对于真正交旋转 $\\det(\\mathbf{R}) = 1$ 的事实，我们知道体积雅可比 $J = \\det(\\mathbf{F}) = \\det(\\mathbf{U})$。这导出了基本关系式：\n$$\n\\operatorname{tr}(\\mathbf{h}) = \\ln(\\det(\\mathbf{U})) = \\ln(J)\n$$\n这个迹代表了对数尺度下的总体积变化。\n\n问题将 $\\mathbf{h}$ 的体积-偏量分解定义为一个加法分解，分为球量（体积）部分 $\\mathbf{h}^{\\text{vol}}$ 和偏量部分 $\\mathbf{h}^{\\text{dev}}$：\n$$\n\\mathbf{h} = \\mathbf{h}^{\\text{vol}} + \\mathbf{h}^{\\text{dev}}\n$$\n其中球量部分由 $\\mathbf{h}^{\\text{vol}} = \\frac{1}{3}\\operatorname{tr}(\\mathbf{h})\\mathbf{I}$ 给出，因此偏量部分为 $\\mathbf{h}^{\\text{dev}} = \\mathbf{h} - \\frac{1}{3}\\operatorname{tr}(\\mathbf{h})\\mathbf{I}$。偏量部分代表在恒定体积下的形状改变（畸变）。\n\n为了求出偏量对数应变的主分量，我们在主基 $\\{\\mathbf{n}_1, \\mathbf{n}_2, \\mathbf{n}_3\\}$ 中分析张量 $\\mathbf{h}^{\\text{dev}}$。在此基中，$\\mathbf{h}$ 的矩阵表示是对角矩阵，其对角元为 $h_i = \\ln \\lambda_i$。单位张量 $\\mathbf{I}$ 也是对角的。因此 $\\mathbf{h}^{\\text{dev}}$ 的矩阵表示也是对角的，其对角元即为主偏量应变 $h_i^{\\text{dev}}$。\n$$\nh_i^{\\text{dev}} = h_i - \\frac{1}{3}\\operatorname{tr}(\\mathbf{h})\n$$\n代入 $h_i$ 和 $\\operatorname{tr}(\\mathbf{h})$ 的表达式，我们得到偏量对数应变主分量的一般公式：\n$$\nh_i^{\\text{dev}} = \\ln \\lambda_i - \\frac{1}{3} \\sum_{j=1}^{3} \\ln \\lambda_j\n$$\n这完成了任务的第一部分。\n\n接下来，我们计算主伸长 $\\lambda_1 = 4$、$\\lambda_2 = 1$ 和 $\\lambda_3 = 2$ 的具体值。\n首先，我们计算对数应变张量 $\\mathbf{h}$ 的迹：\n$$\n\\operatorname{tr}(\\mathbf{h}) = \\ln(4) + \\ln(1) + \\ln(2) = \\ln(4 \\times 1 \\times 2) = \\ln(8)\n$$\n平均应变分量是 $\\frac{1}{3}\\operatorname{tr}(\\mathbf{h}) = \\frac{1}{3}\\ln(8)$。我们可以利用对数性质来简化它：$\\frac{1}{3}\\ln(8) = \\frac{1}{3}\\ln(2^3) = \\frac{3}{3}\\ln(2) = \\ln(2)$。\n\n现在我们计算每个主偏量应变，$h_i^{\\text{dev}} = \\ln \\lambda_i - \\ln(2)$：\n对于 $i=1$：\n$$\nh_1^{\\text{dev}} = \\ln(4) - \\ln(2) = \\ln\\left(\\frac{4}{2}\\right) = \\ln(2)\n$$\n对于 $i=2$：\n$$\nh_2^{\\text{dev}} = \\ln(1) - \\ln(2) = 0 - \\ln(2) = -\\ln(2)\n$$\n对于 $i=3$：\n$$\nh_3^{\\text{dev}} = \\ln(2) - \\ln(2) = 0\n$$\n因此，主偏量对数应变为 $\\ln(2)$、$-\\ln(2)$ 和 $0$。\n\n最后，题目要求我们利用行列式和对数的基本性质来证明这些主分量之和为零。根据定义，主偏量应变之和是偏量张量的迹，即 $\\operatorname{tr}(\\mathbf{h}^{\\text{dev}})$。\n$$\n\\operatorname{tr}(\\mathbf{h}^{\\text{dev}}) = \\sum_{i=1}^{3} h_i^{\\text{dev}} = \\sum_{i=1}^{3} \\left(\\ln \\lambda_i - \\frac{1}{3} \\sum_{j=1}^{3} \\ln \\lambda_j\\right)\n$$\n展开求和：\n$$\n\\operatorname{tr}(\\mathbf{h}^{\\text{dev}}) = \\left(\\sum_{i=1}^{3} \\ln \\lambda_i\\right) - 3 \\left(\\frac{1}{3} \\sum_{j=1}^{3} \\ln \\lambda_j\\right) = \\left(\\sum_{i=1}^{3} \\ln \\lambda_i\\right) - \\left(\\sum_{j=1}^{3} \\ln \\lambda_j\\right)\n$$\n现在，我们使用对数和行列式的性质。对数之和等于乘积的对数：\n$$\n\\sum_{i=1}^{3} \\ln \\lambda_i = \\ln(\\lambda_1 \\lambda_2 \\lambda_3)\n$$\n特征值之积等于张量的行列式：\n$$\n\\lambda_1 \\lambda_2 \\lambda_3 = \\det(\\mathbf{U})\n$$\n因此，主偏量应变之和为：\n$$\n\\operatorname{tr}(\\mathbf{h}^{\\text{dev}}) = \\ln(\\det(\\mathbf{U})) - \\ln(\\det(\\mathbf{U})) = 0\n$$\n这证明了该和恒为零，其根源在于偏量张量的定义以及对数和行列式的基本性质。对于我们的具体情况，其和为 $\\ln(2) + (-\\ln(2)) + 0 = 0$，这与一般性证明是一致的。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\ln(2)  -\\ln(2)  0\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "连接理论与实践是计算力学中的一项关键技能。最后一个练习将挑战你实现一个核心数值算法：将变形梯度 $\\boldsymbol{F}$ 乘法分解为其体积部分和保体积（等容）部分。这种分解是有限元分析中许多高等材料模型的关键第一步，这个动手编程任务将巩固你将连续介质力学原理转化为稳健代码的能力 。",
            "id": "3609735",
            "problem": "给定一个三维连续介质运动学设定，其中变形由一个变形梯度矩阵 $ \\boldsymbol{F} \\in \\mathbb{R}^{3 \\times 3} $ 来表征，其行列式为正值 $ J = \\det \\boldsymbol{F} > 0 $。在计算固体力学中，一种常见的乘法分解将体积变化部分与等容（保体积）部分分离开。从变形梯度及其雅可比行列式的基本定义出发，推导出一个保体积映射的显式表达式，该表达式分解出一个标量体积拉伸，使得最终的等容部分具有单位行列式。基于您的推导，设计一个鲁棒的数值算法，对于每个给定的输入 $ \\boldsymbol{F} $，该算法计算一个等容映射 $ \\bar{\\boldsymbol{F}} $，使得在精确算术中 $ \\det \\bar{\\boldsymbol{F}} = 1 $，然后在指定的容差范围内对此进行数值验证。\n\n您的程序必须实现以下任务：\n\n1. 从以下基本依据出发：\n   - 变形梯度 $ \\boldsymbol{F} $ 作为运动的空间梯度的定义。\n   - 雅可比行列式 $ J = \\det \\boldsymbol{F} $ 代表变形后体积与参考体积的局部比率。\n   - 一个乘法分解，将其分为标量体积部分和保体积的等容部分，其中体积部分被限制为单位矩阵的各向同性标量倍数，而等容部分必须满足单位行列式的约束。\n   推导出用 $ \\boldsymbol{F} $ 和 $ J $ 表示的等容映射 $ \\bar{\\boldsymbol{F}} $ 的显式表达式，除了 $ J > 0 $ 外，不假设 $ \\boldsymbol{F} $ 具有任何特殊结构。\n\n2. 为 $ 3 \\times 3 $ 输入指定一个数值稳定的算法来计算 $ \\bar{\\boldsymbol{F}} $，包括讨论在保持浮点鲁棒性的同时如何处理非常小或非常大的 $ J $。您的算法必须：\n   - 使用数值稳定的行列式求值方法从 $ \\boldsymbol{F} $ 计算 $ J $。\n   - 使用对 $ J $ 的数值稳定立方根运算来计算分解出体积拉伸的标量。\n   - 通过适当地缩放 $ \\boldsymbol{F} $ 来构造 $ \\bar{\\boldsymbol{F}} $，使得在精确算术中 $ \\det \\bar{\\boldsymbol{F}} = 1 $。\n   - 数值验证 $ \\left| \\det \\bar{\\boldsymbol{F}} - 1 \\right| \\le \\varepsilon $，其中 $ \\varepsilon = 10^{-9} $。\n\n3. 用代码实现您的算法，并将其应用于以下输入变形梯度的测试套件。每个 $ \\boldsymbol{F}^{(k)} $ 都是一个具有正行列式的 $ 3 \\times 3 $ 实数矩阵：\n   - 测试 $ 1 $（单位矩阵）：$ \\boldsymbol{F}^{(1)} = \\begin{bmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{bmatrix} $。\n   - 测试 $ 2 $（纯体积拉伸）：$ \\boldsymbol{F}^{(2)} = 2 \\, \\boldsymbol{I} = \\begin{bmatrix} 2  0  0 \\\\ 0  2  0 \\\\ 0  0  2 \\end{bmatrix} $。\n   - 测试 $ 3 $（单位行列式的简单剪切）：$ \\boldsymbol{F}^{(3)} = \\begin{bmatrix} 1  0.3  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{bmatrix} $。\n   - 测试 $ 4 $（绕 $ z $ 轴旋转角度 $ \\theta $，然后进行各向异性拉伸）：令 $ \\theta = \\pi/6 $（以弧度为单位），$ \\boldsymbol{R}_z(\\theta) = \\begin{bmatrix} \\cos\\theta  -\\sin\\theta  0 \\\\ \\sin\\theta  \\cos\\theta  0 \\\\ 0  0  1 \\end{bmatrix} $，且 $ \\boldsymbol{D} = \\operatorname{diag}(1.5,\\, 0.8,\\, 1.2) $。使用 $ \\boldsymbol{F}^{(4)} = \\boldsymbol{R}_z(\\theta) \\, \\boldsymbol{D} $。\n   - 测试 $ 5 $（小雅可比行列式的高度各向异性）：$ \\boldsymbol{F}^{(5)} = \\operatorname{diag}(10^{-3},\\, 1,\\, 1) $。\n   - 测试 $ 6 $（上三角形式的近似不可压缩）：$ \\boldsymbol{F}^{(6)} = \\begin{bmatrix} 1.02  0.01  0 \\\\ 0  0.98  0.02 \\\\ 0  0  1.01 \\end{bmatrix} $。\n\n您的程序必须为每个测试用例 $ k \\in \\{1,2,3,4,5,6\\} $ 输出一个布尔值，指示 $ \\left| \\det \\bar{\\boldsymbol{F}}^{(k)} - 1 \\right| \\le \\varepsilon $ 是否成立，其中 $ \\varepsilon = 10^{-9} $。最终输出格式必须是单行，其中包含一个用方括号括起来的、由逗号分隔的布尔结果列表，例如 $ [\\mathrm{True},\\mathrm{False},\\dots] $。不应打印任何其他文本。角度应以弧度为单位进行解释。此计算不涉及任何物理单位，因为在此公式中所有量都是无量纲的。",
            "solution": "我们从变形梯度 $ \\boldsymbol{F} = \\dfrac{\\partial \\boldsymbol{x}}{\\partial \\boldsymbol{X}} \\in \\mathbb{R}^{3 \\times 3} $ 的定义开始，它将物质线元映射到空间线元。其雅可比行列式 $ J = \\det \\boldsymbol{F} $ 代表变形后体积与参考体积的局部比率。在体积变形和等容变形的乘法分解中，我们寻求一种分解，将其分为各向同性体积拉伸和一个保体积分量，\n$$\n\\boldsymbol{F} = \\bar{\\boldsymbol{F}} \\, \\boldsymbol{F}_{\\mathrm{vol}},\n$$\n其中 $ \\boldsymbol{F}_{\\mathrm{vol}} = \\beta \\, \\boldsymbol{I} $（对于某个标量 $ \\beta > 0 $），而等容部分 $ \\bar{\\boldsymbol{F}} $ 受以下约束\n$$\n\\det \\bar{\\boldsymbol{F}} = 1.\n$$\n对等式两边取行列式，并利用在三维空间中 $ \\det(\\beta \\boldsymbol{I}) = \\beta^3 $，我们得到\n$$\n\\det \\boldsymbol{F} = \\det \\bar{\\boldsymbol{F}} \\, \\det \\boldsymbol{F}_{\\mathrm{vol}} = 1 \\cdot \\beta^3,\n$$\n因此\n$$\n\\beta = J^{1/3}.\n$$\n求解等容映射，得到\n$$\n\\bar{\\boldsymbol{F}} = \\boldsymbol{F} \\, \\boldsymbol{F}_{\\mathrm{vol}}^{-1} = \\boldsymbol{F} \\, (\\beta \\boldsymbol{I})^{-1} = \\beta^{-1} \\boldsymbol{F} = J^{-1/3} \\boldsymbol{F}.\n$$\n在 $ \\boldsymbol{F}_{\\mathrm{vol}} $ 的各向同性以及 $ \\bar{\\boldsymbol{F}} $ 的单位行列式约束条件下，这个表达式是唯一的。该推导过程仅依赖于 $ \\boldsymbol{F} $、雅可比行列式以及带有各向同性体积部分的乘法分解的基本定义。\n\n对于数值计算，算法对每个输入 $ \\boldsymbol{F} \\in \\mathbb{R}^{3 \\times 3} $ 按以下步骤进行：\n\n1. 使用数值稳定的行列式例程计算雅可比行列式 $ J = \\det \\boldsymbol{F} $。在实践中，可以通过 $ \\operatorname{LU} $ 分解或一个鲁棒的库例程来计算 $ J $。我们假设使用双精度浮点运算。\n\n2. 强制执行物理允许条件 $ J > 0 $，以避免非物理的翻转并确保立方根为实数。\n\n3. 使用鲁棒的实数立方根运算计算体积标量 $ \\beta = J^{1/3} $。在数值上，为避免在 $ J $ 非常小或非常大时出现有效位数损失，首选 $ \\beta = \\operatorname{cbrt}(J) $；等价地，如果立方根函数不可用，可以使用 $ \\beta = \\exp\\big( \\tfrac{1}{3} \\log J \\big) $ 以提高稳定性。\n\n4. 通过标量重缩放构造等容映射：\n$$\n\\bar{\\boldsymbol{F}} = \\beta^{-1} \\boldsymbol{F}.\n$$\n\n5. 通过计算 $ \\det \\bar{\\boldsymbol{F}} $ 并检查是否满足 $ \\left| \\det \\bar{\\boldsymbol{F}} - 1 \\right| \\le \\varepsilon $（容差 $ \\varepsilon = 10^{-9} $）来数值验证等容约束。\n\n数值考量：\n\n- 当 $ J $ 非常小但为正时，$ \\beta $ 也会很小，而 $ \\beta^{-1} $ 会很大。由于 $ \\bar{\\boldsymbol{F}} $ 是通过对 $ \\boldsymbol{F} $ 进行均匀缩放形成的，因此 $ \\bar{\\boldsymbol{F}} $ 的行列式计算相对于 $ \\boldsymbol{F} $ 的行列式计算仍然是良态的，因为在精确算术中 $ \\det(\\bar{\\boldsymbol{F}}) = \\beta^{-3} \\det(\\boldsymbol{F}) = 1 $。为了最小化计算 $ \\beta $ 时的舍入误差，推荐使用直接立方根（或指数-对数对）方法。\n\n- 对于上三角输入，行列式是对角线元素的乘积，这提供了一种直接的检验方法。对于一般输入，可靠的行列式库例程（例如，基于 $ \\operatorname{LU} $ 分解的例程）会产生稳定的结果。\n\n算法步骤总结：\n\n- 输入：$ \\boldsymbol{F} $。\n- 计算 $ J = \\det \\boldsymbol{F} $；确保 $ J > 0 $。\n- 计算 $ \\beta = \\operatorname{cbrt}(J) $ 和缩放因子 $ s = \\beta^{-1} $。\n- 计算 $ \\bar{\\boldsymbol{F}} = s \\, \\boldsymbol{F} $。\n- 计算 $ d = \\det \\bar{\\boldsymbol{F}} $ 并检查 $ \\left| d - 1 \\right| \\le \\varepsilon $。\n\n应用于测试套件：\n\n- 测试 1：$ \\boldsymbol{F}^{(1)} = \\boldsymbol{I} $ 得到 $ J = 1 $，$ \\beta = 1 $，$ \\bar{\\boldsymbol{F}} = \\boldsymbol{I} $，且 $ \\det \\bar{\\boldsymbol{F}} = 1 $。\n\n- 测试 2：$ \\boldsymbol{F}^{(2)} = 2 \\boldsymbol{I} $ 得到 $ J = 8 $，$ \\beta = 2 $，$ \\bar{\\boldsymbol{F}} = \\boldsymbol{I} $，且 $ \\det \\bar{\\boldsymbol{F}} = 1 $。\n\n- 测试 3：$ \\boldsymbol{F}^{(3)} $ 是对角线元素为 1 的上三角矩阵，所以 $ J = 1 $，$ \\beta = 1 $，$ \\bar{\\boldsymbol{F}} = \\boldsymbol{F}^{(3)} $，且 $ \\det \\bar{\\boldsymbol{F}} = 1 $。\n\n- 测试 4：$ \\boldsymbol{F}^{(4)} = \\boldsymbol{R}_z(\\theta) \\boldsymbol{D} $ 的行列式为 $ J = \\det \\boldsymbol{R}_z(\\theta) \\det \\boldsymbol{D} = 1 \\cdot (1.5 \\cdot 0.8 \\cdot 1.2) = 1.44 $，所以 $ \\beta = 1.44^{1/3} $，$ \\bar{\\boldsymbol{F}} = \\beta^{-1} \\boldsymbol{F}^{(4)} $，从而得到 $ \\det \\bar{\\boldsymbol{F}} = 1 $。\n\n- 测试 5：$ \\boldsymbol{F}^{(5)} = \\operatorname{diag}(10^{-3}, 1, 1) $ 给出 $ J = 10^{-3} $，$ \\beta = 10^{-1} $，$ \\bar{\\boldsymbol{F}} = \\operatorname{diag}(10^{-3} \\cdot 10, 1 \\cdot 10, 1 \\cdot 10) $，所以 $ \\det \\bar{\\boldsymbol{F}} = (10^{-2}) \\cdot 10 \\cdot 10 = 1 $。\n\n- 测试 6：$ \\boldsymbol{F}^{(6)} $ 是对角线元素为 $ 1.02 $、$ 0.98 $、$ 1.01 $ 的上三角矩阵，所以 $ J = 1.02 \\cdot 0.98 \\cdot 1.01 > 0 $，并且同样的缩放操作在精确算术中会产生 $ \\det \\bar{\\boldsymbol{F}} = 1 $。\n\n程序实现了这些步骤，对每个测试计算布尔检查 $ \\left| \\det \\bar{\\boldsymbol{F}} - 1 \\right| \\le \\varepsilon $，并以指定格式输出一个包含布尔结果列表的单行。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef isochoric_map(F: np.ndarray, eps: float = 1e-9):\n    \"\"\"\n    Compute the isochoric part of the deformation gradient for a 3x3 matrix F:\n        Fbar = J^{-1/3} * F, where J = det(F) > 0,\n    and check whether det(Fbar) is within eps of 1.\n\n    Parameters\n    ----------\n    F : np.ndarray\n        A 3x3 deformation gradient with positive determinant.\n    eps : float\n        Tolerance for the determinant check.\n\n    Returns\n    -------\n    Fbar : np.ndarray\n        The isochoric part of F with det(Fbar) approximately equal to 1.\n    det_ok : bool\n        True if |det(Fbar) - 1| = eps, False otherwise.\n    det_Fbar : float\n        The computed determinant of Fbar (for reference).\n    \"\"\"\n    # Compute Jacobian determinant\n    J = float(np.linalg.det(F))\n    if not np.isfinite(J) or J = 0.0:\n        # Not physically admissible for this decomposition; return failure.\n        return np.full_like(F, np.nan), False, np.nan\n\n    # Compute the cube root using a robust function\n    beta = float(np.cbrt(J))  # volumetric stretch scalar\n    # Scaling factor to remove volumetric part\n    s = 1.0 / beta\n\n    # Form isochoric F\n    Fbar = s * F\n\n    # Verify isochoric constraint numerically\n    det_Fbar = float(np.linalg.det(Fbar))\n    det_ok = abs(det_Fbar - 1.0) = eps\n\n    return Fbar, det_ok, det_Fbar\n\ndef build_test_suite():\n    # Test 1: Identity\n    F1 = np.eye(3)\n\n    # Test 2: Pure volumetric stretch 2*I\n    F2 = 2.0 * np.eye(3)\n\n    # Test 3: Simple shear with unit determinant\n    F3 = np.array([\n        [1.0, 0.3, 0.0],\n        [0.0, 1.0, 0.0],\n        [0.0, 0.0, 1.0]\n    ], dtype=float)\n\n    # Test 4: Rotation about z by theta then anisotropic stretch\n    theta = np.pi / 6.0  # radians\n    Rz = np.array([\n        [np.cos(theta), -np.sin(theta), 0.0],\n        [np.sin(theta),  np.cos(theta), 0.0],\n        [0.0,            0.0,           1.0]\n    ], dtype=float)\n    D = np.diag([1.5, 0.8, 1.2])\n    F4 = Rz @ D\n\n    # Test 5: Highly anisotropic with small Jacobian\n    F5 = np.diag([1e-3, 1.0, 1.0])\n\n    # Test 6: Upper-triangular nearly incompressible\n    F6 = np.array([\n        [1.02, 0.01, 0.0],\n        [0.0,  0.98, 0.02],\n        [0.0,  0.0,  1.01]\n    ], dtype=float)\n\n    return [F1, F2, F3, F4, F5, F6]\n\ndef solve():\n    eps = 1e-9\n    test_cases = build_test_suite()\n    results = []\n    for F in test_cases:\n        _, det_ok, _ = isochoric_map(F, eps=eps)\n        results.append(det_ok)\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}