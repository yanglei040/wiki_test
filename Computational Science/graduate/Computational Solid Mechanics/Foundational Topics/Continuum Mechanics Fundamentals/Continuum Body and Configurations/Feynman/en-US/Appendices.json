{
    "hands_on_practices": [
        {
            "introduction": "The deformation gradient, denoted by $\\mathbf{F}$, is the cornerstone of continuum mechanics, providing a complete local description of the deformation from a reference to a current configuration. Its determinant, the Jacobian $J = \\det \\mathbf{F}$, has a direct and crucial physical interpretation: it measures the change in local volume. This exercise provides hands-on practice in calculating $\\mathbf{F}$ from a given motion and using the value of $J$ to assess whether the deformation is physically plausible and how the volume is changing .",
            "id": "3554274",
            "problem": "Consider a three-dimensional continuum body undergoing the smooth motion given by the mapping from reference coordinates $\\mathbf{X} = (X_1, X_2, X_3)$ to current coordinates $\\mathbf{x} = (x_1, x_2, x_3)$:\n$$\nx_{1}(\\mathbf{X},t) = \\bigl(1 + \\alpha t\\bigr)\\,X_{1} + \\delta t\\,X_{2}, \\quad\nx_{2}(\\mathbf{X},t) = \\bigl(1 - \\alpha t\\bigr)\\,X_{2} + \\varepsilon t\\,X_{3}, \\quad\nx_{3}(\\mathbf{X},t) = \\bigl(1 - \\alpha t\\bigr)\\,X_{3},\n$$\nwhere $\\alpha$, $\\delta$, and $\\varepsilon$ are real constants and $t$ is time. This motion is $C^{1}$ in both $\\mathbf{X}$ and $t$ and satisfies $\\mathbf{x}(\\mathbf{X},0) = \\mathbf{X}$. At the advanced graduate level, you are to start from the fundamental kinematic definitions: the deformation gradient $\\mathbf{F}(\\mathbf{X},t) = \\partial \\mathbf{x}/\\partial \\mathbf{X}$ and the local volume ratio $J(\\mathbf{X},t) = \\det \\mathbf{F}(\\mathbf{X},t)$. Use only these core definitions and standard properties of determinants.\n\nFor the parameter values $\\alpha = -\\tfrac{1}{2}\\,\\mathrm{s}^{-1}$, $\\delta = 3\\,\\mathrm{s}^{-1}$, $\\varepsilon = 1\\,\\mathrm{s}^{-1}$, evaluate the deformation gradient at time $t = 3\\,\\mathrm{s}$ and compute the Jacobian $J$ at that time. Based on the sign and magnitude of $J$, determine whether the local motion at $t = 3\\,\\mathrm{s}$ is compressible (with preserved orientation), incompressible, or exhibits inversion (orientation reversal). Express the final requested quantity $J$ as an exact number (no rounding). Note that $J$ is dimensionless. The assessment of compressibility should be justified but does not need to be included in the final numerical answer.",
            "solution": "The problem is valid as it is scientifically grounded in the principles of continuum mechanics, is well-posed with all necessary information provided, and is stated objectively. The initial condition $\\mathbf{x}(\\mathbf{X},0) = \\mathbf{X}$ is satisfied by the given motion, ensuring consistency.\n\nThe solution proceeds by first determining the deformation gradient tensor, $\\mathbf{F}$, from its fundamental definition as the spatial gradient of the motion function with respect to the reference coordinates. The components of $\\mathbf{F}$ are given by $F_{ij} = \\frac{\\partial x_i}{\\partial X_j}$. The given motion is:\n$$\nx_{1}(\\mathbf{X},t) = \\bigl(1 + \\alpha t\\bigr)\\,X_{1} + \\delta t\\,X_{2}\n$$\n$$\nx_{2}(\\mathbf{X},t) = \\bigl(1 - \\alpha t\\bigr)\\,X_{2} + \\varepsilon t\\,X_{3}\n$$\n$$\nx_{3}(\\mathbf{X},t) = \\bigl(1 - \\alpha t\\bigr)\\,X_{3}\n$$\nWe compute the nine components of the deformation gradient matrix $\\mathbf{F}$:\n$F_{11} = \\frac{\\partial x_{1}}{\\partial X_{1}} = 1 + \\alpha t$\n$F_{12} = \\frac{\\partial x_{1}}{\\partial X_{2}} = \\delta t$\n$F_{13} = \\frac{\\partial x_{1}}{\\partial X_{3}} = 0$\n$F_{21} = \\frac{\\partial x_{2}}{\\partial X_{1}} = 0$\n$F_{22} = \\frac{\\partial x_{2}}{\\partial X_{2}} = 1 - \\alpha t$\n$F_{23} = \\frac{\\partial x_{2}}{\\partial X_{3}} = \\varepsilon t$\n$F_{31} = \\frac{\\partial x_{3}}{\\partial X_{1}} = 0$\n$F_{32} = \\frac{\\partial x_{3}}{\\partial X_{2}} = 0$\n$F_{33} = \\frac{\\partial x_{3}}{\\partial X_{3}} = 1 - \\alpha t$\n\nAssembling these components into a matrix, the deformation gradient tensor $\\mathbf{F}$ is:\n$$\n\\mathbf{F}(\\mathbf{X},t) = \\begin{pmatrix}\n1 + \\alpha t & \\delta t & 0 \\\\\n0 & 1 - \\alpha t & \\varepsilon t \\\\\n0 & 0 & 1 - \\alpha t\n\\end{pmatrix}\n$$\nThe problem requires evaluating $\\mathbf{F}$ at time $t = 3\\,\\mathrm{s}$ using the parameter values $\\alpha = -\\frac{1}{2}\\,\\mathrm{s}^{-1}$, $\\delta = 3\\,\\mathrm{s}^{-1}$, and $\\varepsilon = 1\\,\\mathrm{s}^{-1}$. First, we compute the dimensionless products:\n$\\alpha t = \\left(-\\frac{1}{2}\\right) \\cdot 3 = -\\frac{3}{2}$\n$\\delta t = 3 \\cdot 3 = 9$\n$\\varepsilon t = 1 \\cdot 3 = 3$\n\nSubstituting these values into the expression for $\\mathbf{F}$:\n$F_{11} = 1 + \\alpha t = 1 + \\left(-\\frac{3}{2}\\right) = -\\frac{1}{2}$\n$F_{12} = \\delta t = 9$\n$F_{13} = 0$\n$F_{21} = 0$\n$F_{22} = 1 - \\alpha t = 1 - \\left(-\\frac{3}{2}\\right) = 1 + \\frac{3}{2} = \\frac{5}{2}$\n$F_{23} = \\varepsilon t = 3$\n$F_{31} = 0$\n$F_{32} = 0$\n$F_{33} = 1 - \\alpha t = 1 - \\left(-\\frac{3}{2}\\right) = \\frac{5}{2}$\n\nThe deformation gradient at $t = 3\\,\\mathrm{s}$ is therefore:\n$$\n\\mathbf{F}(t=3\\,\\mathrm{s}) = \\begin{pmatrix}\n-\\frac{1}{2} & 9 & 0 \\\\\n0 & \\frac{5}{2} & 3 \\\\\n0 & 0 & \\frac{5}{2}\n\\end{pmatrix}\n$$\nThe Jacobian, or local volume ratio, is defined as $J(\\mathbf{X},t) = \\det \\mathbf{F}(\\mathbf{X},t)$. Since $\\mathbf{F}$ is an upper triangular matrix, its determinant is the product of its diagonal elements.\n$$\nJ(t=3\\,\\mathrm{s}) = \\det\\begin{pmatrix}\n-\\frac{1}{2} & 9 & 0 \\\\\n0 & \\frac{5}{2} & 3 \\\\\n0 & 0 & \\frac{5}{2}\n\\end{pmatrix} = \\left(-\\frac{1}{2}\\right) \\left(\\frac{5}{2}\\right) \\left(\\frac{5}{2}\\right) = -\\frac{25}{8}\n$$\nThe value of the Jacobian is $J = -\\frac{25}{8}$.\nTo interpret this result, we consider the sign and magnitude of $J$.\n1.  **Sign of $J$**: Since $J = -\\frac{25}{8}  0$, the local orientation of the material is reversed. This is termed local material inversion. A motion is physically admissible only if $J > 0$, but the mathematical description allows for $J  0$.\n2.  **Magnitude of $J$**: The magnitude is $|J| = |-\\frac{25}{8}| = \\frac{25}{8} = 3.125$. Since $|J| \\neq 1$, the volume of the material element has changed. A motion is incompressible if $|J|=1$ at all points and times. Since $|J| \\neq 1$, the motion is compressible. Specifically, the local volume is expanded by a factor of $\\frac{25}{8}$.\n\nIn summary, the motion at $t = 3\\,\\mathrm{s}$ is compressible and exhibits orientation reversal. The final requested quantity is the value of $J$.",
            "answer": "$$\\boxed{-\\frac{25}{8}}$$"
        },
        {
            "introduction": "Any general deformation can be seen as a combination of local stretching and rigid rotation, but the deformation gradient $\\mathbf{F}$ combines these effects. The polar decomposition theorem formalizes this physical intuition by uniquely decomposing $\\mathbf{F}$ into a rotation tensor $\\mathbf{R}$ and a symmetric right stretch tensor $\\mathbf{U}$ via $\\mathbf{F} = \\mathbf{R}\\mathbf{U}$. This exercise provides essential practice in performing this decomposition, a fundamental skill required for formulating constitutive laws that are independent of rigid body motions .",
            "id": "3554283",
            "problem": "A homogeneous, elastic continuum body occupies a reference configuration with material coordinates denoted by $\\mathbf{X} \\in \\mathbb{R}^{3}$. Under a smooth, invertible motion $\\boldsymbol{\\varphi}$, the body is mapped to a current configuration with spatial coordinates $\\mathbf{x} = \\boldsymbol{\\varphi}(\\mathbf{X})$. The local deformation at a material point is characterized by the deformation gradient $\\mathbf{F} = \\dfrac{\\partial \\boldsymbol{\\varphi}}{\\partial \\mathbf{X}}$, assumed to be nonsingular with $\\det \\mathbf{F} > 0$. The right Cauchy–Green deformation tensor is defined by $\\mathbf{C} = \\mathbf{F}^{\\mathsf{T}} \\mathbf{F}$. The polar decomposition theorem states that there exists a unique proper orthogonal tensor $\\mathbf{R}$ and a unique symmetric positive-definite right stretch tensor $\\mathbf{U}$ such that $\\mathbf{F} = \\mathbf{R}\\mathbf{U}$. The principal stretches are defined as the positive square roots of the eigenvalues of $\\mathbf{C}$.\n\nAt a given material point, the measured deformation gradient is\n$$\n\\mathbf{F} =\n\\begin{pmatrix}\n1.5  0.5  0 \\\\\n0.2  1.3  0 \\\\\n0  0  0.8\n\\end{pmatrix}.\n$$\n\nUsing only foundational definitions and theorems about kinematics of continua, perform the following:\n\n- Construct $\\mathbf{C}$ and justify its symmetry and positive-definiteness for the given $\\mathbf{F}$.\n- Determine the principal stretches by appropriate spectral analysis of $\\mathbf{C}$.\n- Compute the right stretch tensor $\\mathbf{U}$ and the rotation tensor $\\mathbf{R}$ from the polar decomposition of $\\mathbf{F}$, explaining each step of the construction in terms of fundamental kinematic definitions.\n\nFinally, report the largest principal stretch as a unitless scalar, rounded to four significant figures. Provide no intermediate values in the final answer, only the requested scalar. Angle measures, if introduced in your derivation, must be in radians, but are not required in the final answer.",
            "solution": "The analysis proceeds in three stages as stipulated by the problem statement: construction and validation of the right Cauchy–Green tensor $\\mathbf{C}$, spectral analysis of $\\mathbf{C}$ to find the principal stretches, and polar decomposition of the deformation gradient $\\mathbf{F}$ into the rotation tensor $\\mathbf{R}$ and the right stretch tensor $\\mathbf{U}$.\n\nFirst, we construct the right Cauchy–Green deformation tensor $\\mathbf{C}$ using its definition, $\\mathbf{C} = \\mathbf{F}^{\\mathsf{T}} \\mathbf{F}$. The given deformation gradient is\n$$\n\\mathbf{F} =\n\\begin{pmatrix}\n1.5  0.5  0 \\\\\n0.2  1.3  0 \\\\\n0  0  0.8\n\\end{pmatrix}\n$$\nIts transpose is\n$$\n\\mathbf{F}^{\\mathsf{T}} =\n\\begin{pmatrix}\n1.5  0.2  0 \\\\\n0.5  1.3  0 \\\\\n0  0  0.8\n\\end{pmatrix}\n$$\nThe product $\\mathbf{C} = \\mathbf{F}^{\\mathsf{T}} \\mathbf{F}$ is computed as:\n$$\n\\mathbf{C} = \\begin{pmatrix}\n1.5  0.2  0 \\\\\n0.5  1.3  0 \\\\\n0  0  0.8\n\\end{pmatrix}\n\\begin{pmatrix}\n1.5  0.5  0 \\\\\n0.2  1.3  0 \\\\\n0  0  0.8\n\\end{pmatrix}\n= \\begin{pmatrix}\n(1.5)^2 + (0.2)^2  (1.5)(0.5) + (0.2)(1.3)  0 \\\\\n(0.5)(1.5) + (1.3)(0.2)  (0.5)^2 + (1.3)^2  0 \\\\\n0  0  (0.8)^2\n\\end{pmatrix}\n$$\n$$\n\\mathbf{C} = \\begin{pmatrix}\n2.25 + 0.04  0.75 + 0.26  0 \\\\\n0.75 + 0.26  0.25 + 1.69  0 \\\\\n0  0  0.64\n\\end{pmatrix}\n= \\begin{pmatrix}\n2.29  1.01  0 \\\\\n1.01  1.94  0 \\\\\n0  0  0.64\n\\end{pmatrix}\n$$\nThe tensor $\\mathbf{C}$ is symmetric by definition. This can be proven formally: $\\mathbf{C}^{\\mathsf{T}} = (\\mathbf{F}^{\\mathsf{T}}\\mathbf{F})^{\\mathsf{T}} = \\mathbf{F}^{\\mathsf{T}}(\\mathbf{F}^{\\mathsf{T}})^{\\mathsf{T}} = \\mathbf{F}^{\\mathsf{T}}\\mathbf{F} = \\mathbf{C}$. The calculated matrix is visibly symmetric as well, with $C_{12} = C_{21} = 1.01$.\n\nThe tensor $\\mathbf{C}$ must be positive-definite. This follows from its definition and the fact that $\\mathbf{F}$ is nonsingular. For any non-zero vector $\\mathbf{z} \\in \\mathbb{R}^3$, the quadratic form is $\\mathbf{z}^{\\mathsf{T}} \\mathbf{C} \\mathbf{z} = \\mathbf{z}^{\\mathsf{T}} (\\mathbf{F}^{\\mathsf{T}} \\mathbf{F}) \\mathbf{z} = (\\mathbf{Fz})^{\\mathsf{T}} (\\mathbf{Fz}) = ||\\mathbf{Fz}||_2^2$. Since $\\det \\mathbf{F} = (1.5 \\times 1.3 - 0.5 \\times 0.2) \\times 0.8 = (1.95 - 0.1) \\times 0.8 = 1.48 \\neq 0$, the matrix $\\mathbf{F}$ is nonsingular. Thus, if $\\mathbf{z} \\neq \\mathbf{0}$, then $\\mathbf{Fz} \\neq \\mathbf{0}$, and its squared Euclidean norm $||\\mathbf{Fz}||_2^2$ is strictly positive. Therefore, $\\mathbf{C}$ is positive-definite. Computationally, this can be verified by checking that all eigenvalues of $\\mathbf{C}$ are positive, which will be done next.\n\nSecond, we determine the principal stretches, which are the positive square roots of the eigenvalues of $\\mathbf{C}$. Let the eigenvalues of $\\mathbf{C}$ be denoted by $\\mu$. They are the roots of the characteristic equation $\\det(\\mathbf{C} - \\mu\\mathbf{I}) = 0$.\n$$\n\\det \\begin{pmatrix}\n2.29 - \\mu  1.01  0 \\\\\n1.01  1.94 - \\mu  0 \\\\\n0  0  0.64 - \\mu\n\\end{pmatrix} = 0\n$$\nExpanding the determinant along the third row gives:\n$$\n(0.64 - \\mu) \\left[ (2.29 - \\mu)(1.94 - \\mu) - (1.01)^2 \\right] = 0\n$$\nThis equation reveals one eigenvalue immediately: $\\mu_3 = 0.64$. The other two eigenvalues are roots of the quadratic equation:\n$$\n(2.29 - \\mu)(1.94 - \\mu) - 1.0201 = 0\n$$\n$$\n\\mu^2 - (2.29 + 1.94)\\mu + (2.29 \\times 1.94) - 1.0201 = 0\n$$\n$$\n\\mu^2 - 4.23\\mu + 4.4426 - 1.0201 = 0\n$$\n$$\n\\mu^2 - 4.23\\mu + 3.4225 = 0\n$$\nUsing the quadratic formula, $\\mu = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$:\n$$\n\\mu = \\frac{4.23 \\pm \\sqrt{(-4.23)^2 - 4(1)(3.4225)}}{2} = \\frac{4.23 \\pm \\sqrt{17.8929 - 13.69}}{2} = \\frac{4.23 \\pm \\sqrt{4.2029}}{2}\n$$\nThe two eigenvalues are:\n$$\n\\mu_1 = \\frac{4.23 + \\sqrt{4.2029}}{2} \\approx 3.14005\n$$\n$$\n\\mu_2 = \\frac{4.23 - \\sqrt{4.2029}}{2} \\approx 1.08995\n$$\nThe eigenvalues of $\\mathbf{C}$, sorted in descending order, are $\\mu_1 \\approx 3.14005$, $\\mu_2 \\approx 1.08995$, and $\\mu_3 = 0.64$. Since all are positive, the positive-definiteness of $\\mathbf{C}$ is confirmed.\nThe principal stretches, $\\lambda_i$, are the positive square roots of these eigenvalues:\n$$\n\\lambda_1 = \\sqrt{\\mu_1} \\approx \\sqrt{3.14005} \\approx 1.7720186\n$$\n$$\n\\lambda_2 = \\sqrt{\\mu_2} \\approx \\sqrt{1.08995} \\approx 1.0440073\n$$\n$$\n\\lambda_3 = \\sqrt{\\mu_3} = \\sqrt{0.64} = 0.8\n$$\n\nThird, we compute the right stretch tensor $\\mathbf{U}$ and the rotation tensor $\\mathbf{R}$. The tensor $\\mathbf{U}$ is the unique symmetric positive-definite square root of $\\mathbf{C}$, i.e., $\\mathbf{U} = \\sqrt{\\mathbf{C}}$. By the spectral theorem, if $\\mathbf{C} = \\sum_{i=1}^3 \\mu_i \\mathbf{n}_i \\otimes \\mathbf{n}_i$, then $\\mathbf{U} = \\sum_{i=1}^3 \\sqrt{\\mu_i} \\mathbf{n}_i \\otimes \\mathbf{n}_i = \\sum_{i=1}^3 \\lambda_i \\mathbf{n}_i \\otimes \\mathbf{n}_i$. Due to the block-diagonal structure of $\\mathbf{C}$, the calculation can be simplified. The eigenvector for $\\mu_3=0.64$ is clearly $\\mathbf{n}_3 = (0, 0, 1)^{\\mathsf{T}}$. For the upper-left $2 \\times 2$ block of $\\mathbf{C}$, denoted $\\mathbf{C}_{2D}$, we can use a direct formula for the square root of a $2 \\times 2$ positive-definite symmetric matrix $A$: $\\sqrt{A} = \\frac{1}{t}(A + \\sqrt{\\det A} \\mathbf{I})$, where $t = \\sqrt{\\mathrm{tr}(A) + 2\\sqrt{\\det A}}$.\nFor $\\mathbf{C}_{2D} = \\begin{pmatrix} 2.29  1.01 \\\\ 1.01  1.94 \\end{pmatrix}$:\n$$\n\\mathrm{tr}(\\mathbf{C}_{2D}) = 2.29 + 1.94 = 4.23\n$$\n$$\n\\det(\\mathbf{C}_{2D}) = (2.29)(1.94) - (1.01)^2 = 3.4225 \\implies \\sqrt{\\det(\\mathbf{C}_{2D})} = 1.85\n$$\n$$\nt = \\sqrt{4.23 + 2(1.85)} = \\sqrt{7.93}\n$$\nThe square root $\\mathbf{U}_{2D} = \\sqrt{\\mathbf{C}_{2D}}$ is:\n$$\n\\mathbf{U}_{2D} = \\frac{1}{\\sqrt{7.93}} \\left( \\begin{pmatrix} 2.29  1.01 \\\\ 1.01  1.94 \\end{pmatrix} + 1.85 \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} \\right) = \\frac{1}{\\sqrt{7.93}} \\begin{pmatrix} 4.14  1.01 \\\\ 1.01  3.79 \\end{pmatrix} \\approx \\begin{pmatrix} 1.4698  0.3587 \\\\ 0.3587  1.3459 \\end{pmatrix}\n$$\nCombining this with the third dimension, where $U_{33} = \\sqrt{C_{33}} = \\sqrt{0.64} = 0.8$, we get $\\mathbf{U}$:\n$$\n\\mathbf{U} \\approx \\begin{pmatrix} 1.4698  0.3587  0 \\\\ 0.3587  1.3459  0 \\\\ 0  0  0.8 \\end{pmatrix}\n$$\nThe rotation tensor $\\mathbf{R}$ is found from $\\mathbf{F} = \\mathbf{R}\\mathbf{U}$, which gives $\\mathbf{R} = \\mathbf{F}\\mathbf{U}^{-1}$. We first find $\\mathbf{U}^{-1}$:\n$$\n\\mathbf{U}^{-1} = \\begin{pmatrix} \\mathbf{U}_{2D}^{-1}  \\mathbf{0} \\\\ \\mathbf{0}^{\\mathsf{T}}  (0.8)^{-1} \\end{pmatrix}\n$$\n$$\n\\mathbf{U}_{2D}^{-1} = \\frac{1}{\\det(\\mathbf{U}_{2D})} \\begin{pmatrix} U_{22}  -U_{12} \\\\ -U_{12}  U_{11} \\end{pmatrix} = \\frac{1}{1.85} \\begin{pmatrix} 1.3459  -0.3587 \\\\ -0.3587  1.4698 \\end{pmatrix} \\approx \\begin{pmatrix} 0.7275  -0.1939 \\\\ -0.1939  0.7945 \\end{pmatrix}\n$$\nSo,\n$$\n\\mathbf{U}^{-1} \\approx \\begin{pmatrix} 0.7275  -0.1939  0 \\\\ -0.1939  0.7945  0 \\\\ 0  0  1.25 \\end{pmatrix}\n$$\nFinally, we compute $\\mathbf{R}$:\n$$\n\\mathbf{R} = \\mathbf{F}\\mathbf{U}^{-1} \\approx \\begin{pmatrix} 1.5  0.5  0 \\\\ 0.2  1.3  0 \\\\ 0  0  0.8 \\end{pmatrix} \\begin{pmatrix} 0.7275  -0.1939  0 \\\\ -0.1939  0.7945  0 \\\\ 0  0  1.25 \\end{pmatrix}\n$$\n$$\n\\mathbf{R} \\approx \\begin{pmatrix} 0.9943  0.1064  0 \\\\ -0.1066  0.9941  0 \\\\ 0  0  1 \\end{pmatrix}\n$$\nThis matrix $\\mathbf{R}$ is a proper orthogonal tensor, as $\\mathbf{R}^{\\mathsf{T}}\\mathbf{R} \\approx \\mathbf{I}$ and $\\det(\\mathbf{R}) \\approx 1$, confirming the polar decomposition.\n\nThe problem asks for the largest principal stretch, $\\lambda_{\\max}$, rounded to four significant figures. This is $\\lambda_1$:\n$$\n\\lambda_{\\max} = \\lambda_1 \\approx 1.7720186\n$$\nRounding to four significant figures gives $1.772$.",
            "answer": "$$\\boxed{1.772}$$"
        },
        {
            "introduction": "To formulate the fundamental laws of physics, such as the conservation of mass or momentum, for a deforming body, we need a way to handle integrals over volumes that change with time. The Reynolds transport theorem provides the exact mathematical tool for this, relating the time derivative of an integral over a moving domain to an integral over that same domain at a fixed instant. In this computational exercise, you will implement and numerically verify this crucial theorem, bridging the gap between abstract theory and practical implementation in computational mechanics .",
            "id": "3554354",
            "problem": "Consider a continuum body occupying a time-dependent spatial configuration denoted by $\\Omega(t) \\subset \\mathbb{R}^2$. Let the motion be described by the mapping $\\mathbf{x} = \\boldsymbol{\\chi}(\\mathbf{X},t)$ from a fixed reference configuration $\\Omega_0$ to the current configuration $\\Omega(t)$, where $\\mathbf{x} \\in \\Omega(t)$ is the spatial point, $\\mathbf{X} \\in \\Omega_0$ is the material point, and $t$ is time. The spatial velocity field is $\\mathbf{v}(\\mathbf{x},t) = \\dot{\\boldsymbol{\\chi}}(\\mathbf{X},t)$, the material time derivative of the motion evaluated at $\\mathbf{X}$ such that $\\mathbf{x} = \\boldsymbol{\\chi}(\\mathbf{X},t)$. For a sufficiently smooth scalar field $f(\\mathbf{x},t)$, the material time derivative is defined as $\\dot{f}(\\mathbf{x},t) = \\frac{\\partial f}{\\partial t}(\\mathbf{x},t) + \\mathbf{v}(\\mathbf{x},t)\\cdot\\nabla f(\\mathbf{x},t)$. The divergence of the velocity field is $\\nabla\\cdot \\mathbf{v}(\\mathbf{x},t)$.\n\nYour task is to implement a program that, for a family of moving domains with prescribed boundary velocity induced by a uniform isotropic scaling motion, numerically verifies the consistency of the transport identity relating the rate of change of a spatial integral over $\\Omega(t)$ to a volume integral over $\\Omega(t)$ composed of $f$, $\\dot{f}$, and $\\nabla \\cdot \\mathbf{v}$. The domain is a rectangle that uniformly expands or remains stationary according to a scaling factor $a(t)$. The motion is given by $\\mathbf{x} = a(t) \\mathbf{X}$ with $a(t) > 0$, so that the boundary $\\partial \\Omega(t)$ moves with velocity $\\mathbf{v}(\\mathbf{x},t) = \\frac{\\dot{a}(t)}{a(t)} \\mathbf{x}$, and $\\nabla\\cdot \\mathbf{v}(\\mathbf{x},t) = 2\\frac{\\dot{a}(t)}{a(t)}$ for the two-dimensional case. You must compute two quantities at a specified time $t_0$:\n- A finite-difference approximation of $\\frac{d}{dt}\\int_{\\Omega(t)} f(\\mathbf{x},t)\\,dV$ using a centered difference with a small time increment $\\Delta t$.\n- A numerical volume integral over $\\Omega(t_0)$ of a local integrand constructed from $\\dot{f}(\\mathbf{x},t_0)$ and $\\nabla\\cdot \\mathbf{v}(\\mathbf{x},t_0)$.\n\nYou must verify consistency by computing the absolute difference between these two quantities for each test case. All trigonometric functions must use angles in radians.\n\nImplement the following test suite, where each test case specifies the reference rectangle dimensions, the time $t_0$, the scaling law $a(t)$ and its time derivative $\\dot{a}(t)$, the scalar field $f(\\mathbf{x},t)$ along with its spatial gradient $\\nabla f(\\mathbf{x},t)$ and its explicit time derivative $\\frac{\\partial f}{\\partial t}(\\mathbf{x},t)$, the centered difference time step $\\Delta t$, and the uniform grid resolution $N$ for both directions. For each case, evaluate the absolute difference between the two quantities described above.\n\n- Case $1$ (happy path, moderate expansion):\n  - Reference dimensions: $L_x = 1.0$, $L_y = 0.8$.\n  - Time: $t_0 = 0.5$.\n  - Scaling: $a(t) = 1 + 0.1 t$, $\\dot{a}(t) = 0.1$.\n  - Field: $f(x,t) = x^2 + y^2 + t$, $\\nabla f(x,t) = (2x,\\,2y)$, $\\frac{\\partial f}{\\partial t}(x,t) = 1$.\n  - Time step: $\\Delta t = 10^{-3}$.\n  - Grid resolution: $N = 201$.\n- Case $2$ (rapid expansion, oscillatory field in radians):\n  - Reference dimensions: $L_x = 1.2$, $L_y = 0.7$.\n  - Time: $t_0 = 0.7$.\n  - Scaling: $a(t) = e^{0.3 t}$, $\\dot{a}(t) = 0.3 e^{0.3 t}$.\n  - Field: $f(x,t) = \\sin(x)\\cos(y) + t^3$ (angles in radians), $\\nabla f(x,t) = (\\cos(x)\\cos(y),\\, -\\sin(x)\\sin(y))$, $\\frac{\\partial f}{\\partial t}(x,t) = 3 t^2$.\n  - Time step: $\\Delta t = 10^{-3}$.\n  - Grid resolution: $N = 201$.\n- Case $3$ (stationary domain, nontrivial field):\n  - Reference dimensions: $L_x = 1.0$, $L_y = 1.0$.\n  - Time: $t_0 = 0.3$.\n  - Scaling: $a(t) = 1$, $\\dot{a}(t) = 0$.\n  - Field: $f(x,t) = e^{-x} y + t$, $\\nabla f(x,t) = (-e^{-x} y,\\, e^{-x})$, $\\frac{\\partial f}{\\partial t}(x,t) = 1$.\n  - Time step: $\\Delta t = 10^{-3}$.\n  - Grid resolution: $N = 201$.\n- Case $4$ (edge case, nearly stationary expansion, time-independent field):\n  - Reference dimensions: $L_x = 0.9$, $L_y = 0.9$.\n  - Time: $t_0 = 0.4$.\n  - Scaling: $a(t) = 1 + 10^{-8} t$, $\\dot{a}(t) = 10^{-8}$.\n  - Field: $f(x,t) = x y$, $\\nabla f(x,t) = (y,\\, x)$, $\\frac{\\partial f}{\\partial t}(x,t) = 0$.\n  - Time step: $\\Delta t = 10^{-3}$.\n  - Grid resolution: $N = 201$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the test cases listed above, where each entry is the floating-point absolute difference for the corresponding test case, for example, $[r_1,r_2,r_3,r_4]$. No physical units are required in the output. Angles must be in radians for all trigonometric evaluations.",
            "solution": "The user-provided problem requires the numerical verification of the Reynolds transport theorem for a two-dimensional continuum body undergoing a uniform isotropic scaling motion. The theorem provides a relationship between the time derivative of an integral over a time-varying domain and an integral over the same domain at a specific instant.\n\nThe general form of the Reynolds transport theorem for a scalar field $f(\\mathbf{x},t)$ integrated over a time-dependent volume $\\Omega(t)$ is:\n$$\n\\frac{d}{dt} \\int_{\\Omega(t)} f(\\mathbf{x},t) \\, dV = \\int_{\\Omega(t)} \\left( \\frac{\\partial f}{\\partial t}(\\mathbf{x},t) + \\nabla \\cdot \\left(f(\\mathbf{x},t) \\mathbf{v}(\\mathbf{x},t)\\right) \\right) \\, dV\n$$\nwhere $\\mathbf{v}(\\mathbf{x},t)$ is the velocity field of the points in the domain.\n\nUsing the product rule for the divergence of a scalar-vector product, $\\nabla \\cdot (f \\mathbf{v}) = (\\nabla f) \\cdot \\mathbf{v} + f (\\nabla \\cdot \\mathbf{v})$, we can rewrite the integrand:\n$$\n\\frac{d}{dt} \\int_{\\Omega(t)} f(\\mathbf{x},t) \\, dV = \\int_{\\Omega(t)} \\left( \\frac{\\partial f}{\\partial t} + (\\nabla f) \\cdot \\mathbf{v} + f (\\nabla \\cdot \\mathbf{v}) \\right) \\, dV\n$$\nThe problem statement defines the material time derivative of $f$ as $\\dot{f}(\\mathbf{x},t) = \\frac{\\partial f}{\\partial t}(\\mathbf{x},t) + \\mathbf{v}(\\mathbf{x},t)\\cdot\\nabla f(\\mathbf{x},t)$. Substituting this definition into the equation yields the specific form of the transport identity to be verified:\n$$\n\\frac{d}{dt} \\int_{\\Omega(t)} f(\\mathbf{x},t) \\, dV = \\int_{\\Omega(t)} \\left( \\dot{f}(\\mathbf{x},t) + f(\\mathbf{x},t) (\\nabla \\cdot \\mathbf{v}(\\mathbf{x},t)) \\right) \\, dV\n$$\nThe task is to numerically evaluate both the left-hand side (LHS) and the right-hand side (RHS) of this equation for several test cases and compute the absolute difference between them.\n\nThe motion is specified as a uniform scaling $\\mathbf{x} = a(t)\\mathbf{X}$, where $\\mathbf{X}$ belongs to a reference rectangular domain $\\Omega_0 = [0, L_x] \\times [0, L_y]$. The current configuration is therefore $\\Omega(t) = [0, a(t)L_x] \\times [0, a(t)L_y]$. The velocity field is $\\mathbf{v}(\\mathbf{x},t) = \\frac{\\dot{a}(t)}{a(t)}\\mathbf{x}$, and its divergence in two dimensions is $\\nabla \\cdot \\mathbf{v}(\\mathbf{x},t) = 2\\frac{\\dot{a}(t)}{a(t)}$.\n\n**Numerical Evaluation of the Left-Hand Side (LHS)**\n\nThe LHS is the time derivative of the integral $I(t) = \\int_{\\Omega(t)} f(\\mathbf{x},t) \\, dV$. We approximate this derivative at time $t_0$ using a second-order centered finite difference scheme with a small time step $\\Delta t$:\n$$\nLHS = \\frac{dI}{dt}\\bigg|_{t_0} \\approx \\frac{I(t_0 + \\Delta t) - I(t_0 - \\Delta t)}{2 \\Delta t}\n$$\nThe integral $I(t)$ at any given time $t$ is computed numerically over the domain $\\Omega(t) = [0, a(t)L_x] \\times [0, a(t)L_y]$. We discretize this domain using a uniform grid of $N \\times N$ points. The integral is then approximated using the two-dimensional trapezoidal rule. For a function $g(x,y)$ on a grid with coordinates $\\{x_i\\}$ and $\\{y_j\\}$, the integral is computed as:\n$$\n\\int \\int g(x,y) \\, dx \\, dy \\approx \\text{trapz}(\\text{trapz}(g_{ij}, x=x_i, \\text{axis}=1), y=y_j, \\text{axis}=0)\n$$\n\n**Numerical Evaluation of the Right-Hand Side (RHS)**\n\nThe RHS is the integral of the quantity $g(\\mathbf{x},t_0) = \\dot{f}(\\mathbf{x},t_0) + f(\\mathbf{x},t_0) (\\nabla \\cdot \\mathbf{v}(\\mathbf{x},t_0))$ over the domain $\\Omega(t_0)$. This is also computed using the two-dimensional trapezoidal rule on an $N \\times N$ grid spanning $\\Omega(t_0) = [0, a(t_0)L_x] \\times [0, a(t_0)L_y]$.\n\nThe integrand $g(x,y,t_0)$ is constructed at each grid point $(x,y)$ using the provided functions and definitions:\n$$\n\\dot{f}(x,y,t_0) = \\frac{\\partial f}{\\partial t}(x,y,t_0) + \\mathbf{v}(x,y,t_0) \\cdot \\nabla f(x,y,t_0)\n$$\nwhere $\\mathbf{v}(x,y,t_0) = (\\frac{\\dot{a}(t_0)}{a(t_0)}x, \\frac{\\dot{a}(t_0)}{a(t_0)}y)$. All components ($f$, $\\frac{\\partial f}{\\partial t}$, $\\nabla f$, $a(t)$, $\\dot{a}(t)$) are provided for each test case.\nThe full integrand for the RHS is:\n$$\ng(x,y,t_0) = \\left( \\frac{\\partial f}{\\partial t} + \\mathbf{v} \\cdot \\nabla f \\right)\\bigg|_{(x,y,t_0)} + f(x,y,t_0) \\left( 2 \\frac{\\dot{a}(t_0)}{a(t_0)} \\right)\n$$\n\n**Verification**\nFor each case, we compute the absolute difference $|LHS - RHS|$. A small difference, attributable to discretization errors from the finite difference approximation and numerical integration, will confirm the consistency of the transport identity. The implementation will define all given functions and parameters for each test case, perform the calculations as described, and report the absolute differences. All numerical operations on grid points are performed using vectorized `numpy` functions for efficiency.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Numerically verifies the Reynolds transport theorem for a 2D scaling domain.\n\n    The program computes two quantities for several test cases:\n    1. A finite-difference approximation of the time derivative of a spatial integral over\n       a time-dependent domain Omega(t).\n    2. A spatial integral of a derived integrand over the domain at a specific time t_0.\n\n    It then calculates the absolute difference between these two quantities to verify\n    the consistency of the transport identity.\n    \"\"\"\n\n    def _compute_spatial_integral(t, Lx, Ly, a_func, f_func, N):\n        \"\"\"\n        Computes the spatial integral of f(x,t) over Omega(t) using the 2D trapezoidal rule.\n        \"\"\"\n        at = a_func(t)\n        if at = 0:\n            # The problem statement guarantees a(t) > 0, but this is a safeguard.\n            return 0.0\n        \n        x_max, y_max = at * Lx, at * Ly\n        \n        x_coords = np.linspace(0.0, x_max, N)\n        y_coords = np.linspace(0.0, y_max, N)\n        \n        # 'xy' indexing: X is (N, N), Y is (N, N)\n        # The first dimension (axis 0) corresponds to y, second (axis 1) to x.\n        X, Y = np.meshgrid(x_coords, y_coords, indexing='xy')\n        \n        f_values = f_func(X, Y, t)\n        \n        # Integrate along x-axis (axis=1) for each y, then integrate the result along y-axis (axis=0)\n        integral_over_x = np.trapz(f_values, x=x_coords, axis=1)\n        total_integral = np.trapz(integral_over_x, x=y_coords, axis=0)\n        \n        return total_integral\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1\n        {\n            \"Lx\": 1.0, \"Ly\": 0.8, \"t0\": 0.5, \"Delta_t\": 1e-3, \"N\": 201,\n            \"a_func\": lambda t: 1 + 0.1 * t,\n            \"adot_func\": lambda t: 0.1,\n            \"f_func\": lambda x, y, t: x**2 + y**2 + t,\n            \"gradf_func\": lambda x, y, t: (2*x, 2*y),\n            \"dfdt_func\": lambda x, y, t: 1.0\n        },\n        # Case 2\n        {\n            \"Lx\": 1.2, \"Ly\": 0.7, \"t0\": 0.7, \"Delta_t\": 1e-3, \"N\": 201,\n            \"a_func\": lambda t: np.exp(0.3 * t),\n            \"adot_func\": lambda t: 0.3 * np.exp(0.3 * t),\n            \"f_func\": lambda x, y, t: np.sin(x) * np.cos(y) + t**3,\n            \"gradf_func\": lambda x, y, t: (np.cos(x) * np.cos(y), -np.sin(x) * np.sin(y)),\n            \"dfdt_func\": lambda x, y, t: 3 * t**2\n        },\n        # Case 3\n        {\n            \"Lx\": 1.0, \"Ly\": 1.0, \"t0\": 0.3, \"Delta_t\": 1e-3, \"N\": 201,\n            \"a_func\": lambda t: 1.0,\n            \"adot_func\": lambda t: 0.0,\n            \"f_func\": lambda x, y, t: np.exp(-x) * y + t,\n            \"gradf_func\": lambda x, y, t: (-np.exp(-x) * y, np.exp(-x)),\n            \"dfdt_func\": lambda x, y, t: 1.0\n        },\n        # Case 4\n        {\n            \"Lx\": 0.9, \"Ly\": 0.9, \"t0\": 0.4, \"Delta_t\": 1e-3, \"N\": 201,\n            \"a_func\": lambda t: 1 + 1e-8 * t,\n            \"adot_func\": lambda t: 1e-8,\n            \"f_func\": lambda x, y, t: x * y,\n            \"gradf_func\": lambda x, y, t: (y, x),\n            \"dfdt_func\": lambda x, y, t: 0.0\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        Lx, Ly, t0, Delta_t, N = case[\"Lx\"], case[\"Ly\"], case[\"t0\"], case[\"Delta_t\"], case[\"N\"]\n        a_func, adot_func = case[\"a_func\"], case[\"adot_func\"]\n        f_func, gradf_func, dfdt_func = case[\"f_func\"], case[\"gradf_func\"], case[\"dfdt_func\"]\n\n        # --- Quantity 1: Finite difference of the integral ---\n        I_plus = _compute_spatial_integral(t0 + Delta_t, Lx, Ly, a_func, f_func, N)\n        I_minus = _compute_spatial_integral(t0 - Delta_t, Lx, Ly, a_func, f_func, N)\n        lhs = (I_plus - I_minus) / (2 * Delta_t)\n\n        # --- Quantity 2: Integral of the derived integrand ---\n        # Setup grid and parameters at t0\n        at0 = a_func(t0)\n        adot_t0 = adot_func(t0)\n        \n        x_max_0, y_max_0 = at0 * Lx, at0 * Ly\n        x0_coords = np.linspace(0.0, x_max_0, N)\n        y0_coords = np.linspace(0.0, y_max_0, N)\n        X0, Y0 = np.meshgrid(x0_coords, y0_coords, indexing='xy')\n        \n        # Calculate terms of the integrand g = material_deriv(f) + f * div(v)\n        f_t0 = f_func(X0, Y0, t0)\n        gradf_x_t0, gradf_y_t0 = gradf_func(X0, Y0, t0)\n        dfdt_t0 = dfdt_func(X0, Y0, t0)\n\n        # Check for stationary case to avoid division by zero (0/0)\n        # Though a(t) > 0 is given, adot_t0 might approach 0 faster than at0-1\n        # For a(t)=1 case, adot/a is 0.\n        if at0 == 0: \n            vel_scaling = 0.0\n        else:\n            vel_scaling = adot_t0 / at0\n\n        vel_x_t0 = vel_scaling * X0\n        vel_y_t0 = vel_scaling * Y0\n        \n        v_dot_gradf = vel_x_t0 * gradf_x_t0 + vel_y_t0 * gradf_y_t0\n        material_deriv_f = dfdt_t0 + v_dot_gradf\n        \n        div_v = 2.0 * vel_scaling\n        f_times_div_v = f_t0 * div_v\n        \n        integrand_g = material_deriv_f + f_times_div_v\n        \n        # Integrate g over Omega(t0)\n        integral_g_x = np.trapz(integrand_g, x=x0_coords, axis=1)\n        rhs = np.trapz(integral_g_x, x=y0_coords, axis=0)\n        \n        # Compute absolute difference\n        abs_diff = np.abs(lhs - rhs)\n        results.append(abs_diff)\n        \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}