{
    "hands_on_practices": [
        {
            "introduction": "在深入研究复杂本构模型和计算方法之前，首要任务是熟练掌握不同应力张量之间的基本转换关系。本练习提供了一个具体的变形梯度 $F$ 和柯西应力 $\\sigma$，要求你直接计算第一和第二皮奥拉-基尔霍夫应力（$P$ 和 $S$）以及基尔霍夫应力 $\\tau$。通过这个基础计算和最终的恒等式验证，你将巩固对这些关键物理量之间数学联系的理解。",
            "id": "3594819",
            "problem": "一个均匀、等体积的变形由变形梯度 $F=\\operatorname{diag}(2,\\,1/2,\\,1)$ 表征。在当前构型中，Cauchy 应力由对称张量 $\\sigma=\\begin{bmatrix}1 & 0 & 0 \\\\ 0 & 2 & 0 \\\\ 0 & 0 & 3\\end{bmatrix}$ 给出。从第一性原理出发——即构型间的面力平衡、通过 Cauchy 应力和第一 Piola–Kirchhoff 应力定义的面力矢量以及 Nanson 公式——推导关联 Cauchy 应力 $\\sigma$、Kirchhoff 应力 $\\tau$、第一 Piola–Kirchhoff 应力 $P$ 和第二 Piola–Kirchhoff 应力 $S$ 的映射关系。然后，使用这些映射关系，计算给定 $F$ 和 $\\sigma$ 下的 $P$、$\\tau$ 和 $S$，并验证恒等式 $\\tau = F S F^{T}$。假设不存在力偶应力，因此 Cauchy 应力是对称的，并且所有场对于所需的变换都足够光滑。\n\n将您的最终答案表示为一个单行矩阵，其中按顺序包含 $P$、$\\tau$ 和 $S$ 的对角元，即 $(P_{11},\\,P_{22},\\,P_{33},\\,\\tau_{11},\\,\\tau_{22},\\,\\tau_{33},\\,S_{11},\\,S_{22},\\,S_{33})$。无需四舍五入。所有量均以无单位形式表示。",
            "solution": "问题陈述严格基于连续介质力学原理，提供了一套自洽且一致的数据，并且在数学上是适定的。该变形被指定为均匀和等体积的，其变形梯度为 $F=\\operatorname{diag}(2, \\frac{1}{2}, 1)$。通过计算 $F$ 的行列式 $J = \\det(F) = 2 \\times \\frac{1}{2} \\times 1 = 1$ 来验证等体积条件。Cauchy 应力张量 $\\sigma$ 以对称张量的形式给出，这与无力偶应力的假设一致。所有必需的信息都已给出，可以推导所要求的应力测度并验证给定的恒等式。因此，该问题是有效的，我们可以进行求解。\n\n主要任务是推导 Cauchy 应力 $\\sigma$、Kirchhoff 应力 $\\tau$、第一 Piola–Kirchhoff 应力 $P$ 和第二 Piola–Kirchhoff 应力 $S$ 之间的关系。\n\n设无穷小力矢量 $d\\mathbf{f}$ 作用在当前（变形后）构型中的面积元 $d\\mathbf{a} = \\mathbf{n}\\,da$ 上，其中 $\\mathbf{n}$ 是单位法向量，$da$ 是元面积。Cauchy 应力张量 $\\sigma$ 通过以下关系将力与面积元联系起来：\n$$d\\mathbf{f} = \\sigma \\mathbf{n} \\, da$$\n\n在参考（未变形）构型中，相应的面积元是 $d\\mathbf{A} = \\mathbf{N}\\,dA$。第一 Piola–Kirchhoff 应力张量 $P$ 的定义是，它将相同的力矢量 $d\\mathbf{f}$ 与该参考面积元相关联：\n$$d\\mathbf{f} = P \\mathbf{N} \\, dA$$\n\n令这两个力的表达式相等，得到基本平衡方程：\n$$\\sigma \\mathbf{n} \\, da = P \\mathbf{N} \\, dA$$\n\n当前构型和参考构型中面积元之间的关系由 Nanson 公式给出：\n$$\\mathbf{n} \\, da = J F^{-T} \\mathbf{N} \\, dA$$\n其中 $J = \\det(F)$ 是变形的雅可比行列式，$F$ 是变形梯度。\n\n将 Nanson 公式代入面力平衡方程，得到：\n$$\\sigma (J F^{-T} \\mathbf{N} \\, dA) = P \\mathbf{N} \\, dA$$\n$$J (\\sigma F^{-T}) \\mathbf{N} \\, dA = (P \\mathbf{N}) \\, dA$$\n由于该等式对于任意面积元 $d\\mathbf{A}$（因此对于任意法向量 $\\mathbf{N}$）都必须成立，我们可以推导出张量关系：\n$$P = J \\sigma F^{-T}$$\n这就是从 Cauchy 应力 $\\sigma$ 到第一 Piola–Kirchhoff 应力 $P$ 的映射。\n\nKirchhoff 应力 $\\tau$ 定义为 Cauchy 应力的一个缩放版本：\n$$\\tau = J \\sigma$$\n这个定义的动机是出于对功和功率的考虑，确保单位参考体积的功率由 $\\tau:d$ 给出，其中 $d$ 是变形率张量。\n\n第二 Piola–Kirchhoff 应力 $S$ 是一个对称张量，它与 Green–Lagrange 应变张量 $E$ 功共轭。它通过一个涉及变形梯度 $F$ 的拉回操作与第一 Piola–Kirchhoff 应力 $P$ 相关联：\n$$P = F S$$\n这个关系可以被认为是根据 $P$ 来定义 $S$。由此，我们可以将 $S$ 表示为：\n$$S = F^{-1} P$$\n通过代入用 $\\sigma$ 表示的 $P$ 的表达式，我们得到从 $\\sigma$ 到 $S$ 的映射：\n$$S = F^{-1} (J \\sigma F^{-T}) = J F^{-1} \\sigma F^{-T}$$\n\n现在，我们计算给定问题的具体应力张量。\n已知条件为：\n变形梯度：$F = \\begin{pmatrix} 2 & 0 & 0 \\\\ 0 & \\frac{1}{2} & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}$\nCauchy 应力：$\\sigma = \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 2 & 0 \\\\ 0 & 0 & 3 \\end{pmatrix}$\n\n首先，我们计算从 $F$ 导出的必要量：\n雅可比行列式为 $J = \\det(F) = 2 \\times \\frac{1}{2} \\times 1 = 1$。\n变形梯度的逆为 $F^{-1} = \\begin{pmatrix} \\frac{1}{2} & 0 & 0 \\\\ 0 & 2 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}$。\n逆的转置为 $F^{-T} = (F^{-1})^T = \\begin{pmatrix} \\frac{1}{2} & 0 & 0 \\\\ 0 & 2 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}$。\n\n使用推导出的映射关系，我们计算 $\\tau$、$P$ 和 $S$。\n\n1.  **Kirchhoff 应力 ($\\tau$)**：\n    $$\\tau = J \\sigma = 1 \\cdot \\sigma = \\sigma$$\n    $$\\tau = \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 2 & 0 \\\\ 0 & 0 & 3 \\end{pmatrix}$$\n\n2.  **第一 Piola–Kirchhoff 应力 ($P$)**：\n    $$P = J \\sigma F^{-T} = 1 \\cdot \\sigma F^{-T} = \\sigma F^{-T}$$\n    $$P = \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 2 & 0 \\\\ 0 & 0 & 3 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{2} & 0 & 0 \\\\ 0 & 2 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} = \\begin{pmatrix} 1 \\cdot \\frac{1}{2} & 0 & 0 \\\\ 0 & 2 \\cdot 2 & 0 \\\\ 0 & 0 & 3 \\cdot 1 \\end{pmatrix}$$\n    $$P = \\begin{pmatrix} \\frac{1}{2} & 0 & 0 \\\\ 0 & 4 & 0 \\\\ 0 & 0 & 3 \\end{pmatrix}$$\n\n3.  **第二 Piola–Kirchhoff 应力 ($S$)**：\n    $$S = J F^{-1} \\sigma F^{-T} = 1 \\cdot F^{-1} \\sigma F^{-T} = F^{-1} (\\sigma F^{-T}) = F^{-1} P$$\n    $$S = \\begin{pmatrix} \\frac{1}{2} & 0 & 0 \\\\ 0 & 2 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{2} & 0 & 0 \\\\ 0 & 4 & 0 \\\\ 0 & 0 & 3 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{2} \\cdot \\frac{1}{2} & 0 & 0 \\\\ 0 & 2 \\cdot 4 & 0 \\\\ 0 & 0 & 1 \\cdot 3 \\end{pmatrix}$$\n    $$S = \\begin{pmatrix} \\frac{1}{4} & 0 & 0 \\\\ 0 & 8 & 0 \\\\ 0 & 0 & 3 \\end{pmatrix}$$\n\n最后，我们必须验证恒等式 $\\tau = F S F^{T}$。\n由于 $F$ 是一个对角矩阵，其转置就是它本身，即 $F^T = F$。该恒等式简化为 $\\tau = F S F$。\n$$F S F = \\left( \\begin{pmatrix} 2 & 0 & 0 \\\\ 0 & \\frac{1}{2} & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{4} & 0 & 0 \\\\ 0 & 8 & 0 \\\\ 0 & 0 & 3 \\end{pmatrix} \\right) \\begin{pmatrix} 2 & 0 & 0 \\\\ 0 & \\frac{1}{2} & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}$$\n$$F S F = \\begin{pmatrix} 2 \\cdot \\frac{1}{4} & 0 & 0 \\\\ 0 & \\frac{1}{2} \\cdot 8 & 0 \\\\ 0 & 0 & 1 \\cdot 3 \\end{pmatrix} \\begin{pmatrix} 2 & 0 & 0 \\\\ 0 & \\frac{1}{2} & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}$$\n$$F S F = \\begin{pmatrix} \\frac{1}{2} & 0 & 0 \\\\ 0 & 4 & 0 \\\\ 0 & 0 & 3 \\end{pmatrix} \\begin{pmatrix} 2 & 0 & 0 \\\\ 0 & \\frac{1}{2} & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{2} \\cdot 2 & 0 & 0 \\\\ 0 & 4 \\cdot \\frac{1}{2} & 0 \\\\ 0 & 0 & 3 \\cdot 1 \\end{pmatrix}$$\n$$F S F = \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 2 & 0 \\\\ 0 & 0 & 3 \\end{pmatrix}$$\n这个结果矩阵与 Kirchhoff 应力张量 $\\tau$ 完全相同，从而验证了恒等式 $\\tau = F S F^T$。\n\n题目要求按顺序给出 $P$、$\\tau$ 和 $S$ 的对角元 $(P_{11}, P_{22}, P_{33}, \\tau_{11}, \\tau_{22}, \\tau_{33}, S_{11}, S_{22}, S_{33})$。\n根据我们的计算：\n$P$: $P_{11} = \\frac{1}{2}$, $P_{22} = 4$, $P_{33} = 3$\n$\\tau$: $\\tau_{11} = 1$, $\\tau_{22} = 2$, $\\tau_{33} = 3$\n$S$: $S_{11} = \\frac{1}{4}$, $S_{22} = 8$, $S_{33} = 3$\n最终答案是包含这些值的行矩阵。",
            "answer": "$$\\boxed{\\begin{pmatrix} \\frac{1}{2}  4  3  1  2  3  \\frac{1}{4}  8  3 \\end{pmatrix}}$$"
        },
        {
            "introduction": "掌握了基本计算后，我们将转向一个更具洞察力的解析练习，即大变形理论中的典型案例：简单剪切。本练习要求你从一个通用的第二皮奥拉-基尔霍夫应力 $S$ 出发，推导在简单剪切变形下相应的柯西应力 $\\sigma$。这个过程不仅能锻炼你的张量运算能力，还将揭示一个重要的物理现象——剪切可以诱导正向应力（Poynting 效应），这在小变形理论中是不会出现的。",
            "id": "3594874",
            "problem": "一个均质超弹性固体经历一个有限简单剪切变形，其特征在于变形梯度\n$$\nF=\\begin{bmatrix}\n1 & \\gamma & 0\\\\\n0 & 1 & 0\\\\\n0 & 0 & 1\n\\end{bmatrix},\n$$\n其中$\\gamma$是一个实值剪切参数。在某材料点，第二Piola–Kirchhoff (PK2)应力张量$S$是给定且对称的，\n$$\nS=\\begin{bmatrix}\nS_{11} & S_{12} & S_{13}\\\\\nS_{12} & S_{22} & S_{23}\\\\\nS_{13} & S_{23} & S_{33}\n\\end{bmatrix}.\n$$\n仅从参考构型与当前构型之间的内功率等效性，以及第一Piola–Kirchhoff (PK1)应力$P$、PK2应力$S$、Kirchhoff应力$\\tau$和Cauchy应力$\\sigma$的定义出发，执行以下操作：\n\n1. 推导将Cauchy应力$\\sigma$用$F$、$S$和行列式$J=\\det F$表示的变换关系。\n2. 使用推导出的变换关系，计算在给定$F$和通用对称$S$情况下的Cauchy应力$\\sigma$的显式$3\\times 3$矩阵。\n3. 根据你的显式表达式，确定在一般情况下（将$S_{ij}$和$\\gamma$视为独立的实数参数），$\\sigma$的哪些非对角分量不为零。\n\n请将最终答案表示为$\\sigma$关于$\\gamma$和分量$S_{ij}$的显式矩阵。不需要进行数值计算，也无需四舍五入。最终表达式中不要包含单位。",
            "solution": "所陈述的问题具有科学依据，是适定的、客观的。这是连续介质力学中的一个标准问题，用于检验对不同应力度量及其在有限变形下变换的理解。所有必要信息均已提供，任务也已明确定义。该问题是有效的，并且可以解决。\n\n主要目标是从第二Piola-Kirchhoff应力张量$S$出发，求出简单剪切变形下的Cauchy应力张量$\\sigma$。这包括两个主要步骤：首先，推导关联$\\sigma$和$S$的通用变换定律；其次，将此定律应用于给定的变形梯度$F$。\n\n**1. 从$S$到$\\sigma$的变换推导**\n\n推导始于内功率等效原理，该原理指出，单位体积内应力所做的功的速率，无论是在参考（未变形）构型中计算，还是在当前（已变形）构型中计算，都是相同的。设$\\mathcal{P}_0$为参考构型中的功率密度，$\\mathcal{P}$为当前构型中的功率密度。它们之间的关系是$\\mathcal{P}_0 = J \\mathcal{P}$，其中$J = \\det F$是变形梯度$F$的行列式，表示当前体积与参考体积之比。\n\n功率密度是根据应力和变形速率定义的。在参考构型中，功率密度由第一Piola-Kirchhoff (PK1)应力张量$P$和变形梯度变化率$\\dot{F}$的双点积给出：\n$$ \\mathcal{P}_0 = P : \\dot{F} = \\text{tr}(P^T \\dot{F}) $$\n在当前构型中，功率密度由Cauchy应力张量$\\sigma$和变形率张量$d$（也称为伸长张量）的双点积给出：\n$$ \\mathcal{P} = \\sigma : d $$\n变形率张量$d$是空间速度梯度$l$的对称部分，其中$l = \\dot{F} F^{-1}$。因此，$d = \\frac{1}{2}(l + l^T)$。由于Cauchy应力张量$\\sigma$是对称的，它与$l$的反对称部分的缩并为零。因此，我们可以写成$\\mathcal{P} = \\sigma : l = \\sigma : (\\dot{F} F^{-1})$。\n\n将这些表达式代入功率等效方程：\n$$ P : \\dot{F} = J (\\sigma : (\\dot{F} F^{-1})) $$\n使用迹算子重写此式：\n$$ \\text{tr}(P^T \\dot{F}) = J \\, \\text{tr}(\\sigma^T (\\dot{F} F^{-1})) $$\n由于$\\sigma$是对称的，$\\sigma^T = \\sigma$。对右侧应用迹算子的循环性质（$\\text{tr}(ABC) = \\text{tr}(BCA)$）：\n$$ \\text{tr}(P^T \\dot{F}) = J \\, \\text{tr}(F^{-1} \\sigma \\dot{F}) $$\n对于任意变形率$\\dot{F}$，此等式必须成立。这意味着等式两边$\\dot{F}$的系数必须相等：\n$$ P^T = J F^{-1} \\sigma \\implies P = J \\sigma (F^{-1})^T $$\n这个方程关联了PK1应力$P$和Cauchy应力$\\sigma$。\n\n接下来，我们引入第二Piola-Kirchhoff (PK2)应力张量$S$。关联$P$和$S$的定义是：\n$$ P = F S $$\n此关系也可以从功率原理推导得出，注意到$S$与Green-Lagrange应变张量$\\dot{E}$的速率是能量共轭的，其中$E = \\frac{1}{2}(F^T F - I)$。\n\n令$P$的两个表达式相等：\n$$ F S = J \\sigma (F^{-1})^T $$\n为了求解$\\sigma$，我们左乘$F^{-1}$并右乘$F^T$：\n$$ F^{-1} (F S) F^T = F^{-1} (J \\sigma (F^{-1})^T) F^T $$\n$$ S F^T = J \\sigma (F^{-1})^T F^T $$\n使用恒等式$(A^{-1})^T = (A^T)^{-1}$，我们有$(F^{-1})^T F^T = (F^T)^{-1} F^T = I$，其中$I$是单位张量。\n$$ S F^T = J \\sigma I = J \\sigma $$\n最终，我们得到Cauchy应力的变换定律：\n$$ \\sigma = \\frac{1}{J} F S F^T $$\n这就完成了问题的第一部分。这个变换被称为前推操作。注意，Kirchhoff应力$\\tau$定义为$\\tau = J\\sigma$，所以该变换也可以写成$\\tau = FSF^T$。\n\n**2. Cauchy应力矩阵的计算**\n\n现在，我们将此公式应用于给定的变形和应力。\n变形梯度为：\n$$ F = \\begin{bmatrix} 1 & \\gamma & 0\\\\ 0 & 1 & 0\\\\ 0 & 0 & 1 \\end{bmatrix} $$\n第二Piola-Kirchhoff应力张量是对称的：\n$$ S = \\begin{bmatrix} S_{11} & S_{12} & S_{13}\\\\ S_{12} & S_{22} & S_{23}\\\\ S_{13} & S_{23} & S_{33} \\end{bmatrix} $$\n首先，我们计算行列式$J = \\det F$：\n$$ J = \\det \\begin{bmatrix} 1 & \\gamma & 0\\\\ 0 & 1 & 0\\\\ 0 & 0 & 1 \\end{bmatrix} = 1(1 \\cdot 1 - 0 \\cdot 0) - \\gamma(0 \\cdot 1 - 0 \\cdot 0) + 0 = 1 $$\n由于$J=1$，该变形是等容的（体积保持不变），变换简化为：\n$$ \\sigma = F S F^T $$\n$F$的转置是：\n$$ F^T = \\begin{bmatrix} 1 & 0 & 0\\\\ \\gamma & 1 & 0\\\\ 0 & 0 & 1 \\end{bmatrix} $$\n我们分两步进行矩阵乘法。首先，计算乘积$FS$：\n$$ FS = \\begin{bmatrix} 1 & \\gamma & 0\\\\ 0 & 1 & 0\\\\ 0 & 0 & 1 \\end{bmatrix} \\begin{bmatrix} S_{11} & S_{12} & S_{13}\\\\ S_{12} & S_{22} & S_{23}\\\\ S_{13} & S_{23} & S_{33} \\end{bmatrix} = \\begin{bmatrix} S_{11} + \\gamma S_{12} & S_{12} + \\gamma S_{22} & S_{13} + \\gamma S_{23}\\\\ S_{12} & S_{22} & S_{23}\\\\ S_{13} & S_{23} & S_{33} \\end{bmatrix} $$\n接下来，将此结果右乘$F^T$：\n$$ \\sigma = (FS)F^T = \\begin{bmatrix} S_{11} + \\gamma S_{12} & S_{12} + \\gamma S_{22} & S_{13} + \\gamma S_{23}\\\\ S_{12} & S_{22} & S_{23}\\\\ S_{13} & S_{23} & S_{33} \\end{bmatrix} \\begin{bmatrix} 1 & 0 & 0\\\\ \\gamma & 1 & 0\\\\ 0 & 0 & 1 \\end{bmatrix} $$\n计算所得矩阵$\\sigma$的每个分量：\n$\\sigma_{11} = (S_{11} + \\gamma S_{12})(1) + (S_{12} + \\gamma S_{22})(\\gamma) = S_{11} + \\gamma S_{12} + \\gamma S_{12} + \\gamma^2 S_{22} = S_{11} + 2\\gamma S_{12} + \\gamma^2 S_{22}$\n$\\sigma_{12} = (S_{11} + \\gamma S_{12})(0) + (S_{12} + \\gamma S_{22})(1) = S_{12} + \\gamma S_{22}$\n$\\sigma_{13} = (S_{11} + \\gamma S_{12})(0) + (S_{12} + \\gamma S_{22})(0) + (S_{13} + \\gamma S_{23})(1) = S_{13} + \\gamma S_{23}$\n$\\sigma_{21} = (S_{12})(1) + (S_{22})(\\gamma) = S_{12} + \\gamma S_{22}$\n$\\sigma_{22} = (S_{12})(0) + (S_{22})(1) = S_{22}$\n$\\sigma_{23} = (S_{12})(0) + (S_{22})(0) + (S_{23})(1) = S_{23}$\n$\\sigma_{31} = (S_{13})(1) + (S_{23})(\\gamma) = S_{13} + \\gamma S_{23}$\n$\\sigma_{32} = (S_{13})(0) + (S_{23})(1) = S_{23}$\n$\\sigma_{33} = (S_{13})(0) + (S_{23})(0) + (S_{33})(1) = S_{33}$\n\n如预期一样，所得的Cauchy应力张量$\\sigma$是对称的（$\\sigma_{ij} = \\sigma_{ji}$）。最终矩阵为：\n$$ \\sigma = \\begin{bmatrix} S_{11} + 2\\gamma S_{12} + \\gamma^2 S_{22} & S_{12} + \\gamma S_{22} & S_{13} + \\gamma S_{23} \\\\ S_{12} + \\gamma S_{22} & S_{22} & S_{23} \\\\ S_{13} + \\gamma S_{23} & S_{23} & S_{33} \\end{bmatrix} $$\n\n**3. 非对角分量的分析**\n\n问题要求确定在一般情况下$\\sigma$的非零非对角分量。独立非对角分量为：\n$$ \\sigma_{12} = S_{12} + \\gamma S_{22} $$\n$$ \\sigma_{13} = S_{13} + \\gamma S_{23} $$\n$$ \\sigma_{23} = S_{23} $$\n由于参数$S_{ij}$和$\\gamma$被视为独立的实变量，一个分量在一般情况下为零，当且仅当其表达式对于所有参数值恒等于零，而这里没有任何一个分量是这种情况。例如，$\\sigma_{12}$仅在满足特定条件$S_{12} = -\\gamma S_{22}$时才为零，但在一般情况下不为零。因此，所有三个独立的非对角分量，$\\sigma_{12}$、$\\sigma_{13}$和$\\sigma_{23}$，在一般情况下都是非零的。还值得注意的是，即使初始应力状态$S$是纯剪切的，简单剪切变形也会产生一个正应力分量$\\sigma_{11}$（即Poynting效应）。",
            "answer": "$$ \\boxed{\n\\begin{pmatrix}\nS_{11} + 2\\gamma S_{12} + \\gamma^{2} S_{22} & S_{12} + \\gamma S_{22} & S_{13} + \\gamma S_{23} \\\\\nS_{12} + \\gamma S_{22} & S_{22} & S_{23} \\\\\nS_{13} + \\gamma S_{23} & S_{23} & S_{33}\n\\end{pmatrix}\n} $$"
        },
        {
            "introduction": "理论的最终检验在于实践，对于计算固体力学而言，这意味着要确保我们的代码准确反映了物理定律。本练习将理论推向计算实现，要求你设计一个随机化数值测试，以验证不同应力量度之间转换关系的自洽性。通过为随机生成的有效变形和应力状态编写验证程序，你将学习到计算力学软件开发中的一个核心实践：如何构建单元测试来确保数值模型的正确性和鲁棒性。",
            "id": "3594833",
            "problem": "您需要设计并实现一个随机数值测试，用于检验计算固体力学在有限应变情况下应力量度的一致性。从参考构型和当前构型之间的基本运动学和功率等效原理出发，推导连接第一Piola–Kirchhoff应力（FPK）、第二Piola–Kirchhoff应力（SPK）、Kirchhoff应力和Cauchy应力的关系。您必须在不使用任何预先提供的公式的情况下，利用您的推导构建一个程序，该程序能生成随机但受控的变形梯度和对称应力张量，然后验证所推导的关系在指定的容差范围内同时成立。\n\n假设一个三维连续体，其参考坐标用 $\\boldsymbol{X}$ 表示，当前坐标用 $\\boldsymbol{x}$ 表示。变形梯度为 $ \\boldsymbol{F} = \\dfrac{\\partial \\boldsymbol{x}}{\\partial \\boldsymbol{X}} $，其行列式为 $ J = \\det \\boldsymbol{F} $，且 $ J > 0 $。考虑以下应力量度：\n- 作用于当前构型的Cauchy应力 $ \\boldsymbol{\\sigma} $。\n- 通过体积变化定义的Kirchhoff应力 $ \\boldsymbol{\\tau} $。\n- 将参考面积映射到名义牵引力的第一Piola–Kirchhoff应力 $ \\boldsymbol{P} $。\n- 通过拉回到参考构型定义的第二Piola–Kirchhoff应力 $ \\boldsymbol{S} $。\n\n您必须：\n1.  仅从基本运动学和构型间的功率等效性出发，推导连接这些应力量度的精确关系。使用面积和体积的运动学变量代换以及适当的推前和拉回操作来确保一致性。\n2.  用一种编程语言实现一个随机数值测试，该测试生成可逆的 $ \\boldsymbol{F} $（$ J > 0 $）和对称的 $ \\boldsymbol{S} $，并在规定的容差内验证您推导的关系同时成立。\n3.  使用一致的矩阵范数来量化误差。令 $ \\| \\cdot \\|_{F} $ 表示Frobenius范数。对于两个矩阵 $ \\boldsymbol{A} $ 和 $ \\boldsymbol{B} $，将相对误差定义为\n$$ e_{\\mathrm{rel}}(\\boldsymbol{A}, \\boldsymbol{B}) = \\dfrac{\\| \\boldsymbol{A} - \\boldsymbol{B} \\|_{F}}{\\| \\boldsymbol{B} \\|_{F} + \\varepsilon}, $$\n其中 $ \\varepsilon = 10^{-15} $。将绝对误差定义为 $ e_{\\mathrm{abs}}(\\boldsymbol{A}, \\boldsymbol{B}) = \\| \\boldsymbol{A} - \\boldsymbol{B} \\|_{F} $。如果每个恒等式的相对误差和绝对误差都低于相应的容差，则测试通过。\n\n随机生成要求：\n- 使用一个随机矩阵和 $ \\boldsymbol{Q}\\boldsymbol{R} $ 分解生成一个真旋转 $ \\boldsymbol{R} $（$ \\det \\boldsymbol{R} = +1 $），并调整符号以确保其为真正交矩阵。\n- 构造 $ \\boldsymbol{F} = \\boldsymbol{R} \\boldsymbol{U} $，其中 $ \\boldsymbol{U} $ 是对角矩阵且其元素（主伸长）为严格正值，从而 $ J = \\det \\boldsymbol{F} = \\det \\boldsymbol{U} > 0 $。这确保了可逆性和正定向。\n- 生成一个随机对称的 $ \\boldsymbol{S} $，形式为 $ \\boldsymbol{S} = \\dfrac{1}{2} (\\boldsymbol{A} + \\boldsymbol{A}^{T}) $，其中 $ \\boldsymbol{A} $ 的元素是独立的标准正态分布。\n\n验证结构：\n- 基于您的推导，实现从 $ \\boldsymbol{F} $ 和 $ \\boldsymbol{S} $ 计算 $ \\boldsymbol{P} $、$ \\boldsymbol{\\tau} $ 和 $ \\boldsymbol{\\sigma} $ 的过程。\n- 使用相对误差和绝对误差检查所有恒等式的同时一致性。\n\n测试套件：\n提供五个覆盖典型和边缘场景的测试用例。每个测试用例指定如何生成 $ \\boldsymbol{F} $ 和 $ \\boldsymbol{S} $ 以及要使用的容差。\n\n- 测试用例 $ 1 $ （随机中等伸长）：种子 $ 0 $，$ \\boldsymbol{U} = \\mathrm{diag}(u_{1}, u_{2}, u_{3}) $，其中 $ u_{i} \\sim \\mathrm{Uniform}(0.5, 2) $，$ \\boldsymbol{S} $ 来自随机对称抽取；容差：$ \\mathrm{rtol} = 10^{-10} $，$ \\mathrm{atol} = 10^{-12} $。\n- 测试用例 $ 2 $ （恒等映射）：种子 $ 1 $，$ \\boldsymbol{U} = \\mathrm{diag}(1, 1, 1) $，因此 $ \\boldsymbol{F} = \\boldsymbol{R} \\boldsymbol{I} = \\boldsymbol{R} $；额外设置 $ \\boldsymbol{R} = \\boldsymbol{I} $ 以测试恒等构型；$ \\boldsymbol{S} $ 随机对称；容差：$ \\mathrm{rtol} = 10^{-12} $，$ \\mathrm{atol} = 10^{-14} $。\n- 测试用例 $ 3 $ （小 $ J $）：种子 $ 2 $，$ \\boldsymbol{U} = \\mathrm{diag}(10^{-2}, 10^{-2}, 10^{-2}) $，因此 $ J = 10^{-6} $，$ \\boldsymbol{S} $ 随机对称；容差：$ \\mathrm{rtol} = 10^{-9} $，$ \\mathrm{atol} = 10^{-12} $。\n- 测试用例 $ 4 $ （病态伸长）：种子 $ 3 $，$ \\boldsymbol{U} = \\mathrm{diag}(10^{3}, 10^{-3}, 1) $，因此 $ J = 1 $，$ \\boldsymbol{S} $ 随机对称；容差：$ \\mathrm{rtol} = 10^{-9} $，$ \\mathrm{atol} = 10^{-12} $。\n- 测试用例 $ 5 $ （纯旋转）：种子 $ 4 $，$ \\boldsymbol{U} = \\mathrm{diag}(1, 1, 1) $ 且 $ \\boldsymbol{F} = \\boldsymbol{R} $，其中 $ \\boldsymbol{R} $ 是一个随机的真旋转；$ \\boldsymbol{S} $ 随机对称；容差：$ \\mathrm{rtol} = 10^{-12} $，$ \\mathrm{atol} = 10^{-14} $。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。每个条目必须是一个布尔值，表示相应的测试用例是否通过了所有同步检查。例如，如果结果是那样，则产生 $ [\\mathrm{True}, \\mathrm{True}, \\mathrm{False}, \\mathrm{True}, \\mathrm{True}] $。",
            "solution": "该问题陈述被评估为有效，因为它在科学上基于连续介质力学的原理，问题设定良好，具有明确的目标和约束，并且没有歧义或矛盾。因此，我们可以进行推导和实现。\n\n此问题的核心在于推导和验证在有限应变计算力学中使用的不同应力量度之间的运动学和动力学关系。推导始于功率等效原理，该原理假定在变形过程中消耗的内功率是一个客观量，与其计算所用的构型（参考构型或当前构型）无关。\n\n设一个材料体占据参考构型 $\\Omega_0$，其材料点由坐标 $\\boldsymbol{X}$ 标记。在变形映射 $\\boldsymbol{x} = \\boldsymbol{\\phi}(\\boldsymbol{X}, t)$ 下，该物体在时间 $t$ 占据当前构型 $\\Omega_t$。变形的基本度量是变形梯度张量，定义为 $\\boldsymbol{F} = \\dfrac{\\partial \\boldsymbol{x}}{\\partial \\boldsymbol{X}}$。我们假设变形是保向的，因此雅可比行列式 $J = \\det \\boldsymbol{F} > 0$。\n\n内功率 $\\mathcal{P}_{\\text{int}}$ 可以在当前（欧拉）构型中用Cauchy应力张量 $\\boldsymbol{\\sigma}$ 和变形率张量 $\\boldsymbol{d}$ 表示：\n$$\n\\mathcal{P}_{\\text{int}} = \\int_{\\Omega_t} \\boldsymbol{\\sigma} : \\boldsymbol{d} \\, dv\n$$\n其中 $dv$ 是当前构型中的体积元。变形率是空间速度梯度 $\\boldsymbol{l} = \\nabla_{\\boldsymbol{x}}\\boldsymbol{v}$ 的对称部分，即 $\\boldsymbol{d} = \\frac{1}{2}(\\boldsymbol{l} + \\boldsymbol{l}^T)$。由于Cauchy应力 $\\boldsymbol{\\sigma}$ 是对称的，乘积 $\\boldsymbol{\\sigma} : \\boldsymbol{l}$ 等效于 $\\boldsymbol{\\sigma} : \\boldsymbol{d}$。\n\n或者，内功率也可以在参考（拉格朗日）构型中用第一Piola-Kirchhoff (FPK)应力张量 $\\boldsymbol{P}$ 和变形梯度率 $\\dot{\\boldsymbol{F}}$ 表示：\n$$\n\\mathcal{P}_{\\text{int}} = \\int_{\\Omega_0} \\boldsymbol{P} : \\dot{\\boldsymbol{F}} \\, dV\n$$\n其中 $dV$ 是参考构型中的体积元。FPK应力 $\\boldsymbol{P}$ 是一个两点张量，它将当前构型中的力与参考构型中的面积联系起来。\n\n根据功率等效原理，这两个表达式必须相等。体积元之间的关系为 $dv = J dV$。将功率积分相等并将积分域转换为 $\\Omega_0$ 可得：\n$$\n\\int_{\\Omega_0} \\boldsymbol{P} : \\dot{\\boldsymbol{F}} \\, dV = \\int_{\\Omega_0} (\\boldsymbol{\\sigma} : \\boldsymbol{d}) J \\, dV\n$$\n由于此等式必须对任意子体积成立，因此被积函数必须相等，从而得到局部功率恒等式：\n$$\n\\boldsymbol{P} : \\dot{\\boldsymbol{F}} = J (\\boldsymbol{\\sigma} : \\boldsymbol{d})\n$$\n为了继续推导，我们建立 $\\dot{\\boldsymbol{F}}$ 和 $\\boldsymbol{l}$ 之间的运动学关系。$\\boldsymbol{F}$ 的物质时间导数是 $\\dot{\\boldsymbol{F}} = \\frac{\\partial}{\\partial \\boldsymbol{X}} (\\boldsymbol{v})$，其中 $\\boldsymbol{v}$ 是物质速度。使用链式法则，$\\dot{\\boldsymbol{F}} = (\\frac{\\partial \\boldsymbol{v}}{\\partial \\boldsymbol{x}})(\\frac{\\partial \\boldsymbol{x}}{\\partial \\boldsymbol{X}}) = \\boldsymbol{l} \\boldsymbol{F}$。\n\n将此代入功率恒等式，并回顾 $\\boldsymbol{\\sigma} : \\boldsymbol{d} = \\boldsymbol{\\sigma} : \\boldsymbol{l}$：\n$$\n\\boldsymbol{P} : (\\boldsymbol{l} \\boldsymbol{F}) = J (\\boldsymbol{\\sigma} : \\boldsymbol{l})\n$$\n使用双点积的恒等式 $(\\boldsymbol{A}\\boldsymbol{B}):\\boldsymbol{C} = \\boldsymbol{A}:(\\boldsymbol{C}\\boldsymbol{B}^T)$，我们得到 $\\boldsymbol{P}:(\\boldsymbol{l}\\boldsymbol{F}) = (\\boldsymbol{P}\\boldsymbol{F}^T):\\boldsymbol{l}$。功率恒等式变为：\n$$\n(\\boldsymbol{P}\\boldsymbol{F}^T) : \\boldsymbol{l} = (J\\boldsymbol{\\sigma}) : \\boldsymbol{l}\n$$\n这必须对任意速度场成立，因此对任意 $\\boldsymbol{l}$ 成立。这意味着FPK应力 $\\boldsymbol{P}$ 和Cauchy应力 $\\boldsymbol{\\sigma}$ 之间存在基本关系：\n$$\n\\boldsymbol{P}\\boldsymbol{F}^T = J\\boldsymbol{\\sigma} \\quad \\implies \\quad \\boldsymbol{\\sigma} = \\frac{1}{J} \\boldsymbol{P} \\boldsymbol{F}^T\n$$\n这个关系是一个推前操作。其逆操作，即拉回操作，是 $\\boldsymbol{P} = J\\boldsymbol{\\sigma}\\boldsymbol{F}^{-T}$。\n\n引入Kirchhoff应力 $\\boldsymbol{\\tau}$ 作为Cauchy应力的一个缩放版本，$\\boldsymbol{\\tau} = J\\boldsymbol{\\sigma}$。它是一个对称张量，表示作用在缩放回其参考尺寸的体积上的Cauchy应力。将 $\\boldsymbol{\\tau}$ 代入前一个关系式，得到与FPK应力的直接联系：\n$$\n\\boldsymbol{\\tau} = \\boldsymbol{P} \\boldsymbol{F}^T \\quad \\implies \\quad \\boldsymbol{P} = \\boldsymbol{\\tau} \\boldsymbol{F}^{-T}\n$$\n\n第二Piola-Kirchhoff (SPK)应力 $\\boldsymbol{S}$ 是一个完全在参考构型中定义的对称张量。它与Green-Lagrange应变张量率 $\\dot{\\boldsymbol{E}}$ 能量共轭，其中 $\\boldsymbol{E} = \\frac{1}{2}(\\boldsymbol{F}^T\\boldsymbol{F} - \\boldsymbol{I})$。因此，参考构型中的功率密度也可以写成 $\\boldsymbol{S} : \\dot{\\boldsymbol{E}}$。将其与用FPK应力表示的功率密度相等：\n$$\n\\boldsymbol{P} : \\dot{\\boldsymbol{F}} = \\boldsymbol{S} : \\dot{\\boldsymbol{E}}\n$$\nGreen-Lagrange应变率是 $\\dot{\\boldsymbol{E}} = \\frac{1}{2}(\\dot{\\boldsymbol{F}}^T\\boldsymbol{F} + \\boldsymbol{F}^T\\dot{\\boldsymbol{F}})$。由于 $\\boldsymbol{S}$ 是对称的，可以证明 $\\boldsymbol{S} : \\dot{\\boldsymbol{E}} = (\\boldsymbol{F}\\boldsymbol{S}) : \\dot{\\boldsymbol{F}}$。功率恒等式变为：\n$$\n\\boldsymbol{P} : \\dot{\\boldsymbol{F}} = (\\boldsymbol{F}\\boldsymbol{S}) : \\dot{\\boldsymbol{F}}\n$$\n这对任意 $\\dot{\\boldsymbol{F}}$ 都成立，从而得出FPK和SPK应力张量之间的直接关系：\n$$\n\\boldsymbol{P} = \\boldsymbol{F} \\boldsymbol{S} \\quad \\implies \\quad \\boldsymbol{S} = \\boldsymbol{F}^{-1} \\boldsymbol{P}\n$$\n\n总而言之，从给定的对称SPK应力 $\\boldsymbol{S}$ 和变形梯度 $\\boldsymbol{F}$ 出发，其他应力量度可推导如下：\n1.  第一Piola-Kirchhoff应力: $\\boldsymbol{P} = \\boldsymbol{F}\\boldsymbol{S}$\n2.  Kirchhoff应力: $\\boldsymbol{\\tau} = \\boldsymbol{P}\\boldsymbol{F}^T = \\boldsymbol{F}\\boldsymbol{S}\\boldsymbol{F}^T$\n3.  Cauchy应力: $\\boldsymbol{\\sigma} = \\frac{1}{J}\\boldsymbol{\\tau} = \\frac{1}{J}\\boldsymbol{F}\\boldsymbol{S}\\boldsymbol{F}^T$\n\n数值测试将根据问题规范生成 $\\boldsymbol{F}$ 和 $\\boldsymbol{S}$。然后它将使用一个主运算序列（例如，$\\boldsymbol{S} \\to \\boldsymbol{P} \\to \\boldsymbol{\\tau} \\to \\boldsymbol{\\sigma}$）计算 $\\boldsymbol{P}$、$\\boldsymbol{\\tau}$ 和 $\\boldsymbol{\\sigma}$。随后，它将通过检查连接它们的其他关系，如复合推前（$\\boldsymbol{\\sigma} = \\frac{1}{J}\\boldsymbol{F}\\boldsymbol{S}\\boldsymbol{F}^T$）和拉回（$\\boldsymbol{S} = J\\boldsymbol{F}^{-1}\\boldsymbol{\\sigma}\\boldsymbol{F}^{-T}$）恒等式，来验证整套推导出的应力量度的一致性。如果所有检查都在指定的绝对和相对容差内得到满足，则测试用例通过。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Designs and implements a randomized numerical test for stress measure\n    consistency in computational solid mechanics at finite strain.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            'seed': 0, 'u_params': ('uniform', (0.5, 2.0)), 'R_mode': 'random', \n            'rtol': 1e-10, 'atol': 1e-12\n        },\n        {\n            'seed': 1, 'u_params': ('fixed', [1.0, 1.0, 1.0]), 'R_mode': 'identity',\n            'rtol': 1e-12, 'atol': 1e-14\n        },\n        {\n            'seed': 2, 'u_params': ('fixed', [1e-2, 1e-2, 1e-2]), 'R_mode': 'random', \n            'rtol': 1e-9, 'atol': 1e-12\n        },\n        {\n            'seed': 3, 'u_params': ('fixed', [1e3, 1e-3, 1.0]), 'R_mode': 'random', \n            'rtol': 1e-9, 'atol': 1e-12\n        },\n        {\n            'seed': 4, 'u_params': ('fixed', [1.0, 1.0, 1.0]), 'R_mode': 'random', \n            'rtol': 1e-12, 'atol': 1e-14\n        },\n    ]\n\n    results = []\n\n    def check_error(A, B, rtol, atol):\n        \"\"\"\n        Calculates relative and absolute error and checks against tolerances.\n        \"\"\"\n        epsilon = 1e-15\n        abs_err = np.linalg.norm(A - B, 'fro')\n        norm_B = np.linalg.norm(B, 'fro')\n        rel_err = abs_err / (norm_B + epsilon)\n        return (rel_err  rtol) and (abs_err  atol)\n\n    for case in test_cases:\n        np.random.seed(case['seed'])\n\n        # 1. Generate random but controlled F and S\n        # Generate F = R U\n        # Generate proper rotation R\n        if case['R_mode'] == 'identity':\n            R = np.identity(3)\n        else: # 'random'\n            A_rand = np.random.randn(3, 3)\n            Q, _ = np.linalg.qr(A_rand)\n            # Ensure R is a proper rotation (det(R) = +1)\n            if np.linalg.det(Q)  0:\n                Q[:, 0] *= -1\n            R = Q\n\n        # Generate stretch tensor U\n        u_mode, u_vals = case['u_params']\n        if u_mode == 'uniform':\n            stretches = np.random.uniform(u_vals[0], u_vals[1], 3)\n        else: # 'fixed'\n            stretches = np.array(u_vals)\n        U = np.diag(stretches)\n\n        F = R @ U\n\n        # Generate random symmetric S\n        A_s = np.random.randn(3, 3)\n        S = 0.5 * (A_s + A_s.T)\n\n        # 2. Compute other stress measures based on derived relations\n        J = np.linalg.det(F)\n        if J = 0:\n            # This should not happen with the given generation method\n            results.append(False)\n            continue\n        \n        # Sequentially compute P, tau, sigma from S\n        # This set constitutes the reference values for the checks.\n        P_ref = F @ S\n        tau_ref = P_ref @ F.T\n        sigma_ref = (1/J) * tau_ref\n        \n        # 3. Verify that derived relations hold simultaneously\n        # A test case passes if all checks are satisfied.\n        all_checks_passed = True\n        \n        # Check 1: Composite push-forward from S to tau\n        # Verify tau = F S F^T\n        tau_check_1 = F @ S @ F.T\n        if not check_error(tau_check_1, tau_ref, case['rtol'], case['atol']):\n            all_checks_passed = False\n\n        # Check 2: Composite push-forward from S to sigma\n        # Verify sigma = (1/J) F S F^T\n        sigma_check_2 = (1/J) * (F @ S @ F.T)\n        if not check_error(sigma_check_2, sigma_ref, case['rtol'], case['atol']):\n            all_checks_passed = False\n            \n        # Check 3: Full cycle consistency check (pull-back of sigma to S)\n        # Verify S = J F^{-1} sigma F^{-T}\n        # This check involves matrix inversion and is a good test of numerical stability.\n        try:\n            F_inv = np.linalg.inv(F)\n            F_inv_T = F_inv.T\n            S_check_3 = J * F_inv @ sigma_ref @ F_inv_T\n            if not check_error(S_check_3, S, case['rtol'], case['atol']):\n                all_checks_passed = False\n        except np.linalg.LinAlgError:\n            all_checks_passed = False # Inversion failed\n\n        results.append(all_checks_passed)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(str(r) for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}