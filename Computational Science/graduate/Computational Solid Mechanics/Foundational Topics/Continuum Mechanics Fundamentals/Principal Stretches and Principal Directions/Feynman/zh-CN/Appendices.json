{
    "hands_on_practices": [
        {
            "introduction": "理论学习之后，通过一个基础的分析练习来巩固理解是至关重要的。这项实践旨在将主拉伸的抽象定义转化为一个具体的二维情况下的封闭解。通过从变形梯度 $F$ 出发，推导右柯西-格林张量 $C$ 的特征多项式，你将亲自导出主拉伸的解析表达式，从而加深对这些基本运动学量之间代数关系的理解 。",
            "id": "3590880",
            "problem": "考虑一个均匀的二维（平面）变形，其变形梯度 $F \\in \\mathbb{R}^{2 \\times 2}$ 由下式给出\n$$\nF=\\begin{pmatrix} a  b \\\\ c  d \\end{pmatrix},\n$$\n其中 $\\det F0$。令右柯西-格林变形张量定义为 $C=F^{\\top}F$。主伸长定义为右伸长张量 $U$ 的正特征值，其中 $F$ 具有极分解 $F=R\\,U$，$R$ 是真正交矩阵，$U$ 是对称正定矩阵。仅使用这些基本定义，通过运用 $C$ 的特征多项式，推导两个主伸长关于 $a$、$b$、$c$ 和 $d$ 的闭式解析表达式。按非递减顺序列出两个主伸长。以无单位的符号形式表示你的最终答案。",
            "solution": "所述问题具有科学依据，提法恰当，客观，并包含了获得唯一解所需的所有必要信息。所提供的定义和关系是连续介质力学中的标准内容。因此，我们可以进行推导。\n\n变形梯度 $F$ 是一个具有实数分量的 $2 \\times 2$ 矩阵：\n$$\nF = \\begin{pmatrix} a  b \\\\ c  d \\end{pmatrix}\n$$\n问题指出 $\\det F  0$，这确保了变形是保向的。\n\n右柯西-格林变形张量 $C$ 定义为 $C = F^{\\top}F$。首先，我们计算 $F$ 的转置：\n$$\nF^{\\top} = \\begin{pmatrix} a  c \\\\ b  d \\end{pmatrix}\n$$\n现在，我们计算矩阵乘积 $F^{\\top}F$：\n$$\nC = F^{\\top}F = \\begin{pmatrix} a  c \\\\ b  d \\end{pmatrix} \\begin{pmatrix} a  b \\\\ c  d \\end{pmatrix} = \\begin{pmatrix} a^2 + c^2  ab + cd \\\\ ab + cd  b^2 + d^2 \\end{pmatrix}\n$$\n所得张量 $C$ 是对称的，正如预期。\n\n主伸长，我们记为 $\\lambda_1$ 和 $\\lambda_2$，是右伸长张量 $U$ 的特征值。张量 $U$ 出现在 $F$ 的极分解中，即 $F=RU$，其中 $R$ 是一个真正交张量（$R^{\\top}R=I$，$\\det R = 1$），$U$ 是一个对称正定张量。\n\n$C$ 和 $U$ 之间的关系由它们的定义推导而来：\n$$\nC = F^{\\top}F = (RU)^{\\top}(RU) = U^{\\top}R^{\\top}RU\n$$\n由于 $R$ 是正交的，$R^{\\top}R=I$，其中 $I$ 是单位张量。因此，\n$$\nC = U^{\\top}U\n$$\n因为 $U$ 是对称的（$U^{\\top}=U$），这可以简化为：\n$$\nC = U^2\n$$\n这个关系意味着 $C$ 的特征值是 $U$ 的特征值的平方。令 $\\mathbf{n}$ 为一个主方向，它是 $U$ 对应于主伸长 $\\lambda$ 的特征向量。那么，根据定义：\n$$\nU\\mathbf{n} = \\lambda \\mathbf{n}\n$$\n将张量 $C$ 应用于该特征向量 $\\mathbf{n}$，我们得到：\n$$\nC\\mathbf{n} = U^2 \\mathbf{n} = U(U\\mathbf{n}) = U(\\lambda\\mathbf{n}) = \\lambda(U\\mathbf{n}) = \\lambda(\\lambda\\mathbf{n}) = \\lambda^2 \\mathbf{n}\n$$\n这表明如果 $\\lambda$ 是 $U$ 的一个特征值，那么 $\\mu = \\lambda^2$ 就是 $C$ 的一个特征值。主伸长 $\\lambda$ 被定义为正数，所以 $\\lambda = \\sqrt{\\mu}$。\n\n为了找到主伸长，我们必须首先通过求解其特征方程 $\\det(C - \\mu I) = 0$ 来找到 $C$ 的特征值。\n$$\nC - \\mu I = \\begin{pmatrix} a^2 + c^2 - \\mu  ab + cd \\\\ ab + cd  b^2 + d^2 - \\mu \\end{pmatrix}\n$$\n行列式是：\n$$\n\\det(C - \\mu I) = (a^2 + c^2 - \\mu)(b^2 + d^2 - \\mu) - (ab + cd)^2 = 0\n$$\n展开这个表达式，得到关于 $\\mu$ 的特征多项式：\n$$\n\\mu^2 - ((a^2 + c^2) + (b^2 + d^2))\\mu + (a^2 + c^2)(b^2 + d^2) - (ab + cd)^2 = 0\n$$\n这个二次方程的系数与 $C$ 的不变量有关。$\\mu$ 的线性项系数是 $C$ 的迹的负数：\n$$\n\\text{tr}(C) = a^2 + c^2 + b^2 + d^2\n$$\n常数项是 $C$ 的行列式：\n$$\n\\det(C) = (a^2 + c^2)(b^2 + d^2) - (ab + cd)^2 \\\\\n= a^2b^2 + a^2d^2 + c^2b^2 + c^2d^2 - (a^2b^2 + 2abcd + c^2d^2) \\\\\n= a^2d^2 - 2abcd + c^2b^2 \\\\\n= (ad - bc)^2\n$$\n我们认出 $ad-bc$ 是 $\\det F$，所以 $\\det C = (\\det F)^2$。特征方程简化为：\n$$\n\\mu^2 - \\text{tr}(C)\\mu + \\det(C) = 0\n$$\n将迹和行列式用 $a,b,c,d$ 表示的表达式代入：\n$$\n\\mu^2 - (a^2 + b^2 + c^2 + d^2)\\mu + (ad - bc)^2 = 0\n$$\n我们使用求根公式求解这个二次方程以得到特征值 $\\mu$：\n$$\n\\mu = \\frac{-[-(a^2+b^2+c^2+d^2)] \\pm \\sqrt{(-(a^2+b^2+c^2+d^2))^2 - 4(1)((ad-bc)^2)}}{2(1)}\n$$\n$$\n\\mu_{1,2} = \\frac{1}{2} \\left( (a^2+b^2+c^2+d^2) \\pm \\sqrt{(a^2+b^2+c^2+d^2)^2 - 4(ad-bc)^2} \\right)\n$$\n张量 $C$ 是对称且正定的（因为 $\\det C = (\\det F)^2  0$），所以它的特征值 $\\mu_1$ 和 $\\mu_2$ 是实数且为正。主伸长是这些特征值的正平方根，即 $\\lambda_1 = \\sqrt{\\mu_1}$ 和 $\\lambda_2 = \\sqrt{\\mu_2}$。\n\n为了按非递减顺序列出它们，我们将 $\\lambda_1$ 设为较小的值，$\\lambda_2$ 设为较大的值。这对应于为 $\\mu_1$ 使用负号，为 $\\mu_2$ 使用正号。\n\n较小的主伸长 $\\lambda_1$ 是：\n$$\n\\lambda_1 = \\sqrt{\\frac{1}{2} \\left( (a^2+b^2+c^2+d^2) - \\sqrt{(a^2+b^2+c^2+d^2)^2 - 4(ad-bc)^2} \\right)}\n$$\n较大的主伸长 $\\lambda_2$ 是：\n$$\n\\lambda_2 = \\sqrt{\\frac{1}{2} \\left( (a^2+b^2+c^2+d^2) + \\sqrt{(a^2+b^2+c^2+d^2)^2 - 4(ad-bc)^2} \\right)}\n$$\n这些就是两个主伸长关于变形梯度 $F$ 各分量的闭式解析表达式。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\sqrt{\\frac{1}{2} \\left( a^2+b^2+c^2+d^2 - \\sqrt{(a^2+b^2+c^2+d^2)^2 - 4(ad-bc)^2} \\right)}  \\sqrt{\\frac{1}{2} \\left( a^2+b^2+c^2+d^2 + \\sqrt{(a^2+b^2+c^2+d^2)^2 - 4(ad-bc)^2} \\right)} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "为了深入探索主拉伸和主方向的物理意义，我们必须考察一些特殊情况。这项实践是一个关键的思想实验，研究了纯刚体旋转这一退化情况。通过证明在这种无变形的情况下所有主拉伸都等于1，你将揭示主方向的非唯一性是如何产生的，这对于理解特征值问题的退化现象及其在连续介质力学中的影响至关重要 。",
            "id": "3590864",
            "problem": "设 $\\varphi: \\mathbb{R}^{3} \\to \\mathbb{R}^{3}$ 是一个形变，其形变梯度为 $\\mathbf{F} = \\nabla \\varphi$。考虑一个纯刚体旋转的特殊情况，此时 $\\mathbf{F} = \\mathbf{Q} \\in \\mathrm{SO}(3)$，其中 $\\mathrm{SO}(3)$ 表示满足 $\\mathbf{Q}^{T}\\mathbf{Q} = \\mathbf{I}$ 和 $\\det \\mathbf{Q} = 1$ 的真旋转的特殊正交群。假设 $\\mathbf{Q}$ 具有轴-角表示，单位轴为 $\\mathbf{n} \\in \\mathbb{R}^{3}$，旋转角为 $\\theta \\in \\mathbb{R}$ (以弧度为单位)，但除了 $\\mathbf{Q}$ 的正交约束外，不使用 $\\theta$ 的任何特殊性质。\n\n仅从右 Cauchy–Green 张量 $\\mathbf{C} := \\mathbf{F}^{T}\\mathbf{F}$、由右极分解 $\\mathbf{F} = \\mathbf{R}\\mathbf{U}$（其中 $\\mathbf{R} \\in \\mathrm{SO}(3)$ 且 $\\mathbf{U}$ 为对称正定张量）给出的右拉伸张量 $\\mathbf{U}$ 以及主拉伸是 $\\mathbf{U}$ 的特征值（等价于 $\\mathbf{C}$ 特征值的平方根）的定义出发，执行以下操作：\n\n- 严格推导在 $\\mathbf{F} = \\mathbf{Q} \\in \\mathrm{SO}(3)$ 情况下的主拉伸。\n- 基于此情况下 $\\mathbf{C}$ 和 $\\mathbf{U}$ 的谱性质，解释为什么主方向非唯一，以及这种非唯一性在不变子空间方面是如何构造的。\n\n将三个主拉伸按升序排列，以一个 $1 \\times 3$ 行矩阵的形式报告。无需四舍五入。主拉伸没有需要报告的物理单位。",
            "solution": "该问题要求我们求解纯刚体旋转形变的主拉伸，并讨论主方向的唯一性。形变梯度为 $\\mathbf{F} = \\mathbf{Q}$，其中 $\\mathbf{Q}$ 是一个真正交张量，即 $\\mathbf{Q} \\in \\mathrm{SO}(3)$，满足 $\\mathbf{Q}^{T}\\mathbf{Q} = \\mathbf{I}$ 和 $\\det \\mathbf{Q} = 1$。\n\n首先，我们将严格推导主拉伸。主拉伸记为 $\\lambda_i$，定义为右拉伸张量 $\\mathbf{U}$ 的特征值，或等价地，右 Cauchy–Green 张量 $\\mathbf{C}$ 特征值的平方根。我们将使用这两种方法来证明其一致性。\n\n**方法一：使用右 Cauchy–Green 张量 $\\mathbf{C}$**\n\n右 Cauchy–Green 张量 $\\mathbf{C}$ 由以下关系定义：\n$$\n\\mathbf{C} := \\mathbf{F}^{T}\\mathbf{F}\n$$\n在纯刚体旋转的特殊情况下，形变梯度为 $\\mathbf{F} = \\mathbf{Q}$，其中 $\\mathbf{Q} \\in \\mathrm{SO}(3)$。将此代入 $\\mathbf{C}$ 的定义，得到：\n$$\n\\mathbf{C} = \\mathbf{Q}^{T}\\mathbf{Q}\n$$\n根据正交张量的定义，$\\mathbf{Q}^{T}\\mathbf{Q} = \\mathbf{I}$，其中 $\\mathbf{I}$ 是 $\\mathbb{R}^{3}$ 中的二阶单位张量。因此，对于此形变，右 Cauchy–Green 张量就是单位张量：\n$$\n\\mathbf{C} = \\mathbf{I}\n$$\n$\\mathbf{C}$ 的特征值（我们称之为 $\\lambda_i^{\\mathbf{C}}$）是特征方程 $\\det(\\mathbf{C} - \\lambda^{\\mathbf{C}}\\mathbf{I}) = 0$ 的解。在这种情况下，该方程变为：\n$$\n\\det(\\mathbf{I} - \\lambda^{\\mathbf{C}}\\mathbf{I}) = \\det((1 - \\lambda^{\\mathbf{C}})\\mathbf{I}) = (1 - \\lambda^{\\mathbf{C}})^3 \\det(\\mathbf{I}) = (1 - \\lambda^{\\mathbf{C}})^3 = 0\n$$\n该方程有一个代数重数为 3 的单根 $\\lambda^{\\mathbf{C}} = 1$。因此，$\\mathbf{C}$ 的特征值为：\n$$\n\\lambda_1^{\\mathbf{C}} = 1, \\quad \\lambda_2^{\\mathbf{C}} = 1, \\quad \\lambda_3^{\\mathbf{C}} = 1\n$$\n主拉伸 $\\lambda_i$ 是这些特征值的平方根：\n$$\n\\lambda_i = \\sqrt{\\lambda_i^{\\mathbf{C}}}\n$$\n因此，三个主拉伸为：\n$$\n\\lambda_1 = \\sqrt{1} = 1, \\quad \\lambda_2 = \\sqrt{1} = 1, \\quad \\lambda_3 = \\sqrt{1} = 1\n$$\n\n**方法二：使用右极分解**\n\n右极分解定理指出，任何可逆的形变梯度 $\\mathbf{F}$ 都可以唯一地分解为一个真正交张量 $\\mathbf{R} \\in \\mathrm{SO}(3)$ 和一个对称正定的右拉伸张量 $\\mathbf{U}$ 的乘积：\n$$\n\\mathbf{F} = \\mathbf{R}\\mathbf{U}\n$$\n在我们的例子中，$\\mathbf{F} = \\mathbf{Q}$，其中 $\\mathbf{Q} \\in \\mathrm{SO}(3)$。代入可得：\n$$\n\\mathbf{Q} = \\mathbf{R}\\mathbf{U}\n$$\n我们需要找到满足此方程的 $\\mathbf{R}$ 和 $\\mathbf{U}$，同时满足约束条件：$\\mathbf{R} \\in \\mathrm{SO}(3)$ 且 $\\mathbf{U}$ 是对称正定的。我们提出解为 $\\mathbf{R} = \\mathbf{Q}$ 和 $\\mathbf{U} = \\mathbf{I}$。\n1.  选择 $\\mathbf{R} = \\mathbf{Q}$ 是有效的，因为我们已知 $\\mathbf{Q} \\in \\mathrm{SO}(3)$。\n2.  选择 $\\mathbf{U} = \\mathbf{I}$ 是有效的，因为单位张量 $\\mathbf{I}$ 是对称的（$\\mathbf{I}^T = \\mathbf{I}$）且是正定的（其特征值均为 $1  0$）。\n3.  方程 $\\mathbf{Q} = \\mathbf{R}\\mathbf{U}$ 被满足，因为 $\\mathbf{Q} = \\mathbf{Q}\\mathbf{I}$。\n\n由于对于可逆的 $\\mathbf{F}$（且 $\\mathbf{Q}$ 是可逆的，因为 $\\det \\mathbf{Q} = 1 \\neq 0$），右极分解是唯一的，因此我们提出的解必定是唯一解。所以，右拉伸张量是 $\\mathbf{U} = \\mathbf{I}$。\n\n主拉伸是 $\\mathbf{U}$ 的特征值。通过观察可知，单位张量 $\\mathbf{I}$ 的特征值都等于 1。\n因此，该方法证实了三个主拉伸为 $\\lambda_1 = 1$, $\\lambda_2 = 1, \\lambda_3 = 1$。其物理释义是纯旋转不引起任何拉伸。\n\n**主方向的非唯一性**\n\n主方向定义为右拉伸张量 $\\mathbf{U}$（或等价地，$\\mathbf{C}$）的特征向量的方向。正如我们所确定的，对于纯刚体旋转，$\\mathbf{U} = \\mathbf{I}$。设 $\\mathbf{v}$ 是 $\\mathbf{U}$ 的一个特征向量，对应于主拉伸（特征值）$\\lambda$。特征向量方程为：\n$$\n\\mathbf{Uv} = \\lambda \\mathbf{v}\n$$\n代入 $\\mathbf{U} = \\mathbf{I}$ 和 $\\lambda = 1$，我们得到：\n$$\n\\mathbf{Iv} = 1 \\cdot \\mathbf{v} \\implies \\mathbf{v} = \\mathbf{v}\n$$\n这个方程是一个重言式，对任何向量 $\\mathbf{v} \\in \\mathbb{R}^{3}$ 都成立。这意味着 $\\mathbb{R}^{3}$ 中的每个非零向量都是单位张量的特征向量，其对应的特征值为 1。\n\n与一个特征值相关联的特征空间是该特征值的所有特征向量以及零向量组成的集合。在这种情况下，特征值 $\\lambda = 1$ 的重数为 3，其对应的特征空间是整个空间 $\\mathbb{R}^{3}$。维度大于一的特征空间称为简并特征空间。\n\n因为主方向是特征向量的方向，而 $\\mathbb{R}^{3}$ 中的每个方向都是一个特征向量，所以不存在唯一的一组主方向。通常，一组主方向构成一个标准正交基。由于整个空间 $\\mathbb{R}^{3}$ 是 $\\lambda=1$ 的特征空间，因此 $\\mathbb{R}^{3}$ 的*任何*标准正交基都构成了一组有效的主方向。\n\n这种非唯一性是由 $\\mathbf{U} = \\mathbf{I}$ 的谱性质决定的。$\\mathbf{U}$ 的谱由一个单一的特征值 $\\lambda = 1$ 组成，其重数为 3。对应的特征空间是整个向量空间 $\\mathbb{R}^{3}$，它是在由 $\\mathbf{U}$ 表示的线性变换下的一个 3 维不变子空间。非唯一性的产生是因为我们可以选择任何三个相互正交的单位向量来张成这个不变子空间，它们都将符合主方向的资格。\n\n总而言之，主拉伸均为 1，表示长度没有变化，而主方向是不确定的，因为每个方向（在全局旋转 $\\mathbf{Q}$ 的作用下）都保持不变，没有发生拉伸。\n\n三个主拉伸按升序排列为 1, 1, 1。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1  1  1\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "从理想到现实的跨越是计算力学研究的核心。这项综合性实践将理论知识应用于实际的数值计算挑战中。你的任务是设计并实现一个稳健的算法，用于计算主拉伸和主方向，同时要处理有限精度算术带来的常见问题，如对称性损失和正定性的丧失。这不仅能锻炼你的编程能力，更能让你掌握在实际有限元代码中确保计算结果物理意义和数值稳定性的关键技术 。",
            "id": "3590872",
            "problem": "您的任务是设计并实现一个鲁棒的算法，以根据右柯西-格林变形张量计算主伸长和材料主方向。目标是确保在存在微小不对称性以及因有限精度或建模伪影而接近失去正定性的情况下，算法仍具有数值鲁棒性。您的实现必须是一个完整的、可运行的程序，能够为所提供的测试套件生成指定的输出。\n\n基本原理和定义：\n- 令变形梯度为 $F \\in \\mathbb{R}^{3 \\times 3}$。右柯西-格林变形张量定义为 $C = F^{\\mathsf{T}} F$。\n- 对于任何对称正定 (SPD) 张量 $C$，谱定理保证存在一个标准正交特征基 $\\{N_i\\}_{i=1}^3$ 和非负特征值 $\\{\\mu_i\\}_{i=1}^3$，使得 $C = \\sum_{i=1}^3 \\mu_i \\, N_i \\otimes N_i$。\n- 主伸长 $\\{\\lambda_i\\}_{i=1}^3$ 定义为 $\\lambda_i = \\sqrt{\\mu_i}$，材料主方向是 $C$ 的特征向量 $\\{N_i\\}$。\n- 主方向必须是标准正交的，并且可以选择构成一个右手坐标系。\n\n算法要求：\n1. 输入处理：\n   - 给定一个 $3 \\times 3$ 矩阵，该矩阵要么是变形梯度 $F$，要么是所谓的右柯西-格林张量 $C$，按如下方式构成 $C$：\n     - 如果输入是 $F$，计算 $C = F^{\\mathsf{T}} F$。\n     - 如果输入是 $C$，直接使用它。\n   - 通过 $C \\leftarrow \\frac{1}{2}(C + C^{\\mathsf{T}})$ 强制实现精确对称。\n2. 对称正定 (SPD) 保障措施：\n   - 使用对称特征求解器计算对称化后的 $C$ 的特征分解，以获得特征值 $\\{\\tilde{\\mu}_i\\}$ 和特征向量 $\\{\\tilde{N}_i\\}$。\n   - 定义一个下限参数 $\\varepsilon = \\max\\!\\left(10^{-12},\\,10^{-8}\\,\\lVert C \\rVert_2\\right)$，其中 $\\lVert \\cdot \\rVert_2$ 是谱范数。\n   - 构造修正后的特征值 $\\mu_i = \\max(\\tilde{\\mu}_i, \\varepsilon)$，并重构 SPD 张量 $C_{\\text{spd}} = \\sum_{i=1}^3 \\mu_i \\, \\tilde{N}_i \\otimes \\tilde{N}_i$。\n3. 主伸长和主方向：\n   - 计算 $\\lambda_i = \\sqrt{\\mu_i}$。\n   - 按 $\\lambda_i$ 的非递增顺序对三元组 $\\{(\\lambda_i, \\tilde{N}_i)\\}$ 进行排序。\n   - 对特征向量强制执行确定性的符号约定：\n     - 对于每个特征向量，使其绝对值最大的分量为正。\n     - 此调整后，如果特征向量矩阵的行列式为负，则翻转与最小 $\\lambda_i$ 相关联的特征向量的符号，以确保得到一个右手基。\n4. 重构与诊断：\n   - 使用调整和排序后的特征对重构 $\\widehat{C} = \\sum_{i=1}^3 \\lambda_i^2 \\, N_i \\otimes N_i$，并计算最大绝对重构残差 $e_{\\max} = \\max_{j,k} \\left| \\widehat{C}_{jk} - (C_{\\text{spd}})_{jk} \\right|$。\n   - 同时计算在 SPD 修正之前对称化输入的最小原始特征值 $\\tilde{\\mu}_{\\min} = \\min_i \\tilde{\\mu}_i$，以此作为揭示 SPD 修正是否被激活的诊断指标。\n\n角度单位说明：\n- 测试套件中所有旋转角度均以弧度为单位。\n\n测试套件：\n您的程序必须在以下五个案例上评估该算法，每个案例由确定变形梯度 $F$ 或原始张量 $C$ 的参数定义。旋转是通过轴角公式构造的。对于任何轴向量 $a \\in \\mathbb{R}^3$，使用归一化的单位轴 $\\hat{a} = a/\\lVert a \\rVert$，并通过 Rodrigues 公式定义旋转矩阵：\n$$\nR(\\hat{a},\\theta) = \\cos\\theta \\, I + \\sin\\theta \\, [\\hat{a}]_{\\times} + (1-\\cos\\theta)\\,\\hat{a}\\hat{a}^{\\mathsf{T}},\n$$\n其中 $[\\hat{a}]_{\\times}$ 是与向量 $\\hat{a}$ 的叉积相关联的反对称矩阵。\n\n- 情况 1 (一般情况，良态，输入为 $F$)：\n  - 伸长：$s = [1.3,\\,0.85,\\,1.1]$。\n  - $Q_1 = R([1,2,3],\\,0.7)$。\n  - $U_1 = Q_1 \\,\\mathrm{diag}(s)\\, Q_1^{\\mathsf{T}}$。\n  - $R_1 = R([0.5,-1,0.3],\\,-0.4)$。\n  - 输入 $F = R_1 U_1$。\n\n- 情况 2 (特征值近乎重复，输入为 $F$)：\n  - 伸长：$s = [1.0,\\,1.0,\\,1.000001]$。\n  - $Q_2 = R([1,0,0],\\,1.2)$。\n  - $U_2 = Q_2 \\,\\mathrm{diag}(s)\\, Q_2^{\\mathsf{T}}$。\n  - $R_2 = R([0,1,0],\\,0.3)$。\n  - 输入 $F = R_2 U_2$。\n\n- 情况 3 (带噪声且轻微不定的输入 $C$)：\n  - 真实伸长：$s = [1.5,\\,1.2,\\,0.7]$。\n  - $Q_3 = R([-0.2,1,0.7],\\,1.0)$。\n  - $C_{\\text{true}} = Q_3 \\,\\mathrm{diag}(s^2)\\, Q_3^{\\mathsf{T}}$。\n  - 令 $v_{\\min}$ 为与最小特征值 $0.7^2$ 相关联的 $C_{\\text{true}}$ 的特征向量。\n  - 构造 $C_{\\text{bad}} = C_{\\text{true}} - 0.5\\, v_{\\min} v_{\\min}^{\\mathsf{T}} + \\Delta$，其中 $\\Delta$ 是一个反对称扰动，其元素数量级为 $10^{-8}$，由固定种子生成以保证可复现性。\n  - 输入 $C = C_{\\text{bad}}$。\n\n- 情况 4 (类平面应变 $F$)：\n  - 输入\n    $$\n    F = \\begin{bmatrix}\n    1.2  0.3  0 \\\\\n    0.1  0.9  0 \\\\\n    0  0  1.0\n    \\end{bmatrix}.\n    $$\n\n- 情况 5 (带旋转的各向同性伸长，输入为 $F$)：\n  - 各向同性伸长因子 $\\alpha = 1.05$。\n  - $R_5 = R([1,-1,0.5],\\,0.9)$。\n  - 输入 $F = \\alpha \\, R_5$。\n\n所需输出及格式：\n- 对每种情况，计算：\n  - 主伸长 $\\lambda_1 \\ge \\lambda_2 \\ge \\lambda_3$。\n  - 如上定义的最大绝对重构残差 $e_{\\max}$。\n  - SPD 修正前的最小原始特征值 $\\tilde{\\mu}_{\\min}$。\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表，每个情况对应一个形如 $[\\lambda_1,\\lambda_2,\\lambda_3,e_{\\max},\\tilde{\\mu}_{\\min}]$ 的子列表。\n- 所有数字必须精确打印到小数点后 $8$ 位，行内任何地方都不能有空格。\n- 整体输出结构示例：\n  - $[[\\lambda_{1}^{(1)},\\lambda_{2}^{(1)},\\lambda_{3}^{(1)},e_{\\max}^{(1)},\\tilde{\\mu}_{\\min}^{(1)}],[\\lambda_{1}^{(2)},\\lambda_{2}^{(2)},\\lambda_{3}^{(2)},e_{\\max}^{(2)},\\tilde{\\mu}_{\\min}^{(2)}],\\dots]$。\n\n注意事项：\n- 在此问题中，伸长没有物理单位；它们是无量纲的。\n- 所有角度均使用弧度。\n- 通过遵循上述 SPD 保障措施和确定性的特征向量方向规则，确保数值鲁棒性。",
            "solution": "该问题提出了一个在计算固体力学领域内有效且适定的任务。它要求设计并实现一个算法，从给定的变形张量中计算主伸长及其对应的材料方向，并特别强调实现数值鲁棒性。该问题陈述具有科学依据，内容完整，并提供了清晰、确定性的执行步骤。\n\n问题的核心在于对右柯西-格林变形张量 $C$ 进行谱分析。我们现在将阐述其求解的理论原理和相应的算法步骤。\n\n**1. 理论基础**\n\n在连续介质力学中，物体的变形通过将物质点从参考构型映射到当前构型来描述。这种映射的局部性质由变形梯度张量 $F \\in \\mathbb{R}^{3 \\times 3}$ 捕捉。\n\n右柯西-格林变形张量定义为：\n$$\nC = F^{\\mathsf{T}} F\n$$\n根据此定义，$C$ 是对称的，因为 $C^{\\mathsf{T}} = (F^{\\mathsf{T}} F)^{\\mathsf{T}} = F^{\\mathsf{T}} (F^{\\mathsf{T}})^{\\mathsf{T}} = F^{\\mathsf{T}} F = C$。此外，对于任意非零向量 $X \\in \\mathbb{R}^3$，二次型 $X^{\\mathsf{T}} C X = X^{\\mathsf{T}} F^{\\mathsf{T}} F X = (FX)^{\\mathsf{T}} (FX) = \\lVert FX \\rVert^2 \\ge 0$。如果 $F$ 是可逆的（即 $\\det(F)  0$，这是对物理变形的标准要求），那么对于 $X \\neq 0$，有 $FX \\neq 0$，这意味着 $X^{\\mathsf{T}} C X  0$。因此，$C$ 是一个对称正定 (SPD) 张量。\n\n对称矩阵的谱定理保证 $C$ 有一组三个实特征值 $\\{\\mu_i\\}_{i=1}^3$ 和一个相应的标准正交特征向量基 $\\{N_i\\}_{i=1}^3$。$C$ 的谱分解为：\n$$\nC = \\sum_{i=1}^3 \\mu_i \\, N_i \\otimes N_i\n$$\n其中 $N_i \\otimes N_i$ 表示外积 $N_i N_i^{\\mathsf{T}}$。由于 $C$ 是正定的，其所有特征值 $\\mu_i$ 都严格为正。\n\n主伸长，记为 $\\lambda_i$，是 $C$ 的特征值的正平方根：\n$$\n\\lambda_i = \\sqrt{\\mu_i}\n$$\n物理上，主伸长表示无穷小线元沿主方向被拉伸的因子。材料主方向是 $C$ 的特征向量 $\\{N_i\\}$。这些方向构成一个固定在材料参考构型中的标准正交三轴系，在变形时，它们之间仅发生拉伸而无相对旋转。\n\n**2. 算法实现与鲁棒性**\n\n问题指定了一个精确的算法以确保数值鲁棒性，我们现在将详细说明。\n\n**步骤 2.1：张量构建与对称化**\n输入要么是变形梯度 $F$，要么是所谓的 $C$ 张量。\n- 如果提供的是 $F$，我们计算 $C = F^{\\mathsf{T}} F$。\n- 如果提供的是原始的 $C$，我们直接使用。\n\n在浮点运算中，计算得到的或提供的 $C$ 可能存在微小的不对称性。为确保对称矩阵特征求解器的适用性，我们显式地强制对称性：\n$$\nC_{\\text{sym}} \\leftarrow \\frac{1}{2}(C + C^{\\mathsf{T}})\n$$\n此操作将近似对称的张量投影到对称张量空间上，移除了任何反对称分量。\n\n**步骤 2.2：对称正定 (SPD) 保障措施**\n数值误差可能导致理论上为 SPD 的矩阵出现微小的负特征值。这将妨碍实值主伸长（$\\lambda_i = \\sqrt{\\mu_i}$）的计算。因此， safeguard 是必需的。\n\n首先，我们对对称化后的张量 $C_{\\text{sym}}$ 进行特征分解：\n$$\nC_{\\text{sym}} N_i = \\tilde{\\mu}_i N_i\n$$\n这会得到“原始”特征值 $\\{\\tilde{\\mu}_i\\}$ 及其对应的特征向量 $\\{\\tilde{N}_i\\}$。为此，应使用专门的对称特征求解器，例如 `numpy.linalg.eigh` 提供的求解器。\n\n接下来，我们定义一个下限值 $\\varepsilon$ 以强制特征值为正：\n$$\n\\varepsilon = \\max\\left(10^{-12}, \\, 10^{-8} \\lVert C_{\\text{sym}} \\rVert_2\\right)\n$$\n其中 $\\lVert C_{\\text{sym}} \\rVert_2$ 是 $C_{\\text{sym}}$ 的谱范数，等于其最大绝对特征值。这种混合的绝对/相对容差可防止特征值变为非正值。我们按如下方式计算修正后的特征值 $\\mu_i$：\n$$\n\\mu_i = \\max(\\tilde{\\mu}_i, \\varepsilon)\n$$\n一个关键的诊断量 $\\tilde{\\mu}_{\\min} = \\min_i(\\tilde{\\mu}_i)$ 被保留下来，用于跟踪此修正是否被激活。\n\n利用这些修正后的特征值，我们可以定义一个严格的 SPD 张量 $C_{\\text{spd}}$：\n$$\nC_{\\text{spd}} = \\sum_{i=1}^3 \\mu_i \\, \\tilde{N}_i \\otimes \\tilde{N}_i\n$$\n在某些度量标准下，该张量是与原始 $C_{\\text{sym}}$ 最接近的 SPD 近似，并作为后续计算的基础。\n\n**步骤 2.3：主伸长和主方向**\n主伸长由修正后的特征值计算得出：\n$$\n\\lambda_i = \\sqrt{\\mu_i}\n$$\n为了建立一个规范表示，将（伸长，方向）的三元组，即 $\\{(\\lambda_i, \\tilde{N}_i)\\}$，按照伸长值的非递增顺序排序，得到 $(\\lambda_1, N_1)$、$(\\lambda_2, N_2)$、$(\\lambda_3, N_3)$，使得 $\\lambda_1 \\ge \\lambda_2 \\ge \\lambda_3$。\n\n特征向量的唯一性只到符号为止。为确保结果的确定性，强制执行一个符号约定。\n1. 对于每个排序后的特征向量 $N_i$，我们找到其绝对值最大的分量。如果该分量为负，则翻转整个特征向量的符号（$N_i \\leftarrow -N_i$）。\n2. 在调整所有三个特征向量后，我们通过计算矩阵 $[N_1 \\, N_2 \\, N_3]$ 的行列式来检查它们是否构成一个右手系。如果行列式为负（接近 -1），我们翻转与最小伸长相关联的特征向量 $N_3$ 的符号，$N_3 \\leftarrow -N_3$。这确保了基 $\\{N_1, N_2, N_3\\}$ 是右手的。\n\n**步骤 2.4：重构与诊断**\n最后，计算两个诊断量。\n首先，我们从最终的、排序并定向的主伸长和主方向重构张量 $\\widehat{C}$：\n$$\n\\widehat{C} = \\sum_{i=1}^3 \\lambda_i^2 \\, N_i \\otimes N_i\n$$\n最大绝对重构残差 $e_{\\max}$衡量了这个重构张量与经过保障的 SPD 张量之间的差异：\n$$\ne_{\\max} = \\max_{j,k} \\left| \\widehat{C}_{jk} - (C_{\\text{spd}})_{jk} \\right|\n$$\n理论上，这个残差应该为零（在机器精度范围内），因为对特征向量的符号翻转操作不会改变外积 $N_i N_i^{\\mathsf{T}}$。此检查验证了特征分解和重构过程的内部一致性。\n\n第二个诊断量是 $\\tilde{\\mu}_{\\min}$，即 SPD 修正前的最小原始特征值。一个负的 $\\tilde{\\mu}_{\\min}$ 值表明初始张量不是正定的，并且保障措施是至关重要的。\n\n这个全面、分步的过程提供了一种鲁棒且确定性的方法来计算主伸长和主方向，适合在计算力学代码中实现。所提供的测试套件允许在各种场景下进行验证，从表现良好的情况到具有数值挑战（如近乎重复的特征值和正定性丧失）的情况。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to compute principal stretches and directions for a suite of test cases.\n    \"\"\"\n\n    def skew(v):\n        \"\"\"\n        Returns the skew-symmetric matrix for a 3D vector.\n        \"\"\"\n        return np.array([[0, -v[2], v[1]],\n                         [v[2], 0, -v[0]],\n                         [-v[1], v[0], 0]])\n\n    def rodrigues_formula(axis, angle):\n        \"\"\"\n        Computes the rotation matrix using Rodrigues' formula.\n        R(a, theta) = cos(theta)*I + sin(theta)*[a]x + (1-cos(theta))*a*a^T\n        \"\"\"\n        a = np.asarray(axis)\n        a = a / np.linalg.norm(a)\n        \n        I = np.identity(3)\n        K = skew(a)\n        \n        # Using the formulation with the outer product for clarity\n        # R = np.cos(angle) * I + np.sin(angle) * K + (1 - np.cos(angle)) * np.outer(a, a)\n        \n        # Using the K@K = a*a^T - I formulation\n        R = I + np.sin(angle) * K + (1 - np.cos(angle)) * (K @ K)\n        return R\n\n    def process_tensor(tensor, is_F):\n        \"\"\"\n        Performs the full analysis on a given tensor (F or C).\n        \"\"\"\n        # Step 1: Input handling and Symmetrization\n        if is_F:\n            F = tensor\n            C = F.T @ F\n        else:\n            C = tensor\n        \n        C_sym = 0.5 * (C + C.T)\n\n        # Step 2: SPD Safeguard\n        # Compute eigen-decomposition of symmetrized C\n        # np.linalg.eigh returns eigenvalues in ascending order\n        raw_mu, raw_N = np.linalg.eigh(C_sym)\n        mu_min_raw = raw_mu[0] # Smallest raw eigenvalue\n\n        # Define floor parameter epsilon\n        norm_C = np.max(np.abs(raw_mu))\n        epsilon = max(1e-12, 1e-8 * norm_C)\n\n        # Form corrected eigenvalues\n        mu = np.maximum(raw_mu, epsilon)\n\n        # Reconstruct the SPD tensor\n        C_spd = raw_N @ np.diag(mu) @ raw_N.T\n\n        # Step 3: Principal Stretches and Directions\n        # Compute principal stretches\n        lambdas = np.sqrt(mu)\n\n        # Sort triplets {lambda_i, N_i} in non-increasing order of lambda_i\n        # eigh sorts eigenvalues ascending, so we reverse the order.\n        sorted_indices = np.argsort(lambdas)[::-1]\n        lambdas_sorted = lambdas[sorted_indices]\n        N_sorted = raw_N[:, sorted_indices]\n\n        # Enforce deterministic sign convention on eigenvectors\n        for i in range(3):\n            vec = N_sorted[:, i]\n            max_abs_idx = np.argmax(np.abs(vec))\n            if vec[max_abs_idx]  0:\n                N_sorted[:, i] *= -1\n\n        # Enforce right-handed basis\n        if np.linalg.det(N_sorted)  0:\n            # Flip sign of the eigenvector associated with the smallest lambda\n            N_sorted[:, 2] *= -1\n\n        # Step 4: Reconstruction and Diagnostics\n        # Reconstruct C_hat\n        lambda_sq = lambdas_sorted**2\n        C_hat = N_sorted @ np.diag(lambda_sq) @ N_sorted.T\n\n        # Compute max absolute reconstruction residual\n        e_max = np.max(np.abs(C_hat - C_spd))\n        \n        l1, l2, l3 = lambdas_sorted\n        return [l1, l2, l3, e_max, mu_min_raw]\n\n    # --- Test Suite ---\n    \n    # Case 1: General, well-conditioned, input as F\n    s1 = np.array([1.3, 0.85, 1.1])\n    Q1 = rodrigues_formula([1, 2, 3], 0.7)\n    U1 = Q1 @ np.diag(s1) @ Q1.T\n    R1 = rodrigues_formula([0.5, -1, 0.3], -0.4)\n    F1 = R1 @ U1\n    \n    # Case 2: Nearly repeated eigenvalues, input as F\n    s2 = np.array([1.0, 1.0, 1.000001])\n    Q2 = rodrigues_formula([1, 0, 0], 1.2)\n    U2 = Q2 @ np.diag(s2) @ Q2.T\n    R2 = rodrigues_formula([0, 1, 0], 0.3)\n    F2 = R2 @ U2\n    \n    # Case 3: Noisy and slightly indefinite input as C\n    s3 = np.array([1.5, 1.2, 0.7])\n    Q3 = rodrigues_formula([-0.2, 1, 0.7], 1.0)\n    C_true = Q3 @ np.diag(s3**2) @ Q3.T\n    mu_true, N_true = np.linalg.eigh(C_true)\n    v_min = N_true[:, 0] # Eigenvector for smallest eigenvalue\n    # Create reproducible antisymmetric perturbation\n    np.random.seed(0)\n    D_rand = np.random.rand(3, 3) * 1e-8\n    Delta = D_rand - D_rand.T\n    C_bad = C_true - 0.5 * np.outer(v_min, v_min) + Delta\n\n    # Case 4: Plane strain-like F\n    F4 = np.array([[1.2, 0.3, 0],\n                   [0.1, 0.9, 0],\n                   [0, 0, 1.0]])\n\n    # Case 5: Isotropic stretch with rotation, input as F\n    alpha5 = 1.05\n    R5 = rodrigues_formula([1, -1, 0.5], 0.9)\n    F5 = alpha5 * R5\n\n    test_cases = [\n        (F1, True),\n        (F2, True),\n        (C_bad, False),\n        (F4, True),\n        (F5, True)\n    ]\n    \n    results = []\n    for tensor, is_F in test_cases:\n        case_result = process_tensor(tensor, is_F)\n        results.append(case_result)\n\n    # Format output\n    result_strings = []\n    for res in results:\n        formatted_res = \",\".join([f\"{x:.8f}\" for x in res])\n        result_strings.append(f\"[{formatted_res}]\")\n    \n    final_output = f\"[{','.join(result_strings)}]\"\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}