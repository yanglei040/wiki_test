{
    "hands_on_practices": [
        {
            "introduction": "This first practice grounds our understanding by deriving the Clausius-Duhem inequality from first principles in a simplified, yet insightful, context. Starting with the balance of energy and the entropy inequality under isothermal conditions with zero heat flux, you will isolate the mechanical dissipation and interpret its physical meaning. This exercise  is fundamental for appreciating how the second law of thermodynamics constrains the relationship between stress, deformation, and stored free energy.",
            "id": "3562449",
            "problem": "Consider a continuum body undergoing a homogeneous, isothermal process at constant absolute temperature $T$ with negligible body forces, no volumetric heat sources, and zero heat flux. Let the local kinematics be described by the velocity gradient $\\mathbf{L}$ with symmetric part $\\mathbf{d} = \\frac{1}{2}(\\mathbf{L} + \\mathbf{L}^{\\mathsf{T}})$, and let the local stress be the Cauchy stress tensor $\\boldsymbol{\\sigma}$. Assume that at a material point the tensors $\\boldsymbol{\\sigma}$ and $\\mathbf{d}$ share a common principal basis and are diagonal, with $\\boldsymbol{\\sigma} = \\operatorname{diag}(\\sigma_1,\\sigma_2,\\sigma_3)$ and $\\mathbf{d} = \\operatorname{diag}(d_1,d_2,d_3)$, where $\\sigma_i$ and $d_i$ are the principal stress components and principal rates of deformation, respectively.\n\nStarting from the balance of energy (first law of thermodynamics) and the local form of the second law of thermodynamics (entropy inequality), and introducing the specific Helmholtz free energy $\\psi = e - T s$ (where $e$ is the specific internal energy and $s$ is the specific entropy), derive the specialized form of the Clausius-Duhem relation for the present isothermal, homogeneous, no-heat-flux setting, identifying the mechanical dissipation density in terms of $\\boldsymbol{\\sigma}:\\mathbf{d}$ and $\\rho \\dot{\\psi}$, where $\\rho$ is the mass density. Then, compute the stress power $\\boldsymbol{\\sigma}:\\mathbf{d}$ for the given diagonal tensors. Finally, use the derived inequality to interpret the sign of $\\boldsymbol{\\sigma}:\\mathbf{d}$ in terms of whether the process produces energy within the material (e.g., increases stored free energy or dissipates) or consumes energy (e.g., the material does net work on the surroundings by reducing stored free energy).\n\nExpress your final answer as a single closed-form analytic expression for $\\boldsymbol{\\sigma}:\\mathbf{d}$ in terms of $\\sigma_1$, $\\sigma_2$, $\\sigma_3$, $d_1$, $d_2$, and $d_3. No numerical evaluation is requested.",
            "solution": "The problem is validated as being scientifically grounded, well-posed, and objective. It is a standard derivation in continuum thermomechanics. All necessary information is provided, and the assumptions are consistent and physically reasonable within the context of theoretical mechanics. The problem is solvable.\n\nWe begin the derivation from the local form of the first and second laws of thermodynamics.\n\nThe first law of thermodynamics, or the balance of energy, in its local form for a continuum is given by:\n$$\n\\rho \\dot{e} = \\boldsymbol{\\sigma}:\\mathbf{d} - \\nabla \\cdot \\mathbf{q} + \\rho r\n$$\nwhere $\\rho$ is the mass density, $\\dot{e}$ is the material time derivative of the specific internal energy $e$, $\\boldsymbol{\\sigma}$ is the Cauchy stress tensor, $\\mathbf{d}$ is the rate of deformation tensor (the symmetric part of the velocity gradient $\\mathbf{L}$), $\\mathbf{q}$ is the heat flux vector, and $r$ is the specific heat supply rate (volumetric heat source per unit mass).\n\nThe second law of thermodynamics, expressed as the local entropy inequality, is:\n$$\n\\rho \\dot{s} \\ge - \\nabla \\cdot \\left(\\frac{\\mathbf{q}}{T}\\right) + \\frac{\\rho r}{T}\n$$\nwhere $\\dot{s}$ is the material time derivative of the specific entropy $s$ and $T$ is the absolute temperature.\n\nThe problem specifies several simplifying conditions:\n1.  The process is isothermal, so the temperature $T$ is constant, which implies $\\dot{T} = 0$.\n2.  There are no volumetric heat sources, so $r = 0$.\n3.  The heat flux is zero, so $\\mathbf{q} = \\mathbf{0}$. This also implies that its divergence is zero, $\\nabla \\cdot \\mathbf{q} = 0$.\n\nApplying these conditions to the balance of energy equation, we get:\n$$\n\\rho \\dot{e} = \\boldsymbol{\\sigma}:\\mathbf{d}\n$$\nThis states that under these adiabatic conditions, the rate of change of internal energy is equal to the stress power per unit volume.\n\nApplying the same conditions to the entropy inequality, we find that the term $\\frac{\\rho r}{T}$ is zero, and the term $\\nabla \\cdot \\left(\\frac{\\mathbf{q}}{T}\\right)$ is also zero since $\\mathbf{q} = \\mathbf{0}$ and $T$ is spatially constant (due to homogeneity of the process). The inequality simplifies to:\n$$\n\\rho \\dot{s} \\ge 0\n$$\n\nNext, we introduce the specific Helmholtz free energy, $\\psi$, defined as:\n$$\n\\psi = e - T s\n$$\nWe take the material time derivative of $\\psi$:\n$$\n\\dot{\\psi} = \\dot{e} - \\dot{T}s - T \\dot{s}\n$$\nSince the process is isothermal, $\\dot{T} = 0$, and the expression simplifies to:\n$$\n\\dot{\\psi} = \\dot{e} - T \\dot{s}\n$$\nThis equation can be rearranged to express the rate of change of internal energy, $\\dot{e}$, or the entropy production term, $T\\dot{s}$:\n$$\n\\dot{e} = \\dot{\\psi} + T \\dot{s} \\quad \\text{or} \\quad T \\dot{s} = \\dot{e} - \\dot{\\psi}\n$$\n\nNow, we substitute the simplified energy balance, $\\rho \\dot{e} = \\boldsymbol{\\sigma}:\\mathbf{d}$, into the expression for $T\\dot{s}$:\n$$\nT \\dot{s} = \\frac{1}{\\rho}(\\boldsymbol{\\sigma}:\\mathbf{d}) - \\dot{\\psi}\n$$\nMultiplying by $\\rho$, we get:\n$$\n\\rho T \\dot{s} = \\boldsymbol{\\sigma}:\\mathbf{d} - \\rho \\dot{\\psi}\n$$\nThe simplified entropy inequality is $\\rho \\dot{s} \\ge 0$. Since $T  0$, this is equivalent to $\\rho T \\dot{s} \\ge 0$. Substituting our expression for $\\rho T \\dot{s}$ yields the specialized form of the Clausius-Duhem relation for this process:\n$$\n\\boldsymbol{\\sigma}:\\mathbf{d} - \\rho \\dot{\\psi} \\ge 0\n$$\nThe quantity $\\mathcal{D}_{\\text{mech}} = \\boldsymbol{\\sigma}:\\mathbf{d} - \\rho \\dot{\\psi}$ is the mechanical dissipation density. It represents the portion of the stress power per unit volume, $\\boldsymbol{\\sigma}:\\mathbf{d}$, that is not stored as reversible free energy (the term $\\rho \\dot{\\psi}$) and is therefore dissipated, in this case converted into entropy. The inequality states that this dissipation must be non-negative.\n\nThe second part of the problem requires computing the stress power, $\\boldsymbol{\\sigma}:\\mathbf{d}$. The double-dot product of two second-order tensors $\\mathbf{A}$ and $\\mathbf{B}$ is defined as $\\mathbf{A}:\\mathbf{B} = \\operatorname{tr}(\\mathbf{A}^{\\mathsf{T}}\\mathbf{B})$. Since both $\\boldsymbol{\\sigma}$ and $\\mathbf{d}$ are symmetric, this is simply $\\operatorname{tr}(\\boldsymbol{\\sigma}\\mathbf{d})$. The problem states that in a common principal basis, the tensors are diagonal:\n$$\n\\boldsymbol{\\sigma} = \\operatorname{diag}(\\sigma_1, \\sigma_2, \\sigma_3) \\quad \\text{and} \\quad \\mathbf{d} = \\operatorname{diag}(d_1, d_2, d_3)\n$$\nIn this basis, the matrix product $\\boldsymbol{\\sigma}\\mathbf{d}$ is also diagonal:\n$$\n\\boldsymbol{\\sigma}\\mathbf{d} = \\begin{pmatrix} \\sigma_1  0  0 \\\\ 0  \\sigma_2  0 \\\\ 0  0  \\sigma_3 \\end{pmatrix} \\begin{pmatrix} d_1  0  0 \\\\ 0  d_2  0 \\\\ 0  0  d_3 \\end{pmatrix} = \\begin{pmatrix} \\sigma_1 d_1  0  0 \\\\ 0  \\sigma_2 d_2  0 \\\\ 0  0  \\sigma_3 d_3 \\end{pmatrix}\n$$\nThe trace of this product matrix is the sum of its diagonal elements:\n$$\n\\boldsymbol{\\sigma}:\\mathbf{d} = \\operatorname{tr}(\\boldsymbol{\\sigma}\\mathbf{d}) = \\sigma_1 d_1 + \\sigma_2 d_2 + \\sigma_3 d_3\n$$\nThis is the closed-form analytic expression for the stress power.\n\nFinally, we interpret the sign of $\\boldsymbol{\\sigma}:\\mathbf{d}$ using the inequality $\\boldsymbol{\\sigma}:\\mathbf{d} \\ge \\rho \\dot{\\psi}$.\nThe term $\\boldsymbol{\\sigma}:\\mathbf{d}$ represents the rate of work per unit volume done by the stresses *on* the material.\nThe term $\\rho \\dot{\\psi}$ represents the rate of increase of stored (recoverable) free energy per unit volume.\n- If $\\boldsymbol{\\sigma}:\\mathbf{d}  0$, the surroundings are doing positive work on the material. This supplied energy is partitioned into an increase in stored free energy ($\\rho \\dot{\\psi}$) and dissipation ($\\mathcal{D}_{\\text{mech}} \\ge 0$). This corresponds to a process that consumes energy from the outside and either stores it or dissipates it, thus \"producing\" an increase in the energy content (stored or dissipated) of the material.\n- If $\\boldsymbol{\\sigma}:\\mathbf{d}  0$, the material is doing net work on its surroundings. For this to happen, the inequality $\\boldsymbol{\\sigma}:\\mathbf{d} \\ge \\rho \\dot{\\psi}$ must hold. This implies $\\rho \\dot{\\psi}$ must be negative and its magnitude must be greater than or equal to the magnitude of the dissipation plus the magnitude of the work done. Specifically, $\\rho \\dot{\\psi} \\le \\boldsymbol{\\sigma}:\\mathbf{d}  0$. This means the material is releasing its stored free energy ($\\dot{\\psi}  0$) at a rate sufficient to perform work on the surroundings and cover any internal dissipation. This corresponds to a process where the material \"consumes\" its own stored energy to produce work.",
            "answer": "$$\n\\boxed{\\sigma_1 d_1 + \\sigma_2 d_2 + \\sigma_3 d_3}\n$$"
        },
        {
            "introduction": "Building on the fundamental derivation, this exercise demonstrates how the Clausius-Duhem inequality is applied to a specific, realistic material model for a thermo-viscoelastic solid. In this problem , you will use the inequality as a powerful tool to enforce thermodynamic consistency, deriving the expression for entropy from the Helmholtz free energy and identifying the distinct contributions of mechanical viscosity and thermal conduction to the total dissipation $\\mathcal{D}$. This practice is key to understanding how thermodynamically consistent constitutive models are constructed.",
            "id": "3562420",
            "problem": "Consider a thermomechanically coupled small-strain uniaxial solid in tension along the axial coordinate $x$, with temperature field $T(x,t)$ and strain $\\varepsilon(x,t)$. Assume the following:\n\n- The mass density is $\\rho$, the Young's modulus is $E$, the coefficient of linear thermal expansion is $\\alpha$, the viscous modulus is $\\eta_{v}$, the specific heat at constant strain is $c$, and the thermal conductivity is $k$. All material parameters are constants.\n- The Helmholtz free energy per unit mass is given by\n$$\n\\psi(\\varepsilon,T) = \\frac{E}{2\\rho}\\left(\\varepsilon - \\alpha\\left(T - T_{0}\\right)\\right)^{2} + c\\left(T - T_{0} - T\\ln\\frac{T}{T_{0}}\\right),\n$$\nwhere $T_{0}$ is a fixed reference temperature and $\\ln$ denotes the natural logarithm.\n- The constitutive structure is\n$$\n\\sigma = \\rho\\,\\frac{\\partial \\psi}{\\partial \\varepsilon} + \\eta_{v}\\,\\dot{\\varepsilon}, \\qquad q_{x} = -k\\,\\frac{\\partial T}{\\partial x}, \\qquad r = 0,\n$$\nwhere $\\sigma$ is the Cauchy stress, $q_{x}$ is the axial heat flux, and $r$ is the volumetric heat source.\n- The state at a material point at time $t$ is described by $\\varepsilon(t)$, $\\dot{\\varepsilon}(t)$, $T(t)$, and a uniform axial temperature gradient $\\frac{\\partial T}{\\partial x}(t)$.\n\nStarting from the balance of energy and the local form of the Second Law of Thermodynamics (SLT), use the definition of Helmholtz free energy $\\psi = u - Ts$, where $u$ is the internal energy per unit mass and $s$ is the entropy per unit mass, to derive the Clausius-Duhem inequality (CDI) appropriate for this one-dimensional setting. Then, specialize the inequality to the given constitutive structure and evaluate the instantaneous dissipation density $\\mathcal{D}$ at the material point described above. Provide your final result as a single closed-form analytic expression in terms of $\\eta_{v}$, $k$, $T$, $\\dot{\\varepsilon}$, and $\\frac{\\partial T}{\\partial x}$, and express the final dissipation density in watts per cubic meter. Do not round your answer. In your derivation, identify how mechanical and thermal contributions combine in $\\mathcal{D}$ under the Clausius-Duhem inequality.",
            "solution": "The problem is first validated to ensure it is scientifically sound, self-contained, and well-posed.\n\n### Step 1: Extract Givens\n- **System**: A thermomechanically coupled small-strain uniaxial solid.\n- **Coordinates**: Axial coordinate $x$, time $t$.\n- **Fields**: Temperature $T(x,t)$, axial strain $\\varepsilon(x,t)$.\n- **Material Parameters**: Mass density $\\rho$, Young's modulus $E$, coefficient of linear thermal expansion $\\alpha$, viscous modulus $\\eta_{v}$, specific heat at constant strain $c$, thermal conductivity $k$. All are constants.\n- **Reference Temperature**: $T_{0}$.\n- **Helmholtz Free Energy (per unit mass)**:\n$$\n\\psi(\\varepsilon,T) = \\frac{E}{2\\rho}\\left(\\varepsilon - \\alpha\\left(T - T_{0}\\right)\\right)^{2} + c\\left(T - T_{0} - T\\ln\\frac{T}{T_{0}}\\right)\n$$\n- **Constitutive Structure**:\n  - Cauchy stress: $\\sigma = \\rho\\,\\frac{\\partial \\psi}{\\partial \\varepsilon} + \\eta_{v}\\,\\dot{\\varepsilon}$\n  - Axial heat flux: $q_{x} = -k\\,\\frac{\\partial T}{\\partial x}$\n  - Volumetric heat source: $r = 0$\n- **State variables at a point**: $\\varepsilon(t)$, $\\dot{\\varepsilon}(t)$, $T(t)$, $\\frac{\\partial T}{\\partial x}(t)$.\n- **Relation**: Helmholtz free energy $\\psi = u - Ts$, where $u$ is internal energy per unit mass and $s$ is entropy per unit mass.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem describes a standard thermo-viscoelastic material model within the framework of continuum mechanics. The form of the Helmholtz free energy is a common choice for thermoelasticity (the first term) combined with a standard caloric part (the second term). The constitutive relations for stress (a thermoelastic part plus a linear viscous part) and heat flux (Fourier's law) are fundamental and widely used. The problem is firmly based on established principles of thermodynamics and solid mechanics.\n- **Well-Posed**: The problem asks for the derivation of a standard inequality (Clausius-Duhem) and the evaluation of a derived quantity (dissipation density) based on a complete set of provided constitutive laws. The task is unambiguous and leads to a unique analytical solution.\n- **Objective**: The problem is stated using precise, objective, and standard scientific terminology. There are no subjective or opinion-based elements.\n- **Completeness and Consistency**: The problem provides all necessary definitions, equations, and parameters to perform the derivation. The given equations are consistent with each other within the context of continuum thermodynamics. For example, the stress is additively decomposed into a non-dissipative part derived from the potential $\\psi$ and a dissipative part, which is consistent with the Coleman-Noll procedure that will be used.\n\n### Step 3: Verdict and Action\nThe problem is valid as it is scientifically sound, well-posed, objective, complete, and consistent. I will proceed with the derivation and solution.\n\nThe derivation begins with the local form of the balance of energy (First Law of Thermodynamics) and the local statement of the Second Law of Thermodynamics (the entropy inequality).\n\nThe local energy balance for a one-dimensional continuum, in the absence of body forces and with a volumetric heat source $r$, is given by:\n$$\n\\rho\\,\\dot{u} = \\sigma\\,\\dot{\\varepsilon} - \\frac{\\partial q_{x}}{\\partial x} + \\rho\\,r\n$$\nHere, $\\dot{u}$ is the material time derivative of the specific internal energy $u$, and $\\dot{\\varepsilon}$ is the material time derivative of the strain $\\varepsilon$. The problem states that the volumetric heat source $r=0$, so the energy balance simplifies to:\n$$\n\\rho\\,\\dot{u} = \\sigma\\,\\dot{\\varepsilon} - \\frac{\\partial q_{x}}{\\partial x}\n$$\nThe Second Law of Thermodynamics, in its local form, is the entropy inequality, which states that the rate of entropy production must be non-negative. For a one-dimensional system, this is expressed as:\n$$\n\\rho\\,\\dot{s} + \\frac{\\partial}{\\partial x}\\left(\\frac{q_{x}}{T}\\right) - \\frac{\\rho\\,r}{T} \\ge 0\n$$\nwhere $s$ is the specific entropy. Again, with $r=0$, this becomes:\n$$\n\\rho\\,\\dot{s} + \\frac{\\partial}{\\partial x}\\left(\\frac{q_{x}}{T}\\right) \\ge 0\n$$\nThe quantity on the left is the rate of entropy production per unit volume. The dissipation density $\\mathcal{D}$ is defined as this rate multiplied by the absolute temperature $T$:\n$$\n\\mathcal{D} = T\\left(\\rho\\,\\dot{s} + \\frac{\\partial}{\\partial x}\\left(\\frac{q_{x}}{T}\\right)\\right) \\ge 0\n$$\nExpanding the spatial derivative using the product rule gives:\n$$\n\\mathcal{D} = \\rho\\,T\\,\\dot{s} + T\\left(\\frac{1}{T}\\frac{\\partial q_{x}}{\\partial x} - \\frac{q_{x}}{T^2}\\frac{\\partial T}{\\partial x}\\right) = \\rho\\,T\\,\\dot{s} + \\frac{\\partial q_{x}}{\\partial x} - \\frac{q_{x}}{T}\\frac{\\partial T}{\\partial x}\n$$\nFrom the energy balance equation, we can substitute for the heat flux divergence, $\\frac{\\partial q_{x}}{\\partial x} = \\sigma\\,\\dot{\\varepsilon} - \\rho\\,\\dot{u}$:\n$$\n\\mathcal{D} = \\rho\\,T\\,\\dot{s} + \\left(\\sigma\\,\\dot{\\varepsilon} - \\rho\\,\\dot{u}\\right) - \\frac{q_{x}}{T}\\frac{\\partial T}{\\partial x}\n$$\nNow, we use the definition of the Helmholtz free energy per unit mass, $\\psi = u - T\\,s$. Taking its material time derivative yields:\n$$\n\\dot{\\psi} = \\dot{u} - \\dot{T}\\,s - T\\,\\dot{s} \\implies \\dot{u} = \\dot{\\psi} + \\dot{T}\\,s + T\\,\\dot{s}\n$$\nSubstituting this expression for $\\dot{u}$ into the equation for $\\mathcal{D}$:\n$$\n\\mathcal{D} = \\rho\\,T\\,\\dot{s} + \\sigma\\,\\dot{\\varepsilon} - \\rho\\left(\\dot{\\psi} + \\dot{T}\\,s + T\\,\\dot{s}\\right) - \\frac{q_{x}}{T}\\frac{\\partial T}{\\partial x}\n$$\nThe terms $\\rho\\,T\\,\\dot{s}$ cancel out, leaving the Clausius-Duhem inequality in terms of the Helmholtz free energy:\n$$\n\\mathcal{D} = \\sigma\\,\\dot{\\varepsilon} - \\rho\\left(\\dot{\\psi} + s\\,\\dot{T}\\right) - \\frac{q_{x}}{T}\\frac{\\partial T}{\\partial x} \\ge 0\n$$\nThis is the required inequality. Now we specialize it using the provided constitutive structure. The Helmholtz free energy $\\psi$ is a function of strain $\\varepsilon$ and temperature $T$, so its material time derivative is given by the chain rule:\n$$\n\\dot{\\psi} = \\frac{\\partial \\psi}{\\partial \\varepsilon}\\dot{\\varepsilon} + \\frac{\\partial \\psi}{\\partial T}\\dot{T}\n$$\nSubstituting this into the expression for $\\mathcal{D}$:\n$$\n\\mathcal{D} = \\sigma\\,\\dot{\\varepsilon} - \\rho\\left(\\left(\\frac{\\partial \\psi}{\\partial \\varepsilon}\\dot{\\varepsilon} + \\frac{\\partial \\psi}{\\partial T}\\dot{T}\\right) + s\\,\\dot{T}\\right) - \\frac{q_{x}}{T}\\frac{\\partial T}{\\partial x} \\ge 0\n$$\nGrouping terms by the rates $\\dot{\\varepsilon}$ and $\\dot{T}$:\n$$\n\\mathcal{D} = \\left(\\sigma - \\rho\\frac{\\partial \\psi}{\\partial \\varepsilon}\\right)\\dot{\\varepsilon} - \\rho\\left(\\frac{\\partial \\psi}{\\partial T} + s\\right)\\dot{T} - \\frac{q_{x}}{T}\\frac{\\partial T}{\\partial x} \\ge 0\n$$\nThe problem provides the constitutive relation for stress: $\\sigma = \\rho\\,\\frac{\\partial \\psi}{\\partial \\varepsilon} + \\eta_{v}\\,\\dot{\\varepsilon}$. Substituting this into the first term gives:\n$$\n\\sigma - \\rho\\frac{\\partial \\psi}{\\partial \\varepsilon} = \\left(\\rho\\frac{\\partial \\psi}{\\partial \\varepsilon} + \\eta_{v}\\,\\dot{\\varepsilon}\\right) - \\rho\\frac{\\partial \\psi}{\\partial \\varepsilon} = \\eta_{v}\\,\\dot{\\varepsilon}\n$$\nThe inequality for $\\mathcal{D}$ now reads:\n$$\n\\mathcal{D} = \\left(\\eta_{v}\\,\\dot{\\varepsilon}\\right)\\dot{\\varepsilon} - \\rho\\left(\\frac{\\partial \\psi}{\\partial T} + s\\right)\\dot{T} - \\frac{q_{x}}{T}\\frac{\\partial T}{\\partial x} \\ge 0\n$$\n$$\n\\mathcal{D} = \\eta_{v}\\,\\dot{\\varepsilon}^2 - \\rho\\left(\\frac{\\partial \\psi}{\\partial T} + s\\right)\\dot{T} - \\frac{q_{x}}{T}\\frac{\\partial T}{\\partial x} \\ge 0\n$$\nAccording to the Coleman-Noll procedure, this inequality must hold for all admissible thermodynamic processes, which means for arbitrary choices of the rates (in this case, $\\dot{T}$) that are not constitutively determined. Since the coefficient of $\\dot{T}$ is independent of $\\dot{T}$, to prevent violation of the inequality (e.g., by choosing a very large positive or negative $\\dot{T}$), its coefficient must be zero. This yields the standard thermodynamic relation for entropy:\n$$\n\\rho\\left(\\frac{\\partial \\psi}{\\partial T} + s\\right) = 0 \\implies s = -\\frac{\\partial \\psi}{\\partial T}\n$$\nWith this result, the inequality for the dissipation density simplifies to the residual dissipation inequality:\n$$\n\\mathcal{D} = \\eta_{v}\\,\\dot{\\varepsilon}^2 - \\frac{q_{x}}{T}\\frac{\\partial T}{\\partial x} \\ge 0\n$$\nThis expression reveals that the total dissipation is the sum of contributions from mechanical and thermal processes. The term $\\eta_{v}\\,\\dot{\\varepsilon}^2$ represents mechanical dissipation due to viscosity.\nFinally, we substitute the constitutive law for the heat flux, $q_{x} = -k\\,\\frac{\\partial T}{\\partial x}$:\n$$\n\\mathcal{D} = \\eta_{v}\\,\\dot{\\varepsilon}^2 - \\frac{\\left(-k\\,\\frac{\\partial T}{\\partial x}\\right)}{T}\\frac{\\partial T}{\\partial x}\n$$\n$$\n\\mathcal{D} = \\eta_{v}\\,\\dot{\\varepsilon}^2 + \\frac{k}{T}\\left(\\frac{\\partial T}{\\partial x}\\right)^2\n$$\nThis is the final expression for the instantaneous dissipation density. It is the sum of the mechanical dissipation due to viscosity, $\\mathcal{D}_{\\text{mech}} = \\eta_{v}\\,\\dot{\\varepsilon}^2$, and the thermal dissipation due to heat conduction, $\\mathcal{D}_{\\text{therm}} = \\frac{k}{T}\\left(\\frac{\\partial T}{\\partial x}\\right)^2$. Since $\\eta_v \\ge 0$, $k \\ge 0$, and $T  0$ for any physical system, both terms are non-negative, ensuring that the total dissipation $\\mathcal{D}$ is always non-negative, satisfying the Second Law of Thermodynamics. The units are W/m$^3$, as required.",
            "answer": "$$\n\\boxed{\\eta_{v}\\,\\dot{\\varepsilon}^{2} + \\frac{k}{T}\\left(\\frac{\\partial T}{\\partial x}\\right)^{2}}\n$$"
        },
        {
            "introduction": "This final practice bridges theory with computational reality by showing how to monitor thermodynamic consistency within a finite element simulation. You will implement the full expression for the local dissipation density, $\\mathcal{D}$, to check for violations of the second law of thermodynamics at the quadrature-point level, where all local constitutive calculations are performed . This task provides a practical method for diagnosing unphysical behavior in numerical results, a crucial skill for any computational mechanician.",
            "id": "3562499",
            "problem": "A solid continuum is modeled in two dimensions under plane strain conditions. Consider a standard finite element implementation with isoparametric elements and numerical quadrature. Your task is to express, derive, and implement the local dissipation density at quadrature points and use it to detect violations of the second law of thermodynamics via the Clausius-Duhem inequality.\n\nUse the following fundamental base:\n- The balance of energy (first law of thermodynamics) in local form, relating mechanical power, heat flux divergence, and internal energy rate.\n- The entropy inequality (second law of thermodynamics) in local form, stating that the material time rate of entropy is bounded from below by the entropy flux and heat supply contributions.\n- The definition of Helmholtz free energy per unit mass $\\psi$ as $\\psi = e - T s$, where $e$ is the specific internal energy, $T$ is the absolute temperature, and $s$ is the specific entropy.\n\nFrom these bases, derive an expression for the local dissipation density $\\mathcal{D}$ at a material point, in terms of the Cauchy stress tensor $\\boldsymbol{\\sigma}$, the symmetric rate of deformation tensor $\\mathbf{d}$, the mass density $\\rho$, the material time derivative of Helmholtz free energy per unit mass $\\dot{\\psi}$, specific entropy $s$, temperature time rate $\\dot{T}$, the heat flux vector $\\mathbf{q}$, the temperature gradient $\\nabla T$, and the absolute temperature $T$. The dissipation density must be expressed in units of $\\mathrm{W/m^3}$.\n\nImplement the following algorithm for each finite element:\n1. For each quadrature point $i$, compute the double contraction $\\boldsymbol{\\sigma}_i : \\mathbf{d}_i$, the mechanical energy storage terms involving $\\rho_i \\dot{\\psi}_i$ and $\\rho_i s_i \\dot{T}_i$, and the heat conduction term involving $\\mathbf{q}_i \\cdot \\nabla T_i$ and $T_i$.\n2. Compute the local dissipation density $\\mathcal{D}_i$ at each quadrature point, expressed in $\\mathrm{W/m^3}$.\n3. Use a non-negativity check for the second law: the inequality requires $\\mathcal{D}_i \\ge 0$ for all quadrature points $i$ in the element. Use a numerical tolerance $\\epsilon = 10^{-12}\\,\\mathrm{W/m^3}$ and declare the element valid if $\\mathcal{D}_i \\ge -\\epsilon$ for all quadrature points, and invalid otherwise.\n\nAll inputs are provided in the International System of Units (SI). Use the following test suite of four elements, each having two quadrature points with equal weights. For each quadrature point, you are given the fields: $\\boldsymbol{\\sigma}$ in $\\mathrm{Pa}$, $\\mathbf{d}$ in $\\mathrm{s^{-1}}$, $\\rho$ in $\\mathrm{kg/m^3}$, $\\dot{\\psi}$ in $\\mathrm{J/(kg\\cdot s)}$, $s$ in $\\mathrm{J/(kg\\cdot K)}$, $\\dot{T}$ in $\\mathrm{K/s}$, $\\mathbf{q}$ in $\\mathrm{W/m^2}$, $\\nabla T$ in $\\mathrm{K/m}$, and $T$ in $\\mathrm{K}$. Compute the element-wise validity as described above.\n\nTest Suite:\n- Element $1$:\n  - Quadrature point $1$: $\\boldsymbol{\\sigma} = \\begin{bmatrix}100\\times 10^6  0\\\\ 0  50\\times 10^6\\end{bmatrix}\\,\\mathrm{Pa}$, $\\mathbf{d} = \\begin{bmatrix}1\\times 10^{-4}  0\\\\ 0  0.5\\times 10^{-4}\\end{bmatrix}\\,\\mathrm{s^{-1}}$, $\\rho = 12500\\,\\mathrm{kg/m^3}$, $\\dot{\\psi} = 1\\,\\mathrm{J/(kg\\cdot s)}$, $s = 1000\\,\\mathrm{J/(kg\\cdot K)}$, $\\dot{T} = 0\\,\\mathrm{K/s}$, $\\mathbf{q} = \\begin{bmatrix}-1000\\\\ 0\\end{bmatrix}\\,\\mathrm{W/m^2}$, $\\nabla T = \\begin{bmatrix}10\\\\ 0\\end{bmatrix}\\,\\mathrm{K/m}$, $T = 300\\,\\mathrm{K}$.\n  - Quadrature point $2$: $\\boldsymbol{\\sigma} = \\begin{bmatrix}100\\times 10^6  0\\\\ 0  50\\times 10^6\\end{bmatrix}\\,\\mathrm{Pa}$, $\\mathbf{d} = \\begin{bmatrix}1\\times 10^{-4}  0\\\\ 0  0.5\\times 10^{-4}\\end{bmatrix}\\,\\mathrm{s^{-1}}$, $\\rho = 12500\\,\\mathrm{kg/m^3}$, $\\dot{\\psi} = 1\\,\\mathrm{J/(kg\\cdot s)}$, $s = 1000\\,\\mathrm{J/(kg\\cdot K)}$, $\\dot{T} = 0\\,\\mathrm{K/s}$, $\\mathbf{q} = \\begin{bmatrix}-500\\\\ -500\\end{bmatrix}\\,\\mathrm{W/m^2}$, $\\nabla T = \\begin{bmatrix}5\\\\ 5\\end{bmatrix}\\,\\mathrm{K/m}$, $T = 350\\,\\mathrm{K}$.\n- Element $2$:\n  - Quadrature point $1$: Same as Element $1$ Quadrature point $1$.\n  - Quadrature point $2$: $\\boldsymbol{\\sigma} = \\begin{bmatrix}100\\times 10^6  0\\\\ 0  50\\times 10^6\\end{bmatrix}\\,\\mathrm{Pa}$, $\\mathbf{d} = \\begin{bmatrix}1\\times 10^{-4}  0\\\\ 0  0.5\\times 10^{-4}\\end{bmatrix}\\,\\mathrm{s^{-1}}$, $\\rho = 12500\\,\\mathrm{kg/m^3}$, $\\dot{\\psi} = 1\\,\\mathrm{J/(kg\\cdot s)}$, $s = 1000\\,\\mathrm{J/(kg\\cdot K)}$, $\\dot{T} = 0\\,\\mathrm{K/s}$, $\\mathbf{q} = \\begin{bmatrix}500\\\\ 500\\end{bmatrix}\\,\\mathrm{W/m^2}$, $\\nabla T = \\begin{bmatrix}5\\\\ 5\\end{bmatrix}\\,\\mathrm{K/m}$, $T = 350\\,\\mathrm{K}$.\n- Element $3$:\n  - Quadrature point $1$: $\\boldsymbol{\\sigma} = \\begin{bmatrix}100\\times 10^6  0\\\\ 0  50\\times 10^6\\end{bmatrix}\\,\\mathrm{Pa}$, $\\mathbf{d} = \\begin{bmatrix}1\\times 10^{-4}  0\\\\ 0  0.5\\times 10^{-4}\\end{bmatrix}\\,\\mathrm{s^{-1}}$, $\\rho = 12500\\,\\mathrm{kg/m^3}$, $\\dot{\\psi} = 0.992\\,\\mathrm{J/(kg\\cdot s)}$, $s = 1000\\,\\mathrm{J/(kg\\cdot K)}$, $\\dot{T} = 0\\,\\mathrm{K/s}$, $\\mathbf{q} = \\begin{bmatrix}-1000\\\\ 0\\end{bmatrix}\\,\\mathrm{W/m^2}$, $\\nabla T = \\begin{bmatrix}10\\\\ 0\\end{bmatrix}\\,\\mathrm{K/m}$, $T = 300\\,\\mathrm{K}$.\n  - Quadrature point $2$: $\\boldsymbol{\\sigma} = \\begin{bmatrix}100\\times 10^6  0\\\\ 0  50\\times 10^6\\end{bmatrix}\\,\\mathrm{Pa}$, $\\mathbf{d} = \\begin{bmatrix}1\\times 10^{-4}  0\\\\ 0  0.5\\times 10^{-4}\\end{bmatrix}\\,\\mathrm{s^{-1}}$, $\\rho = 12500\\,\\mathrm{kg/m^3}$, $\\dot{\\psi} = 0.992\\,\\mathrm{J/(kg\\cdot s)}$, $s = 1000\\,\\mathrm{J/(kg\\cdot K)}$, $\\dot{T} = 0\\,\\mathrm{K/s}$, $\\mathbf{q} = \\begin{bmatrix}500\\\\ 500\\end{bmatrix}\\,\\mathrm{W/m^2}$, $\\nabla T = \\begin{bmatrix}5\\\\ 5\\end{bmatrix}\\,\\mathrm{K/m}$, $T = 350\\,\\mathrm{K}$.\n- Element $4$:\n  - Quadrature point $1$: $\\boldsymbol{\\sigma} = \\begin{bmatrix}100\\times 10^6  0\\\\ 0  50\\times 10^6\\end{bmatrix}\\,\\mathrm{Pa}$, $\\mathbf{d} = \\begin{bmatrix}1\\times 10^{-4}  0\\\\ 0  0.5\\times 10^{-4}\\end{bmatrix}\\,\\mathrm{s^{-1}}$, $\\rho = 12500\\,\\mathrm{kg/m^3}$, $\\dot{\\psi} = 1\\,\\mathrm{J/(kg\\cdot s)}$, $s = 1000\\,\\mathrm{J/(kg\\cdot K)}$, $\\dot{T} = 0\\,\\mathrm{K/s}$, $\\mathbf{q} = \\begin{bmatrix}-1000\\\\ 0\\end{bmatrix}\\,\\mathrm{W/m^2}$, $\\nabla T = \\begin{bmatrix}100\\\\ 0\\end{bmatrix}\\,\\mathrm{K/m}$, $T = 1\\,\\mathrm{K}$.\n  - Quadrature point $2$: $\\boldsymbol{\\sigma} = \\begin{bmatrix}100\\times 10^6  0\\\\ 0  50\\times 10^6\\end{bmatrix}\\,\\mathrm{Pa}$, $\\mathbf{d} = \\begin{bmatrix}1\\times 10^{-4}  0\\\\ 0  0.5\\times 10^{-4}\\end{bmatrix}\\,\\mathrm{s^{-1}}$, $\\rho = 12500\\,\\mathrm{kg/m^3}$, $\\dot{\\psi} = 1\\,\\mathrm{J/(kg\\cdot s)}$, $s = 1000\\,\\mathrm{J/(kg\\cdot K)}$, $\\dot{T} = 0\\,\\mathrm{K/s}$, $\\mathbf{q} = \\begin{bmatrix}-200\\\\ -300\\end{bmatrix}\\,\\mathrm{W/m^2}$, $\\nabla T = \\begin{bmatrix}2\\\\ 3\\end{bmatrix}\\,\\mathrm{K/m}$, $T = 300\\,\\mathrm{K}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., `[result_1,result_2,result_3,result_4]`), where each result is a boolean indicating whether the element satisfies the inequality $\\mathcal{D}_i \\ge 0$ at all its quadrature points, using the tolerance specified above. No other output should be printed.",
            "solution": "The user wants me to solve a problem in the field of computational solid mechanics, specifically concerning the Clausius-Duhem inequality and local dissipation.\n\nHere's my plan:\n1.  **Validate the problem statement:**\n    *   **Step 1: Extract Givens:** I will list all the provided equations, definitions, constants, and the test suite data verbatim.\n    *   **Step 2: Validate:** I will check if the problem is scientifically grounded, well-posed, and objective.\n        *   **Scientific Grounding:** The problem is based on the first and second laws of thermodynamics, the definition of Helmholtz free energy, and concepts from continuum mechanics. These are standard and well-established principles. The derivation of the Clausius-Duhem inequality is a classic exercise in this field. The units seem consistent.\n        *   **Well-Posedness:** The problem asks for a specific derivation and then a numerical implementation based on that derivation. It provides all necessary data for the calculations. The output format is explicitly defined. The task is to check a condition, which has a clear yes/no answer (or boolean). This looks well-posed.\n        *   **Objectivity:** The language is formal and precise. The data is numerical. There are no subjective or opinion-based statements.\n    *   **Step 3: Verdict:** Based on the validation, the problem appears to be valid.\n\n2.  **Solve the problem (if valid):**\n    *   **Part 1: Derivation:** I need to derive the expression for the local dissipation density, $\\mathcal{D}$.\n        *   Start with the local form of the first law of thermodynamics (energy balance). The problem statement describes it as relating mechanical power, heat flux divergence, and internal energy rate. In continuum mechanics, this is typically written as:\n            $$ \\rho \\dot{e} = \\boldsymbol{\\sigma} : \\mathbf{d} - \\nabla \\cdot \\mathbf{q} + \\rho r $$\n            where $r$ is an internal heat source per unit mass. The problem statement does not mention $r$, so I'll assume it is zero or implicitly included in the heat flux term definition. Let's re-read the problem... it mentions \"heat supply contributions\" in the entropy inequality part, which could be $r$. However, no value for $r$ is given in the test suite. So I'll assume $r=0$. The statement is \"relating mechanical power, heat flux divergence, and internal energy rate\". This implies:\n            $$ \\rho \\dot{e} = \\boldsymbol{\\sigma} : \\mathbf{d} - \\nabla \\cdot \\mathbf{q} $$\n            Here $\\boldsymbol{\\sigma} : \\mathbf{d}$ is the stress power per unit volume.\n\n        *   Next, the local form of the second law (entropy inequality), also known as the Clausius-Duhem inequality. It's described as \"stating that the material time rate of entropy is bounded from below by the entropy flux and heat supply contributions\". This is usually written as:\n            $$ \\rho \\dot{s} \\ge - \\nabla \\cdot \\left(\\frac{\\mathbf{q}}{T}\\right) + \\frac{\\rho r}{T} $$\n            Again, assuming $r=0$:\n            $$ \\rho \\dot{s} \\ge - \\nabla \\cdot \\left(\\frac{\\mathbf{q}}{T}\\right) $$\n            Let's expand the divergence term:\n            $$ \\nabla \\cdot \\left(\\frac{\\mathbf{q}}{T}\\right) = \\frac{1}{T} (\\nabla \\cdot \\mathbf{q}) - \\frac{1}{T^2} (\\mathbf{q} \\cdot \\nabla T) $$\n            Substituting this back into the entropy inequality:\n            $$ \\rho \\dot{s} \\ge - \\frac{1}{T}(\\nabla \\cdot \\mathbf{q}) + \\frac{1}{T^2}(\\mathbf{q} \\cdot \\nabla T) $$\n            Multiplying by $T$ (since $T  0$):\n            $$ \\rho T \\dot{s} \\ge - (\\nabla \\cdot \\mathbf{q}) + \\frac{1}{T}(\\mathbf{q} \\cdot \\nabla T) $$\n\n        *   Now, use the definition of Helmholtz free energy per unit mass: $\\psi = e - T s$.\n            I need its material time derivative, $\\dot{\\psi}$. Using the product rule:\n            $$ \\dot{\\psi} = \\dot{e} - \\dot{T}s - T\\dot{s} $$\n            Rearranging this gives an expression for $\\dot{e}$:\n            $$ \\dot{e} = \\dot{\\psi} + \\dot{T}s + T\\dot{s} $$\n\n        *   Substitute this expression for $\\dot{e}$ into the first law:\n            $$ \\rho (\\dot{\\psi} + \\dot{T}s + T\\dot{s}) = \\boldsymbol{\\sigma} : \\mathbf{d} - \\nabla \\cdot \\mathbf{q} $$\n            Now, rearrange to isolate the term $\\rho T \\dot{s}$:\n            $$ \\rho T \\dot{s} = \\boldsymbol{\\sigma} : \\mathbf{d} - \\nabla \\cdot \\mathbf{q} - \\rho \\dot{\\psi} - \\rho s \\dot{T} $$\n\n        *   Now I have two expressions/inequalities involving $\\rho T \\dot{s}$. Let's substitute the one from the energy balance into the entropy inequality:\n            $$ \\underbrace{\\boldsymbol{\\sigma} : \\mathbf{d} - \\nabla \\cdot \\mathbf{q} - \\rho \\dot{\\psi} - \\rho s \\dot{T}}_{\\rho T \\dot{s}} \\ge - (\\nabla \\cdot \\mathbf{q}) + \\frac{1}{T}(\\mathbf{q} \\cdot \\nabla T) $$\n            The term $- \\nabla \\cdot \\mathbf{q}$ cancels out on both sides.\n            $$ \\boldsymbol{\\sigma} : \\mathbf{d} - \\rho \\dot{\\psi} - \\rho s \\dot{T} \\ge \\frac{1}{T}(\\mathbf{q} \\cdot \\nabla T) $$\n            This is the reduced dissipation inequality. The term on the left represents the dissipation due to mechanical work and changes in stored energy, while the term on the right is related to thermal dissipation.\n\n        *   The problem asks for the *local dissipation density* $\\mathcal{D}$. The Clausius-Duhem inequality is often expressed as $\\mathcal{D} \\ge 0$. So I need to rearrange the inequality into this form.\n            $$ \\mathcal{D} = \\boldsymbol{\\sigma} : \\mathbf{d} - \\rho \\dot{\\psi} - \\rho s \\dot{T} - \\frac{1}{T}(\\mathbf{q} \\cdot \\nabla T) \\ge 0 $$\n            Let's re-read the problem statement to see if this matches the interpretation. \"an expression for the local dissipation density $\\mathcal{D}$ at a material point, in terms of the Cauchy stress tensor $\\boldsymbol{\\sigma}$, the symmetric rate of deformation tensor $\\mathbf{d}$, the mass density $\\rho$, the material time derivative of Helmholtz free energy per unit mass $\\dot{\\psi}$, specific entropy $s$, temperature time rate $\\dot{T}$, the heat flux vector $\\mathbf{q}$, the temperature gradient $\\nabla T$, and the absolute temperature $T$.\"\n            The derived expression has all these terms. The inequality is $\\mathcal{D} \\ge 0$.\n\n        *   Let's double-check the derivation.\n            1.  Energy balance: $\\rho \\dot{e} = \\boldsymbol{\\sigma} : \\mathbf{d} - \\nabla \\cdot \\mathbf{q}$\n            2.  Entropy inequality: $\\rho \\dot{s} - \\frac{\\rho r}{T} + \\nabla \\cdot (\\frac{\\mathbf{q}}{T}) \\ge 0$. With $r=0$, this is $\\rho \\dot{s} + \\nabla \\cdot (\\frac{\\mathbf{q}}{T}) \\ge 0$.\n            3.  $\\nabla \\cdot (\\frac{\\mathbf{q}}{T}) = \\frac{1}{T} \\nabla \\cdot \\mathbf{q} - \\frac{1}{T^2} \\mathbf{q} \\cdot \\nabla T$.\n            4.  So $\\rho \\dot{s} + \\frac{1}{T} \\nabla \\cdot \\mathbf{q} - \\frac{1}{T^2} \\mathbf{q} \\cdot \\nabla T \\ge 0$.\n            5.  Helmholtz free energy: $\\psi = e - Ts \\implies \\dot{\\psi} = \\dot{e} - \\dot{T}s - T\\dot{s}$.\n            6.  From (5), $\\dot{e} = \\dot{\\psi} + \\dot{T}s + T\\dot{s}$.\n            7.  Substitute $\\dot{e}$ into (1): $\\rho(\\dot{\\psi} + \\dot{T}s + T\\dot{s}) = \\boldsymbol{\\sigma} : \\mathbf{d} - \\nabla \\cdot \\mathbf{q}$.\n            8.  From (7), solve for $\\nabla \\cdot \\mathbf{q}$: $\\nabla \\cdot \\mathbf{q} = \\boldsymbol{\\sigma} : \\mathbf{d} - \\rho\\dot{\\psi} - \\rho\\dot{T}s - \\rho T\\dot{s}$.\n            9.  Substitute this $\\nabla \\cdot \\mathbf{q}$ into the entropy inequality (4):\n                $\\rho \\dot{s} + \\frac{1}{T} (\\boldsymbol{\\sigma} : \\mathbf{d} - \\rho\\dot{\\psi} - \\rho\\dot{T}s - \\rho T\\dot{s}) - \\frac{1}{T^2} \\mathbf{q} \\cdot \\nabla T \\ge 0$.\n            10. Simplify: $\\rho \\dot{s} + \\frac{1}{T}(\\boldsymbol{\\sigma} : \\mathbf{d}) - \\frac{\\rho}{T}\\dot{\\psi} - \\frac{\\rho}{T}\\dot{T}s - \\rho\\dot{s} - \\frac{1}{T^2} \\mathbf{q} \\cdot \\nabla T \\ge 0$.\n            11. The $\\rho\\dot{s}$ terms cancel out.\n                $\\frac{1}{T}(\\boldsymbol{\\sigma} : \\mathbf{d}) - \\frac{\\rho}{T}\\dot{\\psi} - \\frac{\\rho}{T}\\dot{T}s - \\frac{1}{T^2} \\mathbf{q} \\cdot \\nabla T \\ge 0$.\n            12. Multiply by $T$ (since $T  0$):\n                $\\boldsymbol{\\sigma} : \\mathbf{d} - \\rho\\dot{\\psi} - \\rho s\\dot{T} - \\frac{1}{T} \\mathbf{q} \\cdot \\nabla T \\ge 0$.\n\n        *   This confirms my derived expression for the dissipation density:\n            $$ \\mathcal{D} = \\boldsymbol{\\sigma} : \\mathbf{d} - \\rho \\dot{\\psi} - \\rho s \\dot{T} - \\frac{\\mathbf{q} \\cdot \\nabla T}{T} $$\n            Let's check units.\n            - $\\boldsymbol{\\sigma} : \\mathbf{d}$: $(\\mathrm{N/m^2}) \\cdot (\\mathrm{s^{-1}}) = (\\mathrm{J/m^3}) \\cdot (\\mathrm{s^{-1}}) = \\mathrm{W/m^3}$. Correct.\n            - $\\rho \\dot{\\psi}$: $(\\mathrm{kg/m^3}) \\cdot (\\mathrm{J/(kg\\cdot s)}) = \\mathrm{J/(m^3 \\cdot s)} = \\mathrm{W/m^3}$. Correct.\n            - $\\rho s \\dot{T}$: $(\\mathrm{kg/m^3}) \\cdot (\\mathrm{J/(kg\\cdot K)}) \\cdot (\\mathrm{K/s}) = \\mathrm{J/(m^3 \\cdot s)} = \\mathrm{W/m^3}$. Correct.\n            - $\\frac{\\mathbf{q} \\cdot \\nabla T}{T}$: $\\frac{(\\mathrm{W/m^2}) \\cdot (\\mathrm{K/m})}{\\mathrm{K}} = \\mathrm{W/m^3}$. Correct.\n            All terms have units of power density ($\\mathrm{W/m^3}$), as required. The derivation is sound.\n\n    *   **Part 2: Implementation:** Now I need to implement the calculation for each test case.\n        *   The algorithm is straightforward:\n            1.  For each quadrature point in an element:\n                a. Calculate the stress power term: $P_{\\text{mech}} = \\boldsymbol{\\sigma} : \\mathbf{d}$\n                b. Calculate the free energy rate term: $P_{\\psi} = \\rho \\dot{\\psi}$\n                c. Calculate the thermal-entropy term: $P_{sT} = \\rho s \\dot{T}$\n                d. Calculate the heat conduction term: $P_q = \\frac{\\mathbf{q} \\cdot \\nabla T}{T}$\n                e. Calculate the dissipation density: $\\mathcal{D} = P_{\\text{mech}} - P_{\\psi} - P_{sT} - P_q$\n            2.  For each element, check if $\\mathcal{D}_i \\ge -\\epsilon$ for all its quadrature points $i$. If this holds for all points, the element is valid (True). Otherwise, it's invalid (False).\n            - The tolerance is $\\epsilon = 10^{-12}\\,\\mathrm{W/m^3}$.\n\n        *   **Calculations for the Test Suite:**\n            - **Element 1, QP 1:**\n                - $\\boldsymbol{\\sigma} : \\mathbf{d} = (10^8)(10^{-4}) + (5\\times 10^7)(0.5\\times 10^{-4}) = 10^4 + 2.5\\times 10^3 = 12500$ W/m$^3$.\n                - $\\rho \\dot{\\psi} = 12500 \\times 1 = 12500$ W/m$^3$.\n                - $\\rho s \\dot{T} = 0$.\n                - $\\mathbf{q} \\cdot \\nabla T = (-1000)(10) + (0)(0) = -10000$ W/m$^2 \\cdot$ K/m.\n                - $\\frac{\\mathbf{q} \\cdot \\nabla T}{T} = \\frac{-10000}{300} = -100/3 \\approx -33.333$ W/m$^3$.\n                - $\\mathcal{D}_1 = 12500 - 12500 - 0 - (-33.333) = 33.333...$ W/m$^3$.\n                - $\\mathcal{D}_1 \\ge -10^{-12}$? Yes.\n\n            - **Element 1, QP 2:**\n                - $\\boldsymbol{\\sigma} : \\mathbf{d}$ is the same as QP1: $12500$ W/m$^3$.\n                - $\\rho \\dot{\\psi}$ is the same: $12500$ W/m$^3$.\n                - $\\rho s \\dot{T}$ is the same: $0$.\n                - $\\mathbf{q} \\cdot \\nabla T = (-500)(5) + (-500)(5) = -2500 - 2500 = -5000$.\n                - $\\frac{\\mathbf{q} \\cdot \\nabla T}{T} = \\frac{-5000}{350} = -100/7 \\approx -14.286$ W/m$^3$.\n                - $\\mathcal{D}_2 = 12500 - 12500 - 0 - (-14.286) = 14.286...$ W/m$^3$.\n                - $\\mathcal{D}_2 \\ge -10^{-12}$? Yes.\n                - **Element 1 Verdict:** Both QPs are valid. So Element 1 is **True**.\n\n            - **Element 2, QP 1:**\n                - Same as Element 1, QP 1. $\\mathcal{D}_1 = 33.333... \\ge 0$. Valid.\n\n            - **Element 2, QP 2:**\n                - $\\boldsymbol{\\sigma} : \\mathbf{d} = 12500$ W/m$^3$.\n                - $\\rho \\dot{\\psi} = 12500$ W/m$^3$.\n                - $\\rho s \\dot{T} = 0$.\n                - $\\mathbf{q} \\cdot \\nabla T = (500)(5) + (500)(5) = 2500 + 2500 = 5000$.\n                - $\\frac{\\mathbf{q} \\cdot \\nabla T}{T} = \\frac{5000}{350} = 100/7 \\approx 14.286$ W/m$^3$.\n                - $\\mathcal{D}_2 = 12500 - 12500 - 0 - (14.286) = -14.286...$ W/m$^3$.\n                - $\\mathcal{D}_2 \\ge -10^{-12}$? No, $-14.286$ is much less. Invalid.\n                - **Element 2 Verdict:** One QP is invalid. So Element 2 is **False**.\n\n            - **Element 3, QP 1:**\n                - $\\boldsymbol{\\sigma} : \\mathbf{d} = 12500$ W/m$^3$.\n                - $\\rho \\dot{\\psi} = 12500 \\times 0.992 = 12400$ W/m$^3$.\n                - $\\rho s \\dot{T} = 0$.\n                - $\\frac{\\mathbf{q} \\cdot \\nabla T}{T}$ is the same as E1, QP1: $-100/3 \\approx -33.333$ W/m$^3$.\n                - $\\mathcal{D}_1 = 12500 - 12400 - 0 - (-33.333) = 100 + 33.333 = 133.333...$ W/m$^3$.\n                - $\\mathcal{D}_1 \\ge -10^{-12}$? Yes.\n\n            - **Element 3, QP 2:**\n                - $\\boldsymbol{\\sigma} : \\mathbf{d} = 12500$ W/m$^3$.\n                - $\\rho \\dot{\\psi} = 12400$ W/m$^3$.\n                - $\\rho s \\dot{T} = 0$.\n                - $\\mathbf{q} = \\begin{bmatrix}500\\\\ 500\\end{bmatrix}$, $\\nabla T = \\begin{bmatrix}5\\\\ 5\\end{bmatrix}$, $T = 350$.\n                - $\\frac{\\mathbf{q} \\cdot \\nabla T}{T}$ is the same as E2, QP2: $100/7 \\approx 14.286$ W/m$^3$.\n                - $\\mathcal{D}_2 = 12500 - 12400 - 0 - (14.286) = 100 - 14.286 = 85.714...$ W/m$^3$.\n                - $\\mathcal{D}_2 \\ge -10^{-12}$? Yes.\n                - **Element 3 Verdict:** Both QPs are valid. So Element 3 is **True**.\n\n            - **Element 4, QP 1:**\n                - $\\boldsymbol{\\sigma} : \\mathbf{d} = 12500$ W/m$^3$.\n                - $\\rho \\dot{\\psi} = 12500$ W/m$^3$.\n                - $\\rho s \\dot{T} = 0$.\n                - $\\mathbf{q} = \\begin{bmatrix}-1000\\\\ 0\\end{bmatrix}$, $\\nabla T = \\begin{bmatrix}100\\\\ 0\\end{bmatrix}$, $T = 1$.\n                - $\\mathbf{q} \\cdot \\nabla T = (-1000)(100) + (0)(0) = -100000$.\n                - $\\frac{\\mathbf{q} \\cdot \\nabla T}{T} = \\frac{-100000}{1} = -100000$ W/m$^3$.\n                - $\\mathcal{D}_1 = 12500 - 12500 - 0 - (-100000) = 100000$ W/m$^3$.\n                - $\\mathcal{D}_1 \\ge -10^{-12}$? Yes.\n\n            - **Element 4, QP 2:**\n                - $\\boldsymbol{\\sigma} : \\mathbf{d} = 12500$ W/m$^3$.\n                - $\\rho \\dot{\\psi} = 12500$ W/m$^3$.\n                - $\\rho s \\dot{T} = 0$.\n                - $\\mathbf{q} = \\begin{bmatrix}-200\\\\ -300\\end{bmatrix}$, $\\nabla T = \\begin{bmatrix}2\\\\ 3\\end{bmatrix}$, $T = 300$.\n                - $\\mathbf{q} \\cdot \\nabla T = (-200)(2) + (-300)(3) = -400 - 900 = -1300$.\n                - $\\frac{\\mathbf{q} \\cdot \\nabla T}{T} = \\frac{-1300}{300} = -13/3 \\approx -4.333$ W/m$^3$.\n                - $\\mathcal{D}_2 = 12500 - 12500 - 0 - (-4.333) = 4.333...$ W/m$^3$.\n                - $\\mathcal{D}_2 \\ge -10^{-12}$? Yes.\n                - **Element 4 Verdict:** Both QPs are valid. So Element 4 is **True**.\n\n        *   **Summary of results:**\n            - Element 1: True\n            - Element 2: False\n            - Element 3: True\n            - Element 4: True\n            - Final output should be `[True,False,True,True]`.\n\nThe problem statement is scientifically valid, well-posed, and objective. It is grounded in the fundamental principles of continuum mechanics and thermodynamics, specifically the first and second laws. All necessary data, definitions, and conditions are provided, and there are no internal contradictions. The task is clearly defined and leads to a unique, verifiable solution.\n\nThe core of the problem is to derive and apply the Clausius-Duhem inequality to check for violations of the second law of thermodynamics at discrete points within a numerical simulation. The inequality, in its local form, ensures that the rate of entropy production is non-negative.\n\n### Derivation of the Local Dissipation Density\n\nWe begin with the fundamental laws as provided:\n\n1.  **Local form of the first law of thermodynamics (Balance of Energy):** This law relates the rate of change of specific internal energy, $\\dot{e}$, to the stress power (mechanical work rate) and the heat flux. Assuming no internal heat sources, it is given by:\n    $$ \\rho \\dot{e} = \\boldsymbol{\\sigma} : \\mathbf{d} - \\nabla \\cdot \\mathbf{q} $$\n    where $\\rho$ is the mass density, $\\boldsymbol{\\sigma}$ is the Cauchy stress tensor, $\\mathbf{d}$ is the symmetric rate of deformation tensor, and $\\mathbf{q}$ is the heat flux vector. The double-dot product $\\boldsymbol{\\sigma} : \\mathbf{d}$ represents the power per unit volume generated by the stresses.\n\n2.  **Local form of the second law of thermodynamics (Entropy Inequality):** This law states that the rate of entropy production must be non-negative. It relates the material time rate of specific entropy, $\\dot{s}$, to the entropy flux. Assuming no internal heat sources, it is:\n    $$ \\rho \\dot{s} \\ge - \\nabla \\cdot \\left(\\frac{\\mathbf{q}}{T}\\right) $$\n    where $T$ is the absolute temperature. Using the product rule for the divergence operator, $\\nabla \\cdot (\\mathbf{v}/\\phi) = (\\nabla \\cdot \\mathbf{v})/\\phi - (\\mathbf{v} \\cdot \\nabla \\phi)/\\phi^2$, we can expand the right-hand side:\n    $$ \\rho \\dot{s} \\ge -\\frac{1}{T}(\\nabla \\cdot \\mathbf{q}) + \\frac{1}{T^2}(\\mathbf{q} \\cdot \\nabla T) $$\n\n3.  **Helmholtz Free Energy:** The specific Helmholtz free energy, $\\psi$, is defined as:\n    $$ \\psi = e - T s $$\n    Its material time derivative, $\\dot{\\psi}$, is found using the product rule:\n    $$ \\dot{\\psi} = \\dot{e} - \\dot{T}s - T\\dot{s} $$\n\nThe objective is to combine these three statements to arrive at an inequality for the local dissipation density, $\\mathcal{D}$. The procedure is as follows:\n\nFirst, we rearrange the Helmholtz free energy rate equation to express $\\dot{e}$:\n$$ \\dot{e} = \\dot{\\psi} + \\dot{T}s + T\\dot{s} $$\nSubstitute this into the first law of thermodynamics:\n$$ \\rho (\\dot{\\psi} + \\dot{T}s + T\\dot{s}) = \\boldsymbol{\\sigma} : \\mathbf{d} - \\nabla \\cdot \\mathbf{q} $$\nThis equation can be solved for the term $\\nabla \\cdot \\mathbf{q}$:\n$$ \\nabla \\cdot \\mathbf{q} = \\boldsymbol{\\sigma} : \\mathbf{d} - \\rho\\dot{\\psi} - \\rho s\\dot{T} - \\rho T\\dot{s} $$\n\nNext, we substitute this expression for $\\nabla \\cdot \\mathbf{q}$ into the expanded entropy inequality:\n$$ \\rho \\dot{s} \\ge -\\frac{1}{T}(\\boldsymbol{\\sigma} : \\mathbf{d} - \\rho\\dot{\\psi} - \\rho s\\dot{T} - \\rho T\\dot{s}) + \\frac{1}{T^2}(\\mathbf{q} \\cdot \\nabla T) $$\nDistributing the $-1/T$ term:\n$$ \\rho \\dot{s} \\ge -\\frac{1}{T}(\\boldsymbol{\\sigma} : \\mathbf{d}) + \\frac{\\rho\\dot{\\psi}}{T} + \\frac{\\rho s\\dot{T}}{T} + \\rho \\dot{s} + \\frac{1}{T^2}(\\mathbf{q} \\cdot \\nabla T) $$\nThe term $\\rho\\dot{s}$ appears on both sides and cancels out:\n$$ 0 \\ge -\\frac{1}{T}(\\boldsymbol{\\sigma} : \\mathbf{d}) + \\frac{\\rho\\dot{\\psi}}{T} + \\frac{\\rho s\\dot{T}}{T} + \\frac{1}{T^2}(\\mathbf{q} \\cdot \\nabla T) $$\nTo clear the denominators and simplify, we multiply the entire inequality by the absolute temperature $T$, which is strictly positive ($T  0$):\n$$ 0 \\ge -(\\boldsymbol{\\sigma} : \\mathbf{d}) + \\rho\\dot{\\psi} + \\rho s\\dot{T} + \\frac{1}{T}(\\mathbf{q} \\cdot \\nabla T) $$\nRearranging to express a non-negative quantity, we get the final form of the Clausius-Duhem inequality, which defines the local dissipation density $\\mathcal{D}$:\n$$ \\mathcal{D} = \\boldsymbol{\\sigma} : \\mathbf{d} - \\rho \\dot{\\psi} - \\rho s \\dot{T} - \\frac{\\mathbf{q} \\cdot \\nabla T}{T} \\ge 0 $$\nThis equation represents the rate of energy dissipation per unit volume. It is composed of the mechanical power not stored as free energy ($\\boldsymbol{\\sigma} : \\mathbf{d} - \\rho \\dot{\\psi} - \\rho s \\dot{T}$) and the dissipation due to heat conduction down a temperature gradient ($-\\frac{\\mathbf{q} \\cdot \\nabla T}{T}$). The second law of thermodynamics requires that this total dissipation be non-negative.\n\n### Algorithm Implementation\n\nFor each quadrature point $i$ in a given finite element, we compute the local dissipation density $\\mathcal{D}_i$ using the derived formula. An element is considered thermodynamically valid if and only if $\\mathcal{D}_i \\ge -\\epsilon$ for all its quadrature points, where $\\epsilon = 10^{-12}\\,\\mathrm{W/m^3}$ is a specified numerical tolerance to account for floating-point inaccuracies.\n\nFor the given two-dimensional problem, the tensor and vector operations are:\n-   Double-dot product: $\\boldsymbol{\\sigma} : \\mathbf{d} = \\sum_{j=1}^2 \\sum_{k=1}^2 \\sigma_{jk} d_{kj}$.\n-   Dot product: $\\mathbf{q} \\cdot \\nabla T = \\sum_{j=1}^2 q_j (\\nabla T)_j$.\n\nThese operations are applied to the data provided in the test suite for each quadrature point to determine the validity of each element. The final result is a list of booleans.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem by calculating the local dissipation density at quadrature points\n    for several finite elements and checking for violations of the second law of thermodynamics.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each element is a list of dictionaries, where each dictionary holds the data for one quadrature point.\n    test_cases = [\n        # Element 1\n        [\n            {\n                \"sigma\": np.array([[100e6, 0], [0, 50e6]]),\n                \"d\": np.array([[1e-4, 0], [0, 0.5e-4]]),\n                \"rho\": 12500, \"psi_dot\": 1.0, \"s\": 1000, \"T_dot\": 0.0,\n                \"q\": np.array([-1000, 0]), \"grad_T\": np.array([10, 0]), \"T\": 300\n            },\n            {\n                \"sigma\": np.array([[100e6, 0], [0, 50e6]]),\n                \"d\": np.array([[1e-4, 0], [0, 0.5e-4]]),\n                \"rho\": 12500, \"psi_dot\": 1.0, \"s\": 1000, \"T_dot\": 0.0,\n                \"q\": np.array([-500, -500]), \"grad_T\": np.array([5, 5]), \"T\": 350\n            }\n        ],\n        # Element 2\n        [\n            { # Same as Element 1, QP 1\n                \"sigma\": np.array([[100e6, 0], [0, 50e6]]),\n                \"d\": np.array([[1e-4, 0], [0, 0.5e-4]]),\n                \"rho\": 12500, \"psi_dot\": 1.0, \"s\": 1000, \"T_dot\": 0.0,\n                \"q\": np.array([-1000, 0]), \"grad_T\": np.array([10, 0]), \"T\": 300\n            },\n            { # Different heat flux\n                \"sigma\": np.array([[100e6, 0], [0, 50e6]]),\n                \"d\": np.array([[1e-4, 0], [0, 0.5e-4]]),\n                \"rho\": 12500, \"psi_dot\": 1.0, \"s\": 1000, \"T_dot\": 0.0,\n                \"q\": np.array([500, 500]), \"grad_T\": np.array([5, 5]), \"T\": 350\n            }\n        ],\n        # Element 3\n        [\n            { # Different psi_dot\n                \"sigma\": np.array([[100e6, 0], [0, 50e6]]),\n                \"d\": np.array([[1e-4, 0], [0, 0.5e-4]]),\n                \"rho\": 12500, \"psi_dot\": 0.992, \"s\": 1000, \"T_dot\": 0.0,\n                \"q\": np.array([-1000, 0]), \"grad_T\": np.array([10, 0]), \"T\": 300\n            },\n            { # Different psi_dot and q\n                \"sigma\": np.array([[100e6, 0], [0, 50e6]]),\n                \"d\": np.array([[1e-4, 0], [0, 0.5e-4]]),\n                \"rho\": 12500, \"psi_dot\": 0.992, \"s\": 1000, \"T_dot\": 0.0,\n                \"q\": np.array([500, 500]), \"grad_T\": np.array([5, 5]), \"T\": 350\n            }\n        ],\n        # Element 4\n        [\n            { # Different grad_T and T\n                \"sigma\": np.array([[100e6, 0], [0, 50e6]]),\n                \"d\": np.array([[1e-4, 0], [0, 0.5e-4]]),\n                \"rho\": 12500, \"psi_dot\": 1.0, \"s\": 1000, \"T_dot\": 0.0,\n                \"q\": np.array([-1000, 0]), \"grad_T\": np.array([100, 0]), \"T\": 1.0\n            },\n            { # Different q and grad_T\n                \"sigma\": np.array([[100e6, 0], [0, 50e6]]),\n                \"d\": np.array([[1e-4, 0], [0, 0.5e-4]]),\n                \"rho\": 12500, \"psi_dot\": 1.0, \"s\": 1000, \"T_dot\": 0.0,\n                \"q\": np.array([-200, -300]), \"grad_T\": np.array([2, 3]), \"T\": 300\n            }\n        ]\n    ]\n\n    tolerance = 1e-12\n    results = []\n\n    for element_qps in test_cases:\n        is_element_valid = True\n        for qp_data in element_qps:\n            # Extract data for the current quadrature point\n            sigma = qp_data[\"sigma\"]\n            d = qp_data[\"d\"]\n            rho = qp_data[\"rho\"]\n            psi_dot = qp_data[\"psi_dot\"]\n            s = qp_data[\"s\"]\n            T_dot = qp_data[\"T_dot\"]\n            q = qp_data[\"q\"]\n            grad_T = qp_data[\"grad_T\"]\n            T = qp_data[\"T\"]\n            \n            # 1. Calculate the stress power per unit volume: sigma:d\n            # For symmetric tensors, this is sum of element-wise product.\n            stress_power = np.sum(sigma * d)\n\n            # 2. Calculate the rate of change of Helmholtz free energy per unit volume\n            rho_psi_dot = rho * psi_dot\n\n            # 3. Calculate the thermal-entropy term\n            rho_s_T_dot = rho * s * T_dot\n\n            # 4. Calculate the dissipation due to heat conduction\n            # Absolute temperature T must be  0.\n            if T = 0:\n                # This case would be physically invalid, but for robustness we handle it.\n                # A very large negative dissipation would flag the element as invalid.\n                thermal_dissipation = -np.inf\n            else:\n                thermal_dissipation = np.dot(q, grad_T) / T\n\n            # 5. Compute the total local dissipation density D\n            # D = (sigma:d) - rho*psi_dot - rho*s*T_dot - (q.grad_T)/T\n            dissipation_density = stress_power - rho_psi_dot - rho_s_T_dot - thermal_dissipation\n            \n            # 6. Check if the non-negativity condition is violated\n            if dissipation_density  -tolerance:\n                is_element_valid = False\n                break  # If one QP is invalid, the whole element is invalid\n\n        results.append(is_element_valid)\n        \n    # Format the final list of booleans as a string\n    # Python's True/False maps to JSON's true/false, which is fine, but the problem\n    # shows True/False with capital letters. str() in Python does this correctly.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}