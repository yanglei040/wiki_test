{
    "hands_on_practices": [
        {
            "introduction": "克劳修斯-杜亥姆不等式为材料的本构行为提供了基本的热力学约束。我们的第一个实践将回归基础，在一个简化的理想化情景下推导该不等式，从而清晰地分离出机械耗散的概念。通过这个练习，你将理解对材料所做的功是如何被分配为可恢复的存储能和不可逆的耗散能的。",
            "id": "3562449",
            "problem": "考虑一个连续体，在恒定绝对温度 $T$ 下经历一个均匀、等温的过程，其中体力可忽略不计，无体积热源，热通量为零。设局部运动学由速度梯度 $\\mathbf{L}$ 描述，其对称部分为 $\\mathbf{d} = \\frac{1}{2}(\\mathbf{L} + \\mathbf{L}^{\\mathsf{T}})$，局部应力为柯西应力张量 $\\boldsymbol{\\sigma}$。假设在某物质点，张量 $\\boldsymbol{\\sigma}$ 和 $\\mathbf{d}$ 共享一个共同的主基且为对角张量，即 $\\boldsymbol{\\sigma} = \\mathrm{diag}(\\sigma_1,\\sigma_2,\\sigma_3)$ 和 $\\mathbf{d} = \\mathrm{diag}(d_1,d_2,d_3)$，其中 $\\sigma_i$ 和 $d_i$ 分别是主应力分量和主变形率。\n\n从能量平衡（热力学第一定律）和热力学第二定律的局部形式（熵不等式）出发，并引入比亥姆霍兹自由能 $\\psi = e - T s$（其中 $e$ 是比内能，$s$ 是比熵），推导在当前的等温、均匀、无热通量条件下克劳修斯-杜亥姆关系的特殊形式，并用 $\\boldsymbol{\\sigma}:\\mathbf{d}$ 和 $\\rho \\dot{\\psi}$ 表示机械耗散密度，其中 $\\rho$ 是质量密度。然后，计算给定对角张量的应力功率 $\\boldsymbol{\\sigma}:\\mathbf{d}$。最后，利用推导出的不等式来解释 $\\boldsymbol{\\sigma}:\\mathbf{d}$ 的符号，说明该过程是在材料内部产生能量（例如，增加储存的自由能或耗散能量）还是消耗能量（例如，材料通过减少储存的自由能对周围环境做净功）。\n\n将最终答案表示为关于 $\\sigma_1$, $\\sigma_2$, $\\sigma_3$, $d_1$, $d_2$, 和 $d_3$ 的单个闭式解析表达式。无需进行数值计算。",
            "solution": "该问题被验证为具有科学依据、适定且客观。这是连续介质热力学中的一个标准推导。所有必要信息均已提供，且在理论力学背景下，所作假设是一致且物理上合理的。该问题是可解的。\n\n我们从热力学第一和第二定律的局部形式开始推导。\n\n热力学第一定律，即能量平衡，其在连续介质中的局部形式由下式给出：\n$$\n\\rho \\dot{e} = \\boldsymbol{\\sigma}:\\mathbf{d} - \\nabla \\cdot \\mathbf{q} + \\rho r\n$$\n其中 $\\rho$ 是质量密度，$\\dot{e}$ 是比内能 $e$ 的物质时间导数，$\\boldsymbol{\\sigma}$ 是柯西应力张量，$\\mathbf{d}$ 是变形率张量（速度梯度 $\\mathbf{L}$ 的对称部分），$\\mathbf{q}$ 是热通量矢量，$r$ 是比热供给率（单位质量的体积热源）。\n\n热力学第二定律，表示为局部熵不等式，为：\n$$\n\\rho \\dot{s} \\ge - \\nabla \\cdot \\left(\\frac{\\mathbf{q}}{T}\\right) + \\frac{\\rho r}{T}\n$$\n其中 $\\dot{s}$ 是比熵 $s$ 的物质时间导数，$T$ 是绝对温度。\n\n问题指定了几个简化条件：\n1.  过程是等温的，所以温度 $T$ 是常数，这意味着 $\\dot{T} = 0$。\n2.  不存在体积热源，所以 $r = 0$。\n3.  热通量为零，所以 $\\mathbf{q} = \\mathbf{0}$。这也意味着其散度为零，即 $\\nabla \\cdot \\mathbf{q} = 0$。\n\n将这些条件应用于能量平衡方程，我们得到：\n$$\n\\rho \\dot{e} = \\boldsymbol{\\sigma}:\\mathbf{d}\n$$\n这表明在这些绝热条件下，内能的变化率等于单位体积的应力功率。\n\n将相同的条件应用于熵不等式，我们发现项 $\\frac{\\rho r}{T}$ 为零，并且由于 $\\mathbf{q} = \\mathbf{0}$ 且 $T$ 在空间上是恒定的（由于过程的均匀性），项 $\\nabla \\cdot \\left(\\frac{\\mathbf{q}}{T}\\right)$ 也为零。不等式简化为：\n$$\n\\rho \\dot{s} \\ge 0\n$$\n\n接下来，我们引入比亥姆霍兹自由能 $\\psi$，其定义为：\n$$\n\\psi = e - T s\n$$\n我们对比亥姆霍兹自由能 $\\psi$ 求物质时间导数：\n$$\n\\dot{\\psi} = \\dot{e} - \\dot{T}s - T \\dot{s}\n$$\n由于过程是等温的，$\\dot{T} = 0$，表达式简化为：\n$$\n\\dot{\\psi} = \\dot{e} - T \\dot{s}\n$$\n这个方程可以重新整理以表示内能变化率 $\\dot{e}$ 或熵产生项 $T\\dot{s}$：\n$$\n\\dot{e} = \\dot{\\psi} + T \\dot{s} \\quad \\text{或} \\quad T \\dot{s} = \\dot{e} - \\dot{\\psi}\n$$\n\n现在，我们将简化的能量平衡方程 $\\rho \\dot{e} = \\boldsymbol{\\sigma}:\\mathbf{d}$ 代入 $T\\dot{s}$ 的表达式中：\n$$\nT \\dot{s} = \\frac{1}{\\rho}(\\boldsymbol{\\sigma}:\\mathbf{d}) - \\dot{\\psi}\n$$\n乘以 $\\rho$，我们得到：\n$$\n\\rho T \\dot{s} = \\boldsymbol{\\sigma}:\\mathbf{d} - \\rho \\dot{\\psi}\n$$\n简化的熵不等式为 $\\rho \\dot{s} \\ge 0$。由于 $T > 0$，这等价于 $\\rho T \\dot{s} \\ge 0$。代入我们关于 $\\rho T \\dot{s}$ 的表达式，就得到了此过程下克劳修斯-杜亥姆关系的特殊形式：\n$$\n\\boldsymbol{\\sigma}:\\mathbf{d} - \\rho \\dot{\\psi} \\ge 0\n$$\n量 $\\mathcal{D}_{\\text{mech}} = \\boldsymbol{\\sigma}:\\mathbf{d} - \\rho \\dot{\\psi}$ 是机械耗散密度。它表示单位体积应力功率 $\\boldsymbol{\\sigma}:\\mathbf{d}$ 中未作为可逆自由能（项 $\\rho \\dot{\\psi}$）储存起来的部分，因此被耗散掉了，在这种情况下转化为熵。该不等式表明此耗散必须为非负。\n\n问题的第二部分要求计算应力功率 $\\boldsymbol{\\sigma}:\\mathbf{d}$。两个二阶张量 $\\mathbf{A}$ 和 $\\mathbf{B}$ 的双点积定义为 $\\mathbf{A}:\\mathbf{B} = \\mathrm{tr}(\\mathbf{A}^{\\mathsf{T}}\\mathbf{B})$。由于 $\\boldsymbol{\\sigma}$ 和 $\\mathbf{d}$ 都是对称的，这可简化为 $\\mathrm{tr}(\\boldsymbol{\\sigma}\\mathbf{d})$。问题指出，在一个共同的主基中，这两个张量是对角的：\n$$\n\\boldsymbol{\\sigma} = \\mathrm{diag}(\\sigma_1, \\sigma_2, \\sigma_3) \\quad \\text{和} \\quad \\mathbf{d} = \\mathrm{diag}(d_1, d_2, d_3)\n$$\n在此基下，矩阵乘积 $\\boldsymbol{\\sigma}\\mathbf{d}$ 也是对角的：\n$$\n\\boldsymbol{\\sigma}\\mathbf{d} = \\begin{pmatrix} \\sigma_1  0  0 \\\\ 0  \\sigma_2  0 \\\\ 0  0  \\sigma_3 \\end{pmatrix} \\begin{pmatrix} d_1  0  0 \\\\ 0  d_2  0 \\\\ 0  0  d_3 \\end{pmatrix} = \\begin{pmatrix} \\sigma_1 d_1  0  0 \\\\ 0  \\sigma_2 d_2  0 \\\\ 0  0  \\sigma_3 d_3 \\end{pmatrix}\n$$\n这个乘积矩阵的迹是其对角元素之和：\n$$\n\\boldsymbol{\\sigma}:\\mathbf{d} = \\mathrm{tr}(\\boldsymbol{\\sigma}\\mathbf{d}) = \\sigma_1 d_1 + \\sigma_2 d_2 + \\sigma_3 d_3\n$$\n这就是应力功率的闭式解析表达式。\n\n最后，我们使用不等式 $\\boldsymbol{\\sigma}:\\mathbf{d} \\ge \\rho \\dot{\\psi}$ 来解释 $\\boldsymbol{\\sigma}:\\mathbf{d}$ 的符号。\n项 $\\boldsymbol{\\sigma}:\\mathbf{d}$ 表示应力*对*材料所做的单位体积功的速率。\n项 $\\rho \\dot{\\psi}$ 表示单位体积内储存的（可恢复的）自由能的增长率。\n- 如果 $\\boldsymbol{\\sigma}:\\mathbf{d} > 0$，则环境对材料做正功。这部分供给的能量被分配为储存自由能的增加（$\\rho \\dot{\\psi}$）和耗散（$\\mathcal{D}_{\\text{mech}} \\ge 0$）。这对应于一个从外部消耗能量，并将其储存或耗散的过程，从而“产生”材料能量含量（储存或耗散的）的增加。\n- 如果 $\\boldsymbol{\\sigma}:\\mathbf{d}  0$，则材料对环境做净功。要发生这种情况，不等式 $\\boldsymbol{\\sigma}:\\mathbf{d} \\ge \\rho \\dot{\\psi}$ 必须成立。这意味着 $\\rho \\dot{\\psi}$ 必须为负。具体来说，$\\rho \\dot{\\psi} \\le \\boldsymbol{\\sigma}:\\mathbf{d}  0$。这意味着材料正在以足够快的速率释放其储存的自由能（$\\dot{\\psi}  0$），以便对环境做功并覆盖任何内部耗散。这对应于一个材料“消耗”自身储存的能量来产生功的过程。",
            "answer": "$$\n\\boxed{\\sigma_1 d_1 + \\sigma_2 d_2 + \\sigma_3 d_3}\n$$"
        },
        {
            "introduction": "在第一个实践建立的基本概念之上，本练习将展示熵不等式如何在更真实的场景中发挥作用。你将运用Coleman-Noll方法，针对一个具体的热-粘弹性模型，推导出耗散密度的显式表达式，并区分其中由机械粘性和热传导引起的耗散贡献。这是确保材料模型热力学一致性的关键一步。",
            "id": "3562420",
            "problem": "考虑一个热力耦合的小应变单轴固体，沿轴向坐标 $x$ 受拉，其温度场为 $T(x,t)$，应变为 $\\varepsilon(x,t)$。假设如下：\n\n- 质量密度为 $\\rho$，杨氏模量为 $E$，线性热膨胀系数为 $\\alpha$，粘性模量为 $\\eta_{v}$，定应变比热为 $c$，热导率为 $k$。所有材料参数均为常数。\n- 单位质量的亥姆霍兹自由能由下式给出\n$$\n\\psi(\\varepsilon,T) = \\frac{E}{2\\rho}\\left(\\varepsilon - \\alpha\\left(T - T_{0}\\right)\\right)^{2} + c\\left(T - T_{0} - T\\ln\\frac{T}{T_{0}}\\right),\n$$\n其中 $T_{0}$ 是一个固定的参考温度，$\\ln$ 表示自然对数。\n- 本构结构为\n$$\n\\sigma = \\rho\\,\\frac{\\partial \\psi}{\\partial \\varepsilon} + \\eta_{v}\\,\\dot{\\varepsilon}, \\qquad q_{x} = -k\\,\\frac{\\partial T}{\\partial x}, \\qquad r = 0,\n$$\n其中 $\\sigma$ 是柯西应力，$q_{x}$ 是轴向热流，$r$ 是体热源。\n- 在时间 $t$ 的一个质点的状态由 $\\varepsilon(t)$、$\\dot{\\varepsilon}(t)$、$T(t)$ 和一个均匀的轴向温度梯度 $\\frac{\\partial T}{\\partial x}(t)$ 描述。\n\n从能量平衡和热力学第二定律（SLT）的局部形式出发，使用亥姆霍兹自由能的定义 $\\psi = u - T\\eta$（其中 $u$ 是单位质量的内能，$\\eta$ 是单位质量的熵），推导适用于此一维背景的克劳修斯-杜亥姆不等式（CDI）。然后，将该不等式具体化到给定的本构结构，并评估上述质点处的瞬时耗散密度 $\\mathcal{D}$。以 $\\eta_{v}$、$k$、$T$、$\\dot{\\varepsilon}$ 和 $\\frac{\\partial T}{\\partial x}$ 的单个闭式解析表达式形式提供您的最终结果，并将最终的耗散密度以瓦特每立方米为单位表示。不要对您的答案进行四舍五入。在您的推导中，指明在克劳修斯-杜亥姆不等式下，机械贡献和热贡献如何在 $\\mathcal{D}$ 中结合。",
            "solution": "首先验证问题，以确保其在科学上是合理的、自洽的且适定的。\n\n### 步骤 1：提取已知条件\n- **系统**：一个热力耦合的小应变单轴固体。\n- **坐标**：轴向坐标 $x$，时间 $t$。\n- **场**：温度 $T(x,t)$，轴向应变 $\\varepsilon(x,t)$。\n- **材料参数**：质量密度 $\\rho$，杨氏模量 $E$，线性热膨胀系数 $\\alpha$，粘性模量 $\\eta_{v}$，定应变比热 $c$，热导率 $k$。所有均为常数。\n- **参考温度**：$T_{0}$。\n- **亥姆霍兹自由能（单位质量）**：\n$$\n\\psi(\\varepsilon,T) = \\frac{E}{2\\rho}\\left(\\varepsilon - \\alpha\\left(T - T_{0}\\right)\\right)^{2} + c\\left(T - T_{0} - T\\ln\\frac{T}{T_{0}}\\right)\n$$\n- **本构结构**：\n  - 柯西应力：$\\sigma = \\rho\\,\\frac{\\partial \\psi}{\\partial \\varepsilon} + \\eta_{v}\\,\\dot{\\varepsilon}$\n  - 轴向热流：$q_{x} = -k\\,\\frac{\\partial T}{\\partial x}$\n  - 体热源：$r = 0$\n- **质点状态变量**：$\\varepsilon(t)$、$\\dot{\\varepsilon}(t)$、$T(t)$、$\\frac{\\partial T}{\\partial x}(t)$。\n- **关系**：亥姆霍兹自由能 $\\psi = u - T\\eta$，其中 $u$ 是单位质量的内能，$\\eta$ 是单位质量的熵。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学基础**：该问题在连续介质力学框架内描述了一个标准的热粘弹性材料模型。亥姆霍兹自由能的形式是热弹性（第一项）与标准热量部分（第二项）的常见组合。应力（一个热弹性部分加上一个线性粘性部分）和热流（傅里叶定律）的本构关系是基础且被广泛使用的。该问题牢固地建立在热力学和固体力学的既定原理之上。\n- **适定性**：该问题要求基于一套完整的给定本构定律，推导一个标准不等式（克劳修斯-杜亥姆不等式）并评估一个导出量（耗散密度）。任务是明确的，并能导出一个唯一的解析解。\n- **客观性**：该问题使用精确、客观和标准的科学术语进行陈述。没有主观或基于观点的内容。\n- **完整性与一致性**：该问题为进行推导提供了所有必要的定义、方程和参数。在连续介质热力学的背景下，给定的方程彼此一致。例如，应力被加性分解为一个从势 $\\psi$ 导出的非耗散部分和一个耗散部分，这与将要使用的科尔曼-诺尔程序是一致的。\n\n### 步骤 3：结论与行动\n该问题是有效的，因为它在科学上是合理的、适定的、客观的、完整的且一致的。我将继续进行推导和求解。\n\n推导从能量平衡的局部形式（热力学第一定律）和热力学第二定律的局部表述（熵不等式）开始。\n\n对于一维连续体，在没有体力和存在体热源 $r$ 的情况下，局部能量平衡由下式给出：\n$$\n\\rho\\,\\dot{u} = \\sigma\\,\\dot{\\varepsilon} - \\frac{\\partial q_{x}}{\\partial x} + \\rho\\,r\n$$\n此处，$\\dot{u}$ 是比内能 $u$ 的物质时间导数，$\\dot{\\varepsilon}$ 是应变 $\\varepsilon$ 的物质时间导数。问题陈述体热源 $r=0$，因此能量平衡简化为：\n$$\n\\rho\\,\\dot{u} = \\sigma\\,\\dot{\\varepsilon} - \\frac{\\partial q_{x}}{\\partial x}\n$$\n热力学第二定律的局部形式是熵不等式，它指出熵产率必须为非负。对于一维系统，这表示为：\n$$\n\\rho\\,\\dot{\\eta} + \\frac{\\partial}{\\partial x}\\left(\\frac{q_{x}}{T}\\right) - \\frac{\\rho\\,r}{T} \\ge 0\n$$\n其中 $\\eta$ 是比熵。同样，当 $r=0$ 时，该式变为：\n$$\n\\rho\\,\\dot{\\eta} + \\frac{\\partial}{\\partial x}\\left(\\frac{q_{x}}{T}\\right) \\ge 0\n$$\n左边的量是单位体积的熵产率。耗散密度 $\\mathcal{D}$ 定义为此率乘以绝对温度 $T$：\n$$\n\\mathcal{D} = T\\left(\\rho\\,\\dot{\\eta} + \\frac{\\partial}{\\partial x}\\left(\\frac{q_{x}}{T}\\right)\\right) \\ge 0\n$$\n使用乘法法则展开空间导数，得到：\n$$\n\\mathcal{D} = \\rho\\,T\\,\\dot{\\eta} + T\\left(\\frac{1}{T}\\frac{\\partial q_{x}}{\\partial x} - \\frac{q_{x}}{T^2}\\frac{\\partial T}{\\partial x}\\right) = \\rho\\,T\\,\\dot{\\eta} + \\frac{\\partial q_{x}}{\\partial x} - \\frac{q_{x}}{T}\\frac{\\partial T}{\\partial x}\n$$\n从能量平衡方程中，我们可以代入热流散度 $\\frac{\\partial q_{x}}{\\partial x} = \\sigma\\,\\dot{\\varepsilon} - \\rho\\,\\dot{u}$：\n$$\n\\mathcal{D} = \\rho\\,T\\,\\dot{\\eta} + \\left(\\sigma\\,\\dot{\\varepsilon} - \\rho\\,\\dot{u}\\right) - \\frac{q_{x}}{T}\\frac{\\partial T}{\\partial x}\n$$\n现在，我们使用单位质量亥姆霍兹自由能的定义 $\\psi = u - T\\,\\eta$。对其求物质时间导数得到：\n$$\n\\dot{\\psi} = \\dot{u} - \\dot{T}\\,\\eta - T\\,\\dot{\\eta} \\implies \\dot{u} = \\dot{\\psi} + \\dot{T}\\,\\eta + T\\,\\dot{\\eta}\n$$\n将 $\\dot{u}$ 的这个表达式代入 $\\mathcal{D}$ 的方程中：\n$$\n\\mathcal{D} = \\rho\\,T\\,\\dot{\\eta} + \\sigma\\,\\dot{\\varepsilon} - \\rho\\left(\\dot{\\psi} + \\dot{T}\\,\\eta + T\\,\\dot{\\eta}\\right) - \\frac{q_{x}}{T}\\frac{\\partial T}{\\partial x}\n$$\n项 $\\rho\\,T\\,\\dot{\\eta}$ 被消去，留下用亥姆霍兹自由能表示的克劳修斯-杜亥姆不等式：\n$$\n\\mathcal{D} = \\sigma\\,\\dot{\\varepsilon} - \\rho\\left(\\dot{\\psi} + \\eta\\,\\dot{T}\\right) - \\frac{q_{x}}{T}\\frac{\\partial T}{\\partial x} \\ge 0\n$$\n这就是所要求的不等式。现在我们使用给定的本构结构将其具体化。亥姆霍兹自由能 $\\psi$ 是应变 $\\varepsilon$ 和温度 $T$ 的函数，所以它的物质时间导数由链式法则给出：\n$$\n\\dot{\\psi} = \\frac{\\partial \\psi}{\\partial \\varepsilon}\\dot{\\varepsilon} + \\frac{\\partial \\psi}{\\partial T}\\dot{T}\n$$\n将此式代入 $\\mathcal{D}$ 的表达式中：\n$$\n\\mathcal{D} = \\sigma\\,\\dot{\\varepsilon} - \\rho\\left(\\left(\\frac{\\partial \\psi}{\\partial \\varepsilon}\\dot{\\varepsilon} + \\frac{\\partial \\psi}{\\partial T}\\dot{T}\\right) + \\eta\\,\\dot{T}\\right) - \\frac{q_{x}}{T}\\frac{\\partial T}{\\partial x} \\ge 0\n$$\n按率 $\\dot{\\varepsilon}$ 和 $\\dot{T}$ 对各项进行分组：\n$$\n\\mathcal{D} = \\left(\\sigma - \\rho\\frac{\\partial \\psi}{\\partial \\varepsilon}\\right)\\dot{\\varepsilon} - \\rho\\left(\\frac{\\partial \\psi}{\\partial T} + \\eta\\right)\\dot{T} - \\frac{q_{x}}{T}\\frac{\\partial T}{\\partial x} \\ge 0\n$$\n问题给出了应力的本构关系：$\\sigma = \\rho\\,\\frac{\\partial \\psi}{\\partial \\varepsilon} + \\eta_{v}\\,\\dot{\\varepsilon}$。将其代入第一项得到：\n$$\n\\sigma - \\rho\\frac{\\partial \\psi}{\\partial \\varepsilon} = \\left(\\rho\\frac{\\partial \\psi}{\\partial \\varepsilon} + \\eta_{v}\\,\\dot{\\varepsilon}\\right) - \\rho\\frac{\\partial \\psi}{\\partial \\varepsilon} = \\eta_{v}\\,\\dot{\\varepsilon}\n$$\n此时 $\\mathcal{D}$ 的不等式为：\n$$\n\\mathcal{D} = \\left(\\eta_{v}\\,\\dot{\\varepsilon}\\right)\\dot{\\varepsilon} - \\rho\\left(\\frac{\\partial \\psi}{\\partial T} + \\eta\\right)\\dot{T} - \\frac{q_{x}}{T}\\frac{\\partial T}{\\partial x} \\ge 0\n$$\n$$\n\\mathcal{D} = \\eta_{v}\\,\\dot{\\varepsilon}^2 - \\rho\\left(\\frac{\\partial \\psi}{\\partial T} + \\eta\\right)\\dot{T} - \\frac{q_{x}}{T}\\frac{\\partial T}{\\partial x} \\ge 0\n$$\n根据科尔曼-诺尔程序，这个不等式必须对所有容许的热力学过程成立，这意味着对于非本构决定的率（在这里是 $\\dot{T}$）的任意选择都成立。由于 $\\dot{T}$ 的系数与 $\\dot{T}$ 无关，为了防止不等式被违反（例如，通过选择一个非常大的正或负 $\\dot{T}$），其系数必须为零。这就得到了熵的标准热力学关系：\n$$\n\\rho\\left(\\frac{\\partial \\psi}{\\partial T} + \\eta\\right) = 0 \\implies \\eta = -\\frac{\\partial \\psi}{\\partial T}\n$$\n有了这个结果，耗散密度的不等式简化为剩余耗散不等式：\n$$\n\\mathcal{D} = \\eta_{v}\\,\\dot{\\varepsilon}^2 - \\frac{q_{x}}{T}\\frac{\\partial T}{\\partial x} \\ge 0\n$$\n这个表达式表明，总耗散是机械过程和热过程贡献的总和。项 $\\eta_{v}\\,\\dot{\\varepsilon}^2$ 表示由粘性引起的机械耗散。\n最后，我们代入热流的本构定律，$q_{x} = -k\\,\\frac{\\partial T}{\\partial x}$：\n$$\n\\mathcal{D} = \\eta_{v}\\,\\dot{\\varepsilon}^2 - \\frac{\\left(-k\\,\\frac{\\partial T}{\\partial x}\\right)}{T}\\frac{\\partial T}{\\partial x}\n$$\n$$\n\\mathcal{D} = \\eta_{v}\\,\\dot{\\varepsilon}^2 + \\frac{k}{T}\\left(\\frac{\\partial T}{\\partial x}\\right)^2\n$$\n这是瞬时耗散密度的最终表达式。它是由粘性引起的机械耗散 $\\mathcal{D}_{\\text{mech}} = \\eta_{v}\\,\\dot{\\varepsilon}^2$ 和由热传导引起的热耗散 $\\mathcal{D}_{\\text{therm}} = \\frac{k}{T}\\left(\\frac{\\partial T}{\\partial x}\\right)^2$ 的总和。由于对于任何物理系统，$\\eta_v \\ge 0$，$k \\ge 0$，且 $T > 0$，这两项都是非负的，从而确保总耗散 $\\mathcal{D}$ 始终为非负，满足热力学第二定律。单位是 W/m$^3$，符合要求。",
            "answer": "$$\n\\boxed{\\eta_{v}\\,\\dot{\\varepsilon}^{2} + \\frac{k}{T}\\left(\\frac{\\partial T}{\\partial x}\\right)^{2}}\n$$"
        },
        {
            "introduction": "本实践将理论与离散计算联系起来，旨在解决计算力学中的一个关键问题：朴素的数值格式可能会违反热力学第二定律，导致非物理的结果。通过一个动手编程练习，你将观察到一个热-粘塑性模型中这种失效模式，并学习如何通过实现熵稳定格式来修正它。这个过程突显了开发热力学一致算法在保证模拟结果物理真实性方面的重要性。",
            "id": "3562407",
            "problem": "考虑一个正在经历快速应变斜坡的一维小应变热粘塑性材料。局部热力学模型以单位体积为单位，并采用以下基本基础：热力学第一定律（能量平衡）的局部形式和热力学第二定律，后者蕴含了克劳修斯-杜亥姆 (CD) 不等式。单位体积的CD不等式可以写为\n$$\n\\mathcal{D} = \\sigma \\, \\dot{\\varepsilon} - \\dot{\\psi} - \\eta \\, \\dot{T} \\ge 0,\n$$\n其中 $\\,\\sigma\\,$ 是柯西应力，$\\,\\varepsilon\\,$ 是总应变，$\\,\\psi\\,$ 是亥姆霍兹自由能密度，$\\,\\eta\\,$ 是熵密度，$\\,T\\,$ 是绝对温度。假设没有热传导或外部热源，并以单位体积表示所有量。对于一维小应变设置，取自由能密度为\n$$\n\\psi(\\varepsilon_e, T) = \\tfrac{1}{2} E \\, \\varepsilon_e^2 \\;+\\; c \\left[T - T_0 - T \\ln\\!\\left(\\tfrac{T}{T_0}\\right)\\right],\n$$\n其中 $\\,\\varepsilon_e = \\varepsilon - \\varepsilon_p\\,$ 是弹性应变，$\\,\\varepsilon_p\\,$ 是塑性应变，$\\,E\\,$ 是弹性模量，$\\,c\\,$ 是单位体积热容（假设为常数），$\\,T_0\\,$ 是参考温度。应力为 $\\,\\sigma = E \\,\\varepsilon_e\\,$，熵密度为\n$$\n\\eta(T) = c \\,\\ln\\!\\left(\\tfrac{T}{T_0}\\right).\n$$\n\n塑性流动由一维的Perzyna型过应力模型控制，\n$$\n\\dot{\\varepsilon}_p = \\frac{\\gamma}{E}\\,\\left\\langle |\\sigma| - \\sigma_y(T) \\right\\rangle \\,\\mathrm{sign}(\\sigma),\n$$\n其中 $\\,\\gamma\\,$ 是一个类粘性参数，$\\,\\sigma_y(T) = \\sigma_{y0}\\,\\max\\{1 - \\beta (T-T_0),\\, \\underline{\\kappa}\\}\\,$ 是温变屈服应力，其下限为 $\\,\\underline{\\kappa}\\in(0,1)\\,$ 以防止屈服应力消失，$\\,\\langle x\\rangle = \\max\\{x,0\\}\\,$ 表示斜坡函数。绝热温度演化为\n$$\n\\dot{T} = \\frac{\\chi}{c}\\,\\sigma\\,\\dot{\\varepsilon}_p,\n$$\n其中 $\\,\\chi \\in [0,1]\\,$ 是Taylor-Quinney系数（塑性功转化为热的比例）。\n\n您将构建一个时间积分基准测试，该测试在粘塑性快速热瞬变过程中，会暴露朴素显式格式下离散形式CD不等式的违背，然后通过熵稳定时间积分或熵限制器来修复此问题。\n\n令施加的总应变历史为一斜坡函数\n$$\n\\varepsilon(t) = \\varepsilon_\\mathrm{final}\\,\\min\\!\\left(\\frac{t}{t_\\mathrm{ramp}},\\,1\\right),\n$$\n其中 $\\,\\varepsilon_\\mathrm{final}  0\\,$ 且 $\\,t_\\mathrm{ramp}  0\\,$。总模拟时间为 $\\,t_\\mathrm{end}  t_\\mathrm{ramp}\\,$。使用以下参数（均为国际单位制 (SI)）：\n- $\\,E = 2.0\\times 10^{11}\\,$ Pa,\n- $\\,c = 3.5\\times 10^{6}\\,$ J$\\cdot$m$^{-3}\\cdot$K$^{-1}$,\n- $\\,T_0 = 300\\,$ K,\n- $\\,\\sigma_{y0} = 4.0\\times 10^{8}\\,$ Pa,\n- $\\,\\beta = 1.0\\times 10^{-3}\\,$ K$^{-1}$,\n- $\\,\\underline{\\kappa} = 0.2\\,$ (无量纲下限),\n- $\\,\\gamma = 5.0\\times 10^{3}\\,$ s$^{-1}$,\n- $\\,\\chi = 0.9\\,$ (无量纲),\n- $\\,\\varepsilon_\\mathrm{final} = 0.02\\,$ (无量纲),\n- $\\,t_\\mathrm{ramp} = 1.0\\times 10^{-4}\\,$ s,\n- $\\,t_\\mathrm{end} = 2.0\\times 10^{-4}\\,$ s.\n\n将时间步长为 $\\,\\Delta t\\,$ 的时间步 $\\,n\\to n+1\\,$ 的步进离散熵产定义为\n$$\n\\mathcal{D}^{(n)} = \\sigma^{(n)}\\,\\frac{\\varepsilon^{(n+1)} - \\varepsilon^{(n)}}{\\Delta t}\\; -\\; \\frac{\\psi^{(n+1)} - \\psi^{(n)}}{\\Delta t}\\; -\\; \\eta^{(n)}\\,\\frac{T^{(n+1)} - T^{(n)}}{\\Delta t},\n$$\n用于朴素显式格式。这种选择在上一时间层级评估应力和熵，并在步长内评估自由能变化，已知在快速瞬变期间，由于弹性能力量平衡的不匹配，会在大的 $\\,\\Delta t\\,$ 下产生虚假的负值。\n\n对于熵稳定变体，使用以下离散产熵和更新：\n- 中点应力 $\\,\\sigma^\\mathrm{avg} = \\tfrac{1}{2}\\left(\\sigma^{(n)} + \\sigma^{(n+1)}\\right)\\,$，\n- 热部分的离散梯度 $\\,\\eta^\\mathrm{dg} = -\\dfrac{\\psi_\\mathrm{th}(T^{(n+1)}) - \\psi_\\mathrm{th}(T^{(n)})}{T^{(n+1)} - T^{(n)}}\\,$ 若 $\\,T^{(n+1)} \\ne T^{(n)}\\,$，否则 $\\,\\eta^\\mathrm{dg} = \\eta(T^{(n)})\\,$，\n- 熵稳定的步进产熵\n$$\n\\mathcal{D}_\\mathrm{es}^{(n)} = \\sigma^\\mathrm{avg}\\,\\frac{\\varepsilon^{(n+1)} - \\varepsilon^{(n)}}{\\Delta t}\\; -\\; \\frac{\\psi^{(n+1)} - \\psi^{(n)}}{\\Delta t}\\; -\\; \\eta^\\mathrm{dg}\\,\\frac{T^{(n+1)} - T^{(n)}}{\\Delta t},\n$$\n并使用中点塑性功率更新温度\n$$\nT^{(n+1)} = T^{(n)} + \\frac{\\chi}{c}\\,\\sigma^\\mathrm{avg}\\,\\Delta \\varepsilon_p,\n$$\n其中 $\\,\\Delta \\varepsilon_p = \\varepsilon_p^{(n+1)} - \\varepsilon_p^{(n)}\\,$ 是步内的塑性应变增量。\n\n对于熵限制器变体，保持对 $\\,\\mathcal{D}^{(n)}\\,$ 的朴素显式评估，但如果 $\\,\\mathcal{D}^{(n)}  0\\,$，则在步内调整塑性增量 $\\,\\Delta \\varepsilon_p\\,$ 以使 $\\,\\mathcal{D}^{(n)} \\ge 0\\,$。一个从离散弹性失配推导出的代数限制器将 $\\,\\Delta \\varepsilon_p\\,$ 设置为\n$$\n\\Delta \\varepsilon_p^\\star = \\left(\\Delta \\varepsilon + \\varepsilon_e^{(n)}\\right) - \\sqrt{\\max\\left\\{\\varepsilon_e^{(n)}\\left(2\\Delta \\varepsilon + \\varepsilon_e^{(n)}\\right),\\,0\\right\\}},\n$$\n然后将其钳制为 $\\,\\Delta \\varepsilon_p \\leftarrow \\min\\left\\{\\Delta \\varepsilon,\\,\\max\\left\\{\\Delta \\varepsilon_p,\\,\\Delta \\varepsilon_p^\\star\\right\\}\\right\\}\\,$，其中 $\\,\\varepsilon_e^{(n)} = \\varepsilon^{(n)} - \\varepsilon_p^{(n)}\\,$。更改 $\\,\\Delta \\varepsilon_p\\,$ 后，为该步骤一致地重新计算 $\\,\\sigma^{(n+1)}\\,$、$\\,T^{(n+1)}\\,$ 和 $\\,\\mathcal{D}^{(n)}\\,$。\n\n实现一个程序，使用指定的参数和应变斜坡来模拟上述模型的三个测试案例：\n1. 使用 $\\,\\Delta t = 2.0\\times 10^{-5}\\,$ s 的朴素显式格式。\n2. 使用 $\\,\\Delta t = 2.0\\times 10^{-5}\\,$ s 的熵稳定格式。\n3. 使用 $\\,\\Delta t = 2.0\\times 10^{-5}\\,$ s 的带熵限制器的朴素显式格式。\n\n对于每个案例，从 $\\,t=0\\,$ 模拟到 $\\,t=t_\\mathrm{end}\\,$，记录步进离散产熵 $\\,\\mathcal{D}^{(n)}\\,$（对于熵稳定案例则为 $\\,\\mathcal{D}_\\mathrm{es}^{(n)}\\,$），并报告所有时间步中的最小值。以瓦特每立方米 (W/m$^3$) 为单位，将最终结果表示为浮点数。您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果（例如，$[\\text{result1},\\text{result2},\\text{result3}]$）。",
            "solution": "推导始于将基本定律应用于一维小应变假设下的连续介质。对于单位体积，热力学第一定律（无热传导或外部热源的能量平衡）和热力学第二定律蕴含了克劳修斯-杜亥姆 (CD) 不等式\n$$\n\\mathcal{D} = \\sigma\\,\\dot{\\varepsilon} - \\dot{\\psi} - \\eta\\,\\dot{T} \\ge 0,\n$$\n其中 $\\,\\psi\\,$ 是亥姆霍兹自由能密度，$\\,\\eta\\,$ 是熵密度，$\\,\\sigma\\,$ 是应力，$\\,\\varepsilon\\,$ 是总应变。\n\n我们采用一种可分离的单位体积自由能密度，\n$$\n\\psi(\\varepsilon_e, T) = \\psi_\\mathrm{me}(\\varepsilon_e) + \\psi_\\mathrm{th}(T),\n\\quad\n\\psi_\\mathrm{me}(\\varepsilon_e) = \\tfrac{1}{2} E \\varepsilon_e^2,\n\\quad\n\\psi_\\mathrm{th}(T) = c \\left[T - T_0 - T \\ln\\!\\left(\\tfrac{T}{T_0}\\right)\\right],\n$$\n其中 $\\,\\varepsilon_e = \\varepsilon - \\varepsilon_p\\,$。应力为 $\\,\\sigma = \\partial \\psi_\\mathrm{me}/\\partial \\varepsilon_e = E\\,\\varepsilon_e\\,$，熵密度为 $\\,\\eta(T) = -\\partial \\psi/\\partial T = c \\ln\\!\\left(\\tfrac{T}{T_0}\\right)\\,$。对于热学部分，计算 $\\,\\dot{\\psi}_\\mathrm{th} = - c \\ln\\!\\left(\\tfrac{T}{T_0}\\right)\\dot{T}\\,$，这在CD不等式中恰好与 $\\,\\eta\\,\\dot{T}\\,$ 相抵消：\n$$\n-\\dot{\\psi}_\\mathrm{th} - \\eta \\,\\dot{T} = c \\ln\\!\\left(\\tfrac{T}{T_0}\\right)\\dot{T} - c \\ln\\!\\left(\\tfrac{T}{T_0}\\right)\\dot{T} = 0.\n$$\n因此，在连续设定下，不等式简化为\n$$\n\\mathcal{D} = \\sigma \\,\\dot{\\varepsilon} - \\dot{\\psi}_\\mathrm{me} \\ge 0.\n$$\n利用 $\\,\\dot{\\psi}_\\mathrm{me} = E\\,\\varepsilon_e\\,\\dot{\\varepsilon}_e\\,$ 和 $\\,\\dot{\\varepsilon}_e = \\dot{\\varepsilon} - \\dot{\\varepsilon}_p\\,$，我们得到\n$$\n\\mathcal{D} = E\\,\\varepsilon_e\\,\\dot{\\varepsilon} - E\\,\\varepsilon_e\\,\\dot{\\varepsilon}_e\n= E\\,\\varepsilon_e\\,\\dot{\\varepsilon}_p\n= \\sigma \\,\\dot{\\varepsilon}_p \\ge 0,\n$$\n这满足标准的粘塑性耗散假设 $\\,\\sigma\\,\\dot{\\varepsilon}_p \\ge 0\\,$，该假设通过选择流动法则使得 $\\,\\mathrm{sign}(\\dot{\\varepsilon}_p)=\\mathrm{sign}(\\sigma)\\,$ 并且当 $\\,|\\sigma|>\\sigma_y(T)\\,$ 时 $\\,\\dot{\\varepsilon}_p \\ge 0\\,$ 来强制执行。绝热温度演化 $\\,\\dot{T} = (\\chi/c)\\,\\sigma\\,\\dot{\\varepsilon}_p\\,$（其中 $\\,\\chi \\in [0,1]\\,$）也与该不等式一致，因为它不会引入负耗散。\n\n我们现在考虑离散时间积分。设时间步长为 $\\,\\Delta t\\,$ 的时间步为 $\\,n\\to n+1\\,$，并通过后向差分定义离散熵产。一种朴素的显式计算方法是使用 $\\,\\sigma^{(n)}\\,$ 和 $\\,\\eta^{(n)}\\,$ 计算功率和熵项：\n$$\n\\mathcal{D}^{(n)} = \\sigma^{(n)}\\frac{\\Delta \\varepsilon}{\\Delta t} - \\frac{\\Delta \\psi}{\\Delta t} - \\eta^{(n)}\\frac{\\Delta T}{\\Delta t}, \\quad\n\\Delta \\varepsilon = \\varepsilon^{(n+1)}-\\varepsilon^{(n)},\\;\n\\Delta \\psi = \\psi^{(n+1)}-\\psi^{(n)},\\;\n\\Delta T = T^{(n+1)}-T^{(n)}.\n$$\n将 $\\,\\Delta \\psi = \\Delta \\psi_\\mathrm{me} + \\Delta \\psi_\\mathrm{th}\\,$ 分开。对于力学部分，代入 $\\,\\psi_\\mathrm{me}(\\varepsilon_e) = \\tfrac{1}{2} E \\varepsilon_e^2\\,$ 和 $\\,\\varepsilon_e^{(i)} = \\varepsilon^{(i)} - \\varepsilon_p^{(i)}\\,$ 得\n$$\n\\sigma^{(n)}\\frac{\\Delta \\varepsilon}{\\Delta t} - \\frac{\\Delta \\psi_\\mathrm{me}}{\\Delta t}\n= E\\,\\varepsilon_e^{(n)}\\frac{\\Delta \\varepsilon}{\\Delta t} - \\frac{\\tfrac{1}{2} E\\left[(\\varepsilon_e^{(n+1)})^2 - (\\varepsilon_e^{(n)})^2\\right]}{\\Delta t}.\n$$\n写出 $\\,\\Delta \\varepsilon_e = \\varepsilon_e^{(n+1)} - \\varepsilon_e^{(n)} = \\Delta \\varepsilon - \\Delta \\varepsilon_p\\,$，并注意到\n$$\nE\\,\\varepsilon_e^{(n)}\\Delta \\varepsilon_e - \\tfrac{1}{2}E \\left[ (\\varepsilon_e^{(n+1)})^2 - (\\varepsilon_e^{(n)})^2 \\right]\n= -\\tfrac{1}{2} E (\\Delta \\varepsilon_e)^2 \\le 0,\n$$\n我们得到离散力学失配\n$$\n\\sigma^{(n)}\\frac{\\Delta \\varepsilon}{\\Delta t} - \\frac{\\Delta \\psi_\\mathrm{me}}{\\Delta t}\n= -\\frac{1}{2} E \\frac{(\\Delta \\varepsilon_e)^2}{\\Delta t} + E\\,\\varepsilon_e^{(n)}\\frac{\\Delta \\varepsilon_p}{\\Delta t}.\n$$\n第一项是虚假的且非正的，其出现纯粹是由于在上一时间层级而非中点处计算应力所致。在快速瞬变期间（大的 $\\,\\Delta t\\,$），$\\,|\\Delta \\varepsilon_e|\\,$ 可能大到足以使此负项占主导地位，导致 $\\,\\mathcal{D}^{(n)}0\\,$，尽管连续的 $\\,\\mathcal{D}\\ge 0\\,$。\n\n对于使用朴素显式计算的热学部分，我们使用 $\\,\\eta^{(n)}\\,\\Delta T/\\Delta t\\,$ 和 $\\,\\Delta \\psi_\\mathrm{th}/\\Delta t\\,$。在连续设定中，热学项通过构造完全抵消；然而，在离散层级使用 $\\,\\eta^{(n)}\\,$ 时，它们并不能完全抵消。一个鲁棒的熵稳定离散化对热项使用离散梯度，\n$$\n\\eta^\\mathrm{dg} = -\\frac{\\psi_\\mathrm{th}(T^{(n+1)}) - \\psi_\\mathrm{th}(T^{(n)})}{T^{(n+1)} - T^{(n)}} \\quad \\text{如果 } T^{(n+1)} \\ne T^{(n)},\n$$\n否则 $\\,\\eta^\\mathrm{dg} = \\eta(T^{(n)})\\,$，这保证了\n$$\n-\\frac{\\Delta \\psi_\\mathrm{th}}{\\Delta t} - \\eta^\\mathrm{dg}\\frac{\\Delta T}{\\Delta t} = 0\n$$\n在离散层级上精确成立。\n\n一个熵稳定的力学离散化使用中点应力 $\\,\\sigma^\\mathrm{avg} = \\tfrac{1}{2}(\\sigma^{(n)} + \\sigma^{(n+1)})\\,$：\n$$\n\\sigma^\\mathrm{avg}\\frac{\\Delta \\varepsilon}{\\Delta t} - \\frac{\\Delta \\psi_\\mathrm{me}}{\\Delta t}\n= \\sigma^\\mathrm{avg}\\frac{\\Delta \\varepsilon_p}{\\Delta t} \\ge 0,\n$$\n因为在单调加载和耗散流下，$\\,\\sigma^\\mathrm{avg}\\,$ 和 $\\,\\Delta \\varepsilon_p\\,$ 的符号一致。因此，熵稳定的步进产熵\n$$\n\\mathcal{D}_\\mathrm{es}^{(n)} = \\sigma^\\mathrm{avg}\\frac{\\Delta \\varepsilon}{\\Delta t} - \\frac{\\Delta \\psi}{\\Delta t} - \\eta^\\mathrm{dg}\\frac{\\Delta T}{\\Delta t}\n= \\sigma^\\mathrm{avg}\\frac{\\Delta \\varepsilon_p}{\\Delta t} \\ge 0,\n$$\n通过构造是非负的。使用中点塑性功率更新温度，\n$$\nT^{(n+1)} = T^{(n)} + \\frac{\\chi}{c}\\,\\sigma^\\mathrm{avg}\\,\\Delta \\varepsilon_p,\n$$\n保持了热耦合的一致性。\n\n作为替代方案，可以在朴素显式格式中设计一个熵限制器，通过在步内增加塑性增量 $\\,\\Delta \\varepsilon_p\\,$ 来抑制虚假的弹性失配。设置\n$$\n\\Delta \\varepsilon_p^\\star = \\left(\\Delta \\varepsilon + \\varepsilon_e^{(n)}\\right) - \\sqrt{\\max\\left\\{\\varepsilon_e^{(n)}\\left(2\\Delta \\varepsilon + \\varepsilon_e^{(n)}\\right),\\,0\\right\\}},\n$$\n并更新 $\\,\\Delta \\varepsilon_p \\leftarrow \\min\\left\\{\\Delta \\varepsilon,\\,\\max\\left\\{\\Delta \\varepsilon_p,\\,\\Delta \\varepsilon_p^\\star\\right\\}\\right\\}\\,$，使得步进力学产熵非负：\n$$\n-\\frac{1}{2} E \\frac{(\\Delta \\varepsilon_e)^2}{\\Delta t} + E\\,\\varepsilon_e^{(n)}\\frac{\\Delta \\varepsilon_p}{\\Delta t} \\ge 0,\n$$\n其中 $\\,\\Delta \\varepsilon_e = \\Delta \\varepsilon - \\Delta \\varepsilon_p\\,$。在调整 $\\,\\Delta \\varepsilon_p\\,$ 之后，为保持一致性重新计算 $\\,\\sigma^{(n+1)}\\,$、$\\,T^{(n+1)}\\,$ 和 $\\,\\mathcal{D}^{(n)}\\,$。\n\n模拟的算法设计：\n- 初始化 $\\,\\varepsilon_p^{(0)} = 0\\,$、$\\,T^{(0)} = T_0\\,$ 和 $\\,\\sigma^{(0)} = E(\\varepsilon^{(0)} - \\varepsilon_p^{(0)}) = 0\\,$。\n- 对于每个时间步 $\\,n\\,$：\n  - 从斜坡函数计算 $\\,\\varepsilon^{(n)}\\,$ 和 $\\,\\varepsilon^{(n+1)}\\,$。\n  - 计算 $\\,\\sigma^{(n)} = E(\\varepsilon^{(n)} - \\varepsilon_p^{(n)})\\,$ 和 $\\,\\sigma_y^{(n)} = \\sigma_{y0}\\,\\max\\{1 - \\beta (T^{(n)}-T_0),\\, \\underline{\\kappa}\\}\\,$。\n  - 计算 $\\,\\dot{\\varepsilon}_p^{(n)} = \\tfrac{\\gamma}{E}\\,\\langle |\\sigma^{(n)}| - \\sigma_y^{(n)} \\rangle \\,\\mathrm{sign}(\\sigma^{(n)})\\,$ 和 $\\,\\Delta \\varepsilon_p = \\dot{\\varepsilon}_p^{(n)}\\Delta t\\,$。\n  - 构造 $\\,\\varepsilon_p^{(n+1)} = \\varepsilon_p^{(n)} + \\Delta \\varepsilon_p\\,$ 和 $\\,\\sigma^{(n+1)} = E(\\varepsilon^{(n+1)} - \\varepsilon_p^{(n+1)})\\,$。\n  - 对于显式格式，更新 $\\,T^{(n+1)} = T^{(n)} + \\tfrac{\\chi}{c}\\,\\sigma^{(n)}\\,\\Delta \\varepsilon_p\\,$；对于熵稳定格式，更新 $\\,T^{(n+1)} = T^{(n)} + \\tfrac{\\chi}{c}\\,\\sigma^\\mathrm{avg}\\,\\Delta \\varepsilon_p\\,$，其中 $\\,\\sigma^\\mathrm{avg} = \\tfrac{1}{2}(\\sigma^{(n)}+\\sigma^{(n+1)})\\,$。\n  - 类似地计算 $\\,\\psi^{(n)} = \\psi_\\mathrm{me}(\\varepsilon_e^{(n)}) + \\psi_\\mathrm{th}(T^{(n)})\\,$ 和 $\\,\\psi^{(n+1)}\\,$，以及熵 $\\,\\eta^{(n)} = \\eta(T^{(n)})\\,$。对于熵稳定变体，如果 $\\,\\Delta T \\ne 0\\,$，则使用 $\\,\\eta^\\mathrm{dg} = -\\tfrac{\\psi_\\mathrm{th}(T^{(n+1)}) - \\psi_\\mathrm{th}(T^{(n)})}{T^{(n+1)} - T^{(n)}}\\,$，否则 $\\,\\eta^\\mathrm{dg} = \\eta^{(n)}\\,$。\n  - 相应地构造 $\\,\\mathcal{D}^{(n)}\\,$ 或 $\\,\\mathcal{D}_\\mathrm{es}^{(n)}\\,$。\n  - 在熵限制器变体中，如果 $\\,\\mathcal{D}^{(n)}  0\\,$，则用如上所述钳制的受限 $\\,\\Delta \\varepsilon_p^\\star\\,$ 替换 $\\,\\Delta \\varepsilon_p\\,$，然后重新计算 $\\,\\varepsilon_p^{(n+1)}\\,$、$\\,\\sigma^{(n+1)}\\,$、$\\,T^{(n+1)}\\,$ 和 $\\,\\mathcal{D}^{(n)}\\,$。\n- 记录整个模拟过程中的最小 $\\,\\mathcal{D}^{(n)}\\,$（或 $\\,\\mathcal{D}_\\mathrm{es}^{(n)}\\,$）。$\\,\\mathcal{D}\\,$ 的单位是单位体积的功率 (W/m$^3$)。\n\n测试套件设计：\n- 案例1（显式，大步长）：$\\,\\Delta t = 2.0\\times 10^{-5}\\,$ s，预期出现违背（$\\,\\min \\mathcal{D}^{(n)}  0\\,$）。\n- 案例2（熵稳定，大步长）：$\\,\\Delta t = 2.0\\times 10^{-5}\\,$ s，预期通过构造满足 $\\,\\min \\mathcal{D}_\\mathrm{es}^{(n)} \\ge 0\\,$。\n- 案例3（带限制器的显式，大步长）：$\\,\\Delta t = 2.0\\times 10^{-5}\\,$ s，预期应用限制器后满足 $\\,\\min \\mathcal{D}^{(n)} \\ge 0\\,$。\n\n最终程序执行这些案例，并以瓦特每立方米 (W/m$^3$) 为单位，将最小离散产熵值打印为单行、用方括号括起来的逗号分隔列表。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# Material and loading parameters (SI units)\nE = 2.0e11                 # Pa\nc = 3.5e6                  # J/(m^3 K)\nT0 = 300.0                 # K\nsigma_y0 = 4.0e8           # Pa\nbeta = 1.0e-3              # 1/K\nkappa_floor = 0.2          # dimensionless floor for yield stress fraction\ngamma = 5.0e3              # 1/s\nchi = 0.9                  # Taylor-Quinney coefficient\neps_final = 0.02           # final strain\nt_ramp = 1.0e-4            # s\nt_end = 2.0e-4             # s\n\ndef strain_history(t: float) - float:\n    return eps_final * min(t / t_ramp, 1.0)\n\ndef psi_mech(eps_e: float) - float:\n    return 0.5 * E * eps_e**2\n\ndef psi_th(T: float) - float:\n    # c [T - T0 - T ln(T/T0)]\n    return c * (T - T0 - T * np.log(T / T0))\n\ndef eta(T: float) - float:\n    # c ln(T/T0)\n    return c * np.log(T / T0)\n\ndef yield_stress(T: float) - float:\n    # sigma_y(T) = sigma_y0 * max(1 - beta (T-T0), kappa_floor)\n    return sigma_y0 * max(1.0 - beta * (T - T0), kappa_floor)\n\ndef flow_rate(sigma: float, T: float) - float:\n    # Perzyna-type: dot_eps_p = (gamma/E) * |sigma| - sigma_y(T)> * sign(sigma)\n    y = yield_stress(T)\n    overstress = max(abs(sigma) - y, 0.0)\n    sgn = 0.0\n    if sigma > 0.0:\n        sgn = 1.0\n    elif sigma  0.0:\n        sgn = -1.0\n    return (gamma / E) * overstress * sgn\n\ndef simulate(dt: float, method: str) - float:\n    nsteps = int(round(t_end / dt))\n    # State variables\n    eps_p = 0.0\n    T = T0\n    # For recording minimum discrete production\n    min_D = np.inf\n    # Initial total strain and stress\n    t_n = 0.0\n    eps_n = strain_history(t_n)\n    sigma_n = E * (eps_n - eps_p)\n    psi_n = psi_mech(eps_n - eps_p) + psi_th(T)\n    eta_n = eta(T)\n\n    for n in range(nsteps):\n        t_np1 = (n + 1) * dt\n        eps_np1 = strain_history(t_np1)\n        Deps = eps_np1 - eps_n\n\n        # Current stress and yield\n        sigma_n = E * (eps_n - eps_p)\n        y_n = yield_stress(T)\n\n        # Plastic increment by explicit flow\n        dot_eps_p = flow_rate(sigma_n, T)\n        Deps_p = dot_eps_p * dt\n\n        # Tentative update of plastic strain and stress\n        eps_p_tent = eps_p + Deps_p\n        sigma_np1_tent = E * (eps_np1 - eps_p_tent)\n\n        if method == \"explicit\":\n            # Explicit temperature update\n            T_np1 = T + (chi / c) * sigma_n * Deps_p\n\n            # Energetics\n            psi_np1 = psi_mech(eps_np1 - eps_p_tent) + psi_th(T_np1)\n            eta_n_use = eta_n\n            # Discrete production (explicit)\n            Dn = sigma_n * (Deps / dt) - (psi_np1 - psi_n) / dt - eta_n_use * (T_np1 - T) / dt\n\n            # Record min and accept tentative updates\n            min_D = min(min_D, Dn)\n            eps_p = eps_p_tent\n            eps_n = eps_np1\n            psi_n = psi_np1\n            T = T_np1\n            eta_n = eta(T)\n\n        elif method == \"entropy_stable\":\n            # Midpoint stress\n            sigma_avg = 0.5 * (sigma_n + sigma_np1_tent)\n            # Entropy-stable temperature update using midpoint plastic power\n            T_np1 = T + (chi / c) * sigma_avg * Deps_p\n\n            # Energetics\n            psi_np1 = psi_mech(eps_np1 - eps_p_tent) + psi_th(T_np1)\n            # Discrete gradient for thermal term\n            dT = T_np1 - T\n            if abs(dT) > 0.0:\n                eta_dg = - (psi_th(T_np1) - psi_th(T)) / dT\n            else:\n                eta_dg = eta_n\n            # Entropy-stable discrete production\n            Dn = sigma_avg * (Deps / dt) - (psi_np1 - psi_n) / dt - eta_dg * (dT / dt)\n\n            # Record min and accept tentative updates\n            min_D = min(min_D, Dn)\n            eps_p = eps_p_tent\n            eps_n = eps_np1\n            psi_n = psi_np1\n            T = T_np1\n            eta_n = eta(T)\n\n        elif method == \"explicit_with_limiter\":\n            # Explicit temperature update\n            T_np1 = T + (chi / c) * sigma_n * Deps_p\n\n            # Energetics pre-check\n            psi_np1 = psi_mech(eps_np1 - eps_p_tent) + psi_th(T_np1)\n            Dn = sigma_n * (Deps / dt) - (psi_np1 - psi_n) / dt - eta_n * (T_np1 - T) / dt\n\n            if Dn  0.0:\n                # Compute limited plastic increment to enforce non-negative production\n                eps_e_n = eps_n - eps_p\n                # Target increment derived analytically; clamp within [0, Deps]\n                radicand = eps_e_n * (2.0 * Deps + eps_e_n)\n                if radicand  0.0:\n                    radicand = 0.0\n                Deps_p_star = (Deps + eps_e_n) - np.sqrt(radicand)\n                # Clamp to physical range and ensure we do not reduce existing plasticity\n                Deps_p_lim = min(Deps, max(Deps_p, max(0.0, Deps_p_star)))\n\n                # Recompute tentative updates with limiter\n                eps_p_tent = eps_p + Deps_p_lim\n                sigma_np1_tent = E * (eps_np1 - eps_p_tent)\n                T_np1 = T + (chi / c) * sigma_n * Deps_p_lim\n\n                psi_np1 = psi_mech(eps_np1 - eps_p_tent) + psi_th(T_np1)\n                Dn = sigma_n * (Deps / dt) - (psi_np1 - psi_n) / dt - eta_n * (T_np1 - T) / dt\n\n            # Record min and accept final updates\n            min_D = min(min_D, Dn)\n            eps_p = eps_p_tent\n            eps_n = eps_np1\n            psi_n = psi_np1\n            T = T_np1\n            eta_n = eta(T)\n\n        else:\n            raise ValueError(\"Unknown method\")\n\n    return float(min_D)\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (\"explicit\", 2.0e-5),\n        (\"entropy_stable\", 2.0e-5),\n        (\"explicit_with_limiter\", 2.0e-5),\n    ]\n\n    results = []\n    for method, dt in test_cases:\n        minD = simulate(dt, method)\n        results.append(minD)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}