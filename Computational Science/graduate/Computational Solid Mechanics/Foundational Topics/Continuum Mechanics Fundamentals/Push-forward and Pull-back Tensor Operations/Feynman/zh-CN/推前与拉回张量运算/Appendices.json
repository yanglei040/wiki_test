{
    "hands_on_practices": [
        {
            "introduction": "理解推向前和拉回操作最直接的方法，就是将其应用于基本的几何对象。本练习将引导你完成一个具体计算：将一个参考构型中的矢量推向前至当前构型，并拉回一个空间余矢量。通过这个过程，你将验证对偶配对（即点积）的不变性，这是这些坐标变换操作的一个基本且至关重要的性质，确保了不同构型下标量内积的一致性。",
            "id": "3591896",
            "problem": "考虑一个变形三维体，其从参考构型到当前构型的光滑运动由映射 $\\boldsymbol{\\varphi}:\\mathcal{B}_{0}\\rightarrow\\mathcal{B}$ 描述，变形梯度定义为运动对参考构型的梯度，$\\mathbf{F}(\\mathbf{X})=\\nabla_{\\mathbf{X}}\\boldsymbol{\\varphi}(\\mathbf{X})$。参考向量 $\\mathbf{V}$ 的前推是通过变形梯度作用得到的空间向量 $\\mathbf{v}$，而空间协向量 $\\mathbf{a}$ 的拉回是通过变形梯度的转置作用得到的参考协向量 $\\mathbf{A}$。这些构造保持了向量和协向量之间的欧几里得对偶配对不变，即在当前构型中计算的配对等于在参考构型中计算的配对。\n\n设运动在物质点 $\\mathbf{X}=(X_{1},X_{2},X_{3})$ 的变形梯度由以下 $\\boldsymbol{\\varphi}$ 的分量对参考坐标的梯度给出：\n$$\n\\varphi_{1}(\\mathbf{X})=X_{1}+\\tfrac{1}{2}X_{1}^{2}-0.1\\,X_{2},\\quad\n\\varphi_{2}(\\mathbf{X})=X_{2}+X_{3}^{2}\\,X_{2},\\quad\n\\varphi_{3}(\\mathbf{X})=X_{3}+0.3\\,X_{1}+0.06\\,X_{1}X_{3}.\n$$\n在物质点 $\\mathbf{X}=(0.2,-0.1,0.3)$ 处计算 $\\mathbf{F}(\\mathbf{X})$。设参考向量为 $\\mathbf{V}=(2,-1,3)$，空间协向量为 $\\mathbf{a}=(1,4,-2)$，两者均在标准欧几里得意义下理解，因此对偶配对即为标准点积。使用前推和拉回的基本定义，计算空间向量 $\\mathbf{v}$ 和参考协向量 $\\mathbf{A}$，然后在 $\\mathbf{X}=(0.2,-0.1,0.3)$ 处数值验证对偶配对保持不变，即 $\\,\\mathbf{a}\\cdot\\mathbf{v}=\\mathbf{A}\\cdot\\mathbf{V}\\,$。将对偶配对的共同值作为您的最终答案。请以精确小数形式表示您的答案（无需四舍五入）。",
            "solution": "问题陈述已经过验证，被认为是有效的。这是一个计算固体力学中的适定问题，具有科学依据、客观且自洽。所提供的定义和关系是连续介质力学中的标准内容。我们开始求解。\n\n运动由映射 $\\boldsymbol{\\varphi}(\\mathbf{X})$ 描述，变形梯度由 $\\mathbf{F} = \\nabla_{\\mathbf{X}}\\boldsymbol{\\varphi}$ 给出。以分量形式表示，设 $\\mathbf{x} = \\boldsymbol{\\varphi}(\\mathbf{X})$，则 $\\mathbf{F}$ 的分量为 $F_{ij} = \\frac{\\partial \\varphi_i}{\\partial X_j}$。运动的分量如下：\n$$\n\\varphi_{1}(\\mathbf{X}) = X_{1} + \\frac{1}{2}X_{1}^{2} - 0.1\\,X_{2}\n$$\n$$\n\\varphi_{2}(\\mathbf{X}) = X_{2} + X_{3}^{2}\\,X_{2}\n$$\n$$\n\\varphi_{3}(\\mathbf{X}) = X_{3} + 0.3\\,X_{1} + 0.06\\,X_{1}X_{3}\n$$\n首先，我们通过对参考坐标 $X_j$ 求偏导数来计算变形梯度张量 $\\mathbf{F}$ 的分量：\n$$\nF_{11} = \\frac{\\partial \\varphi_1}{\\partial X_1} = 1+X_1\n$$\n$$\nF_{12} = \\frac{\\partial \\varphi_1}{\\partial X_2} = -0.1\n$$\n$$\nF_{13} = \\frac{\\partial \\varphi_1}{\\partial X_3} = 0\n$$\n$$\nF_{21} = \\frac{\\partial \\varphi_2}{\\partial X_1} = 0\n$$\n$$\nF_{22} = \\frac{\\partial \\varphi_2}{\\partial X_2} = 1+X_3^2\n$$\n$$\nF_{23} = \\frac{\\partial \\varphi_2}{\\partial X_3} = 2 X_2 X_3\n$$\n$$\nF_{31} = \\frac{\\partial \\varphi_3}{\\partial X_1} = 0.3 + 0.06 X_3\n$$\n$$\nF_{32} = \\frac{\\partial \\varphi_3}{\\partial X_2} = 0\n$$\n$$\nF_{33} = \\frac{\\partial \\varphi_3}{\\partial X_3} = 1 + 0.06 X_1\n$$\n这给出了作为物质点 $\\mathbf{X}$ 函数的变形梯度张量：\n$$\n\\mathbf{F}(\\mathbf{X}) =\n\\begin{pmatrix}\n1+X_1  & -0.1  & 0 \\\\\n0  & 1+X_3^2  & 2 X_2 X_3 \\\\\n0.3 + 0.06 X_3  & 0  & 1 + 0.06 X_1\n\\end{pmatrix}\n$$\n接下来，我们在特定物质点 $\\mathbf{X}=(0.2, -0.1, 0.3)$ 处计算 $\\mathbf{F}$：\n$$\nF_{11} = 1+0.2 = 1.2\n$$\n$$\nF_{12} = -0.1\n$$\n$$\nF_{13} = 0\n$$\n$$\nF_{21} = 0\n$$\n$$\nF_{22} = 1+(0.3)^2 = 1+0.09 = 1.09\n$$\n$$\nF_{23} = 2(-0.1)(0.3) = -0.06\n$$\n$$\nF_{31} = 0.3 + 0.06(0.3) = 0.3 + 0.018 = 0.318\n$$\n$$\nF_{32} = 0\n$$\n$$\nF_{33} = 1 + 0.06(0.2) = 1 + 0.012 = 1.012\n$$\n因此，在给定点处 $\\mathbf{F}$ 的数值矩阵为：\n$$\n\\mathbf{F} =\n\\begin{pmatrix}\n1.2  & -0.1  & 0 \\\\\n0  & 1.09  & -0.06 \\\\\n0.318  & 0  & 1.012\n\\end{pmatrix}\n$$\n问题将参考向量 $\\mathbf{V}$ 的前推定义为空间向量 $\\mathbf{v} = \\mathbf{F}\\mathbf{V}$。给定参考向量 $\\mathbf{V}=(2, -1, 3)$，我们计算 $\\mathbf{v}$：\n$$\n\\mathbf{v} = \\begin{pmatrix} v_1 \\\\ v_2 \\\\ v_3 \\end{pmatrix} =\n\\begin{pmatrix}\n1.2  & -0.1  & 0 \\\\\n0  & 1.09  & -0.06 \\\\\n0.318  & 0  & 1.012\n\\end{pmatrix}\n\\begin{pmatrix} 2 \\\\ -1 \\\\ 3 \\end{pmatrix}\n$$\n$$\nv_1 = (1.2)(2) + (-0.1)(-1) + (0)(3) = 2.4 + 0.1 = 2.5\n$$\n$$\nv_2 = (0)(2) + (1.09)(-1) + (-0.06)(3) = -1.09 - 0.18 = -1.27\n$$\n$$\nv_3 = (0.318)(2) + (0)(-1) + (1.012)(3) = 0.636 + 3.036 = 3.672\n$$\n因此，空间向量为 $\\mathbf{v}=(2.5, -1.27, 3.672)$。\n\n问题将空间协向量 $\\mathbf{a}$ 的拉回定义为参考协向量 $\\mathbf{A} = \\mathbf{F}^T \\mathbf{a}$。给定空间协向量 $\\mathbf{a}=(1, 4, -2)$，我们首先求出 $\\mathbf{F}$ 的转置：\n$$\n\\mathbf{F}^T =\n\\begin{pmatrix}\n1.2  & 0  & 0.318 \\\\\n-0.1  & 1.09  & 0 \\\\\n0  & -0.06  & 1.012\n\\end{pmatrix}\n$$\n现在我们计算 $\\mathbf{A}$：\n$$\n\\mathbf{A} = \\begin{pmatrix} A_1 \\\\ A_2 \\\\ A_3 \\end{pmatrix} =\n\\begin{pmatrix}\n1.2  & 0  & 0.318 \\\\\n-0.1  & 1.09  & 0 \\\\\n0  & -0.06  & 1.012\n\\end{pmatrix}\n\\begin{pmatrix} 1 \\\\ 4 \\\\ -2 \\end{pmatrix}\n$$\n$$\nA_1 = (1.2)(1) + (0)(4) + (0.318)(-2) = 1.2 - 0.636 = 0.564\n$$\n$$\nA_2 = (-0.1)(1) + (1.09)(4) + (0)(-2) = -0.1 + 4.36 = 4.26\n$$\n$$\nA_3 = (0)(1) + (-0.06)(4) + (1.012)(-2) = -0.24 - 2.024 = -2.264\n$$\n因此，参考协向量为 $\\mathbf{A}=(0.564, 4.26, -2.264)$。\n\n最后，我们必须验证对偶配对保持不变，即 $\\mathbf{a} \\cdot \\mathbf{v} = \\mathbf{A} \\cdot \\mathbf{V}$。我们分别计算每个点积。\n在当前构型中的对偶配对是：\n$$\n\\mathbf{a} \\cdot \\mathbf{v} = (1)(2.5) + (4)(-1.27) + (-2)(3.672) = 2.5 - 5.08 - 7.344 = -9.924\n$$\n在参考构型中的对偶配对是：\n$$\n\\mathbf{A} \\cdot \\mathbf{V} = (0.564)(2) + (4.26)(-1) + (-2.264)(3) = 1.128 - 4.26 - 6.792 = -9.924\n$$\n数值验证证实了 $\\mathbf{a} \\cdot \\mathbf{v} = \\mathbf{A} \\cdot \\mathbf{V} = -9.924$。问题要求的就是这个共同值。",
            "answer": "$$\n\\boxed{-9.924}\n$$"
        },
        {
            "introduction": "在掌握了基本矢量运算后，我们将这些概念应用于一个核心的物理关系：牵引力。本练习探讨了面积微元和作用力在不同构型间的转换，这需要用到南森公式（Nanson's formula）。通过对比正确与一个看似合理但错误的公式，本题将揭示为何使用正确的拉回操作（即 $\\mathbf{F}^{-\\mathsf{T}}$）对于保证物理定律的客观性至关重要，这是连续介质力学的一块基石。",
            "id": "3591936",
            "problem": "考虑一个在三维（3D）欧几里得空间中进行纯刚性旋转的均匀弹性体。设运动映射为 $\\boldsymbol{\\varphi}(\\mathbf{X}) = \\mathbf{R}\\,\\mathbf{X}$，其中 $\\mathbf{X}$ 是参考构型中的物质点，$\\mathbf{R} \\in \\mathrm{SO}(3)$ 是一个正交旋转。变形梯度为 $\\mathbf{F} = \\nabla \\boldsymbol{\\varphi} = \\mathbf{R}$，雅可比行列式为 $J = \\det(\\mathbf{F}) = 1$。空间柯西应力是均匀的，在当前构型中由下式给出：\n$$\n\\boldsymbol{\\sigma} = \\begin{pmatrix}\n2  & 0  & 0 \\\\\n0  & 1  & 0 \\\\\n0  & 0  & 3\n\\end{pmatrix}.\n$$\n参考构型中的一个物质面元的单位法向量为 $\\mathbf{N} = \\mathbf{e}_{1}$，其中 $\\mathbf{e}_{1}$ 是第一个笛卡尔基向量。\n\n仅从连续介质力学中面力的定义以及参考和当前面积元之间的关系出发，推导参考表面上单位参考面积的名义面力 $\\mathbf{T}_{\\text{true}}$ 关于柯西应力 $\\boldsymbol{\\sigma}$ 和旋转 $\\mathbf{R}$ 的正确表达式。然后，考虑在面积变换中用 $\\mathbf{F}^{T}$ 错误地替代 $\\mathbf{F}^{-T}$ 的做法，这会导出一个不正确的名义面力 $\\mathbf{T}_{\\text{wrong}}$。使用绕z轴旋转角度 $\\theta = \\pi/3$ 弧度的刚性旋转，\n$$\n\\mathbf{R} = \\begin{pmatrix}\n\\cos\\theta  & -\\sin\\theta  & 0 \\\\\n\\sin\\theta  & \\cos\\theta  & 0 \\\\\n0  & 0  & 1\n\\end{pmatrix},\n$$\n为给定的 $\\boldsymbol{\\sigma}$ 和 $\\mathbf{N}$ 显式计算 $\\mathbf{T}_{\\text{true}}$ 和 $\\mathbf{T}_{\\text{wrong}}$。\n\n最后，通过计算相对误差\n$$\ne \\;=\\; \\frac{\\left\\|\\mathbf{T}_{\\text{wrong}} - \\mathbf{T}_{\\text{true}}\\right\\|}{\\left\\|\\mathbf{T}_{\\text{true}}\\right\\|},\n$$\n来量化使用 $\\mathbf{F}^{T}$ 而非 $\\mathbf{F}^{-T}$ 所引入的非客观性，其中 $\\|\\cdot\\|$ 表示欧几里得范数。请以单个简化的精确表达式给出你的最终答案。不要四舍五入；$e$ 是无量纲的，因此不需要单位。",
            "solution": "该问题被验证为具有科学依据、提法恰当且客观。这是一个连续介质力学中的标准问题，旨在检验对参考构型和当前构型之间的面力向量、应力度量和面积元变换的理解。\n\n第一步是推导名义面力向量 $\\mathbf{T}_{\\text{true}}$ 的正确表达式。名义面力 $\\mathbf{T}$ 定义为作用在当前构型中一个面元上的力 $d\\mathbf{f}$，但按相应的参考构型中面元的单位面积 $dA$ 计算。因此，$d\\mathbf{f} = \\mathbf{T} \\, dA$。\n\n力 $d\\mathbf{f}$ 也可以用柯西应力 $\\boldsymbol{\\sigma}$ 和当前构型中的面积元 $da$ 来表示。柯西面力 $\\mathbf{t}$ 是单位当前面积上的力，由柯西定律给出：$\\mathbf{t} = \\boldsymbol{\\sigma} \\mathbf{n}$，其中 $\\mathbf{n}$ 是当前构型中表面的单位法向量。于是力为 $d\\mathbf{f} = \\mathbf{t} \\, da = (\\boldsymbol{\\sigma} \\mathbf{n}) \\, da$。\n\n令两种力的表达式相等，得到：\n$$\n\\mathbf{T} \\, dA = \\boldsymbol{\\sigma} \\mathbf{n} \\, da\n$$\n参考面积元向量 $\\mathbf{N} \\, dA$ 和当前面积元向量 $\\mathbf{n} \\, da$ 之间的关系由 Nanson 公式给出：\n$$\n\\mathbf{n} \\, da = J \\mathbf{F}^{-T} \\mathbf{N} \\, dA\n$$\n其中 $\\mathbf{F}$ 是变形梯度，$J = \\det(\\mathbf{F})$ 是其行列式，$\\mathbf{N}$ 是参考构型中表面的单位法向量。\n\n将 Nanson 公式代入力平衡方程，得到：\n$$\n\\mathbf{T} \\, dA = \\boldsymbol{\\sigma} (J \\mathbf{F}^{-T} \\mathbf{N}) \\, dA\n$$\n除以标量面积元 $dA$ 得到名义面力向量的一般表达式：\n$$\n\\mathbf{T} = J \\boldsymbol{\\sigma} \\mathbf{F}^{-T} \\mathbf{N}\n$$\n这就是真实的名义面力，$\\mathbf{T}_{\\text{true}}$。对于给定问题，运动是纯刚性旋转，因此变形梯度是一个正交矩阵，$\\mathbf{F} = \\mathbf{R} \\in \\mathrm{SO}(3)$。对于正交矩阵，其逆等于其转置，$\\mathbf{R}^{-1} = \\mathbf{R}^{T}$。因此，项 $\\mathbf{F}^{-T}$ 变为 $(\\mathbf{R}^{-1})^{T} = (\\mathbf{R}^{T})^{T} = \\mathbf{R}$。雅可比行列式为 $J = \\det(\\mathbf{R}) = 1$。将这些代入通用公式，得到：\n$$\n\\mathbf{T}_{\\text{true}} = (1) \\boldsymbol{\\sigma} \\mathbf{R} \\mathbf{N} = \\boldsymbol{\\sigma} \\mathbf{R} \\mathbf{N}\n$$\n问题通过在通用公式中错误地用 $\\mathbf{F}^{T}$ 替换 $\\mathbf{F}^{-T}$ 来定义一个错误的面力向量 $\\mathbf{T}_{\\text{wrong}}$。当 $\\mathbf{F} = \\mathbf{R}$ 且 $J=1$ 时，这得到：\n$$\n\\mathbf{T}_{\\text{wrong}} = J \\boldsymbol{\\sigma} \\mathbf{F}^{T} \\mathbf{N} = (1) \\boldsymbol{\\sigma} \\mathbf{R}^{T} \\mathbf{N} = \\boldsymbol{\\sigma} \\mathbf{R}^{T} \\mathbf{N}\n$$\n接下来，我们为给定的特定旋转和应力状态计算这些向量。旋转角为 $\\theta = \\pi/3$，所以 $\\cos(\\theta) = 1/2$ 且 $\\sin(\\theta) = \\sqrt{3}/2$。旋转矩阵 $\\mathbf{R}$ 及其转置 $\\mathbf{R}^T$ 为：\n$$\n\\mathbf{R} = \\begin{pmatrix} \\frac{1}{2}  & -\\frac{\\sqrt{3}}{2}  & 0 \\\\ \\frac{\\sqrt{3}}{2}  & \\frac{1}{2}  & 0 \\\\ 0  & 0  & 1 \\end{pmatrix}, \\quad \\mathbf{R}^{T} = \\begin{pmatrix} \\frac{1}{2}  & \\frac{\\sqrt{3}}{2}  & 0 \\\\ -\\frac{\\sqrt{3}}{2}  & \\frac{1}{2}  & 0 \\\\ 0  & 0  & 1 \\end{pmatrix}\n$$\n参考法向量为 $\\mathbf{N} = \\mathbf{e}_{1} = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}$，柯西应力为 $\\boldsymbol{\\sigma} = \\begin{pmatrix} 2  & 0  & 0 \\\\ 0  & 1  & 0 \\\\ 0  & 0  & 3 \\end{pmatrix}$。\n\n我们首先计算 $\\mathbf{T}_{\\text{true}} = \\boldsymbol{\\sigma} \\mathbf{R} \\mathbf{N}$：\n$$\n\\mathbf{R} \\mathbf{N} = \\begin{pmatrix} \\frac{1}{2}  & -\\frac{\\sqrt{3}}{2}  & 0 \\\\ \\frac{\\sqrt{3}}{2}  & \\frac{1}{2}  & 0 \\\\ 0  & 0  & 1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{2} \\\\ \\frac{\\sqrt{3}}{2} \\\\ 0 \\end{pmatrix}\n$$\n$$\n\\mathbf{T}_{\\text{true}} = \\boldsymbol{\\sigma} (\\mathbf{R} \\mathbf{N}) = \\begin{pmatrix} 2  & 0  & 0 \\\\ 0  & 1  & 0 \\\\ 0  & 0  & 3 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{2} \\\\ \\frac{\\sqrt{3}}{2} \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 2 \\times \\frac{1}{2} \\\\ 1 \\times \\frac{\\sqrt{3}}{2} \\\\ 3 \\times 0 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ \\frac{\\sqrt{3}}{2} \\\\ 0 \\end{pmatrix}\n$$\n接下来，我们计算 $\\mathbf{T}_{\\text{wrong}} = \\boldsymbol{\\sigma} \\mathbf{R}^{T} \\mathbf{N}$：\n$$\n\\mathbf{R}^{T} \\mathbf{N} = \\begin{pmatrix} \\frac{1}{2}  & \\frac{\\sqrt{3}}{2}  & 0 \\\\ -\\frac{\\sqrt{3}}{2}  & \\frac{1}{2}  & 0 \\\\ 0  & 0  & 1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{2} \\\\ -\\frac{\\sqrt{3}}{2} \\\\ 0 \\end{pmatrix}\n$$\n$$\n\\mathbf{T}_{\\text{wrong}} = \\boldsymbol{\\sigma} (\\mathbf{R}^{T} \\mathbf{N}) = \\begin{pmatrix} 2  & 0  & 0 \\\\ 0  & 1  & 0 \\\\ 0  & 0  & 3 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{2} \\\\ -\\frac{\\sqrt{3}}{2} \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 2 \\times \\frac{1}{2} \\\\ 1 \\times (-\\frac{\\sqrt{3}}{2}) \\\\ 3 \\times 0 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ -\\frac{\\sqrt{3}}{2} \\\\ 0 \\end{pmatrix}\n$$\n最后，我们计算相对误差 $e = \\left\\|\\mathbf{T}_{\\text{wrong}} - \\mathbf{T}_{\\text{true}}\\right\\| / \\left\\|\\mathbf{T}_{\\text{true}}\\right\\|$。\n差向量为：\n$$\n\\mathbf{T}_{\\text{wrong}} - \\mathbf{T}_{\\text{true}} = \\begin{pmatrix} 1 \\\\ -\\frac{\\sqrt{3}}{2} \\\\ 0 \\end{pmatrix} - \\begin{pmatrix} 1 \\\\ \\frac{\\sqrt{3}}{2} \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ -\\sqrt{3} \\\\ 0 \\end{pmatrix}\n$$\n差向量的欧几里得范数为：\n$$\n\\left\\|\\mathbf{T}_{\\text{wrong}} - \\mathbf{T}_{\\text{true}}\\right\\| = \\sqrt{0^2 + (-\\sqrt{3})^2 + 0^2} = \\sqrt{3}\n$$\n真实面力向量的欧几里得范数为：\n$$\n\\left\\|\\mathbf{T}_{\\text{true}}\\right\\| = \\sqrt{1^2 + \\left(\\frac{\\sqrt{3}}{2}\\right)^2 + 0^2} = \\sqrt{1 + \\frac{3}{4}} = \\sqrt{\\frac{7}{4}} = \\frac{\\sqrt{7}}{2}\n$$\n相对误差是这两个范数的比值：\n$$\ne = \\frac{\\left\\|\\mathbf{T}_{\\text{wrong}} - \\mathbf{T}_{\\text{true}}\\right\\|}{\\left\\|\\mathbf{T}_{\\text{true}}\\right\\|} = \\frac{\\sqrt{3}}{\\frac{\\sqrt{7}}{2}} = \\frac{2\\sqrt{3}}{\\sqrt{7}}\n$$\n为了使分母有理化，我们将分子和分母同乘以 $\\sqrt{7}$：\n$$\ne = \\frac{2\\sqrt{3}\\sqrt{7}}{\\sqrt{7}\\sqrt{7}} = \\frac{2\\sqrt{21}}{7}\n$$",
            "answer": "$$\\boxed{\\frac{2\\sqrt{21}}{7}}$$"
        },
        {
            "introduction": "作为本章的收尾，我们将从手动计算过渡到计算实现，这是计算固体力学领域的一项关键技能。这个最终练习要求你将整个四阶材料弹性张量推向前，得到其空间对应形式。通过编写代码来执行这一变换，并验证其主、次对称性的保持情况，你将对如何在数值分析中正确地在空间构型中表达材料本构关系获得深刻的实践理解。",
            "id": "3591937",
            "problem": "给定一个三维材料弹性张量，在参考构型中以指数形式表示为四阶张量，其分量为 $\\,\\mathbb{C}_{IJKL}\\,$，以及一个变形梯度，其分量为 $\\,F_{iI}\\,$，其雅可比行列式为 $\\,J = \\det F\\,$ 且 $\\,J \\gt 0\\,$。从计算固体力学的第一性原理出发，通过对所有容许的自变量，强制其与 Cauchy 应力张量从 Second Piola–Kirchhoff 应力张量转换的定律保持一致，推导将材料弹性张量 $\\,\\mathbb{C}_{IJKL}\\,$ 转换为其空间对应张量（分量为 $\\,c_{ijkl}\\,$）的精确推前映射 (push-forward mapping)。您的推导必须仅从以下基本定义和事实出发：\n- 变形梯度 $\\,F\\,$ 映射微分线元，并在不同构型之间转换二阶张量。\n- Cauchy 应力张量 $\\,\\sigma\\,$ 和 Second Piola–Kirchhoff 应力张量 $\\,S\\,$ 之间的关系为 $\\,\\sigma = \\dfrac{1}{J} F S F^{\\mathsf{T}}\\,$.\n- 材料弹性张量 $\\,\\mathbb{C}\\,$ 通过 $\\,\\mathrm{d}S = \\mathbb{C} : \\mathrm{d}E\\,$ 将材料应变度量 $\\,E\\,$ 的变分映射到 $\\,S\\,$ 的变分。\n\n推导出映射后，将其实现为一个程序，该程序：\n- 为参考构型中的各向同性、框架无关、超弹性固体构建 $\\,\\mathbb{C}_{IJKL}\\,$, 其 Lamé 参数 $\\,\\lambda\\,$ 和 $\\,\\mu\\,$ 由 $\\,\\lambda = 5.0\\,$ 和 $\\,\\mu = 2.0\\,$ 给出（无量纲）。\n- 应用您推导的推前映射，为下面测试套件中的每个变形梯度计算 $\\,c_{ijkl}\\,$。\n- 验证映射后材料张量对称性的保持情况：\n  1. 次对称性 (Minor symmetries)：$\\,c_{ijkl} = c_{jikl}\\,$ 和 $\\,c_{ijkl} = c_{ijlk}\\,$。\n  2. 主对称性 (Major symmetry)：$\\,c_{ijkl} = c_{klij}\\,$。\n- 仅当变形梯度为正常正交张量（纯旋转），定义为 $\\,F^{\\mathsf{T}} F = I\\,$ 和 $\\,J = 1\\,$ 时，计算一个布尔标志来表示旋转不变性。在这种情况下，检查推前的张量 $\\,c_{ijkl}\\,$ 是否在数值上等于直接在空间构型中由相同的 Lamé 参数 $\\,\\lambda\\,$ 和 $\\,\\mu\\,$ 得到的各向同性张量。对于非纯旋转的变形梯度，将此标志设置为 False。\n\n所有对称性检查必须使用相对容差 $\\,\\varepsilon = 10^{-10}\\,$ 进行，该容差通过比较最大绝对对称性破坏量与 $\\,c_{ijkl}\\,$ 的最大绝对分量值来定义。旋转不变性检查必须使用相同的相对容差。本问题不需要物理单位，也不涉及角度。\n\n测试套件：\n- 使用 $\\,\\lambda = 5.0\\,$ 和 $\\,\\mu = 2.0\\,$。\n- 评估以下五个变形梯度：\n  1. 单位矩阵：$\\,F^{(1)} = \\begin{bmatrix} 1.0  & 0.0  & 0.0 \\\\ 0.0  & 1.0  & 0.0 \\\\ 0.0  & 0.0  & 1.0 \\end{bmatrix}\\,$.\n  2. 绕 $\\,z\\,$ 轴旋转 $\\,\\pi/2\\,$ 弧度的纯旋转：$\\,F^{(2)} = \\begin{bmatrix} 0.0  & -1.0  & 0.0 \\\\ 1.0  & 0.0  & 0.0 \\\\ 0.0  & 0.0  & 1.0 \\end{bmatrix}\\,$.\n  3. 纯拉伸：$\\,F^{(3)} = \\mathrm{diag}(1.2,\\, 0.8,\\, 1.0)\\,$.\n  4. 剪切参数为 $\\,\\gamma = 0.5\\,$ 的简单剪切：$\\,F^{(4)} = \\begin{bmatrix} 1.0  & 0.5  & 0.0 \\\\ 0.0  & 1.0  & 0.0 \\\\ 0.0  & 0.0  & 1.0 \\end{bmatrix}\\,$.\n  5. 接近奇异但容许的拉伸：$\\,F^{(5)} = \\mathrm{diag}(0.1,\\, 0.9,\\, 1.1)\\,$.\n\n程序要求和输出：\n- 在参考构型中，使用标准的各向同性表达式，根据 $\\,\\lambda\\,$ 和 $\\,\\mu\\,$ 构建 $\\,\\mathbb{C}_{IJKL}\\,$。\n- 为每个 $\\,F^{(n)}\\,$ 实现您的精确推前映射以获得 $\\,c_{ijkl}\\,$。\n- 对于每个测试用例 $\\,n \\in \\{1,2,3,4,5\\}\\,$，生成一个包含三个布尔值的列表 $\\,[\\text{minor\\_ok}, \\text{major\\_ok}, \\text{rotation\\_invariance\\_ok}]\\,$，如上所定义。\n- 您的程序应生成单行输出，其中包含所有五个测试用例的结果，格式为方括号内以逗号分隔的列表，其中每个元素是按顺序排列的针对一个测试用例的三个布尔值的列表。例如，输出格式必须与 $\\,[[\\cdot,\\cdot,\\cdot],[\\cdot,\\cdot,\\cdot],[\\cdot,\\cdot,\\cdot],[\\cdot,\\cdot,\\cdot],[\\cdot,\\cdot,\\cdot]]\\,$ 完全一致，不得包含任何多余文本。",
            "solution": "问题陈述已经过仔细审查，并被确定为 **有效**。它在科学上基于连续介质力学原理，问题定义明确，目标清晰，数据充分，并使用精确、客观的语言进行阐述。该问题是**非线性固体力学**中一个标准的、有一定难度的练习，既需要形式推导，也需要严谨的数值实现。\n\n### 弹性张量推前映射的推导\n\n目标是推导将材料（或参考）弹性张量 $\\mathbb{C}_{IJKL}$ 映射到其空间（或当前）对应张量 $c_{ijkl}$ 的转换。这可以通过要求两种构型中的本构关系保持一致来实现，而最好的表述方式是关联应力和应变的客观率。\n\n**1. 基本关系和客观率**\n\n我们给定以下核心关系：\n- 对称的 Cauchy 应力张量 $\\boldsymbol{\\sigma}$（在空间构型中）与对称的 Second Piola-Kirchhoff (2nd P-K) 应力张量 $\\mathbf{S}$（在材料构型中）之间的关系：\n$$\n\\boldsymbol{\\sigma} = \\frac{1}{J} \\mathbf{F} \\mathbf{S} \\mathbf{F}^{\\mathsf{T}} \\quad \\text{其中 } J = \\det(\\mathbf{F})\n$$\n使用 Kirchhoff 应力张量 $\\boldsymbol{\\tau} = J\\boldsymbol{\\sigma}$ 更为方便，它将关系简化为：\n$$\n\\boldsymbol{\\tau} = \\mathbf{F} \\mathbf{S} \\mathbf{F}^{\\mathsf{T}}\n$$\n- 材料本构律，通过四阶材料弹性张量 $\\mathbb{C}$ 将 2nd P-K 应力率 $\\dot{\\mathbf{S}}$ 与 Green-Lagrange 应变张量率 $\\dot{\\mathbf{E}}$ 相关联：\n$$\n\\dot{\\mathbf{S}} = \\mathbb{C} : \\dot{\\mathbf{E}} \\quad \\text{或以指数形式表示为,} \\quad \\dot{S}_{IJ} = \\mathbb{C}_{IJKL} \\dot{E}_{KL}\n$$\n\n为了建立一致的空间本构律，我们必须使用空间量的客观（框架无关）时间导数。一个标准的选择是 Lie 导数 $\\mathcal{L}_v$。空间本构律将应力张量的 Lie 导数与空间变形率张量 $\\mathbf{d}$ 相关联。张量 $\\mathbf{d}$ 是空间速度梯度 $\\mathbf{l} = \\dot{\\mathbf{F}}\\mathbf{F}^{-1}$ 的对称部分，即 $\\mathbf{d} = \\frac{1}{2}(\\mathbf{l} + \\mathbf{l}^{\\mathsf{T}})$。\n\n**2. 运动学和应力率转换**\n\n首先，我们将材料应变率 $\\dot{\\mathbf{E}}$ 与空间变形率 $\\mathbf{d}$ 联系起来。Green-Lagrange 应变张量为 $\\mathbf{E} = \\frac{1}{2}(\\mathbf{F}^{\\mathsf{T}}\\mathbf{F} - \\mathbf{I})$。其物质时间导数为：\n$$\n\\dot{\\mathbf{E}} = \\frac{1}{2}(\\dot{\\mathbf{F}}^{\\mathsf{T}}\\mathbf{F} + \\mathbf{F}^{\\mathsf{T}}\\dot{\\mathbf{F}})\n$$\n代入 $\\dot{\\mathbf{F}} = \\mathbf{l}\\mathbf{F}$：\n$$\n\\dot{\\mathbf{E}} = \\frac{1}{2}((\\mathbf{l}\\mathbf{F})^{\\mathsf{T}}\\mathbf{F} + \\mathbf{F}^{\\mathsf{T}}(\\mathbf{l}\\mathbf{F})) = \\frac{1}{2}(\\mathbf{F}^{\\mathsf{T}}\\mathbf{l}^{\\mathsf{T}}\\mathbf{F} + \\mathbf{F}^{\\mathsf{T}}\\mathbf{l}\\mathbf{F}) = \\mathbf{F}^{\\mathsf{T}} \\left( \\frac{1}{2}(\\mathbf{l}^{\\mathsf{T}} + \\mathbf{l}) \\right) \\mathbf{F} = \\mathbf{F}^{\\mathsf{T}} \\mathbf{d} \\mathbf{F}\n$$\n这个操作，$\\dot{\\mathbf{E}} = \\mathbf{F}^{\\mathsf{T}} \\mathbf{d} \\mathbf{F}$，是将空间变形率张量 $\\mathbf{d}$ 拉回 (pull-back) 到参考构型。\n\n接下来，我们建立应力率的转换关系。连续介质力学中的一个基本结果是，Kirchhoff 应力张量的 Lie 导数 $\\mathcal{L}_v \\boldsymbol{\\tau}$ 是 2nd P-K 应力张量的物质时间导数 $\\dot{\\mathbf{S}}$ 的推前 (push-forward)：\n$$\n\\mathcal{L}_v \\boldsymbol{\\tau} = \\mathbf{F} \\dot{\\mathbf{S}} \\mathbf{F}^{\\mathsf{T}}\n$$\n其中 $(\\mathcal{L}_v \\boldsymbol{\\tau})_{ij} = \\dot{\\tau}_{ij} - l_{ik}\\tau_{kj} - \\tau_{ik}l_{kj}$。\n\n**3. 空间弹性张量的推导**\n\n我们现在可以结合这些关系来推导空间本构律。\n从应力率转换开始：\n$$\n\\mathcal{L}_v \\boldsymbol{\\tau} = \\mathbf{F} \\dot{\\mathbf{S}} \\mathbf{F}^{\\mathsf{T}}\n$$\n代入材料本构律，$\\dot{\\mathbf{S}} = \\mathbb{C} : \\dot{\\mathbf{E}}$：\n$$\n\\mathcal{L}_v \\boldsymbol{\\tau} = \\mathbf{F} (\\mathbb{C} : \\dot{\\mathbf{E}}) \\mathbf{F}^{\\mathsf{T}}\n$$\n现在，代入运动学关系 $\\dot{\\mathbf{E}} = \\mathbf{F}^{\\mathsf{T}} \\mathbf{d} \\mathbf{F}$：\n$$\n\\mathcal{L}_v \\boldsymbol{\\tau} = \\mathbf{F} (\\mathbb{C} : (\\mathbf{F}^{\\mathsf{T}} \\mathbf{d} \\mathbf{F})) \\mathbf{F}^{\\mathsf{T}}\n$$\n为了使结构清晰，我们用指数形式写出。令大写指数 ($I, J, K, L$) 表示材料构型，小写指数 ($i, j, k, l$) 表示空间构型。\n$$\n(\\mathcal{L}_v \\boldsymbol{\\tau})_{ij} = F_{iI} (\\dot{S}_{IJ}) F_{jJ}\n$$\n$$\n\\dot{S}_{IJ} = \\mathbb{C}_{IJKL} \\dot{E}_{KL} = \\mathbb{C}_{IJKL} (F_{kK} d_{kl} F_{lL})\n$$\n将 $\\dot{S}_{IJ}$ 代入 $(\\mathcal{L}_v \\boldsymbol{\\tau})_{ij}$ 的表达式中：\n$$\n(\\mathcal{L}_v \\boldsymbol{\\tau})_{ij} = F_{iI} (\\mathbb{C}_{IJKL} F_{kK} d_{kl} F_{lL}) F_{jJ}\n$$\n重新排列各项（因为它们都是对重复指数求和的标量）：\n$$\n(\\mathcal{L}_v \\boldsymbol{\\tau})_{ij} = (F_{iI} F_{jJ} F_{kK} F_{lL} \\mathbb{C}_{IJKL}) d_{kl}\n$$\n空间本构律将一个客观应力率与变形率相关联，通常表示为 $\\mathcal{L}_v \\boldsymbol{\\tau} = \\mathbf{c}_{\\tau} : \\mathbf{d}$，其中 $\\mathbf{c}_{\\tau}$ 是对应于 Kirchhoff 应力的空间弹性张量。通过比较，我们确定其分量为：\n$$\n(c_{\\tau})_{ijkl} = F_{iI} F_{jJ} F_{kK} F_{lL} \\mathbb{C}_{IJKL}\n$$\n问题要求的是与 Cauchy 应力转换相一致的 $\\mathbb{C}_{IJKL}$ 的空间对应张量。这对应于将 Cauchy 应力的 Truesdell 率 $\\boldsymbol{\\sigma}^\\nabla$ 与 $\\mathbf{d}$ 相关联的张量，其中 $\\boldsymbol{\\sigma}^\\nabla = \\frac{1}{J}\\mathcal{L}_v \\boldsymbol{\\tau}$。其关系为 $\\boldsymbol{\\sigma}^\\nabla = \\mathbf{c} : \\mathbf{d}$。\n由此，我们得到 $\\mathbf{c} = \\frac{1}{J}\\mathbf{c}_{\\tau}$。因此，空间弹性张量 $\\mathbf{c}$ 的分量是：\n$$\nc_{ijkl} = \\frac{1}{J} F_{iI} F_{jJ} F_{kK} F_{lL} \\mathbb{C}_{IJKL}\n$$\n这就是所要求的推前映射。\n\n**4. 对称性的保持**\n\n对于超弹性材料，材料张量 $\\mathbb{C}_{IJKL}$ 具有次对称性 ($\\mathbb{C}_{IJKL} = \\mathbb{C}_{JIKL}$ 和 $\\mathbb{C}_{IJKL} = \\mathbb{C}_{IJLK}$) 和主对称性 ($\\mathbb{C}_{IJKL} = \\mathbb{C}_{KLIJ}$)。推导出的推前映射会保持这些对称性。例如，为了证明第一个次对称性 $c_{ijkl} = c_{jikl}$：\n\\begin{align*}\nc_{jikl} &= \\frac{1}{J} F_{jI} F_{iJ} F_{kK} F_{lL} \\mathbb{C}_{IJKL} \\\\\n&= \\frac{1}{J} F_{jJ} F_{iI} F_{kK} F_{lL} \\mathbb{C}_{JIKL} \\quad (\\text{交换哑指标 } I \\leftrightarrow J) \\\\\n&= \\frac{1}{J} F_{iI} F_{jJ} F_{kK} F_{lL} \\mathbb{C}_{IJKL} \\quad (\\text{使用 } \\mathbb{C}_{JIKL} = \\mathbb{C}_{IJKL} \\text{ 并重新排列各项}) \\\\\n&= c_{ijkl}\n\\end{align*}\n对于其他次对称性和主对称性，也存在类似的证明，这证实了如果 $\\mathbb{C}$ 具有这些对称性，那么推前的张量 $c$ 也将具有这些对称性。\n\n**5. 材料和空间各向同性张量**\n\n对于各向同性材料，参考构型中的弹性张量 $\\mathbb{C}$ 由下式给出：\n$$\n\\mathbb{C}_{IJKL} = \\lambda \\delta_{IJ} \\delta_{KL} + \\mu (\\delta_{IK} \\delta_{JL} + \\delta_{IL} \\delta_{JK})\n$$\n如果变形是纯旋转，即 $\\mathbf{F} \\in SO(3)$，那么 $\\mathbf{F}^{\\mathsf{T}}\\mathbf{F} = \\mathbf{I}$ 且 $J=1$。推前操作简化，在空间构型中产生相同的各向同性形式：\n$$\nc_{ijkl} = \\lambda \\delta_{ij} \\delta_{kl} + \\mu (\\delta_{ik} \\delta_{jl} + \\delta_{il} \\delta_{jk})\n$$\n这个属性，即所谓的材料框架无关性，将通过数值进行验证。\n\n以下 Python 代码实现了这个推导出的映射，并执行了所要求的检查。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and implements the push-forward of the material elasticity tensor,\n    verifying symmetry and rotational invariance properties.\n    \"\"\"\n    \n    # Define Lamé parameters and tolerance\n    lambda_ = 5.0\n    mu = 2.0\n    tol = 1e-10\n\n    # Define the test suite of deformation gradients\n    test_cases = [\n        # 1. Identity\n        np.array([[1.0, 0.0, 0.0], [0.0, 1.0, 0.0], [0.0, 0.0, 1.0]]),\n        # 2. Pure rotation about z-axis by pi/2\n        np.array([[0.0, -1.0, 0.0], [1.0, 0.0, 0.0], [0.0, 0.0, 1.0]]),\n        # 3. Pure stretch\n        np.array([[1.2, 0.0, 0.0], [0.0, 0.8, 0.0], [0.0, 0.0, 1.0]]),\n        # 4. Simple shear\n        np.array([[1.0, 0.5, 0.0], [0.0, 1.0, 0.0], [0.0, 0.0, 1.0]]),\n        # 5. Nearly singular stretch\n        np.array([[0.1, 0.0, 0.0], [0.0, 0.9, 0.0], [0.0, 0.0, 1.1]]),\n    ]\n    \n    # Construct the isotropic material elasticity tensor C_IJKL\n    delta = np.identity(3)\n    # C_IJKL = lambda * delta_IJ * delta_KL + mu * (delta_IK * delta_JL + delta_IL * delta_JK)\n    C_material = (lambda_ * np.einsum('ij,kl->ijkl', delta, delta, optimize=True) +\n                  mu * (np.einsum('ik,jl->ijkl', delta, delta, optimize=True) +\n                        np.einsum('il,jk->ijkl', delta, delta, optimize=True)))\n\n    results = []\n    \n    for F in test_cases:\n        # Calculate the Jacobian determinant\n        J = np.linalg.det(F)\n        if J == 0:\n            raise ValueError(\"Deformation gradient must have a positive determinant.\")\n\n        # Perform the push-forward operation: c_ijkl = (1/J) * F_iI * F_jJ * F_kK * F_lL * C_IJKL\n        c_spatial = (1.0 / J) * np.einsum('iI,jJ,kK,lL,IJKL->ijkl', F, F, F, F, C_material, optimize=True)\n\n        c_max = np.max(np.abs(c_spatial))\n        \n        # --- Symmetry Checks ---\n        \n        # 1. Minor symmetries: c_ijkl = c_jikl and c_ijkl = c_ijlk\n        err_minor1 = np.max(np.abs(c_spatial - np.transpose(c_spatial, (1, 0, 2, 3))))\n        err_minor2 = np.max(np.abs(c_spatial - np.transpose(c_spatial, (0, 1, 3, 2))))\n        \n        # The check must handle the case where c_max is zero.\n        minor_ok = True\n        if c_max > 0:\n            if (err_minor1 / c_max >= tol) or (err_minor2 / c_max >= tol):\n                minor_ok = False\n        elif err_minor1 > 0 or err_minor2 > 0:\n            minor_ok = False\n            \n        # 2. Major symmetry: c_ijkl = c_klij\n        err_major = np.max(np.abs(c_spatial - np.transpose(c_spatial, (2, 3, 0, 1))))\n        \n        major_ok = True\n        if c_max > 0:\n            if err_major / c_max >= tol:\n                major_ok = False\n        elif err_major > 0:\n            major_ok = False\n\n        # --- Rotation-Invariance Check ---\n        \n        rotation_invariance_ok = False\n        # Check if F is a proper orthogonal tensor (rotation)\n        # F.T @ F = I and det(F) = 1\n        is_rotation = np.allclose(F.T @ F, np.identity(3), atol=tol) and np.isclose(J, 1.0, atol=tol)\n        \n        if is_rotation:\n            # Construct the isotropic tensor directly in the spatial configuration\n            c_iso_spatial = (lambda_ * np.einsum('ij,kl->ijkl', delta, delta, optimize=True) +\n                             mu * (np.einsum('ik,jl->ijkl', delta, delta, optimize=True) +\n                                   np.einsum('il,jk->ijkl', delta, delta, optimize=True)))\n            \n            # Check for numerical equality\n            err_rot_inv = np.max(np.abs(c_spatial - c_iso_spatial))\n            \n            rot_inv_check_val = True\n            if c_max > 0:\n                if err_rot_inv / c_max >= tol:\n                    rot_inv_check_val = False\n            elif err_rot_inv > 0:\n                rot_inv_check_val = False\n            \n            rotation_invariance_ok = rot_inv_check_val\n\n        results.append([minor_ok, major_ok, rotation_invariance_ok])\n\n    # Format the output string precisely as required\n    # e.g., \"[[True,True,True],[True,True,False]]\"\n    sub_results_str = []\n    for res_list in results:\n        # Convert list of booleans to string like \"[True,True,False]\"\n        res_str = str(res_list).replace(\" \", \"\")\n        sub_results_str.append(res_str)\n        \n    final_output = f\"[{','.join(sub_results_str)}]\"\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}