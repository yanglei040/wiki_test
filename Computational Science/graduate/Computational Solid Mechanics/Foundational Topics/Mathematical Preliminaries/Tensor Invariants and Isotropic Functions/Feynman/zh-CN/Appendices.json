{
    "hands_on_practices": [
        {
            "introduction": "理论知识的最终目的是应用于实践。本节的第一个实践将带领你把张量不变量的抽象概念与材料模型校准的具体任务联系起来。你将通过设计特定的应力路径来学习如何独立地改变偏应力张量的第二不变量 $J_2$ 和第三不变量 $J_3$，这是理解和表征材料剪切响应与应力状态类型依赖性的核心技能。",
            "id": "3605131",
            "problem": "给定一个对称二阶张量 $A \\in \\mathbb{R}^{3 \\times 3}$，它代表一个一般的类应力量。令 $I$ 表示二阶单位张量。令第一不变量为 $I_1 = \\operatorname{tr}(A)$，偏张量为 $A' = A - \\tfrac{1}{3} I_1 I$。考虑偏张量的各向同性标量函数，即在任何正交基变换下保持不变的标量函数 $g(A')$。定义偏不变量 $J_2 = \\tfrac{1}{2} A' : A'$ 和 $J_3 = \\det(A')$。您的任务是实现一个计算程序，该程序在主空间中构造应力路径，以隔离这些偏不变量用于标定，并沿着这些路径评估一个各向同性标量函数的示例。\n\n基本定义和要求：\n- 正交变换下的不变性表述如下：对于任何满足 $Q^T Q = I$ 的正交张量 $Q$，各向同性标量函数 $g$ 满足 $g(Q A' Q^T) = g(A')$。\n- $A'$ 的不变量为 $J_2 = \\tfrac{1}{2} A' : A'$ 和 $J_3 = \\det(A')$。\n- 将使用主值表示来构建标定路径。\n\n在主基（其中 $A$ 是对角阵）中设计三条标定路径：\n\n$1.$ $J_2$-隔离路径 $\\mathcal{S}_2$：选择一个标量 $t \\in \\mathbb{R}$ 并定义主偏值为 $s_1 = t$，$s_2 = -t$，$s_3 = 0$，使得 $A' = \\operatorname{diag}(t,-t,0)$ 且 $I_1 = 0$。该路径应在保持 $J_3$ 等于 $0$ 的同时改变 $J_2$。\n\n$2.$ $J_3$-隔离路径 $\\mathcal{S}_3$：固定一个半径 $\\rho > 0$，并通过角度 $\\theta$（角度以弧度为单位）在标准的 Haigh–Westergaard $\\pi$-平面圆上参数化主偏值如下\n$$\ns_1 = \\frac{2}{\\sqrt{6}} \\, \\rho \\, \\cos(\\theta), \\quad\ns_2 = \\frac{2}{\\sqrt{6}} \\, \\rho \\, \\cos\\!\\left(\\theta - \\frac{2\\pi}{3}\\right), \\quad\ns_3 = \\frac{2}{\\sqrt{6}} \\, \\rho \\, \\cos\\!\\left(\\theta + \\frac{2\\pi}{3}\\right),\n$$\n其中 $A' = \\operatorname{diag}(s_1,s_2,s_3)$ 且 $I_1 = 0$。该路径通过 Lode 角 $\\theta$ 改变 $J_3$，同时保持 $J_2$ 不变。\n\n$3.$ 静水路径 $\\mathcal{H}$：选择一个标量 $p \\in \\mathbb{R}$ 并设置 $A = p I$，使得 $A' = 0$，因此 $J_2 = 0$ 且 $J_3 = 0$。这提供了一个边界检查。\n\n通过下式定义偏张量的一个各向同性标量函数 $g$\n$$\ng(A') = c_0 + c_1 \\sqrt{J_2} + c_2 \\, (J_3)^2,\n$$\n其中常数 $c_0 = 0$，$c_1 = 2$，$c_2 = \\tfrac{1}{2}$。该函数 $g$ 仅依赖于不变量，因此是各向同性的。\n\n数值测试套件：\n- 使用以下参数值（角度以弧度为单位）：\n  - 对于 $\\mathcal{S}_2$：$t \\in \\{\\, 0, \\, 1.5, \\, -2 \\,\\}$。\n  - 对于 $\\mathcal{S}_3$：$\\rho = 2$ 且 $\\theta \\in \\{\\, 0, \\, \\tfrac{\\pi}{12}, \\, \\tfrac{\\pi}{6} \\,\\}$。\n  - 对于 $\\mathcal{H}$：$p \\in \\{\\, 0, \\, 1 \\,\\}$。\n- 对于数值检查，使用绝对容差 $\\varepsilon = 10^{-10}$。\n\n您程序的计算任务：\n- 实现用于计算任意对称张量 $A$ 的 $I_1$、$A'$、$J_2$ 和 $J_3$ 的例程。\n- 使用测试套件参数构建三条路径的主对角形式。\n- 对于 $\\mathcal{S}_2$ 中的每个 $t$，计算 $J_2$ 和 $J_3$，并返回检查 $\\lvert J_3 \\rvert \\le \\varepsilon$ 的布尔值。\n- 对于 $\\mathcal{S}_3$ 中的每个 $\\theta$，计算 $J_2$ 和 $J_3$，并返回检查 $\\lvert J_2 - J_{2,\\mathrm{ref}} \\rvert \\le \\varepsilon$ 的布尔值，其中 $J_{2,\\mathrm{ref}} = \\rho^2 / 2$。\n- 对于 $\\mathcal{H}$ 中的每个 $p$，验证 $J_2 = 0$ 和 $J_3 = 0$ 在容差范围内，并返回两个布尔值。\n- 在三个代表性状态下评估 $g$：\n  - 在 $t = 1.5$ 时的 $\\mathcal{S}_2$ 上的 $g$，\n  - 在 $\\rho = 2, \\theta = \\tfrac{\\pi}{12}$ 时的 $\\mathcal{S}_3$ 上的 $g$，\n  - 在 $p = 0$ 时的 $\\mathcal{H}$ 上的 $g$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，顺序完全如下：\n  $[\n  J_2(\\mathcal{S}_2,t\\!=\\!0), \\,\n  J_3(\\mathcal{S}_2,t\\!=\\!0), \\,\n  \\text{iso-}J_3(\\mathcal{S}_2,t\\!=\\!0), \\,\n  J_2(\\mathcal{S}_2,t\\!=\\!1.5), \\,\n  J_3(\\mathcal{S}_2,t\\!=\\!1.5), \\,\n  \\text{iso-}J_3(\\mathcal{S}_2,t\\!=\\!1.5), \\,\n  J_2(\\mathcal{S}_2,t\\!=\\!-2), \\,\n  J_3(\\mathcal{S}_2,t\\!=\\!-2), \\,\n  \\text{iso-}J_3(\\mathcal{S}_2,t\\!=\\!-2), \\,\n  J_2(\\mathcal{S}_3,\\theta\\!=\\!0), \\,\n  J_3(\\mathcal{S}_3,\\theta\\!=\\!0), \\,\n  \\text{const-}J_2(\\mathcal{S}_3,\\theta\\!=\\!0), \\,\n  J_2(\\mathcal{S}_3,\\theta\\!=\\!\\tfrac{\\pi}{12}), \\,\n  J_3(\\mathcal{S}_3,\\theta\\!=\\!\\tfrac{\\pi}{12}), \\,\n  \\text{const-}J_2(\\mathcal{S}_3,\\theta\\!=\\!\\tfrac{\\pi}{12}), \\,\n  J_2(\\mathcal{S}_3,\\theta\\!=\\!\\tfrac{\\pi}{6}), \\,\n  J_3(\\mathcal{S}_3,\\theta\\!=\\!\\tfrac{\\pi}{6}), \\,\n  \\text{const-}J_2(\\mathcal{S}_3,\\theta\\!=\\!\\tfrac{\\pi}{6}), \\,\n  J_2(\\mathcal{H},p\\!=\\!0)\\!=\\!0, \\,\n  J_3(\\mathcal{H},p\\!=\\!0)\\!=\\!0, \\,\n  J_2(\\mathcal{H},p\\!=\\!1)\\!=\\!0, \\,\n  J_3(\\mathcal{H},p\\!=\\!1)\\!=\\!0, \\,\n  g(\\mathcal{S}_2,t\\!=\\!1.5), \\,\n  g(\\mathcal{S}_3,\\theta\\!=\\!\\tfrac{\\pi}{12}), \\,\n  g(\\mathcal{H},p\\!=\\!0)\n  ]$。\n- 所有数值输出均为无量纲的浮点数或布尔值。\n- 角度必须以弧度处理。",
            "solution": "问题陈述已经过严格验证，并被确定为具有科学依据、适定且自洽的。其定义、参数和计算任务符合计算固体力学和张量分析的既定原则。因此，我们可以着手求解。\n\n此问题的核心是对对称二阶张量的各向同性标量函数进行分析，这在各向同性材料本构模型的建立中至关重要。一个各向同性函数仅通过其不变量来依赖于该张量。对于一个类应力张量 $A \\in \\mathbb{R}^{3 \\times 3}$，将其分解为其静水部分和偏量部分是方便的。偏量部分 $A'$ 捕捉了形状的扭曲或改变。其不变量，特别是 $J_2$ 和 $J_3$，对于描述不同加载条件下的材料行为至关重要。\n\n首先，我们为一个任意对称张量 $A$ 定义必要的计算例程。\n$A$ 的第一不变量是它的迹：\n$$I_1 = \\operatorname{tr}(A) = \\sum_{i=1}^{3} A_{ii}$$\n$A$ 的偏量部分，记作 $A'$，定义为：\n$$A' = A - \\frac{1}{3} I_1 I$$\n其中 $I$ 是 $3 \\times 3$ 单位张量。根据构造， $A'$ 的迹恒为零：$\\operatorname{tr}(A') = \\operatorname{tr}(A) - \\frac{1}{3} I_1 \\operatorname{tr}(I) = I_1 - \\frac{1}{3} I_1 (3) = 0$。\n\n偏张量 $A'$ 的主不变量是 $J_2$ 和 $J_3$。\n$J_2$ 是偏张量大小的一种度量：\n$$J_2 = \\frac{1}{2} A' : A' = \\frac{1}{2} \\operatorname{tr}(A' A'^T) = \\frac{1}{2} \\sum_{i=1}^{3} \\sum_{j=1}^{3} A'_{ij} A'_{ij}$$\n对于对角张量 $A' = \\operatorname{diag}(s_1, s_2, s_3)$，这可简化为 $J_2 = \\frac{1}{2} (s_1^2 + s_2^2 + s_3^2)$。\n$J_3$ 是偏张量的行列式：\n$$J_3 = \\det(A')$$\n对于对角张量 $A' = \\operatorname{diag}(s_1, s_2, s_3)$，这等于 $J_3 = s_1 s_2 s_3$。\n\n现在我们在主基中分析这三条指定的标定路径。\n\n**1. $J_2$-隔离路径 $\\mathcal{S}_2$**\n此路径由一个偏张量定义，其主值为 $(s_1, s_2, s_3) = (t, -t, 0)$，其中 $t$ 是一个标量参数。该张量为 $A' = \\operatorname{diag}(t, -t, 0)$。\n不变量为：\n$$J_2 = \\frac{1}{2} (t^2 + (-t)^2 + 0^2) = \\frac{1}{2} (2 t^2) = t^2$$\n$$J_3 = (t)(-t)(0) = 0$$\n此路径隔离了 $J_2$ 的影响（通过改变 $t$），同时保持 $J_3$ 固定为 $0$。\n对于测试套件 $t \\in \\{0, 1.5, -2\\}$：\n- 当 $t=0$ 时：$A'=\\operatorname{diag}(0,0,0)$，所以 $J_2 = 0^2 = 0$ 且 $J_3 = 0$。检查 $|J_3| \\le \\varepsilon$ 为真。\n- 当 $t=1.5$ 时：$J_2 = (1.5)^2 = 2.25$ 且 $J_3 = 0$。检查 $|J_3| \\le \\varepsilon$ 为真。\n- 当 $t=-2$ 时：$J_2 = (-2)^2 = 4$ 且 $J_3 = 0$。检查 $|J_3| \\le \\varepsilon$ 为真。\n\n**2. $J_3$-隔离路径 $\\mathcal{S}_3$**\n此路径定义在 Haigh–Westergaard 空间中的 $\\pi$-平面上。对于固定的半径 $\\rho > 0$ 和角度 $\\theta$，主偏值为：\n$$s_1 = \\frac{2}{\\sqrt{6}} \\rho \\cos(\\theta), \\quad s_2 = \\frac{2}{\\sqrt{6}} \\rho \\cos(\\theta - \\frac{2\\pi}{3}), \\quad s_3 = \\frac{2}{\\sqrt{6}} \\rho \\cos(\\theta + \\frac{2\\pi}{3})$$\n我们来验证此路径的性质。由于三角恒等式，主值之和为 $s_1+s_2+s_3 = 0$，这证实了该张量是偏张量。\n对于 $J_2$：\n$$J_2 = \\frac{1}{2} \\sum s_i^2 = \\frac{1}{2} \\left(\\frac{4\\rho^2}{6}\\right) \\left[ \\cos^2\\theta + \\cos^2(\\theta - \\tfrac{2\\pi}{3}) + \\cos^2(\\theta + \\tfrac{2\\pi}{3}) \\right]$$\n使用恒等式 $\\cos^2\\alpha + \\cos^2(\\alpha - \\tfrac{2\\pi}{3}) + \\cos^2(\\alpha + \\tfrac{2\\pi}{3}) = \\frac{3}{2}$，我们得到：\n$$J_2 = \\frac{1}{2} \\left(\\frac{2\\rho^2}{3}\\right) \\left( \\frac{3}{2} \\right) = \\frac{\\rho^2}{2}$$\n这证实了 $J_2$ 在此路径上是常数，仅由 $\\rho$ 决定。参考值被正确地给出为 $J_{2,\\mathrm{ref}} = \\rho^2 / 2$。\n对于测试用例 $\\rho=2$，我们有 $J_{2,\\mathrm{ref}} = 2^2/2 = 2$。\n对于 $J_3$：\n$$J_3 = s_1 s_2 s_3 = \\left(\\frac{2\\rho}{\\sqrt{6}}\\right)^3 \\cos\\theta \\cos(\\theta - \\tfrac{2\\pi}{3}) \\cos(\\theta + \\tfrac{2\\pi}{3})$$\n使用恒等式 $\\cos\\alpha \\cos(\\alpha - \\tfrac{2\\pi}{3}) \\cos(\\alpha + \\tfrac{2\\pi}{3}) = \\frac{1}{4} \\cos(3\\alpha)$，我们有：\n$$J_3 = \\left(\\frac{8\\rho^3}{6\\sqrt{6}}\\right) \\frac{1}{4} \\cos(3\\theta) = \\frac{\\rho^3}{3\\sqrt{6}} \\cos(3\\theta)$$\n$J_3$ 随 Lode 角 $\\theta$ 而变化。\n对于测试套件 $\\rho=2$ 和 $\\theta \\in \\{0, \\pi/12, \\pi/6\\}$：\n- 当 $\\theta=0$ 时：$J_2=2$。$J_3 = \\frac{2^3}{3\\sqrt{6}} \\cos(0) = \\frac{8}{3\\sqrt{6}} = \\frac{8\\sqrt{6}}{18} = \\frac{4\\sqrt{6}}{9} \\approx 1.08866$。检查 $|J_2 - 2| \\le \\varepsilon$ 为真。\n- 当 $\\theta=\\pi/12$ 时：$J_2=2$。$J_3 = \\frac{8}{3\\sqrt{6}} \\cos(3\\pi/12) = \\frac{8}{3\\sqrt{6}} \\cos(\\pi/4) = \\frac{8}{3\\sqrt{6}} \\frac{\\sqrt{2}}{2} = \\frac{4\\sqrt{2}}{3\\sqrt{6}} = \\frac{4\\sqrt{12}}{18} = \\frac{8\\sqrt{3}}{18} = \\frac{4\\sqrt{3}}{9} \\approx 0.76980$。检查 $|J_2 - 2| \\le \\varepsilon$ 为真。\n- 当 $\\theta=\\pi/6$ 时：$J_2=2$。$J_3 = \\frac{8}{3\\sqrt{6}} \\cos(3\\pi/6) = \\frac{8}{3\\sqrt{6}} \\cos(\\pi/2) = 0$。检查 $|J_2 - 2| \\le \\varepsilon$ 为真。\n\n**3. 静水路径 $\\mathcal{H}$**\n此路径由一个纯静水张量 $A = p I$ 定义，其中 $p$ 是静水压力。\n第一不变量是 $I_1 = \\operatorname{tr}(pI) = 3p$。\n偏张量是 $A' = A - \\frac{1}{3} I_1 I = pI - \\frac{1}{3}(3p)I = pI - pI = 0$。\n由于 $A'$ 是零张量，其不变量恒为零：$J_2 = 0$ 和 $J_3 = 0$。这对任何 $p$ 都成立。\n对于测试套件 $p \\in \\{0, 1\\}$：\n- 当 $p=0$ 时：$A'$ 是零张量，所以 $J_2=0, J_3=0$。检查 $|J_2| \\le \\varepsilon$ 和 $|J_3| \\le \\varepsilon$ 都为真。\n- 当 $p=1$ 时：$A'$ 是零张量，所以 $J_2=0, J_3=0$。检查 $|J_2| \\le \\varepsilon$ 和 $|J_3| \\le \\varepsilon$ 都为真。\n\n**各向同性标量函数 $g(A')$ 的求值**\n该函数由 $g(A') = c_0 + c_1 \\sqrt{J_2} + c_2 (J_3)^2$ 给出，其中 $c_0=0, c_1=2, c_2=0.5$。\n所以，$g(A') = 2\\sqrt{J_2} + 0.5 (J_3)^2$。我们在这三个指定的状态下对其进行求值：\n- 在 $t=1.5$ 时的 $\\mathcal{S}_2$ 上：这里，$J_2 = (1.5)^2 = 2.25$ 且 $J_3 = 0$。\n  $g = 2\\sqrt{2.25} + 0.5(0)^2 = 2(1.5) = 3$。\n- 在 $\\rho=2, \\theta=\\pi/12$ 时的 $\\mathcal{S}_3$ 上：这里，$J_2 = 2$ 且 $J_3 = \\frac{4\\sqrt{3}}{9}$。\n  $g = 2\\sqrt{2} + 0.5 \\left(\\frac{4\\sqrt{3}}{9}\\right)^2 = 2\\sqrt{2} + 0.5 \\left(\\frac{16 \\cdot 3}{81}\\right) = 2\\sqrt{2} + \\frac{24}{81} = 2\\sqrt{2} + \\frac{8}{27}$。\n  $g \\approx 2(1.41421356) + 0.296296... \\approx 2.82842712 + 0.296296... \\approx 3.12472342$。\n- 在 $p=0$ 时的 $\\mathcal{H}$ 上：这里，$J_2 = 0$ 且 $J_3 = 0$。\n  $g = 2\\sqrt{0} + 0.5(0)^2 = 0$。\n\n解题逻辑现已确认。实现将遵循此精确计算。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to perform the computational tasks specified in the problem.\n    \"\"\"\n    \n    # Define constants and tolerance\n    c0 = 0.0\n    c1 = 2.0\n    c2 = 0.5\n    epsilon = 1e-10\n\n    # Helper functions for tensor invariants\n    def compute_I1(A):\n        \"\"\"Computes the first invariant (trace) of a tensor A.\"\"\"\n        return np.trace(A)\n\n    def compute_A_prime(A):\n        \"\"\"Computes the deviatoric part of a tensor A.\"\"\"\n        I1 = compute_I1(A)\n        return A - (I1 / 3.0) * np.identity(3)\n\n    def compute_J2(A_prime):\n        \"\"\"Computes the second deviatoric invariant J2.\"\"\"\n        # J2 = 0.5 * A_prime : A_prime = 0.5 * tr(A_prime . A_prime)\n        # For diagonal matrix, this is 0.5 * sum(diag^2)\n        if A_prime.ndim == 1: # Passed as principal values\n            return 0.5 * np.sum(A_prime**2)\n        return 0.5 * np.sum(A_prime * A_prime) # Frobenius inner product\n\n    def compute_J3(A_prime):\n        \"\"\"Computes the third deviatoric invariant J3.\"\"\"\n        if A_prime.ndim == 1: # Passed as principal values\n            return np.prod(A_prime)\n        return np.linalg.det(A_prime)\n\n    def evaluate_g(J2, J3):\n        \"\"\"Evaluates the isotropic scalar function g.\"\"\"\n        return c0 + c1 * np.sqrt(J2) + c2 * (J3**2)\n\n    results = []\n\n    # 1. Path S2: J2-isolation\n    t_values = [0.0, 1.5, -2.0]\n    for t in t_values:\n        # A_prime in principal basis is diag(t, -t, 0)\n        s = np.array([t, -t, 0.0])\n        J2 = compute_J2(s)\n        J3 = compute_J3(s)\n        is_J3_iso = np.abs(J3) = epsilon\n        \n        results.extend([J2, J3, is_J3_iso])\n\n    # 2. Path S3: J3-isolation\n    rho = 2.0\n    theta_values = [0.0, np.pi/12, np.pi/6]\n    J2_ref = rho**2 / 2.0\n    \n    for theta in theta_values:\n        s1 = (2.0 / np.sqrt(6.0)) * rho * np.cos(theta)\n        s2 = (2.0 / np.sqrt(6.0)) * rho * np.cos(theta - 2.0 * np.pi / 3.0)\n        s3 = (2.0 / np.sqrt(6.0)) * rho * np.cos(theta + 2.0 * np.pi / 3.0)\n        s = np.array([s1, s2, s3])\n        \n        J2 = compute_J2(s)\n        J3 = compute_J3(s)\n        is_J2_const = np.abs(J2 - J2_ref) = epsilon\n        \n        results.extend([J2, J3, is_J2_const])\n\n    # 3. Path H: Hydrostatic\n    p_values = [0.0, 1.0]\n    for p in p_values:\n        A = p * np.identity(3)\n        A_prime = compute_A_prime(A)\n        J2 = compute_J2(A_prime)\n        J3 = compute_J3(A_prime)\n        \n        is_J2_zero = np.abs(J2) = epsilon\n        is_J3_zero = np.abs(J3) = epsilon\n        results.extend([is_J2_zero, is_J3_zero])\n\n    # 4. Evaluate g at specific states\n    # g on S2 at t = 1.5\n    s_s2 = np.array([1.5, -1.5, 0.0])\n    J2_s2 = compute_J2(s_s2)\n    J3_s2 = compute_J3(s_s2)\n    g_s2 = evaluate_g(J2_s2, J3_s2)\n    \n    # g on S3 at rho = 2, theta = pi/12\n    rho_g = 2.0\n    theta_g = np.pi/12\n    s1_g = (2.0 / np.sqrt(6.0)) * rho_g * np.cos(theta_g)\n    s2_g = (2.0 / np.sqrt(6.0)) * rho_g * np.cos(theta_g - 2.0 * np.pi / 3.0)\n    s3_g = (2.0 / np.sqrt(6.0)) * rho_g * np.cos(theta_g + 2.0 * np.pi / 3.0)\n    s_s3 = np.array([s1_g, s2_g, s3_g])\n    J2_s3 = compute_J2(s_s3)\n    J3_s3 = compute_J3(s_s3)\n    g_s3 = evaluate_g(J2_s3, J3_s3)\n    \n    # g on H at p = 0\n    A_h = 0.0 * np.identity(3)\n    A_prime_h = compute_A_prime(A_h)\n    J2_h = compute_J2(A_prime_h)\n    J3_h = compute_J3(A_prime_h)\n    g_h = evaluate_g(J2_h, J3_h)\n    \n    results.extend([g_s2, g_s3, g_h])\n\n    # Final print statement in the exact required format\n    # Convert booleans to lowercase 'true'/'false' for output\n    formatted_results = [str(r).lower() if isinstance(r, bool) else str(r) for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在掌握了如何分离不变量后，我们将更进一步，将这些概念应用于构建和验证一个真实的塑性材料模型。这个实践任务是设计一个考虑了静水压力和洛德角（Lode angle）依赖性的各向同性塑性屈服面，这在岩土、金属和聚合物等材料的建模中至关重要。通过这个练习，你将验证模型如何正确处理静水压力效应，并检验其对第三不变量 $J_3$ 的敏感性，从而深化对不变量物理意义的理解。",
            "id": "3605161",
            "problem": "您的任务是使用基本张量不变量为固体力学模型设计、分析和测试一个各向同性塑性屈服面。该公式必须仅依赖于柯西应力张量的标量不变量以确保各向同性，并且测试必须通过遍历Lode角的路径来明确检查静水压力偏移行为和对第三不变量的敏感性。所有应力均应以兆帕 (MPa) 为单位，所有角度均以弧度为单位，屈服函数的所有输出均应为无量纲。\n\n基本依据和定义：\n- 令柯西应力张量表示为 $\\boldsymbol{\\sigma} \\in \\mathbb{R}^{3 \\times 3}$。\n- 平均应力（压力）定义为 $p = \\dfrac{\\operatorname{tr}(\\boldsymbol{\\sigma})}{3}$。\n- 偏应力张量定义为 $\\boldsymbol{s} = \\boldsymbol{\\sigma} - p \\boldsymbol{I}$，其中 $\\boldsymbol{I}$ 是单位张量。\n- 偏应力的第二不变量为 $J_2 = \\dfrac{1}{2} \\boldsymbol{s}:\\boldsymbol{s}$。\n- 偏应力的第三不变量为 $J_3 = \\det(\\boldsymbol{s})$。\n- Lode角 $\\theta \\in \\left[-\\dfrac{\\pi}{6},\\dfrac{\\pi}{6}\\right]$ 由以下关系隐式定义\n$$\n\\cos(3\\theta) = \\dfrac{3\\sqrt{3}}{2} \\dfrac{J_3}{J_2^{3/2}},\n$$\n为保证鲁棒性，需对结果进行适当的数值裁剪至 $[-1,1]$，并且对于 $J_2  0$ 的情况，$\\theta = \\dfrac{1}{3}\\arccos\\left(\\dfrac{3\\sqrt{3}}{2} \\dfrac{J_3}{J_2^{3/2}}\\right)$。对于 $J_2 = 0$ 的情况，将 $\\theta = 0$ 定义为一个常规极限值。\n\n您必须构建以下各向同性屈服函数：\n$$\nF(J_2, J_3, p) = \\dfrac{\\sqrt{J_2}}{\\kappa(p)} \\left(1 + \\beta \\cos(3\\theta)\\right) - 1,\n$$\n其中 $\\kappa(p) = k_0 + k_1 p$，常数 $k_0 = 60$ MPa，$k_1 = 0.01$ (无量纲)，Lode角相关参数 $\\beta \\in \\mathbb{R}$。此函数 $F$ 必须仅用不变量 $J_2$、$J_3$ 和 $p$ 来表示。\n\n任务：\n1. 根据上述定义，为任意给定的 $3 \\times 3$ 应力张量 $\\boldsymbol{\\sigma}$ (单位 MPa) 实现鲁棒的数值函数，以计算 $p$、$\\boldsymbol{s}$、$J_2$、$J_3$ 和 $\\theta$。使用提供的不变量公式计算 $\\cos(3\\theta)$，并确保在应用 $\\arccos(\\cdot)$ 之前进行数值裁剪至 $[-1,1]$。\n2. 实现屈服函数 $F(J_2, J_3, p)$，其中常数 $k_0 = 60$ MPa 和 $k_1 = 0.01$，并针对 $\\beta = 0.3$ 和 $\\beta = 0$ 两种情况进行评估。\n3. 证明在静水压力偏移下的等效性：构建两个仅相差一个静水压力偏移的应力状态 $\\boldsymbol{\\sigma}_a$ 和 $\\boldsymbol{\\sigma}_b$，即对于指定的 $\\Delta p$，有 $\\boldsymbol{\\sigma}_b = \\boldsymbol{\\sigma}_a + \\Delta p \\boldsymbol{I}$。数值上证明 $J_2(\\boldsymbol{\\sigma}_a) = J_2(\\boldsymbol{\\sigma}_b)$、$J_3(\\boldsymbol{\\sigma}_a) = J_3(\\boldsymbol{\\sigma}_b)$ 和 $\\cos(3\\theta(\\boldsymbol{\\sigma}_a)) = \\cos(3\\theta(\\boldsymbol{\\sigma}_b))$ 在 $10^{-10}$ 的容差范围内成立，并报告当 $\\beta = 0.3$ 时 $F(\\boldsymbol{\\sigma}_b) - F(\\boldsymbol{\\sigma}_a)$ 的差值。\n4. 通过围绕Lode角旋转的合成应力路径来测试对 $J_3$ 敏感性的识别：对于固定的 $p$ 和固定的 $J_2$，构建一组由 $\\theta \\in [-\\pi/6, \\pi/6]$ 参数化的偏应力主应力 $\\{s_1, s_2, s_3\\}$，使得 $\\operatorname{tr}(\\boldsymbol{s}) = 0$ 且 $J_2$ 保持恒定。使用参数化\n$$\ns_1(\\theta) = \\dfrac{2}{\\sqrt{6}} R \\cos(\\theta), \\quad s_2(\\theta) = \\dfrac{2}{\\sqrt{6}} R \\cos\\left(\\theta - \\dfrac{2\\pi}{3}\\right), \\quad s_3(\\theta) = \\dfrac{2}{\\sqrt{6}} R \\cos\\left(\\theta + \\dfrac{2\\pi}{3}\\right),\n$$\n其中 $R = \\sqrt{2 J_2}$。构建 $\\boldsymbol{\\sigma}(\\theta) = p \\boldsymbol{I} + \\operatorname{diag}(s_1(\\theta), s_2(\\theta), s_3(\\theta))$。分别针对 $\\beta = 0.3$ 和 $\\beta = 0$ 的情况，沿此路径评估 $F$，并报告每种 $\\beta$ 情况下路径上 $F$ 的振幅（最大值减去最小值）。通过检查 $\\beta = 0.3$ 时振幅是否为正，以及 $\\beta = 0$ 时振幅是否近似为零（在 $10^{-10}$ 范围内），来判断该路径是否揭示了 $J_3$ 敏感性。\n5. 评估纯静水应力状态（$J_2 = 0$）和一般非静水应力状态下的屈服函数。\n\n使用以下明确的应力状态、参数和路径值测试套件（所有应力单位为 MPa，角度单位为弧度）：\n- 静水压力偏移测试：\n  - 基本偏应力主应力：$s_1 = 10$, $s_2 = -5$, $s_3 = -5$（因此 $\\operatorname{tr}(\\boldsymbol{s}) = 0$）。\n  - 基本平均应力：$p_a = 30$。\n  - 偏移量：$\\Delta p = 50$。\n  - 定义 $\\boldsymbol{\\sigma}_a = p_a \\boldsymbol{I} + \\operatorname{diag}(10, -5, -5)$ 和 $\\boldsymbol{\\sigma}_b = (p_a + \\Delta p)\\boldsymbol{I} + \\operatorname{diag}(10, -5, -5)$。\n  - 相等性检查容差：$10^{-10}$。\n- Lode角路径：\n  - 固定平均应力 $p = 30$。\n  - 固定 $J_2 = 1600$。\n  - 路径角度：$\\theta \\in \\{-\\dfrac{\\pi}{6}, -\\dfrac{\\pi}{9}, -\\dfrac{\\pi}{12}, -\\dfrac{\\pi}{18}, 0, \\dfrac{\\pi}{18}, \\dfrac{\\pi}{12}, \\dfrac{\\pi}{9}, \\dfrac{\\pi}{6}\\}$。\n  - 评估 $\\beta = 0.3$ 和 $\\beta = 0$ 时的振幅。\n- 纯静水状态：\n  - $\\boldsymbol{\\sigma}_h = 50 \\boldsymbol{I}$（即 $p = 50$, $J_2 = 0$）。\n- 一般非静水状态：\n  - $\\boldsymbol{\\sigma}_g = \\begin{bmatrix} 120  15  -10 \\\\ 15  80  5 \\\\ -10  5  100 \\end{bmatrix}$。\n\n您的程序必须：\n- 按照规定实现不变量计算和屈服函数。\n- 按提供的顺序应用测试套件，并计算以下输出：\n  1. 对于 $\\beta = 0.3$ 时在 $\\boldsymbol{\\sigma}_a$ 和 $\\boldsymbol{\\sigma}_b$ 上的静水压力偏移测试：三个布尔值，分别表示 $J_2$、$J_3$ 和 $\\cos(3\\theta)$ 的相等性（每个都在 $10^{-10}$ 的容差内），后跟浮点数差值 $F(\\boldsymbol{\\sigma}_b) - F(\\boldsymbol{\\sigma}_a)$。\n  2. 对于Lode角路径：$\\beta = 0.3$ 时路径上 $F$ 的浮点数振幅，$\\beta = 0$ 时的浮点数振幅，一个布尔值表示 $\\beta = 0.3$ 时振幅非零，以及一个布尔值表示 $\\beta = 0$ 时振幅在 $10^{-10}$ 容差内接近于零。\n  3. 对于 $\\beta = 0.3$ 的纯静水状态，浮点数 $F(\\boldsymbol{\\sigma}_h)$。\n  4. 对于 $\\beta = 0.3$ 的一般状态，浮点数 $F(\\boldsymbol{\\sigma}_g)$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔的结果列表（例如，`[result1,result2,result3]`），并严格按照上述顺序排列。因此，此输出列表必须包含 $10$ 个条目：来自静水压力偏移测试的 $3$ 个布尔值和 $1$ 个浮点数，来自Lode角路径的 $2$ 个浮点数和 $2$ 个布尔值，以及分别来自静水状态和一般状态的 $2$ 个浮点数。",
            "solution": "用户提供了一个关于计算固体力学中各向同性塑性屈服面实现与验证的问题。在继续之前，我将首先验证问题陈述的正确性和可解性。\n\n### 步骤1：提取给定信息\n\n- **柯西应力张量 (Cauchy Stress Tensor)**: $\\boldsymbol{\\sigma} \\in \\mathbb{R}^{3 \\times 3}$。\n- **平均应力 (压力) (Mean Stress (Pressure))**: $p = \\dfrac{\\operatorname{tr}(\\boldsymbol{\\sigma})}{3}$。\n- **偏应力张量 (Deviatoric Stress Tensor)**: $\\boldsymbol{s} = \\boldsymbol{\\sigma} - p \\boldsymbol{I}$，其中 $\\boldsymbol{I}$ 是单位张量。\n- **第二偏应力不变量 (Second Deviatoric Stress Invariant)**: $J_2 = \\dfrac{1}{2} \\boldsymbol{s}:\\boldsymbol{s}$。\n- **第三偏应力不变量 (Third Deviatoric Stress Invariant)**: $J_3 = \\det(\\boldsymbol{s})$。\n- **Lode角 (Lode Angle) ($\\theta$)**: 由 $\\cos(3\\theta) = \\dfrac{3\\sqrt{3}}{2} \\dfrac{J_3}{J_2^{3/2}}$ 定义，其中 $\\theta \\in \\left[-\\dfrac{\\pi}{6},\\dfrac{\\pi}{6}\\right]$。对于计算，当 $J_2  0$ 时，$\\theta = \\dfrac{1}{3}\\arccos\\left(\\dfrac{3\\sqrt{3}}{2} \\dfrac{J_3}{J_2^{3/2}}\\right)$，且 arccos 的参数需裁剪至 $[-1,1]$；当 $J_2=0$ 时，$\\theta = 0$。\n- **屈服函数 (Yield Function) ($F$)**: $F(J_2, J_3, p) = \\dfrac{\\sqrt{J_2}}{\\kappa(p)} \\left(1 + \\beta \\cos(3\\theta)\\right) - 1$。\n- **硬化函数 (Hardening Function) ($\\kappa$)**: $\\kappa(p) = k_0 + k_1 p$。\n- **常数 (Constants)**: $k_0 = 60$ MPa, $k_1 = 0.01$ (无量纲), 参数 $\\beta \\in \\{0.3, 0\\}$。\n- **任务 (Tasks)**:\n  1. 为不变量和屈服函数实现鲁棒的数值函数。\n  2. 实现 $\\beta = 0.3$ 和 $\\beta = 0$ 时的屈服函数。\n  3. 执行静水压力偏移测试。\n  4. 执行Lode角路径测试。\n  5. 评估特定应力状态下的屈服函数。\n- **测试套件 (Test Suite)**:\n  - **静水压力偏移测试**: 基础偏应力主应力 $s_1=10, s_2=-5, s_3=-5$; 基础平均应力 $p_a=30$; 偏移量 $\\Delta p=50$。容差 $10^{-10}$。使用 $\\beta=0.3$。\n  - **Lode角路径**: 固定 $p=30$, 固定 $J_2=1600$。路径角度 $\\theta \\in \\{-\\dfrac{\\pi}{6}, -\\dfrac{\\pi}{9}, -\\dfrac{\\pi}{12}, -\\dfrac{\\pi}{18}, 0, \\dfrac{\\pi}{18}, \\dfrac{\\pi}{12}, \\dfrac{\\pi}{9}, \\dfrac{\\pi}{6}\\}$。路径参数化: $s_1(\\theta) = \\dfrac{2}{\\sqrt{6}} R \\cos(\\theta)$, $s_2(\\theta) = \\dfrac{2}{\\sqrt{6}} R \\cos\\left(\\theta - \\dfrac{2\\pi}{3}\\right)$, $s_3(\\theta) = \\dfrac{2}{\\sqrt{6}} R \\cos\\left(\\theta + \\dfrac{2\\pi}{3}\\right)$，其中 $R = \\sqrt{2 J_2}$。\n  - **纯静水状态**: $\\boldsymbol{\\sigma}_h = 50 \\boldsymbol{I}$。\n  - **一般非静水状态**: $\\boldsymbol{\\sigma}_g = \\begin{bmatrix} 120  15  -10 \\\\ 15  80  5 \\\\ -10  5  100 \\end{bmatrix}$。\n\n- **要求输出 (Required Output)**: 按预定义顺序排列的包含10个特定结果的列表。\n\n### 步骤2：使用提取的给定信息进行验证\n\n- **科学基础 (Scientific Grounding)**: 该问题牢固地植根于连续介质力学中的经典塑性理论。应力不变量（$p$, $J_2$, $J_3$）、Lode角（$\\theta$）以及各向同性屈服函数 $F(p, J_2, J_3)$ 的一般形式的定义都是标准的。所提供的屈服函数是一个具有Lode角相关性的压力敏感模型的具体实例，这是一类成熟的模型。用于Lode角测试的应力路径参数化通过保持 $p$ 和 $J_2$ 不变，正确地隔离了第三不变量 $J_3$ 的影响。该问题在科学上是合理的。\n- **适定性 (Well-Posedness)**: 所有必要的定义、常数和测试用例都已明确提供。计算任务是明确的，并且会得出一组唯一的数值结果。对于静水应力状态（$J_2=0$），Lode角的定义变得不确定，问题通过一个既定约定（$\\theta = 0$）来处理，确保问题在任何地方都是适定的。\n- **客观性 (Objectivity)**: 问题以精确、形式化的数学和工程语言陈述，没有任何主观性或模糊性。\n- **完整性和一致性 (Completeness and Consistency)**: 问题是自洽的。解决方案所需的所有数据和定义都已提供。没有内部矛盾。例如，单位是一致的：$k_0$ 和 $p$ 的单位是 MPa， $k_1$ 是无量纲的，这使得 $\\kappa$ 的单位也是 MPa。$\\sqrt{J_2}$ 的单位是 MPa，因此比率 $\\sqrt{J_2}/\\kappa$ 是无量纲的，使得整个屈服函数 $F$ 如要求一样是无量纲的。\n\n### 步骤3：结论和行动\n\n问题是有效的。它具有科学依据，适定且完整。我将继续进行求解。\n\n### 基于原则的设计\n\n解决方案将构造成一系列函数，每个函数代表一个关键的物理或数学概念。这种模块化设计增强了清晰度和正确性。\n\n1.  **`compute_invariants(sigma)` 函数**: 这个核心函数封装了张量分解和不变量的基本原理。\n    -   给定一个柯西应力张量 $\\boldsymbol{\\sigma}$，它首先计算应力的体积部分，由平均应力或压力 $p = \\frac{1}{3}\\operatorname{tr}(\\boldsymbol{\\sigma})$ 表示。这隔离了静水压力分量。\n    -   接下来，它计算偏应力张量 $\\boldsymbol{s} = \\boldsymbol{\\sigma} - p\\boldsymbol{I}$，它代表应力状态的剪切（形状改变）部分。根据定义，$\\operatorname{tr}(\\boldsymbol{s}) = 0$。\n    -   然后，它计算偏应力张量的主要标量不变量 $J_2$ 和 $J_3$。\n        -   $J_2 = \\frac{1}{2}\\boldsymbol{s}:\\boldsymbol{s}$ 是偏应力大小的度量。双点积 $\\boldsymbol{s}:\\boldsymbol{s}$ 是 $\\boldsymbol{s}$ 分量平方的和。\n        -   $J_3 = \\det(\\boldsymbol{s})$ 与 $\\boldsymbol{s}$ 的第三主不变量有关，并表征剪切状态的类型。\n    -   最后，它直接从不变量计算与Lode角相关的量 $\\cos(3\\theta)$。使用了公式 $\\cos(3\\theta) = \\frac{3\\sqrt{3}}{2} \\frac{J_3}{J_2^{3/2}}$。一个关键的数值鲁棒性步骤被包括在内：如果 $J_2$ 接近于零（静水状态），则按照惯例将 $\\cos(3\\theta)$ 设置为 $1$，因为 $J_3$ 也将为零。表达式的参数也被裁剪到有效范围 $[-1, 1]$ 以防止潜在的反三角函数调用中的定义域错误，尽管屈服函数本身只需要 $\\cos(3\\theta)$，而不需要 $\\theta$。\n\n2.  **`yield_function(p, J2, cos3theta, beta, k0, k1)` 函数**: 此函数实现了屈服面的特定本构模型。\n    -   其输入是标量不变量（$p, J2, \\cos(3\\theta)$）和材料参数（$\\beta, k0, k1$），这反映了各向同性原理（仅依赖于不变量）。\n    -   它首先计算压力相关的内聚力项 $\\kappa(p) = k_0 + k_1 p$。这个线性函数模拟了剪切强度随静水压力增加（或减少）的变化，这是土壤、岩石和聚合物等材料的特征。\n    -   然后，它评估屈服准则 $F = \\frac{\\sqrt{J_2}}{\\kappa(p)} (1 + \\beta \\cos(3\\theta)) - 1$。\n        -   项 $\\sqrt{J_2}$ 代表等效剪切应力的度量。\n        -   项 $(1 + \\beta \\cos(3\\theta))$ 引入了对第三不变量的敏感性，使得偏平面（\"$\\pi$-plane\"）中的屈服面形状非圆形。当 $\\beta=0$ 时，这种相关性消失，模型简化为与Lode角无关的形式，如Drucker-Prager准则。\n        -   该函数返回一个无量纲值：$F  0$ 意味着弹性状态，$F = 0$ 意味着处于屈服面上（塑性屈服），而 $F  0$ 代表一个数学上不允许的应力状态。\n\n3.  **测试程序**: 代码的后续部分被设计为特定的数值实验，以验证所实现模型的物理和数学属性。\n    -   **静水压力偏移测试**: 此测试验证偏不变量 $J_2$ 和 $J_3$ 的一个基本属性。向应力张量 $\\boldsymbol{\\sigma}$ 添加纯静水应力（$\\Delta p \\boldsymbol{I}$）只会改变其体积分量 $p$，而偏分量 $\\boldsymbol{s}$ 保持不变。因此，$J_2$ 和 $J_3$ 必须保持不变。该测试在数值上证实了这一点。它还演示了由于 $\\kappa(p)$ 的压力依赖性，屈服函数值 $F$ 如何变化。\n    -   **Lode角路径测试**: 此测试旨在探究屈服函数对第三不变量 $J_3$ 的敏感性。通过构建一个应力路径，其中 $p$ 和 $J_2$ 保持恒定而Lode角 $\\theta$ 变化，我们隔离了项 $\\beta \\cos(3\\theta)$ 的影响。该测试计算沿此路径 $F$ 的变化幅度。对于 $\\beta \\neq 0$，幅度应该非零，确认了 $J_3$ 敏感性。对于 $\\beta = 0$，幅度必须为零（在数值容差内），确认模型简化为与 $J_3$ 无关的形式。\n    -   **特定状态评估**: 最后，对纯静水状态（$\\boldsymbol{s}=\\mathbf{0}$，因此 $J_2=0$）和一般非对角应力状态评估该函数，以确保实现对于各种输入都是鲁棒和正确的。对于静水情况，$F$ 必须评估为 $-1$，因为 $\\sqrt{J_2}=0$。\n\n总体设计遵循一个原则，即从基本物理量（应力不变量）构建到本构模型（屈服函数），然后使用有针对性的数值实验来验证该模型的关键理论属性。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to execute the full test suite for the isotropic yield surface.\n    \"\"\"\n\n    # --- Constants and Parameters from Problem Statement ---\n    k0 = 60.0  # MPa\n    k1 = 0.01  # dimensionless\n    TOLERANCE = 1e-10\n\n    # --- Helper Functions ---\n\n    def compute_invariants(sigma):\n        \"\"\"\n        Computes the pressure p, and deviatoric invariants J2, J3, and cos(3*theta).\n\n        Args:\n            sigma (np.ndarray): A 3x3 Cauchy stress tensor.\n\n        Returns:\n            tuple: A tuple containing (p, J2, J3, cos3theta).\n        \"\"\"\n        if not isinstance(sigma, np.ndarray) or sigma.shape != (3, 3):\n            raise TypeError(\"Input sigma must be a 3x3 numpy array.\")\n\n        # Mean stress (pressure)\n        p = np.trace(sigma) / 3.0\n\n        # Deviatoric stress tensor\n        s = sigma - p * np.identity(3)\n\n        # Second invariant of deviatoric stress\n        # s:s = sum(s_ij * s_ij)\n        J2 = 0.5 * np.sum(s**2)\n\n        # Third invariant of deviatoric stress\n        J3 = np.linalg.det(s)\n\n        # cos(3*theta)\n        if J2  TOLERANCE:\n            # Hydrostatic state convention\n            cos3theta = 1.0\n        else:\n            # Argument for arccos in Lode angle definition\n            arg = (3.0 * np.sqrt(3.0) / 2.0) * J3 / (J2**1.5)\n            # Numerical clipping for robustness\n            cos3theta = np.clip(arg, -1.0, 1.0)\n            \n        return p, J2, J3, cos3theta\n\n    def yield_function(p, J2, cos3theta, beta):\n        \"\"\"\n        Computes the value of the isotropic yield function F.\n\n        Args:\n            p (float): Mean stress.\n            J2 (float): Second deviatoric invariant.\n            cos3theta (float): Cosine of 3 times the Lode angle.\n            beta (float): Lode dependence parameter.\n\n        Returns:\n            float: The dimensionless value of the yield function F.\n        \"\"\"\n        if J2  0:\n            # J2 must be non-negative by definition\n            J2 = 0\n            \n        kappa = k0 + k1 * p\n        if abs(kappa)  TOLERANCE:\n            # Avoid division by zero, return large value if on failure locus\n            return np.inf if J2 > TOLERANCE else -1.0\n            \n        F_val = (np.sqrt(J2) / kappa) * (1.0 + beta * cos3theta) - 1.0\n        return F_val\n\n    results = []\n\n    # --- Task 3: Hydrostatic-shift test ---\n    beta_hydro_shift = 0.3\n    s_diag_a = np.array([10.0, -5.0, -5.0])\n    p_a = 30.0\n    delta_p = 50.0\n    p_b = p_a + delta_p\n\n    sigma_a = np.diag(s_diag_a) + p_a * np.identity(3)\n    sigma_b = np.diag(s_diag_a) + p_b * np.identity(3)\n\n    p_val_a, J2_a, J3_a, cos3theta_a = compute_invariants(sigma_a)\n    p_val_b, J2_b, J3_b, cos3theta_b = compute_invariants(sigma_b)\n\n    # Check for equality within tolerance\n    j2_eq = abs(J2_a - J2_b)  TOLERANCE\n    j3_eq = abs(J3_a - J3_b)  TOLERANCE\n    cos3th_eq = abs(cos3theta_a - cos3theta_b)  TOLERANCE\n\n    F_a = yield_function(p_val_a, J2_a, cos3theta_a, beta_hydro_shift)\n    F_b = yield_function(p_val_b, J2_b, cos3theta_b, beta_hydro_shift)\n    f_diff = F_b - F_a\n    results.extend([j2_eq, j3_eq, cos3th_eq, f_diff])\n\n    # --- Task 4: Lode-angle path test ---\n    p_fixed = 30.0\n    J2_fixed = 1600.0\n    R = np.sqrt(2 * J2_fixed)\n    path_angles = np.array([-np.pi/6, -np.pi/9, -np.pi/12, -np.pi/18, 0,\n                            np.pi/18, np.pi/12, np.pi/9, np.pi/6])\n\n    f_values_b03 = []\n    f_values_b00 = []\n\n    for theta_val in path_angles:\n        s1 = (2.0 / np.sqrt(6.0)) * R * np.cos(theta_val)\n        s2 = (2.0 / np.sqrt(6.0)) * R * np.cos(theta_val - 2.0 * np.pi / 3.0)\n        s3 = (2.0 / np.sqrt(6.0)) * R * np.cos(theta_val + 2.0 * np.pi / 3.0)\n        \n        sigma_path = p_fixed * np.identity(3) + np.diag([s1, s2, s3])\n        p_path, J2_path, J3_path, cos3theta_path = compute_invariants(sigma_path)\n        \n        f_b03 = yield_function(p_path, J2_path, cos3theta_path, 0.3)\n        f_b00 = yield_function(p_path, J2_path, cos3theta_path, 0.0)\n        \n        f_values_b03.append(f_b03)\n        f_values_b00.append(f_b00)\n\n    amp_03 = max(f_values_b03) - min(f_values_b03)\n    amp_00 = max(f_values_b00) - min(f_values_b00)\n    is_pos_amp03 = amp_03 > TOLERANCE  # Check if strictly positive beyond tolerance\n    is_zero_amp00 = amp_00  TOLERANCE\n    results.extend([amp_03, amp_00, is_pos_amp03, is_zero_amp00])\n    \n    # --- Task 5: Evaluate specific states ---\n    beta_specific = 0.3\n    \n    # Pure hydrostatic state\n    sigma_h = 50.0 * np.identity(3)\n    p_h, J2_h, _, cos3theta_h = compute_invariants(sigma_h)\n    F_h = yield_function(p_h, J2_h, cos3theta_h, beta_specific)\n    results.append(F_h)\n\n    # General non-hydrostatic state\n    sigma_g = np.array([[120.0, 15.0, -10.0],\n                        [15.0, 80.0, 5.0],\n                        [-10.0, 5.0, 100.0]])\n    p_g, J2_g, _, cos3theta_g = compute_invariants(sigma_g)\n    F_g = yield_function(p_g, J2_g, cos3theta_g, beta_specific)\n    results.append(F_g)\n    \n    # --- Final Output ---\n    # Convert all results to strings for a uniform list\n    # Booleans will be converted to 'True'/'False'\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在计算固体力学中，尤其是在大变形问题中，确保本构模型的物理一致性至关重要。最后一个实践聚焦于一个更高级且微妙的主题：保证有限应变超弹性模型中的客观性（或称物质标架无关性）。你将通过实现一个正确的和一个有缺陷的应力计算方法，并设计一个数值实验来揭示这个缺陷，从而亲身体验在参考构型和当前构型之间不恰当地混合张量场如何导致对基本物理原理的违背。",
            "id": "3605128",
            "problem": "考虑一种可压缩、各向同性的有限应变超弹性材料。令变形梯度表示为 $F$，左柯西-格林张量为 $B = F F^{\\mathsf{T}}$，右柯西-格林张量为 $C = F^{\\mathsf{T}} F$，雅可比行列式为 $J = \\det(F)$。各向同性和标架无关性意味着应变能密度可以写为 $C$ 或 $B$ 的不变量的标量函数。定义二阶张量 $T$ 的第一和第二不变量为 $I_1(T) = \\operatorname{tr}(T)$ 和 $I_2(T) = \\tfrac{1}{2} \\left( \\operatorname{tr}(T)^2 - \\operatorname{tr}(T^2) \\right)$。\n\n我们考虑应变能\n$$\nW\\!\\left(I_1(C), I_2(C), J\\right) = a_1\\, I_1(C) + a_2\\, I_2(C) + \\frac{\\kappa}{2}\\, \\left(\\ln J\\right)^2,\n$$\n其中材料参数为 $a_1$、$a_2$ 和 $\\kappa$。从客观性和功共轭的基本定义和原理出发，推导第二皮奥拉-基尔霍夫应力 $S$ 的表达式，以及通过推前操作得到的相应柯西应力 $\\sigma$。然后，定义并实现一个故意设计的有缺陷的“混合不变量”应力计算，在该计算中，代码使用张量 $B$ 乘以导数 $\\partial W / \\partial C$ 来形成一个空间（基尔霍夫）应力，即 $\\tau_{\\text{bug}} = 2\\, B \\left( \\partial W / \\partial C \\right)$，并设置 $\\sigma_{\\text{bug}} = \\tau_{\\text{bug}} / J$。解释为什么这种构造不是功共轭的，并且通常会违反标架无关性。\n\n设计一个数值实验，通过在叠加刚体旋转下测试标架无关性，来检测这种混合不变量错误引入的偏差。具体来说，对于每个测试用例：\n- 构造 $F = R(\\theta)\\, U\\, S(\\gamma)$，其中 $R(\\theta)$ 是绕 z 轴旋转角度 $\\theta$ 的旋转，$U = \\operatorname{diag}(s_1, s_2, s_3)$ 是一个对角拉伸，$S(\\gamma)$ 是 x-y 平面内的简单剪切，其剪切参数 $\\gamma$ 由 $S(\\gamma) = \\begin{bmatrix} 1  \\gamma  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{bmatrix}$ 给出。角度必须以弧度表示。\n- 施加一个绕 y 轴旋转角度 $\\phi$ 的叠加刚体旋转 $Q(\\phi)$，形成 $F' = Q(\\phi)\\, F$。\n- 计算正确的柯西应力 $\\sigma(F)$ 和 $\\sigma(F')$，并通过使用相对残差将 $\\sigma(F')$ 与 $Q(\\phi)\\, \\sigma(F)\\, Q(\\phi)^{\\mathsf{T}}$ 进行比较来验证客观性：\n$$\nr_{\\text{ok}} = \\frac{\\left\\| \\sigma(F') - Q(\\phi)\\, \\sigma(F)\\, Q(\\phi)^{\\mathsf{T}} \\right\\|_F}{\\left\\| Q(\\phi)\\, \\sigma(F)\\, Q(\\phi)^{\\mathsf{T}} \\right\\|_F + \\varepsilon},\n$$\n其中 $\\|\\cdot\\|_F$ 表示弗罗贝尼乌斯范数，$\\varepsilon$ 是一个小的正数以避免除以零。\n- 使用混合不变量构造计算有缺陷的柯西应力 $\\sigma_{\\text{bug}}(F)$ 和 $\\sigma_{\\text{bug}}(F')$，并评估\n$$\nr_{\\text{bug}} = \\frac{\\left\\| \\sigma_{\\text{bug}}(F') - Q(\\phi)\\, \\sigma_{\\text{bug}}(F)\\, Q(\\phi)^{\\mathsf{T}} \\right\\|_F}{\\left\\| Q(\\phi)\\, \\sigma_{\\text{bug}}(F)\\, Q(\\phi)^{\\mathsf{T}} \\right\\|_F + \\varepsilon}。\n$$\n如果 $r_{\\text{ok}} \\le t_{\\text{ok}}$ 且 $r_{\\text{bug}}  t_{\\text{bug}}$，则声明检测到偏差，其中阈值为 $t_{\\text{ok}} = 10^{-12}$ 和 $t_{\\text{bug}} = 10^{-6}$，并使用 $\\varepsilon = 10^{-16}$。\n\n您的程序必须实现以上内容，使用以下材料参数：$a_1 = 4.0$，$a_2 = 1.2$，$\\kappa = 50.0$。使用以下三个由 $(\\theta, \\phi, s_1, s_2, s_3, \\gamma)$ 指定的测试用例，所有角度均为弧度：\n1. $(\\theta = 0.5, \\phi = 0.7, s_1 = 1.3, s_2 = 0.9, s_3 = 1.1, \\gamma = 0.4)$，\n2. $(\\theta = 0.3, \\phi = 0.6, s_1 = 1.1, s_2 = 1.1, s_3 = 1.1, \\gamma = 0.0)$，\n3. $(\\theta = 1.1, \\phi = 0.9, s_1 = 1.0, s_2 = 1.0, s_3 = 1.0, \\gamma = 1.5)$。\n\n对于每个测试用例，返回一个布尔值，指示是否检测到偏差。您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔的结果列表（例如，$[ \\text{result}_1, \\text{result}_2, \\text{result}_3 ]$），其中每个 $\\text{result}_i$ 是布尔字面量 $\\text{True}$ 或 $\\text{False}$。",
            "solution": "该问题陈述被评估为有效，因为它在科学上基于连续介质力学，是适定的、客观的且内部一致的。我们将继续进行推导和数值实现。\n\n分析分为三个部分：首先，从给定的应变能函数推导正确的、客观的应力-应变关系；其次，分析所提出的“混合不变量”公式以证明其根本性缺陷；第三，设计并实现一个数值实验来检测这些缺陷所带来的后果。\n\n**1. 正确本构律的推导**\n\n超弹性的基石是应力张量由一个标量势（即应变能密度函数 $W$）导出。对于材料构型，第二皮奥拉-基尔霍夫应力张量 $S$ 与右柯西-格林张量 $C$ 的变化率是能量共轭的。该关系表示为：\n$$\nS = 2 \\frac{\\partial W}{\\partial C}\n$$\n给定的应变能函数为 $W\\!\\left(I_1(C), I_2(C), J\\right) = a_1\\, I_1(C) + a_2\\, I_2(C) + \\frac{\\kappa}{2}\\, \\left(\\ln J\\right)^2$。为了求得 $S$，我们应用链式法则：\n$$\nS = 2 \\left( \\frac{\\partial W}{\\partial I_1(C)} \\frac{\\partial I_1(C)}{\\partial C} + \\frac{\\partial W}{\\partial I_2(C)} \\frac{\\partial I_2(C)}{\\partial C} + \\frac{\\partial W}{\\partial J} \\frac{\\partial J}{\\partial C} \\right)\n$$\n$W$ 关于不变量的所需偏导数是：\n$$\n\\frac{\\partial W}{\\partial I_1(C)} = a_1\n$$\n$$\n\\frac{\\partial W}{\\partial I_2(C)} = a_2\n$$\n$$\n\\frac{\\partial W}{\\partial J} = \\frac{\\kappa}{J} \\ln J\n$$\n不变量关于张量 $C$ 的导数是张量微积分中的标准结果：\n$$\n\\frac{\\partial I_1(C)}{\\partial C} = \\frac{\\partial \\operatorname{tr}(C)}{\\partial C} = I\n$$\n$$\n\\frac{\\partial I_2(C)}{\\partial C} = \\frac{\\partial}{\\partial C} \\left( \\tfrac{1}{2} \\left( \\operatorname{tr}(C)^2 - \\operatorname{tr}(C^2) \\right) \\right) = I_1(C) I - C\n$$\n$$\n\\frac{\\partial J}{\\partial C} = \\frac{\\partial \\sqrt{\\det(C)}}{\\partial C} = \\frac{1}{2\\sqrt{\\det(C)}} \\frac{\\partial \\det(C)}{\\partial C} = \\frac{1}{2J} J C^{-1} = \\frac{1}{2} J C^{-1}\n$$\n其中 $I$ 是二阶单位张量，最后一个结果利用了雅可比公式。\n\n将这些代入 $S$ 的表达式，得到：\n$$\nS = 2 \\left( a_1 I + a_2 \\left( I_1(C) I - C \\right) + \\left( \\frac{\\kappa}{J} \\ln J \\right) \\left( \\frac{1}{2} J C^{-1} \\right) \\right)\n$$\n$$\nS = 2 a_1 I + 2 a_2 \\left( I_1(C) I - C \\right) + \\kappa (\\ln J) C^{-1}\n$$\n这是在参考构型中的第二皮奥拉-基尔霍夫应力的表达式。在当前（变形）构型中物理上相关的应力是柯西应力 $\\sigma$。它是通过对 $S$ 进行推前操作得到的：\n$$\n\\sigma = \\frac{1}{J} F S F^{\\mathsf{T}}\n$$\n代入 $S$ 的表达式：\n$$\n\\sigma = \\frac{1}{J} F \\left( 2 a_1 I + 2 a_2 (I_1(C) I - C) + \\kappa (\\ln J) C^{-1} \\right) F^{\\mathsf{T}}\n$$\n我们使用运动学恒等式 $B = F F^{\\mathsf{T}}$、$I_1(C) = I_1(B)$、$F C F^{\\mathsf{T}} = F (F^{\\mathsf{T}} F) F^{\\mathsf{T}} = (F F^{\\mathsf{T}}) (F F^{\\mathsf{T}}) = B^2$ 以及 $F C^{-1} F^{\\mathsf{T}} = F (F^{\\mathsf{T}} F)^{-1} F^{\\mathsf{T}} = F F^{-1} (F^{\\mathsf{T}})^{-1} F^{\\mathsf{T}} = I$ 来简化各项。\n$$\n\\sigma = \\frac{1}{J} \\left( 2 a_1 ( F I F^{\\mathsf{T}} ) + 2 a_2 (I_1(C) F F^{\\mathsf{T}} - F C F^{\\mathsf{T}}) + \\kappa (\\ln J) F C^{-1} F^{\\mathsf{T}} \\right)\n$$\n$$\n\\sigma = \\frac{1}{J} \\left( 2 a_1 B + 2 a_2 (I_1(B) B - B^2) + \\kappa (\\ln J) I \\right)\n$$\n这个柯西应力 $\\sigma$ 的最终表达式完全由空间量（$B$、$J$、$I$）表示，并且通过其推导过程保证了其客观性。\n\n**2. 有缺陷的“混合不变量”公式分析**\n\n问题将一个有缺陷的（“buggy”）应力计算定义为：\n$$\n\\tau_{\\text{bug}} = 2 B \\frac{\\partial W}{\\partial C} \\quad \\text{且} \\quad \\sigma_{\\text{bug}} = \\frac{1}{J} \\tau_{\\text{bug}}\n$$\n由于 $S = 2 \\partial W / \\partial C$，这个有缺陷的公式等价于 $\\tau_{\\text{bug}} = B S$。这是不正确的；正确的基尔霍夫应力是 $\\tau = F S F^{\\mathsf{T}}$。表达式 $B S = (F F^{\\mathsf{T}})S$ 与 $F S F^{\\mathsf{T}}$ 并不等价，除非 $S$ 和 $F^{\\mathsf{T}}$ 可交换，而这通常不成立。该公式存在缺陷，原因有二：\n\n首先，它是**非功共轭的**。从势函数推导应力是基于应力和应变度量的一种特定配对，这种配对确保了能量守恒。这个有缺陷的公式绕过了这一严谨的推导，而是对一个空间张量 $B$ 和一个材料张量 $S$ 进行了一种临时的乘法。这种操作没有物理基础，并破坏了超弹性所要求的能量一致性。\n\n其次，它**违反了标架无关性（客观性）**。客观性原理要求本构律在观察者改变下保持不变，这被建模为一次叠加的刚体旋转。假设当前构型经历一次由正交张量 $Q$（$Q Q^{\\mathsf{T}} = I$，$\\det(Q) = 1$）描述的旋转。变形梯度变换为 $F' = Q F$。\n相应的运动学张量的变换为：\n- 右柯西-格林张量：$C' = (F')^{\\mathsf{T}} F' = (Q F)^{\\mathsf{T}} (Q F) = F^{\\mathsf{T}} Q^{\\mathsf{T}} Q F = F^{\\mathsf{T}} I F = C$。$C$ 是客观的（不变的）。\n- 雅可比行列式：$J' = \\det(F') = \\det(Q F) = \\det(Q) \\det(F) = 1 \\cdot J = J$。$J$ 是客观的。\n- 左柯西-格林张量：$B' = F' (F')^{\\mathsf{T}} = (Q F) (Q F)^{\\mathsf{T}} = Q F F^{\\mathsf{T}} Q^{\\mathsf{T}} = Q B Q^{\\mathsf{T}}$。$B$ 作为一个合适的空间张量进行变换。\n\n由于 $C$ 和 $J$ 是不变量，应变能 $W$ 及其关于 $C$ 的导数 $\\partial W / \\partial C$ 也是不变量。\n让我们在新标架中计算有缺陷的应力：\n$$\n\\sigma_{\\text{bug}}(F') = \\frac{1}{J'} \\left( 2 B' \\frac{\\partial W(C', J')}{\\partial C'} \\right) = \\frac{2}{J} (Q B Q^{\\mathsf{T}}) \\frac{\\partial W(C, J)}{\\partial C}\n$$\n为了使客观性成立，$\\sigma_{\\text{bug}}(F')$ 必须等于旋转后的原始有缺陷应力 $Q \\sigma_{\\text{bug}}(F) Q^{\\mathsf{T}}$：\n$$\nQ \\sigma_{\\text{bug}}(F) Q^{\\mathsf{T}} = Q \\left( \\frac{2}{J} B \\frac{\\partial W(C, J)}{\\partial C} \\right) Q^{\\mathsf{T}} = \\frac{2}{J} Q B \\frac{\\partial W(C, J)}{\\partial C} Q^{\\mathsf{T}}\n$$\n客观性要求等式：\n$$\n\\frac{2}{J} (Q B Q^{\\mathsf{T}}) \\frac{\\partial W}{\\partial C} = \\frac{2}{J} Q B \\frac{\\partial W}{\\partial C} Q^{\\mathsf{T}}\n$$\n这简化为 $(Q B Q^{\\mathsf{T}}) A = Q B A Q^{\\mathsf{T}}$，其中 $A = \\partial W / \\partial C$。对于任意张量 $B$、$A$ 和旋转 $Q$，这个等式不成立，因为矩阵乘法不满足交换律。该表达式不恰当地将一个空间张量 $B$ 和一个材料张量 $A$ 混合在一起，导致了非客观的结果。\n\n**3. 数值实验**\n\n数值实验将具体地展示对客观性的违反。我们将为给定的变形 $F$ 计算正确的柯西应力 $\\sigma(F)$ 和有缺陷的应力 $\\sigma_{\\text{bug}}(F)$。然后我们施加一个叠加旋转 $Q$ 得到 $F' = Q F$，并计算 $\\sigma(F')$ 和 $\\sigma_{\\text{bug}}(F')$。\n正确应力的客观性通过检查残差 $r_{\\text{ok}} = \\frac{\\left\\| \\sigma(F') - Q \\sigma(F) Q^{\\mathsf{T}} \\right\\|_F}{\\left\\| Q \\sigma(F) Q^{\\mathsf{T}} \\right\\|_F + \\varepsilon}$ 是否接近机器精度（$r_{\\text{ok}} \\le 10^{-12}$）来验证。\n如果其相应的残差 $r_{\\text{bug}} = \\frac{\\left\\| \\sigma_{\\text{bug}}(F') - Q \\sigma_{\\text{bug}}(F) Q^{\\mathsf{T}} \\right\\|_F}{\\left\\| Q \\sigma_{\\text{bug}}(F) Q^{\\mathsf{T}} \\right\\|_F + \\varepsilon}$ 显著大于零（$r_{\\text{bug}}  10^{-6}$），则检测到有缺陷应力的非客观性。\n如果两个条件都满足，则检测到偏差，从而证实了理论分析。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_stresses(F, a1, a2, kappa):\n    \"\"\"\n    Computes the correct Cauchy stress and the flawed \"mixed-invariants\"\n    Cauchy stress for a given deformation gradient F.\n    \"\"\"\n    I = np.eye(3)\n    J = np.linalg.det(F)\n    \n    # It is numerically more stable to compute B first, then C if needed.\n    B = F @ F.T\n    \n    # --- Correct Cauchy Stress Calculation (spatial form) ---\n    I1_B = np.trace(B)\n    B_sq = B @ B\n    \n    # sigma = (1/J) * (2*a1*B + 2*a2*(I1_B*B - B_sq) + kappa*np.log(J)*I)\n    # The problem description implicitly suggests a volumetric/deviatoric split\n    # where the volumetric part (involving J) contributes only to the pressure.\n    # The term a1*I1(C) + a2*I2(C) is often used for the isochoric part.\n    # In that context, one would use modified invariants. However, following the\n    # problem statement literally:\n    # W = a1*I1(C) + a2*I2(C) + (kappa/2)*(lnJ)^2\n    # The derived spatial form is used here.\n    \n    term_a1 = 2.0 * a1 * B\n    term_a2 = 2.0 * a2 * (I1_B * B - B_sq)\n    term_kappa = kappa * np.log(J) * I\n    \n    sigma_correct = (1.0 / J) * (term_a1 + term_a2 + term_kappa)\n    \n    # --- Buggy Cauchy Stress Calculation (mixed-frame form) ---\n    C = F.T @ F\n    try:\n        C_inv = np.linalg.inv(C)\n    except np.linalg.LinAlgError:\n        # Handle singular C if it occurs, though unlikely with given test cases.\n        return sigma_correct, np.full((3,3), np.nan)\n\n    I1_C = np.trace(C)\n    \n    # S = 2 * dW/dC\n    S = 2.0 * a1 * I + 2.0 * a2 * (I1_C * I - C) + kappa * np.log(J) * C_inv\n    \n    # tau_bug = B @ S\n    tau_bug = B @ S\n    sigma_buggy = (1.0 / J) * tau_bug\n    \n    return sigma_correct, sigma_buggy\n\ndef solve():\n    \"\"\"\n    Main function to run the numerical experiment for detecting bias.\n    \"\"\"\n    # Material parameters\n    a1 = 4.0\n    a2 = 1.2\n    kappa = 50.0\n\n    # Numerical thresholds and constants\n    t_ok = 1e-12\n    t_bug = 1e-6\n    epsilon = 1e-16\n\n    # Test cases: (theta, phi, s1, s2, s3, gamma)\n    test_cases = [\n        (0.5, 0.7, 1.3, 0.9, 1.1, 0.4),\n        (0.3, 0.6, 1.1, 1.1, 1.1, 0.0),\n        (1.1, 0.9, 1.0, 1.0, 1.0, 1.5),\n    ]\n\n    results = []\n\n    for case in test_cases:\n        theta, phi, s1, s2, s3, gamma = case\n\n        # --- Construct matrices ---\n        # Rotation about z-axis\n        cos_t, sin_t = np.cos(theta), np.sin(theta)\n        R_z = np.array([[cos_t, -sin_t, 0],\n                        [sin_t,  cos_t, 0],\n                        [0,      0,     1]])\n\n        # Diagonal stretch\n        U = np.diag([s1, s2, s3])\n\n        # Simple shear in x-y plane\n        S_gamma = np.array([[1, gamma, 0],\n                            [0, 1,     0],\n                            [0, 0,     1]])\n\n        # Superposed rotation about y-axis\n        cos_p, sin_p = np.cos(phi), np.sin(phi)\n        Q_y = np.array([[cos_p,  0, sin_p],\n                        [0,      1, 0],\n                        [-sin_p, 0, cos_p]])\n        Q = Q_y\n\n        # --- Compute deformation gradients ---\n        F = R_z @ U @ S_gamma\n        F_prime = Q @ F\n\n        # --- Compute stresses ---\n        sigma_F_ok, sigma_F_bug = compute_stresses(F, a1, a2, kappa)\n        sigma_F_prime_ok, sigma_F_prime_bug = compute_stresses(F_prime, a1, a2, kappa)\n        \n        # --- Evaluate residuals ---\n        \n        # Correct stress objectivity check\n        sigma_F_ok_rotated = Q @ sigma_F_ok @ Q.T\n        num_ok = np.linalg.norm(sigma_F_prime_ok - sigma_F_ok_rotated, 'fro')\n        den_ok = np.linalg.norm(sigma_F_ok_rotated, 'fro') + epsilon\n        r_ok = num_ok / den_ok\n\n        # Buggy stress objectivity check\n        sigma_F_bug_rotated = Q @ sigma_F_bug @ Q.T\n        num_bug = np.linalg.norm(sigma_F_prime_bug - sigma_F_bug_rotated, 'fro')\n        den_bug = np.linalg.norm(sigma_F_bug_rotated, 'fro') + epsilon\n        r_bug = num_bug / den_bug\n\n        # --- Check for bias detection ---\n        bias_detected = (r_ok = t_ok) and (r_bug > t_bug)\n        results.append(bias_detected)\n\n    # Convert numpy booleans to Python booleans for standard string representation\n    py_results = [bool(r) for r in results]\n    print(f\"[{','.join(map(str, py_results))}]\")\n\nsolve()\n\n```"
        }
    ]
}