{
    "hands_on_practices": [
        {
            "introduction": "我们从一个基础练习开始，这个练习旨在巩固各向同性张量函数表示定理的两个核心基石：主不变量和Cayley-Hamilton定理。通过为一个给定的二阶张量推导其主不变量的显式表达式，并直接验证Cayley-Hamilton恒等式，您将深入理解这些不变量是如何从张量的特征多项式中自然产生的。这个练习将为您后续更复杂的张量运算和本构模型实现打下坚实的理论基础。",
            "id": "3595159",
            "problem": "考虑一个三维空间中的均匀、各向同性本构模型，其中各向同性意味着任何依赖于二阶张量 $A$ 的标量响应都可以用 $A$ 的主不变量来表示。设 $A$ 是一个二阶张量，其在标准正交基下的谱表示为 $A=\\mathrm{diag}(\\lambda_{1},\\lambda_{2},\\lambda_{3})$，其中 $\\lambda_{1},\\lambda_{2},\\lambda_{3}\\in\\mathbb{R}$ 是互不相同的的主值。$A$ 的主不变量 $I_{1}$、$I_{2}$ 和 $I_{3}$ 是 $A$ 的特征多项式 $\\det(\\eta I - A)$ 中出现的标量系数，其中 $I$ 是单位张量，$\\eta$ 是一个标量不定元。从二阶张量的特征值、行列式和特征多项式的基本定义出发，并仅以此为基础，执行以下操作：\n\n- 推导 $I_{1}$、$I_{2}$ 和 $I_{3}$ 关于 $\\lambda_{1}$、$\\lambda_{2}$ 和 $\\lambda_{3}$ 的显式解析表达式。\n- 使用这些表达式，在所选基中通过直接计算来验证 $A$ 的 Cayley–Hamilton 恒等式 $A^{3}-I_{1}A^{2}+I_{2}A-I_{3}I=\\mathbf{0}$。\n\n将您的最终答案表示为一个包含 $I_{1}$、$I_{2}$ 和 $I_{3}$ 的单行矩阵，形式为封闭式。不需要进行数值计算或四舍五入，也不涉及物理单位。",
            "solution": "该问题要求推导二阶张量 $A$ 的主不变量，并随后验证该张量的 Cayley-Hamilton 恒等式。分析将在给定的标准正交基中进行，在该基中 $A$ 是对角阵。\n\n首先，我们推导主不变量 $I_{1}$、$I_{2}$ 和 $I_{3}$ 的表达式。问题将它们定义为特征多项式 $p(\\eta) = \\det(\\eta I - A)$ 中的标量系数。在三维空间中，一个二阶张量的特征多项式的标准形式为 $p(\\eta) = \\eta^{3} - I_{1}\\eta^{2} + I_{2}\\eta - I_{3}$。\n\n张量 $A$ 在其标准正交基中的谱表示为一个对角矩阵，其对角线上的元素为其主值（特征值）$\\lambda_{1}$、$\\lambda_{2}$ 和 $\\lambda_{3}$：\n$$\nA = \\begin{pmatrix}\n\\lambda_{1} & 0 & 0 \\\\\n0 & \\lambda_{2} & 0 \\\\\n0 & 0 & \\lambda_{3}\n\\end{pmatrix}\n$$\n在相同基下的单位张量 $I$ 为：\n$$\nI = \\begin{pmatrix}\n1 & 0 & 0 \\\\\n0 & 1 & 0 \\\\\n0 & 0 & 1\n\\end{pmatrix}\n$$\n我们构造张量 $\\eta I - A$：\n$$\n\\eta I - A = \\eta \\begin{pmatrix}\n1 & 0 & 0 \\\\\n0 & 1 & 0 \\\\\n0 & 0 & 1\n\\end{pmatrix} - \\begin{pmatrix}\n\\lambda_{1} & 0 & 0 \\\\\n0 & \\lambda_{2} & 0 \\\\\n0 & 0 & \\lambda_{3}\n\\end{pmatrix} = \\begin{pmatrix}\n\\eta - \\lambda_{1} & 0 & 0 \\\\\n0 & \\eta - \\lambda_{2} & 0 \\\\\n0 & 0 & \\eta - \\lambda_{3}\n\\end{pmatrix}\n$$\n这个对角矩阵的行列式是其对角元素的乘积：\n$$\n\\det(\\eta I - A) = (\\eta - \\lambda_{1})(\\eta - \\lambda_{2})(\\eta - \\lambda_{3})\n$$\n我们展开这个乘积，得到关于 $\\eta$ 的多项式：\n$$\n\\begin{aligned}\n\\det(\\eta I - A) &= (\\eta^{2} - (\\lambda_{1} + \\lambda_{2})\\eta + \\lambda_{1}\\lambda_{2})(\\eta - \\lambda_{3}) \\\\\n&= \\eta^{3} - \\lambda_{3}\\eta^{2} - (\\lambda_{1} + \\lambda_{2})\\eta^{2} + \\lambda_{3}(\\lambda_{1} + \\lambda_{2})\\eta + \\lambda_{1}\\lambda_{2}\\eta - \\lambda_{1}\\lambda_{2}\\lambda_{3} \\\\\n&= \\eta^{3} - (\\lambda_{1} + \\lambda_{2} + \\lambda_{3})\\eta^{2} + (\\lambda_{1}\\lambda_{2} + \\lambda_{1}\\lambda_{3} + \\lambda_{2}\\lambda_{3})\\eta - \\lambda_{1}\\lambda_{2}\\lambda_{3}\n\\end{aligned}\n$$\n通过将此展开形式与标准特征多项式 $p(\\eta) = \\eta^{3} - I_{1}\\eta^{2} + I_{2}\\eta - I_{3}$ 进行比较，我们可以通过令 $\\eta$ 的各次幂的系数相等来确定不变量：\n$\\eta^{2}$ 的系数给出 $-I_{1} = -(\\lambda_{1} + \\lambda_{2} + \\lambda_{3})$，这意味着：\n$$\nI_{1} = \\lambda_{1} + \\lambda_{2} + \\lambda_{3}\n$$\n这是张量 $A$ 的迹，$\\mathrm{tr}(A)$。\n\n$\\eta$ 的系数给出 $I_{2} = \\lambda_{1}\\lambda_{2} + \\lambda_{1}\\lambda_{3} + \\lambda_{2}\\lambda_{3}$。这也可以表示为 $I_{2} = \\frac{1}{2}[(\\mathrm{tr}(A))^{2} - \\mathrm{tr}(A^{2})]$。\n$$\nI_{2} = \\lambda_{1}\\lambda_{2} + \\lambda_{2}\\lambda_{3} + \\lambda_{3}\\lambda_{1}\n$$\n常数项给出 $-I_{3} = -\\lambda_{1}\\lambda_{2}\\lambda_{3}$，这意味着：\n$$\nI_{3} = \\lambda_{1}\\lambda_{2}\\lambda_{3}\n$$\n这是张量 $A$ 的行列式，$\\det(A)$。\n\n接下来，我们验证 Cayley-Hamilton 恒等式，该恒等式指出一个张量满足其自身的特征方程：\n$$\nA^{3} - I_{1}A^{2} + I_{2}A - I_{3}I = \\mathbf{0}\n$$\n我们在给定的基中进行直接计算。首先，我们计算矩阵 $A$ 所需的幂：\n$$\nA^{2} = A A = \\begin{pmatrix}\n\\lambda_{1}^{2} & 0 & 0 \\\\\n0 & \\lambda_{2}^{2} & 0 \\\\\n0 & 0 & \\lambda_{3}^{2}\n\\end{pmatrix}\n$$\n$$\nA^{3} = A^{2} A = \\begin{pmatrix}\n\\lambda_{1}^{3} & 0 & 0 \\\\\n0 & \\lambda_{2}^{3} & 0 \\\\\n0 & 0 & \\lambda_{3}^{3}\n\\end{pmatrix}\n$$\n现在，将 $A$、$A^{2}$、$A^{3}$、$I$ 以及不变量 $I_{1}$、$I_{2}$、$I_{3}$ 的表达式代入 Cayley-Hamilton 方程。我们来检查结果矩阵的 $(1,1)$ 分量：\n$$\n(\\text{Result})_{(1,1)} = \\lambda_{1}^{3} - (\\lambda_{1}+\\lambda_{2}+\\lambda_{3})\\lambda_{1}^{2} + (\\lambda_{1}\\lambda_{2}+\\lambda_{2}\\lambda_{3}+\\lambda_{3}\\lambda_{1})\\lambda_{1} - \\lambda_{1}\\lambda_{2}\\lambda_{3}\n$$\n展开各项：\n$$\n= \\lambda_{1}^{3} - \\lambda_{1}^{3} - \\lambda_{2}\\lambda_{1}^{2} - \\lambda_{3}\\lambda_{1}^{2} + \\lambda_{1}^{2}\\lambda_{2} + \\lambda_{1}\\lambda_{2}\\lambda_{3} + \\lambda_{1}^{2}\\lambda_{3} - \\lambda_{1}\\lambda_{2}\\lambda_{3}\n$$\n合并同类项：\n$$\n= (\\lambda_{1}^{3} - \\lambda_{1}^{3}) + (-\\lambda_{2}\\lambda_{1}^{2} + \\lambda_{1}^{2}\\lambda_{2}) + (-\\lambda_{3}\\lambda_{1}^{2} + \\lambda_{1}^{2}\\lambda_{3}) + (\\lambda_{1}\\lambda_{2}\\lambda_{3} - \\lambda_{1}\\lambda_{2}\\lambda_{3})\n$$\n$$\n= 0 + 0 + 0 + 0 = 0\n$$\n一种更优雅的替代方法是认识到矩阵方程 $A^{3} - I_{1}A^{2} + I_{2}A - I_{3}I$ 的对角线元素恰好是在每个特征值 $\\lambda_{i}$ 处求值的特征多项式 $p(\\eta)$。对于第 $i$ 个对角线元素，我们有：\n$$\n(\\text{Result})_{(i,i)} = \\lambda_{i}^{3} - I_{1}\\lambda_{i}^{2} + I_{2}\\lambda_{i} - I_{3} = p(\\lambda_{i})\n$$\n根据定义，特征值 $\\lambda_{1}$、$\\lambda_{2}$ 和 $\\lambda_{3}$ 是特征多项式 $p(\\eta) = \\det(\\eta I - A) = 0$ 的根。因此，$p(\\lambda_{1}) = 0$，$p(\\lambda_{2}) = 0$ 且 $p(\\lambda_{3}) = 0$。\n在整个计算过程中，非对角线元素都为零。因此，结果矩阵是零矩阵：\n$$\nA^{3} - I_{1}A^{2} + I_{2}A - I_{3}I = \\begin{pmatrix}\np(\\lambda_{1}) & 0 & 0 \\\\\n0 & p(\\lambda_{2}) & 0 \\\\\n0 & 0 & p(\\lambda_{3})\n\\end{pmatrix} = \\begin{pmatrix}\n0 & 0 & 0 \\\\\n0 & 0 & 0 \\\\\n0 & 0 & 0\n\\end{pmatrix} = \\mathbf{0}\n$$\n这直接验证了在所选基中张量 $A$ 的 Cayley-Hamilton 恒等式。因此，不变量的表达式得到了证实。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\lambda_{1} + \\lambda_{2} + \\lambda_{3} & \\lambda_{1}\\lambda_{2} + \\lambda_{2}\\lambda_{3} + \\lambda_{3}\\lambda_{1} & \\lambda_{1}\\lambda_{2}\\lambda_{3}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "掌握了Cayley-Hamilton定理之后，我们现在将其付诸实践，来解决一个在连续介质力学中常见的问题：简化高阶张量多项式。这个练习要求您将一个四阶张量多项式降阶为标准的二次范式，这直接展示了表示定理的威力。通过这个练习，您将学会如何系统地将任何复杂的各向同性张量函数简化为其最简形式，这是推导和实现本构律的一项关键技能。",
            "id": "3595140",
            "problem": "在计算固体力学中，任何三维空间中单个二阶张量自变量的各向同性张量函数，都可以用单位张量和该自变量的幂来表示。设 $\\mathbf{A}$ 是 $\\mathbb{R}^{3}$ 上的一个二阶张量，其主不变量为 $I_{1}$、$I_{2}$ 和 $I_{3}$，其中 $I_{1}=\\mathrm{tr}\\,\\mathbf{A}$，$I_{2}$ 是 $\\mathbf{A}$ 的2阶主子式之和，$I_{3}=\\det \\mathbf{A}$。考虑张量多项式 $p(\\mathbf{A})=\\mathbf{A}^{4}+2\\,\\mathbf{A}^{3}+\\mathbf{A}$。仅从主不变量的定义和关于 $\\mathbf{A}$ 的 Cayley–Hamilton 定理出发，将 $p(\\mathbf{A})$ 化简为典范各向同性形式 $\\alpha_{0}\\,\\mathbf{I}+\\alpha_{1}\\,\\mathbf{A}+\\alpha_{2}\\,\\mathbf{A}^{2}$，并将标量系数 $\\alpha_{i}$ 表示为 $I_{1}$、$I_{2}$ 和 $I_{3}$ 的闭式函数。请以行矩阵 $\\begin{pmatrix}\\alpha_{0} & \\alpha_{1} & \\alpha_{2}\\end{pmatrix}$ 的形式给出你的最终答案。这是一个符号计算，不需要进行数值舍入。",
            "solution": "该问题要求将张量多项式 $p(\\mathbf{A}) = \\mathbf{A}^{4} + 2\\,\\mathbf{A}^{3} + \\mathbf{A}$ 化简为其典范各向同性形式 $\\alpha_{0}\\,\\mathbf{I} + \\alpha_{1}\\,\\mathbf{A} + \\alpha_{2}\\,\\mathbf{A}^{2}$，其中 $\\mathbf{A}$ 是三维空间 $\\mathbb{R}^{3}$ 中的一个二阶张量。系数 $\\alpha_{0}$、$\\alpha_{1}$ 和 $\\alpha_{2}$ 必须用 $\\mathbf{A}$ 的主不变量 $I_{1}$、$I_{2}$ 和 $I_{3}$ 来表示。进行此化简的基本工具是 Cayley-Hamilton 定理。\n\n在 $\\mathbb{R}^{3}$ 中，二阶张量 $\\mathbf{A}$ 的特征方程由 $\\det(\\mathbf{A} - \\lambda\\mathbf{I}) = 0$ 给出，其中 $\\lambda$ 代表特征值，$\\mathbf{I}$ 是二阶单位张量。这个三次方程可以展开为主不变量的形式：\n$$ \\lambda^{3} - I_{1}\\lambda^{2} + I_{2}\\lambda - I_{3} = 0 $$\n其中 $I_{1} = \\mathrm{tr}\\,\\mathbf{A}$，$I_{2} = \\frac{1}{2}[(\\mathrm{tr}\\,\\mathbf{A})^{2} - \\mathrm{tr}(\\mathbf{A}^{2})]$（等价于2阶主子式之和），以及 $I_{3} = \\det \\mathbf{A}$。\n\nCayley-Hamilton 定理断言张量 $\\mathbf{A}$ 满足其自身的特征方程。通过用 $\\mathbf{A}$ 代替 $\\lambda$ 并为标量项适当地引入单位张量 $\\mathbf{I}$，我们得到以下基本张量恒等式：\n$$ \\mathbf{A}^{3} - I_{1}\\mathbf{A}^{2} + I_{2}\\mathbf{A} - I_{3}\\mathbf{I} = \\mathbf{0} $$\n其中 $\\mathbf{0}$ 是零张量。此恒等式允许我们将 $\\mathbf{A}^{3}$ 表示为 $\\mathbf{A}$ 的较低次幂的线性组合：\n$$ \\mathbf{A}^{3} = I_{1}\\mathbf{A}^{2} - I_{2}\\mathbf{A} + I_{3}\\mathbf{I} $$\n这是化简的第一步。为了化简多项式 $p(\\mathbf{A})$ 中的 $\\mathbf{A}^{4}$ 项，我们将上述 $\\mathbf{A}^{3}$ 的表达式乘以 $\\mathbf{A}$：\n$$ \\mathbf{A}^{4} = \\mathbf{A} \\cdot \\mathbf{A}^{3} = \\mathbf{A}(I_{1}\\mathbf{A}^{2} - I_{2}\\mathbf{A} + I_{3}\\mathbf{I}) $$\n$$ \\mathbf{A}^{4} = I_{1}\\mathbf{A}^{3} - I_{2}\\mathbf{A}^{2} + I_{3}\\mathbf{A} $$\n所得的 $\\mathbf{A}^{4}$ 表达式仍然包含 $\\mathbf{A}^{3}$。我们必须将 Cayley-Hamilton 定理得到的 $\\mathbf{A}^{3}$ 表达式代入此 $\\mathbf{A}^{4}$ 的方程中：\n$$ \\mathbf{A}^{4} = I_{1}(I_{1}\\mathbf{A}^{2} - I_{2}\\mathbf{A} + I_{3}\\mathbf{I}) - I_{2}\\mathbf{A}^{2} + I_{3}\\mathbf{A} $$\n分配标量 $I_{1}$ 并按 $\\mathbf{A}$ 的幂次合并项：\n$$ \\mathbf{A}^{4} = I_{1}^{2}\\mathbf{A}^{2} - I_{1}I_{2}\\mathbf{A} + I_{1}I_{3}\\mathbf{I} - I_{2}\\mathbf{A}^{2} + I_{3}\\mathbf{A} $$\n$$ \\mathbf{A}^{4} = (I_{1}^{2} - I_{2})\\mathbf{A}^{2} + (I_{3} - I_{1}I_{2})\\mathbf{A} + (I_{1}I_{3})\\mathbf{I} $$\n现在我们已经成功地将 $\\mathbf{A}^{3}$ 和 $\\mathbf{A}^{4}$ 都表示成了所需的形式。我们可以将它们代入原始多项式 $p(\\mathbf{A})$ 中：\n$$ p(\\mathbf{A}) = \\mathbf{A}^{4} + 2\\,\\mathbf{A}^{3} + \\mathbf{A} $$\n$$ p(\\mathbf{A}) = \\left[ (I_{1}^{2} - I_{2})\\mathbf{A}^{2} + (I_{3} - I_{1}I_{2})\\mathbf{A} + (I_{1}I_{3})\\mathbf{I} \\right] + 2\\left[ I_{1}\\mathbf{A}^{2} - I_{2}\\mathbf{A} + I_{3}\\mathbf{I} \\right] + \\mathbf{A} $$\n为了找到典范形式 $\\alpha_{0}\\mathbf{I} + \\alpha_{1}\\mathbf{A} + \\alpha_{2}\\mathbf{A}^{2}$ 的系数 $\\alpha_{0}$、$\\alpha_{1}$ 和 $\\alpha_{2}$，我们收集每个张量幂的系数：\n\n对于单位张量 $\\mathbf{I}$ 的系数 $\\alpha_{0}$：\n$$ \\alpha_{0}\\mathbf{I} = (I_{1}I_{3})\\mathbf{I} + 2(I_{3}\\mathbf{I}) = (I_{1}I_{3} + 2I_{3})\\mathbf{I} $$\n$$ \\alpha_{0} = I_{3}(I_{1} + 2) $$\n\n对于张量 $\\mathbf{A}$ 的系数 $\\alpha_{1}$：\n$$ \\alpha_{1}\\mathbf{A} = (I_{3} - I_{1}I_{2})\\mathbf{A} + 2(-I_{2}\\mathbf{A}) + 1\\mathbf{A} = (I_{3} - I_{1}I_{2} - 2I_{2} + 1)\\mathbf{A} $$\n$$ \\alpha_{1} = 1 + I_{3} - I_{2}(I_{1} + 2) $$\n\n对于张量 $\\mathbf{A}^{2}$ 的系数 $\\alpha_{2}$：\n$$ \\alpha_{2}\\mathbf{A}^{2} = (I_{1}^{2} - I_{2})\\mathbf{A}^{2} + 2(I_{1}\\mathbf{A}^{2}) = (I_{1}^{2} - I_{2} + 2I_{1})\\mathbf{A}^{2} $$\n$$ \\alpha_{2} = I_{1}^{2} + 2I_{1} - I_{2} $$\n\n这三个标量系数 $\\alpha_{0}$、$\\alpha_{1}$ 和 $\\alpha_{2}$ 被表示为主不变量 $I_{1}$、$I_{2}$ 和 $I_{3}$ 的闭式函数。最终答案是按顺序包含这些系数的行矩阵。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} I_{3}(I_{1} + 2) & 1 + I_{3} - I_{2}(I_{1} + 2) & I_{1}^{2} + 2I_{1} - I_{2} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "现在，我们将前面学到的理论和技巧应用于计算固体力学的一个核心任务：本构模型的实现。在本练习中，您将为一个由主不变量定义的各向同性超弹性材料推导其应力和算法切线模量。这个过程需要您熟练运用链式法则来处理复合张量函数，这正是表示定理在计算实践中的直接体现。完成这个练习将使您具备从一个亥姆霍兹自由能函数 $\\widehat{W}$ 出发，推导并在有限元代码中实现材料本构响应所需关键量的能力。",
            "id": "3595206",
            "problem": "考虑一个各向同性超弹性材料，其 Helmholtz 自由能密度是右 Cauchy-Green 变形张量 $\\,\\mathbf{C}\\in\\mathbb{R}^{3\\times 3}\\,$ 的主不变量的标量函数，定义为 $\\,W(\\mathbf{C}) = \\widehat{W}(I_1(\\mathbf{C}), I_2(\\mathbf{C}), I_3(\\mathbf{C}))\\,$，其中 $\\,I_1=\\mathrm{tr}\\,\\mathbf{C}\\,$，$\\,I_2=\\tfrac{1}{2}(I_1^2 - \\mathrm{tr}\\,\\mathbf{C}^2)\\,$，以及 $\\,I_3=\\det\\mathbf{C}\\,$. 根据各向同性张量函数的表示定理，$\\,\\mathbf{C}\\,$ 的任何各向同性标量函数都可以写成 $\\,I_1, I_2, I_3\\,$ 的函数。\n\n从以下基本事实和定义出发，推导 $\\,W\\,$ 关于 $\\,\\mathbf{C}\\,$ 的一阶和二阶导数的显式表达式：\n- 一阶导数 $\\,\\partial W/\\partial \\mathbf{C}\\,$，它是一个二阶张量，以及\n- 二阶导数 $\\,\\partial^2 W/\\partial \\mathbf{C}\\,\\partial \\mathbf{C}\\,$，它是一个四阶张量。\n\n在推导中仅使用以下基本要素：\n- 多变量函数和张量函数的链式法则，\n- 不变量的微分恒等式：\n  1. $\\,\\mathrm{d}I_1 = \\mathbf{I} : \\mathrm{d}\\mathbf{C}\\,$,\n  2. $\\,\\mathrm{d}I_2 = (I_1\\mathbf{I} - \\mathbf{C}) : \\mathrm{d}\\mathbf{C}\\,$,\n  3. $\\,\\mathrm{d}I_3 = I_3\\,\\mathbf{C}^{-T} : \\mathrm{d}\\mathbf{C}\\,$,\n  其中 $\\,\\mathbf{I}\\,$ 是二阶单位张量，$:$ 表示 Frobenius 内积。\n- 上述梯度的微分，用于构建二阶导数 $\\,\\partial^2 I_\\alpha/\\partial \\mathbf{C}\\,\\partial \\mathbf{C}\\,$，限于对称变分 $\\,\\mathrm{d}\\mathbf{C}=\\mathrm{d}\\mathbf{C}^T\\,$：\n  1. $\\,\\partial^2 I_1/\\partial \\mathbf{C}\\,\\partial \\mathbf{C} = \\mathbb{O}\\,$ (零四阶张量),\n  2. $\\,\\partial^2 I_2/\\partial \\mathbf{C}\\,\\partial \\mathbf{C} = \\mathbf{I}\\otimes\\mathbf{I} - \\mathbb{I}_s\\,$, 其中 $\\,(\\mathbf{A}\\otimes\\mathbf{B})_{ijkl} = A_{ij}B_{kl}\\,$ 且 $\\,(\\mathbb{I}_s)_{ijkl}=\\tfrac{1}{2}(\\delta_{ik}\\delta_{jl}+\\delta_{il}\\delta_{jk})\\,$,\n  3. $\\,\\partial^2 I_3/\\partial \\mathbf{C}\\,\\partial \\mathbf{C} = I_3\\left(\\mathbf{C}^{-1}\\otimes\\mathbf{C}^{-1} - \\mathbb{K}_s\\right)\\,$, 其中 $\\,(\\mathbb{K}_s)_{ijkl}=\\tfrac{1}{2}\\left[(\\mathbf{C}^{-1})_{ik}(\\mathbf{C}^{-1})_{lj}+(\\mathbf{C}^{-1})_{il}(\\mathbf{C}^{-1})_{kj}\\right]\\,$,\n  因此对于对称的 $\\,\\mathrm{d}\\mathbf{C}\\,$，有 $\\,\\mathbb{I}_s:\\mathrm{d}\\mathbf{C}=\\mathrm{d}\\mathbf{C}\\,$ 和 $\\,\\mathbb{K}_s:\\mathrm{d}\\mathbf{C}=\\mathbf{C}^{-1}\\mathrm{d}\\mathbf{C}\\,\\mathbf{C}^{-1}\\,$.\n\n然后，在一个程序中实现你推导出的公式，该程序计算：\n- 能量 $\\,W(\\mathbf{C})\\,$,\n- 梯度 $\\,\\partial W/\\partial \\mathbf{C}\\,$,\n- Hessian $\\,\\partial^2 W/\\partial \\mathbf{C}\\,\\partial \\mathbf{C}\\,$，即材料 Hessian。在全拉格朗日有限元列式中，若第二 Piola-Kirchhoff 应力为 $\\,\\mathbf{S}=2\\,\\partial W/\\partial \\mathbf{C}\\,$，Green-Lagrange 应变为 $\\,\\mathbf{E}=\\tfrac{1}{2}(\\mathbf{C}-\\mathbf{I})\\,$，则算法切线为 $\\,\\mathbb{C}_{\\mathbf{S}\\mathbf{E}}=\\partial \\mathbf{S}/\\partial \\mathbf{E}=4\\,\\partial^2 W/\\partial \\mathbf{C}\\,\\partial \\mathbf{C}\\,$.\n\n为进行数值评估和验证，请使用特定的标量能量\n$$\nW(I_1,I_2,I_3) = \\tfrac{1}{2}a\\,(I_1-3)^2 + \\tfrac{1}{2}b\\,(I_2-3)^2 + \\tfrac{1}{2}c\\,(\\ln I_3)^2 + d\\,I_1 I_2 + e\\,I_2 I_3 + f\\,I_1 \\ln I_3,\n$$\n其参数 $\\,a,b,c,d,e,f\\,$ 在下面的测试套件中指定。您的实现必须：\n- 对于给定的对称正定 $\\,\\mathbf{C}\\,$，计算 $\\,W\\,$、$\\,\\partial W/\\partial \\mathbf{C}\\,$ 和 $\\,\\partial^2 W/\\partial \\mathbf{C}\\,\\partial \\mathbf{C}\\,$，\n- 通过将解析方向导数 $\\,(\\partial W/\\partial \\mathbf{C}) : \\mathbf{D}\\,$ 与对称方向 $\\,\\mathbf{D}\\,$ 的中心有限差分近似进行比较，来验证梯度，\n- 通过将 $\\,\\mathbf{D} : (\\partial^2 W/\\partial \\mathbf{C}\\,\\partial \\mathbf{C} : \\mathbf{D})\\,$ 与二阶中心有限差分近似进行比较，来验证 Hessian，\n- 验证限于对称张量的四阶 Hessian 的次对称性和主对称性。\n\n使用以下测试套件。对于每种情况，构建 $\\,\\mathbf{C}=\\mathbf{F}^T\\mathbf{F}\\,$ 并使用给定的对称方向 $\\,\\mathbf{D}\\,$ 和参数 $\\,a,b,c,d,e,f\\,$：\n1. 情况 1:\n   - $\\,\\mathbf{F}_1 = \\begin{bmatrix}1 & 0 & 0\\\\0 & 1 & 0\\\\0 & 0 & 1\\end{bmatrix}\\,$,\n   - $\\,\\mathbf{D}_1 = \\begin{bmatrix}0.3 & -0.1 & 0.05\\\\-0.1 & 0.2 & 0.07\\\\0.05 & 0.07 & -0.15\\end{bmatrix}\\,$,\n   - $\\,a=1.5,\\,b=0.8,\\,c=2.2,\\,d=0.6,\\,e=-0.4,\\,f=0.9\\,$.\n2. 情况 2:\n   - $\\,\\mathbf{F}_2 = \\begin{bmatrix}1.15 & 0.20 & 0\\\\0.10 & 0.95 & 0.05\\\\0 & -0.05 & 1.10\\end{bmatrix}\\,$,\n   - $\\,\\mathbf{D}_2 = \\begin{bmatrix}-0.2 & 0.12 & 0.03\\\\0.12 & 0.1 & -0.04\\\\0.03 & -0.04 & 0.05\\end{bmatrix}\\,$,\n   - $\\,a=2.0,\\,b=1.0,\\,c=1.2,\\,d=-0.3,\\,e=0.55,\\,f=1.1\\,$.\n3. 情况 3:\n   - $\\,\\mathbf{F}_3 = \\begin{bmatrix}0.9 & 0.3 & 0.1\\\\0 & 1.05 & -0.2\\\\0 & 0 & 1.2\\end{bmatrix}\\,$,\n   - $\\,\\mathbf{D}_3 = \\begin{bmatrix}0.08 & -0.02 & 0.01\\\\-0.02 & -0.06 & 0.03\\\\0.01 & 0.03 & 0.02\\end{bmatrix}\\,$,\n   - $\\,a=0.7,\\,b=1.5,\\,c=0.9,\\,d=0.4,\\,e=-0.2,\\,f=0.5\\,$.\n4. 情况 4:\n   - $\\,\\mathbf{F}_4 = \\begin{bmatrix}1.02 & 0.02 & 0\\\\0 & 0.98 & 0.01\\\\0 & 0 & 1.00\\end{bmatrix}\\,$,\n   - $\\,\\mathbf{D}_4 = \\begin{bmatrix}0.05 & 0.01 & -0.02\\\\0.01 & -0.04 & 0.015\\\\-0.02 & 0.015 & -0.01\\end{bmatrix}\\,$,\n   - $\\,a=1.0,\\,b=1.0,\\,c=10.0,\\,d=0.2,\\,e=0.1,\\,f=0.0\\,$.\n\n数值验证细节：\n- 对一阶导数使用步长为 $\\,\\varepsilon_1=10^{-7}\\,$ 的中心差分，对二阶导数使用步长为 $\\,\\varepsilon_2=10^{-6}\\,$ 的中心差分，均沿给定方向 $\\,\\mathbf{D}\\,$。\n- 对每种情况，进行三次布尔检查：\n  1. 梯度检查: $\\,\\left|(\\partial W/\\partial \\mathbf{C}):\\mathbf{D} - \\dfrac{W(\\mathbf{C}+\\varepsilon_1\\mathbf{D}) - W(\\mathbf{C}-\\varepsilon_1\\mathbf{D})}{2\\varepsilon_1}\\right| \\le 10^{-8}\\,$,\n  2. Hessian 检查: $\\,\\left|\\mathbf{D}:\\left(\\dfrac{\\partial^2 W}{\\partial \\mathbf{C}\\,\\partial \\mathbf{C}}:\\mathbf{D}\\right) - \\dfrac{W(\\mathbf{C}+\\varepsilon_2\\mathbf{D}) - 2W(\\mathbf{C}) + W(\\mathbf{C}-\\varepsilon_2\\mathbf{D})}{\\varepsilon_2^2}\\right| \\le 10^{-6}\\,$,\n  3. 对称性检查：四阶张量 $\\,\\partial^2 W/\\partial \\mathbf{C}\\,\\partial \\mathbf{C}\\,$ 在 $\\,10^{-10}\\,$ 精度内满足次对称性和主对称性，即 $\\,\\|\\mathbb{H}-\\mathbb{H}^{(ij)}\\|_\\infty\\le 10^{-10}\\,$, $\\,\\|\\mathbb{H}-\\mathbb{H}^{(kl)}\\|_\\infty\\le 10^{-10}\\,$, 和 $\\,\\|\\mathbb{H}-\\mathbb{H}^{(ij\\leftrightarrow kl)}\\|_\\infty\\le 10^{-10}\\,$, 其中上标表示对四阶张量的指标置换。\n\n最终输出格式：\n- 您的程序应生成一行输出，其中包含四个案例的十二个布尔结果，按顺序排列为 $[\\text{grad}_1,\\text{hess}_1,\\text{sym}_1,\\text{grad}_2,\\text{hess}_2,\\text{sym}_2,\\text{grad}_3,\\text{hess}_3,\\text{sym}_3,\\text{grad}_4,\\text{hess}_4,\\text{sym}_4]$，以逗号分隔的列表形式打印并用方括号括起来（例如，“[True,True,False, ...]”）。\n- 无需用户输入，不涉及物理单位；所有量均为无量纲。",
            "solution": "该问题要求推导各向同性标量值张量函数，即 Helmholtz 自由能 $W$，关于其自变量，即右 Cauchy-Green 变形张量 $\\mathbf{C}$ 的一阶和二阶导数。能量被给定为 $\\mathbf{C}$ 的主不变量的函数，$W(\\mathbf{C}) = \\widehat{W}(I_1(\\mathbf{C}), I_2(\\mathbf{C}), I_3(\\mathbf{C}))$。\n\n### 问题验证\n**步骤 1：提取已知条件**\n- Helmholtz 自由能是 $\\mathbf{C}$ 的不变量的函数：$W(\\mathbf{C}) = \\widehat{W}(I_1, I_2, I_3)$。\n- 不变量定义为：$I_1 = \\mathrm{tr}\\,\\mathbf{C}$, $I_2 = \\tfrac{1}{2}((\\mathrm{tr}\\,\\mathbf{C})^2 - \\mathrm{tr}\\,\\mathbf{C}^2)$, 以及 $I_3 = \\det\\mathbf{C}$。\n- 不变量的微分恒等式为：\n  1. $\\mathrm{d}I_1 = \\mathbf{I} : \\mathrm{d}\\mathbf{C}$\n  2. $\\mathrm{d}I_2 = (I_1\\mathbf{I} - \\mathbf{C}) : \\mathrm{d}\\mathbf{C}$\n  3. $\\mathrm{d}I_3 = I_3\\,\\mathbf{C}^{-T} : \\mathrm{d}\\mathbf{C}$\n- 不变量的二阶导数给定为：\n  1. $\\partial^2 I_1/\\partial \\mathbf{C}\\,\\partial \\mathbf{C} = \\mathbb{O}$ (零四阶张量)\n  2. $\\partial^2 I_2/\\partial \\mathbf{C}\\,\\partial \\mathbf{C} = \\mathbf{I}\\otimes\\mathbf{I} - \\mathbb{I}_s$\n  3. $\\partial^2 I_3/\\partial \\mathbf{C}\\,\\partial \\mathbf{C} = I_3\\left(\\mathbf{C}^{-1}\\otimes\\mathbf{C}^{-1} - \\mathbb{K}_s\\right)$\n  此处，$(\\mathbb{I}_s)_{ijkl}=\\tfrac{1}{2}(\\delta_{ik}\\delta_{jl}+\\delta_{il}\\delta_{jk})$ 且 $(\\mathbb{K}_s)_{ijkl}=\\tfrac{1}{2}((\\mathbf{C}^{-1})_{ik}(\\mathbf{C}^{-1})_{lj}+(\\mathbf{C}^{-1})_{il}(\\mathbf{C}^{-1})_{kj})$。\n- 能量函数的具体形式已提供：\n$$\nW(I_1,I_2,I_3) = \\tfrac{1}{2}a\\,(I_1-3)^2 + \\tfrac{1}{2}b\\,(I_2-3)^2 + \\tfrac{1}{2}c\\,(\\ln I_3)^2 + d\\,I_1 I_2 + e\\,I_2 I_3 + f\\,I_1 \\ln I_3\n$$\n- 四个测试案例的数值数据，包括 $\\mathbf{F}$、$\\mathbf{D}$ 和参数 $a,b,c,d,e,f$。\n- 基于中心有限差分的验证标准，具有指定的步长和容差。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题具有坚实的科学基础，属于非线性连续介质力学和超弹性这一成熟领域。不变量和表示定理的使用是该领域的基石。所提供的所有数学定义和恒等式都是标准且正确的。该问题是适定的、客观的且自洽的，为获得唯一、可验证的解提供了所有必要信息。不存在矛盾、歧义或不科学的前提。\n\n**步骤 3：结论与行动**\n该问题被认为是**有效的**。将提供完整的推导和解答。\n\n### 导数推导\n令 $W_\\alpha = \\partial \\widehat{W} / \\partial I_\\alpha$ 和 $W_{\\alpha\\beta} = \\partial^2 \\widehat{W} / \\partial I_\\alpha \\partial I_\\beta$ 表示能量函数关于其自变量（即不变量）的偏导数。\n\n**1. W 关于 C 的一阶导数**\n使用链式法则， $W$ 关于 $\\mathbf{C}$ 的一阶导数为：\n$$\n\\frac{\\partial W}{\\partial \\mathbf{C}} = \\sum_{\\alpha=1}^{3} \\frac{\\partial \\widehat{W}}{\\partial I_\\alpha} \\frac{\\partial I_\\alpha}{\\partial \\mathbf{C}} = W_1 \\frac{\\partial I_1}{\\partial \\mathbf{C}} + W_2 \\frac{\\partial I_2}{\\partial \\mathbf{C}} + W_3 \\frac{\\partial I_3}{\\partial \\mathbf{C}}\n$$\n不变量的梯度 $\\partial I_\\alpha/\\partial \\mathbf{C}$ 可以从其微分形式 $\\mathrm{d}I_\\alpha = (\\partial I_\\alpha/\\partial \\mathbf{C}) : \\mathrm{d}\\mathbf{C}$ 中确定。考虑到 $\\mathbf{C}$ 是对称的，有 $\\mathbf{C}^{-T} = \\mathbf{C}^{-1}$。\n- 由 $\\mathrm{d}I_1 = \\mathbf{I} : \\mathrm{d}\\mathbf{C}$，我们得到 $\\frac{\\partial I_1}{\\partial \\mathbf{C}} = \\mathbf{I}$。\n- 由 $\\mathrm{d}I_2 = (I_1\\mathbf{I} - \\mathbf{C}) : \\mathrm{d}\\mathbf{C}$，我们得到 $\\frac{\\partial I_2}{\\partial \\mathbf{C}} = I_1\\mathbf{I} - \\mathbf{C}$。\n- 由 $\\mathrm{d}I_3 = I_3\\mathbf{C}^{-1} : \\mathrm{d}\\mathbf{C}$，我们得到 $\\frac{\\partial I_3}{\\partial \\mathbf{C}} = I_3\\mathbf{C}^{-1}$。\n\n对于给定的能量函数，其偏导数 $W_\\alpha$ 为：\n- $W_1 = \\frac{\\partial \\widehat{W}}{\\partial I_1} = a(I_1-3) + d I_2 + f \\ln I_3$\n- $W_2 = \\frac{\\partial \\widehat{W}}{\\partial I_2} = b(I_2-3) + d I_1 + e I_3$\n- $W_3 = \\frac{\\partial \\widehat{W}}{\\partial I_3} = c \\frac{\\ln I_3}{I_3} + e I_2 + f \\frac{I_1}{I_3}$\n\n代入这些分量，一阶导数为：\n$$\n\\frac{\\partial W}{\\partial \\mathbf{C}} = \\left(a(I_1-3) + d I_2 + f \\ln I_3\\right)\\mathbf{I} + \\left(b(I_2-3) + d I_1 + e I_3\\right)(I_1\\mathbf{I} - \\mathbf{C}) + \\left(c \\frac{\\ln I_3}{I_3} + e I_2 + f \\frac{I_1}{I_3}\\right)I_3\\mathbf{C}^{-1}\n$$\n\n**2. W 关于 C 的二阶导数**\n二阶导数是一个四阶张量，通过对一阶导数关于 $\\mathbf{C}$ 求导获得：\n$$\n\\frac{\\partial^2 W}{\\partial \\mathbf{C} \\partial \\mathbf{C}} = \\frac{\\partial}{\\partial \\mathbf{C}} \\left( \\sum_{\\alpha=1}^{3} W_\\alpha \\frac{\\partial I_\\alpha}{\\partial \\mathbf{C}} \\right)\n$$\n应用张量函数的乘法法则和链式法则：\n$$\n\\frac{\\partial^2 W}{\\partial \\mathbf{C} \\partial \\mathbf{C}} = \\sum_{\\alpha=1}^{3} \\left[ \\frac{\\partial W_\\alpha}{\\partial \\mathbf{C}} \\otimes \\frac{\\partial I_\\alpha}{\\partial \\mathbf{C}} + W_\\alpha \\frac{\\partial^2 I_\\alpha}{\\partial \\mathbf{C} \\partial \\mathbf{C}} \\right]\n$$\n项 $\\partial W_\\alpha / \\partial \\mathbf{C}$ 再次使用链式法则展开：\n$$\n\\frac{\\partial W_\\alpha}{\\partial \\mathbf{C}} = \\sum_{\\beta=1}^{3} \\frac{\\partial W_\\alpha}{\\partial I_\\beta} \\frac{\\partial I_\\beta}{\\partial \\mathbf{C}} = \\sum_{\\beta=1}^{3} W_{\\alpha\\beta} \\frac{\\partial I_\\beta}{\\partial \\mathbf{C}}\n$$\n将此代回，得到材料 Hessian 的一般表达式：\n$$\n\\mathbb{H} = \\frac{\\partial^2 W}{\\partial \\mathbf{C} \\partial \\mathbf{C}} = \\sum_{\\alpha=1}^{3} \\sum_{\\beta=1}^{3} W_{\\alpha\\beta} \\frac{\\partial I_\\beta}{\\partial \\mathbf{C}} \\otimes \\frac{\\partial I_\\alpha}{\\partial \\mathbf{C}} + \\sum_{\\alpha=1}^{3} W_\\alpha \\frac{\\partial^2 I_\\alpha}{\\partial \\mathbf{C} \\partial \\mathbf{C}}\n$$\n我们需要 $\\widehat{W}$ 关于不变量的二阶偏导数：\n- $W_{11} = \\frac{\\partial^2 \\widehat{W}}{\\partial I_1^2} = a$\n- $W_{12} = \\frac{\\partial^2 \\widehat{W}}{\\partial I_1 \\partial I_2} = d$\n- $W_{13} = \\frac{\\partial^2 \\widehat{W}}{\\partial I_1 \\partial I_3} = \\frac{f}{I_3}$\n- $W_{22} = \\frac{\\partial^2 \\widehat{W}}{\\partial I_2^2} = b$\n- $W_{23} = \\frac{\\partial^2 \\widehat{W}}{\\partial I_2 \\partial I_3} = e$\n- $W_{33} = \\frac{\\partial^2 \\widehat{W}}{\\partial I_3^2} = c \\frac{1 - \\ln I_3}{I_3^2} - f \\frac{I_1}{I_3^2}$\n\n我们记 $\\mathbf{G}_\\alpha = \\partial I_\\alpha / \\partial \\mathbf{C}$ 和 $\\mathbb{H}_\\alpha = \\partial^2 I_\\alpha / \\partial \\mathbf{C} \\partial \\mathbf{C}$。Hessian 为\n$$\n\\mathbb{H} = \\sum_{\\alpha, \\beta=1}^{3} W_{\\alpha\\beta} \\, (\\mathbf{G}_\\beta \\otimes \\mathbf{G}_\\alpha) + W_1 \\mathbb{H}_1 + W_2 \\mathbb{H}_2 + W_3 \\mathbb{H}_3\n$$\n代入给定的 $\\mathbb{H}_\\alpha$ 表达式：\n$$\n\\mathbb{H} = \\sum_{\\alpha, \\beta=1}^{3} W_{\\alpha\\beta} \\, (\\mathbf{G}_\\beta \\otimes \\mathbf{G}_\\alpha) + W_2 (\\mathbf{I}\\otimes\\mathbf{I} - \\mathbb{I}_s) + W_3 I_3\\left(\\mathbf{C}^{-1}\\otimes\\mathbf{C}^{-1} - \\mathbb{K}_s\\right)\n$$\n此表达式是关于 $\\mathbf{C}$、其不变量以及材料参数的显式表达式。它可以直接进行数值实现。第一项是九个二阶张量并矢积的和。其余项是给定四阶张量的缩放版本。这个最终的 $\\mathbb{H}$ 表达式将用于实现以进行验证。\n\n```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main solver function that iterates through test cases and prints results.\n    \"\"\"\n    test_cases = [\n        {\n            \"F\": np.array([[1.0, 0.0, 0.0], [0.0, 1.0, 0.0], [0.0, 0.0, 1.0]]),\n            \"D\": np.array([[0.3, -0.1, 0.05], [-0.1, 0.2, 0.07], [0.05, 0.07, -0.15]]),\n            \"params\": (1.5, 0.8, 2.2, 0.6, -0.4, 0.9)\n        },\n        {\n            \"F\": np.array([[1.15, 0.20, 0.0], [0.10, 0.95, 0.05], [0.0, -0.05, 1.10]]),\n            \"D\": np.array([[-0.2, 0.12, 0.03], [0.12, 0.1, -0.04], [0.03, -0.04, 0.05]]),\n            \"params\": (2.0, 1.0, 1.2, -0.3, 0.55, 1.1)\n        },\n        {\n            \"F\": np.array([[0.9, 0.3, 0.1], [0.0, 1.05, -0.2], [0.0, 0.0, 1.2]]),\n            \"D\": np.array([[0.08, -0.02, 0.01], [-0.02, -0.06, 0.03], [0.01, 0.03, 0.02]]),\n            \"params\": (0.7, 1.5, 0.9, 0.4, -0.2, 0.5)\n        },\n        {\n            \"F\": np.array([[1.02, 0.02, 0.0], [0.0, 0.98, 0.01], [0.0, 0.0, 1.00]]),\n            \"D\": np.array([[0.05, 0.01, -0.02], [0.01, -0.04, 0.015], [-0.02, 0.015, -0.01]]),\n            \"params\": (1.0, 1.0, 10.0, 0.2, 0.1, 0.0)\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        F = case[\"F\"]\n        D = case[\"D\"]\n        params = case[\"params\"]\n        grad_check, hess_check, sym_check = perform_case_analysis(F, D, params)\n        results.extend([grad_check, hess_check, sym_check])\n\n    return f\"[{','.join(map(str, results))}]\"\n\ndef _calculate_W(C_tensor, params):\n    \"\"\"Helper function to compute the scalar energy W for a given C.\"\"\"\n    a, b, c, d, e, f = params\n    I1 = np.trace(C_tensor)\n    I2 = 0.5 * (I1**2 - np.trace(C_tensor @ C_tensor))\n    I3 = np.linalg.det(C_tensor)\n    \n    if I3 = 0: return np.inf\n    ln_I3 = np.log(I3)\n\n    return (0.5 * a * (I1 - 3)**2 +\n            0.5 * b * (I2 - 3)**2 +\n            0.5 * c * ln_I3**2 +\n            d * I1 * I2 +\n            e * I2 * I3 +\n            f * I1 * ln_I3)\n\ndef perform_case_analysis(F, D, params):\n    \"\"\"\n    Performs the full analysis for a single test case.\n    \"\"\"\n    a, b, c, d, e, f = params\n    eps1, eps2 = 1e-7, 1e-6\n    grad_tol, hess_tol, sym_tol = 1e-8, 1e-6, 1e-10\n\n    C = F.T @ F\n    C_inv = np.linalg.inv(C)\n    I = np.eye(3)\n\n    I1 = np.trace(C)\n    I2 = 0.5 * (I1**2 - np.trace(C @ C))\n    I3 = np.linalg.det(C)\n    ln_I3 = np.log(I3)\n\n    W = _calculate_W(C, params)\n\n    W1 = a * (I1 - 3) + d * I2 + f * ln_I3\n    W2 = b * (I2 - 3) + d * I1 + e * I3\n    W3 = c * ln_I3 / I3 + e * I2 + f * I1 / I3\n\n    dW_dC = W1 * I + W2 * (I1 * I - C) + W3 * I3 * C_inv\n\n    W11 = a\n    W12 = d\n    W13 = f / I3\n    W22 = b\n    W23 = e\n    W33 = c * (1 - ln_I3) / I3**2 - f * I1 / I3**2\n    W_ab = np.array([[W11, W12, W13], [W12, W22, W23], [W13, W23, W33]])\n\n    G_alpha = [I, I1 * I - C, I3 * C_inv]\n    \n    H_term1 = np.zeros((3, 3, 3, 3))\n    for alpha in range(3):\n        for beta in range(3):\n            H_term1 += W_ab[alpha, beta] * np.einsum('ij,kl->ijkl', G_alpha[beta], G_alpha[alpha])\n\n    II = np.einsum('ij,kl->ijkl', I, I)\n    Is = 0.5 * (np.einsum('ik,jl->ijkl', I, I) + np.einsum('il,jk->ijkl', I, I))\n    \n    CInvCInv = np.einsum('ij,kl->ijkl', C_inv, C_inv)\n    Ks = 0.5 * (np.einsum('ik,jl->ijkl', C_inv, C_inv) + np.einsum('il,jk->ijkl', C_inv, C_inv))\n\n    H_term2 = W2 * (II - Is)\n    H_term3 = W3 * I3 * (CInvCInv - Ks)\n\n    H = H_term1 + H_term2 + H_term3\n\n    grad_ana = np.sum(dW_dC * D)\n    W_p1 = _calculate_W(C + eps1 * D, params)\n    W_m1 = _calculate_W(C - eps1 * D, params)\n    grad_fd = (W_p1 - W_m1) / (2 * eps1)\n    grad_check = np.abs(grad_ana - grad_fd) = grad_tol\n\n    hess_ana = np.einsum('ijkl,ij,kl', H, D, D)\n    W_p2 = _calculate_W(C + eps2 * D, params)\n    W_m2 = _calculate_W(C - eps2 * D, params)\n    hess_fd = (W_p2 - 2 * W + W_m2) / eps2**2\n    hess_check = np.abs(hess_ana - hess_fd) = hess_tol\n\n    minor_sym1_check = np.max(np.abs(H - H.transpose(1, 0, 2, 3))) = sym_tol\n    minor_sym2_check = np.max(np.abs(H - H.transpose(0, 1, 3, 2))) = sym_tol\n    major_sym_check = np.max(np.abs(H - H.transpose(2, 3, 0, 1))) = sym_tol\n    sym_check = minor_sym1_check and minor_sym2_check and major_sym_check\n\n    return grad_check, hess_check, sym_check\n```",
            "answer": "[True,True,True,True,True,True,True,True,True,True,True,True]"
        }
    ]
}