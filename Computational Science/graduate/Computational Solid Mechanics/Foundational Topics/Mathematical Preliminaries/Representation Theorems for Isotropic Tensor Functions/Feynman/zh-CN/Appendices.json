{
    "hands_on_practices": [
        {
            "introduction": "表示定理的一个核心成果是，在三维空间中，任何关于单个二阶张量的各向同性张量函数都可以表示为该张量的次数不超过2的多项式。Cayley–Hamilton定理为实现这种简化提供了关键的代数工具。本练习将引导你亲手操作，将一个高阶张量多项式降阶至其唯一的、由 $\\{ \\mathbf{I}, \\mathbf{A}, \\mathbf{A}^2 \\}$ 张成的最小多项式基底上，从而掌握这一基本技能。",
            "id": "3595140",
            "problem": "在计算固体力学中，三维空间中任何关于单个二阶张量自变量的各向同性张量函数，均可表示为单位张量和该自变量的幂的组合。设 $\\mathbf{A}$ 是 $\\mathbb{R}^{3}$ 上的一个二阶张量，其主不变量为 $I_{1}$、$I_{2}$ 和 $I_{3}$，其中 $I_{1}=\\mathrm{tr}\\,\\mathbf{A}$，$I_{2}$ 是 $\\mathbf{A}$ 的所有 2 阶主子式之和，$I_{3}=\\det \\mathbf{A}$。考虑张量多项式 $p(\\mathbf{A})=\\mathbf{A}^{4}+2\\,\\mathbf{A}^{3}+\\mathbf{A}$。仅从主不变量的定义和关于 $\\mathbf{A}$ 的 Cayley–Hamilton 定理出发，将 $p(\\mathbf{A})$ 化简为典范各向同性形式 $\\alpha_{0}\\,\\mathbf{I}+\\alpha_{1}\\,\\mathbf{A}+\\alpha_{2}\\,\\mathbf{A}^{2}$，并将标量系数 $\\alpha_{i}$ 表示为 $I_{1}$、$I_{2}$ 和 $I_{3}$ 的闭合形式函数。请以行矩阵 $\\begin{pmatrix}\\alpha_{0}  \\alpha_{1}  \\alpha_{2}\\end{pmatrix}$ 的形式给出最终答案。此为符号计算，无需进行数值取整。",
            "solution": "该问题要求将张量多项式 $p(\\mathbf{A}) = \\mathbf{A}^{4} + 2\\,\\mathbf{A}^{3} + \\mathbf{A}$ 化简为其典范各向同性形式 $\\alpha_{0}\\,\\mathbf{I} + \\alpha_{1}\\,\\mathbf{A} + \\alpha_{2}\\,\\mathbf{A}^{2}$，其中 $\\mathbf{A}$ 是三维空间 $\\mathbb{R}^{3}$ 中的一个二阶张量。系数 $\\alpha_{0}$、$\\alpha_{1}$ 和 $\\alpha_{2}$ 必须用 $\\mathbf{A}$ 的主不变量 $I_{1}$、$I_{2}$ 和 $I_{3}$ 来表示。进行此化简的基本工具是 Cayley-Hamilton 定理。\n\n在 $\\mathbb{R}^{3}$ 中，二阶张量 $\\mathbf{A}$ 的特征方程由 $\\det(\\mathbf{A} - \\lambda\\mathbf{I}) = 0$ 给出，其中 $\\lambda$ 代表特征值，$\\mathbf{I}$ 是二阶单位张量。这个三次方程可以根据主不变量展开为：\n$$ \\lambda^{3} - I_{1}\\lambda^{2} + I_{2}\\lambda - I_{3} = 0 $$\n其中 $I_{1} = \\mathrm{tr}\\,\\mathbf{A}$，$I_{2} = \\frac{1}{2}[(\\mathrm{tr}\\,\\mathbf{A})^{2} - \\mathrm{tr}(\\mathbf{A}^{2})]$（等价于 2 阶主子式之和），以及 $I_{3} = \\det \\mathbf{A}$。\n\nCayley-Hamilton 定理断言，张量 $\\mathbf{A}$ 满足其自身的特征方程。通过用 $\\mathbf{A}$ 替代 $\\lambda$ 并为标量项适当地引入单位张量 $\\mathbf{I}$，我们得到以下基本张量恒等式：\n$$ \\mathbf{A}^{3} - I_{1}\\mathbf{A}^{2} + I_{2}\\mathbf{A} - I_{3}\\mathbf{I} = \\mathbf{0} $$\n其中 $\\mathbf{0}$ 是零张量。这个恒等式使我们能够将 $\\mathbf{A}^{3}$ 表示为 $\\mathbf{A}$ 的较低次幂的线性组合：\n$$ \\mathbf{A}^{3} = I_{1}\\mathbf{A}^{2} - I_{2}\\mathbf{A} + I_{3}\\mathbf{I} $$\n这是化简的第一步。为了化简多项式 $p(\\mathbf{A})$ 中的 $\\mathbf{A}^{4}$ 项，我们将上述 $\\mathbf{A}^{3}$ 的表达式乘以 $\\mathbf{A}$：\n$$ \\mathbf{A}^{4} = \\mathbf{A} \\cdot \\mathbf{A}^{3} = \\mathbf{A}(I_{1}\\mathbf{A}^{2} - I_{2}\\mathbf{A} + I_{3}\\mathbf{I}) $$\n$$ \\mathbf{A}^{4} = I_{1}\\mathbf{A}^{3} - I_{2}\\mathbf{A}^{2} + I_{3}\\mathbf{A} $$\n所得的 $\\mathbf{A}^{4}$ 表达式仍然包含 $\\mathbf{A}^{3}$。我们必须将来自 Cayley-Hamilton 定理的 $\\mathbf{A}^{3}$ 表达式代入这个 $\\mathbf{A}^{4}$ 的方程中：\n$$ \\mathbf{A}^{4} = I_{1}(I_{1}\\mathbf{A}^{2} - I_{2}\\mathbf{A} + I_{3}\\mathbf{I}) - I_{2}\\mathbf{A}^{2} + I_{3}\\mathbf{A} $$\n将标量 $I_{1}$ 分配进去，并按 $\\mathbf{A}$ 的幂次对各项进行分组：\n$$ \\mathbf{A}^{4} = I_{1}^{2}\\mathbf{A}^{2} - I_{1}I_{2}\\mathbf{A} + I_{1}I_{3}\\mathbf{I} - I_{2}\\mathbf{A}^{2} + I_{3}\\mathbf{A} $$\n$$ \\mathbf{A}^{4} = (I_{1}^{2} - I_{2})\\mathbf{A}^{2} + (I_{3} - I_{1}I_{2})\\mathbf{A} + (I_{1}I_{3})\\mathbf{I} $$\n现在我们已成功地将 $\\mathbf{A}^{3}$ 和 $\\mathbf{A}^{4}$ 都表示成了所需的形式。我们可以将它们代入原始多项式 $p(\\mathbf{A})$ 中：\n$$ p(\\mathbf{A}) = \\mathbf{A}^{4} + 2\\,\\mathbf{A}^{3} + \\mathbf{A} $$\n$$ p(\\mathbf{A}) = \\left[ (I_{1}^{2} - I_{2})\\mathbf{A}^{2} + (I_{3} - I_{1}I_{2})\\mathbf{A} + (I_{1}I_{3})\\mathbf{I} \\right] + 2\\left[ I_{1}\\mathbf{A}^{2} - I_{2}\\mathbf{A} + I_{3}\\mathbf{I} \\right] + \\mathbf{A} $$\n为了求出典范形式 $\\alpha_{0}\\mathbf{I} + \\alpha_{1}\\mathbf{A} + \\alpha_{2}\\mathbf{A}^{2}$ 的系数 $\\alpha_{0}$、$\\alpha_{1}$ 和 $\\alpha_{2}$，我们合并每个张量幂次的系数：\n\n对于单位张量 $\\mathbf{I}$ 的系数 $\\alpha_{0}$：\n$$ \\alpha_{0}\\mathbf{I} = (I_{1}I_{3})\\mathbf{I} + 2(I_{3}\\mathbf{I}) = (I_{1}I_{3} + 2I_{3})\\mathbf{I} $$\n$$ \\alpha_{0} = I_{3}(I_{1} + 2) $$\n\n对于张量 $\\mathbf{A}$ 的系数 $\\alpha_{1}$：\n$$ \\alpha_{1}\\mathbf{A} = (I_{3} - I_{1}I_{2})\\mathbf{A} + 2(-I_{2}\\mathbf{A}) + 1\\mathbf{A} = (I_{3} - I_{1}I_{2} - 2I_{2} + 1)\\mathbf{A} $$\n$$ \\alpha_{1} = 1 + I_{3} - I_{2}(I_{1} + 2) $$\n\n对于张量 $\\mathbf{A}^{2}$ 的系数 $\\alpha_{2}$：\n$$ \\alpha_{2}\\mathbf{A}^{2} = (I_{1}^{2} - I_{2})\\mathbf{A}^{2} + 2(I_{1}\\mathbf{A}^{2}) = (I_{1}^{2} - I_{2} + 2I_{1})\\mathbf{A}^{2} $$\n$$ \\alpha_{2} = I_{1}^{2} + 2I_{1} - I_{2} $$\n\n这三个标量系数 $\\alpha_{0}$、$\\alpha_{1}$ 和 $\\alpha_{2}$ 被表示为主不变量 $I_{1}$、$I_{2}$ 和 $I_{3}$ 的闭合形式函数。最终答案是按顺序包含这些系数的行矩阵。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} I_{3}(I_{1} + 2)  1 + I_{3} - I_{2}(I_{1} + 2)  I_{1}^{2} + 2I_{1} - I_{2} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "虽然各向同性张量函数在其最小多项式基底上的表示是唯一的，但在更高阶的非最小基底中，表示系数却并非如此。这个看似抽象的结论在数值计算中具有重要意义。本计算实验旨在通过具体数值验证来揭示这一现象 ()，你将看到不同的高阶表示如何等价于同一个函数，并学会如何利用Cayley–Hamilton定理恢复其唯一的标准形式。",
            "id": "3595204",
            "problem": "构建一个计算实验，以阐明多项式基在三维空间中单个二阶张量的各向同性张量函数表示中的作用。仅使用以下基本事实：(i) 在三维空间中，任何关于单个二阶张量的各向同性张量函数都可以写成该张量的多项式，其标量系数仅依赖于该张量的主不变量；(ii) 适用于三维空间中二阶张量的 Cayley–Hamilton 定理。完全使用纯数学术语进行演算；无需物理单位。\n\n您的程序必须对每个测试张量使用双精度算术执行以下步骤：\n\n1. 对于给定的实对称二阶张量 $A \\in \\mathbb{R}^{3 \\times 3}$，计算其主不变量\n   $$J_1 = \\operatorname{tr}(A), \\quad J_2 = \\tfrac{1}{2}\\left[(\\operatorname{tr} A)^2 - \\operatorname{tr}(A^2)\\right], \\quad J_3 = \\det(A)。$$\n\n2. 定义标量系数函数 $\\alpha_0(J_1,J_2,J_3)$、$\\alpha_1(J_1,J_2,J_3)$ 和 $\\alpha_2(J_1,J_2,J_3)$ 如下\n   $$\\alpha_0 = J_1 + 2 J_2, \\quad \\alpha_1 = 3 J_1 - J_3, \\quad \\alpha_2 = J_1 J_2 - 1。$$\n\n3. 在最小多项式基中构造参考各向同性张量函数\n   $$F_{\\text{ref}}(A) = \\alpha_0 I + \\alpha_1 A + \\alpha_2 A^2,$$\n   其中 $I$ 是单位张量。\n\n4. 考虑非最小多项式基 $\\{I, A, A^2, A^3\\}$ 和两个不同的标量函数 $g(J_1,J_2,J_3)$：\n   $$g^{(1)} = J_1, \\quad g^{(2)} = J_2 - 2 J_3。$$\n   对于 $g$ 的每种选择，定义非最小系数 $\\beta_0, \\beta_1, \\beta_2, \\beta_3$ 如下\n   $$\\beta_0 = \\alpha_0 + g J_3, \\quad \\beta_1 = \\alpha_1 - g J_2, \\quad \\beta_2 = \\alpha_2 + g J_1, \\quad \\beta_3 = -g。$$\n   然后构成\n   $$F^{(g)}(A) = \\beta_0 I + \\beta_1 A + \\beta_2 A^2 + \\beta_3 A^3。$$\n\n5. 对每个测试张量 $A$，数值验证以下陈述：\n   - 非最小基中的非唯一性：从 $g^{(1)}$ 和 $g^{(2)}$ 得到的向量 $(\\beta_0,\\beta_1,\\beta_2,\\beta_3)$ 在欧几里得范数上是不同的（严格大于一个容差），但在指定的容差范围内，它们产生的张量值 $F^{(g)}(A)$ 与 $F_{\\text{ref}}(A)$ 相同。\n   - Cayley–Hamilton 约简后的唯一性：通过应用三维 Cayley–Hamilton 定理，\n     $$A^3 - J_1 A^2 + J_2 A - J_3 I = 0,$$\n     将 $F^{(g)}(A)$ 约简回最小基 $\\{I,A,A^2\\}$，并唯一地恢复三元组 $(\\alpha_0,\\alpha_1,\\alpha_2)$，且恢复结果与 $g$ 的选择无关。\n\n   使用 Frobenius 范数来度量张量差异，使用欧几里得范数来度量系数向量差异。相等性检查使用数值容差 $\\varepsilon = 10^{-10}$。如果两个 $(\\beta_0,\\beta_1,\\beta_2,\\beta_3)$ 向量之差的欧几里得范数超过 $10^{-8}$，则确认 $\\beta_i$ 的非唯一性。\n\n6. 测试套件。将上述过程应用于以下三个对称张量：\n   - $A^{(1)} = \\begin{bmatrix} 2  0.5  -0.3 \\\\ 0.5  1.5  0.2 \\\\ -0.3  0.2  0.7 \\end{bmatrix}$。\n   - $A^{(2)} = \\begin{bmatrix} 1.2  0  0 \\\\ 0  1.2  0 \\\\ 0  0  1.2 \\end{bmatrix}$。\n   - $A^{(3)} = \\begin{bmatrix} 1  2  3 \\\\ 2  4  6 \\\\ 3  6  9 \\end{bmatrix}$。\n\n7. 对于每个测试张量 $A^{(k)}$，输出一个布尔值 $b^{(k)}$，当且仅当以下所有条件都成立时，该值为 $\\mathrm{True}$：\n   - $\\|F^{(g^{(1)})}(A^{(k)}) - F_{\\text{ref}}(A^{(k)})\\|_F \\le \\varepsilon$ 且 $\\|F^{(g^{(2)})}(A^{(k)}) - F_{\\text{ref}}(A^{(k)})\\|_F \\le \\varepsilon$，\n   - 从每个非最小表示中恢复的最小基系数在最大范数意义下与 $(\\alpha_0,\\alpha_1,\\alpha_2)$ 的差值在 $\\varepsilon$ 范围内，\n   - 并且 $\\|(\\beta_0,\\beta_1,\\beta_2,\\beta_3)^{(g^{(1)})} - (\\beta_0,\\beta_1,\\beta_2,\\beta_3)^{(g^{(2)})}\\|_2 > 10^{-8}$。\n\n最终输出格式：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，例如 $[b^{(1)},b^{(2)},b^{(3)}]$，其中每个 $b^{(k)}$ 为 $\\mathrm{True}$ 或 $\\mathrm{False}$。",
            "solution": "问题陈述是有效的。它提出了一个适定的、有科学依据的、并且可通过计算验证的张量分析练习，张量分析是连续介质力学的核心组成部分。其目标是利用 Cayley-Hamilton 定理来展示各向同性张量函数表示的基本性质。\n\n该计算实验阐明了，当多项式基的次数高于 Cayley-Hamilton 定理所决定的最小次数时，表示各向同性张量函数$F(A)$的方法不唯一。然后，实验还展示了通过使用该定理进行约简，可以恢复其在最小基中的唯一表示。\n\n该过程始于一个给定的实对称二阶张量$A \\in \\mathbb{R}^{3 \\times 3}$。\n\n**第 1 步：主不变量**\n$A$的各向同性函数的行为仅取决于在坐标旋转下保持不变的标量。对于三维空间中的一个二阶张量，存在三个主不变量：\n$$J_1(A) = \\operatorname{tr}(A)$$\n$$J_2(A) = \\tfrac{1}{2}\\left[(\\operatorname{tr} A)^2 - \\operatorname{tr}(A^2)\\right]$$\n$$J_3(A) = \\det(A)$$\n将为每个测试张量$A$计算这些不变量。\n\n**第 2 步：最小多项式表示**\n一个基本的表示定理指出，任何关于单个对称二阶张量$A$的各向同性张量值函数$F$都可以表示为$A$的多项式。Cayley-Hamilton 定理确保了在三维空间中，此多项式的次数最多为$2$。这给出了最小表示：\n$$F(A) = \\alpha_0 I + \\alpha_1 A + \\alpha_2 A^2$$\n其中$I$是二阶单位张量，标量系数$\\alpha_0, \\alpha_1, \\alpha_2$是主不变量的函数，即$\\alpha_i = \\alpha_i(J_1, J_2, J_3)$。该问题为这些系数定义了具体形式，以构建一个参考函数$F_{\\text{ref}}(A)$：\n$$\\alpha_0 = J_1 + 2 J_2$$\n$$\\alpha_1 = 3 J_1 - J_3$$\n$$\\alpha_2 = J_1 J_2 - 1$$\n因此，参考函数为：\n$$F_{\\text{ref}}(A) = (\\alpha_0) I + (\\alpha_1) A + (\\alpha_2) A^2$$\n对于给定的函数$F$，系数集$(\\alpha_0, \\alpha_1, \\alpha_2)$是唯一的。\n\n**第 3 步：非最小表示与非唯一性**\n我们可以使用更高次数（例如$3$次）的多项式来表示同一个函数$F(A)$。这涉及到非最小基$\\{I, A, A^2, A^3\\}$。\n$$F^{(g)}(A) = \\beta_0 I + \\beta_1 A + \\beta_2 A^2 + \\beta_3 A^3$$\n系数$\\beta_i$不是唯一的。为了证明这一点，我们使用一个任意标量函数$g(J_1, J_2, J_3)$来构造它们。问题将$\\beta_i$定义为：\n$$\\beta_0 = \\alpha_0 + g J_3, \\quad \\beta_1 = \\alpha_1 - g J_2, \\quad \\beta_2 = \\alpha_2 + g J_1, \\quad \\beta_3 = -g$$\n将这些代入$F^{(g)}(A)$的表达式中可得：\n$$F^{(g)}(A) = (\\alpha_0 + g J_3) I + (\\alpha_1 - g J_2) A + (\\alpha_2 + g J_1) A^2 + (-g) A^3$$\n通过提出公因子$g$来重新排列各项，我们得到：\n$$F^{(g)}(A) = (\\alpha_0 I + \\alpha_1 A + \\alpha_2 A^2) - g(A^3 - J_1 A^2 + J_2 A - J_3 I)$$\n项$\\alpha_0 I + \\alpha_1 A + \\alpha_2 A^2$正是$F_{\\text{ref}}(A)$。第二个括号中的项是$A$的特征多项式。Cayley-Hamilton 定理指出，每个方阵都满足其自身的特征方程，因此：\n$$A^3 - J_1 A^2 + J_2 A - J_3 I = 0$$\n其中$0$是零张量。因此，$F^{(g)}(A)$的表达式简化为：\n$$F^{(g)}(A) = F_{\\text{ref}}(A) - g \\cdot 0 = F_{\\text{ref}}(A)$$\n这个解析结果表明，对于函数$g$的任何选择，所得到的张量$F^{(g)}(A)$都将与$F_{\\text{ref}}(A)$相同。然而，如果我们选择两个不同的函数$g^{(1)} \\neq g^{(2)}$，那么对应的系数向量$(\\beta_0, \\beta_1, \\beta_2, \\beta_3)^{(g^{(1)})}$和$(\\beta_0, \\beta_1, \\beta_2, \\beta_3)^{(g^{(2)})}$通常会是不同的。这证明了在非最小基中系数的非唯一性。\n\n**第 4 步：唯一最小系数的恢复**\n这种非唯一性可以通过将非最小表示约简回最小基来解决。这可以通过再次应用 Cayley-Hamilton 定理来实现，这次是为了消除$A^3$。我们将该定理重新排列为：\n$$A^3 = J_1 A^2 - J_2 A + J_3 I$$\n将此代入非最小形式$F^{(g)}(A) = \\beta_0 I + \\beta_1 A + \\beta_2 A^2 + \\beta_3 A^3$中：\n$$F^{(g)}(A) = \\beta_0 I + \\beta_1 A + \\beta_2 A^2 + \\beta_3 (J_1 A^2 - J_2 A + J_3 I)$$\n合并与$I$、$A$和$A^2$相应的项：\n$$F^{(g)}(A) = (\\beta_0 + \\beta_3 J_3) I + (\\beta_1 - \\beta_3 J_2) A + (\\beta_2 + \\beta_3 J_1) A^2$$\n现在这个表达式是最小基的形式。设恢复的系数为$(\\alpha'_0, \\alpha'_1, \\alpha'_2)$。通过与形式$\\alpha'_0 I + \\alpha'_1 A + \\alpha'_2 A^2$进行比较，我们发现：\n$$\\alpha'_0 = \\beta_0 + \\beta_3 J_3$$\n$$\\alpha'_1 = \\beta_1 - \\beta_3 J_2$$\n$$\\alpha'_2 = \\beta_2 + \\beta_3 J_1$$\n现在我们将$\\beta_i$关于$g$和$\\alpha_i$的定义代回这些表达式中：\n$$\\alpha'_0 = (\\alpha_0 + g J_3) + (-g) J_3 = \\alpha_0$$\n$$\\alpha'_1 = (\\alpha_1 - g J_2) - (-g) J_2 = \\alpha_1$$\n$$\\alpha'_2 = (\\alpha_2 + g J_1) + (-g) J_1 = \\alpha_2$$\n这证明了约简过程恢复了原始的、唯一的系数$(\\alpha_0, \\alpha_1, \\alpha_2)$，无论初始选择的$g$是什么。\n\n**第 5 步：计算验证**\n该实现将对每个测试张量$A^{(k)}$进行数值计算。它将计算$F_{\\text{ref}}(A^{(k)})$，然后计算$g^{(1)} = J_1$和$g^{(2)} = J_2 - 2 J_3$对应的$F^{(g)}(A^{(k)})$。验证的核心是检查三个条件：\n1. 两个非最小表示$F^{(g^{(1)})}(A^{(k)})$和$F^{(g^{(2)})}(A^{(k)})$在 Frobenius 范数$\\|\\cdot\\|_F$下必须与参考$F_{\\text{ref}}(A^{(k)})$在容差$\\varepsilon = 10^{-10}$范围内数值相等。\n2. 非最小基中的系数向量$\\vec{\\beta}^{(g^{(1)})}$和$\\vec{\\beta}^{(g^{(2)})}$必须是不同的，这通过它们的欧几里得范数差大于$10^{-8}$来确认。\n3. 从两个非最小表示中恢复的最小基系数向量必须与原始的$(\\alpha_0, \\alpha_1, \\alpha_2)$在最大范数下于容差$\\varepsilon = 10^{-10}$范围内数值相等。\n当且仅当所有三个条件都满足时，布尔结果$b^{(k)}$才为$\\mathrm{True}$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Constructs and runs a computational experiment on isotropic tensor function representations.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        np.array([[2.0, 0.5, -0.3], [0.5, 1.5, 0.2], [-0.3, 0.2, 0.7]]),\n        np.array([[1.2, 0.0, 0.0], [0.0, 1.2, 0.0], [0.0, 0.0, 1.2]]),\n        np.array([[1.0, 2.0, 3.0], [2.0, 4.0, 6.0], [3.0, 6.0, 9.0]]),\n    ]\n    \n    TOLERANCE_EQUALITY = 1e-10\n    TOLERANCE_DIFFERENCE = 1e-8\n    \n    results = []\n\n    for A in test_cases:\n        # Step 1: Compute principal invariants\n        I = np.identity(3)\n        A2 = A @ A\n        \n        J1 = np.trace(A)\n        # The formula J2 = 0.5 * (tr(A)^2 - tr(A^2)) is used.\n        J2 = 0.5 * (J1**2 - np.trace(A2))\n        J3 = np.linalg.det(A)\n\n        # Step 2: Define scalar coefficient functions for the minimal basis\n        alpha_0 = J1 + 2 * J2\n        alpha_1 = 3 * J1 - J3\n        alpha_2 = J1 * J2 - 1\n        alpha_vec = np.array([alpha_0, alpha_1, alpha_2])\n\n        # Step 3: Construct the reference isotropic tensor function\n        F_ref = alpha_0 * I + alpha_1 * A + alpha_2 * A2\n\n        # Step 4: Work with the non-minimal basis and two g functions\n        A3 = A2 @ A\n        g1 = J1\n        g2 = J2 - 2 * J3\n        g_functions = [g1, g2]\n\n        F_g_list = []\n        beta_vec_list = []\n        alpha_rec_vec_list = []\n        \n        for g in g_functions:\n            # Define beta coefficients for the non-minimal basis\n            beta_0 = alpha_0 + g * J3\n            beta_1 = alpha_1 - g * J2\n            beta_2 = alpha_2 + g * J1\n            beta_3 = -g\n            beta_vec = np.array([beta_0, beta_1, beta_2, beta_3])\n            beta_vec_list.append(beta_vec)\n\n            # Form F^(g)(A)\n            F_g = beta_0 * I + beta_1 * A + beta_2 * A2 + beta_3 * A3\n            F_g_list.append(F_g)\n\n            # Reduce F^(g)(A) back to the minimal basis to recover alpha coefficients\n            alpha_0_rec = beta_0 + beta_3 * J3\n            alpha_1_rec = beta_1 - beta_3 * J2\n            alpha_2_rec = beta_2 + beta_3 * J1\n            alpha_rec_vec = np.array([alpha_0_rec, alpha_1_rec, alpha_2_rec])\n            alpha_rec_vec_list.append(alpha_rec_vec)\n\n        # Step 5: Numerically verify the statements\n        \n        # Condition 1: Non-minimal representations F^(g) equal F_ref\n        cond1_g1 = np.linalg.norm(F_g_list[0] - F_ref, 'fro') = TOLERANCE_EQUALITY\n        cond1_g2 = np.linalg.norm(F_g_list[1] - F_ref, 'fro') = TOLERANCE_EQUALITY\n        all_F_equal_F_ref = cond1_g1 and cond1_g2\n        \n        # Condition 2: Recovered alpha coefficients are unique and correct\n        cond2_g1 = np.max(np.abs(alpha_rec_vec_list[0] - alpha_vec)) = TOLERANCE_EQUALITY\n        cond2_g2 = np.max(np.abs(alpha_rec_vec_list[1] - alpha_vec)) = TOLERANCE_EQUALITY\n        all_alphas_recovered = cond2_g1 and cond2_g2\n\n        # Condition 3: Beta coefficient vectors are non-unique (different)\n        betas_are_different = np.linalg.norm(beta_vec_list[0] - beta_vec_list[1]) > TOLERANCE_DIFFERENCE\n\n        # Step 7: Final boolean result for the tensor\n        final_boolean = all_F_equal_F_ref and all_alphas_recovered and betas_are_different\n        results.append(final_boolean)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "各向同性张量函数的表示理论在计算固体力学中有着直接而深刻的应用，尤其是在本构模型的开发中。对于一个以应变张量不变量表示的超弹性材料的能量函数，其对应力张量和材料切线模量的推导是有限元分析等数值模拟的核心步骤。本练习将理论付诸实践，指导你如何运用基于不变量的链式法则，推导并验证这些在工程计算中至关重要的物理量。",
            "id": "3595206",
            "problem": "考虑一种各向同性超弹性材料，其Helmholtz自由能密度是右Cauchy-Green变形张量 $\\,\\mathbf{C}\\in\\mathbb{R}^{3\\times 3}\\,$ 主不变量的标量函数，定义为 $\\,W(\\mathbf{C}) = \\widehat{W}(I_1(\\mathbf{C}), I_2(\\mathbf{C}), I_3(\\mathbf{C}))\\,$，其中 $\\,I_1=\\mathrm{tr}\\,\\mathbf{C}\\,$, $\\,I_2=\\tfrac{1}{2}(I_1^2 - \\mathrm{tr}\\,\\mathbf{C}^2)\\,$ 且 $\\,I_3=\\det\\mathbf{C}\\,$。根据各向同性张量函数的表示定理，任何关于 $\\,\\mathbf{C}\\,$ 的各向同性标量函数都可以写成 $\\,I_1, I_2, I_3\\,$ 的函数。\n\n从下述基本事实和定义出发，推导 $\\,W\\,$ 关于 $\\,\\mathbf{C}\\,$ 的一阶和二阶导数的显式表达式：\n- 一阶导数 $\\,\\partial W/\\partial \\mathbf{C}\\,$，它是一个二阶张量，以及\n- 二阶导数 $\\,\\partial^2 W/\\partial \\mathbf{C}\\,\\partial \\mathbf{C}\\,$，它是一个四阶张量。\n\n在推导中仅使用以下基本要素：\n- 多变量函数和张量函数的链式法则，\n- 不变量的微分恒等式：\n  1. $\\,\\mathrm{d}I_1 = \\mathbf{I} : \\mathrm{d}\\mathbf{C}\\,$,\n  2. $\\,\\mathrm{d}I_2 = (I_1\\mathbf{I} - \\mathbf{C}) : \\mathrm{d}\\mathbf{C}\\,$,\n  3. $\\,\\mathrm{d}I_3 = I_3\\,\\mathbf{C}^{-T} : \\mathrm{d}\\mathbf{C}\\,$,\n  其中 $\\,\\mathbf{I}\\,$ 是二阶单位张量， $:$ 表示Frobenius内积。\n- 上述梯度的微分，用于构建二阶导数 $\\,\\partial^2 I_\\alpha/\\partial \\mathbf{C}\\,\\partial \\mathbf{C}\\,$，并限制在对称变分 $\\,\\mathrm{d}\\mathbf{C}=\\mathrm{d}\\mathbf{C}^T\\,$ 内：\n  1. $\\,\\partial^2 I_1/\\partial \\mathbf{C}\\,\\partial \\mathbf{C} = \\mathbb{O}\\,$ (零四阶张量),\n  2. $\\,\\partial^2 I_2/\\partial \\mathbf{C}\\,\\partial \\mathbf{C} = \\mathbf{I}\\otimes\\mathbf{I} - \\mathbb{I}_s\\,$, 其中 $\\,(\\mathbf{A}\\otimes\\mathbf{B})_{ijkl} = A_{ij}B_{kl}\\,$ 且 $\\,(\\mathbb{I}_s)_{ijkl}=\\tfrac{1}{2}(\\delta_{ik}\\delta_{jl}+\\delta_{il}\\delta_{jk})\\,$,\n  3. $\\,\\partial^2 I_3/\\partial \\mathbf{C}\\,\\partial \\mathbf{C} = I_3\\left(\\mathbf{C}^{-1}\\otimes\\mathbf{C}^{-1} - \\mathbb{K}_s\\right)\\,$, 其中 $\\,(\\mathbb{K}_s)_{ijkl}=\\tfrac{1}{2}\\left[(\\mathbf{C}^{-1})_{ik}(\\mathbf{C}^{-1})_{lj}+(\\mathbf{C}^{-1})_{il}(\\mathbf{C}^{-1})_{kj}\\right]\\,$,\n  使得对于对称的 $\\,\\mathrm{d}\\mathbf{C}\\,$，有 $\\,\\mathbb{I}_s:\\mathrm{d}\\mathbf{C}=\\mathrm{d}\\mathbf{C}\\,$ 和 $\\,\\mathbb{K}_s:\\mathrm{d}\\mathbf{C}=\\mathbf{C}^{-1}\\mathrm{d}\\mathbf{C}\\,\\mathbf{C}^{-1}\\,$。\n\n然后，在一个程序中实现你推导出的公式，该程序计算：\n- 能量 $\\,W(\\mathbf{C})\\,$,\n- 梯度 $\\,\\partial W/\\partial \\mathbf{C}\\,$,\n- Hessian矩阵 $\\,\\partial^2 W/\\partial \\mathbf{C}\\,\\partial \\mathbf{C}\\,$，即材料Hessian。在采用第二Piola-Kirchhoff应力 $\\,\\mathbf{S}=2\\,\\partial W/\\partial \\mathbf{C}\\,$ 和Green-Lagrange应变 $\\,\\mathbf{E}=\\tfrac{1}{2}(\\mathbf{C}-\\mathbf{I})\\,$ 的全拉格朗日有限元列式中，算法切线为 $\\,\\mathbb{C}_{\\mathbf{S}\\mathbf{E}}=\\partial \\mathbf{S}/\\partial \\mathbf{E}=4\\,\\partial^2 W/\\partial \\mathbf{C}\\,\\partial \\mathbf{C}\\,$.\n\n对于数值评估与验证，使用以下特定的标量能量函数：\n$$\nW(I_1,I_2,I_3) = \\tfrac{1}{2}a\\,(I_1-3)^2 + \\tfrac{1}{2}b\\,(I_2-3)^2 + \\tfrac{1}{2}c\\,(\\ln I_3)^2 + d\\,I_1 I_2 + e\\,I_2 I_3 + f\\,I_1 \\ln I_3,\n$$\n其中参数 $\\,a,b,c,d,e,f\\,$ 在下面的测试套件中指定。你的实现必须：\n- 对于给定的对称正定矩阵 $\\,\\mathbf{C}\\,$，计算 $\\,W\\,$, $\\,\\partial W/\\partial \\mathbf{C}\\,$ 和 $\\,\\partial^2 W/\\partial \\mathbf{C}\\,\\partial \\mathbf{C}\\,$，\n- 通过将解析方向导数 $\\,(\\partial W/\\partial \\mathbf{C}) : \\mathbf{D}\\,$ 与对称方向 $\\,\\mathbf{D}\\,$ 的中心有限差分近似进行比较来验证梯度，\n- 通过将 $\\,\\mathbf{D} : (\\partial^2 W/\\partial \\mathbf{C}\\,\\partial \\mathbf{C} : \\mathbf{D})\\,$ 与二阶中心有限差分近似进行比较来验证Hessian矩阵，\n- 验证限制在对称张量上的四阶Hessian矩阵的次对称性和主对称性。\n\n使用以下测试套件。对于每种情况，构建 $\\,\\mathbf{C}=\\mathbf{F}^T\\mathbf{F}\\,$ 并使用给定的对称方向 $\\,\\mathbf{D}\\,$ 和参数 $\\,a,b,c,d,e,f\\,$：\n1. 情况 1:\n   - $\\,\\mathbf{F}_1 = \\begin{bmatrix}1  0  0 \\\\ 0  1  0 \\\\ 0  0  1\\end{bmatrix}\\,$,\n   - $\\,\\mathbf{D}_1 = \\begin{bmatrix}0.3  -0.1  0.05 \\\\ -0.1  0.2  0.07 \\\\ 0.05  0.07  -0.15\\end{bmatrix}\\,$,\n   - $\\,a=1.5,\\,b=0.8,\\,c=2.2,\\,d=0.6,\\,e=-0.4,\\,f=0.9\\,$.\n2. 情况 2:\n   - $\\,\\mathbf{F}_2 = \\begin{bmatrix}1.15  0.20  0 \\\\ 0.10  0.95  0.05 \\\\ 0  -0.05  1.10\\end{bmatrix}\\,$,\n   - $\\,\\mathbf{D}_2 = \\begin{bmatrix}-0.2  0.12  0.03 \\\\ 0.12  0.1  -0.04 \\\\ 0.03  -0.04  0.05\\end{bmatrix}\\,$,\n   - $\\,a=2.0,\\,b=1.0,\\,c=1.2,\\,d=-0.3,\\,e=0.55,\\,f=1.1\\,$.\n3. 情况 3:\n   - $\\,\\mathbf{F}_3 = \\begin{bmatrix}0.9  0.3  0.1 \\\\ 0  1.05  -0.2 \\\\ 0  0  1.2\\end{bmatrix}\\,$,\n   - $\\,\\mathbf{D}_3 = \\begin{bmatrix}0.08  -0.02  0.01 \\\\ -0.02  -0.06  0.03 \\\\ 0.01  0.03  0.02\\end{bmatrix}\\,$,\n   - $\\,a=0.7,\\,b=1.5,\\,c=0.9,\\,d=0.4,\\,e=-0.2,\\,f=0.5\\,$.\n4. 情况 4:\n   - $\\,\\mathbf{F}_4 = \\begin{bmatrix}1.02  0.02  0 \\\\ 0  0.98  0.01 \\\\ 0  0  1.00\\end{bmatrix}\\,$,\n   - $\\,\\mathbf{D}_4 = \\begin{bmatrix}0.05  0.01  -0.02 \\\\ 0.01  -0.04  0.015 \\\\ -0.02  0.015  -0.01\\end{bmatrix}\\,$,\n   - $\\,a=1.0,\\,b=1.0,\\,c=10.0,\\,d=0.2,\\,e=0.1,\\,f=0.0\\,$.\n\n数值验证细节：\n- 对于一阶导数，沿给定方向 $\\,\\mathbf{D}\\,$ 使用步长 $\\,\\varepsilon_1=10^{-7}\\,$ 的中心差分；对于二阶导数，使用步长 $\\,\\varepsilon_2=10^{-6}\\,$.\n- 对于每种情况，产生三个布尔值检查：\n  1. 梯度检查: $\\,\\left|(\\partial W/\\partial \\mathbf{C}):\\mathbf{D} - \\dfrac{W(\\mathbf{C}+\\varepsilon_1\\mathbf{D}) - W(\\mathbf{C}-\\varepsilon_1\\mathbf{D})}{2\\varepsilon_1}\\right| \\le 10^{-8}\\,$,\n  2. Hessian检查: $\\,\\left|\\mathbf{D}:\\left(\\dfrac{\\partial^2 W}{\\partial \\mathbf{C}\\,\\partial \\mathbf{C}}:\\mathbf{D}\\right) - \\dfrac{W(\\mathbf{C}+\\varepsilon_2\\mathbf{D}) - 2W(\\mathbf{C}) + W(\\mathbf{C}-\\varepsilon_2\\mathbf{D})}{\\varepsilon_2^2}\\right| \\le 10^{-6}\\,$,\n  3. 对称性检查: 四阶张量 $\\,\\partial^2 W/\\partial \\mathbf{C}\\,\\partial \\mathbf{C}\\,$ 在 $\\,10^{-10}\\,$ 精度内满足次对称性和主对称性，即 $\\,\\|\\mathbb{H}-\\mathbb{H}^{(ij)}\\|_\\infty\\le 10^{-10}\\,$, $\\,\\|\\mathbb{H}-\\mathbb{H}^{(kl)}\\|_\\infty\\le 10^{-10}\\,$ 且 $\\,\\|\\mathbb{H}-\\mathbb{H}^{(ij\\leftrightarrow kl)}\\|_\\infty\\le 10^{-10}\\,$，其中上标表示对四阶张量的指标置换。\n\n最终输出格式：\n- 你的程序应生成一行输出，包含四个情况的十二个布尔结果，按 $[\\text{grad}_1,\\text{hess}_1,\\text{sym}_1,\\text{grad}_2,\\text{hess}_2,\\text{sym}_2,\\text{grad}_3,\\text{hess}_3,\\text{sym}_3,\\text{grad}_4,\\text{hess}_4,\\text{sym}_4]$ 的顺序列出，打印为用方括号括起来的逗号分隔列表（例如，“[True,True,False, ...]\"）。\n- 无需用户输入，不涉及物理单位；所有量均为无量纲量。",
            "solution": "该问题要求推导一个各向同性标量值张量函数（即Helmholtz自由能$W$）关于其自变量（即右Cauchy-Green变形张量$\\mathbf{C}$）的一阶和二阶导数。能量$W$被给定为$\\mathbf{C}$的主不变量的函数, $W(\\mathbf{C}) = \\widehat{W}(I_1(\\mathbf{C}), I_2(\\mathbf{C}), I_3(\\mathbf{C}))$。\n\n### 问题验证\n**步骤 1: 提取已知条件**\n- Helmholtz自由能是$\\mathbf{C}$的不变量的函数：$W(\\mathbf{C}) = \\widehat{W}(I_1, I_2, I_3)$。\n- 不变量定义为：$I_1 = \\mathrm{tr}\\,\\mathbf{C}$， $I_2 = \\tfrac{1}{2}((\\mathrm{tr}\\,\\mathbf{C})^2 - \\mathrm{tr}\\,\\mathbf{C}^2)$，以及 $I_3 = \\det\\mathbf{C}$。\n- 不变量的微分恒等式：\n  1. $\\mathrm{d}I_1 = \\mathbf{I} : \\mathrm{d}\\mathbf{C}$\n  2. $\\mathrm{d}I_2 = (I_1\\mathbf{I} - \\mathbf{C}) : \\mathrm{d}\\mathbf{C}$\n  3. $\\mathrm{d}I_3 = I_3\\,\\mathbf{C}^{-T} : \\mathrm{d}\\mathbf{C}$\n- 不变量的二阶导数给定为：\n  1. $\\partial^2 I_1/\\partial \\mathbf{C}\\,\\partial \\mathbf{C} = \\mathbb{O}$ (零四阶张量)\n  2. $\\partial^2 I_2/\\partial \\mathbf{C}\\,\\partial \\mathbf{C} = \\mathbf{I}\\otimes\\mathbf{I} - \\mathbb{I}_s$\n  3. $\\partial^2 I_3/\\partial \\mathbf{C}\\,\\partial \\mathbf{C} = I_3\\left(\\mathbf{C}^{-1}\\otimes\\mathbf{C}^{-1} - \\mathbb{K}_s\\right)$\n  此处, $(\\mathbb{I}_s)_{ijkl}=\\tfrac{1}{2}(\\delta_{ik}\\delta_{jl}+\\delta_{il}\\delta_{jk})$ 且 $(\\mathbb{K}_s)_{ijkl}=\\tfrac{1}{2}((\\mathbf{C}^{-1})_{ik}(\\mathbf{C}^{-1})_{lj}+(\\mathbf{C}^{-1})_{il}(\\mathbf{C}^{-1})_{kj})$。\n- 能量函数的具体形式已提供：\n$$\nW(I_1,I_2,I_3) = \\tfrac{1}{2}a\\,(I_1-3)^2 + \\tfrac{1}{2}b\\,(I_2-3)^2 + \\tfrac{1}{2}c\\,(\\ln I_3)^2 + d\\,I_1 I_2 + e\\,I_2 I_3 + f\\,I_1 \\ln I_3\n$$\n- 四个测试案例的数值数据，包括$\\mathbf{F}$、$\\mathbf{D}$以及参数$a,b,c,d,e,f$。\n- 基于具有指定步长和容差的中心有限差分的验证标准。\n\n**步骤 2: 使用提取的已知条件进行验证**\n该问题在科学上是成立的，属于非线性连续介质力学和超弹性这一成熟领域。不变量和表示定理的使用是该领域的基石。所提供的所有数学定义和恒等式都是标准且正确的。该问题是适定的、客观的、自洽的，为获得唯一可验证的解提供了所有必要信息。不存在矛盾、歧义或不科学的假设。\n\n**步骤 3: 结论与行动**\n该问题被判定为**有效**。将提供完整的推导和解答。\n\n### 导数推导\n令 $W_\\alpha = \\partial \\widehat{W} / \\partial I_\\alpha$ 和 $W_{\\alpha\\beta} = \\partial^2 \\widehat{W} / \\partial I_\\alpha \\partial I_\\beta$ 分别表示能量函数对其参数（即不变量）的偏导数。\n\n**1. W关于C的一阶导数**\n使用链式法则， $W$ 关于 $\\mathbf{C}$ 的一阶导数为：\n$$\n\\frac{\\partial W}{\\partial \\mathbf{C}} = \\sum_{\\alpha=1}^{3} \\frac{\\partial \\widehat{W}}{\\partial I_\\alpha} \\frac{\\partial I_\\alpha}{\\partial \\mathbf{C}} = W_1 \\frac{\\partial I_1}{\\partial \\mathbf{C}} + W_2 \\frac{\\partial I_2}{\\partial \\mathbf{C}} + W_3 \\frac{\\partial I_3}{\\partial \\mathbf{C}}\n$$\n不变量的梯度 $\\partial I_\\alpha/\\partial \\mathbf{C}$ 可以从其微分形式 $\\mathrm{d}I_\\alpha = (\\partial I_\\alpha/\\partial \\mathbf{C}) : \\mathrm{d}\\mathbf{C}$ 中确定。考虑到 $\\mathbf{C}$ 是对称的，有 $\\mathbf{C}^{-T} = \\mathbf{C}^{-1}$。\n- 从 $\\mathrm{d}I_1 = \\mathbf{I} : \\mathrm{d}\\mathbf{C}$，我们得到 $\\frac{\\partial I_1}{\\partial \\mathbf{C}} = \\mathbf{I}$。\n- 从 $\\mathrm{d}I_2 = (I_1\\mathbf{I} - \\mathbf{C}) : \\mathrm{d}\\mathbf{C}$，我们得到 $\\frac{\\partial I_2}{\\partial \\mathbf{C}} = I_1\\mathbf{I} - \\mathbf{C}$。\n- 从 $\\mathrm{d}I_3 = I_3\\mathbf{C}^{-1} : \\mathrm{d}\\mathbf{C}$，我们得到 $\\frac{\\partial I_3}{\\partial \\mathbf{C}} = I_3\\mathbf{C}^{-1}$。\n\n给定能量函数的偏导数 $W_\\alpha$ 为：\n- $W_1 = \\frac{\\partial \\widehat{W}}{\\partial I_1} = a(I_1-3) + d I_2 + f \\ln I_3$\n- $W_2 = \\frac{\\partial \\widehat{W}}{\\partial I_2} = b(I_2-3) + d I_1 + e I_3$\n- $W_3 = \\frac{\\partial \\widehat{W}}{\\partial I_3} = c \\frac{\\ln I_3}{I_3} + e I_2 + f \\frac{I_1}{I_3}$\n\n代入这些分量，一阶导数为：\n$$\n\\frac{\\partial W}{\\partial \\mathbf{C}} = \\left(a(I_1-3) + d I_2 + f \\ln I_3\\right)\\mathbf{I} + \\left(b(I_2-3) + d I_1 + e I_3\\right)(I_1\\mathbf{I} - \\mathbf{C}) + \\left(c \\frac{\\ln I_3}{I_3} + e I_2 + f \\frac{I_1}{I_3}\\right)I_3\\mathbf{C}^{-1}\n$$\n\n**2. W关于C的二阶导数**\n二阶导数是一个四阶张量，通过将一阶导数对 $\\mathbf{C}$ 微分得到：\n$$\n\\frac{\\partial^2 W}{\\partial \\mathbf{C} \\partial \\mathbf{C}} = \\frac{\\partial}{\\partial \\mathbf{C}} \\left( \\sum_{\\alpha=1}^{3} W_\\alpha \\frac{\\partial I_\\alpha}{\\partial \\mathbf{C}} \\right)\n$$\n应用张量函数的乘法法则和链式法则：\n$$\n\\frac{\\partial^2 W}{\\partial \\mathbf{C} \\partial \\mathbf{C}} = \\sum_{\\alpha=1}^{3} \\left[ \\frac{\\partial W_\\alpha}{\\partial \\mathbf{C}} \\otimes \\frac{\\partial I_\\alpha}{\\partial \\mathbf{C}} + W_\\alpha \\frac{\\partial^2 I_\\alpha}{\\partial \\mathbf{C} \\partial \\mathbf{C}} \\right]\n$$\n再次使用链式法则展开 $\\partial W_\\alpha / \\partial \\mathbf{C}$ 项：\n$$\n\\frac{\\partial W_\\alpha}{\\partial \\mathbf{C}} = \\sum_{\\beta=1}^{3} \\frac{\\partial W_\\alpha}{\\partial I_\\beta} \\frac{\\partial I_\\beta}{\\partial \\mathbf{C}} = \\sum_{\\beta=1}^{3} W_{\\alpha\\beta} \\frac{\\partial I_\\beta}{\\partial \\mathbf{C}}\n$$\n将其代回，得到材料Hessian的一般表达式：\n$$\n\\mathbb{H} = \\frac{\\partial^2 W}{\\partial \\mathbf{C} \\partial \\mathbf{C}} = \\sum_{\\alpha=1}^{3} \\sum_{\\beta=1}^{3} W_{\\alpha\\beta} \\frac{\\partial I_\\beta}{\\partial \\mathbf{C}} \\otimes \\frac{\\partial I_\\alpha}{\\partial \\mathbf{C}} + \\sum_{\\alpha=1}^{3} W_\\alpha \\frac{\\partial^2 I_\\alpha}{\\partial \\mathbf{C} \\partial \\mathbf{C}}\n$$\n我们需要$\\widehat{W}$关于不变量的二阶偏导数：\n- $W_{11} = \\frac{\\partial^2 \\widehat{W}}{\\partial I_1^2} = a$\n- $W_{12} = \\frac{\\partial^2 \\widehat{W}}{\\partial I_1 \\partial I_2} = d$\n- $W_{13} = \\frac{\\partial^2 \\widehat{W}}{\\partial I_1 \\partial I_3} = \\frac{f}{I_3}$\n- $W_{22} = \\frac{\\partial^2 \\widehat{W}}{\\partial I_2^2} = b$\n- $W_{23} = \\frac{\\partial^2 \\widehat{W}}{\\partial I_2 \\partial I_3} = e$\n- $W_{33} = \\frac{\\partial^2 \\widehat{W}}{\\partial I_3^2} = c \\frac{1 - \\ln I_3}{I_3^2} - f \\frac{I_1}{I_3^2}$\n\n我们记 $\\mathbf{G}_\\alpha = \\partial I_\\alpha / \\partial \\mathbf{C}$ 和 $\\mathbb{H}_\\alpha = \\partial^2 I_\\alpha / \\partial \\mathbf{C} \\partial \\mathbf{C}$。Hessian矩阵为\n$$\n\\mathbb{H} = \\sum_{\\alpha, \\beta=1}^{3} W_{\\alpha\\beta} \\, (\\mathbf{G}_\\beta \\otimes \\mathbf{G}_\\alpha) + W_1 \\mathbb{H}_1 + W_2 \\mathbb{H}_2 + W_3 \\mathbb{H}_3\n$$\n代入给定的$\\mathbb{H}_\\alpha$表达式：\n$$\n\\mathbb{H} = \\sum_{\\alpha, \\beta=1}^{3} W_{\\alpha\\beta} \\, (\\mathbf{G}_\\beta \\otimes \\mathbf{G}_\\alpha) + W_2 (\\mathbf{I}\\otimes\\mathbf{I} - \\mathbb{I}_s) + W_3 I_3\\left(\\mathbf{C}^{-1}\\otimes\\mathbf{C}^{-1} - \\mathbb{K}_s\\right)\n$$\n该表达式是关于 $\\mathbf{C}$、其不变量以及材料参数的显式表达。它可以直接进行数值实现。第一项是九个二阶张量并矢积的和。其余项是给定四阶张量的缩放版本。$\\mathbb{H}$ 的最终表达式将用于实现中的验证。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main solver function that iterates through test cases and prints results.\n    \"\"\"\n    # Define test cases as per the problem statement\n    test_cases = [\n        {\n            \"F\": np.array([[1.0, 0.0, 0.0], [0.0, 1.0, 0.0], [0.0, 0.0, 1.0]]),\n            \"D\": np.array([[0.3, -0.1, 0.05], [-0.1, 0.2, 0.07], [0.05, 0.07, -0.15]]),\n            \"params\": (1.5, 0.8, 2.2, 0.6, -0.4, 0.9)  # a, b, c, d, e, f\n        },\n        {\n            \"F\": np.array([[1.15, 0.20, 0.0], [0.10, 0.95, 0.05], [0.0, -0.05, 1.10]]),\n            \"D\": np.array([[-0.2, 0.12, 0.03], [0.12, 0.1, -0.04], [0.03, -0.04, 0.05]]),\n            \"params\": (2.0, 1.0, 1.2, -0.3, 0.55, 1.1)\n        },\n        {\n            \"F\": np.array([[0.9, 0.3, 0.1], [0.0, 1.05, -0.2], [0.0, 0.0, 1.2]]),\n            \"D\": np.array([[0.08, -0.02, 0.01], [-0.02, -0.06, 0.03], [0.01, 0.03, 0.02]]),\n            \"params\": (0.7, 1.5, 0.9, 0.4, -0.2, 0.5)\n        },\n        {\n            \"F\": np.array([[1.02, 0.02, 0.0], [0.0, 0.98, 0.01], [0.0, 0.0, 1.00]]),\n            \"D\": np.array([[0.05, 0.01, -0.02], [0.01, -0.04, 0.015], [-0.02, 0.015, -0.01]]),\n            \"params\": (1.0, 1.0, 10.0, 0.2, 0.1, 0.0)\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        F = case[\"F\"]\n        D = case[\"D\"]\n        params = case[\"params\"]\n        grad_check, hess_check, sym_check = perform_case_analysis(F, D, params)\n        results.extend([grad_check, hess_check, sym_check])\n\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef _calculate_W(C_tensor, params):\n    \"\"\"Helper function to compute the scalar energy W for a given C.\"\"\"\n    a, b, c, d, e, f = params\n    I1 = np.trace(C_tensor)\n    I2 = 0.5 * (I1**2 - np.trace(C_tensor @ C_tensor))\n    I3 = np.linalg.det(C_tensor)\n    \n    if I3 = 0: return np.inf # Physically inadmissible state\n    ln_I3 = np.log(I3)\n\n    return (0.5 * a * (I1 - 3)**2 +\n            0.5 * b * (I2 - 3)**2 +\n            0.5 * c * ln_I3**2 +\n            d * I1 * I2 +\n            e * I2 * I3 +\n            f * I1 * ln_I3)\n\ndef perform_case_analysis(F, D, params):\n    \"\"\"\n    Performs the full analysis for a single test case:\n    1. Computes W, gradient, and Hessian.\n    2. Verifies gradient and Hessian via finite differences.\n    3. Verifies symmetries of the Hessian.\n    Returns three boolean checks.\n    \"\"\"\n    a, b, c, d, e, f = params\n    eps1, eps2 = 1e-7, 1e-6\n    grad_tol, hess_tol, sym_tol = 1e-8, 1e-6, 1e-10\n\n    # Basic Tensors\n    C = F.T @ F\n    C_inv = np.linalg.inv(C)\n    I = np.eye(3)\n\n    # Invariants\n    I1 = np.trace(C)\n    I2 = 0.5 * (I1**2 - np.trace(C @ C))\n    I3 = np.linalg.det(C)\n    ln_I3 = np.log(I3)\n\n    # Energy\n    W = _calculate_W(C, params)\n\n    # First derivatives of W w.r.t. invariants\n    W1 = a * (I1 - 3) + d * I2 + f * ln_I3\n    W2 = b * (I2 - 3) + d * I1 + e * I3\n    W3 = c * ln_I3 / I3 + e * I2 + f * I1 / I3\n\n    # First derivative of W w.r.t. C\n    dW_dC = W1 * I + W2 * (I1 * I - C) + W3 * I3 * C_inv\n\n    # Second derivatives of W w.r.t. invariants\n    W11 = a\n    W12 = d\n    W13 = f / I3\n    W22 = b\n    W23 = e\n    W33 = c * (1 - ln_I3) / I3**2 - f * I1 / I3**2\n    W_ab = np.array([[W11, W12, W13], [W12, W22, W23], [W13, W23, W33]])\n\n    # Assemble the Hessian (4th order tensor)\n    G_alpha = [I, I1 * I - C, I3 * C_inv]\n    \n    H_term1 = np.zeros((3, 3, 3, 3))\n    for alpha in range(3):\n        for beta in range(3):\n            H_term1 += W_ab[alpha, beta] * np.einsum('ij,kl->ijkl', G_alpha[beta], G_alpha[alpha])\n\n    # Special 4th-order tensors\n    II = np.einsum('ij,kl->ijkl', I, I)\n    Is = 0.5 * (np.einsum('ik,jl->ijkl', I, I) + np.einsum('il,jk->ijkl', I, I))\n    \n    CInvCInv = np.einsum('ij,kl->ijkl', C_inv, C_inv)\n    # Note: C_inv is symmetric, so C_inv_lj = C_inv_jl.\n    Ks = 0.5 * (np.einsum('ik,jl->ijkl', C_inv, C_inv) + np.einsum('il,jk->ijkl', C_inv, C_inv))\n\n    H_term2 = W2 * (II - Is)\n    H_term3 = W3 * I3 * (CInvCInv - Ks)\n\n    H = H_term1 + H_term2 + H_term3\n\n    # --- Verification ---\n\n    # 1. Gradient Check\n    grad_ana = np.sum(dW_dC * D)\n    W_p1 = _calculate_W(C + eps1 * D, params)\n    W_m1 = _calculate_W(C - eps1 * D, params)\n    grad_fd = (W_p1 - W_m1) / (2 * eps1)\n    grad_check = np.abs(grad_ana - grad_fd) = grad_tol\n\n    # 2. Hessian Check\n    hess_ana = np.einsum('ijkl,ij,kl', H, D, D)\n    W_p2 = _calculate_W(C + eps2 * D, params)\n    W_m2 = _calculate_W(C - eps2 * D, params)\n    hess_fd = (W_p2 - 2 * W + W_m2) / eps2**2\n    hess_check = np.abs(hess_ana - hess_fd) = hess_tol\n\n    # 3. Symmetry Check\n    minor_sym1_check = np.max(np.abs(H - H.transpose(1, 0, 2, 3))) = sym_tol\n    minor_sym2_check = np.max(np.abs(H - H.transpose(0, 1, 3, 2))) = sym_tol\n    major_sym_check = np.max(np.abs(H - H.transpose(2, 3, 0, 1))) = sym_tol\n    sym_check = minor_sym1_check and minor_sym2_check and major_sym_check\n\n    return grad_check, hess_check, sym_check\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}