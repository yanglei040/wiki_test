{
    "hands_on_practices": [
        {
            "introduction": "将哈密顿原理应用于连续体动力学的第一步是空间离散化。本练习将引导您完成这一关键过程，重点关注动能项。您将从动能的积分形式出发，通过引入有限元形函数，推导出系统的一致质量矩阵。通过将变分一致的质量矩阵与其在实践中常用的集总质量近似进行比较 ，您可以具体地理解数值近似对系统动力学特性的影响。",
            "id": "3569540",
            "problem": "考虑一个处于参考构型中的单个四节点双线性四边形有限元，该单元用于模拟一个无外力作用下进行小位移运动的均匀、各向同性弹性固体。参考域为单位正方形，其面外厚度为 $t_0 = 0.01 \\ \\mathrm{m}$，即 $\\Omega_0 = \\{(X,Y) \\mid 0 \\leq X \\leq 1, \\ 0 \\leq Y \\leq 1\\}$。材料的质量密度为常数 $\\rho_0 = 7800 \\ \\mathrm{kg/m^3}$。假设位移的单个笛卡尔分量由标准的四节点双线性形函数离散化：\n$$\nN_1(X,Y) = (1 - X)(1 - Y), \\quad\nN_2(X,Y) = X(1 - Y), \\quad\nN_3(X,Y) = XY, \\quad\nN_4(X,Y) = (1 - X)Y,\n$$\n因此离散场为 $u(X,Y,t) = \\sum_{i=1}^{4} N_i(X,Y) \\, q_i(t)$，其中 $q_i(t)$ 为广义坐标。\n\n从动力学的哈密顿原理出发，通过使用在 $\\Omega_0$ 上（考虑给定厚度）的精确动能积分，推导该单元的半离散运动方程，并从基本原理出发求得一致单元质量矩阵的各项。然后，通过行和法构建对角集中质量矩阵，并根据由哈密顿原理得到的半离散能量，解释在无外力的情况下质量集中对能量守恒的影响。\n\n最后，对于节点速度向量 $\\dot{\\boldsymbol{q}} = \\begin{pmatrix}1  2  3  4\\end{pmatrix}^{\\mathsf{T}} \\ \\mathrm{m/s}$，计算使用一致质量矩阵得到的动能与使用集中质量矩阵得到的动能之间的标量差 $\\Delta T = T_{\\text{consistent}} - T_{\\text{lumped}}$。将您的答案四舍五入至四位有效数字。最终能量以焦耳（Joule）为单位表示。",
            "solution": "该问题被验证为具有科学依据、适定且客观。它提出了一个计算固体力学中的标准问题，可以利用所提供的信息进行求解。\n\n哈密顿原理指出，对于一个保守力学系统，作用量积分的变分为零，即 $\\delta \\int_{t_1}^{t_2} L \\, dt = 0$，其中 $L = T - V$ 是拉格朗日量，$T$ 是动能，$V$ 是势能。对于给定的无外力作用的弹性固体，该系统是保守的。\n\n单元的动能 $T$ 由动能密度在其体积 $\\Omega$ 上的积分给出：\n$$\nT = \\frac{1}{2} \\int_{\\Omega} \\rho \\dot{u}^2 \\, dV\n$$\n对于参考构型，动能为 $T = \\frac{1}{2} \\int_{\\Omega_0} \\rho_0 \\dot{u}^2 \\, dV_0$。位移场 $u$ 是一个单一的笛卡尔分量，使用形函数 $N_i$ 和节点自由度 $q_i(t)$ 离散化为 $u(X,Y,t) = \\sum_{i=1}^{4} N_i(X,Y) q_i(t)$。这可以写成矩阵形式 $u = \\mathbf{N}\\mathbf{q}$，其中 $\\mathbf{N} = \\begin{pmatrix} N_1  N_2  N_3  N_4 \\end{pmatrix}$ 且 $\\mathbf{q} = \\begin{pmatrix} q_1  q_2  q_3  q_4 \\end{pmatrix}^\\mathsf{T}$。\n\n速度场为 $\\dot{u} = \\mathbf{N}\\dot{\\mathbf{q}}$。将其代入动能表达式中得到：\n$$\nT = \\frac{1}{2} \\int_{\\Omega_0} \\rho_0 (\\mathbf{N}\\dot{\\mathbf{q}})^{\\mathsf{T}} (\\mathbf{N}\\dot{\\mathbf{q}}) \\, dV_0 = \\frac{1}{2} \\int_{\\Omega_0} \\rho_0 \\dot{\\mathbf{q}}^{\\mathsf{T}} \\mathbf{N}^{\\mathsf{T}} \\mathbf{N} \\dot{\\mathbf{q}} \\, dV_0\n$$\n由于节点速度 $\\dot{\\mathbf{q}}$ 仅是时间的函数而不是位置的函数，因此可以将其从积分中提出：\n$$\nT = \\frac{1}{2} \\dot{\\mathbf{q}}^{\\mathsf{T}} \\left( \\rho_0 \\int_{\\Omega_0} \\mathbf{N}^{\\mathsf{T}} \\mathbf{N} \\, dV_0 \\right) \\dot{\\mathbf{q}} = \\frac{1}{2} \\dot{\\mathbf{q}}^{\\mathsf{T}} \\mathbf{M} \\dot{\\mathbf{q}}\n$$\n其中 $\\mathbf{M} = \\rho_0 \\int_{\\Omega_0} \\mathbf{N}^{\\mathsf{T}} \\mathbf{N} \\, dV_0$ 是一致单元质量矩阵。\n\n势能 $V$ 是储存在单元中的应变能，可以表示为二次型 $V = \\frac{1}{2} \\mathbf{q}^{\\mathsf{T}} \\mathbf{K} \\mathbf{q}$，其中 $\\mathbf{K}$ 是单元刚度矩阵。离散系统的拉格朗日量为 $L = \\frac{1}{2} \\dot{\\mathbf{q}}^{\\mathsf{T}} \\mathbf{M} \\dot{\\mathbf{q}} - \\frac{1}{2} \\mathbf{q}^{\\mathsf{T}} \\mathbf{K} \\mathbf{q}$。\n\n应用欧拉-拉格朗日方程 $\\frac{d}{dt}\\left(\\frac{\\partial L}{\\partial \\dot{\\mathbf{q}}}\\right) - \\frac{\\partial L}{\\partial \\mathbf{q}} = \\mathbf{0}$，得到半离散运动方程：\n$$\n\\mathbf{M} \\ddot{\\mathbf{q}} + \\mathbf{K} \\mathbf{q} = \\mathbf{0}\n$$\n\n接下来，我们计算一致质量矩阵 $\\mathbf{M}_{\\text{consistent}}$。体积元为 $dV_0 = t_0 \\, dX \\, dY$，其中 $t_0$ 是常数厚度。积分域是 $X-Y$ 平面上的单位正方形。质量矩阵的元素由下式给出：\n$$\nM_{ij} = \\rho_0 t_0 \\int_{0}^{1} \\int_{0}^{1} N_i(X,Y) N_j(X,Y) \\, dX \\, dY\n$$\n由于形函数是乘积形式，这些积分是可分离的。让我们计算这些基本积分：\n$\\int_0^1 (1-\\xi)^2 d\\xi = \\frac{1}{3}$，$\\int_0^1 \\xi^2 d\\xi = \\frac{1}{3}$，$\\int_0^1 \\xi(1-\\xi) d\\xi = \\frac{1}{6}$，$\\int_0^1 \\xi d\\xi = \\frac{1}{2}$，$\\int_0^1 (1-\\xi) d\\xi = \\frac{1}{2}$。\n例如，对于对角项 $M_{11}$：\n$M_{11} = \\rho_0 t_0 \\int_0^1 (1-X)^2 dX \\int_0^1 (1-Y)^2 dY = \\rho_0 t_0 (\\frac{1}{3})(\\frac{1}{3}) = \\frac{\\rho_0 t_0}{9}$。\n对于非对角项 $M_{12}$：\n$M_{12} = \\rho_0 t_0 \\int_0^1 X(1-X) dX \\int_0^1 (1-Y)^2 dY = \\rho_0 t_0 (\\frac{1}{6})(\\frac{1}{3}) = \\frac{\\rho_0 t_0}{18}$。\n对于非对角项 $M_{13}$：\n$M_{13} = \\rho_0 t_0 \\int_0^1 X(1-X) dX \\int_0^1 Y(1-Y) dY = \\rho_0 t_0 (\\frac{1}{6})(\\frac{1}{6}) = \\frac{\\rho_0 t_0}{36}$。\n根据对称性和形函数的结构，我们可以构建完整的矩阵。令 $c = \\rho_0 t_0 = 7800 \\frac{\\text{kg}}{\\text{m}^3} \\times 0.01 \\ \\text{m} = 78 \\ \\frac{\\text{kg}}{\\text{m}^2}$。\n$$\n\\mathbf{M}_{\\text{consistent}} = \\frac{c}{36} \\begin{pmatrix} 4  2  1  2 \\\\ 2  4  2  1 \\\\ 1  2  4  2 \\\\ 2  1  2  4 \\end{pmatrix} = \\frac{78}{36} \\begin{pmatrix} 4  2  1  2 \\\\ 2  4  2  1 \\\\ 1  2  4  2 \\\\ 2  1  2  4 \\end{pmatrix} = \\frac{13}{6} \\begin{pmatrix} 4  2  1  2 \\\\ 2  4  2  1 \\\\ 1  2  4  2 \\\\ 2  1  2  4 \\end{pmatrix}\n$$\n集中质量矩阵 $\\mathbf{M}_{\\text{lumped}}$ 通过行和法构建，其中每个对角元素是其在一致质量矩阵中对应行的所有元素之和，所有非对角元素均为零。\n$M_{ii}^{\\text{lumped}} = \\sum_{j=1}^{4} M_{ij}^{\\text{consistent}}$。\n对于第一行：$\\sum_{j=1}^{4} M_{1j} = \\frac{13}{6}(4+2+1+2) = \\frac{13}{6}(9) = \\frac{39}{2} = 19.5$。\n由于单元几何形状和形函数的对称性，所有行和都是相同的。单元的总质量为 $m = \\rho_0 t_0 \\times A = 78 \\times (1 \\times 1) = 78$ kg。集中质量矩阵的对角元素之和为 $4 \\times 19.5 = 78$，因此质量是守恒的。\n$$\n\\mathbf{M}_{\\text{lumped}} = \\begin{pmatrix} 19.5  0  0  0 \\\\ 0  19.5  0  0 \\\\ 0  0  19.5  0 \\\\ 0  0  0  19.5 \\end{pmatrix} = 19.5 \\mathbf{I}\n$$\n其中 $\\mathbf{I}$ 是 $4 \\times 4$ 的单位矩阵。\n\n质量集中对能量守恒的影响：\n在保守系统中，总能量 $E = T+V$ 是恒定的。半离散运动方程 $\\mathbf{M} \\ddot{\\mathbf{q}} + \\mathbf{K} \\mathbf{q} = \\mathbf{0}$ 保证了离散总能量 $E_{\\text{discrete}} = \\frac{1}{2} \\dot{\\mathbf{q}}^{\\mathsf{T}} \\mathbf{M} \\dot{\\mathbf{q}} + \\frac{1}{2} \\mathbf{q}^{\\mathsf{T}} \\mathbf{K} \\mathbf{q}$ 的守恒。这是因为 $\\frac{dE_{\\text{discrete}}}{dt} = \\dot{\\mathbf{q}}^{\\mathsf{T}}(\\mathbf{M}\\ddot{\\mathbf{q}} + \\mathbf{K}\\mathbf{q}) = \\dot{\\mathbf{q}}^{\\mathsf{T}}\\mathbf{0} = 0$。这种守恒性质对任何对称质量矩阵 $\\mathbf{M}$ 都成立，包括 $\\mathbf{M}_{\\text{consistent}}$ 和 $\\mathbf{M}_{\\text{lumped}}$。\n\n然而，守恒量的物理意义发生了改变。一致质量矩阵 $\\mathbf{M}_{\\text{consistent}}$ 是直接从插值场的动能积分 $T_{\\text{consistent}} = \\frac{1}{2}\\int \\rho_0 (\\mathbf{N}\\dot{\\mathbf{q}})^2 dV_0$ 推导出来的。因此，$E_{\\text{consistent}} = T_{\\text{consistent}} + V$ 是连续体能量的一个一致的离散表示。\n集中质量矩阵 $\\mathbf{M}_{\\text{lumped}}$ 是一种特别的近似。虽然最终的系统 $E_{\\text{lumped}} = T_{\\text{lumped}} + V$ 本身是能量守恒的，但其动能项 $T_{\\text{lumped}} = \\frac{1}{2}\\dot{\\mathbf{q}}^{\\mathsf{T}}\\mathbf{M}_{\\text{lumped}}\\dot{\\mathbf{q}}$ 不再是由形函数定义的速度场的真实动能。它对应于一个简化的节点点质量模型。因此，质量集中的后果不是导致最终代数系统的能量守恒被破坏，而是用一个近似的能量表达式替代了变分一致的能量表达式，从而改变了模型的动力学特性（例如，固有频率）。\n\n最后，我们计算当 $\\dot{\\boldsymbol{q}} = \\begin{pmatrix}1  2  3  4\\end{pmatrix}^{\\mathsf{T}} \\ \\mathrm{m/s}$ 时的动能差 $\\Delta T = T_{\\text{consistent}} - T_{\\text{lumped}}$。\n$$\n\\Delta T = \\frac{1}{2} \\dot{\\mathbf{q}}^{\\mathsf{T}} \\mathbf{M}_{\\text{consistent}} \\dot{\\mathbf{q}} - \\frac{1}{2} \\dot{\\mathbf{q}}^{\\mathsf{T}} \\mathbf{M}_{\\text{lumped}} \\dot{\\mathbf{q}} = \\frac{1}{2} \\dot{\\mathbf{q}}^{\\mathsf{T}} (\\mathbf{M}_{\\text{consistent}} - \\mathbf{M}_{\\text{lumped}}) \\dot{\\mathbf{q}}\n$$\n我们来计算差分矩阵 $\\mathbf{M}_{\\text{diff}} = \\mathbf{M}_{\\text{consistent}} - \\mathbf{M}_{\\text{lumped}}$。\n$M_{ii}^{\\text{lumped}} = \\frac{13}{6}(9) = \\frac{39}{2}$。一致质量矩阵的元素都乘以因子 $\\frac{13}{6}$。\n$\\mathbf{M}_{\\text{lumped}} = \\frac{13}{6} \\begin{pmatrix} 9  0  0  0 \\\\ 0  9  0  0 \\\\ 0  0  9  0 \\\\ 0  0  0  9 \\end{pmatrix}$。\n$$\n\\mathbf{M}_{\\text{diff}} = \\frac{13}{6} \\left( \\begin{pmatrix} 4  2  1  2 \\\\ 2  4  2  1 \\\\ 1  2  4  2 \\\\ 2  1  2  4 \\end{pmatrix} - \\begin{pmatrix} 9  0  0  0 \\\\ 0  9  0  0 \\\\ 0  0  9  0 \\\\ 0  0  0  9 \\end{pmatrix} \\right) = \\frac{13}{6} \\begin{pmatrix} -5  2  1  2 \\\\ 2  -5  2  1 \\\\ 1  2  -5  2 \\\\ 2  1  2  -5 \\end{pmatrix}\n$$\n现在我们计算二次型 $\\dot{\\mathbf{q}}^{\\mathsf{T}} \\mathbf{M}_{\\text{diff}} \\dot{\\mathbf{q}}$：\n$$\n\\mathbf{M}_{\\text{diff}} \\dot{\\mathbf{q}} = \\frac{13}{6} \\begin{pmatrix} -5  2  1  2 \\\\ 2  -5  2  1 \\\\ 1  2  -5  2 \\\\ 2  1  2  -5 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\\\ 4 \\end{pmatrix} = \\frac{13}{6} \\begin{pmatrix} -5(1) + 2(2) + 1(3) + 2(4) \\\\ 2(1) - 5(2) + 2(3) + 1(4) \\\\ 1(1) + 2(2) - 5(3) + 2(4) \\\\ 2(1) + 1(2) + 2(3) - 5(4) \\end{pmatrix} = \\frac{13}{6} \\begin{pmatrix} 10 \\\\ 2 \\\\ -2 \\\\ -10 \\end{pmatrix}\n$$\n$$\n\\dot{\\mathbf{q}}^{\\mathsf{T}} (\\mathbf{M}_{\\text{diff}} \\dot{\\mathbf{q}}) = \\begin{pmatrix} 1  2  3  4 \\end{pmatrix} \\frac{13}{6} \\begin{pmatrix} 10 \\\\ 2 \\\\ -2 \\\\ -10 \\end{pmatrix} = \\frac{13}{6} (1(10) + 2(2) + 3(-2) + 4(-10))\n$$\n$$\n= \\frac{13}{6} (10 + 4 - 6 - 40) = \\frac{13}{6} (-32) = -\\frac{13 \\times 16}{3} = -\\frac{208}{3}\n$$\n能量差为 $\\Delta T = \\frac{1}{2} \\left(-\\frac{208}{3}\\right) = -\\frac{104}{3} \\approx -34.666...$ J。\n四舍五入到四位有效数字，我们得到 $\\Delta T = -34.67$ J。",
            "answer": "$$\n\\boxed{-34.67}\n$$"
        },
        {
            "introduction": "在空间离散化之后，下一步是处理时间演化。本练习介绍了一种优雅而强大的方法——变分积分法，它直接在作用量泛函的层面上进行时间离散化。您将使用一个基于中点规则的离散拉格朗日量，并应用离散哈密顿原理，来推导出一个完整的、用于求解动力学问题的全离散更新格式 。这个过程揭示了如何构建能够精确保持系统基本守恒律（如动量守恒）的数值方法。",
            "id": "3569586",
            "problem": "考虑一个超弹性连续体，其占据一个固定的参考构型 $\\Omega_{0}$，材料质量密度为 $\\rho_{0}$。令 $d(X,t)$ 表示材料位移场。引入一个时间步长为 $h>0$ 的均匀时间网格 $t_{n}=n h$，并定义单个时间步长上的中点离散拉格朗日量为\n$$\nL_{d}\\!\\left(d_{n},d_{n+1}\\right)=\\int_{\\Omega_{0}} \\tfrac{1}{2}\\,\\rho_{0}\\,\\left(\\tfrac{d_{n+1}-d_{n}}{h}\\right)\\!\\cdot\\!\\left(\\tfrac{d_{n+1}-d_{n}}{h}\\right)\\,dV \\;-\\; \\Psi\\!\\left(\\tfrac{d_{n+1}+d_{n}}{2}\\right).\n$$\n假设没有外力。进行标准的有限元（Finite Element, FE）空间离散化，使用形函数插值位移场为 $d(X,t)\\approx \\sum_{a} N_{a}(X)\\,d_{a}(t)$，从而得到节点未知向量 $d_{n}\\in\\mathbb{R}^{N}$。设一致质量矩阵为\n$$\nM=\\int_{\\Omega_{0}}\\rho_{0}\\,N^{\\top}N\\,dV,\n$$\n并假设线性弹性储能，使得离散势能可以精确地表示为二次型\n$$\n\\Psi(d)=\\tfrac{1}{2}\\,d^{\\top}K\\,d,\n$$\n其中 $K\\in\\mathbb{R}^{N\\times N}$ 为对称半正定刚度矩阵。使用离散哈密顿原理（离散作用量和的驻定性），推导节点位移向量 $d_{n+1}$ 关于 $d_{n}$ 和 $d_{n-1}$ 的全离散更新映射，仅用 $M$、$K$ 和 $h$ 表示。你可以假设更新中所求逆的矩阵是非奇异的。\n\n请以 $d_{n+1}$ 关于 $d_{n}$、$d_{n-1}$、$M$、$K$ 和 $h$ 的单个闭式解析表达式的形式提供最终答案。无需进行数值计算，也无需在最终表达式中报告单位。",
            "solution": "在进行求解之前，需要对问题进行验证。\n\n### 步骤 1：提取已知条件\n- **域：** 一个处于固定参考构型 $\\Omega_{0}$ 中的超弹性连续体。\n- **密度：** 材料质量密度 $\\rho_{0}$。\n- **位移：** 材料位移场 $d(X,t)$。\n- **时间离散化：** 时间步长为 $h>0$ 的均匀时间网格 $t_{n}=n h$。\n- **离散拉格朗日量：** $L_{d}\\!\\left(d_{n},d_{n+1}\\right)=\\int_{\\Omega_{0}} \\tfrac{1}{2}\\,\\rho_{0}\\,\\left(\\tfrac{d_{n+1}-d_{n}}{h}\\right)\\!\\cdot\\!\\left(\\tfrac{d_{n+1}-d_{n}}{h}\\right)\\,dV \\;-\\; \\Psi\\!\\left(\\tfrac{d_{n+1}+d_{n}}{2}\\right)$。\n- **外力：** 假设为零。\n- **有限元（FE）离散化：** 位移场被插值为 $d(X,t)\\approx \\sum_{a} N_{a}(X)\\,d_{a}(t)$，或以矩阵形式表示为 $d(X,t) \\approx N(X)d(t)$，其中 $d(t) \\in \\mathbb{R}^{N}$ 是节点未知向量。\n- **一致质量矩阵：** $M=\\int_{\\Omega_{0}}\\rho_{0}\\,N^{\\top}N\\,dV$。\n- **离散势能：** 二次型 $\\Psi(d)=\\tfrac{1}{2}\\,d^{\\top}K\\,d$。\n- **刚度矩阵：** $K\\in\\mathbb{R}^{N\\times N}$ 是对称且半正定的。\n- **控制原理：** 离散哈密顿原理要求离散作用量和的驻定性。\n- **目标：** 推导 $d_{n+1}$ 关于 $d_{n}$ 和 $d_{n-1}$ 的全离散更新映射，仅使用 $M$、$K$ 和 $h$。\n- **假设：** 更新中所求逆的矩阵是非奇异的。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题定义明确，具有科学依据。它为推导线性弹性动力学的变分积分器（具体来说，是 Stormer-Verlet 类型的保辛-动量守恒格式）提供了一个标准公式。离散拉格朗日量、离散哈密顿原理和有限元空间离散化的使用是计算固体力学中的基本概念。所有给定的项（质量矩阵、刚度矩阵、离散拉格朗日量）都定义正确，并与既有理论一致。该问题是自洽的、客观的，并且没有违反任何科学原理或包含逻辑缺陷。这是指定领域内一个非平凡但可解的问题。\n\n### 步骤 3：结论与行动\n问题有效。将推导解答。\n\n### 解答推导\n求解过程首先将离散拉格朗日量用节点位移向量和给定的矩阵表示，然后应用离散哈密顿原理求出运动方程。\n\n首先，我们将有限元空间离散化代入给定的离散拉格朗日量 $L_{d}\\!\\left(d_{n},d_{n+1}\\right)$。时间 $t_n$ 时的位移向量由节点向量 $d_n$ 表示。\n\n拉格朗日量的第一项是离散动能 $T_d$。使用有限元近似 $d(X, t_n) \\approx N(X)d_n$：\n$$\nT_d(d_n, d_{n+1}) = \\int_{\\Omega_{0}} \\tfrac{1}{2}\\,\\rho_{0}\\,\\left(\\frac{N d_{n+1}-N d_{n}}{h}\\right)^{\\top}\\left(\\frac{N d_{n+1}-N d_{n}}{h}\\right)\\,dV\n$$\n$$\nT_d(d_n, d_{n+1}) = \\frac{1}{2h^2} \\int_{\\Omega_{0}} \\rho_{0} (d_{n+1}-d_n)^{\\top} N^{\\top} N (d_{n+1}-d_n)\\,dV\n$$\n由于节点向量 $d_n$ 和 $d_{n+1}$ 与空间变量 $X$ 无关，它们可以移到积分号外：\n$$\nT_d(d_n, d_{n+1}) = \\frac{1}{2h^2} (d_{n+1}-d_n)^{\\top} \\left(\\int_{\\Omega_{0}} \\rho_{0} N^{\\top} N \\,dV\\right) (d_{n+1}-d_n)\n$$\n代入一致质量矩阵 $M$ 的定义，我们得到：\n$$\nT_d(d_n, d_{n+1}) = \\frac{1}{2h^2} (d_{n+1}-d_n)^{\\top} M (d_{n+1}-d_n)\n$$\n拉格朗日量的第二项是势能的负值，在中点位移 $\\frac{d_{n+1}+d_n}{2}$ 处求值。给定势能的二次型 $\\Psi(d) = \\frac{1}{2}d^{\\top}K d$，我们有：\n$$\n\\Psi\\left(\\frac{d_{n+1}+d_{n}}{2}\\right) = \\frac{1}{2} \\left(\\frac{d_{n+1}+d_{n}}{2}\\right)^{\\top} K \\left(\\frac{d_{n+1}+d_{n}}{2}\\right) = \\frac{1}{8} (d_{n+1}+d_n)^{\\top} K (d_{n+1}+d_n)\n$$\n综合这些结果，单个时间步长的全离散拉格朗日量为：\n$$\nL_d(d_n, d_{n+1}) = \\frac{1}{2h^2} (d_{n+1}-d_n)^{\\top} M (d_{n+1}-d_n) - \\frac{1}{8} (d_{n+1}+d_n)^{\\top} K (d_{n+1}+d_n)\n$$\n一个时间区间上的离散作用量和是 $S_d = \\sum_{n} L_d(d_n, d_{n+1})$。离散哈密顿原理要求作用量对路径的变分是驻定的，即 $\\delta S_d = 0$。考虑在任意内部时间步 $t_n$ 的变分 $\\delta d_n$（这意味着在时间区间的端点 $\\delta d_k = 0$），驻值条件产生离散欧拉-拉格朗日方程。节点位移向量 $d_n$ 出现在两个连续的拉格朗日项中：$L_d(d_{n-1}, d_n)$ 和 $L_d(d_n, d_{n+1})$。关于 $d_n$ 的驻值条件是：\n$$\n\\frac{\\partial}{\\partial d_n} \\left( L_d(d_{n-1}, d_n) + L_d(d_n, d_{n+1}) \\right) = 0\n$$\n这可以写成：\n$$\nD_2 L_d(d_{n-1}, d_n) + D_1 L_d(d_n, d_{n+1}) = 0\n$$\n其中 $D_1 L_d(x,y)$ 表示 $L_d(x,y)$ 关于其第一个自变量 $x$ 的偏导数（梯度），而 $D_2 L_d(x,y)$ 表示关于其第二个自变量 $y$ 的偏导数。\n\n我们计算这些导数。对于对称矩阵 $A$，使用矩阵微积分恒等式 $\\nabla_z (z^{\\top}A z) = 2Az$：\n对于 $L_d(x,y) = \\frac{1}{2h^2} (y-x)^{\\top} M (y-x) - \\frac{1}{8} (y+x)^{\\top} K (y+x)$：\n关于第一个自变量 $x$ 的梯度是：\n$$\nD_1 L_d(x,y) = \\frac{\\partial L_d}{\\partial x} = \\frac{1}{2h^2} \\left( -2M(y-x) \\right) - \\frac{1}{8} \\left( 2K(y+x) \\right) = -\\frac{1}{h^2}M(y-x) - \\frac{1}{4}K(y+x)\n$$\n关于第二个自变量 $y$ 的梯度是：\n$$\nD_2 L_d(x,y) = \\frac{\\partial L_d}{\\partial y} = \\frac{1}{2h^2} \\left( 2M(y-x) \\right) - \\frac{1}{8} \\left( 2K(y+x) \\right) = \\frac{1}{h^2}M(y-x) - \\frac{1}{4}K(y+x)\n$$\n现在我们将它们代入我们的离散欧拉-拉格朗日方程：\n$$\nD_1 L_d(d_n, d_{n+1}) = -\\frac{1}{h^2}M(d_{n+1}-d_n) - \\frac{1}{4}K(d_{n+1}+d_n)\n$$\n$$\nD_2 L_d(d_{n-1}, d_n) = \\frac{1}{h^2}M(d_n-d_{n-1}) - \\frac{1}{4}K(d_n+d_{n-1})\n$$\n将这些代入驻值条件：\n$$\n\\left( \\frac{1}{h^2}M(d_n-d_{n-1}) - \\frac{1}{4}K(d_n+d_{n-1}) \\right) + \\left( -\\frac{1}{h^2}M(d_{n+1}-d_n) - \\frac{1}{4}K(d_{n+1}+d_n) \\right) = 0\n$$\n为了简化并求解 $d_{n+1}$，我们可以将整个方程乘以 $h^2$：\n$$\nM(d_n-d_{n-1}) - \\frac{h^2}{4}K(d_n+d_{n-1}) - M(d_{n+1}-d_n) - \\frac{h^2}{4}K(d_{n+1}+d_n) = 0\n$$\n现在，我们按位移向量 $d_{n+1}$、$d_n$ 和 $d_{n-1}$ 对各项进行分组：\n$$\n\\left(-M - \\frac{h^2}{4}K\\right)d_{n+1} + \\left(M - \\frac{h^2}{4}K + M - \\frac{h^2}{4}K\\right)d_n + \\left(-M - \\frac{h^2}{4}K\\right)d_{n-1} = 0\n$$\n$$\n-\\left(M + \\frac{h^2}{4}K\\right)d_{n+1} + \\left(2M - \\frac{h^2}{2}K\\right)d_n - \\left(M + \\frac{h^2}{4}K\\right)d_{n-1} = 0\n$$\n分离出含 $d_{n+1}$ 的项：\n$$\n\\left(M + \\frac{h^2}{4}K\\right)d_{n+1} = \\left(2M - \\frac{h^2}{2}K\\right)d_n - \\left(M + \\frac{h^2}{4}K\\right)d_{n-1}\n$$\n题目说明待求逆的矩阵是非奇异的。这个矩阵是 $\\left(M + \\frac{h^2}{4}K\\right)$。由于 $M$ 是对称正定（对于非退化网格）而 $K$ 是对称半正定，它们的和是对称正定且因此可逆。因此我们可以左乘其逆矩阵来求解 $d_{n+1}$：\n$$\nd_{n+1} = \\left(M + \\frac{h^2}{4}K\\right)^{-1} \\left[ \\left(2M - \\frac{h^2}{2}K\\right)d_n - \\left(M + \\frac{h^2}{4}K\\right)d_{n-1} \\right]\n$$\n这就是节点位移向量的全离散更新映射。",
            "answer": "$$\n\\boxed{\\left(M + \\frac{h^{2}}{4}K\\right)^{-1} \\left[ \\left(2M - \\frac{h^{2}}{2}K\\right)d_{n} - \\left(M + \\frac{h^{2}}{4}K\\right)d_{n-1} \\right]}\n$$"
        },
        {
            "introduction": "哈密顿原理的应用远不止于推导运动方程，它也是分析系统稳定性的有力工具。本练习将带您进入一个更高级的主题：利用作用量的二阶变分来研究材料不稳定性。您将分析一个预压缩超弹性杆中的小扰动，并推导出其动力学稳定性的判据，该判据最终归结于声学张量的正定性 。通过确定椭圆性丧失的临界压缩率，您将深刻理解宏观材料失稳与微观波传播速度之间的内在联系。",
            "id": "3569602",
            "problem": "考虑一个无限、均匀的超弹性固体，其被理想化为一根沿着材料坐标 $X$ 的一维杆，参考质量密度为 $\\rho_{0}>0$。该杆由 Saint Venant–Kirchhoff 单位参考体积超弹性势能\n$$\nW(E) = \\frac{E_{Y}}{2}\\,E^{2},\n$$\n建模，其中 $E_{Y}>0$ 是一个常数材料模量，$E$ 是通过变形梯度 $F=\\partial x/\\partial X$ 定义的 Green–Lagrange 应变：\n$$\nE = \\frac{1}{2}\\left(F^{2}-1\\right).\n$$\n假设该杆处于一个有限压缩的均匀状态，其恒定拉伸为 $F=\\lambda\\in(0,1)$。\n\n使用动力学的哈密顿原理，考虑叠加在压缩状态上的小振幅、纵向、平面波微扰 $u(X,t)$。推导作用量在此类微扰下的二阶变分，并说明其正定性如何简化为对与压缩状态相关的标量声学模量的要求。明确地用 $\\lambda$ 和 $E_{Y}$ 表示该标量声学模量，并确定椭圆性丧失时的精确临界压缩拉伸 $\\lambda_{c}\\in(0,1)$，即声学模量首次为零时的拉伸。以单一精确表达式给出 $\\lambda_{c}$ 的最终答案。最终答案无需四舍五入，也无需单位。",
            "solution": "本题要求基于哈密顿原理和对作用量二阶变分的分析，推导一根处于有限压缩状态下的一维超弹性杆椭圆性丧失的条件。\n\n哈密顿原理指出，对于在两个时间点 $t_1$ 和 $t_2$ 之间的物理运动，作用量积分 $\\mathcal{A}$ 的变分为零。作用量定义为拉格朗日量 $\\mathcal{L}$ 的时间积分，而拉格朗日量是总动能 $\\mathcal{T}$ 和总势能 $\\mathcal{V}$ 之间的差值。\n$$\n\\mathcal{A} = \\int_{t_1}^{t_2} \\mathcal{L} \\, dt = \\int_{t_1}^{t_2} (\\mathcal{T} - \\mathcal{V}) \\, dt\n$$\n对于具有材料坐标 $X$ 的一维连续体，总动能和总势能由在参考域上的积分给出：\n$$\n\\mathcal{T} = \\int_{-\\infty}^{\\infty} \\frac{1}{2} \\rho_0 \\dot{x}^2 \\, dX\n$$\n$$\n\\mathcal{V} = \\int_{-\\infty}^{\\infty} W(E) \\, dX\n$$\n其中，$\\rho_0$ 是参考质量密度，$x(X,t)$ 是材料点 $X$ 在时间 $t$ 的位置，$\\dot{x} = \\partial x / \\partial t$ 是材料速度，$W(E)$ 是单位参考体积的应变能密度，$E$ 是 Green–Lagrange 应变。拉格朗日密度 $\\mathcal{L}_{d}$ 为 $\\frac{1}{2} \\rho_0 \\dot{x}^2 - W(E)$。\n\n该运动被描述为一个叠加在静态、均匀、预压缩状态 $x_0(X) = \\lambda X$ 上的小振幅微扰 $u(X,t)$，其中 $\\lambda \\in (0,1)$ 是恒定拉伸。\n总变形为：\n$$\nx(X,t) = x_0(X) + u(X,t) = \\lambda X + u(X,t)\n$$\n我们用微扰 $u(X,t)$ 来表示运动学量：\n速度为 $\\dot{x} = \\frac{\\partial}{\\partial t}(\\lambda X + u) = \\dot{u}$。\n变形梯度为 $F = \\frac{\\partial x}{\\partial X} = \\frac{\\partial}{\\partial X}(\\lambda X + u) = \\lambda + u_{,X}$。\n\nGreen–Lagrange 应变 $E = \\frac{1}{2}(F^2 - 1)$ 变为：\n$$\nE = \\frac{1}{2}((\\lambda + u_{,X})^2 - 1) = \\frac{1}{2}(\\lambda^2 + 2\\lambda u_{,X} + u_{,X}^2 - 1)\n$$\n令 $E_0 = \\frac{1}{2}(\\lambda^2 - 1)$ 为预压缩状态下的恒定应变。该应变可以写为：\n$$\nE = E_0 + \\lambda u_{,X} + \\frac{1}{2} u_{,X}^2\n$$\n拉格朗日密度是 $\\dot{u}$ 和 $u_{,X}$ 的函数：\n$$\n\\mathcal{L}_{d} = \\frac{1}{2} \\rho_0 \\dot{u}^2 - W\\left(E_0 + \\lambda u_{,X} + \\frac{1}{2} u_{,X}^2\\right)\n$$\n为了求作用量的二阶变分，我们将拉格朗日密度在平衡态（$u=0, \\dot{u}=0, u_{,X}=0$）附近进行泰勒级数展开，并保留微扰场及其导数的二阶项。\n应变能密度 $W(E)$ 在 $E_0$ 附近展开：\n$$\nW(E) \\approx W(E_0) + \\left.\\frac{dW}{dE}\\right|_{E_0}(E - E_0) + \\frac{1}{2}\\left.\\frac{d^2W}{dE^2}\\right|_{E_0}(E - E_0)^2\n$$\n代入 $E - E_0 = \\lambda u_{,X} + \\frac{1}{2} u_{,X}^2$：\n$$\nW(E) \\approx W(E_0) + \\left.\\frac{dW}{dE}\\right|_{E_0}\\left(\\lambda u_{,X} + \\frac{1}{2} u_{,X}^2\\right) + \\frac{1}{2}\\left.\\frac{d^2W}{dE^2}\\right|_{E_0}\\left(\\lambda u_{,X}\\right)^2\n$$\n我们只保留 $u$ 及其导数的二次项。拉格朗日密度变为：\n$$\n\\mathcal{L}_{d} \\approx \\frac{1}{2} \\rho_0 \\dot{u}^2 - \\left[ W(E_0) + \\lambda\\left.\\frac{dW}{dE}\\right|_{E_0} u_{,X} + \\frac{1}{2}\\left(\\left.\\frac{dW}{dE}\\right|_{E_0} + \\lambda^2\\left.\\frac{d^2W}{dE^2}\\right|_{E_0}\\right) u_{,X}^2 \\right]\n$$\n作用量的二阶变分 $\\delta^2 \\mathcal{A}$ 由拉格朗日密度的二次部分 $\\mathcal{L}_2$ 的积分给出：\n$$\n\\delta^2 \\mathcal{A} = \\int_{t_1}^{t_2} \\int_{-\\infty}^{\\infty} \\mathcal{L}_2 \\, dX \\, dt\n$$\n其中\n$$\n\\mathcal{L}_2 = \\frac{1}{2} \\rho_0 \\dot{u}^2 - \\frac{1}{2}\\left(\\left.\\frac{dW}{dE}\\right|_{E_0} + \\lambda^2\\left.\\frac{d^2W}{dE^2}\\right|_{E_0}\\right) u_{,X}^2\n$$\n为了使预压缩状态是动态稳定的，对于任何容许的非零微扰 $u(X,t)$，作用量的二阶变分必须为正。动能项 $\\frac{1}{2}\\rho_0 \\dot{u}^2$ 是非负的。稳定性要求 $\\delta^2 \\mathcal{A}$ 的势能部分是正定的。这意味着 $\\mathcal{L}_2$ 的势能部分中 $u_{,X}^2$ 的系数必须为正。这个系数被定义为标量声学模量 $\\mathcal{C}$。\n$$\n\\mathcal{C} = \\left.\\frac{dW}{dE}\\right|_{E_0} + \\lambda^2\\left.\\frac{d^2W}{dE^2}\\right|_{E_0}\n$$\n二阶变分的正定性，也就是压缩状态的稳定性，要求 $\\mathcal{C} > 0$。当该模量首次为零时，发生椭圆性丧失。\n\n现在，我们为给定的 Saint Venant–Kirchhoff 材料模型计算 $\\mathcal{C}$：\n$$\nW(E) = \\frac{E_Y}{2} E^2\n$$\n$W$ 对 $E$ 的一阶和二阶导数是：\n$$\n\\frac{dW}{dE} = E_Y E\n$$\n$$\n\\frac{d^2W}{dE^2} = E_Y\n$$\n我们在预应变状态 $E_0 = \\frac{1}{2}(\\lambda^2-1)$ 下计算这些导数：\n$$\n\\left.\\frac{dW}{dE}\\right|_{E_0} = E_Y E_0 = E_Y \\frac{1}{2}(\\lambda^2-1)\n$$\n$$\n\\left.\\frac{d^2W}{dE^2}\\right|_{E_0} = E_Y\n$$\n将这些表达式代入声学模量 $\\mathcal{C}$ 的公式中：\n$$\n\\mathcal{C} = E_Y \\frac{1}{2}(\\lambda^2-1) + \\lambda^2 E_Y = \\frac{E_Y}{2} (\\lambda^2-1 + 2\\lambda^2)\n$$\n标量声学模量的显式表达式为：\n$$\n\\mathcal{C} = \\frac{E_Y}{2} (3\\lambda^2 - 1)\n$$\n当声学模量为零时，即 $\\mathcal{C} = 0$ 时，椭圆性丧失。这定义了临界压缩拉伸 $\\lambda_c$。由于 $E_Y > 0$，我们必须有：\n$$\n3\\lambda_c^2 - 1 = 0\n$$\n求解 $\\lambda_c$：\n$$\n\\lambda_c^2 = \\frac{1}{3}\n$$\n由于拉伸 $\\lambda$ 定义在区间 $(0,1)$ 内，我们取正根：\n$$\n\\lambda_c = \\sqrt{\\frac{1}{3}} = \\frac{1}{\\sqrt{3}}\n$$\n该值位于指定范围内，因为 $\\frac{1}{\\sqrt{3}} \\approx 0.577$。在这个临界拉伸下，材料失去了支持增量纵波的能力，这标志着材料不稳定性的开始。\n最终答案是 $\\lambda_c$ 的精确值。",
            "answer": "$$\n\\boxed{\\frac{1}{\\sqrt{3}}}\n$$"
        }
    ]
}