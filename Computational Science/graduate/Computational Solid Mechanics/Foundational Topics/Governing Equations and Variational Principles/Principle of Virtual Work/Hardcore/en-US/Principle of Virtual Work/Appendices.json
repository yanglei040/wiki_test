{
    "hands_on_practices": [
        {
            "introduction": "The journey from a continuous physical principle to a computable algebraic system is a cornerstone of computational mechanics. This first practice guides you through this fundamental translation, starting with the Principle of Virtual Work for a nonlinear elastic material. By applying the Finite Element Method, you will discretize the weak form of equilibrium to derive the residual equation for a single element, which represents the discrete statement of force balance. ",
            "id": "3561387",
            "problem": "A prismatic soil column of length $L$ and constant cross-sectional area $A$ is modeled as a one-dimensional, small-strain hyperelastic body with stored-energy density $W(\\epsilon)$, where the axial strain is $\\epsilon = \\frac{du}{dx}$ and the Cauchy stress is $\\sigma(\\epsilon) = \\frac{\\partial W(\\epsilon)}{\\partial \\epsilon}$. The column is subjected to a uniform body force $b_0$ in the axial direction, with a displacement essential boundary condition $u(0)=0$ and a traction-free natural boundary at $x=L$. Starting from the principle of virtual work, derive the weak form for equilibrium and then construct the finite-dimensional residual for a single two-node isoparametric linear element that spans the entire column. The stored-energy density is\n$$\nW(\\epsilon) = \\mu\\,\\epsilon^{2} + \\alpha\\,\\epsilon^{4}, \\quad \\mu>0,\\ \\alpha>0,\n$$\nand the Cauchy stress is defined by $\\sigma(\\epsilon)=\\frac{\\partial W(\\epsilon)}{\\partial \\epsilon}$. Use the Finite Element Method (FEM) with the standard linear shape functions on the reference interval $\\xi\\in[-1,1]$, $N_1(\\xi) = \\frac{1-\\xi}{2}$ and $N_2(\\xi) = \\frac{1+\\xi}{2}$, and a two-point Gauss–Legendre quadrature for numerical integration. Clearly identify the infinite-dimensional function spaces for the trial and test functions and the quadrature components needed to evaluate the residual. Reduce the discrete residual to the single equation associated with the free degree of freedom at $x=L$. Express your final answer as a single closed-form analytic expression for the scalar residual $R(u_2)$ in terms of $u_2$, $L$, $A$, $\\mu$, $\\alpha$, and $b_0$. No numerical evaluation is required, and no rounding is necessary. Write your final answer as one analytic expression only.",
            "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, and objective.\n\n### Step 1: Extract Givens\n- **Domain:** One-dimensional column of length $L$ and constant cross-sectional area $A$. The domain is $x \\in [0, L]$.\n- **Constitutive Model:** Hyperelastic material with stored-energy density $W(\\epsilon) = \\mu\\,\\epsilon^{2} + \\alpha\\,\\epsilon^{4}$, where $\\mu>0$ and $\\alpha>0$.\n- **Stress-Strain Relation:** Cauchy stress $\\sigma(\\epsilon) = \\frac{\\partial W(\\epsilon)}{\\partial \\epsilon}$.\n- **Kinematics:** Small strain, axial strain $\\epsilon = \\frac{du}{dx}$.\n- **Loading:** Uniform axial body force $b_0$.\n- **Boundary Conditions:**\n  - Essential (Dirichlet) at $x=0$: $u(0)=0$.\n  - Natural (Neumann) at $x=L$: Traction-free, implying the applied traction is zero.\n- **Discretization:** A single two-node isoparametric linear finite element spanning the entire domain $[0, L]$.\n- **Shape Functions:** On the reference interval $\\xi \\in [-1, 1]$, the linear shape functions are $N_1(\\xi) = \\frac{1-\\xi}{2}$ and $N_2(\\xi) = \\frac{1+\\xi}{2}$.\n- **Numerical Integration:** Two-point Gauss-Legendre quadrature.\n- **Objective:** Derive the scalar residual $R(u_2)$ for the free degree of freedom $u_2$ at $x=L$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is a standard exercise in nonlinear finite element analysis applied to continuum mechanics.\n- **Scientifically Grounded:** The formulation is based on the principle of virtual work, hyperelasticity, and the finite element method, all of which are fundamental concepts in computational mechanics. The chosen stored-energy function is a simple but valid polynomial form for describing nonlinear elasticity.\n- **Well-Posed:** The problem provides a complete set of information (geometry, material law, loading, boundary conditions, and discretization method) required to derive the requested algebraic expression for the residual. The boundary conditions are standard for a cantilevered bar under self-weight, leading to a well-posed problem.\n- **Objective:** The problem statement is written in precise, unambiguous technical language. All terms are standard within the field.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. The solution process will now proceed.\n\n### Derivation of the Solution\n\nThe equilibrium of the body is governed by the Principle of Virtual Work (PVW), which states that the internal virtual work equals the external virtual work for any kinematically admissible virtual displacement.\n\nThe weak form of the equilibrium equation is derived from the PVW. For a one-dimensional body, it is stated as: find a displacement field $u$ belonging to the space of trial functions $\\mathcal{S}$ such that for all virtual displacements $\\delta u$ from the space of test functions $\\mathcal{V}$, the following equation holds:\n$$\n\\int_{0}^{L} \\delta\\epsilon \\, \\sigma(\\epsilon) \\, A \\, dx = \\int_{0}^{L} \\delta u \\, b_0 \\, A \\, dx + [\\delta u \\, T]_{x=L}\n$$\nwhere $\\epsilon = \\frac{du}{dx}$ is the axial strain, $\\delta\\epsilon = \\frac{d(\\delta u)}{dx}$ is the virtual strain, and $T$ is the applied traction at the boundary.\n\nThe infinite-dimensional trial space $\\mathcal{S}$ and test space $\\mathcal{V}$ are defined based on the boundary conditions:\n- Trial space: $\\mathcal{S} = \\{ u \\in H^1(0, L) \\mid u(0)=0 \\}$\n- Test space: $\\mathcal{V} = \\{ \\delta u \\in H^1(0, L) \\mid \\delta u(0)=0 \\}$\nHere, $H^1(0, L)$ is the Sobolev space of functions on $(0,L)$ with square-integrable values and first derivatives.\n\nThe problem states a traction-free natural boundary at $x=L$, which means the applied traction $T$ is zero. The weak form thus simplifies to:\n$$\n\\int_{0}^{L} \\sigma(\\epsilon) \\frac{d(\\delta u)}{dx} A \\, dx - \\int_{0}^{L} b_0 \\delta u A \\, dx = 0\n$$\n\nWe now discretize the domain using a single two-node finite element. Node 1 is at $x_1=0$ and node 2 is at $x_2=L$. The displacement field $u(x)$ is approximated as $u^h(x)$ in terms of the nodal displacements $u_1$ and $u_2$:\n$$\nu^h(x) = N_1(x) u_1 + N_2(x) u_2\n$$\nThe boundary condition $u(0)=0$ implies $u_1=0$. Therefore, the displacement field approximation is:\n$$\nu^h(x) = N_2(x) u_2\n$$\nThe virtual displacement is similarly approximated: $\\delta u^h(x) = N_2(x) \\delta u_2$.\n\nThe isoparametric mapping from the reference coordinate $\\xi \\in [-1, 1]$ to the physical coordinate $x \\in [0, L]$ is given by:\n$$\nx(\\xi) = N_1(\\xi)x_1 + N_2(\\xi)x_2 = \\frac{1-\\xi}{2}(0) + \\frac{1+\\xi}{2}(L) = \\frac{L(1+\\xi)}{2}\n$$\nThe Jacobian of this transformation is $J = \\frac{dx}{d\\xi} = \\frac{L}{2}$. The inverse is $\\frac{d\\xi}{dx} = \\frac{1}{J} = \\frac{2}{L}$.\n\nThe strain $\\epsilon$ is approximated as $\\epsilon^h = \\frac{du^h}{dx}$. Using the chain rule:\n$$\n\\epsilon^h = \\frac{du^h}{d\\xi} \\frac{d\\xi}{dx} = \\left( \\frac{dN_2}{d\\xi} u_2 \\right) \\frac{1}{J} = \\left( \\frac{1}{2} u_2 \\right) \\frac{2}{L} = \\frac{u_2}{L}\n$$\nNotably, the strain is constant throughout the element. The virtual strain is $\\delta\\epsilon^h = \\frac{\\delta u_2}{L}$.\n\nThe Cauchy stress $\\sigma$ is given by $\\sigma(\\epsilon) = \\frac{\\partial W}{\\partial \\epsilon} = 2\\mu\\epsilon + 4\\alpha\\epsilon^3$. Substituting the expression for $\\epsilon^h$:\n$$\n\\sigma(\\epsilon^h) = 2\\mu\\left(\\frac{u_2}{L}\\right) + 4\\alpha\\left(\\frac{u_2}{L}\\right)^3\n$$\nThe stress is also constant throughout the element.\n\nSubstituting the discrete approximations into the weak form:\n$$\n\\int_{0}^{L} \\left( 2\\mu\\frac{u_2}{L} + 4\\alpha\\frac{u_2^3}{L^3} \\right) \\left( \\frac{\\delta u_2}{L} \\right) A \\, dx - \\int_{0}^{L} b_0 (N_2(x) \\delta u_2) A \\, dx = 0\n$$\nSince $\\delta u_2$ is an arbitrary scalar representing the virtual displacement at the free node, we can factor it out. The remaining expression defines the scalar residual $R(u_2)$ for the free degree of freedom $u_2$:\n$$\nR(u_2) = \\int_{0}^{L} \\frac{A}{L} \\left( 2\\mu\\frac{u_2}{L} + 4\\alpha\\frac{u_2^3}{L^3} \\right) dx - \\int_{0}^{L} b_0 N_2(x) A \\, dx\n$$\nThe first integral's integrand is constant with respect to $x$:\n$$\n\\int_{0}^{L} \\frac{A}{L} \\left( 2\\mu\\frac{u_2}{L} + 4\\alpha\\frac{u_2^3}{L^3} \\right) dx = \\frac{A}{L} \\left( 2\\mu\\frac{u_2}{L} + 4\\alpha\\frac{u_2^3}{L^3} \\right) \\int_{0}^{L} dx = A \\left( 2\\mu\\frac{u_2}{L} + 4\\alpha\\frac{u_2^3}{L^3} \\right)\n$$\nThis is the internal force component.\n\nThe second integral corresponds to the external force. We evaluate it using the specified two-point Gauss-Legendre quadrature. The quadrature points on $\\xi \\in [-1, 1]$ are $\\xi_1 = -\\frac{1}{\\sqrt{3}}$ and $\\xi_2 = \\frac{1}{\\sqrt{3}}$, and the weights are $w_1 = w_2 = 1$.\n$$\n\\int_{0}^{L} b_0 N_2(x) A \\, dx = \\int_{-1}^{1} b_0 N_2(\\xi) A J \\, d\\xi \\approx \\sum_{i=1}^{2} w_i \\left[ b_0 N_2(\\xi_i) A J \\right]\n$$\nWith $A$, $b_0$, and $J=\\frac{L}{2}$ being constants:\n$$\nb_0 A \\frac{L}{2} \\sum_{i=1}^{2} w_i N_2(\\xi_i) = b_0 A \\frac{L}{2} \\left[ (1) \\frac{1+\\xi_1}{2} + (1) \\frac{1+\\xi_2}{2} \\right]\n$$\n$$\n= b_0 A \\frac{L}{2} \\left[ \\frac{1 - 1/\\sqrt{3}}{2} + \\frac{1 + 1/\\sqrt{3}}{2} \\right] = b_0 A \\frac{L}{2} \\left( \\frac{2}{2} \\right) = \\frac{A b_0 L}{2}\n$$\nSince the integrand $N_2(\\xi)$ is a degree-1 polynomial, the two-point Gauss quadrature is exact.\n\nCombining the internal and external force terms, the residual $R(u_2)$ is:\n$$\nR(u_2) = A \\left( 2\\mu\\frac{u_2}{L} + 4\\alpha\\frac{u_2^3}{L^3} \\right) - \\frac{A b_0 L}{2}\n$$\nThis can be rewritten as:\n$$\nR(u_2) = \\frac{2A\\mu u_2}{L} + \\frac{4A\\alpha u_2^3}{L^3} - \\frac{A b_0 L}{2}\n$$\nThis is the final closed-form expression for the scalar residual associated with the free degree of freedom $u_2$.",
            "answer": "$$\n\\boxed{\\frac{2A\\mu u_2}{L} + \\frac{4A\\alpha u_2^3}{L^3} - \\frac{A b_0 L}{2}}\n$$"
        },
        {
            "introduction": "Solving the nonlinear equations of equilibrium typically requires an iterative method, such as the Newton-Raphson algorithm, which depends on a consistent linearization of the system. This practice builds upon the concept of the residual by showing how to derive the consistent tangent stiffness matrix from the internal virtual work. This matrix captures the instantaneous stiffness of the material and is essential for achieving the rapid, quadratic convergence characteristic of Newton's method. ",
            "id": "3591302",
            "problem": "Consider a single two-node isoparametric bar finite element of undeformed length $L$ and constant cross-sectional area $A$, aligned with the $x$-axis and undergoing small strains. The axial displacement field is approximated by the standard linear shape functions $N_{1}(x)=1-\\frac{x}{L}$ and $N_{2}(x)=\\frac{x}{L}$ as $u_{h}(x)=N_{1}(x)\\,u_{1}+N_{2}(x)\\,u_{2}$, where $u_{1}$ and $u_{2}$ are the nodal axial displacements. The material is a one-dimensional hyperelastic solid with Helmholtz free energy density $\\psi(\\varepsilon)=\\frac{1}{2}\\,E\\,\\varepsilon^{2}+\\frac{\\alpha}{4}\\,\\varepsilon^{4}$, where $\\varepsilon$ is the small axial strain, $E>0$ is the linear elastic modulus, and $\\alpha \\ge 0$ is a material nonlinearity parameter.\n\nUsing only the principle of virtual work (PVW) and definitions stemming from the free energy, formulate the element internal virtual work and deduce the element internal force vector. Then, by performing a consistent linearization with respect to the nodal displacement vector $\\mathbf{u}_{e}=[u_{1}\\;\\;u_{2}]^{T}$, derive the consistent tangent stiffness matrix for this element in terms of $A$, $L$, $E$, $\\alpha$, $u_{1}$, and $u_{2}$. Assume isothermal conditions, neglect body forces and tractions, and work within the small-strain, one-dimensional framework.\n\nExpress your final answer as a single closed-form $2\\times 2$ matrix function of $u_{1}$ and $u_{2}$, without units. Do not simplify by introducing intermediate constants. No numerical evaluation is required.",
            "solution": "The problem is valid as it is scientifically grounded in the principles of continuum mechanics and the finite element method, is well-posed with sufficient information, and is stated objectively.\n\nThe derivation of the consistent tangent stiffness matrix for the specified one-dimensional hyperelastic bar element proceeds in four steps: establishing the kinematic relations, defining the constitutive law from the given free energy, formulating the internal force vector via the Principle of Virtual Work (PVW), and finally, linearizing the internal force vector.\n\n**Step 1: Kinematics**\n\nThe axial displacement field $u_{h}(x)$ within the element is interpolated from the nodal displacements $u_{1}$ and $u_{2}$ using the linear shape functions $N_{1}(x) = 1 - \\frac{x}{L}$ and $N_{2}(x) = \\frac{x}{L}$.\nIn matrix form, this is $u_{h}(x) = \\mathbf{N}(x)\\mathbf{u}_{e}$, where $\\mathbf{N}(x) = \\begin{pmatrix} N_{1}(x) & N_{2}(x) \\end{pmatrix}$ and $\\mathbf{u}_{e} = \\begin{pmatrix} u_{1} \\\\ u_{2} \\end{pmatrix}$.\n\nWithin the small-strain framework, the axial strain $\\varepsilon$ is the spatial derivative of the displacement field:\n$$\n\\varepsilon(x) = \\frac{d u_{h}}{dx} = \\frac{d\\mathbf{N}}{dx}\\mathbf{u}_{e}\n$$\nThe derivative of the shape function matrix is the strain-displacement matrix, $\\mathbf{B}$:\n$$\n\\mathbf{B}(x) = \\frac{d\\mathbf{N}}{dx} = \\begin{pmatrix} \\frac{dN_{1}}{dx} & \\frac{dN_{2}}{dx} \\end{pmatrix} = \\begin{pmatrix} -\\frac{1}{L} & \\frac{1}{L} \\end{pmatrix}\n$$\nSince $\\mathbf{B}$ is constant, the strain $\\varepsilon$ is uniform throughout the element:\n$$\n\\varepsilon = \\mathbf{B}\\mathbf{u}_{e} = \\begin{pmatrix} -\\frac{1}{L} & \\frac{1}{L} \\end{pmatrix} \\begin{pmatrix} u_{1} \\\\ u_{2} \\end{pmatrix} = \\frac{u_{2} - u_{1}}{L}\n$$\n\n**Step 2: Constitutive Law**\n\nThe material is hyperelastic, and its behavior is governed by the Helmholtz free energy density $\\psi(\\varepsilon)$. For an isothermal process, the axial stress $\\sigma$ is thermodynamically conjugate to the axial strain $\\varepsilon$ and is obtained by differentiating $\\psi$ with respect to $\\varepsilon$:\n$$\n\\sigma = \\frac{\\partial\\psi}{\\partial\\varepsilon}\n$$\nGiven the free energy density $\\psi(\\varepsilon) = \\frac{1}{2}\\,E\\,\\varepsilon^{2}+\\frac{\\alpha}{4}\\,\\varepsilon^{4}$, the stress is:\n$$\n\\sigma = \\frac{\\partial}{\\partial\\varepsilon} \\left( \\frac{1}{2}\\,E\\,\\varepsilon^{2}+\\frac{\\alpha}{4}\\,\\varepsilon^{4} \\right) = E\\,\\varepsilon + \\alpha\\,\\varepsilon^{3}\n$$\nThis is a nonlinear stress-strain relationship.\n\n**Step 3: Internal Force Vector**\n\nThe Principle of Virtual Work (PVW) states that the internal virtual work, $\\delta W_{int}$, is equal to the external virtual work, $\\delta W_{ext}$. For an element in equilibrium, we consider the internal part. The internal virtual work is the integral of the stress acting over the virtual strain, $\\delta\\varepsilon$, throughout the element volume $V$.\n$$\n\\delta W_{int} = \\int_{V} \\sigma \\, \\delta\\varepsilon \\, dV\n$$\nIn one dimension, $dV = A\\,dx$, where $A$ is the cross-sectional area. The virtual strain is given by $\\delta\\varepsilon = \\mathbf{B}\\,\\delta\\mathbf{u}_{e}$. Substituting this into the expression for $\\delta W_{int}$:\n$$\n\\delta W_{int} = \\int_{0}^{L} \\sigma \\, (\\mathbf{B}\\,\\delta\\mathbf{u}_{e}) \\, A \\, dx\n$$\nSince the virtual nodal displacements $\\delta\\mathbf{u}_{e}$ are arbitrary and not functions of $x$, we can write this as:\n$$\n\\delta W_{int} = \\delta\\mathbf{u}_{e}^{T} \\left( \\int_{0}^{L} \\mathbf{B}^{T} \\, \\sigma \\, A \\, dx \\right)\n$$\nBy definition, the expression in the parenthesis is the element internal force vector, $\\mathbf{f}_{int}$:\n$$\n\\mathbf{f}_{int} = \\int_{0}^{L} \\mathbf{B}^{T} \\, \\sigma \\, A \\, dx\n$$\nSince $\\mathbf{B}$, $\\sigma$ (because $\\varepsilon$ is uniform), and $A$ are all constant over the length of the element, the integral simplifies:\n$$\n\\mathbf{f}_{int} = A \\, L \\, \\mathbf{B}^{T} \\, \\sigma\n$$\nSubstituting the expressions for $\\mathbf{B}$ and $\\sigma$:\n$$\n\\mathbf{f}_{int} = A \\, L \\, \\begin{pmatrix} -\\frac{1}{L} \\\\ \\frac{1}{L} \\end{pmatrix} (E\\,\\varepsilon + \\alpha\\,\\varepsilon^{3}) = A \\, \\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix} (E\\,\\varepsilon + \\alpha\\,\\varepsilon^{3})\n$$\nFinally, substituting $\\varepsilon = \\frac{u_{2} - u_{1}}{L}$:\n$$\n\\mathbf{f}_{int} = A \\, \\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix} \\left( E\\frac{u_{2} - u_{1}}{L} + \\alpha\\left(\\frac{u_{2} - u_{1}}{L}\\right)^{3} \\right)\n$$\n\n**Step 4: Consistent Tangent Stiffness Matrix**\n\nThe consistent tangent stiffness matrix, $\\mathbf{K}_{T}$, is obtained by the linearization of the internal force vector $\\mathbf{f}_{int}$ with respect to the nodal displacement vector $\\mathbf{u}_{e}$. This corresponds to taking the Jacobian of $\\mathbf{f}_{int}$:\n$$\n\\mathbf{K}_{T} = \\frac{\\partial \\mathbf{f}_{int}}{\\partial \\mathbf{u}_{e}} = \\begin{pmatrix} \\frac{\\partial (f_{int})_{1}}{\\partial u_{1}} & \\frac{\\partial (f_{int})_{1}}{\\partial u_{2}} \\\\ \\frac{\\partial (f_{int})_{2}}{\\partial u_{1}} & \\frac{\\partial (f_{int})_{2}}{\\partial u_{2}} \\end{pmatrix}\n$$\nLet's compute the components. The components of $\\mathbf{f}_{int}$ are:\n$$\n(f_{int})_{1} = -A \\left( \\frac{E}{L}(u_{2} - u_{1}) + \\frac{\\alpha}{L^{3}}(u_{2} - u_{1})^{3} \\right)\n$$\n$$\n(f_{int})_{2} = +A \\left( \\frac{E}{L}(u_{2} - u_{1}) + \\frac{\\alpha}{L^{3}}(u_{2} - u_{1})^{3} \\right)\n$$\nTaking the partial derivatives:\n$$\nK_{T,11} = \\frac{\\partial (f_{int})_{1}}{\\partial u_{1}} = -A \\left( \\frac{E}{L}(-1) + \\frac{\\alpha}{L^{3}} \\cdot 3(u_{2} - u_{1})^{2}(-1) \\right) = \\frac{AE}{L} + \\frac{3A\\alpha}{L^{3}}(u_{2} - u_{1})^{2}\n$$\n$$\nK_{T,12} = \\frac{\\partial (f_{int})_{1}}{\\partial u_{2}} = -A \\left( \\frac{E}{L}(1) + \\frac{\\alpha}{L^{3}} \\cdot 3(u_{2} - u_{1})^{2}(1) \\right) = -\\frac{AE}{L} - \\frac{3A\\alpha}{L^{3}}(u_{2} - u_{1})^{2}\n$$\n$$\nK_{T,21} = \\frac{\\partial (f_{int})_{2}}{\\partial u_{1}} = A \\left( \\frac{E}{L}(-1) + \\frac{\\alpha}{L^{3}} \\cdot 3(u_{2} - u_{1})^{2}(-1) \\right) = -\\frac{AE}{L} - \\frac{3A\\alpha}{L^{3}}(u_{2} - u_{1})^{2}\n$$\n$$\nK_{T,22} = \\frac{\\partial (f_{int})_{2}}{\\partial u_{2}} = A \\left( \\frac{E}{L}(1) + \\frac{\\alpha}{L^{3}} \\cdot 3(u_{2} - u_{1})^{2}(1) \\right) = \\frac{AE}{L} + \\frac{3A\\alpha}{L^{3}}(u_{2} - u_{1})^{2}\n$$\nAssembling these components into the matrix gives the final expression for the consistent tangent stiffness matrix:\n$$\n\\mathbf{K}_{T} = \\begin{pmatrix} \\frac{AE}{L} + \\frac{3A\\alpha(u_{2} - u_{1})^{2}}{L^{3}} & -\\frac{AE}{L} - \\frac{3A\\alpha(u_{2} - u_{1})^{2}}{L^{3}} \\\\ -\\frac{AE}{L} - \\frac{3A\\alpha(u_{2} - u_{1})^{2}}{L^{3}} & \\frac{AE}{L} + \\frac{3A\\alpha(u_{2} - u_{1})^{2}}{L^{3}} \\end{pmatrix}\n$$\nThis matrix is symmetric, as expected. If the nonlinear material parameter $\\alpha = 0$, the matrix correctly reduces to the standard linear stiffness matrix for a bar element.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{AE}{L} + \\frac{3A\\alpha(u_{2} - u_{1})^{2}}{L^{3}} & -\\frac{AE}{L} - \\frac{3A\\alpha(u_{2} - u_{1})^{2}}{L^{3}} \\\\\n-\\frac{AE}{L} - \\frac{3A\\alpha(u_{2} - u_{1})^{2}}{L^{3}} & \\frac{AE}{L} + \\frac{3A\\alpha(u_{2} - u_{1})^{2}}{L^{3}}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "While the tangent stiffness arising from hyperelastic material response is symmetric, the overall system tangent can become asymmetric due to external loads. This exercise explores such a case by examining a non-conservative 'follower force,' whose direction changes with the deformation of the structure. Starting from the external virtual work term, you will derive the force's contribution to the tangent matrix and demonstrate its inherent asymmetry, a critical feature in the analysis of structural stability and flutter. ",
            "id": "3591290",
            "problem": "Consider a planar, two-node, straight bar element used within the Finite Element Method (FEM). The bar’s initial configuration has node $1$ located at $(0,0)$ and node $2$ located at $(L,0)$, where $L>0$ is the undeformed length. Node $1$ is fixed. Node $2$ undergoes translational displacements $(u_x,u_y)$ in the $x$- and $y$-directions, respectively. A non-conservative follower force of constant magnitude $P>0$ is applied at node $2$, always acting along the current unit normal to the bar’s axis in the deformed configuration. The bar is hyperelastic with symmetric internal tangent contributions, but you should focus on the external follower force contribution to the tangent.\n\nUsing the Principle of Virtual Work (PVW), begin from the fundamental weak statement that the total virtual work vanishes at equilibrium, namely $\\delta W_{\\text{int}} - \\delta W_{\\text{ext}} = 0$, where $\\delta W_{\\text{int}}$ is the internal virtual work and $\\delta W_{\\text{ext}}$ is the external virtual work due to the follower load. Treat the internal virtual work as producing a symmetric tangent contribution and consider only the external follower load contribution to demonstrate asymmetry.\n\nLet the current vector from node $1$ to node $2$ be $\\mathbf{r} = (x,y)$ with $x=L+u_x$ and $y=u_y$, and let its length be $R=\\sqrt{x^2+y^2}$. Define the current unit tangent along the bar as $\\mathbf{t} = \\mathbf{r}/R$, and the corresponding unit normal as $\\mathbf{n} = (-t_y, t_x) = \\left(-\\dfrac{y}{R}, \\dfrac{x}{R}\\right)$. The external nodal force at node $2$ due to the follower load is then $\\mathbf{f}_{\\text{ext}} = P\\,\\mathbf{n}$.\n\nForm the discrete external virtual work $\\delta W_{\\text{ext}} = \\mathbf{f}_{\\text{ext}} \\cdot \\delta \\mathbf{u}_2$ and, by consistent linearization with respect to $(u_x,u_y)$, obtain the external contribution to the $2\\times 2$ tangent matrix $\\mathbf{K}_{\\text{ext}} = \\dfrac{\\partial \\mathbf{f}_{\\text{ext}}}{\\partial \\mathbf{u}_2}$. Compute the off-diagonal difference $k_{12} - k_{21}$ of $\\mathbf{K}_{\\text{ext}}$ as a closed-form analytic expression in terms of $P$, $L$, $u_x$, and $u_y$.\n\nYour final answer must be a single closed-form analytic expression. The requested quantity $k_{12}-k_{21}$ has units of $\\mathrm{N/m}$; ensure your expression is dimensionally consistent with force per length. No rounding is required.",
            "solution": "The user wants me to solve a problem in computational solid mechanics.\n\n### Step 1: Extract Givens\n- A planar, two-node, straight bar element.\n- Initial configuration: Node $1$ at $(0,0)$, Node $2$ at $(L,0)$ with $L>0$.\n- Boundary condition: Node $1$ is fixed.\n- Nodal variables: Node $2$ has displacements $(u_x, u_y)$.\n- Applied load: A non-conservative follower force of constant magnitude $P>0$ is applied at node $2$.\n- Force direction: The force acts along the current unit normal to the bar's axis, $\\mathbf{n}$.\n- Principle of Virtual Work (PVW): $\\delta W_{\\text{int}} - \\delta W_{\\text{ext}} = 0$ at equilibrium.\n- Current position vector of node $2$: $\\mathbf{r} = (x,y)$, where $x=L+u_x$ and $y=u_y$.\n- Current length of the bar: $R = \\sqrt{x^2+y^2}$.\n- Current unit tangent vector: $\\mathbf{t} = \\mathbf{r}/R$.\n- Current unit normal vector: $\\mathbf{n} = (-t_y, t_x) = \\left(-\\dfrac{y}{R}, \\dfrac{x}{R}\\right)$.\n- External nodal force vector at node $2$: $\\mathbf{f}_{\\text{ext}} = P\\,\\mathbf{n}$.\n- Displacement vector at node $2$: $\\mathbf{u}_2 = (u_x, u_y)$.\n- External virtual work: $\\delta W_{\\text{ext}} = \\mathbf{f}_{\\text{ext}} \\cdot \\delta \\mathbf{u}_2$.\n- External contribution to the tangent matrix: $\\mathbf{K}_{\\text{ext}} = \\dfrac{\\partial \\mathbf{f}_{\\text{ext}}}{\\partial \\mathbf{u}_2}$.\n- Required quantity: The off-diagonal difference $k_{12} - k_{21}$ of $\\mathbf{K}_{\\text{ext}}$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is validated against the specified criteria:\n- **Scientifically Grounded**: The problem describes a classical setup in nonlinear continuum mechanics and finite element analysis. Follower forces are a well-understood source of non-conservative loading, leading to asymmetric tangent stiffness matrices. The Principle of Virtual Work is the fundamental basis for this analysis. The problem is scientifically sound.\n- **Well-Posed**: The problem provides all necessary definitions and equations to derive the requested quantity. The objective is clear and a unique analytical solution exists.\n- **Objective**: The problem is stated using precise mathematical and engineering terminology. There are no subjective or ambiguous statements.\n\nThe problem does not violate any of the invalidity criteria. It is a standard, formalizable problem in computational mechanics.\n\n### Step 3: Verdict and Action\nThe problem is valid. I will proceed with the solution.\n\n### Derivation of the Solution\nThe objective is to compute the off-diagonal difference $k_{12} - k_{21}$ of the external tangent matrix $\\mathbf{K}_{\\text{ext}}$. This matrix is defined as the Jacobian of the external force vector $\\mathbf{f}_{\\text{ext}}$ with respect to the nodal displacement vector $\\mathbf{u}_2$.\n\nThe displacement vector at node $2$ is $\\mathbf{u}_2 = \\begin{pmatrix} u_x \\\\ u_y \\end{pmatrix}$.\nThe current position of node $2$ is given by the vector $\\mathbf{r} = \\begin{pmatrix} x \\\\ y \\end{pmatrix} = \\begin{pmatrix} L+u_x \\\\ u_y \\end{pmatrix}$.\nThe current length of the bar is $R = \\|\\mathbf{r}\\| = \\sqrt{x^2+y^2} = \\sqrt{(L+u_x)^2 + u_y^2}$.\n\nThe external follower force vector $\\mathbf{f}_{\\text{ext}}$ is applied at node $2$ and is given by $\\mathbf{f}_{\\text{ext}} = P\\,\\mathbf{n}$. The unit normal vector $\\mathbf{n}$ is defined as $\\mathbf{n} = \\begin{pmatrix} -y/R \\\\ x/R \\end{pmatrix}$.\nSubstituting the expressions for $x$, $y$, and $R$, we write the force vector $\\mathbf{f}_{\\text{ext}}$ in terms of the displacements $u_x$ and $u_y$:\n$$\n\\mathbf{f}_{\\text{ext}} = \\begin{pmatrix} f_1 \\\\ f_2 \\end{pmatrix} = P \\begin{pmatrix} -u_y / \\sqrt{(L+u_x)^2 + u_y^2} \\\\ (L+u_x) / \\sqrt{(L+u_x)^2 + u_y^2} \\end{pmatrix} = \\frac{P}{R} \\begin{pmatrix} -y \\\\ x \\end{pmatrix}\n$$\n\nThe external tangent matrix $\\mathbf{K}_{\\text{ext}}$ is a $2 \\times 2$ matrix defined by:\n$$\n\\mathbf{K}_{\\text{ext}} = \\frac{\\partial \\mathbf{f}_{\\text{ext}}}{\\partial \\mathbf{u}_2} = \\begin{pmatrix} \\frac{\\partial f_1}{\\partial u_x} & \\frac{\\partial f_1}{\\partial u_y} \\\\ \\frac{\\partial f_2}{\\partial u_x} & \\frac{\\partial f_2}{\\partial u_y} \\end{pmatrix} = \\begin{pmatrix} k_{11} & k_{12} \\\\ k_{21} & k_{22} \\end{pmatrix}\n$$\nTo compute the components of $\\mathbf{K}_{\\text{ext}}$, we need the partial derivatives of $R$ with respect to $u_x$ and $u_y$:\n$$\n\\frac{\\partial R}{\\partial u_x} = \\frac{\\partial}{\\partial u_x} \\left( (L+u_x)^2 + u_y^2 \\right)^{1/2} = \\frac{1}{2R} \\cdot 2(L+u_x) = \\frac{L+u_x}{R} = \\frac{x}{R}\n$$\n$$\n\\frac{\\partial R}{\\partial u_y} = \\frac{\\partial}{\\partial u_y} \\left( (L+u_x)^2 + u_y^2 \\right)^{1/2} = \\frac{1}{2R} \\cdot 2u_y = \\frac{u_y}{R} = \\frac{y}{R}\n$$\n\nNow we can compute the off-diagonal components $k_{12}$ and $k_{21}$.\n\nComponent $k_{12} = \\frac{\\partial f_1}{\\partial u_y}$:\n$$\nf_1 = -P \\frac{u_y}{R} = -P \\frac{y}{R}\n$$\nUsing the quotient rule for differentiation:\n$$\nk_{12} = \\frac{\\partial}{\\partial u_y} \\left( -P \\frac{y}{R} \\right) = -P \\left( \\frac{(\\frac{\\partial y}{\\partial u_y})R - y(\\frac{\\partial R}{\\partial u_y})}{R^2} \\right)\n$$\nSince $y=u_y$, we have $\\frac{\\partial y}{\\partial u_y} = 1$. Substituting this and $\\frac{\\partial R}{\\partial u_y} = \\frac{y}{R}$:\n$$\nk_{12} = -P \\left( \\frac{1 \\cdot R - y \\cdot \\frac{y}{R}}{R^2} \\right) = -P \\left( \\frac{R - \\frac{y^2}{R}}{R^2} \\right) = -P \\left( \\frac{R^2 - y^2}{R^3} \\right)\n$$\nSince $R^2 = x^2 + y^2$, we have $R^2 - y^2 = x^2$.\n$$\nk_{12} = -P \\frac{x^2}{R^3} = -P \\frac{(L+u_x)^2}{\\left( (L+u_x)^2 + u_y^2 \\right)^{3/2}}\n$$\n\nComponent $k_{21} = \\frac{\\partial f_2}{\\partial u_x}$:\n$$\nf_2 = P \\frac{L+u_x}{R} = P \\frac{x}{R}\n$$\nUsing the quotient rule:\n$$\nk_{21} = \\frac{\\partial}{\\partial u_x} \\left( P \\frac{x}{R} \\right) = P \\left( \\frac{(\\frac{\\partial x}{\\partial u_x})R - x(\\frac{\\partial R}{\\partial u_x})}{R^2} \\right)\n$$\nSince $x=L+u_x$, we have $\\frac{\\partial x}{\\partial u_x} = 1$. Substituting this and $\\frac{\\partial R}{\\partial u_x} = \\frac{x}{R}$:\n$$\nk_{21} = P \\left( \\frac{1 \\cdot R - x \\cdot \\frac{x}{R}}{R^2} \\right) = P \\left( \\frac{R - \\frac{x^2}{R}}{R^2} \\right) = P \\left( \\frac{R^2 - x^2}{R^3} \\right)\n$$\nSince $R^2 = x^2 + y^2$, we have $R^2 - x^2 = y^2$.\n$$\nk_{21} = P \\frac{y^2}{R^3} = P \\frac{u_y^2}{\\left( (L+u_x)^2 + u_y^2 \\right)^{3/2}}\n$$\n\nFinally, we compute the difference $k_{12} - k_{21}$:\n$$\nk_{12} - k_{21} = \\left( -P \\frac{x^2}{R^3} \\right) - \\left( P \\frac{y^2}{R^3} \\right) = -P \\frac{x^2 + y^2}{R^3}\n$$\nSubstituting $x^2 + y^2 = R^2$:\n$$\nk_{12} - k_{21} = -P \\frac{R^2}{R^3} = -\\frac{P}{R}\n$$\nExpressing this result in terms of the problem's specified variables $P$, $L$, $u_x$, and $u_y$:\n$$\nk_{12} - k_{21} = -\\frac{P}{\\sqrt{(L+u_x)^2 + u_y^2}}\n$$\nThis result is non-zero (since $P>0$), demonstrating that the external tangent matrix $\\mathbf{K}_{\\text{ext}}$ is asymmetric, which is a key characteristic of non-conservative follower forces.\n\nA dimensional check confirms consistency. The force $P$ has units of force [F]. The length $R$ (and variables $L$, $u_x$, $u_y$) has units of length [L]. The quantity $k_{12} - k_{21}$ has units of stiffness, [F/L], which is consistent with the units of N/m. The expression is dimensionally correct.",
            "answer": "$$\n\\boxed{-\\frac{P}{\\sqrt{(L+u_x)^2 + u_y^2}}}\n$$"
        }
    ]
}