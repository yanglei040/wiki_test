{
    "hands_on_practices": [
        {
            "introduction": "在计算固体力学中，我们通常需要将材料的工程常数（如杨氏模量和泊松比）转化为完整的刚度矩阵，以便在有限元等数值方法中使用。这个练习将指导你完成这一基本但至关重要的过程，从给定的正交各向异性工程常数出发，构建柔度矩阵 $S$ 和刚度矩阵 $C$。此外，本练习还强调了检验刚度矩阵正定性的重要性，这是确保材料模型在物理上稳定和数值上表现良好的关键步骤。",
            "id": "3580525",
            "problem": "给定一个处于小应变状态下的三维线弹性正交各向异性固体。在 Voigt 记法中，本构关系为 $\\,\\boldsymbol{\\sigma} = \\mathbf{C}\\,\\boldsymbol{\\varepsilon}\\,$，其中 $\\,\\mathbf{C}\\,$ 是对称的 $\\,6\\times 6\\,$ 刚度矩阵，柔度矩阵 $\\,\\mathbf{S}\\,$ 满足 $\\,\\mathbf{S} = \\mathbf{C}^{-1}\\,$。某一点的正交各向异性材料由九个工程常数表征：三个杨氏模量 $\\,E_1,E_2,E_3\\,$，三个泊松比 $\\,\\nu_{12},\\nu_{23},\\nu_{31}\\,$（其中倒数泊松比受限于 $\\,\\nu_{21} = \\nu_{12}\\,E_2/E_1\\,$, $\\,\\nu_{32} = \\nu_{23}\\,E_3/E_2\\,$, $\\,\\nu_{13} = \\nu_{31}\\,E_1/E_3\\,$ 以确保柔度矩阵的对称性），以及三个剪切模量 $\\,G_{12},G_{23},G_{31}\\,$。在标准工程剪切应变约定下，柔度矩阵 $\\,\\mathbf{S}\\,$ 在 Voigt 排序 $\\,\\{11,22,33,23,13,12\\}\\,$ 下具有与正交各向异性一致的块对角结构，并且必须由给定的工程常数组装而成。仅使用基本线弹性原理和矩阵理论，为每个测试用例执行以下操作：\n\n1. 从提供的工程常数中组装 $\\,\\mathbf{S}\\,$，确保强制执行互易关系 $\\,\\nu_{ji} = \\nu_{ij} E_j / E_i\\,$ 以使 $\\,\\mathbf{S}\\,$ 对称。\n2. 通过数值求逆显式计算刚度矩阵 $\\,\\mathbf{C} = \\mathbf{S}^{-1}\\,$。\n3. 使用 $\\,10^{-10}\\,$ 的绝对数值公差检查 $\\,\\mathbf{S}\\,$ 和 $\\,\\mathbf{C}\\,$ 的对称性。\n4. 通过验证对称化矩阵 $\\,(\\mathbf{C}+\\mathbf{C}^\\mathsf{T})/2\\,$ 的所有特征值严格大于 $\\,10^{-9}\\,$ 吉帕斯卡 (GPa) 的正定性公差，来检查 $\\,\\mathbf{C}\\,$ 的正定性。\n5. 报告 $\\,\\mathbf{C}\\,$ 的最小特征值（单位为 GPa），四舍五入到 $\\,6\\,$ 位小数。\n\n所有类刚度量 $\\,E_i\\,$ 和 $\\,G_{ij}\\,$ 均以吉帕斯卡 (GPa) 为单位，泊松比是无量纲的，柔度矩阵的元素单位为反吉帕斯卡 (GPa$^{-1}$)，刚度矩阵的元素单位为吉帕斯卡 (GPa)。不涉及角度。每个测试用例的输出必须是一个列表 $[\\text{is\\_S\\_symmetric}, \\text{is\\_C\\_symmetric}, \\text{is\\_C\\_positive\\_definite}, \\text{min\\_eig\\_C\\_GPa}]$，其中布尔值表示对称性和正定性检查的结果，最后一个条目是 $\\,\\mathbf{C}\\,$ 的最小特征值（单位 GPa），四舍五入。\n\n测试套件（有 $\\,3\\,$ 个不同的用例）：\n\n- 用例 $\\,1\\,$（高度正交各向异性，类似纤维增强材料）：\n  - $\\,E_1 = 150.0\\,$ GPa, $\\,E_2 = 10.0\\,$ GPa, $\\,E_3 = 10.0\\,$ GPa\n  - $\\,\\nu_{12} = 0.25\\,$, $\\,\\nu_{23} = 0.30\\,$, $\\,\\nu_{31} = 0.02\\,$\n  - $\\,G_{12} = 5.5\\,$ GPa, $\\,G_{23} = 3.8\\,$ GPa, $\\,G_{31} = 5.2\\,$ GPa\n\n- 用例 $\\,2\\,$（准各向同性基准）：\n  - $\\,E_1 = E_2 = E_3 = 210.0\\,$ GPa\n  - $\\,\\nu_{12} = \\nu_{23} = \\nu_{31} = 0.30\\,$\n  - $\\,G_{12} = G_{23} = G_{31} = \\dfrac{210.0}{2(1+0.30)}\\,$ GPa\n\n- 用例 $\\,3\\,$（类似近不可压缩材料）：\n  - $\\,E_1 = E_2 = E_3 = 3.5\\,$ GPa\n  - $\\,\\nu_{12} = \\nu_{23} = \\nu_{31} = 0.49\\,$\n  - $\\,G_{12} = G_{23} = G_{31} = \\dfrac{3.5}{2(1+0.49)}\\,$ GPa\n\n您的程序必须为每个用例计算 $\\,\\mathbf{S}\\,$ 和 $\\,\\mathbf{C}\\,$ 矩阵，执行检查，并生成一行输出，其中包含一个由 $\\,3\\,$ 个子列表（每个用例一个）组成的列表，格式完全如下：\n$[ [b_{11},b_{12},b_{13},f_1], [b_{21},b_{22},b_{23},f_2], [b_{31},b_{32},b_{33},f_3] ]$\n其中 $\\,b_{ij}\\,$ 是布尔值，$\\,f_i\\,$ 是浮点数（单位 GPa），四舍五入到 $\\,6\\,$ 位小数。除了这一行输出之外，不得打印任何其他文本。",
            "solution": "我们从线弹性关系 $\\,\\boldsymbol{\\sigma} = \\mathbf{C}\\,\\boldsymbol{\\varepsilon}\\,$ 及其逆关系 $\\,\\boldsymbol{\\varepsilon} = \\mathbf{S}\\,\\boldsymbol{\\sigma}\\,$ 开始，其中 $\\,\\mathbf{S} = \\mathbf{C}^{-1}\\,$。对于一个在 Voigt 记法 $\\,\\{11,22,33,23,13,12\\}\\,$ 下遵循工程剪切应变约定的正交各向异性材料，其柔度矩阵 $\\,\\mathbf{S}\\,$ 在法向分量和剪切分量之间是块对角化的。剪切柔度由剪切模量的倒数直接给出，即 $\\,S_{44}=1/G_{23}\\,$, $\\,S_{55}=1/G_{31}\\,$, $\\,S_{66}=1/G_{12}\\,$，由于正交各向异性，所有其他非对角的剪切项均为零。\n\n对于法向 $\\,3\\times 3\\,$ 块，为确保柔度矩阵 $\\,\\mathbf{S}\\,$ 的对称性，我们必须利用互易关系。问题中给出的输入为三个独立的泊松比 $\\,\\nu_{12},\\nu_{23},\\nu_{31}\\,$。其他泊松比则通过关系 $\\,\\nu_{ji} = \\nu_{ij} E_j / E_i\\,$ 计算得出，例如 $\\,\\nu_{13} = \\nu_{31} E_1 / E_3\\,$。由此，法向部分的元素定义为：$S_{11}=1/E_1\\,$, $S_{22}=1/E_2\\,$, $S_{33}=1/E_3\\,$, $S_{12} = S_{21} = -\\nu_{12}/E_1\\,$ (等价于 $-\\nu_{21}/E_2$), $S_{13} = S_{31} = -\\nu_{31}/E_3\\,$ (等价于 $-\\nu_{13}/E_1$), $S_{23} = S_{32} = -\\nu_{23}/E_2\\,$ (等价于 $-\\nu_{32}/E_3$)。这些是将工程常数与柔度联系起来的标准公式。然后，通过将法向 $\\,3\\times 3\\,$ 块放置在左上角，并将剪切柔度放置在对角线位置 $\\,44\\,$, $\\,55\\,$ 和 $\\,66\\,$ 来组装完整的 $\\,6\\times 6\\,$ 柔度矩阵 $\\,\\mathbf{S}\\,$。\n\n构建 $\\,\\mathbf{S}\\,$ 后，刚度矩阵 $\\,\\mathbf{C}\\,$ 可通过 $\\,\\mathbf{C} = \\mathbf{S}^{-1}\\,$ 得出，这可以通过标准矩阵求逆进行数值计算。根据物理原理，得到的 $\\,\\mathbf{C}\\,$ 应该是对称的；在数值上，我们使用与各自转置矩阵之差的无穷范数和绝对公差 $\\,10^{-10}\\,$ 来测试 $\\,\\mathbf{S}\\,$ 和 $\\,\\mathbf{C}\\,$ 的对称性。\n\n为了保证物理稳定性，在线弹性理论中，刚度矩阵 $\\,\\mathbf{C}\\,$ 必须是正定的，这意味着其所有特征值都严格为正。在数值上，我们使用适用于埃尔米特矩阵的算法来评估对称化矩阵 $\\,(\\mathbf{C} + \\mathbf{C}^\\mathsf{T})/2\\,$ 的特征值，并验证最小特征值超过一个小的正定性公差 $\\,10^{-9}\\,$ 吉帕斯卡，以考虑舍入误差。这将为每个测试用例生成一个布尔值 $\\,\\text{is\\_C\\_positive\\_definite}\\,$。此外，我们还会报告最小特征值本身，单位为吉帕斯卡，四舍五入到 $\\,6\\,$ 位小数。\n\n所有给定的 $\\,E_i\\,$ 和 $\\,G_{ij}\\,$ 都以吉帕斯卡 (GPa) 为单位，因此计算出的柔度矩阵元素单位为反吉帕斯卡 (GPa$^{-1}$)，而刚度矩阵元素单位为吉帕斯卡 (GPa)。泊松比是无量纲的。由于在这种正交各向异性形式下，$\\,\\mathbf{S}\\,$ 的剪切分量是块对角化的，且 $\\,G_{ij}\\,$ 严格为正，稳定性检查主要取决于法向块的性质，但在数值上，我们评估整个 $\\,6\\times 6\\,$ 矩阵，以考虑求逆后可能产生的耦合效应（尽管在本例中不会发生）。\n\n应用于每个用例的算法如下：\n- 输入 $\\,E_1,E_2,E_3,\\nu_{12},\\nu_{23},\\nu_{31},G_{12},G_{23},G_{31}\\,$。\n- 通过放置以下元素组装 $\\,\\mathbf{S}\\,$：\n  - $\\,S_{11}=1/E_1\\,$, $\\,S_{22}=1/E_2\\,$, $\\,S_{33}=1/E_3\\,$\n  - $\\,S_{12}=S_{21}=-\\nu_{12}/E_1\\,$\n  - $\\,S_{13}=S_{31}=-\\nu_{31}/E_3\\,$\n  - $\\,S_{23}=S_{32}=-\\nu_{23}/E_2\\,$\n  - $\\,S_{44}=1/G_{23}\\,$, $\\,S_{55}=1/G_{31}\\,$, $\\,S_{66}=1/G_{12}\\,$\n  以及其他位置为零。\n- 计算 $\\,\\mathbf{C} = \\mathbf{S}^{-1}\\,$ 并将 $\\,\\mathbf{C}\\,$ 对称化为 $\\,\\mathbf{C}_\\text{sym} = (\\mathbf{C}+\\mathbf{C}^\\mathsf{T})/2\\,$ 以进行特征分析。\n- 检查 $\\,\\|\\mathbf{S}-\\mathbf{S}^\\mathsf{T}\\|_\\infty \\le 10^{-10}\\,$ 和 $\\,\\|\\mathbf{C}-\\mathbf{C}^\\mathsf{T}\\|_\\infty \\le 10^{-10}\\,$ 以设置对称性布尔值。\n- 计算 $\\,\\mathbf{C}_\\text{sym}\\,$ 的特征值，如果最小特征值 $\\,> 10^{-9}\\,$，则设置正定性布尔值，并记录该最小特征值，四舍五入到 $\\,6\\,$ 位小数。\n\n测试套件包含问题陈述中指定的 $\\,3\\,$ 个用例。对于准各向同性用例，剪切模量根据给定的 $\\,E\\,$ 和 $\\,\\nu\\,$ 通过 $\\,G = E/[2(1+\\nu)]\\,$ 进行一致设置，以确保内部一致性。最终程序输出一行，其中包含 $\\,3\\,$ 个用例的列表 $\\,\\big[\\,[\\text{is\\_S\\_symmetric}, \\text{is\\_C\\_symmetric}, \\text{is\\_C\\_positive\\_definite}, \\text{min\\_eig\\_C\\_GPa}], \\ldots\\big]\\,$，其中最小特征值以吉帕斯卡为单位，并按要求四舍五入到 $\\,6\\,$ 位小数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef assemble_compliance(E1, E2, E3, nu12, nu23, nu31, G12, G23, G31):\n    \"\"\"\n    Assemble the 6x6 orthotropic compliance matrix S (Voigt order 11,22,33,23,13,12)\n    using engineering shear strains. Units: E and G in GPa, S in 1/GPa.\n    \"\"\"\n    S = np.zeros((6, 6), dtype=float)\n\n    # Normal block (3x3)\n    S[0, 0] = 1.0 / E1\n    S[1, 1] = 1.0 / E2\n    S[2, 2] = 1.0 / E3\n\n    # Enforce symmetry using reciprocal relations\n    # S_12 = -nu12/E1 = -nu21/E2\n    S[0, 1] = S[1, 0] = -nu12 / E1\n    # S_13 = -nu13/E1 = -nu31/E3. nu31 is given.\n    nu13 = nu31 * E1 / E3\n    S[0, 2] = S[2, 0] = -nu13 / E1 # or equivalently -nu31/E3\n    # S_23 = -nu23/E2 = -nu32/E3\n    S[1, 2] = S[2, 1] = -nu23 / E2\n\n    # Shear compliances (engineering shear)\n    S[3, 3] = 1.0 / G23\n    S[4, 4] = 1.0 / G31\n    S[5, 5] = 1.0 / G12\n\n    return S\n\ndef is_symmetric(M, atol=1e-10):\n    return np.allclose(M, M.T, atol=atol, rtol=0.0)\n\ndef stiffness_from_compliance(S):\n    # Invert compliance to get stiffness\n    return np.linalg.inv(S)\n\ndef min_eigenvalue_and_pd(C, pd_tol=1e-9):\n    # Symmetrize to avoid numerical asymmetry effects\n    Csym = 0.5 * (C + C.T)\n    # Use eigvalsh for symmetric/Hermitian matrices\n    evals = np.linalg.eigvalsh(Csym)\n    lam_min = float(np.min(evals))\n    is_pd = lam_min > pd_tol\n    return lam_min, is_pd\n\ndef format_value(val):\n    \"\"\"Format booleans/floats/lists with commas and no spaces, recursively.\"\"\"\n    if isinstance(val, list):\n        return \"[\" + \",\".join(format_value(x) for x in val) + \"]\"\n    if isinstance(val, bool):\n        return \"True\" if val else \"False\"\n    if isinstance(val, float):\n        # Use default string conversion for float\n        return str(val)\n    if isinstance(val, (int, np.integer)):\n        return str(int(val))\n    # Fallback for numpy bool_\n    if hasattr(val, \"item\"):\n        return format_value(val.item())\n    return str(val)\n\ndef solve():\n    # Define the test cases from the problem statement (all moduli in GPa).\n    # Case 1: Highly orthotropic\n    case1 = {\n        \"E1\": 150.0, \"E2\": 10.0, \"E3\": 10.0,\n        \"nu12\": 0.25, \"nu23\": 0.30, \"nu31\": 0.02,\n        \"G12\": 5.5, \"G23\": 3.8, \"G31\": 5.2\n    }\n\n    # Case 2: Quasi-isotropic baseline\n    E_iso = 210.0\n    nu_iso = 0.30\n    G_iso = E_iso / (2.0 * (1.0 + nu_iso))\n    case2 = {\n        \"E1\": E_iso, \"E2\": E_iso, \"E3\": E_iso,\n        \"nu12\": nu_iso, \"nu23\": nu_iso, \"nu31\": nu_iso,\n        \"G12\": G_iso, \"G23\": G_iso, \"G31\": G_iso\n    }\n\n    # Case 3: Near-incompressible-like\n    E_nc = 3.5\n    nu_nc = 0.49\n    G_nc = E_nc / (2.0 * (1.0 + nu_nc))\n    case3 = {\n        \"E1\": E_nc, \"E2\": E_nc, \"E3\": E_nc,\n        \"nu12\": nu_nc, \"nu23\": nu_nc, \"nu31\": nu_nc,\n        \"G12\": G_nc, \"G23\": G_nc, \"G31\": G_nc\n    }\n\n    test_cases = [case1, case2, case3]\n\n    results = []\n    for params in test_cases:\n        S = assemble_compliance(**params)\n        C = stiffness_from_compliance(S)\n\n        S_sym = is_symmetric(S, atol=1e-10)\n        C_sym = is_symmetric(C, atol=1e-10)\n\n        lam_min, is_pd = min_eigenvalue_and_pd(C, pd_tol=1e-9)\n        # Round the minimal eigenvalue to 6 decimals as required\n        lam_min_rounded = round(lam_min, 6)\n\n        results.append([S_sym, C_sym, is_pd, lam_min_rounded])\n\n    # Final print statement in the exact required format: a single line with no extra spaces.\n    print(format_value(results))\n\nsolve()\n```"
        },
        {
            "introduction": "现实世界中的工程部件，其材料对称轴（例如复合材料中的纤维方向）通常与我们用于分析的全局坐标系不一致。因此，能够正确地变换刚度张量至关重要。本练习将通过邦德矩阵 (Bond matrix) 的推导和应用，指导你将在材料局部坐标系下定义的刚度矩阵 $C$ 变换到任意旋转后的全局坐标系中，并揭示由此产生的法向-剪切耦合效应。",
            "id": "3580567",
            "problem": "考虑一个均匀的线性弹性固体，其材料对称性相对于一个局部笛卡尔坐标系是正交各向异性的。设本构律在局部材料坐标系中由四阶弹性张量 $\\,\\mathbf{C}\\,$ 给出，使得 $\\,\\boldsymbol{\\sigma} = \\mathbf{C} : \\boldsymbol{\\varepsilon}\\,$，其中 $\\,\\boldsymbol{\\sigma}\\,$ 是柯西应力，$\\,\\boldsymbol{\\varepsilon}\\,$ 是无穷小应变。全局坐标系与正交各向异性主轴之间存在一个真正常交旋转 $\\,\\mathbf{Q}\\in \\mathrm{SO}(3)\\,$ 的错位。您必须使用 Bond 矩阵推导 Voigt 记法下的变换后刚度矩阵，并量化诱导的耦合项。\n\n您的推导必须从以下基本依据出发：\n- 小应变范围内的线弹性理论，其中 $\\,\\boldsymbol{\\sigma} = \\mathbf{C} : \\boldsymbol{\\varepsilon}\\,$。\n- 在旋转 $\\,\\mathbf{Q}\\,$ 下的四阶张量变换法则，由 $\\,\\mathbf{C}^{\\prime}_{pqrs} = Q_{pi} Q_{qj} Q_{rk} Q_{sl}\\, \\mathbf{C}_{ijkl}\\,$ 给出。\n- Voigt 记法与工程剪切应变的定义，其中应力 Voigt 向量为 $\\,\\mathbf{s} = [\\sigma_{11},\\sigma_{22},\\sigma_{33},\\sigma_{23},\\sigma_{13},\\sigma_{12}]^{\\mathsf{T}}\\,$，应变 Voigt 向量为 $\\,\\mathbf{e} = [\\varepsilon_{11},\\varepsilon_{22},\\varepsilon_{33},2\\varepsilon_{23},2\\varepsilon_{13},2\\varepsilon_{12}]^{\\mathsf{T}}\\,$。\n\n任务：\n1. 从第一性原理出发，构建在旋转 $\\,\\mathbf{Q}\\,$ 下分别变换 Voigt 应力和 Voigt 应变的 Bond 矩阵 $\\,\\mathbf{B}_{\\sigma}(\\mathbf{Q})\\,$ 和 $\\,\\mathbf{B}_{\\varepsilon}(\\mathbf{Q})\\,$，不使用封闭形式的快捷公式。利用 $\\,\\mathbf{Q}\\,$ 对对称二阶张量的作用以及使用工程剪切分量的 Voigt 映射定义，通过它们对 Voigt 基张量的影响逐列构建这些矩阵。\n2. 证明 Voigt 记法下的变换后刚度满足 $\\,\\mathbf{C}^{\\prime} = \\mathbf{B}_{\\sigma}(\\mathbf{Q})\\,\\mathbf{C}\\,\\mathbf{B}_{\\varepsilon}(\\mathbf{Q})^{-1}\\,$。\n3. 使用工程常数 $\\,E_{1},E_{2},E_{3},\\nu_{12},\\nu_{13},\\nu_{23},G_{12},G_{13},G_{23}\\,$ 在局部材料坐标系中构建正交各向异性柔度矩阵 $\\,\\mathbf{S}\\,$。通过设置 $\\,\\nu_{21} = \\nu_{12}\\,E_{2}/E_{1}\\,$, $\\,\\nu_{31} = \\nu_{13}\\,E_{3}/E_{1}\\,$ 和 $\\,\\nu_{32} = \\nu_{23}\\,E_{3}/E_{2}\\,$ 来强制主对称性，然后求得 $\\,\\mathbf{C} = \\mathbf{S}^{-1}\\,$。\n4. 将诱导耦合项定义为 $\\,\\mathbf{C}^{\\prime}\\,$ 的法向-剪切非对角块，即在 Voigt 索引中，所有满足 $\\,i\\in\\{1,2,3\\}\\,$ 和 $\\,j\\in\\{4,5,6\\}\\,$ 的项 $\\,C^{\\prime}_{ij}\\,$。通过上块各项的绝对值之和 $\\,\\sum_{i=1}^{3}\\sum_{j=4}^{6} \\left|C^{\\prime}_{ij}\\right|\\,$ 来量化总诱导耦合。\n\n物理单位和数值格式：\n- 所有模量 $\\,E_{k}\\,$ 和 $\\,G_{ij}\\,$ 必须以吉帕斯卡（GPa）为单位指定，您的输出也必须以吉帕斯卡（GPa）表示。\n- 所有用于定义旋转的角度必须以度为单位指定，并在内部转换为弧度。\n- 最终输出必须是实数（浮点数）。\n\n测试套件：\n用程序实现您的推导，并评估以下四个测试案例的总诱导耦合。对于每个案例，构建 $\\,\\mathbf{S}\\,$，求逆得到 $\\,\\mathbf{C}\\,$，从 $\\,\\mathbf{Q}\\,$ 构建 $\\,\\mathbf{B}_{\\sigma}\\,$ 和 $\\,\\mathbf{B}_{\\varepsilon}\\,$，形成 $\\,\\mathbf{C}^{\\prime}\\,$，并计算耦合和 $\\,\\sum_{i=1}^{3}\\sum_{j=4}^{6} \\left|C^{\\prime}_{ij}\\right|\\,$（单位 GPa，四舍五入到六位小数）。\n\n- 测试案例 1 （理想情况，对齐的正交各向异性）：$\\,E_{1}=150\\,\\mathrm{GPa}\\,$, $\\,E_{2}=12\\,\\mathrm{GPa}\\,$, $\\,E_{3}=12\\,\\mathrm{GPa}\\,$, $\\,\\nu_{12}=0.25\\,$, $\\,\\nu_{13}=0.20\\,$, $\\,\\nu_{23}=0.30\\,$, $\\,G_{12}=6\\,\\mathrm{GPa}\\,$, $\\,G_{13}=5\\,\\mathrm{GPa}\\,$, $\\,G_{23}=4\\,\\mathrm{GPa}\\,$，且 $\\,\\mathbf{Q}=\\mathbf{I}\\,$ 为单位旋转。预期行为：零耦合。\n- 测试案例 2 （平面错位）：与测试案例 1 具有相同的模量，$\\,\\mathbf{Q}\\,$ 是绕全局 $\\,3\\,$ 轴旋转 $\\,45^{\\circ}\\,$。\n- 测试案例 3 （各向同性极限，边界情况）：$\\,E_{1}=E_{2}=E_{3}=100\\,\\mathrm{GPa}\\,$, $\\,\\nu_{12}=\\nu_{13}=\\nu_{23}=0.25\\,$, $\\,G_{12}=G_{13}=G_{23}=E/(2(1+\\nu))=40\\,\\mathrm{GPa}\\,$，$\\,\\mathbf{Q}\\,$ 是绕轴 $\\,\\mathbf{a}=[1,1,1]^{\\mathsf{T}}/\\sqrt{3}\\,$ 旋转 $\\,40^{\\circ}\\,$。预期行为：零耦合（在数值容差范围内）。\n- 测试案例 4 （强各向异性，复合错位）：$\\,E_{1}=50\\,\\mathrm{GPa}\\,$, $\\,E_{2}=10\\,\\mathrm{GPa}\\,$, $\\,E_{3}=5\\,\\mathrm{GPa}\\,$, $\\,\\nu_{12}=0.25\\,$, $\\,\\nu_{13}=0.20\\,$, $\\,\\nu_{23}=0.30\\,$, $\\,G_{12}=8\\,\\mathrm{GPa}\\,$, $\\,G_{13}=6\\,\\mathrm{GPa}\\,$, $\\,G_{23}=4\\,\\mathrm{GPa}\\,$，$\\,\\mathbf{Q}\\,$ 是分别绕全局 $\\,1\\,$ 轴旋转 $\\,30^{\\circ}\\,$、绕全局 $\\,2\\,$ 轴旋转 $\\,20^{\\circ}\\,$、绕全局 $\\,3\\,$ 轴旋转 $\\,10^{\\circ}\\,$ 的复合旋转，并按此顺序应用。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含四个测试案例的结果，结果为 GPa 单位下四舍五入到六位小数的逗号分隔列表，并用方括号括起来。例如，$\\,\\left[\\text{result}_{1},\\text{result}_{2},\\text{result}_{3},\\text{result}_{4}\\right]\\,$。",
            "solution": "该问题要求推导并实现线性弹性正交各向异性材料在坐标系旋转下的刚度矩阵变换法则，并量化由此产生的法向-剪切耦合。本解答将遵循问题陈述中列出的四个任务来系统地展开。\n\n### 任务 1：构建 Bond 矩阵 $\\mathbf{B}_{\\sigma}(\\mathbf{Q})$ 和 $\\mathbf{B}_{\\varepsilon}(\\mathbf{Q})$\n\n对称二阶张量（如柯西应力 $\\boldsymbol{\\sigma}$）从局部材料坐标系到旋转后全局坐标系的变换由 $\\boldsymbol{\\sigma}' = \\mathbf{Q} \\boldsymbol{\\sigma} \\mathbf{Q}^{\\mathsf{T}}$ 给出，其中 $\\mathbf{Q} \\in \\mathrm{SO}(3)$ 是真正常交旋转矩阵。其分量形式为 $\\sigma'_{ij} = Q_{ik} Q_{jl} \\sigma_{kl}$（此处对重复指标求和）。\n\nVoigt 记法将对称二阶张量映射为 $6 \\times 1$ 向量。问题指定了以下映射关系：\n- 应力向量：$\\mathbf{s} = [\\sigma_{11}, \\sigma_{22}, \\sigma_{33}, \\sigma_{23}, \\sigma_{13}, \\sigma_{12}]^{\\mathsf{T}}$\n- 应变向量（工程剪切应变）：$\\mathbf{e} = [\\varepsilon_{11}, \\varepsilon_{22}, \\varepsilon_{33}, \\gamma_{23}, \\gamma_{13}, \\gamma_{12}]^{\\mathsf{T}} = [\\varepsilon_{11}, \\varepsilon_{22}, \\varepsilon_{33}, 2\\varepsilon_{23}, 2\\varepsilon_{13}, 2\\varepsilon_{12}]^{\\mathsf{T}}$\n\nBond 矩阵 $\\mathbf{B}_{\\sigma}(\\mathbf{Q})$ 和 $\\mathbf{B}_{\\varepsilon}(\\mathbf{Q})$ 是定义了 Voigt 向量变换规则的 $6 \\times 6$ 矩阵，即 $\\mathbf{s}' = \\mathbf{B}_{\\sigma} \\mathbf{s}$ 和 $\\mathbf{e}' = \\mathbf{B}_{\\varepsilon} \\mathbf{e}$。我们通过将变换后向量的分量与原始向量的分量关联起来，逐项构建这些矩阵。这个过程的关键在于处理工程剪切应变定义中引入的因子 2。\n\n以 $\\mathbf{B}_{\\sigma}$ 为例，其元素 $(B_{\\sigma})_{IJ}$ 是 $s'_I$ 展开式中 $s_J$ 的系数。通过展开 $\\sigma'_{ij} = Q_{ik} Q_{jl} \\sigma_{kl}$ 并将其与 Voigt 定义相匹配，可以推导出 $\\mathbf{B}_{\\sigma}$ 和 $\\mathbf{B}_{\\varepsilon}$ 的完整形式。由于定义不同，这两个矩阵是不同的。例如，对于正应变分量 $\\varepsilon'_{11}$ 和正应力分量 $\\sigma'_{11}$：\n$$\n\\sigma'_{11} = Q_{1k}Q_{1l}\\sigma_{kl} \\quad \\text{和} \\quad \\varepsilon'_{11} = Q_{1k}Q_{1l}\\varepsilon_{kl}\n$$\n展开后，$\\sigma'_{11}$ 是 $\\sigma_{kl}$ 的线性组合，$\\varepsilon'_{11}$ 是 $\\varepsilon_{kl}$ 的线性组合。当我们将 $\\varepsilon_{kl}$ 替换为 $\\gamma_{kl}/2$ (对于 $k \\neq l$) 时，变换矩阵的列会相应地缩放。最终，这两个矩阵满足关系 $\\mathbf{B}_{\\varepsilon} = \\mathbf{R} \\mathbf{B}_{\\sigma} \\mathbf{R}^{-1}$，其中 $\\mathbf{R} = \\mathrm{diag}(1,1,1,2,2,2)$ 是 Reuter 矩阵。\n\n### 任务 2：证明刚度变换法则\n\n我们从两个坐标系下的本构关系开始：\n- 局部坐标系: $\\mathbf{s} = \\mathbf{C} \\mathbf{e}$\n- 全局坐标系: $\\mathbf{s}' = \\mathbf{C}' \\mathbf{e}'$\n\n将 Bond 矩阵的定义代入全局本构关系中：\n$$\n\\mathbf{B}_{\\sigma} \\mathbf{s} = \\mathbf{C}' (\\mathbf{B}_{\\varepsilon} \\mathbf{e})\n$$\n现在，用局部本构关系替换 $\\mathbf{s}$：\n$$\n\\mathbf{B}_{\\sigma} (\\mathbf{C} \\mathbf{e}) = \\mathbf{C}' \\mathbf{B}_{\\varepsilon} \\mathbf{e}\n$$\n由于这个方程必须对任意应变向量 $\\mathbf{e}$ 都成立，我们可以消去 $\\mathbf{e}$，得到矩阵关系：\n$$\n\\mathbf{B}_{\\sigma} \\mathbf{C} = \\mathbf{C}' \\mathbf{B}_{\\varepsilon}\n$$\n最后，从右侧乘以 $\\mathbf{B}_{\\varepsilon}$ 的逆矩阵，我们得到 Voigt 记法下的刚度矩阵变换法则：\n$$\n\\mathbf{C}' = \\mathbf{B}_{\\sigma} \\mathbf{C} \\mathbf{B}_{\\varepsilon}^{-1}\n$$\n\n### 任务 3：构建局部刚度矩阵 $\\mathbf{C}$\n\n对于正交各向异性材料，首先根据给定的工程常数构建 $6 \\times 6$ 的柔度矩阵 $\\mathbf{S}$。其非零元素由标准公式给出，例如 $S_{11} = 1/E_1$, $S_{12} = -\\nu_{12}/E_1$, $S_{66} = 1/G_{12}$ 等。为确保 $\\mathbf{S}$ 的对称性（这是主要对称性的要求），必须强制执行互易关系，如 $\\nu_{ij}/E_i = \\nu_{ji}/E_j$。\n构建完对称的 $\\mathbf{S}$ 矩阵后，局部的刚度矩阵 $\\mathbf{C}$ 直接通过数值求逆得到：$\\mathbf{C} = \\mathbf{S}^{-1}$。\n\n### 任务 4：量化耦合\n\n在局部坐标系中，正交各向异性材料的刚度矩阵 $\\mathbf{C}$ 是块对角的，法向应力仅与法向应变相关，剪切应力仅与相应的剪切应变相关。然而，当旋转到全局坐标系后，变换后的刚度矩阵 $\\mathbf{C}'$ 通常不再是块对角的。具体来说，其右上 $3 \\times 3$ 子块（连接全局法向应力与全局剪切应变）和左下 $3 \\times 3$ 子块（连接全局剪切应力与全局法向应变）中的元素会变为非零。这些非零元素 $C'_{ij}$（其中 $i \\in \\{1,2,3\\}, j \\in \\{4,5,6\\}$ 或反之）代表了法向-剪切耦合效应。\n总诱导耦合程度可以通过问题中定义的范数来量化，即对法向-剪切块中所有元素的绝对值求和：$\\sum_{i=1}^{3}\\sum_{j=4}^{6} |C'_{ij}|$。\n\n对于各向同性材料，其刚度张量在任何旋转下都是不变的，因此无论坐标系如何旋转，$\\mathbf{C}'$ 始终保持与 $\\mathbf{C}$ 相同的形式，不会产生法向-剪切耦合。这为我们的计算提供了一个重要的验证基准。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the material rotation problem for the given test cases.\n    \"\"\"\n\n    def construct_ortho_compliance(E1, E2, E3, nu12, nu13, nu23, G12, G13, G23):\n        \"\"\"Constructs the 6x6 orthotropic compliance matrix S.\"\"\"\n        S = np.zeros((6, 6))\n        \n        # To ensure symmetry, nu_ij/E_i = nu_ji/E_j.\n        # Given inputs are nu12, nu13, nu23.\n        # S_12 = -nu12/E1, S_21 = -nu21/E2. So S_12=S_21 requires nu21=nu12*E2/E1\n        # S_13 = -nu13/E1, S_31 = -nu31/E3. So S_13=S_31 requires nu31=nu13*E3/E1\n        # S_23 = -nu23/E2, S_32 = -nu32/E3. So S_23=S_32 requires nu32=nu23*E3/E2\n        \n        S[0, 0] = 1 / E1\n        S[1, 1] = 1 / E2\n        S[2, 2] = 1 / E3\n\n        S[0, 1] = S[1, 0] = -nu12 / E1\n        S[0, 2] = S[2, 0] = -nu13 / E1\n        S[1, 2] = S[2, 1] = -nu23 / E2\n\n        S[3, 3] = 1 / G23\n        S[4, 4] = 1 / G13\n        S[5, 5] = 1 / G12\n        return S\n\n    def get_rotation_matrix_from_axis_angle(axis, angle_rad):\n        \"\"\"Creates a 3x3 rotation matrix using Rodrigues' formula.\"\"\"\n        axis = np.asarray(axis)\n        axis = axis / np.linalg.norm(axis)\n        K = np.array([[0, -axis[2], axis[1]],\n                      [axis[2], 0, -axis[0]],\n                      [-axis[1], axis[0], 0]])\n        R = np.eye(3) + np.sin(angle_rad) * K + (1 - np.cos(angle_rad)) * np.dot(K, K)\n        return R\n\n    def construct_bond_matrices(Q):\n        \"\"\"Constructs the Bond matrices B_sigma and B_epsilon from a rotation matrix Q.\"\"\"\n        B_sigma = np.zeros((6, 6))\n        B_epsilon = np.zeros((6, 6))\n        \n        # Voigt index to tensor (i, j) map (0-based)\n        # 1-based: 1->11, 2->22, 3->33, 4->23, 5->13, 6->12\n        voigt_map = [(0, 0), (1, 1), (2, 2), (1, 2), (0, 2), (0, 1)]\n\n        for I in range(6):\n            for J in range(6):\n                i, j = voigt_map[I]\n                k, l = voigt_map[J]\n\n                if I  3:  # Transformed component is a normal stress/strain\n                    if J  3:  # Original is normal\n                        B_sigma[I, J] = Q[i, k]**2\n                        B_epsilon[I, J] = Q[i, k]**2\n                    else:  # Original is shear\n                        B_sigma[I, J] = 2 * Q[i, k] * Q[i, l]\n                        B_epsilon[I, J] = Q[i, k] * Q[i, l]\n                else:  # Transformed component is a shear stress/strain\n                    if J  3:  # Original is normal\n                        B_sigma[I, J] = Q[i, k] * Q[j, k]\n                        B_epsilon[I, J] = 2 * Q[i, k] * Q[j, k]\n                    else:  # Original is shear\n                        B_sigma[I, J] = Q[i, k] * Q[j, l] + Q[i, l] * Q[j, k]\n                        B_epsilon[I, J] = Q[i, k] * Q[j, l] + Q[i, l] * Q[j, k]\n        return B_sigma, B_epsilon\n\n    # Test cases defined in the problem statement.\n    # Each case is a dictionary of material properties and rotation parameters.\n    test_cases = [\n        # Case 1: Aligned orthotropy\n        {'mat': {'E1': 150, 'E2': 12, 'E3': 12, 'nu12': 0.25, 'nu13': 0.20, 'nu23': 0.30, \n                 'G12': 6, 'G13': 5, 'G23': 4}, \n         'rot': {'type': 'identity'}},\n        # Case 2: Planar misalignment\n        {'mat': {'E1': 150, 'E2': 12, 'E3': 12, 'nu12': 0.25, 'nu13': 0.20, 'nu23': 0.30, \n                 'G12': 6, 'G13': 5, 'G23': 4}, \n         'rot': {'type': 'axis_angle', 'axis': [0, 0, 1], 'angle_deg': 45}},\n        # Case 3: Isotropic limit\n        {'mat': {'E1': 100, 'E2': 100, 'E3': 100, 'nu12': 0.25, 'nu13': 0.25, 'nu23': 0.25, \n                 'G12': 40, 'G13': 40, 'G23': 40}, \n         'rot': {'type': 'axis_angle', 'axis': [1, 1, 1], 'angle_deg': 40}},\n        # Case 4: Composite misalignment\n        {'mat': {'E1': 50, 'E2': 10, 'E3': 5, 'nu12': 0.25, 'nu13': 0.20, 'nu23': 0.30, \n                 'G12': 8, 'G13': 6, 'G23': 4}, \n         'rot': {'type': 'composite', 'angles_deg': [30, 20, 10]}},\n    ]\n\n    results = []\n    for case in test_cases:\n        # 1. Construct orthotropic compliance and stiffness matrices\n        S = construct_ortho_compliance(**case['mat'])\n        C = np.linalg.inv(S)\n\n        # 2. Construct the rotation matrix Q\n        rot_params = case['rot']\n        if rot_params['type'] == 'identity':\n            Q = np.eye(3)\n        elif rot_params['type'] == 'axis_angle':\n            angle_rad = np.deg2rad(rot_params['angle_deg'])\n            Q = get_rotation_matrix_from_axis_angle(rot_params['axis'], angle_rad)\n        elif rot_params['type'] == 'composite':\n            angle_x_rad = np.deg2rad(rot_params['angles_deg'][0])\n            angle_y_rad = np.deg2rad(rot_params['angles_deg'][1])\n            angle_z_rad = np.deg2rad(rot_params['angles_deg'][2])\n            \n            Qx = get_rotation_matrix_from_axis_angle([1, 0, 0], angle_x_rad)\n            Qy = get_rotation_matrix_from_axis_angle([0, 1, 0], angle_y_rad)\n            Qz = get_rotation_matrix_from_axis_angle([0, 0, 1], angle_z_rad)\n            \n            # Rotations applied in order: 1-axis, then 2-axis, then 3-axis.\n            # Q = Q_z * Q_y * Q_x\n            Q = Qz @ Qy @ Qx\n\n        # 3. Construct Bond matrices\n        B_sigma, B_epsilon = construct_bond_matrices(Q)\n\n        # 4. Compute transformed stiffness matrix C'\n        # C_prime = B_sigma @ C @ inv(B_epsilon)\n        C_prime = B_sigma @ C @ np.linalg.inv(B_epsilon)\n\n        # 5. Quantify induced coupling\n        # Sum of absolute values of the upper-right 3x3 block (normal-shear coupling)\n        coupling_block = C_prime[0:3, 3:6]\n        total_coupling = np.sum(np.abs(coupling_block))\n        \n        results.append(total_coupling)\n\n    # Format the final output as a comma-separated list of floats rounded to 6 decimal places.\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "材料的刚度张量不仅联系着应力与应变，更决定了材料对动态扰动的响应及其内在稳定性。这是一个高级练习，旨在探索强椭圆性这一核心概念，它是材料保持稳定性的数学条件。你将学习如何通过计算声学张量 $\\mathbb{Q}(\\mathbf{n})$ 并分析其特征值，来判断材料是否会发生失稳（如剪切带的形成）。",
            "id": "3580511",
            "problem": "考虑一个材料轴与笛卡尔坐标轴对齐的正交各向异性线性弹性固体。令 $\\sigma_{ij}$ 表示柯西应力，$\\epsilon_{kl}$ 表示无穷小应变，$C_{ijkl}$ 表示四阶刚度张量。在小应变体系下，本构关系由 $\\,\\sigma_{ij} = C_{ijkl}\\,\\epsilon_{kl}\\,$ 给出。对于增量波传播和局部化分析，与单位法线方向 $\\,\\mathbf{n}\\in\\mathbb{R}^3\\,$ 相关的声学张量 (AT) $\\,\\mathbb{Q}(\\mathbf{n})\\,$ 由缩并 $\\,Q_{ik}(\\mathbf{n}) = C_{ijkl}\\,n_j\\,n_l\\,$ 定义。强椭圆性成立当且仅当对于每个单位向量 $\\,\\mathbf{n}\\,$，$\\,\\mathbb{Q}(\\mathbf{n})\\,$ 是正定的，这等价于 Legendre–Hadamard 条件 $\\,a_i\\,C_{ijkl}\\,n_j\\,n_l\\,a_k  0\\,$ 对所有非零 $\\,\\mathbf{a},\\mathbf{n}\\in\\mathbb{R}^3\\,$ 成立。当 $\\,\\mathbb{Q}(\\mathbf{n})\\,$ 的至少一个特征值对于某个 $\\,\\mathbf{n}\\,$ 变为非正时，则检测到强椭圆性丧失（局部化开始）。\n\n正交各向异性刚度可以通过工程常数指定：杨氏模量 $\\,E_1,E_2,E_3\\,$，泊松比 $\\,\\nu_{12},\\nu_{13},\\nu_{23}\\,$（具有互易关系 $\\,\\nu_{21}=\\nu_{12}\\,E_2/E_1\\,$, $\\,\\nu_{31}=\\nu_{13}\\,E_3/E_1\\,$, $\\,\\nu_{32}=\\nu_{23}\\,E_3/E_2\\,$），以及剪切模量 $\\,G_{12},G_{13},G_{23}\\,$。在 Voigt 标记法中，$\\,6\\times 6\\,$ 的柔度矩阵 $\\,\\mathbf{S}\\,$ 的对角线元素为 $\\,S_{11}=1/E_1\\,$, $\\,S_{22}=1/E_2\\,$, $\\,S_{33}=1/E_3\\,$, $\\,S_{44}=1/G_{23}\\,$, $\\,S_{55}=1/G_{13}\\,$, $\\,S_{66}=1/G_{12}\\,$，对称的非对角线元素为 $\\,S_{12}=-\\nu_{12}/E_1\\,$, $\\,S_{13}=-\\nu_{13}/E_1\\,$, $\\,S_{23}=-\\nu_{23}/E_2\\,$，其中 $\\,S_{21}=-\\nu_{21}/E_2\\,$, $\\,S_{31}=-\\nu_{31}/E_3\\,$, $\\,S_{32}=-\\nu_{32}/E_3\\,$ 由互易关系确定。在 Voigt 标记法中的刚度为 $\\,\\mathbf{C}^{\\mathrm{V}}=\\mathbf{S}^{-1}\\,$。您必须基于这些定义进行推导和计算，不得引入未经证实的简化。\n\n您的任务是编写一个完整、可运行的程序，该程序能够：\n- 从给定的工程常数构建正交各向异性柔度矩阵 $\\,\\mathbf{S}\\,$，强制执行泊松比的互易关系，并计算 Voigt 刚度 $\\,\\mathbf{C}^{\\mathrm{V}}=\\mathbf{S}^{-1}\\,$。\n- 从 $\\,\\mathbf{C}^{\\mathrm{V}}\\,$ 和剪切模量 $\\,G_{12},G_{13},G_{23}\\,$ 出发，通过基本缩并 $\\,Q_{ik}(\\mathbf{n}) = C_{ijkl}\\,n_j\\,n_l\\,$，为与坐标轴对齐的正交各向异性情况计算任意单位向量 $\\,\\mathbf{n}=[n_1,n_2,n_3]^\\top\\,$ 的声学张量 $\\,\\mathbb{Q}(\\mathbf{n})\\,$，不假设任何各向同性的简化。\n- 使用球面角 $\\,\\theta\\in[0,\\pi]\\,$ 和 $\\,\\phi\\in[0,2\\pi)\\,$（以弧度为单位），在单位球面上采样方向 $\\,\\mathbf{n}\\,$。采用均匀网格，其中 $\\,N_\\theta=41\\,$ 和 $\\,N_\\phi=81\\,$，并使用 $\\,n_1=\\sin\\theta\\cos\\phi\\,$, $\\,n_2=\\sin\\theta\\sin\\phi\\,$, $\\,n_3=\\cos\\theta\\,$。\n- 对于下面的每个测试用例，计算在采样方向上 $\\,\\mathbb{Q}(\\mathbf{n})\\,$ 的最小特征值，确定达到该最小值的方向 $\\,\\mathbf{n}\\,$，并在最小特征值为非正时标记强椭圆性丧失。\n\n科学真实性：所有模量均以吉帕斯卡 (GPa) 为单位指定。在高等计算固体力学中，软化过程中各向异性介质的有效切线剛度可能包含非正的剪切模量；因此，您必须严格地根据声学张量的特征值来评估强椭圆性，不得丢弃此类情况。\n\n角度：所有角度都必须以弧度处理。\n\n单位：所有刚度条目和特征值都必须以吉帕斯卡 (GPa) 表示。您的程序必须以吉帕斯卡 (GPa) 报告特征值。\n\n测试套件参数（每个元组列出 GPa 单位的 $\\,E_1,E_2,E_3\\,$；无量纲的 $\\,\\nu_{12},\\nu_{13},\\nu_{23}\\,$；以及 GPa 单位的 $\\,G_{12},G_{13},G_{23}\\,$）：\n- 测试 $\\,1\\,$（正常路径，强椭圆性）：$$(E_1,E_2,E_3)=(140,70,50),\\quad (\\nu_{12},\\nu_{13},\\nu_{23})=(0.25,0.20,0.22),\\quad (G_{12},G_{13},G_{23})=(50,35,25).$$\n- 测试 $\\,2\\,$（近边界平面内剪切软化）：$$(E_1,E_2,E_3)=(140,70,50),\\quad (\\nu_{12},\\nu_{13},\\nu_{23})=(0.25,0.20,0.22),\\quad (G_{12},G_{13},G_{23})=(1.0,35,25).$$\n- 测试 $\\,3\\,$（在 $\\,1$–$\\,2\\,$ 平面内具有软化切线的边缘情况）：$$(E_1,E_2,E_3)=(20,180,160),\\quad (\\nu_{12},\\nu_{13},\\nu_{23})=(0.15,0.10,0.08),\\quad (G_{12},G_{13},G_{23})=(-0.5,60,60).$$\n\n您的程序必须生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果，每个测试用例的结果都是形如 $\\,[$min\\_eigenvalue\\_in\\_GPa$,\\,n_x,\\,n_y,\\,n_z,$loss\\_boolean$]\\,$ 的列表，顺序与上述测试套件相同。例如，最终输出必须看起来像 $\\,[[\\cdots],[\\cdots],[\\cdots]]\\,$，仅包含浮点数和布尔值。\n\n所有特征值均以吉帕斯卡 (GPa) 为单位作答。角度必须以弧度处理。最终程序必须完全自包含，无需任何输入。",
            "solution": "本问题的核心任务是通过找到其声学张量 $\\mathbb{Q}(\\mathbf{n})$ 在所有可能方向 $\\mathbf{n}$ 上的最小特征值，来判断给定的正交各向异性材料是否满足强椭圆性条件。强椭圆性的丧失（即最小特征值变为非正）是材料失稳和应变局部化（如剪切带形成）的先兆。\n\n计算步骤如下：\n\n1.  **构建柔度与刚度矩阵**：\n    首先，根据给定的九个工程常数（$E_1, E_2, E_3, \\nu_{12}, \\nu_{13}, \\nu_{23}, G_{12}, G_{13}, G_{23}$）构建 $6 \\times 6$ 的柔度矩阵 $\\mathbf{S}$。对于与坐标轴对齐的正交各向异性材料，该矩阵具有块对角结构。其非零元素由标准公式给出，例如 $S_{11}=1/E_1$, $S_{12}=-\\nu_{12}/E_1$, $S_{44}=1/G_{23}$ 等。为了确保 $\\mathbf{S}$ 的对称性（这是超弹性材料的要求），必须满足互易关系 $\\nu_{ij}/E_i = \\nu_{ji}/E_j$。然后，通过数值求逆得到 Voigt 记法下的刚度矩阵 $\\mathbf{C}^\\mathrm{V} = \\mathbf{S}^{-1}$。\n\n2.  **构建声学张量 $\\mathbb{Q}(\\mathbf{n})$**：\n    声学张量是一个 $3 \\times 3$ 的对称矩阵，其分量由 $Q_{ik}(\\mathbf{n}) = C_{ijkl}n_j n_l$ 定义，其中 $\\mathbf{n}=[n_1, n_2, n_3]^\\top$ 是一个单位方向向量。通过将四阶张量 $C_{ijkl}$ 的分量与 Voigt 刚度矩阵 $\\mathbf{C}^\\mathrm{V}$ 的元素相对应（例如，$C_{1111}=C^\\mathrm{V}_{11}$, $C_{2222}=C^\\mathrm{V}_{22}$, $C_{1122}=C^\\mathrm{V}_{12}$, $C_{2323}=C^\\mathrm{V}_{44}$ 等），并执行缩并运算，可以得到声学张量各分量的显式表达式：\n    $$\n    \\begin{aligned}\n    Q_{11} = C^\\mathrm{V}_{11} n_1^2 + C^\\mathrm{V}_{66} n_2^2 + C^\\mathrm{V}_{55} n_3^2 \\\\\n    Q_{22} = C^\\mathrm{V}_{66} n_1^2 + C^\\mathrm{V}_{22} n_2^2 + C^\\mathrm{V}_{44} n_3^2 \\\\\n    Q_{33} = C^\\mathrm{V}_{55} n_1^2 + C^\\mathrm{V}_{44} n_2^2 + C^\\mathrm{V}_{33} n_3^2 \\\\\n    Q_{12} = (C^\\mathrm{V}_{12} + C^\\mathrm{V}_{66}) n_1 n_2 \\\\\n    Q_{13} = (C^\\mathrmV_{13} + C^\\mathrmV_{55}) n_1 n_3 \\\\\n    Q_{23} = (C^\\mathrmV_{23} + C^\\mathrmV_{44}) n_2 n_3\n    \\end{aligned}\n    $$\n    由于对称性，$Q_{ji}=Q_{ij}$。\n\n3.  **数值搜索最小特征值**：\n    强椭圆性要求 $\\mathbb{Q}(\\mathbf{n})$ 对所有单位向量 $\\mathbf{n}$ 都是正定的，这等价于其最小特征值对所有 $\\mathbf{n}$ 都必须为正。为了在计算上验证这一点，我们在单位球面上进行系统性的搜索。使用球面坐标 $\\mathbf{n}(\\theta, \\phi) = (\\sin\\theta\\cos\\phi, \\sin\\theta\\sin\\phi, \\cos\\theta)^\\top$，并按照问题要求在极角 $\\theta \\in [0, \\pi]$ 和方位角 $\\phi \\in [0, 2\\pi)$ 上构建一个均匀的离散网格。对于网格上的每一个方向 $\\mathbf{n}$，我们都构建上述声学张量 $\\mathbb{Q}(\\mathbf{n})$，并计算其三个实数特征值。然后，我们记录下在所有采样方向中找到的全局最小特征值。\n\n4.  **评估与报告**：\n    遍历所有采样方向后，我们得到全局最小特征值 $\\lambda_{\\min}$ 以及其对应的方向 $\\mathbf{n}_{\\min}$。如果 $\\lambda_{\\min} \\le 0$，则我们判定材料丧失了强椭圆性。程序最终为每个测试用例报告 $\\lambda_{\\min}$、$\\mathbf{n}_{\\min}$ 的三个分量以及一个表示是否丧失强椭圆性的布尔值。包含负剪切模量的测试用例是有效的，因为它模拟了材料在变形过程中可能出现的软化行为，而强椭圆性检查正是为了诊断这种失稳现象。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the minimum eigenvalue of the acoustic tensor for given orthotropic\n    materials to check for loss of strong ellipticity.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each tuple contains: (E1, E2, E3), (nu12, nu13, nu23), (G12, G13, G23)\n    test_cases = [\n        # Test 1 (happy path, strongly elliptic)\n        ((140.0, 70.0, 50.0), (0.25, 0.20, 0.22), (50.0, 35.0, 25.0)),\n        # Test 2 (near-boundary in-plane shear softening)\n        ((140.0, 70.0, 50.0), (0.25, 0.20, 0.22), (1.0, 35.0, 25.0)),\n        # Test 3 (edge case with softening tangent in plane 1–2)\n        ((20.0, 180.0, 160.0), (0.15, 0.10, 0.08), (-0.5, 60.0, 60.0)),\n    ]\n\n    # Sampling grid parameters for the unit sphere\n    N_theta = 41\n    N_phi = 81\n\n    final_results = []\n\n    for E_vals, nu_vals, G_vals in test_cases:\n        E1, E2, E3 = E_vals\n        nu12, nu13, nu23 = nu_vals\n        G12, G13, G23 = G_vals\n\n        # 1. Construct the 6x6 compliance matrix S in Voigt notation.\n        S = np.zeros((6, 6))\n        \n        # Diagonal entries\n        S[0, 0] = 1.0 / E1\n        S[1, 1] = 1.0 / E2\n        S[2, 2] = 1.0 / E3\n        S[3, 3] = 1.0 / G23  # Corresponds to the 2-3 plane\n        S[4, 4] = 1.0 / G13  # Corresponds to the 1-3 plane\n        S[5, 5] = 1.0 / G12  # Corresponds to the 1-2 plane\n        \n        # Off-diagonal entries (upper-left 3x3 block)\n        # S_ij = -nu_ij / E_i = -nu_ji / E_j\n        S[0, 1] = S[1, 0] = -nu12 / E1\n        S[0, 2] = S[2, 0] = -nu13 / E1\n        S[1, 2] = S[2, 1] = -nu23 / E2\n\n        # 2. Compute the stiffness matrix C_V by inverting S.\n        C_V = np.linalg.inv(S)\n        C11, C22, C33 = C_V[0, 0], C_V[1, 1], C_V[2, 2]\n        C12, C13, C23 = C_V[0, 1], C_V[0, 2], C_V[1, 2]\n        C44, C55, C66 = C_V[3, 3], C_V[4, 4], C_V[5, 5]\n\n        # 3. Search for the minimum eigenvalue of the acoustic tensor over the unit sphere.\n        min_global_eig = float('inf')\n        best_n_vector = None\n\n        thetas = np.linspace(0, np.pi, N_theta)\n        phis = np.linspace(0, 2 * np.pi, N_phi, endpoint=False)\n\n        for theta in thetas:\n            for phi in phis:\n                # Components of the unit direction vector n\n                n1 = np.sin(theta) * np.cos(phi)\n                n2 = np.sin(theta) * np.sin(phi)\n                n3 = np.cos(theta)\n\n                # Construct the acoustic tensor Q for the direction n\n                Q = np.zeros((3, 3))\n                \n                Q[0, 0] = C11 * n1**2 + C66 * n2**2 + C55 * n3**2\n                Q[1, 1] = C66 * n1**2 + C22 * n2**2 + C44 * n3**2\n                Q[2, 2] = C55 * n1**2 + C44 * n2**2 + C33 * n3**2\n                \n                Q[0, 1] = Q[1, 0] = (C12 + C66) * n1 * n2\n                Q[0, 2] = Q[2, 0] = (C13 + C55) * n1 * n3\n                Q[1, 2] = Q[2, 1] = (C23 + C44) * n2 * n3\n                \n                # Compute eigenvalues of the symmetric matrix Q. eigvalsh is efficient.\n                eigenvalues = np.linalg.eigvalsh(Q)\n                min_local_eig = eigenvalues[0]  # eigvalsh returns sorted eigenvalues\n\n                if min_local_eig  min_global_eig:\n                    min_global_eig = min_local_eig\n                    best_n_vector = [n1, n2, n3]\n\n        # 4. Check for loss of strong ellipticity.\n        loss_of_ellipticity = min_global_eig = 0.0\n\n        # Store the results for the current test case.\n        case_result = [min_global_eig, best_n_vector[0], best_n_vector[1], best_n_vector[2], loss_of_ellipticity]\n        final_results.append(case_result)\n\n    # Final print statement in the exact required format.\n    # The str() function converts the inner lists to their string representation,\n    # and join(',') combines them into a single string.\n    print(f\"[{','.join(map(str, final_results))}]\")\n\nsolve()\n```"
        }
    ]
}