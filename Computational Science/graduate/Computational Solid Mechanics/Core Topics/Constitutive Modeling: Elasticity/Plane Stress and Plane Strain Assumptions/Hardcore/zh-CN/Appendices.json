{
    "hands_on_practices": [
        {
            "introduction": "要真正理解平面应力和平面应变假设，一个有效的方法是直接比较在相同输入下它们的力学响应。本练习将引导你从三维弹性本构定律出发，针对一个给定的单轴应变状态，分别推导两种假设下的应力。通过这个过程，你将定量地看到平面应变假设中的出平面约束如何使材料表现出更高的“刚度”，并理解其背后的物理原因。",
            "id": "3588356",
            "problem": "考虑一个由杨氏模量 $E$ 和泊松比 $\\nu$ 表征的均质、各向同性、线性弹性固体。一个材料点位于一块宽板内，其面内应变状态被规定为 $\\varepsilon_{xx}=\\varepsilon_{0}$、$\\varepsilon_{yy}=0$ 和 $\\gamma_{xy}=0$。根据结构理想化的不同，面外约束也不同：\n\n- 在平面应力理想化下，厚度方向的正应力满足 $\\sigma_{zz}=0$。\n- 在平面应变理想化下，厚度方向的正应变满足 $\\varepsilon_{zz}=0$。\n\n从以拉梅参数表示的三维线性弹性本构律出发，不使用任何预先简化的二维公式，推导在每种理想化情况下，由 $E$、$\\nu$ 和 $\\varepsilon_{0}$ 表示的 $\\sigma_{xx}$。然后，对于一种材料，$E=210\\,\\mathrm{GPa}$，$\\nu=0.30$，$\\varepsilon_{0}=1.0\\times 10^{-3}$，计算这两种情况下的数值。用千兆帕斯卡（GPa）表示你的最终数值，并将答案四舍五入到四位有效数字。简要解释两个结果之间任何差异的物理原因。",
            "solution": "本题要求从以拉梅参数表示的三维线性弹性本构律出发，推导在平面应力和平面应变两种理想化条件下正应力分量 $\\sigma_{xx}$。\n\n将柯西应力张量 $\\sigma_{ij}$ 与无穷小应变张量 $\\varepsilon_{ij}$ 相关联的均质、各向同性、线性弹性材料的本构关系由下式给出：\n$$ \\sigma_{ij} = \\lambda \\varepsilon_{kk} \\delta_{ij} + 2\\mu \\varepsilon_{ij} $$\n其中 $\\lambda$ 和 $\\mu$ 是拉梅参数，$\\delta_{ij}$ 是克罗内克符号，$\\varepsilon_{kk} = \\varepsilon_{xx} + \\varepsilon_{yy} + \\varepsilon_{zz}$ 是体积应变（应变张量的迹）。拉梅参数与杨氏模量 $E$ 和泊松比 $\\nu$ 的关系如下：\n$$ \\lambda = \\frac{E\\nu}{(1+\\nu)(1-2\\nu)} $$\n$$ \\mu = G = \\frac{E}{2(1+\\nu)} $$\n给定的面内应变状态为 $\\varepsilon_{xx}=\\varepsilon_0$、$\\varepsilon_{yy}=0$ 和 $\\gamma_{xy}=0$。由于工程剪应变 $\\gamma_{xy} = 2\\varepsilon_{xy}$，我们有 $\\varepsilon_{xy}=0$。正应力分量的应力-应变关系展开为：\n$$ \\sigma_{xx} = \\lambda(\\varepsilon_{xx} + \\varepsilon_{yy} + \\varepsilon_{zz}) + 2\\mu \\varepsilon_{xx} $$\n$$ \\sigma_{yy} = \\lambda(\\varepsilon_{xx} + \\varepsilon_{yy} + \\varepsilon_{zz}) + 2\\mu \\varepsilon_{yy} $$\n$$ \\sigma_{zz} = \\lambda(\\varepsilon_{xx} + \\varepsilon_{yy} + \\varepsilon_{zz}) + 2\\mu \\varepsilon_{zz} $$\n代入已知的应变分量 $\\varepsilon_{xx}=\\varepsilon_0$ 和 $\\varepsilon_{yy}=0$：\n$$ \\sigma_{xx} = \\lambda(\\varepsilon_0 + \\varepsilon_{zz}) + 2\\mu \\varepsilon_0 $$\n$$ \\sigma_{yy} = \\lambda(\\varepsilon_0 + \\varepsilon_{zz}) $$\n$$ \\sigma_{zz} = \\lambda(\\varepsilon_0 + \\varepsilon_{zz}) + 2\\mu \\varepsilon_{zz} = (\\lambda+2\\mu)\\varepsilon_{zz} + \\lambda\\varepsilon_0 $$\n\n我们现在将分别分析每种理想化情况。\n\n**1. 平面应力理想化 ($\\sigma_{zz}=0$)**\n\n在平面应力条件下，我们施加 $\\sigma_{zz}=0$。使用 $\\sigma_{zz}$ 的方程：\n$$ 0 = (\\lambda+2\\mu)\\varepsilon_{zz} + \\lambda\\varepsilon_0 $$\n由此，我们解出面外应变 $\\varepsilon_{zz}$：\n$$ \\varepsilon_{zz} = -\\frac{\\lambda}{\\lambda+2\\mu}\\varepsilon_0 $$\n现在，我们将 $\\varepsilon_{zz}$ 的表达式代入 $\\sigma_{xx}$ 的方程中：\n$$ \\sigma_{xx} = \\lambda\\left(\\varepsilon_0 - \\frac{\\lambda}{\\lambda+2\\mu}\\varepsilon_0\\right) + 2\\mu \\varepsilon_0 $$\n$$ \\sigma_{xx} = \\varepsilon_0 \\left[ \\lambda\\left(1 - \\frac{\\lambda}{\\lambda+2\\mu}\\right) + 2\\mu \\right] = \\varepsilon_0 \\left[ \\lambda\\left(\\frac{\\lambda+2\\mu-\\lambda}{\\lambda+2\\mu}\\right) + 2\\mu \\right] $$\n$$ \\sigma_{xx} = \\varepsilon_0 \\left[ \\frac{2\\mu\\lambda}{\\lambda+2\\mu} + 2\\mu \\right] = \\varepsilon_0 \\cdot 2\\mu \\left[ \\frac{\\lambda}{\\lambda+2\\mu} + 1 \\right] = \\varepsilon_0 \\cdot 2\\mu \\left[ \\frac{2\\lambda+2\\mu}{\\lambda+2\\mu} \\right]$$\n$$ \\sigma_{xx} = \\varepsilon_0 \\frac{4\\mu(\\lambda+\\mu)}{\\lambda+2\\mu} $$\n为了用 $E$ 和 $\\nu$ 来表示，我们代入 $\\lambda$ 和 $\\mu$ 的关系式。我们可以先简化参数的组合：\n$$ \\lambda+2\\mu = \\frac{E\\nu}{(1+\\nu)(1-2\\nu)} + \\frac{E}{1+\\nu} = \\frac{E}{1+\\nu}\\left(\\frac{\\nu}{1-2\\nu}+1\\right) = \\frac{E(1-\\nu)}{(1+\\nu)(1-2\\nu)} $$\n比值 $\\frac{\\lambda}{\\lambda+2\\mu}$ 于是变为 $\\frac{\\nu}{1-\\nu}$，这是一个有用的恒等式。让我们用它以一种更直接的方式来简化 $\\sigma_{xx}$ 的表达式：\n$$ \\sigma_{xx} = \\lambda(\\varepsilon_0 + \\varepsilon_{zz}) + 2\\mu\\varepsilon_0 = \\lambda\\left(\\varepsilon_0 - \\frac{\\nu}{1-\\nu}\\varepsilon_0\\right) + 2\\mu\\varepsilon_0 $$\n$$ \\sigma_{xx} = \\varepsilon_0 \\left[ \\lambda\\left(\\frac{1-\\nu-\\nu}{1-\\nu}\\right) + 2\\mu \\right] = \\varepsilon_0 \\left[ \\lambda\\frac{1-2\\nu}{1-\\nu} + 2\\mu \\right] $$\n代入 $\\lambda = \\frac{E\\nu}{(1+\\nu)(1-2\\nu)}$ 和 $\\mu = \\frac{E}{2(1+\\nu)}$：\n$$ \\sigma_{xx} = \\varepsilon_0 \\left[ \\frac{E\\nu}{(1+\\nu)(1-2\\nu)} \\frac{1-2\\nu}{1-\\nu} + \\frac{E}{1+\\nu} \\right] $$\n$$ \\sigma_{xx} = \\varepsilon_0 \\left[ \\frac{E\\nu}{(1+\\nu)(1-\\nu)} + \\frac{E}{1+\\nu} \\right] = \\frac{E\\varepsilon_0}{1+\\nu} \\left[ \\frac{\\nu}{1-\\nu} + 1 \\right] $$\n$$ \\sigma_{xx} = \\frac{E\\varepsilon_0}{1+\\nu} \\left[ \\frac{\\nu+1-\\nu}{1-\\nu} \\right] = \\frac{E\\varepsilon_0}{(1+\\nu)(1-\\nu)} $$\n因此，对于平面应力：\n$$ \\sigma_{xx}^{\\text{p-stress}} = \\frac{E}{1-\\nu^2}\\varepsilon_0 $$\n\n**2. 平面应变理想化 ($\\varepsilon_{zz}=0$)**\n\n在平面应变条件下，直接施加 $\\varepsilon_{zz}=0$。体积应变为 $\\varepsilon_{kk} = \\varepsilon_{xx} + \\varepsilon_{yy} + \\varepsilon_{zz} = \\varepsilon_0 + 0 + 0 = \\varepsilon_0$。\n$\\sigma_{xx}$ 的推导非常直接。我们使用 $\\sigma_{xx}$ 的通用方程并代入已知的应变：\n$$ \\sigma_{xx} = \\lambda(\\varepsilon_0 + 0 + 0) + 2\\mu \\varepsilon_0 = (\\lambda+2\\mu)\\varepsilon_0 $$\n使用先前推导的用 $E$ 和 $\\nu$ 表示的 $\\lambda+2\\mu$ 的表达式：\n$$ \\lambda+2\\mu = \\frac{E(1-\\nu)}{(1+\\nu)(1-2\\nu)} $$\n因此，对于平面应变：\n$$ \\sigma_{xx}^{\\text{p-strain}} = \\frac{E(1-\\nu)}{(1+\\nu)(1-2\\nu)}\\varepsilon_0 $$\n\n**3. 数值计算**\n\n给定 $E=210\\,\\mathrm{GPa}$，$\\nu=0.30$ 和 $\\varepsilon_{0}=1.0\\times 10^{-3}$。\n\n对于平面应力：\n$$ \\sigma_{xx}^{\\text{p-stress}} = \\frac{210\\,\\mathrm{GPa}}{1-(0.30)^2} \\times (1.0 \\times 10^{-3}) = \\frac{210}{1-0.09} \\times 10^{-3}\\,\\mathrm{GPa} = \\frac{210}{0.91} \\times 10^{-3}\\,\\mathrm{GPa} $$\n$$ \\sigma_{xx}^{\\text{p-stress}} \\approx 230.7692... \\times 10^{-3}\\,\\mathrm{GPa} = 0.2307692...\\,\\mathrm{GPa} $$\n四舍五入到四位有效数字，我们得到 $0.2308\\,\\mathrm{GPa}$。\n\n对于平面应变：\n$$ \\sigma_{xx}^{\\text{p-strain}} = \\frac{210\\,\\mathrm{GPa} \\times (1-0.30)}{(1+0.30)(1-2 \\times 0.30)} \\times (1.0 \\times 10^{-3}) = \\frac{210 \\times 0.70}{1.30 \\times 0.40} \\times 10^{-3}\\,\\mathrm{GPa} $$\n$$ \\sigma_{xx}^{\\text{p-strain}} = \\frac{147}{0.52} \\times 10^{-3}\\,\\mathrm{GPa} \\approx 282.6923... \\times 10^{-3}\\,\\mathrm{GPa} = 0.2826923...\\,\\mathrm{GPa} $$\n四舍五入到四位有效数字，我们得到 $0.2827\\,\\mathrm{GPa}$。\n\n**4. 物理诠释**\n\n计算出的平面应变应力（$\\approx 0.2827\\,\\mathrm{GPa}$）显著高于平面应力应力（$\\approx 0.2308\\,\\mathrm{GPa}$）。这种差异源于面外（$z$方向）的约束。\n在这两种情况下，由于泊松效应，在 $x$ 方向拉伸材料（$\\varepsilon_{xx} = \\varepsilon_0 > 0$）会自然地导致其在横向（$y$ 和 $z$ 方向）收缩。\n- 在**平面应力**情况下，材料很薄，并且可以沿其厚度方向自由变形（$\\sigma_{zz}=0$）。它能够在 $z$ 方向收缩，也确实如此，这部分地释放了内应力。在这种情况下，$\\varepsilon_{zz} = -\\frac{\\nu}{1-\\nu}\\varepsilon_0 \\approx -0.43\\varepsilon_0$，这是一个显著的收缩。\n- 在**平面应变**情况下，材料在 $z$ 方向的变形受到约束（$\\varepsilon_{zz}=0$）。这种约束阻止了自然的泊松收缩。为了强制实现这种零应变，材料内部必须产生一个拉应力 $\\sigma_{zz}$（$\\sigma_{zz} = \\lambda \\varepsilon_0 > 0$）。这种约束使得材料在对施加的应变 $\\varepsilon_{xx}$ 的响应中，表现得等效地更硬。需要一个更大的应力 $\\sigma_{xx}$ 才能达到相同的应变 $\\varepsilon_0$，因为材料不能在厚度方向自由变形。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0.2308 & 0.2827 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "平面应力或平面应变的选择不仅影响应力分量的数值，更会深刻改变我们对材料三维受力状态的解读，尤其是在评估材料是否会屈服或失效时。本练习探讨了这两种假设对应力不变量（特别是与体积变化相关的 $I_1$ 和与形状变化及屈服相关的 $J_2$）的不同影响。通过计算和比较，你将揭示平面应变中“隐藏”的法向应力 $ \\sigma_{zz} $ 是如何改变真实的三维应力状态，从而影响屈服判据的。",
            "id": "3588334",
            "problem": "一个各向同性、线性弹性材料的扁平体承受一个沿厚度方向均匀分布的面内应力状态。非零的笛卡尔应力分量为 $\\sigma_{xx} = 120\\,\\text{MPa}$，$\\sigma_{yy} = -30\\,\\text{MPa}$，和 $\\sigma_{xy} = 45\\,\\text{MPa}$，且 $\\sigma_{xz} = \\sigma_{yz} = 0$。材料的泊松比为 $\\nu = 0.28$。针对相同的面内应力状态，考虑两种建模假设：(i) 平面应力，和 (ii) 平面应变。\n\n从柯西应力张量分解为静水压力部分和偏应力部分的基本定义以及三维线性弹性理论（广义胡克定律）出发，完成以下任务：\n\n- 解释为何在平面应变条件下，面内不变量 $I_{1}^{\\text{in-plane}} = \\sigma_{xx} + \\sigma_{yy}$ 的解释不同于真实的第一不变量 $I_{1} = \\sigma_{xx} + \\sigma_{yy} + \\sigma_{zz}$，而在平面应力条件下二者一致，并阐明“隐藏”的 $\\sigma_{zz}$ 的作用。\n- 使用偏应力定义 $s_{ij} = \\sigma_{ij} - \\frac{1}{3}\\sigma_{kk}\\delta_{ij}$ 和第二不变量 $J_{2} = \\frac{1}{2}s_{ij}s_{ij}$，在 (i) 平面应力和 (ii) 平面应变两种假设下，计算给定应力状态的 $J_{2}$ 的正确值。\n\n将两个 $J_{2}$ 值以 $\\text{MPa}^{2}$ 为单位表示，并分别四舍五入到四位有效数字。按（平面应力，平面应变）的顺序提供这两个值。",
            "solution": "问题陈述经评估有效。它在科学上基于线性弹性原理，问题提法良好且有唯一解，形式上完整且一致。所有必要数据（$\\sigma_{xx}$、$\\sigma_{yy}$、$\\sigma_{xy}$、$\\nu$）和定义（$I_1$、$J_2$、$s_{ij}$）均已提供。我们可以开始求解。\n\n该问题要求在两种不同的假设下（平面应力和平面应变）分析给定的面内应力状态。我们将首先处理关于应力不变量的概念部分，然后进行偏应力第二不变量 $J_2$ 的数值计算。\n\n给定问题在笛卡尔坐标系中的应力张量 $\\boldsymbol{\\sigma}$ 为：\n$$\n\\boldsymbol{\\sigma} = \\begin{pmatrix} \\sigma_{xx} & \\sigma_{xy} & \\sigma_{xz} \\\\ \\sigma_{yx} & \\sigma_{yy} & \\sigma_{yz} \\\\ \\sigma_{zx} & \\sigma_{zy} & \\sigma_{zz} \\end{pmatrix} = \\begin{pmatrix} 120\\,\\text{MPa} & 45\\,\\text{MPa} & 0 \\\\ 45\\,\\text{MPa} & -30\\,\\text{MPa} & 0 \\\\ 0 & 0 & \\sigma_{zz} \\end{pmatrix}\n$$\n$\\sigma_{zz}$ 的值取决于建模假设。\n\n**第一部分：应力不变量的解释**\n\n柯西应力张量的第一不变量 $I_1 = \\text{tr}(\\boldsymbol{\\sigma})$ 定义为对角分量之和：\n$$\nI_1 = \\sigma_{kk} = \\sigma_{xx} + \\sigma_{yy} + \\sigma_{zz}\n$$\n该不变量与静水（或平均）应力 $\\sigma_m$ 直接相关，关系为 $\\sigma_m = \\frac{1}{3} I_1$。在各向同性弹性材料中，静水应力引起体积变化（膨胀）。“面内”不变量给出为 $I_{1}^{\\text{in-plane}} = \\sigma_{xx} + \\sigma_{yy}$。\n\n**情况 (i)：平面应力假设**\n平面应力假设适用于在其平面内受载的薄体。它由垂直于平面的应力分量为零的条件定义。对于 x-y 平面内的物体，这意味着：\n$$\n\\sigma_{zz} = \\sigma_{xz} = \\sigma_{yz} = 0\n$$\n给定问题已说明 $\\sigma_{xz} = \\sigma_{yz} = 0$，因此关键约束是 $\\sigma_{zz} = 0$。\n在此假设下，真实的第一不变量 $I_1$ 变为：\n$$\nI_1 = \\sigma_{xx} + \\sigma_{yy} + 0 = \\sigma_{xx} + \\sigma_{yy}\n$$\n在这种情况下，真实的第一不变量 $I_1$ 与面内不变量 $I_{1}^{\\text{in-plane}}$ 完全相同。它们代表相同的物理量。静水应力完全由面内分量确定。“隐藏”的应力 $\\sigma_{zz}$ 根据定义为零，因此不起作用。需要注意的是，虽然 $\\sigma_{zz}$ 为零，但相应的面外应变 $\\epsilon_{zz}$ 通常不为零。根据广义胡克定律，$\\epsilon_{zz} = \\frac{1}{E}[\\sigma_{zz} - \\nu(\\sigma_{xx} + \\sigma_{yy})]$，简化为 $\\epsilon_{zz} = -\\frac{\\nu}{E}(\\sigma_{xx} + \\sigma_{yy})$。\n\n**情况 (ii)：平面应变假设**\n平面应变假设适用于一个方向上的变形受到约束的厚体或长体。它由面外方向的应变分量为零的条件定义。对于 x-y 平面内的物体，这意味着：\n$$\n\\epsilon_{zz} = \\epsilon_{xz} = \\epsilon_{yz} = 0\n$$\n为了维持条件 $\\epsilon_{zz}=0$，必须产生一个正应力 $\\sigma_{zz}$。我们使用各向同性线性弹性材料的三维本构关系（广义胡克定律）来找到它的值：\n$$\n\\epsilon_{zz} = \\frac{1}{E} [ \\sigma_{zz} - \\nu (\\sigma_{xx} + \\sigma_{yy}) ]\n$$\n令 $\\epsilon_{zz} = 0$，我们解出 $\\sigma_{zz}$：\n$$\n0 = \\frac{1}{E} [ \\sigma_{zz} - \\nu (\\sigma_{xx} + \\sigma_{yy}) ] \\implies \\sigma_{zz} = \\nu (\\sigma_{xx} + \\sigma_{yy})\n$$\n这个 $\\sigma_{zz}$ 就是“隐藏”的应力。它是一个反作用力，为强制实现零面外正应变的几何约束而产生。由于 $\\nu \\neq 0$ 且在本问题中 $\\sigma_{xx} + \\sigma_{yy} \\neq 0$，因此 $\\sigma_{zz}$ 是非零的。\n此时，真实的第一不变量 $I_1$ 为：\n$$\nI_1 = \\sigma_{xx} + \\sigma_{yy} + \\sigma_{zz} = \\sigma_{xx} + \\sigma_{yy} + \\nu(\\sigma_{xx} + \\sigma_{yy}) = (1+\\nu)(\\sigma_{xx} + \\sigma_{yy})\n$$\n在这种情况下，$I_1 = (1+\\nu) I_{1}^{\\text{in-plane}}$。真实的第一不变量 $I_1$ 和面内不变量 $I_{1}^{\\text{in-plane}}$ 不相同；它们相差一个因子 $(1+\\nu)$。$I_{1}^{\\text{in-plane}}$ 这个量不再代表应力张量的完整迹，因此提供了一个不完整的静水应力状态度量。解释之所以不同，是因为平面应变的物理约束会引起面外应力 $\\sigma_{zz}$，任何物理上正确的体积应力度量都必须包含这个应力。\n\n**第二部分：偏应力第二不变量 $J_2$ 的计算**\n\n偏应力张量 $s_{ij}$ 定义为 $s_{ij} = \\sigma_{ij} - \\sigma_m \\delta_{ij} = \\sigma_{ij} - \\frac{1}{3}I_1 \\delta_{ij}$。偏应力的第二不变量 $J_2$ 度量了应力状态的剪切（或畸变）分量的大小，并与畸变应变能相关。其定义为：\n$$\nJ_2 = \\frac{1}{2} s_{ij} s_{ij} = \\frac{1}{2} (s_{xx}^2 + s_{yy}^2 + s_{zz}^2 + 2s_{xy}^2 + 2s_{yz}^2 + 2s_{xz}^2)\n$$\n一个用应力分量表示 $J_2$ 的替代（且通常更方便）的表达式是：\n$$\nJ_2 = \\frac{1}{6} [ (\\sigma_{xx} - \\sigma_{yy})^2 + (\\sigma_{yy} - \\sigma_{zz})^2 + (\\sigma_{zz} - \\sigma_{xx})^2 ] + \\sigma_{xy}^2 + \\sigma_{yz}^2 + \\sigma_{xz}^2\n$$\n由于在本问题中 $\\sigma_{xz} = \\sigma_{yz} = 0$，公式简化为：\n$$\nJ_2 = \\frac{1}{6} [ (\\sigma_{xx} - \\sigma_{yy})^2 + (\\sigma_{yy} - \\sigma_{zz})^2 + (\\sigma_{zz} - \\sigma_{xx})^2 ] + \\sigma_{xy}^2\n$$\n我们使用给定的应力值：$\\sigma_{xx} = 120\\,\\text{MPa}$，$\\sigma_{yy} = -30\\,\\text{MPa}$，以及 $\\sigma_{xy} = 45\\,\\text{MPa}$。\n\n**情况 (i)：平面应力计算**\n在平面应力假设下，$\\sigma_{zz} = 0\\,\\text{MPa}$。\n我们计算差值：\n$\\sigma_{xx} - \\sigma_{yy} = 120 - (-30) = 150\\,\\text{MPa}$\n$\\sigma_{yy} - \\sigma_{zz} = -30 - 0 = -30\\,\\text{MPa}$\n$\\sigma_{zz} - \\sigma_{xx} = 0 - 120 = -120\\,\\text{MPa}$\n将这些值代入 $J_2$ 的公式：\n$$\nJ_2 = \\frac{1}{6} [ (150)^2 + (-30)^2 + (-120)^2 ] + (45)^2\n$$\n$$\nJ_2 = \\frac{1}{6} [ 22500 + 900 + 14400 ] + 2025\n$$\n$$\nJ_2 = \\frac{1}{6} [ 37800 ] + 2025 = 6300 + 2025 = 8325\\,\\text{MPa}^2\n$$\n值为 $8325\\,\\text{MPa}^2$，有四位有效数字。\n\n**情况 (ii)：平面应变计算**\n首先，我们必须使用 $\\nu=0.28$ 计算隐藏应力 $\\sigma_{zz}$ 的值：\n$$\n\\sigma_{zz} = \\nu (\\sigma_{xx} + \\sigma_{yy}) = 0.28 \\times (120 + (-30)) = 0.28 \\times 90 = 25.2\\,\\text{MPa}\n$$\n现在我们计算 $J_2$ 公式所需的差值，其中 $\\sigma_{zz} = 25.2\\,\\text{MPa}$：\n$\\sigma_{xx} - \\sigma_{yy} = 120 - (-30) = 150\\,\\text{MPa}$\n$\\sigma_{yy} - \\sigma_{zz} = -30 - 25.2 = -55.2\\,\\text{MPa}$\n$\\sigma_{zz} - \\sigma_{xx} = 25.2 - 120 = -94.8\\,\\text{MPa}$\n将这些值代入 $J_2$ 的公式：\n$$\nJ_2 = \\frac{1}{6} [ (150)^2 + (-55.2)^2 + (-94.8)^2 ] + (45)^2\n$$\n$$\nJ_2 = \\frac{1}{6} [ 22500 + 3047.04 + 8987.04 ] + 2025\n$$\n$$\nJ_2 = \\frac{1}{6} [ 34534.08 ] + 2025 = 5755.68 + 2025 = 7780.68\\,\\text{MPa}^2\n$$\n将此值四舍五入到四位有效数字，我们得到 $7781\\,\\text{MPa}^2$。\n\n最终结果是，平面应力情况下的 $J_2 = 8325\\,\\text{MPa}^2$，平面应变情况下的 $J_2 = 7781\\,\\text{MPa}^2$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 8325 & 7781 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在有限元分析（FEM）中，错误地为一个旨在模拟平面应变的模型选择了平面应力本构关系，是一个常见且后果严重的错误。本练习将理论与计算实践相结合，要求你不仅推导两种假设下的本构矩阵，还要设计一个计算测试来诊断这种模型错配。通过比较模型在体积变形和剪切变形下的能量响应，你将学会如何利用材料本构的根本差异来验证有限元模型的正确性。",
            "id": "3588365",
            "problem": "考虑一个均匀、各向同性、线性弹性的固体，其遵循三维 Hooke 定律 $\\boldsymbol{\\sigma} = 2 \\mu \\boldsymbol{\\varepsilon} + \\lambda \\, \\mathrm{tr}(\\boldsymbol{\\varepsilon}) \\mathbf{I}$，其中 $\\boldsymbol{\\sigma}$ 是 Cauchy 应力张量，$\\boldsymbol{\\varepsilon}$ 是无穷小应变张量，$\\mu$ 和 $\\lambda$ 是 Lamé 参数，$\\mathbf{I}$ 是单位张量。Lamé 参数通过以下公式与 Young 模量 $E$ 和 Poisson 比 $\\nu$ 相关：$\\mu = \\dfrac{E}{2(1+\\nu)}$ 和 $\\lambda = \\dfrac{E \\nu}{(1+\\nu)(1-2\\nu)}$。平面应力假设定义为 $\\sigma_{zz} = 0$，而平面应变假设定义为 $\\varepsilon_{zz} = 0$，其中 $z$ 是平面外方向。在二维分析的背景下，本构关系以 Voigt 记法表示为 $\\boldsymbol{\\sigma} = \\mathbf{D} \\boldsymbol{\\varepsilon}$，其中 $\\boldsymbol{\\varepsilon} = [\\varepsilon_{xx}, \\varepsilon_{yy}, \\gamma_{xy}]^\\top$，且 $\\gamma_{xy} = 2 \\varepsilon_{xy}$ 是工程剪切应变。\n\n从上述三维 Hooke 定律以及平面应力和平面应变的定义出发，分别推导平面应力和平面应变的二维材料矩阵 $\\mathbf{D}^{ps}(E,\\nu)$ 和 $\\mathbf{D}^{pe}(E,\\nu)$。然后分析在为平面应变设计的有限元网格中错误使用 $\\mathbf{D}^{ps}$ 的物理后果：具体来说，量化组装后的刚度对体积（类静水压）面内变形与剪切变形的响应，并使用推导出的本构定律解释任何差异的来源。\n\n你需要提出并实现一个计算测试，该测试直接从组装好的全局刚度矩阵 $\\mathbf{K}$ 检测这种不匹配，而无需求解边界值问题。在边长为 $1$、单位厚度的单位正方形域上，使用有限元方法 (FEM) 和双线性四边形单元 ($Q4$)，并离散为 $2 \\times 2$ 个单元（即 $4$ 个单元，包含 $3 \\times 3$ 个节点）。设 $\\mathbf{K}$ 由单元刚度矩阵 $\\mathbf{K}_e = \\int_{\\Omega_e} \\mathbf{B}^\\top \\mathbf{D} \\mathbf{B} \\, \\mathrm{d}\\Omega$ 组装而成，其中 $\\mathbf{B}$ 是双线性形函数的应变-位移矩阵，积分在父坐标系中使用标准的 $2 \\times 2$ Gaussian 求积法计算。不考虑体力。\n\n定义两个在节点自由度上表示的运动学容许位移场：\n- 均匀面内膨胀：$\\mathbf{u}_{\\mathrm{hydro}}(x,y) = [\\alpha x, \\alpha y]^\\top$，这会引起 $\\varepsilon_{xx} = \\alpha$，$\\varepsilon_{yy} = \\alpha$ 和 $\\gamma_{xy} = 0$。\n- 纯面内剪切：$\\mathbf{u}_{\\mathrm{shear}}(x,y) = \\left[\\dfrac{\\gamma}{2} y, \\dfrac{\\gamma}{2} x\\right]^\\top$，这会引起 $\\varepsilon_{xx} = 0$，$\\varepsilon_{yy} = 0$ 和 $\\gamma_{xy} = \\gamma$。\n\n对于一个给定的组装全局刚度矩阵 $\\mathbf{K}$，计算每个场的应变能，分别为 $W_{\\mathrm{hydro}} = \\dfrac{1}{2} \\mathbf{U}_{\\mathrm{hydro}}^\\top \\mathbf{K} \\mathbf{U}_{\\mathrm{hydro}}$ 和 $W_{\\mathrm{shear}} = \\dfrac{1}{2} \\mathbf{U}_{\\mathrm{shear}}^\\top \\mathbf{K} \\mathbf{U}_{\\mathrm{shear}}$，其中 $\\mathbf{U}$ 表示由每个场引起的全局节点位移向量。构造无量纲能量比\n$$\nQ_{\\mathrm{comp}} = \\frac{W_{\\mathrm{hydro}} / \\alpha^2}{W_{\\mathrm{shear}} / \\gamma^2}.\n$$\n从第一性原理出发，证明对于均匀各向同性连续体，该比率仅取决于本构类型和 Poisson 比，具体为\n$$\nQ^{ps}(\\nu) = \\frac{4(1+\\nu)}{1-\\nu},\n\\qquad\nQ^{pe}(\\nu) = \\frac{4}{1-2\\nu}.\n$$\n因此，用 $\\mathbf{D}^{ps}$ 组装的网格将表现出 $Q_{\\mathrm{comp}} \\approx Q^{ps}(\\nu)$，而为平面应变设计的网格应表现出 $Q_{\\mathrm{comp}} \\approx Q^{pe}(\\nu)$。\n\n设计一个检测算法，在给定预期的平面应变参数 $(E,\\nu)$ 和实际组装的矩阵类型（平面应力或平面应变）的情况下，如果相对偏差 $\\left| Q_{\\mathrm{comp}} / Q^{pe}(\\nu) - 1 \\right|$ 超过 $0.05$（即 $5\\%$）的容差，则声明存在不匹配。注意，当 $\\nu = 0$ 时，$Q^{ps}(\\nu) = Q^{pe}(\\nu)$，因此该测试在该边界上无法区分两者。\n\n将计算和检测实现为一个独立的自包含程序。使用以下测试套件以确保覆盖范围：\n- 测试 1：$E = 210 \\times 10^9$ 帕斯卡，$\\nu = 0.3$，按平面应力组装（预期不匹配）。\n- 测试 2：$E = 210 \\times 10^9$ 帕斯卡，$\\nu = 0.3$，按平面应变组装（预期无不匹配）。\n- 测试 3：$E = 1 \\times 10^6$ 帕斯卡，$\\nu = 0.0$，按平面应力组装（理论上预期无不匹配）。\n- 测试 4：$E = 1 \\times 10^9$ 帕斯卡，$\\nu = -0.2$，按平面应力组装（预期不匹配）。\n- 测试 5：$E = 3 \\times 10^7$ 帕斯卡，$\\nu = 0.49$，按平面应力组装（预期不匹配）。\n- 测试 6：$E = 3 \\times 10^7$ 帕斯卡，$\\nu = 0.49$，按平面应变组装（预期无不匹配）。\n\n取 $\\alpha = 10^{-3}$ 和 $\\gamma = 10^{-3}$，域长度单位为米，厚度等于 $1$ 米。所有能量均以焦耳计算，但最终的检测输出是无量纲的布尔值。您的程序应生成单行输出，其中包含六个测试的检测结果，格式为方括号括起来的逗号分隔列表（例如 $[r_1,r_2,r_3,r_4,r_5,r_6]$），其中每个 $r_i$ 是一个布尔值，表示是否根据上述标准为测试 $i$ 检测到不匹配。不需要用户输入，也不得使用外部文件。",
            "solution": "该问题经评估为有效。它在科学上基于连续介质力学和有限元方法的原理，问题陈述清晰，提供了所有必要的数据和条件，并以客观、正式的语言表述。不存在矛盾、歧义或事实错误。将按陈述解决该问题。\n\n解决方案分四个阶段进行：\n1.  从三维 Hooke 定律推导二维平面应力 ($\\mathbf{D}^{ps}$) 和平面应变 ($\\mathbf{D}^{pe}$) 本构矩阵。\n2.  对承受指定变形场的均匀连续体，解析推导其理论能量比 $Q^{ps}(\\nu)$ 和 $Q^{pe}(\\nu)$。\n3.  解释在平面应变条件下错误使用平面应力模型所产生的物理后果。\n4.  使用有限元方法 (FEM) 制定计算测试，以检测这种建模不匹配。\n\n### 1. 本构矩阵的推导\n\n三维各向同性线性弹性本构关系（Hooke 定律）由下式给出：\n$$\n\\boldsymbol{\\sigma} = 2 \\mu \\boldsymbol{\\varepsilon} + \\lambda \\, \\mathrm{tr}(\\boldsymbol{\\varepsilon}) \\mathbf{I}\n$$\n其中 $\\boldsymbol{\\sigma}$ 是 Cauchy 应力张量，$\\boldsymbol{\\varepsilon}$ 是无穷小应变张量，$\\mathbf{I}$ 是二阶单位张量，$\\lambda$ 和 $\\mu$ 是 Lamé 参数。用 Young 模量 $E$ 和 Poisson 比 $\\nu$ 表示，它们是：\n$$\n\\mu = \\frac{E}{2(1+\\nu)}, \\qquad \\lambda = \\frac{E\\nu}{(1+\\nu)(1-2\\nu)}\n$$\n应力和应变的六个独立分量通过以下关系相关联：\n$$\n\\begin{Bmatrix} \\sigma_{xx} \\\\ \\sigma_{yy} \\\\ \\sigma_{zz} \\\\ \\sigma_{xy} \\\\ \\sigma_{yz} \\\\ \\sigma_{zx} \\end{Bmatrix} =\n\\begin{bmatrix}\n\\lambda+2\\mu & \\lambda & \\lambda & 0 & 0 & 0 \\\\\n\\lambda & \\lambda+2\\mu & \\lambda & 0 & 0 & 0 \\\\\n\\lambda & \\lambda & \\lambda+2\\mu & 0 & 0 & 0 \\\\\n0 & 0 & 0 & \\mu & 0 & 0 \\\\\n0 & 0 & 0 & 0 & \\mu & 0 \\\\\n0 & 0 & 0 & 0 & 0 & \\mu\n\\end{bmatrix}\n\\begin{Bmatrix} \\varepsilon_{xx} \\\\ \\varepsilon_{yy} \\\\ \\varepsilon_{zz} \\\\ 2\\varepsilon_{xy} \\\\ 2\\varepsilon_{yz} \\\\ 2\\varepsilon_{zx} \\end{Bmatrix}\n$$\n我们使用工程剪切应变 $\\gamma_{ij} = 2\\varepsilon_{ij}$。对于二维问题，Voigt 记法中的关系是 $\\boldsymbol{\\sigma} = \\mathbf{D} \\boldsymbol{\\varepsilon}$，其中 $\\boldsymbol{\\sigma} = [\\sigma_{xx}, \\sigma_{yy}, \\sigma_{xy}]^\\top$ 和 $\\boldsymbol{\\varepsilon} = [\\varepsilon_{xx}, \\varepsilon_{yy}, \\gamma_{xy}]^\\top$。\n\n**平面应变 (pe)：**\n平面应变条件定义为所有平面外应变为零的约束：$\\varepsilon_{zz} = \\varepsilon_{xz} = \\varepsilon_{yz} = 0$。\n面内分量的应力-应变关系简化为：\n$$\n\\sigma_{xx} = (\\lambda+2\\mu)\\varepsilon_{xx} + \\lambda\\varepsilon_{yy}\n$$\n$$\n\\sigma_{yy} = \\lambda\\varepsilon_{xx} + (\\lambda+2\\mu)\\varepsilon_{yy}\n$$\n$$\n\\sigma_{xy} = \\mu \\gamma_{xy}\n$$\n平面外应力 $\\sigma_{zz}$ 不为零：$\\sigma_{zz} = \\lambda(\\varepsilon_{xx} + \\varepsilon_{yy})$。\n将 $\\lambda$ 和 $\\mu$ 关于 $E$ 和 $\\nu$ 的表达式代入：\n$$\n\\lambda+2\\mu = \\frac{E\\nu}{(1+\\nu)(1-2\\nu)} + \\frac{E}{1+\\nu} = \\frac{E(1-\\nu)}{(1+\\nu)(1-2\\nu)}\n$$\n$$\n\\mu = \\frac{E}{2(1+\\nu)}\n$$\n这给出了平面应变本构矩阵 $\\mathbf{D}^{pe}$：\n$$\n\\mathbf{D}^{pe}(E,\\nu) = \\frac{E}{(1+\\nu)(1-2\\nu)}\n\\begin{bmatrix}\n1-\\nu & \\nu & 0 \\\\\n\\nu & 1-\\nu & 0 \\\\\n0 & 0 & \\frac{1-2\\nu}{2}\n\\end{bmatrix}\n$$\n\n**平面应力 (ps)：**\n平面应力条件定义为所有平面外应力为零的约束：$\\sigma_{zz} = \\sigma_{xz} = \\sigma_{yz} = 0$。\n从 $\\sigma_{zz} = \\lambda(\\varepsilon_{xx}+\\varepsilon_{yy}+\\varepsilon_{zz}) + 2\\mu\\varepsilon_{zz} = 0$，我们解出 $\\varepsilon_{zz}$：\n$$\n\\varepsilon_{zz} = -\\frac{\\lambda}{\\lambda+2\\mu}(\\varepsilon_{xx}+\\varepsilon_{yy}) = -\\frac{\\nu}{1-\\nu}(\\varepsilon_{xx}+\\varepsilon_{yy})\n$$\n将此代入 $\\sigma_{xx}$ 和 $\\sigma_{yy}$ 的表达式中：\n$$\n\\sigma_{xx} = (\\lambda+2\\mu)\\varepsilon_{xx} + \\lambda\\varepsilon_{yy} + \\lambda\\varepsilon_{zz} = (\\lambda+2\\mu)\\varepsilon_{xx} + \\lambda\\varepsilon_{yy} - \\frac{\\lambda^2}{\\lambda+2\\mu}(\\varepsilon_{xx}+\\varepsilon_{yy})\n$$\n经过代数简化，得到：\n$$\n\\sigma_{xx} = \\frac{E}{1-\\nu^2}(\\varepsilon_{xx} + \\nu\\varepsilon_{yy})\n$$\n$$\n\\sigma_{yy} = \\frac{E}{1-\\nu^2}(\\nu\\varepsilon_{xx} + \\varepsilon_{yy})\n$$\n剪切关系保持为 $\\sigma_{xy} = \\mu \\gamma_{xy}$。这给出了平面应力本构矩阵 $\\mathbf{D}^{ps}$：\n$$\n\\mathbf{D}^{ps}(E,\\nu) = \\frac{E}{1-\\nu^2}\n\\begin{bmatrix}\n1 & \\nu & 0 \\\\\n\\nu & 1 & 0 \\\\\n0 & 0 & \\frac{1-\\nu}{2}\n\\end{bmatrix}\n$$\n\n### 2. 理论能量比的推导\n\n应变能密度 $w$ 由 $w = \\frac{1}{2} \\boldsymbol{\\varepsilon}^\\top \\mathbf{D} \\boldsymbol{\\varepsilon}$ 给出。总能量 $W$ 是 $w$ 在体积上的积分。对于单位体积（$1 \\times 1 \\times 1$）域上的均匀应变场，有 $W=w$。\n\n**情况 1：均匀面内膨胀（类静水压）**\n位移场 $\\mathbf{u}_{\\mathrm{hydro}}(x,y) = [\\alpha x, \\alpha y]^\\top$ 引起均匀应变状态 $\\boldsymbol{\\varepsilon}_{\\mathrm{hydro}} = [\\alpha, \\alpha, 0]^\\top$。\n\n对于平面应力：\n$$\nW_{\\mathrm{hydro}}^{ps} = \\frac{1}{2} [\\alpha, \\alpha, 0] \\frac{E}{1-\\nu^2}\n\\begin{bmatrix} 1 & \\nu & 0 \\\\ \\nu & 1 & 0 \\\\ 0 & 0 & (1-\\nu)/2 \\end{bmatrix}\n\\begin{Bmatrix} \\alpha \\\\ \\alpha \\\\ 0 \\end{Bmatrix} = \\frac{E\\alpha^2}{2(1-\\nu^2)}(1+\\nu+\\nu+1) = \\frac{E\\alpha^2(1+\\nu)}{1-\\nu^2} = \\frac{E\\alpha^2}{1-\\nu}\n$$\n因此，$W_{\\mathrm{hydro}}^{ps}/\\alpha^2 = \\frac{E}{1-\\nu}$。\n\n对于平面应变：\n$$\nW_{\\mathrm{hydro}}^{pe} = \\frac{1}{2} [\\alpha, \\alpha, 0] \\frac{E}{(1+\\nu)(1-2\\nu)}\n\\begin{bmatrix} 1-\\nu & \\nu & 0 \\\\ \\nu & 1-\\nu & 0 \\\\ 0 & 0 & (1-2\\nu)/2 \\end{bmatrix}\n\\begin{Bmatrix} \\alpha \\\\ \\alpha \\\\ 0 \\end{Bmatrix} = \\frac{E\\alpha^2}{2(1+\\nu)(1-2\\nu)}(1-\\nu+\\nu+\\nu+1-\\nu) = \\frac{E\\alpha^2}{(1+\\nu)(1-2\\nu)}\n$$\n因此，$W_{\\mathrm{hydro}}^{pe}/\\alpha^2 = \\frac{E}{(1+\\nu)(1-2\\nu)}$。\n\n**情况 2：纯面内剪切**\n位移场 $\\mathbf{u}_{\\mathrm{shear}}(x,y) = [\\frac{\\gamma}{2}y, \\frac{\\gamma}{2}x]^\\top$ 引起均匀应变状态 $\\boldsymbol{\\varepsilon}_{\\mathrm{shear}}=[0, 0, \\gamma]^\\top$。\n\n对于平面应力和平面应变，剪切响应均由剪切模量 $\\mu=G=\\frac{E}{2(1+\\nu)}$ 控制。$\\mathbf{D}^{ps}$ 的 (3,3) 分量为 $\\frac{E}{1-\\nu^2}\\frac{1-\\nu}{2}=\\frac{E}{2(1+\\nu)}=\\mu$。$\\mathbf{D}^{pe}$ 的 (3,3) 分量为 $\\frac{E}{(1+\\nu)(1-2\\nu)}\\frac{1-2\\nu}{2}=\\frac{E}{2(1+\\nu)}=\\mu$。\n$$\nW_{\\mathrm{shear}} = \\frac{1}{2} [0, 0, \\gamma] \\mathbf{D} \\begin{Bmatrix} 0 \\\\ 0 \\\\ \\gamma \\end{Bmatrix} = \\frac{1}{2}\\mu\\gamma^2 = \\frac{E\\gamma^2}{4(1+\\nu)}\n$$\n因此，对于这两种情况，$W_{\\mathrm{shear}}/\\gamma^2 = \\frac{E}{4(1+\\nu)}$。\n\n**能量比：**\n无量纲比率 $Q$ 是通过将归一化的静水压能除以归一化的剪切能而构成的。\n对于平面应力：\n$$\nQ^{ps}(\\nu) = \\frac{W_{\\mathrm{hydro}}^{ps}/\\alpha^2}{W_{\\mathrm{shear}}/\\gamma^2} = \\frac{E/(1-\\nu)}{E/(4(1+\\nu))} = \\frac{4(1+\\nu)}{1-\\nu}\n$$\n对于平面应变：\n$$\nQ^{pe}(\\nu) = \\frac{W_{\\mathrm{hydro}}^{pe}/\\alpha^2}{W_{\\mathrm{shear}}/\\gamma^2} = \\frac{E/((1+\\nu)(1-2\\nu))}{E/(4(1+\\nu))} = \\frac{4}{1-2\\nu}\n$$\n这些推导证实了问题陈述中提供的表达式。\n\n### 3. 建模不匹配的物理后果\n\n不匹配的核心在于体积刚度。由 $\\mu$ 控制的剪切刚度在两种模型中是相同的。然而，对面积变化（面内体积应变）的抵抗能力则显著不同。\n\n对于实际为平面应变的物理情况，使用平面应力本构矩阵 $\\mathbf{D}^{ps}$ 意味着模型在体积变形方面将过于“软”。平面应力假设允许平面外变形（$\\varepsilon_{zz} \\neq 0$），这为面内膨胀或收缩提供了一种“释放”机制。而平面应变模型明确禁止这种情况（$\\varepsilon_{zz} = 0$），迫使所有变形都发生在面内，这对于相同的面内应变需要更高的应力，因此具有更高的刚度。\n\n当 $\\nu$ 接近 $0.5$ 时，这一点最为显著。对于平面应变，$\\nu \\to 0.5$ 的材料变得不可压缩；体积模量以及因此的 $Q^{pe}(\\nu)$ 趋于无穷大。相比之下，对于平面应力，$Q^{ps}(0.5) = 4(1.5)/0.5 = 12$，是一个有限值。对近乎不可压缩的平面应变问题使用平面应力模型将严重低估材料对体积变化的抵抗能力，这种现象被称为“伪柔度”，可能导致预测出大的、非物理的变形。\n\n### 4. 计算测试的制定\n\n所提出的测试利用了双线性四边形 (Q4) 有限元可以精确表示在空间坐标 $x$ 和 $y$ 中呈线性的任何位移场这一事实。$\\mathbf{u}_{\\mathrm{hydro}}$ 和 $\\mathbf{u}_{\\mathrm{shear}}$ 都是线性场。因此，从组装的全局刚度矩阵 $\\mathbf{K}$ 和相应的节点位移向量 $\\mathbf{U}$ 计算出的应变能，除了浮点误差外，必须与解析连续体能量完全匹配。\n$$\nW = \\frac{1}{2}\\mathbf{U}^\\top \\mathbf{K} \\mathbf{U} \\equiv \\int_{\\Omega} \\frac{1}{2}\\boldsymbol{\\varepsilon}^\\top \\mathbf{D} \\boldsymbol{\\varepsilon} \\, \\mathrm{d}\\Omega\n$$\n测试按以下步骤进行：\n1.  用 $2 \\times 2$ 的 Q4 单元网格离散化单位正方形域。这将产生 $9$ 个节点和 $18$ 个自由度 (DOF)。\n2.  对于由 $(E, \\nu)$ 和组装类型（`ps` 或 `pe`）指定的给定测试用例，使用适当的本构矩阵 $\\mathbf{D}$ 组装 $18 \\times 18$ 的全局刚度矩阵 $\\mathbf{K}$。单元刚度矩阵 $\\mathbf{K}_e = \\int_{\\Omega_e} \\mathbf{B}^\\top \\mathbf{D} \\mathbf{B} \\, t \\, \\mathrm{d}\\Omega$（厚度 $t=1$）使用 $2 \\times 2$ Gaussian 求积法计算。\n3.  通过在 $9$ 个节点各自的坐标上评估解析位移场，构建全局节点位移向量 $\\mathbf{U}_{\\mathrm{hydro}}$ 和 $\\mathbf{U}_{\\mathrm{shear}}$。\n4.  计算应变能 $W_{\\mathrm{hydro}} = \\frac{1}{2}\\mathbf{U}_{\\mathrm{hydro}}^\\top \\mathbf{K} \\mathbf{U}_{\\mathrm{hydro}}$ 和 $W_{\\mathrm{shear}} = \\frac{1}{2}\\mathbf{U}_{\\mathrm{shear}}^\\top \\mathbf{K} \\mathbf{U}_{\\mathrm{shear}}$。\n5.  计算计算能量比 $Q_{\\mathrm{comp}} = \\frac{W_{\\mathrm{hydro}}/\\alpha^2}{W_{\\mathrm{shear}}/\\gamma^2}$。由于 FEM 模型对这些场是精确的，因此 $Q_{\\mathrm{comp}}$ 在数值上将等于与组装中使用的矩阵 $\\mathbf{D}$ 相对应的理论比率（$Q^{ps}$ 或 $Q^{pe}$）。\n6.  检测逻辑将 $Q_{\\mathrm{comp}}$ 与平面应变问题的*预期*理论比率 $Q^{pe}(\\nu)$ 进行比较。如果相对偏差超过 $5\\%$ 的容差，则声明存在不匹配：\n    $$\n    \\left| \\frac{Q_{\\mathrm{comp}}}{Q^{pe}(\\nu)} - 1 \\right| > 0.05\n    $$\n该测试有效地检查了嵌入在矩阵 $\\mathbf{K}$ 中的“体积与剪切刚度之比”是否与具有 Poisson 比 $\\nu$ 的真实平面应变材料的该比率相匹配。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the FEM-based detection of constitutive model mismatch.\n    \"\"\"\n    \n    # --- Problem Parameters ---\n    ALPHA = 1e-3\n    GAMMA = 1e-3\n    TOLERANCE = 0.05\n    THICKNESS = 1.0\n\n    def get_constitutive_matrix(E, nu, matrix_type):\n        \"\"\"\n        Returns the 2D constitutive matrix D for plane stress or plane strain.\n        \n        Args:\n            E (float): Young's modulus.\n            nu (float): Poisson's ratio.\n            matrix_type (str): Either 'ps' for plane stress or 'pe' for plane strain.\n\n        Returns:\n            numpy.ndarray: The 3x3 constitutive matrix.\n        \"\"\"\n        if matrix_type == 'ps':\n            if abs(1.0 - nu**2) < 1e-9:\n                raise ValueError(\"Denominator is zero for plane stress with nu= +/-1.\")\n            factor = E / (1.0 - nu**2)\n            D = factor * np.array([\n                [1.0, nu, 0.0],\n                [nu, 1.0, 0.0],\n                [0.0, 0.0, (1.0 - nu) / 2.0]\n            ])\n        elif matrix_type == 'pe':\n            if abs((1.0 + nu) * (1.0 - 2.0 * nu)) < 1e-9:\n                 raise ValueError(\"Denominator is zero for plane strain with nu=-1 or nu=0.5.\")\n            factor = E / ((1.0 + nu) * (1.0 - 2.0 * nu))\n            D = factor * np.array([\n                [1.0 - nu, nu, 0.0],\n                [nu, 1.0 - nu, 0.0],\n                [0.0, 0.0, (1.0 - 2.0 * nu) / 2.0]\n            ])\n        else:\n            raise ValueError(f\"Invalid matrix_type: {matrix_type}\")\n        return D\n\n    def get_B_matrix_and_detJ(xi, eta, elem_coords):\n        \"\"\"\n        Computes the strain-displacement matrix (B) and Jacobian determinant for a Q4 element.\n        \"\"\"\n        # Derivatives of shape functions w.r.t. parent coordinates (xi, eta)\n        dN_dxi = 0.25 * np.array([-(1.0 - eta), (1.0 - eta), (1.0 + eta), -(1.0 + eta)])\n        dN_deta = 0.25 * np.array([-(1.0 - xi), -(1.0 + xi), (1.0 + xi), (1.0 - xi)])\n\n        # Jacobian matrix\n        J = np.array([\n            [np.dot(dN_dxi, elem_coords[:, 0]), np.dot(dN_dxi, elem_coords[:, 1])],\n            [np.dot(dN_deta, elem_coords[:, 0]), np.dot(dN_deta, elem_coords[:, 1])]\n        ])\n\n        detJ = np.linalg.det(J)\n        if abs(detJ) < 1e-12:\n            raise np.linalg.LinAlgError(\"Jacobian determinant is zero or near-zero.\")\n        \n        J_inv = np.linalg.inv(J)\n\n        # Derivatives of shape functions w.r.t. global coordinates (x, y)\n        dN_dxy = J_inv @ np.vstack([dN_dxi, dN_deta])\n        \n        # Strain-displacement matrix (B)\n        B = np.zeros((3, 8))\n        for i in range(4):\n            B[0, 2 * i] = dN_dxy[0, i]\n            B[1, 2 * i + 1] = dN_dxy[1, i]\n            B[2, 2 * i] = dN_dxy[1, i]\n            B[2, 2 * i + 1] = dN_dxy[0, i]\n            \n        return B, detJ\n\n    def assemble_stiffness_matrix(E, nu, matrix_type):\n        \"\"\"\n        Assembles the global stiffness matrix K for the specified mesh and material.\n        \"\"\"\n        # Mesh: 3x3 grid of nodes for a 2x2 element mesh on a unit square\n        nodes_coords = np.array([\n            [0.0, 0.0], [0.5, 0.0], [1.0, 0.0],\n            [0.0, 0.5], [0.5, 0.5], [1.0, 0.5],\n            [0.0, 1.0], [0.5, 1.0], [1.0, 1.0]\n        ])\n        \n        # Element connectivity (local nodes -> global node indices)\n        elements_nodes = np.array([\n            [0, 1, 4, 3],  # Element 0\n            [1, 2, 5, 4],  # Element 1\n            [3, 4, 7, 6],  # Element 2\n            [4, 5, 8, 7]   # Element 3\n        ], dtype=int)\n\n        num_nodes = nodes_coords.shape[0]\n        num_dofs = 2 * num_nodes\n        K_global = np.zeros((num_dofs, num_dofs))\n        \n        D = get_constitutive_matrix(E, nu, matrix_type)\n        \n        # 2x2 Gaussian quadrature points and weights\n        gauss_points = [-1.0 / np.sqrt(3.0), 1.0 / np.sqrt(3.0)]\n        gauss_weights = [1.0, 1.0]\n\n        for elem_node_indices in elements_nodes:\n            elem_coords = nodes_coords[elem_node_indices]\n            K_element = np.zeros((8, 8))\n\n            for i in range(len(gauss_points)):\n                for j in range(len(gauss_points)):\n                    xi, eta = gauss_points[i], gauss_points[j]\n                    weight = gauss_weights[i] * gauss_weights[j]\n                    \n                    B, detJ = get_B_matrix_and_detJ(xi, eta, elem_coords)\n                    \n                    K_element += B.T @ D @ B * detJ * weight * THICKNESS\n\n            # Assemble element matrix into global matrix\n            dof_indices = []\n            for node_idx in elem_node_indices:\n                dof_indices.extend([2 * node_idx, 2 * node_idx + 1])\n            \n            K_global[np.ix_(dof_indices, dof_indices)] += K_element\n            \n        return K_global, nodes_coords\n\n    def run_detection_test(E, nu_intended, assembled_as, alpha, gamma):\n        \"\"\"\n        Runs the detection test for a single case.\n        \"\"\"\n        try:\n            K_global, nodes_coords = assemble_stiffness_matrix(E, nu_intended, assembled_as)\n        except ValueError:\n            # Handle singular cases for nu.\n            # If the assembled matrix is singular, Q_comp will be ill-defined.\n            # If the intended matrix is singular, Q_pe_theoretical is ill-defined.\n            # In either case, it's a deviation from a well-posed problem.\n            if assembled_as == 'pe' and abs(1.0 - 2.0 * nu_intended) < 1e-9:\n                return True # Assembled a singular matrix\n            if assembled_as == 'ps' and abs(1.0 - 2.0 * nu_intended) < 1e-9:\n                return True # Comparing a finite Q_comp to an infinite Q_pe_theoretical. Mismatch.\n            raise\n\n\n        num_nodes = nodes_coords.shape[0]\n        \n        # Generate global nodal displacement vectors U\n        U_hydro = np.zeros(2 * num_nodes)\n        U_shear = np.zeros(2 * num_nodes)\n        for i in range(num_nodes):\n            x, y = nodes_coords[i, 0], nodes_coords[i, 1]\n            U_hydro[2 * i] = alpha * x\n            U_hydro[2 * i + 1] = alpha * y\n            U_shear[2 * i] = gamma / 2.0 * y\n            U_shear[2 * i + 1] = gamma / 2.0 * x\n\n        # Compute strain energies\n        W_hydro = 0.5 * U_hydro.T @ K_global @ U_hydro\n        W_shear = 0.5 * U_shear.T @ K_global @ U_shear\n        \n        if abs(W_shear) < 1e-12 or abs(gamma) < 1e-12 or abs(alpha) < 1e-12:\n            return True # Ill-defined test indicates a problem (mismatch)\n\n        # Compute computational energy ratio\n        Q_comp = (W_hydro / alpha**2) / (W_shear / gamma**2)\n        \n        # Theoretical plane strain energy ratio\n        if abs(1.0 - 2.0 * nu_intended) < 1e-9:\n            return True\n        Q_pe_theoretical = 4.0 / (1.0 - 2.0 * nu_intended)\n\n        # Detection logic\n        relative_deviation = abs(Q_comp / Q_pe_theoretical - 1.0)\n        mismatch_detected = relative_deviation > TOLERANCE\n        \n        return mismatch_detected\n\n    # --- Test Suite Execution ---\n    test_cases = [\n        # (E, nu_intended, assembled_as)\n        (210e9, 0.3, 'ps'), # Test 1: Mismatch expected (ps used for pe)\n        (210e9, 0.3, 'pe'), # Test 2: No mismatch (correctly assembled as pe)\n        (1e6, 0.0, 'ps'),   # Test 3: No mismatch (ps and pe are identical for nu=0)\n        (1e9, -0.2, 'ps'),  # Test 4: Mismatch expected (auxetic material)\n        (3e7, 0.49, 'ps'),  # Test 5: Mismatch expected (near-incompressible case)\n        (3e7, 0.49, 'pe'),  # Test 6: No mismatch (correctly assembled near-incompressible pe)\n    ]\n    \n    results = []\n    for E, nu, assembly_type in test_cases:\n        result = run_detection_test(E, nu, assembly_type, ALPHA, GAMMA)\n        results.append(result)\n\n    print(f\"[{','.join(str(r).lower() for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}