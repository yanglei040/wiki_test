{
    "hands_on_practices": [
        {
            "introduction": "在连续介质力学中，应力与应变度量的选择取决于具体问题。本实践旨在巩固材料坐标系（Lagrange坐标系）下两种关键描述之间的基本联系：第一Piola-Kirchhoff应力（$P$）和第二Piola-Kirchhoff应力（$S$）。您将通过解析推导和数值验证来证实它们之间的关系（$P = FS$）以及它们功率表达式（$P:\\dot{F} = S:\\dot{E}$）的关键等价性，从而加深对功共轭概念的理解。",
            "id": "3606700",
            "problem": "考虑一个经历有限变形的超弹性固体。令变形梯度表示为 $F \\in \\mathbb{R}^{3 \\times 3}$，其雅可比行列式为 $J = \\det F > 0$，右柯西-格林张量为 $C = F^{\\mathsf{T}} F$，格林-拉格朗日应变为 $E = \\tfrac{1}{2}(C - I)$，其中 $I$ 是单位张量。第一和第二皮奥拉-基尔霍夫应力分别表示为 $P$ 和 $S$。单位参考体积的比亥姆霍兹自由能（应变能密度）采用可压缩 neo-Hookean 模型\n$$\n\\Psi(C) = \\frac{\\mu}{2}\\big(\\operatorname{tr} C - 3\\big) - \\mu \\ln J + \\frac{\\kappa}{2}\\big(\\ln J\\big)^2,\n$$\n其中 $\\mu > 0$ 是剪切模量，$\\kappa > 0$ 是体积模量，且 $J = \\sqrt{\\det C}$。\n\n任务：\n- 仅从基本定义 $S = 2\\,\\partial \\Psi / \\partial C$ 和 $P = \\partial \\Psi / \\partial F$ 出发，使用链式法则和张量微积分推导关联这些热力学共轭对的运动学恒等式，即证明 $P = F S$，并建立功共轭等价关系 $P : \\dot{F} = S : \\dot{E}$，其中上标点表示物质时间导数，而 $A : B = \\operatorname{tr}(A^{\\mathsf{T}} B)$ 表示双点积。您的推导必须基于基本运动学关系 $C = F^{\\mathsf{T}} F$ 和 $E = \\tfrac{1}{2}(C - I)$，并且除了所述定义外，不得假定任何预知的应力-应变公式。\n- 实现一个程序，对于一组给定的测试用例，数值上验证：\n  1) 恒等式 $P = F S$，通过比较从 $\\Psi(F)$ 计算的 $P$ 和从 $\\Psi(C)$ 计算的 $F S$ 来实现，以及\n  2) 功共轭等式 $P : \\dot{F} = S : \\dot{E}$，使用 $\\dot{E} = \\tfrac{1}{2}(\\dot{F}^{\\mathsf{T}} F + F^{\\mathsf{T}} \\dot{F})$。\n  使用弗罗贝尼乌斯范数来衡量张量差异。将每次验证报告为一个布尔值，表示绝对误差是否低于指定的容差。\n- 所有量都是无量纲的；不要附加物理单位。不出现角度。不使用百分比。\n\n使用以下测试套件。每个测试用例指定了 $(\\mu, \\kappa, F, \\dot{F})$：\n- 测试用例 1 (一般大变形):\n  - $\\mu = 80.0$, $\\kappa = 240.0$,\n  - $F = \\begin{bmatrix} 1.30  0.40  0.00 \\\\ 0.20  0.90  0.10 \\\\ 0.00  0.05  1.20 \\end{bmatrix}$,\n  - $\\dot{F} = \\begin{bmatrix} 0.05  -0.02  0.00 \\\\ 0.03  0.01  -0.04 \\\\ 0.00  0.02  -0.01 \\end{bmatrix}$。\n- 测试用例 2 (准体积拉伸):\n  - $\\mu = 50.0$, $\\kappa = 500.0$,\n  - $F = \\begin{bmatrix} 1.05  0.00  0.00 \\\\ 0.00  1.05  0.00 \\\\ 0.00  0.00  1.05 \\end{bmatrix}$,\n  - $\\dot{F} = \\begin{bmatrix} 0.01  0.00  0.00 \\\\ 0.00  0.01  0.00 \\\\ 0.00  0.00  0.01 \\end{bmatrix}$。\n- 测试用例 3 (等体积类剪切变形):\n  - $\\mu = 30.0$, $\\kappa = 90.0$,\n  - $F = \\begin{bmatrix} 1.20  0.50  0.00 \\\\ 0.00  0.8333333333333334  0.00 \\\\ 0.00  0.00  1.00 \\end{bmatrix}$,\n  - $\\dot{F} = \\begin{bmatrix} 0.00  0.03  0.00 \\\\ 0.00  -0.02  0.00 \\\\ 0.00  0.00  0.00 \\end{bmatrix}$。\n- 测试用例 4 (近不可压缩混合加载):\n  - $\\mu = 60.0$, $\\kappa = 6000.0$,\n  - $F = \\begin{bmatrix} 0.80  0.00  0.00 \\\\ 0.00  1.25  0.00 \\\\ 0.00  0.00  1.02 \\end{bmatrix}$,\n  - $\\dot{F} = \\begin{bmatrix} -0.01  0.00  0.00 \\\\ 0.00  0.015  0.00 \\\\ 0.00  0.00  -0.002 \\end{bmatrix}$。\n- 测试用例 5 (正雅可比行列式的强各向异性拉伸):\n  - $\\mu = 70.0$, $\\kappa = 210.0$,\n  - $F = \\begin{bmatrix} 0.50  0.00  0.00 \\\\ 0.00  0.90  0.00 \\\\ 0.00  0.00  2.80 \\end{bmatrix}$,\n  - $\\dot{F} = \\begin{bmatrix} 0.02  0.00  0.00 \\\\ 0.00  -0.01  0.00 \\\\ 0.00  0.00  0.03 \\end{bmatrix}$。\n\n对每个测试用例，执行以下数值检验：\n- 使用 $S = 2\\,\\partial \\Psi / \\partial C$ 从 $\\Psi(C)$ 计算 $S$。\n- 使用 $P = \\partial \\Psi / \\partial F$ 从 $\\Psi(F)$ 计算 $P$。\n- 构建 $F S$ 并计算弗罗贝尼乌斯范数误差 $e_{1} = \\|P - F S\\|_{F}$。\n- 计算 $\\dot{E} = \\tfrac{1}{2}(\\dot{F}^{\\mathsf{T}} F + F^{\\mathsf{T}} \\dot{F})$，然后计算 $e_{2} = \\big|\\,P : \\dot{F} - S : \\dot{E}\\,\\big|$。\n\n对两个检验均使用容差 $\\varepsilon = 10^{-10}$。如果相应的误差小于或等于 $\\varepsilon$，则认为检验通过。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个逗号分隔的 Python 风格列表，长度为 $5$。列表中的每个元素是一个双元素列表 $[b_{1}, b_{2}]$，由布尔值组成，分别对应于该测试用例的 $(e_{1} \\le \\varepsilon)$ 和 $(e_{2} \\le \\varepsilon)$ 的通过/失败状态。例如：\"[[True,True],[True,True],[True,True],[True,True],[True,True]]\"。",
            "solution": "该问题是有效的，因为它科学地基于连续介质力学的原理，数学上是适定的、客观的，并为理论推导和数值验证提供了一套完整且一致的数据和定义。\n\n解答分为两部分。首先，提供了所需恒等式的理论推导。其次，概述了数值实现的逻辑，其中包括从给定的亥姆霍兹自由能函数推导具体的应力-应变关系。\n\n### 理论推导\n\n推导从第一和第二皮奥拉-基尔霍夫应力 $P$ 和 $S$ 关于亥姆霍茲自由能 $\\Psi$ 的基本定义出发。核心数学工具是张量值函数求导的链式法则。\n\n**1. 运动学恒等式 $P = F S$ 的推导**\n\n亥姆霍兹自由能 $\\Psi$ 是右柯西-格林张量 $C$ 的函数，即 $\\Psi = \\hat{\\Psi}(C)$。由于 $C$ 是变形梯度 $F$ 的函数，通过运动学关系 $C = F^{\\mathsf{T}} F$ 建立联系，因此 $\\Psi$ 也可以被视为 $F$ 的函数，即 $\\Psi(F) = \\hat{\\Psi}(C(F))$。\n\n第一皮奥拉-基尔霍夫应力张量 $P$ 定义为 $\\Psi$ 相对于 $F$ 的导数：\n$$\nP = \\frac{\\partial \\Psi}{\\partial F}\n$$\n这个关系意味着 $\\Psi$ 的微分可以写成 $d\\Psi = P : dF$，其中双点积定义为 $A : B = \\operatorname{tr}(A^{\\mathsf{T}} B)$。\n\n使用链式法则，我们可以将 $\\Psi$ 相对于 $F$ 的导数用其相对于 $C$ 的导数来表示：\n$$\nd\\Psi = \\frac{\\partial \\Psi}{\\partial C} : dC\n$$\n问题将第二皮奥拉-基尔霍夫应力张量 $S$ 定义为 $S = 2 \\frac{\\partial \\Psi}{\\partial C}$，这意味着 $\\frac{\\partial \\Psi}{\\partial C} = \\frac{1}{2} S$。将此代入 $d\\Psi$ 的表达式中得到：\n$$\nd\\Psi = \\frac{1}{2} S : dC\n$$\n接下来，我们求 $C$ 的微分：\n$$\nC = F^{\\mathsf{T}} F \\implies dC = d(F^{\\mathsf{T}}) F + F^{\\mathsf{T}} dF = (dF)^{\\mathsf{T}} F + F^{\\mathsf{T}} dF\n$$\n将 $dC$ 代入 $d\\Psi$ 的表达式中：\n$$\nd\\Psi = \\frac{1}{2} S : \\left( (dF)^{\\mathsf{T}} F + F^{\\mathsf{T}} dF \\right) = \\frac{1}{2} \\left[ S : ((dF)^{\\mathsf{T}} F) + S : (F^{\\mathsf{T}} dF) \\right]\n$$\n使用恒等式 $A:B = \\operatorname{tr}(A^{\\mathsf{T}}B)$ 以及 $S$ 是对称的 ($S = S^{\\mathsf{T}}$) 这一事实：\n$$\nd\\Psi = \\frac{1}{2} \\left[ \\operatorname{tr}(S^{\\mathsf{T}} (dF)^{\\mathsf{T}} F) + \\operatorname{tr}(S^{\\mathsf{T}} F^{\\mathsf{T}} dF) \\right] = \\frac{1}{2} \\left[ \\operatorname{tr}(S (dF)^{\\mathsf{T}} F) + \\operatorname{tr}(S F^{\\mathsf{T}} dF) \\right]\n$$\n使用迹算子的循环性质 $\\operatorname{tr}(ABC) = \\operatorname{tr}(BCA)$，第一项变为 $\\operatorname{tr}(S (dF)^{\\mathsf{T}} F) = \\operatorname{tr}(F S (dF)^{\\mathsf{T}})$。使用性质 $\\operatorname{tr}(A) = \\operatorname{tr}(A^{\\mathsf{T}})$，此项也等于 $\\operatorname{tr}((F S (dF)^{\\mathsf{T}})^{\\mathsf{T}}) = \\operatorname{tr}(dF S^{\\mathsf{T}} F^{\\mathsf{T}}) = \\operatorname{tr}(dF S F^{\\mathsf{T}})$。循环各项得到 $\\operatorname{tr}(S F^{\\mathsf{T}} dF)$。因此，括号中的两项是相同的：\n$$\n\\operatorname{tr}(S (dF)^{\\mathsf{T}} F) = \\operatorname{tr}(S F^{\\mathsf{T}} dF)\n$$\n因此，$d\\Psi$ 的表达式简化为：\n$$\nd\\Psi = \\frac{1}{2} \\left[ \\operatorname{tr}(S F^{\\mathsf{T}} dF) + \\operatorname{tr}(S F^{\\mathsf{T}} dF) \\right] = \\operatorname{tr}(S F^{\\mathsf{T}} dF)\n$$\n我们有两个关于 $d\\Psi$ 的表达式：\n$$\nd\\Psi = P : dF = \\operatorname{tr}(P^{\\mathsf{T}} dF) \\quad \\text{and} \\quad d\\Psi = \\operatorname{tr}(S F^{\\mathsf{T}} dF)\n$$\n由于该等式对于任意微分 $dF$ 都必须成立，所以前面的乘子必须相等：\n$$\nP^{\\mathsf{T}} = S F^{\\mathsf{T}}\n$$\n对两边进行转置得到 $P = (S F^{\\mathsf{T}})^{\\mathsf{T}} = F S^{\\mathsf{T}}$。由于 $C = C^{\\mathsf{T}}$，其功共轭变量 $S$ 也必须是对称的 ($S = S^{\\mathsf{T}}$)。因此，我们得到了所需的运动学恒等式：\n$$\nP = F S\n$$\n\n**2. 功共轭等价关系 $P : \\dot{F} = S : \\dot{E}$ 的推导**\n\n单位参考体积的物质功速率由功率密度 $\\mathcal{P} = P : \\dot{F}$ 给出。我们可以通过代入上面推导出的恒等式来证明此等价关系。\n从右侧 $S : \\dot{E}$ 开始，并使用给定的格林-拉格朗日应变率表达式 $\\dot{E} = \\frac{1}{2}(\\dot{F}^{\\mathsf{T}} F + F^{\\mathsf{T}} \\dot{F})$：\n$$\nS : \\dot{E} = S : \\left(\\frac{1}{2}(\\dot{F}^{\\mathsf{T}} F + F^{\\mathsf{T}} \\dot{F})\\right) = \\frac{1}{2} \\left( S : (\\dot{F}^{\\mathsf{T}} F) + S : (F^{\\mathsf{T}} \\dot{F}) \\right)\n$$\n使用迹表示法 $A:B = \\operatorname{tr}(A^{\\mathsf{T}}B)$ 和 $S = S^{\\mathsf{T}}$：\n$$\nS : \\dot{E} = \\frac{1}{2} \\left( \\operatorname{tr}(S \\dot{F}^{\\mathsf{T}} F) + \\operatorname{tr}(S F^{\\mathsf{T}} \\dot{F}) \\right)\n$$\n如前一节所述，$\\operatorname{tr}(S \\dot{F}^{\\mathsf{T}} F) = \\operatorname{tr}(S F^{\\mathsf{T}} \\dot{F})$。因此，\n$$\nS : \\dot{E} = \\frac{1}{2} \\left( \\operatorname{tr}(S F^{\\mathsf{T}} \\dot{F}) + \\operatorname{tr}(S F^{\\mathsf{T}} \\dot{F}) \\right) = \\operatorname{tr}(S F^{\\mathsf{T}} \\dot{F})\n$$\n现在，考虑左侧 $P : \\dot{F}$。使用迹表示法和恒等式 $P = FS$（这意味着 $P^{\\mathsf{T}} = S^{\\mathsf{T}} F^{\\mathsf{T}} = S F^{\\mathsf{T}}$）：\n$$\nP : \\dot{F} = \\operatorname{tr}(P^{\\mathsf{T}} \\dot{F}) = \\operatorname{tr}((S F^{\\mathsf{T}}) \\dot{F}) = \\operatorname{tr}(S F^{\\mathsf{T}} \\dot{F})\n$$\n比较两侧的结果，我们发现它们是相同的：\n$$\nP : \\dot{F} = \\operatorname{tr}(S F^{\\mathsf{T}} \\dot{F}) = S : \\dot{E}\n$$\n这就建立了功共轭等价关系。\n\n### 数值实现逻辑\n\n为了数值验证这些恒等式，我们必须从给定的亥姆霍茲自由能函数计算 $P$ 和 $S$：\n$$\n\\Psi(C) = \\frac{\\mu}{2}\\big(\\operatorname{tr} C - 3\\big) - \\mu \\ln J + \\frac{\\kappa}{2}\\big(\\ln J\\big)^2\n$$\n其中 $J = \\sqrt{\\det C}$。这可以利用 $\\ln J = \\frac{1}{2}\\ln(\\det C)$重写为：\n$$\n\\Psi(C) = \\frac{\\mu}{2}\\big(\\operatorname{tr} C - 3\\big) - \\frac{\\mu}{2} \\ln(\\det C) + \\frac{\\kappa}{8}\\big(\\ln(\\det C)\\big)^2\n$$\n\n**1. 计算第二皮奥拉-基尔霍夫应力 $S$**\n\n$S$ 使用其定义 $S = 2 \\frac{\\partial \\Psi}{\\partial C}$ 计算。我们需要 $\\Psi$ 中各项的张量导数：\n- $\\frac{\\partial (\\operatorname{tr} C)}{\\partial C} = I$ (单位张量)\n- $\\frac{\\partial (\\ln(\\det C))}{\\partial C} = (\\det C)^{-1} C^{-\\mathsf{T}} = C^{-1}$ (因为 $C$ 是对称的)\n\n应用这些法则：\n$$\n\\frac{\\partial \\Psi}{\\partial C} = \\frac{\\mu}{2}I - \\frac{\\mu}{2} C^{-1} + \\frac{\\kappa}{8} \\left( 2 \\ln(\\det C) \\cdot C^{-1} \\right) = \\frac{\\mu}{2}I + \\left( \\frac{\\kappa}{4}\\ln(\\det C) - \\frac{\\mu}{2} \\right) C^{-1}\n$$\n因此，$S = 2 \\frac{\\partial \\Psi}{\\partial C}$ 是：\n$$\nS = \\mu I + \\left( \\frac{\\kappa}{2}\\ln(\\det C) - \\mu \\right) C^{-1}\n$$\n由于 $J = \\sqrt{\\det C}$，$\\ln(\\det C) = 2 \\ln J$。代入此式可得到用于实现的最终表达式：\n$$\nS = \\mu I + (\\kappa \\ln J - \\mu) C^{-1}\n$$\n\n**2. 计算第一皮奥拉-基尔霍夫应力 $P$**\n\n$P$ 使用其定义 $P = \\frac{\\partial \\Psi}{\\partial F}$ 计算。我们将 $\\Psi$ 用 $F$ 表示：\n$$\n\\Psi(F) = \\frac{\\mu}{2}\\big(\\operatorname{tr}(F^{\\mathsf{T}}F) - 3\\big) - \\mu \\ln(\\det F) + \\frac{\\kappa}{2}\\big(\\ln(\\det F)\\big)^2\n$$\n我们需要 $\\Psi$ 中各项相对于 $F$ 的张量导数：\n- $\\frac{\\partial (\\operatorname{tr}(F^{\\mathsf{T}}F))}{\\partial F} = 2F$\n- $\\frac{\\partial (\\ln(\\det F))}{\\partial F} = F^{-\\mathsf{T}}$\n\n应用这些法则，令 $J = \\det F$：\n$$\nP = \\frac{\\partial \\Psi}{\\partial F} = \\frac{\\mu}{2}(2F) - \\mu F^{-\\mathsf{T}} + \\frac{\\kappa}{2} \\left( 2 \\ln J \\cdot F^{-\\mathsf{T}} \\right)\n$$\n这简化为用于实现的最终表达式：\n$$\nP = \\mu F + (\\kappa \\ln J - \\mu) F^{-\\mathsf{T}}\n$$\n作为一致性检查，我们可以用代数方法验证 $P = FS$ 是否成立：$F S = F(\\mu I + (\\kappa \\ln J - \\mu) C^{-1}) = \\mu F + (\\kappa \\ln J - \\mu) F C^{-1}$。由于 $C^{-1} = (F^{\\mathsf{T}}F)^{-1} = F^{-1}F^{-\\mathsf{T}}$，我们有 $F C^{-1} = F(F^{-1}F^{-\\mathsf{T}}) = F^{-\\mathsf{T}}$。这证实了 $F S = \\mu F + (\\kappa \\ln J - \\mu) F^{-\\mathsf{T}} = P$。\n\n数值程序将使用这些推导出的公式计算 $S$ 和 $P$，然后对每个测试用例验证恒等式 $P=FS$ 和 $P:\\dot{F} = S:\\dot{E}$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the computational solid mechanics problem by performing theoretical\n    derivations and numerical verifications for a compressible neo-Hookean material.\n    \"\"\"\n\n    # Define the tolerance for numerical checks.\n    tolerance = 1e-10\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (mu, kappa, F_matrix, F_dot_matrix)\n    test_cases = [\n        (80.0, 240.0,\n         np.array([[1.30, 0.40, 0.00],\n                   [0.20, 0.90, 0.10],\n                   [0.00, 0.05, 1.20]]),\n         np.array([[0.05, -0.02, 0.00],\n                   [0.03,  0.01, -0.04],\n                   [0.00,  0.02, -0.01]])),\n        (50.0, 500.0,\n         np.array([[1.05, 0.00, 0.00],\n                   [0.00, 1.05, 0.00],\n                   [0.00, 0.00, 1.05]]),\n         np.array([[0.01, 0.00, 0.00],\n                   [0.00, 0.01, 0.00],\n                   [0.00, 0.00, 0.01]])),\n        (30.0, 90.0,\n         np.array([[1.20, 0.50, 0.00],\n                   [0.00, 0.8333333333333334, 0.00],\n                   [0.00, 0.00, 1.00]]),\n         np.array([[0.00,  0.03, 0.00],\n                   [0.00, -0.02, 0.00],\n                   [0.00,  0.00, 0.00]])),\n        (60.0, 6000.0,\n         np.array([[0.80, 0.00, 0.00],\n                   [0.00, 1.25, 0.00],\n                   [0.00, 0.00, 1.02]]),\n         np.array([[-0.01,  0.00,  0.00],\n                   [ 0.00,  0.015, 0.00],\n                   [ 0.00,  0.00, -0.002]])),\n        (70.0, 210.0,\n         np.array([[0.50, 0.00, 0.00],\n                   [0.00, 0.90, 0.00],\n                   [0.00, 0.00, 2.80]]),\n         np.array([[0.02,  0.00, 0.00],\n                   [-0.00, -0.01, 0.00],\n                   [0.00,  0.00, 0.03]]))\n    ]\n\n    results = []\n    \n    # Process each test case\n    for mu, kappa, F, F_dot in test_cases:\n        # Basic kinematic quantities\n        J = np.linalg.det(F)\n        C = F.T @ F\n        I = np.eye(3)\n\n        # 1. Compute S from Psi(C)\n        # S = mu*I + (kappa*ln(J) - mu)*C_inv\n        # where ln(det(C)) = 2*ln(J)\n        C_inv = np.linalg.inv(C)\n        S = mu * I + (kappa * np.log(J) - mu) * C_inv\n        \n        # 2. Compute P from Psi(F)\n        # P = mu*F + (kappa*ln(J) - mu)*F_inv_T\n        F_inv_T = np.linalg.inv(F).T\n        P_from_psi = mu * F + (kappa * np.log(J) - mu) * F_inv_T\n        \n        # 3. Form P from S using P = F*S\n        P_from_S = F @ S\n        \n        # 4. Perform the first verification: check if P from Psi(F) equals F*S\n        error_1 = np.linalg.norm(P_from_psi - P_from_S, 'fro')\n        check_1 = error_1 = tolerance\n\n        # 5. Compute E_dot\n        E_dot = 0.5 * (F_dot.T @ F + F.T @ F_dot)\n        \n        # 6. Compute work rates P:F_dot and S:E_dot\n        # Double contraction A:B is tr(A.T @ B), which is equivalent to np.sum(A * B)\n        work_rate_P = np.sum(P_from_psi * F_dot)\n        work_rate_S = np.sum(S * E_dot)\n\n        # 7. Perform the second verification: check if work rates are equal\n        error_2 = np.abs(work_rate_P - work_rate_S)\n        check_2 = error_2 = tolerance\n\n        results.append([check_1, check_2])\n\n    # Format the final output as a single-line string\n    # e.g., [[True,True],[True,True],...]\n    output_str = \"[\" + \",\".join(map(str, results)) + \"]\"\n    \n    # Final print statement in the exact required format.\n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "物质标架无关性原理（客观性原理）要求本构律及内功率等物理量独立于观察者的刚体运动。本动手练习将在空间描述（Euler描述）中阐释此原理，展示内功率必须通过对称的Cauchy应力（$\\tau$）与其共轭对——变形率张量（$D$）——进行缩并来计算。通过有意引入一个非客观的污染项并使用完整的速度梯度（$L$），您将量化由此产生的误差，从而清晰地揭示正确选取热力学共轭对的重要性。",
            "id": "3606689",
            "problem": "考虑一个经历简单剪切和叠加刚体旋转的二维平面应变连续体。设空间坐标为 $(x,y)$（单位：米），并考虑一个速度场 $\\boldsymbol{v}(x,y)$，它由速率为 $\\dot{\\gamma}$ 的 $x$ 方向简单剪切与绕平面外轴以角速度 $\\omega$（单位：弧度/秒）进行的刚体旋转叠加而成。该速度场为\n$$\n\\boldsymbol{v}(x,y) = \\begin{bmatrix} \\dot{\\gamma}\\,y \\\\ 0 \\end{bmatrix} + \\begin{bmatrix} -\\omega\\,y \\\\ \\omega\\,x \\end{bmatrix}.\n$$\n速度梯度 $\\boldsymbol{L}$、变形率（对称）张量 $\\boldsymbol{D}$ 和自旋（反对称）张量 $\\boldsymbol{W}$ 的定义如下\n$$\n\\boldsymbol{L} = \\nabla \\boldsymbol{v}, \\quad \\boldsymbol{D} = \\tfrac{1}{2}\\left(\\boldsymbol{L} + \\boldsymbol{L}^{\\mathsf{T}}\\right), \\quad \\boldsymbol{W} = \\tfrac{1}{2}\\left(\\boldsymbol{L} - \\boldsymbol{L}^{\\mathsf{T}}\\right).\n$$\n假设一个线性粘性类固体的响应（牛顿有效行为），其动态粘度为 $\\mu$（单位：帕斯卡·秒），其中 Cauchy 应力 $\\boldsymbol{\\tau}$ 由下式给出\n$$\n\\boldsymbol{\\tau} = 2\\,\\mu\\,\\boldsymbol{D}.\n$$\n为了诊断功共轭性的违背情况，引入一种形式如下的伪非客观污染到计算出的应力中\n$$\n\\boldsymbol{\\tau}_{\\text{bad}} = \\boldsymbol{\\tau} + s\\,\\boldsymbol{W},\n$$\n其中 $s = \\beta\\,\\mu$，$\\beta$ 是一个无量纲参数。单位体积的内机械功率定义为应力与相应的运动学速率的双点積（Frobenius 内积）。使用上述定义，为每个测试案例计算：\n- 使用正确的共轭对应项得到的基准内功率，\n$$\np_{\\text{correct}} = \\boldsymbol{\\tau} : \\boldsymbol{D},\n$$\n单位为瓦特/立方米 ($\\mathrm{W/m^3}$)。\n- 因错误使用而得到的内功率，该错误用法是将受污染的应力与全速度梯度进行缩并，\n$$\np_{\\text{wrong}} = \\boldsymbol{\\tau}_{\\text{bad}} : \\boldsymbol{L},\n$$\n单位为瓦特/立方米 ($\\mathrm{W/m^3}$)。\n- 绝对偏差\n$$\n\\Delta p = \\left|p_{\\text{wrong}} - p_{\\text{correct}}\\right|,\n$$\n单位为瓦特/立方米 ($\\mathrm{W/m^3}$)。\n\n您的任务是编写一个完整、可运行的程序，针对以下测试套件，从 $\\boldsymbol{v}(x,y)$ 解析计算（因为该场是线性的）$\\boldsymbol{L}$、$\\boldsymbol{D}$、$\\boldsymbol{W}$，利用给定参数构建 $\\boldsymbol{\\tau}$ 和 $\\boldsymbol{\\tau}_{\\text{bad}}$，评估 $p_{\\text{correct}}$、$p_{\\text{wrong}}$，并为每个案例输出 $\\Delta p$。使用指定的物理单位：$\\dot{\\gamma}$ 单位为 1/秒 ($\\mathrm{s^{-1}}$)，$\\omega$ 单位为 弧度/秒 ($\\mathrm{rad/s}$)，$\\mu$ 单位为 帕斯卡·秒 ($\\mathrm{Pa\\cdot s}$)，$\\Delta p$ 单位为 瓦特/立方米 ($\\mathrm{W/m^3}$)。角度以弧度为单位指定。\n\n测试套件（每个元组为 $(\\dot{\\gamma},\\ \\omega,\\ \\mu,\\ \\beta)$）：\n- 案例 1：$(10,\\ 0,\\ 100,\\ 0.2)$\n- 案例 2：$(10,\\ 5,\\ 100,\\ 0.2)$\n- 案例 3：$(0,\\ 7,\\ 100,\\ 0.2)$\n- 案例 4：$(2,\\ 50,\\ 100,\\ 0.2)$\n\n科学真实性：在一个没有力偶应力的连续体中，Cauchy 应力 $\\boldsymbol{\\tau}$ 必须保持对称；由数值污染引入的任何反对称分量都模拟了对角动量平衡的违背，并且在与 $\\boldsymbol{L}$ 而非 $\\boldsymbol{D}$ 进行缩并时会表现为偏差。\n\n最终输出格式：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，按上述测试套件的顺序排列结果，其中每个条目是该案例的绝对偏差 $\\Delta p$，单位为 $\\mathrm{W/m^3}$，例如，\n$$\n[\\Delta p_1,\\Delta p_2,\\Delta p_3,\\Delta p_4].\n$$\n不应打印任何其他文本。",
            "solution": "用户提供的问题被评估为有效。\n\n### 第 1 步：提取已知条件\n- **速度场**：$\\boldsymbol{v}(x,y) = \\begin{bmatrix} \\dot{\\gamma}\\,y \\\\ 0 \\end{bmatrix} + \\begin{bmatrix} -\\omega\\,y \\\\ \\omega\\,x \\end{bmatrix}$\n- **速度梯度**：$\\boldsymbol{L} = \\nabla \\boldsymbol{v}$\n- **变形率张量**：$\\boldsymbol{D} = \\tfrac{1}{2}\\left(\\boldsymbol{L} + \\boldsymbol{L}^{\\mathsf{T}}\\right)$\n- **自旋张量**：$\\boldsymbol{W} = \\tfrac{1}{2}\\left(\\boldsymbol{L} - \\boldsymbol{L}^{\\mathsf{T}}\\right)$\n- **本构关系（Cauchy 应力）**：$\\boldsymbol{\\tau} = 2\\,\\mu\\,\\boldsymbol{D}$\n- **受污染的应力**：$\\boldsymbol{\\tau}_{\\text{bad}} = \\boldsymbol{\\tau} + s\\,\\boldsymbol{W}$，其中 $s = \\beta\\,\\mu$\n- **正确的内功率**：$p_{\\text{correct}} = \\boldsymbol{\\tau} : \\boldsymbol{D}$\n- **不正确的内功率**：$p_{\\text{wrong}} = \\boldsymbol{\\tau}_{\\text{bad}} : \\boldsymbol{L}$\n- **绝对偏差**：$\\Delta p = \\left|p_{\\text{wrong}} - p_{\\text{correct}}\\right|$\n- **参数**：剪切率 $\\dot{\\gamma}$ ($\\mathrm{s^{-1}}$)，角速度 $\\omega$ ($\\mathrm{rad/s}$)，动态粘度 $\\mu$ ($\\mathrm{Pa\\cdot s}$)，无量纲参数 $\\beta$。\n- **测试套件**：\n  - 案例 1：$(\\dot{\\gamma},\\ \\omega,\\ \\mu,\\ \\beta) = (10,\\ 0,\\ 100,\\ 0.2)$\n  - 案例 2：$(\\dot{\\gamma},\\ \\omega,\\ \\mu,\\ \\beta) = (10,\\ 5,\\ 100,\\ 0.2)$\n  - 案例 3：$(\\dot{\\gamma},\\ \\omega,\\ \\mu,\\ \\beta) = (0,\\ 7,\\ 100,\\ 0.2)$\n  - 案例 4：$(\\dot{\\gamma},\\ \\omega,\\ \\mu,\\ \\beta) = (2,\\ 50,\\ 100,\\ 0.2)$\n\n### 第 2 步：使用提取的已知条件进行验证\n问题是**有效的**。\n- **科学依据**：该问题设置在连续介质力学的标准框架内。$\\boldsymbol{L}$、$\\boldsymbol{D}$、$\\boldsymbol{W}$ 的定义以及线性粘性流体的本构法则是基本概念。$\\boldsymbol{\\tau}_{\\text{bad}}$ 的引入是一种教学工具，用于演示违背物质坐标系无关性（客观性）原理和功共轭性的后果，这是力学教育中合法且常见的做法。问题陈述中的“科学真实性”注释正确地指出了这种污染的物理意义。\n- **适定性**：该问题是确定性的。对于每组输入参数，要计算的量都通过一系列明确的代数运算唯一定义。每个测试案例都存在唯一解。\n- **客观性**：该问题使用连续介质力学中的精确、标准术语陈述，没有主观性或歧义。\n- **自洽与一致性**：提供了所有必要的方程、定义和数据。单位是一致的：功率密度的计算结果为 $\\mathrm{(Pa\\cdot s) \\cdot (s^{-1}) \\cdot (s^{-1}) = Pa \\cdot s^{-1} = (N/m^2) \\cdot s^{-1} = (J/m^3) \\cdot s^{-1} = W/m^3}$，与要求的输出单位相符。\n\n### 第 3 步：结论与行动\n问题有效，将提供解决方案。\n\n目标是计算正确计算的内功率密度与错误计算的内功率密度之间的绝对偏差 $\\Delta p$。该偏差源于應力張量的非客观污染。解析推导过程如下。\n\n首先，我们确定速度梯度张量 $\\boldsymbol{L}$。速度场由 $\\boldsymbol{v}(x,y) = [v_x, v_y]^{\\mathsf{T}} = [(\\dot{\\gamma}-\\omega)y, \\omega x]^{\\mathsf{T}}$ 给出。速度梯度 $\\boldsymbol{L}$ 的分量为 $L_{ij} = \\partial v_i / \\partial x_j$，其表达式为：\n$$\nL_{11} = \\frac{\\partial v_x}{\\partial x} = 0, \\quad L_{12} = \\frac{\\partial v_x}{\\partial y} = \\dot{\\gamma} - \\omega\n$$\n$$\nL_{21} = \\frac{\\partial v_y}{\\partial x} = \\omega, \\quad L_{22} = \\frac{\\partial v_y}{\\partial y} = 0\n$$\n因此，速度梯度张量在整个域中是恒定的：\n$$\n\\boldsymbol{L} = \\begin{bmatrix} 0  \\dot{\\gamma} - \\omega \\\\ \\omega  0 \\end{bmatrix}\n$$\n接下来，我们将 $\\boldsymbol{L}$ 分解为其对称部分（变形率张量 $\\boldsymbol{D}$）和其反对称部分（自旋张量 $\\boldsymbol{W}$）。\n$$\n\\boldsymbol{D} = \\frac{1}{2}(\\boldsymbol{L} + \\boldsymbol{L}^{\\mathsf{T}}) = \\frac{1}{2}\\left( \\begin{bmatrix} 0  \\dot{\\gamma} - \\omega \\\\ \\omega  0 \\end{bmatrix} + \\begin{bmatrix} 0  \\omega \\\\ \\dot{\\gamma} - \\omega  0 \\end{bmatrix} \\right) = \\frac{1}{2} \\begin{bmatrix} 0  \\dot{\\gamma} \\\\ \\dot{\\gamma}  0 \\end{bmatrix}\n$$\n$$\n\\boldsymbol{W} = \\frac{1}{2}(\\boldsymbol{L} - \\boldsymbol{L}^{\\mathsf{T}}) = \\frac{1}{2}\\left( \\begin{bmatrix} 0  \\dot{\\gamma} - \\omega \\\\ \\omega  0 \\end{bmatrix} - \\begin{bmatrix} 0  \\omega \\\\ \\dot{\\gamma} - \\omega  0 \\end{bmatrix} \\right) = \\frac{1}{2} \\begin{bmatrix} 0  \\dot{\\gamma} - 2\\omega \\\\ -(\\dot{\\gamma} - 2\\omega)  0 \\end{bmatrix}\n$$\n线性粘性材料的 Cauchy 应力 $\\boldsymbol{\\tau}$ 由 $\\boldsymbol{\\tau} = 2\\mu\\boldsymbol{D}$ 给出：\n$$\n\\boldsymbol{\\tau} = 2\\mu \\left( \\frac{1}{2} \\begin{bmatrix} 0  \\dot{\\gamma} \\\\ \\dot{\\gamma}  0 \\end{bmatrix} \\right) = \\mu \\begin{bmatrix} 0  \\dot{\\gamma} \\\\ \\dot{\\gamma}  0 \\end{bmatrix}\n$$\n正确的内功率是 Cauchy 应力与变形率张量的双点积，$p_{\\text{correct}} = \\boldsymbol{\\tau} : \\boldsymbol{D}$。这种配对是热力学所要求的，并确保了客观性，因为对于此材料模型，$\\boldsymbol{\\tau}$ 和 $\\boldsymbol{D}$ 都是客观张量。\n$$\np_{\\text{correct}} = \\left( \\mu \\begin{bmatrix} 0  \\dot{\\gamma} \\\\ \\dot{\\gamma}  0 \\end{bmatrix} \\right) : \\left( \\frac{1}{2} \\begin{bmatrix} 0  \\dot{\\gamma} \\\\ \\dot{\\gamma}  0 \\end{bmatrix} \\right) = \\mu \\left( \\frac{\\dot{\\gamma}^2}{2} + \\frac{\\dot{\\gamma}^2}{2} \\right) = \\mu \\dot{\\gamma}^2\n$$\n不正确的功率计算使用了受污染的应力 $\\boldsymbol{\\tau}_{\\text{bad}} = \\boldsymbol{\\tau} + s\\boldsymbol{W}$（其中 $s = \\beta\\mu$）与全速度梯度 $\\boldsymbol{L}$ 进行缩并。\n$$\np_{\\text{wrong}} = \\boldsymbol{\\tau}_{\\text{bad}} : \\boldsymbol{L} = (\\boldsymbol{\\tau} + s\\boldsymbol{W}) : (\\boldsymbol{D} + \\boldsymbol{W})\n$$\n展开双点积：\n$$\np_{\\text{wrong}} = \\boldsymbol{\\tau}:\\boldsymbol{D} + \\boldsymbol{\\tau}:\\boldsymbol{W} + s\\boldsymbol{W}:\\boldsymbol{D} + s\\boldsymbol{W}:\\boldsymbol{W}\n$$\n这里，我们使用一个性质：对称张量（如 $\\boldsymbol{\\tau}$ 和 $\\boldsymbol{D}$）与反对称张量（如 $\\boldsymbol{W}$）的双点积恒为零。因此，$\\boldsymbol{\\tau}:\\boldsymbol{W} = 0$ 且 $\\boldsymbol{W}:\\boldsymbol{D} = 0$。$p_{\\text{wrong}}$ 的表达式简化为：\n$$\np_{\\text{wrong}} = \\boldsymbol{\\tau}:\\boldsymbol{D} + s\\boldsymbol{W}:\\boldsymbol{W} = p_{\\text{correct}} + s\\boldsymbol{W}:\\boldsymbol{W}\n$$\n因此，功率计算的偏差为 $\\Delta p = |p_{\\text{wrong}} - p_{\\text{correct}}| = |s\\boldsymbol{W}:\\boldsymbol{W}|$。这表明误差恰好是应力的非物理、非客观部分 ($s\\boldsymbol{W}$) 在运动学的非客观部分 ($\\boldsymbol{W}$) 上所做的功。\n我们来计算 $\\boldsymbol{W}:\\boldsymbol{W}$：\n$$\n\\boldsymbol{W}:\\boldsymbol{W} = \\left( \\frac{1}{2} \\right)^2 \\left( 0^2 + (\\dot{\\gamma} - 2\\omega)^2 + (-(\\dot{\\gamma} - 2\\omega))^2 + 0^2 \\right) = \\frac{1}{4} \\left( 2 (\\dot{\\gamma} - 2\\omega)^2 \\right) = \\frac{1}{2}(\\dot{\\gamma} - 2\\omega)^2\n$$\n将此代入偏差的表达式，并注意到 $s=\\beta\\mu$ 且其他项均为非负，我们得到绝对偏差的最终解析公式：\n$$\n\\Delta p = |s\\boldsymbol{W}:\\boldsymbol{W}| = \\beta\\mu \\left( \\frac{1}{2}(\\dot{\\gamma} - 2\\omega)^2 \\right) = \\frac{\\beta\\mu}{2}(\\dot{\\gamma} - 2\\omega)^2\n$$\n该公式将为每个测试案例实现。根据提示的要求，实现过程将执行完整的矩阵计算以明确地演示该过程。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the absolute deviation in power density for several test cases\n    of a 2D continuum undergoing simple shear and rigid rotation.\n    \"\"\"\n    # Test suite (each tuple is (gamma_dot, omega, mu, beta))\n    test_cases = [\n        (10.0, 0.0, 100.0, 0.2),  # Case 1\n        (10.0, 5.0, 100.0, 0.2),  # Case 2\n        (0.0, 7.0, 100.0, 0.2),   # Case 3\n        (2.0, 50.0, 100.0, 0.2),  # Case 4\n    ]\n\n    results = []\n    for case in test_cases:\n        gamma_dot, omega, mu, beta = case\n\n        # Analytically compute the velocity gradient tensor L, which is constant.\n        # L_ij = dv_i / dx_j\n        # v_x = gamma_dot*y - omega*y = (gamma_dot - omega)*y\n        # v_y = omega*x\n        # L = [[0, gamma_dot - omega], [omega, 0]]\n        L = np.array([\n            [0.0, gamma_dot - omega],\n            [omega, 0.0]\n        ])\n\n        # Decompose L into symmetric (D) and skew-symmetric (W) parts.\n        D = 0.5 * (L + L.T)  # Rate-of-deformation tensor\n        W = 0.5 * (L - L.T)  # Spin tensor\n\n        # Compute the Cauchy stress tensor tau for a linear viscous solid.\n        # tau = 2 * mu * D\n        tau = 2.0 * mu * D\n        \n        # Compute the spurious non-objective contamination factor s.\n        s = beta * mu\n\n        # Compute the contaminated stress tensor tau_bad.\n        # tau_bad = tau + s * W\n        tau_bad = tau + s * W\n\n        # The double dot product A:B is implemented as the sum of the\n        # element-wise product of the matrices, np.sum(A * B).\n\n        # Compute the correct internal power density.\n        # p_correct = tau : D\n        p_correct = np.sum(tau * D)\n\n        # Compute the incorrect internal power density.\n        # p_wrong = tau_bad : L\n        p_wrong = np.sum(tau_bad * L)\n\n        # Compute the absolute deviation.\n        delta_p = abs(p_wrong - p_correct)\n        \n        results.append(delta_p)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "热力学一致性原理不仅是理论构建，也是在数据驱动科学时代开发稳健、具备物理合理性模型的关键约束。这项高级实践将引导您为热弹性材料构建一个基于机器学习的本构模型，并比较一个“构造即一致”的模型（从一个可学习的势函数导出输出）与一个直接映射模型。您将度量其热力学不自洽性，从而展示功共轭概念如何作为物理信息机器学习中一个强大的架构原则。",
            "id": "3606695",
            "problem": "考虑小应变、平面应变热弹性问题，其中 Green-Lagrange 应变张量由对称张量 $E \\in \\mathbb{R}^{2 \\times 2}$ 近似，温度通过偏差 $\\tau = \\theta - \\theta_{0}$ 体现。超弹性、热弹性材料由 Helmholtz 自由能密度 $\\psi(E,\\theta)$ 表征，使得热力学共轭对满足 $S = \\partial \\psi / \\partial E$ 和 $\\eta = - \\partial \\psi / \\partial \\theta$，其中 $S$ 是第二 Piola-Kirchhoff 应力，$\\eta$ 是熵密度。强制实现热力学一致性的 Maxwell 关系源于关于混合偏导数相等的 Schwarz 定理，写作 $\\partial S/\\partial \\theta + \\partial \\eta/\\partial E = 0$。在机器学习背景下，如果一个本构模型的预测应力和熵是某个标量势的相应共轭梯度，那么该模型在构造上就是热力学一致的。\n\n您的任务是实现一个程序，从一个已知但对学习器隐藏的自由能密度生成的合成数据中学习两个模型，然后评估其热力学一致性和预测准确性：\n\n- 模型 A（基于势）：一个标量自由能拟设 $\\psi_{w}(E,\\theta)$，在一组标量基函数中进行线性参数化。预测值 $S_{w}$ 和 $\\eta_{w}$ 通过 $S_{w}=\\partial \\psi_{w}/\\partial E$ 和 $\\eta_{w}=-\\partial \\psi_{w}/\\partial \\theta$ 获得。此模型在构造上是热力学一致的。\n\n- 模型 B（直接映射）：独立的线性映射直接从由 $(E,\\theta)$ 构建的特征向量预测 $S$ 和 $\\eta$ 的分量，而不保证它们源自单一的势。此模型可能违背热力学一致性，我们将对其进行测量，并在训练中通过正则化项进行惩罚。\n\n本问题中的所有量都已通过特征尺度进行了无量纲化，因此不出现物理单位。最终要求的输出是无量纲的浮点数。\n\n基本原理与数据生成。使用以下经过充分检验的本构事实来为您的设计提供基础：超弹性要求 $S = \\partial \\psi/\\partial E$，$\\eta = -\\partial \\psi/\\partial \\theta$，并且 Maxwell 对称性意味着 $\\partial S/\\partial \\theta + \\partial \\eta/\\partial E = 0$。从一个形为\n$$\n\\psi_{\\mathrm{gt}}(E,\\theta) = \\tfrac{1}{2}\\lambda\\left(\\mathrm{tr}\\,E\\right)^{2} + \\mu\\,\\mathrm{tr}\\!\\left(E^{2}\\right) + \\tfrac{1}{2}c\\,\\tau^{2} + \\alpha\\,\\tau\\,\\mathrm{tr}\\,E,\n$$\n的强凸二次自由能密度合成训练和验证数据，其参数为 $\\lambda = 2.0$，$\\mu = 3.0$，$c = 0.5$，$\\alpha = 0.2$，以及 $\\tau = \\theta - \\theta_{0}$。对于平面应变，$E$ 是对称的，具有独立分量 $E_{11}$，$E_{22}$，$E_{12}=E_{21}$。通过从 $[-e_{\\max},e_{\\max}]$ 中独立且均匀地抽取 $E_{11}$、$E_{22}$、$E_{12}$，并从 $[-t_{\\max},t_{\\max}]$ 中均匀地抽取 $\\tau$，来随机抽样训练和验证的状态集 $(E,\\tau)$，其中 $e_{\\max} = 0.02$ 且 $t_{\\max} = 0.1$。对于每个抽样状态，通过共轭定义从 $\\psi_{\\mathrm{gt}}$ 计算 $S_{\\mathrm{gt}}$ 和 $\\eta_{\\mathrm{gt}}$。\n\n模型 A 设计。使用标量势拟设\n$$\n\\psi_{w}(E,\\theta) = \\tfrac{1}{2}w_{1}\\left(\\mathrm{tr}\\,E\\right)^{2} + w_{2}\\,\\mathrm{tr}\\!\\left(E^{2}\\right) + \\tfrac{1}{2}w_{3}\\,\\tau^{2} + w_{4}\\,\\tau\\,\\mathrm{tr}\\,E.\n$$\n根据基本定义，$S_{w} = \\partial \\psi_{w}/\\partial E$ 且 $\\eta_{w} = -\\partial \\psi_{w}/\\partial \\theta$。确定将 $w = (w_{1},w_{2},w_{3},w_{4})$ 映射到任意状态 $(E,\\tau)$ 下 $S_{w}$ 和 $\\eta_{w}$ 预测分量的线性关系，并通过最小二乘法将 $w$ 拟合到从训练集计算的 $(S_{\\mathrm{gt}},\\eta_{\\mathrm{gt}})$。\n\n模型 B 设计。定义特征向量\n$$\ng(E,\\tau) = \\begin{bmatrix} \\mathrm{tr}\\,E \\\\ E_{11} \\\\ E_{22} \\\\ E_{12} \\\\ \\tau \\\\ 1 \\end{bmatrix}\\!,\n$$\n并预测\n$$\nS_{11} = a_{11}^{\\top} g,\\quad S_{22} = a_{22}^{\\top} g,\\quad S_{12} = a_{12}^{\\top} g,\\quad \\eta = b^{\\top} g,\n$$\n其中系数向量 $a_{11},a_{22},a_{12},b \\in \\mathbb{R}^{6}$ 是独立的。通过最小化一个正则化经验风险来训练此模型，该风险增加了一个由非负标量 $\\gamma$ 加权的热力学违背惩罚项。使用 $\\partial g/\\partial E_{11} = [1,1,0,0,0,0]^{\\top}$，$\\partial g/\\partial E_{22} = [1,0,1,0,0,0]^{\\top}$，$\\partial g/\\partial E_{12} = [0,0,0,1,0,0]^{\\top}$，以及 $\\partial g/\\partial \\theta = [0,0,0,0,1,0]^{\\top}$，定义为实现精确热力学一致性而必须为零的线性化残差：\n- 力学交叉偏导对称性残差：\n$$\nR_{11,22} = a_{11}^{\\top}\\tfrac{\\partial g}{\\partial E_{22}} - a_{22}^{\\top}\\tfrac{\\partial g}{\\partial E_{11}},\\quad\nR_{11,12} = a_{11}^{\\top}\\tfrac{\\partial g}{\\partial E_{12}} - a_{12}^{\\top}\\tfrac{\\partial g}{\\partial E_{11}},\\quad\nR_{22,12} = a_{22}^{\\top}\\tfrac{\\partial g}{\\partial E_{12}} - a_{12}^{\\top}\\tfrac{\\partial g}{\\partial E_{22}}.\n$$\n- 热学 Maxwell 残差：\n$$\nM_{11} = a_{11}^{\\top}\\tfrac{\\partial g}{\\partial \\theta} + b^{\\top}\\tfrac{\\partial g}{\\partial E_{11}},\\quad\nM_{22} = a_{22}^{\\top}\\tfrac{\\partial g}{\\partial \\theta} + b^{\\top}\\tfrac{\\partial g}{\\partial E_{22}},\\quad\nM_{12} = a_{12}^{\\top}\\tfrac{\\partial g}{\\partial \\theta} + b^{\\top}\\tfrac{\\partial g}{\\partial E_{12}}.\n$$\n定义标量违背度量\n$$\nV = \\sqrt{R_{11,22}^{2} + R_{11,12}^{2} + R_{22,12}^{2} + M_{11}^{2} + M_{22}^{2} + M_{12}^{2}}.\n$$\n通过最小化目标函数来训练模型 B：\n$$\n\\mathcal{L}_{\\gamma} = \\frac{1}{N}\\sum_{n=1}^{N}\\left(\\|S_{\\mathrm{pred}}^{(n)} - S_{\\mathrm{gt}}^{(n)}\\|_{F}^{2} + \\left(\\eta_{\\mathrm{pred}}^{(n)} - \\eta_{\\mathrm{gt}}^{(n)}\\right)^{2}\\right) + \\gamma V^{2},\n$$\n其中 $N$ 是训练样本的数量，$\\|\\cdot\\|_{F}$ 表示 Frobenius 范数。\n\n评估指标。在一个独立的验证集上，为每个模型计算相对均方根误差\n$$\n\\mathrm{RelRMSE} = \\sqrt{\\frac{\\sum_{m}\\left(\\|S_{\\mathrm{pred}}^{(m)} - S_{\\mathrm{gt}}^{(m)}\\|_{F}^{2} + \\left(\\eta_{\\mathrm{pred}}^{(m)} - \\eta_{\\mathrm{gt}}^{(m)}\\right)^{2}\\right)}{\\sum_{m}\\left(\\|S_{\\mathrm{gt}}^{(m)}\\|_{F}^{2} + \\left(\\eta_{\\mathrm{gt}}^{(m)}\\right)^{2}\\right)}},\n$$\n以及上面定义的热力学违背度量 $V$。此外，通过计算组合范数来评估在 $E=0$ 和 $\\tau=0$ 时的边界状态检验\n$$\nN_{0} = \\sqrt{\\|S_{\\mathrm{pred}}\\|_{F}^{2} + \\eta_{\\mathrm{pred}}^{2}}\\quad\\text{在}\\quad E=0,\\ \\tau=0,\n$$\n并通过报告 $S_{12}$ 中的相对误差，来评估在 $E_{11}=0$，$E_{22}=0$，$E_{12}=\\gamma_{s}/2$，$\\tau=0$ 且 $\\gamma_{s} = 0.04$ 时的纯剪切检验。\n\n实现与测试套件。您的程序必须：\n- 使用 $N_{\\mathrm{train}} = 200$，$N_{\\mathrm{val}} = 100$，$e_{\\max} = 0.02$，$t_{\\max} = 0.1$，固定的随机种子 $42$，以及基准真值参数 $\\lambda = 2.0$，$\\mu = 3.0$，$c = 0.5$，$\\alpha = 0.2$ 来生成训练和验证数据。\n- 在训练数据上训练模型 A，并在验证数据上进行评估。\n- 使用正则化权重 $\\gamma \\in \\{0.0, 0.01, 1.0\\}$ 训练模型 B 三次，并在验证数据上进行评估。\n- 按此精确顺序计算以下十个标量结果：\n    $1.$ 模型 A 的 $V$ 值，\n    $2.$ 模型 A 的 $\\mathrm{RelRMSE}$ 值，\n    $3.$ $\\gamma = 0.0$ 时模型 B 的 $V$ 值，\n    $4.$ $\\gamma = 0.0$ 时模型 B 的 $\\mathrm{RelRMSE}$ 值，\n    $5.$ $\\gamma = 0.01$ 时模型 B 的 $V$ 值，\n    $6.$ $\\gamma = 0.01$ 时模型 B 的 $\\mathrm{RelRMSE}$ 值，\n    $7.$ $\\gamma = 1.0$ 时模型 B 的 $V$ 值，\n    $8.$ $\\gamma = 1.0$ 时模型 B 的 $\\mathrm{RelRMSE}$ 值，\n    $9.$ 模型 A 的 $N_{0}$ 值，\n    $10.$ 在 $\\gamma_{s} = 0.04$ 的纯剪切条件下，模型 A 在 $S_{12}$ 上的相对误差。\n所有输出均为无量纲。\n\n最终输出格式。您的程序应生成单行输出，包含一个由方括号括起来的逗号分隔的结果列表，其中每个浮点数四舍五入到六位小数，例如 $[x_{1},x_{2},\\dots,x_{10}]$，其中每个 $x_{k}$ 都四舍五入到六位小数。不允许有其他输出。",
            "solution": "用户希望解决一个计算热弹性力学领域的问题，重点比较热力学一致的本构模型与可能不一致的模型。\n\n### 问题验证\n\n问题陈述已经过严格审查，被认为是有效的。\n\n1.  **已知条件提取**：所有必要的物理关系、模型定义、参数（$\\lambda, \\mu, c, \\alpha$）、数据生成规范（$N_{\\text{train}}, N_{\\text{val}}, e_{\\max}, t_{\\max}$，随机种子）和评估指标（$\\mathrm{RelRMSE}, V, N_0$，纯剪切误差）都已明确提供。\n2.  **科学依据**：该问题植根于标准的连续介质热弹性理论。Helmholtz 自由能 $\\psi$、热力学共轭对（$S=\\partial\\psi/\\partial E$, $\\eta=-\\partial\\psi/\\partial\\theta$）和 Maxwell 关系等概念都得到了正确陈述。使用基于势的模型（模型 A）与直接数据驱动的映射（模型 B）来阐释热力学一致性，是物理学启发的机器学习中的一个标准且重要的课题。\n3.  **适定性与一致性**：\n    *   基准真值本构模型是一个标准的线性各向同性热弹性材料，所提供的应力 $S_{\\mathrm{gt}}$ 和熵 $\\eta_{\\mathrm{gt}}$ 的表达式是给定自由能 $\\psi_{\\mathrm{gt}}$ 的正确导数。\n    *   模型 A 基于一个势 $\\psi_w$ 构建，其函数形式包含了基准真值势，确保其原则上可以完美地表示数据。其参数 $w$ 的拟合是一个标准的线性最小二乘问题。\n    *   模型 B 使用从特征到输出的直接线性映射。训练目标 $\\mathcal{L}_{\\gamma}$ 是一个正则化的最小二乘损失。惩罚项 $\\gamma V^2$ 基于残差（$R_{ij,kl}, M_{ij}$），这些残差正确地表示了热力学一致性的条件（势的存在性和 Maxwell 对称性）。最小化 $\\mathcal{L}_{\\gamma}$ 是一个适定的二次优化问题。\n    *   虽然问题中对对称张量的符号表示 $\\partial/\\partial E$ 略有模糊，但所提供的基准真值应力-应变关系是明确的。这些关系与用于模型 B 的热力学违背残差的定义一致，使得问题内部一致且可解。\n4.  **可行性**：任务涉及生成数据、求解线性最小二乘问题（对于模型 A）和正则化线性最小二乘问题（对于模型 B），以及评估明确定义的指标。所有步骤都可以使用标准数值库在计算上实现。\n\n该问题是有效的，可以构建详细的解决方案。\n\n### 求解推导\n\n求解过程遵循问题陈述中详述的步骤。\n\n**1. 数据生成**\n通过抽样应变分量 $E_{11}, E_{22}, E_{12}$ 和温度偏差 $\\tau$，创建训练（$N_{\\mathrm{train}}=200$）和验证（$N_{\\mathrm{val}}=100$）数据集。对于每个状态 $(E, \\tau)$，使用提供的参数 $\\lambda=2.0, \\mu=3.0, c=0.5, \\alpha=0.2$ 计算基准真值的第二 Piola-Kirchhoff 应力 $S_{\\mathrm{gt}}$ 和熵 $\\eta_{\\mathrm{gt}}$。\n本构关系为：\n$$\nS_{\\mathrm{gt}} = \\lambda(\\mathrm{tr}\\,E)I + 2\\mu E + \\alpha\\tau I\n\\quad \\implies \\quad\n\\begin{cases}\nS_{\\mathrm{gt},11} = \\lambda(E_{11}+E_{22}) + 2\\mu E_{11} + \\alpha\\tau \\\\\nS_{\\mathrm{gt},22} = \\lambda(E_{11}+E_{22}) + 2\\mu E_{22} + \\alpha\\tau \\\\\nS_{\\mathrm{gt},12} = 2\\mu E_{12}\n\\end{cases}\n$$\n$$\n\\eta_{\\mathrm{gt}} = -\\frac{\\partial \\psi_{\\mathrm{gt}}}{\\partial \\tau} = -(c\\tau + \\alpha\\,\\mathrm{tr}\\,E)\n$$\n\n**2. 模型 A：基于势的学习**\n模型 A 使用势拟设 $\\psi_{w} = \\tfrac{1}{2}w_{1}(\\mathrm{tr}\\,E)^{2} + w_{2}\\,\\mathrm{tr}(E^{2}) + \\tfrac{1}{2}w_{3}\\tau^{2} + w_{4}\\tau\\,\\mathrm{tr}\\,E$。预测的应力和熵从此势导出：\n$S_{w,11} = (w_1+2w_2)E_{11} + w_1 E_{22} + w_4\\tau$\n$S_{w,22} = w_1 E_{11} + (w_1+2w_2)E_{22} + w_4\\tau$\n$S_{w,12} = 2w_2 E_{12}$\n$\\eta_w = -w_3\\tau - w_4 \\mathrm{tr}\\,E$\n这些方程在未知权重 $w = [w_1, w_2, w_3, w_4]^T$ 上是线性的。我们可以通过将所有 $N_{\\mathrm{train}}$ 个训练样本的这些方程堆叠起来，构建一个线性最小二乘问题 $X_A w = Y_A$。目标是最小化包括应力误差的 Frobenius 范数在内的误差平方和，$\\|S_{\\mathrm{pred}} - S_{\\mathrm{gt}}\\|_F^2 = (S_{11,\\Delta})^2 + (S_{22,\\Delta})^2 + 2(S_{12,\\Delta})^2$。为了处理这个问题，在最小二乘系统中，对应于 $S_{12}$ 的方程由 $\\sqrt{2}$ 加权。使用 `numpy.linalg.lstsq` 求解 $w$。\n\n**3. 模型 B：带正则化的直接映射**\n模型 B 将每个应力分量和熵预测为特征 $g(E,\\tau) = [\\mathrm{tr}\\,E, E_{11}, E_{22}, E_{12}, \\tau, 1]^{\\top}$ 的线性组合。这涉及到 $4 \\times 6 = 24$ 个参数，我们将它们收集在一个向量 $p$ 中。训练过程最小化目标函数 $\\mathcal{L}_{\\gamma}$。这是一个正则化的最小二乘问题。经验风险项 $\\frac{1}{N}\\sum(\\dots)$ 可以写为 $\\frac{1}{N}\\|X_p p - Y_p\\|_2^2$，其中 $X_p$ 是设计矩阵， $Y_p$ 是目标向量。惩罚项 $\\gamma V^2$ 可以写成二次型 $\\gamma p^T C^T C p$，其中矩阵 $C$ 编码了线性热力学一致性约束。\n关于 $p$ 最小化 $\\mathcal{L}_{\\gamma}$ 得到线性系统：\n$$\n\\left(\\frac{1}{N_{\\mathrm{train}}} X_p^T X_p + \\gamma C^T C\\right) p = \\frac{1}{N_{\\mathrm{train}}} X_p^T Y_p\n$$\n对于每个 $\\gamma \\in \\{0.0, 0.01, 1.0\\}$ 的值，求解这个 $24 \\times 24$ 的系统以获得 $p$。与模型 A 一样，通过将对应于 $S_{12}$ 的行乘以 $\\sqrt{2}$ 来处理 Frobenius 范数的使用。\n\n**4. 评估**\n在验证集上评估训练好的模型。\n*   **模型 A 的 $V$ 值**：根据构造，模型 A 基于一个势，其预测完全满足一致性关系。因此，其违背度量 $V$ 为 $0$。\n*   **RelRMSE**：在验证集上为所有模型使用提供的公式计算，适当考虑应力张量的 Frobenius 范数。\n*   **模型 B 的 $V$ 值**：使用定义 $V = \\sqrt{\\|Cp\\|_2^2}$ 从拟合的参数向量 $p$ 计算得出。\n*   **模型 A 的 $N_0$ 值**：在 $E=0, \\tau=0$ 处评估。鉴于模型的结构，应力和熵的预测值必须为零，因此 $N_0=0$。\n*   **模型 A 的纯剪切误差**：在特定的纯剪切状态下计算预测剪切应力 $S_{12}$ 的相对误差。由于模型 A 的结构与基准真值相匹配，此误差预计非常小，仅受最小二乘拟合精度的限制。\n然后收集并格式化十个所需的结果。",
            "answer": "```python\nimport numpy as np\n\n# Ground Truth Parameters\nLAMBDA_GT = 2.0\nMU_GT = 3.0\nC_GT = 0.5\nALPHA_GT = 0.2\n\n# Data Generation Parameters\nN_TRAIN = 200\nN_VAL = 100\nE_MAX = 0.02\nT_MAX = 0.1\nRANDOM_SEED = 42\n\n# Special Check Parameters\nGAMMA_S = 0.04\n\n\ndef generate_data(n_samples, seed):\n    \"\"\"Generates synthetic strain-temperature data and corresponding stress-entropy targets.\"\"\"\n    rng = np.random.default_rng(seed)\n    E11 = rng.uniform(-E_MAX, E_MAX, n_samples)\n    E22 = rng.uniform(-E_MAX, E_MAX, n_samples)\n    E12 = rng.uniform(-E_MAX, E_MAX, n_samples)\n    tau = rng.uniform(-T_MAX, T_MAX, n_samples)\n    \n    trE = E11 + E22\n    \n    S_gt_11 = LAMBDA_GT * trE + 2 * MU_GT * E11 + ALPHA_GT * tau\n    S_gt_22 = LAMBDA_GT * trE + 2 * MU_GT * E22 + ALPHA_GT * tau\n    S_gt_12 = 2 * MU_GT * E12\n    eta_gt = -C_GT * tau - ALPHA_GT * trE\n    \n    strains = np.vstack([E11, E22, E12, tau]).T\n    targets = np.vstack([S_gt_11, S_gt_22, S_gt_12, eta_gt]).T\n    \n    return strains, targets\n\ndef train_model_A(strains_train, targets_train):\n    \"\"\"Trains Model A by solving a linear least-squares problem for the potential weights.\"\"\"\n    n_samples = strains_train.shape[0]\n    X_A = np.zeros((4 * n_samples, 4))\n    Y_A = np.zeros(4 * n_samples)\n    sqrt2 = np.sqrt(2.0)\n    \n    for i in range(n_samples):\n        E11, E22, E12, tau = strains_train[i]\n        trE = E11 + E22\n        \n        # Rows corresponding to S_11, S_22, sqrt(2)*S_12, eta\n        # Corrected for potential parameters w = [w1, w2, w3, w4]\n        # Sw11 = w1*E11 + w1*E22 + 2*w2*E11 + w4*tau = (w1+2w2)*E11 + w1*E22 + w4*tau\n        X_A[4 * i, :]     = [E11 + E22, 2 * E11, 0, tau]\n        X_A[4 * i + 1, :] = [E11 + E22, 2 * E22, 0, tau]\n        X_A[4 * i + 2, :] = [0, sqrt2 * 2 * E12, 0, 0]\n        X_A[4 * i + 3, :] = [0, 0, -tau, -trE]\n\n        Y_A[4*i:4*i+4] = [targets_train[i, 0], targets_train[i, 1], sqrt2 * targets_train[i, 2], targets_train[i, 3]]\n\n    w, _, _, _ = np.linalg.lstsq(X_A, Y_A, rcond=None)\n    return w\n\ndef train_model_B(strains_train, targets_train, gamma):\n    \"\"\"Trains Model B by solving a regularized linear least-squares problem.\"\"\"\n    n_samples = strains_train.shape[0]\n    num_params = 24\n    \n    X_B_prime = np.zeros((4 * n_samples, num_params))\n    Y_B_prime = np.zeros(4 * n_samples)\n    sqrt2 = np.sqrt(2.0)\n\n    for i in range(n_samples):\n        E11, E22, E12, tau = strains_train[i]\n        trE = E11 + E22\n        g = np.array([trE, E11, E22, E12, tau, 1.0])\n        \n        X_B_prime[4 * i, 0:6]     = g\n        X_B_prime[4 * i + 1, 6:12] = g\n        X_B_prime[4 * i + 2, 12:18] = sqrt2 * g\n        X_B_prime[4 * i + 3, 18:24] = g\n\n        Y_B_prime[4*i:4*i+4] = [targets_train[i, 0], targets_train[i, 1], sqrt2 * targets_train[i, 2], targets_train[i, 3]]\n        \n    v11, v22, v12, v_theta = [1,1,0,0,0,0], [1,0,1,0,0,0], [0,0,0,1,0,0], [0,0,0,0,1,0]\n    C = np.zeros((6, num_params))\n    C[0, 0:6], C[0, 6:12]   = v22, [-x for x in v11]\n    C[1, 0:6], C[1, 12:18]  = v12, [-x for x in v11]\n    C[2, 6:12], C[2, 12:18] = v12, [-x for x in v22]\n    C[3, 0:6], C[3, 18:24]  = v_theta, v11\n    C[4, 6:12], C[4, 18:24] = v_theta, v22\n    C[5, 12:18], C[5, 18:24]= v_theta, v12\n    \n    A = (1/n_samples) * X_B_prime.T @ X_B_prime + gamma * C.T @ C\n    b_vec = (1/n_samples) * X_B_prime.T @ Y_B_prime\n    \n    p = np.linalg.solve(A, b_vec)\n    return p\n\ndef predict_model_A(w, strains):\n    \"\"\"Predicts stress and entropy using Model A's learned weights.\"\"\"\n    w1, w2, w3, w4 = w\n    E11, E22, E12, tau = strains.T\n    trE = E11 + E22\n    S_pred_11 = w1 * trE + 2 * w2 * E11 + w4 * tau\n    S_pred_22 = w1 * trE + 2 * w2 * E22 + w4 * tau\n    S_pred_12 = 2 * w2 * E12\n    eta_pred = -w3 * tau - w4 * trE\n    return np.vstack([S_pred_11, S_pred_22, S_pred_12, eta_pred]).T\n\ndef predict_model_B(p, strains):\n    \"\"\"Predicts stress and entropy using Model B's learned parameters.\"\"\"\n    E11, E22, E12, tau = strains.T\n    trE = E11 + E22\n    g = np.vstack([trE, E11, E22, E12, tau, np.ones_like(E11)]).T\n    a11, a22, a12, b_eta = p[0:6], p[6:12], p[12:18], p[18:24]\n    S_pred_11 = g @ a11\n    S_pred_22 = g @ a22\n    S_pred_12 = g @ a12\n    eta_pred = g @ b_eta\n    return np.vstack([S_pred_11, S_pred_22, S_pred_12, eta_pred]).T\n\ndef calculate_rel_rmse(preds, gts):\n    \"\"\"Computes the relative root-mean-square error.\"\"\"\n    delta_S11, delta_S22, delta_S12, delta_eta = (preds - gts).T\n    numerator = np.sum(delta_S11**2 + delta_S22**2 + 2 * delta_S12**2 + delta_eta**2)\n    gt_S11, gt_S22, gt_S12, gt_eta = gts.T\n    denominator = np.sum(gt_S11**2 + gt_S22**2 + 2 * gt_S12**2 + gt_eta**2)\n    return np.sqrt(numerator / denominator) if denominator != 0 else 0.0\n\ndef calculate_V(p):\n    \"\"\"Computes the thermodynamic violation metric V for Model B.\"\"\"\n    v11, v22, v12, v_theta = np.array([1,1,0,0,0,0]), np.array([1,0,1,0,0,0]), np.array([0,0,0,1,0,0]), np.array([0,0,0,0,1,0])\n    a11, a22, a12, b_eta = p[0:6], p[6:12], p[12:18], p[18:24]\n    R1122 = a11 @ v22 - a22 @ v11\n    R1112 = a11 @ v12 - a12 @ v11\n    R2212 = a22 @ v12 - a12 @ v22\n    M11 = a11 @ v_theta + b_eta @ v11\n    M22 = a22 @ v_theta + b_eta @ v22\n    M12 = a12 @ v_theta + b_eta @ v12\n    return np.sqrt(R1122**2 + R1112**2 + R2212**2 + M11**2 + M22**2 + M12**2)\n    \ndef solve():\n    \"\"\"Main driver function to perform training, evaluation, and printing results.\"\"\"\n    strains_train, targets_train = generate_data(N_TRAIN, RANDOM_SEED)\n    strains_val, targets_val = generate_data(N_VAL, RANDOM_SEED + 1)\n    \n    results = []\n    \n    # Model A Evaluation\n    w_A = train_model_A(strains_train, targets_train)\n    results.append(0.0)  # V for Model A is 0 by construction\n    preds_A_val = predict_model_A(w_A, strains_val)\n    results.append(calculate_rel_rmse(preds_A_val, targets_val))\n    \n    # Model B Evaluation for different gammas\n    for gamma in [0.0, 0.01, 1.0]:\n        p_B = train_model_B(strains_train, targets_train, gamma)\n        results.append(calculate_V(p_B))\n        preds_B_val = predict_model_B(p_B, strains_val)\n        results.append(calculate_rel_rmse(preds_B_val, targets_val))\n        \n    # Boundary-state check for Model A\n    preds_N0 = predict_model_A(w_A, np.array([[0, 0, 0, 0]]))\n    S_F_sq = preds_N0[0,0]**2 + preds_N0[0,1]**2 + 2 * preds_N0[0,2]**2\n    results.append(np.sqrt(S_F_sq + preds_N0[0,3]**2))\n    \n    # Pure-shear check for Model A\n    E12_shear = GAMMA_S / 2.0\n    S_gt_12 = 2 * MU_GT * E12_shear\n    preds_shear = predict_model_A(w_A, np.array([[0, 0, E12_shear, 0]]))\n    S_pred_12 = preds_shear[0, 2]\n    results.append(np.abs(S_pred_12 - S_gt_12) / np.abs(S_gt_12))\n    \n    print(f\"[{','.join(f'{x:.6f}' for x in results)}]\")\n\nsolve()\n\n```"
        }
    ]
}