{
    "hands_on_practices": [
        {
            "introduction": "材料客观性原理指出，材料的本构响应不应依赖于观察者的参考标架。第一个动手实践将通过一个直接的计算，让你亲眼见证这一定理的实际应用。通过分析一个同时包含拉伸和刚体转动的变形，你将为一个正确形式的超弹性模型解析推导出其应力，并验证最终的应力确实与任意的刚体转动无关，这正是客观性原理所要求的。",
            "id": "3580198",
            "problem": "考虑一个均匀的三维超弹性体，其经历一种随时间变化的均匀变形，该变形由变形梯度 $F(t) = Q(t)\\,\\lambda\\,I$ 表征，其中 $Q(t) \\in \\mathrm{SO}(3)$ 是一个随时间变化的正交旋转，$\\lambda > 0$ 是一个恒定的标量体积拉伸，而 $I$ 是单位张量。假设材料是各向同性的，并遵循材料客观性（标架无关性）：本构响应只能通过客观度量（如左柯西-格林张量 $B = F F^{T}$ 和雅可比行列式 $J = \\det(F)$）来依赖于变形。该弹性体由一个可压缩 neo-Hookean 模型的单位参考体积应变能密度函数来建模\n$$\nW(B,J) = \\frac{\\mu}{2}\\left(\\bar{I}_{1} - 3\\right) + \\frac{\\kappa}{2}\\left(J - 1\\right)^{2},\n$$\n其中 $\\mu > 0$ 是剪切模量，$\\kappa > 0$ 是体积模量，$\\bar{I}_{1} = \\mathrm{tr}(\\bar{B})$ 是等容左柯西-格林张量 $\\bar{B} = J^{-2/3} B$ 的第一不变量，$\\mathrm{tr}(\\cdot)$ 表示迹。使用第一皮奥拉-基尔霍夫应力 $P$ 的超弹性关系 $P = \\partial W/\\partial F$ 和柯西应力 $\\sigma$ 的关系 $\\sigma = J^{-1} P F^{T}$。\n\n从基本运动学和标架无关性要求出发，推导在给定变形 $F(t) = Q(t)\\,\\lambda\\,I$ 下的柯西应力 $\\sigma$，用 $\\mu$、$\\kappa$ 和 $\\lambda$ 表示，并确认它与旋转 $Q(t)$ 无关。请以单一的 $\\sigma$ 闭式解析表达式给出最终答案。不需要进行数值计算，最终表达式中不应包含单位。",
            "solution": "该问题要求推导一个正在经历特定随时间变化变形的均匀、各向同性超弹性体的柯西应力张量 $\\sigma$。求解过程必须从基本原理出发，并确认所得应力的标架无关性。\n\n首先，我们分析指定变形的运动学。变形梯度由下式给出：\n$$\nF(t) = Q(t)\\,\\lambda\\,I\n$$\n其中 $Q(t)$ 是一个真正交旋转张量，$\\lambda > 0$ 是一个恒定的标量拉伸，而 $I$ 是三维单位张量。\n\n变形的雅可比行列式 $J$ 度量了体积变化。它通过计算 $F$ 的行列式得到：\n$$\nJ = \\det(F) = \\det(Q(t)\\,\\lambda\\,I)\n$$\n使用行列式的性质 $\\det(AB) = \\det(A)\\det(B)$ 以及对于 $n \\times n$ 矩阵 $A$ 的 $\\det(cA) = c^n \\det(A)$，我们得到：\n$$\nJ = \\det(Q(t)) \\det(\\lambda I) = (1) (\\lambda^3 \\det(I)) = \\lambda^3\n$$\n此处，我们利用了 $Q(t)$ 是一个真正交张量，因此 $\\det(Q(t)) = 1$；以及 $I$ 是 $3 \\times 3$ 单位张量，因此 $\\det(I) = 1$。\n\n接下来，我们计算左柯西-格林变形张量 $B$，其定义为 $B = F F^{T}$。\n$$\nB = (Q(t)\\,\\lambda\\,I) (Q(t)\\,\\lambda\\,I)^T = (Q(t)\\,\\lambda\\,I) (\\lambda I^T Q(t)^T)\n$$\n由于 $I^T = I$，并利用标量与张量可交换的性质，我们有：\n$$\nB = \\lambda^2 Q(t) I Q(t)^T = \\lambda^2 Q(t) Q(t)^T\n$$\n因为 $Q(t)$ 是正交的，所以 $Q(t)Q(t)^T = I$。因此，\n$$\nB = \\lambda^2 I\n$$\n这个结果至关重要。它表明对于给定的变形，左柯西-格林张量 $B$ 是一个纯球形张量（单位张量的标量倍），并且值得注意的是，它与旋转 $Q(t)$ 无关。\n\n本构律是以变形的等容（保持体积）部分来给出的。因此，我们计算等容左柯西-格林张量 $\\bar{B}$，其定义为 $\\bar{B} = J^{-2/3} B$。\n$$\n\\bar{B} = (\\lambda^3)^{-2/3} (\\lambda^2 I) = \\lambda^{-2} \\lambda^2 I = I\n$$\n变形张量的等容部分是单位张量，这表明该变形不涉及形状改变（无畸变或剪切），仅有体积改变。\n\n$\\bar{B}$ 的第一不变量是 $\\bar{I}_{1} = \\mathrm{tr}(\\bar{B})$。\n$$\n\\bar{I}_{1} = \\mathrm{tr}(I) = 1 + 1 + 1 = 3\n$$\n在确定了运动学量之后，我们现在转向柯西应力 $\\sigma$ 的本构关系。给定的应变能密度函数是可压缩的 neo-Hookean 形式，它可以加性地分解为一个等容（畸变）部分和一个体积部分：\n$$\nW(B, J) = W_{iso}(\\bar{B}) + W_{vol}(J) = \\frac{\\mu}{2}\\left(\\bar{I}_{1} - 3\\right) + \\frac{\\kappa}{2}\\left(J - 1\\right)^{2}\n$$\n对于这类各向同性超弹性材料，柯西应力 $\\sigma$ 相应地由偏应力（来自等容部分）和静水应力（来自体积部分）之和给出：\n$$\n\\sigma = \\frac{\\mu}{J} \\text{dev}(\\bar{B}) + p I\n$$\n其中 $\\text{dev}(\\bar{B}) = \\bar{B} - \\frac{1}{3}\\mathrm{tr}(\\bar{B})I$ 是 $\\bar{B}$ 的偏量部分，而压力 $p$ 从体积能 $p = \\frac{d W_{vol}}{d J}$ 推导得出。\n\n首先，我们计算压力项 $p$：\n$$\np = \\frac{d}{dJ}\\left(\\frac{\\kappa}{2}(J - 1)^2\\right) = \\kappa(J-1)\n$$\n代入 $J=\\lambda^3$，我们有：\n$$\np = \\kappa(\\lambda^3 - 1)\n$$\n接下来，我们计算偏应力分量。这需要计算 $\\text{dev}(\\bar{B})$：\n$$\n\\text{dev}(\\bar{B}) = \\bar{B} - \\frac{1}{3}\\bar{I}_{1}I\n$$\n使用我们的运动学结果 $\\bar{B}=I$ 和 $\\bar{I}_1=3$，我们得到：\n$$\n\\text{dev}(\\bar{B}) = I - \\frac{1}{3}(3)I = I - I = 0\n$$\n由于等容变形张量的偏量部分为零，因此应力的偏量部分也为零。这在物理上是一致的，因为该变形是纯体积膨胀，不涉及剪切或畸变。\n\n最后，我们组合出柯西应力张量 $\\sigma$：\n$$\n\\sigma = \\frac{\\mu}{J} (0) + p I = p I = \\kappa(\\lambda^3 - 1) I\n$$\n所得的柯西应力是纯静水应力，与单位张量 $I$ 成正比。应力的大小由体积模量 $\\kappa$ 和代表体积比的三次方拉伸 $\\lambda^3$ 决定。如对于纯体积变形所预期的那样，剪切模量 $\\mu$ 没有贡献。\n\n至关重要的是，$\\sigma$ 的最终表达式完全独立于随时间变化的旋转 $Q(t)$。这证实了材料客观性（标架无关性）原理。本构模型是使用客观运动学量（$B$，$J$）建立的，因此当材料承受包含叠加刚体旋转的变形时，当前构型中的真实应力不受该旋转的影响。",
            "answer": "$$\\boxed{\\kappa\\left(\\lambda^{3} - 1\\right)I}$$"
        },
        {
            "introduction": "为了完全理解材料客观性的重要性，研究当它被违背时会发生什么是极具启发性的。本练习要求你分析一个特意构造的非客观本构模型，其中应变能直接依赖于非客观的变形梯度 $F$。你将会发现，这样一个模型会在纯刚体转动下非物理地预测出应力的存在，并且你将编写一个程序来量化这些虚假的效应。",
            "id": "3580214",
            "problem": "要求您通过构建和分析一个刻意非客观的本构函数，来检验计算固体力学中的材料客观性（也称为框架无关性）概念。材料客观性要求应变能密度函数通过客观的度量（例如右 Cauchy-Green 变形张量）来依赖于变形。右 Cauchy-Green 变形张量定义为 $C = F^{T} F$，其中 $F$ 是变形梯度。相反，本任务将使用一个直接依赖于 $F$ 的应变能密度函数，因此它是非客观的。目标是检测和量化在纯刚性旋转 $F = R(t)$ 下产生的伪应力，其中 $R(t)$ 是一个随时间演变的正交旋转。\n\n基本和核心定义：\n- 变形梯度用 $F \\in \\mathbb{R}^{3 \\times 3}$ 表示。\n- 纯刚性旋转由一个满足 $R^{T} R = I$ 和 $\\det(R) = +1$ 的正交张量 $R \\in \\mathrm{SO}(3)$ 表示。\n- 单位参考体积的应变能密度函数用 $W(F)$ 表示，单位为焦耳/立方米。\n- 第一 Piola–Kirchhoff (FPK) 应力张量 $P$ 定义为 $P = \\dfrac{\\partial W}{\\partial F}$。\n- 二阶张量 $A$ 的 Frobenius 范数由 $\\|A\\|_{F} = \\sqrt{\\mathrm{tr}(A^{T} A)}$ 给出。\n\n待分析的本构函数：\n- 考虑一个刻意非客观的应变能密度函数\n$$\nW(F) = \\alpha \\, \\mathrm{tr}(F) + \\frac{\\mu}{2} \\, \\|F\\|_{F}^{2},\n$$\n其中 $\\alpha$ 和 $\\mu$ 是常数材料系数。参数 $\\mu$ 的单位是帕斯卡 ($\\mathrm{Pa}$)，$\\alpha$ 的单位也是帕斯卡 ($\\mathrm{Pa}$)。由于 $F$ 是无量纲的，$W(F)$ 的单位是焦耳/立方米 ($\\mathrm{J}/\\mathrm{m}^{3}$)。\n\n任务：\n1. 从第一 Piola–Kirchhoff 应力 $P = \\dfrac{\\partial W}{\\partial F}$ 的定义以及张量值函数的标准微分法则出发，推导出给定 $W(F)$ 的 $P(F)$ 的显式表达式。\n2. 使用纯刚性旋转 $F = R$ 的概念，证明该 $W(F)$ 不是框架无关的，即对于一般的旋转 $Q \\in \\mathrm{SO}(3)$，证明 $W(QR) \\neq W(R)$。请基于迹和 Frobenius 范数在乘以一个旋转矩阵后的变换行为提供推理。\n3. 对于刚性旋转 $F = R$，计算伪应力范数 $\\|P(R)\\|_{F}$ 和能量偏差 $\\Delta W = W(R) - W(I)$，其中 $I$ 是单位张量。伪应力范数以帕斯卡 ($\\mathrm{Pa}$) 表示，能量偏差以焦耳/立方米 ($\\mathrm{J}/\\mathrm{m}^{3}$) 表示。\n4. 实现一个程序，对于下述每个测试用例，使用 Rodrigues 公式通过轴-角表示法构造旋转矩阵 $R$，并计算任务 3 中的量。旋转角度必须以弧度为单位。\n\nRodrigues 旋转公式的轴-角对：\n- 给定旋转轴向量 $u \\in \\mathbb{R}^{3}$ 和旋转角度 $\\theta \\in \\mathbb{R}$（以弧度为单位），单位轴为 $n = \\dfrac{u}{\\|u\\|}$，$n$ 的斜对称矩阵为\n$$\n[n]_{\\times} = \\begin{bmatrix}\n0  -n_{3}  n_{2} \\\\\nn_{3}  0  -n_{1} \\\\\n-n_{2}  n_{1}  0\n\\end{bmatrix}.\n$$\n相应的旋转矩阵为\n$$\nR = I + \\sin(\\theta) \\, [n]_{\\times} + (1 - \\cos(\\theta)) \\, [n]_{\\times}^{2}.\n$$\n\n测试组：\n对于每个测试用例，输入为 $(u,\\theta,\\alpha,\\mu)$，其中 $u$ 是旋转轴向量，$\\theta$ 是以弧度为单位的旋转角度，$\\alpha,\\mu$ 是以帕斯卡为单位的材料参数。为每个测试用例计算并返回数值对 $[\\|P(R)\\|_{F}, \\Delta W]$，其单位分别为 $\\mathrm{Pa}$ 和 $\\mathrm{J}/\\mathrm{m}^{3}$。\n\n- 测试用例 1：$u = [0, 0, 1]$, $\\theta = \\pi/4$, $\\alpha = 10^{5}$, $\\mu = 2 \\times 10^{6}$。\n- 测试用例 2：$u = [0, 0, 1]$, $\\theta = 0$, $\\alpha = 10^{5}$, $\\mu = 2 \\times 10^{6}$。\n- 测试用例 3：$u = [0, 0, 1]$, $\\theta = \\pi$, $\\alpha = 10^{5}$, $\\mu = 2 \\times 10^{6}$。\n- 测试用例 4：$u = [1, 1, 1]$, $\\theta = \\pi/3$, $\\alpha = 0$, $\\mu = 10^{6}$。\n- 测试用例 5：$u = [0, 1, 0]$, $\\theta = 10^{-6}$, $\\alpha = 5 \\times 10^{5}$, $\\mu = 10^{7}$。\n- 测试用例 6：$u = [1, 0, 0]$, $\\theta = \\pi/2$, $\\alpha = 0$, $\\mu = 5 \\times 10^{6}$。\n\n要求的最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。列表中的每个元素本身都是一个包含相应测试用例的伪应力范数和能量偏差的双元素列表。例如：\n$$\n[[s_{1}, e_{1}], [s_{2}, e_{2}], \\dots]\n$$\n其中 $s_{i}$ 的单位是 $\\mathrm{Pa}$，$e_{i}$ 的单位是 $\\mathrm{J}/\\mathrm{m}^{3}$。角度必须以弧度处理。不应打印任何额外文本。",
            "solution": "此问题被评估为有效，因为它在科学上基于连续介质力学，问题设定良好，目标明确，并且内部一致。所有必要的定义、公式和数据都已提供，以推导和计算出唯一解。\n\n解答过程分四个阶段进行，与问题任务大纲一致：\n1.  推导第一 Piola-Kirchhoff (FPK) 应力张量 $P$。\n2.  证明应变能密度函数 $W(F)$ 的非客观性质。\n3.  推导纯刚性旋转下的伪应力范数和能量偏差的表达式。\n4.  构建解决测试用例的计算算法。\n\n**1. 第一 Piola-Kirchhoff 应力的推导**\n\n应变能密度函数给定为：\n$$W(F) = \\alpha \\, \\mathrm{tr}(F) + \\frac{\\mu}{2} \\, \\|F\\|_{F}^{2}$$\n第一 Piola-Kirchhoff (FPK) 应力张量 $P$ 定义为应变能密度 $W$ 相对于变形梯度 $F$ 的导数：\n$$P = \\frac{\\partial W}{\\partial F} = \\frac{\\partial}{\\partial F} \\left( \\alpha \\, \\mathrm{tr}(F) \\right) + \\frac{\\partial}{\\partial F} \\left( \\frac{\\mu}{2} \\, \\|F\\|_{F}^{2} \\right)$$\n我们使用标准的张量微积分恒等式分别计算每一项的导数。\n\n对于第一项，$F$ 的迹相对于 $F$ 的导数是单位张量 $I$：\n$$\\frac{\\partial}{\\partial F} \\left( \\mathrm{tr}(F) \\right) = I$$\n因此，对应力的贡献是 $\\alpha I$。\n\n对于第二项，我们首先使用迹算子表示 Frobenius 范数的平方：$\\|F\\|_{F}^{2} = \\mathrm{tr}(F^T F)$。\n其导数为：\n$$\\frac{\\partial}{\\partial F} \\left( \\frac{\\mu}{2} \\mathrm{tr}(F^T F) \\right) = \\frac{\\mu}{2} \\frac{\\partial}{\\partial F} (F : F) = \\frac{\\mu}{2} (2F) = \\mu F$$\n此处，冒号算子 $F:F$ 表示双点积，等价于 $\\mathrm{tr}(F^T F)$。\n\n结合这两个结果，FPK 应力张量的显式表达式为：\n$$P(F) = \\alpha I + \\mu F$$\n\n**2. 框架无关性分析**\n\n材料客观性（或框架无关性）原则要求应变能函数在当前构形上叠加一个刚性旋转时保持不变。这意味着对于任何正交张量 $Q \\in \\mathrm{SO}(3)$（代表一个刚性旋转），对于任何变形梯度 $F$ 都必须满足：\n$$W(QF) = W(F)$$\n问题要求通过考虑一个本身就是纯旋转的变形 $F=R$（其中 $R \\in \\mathrm{SO}(3)$）来证明给定的 $W(F)$ 不是框架无关的。我们必须证明在一般情况下 $W(QR) \\neq W(R)$。\n\n我们来计算 $W(QR)$：\n$$W(QR) = \\alpha \\, \\mathrm{tr}(QR) + \\frac{\\mu}{2} \\, \\|QR\\|_{F}^{2}$$\n我们分析迹和 Frobenius 范数项在左乘以 $Q$ 后的行为。\n\nFrobenius 范数项是客观的：\n$$\\|QR\\|_{F}^{2} = \\mathrm{tr}((QR)^T(QR)) = \\mathrm{tr}(R^T Q^T Q R)$$\n由于 $Q$ 是正交的，$Q^T Q = I$。因此：\n$$\\|QR\\|_{F}^{2} = \\mathrm{tr}(R^T I R) = \\mathrm{tr}(R^T R)$$\n由于 $R$ 也是正交的，$R^T R = I$。所以：\n$$\\|QR\\|_{F}^{2} = \\mathrm{tr}(I) = 3$$\n$R$ 本身的 Frobenius 范数是 $\\|R\\|_{F}^{2} = \\mathrm{tr}(R^T R) = \\mathrm{tr}(I) = 3$。因此，$W$ 的第二项满足 $\\|QR\\|_{F}^{2} = \\|R\\|_{F}^{2}$。\n\n然而，迹项不是客观的。通常情况下，$\\mathrm{tr}(QR) \\neq \\mathrm{tr}(R)$。矩阵乘积的迹仅在循环置换下保持不变，即 $\\mathrm{tr}(QR) = \\mathrm{tr}(RQ)$。没有通用性质能保证 $\\mathrm{tr}(QR) = \\mathrm{tr}(R)$。举一个简单的反例，设 $Q$ 和 $R$ 是不对易的旋转矩阵。它们的迹会不同，因此当 $\\alpha \\neq 0$ 时，$\\alpha \\mathrm{tr}(QR) \\neq \\alpha \\mathrm{tr}(R)$。\n\n由于应变能表达式中的一项不是不变量，整个函数 $W(F)$ 就不是框架无关的。\n\n**3. 伪应力范数和能量偏差**\n\n对于纯刚体旋转，变形梯度为 $F=R$，其中 $R \\in \\mathrm{SO}(3)$。\n\nFPK 应力为 $P(R) = \\alpha I + \\mu R$。对于纯旋转存在非零应力是非客观模型造成的伪影。这个伪应力的欧几里得范数（Frobenius 范数）计算如下：\n$$\\|P(R)\\|_{F}^{2} = \\mathrm{tr}(P(R)^T P(R)) = \\mathrm{tr}((\\alpha I + \\mu R)^T (\\alpha I + \\mu R))$$\n$$\\|P(R)\\|_{F}^{2} = \\mathrm{tr}((\\alpha I + \\mu R^T) (\\alpha I + \\mu R)) = \\mathrm{tr}(\\alpha^2 I + \\alpha \\mu R + \\alpha \\mu R^T + \\mu^2 R^T R)$$\n使用性质 $I^T=I$、$R^T R = I$ 以及迹的线性性质：\n$$\\|P(R)\\|_{F}^{2} = \\alpha^2 \\mathrm{tr}(I) + \\alpha \\mu \\mathrm{tr}(R) + \\alpha \\mu \\mathrm{tr}(R^T) + \\mu^2 \\mathrm{tr}(I)$$\n由于 $\\mathrm{tr}(I)=3$ 且 $\\mathrm{tr}(R) = \\mathrm{tr}(R^T)$：\n$$\\|P(R)\\|_{F}^{2} = 3(\\alpha^2 + \\mu^2) + 2 \\alpha \\mu \\mathrm{tr}(R)$$\n伪应力范数是该表达式的平方根：\n$$\\|P(R)\\|_{F} = \\sqrt{3(\\alpha^2 + \\mu^2) + 2 \\alpha \\mu \\, \\mathrm{tr}(R)}$$\n\n能量偏差 $\\Delta W$ 是旋转状态下的能量 $W(R)$与参考状态下的能量 $W(I)$之差，其中 $I$ 是单位矩阵。\n$$W(R) = \\alpha \\, \\mathrm{tr}(R) + \\frac{\\mu}{2} \\|R\\|_{F}^{2} = \\alpha \\, \\mathrm{tr}(R) + \\frac{3\\mu}{2}$$\n$$W(I) = \\alpha \\, \\mathrm{tr}(I) + \\frac{\\mu}{2} \\|I\\|_{F}^{2} = 3\\alpha + \\frac{3\\mu}{2}$$\n能量偏差为：\n$$\\Delta W = W(R) - W(I) = \\left(\\alpha \\, \\mathrm{tr}(R) + \\frac{3\\mu}{2}\\right) - \\left(3\\alpha + \\frac{3\\mu}{2}\\right) = \\alpha (\\mathrm{tr}(R) - 3)$$\n对于一个角度为 $\\theta$ 的旋转，旋转矩阵的迹由 $\\mathrm{tr}(R) = 1 + 2\\cos(\\theta)$ 给出。将此代入表达式可得：\n$$\\|P(R)\\|_{F} = \\sqrt{3(\\alpha^2 + \\mu^2) + 2 \\alpha \\mu (1 + 2\\cos(\\theta))}$$\n$$\\Delta W = \\alpha ((1 + 2\\cos(\\theta)) - 3) = 2\\alpha(\\cos(\\theta) - 1)$$\n\n**4. 算法实现策略**\n\n程序将遍历每个测试用例 $(u, \\theta, \\alpha, \\mu)$。对于每个用例，它将执行以下步骤：\n1.  读取旋转轴 $u$、角度 $\\theta$ 和材料参数 $\\alpha, \\mu$。\n2.  构造 $3 \\times 3$ 旋转矩阵 $R$。如果 $\\theta=0$，$R$ 是单位矩阵 $I$。否则，应用 Rodrigues 旋转公式：\n    a. 标准化旋转轴：$n = u / \\|u\\|$。\n    b. 构造斜对称矩阵 $[n]_{\\times}$。\n    c. 计算 $R = I + \\sin(\\theta)[n]_{\\times} + (1-\\cos(\\theta))[n]_{\\times}^2$。\n3.  计算所得矩阵 $R$ 的迹，记为 $\\mathrm{tr}(R)$。\n4.  使用步骤 3 中推导的解析表达式计算伪应力范数 $\\|P(R)\\|_{F}$ 和能量偏差 $\\Delta W$：\n    $$\\|P(R)\\|_{F} = \\sqrt{3(\\alpha^2 + \\mu^2) + 2 \\alpha \\mu \\, \\mathrm{tr}(R)}$$\n    $$\\Delta W = \\alpha (\\mathrm{tr}(R) - 3)$$\n5.  存储结果对 $[\\|P(R)\\|_{F}, \\Delta W]$。\n6.  处理完所有测试用例后，将结果列表格式化为指定的字符串格式。\n\n该方法遵循了问题中明确构造 $R$ 的要求，同时高效地使用推导出的解析公式计算最终量。",
            "answer": "```python\nimport numpy as np\nimport math\n\ndef solve():\n    \"\"\"\n    Solves the problem of calculating spurious stresses and energy deviations\n    for a non-objective constitutive model under pure rigid rotations.\n    \"\"\"\n    test_cases = [\n        # (u, theta, alpha, mu)\n        ([0, 0, 1], math.pi/4, 1e5, 2e6),\n        ([0, 0, 1], 0, 1e5, 2e6),\n        ([0, 0, 1], math.pi, 1e5, 2e6),\n        ([1, 1, 1], math.pi/3, 0, 1e6),\n        ([0, 1, 0], 1e-6, 5e5, 1e7),\n        ([1, 0, 0], math.pi/2, 0, 5e6),\n    ]\n\n    final_results = []\n    \n    for u_list, theta, alpha, mu in test_cases:\n        u = np.array(u_list, dtype=float)\n        \n        # Handle the case of zero rotation\n        if theta == 0:\n            R = np.identity(3)\n        else:\n            # Normalize the rotation axis\n            norm_u = np.linalg.norm(u)\n            if norm_u == 0:\n                 # A non-zero rotation angle with a zero axis vector is ambiguous.\n                 # Per the test cases, this situation does not occur.\n                 # For a robust implementation, one might default to identity or raise an error.\n                 # Here we assume norm_u is non-zero if theta is non-zero.\n                 pass\n            n = u / norm_u\n            \n            # Construct the skew-symmetric matrix [n]_x\n            nx = np.array([\n                [0, -n[2], n[1]],\n                [n[2], 0, -n[0]],\n                [-n[1], n[0], 0]\n            ])\n            \n            # Rodrigues' rotation formula\n            # R = I + sin(theta)*[n]_x + (1-cos(theta))*([n]_x)^2\n            I = np.identity(3)\n            nx_sq = np.dot(nx, nx)\n            sin_theta = math.sin(theta)\n            cos_theta = math.cos(theta)\n            \n            R = I + sin_theta * nx + (1 - cos_theta) * nx_sq\n\n        # Calculate the trace of the rotation matrix\n        tr_R = np.trace(R)\n\n        # Calculate spurious stress norm and energy deviation\n        # ||P(R)||_F = sqrt(3*(alpha^2 + mu^2) + 2*alpha*mu*tr(R))\n        stress_norm_sq = 3 * (alpha**2 + mu**2) + 2 * alpha * mu * tr_R\n        stress_norm = math.sqrt(stress_norm_sq)\n        \n        # Delta_W = alpha * (tr(R) - 3)\n        energy_dev = alpha * (tr_R - 3)\n        \n        final_results.append([stress_norm, energy_dev])\n\n    # Format the output string as specified: a list of lists,\n    # converted to a string with no spaces.\n    # e.g., [[s1,e1],[s2,e2],...]\n    output_str = str(final_results).replace(\" \", \"\")\n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "在现代计算力学中，确保复杂的本构模型遵循基本物理原理对于软件的可靠性至关重要。最后一个实践将指导你构建一个专业级的验证工具，以自动测试材料的客观性。通过施加大量随机转动，并同时测试一个已知的客观模型和一个非客观模型，你将创建一个强大的工具，该工具可被集成到自动化测试流程中，以保证材料子程序的物理正确性。",
            "id": "3580161",
            "problem": "设计并实现一个完整的、可运行的程序，作为计算固体力学中本构子程序的材料客观性（框架无关性）的验证框架。该框架必须对变形梯度施加随机旋转，并针对给定的应力映射测量其对框架无关性条件的违反程度。程序必须是自包含的，并以指定格式产生单行输出，无需用户输入。\n\n需要验证的基本物理原理是，从变形梯度到空间应力的本构映射所具有的材料客观性（框架无关性）。在叠加的刚体运动下，变形梯度变换为 $F \\mapsto QF$，其中 $Q \\in SO(3)$，$SO(3)$ 表示满足 $Q^T Q = I$ 和 $\\det(Q) = 1$ 的 $3 \\times 3$ 旋转矩阵构成的特殊正交群。一个框架无关的空间应力映射 $T(F)$ 必须满足\n$$\nT(QF) = Q \\, T(F) \\, Q^T \\quad \\text{对所有的 } Q \\in SO(3).\n$$\n\n你的程序必须：\n- 实现一个验证框架，该框架在给定一个产生 $3 \\times 3$ 柯西应力张量的本构子程序 $T(F)$ 时，通过计算多个随机旋转 $Q \\in SO(3)$ 下张量差 $T(QF) - Q \\, T(F) \\, Q^T$ 的 $L^2$ 范数（弗罗贝尼乌斯范数）来评估对框架无关性的违反程度，并报告在指定数量的随机样本上的最大违反值。\n- 生成在 $SO(3)$ 上关于哈尔测度均匀分布的随机旋转 $Q \\in SO(3)$。\n- 将该框架应用于两个本构子程序：\n  1. 一个客观的各向同性超弹性模型，该模型依赖于左柯西-格林张量 $B = F F^T$ 和雅可比行列式 $J = \\det(F)$，并产生一个客观的柯西应力。\n  2. 一个故意设计的非客观模型，该模型以一种违反材料客观性的方式直接依赖于 $F$。\n- 对于 $L^2$ 范数，使用弗罗贝尼乌斯范数，其对一个 $3 \\times 3$ 矩阵 $A$ 的定义为 $\\|A\\|_F = \\sqrt{\\sum_{i=1}^{3}\\sum_{j=1}^{3} A_{ij}^2}$。\n- 对每个测试用例，计算在 $K$ 次随机旋转下的最大范数违反值，然后返回两个布尔值：\n  - 第一个布尔值表示客观模型是否通过框架无关性检查，即最大违反值小于或等于容差 $\\varepsilon_{\\text{obj}}$。\n  - 第二个布尔值表示非客观模型是否被正确地检测为违反框架无关性，即最大违反值大于或等于一个最小阈值 $\\varepsilon_{\\text{nonobj}}$。\n\n在程序中定义并使用以下参数：\n- 每个测试用例的随机旋转次数：$K = 64$。\n- 容差：$\\varepsilon_{\\text{obj}} = 10^{-9}$ 和 $\\varepsilon_{\\text{nonobj}} = 10^{-6}$。\n- 对于客观的各向同性模型，使用任何科学上标准的可压缩各向同性超弹性公式，其产生的柯西应力仅依赖于 $B$ 和 $J$（当 $F$ 被 $QF$ 替换时，不依赖于旋转 $Q$）；具体的材料参数可取为无量纲值。\n- 对于非客观模型，使用一个直接由 $F$ 定义的对称应力（例如，与 $F$ 的对称部分成正比），该应力是非客观的。\n\n测试套件：\n将该框架应用于以下五个变形梯度 $F$（每个均以 $3 \\times 3$ 矩阵形式给出）：\n1. 一般拉伸-剪切：\n$$\nF_1 = \\begin{bmatrix}\n1.2  0.1  -0.05 \\\\\n0.0  0.9  0.2 \\\\\n0.03  -0.02  1.1\n\\end{bmatrix}\n$$\n2. 单位矩阵：\n$$\nF_2 = \\begin{bmatrix}\n1  0  0 \\\\\n0  1  0 \\\\\n0  0  1\n\\end{bmatrix}\n$$\n3. 绕单位轴 $(1,1,1)/\\sqrt{3}$ 纯旋转 $0.4$ 弧度：\n令 $\\theta = 0.4$，$\\hat{u} = \\frac{1}{\\sqrt{3}}(1,1,1)$，且 $R(\\hat{u},\\theta)$ 为通过 Rodrigues 公式得到的旋转矩阵；取\n$$\nF_3 = R(\\hat{u},\\theta).\n$$\n4. 剪切参数为 $\\gamma = 0.3$ 的简单剪切：\n$$\nF_4 = \\begin{bmatrix}\n1  0.3  0 \\\\\n0  1  0 \\\\\n0  0  1\n\\end{bmatrix}\n$$\n5. 拉伸比为 $s = 1.05$ 的均匀体积膨胀：\n$$\nF_5 = \\begin{bmatrix}\n1.05  0  0 \\\\\n0  1.05  0 \\\\\n0  0  1.05\n\\end{bmatrix}\n$$\n\n角度单位：所有角度均为弧度。\n\n最终输出格式规范：\n- 您的程序应产生单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果。\n- 该列表必须按以下顺序包含 $10$ 个布尔值：\n  $[b_{1,\\text{obj}}, b_{1,\\text{nonobj}}, b_{2,\\text{obj}}, b_{2,\\text{nonobj}}, \\dots, b_{5,\\text{obj}}, b_{5,\\text{nonobj}}]$,\n  其中 $b_{i,\\text{obj}}$ 是客观模型在测试用例 $i$ 上的布尔值，而 $b_{i,\\text{nonobj}}$ 是非客观模型在测试用例 $i$ 上的布尔值。\n- 不应打印任何其他文本。\n\n集成说明：\n程序的设计应易于集成到持续集成（CI）中，其中持续集成（CI）指的是对代码变更进行自动化测试。虽然实际的 CI 系统集成超出了本练习的范围，但该验证框架必须是模块化和确定性的（内部使用固定的随机种子），以适用于 CI。所有值都是无量纲的；不需要物理单位。",
            "solution": "所提供的问题经评估是有效的。它在科学上基于连续介质力学的原理，问题设定良好（良构），具有明确的目标和充足的数据，并且没有歧义或矛盾。它代表了计算固体力学领域中一个标准且有意义的验证过程。因此，我们可以着手解决。\n\n所考察的核心原理是材料客观性，也称为框架无关性。该原理假定材料的本构响应必须独立于观察者。在纯力学理论的背景下，这意味着响应在叠加的刚体运动下必须是不变的。\n\n考虑一个正在经历变形的物体，其变形由变形梯度 $F$ 描述。如果一个由真（固有）正交矩阵 $Q \\in SO(3)$（其中 $SO(3)$ 是满足 $Q^T Q = I$ 和 $\\det(Q) = 1$ 的 $3 \\times 3$ 矩阵构成的特殊正交群）表示的刚体旋转被叠加在当前构型上，则新的变形梯度为 $F' = QF$。材料客观性原理要求作为空间张量的柯西应力张量 $\\sigma$ 以与此旋转一致的方式进行变换。具体来说，本构律 $\\sigma(F)$ 必须满足以下关系：\n$$\n\\sigma(QF) = Q \\sigma(F) Q^T\n$$\n对所有的 $F$ 和所有的 $Q \\in SO(3)$ 成立。这确保了在新旋转参考系中观察到的应力张量，就是原始参考系中应力张量的旋转版本。\n\n为了对给定的本构子程序 $\\sigma(F)$ 数值上验证此属性，我们可以设计一个验证框架。该框架测量对客观性条件的偏离程度。我们定义一个误差张量 $\\Delta$ 为：\n$$\n\\Delta(F, Q) = \\sigma(QF) - Q \\sigma(F) Q^T\n$$\n如果一个模型是客观的，那么在数值精度范围内，对于所有的 $F$ 和 $Q$，$\\Delta$ 都必须是零张量。此误差的大小可以用矩阵范数来量化。问题指定了弗罗贝尼乌斯范数，$\\|A\\|_F = \\sqrt{\\text{tr}(A^T A)} = \\sqrt{\\sum_{i,j} A_{ij}^2}$。\n\n对给定的变形梯度 $F$ 的验证测试，涉及计算在一组 $K$ 个随机旋转上的最大违反值：\n$$\n\\text{violation}(F) = \\max_{i=1, \\dots, K} \\| \\Delta(F, Q_i) \\|_F\n$$\n其中 $\\{Q_i\\}_{i=1}^K$ 是一组 $K$ 个随机旋转矩阵。为确保测试的彻底性，这些矩阵必须在 $SO(3)$ 上关于哈尔测度进行均匀采样。我们将采用一个标准算法来实现这一点，该算法涉及生成随机四元数或使用对一个由正态分布随机变量构成的矩阵进行 QR 分解。\n\n该框架将应用于两种不同的本构模型：\n\n1.  **客观模型**：选用一个可压缩 Neo-Hookean 模型。这是一个标准的各向同性超弹性模型。对于此类材料，其本构律可以表示为左柯西-格林张量 $B = FF^T$ 和雅可比行列式 $J = \\det(F)$ 的函数。柯西应力 $\\sigma$ 由下式给出：\n    $$\n    \\sigma(F) = \\frac{\\mu}{J}(\\bar{B} - I) + \\frac{\\lambda}{J} (\\ln J) I\n    $$\n    其中 $I$ 是 $3 \\times 3$ 单位矩阵，$\\bar{B} = J^{-2/3}B$ 是 $B$ 的等容部分，$\\mu$ 和 $\\lambda$ 是材料参数（拉梅参数），我们将其取为无量纲常数 $\\mu=1.0$ 和 $\\lambda=1.0$。该模型保证是客观的，因为 $B$ 和 $J$ 都具有客观的变换性质：在 $F \\to QF$ 的变换下，我们有 $J \\to J$ 和 $B \\to QBQ^T$，这导致了 $\\sigma$ 的正确变换。\n\n2.  **非客观模型**：构建一个简单的特设模型以故意违反客观性。应力被定义为与变形梯度本身的对称部分成正比：\n    $$\n    \\sigma(F) = c \\cdot \\text{sym}(F) = c \\cdot \\frac{1}{2}(F + F^T)\n    $$\n    其中无量纲常数 $c=1.0$。该模型的非客观性很容易证明：$\\sigma(QF) = \\frac{c}{2}(QF + (QF)^T) = \\frac{c}{2}(QF + F^T Q^T)$，这通常不等于 $Q \\sigma(F) Q^T = \\frac{c}{2}Q(F+F^T)Q^T$。\n\n验证框架将遍历所提供的五个关于 $F$ 的测试用例。对于每个 $F_j$，它将计算客观模型和非客观模型在 $K=64$ 次随机旋转下的最大违反值。结果将根据两个容差进行评判：\n-   如果客观模型的最大违反值小于或等于数值容差 $\\varepsilon_{\\text{obj}} = 10^{-9}$，则认为其通过测试。这个小容差考虑了浮点运算误差。\n-   如果非客观模型的最大违反值大于或等于最小阈值 $\\varepsilon_{\\text{nonobj}} = 10^{-6}$，则标记为被正确识别。这确保了其违反是实质性的，而不仅仅是数值噪声。\n\n为确保可复现性，将为生成旋转矩阵的随机数生成器使用一个固定的种子。测试用例 $F_3$ 需要从轴-角表示法构建旋转矩阵。对于角度 $\\theta=0.4$ 和轴 $\\hat{u} = (1/\\sqrt{3})(1,1,1)$，旋转矩阵可以使用 Rodrigues 旋转公式计算得出。\n\n最终输出将是十个布尔值的序列，代表每个模型在五个测试用例中的通过/失败状态。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.spatial.transform import Rotation\n\ndef solve():\n    \"\"\"\n    Main function to run the verification harness for material objectivity.\n    \"\"\"\n\n    # --- Problem Parameters ---\n    K = 64  # Number of random rotations per test case\n    TOL_OBJ = 1e-9  # Tolerance for the objective model\n    TOL_NONOBJ = 1e-6  # Threshold for the non-objective model\n    RANDOM_SEED = 0   # Fixed seed for reproducibility\n\n    # Dimensionless material parameters\n    MU = 1.0\n    LAMBDA = 1.0\n    C_NON_OBJ = 1.0\n\n\n    # --- Helper and Constitutive Functions ---\n\n    def objective_stress(F, mu, lam):\n        \"\"\"\n        Computes the Cauchy stress for a compressible Neo-Hookean model.\n        sigma = (mu/J)*(B_bar - I) + (lam/J)*(ln J)*I\n        \"\"\"\n        J = np.linalg.det(F)\n        if J = 0:\n            # Deformation is not physically meaningful, return zero stress\n            # to avoid math errors (e.g., log of non-positive number).\n            return np.zeros((3, 3))\n        \n        B = F @ F.T\n        B_bar = J**(-2.0/3.0) * B\n        I = np.eye(3)\n        \n        sigma = (mu / J) * (B_bar - I) + (lam / J) * np.log(J) * I\n        return sigma\n\n    def non_objective_stress(F, c):\n        \"\"\"\n        Computes the Cauchy stress for a non-objective model.\n        sigma = c * sym(F) = c * 0.5 * (F + F.T)\n        \"\"\"\n        return c * 0.5 * (F + F.T)\n\n    def verify_model(stress_func, F, rotations, **kwargs):\n        \"\"\"\n        Verification harness that computes the maximum frame indifference violation.\n        \"\"\"\n        sigma_F = stress_func(F, **kwargs)\n        max_violation = 0.0\n\n        for Q in rotations:\n            # 1. Apply rotation to the deformation gradient\n            F_rot = Q @ F\n            \n            # 2. Compute stress from the rotated deformation gradient\n            sigma_F_rot = stress_func(F_rot, **kwargs)\n            \n            # 3. Compute the expected rotated stress\n            expected_sigma_rot = Q @ sigma_F @ Q.T\n            \n            # 4. Calculate the norm of the difference (violation)\n            violation = np.linalg.norm(sigma_F_rot - expected_sigma_rot)\n            \n            if violation > max_violation:\n                max_violation = violation\n        \n        return max_violation\n\n\n    # --- Test Suite Definition ---\n\n    # F1: General stretch-shear\n    F1 = np.array([\n        [1.2, 0.1, -0.05],\n        [0.0, 0.9, 0.2],\n        [0.03, -0.02, 1.1]\n    ])\n\n    # F2: Identity\n    F2 = np.eye(3)\n\n    # F3: Pure rotation\n    theta_F3 = 0.4\n    axis_F3 = np.array([1.0, 1.0, 1.0]) / np.sqrt(3.0)\n    F3 = Rotation.from_rotvec(theta_F3 * axis_F3).as_matrix()\n\n    # F4: Simple shear\n    gamma_F4 = 0.3\n    F4 = np.array([\n        [1.0, gamma_F4, 0.0],\n        [0.0, 1.0, 0.0],\n        [0.0, 0.0, 1.0]\n    ])\n\n    # F5: Uniform volumetric expansion\n    s_F5 = 1.05\n    F5 = np.array([\n        [s_F5, 0.0, 0.0],\n        [0.0, s_F5, 0.0],\n        [0.0, 0.0, s_F5]\n    ])\n\n    test_cases = [F1, F2, F3, F4, F5]\n    \n    # --- Main Execution Logic ---\n\n    # Generate random rotations once for all tests\n    random_rotations = Rotation.random(K, random_state=RANDOM_SEED).as_matrix()\n\n    results = []\n    for F in test_cases:\n        # Verify the objective model\n        max_violation_obj = verify_model(\n            objective_stress, F, random_rotations, mu=MU, lam=LAMBDA\n        )\n        # Check if the violation is within tolerance\n        b_obj = max_violation_obj = TOL_OBJ\n        results.append(b_obj)\n\n        # Verify the non-objective model\n        max_violation_nonobj = verify_model(\n            non_objective_stress, F, random_rotations, c=C_NON_OBJ\n        )\n        # Check if the violation is correctly detected (above threshold)\n        b_nonobj = max_violation_nonobj >= TOL_NONOBJ\n        results.append(b_nonobj)\n\n    # Print the final result in the specified format\n    print(f\"[{','.join(map(str, results))}]\".lower())\n\nsolve()\n```"
        }
    ]
}