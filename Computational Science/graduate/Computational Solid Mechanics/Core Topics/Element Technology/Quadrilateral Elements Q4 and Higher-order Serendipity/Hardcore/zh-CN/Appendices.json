{
    "hands_on_practices": [
        {
            "introduction": "正确定义单元是任何有限元分析的第一步。本练习探讨一个看似简单的细节——节点排序——并揭示其对单元映射数学有效性的深远影响。通过计算不同节点顺序下的雅可比行列式，您将亲自验证为何保持一致的（通常是逆时针的）节点编号对于确保映射的有效性和正确应用边界条件至关重要。",
            "id": "3592210",
            "problem": "一个双线性等参四边形单元（$\\mathrm{Q}4$）通过标准的等参构造，将父正方形 $\\{(\\xi,\\eta)\\,|\\,\\xi,\\eta\\in[-1,1]\\}$ 映射到一个凸的物理四边形。考虑一个物理四边形，其顶点坐标按平面内逆时针顺序 $(A,B,C,D)$ 给出，分别为 $\\mathbf{x}_A=(0,0)$、$\\mathbf{x}_B=(2,0)$、$\\mathbf{x}_C=(2.5,1.5)$ 和 $\\mathbf{x}_D=(-0.2,1.2)$。\n\n使用两种不同的节点排序来定义同一个几何单元：\n- 排序 $\\mathcal{O}_1$：节点 $1\\mapsto A$，节点 $2\\mapsto B$，节点 $3\\mapsto C$，节点 $4\\mapsto D$。\n- 排序 $\\mathcal{O}_2$：节点 $1\\mapsto A$，节点 $2\\mapsto D$，节点 $3\\mapsto C$，节点 $4\\mapsto B$。\n\n仅从 $4$ 节点四边形的双线性等参映射的定义出发，完成以下任务：\n- 对每种排序推导其等参映射 $\\mathbf{x}(\\xi,\\eta)$，并明确指出父正方形的每个角点 $\\{(-1,-1),(1,-1),(1,1),(-1,1)\\}$ 分别与哪个物理顶点相关联。\n- 从基本原理出发，构建雅可比矩阵 $\\mathbf{J}(\\xi,\\eta)=\\partial\\mathbf{x}/\\partial(\\xi,\\eta)$，并计算两种排序下该矩阵在单元中心 $(\\xi,\\eta)=(0,0)$ 处的行列式。\n- 利用您的推导，讨论不同节点排序对单元内部的高斯求积以及在有限元法（FEM）中沿单元边施加诺伊曼边界条件的影响。您的讨论应说明哪些量发生了变化，哪些必须保持一致，哪些是不变量，并简要评论这些考虑如何推广到高阶 serendipity 单元（例如 $\\mathrm{Q}8$ 和 $\\mathrm{Q}9$）。\n\n将带符号的比值作为您的最终答案\n$$\nr \\;=\\; \\frac{\\det\\mathbf{J}_{\\mathcal{O}_2}(0,0)}{\\det\\mathbf{J}_{\\mathcal{O}_1}(0,0)}\\,.\n$$\n比值 $r$ 是无量纲的。请提供精确值。如果需要数值计算，请四舍五入到四位有效数字。",
            "solution": "本题要求分析一个双线性等参四边形单元（$\\mathrm{Q}4$）在两种不同节点排序方案下的情况。我们必须推导等参映射，计算每种情况下单元中心的雅可比行列式，并讨论其影响。\n\n$\\mathrm{Q}4$ 单元的标准父单元是参数空间 $(\\xi, \\eta)$ 中的一个正方形，定义为 $\\{(\\xi,\\eta) \\,|\\, \\xi, \\eta \\in [-1, 1]\\}$。父单元的四个节点按逆时针编号，位于以下位置：\n节点 $1$：$(\\xi, \\eta) = (-1, -1)$\n节点 $2$：$(\\xi, \\eta) = (1, -1)$\n节点 $3$：$(\\xi, \\eta) = (1, 1)$\n节点 $4$：$(\\xi, \\eta) = (-1, 1)$\n\n从父坐标 $(\\xi, \\eta)$ 到物理坐标 $\\mathbf{x} = (x, y)$ 的等参映射由下式给出：\n$$\n\\mathbf{x}(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) \\mathbf{x}_i\n$$\n其中 $\\mathbf{x}_i$ 是物理节点的坐标，$N_i(\\xi, \\eta)$ 是双线性形函数：\n$N_1(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta)$\n$N_2(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta)$\n$N_3(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta)$\n$N_4(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1+\\eta)$\n\n映射的雅可比矩阵定义为 $\\mathbf{J} = \\frac{\\partial \\mathbf{x}}{\\partial(\\xi, \\eta)}$，它是一个 $2 \\times 2$ 矩阵：\n$$\n\\mathbf{J}(\\xi, \\eta) = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix}\n$$\n雅可比矩阵的列通过对映射函数求导计算得出：\n$\\frac{\\partial \\mathbf{x}}{\\partial \\xi} = \\sum_{i=1}^{4} \\frac{\\partial N_i}{\\partial \\xi} \\mathbf{x}_i$ 和 $\\frac{\\partial \\mathbf{x}}{\\partial \\eta} = \\sum_{i=1}^{4} \\frac{\\partial N_i}{\\partial \\eta} \\mathbf{x}_i$。\n\n形函数的导数是：\n$\\frac{\\partial N_1}{\\partial \\xi} = -\\frac{1}{4}(1-\\eta)$, $\\frac{\\partial N_2}{\\partial \\xi} = \\frac{1}{4}(1-\\eta)$, $\\frac{\\partial N_3}{\\partial \\xi} = \\frac{1}{4}(1+\\eta)$, $\\frac{\\partial N_4}{\\partial \\xi} = -\\frac{1}{4}(1+\\eta)$\n$\\frac{\\partial N_1}{\\partial \\eta} = -\\frac{1}{4}(1-\\xi)$, $\\frac{\\partial N_2}{\\partial \\eta} = -\\frac{1}{4}(1+\\xi)$, $\\frac{\\partial N_3}{\\partial \\eta} = \\frac{1}{4}(1+\\xi)$, $\\frac{\\partial N_4}{\\partial \\eta} = \\frac{1}{4}(1-\\xi)$\n\n题目要求我们计算单元中心 $(\\xi, \\eta) = (0, 0)$ 处的雅可比矩阵。在该点，形函数的导数简化为：\n$\\frac{\\partial N_1}{\\partial \\xi}(0,0) = -\\frac{1}{4}$, $\\frac{\\partial N_2}{\\partial \\xi}(0,0) = \\frac{1}{4}$, $\\frac{\\partial N_3}{\\partial \\xi}(0,0) = \\frac{1}{4}$, $\\frac{\\partial N_4}{\\partial \\xi}(0,0) = -\\frac{1}{4}$\n$\\frac{\\partial N_1}{\\partial \\eta}(0,0) = -\\frac{1}{4}$, $\\frac{\\partial N_2}{\\partial \\eta}(0,0) = -\\frac{1}{4}$, $\\frac{\\partial N_3}{\\partial \\eta}(0,0) = \\frac{1}{4}$, $\\frac{\\partial N_4}{\\partial \\eta}(0,0) = \\frac{1}{4}$\n\n因此，中心点处的雅可比矩阵的列为：\n$\\frac{\\partial \\mathbf{x}}{\\partial \\xi}(0,0) = \\frac{1}{4}(-\\mathbf{x}_1 + \\mathbf{x}_2 + \\mathbf{x}_3 - \\mathbf{x}_4)$\n$\\frac{\\partial \\mathbf{x}}{\\partial \\eta}(0,0) = \\frac{1}{4}(-\\mathbf{x}_1 - \\mathbf{x}_2 + \\mathbf{x}_3 + \\mathbf{x}_4)$\n\n物理顶点坐标为 $\\mathbf{x}_A=(0,0)$、$\\mathbf{x}_B=(2,0)$、$\\mathbf{x}_C=(2.5,1.5)$ 和 $\\mathbf{x}_D=(-0.2,1.2)$。\n\n**对排序 $\\mathcal{O}_1$ 的分析**\n对于排序 $\\mathcal{O}_1$，父节点与物理顶点之间的映射关系为：\n节点 $1 \\to \\mathbf{x}_1 = \\mathbf{x}_A = (0,0)$\n节点 $2 \\to \\mathbf{x}_2 = \\mathbf{x}_B = (2,0)$\n节点 $3 \\to \\mathbf{x}_3 = \\mathbf{x}_C = (2.5,1.5)$\n节点 $4 \\to \\mathbf{x}_4 = \\mathbf{x}_D = (-0.2,1.2)$\n这对应于物理四边形 $A \\to B \\to C \\to D$ 的逆时针遍历。\n\n等参映射为 $\\mathbf{x}_{\\mathcal{O}_1}(\\xi, \\eta) = N_1(\\xi,\\eta)\\mathbf{x}_A + N_2(\\xi,\\eta)\\mathbf{x}_B + N_3(\\xi,\\eta)\\mathbf{x}_C + N_4(\\xi,\\eta)\\mathbf{x}_D$。\n\n让我们计算雅可比矩阵 $\\mathbf{J}_{\\mathcal{O}_1}$ 在 $(\\xi,\\eta)=(0,0)$ 处的列：\n$\\frac{\\partial \\mathbf{x}_{\\mathcal{O}_1}}{\\partial \\xi}(0,0) = \\frac{1}{4}(-\\mathbf{x}_A + \\mathbf{x}_B + \\mathbf{x}_C - \\mathbf{x}_D)$\n$= \\frac{1}{4} \\left( -\\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} + \\begin{pmatrix} 2 \\\\ 0 \\end{pmatrix} + \\begin{pmatrix} 2.5 \\\\ 1.5 \\end{pmatrix} - \\begin{pmatrix} -0.2 \\\\ 1.2 \\end{pmatrix} \\right)$\n$= \\frac{1}{4} \\begin{pmatrix} 2 + 2.5 + 0.2 \\\\ 0 + 1.5 - 1.2 \\end{pmatrix} = \\frac{1}{4} \\begin{pmatrix} 4.7 \\\\ 0.3 \\end{pmatrix} = \\begin{pmatrix} 1.175 \\\\ 0.075 \\end{pmatrix}$\n\n$\\frac{\\partial \\mathbf{x}_{\\mathcal{O}_1}}{\\partial \\eta}(0,0) = \\frac{1}{4}(-\\mathbf{x}_A - \\mathbf{x}_B + \\mathbf{x}_C + \\mathbf{x}_D)$\n$= \\frac{1}{4} \\left( -\\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} - \\begin{pmatrix} 2 \\\\ 0 \\end{pmatrix} + \\begin{pmatrix} 2.5 \\\\ 1.5 \\end{pmatrix} + \\begin{pmatrix} -0.2 \\\\ 1.2 \\end{pmatrix} \\right)$\n$= \\frac{1}{4} \\begin{pmatrix} -2 + 2.5 - 0.2 \\\\ 0 + 1.5 + 1.2 \\end{pmatrix} = \\frac{1}{4} \\begin{pmatrix} 0.3 \\\\ 2.7 \\end{pmatrix} = \\begin{pmatrix} 0.075 \\\\ 0.675 \\end{pmatrix}$\n\n排序 $\\mathcal{O}_1$ 在中心点的雅可比矩阵为：\n$$\n\\mathbf{J}_{\\mathcal{O}_1}(0,0) = \\begin{pmatrix} 1.175  0.075 \\\\ 0.075  0.675 \\end{pmatrix}\n$$\n其行列式为：\n$\\det\\mathbf{J}_{\\mathcal{O}_1}(0,0) = (1.175)(0.675) - (0.075)(0.075) = 0.793125 - 0.005625 = 0.7875$。\n正的行列式与从父单元出发的逆时针（保向）映射相符。\n\n**对排序 $\\mathcal{O}_2$ 的分析**\n对于排序 $\\mathcal{O}_2$，映射关系为：\n节点 $1 \\to \\mathbf{x}_1 = \\mathbf{x}_A = (0,0)$\n节点 $2 \\to \\mathbf{x}_2 = \\mathbf{x}_D = (-0.2,1.2)$\n节点 $3 \\to \\mathbf{x}_3 = \\mathbf{x}_C = (2.5,1.5)$\n节点 $4 \\to \\mathbf{x}_4 = \\mathbf{x}_B = (2,0)$\n这对应于物理四边形 $A \\to D \\to C \\to B$ 的顺时针遍历。\n\n等参映射为 $\\mathbf{x}_{\\mathcal{O}_2}(\\xi, \\eta) = N_1(\\xi,\\eta)\\mathbf{x}_A + N_2(\\xi,\\eta)\\mathbf{x}_D + N_3(\\xi,\\eta)\\mathbf{x}_C + N_4(\\xi,\\eta)\\mathbf{x}_B$。\n\n让我们计算雅可比矩阵 $\\mathbf{J}_{\\mathcal{O}_2}$ 在 $(\\xi,\\eta)=(0,0)$ 处的列：\n$\\frac{\\partial \\mathbf{x}_{\\mathcal{O}_2}}{\\partial \\xi}(0,0) = \\frac{1}{4}(-\\mathbf{x}_A + \\mathbf{x}_D + \\mathbf{x}_C - \\mathbf{x}_B)$\n$= \\frac{1}{4} \\left( -\\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} + \\begin{pmatrix} -0.2 \\\\ 1.2 \\end{pmatrix} + \\begin{pmatrix} 2.5 \\\\ 1.5 \\end{pmatrix} - \\begin{pmatrix} 2 \\\\ 0 \\end{pmatrix} \\right)$\n$= \\frac{1}{4} \\begin{pmatrix} -0.2 + 2.5 - 2 \\\\ 1.2 + 1.5 - 0 \\end{pmatrix} = \\frac{1}{4} \\begin{pmatrix} 0.3 \\\\ 2.7 \\end{pmatrix} = \\begin{pmatrix} 0.075 \\\\ 0.675 \\end{pmatrix}$\n\n$\\frac{\\partial \\mathbf{x}_{\\mathcal{O}_2}}{\\partial \\eta}(0,0) = \\frac{1}{4}(-\\mathbf{x}_A - \\mathbf{x}_D + \\mathbf{x}_C + \\mathbf{x}_B)$\n$= \\frac{1}{4} \\left( -\\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} - \\begin{pmatrix} -0.2 \\\\ 1.2 \\end{pmatrix} + \\begin{pmatrix} 2.5 \\\\ 1.5 \\end{pmatrix} + \\begin{pmatrix} 2 \\\\ 0 \\end{pmatrix} \\right)$\n$= \\frac{1}{4} \\begin{pmatrix} 0.2 + 2.5 + 2 \\\\ -1.2 + 1.5 + 0 \\end{pmatrix} = \\frac{1}{4} \\begin{pmatrix} 4.7 \\\\ 0.3 \\end{pmatrix} = \\begin{pmatrix} 1.175 \\\\ 0.075 \\end{pmatrix}$\n\n排序 $\\mathcal{O}_2$ 在中心点的雅可比矩阵为：\n$$\n\\mathbf{J}_{\\mathcal{O}_2}(0,0) = \\begin{pmatrix} 0.075  1.175 \\\\ 0.675  0.075 \\end{pmatrix}\n$$\n我们观察到 $\\mathbf{J}_{\\mathcal{O}_2}(0,0)$ 是通过交换 $\\mathbf{J}_{\\mathcal{O}_1}(0,0)$ 的列得到的。交换矩阵的两列会使其行列式变号。\n$\\det\\mathbf{J}_{\\mathcal{O}_2}(0,0) = (0.075)(0.075) - (1.175)(0.675) = 0.005625 - 0.793125 = -0.7875$。\n负的行列式与顺时针（反向）映射相符。\n\n**最终答案计算**\n比值 $r$ 为：\n$$\nr = \\frac{\\det\\mathbf{J}_{\\mathcal{O}_2}(0,0)}{\\det\\mathbf{J}_{\\mathcal{O}_1}(0,0)} = \\frac{-0.7875}{0.7875} = -1\n$$\n\n**影响讨论**\n\n上述推导突显了有限元法中节点排序的几个关键方面。\n\n1.  **对高斯求积的影响**：对物理单元域 $\\Omega_e$ 的数值积分是在父域中进行的：$\\int_{\\Omega_e} f(\\mathbf{x}) d\\Omega = \\int_{-1}^{1}\\int_{-1}^{1} f(\\mathbf{x}(\\xi,\\eta)) \\det\\mathbf{J}(\\xi,\\eta) d\\xi d\\eta$。雅可比行列式 $\\det\\mathbf{J}$ 的符号直接取决于节点排序。逆时针排序（如 $\\mathcal{O}_1$）产生正的行列式，而顺时针排序（如 $\\mathcal{O}_2$）产生负的行列式。对于一个有效的物理映射，行列式在单元内的任何地方都必须非零。大多数有限元法代码要求 $\\det\\mathbf{J}  0$，并将 $\\det\\mathbf{J}$为负的单元标记为“反转”或“定义不当”。为了计算必须为正的物理量（如质量或能量），积分必须使用行列式的绝对值 $|\\det\\mathbf{J}|$。虽然单元上的最终积分值是相同的（因为对于这种特定的改变，$|\\det\\mathbf{J}_{\\mathcal{O}_1}| = |\\det\\mathbf{J}_{\\mathcal{O}_2}|$），但在每个高斯点上计算的函数——包括映射后的函数 $f(\\mathbf{x}(\\xi,\\eta))$ 和 $\\det\\mathbf{J}(\\xi,\\eta)$——对于每种排序都是不同的。一致的节点排序约定（例如，始终逆时针）对于稳健的网格生成和分析至关重要。\n\n2.  **对诺伊曼边界条件的影响**：诺伊曼边界条件（例如表面牵引力或热通量）是在单元边上积分的。边的定义与节点排序相关。对于排序 $\\mathcal{O}_1$，节点 $1$ 和 $2$ 之间的父边（$\\eta=-1$, $\\xi \\in [-1,1]$）映射到物理边 $A-B$。对于排序 $\\mathcal{O}_2$，相同的父边映射到物理边 $A-D$。因此，要对物理边施加边界条件，需要精确知道它对应于哪个父边，而这完全由节点排序决定。在由多个单元组成的网格中，相邻单元必须对其共享边有一致的定义。例如，如果单元 $1$ 用节点 $(i, j)$ 定义边 $I-J$，则相邻的单元 $2$ 必须用节点 $(j, i)$ 来定义它。这确保了外法线向量的计算是一致的，并且单元间的通量得到正确平衡。随意的节点排序将使得边界条件的施加和全局系统矩阵的组装无法正确管理。\n\n3.  **不变量与变化量**：\n    -   **变化量**：节点排序直接改变了等参映射 $\\mathbf{x}(\\xi,\\eta)$、雅可比矩阵 $\\mathbf{J}(\\xi,\\eta)$ 及其行列式 $\\det\\mathbf{J}$ 的符号。父单元特征（例如边 $1-2$）与物理特征（例如边 $A-B$）之间的关联也被改变。\n    -   **不变量**：物理几何形状（四边形本身）及其固有属性（如面积）是不变的。在特定物理点处的微分面积元的大小 $|d\\Omega| = |\\det\\mathbf{J}| d\\xi d\\eta$ 也是不变的，尽管该物理点在每个映射中对应不同的 $(\\xi,\\eta)$ 坐标。\n\n4.  **对高阶单元的推广**：这些原理直接推广到高阶 serendipity（$\\mathrm{Q}8$）和拉格朗日（$\\mathrm{Q}9$）单元。对于这些单元，一致的节点编号方案（通常是角节点逆时针，然后是边中节点逆时针，最后是内部节点）更为关键。映射函数是更高阶的多项式，不正确的节点排序或边中/内部节点的不当放置很容易导致映射在单元内部的某些点变得不可逆（$\\det\\mathbf{J} \\le 0$），即使物理四边形是凸的。这种“单元畸变”会使分析无效。因此，严格遵守标准排序约定是生成有效高阶单元网格的一项基本要求。",
            "answer": "$$\n\\boxed{-1}\n$$"
        },
        {
            "introduction": "在建立了单元的几何基础之后，我们如何验证其在实践中的表现是否符合预期？本练习介绍了一种强大的代码验证技术——“制造解法”（Method of Manufactured Solutions）。通过编写程序实现这个测试，您将直接比较基本 $Q4$ 单元与高阶 $Q9$ 单元的性能，亲眼见证使用更复杂插值函数所带来的优势，尤其是在处理扭曲几何形状时。",
            "id": "3592204",
            "problem": "考虑有限元法 (FEM) 中的一个等参四边形有限元。设构造的标量场为 $u(x,y)=x^2+y^2$。在参考方形 $\\hat{\\Omega}=[-1,1]\\times[-1,1]$ 上，通过对几何和场插值使用相同的形函数来定义等参映射 $(\\xi,\\eta)\\mapsto(x(\\xi,\\eta),y(\\xi,\\eta))$。对于四节点双线性四边形 ($Q4$)，场近似为 $u_h(\\xi,\\eta)=\\sum_{i=1}^{4} N_i^{(4)}(\\xi,\\eta)\\,u_i$；对于九节点双二次四边形 ($Q9$)，场近似为 $u_h(\\xi,\\eta)=\\sum_{i=1}^{9} N_i^{(9)}(\\xi,\\eta)\\,u_i$。其中 $u_i=u(x_i,y_i)$ 是通过在几何节点的物理坐标处计算构造场得到的节点值。等参映射的雅可比矩阵为 $J(\\xi,\\eta)=\\begin{bmatrix}\\partial x/\\partial \\xi  \\partial x/\\partial \\eta \\\\ \\partial y/\\partial \\xi  \\partial y/\\partial \\eta\\end{bmatrix}$，其行列式记为 $\\det J(\\xi,\\eta)$。\n\n从等参插值以及在 $\\hat{\\Omega}$ 上构造 $Q4$ 和 $Q9$ 形函数的核心定义出发，推导并实现一个数值程序来计算一致性误差的 $L^2$ 范数，\n$$\nE=\\left(\\int_{\\hat{\\Omega}} \\big(u(x(\\xi,\\eta),y(\\xi,\\eta)) - u_h(\\xi,\\eta)\\big)^2\\,\\det J(\\xi,\\eta)\\, \\mathrm{d}\\xi\\,\\mathrm{d}\\eta\\right)^{1/2},\n$$\n并通过计算变异系数来量化非仿射雅可比行列式 $\\det J(\\xi,\\eta)$ 的作用\n$$\n\\mathrm{CV}_J=\\frac{\\sqrt{\\int_{\\hat{\\Omega}}\\left(\\det J(\\xi,\\eta)-\\overline{\\det J}\\right)^2\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta\\bigg/\\int_{\\hat{\\Omega}} 1\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta}}{\\ \\overline{\\det J}\\ },\\quad \\overline{\\det J}=\\frac{\\int_{\\hat{\\Omega}} \\det J(\\xi,\\eta)\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta}{\\int_{\\hat{\\Omega}} 1\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta}.\n$$\n所有积分必须使用足够高阶的高斯-勒让德求积法在 $\\hat{\\Omega}$ 上进行数值计算，以解析被积函数。\n\n使用以下凸四边形测试套件。对于每种情况，必须研究两种几何/插值配置：\n- 使用四个角节点的 $Q4$ 几何和 $Q4$ 场插值。\n- 使用九个节点（四个角点、四个定义为边中点的中点，以及一个定义为四个角点平均值的中心点）的 $Q9$ 几何和 $Q9$ 场插值。\n\n该测试套件以逆时针顺序指定了四个角坐标 $(x_i,y_i)$（$i=1,2,3,4$），从左下角开始：\n- 情况 1（仿射矩形，理想情况）：$(0,0)$, $(1,0)$, $(1,1)$, $(0,1)$。\n- 情况 2（仿射平行四边形，倾斜）：$(0,0)$, $(2,0)$, $(2.2,1.5)$, $(0.2,1.5)$。\n- 情况 3（轻度扭曲，非平行四边形）：$(0,0)$, $(2,0.1)$, $(1.9,1.8)$, $(-0.1,1.7)$。\n- 情况 4（严重扭曲，非平行四边形）：$(0,0)$, $(2,0.5)$, $(2.6,1.7)$, $(-0.4,1.2)$。\n\n对于每种情况，计算三个量：\n- $E_{Q4}$：$Q4$ 几何和 $Q4$ 场插值的一致性误差 $L^2$。\n- $E_{Q9}$：$Q9$ 几何和 $Q9$ 场插值的一致性误差 $L^2$。\n- $\\mathrm{CV}_J$：$Q4$ 几何映射的 $\\det J(\\xi,\\eta)$ 的变异系数（使用 $Q4$ 几何来一致地评估所有情况下的非仿射性）。\n\n您的程序必须生成单行输出，其中包含一个方括号括起来的逗号分隔列表形式的 12 个结果。顺序必须是\n$$\n[E_{Q4}^{(1)},E_{Q9}^{(1)},\\mathrm{CV}_J^{(1)},E_{Q4}^{(2)},E_{Q9}^{(2)},\\mathrm{CV}_J^{(2)},E_{Q4}^{(3)},E_{Q9}^{(3)},\\mathrm{CV}_J^{(3)},E_{Q4}^{(4)},E_{Q9}^{(4)},\\mathrm{CV}_J^{(4)}].\n$$\n不涉及物理单位；所有量均为无量纲实数。不使用角度。将所有输出条目表示为浮点数。数值求积必须在内部实现，不依赖外部数据。解方案不得假定超出所述范围的任何特殊几何形状，并且必须对所有测试用例（包括仿射映射（平行四边形）的边界条件）具有鲁棒性，在这种情况下，$\\mathrm{CV}_J$ 应接近于零，并且由于参考坐标中的多项式次数不同，$Q4$ 和 $Q9$ 之间的再生特性也不同。",
            "solution": "该问题经评估为有效。这是一个计算固体力学领域内适定且有科学依据的问题，需要实施标准的有限元程序以进行验证和分析。\n\n目标是计算等参四边形单元的一致性误差的 $L^2$ 范数 $E$ 和雅可比行列式的变异系数 $\\mathrm{CV}_J$。此分析针对两种单元类型（$4$ 节点双线性单元（$Q4$）和 $9$ 节点双二次单元（$Q9$））在一套四个四边形几何形状上进行。\n\n**1. 等参公式化**\n等参概念的核心是使用同一组形函数 $N_i$ 来插值几何和未知场。单元内的物理坐标 $(x,y)$ 是从主方形 $\\hat{\\Omega}=[-1,1]\\times[-1,1]$ 中的参考坐标 $(\\xi, \\eta)$ 映射而来的：\n$$\nx(\\xi,\\eta) = \\sum_{i=1}^{n_{\\text{nodes}}} N_i(\\xi,\\eta) x_i, \\quad y(\\xi,\\eta) = \\sum_{i=1}^{n_{\\text{nodes}}} N_i(\\xi,\\eta) y_i\n$$\n其中 $(x_i, y_i)$ 是单元的 $n_{\\text{nodes}}$ 个节点的物理坐标。标量场近似 $u_h$ 的定义类似：\n$$\nu_h(\\xi,\\eta) = \\sum_{i=1}^{n_{\\text{nodes}}} N_i(\\xi,\\eta) u_i\n$$\n节点值 $u_i$ 是通过在物理节点位置处计算构造解 $u(x,y)=x^2+y^2$ 得到的：$u_i = u(x_i, y_i) = x_i^2 + y_i^2$。\n\n**2. 形函数**\n形函数 $N_i$ 及其导数定义在主单元 $\\hat{\\Omega}$ 上。\n\n**2.1. Q4 双线性单元**\n$Q4$ 单元在主方形的角点上有 $n_{\\text{nodes}}=4$ 个节点：$(\\xi_i, \\eta_i) \\in \\{(-1,-1), (1,-1), (1,1), (-1,1)\\}$。形函数是线性多项式的乘积：\n$$\nN_i^{(4)}(\\xi,\\eta) = \\frac{1}{4}(1 + \\xi_i\\xi)(1 + \\eta_i\\eta)\n$$\n计算雅可比矩阵所需的导数，例如，$\\frac{\\partial N_i^{(4)}}{\\partial\\xi} = \\frac{1}{4}\\xi_i(1 + \\eta_i\\eta)$。\n\n**2.2. Q9 双二次单元**\n$Q9$ 单元在主方形中有 $n_{\\text{nodes}}=9$ 个规则间隔分布的节点，坐标为 $(\\xi_k, \\eta_k)$，其中 $\\xi_k, \\eta_k \\in \\{-1, 0, 1\\}$。形函数是一维二次拉格朗日多项式的乘积。设一维多项式为 $L_{-1}(s) = \\frac{1}{2}s(s-1)$，$L_0(s) = 1-s^2$ 和 $L_1(s) = \\frac{1}{2}s(s+1)$。位于 $(\\xi_k, \\eta_k)$ 的节点 $k$ 的形函数为：\n$$\nN_k^{(9)}(\\xi,\\eta) = L_{\\xi_k}(\\xi) L_{\\eta_k}(\\eta)\n$$\n导数使用乘法法则计算，例如，$\\frac{\\partial N_k^{(9)}}{\\partial\\xi} = \\frac{d L_{\\xi_k}(\\xi)}{d\\xi} L_{\\eta_k}(\\eta)$。\n\n**3. 映射的雅可比矩阵**\n从物理坐标 $(x,y)$ 到参考坐标 $(\\xi,\\eta)$ 的变换由雅可比矩阵 $J$ 表征：\n$$\nJ(\\xi,\\eta) = \\begin{bmatrix} \\partial x/\\partial \\xi  \\partial x/\\partial \\eta \\\\ \\partial y/\\partial \\xi  \\partial y/\\partial \\eta \\end{bmatrix}\n$$\n$J$ 的分量通过对映射方程求导得到：\n$$\n\\frac{\\partial x}{\\partial \\xi} = \\sum_{i=1}^{n_{\\text{nodes}}} \\frac{\\partial N_i(\\xi,\\eta)}{\\partial\\xi} x_i, \\quad \\frac{\\partial x}{\\partial \\eta} = \\sum_{i=1}^{n_{\\text{nodes}}} \\frac{\\partial N_i(\\xi,\\eta)}{\\partial\\eta} x_i, \\quad \\text{等。}\n$$\n雅可比行列式 $\\det J(\\xi,\\eta)$ 关联了微分面积元：$\\mathrm{d}x\\,\\mathrm{d}y = \\det J(\\xi,\\eta)\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta$。为使映射有效，必须在 $\\hat{\\Omega}$ 中处处满足 $\\det J(\\xi,\\eta)  0$。对于仿射映射（即当物理单元是平行四边形时），$\\det J$ 是常数。对于非仿射或“扭曲”单元，$\\det J$ 是 $(\\xi,\\eta)$ 的函数。\n\n**4. 误差与雅可比变异计算**\n需要计算的两个主要量是误差的 $L^2$ 范数 $E$ 和雅可比行列式的变异系数 $\\mathrm{CV}_J$。\n\n**4.1. L^2 一致性误差**\n误差 $E$ 衡量了在单元域上精确场 $u$ 和插值场 $u_h$ 之间的差异：\n$$\nE = \\left(\\int_{\\Omega} \\big(u(x,y) - u_h(x,y)\\big)^2\\,\\mathrm{d}x\\,\\mathrm{d}y\\right)^{1/2}\n$$\n将此积分变换到参考单元上可得：\n$$\nE = \\left(\\int_{-1}^{1}\\int_{-1}^{1} \\Big(u\\big(x(\\xi,\\eta),y(\\xi,\\eta)\\big) - u_h(\\xi,\\eta)\\Big)^2\\,\\det J(\\xi,\\eta)\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta\\right)^{1/2}\n$$\n\n**4.2. $\\det J$ 的变异系数**\n变异系数 $\\mathrm{CV}_J$ 量化了映射的空间非均匀性，这是衡量单元扭曲的指标：\n$$\n\\mathrm{CV}_J=\\frac{\\sigma_J}{\\overline{\\det J}},\\quad \\text{其中} \\quad \\overline{\\det J} = \\frac{\\int_{\\hat{\\Omega}} \\det J(\\xi,\\eta)\\,\\mathrm{d}A}{\\int_{\\hat{\\Omega}} 1\\,\\mathrm{d}A}, \\quad \\sigma_J^2 = \\frac{\\int_{\\hat{\\Omega}}\\left(\\det J(\\xi,\\eta)-\\overline{\\det J}\\right)^2\\,\\mathrm{d}A}{\\int_{\\hat{\\Omega}} 1\\,\\mathrm{d}A}\n$$\n参考单元的面积为 $\\int_{\\hat{\\Omega}} 1\\,\\mathrm{d}A = 4$。$\\mathrm{CV}_J=0$ 的值表示一个常数雅可比矩阵，这是仿射映射的特征。\n\n**5. 数值积分**\n在 $\\hat{\\Omega}$ 上的所有积分都使用二维高斯-勒让德求积法则进行数值计算：\n$$\n\\int_{-1}^{1}\\int_{-1}^{1} f(\\xi, \\eta)\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta \\approx \\sum_{i=1}^{n_p} \\sum_{j=1}^{n_p} w_i w_j f(\\xi_p^{(i)}, \\eta_p^{(j)})\n$$\n其中 $(\\xi_p^{(i)}, w_i)$ 和 $(\\eta_p^{(j)}, w_j)$ 是 $n_p$ 个高斯点和权重。为确保所涉及的所有被积函数（它们是不同次数的多项式）的计算精度，所有计算将使用足够高的求积阶数 $n_p=16$。\n\n**6. 算法**\n每个测试用例的步骤如下：\n\n1.  **定义几何**：给定 4 个角节点 $(x_i, y_i)$，$i=1,..,4$。\n2.  **计算 $\\mathrm{CV}_J$**：\n    a. 使用由 4 个角节点定义的 $Q4$ 几何映射。\n    b. 使用高斯求积在 $\\hat{\\Omega}$ 上对 $\\det J(\\xi,\\eta)$ 和 $(\\det J(\\xi,\\eta))^2$进行数值积分，以求得它们的均值 $\\overline{\\det J}$ 和 $\\overline{(\\det J)^2}$。\n    c. 计算方差 $\\sigma_J^2 = \\overline{(\\det J)^2} - (\\overline{\\det J})^2$。\n    d. 计算 $\\mathrm{CV}_J = \\sqrt{\\sigma_J^2} / \\overline{\\det J}$。\n3.  **计算 $E_{Q4}$**：\n    a. 使用 4 个角节点进行 $Q4$ 几何映射和 $Q4$ 场插值。\n    b. 计算节点场值 $u_i = x_i^2 + y_i^2$。\n    c. 在 $\\hat{\\Omega}$ 上对误差被积函数 $(u(x,y)-u_h)^2 \\det J$ 进行数值积分。在每个高斯点处：\n        i. 通过 $Q4$ 映射计算物理坐标 $(x,y)$。\n        ii. 计算精确场 $u(x,y)=x^2+y^2$。\n        iii. 计算近似场 $u_h(\\xi,\\eta)$。\n        iv. 计算 $\\det J(\\xi,\\eta)$。\n    d. 最终误差 $E_{Q4}$ 是总积分的平方根。\n4.  **计算 $E_{Q9}$**：\n    a. 定义 $Q9$ 单元的 9 个节点：4 个原始角点、4 个边中点和 1 个角点质心。\n    b. 使用这 9 个节点进行 $Q9$ 几何映射和 $Q9$ 场插值。\n    c. 计算所有 9 个节点的节点场值 $u_i = x_i^2+y_i^2$。\n    d. 类似于 $Q4$ 的情况，在 $\\hat{\\Omega}$ 上对误差被积函数 $(u(x,y)-u_h)^2 \\det J$ 进行数值积分，但对几何和场都使用 $Q9$ 形函数。\n    e. 最终误差 $E_{Q9}$ 是总积分的平方根。\n\n将此程序应用于测试套件时，会揭示出一些关键特性：对于仿射映射（情况 1、2），$Q9$ 单元可以精确表示二次场 $u(x(\\xi,\\eta),y(\\xi,\\eta))$，从而产生零误差，而 $Q4$ 单元则不能。对于非仿射映射（情况 3、4），两种单元都表现出插值误差。\n\n```python\nimport numpy as np\nfrom scipy.special import roots_legendre\n\ndef get_shape_functions_and_derivatives(element_type, xi, eta):\n    \"\"\"\n    Computes shape functions and their derivatives for Q4 and Q9 elements.\n    \"\"\"\n    if element_type == 'Q4':\n        nodes_ref = np.array([[-1, -1], [1, -1], [1, 1], [-1, 1]])\n        N = np.zeros(4)\n        dN_dxi = np.zeros(4)\n        dN_deta = np.zeros(4)\n        for i in range(4):\n            xi_i, eta_i = nodes_ref[i]\n            N[i] = 0.25 * (1 + xi_i * xi) * (1 + eta_i * eta)\n            dN_dxi[i] = 0.25 * xi_i * (1 + eta_i * eta)\n            dN_deta[i] = 0.25 * (1 + xi_i * xi) * eta_i\n        return N, dN_dxi, dN_deta\n    \n    elif element_type == 'Q9':\n        def L(s, s_node):\n            if s_node == -1: return 0.5 * s * (s - 1)\n            if s_node == 0:  return 1 - s**2\n            if s_node == 1:  return 0.5 * s * (s + 1)\n        \n        def dL_ds(s, s_node):\n            if s_node == -1: return s - 0.5\n            if s_node == 0:  return -2 * s\n            if s_node == 1:  return s + 0.5\n\n        nodes_ref = np.array([\n            [-1, -1], [1, -1], [1, 1], [-1, 1],  # Corners\n            [0, -1], [1, 0], [0, 1], [-1, 0],   # Midsides\n            [0, 0]                               # Center\n        ])\n        \n        N = np.zeros(9)\n        dN_dxi = np.zeros(9)\n        dN_deta = np.zeros(9)\n        for i in range(9):\n            xi_i, eta_i = nodes_ref[i]\n            N[i] = L(xi, xi_i) * L(eta, eta_i)\n            dN_dxi[i] = dL_ds(xi, xi_i) * L(eta, eta_i)\n            dN_deta[i] = L(xi, xi_i) * dL_ds(eta, eta_i)\n        return N, dN_dxi, dN_deta\n    \n    else:\n        raise ValueError(\"Unknown element type\")\n\ndef manufactured_solution(x, y):\n    \"\"\" The manufactured scalar field u(x,y) = x^2 + y^2. \"\"\"\n    return x**2 + y**2\n\ndef calculate_cv_j(nodes_phys):\n    \"\"\" Calculates the coefficient of variation of the Q4 mapping Jacobian determinant. \"\"\"\n    num_gauss_points = 16\n    gauss_pts, gauss_wts = roots_legendre(num_gauss_points)\n\n    integral_det_j = 0.0\n    integral_det_j_sq = 0.0\n    \n    for i in range(num_gauss_points):\n        for j in range(num_gauss_points):\n            xi, w_xi = gauss_pts[i], gauss_wts[i]\n            eta, w_eta = gauss_pts[j], gauss_wts[j]\n            \n            _, dN_dxi, dN_deta = get_shape_functions_and_derivatives('Q4', xi, eta)\n            \n            J = np.zeros((2, 2))\n            J[0, 0] = np.dot(dN_dxi, nodes_phys[:, 0])\n            J[0, 1] = np.dot(dN_deta, nodes_phys[:, 0])\n            J[1, 0] = np.dot(dN_dxi, nodes_phys[:, 1])\n            J[1, 1] = np.dot(dN_deta, nodes_phys[:, 1])\n            \n            det_J = np.linalg.det(J)\n            \n            integral_det_j += det_J * w_xi * w_eta\n            integral_det_j_sq += det_J**2 * w_xi * w_eta\n            \n    ref_area = 4.0\n    mean_det_j = integral_det_j / ref_area\n    mean_det_j_sq = integral_det_j_sq / ref_area\n    \n    if abs(mean_det_j)  1e-15:\n        return 0.0 # Avoid division by zero for degenerate elements\n    \n    variance_det_j = mean_det_j_sq - mean_det_j**2\n    variance_det_j = max(0.0, variance_det_j)\n    \n    std_dev_det_j = np.sqrt(variance_det_j)\n    cv_j = std_dev_det_j / mean_det_j\n    \n    return cv_j\n\ndef calculate_l2_error(element_type, nodes_phys):\n    \"\"\" Calculates the L2 consistency error. \"\"\"\n    num_gauss_points = 16\n    gauss_pts, gauss_wts = roots_legendre(num_gauss_points)\n\n    u_nodes = manufactured_solution(nodes_phys[:, 0], nodes_phys[:, 1])\n    \n    integral_error_sq = 0.0\n    \n    for i in range(num_gauss_points):\n        for j in range(num_gauss_points):\n            xi, w_xi = gauss_pts[i], gauss_wts[i]\n            eta, w_eta = gauss_pts[j], gauss_wts[j]\n            \n            N, dN_dxi, dN_deta = get_shape_functions_and_derivatives(element_type, xi, eta)\n            \n            x = np.dot(N, nodes_phys[:, 0])\n            y = np.dot(N, nodes_phys[:, 1])\n            \n            J = np.zeros((2, 2))\n            J[0, 0] = np.dot(dN_dxi, nodes_phys[:, 0])\n            J[0, 1] = np.dot(dN_deta, nodes_phys[:, 0])\n            J[1, 0] = np.dot(dN_dxi, nodes_phys[:, 1])\n            J[1, 1] = np.dot(dN_deta, nodes_phys[:, 1])\n            det_J = np.linalg.det(J)\n\n            if det_J = 0:\n                raise ValueError(\"Invalid mapping: Jacobian determinant non-positive.\")\n            \n            u_exact = manufactured_solution(x, y)\n            u_h = np.dot(N, u_nodes)\n            \n            integrand = (u_exact - u_h)**2 * det_J\n            integral_error_sq += integrand * w_xi * w_eta\n            \n    return np.sqrt(integral_error_sq)\n\ndef solve():\n    test_cases = [\n        np.array([[0.0, 0.0], [1.0, 0.0], [1.0, 1.0], [0.0, 1.0]]),\n        np.array([[0.0, 0.0], [2.0, 0.0], [2.2, 1.5], [0.2, 1.5]]),\n        np.array([[0.0, 0.0], [2.0, 0.1], [1.9, 1.8], [-0.1, 1.7]]),\n        np.array([[0.0, 0.0], [2.0, 0.5], [2.6, 1.7], [-0.4, 1.2]]),\n    ]\n\n    results = []\n    for corner_nodes in test_cases:\n        cv_j = calculate_cv_j(corner_nodes)\n        \n        e_q4 = calculate_l2_error('Q4', corner_nodes)\n        \n        midside12 = 0.5 * (corner_nodes[0] + corner_nodes[1])\n        midside23 = 0.5 * (corner_nodes[1] + corner_nodes[2])\n        midside34 = 0.5 * (corner_nodes[2] + corner_nodes[3])\n        midside41 = 0.5 * (corner_nodes[3] + corner_nodes[0])\n        center = 0.25 * np.sum(corner_nodes, axis=0)\n        \n        nodes_q9 = np.vstack([\n            corner_nodes,\n            [midside12, midside23, midside34, midside41, center]\n        ])\n        \n        e_q9 = calculate_l2_error('Q9', nodes_q9)\n        \n        results.extend([e_q4, e_q9, cv_j])\n\n    formatted_results = [f\"{res:.8f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n```",
            "answer": "[0.08164966,0.00000000,0.00000000,0.29341584,0.00000000,0.00000000,0.30132338,0.02450849,0.05436663,0.41362706,0.03816654,0.22271842]"
        },
        {
            "introduction": "前面的练习已经通过数值实验证明了高阶单元在表示复杂场时的优越性。这个最终练习将深入探讨其背后的根本理论。通过引入“分片检验”（Patch Test）这一有限元法收敛性的基本要求，您将学会如何根据物理问题（如此处的体力项）的数学特性，来确定所需单元插值函数的最低多项式阶次，从而在理论层面理解单元的“完备性”（completeness）为何是保证计算精度的关键。",
            "id": "3592231",
            "problem": "单个等参四边形单元占据一个物理域，该物理域由父坐标 $(\\xi,\\eta)\\in[-1,1]\\times[-1,1]$ 的父正方形映射而来。考虑一个均质、线性弹性、平面应变固体，其 Lamé 算子作用于位移场 $\\boldsymbol{u}=(u_x,u_y)$，体力为 $\\boldsymbol{b}=(b_x,b_y)$，总势能 $\\Pi[\\boldsymbol{u}]$ 由标准的最小势能原理定义。体力是物理坐标的二次多项式：$b_x=x^2$ 和 $b_y=y^2$。单元映射是双线性的（使用四节点双线性形函数进行等参映射），且有轻微扭曲，具体表示为\n$$\nx(\\xi,\\eta)=\\xi+\\alpha\\,\\xi\\,\\eta,\\quad y(\\xi,\\eta)=\\eta,\n$$\n其中 $\\alpha\\neq 0$ 是一个固定的扭曲参数。用于四节点双线性四边形单元 $Q4$ 的标准 Gauss–Legendre 求积法是父正方形上的 $2\\times 2$ 法则。\n\n在整个过程中，凡声称精确的地方，均假定材料积分为精确积分，并使用以下基本事实：(i) 在无惯性项的情况下，线性动量平衡方程为 $\\nabla\\cdot\\boldsymbol{\\sigma}+\\boldsymbol{b}=\\boldsymbol{0}$，其中 Cauchy 应力为 $\\boldsymbol{\\sigma}=\\mathbb{C}:\\boldsymbol{\\varepsilon}$，小应变张量为 $\\boldsymbol{\\varepsilon}=\\tfrac{1}{2}(\\nabla\\boldsymbol{u}+\\nabla\\boldsymbol{u}^{\\top})$；(ii) 应力散度涉及 $\\boldsymbol{u}$ 的二阶导数，因此如果 $u_x,u_y$ 是总次数为 $k$ 的多项式，那么 $\\nabla\\cdot\\boldsymbol{\\sigma}$ 是总次数为 $k-2$ 的多项式。\n\n任务 (a)：仅使用上述基础结构，确定二维 serendipity 族 $S_p$ 中的最小阶数 $p$，使得在精确数值积分下，单个单元上的有限元空间能够表示一个位移场，该位移场在弱形式下精确平衡给定的二次体力，从而在没有离散化误差的情况下再现精确的总势能。将此最小 $p$ 值以单个整数形式报告。\n\n任务 (b)：对于指定双线性映射下的四节点双线性四边形 $Q4$（即 $S_1$），考虑与节点 $1$ 对应的 $x$ 方向上的一致等效节点荷载，\n$$\nf_{1x}=\\int_{-1}^{1}\\int_{-1}^{1} N_1(\\xi,\\eta)\\,b_x\\big(x(\\xi,\\eta),y(\\xi,\\eta)\\big)\\,J(\\xi,\\eta)\\,\\mathrm{d}\\xi\\,\\mathrm{d\\eta},\n$$\n其中 $N_1(\\xi,\\eta)=\\tfrac{1}{4}(1-\\xi)(1-\\eta)$ 是节点 $1$ 的形函数，$J(\\xi,\\eta)$ 是等参映射的 Jacobian 行列式。通过明确指出被积函数在 $\\xi$ 和 $\\eta$ 中的多项式次数，证明标准的 $2\\times 2$ Gauss–Legendre 求积法对于 $\\alpha\\neq 0$ 是否能精确积分 $f_{1x}$，并简要解释你发现的失效模式。\n\n答案规格：您的最终答案必须仅为任务 (a) 中最小 $p$ 值的整数。无需四舍五入。无需单位。",
            "solution": "首先根据指定标准对问题进行验证。\n\n**步骤 1：提取已知条件**\n- 单个等参四边形单元。\n- 父域：$(\\xi,\\eta)\\in[-1,1]\\times[-1,1]$。\n- 固体属性：均质、线性弹性、平面应变。\n- 控制方程：最小势能原理，线性动量平衡 $\\nabla\\cdot\\boldsymbol{\\sigma}+\\boldsymbol{b}=\\boldsymbol{0}$，其中 Cauchy 应力为 $\\boldsymbol{\\sigma}=\\mathbb{C}:\\boldsymbol{\\varepsilon}$，小应变张量为 $\\boldsymbol{\\varepsilon}=\\tfrac{1}{2}(\\nabla\\boldsymbol{u}+\\nabla\\boldsymbol{u}^{\\top})$。\n- 体力：$\\boldsymbol{b}=(b_x,b_y)$，其中 $b_x=x^2$ 和 $b_y=y^2$。\n- 等参映射：$x(\\xi,\\eta)=\\xi+\\alpha\\,\\xi\\,\\eta$ 和 $y(\\xi,\\eta)=\\eta$，扭曲参数 $\\alpha\\neq 0$。\n- 求积法：用于四节点双线性四边形 ($Q4$) 单元的 $2\\times 2$ Gauss–Legendre 法则。\n- 基本事实：如果位移场 $\\boldsymbol{u}=(u_x,u_y)$ 的分量是总次数为 $k$ 的多项式，那么 $\\nabla\\cdot\\boldsymbol{\\sigma}$ 的分量是总次数为 $k-2$ 的多项式。\n- 任务 (a)：假设数值积分为精确的，求 serendipity 族 $S_p$ 的最小阶数 $p$，使其能够为给定的体力再现精确的总势能。\n- 任务 (b)：对于 $Q4$ 单元，确定 $2\\times 2$ Gauss 求积法是否能精确积分一致节点荷载 $f_{1x}=\\int_{-1}^{1}\\int_{-1}^{1} N_1(\\xi,\\eta)\\,b_x(x(\\xi,\\eta),y(\\xi,\\eta))\\,J(\\xi,\\eta)\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta$，其中 $N_1(\\xi,\\eta)=\\tfrac{1}{4}(1-\\xi)(1-\\eta)$。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题在科学上基于线性弹性的有限元方法理论。所有术语和概念，如等参映射、serendipity 单元、势能和 Gauss 求积法，在计算力学中都是标准的。该问题是适定的、客观的且内部一致的。所提供的数据足以确定所需的多项式阶数并分析数值积分。在具有恒定材料属性的线性弹性背景下，基本事实是正确的陈述。该问题不违反任何无效标准。\n\n**步骤 3：结论与行动**\n该问题是 **有效的**。将提供一个完整的、有理有据的解答。\n\n**解答**\n\n**任务 (a)：Serendipity 单元的最小阶数**\n\n在没有离散化误差的情况下再现精确总势能的要求，等同于边值问题的精确解 $\\boldsymbol{u}_{exact}$ 必须包含在有限元逼近空间 $\\boldsymbol{V}_h$ 内。如果 $\\boldsymbol{u}_{exact} \\in \\boldsymbol{V}_h$，那么在 $\\boldsymbol{V}_h$ 上最小化势能泛函 $\\Pi[\\boldsymbol{u}]$ 将得到 $\\boldsymbol{u}_{exact}$ 本身。这也被称为通过了针对特定解场的单元检验（patch test）。\n\n强形式的控制微分方程为 $\\nabla \\cdot \\boldsymbol{\\sigma} + \\boldsymbol{b} = \\boldsymbol{0}$。对于均质线性弹性材料，应力 $\\boldsymbol{\\sigma}$ 是位移场 $\\boldsymbol{u}$ 二阶导数的线性函数。问题提供了关键关系：如果 $\\boldsymbol{u}$ 的分量是物理坐标 $(x,y)$ 中总次数为 $k$ 的多项式，记作 $\\mathcal{P}_k(x,y)$，那么 $\\nabla \\cdot \\boldsymbol{\\sigma}$ 的分量是 $(x,y)$ 中总次数为 $k-2$ 的多项式。\n\n给定的体力向量为 $\\boldsymbol{b} = (x^2, y^2)$。分量 $b_x=x^2$ 和 $b_y=y^2$ 是物理坐标 $(x,y)$ 中总次数为 $2$ 的多项式。为了满足平衡方程 $\\nabla \\cdot \\boldsymbol{\\sigma} = -\\boldsymbol{b}$，$\\nabla \\cdot \\boldsymbol{\\sigma}$ 的分量必须能够表示总次数为 $2$ 的多项式。根据提供的提示，这意味着精确位移解 $\\boldsymbol{u}_{exact}$ 必须由总次数为 $k$ 的多项式组成，其中 $k-2=2$，解得 $k=4$。因此，有限元空间必须能够精确表示任何总次数最高为 $4$ 的任意多项式位移场，即 $\\mathcal{P}_4(x,y) \\subseteq \\boldsymbol{V}_h$。\n\n对于等参单元，在物理坐标中表示多项式场的能力取决于其在父坐标 $(\\xi, \\eta)$ 中形函数的多项式基。有限元理论中的一个标准结果是，对于一个具有任意（非仿射）等参映射的单元要通过 $m$ 阶单元检验（即精确再现任何 $m$ 次多项式），其在父域中的形函数空间必须包含 $m$ 次完全多项式集 $\\mathcal{P}_m(\\xi,\\eta)$。\n\n在我们的情况下，需要通过 $m=4$ 阶的单元检验。因此，单元的形函数空间，对于阶数为 $p$ 的 serendipity 族记作 $\\mathcal{S}_p(\\xi, \\eta)$，必须包含 $\\mathcal{P}_4(\\xi, \\eta)$。\n\n阶数为 $p$ 的 serendipity 单元族 $S_p$ 的构造使其形函数空间 $\\mathcal{S}_p$ 包含完全多项式空间 $\\mathcal{P}_p(\\xi, \\eta)$。为了让 $\\mathcal{S}_p$ 包含 $\\mathcal{P}_4(\\xi, \\eta)$，必须有 $p \\ge 4$。满足此条件的最小整数阶数 $p$ 是 $p=4$。\n\n因此，能够满足所述要求的 serendipity 族的最小阶数是 $p=4$。\n\n**任务 (b)：节点荷载求积的精确性**\n\n我们被要求分析四节点双线性四边形 ($Q4$) 单元（对应于 serendipity 族 $S_1$）的一致节点荷载 $f_{1x}$ 的数值积分精确性。求积法则是 $2 \\times 2$ 的 Gauss-Legendre 方案。\n\n节点荷载的积分为：\n$$\nf_{1x}=\\int_{-1}^{1}\\int_{-1}^{1} N_1(\\xi,\\eta)\\,b_x\\big(x(\\xi,\\eta),y(\\xi,\\eta)\\big)\\,J(\\xi,\\eta)\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta\n$$\n我们来分析被积函数，记作 $I(\\xi, \\eta)$。被积函数的组成部分是：\n1.  节点 1 的形函数：$N_1(\\xi,\\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta)$。\n2.  体力 $b_x = x^2$ 使用映射 $x(\\xi,\\eta)=\\xi(1+\\alpha\\eta)$ 在父坐标中表示：\n    $b_x(x(\\xi,\\eta), y(\\xi,\\eta)) = [\\xi(1+\\alpha\\eta)]^2 = \\xi^2(1+\\alpha\\eta)^2$。\n3.  映射的 Jacobian 行列式。Jacobian 矩阵为 $\\boldsymbol{J} = \\begin{pmatrix} \\partial x/\\partial\\xi  \\partial y/\\partial\\xi \\\\ \\partial x/\\partial\\eta  \\partial y/\\partial\\eta \\end{pmatrix} = \\begin{pmatrix} 1+\\alpha\\eta  0 \\\\ \\alpha\\xi  1 \\end{pmatrix}$。行列式为 $J(\\xi, \\eta) = \\det(\\boldsymbol{J}) = 1+\\alpha\\eta$。\n\n完整的被积函数是这三项的乘积：\n$$\nI(\\xi, \\eta) = N_1(\\xi, \\eta) \\cdot b_x \\cdot J = \\left[\\frac{1}{4}(1-\\xi)(1-\\eta)\\right] \\cdot \\left[\\xi^2(1+\\alpha\\eta)^2\\right] \\cdot \\left[1+\\alpha\\eta\\right]\n$$\n$$\nI(\\xi, \\eta) = \\frac{1}{4} ( (1-\\xi)\\xi^2 ) \\cdot ( (1-\\eta)(1+\\alpha\\eta)^3 )\n$$\n为了确定 $2 \\times 2$ Gauss-Legendre 求积法是否精确，我们必须分别找出被积函数关于 $\\xi$ 和 $\\eta$ 的多项式次数。\n-   关于 $\\xi$ 的多项式项是 $(1-\\xi)\\xi^2 = \\xi^2-\\xi^3$。这是一个关于 $\\xi$ 的 $3$ 次多项式。\n-   关于 $\\eta$ 的多项式项是 $(1-\\eta)(1+\\alpha\\eta)^3$。由于 $\\alpha \\neq 0$，展开此式得到：\n    $(1-\\eta)(1 + 3\\alpha\\eta + 3\\alpha^2\\eta^2 + \\alpha^3\\eta^3) = 1 + (3\\alpha-1)\\eta + (3\\alpha^2-3\\alpha)\\eta^2 + (\\alpha^3-3\\alpha^2)\\eta^3 - \\alpha^3\\eta^4$。\n    这是一个关于 $\\eta$ 的 $4$ 次多项式。\n\n在给定方向上具有 $n$ 个点的 Gauss-Legendre 求积法则能精确积分最高为 $2n-1$ 次的多项式。指定的 $2 \\times 2$ 法则在 $\\xi$ 方向和 $\\eta$ 方向上各使用 $n=2$ 个点。\n-   在 $\\xi$ 方向上，该法则对最高为 $2(2)-1 = 3$ 次的多项式是精确的。被积函数关于 $\\xi$ 的次数是 $3$，因此关于 $\\xi$ 的积分是精确执行的。\n-   在 $\\eta$ 方向上，该法则对最高为 $2(2)-1 = 3$ 次的多项式是精确的。被积函数关于 $\\eta$ 的次数是 $4$。\n\n由于被积函数在 $\\eta$ 方向的次数 ($4$) 大于求积法则能精确积分的次数 ($3$)，因此 $f_{1x}$ 的数值积分不精确。\n\n失效模式是沿 $\\eta$ 坐标轴的求积法则阶数不足。$\\eta$ 的高多项式次数是单元几何扭曲的直接后果，该扭曲由 $\\alpha \\neq 0$ 参数化。形函数、映射后的体力以及 Jacobian 行列式的乘积产生了一个多项式，其次数超过了用于非扭曲双线性单元的标准 $2\\times 2$ 法则的积分能力。如果单元未扭曲 ($\\alpha=0$)，被积函数对 $\\eta$ 的依赖将是 $\\frac{1}{4}(1-\\eta)$，这是一个 $1$ 次多项式，可以被精确积分。",
            "answer": "$$\n\\boxed{4}\n$$"
        }
    ]
}