{
    "hands_on_practices": [
        {
            "introduction": "This first practice grounds the theory in a tangible calculation. By working through a simplified kinematic field, you will compute the stiffness contribution from both the Assumed Natural Strain (ANS) modified shear energy and a drilling stabilization penalty. This exercise  is fundamental to understanding how these distinct energy terms are formulated and combined at the element level in a degenerated solid-shell element.",
            "id": "3557460",
            "problem": "Consider a single eight-node trilinear degenerated solid shell finite element representing a flat rectangular plate of in-plane dimensions $a$ by $b$ and thickness $t$. The plate is made of an isotropic, linear elastic material with Young’s modulus $E$ and Poisson’s ratio $\\nu$, and shear modulus $G$ defined by $G = \\frac{E}{2(1+\\nu)}$. The natural coordinate domain is $\\left( \\xi, \\eta, \\zeta \\right) \\in \\left[ -1, 1 \\right]^{3}$, and the isoparametric mapping to the physical coordinates is linear and aligned with the element axes: $x = \\left( a / 2 \\right) \\xi$, $y = \\left( b / 2 \\right) \\eta$, $z = \\left( t / 2 \\right) \\zeta$. The Jacobian determinant for this mapping is constant.\n\nYou will use a tensor-product Gaussian integration rule with a $2 \\times 2 \\times 1$ scheme over the natural domain. First, determine the Gaussian points and corresponding weights in each parametric direction that define this $2 \\times 2 \\times 1$ rule. Then, evaluate the scalar stiffness integral associated with the transverse shear contribution modified by the Assumed Natural Strain (ANS) technique and a drilling stabilization term, for the following kinematic field:\n\n- The transverse displacement field is $w \\left( x, y \\right) = q \\, x$, with $q$ a scalar amplitude parameter.\n- The in-plane displacements and bending rotations are suppressed: $u_{x} \\left( x, y, z \\right) = 0$ and $u_{y} \\left( x, y, z \\right) = 0$, with $\\theta_{x} = 0$ and $\\theta_{y} = 0$.\n- The drilling rotation about the thickness axis is present and spatially constant: $\\theta_{z} \\left( x, y \\right) = q$. Rotations are measured in radians.\n\nAdopt the standard small-strain definitions of the transverse shear strains for a degenerated solid shell, namely $\\gamma_{xz} = \\frac{\\partial w}{\\partial x} + \\frac{\\partial u_{x}}{\\partial z}$ and $\\gamma_{yz} = \\frac{\\partial w}{\\partial y} + \\frac{\\partial u_{y}}{\\partial z}$. Under the given field, these reduce appropriately. The Assumed Natural Strain (ANS) technique replaces the raw transverse shear strains by an interpolated field constructed from edge-sampled values at natural points in the element’s mid-surface. In bilinear elements, the ANS field exactly reproduces constant shear strains in $\\left( \\xi, \\eta \\right)$.\n\nLet the drilling stabilization be modeled as an energetic penalty with energy density $\\left( 1 / 2 \\right) c_{d} \\, \\theta_{z}^{2}$, where $c_{d} > 0$ is a stabilization modulus with units of stress. The scalar stiffness $k_{\\text{total}}$ associated with the amplitude $q$ is defined by $k_{\\text{total}} = \\partial^{2} U / \\partial q^{2}$, where $U$ is the total strain energy comprising the ANS-modified transverse shear energy and the drilling stabilization energy.\n\nUsing the $2 \\times 2 \\times 1$ Gaussian rule and the given kinematic field, compute $k_{\\text{total}}$ in closed form as a function of $a$, $b$, $t$, $E$, $\\nu$, and $c_{d}$. No numerical values are to be substituted. Express your final answer as a single analytic expression. No rounding is required. If you introduce angles, ensure they are in radians.",
            "solution": "The problem as stated is scientifically grounded, well-posed, and contains sufficient information for a unique solution. We may therefore proceed with the derivation.\n\nThe total scalar stiffness $k_{\\text{total}}$ is derived from the total strain energy $U$, which is the sum of the transverse shear strain energy $U_{\\text{shear}}$ and the drilling stabilization energy $U_{\\text{drill}}$. The stiffness is defined as $k_{\\text{total}} = \\frac{\\partial^{2} U}{\\partial q^{2}}$. We will compute each energy component using the specified $2 \\times 2 \\times 1$ Gaussian quadrature scheme.\n\nFirst, we define the integration points and weights for the tensor-product Gaussian rule over the domain $(\\xi, \\eta, \\zeta) \\in [-1, 1]^3$.\nFor the $2$-point rule in the $\\xi$ and $\\eta$ directions, the points are $\\pm 1/\\sqrt{3}$ and the weights are $1$.\n- $\\xi$ direction: points $\\xi_1 = -1/\\sqrt{3}$, $\\xi_2 = 1/\\sqrt{3}$; weights $W_{\\xi,1} = 1$, $W_{\\xi,2} = 1$.\n- $\\eta$ direction: points $\\eta_1 = -1/\\sqrt{3}$, $\\eta_2 = 1/\\sqrt{3}$; weights $W_{\\eta,1} = 1$, $W_{\\eta,2} = 1$.\nFor the $1$-point rule in the $\\zeta$ direction, the point is $0$ and the weight is $2$.\n- $\\zeta$ direction: point $\\zeta_1 = 0$; weight $W_{\\zeta,1} = 2$.\n\nThe strain energy is computed by integrating the energy density over the element volume $V$. In the natural coordinate system, the volume differential is $dV = \\det(J) \\, d\\xi \\, d\\eta \\, d\\zeta$, where $J$ is the Jacobian matrix of the isoparametric mapping.\nThe mapping is given by $x = \\frac{a}{2} \\xi$, $y = \\frac{b}{2} \\eta$, $z = \\frac{t}{2} \\zeta$. The Jacobian matrix is:\n$$\nJ = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial x}{\\partial \\eta} & \\frac{\\partial x}{\\partial \\zeta} \\\\ \\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\eta} & \\frac{\\partial y}{\\partial \\zeta} \\\\ \\frac{\\partial z}{\\partial \\xi} & \\frac{\\partial z}{\\partial \\eta} & \\frac{\\partial z}{\\partial \\zeta} \\end{pmatrix} = \\begin{pmatrix} \\frac{a}{2} & 0 & 0 \\\\ 0 & \\frac{b}{2} & 0 \\\\ 0 & 0 & \\frac{t}{2} \\end{pmatrix}\n$$\nThe determinant of the Jacobian is a constant:\n$$\n\\det(J) = \\left( \\frac{a}{2} \\right) \\left( \\frac{b}{2} \\right) \\left( \\frac{t}{2} \\right) = \\frac{abt}{8}\n$$\n\nNext, we calculate the transverse shear strains. The definitions are $\\gamma_{xz} = \\frac{\\partial w}{\\partial x} + \\frac{\\partial u_x}{\\partial z}$ and $\\gamma_{yz} = \\frac{\\partial w}{\\partial y} + \\frac{\\partial u_y}{\\partial z}$.\nThe problem specifies the kinematic field: $w(x, y) = qx$, $u_x = 0$, and $u_y = 0$.\nThe partial derivatives are:\n$$\n\\frac{\\partial w}{\\partial x} = \\frac{\\partial(qx)}{\\partial x} = q\n\\quad, \\quad\n\\frac{\\partial w}{\\partial y} = \\frac{\\partial(qx)}{\\partial y} = 0\n$$\n$$\n\\frac{\\partial u_x}{\\partial z} = 0\n\\quad, \\quad\n\\frac{\\partial u_y}{\\partial z} = 0\n$$\nSubstituting these into the strain definitions gives the \"raw\" transverse shear strains:\n$$\n\\gamma_{xz}^{\\text{raw}} = q + 0 = q\n$$\n$$\n\\gamma_{yz}^{\\text{raw}} = 0 + 0 = 0\n$$\nThe Assumed Natural Strain (ANS) method is employed. For a bilinear element, the ANS formulation exactly reproduces shear strain fields that are constant in the natural coordinates $(\\xi, \\eta)$. Since both $\\gamma_{xz}^{\\text{raw}} = q$ and $\\gamma_{yz}^{\\text{raw}} = 0$ are spatially constant throughout the element, they are constant in both physical and natural coordinates. Therefore, the ANS-modified strains are identical to the raw strains:\n$$\n\\gamma_{xz}^{\\text{ANS}} = q\n\\quad, \\quad\n\\gamma_{yz}^{\\text{ANS}} = 0\n$$\n\nWe can now compute the transverse shear strain energy, $U_{\\text{shear}}$. The energy density is $\\frac{1}{2} G (\\gamma_{xz}^2 + \\gamma_{yz}^2)$. The total shear energy is the integral of this density over the volume:\n$$\nU_{\\text{shear}} = \\int_{V} \\frac{1}{2} G \\left( (\\gamma_{xz}^{\\text{ANS}})^2 + (\\gamma_{yz}^{\\text{ANS}})^2 \\right) dV = \\int_{V} \\frac{1}{2} G (q^2 + 0^2) dV = \\frac{1}{2} G q^2 \\int_{V} dV\n$$\nIn natural coordinates, this is:\n$$\nU_{\\text{shear}} = \\int_{-1}^{1} \\int_{-1}^{1} \\int_{-1}^{1} \\frac{1}{2} G q^2 \\det(J) \\, d\\xi \\, d\\eta \\, d\\zeta = \\int_{-1}^{1} \\int_{-1}^{1} \\int_{-1}^{1} \\frac{1}{2} G q^2 \\left( \\frac{abt}{8} \\right) d\\xi \\, d\\eta \\, d\\zeta\n$$\nThe integrand is constant. Using the $2 \\times 2 \\times 1$ Gaussian quadrature, the integral is evaluated as a sum over the $4$ integration points $(\\xi_i, \\eta_j, \\zeta_1)$:\n$$\nU_{\\text{shear}} \\approx \\sum_{i=1}^{2} \\sum_{j=1}^{2} \\left[ \\frac{1}{2} G q^2 \\frac{abt}{8} \\right] W_{\\xi,i} W_{\\eta,j} W_{\\zeta,1}\n$$\nSince the integrand is constant and the weights for each point are $W_{\\xi,i}=1$, $W_{\\eta,j}=1$, $W_{\\zeta,1}=2$, the total weight for each of the $4$ points is $1 \\cdot 1 \\cdot 2 = 2$.\n$$\nU_{\\text{shear}} = \\left( \\frac{G q^2 abt}{16} \\right) \\times ( (1)(1)(2) + (1)(1)(2) + (1)(1)(2) + (1)(1)(2) ) = \\frac{G q^2 abt}{16} \\times 8 = \\frac{1}{2} G q^2 abt\n$$\nAs the integrand is constant, the Gauss quadrature is exact.\n\nNext, we compute the drilling stabilization energy, $U_{\\text{drill}}$. The energy density is given as $\\frac{1}{2} c_d \\theta_z^2$, with $\\theta_z = q$. The stabilization modulus $c_d$ has units of stress (force/area), so the energy is obtained by integrating the density over the element volume:\n$$\nU_{\\text{drill}} = \\int_{V} \\frac{1}{2} c_d \\theta_z^2 dV = \\int_{V} \\frac{1}{2} c_d q^2 dV = \\frac{1}{2} c_d q^2 \\int_{V} dV\n$$\nSimilar to the shear energy, the integrand is constant. The integral evaluates to the volume of the element, $abt$.\n$$\nU_{\\text{drill}} = \\frac{1}{2} c_d q^2 (abt)\n$$\nThis result is also obtained exactly by the specified Gaussian integration scheme.\n\nThe total strain energy $U$ is the sum of the two contributions:\n$$\nU(q) = U_{\\text{shear}} + U_{\\text{drill}} = \\frac{1}{2} G q^2 abt + \\frac{1}{2} c_d q^2 abt = \\frac{1}{2} (G + c_d) q^2 abt\n$$\nThe scalar stiffness $k_{\\text{total}}$ is the second derivative of the total energy with respect to the amplitude parameter $q$:\n$$\nk_{\\text{total}} = \\frac{\\partial^2 U}{\\partial q^2} = \\frac{\\partial^2}{\\partial q^2} \\left[ \\frac{1}{2} (G + c_d) q^2 abt \\right]\n$$\nThe first derivative is:\n$$\n\\frac{\\partial U}{\\partial q} = (G + c_d) q abt\n$$\nThe second derivative is:\n$$\nk_{\\text{total}} = (G + c_d) abt\n$$\nFinally, we substitute the given expression for the shear modulus $G = \\frac{E}{2(1+\\nu)}$ to express the stiffness in terms of the required parameters:\n$$\nk_{\\text{total}} = \\left( \\frac{E}{2(1+\\nu)} + c_d \\right) abt\n$$\nThis is the final closed-form expression for the scalar stiffness.",
            "answer": "$$\\boxed{\\left( \\frac{E}{2(1+\\nu)} + c_{d} \\right) abt}$$"
        },
        {
            "introduction": "A critical step in implementing stabilized elements is choosing an appropriate value for the stabilization parameter, which can otherwise seem arbitrary. This exercise  demonstrates a physically-motivated method for calibrating the drilling stiffness by relating its energetic contribution to that of the element's natural shear response. Mastering this technique is key to developing robust elements that are not overly stiffened by artificial penalties.",
            "id": "3557520",
            "problem": "A four-node degenerated solid-shell finite element with Assumed Natural Strain (ANS) kinematics is used to model a thin, flat isotropic plate of thickness $t$, side length $h$ (square element), and material with Young’s modulus $E$ and Poisson’s ratio $\\nu$. To regularize the otherwise ill-conditioned drilling rotation (rotation about the shell normal) degree of freedom, a stabilization term is added in the weak form as an edge-based least-squares penalty on the residual between the independent drilling rotation and the ANS-consistent natural rotation extracted from the displacement gradient.\n\nSpecifically, define the drilling residual along each element edge by $r_{e} = \\theta_{d} - \\theta_{\\text{nat}}$, where $\\theta_{d}$ is the independent drilling rotation and $\\theta_{\\text{nat}}$ is the natural drill rotation reconstructed from the displacement field. The stabilization energy added at the element level is taken as\n$$\nU_{d} \\;=\\; \\frac{1}{2} \\sum_{e=1}^{4} \\int_{e} \\alpha \\, r_{e}^{2} \\,\\mathrm{d}s,\n$$\nwhere $\\alpha$ is the drilling stiffness parameter to be determined and $s$ denotes the coordinate along the element edge. This construction enforces objectivity because under any rigid-body motion of the element one has $\\theta_{d} = \\theta_{\\text{nat}}$ so $r_{e} = 0$ and $U_{d} = 0$.\n\nFor an isotropic Reissner–Mindlin plate, the transverse shear energy per element under a uniform shear strain of magnitude $\\gamma$ is\n$$\nU_{\\text{shear}} \\;=\\; \\frac{1}{2} \\,\\kappa \\, G \\, t \\int_{A} \\gamma^{2} \\,\\mathrm{d}A \\;=\\; \\frac{1}{2}\\,\\kappa \\, G \\, t \\, h^{2} \\,\\gamma^{2},\n$$\nwhere $A$ is the element area, $G = \\frac{E}{2(1+\\nu)}$ is the shear modulus, and $\\kappa$ is the transverse shear correction factor for plates (take $\\kappa = \\frac{5}{6}$).\n\nCalibrate $\\alpha$ by requiring that, for the benchmark state in which the drilling residual $r_{e}$ is uniform along each edge and kinematically identified with a uniform transverse shear angle $\\gamma$ (i.e., set $r_{e} \\equiv \\gamma$ for calibration), the stabilization energy $U_{d}$ equals the transverse shear energy $U_{\\text{shear}}$ computed above. Under this calibration, determine the closed-form scaling law for $\\alpha$ in terms of $E$, $\\nu$, $t$, and $h$.\n\nExpress your final answer as a single analytic expression for $\\alpha(E,\\nu,t,h)$ and do not include units inside the final boxed answer. No numerical rounding is required.",
            "solution": "The objective is to determine the drilling stiffness parameter, $\\alpha$, by relating the drilling stabilization energy, $U_d$, to the transverse shear energy, $U_{\\text{shear}}$, under a specified calibration state.\n\nThe problem provides the expression for the drilling stabilization energy at the element level for a four-node square element:\n$$\nU_{d} = \\frac{1}{2} \\sum_{e=1}^{4} \\int_{e} \\alpha \\, r_{e}^{2} \\,\\mathrm{d}s\n$$\nHere, the summation is over the four edges of the element, $s$ is the coordinate along an edge, and $r_e$ is the drilling residual for edge $e$.\n\nThe transverse shear energy for a Reissner–Mindlin plate element of area $A=h^2$ subjected to a uniform transverse shear strain $\\gamma$ is given as:\n$$\nU_{\\text{shear}} = \\frac{1}{2}\\,\\kappa \\, G \\, t \\int_{A} \\gamma^{2} \\,\\mathrm{d}A = \\frac{1}{2}\\,\\kappa \\, G \\, t \\, h^{2} \\,\\gamma^{2}\n$$\nwhere $\\kappa$ is the transverse shear correction factor, $G$ is the shear modulus, $t$ is the plate thickness, and $h$ is the side length of the square element.\n\nThe calibration is performed under a specific kinematic state where the drilling residual $r_e$ is constant along each edge and is set equal to the uniform transverse shear angle $\\gamma$. That is, for calibration purposes, we have $r_e = \\gamma$ for all four edges.\n\nWe proceed by evaluating the expression for $U_d$ under these calibration conditions. Since $\\alpha$ is a constant parameter and $r_e$ is assumed uniform with value $\\gamma$ along each edge, the term $\\alpha \\, r_e^2 = \\alpha \\, \\gamma^2$ is constant with respect to the line integral $\\int_e \\mathrm{d}s$.\n$$\nU_{d} = \\frac{1}{2} \\sum_{e=1}^{4} \\alpha \\, \\gamma^{2} \\int_{e} \\mathrm{d}s\n$$\nThe integral $\\int_e \\mathrm{d}s$ is simply the length of the edge $e$. For a square element of side length $h$, the length of each edge is $h$. Therefore, the integral for each edge is $h$.\n$$\nU_{d} = \\frac{1}{2} \\sum_{e=1}^{4} \\alpha \\, \\gamma^{2} \\, h\n$$\nSince the term $\\alpha \\, \\gamma^{2} \\, h$ is identical for each of the four edges, the summation simplifies to multiplying the term by $4$:\n$$\nU_{d} = \\frac{1}{2} \\left( 4 \\cdot (\\alpha \\, \\gamma^{2} \\, h) \\right) = 2 \\, \\alpha \\, h \\, \\gamma^{2}\n$$\n\nThe calibration rule requires that we equate the stabilization energy $U_d$ with the transverse shear energy $U_{\\text{shear}}$:\n$$\nU_{d} = U_{\\text{shear}}\n$$\nSubstituting the derived expression for $U_d$ and the given expression for $U_{\\text{shear}}$:\n$$\n2 \\, \\alpha \\, h \\, \\gamma^{2} = \\frac{1}{2}\\,\\kappa \\, G \\, t \\, h^{2} \\,\\gamma^{2}\n$$\nTo find $\\alpha$, we can simplify this equation. Assuming a non-trivial deformation state ($\\gamma \\neq 0$) and a physically existing element ($h > 0$), we can divide both sides by $2 \\, h \\, \\gamma^2$:\n$$\n\\alpha = \\frac{\\frac{1}{2}\\,\\kappa \\, G \\, t \\, h^{2} \\,\\gamma^{2}}{2 \\, h \\, \\gamma^{2}}\n$$\n$$\n\\alpha = \\frac{1}{4} \\, \\kappa \\, G \\, t \\, h\n$$\nThis equation provides the scaling law for $\\alpha$. Now, we must substitute the provided expressions for the material and model parameters. The shear correction factor is given as $\\kappa = \\frac{5}{6}$, and the shear modulus is $G = \\frac{E}{2(1+\\nu)}$, where $E$ is Young's modulus and $\\nu$ is Poisson's ratio.\n\nSubstituting these into the expression for $\\alpha$:\n$$\n\\alpha = \\frac{1}{4} \\left( \\frac{5}{6} \\right) \\left( \\frac{E}{2(1+\\nu)} \\right) t \\, h\n$$\nMultiplying the numerical coefficients:\n$$\n\\alpha = \\frac{5}{4 \\times 6 \\times 2} \\frac{E \\, t \\, h}{1+\\nu}\n$$\n$$\n\\alpha = \\frac{5}{48} \\frac{E \\, t \\, h}{1+\\nu}\n$$\nThis is the final closed-form expression for the drilling stiffness parameter $\\alpha$ based on the specified calibration procedure.",
            "answer": "$$\\boxed{\\frac{5 E t h}{48(1+\\nu)}}$$"
        },
        {
            "introduction": "Even a theoretically sound element formulation can exhibit poor performance when subjected to distorted mesh geometries, a common occurrence in real-world analysis. This computational practice  guides you through a verification study to assess the sensitivity of an Assumed Natural Strain (ANS) formulation to mesh distortion using the Method of Manufactured Solutions. This exercise moves beyond abstract theory to the essential skill of numerically validating finite element behavior and quantifying its accuracy.",
            "id": "3557469",
            "problem": "Consider a single four-node, bilinear isoparametric quadrilateral that models one patch of a Reissner–Mindlin plate, used as a simplified degenerated solid-shell surrogate. The kinematics use the transverse deflection field $w(x,y)$ and the rotations $\\theta_x(x,y)$ and $\\theta_y(x,y)$ about the $y$- and $x$-axes, respectively. The transverse shear strains are $\\gamma_x = \\theta_x + \\frac{\\partial w}{\\partial x}$ and $\\gamma_y = \\theta_y + \\frac{\\partial w}{\\partial y}$. Assume small strains and small rotations. The material is linearly elastic, with Young’s modulus $E$ and Poisson’s ratio $\\nu$, and uses shear correction factor $\\kappa_s$ and thickness $t$. The shear modulus is $G = \\frac{E}{2(1+\\nu)}$. All rotations are measured in radians, all lengths in meters, and all energies in joules.\n\nThe physical element is a parallelogram defined by an aspect ratio and a slant. Let the height be $b>0$ and the width be $a>0$, with aspect ratio $r = a/b$. The parallelogram slant is a dimensionless factor $s$ that shifts the top edge rigidly by $s\\,b$ in the $x$ direction. The node coordinates are\n$$\n\\mathbf{X}_1 = \\left(-\\tfrac{a}{2}, -\\tfrac{b}{2}\\right),\\quad\n\\mathbf{X}_2 = \\left(\\tfrac{a}{2}, -\\tfrac{b}{2}\\right),\\quad\n\\mathbf{X}_3 = \\left(\\tfrac{a}{2} + s\\,b, \\tfrac{b}{2}\\right),\\quad\n\\mathbf{X}_4 = \\left(-\\tfrac{a}{2} + s\\,b, \\tfrac{b}{2}\\right).\n$$\nWith natural coordinates $(\\xi,\\eta)\\in[-1,1]^2$ and standard bilinear shape functions $N_i(\\xi,\\eta)$, the isoparametric map is $\\mathbf{x}(\\xi,\\eta) = \\sum_{i=1}^4 N_i(\\xi,\\eta)\\,\\mathbf{X}_i$ and its Jacobian is $\\mathbf{J}(\\xi,\\eta) = \\partial(x,y)/\\partial(\\xi,\\eta)$. For a parallelogram, $\\mathbf{J}$ is constant over the element.\n\nAssumed Natural Strain (ANS) is used for the shear strains: instead of evaluating $\\gamma_x,\\gamma_y$ at full Gauss points, define four edge sampling points in natural coordinates\n$$\n(\\xi,\\eta) = (0,-1),\\ (0,1)\\ \\text{for}\\ \\gamma_x,\\quad \\text{and}\\quad (\\xi,\\eta)=(-1,0),\\ (1,0)\\ \\text{for}\\ \\gamma_y.\n$$\nLet the corresponding shear samples be $s^{(x)}_1, s^{(x)}_2$ and $s^{(y)}_1, s^{(y)}_2$. The ANS field is taken constant per element for each shear component via weights that sum to one, namely\n$$\n\\gamma_x^{\\mathrm{ANS}} = w^{(x)}_1\\,s^{(x)}_1 + w^{(x)}_2\\,s^{(x)}_2,\\qquad w^{(x)}_1+w^{(x)}_2=1,\n$$\n$$\n\\gamma_y^{\\mathrm{ANS}} = w^{(y)}_1\\,s^{(y)}_1 + w^{(y)}_2\\,s^{(y)}_2,\\qquad w^{(y)}_1+w^{(y)}_2=1.\n$$\nThe classical choice is the symmetric average $w^{(\\cdot)}_1 = w^{(\\cdot)}_2 = 1/2$. To probe mesh distortion sensitivity, define the distortion condition number as the maximum spectral condition number of $\\mathbf{J}(\\xi,\\eta)$ over the four ANS sampling points:\n$$\n\\kappa_{\\max} = \\max_{p\\in\\{(0,\\pm 1),(\\pm 1,0)\\}} \\mathrm{cond}_2\\big(\\mathbf{J}(p)\\big).\n$$\nFor a parallelogram, this reduces to a single constant value.\n\nAdopt a manufactured smooth kinematic field that excites both bending and shear,\n$$\nw(x,y) = C_1\\,x^2 + C_2\\,y^2 + C_3\\,x\\,y,\\quad\n\\theta_x(x,y) = A_1\\,x + A_2\\,y,\\quad\n\\theta_y(x,y) = B_1\\,x + B_2\\,y,\n$$\nwith fixed constants $A_1,A_2,B_1,B_2,C_1,C_2,C_3$. Then\n$$\n\\gamma_x(x,y) = \\theta_x + \\frac{\\partial w}{\\partial x} = (A_1 + 2 C_1)\\,x + (A_2 + C_3)\\,y,\\qquad\n\\gamma_y(x,y) = \\theta_y + \\frac{\\partial w}{\\partial y} = (B_1 + C_3)\\,x + (B_2 + 2 C_2)\\,y.\n$$\n\nDefine the exact shear energy and the ANS shear energy as\n$$\n\\mathcal{E}_{\\mathrm{true}} = \\frac{1}{2}\\,\\kappa_s\\,G\\,t \\int_{\\Omega_e} \\big(\\gamma_x^2 + \\gamma_y^2\\big)\\,\\mathrm{d}A,\\qquad\n\\mathcal{E}_{\\mathrm{ANS}} = \\frac{1}{2}\\,\\kappa_s\\,G\\,t \\, A_e \\left[(\\gamma_x^{\\mathrm{ANS}})^2 + (\\gamma_y^{\\mathrm{ANS}})^2\\right],\n$$\nwhere $A_e$ is the element area. Use Gaussian quadrature of order $5\\times 5$ in $(\\xi,\\eta)$ for numerical integration of $\\mathcal{E}_{\\mathrm{true}}$ and all area averages. Define the relative energy error\n$$\ne = \\frac{\\left|\\mathcal{E}_{\\mathrm{ANS}} - \\mathcal{E}_{\\mathrm{true}}\\right|}{\\mathcal{E}_{\\mathrm{true}}}.\n$$\n\nYour tasks are:\n1. Implement the isoparametric mapping and compute $\\kappa_{\\max}$.\n2. Evaluate the manufactured shear samples at the ANS sampling points and compute $e$ for the symmetric ANS weights $w^{(\\cdot)}_1=w^{(\\cdot)}_2=1/2$.\n3. Flag the ANS as failing if either $e > 0.2$ (expressed as a decimal) or $\\kappa_{\\max} > 8$.\n4. If failing, propose corrected ANS weights $w^{(x)}_i$ and $w^{(y)}_i$ that minimize the mean-square error over the element by matching the area-average shear for each component:\n$$\n\\bar{\\gamma}_x = \\frac{1}{A_e}\\int_{\\Omega_e} \\gamma_x\\,\\mathrm{d}A,\\qquad\n\\bar{\\gamma}_y = \\frac{1}{A_e}\\int_{\\Omega_e} \\gamma_y\\,\\mathrm{d}A,\n$$\nsubject to $w^{(x)}_1+w^{(x)}_2=1$ and $w^{(y)}_1+w^{(y)}_2=1$, i.e., choose\n$$\nw^{(x)}_1 = \\frac{\\bar{\\gamma}_x - s^{(x)}_2}{s^{(x)}_1 - s^{(x)}_2},\\quad w^{(x)}_2=1-w^{(x)}_1,\\qquad\nw^{(y)}_1 = \\frac{\\bar{\\gamma}_y - s^{(y)}_2}{s^{(y)}_1 - s^{(y)}_2},\\quad w^{(y)}_2=1-w^{(y)}_1,\n$$\nwith the understanding that if the denominator is numerically zero, default to the symmetric weights. Report the corrected relative error $e_{\\mathrm{corr}}$ using these weights.\n5. Note: Drilling stabilization for a degenerated solid-shell typically augments the rotational stiffness about the shell normal to avoid singularities. In this reduced Reissner–Mindlin surrogate, the drilling rotation does not enter $\\gamma_x,\\gamma_y$, and thus drilling stabilization does not affect the shear-energy-based error metric. You should still state the stabilization coefficient $\\alpha_d$ you would use in a full formulation, but you do not need to include it in the computations here.\n\nUse the following fixed data for all test cases: $E=210\\times 10^{9}\\ \\text{Pa}$, $\\nu=0.3$, $t=0.01\\ \\text{m}$, $\\kappa_s=5/6$, and manufactured-field coefficients $A_1=0.02\\ \\text{m}^{-1}$, $A_2=-0.01\\ \\text{m}^{-1}$, $B_1=0.015\\ \\text{m}^{-1}$, $B_2=0.005\\ \\text{m}^{-1}$, $C_1=10^{-3}\\ \\text{m}^{-1}$, $C_2=2\\times 10^{-3}\\ \\text{m}^{-1}$, $C_3=-10^{-3}\\ \\text{m}^{-1}$. Set $b=1.0\\ \\text{m}$ and define $a=r\\,b$. State a drilling stabilization coefficient you would adopt in a full element as $\\alpha_d = 10^{-6}\\,E\\,t$ (in $\\text{N/m}$), but do not use it in the numerical evaluation.\n\nTest suite (each case is a pair $(r,s)$ in terms of aspect ratio and slant):\n- Case 1 (happy path): $r=1.0$, $s=0.0$.\n- Case 2 (slender element): $r=4.0$, $s=0.0$.\n- Case 3 (slanted element): $r=1.0$, $s=0.6$.\n- Case 4 (extreme distortion): $r=0.25$, $s=0.8$.\n\nFor each case, your program must return a list with the following eight entries in this order:\n- $\\kappa_{\\max}$,\n- $e$ with symmetric ANS weights,\n- failure flag as $1$ if failing and $0$ otherwise,\n- $w^{(x)}_1$, $w^{(x)}_2$, $w^{(y)}_1$, $w^{(y)}_2$ (the proposed corrective weights; if not failing, still report the computed values),\n- $e_{\\mathrm{corr}}$ with the corrected weights.\n\nFinal output format: Your program should produce a single line of output containing the results as a Python-style list of four lists, one per test case, e.g., \"[[...case1...],[...case2...],[...case3...],[...case4...]]\". All rotation quantities are in radians, all lengths in meters, and all energies in joules; the reported errors are dimensionless decimals.",
            "solution": "The problem requires a detailed analysis of a four-node isoparametric quadrilateral element used as a surrogate for a degenerated solid shell, based on Reissner-Mindlin plate theory. The analysis focuses on the accuracy of the shear energy calculated using the Assumed Natural Strain (ANS) method, benchmarked against a manufactured solution. The sensitivity to mesh distortion, quantified by element aspect ratio $r$ and slant $s$, is to be evaluated.\n\nThe solution proceeds systematically, adhering to the principles of computational mechanics. First, we formalize the element geometry and kinematics. Second, we derive the expressions for the relevant mechanical quantities. Third, we establish the computational procedure for each test case, including the calculation of energies, errors, and corrective weights.\n\n**1. Element Formulation**\n\nThe physical coordinates $(x,y)$ within the element are mapped from the natural coordinates $(\\xi, \\eta) \\in [-1,1]^2$ using standard bilinear shape functions $N_i(\\xi, \\eta)$:\n$$\n\\mathbf{x}(\\xi, \\eta) = \\sum_{i=1}^4 N_i(\\xi, \\eta) \\mathbf{X}_i\n$$\nwhere $\\mathbf{X}_i$ are the nodal coordinates. For the specified parallelogram geometry:\n$$\n\\mathbf{X}_1 = \\left(-\\tfrac{a}{2}, -\\tfrac{b}{2}\\right), \\quad \\mathbf{X}_2 = \\left(\\tfrac{a}{2}, -\\tfrac{b}{2}\\right), \\quad \\mathbf{X}_3 = \\left(\\tfrac{a}{2} + s\\,b, \\tfrac{b}{2}\\right), \\quad \\mathbf{X}_4 = \\left(-\\tfrac{a}{2} + s\\,b, \\tfrac{b}{2}\\right)\n$$\na direct substitution and algebraic simplification yield the explicit mapping:\n$$\nx(\\xi, \\eta) = \\frac{a}{2}\\xi + \\frac{sb}{2}(1+\\eta) \\qquad y(\\xi, \\eta) = \\frac{b}{2}\\eta\n$$\nThe Jacobian matrix of this transformation, $\\mathbf{J} = \\partial(x,y)/\\partial(\\xi,\\eta)$, is found by differentiation:\n$$\n\\mathbf{J} = \\begin{pmatrix} \\partial x / \\partial \\xi & \\partial y / \\partial \\xi \\\\ \\partial x / \\partial \\eta & \\partial y / \\partial \\eta \\end{pmatrix} = \\begin{pmatrix} a/2 & 0 \\\\ sb/2 & b/2 \\end{pmatrix}^T = \\begin{pmatrix} a/2 & sb/2 \\\\ 0 & b/2 \\end{pmatrix}\n$$\nSince the entries of $\\mathbf{J}$ are constant, the Jacobian is uniform throughout the element, a characteristic property of parallelograms. Its determinant is $\\det(\\mathbf{J}) = ab/4$. The element area is $A_e = \\int_{-1}^1\\int_{-1}^1 \\det(\\mathbf{J}) \\,d\\xi d\\eta = 4 \\det(\\mathbf{J}) = ab$.\n\nThe distortion of the element is measured by the spectral condition number of the Jacobian, $\\kappa_{\\max} = \\mathrm{cond}_2(\\mathbf{J}) = \\sigma_{\\max}(\\mathbf{J}) / \\sigma_{\\min}(\\mathbf{J})$, where $\\sigma_{\\max}$ and $\\sigma_{\\min}$ are the maximum and minimum singular values of $\\mathbf{J}$. These are the square roots of the eigenvalues of $\\mathbf{J}^T\\mathbf{J}$.\n\n**2. Manufactured Shear Field and Energy Calculation**\n\nA manufactured kinematic field is provided, leading to shear strain fields that are linear in $x$ and $y$:\n$$\n\\gamma_x(x,y) = k_{xx} x + k_{xy} y \\qquad \\gamma_y(x,y) = k_{yx} x + k_{yy} y\n$$\nThe coefficients are defined by the material and manufactured field constants:\n$k_{xx} = A_1 + 2C_1 = 0.02 + 2(10^{-3}) = 0.022 \\text{ m}^{-1}$\n$k_{xy} = A_2 + C_3 = -0.01 - 10^{-3} = -0.011 \\text{ m}^{-1}$\n$k_{yx} = B_1 + C_3 = 0.015 - 10^{-3} = 0.014 \\text{ m}^{-1}$\n$k_{yy} = B_2 + 2C_2 = 0.005 + 2(2 \\cdot 10^{-3}) = 0.009 \\text{ m}^{-1}$\n\nThe true shear energy $\\mathcal{E}_{\\mathrm{true}}$ requires integrating the squared shear strains over the element area:\n$$\n\\mathcal{E}_{\\mathrm{true}} = \\frac{1}{2}\\kappa_s G t \\int_{\\Omega_e} (\\gamma_x^2 + \\gamma_y^2) \\,dA = \\frac{1}{2}\\kappa_s G t \\int_{-1}^1 \\int_{-1}^1 \\left(\\gamma_x(\\xi,\\eta)^2 + \\gamma_y(\\xi,\\eta)^2\\right) \\det(\\mathbf{J})\\,d\\xi d\\eta\n$$\nwhere $G = E/(2(1+\\nu))$. This integral is computed numerically using $5\\times 5$ Gaussian quadrature.\n\nThe ANS shear energy $\\mathcal{E}_{\\mathrm{ANS}}$ relies on strain samples at specific locations. For the symmetric-weight case ($w_1=w_2=1/2$), the ANS shear strains are:\n$$\n\\gamma_x^{\\mathrm{ANS}} = \\frac{1}{2}(s^{(x)}_1 + s^{(x)}_2) \\qquad \\gamma_y^{\\mathrm{ANS}} = \\frac{1}{2}(s^{(y)}_1 + s^{(y)}_2)\n$$\nThe samples $s^{(\\cdot)}_j$ are evaluated at the physical coordinates corresponding to the ANS natural-coordinate sampling points:\n- For $\\gamma_x$: points $\\mathbf{p}^x_1=(0,-1), \\mathbf{p}^x_2=(0,1)$ map to $\\mathbf{x}^x_1=(0, -b/2), \\mathbf{x}^x_2=(sb, b/2)$.\n- For $\\gamma_y$: points $\\mathbf{p}^y_1=(-1,0), \\mathbf{p}^y_2=(1,0)$ map to $\\mathbf{x}^y_1=(-a/2+sb/2, 0), \\mathbf{x}^y_2=(a/2+sb/2, 0)$.\n\nThe corresponding strain samples are:\n$s^{(x)}_1 = \\gamma_x(\\mathbf{x}^x_1) = k_{xy}(-b/2)$\n$s^{(x)}_2 = \\gamma_x(\\mathbf{x}^x_2) = k_{xx}(sb) + k_{xy}(b/2)$\n$s^{(y)}_1 = \\gamma_y(\\mathbf{x}^y_1) = k_{yx}(-a/2+sb/2)$\n$s^{(y)}_2 = \\gamma_y(\\mathbf{x}^y_2) = k_{yx}(a/2+sb/2)$\n\nThe ANS energy is then $\\mathcal{E}_{\\mathrm{ANS}} = \\frac{1}{2} \\kappa_s G t A_e [(\\gamma_x^{\\mathrm{ANS}})^2 + (\\gamma_y^{\\mathrm{ANS}})^2]$.\n\n**3. Corrective Weights Analysis**\n\nThe problem proposes a correction scheme where the weights $w_i^{(\\cdot)}$ are chosen to match the element-average shear strains, $\\bar{\\gamma}_x$ and $\\bar{\\gamma}_y$. For a field linear in coordinates over a parallelogram domain, the area average is simply the value at the centroid. The centroid of the element is $(\\bar{x}, \\bar{y}) = (sb/2, 0)$.\nThus, the average strains are:\n$$\n\\bar{\\gamma}_x = \\frac{1}{A_e}\\int_{\\Omega_e} \\gamma_x \\,dA = \\gamma_x(\\bar{x},\\bar{y}) = k_{xx}(sb/2)\n$$\n$$\n\\bar{\\gamma}_y = \\frac{1}{A_e}\\int_{\\Omega_e} \\gamma_y \\,dA = \\gamma_y(\\bar{x},\\bar{y}) = k_{yx}(sb/2)\n$$\nLet's examine the ANS strains with symmetric weights:\n$$\n\\gamma_x^{\\mathrm{ANS}} = \\frac{1}{2}(s^{(x)}_1 + s^{(x)}_2) = \\frac{1}{2}[ k_{xy}(-b/2) + k_{xx}(sb) + k_{xy}(b/2) ] = k_{xx}(sb/2) = \\bar{\\gamma}_x\n$$\n$$\n\\gamma_y^{\\mathrm{ANS}} = \\frac{1}{2}(s^{(y)}_1 + s^{(y)}_2) = \\frac{1}{2}[ k_{yx}(-a/2+sb/2) + k_{yx}(a/2+sb/2) ] = k_{yx}(sb/2) = \\bar{\\gamma}_y\n$$\nThis reveals a crucial property of the problem setup: for the specified linear manufactured shear field, the standard symmetric-weight ANS formulation already produces constant shear values that are identical to the element-average shear strains.\n\nThe formula for the corrective weight $w_1^{(x)}$ is $w_1^{(x)} = (\\bar{\\gamma}_x - s_2^{(x)}) / (s_1^{(x)} - s_2^{(x)})$. Substituting $\\bar{\\gamma}_x = (s_1^{(x)} + s_2^{(x)})/2$ yields:\n$$\nw_1^{(x)} = \\frac{\\frac{1}{2}(s_1^{(x)} + s_2^{(x)}) - s_2^{(x)}}{s_1^{(x)} - s_2^{(x)}} = \\frac{\\frac{1}{2}(s_1^{(x)} - s_2^{(x)})}{s_1^{(x)} - s_2^{(x)}} = \\frac{1}{2}\n$$\nThis holds provided the denominator $s_1^{(x)} - s_2^{(x)} \\neq 0$. If it is zero, the default value is $1/2$. Therefore, the \"corrected\" weight $w_1^{(x)}$ is always $1/2$. An identical derivation shows $w_1^{(y)} = 1/2$.\n\nConsequently, the proposed corrective scheme results in the same weights as the standard symmetric ANS. The corrected energy $\\mathcal{E}_{\\mathrm{corr}}$ will be identical to the initial $\\mathcal{E}_{\\mathrm{ANS}}$, and the corrected error $e_{\\mathrm{corr}}$ will be identical to the initial error $e$. The error $e$ arises not from a mismatch in the mean strain, but from the variance of the strain field within the element, as $\\mathcal{E}_{\\mathrm{ANS}} \\propto (\\bar{\\gamma})^2$ while $\\mathcal{E}_{\\mathrm{true}} \\propto \\overline{\\gamma^2}$. By Jensen's inequality, $\\overline{\\gamma^2} \\ge (\\bar{\\gamma})^2$.\n\n**4. Drilling Stabilization**\n\nThe problem requires stating a drilling stabilization coefficient. For a full solid-shell formulation, an artificial stiffness is added to the drilling degree of freedom (rotation about the shell normal) to prevent spurious zero-energy modes. The problem defines this as $\\alpha_d = 10^{-6} E t$. With the given values, $E=210\\times 10^{9}\\ \\text{Pa}$ and $t=0.01\\ \\text{m}$, we find:\n$$\n\\alpha_d = 10^{-6} \\times (210 \\times 10^9 \\text{ N/m}^2) \\times (0.01 \\text{ m}) = 2100 \\text{ N/m}\n$$\nWhile the units N/m are unconventional for a rotational stiffness penalty (which should be N$\\cdot$m), we report the value as specified. This coefficient is not used in the subsequent numerical calculations, which concern only the transverse shear energy.\n\n**5. Computational Implementation**\n\nThe calculations are performed for each $(r,s)$ pair in the test suite. The process involves:\n1.  Set element geometry ($a=r \\cdot b$, with $b=1.0$).\n2.  Compute the constant Jacobian $\\mathbf{J}$ and its condition number $\\kappa_{\\max}$.\n3.  Calculate the ANS shear strain samples and the resulting $\\mathcal{E}_{\\mathrm{ANS}}$ using symmetric weights.\n4.  Numerically compute $\\mathcal{E}_{\\mathrm{true}}$ using $5\\times 5$ Gaussian quadrature.\n5.  Calculate the relative error $e$ and determine the failure flag.\n6.  Calculate the corrective weights (which will be $0.5$) and the corrected error $e_{\\mathrm{corr}}$ (which will equal $e$).\n7.  Collect and format the results as specified.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the degenerated shell element problem for a series of test cases.\n    \"\"\"\n    # Fixed physical and manufactured solution parameters\n    E = 210e9  # Young's modulus in Pa\n    nu = 0.3    # Poisson's ratio\n    t = 0.01    # Thickness in m\n    kappa_s = 5.0 / 6.0  # Shear correction factor\n    b = 1.0     # Element height in m\n\n    # Manufactured solution coefficients\n    A1 = 0.02\n    A2 = -0.01\n    B1 = 0.015\n    B2 = 0.005\n    C1 = 1e-3\n    C2 = 2e-3\n    C3 = -1e-3\n\n    # Derived constants\n    G = E / (2.0 * (1.0 + nu))\n    kxx = A1 + 2.0 * C1\n    kxy = A2 + C3\n    kyx = B1 + C3\n    kyy = B2 + 2.0 * C2\n\n    # Test cases: (r, s)\n    test_cases = [\n        (1.0, 0.0),  # Case 1: Square\n        (4.0, 0.0),  # Case 2: Slender rectangle\n        (1.0, 0.6),  # Case 3: Slanted square\n        (0.25, 0.8), # Case 4: Distorted slender\n    ]\n\n    # 5-point Gauss-Legendre quadrature points and weights\n    gauss_pts, gauss_wts = np.polynomial.legendre.leggauss(5)\n\n    all_results = []\n\n    for r, s in test_cases:\n        a = r * b\n\n        # 1. Isoparametric mapping and Jacobian\n        J = np.array([[a / 2.0, s * b / 2.0], [0.0, b / 2.0]])\n        detJ = np.linalg.det(J)\n        \n        # Compute condition number kappa_max\n        if np.linalg.det(J) != 0:\n            s_vals = np.linalg.svd(J, compute_uv=False)\n            kappa_max = s_vals.max() / s_vals.min()\n        else:\n            kappa_max = np.inf\n\n        # 2. Shear samples and ANS energy (symmetric weights)\n        s_x1 = kxy * (-b / 2.0)\n        s_x2 = kxx * s * b + kxy * (b / 2.0)\n        s_y1 = kyx * (-a / 2.0 + s * b / 2.0)\n        s_y2 = kyx * (a / 2.0 + s * b / 2.0)\n\n        gamma_x_ans = 0.5 * (s_x1 + s_x2)\n        gamma_y_ans = 0.5 * (s_y1 + s_y2)\n        \n        Ae = a * b\n        E_ans = 0.5 * kappa_s * G * t * Ae * (gamma_x_ans**2 + gamma_y_ans**2)\n\n        # 3. True energy (numerical integration)\n        integral_val = 0.0\n        for xi, w_xi in zip(gauss_pts, gauss_wts):\n            for eta, w_eta in zip(gauss_pts, gauss_wts):\n                # Map from natural to physical coordinates\n                x = (a / 2.0) * xi + (s * b / 2.0) * (1.0 + eta)\n                y = (b / 2.0) * eta\n                \n                # Evaluate shear strains at quadrature point\n                gamma_x = kxx * x + kxy * y\n                gamma_y = kyx * x + kyy * y\n                \n                integrand = gamma_x**2 + gamma_y**2\n                integral_val += w_xi * w_eta * integrand\n        \n        E_true = 0.5 * kappa_s * G * t * integral_val * detJ\n\n        # 4. Relative error and failure flag\n        if E_true > 1e-15:\n            e = abs(E_ans - E_true) / E_true\n        else: # Handle cases where E_true is zero (e.g. if all coeffs are zero)\n            e = abs(E_ans)\n\n        fail_flag = 1 if e > 0.2 or kappa_max > 8.0 else 0\n\n        # 5. Corrected weights and corrected error\n        # As derived, for this linear manufactured solution, the symmetric ANS\n        # already matches the element-average shear. Thus, the corrective\n        # procedure yields the same symmetric weights.\n        \n        # Calculate element-average shear (value at centroid)\n        x_bar, y_bar = s * b / 2.0, 0.0\n        avg_gamma_x = kxx * x_bar + kxy * y_bar\n        avg_gamma_y = kyx * x_bar + kyy * y_bar\n        \n        # Calculate weights for gamma_x\n        denom_x = s_x1 - s_x2\n        if abs(denom_x) < 1e-12:\n            w_x1 = 0.5\n        else:\n            w_x1 = (avg_gamma_x - s_x2) / denom_x\n        w_x2 = 1.0 - w_x1\n\n        # Calculate weights for gamma_y\n        denom_y = s_y1 - s_y2\n        if abs(denom_y) < 1e-12:\n            w_y1 = 0.5\n        else:\n            w_y1 = (avg_gamma_y - s_y2) / denom_y\n        w_y2 = 1.0 - w_y1\n\n        # Calculate corrected energy and error\n        _gamma_x_corr = w_x1 * s_x1 + w_x2 * s_x2\n        _gamma_y_corr = w_y1 * s_y1 + w_y2 * s_y2\n        E_corr = 0.5 * kappa_s * G * t * Ae * (_gamma_x_corr**2 + _gamma_y_corr**2)\n        \n        if E_true > 1e-15:\n            e_corr = abs(E_corr - E_true) / E_true\n        else:\n            e_corr = abs(E_corr)\n\n        case_results = [\n            kappa_max, e, fail_flag,\n            w_x1, w_x2, w_y1, w_y2, e_corr\n        ]\n        all_results.append(case_results)\n\n    # Format output as a list of lists string\n    stringified_results = []\n    for res_list in all_results:\n        stringified_results.append(\"[\" + \",\".join(f\"{x:.8f}\" for x in res_list) + \"]\")\n    \n    print(\"[\" + \",\".join(stringified_results) + \"]\")\n\nsolve()\n```"
        }
    ]
}