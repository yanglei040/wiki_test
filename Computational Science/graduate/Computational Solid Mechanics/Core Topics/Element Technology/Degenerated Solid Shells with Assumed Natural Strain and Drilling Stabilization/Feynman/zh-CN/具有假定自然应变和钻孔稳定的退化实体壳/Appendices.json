{
    "hands_on_practices": [
        {
            "introduction": "理论学习之后，最好的巩固方式就是动手实践。第一个练习将带领我们直接进入计算核心，处理一个简化的八节点退化实体壳单元。本练习旨在通过一个给定的运动学场，手算由假定自然应变（ANS）修正的横向剪切能和钻孔稳定项共同贡献的刚度。通过这个具体的计算，你将清晰地看到每个部分如何对单元的总刚度产生影响，从而加深对锁定控制和奇异性消除这两种技术如何协同工作的理解。",
            "id": "3557460",
            "problem": "考虑一个八节点三线性退化实体壳有限元，该单元代表一个面内尺寸为 $a \\times b$、厚度为 $t$ 的平坦矩形板。该板由各向同性、线性弹性材料制成，其杨氏模量为 $E$，泊松比为 $\\nu$，剪切模量 $G$ 定义为 $G = E / \\left( 2 \\left( 1 + \\nu \\right) \\right)$。自然坐标域为 $\\left( \\xi, \\eta, \\zeta \\right) \\in \\left[ -1, 1 \\right]^{3}$，到物理坐标的等参映射是线性的，并与单元轴对齐：$x = \\left( a / 2 \\right) \\xi$，$y = \\left( b / 2 \\right) \\eta$，$z = \\left( t / 2 \\right) \\zeta$。此映射的雅可比行列式为常数。\n\n您将使用张量积高斯积分法则，在自然域上采用 $2 \\times 2 \\times 1$ 的方案。首先，确定在每个参数方向上定义此 $2 \\times 2 \\times 1$ 法则的高斯点和相应权重。然后，对于以下运动学场，评估与横向剪切贡献相关的标量刚度积分，该贡献已通过假定自然应变 (ANS) 技术和钻孔稳定项进行了修正：\n\n- 横向位移场为 $w \\left( x, y \\right) = q \\, x$，其中 $q$ 是一个标量振幅参数。\n- 面内位移和弯曲转动被抑制：$u_{x} \\left( x, y, z \\right) = 0$ 和 $u_{y} \\left( x, y, z \\right) = 0$，且 $\\theta_{x} = 0$ 和 $\\theta_{y} = 0$。\n- 沿厚度轴的钻孔转动存在且空间恒定：$\\theta_{z} \\left( x, y \\right) = q$。转动以弧度为单位。\n\n采用退化实体壳的标准小应变定义下的横向剪切应变，即 $\\gamma_{xz} = \\partial w / \\partial x + \\partial u_{x} / \\partial z$ 和 $\\gamma_{yz} = \\partial w / \\partial y + \\partial u_{y} / \\partial z$。在给定的场下，这些应变会相应简化。假定自然应变 (ANS) 技术用一个内插场来替换原始横向剪切应变，该内插场由单元中面上自然点处的边值采样构建。在双线性单元中，ANS 场能精确再现 $\\left( \\xi, \\eta \\right)$ 中的恒定剪切应变。\n\n设钻孔稳定化被建模为一个能量罚函数，其能量密度为 $\\left( 1 / 2 \\right) c_{d} \\, \\theta_{z}^{2}$，其中 $c_{d} > 0$ 是一个具有应力单位的稳定化模量。与振幅 $q$ 相关的标量刚度 $k_{\\text{total}}$ 定义为 $k_{\\text{total}} = \\partial^{2} U / \\partial q^{2}$，其中 $U$ 是总应变能，包括 ANS 修正的横向剪切能和钻孔稳定能。\n\n使用 $2 \\times 2 \\times 1$ 高斯法则和给定的运动学场，以 $a$、$b$、$t$、$E$、$\\nu$ 和 $c_{d}$ 的函数形式，计算 $k_{\\text{total}}$ 的闭合解。不代入任何数值。将最终答案表示为单个解析表达式。无需四舍五入。如果引入角度，请确保其单位为弧度。",
            "solution": "所述问题具有科学依据，提法恰当，并包含足够的信息以获得唯一解。因此，我们可以进行推导。\n\n总标量刚度 $k_{\\text{total}}$ 源于总应变能 $U$，它是横向剪切应变能 $U_{\\text{shear}}$ 和钻孔稳定能 $U_{\\text{drill}}$ 的和。刚度定义为 $k_{\\text{total}} = \\frac{\\partial^{2} U}{\\partial q^{2}}$。我们将使用指定的 $2 \\times 2 \\times 1$ 高斯求积方案计算每个能量分量。\n\n首先，我们定义在域 $(\\xi, \\eta, \\zeta) \\in [-1, 1]^3$ 上张量积高斯法则的积分点和权重。\n对于 $\\xi$ 和 $\\eta$ 方向上的 $2$ 点法则，积分点为 $\\pm 1/\\sqrt{3}$，权重为 $1$。\n- $\\xi$ 方向：积分点 $\\xi_1 = -1/\\sqrt{3}$, $\\xi_2 = 1/\\sqrt{3}$；权重 $W_{\\xi,1} = 1$, $W_{\\xi,2} = 1$。\n- $\\eta$ 方向：积分点 $\\eta_1 = -1/\\sqrt{3}$, $\\eta_2 = 1/\\sqrt{3}$；权重 $W_{\\eta,1} = 1$, $W_{\\eta,2} = 1$。\n对于 $\\zeta$ 方向上的 $1$ 点法则，积分点为 $0$，权重为 $2$。\n- $\\zeta$ 方向：积分点 $\\zeta_1 = 0$；权重 $W_{\\zeta,1} = 2$。\n\n应变能通过在单元体积 $V$ 上对能量密度进行积分来计算。在自然坐标系中，体积微元为 $dV = \\det(J) \\, d\\xi \\, d\\eta \\, d\\zeta$，其中 $J$ 是等参映射的雅可比矩阵。\n映射由 $x = \\frac{a}{2} \\xi$，$y = \\frac{b}{2} \\eta$，$z = \\frac{t}{2} \\zeta$ 给出。雅可比矩阵为：\n$$\nJ = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial x}{\\partial \\eta} & \\frac{\\partial x}{\\partial \\zeta} \\\\ \\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\eta} & \\frac{\\partial y}{\\partial \\zeta} \\\\ \\frac{\\partial z}{\\partial \\xi} & \\frac{\\partial z}{\\partial \\eta} & \\frac{\\partial z}{\\partial \\zeta} \\end{pmatrix} = \\begin{pmatrix} \\frac{a}{2} & 0 & 0 \\\\ 0 & \\frac{b}{2} & 0 \\\\ 0 & 0 & \\frac{t}{2} \\end{pmatrix}\n$$\n雅可比行列式为常数：\n$$\n\\det(J) = \\left( \\frac{a}{2} \\right) \\left( \\frac{b}{2} \\right) \\left( \\frac{t}{2} \\right) = \\frac{abt}{8}\n$$\n\n接下来，我们计算横向剪切应变。定义为 $\\gamma_{xz} = \\frac{\\partial w}{\\partial x} + \\frac{\\partial u_x}{\\partial z}$ 和 $\\gamma_{yz} = \\frac{\\partial w}{\\partial y} + \\frac{\\partial u_y}{\\partial z}$。\n问题指定了运动学场：$w(x, y) = qx$，$u_x = 0$，$u_y = 0$。\n偏导数为：\n$$\n\\frac{\\partial w}{\\partial x} = \\frac{\\partial(qx)}{\\partial x} = q\n\\quad, \\quad\n\\frac{\\partial w}{\\partial y} = \\frac{\\partial(qx)}{\\partial y} = 0\n$$\n$$\n\\frac{\\partial u_x}{\\partial z} = 0\n\\quad, \\quad\n\\frac{\\partial u_y}{\\partial z} = 0\n$$\n将这些代入应变定义，得到“原始”横向剪切应变：\n$$\n\\gamma_{xz}^{\\text{raw}} = q + 0 = q\n$$\n$$\n\\gamma_{yz}^{\\text{raw}} = 0 + 0 = 0\n$$\n采用假定自然应变 (ANS) 方法。对于双线性单元，ANS 公式能精确再现自然坐标 $(\\xi, \\eta)$ 中恒定的剪切应变场。由于 $\\gamma_{xz}^{\\text{raw}} = q$ 和 $\\gamma_{yz}^{\\text{raw}} = 0$ 在整个单元内都是空间常数，因此它们在物理坐标和自然坐标中都是常数。所以，ANS 修正的应变与原始应变相同：\n$$\n\\gamma_{xz}^{\\text{ANS}} = q\n\\quad, \\quad\n\\gamma_{yz}^{\\text{ANS}} = 0\n$$\n\n现在我们可以计算横向剪切应变能 $U_{\\text{shear}}$。能量密度为 $\\frac{1}{2} G (\\gamma_{xz}^2 + \\gamma_{yz}^2)$。总剪切能是该密度在体积上的积分：\n$$\nU_{\\text{shear}} = \\int_{V} \\frac{1}{2} G \\left( (\\gamma_{xz}^{\\text{ANS}})^2 + (\\gamma_{yz}^{\\text{ANS}})^2 \\right) dV = \\int_{V} \\frac{1}{2} G (q^2 + 0^2) dV = \\frac{1}{2} G q^2 \\int_{V} dV\n$$\n在自然坐标中，这表示为：\n$$\nU_{\\text{shear}} = \\int_{-1}^{1} \\int_{-1}^{1} \\int_{-1}^{1} \\frac{1}{2} G q^2 \\det(J) \\, d\\xi \\, d\\eta \\, d\\zeta = \\int_{-1}^{1} \\int_{-1}^{1} \\int_{-1}^{1} \\frac{1}{2} G q^2 \\left( \\frac{abt}{8} \\right) d\\xi \\, d\\eta \\, d\\zeta\n$$\n被积函数为常数。使用 $2 \\times 2 \\times 1$ 高斯求积，该积分被评估为对 $4$ 个积分点 $(\\xi_i, \\eta_j, \\zeta_1)$ 的求和：\n$$\nU_{\\text{shear}} \\approx \\sum_{i=1}^{2} \\sum_{j=1}^{2} \\left[ \\frac{1}{2} G q^2 \\frac{abt}{8} \\right] W_{\\xi,i} W_{\\eta,j} W_{\\zeta,1}\n$$\n由于被积函数是常数，且每个点的权重为 $W_{\\xi,i}=1$, $W_{\\eta,j}=1$, $W_{\\zeta,1}=2$，所以 $4$ 个点中每个点的总权重为 $1 \\cdot 1 \\cdot 2 = 2$。\n$$\nU_{\\text{shear}} = \\left( \\frac{G q^2 abt}{16} \\right) \\times ( (1)(1)(2) + (1)(1)(2) + (1)(1)(2) + (1)(1)(2) ) = \\frac{G q^2 abt}{16} \\times 8 = \\frac{1}{2} G q^2 abt\n$$\n由于被积函数是常数，高斯求积是精确的。\n\n接下来，我们计算钻孔稳定能 $U_{\\text{drill}}$。能量密度给定为 $\\frac{1}{2} c_d \\theta_z^2$，其中 $\\theta_z = q$。稳定化模量 $c_d$ 的单位是应力（力/面积），因此能量通过在单元体积上对该密度进行积分得到：\n$$\nU_{\\text{drill}} = \\int_{V} \\frac{1}{2} c_d \\theta_z^2 dV = \\int_{V} \\frac{1}{2} c_d q^2 dV = \\frac{1}{2} c_d q^2 \\int_{V} dV\n$$\n与剪切能类似，被积函数是常数。积分结果为单元的体积 $abt$。\n$$\nU_{\\text{drill}} = \\frac{1}{2} c_d q^2 (abt)\n$$\n这个结果也可以通过指定的高斯积分方案精确得到。\n\n总应变能 $U$ 是这两个贡献之和：\n$$\nU(q) = U_{\\text{shear}} + U_{\\text{drill}} = \\frac{1}{2} G q^2 abt + \\frac{1}{2} c_d q^2 abt = \\frac{1}{2} (G + c_d) q^2 abt\n$$\n标量刚度 $k_{\\text{total}}$ 是总能量关于振幅参数 $q$ 的二阶导数：\n$$\nk_{\\text{total}} = \\frac{\\partial^2 U}{\\partial q^2} = \\frac{\\partial^2}{\\partial q^2} \\left[ \\frac{1}{2} (G + c_d) q^2 abt \\right]\n$$\n一阶导数为：\n$$\n\\frac{\\partial U}{\\partial q} = (G + c_d) q abt\n$$\n二阶导数为：\n$$\nk_{\\text{total}} = (G + c_d) abt\n$$\n最后，我们代入给定的剪切模量表达式 $G = E / (2(1+\\nu))$，以所需参数表示刚度：\n$$\nk_{\\text{total}} = \\left( \\frac{E}{2(1+\\nu)} + c_d \\right) abt\n$$\n这是标量刚度的最终闭合形式表达式。",
            "answer": "$$\\boxed{\\left( \\frac{E}{2(1+\\nu)} + c_{d} \\right) abt}$$"
        },
        {
            "introduction": "在上一个练习中，我们使用了给定的钻孔稳定化模量。一个自然而然的问题是：这些参数从何而来？本练习将探讨钻孔刚度参数 $\\alpha$ 的标定，这是一个在有限元开发中至关重要的实践问题。我们将通过一种基于能量匹配的物理启发方法，将钻孔稳定能与横向剪切能相等同，从而推导出稳定参数的标度律。这个过程展示了有限元参数并非随意设定，而是可以通过理性的物理和数值考量来确定，以保证单元的客观性和收敛性。",
            "id": "3557520",
            "problem": "一个采用假定自然应变 (ANS) 运动学的四节点退化实体壳有限元被用于模拟一个薄的、平坦的各向同性板。该板的厚度为 $t$，边长为 $h$（方形单元），材料的杨氏模量为 $E$，泊松比为 $\\nu$。为了正则化原本病态的钻孔转动（绕壳法线的转动）自由度，在弱形式中增加了一个稳定项。该稳定项是基于边的最小二乘罚函数，作用于独立钻孔转动与从位移梯度中提取的ANS一致自然转动之间的残差。\n\n具体来说，将每个单元边上的钻孔残差定义为 $r_{e} = \\theta_{d} - \\theta_{\\text{nat}}$，其中 $\\theta_{d}$ 是独立的钻孔转动，$\\theta_{\\text{nat}}$ 是从位移场重构的自然钻孔转动。在单元层面增加的稳定能为\n$$\nU_{d} \\;=\\; \\frac{1}{2} \\sum_{e=1}^{4} \\int_{e} \\alpha \\, r_{e}^{2} \\,\\mathrm{d}s,\n$$\n其中 $\\alpha$ 是待确定的钻孔刚度参数，$s$ 表示沿单元边的坐标。这种构造保证了客观性，因为在单元的任何刚体运动下，都有 $\\theta_{d} = \\theta_{\\text{nat}}$，因此 $r_{e} = 0$ 且 $U_{d} = 0$。\n\n对于一个各向同性的 Reissner–Mindlin 板，在大小为 $\\gamma$ 的均匀剪切应变作用下，每个单元的横向剪切能为\n$$\nU_{\\text{shear}} \\;=\\; \\frac{1}{2} \\,\\kappa \\, G \\, t \\int_{A} \\gamma^{2} \\,\\mathrm{d}A \\;=\\; \\frac{1}{2}\\,\\kappa \\, G \\, t \\, h^{2} \\,\\gamma^{2},\n$$\n其中 $A$ 是单元面积，$G = \\frac{E}{2(1+\\nu)}$ 是剪切模量，$\\kappa$ 是板的横向剪切修正因子（取 $\\kappa = \\frac{5}{6}$）。\n\n通过要求在一个基准状态下，稳定能 $U_{d}$ 等于上面计算的横向剪切能 $U_{\\text{shear}}$ 来标定 $\\alpha$。在该基准状态下，钻孔残差 $r_{e}$ 沿每条边是均匀的，并在运动学上等同于一个均匀的横向剪切角 $\\gamma$（即，为标定目的，设 $r_{e} \\equiv \\gamma$）。在此标定下，确定 $\\alpha$ 关于 $E$、$\\nu$、$t$ 和 $h$ 的闭式标度律。\n\n将你的最终答案表示为 $\\alpha(E,\\nu,t,h)$ 的单个解析表达式，并且不要在最终的方框答案中包含单位。不需要进行数值四舍五入。",
            "solution": "目标是通过在指定的标定状态下，将钻孔稳定能 $U_d$ 与横向剪切能 $U_{\\text{shear}}$ 联系起来，以确定钻孔刚度参数 $\\alpha$。\n\n问题给出了一个四节点方形单元在单元层面上的钻孔稳定能表达式：\n$$\nU_{d} = \\frac{1}{2} \\sum_{e=1}^{4} \\int_{e} \\alpha \\, r_{e}^{2} \\,\\mathrm{d}s\n$$\n此处，求和是对单元的四条边进行的，$s$ 是沿边的坐标，$r_e$ 是边 $e$ 的钻孔残差。\n\n一个面积为 $A=h^2$ 的 Reissner–Mindlin 板单元在承受均匀横向剪切应变 $\\gamma$ 时的横向剪切能给出为：\n$$\nU_{\\text{shear}} = \\frac{1}{2}\\,\\kappa \\, G \\, t \\int_{A} \\gamma^{2} \\,\\mathrm{d}A = \\frac{1}{2}\\,\\kappa \\, G \\, t \\, h^{2} \\,\\gamma^{2}\n$$\n其中 $\\kappa$ 是横向剪切修正因子，$G$ 是剪切模量，$t$ 是板厚，$h$ 是方形单元的边长。\n\n标定是在一个特定的运动学状态下进行的，在该状态下，钻孔残差 $r_e$ 沿每条边是常数，并被设为等于均匀的横向剪切角 $\\gamma$。也就是说，为标定目的，我们对所有四条边都有 $r_e = \\gamma$。\n\n我们在这些标定条件下计算 $U_d$ 的表达式。由于 $\\alpha$ 是一个常数参数，并且假定 $r_e$ 沿每条边均匀且值为 $\\gamma$，因此项 $\\alpha \\, r_e^2 = \\alpha \\, \\gamma^2$ 相对于线积分 $\\int_e \\mathrm{d}s$ 是一个常数。\n$$\nU_{d} = \\frac{1}{2} \\sum_{e=1}^{4} \\alpha \\, \\gamma^{2} \\int_{e} \\mathrm{d}s\n$$\n积分 $\\int_e \\mathrm{d}s$ 就是边 $e$ 的长度。对于边长为 $h$ 的方形单元，每条边的长度都是 $h$。因此，每条边的积分都是 $h$。\n$$\nU_{d} = \\frac{1}{2} \\sum_{e=1}^{4} \\alpha \\, \\gamma^{2} \\, h\n$$\n由于项 $\\alpha \\, \\gamma^{2} \\, h$ 对四条边中的每一条都是相同的，求和简化为将该项乘以4：\n$$\nU_{d} = \\frac{1}{2} \\left( 4 \\cdot (\\alpha \\, \\gamma^{2} \\, h) \\right) = 2 \\, \\alpha \\, h \\, \\gamma^{2}\n$$\n\n标定规则要求我们将稳定能 $U_d$ 与横向剪切能 $U_{\\text{shear}}$ 相等：\n$$\nU_{d} = U_{\\text{shear}}\n$$\n代入导出的 $U_d$ 表达式和给定的 $U_{\\text{shear}}$ 表达式：\n$$\n2 \\, \\alpha \\, h \\, \\gamma^{2} = \\frac{1}{2}\\,\\kappa \\, G \\, t \\, h^{2} \\,\\gamma^{2}\n$$\n为了求出 $\\alpha$，我们可以简化这个方程。假设一个非平凡的变形状态（$\\gamma \\neq 0$）和一个物理上存在的单元（$h > 0$），我们可以将方程两边同除以 $2 \\, h \\, \\gamma^2$：\n$$\n\\alpha = \\frac{\\frac{1}{2}\\,\\kappa \\, G \\, t \\, h^{2} \\,\\gamma^{2}}{2 \\, h \\, \\gamma^{2}}\n$$\n$$\n\\alpha = \\frac{1}{4} \\, \\kappa \\, G \\, t \\, h\n$$\n这个方程给出了 $\\alpha$ 的标度律。现在，我们必须代入所提供的材料和模型参数的表达式。剪切修正因子给出为 $\\kappa = \\frac{5}{6}$，剪切模量为 $G = \\frac{E}{2(1+\\nu)}$，其中 $E$ 是杨氏模量，$\\nu$ 是泊松比。\n\n将这些代入 $\\alpha$ 的表达式：\n$$\n\\alpha = \\frac{1}{4} \\left( \\frac{5}{6} \\right) \\left( \\frac{E}{2(1+\\nu)} \\right) t \\, h\n$$\n将数值系数相乘：\n$$\n\\alpha = \\frac{5}{4 \\times 6 \\times 2} \\frac{E \\, t \\, h}{1+\\nu}\n$$\n$$\n\\alpha = \\frac{5}{48} \\frac{E \\, t \\, h}{1+\\nu}\n$$\n这就是基于指定标定程序得出的钻孔刚度参数 $\\alpha$ 的最终闭式表达式。",
            "answer": "$$\\boxed{\\frac{5 E t h}{48(1+\\nu)}}$$"
        },
        {
            "introduction": "掌握了单元刚度的基本计算和稳定参数的标定后，我们现在将视野拔高，思考如何将所有这些概念整合到一个完整的算法流程中。这个练习要求你梳理出一个八节点实体壳单元的实现步骤，该单元同时采用了假定自然应变（ANS）技术来克服锁定，并加入了钻孔稳定化。通过构建这个算法蓝图，你将把孤立的知识点串联起来，为将来编写自己的有限元程序打下坚实的结构性基础。",
            "id": "3557482",
            "problem": "一个针对8节点等参实体壳有限元的假定自然应变（ANS）实现，旨在通过在母域中的特定位置对选定的应变分量进行采样来减轻剪切和厚度锁定，同时保持一致的变分格式。考虑一个具有节点平移自由度（DOF）和在母坐标$(\\xi,\\eta,\\zeta)\\in[-1,1]^3$上的三线性形函数的实体壳。该单元通过等参映射$\\mathbf{x}(\\xi,\\eta,\\zeta)=\\sum_{i=1}^{8}N_i(\\xi,\\eta,\\zeta)\\,\\mathbf{x}_i$映射到物理构型，其雅可比矩阵为$\\mathbf{J}(\\xi,\\eta,\\zeta)=\\partial \\mathbf{x}/\\partial \\boldsymbol{\\xi}$，其中$\\boldsymbol{\\xi}=(\\xi,\\eta,\\zeta)^T$。应变-位移矩阵$\\mathbf{B}$由形函数的物理导数构建，本构矩阵为$\\mathbf{D}$。钻孔模式是指围绕壳法线的寄生面内旋转，可能导致奇异刚度；钻孔稳定化引入了一致的刚度贡献来控制此模式，而不会污染薄膜和弯曲响应。\n\n从小应变线性弹性中的虚功原理和标准求积出发，您需要选择能正确描述如何执行以下操作的算法概要：\n\n- 计算雅可比矩阵$\\mathbf{J}$和形函数梯度的变换，\n- 在ANS采样点为选定应变分量评估应变-位移矩阵$\\mathbf{B}$，\n- 组装修正后的矩阵$\\mathbf{B}_{\\mathrm{ANS}}$，\n- 并对包括由围绕壳法线的旋转度量构建的钻孔稳定项在内的单元刚度进行积分。\n\n假设薄膜应变在标准高斯点进行积分，而横向剪切应变和厚度相关应变则用ANS采样处理。钻孔稳定化必须与运动学一致，对于刚体平移为零，并避免改变恒定的薄膜/弯曲场。哪个选项正确地概述了该算法？\n\nA. \n- 在每个标准高斯点$(\\xi_g,\\eta_g,\\zeta_g)$，计算$\\mathbf{J}(\\xi_g,\\eta_g,\\zeta_g)$，求逆以获得$N_i$的物理梯度，并构成完整的$\\mathbf{B}$。\n- 为横向剪切分量在中面上定义ANS点，为法向厚度应变在厚度方向上定义ANS点，例如，沿边缘的$(\\xi_a,\\eta_a,0)$用于$\\gamma_{13},\\gamma_{23}$，$(0,0,\\zeta_a)$用于$\\epsilon_{33}$；在每个ANS点，重新计算$\\mathbf{J}$以及仅针对这些分量的相应部分$\\mathbf{B}$行。\n- 在每个高斯点组装$\\mathbf{B}_{\\mathrm{ANS}}$，方法是用从各自ANS评估中插值得到的值替换$\\mathbf{B}$的剪切和厚度行，同时保留来自高斯点$\\mathbf{B}$的薄膜行。\n- 使用适当的求积法计算单元刚度$\\mathbf{K}_e=\\sum_{g} w_g\\,\\mathbf{B}_{\\mathrm{ANS}}(\\xi_g,\\eta_g,\\zeta_g)^T\\,\\mathbf{D}\\,\\mathbf{B}_{\\mathrm{ANS}}(\\xi_g,\\eta_g,\\zeta_g)\\,\\det\\mathbf{J}(\\xi_g,\\eta_g,\\zeta_g)$。\n- 构建一个钻孔稳定算子$\\mathbf{H}$，它将节点位移映射到面外旋转度量$\\omega_3=\\tfrac{1}{2}\\left(\\partial u_2/\\partial x_1 - \\partial u_1/\\partial x_2\\right)$，通过$\\tilde{\\omega}_3=\\omega_3-\\bar{\\omega}_3$（其中$\\bar{\\omega}_3$是单元平均值）进行修正以移除恒定场；用一个小的、与网格/客观性相关的$\\alpha$来积分$\\mathbf{K}_{\\mathrm{drill}}=\\sum_{g} w_g\\,\\alpha\\,\\mathbf{H}(\\xi_g,\\eta_g,\\zeta_g)^T\\,\\mathbf{H}(\\xi_g,\\eta_g,\\zeta_g)\\,\\det\\mathbf{J}(\\xi_g,\\eta_g,\\zeta_g)$，并设置$\\mathbf{K}=\\mathbf{K}_e+\\mathbf{K}_{\\mathrm{drill}}$。\n\nB.\n- 仅在ANS点评估所有应变分量，使用减缩的单点积分，并用单元中心的值近似$\\mathbf{J}$以节省计算。\n- 通过对所有分量的ANS点上的$\\mathbf{B}$进行平均来构造$\\mathbf{B}_{\\mathrm{ANS}}$，并且由于母域体积为1，积分$\\mathbf{K}_e$时省略$\\det\\mathbf{J}$。\n- 对于钻孔稳定化，在节点位移上施加一个与$\\alpha\\,\\mathbf{I}$成正比的对角罚矩阵以抑制任何刚体运动，并将其加到$\\mathbf{K}_e$上。\n\nC.\n- 在每次迭代更新的共旋框架中计算$\\mathbf{J}$和$\\mathbf{B}$；在高斯点形成$\\mathbf{B}$，并用ANS点的面平均值替换所有行，无论应变类型如何。\n- 用完全高斯求积法积分$\\mathbf{K}_e$，并通过将$\\mathbf{D}$中的材料剪切模量乘以一个因子$(1+\\alpha)$来稳定钻孔，从而间接惩罚面内旋转。\n- 跳过为钻孔显式构造一个单独的算子，因为材料刚化将抑制该模式。\n\nD.\n- 在单元中心使用单点求积计算$\\mathbf{J}$和$\\mathbf{B}$；通过添加在残差中直接惩罚剪切应变分量的沙漏控制力来校正剪切锁定。\n- 通过将中心点$\\mathbf{B}$与所有分量的边平均值混合来组装$\\mathbf{B}_{\\mathrm{ANS}}$，并用单个权重$w=2^3$计算$\\mathbf{K}_e$。\n- 通过惩罚每个节点引入的节点旋转参数来增加钻孔稳定化，即使单元仅使用平移自由度，并通过大的$\\alpha$将它们与位移场耦合。\n\n选择最佳选项。",
            "solution": "问题陈述科学合理、提法得当且客观。它准确地描述了计算固体力学中一个标准但高级的问题：无锁定且稳定的实体壳有限元的构建。它正确地指出了关键挑战（剪切和厚度锁定、钻孔不稳定性）以及用于解决这些挑战的现代技术（假定自然应变、一致的钻孔稳定化）。术语精确，并符合该领域已有的文献。该问题适用于严谨的求解。\n\n任务是为一个8节点等参实体壳单元确定正确的算法概要，该单元使用假定自然应变（ANS）方法来减轻锁定，并为钻孔模式添加一个一致的稳定项。该公式基于小应变线性弹性和仅节点平移自由度（DOF）。\n\n首先，让我们为这样一个单元建立理论基础。\n\n1.  **单元运动学和应变：**\n    位置向量$\\mathbf{x}$和位移向量$\\mathbf{u}$通过三线性形函数$N_i(\\boldsymbol{\\xi})$从节点值$\\mathbf{x}_i$和$\\mathbf{u}_i$插值得到，其中$\\boldsymbol{\\xi} = (\\xi, \\eta, \\zeta)^T$是母坐标。\n    $$ \\mathbf{x}(\\boldsymbol{\\xi}) = \\sum_{i=1}^{8} N_i(\\boldsymbol{\\xi}) \\mathbf{x}_i \\quad ; \\quad \\mathbf{u}(\\boldsymbol{\\xi}) = \\sum_{i=1}^{8} N_i(\\boldsymbol{\\xi}) \\mathbf{u}_i $$\n    无穷小应变张量$\\boldsymbol{\\epsilon}$是位移梯度的对称部分。为了计算它，我们需要$\\mathbf{u}$的物理导数，这通过使用雅可比矩阵$\\mathbf{J} = \\partial \\mathbf{x} / \\partial \\boldsymbol{\\xi}$的逆矩阵，利用链式法则获得。\n    $$ \\boldsymbol{\\epsilon} = \\frac{1}{2} \\left[ \\nabla \\mathbf{u} + (\\nabla \\mathbf{u})^T \\right] $$\n    这种关系以矩阵-向量形式表示为$\\boldsymbol{\\epsilon} = \\mathbf{B} \\mathbf{d}$，其中$\\mathbf{d}$是节点自由度向量，$\\mathbf{B}$是应变-位移矩阵。\n\n2.  **用于减轻锁定的假定自然应变（ANS）：**\n    在薄构型中，直接在高斯求积点评估$\\mathbf{B}$会导致非物理的、寄生的剪切和厚度应变，这种现象称为锁定。ANS方法通过重新定义易于锁定的应变分量来纠正这一点。这些分量不是在某个高斯点$\\boldsymbol{\\xi}_g$直接使用从位移场导出的应变，而是在一组特定的采样点（ANS点）进行评估，然后插值或投影到高斯点。这以一种弱的、平均的意义强制执行了所需的运动学约束（例如，薄壳的Kirchhoff-Love理论）。\n    - **横向剪切应变：** 对于厚度方向沿$\\zeta$方向的壳状单元，横向剪切应变（例如，在局部-母坐标系中的$\\gamma_{\\xi\\zeta}, \\gamma_{\\eta\\zeta}$）在单元中面（$\\zeta=0$处）的点上进行采样。\n    - **厚度法向应变：** 垂直于壳中面的应变（例如，$\\epsilon_{\\zeta\\zeta}$）在厚度方向的点上进行采样，通常是沿着$\\zeta$轴（$\\xi = \\eta = 0$处）。\n    - **薄膜/弯曲应变：** 面内应变（例如，$\\epsilon_{\\xi\\xi}, \\epsilon_{\\eta\\eta}, \\gamma_{\\xi\\eta}$）通常表现良好，并直接在高斯点计算。\n    结果是一个修正的应变-位移矩阵$\\mathbf{B}_{\\mathrm{ANS}}$，其中对应于薄膜应变的行来自标准的$\\mathbf{B}(\\boldsymbol{\\xi}_g)$，而用于剪切/厚度应变的行则由在各个ANS点对$\\mathbf{B}$的评估构建。\n\n3.  **钻孔稳定化：**\n    仅具有平移自由度的单元对围绕壳法向量的面内旋转没有刚度。这就是“钻孔”模式。为防止出现奇异刚度矩阵，会增加一个罚能。一种一致的方法是惩罚钻孔旋转的非恒定部分，$\\omega_3 = \\frac{1}{2}(\\partial u_2/\\partial x_1 - \\partial u_1/\\partial x_2)$。一个恒定的$\\omega_3$代表单元的刚性旋转，不应被惩罚。因此，稳定化惩罚的是与均值的偏差，$\\tilde{\\omega}_3 = \\omega_3 - \\bar{\\omega}_3$，其中$\\bar{\\omega}_3$是单元上的平均值。这确保了稳定项与恒定应变/弯曲场正交。相应的刚度为$\\mathbf{K}_{\\mathrm{drill}} = \\int_V \\alpha \\mathbf{H}^T \\mathbf{H} \\, dV$，其中$\\mathbf{H}$是将节点位移$\\mathbf{d}$映射到$\\tilde{\\omega}_3$的离散算子。参数$\\alpha$是一个小的罚因子，通常与材料的剪切模量有关。\n\n4.  **单元刚度矩阵：**\n    最终的单元刚度矩阵是材料本构刚度和钻孔稳定刚度之和，通过数值求积计算：\n    $$ \\mathbf{K} = \\mathbf{K}_e + \\mathbf{K}_{\\mathrm{drill}} = \\sum_g w_g \\mathbf{B}_{\\mathrm{ANS}}^T \\mathbf{D} \\mathbf{B}_{\\mathrm{ANS}} \\det\\mathbf{J} \\Big|_{\\boldsymbol{\\xi}_g} + \\sum_g w_g \\mathbf{H}^T (\\alpha) \\mathbf{H} \\det\\mathbf{J} \\Big|_{\\boldsymbol{\\xi}_g} $$\n    此处，$w_g$是求积权重，$\\mathbf{D}$是本构矩阵，$\\det\\mathbf{J}$是雅可比行列式。\n\n现在，我们根据这些原则评估各个选项。\n\n**对选项A的评估：**\n- 该选项正确地指出，完整的$\\mathbf{B}$矩阵最初是在每个高斯点$(\\xi_g, \\eta_g, \\zeta_g)$上概念化形成的。\n- 它准确地描述了ANS程序：在特定的、精心选择的ANS点上采样横向剪切分量（例如，$\\gamma_{13}, \\gamma_{23}$）和法向厚度分量（$\\epsilon_{33}$），并在这些点上重新计算雅可比矩阵和$\\mathbf{B}$的相关行。\n- 它正确地描述了在每个高斯点组装$\\mathbf{B}_{\\mathrm{ANS}}$的过程，即结合来自高斯点评估的薄膜应变行和源自ANS点评估的易锁定应变行。\n- 单元刚度$\\mathbf{K}_e$的公式是正确的，适当地使用了$\\mathbf{B}_{\\mathrm{ANS}}$和雅可比行列式$\\det\\mathbf{J}$。\n- 对钻孔稳定化的描述非常出色。它正确地识别了旋转度量$\\omega_3$，并且至关重要的是，它指明了需要惩罚一个修正的旋转$\\tilde{\\omega}_3 = \\omega_3 - \\bar{\\omega}_3$以移除恒定场，从而确保一致性并防止对物理弯曲/薄膜状态的污染。刚度贡献$\\mathbf{K}_{\\mathrm{drill}}$被正确地表述为一个二次罚项的积分。\n- 最终刚度被正确地给出为$\\mathbf{K} = \\mathbf{K}_e + \\mathbf{K}_{\\mathrm{drill}}$。\n该选项提供了一个教科书般正确、最先进的算法概要。\n**结论：正确。**\n\n**对选项B的评估：**\n- 该选项建议仅在ANS点评估*所有*应变分量并使用单点积分。这是不正确的。它将选择性的ANS方法与均匀减缩积分（URI）混淆了，后者是一种不同的技术。\n- 它建议将$\\mathbf{J}$近似为常数，这是一种粗略的简化，仅对未变形的矩形单元有效。\n- 它错误地指出刚度积分可以不使用$\\det\\mathbf{J}$。雅可比行列式是从母体积到物理体积转换的强制性比例因子，不能省略。\n- 钻孔稳定化方法，即在节点位移上添加一个对角罚矩阵$\\alpha \\mathbf{I}$，在根本上是有缺陷的。它会惩罚所有位移，包括刚体平移，而不会专门针对钻孔旋转。\n**结论：不正确。**\n\n**对选项C的评估：**\n- 该选项引入了“共旋框架”，这是一个用于大变形几何非线性分析的概念，与指定的小应变线性弹性问题无关。\n- 它错误地建议用平均值替换$\\mathbf{B}$的*所有*行，这违反了ANS的选择性原则。\n- 提议的钻孔稳定化方法，即夸大$\\mathbf{D}$中的材料剪切模量，是一种粗糙且物理上不正确的方法。它的目标是面内剪切刚度，而不是围绕法线的面内旋转。这种方法会污染单元的薄膜行为，而这正是一个好的稳定方案必须避免的。\n**结论：不正确。**\n\n**对选项D的评估：**\n- 该选项描述的是带沙漏控制的均匀减缩积分（URI），而不是ANS公式。URI使用单个积分点并添加稳定化来控制由此产生的伪零能模式（“沙漏”）。这是一种有效的单元技术，但不是问题所要求的。\n- 提议的钻孔稳定化是自相矛盾的。它建议惩罚“节点旋转参数”，但问题的前言和这类单元的前提是它*仅*具有平移自由度。人们不能惩罚单元运动学描述中不存在的参数。这完全描述了另一种单元的公式。\n**结论：不正确。**\n\n基于这一严谨的分析，选项A是唯一一个为具有假定自然应变和一致钻孔稳定化的高级实体壳单元提供了科学上和算法上正确的概要的选项，正如问题陈述中所描述的那样。",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}