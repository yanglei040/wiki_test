{
    "hands_on_practices": [
        {
            "introduction": "我们从八节点六面体单元（H8）的基础开始。这个练习将引导您从第一性原理出发，推导其形函数，理解等参映射（isoparametric mapping）如何将一个标准的立方体参考单元转换为物理空间中的实际单元，并最终计算其一致质量矩阵的一个关键项。通过这个实践，您将掌握 H8 单元公式化中最重要的基本构建模块。",
            "id": "3570555",
            "problem": "考虑在三维实体力学中用于有限元法 (FEM) 的八节点六面体 (H8) 等参有限元。参考单元占据参数域 $[-1,1] \\times [-1,1] \\times [-1,1]$，局部坐标为 $(\\xi,\\eta,\\zeta)$。物理单元是一个与全局笛卡尔坐标轴对齐的矩形砖块，边长分别为 $L_x$、$L_y$ 和 $L_z$，其顶点位于 $(0,0,0)$、$(L_x,0,0)$、$(L_x,L_y,0)$、$(0,L_y,0)$、$(0,0,L_z)$、$(L_x,0,L_z)$、$(L_x,L_y,L_z)$、$(0,L_y,L_z)$。质量密度是均匀的，等于 $\\rho$。\n\n从插值和等参映射的第一性原理出发，通过在八个角点 $(\\xi,\\eta,\\zeta) \\in \\{-1,1\\}^3$ 处强制满足节点插值特性，推导出参考域上的 H8 形函数。证明这些形函数在参考域上的单位分解特性。使用等参映射 $x(\\xi,\\eta,\\zeta) = \\sum_{i=1}^{8} N_i(\\xi,\\eta,\\zeta) \\, x_i$、$y(\\xi,\\eta,\\zeta) = \\sum_{i=1}^{8} N_i(\\xi,\\eta,\\zeta) \\, y_i$、$z(\\xi,\\eta,\\zeta) = \\sum_{i=1}^{8} N_i(\\xi,\\eta,\\zeta) \\, z_i$，推导上述矩形砖块的雅可比行列式 $J(\\xi,\\eta,\\zeta)$。\n\n然后，从连续体动能及其伽辽金离散化出发，写出与节点 $(\\xi,\\eta,\\zeta) = (-1,-1,-1)$ 相关的的一致质量矩阵项 $M_{11}$ 的表达式。对于给定的矩形砖块和均匀密度，精确计算 $M_{11}$。\n\n最后，当 $L_x = 1.2\\,\\mathrm{m}$、$L_y = 0.8\\,\\mathrm{m}$、$L_z = 0.5\\,\\mathrm{m}$ 和 $\\rho = 7{,}850\\,\\mathrm{kg/m^3}$ 时，计算 $M_{11}$ 的值。将最终结果四舍五入到四位有效数字。最终质量以千克 (kg) 表示。最终答案必须是一个实数值。",
            "solution": "首先验证问题，以确保其科学性、适定性和客观性。\n\n**第 1 步：提取已知条件**\n- 单元：八节点六面体 (H8) 等参有限元。\n- 领域：三维 (3D) 实体力学。\n- 参考单元：参数域 $[-1,1] \\times [-1,1] \\times [-1,1]$，局部坐标为 $(\\xi,\\eta,\\zeta)$。\n- 物理单元：边长为 $L_x$、$L_y$ 和 $L_z$ 的矩形砖块。\n- 顶点：砖块的 8 个顶点位于 $(0,0,0)$、$(L_x,0,0)$、$(L_x,L_y,0)$、$(0,L_y,0)$、$(0,0,L_z)$、$(L_x,0,L_z)$、$(L_x,L_y,L_z)$、$(0,L_y,L_z)$。\n- 材料属性：均匀的质量密度 $\\rho$。\n- 任务：\n  1. 推导 H8 形函数 $N_i(\\xi,\\eta,\\zeta)$。\n  2. 证明单位分解特性。\n  3. 推导映射的雅可比行列式 $J(\\xi,\\eta,\\zeta)$。\n  4. 写出节点 $(\\xi,\\eta,\\zeta) = (-1,-1,-1)$ 的一致质量矩阵项 $M_{11}$ 的表达式。\n  5. 解析计算 $M_{11}$。\n  6. 当 $L_x = 1.2\\,\\mathrm{m}$、$L_y = 0.8\\,\\mathrm{m}$、$L_z = 0.5\\,\\mathrm{m}$ 和 $\\rho = 7{,}850\\,\\mathrm{kg/m^3}$ 时，计算 $M_{11}$ 的值，并四舍五入到四位有效数字。\n\n**第 2 步：使用提取的已知条件进行验证**\n- **科学性：** 该问题是有限元法 (FEM) 在线性弹性动力学中的一个标准应用，植根于连续介质力学和数值分析的既定原理。所有概念都是计算固体力学的基础。\n- **适定性：** 问题提供了所有必要的几何数据、材料属性和定义，以推导出唯一且有意义的解。\n- **客观性：** 问题使用有限元法领域的精确、标准术语陈述，没有歧义或主观论断。\n\n该问题不违反任何无效标准。这是一个计算力学中完整、一致且标准的问题。\n\n**第 3 步：结论与行动**\n问题有效。将给出完整解法。\n\n**H8 形函数的推导**\nH8 单元的形函数是三线性多项式，由一维线性拉格朗日多项式的乘积构成。在参考域 $\\xi \\in [-1, 1]$ 中，一端为 $1$ 另一端为 $0$ 的线性基函数是 $L_{-1}(\\xi) = \\frac{1}{2}(1-\\xi)$ 和 $L_{+1}(\\xi) = \\frac{1}{2}(1+\\xi)$。\n\n对于位于角点 $(\\xi_i, \\eta_i, \\zeta_i)$（其中 $\\xi_i, \\eta_i, \\zeta_i \\in \\{-1, 1\\}$）的节点 $i$，其形函数 $N_i(\\xi, \\eta, \\zeta)$ 是由每个坐标方向上相应的线性函数的乘积形成的。这种构造方法内在地满足了节点插值特性 $N_i(\\xi_j, \\eta_j, \\zeta_j) = \\delta_{ij}$。\n\n节点 $i$ 的形函数的一般形式为：\n$$N_i(\\xi, \\eta, \\zeta) = \\left( \\frac{1}{2}(1 + \\xi_i\\xi) \\right) \\left( \\frac{1}{2}(1 + \\eta_i\\eta) \\right) \\left( \\frac{1}{2}(1 + \\zeta_i\\zeta) \\right) = \\frac{1}{8}(1 + \\xi_i\\xi)(1 + \\eta_i\\eta)(1 + \\zeta_i\\zeta)$$\n\n**单位分解特性**\n单位分解特性断言，所有形函数之和在单元内处处等于 $1$。我们必须证明 $\\sum_{i=1}^{8} N_i(\\xi, \\eta, \\zeta) = 1$。\n$$ \\sum_{i=1}^{8} N_i(\\xi, \\eta, \\zeta) = \\frac{1}{8} \\sum_{i=1}^{8} (1 + \\xi_i\\xi)(1 + \\eta_i\\eta)(1 + \\zeta_i\\zeta) $$\n求和是在所有 8 个节点位置上进行的，即对 $(\\xi_i, \\eta_i, \\zeta_i) \\in \\{-1,1\\}^3$ 的所有组合进行求和。\n让我们展开乘积项：\n$$ (1 + \\xi_i\\xi)(1 + \\eta_i\\eta)(1 + \\zeta_i\\zeta) = 1 + \\xi_i\\xi + \\eta_i\\eta + \\zeta_i\\zeta + \\xi_i\\eta_i\\xi\\eta + \\xi_i\\zeta_i\\xi\\zeta + \\eta_i\\zeta_i\\eta\\zeta + \\xi_i\\eta_i\\zeta_i\\xi\\eta\\zeta $$\n当对 8 个节点求和时，任何包含至少一个 $\\xi_i, \\eta_i,$ 或 $\\zeta_i$ 的项的和都将为零。例如，考虑项 $\\xi_i\\xi$。对 8 个节点的和是 $\\xi \\sum_{i=1}^8 \\xi_i = \\xi(4 \\times 1 + 4 \\times (-1)) = 0$。同样的逻辑适用于所有其他混合项（例如，$\\sum \\xi_i\\eta_i = 2 \\times (1 \\cdot 1) + 2 \\times (1 \\cdot -1) + 2 \\times (-1 \\cdot 1) + 2 \\times (-1 \\cdot -1) = 0$）。只有常数项“1”保留下来。\n$$ \\sum_{i=1}^{8} (1 + \\xi_i\\xi + \\dots) = \\sum_{i=1}^{8} 1 = 8 $$\n因此，\n$$ \\sum_{i=1}^{8} N_i(\\xi, \\eta, \\zeta) = \\frac{1}{8} \\times 8 = 1 $$\n这证实了单位分解特性。\n\n**等参映射与雅可比行列式**\n全局坐标 $(x, y, z)$ 使用形函数从局部坐标 $(\\xi, \\eta, \\zeta)$ 映射而来：\n$x(\\xi, \\eta, \\zeta) = \\sum_{i=1}^{8} N_i x_i$, $y(\\xi, \\eta, \\zeta) = \\sum_{i=1}^{8} N_i y_i$, $z(\\xi, \\eta, \\zeta) = \\sum_{i=1}^{8} N_i z_i$。\n对于给定的矩形砖块，映射得以简化。利用单位分解特性并分组，我们可以证明：\n$x(\\xi, \\eta, \\zeta) = \\frac{L_x}{2}(1+\\xi)$\n$y(\\xi, \\eta, \\zeta) = \\frac{L_y}{2}(1+\\eta)$\n$z(\\xi, \\eta, \\zeta) = \\frac{L_z}{2}(1+\\zeta)$\n变换的雅可比矩阵 $\\mathbf{J}$ 由下式给出：\n$$ \\mathbf{J} = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\xi}  \\frac{\\partial z}{\\partial \\xi} \\\\ \\frac{\\partial x}{\\partial \\eta}  \\frac{\\partial y}{\\partial \\eta}  \\frac{\\partial z}{\\partial \\eta} \\\\ \\frac{\\partial x}{\\partial \\zeta}  \\frac{\\partial y}{\\partial \\zeta}  \\frac{\\partial z}{\\partial \\zeta} \\end{pmatrix}^T = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial x}{\\partial \\eta}  \\frac{\\partial x}{\\partial \\zeta} \\\\ \\frac{\\partial y}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\eta}  \\frac{\\partial y}{\\partial \\zeta} \\\\ \\frac{\\partial z}{\\partial \\xi}  \\frac{\\partial z}{\\partial \\eta}  \\frac{\\partial z}{\\partial \\zeta} \\end{pmatrix} $$\n计算偏导数：\n$\\frac{\\partial x}{\\partial \\xi} = \\frac{L_x}{2}$, $\\frac{\\partial x}{\\partial \\eta} = 0$, $\\frac{\\partial x}{\\partial \\zeta} = 0$\n$\\frac{\\partial y}{\\partial \\xi} = 0$, $\\frac{\\partial y}{\\partial \\eta} = \\frac{L_y}{2}$, $\\frac{\\partial y}{\\partial \\zeta} = 0$\n$\\frac{\\partial z}{\\partial \\xi} = 0$, $\\frac{\\partial z}{\\partial \\eta} = 0$, $\\frac{\\partial z}{\\partial \\zeta} = \\frac{L_z}{2}$\n雅可比矩阵是一个常数对角矩阵：\n$$ \\mathbf{J} = \\begin{pmatrix} L_x/2  0  0 \\\\ 0  L_y/2  0 \\\\ 0  0  L_z/2 \\end{pmatrix} $$\n雅可比行列式 $J$ 是该矩阵的行列式：\n$$ J = \\det(\\mathbf{J}) = \\left(\\frac{L_x}{2}\\right) \\left(\\frac{L_y}{2}\\right) \\left(\\frac{L_z}{2}\\right) = \\frac{L_x L_y L_z}{8} $$\n\n**一致质量矩阵项 $M_{11}$**\n一致质量矩阵将节点加速度与节点力联系起来。其各项由 $M_{ab} = \\int_{V} \\rho N_a N_b dV$ 给出，其中 $a$ 和 $b$ 指的是全局自由度。完整的质量矩阵由每对节点 $i$ 和 $j$ 的 $3 \\times 3$ 块 $\\mathbf{M}_{ij}$ 组成。对于各向同性材料属性 $\\rho$，该块为 $\\mathbf{M}_{ij} = m_{ij} \\mathbf{I}$，其中 $m_{ij} = \\int_V \\rho N_i N_j dV$，$\\mathbf{I}$ 是 $3 \\times 3$ 单位矩阵。\n项 $M_{11}$ 对应于第一个节点的第一个自由度。设节点 1 位于 $(\\xi_1, \\eta_1, \\zeta_1) = (-1, -1, -1)$。其 x-位移的质量矩阵项是 $\\mathbf{M}_{11}$ 块的左上角元素，即 $m_{11}$。\n$$ M_{11} = m_{11} = \\int_{V} \\rho N_1^2 dV $$\n为了计算这个积分，我们将其转换到参考单元域：$dV = J\\,d\\xi d\\eta d\\zeta$。\n$$ M_{11} = \\int_{-1}^{1}\\int_{-1}^{1}\\int_{-1}^{1} \\rho [N_1(\\xi, \\eta, \\zeta)]^2 J \\, d\\xi d\\eta d\\zeta $$\n节点 1 在 $(\\xi_1, \\eta_1, \\zeta_1) = (-1, -1, -1)$ 处的形函数是：\n$$ N_1(\\xi, \\eta, \\zeta) = \\frac{1}{8}(1 - \\xi)(1 - \\eta)(1 - \\zeta) $$\n将 $N_1$ 和 $J$ 代入积分：\n$$ M_{11} = \\rho \\left( \\frac{L_x L_y L_z}{8} \\right) \\int_{-1}^{1}\\int_{-1}^{1}\\int_{-1}^{1} \\left[ \\frac{1}{8}(1-\\xi)(1-\\eta)(1-\\zeta) \\right]^2 d\\xi d\\eta d\\zeta $$\n$$ M_{11} = \\rho \\frac{L_x L_y L_z}{8 \\cdot 64} \\int_{-1}^{1} (1-\\xi)^2 d\\xi \\int_{-1}^{1} (1-\\eta)^2 d\\eta \\int_{-1}^{1} (1-\\zeta)^2 d\\zeta $$\n我们来计算这个一维积分：\n$$ \\int_{-1}^{1} (1-u)^2 du = \\int_{-1}^{1} (1 - 2u + u^2) du = \\left[ u - u^2 + \\frac{u^3}{3} \\right]_{-1}^{1} $$\n$$ = \\left(1 - 1^2 + \\frac{1^3}{3}\\right) - \\left(-1 - (-1)^2 + \\frac{(-1)^3}{3}\\right) = \\left(\\frac{1}{3}\\right) - \\left(-1 - 1 - \\frac{1}{3}\\right) = \\frac{1}{3} - \\left(-\\frac{7}{3}\\right) = \\frac{8}{3} $$\n三重积分是三个这样积分的乘积：\n$$ \\left(\\frac{8}{3}\\right) \\times \\left(\\frac{8}{3}\\right) \\times \\left(\\frac{8}{3}\\right) = \\frac{512}{27} $$\n将此结果代回 $M_{11}$ 的表达式：\n$$ M_{11} = \\rho \\frac{L_x L_y L_z}{512} \\left( \\frac{512}{27} \\right) = \\frac{\\rho L_x L_y L_z}{27} $$\n这是矩阵项 $M_{11}$ 的精确解析表达式。\n\n**数值计算**\n给定值为：\n$L_x = 1.2\\,\\mathrm{m}$\n$L_y = 0.8\\,\\mathrm{m}$\n$L_z = 0.5\\,\\mathrm{m}$\n$\\rho = 7850\\,\\mathrm{kg/m^3}$\n\n首先，计算砖块的体积 $V$：\n$$ V = L_x L_y L_z = 1.2 \\times 0.8 \\times 0.5 = 0.48\\,\\mathrm{m^3} $$\n然后，计算单元的总质量 $M_{\\text{total}}$：\n$$ M_{\\text{total}} = \\rho V = 7850\\,\\mathrm{kg/m^3} \\times 0.48\\,\\mathrm{m^3} = 3768\\,\\mathrm{kg} $$\n现在，计算 $M_{11}$：\n$$ M_{11} = \\frac{\\rho V}{27} = \\frac{M_{\\text{total}}}{27} = \\frac{3768}{27} \\approx 139.555... \\,\\mathrm{kg} $$\n将结果四舍五入到四位有效数字，得到：\n$$ M_{11} = 139.6\\,\\mathrm{kg} $$\n最终答案是质量的数值，单位为千克。",
            "answer": "$$\\boxed{139.6}$$"
        },
        {
            "introduction": "在掌握了 H8 单元的基本公式后，我们来探讨一个在实际应用中至关重要的数值问题：减缩积分及其带来的“沙漏模式”（hourglass modes）。这个练习旨在揭示当为了计算效率或避免剪切锁定而采用单点积分方案时，单元刚度矩阵会如何变得过软，从而产生非物理的零能量变形模式。计算这些沙漏模式的数量，是理解和控制这种数值不稳定性的第一步。",
            "id": "3570550",
            "problem": "考虑一个三维线性弹性问题中的等参8节点六面体(H8)有限元，该单元在有限元法(FEM)框架内建立。其母体域为立方体$[-1,1] \\times [-1,1] \\times [-1,1]$，使用自然坐标$(\\xi,\\eta,\\zeta)$和标准三线性形函数。该单元通过一个仿射可逆变换映射到一个物理平行六面体，该变换具有恒定的雅可比矩阵$\\mathbf{J}$和恒定的行列式$\\det \\mathbf{J} \\neq 0$。材料是均匀的线性弹性体，具有正定的本构张量$\\mathbf{D}$。\n\n从虚功原理和单元刚度矩阵（定义为应变-位移算子的域积分）出发，考虑一种减缩积分方案，该方案在形心$(\\xi,\\eta,\\zeta)=(0,0,0)$处使用单个高斯点及相应的三维高斯权重。在这种减缩积分下，离散单元刚度成为一个单点近似，仅取决于在形心处计算的应变-位移矩阵。\n\n确定在该减缩积分下，单元离散刚度的非刚体零能子空间（即所谓的沙漏模式）的维数（以单个整数表示）。也就是说，计算在排除刚体模式的情况下，能产生零内部应变能的线性无关节点位移向量的数量。请以无单位的单个整数形式提供最终答案。无需四舍五入。",
            "solution": "用户希望确定在使用单点减缩积分时，8节点六面体单元的非刚体零能子空间（沙漏模式）的维数。\n\n### 问题验证\n\n**第1步：提取已知条件**\n- 单元：等参8节点六面体(H8)。\n- 物理背景：$3$D线性弹性。\n- 母体域：立方体$[-1,1] \\times [-1,1] \\times [-1,1]$，坐标为$(\\xi,\\eta,\\zeta)$。\n- 形函数：标准三线性。\n- 映射：到物理平行六面体的仿射可逆变换。\n- 雅可比矩阵：常数矩阵$\\mathbf{J}$，且$\\det \\mathbf{J} \\neq 0$。\n- 材料：均匀、线性弹性、正定本构张量$\\mathbf{D}$。\n- 积分方案：使用形心$(\\xi,\\eta,\\zeta)=(0,0,0)$处的单个高斯点的减缩积分。\n- 目标：确定非刚体零能子空间（沙漏模式）的维数。\n\n**第2步：使用提取的已知条件进行验证**\n- **科学依据：** 该问题是有限元法（FEM）理论中的一个标准课题，具体涉及欠积分实体单元的数值稳定性。等参映射、减缩积分和沙漏现象是计算固体力学中的基本概念。所有前提在事实上和科学上都是合理的。\n- **适定性：** 问题定义明确。它要求在一组精确的假设下，求一个特定的整数（一个向量子空间的维数）。所提供的条件足以得出一个唯一的、有意义的答案。\n- **客观性：** 语言正式、精确，没有任何主观或模糊的术语。\n\n该问题是有效的，因为它具有科学依据、适定性和客观性。它是计算力学中一个标准的、可形式化的问题。\n\n### 解答\n\n单元刚度矩阵$\\mathbf{K}^e$由虚功原理导出，由单元物理体积$V^e$上的积分给出：\n$$ \\mathbf{K}^e = \\int_{V^e} \\mathbf{B}^T \\mathbf{D} \\mathbf{B} \\, dV $$\n其中$\\mathbf{B}$是应变-位移矩阵，$\\mathbf{D}$是本构材料张量。\n\n使用等参格式，该积分被变换到由$\\xi, \\eta, \\zeta \\in [-1, 1]$定义的母体域：\n$$ \\mathbf{K}^e = \\int_{-1}^{1} \\int_{-1}^{1} \\int_{-1}^{1} \\mathbf{B}(\\xi, \\eta, \\zeta)^T \\mathbf{D} \\mathbf{B}(\\xi, \\eta, \\zeta) \\det(\\mathbf{J}) \\, d\\xi d\\eta d\\zeta $$\n问题指定了使用母体单元形心处，即$(\\xi, \\eta, \\zeta) = (0, 0, 0)$处的单个高斯点的减缩积分方案。相应的高斯权重为$w = 2 \\times 2 \\times 2 = 8$。因此，刚度矩阵近似为：\n$$ \\mathbf{K}^e \\approx w \\det(\\mathbf{J}) \\mathbf{B}(0,0,0)^T \\mathbf{D} \\mathbf{B}(0,0,0) $$\n令$\\mathbf{B}_0 = \\mathbf{B}(0,0,0)$。该映射是仿射的，因此雅可比行列式$\\det(\\mathbf{J})$是一个非零常数。材料是均匀的，因此$\\mathbf{D}$也是常数。\n\n如果一个节点位移向量$\\mathbf{u}^e$产生的应变能为零，即$(\\mathbf{u}^e)^T \\mathbf{K}^e \\mathbf{u}^e = 0$，则它对应一个零能模式。根据近似$\\mathbf{K}^e$的形式：\n$$ (\\mathbf{u}^e)^T \\left( w \\det(\\mathbf{J}) \\mathbf{B}_0^T \\mathbf{D} \\mathbf{B}_0 \\right) \\mathbf{u}^e = 0 $$\n由于$w > 0$，$\\det(\\mathbf{J}) \\neq 0$，且本构张量$\\mathbf{D}$是正定的，该条件等价于：\n$$ (\\mathbf{B}_0 \\mathbf{u}^e)^T \\mathbf{D} (\\mathbf{B}_0 \\mathbf{u}^e) = 0 \\implies \\mathbf{B}_0 \\mathbf{u}^e = \\mathbf{0} $$\n因此，零能模式的空间是矩阵$\\mathbf{B}_0$的零空间（核）。我们需要求出这个零空间的维数，即$\\dim(\\ker(\\mathbf{B}_0))$。\n\nH8单元有$8$个节点。在$3$D弹性力学中，每个节点有$3$个自由度（位移）。单元的总自由度数为$N_{dof} = 8 \\times 3 = 24$。节点位移向量$\\mathbf{u}^e$属于$\\mathbb{R}^{24}$。\n$3$D中的应变向量有$6$个分量：$\\boldsymbol{\\epsilon} = [\\epsilon_{xx}, \\epsilon_{yy}, \\epsilon_{zz}, \\gamma_{xy}, \\gamma_{yz}, \\gamma_{zx}]^T$。应变-位移矩阵$\\mathbf{B}_0$将$24$个节点位移映射到这$6$个应变分量。因此，$\\mathbf{B}_0$是一个$6 \\times 24$的矩阵。\n\n根据秩-零度定理，$\\mathbf{B}_0$的零空间的维数为：\n$$ \\dim(\\ker(\\mathbf{B}_0)) = N_{dof} - \\text{rank}(\\mathbf{B}_0) = 24 - \\text{rank}(\\mathbf{B}_0) $$\n为了找到零能子空间的维数，我们必须确定$\\mathbf{B}_0$的秩。秩是矩阵的线性无关行（或列）的数量。\n\n节点$i$的矩阵$\\mathbf{B}_i$为：\n$$ \\mathbf{B}_i = \\begin{pmatrix}\n\\frac{\\partial N_i}{\\partial x}  0  0 \\\\\n0  \\frac{\\partial N_i}{\\partial y}  0 \\\\\n0  0  \\frac{\\partial N_i}{\\partial z} \\\\\n\\frac{\\partial N_i}{\\partial y}  \\frac{\\partial N_i}{\\partial x}  0 \\\\\n0  \\frac{\\partial N_i}{\\partial z}  \\frac{\\partial N_i}{\\partial y} \\\\\n\\frac{\\partial N_i}{\\partial z}  0  \\frac{\\partial N_i}{\\partial x}\n\\end{pmatrix} $$\n其中导数在形心处计算。完整的矩阵是$\\mathbf{B}_0 = [\\mathbf{B}_1, \\mathbf{B}_2, \\ldots, \\mathbf{B}_8]_0$。\n三线性形函数$N_i = \\frac{1}{8}(1+\\xi_i\\xi)(1+\\eta_i\\eta)(1+\\zeta_i\\zeta)$在形心$(\\xi,\\eta,\\zeta)=(0,0,0)$处的导数为：\n$$ \\frac{\\partial N_i}{\\partial \\xi}\\bigg|_0 = \\frac{1}{8}\\xi_i, \\quad \\frac{\\partial N_i}{\\partial \\eta}\\bigg|_0 = \\frac{1}{8}\\eta_i, \\quad \\frac{\\partial N_i}{\\partial \\zeta}\\bigg|_0 = \\frac{1}{8}\\zeta_i $$\n其中$(\\xi_i, \\eta_i, \\zeta_i)$是节点$i$的坐标（值为$\\pm 1$）。\n空间导数通过逆雅可比矩阵$\\mathbf{J}^{-1}$与这些导数相关联：\n$$ \\begin{Bmatrix} \\frac{\\partial N_i}{\\partial x} \\\\ \\frac{\\partial N_i}{\\partial y} \\\\ \\frac{\\partial N_i}{\\partial z} \\end{Bmatrix}_0 = \\mathbf{J}^{-1} \\begin{Bmatrix} \\frac{\\partial N_i}{\\partial \\xi} \\\\ \\frac{\\partial N_i}{\\partial \\eta} \\\\ \\frac{\\partial N_i}{\\partial \\zeta} \\end{Bmatrix}_0 = \\frac{1}{8} \\mathbf{J}^{-1} \\begin{Bmatrix} \\xi_i \\\\ \\eta_i \\\\ \\zeta_i \\end{Bmatrix} $$\n设$\\mathbf{d}_{x}$、$\\mathbf{d}_{y}$、$\\mathbf{d}_{z}$是$\\mathbb{R}^8$中的向量，其分量是为$8$个节点中的每一个在形心处计算的空间导数。例如，$(\\mathbf{d}_{x})_i = \\frac{\\partial N_i}{\\partial x}|_0$。这三个向量是节点坐标向量$\\boldsymbol{\\xi_v} = (\\xi_1, \\dots, \\xi_8)^T$、$\\boldsymbol{\\eta_v} = (\\eta_1, \\dots, \\eta_8)^T$和$\\boldsymbol{\\zeta_v} = (\\zeta_1, \\dots, \\zeta_8)^T$的线性组合，使用$\\frac{1}{8}\\mathbf{J}^{-1}$的行作为系数。向量$\\boldsymbol{\\xi_v}, \\boldsymbol{\\eta_v}, \\boldsymbol{\\zeta_v}$是线性无关的。由于$\\mathbf{J}^{-1}$是可逆的，向量$\\mathbf{d}_{x}, \\mathbf{d}_{y}, \\mathbf{d}_{z}$也是线性无关的。\n\n$6 \\times 24$矩阵$\\mathbf{B}_0$的$6$行可以用这些向量写成：\n- 第1行：$[\\mathbf{d}_{x}^T, \\mathbf{0}^T, \\mathbf{0}^T]$\n- 第2行：$[\\mathbf{0}^T, \\mathbf{d}_{y}^T, \\mathbf{0}^T]$\n- 第3行：$[\\mathbf{0}^T, \\mathbf{0}^T, \\mathbf{d}_{z}^T]$\n- 第4行：$[\\mathbf{d}_{y}^T, \\mathbf{d}_{x}^T, \\mathbf{0}^T]$\n- 第5行：$[\\mathbf{0}^T, \\mathbf{d}_{z}^T, \\mathbf{d}_{y}^T]$\n- 第6行：$[\\mathbf{d}_{z}^T, \\mathbf{0}^T, \\mathbf{d}_{x}^T]$\n\n我们检查这些行的线性无关性。设行的线性组合等于零向量：$\\sum_{k=1}^{6} c_k \\text{Row}_k = \\mathbf{0}$。考察前8个分量块，得到$c_1 \\mathbf{d}_{x} + c_4 \\mathbf{d}_{y} + c_6 \\mathbf{d}_{z} = \\mathbf{0}$。由于$\\mathbf{d}_{x}, \\mathbf{d}_{y}, \\mathbf{d}_{z}$是线性无关的，这意味着$c_1 = c_4 = c_6 = 0$。将这些代入第二个8分量块的方程中，得到$c_2 \\mathbf{d}_{y} + c_5 \\mathbf{d}_{z} = \\mathbf{0}$，这意味着$c_2 = c_5 = 0$。最后，第三个块给出$c_3 \\mathbf{d}_{z} = \\mathbf{0}$，这意味着$c_3=0$。所有系数$c_k$都必须为零，因此这$6$行是线性无关的。\n\n因此，$\\mathbf{B}_0$的秩为$6$。\n总零能子空间的维数为：\n$$ \\dim(\\ker(\\mathbf{B}_0)) = 24 - \\text{rank}(\\mathbf{B}_0) = 24 - 6 = 18 $$\n这个$18$维空间包含了所有在单元形心处产生零应变的节点位移向量。该空间包括刚体模式，它们在任何地方都产生零应变。对于一个$3$D物体，有$6$个线性无关的刚体模式：$3$个平移和$3$个旋转。\n\n问题要求的是*非刚体*零能子空间的维数，即沙漏模式。这可以通过从总零能子空间的维数中减去刚体模式子空间的维数来得到。\n$$ \\text{沙漏模式的维数} = \\dim(\\ker(\\mathbf{B}_0)) - \\text{刚体模式的维数} $$\n$$ \\text{沙漏模式的维数} = 18 - 6 = 12 $$\n对于采用单点减缩积分的$8$节点六面体单元，存在$12$种沙漏模式。",
            "answer": "$$\\boxed{12}$$"
        },
        {
            "introduction": "最后，我们来挑战更高级的二十节点六面体单元（H20）。与 H8 单元的简单张量积结构不同，H20 单元的“serendipity”形函数需要更巧妙的构造方法。这个练习将引导您利用节点插值特性和边界条件，为一个边中点节点推导出其独特的二次形函数，从而深入理解高阶单元的构造原理。",
            "id": "3570589",
            "problem": "考虑参考域 $\\widehat{\\Omega} = [-1,1]^{3}$ 上的二十节点 serendipity 六面体单元 (H20)，其自然坐标为 $(\\xi,\\eta,\\zeta)$。节点位于八个顶点 $(\\pm 1,\\pm 1,\\pm 1)$ 和十二条边的中点，即一个坐标等于 $0$ 而另外两个坐标等于 $\\pm 1$ 的点。在等参有限元法 (FEM) 插值中，每个形函数 $N_{a}(\\xi,\\eta,\\zeta)$ 都需要满足在单元节点上的克罗内克δ插值性质，并且属于适用于 H20 单元的 serendipity 多项式空间，即在每个自然坐标上最多是二次的，并且沿每条边能再现一维二次插值的多项式。\n\n关注位于连接顶点 $(-1,1,-1)$ 和 $(1,1,-1)$ 的边的中点处的边中点节点，即 $(\\xi,\\eta,\\zeta)=(0,1,-1)$。仅使用：\n- 在所有二十个节点上的克罗内克δ插值性质，\n- 形函数在边 $\\{\\eta=1,\\zeta=-1\\}$ 上的限制再现了横坐标 $\\xi \\in \\{-1,0,1\\}$ 上的一维二次拉格朗日插值的要求，\n- 以及该函数在 $\\xi$ 上最多是二次的，在 $\\eta$ 和 $\\zeta$ 上最多是线性的，同时在不与该边相邻的面上为零的要求，\n\n推导出此边中点形函数的唯一多项式表达式（在代数简化意义下）。然后，在自然坐标为 $(\\xi,\\eta,\\zeta)=\\left(\\tfrac{1}{3},\\tfrac{1}{2},-\\tfrac{1}{2}\\right)$ 的点 $P$ 处计算此形函数的值。\n\n请以单个实数形式提供您的最终答案。无需单位。不要四舍五入；给出精确值。",
            "solution": "该问题陈述已经过严格验证，并被确定为是合理的。它在科学上基于有限元法的原理，是适定的，并提供了一套完整且一致的约束条件来推导唯一解。\n\n目标是为二十节点serendipity六面体单元（H20）推导位于坐标 $(\\xi_{a}, \\eta_{a}, \\zeta_{a}) = (0, 1, -1)$ 的边中点节点的形函数 $N_{a}(\\xi, \\eta, \\zeta)$，然后在一个特定点 $P(\\tfrac{1}{3}, \\tfrac{1}{2}, -\\tfrac{1}{2})$ 对其求值。\n\n问题陈述指出，形函数在自然坐标 $\\xi$ 上最多是二次的，在自然坐标 $\\eta$ 和 $\\zeta$ 上最多是线性的。这个结构性约束允许我们以变量分离的形式寻找解：\n$$N_{a}(\\xi, \\eta, \\zeta) = f(\\xi) g(\\eta) h(\\zeta)$$\n其中 $f(\\xi)$ 是一个二次多项式，而 $g(\\eta)$ 和 $h(\\zeta)$ 是线性多项式。推导过程是通过使用所提供的约束条件确定这些函数中的每一个来进行的。\n\n1.  **$f(\\xi)$ 的确定**：\n    问题要求 $N_{a}$ 在边 $\\{\\eta=1, \\zeta=-1\\}$ 上的限制必须再现一维二次拉格朗日插值。位于 $(0, 1, -1)$ 的节点 $a$ 是这条边上的中心节点，该边还包含位于 $(-1, 1, -1)$ 和 $(1, 1, -1)$ 的节点。沿着这条边对应的横坐标是 $\\xi \\in \\{-1, 0, 1\\}$。\n    对于中心节点（在 $\\xi=0$ 处）的一维二次拉格朗日基函数 $L_0(\\xi)$ 由下式给出：\n    $$L_0(\\xi) = \\frac{(\\xi - (-1))(\\xi - 1)}{(0 - (-1))(0 - 1)} = \\frac{(\\xi+1)(\\xi-1)}{-1} = 1 - \\xi^2$$\n    形函数 $N_{a}$ 必须满足克罗内克δ性质，因此 $N_a(\\xi, 1, -1)$ 在 $\\xi=0$ 时必须为 $1$，在 $\\xi=\\pm 1$ 时必须为 $0$。这正是 $L_0(\\xi)$ 所提供的。因此，我们必须有：\n    $$N_{a}(\\xi, 1, -1) = 1 - \\xi^2$$\n    代入我们的变量分离形式，我们得到 $f(\\xi)g(1)h(-1) = 1 - \\xi^2$。这在相差一个常数因子的情况下确定了 $f(\\xi)$ 的函数形式。我们可以设定 $f(\\xi) = 1 - \\xi^2$ 并施加归一化条件 $g(1)h(-1) = 1$。\n\n2.  **$g(\\eta)$ 和 $h(\\zeta)$ 的确定**：\n    问题要求形函数在不与边 $\\{\\eta=1, \\zeta=-1\\}$ 相邻的面上为零。不相邻的面是 $\\eta=-1$, $\\zeta=1$, $\\xi=1$ 和 $\\xi=-1$。\n    - 在面 $\\xi=\\pm 1$ 上为零的条件已经满足，因为 $f(\\pm 1) = 1 - (\\pm 1)^2 = 0$。\n    - 为使函数在面 $\\eta=-1$ 上为零，我们必须有 $N_a(\\xi, -1, \\zeta) = 0$ 对所有 $\\xi, \\zeta \\in [-1, 1]$ 成立。\n      $$N_a(\\xi, -1, \\zeta) = f(\\xi)g(-1)h(\\zeta) = (1-\\xi^2)g(-1)h(\\zeta) = 0$$\n      由于 $(1-\\xi^2)$ 和 $h(\\zeta)$ 不恒为零，这要求 $g(-1)=0$。因为 $g(\\eta)$ 是一个线性函数，比如 $g(\\eta) = c_1\\eta + c_0$，这意味着 $-c_1 + c_0 = 0$，所以 $c_1=c_0$。我们可以写成 $g(\\eta) = c_0(1+\\eta)$。\n    - 类似地，为使函数在面 $\\zeta=1$ 上为零，我们必须有 $N_a(\\xi, \\eta, 1) = 0$ 对所有 $\\xi, \\eta \\in [-1, 1]$ 成立。\n      $$N_a(\\xi, \\eta, 1) = f(\\xi)g(\\eta)h(1) = (1-\\xi^2)g(\\eta)h(1) = 0$$\n      这要求 $h(1)=0$。因为 $h(\\zeta)$ 是一个线性函数，比如 $h(\\zeta) = d_1\\zeta + d_0$，这意味着 $d_1 + d_0 = 0$，所以 $d_1=-d_0$。我们可以写成 $h(\\zeta) = d_0(1-\\zeta)$。\n\n3.  **组合与归一化**：\n    我们组合 $f(\\xi)$、$g(\\eta)$ 和 $h(\\zeta)$ 的表达式：\n    $$N_{a}(\\xi, \\eta, \\zeta) = (1-\\xi^2) \\cdot c_0(1+\\eta) \\cdot d_0(1-\\zeta) = c_0 d_0 (1-\\xi^2)(1+\\eta)(1-\\zeta)$$\n    现在我们应用归一化条件 $g(1)h(-1)=1$。\n    从 $g(\\eta) = c_0(1+\\eta)$，我们有 $g(1)=2c_0$。\n    从 $h(\\zeta) = d_0(1-\\zeta)$，我们有 $h(-1)=d_0(1-(-1))=2d_0$。\n    条件变为 $(2c_0)(2d_0) = 4c_0d_0 = 1$，这给出 $c_0d_0 = \\frac{1}{4}$。\n    将此常数代回 $N_a$ 的表达式中，得到形函数的最终唯一多项式：\n    $$N_{a}(\\xi, \\eta, \\zeta) = \\frac{1}{4}(1-\\xi^2)(1+\\eta)(1-\\zeta)$$\n    此函数满足问题的所有约束，包括在 H20 单元的所有 20 个节点上的克罗内克δ性质。在节点 $a=(0,1,-1)$ 处，$N_a(0,1,-1) = \\frac{1}{4}(1-0^2)(1+1)(1-(-1)) = \\frac{1}{4}(1)(2)(2) = 1$。在任何其他节点处，因子 $(1-\\xi^2)$、$(1+\\eta)$ 或 $(1-\\zeta)$ 中至少有一个为零。\n\n4.  **在点 P 处求值**：\n    最后，我们在坐标为 $(\\xi, \\eta, \\zeta) = (\\frac{1}{3}, \\frac{1}{2}, -\\frac{1}{2})$ 的点 $P$ 处计算所推导的形函数。\n    $$N_{a}\\left(\\frac{1}{3}, \\frac{1}{2}, -\\frac{1}{2}\\right) = \\frac{1}{4}\\left(1 - \\left(\\frac{1}{3}\\right)^2\\right)\\left(1 + \\frac{1}{2}\\right)\\left(1 - \\left(-\\frac{1}{2}\\right)\\right)$$\n    我们分别计算每一项：\n    $$1 - \\left(\\frac{1}{3}\\right)^2 = 1 - \\frac{1}{9} = \\frac{8}{9}$$\n    $$1 + \\frac{1}{2} = \\frac{3}{2}$$\n    $$1 - \\left(-\\frac{1}{2}\\right) = 1 + \\frac{1}{2} = \\frac{3}{2}$$\n    将这些值代入主表达式中：\n    $$N_{a}\\left(\\frac{1}{3}, \\frac{1}{2}, -\\frac{1}{2}\\right) = \\frac{1}{4} \\cdot \\frac{8}{9} \\cdot \\frac{3}{2} \\cdot \\frac{3}{2}$$\n    $$N_{a}\\left(\\frac{1}{3}, \\frac{1}{2}, -\\frac{1}{2}\\right) = \\frac{1 \\cdot 8 \\cdot 3 \\cdot 3}{4 \\cdot 9 \\cdot 2 \\cdot 2} = \\frac{72}{144} = \\frac{1}{2}$$\n    点 $P$ 处形函数的精确值为 $\\frac{1}{2}$。",
            "answer": "$$\\boxed{\\frac{1}{2}}$$"
        }
    ]
}