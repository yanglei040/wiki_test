{
    "hands_on_practices": [
        {
            "introduction": "The Timoshenko beam model improves upon Euler-Bernoulli theory by including shear deformation, but this introduces a new parameter: the shear correction factor $k$. This practice is essential for understanding the physical grounding of the theory, as it guides you through deriving the value of $k$ for a rectangular cross-section. By equating the shear strain energy from the simplified 1D model with that of a more realistic 3D stress state, you will gain insight into how this crucial parameter bridges the gap between beam theory and continuum mechanics.",
            "id": "3607044",
            "problem": "Consider a straight, prismatic beam of rectangular cross-section with width $b$ and height $h$, composed of a homogeneous, isotropic, linear-elastic material with shear modulus $G$. Let the beam axis be the $x$-direction, and let a transverse shear resultant $V$ be applied so that, sufficiently far from the ends, a Saint-Venant type three-dimensional ($3$D) stress state is established and the lateral surfaces are traction-free. In Timoshenko beam theory (TBT), the shear correction factor $k$ modifies the one-dimensional ($1$D) shear term in the internal energy so that the shear strain energy per unit length is $U_{1D} = \\frac{V^{2}}{2 k G A}$, where $A = b h$ is the cross-sectional area. Using energy equivalence between the exact $3$D Saint-Venant shear energy per unit length $U_{3D} = \\int_{A} \\frac{\\tau^{2}}{2 G} \\,\\mathrm{d}A$ and the $1$D TBT shear energy per unit length $U_{1D}$, derive an expression for the shear correction factor $k$ for the rectangular cross-section. Your derivation must start from appropriate fundamental statements (equilibrium and compatibility within small-strain linear elasticity for prismatic beams), and the modeling assumptions required for the equivalence must be stated and justified. Express your final answer for $k$ as a single exact fraction (dimensionless).",
            "solution": "The problem is valid. It is a standard, well-posed problem in solid mechanics, specifically the theory of beams, and is based on sound scientific principles. All necessary information is provided.\n\nThe objective is to derive the shear correction factor, $k$, for a prismatic beam with a rectangular cross-section by equating the one-dimensional ($1$D) shear strain energy per unit length from Timoshenko beam theory, $U_{1D}$, with the three-dimensional ($3$D) shear strain energy per unit length derived from the Saint-Venant shear stress distribution, $U_{3D}$.\n\nThe principle of energy equivalence is stated as:\n$$\nU_{1D} = U_{3D}\n$$\nThe expressions for the energy per unit length are given as:\n$$\nU_{1D} = \\frac{V^{2}}{2 k G A}\n$$\nand\n$$\nU_{3D} = \\int_{A} \\frac{\\tau^{2}}{2 G} \\,\\mathrm{d}A\n$$\nwhere $V$ is the transverse shear resultant, $G$ is the shear modulus, $A$ is the cross-sectional area, and $\\tau$ is the magnitude of the shear stress vector at a point in the cross-section.\n\nEquating the two expressions for energy gives:\n$$\n\\frac{V^{2}}{2 k G A} = \\int_{A} \\frac{\\tau^{2}}{2 G} \\,\\mathrm{d}A\n$$\nThe shear modulus $G$ cancels, and we can solve for the shear correction factor $k$:\n$$\n\\frac{V^{2}}{k A} = \\int_{A} \\tau^{2} \\,\\mathrm{d}A\n$$\n$$\nk = \\frac{V^{2}}{A \\int_{A} \\tau^{2} \\,\\mathrm{d}A}\n$$\nTo proceed, we need an expression for the shear stress $\\tau$ over the cross-section. The following modeling assumptions are made:\n\n1.  The shear stress distribution is approximated using the Jourawski formula, which is derived from the equilibrium of a beam element under bending. This formula gives the shear stress component $\\tau_{xy}$ in the direction of the applied shear force $V$.\n2.  The total shear stress magnitude $\\tau$ is approximated solely by this component, i.e., $\\tau \\approx \\tau_{xy}$. This implies that the shear stress is uniform across the width of the beam and that the transverse shear stress component $\\tau_{xz}$ is neglected. While the full $3$D Saint-Venant elasticity solution for a rectangular section does include a non-zero $\\tau_{xz}$ to satisfy traction-free boundary conditions on the vertical sides, neglecting it is a standard and necessary simplification for this elementary derivation and yields the widely accepted value for $k$.\n\nLet the rectangular cross-section have width $b$ and height $h$. The coordinate system is set up with the $x$-axis along the beam's centroidal axis, the $y$-axis in the direction of the height, and the $z$-axis in the direction of the width. The origin is at the centroid, so $y \\in [-\\frac{h}{2}, \\frac{h}{2}]$ and $z \\in [-\\frac{b}{2}, \\frac{b}{2}]$. The shear force $V$ acts in the $y$-direction.\n\nThe Jourawski formula for shear stress is:\n$$\n\\tau_{xy}(y) = \\frac{V Q(y)}{I b}\n$$\nwhere $I$ is the second moment of area about the neutral axis (the $z$-axis), and $Q(y)$ is the first moment of area of the portion of the cross-section above the coordinate $y$, taken with respect to the neutral axis.\n\nFor the rectangular cross-section, the second moment of area is:\n$$\nI = \\frac{b h^3}{12}\n$$\nThe first moment of area $Q(y)$ is calculated as:\n$$\nQ(y) = \\int_{y}^{h/2} y' (b \\, \\mathrm{d}y') = b \\left[ \\frac{(y')^2}{2} \\right]_{y}^{h/2} = \\frac{b}{2} \\left[ \\left(\\frac{h}{2}\\right)^2 - y^2 \\right] = \\frac{b}{2} \\left( \\frac{h^2}{4} - y^2 \\right)\n$$\nSubstituting $I$ and $Q(y)$ into the shear stress formula:\n$$\n\\tau_{xy}(y) = \\frac{V}{\\left(\\frac{b h^3}{12}\\right) b} \\left[ \\frac{b}{2} \\left( \\frac{h^2}{4} - y^2 \\right) \\right] = \\frac{12 V}{b^2 h^3} \\frac{b}{2} \\left( \\frac{h^2}{4} - y^2 \\right) = \\frac{6 V}{b h^3} \\left( \\frac{h^2}{4} - y^2 \\right)\n$$\nThis gives the parabolic distribution of shear stress across the height of the beam.\n\nNow, we evaluate the integral term in the expression for $k$. Based on our assumption, $\\tau^2 = \\tau_{xy}^2$. The area element is $\\mathrm{d}A = b \\, \\mathrm{d}y$.\n$$\n\\int_{A} \\tau^2 \\,\\mathrm{d}A = \\int_{-h/2}^{h/2} [\\tau_{xy}(y)]^2 b \\,\\mathrm{d}y = \\int_{-h/2}^{h/2} \\left[ \\frac{6 V}{b h^3} \\left( \\frac{h^2}{4} - y^2 \\right) \\right]^2 b \\,\\mathrm{d}y\n$$\n$$\n= b \\left( \\frac{6 V}{b h^3} \\right)^2 \\int_{-h/2}^{h/2} \\left( \\frac{h^2}{4} - y^2 \\right)^2 \\,\\mathrm{d}y = \\frac{36 V^2}{b h^6} \\int_{-h/2}^{h/2} \\left( \\frac{h^4}{16} - \\frac{h^2}{2} y^2 + y^4 \\right) \\,\\mathrm{d}y\n$$\nThe integrand is an even function, so we can simplify the integration:\n$$\n\\int_{A} \\tau^2 \\,\\mathrm{d}A = \\frac{36 V^2}{b h^6} \\cdot 2 \\int_{0}^{h/2} \\left( \\frac{h^4}{16} - \\frac{h^2}{2} y^2 + y^4 \\right) \\,\\mathrm{d}y\n$$\n$$\n= \\frac{72 V^2}{b h^6} \\left[ \\frac{h^4}{16} y - \\frac{h^2}{6} y^3 + \\frac{1}{5} y^5 \\right]_0^{h/2}\n$$\n$$\n= \\frac{72 V^2}{b h^6} \\left[ \\frac{h^4}{16}\\left(\\frac{h}{2}\\right) - \\frac{h^2}{6}\\left(\\frac{h}{2}\\right)^3 + \\frac{1}{5}\\left(\\frac{h}{2}\\right)^5 \\right]\n$$\n$$\n= \\frac{72 V^2}{b h^6} \\left[ \\frac{h^5}{32} - \\frac{h^5}{48} + \\frac{h^5}{160} \\right]\n$$\n$$\n= \\frac{72 V^2 h^5}{b h^6} \\left[ \\frac{1}{32} - \\frac{1}{48} + \\frac{1}{160} \\right]\n$$\nTo sum the fractions, we find a common denominator, which is $480$:\n$$\n= \\frac{72 V^2}{b h} \\left[ \\frac{15}{480} - \\frac{10}{480} + \\frac{3}{480} \\right] = \\frac{72 V^2}{b h} \\left[ \\frac{15 - 10 + 3}{480} \\right] = \\frac{72 V^2}{b h} \\left( \\frac{8}{480} \\right)\n$$\nSimplifying the fraction $\\frac{8}{480} = \\frac{1}{60}$.\n$$\n\\int_{A} \\tau^2 \\,\\mathrm{d}A = \\frac{72 V^2}{b h} \\left( \\frac{1}{60} \\right) = \\frac{6 V^2}{5 b h}\n$$\nSince the cross-sectional area is $A = b h$, we have:\n$$\n\\int_{A} \\tau^2 \\,\\mathrm{d}A = \\frac{6 V^2}{5 A}\n$$\nFinally, we substitute this result into the expression for $k$:\n$$\nk = \\frac{V^{2}}{A \\int_{A} \\tau^{2} \\,\\mathrm{d}A} = \\frac{V^{2}}{A \\left( \\frac{6 V^2}{5 A} \\right)} = \\frac{V^2}{\\frac{6 V^2}{5}} = \\frac{5}{6}\n$$\nThe shear correction factor for a rectangular cross-section is therefore $\\frac{5}{6}$.",
            "answer": "$$\n\\boxed{\\frac{5}{6}}\n$$"
        },
        {
            "introduction": "After establishing the physical parameters of the model, the next step is to create its computational representation. This hands-on derivation focuses on constructing the element stiffness matrix, the fundamental building block of any finite element analysis based on Timoshenko beam theory. By starting from the strain energy definition and integrating over the element, you will see precisely how material properties ($EI$, $kGA$) and geometry ($L$) combine to form the discrete equations that govern the element's response.",
            "id": "3606998",
            "problem": "Consider a two-node, straight Timoshenko beam element formulated in the local element coordinate $x \\in [0,L]$. The nodal degrees of freedom are the transverse displacement and cross-section rotation at each node, collected as $\\{ v_1, \\theta_1, v_2, \\theta_2 \\}$. Assume both the transverse displacement $v(x)$ and the rotation $\\theta(x)$ are interpolated with linear shape functions. The material and section properties are constant along the element: Young’s modulus $E$, second moment of area $I$, shear modulus $G$, cross-sectional area $A$, and shear correction factor $k$. Using Timoshenko beam theory, the strain energy density is the sum of bending and shear contributions. Starting from first principles and the definition of strain energy, derive the exact, consistent element stiffness matrix by integrating the energy terms over the element length. Express the final $4 \\times 4$ stiffness matrix in closed form in terms of $E I$, $k G A$, and $L$. Provide the final matrix expression only; no numerical values are required and no rounding applies. Do not include units in your final matrix.",
            "solution": "The user wants to derive the consistent stiffness matrix for a two-node Timoshenko beam element using linear interpolations for both transverse displacement and cross-section rotation.\n\n### Step 1: Extract Givens\n- Element type: Two-node, straight Timoshenko beam element.\n- Coordinate system: Local coordinate $x$ spanning from $0$ to $L$, where $L$ is the element length.\n- Nodal degrees of freedom (DOFs): The vector of nodal DOFs is $\\boldsymbol{d} = \\{v_1, \\theta_1, v_2, \\theta_2\\}^T$, where $v_i$ is the transverse displacement and $\\theta_i$ is the cross-section rotation at node $i$.\n- Interpolation: Both the transverse displacement $v(x)$ and the rotation $\\theta(x)$ are interpolated using linear shape functions.\n- Material and section properties: Young’s modulus $E$, second moment of area $I$, shear modulus $G$, cross-sectional area $A$, and shear correction factor $k$ are all constant.\n- Strain Energy: The strain energy density is the sum of bending and shear contributions.\n- Task: Derive the $4 \\times 4$ consistent element stiffness matrix, $\\boldsymbol{K}$, by integrating the strain energy terms over the element length.\n- Final Expression: The matrix should be in terms of $EI$, $kGA$, and $L$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, being a standard derivation in the field of computational solid mechanics and finite element analysis. It is well-posed, providing all necessary information (element type, interpolation scheme, degrees of freedom, and physical properties) to derive a unique solution. The language is objective and precise. The problem does not violate any of the invalidity criteria. It is complete, consistent, realistic (within the idealizations of beam theory), and directly related to the topic of Timoshenko beam formulations.\n\n### Step 3: Verdict and Action\nThe problem is valid. A full derivation will be provided.\n\n### Solution Derivation\nThe derivation of the element stiffness matrix $\\boldsymbol{K}$ is based on the principle of minimum potential energy, where the stiffness matrix relates the nodal DOFs to the nodal forces via the strain energy $U$ of the element. The strain energy is given by $U = \\frac{1}{2}\\boldsymbol{d}^T \\boldsymbol{K} \\boldsymbol{d}$. The stiffness matrix can be computed by integrating the strain energy density over the element's volume.\n\n**1. Interpolation of Displacement and Rotation Fields**\nThe problem specifies linear interpolation for both the transverse displacement $v(x)$ and the rotation $\\theta(x)$. The linear shape functions for an element of length $L$ defined on $x \\in [0, L]$ are:\n$$ N_1(x) = 1 - \\frac{x}{L} $$\n$$ N_2(x) = \\frac{x}{L} $$\nThe fields $v(x)$ and $\\theta(x)$ are interpolated from the nodal DOFs $\\boldsymbol{d} = \\{v_1, \\theta_1, v_2, \\theta_2\\}^T$ as:\n$$ v(x) = N_1(x) v_1 + N_2(x) v_2 = \\begin{pmatrix} 1-\\frac{x}{L} & 0 & \\frac{x}{L} & 0 \\end{pmatrix} \\boldsymbol{d} $$\n$$ \\theta(x) = N_1(x) \\theta_1 + N_2(x) \\theta_2 = \\begin{pmatrix} 0 & 1-\\frac{x}{L} & 0 & \\frac{x}{L} \\end{pmatrix} \\boldsymbol{d} $$\n\n**2. Strain-Displacement Relations in Timoshenko Beam Theory**\nIn Timoshenko beam theory, the kinematics are described by two key strain measures: the bending curvature $\\kappa$ and the shear strain $\\gamma$.\nThe curvature is the spatial derivative of the rotation:\n$$ \\kappa(x) = \\frac{d\\theta}{dx} $$\nThe shear strain is the difference between the slope of the deflection curve and the rotation of the cross-section:\n$$ \\gamma(x) = \\frac{dv}{dx} - \\theta(x) $$\n\n**3. Expressing Strains in Terms of Nodal DOFs**\nWe differentiate the interpolation functions to find the derivatives:\n$$ \\frac{dv}{dx} = \\frac{d}{dx} \\left( (1-\\frac{x}{L})v_1 + (\\frac{x}{L})v_2 \\right) = -\\frac{1}{L}v_1 + \\frac{1}{L}v_2 $$\n$$ \\frac{d\\theta}{dx} = \\frac{d}{dx} \\left( (1-\\frac{x}{L})\\theta_1 + (\\frac{x}{L})\\theta_2 \\right) = -\\frac{1}{L}\\theta_1 + \\frac{1}{L}\\theta_2 $$\nNow, we can write the strains in matrix form, $\\kappa = \\boldsymbol{B}_b \\boldsymbol{d}$ and $\\gamma = \\boldsymbol{B}_s \\boldsymbol{d}$:\nFor bending curvature $\\kappa$:\n$$ \\kappa(x) = \\frac{d\\theta}{dx} = \\begin{pmatrix} 0 & -\\frac{1}{L} & 0 & \\frac{1}{L} \\end{pmatrix} \\boldsymbol{d} $$\nSo, the bending strain-displacement matrix $\\boldsymbol{B}_b$ is:\n$$ \\boldsymbol{B}_b = \\begin{pmatrix} 0 & -\\frac{1}{L} & 0 & \\frac{1}{L} \\end{pmatrix} $$\nFor shear strain $\\gamma$:\n$$ \\gamma(x) = \\frac{dv}{dx} - \\theta(x) = \\left(-\\frac{1}{L}v_1 + \\frac{1}{L}v_2\\right) - \\left( (1-\\frac{x}{L})\\theta_1 + (\\frac{x}{L})\\theta_2 \\right) $$\n$$ \\gamma(x) = -\\frac{1}{L}v_1 - \\left(1-\\frac{x}{L}\\right)\\theta_1 + \\frac{1}{L}v_2 - \\frac{x}{L}\\theta_2 $$\nSo, the shear strain-displacement matrix $\\boldsymbol{B}_s$ is:\n$$ \\boldsymbol{B}_s(x) = \\begin{pmatrix} -\\frac{1}{L} & -\\left(1-\\frac{x}{L}\\right) & \\frac{1}{L} & -\\frac{x}{L} \\end{pmatrix} $$\n\n**4. Strain Energy and Stiffness Matrix Formulation**\nThe total strain energy $U$ is the sum of the bending strain energy $U_b$ and the shear strain energy $U_s$:\n$$ U = U_b + U_s = \\frac{1}{2} \\int_0^L EI \\kappa^2 \\,dx + \\frac{1}{2} \\int_0^L kGA \\gamma^2 \\,dx $$\nSubstituting the strain-displacement relations:\n$$ U = \\frac{1}{2} \\boldsymbol{d}^T \\left( \\int_0^L \\boldsymbol{B}_b^T E I \\boldsymbol{B}_b \\,dx \\right) \\boldsymbol{d} + \\frac{1}{2} \\boldsymbol{d}^T \\left( \\int_0^L \\boldsymbol{B}_s^T k G A \\boldsymbol{B}_s \\,dx \\right) \\boldsymbol{d} $$\nThe element stiffness matrix $\\boldsymbol{K}$ is the sum of the bending stiffness $\\boldsymbol{K}_b$ and the shear stiffness $\\boldsymbol{K}_s$:\n$$ \\boldsymbol{K} = \\boldsymbol{K}_b + \\boldsymbol{K}_s $$\n$$ \\boldsymbol{K}_b = \\int_0^L \\boldsymbol{B}_b^T E I \\boldsymbol{B}_b \\,dx $$\n$$ \\boldsymbol{K}_s = \\int_0^L \\boldsymbol{B}_s^T k G A \\boldsymbol{B}_s \\,dx $$\n\n**5. Calculation of Bending Stiffness Matrix $\\boldsymbol{K}_b$**\nSince $E$, $I$, and $\\boldsymbol{B}_b$ are constant with respect to $x$, the integration is straightforward:\n$$ \\boldsymbol{K}_b = EI \\left( \\int_0^L dx \\right) \\boldsymbol{B}_b^T \\boldsymbol{B}_b = EIL \\begin{pmatrix} 0 \\\\ -1/L \\\\ 0 \\\\ 1/L \\end{pmatrix} \\begin{pmatrix} 0 & -1/L & 0 & 1/L \\end{pmatrix} $$\n$$ \\boldsymbol{K}_b = EIL \\begin{pmatrix} 0 & 0 & 0 & 0 \\\\ 0 & 1/L^2 & 0 & -1/L^2 \\\\ 0 & 0 & 0 & 0 \\\\ 0 & -1/L^2 & 0 & 1/L^2 \\end{pmatrix} = \\frac{EI}{L} \\begin{pmatrix} 0 & 0 & 0 & 0 \\\\ 0 & 1 & 0 & -1 \\\\ 0 & 0 & 0 & 0 \\\\ 0 & -1 & 0 & 1 \\end{pmatrix} $$\n\n**6. Calculation of Shear Stiffness Matrix $\\boldsymbol{K}_s$**\nThe matrix $\\boldsymbol{B}_s(x)$ is a function of $x$, so we must integrate the product $\\boldsymbol{B}_s^T \\boldsymbol{B}_s$ term by term.\n$$ \\boldsymbol{B}_s^T(x) \\boldsymbol{B}_s(x) = \\begin{pmatrix} 1/L^2 & (1-x/L)/L & -1/L^2 & x/L^2 \\\\ (1-x/L)/L & (1-x/L)^2 & -(1-x/L)/L & x(1-x/L)/L \\\\ -1/L^2 & -(1-x/L)/L & 1/L^2 & -x/L^2 \\\\ x/L^2 & x(1-x/L)/L & -x/L^2 & x^2/L^2 \\end{pmatrix} $$\nWe integrate this matrix over $x \\in [0, L]$. Key integrals are:\n$$ \\int_0^L 1 \\,dx = L $$\n$$ \\int_0^L \\left(1 - \\frac{x}{L}\\right) dx = \\left[x - \\frac{x^2}{2L}\\right]_0^L = \\frac{L}{2} $$\n$$ \\int_0^L \\frac{x}{L} \\,dx = \\left[\\frac{x^2}{2L}\\right]_0^L = \\frac{L}{2} $$\n$$ \\int_0^L \\left(1 - \\frac{x}{L}\\right)^2 dx = \\left[-\\frac{L}{3}\\left(1-\\frac{x}{L}\\right)^3\\right]_0^L = \\frac{L}{3} $$\n$$ \\int_0^L \\left(\\frac{x}{L}\\right)^2 dx = \\left[\\frac{x^3}{3L^2}\\right]_0^L = \\frac{L}{3} $$\n$$ \\int_0^L \\frac{x}{L}\\left(1 - \\frac{x}{L}\\right) dx = \\left[\\frac{x^2}{2L} - \\frac{x^3}{3L^2}\\right]_0^L = \\frac{L}{2} - \\frac{L}{3} = \\frac{L}{6} $$\nUsing these results, we find $\\int_0^L \\boldsymbol{B}_s^T \\boldsymbol{B}_s \\,dx$:\n$$ \\int_0^L \\boldsymbol{B}_s^T \\boldsymbol{B}_s \\,dx = \\begin{pmatrix} 1/L & 1/2 & -1/L & 1/2 \\\\ 1/2 & L/3 & -1/2 & L/6 \\\\ -1/L & -1/2 & 1/L & -1/2 \\\\ 1/2 & L/6 & -1/2 & L/3 \\end{pmatrix} $$\nMultiplying by the constant $kGA$ gives $\\boldsymbol{K}_s$:\n$$ \\boldsymbol{K}_s = kGA \\begin{pmatrix} 1/L & 1/2 & -1/L & 1/2 \\\\ 1/2 & L/3 & -1/2 & L/6 \\\\ -1/L & -1/2 & 1/L & -1/2 \\\\ 1/2 & L/6 & -1/2 & L/3 \\end{pmatrix} $$\n\n**7. Total Element Stiffness Matrix $\\boldsymbol{K}$**\nFinally, we sum $\\boldsymbol{K}_b$ and $\\boldsymbol{K}_s$:\n$$ \\boldsymbol{K} = \\boldsymbol{K}_b + \\boldsymbol{K}_s = \\frac{EI}{L} \\begin{pmatrix} 0 & 0 & 0 & 0 \\\\ 0 & 1 & 0 & -1 \\\\ 0 & 0 & 0 & 0 \\\\ 0 & -1 & 0 & 1 \\end{pmatrix} + kGA \\begin{pmatrix} 1/L & 1/2 & -1/L & 1/2 \\\\ 1/2 & L/3 & -1/2 & L/6 \\\\ -1/L & -1/2 & 1/L & -1/2 \\\\ 1/2 & L/6 & -1/2 & L/3 \\end{pmatrix} $$\nCombining the terms yields the final consistent stiffness matrix:\n$$ \\boldsymbol{K} = \\begin{pmatrix}\n\\frac{kGA}{L} & \\frac{kGA}{2} & -\\frac{kGA}{L} & \\frac{kGA}{2} \\\\\n\\frac{kGA}{2} & \\frac{EI}{L} + \\frac{kGAL}{3} & -\\frac{kGA}{2} & -\\frac{EI}{L} + \\frac{kGAL}{6} \\\\\n-\\frac{kGA}{L} & -\\frac{kGA}{2} & \\frac{kGA}{L} & -\\frac{kGA}{2} \\\\\n\\frac{kGA}{2} & -\\frac{EI}{L} + \\frac{kGAL}{6} & -\\frac{kGA}{2} & \\frac{EI}{L} + \\frac{kGAL}{3}\n\\end{pmatrix} $$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{kGA}{L} & \\frac{kGA}{2} & -\\frac{kGA}{L} & \\frac{kGA}{2} \\\\\n\\frac{kGA}{2} & \\frac{EI}{L} + \\frac{kGAL}{3} & -\\frac{kGA}{2} & -\\frac{EI}{L} + \\frac{kGAL}{6} \\\\\n-\\frac{kGA}{L} & -\\frac{kGA}{2} & \\frac{kGA}{L} & -\\frac{kGA}{2} \\\\\n\\frac{kGA}{2} & -\\frac{EI}{L} + \\frac{kGAL}{6} & -\\frac{kGA}{2} & \\frac{EI}{L} + \\frac{kGAL}{3}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "While theoretical derivations provide foundational values, practical engineering often requires calibrating models against more accurate data or higher-fidelity simulations. This computational practice contrasts the theoretical shear correction factor, such as the one derived in a previous exercise , with a value calibrated against a 3D elasticity solution. By implementing this calibration and quantifying the error, you will explore a powerful method for model refinement and discover the limitations of a single, universal shear correction factor, particularly its subtle dependence on material properties like Poisson's ratio $\\nu$.",
            "id": "3607025",
            "problem": "You are tasked with designing and implementing a calibration procedure for the shear correction factor $k$ in the Timoshenko beam model by matching cantilever tip deflections to a surrogate three-dimensional elasticity solution. Your program must compute the calibrated $k$ using a designated benchmark case and then quantify prediction errors across a test suite of cantilever beams.\n\nAssume small-strain, linear elastic behavior and the standard Timoshenko beam assumptions for an initially straight, prismatic, rectangular cross-section cantilever subjected to an end transverse point load. Use the following foundational base:\n\n- The Timoshenko beam model relates bending moment $M$ to curvature by $M = E I \\, d\\theta/dx$, and shear force $V$ to shear strain $\\gamma$ by $V = k G A \\, \\gamma$ with $\\gamma = dw/dx - \\theta$. Here, $E$ is Young's modulus, $G$ is the shear modulus, $I$ is the second moment of area, $A$ is the cross-sectional area, $w(x)$ is the transverse displacement, $\\theta(x)$ is the rotation of the cross-section, and $k$ is the shear correction factor to be calibrated.\n- For a cantilever of length $L$ under an end load $P$, the tip deflection predicted by the Timoshenko beam theory decomposes into bending and shear contributions:\n  $$w_{\\text{T}}(L;k) = \\underbrace{\\frac{P L^3}{3 E I}}_{\\text{bending}} \\;+\\; \\underbrace{\\frac{P L}{k G A}}_{\\text{shear}}.$$\n- The shear modulus $G$ is related to $E$ and the Poisson ratio $\\nu$ by $G = \\dfrac{E}{2(1+\\nu)}$.\n- As a surrogate for the three-dimensional elasticity tip deflection, use the energy-equivalent result for a rectangular cross-section derived from three-dimensional elasticity, which modifies the shear term via an effective factor $\\kappa_{\\text{3D}}(\\nu)$:\n  $$w_{\\text{3D}}(L;\\nu) = \\frac{P L^3}{3 E I} + \\frac{P L}{\\kappa_{\\text{3D}}(\\nu) \\, G \\, A}, \\quad \\kappa_{\\text{3D}}(\\nu) = \\frac{10(1+\\nu)}{12 + 11\\nu}.$$\n  This $\\kappa_{\\text{3D}}(\\nu)$ is a well-tested closed-form from three-dimensional elasticity for rectangular sections that accounts for non-uniform shear stress distribution.\n\nCalibration directive and error quantification:\n\n- Calibrate a single shear correction factor $k$ by enforcing $w_{\\text{T}}(L;k) = w_{\\text{3D}}(L;\\nu)$ for a designated benchmark case, thereby defining\n  $$k_{\\text{cal}} = \\frac{P L}{G A} \\left( w_{\\text{3D}}(L;\\nu) - \\frac{P L^3}{3 E I} \\right)^{-1}.$$\n- With this $k_{\\text{cal}}$, predict tip deflections $w_{\\text{T}}(L;k_{\\text{cal}})$ for all test cases, and compute the relative error for each case as a decimal:\n  $$e = \\frac{w_{\\text{T}}(L;k_{\\text{cal}}) - w_{\\text{3D}}(L;\\nu)}{w_{\\text{3D}}(L;\\nu)}.$$\n- Express all deflections in meters, and all material and geometric quantities in International System of Units (SI). Angles are not used in this task. Output relative errors as decimals (not percentages).\n\nTest suite:\n\nUse the following six cantilever cases (rectangular cross-sections) with parameters given as tuples $(E,\\nu,b,h,L,P)$ in SI units:\n\n1. Case 1 (steel, slender): $E = 210\\times 10^9\\,\\text{Pa}$, $\\nu = 0.3$, $b = 0.03\\,\\text{m}$, $h = 0.06\\,\\text{m}$, $L = 1.2\\,\\text{m}$, $P = 1500\\,\\text{N}$.\n2. Case 2 (steel, moderate; benchmark): $E = 210\\times 10^9\\,\\text{Pa}$, $\\nu = 0.3$, $b = 0.03\\,\\text{m}$, $h = 0.06\\,\\text{m}$, $L = 0.3\\,\\text{m}$, $P = 1500\\,\\text{N}$.\n3. Case 3 (steel, short): $E = 210\\times 10^9\\,\\text{Pa}$, $\\nu = 0.3$, $b = 0.03\\,\\text{m}$, $h = 0.06\\,\\text{m}$, $L = 0.06\\,\\text{m}$, $P = 1500\\,\\text{N}$.\n4. Case 4 (aluminum, short): $E = 70\\times 10^9\\,\\text{Pa}$, $\\nu = 0.33$, $b = 0.02\\,\\text{m}$, $h = 0.04\\,\\text{m}$, $L = 0.04\\,\\text{m}$, $P = 1200\\,\\text{N}$.\n5. Case 5 (aluminum, moderate): $E = 70\\times 10^9\\,\\text{Pa}$, $\\nu = 0.33$, $b = 0.02\\,\\text{m}$, $h = 0.04\\,\\text{m}$, $L = 0.5\\,\\text{m}$, $P = 800\\,\\text{N}$.\n6. Case 6 (steel, very slender boundary): $E = 210\\times 10^9\\,\\text{Pa}$, $\\nu = 0.3$, $b = 0.03\\,\\text{m}$, $h = 0.06\\,\\text{m}$, $L = 6.0\\,\\text{m}$, $P = 1500\\,\\text{N}$.\n\nComputational requirements:\n\n- For each case, compute $A = b h$, $I = b h^3 / 12$, and $G = E / [2(1+\\nu)]$.\n- Use Case $2$ as the benchmark to compute $k_{\\text{cal}}$ according to the calibration directive above.\n- For every case, compute $w_{\\text{3D}}(L;\\nu)$, $w_{\\text{T}}(L;k_{\\text{cal}})$, and the relative error $e$.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where the first entry is $k_{\\text{cal}}$ and the subsequent entries are the relative errors $e$ for Cases $1$ through $6$ in the order listed. For example: \"[k_cal,e1,e2,e3,e4,e5,e6]\". No additional text should be printed.\n\nScientific realism:\n\n- The calibration is grounded in linear elasticity and the Timoshenko beam theory. The surrogate three-dimensional elasticity benchmark uses the known closed-form $\\kappa_{\\text{3D}}(\\nu)$ for rectangular sections. Numerical values are realistic within standard engineering practice.\n\nYour deliverable is a complete, runnable program that adheres to the specified environment and produces the output in the required format. No inputs should be read from the user; all parameters are embedded in the program.",
            "solution": "The problem is valid as it is scientifically grounded in linear elasticity and Timoshenko beam theory, is mathematically well-posed, and provides a complete and consistent set of data and instructions for a meaningful computational task.\n\nThe objective is to calibrate the shear correction factor, $k$, for the Timoshenko beam model against a more accurate three-dimensional (3D) elasticity solution for a cantilever beam. This calibrated factor, $k_{\\text{cal}}$, is then used to predict deflections for a suite of test cases, and the prediction error is quantified.\n\nThe analysis proceeds in two main stages: calibration and error quantification.\n\nFirst, we define the necessary geometric and material properties for a rectangular cross-section beam. Given the width $b$ and height $h$ of the cross-section, the area $A$ and the second moment of area $I$ about the neutral axis are:\n$$ A = b h $$\n$$ I = \\frac{b h^3}{12} $$\nFor an isotropic, linear elastic material with Young's modulus $E$ and Poisson's ratio $\\nu$, the shear modulus $G$ is given by:\n$$ G = \\frac{E}{2(1+\\nu)} $$\n\nThe problem provides two models for the tip deflection of a cantilever beam of length $L$ subjected to a transverse end load $P$.\n\n1.  **Timoshenko Beam Theory ($w_{\\text{T}}$)**: This model accounts for both bending and shear deformation. The tip deflection is given by:\n    $$ w_{\\text{T}}(L; k) = \\frac{P L^3}{3 E I} + \\frac{P L}{k G A} $$\n    Here, $k$ is the shear correction factor, a dimensionless value that accounts for the non-uniform distribution of shear stress over the cross-section.\n\n2.  **3D Elasticity Surrogate ($w_{\\text{3D}}$)**: This serves as the \"ground truth\" for our calibration. The deflection is given by a similar form, but with the shear correction factor replaced by a function of Poisson's ratio, $\\kappa_{\\text{3D}}(\\nu)$, derived from 3D elasticity theory for rectangular sections:\n    $$ w_{\\text{3D}}(L; \\nu) = \\frac{P L^3}{3 E I} + \\frac{P L}{\\kappa_{\\text{3D}}(\\nu) G A} $$\n    where the effective factor is:\n    $$ \\kappa_{\\text{3D}}(\\nu) = \\frac{10(1+\\nu)}{12 + 11\\nu} $$\n\n**Calibration Step**\n\nThe calibration is performed using the parameters of the designated benchmark case, Case 2. The shear correction factor $k_{\\text{cal}}$ is determined by equating the Timoshenko deflection to the 3D elasticity surrogate deflection for this specific case:\n$$ w_{\\text{T}}(L_2; k_{\\text{cal}}) = w_{\\text{3D}}(L_2; \\nu_2) $$\nSubstituting the expressions for the deflections:\n$$ \\frac{P_2 L_2^3}{3 E_2 I_2} + \\frac{P_2 L_2}{k_{\\text{cal}} G_2 A_2} = \\frac{P_2 L_2^3}{3 E_2 I_2} + \\frac{P_2 L_2}{\\kappa_{\\text{3D}}(\\nu_2) G_2 A_2} $$\nThe bending deflection terms cancel, leaving:\n$$ \\frac{P_2 L_2}{k_{\\text{cal}} G_2 A_2} = \\frac{P_2 L_2}{\\kappa_{\\text{3D}}(\\nu_2) G_2 A_2} $$\nThis equality directly implies that the calibrated shear correction factor is simply the value of the 3D elasticity factor evaluated at the Poisson's ratio of the benchmark case:\n$$ k_{\\text{cal}} = \\kappa_{\\text{3D}}(\\nu_2) $$\nFor Case 2, the parameters are $E_2 = 210 \\times 10^9\\,\\text{Pa}$ and $\\nu_2 = 0.3$. Therefore,\n$$ k_{\\text{cal}} = \\frac{10(1+0.3)}{12 + 11(0.3)} = \\frac{10(1.3)}{12 + 3.3} = \\frac{13}{15.3} \\approx 0.8496732 $$\nThis single value of $k_{\\text{cal}}$ will be used for all subsequent predictions.\n\n**Error Quantification Step**\n\nFor each of the six cases, indexed by $i = 1, \\dots, 6$, we compute the relative error $e_i$. The error measures the discrepancy between the Timoshenko model's prediction (using the fixed $k_{\\text{cal}}$) and the 3D elasticity surrogate's result (which uses the material-specific $\\kappa_{\\text{3D}}(\\nu_i)$).\n\nFor each case $i$:\n1.  Calculate the 3D surrogate deflection $w_{\\text{3D},i}$ using its specific parameters $(E_i, \\nu_i, b_i, h_i, L_i, P_i)$ and the corresponding $\\kappa_{\\text{3D}}(\\nu_i)$.\n    $$ w_{\\text{3D},i} = \\frac{P_i L_i^3}{3 E_i I_i} + \\frac{P_i L_i}{\\kappa_{\\text{3D}}(\\nu_i) G_i A_i} $$\n2.  Calculate the Timoshenko prediction $w_{\\text{T},i}$ using the same parameters but with the *single* calibrated factor $k_{\\text{cal}}$.\n    $$ w_{\\text{T},i} = \\frac{P_i L_i^3}{3 E_i I_i} + \\frac{P_i L_i}{k_{\\text{cal}} G_i A_i} $$\n3.  Compute the relative error $e_i$:\n    $$ e_i = \\frac{w_{\\text{T},i} - w_{\\text{3D},i}}{w_{\\text{3D},i}} $$\n\nBy substituting the expressions for deflection, the numerator of the error term can be simplified:\n$$ w_{\\text{T},i} - w_{\\text{3D},i} = \\left( \\frac{P_i L_i^3}{3 E_i I_i} + \\frac{P_i L_i}{k_{\\text{cal}} G_i A_i} \\right) - \\left( \\frac{P_i L_i^3}{3 E_i I_i} + \\frac{P_i L_i}{\\kappa_{\\text{3D}}(\\nu_i) G_i A_i} \\right) = \\frac{P_i L_i}{G_i A_i} \\left( \\frac{1}{k_{\\text{cal}}} - \\frac{1}{\\kappa_{\\text{3D}}(\\nu_i)} \\right) $$\nThis shows that the error will be zero if and only if $k_{\\text{cal}} = \\kappa_{\\text{3D}}(\\nu_i)$. Since $k_{\\text{cal}}$ is fixed based on $\\nu_2 = 0.3$, the error will be zero for all cases where $\\nu_i = 0.3$ (Cases $1, 2, 3, 6$) and non-zero for cases with a different Poisson's ratio (Cases $4, 5$ where $\\nu_i = 0.33$). This highlights a fundamental aspect of this calibration scheme: a shear correction factor calibrated for one material is not perfectly accurate for another.\n\nThe computational procedure is as follows:\n1.  Define the parameters for all six cases.\n2.  Identify Case 2 as the benchmark and calculate $k_{\\text{cal}} = \\kappa_{\\text{3D}}(0.3)$.\n3.  Initialize a list to store the final results, starting with $k_{\\text{cal}}$.\n4.  Loop through each of the six cases. In each iteration:\n    a. Extract the case parameters $E, \\nu, b, h, L, P$.\n    b. Calculate $A, I, G$.\n    c. Calculate $\\kappa_{\\text{3D}}(\\nu)$.\n    d. Calculate the bending deflection component $w_{\\text{bend}} = PL^3 / (3EI)$ and the shear components for both models.\n    e. Compute $w_{\\text{T}}$ and $w_{\\text{3D}}$.\n    f. Compute the relative error $e$ and append it to the results list.\n5.  Format the final list as a comma-separated string enclosed in square brackets for output.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calibrates the Timoshenko beam shear correction factor k and quantifies\n    prediction errors for a test suite of cantilever beams.\n    \"\"\"\n    \n    # Test suite: (E, nu, b, h, L, P) in SI units.\n    # E in Pa, b, h, L in m, P in N. nu is dimensionless.\n    test_cases = [\n        # Case 1 (steel, slender)\n        (210e9, 0.3, 0.03, 0.06, 1.2, 1500),\n        # Case 2 (steel, moderate; benchmark)\n        (210e9, 0.3, 0.03, 0.06, 0.3, 1500),\n        # Case 3 (steel, short)\n        (210e9, 0.3, 0.03, 0.06, 0.06, 1500),\n        # Case 4 (aluminum, short)\n        (70e9, 0.33, 0.02, 0.04, 0.04, 1200),\n        # Case 5 (aluminum, moderate)\n        (70e9, 0.33, 0.02, 0.04, 0.5, 800),\n        # Case 6 (steel, very slender)\n        (210e9, 0.3, 0.03, 0.06, 6.0, 1500),\n    ]\n\n    # --- Calibration Step ---\n    # Use Case 2 (index 1) as the benchmark.\n    benchmark_case = test_cases[1]\n    _E_bench, nu_bench, _b_bench, _h_bench, _L_bench, _P_bench = benchmark_case\n\n    # The calibration simplifies to k_cal = kappa_3D(nu_benchmark).\n    # kappa_3D(nu) = 10*(1+nu) / (12 + 11*nu)\n    k_cal = 10 * (1 + nu_bench) / (12 + 11 * nu_bench)\n\n    results = [k_cal]\n    \n    # --- Error Quantification Step ---\n    for case in test_cases:\n        E, nu, b, h, L, P = case\n\n        # Calculate geometric and material properties\n        A = b * h\n        I = b * h**3 / 12\n        G = E / (2 * (1 + nu))\n\n        # --- Calculate 3D Elasticity Surrogate Deflection (w_3D) ---\n        # This is the \"ground truth\" for error calculation.\n        kappa_3D_case = 10 * (1 + nu) / (12 + 11 * nu)\n        \n        w_bending = (P * L**3) / (3 * E * I)\n        w_shear_3D = (P * L) / (kappa_3D_case * G * A)\n        w_3D = w_bending + w_shear_3D\n\n        # --- Calculate Timoshenko Deflection (w_T) using the calibrated k ---\n        # This is the model's prediction.\n        w_shear_T = (P * L) / (k_cal * G * A)\n        w_T = w_bending + w_shear_T\n\n        # --- Compute Relative Error ---\n        # Handle the case where w_3D might be zero to avoid division by zero.\n        if w_3D == 0:\n            # If w_3D is 0, error is 0 only if w_T is also 0. Otherwise it's infinite/undefined.\n            # In this physical problem, deflection will be non-zero for non-zero load.\n            error = 0.0 if w_T == 0.0 else np.inf\n        else:\n            error = (w_T - w_3D) / w_3D\n        \n        # Per problem description, the error for cases with same nu as benchmark should be 0.\n        # Floating point arithmetic might introduce tiny non-zero values.\n        # A small tolerance check ensures the theoretically zero errors are reported as 0.0.\n        if np.isclose(error, 0.0):\n            error = 0.0\n\n        results.append(error)\n\n    # Final print statement in the exact required format.\n    # Example format: \"[k_cal,e1,e2,e3,e4,e5,e6]\"\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}