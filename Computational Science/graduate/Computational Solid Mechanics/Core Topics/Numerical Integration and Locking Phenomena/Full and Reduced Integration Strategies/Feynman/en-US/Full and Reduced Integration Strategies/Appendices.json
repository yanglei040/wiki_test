{
    "hands_on_practices": [
        {
            "introduction": "The foundation of an accurate finite element analysis lies in the correct evaluation of the element stiffness matrix, $K_e$. This exercise guides you through determining the \"full\" integration rule for a higher-order element by analyzing the polynomial degree of the integrand. By performing this analysis, you will understand how both the element's shape functions and its geometric mapping dictate the required number of Gauss points for robust performance .",
            "id": "3566863",
            "problem": "Consider a two-dimensional small-strain, linear-elastic body discretized by an isoparametric quadratic quadrilateral element with eight nodes (Q8 serendipity). Let the constitutive matrix be constant and denoted by $C \\in \\mathbb{R}^{3 \\times 3}$, and let the element stiffness matrix be defined by\n$$\nK_{e} \\;=\\; \\int_{\\Omega_{e}} B^{T} C\\, B \\, d\\Omega,\n$$\nwhere $B$ is the standard strain-displacement matrix constructed from the isoparametric shape functions and their spatial derivatives.\n\nAssume a quadratic geometric mapping from the parent square $\\hat{\\Omega} = [-1,1] \\times [-1,1]$ with parent coordinates $(\\xi,\\eta)$ to the physical element $\\Omega_{e}$, so that the mapping components $x(\\xi,\\eta)$ and $y(\\xi,\\eta)$ are quadratic polynomials in $(\\xi,\\eta)$ built from the same Q8 shape functions. Denote the Jacobian matrix of this mapping by $J(\\xi,\\eta)$ and its determinant by $|J(\\xi,\\eta)|$.\n\nGaussian quadrature in two dimensions is applied by tensoring one-dimensional Gauss–Legendre rules of per-direction order $k$, which are known to integrate exactly any one-dimensional polynomial of degree up to $2k-1$. Using polynomial degree counting that starts from the following fundamental and well-tested facts:\n- The Q8 serendipity shape functions are quadratic polynomials in $(\\xi,\\eta)$, and their parent derivatives are linear polynomials.\n- Under a quadratic isoparametric mapping, each entry of $J(\\xi,\\eta)$ is a linear polynomial, and $|J(\\xi,\\eta)|$ is a quadratic polynomial.\n- The chain rule expresses spatial derivatives of shape functions using $J^{-1}(\\xi,\\eta)$, so that entries of $B$ are rational functions whose numerators are polynomials in $(\\xi,\\eta)$.\n\nDetermine the minimum per-direction Gauss–Legendre order $k$ that must be used so that the Gaussian quadrature is, in the accepted sense of full integration for this element type, sufficient to exactly integrate all polynomial content generated by the Q8 interpolation interacting with a quadratic mapping. Your reasoning must rely on degree counting of the polynomials arising in the numerator of the integrand after transforming to the parent domain and must clearly address why this choice is necessary in the presence of a quadratic mapping. State your final answer as the integer $k$. No units are required. The final answer must be a single number.",
            "solution": "We begin from the definition\n$$\nK_{e} \\;=\\; \\int_{\\Omega_{e}} B^{T} C\\, B \\, d\\Omega \\;=\\; \\int_{-1}^{1}\\int_{-1}^{1} \\big(B(\\xi,\\eta)\\big)^{T} C\\, B(\\xi,\\eta)\\, |J(\\xi,\\eta)| \\, d\\xi\\, d\\eta,\n$$\nwhere $C$ is constant and the dependence on $(\\xi,\\eta)$ arises through the isoparametric mapping and shape function derivatives.\n\nFor a Q8 serendipity interpolation:\n- The shape functions $N_{a}(\\xi,\\eta)$ are quadratic polynomials in $(\\xi,\\eta)$.\n- Their parent derivatives $\\partial N_{a}/\\partial \\xi$ and $\\partial N_{a}/\\partial \\eta$ are linear polynomials in $(\\xi,\\eta)$.\n\nUnder a quadratic isoparametric mapping:\n- Each entry of the Jacobian matrix $J(\\xi,\\eta)$ is a linear polynomial in $(\\xi,\\eta)$.\n- The determinant $|J(\\xi,\\eta)|$ is a quadratic polynomial in $(\\xi,\\eta)$.\n\nThe spatial derivatives of shape functions are obtained by the chain rule:\n$$\n\\begin{pmatrix}\n\\partial N_{a}/\\partial x\\\\\n\\partial N_{a}/\\partial y\n\\end{pmatrix}\n\\;=\\;\nJ(\\xi,\\eta)^{-1}\n\\begin{pmatrix}\n\\partial N_{a}/\\partial \\xi\\\\\n\\partial N_{a}/\\partial \\eta\n\\end{pmatrix}.\n$$\nBecause $J^{-1} = \\operatorname{adj}(J)/|J|$ with $\\operatorname{adj}(J)$ having entries that are linear polynomials (being cofactors of a matrix with linear entries), each spatial derivative component has the form\n$$\n\\frac{\\text{(linear)}\\times\\text{(linear)}}{|J(\\xi,\\eta)|} \\;=\\; \\frac{\\text{quadratic polynomial in }(\\xi,\\eta)}{|J(\\xi,\\eta)|}.\n$$\nTherefore, each entry of the strain-displacement matrix $B(\\xi,\\eta)$ is a rational function whose numerator is a quadratic polynomial in $(\\xi,\\eta)$ and whose denominator is $|J(\\xi,\\eta)|$.\n\nConsequently, the energy density in the parent domain is\n$$\n\\mathcal{I}(\\xi,\\eta)\\;=\\; \\big(B(\\xi,\\eta)\\big)^{T} C\\, B(\\xi,\\eta)\\, |J(\\xi,\\eta)|,\n$$\nand, componentwise, has the structural form\n$$\n\\mathcal{I}(\\xi,\\eta) \\;\\sim\\; \\frac{Q_{2}(\\xi,\\eta)\\,Q_{2}(\\xi,\\eta)}{|J(\\xi,\\eta)|^{2}}\\,|J(\\xi,\\eta)|\n\\;=\\; \\frac{Q_{4}(\\xi,\\eta)}{|J(\\xi,\\eta)|},\n$$\nwhere $Q_{m}(\\xi,\\eta)$ denotes a generic polynomial of total degree $m$ in $(\\xi,\\eta)$.\n\nThis shows two key facts:\n1. The integrand is a rational function because of the factor $1/|J(\\xi,\\eta)|$. As such, for a general quadratic mapping, there is no finite tensor-product Gauss–Legendre rule that guarantees exact integration for all admissible curved elements; exactness of rational integrands cannot be ensured by any fixed finite $k$.\n2. Nevertheless, the polynomial content in the numerator $Q_{4}(\\xi,\\eta)$ is of degree at most four, originating from the product of two quadratic numerators within $B^{T} C B$.\n\nIn practice, the accepted notion of full integration for isoparametric quadratic quadrilaterals selects the minimal order that exactly integrates all polynomials up to and including the highest-degree terms that arise in the numerator through the interpolation, while acknowledging that the nonpolynomial denominator $1/|J|$ precludes exactness in the fully curved case. This degree-counting principle is justified as follows.\n\n- In the affine limit (constant $J$ so $|J|$ constant and $J^{-1}$ constant), every entry of $B$ becomes a linear polynomial in $(\\xi,\\eta)$, so $B^{T} C B$ is a quadratic polynomial, and $|J|$ is constant. The integrand is then a polynomial of degree at most two, and a per-direction order $k$ satisfying $2k-1 \\geq 2$ suffices, i.e., $k \\geq 2$.\n- With a genuine quadratic mapping, $|J|$ varies quadratically, and $J^{-1}$ varies rationally. Although exactness for the full rational integrand is unattainable by any finite $k$, the highest-degree polynomial content introduced by the interpolation into the energy density’s numerator is quartic, $Q_{4}(\\xi,\\eta)$. A conservative and widely adopted requirement is that the quadrature exactly integrates all two-dimensional polynomials up to degree four in each parametric direction. For a tensor-product Gauss–Legendre rule, exactness for one-dimensional polynomials up to degree $2k-1$ is needed to capture degree four, hence\n$$\n2k - 1 \\;\\geq\\; 4 \\quad \\Longrightarrow \\quad k \\;\\geq\\; 3.\n$$\n\nThus, the minimal per-direction Gauss–Legendre order that satisfies polynomial degree counting for the quartic numerator induced by Q8 interpolation, and that is conventionally taken as full integration for a quadratic quadrilateral with quadratic mapping, is $k=3$. This choice integrates exactly all two-dimensional polynomial terms up to degree four that arise from $B^{T} C B$ in the mapped domain and provides the accepted level of exactness in the affine limit while robustly handling the variability introduced by quadratic geometry.\n\nTherefore, the required per-direction Gauss order is $k=3$.",
            "answer": "$$\\boxed{3}$$"
        },
        {
            "introduction": "While reduced integration is computationally efficient and helps prevent element locking, it can introduce non-physical behaviors. This practice uses the fundamental \"patch test\" to explore the consequences of using a single integration point in a bilinear quadrilateral element. Your derivation of the internal nodal forces on a simple two-element patch will reveal a surprising result: a failure to satisfy equilibrium, which is the telltale sign of spurious zero-energy \"hourglass\" modes .",
            "id": "3566901",
            "problem": "Consider a two-element patch in two-dimensional small-deformation linear elasticity composed of two identical four-node bilinear quadrilateral elements (denoted $Q4$) of constant thickness $t$. The patch occupies the rectangle $\\{(x,y)\\,|\\,0 \\leq x \\leq 2a,\\ 0 \\leq y \\leq b\\}$, with the left element covering $0 \\leq x \\leq a$ and the right element covering $a \\leq x \\leq 2a$. Each element is mapped isoparametrically from the parent square $[-1,1] \\times [-1,1]$ by an affine transformation, so that the Jacobian is constant within each element. The material is homogeneous, isotropic, and obeys linear elasticity in plane stress with Young’s modulus $E$ and Poisson’s ratio $\\nu$.\n\nA kinematically admissible displacement field that is linear in the physical coordinates is prescribed over the entire patch,\n$$\nu(x,y) = \\alpha x + \\beta y + c_{1}, \\qquad v(x,y) = \\gamma x + \\delta y + c_{2},\n$$\nwhere $\\alpha,\\beta,\\gamma,\\delta,c_{1},c_{2}$ are constants. This field produces a uniform small strain tensor with components\n$$\n\\varepsilon_{xx} = \\alpha, \\qquad \\varepsilon_{yy} = \\delta, \\qquad \\varepsilon_{xy} = \\frac{\\beta + \\gamma}{2}.\n$$\nUnder plane stress, the corresponding Cauchy stress components are\n$$\n\\sigma_{xx} = \\frac{E}{1-\\nu^{2}}\\left(\\varepsilon_{xx} + \\nu \\varepsilon_{yy}\\right), \\quad\n\\sigma_{yy} = \\frac{E}{1-\\nu^{2}}\\left(\\nu \\varepsilon_{xx} + \\varepsilon_{yy}\\right), \\quad\n\\sigma_{xy} = \\frac{E}{1+\\nu}\\,\\varepsilon_{xy}.\n$$\n\nWithin each element, use a reduced integration strategy, namely a single Gauss point at the parent coordinate $(\\xi,\\eta) = (0,0)$ with weight $w = 4$, to evaluate the consistent internal nodal force vector\n$$\n\\mathbf{f}_{\\mathrm{int}}^{e} = \\int_{A_{e}} \\mathbf{B}^{T}\\boldsymbol{\\sigma}\\, t \\,\\mathrm{d}A,\n$$\nwhere $\\mathbf{B}$ is the standard $Q4$ strain-displacement matrix and $\\boldsymbol{\\sigma} = \\begin{pmatrix}\\sigma_{xx} & \\sigma_{yy} & \\sigma_{xy}\\end{pmatrix}^{T}$. Assemble the two elements and extract the total internal nodal force components at the two common corner nodes on the interior vertical interface $x=a$, namely the nodes at $(x,y) = (a,0)$ and $(x,y) = (a,b)$.\n\nStarting from the principle of virtual work and the isoparametric mapping, derive symbolically the assembled internal nodal forces at these two interface nodes under the given uniform strain field and reduced integration rule, and express your final result explicitly in terms of $a$, $t$, $E$, $\\nu$, $\\varepsilon_{xx}$, $\\varepsilon_{yy}$, and $\\varepsilon_{xy}$. Use the ordering\n$$\n\\left(f_{x}(a,0),\\ f_{y}(a,0),\\ f_{x}(a,b),\\ f_{y}(a,b)\\right).\n$$\nNo numerical evaluation is required. Provide your final answer as a single row matrix. Do not include units in your final answer.",
            "solution": "The elemental internal nodal force vector $\\mathbf{f}_{\\mathrm{int}}^{e}$ is given by the integral of the product of the transposed strain-displacement matrix $\\mathbf{B}^T$ and the stress vector $\\boldsymbol{\\sigma}$ over the element's area $A_e$, multiplied by the thickness $t$:\n$$\n\\mathbf{f}_{\\mathrm{int}}^{e} = \\int_{A_{e}} \\mathbf{B}^{T}\\boldsymbol{\\sigma}\\, t \\,\\mathrm{d}A\n$$\nThe problem specifies a reduced integration scheme using a single Gauss point at the center of the parent element, $(\\xi, \\eta) = (0,0)$, with weight $w=4$. The integral is approximated as:\n$$\n\\mathbf{f}_{\\mathrm{int}}^{e} \\approx \\left[ \\mathbf{B}(\\xi=0, \\eta=0)^{T} \\boldsymbol{\\sigma}(\\xi=0, \\eta=0) \\right] t \\cdot \\det(\\mathbf{J}(\\xi=0, \\eta=0)) \\cdot w\n$$\nSince the prescribed displacement field is linear in $x$ and $y$, and the element geometry is rectangular (an affine map from the parent square), the strain field $\\boldsymbol{\\varepsilon}$ and consequently the stress field $\\boldsymbol{\\sigma}$ are uniform throughout the patch. The Jacobian $\\mathbf{J}$ is also constant within each element. The area of the element is $A_e = w \\det(\\mathbf{J})$. Thus, the formula simplifies to:\n$$\n\\mathbf{f}_{\\mathrm{int}}^{e} = A_e t \\, \\mathbf{B}(0,0)^{T} \\boldsymbol{\\sigma}\n$$\nwhere $\\mathbf{B}(0,0)$ is the strain-displacement matrix evaluated at the element center.\n\nLet's analyze one element, say the left element (Element 1), which occupies the domain $[0,a] \\times [0,b]$. Its nodes, numbered counter-clockwise from the origin, are $(0,0)$, $(a,0)$, $(a,b)$, and $(0,b)$. The isoparametric mapping from $(\\xi, \\eta) \\in [-1,1]^2$ is:\n$$\nx(\\xi,\\eta) = \\frac{a}{2}(1+\\xi), \\qquad y(\\xi,\\eta) = \\frac{b}{2}(1+\\eta)\n$$\nThe Jacobian matrix of this transformation is:\n$$\n\\mathbf{J} = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\xi} \\\\ \\frac{\\partial x}{\\partial \\eta} & \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix} = \\begin{pmatrix} a/2 & 0 \\\\ 0 & b/2 \\end{pmatrix}\n$$\nThe Jacobian is constant, as expected, with determinant $\\det(\\mathbf{J}) = \\frac{ab}{4}$. The element area is $A_e = ab$. The inverse Jacobian is:\n$$\n\\mathbf{J}^{-1} = \\begin{pmatrix} 2/a & 0 \\\\ 0 & 2/b \\end{pmatrix}\n$$\nThe strain-displacement matrix $\\mathbf{B}$ is constructed from the derivatives of the shape functions $N_i$ with respect to the physical coordinates $(x,y)$. These are obtained from the derivatives with respect to the parent coordinates $(\\xi,\\eta)$ via $\\mathbf{J}^{-1}$:\n$$\n\\begin{pmatrix} \\frac{\\partial N_i}{\\partial x} \\\\ \\frac{\\partial N_i}{\\partial y} \\end{pmatrix} = \\mathbf{J}^{-1} \\begin{pmatrix} \\frac{\\partial N_i}{\\partial \\xi} \\\\ \\frac{\\partial N_i}{\\partial \\eta} \\end{pmatrix}\n$$\nThe derivatives of the bilinear shape functions $N_i(\\xi, \\eta) = \\frac{1}{4}(1\\pm\\xi)(1\\pm\\eta)$ at the center $(\\xi, \\eta) = (0,0)$ are:\n$$\n\\begin{array}{ll}\n\\frac{\\partial N_1}{\\partial \\xi}|_{(0,0)} = -1/4, \\quad & \\frac{\\partial N_1}{\\partial \\eta}|_{(0,0)} = -1/4 \\\\\n\\frac{\\partial N_2}{\\partial \\xi}|_{(0,0)} = +1/4, \\quad & \\frac{\\partial N_2}{\\partial \\eta}|_{(0,0)} = -1/4 \\\\\n\\frac{\\partial N_3}{\\partial \\xi}|_{(0,0)} = +1/4, \\quad & \\frac{\\partial N_3}{\\partial \\eta}|_{(0,0)} = +1/4 \\\\\n\\frac{\\partial N_4}{\\partial \\xi}|_{(0,0)} = -1/4, \\quad & \\frac{\\partial N_4}{\\partial \\eta}|_{(0,0)} = +1/4\n\\end{array}\n$$\nUsing $\\mathbf{J}^{-1}$, we find the derivatives with respect to $(x,y)$ at the element center:\n$$\n\\begin{array}{ll}\n\\frac{\\partial N_1}{\\partial x} = -\\frac{1}{2a}, \\quad & \\frac{\\partial N_1}{\\partial y} = -\\frac{1}{2b} \\\\\n\\frac{\\partial N_2}{\\partial x} = +\\frac{1}{2a}, \\quad & \\frac{\\partial N_2}{\\partial y} = -\\frac{1}{2b} \\\\\n\\frac{\\partial N_3}{\\partial x} = +\\frac{1}{2a}, \\quad & \\frac{\\partial N_3}{\\partial y} = +\\frac{1}{2b} \\\\\n\\frac{\\partial N_4}{\\partial x} = -\\frac{1}{2a}, \\quad & \\frac{\\partial N_4}{\\partial y} = +\\frac{1}{2b}\n\\end{array}\n$$\nThe matrix $\\mathbf{B}(0,0)^T$ is an $8\\times 3$ matrix, which can be written as:\n$$\n\\mathbf{B}(0,0)^T = \\begin{pmatrix} \\mathbf{B}_1^T \\\\ \\mathbf{B}_2^T \\\\ \\mathbf{B}_3^T \\\\ \\mathbf{B}_4^T \\end{pmatrix}, \\quad \\text{where} \\quad \\mathbf{B}_i^T = \\begin{pmatrix} \\frac{\\partial N_i}{\\partial x} & 0 & \\frac{\\partial N_i}{\\partial y} \\\\ 0 & \\frac{\\partial N_i}{\\partial y} & \\frac{\\partial N_i}{\\partial x} \\end{pmatrix}\n$$\nSubstituting the derivatives, we can compute the nodal forces for one element: $\\mathbf{f}_{\\mathrm{int}}^{e} = (ab)t \\, \\mathbf{B}(0,0)^T \\boldsymbol{\\sigma}$.\nFor local node $i$, the forces $(f_{ix}, f_{iy})$ are:\n$$\n\\begin{pmatrix} f_{ix} \\\\ f_{iy} \\end{pmatrix} = abt \\begin{pmatrix} \\frac{\\partial N_i}{\\partial x}\\sigma_{xx} + \\frac{\\partial N_i}{\\partial y}\\sigma_{xy} \\\\ \\frac{\\partial N_i}{\\partial y}\\sigma_{yy} + \\frac{\\partial N_i}{\\partial x}\\sigma_{xy} \\end{pmatrix}\n$$\nSince Element 2 is identical in size to Element 1, its $\\mathbf{B}(0,0)$ matrix and area are the same. We can compute the nodal forces for both elements and then assemble them.\n\nFor Element 1 (left, nodes at $(0,0), (a,0), (a,b), (0,b)$):\n- Node 2 $(a,0)$: $\\mathbf{f}^{(1)}_2 = abt \\begin{pmatrix} \\frac{1}{2a}\\sigma_{xx} - \\frac{1}{2b}\\sigma_{xy} \\\\ -\\frac{1}{2b}\\sigma_{yy} + \\frac{1}{2a}\\sigma_{xy} \\end{pmatrix} = \\begin{pmatrix} \\frac{bt}{2}\\sigma_{xx} - \\frac{at}{2}\\sigma_{xy} \\\\ -\\frac{at}{2}\\sigma_{yy} + \\frac{bt}{2}\\sigma_{xy} \\end{pmatrix}$\n- Node 3 $(a,b)$: $\\mathbf{f}^{(1)}_3 = abt \\begin{pmatrix} \\frac{1}{2a}\\sigma_{xx} + \\frac{1}{2b}\\sigma_{xy} \\\\ \\frac{1}{2b}\\sigma_{yy} + \\frac{1}{2a}\\sigma_{xy} \\end{pmatrix} = \\begin{pmatrix} \\frac{bt}{2}\\sigma_{xx} + \\frac{at}{2}\\sigma_{xy} \\\\ \\frac{at}{2}\\sigma_{yy} + \\frac{bt}{2}\\sigma_{xy} \\end{pmatrix}$\n\nFor Element 2 (right, nodes at $(a,0), (2a,0), (2a,b), (a,b)$):\nThe interface nodes are local node 1 and local node 4 for this element.\n- Node 1 $(a,0)$: $\\mathbf{f}^{(2)}_1 = abt \\begin{pmatrix} -\\frac{1}{2a}\\sigma_{xx} - \\frac{1}{2b}\\sigma_{xy} \\\\ -\\frac{1}{2b}\\sigma_{yy} - \\frac{1}{2a}\\sigma_{xy} \\end{pmatrix} = \\begin{pmatrix} -\\frac{bt}{2}\\sigma_{xx} - \\frac{at}{2}\\sigma_{xy} \\\\ -\\frac{at}{2}\\sigma_{yy} - \\frac{bt}{2}\\sigma_{xy} \\end{pmatrix}$\n- Node 4 $(a,b)$: $\\mathbf{f}^{(2)}_4 = abt \\begin{pmatrix} -\\frac{1}{2a}\\sigma_{xx} + \\frac{1}{2b}\\sigma_{xy} \\\\ \\frac{1}{2b}\\sigma_{yy} - \\frac{1}{2a}\\sigma_{xy} \\end{pmatrix} = \\begin{pmatrix} -\\frac{bt}{2}\\sigma_{xx} + \\frac{at}{2}\\sigma_{xy} \\\\ \\frac{at}{2}\\sigma_{yy} - \\frac{bt}{2}\\sigma_{xy} \\end{pmatrix}$\n\nNow, we assemble the forces at the two interface nodes by summing the contributions from each element.\nTotal force at node $(a,0)$, $F(a,0) = \\mathbf{f}^{(1)}_2 + \\mathbf{f}^{(2)}_1$:\n$f_x(a,0) = \\left(\\frac{bt}{2}\\sigma_{xx} - \\frac{at}{2}\\sigma_{xy}\\right) + \\left(-\\frac{bt}{2}\\sigma_{xx} - \\frac{at}{2}\\sigma_{xy}\\right) = -at\\sigma_{xy}$\n$f_y(a,0) = \\left(-\\frac{at}{2}\\sigma_{yy} + \\frac{bt}{2}\\sigma_{xy}\\right) + \\left(-\\frac{at}{2}\\sigma_{yy} - \\frac{bt}{2}\\sigma_{xy}\\right) = -at\\sigma_{yy}$\n\nTotal force at node $(a,b)$, $F(a,b) = \\mathbf{f}^{(1)}_3 + \\mathbf{f}^{(2)}_4$:\n$f_x(a,b) = \\left(\\frac{bt}{2}\\sigma_{xx} + \\frac{at}{2}\\sigma_{xy}\\right) + \\left(-\\frac{bt}{2}\\sigma_{xx} + \\frac{at}{2}\\sigma_{xy}\\right) = at\\sigma_{xy}$\n$f_y(a,b) = \\left(\\frac{at}{2}\\sigma_{yy} + \\frac{bt}{2}\\sigma_{xy}\\right) + \\left(\\frac{at}{2}\\sigma_{yy} - \\frac{bt}{2}\\sigma_{xy}\\right) = at\\sigma_{yy}$\n\nThe non-zero result for these internal nodes is a known characteristic of the Q4 element with single-point quadrature, related to its failure to control \"hourglass\" deformation modes. The final step is to substitute the constitutive relations for $\\sigma_{yy}$ and $\\sigma_{xy}$ into these expressions.\n$$\n\\sigma_{yy} = \\frac{E}{1-\\nu^{2}}\\left(\\nu \\varepsilon_{xx} + \\varepsilon_{yy}\\right)\n$$\n$$\n\\sigma_{xy} = \\frac{E}{1+\\nu}\\,\\varepsilon_{xy}\n$$\nSubstituting these into the force expressions:\n$f_x(a,0) = -at \\left( \\frac{E}{1+\\nu}\\varepsilon_{xy} \\right)$\n$f_y(a,0) = -at \\left( \\frac{E}{1-\\nu^{2}}(\\nu \\varepsilon_{xx} + \\varepsilon_{yy}) \\right)$\n$f_x(a,b) = at \\left( \\frac{E}{1+\\nu}\\varepsilon_{xy} \\right)$\n$f_y(a,b) = at \\left( \\frac{E}{1-\\nu^{2}}(\\nu \\varepsilon_{xx} + \\varepsilon_{yy}) \\right)$\n\nThe final result, arranged as a row matrix in the specified order, is:\n$\n\\left(f_{x}(a,0),\\ f_{y}(a,0),\\ f_{x}(a,b),\\ f_{y}(a,b)\\right)\n$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -at\\frac{E}{1+\\nu}\\varepsilon_{xy} & -at\\frac{E}{1-\\nu^2}(\\nu\\varepsilon_{xx} + \\varepsilon_{yy}) & at\\frac{E}{1+\\nu}\\varepsilon_{xy} & at\\frac{E}{1-\\nu^2}(\\nu\\varepsilon_{xx} + \\varepsilon_{yy}) \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "After identifying the issue of hourglass modes, the next step is to control them, but this control is not without consequences. This practice explores the implications of adding stabilization stiffness by shifting the context to explicit time integration, where such effects are critical. By analyzing a simplified two-mode system, you will discover the direct relationship between the hourglass control parameter $\\alpha$ and the maximum stable time step $\\Delta t$, highlighting a crucial trade-off between element accuracy and computational cost in explicit simulations .",
            "id": "3566838",
            "problem": "Consider the semi-discrete equations of motion for a linear elastic body discretized by the finite element method, written in second-order form as $M \\ddot{u}(t) + K u(t) = 0$, where $M$ is the symmetric positive-definite mass matrix, $K$ is the symmetric stiffness matrix, and $u(t)$ is the vector of generalized displacements. In full (sufficient) numerical integration of the stiffness, $K$ has full rank, and the smallest nonzero eigenvalue corresponds to the lowest-frequency physical mode. Under reduced integration, spurious zero-energy modes (hourglass modes) appear, which are not controlled by $K$ and lead to rank deficiency. A standard stabilization adds an artificial stiffness along these hourglass directions, scaled by a dimensionless hourglass control parameter $\\alpha \\ge 0$.\n\nTo study how reduced integration and hourglass control affect the stability of the explicit central difference scheme, consider the following minimal two-mode model. Assume the physical and hourglass subspaces are orthogonal and decoupled, with modal coordinates $q_p(t)$ and $q_h(t)$. The modal mass matrix and modal stiffness matrix are\n$$\nM_{\\text{modal}} = \\begin{bmatrix} m_p & 0 \\\\ 0 & m_h \\end{bmatrix}, \\quad\nK_{\\text{modal}} = \\begin{bmatrix} k_p & 0 \\\\ 0 & \\alpha k_0 \\end{bmatrix},\n$$\nwhere $m_p$ and $m_h$ are equivalent modal masses in $\\mathrm{kg}$, $k_p$ is the physical mode stiffness in $\\mathrm{N/m}$, $k_0$ is a characteristic hourglass stiffness scale in $\\mathrm{N/m}$, and $\\alpha$ is a dimensionless stabilization factor that scales the hourglass stiffness. The decoupled modal equations are $m_p \\ddot{q}_p + k_p q_p = 0$ and $m_h \\ddot{q}_h + \\alpha k_0 q_h = 0$.\n\nAn explicit central difference time integrator is used for time stepping. You must proceed from the semi-discrete equations and the central difference time-discretization written for a single degree of freedom, derive the discrete amplification factors, and then derive the necessary and sufficient condition for linear stability in terms of the largest modal circular frequency. From this, derive the maximum stable time step $\\Delta t_{\\max}(\\alpha)$ as a function of $\\alpha$, and the critical value $\\alpha^\\star$ at which the hourglass mode begins to control the stability.\n\nThen, implement a program that, for each test case below, computes and reports:\n- the critical stabilization $\\alpha^\\star$ at which the physical and hourglass modal circular frequencies are equal, and\n- the list of maximum stable time steps $\\Delta t_{\\max}(\\alpha)$, in seconds, for a prescribed set of stabilization values $\\alpha$.\n\nAll answers for $\\Delta t_{\\max}$ must be expressed in seconds, rounded to six decimal places. The parameter $\\alpha$ is dimensionless.\n\nTest suite:\n- Case $1$ (happy path): $m_p = 1\\,\\mathrm{kg}$, $k_p = 10^6\\,\\mathrm{N/m}$, $m_h = 0.5\\,\\mathrm{kg}$, $k_0 = 10^5\\,\\mathrm{N/m}$, $\\alpha \\in \\{0,\\, 0.1,\\, 0.5,\\, 1.0,\\, 5.0,\\, 10.0\\}$.\n- Case $2$ (hourglass-dominated beyond a small threshold): $m_p = 1\\,\\mathrm{kg}$, $k_p = 10^6\\,\\mathrm{N/m}$, $m_h = 0.05\\,\\mathrm{kg}$, $k_0 = 10^5\\,\\mathrm{N/m}$, $\\alpha \\in \\{0,\\, 0.25,\\, 0.5,\\, 1.0,\\, 2.0\\}$.\n- Case $3$ (very stiff physical mode; late crossover): $m_p = 1\\,\\mathrm{kg}$, $k_p = 4 \\times 10^6\\,\\mathrm{N/m}$, $m_h = 0.5\\,\\mathrm{kg}$, $k_0 = 10^5\\,\\mathrm{N/m}$, $\\alpha \\in \\{0,\\, 1.0,\\, 5.0,\\, 20.0,\\, 40.0\\}$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case result is itself a list of the form $[\\alpha^\\star, [\\Delta t_{\\max}(\\alpha_1), \\ldots, \\Delta t_{\\max}(\\alpha_M)]]$. For example, the output line must be of the form $[[\\alpha^\\star_1,[\\ldots]],[\\alpha^\\star_2,[\\ldots]],[\\alpha^\\star_3,[\\ldots]]]$ with all $\\Delta t_{\\max}$ values in seconds rounded to six decimal places and $\\alpha^\\star$ rounded to six decimal places.",
            "solution": "### 1. Stability of the Central Difference Scheme\n\nWe begin with the general single-degree-of-freedom (SDOF) undamped equation of motion:\n$$\nm \\ddot{q}(t) + k q(t) = 0\n$$\nwhere $m$ is the mass, $k$ is the stiffness, and $q(t)$ is the displacement. This can be rewritten in terms of the natural circular frequency $\\omega = \\sqrt{k/m}$ as:\n$$\n\\ddot{q}(t) + \\omega^2 q(t) = 0\n$$\nThe explicit central difference scheme approximates the acceleration at time step $n$ (time $t_n = n \\Delta t$) using a second-order accurate finite difference:\n$$\n\\ddot{q}^n \\approx \\frac{q^{n+1} - 2q^n + q^{n-1}}{(\\Delta t)^2}\n$$\nwhere $q^n = q(t_n)$. Substituting this into the equation of motion yields the discrete recurrence relation:\n$$\n\\frac{q^{n+1} - 2q^n + q^{n-1}}{(\\Delta t)^2} + \\omega^2 q^n = 0\n$$\nSolving for the displacement at the next time step, $q^{n+1}$, we get:\n$$\nq^{n+1} = (2 - (\\omega \\Delta t)^2) q^n - q^{n-1}\n$$\nTo analyze the stability of this recurrence, we seek a solution of the form $q^n = A \\lambda^n$, where $\\lambda$ is a complex amplification factor. Substitution into the recurrence gives the characteristic equation:\n$$\nA \\lambda^{n+1} = (2 - (\\omega \\Delta t)^2) A \\lambda^n - A \\lambda^{n-1}\n$$\n$$\n\\lambda^2 - (2 - (\\omega \\Delta t)^2) \\lambda + 1 = 0\n$$\nFor the numerical solution to remain bounded (stable), the magnitudes of the roots $\\lambda$ of this quadratic equation must be less than or equal to $1$, i.e., $|\\lambda| \\le 1$. The roots are given by the quadratic formula:\n$$\n\\lambda = \\frac{(2 - (\\omega \\Delta t)^2) \\pm \\sqrt{(2 - (\\omega \\Delta t)^2)^2 - 4}}{2}\n$$\nFor the roots to be a complex conjugate pair with unit modulus, the discriminant must be non-positive:\n$$\n(2 - (\\omega \\Delta t)^2)^2 - 4 \\le 0\n$$\n$$\n(2 - (\\omega \\Delta t)^2)^2 \\le 4\n$$\nTaking the square root of both sides gives $|2 - (\\omega \\Delta t)^2| \\le 2$, which is equivalent to the two inequalities:\n$$\n-2 \\le 2 - (\\omega \\Delta t)^2 \\quad \\text{and} \\quad 2 - (\\omega \\Delta t)^2 \\le 2\n$$\nThe second inequality, $2 - (\\omega \\Delta t)^2 \\le 2$, simplifies to $-(\\omega \\Delta t)^2 \\le 0$, which is always true. The first inequality, $-2 \\le 2 - (\\omega \\Delta t)^2$, simplifies to:\n$$\n(\\omega \\Delta t)^2 \\le 4\n$$\n$$\n\\omega \\Delta t \\le 2\n$$\nThis is the necessary and sufficient condition for the stability of the central difference scheme. For a multi-degree-of-freedom system, this condition must hold for all modal frequencies. The stability of the entire system is thus governed by the mode with the highest frequency, $\\omega_{\\max}$. The global stability limit is:\n$$\n\\Delta t \\le \\frac{2}{\\omega_{\\max}}\n$$\n\n### 2. Maximum Stable Time Step $\\Delta t_{\\max}(\\alpha)$\n\nThe problem provides a decoupled two-mode system representing a physical mode and an hourglass mode. The governing equations are:\n1. Physical mode: $m_p \\ddot{q}_p + k_p q_p = 0$. The circular frequency is $\\omega_p = \\sqrt{k_p/m_p}$.\n2. Hourglass mode: $m_h \\ddot{q}_h + \\alpha k_0 q_h = 0$. The circular frequency is $\\omega_h(\\alpha) = \\sqrt{\\alpha k_0/m_h}$.\n\nThe hourglass frequency $\\omega_h(\\alpha)$ depends on the dimensionless stabilization parameter $\\alpha$. For $\\alpha=0$, which corresponds to unstabilized reduced integration, $\\omega_h(0) = 0$. This zero-frequency mode does not limit the time step but results in an unresisted motion (linear drift) that pollutes the solution.\n\nThe highest frequency in the system is $\\omega_{\\max}(\\alpha) = \\max(\\omega_p, \\omega_h(\\alpha))$. The maximum stable time step is therefore a function of $\\alpha$:\n$$\n\\Delta t_{\\max}(\\alpha) = \\frac{2}{\\omega_{\\max}(\\alpha)} = \\frac{2}{\\max\\left(\\sqrt{\\frac{k_p}{m_p}}, \\sqrt{\\frac{\\alpha k_0}{m_h}}\\right)}\n$$\nThis can also be expressed as:\n$$\n\\Delta t_{\\max}(\\alpha) = \\min\\left(2\\sqrt{\\frac{m_p}{k_p}}, 2\\sqrt{\\frac{m_h}{\\alpha k_0}}\\right)\n$$\nwhere if $\\alpha = 0$, the second term is taken to be infinite.\n\n### 3. Critical Stabilization Factor $\\alpha^\\star$\n\nThe stability of the system is controlled by the physical mode when $\\omega_p > \\omega_h(\\alpha)$ and by the hourglass mode when $\\omega_h(\\alpha) > \\omega_p$. The critical stabilization factor, $\\alpha^\\star$, is the value of $\\alpha$ at which the hourglass mode's frequency equals the physical mode's frequency, marking the point where the hourglass mode begins to govern the stability limit.\n$$\n\\omega_h(\\alpha^\\star) = \\omega_p\n$$\nSubstituting the expressions for the frequencies:\n$$\n\\sqrt{\\frac{\\alpha^\\star k_0}{m_h}} = \\sqrt{\\frac{k_p}{m_p}}\n$$\nSquaring both sides and solving for $\\alpha^\\star$ yields:\n$$\n\\frac{\\alpha^\\star k_0}{m_h} = \\frac{k_p}{m_p} \\implies \\alpha^\\star = \\frac{k_p m_h}{k_0 m_p}\n$$\nFor $\\alpha < \\alpha^\\star$, the time step is limited by the physical mode: $\\Delta t_{\\max} = 2/\\omega_p$. For $\\alpha \\ge \\alpha^\\star$, the time step is limited by the hourglass mode: $\\Delta t_{\\max} = 2/\\omega_h(\\alpha)$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the critical hourglass stabilization and maximum stable time steps\n    for a series of test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: m_p, k_p, m_h, k_0, alpha_list\n        (1.0, 1e6, 0.5, 1e5, [0, 0.1, 0.5, 1.0, 5.0, 10.0]),\n        # Case 2: m_p, k_p, m_h, k_0, alpha_list\n        (1.0, 1e6, 0.05, 1e5, [0, 0.25, 0.5, 1.0, 2.0]),\n        # Case 3: m_p, k_p, m_h, k_0, alpha_list\n        (1.0, 4e6, 0.5, 1e5, [0, 1.0, 5.0, 20.0, 40.0]),\n    ]\n\n    final_results_as_strings = []\n    \n    for case in test_cases:\n        m_p, k_p, m_h, k_0, alpha_list = case\n\n        # Calculate the critical stabilization factor alpha_star.\n        # This is derived from equating the physical and hourglass frequencies:\n        # omega_p = omega_h(alpha_star) => sqrt(k_p/m_p) = sqrt(alpha_star*k_0/m_h)\n        # alpha_star = (k_p * m_h) / (k_0 * m_p)\n        if k_0 == 0 or m_p == 0:\n            # Avoid division by zero, though not expected from problem data.\n            alpha_star = float('inf')\n        else:\n            alpha_star = (k_p * m_h) / (k_0 * m_p)\n\n        # Calculate the physical mode circular frequency.\n        omega_p = np.sqrt(k_p / m_p)\n\n        dt_max_list = []\n        for alpha in alpha_list:\n            # Calculate the hourglass mode circular frequency.\n            if alpha == 0:\n                omega_h = 0.0\n            else:\n                omega_h = np.sqrt(alpha * k_0 / m_h)\n\n            # The stability of the central difference scheme is limited by the\n            # maximum frequency in the system: dt_max = 2 / omega_max.\n            omega_max = max(omega_p, omega_h)\n\n            if omega_max == 0:\n                 # This case corresponds to a rigid body motion (k_p=0, alpha=0),\n                 # which has no stability limit.\n                 dt_max = float('inf')\n            else:\n                 dt_max = 2.0 / omega_max\n            \n            dt_max_list.append(dt_max)\n\n        # Format the results for the current case into the required string representation.\n        # All values are rounded to six decimal places.\n        alpha_star_str = f'{alpha_star:.6f}'\n        dt_list_str_parts = [f'{dt:.6f}' for dt in dt_max_list]\n        dt_list_str = f\"[{','.join(dt_list_str_parts)}]\"\n        case_str = f\"[{alpha_star_str},{dt_list_str}]\"\n        \n        final_results_as_strings.append(case_str)\n\n    # Final print statement in the exact required format.\n    print(f\"[[{','.join(final_results_as_strings)}]]\")\n\nsolve()\n```"
        }
    ]
}