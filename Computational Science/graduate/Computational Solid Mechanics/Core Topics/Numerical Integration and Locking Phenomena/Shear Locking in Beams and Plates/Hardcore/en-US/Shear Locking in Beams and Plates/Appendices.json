{
    "hands_on_practices": [
        {
            "introduction": "The Timoshenko beam provides the simplest and most intuitive setting to first encounter shear locking. This exercise guides you through a hands-on implementation of a two-node Timoshenko beam element to quantitatively observe the phenomenon. By comparing your Finite Element Method (FEM) results against an exact analytical solution, you will directly witness how full numerical integration leads to an overly stiff, inaccurate response for thin beams, and how reduced integration can effectively remedy this issue .",
            "id": "3600155",
            "problem": "A cantilever beam of length $L$ with rectangular cross-section of breadth $b$ and thickness $h$ is modeled using the Timoshenko Beam Theory (TBT) and discretized by the Finite Element Method (FEM) with two-node linear elements for the transverse displacement $w(x)$ and the rotation $\\theta(x)$. The beam is clamped at $x=0$ and subjected to a concentrated transverse load $P$ at the free tip $x=L$. The material is linearly elastic, with Young’s modulus $E$, Poisson’s ratio $\\nu$, and shear modulus $G = \\dfrac{E}{2(1+\\nu)}$. A shear correction factor $\\kappa$ modifies the shear stiffness to account for non-uniform shear stress through the thickness. The goal is to construct quantitative benchmarks of tip deflection for slender and thick beams, and to expose shear locking by comparing full versus reduced integration of the shear energy.\n\nStart from first principles: kinematics of Timoshenko beams state that the shear strain is $\\gamma(x) = \\dfrac{dw}{dx} - \\theta(x)$ and the bending curvature is $\\dfrac{d\\theta}{dx}$. The constitutive relations are the bending moment $M(x) = E I \\dfrac{d\\theta}{dx}$ and shear force $V(x) = \\kappa G A \\gamma(x)$, where $I = \\dfrac{b h^3}{12}$ is the second moment of area and $A = b h$ is the cross-sectional area. The total potential energy of the beam under the tip load $P$ is\n$$\n\\Pi[w,\\theta] = \\int_{0}^{L} \\left( \\tfrac{1}{2} E I \\left(\\dfrac{d\\theta}{dx}\\right)^2 + \\tfrac{1}{2} \\kappa G A \\left(\\dfrac{dw}{dx} - \\theta\\right)^2 \\right) \\, dx \\;-\\; P\\, w(L).\n$$\nDiscretize $w$ and $\\theta$ with linear shape functions over each element, assemble the global stiffness matrix, apply clamped boundary conditions at $x=0$ ($w(0)=0$, $\\theta(0)=0$), and solve for the nodal degrees of freedom. Compute the tip deflection $w(L)$ of the finite element model for each test case. As a quantitative benchmark, compare the numerically obtained $w(L)$ to the exact analytical tip deflection from Timoshenko Beam Theory for a cantilever under a tip load,\n$$\nw_{\\mathrm{exact}} = \\frac{P L^3}{3 E I} + \\frac{P L}{\\kappa G A}.\n$$\nDefine the dimensionless ratio\n$$\nR = \\frac{w_{\\mathrm{FE}}}{w_{\\mathrm{exact}}},\n$$\nwhere $w_{\\mathrm{FE}}$ is the finite element tip deflection. Use this ratio to assess accuracy and identify shear locking, with $R<1$ indicating excessive stiffness due to locking.\n\nImplement two quadrature schemes for the shear term $\\int \\tfrac{1}{2} \\kappa G A \\left(\\dfrac{dw}{dx}-\\theta\\right)^2 dx$: \n- Full integration using $2$-point Gauss-Legendre quadrature on the reference element,\n- Reduced integration using $1$-point Gauss-Legendre quadrature on the reference element.\nThe bending term $\\int \\tfrac{1}{2} E I \\left(\\dfrac{d\\theta}{dx}\\right)^2 dx$ should be integrated exactly.\n\nUse the following scientifically realistic material and geometric parameters in International System of Units (SI): $E = 2.10 \\times 10^{11}\\,\\mathrm{Pa}$, $\\nu = 0.3$, $\\kappa = \\dfrac{5}{6}$, $b = 1.0 \\times 10^{-2}\\,\\mathrm{m}$, $L = 1.0\\,\\mathrm{m}$, and $P = 1.0 \\times 10^{3}\\,\\mathrm{N}$. Consider two thicknesses to span slender to thick beams: $h \\in \\{1.0 \\times 10^{-3}\\,\\mathrm{m},\\, 1.0 \\times 10^{-1}\\,\\mathrm{m}\\}$ with varying mesh resolutions and integration schemes.\n\nDesign the test suite as the following six cases, each specified by the tuple $(L,b,h,E,\\nu,\\kappa,P,N_{\\mathrm{el}},n_{\\mathrm{g}})$, where $N_{\\mathrm{el}}$ is the number of elements and $n_{\\mathrm{g}}$ is the number of Gauss points for the shear term:\n- Case $1$: $(1.0,\\, 1.0\\times 10^{-2},\\, 1.0\\times 10^{-3},\\, 2.10\\times 10^{11},\\, 0.3,\\, \\dfrac{5}{6},\\, 1.0\\times 10^{3},\\, 1,\\, 2)$.\n- Case $2$: $(1.0,\\, 1.0\\times 10^{-2},\\, 1.0\\times 10^{-3},\\, 2.10\\times 10^{11},\\, 0.3,\\, \\dfrac{5}{6},\\, 1.0\\times 10^{3},\\, 1,\\, 1)$.\n- Case $3$: $(1.0,\\, 1.0\\times 10^{-2},\\, 1.0\\times 10^{-3},\\, 2.10\\times 10^{11},\\, 0.3,\\, \\dfrac{5}{6},\\, 1.0\\times 10^{3},\\, 8,\\, 2)$.\n- Case $4$: $(1.0,\\, 1.0\\times 10^{-2},\\, 1.0\\times 10^{-3},\\, 2.10\\times 10^{11},\\, 0.3,\\, \\dfrac{5}{6},\\, 1.0\\times 10^{3},\\, 8,\\, 1)$.\n- Case $5$: $(1.0,\\, 1.0\\times 10^{-2},\\, 1.0\\times 10^{-1},\\, 2.10\\times 10^{11},\\, 0.3,\\, \\dfrac{5}{6},\\, 1.0\\times 10^{3},\\, 2,\\, 2)$.\n- Case $6$: $(1.0,\\, 1.0\\times 10^{-2},\\, 1.0\\times 10^{-1},\\, 2.10\\times 10^{11},\\, 0.3,\\, \\dfrac{5}{6},\\, 1.0\\times 10^{3},\\, 2,\\, 1)$.\n\nYour program must compute $R$ for each case. The final output must be a single line containing the six ratios as a comma-separated list enclosed in square brackets, with each ratio rounded to $6$ decimal places, e.g., $\\left[\\dots\\right]$. Since $R$ is dimensionless, no physical unit is required in the output. No external inputs or files are permitted; all parameters are to be embedded in the program.",
            "solution": "The problem requires the calculation of the tip deflection of a cantilever beam using the Finite Element Method (FEM) based on Timoshenko Beam Theory (TBT). The goal is to analyze the phenomenon of shear locking by comparing results from full and reduced numerical integration schemes for slender and thick beams. The numerical results will be compared against the exact analytical solution.\n\nThe starting point is the total potential energy of the beam, $\\Pi$, which is the sum of the strain energy and the potential of the external load.\n$$\n\\Pi[w,\\theta] = U_b + U_s - W_{ext} = \\int_{0}^{L} \\frac{1}{2} E I \\left(\\frac{d\\theta}{dx}\\right)^2 dx + \\int_{0}^{L} \\frac{1}{2} \\kappa G A \\left(\\frac{dw}{dx} - \\theta\\right)^2 dx - P w(L)\n$$\nHere, $U_b$ is the bending strain energy and $U_s$ is the shear strain energy. $w(x)$ is the transverse displacement, $\\theta(x)$ is the cross-section rotation, $E$ is Young's modulus, $I$ is the second moment of area, $\\kappa$ is the shear correction factor, $G$ is the shear modulus, $A$ is the cross-sectional area, $L$ is the beam length, and $P$ is the tip load.\n\nIn the Finite Element Method, the continuous functions $w(x)$ and $\\theta(x)$ are approximated over each element using shape functions and nodal values. For a two-node linear element of length $l_e$, the approximations are:\n$$\nw(\\xi) = N_1(\\xi) w_1 + N_2(\\xi) w_2 \\quad \\text{and} \\quad \\theta(\\xi) = N_1(\\xi) \\theta_1 + N_2(\\xi) \\theta_2\n$$\nwhere $\\xi \\in [-1, 1]$ is the natural coordinate on the element, $w_i$ and $\\theta_i$ are the nodal degrees of freedom (DOFs), and $N_1(\\xi) = \\frac{1}{2}(1-\\xi)$, $N_2(\\xi) = \\frac{1}{2}(1+\\xi)$ are the linear shape functions. The element's nodal displacement vector is $\\mathbf{d}_e = [w_1, \\theta_1, w_2, \\theta_2]^T$.\n\nThe bending curvature and shear strain are expressed in terms of nodal DOFs. The curvature $\\frac{d\\theta}{dx}$ is constant within a linear element:\n$$\n\\frac{d\\theta}{dx} = \\frac{d\\theta}{d\\xi}\\frac{d\\xi}{dx} = \\frac{1}{l_e}(-\\theta_1 + \\theta_2) = \\mathbf{B}_b \\mathbf{d}_e, \\quad \\text{where } \\mathbf{B}_b = \\frac{1}{l_e}[0, -1, 0, 1]\n$$\nThe shear strain $\\gamma(x) = \\frac{dw}{dx} - \\theta(x)$ is:\n$$\n\\gamma(\\xi) = \\frac{1}{l_e}(-w_1 + w_2) - (N_1(\\xi)\\theta_1 + N_2(\\xi)\\theta_2) = \\mathbf{B}_s(\\xi) \\mathbf{d}_e\n$$\nwhere $\\mathbf{B}_s(\\xi) = [-\\frac{1}{l_e}, -N_1(\\xi), \\frac{1}{l_e}, -N_2(\\xi)]$.\n\nThe element stiffness matrix $\\mathbf{K}_e$ is derived from minimizing the potential energy, leading to $\\mathbf{K}_e = \\mathbf{K}_{b,e} + \\mathbf{K}_{s,e}$. The bending stiffness matrix $\\mathbf{K}_{b,e}$ is:\n$$\n\\mathbf{K}_{b,e} = \\int_0^{l_e} E I (\\mathbf{B}_b)^T \\mathbf{B}_b dx = E I l_e (\\mathbf{B}_b)^T \\mathbf{B}_b = \\frac{E I}{l_e} \\begin{bmatrix} 0 & 0 & 0 & 0 \\\\ 0 & 1 & 0 & -1 \\\\ 0 & 0 & 0 & 0 \\\\ 0 & -1 & 0 & 1 \\end{bmatrix}\n$$\nSince the integrand is constant, this represents an exact integration.\n\nThe shear stiffness matrix $\\mathbf{K}_{s,e}$ is computed by numerically integrating over the element length:\n$$\n\\mathbf{K}_{s,e} = \\int_0^{l_e} \\kappa G A (\\mathbf{B}_s)^T \\mathbf{B}_s dx = \\int_{-1}^{1} \\kappa G A (\\mathbf{B}_s(\\xi))^T \\mathbf{B}_s(\\xi) \\frac{l_e}{2} d\\xi\n$$\n\nFor reduced integration ($n_g=1$), we use one Gauss point at $\\xi=0$ with weight $w_1=2$. At $\\xi=0$, $N_1(0)=N_2(0)=1/2$, and $\\mathbf{B}_s(0) = [-\\frac{1}{l_e}, -\\frac{1}{2}, \\frac{1}{l_e}, -\\frac{1}{2}]$. The integral becomes:\n$$\n\\mathbf{K}_{s,e}^{(\\text{1-pt})} = \\kappa G A \\frac{l_e}{2} \\left( w_1 (\\mathbf{B}_s(0))^T \\mathbf{B}_s(0) \\right) = \\kappa G A l_e (\\mathbf{B}_s(0))^T \\mathbf{B}_s(0)\n$$\n$$\n\\mathbf{K}_{s,e}^{(\\text{1-pt})} = \\kappa G A \\begin{bmatrix} 1/l_e & 1/2 & -1/l_e & 1/2 \\\\ 1/2 & l_e/4 & -1/2 & l_e/4 \\\\ -1/l_e & -1/2 & 1/l_e & -1/2 \\\\ 1/2 & l_e/4 & -1/2 & l_e/4 \\end{bmatrix}\n$$\n\nFor full integration ($n_g=2$), we use two Gauss points at $\\xi_{1,2} = \\mp 1/\\sqrt{3}$ with weights $w_{1,2}=1$. This is equivalent to exact integration of the polynomial terms in $(\\mathbf{B}_s)^T \\mathbf{B}_s$, which are at most quadratic in $\\xi$. The resulting matrix is:\n$$\n\\mathbf{K}_{s,e}^{(\\text{2-pt})} = \\kappa G A \\begin{bmatrix} 1/l_e & 1/2 & -1/l_e & 1/2 \\\\ 1/2 & l_e/3 & -1/2 & l_e/6 \\\\ -1/l_e & -1/2 & 1/l_e & -1/2 \\\\ 1/2 & l_e/6 & -1/2 & l_e/3 \\end{bmatrix}\n$$\nThe total element stiffness matrix is $\\mathbf{K}_e = \\mathbf{K}_{b,e} + \\mathbf{K}_{s,e}$, using the appropriate shear matrix.\n\nThe global stiffness matrix $\\mathbf{K}$ and force vector $\\mathbf{F}$ for a mesh of $N_{\\mathrm{el}}$ elements are assembled. The system has $2(N_{\\mathrm{el}}+1)$ DOFs. The load vector $\\mathbf{F}$ is zero everywhere except for the entry corresponding to the transverse displacement at the tip node ($x=L$), which is equal to $P$. Clamped boundary conditions at the root ($x=0$), $w(0)=0$ and $\\theta(0)=0$, are enforced by removing the first two rows and columns of $\\mathbf{K}$ and the first two entries of $\\mathbf{F}$. The resulting reduced system $\\mathbf{K}_{\\text{reduced}} \\mathbf{d}_{\\text{reduced}} = \\mathbf{F}_{\\text{reduced}}$ is solved for the unknown nodal DOFs $\\mathbf{d}_{\\text{reduced}}$.\n\nFrom the solution vector, the tip deflection $w_{\\mathrm{FE}} = w(L)$ is extracted. This is compared to the exact analytical solution from TBT:\n$$\nw_{\\mathrm{exact}} = \\frac{P L^3}{3 E I} + \\frac{P L}{\\kappa G A}\n$$\nThe dimensionless ratio $R = w_{\\mathrm{FE}}/w_{\\mathrm{exact}}$ is computed for each test case. For slender beams, the shear strain $\\gamma = dw/dx - \\theta$ must approach zero. Full integration with linear elements enforces this condition too strongly, causing the element to become overly stiff, a phenomenon known as shear locking, which manifests as $R \\ll 1$. Reduced integration of the shear term relaxes this constraint, mitigating locking and yielding more accurate results for slender beams.\n\nThe computational procedure for each test case is:\n1.  Define the geometric and material parameters.\n2.  Calculate the element length $l_e = L/N_{\\mathrm{el}}$.\n3.  Compute the element bending stiffness matrix $\\mathbf{K}_{b,e}$.\n4.  Compute the element shear stiffness matrix $\\mathbf{K}_{s,e}$ based on the specified number of Gauss points $n_{\\mathrm{g}}$.\n5.  Form the total element stiffness matrix $\\mathbf{K}_e$.\n6.  Assemble the global stiffness matrix $\\mathbf{K}$ for the $N_{\\mathrm{el}}$-element mesh.\n7.  Define the global force vector $\\mathbf{F}$ with load $P$ at the tip.\n8.  Apply boundary conditions to obtain the reduced system.\n9.  Solve the linear system for the unknown displacements.\n10. Extract the numerical tip deflection $w_{\\mathrm{FE}}$.\n11. Compute the exact tip deflection $w_{\\mathrm{exact}}$.\n12. Calculate and store the ratio $R = w_{\\mathrm{FE}} / w_{\\mathrm{exact}}$.\n\nThis process is repeated for all six specified test cases, covering slender and thick beams with different mesh resolutions and integration schemes to demonstrate the principles of shear locking and its remedy.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the tip deflection of a Timoshenko beam using FEM\n    and compares it to the exact analytical solution to demonstrate shear locking.\n    \"\"\"\n\n    def solve_fem_timoshenko(L, b, h, E, nu, kappa, P, Nel, n_g):\n        \"\"\"\n        Computes the ratio R = w_FE / w_exact for a single test case.\n\n        Args:\n            L (float): Beam length\n            b (float): Cross-section breadth\n            h (float): Cross-section thickness\n            E (float): Young's modulus\n            nu (float): Poisson's ratio\n            kappa (float): Shear correction factor\n            P (float): Tip load\n            Nel (int): Number of elements\n            n_g (int): Number of Gauss points for shear term (1 or 2)\n\n        Returns:\n            float: The ratio R of FEM-calculated to exact tip deflection.\n        \"\"\"\n        # 1. Derived properties\n        G = E / (2 * (1 + nu))\n        A = b * h\n        I = b * h**3 / 12\n        le = L / Nel\n\n        # 2. Element stiffness matrices\n        # Bending stiffness matrix (integrated exactly)\n        K_b_e = (E * I / le) * np.array([\n            [0,  0,  0,  0],\n            [0,  1,  0, -1],\n            [0,  0,  0,  0],\n            [0, -1,  0,  1]\n        ])\n\n        # Shear stiffness matrix (numerical integration)\n        if n_g == 1:  # Reduced integration (1-point Gauss)\n            K_s_e = (kappa * G * A) * np.array([\n                [1/le,    1/2, -1/le,    1/2],\n                [ 1/2,   le/4,  -1/2,   le/4],\n                [-1/le,  -1/2,  1/le,   -1/2],\n                [ 1/2,   le/4,  -1/2,   le/4]\n            ])\n        elif n_g == 2:  # Full integration (2-point Gauss)\n            K_s_e = (kappa * G * A) * np.array([\n                [1/le,    1/2, -1/le,    1/2],\n                [ 1/2,   le/3,  -1/2,   le/6],\n                [-1/le,  -1/2,  1/le,   -1/2],\n                [ 1/2,   le/6,  -1/2,   le/3]\n            ])\n        else:\n            raise ValueError(\"Number of Gauss points n_g must be 1 or 2.\")\n        \n        K_e = K_b_e + K_s_e\n\n        # 3. Assembly of global stiffness matrix\n        num_nodes = Nel + 1\n        num_dof = 2 * num_nodes\n        K_global = np.zeros((num_dof, num_dof))\n\n        for i in range(Nel):\n            dof_indices = np.array([2*i, 2*i+1, 2*i+2, 2*i+3])\n            K_global[np.ix_(dof_indices, dof_indices)] += K_e\n\n        # 4. Global force vector\n        F_global = np.zeros(num_dof)\n        F_global[2 * Nel] = P  # Apply force P at w-dof of the last node\n\n        # 5. Apply Boundary Conditions (clamped at x=0, node 0)\n        # DOFs 0 (w_0) and 1 (theta_0) are fixed.\n        # We form the reduced system by removing rows/columns 0 and 1.\n        K_reduced = K_global[2:, 2:]\n        F_reduced = F_global[2:]\n\n        # 6. Solve the linear system\n        d_reduced = np.linalg.solve(K_reduced, F_reduced)\n        \n        # 7. Extract FEM tip deflection\n        # The tip deflection w(L) is at node Nel. Its global DOF is 2*Nel.\n        # In the reduced vector, its index is 2*Nel - 2.\n        w_FE = d_reduced[2 * Nel - 2]\n    \n        # 8. Calculate exact analytical solution\n        w_exact_bending = (P * L**3) / (3 * E * I)\n        w_exact_shear = (P * L) / (kappa * G * A)\n        w_exact = w_exact_bending + w_exact_shear\n\n        # 9. Compute and return the ratio R\n        R = w_FE / w_exact\n        return R\n\n    # Define the six test cases from the problem statement\n    test_cases = [\n        # (L,     b,      h,      E,        nu,  kappa,   P,    Nel, n_g)\n        (1.0, 1.0e-2, 1.0e-3, 2.10e11, 0.3, 5/6, 1.0e3, 1, 2),  # Case 1\n        (1.0, 1.0e-2, 1.0e-3, 2.10e11, 0.3, 5/6, 1.0e3, 1, 1),  # Case 2\n        (1.0, 1.0e-2, 1.0e-3, 2.10e11, 0.3, 5/6, 1.0e3, 8, 2),  # Case 3\n        (1.0, 1.0e-2, 1.0e-3, 2.10e11, 0.3, 5/6, 1.0e3, 8, 1),  # Case 4\n        (1.0, 1.0e-2, 1.0e-1, 2.10e11, 0.3, 5/6, 1.0e3, 2, 2),  # Case 5\n        (1.0, 1.0e-2, 1.0e-1, 2.10e11, 0.3, 5/6, 1.0e3, 2, 1)   # Case 6\n    ]\n\n    results = []\n    for case in test_cases:\n        R = solve_fem_timoshenko(*case)\n        # Format the result to 6 decimal places as required.\n        results.append(f\"{R:.6f}\")\n\n    # Print the final output in the exact specified format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "After observing the effects of shear locking numerically, it is crucial to understand its analytical origins. This practice delves into the fundamental mechanics of the four-node bilinear plate element by applying a \"patch test\" under a state of pure bending, which should theoretically produce zero shear strain. By performing this symbolic calculation, you will prove that the standard element formulation generates spurious, non-zero shear energy, thus uncovering the mathematical root of shear locking in 2D elements .",
            "id": "3600168",
            "problem": "Consider the Mindlin–Reissner plate theory, in which the transverse shear strains are defined (under a specific sign convention consistent with the chosen kinematics) by the relations $$\\gamma_{xz}=\\theta_{x}-\\frac{\\partial w}{\\partial x},\\qquad \\gamma_{yz}=-\\theta_{y}-\\frac{\\partial w}{\\partial y},$$ where $w(x,y)$ is the transverse displacement of the mid-surface and $(\\theta_{x}(x,y),\\theta_{y}(x,y))$ are the rotations of the normal about the $y$- and $x$-axes, respectively. A single four-node bilinear quadrilateral isoparametric Mindlin plate element occupies the rectangle $$\\Omega=\\{(x,y)\\in\\mathbb{R}^{2}\\,|\\,0\\le x\\le L,\\;0\\le y\\le H\\},$$ with nodes at $(0,0)$, $(L,0)$, $(L,H)$, and $(0,H)$. Let the natural coordinates be $(\\xi,\\eta)\\in[-1,1]\\times[-1,1]$ with the affine mapping $$x=\\frac{L}{2}(1+\\xi),\\qquad y=\\frac{H}{2}(1+\\eta),$$ and let the standard bilinear shape functions be $$N_{1}(\\xi,\\eta)=\\frac{1}{4}(1-\\xi)(1-\\eta),\\quad N_{2}(\\xi,\\eta)=\\frac{1}{4}(1+\\xi)(1-\\eta),\\quad N_{3}(\\xi,\\eta)=\\frac{1}{4}(1+\\xi)(1+\\eta),\\quad N_{4}(\\xi,\\eta)=\\frac{1}{4}(1-\\xi)(1+\\eta).$$ The finite element method (FEM) interpolations for $w$, $\\theta_{x}$, and $\\theta_{y}$ are taken as $$w_{h}(\\xi,\\eta)=\\sum_{i=1}^{4}N_{i}(\\xi,\\eta)\\,w_{i},\\qquad \\theta_{x,h}(\\xi,\\eta)=\\sum_{i=1}^{4}N_{i}(\\xi,\\eta)\\,\\theta_{x,i},\\qquad \\theta_{y,h}(\\xi,\\eta)=\\sum_{i=1}^{4}N_{i}(\\xi,\\eta)\\,\\theta_{y,i},$$ where the subscript $h$ denotes the discrete field and the nodal values $(w_{i},\\theta_{x,i},\\theta_{y,i})$ are prescribed by sampling the exact fields at the nodes according to the zero-shear patch test definition: $$w(x,y)=\\alpha x^{2},\\qquad \\theta_{x}(x,y)=\\frac{\\partial w}{\\partial x}=2\\alpha x,\\qquad \\theta_{y}(x,y)=-\\frac{\\partial w}{\\partial y}=0.$$ Using these specifications, compute the element’s residual discrete shear energy $$U_{s}=\\frac{1}{2}\\,\\kappa\\,G\\,t\\int_{\\Omega}\\left(\\gamma_{xz,h}^{2}+\\gamma_{yz,h}^{2}\\right)\\,d\\Omega,$$ where $\\kappa$ is the shear correction factor, $G$ is the shear modulus, and $t$ is the plate thickness. Express your final answer symbolically as a closed-form analytic expression in terms of $\\alpha$, $L$, $H$, $\\kappa$, $G$, and $t$. Express the final energy in Joules. No numerical approximation or rounding is required.",
            "solution": "The objective is to compute the discrete shear energy $U_s$ for a four-node bilinear quadrilateral element subjected to a pure bending deformation field. This energy is given by:\n$$\nU_s = \\frac{1}{2}\\,\\kappa\\,G\\,t \\int_{\\Omega} \\left(\\gamma_{xz,h}^{2}+\\gamma_{yz,h}^{2}\\right)\\,d\\Omega\n$$\nThe discrete shear strains, $\\gamma_{xz,h}$ and $\\gamma_{yz,h}$, are defined based on the finite element interpolations of the displacement and rotation fields:\n$$\n\\gamma_{xz,h} = \\theta_{x,h} - \\frac{\\partial w_h}{\\partial x} \\qquad \\text{and} \\qquad \\gamma_{yz,h} = -\\theta_{y,h} - \\frac{\\partial w_h}{\\partial y}\n$$\n\nFirst, we determine the nodal values $(w_i, \\theta_{x,i}, \\theta_{y,i})$ by sampling the given exact fields at the four nodes of the element $(0,0), (L,0), (L,H), (0,H)$. The exact fields are $w(x,y)=\\alpha x^{2}$, $\\theta_{x}(x,y)=2\\alpha x$, and $\\theta_{y}(x,y)=0$.\nSampling at the nodes yields:\n-   $w_1 = 0$, $w_2 = \\alpha L^2$, $w_3 = \\alpha L^2$, $w_4 = 0$\n-   $\\theta_{x,1} = 0$, $\\theta_{x,2} = 2\\alpha L$, $\\theta_{x,3} = 2\\alpha L$, $\\theta_{x,4} = 0$\n-   $\\theta_{y,1} = \\theta_{y,2} = \\theta_{y,3} = \\theta_{y,4} = 0$\n\nNext, we construct the interpolated fields using the bilinear shape functions $N_i(\\xi, \\eta)$.\n$$w_{h}(\\xi,\\eta) = \\sum_{i=1}^{4}N_{i}w_{i} = N_2(\\alpha L^2) + N_3(\\alpha L^2) = \\alpha L^2 (N_2 + N_3)$$\n$$\\theta_{x,h}(\\xi,\\eta) = \\sum_{i=1}^{4}N_{i}\\theta_{x,i} = N_2(2\\alpha L) + N_3(2\\alpha L) = 2\\alpha L (N_2 + N_3)$$\n$$\\theta_{y,h}(\\xi,\\eta) = 0$$\nUsing the definitions of the shape functions, we find $N_2 + N_3 = \\frac{1}{2}(1+\\xi)$. Substituting this into the interpolated fields gives:\n$$w_h(\\xi, \\eta) = \\frac{\\alpha L^2}{2}(1+\\xi)$$\n$$\\theta_{x,h}(\\xi, \\eta) = \\alpha L(1+\\xi)$$\n\nTo compute the spatial derivatives $\\frac{\\partial w_h}{\\partial x}$ and $\\frac{\\partial w_h}{\\partial y}$, we use the chain rule. The Jacobian of the coordinate mapping $x=\\frac{L}{2}(1+\\xi), y=\\frac{H}{2}(1+\\eta)$ is diagonal, leading to the relations $\\frac{\\partial}{\\partial x} = \\frac{2}{L}\\frac{\\partial}{\\partial \\xi}$ and $\\frac{\\partial}{\\partial y} = \\frac{2}{H}\\frac{\\partial}{\\partial \\eta}$. Applying these to $w_h$:\n$$\\frac{\\partial w_h}{\\partial x} = \\frac{2}{L}\\frac{\\partial}{\\partial \\xi}\\left(\\frac{\\alpha L^2}{2}(1+\\xi)\\right) = \\frac{2}{L}\\left(\\frac{\\alpha L^2}{2}\\right) = \\alpha L$$\n$$\\frac{\\partial w_h}{\\partial y} = \\frac{2}{H}\\frac{\\partial}{\\partial \\eta}\\left(\\frac{\\alpha L^2}{2}(1+\\xi)\\right) = 0$$\n\nNow we compute the discrete shear strains. While the exact solution corresponds to a state of zero shear, the bilinear element produces a spurious, non-zero shear strain:\n$$\\gamma_{xz,h} = \\theta_{x,h} - \\frac{\\partial w_h}{\\partial x} = \\alpha L(1+\\xi) - \\alpha L = \\alpha L \\xi$$\n$$\\gamma_{yz,h} = -\\theta_{y,h} - \\frac{\\partial w_h}{\\partial y} = -0 - 0 = 0$$\nThis non-zero $\\gamma_{xz,h}$ is the source of shear locking.\n\nFinally, we compute the shear energy by integrating over the element area in the natural coordinate system. The differential area element is $d\\Omega = \\det(\\mathbf{J})\\,d\\xi\\,d\\eta = \\frac{LH}{4}\\,d\\xi\\,d\\eta$.\n$$U_{s}=\\frac{1}{2}\\,\\kappa\\,G\\,t\\int_{-1}^{1}\\int_{-1}^{1}\\left((\\alpha L\\xi)^{2}+0^{2}\\right)\\,\\frac{LH}{4}\\,d\\xi\\,d\\eta$$\n$$U_{s}=\\frac{1}{8}\\,\\kappa\\,G\\,t\\,\\alpha^2 L^3 H \\int_{-1}^{1}\\int_{-1}^{1}\\xi^2\\,d\\xi\\,d\\eta$$\nThe integral evaluates to $\\left(\\int_{-1}^{1}\\xi^2\\,d\\xi\\right)\\left(\\int_{-1}^{1}d\\eta\\right) = \\left(\\frac{2}{3}\\right)(2) = \\frac{4}{3}$.\nSubstituting this value back into the energy expression yields the final result:\n$$U_{s} = \\frac{1}{8}\\,\\kappa\\,G\\,t\\,\\alpha^2 L^3 H \\left(\\frac{4}{3}\\right) = \\frac{1}{6}\\kappa G t \\alpha^2 L^3 H$$\nThis is the spurious shear energy stored in the element, which ideally should be zero.",
            "answer": "$$\\boxed{\\frac{\\kappa G t \\alpha^{2} L^{3} H}{6}}$$"
        },
        {
            "introduction": "Building on the analytical insights from the patch test, this practice applies the concepts to a full boundary value problem: a uniformly loaded, clamped square plate. This exercise highlights the practical implications of locking in a 2D setting and explores the sensitivity of the results to the shear correction factor, $\\kappa$. Importantly, the specific mesh configuration reveals a pathological case where even reduced integration fails to completely eliminate locking, providing a critical lesson on the subtleties and potential pitfalls of common numerical remedies .",
            "id": "3600210",
            "problem": "Consider a square, clamped, thin plate modeled using the Reissner–Mindlin kinematic assumptions under a spatially uniform transverse pressure load. The square plate has side length $a$, thickness $t$, Young’s modulus $E$, and Poisson’s ratio $\\nu$. The transverse deflection field is $w(x,y)$ and the rotations of the normal are $\\theta_x(x,y)$ and $\\theta_y(x,y)$. The Reissner–Mindlin plate kinematics define the bending curvatures and transverse shear strains by\n$$\n\\kappa_x = \\frac{\\partial \\theta_x}{\\partial x},\\quad \\kappa_y = \\frac{\\partial \\theta_y}{\\partial y},\\quad \\kappa_{xy} = \\frac{\\partial \\theta_x}{\\partial y} + \\frac{\\partial \\theta_y}{\\partial x},\n$$\n$$\n\\gamma_{xz} = \\theta_x + \\frac{\\partial w}{\\partial x},\\quad \\gamma_{yz} = \\theta_y + \\frac{\\partial w}{\\partial y}.\n$$\nThe bending constitutive relation uses the plate bending stiffness\n$$\nD_b = \\frac{E t^3}{12(1-\\nu^2)},\n$$\nwith stress–resultant vector $\\{M_x,M_y,M_{xy}\\}$ related to $\\{\\kappa_x,\\kappa_y,\\kappa_{xy}\\}$ by\n$$\n\\begin{bmatrix} M_x \\\\ M_y \\\\ M_{xy} \\end{bmatrix}\n=\nD_b\n\\begin{bmatrix}\n1 & \\nu & 0 \\\\\n\\nu & 1 & 0 \\\\\n0 & 0 & \\frac{1-\\nu}{2}\n\\end{bmatrix}\n\\begin{bmatrix}\n\\kappa_x \\\\ \\kappa_y \\\\ \\kappa_{xy}\n\\end{bmatrix}.\n$$\nThe transverse shear constitutive relation uses the shear correction factor $\\kappa$ and shear modulus $G=\\dfrac{E}{2(1+\\nu)}$ to define\n$$\n\\begin{bmatrix} Q_x \\\\ Q_y \\end{bmatrix}\n=\n\\kappa\\,G\\,t\\,\n\\begin{bmatrix}\n1 & 0 \\\\\n0 & 1\n\\end{bmatrix}\n\\begin{bmatrix}\n\\gamma_{xz} \\\\ \\gamma_{yz}\n\\end{bmatrix}.\n$$\nThe plate is clamped on all four edges, meaning $w=0$, $\\theta_x=0$, and $\\theta_y=0$ on the boundary. The plate is subjected to a uniform transverse load $q$ (force per unit area), acting downward.\n\nUse a four-node bilinear quadrilateral Finite Element Method (FEM) discretization with $2\\times 2$ elements over the square domain. Each node carries three Degrees of Freedom (DOF): transverse deflection $w$, rotation $\\theta_x$, and rotation $\\theta_y$. Implement the element stiffness by numerical quadrature as follows:\n\n- For the bending part, use the standard $2\\times 2$ Gauss integration.\n- For the shear part, implement two variants:\n  1. A “locked” element with full $2\\times 2$ Gauss integration of the shear stiffness.\n  2. An “unlocked” element with reduced $1\\times 1$ Gauss integration of the shear stiffness at the element center.\n\nAssemble the global stiffness and the consistent load vector corresponding to the uniform load $q$ distributed to the $w$ DOFs using $2\\times 2$ Gauss integration. Apply the clamped boundary conditions by enforcing $w=\\theta_x=\\theta_y=0$ on all boundary nodes. Solve the linear systems for both the locked and unlocked shear integration variants, and extract the nodal transverse deflection at the geometric center of the plate.\n\nYour task is to compute the sensitivity of the predicted center deflection to the shear correction factor $\\kappa$ by evaluating several parameter sets. Use the following material and geometric parameters in SI units:\n- $a = 1.0\\,\\mathrm{m}$,\n- $E = 210\\times 10^9\\,\\mathrm{Pa}$,\n- $\\nu = 0.3$,\n- $q = 1000\\,\\mathrm{N/m^2}$.\n\nThe test suite consists of the following cases, each specified by $(t,\\kappa)$:\n1. $(t = 0.01\\,\\mathrm{m},\\ \\kappa = 5/6)$,\n2. $(t = 0.01\\,\\mathrm{m},\\ \\kappa = 1)$,\n3. $(t = 0.001\\,\\mathrm{m},\\ \\kappa = 5/6)$,\n4. $(t = 0.1\\,\\mathrm{m},\\ \\kappa = 5/6)$.\n\nFor each case, compute the center deflection using both the locked and unlocked shear integration variants. Express each deflection in $\\mathrm{m}$ as a floating-point number. Your program should produce a single line of output containing eight numbers in a comma-separated list enclosed in square brackets, ordered as\n$$\n[\\ w_{\\text{locked},1},\\ w_{\\text{unlocked},1},\\ w_{\\text{locked},2},\\ w_{\\text{unlocked},2},\\ w_{\\text{locked},3},\\ w_{\\text{unlocked},3},\\ w_{\\text{locked},4},\\ w_{\\text{unlocked},4}\\ ],\n$$\nwhere $w_{\\text{locked},i}$ and $w_{\\text{unlocked},i}$ are the center deflections for test case $i$ computed with the locked and unlocked elements, respectively. Answer in $\\mathrm{m}$ with default floating-point formatting.",
            "solution": "The solution to this problem can be greatly simplified by exploiting the symmetry of the geometry, mesh, and loading. The domain is a square, the load is uniform, the boundary conditions are symmetric, and the $2\\times2$ mesh preserves this symmetry.\n\nDue to the clamped boundary conditions, all degrees of freedom (DOFs) on the boundary nodes are zero. The only node with non-zero DOFs is the central node of the $3\\times3$ grid. Let the DOFs of this central node be $(w_c, \\theta_{xc}, \\theta_{yc})$.\n\nBecause of the complete symmetry of the problem, the response must also be symmetric. This implies that the rotations at the center of the plate must be zero, i.e., $\\theta_{xc}=0$ and $\\theta_{yc}=0$. Furthermore, the $3\\times3$ stiffness sub-matrix for the central node's DOFs is diagonal. This uncouples the governing equations. The system of equations for the central node reduces to:\n$$\nK_{w_c w_c} w_c = F_{w_c}\n$$\nwhere $K_{w_c w_c}$ is the stiffness term corresponding to the central transverse displacement and $F_{w_c}$ is the corresponding nodal force.\n\nThe stiffness term $K_{w_c w_c}$ receives contributions only from the shear part of the element stiffness matrix, as the bending part only couples rotational DOFs. The central node is a corner node for each of the four elements in the mesh. The global stiffness $K_{w_c w_c}$ is the sum of the four local element stiffness contributions. By performing the numerical integration for the shear stiffness component related to a corner node's $w$ DOF, we find:\n-   Full integration ($2\\times2$ Gauss): The local stiffness contribution is $\\frac{2}{3}\\kappa G t$.\n-   Reduced integration ($1\\times1$ Gauss): The local stiffness contribution is $\\frac{1}{2}\\kappa G t$.\n\nSumming the contributions from the four elements:\n$$\nK_{w_c w_c, \\text{locked}} = 4 \\times \\frac{2}{3} \\kappa G t = \\frac{8}{3} \\kappa G t\n$$\n$$\nK_{w_c w_c, \\text{unlocked}} = 4 \\times \\frac{1}{2} \\kappa G t = 2 \\kappa G t\n$$\nThe consistent nodal force at the center node is the sum of contributions from the four elements. For a uniform load $q$, each element contributes $q \\times (\\text{element area})/4$ to each of its corner nodes. The element area is $(a/2)^2 = a^2/4$.\n$$\nF_{w_c} = 4 \\times \\left( q \\frac{a^2/4}{4} \\right) = \\frac{q a^2}{4}\n$$\nThe center deflection $w_c = F_{w_c} / K_{w_c w_c}$ can now be calculated:\nFor the locked case:\n$$\nw_{\\text{locked}} = \\frac{q a^2 / 4}{(8/3) \\kappa G t} = \\frac{3 q a^2}{32 \\kappa G t} = \\frac{3 q a^2 (1+\\nu)}{16 \\kappa E t}\n$$\nFor the unlocked case:\n$$\nw_{\\text{unlocked}} = \\frac{q a^2 / 4}{2 \\kappa G t} = \\frac{q a^2}{8 \\kappa G t} = \\frac{q a^2 (1+\\nu)}{4 \\kappa E t}\n$$\nThese formulas show that the computed deflection is proportional to $1/t$, not the $1/t^3$ dependence expected for bending of a thin plate. This indicates that for this specific coarse mesh and problem symmetry, the model is pathologically stiff and exhibits severe shear locking, even with reduced integration. The task is to report the results of this specific, albeit flawed, model.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the center deflection of a clamped square plate under uniform pressure\n    using a 2x2 mesh of 4-node Reissner-Mindlin plate elements. The code implements\n    analytical formulas derived by exploiting the problem's symmetry, which\n    drastically simplifies the system of equations. For this specific mesh and\n    boundary conditions, the center deflection depends only on the shear stiffness,\n    demonstrating a pathological case of shear locking.\n    \"\"\"\n\n    # Define the problem parameters in SI units.\n    a = 1.0  # m\n    E = 210e9  # Pa\n    nu = 0.3  # Poisson's ratio\n    q = 1000.0  # N/m^2\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple (t, kappa).\n    test_cases = [\n        (0.01, 5.0/6.0),\n        (0.01, 1.0),\n        (0.001, 5.0/6.0),\n        (0.1, 5.0/6.0),\n    ]\n\n    results = []\n    for t, kappa in test_cases:\n        # Based on the analytical derivation for this specific problem setup:\n        # w_locked = (3 * q * a**2 * (1 + nu)) / (16 * kappa * E * t)\n        # w_unlocked = (q * a**2 * (1 + nu)) / (4 * kappa * E * t)\n        \n        # Constant part for the \"locked\" (full 2x2 integration) formula.\n        c_locked_numerator = 3.0 * q * a**2 * (1.0 + nu)\n        c_locked_denominator = 16.0 * E\n        c_locked = c_locked_numerator / c_locked_denominator\n        \n        # Constant part for the \"unlocked\" (reduced 1x1 integration) formula.\n        c_unlocked_numerator = q * a**2 * (1.0 + nu)\n        c_unlocked_denominator = 4.0 * E\n        c_unlocked = c_unlocked_numerator / c_unlocked_denominator\n\n        # Calculate deflections for the current test case\n        # w = C / (kappa * t)\n        \n        denominator = kappa * t\n        \n        w_locked = c_locked / denominator\n        w_unlocked = c_unlocked / denominator\n        \n        results.append(w_locked)\n        results.append(w_unlocked)\n\n    # Final print statement in the exact required format.\n    # Using np.float64 to ensure standard floating-point representation.\n    print(f\"[{','.join(map(str, [np.float64(x) for x in results]))}]\")\n\nsolve()\n```"
        }
    ]
}