{
    "hands_on_practices": [
        {
            "introduction": "在深入研究径向返回算法的数值实现之前，我们必须首先牢固掌握其背后的核心物理概念。本练习旨在通过从第一性原理推导 von Mises 等效应力，来加深您对 $J_2$ 塑性理论的理解，并验证其关键特性——屈服对应力张量的静水压力部分不敏感。这一基础性的分析练习将为您后续更复杂的数值任务奠定坚实的理论基础。",
            "id": "3592674",
            "problem": "在一个均匀、各向同性的小应变固体中，应力张量 $\\boldsymbol{\\sigma}$ 的主值 $(\\sigma_{1},\\sigma_{2},\\sigma_{3})$ 通过谱分解得到。在经典的 $\\mathrm{J}_{2}$ 塑性理论中，流动法则和径向返回映射算法由 von Mises 等效应力驱动，该等效应力根据偏应力张量 $\\boldsymbol{s}$ 及其第二不变量定义。从以下基本定义出发：\n\n(i) 偏应力为 $\\boldsymbol{s} = \\boldsymbol{\\sigma} - \\frac{1}{3}\\,\\mathrm{tr}(\\boldsymbol{\\sigma})\\,\\boldsymbol{I}$，其中 $\\mathrm{tr}(\\cdot)$ 表示迹，$\\boldsymbol{I}$ 是单位张量。\n\n(ii) 偏应力的第二不变量为 $J_{2} = \\frac{1}{2}\\,\\boldsymbol{s}:\\boldsymbol{s}$，其中 $:$ 表示双点积 $\\boldsymbol{A}:\\boldsymbol{B} = \\mathrm{tr}(\\boldsymbol{A}^{\\top}\\boldsymbol{B})$。\n\n(iii) von Mises 等效应力为 $\\sigma_{\\mathrm{eq}} = \\sqrt{3\\,J_{2}}$。\n\n请推导一个完全用主应力 $(\\sigma_{1},\\sigma_{2},\\sigma_{3})$ 表示的 $\\sigma_{\\mathrm{eq}}$ 的闭式表达式，并利用该表达式及上述定义，验证当增加一个静水压力偏移 $p$ 使得变换后的应力张量为 $\\tilde{\\boldsymbol{\\sigma}} = \\boldsymbol{\\sigma} + p\\,\\boldsymbol{I}$ 时，$\\sigma_{\\mathrm{eq}}$ 保持不变。最终答案仅需提供用 $(\\sigma_{1},\\sigma_{2},\\sigma_{3})$ 表示的 $\\sigma_{\\mathrm{eq}}$ 的单个代数表达式。无需进行数值计算，也无需四舍五入。最终表达式中不应包含物理单位。",
            "solution": "该问题是有效的。它在科学上基于连续介质力学的原理，是适定的，并且陈述客观。为进行完整推导，所有必要的定义均已提供。\n\n任务是推导 von Mises 等效应力 $\\sigma_{\\mathrm{eq}}$ 用主应力 $(\\sigma_{1}, \\sigma_{2}, \\sigma_{3})$ 表示的表达式，并验证其在静水应力偏移下的不变性。\n\n设应力张量为 $\\boldsymbol{\\sigma}$。在主应力坐标系中，$\\boldsymbol{\\sigma}$ 表示为一个对角矩阵，其对角线上的元素为主应力：\n$$\n\\boldsymbol{\\sigma} = \\begin{pmatrix} \\sigma_{1} & 0 & 0 \\\\ 0 & \\sigma_{2} & 0 \\\\ 0 & 0 & \\sigma_{3} \\end{pmatrix}\n$$\n在此基底下，单位张量 $\\boldsymbol{I}$ 为：\n$$\n\\boldsymbol{I} = \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}\n$$\n\n首先，我们计算应力张量的迹 $\\mathrm{tr}(\\boldsymbol{\\sigma})$：\n$$\n\\mathrm{tr}(\\boldsymbol{\\sigma}) = \\sigma_{1} + \\sigma_{2} + \\sigma_{3}\n$$\n迹与平均应力或静水应力 $\\sigma_{m}$ 的关系为 $\\sigma_{m} = \\frac{1}{3}\\mathrm{tr}(\\boldsymbol{\\sigma})$。\n\n接下来，我们使用给定定义求偏应力张量 $\\boldsymbol{s}$：$\\boldsymbol{s} = \\boldsymbol{\\sigma} - \\frac{1}{3}\\mathrm{tr}(\\boldsymbol{\\sigma})\\boldsymbol{I}$。\n$$\n\\boldsymbol{s} = \\begin{pmatrix} \\sigma_{1} & 0 & 0 \\\\ 0 & \\sigma_{2} & 0 \\\\ 0 & 0 & \\sigma_{3} \\end{pmatrix} - \\frac{1}{3}(\\sigma_{1} + \\sigma_{2} + \\sigma_{3}) \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}\n$$\n这产生一个对角张量，其分量为主偏应力 $(s_{1}, s_{2}, s_{3})$：\n$$\ns_{1} = \\sigma_{1} - \\frac{1}{3}(\\sigma_{1} + \\sigma_{2} + \\sigma_{3}) = \\frac{2\\sigma_{1} - \\sigma_{2} - \\sigma_{3}}{3}\n$$\n$$\ns_{2} = \\sigma_{2} - \\frac{1}{3}(\\sigma_{1} + \\sigma_{2} + \\sigma_{3}) = \\frac{2\\sigma_{2} - \\sigma_{1} - \\sigma_{3}}{3}\n$$\n$$\ns_{3} = \\sigma_{3} - \\frac{1}{3}(\\sigma_{1} + \\sigma_{2} + \\sigma_{3}) = \\frac{2\\sigma_{3} - \\sigma_{1} - \\sigma_{2}}{3}\n$$\n注意，偏应力张量的迹为零：$\\mathrm{tr}(\\boldsymbol{s}) = s_{1} + s_{2} + s_{3} = 0$。\n\n现在，我们计算偏应力的第二不变量 $J_{2} = \\frac{1}{2}\\boldsymbol{s}:\\boldsymbol{s}$。双点积 $\\boldsymbol{s}:\\boldsymbol{s}$ 是张量分量的平方和。由于在此基底下 $\\boldsymbol{s}$ 是对角张量，这可简化为主偏应力的平方和：\n$$\n\\boldsymbol{s}:\\boldsymbol{s} = s_{1}^{2} + s_{2}^{2} + s_{3}^{2}\n$$\n因此，$J_{2}$ 由下式给出：\n$$\nJ_{2} = \\frac{1}{2}(s_{1}^{2} + s_{2}^{2} + s_{3}^{2})\n$$\n我们代入 $s_{1}, s_{2}, s_{3}$ 的表达式：\n$$\nJ_{2} = \\frac{1}{2} \\left[ \\left(\\frac{2\\sigma_{1} - \\sigma_{2} - \\sigma_{3}}{3}\\right)^{2} + \\left(\\frac{2\\sigma_{2} - \\sigma_{1} - \\sigma_{3}}{3}\\right)^{2} + \\left(\\frac{2\\sigma_{3} - \\sigma_{1} - \\sigma_{2}}{3}\\right)^{2} \\right]\n$$\n$$\nJ_{2} = \\frac{1}{18} \\left[ (2\\sigma_{1} - \\sigma_{2} - \\sigma_{3})^{2} + (2\\sigma_{2} - \\sigma_{1} - \\sigma_{3})^{2} + (2\\sigma_{3} - \\sigma_{1} - \\sigma_{2})^{2} \\right]\n$$\n展开括号中的各项：\n$$\n(2\\sigma_{1} - \\sigma_{2} - \\sigma_{3})^{2} = 4\\sigma_{1}^{2} + \\sigma_{2}^{2} + \\sigma_{3}^{2} - 4\\sigma_{1}\\sigma_{2} + 2\\sigma_{2}\\sigma_{3} - 4\\sigma_{3}\\sigma_{1}\n$$\n$$\n(2\\sigma_{2} - \\sigma_{1} - \\sigma_{3})^{2} = 4\\sigma_{2}^{2} + \\sigma_{1}^{2} + \\sigma_{3}^{2} - 4\\sigma_{1}\\sigma_{2} - 4\\sigma_{2}\\sigma_{3} + 2\\sigma_{3}\\sigma_{1}\n$$\n$$\n(2\\sigma_{3} - \\sigma_{1} - \\sigma_{2})^{2} = 4\\sigma_{3}^{2} + \\sigma_{1}^{2} + \\sigma_{2}^{2} + 2\\sigma_{1}\\sigma_{2} - 4\\sigma_{2}\\sigma_{3} - 4\\sigma_{3}\\sigma_{1}\n$$\n将这三个表达式相加，得到：\n$$\n6\\sigma_{1}^{2} + 6\\sigma_{2}^{2} + 6\\sigma_{3}^{2} - 6\\sigma_{1}\\sigma_{2} - 6\\sigma_{2}\\sigma_{3} - 6\\sigma_{3}\\sigma_{1} = 6(\\sigma_{1}^{2} + \\sigma_{2}^{2} + \\sigma_{3}^{2} - \\sigma_{1}\\sigma_{2} - \\sigma_{2}\\sigma_{3} - \\sigma_{3}\\sigma_{1})\n$$\n将此和代回 $J_{2}$ 的表达式中：\n$$\nJ_{2} = \\frac{1}{18} \\cdot 6(\\sigma_{1}^{2} + \\sigma_{2}^{2} + \\sigma_{3}^{2} - \\sigma_{1}\\sigma_{2} - \\sigma_{2}\\sigma_{3} - \\sigma_{3}\\sigma_{1}) = \\frac{1}{3}(\\sigma_{1}^{2} + \\sigma_{2}^{2} + \\sigma_{3}^{2} - \\sigma_{1}\\sigma_{2} - \\sigma_{2}\\sigma_{3} - \\sigma_{3}\\sigma_{1})\n$$\n此表达式可以使用恒等式 $2(a^{2}+b^{2}+c^{2}-ab-bc-ca) = (a-b)^{2}+(b-c)^{2}+(c-a)^{2}$ 改写成更紧凑和常见的形式。\n$$\nJ_{2} = \\frac{1}{6} [(\\sigma_{1}-\\sigma_{2})^{2} + (\\sigma_{2}-\\sigma_{3})^{2} + (\\sigma_{3}-\\sigma_{1})^{2}]\n$$\n最后，我们求出 von Mises 等效应力 $\\sigma_{\\mathrm{eq}} = \\sqrt{3J_{2}}$：\n$$\n\\sigma_{\\mathrm{eq}} = \\sqrt{3 \\cdot \\frac{1}{6} [(\\sigma_{1}-\\sigma_{2})^{2} + (\\sigma_{2}-\\sigma_{3})^{2} + (\\sigma_{3}-\\sigma_{1})^{2}]}\n$$\n$$\n\\sigma_{\\mathrm{eq}} = \\sqrt{\\frac{1}{2} [(\\sigma_{1}-\\sigma_{2})^{2} + (\\sigma_{2}-\\sigma_{3})^{2} + (\\sigma_{3}-\\sigma_{1})^{2}]}\n$$\n这就是所求的用主应力表示的 $\\sigma_{\\mathrm{eq}}$ 的闭式表达式。\n\n现在，我们必须验证 $\\sigma_{\\mathrm{eq}}$ 在静水压力偏移 $p$ 下是不变的，该偏移将应力张量变换为 $\\tilde{\\boldsymbol{\\sigma}} = \\boldsymbol{\\sigma} + p\\boldsymbol{I}$。\n设新的主应力为 $\\tilde{\\sigma}_{1}, \\tilde{\\sigma}_{2}, \\tilde{\\sigma}_{3}$。主方向不变，因此新的主应力就是：\n$$\n\\tilde{\\sigma}_{1} = \\sigma_{1} + p, \\quad \\tilde{\\sigma}_{2} = \\sigma_{2} + p, \\quad \\tilde{\\sigma}_{3} = \\sigma_{3} + p\n$$\n我们可以通过两种方法验证其不变性。\n\n方法1：使用推导出的 $\\sigma_{\\mathrm{eq}}$ 表达式。\n让我们通过将新的主应力代入公式来计算偏移状态下的等效应力 $\\tilde{\\sigma}_{\\mathrm{eq}}$：\n$$\n\\tilde{\\sigma}_{\\mathrm{eq}} = \\sqrt{\\frac{1}{2} [(\\tilde{\\sigma}_{1}-\\tilde{\\sigma}_{2})^{2} + (\\tilde{\\sigma}_{2}-\\tilde{\\sigma}_{3})^{2} + (\\tilde{\\sigma}_{3}-\\tilde{\\sigma}_{1})^{2}]}\n$$\n主应力之差为：\n$$\n\\tilde{\\sigma}_{1} - \\tilde{\\sigma}_{2} = (\\sigma_{1} + p) - (\\sigma_{2} + p) = \\sigma_{1} - \\sigma_{2}\n$$\n$$\n\\tilde{\\sigma}_{2} - \\tilde{\\sigma}_{3} = (\\sigma_{2} + p) - (\\sigma_{3} + p) = \\sigma_{2} - \\sigma_{3}\n$$\n$$\n\\tilde{\\sigma}_{3} - \\tilde{\\sigma}_{1} = (\\sigma_{3} + p) - (\\sigma_{1} + p) = \\sigma_{3} - \\sigma_{1}\n$$\n这些差值不受静水压力偏移的影响。将其代回：\n$$\n\\tilde{\\sigma}_{\\mathrm{eq}} = \\sqrt{\\frac{1}{2} [(\\sigma_{1}-\\sigma_{2})^{2} + (\\sigma_{2}-\\sigma_{3})^{2} + (\\sigma_{3}-\\sigma_{1})^{2}]} = \\sigma_{\\mathrm{eq}}\n$$\n这证实了 $\\sigma_{\\mathrm{eq}}$ 是不变的。\n\n方法2：使用基本定义。\n让我们求出新应力张量 $\\tilde{\\boldsymbol{\\sigma}}$ 的偏量部分。\n首先，$\\tilde{\\boldsymbol{\\sigma}}$ 的迹是：\n$$\n\\mathrm{tr}(\\tilde{\\boldsymbol{\\sigma}}) = \\mathrm{tr}(\\boldsymbol{\\sigma} + p\\boldsymbol{I}) = \\mathrm{tr}(\\boldsymbol{\\sigma}) + \\mathrm{tr}(p\\boldsymbol{I}) = \\mathrm{tr}(\\boldsymbol{\\sigma}) + p\\,\\mathrm{tr}(\\boldsymbol{I}) = \\mathrm{tr}(\\boldsymbol{\\sigma}) + 3p\n$$\n新的偏应力张量 $\\tilde{\\boldsymbol{s}}$ 是：\n$$\n\\tilde{\\boldsymbol{s}} = \\tilde{\\boldsymbol{\\sigma}} - \\frac{1}{3}\\mathrm{tr}(\\tilde{\\boldsymbol{\\sigma}})\\boldsymbol{I} = (\\boldsymbol{\\sigma} + p\\boldsymbol{I}) - \\frac{1}{3}(\\mathrm{tr}(\\boldsymbol{\\sigma}) + 3p)\\boldsymbol{I}\n$$\n$$\n\\tilde{\\boldsymbol{s}} = \\boldsymbol{\\sigma} + p\\boldsymbol{I} - \\frac{1}{3}\\mathrm{tr}(\\boldsymbol{\\sigma})\\boldsymbol{I} - \\frac{1}{3}(3p)\\boldsymbol{I} = \\boldsymbol{\\sigma} + p\\boldsymbol{I} - \\frac{1}{3}\\mathrm{tr}(\\boldsymbol{\\sigma})\\boldsymbol{I} - p\\boldsymbol{I}\n$$\n$$\n\\tilde{\\boldsymbol{s}} = \\boldsymbol{\\sigma} - \\frac{1}{3}\\mathrm{tr}(\\boldsymbol{\\sigma})\\boldsymbol{I} = \\boldsymbol{s}\n$$\n应力张量的偏量部分本身在静水压力偏移下是不变的。由于 $J_{2}$ 和 $\\sigma_{\\mathrm{eq}}$ 仅根据偏应力定义，它们也必定是不变的。具体来说，$\\tilde{J}_{2} = \\frac{1}{2}\\tilde{\\boldsymbol{s}}:\\tilde{\\boldsymbol{s}} = \\frac{1}{2}\\boldsymbol{s}:\\boldsymbol{s} = J_{2}$，因此 $\\tilde{\\sigma}_{\\mathrm{eq}} = \\sqrt{3\\tilde{J}_{2}} = \\sqrt{3J_{2}} = \\sigma_{\\mathrm{eq}}$。这便完成了验证。\n最终答案是推导出的 $\\sigma_{\\mathrm{eq}}$ 的代数表达式。",
            "answer": "$$\n\\boxed{\\sqrt{\\frac{1}{2} \\left[ (\\sigma_{1} - \\sigma_{2})^{2} + (\\sigma_{2} - \\sigma_{3})^{2} + (\\sigma_{3} - \\sigma_{1})^{2} \\right]}}\n$$"
        },
        {
            "introduction": "将理论转化为可执行的代码是计算力学的核心环节。本练习将指导您实现径向返回算法的核心部分——材料点的应力更新，并特别关注数值稳健性。您将学习如何通过引入比例容差来安全地处理试探偏应力接近于零的临界情况，从而避免在实际计算中可能出现的除以零错误和虚假塑性。",
            "id": "3592677",
            "problem": "考虑标准的关联 von Mises（偏应力张量的第二不变量，通常表示为 $J_{2}$）塑性模型，该模型具有线性各向同性硬化。设试探偏柯西应力为 $\\mathbf{s}_\\text{trial}\\in\\mathbb{R}^{3\\times 3}$，剪切模量为 $G>0$，初始屈服应力为 $\\sigma_{y0}>0$，各向同性硬化模量为 $H\\ge 0$，当前等效塑性应变（硬化变量）为 $\\alpha_{n}\\ge 0$。屈服函数定义为\n$$\nf(\\mathbf{s},\\alpha)=\\sqrt{\\frac{3}{2}}\\,\\|\\mathbf{s}\\|-\\big(\\sigma_{y0}+H\\,\\alpha\\big),\n$$\n其中 $\\|\\mathbf{s}\\|=\\sqrt{\\mathbf{s}:\\mathbf{s}}$ 是 Frobenius 范数。对于径向返回映射，关联流动方向为 $\\mathbf{n}=\\mathbf{s}_\\text{trial}/\\|\\mathbf{s}_\\text{trial}\\|$。\n\n您的任务是，从第一性原理推导并实现一个数值安全的算法，该算法能够：\n- 使用屈服函数 $f$ 和一致性条件评估试探状态，并判断是弹性响应还是塑性响应。\n- 当塑性被激活时，通过径向返回映射计算塑性修正，确保更新后的偏应力保持在屈服面上。\n- 当 $\\|\\mathbf{s}_\\text{trial}\\|\\ll 1$ 时，通过引入一个比例容差来稳健地计算流动方向 $\\mathbf{n}$，以避免除以一个非常小的 $\\|\\mathbf{s}_\\text{trial}\\|$。具体来说，定义相对容差 $\\mathrm{rtol}=\\sqrt{\\varepsilon_{\\text{mach}}}$，其中 $\\varepsilon_{\\text{mach}}$ 是双精度浮点运算的机器精度，并使用应力尺度\n$$\ns_\\text{scale}=\\max\\Big(\\sigma_{y0}+H\\,\\alpha_{n},\\,\\|\\mathbf{s}_\\text{trial}\\|\\Big).\n$$\n构建两个决策容差\n$$\n\\tau_{n}=\\mathrm{rtol}\\,s_\\text{scale,\\quad}\\tau_{f}=\\mathrm{rtol}\\,\\max\\Big(\\sigma_{y0}+H\\,\\alpha_{n},\\,\\sqrt{\\frac{3}{2}}\\,\\|\\mathbf{s}_\\text{trial}\\|\\Big).\n$$\n如果 $\\|\\mathbf{s}_\\text{trial}\\|\\le \\tau_{n}$，则不能通过直接归一化来计算 $\\mathbf{n}$；相反，必须回退到弹性预测，并设置一个指示回退的标志。如果 $f(\\mathbf{s}_\\text{trial},\\alpha_{n})\\le \\tau_{f}$，则将该步骤视为弹性。否则，使用关联流动法则和线性各向同性硬化，通过径向返回映射执行塑性修正，并在更新状态下强制执行屈服面一致性。\n\n科学和数值要求：\n- 从基本的小应变线性弹性及其偏量响应、von Mises 屈服函数 $f$、关联流动以及 Kuhn–Tucker 条件出发。请勿在问题陈述中使用任何快捷更新公式。您的实现必须在您的解决方案中从这些基础推导得出。\n- 塑性乘子增量 $\\Delta\\gamma$ 是非负的，并且必须与所选 $f$ 和硬化模型的返回曲面条件一致地计算。硬化变量遵循关联流动和线性各向同性硬化规律从 $\\alpha_{n}$ 更新到 $\\alpha_{n+1}$。\n- 最终报告的量是：\n    1. 更新后的偏应力范数 $\\|\\mathbf{s}_{n+1}\\|$，单位为帕斯卡 (Pa)。\n    2. 塑性乘子增量 $\\Delta\\gamma$，为无量纲量。\n    3. 一个整数回退标志，如果因 $\\|\\mathbf{s}_\\text{trial}\\|$ 过小而使用了弹性预测器回退，则为 $1$，否则为 $0$。\n    4. 一个整数塑性标志，如果应用了塑性修正，则为 $1$，否则为 $0$。\n- 所有应力必须以帕斯卡 (Pa) 为单位表示。不出现角度。不出现百分比。\n\n测试套件：\n您必须在以下四个测试用例上运行您的算法。在每种情况下，构建 $\\mathbf{s}_\\text{trial}$，指定材料参数，并使用给定的 $\\alpha_{n}$。\n\n- 测试用例 1（一般塑性情况，对角偏应力）：\n    - $G=80\\times 10^{9}\\ \\text{Pa}$，$\\sigma_{y0}=400\\times 10^{6}\\ \\text{Pa}$，$H=1\\times 10^{9}\\ \\text{Pa}$，以及 $\\alpha_{n}=0$。\n    - 选择一个目标试探偏应力范数 $S_\\text{target}=\\|\\mathbf{s}_\\text{trial}\\|=\\dfrac{\\sigma_{y0}+100\\times 10^{6}}{\\sqrt{3/2}}$。\n    - 设 $\\mathbf{s}_\\text{trial}$ 为迹为零的对角矩阵：$\\mathbf{s}_\\text{trial}=\\kappa\\,\\mathrm{diag}(2,-1,-1)$，其中 $\\kappa=S_\\text{target}/\\sqrt{6}$。\n\n- 测试用例 2（接近零的范数，触发回退）：\n    - $G=80\\times 10^{9}\\ \\text{Pa}$，$\\sigma_{y0}=400\\times 10^{6}\\ \\text{Pa}$，$H=1\\times 10^{9}\\ \\text{Pa}$，以及 $\\alpha_{n}=0$。\n    - 通过相同的对角偏应力形式设置 $\\|\\mathbf{s}_\\text{trial}\\|=1\\times 10^{-12}\\ \\text{Pa}$：$\\mathbf{s}_\\text{trial}=\\kappa\\,\\mathrm{diag}(2,-1,-1)$，其中 $\\kappa=(1\\times 10^{-12})/\\sqrt{6}$。\n\n- 测试用例 3（临界塑性情况，$f$ 略为正值）：\n    - $G=80\\times 10^{9}\\ \\text{Pa}$，$\\sigma_{y0}=400\\times 10^{6}\\ \\text{Pa}$，$H=1\\times 10^{9}\\ \\text{Pa}$，以及 $\\alpha_{n}=0$。\n    - 设置 $\\|\\mathbf{s}_\\text{trial}\\|=\\dfrac{\\sigma_{y0}+10}{\\sqrt{3/2}}$ 并如测试用例 1 那样构建 $\\mathbf{s}_\\text{trial}$。\n\n- 测试用例 4（非对角剪切，塑性情况）：\n    - $G=80\\times 10^{9}\\ \\text{Pa}$，$\\sigma_{y0}=400\\times 10^{6}\\ \\text{Pa}$，$H=1\\times 10^{9}\\ \\text{Pa}$，以及 $\\alpha_{n}=0$。\n    - 设唯一的非零分量为 $\\mathbf{s}_\\text{trial,12}=\\mathbf{s}_\\text{trial,21}=300\\times 10^{6}\\ \\text{Pa}$，其余均为零。这得出 $\\|\\mathbf{s}_\\text{trial}\\|=\\sqrt{2}\\,(300\\times 10^{6})\\ \\text{Pa}$。\n\n程序输出规范：\n- 对每个测试用例，计算并收集列表 $[\\|\\mathbf{s}_{n+1}\\|,\\Delta\\gamma,\\text{fallback\\_flag},\\text{plastic\\_flag}]$。\n- 您的程序应生成一行输出，其中包含结果，结果是一个用方括号括起来的逗号分隔列表，每个测试用例的结果都包含在自己的方括号内，并按上述测试套件的顺序排列（例如，`[[r_{1,1},r_{1,2},r_{1,3},r_{1,4}],[r_{2,1},r_{2,2},r_{2,3},r_{2,4}],...]`）。",
            "solution": "该问题要求推导并实现一个用于标准 von Mises ($J_2$) 线性各向同性硬化塑性模型的径向返回映射算法。推导必须源于连续介质塑性力学的第一性原理，具体包括弹塑性分解、屈服条件、流动法则和硬化定律。\n\n在一个时间步开始时（用下标 $n$ 表示），材料的状态由偏应力 $\\mathbf{s}_n$ 和等效塑性应变 $\\alpha_n$ 来表征。发生应变增量后，会产生一个试探偏应力 $\\mathbf{s}_\\text{trial}$。目标是找到该步结束时的更新状态 $(\\mathbf{s}_{n+1}, \\alpha_{n+1})$。该框架基于算子分裂方法，首先计算一个试探弹性状态，然后如有必要，进行塑性修正阶段。\n\n核心原理如下：\n1. 应变率的弹塑性分解。\n2. 弹性部分的弹性应力-应变关系。\n3. 定义弹性区域边界的屈服函数 $f$。\n4. 指定塑性应变方向的流动法则。\n5. 描述屈服面演化的硬化定律。\n6. Karush-Kuhn-Tucker (KKT) 加载/卸载条件。\n\n让我们开始推导。\n\n模型由以下给定参数定义：剪切模量 $G > 0$，初始屈服应力 $\\sigma_{y0} > 0$，各向同性硬化模量 $H \\ge 0$，以及增量开始时的状态变量：偏应力 $\\mathbf{s}_n$ 和等效塑性应变 $\\alpha_n$。问题提供了试探偏应力 $\\mathbf{s}_\\text{trial}$，它代表了对总应变增量的纯弹性响应：\n$$\n\\mathbf{s}_\\text{trial} = \\mathbf{s}_n + 2G\\,\\Delta\\mathbf{e}\n$$\n其中 $\\Delta\\mathbf{e}$ 是总应变张量偏量部分的增量。\n\n屈服条件由 von Mises 屈服函数给出：\n$$\nf(\\mathbf{s}, \\alpha) = \\sqrt{\\frac{3}{2}}\\,\\|\\mathbf{s}\\| - \\sigma_y(\\alpha) \\le 0\n$$\n其中 $\\|\\mathbf{s}\\| = \\sqrt{\\mathbf{s}:\\mathbf{s}}$ 是偏应力张量的 Frobenius 范数，$\\sigma_y(\\alpha)$ 是当前屈服应力。对于线性各向同性硬化，屈服应力演化如下：\n$$\n\\sigma_y(\\alpha) = \\sigma_{y0} + H\\alpha\n$$\n\n第一步是评估试探状态下的屈服函数，$f_\\text{trial} = f(\\mathbf{s}_\\text{trial}, \\alpha_n)$。根据 KKT 条件（$\\Delta\\gamma \\ge 0$, $f_{n+1} \\le 0$, $\\Delta\\gamma f_{n+1} = 0$），我们判断该步是弹性的还是塑性的。\n\n问题为此决策引入了数值容差。设 $\\varepsilon_{\\text{mach}}$ 为机器精度。相对容差为 $\\mathrm{rtol} = \\sqrt{\\varepsilon_{\\text{mach}}}$。\n屈服容差为 $\\tau_{f} = \\mathrm{rtol}\\,\\max(\\sigma_y(\\alpha_n), \\sqrt{3/2}\\|\\mathbf{s}_\\text{trial}\\|)$。\n\n如果 $f(\\mathbf{s}_\\text{trial}, \\alpha_n) \\le \\tau_f$，则该步被视为弹性。塑性乘子增量 $\\Delta\\gamma$ 为零。最终状态即为试探状态：\n$$\n\\mathbf{s}_{n+1} = \\mathbf{s}_\\text{trial}\n$$\n$$\n\\alpha_{n+1} = \\alpha_n\n$$\n在这种情况下，`plastic_flag` 为 $0$。\n\n如果 $f(\\mathbf{s}_\\text{trial}, \\alpha_n) > \\tau_f$，则试探状态位于屈服面之外，需要进行塑性修正。这是一个塑性步，其中 $\\Delta\\gamma > 0$，并且最终状态必须满足一致性条件 $f(\\mathbf{s}_{n+1}, \\alpha_{n+1}) = 0$。\n\n塑性修正由关联流动法则控制，其中塑性应变增量垂直于屈服面：\n$$\n\\Delta\\mathbf{e}^p = \\Delta\\gamma \\frac{\\partial f}{\\partial \\mathbf{s}}\n$$\n屈服函数相对于偏应力 $\\mathbf{s}$ 的梯度为：\n$$\n\\frac{\\partial f}{\\partial \\mathbf{s}} = \\frac{\\partial}{\\partial \\mathbf{s}} \\left( \\sqrt{\\frac{3}{2}} (\\mathbf{s}:\\mathbf{s})^{1/2} \\right) = \\sqrt{\\frac{3}{2}} \\frac{\\mathbf{s}}{\\|\\mathbf{s}\\|}\n$$\n更新后的应力 $\\mathbf{s}_{n+1}$ 是通过从试探应力中减去由塑性应变引起的弹性应力变化得到的：\n$$\n\\mathbf{s}_{n+1} = \\mathbf{s}_\\text{trial} - 2G\\,\\Delta\\mathbf{e}^p\n$$\n对于隐式积分格式，梯度在最终状态 $\\mathbf{s}_{n+1}$ 处进行评估。\n$$\n\\mathbf{s}_{n+1} = \\mathbf{s}_\\text{trial} - 2G \\Delta\\gamma \\sqrt{\\frac{3}{2}} \\frac{\\mathbf{s}_{n+1}}{\\|\\mathbf{s}_{n+1}\\|}\n$$\n此方程揭示了 $\\mathbf{s}_{n+1}$ 必须与 $\\mathbf{s}_\\text{trial}$ 共线。这是 $J_2$ 塑性径向返回映射的定义特征。设 $\\mathbf{n} = \\mathbf{s}_\\text{trial} / \\|\\mathbf{s}_\\text{trial}\\|$。那么我们也有 $\\mathbf{n} = \\mathbf{s}_{n+1} / \\|\\mathbf{s}_{n+1}\\|$。应力更新变为：\n$$\n\\mathbf{s}_{n+1} = \\mathbf{s}_\\text{trial} - 2G \\Delta\\gamma \\sqrt{\\frac{3}{2}} \\mathbf{n}\n$$\n对两边取 Frobenius 范数，并注意到 $\\mathbf{s}_\\text{trial}$ 和 $\\mathbf{n}$ 是共线的：\n$$\n\\|\\mathbf{s}_{n+1}\\| = \\|\\mathbf{s}_\\text{trial}\\| - 2G \\Delta\\gamma \\sqrt{\\frac{3}{2}}\n$$\n硬化变量 $\\alpha$ 随塑性功演化。对于 $J_2$ 塑性，通常定义为 $\\Delta\\alpha = \\Delta\\gamma$。因此，更新后的硬化变量为：\n$$\n\\alpha_{n+1} = \\alpha_n + \\Delta\\gamma\n$$\n现在，我们强制执行一致性条件，$f(\\mathbf{s}_{n+1}, \\alpha_{n+1}) = 0$：\n$$\n\\sqrt{\\frac{3}{2}} \\|\\mathbf{s}_{n+1}\\| - (\\sigma_{y0} + H\\alpha_{n+1}) = 0\n$$\n代入 $\\|\\mathbf{s}_{n+1}\\|$ 和 $\\alpha_{n+1}$ 的表达式：\n$$\n\\sqrt{\\frac{3}{2}} \\left( \\|\\mathbf{s}_\\text{trial}\\| - 2G \\Delta\\gamma \\sqrt{\\frac{3}{2}} \\right) - \\left( \\sigma_{y0} + H(\\alpha_n + \\Delta\\gamma) \\right) = 0\n$$\n展开并重新整理各项以求解 $\\Delta\\gamma$：\n$$\n\\sqrt{\\frac{3}{2}} \\|\\mathbf{s}_\\text{trial}\\| - 3G \\Delta\\gamma - (\\sigma_{y0} + H\\alpha_n) - H\\Delta\\gamma = 0\n$$\n认识到第一项和第三项构成了试探屈服函数值 $f(\\mathbf{s}_\\text{trial}, \\alpha_n)$：\n$$\nf(\\mathbf{s}_\\text{trial}, \\alpha_n) - (3G+H)\\Delta\\gamma = 0\n$$\n这得出了塑性乘子增量的闭式解：\n$$\n\\Delta\\gamma = \\frac{f(\\mathbf{s}_\\text{trial}, \\alpha_n)}{3G + H}\n$$\n由于该步是塑性的，$f(\\mathbf{s}_\\text{trial}, \\alpha_n) > 0$。又因 $G > 0$ 和 $H \\ge 0$，可以保证 $\\Delta\\gamma > 0$。\n\n一旦计算出 $\\Delta\\gamma$，所有其他的最终量都可以确定。`plastic_flag` 被设置为 $1$。更新后的偏应力范数 $\\|\\mathbf{s}_{n+1}\\|$ 最稳健的计算方法是利用一致性条件：\n$$\n\\|\\mathbf{s}_{n+1}\\| = \\sqrt{\\frac{2}{3}} (\\sigma_{y0} + H\\alpha_{n+1}) = \\sqrt{\\frac{2}{3}} (\\sigma_{y0} + H[\\alpha_n + \\Delta\\gamma])\n$$\n当 $\\|\\mathbf{s}_\\text{trial}\\|$ 非常小时，需要一个特殊情况来保证数值稳健性。接近零的试探应力在计算流动方向 $\\mathbf{n} = \\mathbf{s}_\\text{trial}/\\|\\mathbf{s}_\\text{trial}\\|$ 时可能导致浮点错误。问题为此定义了一个容差 $\\tau_n$：\n$$\ns_\\text{scale} = \\max(\\sigma_y(\\alpha_n), \\|\\mathbf{s}_\\text{trial}\\|)\n$$\n$$\n\\tau_n = \\mathrm{rtol} \\cdot s_\\text{scale}\n$$\n如果 $\\|\\mathbf{s}_\\text{trial}\\| \\le \\tau_n$，则认为试探状态位于偏应力空间的原点。这是一个明确的弹性状态。为避免数值问题，我们将 `fallback_flag` 设置为 $1$，并将该步视为弹性，无论 $f$ 的值如何。因此，$\\mathbf{s}_{n+1} = \\mathbf{s}_\\text{trial}$，$\\Delta\\gamma=0$，`plastic_flag=0`。如果此检查未触发，则 `fallback_flag` 为 $0$。\n\n最终算法如下：\n1. 给定输入 $\\mathbf{s}_\\text{trial}, \\alpha_n, G, \\sigma_{y0}, H$。将 `fallback_flag` 初始化为 $0$，`plastic_flag` 初始化为 $0$。\n2. 计算 $\\|\\mathbf{s}_\\text{trial}\\|$。\n3. 按规定计算容差 $\\tau_n$ 和 $\\tau_f$。\n4. 检查回退：如果 $\\|\\mathbf{s}_\\text{trial}\\| \\le \\tau_n$，设置 `fallback_flag=1`，$\\Delta\\gamma=0$，$\\|\\mathbf{s}_{n+1}\\| = \\|\\mathbf{s}_\\text{trial}\\|$，然后返回结果。\n5. 计算试探屈服函数值 $f_\\text{trial} = \\sqrt{3/2}\\|\\mathbf{s}_\\text{trial}\\| - (\\sigma_{y0} + H\\alpha_n)$。\n6. 检查塑性加载：如果 $f_\\text{trial} > \\tau_f$：\n    a. 设置 `plastic_flag=1`。\n    b. 计算 $\\Delta\\gamma = f_\\text{trial} / (3G+H)$。\n    c. 计算 $\\|\\mathbf{s}_{n+1}\\| = \\sqrt{2/3}(\\sigma_{y0} + H(\\alpha_n + \\Delta\\gamma))$。\n7. 否则（弹性步）：\n    a. 设置 $\\Delta\\gamma=0$。\n    b. 设置 $\\|\\mathbf{s}_{n+1}\\| = \\|\\mathbf{s}_\\text{trial}\\|$。\n8. 返回计算值：$\\|\\mathbf{s}_{n+1}\\|$，$\\Delta\\gamma$，`fallback_flag` 和 `plastic_flag`。\n这完成了推导和算法规范。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nimport math\n\n# Per the problem description, scipy is listed as a library but is not needed\n# for the analytical solution of this specific plasticity model.\n# from scipy import linalg\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite for the radial return mapping algorithm.\n    \"\"\"\n\n    def radial_return_J2(s_trial, alpha_n, G, sigma_y0, H):\n        \"\"\"\n        Implements the radial return mapping for J2 plasticity with linear isotropic hardening.\n\n        Args:\n            s_trial (np.ndarray): The 3x3 trial deviatoric stress tensor.\n            alpha_n (float): The equivalent plastic strain at the start of the increment.\n            G (float): Shear modulus.\n            sigma_y0 (float): Initial yield stress.\n            H (float): Isotropic hardening modulus.\n\n        Returns:\n            tuple: A tuple containing:\n                - norm_s_n1 (float): The norm of the updated deviatoric stress.\n                - delta_gamma (float): The plastic multiplier increment.\n                - fallback_flag (int): 1 if near-zero norm fallback was used, 0 otherwise.\n                - plastic_flag (int): 1 if a plastic correction was applied, 0 otherwise.\n        \"\"\"\n        fallback_flag = 0\n        plastic_flag = 0\n        \n        # Machine epsilon for double precision\n        eps_mach = np.finfo(float).eps\n        rtol = math.sqrt(eps_mach)\n\n        # Calculate Frobenius norm of the trial deviatoric stress\n        norm_s_trial = np.linalg.norm(s_trial)\n\n        # Current yield stress\n        sigma_y_n = sigma_y0 + H * alpha_n\n        \n        # --- Fallback Check for near-zero trial stress norm ---\n        s_scale = max(sigma_y_n, norm_s_trial)\n        tau_n = rtol * s_scale\n\n        if norm_s_trial = tau_n:\n            fallback_flag = 1\n            # Elastic fallback: the final state is the trial state\n            norm_s_n1 = norm_s_trial\n            delta_gamma = 0.0\n            plastic_flag = 0\n            return [norm_s_n1, delta_gamma, fallback_flag, plastic_flag]\n\n        # --- Yield Check ---\n        # von Mises equivalent stress for the trial state\n        sigma_vm_trial = math.sqrt(3.0 / 2.0) * norm_s_trial\n        \n        # Trial yield function value\n        f_trial = sigma_vm_trial - sigma_y_n\n        \n        # Tolerance for the yield function check\n        tau_f = rtol * max(sigma_y_n, sigma_vm_trial)\n\n        if f_trial = tau_f:\n            # Elastic step\n            plastic_flag = 0\n            delta_gamma = 0.0\n            norm_s_n1 = norm_s_trial\n        else:\n            # Plastic step (radial return)\n            plastic_flag = 1\n            \n            # Compute plastic multiplier\n            delta_gamma = f_trial / (3.0 * G + H)\n            \n            # Update hardening variable\n            alpha_n1 = alpha_n + delta_gamma\n            \n            # Updated yield stress\n            sigma_y_n1 = sigma_y0 + H * alpha_n1\n            \n            # Compute the norm of the updated deviatoric stress from the consistency condition\n            norm_s_n1 = math.sqrt(2.0 / 3.0) * sigma_y_n1\n\n        return [norm_s_n1, delta_gamma, fallback_flag, plastic_flag]\n\n    # Material parameters from the problem statement\n    G_val = 80.0e9  # Pa\n    sigma_y0_val = 400.0e6  # Pa\n    H_val = 1.0e9  # Pa\n    alpha_n_val = 0.0\n\n    # Define test cases\n    test_cases_params = [\n        {'type': 'diag', 'norm_val': (sigma_y0_val + 100.0e6) / math.sqrt(1.5)},\n        {'type': 'diag', 'norm_val': 1.0e-12},\n        {'type': 'diag', 'norm_val': (sigma_y0_val + 10.0) / math.sqrt(1.5)},\n        {'type': 'off_diag', 'shear_val': 300.0e6},\n    ]\n\n    results = []\n    \n    for params in test_cases_params:\n        s_trial = np.zeros((3, 3))\n        if params['type'] == 'diag':\n            S_target = params['norm_val']\n            kappa = S_target / math.sqrt(6.0)\n            s_trial[0, 0] = 2.0 * kappa\n            s_trial[1, 1] = -1.0 * kappa\n            s_trial[2, 2] = -1.0 * kappa\n        elif params['type'] == 'off_diag':\n            s_trial[0, 1] = params['shear_val']\n            s_trial[1, 0] = params['shear_val']\n\n        result_case = radial_return_J2(s_trial, alpha_n_val, G_val, sigma_y0_val, H_val)\n        results.append(result_case)\n\n    # Format the output as per the specification\n    # [[r1_1,...,r1_4], [r2_1,...,r2_4], ...]\n    output_str = f\"[{','.join([f'[{\",\".join(map(str, res))}]' for res in results])}]\"\n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "材料点的局部应力更新是有限元模拟全局求解过程中的一个关键子问题。为了确保全局牛顿迭代法能够实现二次收敛，我们需要提供应力更新算法的精确线性化形式，即算法一致性切线模量。这个高级练习将引导您推导该切线模量，并在一维问题中通过数值实验，直观地比较使用一致性切线与弹性切线时全局求解的收敛速度差异，从而深刻体会其在提升计算效率中的重要作用。",
            "id": "3592675",
            "problem": "考虑小应变、率无关、各向同性硬化的 von Mises（也称为 $J_2$）塑性，在等温条件下。假设一个初始无应力、均匀、各向同性的线弹性固体，其杨氏模量为 $E$，泊松比为 $v$，并附加了模量为 $H \\ge 0$ 的线性各向同性硬化。拉梅参数定义为 $\\lambda = \\dfrac{Ev}{(1+v)(1-2v)}$ 和 $\\mu = \\dfrac{E}{2(1+v)}$，体积模量为 $K = \\lambda + \\dfrac{2}{3}\\mu = \\dfrac{E}{3(1-2v)}$。令柯西应力为 $\\boldsymbol{\\sigma}$，无穷小应变为 $\\boldsymbol{\\varepsilon}$，其偏量部分为 $\\mathbf{s} = \\text{dev}\\,\\boldsymbol{\\sigma}$ 和 $\\boldsymbol{\\varepsilon}^{\\text{dev}} = \\text{dev}\\,\\boldsymbol{\\varepsilon}$，并令等效塑性应变为 $\\varepsilon^{\\text{eq}}_p$。von Mises 等效应力为 $q = \\sqrt{\\dfrac{3}{2}}\\,\\|\\mathbf{s}\\|_2$。屈服条件为 $f(\\boldsymbol{\\sigma},\\varepsilon^{\\text{eq}}_p) = q - \\sigma_y(\\varepsilon^{\\text{eq}}_p) \\le 0$，其中 $\\sigma_y(\\varepsilon^{\\text{eq}}_p) = \\sigma_{y0} + H \\varepsilon^{\\text{eq}}_p$ 且初始屈服应力 $\\sigma_{y0}  0$。使用相关联流动法则。考虑标准的弹性预测-塑性修正算法（径向返回映射），用于在给定总应变增量的情况下，对一个材料点从步骤 $n$到 $n+1$ 进行局部应力更新。\n\n您的任务：\n\n1) 基于上述基本定义，推导小应变情况下带有线性各向同性硬化的 $J_2$ 塑性的闭式径向返回映射。您的推导应基于弹性预测、屈服函数和一致性条件，不援引任何预先推导的塑性更新公式。最后给出更新后的柯西应力 $\\boldsymbol{\\sigma}_{n+1}$ 和更新后的等效塑性应变 $\\varepsilon^{\\text{eq}}_{p,n+1}$ 关于已知总应变 $\\boldsymbol{\\varepsilon}_{n+1}$ 和前一步内变量的显式表达式。\n\n2) 线性化返回映射的应力更新，以推导精确的算法一致性切线模量 $\\mathbb{C}_{\\text{alg}} = \\dfrac{\\partial \\boldsymbol{\\sigma}_{n+1}}{\\partial \\boldsymbol{\\varepsilon}_{n+1}}$，它是一个四阶张量。您的推导必须从上述定义出发，应用一致性条件，并在适当之处保留偏流方向 $\\mathbf{n} = \\mathbf{s}/\\|\\mathbf{s}\\|_2$。提供 $\\mathbb{C}_{\\text{alg}}$ 的最终表达式，其形式应能清晰地分离体积和偏量贡献。\n\n3) 通过设计一个在单轴应变加载 $\\boldsymbol{\\varepsilon} = \\text{diag}(\\varepsilon,0,0)$ 下的应力更新实验，评估当 $v \\to 0.5$ 时的鲁棒性。实验对象为一根长度为 $L$、横截面积为 $A$ 的一维杆，无体力，并施加规定的端部载荷 $F$。全局残差为 $R(u) = A\\,\\sigma_{11}(\\varepsilon(u)) - F$，其中轴向应变为 $\\varepsilon(u) = u/L$。实现两种全局牛顿法来求解 $R(u)=0$：\n- 方法 (i)：使用精确的算法一致性切线，即由投影到单轴应变路径上的 $\\mathbb{C}_{\\text{alg}}$ 构成的全局切线 $dR/du$。\n- 方法 (ii)：使用纯弹性切线，即仅由线弹性模量构成的全局切线 $dR/du$。\n\n在两种方法中都使用相同的局部应力更新（径向返回）；仅全局牛顿切线不同。从线弹性单轴应变解 $u_0 = F L / (A M)$ 开始牛顿法，其中 $M = \\lambda + 2\\mu$ 是单轴应变模量。当 $|R(u_k)| \\le \\tau \\max(1,|F|)$（其中容差 $\\tau = 10^{-10}$）时，或达到最大迭代次数 50 次时终止。将迭代次数计为执行的牛顿更新次数；如果初始猜测已满足容差，则报告为 0。\n\n4) 使用国际单位制（SI）。所有应力和模量必须以帕斯卡（Pascals）为单位，长度以米（meters）为单位，力以牛顿（Newtons）为单位，应变为无量纲。如果出现任何角度，请使用弧度。\n\n5) 在一个完整的、可运行的程序中实现上述内容，以执行以下测试套件。对于每个案例，运行两种牛顿法，并按 [一致性, 弹性] 的顺序报告迭代次数对。每个案例开始时，材料点的历史记录为零塑性应变和零应力。\n\n测试套件（每个案例使用 $A = 1\\,\\text{m}^2$ 和 $L = 1\\,\\text{m}$）：\n- 案例 1（弹性，中等可压缩性）：\n  - $E = 210\\times 10^9\\,\\text{Pa}$，$v = 0.3$，$\\sigma_{y0} = 250\\times 10^6\\,\\text{Pa}$，$H = 1\\times 10^9\\,\\text{Pa}$，$F = 349600000\\,\\text{N}$。\n- 案例 2（理想塑性，中等可压缩性）：\n  - $E = 210\\times 10^9\\,\\text{Pa}$，$v = 0.3$，$\\sigma_{y0} = 250\\times 10^6\\,\\text{Pa}$，$H = 0\\,\\text{Pa}$，$F = 524400000\\,\\text{N}$。\n- 案例 3（塑性，近乎不可压缩）：\n  - $E = 210\\times 10^9\\,\\text{Pa}$，$v = 0.4999$，$\\sigma_{y0} = 250\\times 10^6\\,\\text{Pa}$，$H = 1\\times 10^9\\,\\text{Pa}$，$F = 750000000000\\,\\text{N}$。\n- 案例 4（理想塑性，近乎不可压缩）：\n  - $E = 210\\times 10^9\\,\\text{Pa}$，$v = 0.4999$，$\\sigma_{y0} = 250\\times 10^6\\,\\text{Pa}$，$H = 0\\,\\text{Pa}$，$F = 750000000000\\,\\text{N}$。\n\n要求的最终输出格式：\n- 您的程序应生成单行输出，包含一个由四个双元素列表组成的列表，每个内部列表是案例 1-4 的迭代次数对 [一致性, 弹性]，例如 \"[[c1,e1],[c2,e2],[c3,e3],[c4,e4]]\"。",
            "solution": "此问题要求推导和实现带有线性各向同性硬化的 $J_2$ 塑性的径向返回映射算法、其一致性切线模量，并在一个全局 Newton-Raphson 格式中评估其数值性能。解答按要求分为三部分：应力更新的推导、一致性切线的推导，以及数值实现的描述。\n\n### 1. 径向返回映射的推导\n\n目标是在给定总应变 $\\boldsymbol{\\varepsilon}_{n+1}$ 和上一步 $n$ 的状态变量（$\\boldsymbol{\\varepsilon}^p_n$, $\\varepsilon^{\\text{eq}}_{p,n}$）的情况下，求出时间步 $n+1$ 的应力状态 $\\boldsymbol{\\sigma}_{n+1}$ 和等效塑性应变 $\\varepsilon^{\\text{eq}}_{p,n+1}$。该模型基于总应变加法分解为弹性和塑性部分，即 $\\boldsymbol{\\varepsilon} = \\boldsymbol{\\varepsilon}^e + \\boldsymbol{\\varepsilon}^p$。\n\n**弹性预测**\n首先，我们假设整个应变增量是弹性的。试探应力状态使用线弹性理论计算。令 $\\Delta\\boldsymbol{\\varepsilon} = \\boldsymbol{\\varepsilon}_{n+1} - \\boldsymbol{\\varepsilon}_n$。试探应力 $\\boldsymbol{\\sigma}^{\\text{tr}}$ 由下式给出：\n$$\n\\boldsymbol{\\sigma}^{\\text{tr}} = \\mathbb{C}^e : (\\boldsymbol{\\varepsilon}_{n+1} - \\boldsymbol{\\varepsilon}^p_n)\n$$\n其中 $\\mathbb{C}^e$ 是四阶各向同性弹性刚度张量，$\\mathbb{C}^e_{ijkl} = \\lambda \\delta_{ij} \\delta_{kl} + \\mu (\\delta_{ik} \\delta_{jl} + \\delta_{il} \\delta_{jk})$。\n这可以分解为体积和偏量部分。由于塑性应变是不可压缩的（$\\text{tr}(\\boldsymbol{\\varepsilon}^p_n)=0$），试探静水应力为 $p^{\\text{tr}} = K \\text{tr}(\\boldsymbol{\\varepsilon}_{n+1} - \\boldsymbol{\\varepsilon}^p_n) = K \\text{tr}(\\boldsymbol{\\varepsilon}_{n+1})$。试探偏应力为：\n$$\n\\mathbf{s}^{\\text{tr}} = 2\\mu (\\boldsymbol{\\varepsilon}^{\\text{dev}}_{n+1} - \\boldsymbol{\\varepsilon}^{\\text{dev},p}_n)\n$$\n其中 $\\boldsymbol{\\varepsilon}^{\\text{dev},p}_n = \\boldsymbol{\\varepsilon}^p_n$。\n\n**屈服条件检查**\n将试探状态与屈服条件 $f(\\boldsymbol{\\sigma}, \\varepsilon^{\\text{eq}}_p) = q - \\sigma_y(\\varepsilon^{\\text{eq}}_p) \\le 0$ 进行核对。试探等效应力为 $q^{\\text{tr}} = \\sqrt{\\frac{3}{2}} \\|\\mathbf{s}^{\\text{tr}}\\|_2$。步初的屈服应力为 $\\sigma_y(\\varepsilon^{\\text{eq}}_{p,n})$。试探屈服函数值为：\n$$\nf^{\\text{tr}} = q^{\\text{tr}} - \\sigma_y(\\varepsilon^{\\text{eq}}_{p,n})\n$$\n如果 $f^{\\text{tr}} \\le 0$，则该步为弹性步。最终状态即为试探状态：$\\boldsymbol{\\sigma}_{n+1} = \\boldsymbol{\\sigma}^{\\text{tr}}$，$\\boldsymbol{\\varepsilon}^p_{n+1} = \\boldsymbol{\\varepsilon}^p_n$ 和 $\\varepsilon^{\\text{eq}}_{p,n+1} = \\varepsilon^{\\text{eq}}_{p,n}$。\n\n**塑性修正**\n如果 $f^{\\text{tr}}  0$，则发生塑性流动。状态必须被返回到屈服面上。应力-应变关系为 $\\boldsymbol{\\sigma}_{n+1} = \\mathbb{C}^e : (\\boldsymbol{\\varepsilon}_{n+1} - \\boldsymbol{\\varepsilon}^p_{n+1})$。定义塑性应变增量 $\\Delta\\boldsymbol{\\varepsilon}^p = \\boldsymbol{\\varepsilon}^p_{n+1} - \\boldsymbol{\\varepsilon}^p_n$，我们有：\n$$\n\\boldsymbol{\\sigma}_{n+1} = \\boldsymbol{\\sigma}^{\\text{tr}} - \\mathbb{C}^e : \\Delta\\boldsymbol{\\varepsilon}^p\n$$\n相关联流动法则表明，塑性应变增量垂直于屈服面：\n$$\n\\Delta\\boldsymbol{\\varepsilon}^p = \\Delta\\gamma \\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}_{n+1}} = \\Delta\\gamma \\frac{\\partial q}{\\partial \\boldsymbol{\\sigma}_{n+1}} = \\Delta\\gamma \\frac{3}{2q_{n+1}} \\mathbf{s}_{n+1}\n$$\n其中 $\\Delta\\gamma \\ge 0$ 是一致性参数或塑性乘子。由于 $\\Delta\\boldsymbol{\\varepsilon}^p$ 是纯偏量的，应力更新简化为：\n$$\n\\mathbf{s}_{n+1} = \\mathbf{s}^{\\text{tr}} - 2\\mu \\Delta\\boldsymbol{\\varepsilon}^p \\quad \\text{和} \\quad \\frac{1}{3}\\text{tr}(\\boldsymbol{\\sigma}_{n+1}) = \\frac{1}{3}\\text{tr}(\\boldsymbol{\\sigma}^{\\text{tr}})\n$$\n将流动法则代入偏应力更新意味着 $\\mathbf{s}_{n+1}$ 和 $\\mathbf{s}^{\\text{tr}}$ 是共轴的。因此，流动方向由试探状态确定：$\\mathbf{n}_{n+1} = \\frac{\\mathbf{s}_{n+1}}{\\|\\mathbf{s}_{n+1}\\|_2} = \\frac{\\mathbf{s}^{\\text{tr}}}{\\|\\mathbf{s}^{\\text{tr}}\\|_2} = \\mathbf{n}^{\\text{tr}}$。流动法则可写为 $\\Delta\\boldsymbol{\\varepsilon}^p = \\Delta\\gamma \\sqrt{\\frac{3}{2}}\\mathbf{n}^{\\text{tr}}$。\n等效塑性应变的增量为 $\\Delta\\varepsilon^{\\text{eq}}_p = \\sqrt{\\frac{2}{3}} \\|\\Delta\\boldsymbol{\\varepsilon}^p\\|_2 = \\Delta\\gamma$。\n将偏应力更新投影到方向 $\\mathbf{n}^{\\text{tr}}$ 上得到：\n$$\n\\|\\mathbf{s}_{n+1}\\|_2 = \\|\\mathbf{s}^{\\text{tr}}\\|_2 - 2\\mu \\|\\Delta\\boldsymbol{\\varepsilon}^p\\|_2 \\implies q_{n+1} = q^{\\text{tr}} - 3\\mu \\Delta\\gamma\n$$\n这就是径向返回方程，表明试探偏应力的量值被减小了。$n+1$ 步的状态必须满足一致性条件 $f_{n+1}=0$：\n$$\nq_{n+1} = \\sigma_y(\\varepsilon^{\\text{eq}}_{p,n+1}) = \\sigma_y(\\varepsilon^{\\text{eq}}_{p,n} + \\Delta\\varepsilon^{\\text{eq}}_p) = \\sigma_y(\\varepsilon^{\\text{eq}}_{p,n}) + H\\Delta\\gamma\n$$\n现在我们有一个关于未知数 $\\Delta\\gamma$ 和 $q_{n+1}$ 的两个方程组成的方程组。求解 $\\Delta\\gamma$：\n$$\nq^{\\text{tr}} - 3\\mu \\Delta\\gamma = \\sigma_y(\\varepsilon^{\\text{eq}}_{p,n}) + H\\Delta\\gamma \\implies \\Delta\\gamma = \\frac{q^{\\text{tr}} - \\sigma_y(\\varepsilon^{\\text{eq}}_{p,n})}{3\\mu + H} = \\frac{f^{\\text{tr}}}{3\\mu + H}\n$$\n$\\Delta\\gamma$ 已知后，更新内变量和应力。\n\n**最终更新公式**\n- 如果 $f^{\\text{tr}} \\le 0$ (弹性):\n  $$ \\boldsymbol{\\sigma}_{n+1} = \\boldsymbol{\\sigma}^{\\text{tr}}, \\quad \\varepsilon^{\\text{eq}}_{p,n+1} = \\varepsilon^{\\text{eq}}_{p,n} $$\n- 如果 $f^{\\text{tr}}  0$ (塑性):\n  - 塑性乘子: $\\Delta\\gamma = \\dfrac{q^{\\text{tr}} - \\sigma_y(\\varepsilon^{\\text{eq}}_{p,n})}{3\\mu + H}$\n  - 等效塑性应变: $\\varepsilon^{\\text{eq}}_{p,n+1} = \\varepsilon^{\\text{eq}}_{p,n} + \\Delta\\gamma$\n  - 应力张量:\n    $$ \\boldsymbol{\\sigma}_{n+1} = \\frac{1}{3}\\text{tr}(\\boldsymbol{\\sigma}^{\\text{tr}})\\mathbf{I} + \\left(1 - \\frac{3\\mu\\Delta\\gamma}{q^{\\text{tr}}}\\right)\\mathbf{s}^{\\text{tr}} $$\n    项 $1 - \\frac{3\\mu\\Delta\\gamma}{q^{\\text{tr}}}$ 是将应力返回到更新后屈服面的缩放因子，等于 $\\frac{q_{n+1}}{q^{\\text{tr}}}$。\n\n### 2. 算法一致性切线模量的推导\n\n算法切线模量 $\\mathbb{C}_{\\text{alg}}$ 是应力更新算法的精确线性化，$\\mathbb{C}_{\\text{alg}} = \\frac{\\partial \\boldsymbol{\\sigma}_{n+1}}{\\partial \\boldsymbol{\\varepsilon}_{n+1}}$。对于弹性步，$\\mathbb{C}_{\\text{alg}} = \\mathbb{C}^e$。对于塑性步，我们对更新表达式进行微分。\n$$\n\\boldsymbol{\\sigma}_{n+1} = K\\,\\text{tr}(\\boldsymbol{\\varepsilon}_{n+1})\\mathbf{I} + \\beta \\mathbf{s}^{\\text{tr}}, \\quad \\text{其中} \\quad \\beta = \\frac{q_{n+1}}{q^{\\text{tr}}} = 1 - \\frac{3\\mu\\Delta\\gamma}{q^{\\text{tr}}}\n$$\n微分式为 $d\\boldsymbol{\\sigma}_{n+1} = K\\,\\text{tr}(d\\boldsymbol{\\varepsilon}_{n+1})\\mathbf{I} + d(\\beta \\mathbf{s}^{\\text{tr}})$。使用乘法法则：\n$$\nd\\boldsymbol{\\sigma}_{n+1} = K\\,\\mathbf{I}\\otimes\\mathbf{I}:d\\boldsymbol{\\varepsilon}_{n+1} + \\mathbf{s}^{\\text{tr}} \\otimes d\\beta + \\beta d\\mathbf{s}^{\\text{tr}}\n$$\n我们需要 $d\\mathbf{s}^{\\text{tr}}$ 和 $d\\beta$ 的表达式。\n$d\\mathbf{s}^{\\text{tr}} = 2\\mu\\,d\\boldsymbol{\\varepsilon}^{\\text{dev}}_{n+1} = 2\\mu \\mathbb{P}_{\\text{dev}} : d\\boldsymbol{\\varepsilon}_{n+1}$，其中 $\\mathbb{P}_{\\text{dev}}$ 是四阶偏量投影张量。\n为求 $d\\beta$，我们将 $\\beta$ 写成 $q^{\\text{tr}}$ 的函数：\n$$\n\\beta = \\frac{q_{n+1}}{q^{\\text{tr}}} = \\frac{1}{q^{\\text{tr}}} \\left( \\sigma_y(\\varepsilon^{\\text{eq}}_{p,n}) + H\\Delta\\gamma \\right) = \\frac{\\sigma_y(\\varepsilon^{\\text{eq}}_{p,n})}{q^{\\text{tr}}} + \\frac{H}{q^{\\text{tr}}} \\frac{q^{\\text{tr}}-\\sigma_y(\\varepsilon^{\\text{eq}}_{p,n})}{3\\mu+H} = \\frac{3\\mu \\frac{\\sigma_y(\\varepsilon^{\\text{eq}}_{p,n})}{q^{\\text{tr}}} + H}{3\\mu+H}\n$$\n对 $\\beta$ 关于 $\\boldsymbol{\\varepsilon}_{n+1}$ 求导等价于对 $q^{\\text{tr}}$ 求导，并使用链式法则。$\\frac{\\partial \\beta}{\\partial \\boldsymbol{\\varepsilon}_{n+1}} = \\frac{d\\beta}{dq^{\\text{tr}}} \\frac{\\partial q^{\\text{tr}}}{\\partial \\boldsymbol{\\varepsilon}_{n+1}}$。\n$$\n\\frac{d\\beta}{dq^{\\text{tr}}} = \\frac{d}{dq^{\\text{tr}}}\\left(\\frac{q_{n+1}}{q^{\\text{tr}}}\\right) = \\frac{1}{(q^{\\text{tr}})^2} \\left( \\frac{dq_{n+1}}{dq^{\\text{tr}}}q^{\\text{tr}} - q_{n+1} \\right)\n$$\n由 $q_{n+1} = \\frac{H q^{\\text{tr}} + 3\\mu\\sigma_y(\\varepsilon^{\\text{eq}}_{p,n})}{3\\mu+H}$，我们得到 $\\frac{dq_{n+1}}{dq^{\\text{tr}}} = \\frac{H}{3\\mu+H}$。\n$$\n\\frac{d\\beta}{dq^{\\text{tr}}} = \\frac{1}{q^{\\text{tr}}} \\left(\\frac{H}{3\\mu+H} - \\frac{q_{n+1}}{q^{\\text{tr}}}\\right) = \\frac{1}{q^{\\text{tr}}}\\left(\\frac{H}{3\\mu+H} - \\beta\\right)\n$$\n试探等效应力的导数为 $\\frac{\\partial q^{\\text{tr}}}{\\partial \\boldsymbol{\\varepsilon}_{n+1}} = \\sqrt{6}\\mu \\mathbf{n}^{\\text{tr}}$。\n结合这些， $d\\beta = \\frac{1}{q^{\\text{tr}}}\\left(\\frac{H}{3\\mu+H} - \\beta\\right) (\\sqrt{6}\\mu \\mathbf{n}^{\\text{tr}}:d\\boldsymbol{\\varepsilon}_{n+1})$。\n项 $\\mathbf{s}^{\\text{tr}} \\otimes d\\beta$ 变为：\n$$\n\\mathbf{s}^{\\text{tr}} \\otimes \\frac{\\partial \\beta}{\\partial \\boldsymbol{\\varepsilon}_{n+1}} = (\\sqrt{2/3}q^{\\text{tr}}\\mathbf{n}^{\\text{tr}}) \\otimes \\left( \\frac{1}{q^{\\text{tr}}}\\left(\\frac{H}{3\\mu+H} - \\beta\\right) \\sqrt{6}\\mu \\mathbf{n}^{\\text{tr}} \\right) = 2\\mu\\left(\\frac{H}{3\\mu+H} - \\beta\\right) \\mathbf{n}^{\\text{tr}}\\otimes\\mathbf{n}^{\\text{tr}}\n$$\n将所有部分代入 $d\\boldsymbol{\\sigma}_{n+1}$ 的表达式：\n$$\nd\\boldsymbol{\\sigma}_{n+1} = \\left[ K\\mathbf{I}\\otimes\\mathbf{I} + 2\\mu\\beta\\mathbb{P}_{\\text{dev}} + 2\\mu\\left(\\frac{H}{3\\mu+H} - \\beta\\right)\\mathbf{n}^{\\text{tr}}\\otimes\\mathbf{n}^{\\text{tr}} \\right] : d\\boldsymbol{\\varepsilon}_{n+1}\n$$\n方括号中的项即为算法切线模量 $\\mathbb{C}_{\\text{alg}}$。它清晰地分为体积部分 ($K\\mathbf{I}\\otimes\\mathbf{I}$) 和偏量部分。\n- 体积部分: $\\mathbb{C}_{\\text{vol}} = K\\,\\mathbf{I}\\otimes\\mathbf{I}$\n- 偏量部分: $\\mathbb{C}_{\\text{dev}} = 2\\mu\\beta\\mathbb{P}_{\\text{dev}} + 2\\mu\\left(\\frac{H}{3\\mu+H} - \\beta\\right)\\mathbf{n}^{\\text{tr}}\\otimes\\mathbf{n}^{\\text{tr}}$\n其中 $\\beta = q_{n+1}/q^{\\text{tr}}$。\n\n### 3. 数值实验实现\n\n该实验涉及求解非线性标量方程 $R(u) = A\\,\\sigma_{11}(\\varepsilon(u)) - F = 0$ 以得到位移 $u$，其中 $\\varepsilon(u) = u/L$。由于 $A=1\\,\\text{m}^2$ 且 $L=1\\,\\text{m}$，这简化为 $R(u) = \\sigma_{11}(u) - F = 0$。Newton-Raphson 更新为 $u_{k+1} = u_k - R(u_k)/K_T$，其中 $K_T = dR/du = d\\sigma_{11}/d\\varepsilon$。\n\n单轴应变状态为 $\\boldsymbol{\\varepsilon} = \\text{diag}(\\varepsilon, 0, 0)$。对于此路径，所需的切线分量 $d\\sigma_{11}/d\\varepsilon$ 是 $\\mathbb{C}_{\\text{alg}}$ 的 $(1,1,1,1)$ 分量。\n- 如果该步为弹性，则 $d\\sigma_{11}/d\\varepsilon = \\mathbb{C}^e_{1111} = \\lambda + 2\\mu = M$，即单轴应变模量。\n- 如果该步为塑性，我们计算 $\\mathbb{C}_{\\text{alg},1111}$。所需的张量分量为：\n  - $(\\mathbf{I}\\otimes\\mathbf{I})_{1111} = 1$\n  - $\\mathbb{P}_{\\text{dev},1111} = 2/3$\n  - 对于单轴应变 $\\varepsilon$，$\\mathbf{n}^{\\text{tr}} = \\frac{\\text{sgn}(\\varepsilon)}{\\sqrt{6}}\\text{diag}(2,-1,-1)$，所以 $(\\mathbf{n}^{\\text{tr}}\\otimes\\mathbf{n}^{\\text{tr}})_{1111} = n^{\\text{tr}}_{11}n^{\\text{tr}}_{11} = (2/\\sqrt{6})^2 = 2/3$。\n将这些代入 $\\mathbb{C}_{\\text{alg}}$ 的表达式：\n$$\n\\frac{d\\sigma_{11}}{d\\varepsilon} = K\\cdot 1 + 2\\mu\\beta(\\frac{2}{3}) + 2\\mu\\left(\\frac{H}{3\\mu+H} - \\beta\\right)(\\frac{2}{3}) = K + \\frac{4}{3}\\mu\\beta + \\frac{4}{3}\\mu\\frac{H}{3\\mu+H} - \\frac{4}{3}\\mu\\beta = K + \\frac{4\\mu H}{3(3\\mu+H)}\n$$\n这是单轴应变的塑性切线模量 $M_p$。\n\n实现了两种牛顿法：\n1.  **一致性切线法**：对弹性步使用 $K_T = M$，对塑性步使用 $K_T = M_p$。这能提供二次收敛。\n2.  **弹性切线法**：始终使用 $K_T = M$。预计此方法在塑性区内收敛较慢，为线性收敛。\n\n实现包含一个主循环，遍历所有测试案例。对每个案例，执行两个牛顿求解器循环，每种切线类型各一个。应力更新逻辑，包括径向返回以及 $\\sigma_{11}$ 和相应切线 $d\\sigma_{11}/d\\varepsilon$ 的计算，被封装在一个辅助函数中。记录每种方法的迭代次数，并格式化为要求的输出。",
            "answer": "```python\nimport numpy as np\n\ndef stress_update(eps, E, v, sigy0, H):\n    \"\"\"\n    Performs a radial return stress update for J2 plasticity under uniaxial strain.\n\n    Args:\n        eps (float): Axial strain component (epsilon_11).\n        E (float): Young's modulus.\n        v (float): Poisson's ratio.\n        sigy0 (float): Initial yield stress.\n        H (float): Linear hardening modulus.\n\n    Returns:\n        tuple: A tuple containing:\n            - sig11 (float): Updated axial stress component (sigma_11).\n            - tangent (float): Algorithmic consistent tangent d(sigma_11)/d(epsilon).\n    \"\"\"\n    # Material properties\n    # Use float conversions to avoid potential integer division issues.\n    E, v, sigy0, H = float(E), float(v), float(sigy0), float(H)\n    \n    # Check for valid Poisson's ratio to prevent division by zero\n    if abs(1.0 - 2.0 * v)  1e-12 or abs(1.0 + v)  1e-12:\n        # For perfectly incompressible case, use large K but avoid inf\n        K = E / (3.0 * (1.0 - 2.0 * 0.49999999))\n    else:\n        K = E / (3.0 * (1.0 - 2.0 * v))\n    \n    mu = E / (2.0 * (1.0 + v))\n    M = K + 4.0 / 3.0 * mu  # Uniaxial elastic modulus\n\n    # Elastic predictor step for uniaxial strain\n    # Strain tensor is diag(eps, 0, 0)\n    # Trial deviatoric stress s_tr = 2*mu*eps_dev\n    # eps_dev = diag(2/3*eps, -1/3*eps, -1/3*eps)\n    # q_tr = sqrt(3/2 * s_tr:s_tr) = 2*mu*|eps|\n    q_tr = 2.0 * mu * np.abs(eps)\n\n    # Yield criterion check (using state at step n, which is zero)\n    f_tr = q_tr - sigy0\n\n    if f_tr = 0:\n        # Elastic response\n        sig11 = M * eps\n        tangent = M\n    else:\n        # Plastic response\n        # Consistency parameter (plastic multiplier increment)\n        delta_gamma = f_tr / (3.0 * mu + H)\n\n        # Updated stress sigma_11\n        # s_11 = s_tr_11 * (q_n+1 / q_tr)\n        # q_n+1 = sigy0 + H * delta_gamma\n        # s_tr_11 = 2*mu*(2/3*eps) = 4/3*mu*eps\n        # sigma_11 = K * tr(eps) + s_11 = K*eps + s_11\n        # s_11 = (4/3*mu*eps) * ((sigy0 + H*delta_gamma) / (2*mu*|eps|))\n        # s_11 = sign(eps) * 2/3 * (sigy0 + H*delta_gamma)\n        sig11 = K * eps + np.sign(eps) * (2.0 / 3.0) * (sigy0 + H * delta_gamma)\n\n        # Algorithmic consistent tangent for uniaxial strain\n        # C_1111 = K + (4*mu*H) / (3*(3*mu+H))\n        tangent = K + (4.0 * mu * H) / (3.0 * (3.0 * mu + H))\n        \n    return sig11, tangent\n\ndef run_newton_solver(F, E, v, sigy0, H, use_consistent_tangent):\n    \"\"\"\n    Solves the 1D global problem R(u)=0 using Newton's method.\n\n    Args:\n        F (float): Applied force.\n        E, v, sigy0, H (float): Material parameters.\n        use_consistent_tangent (bool): Flag to choose tangent stiffness.\n\n    Returns:\n        int: Number of iterations required for convergence.\n    \"\"\"\n    A = 1.0  # Area\n    L = 1.0  # Length\n    tol = 1.0e-10\n    max_iter = 50\n\n    # Material properties and elastic moduli\n    E, v, F = float(E), float(v), float(F)\n    if abs(1.0 - 2.0 * v)  1e-12 or abs(1.0 + v)  1e-12:\n        K = E / (3.0 * (1.0 - 2.0 * 0.49999999))\n    else:\n        K = E / (3.0 * (1.0 - 2.0 * v))\n        \n    mu = E / (2.0 * (1.0 + v))\n    M = K + 4.0 / 3.0 * mu\n\n    # Initial guess from linear elastic solution\n    u = (F * L) / (A * M)\n    \n    iterations = 0\n    \n    for i in range(max_iter + 1):\n        eps = u / L\n        sig11, consistent_tangent = stress_update(eps, E, v, sigy0, H)\n        \n        # Global residual\n        R = A * sig11 - F\n        \n        # Convergence check\n        if np.abs(R) = tol * max(1.0, np.abs(F)):\n            return iterations\n        \n        if i == max_iter:\n            break\n            \n        # Global tangent stiffness\n        if use_consistent_tangent:\n            KT = A * consistent_tangent / L\n        else: # Use elastic tangent\n            KT = A * M / L\n        \n        # Newton update\n        u = u - R / KT\n        iterations += 1\n\n    return iterations # Should be max_iter if loop finished without convergence\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    test_cases = [\n        # Case 1 (elastic, moderate compressibility)\n        {'E': 210e9, 'v': 0.3, 'sigy0': 250e6, 'H': 1e9, 'F': 349600000},\n        # Case 2 (perfect plasticity, moderate compressibility)\n        {'E': 210e9, 'v': 0.3, 'sigy0': 250e6, 'H': 0.0, 'F': 524400000},\n        # Case 3 (plastic, nearly incompressible)\n        {'E': 210e9, 'v': 0.4999, 'sigy0': 250e6, 'H': 1e9, 'F': 750000000000},\n        # Case 4 (perfect plasticity, nearly incompressible)\n        {'E': 210e9, 'v': 0.4999, 'sigy0': 250e6, 'H': 0.0, 'F': 750000000000},\n    ]\n\n    all_results = []\n    for params in test_cases:\n        # Run with consistent tangent\n        iters_consistent = run_newton_solver(**params, use_consistent_tangent=True)\n        # Run with elastic tangent\n        iters_elastic = run_newton_solver(**params, use_consistent_tangent=False)\n        all_results.append([iters_consistent, iters_elastic])\n\n    print(f\"{all_results}\")\n\nsolve()\n```"
        }
    ]
}