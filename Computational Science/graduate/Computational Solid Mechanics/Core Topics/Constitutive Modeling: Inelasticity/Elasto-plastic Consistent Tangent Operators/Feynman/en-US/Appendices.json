{
    "hands_on_practices": [
        {
            "introduction": "The term 'consistent' in 'consistent tangent operator' is precise: it means the tangent is the exact linearization of the discrete numerical algorithm used for the stress update. This exercise provides a direct look into this concept by deriving the tangent for a simple 1D case, not from continuum mechanics alone, but from the algebraic structure of the backward Euler return-mapping algorithm itself . By setting up and linearizing the local system of residual equations, you will see exactly how the algorithmic tangent emerges, ensuring the quadratic convergence of a Newton-Raphson scheme.",
            "id": "2694635",
            "problem": "Consider small-strain associative elastoplasticity of an isotropic metal with a von Mises yield function and linear isotropic hardening. The elastic behavior is linear with Young’s modulus $E$, the yield stress is $\\sigma_{y0}$ at zero plastic strain, and the hardening modulus is $H \\ge 0$. Let the scalar internal variable be the accumulated equivalent plastic strain $\\kappa$, and let the yield function be $f(\\boldsymbol{\\sigma},\\kappa) = \\sigma_{\\mathrm{eq}}(\\boldsymbol{\\sigma}) - \\sigma_{y0} - H \\kappa$, where $\\sigma_{\\mathrm{eq}}$ is the von Mises equivalent stress. Use the backward Euler time discretization from time $t_n$ to $t_{n+1}$.\n\nFocus on a uniaxial, monotonically tensile loading path so that $\\sigma_{n+1} > 0$ and $\\sigma_{\\mathrm{eq}}(\\boldsymbol{\\sigma}_{n+1}) = \\sigma_{n+1}$. The additive strain decomposition and associative flow rule imply the return-mapping structure with two local unknowns at $t_{n+1}$: the Cauchy stress $\\sigma_{n+1}$ and the plastic multiplier increment $\\Delta\\gamma_{n+1}$. The consistency condition enforces $f(\\boldsymbol{\\sigma}_{n+1},\\kappa_{n+1}) = 0$. In the backward Euler discretization, the accumulated equivalent plastic strain increments as $\\kappa_{n+1} = \\kappa_n + \\Delta\\gamma_{n+1}$.\n\nStarting only from these principles and the above definitions (do not invoke any pre-memorized algorithmic tangent formulas), perform the following.\n\n1. Write the two scalar local residual equations at $t_{n+1}$ for the unknowns $\\sigma_{n+1}$ and $\\Delta\\gamma_{n+1}$ that encode (i) the stress update by linear elasticity and (ii) the consistency condition. Clearly indicate the dependence of the residuals on $\\sigma_{n+1}$, $\\Delta\\gamma_{n+1}$, and the total strain $\\varepsilon_{n+1}$ through the elastic trial stress $\\sigma_{\\mathrm{tr}} = E(\\varepsilon_{n+1} - \\varepsilon_n^{p})$, where $\\varepsilon_n^{p}$ is known from the previous step.\n\n2. Linearize the residuals to obtain the local Jacobian with respect to the unknowns $\\sigma_{n+1}$ and $\\Delta\\gamma_{n+1}$, and the right-hand-side dependence on an incremental perturbation $d\\varepsilon_{n+1}$ of the total strain.\n\n3. Using the Schur complement of the local Jacobian, eliminate $d(\\Delta\\gamma_{n+1})$ and derive the consistent (algorithmic) tangent modulus $E_{\\mathrm{alg}} = \\dfrac{d\\sigma_{n+1}}{d\\varepsilon_{n+1}}$ that would be assembled in a Finite Element Method (FEM) global Newton iteration. Express your final answer as a single closed-form analytic expression in terms of $E$ and $H$ only.\n\nYour final answer must be a single analytic expression. Do not include units in the final answer box. Do not provide an inequality or an equation as the final answer.",
            "solution": "The problem statement is examined and found to be valid. It is scientifically grounded, well-posed, objective, and internally consistent. It poses a standard, non-trivial problem in computational solid mechanics. We may therefore proceed with the derivation.\n\nThe problem requires the derivation of the consistent (algorithmic) tangent modulus for a one-dimensional case of elastoplasticity under monotonic tensile loading. The derivation will be executed in three steps as specified.\n\nStep 1: Formulation of the Local Residual Equations\n\nThe mechanical behavior is governed by a set of fundamental equations applied at time $t_{n+1}$. For the specified one-dimensional problem, stress $\\sigma$, strain $\\varepsilon$, and their plastic components are scalar quantities.\n\nThe total strain is decomposed additively into elastic and plastic parts:\n$$\n\\varepsilon_{n+1} = \\varepsilon_{n+1}^{e} + \\varepsilon_{n+1}^{p}\n$$\nThe elastic behavior follows Hooke's law:\n$$\n\\sigma_{n+1} = E \\varepsilon_{n+1}^{e}\n$$\nCombining these, we express the stress in terms of total and plastic strains:\n$$\n\\sigma_{n+1} = E (\\varepsilon_{n+1} - \\varepsilon_{n+1}^{p})\n$$\nThe associative flow rule dictates the evolution of plastic strain. For a von Mises yield function under uniaxial tension ($\\sigma > 0$), the equivalent stress $\\sigma_{\\mathrm{eq}}$ is simply the axial stress $\\sigma$. The yield function is $f(\\sigma, \\kappa) = \\sigma - (\\sigma_{y0} + H\\kappa)$. The flow direction is given by $\\frac{\\partial f}{\\partial \\sigma} = 1$. The evolution of plastic strain is thus:\n$$\n\\dot{\\varepsilon}^{p} = \\dot{\\gamma} \\frac{\\partial f}{\\partial \\sigma} = \\dot{\\gamma} \\cdot 1 = \\dot{\\gamma}\n$$\nwhere $\\dot{\\gamma}$ is the rate of the plastic multiplier. We apply the backward Euler method to integrate this rate equation over the time step $[t_n, t_{n+1}]$:\n$$\n\\varepsilon_{n+1}^{p} - \\varepsilon_{n}^{p} = \\Delta\\gamma_{n+1}\n$$\nwhere $\\Delta\\gamma_{n+1}$ is the increment of the plastic multiplier over the step. Substituting this into the stress equation gives:\n$$\n\\sigma_{n+1} = E (\\varepsilon_{n+1} - (\\varepsilon_{n}^{p} + \\Delta\\gamma_{n+1})) = E (\\varepsilon_{n+1} - \\varepsilon_{n}^{p}) - E \\Delta\\gamma_{n+1}\n$$\nWe identify the elastic trial stress $\\sigma_{\\mathrm{tr}}$ as defined in the problem, $\\sigma_{\\mathrm{tr}} = E(\\varepsilon_{n+1} - \\varepsilon_n^{p})$. The equation becomes:\n$$\n\\sigma_{n+1} = \\sigma_{\\mathrm{tr}} - E \\Delta\\gamma_{n+1}\n$$\nThis provides our first residual equation, $R_1$, which must be zero for the local unknowns $\\sigma_{n+1}$ and $\\Delta\\gamma_{n+1}$ to be a solution:\n$$\nR_1(\\sigma_{n+1}, \\Delta\\gamma_{n+1}) = \\sigma_{n+1} + E \\Delta\\gamma_{n+1} - \\sigma_{\\mathrm{tr}} = 0\n$$\nThe second equation comes from the Karush-Kuhn-Tucker (KKT) consistency condition, which states that for plastic flow to occur ($\\Delta\\gamma_{n+1} > 0$), the stress state must lie on the yield surface at the end of the step:\n$$\nf(\\boldsymbol{\\sigma}_{n+1}, \\kappa_{n+1}) = 0\n$$\nThe problem states that the accumulated equivalent plastic strain $\\kappa$ is updated as $\\kappa_{n+1} = \\kappa_n + \\Delta\\gamma_{n+1}$. The yield function is $f(\\boldsymbol{\\sigma}, \\kappa) = \\sigma_{\\mathrm{eq}}(\\boldsymbol{\\sigma}) - \\sigma_{y0} - H\\kappa$. For uniaxial tension, this simplifies to:\n$$\n\\sigma_{n+1} - \\sigma_{y0} - H(\\kappa_n + \\Delta\\gamma_{n+1}) = 0\n$$\nThis gives the second residual equation, $R_2$:\n$$\nR_2(\\sigma_{n+1}, \\Delta\\gamma_{n+1}) = \\sigma_{n+1} - H \\Delta\\gamma_{n+1} - (\\sigma_{y0} + H\\kappa_n) = 0\n$$\nThe two scalar residual equations for the unknowns $\\sigma_{n+1}$ and $\\Delta\\gamma_{n+1}$ are thus:\n$$\n\\begin{cases}\nR_1 = \\sigma_{n+1} + E \\Delta\\gamma_{n+1} - \\sigma_{\\mathrm{tr}} = 0 \\\\\nR_2 = \\sigma_{n+1} - H \\Delta\\gamma_{n+1} - \\sigma_{y,n} = 0\n\\end{cases}\n$$\nwhere $\\sigma_{y,n} = \\sigma_{y0} + H\\kappa_n$ is the yield stress at the beginning of the step.\n\nStep 2: Linearization of the Residuals\n\nTo find the consistent tangent modulus, we must linearize the system of residual equations. This is achieved by taking the total differential of each residual with respect to the unknowns $(\\sigma_{n+1}, \\Delta\\gamma_{n+1})$ and the driving variable, the total strain $\\varepsilon_{n+1}$.\nThe linearization takes the form of a first-order Taylor expansion around the solution at $t_{n+1}$, which sets the total variation to zero:\n$$\nd\\mathbf{R} = \\frac{\\partial \\mathbf{R}}{\\partial \\mathbf{x}} d\\mathbf{x} + \\frac{\\partial \\mathbf{R}}{\\partial \\varepsilon_{n+1}} d\\varepsilon_{n+1} = \\mathbf{0}\n$$\nwhere $\\mathbf{R} = \\begin{pmatrix} R_1 \\\\ R_2 \\end{pmatrix}$ and $\\mathbf{x} = \\begin{pmatrix} \\sigma_{n+1} \\\\ \\Delta\\gamma_{n+1} \\end{pmatrix}$. This can be rewritten as:\n$$\n\\mathbf{J} \\begin{pmatrix} d\\sigma_{n+1} \\\\ d(\\Delta\\gamma_{n+1}) \\end{pmatrix} = -\\begin{pmatrix} \\frac{\\partial R_1}{\\partial \\varepsilon_{n+1}} \\\\ \\frac{\\partial R_2}{\\partial \\varepsilon_{n+1}} \\end{pmatrix} d\\varepsilon_{n+1}\n$$\nwhere $\\mathbf{J}$ is the local Jacobian matrix. We compute the required partial derivatives:\nFrom $R_1 = \\sigma_{n+1} + E \\Delta\\gamma_{n+1} - E(\\varepsilon_{n+1} - \\varepsilon_n^p)$:\n$$\n\\frac{\\partial R_1}{\\partial \\sigma_{n+1}} = 1, \\quad \\frac{\\partial R_1}{\\partial \\Delta\\gamma_{n+1}} = E, \\quad \\frac{\\partial R_1}{\\partial \\varepsilon_{n+1}} = -E\n$$\nFrom $R_2 = \\sigma_{n+1} - H \\Delta\\gamma_{n+1} - (\\sigma_{y0} + H\\kappa_n)$:\n$$\n\\frac{\\partial R_2}{\\partial \\sigma_{n+1}} = 1, \\quad \\frac{\\partial R_2}{\\partial \\Delta\\gamma_{n+1}} = -H, \\quad \\frac{\\partial R_2}{\\partial \\varepsilon_{n+1}} = 0\n$$\nThe Jacobian matrix $\\mathbf{J}$ is:\n$$\n\\mathbf{J} =\n\\begin{pmatrix}\n\\frac{\\partial R_1}{\\partial \\sigma_{n+1}} & \\frac{\\partial R_1}{\\partial \\Delta\\gamma_{n+1}} \\\\\n\\frac{\\partial R_2}{\\partial \\sigma_{n+1}} & \\frac{\\partial R_2}{\\partial \\Delta\\gamma_{n+1}}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n1 & E \\\\\n1 & -H\n\\end{pmatrix}\n$$\nThe right-hand side vector is:\n$$\n-\\begin{pmatrix} \\frac{\\partial R_1}{\\partial \\varepsilon_{n+1}} \\\\ \\frac{\\partial R_2}{\\partial \\varepsilon_{n+1}} \\end{pmatrix} d\\varepsilon_{n+1} = -\\begin{pmatrix} -E \\\\ 0 \\end{pmatrix} d\\varepsilon_{n+1} = \\begin{pmatrix} E \\\\ 0 \\end{pmatrix} d\\varepsilon_{n+1}\n$$\nThe complete linearized system is:\n$$\n\\begin{pmatrix}\n1 & E \\\\\n1 & -H\n\\end{pmatrix}\n\\begin{pmatrix}\nd\\sigma_{n+1} \\\\\nd(\\Delta\\gamma_{n+1})\n\\end{pmatrix}\n=\n\\begin{pmatrix}\nE \\\\\n0\n\\end{pmatrix}\nd\\varepsilon_{n+1}\n$$\n\nStep 3: Derivation of the Consistent Tangent Modulus\n\nThe consistent tangent modulus $E_{\\mathrm{alg}}$ is defined as the rate of change of stress with respect to total strain, $E_{\\mathrm{alg}} = \\frac{d\\sigma_{n+1}}{d\\varepsilon_{n+1}}$. This requires eliminating the internal variable increment $d(\\Delta\\gamma_{n+1})$ from the linearized system. This procedure is an application of the Schur complement.\n\nFrom the second row of the linearized system:\n$$\n1 \\cdot d\\sigma_{n+1} - H \\cdot d(\\Delta\\gamma_{n+1}) = 0\n$$\nThis allows us to express $d(\\Delta\\gamma_{n+1})$ in terms of $d\\sigma_{n+1}$ (for $H > 0$):\n$$\nd(\\Delta\\gamma_{n+1}) = \\frac{1}{H} d\\sigma_{n+1}\n$$\nWe substitute this expression into the first row of the linearized system:\n$$\n1 \\cdot d\\sigma_{n+1} + E \\left( \\frac{1}{H} d\\sigma_{n+1} \\right) = E \\cdot d\\varepsilon_{n+1}\n$$\nFactoring out $d\\sigma_{n+1}$:\n$$\nd\\sigma_{n+1} \\left( 1 + \\frac{E}{H} \\right) = E \\cdot d\\varepsilon_{n+1}\n$$\nThe desired tangent modulus is the ratio $\\frac{d\\sigma_{n+1}}{d\\varepsilon_{n+1}}$:\n$$\nE_{\\mathrm{alg}} = \\frac{d\\sigma_{n+1}}{d\\varepsilon_{n+1}} = \\frac{E}{1 + \\frac{E}{H}}\n$$\nSimplifying this expression yields the final form:\n$$\nE_{\\mathrm{alg}} = \\frac{E}{\\frac{H+E}{H}} = \\frac{EH}{E+H}\n$$\nThis result is valid for $H \\ge 0$. In the case of perfect plasticity ($H=0$), the tangent modulus becomes $E_{\\mathrm{alg}} = 0$. In the elastic limit ($H \\to \\infty$), the tangent modulus correctly recovers the elastic modulus, $E_{\\mathrm{alg}} \\to E$. This is the consistent tangent modulus for the specified one-dimensional elastoplastic model with linear hardening.",
            "answer": "$$\\boxed{\\frac{EH}{E+H}}$$"
        },
        {
            "introduction": "A theoretical formula is only as good as its implementation. In computational mechanics, even a minor coding error in the tangent operator can degrade or destroy the quadratic convergence of Newton's method, leading to frustratingly slow or failed simulations. This hands-on programming exercise guides you through the essential practice of numerically verifying your consistent tangent implementation . By comparing the action of your assembled tangent matrix against a finite-difference perturbation of the global residual, you will build confidence in your code and master a technique used universally by FEM developers to debug complex material models.",
            "id": "3560905",
            "problem": "Design and implement a verification workflow for the algorithmic elastic-plastic consistent tangent operator in a one-dimensional small-strain bar using the Finite Element Method (FEM). The goal is to verify the assembly of the global tangent matrix by comparing the directional finite-difference of the global residual with the linear prediction from the assembled tangent. All quantities are nondimensional.\n\nConsider a one-dimensional bar of length $L$, uniform cross-sectional area $A$, and $n_{e}$ linear two-node elements with nodal coordinates $x \\in [0,L]$. Let $u$ denote the global nodal displacement vector. Impose a Dirichlet boundary condition $u(0)=0$ at the left end, and apply a prescribed traction $T$ at the right end so that the total nodal force at the last node is $F = T A$. For each element $e$, the internal force contribution is\n$$\nf^{\\text{int}}_{e}(u) \\;=\\; \\int_{\\Omega_e} B^{\\mathsf{T}}(x)\\, \\sigma(\\varepsilon(x))\\, A \\, \\mathrm{d}x,\n$$\nand the element tangent matrix is\n$$\nK^{\\text{tan}}_{e}(u) \\;=\\; \\int_{\\Omega_e} B^{\\mathsf{T}}(x)\\, \\mathbb{C}^{\\text{alg}}(\\varepsilon(x))\\, B(x)\\, A \\, \\mathrm{d}x,\n$$\nwhere $B$ is the strain-displacement matrix for a linear bar, $\\varepsilon(x)$ is the axial strain, $\\sigma$ is the Cauchy stress under small strain, and $\\mathbb{C}^{\\text{alg}}$ is the one-dimensional algorithmic consistent tangent modulus supplied by the constitutive update. For a linear two-node element of length $L_e$, $B$ is constant with $B=[-1/L_{e}, \\, 1/L_{e}]$, so the above integrals reduce to element-level closed forms with a single integration point:\n$$\nf^{\\text{int}}_{e}(u) \\;=\\; B^{\\mathsf{T}} \\, \\sigma(\\varepsilon_e) \\, A \\, L_e, \n\\qquad\nK^{\\text{tan}}_{e}(u) \\;=\\; B^{\\mathsf{T}} \\, \\mathbb{C}^{\\text{alg}}(\\varepsilon_e) \\, B \\, A \\, L_e,\n$$\nwith $\\varepsilon_e = B u_e$ for the element nodal vector $u_e$.\n\nUse a uniaxial elastoplastic material with linear isotropic hardening. Let $E$ be Young’s modulus, $H$ the plastic modulus, $\\sigma_{y0}$ the initial yield stress, $\\varepsilon^{p}$ the plastic strain, and $\\alpha$ the accumulated plastic strain. The yield function is\n$$\n\\phi(\\sigma,\\alpha) \\;=\\; |\\sigma| - \\big(\\sigma_{y0} + H \\alpha\\big) \\;\\le\\; 0.\n$$\nThe flow rule is associative in one dimension with plastic strain rate $\\dot{\\varepsilon}^{p} = \\dot{\\gamma}\\, \\mathrm{sign}(\\sigma)$ and isotropic hardening $\\dot{\\alpha} = \\dot{\\gamma}$, where $\\dot{\\gamma}\\ge 0$ is the plastic multiplier rate. Use small strain kinematics and the additive strain decomposition $\\varepsilon = \\varepsilon^{e} + \\varepsilon^{p}$ with $\\sigma = E \\varepsilon^{e}$. Assume a single load increment from the zero state $\\varepsilon^{p}_n=0$, $\\alpha_n=0$ to the current state. Implement a return-mapping update that, for a given strain $\\varepsilon$, returns the updated stress $\\sigma$ and the algorithmic consistent tangent modulus $\\mathbb{C}^{\\text{alg}} = \\partial \\sigma / \\partial \\varepsilon$.\n\nDefine the global residual as\n$$\nR(u) \\;=\\; f^{\\text{int}}(u) - f^{\\text{ext}},\n$$\nwhere $f^{\\text{ext}}$ contains only the applied right-end nodal force $F$ and zeros elsewhere. Let $K(u)$ be the assembled global tangent matrix. To verify $K(u)$, compute a central finite-difference approximation of the directional change of the residual in a given direction $p$ of the free degrees of freedom:\n$$\n\\Delta R_{\\text{FD}} \\;=\\; R\\big(u + \\epsilon\\, p\\big) - R\\big(u - \\epsilon\\, p\\big),\n$$\nand compare against the linear prediction\n$$\n\\Delta R_{\\text{lin}} \\;=\\; K(u)\\, (2 \\epsilon\\, p),\n$$\nfor a small perturbation magnitude $\\epsilon$. Use the relative error\n$$\ne \\;=\\; \\frac{\\left\\|\\Delta R_{\\text{FD}} - \\Delta R_{\\text{lin}}\\right\\|_{2}}{\\max\\!\\big(\\left\\|\\Delta R_{\\text{lin}}\\right\\|_{2}, \\tau\\big)},\n$$\nwith a tiny regularization $\\tau$ to avoid division by zero.\n\nFor each test case below, construct an equilibrium displacement field $u$ that yields a uniform axial stress $\\sigma = F/A$ while satisfying $u(0)=0$. For a homogeneous bar this corresponds to a uniform strain; for a heterogeneous bar with elementwise $\\sigma_{y0}$, the element strains may differ but the uniform stress is maintained. In all cases, use a single Gauss point per element for integration. Use the following test suite, where $n_{e} = 2$, $A = 1$, and $L = 1$ for all cases, and where elementwise $\\sigma_{y0}$ is specified as a list when heterogeneous:\n\n- Case $1$ (homogeneous elastic): $E = 2\\times 10^{5}$, $H = 10^{3}$, $\\sigma_{y0} = 250$, $F = 100$.\n- Case $2$ (homogeneous plastic): $E = 2\\times 10^{5}$, $H = 10^{3}$, $\\sigma_{y0} = 250$, $F = 500$.\n- Case $3$ (weakly plastic, near yield): $E = 2\\times 10^{5}$, $H = 10^{3}$, $\\sigma_{y0} = 250$, $F = 255$.\n- Case $4$ (heterogeneous mixed response): $E = 2\\times 10^{5}$, $H = 10^{3}$, $\\sigma_{y0} = [250,\\, 1000]$, $F = 500$.\n\nImplementation requirements:\n\n- Start from the fundamental definitions above. Implement a one-dimensional return-mapping update for the constitutive model that returns $\\sigma$ and $\\mathbb{C}^{\\text{alg}}$ for a given $\\varepsilon$.\n- Assemble $R(u)$ and $K(u)$ for the free degree of freedom by eliminating the fixed displacement at $x=0$.\n- For each case, construct an equilibrium $u$ with uniform stress $\\sigma = F/A$. For a homogeneous bar, use $u(x) = \\varepsilon\\, x$ with $\\varepsilon$ determined from the constitutive relations. For a heterogeneous bar, enforce uniform $\\sigma$ across elements; for element $e$, compute the element strain $\\varepsilon_e$ consistent with the uniform stress via the constitutive relations and integrate these strains to construct continuous nodal displacements from left to right with $u(0)=0$.\n- Use a fixed perturbation magnitude $\\epsilon = 10^{-8}$ and a deterministic random direction $p$ in the space of free degrees of freedom for each case, with fixed seeds per case to make results reproducible. Use $\\tau = 10^{-14}$.\n- Angle units are not applicable. There are no physical units; all quantities are nondimensional.\n\nYour program should produce a single line of output containing the results as a comma-separated list of the four relative errors in the order of the cases, enclosed in square brackets, for example $[e_1,e_2,e_3,e_4]$, where each $e_i$ is a floating-point number.",
            "solution": "The user requires the design and implementation of a verification procedure for an elasto-plastic algorithmic consistent tangent operator within a one-dimensional Finite Element Method (FEM) framework. The verification is based on comparing a finite-difference approximation of the change in the global residual vector with the prediction from the assembled tangent stiffness matrix.\n\nThe solution will be structured as follows:\n1.  **Constitutive Model Implementation**: A one-dimensional return-mapping algorithm for elastoplasticity with linear isotropic hardening is implemented. This function, given a total strain $\\varepsilon$, returns the updated stress $\\sigma$ and the algorithmic consistent tangent modulus $\\mathbb{C}^{\\text{alg}} = \\partial\\sigma/\\partial\\varepsilon$.\n2.  **Equilibrium State Construction**: For each test case, an equilibrium nodal displacement field $u$ is constructed. This field is designed to produce a state of uniform axial stress $\\sigma = F/A$ throughout the bar, satisfying the Dirichlet boundary condition $u(0)=0$.\n3.  **FEM Assembly**: Functions are created to compute element-level contributions to the global internal force vector and tangent stiffness matrix, and to assemble these into global system quantities. The fixed degree of freedom at $x=0$ is eliminated to work with the system of free degrees of freedom.\n4.  **Verification Workflow**: The core verification logic is implemented. This involves perturbing the equilibrium displacement field, calculating the finite difference of the residual, and comparing it against the linear prediction from the consistent tangent matrix.\n\n### Step 1: Constitutive Model (1D Return-Mapping)\nThe material model is uniaxial elastoplasticity with linear isotropic hardening. We start from a stress-free state ($\\varepsilon^{p}_n=0, \\alpha_n=0$). For a given total strain $\\varepsilon$ at step $n+1$:\n\n1.  **Trial State**: An elastic trial step is assumed. The trial stress is $\\sigma^{\\text{trial}} = E \\varepsilon$. The yield surface is evaluated using the yield stress from the previous step, which is just the initial yield stress $\\sigma_{y0}$ since $\\alpha_n=0$. The trial yield function is $\\phi^{\\text{trial}} = |\\sigma^{\\text{trial}}| - \\sigma_{y0}$.\n\n2.  **Yield Check**:\n    - If $\\phi^{\\text{trial}} \\le 0$, the step is elastic. The stress is $\\sigma = \\sigma^{\\text{trial}}$ and the tangent modulus is the elastic modulus, $\\mathbb{C}^{\\text{alg}} = E$.\n    - If $\\phi^{\\text{trial}} > 0$, plastic flow occurs. A return-mapping is required to bring the stress state back to the updated yield surface.\n\n3.  **Plastic Corrector**: For this 1D model, the plastic multiplier increment, $\\Delta\\gamma$, is found from the consistency condition $\\phi_{n+1}=0$. This gives:\n    $$\n    \\Delta\\gamma = \\frac{\\phi^{\\text{trial}}}{E+H} = \\frac{|\\sigma^{\\text{trial}}| - \\sigma_{y0}}{E+H}\n    $$\n    The updated stress is then computed as:\n    $$\n    \\sigma = \\sigma^{\\text{trial}} - E\\,\\Delta\\gamma\\,\\mathrm{sign}(\\sigma^{\\text{trial}})\n    $$\n    The algorithmic consistent tangent modulus, which is the exact derivative of the updated stress with respect to the total strain, is:\n    $$\n    \\mathbb{C}^{\\text{alg}} = \\frac{\\partial\\sigma}{\\partial\\varepsilon} = \\frac{EH}{E+H}\n    $$\nThis function forms the constitutive core of the simulation.\n\n### Step 2: Construction of Equilibrium Displacement Field\nFor the verification, we analyze the system around a known equilibrium state $u$. This state is constructed to produce a uniform stress $\\sigma = F/A$ across all elements. The strain in each element, $\\varepsilon_e$, required to produce this stress is calculated from the inverse constitutive relation:\n- If $|\\sigma| \\le \\sigma_{y0,e}$ (elastic): $\\varepsilon_e = \\sigma/E$.\n- If $|\\sigma| > \\sigma_{y0,e}$ (plastic): The total strain is the sum of elastic and plastic parts, $\\varepsilon_e = \\varepsilon^e + \\varepsilon^p$. The elastic strain is $\\varepsilon^e = \\sigma/E$. The plastic strain magnitude is derived from the hardening law, $|\\varepsilon^p| = \\alpha = (|\\sigma| - \\sigma_{y0,e})/H$. Combining these gives:\n  $$\n  \\varepsilon_e = \\mathrm{sign}(\\sigma) \\left( \\frac{|\\sigma|}{E} + \\frac{|\\sigma| - \\sigma_{y0,e}}{H} \\right)\n  $$\nWith the element strains $\\{\\varepsilon_e\\}$ determined, the nodal displacements are found by integrating the strains from the fixed end $u(0)=0$:\n$$\nu_0 = 0, \\quad u_{i+1} = u_i + \\varepsilon_i L_i\n$$\nwhere $L_i$ is the length of element $i$.\n\n### Step 3: FEM Assembly and System Reduction\nThe analysis is performed on a discretized bar with $n_e=2$ linear two-node elements. The total number of nodes is $n_n = 3$.\n\n- **Element-Level Matrices**: For each element $e$ of length $L_e$ with area $A$, the strain-displacement matrix is $B = [-1/L_e, 1/L_e]$. The element internal force vector and tangent stiffness matrix are calculated at a single integration point using the strain $\\varepsilon_e = B u_e$:\n  $$\n  f^{\\text{int}}_{e} = B^{\\mathsf{T}} \\sigma(\\varepsilon_e) A L_e, \\qquad K^{\\text{tan}}_{e} = B^{\\mathsf{T}} \\mathbb{C}^{\\text{alg}}(\\varepsilon_e) B A L_e = \\frac{\\mathbb{C}^{\\text{alg}}_e A}{L_e} \\begin{bmatrix} 1 & -1 \\\\ -1 & 1 \\end{bmatrix}\n  $$\n- **Global Assembly**: Element contributions are assembled into global matrices $f^{\\text{int}}(u)$ and $K(u)$ of size $3$ and $3 \\times 3$, respectively.\n- **System Definition**: The global residual is $R(u) = f^{\\text{int}}(u) - f^{\\text{ext}}$, where $f^{\\text{ext}} = [0, 0, F]^{\\mathsf{T}}$. The Dirichlet boundary condition $u(0)=0$ is applied by eliminating the first row and column from the global system, resulting in a reduced system for the free degrees of freedom (nodes 1 and 2). Let these be $R_{\\text{free}}(u)$ and $K_{\\text{free}}(u)$.\n\n### Step 4: Verification Procedure\nThe verification confirms that $K_{\\text{free}}(u)$ is the correct tangent of $R_{\\text{free}}(u)$. A central finite-difference is used to approximate the directional derivative of $R_{\\text{free}}$ along a random direction $p$ in the space of free DOFs.\n\n1.  **Linear Prediction**: The assembled tangent matrix is used to predict the change in the residual:\n    $$\n    \\Delta R_{\\text{lin}} = K_{\\text{free}}(u) \\, (2 \\epsilon p)\n    $$\n2.  **Finite-Difference Approximation**: The residual is evaluated at perturbed displacement states $u^+ = u + \\epsilon p$ and $u^- = u - \\epsilon p$. The perturbation vector $p$ for the free DOFs is embedded into the global displacement vector (with a zero for the fixed DOF).\n    $$\n    \\Delta R_{\\text{FD}} = R_{\\text{free}}(u^+) - R_{\\text{free}}(u^-)\n    $$\n3.  **Relative Error**: The accuracy of the tangent is quantified by the relative error between the prediction and the approximation:\n    $$\n    e = \\frac{\\left\\|\\Delta R_{\\text{FD}} - \\Delta R_{\\text{lin}}\\right\\|_{2}}{\\max(\\left\\|\\Delta R_{\\text{lin}}\\right\\|_{2}, \\tau)}\n    $$\nA small error $e$ (near machine precision) validates that the implemented tangent modulus $\\mathbb{C}^{\\text{alg}}$ is indeed consistent with the numerical stress update rule, and that the global assembly is correct. The test cases cover elastic, plastic, near-yield, and mixed elastic-plastic responses to ensure robustness.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main solver function that designs, implements, and runs the verification \n    workflow for the elasto-plastic consistent tangent operator.\n    \"\"\"\n    \n    # Global constants from the problem statement\n    L_TOTAL = 1.0\n    A_CROSS_SECTION = 1.0\n    N_ELEMENTS = 2\n    EPSILON = 1e-8\n    TAU = 1e-14\n\n    def update_material(strain, E, H, sigma_y0):\n        \"\"\"\n        Implements the 1D return mapping algorithm for linear isotropic hardening.\n\n        Args:\n            strain (float): Current total strain.\n            E (float): Young's modulus.\n            H (float): Plastic modulus.\n            sigma_y0 (float): Initial yield stress.\n\n        Returns:\n            tuple: (stress, algorithmic_tangent_modulus).\n        \"\"\"\n        if np.abs(strain) < 1e-16: # Handle zero strain case to avoid division by zero\n            return 0.0, E\n\n        sigma_trial = E * strain\n        \n        # Previous state has alpha_n = 0, so current yield stress is sigma_y0\n        phi_trial = np.abs(sigma_trial) - sigma_y0\n\n        if phi_trial <= 0:\n            # Elastic step\n            return sigma_trial, E\n        else:\n            # Plastic step\n            delta_gamma = phi_trial / (E + H)\n            stress = sigma_trial - E * delta_gamma * np.sign(sigma_trial)\n            C_alg = (E * H) / (E + H)\n            return stress, C_alg\n\n    def get_equilibrium_displacement(F, E, H, sigma_y0_list, L, A, n_e):\n        \"\"\"\n        Constructs the nodal displacement vector 'u' that corresponds to a\n        state of uniform axial stress sigma = F/A.\n        \"\"\"\n        sigma_target = F / A\n        element_strains = []\n\n        for e in range(n_e):\n            sigma_y0_e = sigma_y0_list[e]\n            \n            if np.abs(sigma_target) <= sigma_y0_e:\n                strain_e = sigma_target / E\n            else:\n                strain_e = np.sign(sigma_target) * (\n                    np.abs(sigma_target) / E + (np.abs(sigma_target) - sigma_y0_e) / H\n                )\n            element_strains.append(strain_e)\n\n        n_nodes = n_e + 1\n        u_global = np.zeros(n_nodes)\n        node_coords = np.linspace(0, L, n_nodes)\n        \n        for e in range(n_e):\n            L_e = node_coords[e + 1] - node_coords[e]\n            u_global[e + 1] = u_global[e] + element_strains[e] * L_e\n            \n        return u_global\n\n    def compute_residual_and_tangent(u_global, E, H, sigma_y0_list, L, A, n_e, F):\n        \"\"\"\n        Assembles the global internal force and tangent matrix and returns the\n        components corresponding to the free degrees of freedom.\n        \"\"\"\n        n_nodes = n_e + 1\n        node_coords = np.linspace(0, L, n_nodes)\n\n        f_int_global = np.zeros(n_nodes)\n        K_tan_global = np.zeros((n_nodes, n_nodes))\n\n        for e in range(n_e):\n            i, j = e, e + 1\n            L_e = node_coords[j] - node_coords[i]\n            B = np.array([-1.0 / L_e, 1.0 / L_e])\n            u_e = u_global[[i, j]]\n            strain_e = B @ u_e\n            \n            sigma_e, C_alg_e = update_material(strain_e, E, H, sigma_y0_list[e])\n            \n            f_int_elem = B.T * sigma_e * A * L_e\n            K_tan_elem = C_alg_e * A / L_e * np.array([[1.0, -1.0], [-1.0, 1.0]])\n\n            f_int_global[i:j+1] += f_int_elem\n            K_tan_global[np.ix_([i, j], [i, j])] += K_tan_elem\n\n        f_ext_global = np.zeros(n_nodes)\n        f_ext_global[-1] = F\n        R_global = f_int_global - f_ext_global\n\n        free_dofs = slice(1, None)\n        R_free = R_global[free_dofs]\n        K_free = K_tan_global[free_dofs, free_dofs]\n        \n        return R_free, K_free\n\n    def run_verification(case_params):\n        \"\"\"\n        Runs the verification procedure for a single test case.\n        \"\"\"\n        E, H, sigma_y0_val, F, seed = case_params\n        \n        if isinstance(sigma_y0_val, list):\n            sigma_y0_list = sigma_y0_val\n        else:\n            sigma_y0_list = [sigma_y0_val] * N_ELEMENTS\n\n        u_eq = get_equilibrium_displacement(F, E, H, sigma_y0_list, L_TOTAL, A_CROSS_SECTION, N_ELEMENTS)\n        \n        n_free_dofs = N_ELEMENTS\n        rng = np.random.default_rng(seed)\n        p_free = rng.random(size=n_free_dofs)\n\n        _, K_free_eq = compute_residual_and_tangent(\n            u_eq, E, H, sigma_y0_list, L_TOTAL, A_CROSS_SECTION, N_ELEMENTS, F\n        )\n        delta_R_lin = K_free_eq @ (2 * EPSILON * p_free)\n\n        p_global = np.zeros(N_ELEMENTS + 1)\n        p_global[1:] = p_free\n        \n        u_plus = u_eq + EPSILON * p_global\n        u_minus = u_eq - EPSILON * p_global\n        \n        R_free_plus, _ = compute_residual_and_tangent(\n            u_plus, E, H, sigma_y0_list, L_TOTAL, A_CROSS_SECTION, N_ELEMENTS, F\n        )\n        R_free_minus, _ = compute_residual_and_tangent(\n            u_minus, E, H, sigma_y0_list, L_TOTAL, A_CROSS_SECTION, N_ELEMENTS, F\n        )\n        \n        delta_R_fd = R_free_plus - R_free_minus\n\n        norm_diff = np.linalg.norm(delta_R_fd - delta_R_lin)\n        norm_lin = np.linalg.norm(delta_R_lin)\n        \n        error = norm_diff / max(norm_lin, TAU)\n        \n        return error\n\n    test_cases = [\n        # (E, H, sigma_y0, F, seed)\n        (2e5, 1e3, 250.0, 100.0, 1), # Case 1: Homogeneous elastic\n        (2e5, 1e3, 250.0, 500.0, 2), # Case 2: Homogeneous plastic\n        (2e5, 1e3, 250.0, 255.0, 3), # Case 3: Weakly plastic, near yield\n        (2e5, 1e3, [250.0, 1000.0], 500.0, 4), # Case 4: Heterogeneous mixed\n    ]\n\n    results = []\n    for case in test_cases:\n        error = run_verification(case)\n        results.append(error)\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(f'{r:.8e}' for r in results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "While many introductory examples use the smooth von Mises yield surface, many robust plasticity models, such as Tresca or Drucker-Prager, feature non-smooth surfaces with corners and edges. At these points, the gradient of the yield function is not unique, and the standard derivation of the consistent tangent breaks down. This advanced problem tackles this challenge head-on by simulating a stress path that crosses a corner on the Tresca yield surface . You will learn to handle this non-differentiability by developing a step-partitioning strategy, a critical skill for creating robust code capable of handling complex material behavior.",
            "id": "3508023",
            "problem": "Consider a small-strain, rate-independent, isotropic elastoplastic material intended to model geomaterial shear failure with the Tresca yield surface. The elastic response is linear and characterized by Young’s modulus $E$ and Poisson’s ratio $\\nu$, with Lamé parameters $\\lambda = \\frac{E \\nu}{(1+\\nu)(1-2\\nu)}$ and $\\mu = \\frac{E}{2(1+\\nu)}$. Let the stress and strain tensors remain coaxial throughout the increment so that the principal directions do not rotate; denote principal strains by $(\\varepsilon_{1}, \\varepsilon_{2}, \\varepsilon_{3})$ and principal stresses by $(\\sigma_{1}, \\sigma_{2}, \\sigma_{3})$. The elastic constitutive operator in the principal basis acting on diagonal components is $C_{\\mathrm{diag}} = 2 \\mu I + \\lambda \\mathbf{1} \\mathbf{1}^{\\top}$, where $I$ is the $3 \\times 3$ identity and $\\mathbf{1} = [\\,1 \\ \\ 1 \\ \\ 1\\,]^{\\top}$. The Tresca yield criterion is given by $f(\\boldsymbol{\\sigma}) = \\max\\{ |\\sigma_{1}-\\sigma_{2}|, |\\sigma_{2}-\\sigma_{3}|, |\\sigma_{3}-\\sigma_{1}| \\} - 2 k$, where $k$ is the shear yield stress, and the flow rule is associated, with plastic strain rate $\\dot{\\boldsymbol{\\varepsilon}}^{p} = \\dot{\\lambda} \\,\\partial f / \\partial \\boldsymbol{\\sigma}$.\n\nDesign the following mid-step corner-crossing test. The material is initially at time $t = 0$ on the Tresca facet defined by $\\sigma_{1} - \\sigma_{2} = 2 k$, with the other two differences strictly within yield:\n- $\\sigma_{1}(0) - \\sigma_{2}(0) = 2 k$,\n- $\\sigma_{2}(0) - \\sigma_{3}(0) = 2 k - \\delta$,\n- $\\sigma_{3}(0) - \\sigma_{1}(0) < 2 k$,\nwhere $\\delta > 0$ is given. Over a single time step of duration $\\Delta t$, impose constant principal strain rates $(\\dot{\\varepsilon}_{1}, \\dot{\\varepsilon}_{2}, \\dot{\\varepsilon}_{3})$, so that $\\boldsymbol{\\varepsilon}(t) = \\boldsymbol{\\varepsilon}(0) + t \\,\\dot{\\boldsymbol{\\varepsilon}}$, with $\\dot{\\boldsymbol{\\varepsilon}} = [\\,\\dot{\\varepsilon}_{1} \\ \\ \\dot{\\varepsilon}_{2} \\ \\ \\dot{\\varepsilon}_{3}\\,]^{\\top}$. Assume the applied rates satisfy $2 (\\dot{\\varepsilon}_{2} - \\dot{\\varepsilon}_{3}) + (\\dot{\\varepsilon}_{1} - \\dot{\\varepsilon}_{2}) > 0$ and that $\\Delta t$ is large enough that the path reaches the corner where $\\sigma_{1} - \\sigma_{2} = \\sigma_{2} - \\sigma_{3} = 2 k$ strictly within the time step and then continues onto the adjacent facet $\\sigma_{2} - \\sigma_{3} = 2 k$.\n\nStarting from the small-strain kinematics and linear elasticity, together with the associated flow rule and the plastic consistency condition for perfect plasticity, derive:\n1. A step partitioning strategy that computes the crossing time $\\Delta t_{1}$ at which the path hits the corner $\\sigma_{2} - \\sigma_{3} = 2 k$ while remaining on the facet $\\sigma_{1} - \\sigma_{2} = 2 k$; and then $\\Delta t_{2} = \\Delta t - \\Delta t_{1}$ for the remainder of the step on the facet $\\sigma_{2} - \\sigma_{3} = 2 k$.\n2. The piecewise algorithmic (consistent) elastoplastic tangent operators appropriate to each substep, expressed in the principal basis as $3 \\times 3$ operators mapping diagonal strain increments to diagonal stress increments, one for the facet $\\sigma_{1} - \\sigma_{2} = 2 k$ and one for the facet $\\sigma_{2} - \\sigma_{3} = 2 k$.\n\nYour derivation must begin from the fundamental laws and definitions stated above and proceed without invoking any pre-derived “shortcut” formulas. Explicitly use the normals to the active facets in stress space, $v_{A} = [\\,1 \\ \\ -1 \\ \\ 0\\,]^{\\top}$ for the facet $\\sigma_{1} - \\sigma_{2} = 2 k$ and $v_{B} = [\\,0 \\ \\ 1 \\ \\ -1\\,]^{\\top}$ for the facet $\\sigma_{2} - \\sigma_{3} = 2 k$, and enforce the plastic consistency condition on the active facet during each substep.\n\nAnswer specification:\n- Provide the final expressions for $\\Delta t_{1}$ and $\\Delta t_{2}$ in seconds, as a single row matrix, in terms of $E$, $\\nu$, $k$, $\\delta$, and the imposed principal strain rates $(\\dot{\\varepsilon}_{1}, \\dot{\\varepsilon}_{2}, \\dot{\\varepsilon}_{3})$, assuming the crossing occurs strictly within the step and the stated monotonicity condition holds.\n- No numerical evaluation is required; do not round.",
            "solution": "The problem will first be validated for self-consistency and scientific soundness.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n- **Material Model**: Small-strain, rate-independent, isotropic elastoplasticity.\n- **Yield Criterion**: Tresca, $f(\\boldsymbol{\\sigma}) = \\max\\{ |\\sigma_{1}-\\sigma_{2}|, |\\sigma_{2}-\\sigma_{3}|, |\\sigma_{3}-\\sigma_{1}| \\} - 2 k = 0$.\n- **Elasticity**: Linear, with Young’s modulus $E$ and Poisson’s ratio $\\nu$. Lamé parameters are $\\lambda = \\frac{E \\nu}{(1+\\nu)(1-2\\nu)}$ and $\\mu = \\frac{E}{2(1+\\nu)}$.\n- **Coaxiality of Stress and Strain**: Principal directions are fixed.\n- **Elastic Constitutive Law (Principal Basis)**: $\\boldsymbol{\\sigma} = C_{\\mathrm{diag}} \\boldsymbol{\\varepsilon}^e$, where $C_{\\mathrm{diag}} = 2 \\mu I + \\lambda \\mathbf{1} \\mathbf{1}^{\\top}$.\n- **Flow Rule**: Associated, $\\dot{\\boldsymbol{\\varepsilon}}^{p} = \\dot{\\gamma} \\,\\partial f / \\partial \\boldsymbol{\\sigma}$, where $\\dot{\\gamma}$ is the plastic multiplier rate.\n- **Initial Conditions ($t=0$):**\n    1. On yield facet A: $\\sigma_{1}(0) - \\sigma_{2}(0) = 2 k$.\n    2. Near corner: $\\sigma_{2}(0) - \\sigma_{3}(0) = 2 k - \\delta$, with $\\delta > 0$.\n    3. Other differences \"strictly within yield\".\n- **Loading**: Constant principal strain rates $\\dot{\\boldsymbol{\\varepsilon}} = [\\,\\dot{\\varepsilon}_{1} \\ \\ \\dot{\\varepsilon}_{2} \\ \\ \\dot{\\varepsilon}_{3}\\,]^{\\top}$ over a time step $\\Delta t$.\n- **Loading Condition**: $2 (\\dot{\\varepsilon}_{2} - \\dot{\\varepsilon}_{3}) + (\\dot{\\varepsilon}_{1} - \\dot{\\varepsilon}_{2}) > 0$.\n- **Path**: The stress path reaches the corner $\\sigma_{1} - \\sigma_{2} = \\sigma_{2} - \\sigma_{3} = 2 k$ within $[0, \\Delta t]$.\n- **Normals**: Facet A ($\\sigma_{1}-\\sigma_{2}=2k$): $\\mathbf{v}_{A} = [\\,1 \\ \\ -1 \\ \\ 0\\,]^{\\top}$. Facet B ($\\sigma_{2}-\\sigma_{3}=2k$): $\\mathbf{v}_{B} = [\\,0 \\ \\ 1 \\ \\ -1\\,]^{\\top}$.\n\n**Step 2: Validate Using Extracted Givens**\nThe initial state is on the facet $\\sigma_{1} - \\sigma_{2} = 2 k$. This implies that $|\\sigma_{1}-\\sigma_{2}|$ is the maximum of the three principal stress differences. The other differences must be \"strictly within yield\", meaning their absolute values are less than $2k$.\n\nFrom the givens:\n1. $|\\sigma_{1}(0) - \\sigma_{2}(0)| = |2k| = 2k$ (assuming $k>0$, a physical necessity for shear yield stress).\n2. We are given $\\sigma_{2}(0) - \\sigma_{3}(0) = 2k - \\delta$. Thus, we must have $|\\sigma_{2}(0) - \\sigma_{3}(0)| = |2k - \\delta| < 2k$.\n3. From the first two conditions, we can find the third difference: $\\sigma_{1}(0) - \\sigma_{3}(0) = (\\sigma_{1}(0) - \\sigma_{2}(0)) + (\\sigma_{2}(0) - \\sigma_{3}(0)) = 2k + (2k - \\delta) = 4k - \\delta$. Thus, we must have $|\\sigma_{1}(0) - \\sigma_{3}(0)| = |4k - \\delta| < 2k$.\n\nLet's analyze these two inequalities for the given $\\delta > 0$:\n- From $|2k - \\delta| < 2k$:\n  This is equivalent to $-2k < 2k - \\delta < 2k$.\n  The right side, $2k - \\delta < 2k$, implies $\\delta > 0$, which is given.\n  The left side, $-2k < 2k - \\delta$, implies $\\delta < 4k$.\n  So, this condition requires $0 < \\delta < 4k$.\n\n- From $|4k - \\delta| < 2k$:\n  This is equivalent to $-2k < 4k - \\delta < 2k$.\n  The right side, $4k - \\delta < 2k$, implies $\\delta > 2k$.\n  The left side, $-2k < 4k - \\delta$, implies $\\delta < 6k$.\n  So, this condition requires $2k < \\delta < 6k$.\n\nFor the initial state to be valid as described, both sets of conditions on $\\delta$ must be met. The intersection of the intervals $(0, 4k)$ and $(2k, 6k)$ is $(2k, 4k)$. Thus, the problem is self-consistent if and only if $2k < \\delta < 4k$. While this condition on $\\delta$ may seem counter-intuitive given the phrasing \"near the corner\", it does not represent a logical contradiction or a violation of physical principles. It is an unstated but derivable constraint. The problem is therefore deemed valid, albeit with a subtle setup.\n\n**Step 3: Verdict and Action**\nThe problem is valid. We proceed with the solution.\n\n### Derivation\n\nThe total strain increment $\\Delta\\boldsymbol{\\varepsilon}$ is decomposed into elastic and plastic parts: $\\Delta\\boldsymbol{\\varepsilon} = \\Delta\\boldsymbol{\\varepsilon}^e + \\Delta\\boldsymbol{\\varepsilon}^p$.\nThe stress increment is related to the elastic strain increment by the linear elastic law: $\\Delta\\boldsymbol{\\sigma} = C_{\\mathrm{diag}} \\Delta\\boldsymbol{\\varepsilon}^e$.\nThe plastic strain increment is given by the associated flow rule: $\\Delta\\boldsymbol{\\varepsilon}^p = \\Delta\\gamma \\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}}$, where $\\Delta\\gamma$ is the consistency parameter (plastic multiplier).\n\nThe problem involves two substeps.\n1.  **Substep 1**: Time interval $[0, \\Delta t_1]$. The stress state moves along the facet $f_A(\\boldsymbol{\\sigma}) = \\sigma_1 - \\sigma_2 - 2k = 0$.\n2.  **Substep 2**: Time interval $[\\Delta t_1, \\Delta t]$. The stress state moves along the adjacent facet $f_B(\\boldsymbol{\\sigma}) = \\sigma_2 - \\sigma_3 - 2k = 0$. Here $\\Delta t_2 = \\Delta t - \\Delta t_1$.\n\n**Substep 1: Derivation of $\\Delta t_1$**\nDuring this substep, plastic flow occurs on facet A. The normal to this facet in principal stress space is $\\mathbf{v}_A = \\frac{\\partial f_A}{\\partial\\boldsymbol{\\sigma}} = [\\,1 \\ \\ -1 \\ \\ 0\\,]^{\\top}$.\nThe plastic strain increment is $\\Delta\\boldsymbol{\\varepsilon}^p = \\Delta\\gamma_A \\mathbf{v}_A$, with $\\Delta\\gamma_A > 0$.\nThe stress increment is $\\Delta\\boldsymbol{\\sigma} = C_{\\mathrm{diag}}(\\Delta\\boldsymbol{\\varepsilon} - \\Delta\\boldsymbol{\\varepsilon}^p) = C_{\\mathrm{diag}}(\\Delta\\boldsymbol{\\varepsilon} - \\Delta\\gamma_A \\mathbf{v}_A)$.\nThe plastic consistency condition requires the stress state to remain on the yield surface, so $\\Delta f_A = \\mathbf{v}_A^{\\top} \\Delta\\boldsymbol{\\sigma} = 0$.\n$\\mathbf{v}_A^{\\top} [C_{\\mathrm{diag}}(\\Delta\\boldsymbol{\\varepsilon} - \\Delta\\gamma_A \\mathbf{v}_A)] = 0$\n$\\mathbf{v}_A^{\\top} C_{\\mathrm{diag}} \\Delta\\boldsymbol{\\varepsilon} - \\Delta\\gamma_A (\\mathbf{v}_A^{\\top} C_{\\mathrm{diag}} \\mathbf{v}_A) = 0$\nSolving for $\\Delta\\gamma_A$: $\\Delta\\gamma_A = \\frac{\\mathbf{v}_A^{\\top} C_{\\mathrm{diag}} \\Delta\\boldsymbol{\\varepsilon}}{\\mathbf{v}_A^{\\top} C_{\\mathrm{diag}} \\mathbf{v}_A}$.\n\nLet's compute the terms:\n$C_{\\mathrm{diag}} \\mathbf{v}_A = \\begin{pmatrix} \\lambda+2\\mu & \\lambda & \\lambda \\\\ \\lambda & \\lambda+2\\mu & \\lambda \\\\ \\lambda & \\lambda & \\lambda+2\\mu \\end{pmatrix} \\begin{pmatrix} 1 \\\\ -1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 2\\mu \\\\ -2\\mu \\\\ 0 \\end{pmatrix}$.\n$\\mathbf{v}_A^{\\top} C_{\\mathrm{diag}} \\mathbf{v}_A = [\\,1 \\ \\ -1 \\ \\ 0\\,] \\begin{pmatrix} 2\\mu \\\\ -2\\mu \\\\ 0 \\end{pmatrix} = 4\\mu$.\n$\\mathbf{v}_A^{\\top} C_{\\mathrm{diag}} \\Delta\\boldsymbol{\\varepsilon} = [\\,2\\mu \\ \\ -2\\mu \\ \\ 0\\,] \\begin{pmatrix} \\Delta\\varepsilon_1 \\\\ \\Delta\\varepsilon_2 \\\\ \\Delta\\varepsilon_3 \\end{pmatrix} = 2\\mu(\\Delta\\varepsilon_1 - \\Delta\\varepsilon_2)$.\nSo, $\\Delta\\gamma_A = \\frac{2\\mu(\\Delta\\varepsilon_1 - \\Delta\\varepsilon_2)}{4\\mu} = \\frac{\\Delta\\varepsilon_1 - \\Delta\\varepsilon_2}{2}$. For plastic loading, $\\Delta\\gamma_A > 0$, requiring $\\Delta\\varepsilon_1 > \\Delta\\varepsilon_2$.\n\nThe corner is reached when $\\sigma_2 - \\sigma_3 = 2k$. The change in this quantity over $\\Delta t_1$ is:\n$\\Delta(\\sigma_2 - \\sigma_3) = \\sigma_2(\\Delta t_1) - \\sigma_3(\\Delta t_1) - (\\sigma_2(0) - \\sigma_3(0)) = 2k - (2k - \\delta) = \\delta$.\nThe increment $\\Delta(\\sigma_2 - \\sigma_3)$ is $\\Delta\\sigma_2 - \\Delta\\sigma_3$. Using $\\Delta\\boldsymbol{\\sigma} = C_{\\mathrm{diag}}(\\Delta\\boldsymbol{\\varepsilon} - \\Delta\\gamma_A \\mathbf{v}_A)$:\n$\\Delta\\sigma_2 = \\lambda(\\Delta\\varepsilon_1 - \\Delta\\gamma_A) + (\\lambda+2\\mu)(\\Delta\\varepsilon_2 + \\Delta\\gamma_A) + \\lambda\\Delta\\varepsilon_3$.\n$\\Delta\\sigma_3 = \\lambda(\\Delta\\varepsilon_1 - \\Delta\\gamma_A) + \\lambda(\\Delta\\varepsilon_2 + \\Delta\\gamma_A) + (\\lambda+2\\mu)\\Delta\\varepsilon_3$.\n$\\Delta\\sigma_2 - \\Delta\\sigma_3 = 2\\mu(\\Delta\\varepsilon_2 + \\Delta\\gamma_A) - 2\\mu\\Delta\\varepsilon_3 = 2\\mu(\\Delta\\varepsilon_2 - \\Delta\\varepsilon_3 + \\Delta\\gamma_A)$.\nSubstitute $\\Delta\\gamma_A = (\\Delta\\varepsilon_1 - \\Delta\\varepsilon_2)/2$:\n$\\Delta\\sigma_2 - \\Delta\\sigma_3 = 2\\mu \\left( \\Delta\\varepsilon_2 - \\Delta\\varepsilon_3 + \\frac{\\Delta\\varepsilon_1 - \\Delta\\varepsilon_2}{2} \\right) = 2\\mu \\left( \\frac{\\Delta\\varepsilon_1}{2} + \\frac{\\Delta\\varepsilon_2}{2} - \\Delta\\varepsilon_3 \\right) = \\mu(\\Delta\\varepsilon_1 + \\Delta\\varepsilon_2 - 2\\Delta\\varepsilon_3)$.\n\nWe equate this to $\\delta$: $\\mu(\\Delta\\varepsilon_1 + \\Delta\\varepsilon_2 - 2\\Delta\\varepsilon_3) = \\delta$.\nSince the strain rates are constant, $\\Delta\\boldsymbol{\\varepsilon} = \\dot{\\boldsymbol{\\varepsilon}}\\Delta t_1$.\n$\\mu(\\dot{\\varepsilon}_1 + \\dot{\\varepsilon}_2 - 2\\dot{\\varepsilon}_3)\\Delta t_1 = \\delta$.\nSolving for $\\Delta t_1$:\n$\\Delta t_1 = \\frac{\\delta}{\\mu(\\dot{\\varepsilon}_1 + \\dot{\\varepsilon}_2 - 2\\dot{\\varepsilon}_3)}$.\nThe given condition $2 (\\dot{\\varepsilon}_{2} - \\dot{\\varepsilon}_{3}) + (\\dot{\\varepsilon}_{1} - \\dot{\\varepsilon}_{2}) = \\dot{\\varepsilon}_1 + \\dot{\\varepsilon}_2 - 2\\dot{\\varepsilon}_3 > 0$ ensures that $\\Delta t_1 > 0$ as $\\mu > 0$ and $\\delta > 0$.\nSubstituting $\\mu = \\frac{E}{2(1+\\nu)}$:\n$\\Delta t_1 = \\frac{2\\delta(1+\\nu)}{E(\\dot{\\varepsilon}_1 + \\dot{\\varepsilon}_2 - 2\\dot{\\varepsilon}_3)}$.\nThe duration of the second substep is $\\Delta t_2 = \\Delta t - \\Delta t_1$, assuming $\\Delta t \\ge \\Delta t_1$.\n\n**Derivation of the Consistent Tangent Operators**\nThe consistent elastoplastic tangent operator $C_{\\mathrm{ep}}$ is defined by $\\Delta\\boldsymbol{\\sigma} = C_{\\mathrm{ep}} \\Delta\\boldsymbol{\\varepsilon}$. From $\\Delta\\boldsymbol{\\sigma} = C_{\\mathrm{diag}}(\\Delta\\boldsymbol{\\varepsilon} - \\Delta\\gamma \\mathbf{v})$ and $\\Delta\\gamma = \\frac{\\mathbf{v}^{\\top} C_{\\mathrm{diag}} \\Delta\\boldsymbol{\\varepsilon}}{\\mathbf{v}^{\\top} C_{\\mathrm{diag}} \\mathbf{v}}$, we have:\n$C_{\\mathrm{ep}} = C_{\\mathrm{diag}} - \\frac{C_{\\mathrm{diag}} \\mathbf{v} (\\mathbf{v}^{\\top} C_{\\mathrm{diag}})}{ \\mathbf{v}^{\\top} C_{\\mathrm{diag}} \\mathbf{v} } = C_{\\mathrm{diag}} - \\frac{(C_{\\mathrm{diag}} \\mathbf{v}) (C_{\\mathrm{diag}} \\mathbf{v})^{\\top}}{ \\mathbf{v}^{\\top} C_{\\mathrm{diag}} \\mathbf{v} }$, where the symmetry of $C_{\\mathrm{diag}}$ is used.\n\n**For Substep 1 (Facet A):** $\\mathbf{v} = \\mathbf{v}_A = [\\,1 \\ \\ -1 \\ \\ 0\\,]^{\\top}$.\nWe have $C_{\\mathrm{diag}}\\mathbf{v}_A = [\\,2\\mu \\ \\ -2\\mu \\ \\ 0\\,]^{\\top}$ and $\\mathbf{v}_A^{\\top}C_{\\mathrm{diag}}\\mathbf{v}_A = 4\\mu$.\nThe correction term is:\n$\\frac{(C_{\\mathrm{diag}} \\mathbf{v}_A) (C_{\\mathrm{diag}} \\mathbf{v}_A)^{\\top}}{ 4\\mu } = \\frac{1}{4\\mu} \\begin{pmatrix} 2\\mu \\\\ -2\\mu \\\\ 0 \\end{pmatrix} [\\,2\\mu \\ \\ -2\\mu \\ \\ 0\\,] = \\frac{1}{4\\mu} \\begin{pmatrix} 4\\mu^2 & -4\\mu^2 & 0 \\\\ -4\\mu^2 & 4\\mu^2 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} = \\mu \\begin{pmatrix} 1 & -1 & 0 \\\\ -1 & 1 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}$.\n$C_{\\mathrm{ep}}^A = C_{\\mathrm{diag}} - \\mu \\begin{pmatrix} 1 & -1 & 0 \\\\ -1 & 1 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} = \\begin{pmatrix} \\lambda+2\\mu-\\mu & \\lambda+\\mu & \\lambda \\\\ \\lambda+\\mu & \\lambda+2\\mu-\\mu & \\lambda \\\\ \\lambda & \\lambda & \\lambda+2\\mu \\end{pmatrix} = \\begin{pmatrix} \\lambda+\\mu & \\lambda+\\mu & \\lambda \\\\ \\lambda+\\mu & \\lambda+\\mu & \\lambda \\\\ \\lambda & \\lambda & \\lambda+2\\mu \\end{pmatrix}$.\n\n**For Substep 2 (Facet B):** $\\mathbf{v} = \\mathbf{v}_B = [\\,0 \\ \\ 1 \\ \\ -1\\,]^{\\top}$.\n$C_{\\mathrm{diag}} \\mathbf{v}_B = \\begin{pmatrix} \\lambda+2\\mu & \\lambda & \\lambda \\\\ \\lambda & \\lambda+2\\mu & \\lambda \\\\ \\lambda & \\lambda & \\lambda+2\\mu \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\\\ -1 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 2\\mu \\\\ -2\\mu \\end{pmatrix}$.\n$\\mathbf{v}_B^{\\top} C_{\\mathrm{diag}} \\mathbf{v}_B = [\\,0 \\ \\ 1 \\ \\ -1\\,] \\begin{pmatrix} 0 \\\\ 2\\mu \\\\ -2\\mu \\end{pmatrix} = 4\\mu$.\nThe correction term is:\n$\\frac{(C_{\\mathrm{diag}} \\mathbf{v}_B) (C_{\\mathrm{diag}} \\mathbf{v}_B)^{\\top}}{ 4\\mu } = \\frac{1}{4\\mu} \\begin{pmatrix} 0 \\\\ 2\\mu \\\\ -2\\mu \\end{pmatrix} [\\,0 \\ \\ 2\\mu \\ \\ -2\\mu\\,] = \\mu \\begin{pmatrix} 0 & 0 & 0 \\\\ 0 & 1 & -1 \\\\ 0 & -1 & 1 \\end{pmatrix}$.\n$C_{\\mathrm{ep}}^B = C_{\\mathrm{diag}} - \\mu \\begin{pmatrix} 0 & 0 & 0 \\\\ 0 & 1 & -1 \\\\ 0 & -1 & 1 \\end{pmatrix} = \\begin{pmatrix} \\lambda+2\\mu & \\lambda & \\lambda \\\\ \\lambda & \\lambda+\\mu & \\lambda+\\mu \\\\ \\lambda & \\lambda+\\mu & \\lambda+\\mu \\end{pmatrix}$.\n\nThese derived operators are the piecewise algorithmic tangent moduli appropriate to each substep. The question's final answer specification only requires the expressions for $\\Delta t_1$ and $\\Delta t_2$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{2\\delta(1+\\nu)}{E(\\dot{\\varepsilon}_{1} + \\dot{\\varepsilon}_{2} - 2\\dot{\\varepsilon}_{3})} & \\Delta t - \\frac{2\\delta(1+\\nu)}{E(\\dot{\\varepsilon}_{1} + \\dot{\\varepsilon}_{2} - 2\\dot{\\varepsilon}_{3})}\n\\end{pmatrix}\n}\n$$"
        }
    ]
}