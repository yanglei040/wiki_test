{
    "hands_on_practices": [
        {
            "introduction": "The behavior of many engineering materials, such as polymers and biological tissues, depends on their history of deformation. This 'memory' effect is a hallmark of viscoelasticity. This practice provides a foundational exercise in converting the continuous differential equations of a hereditary model into a discrete, step-by-step algorithm suitable for computer implementation. By deriving and applying a recursive update for a generalized Maxwell model, you will gain hands-on experience with the core techniques for simulating time-dependent material response .",
            "id": "3544102",
            "problem": "A uniaxial, small-strain, isothermal linear viscoelastic solid is modeled by a generalized Maxwell chain (three Maxwell arms in parallel with one equilibrium spring). Let the stress be decomposed as $\\sigma(t) = E_{\\infty}\\,\\epsilon(t) + \\sum_{q=1}^{3} \\sigma_q(t)$, where $E_{\\infty}$ is the equilibrium elastic modulus and $\\sigma_q(t)$ are the stress contributions of the $q$-th Maxwell arm. Each Maxwell arm follows the evolution equation $ \\frac{d\\sigma_q}{dt} + \\frac{1}{\\tau_q}\\,\\sigma_q = E_q\\,\\frac{d\\epsilon}{dt}$, where $E_q$ is the arm modulus and $\\tau_q$ is its relaxation time. Assume initial conditions $\\epsilon(0^-)=0$ and $\\sigma_q(0^-)=0$ for $q=1,2,3$.\n\nThe material parameters are $E_{\\infty}=300\\,\\text{MPa}$, $E_1=700\\,\\text{MPa}$, $\\tau_1=1\\,\\text{s}$, $E_2=1000\\,\\text{MPa}$, $\\tau_2=5\\,\\text{s}$, $E_3=400\\,\\text{MPa}$, $\\tau_3=20\\,\\text{s}$.\n\nThe loading path consists of two consecutive strain jumps: at $t=0$ an instantaneous jump $\\Delta\\epsilon_1=0.012$ is applied and the strain is then held constant for $\\Delta t_1=2\\,\\text{s}$; at $t=\\Delta t_1$ an instantaneous jump $\\Delta\\epsilon_2=-0.004$ is applied and the strain is then held constant for $\\Delta t_2=3\\,\\text{s}$. Thus the final time is $t_f=\\Delta t_1+\\Delta t_2=5\\,\\text{s}$.\n\nStarting from the given evolution law for each mode and the stress decomposition, derive the algorithmic recursion for piecewise-constant strain segments with instantaneous strain jumps. Apply this recursion to compute the final stress $\\sigma(t_f)$ and report the contributions of each Maxwell mode separately, as well as the equilibrium spring contribution. Express all stresses in $\\text{MPa}$ and round your results to four significant figures. Present your final answer as a row matrix containing, in order, the total stress, the equilibrium spring contribution, and the contributions from modes $q=1,2,3$.",
            "solution": "The problem statement is scientifically grounded, well-posed, objective, and self-contained. It describes a standard problem in linear viscoelasticity, providing all necessary material parameters, initial conditions, and a clearly defined loading path. The model and governing equations are fundamental to the field of continuum mechanics. Therefore, the problem is deemed valid and a solution is pursued.\n\nThe core of the problem is to solve the evolution equation for the non-equilibrium stress $\\sigma_q(t)$ in each Maxwell arm, which is a first-order linear ordinary differential equation:\n$$ \\frac{d\\sigma_q}{dt} + \\frac{1}{\\tau_q}\\,\\sigma_q = E_q\\,\\frac{d\\epsilon}{dt} $$\nThe loading is specified as a sequence of time intervals where an instantaneous strain jump is followed by a period of constant strain. We first derive a general recursive update formula for the stress $\\sigma_q$ over a generic time step from $t_n$ to $t_{n+1}$. Let the duration of the step be $\\Delta t_{n+1} = t_{n+1} - t_n$. At time $t_n$, an instantaneous strain jump $\\Delta\\epsilon_{n+1}$ is applied.\n\nThe effect of the instantaneous strain jump at $t_n$ on the stress $\\sigma_q$ must be evaluated. We can integrate the governing equation over an infinitesimal time interval $[t_n^-, t_n^+]$:\n$$ \\int_{t_n^-}^{t_n^+} \\left(\\frac{d\\sigma_q}{dt}\\right) dt + \\int_{t_n^-}^{t_n^+} \\frac{1}{\\tau_q}\\,\\sigma_q dt = \\int_{t_n^-}^{t_n^+} E_q\\,\\frac{d\\epsilon}{dt} dt $$\nAs the interval duration approaches zero, the second integral vanishes because $\\sigma_q$ is bounded. The equation reduces to:\n$$ \\sigma_q(t_n^+) - \\sigma_q(t_n^-) = E_q \\left(\\epsilon(t_n^+) - \\epsilon(t_n^-)\\right) $$\nLet $\\sigma_{q,n}$ denote the stress at the end of the previous step, $\\sigma_q(t_n^-)$, and $\\Delta\\epsilon_{n+1}$ be the strain jump at $t_n$. The stress immediately after the jump, $\\sigma_q(t_n^+)$, is:\n$$ \\sigma_q(t_n^+) = \\sigma_{q,n} + E_q \\Delta\\epsilon_{n+1} $$\nFor the subsequent period $t \\in (t_n, t_{n+1}]$, the strain is held constant, meaning $\\frac{d\\epsilon}{dt} = 0$. The governing equation becomes homogeneous:\n$$ \\frac{d\\sigma_q}{dt} + \\frac{1}{\\tau_q}\\,\\sigma_q = 0 $$\nThe solution to this equation is an exponential decay. With the initial condition $\\sigma_q(t_n^+)$ at time $t_n$, the solution for $t > t_n$ is:\n$$ \\sigma_q(t) = \\sigma_q(t_n^+) \\exp\\left(-\\frac{t-t_n}{\\tau_q}\\right) $$\nEvaluating this at the end of the time step, $t = t_{n+1}$, gives the stress $\\sigma_{q,n+1}$:\n$$ \\sigma_{q,n+1} = \\sigma_q(t_{n+1}) = \\sigma_q(t_n^+) \\exp\\left(-\\frac{\\Delta t_{n+1}}{\\tau_q}\\right) $$\nSubstituting the expression for $\\sigma_q(t_n^+)$, we arrive at the algorithmic recursion for the non-equilibrium stresses:\n$$ \\sigma_{q,n+1} = \\left(\\sigma_{q,n} + E_q \\Delta\\epsilon_{n+1}\\right) \\exp\\left(-\\frac{\\Delta t_{n+1}}{\\tau_q}\\right) $$\nWe now apply this formula to the specified loading history. The material is initially at rest, so at $t=0^-$, we have $\\epsilon(0^-)=0$ and $\\sigma_{q,0}=\\sigma_q(0^-)=0$ for $q=1,2,3$.\n\nStep 1: First loading segment, $t \\in [0, 2\\,\\text{s}]$.\nAt $t_0=0$, there is a strain jump $\\Delta\\epsilon_1 = 0.012$. The time interval is $\\Delta t_1 = 2\\,\\text{s}$. The strain during this interval is $\\epsilon(t) = \\epsilon_1 = 0.012$.\nThe stresses at the end of this step, $t_1 = 2\\,\\text{s}$, are calculated using the recursion with $n=0$:\n$$ \\sigma_{q,1} = (\\sigma_{q,0} + E_q \\Delta\\epsilon_1) \\exp\\left(-\\frac{\\Delta t_1}{\\tau_q}\\right) = (0 + E_q \\times 0.012) \\exp\\left(-\\frac{2}{\\tau_q}\\right) $$\nFor each Maxwell arm ($q=1,2,3$):\n$$ \\sigma_{1,1} = (700 \\times 0.012) \\exp\\left(-\\frac{2}{1}\\right) = 8.4 \\exp(-2)\\,\\text{MPa} $$\n$$ \\sigma_{2,1} = (1000 \\times 0.012) \\exp\\left(-\\frac{2}{5}\\right) = 12 \\exp(-0.4)\\,\\text{MPa} $$\n$$ \\sigma_{3,1} = (400 \\times 0.012) \\exp\\left(-\\frac{2}{20}\\right) = 4.8 \\exp(-0.1)\\,\\text{MPa} $$\n\nStep 2: Second loading segment, $t \\in (2\\,\\text{s}, 5\\,\\text{s}]$.\nAt $t_1=2\\,\\text{s}$, there is a strain jump $\\Delta\\epsilon_2 = -0.004$. The time interval is $\\Delta t_2 = 5 - 2 = 3\\,\\text{s}$. The initial stresses for this step are $\\sigma_{q,1}$ calculated above.\nThe final strain is $\\epsilon(t_f) = \\epsilon_1 + \\Delta\\epsilon_2 = 0.012 - 0.004 = 0.008$.\nThe stresses at the final time $t_f = 5\\,\\text{s}$ are calculated using the recursion with $n=1$:\n$$ \\sigma_{q,f} = \\sigma_q(t_f) = (\\sigma_{q,1} + E_q \\Delta\\epsilon_2) \\exp\\left(-\\frac{\\Delta t_2}{\\tau_q}\\right) $$\nFor each Maxwell arm:\n$$ \\sigma_{1,f} = (8.4 \\exp(-2) + 700(-0.004)) \\exp\\left(-\\frac{3}{1}\\right) = (8.4 \\exp(-2) - 2.8) \\exp(-3) = 8.4 \\exp(-5) - 2.8 \\exp(-3) $$\n$$ \\sigma_{2,f} = (12 \\exp(-0.4) + 1000(-0.004)) \\exp\\left(-\\frac{3}{5}\\right) = (12 \\exp(-0.4) - 4) \\exp(-0.6) = 12 \\exp(-1) - 4 \\exp(-0.6) $$\n$$ \\sigma_{3,f} = (4.8 \\exp(-0.1) + 400(-0.004)) \\exp\\left(-\\frac{3}{20}\\right) = (4.8 \\exp(-0.1) - 1.6) \\exp(-0.15) = 4.8 \\exp(-0.25) - 1.6 \\exp(-0.15) $$\nNow we compute the numerical values for these modal contributions at $t_f = 5\\,\\text{s}$ and round to four significant figures:\n$$ \\sigma_{1,f} \\approx 8.4(0.0067379) - 2.8(0.049787) \\approx 0.056598 - 0.139404 = -0.082805\\,\\text{MPa} \\implies -0.08281\\,\\text{MPa} $$\n$$ \\sigma_{2,f} \\approx 12(0.36788) - 4(0.54881) \\approx 4.41456 - 2.19524 = 2.21932\\,\\text{MPa} \\implies 2.219\\,\\text{MPa} $$\n$$ \\sigma_{3,f} \\approx 4.8(0.77880) - 1.6(0.86071) \\approx 3.73824 - 1.37714 = 2.36110\\,\\text{MPa} \\implies 2.361\\,\\text{MPa} $$\nThe contribution from the equilibrium spring is purely elastic:\n$$ \\sigma_{\\infty}(t_f) = E_{\\infty} \\epsilon(t_f) = 300\\,\\text{MPa} \\times 0.008 = 2.4\\,\\text{MPa} $$\nFor consistency in reporting, this is presented as $2.400\\,\\text{MPa}$.\n\nThe total stress $\\sigma(t_f)$ is the sum of the equilibrium and non-equilibrium contributions. Summing the high-precision values and then rounding to four significant figures:\n$$ \\sigma(t_f) = \\sigma_{\\infty}(t_f) + \\sigma_{1,f} + \\sigma_{2,f} + \\sigma_{3,f} $$\n$$ \\sigma(t_f) \\approx 2.4 + (-0.082805) + 2.21932 + 2.36110 = 6.897615\\,\\text{MPa} \\implies 6.898\\,\\text{MPa} $$\n\nThe final results are:\n- Total stress: $\\sigma(t_f) = 6.898\\,\\text{MPa}$\n- Equilibrium spring contribution: $\\sigma_{\\infty}(t_f) = 2.400\\,\\text{MPa}$\n- Mode $1$ contribution: $\\sigma_1(t_f) = -0.08281\\,\\text{MPa}$\n- Mode $2$ contribution: $\\sigma_2(t_f) = 2.219\\,\\text{MPa}$\n- Mode $3$ contribution: $\\sigma_3(t_f) = 2.361\\,\\text{MPa}$\nThese values are assembled into a row matrix as requested.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n6.898  2.400  -0.08281  2.219  2.361\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "A numerically stable algorithm is not necessarily a physically correct one. For any material model, the algorithm used to update its state must respect the fundamental laws of thermodynamics, specifically the second law, which dictates that dissipation must be non-negative. This practice challenges you to move beyond simple implementation and act as a critical developer by designing a discrete check based on the Clausius–Duhem inequality . You will create a computational tool to verify a posteriori whether any proposed update is thermodynamically admissible, a crucial step in building robust and reliable material models.",
            "id": "3544047",
            "problem": "Consider an isothermal, one-dimensional, small-strain generalized Maxwell-type viscoelastic solid with $N$ internal variables. The free energy per unit volume is assumed to be quadratic and additively decomposed across an equilibrium elastic spring and $N$ non-equilibrium Maxwell branches. Specifically, for total strain $\\,\\varepsilon\\,$ and internal variables $\\,q_i\\,$, define\n$$\n\\Psi(\\varepsilon,\\{q_i\\}_{i=1}^N) = \\tfrac{1}{2} E_\\infty \\varepsilon^2 + \\sum_{i=1}^N \\tfrac{1}{2} E_i \\big(\\varepsilon - q_i\\big)^2,\n$$\nwhere $\\,E_\\infty\\,\\ge 0\\,$ is the equilibrium modulus and $\\,E_i\\,\\ge 0\\,$ are the branch moduli. The Cauchy stress (in one dimension) is obtained from the free energy by the standard constitutive assumption\n$$\n\\sigma = \\frac{\\partial \\Psi}{\\partial \\varepsilon} = E_\\infty \\varepsilon + \\sum_{i=1}^N E_i \\big(\\varepsilon - q_i\\big).\n$$\nThe Clausius–Duhem (CD) inequality for isothermal small strain reads\n$$\n\\mathcal{D}(t) = \\sigma(t)\\,\\dot{\\varepsilon}(t) - \\frac{\\mathrm{d}}{\\mathrm{d}t}\\Psi\\big(\\varepsilon(t),\\{q_i(t)\\}\\big) \\ge 0,\n$$\nwhere $\\,\\mathcal{D}\\,$ is the dissipation density (units of Joules per cubic meter).\n\nYour task is to design and implement a discrete a posteriori verification procedure for the CD inequality over a single time step $\\,[t_n,t_{n+1}]$ of size $\\,\\Delta t = t_{n+1}-t_n\\,$. Given\n- the material parameters $\\,E_\\infty\\,$, $\\,\\{E_i\\}_{i=1}^N\\,$, and $\\,\\{\\tau_i\\}_{i=1}^N\\,$ (with $\\,\\tau_i>0\\,$ the relaxation times),\n- the known state at time $\\,t_n\\,$: strain $\\,\\varepsilon_n\\,$ and internal variables $\\,\\{q_{i,n}\\}\\,$,\n- a proposed internal variable update $\\,\\{q_{i,n+1}\\}\\,$ at time $\\,t_{n+1}\\,$ produced by any algorithm,\n- and the strain at time $\\,t_{n+1}\\,$, denoted $\\,\\varepsilon_{n+1}\\,$,\n\nyou must construct the discrete dissipation increment $\\,\\Delta\\mathcal{D}\\,$ that approximates the time integral of $\\,\\mathcal{D}(t)\\,$ over the step, using only the defining relations above and a second-order accurate approximation of the stress power. Then, define a rejection rule that rejects any proposed update that violates $\\,\\Delta\\mathcal{D}\\ge 0\\,$.\n\nDesign the discrete dissipation $\\,\\Delta\\mathcal{D}\\,$ by:\n- computing the stored energy difference $\\,\\Delta \\Psi = \\Psi(\\varepsilon_{n+1},\\{q_{i,n+1}\\}) - \\Psi(\\varepsilon_n,\\{q_{i,n}\\})\\,$,\n- approximating the stress power over the step by a single-parameter, second-order accurate formula depending on the stresses at the endpoints,\n- and combining these terms into $\\,\\Delta\\mathcal{D}\\,$ consistent with the fundamental inequality stated above.\n\nExpress all stresses in Pascals, strains as dimensionless quantities, time in seconds, and energy density (including $\\,\\Delta\\mathcal{D}\\,$) in Joules per cubic meter. Angles are not used in this problem.\n\nImplement a program that, for each of the following test cases, computes $\\,\\Delta\\mathcal{D}\\,$ and outputs whether the proposed update is acceptable ($\\,\\Delta\\mathcal{D}\\ge 0\\,$) as a boolean. Use the trapezoidal approximation for stress power in the implementation. The test suite covers multiple scenarios, including a general case, a boundary case, a violation, and a multi-branch case.\n\nTest cases:\n1. Single branch, increasing strain (general case):\n   - $E_\\infty = 1.2\\times 10^9$, $N=1$, $E_1 = 0.8\\times 10^9$, $\\tau_1 = 0.5$, $\\Delta t = 0.1$,\n   - $\\varepsilon_n = 0.0$, $\\varepsilon_{n+1} = 0.001$,\n   - $q_{1,n} = 0.0$, proposed $q_{1,n+1} = q_{1,n}\\exp(-\\Delta t/\\tau_1) + \\varepsilon_{n+1}\\big(1-\\exp(-\\Delta t/\\tau_1)\\big)$.\n\n2. Single branch, no strain change, no internal update (boundary case):\n   - $E_\\infty = 0.5\\times 10^9$, $N=1$, $E_1 = 0.5\\times 10^9$, $\\tau_1 = 0.2$, $\\Delta t = 0.1$,\n   - $\\varepsilon_n = 0.0005$, $\\varepsilon_{n+1} = 0.0005$,\n   - $q_{1,n} = 0.0003$, proposed $q_{1,n+1} = q_{1,n}$.\n\n3. Single branch, no strain change, internal variable moves away from strain (violation case):\n   - $E_\\infty = 0.5\\times 10^9$, $N=1$, $E_1 = 0.5\\times 10^9$, $\\tau_1 = 0.2$, $\\Delta t = 0.1$,\n   - $\\varepsilon_n = 0.0005$, $\\varepsilon_{n+1} = 0.0005$,\n   - $q_{1,n} = 0.0005$, proposed $q_{1,n+1} = 0.0$.\n\n4. Two branches, decreasing strain with consistent relaxation (multi-branch case):\n   - $E_\\infty = 1.0\\times 10^9$, $N=2$, $(E_1,E_2) = (0.6\\times 10^9,\\,0.4\\times 10^9)$, $(\\tau_1,\\tau_2) = (0.4,\\,0.05)$, $\\Delta t = 0.02$,\n   - $\\varepsilon_n = 0.001$, $\\varepsilon_{n+1} = 0.0007$,\n   - $(q_{1,n},q_{2,n}) = (0.0008,\\,0.0005)$, proposed\n     $q_{i,n+1} = q_{i,n}\\exp(-\\Delta t/\\tau_i) + \\varepsilon_{n+1}\\big(1-\\exp(-\\Delta t/\\tau_i)\\big)$ for $i=1,2$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[True,False,True,True]\"), where each boolean indicates acceptance ($\\,\\Delta\\mathcal{D}\\ge 0\\,$) or rejection ($\\,\\Delta\\mathcal{D}0\\,$) of the corresponding proposed update.",
            "solution": "The fundamental principle governing the admissibility of a thermodynamic process is the second law of thermodynamics, which for an isothermal, small-strain continuum is expressed by the Clausius–Duhem (CD) inequality. The problem asks for an a posteriori verification procedure based on this principle. The dissipation density, $\\mathcal{D}(t)$, must be non-negative at all times, $\\mathcal{D}(t) \\ge 0$. Integrating this inequality over a finite time step of duration $\\Delta t = t_{n+1} - t_n$ yields the condition for the total dissipation increment, $\\Delta\\mathcal{D}$, over that step:\n$$\n\\Delta\\mathcal{D} = \\int_{t_n}^{t_{n+1}} \\mathcal{D}(t) \\, \\mathrm{d}t \\ge 0\n$$\nThe dissipation density is defined as the difference between the stress power (rate of work done by stresses) and the rate of change of stored free energy, $\\Psi$:\n$$\n\\mathcal{D}(t) = \\sigma(t)\\,\\dot{\\varepsilon}(t) - \\frac{\\mathrm{d}}{\\mathrm{d}t}\\Psi\\big(\\varepsilon(t),\\{q_i(t)\\}\\big)\n$$\nSubstituting this definition into the integral for $\\Delta\\mathcal{D}$:\n$$\n\\Delta\\mathcal{D} = \\int_{t_n}^{t_{n+1}} \\sigma(t)\\,\\dot{\\varepsilon}(t) \\, \\mathrm{d}t - \\int_{t_n}^{t_{n+1}} \\frac{\\mathrm{d}\\Psi}{\\mathrm{d}t} \\, \\mathrm{d}t\n$$\nThe second term can be solved exactly using the fundamental theorem of calculus, yielding the change in stored free energy from time $t_n$ to $t_{n+1}$:\n$$\n\\int_{t_n}^{t_{n+1}} \\frac{\\mathrm{d}\\Psi}{\\mathrm{d}t} \\, \\mathrm{d}t = \\Psi(t_{n+1}) - \\Psi(t_n) = \\Delta\\Psi\n$$\nwhere $\\Psi(t_n)$ is shorthand for $\\Psi(\\varepsilon_n, \\{q_{i,n}\\})$ and $\\Psi(t_{n+1})$ is shorthand for $\\Psi(\\varepsilon_{n+1}, \\{q_{i,n+1}\\})$.\nThe first term, representing the increment of work done per unit volume, $\\Delta W$, is given by the integral of the stress power:\n$$\n\\Delta W = \\int_{t_n}^{t_{n+1}} \\sigma(t)\\,\\dot{\\varepsilon}(t) \\, \\mathrm{d}t = \\int_{\\varepsilon_n}^{\\varepsilon_{n+1}} \\sigma(\\varepsilon) \\, \\mathrm{d}\\varepsilon\n$$\nThe problem specifies approximating this integral using a second-order accurate formula based on the stresses at the endpoints, $\\sigma_n = \\sigma(\\varepsilon_n, \\{q_{i,n}\\})$ and $\\sigma_{n+1} = \\sigma(\\varepsilon_{n+1}, \\{q_{i,n+1}\\})$. The trapezoidal rule provides such an approximation:\n$$\n\\Delta W \\approx \\frac{\\sigma_n + \\sigma_{n+1}}{2} (\\varepsilon_{n+1} - \\varepsilon_n)\n$$\nCombining these components, the discrete dissipation increment is constructed as:\n$$\n\\Delta\\mathcal{D} = \\frac{\\sigma_n + \\sigma_{n+1}}{2} (\\varepsilon_{n+1} - \\varepsilon_n) - \\Delta\\Psi\n$$\nThe rejection rule is straightforward: any proposed update from state $(\\varepsilon_n, \\{q_{i,n}\\})$ to $(\\varepsilon_{n+1}, \\{q_{i,n+1}\\})$ is rejected if it results in a negative discrete dissipation, i.e., if $\\Delta\\mathcal{D}  0$. Otherwise, the update is accepted as thermodynamically consistent.\n\nThe complete algorithm for the verification procedure is as follows:\n$1$. Given the material parameters $E_\\infty$, $\\{E_i\\}_{i=1}^N$, the state at time $t_n$ ($\\varepsilon_n$, $\\{q_{i,n}\\}$), and the proposed state at time $t_{n+1}$ ($\\varepsilon_{n+1}$, $\\{q_{i,n+1}\\}$).\n\n$2$. Calculate the stress $\\sigma_n$ and free energy $\\Psi_n$ at time $t_n$ using their definitions:\n$$\n\\sigma_n = E_\\infty \\varepsilon_n + \\sum_{i=1}^N E_i \\big(\\varepsilon_n - q_{i,n}\\big)\n$$\n$$\n\\Psi_n = \\tfrac{1}{2} E_\\infty \\varepsilon_n^2 + \\sum_{i=1}^N \\tfrac{1}{2} E_i \\big(\\varepsilon_n - q_{i,n}\\big)^2\n$$\n\n$3$. Calculate the stress $\\sigma_{n+1}$ and free energy $\\Psi_{n+1}$ at time $t_{n+1}$ using the proposed state variables:\n$$\n\\sigma_{n+1} = E_\\infty \\varepsilon_{n+1} + \\sum_{i=1}^N E_i \\big(\\varepsilon_{n+1} - q_{i,n+1}\\big)\n$$\n$$\n\\Psi_{n+1} = \\tfrac{1}{2} E_\\infty \\varepsilon_{n+1}^2 + \\sum_{i=1}^N \\tfrac{1}{2} E_i \\big(\\varepsilon_{n+1} - q_{i,n+1}\\big)^2\n$$\n\n$4$. Compute the change in strain $\\Delta\\varepsilon = \\varepsilon_{n+1} - \\varepsilon_n$ and the change in free energy $\\Delta\\Psi = \\Psi_{n+1} - \\Psi_n$.\n\n$5$. Calculate the discrete dissipation increment $\\Delta\\mathcal{D}$:\n$$\n\\Delta\\mathcal{D} = \\frac{\\sigma_n + \\sigma_{n+1}}{2} \\Delta\\varepsilon - \\Delta\\Psi\n$$\n\n$6$. Determine if the update is acceptable by checking the sign of $\\Delta\\mathcal{D}$. The update is accepted if $\\Delta\\mathcal{D} \\ge 0$ and rejected otherwise. This procedure is implemented for each provided test case.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem by iterating through test cases and verifying\n    the thermodynamic consistency of each proposed update.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: Single branch, increasing strain (general case)\n        {\n            \"E_inf\": 1.2e9, \"E\": np.array([0.8e9]), \"tau\": np.array([0.5]),\n            \"dt\": 0.1, \"eps_n\": 0.0, \"eps_n1\": 0.001,\n            \"q_n\": np.array([0.0]), \"q_n1_rule\": \"standard_exp\"\n        },\n        # Case 2: Single branch, no change (boundary case)\n        {\n            \"E_inf\": 0.5e9, \"E\": np.array([0.5e9]), \"tau\": np.array([0.2]),\n            \"dt\": 0.1, \"eps_n\": 0.0005, \"eps_n1\": 0.0005,\n            \"q_n\": np.array([0.0003]), \"q_n1\": np.array([0.0003])\n        },\n        # Case 3: Single branch, violation case\n        {\n            \"E_inf\": 0.5e9, \"E\": np.array([0.5e9]), \"tau\": np.array([0.2]),\n            \"dt\": 0.1, \"eps_n\": 0.0005, \"eps_n1\": 0.0005,\n            \"q_n\": np.array([0.0005]), \"q_n1\": np.array([0.0])\n        },\n        # Case 4: Two branches, decreasing strain (multi-branch case)\n        {\n            \"E_inf\": 1.0e9, \"E\": np.array([0.6e9, 0.4e9]), \"tau\": np.array([0.4, 0.05]),\n            \"dt\": 0.02, \"eps_n\": 0.001, \"eps_n1\": 0.0007,\n            \"q_n\": np.array([0.0008, 0.0005]), \"q_n1_rule\": \"standard_exp\"\n        }\n    ]\n\n    def _calculate_stress(eps, q, E_inf, E_vec):\n        \"\"\"Calculates the Cauchy stress for a given state.\"\"\"\n        branch_stress_sum = np.sum(E_vec * (eps - q))\n        return E_inf * eps + branch_stress_sum\n\n    def _calculate_free_energy(eps, q, E_inf, E_vec):\n        \"\"\"Calculates the free energy density for a given state.\"\"\"\n        eq_energy = 0.5 * E_inf * eps**2\n        branch_energy_sum = np.sum(0.5 * E_vec * (eps - q)**2)\n        return eq_energy + branch_energy_sum\n    \n    def _propose_q_n1(q_n, eps_n1, tau, dt):\n        \"\"\"Calculates the proposed internal variable update.\"\"\"\n        exp_term = np.exp(-dt / tau)\n        return q_n * exp_term + eps_n1 * (1.0 - exp_term)\n\n    results = []\n    for case in test_cases:\n        # Unpack case parameters\n        E_inf = case[\"E_inf\"]\n        E_vec = case[\"E\"]\n        eps_n = case[\"eps_n\"]\n        eps_n1 = case[\"eps_n1\"]\n        q_n = case[\"q_n\"]\n\n        # Determine the proposed q_n+1\n        if \"q_n1_rule\" in case and case[\"q_n1_rule\"] == \"standard_exp\":\n            tau = case[\"tau\"]\n            dt = case[\"dt\"]\n            q_n1 = _propose_q_n1(q_n, eps_n1, tau, dt)\n        else:\n            q_n1 = case[\"q_n1\"]\n\n        # Calculate stress and free energy at time t_n\n        sigma_n = _calculate_stress(eps_n, q_n, E_inf, E_vec)\n        psi_n = _calculate_free_energy(eps_n, q_n, E_inf, E_vec)\n        \n        # Calculate stress and free energy at time t_{n+1}\n        sigma_n1 = _calculate_stress(eps_n1, q_n1, E_inf, E_vec)\n        psi_n1 = _calculate_free_energy(eps_n1, q_n1, E_inf, E_vec)\n        \n        # Calculate changes over the time step\n        delta_eps = eps_n1 - eps_n\n        delta_psi = psi_n1 - psi_n\n        \n        # Calculate trapezoidal work increment\n        work_increment = (sigma_n + sigma_n1) / 2.0 * delta_eps\n        \n        # Calculate the discrete dissipation increment\n        delta_dissipation = work_increment - delta_psi\n        \n        # Perform the rejection check\n        is_acceptable = delta_dissipation >= 0.0\n        results.append(is_acceptable)\n\n    # Format the final output as a comma-separated list of booleans\n    # in square brackets, with no spaces. `str(r)` is used because\n    # `np.bool_` string representation is 'True', which is correct.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Rate-independent plasticity presents a significant numerical challenge due to the non-smooth transition between elastic and plastic behavior, which can cause standard solvers to fail. This advanced practice introduces a powerful and robust technique called homotopy continuation to bridge this gap. You will implement a method that starts with an easy-to-solve regularized viscoplastic model and incrementally transforms it into the desired rate-independent case, illustrating a sophisticated strategy for initializing and solving highly nonlinear constitutive equations .",
            "id": "3544019",
            "problem": "Consider a one-dimensional small-strain elastoplastic material with linear isotropic hardening, modeled within the framework of algorithmic updates for internal variable models. Let the total strain be decomposed as $ \\varepsilon = \\varepsilon^{e} + \\varepsilon^{p} $, where $ \\varepsilon^{e} $ is the elastic strain and $ \\varepsilon^{p} $ is the plastic strain. The Cauchy stress is given by Hooke's law $ \\sigma = E \\, \\varepsilon^{e} $, where $ E $ is the Young's modulus (in $\\mathrm{Pa}$). The internal variable is chosen as the accumulated plastic strain $ \\alpha = \\varepsilon^{p} $, with linear isotropic hardening characterized by $ H $ (in $\\mathrm{Pa}$) and initial yield stress $ \\sigma_{y0} $ (in $\\mathrm{Pa}$). The yield function is $f(\\sigma,\\alpha) = \\sigma - (\\sigma_{y0} + H \\alpha)$, assuming monotonic tension so that $ \\sigma \\ge 0 $ and the absolute value is not required.\n\nTo regularize and enable homotopy from viscous to rate-independent plasticity, consider a Perzyna-type viscoplastic update with an overstress parameter $ \\eta $ (in $ \\mathrm{s} $), and a backward Euler time discretization over a step of duration $ \\Delta t = 1 $ (in $ \\mathrm{s} $). The discrete plastic increment is $ \\Delta \\gamma \\ge 0 $ such that $ \\varepsilon^{p}_{n+1} = \\varepsilon^{p}_{n} + \\Delta \\gamma $ and $ \\alpha_{n+1} = \\varepsilon^{p}_{n+1} $. The trial stress is $ \\sigma_{\\mathrm{trial}} = E \\left( \\varepsilon_{n} + \\Delta \\varepsilon - \\varepsilon^{p}_{n} \\right) $, where $ \\varepsilon_{n} $ is the previous total strain, $ \\Delta \\varepsilon $ is the strain increment over the step, and $ \\varepsilon^{p}_{n} $ is the previous plastic strain. Define the trial overstress relative to the current yield surface as $ r_{\\mathrm{trial}} = \\sigma_{\\mathrm{trial}} - \\left( \\sigma_{y0} + H \\alpha_{n} \\right) $.\n\nThe backward Euler discretization of the Perzyna rule with exponent $ m = 1 $ yields the scalar implicit update\n$$\n\\Delta \\gamma = \\frac{\\Delta t}{\\eta} \\, \\left\\langle f_{n+1} \\right\\rangle = \\frac{1}{\\eta} \\, \\max\\left( r_{\\mathrm{trial}} - (E+H)\\Delta \\gamma, \\, 0 \\right),\n$$\nwith $ f_{n+1} = \\sigma_{n+1} - \\left( \\sigma_{y0} + H \\alpha_{n+1} \\right) $ and $ \\sigma_{n+1} = \\sigma_{\\mathrm{trial}} - E \\Delta \\gamma $. In the viscous regime with $ \\eta > 0 $, the update is well-posed. In the rate-independent limit $ \\eta \\to 0^{+} $, the plastic increment satisfies the classical consistency form $ \\Delta \\gamma = \\max(r_{\\mathrm{trial}}, 0)/(E+H) $.\n\nYour task is to create a homotopy continuation with respect to $ \\eta $, transitioning from a viscous state ($ \\eta $ large) to the rate-independent state ($ \\eta = 0 $), using the previous $ \\eta $-step solution as the initial guess to initialize difficult steps. For each test case, compute and report the path $ \\alpha_{n+1}(\\eta) $ over a specified sequence of $ \\eta $ values. You must implement a robust solver for the scalar nonlinear equation in $ \\Delta \\gamma $ at each $ \\eta > 0 $ using Newton's method on the piecewise residual\n$$\nR(\\Delta \\gamma; \\eta) = \\Delta \\gamma - \\frac{1}{\\eta} \\, \\max\\left( r_{\\mathrm{trial}} - (E+H)\\Delta \\gamma, \\, 0 \\right),\n$$\nwith derivative chosen consistently with the active branch. At $ \\eta = 0 $, use the rate-independent limit $ \\Delta \\gamma = \\max(r_{\\mathrm{trial}},0)/(E+H) $.\n\nAll physical quantities must be treated with their appropriate units: $ E $ and $ H $ in $ \\mathrm{Pa} $, $ \\sigma_{y0} $ in $ \\mathrm{Pa} $, $ \\eta $ in $ \\mathrm{s} $, $ \\varepsilon $, $ \\varepsilon^{p} $, and $ \\alpha $ are dimensionless strains. The final reported $ \\alpha_{n+1}(\\eta) $ values must be dimensionless.\n\nTest Suite:\nUse the following material parameters common to metals for all tests: $ E = 200 \\times 10^{9} \\, \\mathrm{Pa} $, $ H = 1 \\times 10^{9} \\, \\mathrm{Pa} $, $ \\sigma_{y0} = 250 \\times 10^{6} \\, \\mathrm{Pa} $, $ \\Delta t = 1 \\, \\mathrm{s} $. For each test, compute $ \\alpha_{n+1}(\\eta) $ over the homotopy sequence $ \\eta \\in \\{ 10^3, 10^2, 10^1, 10^0, 10^{-1}, 10^{-2}, 0 \\} $ (in $ \\mathrm{s} $), where the last $ \\eta = 0 $ denotes the rate-independent limit.\n\n- Test $ 1 $ (strictly elastic): $ \\varepsilon_{n} = 0 $, $ \\varepsilon^{p}_{n} = 0 $, $ \\Delta \\varepsilon = 0.001 $. This yields $ \\sigma_{\\mathrm{trial}} = 200 \\times 10^{6} \\, \\mathrm{Pa} $ and $ r_{\\mathrm{trial}}  0 $.\n- Test $ 2 $ (at yield boundary): $ \\varepsilon_{n} = 0 $, $ \\varepsilon^{p}_{n} = 0 $, $ \\Delta \\varepsilon = \\sigma_{y0}/E = 0.00125 $. This yields $ r_{\\mathrm{trial}} = 0 $.\n- Test $ 3 $ (moderately plastic): $ \\varepsilon_{n} = 0 $, $ \\varepsilon^{p}_{n} = 0 $, $ \\Delta \\varepsilon = 0.002 $. This yields $ r_{\\mathrm{trial}}  0 $.\n- Test $ 4 $ (strongly plastic): $ \\varepsilon_{n} = 0 $, $ \\varepsilon^{p}_{n} = 0 $, $ \\Delta \\varepsilon = 0.005 $. This yields $ r_{\\mathrm{trial}} \\gg 0 $.\n\nRequired Output:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. For each of the four test cases, output the list of $ \\alpha_{n+1}(\\eta) $ values corresponding to the ordered $ \\eta $ sequence $ \\{ 10^3, 10^2, 10^1, 10^0, 10^{-1}, 10^{-2}, 0 \\} $. Hence the final output format must be\n$$\n\\text{[ [a_{1,1}, a_{1,2}, \\dots, a_{1,7}], [a_{2,1}, \\dots, a_{2,7}], [a_{3,1}, \\dots, a_{3,7}], [a_{4,1}, \\dots, a_{4,7}] ]}\n$$\nwhere each $ a_{i,j} $ is a dimensionless float representing $ \\alpha_{n+1}(\\eta_{j}) $ for test $ i $.",
            "solution": "We start from the small-strain one-dimensional kinematics $ \\varepsilon = \\varepsilon^{e} + \\varepsilon^{p} $, and Hooke's law $ \\sigma = E \\, \\varepsilon^{e} $, where $ E $ is the Young's modulus. The internal variable for isotropic hardening is chosen as $ \\alpha = \\varepsilon^{p} $, and the yield function in monotonic tension is $ f(\\sigma,\\alpha) = \\sigma - (\\sigma_{y0} + H \\alpha) $, with $ \\sigma_{y0} $ the initial yield stress and $ H $ the linear hardening modulus.\n\nConsider the discrete update from step $ n $ to step $ n+1 $ over duration $ \\Delta t = 1 $. Define the trial stress, under the assumption of known previous total strain $ \\varepsilon_{n} $ and strain increment $ \\Delta \\varepsilon $, as\n$$\n\\sigma_{\\mathrm{trial}} = E \\left( \\varepsilon_{n} + \\Delta \\varepsilon - \\varepsilon^{p}_{n} \\right).\n$$\nThe updated plastic strain is $ \\varepsilon^{p}_{n+1} = \\varepsilon^{p}_{n} + \\Delta \\gamma $ with $ \\Delta \\gamma \\ge 0 $. The updated stress then is\n$$\n\\sigma_{n+1} = E \\left( \\varepsilon_{n} + \\Delta \\varepsilon - \\varepsilon^{p}_{n+1} \\right) = \\sigma_{\\mathrm{trial}} - E \\Delta \\gamma.\n$$\nThe updated internal variable is $ \\alpha_{n+1} = \\varepsilon^{p}_{n+1} = \\alpha_{n} + \\Delta \\gamma $. The updated yield function is\n$$\nf_{n+1} = \\sigma_{n+1} - \\left( \\sigma_{y0} + H \\alpha_{n+1} \\right) = \\sigma_{\\mathrm{trial}} - E \\Delta \\gamma - \\left( \\sigma_{y0} + H \\alpha_{n} + H \\Delta \\gamma \\right).\n$$\nGroup terms to define the trial overstress relative to the current yield surface,\n$$\nr_{\\mathrm{trial}} := \\sigma_{\\mathrm{trial}} - \\left( \\sigma_{y0} + H \\alpha_{n} \\right),\n$$\nso that the updated yield function reads\n$$\nf_{n+1} = r_{\\mathrm{trial}} - (E+H) \\Delta \\gamma.\n$$\n\nFor viscoplasticity using the Perzyna-type overstress regularization with exponent $ m = 1 $ and overstress parameter $ \\eta $, the backward Euler discretization (with $ \\Delta t = 1 $) yields the implicit scalar equation\n$$\n\\Delta \\gamma = \\frac{1}{\\eta} \\, \\left\\langle f_{n+1} \\right\\rangle = \\frac{1}{\\eta} \\, \\max\\left( r_{\\mathrm{trial}} - (E+H)\\Delta \\gamma, \\, 0 \\right).\n$$\nDefine the residual for Newton's method,\n$$\nR(\\Delta \\gamma; \\eta) = \\Delta \\gamma - \\frac{1}{\\eta} \\, \\max\\left( r_{\\mathrm{trial}} - (E+H)\\Delta \\gamma, \\, 0 \\right).\n$$\nThere are two regimes:\n\n- If $ r_{\\mathrm{trial}} \\le 0 $, the elastic regime, then $ \\left\\langle f_{n+1} \\right\\rangle = 0 $, and the only admissible solution is $ \\Delta \\gamma = 0 $, hence $ \\alpha_{n+1} = \\alpha_{n} $ for any $ \\eta \\ge 0 $.\n\n- If $ r_{\\mathrm{trial}} > 0 $, the plastic regime, then the solution must satisfy $ r_{\\mathrm{trial}} - (E+H)\\Delta \\gamma > 0 $ at convergence (because otherwise the right-hand side of the equation would be zero and falsely enforce $ \\Delta \\gamma = 0 $). On this active branch, the residual simplifies to a linear form,\n$$\nR(\\Delta \\gamma; \\eta) = \\Delta \\gamma - \\frac{1}{\\eta} \\left( r_{\\mathrm{trial}} - (E+H)\\Delta \\gamma \\right) = \\Delta \\gamma \\left( 1 + \\frac{E+H}{\\eta} \\right) - \\frac{r_{\\mathrm{trial}}}{\\eta}.\n$$\nSetting $ R = 0 $ yields the unique solution for $ \\eta > 0 $,\n$$\n\\Delta \\gamma(\\eta) = \\frac{r_{\\mathrm{trial}}}{\\eta + E + H}.\n$$\nOne may verify consistency: substituting back gives $ f_{n+1} = r_{\\mathrm{trial}} - (E+H)\\Delta \\gamma = r_{\\mathrm{trial}} \\left( \\frac{\\eta}{\\eta + E + H} \\right) > 0 $, as required for $ r_{\\mathrm{trial}} > 0 $ and $ \\eta > 0 $. As $ \\eta \\to 0^{+} $, the rate-independent limit becomes\n$$\n\\Delta \\gamma(0) = \\frac{r_{\\mathrm{trial}}}{E+H},\n$$\nwhich is the classical return-mapping update for linear isotropic hardening in one dimension.\n\nHence, the path of the internal variable $ \\alpha_{n+1}(\\eta) $ is\n$$\n\\alpha_{n+1}(\\eta) =\n\\begin{cases}\n\\alpha_{n},  r_{\\mathrm{trial}} \\le 0, \\\\\n\\alpha_{n} + \\dfrac{r_{\\mathrm{trial}}}{\\eta + E + H},  r_{\\mathrm{trial}}  0,\\; \\eta  0, \\\\\n\\alpha_{n} + \\dfrac{r_{\\mathrm{trial}}}{E + H},  r_{\\mathrm{trial}}  0,\\; \\eta = 0.\n\\end{cases}\n$$\nThis path is monotone decreasing with respect to $ \\eta $ for $ r_{\\mathrm{trial}} > 0 $, because the denominator $ \\eta + E + H $ increases with $ \\eta $, while for $ r_{\\mathrm{trial}} \\le 0 $ the path is constant.\n\nHomotopy continuation algorithm:\nWe proceed from a large $ \\eta $ value in the viscous regime to the rate-independent limit $ \\eta = 0 $, using the solution at the previous $ \\eta $ step as the initial guess for Newton's method. For $ \\eta > 0 $, the residual on the active branch has derivative\n$$\n\\frac{\\partial R}{\\partial \\Delta \\gamma} =\n\\begin{cases}\n1,  r_{\\mathrm{trial}} - (E+H)\\Delta \\gamma \\le 0, \\\\\n1 + \\dfrac{E+H}{\\eta},  r_{\\mathrm{trial}} - (E+H)\\Delta \\gamma  0,\n\\end{cases}\n$$\nwhich ensures that Newton's method converges in a single iteration in the active branch because the residual is linear in $ \\Delta \\gamma $. Nevertheless, we implement Newton's method robustly and guard the branch condition by evaluating the max operator explicitly. At $ \\eta = 0 $, we use the explicit rate-independent limit $ \\Delta \\gamma = \\max(r_{\\mathrm{trial}},0)/(E+H) $.\n\nTest suite specification and units:\nFor all tests, use $ E = 200 \\times 10^{9} \\, \\mathrm{Pa} $, $ H = 1 \\times 10^{9} \\, \\mathrm{Pa} $, $ \\sigma_{y0} = 250 \\times 10^{6} \\, \\mathrm{Pa} $, $ \\Delta t = 1 \\, \\mathrm{s} $. The strain variables $ \\varepsilon $, $ \\varepsilon^{p} $, and $ \\alpha $ are dimensionless; the reported $ \\alpha_{n+1}(\\eta) $ values must be dimensionless. The sequence of homotopy parameters is $ \\eta \\in \\{ 10^{3}, 10^{2}, 10^{1}, 10^{0}, 10^{-1}, 10^{-2}, 0 \\} $ in $ \\mathrm{s} $.\n\nFor the four tests:\n- Test $ 1 $: $ \\varepsilon_{n} = 0 $, $ \\varepsilon^{p}_{n} = 0 $, $ \\Delta \\varepsilon = 0.001 $ gives $ \\sigma_{\\mathrm{trial}} = 200 \\times 10^{6} \\, \\mathrm{Pa} $ and $ r_{\\mathrm{trial}} = -50 \\times 10^{6} \\, \\mathrm{Pa} \\le 0 $, so $ \\alpha_{n+1}(\\eta) = 0 $ for all $ \\eta $.\n- Test $ 2 $: $ \\varepsilon_{n} = 0 $, $ \\varepsilon^{p}_{n} = 0 $, $ \\Delta \\varepsilon = \\sigma_{y0}/E = 0.00125 $ yields $ r_{\\mathrm{trial}} = 0 $, so $ \\alpha_{n+1}(\\eta) = 0 $ for all $ \\eta $.\n- Test $ 3 $: $ \\varepsilon_{n} = 0 $, $ \\varepsilon^{p}_{n} = 0 $, $ \\Delta \\varepsilon = 0.002 $ gives $ \\sigma_{\\mathrm{trial}} = 400 \\times 10^{6} \\, \\mathrm{Pa} $, $ r_{\\mathrm{trial}} = 150 \\times 10^{6} \\, \\mathrm{Pa}  0 $, so $ \\alpha_{n+1}(\\eta) = \\dfrac{150 \\times 10^{6}}{\\eta + 201 \\times 10^{9}} $.\n- Test $ 4 $: $ \\varepsilon_{n} = 0 $, $ \\varepsilon^{p}_{n} = 0 $, $ \\Delta \\varepsilon = 0.005 $ gives $ \\sigma_{\\mathrm{trial}} = 1 \\times 10^{9} \\, \\mathrm{Pa} $, $ r_{\\mathrm{trial}} = 750 \\times 10^{6} \\, \\mathrm{Pa}  0 $, so $ \\alpha_{n+1}(\\eta) = \\dfrac{750 \\times 10^{6}}{\\eta + 201 \\times 10^{9}} $.\n\nThe program will implement the homotopy continuation and Newton's method for completeness, even though the closed-form solution is available; it will compute and output the lists $ \\left[ \\alpha_{n+1}(10^{3}), \\alpha_{n+1}(10^{2}), \\alpha_{n+1}(10^{1}), \\alpha_{n+1}(10^{0}), \\alpha_{n+1}(10^{-1}), \\alpha_{n+1}(10^{-2}), \\alpha_{n+1}(0) \\right] $ for each test in the specified format.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve_delta_gamma(r_trial: float, E: float, H: float, eta: float, init_gamma: float = 0.0, tol: float = 1e-16, max_iter: int = 25) - float:\n    \"\"\"\n    Solve the scalar viscoplastic update for Delta gamma using Newton's method on:\n        R(gamma; eta) = gamma - (1/eta) * max(r_trial - (E+H)*gamma, 0) = 0  for eta  0.\n    For eta == 0, return the rate-independent limit gamma = max(r_trial, 0)/(E+H).\n    \"\"\"\n    if r_trial = 0.0:\n        # Elastic: no plastic increment for any eta.\n        return 0.0\n    if eta == 0.0:\n        # Rate-independent limit.\n        return r_trial / (E + H)\n\n    gamma = max(init_gamma, 0.0)\n    for _ in range(max_iter):\n        # Evaluate residual with the max operator.\n        arg = r_trial - (E + H) * gamma\n        pos_part = arg if arg  0.0 else 0.0\n        R = gamma - (pos_part / eta)\n        # Derivative depends on the active branch.\n        if arg  0.0:\n            dR = 1.0 + (E + H) / eta\n        else:\n            dR = 1.0\n        # Newton update\n        delta = -R / dR\n        gamma += delta\n        # Safeguards: gamma must be nonnegative\n        if gamma  0.0:\n            gamma = 0.0\n        # Convergence check\n        if abs(delta)  tol:\n            break\n    # Final projection to active branch if needed\n    if r_trial - (E + H) * gamma = 0.0:\n        # If we fell into the inactive branch, the correct solution is gamma = 0\n        # but since r_trial  0 for entering this function, the active solution exists.\n        # To ensure robustness, use the closed form.\n        gamma = r_trial / (eta + E + H)\n    return gamma\n\ndef compute_alpha_path(E: float, H: float, sigma_y0: float, eps_n: float, eps_p_n: float, delta_eps: float, eta_values: list[float]) - list[float]:\n    \"\"\"\n    Compute alpha_{n+1}(eta) along a homotopy path of eta values, using continuation:\n    previous solution as initial guess for the next eta.\n    \"\"\"\n    sigma_trial = E * (eps_n + delta_eps - eps_p_n)\n    r_trial = sigma_trial - (sigma_y0 + H * eps_p_n)\n    alpha_n = eps_p_n\n    path = []\n    prev_gamma = 0.0\n    for eta in eta_values:\n        gamma = solve_delta_gamma(r_trial, E, H, eta, init_gamma=prev_gamma)\n        alpha_np1 = alpha_n + gamma\n        path.append(alpha_np1)\n        prev_gamma = gamma\n    return path\n\ndef solve():\n    # Material parameters (SI units)\n    E = 200.0e9      # Pa\n    H = 1.0e9        # Pa\n    sigma_y0 = 250.0e6  # Pa\n    # Homotopy eta values (s), including the rate-independent limit represented by 0\n    eta_values = [1e3, 1e2, 1e1, 1e0, 1e-1, 1e-2, 0.0]\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (eps_n, eps_p_n, delta_eps) for each test\n        (0.0, 0.0, 0.001),          # Test 1: strictly elastic\n        (0.0, 0.0, sigma_y0 / E),   # Test 2: at yield boundary\n        (0.0, 0.0, 0.002),          # Test 3: moderately plastic\n        (0.0, 0.0, 0.005),          # Test 4: strongly plastic\n    ]\n\n    results = []\n    for eps_n, eps_p_n, delta_eps in test_cases:\n        path = compute_alpha_path(E, H, sigma_y0, eps_n, eps_p_n, delta_eps, eta_values)\n        # Convert to regular Python floats for printing\n        results.append([float(x) for x in path])\n\n    # Final print statement in the exact required format.\n    # Single line: nested lists for the four test cases.\n    def format_list(lst):\n        return \"[\" + \",\".join(f\"{x:.12g}\" for x in lst) + \"]\"\n    print(\"[\" + \",\".join(format_list(r) for r in results) + \"]\")\n\nsolve()\n```"
        }
    ]
}