{
    "hands_on_practices": [
        {
            "introduction": "Understanding the geometric and mathematical relationship between different yield criteria is a cornerstone of solid mechanics. This first exercise challenges you to move beyond qualitative descriptions by analytically comparing the Tresca and Hencky-von Mises criteria under plane stress conditions . By deriving the maximum deviation when one is used to approximate the other, you will gain a quantitative appreciation for their differences and the contexts in which such an approximation is valid.",
            "id": "3610540",
            "problem": "Consider isotropic, pressure-insensitive plasticity in computational solid mechanics under plane stress with principal stresses $(\\sigma_1, \\sigma_2, 0)$. The Tresca yield condition is defined in terms of principal stresses as the onset of yield when the maximum difference between principal stresses equals the uniaxial tensile yield stress $\\sigma_y$. The Hencky–von Mises (also called $J_2$) yield condition is defined as the onset of yield when $\\sqrt{3 J_2} = \\sigma_y$, where $J_2$ is the second invariant of the deviatoric stress tensor.\n\nSuppose you approximate Tresca by Hencky–von Mises and calibrate both criteria to match the same uniaxial tensile yield stress $\\sigma_y$. For a fixed biaxial stress direction $(\\sigma_1, \\sigma_2, 0)$, define $t_T$ and $t_V$ as the positive scalar multipliers such that $t_T(\\sigma_1, \\sigma_2, 0)$ lies on the Tresca yield surface and $t_V(\\sigma_1, \\sigma_2, 0)$ lies on the Hencky–von Mises yield surface. Define the relative deviation of the von Mises approximation with respect to Tresca along that direction by\n$$\n\\delta(\\sigma_1, \\sigma_2) = \\frac{|t_V(\\sigma_1, \\sigma_2, 0) - t_T(\\sigma_1, \\sigma_2, 0)|}{t_T(\\sigma_1, \\sigma_2, 0)}.\n$$\nStarting from the core definitions of the Tresca and $J_2$ yield criteria and the definition of the second deviatoric invariant $J_2$ in terms of principal stresses, derive the expression for $\\delta(\\sigma_1, \\sigma_2)$ and determine its maximum value over all biaxial directions $(\\sigma_1, \\sigma_2)$ in plane stress. Express your final answer as a closed-form analytic expression. Do not round.",
            "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, and objective.\n\n### Step 1: Extract Givens\n-   **Physics Context**: Isotropic, pressure-insensitive plasticity in computational solid mechanics.\n-   **Stress State**: Plane stress, with principal stresses $(\\sigma_1, \\sigma_2, \\sigma_3)$ where $\\sigma_3=0$.\n-   **Tresca Yield Condition**: The onset of yield occurs when the maximum shear stress reaches a critical value. In terms of principal stresses, this is expressed as $\\max(|\\sigma_i - \\sigma_j|) = \\sigma_y$, where $\\sigma_y$ is the uniaxial tensile yield stress. For plane stress, this becomes $\\max(|\\sigma_1 - \\sigma_2|, |\\sigma_2 - 0|, |0 - \\sigma_1|) = \\sigma_y$, which simplifies to $\\max(|\\sigma_1 - \\sigma_2|, |\\sigma_1|, |\\sigma_2|) = \\sigma_y$.\n-   **Hencky–von Mises Yield Condition**: The onset of yield occurs when the second invariant of the deviatoric stress tensor, $J_2$, satisfies $\\sqrt{3 J_2} = \\sigma_y$.\n-   **Second Deviatoric Invariant ($J_2$)**: In terms of principal stresses, $J_2 = \\frac{1}{6}[(\\sigma_1 - \\sigma_2)^2 + (\\sigma_2 - \\sigma_3)^2 + (\\sigma_3 - \\sigma_1)^2]$.\n-   **Calibration**: Both criteria are calibrated to the same uniaxial tensile yield stress $\\sigma_y$.\n-   **Scalar Multipliers**: For a given biaxial stress direction $(\\sigma_1, \\sigma_2, 0)$, $t_T$ is the positive scalar such that the stress state $t_T(\\sigma_1, \\sigma_2, 0)$ lies on the Tresca yield surface. Similarly, $t_V$ is the positive scalar for the Hencky–von Mises yield surface.\n-   **Relative Deviation**: The deviation is defined as $\\delta(\\sigma_1, \\sigma_2) = \\frac{|t_V(\\sigma_1, \\sigma_2, 0) - t_T(\\sigma_1, \\sigma_2, 0)|}{t_T(\\sigma_1, \\sigma_2, 0)}$.\n-   **Objective**: Derive the expression for $\\delta(\\sigma_1, \\sigma_2)$ and determine its maximum value over all biaxial directions.\n\n### Step 2: Validate Using Extracted Givens\n-   **Scientifically Grounded**: The problem is a standard, fundamental comparison of two widely used yield criteria in the theory of plasticity. The definitions of Tresca and von Mises criteria, plane stress, and $J_2$ are all correct and based on core principles of continuum mechanics.\n-   **Well-Posed**: The problem is clearly defined. It asks for the maximum value of a well-defined function over the space of all biaxial stress directions. The existence of a unique maximum is expected from the geometric properties of the yield surfaces.\n-   **Objective**: The problem is stated in precise, mathematical language, free from any subjectivity or ambiguity.\n-   **Completeness**: All necessary information and definitions are provided.\nThe problem is therefore deemed **valid**.\n\n### Step 3: Derivation of the Solution\n\n**1. Formulation of Yield Criteria in Plane Stress**\n\nFirst, we write the explicit equations for the two yield surfaces in the principal stress space $(\\sigma_1, \\sigma_2)$ under plane stress conditions ($\\sigma_3 = 0$).\n\nThe **Hencky–von Mises** criterion is $\\sqrt{3 J_2} = \\sigma_y$. Substituting the expression for $J_2$ with $\\sigma_3=0$:\n$$ J_2 = \\frac{1}{6}[(\\sigma_1 - \\sigma_2)^2 + (\\sigma_2 - 0)^2 + (0 - \\sigma_1)^2] = \\frac{1}{6}[(\\sigma_1^2 - 2\\sigma_1\\sigma_2 + \\sigma_2^2) + \\sigma_2^2 + \\sigma_1^2] = \\frac{1}{3}(\\sigma_1^2 - \\sigma_1\\sigma_2 + \\sigma_2^2) $$\nThe yield condition becomes:\n$$ \\sqrt{3 \\cdot \\frac{1}{3}(\\sigma_1^2 - \\sigma_1\\sigma_2 + \\sigma_2^2)} = \\sigma_y $$\n$$ \\sigma_1^2 - \\sigma_1\\sigma_2 + \\sigma_2^2 = \\sigma_y^2 $$\nThis equation describes an ellipse in the $(\\sigma_1, \\sigma_2)$ plane.\n\nThe **Tresca** criterion for plane stress ($\\sigma_3=0$) is:\n$$ \\max(|\\sigma_1 - \\sigma_2|, |\\sigma_1|, |\\sigma_2|) = \\sigma_y $$\nThis equation describes a hexagon in the $(\\sigma_1, \\sigma_2)$ plane.\n\nThe problem is calibrated for uniaxial tension, e.g., $(\\sigma_1, \\sigma_2) = (\\sigma_y, 0)$.\nFor von Mises: $\\sigma_y^2 - \\sigma_y(0) + 0^2 = \\sigma_y^2$, which is satisfied.\nFor Tresca: $\\max(|\\sigma_y - 0|, |\\sigma_y|, |0|) = \\sigma_y$, which is satisfied.\nThe formulations are consistent with the calibration condition.\n\n**2. Expression for Scalar Multipliers**\n\nConsider an arbitrary stress direction defined by the vector $(\\sigma_1, \\sigma_2)$. The stress state on the yield surface is $t(\\sigma_1, \\sigma_2)$.\n\nFor the von Mises surface, the stress state is $(t_V \\sigma_1, t_V \\sigma_2)$. Substituting this into the von Mises equation:\n$$ (t_V \\sigma_1)^2 - (t_V \\sigma_1)(t_V \\sigma_2) + (t_V \\sigma_2)^2 = \\sigma_y^2 $$\n$$ t_V^2 (\\sigma_1^2 - \\sigma_1\\sigma_2 + \\sigma_2^2) = \\sigma_y^2 $$\nSince $t_V$ is a positive scalar:\n$$ t_V = \\frac{\\sigma_y}{\\sqrt{\\sigma_1^2 - \\sigma_1\\sigma_2 + \\sigma_2^2}} $$\n\nFor the Tresca surface, the stress state is $(t_T \\sigma_1, t_T \\sigma_2)$. Substituting into the Tresca equation:\n$$ \\max(|t_T \\sigma_1 - t_T \\sigma_2|, |t_T \\sigma_1|, |t_T \\sigma_2|) = \\sigma_y $$\nSince $t_T$ is a positive scalar:\n$$ t_T \\max(|\\sigma_1 - \\sigma_2|, |\\sigma_1|, |\\sigma_2|) = \\sigma_y $$\n$$ t_T = \\frac{\\sigma_y}{\\max(|\\sigma_1 - \\sigma_2|, |\\sigma_1|, |\\sigma_2|)} $$\n\n**3. Expression for Relative Deviation**\n\nThe relative deviation $\\delta$ is given by $\\delta = \\frac{|t_V - t_T|}{t_T} = \\left| \\frac{t_V}{t_T} - 1 \\right|$.\nLet's compute the ratio $\\frac{t_V}{t_T}$:\n$$ \\frac{t_V}{t_T} = \\frac{\\frac{\\sigma_y}{\\sqrt{\\sigma_1^2 - \\sigma_1\\sigma_2 + \\sigma_2^2}}}{\\frac{\\sigma_y}{\\max(|\\sigma_1 - \\sigma_2|, |\\sigma_1|, |\\sigma_2|)}} = \\frac{\\max(|\\sigma_1 - \\sigma_2|, |\\sigma_1|, |\\sigma_2|)}{\\sqrt{\\sigma_1^2 - \\sigma_1\\sigma_2 + \\sigma_2^2}} $$\nThe von Mises ellipse circumscribes the Tresca hexagon for plane stress, meaning $t_V \\ge t_T$ for all stress directions. Therefore, the absolute value is not needed for $\\delta$.\n$$ \\delta(\\sigma_1, \\sigma_2) = \\frac{t_V}{t_T} - 1 = \\frac{\\max(|\\sigma_1 - \\sigma_2|, |\\sigma_1|, |\\sigma_2|)}{\\sqrt{\\sigma_1^2 - \\sigma_1\\sigma_2 + \\sigma_2^2}} - 1 $$\n\n**4. Maximization of the Deviation**\n\nTo find the maximum value of $\\delta$, we need to find the maximum value of the ratio $\\frac{t_V}{t_T}$. This ratio represents the ratio of the radial distances from the origin to the von Mises ellipse and the Tresca hexagon. The maximum deviation will occur where the two surfaces are farthest apart. Geometrically, for two convex shapes where one circumscribes the other and they touch at several points (the vertices of the inner polygon), the maximum radial distance ratio occurs at the midpoint of a face of the inner polygon.\n\nLet's analyze the stress state corresponding to the midpoint of one of the hexagon's faces. By symmetry, all faces will yield the same maximum deviation. A state of pure shear under plane stress is represented by principal stresses $\\sigma_1 = k$ and $\\sigma_2 = -k$ for some scalar $k$. This direction, $(\\sigma_1, \\sigma_2)=(k, -k)$, corresponds to a point on a face of the Tresca hexagon.\nLet's analyze the stress direction $(\\sigma_1, \\sigma_2) = (1, -1)$.\n\nFor this direction, the numerator of the ratio $\\frac{t_V}{t_T}$ is:\n$$ \\max(|1 - (-1)|, |1|, |-1|) = \\max(2, 1, 1) = 2 $$\nThe denominator is:\n$$ \\sqrt{1^2 - (1)(-1) + (-1)^2} = \\sqrt{1 + 1 + 1} = \\sqrt{3} $$\nThe ratio for this direction is:\n$$ \\frac{t_V}{t_T} = \\frac{2}{\\sqrt{3}} $$\n\nLet's prove this is the maximum. The problem of maximizing $\\frac{t_V}{t_T}$ is equivalent to maximizing its square, which is easier to handle:\n$$ f(\\sigma_1, \\sigma_2) = \\left(\\frac{t_V}{t_T}\\right)^2 = \\frac{(\\max(|\\sigma_1 - \\sigma_2|, |\\sigma_1|, |\\sigma_2|))^2}{\\sigma_1^2 - \\sigma_1\\sigma_2 + \\sigma_2^2} $$\nLet's check the face of the hexagon defined by $\\sigma_1 - \\sigma_2 = \\sigma_y$ for $\\sigma_1 \\in [0, \\sigma_y]$ and $\\sigma_2 \\in [-\\sigma_y, 0]$. Along this face, a point is of the form $(\\sigma_1, \\sigma_1-\\sigma_y)$, and the Tresca condition is satisfied. The ratio $\\frac{t_V}{t_T}$ at a point $(\\sigma_1, \\sigma_1-\\sigma_y)$ is given by:\n$$ \\frac{t_V}{t_T} = \\frac{\\sigma_y}{\\sqrt{\\sigma_1^2 - \\sigma_1(\\sigma_1-\\sigma_y) + (\\sigma_1-\\sigma_y)^2}} = \\frac{\\sigma_y}{\\sqrt{\\sigma_1^2 - \\sigma_1\\sigma_y + \\sigma_y^2}} $$\nTo maximize this ratio, we must minimize the expression in the denominator's square root: $g(\\sigma_1) = \\sigma_1^2 - \\sigma_1\\sigma_y + \\sigma_y^2$. This is a quadratic in $\\sigma_1$ which has a minimum at $\\frac{dg}{d\\sigma_1} = 2\\sigma_1 - \\sigma_y = 0$, so $\\sigma_1 = \\frac{\\sigma_y}{2}$.\nThis value of $\\sigma_1$ is within the valid range $[0, \\sigma_y]$. At this point, $\\sigma_2 = \\frac{\\sigma_y}{2} - \\sigma_y = -\\frac{\\sigma_y}{2}$.\nThis state $(\\frac{\\sigma_y}{2}, -\\frac{\\sigma_y}{2}, 0)$ is a state of pure shear, and it corresponds to the midpoint of this face of the Tresca hexagon.\nSubstituting $\\sigma_1 = \\frac{\\sigma_y}{2}$ into the ratio expression:\n$$ \\left(\\frac{t_V}{t_T}\\right)_{\\max} = \\frac{\\sigma_y}{\\sqrt{(\\frac{\\sigma_y}{2})^2 - (\\frac{\\sigma_y}{2})\\sigma_y + \\sigma_y^2}} = \\frac{\\sigma_y}{\\sqrt{\\frac{\\sigma_y^2}{4} - \\frac{\\sigma_y^2}{2} + \\sigma_y^2}} = \\frac{\\sigma_y}{\\sqrt{\\frac{3}{4}\\sigma_y^2}} = \\frac{\\sigma_y}{\\frac{\\sqrt{3}}{2}\\sigma_y} = \\frac{2}{\\sqrt{3}} $$\nThis confirms that the maximum value of the ratio occurs at pure shear.\n\n**5. Final Calculation of Maximum Deviation**\n\nThe maximum relative deviation, $\\delta_{\\max}$, is:\n$$ \\delta_{\\max} = \\left(\\frac{t_V}{t_T}\\right)_{\\max} - 1 = \\frac{2}{\\sqrt{3}} - 1 $$\nThis is the final closed-form analytic expression for the maximum deviation.",
            "answer": "$$\n\\boxed{\\frac{2}{\\sqrt{3}} - 1}\n$$"
        },
        {
            "introduction": "Once a material is stressed beyond its elastic limit, we must algorithmically update the stress state to ensure it remains on the evolving yield surface. This practice guides you through the derivation of the return-mapping algorithm, the fundamental computational tool for integrating elastoplastic constitutive models . By working from first principles for the classic $J_2$ plasticity model, you will master the logic behind the \"elastic predictor, plastic corrector\" scheme that underpins modern finite element simulations.",
            "id": "3610544",
            "problem": "A small-strain, rate-independent, associative $J_2$ (von Mises) plasticity model with linear isotropic hardening is used in an incremental return-mapping algorithm. The material has Young’s modulus $E=200\\,\\text{GPa}$, Poisson’s ratio $\\nu=0.3$, initial yield stress $\\sigma_y=300\\,\\text{MPa}$, and constant plastic modulus $H=1\\,\\text{GPa}$. At the beginning of the increment, the state is stress-free and purely elastic, with equivalent plastic strain $\\kappa_n=0$. A strain increment leads to an elastic trial state whose deviatoric Cauchy stress has norm $\\|s^{\\text{tr}}\\|=450\\,\\text{MPa}$. Assume small strains, isotropic linear elasticity, and associative flow with the von Mises yield condition with linear isotropic hardening:\n- Yield function $f(\\sigma,\\kappa)=\\sqrt{\\tfrac{3}{2}}\\|s\\|-\\left(\\sigma_y+H\\,\\kappa\\right)\\le 0$,\n- Flow direction $n=s/\\|s\\|$,\n- Equivalent plastic strain increment $\\Delta\\kappa=\\sqrt{\\tfrac{2}{3}}\\,\\Delta\\lambda$,\nand use the standard consistency condition at yield to determine the plastic multiplier increment $\\Delta\\lambda$ and the updated von Mises equivalent stress $\\sigma_{\\text{eq}}^{n+1}=\\sqrt{\\tfrac{3}{2}}\\|s_{n+1}\\|$.\n\nStart from the definitions above and basic linear elasticity for isotropic materials, where the shear modulus is $G=E/[2(1+\\nu)]$, and the radial return-mapping structure of associative $J_2$ plasticity. Derive the necessary relations from first principles (without quoting any pre-derived algorithmic formulas) and compute:\n- the plastic multiplier increment $\\Delta\\lambda$ (dimensionless),\n- the updated equivalent stress $\\sigma_{\\text{eq}}^{n+1}$ in $\\text{MPa}$.\n\nRound your final numerical values to six significant figures. Express the equivalent stress in $\\text{MPa}$.",
            "solution": "The user has provided a problem in the domain of computational solid mechanics, specifically concerning an incremental update for a $J_2$ plasticity model with linear isotropic hardening. The first step is to validate the problem statement.\n\n### Step 1: Extract Givens\n- **Model Type**: Small-strain, rate-independent, associative $J_2$ (von Mises) plasticity with linear isotropic hardening.\n- **Material Properties**:\n    - Young's modulus, $E=200\\,\\text{GPa}$\n    - Poisson's ratio, $\\nu=0.3$\n    - Initial yield stress, $\\sigma_y=300\\,\\text{MPa}$\n    - Constant plastic modulus (hardening modulus), $H=1\\,\\text{GPa}$\n- **Initial State (at step $n$)**:\n    - Stress-free: $\\sigma_n = 0$\n    - Purely elastic state\n    - Equivalent plastic strain, $\\kappa_n=0$\n- **Trial State (at step $n+1$)**:\n    - Norm of the deviatoric trial stress, $\\|s^{\\text{tr}}\\|=450\\,\\text{MPa}$\n- **Constitutive Definitions**:\n    - Yield function: $f(\\sigma,\\kappa)=\\sqrt{\\tfrac{3}{2}}\\|s\\|-\\left(\\sigma_y+H\\,\\kappa\\right)\\le 0$\n    - Flow direction vector: $n=s/\\|s\\|$\n    - Equivalent plastic strain increment: $\\Delta\\kappa=\\sqrt{\\tfrac{2}{3}}\\,\\Delta\\lambda$\n- **Task**: Compute the plastic multiplier increment $\\Delta\\lambda$ and the updated von Mises equivalent stress $\\sigma_{\\text{eq}}^{n+1}$.\n- **Numerical Precision**: Round final numerical values to six significant figures.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is validated against the specified criteria:\n- **Scientifically Grounded**: The problem is based on the classical theory of rate-independent plasticity, a fundamental topic in solid mechanics. All concepts, such as the von Mises yield criterion, associative flow rule, and the return-mapping algorithm, are well-established scientific principles.\n- **Well-Posed**: The problem is well-posed. It provides sufficient information (material properties, initial state, trial state, and constitutive laws) to determine a unique solution for the plastic multiplier and the updated stress state.\n- **Objective**: The problem is stated in precise, quantitative, and objective language, free of ambiguity or subjective claims.\n- **Complete and Consistent**: All necessary parameters are provided. While the formulation of the flow rule and its relation to the plastic multiplier $\\Delta\\lambda$ is slightly non-standard compared to some textbooks, it is internally consistent, as will be demonstrated in the solution. This requires careful derivation from the provided definitions rather than quoting standard formulas.\n- **Realistic and Feasible**: The material properties are representative of common engineering materials like steel. The stress levels are within a plausible range for plastic deformation to occur. The problem is a standard exercise in computational plasticity.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A detailed, reasoned solution will be provided.\n\n### Derivation and Solution\n\nThe problem requires a derivation from first principles. We are given the result of the elastic predictor step: a trial deviatoric stress $s^{\\text{tr}}$ with norm $\\|s^{\\text{tr}}\\|=450\\,\\text{MPa}$. The total strain increment has been used to compute this trial state under the assumption of pure elasticity. We must first check if this trial state violates the yield condition.\n\n**1. Yield Check**\nThe yield condition is evaluated at the trial state $(\\sigma^{\\text{tr}}, \\kappa_n)$. The trial equivalent stress is:\n$$\n\\sigma_{\\text{eq}}^{\\text{tr}} = \\sqrt{\\frac{3}{2}}\\|s^{\\text{tr}}\\|\n$$\nThe yield stress at the beginning of the increment is:\n$$\n\\sigma_{y,n} = \\sigma_y + H\\kappa_n\n$$\nThe value of the yield function for the trial state is:\n$$\nf^{\\text{tr}} = f(\\sigma^{\\text{tr}}, \\kappa_n) = \\sigma_{\\text{eq}}^{\\text{tr}} - \\sigma_{y,n}\n$$\nIf $f^{\\text{tr}} \\le 0$, the process is elastic, and $\\sigma_{n+1} = \\sigma^{\\text{tr}}$. If $f^{\\text{tr}} > 0$, plastic deformation occurs, and a plastic corrector step (return mapping) is necessary.\n\nFirst, we calculate the required material constants. All stress values will be in $\\text{MPa}$.\n$E = 200\\,\\text{GPa} = 2 \\times 10^5\\,\\text{MPa}$\n$H = 1\\,\\text{GPa} = 1000\\,\\text{MPa}$\nThe shear modulus $G$ is given by:\n$$\nG = \\frac{E}{2(1+\\nu)} = \\frac{2 \\times 10^5\\,\\text{MPa}}{2(1+0.3)} = \\frac{1 \\times 10^5\\,\\text{MPa}}{1.3} \\approx 76923.08\\,\\text{MPa}\n$$\nGiven $\\kappa_n=0$, the initial yield stress for the increment is $\\sigma_{y,n} = \\sigma_y = 300\\,\\text{MPa}$.\nThe trial equivalent stress is:\n$$\n\\sigma_{\\text{eq}}^{\\text{tr}} = \\sqrt{\\frac{3}{2}} (450\\,\\text{MPa}) \\approx 1.22474 \\times 450\\,\\text{MPa} \\approx 551.14\\,\\text{MPa}\n$$\nThe trial yield function value is:\n$$\nf^{\\text{tr}} = 551.14\\,\\text{MPa} - 300\\,\\text{MPa} = 251.14\\,\\text{MPa}\n$$\nSince $f^{\\text{tr}} > 0$, plastic flow occurs.\n\n**2. Plastic Corrector (Return Mapping)**\nThe stress state at the end of the increment, $\\sigma_{n+1}$, must be returned to the updated yield surface. The stress update is given by the elastic law:\n$$\n\\sigma_{n+1} = \\sigma^{\\text{tr}} - \\mathbb{C}:\\Delta\\varepsilon^p\n$$\nwhere $\\mathbb{C}$ is the fourth-order isotropic elasticity tensor and $\\Delta\\varepsilon^p$ is the plastic strain increment. For an isotropic material, the deviatoric part of this equation is:\n$$\ns_{n+1} = s^{\\text{tr}} - 2G \\Delta\\varepsilon^p_d\n$$\nFor $J_2$ plasticity, plastic flow is isochoric (volume-preserving), so the plastic strain is purely deviatoric, $\\Delta\\varepsilon^p = \\Delta\\varepsilon^p_d$.\n\nThe problem specifies an associative flow rule. The gradient of the yield function with respect to stress is $\\frac{\\partial f}{\\partial \\sigma} = \\sqrt{\\frac{3}{2}}\\frac{s}{\\|s\\|} = \\sqrt{\\frac{3}{2}}n$. An associative flow rule has the form $\\Delta\\varepsilon^p = \\Delta\\gamma \\frac{\\partial f}{\\partial \\sigma} = \\Delta\\gamma \\sqrt{\\frac{3}{2}}n$. However, the problem provides specific definitions: the flow direction is $n=s/\\|s\\|$ and the equivalent plastic strain increment is $\\Delta\\kappa = \\sqrt{\\frac{2}{3}}\\Delta\\lambda$. To ensure consistency, we relate these definitions using the principle of plastic work equivalence. The rate of plastic work per unit volume, $\\dot{\\mathcal{W}}^p = \\sigma:\\dot{\\varepsilon}^p$, must equal the rate of energy dissipated through hardening, $(\\sigma_y+H\\kappa)\\dot{\\kappa}$.\nLet's assume the flow rule is of the form $\\dot{\\varepsilon}^p = \\dot{\\lambda}n$. Then $\\sigma:\\dot{\\varepsilon}^p = s:\\dot{\\varepsilon}^p = s:(\\dot{\\lambda}n) = \\dot{\\lambda}s:\\frac{s}{\\|s\\|} = \\dot{\\lambda}\\|s\\|$.\nAt yield, $f=0$, so $\\|s\\| = \\sqrt{\\frac{2}{3}}(\\sigma_y+H\\kappa)$.\nEquating the work rates: $\\dot{\\lambda}\\sqrt{\\frac{2}{3}}(\\sigma_y+H\\kappa) = (\\sigma_y+H\\kappa)\\dot{\\kappa}$.\nThis confirms that $\\dot{\\kappa} = \\sqrt{\\frac{2}{3}}\\dot{\\lambda}$, which upon integration gives $\\Delta\\kappa=\\sqrt{\\frac{2}{3}}\\Delta\\lambda$. Thus, the flow rule consistent with the problem statement is indeed $\\Delta\\varepsilon^p = \\Delta\\lambda n$.\n\nUsing this flow rule, the deviatoric stress update is:\n$$\ns_{n+1} = s^{\\text{tr}} - 2G \\Delta\\lambda n_{n+1} = s^{\\text{tr}} - 2G \\Delta\\lambda \\frac{s_{n+1}}{\\|s_{n+1}\\|}\n$$\nThe key insight of the radial return algorithm is that the direction of the final stress is the same as the trial stress: $n_{n+1} = \\frac{s_{n+1}}{\\|s_{n+1}\\|} = \\frac{s^{\\text{tr}}}{\\|s^{\\text{tr}\\|}}$.\n$$\ns_{n+1} = s^{\\text{tr}} - 2G \\Delta\\lambda \\frac{s^{\\text{tr}}}{\\|s^{\\text{tr}}\\|}\n$$\nTaking the norm of both sides gives the scalar radial return equation:\n$$\n\\|s_{n+1}\\| = \\|s^{\\text{tr}}\\| - 2G \\Delta\\lambda\n$$\nThe final state must satisfy the consistency condition, $f(\\sigma_{n+1}, \\kappa_{n+1}) = 0$:\n$$\n\\sqrt{\\frac{3}{2}}\\|s_{n+1}\\| - (\\sigma_y + H\\kappa_{n+1}) = 0\n$$\nThe updated equivalent plastic strain is $\\kappa_{n+1} = \\kappa_n + \\Delta\\kappa = \\kappa_n + \\sqrt{\\frac{2}{3}}\\Delta\\lambda$.\nSubstituting this into the consistency condition:\n$$\n\\sqrt{\\frac{3}{2}}\\|s_{n+1}\\| = \\sigma_y + H\\left(\\kappa_n + \\sqrt{\\frac{2}{3}}\\Delta\\lambda\\right)\n$$\nWe now have a system of two equations for the two unknowns, $\\|s_{n+1}\\|$ and $\\Delta\\lambda$. Substitute the radial return equation for $\\|s_{n+1}\\|$ into the consistency condition:\n$$\n\\sqrt{\\frac{3}{2}}\\left( \\|s^{\\text{tr}}\\| - 2G \\Delta\\lambda \\right) = \\sigma_y + H\\kappa_n + H\\sqrt{\\frac{2}{3}}\\Delta\\lambda\n$$\nRearrange to solve for $\\Delta\\lambda$:\n$$\n\\sqrt{\\frac{3}{2}}\\|s^{\\text{tr}}\\| - (\\sigma_y + H\\kappa_n) = 2G\\sqrt{\\frac{3}{2}}\\Delta\\lambda + H\\sqrt{\\frac{2}{3}}\\Delta\\lambda\n$$\nThe left side is $f^{\\text{tr}}$.\n$$\nf^{\\text{tr}} = \\Delta\\lambda \\left( \\sqrt{6}G + \\sqrt{\\frac{2}{3}}H \\right)\n$$\nTherefore, the plastic multiplier increment is:\n$$\n\\Delta\\lambda = \\frac{f^{\\text{tr}}}{\\sqrt{6}G + \\sqrt{\\frac{2}{3}}H} = \\frac{\\sqrt{\\frac{3}{2}}\\|s^{\\text{tr}}\\| - (\\sigma_y + H\\kappa_n)}{\\sqrt{6}G + \\sqrt{\\frac{2}{3}}H}\n$$\n\n**3. Numerical Calculation**\nUsing the given values:\n$\\|s^{\\text{tr}}\\| = 450\\,\\text{MPa}$\n$\\sigma_y = 300\\,\\text{MPa}$\n$\\kappa_n = 0$\n$H = 1000\\,\\text{MPa}$\n$G = \\frac{1 \\times 10^5}{1.3}\\,\\text{MPa}$\n\nFirst, calculate the numerator, $f^{\\text{tr}}$:\n$$\nf^{\\text{tr}} = \\sqrt{1.5} \\times 450 - 300 \\approx 551.135192 - 300 = 251.135192\\,\\text{MPa}\n$$\nNext, calculate the denominator:\n$$\n\\sqrt{6}G + \\sqrt{\\frac{2}{3}}H = \\sqrt{6}\\left(\\frac{10^5}{1.3}\\right) + \\sqrt{\\frac{2}{3}}(1000)\n$$\n$$\n\\approx 2.44948974 \\times 76923.076923 + 0.81649658 \\times 1000\n$$\n$$\n\\approx 188411.33 + 816.49658 = 189227.8266\\,\\text{MPa}\n$$\nNow, compute $\\Delta\\lambda$:\n$$\n\\Delta\\lambda = \\frac{251.135192}{189227.8266} \\approx 0.001326965\n$$\nRounding to six significant figures, $\\Delta\\lambda = 0.00132697$.\n\nFinally, compute the updated equivalent stress $\\sigma_{\\text{eq}}^{n+1}$. From the consistency condition, we have:\n$$\n\\sigma_{\\text{eq}}^{n+1} = \\sigma_y + H\\kappa_{n+1} = \\sigma_y + H(\\kappa_n + \\sqrt{\\frac{2}{3}}\\Delta\\lambda)\n$$\n$$\n\\sigma_{\\text{eq}}^{n+1} = 300 + 1000 \\left( 0 + \\sqrt{\\frac{2}{3}} \\times 0.001326965 \\right)\n$$\n$$\n\\sigma_{\\text{eq}}^{n+1} = 300 + 1000 \\times (0.81649658 \\times 0.001326965)\n$$\n$$\n\\sigma_{\\text{eq}}^{n+1} = 300 + 1000 \\times 0.001083552 = 300 + 1.083552 = 301.083552\\,\\text{MPa}\n$$\nRounding to six significant figures, $\\sigma_{\\text{eq}}^{n+1} = 301.084\\,\\text{MPa}$.\n\nThe results are:\n- Plastic multiplier increment $\\Delta\\lambda \\approx 0.00132697$\n- Updated equivalent stress $\\sigma_{\\text{eq}}^{n+1} \\approx 301.084\\,\\text{MPa}$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.00132697 & 301.084\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "While the von Mises model provides a robust starting point, many materials like soils and polymers exhibit pressure-dependent yielding, which can be modeled by the Drucker-Prager criterion. This final practice confronts a critical implementation challenge: the singularity in the flow rule calculation that arises near hydrostatic stress states . Here, you will diagnose this numerical instability and develop a regularized, robust formulation, a crucial skill for creating reliable computational mechanics software.",
            "id": "3610527",
            "problem": "You are asked to derive and implement a robust computational procedure for the flow direction in a Drucker–Prager model near hydrostatic states, where the second deviatoric invariant tends to zero. Begin from fundamental definitions in continuum mechanics. Let the Cauchy stress tensor be denoted by $\\sigma$, the identity tensor by $I$, the trace operator by $\\operatorname{tr}(\\cdot)$, and the deviatoric stress by $s = \\sigma - \\frac{1}{3}\\operatorname{tr}(\\sigma) I$. The first invariant is $I_1 = \\operatorname{tr}(\\sigma)$ and the second invariant of the deviatoric stress is $J_2 = \\frac{1}{2} s : s$, where the colon denotes the double contraction. The Drucker–Prager yield function is $f(\\sigma) = \\sqrt{J_2} + \\alpha I_1 - k$, with $\\alpha \\ge 0$ and $k \\ge 0$.\n\nYour tasks are:\n1. From the above definitions, derive the gradient $\\partial J_2/\\partial \\sigma$ and hence the gradient of $\\sqrt{J_2}$ with respect to $\\sigma$. Identify the algorithmic issue that arises as $J_2 \\to 0$ (which corresponds to near-hydrostatic stress states with $s \\to 0$).\n2. Propose a robust, well-defined formula for $\\partial \\sqrt{J_2} / \\partial \\sigma$ that avoids division by zero and is consistent with the underlying invariance structure. Implement this formula in a program and use it to compute the flow direction $\\partial f/\\partial \\sigma$.\n3. Design checks that demonstrate numerical robustness and mathematical consistency of your implementation near and at hydrostatic states. Specifically, verify that the regularized gradient remains finite and aligned with the deviatoric stress for nearly hydrostatic states and that it reduces correctly at exactly hydrostatic states.\n\nStress values must be treated in megapascals (MPa). Since the gradient $\\partial \\sqrt{J_2} / \\partial \\sigma$ is dimensionless, all reported float outputs must be dimensionless decimals. Angles, if used, must be computed using radians internally; however, the outputs requested below are dimensionless floats or booleans.\n\nImplement a single program that carries out the following test suite and produces the specified outputs:\n\n- Test Case 1 (general non-hydrostatic state): $\\sigma = \\begin{bmatrix}120 & 25 & -5 \\\\ 25 & 90 & 10 \\\\ -5 & 10 & 70\\end{bmatrix}$ MPa, with $\\alpha = 0.1$ and the regularization parameter $\\varepsilon = 10^{-6}$ MPa. Compute the relative Frobenius-norm error between the robust gradient and the exact gradient formula valid for $J_2 > 0$. Output a single float equal to $\\|\\nabla_{\\sigma}^{\\text{rob}}\\sqrt{J_2} - \\nabla_{\\sigma}^{\\text{exact}}\\sqrt{J_2}\\|_F / \\|\\nabla_{\\sigma}^{\\text{exact}}\\sqrt{J_2}\\|_F$.\n\n- Test Case 2 (nearly hydrostatic state): $\\sigma = \\begin{bmatrix}100 & 10^{-9} & 0 \\\\ 10^{-9} & 100 & 0 \\\\ 0 & 0 & 100\\end{bmatrix}$ MPa, with $\\alpha = 0.1$ and $\\varepsilon = 10^{-6}$ MPa. Output a single boolean that is true if the robust gradient is finite (no NaN or infinity) and aligned with the deviatoric stress $s$ in the sense that the cosine of the angle between them, computed as $(\\nabla_{\\sigma}^{\\text{rob}}\\sqrt{J_2} : s) / (\\|\\nabla_{\\sigma}^{\\text{rob}}\\sqrt{J_2}\\|_F \\, \\|s\\|_F)$, exceeds $0.999999$.\n\n- Test Case 3 (exactly hydrostatic state): $\\sigma = \\begin{bmatrix}p & 0 & 0 \\\\ 0 & p & 0 \\\\ 0 & 0 & p\\end{bmatrix}$ MPa with $p = 100$, $\\alpha = 0.1$, and $\\varepsilon = 10^{-6}$ MPa. Output a single boolean that is true if the robust gradient $\\partial \\sqrt{J_2}/\\partial \\sigma$ is (numerically) the zero tensor, assessed by $\\|\\nabla_{\\sigma}^{\\text{rob}}\\sqrt{J_2}\\|_F < 10^{-14}$, and if the flow direction $\\partial f/\\partial \\sigma$ has the correct trace, assessed by $|\\operatorname{tr}(\\partial f/\\partial \\sigma) - 3 \\alpha| < 10^{-14}$.\n\n- Test Case 4 (invariance under hydrostatic addition): Let $\\sigma_a = \\begin{bmatrix}5 & 2 & 0 \\\\ 2 & -3 & 1 \\\\ 0 & 1 & 4\\end{bmatrix}$ MPa and $\\sigma_b = \\sigma_a + 500 I$ MPa, with $\\varepsilon = 10^{-6}$ MPa. Output a single boolean that is true if the robust gradient $\\partial \\sqrt{J_2} / \\partial \\sigma$ computed from $\\sigma_a$ equals that computed from $\\sigma_b$ within Frobenius norm tolerance $10^{-12}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3,result4]\").",
            "solution": "The problem requires the derivation and robust implementation of the flow direction for a Drucker-Prager material model, with a specific focus on handling the singularity that arises at hydrostatic stress states. The solution is presented in three parts: first, the derivation of the relevant gradients and identification of the numerical issue; second, the formulation of a robust regularization; and third, the verification of the implementation against a suite of specific test cases.\n\n### Part 1: Gradient Derivations and Singularity Analysis\n\nWe begin with the provided definitions. The Cauchy stress tensor is $\\sigma$, the identity tensor is $I$, the deviatoric stress is $s = \\sigma - \\frac{1}{3}\\operatorname{tr}(\\sigma) I$, the first stress invariant is $I_1 = \\operatorname{tr}(\\sigma)$, and the second deviatoric stress invariant is $J_2 = \\frac{1}{2} s : s$. The Drucker-Prager yield function is $f(\\sigma) = \\sqrt{J_2} + \\alpha I_1 - k$.\n\nThe flow direction, in the context of associated plasticity, is given by the gradient of the yield function with respect to the stress tensor, $\\partial f / \\partial \\sigma$. We compute this term by term.\n\nFirst, we find the gradient of the first invariant, $I_1$. In index notation, $I_1 = \\sigma_{kk}$. Its derivative with respect to $\\sigma_{ij}$ is:\n$$\n\\frac{\\partial I_1}{\\partial \\sigma_{ij}} = \\frac{\\partial \\sigma_{kk}}{\\partial \\sigma_{ij}} = \\delta_{ik}\\delta_{jk} = \\delta_{ij}\n$$\nIn direct notation, this is simply the identity tensor:\n$$\n\\frac{\\partial I_1}{\\partial \\sigma} = I\n$$\n\nNext, we address the term involving $J_2$. We use the chain rule: $\\partial \\sqrt{J_2} / \\partial \\sigma = (\\partial \\sqrt{J_2} / \\partial J_2) (\\partial J_2 / \\partial \\sigma)$. The first part is elementary: $\\partial \\sqrt{J_2} / \\partial J_2 = 1 / (2\\sqrt{J_2})$.\nFor the second part, $\\partial J_2 / \\partial \\sigma$, we again use the chain rule: $\\partial J_2 / \\partial \\sigma = (\\partial J_2 / \\partial s) : (\\partial s / \\partial \\sigma)$.\nThe derivative of $J_2 = \\frac{1}{2} s_{kl}s_{kl}$ with respect to $s_{ij}$ is:\n$$\n\\frac{\\partial J_2}{\\partial s_{ij}} = \\frac{1}{2} \\left( \\frac{\\partial s_{kl}}{\\partial s_{ij}} s_{kl} + s_{kl} \\frac{\\partial s_{kl}}{\\partial s_{ij}} \\right) = \\frac{1}{2} (\\delta_{ik}\\delta_{jl} s_{kl} + s_{kl} \\delta_{ik}\\delta_{jl}) = s_{ij}\n$$\nThus, in direct notation, $\\partial J_2 / \\partial s = s$.\n\nThe derivative of the deviatoric stress $s = \\sigma - \\frac{1}{3}\\operatorname{tr}(\\sigma)I$ with respect to $\\sigma$ is the fourth-order deviatoric projection tensor, $\\mathbb{P}_{\\text{dev}}$. When contracted with the deviatoric tensor $s$, it yields $s$ itself, because a deviatoric projector acting on an already deviatoric tensor is an identity operation. A more direct calculation shows:\n$$\n\\frac{\\partial J_2}{\\partial \\sigma_{ij}} = \\frac{\\partial}{\\partial \\sigma_{ij}} \\left( \\frac{1}{2} s_{kl} s_{kl} \\right) = s_{kl} \\frac{\\partial s_{kl}}{\\partial \\sigma_{ij}} = s_{kl} \\left( \\delta_{ki}\\delta_{lj} - \\frac{1}{3}\\delta_{ij}\\delta_{kl} \\right) = s_{ij} - \\frac{1}{3} s_{kl}\\delta_{kl} \\delta_{ij} = s_{ij} - \\frac{1}{3} \\operatorname{tr}(s) \\delta_{ij}\n$$\nSince the trace of the deviatoric stress tensor is by definition zero, $\\operatorname{tr}(s) = 0$, we arrive at the simple result:\n$$\n\\frac{\\partial J_2}{\\partial \\sigma} = s\n$$\n\nCombining these results, the gradient of $\\sqrt{J_2}$ is:\n$$\n\\frac{\\partial \\sqrt{J_2}}{\\partial \\sigma} = \\frac{1}{2\\sqrt{J_2}} \\frac{\\partial J_2}{\\partial \\sigma} = \\frac{s}{2\\sqrt{J_2}}\n$$\n\nThe algorithmic issue is now evident. A hydrostatic stress state is defined by $\\sigma = pI$, where $p$ is the pressure. For such a state, the deviatoric stress $s=0$ and consequently $J_2 = 0$. The gradient expression becomes an indeterminate form $0/0$. For nearly hydrostatic states where $s$ is very small but non-zero, $J_2$ is very small and positive, leading to potential floating-point overflow and numerical instability.\n\n### Part 2: Formulation of a Robust Regularization\n\nTo resolve the singularity, we must propose a formula for $\\partial \\sqrt{J_2} / \\partial \\sigma$ that is well-defined at $J_2=0$. At a hydrostatic state, due to material isotropy, there is no preferred deviatoric direction. The physical response should not depend on an arbitrary, numerically unstable direction. The most consistent definition for the deviatoric part of the flow at a purely hydrostatic state is zero. This implies that $\\partial \\sqrt{J_2} / \\partial \\sigma$ should evaluate to the zero tensor when $s=0$.\n\nA robust and continuous regularization can be achieved by modifying the denominator. Let $\\varepsilon$ be a small regularization parameter with the same units as $\\sqrt{J_2}$ ($\\text{MPa}$). We define the robust gradient as:\n$$\n\\nabla_{\\sigma}^{\\text{rob}}\\sqrt{J_2} = \\frac{s}{2 \\max(\\sqrt{J_2}, \\varepsilon)}\n$$\nThis formulation behaves as follows:\n- If $\\sqrt{J_2} \\gg \\varepsilon$, the formula approximates the exact gradient, $\\nabla_{\\sigma}^{\\text{rob}}\\sqrt{J_2} \\approx s/(2\\sqrt{J_2})$.\n- If $\\sqrt{J_2} \\ll \\varepsilon$ (near-hydrostatic states), the formula becomes $\\nabla_{\\sigma}^{\\text{rob}}\\sqrt{J_2} \\approx s/(2\\varepsilon)$. As $s \\to 0$, this gradient smoothly approaches the zero tensor, avoiding any singularity.\n- If $J_2=0$ (exactly hydrostatic state), $s=0$ and the formula correctly yields the zero tensor.\n\nWith this robust gradient, the total flow direction is:\n$$\n\\frac{\\partial f}{\\partial \\sigma} = \\nabla_{\\sigma}^{\\text{rob}}\\sqrt{J_2} + \\alpha I = \\frac{s}{2 \\max(\\sqrt{J_2}, \\varepsilon)} + \\alpha I\n$$\n\nThis formulation is numerically stable, continuous, and consistent with the physics of isotropic plasticity.\n\n### Part 3: Implementation and Verification\n\nThe provided Python code implements this robust formulation and subjects it to four test cases to demonstrate its correctness and stability.\n\n- **Test Case 1 (General non-hydrostatic state):** The stress state is far from hydrostatic, so $\\sqrt{J_2} \\gg \\varepsilon$. The robust formula and the exact formula should yield nearly identical results. The test computes the relative Frobenius-norm error between the two, which is expected to be close to machine precision ($0$).\n\n- **Test Case 2 (Nearly hydrostatic state):** The deviatoric stress is extremely small ($s_{12} = 10^{-9}~\\text{MPa}$), so $\\sqrt{J_2} = 10^{-9}~\\text{MPa}$, which is less than the regularization parameter $\\varepsilon = 10^{-6}~\\text{MPa}$. The robust gradient is calculated as $s/(2\\varepsilon)$. The test verifies two properties: first, that the resulting gradient tensor contains only finite numbers (no `NaN` or `inf`), and second, that its direction is perfectly aligned with the deviatoric stress $s$. The cosine of the angle between the two tensors, computed via a normalized double contraction, should be $1.0$.\n\n- **Test Case 3 (Exactly hydrostatic state):** The stress is purely hydrostatic ($s=0$), so $J_2=0$. The robust gradient $\\nabla_{\\sigma}^{\\text{rob}}\\sqrt{J_2}$ must be the zero tensor, which is verified by checking that its Frobenius norm is below a small tolerance ($10^{-14}$). The full flow direction becomes $\\partial f/\\partial \\sigma = \\alpha I$. The trace of this tensor is $\\operatorname{tr}(\\alpha I) = 3\\alpha$. The second part of the test verifies this property.\n\n- **Test Case 4 (Invariance under hydrostatic addition):** The deviatoric stress $s = \\sigma - \\frac{1}{3}\\operatorname{tr}(\\sigma)I$ is, by definition, invariant under the addition of a hydrostatic pressure, i.e., $s(\\sigma + pI) = s(\\sigma)$. Consequently, $J_2$ and the gradient $\\nabla_{\\sigma}\\sqrt{J_2}$ must also be invariant. This test verifies that the robust gradient computed for a stress tensor $\\sigma_a$ is identical to that computed for $\\sigma_b = \\sigma_a + 500I$, within a tight numerical tolerance.\n\nThe successful execution of these tests confirms the validity and robustness of the implemented numerical procedure.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes flow directions for the Drucker-Prager model using a robust\n    regularization for near-hydrostatic states, and runs a verification suite.\n    \"\"\"\n\n    # --- Helper Functions ---\n    def get_s_and_J2(sigma):\n        \"\"\"Computes the deviatoric stress tensor s and its second invariant J2.\"\"\"\n        if sigma.shape != (3, 3):\n            raise ValueError(\"Stress tensor must be a 3x3 matrix.\")\n        \n        I1 = np.trace(sigma)\n        s = sigma - (I1 / 3.0) * np.identity(3)\n        J2 = 0.5 * np.sum(s * s)  # s:s is sum(s_ij * s_ij)\n        return s, J2\n\n    def grad_sqrtJ2_robust(s, J2, epsilon):\n        \"\"\"\n        Computes the robust gradient of sqrt(J2) with respect to sigma.\n        nabla_sigma(sqrt(J2)) = s / (2 * max(sqrt(J2), epsilon))\n        \"\"\"\n        sqrt_J2 = np.sqrt(J2)\n        denominator = 2.0 * np.maximum(sqrt_J2, epsilon)\n        if denominator == 0: # Should only happen if epsilon=0 and s=0\n            return np.zeros((3, 3))\n        return s / denominator\n\n    def grad_sqrtJ2_exact(s, J2):\n        \"\"\"\n        Computes the exact, but potentially unstable, gradient of sqrt(J2).\n        This function is for comparison purposes only.\n        \"\"\"\n        if J2 <= 0:\n            # For J2=0, this is the singular 0/0 case.\n            # In a real scenario, this branch indicates a problem.\n            # For this test, we return NaN to signal the singularity.\n            return np.full((3, 3), np.nan)\n        \n        sqrt_J2 = np.sqrt(J2)\n        return s / (2.0 * sqrt_J2)\n\n    # --- Test Suite ---\n    results = []\n    \n    # Common regularization parameter\n    epsilon = 1e-6 # MPa\n\n    # Test Case 1: General non-hydrostatic state\n    sigma1 = np.array([[120.0, 25.0, -5.0], [25.0, 90.0, 10.0], [-5.0, 10.0, 70.0]])\n    s1, J2_1 = get_s_and_J2(sigma1)\n    grad_rob_1 = grad_sqrtJ2_robust(s1, J2_1, epsilon)\n    grad_ex_1 = grad_sqrtJ2_exact(s1, J2_1)\n    \n    norm_diff_1 = np.linalg.norm(grad_rob_1 - grad_ex_1, 'fro')\n    norm_ex_1 = np.linalg.norm(grad_ex_1, 'fro')\n    \n    # The relative error is expected to be 0 or very close to it\n    # as sqrt(J2) >> epsilon in this case.\n    if norm_ex_1 > 0:\n        rel_err_1 = norm_diff_1 / norm_ex_1\n    else:\n        # This case should not be reached for sigma1\n        rel_err_1 = 0.0 if norm_diff_1 == 0 else float('inf')\n    results.append(rel_err_1)\n\n    # Test Case 2: Nearly hydrostatic state\n    sigma2 = np.array([[100.0, 1e-9, 0.0], [1e-9, 100.0, 0.0], [0.0, 0.0, 100.0]])\n    alpha2 = 0.1\n    s2, J2_2 = get_s_and_J2(sigma2)\n    grad_rob_2 = grad_sqrtJ2_robust(s2, J2_2, epsilon)\n    \n    is_finite = np.all(np.isfinite(grad_rob_2))\n    \n    norm_s2 = np.linalg.norm(s2, 'fro')\n    norm_grad_rob_2 = np.linalg.norm(grad_rob_2, 'fro')\n    is_aligned = False\n    if norm_s2 > 0 and norm_grad_rob_2 > 0:\n        dot_product = np.sum(grad_rob_2 * s2)\n        cos_angle = dot_product / (norm_grad_rob_2 * norm_s2)\n        # Theoretically, cos_angle should be 1.0. We check it's very close.\n        if cos_angle > 0.999999:\n            is_aligned = True\n    elif norm_s2 == 0 and norm_grad_rob_2 == 0:\n         is_aligned = True # Trivial alignment if both are zero\n         \n    results.append(is_finite and is_aligned)\n\n    # Test Case 3: Exactly hydrostatic state\n    p3 = 100.0\n    sigma3 = np.array([[p3, 0.0, 0.0], [0.0, p3, 0.0], [0.0, 0.0, p3]])\n    alpha3 = 0.1\n    s3, J2_3 = get_s_and_J2(sigma3)\n    grad_rob_sqrtJ2_3 = grad_sqrtJ2_robust(s3, J2_3, epsilon)\n\n    # Check 1: Robust gradient of sqrt(J2) is numerically the zero tensor\n    check3a = np.linalg.norm(grad_rob_sqrtJ2_3, 'fro') < 1e-14\n    \n    # Check 2: The trace of the full flow direction is correct\n    flow_direction_3 = grad_rob_sqrtJ2_3 + alpha3 * np.identity(3)\n    trace_flow_dir_3 = np.trace(flow_direction_3)\n    check3b = abs(trace_flow_dir_3 - 3.0 * alpha3) < 1e-14\n    \n    results.append(check3a and check3b)\n\n    # Test Case 4: Invariance under hydrostatic addition\n    sigma4a = np.array([[5.0, 2.0, 0.0], [2.0, -3.0, 1.0], [0.0, 1.0, 4.0]])\n    sigma4b = sigma4a + 500.0 * np.identity(3)\n\n    s4a, J2_4a = get_s_and_J2(sigma4a)\n    grad_rob_4a = grad_sqrtJ2_robust(s4a, J2_4a, epsilon)\n    \n    s4b, J2_4b = get_s_and_J2(sigma4b)\n    grad_rob_4b = grad_sqrtJ2_robust(s4b, J2_4b, epsilon)\n    \n    # The two gradients should be numerically identical\n    norm_diff_4 = np.linalg.norm(grad_rob_4a - grad_rob_4b, 'fro')\n    check4 = norm_diff_4 < 1e-12\n    results.append(check4)\n\n    # Final print statement in the exact required format.\n    # str(bool) gives 'True' or 'False'\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}