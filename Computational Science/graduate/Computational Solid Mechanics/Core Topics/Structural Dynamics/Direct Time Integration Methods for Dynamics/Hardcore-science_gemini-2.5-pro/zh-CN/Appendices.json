{
    "hands_on_practices": [
        {
            "introduction": "要通过数值方法求解动力学问题，第一步通常是将描述系统运动的二阶常微分方程（ODE）转换为等效的一阶ODE系统。这个练习将指导您完成这一基本转换，并应用经典的四阶龙格-库塔（RK4）方法——一种广泛使用的高精度显式积分器——来求解一个简单的无阻尼线性振子问题。通过完成此练习 ，您将掌握将力学问题转化为标准数值分析形式并手动执行一步求解的核心技能。",
            "id": "3558182",
            "problem": "在计算固体力学中，一个单自由度无阻尼线性振子遵循 Newton 第二定律，具体如下：一个连接到线性弹簧上的质点满足 $m\\,\\ddot{u}(t)+k\\,u(t)=0$，其中 $u(t)$ 是位移，$m$ 是质量，$k$ 是刚度。从此定律和速度定义 $v(t)=\\dot{u}(t)$ 出发，将此二阶方程重写为适合直接时间积分的一阶自治系统。\n\n使用经典的四阶 Runge–Kutta 方法求解常微分方程初值问题，对具有以下参数和初始数据的振子执行一个大小为 $\\Delta t$ 的时间步：\n- $m=1\\,\\mathrm{kg}$，\n- $k=100\\,\\mathrm{N/m}$，\n- $u(0)=1\\,\\mathrm{m}$，\n- $\\dot{u}(0)=0\\,\\mathrm{m/s}$，\n- $\\Delta t=0.05\\,\\mathrm{s}$。\n\n提供一个时间步后的位移和速度，即 $u(\\Delta t)$ 和 $\\dot{u}(\\Delta t)$，形式为一个包含两个元素的行向量。将每个分量四舍五入至六位有效数字。$u(\\Delta t)$ 的单位为米，$\\dot{u}(\\Delta t)$ 的单位为米/秒。最终的包含两个元素的数值答案必须不带单位报告。",
            "solution": "在尝试求解之前，对问题进行验证。\n\n### 第 1 步：提取已知条件\n- 控制方程：$m\\,\\ddot{u}(t)+k\\,u(t)=0$\n- 速度定义：$v(t)=\\dot{u}(t)$\n- 任务 1：将二阶方程重写为一阶自治系统。\n- 任务 2：使用经典的四阶 Runge–Kutta (RK4) 方法执行一个大小为 $\\Delta t$ 的时间步。\n- 参数：\n    - 质量, $m=1\\,\\mathrm{kg}$\n    - 刚度, $k=100\\,\\mathrm{N/m}$\n    - 初始位移, $u(0)=1\\,\\mathrm{m}$\n    - 初始速度, $\\dot{u}(0)=0\\,\\mathrm{m/s}$\n    - 时间步长, $\\Delta t=0.05\\,\\mathrm{s}$\n- 要求输出：位移 $u(\\Delta t)$ 和速度 $\\dot{u}(\\Delta t)$，形式为一个包含两个元素的行向量，每个分量四舍五入至六位有效数字。\n\n### 第 2 步：使用提取的已知条件进行验证\n- **科学依据：** 控制方程 $m\\,\\ddot{u}+k\\,u=0$ 是无阻尼线性单自由度 (SDOF) 振子的基本运动方程，是经典力学和结构动力学的基石。指定的方法，即经典的四阶 Runge-Kutta 方法，是求解常微分方程 (ODE) 初值问题的标准且成熟的数值技术。该问题在科学上是合理的。\n- **适定性：** 该问题提供了一个具有常系数的二阶线性常微分方程和一套完整的初始条件（$u(0)$ 和 $\\dot{u}(0)$）。这构成了一个适定的初值问题，保证了唯一、稳定解的存在。数值任务也是适定的，具有指定的方法、参数和时间步长。\n- **客观性：** 问题使用精确、无歧义的数学和物理术语进行陈述。没有主观或基于意见的陈述。\n- **完整性和一致性：** 提供了所有必要的参数（$m$, $k$）、初始条件（$u(0)$, $\\dot{u}(0)$）和数值积分参数（$\\Delta t$）。单位是一致的（国际单位制）。问题是自洽的，没有矛盾。\n- **可行性：** 参数值在物理上是现实的，所要求的计算是计算力学中的一个标准练习。\n\n### 第 3 步：结论与行动\n问题有效。将提供完整的解答。\n\n### 解答\n该问题要求执行一步经典的四阶 Runge-Kutta (RK4) 方法，以求解单自由度 (SDOF) 无阻尼线性振子的运动方程。\n\n首先，我们将二阶常微分方程 (ODE) 重写为一阶常微分方程组。系统在时间 $t$ 的状态可以用一个包含位移 $u(t)$ 和速度 $v(t)$ 的状态向量 $\\mathbf{y}(t)$ 来描述。\n$$\n\\mathbf{y}(t) = \\begin{pmatrix} u(t) \\\\ v(t) \\end{pmatrix}\n$$\n状态向量的时间导数为：\n$$\n\\dot{\\mathbf{y}}(t) = \\frac{d\\mathbf{y}}{dt} = \\begin{pmatrix} \\dot{u}(t) \\\\ \\dot{v}(t) \\end{pmatrix}\n$$\n根据速度的定义，我们得到第一个方程：\n$$\n\\dot{u}(t) = v(t)\n$$\n根据运动控制方程 $m\\,\\ddot{u}(t)+k\\,u(t)=0$，我们可以将加速度 $\\ddot{u}(t)$ 表示为：\n$$\n\\ddot{u}(t) = -\\frac{k}{m} u(t)\n$$\n由于 $v(t) = \\dot{u}(t)$，速度的时间导数为 $\\dot{v}(t) = \\ddot{u}(t)$。这给出了第二个方程：\n$$\n\\dot{v}(t) = -\\frac{k}{m} u(t)\n$$\n结合这些结果，我们得到一阶自治系统 $\\dot{\\mathbf{y}} = \\mathbf{f}(\\mathbf{y})$：\n$$\n\\dot{\\mathbf{y}}(t) = \\begin{pmatrix} \\dot{u}(t) \\\\ \\dot{v}(t) \\end{pmatrix} = \\begin{pmatrix} v(t) \\\\ -\\frac{k}{m} u(t) \\end{pmatrix} = \\mathbf{f}(\\mathbf{y}(t))\n$$\n这也可以用矩阵形式表示为：\n$$\n\\dot{\\mathbf{y}}(t) = \\begin{pmatrix} 0 & 1 \\\\ -\\frac{k}{m} & 0 \\end{pmatrix} \\begin{pmatrix} u(t) \\\\ v(t) \\end{pmatrix}\n$$\n经典的四阶 Runge-Kutta 方法将解从时间 $t_n$推进到 $t_{n+1} = t_n + \\Delta t$ 的过程如下：\n$$\n\\mathbf{y}_{n+1} = \\mathbf{y}_n + \\frac{\\Delta t}{6} (\\mathbf{k}_1 + 2\\mathbf{k}_2 + 2\\mathbf{k}_3 + \\mathbf{k}_4)\n$$\n其中增量计算如下：\n$$\n\\begin{aligned}\n\\mathbf{k}_1 = \\mathbf{f}(\\mathbf{y}_n) \\\\\n\\mathbf{k}_2 = \\mathbf{f}\\left(\\mathbf{y}_n + \\frac{\\Delta t}{2}\\mathbf{k}_1\\right) \\\\\n\\mathbf{k}_3 = \\mathbf{f}\\left(\\mathbf{y}_n + \\frac{\\Delta t}{2}\\mathbf{k}_2\\right) \\\\\n\\mathbf{k}_4 = \\mathbf{f}\\left(\\mathbf{y}_n + \\Delta t\\,\\mathbf{k}_3\\right)\n\\end{aligned}\n$$\n给定参数 $m=1\\,\\mathrm{kg}$，$k=100\\,\\mathrm{N/m}$，因此比率 $\\frac{k}{m} = \\frac{100}{1} = 100\\,\\mathrm{s^{-2}}$。函数 $\\mathbf{f}$ 变为：\n$$\n\\mathbf{f}(u, v) = \\begin{pmatrix} v \\\\ -100u \\end{pmatrix}\n$$\n$t_0=0$ 时的初始条件为 $u(0)=1\\,\\mathrm{m}$ 和 $v(0)=\\dot{u}(0)=0\\,\\mathrm{m/s}$。初始状态向量为：\n$$\n\\mathbf{y}_0 = \\begin{pmatrix} u_0 \\\\ v_0 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}\n$$\n我们用 $\\Delta t=0.05\\,\\mathrm{s}$ 执行一个时间步来求解 $\\mathbf{y}_1 = \\mathbf{y}(\\Delta t)$。\n\nRK4 增量的计算：\n1.  计算 $\\mathbf{k}_1$：\n    $$\n    \\mathbf{k}_1 = \\mathbf{f}(\\mathbf{y}_0) = \\mathbf{f}(1, 0) = \\begin{pmatrix} 0 \\\\ -100(1) \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ -100 \\end{pmatrix}\n    $$\n2.  计算 $\\mathbf{k}_2$：\n    $$\n    \\mathbf{y}_0 + \\frac{\\Delta t}{2}\\mathbf{k}_1 = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} + \\frac{0.05}{2} \\begin{pmatrix} 0 \\\\ -100 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} + \\begin{pmatrix} 0 \\\\ -2.5 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ -2.5 \\end{pmatrix}\n    $$\n    $$\n    \\mathbf{k}_2 = \\mathbf{f}(1, -2.5) = \\begin{pmatrix} -2.5 \\\\ -100(1) \\end{pmatrix} = \\begin{pmatrix} -2.5 \\\\ -100 \\end{pmatrix}\n    $$\n3.  计算 $\\mathbf{k}_3$：\n    $$\n    \\mathbf{y}_0 + \\frac{\\Delta t}{2}\\mathbf{k}_2 = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} + \\frac{0.05}{2} \\begin{pmatrix} -2.5 \\\\ -100 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} + \\begin{pmatrix} -0.0625 \\\\ -2.5 \\end{pmatrix} = \\begin{pmatrix} 0.9375 \\\\ -2.5 \\end{pmatrix}\n    $$\n    $$\n    \\mathbf{k}_3 = \\mathbf{f}(0.9375, -2.5) = \\begin{pmatrix} -2.5 \\\\ -100(0.9375) \\end{pmatrix} = \\begin{pmatrix} -2.5 \\\\ -93.75 \\end{pmatrix}\n    $$\n4.  计算 $\\mathbf{k}_4$：\n    $$\n    \\mathbf{y}_0 + \\Delta t\\,\\mathbf{k}_3 = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} + 0.05 \\begin{pmatrix} -2.5 \\\\ -93.75 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} + \\begin{pmatrix} -0.125 \\\\ -4.6875 \\end{pmatrix} = \\begin{pmatrix} 0.875 \\\\ -4.6875 \\end{pmatrix}\n    $$\n    $$\n    \\mathbf{k}_4 = \\mathbf{f}(0.875, -4.6875) = \\begin{pmatrix} -4.6875 \\\\ -100(0.875) \\end{pmatrix} = \\begin{pmatrix} -4.6875 \\\\ -87.5 \\end{pmatrix}\n    $$\n现在，我们计算增量的加权平均值：\n$$\n\\mathbf{k}_1 + 2\\mathbf{k}_2 + 2\\mathbf{k}_3 + \\mathbf{k}_4 = \\begin{pmatrix} 0 \\\\ -100 \\end{pmatrix} + 2\\begin{pmatrix} -2.5 \\\\ -100 \\end{pmatrix} + 2\\begin{pmatrix} -2.5 \\\\ -93.75 \\end{pmatrix} + \\begin{pmatrix} -4.6875 \\\\ -87.5 \\end{pmatrix}\n$$\n$$\n= \\begin{pmatrix} 0 - 5 - 5 - 4.6875 \\\\ -100 - 200 - 187.5 - 87.5 \\end{pmatrix} = \\begin{pmatrix} -14.6875 \\\\ -575 \\end{pmatrix}\n$$\n最后，我们更新状态向量以求得 $\\mathbf{y}_1$：\n$$\n\\mathbf{y}_1 = \\mathbf{y}_0 + \\frac{\\Delta t}{6} (\\mathbf{k}_1 + 2\\mathbf{k}_2 + 2\\mathbf{k}_3 + \\mathbf{k}_4) = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} + \\frac{0.05}{6} \\begin{pmatrix} -14.6875 \\\\ -575 \\end{pmatrix}\n$$\n$$\n\\mathbf{y}_1 = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} + \\begin{pmatrix} \\frac{0.05 \\times (-14.6875)}{6} \\\\ \\frac{0.05 \\times (-575)}{6} \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} + \\begin{pmatrix} \\frac{-0.734375}{6} \\\\ \\frac{-28.75}{6} \\end{pmatrix}\n$$\n$$\n\\mathbf{y}_1 = \\begin{pmatrix} 1 - 0.1223958333... \\\\ -4.791666666... \\end{pmatrix} = \\begin{pmatrix} 0.8776041666... \\\\ -4.791666666... \\end{pmatrix}\n$$\n$\\mathbf{y}_1$ 的分量是位移 $u(\\Delta t)$ 和速度 $\\dot{u}(\\Delta t)$。将每个分量四舍五入至六位有效数字：\n$$\nu(\\Delta t) \\approx 0.877604\\,\\mathrm{m}\n$$\n$$\n\\dot{u}(\\Delta t) \\approx -4.79167\\,\\mathrm{m/s}\n$$\n最终答案按要求以行向量形式呈现。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0.877604 & -4.79167 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在结构动力学领域，相比于通用的ODE求解器，工程师们更常使用专为此类问题设计的积分方法，其中Newmark方法族系是最著名和最重要的一种。这个练习  将带您实践一个隐式时间积分方案，特别是无条件稳定的平均加速度法。您将推导并求解每个时间步的离散平衡方程，这个过程中会接触到“有效刚度”这一关键概念，这是隐式动力学分析的核心。",
            "id": "3558209",
            "problem": "考虑计算固体力学中阻尼振子的线性单自由度 (SDOF) 运动方程，\n$$\nm\\,\\ddot{u}(t) + c\\,\\dot{u}(t) + k\\,u(t) = f(t),\n$$\n其中质量 $m=1$ kg，粘性阻尼系数 $c=0.2$ N s/m，刚度 $k=100$ N/m，外加载荷 $f(t)=10\\sin(5t)$ N。使用 Newmark 族直接时间积分方法的一个时间步，参数为 $(\\beta,\\gamma)=(\\tfrac{1}{4},\\tfrac{1}{2})$，时间步长 $\\Delta t=0.01$ s，从 $t^n=0.01$ s推进到 $t^{n+1}=0.02$ s，计算在时间 $t^{n+1}$ 时的位移 $u^{n+1}$。给定在时间 $t^n$ 的状态为 $u^n=0$，$\\dot{u}^n=0$，以及 $\\ddot{u}^n=f^n/m$，其中 $f^n=f(t^n)$。在进行数值计算之前，从半离散运动方程和 Newmark 族的定义出发，建立在 $t^{n+1}$ 时的离散平衡。\n\n最终位移以米为单位表示，并将答案四舍五入到六位有效数字。",
            "solution": "分析问题陈述，认定其有效。它在科学上基于结构动力学原理，给出了所有必要信息，问题设定良好，并且语言客观。该问题自成一体，没有矛盾。我们可以继续求解。\n\n任务是使用 Newmark 直接时间积分方法的一个步骤，计算单自由度 (SDOF) 系统在时间 $t^{n+1}$ 的位移 $u^{n+1}$。\n\nSDOF 系统的半离散运动方程由下式给出：\n$$\nm\\,\\ddot{u}(t) + c\\,\\dot{u}(t) + k\\,u(t) = f(t)\n$$\n在离散时间 $t^{n+1}$，该方程写作：\n$$\nm\\,\\ddot{u}^{n+1} + c\\,\\dot{u}^{n+1} + k\\,u^{n+1} = f^{n+1}\n$$\n其中 $u^{n+1} = u(t^{n+1})$，$\\dot{u}^{n+1} = \\dot{u}(t^{n+1})$，$\\ddot{u}^{n+1} = \\ddot{u}(t^{n+1})$，以及 $f^{n+1} = f(t^{n+1})$。\n\nNewmark 族方法提供了位移和速度的更新规则：\n$$\nu^{n+1} = u^n + \\Delta t\\,\\dot{u}^n + \\Delta t^2 \\left[ \\left(\\frac{1}{2} - \\beta\\right)\\ddot{u}^n + \\beta\\,\\ddot{u}^{n+1} \\right] \\quad (1)\n$$\n$$\n\\dot{u}^{n+1} = \\dot{u}^n + \\Delta t \\left[ (1 - \\gamma)\\ddot{u}^n + \\gamma\\,\\ddot{u}^{n+1} \\right] \\quad (2)\n$$\n目标是求解未知位移 $u^{n+1}$。为此，我们首先用 $u^{n+1}$ 和时间步 $n$ 的已知量来表示未知加速度 $\\ddot{u}^{n+1}$ 和速度 $\\dot{u}^{n+1}$。\n\n从方程 (1) 中，我们重新整理以求解 $\\ddot{u}^{n+1}$：\n$$\n\\beta \\Delta t^2 \\ddot{u}^{n+1} = u^{n+1} - u^n - \\Delta t\\,\\dot{u}^n - \\left(\\frac{1}{2} - \\beta\\right)\\Delta t^2 \\ddot{u}^n\n$$\n$$\n\\ddot{u}^{n+1} = \\frac{1}{\\beta \\Delta t^2} \\left( u^{n+1} - u^n - \\Delta t\\,\\dot{u}^n \\right) - \\left(\\frac{1}{2\\beta} - 1\\right)\\ddot{u}^n \\quad (3)\n$$\n接下来，我们将 $\\ddot{u}^{n+1}$ 的这个表达式代入方程 (2) 以求得 $\\dot{u}^{n+1}$：\n$$\n\\dot{u}^{n+1} = \\dot{u}^n + (1 - \\gamma)\\Delta t\\,\\ddot{u}^n + \\gamma \\Delta t \\left[ \\frac{1}{\\beta \\Delta t^2} \\left( u^{n+1} - u^n - \\Delta t\\,\\dot{u}^n \\right) - \\left(\\frac{1}{2\\beta} - 1\\right)\\ddot{u}^n \\right]\n$$\n分组各项，我们得到：\n$$\n\\dot{u}^{n+1} = \\frac{\\gamma}{\\beta \\Delta t}(u^{n+1} - u^n) + \\left(1 - \\frac{\\gamma}{\\beta}\\right)\\dot{u}^n + \\Delta t \\left(1 - \\gamma - \\frac{\\gamma}{2\\beta} + \\gamma\\right)\\ddot{u}^n\n$$\n$$\n\\dot{u}^{n+1} = \\frac{\\gamma}{\\beta \\Delta t}(u^{n+1} - u^n) + \\left(1 - \\frac{\\gamma}{\\beta}\\right)\\dot{u}^n + \\Delta t \\left(1 - \\frac{\\gamma}{2\\beta}\\right)\\ddotu^n \\quad (4)\n$$\n现在，我们将方程 (3) 和 (4) 代入在 $t^{n+1}$ 时的离散运动方程：\n$$\nm\\left[\\frac{1}{\\beta \\Delta t^2}(u^{n+1} - u^n - \\Delta t\\,\\dot{u}^n) - (\\frac{1}{2\\beta} - 1)\\ddot{u}^n\\right] + c\\left[\\frac{\\gamma}{\\beta \\Delta t}(u^{n+1} - u^n) + (1 - \\frac{\\gamma}{\\beta})\\dot{u}^n + \\Delta t(1 - \\frac{\\gamma}{2\\beta})\\ddotu^n\\right] + k\\,u^{n+1} = f^{n+1}\n$$\n我们重新整理这个方程，将所有包含未知数 $u^{n+1}$ 的项分组到左侧 (LHS)，所有已知项分组到右侧 (RHS)。\n$$\n\\left( \\frac{1}{\\beta \\Delta t^2}m + \\frac{\\gamma}{\\beta \\Delta t}c + k \\right) u^{n+1} = f^{n+1} + m\\left[ \\frac{1}{\\beta \\Delta t^2}u^n + \\frac{1}{\\beta \\Delta t}\\dot{u}^n + \\left(\\frac{1}{2\\beta} - 1\\right)\\ddot{u}^n \\right] + c\\left[ \\frac{\\gamma}{\\beta \\Delta t}u^n + \\left(\\frac{\\gamma}{\\beta} - 1\\right)\\dot{u}^n + \\Delta t\\left(\\frac{\\gamma}{2\\beta} - 1\\right)\\ddot{u}^n \\right]\n$$\n这是一个形式为 $\\hat{k} u^{n+1} = \\hat{f}^{n+1}$ 的线性系统，其中有效刚度 $\\hat{k}$ 和有效力 $\\hat{f}^{n+1}$ 定义为：\n$$\n\\hat{k} = k + \\frac{\\gamma}{\\beta \\Delta t}c + \\frac{1}{\\beta \\Delta t^2}m\n$$\n$$\n\\hat{f}^{n+1} = f^{n+1} + c\\left[\\frac{\\gamma}{\\beta \\Delta t}u^n + \\left(\\frac{\\gamma}{\\beta} - 1\\right)\\dot{u}^n + \\Delta t\\left(\\frac{\\gamma}{2\\beta} - 1\\right)\\ddot{u}^n\\right] + m\\left[\\frac{1}{\\beta \\Delta t^2}u^n + \\frac{1}{\\beta \\Delta t}\\dot{u}^n + \\left(\\frac{1}{2\\beta} - 1\\right)\\ddot{u}^n\\right]\n$$\n我们已知以下数值：\n$m=1$ kg, $c=0.2$ N s/m, $k=100$ N/m, $\\Delta t=0.01$ s, $\\beta=\\frac{1}{4}$, $\\gamma=\\frac{1}{2}$。\n参数 $(\\beta, \\gamma) = (\\frac{1}{4}, \\frac{1}{2})$ 定义了平均加速度法（或梯形法则）。\n\n首先，我们计算有效刚度和有效力的系数：\n$$\n\\frac{1}{\\beta \\Delta t^2} = \\frac{1}{(\\frac{1}{4})(0.01)^2} = \\frac{4}{0.0001} = 40000\n$$\n$$\n\\frac{\\gamma}{\\beta \\Delta t} = \\frac{\\frac{1}{2}}{(\\frac{1}{4})(0.01)} = \\frac{2}{0.01} = 200\n$$\n现在，我们计算有效刚度 $\\hat{k}$：\n$$\n\\hat{k} = 100 + (200)(0.2) + (40000)(1) = 100 + 40 + 40000 = 40140 \\text{ N/m}\n$$\n接下来，我们确定在时间 $t^n = 0.01$ s 时的状态：\n$u^n=0$ m\n$\\dot{u}^n=0$ m/s\n激振函数为 $f(t) = 10\\sin(5t)$ N。因此，$f^n = f(0.01) = 10\\sin(5 \\times 0.01) = 10\\sin(0.05)$ N。\n加速度为 $\\ddot{u}^n = f^n/m = (10\\sin(0.05))/1 = 10\\sin(0.05)$ m/s$^2$。\n在时间 $t^{n+1} = 0.02$ s 时的力为 $f^{n+1} = f(0.02) = 10\\sin(5 \\times 0.02) = 10\\sin(0.1)$ N。\n\n现在我们计算有效力 $\\hat{f}^{n+1}$。由于 $u^n=0$ 和 $\\dot{u}^n=0$，$\\hat{f}^{n+1}$ 的表达式大大简化：\n$$\n\\hat{f}^{n+1} = f^{n+1} + c\\left[\\Delta t\\left(\\frac{\\gamma}{2\\beta} - 1\\right)\\ddot{u}^n\\right] + m\\left[\\left(\\frac{1}{2\\beta} - 1\\right)\\ddot{u}^n\\right]\n$$\n让我们计算 $\\ddot{u}^n$ 项的系数：\n$$\n\\frac{\\gamma}{2\\beta} - 1 = \\frac{\\frac{1}{2}}{2(\\frac{1}{4})} - 1 = \\frac{\\frac{1}{2}}{\\frac{1}{2}} - 1 = 1 - 1 = 0\n$$\n$$\n\\frac{1}{2\\beta} - 1 = \\frac{1}{2(\\frac{1}{4})} - 1 = \\frac{1}{\\frac{1}{2}} - 1 = 2 - 1 = 1\n$$\n乘以 $c$ 的项消失。有效力变为：\n$$\n\\hat{f}^{n+1} = f^{n+1} + m\\ddot{u}^n\n$$\n代入数值：\n$$\n\\hat{f}^{n+1} = 10\\sin(0.1) + (1)(10\\sin(0.05)) = 10(\\sin(0.1) + \\sin(0.05)) \\text{ N}\n$$\n现在我们可以求解 $u^{n+1}$：\n$$\nu^{n+1} = \\frac{\\hat{f}^{n+1}}{\\hat{k}} = \\frac{10(\\sin(0.1) + \\sin(0.05))}{40140}\n$$\n使用计算器计算三角函数（以弧度为单位）：\n$\\sin(0.1) \\approx 0.0998334166$\n$\\sin(0.05) \\approx 0.0499791693$\n$$\nu^{n+1} \\approx \\frac{10(0.0998334166 + 0.0499791693)}{40140} = \\frac{10(0.1498125859)}{40140} = \\frac{1.498125859}{40140}\n$$\n$$\nu^{n+1} \\approx 0.0000373225276 \\text{ m}\n$$\n题目要求答案四舍五入到六位有效数字。前六位有效数字是 $3$、$7$、$3$、$2$、$2$、$5$。下一位数字是 $2$，小于 $5$，因此我们不向上取整。\n$$\nu^{n+1} \\approx 0.0000373225 \\text{ m}\n$$",
            "answer": "$$\n\\boxed{0.0000373225}\n$$"
        },
        {
            "introduction": "从单自由度（SDOF）系统到多自由度（MDOF）系统是理解真实工程结构动态响应的关键一步。本练习  采用显式中心差分法，这是一种计算上相对简单但功能强大的方法，尤其适用于冲击或波传播等问题。此练习的核心教学目标是深入理解显式方法的一个根本特性：条件稳定性。您将通过计算系统的最高固有频率来确定临界时间步长，从而亲身体会到为了确保数值解的稳定性，时间步长的选择所受到的严格限制。",
            "id": "3558173",
            "problem": "考虑一个由牛顿第二定律控制的双自由度（DOF）集总参数结构模型，其矩阵形式写作 $M \\ddot{u}(t) + C \\dot{u}(t) + K u(t) = f(t)$，其中 $M$ 是质量矩阵，$C$ 是阻尼矩阵，$K$ 是刚度矩阵，$u(t)$ 是位移向量，$f(t)$ 是外力向量。系统数据为 $M=\\mathrm{diag}(1,1)$ kg，$K=\\begin{bmatrix}2000 & -1000\\\\ -1000 & 2000\\end{bmatrix}$ N/m，$C=\\begin{bmatrix}0 & 0\\\\ 0 & 0\\end{bmatrix}$ 及 $f(t)=\\begin{bmatrix}0\\\\0\\end{bmatrix}$。初始位移和初始速度分别为 $u^{0}=\\begin{bmatrix}1\\\\0\\end{bmatrix}$ mm 和 $\\dot{u}^{0}=\\begin{bmatrix}0\\\\0\\end{bmatrix}$ mm/s。设均匀时间步长为 $\\Delta t = 0.001$ s。\n\n从控制方程出发，使用关于时间 $t^{n}$ 的泰勒级数展开，推导推进无阻尼自由振动响应所需的显式中心差分更新公式。使用这些公式，根据给定的初始条件计算前两个位移状态 $u^{1}$ 和 $u^{2}$。将 $u^{1}$ 和 $u^{2}$ 以毫米为单位表示，并将每个分量四舍五入至七位有效数字。\n\n然后，通过求解广义特征值问题 $K \\phi = \\lambda M \\phi$（其中 $\\omega = \\sqrt{\\lambda}$）来确定离散系统的最大无阻尼固有圆频率 $\\omega_{\\max}$，从而评估显式积分的稳定性。计算中心差分法的临界时间步长 $\\Delta t_{\\mathrm{cr}} = 2 / \\omega_{\\max}$，并构建无量纲稳定性比 $r = \\Delta t / \\Delta t_{\\mathrm{cr}}$。根据 $r$ 的值，判断所选的 $\\Delta t$ 是否稳定。\n\n将 $r$ 的最终值报告为一个四舍五入到五位有效数字的数值。$r$ 无需单位。",
            "solution": "经评估，该问题陈述有效。它科学地基于结构动力学和计算力学的原理，问题提法良好，数据完整且一致，并以客观、正式的语言表述。所有必要信息均已提供，且无矛盾之处。\n\n无阻尼自由振动系统的运动控制方程由牛顿第二定律的矩阵形式给出：\n$$\nM \\ddot{u}(t) + K u(t) = 0\n$$\n其中 $M$ 是质量矩阵，$K$ 是刚度矩阵，$u(t)$ 是位移向量。所有计算将使用国际单位制（米、千克、秒、牛顿）。初始条件转换为国际单位制：\n$$\nu^{0} = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix} \\text{ mm} = \\begin{bmatrix} 0.001 \\\\ 0 \\end{bmatrix} \\text{ m}\n$$\n$$\n\\dot{u}^{0} = \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix} \\text{ mm/s} = \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix} \\text{ m/s}\n$$\n给定的系统矩阵和时间步长为：\n$$\nM = \\begin{bmatrix} 1 & 0 \\\\ 0 & 1 \\end{bmatrix} \\text{ kg}, \\quad K = \\begin{bmatrix} 2000 & -1000 \\\\ -1000 & 2000 \\end{bmatrix} \\text{ N/m}, \\quad \\Delta t = 0.001 \\text{ s}\n$$\n由于 $M$ 是单位矩阵 $I$，运动方程简化为 $\\ddot{u}(t) + K u(t) = 0$。\n\n首先，我们推导中心差分更新公式。在时间 $t^n = n \\Delta t$ 处的加速度的中心差分近似，由 $u(t^{n+1})$ 和 $u(t^{n-1})$ 关于 $t^n$ 的泰勒级数展开推导得出：\n$$\n\\ddot{u}^n \\approx \\frac{u^{n+1} - 2u^n + u^{n-1}}{(\\Delta t)^2}\n$$\n将此式代入时间 $t^n$ 处的运动方程 $M \\ddot{u}^n + K u^n = 0$，得到：\n$$\nM \\left( \\frac{u^{n+1} - 2u^n + u^{n-1}}{(\\Delta t)^2} \\right) + K u^n = 0\n$$\n重新整理以求解下一时间步的位移 $u^{n+1}$，得到显式更新公式：\n$$\nM u^{n+1} = (2M - (\\Delta t)^2 K) u^n - M u^{n-1}\n$$\n由于 $M=I$，该式简化为：\n$$\nu^{n+1} = (2I - (\\Delta t)^2 K) u^n - u^{n-1}\n$$\n该公式需要一个特殊的启动程序，因为对于第一步（$n=0$），需要一个虚拟时间 $t^{-1}=-\\Delta t$ 处的位移 $u^{-1}$。我们可以利用初始条件来求得 $u^{-1}$。初始速度 $\\dot{u}^0$ 的中心差分近似为：\n$$\n\\dot{u}^0 \\approx \\frac{u^1 - u^{-1}}{2 \\Delta t} \\implies u^{-1} = u^1 - 2 \\Delta t \\dot{u}^0\n$$\n根据 $u(t)$ 在 $t=0$ 处的泰勒展开，我们有 $u(-\\Delta t) \\approx u(0) - \\Delta t \\dot{u}(0) + \\frac{(\\Delta t)^2}{2} \\ddot{u}(0)$。因此，\n$$\nu^{-1} \\approx u^0 - \\Delta t \\dot{u}^0 + \\frac{(\\Delta t)^2}{2} \\ddot{u}^0\n$$\n初始加速度 $\\ddot{u}^0$ 可由 $t=0$ 时的运动方程 $M \\ddot{u}^0 + K u^0 = 0$ 求得，即 $\\ddot{u}^0 = -M^{-1} K u^0$。\n鉴于 $\\dot{u}^0=0$，$u^{-1}$ 的表达式简化为 $u^{-1} = u^0 + \\frac{(\\Delta t)^2}{2} \\ddot{u}^0$。\n将此式代入 $n=0$ 时的通用更新公式：\n$$\nu^1 = (2I - (\\Delta t)^2 K) u^0 - u^{-1} = (2I - (\\Delta t)^2 K) u^0 - \\left(u^0 + \\frac{(\\Delta t)^2}{2} \\ddot{u}^0 \\right)\n$$\n$$\nu^1 = u^0 - (\\Delta t)^2 K u^0 - \\frac{(\\Delta t)^2}{2} (-K u^0) = u^0 - \\frac{(\\Delta t)^2}{2} K u^0 = \\left( I - \\frac{(\\Delta t)^2}{2} K \\right) u^0\n$$\n这就是用于第一个位移状态 $u^1$ 的专门公式。\n\n现在，我们计算位移。\n首先，我们预先计算矩阵 $(2I - (\\Delta t)^2 K)$：\n$$\n(\\Delta t)^2 = (0.001)^2 = 10^{-6}\n$$\n$$\n(\\Delta t)^2 K = 10^{-6} \\begin{bmatrix} 2000 & -1000 \\\\ -1000 & 2000 \\end{bmatrix} = \\begin{bmatrix} 0.002 & -0.001 \\\\ -0.001 & 0.002 \\end{bmatrix}\n$$\n$$\n2I - (\\Delta t)^2 K = \\begin{bmatrix} 2 & 0 \\\\ 0 & 2 \\end{bmatrix} - \\begin{bmatrix} 0.002 & -0.001 \\\\ -0.001 & 0.002 \\end{bmatrix} = \\begin{bmatrix} 1.998 & 0.001 \\\\ 0.001 & 1.998 \\end{bmatrix}\n$$\n接下来，我们使用上面推导的启动公式（并注意到 $\\dot{u}^0=0$）来计算 $u^1$：\n$$\n\\frac{(\\Delta t)^2}{2} K u^0 = \\frac{10^{-6}}{2} \\begin{bmatrix} 2000 & -1000 \\\\ -1000 & 2000 \\end{bmatrix} \\begin{bmatrix} 0.001 \\\\ 0 \\end{bmatrix} = 0.5 \\times 10^{-6} \\begin{bmatrix} 2 \\\\ -1 \\end{bmatrix} = \\begin{bmatrix} 10^{-6} \\\\ -0.5 \\times 10^{-6} \\end{bmatrix}\n$$\n$$\nu^1 = u^0 - \\frac{(\\Delta t)^2}{2} K u^0 = \\begin{bmatrix} 0.001 \\\\ 0 \\end{bmatrix} - \\begin{bmatrix} 0.000001 \\\\ -0.0000005 \\end{bmatrix} = \\begin{bmatrix} 0.000999 \\\\ 0.0000005 \\end{bmatrix} \\text{ m}\n$$\n为了计算 $u^2$，我们使用 $n=1$ 时的通用更新公式：\n$$\nu^2 = (2I - (\\Delta t)^2 K) u^1 - u^0\n$$\n$$\nu^2 = \\begin{bmatrix} 1.998 & 0.001 \\\\ 0.001 & 1.998 \\end{bmatrix} \\begin{bmatrix} 0.000999 \\\\ 0.0000005 \\end{bmatrix} - \\begin{bmatrix} 0.001 \\\\ 0 \\end{bmatrix}\n$$\n矩阵-向量乘积为：\n$$\n\\begin{bmatrix} 1.998 \\times 0.000999 + 0.001 \\times 0.0000005 \\\\ 0.001 \\times 0.000999 + 1.998 \\times 0.0000005 \\end{bmatrix} = \\begin{bmatrix} 0.001996002 + 0.0000000005 \\\\ 0.000000999 + 0.000000999 \\end{bmatrix} = \\begin{bmatrix} 0.0019960025 \\\\ 0.000001998 \\end{bmatrix}\n$$\n$$\nu^2 = \\begin{bmatrix} 0.0019960025 \\\\ 0.000001998 \\end{bmatrix} - \\begin{bmatrix} 0.001 \\\\ 0 \\end{bmatrix} = \\begin{bmatrix} 0.0009960025 \\\\ 0.000001998 \\end{bmatrix} \\text{ m}\n$$\n将结果转换为毫米并四舍五入至七位有效数字：\n$$\nu^1 = \\begin{bmatrix} 0.9990000 \\\\ 0.0005000000 \\end{bmatrix} \\text{ mm}\n$$\n$$\nu^2 = \\begin{bmatrix} 0.9960025 \\\\ 0.001998000 \\end{bmatrix} \\text{ mm}\n$$\n\n最后，我们评估积分的稳定性。这需要从广义特征值问题 $K \\phi = \\lambda M \\phi$ 中找出系统的最大无阻尼固有圆频率 $\\omega_{\\max}$。由于 $M=I$，这是一个标准的特征值问题 $K \\phi = \\lambda \\phi$。特征值 $\\lambda = \\omega^2$ 可由特征方程 $\\det(K - \\lambda I) = 0$ 求得：\n$$\n\\det \\begin{bmatrix} 2000-\\lambda & -1000 \\\\ -1000 & 2000-\\lambda \\end{bmatrix} = 0\n$$\n$$\n(2000-\\lambda)^2 - (-1000)^2 = 0 \\implies (2000-\\lambda)^2 = 1000^2\n$$\n这给出了 $(2000-\\lambda)$ 的两个解：\n$$\n2000 - \\lambda_1 = 1000 \\implies \\lambda_1 = 1000\n$$\n$$\n2000 - \\lambda_2 = -1000 \\implies \\lambda_2 = 3000\n$$\n固有圆频率为 $\\omega_1 = \\sqrt{\\lambda_1} = \\sqrt{1000}$ rad/s 和 $\\omega_2 = \\sqrt{\\lambda_2} = \\sqrt{3000}$ rad/s。最大频率是：\n$$\n\\omega_{\\max} = \\sqrt{3000} \\approx 54.7722558 \\text{ rad/s}\n$$\n中心差分法的临界时间步长由 $\\Delta t_{\\mathrm{cr}} = 2 / \\omega_{\\max}$ 给出：\n$$\n\\Delta t_{\\mathrm{cr}} = \\frac{2}{\\sqrt{3000}} \\approx 0.0365148 \\text{ s}\n$$\n无量纲稳定性比 $r$ 是所选时间步长与临界时间步长之比：\n$$\nr = \\frac{\\Delta t}{\\Delta t_{\\mathrm{cr}}} = \\frac{0.001}{2 / \\sqrt{3000}} = \\frac{0.001 \\sqrt{3000}}{2} = 0.0005 \\sqrt{3000}\n$$\n其数值为：\n$$\nr \\approx 0.0273861279\n$$\n对于无阻尼系统，中心差分法的稳定性条件是 $\\Delta t \\le \\Delta t_{\\mathrm{cr}}$，这等价于 $r \\le 1$。由于我们计算出的值 $r \\approx 0.02739 \\ll 1$，所选的时间步长 $\\Delta t = 0.001$ s 是稳定的。\n\n将 $r$ 的最终值四舍五入到五位有效数字，结果是 $0.027386$。",
            "answer": "$$\\boxed{0.027386}$$"
        }
    ]
}