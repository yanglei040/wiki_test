{
    "hands_on_practices": [
        {
            "introduction": "To apply the Rayleigh damping model, one must first determine the coefficients $\\alpha$ and $\\beta$. This practice establishes the foundational method for this calibration, which involves matching the model's damping ratio to target values at two key frequencies. By setting up and solving a simple system of linear equations , you will gain direct experience with the core algebra of the model and also investigate a critical numerical issue: the potential for ill-conditioning when the chosen frequencies are close together.",
            "id": "3515251",
            "problem": "A geomechanical finite element model of a layered soil deposit is to be simulated in the time domain under seismic excitation. The linearized semi-discrete equilibrium is given by the second-order ordinary differential equation of motion $ \\mathbf{M} \\ddot{\\mathbf{u}}(t) + \\mathbf{C} \\dot{\\mathbf{u}}(t) + \\mathbf{K} \\mathbf{u}(t) = \\mathbf{p}(t) $, where $ \\mathbf{M} $ is the mass matrix, $ \\mathbf{K} $ is the stiffness matrix, and $ \\mathbf{C} $ is the damping matrix. A Rayleigh damping model is adopted, in which $ \\mathbf{C} = \\alpha \\mathbf{M} + \\beta \\mathbf{K} $ with scalar coefficients $ \\alpha $ and $ \\beta $ to be calibrated.\n\nTwo target modal damping ratios $ \\xi_1 $ and $ \\xi_2 $ are prescribed at circular angular frequencies $ \\omega_1 $ and $ \\omega_2 $ associated with two dominant shear modes of the deposit. Starting from the second-order linear single-degree-of-freedom modal equation, and using the definition of modal damping ratio for a linear oscillator, derive the relationship between $ \\xi_i $ and $ \\alpha, \\beta, \\omega_i $ for each mode $ i $. Then, set up the resulting $2\\times 2$ linear system for $ \\alpha $ and $ \\beta $, written explicitly as\n$$\n\\begin{bmatrix}\n\\frac{1}{2 \\omega_1} & \\frac{\\omega_1}{2} \\\\\n\\frac{1}{2 \\omega_2} & \\frac{\\omega_2}{2}\n\\end{bmatrix}\n\\begin{bmatrix}\n\\alpha \\\\[4pt] \\beta\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n\\xi_1 \\\\[4pt] \\xi_2\n\\end{bmatrix}\n$$\nand solve it in closed form for $ \\alpha $ and $ \\beta $ in terms of $ \\xi_1, \\xi_2, \\omega_1, \\omega_2 $.\n\nFinally, analyze the conditioning of the above coefficient matrix with respect to the matrix $2$-norm as the frequency ratio $ r = \\omega_2 / \\omega_1 \\to 1 $, and characterize the asymptotic behavior of the condition number as $ r \\to 1 $.\n\nExpress your final answer as the pair $ (\\alpha, \\beta) $ in symbolic closed form. No numerical evaluation is required.",
            "solution": "The problem statement is validated as follows.\n\n**Step 1: Extract Givens**\n- The linearized semi-discrete equation of motion for a geomechanical system is given as $ \\mathbf{M} \\ddot{\\mathbf{u}}(t) + \\mathbf{C} \\dot{\\mathbf{u}}(t) + \\mathbf{K} \\mathbf{u}(t) = \\mathbf{p}(t) $.\n- $ \\mathbf{M} $ is the mass matrix, $ \\mathbf{K} $ is the stiffness matrix, and $ \\mathbf{C} $ is the damping matrix.\n- A Rayleigh damping model is used, defined as $ \\mathbf{C} = \\alpha \\mathbf{M} + \\beta \\mathbf{K} $, where $ \\alpha $ and $ \\beta $ are scalar coefficients.\n- Two target modal damping ratios, $ \\xi_1 $ and $ \\xi_2 $, are prescribed at two distinct circular angular frequencies, $ \\omega_1 $ and $ \\omega_2 $, respectively.\n- The task is to:\n    1. Derive the relationship between the modal damping ratio $ \\xi_i $ and the coefficients $ \\alpha $, $ \\beta $, and the modal frequency $ \\omega_i $.\n    2. Solve the provided $ 2 \\times 2 $ linear system for $ \\alpha $ and $ \\beta $ in terms of $ \\xi_1, \\xi_2, \\omega_1, \\omega_2 $.\n    3. Analyze the conditioning of the system's coefficient matrix as the frequency ratio $ r = \\omega_2 / \\omega_1 \\to 1 $.\n    4. Provide the final closed-form expressions for $ \\alpha $ and $ \\beta $.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded:** The problem is based on the fundamental theory of linear structural dynamics, a core topic in engineering and physics. The equation of motion, modal analysis, and the Rayleigh damping model are standard, well-established concepts. The problem is scientifically and factually sound.\n- **Well-Posed:** The problem provides all necessary information and definitions to perform the required derivations and analysis. The solution for $ \\alpha $ and $ \\beta $ is unique, provided $ \\omega_1 \\neq \\omega_2 $, a condition implicit in the problem statement which refers to two distinct modes. The required conditioning analysis is a standard mathematical procedure.\n- **Objective:** The problem is stated using precise, unambiguous mathematical and technical language, free of any subjectivity or opinion.\n\n**Step 3: Verdict and Action**\nThe problem is valid as it is scientifically grounded, well-posed, objective, and complete. I will now proceed with the solution.\n\nThe solution is developed in three parts as requested: derivation of the modal damping relationship, solution of the linear system, and conditioning analysis.\n\n**1. Derivation of the Modal Damping Ratio Relationship**\n\nThe equation of motion for a multi-degree-of-freedom (MDOF) linear system is\n$$ \\mathbf{M} \\ddot{\\mathbf{u}}(t) + \\mathbf{C} \\dot{\\mathbf{u}}(t) + \\mathbf{K} \\mathbf{u}(t) = \\mathbf{p}(t) $$\nThe solution can be expressed in terms of the system's mode shapes (eigenvectors) $ \\mathbf{\\Phi} $ and modal coordinates $ \\mathbf{q}(t) $ using the transformation $ \\mathbf{u}(t) = \\mathbf{\\Phi} \\mathbf{q}(t) $. Substituting this into the equation of motion and pre-multiplying by $ \\mathbf{\\Phi}^T $ gives\n$$ \\mathbf{\\Phi}^T \\mathbf{M} \\mathbf{\\Phi} \\ddot{\\mathbf{q}}(t) + \\mathbf{\\Phi}^T \\mathbf{C} \\mathbf{\\Phi} \\dot{\\mathbf{q}}(t) + \\mathbf{\\Phi}^T \\mathbf{K} \\mathbf{\\Phi} \\mathbf{q}(t) = \\mathbf{\\Phi}^T \\mathbf{p}(t) $$\nDue to the orthogonality properties of the eigenvectors with respect to the mass and stiffness matrices, the modal mass matrix $ \\mathbf{M}^* = \\mathbf{\\Phi}^T \\mathbf{M} \\mathbf{\\Phi} $ and the modal stiffness matrix $ \\mathbf{K}^* = \\mathbf{\\Phi}^T \\mathbf{K} \\mathbf{\\Phi} $ are diagonal. The $ i $-th diagonal entries are the modal mass $ m_i^* $ and modal stiffness $ k_i^* $.\n\nFor the Rayleigh damping model $ \\mathbf{C} = \\alpha \\mathbf{M} + \\beta \\mathbf{K} $, the modal damping matrix is\n$$ \\mathbf{C}^* = \\mathbf{\\Phi}^T \\mathbf{C} \\mathbf{\\Phi} = \\mathbf{\\Phi}^T (\\alpha \\mathbf{M} + \\beta \\mathbf{K}) \\mathbf{\\Phi} = \\alpha (\\mathbf{\\Phi}^T \\mathbf{M} \\mathbf{\\Phi}) + \\beta (\\mathbf{\\Phi}^T \\mathbf{K} \\mathbf{\\Phi}) = \\alpha \\mathbf{M}^* + \\beta \\mathbf{K}^* $$\nSince $ \\mathbf{M}^* $ and $ \\mathbf{K}^* $ are diagonal, $ \\mathbf{C}^* $ is also diagonal. This means the system of equations is uncoupled. The equation for the $ i $-th mode is a single-degree-of-freedom (SDOF) equation:\n$$ m_i^* \\ddot{q}_i(t) + c_i^* \\dot{q}_i(t) + k_i^* q_i(t) = p_i^*(t) $$\nwhere $ q_i $ is the $ i $-th modal coordinate, $ p_i^* $ is the $ i $-th modal force, and $ c_i^* $ is the $ i $-th modal damping coefficient, given by $ c_i^* = \\alpha m_i^* + \\beta k_i^* $.\n\nDividing by $ m_i^* $ yields\n$$ \\ddot{q}_i(t) + \\frac{c_i^*}{m_i^*} \\dot{q}_i(t) + \\frac{k_i^*}{m_i^*} q_i(t) = \\frac{p_i^*(t)}{m_i^*} $$\nThe standard form of an SDOF oscillator equation is $ \\ddot{x} + 2\\xi\\omega \\dot{x} + \\omega^2 x = f(t) $. By comparison, we identify the natural circular frequency $ \\omega_i $ and the modal damping ratio $ \\xi_i $ for mode $ i $:\n$$ \\omega_i^2 = \\frac{k_i^*}{m_i^*} \\quad \\text{and} \\quad 2\\xi_i\\omega_i = \\frac{c_i^*}{m_i^*} $$\nSubstituting the expression for $ c_i^* $:\n$$ 2\\xi_i\\omega_i = \\frac{\\alpha m_i^* + \\beta k_i^*}{m_i^*} = \\alpha + \\beta \\left(\\frac{k_i^*}{m_i^*}\\right) = \\alpha + \\beta \\omega_i^2 $$\nFinally, solving for the modal damping ratio $ \\xi_i $ gives the desired relationship:\n$$ \\xi_i = \\frac{1}{2\\omega_i} (\\alpha + \\beta \\omega_i^2) = \\frac{\\alpha}{2\\omega_i} + \\frac{\\beta\\omega_i}{2} $$\n\n**2. Solution of the Linear System for $ \\alpha $ and $ \\beta $**\n\nUsing the relationship derived above for the two target modes ($ i=1, 2 $), we obtain a system of two linear equations for the two unknowns $ \\alpha $ and $ \\beta $:\n$$ \\xi_1 = \\frac{\\alpha}{2\\omega_1} + \\frac{\\beta\\omega_1}{2} $$\n$$ \\xi_2 = \\frac{\\alpha}{2\\omega_2} + \\frac{\\beta\\omega_2}{2} $$\nThis system can be written in matrix form as specified in the problem:\n$$\n\\begin{bmatrix}\n\\frac{1}{2 \\omega_1} & \\frac{\\omega_1}{2} \\\\\n\\frac{1}{2 \\omega_2} & \\frac{\\omega_2}{2}\n\\end{bmatrix}\n\\begin{bmatrix}\n\\alpha \\\\ \\beta\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n\\xi_1 \\\\ \\xi_2\n\\end{bmatrix}\n$$\nLet the coefficient matrix be $ \\mathbf{A} $. To solve for $ \\begin{pmatrix} \\alpha & \\beta \\end{pmatrix}^T $, we must find the inverse of $ \\mathbf{A} $. The determinant of $ \\mathbf{A} $ is\n$$ \\det(\\mathbf{A}) = \\left(\\frac{1}{2\\omega_1}\\right) \\left(\\frac{\\omega_2}{2}\\right) - \\left(\\frac{\\omega_1}{2}\\right) \\left(\\frac{1}{2\\omega_2}\\right) = \\frac{\\omega_2}{4\\omega_1} - \\frac{\\omega_1}{4\\omega_2} = \\frac{\\omega_2^2 - \\omega_1^2}{4\\omega_1\\omega_2} $$\nThe inverse matrix $ \\mathbf{A}^{-1} $ is\n$$ \\mathbf{A}^{-1} = \\frac{1}{\\det(\\mathbf{A})} \\begin{bmatrix} \\frac{\\omega_2}{2} & -\\frac{\\omega_1}{2} \\\\ -\\frac{1}{2\\omega_2} & \\frac{1}{2\\omega_1} \\end{bmatrix} = \\frac{4\\omega_1\\omega_2}{\\omega_2^2 - \\omega_1^2} \\begin{bmatrix} \\frac{\\omega_2}{2} & -\\frac{\\omega_1}{2} \\\\ -\\frac{1}{2\\omega_2} & \\frac{1}{2\\omega_1} \\end{bmatrix} = \\frac{2\\omega_1\\omega_2}{\\omega_2^2 - \\omega_1^2} \\begin{bmatrix} \\omega_2 & -\\omega_1 \\\\ -\\frac{1}{\\omega_2} & \\frac{1}{\\omega_1} \\end{bmatrix} $$\nThe solution is obtained by pre-multiplying the vector of damping ratios by $ \\mathbf{A}^{-1} $:\n$$ \\begin{bmatrix} \\alpha \\\\ \\beta \\end{bmatrix} = \\mathbf{A}^{-1} \\begin{bmatrix} \\xi_1 \\\\ \\xi_2 \\end{bmatrix} = \\frac{2\\omega_1\\omega_2}{\\omega_2^2 - \\omega_1^2} \\begin{bmatrix} \\omega_2 & -\\omega_1 \\\\ -\\frac{1}{\\omega_2} & \\frac{1}{\\omega_1} \\end{bmatrix} \\begin{bmatrix} \\xi_1 \\\\ \\xi_2 \\end{bmatrix} $$\nCarrying out the matrix-vector multiplication gives the closed-form solutions for $ \\alpha $ and $ \\beta $:\n$$ \\alpha = \\frac{2\\omega_1\\omega_2}{\\omega_2^2 - \\omega_1^2} (\\xi_1 \\omega_2 - \\xi_2 \\omega_1) $$\n$$ \\beta = \\frac{2\\omega_1\\omega_2}{\\omega_2^2 - \\omega_1^2} \\left(-\\frac{\\xi_1}{\\omega_2} + \\frac{\\xi_2}{\\omega_1}\\right) = \\frac{2\\omega_1\\omega_2}{\\omega_2^2 - \\omega_1^2} \\left(\\frac{-\\xi_1\\omega_1 + \\xi_2\\omega_2}{\\omega_1\\omega_2}\\right) = \\frac{2(\\xi_2 \\omega_2 - \\xi_1 \\omega_1)}{\\omega_2^2 - \\omega_1^2} $$\n\n**3. Conditioning Analysis**\n\nWe analyze the condition number $ \\kappa_2(\\mathbf{A}) = ||\\mathbf{A}||_2 ||\\mathbf{A}^{-1}||_2 $ in the limit where the frequency ratio $ r = \\omega_2 / \\omega_1 \\to 1 $. Let's set $ \\omega_2 = r \\omega_1 $ and examine the behavior as $ r \\to 1^+ $.\n\nFirst, consider the matrix $ \\mathbf{A} $:\n$$ \\mathbf{A} = \\frac{1}{2} \\begin{bmatrix} \\omega_1^{-1} & \\omega_1 \\\\ (r\\omega_1)^{-1} & r\\omega_1 \\end{bmatrix} $$\nAs $ r \\to 1 $, $ \\mathbf{A} $ approaches a rank-1 matrix $ \\mathbf{A}_1 = \\frac{1}{2} \\begin{bmatrix} \\omega_1^{-1} & \\omega_1 \\\\ \\omega_1^{-1} & \\omega_1 \\end{bmatrix} $. The $ 2 $-norm $ ||\\mathbf{A}||_2 $ is continuous, so $ ||\\mathbf{A}||_2 \\to ||\\mathbf{A}_1||_2 $. The norm of $ \\mathbf{A}_1 $ is its largest singular value, which is finite and non-zero (assuming $ \\omega_1 \\neq 0 $).\n$ ||\\mathbf{A}_1||_2 = \\sigma_{max}(\\mathbf{A}_1) = \\sqrt{\\lambda_{max}(\\mathbf{A}_1^T \\mathbf{A}_1)} = \\sqrt{\\frac{1}{2}(\\omega_1^2 + \\omega_1^{-2})} $. Thus, $ ||\\mathbf{A}||_2 $ approaches a finite constant as $ r \\to 1 $.\n\nNext, consider the inverse matrix $ \\mathbf{A}^{-1} $:\n$$ \\mathbf{A}^{-1} = \\frac{2\\omega_1 (r\\omega_1)}{(r\\omega_1)^2 - \\omega_1^2} \\begin{bmatrix} r\\omega_1 & -\\omega_1 \\\\ -(r\\omega_1)^{-1} & \\omega_1^{-1} \\end{bmatrix} = \\frac{2r}{r^2 - 1} \\begin{bmatrix} r\\omega_1 & -\\omega_1 \\\\ -(r\\omega_1)^{-1} & \\omega_1^{-1} \\end{bmatrix} $$\nAs $ r \\to 1 $, the term $ r^2 - 1 = (r-1)(r+1) \\approx 2(r-1) $. The pre-factor behaves as $ \\frac{2(1)}{2(r-1)} = \\frac{1}{r-1} $. The matrix part approaches $ \\begin{bmatrix} \\omega_1 & -\\omega_1 \\\\ -\\omega_1^{-1} & \\omega_1^{-1} \\end{bmatrix} $.\nThus, $ ||\\mathbf{A}^{-1}||_2 $ grows asymptotically as $ O((r-1)^{-1}) $. This signifies that the system becomes ill-conditioned as the two frequencies get closer. The ill-conditioning arises because the two rows of the matrix $ \\mathbf{A} $ become nearly identical, making it numerically close to singular.\n\nThe asymptotic behavior of the condition number is\n$$ \\kappa_2(\\mathbf{A}) = ||\\mathbf{A}||_2 ||\\mathbf{A}^{-1}||_2 \\sim \\frac{C}{r-1} \\quad \\text{as } r \\to 1 $$\nwhere $ C $ is a constant determined by the limiting norms.\n$ C = ||\\mathbf{A}_1||_2 \\cdot \\lim_{r\\to 1} ||(r-1)\\mathbf{A}^{-1}||_2 = \\left(\\sqrt{\\frac{1}{2}(\\omega_1^2 + \\omega_1^{-2})}\\right) \\cdot \\left(\\sqrt{2(\\omega_1^2+\\omega_1^{-2})}\\right) = \\omega_1^2 + \\omega_1^{-2} $.\nTherefore, the asymptotic behavior is characterized by:\n$$ \\kappa_2(\\mathbf{A}) \\sim \\frac{\\omega_1^2 + \\omega_1^{-2}}{r-1} = \\frac{\\omega_1(\\omega_1^2 + \\omega_1^{-2})}{\\omega_2 - \\omega_1} \\quad \\text{as } \\omega_2 \\to \\omega_1 $$\nThe condition number diverges as the reciprocal of the frequency separation, indicating severe numerical sensitivity when calibrating damping ratios at closely spaced frequencies.",
            "answer": "$$ \\boxed{ \\begin{pmatrix} \\frac{2\\omega_1\\omega_2(\\xi_1 \\omega_2 - \\xi_2 \\omega_1)}{\\omega_2^2 - \\omega_1^2} & \\frac{2(\\xi_2 \\omega_2 - \\xi_1 \\omega_1)}{\\omega_2^2 - \\omega_1^2} \\end{pmatrix} } $$"
        },
        {
            "introduction": "The Rayleigh damping model consists of two distinct parts: a mass-proportional term and a stiffness-proportional term. This exercise delves into their unique physical roles by examining a system with a rigid-body mode, a common feature in unconstrained structures like satellites or free-floating platforms . You will demonstrate why stiffness-proportional damping alone is insufficient for these systems and learn how to select a minimal mass-proportional coefficient to control rigid-body drift without excessively damping the deformational dynamics.",
            "id": "3593239",
            "problem": "Consider a linear elastic body discretized by a two-degree-of-freedom (DOF) lumped model that represents a one-dimensional free-free bar with homogeneous Neumann (traction-free) boundary conditions. The mass and stiffness matrices are\n$$\n\\mathbf{M} = m\n\\begin{bmatrix}\n1 & 0\\\\\n0 & 1\n\\end{bmatrix},\n\\qquad\n\\mathbf{K} = k\n\\begin{bmatrix}\n1 & -1\\\\\n-1 & 1\n\\end{bmatrix},\n$$\nwith given physical parameters $m=1.0$ and $k=20000$, where $m$ is in kilograms and $k$ is in newtons per meter. The damping is Rayleigh proportional, defined by\n$$\n\\mathbf{C} = \\alpha\\,\\mathbf{M} + \\beta\\,\\mathbf{K},\n$$\nwith $\\alpha$ and $\\beta$ real scalars. The semi-discrete free-vibration equations of motion are\n$$\n\\mathbf{M}\\,\\ddot{\\mathbf{u}}(t) + \\mathbf{C}\\,\\dot{\\mathbf{u}}(t) + \\mathbf{K}\\,\\mathbf{u}(t) = \\mathbf{0}.\n$$\nYou are to reason from first principles to address how boundary conditions affect damping of rigid-body motions under Rayleigh proportional damping and to determine a minimal mass-proportional damping coefficient that controls those motions without overly damping deformational dynamics.\n\nTasks:\n1) Using only the definitions above, and without invoking any prepackaged modal damping formulas, show that when $\\alpha=0$ the stiffness-proportional damping term $\\beta\\,\\mathbf{K}$ leaves the rigid-body motion associated with homogeneous Neumann boundary conditions undamped.\n\n2) The stiffness-proportional damping parameter $\\beta$ is preselected so that, when $\\alpha$ is negligible, the unique deformational mode of this two-DOF system exhibits a modal damping ratio of $\\zeta_{d0}=0.03$. Impose the design requirement that after adding $\\alpha$ the modal damping ratio of this deformational mode must not exceed $\\zeta_{\\max}=0.05$. In addition, to control the rigid-body drift, require that the magnitude of the rigid-body velocity decays by a factor of $10$ over a time horizon $T=0.5$ seconds. Determine the minimal $\\alpha$ that satisfies both requirements.\n\nInstructions:\n- Derive all relations you use starting from $\\mathbf{M}\\,\\ddot{\\mathbf{u}} + \\mathbf{C}\\,\\dot{\\mathbf{u}} + \\mathbf{K}\\,\\mathbf{u}=\\mathbf{0}$ and the given Rayleigh form for $\\mathbf{C}$.\n- Round your final numerical value of $\\alpha$ to four significant figures.\n- Express the final $\\alpha$ in $\\mathrm{s}^{-1}$.",
            "solution": "The analysis of the system begins with the semi-discrete free-vibration equations of motion for a two-degree-of-freedom (DOF) system:\n$$\n\\mathbf{M}\\,\\ddot{\\mathbf{u}}(t) + \\mathbf{C}\\,\\dot{\\mathbf{u}}(t) + \\mathbf{K}\\,\\mathbf{u}(t) = \\mathbf{0}\n$$\nwhere $\\mathbf{M}$ is the mass matrix, $\\mathbf{C}$ is the damping matrix, and $\\mathbf{K}$ is the stiffness matrix. The Rayleigh proportional damping model defines the damping matrix as a linear combination of the mass and stiffness matrices:\n$$\n\\mathbf{C} = \\alpha\\,\\mathbf{M} + \\beta\\,\\mathbf{K}\n$$\nThe system is a model of a free-free bar, which implies the existence of a rigid-body mode. This is reflected in the singularity of the stiffness matrix $\\mathbf{K}$.\n\nFirst, we determine the natural frequencies and mode shapes of the undamped system by solving the generalized eigenvalue problem $\\mathbf{K}\\mathbf{\\phi} = \\omega^2\\mathbf{M}\\mathbf{\\phi}$.\n$$\n\\det(\\mathbf{K} - \\omega^2\\mathbf{M}) = \\det\\left( k \\begin{bmatrix} 1 & -1 \\\\ -1 & 1 \\end{bmatrix} - \\omega^2 m \\begin{bmatrix} 1 & 0 \\\\ 0 & 1 \\end{bmatrix} \\right) = 0\n$$\n$$\n\\det\\left( \\begin{bmatrix} k-m\\omega^2 & -k \\\\ -k & k-m\\omega^2 \\end{bmatrix} \\right) = (k-m\\omega^2)^2 - k^2 = 0\n$$\nThis yields two solutions for $\\omega^2$:\n1. $k-m\\omega^2 = k \\implies m\\omega^2 = 0 \\implies \\omega_1^2 = 0$. This corresponds to the rigid-body mode.\n2. $k-m\\omega^2 = -k \\implies m\\omega^2 = 2k \\implies \\omega_2^2 = \\frac{2k}{m}$. This corresponds to the deformational mode.\n\nThe corresponding mode shapes (eigenvectors) $\\mathbf{\\phi}_i$ are found by solving $(\\mathbf{K} - \\omega_i^2\\mathbf{M})\\mathbf{\\phi}_i = \\mathbf{0}$.\nFor $\\omega_1^2 = 0$:\n$$\nk \\begin{bmatrix} 1 & -1 \\\\ -1 & 1 \\end{bmatrix} \\mathbf{\\phi}_1 = \\mathbf{0} \\implies \\mathbf{\\phi}_1 = c_1 \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}\n$$\nThis mode shape represents a uniform translation of the two masses, which is the rigid-body motion.\nFor $\\omega_2^2 = \\frac{2k}{m}$:\n$$\n\\left( k \\begin{bmatrix} 1 & -1 \\\\ -1 & 1 \\end{bmatrix} - \\frac{2k}{m} m \\begin{bmatrix} 1 & 0 \\\\ 0 & 1 \\end{bmatrix} \\right) \\mathbf{\\phi}_2 = k \\begin{bmatrix} -1 & -1 \\\\ -1 & -1 \\end{bmatrix} \\mathbf{\\phi}_2 = \\mathbf{0} \\implies \\mathbf{\\phi}_2 = c_2 \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}\n$$\nThis mode shape represents the masses moving in opposite directions, which is the deformational motion.\n\n**1) Analysis of Stiffness-Proportional Damping ($\\alpha=0$)**\n\nWe are asked to show that for $\\alpha=0$, the damping term $\\mathbf{C} = \\beta\\mathbf{K}$ leaves the rigid-body motion undamped. A general motion can be expressed as a superposition of the modes: $\\mathbf{u}(t) = q_1(t)\\mathbf{\\phi}_1 + q_2(t)\\mathbf{\\phi}_2$. The rigid-body motion is isolated by considering only the first mode: $\\mathbf{u}_{rb}(t) = q_1(t)\\mathbf{\\phi}_1$.\nSubstituting this into the equation of motion with $\\mathbf{C} = \\beta\\mathbf{K}$:\n$$\n\\mathbf{M}(\\ddot{q}_1\\mathbf{\\phi}_1) + (\\beta\\mathbf{K})(\\dot{q}_1\\mathbf{\\phi}_1) + \\mathbf{K}(q_1\\mathbf{\\phi}_1) = \\mathbf{0}\n$$\nRearranging the scalar modal coordinates:\n$$\n(\\mathbf{M}\\mathbf{\\phi}_1)\\ddot{q}_1 + (\\beta\\mathbf{K}\\mathbf{\\phi}_1)\\dot{q}_1 + (\\mathbf{K}\\mathbf{\\phi}_1)q_1 = \\mathbf{0}\n$$\nBy definition, the rigid-body mode shape $\\mathbf{\\phi}_1$ is in the null space of the stiffness matrix, so $\\mathbf{K}\\mathbf{\\phi}_1 = \\mathbf{0}$. The equation simplifies to:\n$$\n(\\mathbf{M}\\mathbf{\\phi}_1)\\ddot{q}_1 + \\mathbf{0} + \\mathbf{0} = \\mathbf{0} \\implies \\mathbf{M}\\mathbf{\\phi}_1\\ddot{q}_1 = \\mathbf{0}\n$$\nTo obtain a scalar equation, we pre-multiply by $\\mathbf{\\phi}_1^T$:\n$$\n\\mathbf{\\phi}_1^T\\mathbf{M}\\mathbf{\\phi}_1\\ddot{q}_1 = 0\n$$\nThe modal mass $\\mathbf{\\phi}_1^T\\mathbf{M}\\mathbf{\\phi}_1$ is a positive scalar because $\\mathbf{M}$ is positive definite and $\\mathbf{\\phi}_1$ is a non-zero vector. Therefore, we must have $\\ddot{q}_1(t) = 0$.\nThe solution to this is $\\dot{q}_1(t) = \\text{constant}$ and $q_1(t) = A + Bt$. This represents a constant velocity and linearly increasing displacement, which is characteristic of an undamped rigid-body motion. Thus, stiffness-proportional damping exerts no control over the rigid-body mode.\n\n**2) Determination of minimal $\\alpha$**\n\nWe now consider the full Rayleigh damping model $\\mathbf{C} = \\alpha\\mathbf{M} + \\beta\\mathbf{K}$. We proceed by meeting the stated design requirements.\n\n**Determination of $\\beta$**\n\nFirst, we determine the value of $\\beta$ from the condition on the deformational mode. The motion is projected onto the modal basis. For the deformational mode ($i=2$), the uncoupled modal equation is obtained by pre-multiplying the equation of motion by $\\mathbf{\\phi}_2^T$ and substituting $\\mathbf{u}=q_2\\mathbf{\\phi}_2$:\n$$\n\\mathbf{\\phi}_2^T\\mathbf{M}\\mathbf{\\phi}_2 \\ddot{q}_2 + \\mathbf{\\phi}_2^T\\mathbf{C}\\mathbf{\\phi}_2 \\dot{q}_2 + \\mathbf{\\phi}_2^T\\mathbf{K}\\mathbf{\\phi}_2 q_2 = 0\n$$\nUsing $\\mathbf{C} = \\alpha\\mathbf{M} + \\beta\\mathbf{K}$ and the orthogonality relations for mass-normalized eigenvectors (which we can conceptually invoke without normalization by dividing through by the modal mass $M_2 = \\mathbf{\\phi}_2^T\\mathbf{M}\\mathbf{\\phi}_2$):\n$$\n\\ddot{q}_2 + \\frac{\\mathbf{\\phi}_2^T(\\alpha\\mathbf{M} + \\beta\\mathbf{K})\\mathbf{\\phi}_2}{\\mathbf{\\phi}_2^T\\mathbf{M}\\mathbf{\\phi}_2} \\dot{q}_2 + \\frac{\\mathbf{\\phi}_2^T\\mathbf{K}\\mathbf{\\phi}_2}{\\mathbf{\\phi}_2^T\\mathbf{M}\\mathbf{\\phi}_2} q_2 = 0\n$$\nRecognizing that $\\omega_2^2 = \\frac{\\mathbf{\\phi}_2^T\\mathbf{K}\\mathbf{\\phi}_2}{\\mathbf{\\phi}_2^T\\mathbf{M}\\mathbf{\\phi}_2}$, the equation becomes:\n$$\n\\ddot{q}_2 + \\left(\\alpha + \\beta\\omega_2^2\\right)\\dot{q}_2 + \\omega_2^2 q_2 = 0\n$$\nThis is a standard second-order ODE of the form $\\ddot{q}_2 + 2\\zeta_2\\omega_2\\dot{q}_2 + \\omega_2^2 q_2 = 0$, where $\\zeta_2$ is the modal damping ratio. By comparison, $2\\zeta_2\\omega_2 = \\alpha + \\beta\\omega_2^2$, which gives:\n$$\n\\zeta_2 = \\frac{\\alpha}{2\\omega_2} + \\frac{\\beta\\omega_2}{2}\n$$\nThe problem states that for negligible $\\alpha$, the damping ratio of this mode is $\\zeta_{d0}=0.03$. So, $\\zeta_{d0} = \\frac{\\beta\\omega_2}{2}$.\nWe use the given parameters $m=1.0$ and $k=20000$ to find $\\omega_2$:\n$$\n\\omega_2 = \\sqrt{\\frac{2k}{m}} = \\sqrt{\\frac{2(20000)}{1.0}} = \\sqrt{40000} = 200 \\; \\text{rad}\\,\\mathrm{s}^{-1}\n$$\nNow we can solve for $\\beta$:\n$$\n\\beta = \\frac{2\\zeta_{d0}}{\\omega_2} = \\frac{2(0.03)}{200} = \\frac{0.06}{200} = 0.0003\n$$\n\n**Applying the Design Constraints on $\\alpha$**\n\n**Constraint 1: Maximum damping of deformational mode.**\nThe damping ratio of the deformational mode, $\\zeta_2$, must not exceed $\\zeta_{\\max}=0.05$.\n$$\n\\zeta_2 = \\frac{\\alpha}{2\\omega_2} + \\frac{\\beta\\omega_2}{2} \\le \\zeta_{\\max}\n$$\nSubstituting The term $\\frac{\\beta\\omega_2}{2}$ is $\\zeta_{d0}=0.03$:\n$$\n\\frac{\\alpha}{2\\omega_2} + 0.03 \\le 0.05 \\implies \\frac{\\alpha}{2(200)} \\le 0.02\n$$\n$$\n\\frac{\\alpha}{400} \\le 0.02 \\implies \\alpha \\le 400 \\times 0.02 \\implies \\alpha \\le 8.0\n$$\nThis provides the upper bound for $\\alpha$.\n\n**Constraint 2: Damping of rigid-body motion.**\nWe analyze the rigid-body mode ($i=1$) with the full damping matrix. The modal equation for $q_1(t)$ is derived by substituting $\\mathbf{u}_{rb}(t) = q_1(t)\\mathbf{\\phi}_1$ into the full equation of motion and pre-multiplying by $\\mathbf{\\phi}_1^T$:\n$$\n\\mathbf{\\phi}_1^T\\mathbf{M}\\mathbf{\\phi}_1 \\ddot{q}_1 + \\mathbf{\\phi}_1^T(\\alpha\\mathbf{M} + \\beta\\mathbf{K})\\mathbf{\\phi}_1 \\dot{q}_1 + \\mathbf{\\phi}_1^T\\mathbf{K}\\mathbf{\\phi}_1 q_1 = 0\n$$\nUsing $\\mathbf{K}\\mathbf{\\phi}_1 = \\mathbf{0}$, the equation simplifies to:\n$$\n(\\mathbf{\\phi}_1^T\\mathbf{M}\\mathbf{\\phi}_1) \\ddot{q}_1 + \\alpha(\\mathbf{\\phi}_1^T\\mathbf{M}\\mathbf{\\phi}_1) \\dot{q}_1 = 0\n$$\nDividing by the non-zero modal mass $\\mathbf{\\phi}_1^T\\mathbf{M}\\mathbf{\\phi}_1$, we obtain:\n$$\n\\ddot{q}_1 + \\alpha \\dot{q}_1 = 0\n$$\nThis is a first-order equation for the modal velocity $v_1(t) = \\dot{q}_1(t)$: $\\dot{v}_1 + \\alpha v_1 = 0$. The solution is $v_1(t) = v_1(0)\\exp(-\\alpha t)$. The physical velocity of the rigid-body motion is $\\dot{\\mathbf{u}}_{rb}(t) = \\dot{q}_1(t)\\mathbf{\\phi}_1 = v_1(t)\\mathbf{\\phi}_1$.\nThe requirement is that the magnitude of this velocity decays by a factor of $10$ over $T=0.5$ seconds. To control the drift, the decay must be at least this much. Thus:\n$$\n\\frac{||\\dot{\\mathbf{u}}_{rb}(T)||}{||\\dot{\\mathbf{u}}_{rb}(0)||} = \\frac{|v_1(T)|}{|v_1(0)|} = \\exp(-\\alpha T) \\le \\frac{1}{10}\n$$\nTaking the natural logarithm of both sides:\n$$\n-\\alpha T \\le \\ln\\left(\\frac{1}{10}\\right) \\implies -\\alpha T \\le -\\ln(10)\n$$\nMultiplying by $-1$ reverses the inequality:\n$$\n\\alpha T \\ge \\ln(10) \\implies \\alpha \\ge \\frac{\\ln(10)}{T}\n$$\nUsing $T=0.5$:\n$$\n\\alpha \\ge \\frac{\\ln(10)}{0.5} = 2\\ln(10) \\approx 2 \\times 2.302585 = 4.60517\n$$\nThis provides the lower bound for $\\alpha$.\n\n**Finding the Minimal $\\alpha$**\n\nWe must find the minimal $\\alpha$ that satisfies both constraints:\n1. $\\alpha \\le 8.0$\n2. $\\alpha \\ge 4.60517...$\n\nThe set of valid $\\alpha$ values is the interval $[4.60517..., 8.0]$. The minimal value of $\\alpha$ in this set is the lower bound.\n$$\n\\alpha_{\\min} = 2\\ln(10) \\approx 4.60517\n$$\nRounding to four significant figures, we get $\\alpha = 4.605$. The units of $\\alpha$ are $\\mathrm{s}^{-1}$ since $\\alpha t$ is dimensionless.",
            "answer": "$$\n\\boxed{4.605}\n$$"
        },
        {
            "introduction": "While matching damping at two points is instructive, real-world scenarios often provide damping measurements at multiple modes, which rarely lie perfectly on a single Rayleigh curve. This practice moves beyond the idealized two-point fit to the more practical task of parameter estimation from a set of experimental data . You will formulate a weighted least-squares problem to find the optimal coefficients $\\alpha$ and $\\beta$ that best fit the observed data, incorporating physical non-negativity constraints and learning a powerful method for model calibration.",
            "id": "3515260",
            "problem": "You are tasked with calibrating a proportional damping model for a linear elastic, viscously damped geomechanical system using numerical data from modal analysis. The fundamental model assumption is that the damping matrix is a linear combination of the mass and stiffness matrices. Starting from the second-order equation of motion for a linear continuum discretization, derive the functional dependence of the modal damping ratio on the modal circular frequency, and then pose a weighted least-squares parameter estimation problem for the coefficients that define the proportional damping model. Solve this estimation problem subject to non-negativity constraints on the coefficients.\n\nUse the following foundational base:\n- Newtonâ€™s second law applied to a discretized continuum: the semi-discrete equation of motion is $ \\mathbf{M} \\ddot{\\mathbf{u}}(t) + \\mathbf{C} \\dot{\\mathbf{u}}(t) + \\mathbf{K} \\mathbf{u}(t) = \\mathbf{0} $, where $ \\mathbf{M} $ is the mass matrix, $ \\mathbf{C} $ is the damping matrix, $ \\mathbf{K} $ is the stiffness matrix, and $ \\mathbf{u}(t) $ is the displacement vector.\n- The proportional damping assumption (Rayleigh damping): $ \\mathbf{C} = \\alpha \\mathbf{M} + \\beta \\mathbf{K} $, where $ \\alpha $ and $ \\beta $ are non-negative scalars to be determined.\n- Modal decomposition under classical assumptions yields uncoupled scalar equations along vibration modes.\n\nYour program should:\n1. Derive, from the above base, the expression for the modal damping ratio $ \\xi(\\omega) $ as a function of the modal circular frequency $ \\omega $ and the proportional damping coefficients $ \\alpha $ and $ \\beta $.\n2. Formulate the weighted least-squares problem that estimates $ \\alpha $ and $ \\beta $ by minimizing the sum of squared weighted errors between the modeled modal damping ratios and the experimentally identified modal damping ratios. The weights should be incorporated as positive scalars $ w_i $ multiplying each squared residual. Impose the physically motivated constraints $ \\alpha \\ge 0 $ and $ \\beta \\ge 0 $.\n3. Implement a numerically stable algorithm to solve the constrained weighted least-squares problem for each test case and report the fitted parameters and the quality-of-fit.\n\nUnits and numerical output requirements:\n- Modal circular frequencies $ \\omega_i $ are given in radians per second (rad/s).\n- Damping ratios $ \\xi_i $ are dimensionless.\n- Report $ \\alpha $ in $ \\mathrm{s}^{-1} $ and $ \\beta $ in $ \\mathrm{s} $.\n- For each test case, compute the weighted root-mean-square error (RMSE) of the damping ratio fit, defined as $ \\sqrt{ \\frac{ \\sum_i w_i \\left( \\xi(\\omega_i) - \\xi_i \\right)^2 }{ \\sum_i w_i } } $ (dimensionless).\n- Round all reported floating-point outputs to six decimal places.\n\nTest suite:\nProvide results for the following four test cases. Each test case consists of a list of modal circular frequencies $ \\omega_i $ (in rad/s), measured damping ratios $ \\xi_i $ (dimensionless), and positive weights $ w_i $:\n\n- Test case 1 (general case, moderate spread, equal weights):\n  - $ \\omega = [10, 20, 40, 80] $\n  - $ \\xi = [0.1027, 0.1988, 0.4029, 0.7951] $\n  - $ w = [1, 1, 1, 1] $\n\n- Test case 2 (two-mode boundary case, unequal weights emphasizing the lower mode):\n  - $ \\omega = [15, 60] $\n  - $ \\xi = [0.0408333, 0.1508333] $\n  - $ w = [2.0, 0.5] $\n\n- Test case 3 (ill-conditioned design: repeated frequency values, equal weights):\n  - $ \\omega = [50, 50, 50] $\n  - $ \\xi = [0.2480, 0.2510, 0.2495] $\n  - $ w = [1, 1, 1] $\n\n- Test case 4 (wide frequency range, weights proportional to frequency):\n  - $ \\omega = [0.5, 2, 5, 20, 100, 200] $\n  - $ \\xi = [0.0201, 0.0062, 0.0043, 0.0107, 0.0496, 0.1004] $\n  - $ w = [0.5, 2, 5, 20, 100, 200] $\n\nFinal output format:\nYour program should produce a single line of output containing a comma-separated list of four entries (one per test case), enclosed in square brackets. Each entry must itself be a list of three floating-point numbers $ [\\alpha, \\beta, \\mathrm{RMSE}] $ for the corresponding test case, rounded to six decimal places. For example: \"[[a1,b1,e1],[a2,b2,e2],[a3,b3,e3],[a4,b4,e4]]\". No other text should be printed.",
            "solution": "The task is to determine the optimal non-negative coefficients, $\\alpha$ and $\\beta$, for a Rayleigh proportional damping model, $\\mathbf{C} = \\alpha \\mathbf{M} + \\beta \\mathbf{K}$, by fitting the model to experimentally measured modal damping data. This will be accomplished by deriving the relationship between the modal damping ratio and the modal frequency, formulating a constrained weighted least-squares problem, and implementing a numerical solution.\n\nThe starting point is the semi-discrete equation of motion for a linear, viscously damped system:\n$$\n\\mathbf{M} \\ddot{\\mathbf{u}}(t) + \\mathbf{C} \\dot{\\mathbf{u}}(t) + \\mathbf{K} \\mathbf{u}(t) = \\mathbf{0}\n$$\nHere, $\\mathbf{M}$ is the mass matrix, $\\mathbf{K}$ is the stiffness matrix, $\\mathbf{C}$ is the damping matrix, and $\\mathbf{u}(t)$ is the vector of nodal displacements.\n\nFirst, we establish the properties of the undamped system ($\\mathbf{C} = \\mathbf{0}$) by solving the generalized eigenvalue problem:\n$$\n\\mathbf{K} \\mathbf{\\phi}_i = \\omega_i^2 \\mathbf{M} \\mathbf{\\phi}_i\n$$\nThis yields the natural circular frequencies $\\omega_i$ and the corresponding mode shapes (eigenvectors) $\\mathbf{\\phi}_i$. The mode shapes possess the crucial properties of orthogonality with respect to the mass and stiffness matrices. Assuming M-normalized eigenvectors, we have:\n$$\n\\mathbf{\\phi}_j^T \\mathbf{M} \\mathbf{\\phi}_i = \\delta_{ij} \\quad (\\text{M-orthonormality})\n$$\n$$\n\\mathbf{\\phi}_j^T \\mathbf{K} \\mathbf{\\phi}_i = \\omega_i^2 \\delta_{ij} \\quad (\\text{K-orthogonality})\n$$\nwhere $\\delta_{ij}$ is the Kronecker delta.\n\nNext, we analyze the damped system using modal coordinates. The displacement vector $\\mathbf{u}(t)$ is expressed as a linear combination of the mode shapes:\n$$\n\\mathbf{u}(t) = \\sum_{i=1}^{N} q_i(t) \\mathbf{\\phi}_i\n$$\nwhere $q_i(t)$ are the modal (or generalized) coordinates. Substituting this modal expansion into the equation of motion and pre-multiplying by an arbitrary mode shape $\\mathbf{\\phi}_j^T$ yields:\n$$\n\\mathbf{\\phi}_j^T \\mathbf{M} \\sum_{i} \\ddot{q}_i \\mathbf{\\phi}_i + \\mathbf{\\phi}_j^T \\mathbf{C} \\sum_{i} \\dot{q}_i \\mathbf{\\phi}_i + \\mathbf{\\phi}_j^T \\mathbf{K} \\sum_{i} q_i \\mathbf{\\phi}_i = 0\n$$\nUsing the orthogonality properties, this simplifies to:\n$$\n\\ddot{q}_j(t) + \\sum_{i} (\\mathbf{\\phi}_j^T \\mathbf{C} \\mathbf{\\phi}_i) \\dot{q}_i(t) + \\omega_j^2 q_j(t) = 0\n$$\nThe system of equations uncouples into a set of independent scalar differential equations if and only if the modal damping matrix $\\mathbf{\\phi}_j^T \\mathbf{C} \\mathbf{\\phi}_i$ is diagonal. This condition is met by proportional damping models. For Rayleigh damping, $\\mathbf{C} = \\alpha \\mathbf{M} + \\beta \\mathbf{K}$, the off-diagonal terms are:\n$$\n\\mathbf{\\phi}_j^T \\mathbf{C} \\mathbf{\\phi}_i = \\mathbf{\\phi}_j^T (\\alpha \\mathbf{M} + \\beta \\mathbf{K}) \\mathbf{\\phi}_i = \\alpha (\\mathbf{\\phi}_j^T \\mathbf{M} \\mathbf{\\phi}_i) + \\beta (\\mathbf{\\phi}_j^T \\mathbf{K} \\mathbf{\\phi}_i) = \\alpha(0) + \\beta(0) = 0 \\quad \\text{for } i \\neq j\n$$\nThe diagonal terms, which define the modal damping, are:\n$$\nc_j = \\mathbf{\\phi}_j^T \\mathbf{C} \\mathbf{\\phi}_j = \\alpha (\\mathbf{\\phi}_j^T \\mathbf{M} \\mathbf{\\phi}_j) + \\beta (\\mathbf{\\phi}_j^T \\mathbf{K} \\mathbf{\\phi}_j) = \\alpha(1) + \\beta(\\omega_j^2) = \\alpha + \\beta \\omega_j^2\n$$\nThus, for each mode $j$, we have an uncoupled single-degree-of-freedom oscillator equation:\n$$\n\\ddot{q}_j(t) + (\\alpha + \\beta \\omega_j^2) \\dot{q}_j(t) + \\omega_j^2 q_j(t) = 0\n$$\nThe standard form for such an oscillator is $\\ddot{q} + 2\\xi\\omega_n\\dot{q} + \\omega_n^2 q = 0$, where $\\xi$ is the damping ratio and $\\omega_n$ is the natural frequency. By comparing the terms, we identify $\\omega_n = \\omega_j$ and $2\\xi_j\\omega_j = \\alpha + \\beta \\omega_j^2$. Solving for the modal damping ratio $\\xi_j$ gives the desired functional relationship:\n$$\n\\xi_j = \\xi(\\omega_j) = \\frac{\\alpha + \\beta \\omega_j^2}{2\\omega_j} = \\frac{\\alpha}{2\\omega_j} + \\frac{\\beta\\omega_j}{2}\n$$\nThis equation forms the basis of our parameter estimation. We are given a set of $n$ experimental data points $(\\omega_i, \\xi_i, w_i)$, where $\\omega_i$ are the measured modal frequencies, $\\xi_i$ are the measured modal damping ratios, and $w_i > 0$ are weights reflecting the confidence in each measurement.\n\nThe goal is to find the non-negative parameters $\\alpha$ and $\\beta$ that minimize the weighted sum of squared residuals between the model's predictions and the experimental data. The objective function, $S(\\alpha, \\beta)$, is:\n$$\nS(\\alpha, \\beta) = \\sum_{i=1}^{n} w_i \\left( \\xi(\\omega_i) - \\xi_i \\right)^2 = \\sum_{i=1}^{n} w_i \\left( \\left(\\frac{\\alpha}{2\\omega_i} + \\frac{\\beta\\omega_i}{2}\\right) - \\xi_i \\right)^2\n$$\nWe seek to solve the constrained optimization problem:\n$$\n\\min_{\\alpha, \\beta} S(\\alpha, \\beta) \\quad \\text{subject to} \\quad \\alpha \\ge 0, \\beta \\ge 0\n$$\nThis is a weighted linear least-squares problem. Let's express it in matrix form. We define a design matrix $\\mathbf{A}$, a parameter vector $\\mathbf{x}$, and an observation vector $\\mathbf{b}$:\n$$\n\\mathbf{A} = \\begin{bmatrix}\n\\frac{1}{2\\omega_1} & \\frac{\\omega_1}{2} \\\\\n\\frac{1}{2\\omega_2} & \\frac{\\omega_2}{2} \\\\\n\\vdots & \\vdots \\\\\n\\frac{1}{2\\omega_n} & \\frac{\\omega_n}{2}\n\\end{bmatrix}, \\quad\n\\mathbf{x} = \\begin{bmatrix} \\alpha \\\\ \\beta \\end{bmatrix}, \\quad\n\\mathbf{b} = \\begin{bmatrix} \\xi_1 \\\\ \\xi_2 \\\\ \\vdots \\\\ \\xi_n \\end{bmatrix}\n$$\nThe problem is to minimize $\\|\\mathbf{W}^{1/2}(\\mathbf{Ax} - \\mathbf{b})\\|_2^2$, where $\\mathbf{W} = \\text{diag}(w_1, \\dots, w_n)$ is the diagonal weight matrix. This is equivalent to solving the standard least-squares problem for a transformed system. Let $\\mathbf{A}' = \\mathbf{W}^{1/2}\\mathbf{A}$ and $\\mathbf{b}' = \\mathbf{W}^{1/2}\\mathbf{b}$. The problem becomes:\n$$\n\\min_{\\mathbf{x}} \\| \\mathbf{A}'\\mathbf{x} - \\mathbf{b}' \\|_2^2 \\quad \\text{subject to} \\quad \\mathbf{x} \\ge \\mathbf{0}\n$$\nThis is a Non-Negative Least Squares (NNLS) problem. It can be solved numerically using established algorithms, such as the active-set method developed by Lawson and Hanson, which is robust and widely available in scientific computing libraries.\n\nThe numerical procedure for each test case is as follows:\n1. Construct the $n \\times 2$ design matrix $\\mathbf{A}$ and the $n \\times 1$ observation vector $\\mathbf{b}$ from the given $\\omega_i$ and $\\xi_i$ data.\n2. Construct a vector of square roots of weights, $\\sqrt{w_i}$.\n3. Create the weighted matrix $\\mathbf{A}'$ and vector $\\mathbf{b}'$ by multiplying each row of $\\mathbf{A}$ and corresponding element of $\\mathbf{b}$ by the respective $\\sqrt{w_i}$.\n4. Solve the NNLS problem for $\\mathbf{x} = [\\alpha, \\beta]^T$ using a suitable numerical solver.\n5. With the optimal $\\alpha$ and $\\beta$ found, calculate the predicted damping ratios $\\hat{\\xi}_i = \\frac{\\alpha}{2\\omega_i} + \\frac{\\beta\\omega_i}{2}$.\n6. Compute the quality-of-fit using the weighted Root-Mean-Square Error (RMSE):\n$$\n\\text{RMSE} = \\sqrt{ \\frac{ \\sum_{i=1}^n w_i \\left( \\hat{\\xi}_i - \\xi_i \\right)^2 }{ \\sum_{i=1}^n w_i } }\n$$\nThis provides a comprehensive method for calibrating the Rayleigh damping model from experimental data, respecting the physical constraint of non-negative damping coefficients.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import nnls\n\ndef solve():\n    \"\"\"\n    Solves for Rayleigh damping coefficients for multiple test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"omega\": [10, 20, 40, 80],\n            \"xi\": [0.1027, 0.1988, 0.4029, 0.7951],\n            \"w\": [1, 1, 1, 1]\n        },\n        {\n            \"omega\": [15, 60],\n            \"xi\": [0.0408333, 0.1508333],\n            \"w\": [2.0, 0.5]\n        },\n        {\n            \"omega\": [50, 50, 50],\n            \"xi\": [0.2480, 0.2510, 0.2495],\n            \"w\": [1, 1, 1]\n        },\n        {\n            \"omega\": [0.5, 2, 5, 20, 100, 200],\n            \"xi\": [0.0201, 0.0062, 0.0043, 0.0107, 0.0496, 0.1004],\n            \"w\": [0.5, 2, 5, 20, 100, 200]\n        }\n    ]\n\n    all_results_str = []\n    \n    for case in test_cases:\n        # Convert lists to numpy arrays for vectorized operations\n        omega = np.array(case[\"omega\"], dtype=float)\n        xi = np.array(case[\"xi\"], dtype=float)\n        w = np.array(case[\"w\"], dtype=float)\n\n        # 1. Construct the design matrix A\n        # The model is xi = (alpha / (2*omega)) + (beta * omega / 2)\n        # This is a linear system: xi = A * x, where x = [alpha, beta]\n        # A has two columns: [1/(2*omega), omega/2]\n        n_points = len(omega)\n        A = np.zeros((n_points, 2))\n        A[:, 0] = 1.0 / (2.0 * omega)\n        A[:, 1] = omega / 2.0\n        \n        # The vector of observations is b = xi\n        b = xi\n\n        # 2. Apply weights to formulate a standard NNLS problem\n        # We want to minimize sum(w * (A*x - b)**2), which is ||sqrt(W)*(A*x-b)||^2\n        # So we solve for x in (sqrt(W)*A)*x = sqrt(W)*b\n        sqrt_w = np.sqrt(w)\n        \n        # Apply weights by row-wise multiplication\n        A_w = A * sqrt_w[:, np.newaxis]\n        b_w = b * sqrt_w\n        \n        # 3. Solve the Non-Negative Least Squares (NNLS) problem\n        # This finds x >= 0 that minimizes ||A_w * x - b_w||_2\n        x, _ = nnls(A_w, b_w)\n        alpha, beta = x[0], x[1]\n\n        # 4. Calculate the predicted damping ratios\n        xi_predicted = A @ x\n        \n        # 5. Calculate the weighted Root-Mean-Square Error (RMSE)\n        sum_weights = np.sum(w)\n        if sum_weights > 0:\n            weighted_squared_error_sum = np.sum(w * (xi_predicted - xi)**2)\n            rmse = np.sqrt(weighted_squared_error_sum / sum_weights)\n        else: # Should not happen with positive weights\n            rmse = 0.0\n\n        # Store results formatted to six decimal places\n        case_result_str = f\"[{alpha:.6f},{beta:.6f},{rmse:.6f}]\"\n        all_results_str.append(case_result_str)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(all_results_str)}]\")\n\nsolve()\n```"
        }
    ]
}