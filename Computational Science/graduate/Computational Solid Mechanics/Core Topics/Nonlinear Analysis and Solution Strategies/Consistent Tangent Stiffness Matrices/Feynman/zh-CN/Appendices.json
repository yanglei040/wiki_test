{
    "hands_on_practices": [
        {
            "introduction": "掌握一致切线刚度矩阵的第一步是理解其如何从平衡方程的弱形式（即虚功原理）中推导得出。本练习将引导你完成这一基本过程，针对一个同时包含材料非线性和几何非线性的简单一维杆单元进行推导。通过这个实践 ，你将学会如何系统地处理非线性问题中的线性化，为更复杂的有限元分析奠定坚实的基础。",
            "id": "2538124",
            "problem": "考虑一个长度为 $L$ 的单根一维双节点线性杆有限元，占据参考域 $x \\in [0,L]$。其位移场 $u(x)$ 由标准线性插值 $u(x) = N_{1}(x)\\,u_{1} + N_{2}(x)\\,u_{2}$ 近似，其中 $N_{1}(x) = 1 - x/L$，$N_{2}(x) = x/L$。横截面积呈线性变化，其表达式为 $A(x) = A_{0}\\left(1 + \\beta \\frac{x}{L}\\right)$，其中 $A_{0} > 0$ 和实数 $\\beta$ 是给定常数。该杆由一种具有非线性本构关系 $\\sigma = \\sigma(\\epsilon)$ 的材料制成，其中工程应变为 $\\epsilon(x) = \\frac{du}{dx}$。对于本问题，取 $\\sigma(\\epsilon) = E\\,\\epsilon + \\alpha\\,\\epsilon^{3}$，其中 $E > 0$ 和实数 $\\alpha$ 是给定常数。\n\n从虚功原理和有限元方法 (FEM) 中单元内力向量的定义出发，对弱形式围绕一个任意的试探状态 $u^{t}(x) = N_{1}(x)\\,u_{1}^{t} + N_{2}(x)\\,u_{2}^{t}$ 进行一致性线性化，其中节点值 $u_{1}^{t}$ 和 $u_{2}^{t}$ 是给定的。推导在该试探状态下计算的单元一致切线刚度矩阵。使用单元应变-位移矩阵 $B = \\left[-\\frac{1}{L}\\ \\ \\frac{1}{L}\\right]$，将你的结果完全用 $A_{0}$、$\\beta$、$L$、$E$、$\\alpha$、$u_{1}^{t}$ 和 $u_{2}^{t}$ 表示。\n\n你的最终答案必须是在试探状态下计算的封闭形式的 $2 \\times 2$ 切线刚度矩阵，并写成单个符号表达式。最终答案中不要包含单位。",
            "solution": "所述问题在科学上是合理的，提法适定且内容自洽。它呈现了一个非线性有限元分析中标准的、但并非微不足道的练习。所有提供的信息都是一致且足以推导出所求量的。因此，该问题是有效的。我们现在开始推导。\n\n非线性有限元问题公式化的起点是虚功原理 (PVW)。平衡声明要求，对于任何运动学上容许的虚位移，内虚功 $\\delta W_{int}$ 等于外虚功 $\\delta W_{ext}$。我们关心的是内力和切线刚度，因此我们专注于内虚功。对于一维杆，$\\delta W_{int}$ 由应力 $\\sigma$ 在整个单元体积上对虚应变 $\\delta\\epsilon$ 所做的功的积分给出：\n$$\n\\delta W_{int} = \\int_{V} \\sigma \\delta\\epsilon \\, dV = \\int_{0}^{L} \\sigma(x) A(x) \\delta\\epsilon(x) \\, dx\n$$\n此处，$A(x)$ 是横截面积，$L$ 是单元长度，$\\sigma$ 和 $\\epsilon$ 分别是工程应力和应变。\n\n位移场 $u(x)$ 使用线性形函数 $N_1(x)$ 和 $N_2(x)$ 以及节点位移 $u_1$ 和 $u_2$ 来近似。在矩阵表示法中，我们将位移向量写为 $\\mathbf{u}_{e} = \\begin{pmatrix} u_1  u_2 \\end{pmatrix}^T$，位移场表示为：\n$$\nu(x) = \\mathbf{N}(x) \\mathbf{u}_{e} = \\begin{pmatrix} N_1(x)  N_2(x) \\end{pmatrix} \\mathbf{u}_{e}\n$$\n应变 $\\epsilon(x)$ 是位移的空间导数：\n$$\n\\epsilon(x) = \\frac{du}{dx} = \\frac{d\\mathbf{N}}{dx} \\mathbf{u}_{e} = \\mathbf{B} \\mathbf{u}_{e}\n$$\n其中 $\\mathbf{B}$ 是应变-位移矩阵。对于给定的线性形函数 $N_{1}(x) = 1 - x/L$ 和 $N_{2}(x) = x/L$，其导数为常数：$\\frac{dN_1}{dx} = -\\frac{1}{L}$ 和 $\\frac{dN_2}{dx} = \\frac{1}{L}$。因此，$\\mathbf{B}$ 是一个常数矩阵：\n$$\n\\mathbf{B} = \\begin{pmatrix} -\\frac{1}{L}  \\frac{1}{L} \\end{pmatrix}\n$$\n由于 $\\mathbf{B}$ 是常数，对于任何给定的 $\\mathbf{u}_e$，应变 $\\epsilon$ 在整个单元内也是恒定的。\n\n虚应变 $\\delta\\epsilon$ 通过相同的矩阵 $\\mathbf{B}$ 与虚节点位移 $\\delta\\mathbf{u}_e$ 相关联：\n$$\n\\delta\\epsilon(x) = \\mathbf{B} \\delta\\mathbf{u}_{e}\n$$\n将 $\\sigma$ 和 $\\delta\\epsilon$ 的离散形式代入虚功原理表达式：\n$$\n\\delta W_{int} = \\int_{0}^{L} \\sigma(\\mathbf{B}\\mathbf{u}_{e}) A(x) (\\mathbf{B} \\delta\\mathbf{u}_{e}) \\, dx = \\delta\\mathbf{u}_{e}^T \\left( \\int_{0}^{L} \\mathbf{B}^T \\sigma(\\mathbf{B}\\mathbf{u}_{e}) A(x) \\, dx \\right)\n$$\n根据虚功原理 $\\delta W_{int} = \\delta\\mathbf{u}_{e}^T \\mathbf{f}_{int}$，我们确定单元内力向量 $\\mathbf{f}_{int}$：\n$$\n\\mathbf{f}_{int}(\\mathbf{u}_{e}) = \\int_{0}^{L} \\mathbf{B}^T \\sigma(\\mathbf{B}\\mathbf{u}_{e}) A(x) \\, dx\n$$\n单元一致切线刚度矩阵 $\\mathbf{K}_T$ 定义为内力向量关于节点位移向量的 Gâteaux 导数：\n$$\n\\mathbf{K}_T = \\frac{d\\mathbf{f}_{int}}{d\\mathbf{u}_e}\n$$\n执行此微分：\n$$\nd\\mathbf{f}_{int} = \\int_{0}^{L} \\mathbf{B}^T d\\sigma A(x) \\, dx\n$$\n应力微分 $d\\sigma$ 通过切线模量 $E_T = \\frac{d\\sigma}{d\\epsilon}$ 与应变微分 $d\\epsilon$ 相关。\n$$\nd\\sigma = E_T(\\epsilon) d\\epsilon = E_T(\\epsilon) \\mathbf{B} d\\mathbf{u}_e\n$$\n将此代入 $d\\mathbf{f}_{int}$ 的表达式中：\n$$\nd\\mathbf{f}_{int} = \\int_{0}^{L} \\mathbf{B}^T E_T(\\epsilon) \\mathbf{B} d\\mathbf{u}_e A(x) \\, dx = \\left( \\int_{0}^{L} \\mathbf{B}^T E_T(\\epsilon) \\mathbf{B} A(x) \\, dx \\right) d\\mathbf{u}_e\n$$\n因此，切线刚度矩阵为：\n$$\n\\mathbf{K}_T(\\mathbf{u}_e) = \\int_{0}^{L} \\mathbf{B}^T E_T(\\epsilon) \\mathbf{B} A(x) \\, dx\n$$\n问题要求在给定的试探状态 $\\mathbf{u}_{e}^t = \\begin{pmatrix} u_1^t  u_2^t \\end{pmatrix}^T$ 下计算 $\\mathbf{K}_T$。在此状态下的应变 $\\epsilon^t$ 是恒定的：\n$$\n\\epsilon^t = \\mathbf{B} \\mathbf{u}_{e}^t = \\begin{pmatrix} -\\frac{1}{L}  \\frac{1}{L} \\end{pmatrix} \\begin{pmatrix} u_1^t \\\\ u_2^t \\end{pmatrix} = \\frac{u_2^t - u_1^t}{L}\n$$\n非线性本构关系给定为 $\\sigma(\\epsilon) = E\\,\\epsilon + \\alpha\\,\\epsilon^3$。切线模量 $E_T$ 是其对应变的导数：\n$$\nE_T(\\epsilon) = \\frac{d\\sigma}{d\\epsilon} = E + 3\\alpha\\,\\epsilon^2\n$$\n在试探应变 $\\epsilon^t$ 下计算此值：\n$$\nE_T(\\epsilon^t) = E + 3\\alpha (\\epsilon^t)^2 = E + 3\\alpha \\left( \\frac{u_2^t - u_1^t}{L} \\right)^2\n$$\n由于 $\\mathbf{B}$ 和 $E_T(\\epsilon^t)$ 相对于积分变量 $x$ 是常数，我们可以将它们移到 $\\mathbf{K}_T$ 的积分之外：\n$$\n\\mathbf{K}_T(\\mathbf{u}_{e}^t) = \\mathbf{B}^T E_T(\\epsilon^t) \\mathbf{B} \\int_{0}^{L} A(x) \\, dx\n$$\n接下来，我们计算面积函数 $A(x) = A_{0}\\left(1 + \\beta \\frac{x}{L}\\right)$ 的积分：\n$$\n\\int_{0}^{L} A(x) \\, dx = \\int_{0}^{L} A_0 \\left( 1 + \\beta \\frac{x}{L} \\right) dx = A_0 \\left[ x + \\frac{\\beta x^2}{2L} \\right]_{0}^{L} = A_0 \\left( L + \\frac{\\beta L^2}{2L} \\right) = A_0 L \\left( 1 + \\frac{\\beta}{2} \\right)\n$$\n矩阵乘积 $\\mathbf{B}^T \\mathbf{B}$ 为：\n$$\n\\mathbf{B}^T \\mathbf{B} = \\begin{pmatrix} -1/L \\\\ 1/L \\end{pmatrix} \\begin{pmatrix} -1/L  1/L \\end{pmatrix} = \\begin{pmatrix} 1/L^2  -1/L^2 \\\\ -1/L^2  1/L^2 \\end{pmatrix} = \\frac{1}{L^2} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix}\n$$\n现在，我们将所有分量组合起来：\n$$\n\\mathbf{K}_T(\\mathbf{u}_{e}^t) = \\frac{1}{L^2} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix} \\left( E + 3\\alpha \\frac{(u_2^t - u_1^t)^2}{L^2} \\right) \\left( A_0 L \\left( 1 + \\frac{\\beta}{2} \\right) \\right)\n$$\n合并标量项，我们得到一致切线刚度矩阵的最终表达式：\n$$\n\\mathbf{K}_T = \\frac{A_0}{L} \\left( 1 + \\frac{\\beta}{2} \\right) \\left( E + 3\\alpha \\frac{(u_2^t - u_1^t)^2}{L^2} \\right) \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix}\n$$\n为了将答案表示为单个矩阵，我们定义标量系数为：\n$$\nC = \\frac{A_0}{L} \\left( 1 + \\frac{\\beta}{2} \\right) \\left( E + 3\\alpha \\frac{(u_2^t - u_1^t)^2}{L^2} \\right)\n$$\n那么切线刚度矩阵为 $\\mathbf{K}_T = \\begin{pmatrix} C  -C \\\\ -C  C \\end{pmatrix}$。这就是所求的结果。",
            "answer": "$$\n\\boxed{\n\\frac{A_0}{L} \\left( 1 + \\frac{\\beta}{2} \\right) \\left( E + 3\\alpha \\frac{(u_2^t - u_1^t)^2}{L^2} \\right)\n\\begin{pmatrix}\n1  -1 \\\\\n-1  1\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "一致切线刚度公式的真正威力体现在处理路径依赖材料（如经历塑性变形的金属）时。这个实践将超越简单的超弹性本构，推导一个标准 J2 塑性模型的“算法模量”$G_{\\text{alg}}$，这是计算固体力学的基石。通过在纯剪切这一特殊但重要的载荷条件下进行分析 ，你将深入理解如何为复杂的返回映射算法推导其一致切线算子。",
            "id": "3552115",
            "problem": "考虑一个服从带有线性各向同性硬化的冯·米塞斯（J2）塑性理论的小应变、率无关、各向同性弹塑性固体。令柯西应力表示为 $\\boldsymbol{\\sigma}$，其偏量部分表示为 $\\boldsymbol{s} = \\boldsymbol{\\sigma} - \\tfrac{1}{3} \\operatorname{tr}(\\boldsymbol{\\sigma}) \\boldsymbol{I}$，弹性剪切模量表示为 $\\mu$。屈服函数为\n$$\nf(\\boldsymbol{\\sigma}, \\kappa) = \\sqrt{\\tfrac{3}{2}} \\, \\| \\boldsymbol{s} \\| - \\sigma_{y}(\\kappa) \\le 0,\n$$\n其中 $\\sigma_{y}(\\kappa) = \\sigma_{y0} + H \\kappa$，$\\sigma_{y0}$ 是初始屈服应力，$H \\ge 0$ 是一个常塑性模量，$\\kappa$ 是等效塑性应变，定义为 $d\\kappa = \\sqrt{\\tfrac{2}{3}} \\, \\| d\\boldsymbol{\\varepsilon}^{p} \\|$。相关的流动法则是 $d\\boldsymbol{\\varepsilon}^{p} = d\\lambda \\, \\partial f / \\partial \\boldsymbol{\\sigma}$，其中 $d\\lambda \\ge 0$ 是塑性乘子，塑性一致性条件是在塑性加载期间 $f = 0$ 且 $df = 0$。假设弹性响应是各向同性的，其关系为 $\\boldsymbol{\\sigma} = \\mathbb{C}_{e} : (\\boldsymbol{\\varepsilon} - \\boldsymbol{\\varepsilon}^{p})$，其中 $\\mathbb{C}_{e}$ 是四阶弹性刚度张量，剪切模量为 $\\mu$。\n\n物体承受单调纯剪切加载，因此唯一的非零应力分量是 $\\tau = \\sigma_{12} = \\sigma_{21}$，唯一的非零总应变分量是工程剪切应变 $\\gamma = 2 \\varepsilon_{12}$。在弹性范围内，有 $\\tau = \\mu \\gamma$。\n\n将算法剪切模量 $G_{\\text{alg}}$ 定义为在活动塑性流动下，在屈服面上计算的一致切线斜率 $G_{\\text{alg}} = d\\tau / d\\gamma$，该模量将用于有限元残差的牛顿迭代。仅从上述陈述和冯·米塞斯（J2）塑性理论的基本定义出发，推导在单调塑性纯剪切条件下，$G_{\\text{alg}}$ 关于 $\\mu$ 和 $H$ 的封闭形式表达式。然后，说明随着塑性进展，$G_{\\text{alg}}$ 与弹性剪切模量 $\\mu$ 相比如何变化。将 $G_{\\text{alg}}$ 的最终答案表示为关于 $\\mu$ 和 $H$ 的符号表达式。不需要进行数值计算，也不需要四舍五入。最终表达式中不要包含单位。",
            "solution": "问题陈述已经过验证，被认为是合理的。它描述了连续介质弹塑性力学中的一个标准问题，该问题具有科学依据、适定、客观，并包含了获得唯一解所需的所有信息。\n\n目标是推导在单调纯剪切加载下经历塑性变形的材料的算法剪切模量，定义为 $G_{\\text{alg}} = d\\tau / d\\gamma$。\n\n首先，我们描述纯剪切状态。柯西应力张量 $\\boldsymbol{\\sigma}$ 和无穷小应变张量 $\\boldsymbol{\\varepsilon}$ 由下式给出：\n$$\n\\boldsymbol{\\sigma} = \\begin{pmatrix} 0  \\tau  0 \\\\ \\tau  0  0 \\\\ 0  0  0 \\end{pmatrix}, \\quad \\boldsymbol{\\varepsilon} = \\begin{pmatrix} 0  \\varepsilon_{12}  0 \\\\ \\varepsilon_{12}  0  0 \\\\ 0  0  0 \\end{pmatrix}\n$$\n其中 $\\tau = \\sigma_{12}$ 是剪切应力，工程剪切应变是 $\\gamma = 2\\varepsilon_{12}$。\n偏应力张量 $\\boldsymbol{s}$ 定义为 $\\boldsymbol{s} = \\boldsymbol{\\sigma} - \\frac{1}{3} \\operatorname{tr}(\\boldsymbol{\\sigma}) \\boldsymbol{I}$。对于纯剪切，应力张量的迹为 $\\operatorname{tr}(\\boldsymbol{\\sigma}) = 0+0+0 = 0$。因此，偏应力张量与应力张量相同，即 $\\boldsymbol{s} = \\boldsymbol{\\sigma}$。\n\n屈服函数为 $f(\\boldsymbol{\\sigma}, \\kappa) = \\sqrt{\\frac{3}{2}} \\, \\| \\boldsymbol{s} \\| - \\sigma_{y}(\\kappa) \\le 0$。我们计算偏应力的弗罗贝尼乌斯范数 $\\|\\boldsymbol{s}\\|$：\n$$\n\\|\\boldsymbol{s}\\| = \\sqrt{\\boldsymbol{s}:\\boldsymbol{s}} = \\sqrt{s_{ij}s_{ij}} = \\sqrt{\\sigma_{12}^2 + \\sigma_{21}^2} = \\sqrt{\\tau^2 + \\tau^2} = \\sqrt{2\\tau^2} = \\sqrt{2}|\\tau|\n$$\n假设单调加载，我们可以取 $\\tau > 0$，所以 $\\|\\boldsymbol{s}\\| = \\sqrt{2}\\tau$。屈服函数简化为：\n$$\nf = \\sqrt{\\frac{3}{2}} (\\sqrt{2}\\tau) - \\sigma_{y}(\\kappa) = \\sqrt{3}\\tau - \\sigma_{y}(\\kappa)\n$$\n在塑性流动期间，应力状态位于屈服面上，因此 $f = 0$。这给出了条件：\n$$\n\\sqrt{3}\\tau = \\sigma_{y}(\\kappa) = \\sigma_{y0} + H\\kappa\n$$\n我们需要找到 $G_{\\text{alg}} = d\\tau / d\\gamma$。总应变增量是弹性和塑性增量之和：$d\\gamma = d\\gamma^e + d\\gamma^p$。\n\n响应的弹性部分由 $\\tau = \\mu \\gamma^e$ 给出。其增量形式为 $d\\tau = \\mu d\\gamma^e$，或 $d\\gamma^e = \\frac{d\\tau}{\\mu}$。\n\n响应的塑性部分由相关的流动法则 $d\\boldsymbol{\\varepsilon}^{p} = d\\lambda \\, \\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}}$ 控制。我们定义流动方向张量 $\\boldsymbol{N} = \\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}}$。\n$$\n\\boldsymbol{N} = \\frac{\\partial}{\\partial \\boldsymbol{\\sigma}} \\left( \\sqrt{\\frac{3}{2}} \\|\\boldsymbol{s}\\| - \\sigma_y(\\kappa) \\right) = \\sqrt{\\frac{3}{2}} \\frac{\\partial \\|\\boldsymbol{s}\\|}{\\partial \\boldsymbol{\\sigma}} = \\sqrt{\\frac{3}{2}} \\frac{\\boldsymbol{s}}{\\|\\boldsymbol{s}\\|}\n$$\n对于纯剪切，这变为：\n$$\n\\boldsymbol{N} = \\sqrt{\\frac{3}{2}} \\frac{\\boldsymbol{\\sigma}}{\\sqrt{2}\\tau} = \\frac{\\sqrt{3}}{2\\tau} \\boldsymbol{\\sigma}\n$$\n$\\boldsymbol{N}$ 的分量为 $N_{12} = N_{21} = \\frac{\\sqrt{3}}{2\\tau}\\tau = \\frac{\\sqrt{3}}{2}$，所有其他分量均为零。\n\n等效塑性应变增量 $d\\kappa$ 通过 $d\\kappa = \\sqrt{\\frac{2}{3}} \\|d\\boldsymbol{\\varepsilon}^p\\|$ 与塑性乘子 $d\\lambda$ 相关联。代入 $d\\boldsymbol{\\varepsilon}^p = d\\lambda \\boldsymbol{N}$：\n$$\nd\\kappa = \\sqrt{\\frac{2}{3}}\\|d\\lambda \\boldsymbol{N}\\| = d\\lambda \\sqrt{\\frac{2}{3}} \\|\\boldsymbol{N}\\| = d\\lambda \\sqrt{\\frac{2}{3}} \\sqrt{\\boldsymbol{N}:\\boldsymbol{N}}\n$$\n$\\boldsymbol{N}$ 的范数为 $\\|\\boldsymbol{N}\\| = \\sqrt{N_{12}^2 + N_{21}^2} = \\sqrt{(\\frac{\\sqrt{3}}{2})^2 + (\\frac{\\sqrt{3}}{2})^2} = \\sqrt{\\frac{3}{4} + \\frac{3}{4}} = \\sqrt{\\frac{3}{2}}$。\n因此，$d\\kappa = d\\lambda \\sqrt{\\frac{2}{3}}\\sqrt{\\frac{3}{2}} = d\\lambda$。塑性乘子等于等效塑性应变的增量。\n\n塑性应变增量张量为 $d\\boldsymbol{\\varepsilon}^p = d\\kappa \\boldsymbol{N}$。工程塑性剪切应变增量 $d\\gamma^p$ 由 $d\\gamma^p = 2d\\varepsilon_{12}^p$ 给出。\n$$\nd\\varepsilon_{12}^p = d\\kappa N_{12} = d\\kappa \\frac{\\sqrt{3}}{2}\n$$\n因此，$d\\gamma^p = 2 \\left( d\\kappa \\frac{\\sqrt{3}}{2} \\right) = \\sqrt{3} d\\kappa$。\n\n为了将 $d\\kappa$ 与应力增量 $d\\tau$ 关联起来，我们使用塑性加载期间的一致性条件（$f=0$）。在这个简化情况下，我们可以对屈服条件 $\\sqrt{3}\\tau = \\sigma_y(\\kappa)$ 进行微分：\n$$\nd(\\sqrt{3}\\tau) = d(\\sigma_y(\\kappa))\n$$\n$$\n\\sqrt{3} d\\tau = \\frac{d\\sigma_y}{d\\kappa} d\\kappa = H d\\kappa\n$$\n这给出了等效塑性应变增量和剪切应力增量之间的关系：\n$$\nd\\kappa = \\frac{\\sqrt{3}}{H} d\\tau\n$$\n现在，将此代入 $d\\gamma^p$ 的表达式中：\n$$\nd\\gamma^p = \\sqrt{3} \\left( \\frac{\\sqrt{3}}{H} d\\tau \\right) = \\frac{3}{H} d\\tau\n$$\n我们现在可以组合出总剪切应变增量 $d\\gamma$ 的表达式：\n$$\nd\\gamma = d\\gamma^e + d\\gamma^p = \\frac{d\\tau}{\\mu} + \\frac{3 d\\tau}{H}\n$$\n提出 $d\\tau$：\n$$\nd\\gamma = d\\tau \\left( \\frac{1}{\\mu} + \\frac{3}{H} \\right) = d\\tau \\left( \\frac{H + 3\\mu}{\\mu H} \\right)\n$$\n算法剪切模量定义为 $G_{\\text{alg}} = d\\tau/d\\gamma$。重新整理上述方程可得到所需的表达式：\n$$\nG_{\\text{alg}} = \\frac{d\\tau}{d\\gamma} = \\frac{\\mu H}{H + 3\\mu}\n$$\n这是塑性流动期间切线剪切模量的封闭形式表达式。\n\n关于 $G_{\\text{alg}}$ 与弹性剪切模量 $\\mu$ 的比较：\n该表达式可以重写为 $G_{\\text{alg}} = \\mu \\left( \\frac{H}{H + 3\\mu} \\right)$。\n塑性模量给定为 $H \\ge 0$，弹性剪切模量 $\\mu$ 是一个正的材料常数，$\\mu > 0$。\n$3\\mu$ 项是严格为正的。因此，分母 $H + 3\\mu$ 总是严格大于分子 $H$（除非 $\\mu=0$，但这不是物理材料）。\n这意味着该分数是有界的：$0 \\le \\frac{H}{H + 3\\mu} < 1$。\n- 如果 $H=0$（理想塑性，无硬化），则 $G_{\\text{alg}} = 0$。\n- 如果 $H>0$（材料硬化），则 $0 < G_{\\text{alg}} < \\mu$。\n因此，在塑性流动期间（在给定的常数 $H$ 模型下“随着塑性进展”），切线剪切模量 $G_{\\text{alg}}$ 是一个常数，其值严格小于弹性剪切模量 $\\mu$。剪切刚度因塑性变形的开始而降低。",
            "answer": "$$\n\\boxed{\\frac{\\mu H}{H + 3\\mu}}\n$$"
        },
        {
            "introduction": "推导出正确的切线矩阵表达式只是成功的一半，在代码中无误地实现它则是另一半。在开发非线性有限元程序时，一个不可或缺的验证工具就是有限差分检验。本练习将让你亲手实现这一检验方法 ，并帮助你理解在选择扰动大小 $\\epsilon$ 时如何平衡截断误差和舍入误差，这是确保代码正确性的关键实用技能。",
            "id": "3552137",
            "problem": "考虑一个一维双节点杆单元，其具有两个位移自由度，并集合在向量 $\\mathbf{u} = [u_1,u_2]^T$ 中。该单元具有恒定的横截面积 $A > 0$、长度 $L > 0$，以及一个非线性本构关系，该关系将柯西应力 $\\sigma$ 与工程应变 $\\varepsilon$ 联系起来，表达式为 $\\sigma(\\varepsilon) = E\\,\\varepsilon + \\beta\\,\\varepsilon^3$，其中 $E > 0$ 是线性模量，$\\beta \\ge 0$ 是非线性系数。使用线性形函数，工程应变为 $\\varepsilon = (u_2 - u_1)/L$。内残差向量 $\\mathbf{R}(\\mathbf{u})$ 源于虚功原理，其定义为应力通过应变-位移矩阵投影后在单元上的积分。在此设置下，您可以假设残差有两个分量 $R_1(\\mathbf{u})$ 和 $R_2(\\mathbf{u})$，它们由具有给定本构关系的杆单元的力学行为确定。\n\n目标是设计并实现对一致切线刚度矩阵 $\\mathbf{K}(\\mathbf{u}) = \\partial \\mathbf{R}/\\partial \\mathbf{u}$ 的有限差分检验，使用中心差分近似\n$$\nK_{ij}^{\\mathrm{FD}}(\\mathbf{u};\\epsilon) \\approx \\frac{R_i(\\mathbf{u} + \\epsilon\\,\\mathbf{e}_j) - R_i(\\mathbf{u} - \\epsilon\\,\\mathbf{e}_j)}{2\\,\\epsilon},\n$$\n其中 $\\epsilon > 0$ 是一个标量扰动大小，$i,j \\in \\{1,2\\}$，$\\mathbf{e}_j$ 是 $\\mathbb{R}^2$ 中的第 $j$ 个标准单位向量。您还必须从提供的基本定义出发，通过对 $\\mathbf{R}(\\mathbf{u})$ 关于 $\\mathbf{u}$ 求导来计算精确的一致切线刚度 $\\mathbf{K}(\\mathbf{u})$，并通过报告相对弗罗贝尼乌斯范数误差来比较 $\\mathbf{K}^{\\mathrm{FD}}$ 与 $\\mathbf{K}$\n$$\n\\eta(\\epsilon,\\mathbf{u}) = \\frac{\\left\\|\\mathbf{K}^{\\mathrm{FD}}(\\mathbf{u};\\epsilon) - \\mathbf{K}(\\mathbf{u})\\right\\|_F}{\\left\\|\\mathbf{K}(\\mathbf{u})\\right\\|_F}。\n$$\n\n您的程序必须实现所述杆单元的残差 $\\mathbf{R}(\\mathbf{u})$ 以及从第一性原理推导出的精确一致切线刚度 $\\mathbf{K}(\\mathbf{u})$。然后，对于下面列出的每个测试用例，它必须计算有限差分近似 $\\mathbf{K}^{\\mathrm{FD}}(\\mathbf{u};\\epsilon)$，评估相对误差 $\\eta(\\epsilon,\\mathbf{u})$，并汇总结果。\n\n在所有测试中，使用以下材料和几何参数：$A = 1.0$, $L = 1.0$, $E = 10.0$, $\\beta = 5.0$。将所有量视为无量纲；输出中不需要物理单位。\n\n测试套件：\n1. 一个在适度扰动下验证准确性的通用情况：$\\mathbf{u} = [0.2,\\,0.8]^T$, $\\epsilon = 10^{-6}$。\n2. 一个具有极小扰动的舍入误差敏感情况：$\\mathbf{u} = [0.2,\\,0.8]^T$, $\\epsilon = 10^{-12}$。\n3. 一个具有大扰动的截断误差主导情况：$\\mathbf{u} = [0.2,\\,0.8]^T$, $\\epsilon = 10^{-2}$。\n4. 一个近零应变边界情况：$\\mathbf{u} = [10^{-12},\\,-10^{-12}]^T$, $\\epsilon = 10^{-6}$。\n5. 一个使用与机器精度相关的推荐中心差分缩放的情况：$\\mathbf{u} = [0.2,\\,0.8]^T$, $\\epsilon = \\varepsilon_{\\mathrm{mach}}^{1/3}$，其中 $\\varepsilon_{\\mathrm{mach}}$ 是双精度浮点运算的机器精度。\n\n您的程序应生成一行输出，其中包含五个测试用例的相对误差 $\\eta$，格式为逗号分隔的列表，并用方括号括起来（例如，“[e1,e2,e3,e4,e5]”），其中每个 $e_k$ 是一个十进制数。",
            "solution": "该问题陈述被评估为有效。它在计算固体力学原理方面有科学依据，包含所有必要信息，没有矛盾，并且是适定的，允许唯一且有意义的解。\n\n主要目标是验证一个解析推导的一致切线刚度矩阵 $\\mathbf{K}(\\mathbf{u})$，并将其与通过中心有限差分法得到的数值近似 $\\mathbf{K}^{\\mathrm{FD}}(\\mathbf{u};\\epsilon)$ 进行比较。验证通过相对弗罗贝尼乌斯范数误差 $\\eta$ 来量化。\n\n首先，我们推导内残差向量 $\\mathbf{R}(\\mathbf{u})$ 和一致切线刚度矩阵 $\\mathbf{K}(\\mathbf{u})$ 的解析表达式。推导从虚功原理开始。对于一维杆单元，内虚功 $\\delta W_{\\text{int}}$ 由应力 $\\sigma$ 乘以虚应变 $\\delta\\varepsilon$ 的体积分给出：\n$$\n\\delta W_{\\text{int}} = \\int_{V} \\sigma \\, \\delta\\varepsilon \\, dV\n$$\n给定恒定的横截面积 $A$ 和单元长度 $L$，并假设线性形函数导致单元内应变场恒定，该积分简化为：\n$$\n\\delta W_{\\text{int}} = \\sigma A L \\, \\delta\\varepsilon\n$$\n工程应变 $\\varepsilon$ 通过应变-位移矩阵 $\\mathbf{B}$ 与节点位移向量 $\\mathbf{u} = [u_1, u_2]^T$ 相关：\n$$\n\\varepsilon = \\frac{u_2 - u_1}{L} = \\begin{bmatrix} -1/L  1/L \\end{bmatrix} \\begin{bmatrix} u_1 \\\\ u_2 \\end{bmatrix} = \\mathbf{B}\\mathbf{u}\n$$\n虚应变则为 $\\delta\\varepsilon = \\mathbf{B}\\delta\\mathbf{u}$。将此代入虚功表达式中得到：\n$$\n\\delta W_{\\text{int}} = \\sigma A L (\\mathbf{B}\\delta\\mathbf{u}) = (\\sigma A L \\mathbf{B}) \\delta\\mathbf{u}\n$$\n内虚功也通过内残差向量 $\\mathbf{R}$ 定义为 $\\delta W_{\\text{int}} = \\mathbf{R}^T \\delta\\mathbf{u}$。通过比较这两个表达式，我们确定残差向量：\n$$\n\\mathbf{R}(\\mathbf{u})^T = \\sigma A L \\mathbf{B} \\implies \\mathbf{R}(\\mathbf{u}) = \\mathbf{B}^T \\sigma A L\n$$\n代入 $\\mathbf{B}$ 的表达式和给定的本构关系 $\\sigma(\\varepsilon) = E\\varepsilon + \\beta\\varepsilon^3$：\n$$\n\\mathbf{R}(\\mathbf{u}) = \\begin{bmatrix} -1/L \\\\ 1/L \\end{bmatrix} \\left( E\\varepsilon + \\beta\\varepsilon^3 \\right) A L = A \\left( E\\varepsilon + \\beta\\varepsilon^3 \\right) \\begin{bmatrix} -1 \\\\ 1 \\end{bmatrix}\n$$\n该表达式定义了节点上的内力，这些内力大小相等、方向相反，符合预期。\n\n接下来，我们通过对残差向量 $\\mathbf{R}(\\mathbf{u})$ 关于位移向量 $\\mathbf{u}$ 求导来推导一致切线刚度矩阵 $\\mathbf{K}(\\mathbf{u})$：\n$$\n\\mathbf{K}(\\mathbf{u}) = \\frac{\\partial \\mathbf{R}(\\mathbf{u})}{\\partial \\mathbf{u}}\n$$\n使用链式法则，并且注意到 $\\sigma$ 是 $\\varepsilon$ 的函数，而 $\\varepsilon$ 又是 $\\mathbf{u}$ 的函数：\n$$\n\\mathbf{K}(\\mathbf{u}) = \\frac{\\partial \\mathbf{R}}{\\partial \\varepsilon} \\frac{\\partial \\varepsilon}{\\partial \\mathbf{u}} = \\left( \\frac{\\partial}{\\partial \\varepsilon} \\left[ \\mathbf{B}^T \\sigma(\\varepsilon) A L \\right] \\right) (\\mathbf{B}) = \\mathbf{B}^T \\frac{d\\sigma}{d\\varepsilon} \\mathbf{B} A L\n$$\n应力对应变的导数 $\\frac{d\\sigma}{d\\varepsilon}$ 是材料切线模量 $E_t$：\n$$\nE_t = \\frac{d\\sigma}{d\\varepsilon} = \\frac{d}{d\\varepsilon}\\left(E\\varepsilon + \\beta\\varepsilon^3\\right) = E + 3\\beta\\varepsilon^2\n$$\n将 $E_t$ 和 $\\mathbf{B}$ 代入 $\\mathbf{K}$ 的表达式中：\n$$\n\\mathbf{K}(\\mathbf{u}) = \\begin{bmatrix} -1/L \\\\ 1/L \\end{bmatrix} (E + 3\\beta\\varepsilon^2) \\begin{bmatrix} -1/L  1/L \\end{bmatrix} A L = \\frac{AL}{L^2}(E + 3\\beta\\varepsilon^2) \\begin{bmatrix} 1  -1 \\\\ -1  1 \\end{bmatrix}\n$$\n这简化为一致切线刚度矩阵的最终解析表达式：\n$$\n\\mathbf{K}(\\mathbf{u}) = \\frac{A}{L} \\left( E + 3\\beta\\left(\\frac{u_2 - u_1}{L}\\right)^2 \\right) \\begin{bmatrix} 1  -1 \\\\ -1  1 \\end{bmatrix}\n$$\n问题要求使用中心差分公式计算数值近似 $\\mathbf{K}^{\\mathrm{FD}}$：\n$$\nK_{ij}^{\\mathrm{FD}}(\\mathbf{u};\\epsilon) = \\frac{R_i(\\mathbf{u} + \\epsilon\\,\\mathbf{e}_j) - R_i(\\mathbf{u} - \\epsilon\\,\\mathbf{e}_j)}{2\\,\\epsilon}\n$$\n这里，$\\mathbf{e}_1 = [1,0]^T$ 和 $\\mathbf{e}_2 = [0,1]^T$ 是标准基向量。此公式应用于矩阵的每一列 $j$。\n\n最后，使用弗罗贝尼乌斯范数（表示为 $\\|\\cdot\\|_F$）计算相对误差 $\\eta$，对于矩阵 $\\mathbf{M}$，其定义为 $\\|\\mathbf{M}\\|_F = \\sqrt{\\sum_i \\sum_j M_{ij}^2}$。误差为：\n$$\n\\eta(\\epsilon,\\mathbf{u}) = \\frac{\\left\\|\\mathbf{K}^{\\mathrm{FD}}(\\mathbf{u};\\epsilon) - \\mathbf{K}(\\mathbf{u})\\right\\|_F}{\\left\\|\\mathbf{K}(\\mathbf{u})\\right\\|_F}\n$$\n实现将包括计算 $\\mathbf{R}(\\mathbf{u})$、$\\mathbf{K}(\\mathbf{u})$ 和 $\\mathbf{K}^{\\mathrm{FD}}(\\mathbf{u};\\epsilon)$ 的函数，然后对五个指定的测试用例中的每一个评估 $\\eta$。第五个案例需要双精度浮点数的机器精度 $\\varepsilon_{\\mathrm{mach}}$，它是满足 $1.0 + \\varepsilon_{\\mathrm{mach}} \\ne 1.0$ 的最小数。中心差分方案的最佳扰动通常与 $\\varepsilon_{\\mathrm{mach}}^{1/3}$ 相关。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import ...\n\ndef solve():\n    \"\"\"\n    Computes and compares analytical and finite-difference tangent stiffness matrices\n    for a nonlinear 1D bar element.\n    \"\"\"\n\n    # Define material and geometric parameters\n    A = 1.0  # Cross-sectional area\n    L = 1.0  # Length\n    E = 10.0 # Linear modulus\n    beta = 5.0 # Nonlinear coefficient\n\n    def residual(u, A, L, E, beta):\n        \"\"\"\n        Computes the internal residual vector R(u) for the bar element.\n        R(u) = A * sigma(epsilon) * [-1, 1]^T\n        \"\"\"\n        if not isinstance(u, np.ndarray):\n            u = np.array(u, dtype=float)\n        \n        strain = (u[1] - u[0]) / L\n        stress = E * strain + beta * strain**3\n        internal_force = A * stress\n        return np.array([-internal_force, internal_force])\n\n    def exact_stiffness(u, A, L, E, beta):\n        \"\"\"\n        Computes the exact consistent tangent stiffness matrix K(u).\n        K(u) = (A/L) * (E + 3*beta*epsilon^2) * [[1, -1], [-1, 1]]\n        \"\"\"\n        if not isinstance(u, np.ndarray):\n            u = np.array(u, dtype=float)\n            \n        strain = (u[1] - u[0]) / L\n        tangent_modulus = E + 3.0 * beta * strain**2\n        factor = (A / L) * tangent_modulus\n        return factor * np.array([[1.0, -1.0], [-1.0, 1.0]])\n\n    def fd_stiffness(u, eps, A, L, E, beta):\n        \"\"\"\n        Computes the finite-difference approximation of the tangent stiffness matrix.\n        \"\"\"\n        if not isinstance(u, np.ndarray):\n            u = np.array(u, dtype=float)\n            \n        K_fd = np.zeros((2, 2))\n        e_vecs = [np.array([1.0, 0.0]), np.array([0.0, 1.0])]\n        \n        for j in range(2):\n            u_plus = u + eps * e_vecs[j]\n            u_minus = u - eps * e_vecs[j]\n            \n            R_plus = residual(u_plus, A, L, E, beta)\n            R_minus = residual(u_minus, A, L, E, beta)\n            \n            K_fd[:, j] = (R_plus - R_minus) / (2.0 * eps)\n            \n        return K_fd\n\n    def relative_error(K_fd, K_exact):\n        \"\"\"\n        Computes the relative Frobenius norm error between two matrices.\n        \"\"\"\n        diff_norm = np.linalg.norm(K_fd - K_exact, 'fro')\n        exact_norm = np.linalg.norm(K_exact, 'fro')\n        \n        # Handle case where the exact norm is zero\n        if exact_norm == 0:\n            return 0.0 if diff_norm == 0 else np.inf\n            \n        return diff_norm / exact_norm\n\n    # Machine epsilon for double precision\n    eps_mach = np.finfo(float).eps\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # 1. General case\n        {'u': np.array([0.2, 0.8]), 'eps': 1e-6},\n        # 2. Round-off sensitive case\n        {'u': np.array([0.2, 0.8]), 'eps': 1e-12},\n        # 3. Truncation-error dominated case\n        {'u': np.array([0.2, 0.8]), 'eps': 1e-2},\n        # 4. Near-zero-strain edge case\n        {'u': np.array([1e-12, -1e-12]), 'eps': 1e-6},\n        # 5. Optimal perturbation case\n        {'u': np.array([0.2, 0.8]), 'eps': eps_mach**(1/3.0)}\n    ]\n\n    results = []\n    for case in test_cases:\n        u_vec = case['u']\n        epsilon = case['eps']\n        \n        # Compute the exact and finite-difference matrices\n        K_exact = exact_stiffness(u_vec, A, L, E, beta)\n        K_fd = fd_stiffness(u_vec, epsilon, A, L, E, beta)\n        \n        # Compute and store the relative error\n        error = relative_error(K_fd, K_exact)\n        results.append(error)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}