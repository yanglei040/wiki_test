{
    "hands_on_practices": [
        {
            "introduction": "A successful path-following analysis begins with the correct formulation of the governing equations. This exercise guides you through the fundamental process of setting up the augmented linear system for a Newton-Raphson corrector step, combining the equilibrium equations with a displacement-control constraint . Mastering this derivation is essential for understanding how path-following methods extend standard nonlinear analysis and leads to the characteristic 'bordered matrix' structure.",
            "id": "3544462",
            "problem": "Consider a nonlinear finite element equilibrium problem in computational solid mechanics where the external load is introduced by a scalar load factor. Let the equilibrium residual be defined as $R(u,\\lambda)=r_{int}(u)-\\lambda f_{ext}$, where $u$ is the vector of nodal displacements, $\\lambda$ is the scalar load factor, $r_{int}(u)$ is the internal force vector, and $f_{ext}$ is the external reference load vector. A path-following constraint is imposed in the form of displacement control, $g(u)=c^{T}u-s$, where $c$ is a constant direction vector and $s$ is the prescribed control value.\n\nStarting from the Newton-Raphson (NR) method applied to the coupled system $R(u,\\lambda)=0$ and $g(u)=0$, derive the linearized correction equations for $(\\delta u, \\delta \\lambda)$ by expanding $R(u+\\delta u,\\lambda+\\delta \\lambda)$ and $g(u+\\delta u)$ to first order. Identify the tangent stiffness matrix $K_{T}=\\partial r_{int}/\\partial u$ and the Jacobian contributions $\\partial R/\\partial \\lambda$ and $\\partial g/\\partial u$, and show how the resulting corrections can be written in a bordered linear system for $(\\delta u,\\delta \\lambda)$.\n\nThen, for a specific NR iteration, use the following dimensionless data measured at the current iterate $(u_{k},\\lambda_{k})$:\n- $K_{T}=\\begin{bmatrix}10  -2 \\\\ -2  6\\end{bmatrix}$,\n- $f_{ext}=\\begin{bmatrix}4 \\\\ 3\\end{bmatrix}$,\n- $c=\\begin{bmatrix}1 \\\\ -1\\end{bmatrix}$,\n- $u_{k}=\\begin{bmatrix}0.1 \\\\ -0.2\\end{bmatrix}$, $s=0.25$,\n- $R=\\begin{bmatrix}1 \\\\ -2\\end{bmatrix}$.\n\nCompute the load-factor correction $\\delta \\lambda$ for this NR step by solving the bordered system you derived. Report your final $\\delta \\lambda$ as a single dimensionless number. Round your answer to four significant figures.",
            "solution": "The problem is valid as it is scientifically grounded in the principles of computational solid mechanics, specifically nonlinear finite element analysis, and is well-posed with sufficient information for a unique solution.\n\nThe problem requires the derivation and solution of the linearized equations for a path-following algorithm using displacement control. The governing nonlinear system of equations is composed of the equilibrium residual $R(u, \\lambda)$ and the path-following constraint $g(u)$.\n\nThe coupled system is given by:\n$$\nR(u, \\lambda) = r_{int}(u) - \\lambda f_{ext} = 0\n$$\n$$\ng(u) = c^{T}u - s = 0\n$$\n\nWe apply the Newton-Raphson method to solve this system. Let the current state be $(u_k, \\lambda_k)$. We seek corrections $(\\delta u, \\delta \\lambda)$ such that the next iterate $(u_{k+1}, \\lambda_{k+1}) = (u_k + \\delta u, \\lambda_k + \\delta \\lambda)$ satisfies the linearized version of the system. We perform a first-order Taylor expansion of $R$ and $g$ around $(u_k, \\lambda_k)$:\n\n$$\nR(u_k + \\delta u, \\lambda_k + \\delta \\lambda) \\approx R(u_k, \\lambda_k) + \\frac{\\partial R}{\\partial u}\\bigg|_{(u_k, \\lambda_k)} \\delta u + \\frac{\\partial R}{\\partial \\lambda}\\bigg|_{(u_k, \\lambda_k)} \\delta \\lambda = 0\n$$\n$$\ng(u_k + \\delta u) \\approx g(u_k) + \\frac{\\partial g}{\\partial u}\\bigg|_{u_k} \\delta u = 0\n$$\n\nWe now identify the Jacobian terms as requested.\nThe partial derivative of the residual $R$ with respect to the displacement vector $u$ is the tangent stiffness matrix $K_T$:\n$$\n\\frac{\\partial R}{\\partial u} = \\frac{\\partial}{\\partial u} (r_{int}(u) - \\lambda f_{ext}) = \\frac{\\partial r_{int}(u)}{\\partial u} = K_T\n$$\nThe partial derivative of the residual $R$ with respect to the load factor $\\lambda$ is:\n$$\n\\frac{\\partial R}{\\partial \\lambda} = \\frac{\\partial}{\\partial \\lambda} (r_{int}(u) - \\lambda f_{ext}) = -f_{ext}\n$$\nThe partial derivative of the constraint $g$ with respect to the displacement vector $u$ is:\n$$\n\\frac{\\partial g}{\\partial u} = \\frac{\\partial}{\\partial u} (c^{T}u - s) = c^T\n$$\nThe partial derivative of $g$ with respect to $\\lambda$ is $0$, as $g$ does not depend on $\\lambda$.\n\nLet $R_k = R(u_k, \\lambda_k)$ and $g_k = g(u_k)$ be the residuals at the current iteration. Substituting the derivatives into the linearized equations gives:\n$$\nK_T \\delta u - f_{ext} \\delta \\lambda = -R_k\n$$\n$$\nc^T \\delta u = -g_k\n$$\n\nThese equations can be written in a bordered linear system form for the unknown corrections $(\\delta u, \\delta \\lambda)$:\n$$\n\\begin{bmatrix}\nK_T  -f_{ext} \\\\\nc^T  0\n\\end{bmatrix}\n\\begin{bmatrix}\n\\delta u \\\\\n\\delta \\lambda\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n-R_k \\\\\n-g_k\n\\end{bmatrix}\n$$\nThis completes the derivation and identification part of the problem.\n\nNext, we compute the load-factor correction $\\delta \\lambda$ using the provided dimensionless data:\n- Tangent stiffness matrix: $K_{T}=\\begin{bmatrix}10  -2 \\\\ -2  6\\end{bmatrix}$\n- External reference load vector: $f_{ext}=\\begin{bmatrix}4 \\\\ 3\\end{bmatrix}$\n- Constraint direction vector: $c=\\begin{bmatrix}1 \\\\ -1\\end{bmatrix}$, so $c^T = \\begin{bmatrix}1  -1\\end{bmatrix}$\n- Current displacement vector: $u_{k}=\\begin{bmatrix}0.1 \\\\ -0.2\\end{bmatrix}$\n- Prescribed control value: $s=0.25$\n- Equilibrium residual at current iterate: $R_k=R(u_k, \\lambda_k)=\\begin{bmatrix}1 \\\\ -2\\end{bmatrix}$\n\nFirst, we must compute the constraint residual $g_k$ at the current iterate:\n$$\ng_k = c^T u_k - s = \\begin{bmatrix}1  -1\\end{bmatrix} \\begin{bmatrix}0.1 \\\\ -0.2\\end{bmatrix} - 0.25\n$$\n$$\ng_k = (1)(0.1) + (-1)(-0.2) - 0.25 = 0.1 + 0.2 - 0.25 = 0.3 - 0.25 = 0.05\n$$\n\nThe right-hand side of the bordered system is:\n$$\n\\begin{bmatrix} -R_k \\\\ -g_k \\end{bmatrix} = \\begin{bmatrix} -\\begin{bmatrix}1 \\\\ -2\\end{bmatrix} \\\\ -0.05 \\end{bmatrix} = \\begin{bmatrix} -1 \\\\ 2 \\\\ -0.05 \\end{bmatrix}\n$$\n\nLetting $\\delta u = \\begin{bmatrix} \\delta u_1 \\\\ \\delta u_2 \\end{bmatrix}$, the full numerical system is:\n$$\n\\begin{bmatrix}\n10  -2  -4 \\\\\n-2  6  -3 \\\\\n1  -1  0\n\\end{bmatrix}\n\\begin{bmatrix}\n\\delta u_1 \\\\\n\\delta u_2 \\\\\n\\delta \\lambda\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n-1 \\\\\n2 \\\\\n-0.05\n\\end{bmatrix}\n$$\n\nWe can solve this $3 \\times 3$ system for $\\delta u_1$, $\\delta u_2$, and $\\delta \\lambda$. From the third equation:\n$$(1)\\delta u_1 + (-1)\\delta u_2 + (0)\\delta \\lambda = -0.05 \\implies \\delta u_1 = \\delta u_2 - 0.05$$\n\nSubstitute this expression for $\\delta u_1$ into the first two equations.\nFrom the first equation:\n$$10(\\delta u_2 - 0.05) - 2\\delta u_2 - 4\\delta \\lambda = -1$$\n$$10\\delta u_2 - 0.5 - 2\\delta u_2 - 4\\delta \\lambda = -1$$\n$$8\\delta u_2 - 4\\delta \\lambda = -0.5 \\quad (1)$$\n\nFrom the second equation:\n$$-2(\\delta u_2 - 0.05) + 6\\delta u_2 - 3\\delta \\lambda = 2$$\n$$-2\\delta u_2 + 0.1 + 6\\delta u_2 - 3\\delta \\lambda = 2$$\n$$4\\delta u_2 - 3\\delta \\lambda = 1.9 \\quad (2)$$\n\nWe now have a $2 \\times 2$ system for $\\delta u_2$ and $\\delta \\lambda$. Multiply equation (2) by $2$:\n$$8\\delta u_2 - 6\\delta \\lambda = 3.8 \\quad (2')$$\n\nSubtract equation (1) from equation (2'):\n$$(8\\delta u_2 - 6\\delta \\lambda) - (8\\delta u_2 - 4\\delta \\lambda) = 3.8 - (-0.5)$$\n$$-2\\delta \\lambda = 4.3$$\n$$\\delta \\lambda = -\\frac{4.3}{2} = -2.15$$\n\nThe problem requires the answer to be rounded to four significant figures.\n$$\\delta \\lambda = -2.150$$",
            "answer": "$$\\boxed{-2.150}$$"
        },
        {
            "introduction": "With the augmented system established, the next challenge is its efficient and numerically stable solution. This practice focuses on the implementation of the corrector step, demonstrating how to solve for the displacement and load increments without explicitly inverting the tangent stiffness matrix, $K_T$ . You will implement a standard partitioned solution strategy and explore how to regularize the calculation to maintain robustness, even when the system is near a critical point.",
            "id": "3544471",
            "problem": "You are implementing a Newton-type predictor-corrector step for nonlinear equilibrium with an arc-length path-following constraint in computational solid mechanics. The fundamental base consists of the following facts.\n\n- The linearized equilibrium equation at a Newton iteration for a nonlinear finite element model is expressed as a linear system between the displacement increment and the load-factor increment, derived from the Principle of Virtual Work and Newton linearization. This yields a system of the form\n  $$K_T \\,\\delta u - f\\,\\delta \\lambda = -r,$$\n  where $K_T$ is the current tangent stiffness matrix, $f$ is the reference load vector, $r$ is the current residual vector, $\\delta u$ is the correction in the displacement vector, and $\\delta \\lambda$ is the correction in the load factor.\n- The path-following constraint is linearized as\n  $$a^\\mathsf{T} \\delta u + h\\,\\delta \\lambda = b,$$\n  where $a$ is the derivative of the chosen constraint with respect to the displacement variables, $h$ is the derivative with respect to the load factor, and $b$ is the linearized constraint right-hand side for the current iteration.\n\nYour task is to design a numerically stable algorithm that computes $(\\delta u,\\delta \\lambda)$ without explicitly forming $K_T^{-1}$. You must use exactly two linear solves with $K_T$ per Newton iteration and combine the results through inner products with $a$. Specifically, starting from the fundamental base above, you must derive a numerically stable expression for $\\delta \\lambda$ that avoids explicit matrix inversion and then retrieve $\\delta u$. The algorithm must handle the case when the denominator in the scalar formula for $\\delta \\lambda$ becomes small by using a stabilized division strategy that preserves consistency with the equilibrium equation and avoids catastrophic cancellation.\n\nImplementation requirements.\n\n- Let $w$ and $z$ be the unique solutions of the two linear systems\n  $$K_T w = f,\\qquad K_T z = r.$$\n  These are the only two linear solves with $K_T$ that you are allowed to perform per Newton iteration.\n- Combine $w$ and $z$ to form\n  $$p = a^\\mathsf{T} w + h, \\qquad q = b + a^\\mathsf{T} z.$$\n- In the generic, well-conditioned case, compute\n  $$\\delta \\lambda = \\frac{q}{p}.$$\n  When $|p|$ is small, use a Tikhonov-stabilized scalar solve that regularizes the division, for example by minimizing \n  $$(p\\,\\delta \\lambda - q)^2 + \\sigma^2 \\delta \\lambda^2,$$\n  with a small stabilization parameter $\\sigma  0$ scaled to the problem data, and take the minimizer\n  $$\\delta \\lambda = \\frac{p\\,q}{p^2 + \\sigma^2}.$$\n  Then compute\n  $$\\delta u = w\\,\\delta \\lambda - z.$$\n- Your program must implement the above logic with an automatic choice of $\\sigma$ based on machine precision and the magnitudes of $a$, $w$, and $h$. You may use any reasonable scaling that depends continuously on the data and tends to zero as conditioning improves. You must not form $K_T^{-1}$ explicitly.\n\nTest suite and required output.\n\n- Use the following four test cases. For each case, $K_T \\in \\mathbb{R}^{2 \\times 2}$, and the remaining vectors are in $\\mathbb{R}^2$; all scalars are real.\n  1) Happy path (symmetric positive definite):\n     - $K_T = \\begin{bmatrix} 10  2 \\\\ 2  5 \\end{bmatrix}$,\n       $f = \\begin{bmatrix} 1 \\\\ 0.5 \\end{bmatrix}$,\n       $r = \\begin{bmatrix} -0.2 \\\\ 0.1 \\end{bmatrix}$,\n       $a = \\begin{bmatrix} 0.6 \\\\ -0.8 \\end{bmatrix}$,\n       $h = 0.3$, $b = 0.05$.\n  2) Ill-conditioned but solvable:\n     - $K_T = \\begin{bmatrix} 10^{-3}  0 \\\\ 0  2 \\end{bmatrix}$,\n       $f = \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix}$,\n       $r = \\begin{bmatrix} 10^{-3} \\\\ -0.2 \\end{bmatrix}$,\n       $a = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix}$,\n       $h = 0$, $b = 0.01$.\n  3) Degenerate linearized constraint (zero denominator and consistent right-hand side):\n     - $K_T = \\begin{bmatrix} 1  0 \\\\ 0  1 \\end{bmatrix}$,\n       $f = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix}$,\n       $r = \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix}$,\n       $a = \\begin{bmatrix} -1 \\\\ 0 \\end{bmatrix}$,\n       $h = 1$, $b = 0$.\n  4) Indefinite but invertible $K_T$:\n     - $K_T = \\begin{bmatrix} 0  1 \\\\ 1  0 \\end{bmatrix}$,\n       $f = \\begin{bmatrix} 0.5 \\\\ -1.0 \\end{bmatrix}$,\n       $r = \\begin{bmatrix} 0.3 \\\\ -0.4 \\end{bmatrix}$,\n       $a = \\begin{bmatrix} 0.2 \\\\ 0.9 \\end{bmatrix}$,\n       $h = -0.1$, $b = -0.02$.\n- For each test case, compute and return two quantities:\n  1) The scalar $\\delta \\lambda$.\n  2) The Euclidean norm of the equilibrium residual, $\\|K_T \\delta u - f \\delta \\lambda + r\\|_2$.\n- Final output format: Your program should produce a single line of output containing the results for all cases as a comma-separated list enclosed in square brackets, ordered as\n  $$[\\delta \\lambda_1, \\rho_1, \\delta \\lambda_2, \\rho_2, \\delta \\lambda_3, \\rho_3, \\delta \\lambda_4, \\rho_4],$$\n  where $\\rho_i$ is the residual norm for the $i$-th case. All quantities are unitless real numbers.\n- Angle units and physical units do not apply in this purely algebraic problem.\n\nYour final answer must be a complete, runnable Python program that computes the required outputs using only the specified libraries. No user input is allowed, and the program must print exactly one line in the specified format.",
            "solution": "The problem requires the derivation and implementation of a numerically-stabilized algorithm to solve for the displacement correction $\\delta u$ and load factor correction $\\delta \\lambda$ in an arc-length-constrained Newton-Raphson iteration. The governing equations are a linear system representing the linearized equilibrium and a linear scalar equation representing the linearized path-following constraint.\n\nThe system of equations is given by:\n$$\n\\begin{align*}\nK_T \\,\\delta u - f\\,\\delta \\lambda = -r \\quad (1) \\\\\na^\\mathsf{T} \\delta u + h\\,\\delta \\lambda = b \\quad (2)\n\\end{align*}\n$$\nHere, $K_T$ is the tangent stiffness matrix, $f$ is the reference load vector, $r$ is the residual vector, $a$ is the constraint gradient with respect to displacements, $h$ is the constraint gradient with respect to the load factor, and $b$ is the current constraint value. The unknowns are the vectors $\\delta u$ and the scalar $\\delta \\lambda$. The algorithm must not compute the inverse of $K_T$ explicitly.\n\nFirst, we derive the formal solution. Assuming the tangent stiffness matrix $K_T$ is invertible, we can express the displacement correction $\\delta u$ from equation $(1)$:\n$$ \\delta u = K_T^{-1} (f\\,\\delta \\lambda - r) $$\nUsing the linearity of the matrix inverse operator, we can split this into two parts:\n$$ \\delta u = (K_T^{-1} f) \\delta \\lambda - (K_T^{-1} r) $$\nThe problem defines two auxiliary vectors, $w$ and $z$, as the solutions to the following linear systems:\n$$ K_T w = f \\implies w = K_T^{-1} f $$\n$$ K_T z = r \\implies z = K_T^{-1} r $$\nThese two linear solves are the only ones permitted per iteration. Substituting these definitions into the expression for $\\delta u$ yields:\n$$ \\delta u = w\\,\\delta \\lambda - z \\quad (3) $$\nThis expression provides the displacement correction $\\delta u$ once the load factor correction $\\delta \\lambda$ is known.\n\nTo find $\\delta \\lambda$, we substitute equation $(3)$ into the linearized constraint, equation $(2)$:\n$$ a^\\mathsf{T} (w\\,\\delta \\lambda - z) + h\\,\\delta \\lambda = b $$\nExpanding the terms and rearranging to solve for $\\delta \\lambda$:\n$$ (a^\\mathsf{T} w)\\,\\delta \\lambda - a^\\mathsf{T} z + h\\,\\delta \\lambda = b $$\n$$ (a^\\mathsf{T} w + h)\\,\\delta \\lambda = b + a^\\mathsf{T} z $$\nThe problem defines two scalar quantities, $p$ and $q$:\n$$ p = a^\\mathsf{T} w + h $$\n$$ q = b + a^\\mathsf{T} z $$\nWith these definitions, the equation for $\\delta \\lambda$ simplifies to a scalar equation:\n$$ p\\,\\delta \\lambda = q $$\nIn the general case where $p \\neq 0$, the solution is straightforward:\n$$ \\delta \\lambda = \\frac{q}{p} $$\nA numerical issue arises when $|p|$ is close to zero. This situation corresponds to a critical point in the load-displacement path, where the constraint surface becomes tangent to the equilibrium path. Direct computation of $q/p$ would lead to floating-point overflow and catastrophic cancellation errors.\n\nTo handle this, the problem prescribes a Tikhonov-stabilized solution. Instead of solving $p\\,\\delta\\lambda = q$ directly, one finds the $\\delta\\lambda$ that minimizes the regularized least-squares functional:\n$$ J(\\delta \\lambda) = (p\\,\\delta \\lambda - q)^2 + \\sigma^2 \\delta \\lambda^2 $$\nwhere $\\sigma  0$ is a small regularization parameter. The minimum is found by setting the derivative $\\frac{dJ}{d\\delta \\lambda}$ to zero:\n$$ \\frac{dJ}{d\\delta \\lambda} = 2(p\\,\\delta \\lambda - q)p + 2\\sigma^2 \\delta \\lambda = 0 $$\n$$ p^2 \\delta \\lambda - pq + \\sigma^2 \\delta \\lambda = 0 $$\n$$ (p^2 + \\sigma^2) \\delta \\lambda = pq $$\n$$ \\delta \\lambda = \\frac{p\\,q}{p^2 + \\sigma^2} $$\nThis stabilized formula is used when $|p|$ is determined to be small. The parameter $\\sigma$ must be chosen carefully. A robust choice, as required by the problem, is to scale $\\sigma$ based on the magnitudes of the data. A physically and numerically sound scaling for $p = a^\\mathsf{T}w+h$ is given by the expression $\\|a\\|_2 \\|w\\|_2 + |h|$. We can define $\\sigma$ relative to this scale using machine precision $\\epsilon_{\\text{mach}}$:\n$$ \\sigma = \\sqrt{\\epsilon_{\\text{mach}}} \\left( \\|a\\|_2 \\|w\\|_2 + |h| \\right) $$\nThe use of $\\sqrt{\\epsilon_{\\text{mach}}}$ is a standard heuristic for setting tolerances where rounding errors become significant. The algorithm then switches to the stabilized formula if $|p|  \\sigma$. This approach ensures a continuous and stable computation of $\\delta \\lambda$ across all conditions.\n\nFinally, we must compute the Euclidean norm of the equilibrium residual, $\\|K_T \\delta u - f \\delta \\lambda + r\\|_2$. Substituting the expression for $\\delta u$ from equation $(3)$:\n$$ \\text{Residual} = K_T (w\\,\\delta \\lambda - z) - f\\,\\delta \\lambda + r $$\n$$ = (K_T w)\\delta \\lambda - K_T z - f\\,\\delta \\lambda + r $$\nBy the definitions of $w$ and $z$, we have $K_T w = f$ and $K_T z = r$. Substituting these in:\n$$ \\text{Residual} = f\\,\\delta \\lambda - r - f\\,\\delta \\lambda + r = 0 $$\nIn exact arithmetic, the residual is identically zero, regardless of whether the standard or stabilized formula for $\\delta \\lambda$ is used. This is because the relationship $\\delta u = w\\,\\delta \\lambda - z$ is constructed precisely to satisfy the linearized equilibrium equation $(1)$. In floating-point arithmetic, the computed residual norm will be a small number reflecting the numerical precision of the linear solver and subsequent operations. It serves as a valuable internal consistency check for the implementation.\n\nThe overall algorithm is:\n$1$. Given $K_T, f, r, a, h, b$.\n$2$. Solve $K_T w = f$ and $K_T z = r$ for $w$ and $z$.\n$3$. Compute scalars $p = a^\\mathsf{T} w + h$ and $q = b + a^\\mathsf{T} z$.\n$4$. Compute a regularization parameter $\\sigma$ based on problem data and machine precision. For instance, $\\sigma = \\sqrt{\\epsilon_{\\text{mach}}} (\\|a\\|_2\\|w\\|_2 + |h| + \\delta_{tiny})$ where $\\delta_{tiny}$ is a small positive constant to prevent $\\sigma=0$.\n$5$. If $|p|  \\sigma$, compute $\\delta \\lambda = \\frac{p\\,q}{p^2 + \\sigma^2}$.\n$6$. Else, compute $\\delta \\lambda = q / p$.\n$7$. Compute the displacement correction $\\delta u = w\\,\\delta \\lambda - z$.\n$8$. Compute the equilibrium residual norm $\\|K_T \\delta u - f \\delta \\lambda + r\\|_2$.\n$9$. Return the computed $\\delta \\lambda$ and the residual norm.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes predictor-corrector steps for nonlinear equilibrium with an\n    arc-length constraint for a series of test cases.\n    \"\"\"\n    # Define the test cases as specified in the problem statement.\n    # Each case is a tuple: (KT, f, r, a, h, b)\n    test_cases = [\n        # 1) Happy path (symmetric positive definite)\n        (\n            np.array([[10.0, 2.0], [2.0, 5.0]]),\n            np.array([1.0, 0.5]),\n            np.array([-0.2, 0.1]),\n            np.array([0.6, -0.8]),\n            0.3,\n            0.05\n        ),\n        # 2) Ill-conditioned but solvable\n        (\n            np.array([[1e-3, 0.0], [0.0, 2.0]]),\n            np.array([1.0, 1.0]),\n            np.array([1e-3, -0.2]),\n            np.array([1.0, 0.0]),\n            0.0,\n            0.01\n        ),\n        # 3) Degenerate linearized constraint (p=0, q=0)\n        (\n            np.array([[1.0, 0.0], [0.0, 1.0]]),\n            np.array([1.0, 0.0]),\n            np.array([0.0, 0.0]),\n            np.array([-1.0, 0.0]),\n            1.0,\n            0.0\n        ),\n        # 4) Indefinite but invertible KT\n        (\n            np.array([[0.0, 1.0], [1.0, 0.0]]),\n            np.array([0.5, -1.0]),\n            np.array([0.3, -0.4]),\n            np.array([0.2, 0.9]),\n            -0.1,\n            -0.02\n        ),\n    ]\n\n    results = []\n\n    # Get machine epsilon for floating point comparisons\n    eps = np.finfo(float).eps\n\n    for KT, f, r, a, h, b in test_cases:\n        # Step 1: Perform the two linear solves with KT\n        # This is the only place we interact with KT directly for solving\n        try:\n            w = np.linalg.solve(KT, f)\n            z = np.linalg.solve(KT, r)\n        except np.linalg.LinAlgError:\n            # This should not happen for the given test cases as all KT are invertible\n            results.extend([np.nan, np.nan])\n            continue\n        \n        # Step 2: Combine w and z to form scalars p and q\n        p = a.T @ w + h\n        q = b + a.T @ z\n\n        # Step 3: Compute delta_lambda with stabilization\n        #\n        # The algorithm requires an automatic choice of the stabilization parameter sigma,\n        # scaled to the problem data. A robust choice is to scale it relative to the\n        # size of p, which is |a^T w + h|.\n        # We use a scale based on the norm of the constituent parts.\n        \n        # Define a characteristic scale for p\n        p_scale = np.linalg.norm(a) * np.linalg.norm(w) + np.abs(h)\n        \n        # Add a tiny value to prevent scale from being zero if inputs are all zero\n        p_scale += np.finfo(float).tiny\n\n        # Set the regularization parameter and tolerance. Using sqrt(eps) is a common\n        # heuristic for balancing truncation and round-off errors.\n        sigma = np.sqrt(eps) * p_scale\n\n        if np.abs(p)  sigma:\n            # Use the Tikhonov-stabilized formula for small |p|\n            delta_lambda = (p * q) / (p**2 + sigma**2)\n        else:\n            # Use the standard formula for the well-conditioned case\n            delta_lambda = q / p\n\n        # Step 4: Compute the displacement correction delta_u\n        delta_u = w * delta_lambda - z\n\n        # Step 5: Compute the Euclidean norm of the equilibrium residual\n        # As derived, this residual should be close to zero, serving as a\n        # numerical consistency check.\n        residual_vector = KT @ delta_u - f * delta_lambda + r\n        residual_norm = np.linalg.norm(residual_vector)\n        \n        results.append(delta_lambda)\n        results.append(residual_norm)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Path-following techniques are most powerful when used to investigate complex structural instabilities that are inaccessible to simpler methods. This problem challenges you to analyze a classic example of a symmetry-breaking bifurcation in a discrete system . By deriving the conditions for bifurcation from the tangent stiffness matrix, you will connect the abstract algebraic framework of path-following to the tangible prediction of when and how a structure loses its initial symmetric response.",
            "id": "2541400",
            "problem": "A minimal two-degree-of-freedom nonlinear finite element model is sought that exhibits a symmetry-breaking bifurcation under path-followed loading. Work within the standard equilibrium-residual setting of the Finite Element Method (FEM), where equilibrium is posed as $R(u,\\lambda)=0$ with $u \\in \\mathbb{R}^{2}$ the vector of nodal degrees of freedom and $\\lambda \\in \\mathbb{R}$ the scalar load parameter. Consider the following residual for a symmetric two-degree-of-freedom system subjected to a configuration-dependent follower load:\n$$\nR(u,\\lambda) \\;=\\;\n\\begin{pmatrix}\nk\\,u_{1} + \\alpha\\,u_{1}^{3} \\\\\nk\\,u_{2} + \\alpha\\,u_{2}^{3}\n\\end{pmatrix}\n\\;-\\;\n\\lambda\\left[\n\\begin{pmatrix}\np\\\\\np\n\\end{pmatrix}\n\\;+\\;\n\\gamma\\,\n\\begin{pmatrix}\nu_{1}-u_{2}\\\\\nu_{2}-u_{1}\n\\end{pmatrix}\n\\right],\n$$\nwhere $k0$ and $\\alpha0$ are material stiffness parameters, $p0$ is a reference load amplitude, and $\\gamma0$ controls the magnitude of a follower-type contribution that depends on the relative displacement $u_{1}-u_{2}$. Assume all quantities are dimensionless.\n\nStarting from the fundamental definitions of residual equilibrium $R(u,\\lambda)=0$ and its tangent linearization used in arc-length path-following methods in the sense of Riks and Crisfield, do the following:\n\n1) Show that the symmetric subspace $u_{1}=u_{2}=u$ defines an equilibrium path and derive the scalar relation between $u$ and $\\lambda$ along this path.\n\n2) Derive the consistent tangent stiffness matrix $K_{T}(u,\\lambda)=\\partial R/\\partial u$ and evaluate it on the symmetric path. Identify the symmetric and antisymmetric eigenmodes of $K_{T}$ on the symmetric path and write their corresponding eigenvalues in terms of $u$, $\\lambda$, and the parameters.\n\n3) State the linearized conditions that characterize a simple symmetry-breaking branching (pitchfork) point for arc-length path-following: in particular, formulate the singularity condition on $K_{T}$, the associated right and left null vectors, and the condition that distinguishes a bifurcation from a limit point in the augmented Riks/Crisfield linearization at the branch point.\n\n4) For the specific parameter values $k=1$, $\\alpha=1$, $p=1$, and $\\gamma=1$, compute the critical load factor $\\lambda_{\\star}$ at which the symmetric branch loses stability to the antisymmetric mode. Express your final answer for $\\lambda_{\\star}$ as an exact number (dimensionless). Do not include units. No rounding is required.",
            "solution": "The problem presented is subjected to validation.\n\nStep 1: Extract Givens.\nThe problem statement provides the following:\n- The equilibrium condition is $R(u,\\lambda)=0$, with displacement vector $u \\in \\mathbb{R}^{2}$ and load parameter $\\lambda \\in \\mathbb{R}$.\n- The residual vector is defined as:\n$$\nR(u,\\lambda) \\;=\\;\n\\begin{pmatrix}\nk\\,u_{1} + \\alpha\\,u_{1}^{3} \\\\\nk\\,u_{2} + \\alpha\\,u_{2}^{3}\n\\end{pmatrix}\n\\;-\\;\n\\lambda\\left[\n\\begin{pmatrix}\np\\\\\np\n\\end{pmatrix}\n\\;+\\;\n\\gamma\\,\n\\begin{pmatrix}\nu_{1}-u_{2}\\\\\nu_{2}-u_{1}\n\\end{pmatrix}\n\\right]\n$$\n- The parameters are constrained as $k0$, $\\alpha0$, $p0$, and $\\gamma0$.\n- All quantities are dimensionless.\n- The specific tasks are: 1) Analyze the symmetric equilibrium path $u_{1}=u_{2}=u$. 2) Derive the tangent stiffness matrix $K_{T}$ and its eigen-properties on the symmetric path. 3) State the linearized conditions for a symmetry-breaking bifurcation point. 4) Compute the critical load factor $\\lambda_{\\star}$ for the specific case $k=1$, $\\alpha=1$, $p=1$, and $\\gamma=1$.\n\nStep 2: Validate Using Extracted Givens.\nThe problem is evaluated against the required criteria.\n- **Scientifically Grounded**: The problem is a well-established exercise in nonlinear structural mechanics and finite element theory. It concerns the stability analysis of a discrete conservative system modified by a non-conservative follower load, a standard topic in bifurcation theory. The formulation is based on fundamental principles of mechanics and calculus.\n- **Well-Posed**: The problem is entirely self-contained, providing all necessary definitions and equations. The tasks are specific and lead to a unique, derivable solution.\n- **Objective**: The problem is stated using precise mathematical language, free from any subjective or ambiguous terminology.\n\nThe problem does not violate any of the invalidity criteria. It is scientifically sound, formalizable, complete, and well-posed.\n\nStep 3: Verdict and Action.\nThe problem is deemed **valid**. A complete solution will be provided.\n\nThe solution proceeds by addressing the four specified tasks in order.\n\n1) First, we investigate the symmetric subspace defined by the constraint $u_{1}=u_{2}=u$. To show this subspace defines an equilibrium path, we substitute this constraint into the residual vector expression $R(u,\\lambda)$.\n$$\nR \\;=\\;\n\\begin{pmatrix}\nk\\,u + \\alpha\\,u^{3} \\\\\nk\\,u + \\alpha\\,u^{3}\n\\end{pmatrix}\n\\;-\\;\n\\lambda\\left[\n\\begin{pmatrix}\np\\\\\np\n\\end{pmatrix}\n\\;+\\;\n\\gamma\\,\n\\begin{pmatrix}\nu-u\\\\\nu-u\n\\end{pmatrix}\n\\right]\n\\;=\\;\n\\begin{pmatrix}\nk\\,u + \\alpha\\,u^{3} - \\lambda p \\\\\nk\\,u + \\alpha\\,u^{3} - \\lambda p\n\\end{pmatrix}\n$$\nThe equilibrium condition $R=0$ requires both components of this vector to be zero. As the components are identical, the condition reduces to a single scalar equation:\n$$\nk\\,u + \\alpha\\,u^{3} - \\lambda p = 0\n$$\nThis equation provides an implicit relationship between the symmetric displacement $u$ and the load parameter $\\lambda$. We can express $\\lambda$ as a function of $u$ along this fundamental path:\n$$\n\\lambda(u) = \\frac{k\\,u + \\alpha\\,u^{3}}{p}\n$$\nThis confirms that the symmetric subspace constitutes a valid equilibrium path for the system.\n\n2) Next, we derive the consistent tangent stiffness matrix $K_{T}(u,\\lambda)$, defined as the Jacobian of the residual vector with respect to the displacement vector, $K_{T} = \\frac{\\partial R}{\\partial u}$. The components of the residual are:\n$R_{1}(u_{1}, u_{2}, \\lambda) = k\\,u_{1} + \\alpha\\,u_{1}^{3} - \\lambda p - \\lambda\\gamma(u_{1}-u_{2})$\n$R_{2}(u_{1}, u_{2}, \\lambda) = k\\,u_{2} + \\alpha\\,u_{2}^{3} - \\lambda p - \\lambda\\gamma(u_{2}-u_{1})$\nThe partial derivatives are:\n$\\frac{\\partial R_{1}}{\\partial u_{1}} = k + 3\\alpha u_{1}^{2} - \\lambda\\gamma$\n$\\frac{\\partial R_{1}}{\\partial u_{2}} = \\lambda\\gamma$\n$\\frac{\\partial R_{2}}{\\partial u_{1}} = \\lambda\\gamma$\n$\\frac{\\partial R_{2}}{\\partial u_{2}} = k + 3\\alpha u_{2}^{2} - \\lambda\\gamma$\nAssembling these components gives the tangent stiffness matrix:\n$$\nK_T(u, \\lambda) = \\begin{pmatrix}\nk + 3\\alpha u_{1}^{2} - \\lambda\\gamma  \\lambda\\gamma \\\\\n\\lambda\\gamma  k + 3\\alpha u_{2}^{2} - \\lambda\\gamma\n\\end{pmatrix}\n$$\nWe now evaluate this matrix on the symmetric path where $u_{1}=u_{2}=u$:\n$$\nK_T|_{\\text{symm}} = \\begin{pmatrix}\nk + 3\\alpha u^{2} - \\lambda\\gamma  \\lambda\\gamma \\\\\n\\lambda\\gamma  k + 3\\alpha u^{2} - \\lambda\\gamma\n\\end{pmatrix}\n$$\nTo find the eigenvalues and eigenmodes, we solve the characteristic equation $\\det(K_T - \\omega I) = 0$. Let $A = k + 3\\alpha u^{2} - \\lambda\\gamma$ and $B = \\lambda\\gamma$. The equation becomes $(A-\\omega)^{2} - B^{2} = 0$, which yields the eigenvalues $\\omega = A \\pm B$.\nThe first eigenvalue corresponds to the symmetric mode:\n$\\omega_{S} = A + B = (k + 3\\alpha u^{2} - \\lambda\\gamma) + \\lambda\\gamma = k + 3\\alpha u^{2}$.\nThe corresponding eigenvector $\\phi_{S}$ satisfies $(K_T - \\omega_{S} I) \\phi_{S} = 0$. This leads to $\\phi_{S1} - \\phi_{S2} = 0$, so the symmetric eigenmode is $\\phi_{S} \\propto \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$.\nThe second eigenvalue corresponds to the antisymmetric mode:\n$\\omega_{A} = A - B = (k + 3\\alpha u^{2} - \\lambda\\gamma) - \\lambda\\gamma = k + 3\\alpha u^{2} - 2\\lambda\\gamma$.\nThe corresponding eigenvector $\\phi_{A}$ satisfies $(K_T - \\omega_{A} I) \\phi_{A} = 0$. This leads to $\\phi_{A1} + \\phi_{A2} = 0$, so the antisymmetric eigenmode is $\\phi_{A} \\propto \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$.\n\n3) A critical point on an equilibrium path occurs when the tangent stiffness matrix $K_T$ becomes singular, i.e., $\\det(K_T)=0$. This is equivalent to one of its eigenvalues becoming zero. At such a point $(u_{\\star}, \\lambda_{\\star})$, there exists a non-zero right null vector (critical mode) $\\phi$ such that $K_T(u_{\\star}, \\lambda_{\\star})\\phi=0$. Since $K_T$ is symmetric, the left null vector is $\\phi^T$.\nIn the context of arc-length methods, the distinction between a limit point and a bifurcation point is determined by the condition $\\phi^T (\\partial R / \\partial \\lambda) = 0$.\nThe load derivative vector is $\\frac{\\partial R}{\\partial \\lambda} = - \\begin{pmatrix} p + \\gamma(u_{1}-u_{2}) \\\\ p + \\gamma(u_{2}-u_{1}) \\end{pmatrix}$.\nOn the symmetric path ($u_{1}=u_{2}=u$), this simplifies to $\\frac{\\partial R}{\\partial \\lambda} = -\\begin{pmatrix} p \\\\ p \\end{pmatrix}$.\nIf the symmetric mode is critical ($\\omega_S=0$, $\\phi = \\phi_S$), the condition is:\n$\\phi_S^T \\frac{\\partial R}{\\partial \\lambda} = \\begin{pmatrix} 1  1 \\end{pmatrix} \\left(-\\begin{pmatrix} p \\\\ p \\end{pmatrix}\\right) = -2p$. Since $p0$, this is non-zero. A singularity in the symmetric mode corresponds to a **limit point**.\nIf the antisymmetric mode is critical ($\\omega_A=0$, $\\phi = \\phi_A$), the condition is:\n$\\phi_A^T \\frac{\\partial R}{\\partial \\lambda} = \\begin{pmatrix} 1  -1 \\end{pmatrix} \\left(-\\begin{pmatrix} p \\\\ p \\end{pmatrix}\\right) = -p - (-p) = 0$.\nThis zero result is the condition for a **bifurcation point**. Therefore, a symmetry-breaking bifurcation (pitchfork type) occurs when the primary path loses stability to the antisymmetric mode, which happens when $\\omega_A=0$.\n\n4) Finally, we compute the critical load factor $\\lambda_{\\star}$ for the parameter values $k=1$, $\\alpha=1$, $p=1$, and $\\gamma=1$. The symmetry-breaking bifurcation occurs at the point $(u_{\\star}, \\lambda_{\\star})$ that simultaneously satisfies the symmetric equilibrium path equation and the singularity condition for the antisymmetric mode.\nThe two governing equations are:\n1. Equilibrium: $k u_{\\star} + \\alpha u_{\\star}^{3} - \\lambda_{\\star} p = 0$\n2. Singularity: $\\omega_{A} = k + 3\\alpha u_{\\star}^{2} - 2\\lambda_{\\star}\\gamma = 0$\nSubstituting the given parameter values:\n1. $u_{\\star} + u_{\\star}^{3} - \\lambda_{\\star} = 0 \\implies \\lambda_{\\star} = u_{\\star} + u_{\\star}^{3}$\n2. $1 + 3u_{\\star}^{2} - 2\\lambda_{\\star} = 0$\nSubstitute the first equation into the second:\n$1 + 3u_{\\star}^{2} - 2(u_{\\star} + u_{\\star}^{3}) = 0$\n$1 + 3u_{\\star}^{2} - 2u_{\\star} - 2u_{\\star}^{3} = 0$\nRearranging gives a cubic polynomial in $u_{\\star}$:\n$2u_{\\star}^{3} - 3u_{\\star}^{2} + 2u_{\\star} - 1 = 0$\nBy inspection, we test for simple rational roots. For $u_{\\star}=1$:\n$2(1)^{3} - 3(1)^{2} + 2(1) - 1 = 2 - 3 + 2 - 1 = 0$.\nThus, $u_{\\star}=1$ is a real root. Factoring the polynomial gives $(u_{\\star}-1)(2u_{\\star}^{2} - u_{\\star} + 1) = 0$. The quadratic factor $2u_{\\star}^{2} - u_{\\star} + 1$ has a discriminant of $\\Delta = (-1)^{2} - 4(2)(1) = -7  0$, so it has no other real roots. The only physically relevant critical displacement is $u_{\\star}=1$.\nSubstituting this value back into the expression for $\\lambda_{\\star}$:\n$\\lambda_{\\star} = u_{\\star} + u_{\\star}^{3} = 1 + (1)^{3} = 2$.\nThe critical load factor at which the symmetric branch loses stability to the antisymmetric mode is $\\lambda_{\\star}=2$.",
            "answer": "$$\\boxed{2}$$"
        }
    ]
}