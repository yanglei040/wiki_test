{
    "hands_on_practices": [
        {
            "introduction": "为了真正掌握几何刚度，从基本原理出发，为一个简单的单元推导其矩阵形式是至关重要的第一步。这个练习旨在通过具体的计算，巩固虚功原理、形函数梯度以及初始应力状态如何共同作用，最终形成几何刚度矩阵的概念 。通过这个过程，你将加深对有限元理论中非线性项来源的理解，并为更复杂的分析打下坚实的数学基础。",
            "id": "3579573",
            "problem": "考虑有限元法 (FEM) 中的一个平面应力状态下的等参双线性四边形单元，其在物理坐标 $\\{x,y\\}$ 中占据一个矩形区域，满足 $x \\in [-a,a]$，$y \\in [-b,b]$，且厚度恒为 $t$。从自然坐标 $(\\xi,\\eta) \\in [-1,1]\\times[-1,1]$ 到物理坐标的映射为 $x = a \\,\\xi$ 和 $y = b \\,\\eta$，其标准双线性形函数为 $N_{1}(\\xi,\\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta)$，$N_{2}(\\xi,\\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta)$，$N_{3}(\\xi,\\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta)$ 和 $N_{4}(\\xi,\\eta) = \\frac{1}{4}(1-\\xi)(1+\\eta)$。假设整个单元内存在一个均匀的初始 Cauchy 应力场，其分量为 $\\sigma_{xx} = \\sigma_{0}$ 且 $\\sigma_{yy} = \\sigma_{xy} = 0$。利用虚功原理及其关于预应力构型的线性化，推导几何刚度矩阵 $K_{G}$（用形函数梯度和初始应力表示），然后对该单元精确计算所得积分。\n\n采用节点自由度顺序 $\\{u_{1x}, u_{1y}, u_{2x}, u_{2y}, u_{3x}, u_{3y}, u_{4x}, u_{4y}\\}$，并以 $a$、$b$、$t$ 和 $\\sigma_{0}$ 为参数，计算 $K_{G}$ 的显式 $8 \\times 8$ 闭合形式解析表达式。在推导过程中，请验证所得矩阵是对称的。将最终答案表示为单个闭合形式的矩阵表达式；无需进行数值舍入，答案中也无需指定物理单位。",
            "solution": "该问题经核实具有科学依据、提法恰当且客观。这是计算固体力学中的一个标准问题，特别是在使用有限元法 (FEM) 进行稳定性分析的背景下。所有必要信息均已提供，问题没有矛盾或含糊之处。因此，我们可以开始推导。\n\n几何刚度矩阵 $K_{G}$ 源于内虚功的线性化，它考虑了初始应力状态对单元刚度的影响。由该初始应力引起的内虚功贡献为：\n$$ \\delta W_{G} = \\int_{V_0} \\boldsymbol{S}^{(0)} : \\delta \\boldsymbol{E}_{NL} \\, dV_0 $$\n其中 $V_0$ 是单元在初始构型下的体积，$\\boldsymbol{S}^{(0)}$ 是初始第二 Piola-Kirchhoff 应力张量（由于构型未应变，它等于初始 Cauchy 应力张量 $\\boldsymbol{\\sigma}^{(0)}$），而 $\\delta \\boldsymbol{E}_{NL}$ 是 Green-Lagrange 应变张量非线性部分的变分。非线性应变项为 $\\boldsymbol{E}_{NL} = \\frac{1}{2} (\\nabla \\boldsymbol{u})^T (\\nabla \\boldsymbol{u})$，其中 $\\boldsymbol{u}$ 是位移场，$\\nabla \\boldsymbol{u}$ 是其梯度。其变分为 $\\delta \\boldsymbol{E}_{NL} = \\frac{1}{2} [(\\nabla \\delta \\boldsymbol{u})^T (\\nabla \\boldsymbol{u}) + (\\nabla \\boldsymbol{u})^T (\\nabla \\delta \\boldsymbol{u})]$。\n\n由于 $\\boldsymbol{S}^{(0)}$ 是对称的，被积函数变为 $\\boldsymbol{S}^{(0)} : \\delta \\boldsymbol{E}_{NL} = \\text{Tr}(\\boldsymbol{S}^{(0)} (\\nabla \\delta \\boldsymbol{u})^T (\\nabla \\boldsymbol{u}))$。对于二维问题，用矩阵-向量表示法可写为：\n$$ \\delta W_G = \\int_{V_0} \\begin{pmatrix} \\frac{\\partial \\delta u_x}{\\partial x}  \\frac{\\partial \\delta u_y}{\\partial x} \\\\ \\frac{\\partial \\delta u_x}{\\partial y}  \\frac{\\partial \\delta u_y}{\\partial y} \\end{pmatrix} : \\begin{pmatrix} \\sigma_{xx}^{(0)}  \\sigma_{xy}^{(0)} \\\\ \\sigma_{yx}^{(0)}  \\sigma_{yy}^{(0)} \\end{pmatrix} \\begin{pmatrix} \\frac{\\partial u_x}{\\partial x}  \\frac{\\partial u_x}{\\partial y} \\\\ \\frac{\\partial u_y}{\\partial x}  \\frac{\\partial u_y}{\\partial y} \\end{pmatrix} \\, dV_0 $$\n展开此表达式可得被积函数：\n$$ \\sigma_{xx}^{(0)} \\left(\\frac{\\partial \\delta u_x}{\\partial x} \\frac{\\partial u_x}{\\partial x} + \\frac{\\partial \\delta u_y}{\\partial x} \\frac{\\partial u_y}{\\partial x}\\right) + \\sigma_{yy}^{(0)} \\left(\\frac{\\partial \\delta u_x}{\\partial y} \\frac{\\partial u_x}{\\partial y} + \\frac{\\partial \\delta u_y}{\\partial y} \\frac{\\partial u_y}{\\partial y}\\right) + \\sigma_{xy}^{(0)} \\left(\\frac{\\partial \\delta u_x}{\\partial x} \\frac{\\partial u_x}{\\partial y} + \\frac{\\partial \\delta u_x}{\\partial y} \\frac{\\partial u_x}{\\partial x} + \\frac{\\partial \\delta u_y}{\\partial x} \\frac{\\partial u_y}{\\partial y} + \\frac{\\partial \\delta u_y}{\\partial y} \\frac{\\partial u_y}{\\partial x}\\right) $$\n给定初始应力状态 $\\sigma_{xx}^{(0)} = \\sigma_0$ 和 $\\sigma_{yy}^{(0)} = \\sigma_{xy}^{(0)} = 0$，该表达式可显著简化为：\n$$ \\delta W_G = \\int_{V_0} \\sigma_0 \\left( \\frac{\\partial \\delta u_x}{\\partial x} \\frac{\\partial u_x}{\\partial x} + \\frac{\\partial \\delta u_y}{\\partial x} \\frac{\\partial u_y}{\\partial x} \\right) \\, dV_0 $$\n位移场 $\\boldsymbol{u}(\\xi, \\eta) = (u_x, u_y)$ 是通过形函数 $N_i(\\xi, \\eta)$ 从节点位移 $\\boldsymbol{d}$ 插值得到的：\n$$ u_x(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) u_{ix} \\quad \\text{和} \\quad u_y(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) u_{iy} $$\n节点位移向量为 $\\boldsymbol{d} = \\{u_{1x}, u_{1y}, u_{2x}, u_{2y}, u_{3x}, u_{3y}, u_{4x}, u_{4y}\\}^T$。将插值位移代入 $\\delta W_G$ 的表达式中：\n$$ \\delta W_G = \\int_{V_0} \\sigma_0 \\left( \\left(\\sum_{i=1}^{4} \\frac{\\partial N_i}{\\partial x} \\delta u_{ix}\\right) \\left(\\sum_{j=1}^{4} \\frac{\\partial N_j}{\\partial x} u_{jx}\\right) + \\left(\\sum_{i=1}^{4} \\frac{\\partial N_i}{\\partial x} \\delta u_{iy}\\right) \\left(\\sum_{j=1}^{4} \\frac{\\partial N_j}{\\partial x} u_{jy}\\right) \\right) \\, dV_0 $$\n这是一个双线性形式 $\\delta \\boldsymbol{d}^T K_G \\boldsymbol{d}$。几何刚度矩阵 $K_G$ 的分量由下式给出：\n$$ (K_G)_{2i-1, 2j-1} = \\int_{V_0} \\sigma_0 \\frac{\\partial N_i}{\\partial x} \\frac{\\partial N_j}{\\partial x} \\, dV_0 $$\n$$ (K_G)_{2i, 2j} = \\int_{V_0} \\sigma_0 \\frac{\\partial N_i}{\\partial x} \\frac{\\partial N_j}{\\partial x} \\, dV_0 $$\n并且所有非对角块 $(K_G)_{2i-1, 2j}$ 和 $(K_G)_{2i, 2j-1}$ 均为零。这种结构表明 $K_G$ 是对称的，因为积分关于下标 $i$ 和 $j$ 是对称的。该矩阵可以表示为 Kronecker 积 $K_G = \\boldsymbol{k} \\otimes \\boldsymbol{I}_2$，其中 $\\boldsymbol{I}_2$ 是 $2 \\times 2$ 的单位矩阵，$\\boldsymbol{k}$ 是一个 $4 \\times 4$ 的矩阵，其分量为：\n$$ k_{ij} = \\int_{V_0} \\sigma_0 \\frac{\\partial N_i}{\\partial x} \\frac{\\partial N_j}{\\partial x} \\, dV_0 $$\n该积分必须变换到自然坐标系 $(\\xi, \\eta)$ 中。体积微元为 $dV_0 = t \\, dx \\, dy = t \\, \\det(\\boldsymbol{J}) \\, d\\xi \\, d\\eta$，其中 $\\boldsymbol{J}$ 是映射的 Jacobian 矩阵。\n映射由 $x=a\\xi$ 和 $y=b\\eta$ 给出。Jacobian 矩阵为：\n$$ \\boldsymbol{J} = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\xi} \\\\ \\frac{\\partial x}{\\partial \\eta}  \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix} = \\begin{pmatrix} a  0 \\\\ 0  b \\end{pmatrix} $$\n其行列式为 $\\det(\\boldsymbol{J}) = ab$。物理坐标导数与自然坐标导数之间的关系由链式法则给出：\n$$ \\begin{pmatrix} \\frac{\\partial N_i}{\\partial x} \\\\ \\frac{\\partial N_i}{\\partial y} \\end{pmatrix} = \\boldsymbol{J}^{-1} \\begin{pmatrix} \\frac{\\partial N_i}{\\partial \\xi} \\\\ \\frac{\\partial N_i}{\\partial \\eta} \\end{pmatrix} = \\begin{pmatrix} 1/a  0 \\\\ 0  1/b \\end{pmatrix} \\begin{pmatrix} \\frac{\\partial N_i}{\\partial \\xi} \\\\ \\frac{\\partial N_i}{\\partial \\eta} \\end{pmatrix} $$\n这得到 $\\frac{\\partial N_i}{\\partial x} = \\frac{1}{a} \\frac{\\partial N_i}{\\partial \\xi}$。将此代入 $k_{ij}$ 的积分中：\n$$ k_{ij} = \\int_{-1}^{1} \\int_{-1}^{1} \\sigma_0 \\left( \\frac{1}{a} \\frac{\\partial N_i}{\\partial \\xi} \\right) \\left( \\frac{1}{a} \\frac{\\partial N_j}{\\partial \\xi} \\right) t (ab) \\, d\\xi \\, d\\eta = \\frac{\\sigma_0 t b}{a} \\int_{-1}^{1} \\int_{-1}^{1} \\frac{\\partial N_i}{\\partial \\xi} \\frac{\\partial N_j}{\\partial \\xi} \\, d\\xi \\, d\\eta $$\n接下来，我们计算形函数关于 $\\xi$ 的导数：\n$N_{1} = \\frac{1}{4}(1-\\xi)(1-\\eta) \\implies \\frac{\\partial N_1}{\\partial \\xi} = -\\frac{1}{4}(1-\\eta)$\n$N_{2} = \\frac{1}{4}(1+\\xi)(1-\\eta) \\implies \\frac{\\partial N_2}{\\partial \\xi} = \\frac{1}{4}(1-\\eta)$\n$N_{3} = \\frac{1}{4}(1+\\xi)(1+\\eta) \\implies \\frac{\\partial N_3}{\\partial \\xi} = \\frac{1}{4}(1+\\eta)$\n$N_{4} = \\frac{1}{4}(1-\\xi)(1+\\eta) \\implies \\frac{\\partial N_4}{\\partial \\xi} = -\\frac{1}{4}(1+\\eta)$\n现在我们计算这些导数乘积的积分。\n$$ \\int_{-1}^{1} \\int_{-1}^{1} \\left(\\frac{1}{4}\\right)^2 (1-\\eta)^2 \\, d\\xi d\\eta = \\frac{1}{16} [\\xi]_{-1}^1 \\int_{-1}^1 (1-2\\eta+\\eta^2)d\\eta = \\frac{2}{16} \\left[\\eta-\\eta^2+\\frac{\\eta^3}{3}\\right]_{-1}^1 = \\frac{1}{8} \\left( \\frac{1}{3} - (-\\frac{7}{3}) \\right) = \\frac{1}{3} $$\n$$ \\int_{-1}^{1} \\int_{-1}^{1} \\left(\\frac{1}{4}\\right)^2 (1+\\eta)^2 \\, d\\xi d\\eta = \\frac{1}{16} [\\xi]_{-1}^1 \\int_{-1}^1 (1+2\\eta+\\eta^2)d\\eta = \\frac{2}{16} \\left[\\eta+\\eta^2+\\frac{\\eta^3}{3}\\right]_{-1}^1 = \\frac{1}{8} \\left( \\frac{7}{3} - (-\\frac{1}{3}) \\right) = \\frac{1}{3} $$\n$$ \\int_{-1}^{1} \\int_{-1}^{1} \\left(\\frac{1}{4}\\right)^2 (1-\\eta)(1+\\eta) \\, d\\xi d\\eta = \\frac{1}{16} [\\xi]_{-1}^1 \\int_{-1}^1 (1-\\eta^2)d\\eta = \\frac{2}{16} \\left[\\eta-\\frac{\\eta^3}{3}\\right]_{-1}^1 = \\frac{1}{8} \\left( \\frac{2}{3} - (-\\frac{2}{3}) \\right) = \\frac{1}{6} $$\n利用这些结果，我们构造矩阵 $\\boldsymbol{k}$。令 $C = \\frac{\\sigma_0 t b}{a}$。\n$k_{11} = C \\cdot (1) \\cdot \\frac{1}{3}$，$k_{12} = C \\cdot (-1) \\cdot \\frac{1}{3}$，$k_{13} = C \\cdot (-1) \\cdot \\frac{1}{6}$，$k_{14} = C \\cdot (1) \\cdot \\frac{1}{6}$\n$k_{22} = C \\cdot (1) \\cdot \\frac{1}{3}$，$k_{23} = C \\cdot (1) \\cdot \\frac{1}{6}$，$k_{24} = C \\cdot (-1) \\cdot \\frac{1}{6}$\n$k_{33} = C \\cdot (1) \\cdot \\frac{1}{3}$，$k_{34} = C \\cdot (-1) \\cdot \\frac{1}{3}$\n$k_{44} = C \\cdot (1) \\cdot \\frac{1}{3}$\n组装对称矩阵 $\\boldsymbol{k}$：\n$$ \\boldsymbol{k} = \\frac{\\sigma_0 t b}{a} \\begin{pmatrix} 1/3  -1/3  -1/6  1/6 \\\\ -1/3  1/3  1/6  -1/6 \\\\ -1/6  1/6  1/3  -1/3 \\\\ 1/6  -1/6  -1/3  1/3 \\end{pmatrix} = \\frac{\\sigma_0 t b}{6a} \\begin{pmatrix} 2  -2  -1  1 \\\\ -2  2  1  -1 \\\\ -1  1  2  -2 \\\\ 1  -1  -2  2 \\end{pmatrix} $$\n最终的 $8 \\times 8$ 几何刚度矩阵 $K_G = \\boldsymbol{k} \\otimes \\boldsymbol{I}_2$ 是通过将每个元素 $k_{ij}$ 替换为块 $k_{ij}\\boldsymbol{I}_2$ 来构造的：\n$$ K_G = \\frac{\\sigma_0 t b}{6a} \\begin{pmatrix}\n 2\\boldsymbol{I}_2  -2\\boldsymbol{I}_2  -1\\boldsymbol{I}_2   1\\boldsymbol{I}_2 \\\\\n-2\\boldsymbol{I}_2   2\\boldsymbol{I}_2   1\\boldsymbol{I}_2  -1\\boldsymbol{I}_2 \\\\\n-1\\boldsymbol{I}_2   1\\boldsymbol{I}_2   2\\boldsymbol{I}_2  -2\\boldsymbol{I}_2 \\\\\n 1\\boldsymbol{I}_2  -1\\boldsymbol{I}_2  -2\\boldsymbol{I}_2   2\\boldsymbol{I}_2\n\\end{pmatrix} $$\n将其展开为完整的 $8 \\times 8$ 矩阵即可得到最终结果。该矩阵是对称的，这可由 $\\boldsymbol{k}$ 的对称性得到证实。",
            "answer": "$$\n\\boxed{\\frac{\\sigma_{0} t b}{6a} \\begin{pmatrix}\n 2   0  -2   0  -1   0   1   0 \\\\\n 0   2   0  -2   0  -1   0   1 \\\\\n-2   0   2   0   1   0  -1   0 \\\\\n 0  -2   0   2   0   1   0  -1 \\\\\n-1   0   1   0   2   0  -2   0 \\\\\n 0  -1   0   1   0   2   0  -2 \\\\\n 1   0  -1   0  -2   0   2   0 \\\\\n 0   1   0  -1   0  -2   0   2\n\\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在理解了如何推导几何刚度矩阵之后，下一步是直观地感受它在实际工程问题中的重要性。这个编程练习通过一个预应力膜的简化模型，让你亲手验证是否包含几何刚度项 $K_{\\text{geo}}$ 对非线性求解过程的收敛性有着怎样的影响 。通过对比牛顿迭代法的收敛速度和迭代次数，你将清晰地看到，精确的切线刚度（特别是几何刚度项）对于解决稳定性问题是何等关键。",
            "id": "3579552",
            "problem": "考虑一个在有限元法 (FEM) 框架内，使用单一假设的平面外模态建模的张紧矩形薄膜。该薄膜占据域 $\\Omega = [0,L] \\times [0,W]$，厚度为 $t$，材料为各向同性线弹性，杨氏模量为 $E$，泊松比为 $\\nu$。它被初始预张紧，具有均匀的平面内应力合力 $N_{0x} = N_{0y} = T_0$ 和 $N_{0xy} = 0$，其中 $T_0$ 以 $\\mathrm{N}/\\mathrm{m}$ 为单位指定。平面外位移被限制为形式 $w(x,y) = u\\,\\phi(x,y)$，其中 $u \\in \\mathbb{R}$ 是单一广义坐标，$\\phi(x,y)$ 是一个光滑的模态振型，满足适用于该薄膜问题的本质边界条件。设外部横向压力 $p$ (单位为 $\\mathrm{N}/\\mathrm{m}^2$) 均匀作用于薄膜上。\n\n根据虚功原理和薄膜的 von Kármán 应变近似，其弱形式导出一个关于广义坐标 $u$ 的标量非线性残差 $R(u)$。总一致切线刚度 $K_t(u)$ 可加性地分解为由初始应力状态产生的几何刚度贡献 $K_{\\text{geo}}$ 和由本构关系及运动非线性产生的材料刚度贡献 $K_{\\text{mat}}(u)$。几何刚度 $K_{\\text{geo}}$ 与 $u$ 无关，而由于非线性薄膜应变，$K_{\\text{mat}}(u)$ 依赖于 $u$。\n\n您的目标是实现一个程序，该程序在两种线性化策略下执行牛顿迭代来求解 $R(u) = 0$：\n- 策略 A（全切线）：使用完整的一致切线 $K_t(u) = K_{\\text{geo}} + K_{\\text{mat}}(u)$。\n- 策略 B（忽略几何刚度）：使用简化的切线 $K_t^{\\neg \\text{geo}}(u) = K_{\\text{mat}}(u)$，同时保持相同的残差 $R(u)$。\n\n您必须：\n1. 从虚功原理和 von Kármán 薄膜运动学出发，对于单模态近似 $w=u\\phi$，将标量残差 $R(u)$ 表示为 $u$ 的函数。使用 von Kármán 假设下的平面内薄膜应变度量 $\\varepsilon_x$、$\\varepsilon_y$ 和 $\\gamma_{xy}$ 的定义，以及应力合力 $\\mathbf{N} = \\mathbf{C}\\,\\boldsymbol{\\varepsilon}$ 的平面应力本构律（其中 $\\mathbf{C}$ 是标准的各向同性薄膜刚度矩阵，用 $E$、$\\nu$ 和 $t$ 表示），推导 $R(u)$ 的结构，其形式应为在 $\\Omega$ 上的涉及 $\\phi$ 导数的积分。这些积分定义了算法所需的两个标量系数：\n   - 一个几何系数 $\\alpha$，来自初始应力合力 $N_{0x}$、$N_{0y}$ 的虚功和薄膜应变的变分。\n   - 一个材料系数 $\\beta$，来自本构应力合力 $\\mathbf{N} = \\mathbf{C}\\,\\boldsymbol{\\varepsilon}$ 的虚功和薄膜应变的变分。\n   外部载荷贡献了一个广义载荷幅值 $F$，它是 $p$ 在模态振型 $\\phi$ 上的投影。最终的标量残差必须为形式 $R(u) = \\alpha\\,T_0\\,u + \\beta\\,u^3 - F$，一致切线必须为形式 $K_t(u) = \\alpha\\,T_0 + 3\\,\\beta\\,u^2$。几何和材料切线贡献分别为 $K_{\\text{geo}} = \\alpha\\,T_0$ 和 $K_{\\text{mat}}(u) = 3\\,\\beta\\,u^2$。$\\alpha$、$\\beta$ 和 $F$ 的所有定义必须按照规定，从第一性原理推导出以 $\\phi$ 及其导数表示的在 $\\Omega$ 上的积分形式。使用模态振型 $\\phi(x,y) = \\sin\\!\\left(\\frac{\\pi x}{L}\\right)\\sin\\!\\left(\\frac{\\pi y}{W}\\right)$。\n\n2. 为策略 A 和 B 实现一个牛顿求解器。对两种策略使用相同的初始猜测值 $u_0$，该值基于一个有物理动机的近似来选择，以确保当 $F>0$ 时 $u_0$ 是严格正的。如果需要，执行回溯线搜索以确保每次迭代时 $|R(u)|$ 减小。使用残差大小的收敛容差 $\\varepsilon_{\\text{tol}} = 10^{-12}$（单位 $\\mathrm{N}$），以及最多 50 次迭代。对每个策略，测量：\n   - 收敛所需的牛顿迭代次数（一个整数）。\n   - 每次迭代的平均残差下降率，定义为在收敛前所有接受的迭代中比率 $r_k = \\frac{|R(u_{k+1})|}{|R(u_k)|}$ 的算术平均值（一个浮点数）。\n\n3. 单位必须一致：$L$ 和 $W$ 单位为 $\\mathrm{m}$，$t$ 单位为 $\\mathrm{m}$，$E$ 单位为 $\\mathrm{Pa}$，$\\nu$ 是无量纲的，$T_0$ 单位为 $\\mathrm{N}/\\mathrm{m}$，$p$ 单位为 $\\mathrm{N}/\\mathrm{m}^2$，$u$ 单位为 $\\mathrm{m}$，$R(u)$ 和 $F$ 单位为 $\\mathrm{N}$，刚度单位为 $\\mathrm{N}/\\mathrm{m}$。将平均残差下降率报告为无量纲浮点数，迭代次数报告为整数。\n\n4. 使用以下参数集测试套件，每个参数集指定为元组 $(L,W,t,E,\\nu,T_0,p)$，所有量均以所述单位表示：\n   - 测试 1：$(1.0\\,\\mathrm{m},\\,1.0\\,\\mathrm{m},\\,1.0\\times 10^{-4}\\,\\mathrm{m},\\,1.0\\times 10^{8}\\,\\mathrm{Pa},\\,0.3,\\,1000\\,\\mathrm{N}/\\mathrm{m},\\,1000\\,\\mathrm{N}/\\mathrm{m}^2)$。\n   - 测试 2：$(1.0\\,\\mathrm{m},\\,1.0\\,\\mathrm{m},\\,1.0\\times 10^{-4}\\,\\mathrm{m},\\,1.0\\times 10^{8}\\,\\mathrm{Pa},\\,0.3,\\,100\\,\\mathrm{N}/\\mathrm{m},\\,1000\\,\\mathrm{N}/\\mathrm{m}^2)$。\n   - 测试 3：$(1.0\\,\\mathrm{m},\\,1.0\\,\\mathrm{m},\\,1.0\\times 10^{-4}\\,\\mathrm{m},\\,1.0\\times 10^{8}\\,\\mathrm{Pa},\\,0.3,\\,0\\,\\mathrm{N}/\\mathrm{m},\\,1000\\,\\mathrm{N}/\\mathrm{m}^2)$。\n   - 测试 4：$(1.0\\,\\mathrm{m},\\,1.0\\,\\mathrm{m},\\,1.0\\times 10^{-4}\\,\\mathrm{m},\\,1.0\\times 10^{8}\\,\\mathrm{Pa},\\,0.3,\\,1000\\,\\mathrm{N}/\\mathrm{m},\\,5000\\,\\mathrm{N}/\\mathrm{m}^2)$。\n\n5. 最终输出格式：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。每个测试用例贡献一个形式为 $[\\text{iters\\_full},\\text{iters\\_no\\_geo},\\text{avg\\_rate\\_full},\\text{avg\\_rate\\_no\\_geo}]$ 的子列表，其中迭代次数为整数，平均速率为浮点数。例如，输出应如下所示：$\\left[\\left[i_1,j_1,r_1,s_1\\right],\\left[i_2,j_2,r_2,s_2\\right],\\left[i_3,j_3,r_3,s_3\\right],\\left[i_4,j_4,r_4,s_4\\right]\\right]$。\n\n您的实现必须是一个完整、可运行的程序，该程序根据给定的积分和模态振型 $\\phi(x,y)$ 计算 $\\alpha$、$\\beta$ 和 $F$，对策略 A 和 B 执行牛顿迭代，并以所描述的精确格式报告所提供的测试套件的所要求指标。",
            "solution": "经过仔细评估，用户问题被认为是有效的。它在科学上基于非线性固体力学的原理，是适定的，并且为获得唯一解提供了所有必要的数据和条件。该任务涉及计算力学中的标准推导，然后是数值求解算法的实现。\n\n该解决方案是基于预张紧薄膜的单模态近似，从虚功原理 (PVW) 发展而来的。PVW 指出，对于处于平衡状态的系统，对于任何运动学上容许的虚位移，内虚功 $\\delta W_{\\text{int}}$ 等于外虚功 $\\delta W_{\\text{ext}}$。\n\n$$ \\delta W_{\\text{int}} = \\delta W_{\\text{ext}} $$\n\n非线性系统的残差 $R(u)$ 由 PVW 定义为 $R(u) \\delta u = \\delta W_{\\text{int}} - \\delta W_{\\text{ext}} = 0$。由于这必须对广义坐标的任何任意虚位移 $\\delta u$ 都成立，因此 $R(u)$ 项必须为零。\n\n平面外位移 $w$ 及其变分 $\\delta w$ 使用单个模态振型 $\\phi(x,y)$ 和一个广义坐标 $u$ 来近似：\n$$ w(x,y) = u\\,\\phi(x,y) $$\n$$ \\delta w(x,y) = \\delta u\\,\\phi(x,y) $$\n\n内虚功是通过在体积上对应力张量与应变张量变分的缩并进行积分来计算的。对于薄膜，这表示为使用应力合力 $\\mathbf{N}$ 和薄膜应变 $\\boldsymbol{\\varepsilon}$。使用带有第二Piola-Kirchhoff应力合力 $\\mathbf{N}^S$ 和Green-Lagrange应变 $\\boldsymbol{\\varepsilon}_L$ 的材料描述，内虚功为：\n$$ \\delta W_{\\text{int}} = \\int_{\\Omega} (\\mathbf{N}^S)^T \\delta\\boldsymbol{\\varepsilon}_L \\,dA $$\n总应力合力是初始预张力 $\\mathbf{N}_0$ 和弹性产生的应力合力 $\\Delta\\mathbf{N}^S$ 的和，即 $\\mathbf{N}^S = \\mathbf{N}_0 + \\Delta\\mathbf{N}^S$。在 von Kármán 假设下（在应变-位移关系中忽略平面内位移），Green-Lagrange 薄膜应变是纯非线性的：\n$$ \\boldsymbol{\\varepsilon}_L = \\begin{Bmatrix} \\varepsilon_x \\\\ \\varepsilon_y \\\\ \\gamma_{xy} \\end{Bmatrix} = \\frac{1}{2} \\begin{Bmatrix} (\\frac{\\partial w}{\\partial x})^2 \\\\ (\\frac{\\partial w}{\\partial y})^2 \\\\ 2 \\frac{\\partial w}{\\partial x} \\frac{\\partial w}{\\partial y} \\end{Bmatrix} = \\frac{1}{2} u^2 \\begin{Bmatrix} (\\phi_{,x})^2 \\\\ (\\phi_{,y})^2 \\\\ 2 \\phi_{,x} \\phi_{,y} \\end{Bmatrix} $$\n它关于 $u$ 的变分为：\n$$ \\delta\\boldsymbol{\\varepsilon}_L = \\frac{\\partial \\boldsymbol{\\varepsilon}_L}{\\partial u} \\delta u = u\\,\\delta u \\begin{Bmatrix} (\\phi_{,x})^2 \\\\ (\\phi_{,y})^2 \\\\ 2 \\phi_{,x} \\phi_{,y} \\end{Bmatrix} $$\n应力变化的本构关系是 $\\Delta\\mathbf{N}^S = \\mathbf{C} \\boldsymbol{\\varepsilon}_L$，其中 $\\mathbf{C}$ 是平面应力薄膜刚度矩阵。\n内虚功可以加性分解为：\n$$ \\delta W_{\\text{int}} = \\int_{\\Omega} (\\mathbf{N}_0 + \\mathbf{C}\\boldsymbol{\\varepsilon}_L)^T \\delta\\boldsymbol{\\varepsilon}_L \\,dA = \\underbrace{\\int_{\\Omega} \\mathbf{N}_0^T \\delta\\boldsymbol{\\varepsilon}_L \\,dA}_{\\delta W_{\\text{geo}}} + \\underbrace{\\int_{\\Omega} (\\mathbf{C}\\boldsymbol{\\varepsilon}_L)^T \\delta\\boldsymbol{\\varepsilon}_L \\,dA}_{\\delta W_{\\text{mat}}} $$\n\n第一项 $\\delta W_{\\text{geo}}$ 代表初始应力场所做的功。当 $\\mathbf{N}_0 = \\{T_0, T_0, 0\\}^T$ 时：\n$$ \\delta W_{\\text{geo}} = \\int_{\\Omega} \\begin{Bmatrix} T_0 \\\\ T_0 \\\\ 0 \\end{Bmatrix}^T \\left( u\\,\\delta u \\begin{Bmatrix} \\phi_{,x}^2 \\\\ \\phi_{,y}^2 \\\\ 2\\phi_{,x}\\phi_{,y} \\end{Bmatrix} \\right) \\,dA = \\left( T_0 u \\int_{\\Omega} (\\phi_{,x}^2 + \\phi_{,y}^2) \\,dA \\right) \\delta u $$\n这定义了几何系数 $\\alpha$：\n$$ \\alpha = \\int_{\\Omega} \\left( \\left(\\frac{\\partial\\phi}{\\partial x}\\right)^2 + \\left(\\frac{\\partial\\phi}{\\partial y}\\right)^2 \\right) \\,dA $$\n对残差的贡献是 $\\alpha T_0 u$。\n\n第二项 $\\delta W_{\\text{mat}}$ 代表弹性应力所做的功。\n$$ \\delta W_{\\text{mat}} = \\int_{\\Omega} \\boldsymbol{\\varepsilon}_L^T \\mathbf{C} \\delta\\boldsymbol{\\varepsilon}_L \\,dA = \\int_{\\Omega} \\left(\\frac{1}{2}u^2 \\mathbf{v}^T \\mathbf{C}\\right) (u\\,\\delta u\\,\\mathbf{v}) \\,dA = \\left( \\frac{1}{2}u^3 \\int_{\\Omega} \\mathbf{v}^T \\mathbf{C} \\mathbf{v} \\,dA \\right)\\delta u $$\n其中 $\\mathbf{v} = \\{\\phi_{,x}^2, \\phi_{,y}^2, 2\\phi_{,x}\\phi_{,y}\\}^T$。这定义了材料系数 $\\beta$：\n$$ \\beta = \\frac{1}{2} \\int_{\\Omega} \\begin{Bmatrix} (\\phi_{,x})^2 \\\\ (\\phi_{,y})^2 \\\\ 2\\phi_{,x}\\phi_{,y} \\end{Bmatrix}^T \\mathbf{C} \\begin{Bmatrix} (\\phi_{,x})^2 \\\\ (\\phi_{,y})^2 \\\\ 2\\phi_{,x}\\phi_{,y} \\end{Bmatrix} \\,dA $$\n平面应力本构矩阵是：\n$$ \\mathbf{C} = \\frac{E t}{1-\\nu^2} \\begin{bmatrix} 1  \\nu  0 \\\\ \\nu  1  0 \\\\ 0  0  \\frac{1-\\nu}{2} \\end{bmatrix} $$\n将 $\\mathbf{C}$ 代入 $\\beta$ 的表达式并简化得到：\n$$ \\beta = \\frac{Et}{2(1-\\nu^2)} \\int_{\\Omega} \\left( (\\phi_{,x}^2 + \\phi_{,y}^2)^2 + (2\\nu - 1) (\\phi_{,x}^2 \\phi_{,y}^2 - (\\phi_{,x}\\phi_{,y})^2) \\right) \\, dA $$\n对于所选的模态振型，$\\phi_{,x} \\propto \\cos(\\cdot)\\sin(\\cdot)$ 和 $\\phi_{,y} \\propto \\sin(\\cdot)\\cos(\\cdot)$，因此 $\\phi_{,x}^2 \\phi_{,y}^2 = (\\phi_{,x}\\phi_{,y})^2$，这极大地简化了被积函数：\n$$ \\beta = \\frac{Et}{2(1-\\nu^2)} \\int_{\\Omega} (\\phi_{,x}^2 + \\phi_{,y}^2)^2 \\, dA $$\n\n由均匀压力 $p$ 引起的外虚功 $\\delta W_{\\text{ext}}$ 为：\n$$ \\delta W_{\\text{ext}} = \\int_{\\Omega} p\\,\\delta w \\,dA = \\int_{\\Omega} p\\,(\\phi\\,\\delta u) \\,dA = \\left( p \\int_{\\Omega} \\phi \\,dA \\right) \\delta u $$\n这定义了广义力 $F$：\n$$ F = p \\int_{\\Omega} \\phi \\,dA $$\n\n合并各项，标量残差方程 $R(u)=0$ 为：\n$$ R(u) = \\alpha T_0 u + \\beta u^3 - F = 0 $$\n一致切线刚度 $K_t(u)$ 是残差关于 $u$ 的导数：\n$$ K_t(u) = \\frac{dR}{du} = \\alpha T_0 + 3\\beta u^2 $$\n这自然地分解为几何刚度 $K_{\\text{geo}} = \\alpha T_0$ 和材料刚度 $K_{\\text{mat}}(u) = 3\\beta u^2$。\n\n系数 $\\alpha$、$\\beta$ 和 $F$ 是针对域 $\\Omega = [0,L] \\times [0,W]$ 上的模态振型 $\\phi(x,y) = \\sin(\\frac{\\pi x}{L})\\sin(\\frac{\\pi y}{W})$ 计算的。所需的积分计算如下：\n$$ \\int_0^L \\sin^2\\left(\\frac{\\pi x}{L}\\right)dx = \\frac{L}{2}, \\quad \\int_0^L \\cos^2\\left(\\frac{\\pi x}{L}\\right)dx = \\frac{L}{2} $$\n$$ \\int_0^L \\sin^4\\left(\\frac{\\pi x}{L}\\right)dx = \\frac{3L}{8}, \\quad \\int_0^L \\cos^4\\left(\\frac{\\pi x}{L}\\right)dx = \\frac{3L}{8} $$\n$$ \\int_0^L \\sin^2\\left(\\frac{\\pi x}{L}\\right)\\cos^2\\left(\\frac{\\pi x}{L}\\right)dx = \\frac{L}{8} $$\n这些恒等式同样适用于在 $[0,W]$ 上对 $y$ 的积分。\n\n$F$ 的计算：\n$$ F = p \\int_0^L \\sin\\left(\\frac{\\pi x}{L}\\right)dx \\int_0^W \\sin\\left(\\frac{\\pi y}{W}\\right)dy = p \\left(\\frac{2L}{\\pi}\\right) \\left(\\frac{2W}{\\pi}\\right) = \\frac{4LWp}{\\pi^2} $$\n\n$\\alpha$ 的计算：\n$$ \\alpha = \\int_0^L \\hspace{-2mm} \\int_0^W \\hspace{-2mm} \\left(\\left(\\frac{\\pi}{L}\\right)^2 \\cos^2\\left(\\frac{\\pi x}{L}\\right)\\sin^2\\left(\\frac{\\pi y}{W}\\right) + \\left(\\frac{\\pi}{W}\\right)^2 \\sin^2\\left(\\frac{\\pi x}{L}\\right)\\cos^2\\left(\\frac{\\pi y}{W}\\right)\\right) dy dx $$\n$$ \\alpha = \\left(\\frac{\\pi}{L}\\right)^2 \\left(\\frac{L}{2}\\right)\\left(\\frac{W}{2}\\right) + \\left(\\frac{\\pi}{W}\\right)^2 \\left(\\frac{L}{2}\\right)\\left(\\frac{W}{2}\\right) = \\frac{\\pi^2 W}{4L} + \\frac{\\pi^2 L}{4W} = \\frac{\\pi^2}{4}\\left(\\frac{W}{L} + \\frac{L}{W}\\right) $$\n\n$\\beta$ 的计算：所需的积分是 $\\int_\\Omega (\\phi_{,x}^2 + \\phi_{,y}^2)^2 \\, dA$。\n$$ (\\phi_{,x}^2 + \\phi_{,y}^2)^2 = \\left(\\left(\\frac{\\pi}{L}\\right)^2 c_x^2 s_y^2 + \\left(\\frac{\\pi}{W}\\right)^2 s_x^2 c_y^2\\right)^2 = \\left(\\frac{\\pi}{L}\\right)^4 c_x^4 s_y^4 + \\left(\\frac{\\pi}{W}\\right)^4 s_x^4 c_y^4 + 2\\left(\\frac{\\pi^2}{LW}\\right)^2 c_x^2 s_x^2 c_y^2 s_y^2 $$\n其中 $s_x = \\sin(\\pi x/L)$，$c_y = \\cos(\\pi y/W)$，等等。逐项积分：\n$$ \\int_{\\Omega} (\\phi_{,x}^2+\\phi_{,y}^2)^2 dA = \\left(\\frac{\\pi}{L}\\right)^4\\left(\\frac{3L}{8}\\right)\\left(\\frac{3W}{8}\\right) + \\left(\\frac{\\pi}{W}\\right)^4\\left(\\frac{3L}{8}\\right)\\left(\\frac{3W}{8}\\right) + 2\\left(\\frac{\\pi^2}{LW}\\right)^2\\left(\\frac{L}{8}\\right)\\left(\\frac{W}{8}\\right) $$\n$$ = \\frac{9\\pi^4 W}{64 L^3} + \\frac{9\\pi^4 L}{64 W^3} + \\frac{2\\pi^4}{64 LW} = \\frac{\\pi^4}{64}\\left(\\frac{9W}{L^3} + \\frac{9L}{W^3} + \\frac{2}{LW}\\right) $$\n因此，系数 $\\beta$ 是：\n$$ \\beta = \\frac{Et}{2(1-\\nu^2)} \\frac{\\pi^4}{64}\\left(\\frac{9W}{L^3} + \\frac{9L}{W^3} + \\frac{2}{LW}\\right) $$\n利用这些系数，实现了牛顿求解器。一个有物理动机的初始猜测值 $u_0$ 从线性化问题导出：如果 $T_0 > 0$，线性几何刚度在小 $u$ 时占主导地位，给出 $u_0 \\approx F/(\\alpha T_0)$。如果 $T_0 = 0$，问题是纯非线性的，使用精确解 $u = (F/\\beta)^{1/3}$ 作为初始猜测值。使用回溯线搜索来全局化牛顿迭代的收敛性。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the nonlinear deflection of a pre-tensioned membrane using a\n    single-mode approximation and compares two Newton iteration strategies.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (L, W, t, E, nu, T0, p)\n        (1.0, 1.0, 1.0e-4, 1.0e8, 0.3, 1000.0, 1000.0),\n        (1.0, 1.0, 1.0e-4, 1.0e8, 0.3, 100.0, 1000.0),\n        (1.0, 1.0, 1.0e-4, 1.0e8, 0.3, 0.0, 1000.0),\n        (1.0, 1.0, 1.0e-4, 1.0e8, 0.3, 1000.0, 5000.0),\n    ]\n\n    all_results = []\n    for case in test_cases:\n        case_results = run_case(case)\n        all_results.append(case_results)\n\n    # Final print statement in the exact required format.\n    # e.g. [[i1,j1,r1,s1],[i2,j2,r2,s2],...]\n    outer_parts = []\n    for res in all_results:\n        inner_parts = [str(item) for item in res]\n        inner_str = f\"[{','.join(inner_parts)}]\"\n        outer_parts.append(inner_str)\n    \n    final_output_str = f\"[{','.join(outer_parts)}]\"\n    print(final_output_str)\n\ndef calculate_coefficients(L, W, t, E, nu, p):\n    \"\"\"\n    Calculates the scalar coefficients F, alpha, and beta based on the\n    derived integral formulas.\n    \"\"\"\n    # Generalized force F\n    F = 4.0 * L * W * p / (np.pi**2)\n\n    # Geometric coefficient alpha\n    alpha = (np.pi**2 / 4.0) * (W / L + L / W)\n\n    # Material coefficient beta\n    C_factor = E * t / (1.0 - nu**2)\n    integral_term = (np.pi**4 / 64.0) * (\n        9.0 * W / L**3 + 9.0 * L / W**3 + 2.0 / (L * W)\n    )\n    beta = (C_factor / 2.0) * integral_term\n\n    return F, alpha, beta\n\ndef newton_solver(F, alpha, beta, T0, use_k_geo):\n    \"\"\"\n    Performs Newton iterations to solve R(u) = 0.\n    \n    Args:\n        F, alpha, beta, T0: Scalar coefficients of the problem.\n        use_k_geo (bool): If True, use full tangent. If False, neglect K_geo.\n\n    Returns:\n        tuple: (iteration_count, average_residual_reduction_rate).\n               Returns (-1, -1.0) on failure.\n    \"\"\"\n    TOL = 1.0e-12\n    MAX_ITER = 50\n\n    def residual(u):\n        return alpha * T0 * u + beta * u**3 - F\n\n    def tangent(u):\n        K_geo = alpha * T0\n        K_mat = 3.0 * beta * u**2\n        if use_k_geo:\n            return K_geo + K_mat\n        else:\n            # For Strategy B, K_geo is omitted from the tangent\n            return K_mat\n\n    # Initial guess for displacement u\n    k_lin = alpha * T0\n    # Use linear solution if stable, otherwise cubic solution\n    if k_lin > 1e-9:\n        u = F / k_lin\n    else:\n        # This branch is taken for T0 = 0\n        if beta > 1e-9:\n            u = (F / beta)**(1.0/3.0)\n        else:\n            # Case with no stiffness, solution is arbitrary or infinite\n            u = 0.0\n\n    R_current = residual(u)\n    if abs(R_current) = TOL:\n        return 0, 0.0\n\n    iterations = 0\n    reduction_rates = []\n\n    for i in range(MAX_ITER):\n        K = tangent(u)\n        \n        # Check for singular stiffness (e.g., in Strategy B at u=0)\n        if abs(K)  1e-12:\n            return -1, -1.0 # Failure: singular tangent\n\n        delta_u = -R_current / K\n\n        # Backtracking line search to ensure residual reduction\n        lambda_ls = 1.0\n        for _ in range(10): # Max 10 backtracking steps\n            u_next = u + lambda_ls * delta_u\n            R_next = residual(u_next)\n            if abs(R_next)  abs(R_current):\n                break\n            lambda_ls /= 2.0\n        else:\n            # Line search failed to find a decreasing step\n            return -2, -2.0 # Failure: line search\n\n        # Store reduction rate before updating state\n        if abs(R_current) > 1e-15: # Avoid division by zero\n            reduction_rates.append(abs(R_next) / abs(R_current))\n\n        # Update state for next iteration\n        u = u_next\n        R_current = R_next\n        iterations += 1\n\n        # Check for convergence\n        if abs(R_current) = TOL:\n            avg_rate = np.mean(reduction_rates) if reduction_rates else 0.0\n            return iterations, avg_rate\n\n    # If loop finishes, max iterations were reached without convergence\n    return MAX_ITER, np.mean(reduction_rates) if reduction_rates else -3.0\n\ndef run_case(case_params):\n    \"\"\"\n    Runs a single test case for both strategies and returns the metrics.\n    \"\"\"\n    L, W, t, E, nu, T0, p = case_params\n\n    F, alpha, beta = calculate_coefficients(L, W, t, E, nu, p)\n\n    # Strategy A: Full tangent K_t = K_geo + K_mat\n    iters_full, avg_rate_full = newton_solver(\n        F, alpha, beta, T0, use_k_geo=True\n    )\n\n    # Strategy B: Reduced tangent K_t = K_mat\n    iters_no_geo, avg_rate_no_geo = newton_solver(\n        F, alpha, beta, T0, use_k_geo=False\n    )\n\n    return [iters_full, iters_no_geo, avg_rate_full, avg_rate_no_geo]\n\nsolve()\n```"
        },
        {
            "introduction": "超越了具体的计算，对几何刚度更深层次的理解还包括分析其在不同物理情境下的数学性质。本练习将引导你思考一个在高等计算力学中至关重要的问题：外部载荷的性质（例如，保守载荷与非保守的随动载荷）如何影响切线刚度矩阵的对称性 。理解这一点不仅关乎理论的严谨性，更直接决定了在求解大规模非线性方程组时，应选用何种高效且稳定的迭代求解器（如 Conjugate Gradient 法或 GMRES 法）。",
            "id": "3579489",
            "problem": "考虑一个在更新拉格朗日法下进行有限元离散化的超弹性体，其节点位移向量为 $\\mathbf{u}$，残差向量为 $\\mathbf{R}(\\mathbf{u})$。一致切线刚度矩阵定义为 Fréchet 导数 $\\mathbf{K}_\\text{tan} = \\partial \\mathbf{R}/\\partial \\mathbf{u}$，它可以被加性地分解为材料刚度贡献 $\\mathbf{K}_\\text{mat}$ 和由应力与运动学耦合产生的几何刚度贡献 $\\mathbf{K}_\\text{geo}$。控制方程源于虚功原理和超弹性理论，载荷以两种不同的方式施加在边界上：(I) 不依赖于当前构型的保守死载荷，以及 (II) 大小恒为 $p$、沿当前外法线方向的非保守随动压力。\n\n运用第一性原理——即外力功是否存在标量势、虚功原理以及弱形式的一致线性化——分析在这两种载荷类别下 $\\mathbf{K}_\\text{tan}$ 的对称性。特别地，评估 $\\mathbf{K}_\\text{geo}$ 是否会变得非对称，并讨论这对基于对称性要求的 Krylov 子空间迭代求解器的影响。\n\n选择所有正确的陈述：\n\nA. 对于作用在参考构型上的保守死载荷，一致切线刚度 $\\mathbf{K}_\\text{tan}$ 等于总势能的 Hessian 矩阵，这使得 $\\mathbf{K}_\\text{mat}$ 和 $\\mathbf{K}_\\text{geo}$ 都是对称的；因此，只要 $\\mathbf{K}_\\text{tan}$ 是正定的，共轭梯度法 (CG) 就适用。\n\nB. 对于垂直于当前构型的大小恒定的随动压力，外力虚功的一致线性化会产生一个非对称的几何刚度 $\\mathbf{K}_\\text{geo}$，因为曲面法线的变分对测试函数和试探函数的耦合方式不同；因此，需要对称性的 Krylov 方法（如共轭梯度法 CG）不再适用，应使用针对非对称系统的方法，例如广义最小残差法 (GMRES) 或双共轭梯度稳定法 (BiCGSTAB)，并配合适当的非对称预条件。\n\nC. 只要材料是超弹性的，在随动压力作用下，切线刚度仍然保持对称，因为材料刚度 $\\mathbf{K}_\\text{mat}$ 的对称性意味着无论载荷如何，总切线刚度都是对称的。\n\nD. 由随动载荷引起的任何对称性损失都可以通过采用全拉格朗日法并在参考构型上集成所有项来消除；因此，共轭梯度法 (CG) 仍然无限制地有效。\n\nE. 由于外力虚功不依赖于构型，与死载荷相关的几何刚度 $\\mathbf{K}_\\text{geo}$ 必然是反对称的。",
            "solution": "问题陈述是有效的。它描述了非线性计算固体力学中一个标准的、适定的问题，该问题涉及在不同加载条件下切线刚度矩阵的对称性。\n\n分析的基础是虚功原理，在有限元离散化后，其残差形式为 $\\mathbf{R}(\\mathbf{u}) = \\mathbf{F}_\\text{ext}(\\mathbf{u}) - \\mathbf{F}_\\text{int}(\\mathbf{u}) = \\mathbf{0}$。其中，$\\mathbf{u}$ 是节点位移向量，$\\mathbf{F}_\\text{int}$ 是内力向量，$\\mathbf{F}_\\text{ext}$ 是外力向量。一致切线刚度矩阵 $\\mathbf{K}_\\text{tan}$ 是通过将残差对位移进行线性化得到的，即 $\\mathbf{K}_\\text{tan} = -\\frac{\\partial \\mathbf{R}}{\\partial \\mathbf{u}}$。这得到：\n$$ \\mathbf{K}_\\text{tan} = \\frac{\\partial \\mathbf{F}_\\text{int}}{\\partial \\mathbf{u}} - \\frac{\\partial \\mathbf{F}_\\text{ext}}{\\partial \\mathbf{u}} $$\n我们定义 $\\mathbf{K}_\\text{int} = \\frac{\\partial \\mathbf{F}_\\text{int}}{\\partial \\mathbf{u}}$ 和 $\\mathbf{K}_\\text{ext} = \\frac{\\partial \\mathbf{F}_\\text{ext}}{\\partial \\mathbf{u}}$。\n\n对于超弹性材料，存在一个应变能势函数 $\\mathcal{U}(\\mathbf{u})$，使得内力是其梯度：$\\mathbf{F}_\\text{int} = \\frac{\\partial \\mathcal{U}}{\\partial \\mathbf{u}}$。因此，内力刚度矩阵 $\\mathbf{K}_\\text{int}$ 是该势函数的 Hessian 矩阵：\n$$ \\mathbf{K}_\\text{int} = \\frac{\\partial^2 \\mathcal{U}}{\\partial \\mathbf{u} \\partial \\mathbf{u}^T} $$\n根据关于混合偏导数相等的 Young 定理，Hessian 矩阵总是对称的。因此，$\\mathbf{K}_\\text{int}$ 是一个对称矩阵。该矩阵通常被分解为材料部分和几何（或初始应力）部分，$\\mathbf{K}_\\text{int} = \\mathbf{K}_\\text{mat} + \\mathbf{K}_{\\text{geo,int}}$，对于超弹性材料，这两部分都是对称的。\n\n因此，总切线刚度 $\\mathbf{K}_\\text{tan} = \\mathbf{K}_\\text{int} - \\mathbf{K}_\\text{ext}$ 的对称性完全取决于“载荷刚度矩阵” $\\mathbf{K}_\\text{ext}$ 的对称性，而后者由外载荷的性质决定。\n\n问题陈述中使用了分解 $\\mathbf{K}_\\text{tan} = \\mathbf{K}_\\text{mat} + \\mathbf{K}_\\text{geo}$。与 $\\mathbf{K}_\\text{tan} = (\\mathbf{K}_\\text{mat} + \\mathbf{K}_{\\text{geo,int}}) - \\mathbf{K}_\\text{ext}$ 相比较，我们可以确定问题中提到的几何刚度贡献为 $\\mathbf{K}_\\text{geo} = \\mathbf{K}_{\\text{geo,int}} - \\mathbf{K}_\\text{ext}$。因此，$\\mathbf{K}_\\text{geo}$ 的对称性将取决于 $\\mathbf{K}_\\text{ext}$ 的对称性。\n\n**情况 I：保守死载荷**\n死载荷的大小和方向恒定，不随物体构型变化。外力向量 $\\mathbf{F}_\\text{ext}$ 是一个常数。这类载荷是保守的，因为它可以从一个势 $W_\\text{ext}(\\mathbf{u}) = \\mathbf{F}_\\text{ext}^T \\mathbf{u}$ 导出。外力向量对位移的导数为零：\n$$ \\mathbf{K}_\\text{ext} = \\frac{\\partial \\mathbf{F}_\\text{ext}}{\\partial \\mathbf{u}} = \\mathbf{0} $$\n在这种情况下，切线刚度为 $\\mathbf{K}_\\text{tan} = \\mathbf{K}_\\text{int}$，它是对称的。整个系统存在一个总势能 $\\Pi(\\mathbf{u}) = \\mathcal{U}(\\mathbf{u}) - W_\\text{ext}(\\mathbf{u})$，而 $\\mathbf{K}_\\text{tan}$ 是这个总势能的对称 Hessian 矩阵。几何刚度贡献为 $\\mathbf{K}_\\text{geo} = \\mathbf{K}_{\\text{geo,int}}$，也是对称的。\n\n**情况 II：非保守随动压力**\n随动压力定义为作用在当前变形表面上、大小恒为 $p$ 的压力。外力虚功为 $\\delta W_\\text{ext} = \\int_{\\partial\\mathcal{B}_t} (-p \\mathbf{n}) \\cdot \\delta\\mathbf{u} \\, dA$，其中 $\\mathbf{n}$ 是当前表面 $\\partial\\mathcal{B}_t$ 上的外法线，而 $dA$ 是当前面积元。$\\mathbf{n}$ 和 $dA$ 都是位移 $\\mathbf{u}$ 的函数。因此，外力向量 $\\mathbf{F}_\\text{ext}(\\mathbf{u})$ 是 $\\mathbf{u}$ 的一个非线性函数，并且这些载荷是非保守的，意味着它们不能从一个标量势 $W_\\text{ext}(\\mathbf{u})$ 导出。\n\n为了求得 $\\mathbf{K}_\\text{ext}$，我们必须将外力虚功对位移增量 $\\Delta\\mathbf{u}$ 进行线性化。这涉及到求 $\\delta W_\\text{ext}$ 的方向导数。线性化过程包含了由法向量的变分 $D[\\mathbf{n}](\\Delta\\mathbf{u})$ 和面积元的变分 $D[dA](\\Delta\\mathbf{u})$ 产生的项。法向量的变分以一种非对称的方式耦合了测试函数 ($\\delta\\mathbf{u}$) 和试探函数 ($\\Delta\\mathbf{u}$)。由此产生的载荷刚度矩阵 $\\mathbf{K}_\\text{ext}$ 是非对称的。\n\n因此，总切线刚度矩阵 $\\mathbf{K}_\\text{tan} = \\mathbf{K}_\\text{int} - \\mathbf{K}_\\text{ext}$ 是对称矩阵 $\\mathbf{K}_\\text{int}$ 和非对称矩阵 $-\\mathbf{K}_\\text{ext}$ 的和，这使得 $\\mathbf{K}_\\text{tan}$ 成为非对称的。类似地，由于 $\\mathbf{K}_\\text{ext}$ 的贡献，几何刚度 $\\mathbf{K}_\\text{geo} = \\mathbf{K}_{\\text{geo,int}} - \\mathbf{K}_\\text{ext}$ 也变得非对称。\n\n**逐项分析**\n\n**A. 对于作用在参考构型上的保守死载荷，一致切线刚度 $\\mathbf{K}_\\text{tan}$ 等于总势能的 Hessian 矩阵，这使得 $\\mathbf{K}_\\text{mat}$ 和 $\\mathbf{K}_\\text{geo}$ 都是对称的；因此，只要 $\\mathbf{K}_\\text{tan}$ 是正定的，共轭梯度法 (CG) 就适用。**\n该陈述是正确的。正如所推导的，对于保守死载荷，存在一个总势能 $\\Pi$，并且 $\\mathbf{K}_\\text{tan} = \\frac{\\partial^2 \\Pi}{\\partial \\mathbf{u} \\partial \\mathbf{u}^T}$ 是其 Hessian 矩阵，该矩阵是对称的。分解式 $\\mathbf{K}_\\text{tan} = \\mathbf{K}_\\text{mat} + \\mathbf{K}_\\text{geo}$ 意味着两个分量矩阵都必须是对称的（因为 $\\mathbf{K}_\\text{ext} = \\mathbf{0}$，所以 $\\mathbf{K}_\\text{geo} = \\mathbf{K}_{\\text{geo,int}}$ 是对称的）。共轭梯度法 (CG) 是专门为对称正定 (SPD) 系统设计的。因此，如果 $\\mathbf{K}_\\text{tan}$ 是对称正定的（即，构型是稳定的），CG 就是合适的迭代求解器。\n**结论：正确**\n\n**B. 对于垂直于当前构型的大小恒定的随动压力，外力虚功的一致线性化会产生一个非对称的几何刚度 $\\mathbf{K}_\\text{geo}$，因为曲面法线的变分对测试函数和试探函数的耦合方式不同；因此，需要对称性的 Krylov 方法（如共轭梯度法 CG）不再适用，应使用针对非对称系统的方法，例如广义最小残差法 (GMRES) 或双共轭梯度稳定法 (BiCGSTAB)，并配合适当的非对称预条件。**\n该陈述也是正确的。如前所述，随动载荷方向对构型的依赖性导致了非对称的载荷刚度矩阵 $\\mathbf{K}_\\text{ext}$。这使得几何刚度项 $\\mathbf{K}_\\text{geo}$ 和总切线刚度 $\\mathbf{K}_\\text{tan}$ 都变为非对称。CG 从根本上不适用于非对称系统。必须采用为一般矩阵设计的求解器，例如 GMRES 或 BiCGSTAB。提及适当的预条件也是一个至关重要的实际考虑。\n**结论：正确**\n\n**C. 只要材料是超弹性的，在随动压力作用下，切线刚度仍然保持对称，因为材料刚度 $\\mathbf{K}_\\text{mat}$ 的对称性意味着无论载荷如何，总切线刚度都是对称的。**\n该陈述是错误的。超弹性保证了内力刚度部分 $\\mathbf{K}_\\text{int} = \\mathbf{K}_\\text{mat} + \\mathbf{K}_{\\text{geo,int}}$ 的对称性。然而，由随动载荷产生的非零且非对称的 $\\mathbf{K}_\\text{ext}$ 项使得总切线刚度 $\\mathbf{K}_\\text{tan} = \\mathbf{K}_\\text{int} - \\mathbf{K}_\\text{ext}$ 变得非对称。一个加法表达式中一部分的对称性并不能保证和的对称性。\n**结论：错误**\n\n**D. 由随动载荷引起的任何对称性损失都可以通过采用全拉格朗日法并在参考构型上集成所有项来消除；因此，共轭梯度法 (CG) 仍然无限制地有效。**\n该陈述是错误的。运动学描述的选择——更新拉格朗日法 (UL) 或全拉格朗日法 (TL)——不会改变载荷的物理性质。无论计算使用哪个参考系，非保守随动载荷仍然是非保守的。在 TL 法中，外力虚功项的线性化仍然会产生一个非对称的载荷刚度矩阵。矩阵各项的数学表达式会改变，但它们的非对称特性依然存在。因此，$\\mathbf{K}_\\text{tan}$ 仍然是非对称的，CG 不适用。\n**结论：错误**\n\n**E. 由于外力虚功不依赖于构型，与死载荷相关的几何刚度 $\\mathbf{K}_\\text{geo}$ 必然是反对称的。**\n该陈述是错误的。对于死载荷，$\\mathbf{K}_\\text{ext}=\\mathbf{0}$。几何刚度为 $\\mathbf{K}_\\text{geo} = \\mathbf{K}_{\\text{geo,int}}$。这个“初始应力”矩阵源于对称的内力刚度 $\\mathbf{K}_\\text{int}$，并且对于超弹性材料它本身也是对称的。通常情况下，它既不是零也不是反对称的；它的特征值决定了结构的弹性稳定性（屈曲）。\n**结论：错误**",
            "answer": "$$\\boxed{AB}$$"
        }
    ]
}