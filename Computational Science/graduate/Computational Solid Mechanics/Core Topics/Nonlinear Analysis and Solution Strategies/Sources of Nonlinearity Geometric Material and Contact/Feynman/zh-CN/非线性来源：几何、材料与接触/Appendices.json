{
    "hands_on_practices": [
        {
            "introduction": "要掌握几何非线性，首先必须能够精确地描述和量化大变形。本练习旨在通过一个均质拉伸的典型案例，帮助您巩固对变形梯度 ($F$)、右柯西-格林张量 ($C$) 和格林-拉格朗日应变张量 ($E$) 等关键运动学概念的理解。通过亲手计算这些核心张量并执行极分解，您将为分析更复杂的有限应变问题奠定坚实的数学基础。",
            "id": "3601263",
            "problem": "考虑一个三维物体，其经历的均匀变形由运动 $\\varphi:\\mathbb{R}^{3}\\to\\mathbb{R}^{3}$ 描述，在笛卡尔物质坐标中给出为 $\\mathbf{x} = \\varphi(\\mathbf{X})=\\begin{bmatrix}\\lambda_{1} X_{1} \\\\ \\lambda_{2} X_{2} \\\\ \\lambda_{3} X_{3}\\end{bmatrix}$，其中 $\\lambda_{1},\\lambda_{2},\\lambda_{3}>0$ 是恒定的主拉伸。将此视为体现几何非线性的有限变形，按以下步骤进行。\n\n从变形梯度、右 Cauchy–Green 变形张量、Green–Lagrange 应变张量以及右极分解的定义出发，计算与 $\\varphi$ 相关的变形梯度 $F$、右 Cauchy–Green 张量 $C$ 和 Green–Lagrange 应变 $E$。然后对 $F$ 进行右极分解，即写出 $F=R U$，并确定右拉伸张量 $U$ 和旋转张量 $R$。\n\n作为您最终报告的答案，请提供 Jacobian 行列式 $J=\\det F$ 关于 $\\lambda_{1},\\lambda_{2},\\lambda_{3}$ 的精确符号表达式。将您的最终答案表示为一个闭式解析表达式。不包括单位。无需四舍五入。",
            "solution": "该问题陈述被评估为有效。它在科学上基于连续介质力学原理，问题设置完备，提供了所有必要信息，并且其表述是客观的。该问题要求将标准定义应用于有限变形的一个基本案例，使其成为一个合适且可解的问题。\n\n物体的运动由从物质（或参考）构型（坐标为 $\\mathbf{X} = (X_1, X_2, X_3)$）到空间（或当前）构型（坐标为 $\\mathbf{x} = (x_1, x_2, x_3)$）的映射 $\\varphi$ 描述。给定的运动是：\n$$\n\\mathbf{x} = \\varphi(\\mathbf{X}) = \\begin{bmatrix} \\lambda_{1} X_{1} \\\\ \\lambda_{2} X_{2} \\\\ \\lambda_{3} X_{3} \\end{bmatrix}\n$$\n其中 $\\lambda_1, \\lambda_2, \\lambda_3 > 0$ 是恒定的主拉伸。\n\n首先，我们计算变形梯度张量 $\\mathbf{F}$。它被定义为运动相对于物质坐标的梯度：\n$$\n\\mathbf{F} = \\frac{\\partial \\varphi}{\\partial \\mathbf{X}} = \\nabla_{\\mathbf{X}} \\varphi\n$$\n在其分量形式中，其元素为 $F_{ij} = \\frac{\\partial x_i}{\\partial X_j}$。我们计算这些分量：\n$F_{11} = \\frac{\\partial (\\lambda_1 X_1)}{\\partial X_1} = \\lambda_1$\n$F_{22} = \\frac{\\partial (\\lambda_2 X_2)}{\\partial X_2} = \\lambda_2$\n$F_{33} = \\frac{\\partial (\\lambda_3 X_3)}{\\partial X_3} = \\lambda_3$\n所有非对角分量均为零，例如，$F_{12} = \\frac{\\partial (\\lambda_1 X_1)}{\\partial X_2} = 0$。\n因此，变形梯度张量 $\\mathbf{F}$ 是一个对角矩阵：\n$$\n\\mathbf{F} = \\begin{bmatrix} \\lambda_1 & 0 & 0 \\\\ 0 & \\lambda_2 & 0 \\\\ 0 & 0 & \\lambda_3 \\end{bmatrix}\n$$\n\n接下来，我们计算右 Cauchy–Green 变形张量 $\\mathbf{C}$。其定义为：\n$$\n\\mathbf{C} = \\mathbf{F}^T \\mathbf{F}\n$$\n其中 $\\mathbf{F}^T$ 是 $\\mathbf{F}$ 的转置。由于 $\\mathbf{F}$ 是一个对角矩阵，所以它是对称的，因此 $\\mathbf{F}^T = \\mathbf{F}$。\n$$\n\\mathbf{C} = \\mathbf{F}^T \\mathbf{F} = \\mathbf{F} \\mathbf{F} = \\mathbf{F}^2 = \\begin{bmatrix} \\lambda_1 & 0 & 0 \\\\ 0 & \\lambda_2 & 0 \\\\ 0 & 0 & \\lambda_3 \\end{bmatrix} \\begin{bmatrix} \\lambda_1 & 0 & 0 \\\\ 0 & \\lambda_2 & 0 \\\\ 0 & 0 & \\lambda_3 \\end{bmatrix} = \\begin{bmatrix} \\lambda_1^2 & 0 & 0 \\\\ 0 & \\lambda_2^2 & 0 \\\\ 0 & 0 & \\lambda_3^2 \\end{bmatrix}\n$$\n\n然后，我们计算 Green–Lagrange 应变张量 $\\mathbf{E}$。它用 $\\mathbf{C}$ 和单位张量 $\\mathbf{I}$ 定义为：\n$$\n\\mathbf{E} = \\frac{1}{2}(\\mathbf{C} - \\mathbf{I})\n$$\n代入 $\\mathbf{C}$ 的表达式：\n$$\n\\mathbf{E} = \\frac{1}{2} \\left( \\begin{bmatrix} \\lambda_1^2 & 0 & 0 \\\\ 0 & \\lambda_2^2 & 0 \\\\ 0 & 0 & \\lambda_3^2 \\end{bmatrix} - \\begin{bmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{bmatrix} \\right) = \\frac{1}{2} \\begin{bmatrix} \\lambda_1^2 - 1 & 0 & 0 \\\\ 0 & \\lambda_2^2 - 1 & 0 \\\\ 0 & 0 & \\lambda_3^2 - 1 \\end{bmatrix}\n$$\n\n现在，我们对 $\\mathbf{F}$ 进行右极分解，该分解表明 $\\mathbf{F}$ 可以唯一地写为 $\\mathbf{F} = \\mathbf{R} \\mathbf{U}$，其中 $\\mathbf{R}$ 是一个正常正交张量（旋转张量），$\\mathbf{U}$ 是一个正定对称张量（右拉伸张量）。\n张量 $\\mathbf{U}$ 可以通过关系式 $\\mathbf{C} = \\mathbf{U}^2$ 从 $\\mathbf{C}$ 计算得出，这意味着 $\\mathbf{U} = \\sqrt{\\mathbf{C}}$。\n对于我们找到的对角张量 $\\mathbf{C}$，其主平方根是一个对角张量，其元素是 $\\mathbf{C}$ 对角元素的平方根。\n$$\n\\mathbf{U} = \\sqrt{\\mathbf{C}} = \\begin{bmatrix} \\sqrt{\\lambda_1^2} & 0 & 0 \\\\ 0 & \\sqrt{\\lambda_2^2} & 0 \\\\ 0 & 0 & \\sqrt{\\lambda_3^2} \\end{bmatrix}\n$$\n因为给定 $\\lambda_1, \\lambda_2, \\lambda_3 > 0$，我们有 $\\sqrt{\\lambda_i^2} = \\lambda_i$。\n$$\n\\mathbf{U} = \\begin{bmatrix} \\lambda_1 & 0 & 0 \\\\ 0 & \\lambda_2 & 0 \\\\ 0 & 0 & \\lambda_3 \\end{bmatrix}\n$$\n注意，在这种纯均匀拉伸的特殊情况下，$\\mathbf{U} = \\mathbf{F}$。这表明该变形是无旋的。\n\n旋转张量 $\\mathbf{R}$ 现在可以从分解式 $\\mathbf{F} = \\mathbf{R} \\mathbf{U}$ 中求出。由于为保证分解的唯一性，$\\mathbf{F}$ 必须是可逆的（$\\det \\mathbf{F} \\neq 0$），我们可以写出 $\\mathbf{R} = \\mathbf{F} \\mathbf{U}^{-1}$。\n代入我们求得的 $\\mathbf{F}$ 和 $\\mathbf{U}$：\n$$\n\\mathbf{R} = \\mathbf{F} \\mathbf{U}^{-1} = \\begin{bmatrix} \\lambda_1 & 0 & 0 \\\\ 0 & \\lambda_2 & 0 \\\\ 0 & 0 & \\lambda_3 \\end{bmatrix} \\begin{bmatrix} \\frac{1}{\\lambda_1} & 0 & 0 \\\\ 0 & \\frac{1}{\\lambda_2} & 0 \\\\ 0 & 0 & \\frac{1}{\\lambda_3} \\end{bmatrix} = \\begin{bmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{bmatrix} = \\mathbf{I}\n$$\n旋转张量是单位张量 $\\mathbf{I}$。这是一个有效的旋转张量，因为它是正交的（$\\mathbf{I}^T\\mathbf{I} = \\mathbf{I}$）并且行列式为 $+1$。这证实了给定的变形是无旋转的纯拉伸。\n\n最后，我们计算 Jacobian 行列式 $J = \\det \\mathbf{F}$。Jacobian 行列式度量了从参考构型到当前构型的体积变化。\n使用 $\\mathbf{F}$ 的矩阵：\n$$\n\\mathbf{F} = \\begin{bmatrix} \\lambda_1 & 0 & 0 \\\\ 0 & \\lambda_2 & 0 \\\\ 0 & 0 & \\lambda_3 \\end{bmatrix}\n$$\n对角矩阵的行列式是其对角元素的乘积。\n$$\nJ = \\det \\mathbf{F} = \\lambda_1 \\lambda_2 \\lambda_3\n$$\n这就是问题所要求的最终表达式。",
            "answer": "$$\n\\boxed{\\lambda_{1} \\lambda_{2} \\lambda_{3}}\n$$"
        },
        {
            "introduction": "在描述了物体的运动之后，下一步是正确计算其内部应力，这在大变形分析中至关重要。本实践聚焦于一个核心且精妙的概念：客观性或称框架无关性。通过一个计算实验，您将直观地看到，在一个纯刚体旋转下，朴素的应力更新算法会产生虚假的应力，而使用客观应力率（如 Jaumann 率）则能正确地保证应力不变，从而深刻理解在有限元程序中确保本构关系客观性的必要性。",
            "id": "3601342",
            "problem": "考虑一个二维刚体旋转，该旋转作用于一个扭曲的线性三角形有限元。该单元在参考构型中的节点坐标（单位：米）为 $\\mathbf{X}_1 = (0,0)$、$\\mathbf{X}_2 = (1.1,0.0)$ 和 $\\mathbf{X}_3 = (0.1,0.9)$。该运动是纯刚体旋转 $\\mathbf{x}(t) = \\mathbf{R}(t)\\,\\mathbf{X}$，其中 $\\mathbf{R}(t) \\in \\mathrm{SO}(2)$ 是一个真正常交旋转矩阵，由绕平面外轴的恒定角速度 $\\omega$ 定义。旋转角为 $\\theta(t) = \\omega t$（单位：弧度），旋转矩阵为\n$$\n\\mathbf{R}(t) = \n\\begin{bmatrix}\n\\cos\\theta(t) & -\\sin\\theta(t) \\\\\n\\sin\\theta(t) & \\cos\\theta(t)\n\\end{bmatrix}.\n$$\n令空间自旋（速度梯度的反对称部分）为 $\\mathbf{W} = \\dot{\\mathbf{R}}(t)\\mathbf{R}(t)^{\\mathrm{T}}$，对于恒定角速度，其形式为\n$$\n\\mathbf{W} =\n\\begin{bmatrix}\n0 & -\\omega \\\\\n\\omega & 0\n\\end{bmatrix}.\n$$\n在刚体旋转 $\\mathbf{x}(t)=\\mathbf{R}(t)\\mathbf{X}$ 下，变形梯度为 $\\mathbf{F}(t) = \\mathbf{R}(t)$，对称变形率张量为 $\\mathbf{D}(t) = \\frac{1}{2}\\left(\\mathbf{L} + \\mathbf{L}^{\\mathrm{T}}\\right) = \\mathbf{0}$，其中 $\\mathbf{L} = \\dot{\\mathbf{F}}\\mathbf{F}^{-1}$ 是速度梯度。因此，材料没有应变变化，任何物理上一致的本构更新都必须是客观的（框架无关的），这意味着它不应因刚体运动而引入虚假的应力变化。\n\n我们考虑单位为帕斯卡（Pascals）的柯西应力张量 $\\boldsymbol{\\sigma}(t)$。假设在 $t=0$ 时的初始柯西应力为\n$$\n\\boldsymbol{\\sigma}_0 = \n\\begin{bmatrix}\n1.20\\times 10^8 & 4.0\\times 10^7 \\\\\n4.0\\times 10^7 & 8.0\\times 10^7\n\\end{bmatrix}\\ \\text{Pa}.\n$$\n我们在给定的刚体旋转下比较两种应力更新算法：\n1. 一种非客观的朴素更新方法，该方法错误地将物质时间导数设为零，即 $\\dot{\\boldsymbol{\\sigma}} = \\mathbf{0}$，从而在空间框架中得到 $\\boldsymbol{\\sigma}(t) \\equiv \\boldsymbol{\\sigma}_0$。\n2. 一种使用柯西应力的 Jaumann 率的客观更新方法，其定义为\n$$\n\\overset{\\nabla}{\\boldsymbol{\\sigma}} = \\dot{\\boldsymbol{\\sigma}} - \\mathbf{W}\\boldsymbol{\\sigma} + \\boldsymbol{\\sigma}\\mathbf{W} = \\mathbb{C}:\\mathbf{D}。\n$$\n在纯旋转下 $\\mathbf{D}=\\mathbf{0}$，因此 $\\overset{\\nabla}{\\boldsymbol{\\sigma}}=\\mathbf{0}$，演化定律简化为\n$$\n\\dot{\\boldsymbol{\\sigma}} = \\mathbf{W}\\boldsymbol{\\sigma} - \\boldsymbol{\\sigma}\\mathbf{W}。\n$$\n对于刚体旋转，精确的、满足客观性要求的解是\n$$\n\\boldsymbol{\\sigma}_{\\text{exact}}(t) = \\mathbf{R}(t)\\,\\boldsymbol{\\sigma}_0\\,\\mathbf{R}(t)^{\\mathrm{T}}。\n$$\n为对 Jaumann 演化方程进行数值积分，使用步长为 $\\Delta t$ 的显式欧拉时间步进法，即\n$$\n\\boldsymbol{\\sigma}_{n+1} = \\boldsymbol{\\sigma}_n + \\Delta t\\left(\\mathbf{W}\\boldsymbol{\\sigma}_n - \\boldsymbol{\\sigma}_n\\mathbf{W}\\right)。\n$$\n\n你的程序必须：\n- 根据给定的角速度构建刚体旋转和自旋。\n- 对于每个测试用例，计算最终时间 $T$、总旋转角度 $\\theta(T) = \\omega T$ 和精确的旋转后应力 $\\boldsymbol{\\sigma}_{\\text{exact}}(T)$。\n- 使用非客观的朴素更新和客观的 Jaumann 更新（采用指定时间步长的显式欧拉法），将应力从 $\\boldsymbol{\\sigma}_0$ 演化到时间 $T$。\n- 将算法误差量化为算法计算得到的最终应力与时间 $T$ 时精确的旋转后应力之差的 Frobenius 范数：\n$$\ne = \\left\\|\\boldsymbol{\\sigma}_{\\text{alg}}(T) - \\boldsymbol{\\sigma}_{\\text{exact}}(T)\\right\\|_{\\mathrm{F}} = \\sqrt{\\mathrm{trace}\\left(\\left(\\boldsymbol{\\sigma}_{\\text{alg}}(T) - \\boldsymbol{\\sigma}_{\\text{exact}}(T)\\right)^{\\mathrm{T}}\\left(\\boldsymbol{\\sigma}_{\\text{alg}}(T) - \\boldsymbol{\\sigma}_{\\text{exact}}(T)\\right)\\right)}。\n$$\n- 通过计算在时间 $t$ 时扭曲线性三角形的离散变形梯度，在单元层面独立验证几何客观性，公式如下\n$$\n\\mathbf{F}_{\\triangle}(t) = \\left[\\mathbf{x}_2(t) - \\mathbf{x}_1(t)\\ \\ \\ \\mathbf{x}_3(t) - \\mathbf{x}_1(t)\\right]\\left[\\mathbf{X}_2 - \\mathbf{X}_1\\ \\ \\ \\mathbf{X}_3 - \\mathbf{X}_1\\right]^{-1}，\n$$\n并确认对于所有测试用例，$\\mathbf{F}_{\\triangle}(t)$ 在数值容差范围内等于 $\\mathbf{R}(t)$。此项检查必须在内部执行，且不得影响输出格式。\n\n物理单位和数值要求：\n- 坐标单位为米，时间单位为秒，角速度单位为弧度/秒，所有应力和误差必须以帕斯卡表示。\n- 角度必须以弧度为单位。\n- 使用以下涵盖一般情况、边界条件和边缘情况的测试套件：\n    1. $(\\omega, T, \\Delta t) = \\left(\\frac{\\pi}{2}, 1.0, 1.0\\times 10^{-3}\\right)$。\n    2. $(\\omega, T, \\Delta t) = \\left(0.0, 1.0, 1.0\\times 10^{-3}\\right)$。\n    3. $(\\omega, T, \\Delta t) = \\left(\\pi, 1.0, 1.0\\times 10^{-1}\\right)$。\n    4. $(\\omega, T, \\Delta t) = \\left(2\\pi, 1.0, 1.0\\times 10^{-3}\\right)$。\n- 对于每个测试用例，计算两个误差：朴素非客观误差和 Jaumann 客观误差，单位均为帕斯卡。\n\n最终输出格式：\n- 你的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表。该列表必须包含八个浮点数（单位：帕斯卡），顺序为 $[e_{\\text{naive},1}, e_{\\text{Jaumann},1}, e_{\\text{naive},2}, e_{\\text{Jaumann},2}, e_{\\text{naive},3}, e_{\\text{Jaumann},3}, e_{\\text{naive},4}, e_{\\text{Jaumann},4}]$。\n\n你的实现必须完全自包含，不得读取任何输入，并必须遵守指定的执行环境。所有数值计算都必须使用双精度浮点算术执行。",
            "solution": "提交分析的问题陈述被认为是有效的。它在科学上基于连续介质力学的原理，特别是关于材料框架无关性（客观性）的概念。该问题是适定的，提供了计算唯一且有意义的数值结果所需的所有数据和方程。所使用的语言是客观且数学上精确的。任务是在纯刚体旋转下比较两种应力更新算法，这是计算固体力学中一个标准且具有说明性的问题，旨在强调客观应力率的必要性。\n\n其核心原理是客观性，该原理要求本构律——即应力与应变之间的数学关系——必须独立于观察者的参考系。一个直接的推论是，纯刚体运动不涉及变形或材料状态的变化，因此当从与材料共同旋转的参考系中观察时，不应引起任何应力变化。\n\n该运动是纯刚体旋转，由 $\\mathbf{x}(t) = \\mathbf{R}(t)\\mathbf{X}$ 给出，其中 $\\mathbf{x}$ 是当前位置，$\\mathbf{X}$ 是参考位置，$\\mathbf{R}(t)$ 是一个真正交旋转矩阵。此运动的变形梯度为 $\\mathbf{F} = \\partial\\mathbf{x}/\\partial\\mathbf{X} = \\mathbf{R}(t)$。变形率张量 $\\mathbf{D}$ 用于衡量材料拉伸，是速度梯度 $\\mathbf{L} = \\dot{\\mathbf{F}}\\mathbf{F}^{-1}$ 的对称部分。对于此运动，$\\mathbf{L} = \\dot{\\mathbf{R}}\\mathbf{R}^{\\mathrm{T}} = \\mathbf{W}$，其中 $\\mathbf{W}$ 是反对称自旋张量。因此，变形率为 $\\mathbf{D} = \\frac{1}{2}(\\mathbf{L} + \\mathbf{L}^{\\mathrm{T}}) = \\frac{1}{2}(\\mathbf{W} + \\mathbf{W}^{\\mathrm{T}}) = \\mathbf{0}$，这证实了没有发生物理变形。\n\n一个客观的本构模型在 $\\mathbf{D}=\\mathbf{0}$ 时必须预测零应力产生。我们将根据这一原则评估两种应力更新方案。\n\n**1. 精确的客观解**\n在刚体旋转 $\\mathbf{R}$ 下，对柯西应力张量 $\\boldsymbol{\\sigma}$ 进行的正确的、客观的变换是初始应力 $\\boldsymbol{\\sigma}_0$ 的前推操作。柯西应力张量在空间构型中是一个 (2,0) 型张量，其分量随坐标系方向的改变而改变。客观更新由以下公式给出：\n$$\n\\boldsymbol{\\sigma}_{\\text{exact}}(t) = \\mathbf{R}(t)\\,\\boldsymbol{\\sigma}_0\\,\\mathbf{R}(t)^{\\mathrm{T}}\n$$\n此公式提供了基准真相（ground truth），我们将用它来衡量数值算法的误差。矩阵 $\\mathbf{R}(t)$ 是使用给定时间 $t$ 的总旋转角 $\\theta(t) = \\omega t$ 构建的。\n\n**2. 非客观的朴素更新**\n该算法错误地假设柯西应力张量的物质时间导数为零，即 $\\dot{\\boldsymbol{\\sigma}} = \\mathbf{0}$。这导致了平凡解 $\\boldsymbol{\\sigma}(t) \\equiv \\boldsymbol{\\sigma}_0$。这种方法是非客观的，因为它未能解释 $\\boldsymbol{\\sigma}$ 分量所处空间基向量的旋转。它将应力张量的分量视为标量，而实际上它们不是。对于任何非平凡的旋转，由此产生的误差 $e_{\\text{naive}} = \\|\\boldsymbol{\\sigma}_0 - \\boldsymbol{\\sigma}_{\\text{exact}}(T)\\|_{\\mathrm{F}}$ 预计会非常显著。\n\n**3. 客观的 Jaumann 率更新**\n为确保客观性，连续介质力学采用了客观应力率。柯西应力的 Jaumann 率（或称共旋率）就是这样一种率，其定义为：\n$$\n\\overset{\\nabla}{\\boldsymbol{\\sigma}} = \\dot{\\boldsymbol{\\sigma}} - \\mathbf{W}\\boldsymbol{\\sigma} + \\boldsymbol{\\sigma}\\mathbf{W}\n$$\n本构律正确地以这种客观率表示，例如 $\\overset{\\nabla}{\\boldsymbol{\\sigma}} = \\mathbb{C}:\\mathbf{D}$。由于对于刚体旋转 $\\mathbf{D}=\\mathbf{0}$，本构更新变为 $\\overset{\\nabla}{\\boldsymbol{\\sigma}}=\\mathbf{0}$。这得到了描述空间应力分量演化的常微分方程：\n$$\n\\dot{\\boldsymbol{\\sigma}} = \\mathbf{W}\\boldsymbol{\\sigma} - \\boldsymbol{\\sigma}\\mathbf{W}\n$$\n这个常微分方程正确地描述了由于纯材料自旋，$\\boldsymbol{\\sigma}$ 的分量在固定的空间框架中如何变化。问题要求使用时间步长为 $\\Delta t$ 的显式（前向）欧拉法对该常微分方程进行数值求解：\n$$\n\\boldsymbol{\\sigma}_{n+1} = \\boldsymbol{\\sigma}_n + \\Delta t\\left(\\mathbf{W}\\boldsymbol{\\sigma}_n - \\boldsymbol{\\sigma}_n\\mathbf{W}\\right)\n$$\n其中 $\\boldsymbol{\\sigma}_n$ 是在时间 $t_n$ 的应力。这种数值积分会引入离散化误差，这是 $e_{\\text{Jaumann}}$ 的来源。预计该误差将远小于 $e_{\\text{naive}}$，并且会随着时间步长 $\\Delta t$ 的减小而减小，因为它纯粹是数值计算的产物，而不是模型中的根本缺陷。\n\n**使用有限元进行内部验证**\n问题包含了线性三角形单元的节点坐标。这种单元的变形梯度可以离散地计算。验证步骤 $\\mathbf{F}_{\\triangle}(t) = \\mathbf{R}(t)$ 确认了离散单元的运动学正确地再现了连续介质层面的刚体旋转。这是有限元背景下的一项基本一致性检查，用以确认单元在刚体运动下不会产生虚假应变（这一性质被称为通过刚体模态的“patch test”）。\n\n**方法论**\n对于由 $(\\omega, T, \\Delta t)$ 定义的每个测试用例：\n1.  定义初始应力 $\\boldsymbol{\\sigma}_0$ 和恒定的自旋张量 $\\mathbf{W}$。\n2.  计算最终旋转角 $\\theta(T) = \\omega T$ 和相应的旋转矩阵 $\\mathbf{R}(T)$。\n3.  计算精确的最终应力 $\\boldsymbol{\\sigma}_{\\text{exact}}(T) = \\mathbf{R}(T)\\,\\boldsymbol{\\sigma}_0\\,\\mathbf{R}(T)^{\\mathrm{T}}$。\n4.  朴素更新的最终应力即为 $\\boldsymbol{\\sigma}_{\\text{naive}}(T) = \\boldsymbol{\\sigma}_0$。\n5.  使用 Jaumann 率方程的显式欧拉积分，经过 $N = T/\\Delta t$ 个步骤，将应力从 $\\boldsymbol{\\sigma}_0$ 演化到 $T$，以求得 $\\boldsymbol{\\sigma}_{\\text{Jaumann}}(T)$。\n6.  通过计算算法得到的最终应力与精确最终应力之差的 Frobenius 范数，来计算算法误差 $e_{\\text{naive}}$ 和 $e_{\\text{Jaumann}}$。\n\n结果将展示非客观更新的严重失效，以及客观 Jaumann 率更新的准确性（在数值积分误差范围内）。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes algorithmic errors for non-objective and objective stress updates\n    under rigid body rotation.\n    \"\"\"\n    # Initial conditions as problem statement.\n    # Initial Cauchy stress in Pascals.\n    sigma_0 = np.array([[1.20e8, 4.0e7], [4.0e7, 8.0e7]], dtype=np.float64)\n    \n    # Nodal coordinates for the linear triangle in meters.\n    X1 = np.array([0.0, 0.0], dtype=np.float64)\n    X2 = np.array([1.1, 0.0], dtype=np.float64)\n    X3 = np.array([0.1, 0.9], dtype=np.float64)\n    \n    # Reference edge vector matrix and its inverse for F_triangle calculation.\n    M_ref = np.column_stack((X2 - X1, X3 - X1))\n    M_ref_inv = np.linalg.inv(M_ref)\n\n    # Test cases: (angular velocity omega, final time T, time step dt)\n    test_cases = [\n        (np.pi / 2.0, 1.0, 1.0e-3),\n        (0.0, 1.0, 1.0e-3),\n        (np.pi, 1.0, 1.0e-1),\n        (2.0 * np.pi, 1.0, 1.0e-3),\n    ]\n\n    # List to store the computed errors.\n    results = []\n    \n    for case in test_cases:\n        omega, T, dt = case\n        \n        # --- Kinematics ---\n        # Final rotation angle in radians.\n        theta = omega * T\n        c, s = np.cos(theta), np.sin(theta)\n        # Final rotation matrix.\n        R = np.array([[c, -s], [s, c]], dtype=np.float64)\n        # Spatial spin tensor.\n        W = np.array([[0.0, -omega], [omega, 0.0]], dtype=np.float64)\n\n        # --- Exact Solution ---\n        # The exact, objective stress at the final time T.\n        sigma_exact_T = R @ sigma_0 @ R.T\n\n        # --- Internal Verification: Discrete Deformation Gradient ---\n        # This check verifies that the finite element kinematics correctly\n        # represent the rigid body rotation, such that F_triangle = R.\n        # It is required by the problem but does not affect the final output.\n        x1 = R @ X1\n        x2 = R @ X2\n        x3 = R @ X3\n        M_cur = np.column_stack((x2 - x1, x3 - x1))\n        F_triangle = M_cur @ M_ref_inv\n        if not np.allclose(F_triangle, R):\n            # This assertion validates the problem's kinematic assumptions.\n            raise RuntimeError(f\"Internal verification of F_triangle failed for omega={omega}\")\n\n        # --- Algorithm 1: Non-objective Naive Update ---\n        # The stress is incorrectly assumed to be constant in the spatial frame.\n        sigma_naive_T = sigma_0\n        # Calculate the Frobenius norm of the error.\n        error_naive = np.linalg.norm(sigma_naive_T - sigma_exact_T, 'fro')\n        \n        # --- Algorithm 2: Objective Jaumann Update via Explicit Euler ---\n        # Initialize stress for the time integration.\n        sigma_jaumann_n = np.copy(sigma_0)\n        \n        # Determine the number of integration steps.\n        # Using round() to handle potential floating point inaccuracies in T/dt.\n        num_steps = int(round(T / dt))\n        \n        # Perform time integration if there is any motion and time evolution.\n        if num_steps > 0:\n            for _ in range(num_steps):\n                # Calculate the increment using the Jaumann rate ODE.\n                d_sigma = W @ sigma_jaumann_n - sigma_jaumann_n @ W\n                # Apply the explicit Euler update.\n                sigma_jaumann_n += dt * d_sigma\n        \n        # The final stress from the Jaumann update.\n        sigma_jaumann_T = sigma_jaumann_n\n        # Calculate the Frobenius norm of the error.\n        error_jaumann = np.linalg.norm(sigma_jaumann_T - sigma_exact_T, 'fro')\n\n        # Append the two errors for the current test case to the results list.\n        results.extend([error_naive, error_jaumann])\n        \n    # Print the final list of eight error values in the specified format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        },
        {
            "introduction": "现在，我们将注意力从几何非线性转向另一种主要的非线性来源：材料非线性，其中弹塑性是最典型的例子。对于隐式有限元分析，我们不仅需要一个能够准确更新应力状态的算法（即“返回映射”），还需要计算其一致线性化（即“算法切线模量”）以确保全局求解过程的二次收敛性。本练习将指导您完成一个一维弹塑性模型的这一基本推导过程，揭示高级材料本构在计算中实现的核心逻辑。",
            "id": "3601269",
            "problem": "考虑一根承受单调递增拉伸变形的一维小应变杆，在有限元法 (FEM) 框架内，使用标准的率无关伴随弹塑性本构律和线性各向同性硬化进行建模。材料行为由以下几个部分定义：\n\n- 应变加法分解 $\\varepsilon = \\varepsilon^{\\mathrm{e}} + \\varepsilon^{\\mathrm{p}}$。\n- 二次弹性亥姆霍兹自由能 $\\psi(\\varepsilon^{\\mathrm{e}}) = \\tfrac{1}{2} E \\left(\\varepsilon^{\\mathrm{e}}\\right)^{2}$，其中 $E$ 是杨氏模量。\n- 柯西应力 $\\sigma$ 遵循 $\\sigma = \\frac{\\partial \\psi}{\\partial \\varepsilon^{\\mathrm{e}}} = E \\left(\\varepsilon - \\varepsilon^{\\mathrm{p}}\\right)$。\n- 伴随屈服函数 $f(\\sigma,\\alpha) = |\\sigma| - \\sigma_{y0} - H \\alpha$，其中 $\\sigma_{y0} > 0$ 是初始屈服应力，$H \\ge 0$ 是各向同性硬化模量，$\\alpha$ 是由 $\\dot{\\alpha} = |\\dot{\\varepsilon}^{\\mathrm{p}}|$ 定义的等效塑性应变。\n- 与伴随塑性一致的正交性和互补条件：$\\dot{\\varepsilon}^{\\mathrm{p}} = \\dot{\\gamma} \\, \\partial f / \\partial \\sigma$, $\\dot{\\gamma} \\ge 0$, $f \\le 0$, $\\dot{\\gamma} f = 0$。\n\n假设加载过程保持严格拉伸，因此 $\\sigma \\ge 0$ 且流动方向为正。考虑从 $t_{n}$ 到 $t_{n+1}$ 的单个隐式时间增量步，给定总应变为 $\\varepsilon_{n+1}$。设 $t_{n}$ 时刻的内变量为 $\\varepsilon^{\\mathrm{p}}_{n}$ 和 $\\alpha_{n}$。定义弹性试探应力 $\\sigma_{\\mathrm{tr}} = E \\left(\\varepsilon_{n+1} - \\varepsilon^{\\mathrm{p}}_{n}\\right)$ 和试探屈服值 $f_{\\mathrm{tr}} = \\sigma_{\\mathrm{tr}} - \\sigma_{y0} - H \\alpha_{n}$。\n\n假设该增量步是塑性激活的，即 $f_{\\mathrm{tr}} > 0$。从上述基本定义和条件出发，完成以下任务：\n\n1. 使用适用于隐式有限元法的无条件稳定格式对内变量的演化进行离散化，并为塑性乘子增量 $\\Delta \\gamma$ 建立相应的离散系统。\n2. 对于拉伸加载下塑性激活的情况 ($f_{\\mathrm{tr}} > 0$)，推导用 $\\varepsilon_{n+1}$, $\\varepsilon^{\\mathrm{p}}_{n}$, $\\alpha_{n}$, $E$, $H$ 和 $\\sigma_{y0}$ 表示的算法应力更新 $\\sigma_{n+1}$。\n3. 计算隐式有限元法中全局平衡方程的 Newton–Raphson 解法所需的一致切线算子，即，在拉伸加载下的塑性激活情况下，计算 $\\dfrac{\\mathrm{d} \\sigma_{n+1}}{\\mathrm{d} \\varepsilon_{n+1}}$。\n\n请以 $E$ 和 $H$ 表示的一致切线模量的单个闭式解析表达式的形式给出最终结果。不需要进行数值计算，最终表达式中也不应包含物理单位。",
            "solution": "该问题陈述经核实具有科学依据、适定且客观。它提出了一个计算弹塑性力学中的标准问题。我们开始进行求解。\n\n该问题要求在有限元法 (FEM) 框架下，为经历塑性变形的一维杆推导应力更新和一致切线模量。该模型是具有线性各向同性硬化的率无关伴随弹塑性模型。给定的是单调递增的拉伸加载情况，这意味着应力 $\\sigma$ 是非负的，即 $\\sigma \\ge 0$。\n\n首先，我们根据拉伸加载条件简化屈服函数和流动法则。屈服函数为 $f(\\sigma, \\alpha) = |\\sigma| - \\sigma_{y0} - H \\alpha$。由于 $\\sigma \\ge 0$，该函数变为 $f(\\sigma, \\alpha) = \\sigma - \\sigma_{y0} - H \\alpha$。\n塑性应变的流动法则是 $\\dot{\\varepsilon}^{\\mathrm{p}} = \\dot{\\gamma} \\frac{\\partial f}{\\partial \\sigma}$。其梯度为 $\\frac{\\partial f}{\\partial \\sigma} = \\frac{\\partial}{\\partial \\sigma}(\\sigma - \\sigma_{y0} - H \\alpha) = 1$。\n因此，流动法则简化为 $\\dot{\\varepsilon}^{\\mathrm{p}} = \\dot{\\gamma}$。\n硬化法则是 $\\dot{\\alpha} = |\\dot{\\varepsilon}^{\\mathrm{p}}|$。代入 $\\dot{\\varepsilon}^{\\mathrm{p}} = \\dot{\\gamma}$ 并且已知塑性乘子率 $\\dot{\\gamma}$ 是非负的（$\\dot{\\gamma} \\ge 0$），我们得到 $\\dot{\\alpha} = |\\dot{\\gamma}| = \\dot{\\gamma}$。\n\n该问题要求针对从时间 $t_n$ 到 $t_{n+1}$ 的单个隐式时间增量步建立离散格式。我们将采用无条件稳定的后向欧拉法来对内变量 $\\varepsilon^{\\mathrm{p}}$ 和 $\\alpha$ 的演化方程进行积分。\n\n演化方程的后向欧拉离散化为：\n$$ \\varepsilon^{\\mathrm{p}}_{n+1} = \\varepsilon^{\\mathrm{p}}_{n} + \\Delta \\varepsilon^{\\mathrm{p}} = \\varepsilon^{\\mathrm{p}}_{n} + \\Delta\\gamma \\left. \\frac{\\partial f}{\\partial \\sigma} \\right|_{n+1} $$\n$$ \\alpha_{n+1} = \\alpha_{n} + \\Delta\\alpha = \\alpha_{n} + \\Delta\\gamma $$\n其中 $\\Delta\\gamma = \\int_{t_n}^{t_{n+1}} \\dot{\\gamma} \\, \\mathrm{d}t$ 是塑性乘子的增量。由于 $\\left. \\frac{\\partial f}{\\partial \\sigma} \\right|_{n+1} = 1$，塑性应变的更新变为：\n$$ \\varepsilon^{\\mathrm{p}}_{n+1} = \\varepsilon^{\\mathrm{p}}_{n} + \\Delta\\gamma $$\n\n假设该增量步是塑性激活的，意味着在初始弹性试探步后，屈服条件被违反 ($f_{\\mathrm{tr}} > 0$)。这表示在该增量步内发生了塑性流动，并且在增量步结束时，状态必须位于屈服面上。这通过离散一致性条件来表达：\n$$ f_{n+1} = f(\\sigma_{n+1}, \\alpha_{n+1}) = 0 $$\n代入简化的屈服函数，我们有：\n$$ \\sigma_{n+1} - \\sigma_{y0} - H \\alpha_{n+1} = 0 $$\n\n现在我们用增量 $\\Delta\\gamma$ 和已知量来表示 $\\sigma_{n+1}$ 和 $\\alpha_{n+1}$。\n$t_{n+1}$ 时刻的应力由本构律给出：\n$$ \\sigma_{n+1} = E (\\varepsilon_{n+1} - \\varepsilon^{\\mathrm{p}}_{n+1}) $$\n代入 $\\varepsilon^{\\mathrm{p}}_{n+1}$ 的更新表达式：\n$$ \\sigma_{n+1} = E (\\varepsilon_{n+1} - (\\varepsilon^{\\mathrm{p}}_{n} + \\Delta\\gamma)) = E (\\varepsilon_{n+1} - \\varepsilon^{\\mathrm{p}}_{n}) - E \\Delta\\gamma $$\n项 $E (\\varepsilon_{n+1} - \\varepsilon^{\\mathrm{p}}_{n})$ 被定义为试探应力 $\\sigma_{\\mathrm{tr}}$。所以，\n$$ \\sigma_{n+1} = \\sigma_{\\mathrm{tr}} - E \\Delta\\gamma $$\n更新后的硬化变量为：\n$$ \\alpha_{n+1} = \\alpha_{n} + \\Delta\\gamma $$\n\n现在我们可以将 $\\sigma_{n+1}$ 和 $\\alpha_{n+1}$ 的这些表达式代入离散一致性条件 $f_{n+1} = 0$ 中：\n$$ (\\sigma_{\\mathrm{tr}} - E \\Delta\\gamma) - \\sigma_{y0} - H (\\alpha_{n} + \\Delta\\gamma) = 0 $$\n重新整理各项以求解 $\\Delta\\gamma$，这就完成了任务1：\n$$ (\\sigma_{\\mathrm{tr}} - \\sigma_{y0} - H \\alpha_{n}) - E \\Delta\\gamma - H \\Delta\\gamma = 0 $$\n括号中的项是试探屈服值 $f_{\\mathrm{tr}} = \\sigma_{\\mathrm{tr}} - \\sigma_{y0} - H \\alpha_{n}$。方程变为：\n$$ f_{\\mathrm{tr}} - (E+H) \\Delta\\gamma = 0 $$\n对于塑性步，我们假设了 $f_{\\mathrm{tr}} > 0$。由于 $E>0$ 且 $H \\ge 0$，和 $E+H$ 是正的。我们可以解出 $\\Delta\\gamma$：\n$$ \\Delta\\gamma = \\frac{f_{\\mathrm{tr}}}{E+H} $$\n这证实了 $\\Delta\\gamma > 0$，与塑性激活加载一致。\n\n对于任务2，我们推导算法应力更新 $\\sigma_{n+1}$。我们将 $\\Delta\\gamma$ 的表达式代回到 $\\sigma_{n+1}$ 的方程中：\n$$ \\sigma_{n+1} = \\sigma_{\\mathrm{tr}} - E \\Delta\\gamma = \\sigma_{\\mathrm{tr}} - E \\left( \\frac{f_{\\mathrm{tr}}}{E+H} \\right) $$\n代入 $f_{\\mathrm{tr}}$ 的定义：\n$$ \\sigma_{n+1} = \\sigma_{\\mathrm{tr}} - \\frac{E}{E+H} (\\sigma_{\\mathrm{tr}} - \\sigma_{y0} - H \\alpha_{n}) $$\n这个表达式代表了“返回映射”算法，它将试探应力状态投影回更新后的屈服面上。这个表达式可用于任务3，但为了完整性，我们也可以将其展开：\n$$ \\sigma_{n+1} = \\sigma_{\\mathrm{tr}} \\left( 1 - \\frac{E}{E+H} \\right) + \\frac{E}{E+H} (\\sigma_{y0} + H \\alpha_{n}) = \\frac{H}{E+H}\\sigma_{\\mathrm{tr}} + \\frac{E}{E+H}(\\sigma_{y0} + H\\alpha_{n}) $$\n代入 $\\sigma_{\\mathrm{tr}} = E(\\varepsilon_{n+1} - \\varepsilon^{\\mathrm{p}}_{n})$ 给出完整的依赖关系：\n$$ \\sigma_{n+1} = \\frac{H E}{E+H}(\\varepsilon_{n+1} - \\varepsilon^{\\mathrm{p}}_{n}) + \\frac{E}{E+H}(\\sigma_{y0} + H\\alpha_{n}) $$\n\n对于任务3，我们计算一致切线算子（在一维情况下为模量），也就是更新后的应力 $\\sigma_{n+1}$ 相对于总应变 $\\varepsilon_{n+1}$ 的导数。\n$$ \\frac{\\mathrm{d} \\sigma_{n+1}}{\\mathrm{d} \\varepsilon_{n+1}} $$\n我们对任务2中推导出的 $\\sigma_{n+1}$ 表达式求导。最方便的起始形式是：\n$$ \\sigma_{n+1} = \\sigma_{\\mathrm{tr}} - \\frac{E}{E+H} (\\sigma_{\\mathrm{tr}} - \\sigma_{y0} - H \\alpha_{n}) $$\n变量 $\\varepsilon^{\\mathrm{p}}_{n}$ 和 $\\alpha_{n}$ 是增量步开始时的历史值，因此相对于 $\\varepsilon_{n+1}$ 是常数。材料参数 $E$、$H$ 和 $\\sigma_{y0}$ 也是常数。唯一依赖于 $\\varepsilon_{n+1}$ 的项是试探应力 $\\sigma_{\\mathrm{tr}} = E(\\varepsilon_{n+1} - \\varepsilon^{\\mathrm{p}}_{n})$。\n试探应力的导数是：\n$$ \\frac{\\mathrm{d} \\sigma_{\\mathrm{tr}}}{\\mathrm{d} \\varepsilon_{n+1}} = \\frac{\\mathrm{d}}{\\mathrm{d} \\varepsilon_{n+1}} [E(\\varepsilon_{n+1} - \\varepsilon^{\\mathrm{p}}_{n})] = E $$\n现在，我们对 $\\sigma_{n+1}$ 的表达式应用链式法则：\n$$ \\frac{\\mathrm{d} \\sigma_{n+1}}{\\mathrm{d} \\varepsilon_{n+1}} = \\frac{\\mathrm{d} \\sigma_{\\mathrm{tr}}}{\\mathrm{d} \\varepsilon_{n+1}} - \\frac{E}{E+H} \\frac{\\mathrm{d}}{\\mathrm{d} \\varepsilon_{n+1}} (\\sigma_{\\mathrm{tr}} - \\sigma_{y0} - H \\alpha_{n}) $$\n$$ \\frac{\\mathrm{d} \\sigma_{n+1}}{\\mathrm{d} \\varepsilon_{n+1}} = \\frac{\\mathrm{d} \\sigma_{\\mathrm{tr}}}{\\mathrm{d} \\varepsilon_{n+1}} - \\frac{E}{E+H} \\frac{\\mathrm{d} \\sigma_{\\mathrm{tr}}}{\\mathrm{d} \\varepsilon_{n+1}} $$\n代入 $\\frac{\\mathrm{d} \\sigma_{\\mathrm{tr}}}{\\mathrm{d} \\varepsilon_{n+1}} = E$：\n$$ \\frac{\\mathrm{d} \\sigma_{n+1}}{\\mathrm{d} \\varepsilon_{n+1}} = E - \\frac{E}{E+H} (E) = E \\left( 1 - \\frac{E}{E+H} \\right) $$\n简化括号中的表达式：\n$$ \\frac{\\mathrm{d} \\sigma_{n+1}}{\\mathrm{d} \\varepsilon_{n+1}} = E \\left( \\frac{E+H-E}{E+H} \\right) = E \\left( \\frac{H}{E+H} \\right) $$\n因此，塑性激活步的一致切线模量为：\n$$ \\frac{\\mathrm{d} \\sigma_{n+1}}{\\mathrm{d} \\varepsilon_{n+1}} = \\frac{EH}{E+H} $$\n这个结果是弹性模量 $E$ 和塑性（硬化）模量 $H$ 的调和平均值。\n如果材料是理想塑性的（$H=0$），则切线模量为 $0$。如果没有塑性变形（等效于 $H \\to \\infty$），切线模量正确地恢复为弹性模量 $E$。",
            "answer": "$$\\boxed{\\frac{EH}{E+H}}$$"
        }
    ]
}