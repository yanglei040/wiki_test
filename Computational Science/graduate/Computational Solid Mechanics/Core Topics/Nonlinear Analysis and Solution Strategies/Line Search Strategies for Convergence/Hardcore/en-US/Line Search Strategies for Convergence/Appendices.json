{
    "hands_on_practices": [
        {
            "introduction": "A line search algorithm's primary goal is to find an appropriate step length $\\alpha$ along a given search direction $p^k$. However, the success of the entire procedure hinges on the quality of that direction. In this exercise, we address a foundational challenge in nonlinear mechanics: what to do when the tangent stiffness matrix $K$ is indefinite, a common occurrence near structural instabilities . By exploring a spectral modification technique, you will learn how to construct a search direction that is guaranteed to be a descent direction, satisfying the essential condition $\\nabla \\phi(u^k)^T p^k  0$ and enabling the line search to proceed toward a minimum.",
            "id": "3577649",
            "problem": "Consider a nonlinear solid undergoing finite deformation where the total potential energy is denoted by $\\phi(u)$, with $u \\in \\mathbb{R}^{2}$ representing the nodal displacement vector. The principle of minimum total potential energy states that the equilibrium configuration minimizes $\\phi(u)$, so that at equilibrium the gradient $\\nabla \\phi(u)$ vanishes. In a computational setting, one seeks $u$ such that $\\nabla \\phi(u) = 0$ by iterative updates $u^{k+1} = u^{k} + s^{k}$, where $s^{k} = \\alpha p^{k}$ combines a search direction $p^{k}$ and a line search step length $\\alpha  0$. A direction $p^{k}$ is called a descent direction if $\\nabla \\phi(u^{k})^{\\top} p^{k}  0$, which is a sufficient local condition for a line search to produce a decrease in $\\phi$, thereby contributing to convergence.\n\nAt the current iterate $u^{k}$, let the residual be $r = \\nabla \\phi(u^{k})$ and the tangent stiffness (the Hessian of $\\phi$) be $K = \\nabla^{2} \\phi(u^{k})$. In problems exhibiting geometric nonlinearity or material nonconvexity, $K$ may be indefinite. Suppose at $u^{k}$ one has\n$$\nK = \\begin{pmatrix}\n2  1 \\\\\n1  -1\n\\end{pmatrix}, \\quad r = \\begin{pmatrix}\n1 \\\\\n2\n\\end{pmatrix},\n$$\nso that $K$ has exactly one negative eigenvalue.\n\nStarting from the definitions above and the fundamental principle that a descent direction must satisfy $\\nabla \\phi(u^{k})^{\\top} p^{k}  0$, derive a modification of the curvature information in $K$ that yields a search direction $p^{k}$ guaranteeing descent at $u^{k}$. Justify the modification using properties of symmetric matrices and quadratic forms, and determine conditions on any auxiliary parameters you introduce to ensure the guarantee holds. Then, using your constructed $p^{k}$, compute the update step $s^{k} = \\alpha p^{k}$ for a chosen line search parameter $\\alpha = \\frac{1}{5}$. Express the final step $s^{k}$ as a $1 \\times 2$ row matrix. No rounding is necessary; provide exact values.",
            "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, and objective.\n\n**Problem Validation**\n\n**Step 1: Extract Givens**\n- The total potential energy is a function $\\phi(u)$, where $u \\in \\mathbb{R}^{2}$ is the nodal displacement vector.\n- The equilibrium condition is $\\nabla \\phi(u) = 0$.\n- The iterative update scheme is $u^{k+1} = u^{k} + s^{k}$.\n- The update step is $s^{k} = \\alpha p^{k}$, where $\\alpha  0$ is the line search step length and $p^{k}$ is the search direction.\n- A descent direction $p^{k}$ must satisfy the condition $\\nabla \\phi(u^{k})^{\\top} p^{k}  0$.\n- At the current iterate $u^{k}$, the residual is $r = \\nabla \\phi(u^{k})$ and the tangent stiffness is $K = \\nabla^{2} \\phi(u^{k})$.\n- The given numerical values are:\n$$\nK = \\begin{pmatrix}\n2  1 \\\\\n1  -1\n\\end{pmatrix}, \\quad r = \\begin{pmatrix}\n1 \\\\\n2\n\\end{pmatrix}\n$$\n- It is stated that $K$ has exactly one negative eigenvalue, making it an indefinite matrix.\n- The specified line search parameter is $\\alpha = \\frac{1}{5}$.\n- The final result, $s^{k}$, should be expressed as a $1 \\times 2$ row matrix with exact values.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded:** The problem is a standard scenario in computational solid mechanics using the Finite Element Method. The concepts of potential energy minimization, residual forces ($r$), tangent stiffness ($K$), iterative solvers (like Newton-Raphson), and line search strategies are fundamental to the field. The situation where the tangent stiffness matrix $K$ becomes indefinite is a well-known challenge, typically associated with structural instabilities (e.g., buckling) or material softening, requiring a modification of the standard Newton-Raphson algorithm. The descent condition is correctly stated.\n- **Well-Posed:** The problem is well-posed. It asks for the derivation of a method to ensure a descent direction and then to apply it with the given data. This is a constructive task with a clear objective. Let us verify the claim that $K$ is indefinite with one negative eigenvalue. The characteristic equation is $\\det(K - \\lambda I) = 0$.\n$$\n\\det \\begin{pmatrix} 2-\\lambda  1 \\\\ 1  -1-\\lambda \\end{pmatrix} = (2-\\lambda)(-1-\\lambda) - (1)(1) = -2 - 2\\lambda + \\lambda + \\lambda^2 - 1 = \\lambda^2 - \\lambda - 3 = 0\n$$\nThe eigenvalues are given by the quadratic formula:\n$$\n\\lambda = \\frac{-(-1) \\pm \\sqrt{(-1)^2 - 4(1)(-3)}}{2(1)} = \\frac{1 \\pm \\sqrt{1 + 12}}{2} = \\frac{1 \\pm \\sqrt{13}}{2}\n$$\nThe two eigenvalues are $\\lambda_1 = \\frac{1 + \\sqrt{13}}{2}  0$ and $\\lambda_2 = \\frac{1 - \\sqrt{13}}{2}  0$, since $\\sqrt{13}  \\sqrt{9} = 3$. This confirms the problem statement that $K$ is indefinite with one positive and one negative eigenvalue.\n- **Objective:** The problem is stated in precise mathematical language, free from subjectivity or bias.\n- **Completeness and Consistency:** The problem provides all necessary data ($K$, $r$, $\\alpha$) to perform the required calculations. There are no contradictions in the provided information.\n\n**Step 3: Verdict and Action**\nThe problem is deemed **valid**. We may proceed to the solution.\n\n**Solution Derivation**\n\nThe core of the problem lies in finding a search direction $p^{k}$ that guarantees a decrease in the potential energy function $\\phi(u)$. This is ensured if $p^{k}$ is a descent direction, meaning it satisfies the condition $r^{\\top} p^{k}  0$, where $r = \\nabla \\phi(u^k)$.\n\nIn a standard Newton-Raphson method, the search direction is found by solving the linear system $K p^{k} = -r$, which yields $p^{k} = -K^{-1}r$. Let's examine the descent condition for this choice:\n$$\nr^{\\top} p^{k} = r^{\\top}(-K^{-1}r) = -r^{\\top}K^{-1}r\n$$\nFor this to be negative, the quadratic form $r^{\\top}K^{-1}r$ must be positive. This is only guaranteed if the matrix $K^{-1}$ is positive definite, which in turn requires the tangent stiffness matrix $K$ to be positive definite. However, we have established that the given $K$ is indefinite. Therefore, the standard Newton direction $p^{k} = -K^{-1}r$ may not be a descent direction and could lead the iteration away from the minimum.\n\nTo guarantee descent, we must modify the system. A common and robust technique is to modify the tangent stiffness matrix $K$ to a new matrix $\\tilde{K}$ that is guaranteed to be symmetric and positive definite. The search direction $p^k$ is then obtained by solving the modified system:\n$$\n\\tilde{K} p^{k} = -r\n$$\nThe search direction is thus $p^{k} = -\\tilde{K}^{-1}r$. The descent condition becomes:\n$$\nr^{\\top} p^{k} = -r^{\\top}\\tilde{K}^{-1}r\n$$\nSince $\\tilde{K}$ is constructed to be positive definite, its inverse $\\tilde{K}^{-1}$ is also positive definite. By the definition of a positive definite matrix, for any non-zero vector $x$, the quadratic form $x^{\\top}\\tilde{K}^{-1}x  0$. As long as we are not at equilibrium, the residual $r$ is non-zero. Therefore, $r^{\\top}\\tilde{K}^{-1}r  0$, which ensures that $r^{\\top} p^{k} = -r^{\\top}\\tilde{K}^{-1}r  0$. This proves that the resulting $p^k$ is a descent direction.\n\nA simple and effective way to construct $\\tilde{K}$ is through a spectral shift, also known as a Levenberg-Marquardt modification:\n$$\n\\tilde{K} = K + \\delta I\n$$\nwhere $I$ is the identity matrix and $\\delta$ is a non-negative scalar. For $\\tilde{K}$ to be positive definite, all its eigenvalues must be strictly positive. Let $\\{\\lambda_i\\}$ be the set of eigenvalues of $K$. The eigenvalues of $\\tilde{K}$ are $\\{\\lambda_i + \\delta\\}$. Thus, we require $\\lambda_i + \\delta  0$ for all $i$. This condition is equivalent to $\\delta  -\\lambda_i$ for all $i$, which implies that $\\delta$ must be greater than the negative of the minimum eigenvalue of $K$:\n$$\n\\delta  -\\lambda_{\\min}(K)\n$$\nWe have already calculated the eigenvalues of $K$ to be $\\lambda = \\frac{1 \\pm \\sqrt{13}}{2}$. The minimum eigenvalue is $\\lambda_{\\min} = \\frac{1 - \\sqrt{13}}{2}$. The condition on $\\delta$ is thus:\n$$\n\\delta  -\\left(\\frac{1 - \\sqrt{13}}{2}\\right) = \\frac{\\sqrt{13} - 1}{2}\n$$\nSince $3  \\sqrt{13}  4$, we have $1  \\frac{3-1}{2}  \\frac{\\sqrt{13}-1}{2}  \\frac{4-1}{2} = 1.5$. So we must choose $\\delta  \\frac{\\sqrt{13}-1}{2} \\approx 1.3028$. A simple integer choice that satisfies this condition is $\\delta=2$.\n\nLet's use $\\delta=2$ to construct the modified stiffness matrix $\\tilde{K}$:\n$$\n\\tilde{K} = K + 2I = \\begin{pmatrix} 2  1 \\\\ 1  -1 \\end{pmatrix} + 2 \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} 4  1 \\\\ 1  1 \\end{pmatrix}\n$$\nNow we solve the system $\\tilde{K}p^{k} = -r$ for the search direction $p^k$:\n$$\n\\begin{pmatrix} 4  1 \\\\ 1  1 \\end{pmatrix} p^{k} = - \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix} = \\begin{pmatrix} -1 \\\\ -2 \\end{pmatrix}\n$$\nTo solve for $p^k$, we first find the inverse of $\\tilde{K}$:\n$$\n\\det(\\tilde{K}) = (4)(1) - (1)(1) = 3\n$$\n$$\n\\tilde{K}^{-1} = \\frac{1}{3} \\begin{pmatrix} 1  -1 \\\\ -1  4 \\end{pmatrix}\n$$\nNow, we can compute $p^{k}$:\n$$\np^{k} = \\tilde{K}^{-1}(-r) = \\frac{1}{3} \\begin{pmatrix} 1  -1 \\\\ -1  4 \\end{pmatrix} \\begin{pmatrix} -1 \\\\ -2 \\end{pmatrix} = \\frac{1}{3} \\begin{pmatrix} (1)(-1) + (-1)(-2) \\\\ (-1)(-1) + (4)(-2) \\end{pmatrix} = \\frac{1}{3} \\begin{pmatrix} -1 + 2 \\\\ 1 - 8 \\end{pmatrix} = \\frac{1}{3} \\begin{pmatrix} 1 \\\\ -7 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{3} \\\\ -\\frac{7}{3} \\end{pmatrix}\n$$\nFinally, we compute the update step $s^{k} = \\alpha p^{k}$ using the given line search parameter $\\alpha = \\frac{1}{5}$:\n$$\ns^{k} = \\frac{1}{5} p^{k} = \\frac{1}{5} \\begin{pmatrix} \\frac{1}{3} \\\\ -\\frac{7}{3} \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{15} \\\\ -\\frac{7}{15} \\end{pmatrix}\n$$\nThe problem requests the answer as a $1 \\times 2$ row matrix. This is simply the transpose of the calculated column vector:\n$$\ns^{k} = \\begin{pmatrix} \\frac{1}{15}  -\\frac{7}{15} \\end{pmatrix}\n$$\nThis completes the derivation.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{15}  -\\frac{7}{15} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "Once a valid descent direction is secured, the next task is to determine how far to travel along it. Taking a full step ($\\alpha=1$) can be too aggressive and may increase the potential energy, while an overly small step can stall convergence. This exercise provides a practical, code-based implementation of the Armijo backtracking algorithm, the cornerstone of many line search strategies . You will apply the sufficient decrease condition to a nonlinear hyperelastic energy function, iteratively reducing the step size until an acceptable decrease in energy is achieved, thereby building an intuitive and algorithmic understanding of this fundamental convergence control mechanism.",
            "id": "3577625",
            "problem": "Consider the one-dimensional total potential energy for a hyperelastic bar given by the scalar function $\\Pi(u) = \\frac{1}{2} k u^{2} + \\frac{1}{4} \\beta u^{4} - f u$, where $k$, $\\beta$, $f$, and $u$ are nondimensional real numbers. At an iterate $u^{k}$ with a given search direction $p^{k}$, apply an Armijo backtracking line search to find the first acceptable step size $\\alpha \\in (0,1]$ that satisfies the sufficient decrease condition\n$$ \\Pi(u^{k} + \\alpha p^{k}) \\le \\Pi(u^{k}) + c_{1} \\alpha \\nabla \\Pi(u^{k}) p^{k} $$\nwhere $\\nabla \\Pi(u)$ denotes the derivative of $\\Pi$ with respect to $u$ and the product $\\nabla \\Pi(u^{k}) p^{k}$ is the directional derivative in the direction $p^{k}$. Use the following rules and parameters:\n- Use initial step size $\\alpha_{0} = 1$, backtracking factor $\\tau = 0.5$, and Armijo constant $c_{1} = 10^{-4}$.\n- If the direction is not a descent direction, meaning $\\nabla \\Pi(u^{k}) p^{k} \\ge 0$, replace $p^{k}$ by the steepest descent direction $-\\nabla \\Pi(u^{k})$ before starting backtracking.\n- If $p^{k} = 0$ after this check, return $\\alpha = 1$ by convention, since $\\Pi(u^{k} + \\alpha p^{k}) = \\Pi(u^{k})$ and the condition holds trivially.\n- During backtracking, repeatedly test the Armijo condition starting from $\\alpha = \\alpha_{0}$ and update $\\alpha \\leftarrow \\tau \\alpha$ until the condition is first satisfied. For numerical robustness, one may cap the number of backtracks at a fixed finite integer.\n\nBase your implementation on fundamental principles: compute $\\nabla \\Pi(u)$ directly from the definition of $\\Pi(u)$ by differentiation, evaluate the Armijo condition as given, and perform the stated backtracking. All quantities are nondimensional (no physical units).\n\nImplement a program that, for each test case below, computes the first acceptable $\\alpha$ according to the rules above.\n\nTest suite (each case specifies $(k,\\beta,f,u^{k},p^{k})$):\n- Case A (Newton-like step on a quadratic energy, expected to accept $\\alpha$ near unity): $k = 10$, $\\beta = 0$, $f = 4$, $u^{k} = 0.5$, $p^{k} = -0.1$.\n- Case B (non-descent input direction; enforce steepest descent, moderate stiffness so that the first acceptable halved step is $\\alpha = 0.5$): $k = 3$, $\\beta = 0$, $f = 0$, $u^{k} = 1.0$, $p^{k} = +1.0$.\n- Case C (steepest descent on a quadratic with stronger stiffness so that $\\alpha = 0.25$ is the first acceptable step): $k = 5$, $\\beta = 0$, $f = 0$, $u^{k} = 1.0$, $p^{k} = -5.0$.\n- Case D (zero direction; return $\\alpha = 1$ by convention; also exercises the quartic term): $k = 2$, $\\beta = 5$, $f = 0$, $u^{k} = 0.0$, $p^{k} = 0.0$.\n\nYour program must produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the test cases, for example $[\\alpha_{A},\\alpha_{B},\\alpha_{C},\\alpha_{D}]$. The answers for each case must be real numbers (floating-point values).",
            "solution": "The user-provided problem is assessed as valid. It is scientifically grounded in the principles of numerical optimization for nonlinear mechanics, well-posed with a clear and deterministic algorithm, and formally specified with all necessary data and conditions. The following solution adheres to the specified algorithmic procedure.\n\nThe core task is to implement an Armijo backtracking line search to find an acceptable step size $\\alpha$ for minimizing a one-dimensional potential energy function $\\Pi(u)$.\n\nThe potential energy is given by:\n$$ \\Pi(u) = \\frac{1}{2} k u^{2} + \\frac{1}{4} \\beta u^{4} - f u $$\nwhere $k$, $\\beta$, $f$, and $u$ are nondimensional real numbers.\n\nThe first step is to derive the gradient of the potential energy, $\\nabla\\Pi(u)$, which represents the residual force in the mechanical system. By differentiating $\\Pi(u)$ with respect to $u$, we obtain:\n$$ \\nabla\\Pi(u) = \\frac{d\\Pi}{du} = k u + \\beta u^{3} - f $$\n\nThe Armijo line search algorithm aims to find a step size $\\alpha \\in (0, 1]$ that satisfies the sufficient decrease condition. This condition ensures that the new point $u^{k+1} = u^k + \\alpha p^k$ yields a reduction in potential energy that is at least a fraction of the linear decrease predicted by the first-order Taylor expansion at $u^k$. The condition is formally stated as:\n$$ \\Pi(u^{k} + \\alpha p^{k}) \\le \\Pi(u^{k}) + c_{1} \\alpha \\nabla \\Pi(u^{k}) p^{k} $$\nHere, $u^k$ is the current iterate, $p^k$ is the search direction, $c_1$ is the Armijo constant (given as $c_1 = 10^{-4}$), and the term $\\nabla\\Pi(u^k)p^k$ is the directional derivative of $\\Pi$ at $u^k$ in the direction $p^k$.\n\nThe specified algorithmic procedure is as follows:\n\n1.  **Direction Verification**: At the current iterate $u^k$, calculate the gradient $\\nabla\\Pi(u^k)$ and the directional derivative $\\nabla\\Pi(u^k)p^k$. A valid search direction must be a descent direction, meaning it must satisfy $\\nabla\\Pi(u^k)p^k  0$. If this is not the case (i.e., if $\\nabla\\Pi(u^k)p^k \\ge 0$), the provided search direction $p^k$ is discarded. It is replaced by the steepest descent direction, which is defined as $p^k \\leftarrow -\\nabla\\Pi(u^k)$.\n\n2.  **Zero Direction Handling**: After the direction verification step, the resulting search direction $p^k$ is checked. If $p^k = 0$, it implies that $\\nabla\\Pi(u^k)=0$, meaning $u^k$ is a stationary point (an equilibrium position). At a stationary point, no further progress can be made. The Armijo condition simplifies to $\\Pi(u^k) \\le \\Pi(u^k)$, which is trivially true. By the problem's convention, an alpha value of $\\alpha=1$ is returned in this case.\n\n3.  **Backtracking Search**: If the search direction $p^k$ is a non-zero descent direction, the backtracking procedure begins.\n    - The initial trial step size is set to $\\alpha = \\alpha_0 = 1$.\n    - The Armijo sufficient decrease condition is evaluated with the current $\\alpha$.\n    - If the condition is satisfied, the current $\\alpha$ is accepted, and the search terminates.\n    - If the condition is not satisfied, the step size is too large. It is reduced by the backtracking factor $\\tau = 0.5$, so the new trial step size becomes $\\alpha \\leftarrow \\tau\\alpha$.\n    - This process of checking the condition and reducing $\\alpha$ is repeated until the condition is first satisfied. The properties of continuously differentiable functions guarantee that this process will terminate for a sufficiently small $\\alpha  0$.\n\nThis complete algorithm is applied to each of the provided test cases $(k, \\beta, f, u^k, p^k)$ to determine the first acceptable step size $\\alpha$.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the Armijo line search step size for a series of test cases.\n    \"\"\"\n\n    # Test cases: tuples of (k, beta, f, u_k, p_k)\n    test_cases = [\n        (10.0, 0.0, 4.0, 0.5, -0.1), # Case A\n        (3.0, 0.0, 0.0, 1.0, 1.0),  # Case B\n        (5.0, 0.0, 0.0, 1.0, -5.0), # Case C\n        (2.0, 5.0, 0.0, 0.0, 0.0)   # Case D\n    ]\n\n    # --- Helper functions for potential energy and its gradient ---\n    def pi_potential(u, k, beta, f):\n        \"\"\"Computes the potential energy Pi(u) as a scalar.\"\"\"\n        return 0.5 * k * u**2 + 0.25 * beta * u**4 - f * u\n\n    def grad_pi_potential(u, k, beta, f):\n        \"\"\"Computes the gradient of the potential energy nabla Pi(u) as a scalar.\"\"\"\n        return k * u + beta * u**3 - f\n\n    def perform_line_search(k, beta, f, u_k, p_k):\n        \"\"\"\n        Performs the Armijo backtracking line search for a single case.\n        \"\"\"\n        # Line search parameters as defined in the problem\n        c1 = 1e-4\n        tau = 0.5\n        alpha_0 = 1.0\n\n        # Calculate gradient at the current iterate u_k\n        grad_k = grad_pi_potential(u_k, k, beta, f)\n        \n        current_p_k = float(p_k)\n\n        # Step 1: Check if the search direction is a descent direction.\n        # If not, replace it with the steepest descent direction.\n        dir_deriv = grad_k * current_p_k\n        if dir_deriv = 0:\n            current_p_k = -grad_k\n        \n        # Step 2: Handle the zero direction case.\n        # This check occurs *after* the potential update of p_k.\n        if np.isclose(current_p_k, 0.0):\n            return 1.0\n        \n        # Step 3: Perform backtracking line search.\n        # Re-calculate directional derivative in case p_k was updated.\n        dir_deriv = grad_k * current_p_k\n        \n        alpha = alpha_0\n        pi_k = pi_potential(u_k, k, beta, f)\n        \n        # This term on the RHS of the Armijo condition is constant during the loop\n        armijo_rhs_slope = c1 * dir_deriv\n        \n        # Loop until the Armijo condition is satisfied\n        while True:\n            lhs = pi_potential(u_k + alpha * current_p_k, k, beta, f)\n            rhs = pi_k + alpha * armijo_rhs_slope\n            \n            if lhs = rhs:\n                # Sufficient decrease condition is met\n                return alpha\n            \n            # Condition not met, backtrack (reduce step size)\n            alpha *= tau\n\n    results = []\n    for case in test_cases:\n        alpha_result = perform_line_search(*case)\n        results.append(alpha_result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "The Armijo condition effectively prevents steps that are too large but does nothing to rule out steps that are excessively small, which can lead to inefficiently slow convergence. To build more robust and efficient solvers, we must also ensure that the step makes reasonable progress, which can be enforced by a curvature condition. This problem synthesizes the sufficient decrease criterion with the strong Wolfe curvature condition, challenging you to find a single step length that satisfies both . By working through this calculation for a nonlinear energy model, you will gain insight into how these two conditions work together to identify a \"goldilocks\" step that is both safe and effective.",
            "id": "3577646",
            "problem": "A one-dimensional nonlinear spring with displacement $u$ stores internal energy according to the truncated small-strain polynomial model $E(u)=\\frac{1}{2} k u^{2}+\\frac{1}{3} b u^{3}$, where $k0$ and $b0$ are nondimensional stiffness parameters. The equilibrium configuration is obtained by minimizing the total potential energy, and a Newtonâ€“Raphson (NR) iteration is globalized by a line search along a descent direction $p^{k}$. At the current iterate $u^{k}$, the line search seeks a step length $\\alpha0$ that reduces the scalar function $\\phi(\\alpha)=E(u^{k}+\\alpha p^{k})$ while promoting global convergence.\n\nConsider the specific data $k=100$, $b=200$, $u^{k}=0.05$, and $p^{k}=-0.02$, all nondimensional. The objective along the line is the cubic function $\\phi(\\alpha)=E(u^{k}+\\alpha p^{k})$. Compute a single positive step length $\\alpha$ that simultaneously satisfies the Armijo sufficient decrease condition with $c_{1}=10^{-4}$ and the strong Wolfe curvature condition with $c_{2}=0.9$ along the given $p^{k}$. Express your final $\\alpha$ as a dimensionless number. If you must approximate, round your answer to four significant figures.",
            "solution": "The user has provided a problem from computational mechanics involving a line search for a one-dimensional nonlinear system.\n\n### Step 1: Extract Givens\n-   Internal energy function: $E(u)=\\frac{1}{2} k u^{2}+\\frac{1}{3} b u^{3}$\n-   Stiffness parameters: $k0$, $b0$\n-   Specific data: $k=100$, $b=200$ (nondimensional)\n-   Current iterate: $u^{k}=0.05$ (nondimensional)\n-   Search direction: $p^{k}=-0.02$ (nondimensional)\n-   Line search objective function: $\\phi(\\alpha)=E(u^{k}+\\alpha p^{k})$\n-   Armijo condition parameter: $c_{1}=10^{-4}$\n-   Strong Wolfe condition parameter: $c_{2}=0.9$\n-   Objective: Compute a single positive step length $\\alpha0$ satisfying both conditions.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, well-posed, and objective. It describes a standard application of a Newton-type optimization algorithm with a line search globalization strategy, a core topic in computational solid mechanics and numerical optimization. The energy function is a simple but valid polynomial model. The line search conditions (Armijo and strong Wolfe) are standard. All necessary data are provided, and there are no internal contradictions. The problem can be formalized and solved using established mathematical principles.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\n### Solution Derivation\nThe goal is to find a step length $\\alpha0$ that satisfies two conditions for the line search function $\\phi(\\alpha)=E(u^{k}+\\alpha p^{k})$.\n\nThe two conditions are:\n1.  **Armijo (Sufficient Decrease) Condition**:\n    $$\\phi(\\alpha) \\le \\phi(0) + c_{1} \\alpha \\phi'(0)$$\n2.  **Strong Wolfe (Curvature) Condition**:\n    $$|\\phi'(\\alpha)| \\le c_{2} |\\phi'(0)|$$\n\nFirst, we define $\\phi(\\alpha)$ and its derivative $\\phi'(\\alpha)$ using the provided energy function $E(u)$.\nThe derivative of the energy function with respect to $u$ is the internal force:\n$$E'(u) = \\frac{dE}{du} = k u + b u^2$$\nThe derivative of the line search function $\\phi(\\alpha)$ with respect to $\\alpha$ is found using the chain rule:\n$$\\phi'(\\alpha) = \\frac{d}{d\\alpha} E(u^{k}+\\alpha p^{k}) = E'(u^{k}+\\alpha p^{k}) \\cdot \\frac{d}{d\\alpha}(u^{k}+\\alpha p^{k}) = E'(u^{k}+\\alpha p^{k}) \\cdot p^{k}$$\n\nNext, we evaluate $\\phi(0)$ and $\\phi'(0)$ using the given data:\n$k=100$, $b=200$, $u^{k}=0.05$, $p^{k}=-0.02$.\n\nAt $\\alpha=0$, we are at the current iterate $u^k$:\n$$\\phi(0) = E(u^{k}) = \\frac{1}{2} k (u^{k})^{2} + \\frac{1}{3} b (u^{k})^{3}$$\n$$\\phi(0) = \\frac{1}{2}(100)(0.05)^{2} + \\frac{1}{3}(200)(0.05)^{3} = 50(0.0025) + \\frac{200}{3}(0.000125)$$\n$$\\phi(0) = 0.125 + \\frac{0.025}{3} = \\frac{1}{8} + \\frac{1}{120} = \\frac{15+1}{120} = \\frac{16}{120} = \\frac{2}{15}$$\nFor the derivative at $\\alpha=0$:\n$$E'(u^k) = k u^k + b (u^k)^2 = 100(0.05) + 200(0.05)^2 = 5 + 200(0.0025) = 5 + 0.5 = 5.5$$\n$$\\phi'(0) = E'(u^k) p^k = (5.5)(-0.02) = -0.11$$\nSince $\\phi'(0)0$, the direction $p^k$ is a valid descent direction.\n\nNow, we can state the specific conditions for $\\alpha$ using $c_1 = 10^{-4}$ and $c_2 = 0.9$:\n1.  Armijo: $\\phi(\\alpha) \\le \\frac{2}{15} + (10^{-4}) \\alpha (-0.11) \\implies \\phi(\\alpha) \\le \\frac{2}{15} - 0.000011 \\alpha$\n2.  Strong Wolfe: $|\\phi'(\\alpha)| \\le (0.9)|-0.11| \\implies |\\phi'(\\alpha)| \\le 0.099$\n\nTo proceed, we need the general expression for $\\phi'(\\alpha)$. Let $u(\\alpha) = u^k + \\alpha p^k = 0.05 - 0.02\\alpha$.\n$$\\phi'(\\alpha) = \\left( k(u^k+\\alpha p^k) + b(u^k+\\alpha p^k)^2 \\right) p^k$$\n$$\\phi'(\\alpha) = \\left( 100(0.05 - 0.02\\alpha) + 200(0.05 - 0.02\\alpha)^2 \\right) (-0.02)$$\nLet's expand the term in the parentheses:\n$$(5 - 2\\alpha) + 200(0.0025 - 0.002\\alpha + 0.0004\\alpha^2) = 5 - 2\\alpha + 0.5 - 0.4\\alpha + 0.08\\alpha^2$$\n$$= 0.08\\alpha^2 - 2.4\\alpha + 5.5$$\nMultiplying by $p^k = -0.02$:\n$$\\phi'(\\alpha) = (-0.02)(0.08\\alpha^2 - 2.4\\alpha + 5.5) = -0.0016\\alpha^2 + 0.048\\alpha - 0.11$$\n\nThe problem asks for a single step length $\\alpha$. An interval of acceptable $\\alpha$ values typically exists. The most physically and mathematically principled choice for a single step is the one that minimizes the potential energy along the search direction. This corresponds to an \"exact line search,\" where we find $\\alpha  0$ such that $\\phi'(\\alpha)=0$.\nWe solve the quadratic equation $\\phi'(\\alpha)=0$:\n$$-0.0016\\alpha^2 + 0.048\\alpha - 0.11 = 0$$\nMultiplying by $-10000$ to clear decimals gives:\n$$16\\alpha^2 - 480\\alpha + 1100 = 0$$\nDividing by $4$:\n$$4\\alpha^2 - 120\\alpha + 275 = 0$$\nUsing the quadratic formula, $\\alpha = \\frac{-b \\pm \\sqrt{b^2-4ac}}{2a}$:\n$$\\alpha = \\frac{120 \\pm \\sqrt{(-120)^2 - 4(4)(275)}}{2(4)} = \\frac{120 \\pm \\sqrt{14400 - 4400}}{8}$$\n$$\\alpha = \\frac{120 \\pm \\sqrt{10000}}{8} = \\frac{120 \\pm 100}{8}$$\nThis gives two positive roots:\n$$\\alpha_1 = \\frac{120-100}{8} = \\frac{20}{8} = 2.5$$\n$$\\alpha_2 = \\frac{120+100}{8} = \\frac{220}{8} = 27.5$$\nTo determine which root corresponds to a minimum, we examine the sign of the second derivative, $\\phi''(\\alpha)$:\n$$\\phi''(\\alpha) = \\frac{d}{d\\alpha}(-0.0016\\alpha^2 + 0.048\\alpha - 0.11) = -0.0032\\alpha + 0.048$$\nAt $\\alpha_1=2.5$:\n$$\\phi''(2.5) = -0.0032(2.5) + 0.048 = -0.008 + 0.048 = 0.04  0$$\nThis indicates a local minimum.\nAt $\\alpha_2=27.5$:\n$$\\phi''(27.5) = -0.0032(27.5) + 0.048 = -0.088 + 0.048 = -0.04  0$$\nThis indicates a local maximum.\nThe step length that minimizes $\\phi(\\alpha)$ is $\\alpha^*=2.5$.\n\nFinally, we must verify that $\\alpha^*=2.5$ satisfies both the Armijo and strong Wolfe conditions.\n1.  **Strong Wolfe Condition**:\n    We must check if $|\\phi'(2.5)| \\le 0.099$. By construction, $\\alpha^*=2.5$ is a root of $\\phi'(\\alpha)$, so $\\phi'(2.5)=0$. The condition becomes $|0| \\le 0.099$, which is true.\n\n2.  **Armijo Condition**:\n    We must check if $\\phi(2.5) \\le \\phi(0) + c_1(2.5)\\phi'(0)$. To find $\\phi(2.5)$, we can evaluate $E(u^k + 2.5 p^k) = E(0.05 + 2.5(-0.02)) = E(0.05-0.05) = E(0) = 0$.\n    The Armijo condition is:\n    $$0 \\le \\phi(0) + c_1 \\alpha \\phi'(0)$$\n    $$0 \\le \\frac{2}{15} + (10^{-4})(2.5)(-0.11)$$\n    $$0 \\le 0.1333... - 0.0000275$$\n    This inequality is true.\n\nBoth conditions are satisfied for the step length $\\alpha=2.5$. This is an exact, positive, and dimensionless number.",
            "answer": "$$\\boxed{2.5}$$"
        }
    ]
}