{
    "hands_on_practices": [
        {
            "introduction": "We begin with the most fundamental concept in the Finite Element Method: representing a continuous physical quantity, like displacement, with a finite set of nodal values. This exercise demonstrates how the FEM framework uses interpolation to bridge the gap between a known continuous solution and its discrete representation. By working through a simple one-dimensional case , you will directly apply the principle of interpolation and confirm the foundational property of Lagrange elements—their ability to exactly represent a solution of the same or lower polynomial degree.",
            "id": "3565560",
            "problem": "Consider a one-dimensional elastic bar segment along the coordinate $x$ and a three-element patch discretized by the Finite Element Method (FEM). The physical domain is $x \\in [0, L]$ with $L = 0.9$ meters. The mesh consists of three equal two-node isoparametric Lagrange elements, with global nodes located at $x_{1} = 0$, $x_{2} = 0.3$, $x_{3} = 0.6$, and $x_{4} = 0.9$, all in meters. The exact displacement field is linear, given by $u(x) = a + B x$, with $a = 1.5 \\times 10^{-3}$ meters and $B = 5.0 \\times 10^{-3}$ (dimensionless with respect to meters).\n\nStarting from fundamental definitions governing the FEM approximation for $u(x)$ on a two-node isoparametric Lagrange element, derive the global nodal displacement vector that results from interpolating the exact field $u(x)$ on the three-element patch. Then, using first principles, verify that the interpolated field equals the exact field at the nodes. Express the final global nodal displacement vector in meters. No rounding is required; provide exact values.",
            "solution": "The problem is assessed to be valid as it is scientifically grounded, well-posed, and objective. It presents a standard exercise in the application of the Finite Element Method (FEM) to a one-dimensional problem, with all necessary data and definitions provided consistently.\n\nThe core of the problem is to determine the nodal displacements of a finite element mesh by interpolating a known exact displacement field and to verify the consistency of this interpolation at the nodal points.\n\nThe exact displacement field is given as a linear function of the spatial coordinate $x$:\n$$u(x) = a + Bx$$\nwith the constants $a = 1.5 \\times 10^{-3}$ meters and $B = 5.0 \\times 10^{-3}$ (dimensionless). The physical domain is $x \\in [0, 0.9]$ meters.\n\nThe domain is discretized into three equal two-node linear Lagrange elements. The global nodes are located at $x_{1} = 0$, $x_{2} = 0.3$, $x_{3} = 0.6$, and $x_{4} = 0.9$ meters.\nThe global nodal displacement vector, denoted by $\\mathbf{d}$, is a vector whose components are the values of the displacement at each global node. In FEM, when an exact solution is known, the nodal values for the approximation are typically set by evaluating the exact solution at the nodal coordinates. This process is known as interpolation.\nTherefore, the components $d_i$ of the global nodal displacement vector $\\mathbf{d}$ are given by:\n$$d_i = u(x_i)$$\nwhere $x_i$ is the coordinate of the $i$-th global node.\n\nWe compute the displacement for each of the four global nodes:\nFor node $1$ at $x_1 = 0$:\n$$d_1 = u(x_1) = u(0) = a + B(0) = a = 1.5 \\times 10^{-3} \\text{ m}$$\n\nFor node $2$ at $x_2 = 0.3$:\n$$d_2 = u(x_2) = u(0.3) = a + B(0.3) = (1.5 \\times 10^{-3}) + (5.0 \\times 10^{-3})(0.3) = 1.5 \\times 10^{-3} + 1.5 \\times 10^{-3} = 3.0 \\times 10^{-3} \\text{ m}$$\n\nFor node $3$ at $x_3 = 0.6$:\n$$d_3 = u(x_3) = u(0.6) = a + B(0.6) = (1.5 \\times 10^{-3}) + (5.0 \\times 10^{-3})(0.6) = 1.5 \\times 10^{-3} + 3.0 \\times 10^{-3} = 4.5 \\times 10^{-3} \\text{ m}$$\n\nFor node $4$ at $x_4 = 0.9$:\n$$d_4 = u(x_4) = u(0.9) = a + B(0.9) = (1.5 \\times 10^{-3}) + (5.0 \\times 10^{-3})(0.9) = 1.5 \\times 10^{-3} + 4.5 \\times 10^{-3} = 6.0 \\times 10^{-3} \\text{ m}$$\n\nThe global nodal displacement vector $\\mathbf{d}$ is therefore:\n$$\\mathbf{d} = \\begin{pmatrix} d_1 \\\\ d_2 \\\\ d_3 \\\\ d_4 \\end{pmatrix} = \\begin{pmatrix} 1.5 \\times 10^{-3} \\\\ 3.0 \\times 10^{-3} \\\\ 4.5 \\times 10^{-3} \\\\ 6.0 \\times 10^{-3} \\end{pmatrix} \\text{ m}$$\n\nNext, we must verify that the interpolated field equals the exact field at the nodes. The interpolated displacement field within a single two-node element, $u_h^{(e)}(x)$, is constructed using the element's linear Lagrange shape functions, $N_1^{(e)}(x)$ and $N_2^{(e)}(x)$, and its nodal displacements, $d_1^{(e)}$ and $d_2^{(e)}$:\n$$u_h^{(e)}(x) = N_1^{(e)}(x) d_1^{(e)} + N_2^{(e)}(x) d_2^{(e)}$$\nThe nodal displacements for the element are obtained by interpolating the exact field, so $d_1^{(e)} = u(x_1^{(e)})$ and $d_2^{(e)} = u(x_2^{(e)})$, where $x_1^{(e)}$ and $x_2^{(e)}$ are the coordinates of the element's local nodes.\n\nThe Lagrange shape functions possess the Kronecker delta property at the nodal points. This means that for a shape function $N_i$ associated with node $i$, its value is $1$ at node $i$ and $0$ at all other nodes of the element. For a two-node element with local nodes $1$ and $2$:\n$$N_1^{(e)}(x_1^{(e)}) = 1, \\quad N_1^{(e)}(x_2^{(e)}) = 0$$\n$$N_2^{(e)}(x_1^{(e)}) = 0, \\quad N_2^{(e)}(x_2^{(e)}) = 1$$\n\nTo verify the interpolated field at the first node of the element, we evaluate $u_h^{(e)}(x)$ at $x = x_1^{(e)}$:\n$$u_h^{(e)}(x_1^{(e)}) = N_1^{(e)}(x_1^{(e)}) d_1^{(e)} + N_2^{(e)}(x_1^{(e)}) d_2^{(e)}$$\nSubstituting the shape function values and nodal displacements:\n$$u_h^{(e)}(x_1^{(e)}) = (1) \\cdot u(x_1^{(e)}) + (0) \\cdot u(x_2^{(e)}) = u(x_1^{(e)})$$\n\nSimilarly, for the second node of the element at $x = x_2^{(e)}$:\n$$u_h^{(e)}(x_2^{(e)}) = N_1^{(e)}(x_2^{(e)}) d_1^{(e)} + N_2^{(e)}(x_2^{(e)}) d_2^{(e)}$$\n$$u_h^{(e)}(x_2^{(e)}) = (0) \\cdot u(x_1^{(e)}) + (1) \\cdot u(x_2^{(e)}) = u(x_2^{(e)})$$\nThis demonstrates that for any element, the value of the interpolated field at a node is, by construction, identical to the value of the exact field at that same node. This property holds for all three elements in the mesh and thus for all global nodes. The verification is complete.\n\nIt is a fundamental property of the Finite Element Method that if the exact solution is a polynomial of degree $p$, and the elements use shape functions that are polynomials of degree $k \\ge p$, the FEM solution obtained by interpolation will be exact not only at the nodes but everywhere within the domain. In this problem, the exact field $u(x)$ is a polynomial of degree $p=1$, and the two-node Lagrange elements use linear shape functions, which are polynomials of degree $k=1$. Since $k=p$, the interpolated field $u_h(x)$ is identical to the exact field $u(x)$ for all $x \\in [0, 0.9]$. The verification at the nodes is a specific case of this general principle.\n\nThe final answer is the derived global nodal displacement vector.",
            "answer": "$$\\boxed{\\begin{pmatrix} 1.5 \\times 10^{-3} \\\\ 3.0 \\times 10^{-3} \\\\ 4.5 \\times 10^{-3} \\\\ 6.0 \\times 10^{-3} \\end{pmatrix}}$$"
        },
        {
            "introduction": "Real-world components rarely have shapes that align perfectly with simple squares or triangles. The power of the isoparametric formulation lies in its ability to map a standard 'parent' element onto arbitrarily shaped elements in the physical domain. This crucial mapping, however, must be mathematically valid, a property governed by the Jacobian matrix. This practice  guides you through the calculation of the Jacobian determinant for a distorted quadrilateral, revealing why a positive value is essential for a physically meaningful and invertible transformation.",
            "id": "3565546",
            "problem": "Consider a four-node bilinear isoparametric quadrilateral element used to discretize a solid domain in computational solid mechanics. The element is defined in the parent space by natural coordinates $(\\xi,\\eta)\\in[-1,1]\\times[-1,1]$, and is mapped to the physical space $(x,y)$ by bilinear shape functions. The nodal coordinates in the physical space are given, in the order of local node numbers $1\\to2\\to3\\to4$, as $\\boldsymbol{x}_1=(0,0)$, $\\boldsymbol{x}_2=(0,2)$, $\\boldsymbol{x}_3=(2,0)$, and $\\boldsymbol{x}_4=(2,2)$. Using the standard bilinear isoparametric mapping, compute the determinant of the Jacobian $J(\\xi,\\eta)=\\det\\left(\\partial(x,y)/\\partial(\\xi,\\eta)\\right)$ and its absolute value $|J(\\xi,\\eta)|$ at the standard $2\\times 2$ Gauss-Legendre quadrature points located at $(\\xi,\\eta)=\\left(\\pm\\frac{1}{\\sqrt{3}},\\pm\\frac{1}{\\sqrt{3}}\\right)$. Identify whether the positivity condition $J(\\xi,\\eta)>0$ is violated at any of these points.\n\nExpress your final answer as a single row matrix containing:\n- First the four values of $J$ at the Gauss points in the order $(\\xi,\\eta)=\\left(-\\frac{1}{\\sqrt{3}},-\\frac{1}{\\sqrt{3}}\\right)$, $\\left(+\\frac{1}{\\sqrt{3}},-\\frac{1}{\\sqrt{3}}\\right)$, $\\left(+\\frac{1}{\\sqrt{3}},+\\frac{1}{\\sqrt{3}}\\right)$, $\\left(-\\frac{1}{\\sqrt{3}},+\\frac{1}{\\sqrt{3}}\\right)$,\n- Then the corresponding four values of $|J|$ in the same order,\n- Finally the integer count of Gauss points where the positivity condition $J(\\xi,\\eta)>0$ is violated.\n\nNo rounding is required. Provide only the requested numbers; do not include units in the final answer.",
            "solution": "The user wants to analyze a four-node bilinear isoparametric quadrilateral element. This process involves several steps: defining the mapping from the parent element to the physical element, calculating the Jacobian of this mapping, and then evaluating its determinant at specified points to check for validity.\n\n### Step 1: Problem Validation\n\n**1.1. Extract Givens**\n- **Element Type**: Four-node bilinear isoparametric quadrilateral element.\n- **Parent Space**: Natural coordinates $(\\xi, \\eta)$ are within the domain $[-1, 1] \\times [-1, 1]$.\n- **Physical Space Nodal Coordinates**: Given in the order of local node numbers $1 \\to 2 \\to 3 \\to 4$:\n  - $\\boldsymbol{x}_1 = (x_1, y_1) = (0, 0)$\n  - $\\boldsymbol{x}_2 = (x_2, y_2) = (0, 2)$\n  - $\\boldsymbol{x}_3 = (x_3, y_3) = (2, 0)$\n  - $\\boldsymbol{x}_4 = (x_4, y_4) = (2, 2)$\n- **Task**: Compute the determinant of the Jacobian, $J(\\xi, \\eta)$, and its absolute value, $|J(\\xi, \\eta)|$, at the four standard $2 \\times 2$ Gauss-Legendre quadrature points.\n- **Gauss Points**: $(\\xi, \\eta) = \\left(\\pm\\frac{1}{\\sqrt{3}}, \\pm\\frac{1}{\\sqrt{3}}\\right)$.\n- **Positivity Condition**: Identify the number of Gauss points where $J(\\xi, \\eta) > 0$ is violated.\n- **Output Order**: The final answer requires values of $J$, $|J|$, and the violation count for Gauss points in the order:\n  1. $(-\\frac{1}{\\sqrt{3}}, -\\frac{1}{\\sqrt{3}})$\n  2. $(+\\frac{1}{\\sqrt{3}}, -\\frac{1}{\\sqrt{3}})$\n  3. $(+\\frac{1}{\\sqrt{3}}, +\\frac{1}{\\sqrt{3}})$\n  4. $(-\\frac{1}{\\sqrt{3}}, +\\frac{1}{\\sqrt{3}})$\n\n**1.2. Validate Using Extracted Givens**\nThe problem is scientifically grounded in the theory of the Finite Element Method (FEM). It is well-posed, with all necessary data provided to compute a unique solution. The nodal coordinates describe a non-convex (\"bowtie\" or \"hourglass\") quadrilateral, which is a valid but distorted configuration used to test the robustness of element formulations. The task of checking the Jacobian determinant's sign is a standard procedure in FEM to ensure a valid, one-to-one mapping from the parent to the physical element. The problem is objective and contains no scientific flaws, inconsistencies, or ambiguities.\n\n**1.3. Verdict and Action**\nThe problem is valid. A complete solution will be provided.\n\n### Step 2: Define Isoparametric Mapping\n\nFor a four-node bilinear isoparametric element, the physical coordinates $(x, y)$ are interpolated from the nodal coordinates using bilinear shape functions $N_i(\\xi, \\eta)$. The standard local node numbering in the parent space is counter-clockwise:\n- Node $1$: $(\\xi, \\eta) = (-1, -1)$\n- Node $2$: $(\\xi, \\eta) = (1, -1)$\n- Node $3$: $(\\xi, \\eta) = (1, 1)$\n- Node $4$: $(\\xi, \\eta) = (-1, 1)$\n\nThe corresponding shape functions are:\n$N_1(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta)$\n$N_2(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta)$\n$N_3(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta)$\n$N_4(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1+\\eta)$\n\nThe problem statement assigns the given physical coordinates $\\boldsymbol{x}_1, \\boldsymbol{x}_2, \\boldsymbol{x}_3, \\boldsymbol{x}_4$ to the local nodes $1, 2, 3, 4$ respectively. The isoparametric mapping is:\n$$ x(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) x_i $$\n$$ y(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) y_i $$\n\nSubstituting the given nodal coordinates:\n$x(\\xi, \\eta) = N_1(\\xi, \\eta) \\cdot 0 + N_2(\\xi, \\eta) \\cdot 0 + N_3(\\xi, \\eta) \\cdot 2 + N_4(\\xi, \\eta) \\cdot 2$\n$x(\\xi, \\eta) = 2(N_3(\\xi, \\eta) + N_4(\\xi, \\eta))$\n$x(\\xi, \\eta) = 2 \\left( \\frac{1}{4}(1+\\xi)(1+\\eta) + \\frac{1}{4}(1-\\xi)(1+\\eta) \\right)$\n$x(\\xi, \\eta) = \\frac{1}{2}(1+\\eta) \\left( (1+\\xi) + (1-\\xi) \\right) = \\frac{1}{2}(1+\\eta)(2) = 1+\\eta$\n\n$y(\\xi, \\eta) = N_1(\\xi, \\eta) \\cdot 0 + N_2(\\xi, \\eta) \\cdot 2 + N_3(\\xi, \\eta) \\cdot 0 + N_4(\\xi, \\eta) \\cdot 2$\n$y(\\xi, \\eta) = 2(N_2(\\xi, \\eta) + N_4(\\xi, \\eta))$\n$y(\\xi, \\eta) = 2 \\left( \\frac{1}{4}(1+\\xi)(1-\\eta) + \\frac{1}{4}(1-\\xi)(1+\\eta) \\right)$\n$y(\\xi, \\eta) = \\frac{1}{2} \\left( 1-\\eta+\\xi-\\xi\\eta + 1+\\eta-\\xi-\\xi\\eta \\right) = \\frac{1}{2}(2 - 2\\xi\\eta) = 1-\\xi\\eta$\n\nSo, the mapping from the parent space to the physical space is given by $(x, y) = (1+\\eta, 1-\\xi\\eta)$.\n\n### Step 3: Compute the Jacobian Matrix and its Determinant\n\nThe Jacobian matrix $\\mathbf{J}$ of the transformation is defined as:\n$$ \\mathbf{J}(\\xi, \\eta) = \\frac{\\partial(x, y)}{\\partial(\\xi, \\eta)} = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix} $$\n\nWe compute the required partial derivatives:\n$\\frac{\\partial x}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi}(1+\\eta) = 0$\n$\\frac{\\partial x}{\\partial \\eta} = \\frac{\\partial}{\\partial \\eta}(1+\\eta) = 1$\n$\\frac{\\partial y}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi}(1-\\xi\\eta) = -\\eta$\n$\\frac{\\partial y}{\\partial \\eta} = \\frac{\\partial}{\\partial \\eta}(1-\\xi\\eta) = -\\xi$\n\nAssembling the Jacobian matrix:\n$$ \\mathbf{J}(\\xi, \\eta) = \\begin{pmatrix} 0 & 1 \\\\ -\\eta & -\\xi \\end{pmatrix} $$\n\nThe determinant of the Jacobian, denoted by $J(\\xi, \\eta)$, is:\n$$ J(\\xi, \\eta) = \\det(\\mathbf{J}) = (0)(-\\xi) - (1)(-\\eta) = \\eta $$\n\n### Step 4: Evaluate at Gauss Quadrature Points\n\nWe need to evaluate $J(\\xi, \\eta) = \\eta$ and $|J(\\xi, \\eta)|=|\\eta|$ at the four Gauss points, following the specified order. Let $a = \\frac{1}{\\sqrt{3}}$.\n\n1.  **Point 1**: $(\\xi_1, \\eta_1) = (-a, -a) = \\left(-\\frac{1}{\\sqrt{3}}, -\\frac{1}{\\sqrt{3}}\\right)$\n    $J_1 = \\eta_1 = -\\frac{1}{\\sqrt{3}}$\n    $|J_1| = \\left|-\\frac{1}{\\sqrt{3}}\\right| = \\frac{1}{\\sqrt{3}}$\n\n2.  **Point 2**: $(\\xi_2, \\eta_2) = (a, -a) = \\left(\\frac{1}{\\sqrt{3}}, -\\frac{1}{\\sqrt{3}}\\right)$\n    $J_2 = \\eta_2 = -\\frac{1}{\\sqrt{3}}$\n    $|J_2| = \\left|-\\frac{1}{\\sqrt{3}}\\right| = \\frac{1}{\\sqrt{3}}$\n\n3.  **Point 3**: $(\\xi_3, \\eta_3) = (a, a) = \\left(\\frac{1}{\\sqrt{3}}, \\frac{1}{\\sqrt{3}}\\right)$\n    $J_3 = \\eta_3 = \\frac{1}{\\sqrt{3}}$\n    $|J_3| = \\left|\\frac{1}{\\sqrt{3}}\\right| = \\frac{1}{\\sqrt{3}}$\n\n4.  **Point 4**: $(\\xi_4, \\eta_4) = (-a, a) = \\left(-\\frac{1}{\\sqrt{3}}, \\frac{1}{\\sqrt{3}}\\right)$\n    $J_4 = \\eta_4 = \\frac{1}{\\sqrt{3}}$\n    $|J_4| = \\left|\\frac{1}{\\sqrt{3}}\\right| = \\frac{1}{\\sqrt{3}}$\n\n### Step 5: Check for Positivity Condition Violation\n\nThe positivity condition $J(\\xi, \\eta) > 0$ ensures a valid (orientation-preserving) mapping. A violation occurs if $J(\\xi, \\eta) \\le 0$.\n\n-   At Point 1: $J_1 = -\\frac{1}{\\sqrt{3}} < 0$. **Violation.**\n-   At Point 2: $J_2 = -\\frac{1}{\\sqrt{3}} < 0$. **Violation.**\n-   At Point 3: $J_3 = \\frac{1}{\\sqrt{3}} > 0$. No violation.\n-   At Point 4: $J_4 = \\frac{1}{\\sqrt{3}} > 0$. No violation.\n\nThe total count of Gauss points where the positivity condition is violated is $2$.\n\n### Step 6: Assemble the Final Answer\n\nThe final answer is a row matrix containing the four values of $J$, the four values of $|J|$, and the violation count, in the specified order.\n\n-   Values of $J$: $-\\frac{1}{\\sqrt{3}}$, $-\\frac{1}{\\sqrt{3}}$, $\\frac{1}{\\sqrt{3}}$, $\\frac{1}{\\sqrt{3}}$\n-   Values of $|J|$: $\\frac{1}{\\sqrt{3}}$, $\\frac{1}{\\sqrt{3}}$, $\\frac{1}{\\sqrt{3}}$, $\\frac{1}{\\sqrt{3}}$\n-   Violation count: $2$\n\nThis results in the final matrix.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-\\frac{1}{\\sqrt{3}} & -\\frac{1}{\\sqrt{3}} & \\frac{1}{\\sqrt{3}} & \\frac{1}{\\sqrt{3}} & \\frac{1}{\\sqrt{3}} & \\frac{1}{\\sqrt{3}} & \\frac{1}{\\sqrt{3}} & \\frac{1}{\\sqrt{3}} & 2\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "The culmination of discretization is the assembly of element matrices, such as the stiffness matrix $\\boldsymbol{k}_e$, which encodes the element's physical behavior. For all but the simplest cases, the integral defining $\\boldsymbol{k}_e$ must be evaluated numerically. This comprehensive computational exercise  challenges you to implement Gauss-Legendre quadrature to approximate the stiffness matrix for a two-dimensional element and to analyze how integration order and geometric distortion impact accuracy—a critical skill for developing and using finite element analysis software.",
            "id": "3565598",
            "problem": "Consider a small-strain, linear-elastic, two-dimensional solid under plane strain conditions, discretized by a single four-node bilinear isoparametric quadrilateral element. Let the principle of virtual work and the definition of the strain-displacement relationship provide the fundamental base. The computational target is to approximate the element stiffness matrix by numerical quadrature and to quantify how the integration order perturbs the result. Work in nondimensional form so that all quantities are dimensionless.\n\nStarting from the fundamental definitions that (i) the Cauchy stress tensor is linearly related to the small-strain tensor via an isotropic elasticity tensor under plane strain conditions, (ii) the isoparametric map from the parent square to the physical element defines the Jacobian of the transformation, and (iii) the strain-displacement matrix follows from the spatial derivatives of the shape functions, implement the following algorithmic tasks without relying on any pre-tabulated element matrices:\n\n1. Use the four-node bilinear quadrilateral isoparametric interpolation on the parent domain $[-1,1] \\times [-1,1]$ with the standard node ordering $\\{1,2,3,4\\}$ in counterclockwise orientation. Construct the shape functions and their derivatives with respect to the parent coordinates $(\\xi,\\eta)$, map to physical coordinates via the Jacobian, and form the strain-displacement matrix $B$ for plane strain using the engineering shear strain convention.\n\n2. Use an isotropic linear-elastic constitutive matrix for plane strain with Young’s modulus $E$ and Poisson’s ratio $\\nu$, expressed in terms of Lamé parameters $\\lambda$ and $\\mu$ so that the shear component uses the engineering shear strain $\\gamma_{xy}$. Set $E=1$ and $\\nu=0.3$; use unit thickness $t=1$.\n\n3. For a given element geometry, approximate the element stiffness matrix $k_e$ by tensor-product Gauss-Legendre quadrature of order $p \\in \\{1,2,3\\}$ in each parametric direction, and also compute a high-fidelity reference using order $p_{\\mathrm{ref}}=8$. Define the normalized Frobenius-norm error for order $p$ by\n$$\ne_p \\equiv \\frac{\\lVert k_e^{(p)} - k_e^{(p_{\\mathrm{ref}})} \\rVert_F}{\\lVert k_e^{(p_{\\mathrm{ref}})} \\rVert_F}.\n$$\nEstimate the sensitivity of the stiffness to integration order by the discrete variation\n$$\ns \\equiv \\max\\left( \\left| e_2 - e_1 \\right|, \\left| e_3 - e_2 \\right| \\right).\n$$\n\n4. Implement the above for the following test suite of element geometries (node coordinates are listed as $(x,y)$, and every node coordinate pair is given in counterclockwise order). All coordinates are dimensionless:\n- Test case A (affine square): $[(0,0),(1,0),(1,1),(0,1)]$.\n- Test case B (moderately distorted trapezoid): $[(0,0),(2,0),(1.6,1.0),(0.2,1.0)]$.\n- Test case C (skew convex quadrilateral): $[(0,0),(1.5,0.2),(1.8,1.1),(0.1,1.0)]$.\n- Test case D (high aspect-ratio rectangle): $[(0,0),(100,0),(100,1),(0,1)]$.\n\nFor each test case, compute the list $[e_1,e_2,e_3,s]$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each entry corresponds to a test case and is itself a list of four floating-point numbers rounded to eight decimal places in the order $[e_1,e_2,e_3,s]$. For example, the output format must be\n$[[e_{1,A},e_{2,A},e_{3,A},s_A],[e_{1,B},e_{2,B},e_{3,B},s_B],[e_{1,C},e_{2,C},e_{3,C},s_C],[e_{1,D},e_{2,D},e_{3,D},s_D]]$.",
            "solution": "The problem requires the implementation and analysis of a four-node bilinear isoparametric quadrilateral element for a two-dimensional, linear-elastic solid under plane strain conditions. We must first formulate the element stiffness matrix from fundamental principles, then implement its numerical approximation via Gauss-Legendre quadrature, and finally analyze the sensitivity of the result to the integration order for several element geometries.\n\nThe foundation of the finite element method in solid mechanics lies in the principle of virtual work, which, in its discretized form, leads to the system of equations $\\boldsymbol{K}\\boldsymbol{d} = \\boldsymbol{f}$, where $\\boldsymbol{K}$ is the global stiffness matrix, $\\boldsymbol{d}$ is the vector of nodal displacements, and $\\boldsymbol{f}$ is the vector of nodal forces. The global stiffness matrix is assembled from element stiffness matrices, $\\boldsymbol{k}_e$. The element stiffness matrix for a single element is given by the integral over the element's volume $V_e$:\n$$\n\\boldsymbol{k}_e = \\int_{V_e} \\boldsymbol{B}^T \\boldsymbol{C} \\boldsymbol{B} \\, dV\n$$\nFor a $2$D problem with a constant thickness $t$, this becomes an integral over the element's area $A_e$:\n$$\n\\boldsymbol{k}_e = t \\int_{A_e} \\boldsymbol{B}^T \\boldsymbol{C} \\boldsymbol{B} \\, dA\n$$\n\nWe will construct the components of this integral: the strain-displacement matrix $\\boldsymbol{B}$ and the constitutive matrix $\\boldsymbol{C}$.\n\nA four-node quadrilateral element relies on an isoparametric mapping from a standard parent square domain, defined by coordinates $(\\xi, \\eta) \\in [-1, 1] \\times [-1, 1]$, to the physical element in the $(x,y)$ Cartesian space. The mapping is defined by the same shape functions used for interpolating the displacement field. The physical coordinates $(x,y)$ of any point within the element are interpolated from the nodal coordinates $(x_i, y_i)$ of its four nodes:\n$$\nx(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) x_i \\quad , \\quad y(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) y_i\n$$\nThe bilinear shape functions $N_i(\\xi, \\eta)$ for a standard counterclockwise node ordering starting from the bottom-left corner $(-1,-1)$ are:\n$$\n\\begin{aligned}\nN_1(\\xi, \\eta) &= \\frac{1}{4}(1-\\xi)(1-\\eta) \\\\\nN_2(\\xi, \\eta) &= \\frac{1}{4}(1+\\xi)(1-\\eta) \\\\\nN_3(\\xi, \\eta) &= \\frac{1}{4}(1+\\xi)(1+\\eta) \\\\\nN_4(\\xi, \\eta) &= \\frac{1}{4}(1-\\xi)(1+\\eta)\n\\end{aligned}\n$$\n\nThe strain-displacement matrix, $\\boldsymbol{B}$, relates the engineering strain vector $\\boldsymbol{\\epsilon} = [\\epsilon_x, \\epsilon_y, \\gamma_{xy}]^T$ to the element's nodal displacement vector $\\boldsymbol{u}_e = [u_1, v_1, u_2, v_2, u_3, v_3, u_4, v_4]^T$. The strain components are derived from spatial derivatives of the displacement field $u(x,y)$ and $v(x,y)$: $\\epsilon_x = \\frac{\\partial u}{\\partial x}$, $\\epsilon_y = \\frac{\\partial v}{\\partial y}$, and $\\gamma_{xy} = \\frac{\\partial u}{\\partial y} + \\frac{\\partial v}{\\partial x}$. Using the interpolation $u = \\sum N_i u_i$ and $v = \\sum N_i v_i$, we can write $\\boldsymbol{\\epsilon} = \\boldsymbol{B} \\boldsymbol{u}_e$. The $\\boldsymbol{B}$ matrix is an $3 \\times 8$ matrix constructed from the spatial derivatives of the shape functions:\n$$\n\\boldsymbol{B}_i = \\begin{pmatrix} \\frac{\\partial N_i}{\\partial x} & 0 \\\\ 0 & \\frac{\\partial N_i}{\\partial y} \\\\ \\frac{\\partial N_i}{\\partial y} & \\frac{\\partial N_i}{\\partial x} \\end{pmatrix} \\quad \\implies \\quad \\boldsymbol{B} = [\\boldsymbol{B}_1, \\boldsymbol{B}_2, \\boldsymbol{B}_3, \\boldsymbol{B}_4]\n$$\nThe required derivatives $\\frac{\\partial N_i}{\\partial x}$ and $\\frac{\\partial N_i}{\\partial y}$ are obtained from the derivatives in the parent domain, $\\frac{\\partial N_i}{\\partial \\xi}$ and $\\frac{\\partial N_i}{\\partial \\eta}$, using the chain rule, which involves the inverse of the Jacobian matrix $\\boldsymbol{J}$:\n$$\n\\begin{pmatrix} \\frac{\\partial N_i}{\\partial x} \\\\ \\frac{\\partial N_i}{\\partial y} \\end{pmatrix} = \\boldsymbol{J}^{-1} \\begin{pmatrix} \\frac{\\partial N_i}{\\partial \\xi} \\\\ \\frac{\\partial N_i}{\\partial \\eta} \\end{pmatrix}\n$$\nThe Jacobian matrix $\\boldsymbol{J}$ is defined as:\n$$\n\\boldsymbol{J} = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\xi} \\\\ \\frac{\\partial x}{\\partial \\eta} & \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix} = \\begin{pmatrix} \\sum_{i=1}^4 \\frac{\\partial N_i}{\\partial \\xi} x_i & \\sum_{i=1}^4 \\frac{\\partial N_i}{\\partial \\xi} y_i \\\\ \\sum_{i=1}^4 \\frac{\\partial N_i}{\\partial \\eta} x_i & \\sum_{i=1}^4 \\frac{\\partial N_i}{\\partial \\eta} y_i \\end{pmatrix}\n$$\nThe constitutive matrix $\\boldsymbol{C}$ for an isotropic linear-elastic material under plane strain conditions relates the stress vector $\\boldsymbol{\\sigma} = [\\sigma_x, \\sigma_y, \\tau_{xy}]^T$ to the strain vector $\\boldsymbol{\\epsilon}$ via $\\boldsymbol{\\sigma} = \\boldsymbol{C}\\boldsymbol{\\epsilon}$. Using Lamé parameters $\\lambda$ and $\\mu$ (shear modulus), the matrix is:\n$$\n\\boldsymbol{C} = \\begin{pmatrix} \\lambda + 2\\mu & \\lambda & 0 \\\\ \\lambda & \\lambda + 2\\mu & 0 \\\\ 0 & 0 & \\mu \\end{pmatrix}\n$$\nThe Lamé parameters are related to Young's modulus $E$ and Poisson's ratio $\\nu$ by:\n$$\n\\lambda = \\frac{E\\nu}{(1+\\nu)(1-2\\nu)} \\quad , \\quad \\mu = \\frac{E}{2(1+\\nu)}\n$$\nFor the given problem, $E=1$ and $\\nu=0.3$.\n\nThe integral for the stiffness matrix is evaluated in the parent domain. The differential area element transforms as $dA = \\det(\\boldsymbol{J}) d\\xi d\\eta$. With unit thickness $t=1$, the stiffness matrix becomes:\n$$\n\\boldsymbol{k}_e = \\int_{-1}^{1} \\int_{-1}^{1} \\boldsymbol{B}(\\xi, \\eta)^T \\boldsymbol{C} \\boldsymbol{B}(\\xi, \\eta) \\det(\\boldsymbol{J}(\\xi, \\eta)) \\, d\\xi \\, d\\eta\n$$\nThe integrand is generally a rational function of $\\xi$ and $\\eta$ because $\\boldsymbol{B}$ depends on $\\boldsymbol{J}^{-1}$. Thus, numerical integration is required. We use a tensor-product Gauss-Legendre quadrature scheme. The integral of a function $f(\\xi, \\eta)$ is approximated by a weighted sum over a grid of $p \\times p$ Gauss points $(\\xi_i, \\eta_j)$:\n$$\n\\int_{-1}^{1} \\int_{-1}^{1} f(\\xi, \\eta) \\, d\\xi \\, d\\eta \\approx \\sum_{i=1}^{p} \\sum_{j=1}^{p} w_i w_j f(\\xi_i, \\eta_j)\n$$\nwhere $w_i, w_j$ are the weights and $(\\xi_i, \\eta_j)$ are the abscissae of the $p$-point Gauss-Legendre rule. This numerical approximation is computed for integration orders $p \\in \\{1, 2, 3\\}$ to obtain $\\boldsymbol{k}_e^{(p)}$, and for a high-fidelity reference order $p_{\\mathrm{ref}}=8$ to obtain $\\boldsymbol{k}_e^{(p_{\\mathrm{ref}})}$.\n\nFinally, the error of the stiffness matrix approximation for order $p$ is quantified using the normalized Frobenius norm of the difference matrix:\n$$\ne_p = \\frac{\\lVert \\boldsymbol{k}_e^{(p)} - \\boldsymbol{k}_e^{(p_{\\mathrm{ref}})} \\rVert_F}{\\lVert \\boldsymbol{k}_e^{(p_{\\mathrm{ref}})} \\rVert_F}\n$$\nwhere the Frobenius norm of a matrix $\\boldsymbol{A}$ is $\\lVert \\boldsymbol{A} \\rVert_F = \\sqrt{\\sum_{i,j} A_{ij}^2}$. The sensitivity of the stiffness to integration order is estimated by the maximum change in error between successive orders:\n$$\ns = \\max\\left( \\left| e_2 - e_1 \\right|, \\left| e_3 - e_2 \\right| \\right)\n$$\nThis procedure is applied to the four specified element geometries to generate the required numerical results. For affine elements (rectangles), the Jacobian $\\boldsymbol{J}$ is constant. The integrand becomes a polynomial of degree $2$ in $\\xi$ and $\\eta$ respectively, which a $2 \\times 2$ Gauss rule ($p=2$) integrates exactly. Thus, for test cases A and D, we expect $e_2$ and $e_3$ to be zero (within machine precision). For distorted elements (B and C), the Jacobian is a function of $\\xi$ and $\\eta$, leading to a rational integrand and non-zero errors for low-order quadrature.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to orchestrate the computation for all test cases.\n    \"\"\"\n    test_cases = {\n        'A': np.array([[0.0, 0.0], [1.0, 0.0], [1.0, 1.0], [0.0, 1.0]]),\n        'B': np.array([[0.0, 0.0], [2.0, 0.0], [1.6, 1.0], [0.2, 1.0]]),\n        'C': np.array([[0.0, 0.0], [1.5, 0.2], [1.8, 1.1], [0.1, 1.0]]),\n        'D': np.array([[0.0, 0.0], [100.0, 0.0], [100.0, 1.0], [0.0, 1.0]]),\n    }\n\n    E = 1.0\n    nu = 0.3\n    t = 1.0\n    p_ref = 8\n    p_orders = [1, 2, 3]\n    \n    all_results = []\n\n    for case_id in ['A', 'B', 'C', 'D']:\n        coords = test_cases[case_id]\n        \n        # Compute reference stiffness matrix with high-order quadrature\n        k_ref = compute_stiffness_matrix(coords, p_ref, E, nu, t)\n        norm_k_ref = np.linalg.norm(k_ref, 'fro')\n\n        errors = []\n        for p in p_orders:\n            k_p = compute_stiffness_matrix(coords, p, E, nu, t)\n            # Handle the case where the reference norm is zero (theoretically impossible for a non-singular element)\n            if norm_k_ref == 0:\n                error = np.linalg.norm(k_p - k_ref, 'fro')\n            else:\n                error = np.linalg.norm(k_p - k_ref, 'fro') / norm_k_ref\n            errors.append(error)\n        \n        e1, e2, e3 = errors\n        s = max(abs(e2 - e1), abs(e3 - e2))\n        \n        case_results = [round(e1, 8), round(e2, 8), round(e3, 8), round(s, 8)]\n        all_results.append(case_results)\n\n    # Format the final output string\n    result_str_parts = []\n    for res_list in all_results:\n        result_str_parts.append(str(res_list).replace(\" \", \"\"))\n    \n    print(f\"[{','.join(result_str_parts)}]\")\n\n\ndef get_shape_functions_derivatives(xi, eta):\n    \"\"\"\n    Computes the derivatives of the 4-node quad shape functions w.r.t. parent coordinates.\n    Returns a 2x4 matrix dN/d(xi, eta).\n    \"\"\"\n    dN_dxi = 0.25 * np.array([-(1 - eta), (1 - eta), (1 + eta), -(1 + eta)])\n    dN_deta = 0.25 * np.array([-(1 - xi), -(1 + xi), (1 + xi), (1 - xi)])\n    return np.vstack([dN_dxi, dN_deta])\n\n\ndef compute_stiffness_matrix(coords, p, E, nu, t):\n    \"\"\"\n    Computes the element stiffness matrix for a 4-node quadrilateral element.\n\n    Args:\n        coords (np.ndarray): 4x2 array of nodal coordinates (x,y).\n        p (int): Order of Gauss-Legendre quadrature.\n        E (float): Young's modulus.\n        nu (float): Poisson's ratio.\n        t (float): Element thickness.\n\n    Returns:\n        np.ndarray: The 8x8 element stiffness matrix.\n    \"\"\"\n    # Material constitutive matrix for plane strain\n    lame_lambda = (E * nu) / ((1 + nu) * (1 - 2 * nu))\n    lame_mu = E / (2 * (1 + nu))\n    C = np.array([\n        [lame_lambda + 2 * lame_mu, lame_lambda, 0],\n        [lame_lambda, lame_lambda + 2 * lame_mu, 0],\n        [0, 0, lame_mu]\n    ])\n\n    k_e = np.zeros((8, 8))\n    \n    # Get Gauss points and weights\n    gauss_points, gauss_weights = np.polynomial.legendre.leggauss(p)\n\n    # Loop over Gauss points for numerical integration\n    for i in range(p):\n        xi = gauss_points[i]\n        w_xi = gauss_weights[i]\n        for j in range(p):\n            eta = gauss_points[j]\n            w_eta = gauss_weights[j]\n\n            # Derivatives of shape functions w.r.t. parent coordinates (xi, eta)\n            dN_dxi_eta = get_shape_functions_derivatives(xi, eta)  # 2x4 matrix\n\n            # Jacobian matrix\n            J = dN_dxi_eta @ coords  # 2x2 matrix\n            det_J = np.linalg.det(J)\n            if det_J = 0:\n                raise ValueError(\"Jacobian determinant is non-positive. Check element node ordering or geometry.\")\n            \n            inv_J = np.linalg.inv(J)\n\n            # Derivatives of shape functions w.r.t. physical coordinates (x, y)\n            dN_dxy = inv_J @ dN_dxi_eta  # 2x4 matrix\n\n            # Strain-displacement matrix B (3x8)\n            B = np.zeros((3, 8))\n            for k in range(4):\n                B[0, 2 * k] = dN_dxy[0, k]\n                B[1, 2 * k + 1] = dN_dxy[1, k]\n                B[2, 2 * k] = dN_dxy[1, k]\n                B[2, 2 * k + 1] = dN_dxy[0, k]\n\n            # Accumulate stiffness matrix\n            k_e += B.T @ C @ B * det_J * w_xi * w_eta * t\n\n    return k_e\n\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}