{
    "hands_on_practices": [
        {
            "introduction": "Before tackling complex geometries, we must understand how the Finite Element Method represents a physical field. This foundational practice  involves projecting a known continuous displacement field onto a simple 1D mesh. By doing so, you will verify the 'exactness' property of FEM when the solution lies within the basis of the shape functions, building a solid conceptual base for more advanced applications.",
            "id": "3565560",
            "problem": "Consider a one-dimensional elastic bar segment along the coordinate $x$ and a three-element patch discretized by the Finite Element Method (FEM). The physical domain is $x \\in [0, L]$ with $L = 0.9$ meters. The mesh consists of three equal two-node isoparametric Lagrange elements, with global nodes located at $x_{1} = 0$, $x_{2} = 0.3$, $x_{3} = 0.6$, and $x_{4} = 0.9$, all in meters. The exact displacement field is linear, given by $u(x) = a + B x$, with $a = 1.5 \\times 10^{-3}$ meters and $B = 5.0 \\times 10^{-3}$ (dimensionless).\n\nStarting from fundamental definitions governing the FEM approximation for $u(x)$ on a two-node isoparametric Lagrange element, derive the global nodal displacement vector that results from interpolating the exact field $u(x)$ on the three-element patch. Then, using first principles, verify that the interpolated field equals the exact field at the nodes. Express the final global nodal displacement vector in meters. No rounding is required; provide exact values.",
            "solution": "The problem is assessed to be valid as it is scientifically grounded, well-posed, and objective. It presents a standard exercise in the application of the Finite Element Method (FEM) to a one-dimensional problem, with all necessary data and definitions provided consistently.\n\nThe core of the problem is to determine the nodal displacements of a finite element mesh by interpolating a known exact displacement field and to verify the consistency of this interpolation at the nodal points.\n\nThe exact displacement field is given as a linear function of the spatial coordinate $x$:\n$$u(x) = a + Bx$$\nwith the constants $a = 1.5 \\times 10^{-3}$ meters and $B = 5.0 \\times 10^{-3}$ (dimensionless). The physical domain is $x \\in [0, 0.9]$ meters.\n\nThe domain is discretized into three equal two-node linear Lagrange elements. The global nodes are located at $x_{1} = 0$, $x_{2} = 0.3$, $x_{3} = 0.6$, and $x_{4} = 0.9$ meters.\nThe global nodal displacement vector, denoted by $\\mathbf{d}$, is a vector whose components are the values of the displacement at each global node. In FEM, when an exact solution is known, the nodal values for the approximation are typically set by evaluating the exact solution at the nodal coordinates. This process is known as interpolation.\nTherefore, the components $d_i$ of the global nodal displacement vector $\\mathbf{d}$ are given by:\n$$d_i = u(x_i)$$\nwhere $x_i$ is the coordinate of the $i$-th global node.\n\nWe compute the displacement for each of the four global nodes:\nFor node $1$ at $x_1 = 0$:\n$$d_1 = u(x_1) = u(0) = a + B(0) = a = 1.5 \\times 10^{-3} \\text{ m}$$\n\nFor node $2$ at $x_2 = 0.3$:\n$$d_2 = u(x_2) = u(0.3) = a + B(0.3) = (1.5 \\times 10^{-3}) + (5.0 \\times 10^{-3})(0.3) = 1.5 \\times 10^{-3} + 1.5 \\times 10^{-3} = 3.0 \\times 10^{-3} \\text{ m}$$\n\nFor node $3$ at $x_3 = 0.6$:\n$$d_3 = u(x_3) = u(0.6) = a + B(0.6) = (1.5 \\times 10^{-3}) + (5.0 \\times 10^{-3})(0.6) = 1.5 \\times 10^{-3} + 3.0 \\times 10^{-3} = 4.5 \\times 10^{-3} \\text{ m}$$\n\nFor node $4$ at $x_4 = 0.9$:\n$$d_4 = u(x_4) = u(0.9) = a + B(0.9) = (1.5 \\times 10^{-3}) + (5.0 \\times 10^{-3})(0.9) = 1.5 \\times 10^{-3} + 4.5 \\times 10^{-3} = 6.0 \\times 10^{-3} \\text{ m}$$\n\nThe global nodal displacement vector $\\mathbf{d}$ is therefore:\n$$\\mathbf{d} = \\begin{pmatrix} d_1 \\\\ d_2 \\\\ d_3 \\\\ d_4 \\end{pmatrix} = \\begin{pmatrix} 1.5 \\times 10^{-3} \\\\ 3.0 \\times 10^{-3} \\\\ 4.5 \\times 10^{-3} \\\\ 6.0 \\times 10^{-3} \\end{pmatrix} \\text{ m}$$\n\nNext, we must verify that the interpolated field equals the exact field at the nodes. The interpolated displacement field within a single two-node element, $u_h^{(e)}(x)$, is constructed using the element's linear Lagrange shape functions, $N_1^{(e)}(x)$ and $N_2^{(e)}(x)$, and its nodal displacements, $d_1^{(e)}$ and $d_2^{(e)}$:\n$$u_h^{(e)}(x) = N_1^{(e)}(x) d_1^{(e)} + N_2^{(e)}(x) d_2^{(e)}$$\nThe nodal displacements for the element are obtained by interpolating the exact field, so $d_1^{(e)} = u(x_1^{(e)})$ and $d_2^{(e)} = u(x_2^{(e)})$, where $x_1^{(e)}$ and $x_2^{(e)}$ are the coordinates of the element's local nodes.\n\nThe Lagrange shape functions possess the Kronecker delta property at the nodal points. This means that for a shape function $N_i$ associated with node $i$, its value is $1$ at node $i$ and $0$ at all other nodes of the element. For a two-node element with local nodes $1$ and $2$:\n$$N_1^{(e)}(x_1^{(e)}) = 1, \\quad N_1^{(e)}(x_2^{(e)}) = 0$$\n$$N_2^{(e)}(x_1^{(e)}) = 0, \\quad N_2^{(e)}(x_2^{(e)}) = 1$$\n\nTo verify the interpolated field at the first node of the element, we evaluate $u_h^{(e)}(x)$ at $x = x_1^{(e)}$:\n$$u_h^{(e)}(x_1^{(e)}) = N_1^{(e)}(x_1^{(e)}) d_1^{(e)} + N_2^{(e)}(x_1^{(e)}) d_2^{(e)}$$\nSubstituting the shape function values and nodal displacements:\n$$u_h^{(e)}(x_1^{(e)}) = (1) \\cdot u(x_1^{(e)}) + (0) \\cdot u(x_2^{(e)}) = u(x_1^{(e)})$$\n\nSimilarly, for the second node of the element at $x = x_2^{(e)}$:\n$$u_h^{(e)}(x_2^{(e)}) = N_1^{(e)}(x_2^{(e)}) d_1^{(e)} + N_2^{(e)}(x_2^{(e)}) d_2^{(e)}$$\n$$u_h^{(e)}(x_2^{(e)}) = (0) \\cdot u(x_1^{(e)}) + (1) \\cdot u(x_2^{(e)}) = u(x_2^{(e)})$$\nThis demonstrates that for any element, the value of the interpolated field at a node is, by construction, identical to the value of the exact field at that same node. This property holds for all three elements in the mesh and thus for all global nodes. The verification is complete.\n\nIt is a fundamental property of the Finite Element Method that if the exact solution is a polynomial of degree $p$, and the elements use shape functions that are polynomials of degree $k \\ge p$, the FEM solution obtained by interpolation will be exact not only at the nodes but everywhere within the domain. In this problem, the exact field $u(x)$ is a polynomial of degree $p=1$, and the two-node Lagrange elements use linear shape functions, which are polynomials of degree $k=1$. Since $k=p$, the interpolated field $u_h(x)$ is identical to the exact field $u(x)$ for all $x \\in [0, 0.9]$. The verification at the nodes is a specific case of this general principle.\n\nThe final answer is the derived global nodal displacement vector.",
            "answer": "$$\\boxed{\\begin{pmatrix} 1.5 \\times 10^{-3} \\\\ 3.0 \\times 10^{-3} \\\\ 4.5 \\times 10^{-3} \\\\ 6.0 \\times 10^{-3} \\end{pmatrix}}$$"
        },
        {
            "introduction": "Moving to two dimensions requires a method for describing arbitrary shapes, which is achieved by mapping a simple 'parent' element to a physical one using the isoparametric concept. The validity of this geometric mapping hinges on the Jacobian determinant, which must remain positive to ensure a unique representation. This practice  provides hands-on experience in calculating the Jacobian and diagnosing element distortion, a critical skill for assessing mesh quality.",
            "id": "3565546",
            "problem": "Consider a four-node bilinear isoparametric quadrilateral element used to discretize a solid domain in computational solid mechanics. The element is defined in the parent space by natural coordinates $(\\xi,\\eta)\\in[-1,1]\\times[-1,1]$, and is mapped to the physical space $(x,y)$ by bilinear shape functions. The nodal coordinates in the physical space are given, in the order of local node numbers $1\\to2\\to3\\to4$, as $\\boldsymbol{x}_1=(0,0)$, $\\boldsymbol{x}_2=(0,2)$, $\\boldsymbol{x}_3=(2,0)$, and $\\boldsymbol{x}_4=(2,2)$. Using the standard bilinear isoparametric mapping, compute the determinant of the Jacobian $J(\\xi,\\eta)=\\det\\left(\\partial(x,y)/\\partial(\\xi,\\eta)\\right)$ and its absolute value $|J(\\xi,\\eta)|$ at the standard $2\\times 2$ Gauss-Legendre quadrature points located at $(\\xi,\\eta)=\\left(\\pm\\frac{1}{\\sqrt{3}},\\pm\\frac{1}{\\sqrt{3}}\\right)$. Identify whether the positivity condition $J(\\xi,\\eta)>0$ is violated at any of these points.\n\nExpress your final answer as a single row matrix containing:\n- First the four values of $J$ at the Gauss points in the order $(\\xi,\\eta)=\\left(-\\frac{1}{\\sqrt{3}},-\\frac{1}{\\sqrt{3}}\\right)$, $\\left(+\\frac{1}{\\sqrt{3}},-\\frac{1}{\\sqrt{3}}\\right)$, $\\left(+\\frac{1}{\\sqrt{3}},+\\frac{1}{\\sqrt{3}}\\right)$, $\\left(-\\frac{1}{\\sqrt{3}},+\\frac{1}{\\sqrt{3}}\\right)$,\n- Then the corresponding four values of $|J|$ in the same order,\n- Finally the integer count of Gauss points where the positivity condition $J(\\xi,\\eta)>0$ is violated.\n\nNo rounding is required. Provide only the requested numbers; do not include units in the final answer.",
            "solution": "The user wants to analyze a four-node bilinear isoparametric quadrilateral element. This process involves several steps: defining the mapping from the parent element to the physical element, calculating the Jacobian of this mapping, and then evaluating its determinant at specified points to check for validity.\n\n### Step 1: Problem Validation\n\n**1.1. Extract Givens**\n- **Element Type**: Four-node bilinear isoparametric quadrilateral element.\n- **Parent Space**: Natural coordinates $(\\xi, \\eta)$ are within the domain $[-1, 1] \\times [-1, 1]$.\n- **Physical Space Nodal Coordinates**: Given in the order of local node numbers $1 \\to 2 \\to 3 \\to 4$:\n  - $\\boldsymbol{x}_1 = (x_1, y_1) = (0, 0)$\n  - $\\boldsymbol{x}_2 = (x_2, y_2) = (0, 2)$\n  - $\\boldsymbol{x}_3 = (x_3, y_3) = (2, 0)$\n  - $\\boldsymbol{x}_4 = (x_4, y_4) = (2, 2)$\n- **Task**: Compute the determinant of the Jacobian, $J(\\xi, \\eta)$, and its absolute value, $|J(\\xi, \\eta)|$, at the four standard $2 \\times 2$ Gauss-Legendre quadrature points.\n- **Gauss Points**: $(\\xi, \\eta) = \\left(\\pm\\frac{1}{\\sqrt{3}}, \\pm\\frac{1}{\\sqrt{3}}\\right)$.\n- **Positivity Condition**: Identify the number of Gauss points where $J(\\xi, \\eta) > 0$ is violated.\n- **Output Order**: The final answer requires values of $J$, $|J|$, and the violation count for Gauss points in the order:\n  1. $(-\\frac{1}{\\sqrt{3}}, -\\frac{1}{\\sqrt{3}})$\n  2. $(+\\frac{1}{\\sqrt{3}}, -\\frac{1}{\\sqrt{3}})$\n  3. $(+\\frac{1}{\\sqrt{3}}, +\\frac{1}{\\sqrt{3}})$\n  4. $(-\\frac{1}{\\sqrt{3}}, +\\frac{1}{\\sqrt{3}})$\n\n**1.2. Validate Using Extracted Givens**\nThe problem is scientifically grounded in the theory of the Finite Element Method (FEM). It is well-posed, with all necessary data provided to compute a unique solution. The nodal coordinates describe a non-convex (\"bowtie\" or \"hourglass\") quadrilateral, which is a valid but distorted configuration used to test the robustness of element formulations. The task of checking the Jacobian determinant's sign is a standard procedure in FEM to ensure a valid, one-to-one mapping from the parent to the physical element. The problem is objective and contains no scientific flaws, inconsistencies, or ambiguities.\n\n**1.3. Verdict and Action**\nThe problem is valid. A complete solution will be provided.\n\n### Step 2: Define Isoparametric Mapping\n\nFor a four-node bilinear isoparametric element, the physical coordinates $(x, y)$ are interpolated from the nodal coordinates using bilinear shape functions $N_i(\\xi, \\eta)$. The standard local node numbering in the parent space is counter-clockwise:\n- Node $1$: $(\\xi, \\eta) = (-1, -1)$\n- Node $2$: $(\\xi, \\eta) = (1, -1)$\n- Node $3$: $(\\xi, \\eta) = (1, 1)$\n- Node $4$: $(\\xi, \\eta) = (-1, 1)$\n\nThe corresponding shape functions are:\n$N_1(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta)$\n$N_2(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta)$\n$N_3(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta)$\n$N_4(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1+\\eta)$\n\nThe problem statement assigns the given physical coordinates $\\boldsymbol{x}_1, \\boldsymbol{x}_2, \\boldsymbol{x}_3, \\boldsymbol{x}_4$ to the local nodes $1, 2, 3, 4$ respectively. The isoparametric mapping is:\n$$ x(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) x_i $$\n$$ y(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) y_i $$\n\nSubstituting the given nodal coordinates:\n$x(\\xi, \\eta) = N_1(\\xi, \\eta) \\cdot 0 + N_2(\\xi, \\eta) \\cdot 0 + N_3(\\xi, \\eta) \\cdot 2 + N_4(\\xi, \\eta) \\cdot 2$\n$x(\\xi, \\eta) = 2(N_3(\\xi, \\eta) + N_4(\\xi, \\eta))$\n$x(\\xi, \\eta) = 2 \\left( \\frac{1}{4}(1+\\xi)(1+\\eta) + \\frac{1}{4}(1-\\xi)(1+\\eta) \\right)$\n$x(\\xi, \\eta) = \\frac{1}{2}(1+\\eta) \\left( (1+\\xi) + (1-\\xi) \\right) = \\frac{1}{2}(1+\\eta)(2) = 1+\\eta$\n\n$y(\\xi, \\eta) = N_1(\\xi, \\eta) \\cdot 0 + N_2(\\xi, \\eta) \\cdot 2 + N_3(\\xi, \\eta) \\cdot 0 + N_4(\\xi, \\eta) \\cdot 2$\n$y(\\xi, \\eta) = 2(N_2(\\xi, \\eta) + N_4(\\xi, \\eta))$\n$y(\\xi, \\eta) = 2 \\left( \\frac{1}{4}(1+\\xi)(1-\\eta) + \\frac{1}{4}(1-\\xi)(1+\\eta) \\right)$\n$y(\\xi, \\eta) = \\frac{1}{2} \\left( 1-\\eta+\\xi-\\xi\\eta + 1+\\eta-\\xi-\\xi\\eta \\right) = \\frac{1}{2}(2 - 2\\xi\\eta) = 1-\\xi\\eta$\n\nSo, the mapping from the parent space to the physical space is given by $(x, y) = (1+\\eta, 1-\\xi\\eta)$.\n\n### Step 3: Compute the Jacobian Matrix and its Determinant\n\nThe Jacobian matrix $\\mathbf{J}$ of the transformation is defined as:\n$$ \\mathbf{J}(\\xi, \\eta) = \\frac{\\partial(x, y)}{\\partial(\\xi, \\eta)} = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix} $$\n\nWe compute the required partial derivatives:\n$\\frac{\\partial x}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi}(1+\\eta) = 0$\n$\\frac{\\partial x}{\\partial \\eta} = \\frac{\\partial}{\\partial \\eta}(1+\\eta) = 1$\n$\\frac{\\partial y}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi}(1-\\xi\\eta) = -\\eta$\n$\\frac{\\partial y}{\\partial \\eta} = \\frac{\\partial}{\\partial \\eta}(1-\\xi\\eta) = -\\xi$\n\nAssembling the Jacobian matrix:\n$$ \\mathbf{J}(\\xi, \\eta) = \\begin{pmatrix} 0 & 1 \\\\ -\\eta & -\\xi \\end{pmatrix} $$\n\nThe determinant of the Jacobian, denoted by $J(\\xi, \\eta)$, is:\n$$ J(\\xi, \\eta) = \\det(\\mathbf{J}) = (0)(-\\xi) - (1)(-\\eta) = \\eta $$\n\n### Step 4: Evaluate at Gauss Quadrature Points\n\nWe need to evaluate $J(\\xi, \\eta) = \\eta$ and $|J(\\xi, \\eta)|=|\\eta|$ at the four Gauss points, following the specified order. Let $a = \\frac{1}{\\sqrt{3}}$.\n\n1.  **Point 1**: $(\\xi_1, \\eta_1) = (-a, -a) = \\left(-\\frac{1}{\\sqrt{3}}, -\\frac{1}{\\sqrt{3}}\\right)$\n    $J_1 = \\eta_1 = -\\frac{1}{\\sqrt{3}}$\n    $|J_1| = \\left|-\\frac{1}{\\sqrt{3}}\\right| = \\frac{1}{\\sqrt{3}}$\n\n2.  **Point 2**: $(\\xi_2, \\eta_2) = (a, -a) = \\left(\\frac{1}{\\sqrt{3}}, -\\frac{1}{\\sqrt{3}}\\right)$\n    $J_2 = \\eta_2 = -\\frac{1}{\\sqrt{3}}$\n    $|J_2| = \\left|-\\frac{1}{\\sqrt{3}}\\right| = \\frac{1}{\\sqrt{3}}$\n\n3.  **Point 3**: $(\\xi_3, \\eta_3) = (a, a) = \\left(\\frac{1}{\\sqrt{3}}, \\frac{1}{\\sqrt{3}}\\right)$\n    $J_3 = \\eta_3 = \\frac{1}{\\sqrt{3}}$\n    $|J_3| = \\left|\\frac{1}{\\sqrt{3}}\\right| = \\frac{1}{\\sqrt{3}}$\n\n4.  **Point 4**: $(\\xi_4, \\eta_4) = (-a, a) = \\left(-\\frac{1}{\\sqrt{3}}, \\frac{1}{\\sqrt{3}}\\right)$\n    $J_4 = \\eta_4 = \\frac{1}{\\sqrt{3}}$\n    $|J_4| = \\left|\\frac{1}{\\sqrt{3}}\\right| = \\frac{1}{\\sqrt{3}}$\n\n### Step 5: Check for Positivity Condition Violation\n\nThe positivity condition $J(\\xi, \\eta) > 0$ ensures a valid (orientation-preserving) mapping. A violation occurs if $J(\\xi, \\eta) \\le 0$.\n\n-   At Point 1: $J_1 = -\\frac{1}{\\sqrt{3}} < 0$. **Violation.**\n-   At Point 2: $J_2 = -\\frac{1}{\\sqrt{3}} < 0$. **Violation.**\n-   At Point 3: $J_3 = \\frac{1}{\\sqrt{3}} > 0$. No violation.\n-   At Point 4: $J_4 = \\frac{1}{\\sqrt{3}} > 0$. No violation.\n\nThe total count of Gauss points where the positivity condition is violated is $2$.\n\n### Step 6: Assemble the Final Answer\n\nThe final answer is a row matrix containing the four values of $J$, the four values of $|J|$, and the violation count, in the specified order.\n\n-   Values of $J$: $-\\frac{1}{\\sqrt{3}}$, $-\\frac{1}{\\sqrt{3}}$, $\\frac{1}{\\sqrt{3}}$, $\\frac{1}{\\sqrt{3}}$\n-   Values of $|J|$: $\\frac{1}{\\sqrt{3}}$, $\\frac{1}{\\sqrt{3}}$, $\\frac{1}{\\sqrt{3}}$, $\\frac{1}{\\sqrt{3}}$\n-   Violation count: $2$\n\nThis results in the final matrix.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-\\frac{1}{\\sqrt{3}} & -\\frac{1}{\\sqrt{3}} & \\frac{1}{\\sqrt{3}} & \\frac{1}{\\sqrt{3}} & \\frac{1}{\\sqrt{3}} & \\frac{1}{\\sqrt{3}} & \\frac{1}{\\sqrt{3}} & \\frac{1}{\\sqrt{3}} & 2\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "The principles of interpolation and mapping culminate in the construction of the element stiffness matrix, the core of an FEM simulation. In this comprehensive exercise , you will derive and implement the strain-displacement matrix ($\\boldsymbol{B}$) and the stiffness matrix ($\\boldsymbol{k}_e = \\int \\boldsymbol{B}^T \\boldsymbol{D} \\boldsymbol{B} \\, dV$) for a 3D tetrahedral element. This will provide you with practical, code-level experience in assembling the fundamental matrices for 3D elasticity analysis.",
            "id": "3565565",
            "problem": "You are to derive, implement, and evaluate the strain-displacement matrix and consistent element stiffness for three-dimensional small-strain isotropic linear elasticity using a single linear tetrahedral finite element. Start from the principle of virtual work and the small-strain definition to obtain the discretized form. Then, for each specified test case, compute and report the requested scalar invariants.\n\nBegin from the following fundamental bases and core definitions:\n- The small-strain tensor $\\,\\boldsymbol{\\varepsilon}(\\mathbf{u})\\,$ defined by $\\,\\varepsilon_{ij} = \\tfrac{1}{2}\\left(u_{i,j}+u_{j,i}\\right)\\,$.\n- The constitutive relation for an isotropic linear elastic solid (Hooke’s law), $\\,\\boldsymbol{\\sigma} = \\mathbb{C}:\\boldsymbol{\\varepsilon}\\,$, where $\\,\\mathbb{C}\\,$ depends on Young’s modulus $\\,E\\,$ and Poisson’s ratio $\\,\\nu\\,$.\n- The Galerkin form of the principle of virtual work for static equilibrium without body forces on a single element domain $\\,\\Omega_e\\,$, which yields the element stiffness after spatial discretization by shape functions.\n\nOn a linear tetrahedron, the displacement field is interpolated by four scalar shape functions $\\,N_a(\\mathbf{x})\\,$, $\\,a\\in\\{1,2,3,4\\}\\,$, that satisfy $\\,N_a(\\mathbf{x}_b) = \\delta_{ab}\\,$ at the nodes. Each $\\,N_a\\,$ is affine and has the form $\\,N_a(x,y,z) = a_a + b_a x + c_a y + d_a z\\,$. Determine the coefficients by enforcing the Kronecker delta property. The gradients $\\,\\nabla N_a\\,$ are constant over the element and define the strain-displacement matrix $\\,\\mathbf{B}\\,$ for the linear tetrahedron. For three-dimensional elasticity with the engineering strain vector ordering $\\,\\{\\varepsilon_{xx},\\varepsilon_{yy},\\varepsilon_{zz},\\gamma_{yz},\\gamma_{zx},\\gamma_{xy}\\}^{\\mathsf{T}}\\,$, assemble $\\,\\mathbf{B}\\in\\mathbb{R}^{6\\times 12}\\,$ accordingly.\n\nFor the isotropic elasticity matrix $\\,\\mathbf{D}\\in\\mathbb{R}^{6\\times 6}\\,$ in three dimensions, use Lamé parameters $\\,\\lambda\\,$ and $\\,\\mu\\,$ defined in terms of $\\,E\\,$ and $\\,\\nu\\,$, and the standard $\\,6\\times 6\\,$ representation consistent with the chosen engineering strain vector.\n\nThe consistent element stiffness is obtained by integrating the bilinear form over the element, which reduces to a constant integrand times the element volume for a linear tetrahedral element.\n\nImplement a program that, for each test case, computes:\n- the element volume $\\,V\\,$ in $\\,\\mathrm{m}^3\\,$,\n- the Frobenius norm of the strain-displacement matrix $\\,\\lVert \\mathbf{B}\\rVert_F\\,$ in $\\,\\mathrm{m}^{-1}\\,$,\n- the Frobenius norm of the element stiffness $\\,\\lVert \\mathbf{k}_e\\rVert_F\\,$ in $\\,\\mathrm{N/m}\\,$,\n- the trace of the element stiffness $\\,\\mathrm{tr}(\\mathbf{k}_e)\\,$ in $\\,\\mathrm{N/m}\\,$.\n\nAll answers must be expressed in the International System of Units (SI). Angles are not involved. Report each of the four outputs per test case as real numbers.\n\nTest suite (each case is defined by nodal coordinates and material properties):\n- Case $\\,1\\,$ (baseline unit tetrahedron): nodes at $\\,\\mathbf{x}_1=(0,0,0)\\,$, $\\,\\mathbf{x}_2=(1,0,0)\\,$, $\\,\\mathbf{x}_3=(0,1,0)\\,$, $\\,\\mathbf{x}_4=(0,0,1)\\,$ with $\\,E=2.10\\times 10^{11}\\,\\mathrm{Pa}\\,$ and $\\,\\nu=0.3\\,$.\n- Case $\\,2\\,$ (scaled geometry by a factor $\\,2\\,$): nodes at $\\,\\mathbf{x}_1=(0,0,0)\\,$, $\\,\\mathbf{x}_2=(2,0,0)\\,$, $\\,\\mathbf{x}_3=(0,2,0)\\,$, $\\,\\mathbf{x}_4=(0,0,2)\\,$ with $\\,E=2.10\\times 10^{11}\\,\\mathrm{Pa}\\,$ and $\\,\\nu=0.3\\,$.\n- Case $\\,3\\,$ (skew tetrahedron): nodes at $\\,\\mathbf{x}_1=(1.0,-1.0,0.5)\\,$, $\\,\\mathbf{x}_2=(2.0,0.2,-0.3)\\,$, $\\,\\mathbf{x}_3=(0.3,1.7,0.4)\\,$, $\\,\\mathbf{x}_4=(-0.5,-0.6,1.2)\\,$ with $\\,E=7.0\\times 10^{10}\\,\\mathrm{Pa}\\,$ and $\\,\\nu=0.25\\,$.\n- Case $\\,4\\,$ (nearly degenerate volume): nodes at $\\,\\mathbf{x}_1=(0,0,0)\\,$, $\\,\\mathbf{x}_2=(1,0,0)\\,$, $\\,\\mathbf{x}_3=(0,1.0\\times 10^{-2},0)\\,$, $\\,\\mathbf{x}_4=(0,0,1.0\\times 10^{-3})\\,$ with $\\,E=1.0\\times 10^{10}\\,\\mathrm{Pa}\\,$ and $\\,\\nu=0.33\\,$.\n- Case $\\,5\\,$ (nearly incompressible): nodes at $\\,\\mathbf{x}_1=(0,0,0)\\,$, $\\,\\mathbf{x}_2=(1,0,0)\\,$, $\\,\\mathbf{x}_3=(0,1,0)\\,$, $\\,\\mathbf{x}_4=(0,0,1)\\,$ with $\\,E=1.0\\times 10^{6}\\,\\mathrm{Pa}\\,$ and $\\,\\nu=0.4999\\,$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results for all test cases as a comma-separated list enclosed in square brackets, where each test case contributes a sub-list of four numbers in the order $[V,\\lVert \\mathbf{B}\\rVert_F,\\lVert \\mathbf{k}_e\\rVert_F,\\mathrm{tr}(\\mathbf{k}_e)]$.\n- Use scientific notation with exactly $\\,10\\,$ significant digits for each number.\n- For example, the format of the overall output must be like $\\,\\big[\\,[v_1,b_1,k_1,t_1],[v_2,b_2,k_2,t_2],\\dots\\,\\big]\\,$ with no spaces.\n\nYour task is to derive from first principles and implement the computation so that the program, when run, outputs the required line for the above five cases.",
            "solution": "We derive the linear tetrahedral element matrices for three-dimensional small-strain isotropic elasticity from first principles. Let $\\,\\Omega_e\\subset\\mathbb{R}^3\\,$ be the element domain with nodes at positions $\\,\\mathbf{x}_a=(x_a,y_a,z_a)\\,$ for $\\,a\\in\\{1,2,3,4\\}\\,$. The displacement field $\\,\\mathbf{u}(\\mathbf{x})\\,$ is approximated by shape functions $\\,N_a(\\mathbf{x})\\,$ and nodal displacement vectors $\\,\\mathbf{d}_a\\in\\mathbb{R}^3\\,$ as $\\,\\mathbf{u}(\\mathbf{x})=\\sum_{a=1}^4 N_a(\\mathbf{x})\\,\\mathbf{d}_a\\,$. In small-strain kinematics, the strain tensor is $\\,\\boldsymbol{\\varepsilon}(\\mathbf{u})=\\tfrac{1}{2}\\left(\\nabla\\mathbf{u}+(\\nabla\\mathbf{u})^{\\mathsf{T}}\\right)\\,$ with components $\\,\\varepsilon_{ij}=\\tfrac{1}{2}\\left(u_{i,j}+u_{j,i}\\right)\\,$.\n\nFor a linear tetrahedron, each shape function $\\,N_a\\,$ is affine:\n$$\nN_a(x,y,z)=a_a + b_a x + c_a y + d_a z\\,,\n$$\nwith the Kronecker delta interpolation conditions $\\,N_a(\\mathbf{x}_b)=\\delta_{ab}\\,$. These four conditions for each $\\,a\\,$ give a $\\,4\\times 4\\,$ linear system. Collect the nodal positions into the matrix\n$$\n\\mathbf{M}=\\begin{bmatrix}\n1 & x_1 & y_1 & z_1\\\\\n1 & x_2 & y_2 & z_2\\\\\n1 & x_3 & y_3 & z_3\\\\\n1 & x_4 & y_4 & z_4\n\\end{bmatrix},\n$$\nand define the coefficient vector $\\,\\boldsymbol{\\alpha}_a=\\begin{bmatrix}a_a & b_a & c_a & d_a\\end{bmatrix}^{\\mathsf{T}}\\,$. The Kronecker conditions read $\\,\\mathbf{M}\\,\\boldsymbol{\\alpha}_a=\\mathbf{e}_a\\,$, where $\\,\\mathbf{e}_a\\,$ is the $\\,a$-th canonical basis vector of $\\,\\mathbb{R}^4\\,$. Therefore, $\\,\\boldsymbol{\\alpha}_a=\\mathbf{M}^{-1}\\mathbf{e}_a\\,$ and the gradient is constant over the element:\n$$\n\\nabla N_a = \\begin{bmatrix} \\dfrac{\\partial N_a}{\\partial x}\\\n$$4pt] \\dfrac{\\partial N_a}{\\partial y}\\\n$$4pt] \\dfrac{\\partial N_a}{\\partial z} \\end{bmatrix} = \\begin{bmatrix} b_a\\\\ c_a\\\\ d_a\\end{bmatrix} \\in \\mathbb{R}^3\\,.\n$$\n\nAdopt the engineering strain vector ordering $\\,\\boldsymbol{\\varepsilon}_\\mathrm{eng}=\\begin{bmatrix}\\varepsilon_{xx}&\\varepsilon_{yy}&\\varepsilon_{zz}&\\gamma_{yz}&\\gamma_{zx}&\\gamma_{xy}\\end{bmatrix}^{\\mathsf{T}}\\,$. The strain-displacement matrix $\\,\\mathbf{B}\\in\\mathbb{R}^{6\\times 12}\\,$ is assembled from the gradients $\\,\\nabla N_a\\,$ so that $\\,\\boldsymbol{\\varepsilon}_\\mathrm{eng}=\\mathbf{B}\\,\\mathbf{d}_e\\,$, where $\\,\\mathbf{d}_e\\in\\mathbb{R}^{12}\\,$ stacks the nodal displacements $\\,\\mathbf{d}_1,\\dots,\\mathbf{d}_4\\,$. For node $\\,a\\,$ with gradient components $\\,b_a=\\partial N_a/\\partial x\\,$, $\\,c_a=\\partial N_a/\\partial y\\,$, $\\,d_a=\\partial N_a/\\partial z\\,$, the $\\,3\\times 3\\,$ block in $\\,\\mathbf{B}\\,$ placed at columns $\\,3(a-1)+1:3a\\,$ is\n$$\n\\mathbf{B}_a=\\begin{bmatrix}\nb_a & 0   & 0\\\\\n0   & c_a & 0\\\\\n0   & 0   & d_a\\\\\n0   & d_a & c_a\\\\\nd_a & 0   & b_a\\\\\nc_a & b_a & 0\n\\end{bmatrix}.\n$$\nThus $\\,\\mathbf{B}=\\begin{bmatrix}\\mathbf{B}_1 & \\mathbf{B}_2 & \\mathbf{B}_3 & \\mathbf{B}_4\\end{bmatrix}\\,$.\n\nFor three-dimensional isotropic linear elasticity, the Cauchy stress and engineering strain are related via $\\,\\boldsymbol{\\sigma}_\\mathrm{eng}=\\mathbf{D}\\,\\boldsymbol{\\varepsilon}_\\mathrm{eng}\\,$, where $\\,\\mathbf{D}\\in\\mathbb{R}^{6\\times 6}\\,$ is expressed using the Lamé parameters $\\,\\lambda\\,$ and $\\,\\mu\\,$:\n$$\n\\lambda=\\frac{E\\,\\nu}{(1+\\nu)(1-2\\nu)}\\,,\\qquad \\mu=\\frac{E}{2(1+\\nu)}\\,,\n$$\nand\n$$\n\\mathbf{D}=\\begin{bmatrix}\n\\lambda+2\\mu & \\lambda      & \\lambda      & 0 & 0 & 0\\\\\n\\lambda      & \\lambda+2\\mu & \\lambda      & 0 & 0 & 0\\\\\n\\lambda      & \\lambda      & \\lambda+2\\mu & 0 & 0 & 0\\\\\n0            & 0            & 0            & \\mu & 0 & 0\\\\\n0            & 0            & 0            & 0 & \\mu & 0\\\\\n0            & 0            & 0            & 0 & 0 & \\mu\n\\end{bmatrix}.\n$$\n\nThe principle of virtual work for a single element with no body forces gives\n$$\n\\delta W_\\mathrm{int}=\\int_{\\Omega_e}\\boldsymbol{\\varepsilon}(\\delta\\mathbf{u}):\\boldsymbol{\\sigma}(\\mathbf{u})\\,\\mathrm{d}V\n=\\int_{\\Omega_e}\\boldsymbol{\\varepsilon}_\\mathrm{eng}(\\delta\\mathbf{u})^{\\mathsf{T}}\\,\\mathbf{D}\\,\\boldsymbol{\\varepsilon}_\\mathrm{eng}(\\mathbf{u})\\,\\mathrm{d}V\n=\\delta\\mathbf{d}_e^{\\mathsf{T}}\\left(\\int_{\\Omega_e}\\mathbf{B}^{\\mathsf{T}}\\mathbf{D}\\mathbf{B}\\,\\mathrm{d}V\\right)\\mathbf{d}_e\\,.\n$$\nTherefore, the consistent element stiffness is\n$$\n\\mathbf{k}_e=\\int_{\\Omega_e}\\mathbf{B}^{\\mathsf{T}}\\mathbf{D}\\mathbf{B}\\,\\mathrm{d}V\\,.\n$$\nFor a linear tetrahedral element, $\\,\\mathbf{B}\\,$ is constant over $\\,\\Omega_e\\,$, hence\n$$\n\\mathbf{k}_e=\\mathbf{B}^{\\mathsf{T}}\\mathbf{D}\\mathbf{B}\\,V\\,,\\qquad V=\\int_{\\Omega_e}\\mathrm{d}V\\,.\n$$\n\nThe element volume $\\,V\\,$ can be obtained from the nodal coordinates. Let\n$$\n\\mathbf{M}=\\begin{bmatrix}\n1 & x_1 & y_1 & z_1\\\\\n1 & x_2 & y_2 & z_2\\\\\n1 & x_3 & y_3 & z_3\\\\\n1 & x_4 & y_4 & z_4\n\\end{bmatrix}.\n$$\nThen the signed volume is $\\,V_s=\\dfrac{\\det(\\mathbf{M})}{6}\\,$, and the physical volume is $\\,V=|V_s|\\,.$ This is equivalent to $\\,V=\\dfrac{1}{6}\\big|(\\mathbf{x}_2-\\mathbf{x}_1)\\cdot\\big((\\mathbf{x}_3-\\mathbf{x}_1)\\times(\\mathbf{x}_4-\\mathbf{x}_1)\\big)\\big|\\,.$\n\nAlgorithmic steps for each test case:\n1. Assemble $\\,\\mathbf{M}\\,$ from nodal coordinates and compute $\\,\\mathbf{M}^{-1}\\,$. For each node $\\,a\\,$, extract $\\,\\boldsymbol{\\alpha}_a=\\mathbf{M}^{-1}\\mathbf{e}_a\\,$, so that $\\,\\nabla N_a=\\begin{bmatrix}b_a & c_a & d_a\\end{bmatrix}^{\\mathsf{T}}\\,$ corresponds to the last three components of $\\,\\boldsymbol{\\alpha}_a\\,$.\n2. Assemble $\\,\\mathbf{B}\\,$ by placing the $\\,\\mathbf{B}_a\\,$ blocks built from $\\,b_a,c_a,d_a\\,$.\n3. Compute $\\,\\lambda\\,$ and $\\,\\mu\\,$ from the given $\\,E\\,$ and $\\,\\nu\\,$, assemble $\\,\\mathbf{D}\\,$.\n4. Compute $\\,V=\\dfrac{|\\det(\\mathbf{M})|}{6}\\,$.\n5. Compute $\\,\\mathbf{k}_e=\\mathbf{B}^{\\mathsf{T}}\\mathbf{D}\\mathbf{B}\\,V\\,$.\n6. Report the four scalars per case: $\\,V\\,$, $\\,\\lVert \\mathbf{B}\\rVert_F=\\sqrt{\\sum_{i,j}B_{ij}^2}\\,$, $\\,\\lVert \\mathbf{k}_e\\rVert_F=\\sqrt{\\sum_{i,j}k_{e,ij}^2}\\,$, and $\\,\\mathrm{tr}(\\mathbf{k}_e)=\\sum_i k_{e,ii}\\,.$\n\nUnits and conditioning remarks:\n- $\\,V\\,$ is in $\\,\\mathrm{m}^3\\,$.\n- The entries of $\\,\\mathbf{B}\\,$ scale as inverse length, hence $\\,\\lVert\\mathbf{B}\\rVert_F\\,$ is in $\\,\\mathrm{m}^{-1}\\,$.\n- $\\,\\mathbf{D}\\,$ has units of $\\,\\mathrm{Pa}=\\mathrm{N/m}^2\\,$, so $\\,\\mathbf{k}_e\\,$ has units $\\,\\mathrm{N/m}\\,$. Consequently, both $\\,\\lVert\\mathbf{k}_e\\rVert_F\\,$ and $\\,\\mathrm{tr}(\\mathbf{k}_e)\\,$ are in $\\,\\mathrm{N/m}\\,$.\n- A single element stiffness $\\,\\mathbf{k}_e\\,$ is rank-deficient due to rigid body modes; the Frobenius norm and trace remain well-defined and strictly positive.\n- In Case $\\,2\\,$, scaling the element size by a factor $\\,s=2\\,$ scales gradients by $\\,1/s\\,$ and volume by $\\,s^3\\,$, thus $\\,\\mathbf{k}_e\\,$ scales by $\\,s\\,$, providing a consistency check. In Case $\\,5\\,$, $\\,\\nu\\to 0.5^{-}\\,$ makes $\\,\\lambda\\,$ large, increasing the stiffness entries predominantly in the volumetric subspace. In Case $\\,4\\,$, small volume with large gradients leads to finite $\\,\\mathbf{k}_e\\,$ but increased $\\,\\lVert\\mathbf{B}\\rVert_F\\,$.\n\nThe implementation follows these derivations exactly and prints the required per-case scalars in a single bracketed list-of-lists line, with each number in scientific notation with exactly ten significant digits, as required.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_shape_function_gradients(nodes):\n    \"\"\"\n    Compute gradients of linear tetrahedral shape functions.\n    nodes: (4,3) array with rows [x_i, y_i, z_i] for i=1..4\n    Returns:\n        grads: (3,4) array where column i is [dNi/dx, dNi/dy, dNi/dz]\n        volume: positive scalar volume\n    \"\"\"\n    M = np.column_stack((np.ones(4), nodes))  # 4x4\n    detM = np.linalg.det(M)\n    volume = abs(detM) / 6.0\n    invM = np.linalg.inv(M)\n    # invM columns correspond to coefficients [a_i, b_i, c_i, d_i] for N_i\n    grads = invM[1:, :]  # rows 1..3 are [b, c, d], shape (3,4)\n    return grads, volume\n\ndef assemble_B(grads):\n    \"\"\"\n    Assemble the 6x12 B matrix from gradients.\n    grads: (3,4) with columns [dNi/dx, dNi/dy, dNi/dz]\n    Returns:\n        B: (6,12) strain-displacement matrix\n    \"\"\"\n    B = np.zeros((6, 12), dtype=float)\n    for a in range(4):\n        bx, by, bz = grads[0, a], grads[1, a], grads[2, a]\n        col = 3 * a\n        # Normal strains\n        B[0, col + 0] = bx\n        B[1, col + 1] = by\n        B[2, col + 2] = bz\n        # Engineering shear strains\n        B[3, col + 1] = bz  # gamma_yz: [0, d/dz, d/dy]\n        B[3, col + 2] = by\n        B[4, col + 0] = bz  # gamma_zx: [d/dz, 0, d/dx]\n        B[4, col + 2] = bx\n        B[5, col + 0] = by  # gamma_xy: [d/dy, d/dx, 0]\n        B[5, col + 1] = bx\n    return B\n\ndef elasticity_matrix_3d(E, nu):\n    \"\"\"\n    Build the 6x6 isotropic elasticity matrix D for 3D using engineering strains.\n    \"\"\"\n    lam = E * nu / ((1.0 + nu) * (1.0 - 2.0 * nu))\n    mu = E / (2.0 * (1.0 + nu))\n    D = np.zeros((6, 6), dtype=float)\n    # Normal components\n    D[0, 0] = lam + 2.0 * mu\n    D[1, 1] = lam + 2.0 * mu\n    D[2, 2] = lam + 2.0 * mu\n    D[0, 1] = lam\n    D[0, 2] = lam\n    D[1, 0] = lam\n    D[1, 2] = lam\n    D[2, 0] = lam\n    D[2, 1] = lam\n    # Shear components\n    D[3, 3] = mu\n    D[4, 4] = mu\n    D[5, 5] = mu\n    return D\n\ndef compute_element_invariants(nodes, E, nu):\n    \"\"\"\n    Compute V, ||B||_F, ||ke||_F, trace(ke) for a linear tetrahedral element.\n    \"\"\"\n    grads, V = compute_shape_function_gradients(nodes)\n    B = assemble_B(grads)\n    D = elasticity_matrix_3d(E, nu)\n    ke = B.T @ D @ B * V\n    # Invariants\n    Bnorm = float(np.linalg.norm(B, ord='fro'))\n    Kenorm = float(np.linalg.norm(ke, ord='fro'))\n    TrKe = float(np.trace(ke))\n    return V, Bnorm, Kenorm, TrKe\n\ndef format_results(results):\n    \"\"\"\n    Format results as a single-line nested list with scientific notation (10 significant digits).\n    \"\"\"\n    def fmt(x):\n        return f\"{x:.10e}\"\n    sublists = []\n    for V, Bn, Kn, Tr in results:\n        sublists.append(\"[\" + \",\".join([fmt(V), fmt(Bn), fmt(Kn), fmt(Tr)]) + \"]\")\n    return \"[\" + \",\".join(sublists) + \"]\"\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: Unit tetrahedron, E=2.10e11 Pa, nu=0.3\n        (np.array([[0.0, 0.0, 0.0],\n                   [1.0, 0.0, 0.0],\n                   [0.0, 1.0, 0.0],\n                   [0.0, 0.0, 1.0]], dtype=float),\n         2.10e11, 0.3),\n        # Case 2: Scaled by 2\n        (np.array([[0.0, 0.0, 0.0],\n                   [2.0, 0.0, 0.0],\n                   [0.0, 2.0, 0.0],\n                   [0.0, 0.0, 2.0]], dtype=float),\n         2.10e11, 0.3),\n        # Case 3: Skew tetrahedron, E=7.0e10 Pa, nu=0.25\n        (np.array([[ 1.0, -1.0,  0.5],\n                   [ 2.0,  0.2, -0.3],\n                   [ 0.3,  1.7,  0.4],\n                   [-0.5, -0.6,  1.2]], dtype=float),\n         7.0e10, 0.25),\n        # Case 4: Nearly degenerate, E=1.0e10 Pa, nu=0.33\n        (np.array([[0.0, 0.0, 0.0],\n                   [1.0, 0.0, 0.0],\n                   [0.0, 1.0e-2, 0.0],\n                   [0.0, 0.0, 1.0e-3]], dtype=float),\n         1.0e10, 0.33),\n        # Case 5: Nearly incompressible, E=1.0e6 Pa, nu=0.4999\n        (np.array([[0.0, 0.0, 0.0],\n                   [1.0, 0.0, 0.0],\n                   [0.0, 1.0, 0.0],\n                   [0.0, 0.0, 1.0]], dtype=float),\n         1.0e6, 0.4999),\n    ]\n\n    results = []\n    for nodes, E, nu in test_cases:\n        V, Bnorm, Kenorm, TrKe = compute_element_invariants(nodes, E, nu)\n        results.append((V, Bnorm, Kenorm, TrKe))\n\n    # Final print statement in the exact required format.\n    print(format_results(results))\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}