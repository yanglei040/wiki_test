{
    "hands_on_practices": [
        {
            "introduction": "在有限元法中，掌握数值求积的第一步是理解如何为精确积分多项式被积函数确定所需的求积阶数。本练习  提供了一个涉及单元荷载向量的基础场景，其中被积函数的复杂性源于形函数、外力场以及一个简单的仿射映射。通过这个练习，你将训练分析被积函数多项式次数的基本技能，这是确保任何有限元计算准确性的第一步。",
            "id": "3598711",
            "problem": "考虑一个 $p$ 阶的二维 (2D) 四边形有限元，在有限元方法 (FEM) 中记为 $Q_{p}$ 单元。该单元通过仿射映射，从具有参数坐标 $(\\xi,\\eta)$ 的双单位正方形参考域 $\\hat{\\Omega} = [-1,1] \\times [-1,1]$ 映射到物理域 $\\Omega_{e}$，其映射关系为\n$$\nx(\\xi,\\eta) = a_{0} + a_{1}\\,\\xi + a_{2}\\,\\eta, \\quad y(\\xi,\\eta) = b_{0} + b_{1}\\,\\xi + b_{2}\\,\\eta,\n$$\n其中 $a_{0}, a_{1}, a_{2}, b_{0}, b_{1}, b_{2}$ 是常数。该映射具有一个常数雅可比行列式 $J$。\n\n设单位体积的体力是物理坐标 $(x,y)$ 的一个二次多项式，\n$$\nb(x,y) = c_{0} + c_{1}\\,x + c_{2}\\,y + c_{3}\\,x^{2} + c_{4}\\,x\\,y + c_{5}\\,y^{2},\n$$\n其中 $c_{0}, c_{1}, c_{2}, c_{3}, c_{4}, c_{5}$ 是常数。考虑与 $Q_{p}$ 单元的节点形函数 $N_{i}(\\xi,\\eta)$ 相关联的单个标量自由度，该形函数是关于 $\\xi$ 和 $\\eta$ 的 $p$ 次一维拉格朗日多项式的张量积。\n\n与节点 $i$ 相关联的单元荷载向量分量为\n$$\nf_{i} = \\int_{\\Omega_{e}} N_{i}(x,y)\\,b(x,y)\\,\\mathrm{d}\\Omega = \\int_{\\hat{\\Omega}} N_{i}(\\xi,\\eta)\\,b\\big(x(\\xi,\\eta),y(\\xi,\\eta)\\big)\\,J\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta.\n$$\n假设该积分将使用张量积高斯-勒让德求积法进行计算，在 $\\xi$ 和 $\\eta$ 方向上各有 $n$ 个求积点。\n\n仅利用仿射映射下多项式次数的基本性质以及高斯-勒让德求积对多项式的精确性，确定对于任意二次体力 $b(x,y)$ 和任意具有仿射映射的 $Q_{p}$ 单元，要精确积分 $f_{i}$ 所需的每个方向上高斯-勒让德求积点的最小数量 $n$。将最终答案表示为关于 $p$ 的闭式解析表达式。无需进行数值计算，也无需四舍五入。给出 $n$ 的表达式。",
            "solution": "该问题要求确定为了精确数值积分单元荷载向量分量 $f_i$，每个方向上所需的高斯-勒让德求积点的最小数量 $n$。需要计算的积分为：\n$$\nf_{i} = \\int_{\\hat{\\Omega}} N_{i}(\\xi,\\eta)\\,b\\big(x(\\xi,\\eta),y(\\xi,\\eta)\\big)\\,J\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta\n$$\n其中积分域为双单位正方形 $\\hat{\\Omega} = [-1,1] \\times [-1,1]$。该积分使用张量积高斯-勒让德求积方案进行，在 $\\xi$ 方向和 $\\eta$ 方向上各有 $n$ 个点。\n\n一维 $n$ 点高斯-勒让德求积法则的基本性质是，它可以精确积分次数最高为 $2n-1$ 的任意多项式。对于张量积法则，此性质在每个方向上独立适用。因此，为了找到所需的最小 $n$ 值，我们必须首先分别确定被积多项式关于 $\\xi$ 和 $\\eta$ 的最高次数。\n\n设被积函数为 $g(\\xi,\\eta) = N_{i}(\\xi,\\eta)\\,b\\big(x(\\xi,\\eta),y(\\xi,\\eta)\\big)\\,J$。我们将分析此乘积中每一项的多项式次数。我们使用 $P_{k}(z)$ 表示变量 $z$ 的一个 $k$ 次多项式。\n\n1.  **形函数 $N_{i}(\\xi,\\eta)$**：该单元是 $Q_{p}$ 四边形单元。其形函数 $N_{i}(\\xi,\\eta)$ 是由 $p$ 次一维拉格朗日多项式的张量积构造而成。这意味着对于任意固定的 $\\eta$，$N_{i}(\\xi,\\eta)$ 是关于 $\\xi$ 的 $p$ 次多项式；对于任意固定的 $\\xi$，$N_{i}(\\xi,\\eta)$ 是关于 $\\eta$ 的 $p$ 次多项式。\n\n2.  **坐标映射 $x(\\xi,\\eta)$ 和 $y(\\xi,\\eta)$**：从参考域 $(\\xi,\\eta)$ 到物理域 $(x,y)$ 的映射是仿射的，由以下公式给出：\n    $$\n    x(\\xi,\\eta) = a_{0} + a_{1}\\,\\xi + a_{2}\\,\\eta\n    $$\n    $$\n    y(\\xi,\\eta) = b_{0} + b_{1}\\,\\xi + b_{2}\\,\\eta\n    $$\n    根据这些定义，$x(\\xi,\\eta)$ 是关于 $\\xi$ 的 1 次多项式和关于 $\\eta$ 的 1 次多项式。类似地，$y(\\xi,\\eta)$ 也是关于 $\\xi$ 的 1 次多项式和关于 $\\eta$ 的 1 次多项式。\n\n3.  **映射后的体力 $b(x,y)$**：体力 $b(x,y)$ 是物理坐标 $(x,y)$ 的一个二次多项式：\n    $$\n    b(x,y) = c_{0} + c_{1}\\,x + c_{2}\\,y + c_{3}\\,x^{2} + c_{4}\\,x\\,y + c_{5}\\,y^{2}\n    $$\n    为了找到 $b$ 关于参考坐标 $(\\xi,\\eta)$ 的次数，我们将映射函数代入此表达式。复合函数 $b(x(\\xi,\\eta), y(\\xi,\\eta))$ 的次数由最高次项决定，即 $x^2$、$xy$ 和 $y^2$。由于 $x$ 和 $y$ 都是关于 $\\xi$ 和 $\\eta$ 的 1 次多项式，它们的平方（$x^2$, $y^2$）和乘积（$xy$）将是关于 $\\xi$ 最高为 2 次、关于 $\\eta$ 最高为 2 次的多项式。例如，项 $x^2$ 变为 $(a_0 + a_1\\xi + a_2\\eta)^2 = a_1^2 \\xi^2 + \\dots$，这是关于 $\\xi$ 的 2 次多项式。同样的逻辑适用于所有二次项和两个变量。因此，$b(x(\\xi,\\eta), y(\\xi,\\eta))$ 是一个关于 $\\xi$ 最高为 2 次、关于 $\\eta$ 最高为 2 次的多项式。\n\n4.  **雅可比行列式 $J$**：问题陈述指明映射是仿射的，这导致雅可比行列式 $J$ 为常数。常数是 0 次多项式。\n\n现在，我们确定完整被积函数 $g(\\xi,\\eta)$ 的次数。由于多项式乘积的次数是各因子次数之和，我们可以分别求出 $g(\\xi,\\eta)$ 在每个变量中的次数。\n\n-   $g(\\xi,\\eta)$ 关于变量 $\\xi$ 的次数是其各因子关于 $\\xi$ 的次数之和：\n    $$\n    \\deg_{\\xi}(g) = \\deg_{\\xi}(N_i) + \\deg_{\\xi}(b) + \\deg_{\\xi}(J) = p + 2 + 0 = p+2\n    $$\n-   类似地，$g(\\xi,\\eta)$ 关于变量 $\\eta$ 的次数是：\n    $$\n    \\deg_{\\eta}(g) = \\deg_{\\eta}(N_i) + \\deg_{\\eta}(b) + \\deg_{\\eta}(J) = p + 2 + 0 = p+2\n    $$\n\n被积函数是关于 $\\xi$ 的 $p+2$ 次多项式，以及关于 $\\eta$ 的 $p+2$ 次多项式。要使用 $n$ 点高斯-勒让德求积法则精确积分此多项式，该法则必须对次数最高为 $p+2$ 的多项式是精确的。精确性条件为：\n$$\n2n - 1 \\ge \\deg(\\text{polynomial})\n$$\n将此条件应用于我们在 $\\xi$ 或 $\\eta$ 方向上的被积函数，我们得到：\n$$\n2n - 1 \\ge p + 2\n$$\n我们必须找到满足此不等式的最小整数 $n$。\n$$\n2n \\ge p + 3\n$$\n$$\nn \\ge \\frac{p+3}{2}\n$$\n由于 $n$ 必须是代表求积点数量的整数，我们必须取满足此条件的最小整数。这可以通过对右侧表达式向上取整来实现。\n$$\nn = \\left\\lceil \\frac{p+3}{2} \\right\\rceil\n$$\n这就是精确积分单元荷载向量分量所需的每个方向上高斯-勒让德求积点的最小数量。该表达式是关于 $p$ 的一个闭式解析函数。",
            "answer": "$$\n\\boxed{\\left\\lceil \\frac{p+3}{2} \\right\\rceil}\n$$"
        },
        {
            "introduction": "在第一个练习的基础上，我们现在考虑一个更贴近实际且更复杂的场景：等参单元。当单元的几何形状是弯曲时，从参考域到物理域的映射雅可比行列式将不再是一个常数，这为被积函数增加了额外的复杂性。本练习  探讨了在为一致质量矩阵确定求积阶数时，如何考虑非恒定雅可比行列式的影响，这是在包含扭曲或弯曲单元的模型中精确模拟动力学问题的关键一步。",
            "id": "3598631",
            "problem": "考虑一个二维等参四边形有限元，其具有二次形函数（一个 $Q_2$ 单元），用于在瞬态结构动力学的有限元法（FEM）中计算一致质量矩阵。设从双单位母正方形 $[-1,1]\\times[-1,1]$ 到物理单元的物理映射 $\\boldsymbol{x}(\\xi,\\eta)$ 由与场插值相同的二次形函数定义，因此 $\\boldsymbol{x}(\\xi,\\eta)$ 在母坐标 $\\xi$ 和 $\\eta$ 中是双二次的。假设质量密度 $\\rho$ 为常数且厚度为单位1，则一致单元质量矩阵的各项由下式给出\n$$\nM_{ij}=\\int_{\\Omega_e} \\rho\\,N_i(\\boldsymbol{x})\\,N_j(\\boldsymbol{x})\\,\\mathrm{d}\\Omega\n=\\int_{-1}^{1}\\int_{-1}^{1} \\rho\\,N_i(\\xi,\\eta)\\,N_j(\\xi,\\eta)\\,\\det J(\\xi,\\eta)\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta,\n$$\n其中 $N_i(\\xi,\\eta)$ 和 $N_j(\\xi,\\eta)$ 是母域上的双二次形函数，$\\det J(\\xi,\\eta)$ 是等参映射的雅可比矩阵的行列式。您需要选择一个每方向有 $n$ 个点的高斯-勒让德张量积求积法，以精确积分上述表达式。\n\n仅从以下几点出发：(i) 母域上的一致质量被积函数定义为 $N_i(\\xi,\\eta)\\,N_j(\\xi,\\eta)\\,\\det J(\\xi,\\eta)$，(ii) $Q_2$ 形函数在每个母坐标中都是二次的，(iii) 雅可比矩阵项被链式法则描述为映射的一阶导数，以及 (iv) 一维 $n$ 点高斯-勒让德法则对于次数最高为 $2n-1$ 的多项式具有经过充分检验的精确性。请确定被积函数 $N_i(\\xi,\\eta)\\,N_j(\\xi,\\eta)\\,\\det J(\\xi,\\eta)$ 在每个母坐标 $(\\xi,\\eta)$ 中的最高多项式次数，并由此选择最小整数 $n$，使得张量积 $n\\times n$ 高斯-勒让德法则在 $[-1,1]\\times[-1,1]$ 上对该被积函数是精确的。\n\n请仅提供最小整数 $n$ 作为最终答案。无需四舍五入。",
            "solution": "用户提供了一个来自计算固体力学领域的有效且适定的问题陈述。目标是确定张量积高斯-勒让德法则所需的最小求积点数 $n$，以便精确积分一个双二次 ($Q_2$) 等参单元的一致质量矩阵。\n\n在母域上计算的一致质量矩阵项的积分由下式给出：\n$$\nM_{ij} = \\int_{-1}^{1}\\int_{-1}^{1} \\rho\\,N_i(\\xi,\\eta)\\,N_j(\\xi,\\eta)\\,\\det J(\\xi,\\eta)\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta\n$$\n质量密度 $\\rho$ 假设为常数，因此不影响被积函数的多项式次数。被积函数为 $I(\\xi, \\eta) = N_i(\\xi,\\eta)\\,N_j(\\xi,\\eta)\\,\\det J(\\xi,\\eta)$。\n\n一维 $n$ 点高斯-勒让德求积法则能精确积分任何次数最高为 $2n-1$ 的多项式。对于在每个方向 $(\\xi, \\eta)$ 上有 $n$ 个点的二维张量积法则，如果被积函数在 $\\xi$ 和 $\\eta$ 上的多项式次数分别最多为 $2n-1$，则积分是精确的。因此，我们的任务是确定 $I(\\xi, \\eta)$ 关于 $\\xi$ 和 $\\eta$ 的最高多项式次数。令 $P_\\xi(f)$ 和 $P_\\eta(f)$ 分别表示函数 $f(\\xi,\\eta)$ 在变量 $\\xi$ 和 $\\eta$ 中的多项式次数。\n\n1.  **形函数乘积 $N_i(\\xi,\\eta)\\,N_j(\\xi,\\eta)$ 的多项式次数**\n    问题陈述该单元是 $Q_2$ 单元，意味着其形函数 $N_k(\\xi,\\eta)$ 是双二次的。一个双二次函数在每个变量 $\\xi$ 和 $\\eta$ 中都是2次多项式。因此，对于任何形函数 $N_k(\\xi,\\eta)$：\n    $$\n    P_\\xi(N_k) = 2 \\quad \\text{and} \\quad P_\\eta(N_k) = 2\n    $$\n    两个此类形函数的乘积 $N_i(\\xi,\\eta)N_j(\\xi,\\eta)$ 的次数将是各函数次数之和：\n    $$\n    P_\\xi(N_i N_j) = P_\\xi(N_i) + P_\\xi(N_j) = 2 + 2 = 4\n    $$\n    $$\n    P_\\eta(N_i N_j) = P_\\eta(N_i) + P_\\eta(N_j) = 2 + 2 = 4\n    $$\n\n2.  **雅可比行列式 $\\det J(\\xi,\\eta)$ 的多项式次数**\n    从母坐标到物理坐标的映射是等参的，由相同的形函数定义：\n    $$\n    \\boldsymbol{x}(\\xi,\\eta) = \\begin{pmatrix} x(\\xi,\\eta) \\\\ y(\\xi,\\eta) \\end{pmatrix} = \\sum_{k=1}^{9} \\begin{pmatrix} x_k \\\\ y_k \\end{pmatrix} N_k(\\xi,\\eta)\n    $$\n    由于 $N_k(\\xi,\\eta)$ 是双二次的，映射函数 $x(\\xi,\\eta)$ 和 $y(\\xi,\\eta)$ 也是关于 $\\xi$ 和 $\\eta$ 的双二次多项式。\n    $$\n    P_\\xi(x) = 2, \\quad P_\\eta(x) = 2\n    $$\n    $$\n    P_\\xi(y) = 2, \\quad P_\\eta(y) = 2\n    $$\n    雅可比矩阵 $J$ 包含映射的偏导数：\n    $$\n    J(\\xi,\\eta) = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix}\n    $$\n    我们确定每个矩阵项的多项式次数。对一个变量求导会使其多项式次数减1。\n    -   $P_\\xi\\left(\\frac{\\partial x}{\\partial \\xi}\\right) = P_\\xi(x) - 1 = 2-1 = 1$; \\quad $P_\\eta\\left(\\frac{\\partial x}{\\partial \\xi}\\right) = P_\\eta(x) = 2$。\n    -   $P_\\xi\\left(\\frac{\\partial y}{\\partial \\xi}\\right) = P_\\xi(y) - 1 = 2-1 = 1$; \\quad $P_\\eta\\left(\\frac{\\partial y}{\\partial \\xi}\\right) = P_\\eta(y) = 2$。\n    -   $P_\\xi\\left(\\frac{\\partial x}{\\partial \\eta}\\right) = P_\\xi(x) = 2$; \\quad $P_\\eta\\left(\\frac{\\partial x}{\\partial \\eta}\\right) = P_\\eta(x) - 1 = 2-1 = 1$。\n    -   $P_\\xi\\left(\\frac{\\partial y}{\\partial \\eta}\\right) = P_\\xi(y) = 2$; \\quad $P_\\eta\\left(\\frac{\\partial y}{\\partial \\eta}\\right) = P_\\eta(y) - 1 = 2-1 = 1$。\n\n    雅可比行列式为 $\\det J = \\frac{\\partial x}{\\partial \\xi}\\frac{\\partial y}{\\partial \\eta} - \\frac{\\partial x}{\\partial \\eta}\\frac{\\partial y}{\\partial \\xi}$。多项式乘积的次数是它们次数的总和。和或差的次数是各项次数的最大值（假设最高阶项没有抵消，这对于一般单元几何形状是成立的）。\n    \n    关于 $\\xi$ 的次数：\n    -   $P_\\xi\\left(\\frac{\\partial x}{\\partial \\xi}\\frac{\\partial y}{\\partial \\eta}\\right) = P_\\xi\\left(\\frac{\\partial x}{\\partial \\xi}\\right) + P_\\xi\\left(\\frac{\\partial y}{\\partial \\eta}\\right) = 1 + 2 = 3$。\n    -   $P_\\xi\\left(\\frac{\\partial x}{\\partial \\eta}\\frac{\\partial y}{\\partial \\xi}\\right) = P_\\xi\\left(\\frac{\\partial x}{\\partial \\eta}\\right) + P_\\xi\\left(\\frac{\\partial y}{\\partial \\xi}\\right) = 2 + 1 = 3$。\n    因此，$\\det J$ 在 $\\xi$ 中的最高次数为 $P_\\xi(\\det J) = 3$。\n\n    关于 $\\eta$ 的次数：\n    -   $P_\\eta\\left(\\frac{\\partial x}{\\partial \\xi}\\frac{\\partial y}{\\partial \\eta}\\right) = P_\\eta\\left(\\frac{\\partial x}{\\partial \\xi}\\right) + P_\\eta\\left(\\frac{\\partial y}{\\partial \\eta}\\right) = 2 + 1 = 3$。\n    -   $P_\\eta\\left(\\frac{\\partial x}{\\partial \\eta}\\frac{\\partial y}{\\partial \\xi}\\right) = P_\\eta\\left(\\frac{\\partial x}{\\partial \\eta}\\right) + P_\\eta\\left(\\frac{\\partial y}{\\partial \\xi}\\right) = 1 + 2 = 3$。\n    因此，$\\det J$ 在 $\\eta$ 中的最高次数为 $P_\\eta(\\det J) = 3$。\n\n3.  **完整被积函数 $I(\\xi, \\eta)$ 的多项式次数**\n    现在我们可以求出完整被积函数 $I(\\xi, \\eta) = N_i N_j \\det J$ 的次数。\n    -   关于 $\\xi$ 的次数：$P_\\xi(I) = P_\\xi(N_i N_j) + P_\\xi(\\det J) = 4 + 3 = 7$。\n    -   关于 $\\eta$ 的次数：$P_\\eta(I) = P_\\eta(N_i N_j) + P_\\eta(\\det J) = 4 + 3 = 7$。\n\n4.  **最小求积阶数 $n$ 的确定**\n    被积函数在 $\\xi$ 和 $\\eta$ 中都是7次多项式。要使用具有 $n$ 个点的1D高斯-勒让德法则精确积分一个次数为 $p$ 的多项式，必须满足以下条件：\n    $$\n    2n - 1 \\ge p\n    $$\n    在我们的情况中，两个方向的 $p=7$。因此，我们需要：\n    $$\n    2n - 1 \\ge 7\n    $$\n    $$\n    2n \\ge 8\n    $$\n    $$\n    n \\ge 4\n    $$\n    满足此条件的最小整数值 $n$ 是 $n=4$。因此，需要一个 $4 \\times 4$ 点的张量积求积法则来保证对一个通用的 $Q_2$ 等参单元的一致质量矩阵进行精确积分。",
            "answer": "$$\\boxed{4}$$"
        },
        {
            "introduction": "前面的练习侧重于如何实现精确积分，但如果积分不精确，特别是当有意使用较低阶数（即减缩积分）时，会产生什么后果？本练习  将求积阶数的选择与有限元法中一个至关重要的实用概念——单元检验 (patch test) 联系起来。它揭示了为何不充分的积分会导致单元无法正确表示最简单的常应变状态，从而挑战你确定保证单元在任意形状下理论可靠性所需的最低求积阶数。",
            "id": "3598641",
            "problem": "考虑一个用于平面应力线性弹性问题有限元法 (FEM) 的二维等参双线性四边形单元。设母坐标为 $(\\xi,\\eta) \\in [-1,1] \\times [-1,1]$，且物理映射在等参插值的意义上是精确的：$x(\\xi,\\eta) = \\sum_{i=1}^{4} N_i(\\xi,\\eta)\\,x_i$, $y(\\xi,\\eta) = \\sum_{i=1}^{4} N_i(\\xi,\\eta)\\,y_i$，其中 $N_i(\\xi,\\eta)$ 是标准双线性形函数，$\\{(x_i,y_i)\\}$ 是形成一个一般扭曲双线性图像（不一定是仿射平行四边形）的任意节点坐标。对于由此类单元组成的单元片，线性单元片检验要求，当在所有节点上施加物理坐标系下的精确线性位移场时，\n$$\nu_x(x,y) = a + b\\,x + c\\,y, \\qquad u_y(x,y) = d + e\\,x + f\\,y,\n$$\n其中 $a,b,c,d,e,f \\in \\mathbb{R}$，组装后的内力必须能再现精确的连续介质响应，这等效于确保内虚功的一致性。在单元列式中，节点 $i$ 的内力向量为\n$$\n\\mathbf{r}_i = \\int_{\\Omega_e} \\mathbf{B}_i^{\\top}\\,\\boldsymbol{\\sigma}\\,\\mathrm{d}\\Omega,\n$$\n其中 $\\Omega_e$ 是物理坐标系中的单元域，$\\boldsymbol{\\sigma} = \\mathbf{D}\\,\\boldsymbol{\\epsilon}$ 是柯西应力，$\\mathbf{D}$ 是各向同性平面应力问题的常数材料矩阵，$\\boldsymbol{\\epsilon}$ 是小应变张量。使用精确的等参映射，这在母坐标系下等效地写为\n$$\n\\mathbf{r}_i = \\int_{-1}^{1}\\!\\!\\int_{-1}^{1} \\widehat{\\mathbf{B}}_i^{\\top}(\\xi,\\eta)\\,\\mathbf{J}^{-\\,\\top}(\\xi,\\eta)\\,\\boldsymbol{\\sigma}\\,\\det\\mathbf{J}(\\xi,\\eta)\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta,\n$$\n其中 $\\mathbf{J}$ 是映射的雅可比矩阵，$\\widehat{\\mathbf{B}}_i$ 包含 $N_i$ 关于 $(\\xi,\\eta)$ 的导数。对于物理坐标系中的线性位移场，$\\boldsymbol{\\epsilon}$ 以及 $\\boldsymbol{\\sigma}$ 均为常数。\n\n在每个参数方向上采用 $n$ 阶张量积高斯-勒让德求积法时，线性单元片检验的精确性取决于进入 $\\mathbf{r}_i$ 的被积函数的多项式次数。对于一般的双线性几何扭曲，伴随矩阵 $\\mathrm{adj}(\\mathbf{J})$ 的元素是关于 $(\\xi,\\eta)$ 的线性函数，而 $\\widehat{\\mathbf{B}}_i$ 的元素也是关于 $(\\xi,\\eta)$ 的线性函数（每个导数都线性地依赖于一个参数）。因此，被积函数 $\\widehat{\\mathbf{B}}_i^{\\top}\\,\\mathbf{J}^{-\\,\\top}\\,\\boldsymbol{\\sigma}\\,\\det\\mathbf{J}$ 的分量通常包含双线性项，并且对于扭曲的映射，还包含由同一参数的线性函数相乘产生的二次项。在 $n=1$ 的减缩积分方案（在 $(\\xi,\\eta)=(0,0)$ 处进行单点求积）中，这些二次项贡献无法被精确积分，即使映射是精确的，线性单元片检验也可能失败。\n\n你需要确定每个参数方向上最小的张量积高斯求积阶数，记为 $n_{\\star}$，该阶数能保证对于任意双线性等参映射和平面应力问题中的常数各向同性材料系数，线性单元片检验都能精确满足。此外，请简要概述一种有原则的修正策略，当保留单点求积时，该策略能恢复单元片检验的一致性。其基础是增加一个恢复一致性的稳定项，通过将应变场投影到线性子空间上，来精确积分内虚功中缺失的二次项内容。\n\n请以单个整数 $n_{\\star}$ 的形式提供最终答案。无需四舍五入，$n_{\\star}$ 没有物理单位。",
            "solution": "该问题要求确定保证一个通用的二维等参双线性四边形单元能够满足线性单元片检验的最小张量积高斯-勒让德求积阶数 $n_{\\star}$。此外，还必须概述一种针对单点求积 ($n=1$) 的修正策略。\n\n首先，我们验证问题陈述的有效性。该问题是计算固体力学中一个标准的、适定的问题。它具有科学依据，是客观的，并包含足够的信息来求解。虽然描述性文本中关于被积函数多项式性质的陈述可能引起混淆（它似乎将内力向量的被积函数与刚度矩阵的被积函数相混淆），但其核心问题是有效的，并且可以根据既定原则得到确切答案。我们将通过一个不依赖于问题描述性文本中可疑部分的严格推导来继续。\n\n线性单元片检验验证了有限元列式是否能精确再现常应变状态。对于一个等参单元，当节点位移被设置为线性位移场 $u_x(x,y) = a + b\\,x + c\\,y$ 和 $u_y(x,y) = d + e\\,x + f\\,y$ 的值时，单元内的插值位移场会精确地再现这个线性场。因此，相应的应变张量 $\\boldsymbol{\\epsilon}$ 在整个单元内是恒定的，对于一个恒定的材料矩阵 $\\mathbf{D}$，应力张量 $\\boldsymbol{\\sigma} = \\mathbf{D}\\boldsymbol{\\epsilon}$ 也是恒定的。\n\n如果一个承受此常应力状态的单元片，其离散方程能被精确满足，则单元片检验通过。这等效于虚功方程成立的条件。由 Irons 建立的、通过单元片检验的一个关键充分条件是，数值求积法则必须能够精确积分单元的体积及其一次面积矩。这确保了单元列式对于常数场和线性场的行为是正确的。\n\n让我们在母坐标系 $(\\xi, \\eta) \\in [-1,1] \\times [-1,1]$ 中分析这些量的被积函数的多项式次数。\n\n1.  **单元面积（二维中的体积）：** 单元 $\\Omega_e$ 的面积由雅可比行列式在母域上的积分给出：\n    $$\n    A_e = \\int_{\\Omega_e} \\mathrm{d}A = \\int_{-1}^{1}\\int_{-1}^{1} \\det\\mathbf{J}(\\xi,\\eta)\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta\n    $$\n    映射为 $x(\\xi,\\eta) = \\sum_{i=1}^{4} N_i(\\xi,\\eta) x_i$ 和 $y(\\xi,\\eta) = \\sum_{i=1}^{4} N_i(\\xi,\\eta) y_i$，其中 $N_i$ 是双线性形函数，例如 $N_1 = \\frac{1}{4}(1-\\xi)(1-\\eta)$。物理坐标 $x$ 和 $y$ 因此是关于 $\\xi$ 和 $\\eta$ 的双线性函数。\n    雅可比矩阵 $\\mathbf{J}$ 的元素为：\n    $J_{11} = \\frac{\\partial x}{\\partial \\xi}$, $J_{12} = \\frac{\\partial y}{\\partial \\xi}$, $J_{21} = \\frac{\\partial x}{\\partial \\eta}$, $J_{22} = \\frac{\\partial y}{\\partial \\eta}$。\n    由于 $x$ 和 $y$ 是双线性的，它们关于 $\\xi$ 的导数是 $\\eta$ 的线性函数，而它们关于 $\\eta$ 的导数是 $\\xi$ 的线性函数。例如，$\\frac{\\partial x}{\\partial \\xi}$ 的形式为 $k_1 + k_2\\eta$，而 $\\frac{\\partial x}{\\partial \\eta}$ 的形式为 $k_3 + k_4\\xi$。\n    雅可比行列式为 $\\det\\mathbf{J} = J_{11}J_{22} - J_{12}J_{21}$。这是一个 $\\eta$ 的线性函数与一个 $\\xi$ 的线性函数的乘积，减去另一个类似的乘积。结果是一个关于 $\\xi$ 和 $\\eta$ 的双线性多项式：\n    $$\n    \\det\\mathbf{J}(\\xi,\\eta) = c_0 + c_1\\xi + c_2\\eta + c_3\\xi\\eta\n    $$\n    一个 $n$ 点高斯-勒让德法则可以精确积分最高为 $2n-1$ 次的多项式。要在一个变量上精确积分一个线性函数（1次），我们需要 $2n-1 \\ge 1 \\implies n \\ge 1$。一个 $n=1$ 阶的张量积法则（即 $1 \\times 1$ 点）足以精确积分任何双线性多项式。因此，单点求积可以精确地积分面积。\n\n2.  **一次面积矩：** 关于 $y$ 轴的一次面积矩为：\n    $$\n    M_y = \\int_{\\Omega_e} x\\,\\mathrm{d}A = \\int_{-1}^{1}\\int_{-1}^{1} x(\\xi,\\eta) \\det\\mathbf{J}(\\xi,\\eta)\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta\n    $$\n    被积函数是物理坐标 $x(\\xi,\\eta)$ 和雅可比行列式 $\\det\\mathbf{J}(\\xi,\\eta)$ 的乘积。如前所述，$x(\\xi,\\eta)$ 和 $\\det\\mathbf{J}(\\xi,\\eta)$ 都是双线性多项式。两个双线性多项式的乘积是一个双二次多项式，包含高达 $\\xi^2$、$\\eta^2$ 和 $\\xi^2\\eta^2$ 的项。其一般形式为：\n    $$\n    p(\\xi,\\eta) = \\sum_{j=0}^{2} \\sum_{k=0}^{2} c_{jk} \\xi^j \\eta^k\n    $$\n    在 $\\xi$ 方向上的最高多项式次数为2，$\\eta$ 方向也类似。要在一维上精确积分一个二次多项式（2次），高斯-勒让德法则必须具有一个阶数 $n$，使得：\n    $$\n    2n - 1 \\ge 2 \\implies 2n \\ge 3 \\implies n \\ge 1.5\n    $$\n    由于求积点数 $n$ 必须是整数，所以所需的最小阶数为 $n=2$。同样的逻辑也适用于一次矩 $M_x = \\int y\\,\\mathrm{d}A = \\int y(\\xi,\\eta)\\det\\mathbf{J} d\\xi d\\eta$。\n    因此，为保证任意扭曲的双线性四边形单元能满足线性单元片检验，至少需要 $2 \\times 2$ 个高斯求积点。每个方向的最小阶数为 $n_{\\star}=2$。\n\n关于问题的第二部分，有必要提出一种有原则的修正策略，以在使用单点求积（$n=1$）时恢复单元片检验的一致性，因为对于扭曲单元，该法则无法精确积分一次面积矩。这种失败会导致在常应力下对内力向量的计算不正确。修正的核心思想是修改列式，使得数值计算的内功与常应力单元片的精确连续介质值相匹配。\n\n一个众所周知的策略是 $\\bar{\\mathbf{B}}$（“B-bar”）方法。节点 $i$ 的内力向量计算为 $\\mathbf{r}_i = \\int_{\\Omega_e} \\mathbf{B}_i^{\\top}\\boldsymbol{\\sigma}\\,\\mathrm{d}\\Omega$。对于常应力状态，这变为 $\\mathbf{r}_i = (\\int_{\\Omega_e} \\mathbf{B}_i^{\\top}\\,\\mathrm{d}\\Omega)\\boldsymbol{\\sigma}$。如果积分项被精确计算，则单元片检验通过。我们定义一个平均应变-位移矩阵 $\\bar{\\mathbf{B}}_i$ 为：\n$$\n\\bar{\\mathbf{B}}_i = \\frac{1}{A_e} \\int_{\\Omega_e} \\mathbf{B}_i\\,\\mathrm{d}\\Omega = \\frac{1}{\\int_{-1}^{1}\\!\\!\\int_{-1}^{1} \\det\\mathbf{J}\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta} \\int_{-1}^{1}\\!\\!\\int_{-1}^{1} \\mathbf{B}_i(\\xi,\\eta)\\,\\det\\mathbf{J}(\\xi,\\eta)\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta\n$$\n分子中的被积函数 $\\mathbf{B}_i\\,\\det\\mathbf{J}$ 的分量是关于 $(\\xi,\\eta)$ 的双线性函数。例如，分量 $(\\partial N_i/\\partial x)\\det\\mathbf{J}$ 是双线性的。如前所示，一个双线性函数可以由在 $(\\xi,\\eta)=(0,0)$ 处的单个高斯点精确积分。分母 $A_e = \\int \\det\\mathbf{J}\\,d\\xi d\\eta$ 也可以由单点求积精确积分。因此，$\\bar{\\mathbf{B}}_i$ 可以仅使用单元中心的信息来精确计算：\n$$\n\\bar{\\mathbf{B}}_i = \\frac{\\mathbf{B}_i(0,0)\\,\\det\\mathbf{J}(0,0)}{\\det\\mathbf{J}(0,0)} = \\mathbf{B}_i(0,0)\n$$\n这似乎导致了一个悖论。错误在于，虽然双线性函数的积分可以由单点法则精确给出，但函数本身并非恒定。$\\bar{\\mathbf{B}}$ 方法的理念是用其精确平均值 $\\bar{\\mathbf{B}}_i$ 来替代空间变化的 $\\mathbf{B}_i$。然后内力向量计算为 $\\mathbf{r}_i = \\bar{\\mathbf{B}}_i^{\\top} \\boldsymbol{\\sigma} A_e$。通过使用精确平均的应变-位移矩阵，内功在常应力场下被正确计算，从而恢复了单元片检验的一致性。这是将应变场投影到单元上的常应变空间，这正是单元片检验所要求的。增加的“稳定化”隐含在这种修正的列式中，它防止了因轻率地对扭曲几何形状使用 $\\mathbf{B}_i(0,0)$ 而产生的误差。",
            "answer": "$$\\boxed{2}$$"
        }
    ]
}