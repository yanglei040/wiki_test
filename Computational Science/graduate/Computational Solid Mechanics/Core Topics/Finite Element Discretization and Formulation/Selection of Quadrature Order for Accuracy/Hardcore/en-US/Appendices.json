{
    "hands_on_practices": [
        {
            "introduction": "This first exercise establishes the foundational skill for selecting a quadrature rule: analyzing the polynomial degree of the integrand. We will consider a straightforward case involving a $Q_p$ element with a simple, affine geometry to determine the minimum Gauss order needed to exactly integrate a polynomial body force. This practice  reinforces the direct relationship between the order of shape functions, $p$, the complexity of external fields, and the requirements for numerical accuracy.",
            "id": "3598711",
            "problem": "Consider a Two-Dimensional (2D) quadrilateral finite element of order $p$, denoted as a $Q_{p}$ element within the Finite Element Method (FEM). The element is mapped affinely from the bi-unit square reference domain $\\hat{\\Omega} = [-1,1] \\times [-1,1]$ with parametric coordinates $(\\xi,\\eta)$ to the physical domain $\\Omega_{e}$ by\n$$\nx(\\xi,\\eta) = a_{0} + a_{1}\\,\\xi + a_{2}\\,\\eta, \\quad y(\\xi,\\eta) = b_{0} + b_{1}\\,\\xi + b_{2}\\,\\eta,\n$$\nwhere $a_{0}, a_{1}, a_{2}, b_{0}, b_{1}, b_{2}$ are constants. This mapping has a constant Jacobian determinant $J$.\n\nLet the body force per unit volume be a quadratic polynomial in the physical coordinates $(x,y)$,\n$$\nb(x,y) = c_{0} + c_{1}\\,x + c_{2}\\,y + c_{3}\\,x^{2} + c_{4}\\,x\\,y + c_{5}\\,y^{2},\n$$\nwhere $c_{0}, c_{1}, c_{2}, c_{3}, c_{4}, c_{5}$ are constants. Consider a single scalar degree of freedom associated with the nodal shape function $N_{i}(\\xi,\\eta)$ of the $Q_{p}$ element, which is the tensor product of one-dimensional Lagrange polynomials of degree $p$ in $\\xi$ and in $\\eta$.\n\nThe elemental load vector component associated with node $i$ is\n$$\nf_{i} = \\int_{\\Omega_{e}} N_{i}(x,y)\\,b(x,y)\\,\\mathrm{d}\\Omega = \\int_{\\hat{\\Omega}} N_{i}(\\xi,\\eta)\\,b\\big(x(\\xi,\\eta),y(\\xi,\\eta)\\big)\\,J\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta.\n$$\nAssume the integral is to be evaluated using a tensor-product Gauss–Legendre quadrature with $n$ points in each of the $\\xi$ and $\\eta$ directions.\n\nUsing only foundational properties of polynomial degree under affine maps and the exactness of Gauss–Legendre quadrature on polynomials, determine the minimal number $n$ of Gauss–Legendre points per direction required to integrate $f_{i}$ exactly for any quadratic body force $b(x,y)$ and any $Q_{p}$ element with affine mapping. Express your final answer as a closed-form analytic expression in terms of $p$. No numerical evaluation is required, and no rounding is needed. Provide the expression for $n$.",
            "solution": "The problem requires determining the minimal number of Gauss-Legendre quadrature points, $n$, per direction required for the exact numerical integration of an elemental load vector component, $f_i$. The integral to be evaluated is given by:\n$$\nf_{i} = \\int_{\\hat{\\Omega}} N_{i}(\\xi,\\eta)\\,b\\big(x(\\xi,\\eta),y(\\xi,\\eta)\\big)\\,J\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta\n$$\nwhere the integration domain is the bi-unit square $\\hat{\\Omega} = [-1,1] \\times [-1,1]$. The integration is performed using a tensor-product Gauss-Legendre quadrature scheme with $n$ points in the $\\xi$-direction and $n$ points in the $\\eta$-direction.\n\nThe fundamental property of a one-dimensional $n$-point Gauss-Legendre quadrature rule is that it can exactly integrate any polynomial of degree up to $2n-1$. For a tensor-product rule, this property applies independently in each direction. Therefore, to find the minimum required $n$, we must first determine the maximum degree of the integrand polynomial with respect to $\\xi$ and $\\eta$ individually.\n\nLet the integrand be denoted by $g(\\xi,\\eta) = N_{i}(\\xi,\\eta)\\,b\\big(x(\\xi,\\eta),y(\\xi,\\eta)\\big)\\,J$. We will analyze the polynomial degree of each term in this product. We use $P_{k}(z)$ to denote a polynomial of degree $k$ in the variable $z$.\n\n1.  **Shape Function $N_{i}(\\xi,\\eta)$**: The element is a $Q_{p}$ quadrilateral element. Its shape functions $N_{i}(\\xi,\\eta)$ are constructed as a tensor product of one-dimensional Lagrange polynomials of degree $p$. This means that $N_{i}(\\xi,\\eta)$ is a polynomial of degree $p$ in $\\xi$ for any fixed $\\eta$, and a polynomial of degree $p$ in $\\eta$ for any fixed $\\xi$.\n\n2.  **Coordinate Mapping $x(\\xi,\\eta)$ and $y(\\xi,\\eta)$**: The mapping from the reference domain $(\\xi,\\eta)$ to the physical domain $(x,y)$ is affine, given by:\n    $$\n    x(\\xi,\\eta) = a_{0} + a_{1}\\,\\xi + a_{2}\\,\\eta\n    $$\n    $$\n    y(\\xi,\\eta) = b_{0} + b_{1}\\,\\xi + b_{2}\\,\\eta\n    $$\n    From these definitions, $x(\\xi,\\eta)$ is a polynomial of degree $1$ in $\\xi$ and degree $1$ in $\\eta$. Similarly, $y(\\xi,\\eta)$ is a polynomial of degree $1$ in $\\xi$ and degree $1$ in $\\eta$.\n\n3.  **Body Force $b(x,y)$ after Mapping**: The body force $b(x,y)$ is a quadratic polynomial in the physical coordinates $(x,y)$:\n    $$\n    b(x,y) = c_{0} + c_{1}\\,x + c_{2}\\,y + c_{3}\\,x^{2} + c_{4}\\,x\\,y + c_{5}\\,y^{2}\n    $$\n    To find the degree of $b$ in terms of the reference coordinates $(\\xi,\\eta)$, we substitute the mapping functions into this expression. The degree of the composite function $b(x(\\xi,\\eta), y(\\xi,\\eta))$ is determined by the highest-degree terms, which are $x^2$, $xy$, and $y^2$. Since $x$ and $y$ are polynomials of degree $1$ in $\\xi$ and $\\eta$, their squares ($x^2$, $y^2$) and product ($xy$) will be polynomials of at most degree $2$ in $\\xi$ and at most degree $2$ in $\\eta$. For example, the term $x^2$ becomes $(a_0 + a_1\\xi + a_2\\eta)^2 = a_1^2 \\xi^2 + \\dots$, which is of degree $2$ in $\\xi$. The same logic applies to all quadratic terms and both variables. Therefore, $b(x(\\xi,\\eta), y(\\xi,\\eta))$ is a polynomial of degree at most $2$ in $\\xi$ and at most $2$ in $\\eta$.\n\n4.  **Jacobian Determinant $J$**: The problem statement specifies that the mapping is affine, which results in a constant Jacobian determinant, $J$. A constant is a polynomial of degree $0$.\n\nNow, we determine the degree of the complete integrand $g(\\xi,\\eta)$. Since the degree of a product of polynomials is the sum of the degrees of the factors, we can find the degree of $g(\\xi,\\eta)$ in each variable separately.\n\n-   The degree of $g(\\xi,\\eta)$ in the variable $\\xi$ is the sum of the degrees of its factors in $\\xi$:\n    $$\n    \\deg_{\\xi}(g) = \\deg_{\\xi}(N_i) + \\deg_{\\xi}(b) + \\deg_{\\xi}(J) = p + 2 + 0 = p+2\n    $$\n-   Similarly, the degree of $g(\\xi,\\eta)$ in the variable $\\eta$ is:\n    $$\n    \\deg_{\\eta}(g) = \\deg_{\\eta}(N_i) + \\deg_{\\eta}(b) + \\deg_{\\eta}(J) = p + 2 + 0 = p+2\n    $$\n\nThe integrand is a polynomial of degree $p+2$ in $\\xi$ and $p+2$ in $\\eta$. To integrate this polynomial exactly using an $n$-point Gauss-Legendre quadrature rule, the rule must be exact for polynomials of degree up to $p+2$. The condition for exactness is:\n$$\n2n - 1 \\ge \\deg(\\text{polynomial})\n$$\nApplying this condition for our integrand in either the $\\xi$ or $\\eta$ direction, we have:\n$$\n2n - 1 \\ge p + 2\n$$\nWe must find the minimal integer $n$ that satisfies this inequality.\n$$\n2n \\ge p + 3\n$$\n$$\nn \\ge \\frac{p+3}{2}\n$$\nSince $n$ must be an integer representing the number of quadrature points, we must take the smallest integer that satisfies this condition. This is achieved by taking the ceiling of the expression on the right-hand side.\n$$\nn = \\left\\lceil \\frac{p+3}{2} \\right\\rceil\n$$\nThis is the minimal number of Gauss-Legendre points per direction required to integrate the elemental load vector component exactly. This expression is a closed-form analytic function of $p$.",
            "answer": "$$\n\\boxed{\\left\\lceil \\frac{p+3}{2} \\right\\rceil}\n$$"
        },
        {
            "introduction": "Building upon the basics, this practice introduces the complexity of non-affine, or isoparametric, mappings, which are essential for modeling curved geometries. You will determine the required quadrature order for the consistent mass matrix of a quadratic ($Q_2$) element, where the Jacobian determinant itself is a polynomial. This exercise  highlights how geometric representation directly influences the required computational effort for accurate integration.",
            "id": "3598631",
            "problem": "Consider a two-dimensional isoparametric quadrilateral finite element with quadratic shape functions (a $Q_2$ element), used to compute the consistent mass matrix in the Finite Element Method (FEM) for transient structural dynamics. Let the physical mapping $\\boldsymbol{x}(\\xi,\\eta)$ from the bi-unit parent square $[-1,1]\\times[-1,1]$ to the physical element be defined by the same quadratic shape functions as the field interpolation, so that $\\boldsymbol{x}(\\xi,\\eta)$ is biquadratic in the parent coordinates $\\xi$ and $\\eta$. Assume a constant mass density $\\rho$ and a unit thickness so that the consistent element mass matrix entries are given by\n$$\nM_{ij}=\\int_{\\Omega_e} \\rho\\,N_i(\\boldsymbol{x})\\,N_j(\\boldsymbol{x})\\,\\mathrm{d}\\Omega\n=\\int_{-1}^{1}\\int_{-1}^{1} \\rho\\,N_i(\\xi,\\eta)\\,N_j(\\xi,\\eta)\\,\\det J(\\xi,\\eta)\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta,\n$$\nwhere $N_i(\\xi,\\eta)$ and $N_j(\\xi,\\eta)$ are the biquadratic shape functions on the parent domain and $\\det J(\\xi,\\eta)$ is the determinant of the Jacobian matrix of the isoparametric mapping. You are to select a tensor-product Gauss–Legendre quadrature with $n$ points per direction to integrate the above exactly.\n\nStarting only from (i) the definition of the consistent mass integrand on the parent domain as $N_i(\\xi,\\eta)\\,N_j(\\xi,\\eta)\\,\\det J(\\xi,\\eta)$, (ii) the fact that a $Q_2$ shape function is quadratic in each parent coordinate, (iii) the chain rule characterization of the Jacobian entries as first derivatives of the mapping, and (iv) the well-tested exactness property of the one-dimensional $n$-point Gauss–Legendre rule for polynomials up to degree $2n-1$, determine the highest polynomial degree in each parent coordinate $(\\xi,\\eta)$ of the integrand $N_i(\\xi,\\eta)\\,N_j(\\xi,\\eta)\\,\\det J(\\xi,\\eta)$, and from it choose the minimal integer $n$ such that the tensor-product $n\\times n$ Gauss–Legendre rule is exact for this integrand over $[-1,1]\\times[-1,1]$.\n\nProvide only the minimal integer $n$ as your final answer. No rounding is required.",
            "solution": "The user has provided a valid, well-posed problem statement from the field of computational solid mechanics. The objective is to determine the minimum number of quadrature points, $n$, for a tensor-product Gauss-Legendre rule to exactly integrate the consistent mass matrix for a biquadratic ($Q_2$) isoparametric element.\n\nThe integral for an entry of the consistent mass matrix, evaluated over the parent domain, is given by:\n$$\nM_{ij} = \\int_{-1}^{1}\\int_{-1}^{1} \\rho\\,N_i(\\xi,\\eta)\\,N_j(\\xi,\\eta)\\,\\det J(\\xi,\\eta)\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta\n$$\nThe mass density $\\rho$ is assumed constant and thus does not affect the polynomial degree of the integrand. The integrand function is $I(\\xi, \\eta) = N_i(\\xi,\\eta)\\,N_j(\\xi,\\eta)\\,\\det J(\\xi,\\eta)$.\n\nA one-dimensional $n$-point Gauss-Legendre quadrature rule exactly integrates any polynomial of degree up to $2n-1$. For a two-dimensional tensor-product rule with $n$ points in each direction $(\\xi, \\eta)$, the integration is exact if the integrand is a polynomial of degree at most $2n-1$ in $\\xi$ and at most $2n-1$ in $\\eta$ separately. Our task is therefore to determine the maximum polynomial degree of $I(\\xi, \\eta)$ with respect to $\\xi$ and $\\eta$. Let $P_\\xi(f)$ and $P_\\eta(f)$ denote the polynomial degree of a function $f(\\xi,\\eta)$ in the variables $\\xi$ and $\\eta$, respectively.\n\n1.  **Polynomial Degree of the Shape Function Product $N_i(\\xi,\\eta)\\,N_j(\\xi,\\eta)$**\n    The problem states that the element is a $Q_2$ element, meaning its shape functions $N_k(\\xi,\\eta)$ are biquadratic. A biquadratic function is a polynomial of degree $2$ in each variable, $\\xi$ and $\\eta$. Therefore, for any shape function $N_k(\\xi,\\eta)$:\n    $$\n    P_\\xi(N_k) = 2 \\quad \\text{and} \\quad P_\\eta(N_k) = 2\n    $$\n    The product of two such shape functions, $N_i(\\xi,\\eta)N_j(\\xi,\\eta)$, will have a degree that is the sum of the degrees of the individual functions:\n    $$\n    P_\\xi(N_i N_j) = P_\\xi(N_i) + P_\\xi(N_j) = 2 + 2 = 4\n    $$\n    $$\n    P_\\eta(N_i N_j) = P_\\eta(N_i) + P_\\eta(N_j) = 2 + 2 = 4\n    $$\n\n2.  **Polynomial Degree of the Jacobian Determinant $\\det J(\\xi,\\eta)$**\n    The mapping from parent to physical coordinates is isoparametric, defined by the same shape functions:\n    $$\n    \\boldsymbol{x}(\\xi,\\eta) = \\begin{pmatrix} x(\\xi,\\eta) \\\\ y(\\xi,\\eta) \\end{pmatrix} = \\sum_{k=1}^{9} \\begin{pmatrix} x_k \\\\ y_k \\end{pmatrix} N_k(\\xi,\\eta)\n    $$\n    Since $N_k(\\xi,\\eta)$ are biquadratic, the mapping functions $x(\\xi,\\eta)$ and $y(\\xi,\\eta)$ are also biquadratic polynomials in $\\xi$ and $\\eta$.\n    $$\n    P_\\xi(x) = 2, \\quad P_\\eta(x) = 2\n    $$\n    $$\n    P_\\xi(y) = 2, \\quad P_\\eta(y) = 2\n    $$\n    The Jacobian matrix $J$ contains the partial derivatives of the mapping:\n    $$\n    J(\\xi,\\eta) = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\xi} \\\\ \\frac{\\partial x}{\\partial \\eta} & \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix}\n    $$\n    We determine the polynomial degrees of each entry. Differentiating with respect to a variable reduces its polynomial degree by $1$.\n    -   $P_\\xi\\left(\\frac{\\partial x}{\\partial \\xi}\\right) = P_\\xi(x) - 1 = 2-1 = 1$; \\quad $P_\\eta\\left(\\frac{\\partial x}{\\partial \\xi}\\right) = P_\\eta(x) = 2$.\n    -   $P_\\xi\\left(\\frac{\\partial y}{\\partial \\xi}\\right) = P_\\xi(y) - 1 = 2-1 = 1$; \\quad $P_\\eta\\left(\\frac{\\partial y}{\\partial \\xi}\\right) = P_\\eta(y) = 2$.\n    -   $P_\\xi\\left(\\frac{\\partial x}{\\partial \\eta}\\right) = P_\\xi(x) = 2$; \\quad $P_\\eta\\left(\\frac{\\partial x}{\\partial \\eta}\\right) = P_\\eta(x) - 1 = 2-1 = 1$.\n    -   $P_\\xi\\left(\\frac{\\partial y}{\\partial \\eta}\\right) = P_\\xi(y) = 2$; \\quad $P_\\eta\\left(\\frac{\\partial y}{\\partial \\eta}\\right) = P_\\eta(y) - 1 = 2-1 = 1$.\n\n    The determinant of the Jacobian is $\\det J = \\frac{\\partial x}{\\partial \\xi}\\frac{\\partial y}{\\partial \\eta} - \\frac{\\partial y}{\\partial \\xi}\\frac{\\partial x}{\\partial \\eta}$. The degree of a product of polynomials is the sum of their degrees. The degree of a sum or difference is the maximum of the degrees (assuming no cancellation of highest-order terms, which cannot be guaranteed for a general element geometry).\n    \n    Degree in $\\xi$:\n    -   $P_\\xi\\left(\\frac{\\partial x}{\\partial \\xi}\\frac{\\partial y}{\\partial \\eta}\\right) = P_\\xi\\left(\\frac{\\partial x}{\\partial \\xi}\\right) + P_\\xi\\left(\\frac{\\partial y}{\\partial \\eta}\\right) = 1 + 2 = 3$.\n    -   $P_\\xi\\left(\\frac{\\partial y}{\\partial \\xi}\\frac{\\partial x}{\\partial \\eta}\\right) = P_\\xi\\left(\\frac{\\partial y}{\\partial \\xi}\\right) + P_\\xi\\left(\\frac{\\partial x}{\\partial \\eta}\\right) = 1 + 2 = 3$.\n    Therefore, the maximum degree of $\\det J$ in $\\xi$ is $P_\\xi(\\det J) = 3$.\n\n    Degree in $\\eta$:\n    -   $P_\\eta\\left(\\frac{\\partial x}{\\partial \\xi}\\frac{\\partial y}{\\partial \\eta}\\right) = P_\\eta\\left(\\frac{\\partial x}{\\partial \\xi}\\right) + P_\\eta\\left(\\frac{\\partial y}{\\partial \\eta}\\right) = 2 + 1 = 3$.\n    -   $P_\\eta\\left(\\frac{\\partial y}{\\partial \\xi}\\frac{\\partial x}{\\partial \\eta}\\right) = P_\\eta\\left(\\frac{\\partial y}{\\partial \\xi}\\right) + P_\\eta\\left(\\frac{\\partial x}{\\partial \\eta}\\right) = 2 + 1 = 3$.\n    Therefore, the maximum degree of $\\det J$ in $\\eta$ is $P_\\eta(\\det J) = 3$.\n\n3.  **Polynomial Degree of the Complete Integrand $I(\\xi, \\eta)$**\n    We can now find the degree of the full integrand $I(\\xi, \\eta) = N_i N_j \\det J$.\n    -   Degree in $\\xi$: $P_\\xi(I) = P_\\xi(N_i N_j) + P_\\xi(\\det J) = 4 + 3 = 7$.\n    -   Degree in $\\eta$: $P_\\eta(I) = P_\\eta(N_i N_j) + P_\\eta(\\det J) = 4 + 3 = 7$.\n\n4.  **Determination of the Minimal Quadrature Order $n$**\n    The integrand is a polynomial of degree $7$ in $\\xi$ and degree $7$ in $\\eta$. To integrate a polynomial of degree $p$ exactly using a 1D Gauss-Legendre rule with $n$ points, we must satisfy the condition:\n    $$\n    2n - 1 \\ge p\n    $$\n    In our case, $p=7$ for both directions. Thus, we require:\n    $$\n    2n - 1 \\ge 7\n    $$\n    $$\n    2n \\ge 8\n    $$\n    $$\n    n \\ge 4\n    $$\n    The minimal integer value for $n$ that satisfies this condition is $n=4$. Consequently, a tensor-product quadrature rule with $4 \\times 4$ points is required to guarantee exact integration of the consistent mass matrix for a general $Q_2$ isoparametric element.",
            "answer": "$$\\boxed{4}$$"
        },
        {
            "introduction": "Our final practice moves from the pursuit of exact integration to the crucial concept of numerical consistency, as evaluated by the patch test. You will investigate why the computationally efficient choice of reduced integration can compromise an element's fundamental accuracy and how this can be diagnosed and corrected. This problem  provides insight into the practical trade-offs made in element design and the development of robust formulations, such as those using $\\bar{\\mathbf{B}}$ methods, for general-purpose analysis.",
            "id": "3598641",
            "problem": "Consider a two-dimensional isoparametric bilinear quadrilateral element used in the Finite Element Method (FEM) for plane stress linear elasticity. Let the parent coordinates be $(\\xi,\\eta) \\in [-1,1] \\times [-1,1]$, and let the physical mapping be exact in the sense of isoparametric interpolation: $x(\\xi,\\eta) = \\sum_{i=1}^{4} N_i(\\xi,\\eta)\\,x_i$, $y(\\xi,\\eta) = \\sum_{i=1}^{4} N_i(\\xi,\\eta)\\,y_i$, where $N_i(\\xi,\\eta)$ are the standard bilinear shape functions, and $\\{(x_i,y_i)\\}$ are arbitrary nodal coordinates forming a general distorted bilinear image (not necessarily an affine parallelogram). For a patch of such elements, the linear patch test requires that when the exact linear displacement field in physical coordinates is imposed at all nodes,\n$$\nu_x(x,y) = a + b\\,x + c\\,y, \\qquad u_y(x,y) = d + e\\,x + f\\,y,\n$$\nwith $a,b,c,d,e,f \\in \\mathbb{R}$, the assembled internal forces must reproduce the exact continuum response, equivalently ensuring consistency of the internal virtual work. In the element formulation, the internal force vector for node $i$ is\n$$\n\\mathbf{r}_i = \\int_{\\Omega_e} \\mathbf{B}_i^{\\top}\\,\\boldsymbol{\\sigma}\\,\\mathrm{d}\\Omega,\n$$\nwhere $\\Omega_e$ is the element domain in physical coordinates, $\\boldsymbol{\\sigma} = \\mathbf{D}\\,\\boldsymbol{\\epsilon}$ is the Cauchy stress with constant material matrix $\\mathbf{D}$ for isotropic plane stress, and $\\boldsymbol{\\epsilon}$ is the small-strain tensor. Using the exact isoparametric mapping, this is equivalently written in parent coordinates as\n$$\n\\mathbf{r}_i = \\int_{-1}^{1}\\!\\!\\int_{-1}^{1} \\widehat{\\mathbf{B}}_i^{\\top}(\\xi,\\eta)\\,\\mathbf{J}^{-\\,\\top}(\\xi,\\eta)\\,\\boldsymbol{\\sigma}\\,\\det\\mathbf{J}(\\xi,\\eta)\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta,\n$$\nwhere $\\mathbf{J}$ is the Jacobian matrix of the mapping and $\\widehat{\\mathbf{B}}_i$ contains the derivatives of $N_i$ with respect to $(\\xi,\\eta)$. For a linear displacement field in physical coordinates, $\\boldsymbol{\\epsilon}$ and thus $\\boldsymbol{\\sigma}$ are constant.\n\nUnder tensor-product Gauss–Legendre quadrature of order $n$ per parametric direction, the exactness of the linear patch test depends on the polynomial degree of the integrands entering $\\mathbf{r}_i$. With general bilinear geometric distortion, entries of the adjugate $\\mathrm{adj}(\\mathbf{J})$ are linear in $(\\xi,\\eta)$, while entries of $\\widehat{\\mathbf{B}}_i$ are linear in $(\\xi,\\eta)$ (each derivative depends linearly on one parameter). As a result, the components of the integrand $\\widehat{\\mathbf{B}}_i^{\\top}\\,\\mathbf{J}^{-\\,\\top}\\,\\boldsymbol{\\sigma}\\,\\det\\mathbf{J}$ generally contain bilinear terms and, for distorted mappings, quadratic terms arising from products of linear functions in the same parameter. In a reduced integration scheme with $n=1$ (one-point quadrature at $(\\xi,\\eta)=(0,0)$), these quadratic contributions are not integrated exactly, and the linear patch test can fail even though the mapping is exact.\n\nYou are to determine the minimum tensor-product Gauss quadrature order per parametric direction, denoted $n_{\\star}$, that guarantees exact satisfaction of the linear patch test for arbitrary bilinear isoparametric mappings and constant isotropic material coefficients in plane stress. Additionally, briefly outline a principled correction strategy that restores patch-test consistency when one-point quadrature is retained, based on adding a consistency-restoring stabilization term that exactly integrates the missing quadratic content of the internal virtual work by projecting the strain field onto the linear subspace.\n\nProvide your final answer as the single integer $n_{\\star}$. No rounding is required and no physical units apply to $n_{\\star}$.",
            "solution": "The problem requires determining the minimum tensor-product Gauss-Legendre quadrature order, $n_{\\star}$, that guarantees the satisfaction of the linear patch test for a general two-dimensional isoparametric bilinear quadrilateral element. Furthermore, a correction strategy for one-point quadrature ($n=1$) must be outlined.\n\nFirst, we validate the problem statement. The problem is a standard, well-posed question in computational solid mechanics. It is scientifically grounded, objective, and contains sufficient information to be solved. Although the descriptive text contains a potentially confusing statement regarding the polynomial nature of the integrand (it seems to conflate the integrand for the internal force vector with that of the stiffness matrix), the core question is valid and has a definitive answer based on established principles. We shall proceed by presenting a rigorous derivation that does not rely on the questionable part of the problem's descriptive text.\n\nThe linear patch test verifies that the finite element formulation can exactly reproduce a state of constant strain. For an isoparametric element, when nodal displacements are set to the values of a linear displacement field, $u_x(x,y) = a + b\\,x + c\\,y$ and $u_y(x,y) = d + e\\,x + f\\,y$, the interpolated displacement field within the element exactly reproduces this linear field. Consequently, the corresponding strain tensor $\\boldsymbol{\\epsilon}$ is constant throughout the element, and for a constant material matrix $\\mathbf{D}$, the stress tensor $\\boldsymbol{\\sigma} = \\mathbf{D}\\boldsymbol{\\epsilon}$ is also constant.\n\nThe patch test is passed if, for a patch of elements subjected to this constant stress state, the discretized equations are satisfied exactly. This is equivalent to the condition that the virtual work equation holds. A key sufficient condition for passing the patch test, established by Irons, is that the numerical quadrature rule must be capable of exactly integrating the element volume and its first moments of area. This ensures that the element formulation behaves correctly for constant and linear fields.\n\nLet us analyze the polynomial degree of the integrands for these quantities in the parent coordinate system $(\\xi, \\eta) \\in [-1,1] \\times [-1,1]$.\n\n1.  **Element Area (Volume in 2D):** The area of the element $\\Omega_e$ is given by the integral of the Jacobian determinant over the parent domain:\n    $$\n    A_e = \\int_{\\Omega_e} \\mathrm{d}A = \\int_{-1}^{1}\\int_{-1}^{1} \\det\\mathbf{J}(\\xi,\\eta)\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta\n    $$\n    The mapping is $x(\\xi,\\eta) = \\sum_{i=1}^{4} N_i(\\xi,\\eta) x_i$ and $y(\\xi,\\eta) = \\sum_{i=1}^{4} N_i(\\xi,\\eta) y_i$, where $N_i$ are bilinear shape functions, e.g., $N_1 = \\frac{1}{4}(1-\\xi)(1-\\eta)$. The physical coordinates $x$ and $y$ are thus bilinear functions of $\\xi$ and $\\eta$.\n    The entries of the Jacobian matrix $\\mathbf{J}$ are:\n    $J_{11} = \\frac{\\partial x}{\\partial \\xi}$, $J_{12} = \\frac{\\partial y}{\\partial \\xi}$, $J_{21} = \\frac{\\partial x}{\\partial \\eta}$, $J_{22} = \\frac{\\partial y}{\\partial \\eta}$.\n    Since $x$ and $y$ are bilinear, their derivatives with respect to $\\xi$ are linear functions of $\\eta$, and their derivatives with respect to $\\eta$ are linear functions of $\\xi$. For example, $\\frac{\\partial x}{\\partial \\xi}$ is of the form $k_1 + k_2\\eta$, and $\\frac{\\partial x}{\\partial \\eta}$ is of the form $k_3 + k_4\\xi$.\n    The Jacobian determinant is $\\det\\mathbf{J} = J_{11}J_{22} - J_{12}J_{21}$.\n    This is a product of a linear function of $\\eta$ and a linear function of $\\xi$, minus another such product. The result is a bilinear polynomial in $\\xi$ and $\\eta$:\n    $$\n    \\det\\mathbf{J}(\\xi,\\eta) = c_0 + c_1\\xi + c_2\\eta + c_3\\xi\\eta\n    $$\n    An $n$-point Gauss-Legendre rule integrates polynomials of degree up to $2n-1$ exactly. To integrate a linear function (degree $1$) in one variable, we need $2n-1 \\ge 1 \\implies n \\ge 1$. A tensor-product rule of order $n=1$ (i.e., $1 \\times 1$ points) is sufficient to exactly integrate any bilinear polynomial. Thus, the area is integrated exactly by one-point quadrature.\n\n2.  **First Moments of Area:** The first moment of area with respect to the $y$-axis is:\n    $$\n    M_y = \\int_{\\Omega_e} x\\,\\mathrm{d}A = \\int_{-1}^{1}\\int_{-1}^{1} x(\\xi,\\eta) \\det\\mathbf{J}(\\xi,\\eta)\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta\n    $$\n    The integrand is the product of the physical coordinate $x(\\xi,\\eta)$ and the Jacobian determinant $\\det\\mathbf{J}(\\xi,\\eta)$. As established, both $x(\\xi,\\eta)$ and $\\det\\mathbf{J}(\\xi,\\eta)$ are bilinear polynomials. The product of two bilinear polynomials is a biquadratic polynomial, containing terms up to $\\xi^2$, $\\eta^2$, and $\\xi^2\\eta^2$. The general form is:\n    $$\n    p(\\xi,\\eta) = \\sum_{j=0}^{2} \\sum_{k=0}^{2} c_{jk} \\xi^j \\eta^k\n    $$\n    The highest polynomial degree in the $\\xi$ direction is $2$, and similarly for the $\\eta$ direction. To integrate a quadratic polynomial (degree $2$) in one dimension exactly, the Gauss-Legendre rule must have an order $n$ such that:\n    $$\n    2n - 1 \\ge 2 \\implies 2n \\ge 3 \\implies n \\ge 1.5\n    $$\n    Since the number of quadrature points $n$ must be an integer, the minimum required order is $n=2$. The same logic applies to the first moment $M_x = \\int x_2 dA = \\int y(\\xi,\\eta)\\det\\mathbf{J} d\\xi d\\eta$.\n    Therefore, to guarantee satisfaction of the linear patch test for an arbitrarily distorted bilinear quadrilateral element, a minimum of $2 \\times 2$ Gauss quadrature points is required. The minimum order per direction is $n_{\\star}=2$.\n\nRegarding the second part of the question, a principled correction strategy to restore patch-test consistency for one-point quadrature ($n=1$) is necessary because this rule fails to exactly integrate the first moments of area for distorted elements. The failure leads to incorrect evaluation of the internal force vector under constant stress. The core idea of a correction is to modify the formulation such that the numerically computed internal work matches the exact continuum value for a constant stress patch.\n\nA well-known strategy is the $\\bar{\\mathbf{B}}$ (\"B-bar\") method. The internal force vector for node $i$ is calculated as $\\mathbf{r}_i = \\int_{\\Omega_e} \\mathbf{B}_i^{\\top}\\boldsymbol{\\sigma}\\,\\mathrm{d}\\Omega$. For a constant stress state, this becomes $\\mathbf{r}_i = (\\int_{\\Omega_e} \\mathbf{B}_i^{\\top}\\,\\mathrm{d}\\Omega)\\boldsymbol{\\sigma}$. The patch test is passed if the integral term is evaluated exactly. We define an average strain-displacement matrix $\\bar{\\mathbf{B}}_i$ as:\n$$\n\\bar{\\mathbf{B}}_i = \\frac{1}{A_e} \\int_{\\Omega_e} \\mathbf{B}_i\\,\\mathrm{d}\\Omega = \\frac{1}{\\int_{-1}^{1}\\!\\!\\int_{-1}^{1} \\det\\mathbf{J}\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta} \\int_{-1}^{1}\\!\\!\\int_{-1}^{1} \\mathbf{B}_i(\\xi,\\eta)\\,\\det\\mathbf{J}(\\xi,\\eta)\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta\n$$\nThe integrand in the numerator, $\\mathbf{B}_i\\,\\det\\mathbf{J}$, has components that are bilinear in $(\\xi,\\eta)$. For example, the component $(\\partial N_i/\\partial x)\\det\\mathbf{J}$ is bilinear. As shown previously, a bilinear function is integrated exactly by a single Gauss point at $(\\xi,\\eta)=(0,0)$. The denominator $A_e = \\int \\det\\mathbf{J}\\,d\\xi d\\eta$ is also integrated exactly by one-point quadrature. Therefore, $\\bar{\\mathbf{B}}_i$ can be computed exactly using information only from the element center:\n$$\n\\bar{\\mathbf{B}}_i = \\frac{\\mathbf{B}_i(0,0)\\,\\det\\mathbf{J}(0,0)}{\\det\\mathbf{J}(0,0)} = \\mathbf{B}_i(0,0)\n$$\nThis seems to lead to a paradox. The error lies in the fact that while the integral of a bilinear function is exactly given by the one-point rule, the function itself is not constant. The philosophy of the $\\bar{\\mathbf{B}}$ method is to replace the spatially varying $\\mathbf{B}_i$ with its exact average $\\bar{\\mathbf{B}}_i$. The internal force vector is then computed as $\\mathbf{r}_i = \\bar{\\mathbf{B}}_i^{\\top} \\boldsymbol{\\sigma} A_e$. By using the exactly averaged strain-displacement matrix, the internal work is calculated correctly for a constant stress field, thus restoring patch-test consistency. This is a projection of the strain field onto the space of constant strains over the element, which is what is required for the patch test. The added \"stabilization\" is implicit in this corrected formulation, which prevents the errors that would arise from naively using $\\mathbf{B}_i(0,0)$ with distorted geometries.",
            "answer": "$$\\boxed{2}$$"
        }
    ]
}