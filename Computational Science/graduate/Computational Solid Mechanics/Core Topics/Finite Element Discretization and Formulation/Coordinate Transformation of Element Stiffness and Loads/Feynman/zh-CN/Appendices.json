{
    "hands_on_practices": [
        {
            "introduction": "本练习将带您实践坐标变换的最基本应用：将单个单元上的节点力和力矩从局部坐标系转换到全局坐标系。通过对一个承受自平衡荷载的杆单元进行计算()，您不仅将掌握力变换矩阵 $F_g = T^T F_l$ 的直接应用，还将通过推导验证一个核心理论：正确的坐标变换保持了系统的静力平衡和刚度矩阵的对称性。这是理解和构建有限元分析程序的基础。",
            "id": "3555039",
            "problem": "考虑有限元法（FEM）中的一个二维欧拉-伯努利梁单元，该单元有两个节点，记为节点 $i$ 和节点 $j$，以及局部坐标系 $(x,y)$，其中局部 $x$ 轴与单元轴线对齐。该单元长度为 $L$，通过绕平面外 $z$ 轴的刚性旋转嵌入到全局 $(X,Y)$ 坐标系中，转角为 $\\theta$（以弧度为单位）。单元的方向由 $\\theta = \\pi/3$ 和 $L = 2$ 指定，每个节点的局部节点自由度按 $(u_x, u_y, \\varphi_z)$ 顺序排列，其中 $u_x$ 和 $u_y$ 是平移，$\\varphi_z$ 是绕 $z$ 轴的平面内转动。\n\n施加了一个自平衡的局部节点作用力系统，该系统在节点 $i$ 处包含一个端点剪力-力矩对，并在节点 $j$ 处有相应的反作用力。在局部坐标系中，施加的节点作用力为：\n- 在节点 $i$ 处：沿 $+y$ 方向的剪力 $V_i$，大小为 $V_i = 12$；绕 $z$ 轴的节点力矩，大小为 $M_i = 5$。\n- 在节点 $j$ 处：沿 $+y$ 方向的剪力 $V_j$ 和绕 $z$ 轴的节点力矩 $M_j$，其大小待定，使得单元级的合力和合力矩在局部坐标系中均为零。\n\n假设采用标准符号约定：沿 $+y$ 方向为正剪力，绕 $+z$ 轴为正力矩（逆时针）。设从局部到全局的方向余弦旋转矩阵 $Q$ 将局部平移分量映射到全局平移分量。单元级位移转换矩阵 $T$ 作用于有序的节点位移向量 $(u_{x,i}, u_{y,i}, \\varphi_{z,i}, u_{x,j}, u_{y,j}, \\varphi_{z,j})$，并且是用于平移的适当旋转子矩阵和用于 $\\varphi_z$ 的单位矩阵的块对角组合。\n\n任务：\n1. 在局部坐标系中施加静力平衡条件，以确定用 $L$、$V_i$ 和 $M_i$ 表示的 $V_j$ 和 $M_j$。\n2. 从虚功不变性原理和由 $Q$ 定义的旋转映射出发，推导节点力分量的适当转换关系，并构建与由有序分量 $(f_{x,i}, f_{y,i}, m_{z,i}, f_{x,j}, f_{y,j}, m_{z,j})$ 定义的局部节点荷载向量 $F_l$ 相对应的全局节点荷载向量 $F_g$。\n3. 根据给定的 $L$、$V_i$、$M_i$ 和 $\\theta$ 的数值，计算节点作用力的显式全局分量。\n4. 使用第一性原理和刚性旋转的性质，验证节点平衡在转换下保持不变，并且从对称的局部刚度矩阵 $K_l$ 构建的转换后的全局单元刚度矩阵 $K_g$ 仍然是对称的。\n\n将最终的全局节点荷载向量 $F_g$ 的分量按 $(f_{X,i}, f_{Y,i}, m_{Z,i}, f_{X,j}, f_{Y,j}, m_{Z,j})$ 的顺序表示，力的单位为牛顿，力矩的单位为牛顿-米。角度使用弧度。无需四舍五入；给出精确值。",
            "solution": "题目陈述经评估有效。它在科学上基于计算固体力学和有限元法的原理，提法恰当、客观，并且包含获得唯一解所需的所有必要信息，没有矛盾。\n\n解答按顺序处理这四个任务。\n\n单元的有序自由度（DOF）在局部坐标系 $(x,y)$ 和全局坐标系 $(X,Y)$ 中给出。\n局部节点位移向量为 $d_l = (u_{x,i}, u_{y,i}, \\varphi_{z,i}, u_{x,j}, u_{y,j}, \\varphi_{z,j})^T$。\n相应的局部节点荷载向量为 $F_l = (f_{x,i}, f_{y,i}, m_{z,i}, f_{x,j}, f_{y,j}, m_{z,j})^T$。\n\n该单元长度为 $L=2$，相对于全局坐标系的方向角为 $\\theta = \\pi/3$。\n\n**任务1：在局部坐标系中施加静力平衡**\n\n施加了一个自平衡的节点作用力系统。在节点 $i$ 处，作用力为沿 $+y$ 方向的大小为 $V_i = 12$ 的剪力，以及绕 $+z$ 轴的大小为 $M_i = 5$ 的力矩。用局部荷载向量表示，这意味着：\n$f_{x,i} = 0$\n$f_{y,i} = V_i = 12$\n$m_{z,i} = M_i = 5$\n\n在节点 $j$ 处，有反作用力：沿 $+y$ 方向的剪力 $V_j$（因此 $f_{y,j} = V_j$）和力矩 $M_j$（因此 $m_{z,j} = M_j$）。没有指定轴向力，因此我们假设 $f_{x,j}$ 由平衡条件确定。\n\n为使单元处于静力平衡状态，所有力和力矩的总和必须为零。\n1.  局部 $x$ 方向的力之和：\n    $$ \\sum f_x = f_{x,i} + f_{x,j} = 0 $$\n    由于 $f_{x,i}=0$，我们得到 $f_{x,j}=0$。\n\n2.  局部 $y$ 方向的力之和：\n    $$ \\sum f_y = f_{y,i} + f_{y,j} = 0 $$\n    $$ V_i + V_j = 0 \\implies V_j = -V_i = -12 $$\n    所以，节点 $j$ 处的剪力作用为 $f_{y,j} = -12$。\n\n3.  绕节点 $i$ 的力矩之和：\n    $$ \\sum M_i = m_{z,i} + m_{z,j} + (f_{y,j} \\cdot L) = 0 $$\n    节点 $j$ 处的力 $f_{y,j}$ 相对于节点 $i$ 的力臂为 $L$。\n    $$ M_i + M_j + (-V_i)L = 0 $$\n    求解 $M_j$：\n    $$ M_j = V_i L - M_i $$\n    代入给定值 $L=2$，$V_i=12$ 和 $M_i=5$：\n    $$ M_j = (12)(2) - 5 = 24 - 5 = 19 $$\n    所以，节点 $j$ 处的力矩为 $m_{z,j} = 19$。\n\n完整的局部节点荷载向量为：\n$$ F_l = \\begin{pmatrix} f_{x,i} \\\\ f_{y,i} \\\\ m_{z,i} \\\\ f_{x,j} \\\\ f_{y,j} \\\\ m_{z,j} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 12 \\\\ 5 \\\\ 0 \\\\ -12 \\\\ 19 \\end{pmatrix} $$\n\n**任务2：推导节点力的转换关系并构建全局节点荷载向量 $F_g$**\n\n节点力从局部坐标系到全局坐标系的转换是根据虚功不变性原理 $\\delta W$ 推导出来的。\n$$ \\delta W = (\\delta d_g)^T F_g = (\\delta d_l)^T F_l $$\n其中 $d_g$ 和 $d_l$ 分别是全局和局部节点位移向量，$F_g$ 和 $F_l$ 是相应的节点荷载向量。\n\n局部节点位移 $d_l$ 通过一个转换矩阵 $T$ 与全局节点位移 $d_g$ 相关联：\n$$ d_l = T d_g $$\n位移的变分遵循相同的规则：$\\delta d_l = T \\delta d_g$。\n将此代入虚功方程：\n$$ (\\delta d_g)^T F_g = (T \\delta d_g)^T F_l = (\\delta d_g)^T T^T F_l $$\n因为对于任意非零的虚位移向量 $\\delta d_g$，此等式都必须成立，所以我们可以得出结论：\n$$ F_g = T^T F_l $$\n矩阵 $T$ 将全局自由度转换为局部自由度。对于单个节点，转换关系将 $(u_{X}, u_{Y}, \\varphi_{Z})$ 关联到 $(u_{x}, u_{y}, \\varphi_{z})$。平移分量发生旋转，而平面内转角 $\\varphi_z$ 保持不变。\n局部坐标是通过将全局坐标旋转角度 $-\\theta$ 得到的。该转换由下式给出：\n$$ \\begin{pmatrix} u_x \\\\ u_y \\end{pmatrix} = \\begin{pmatrix} \\cos\\theta  \\sin\\theta \\\\ -\\sin\\theta  \\cos\\theta \\end{pmatrix} \\begin{pmatrix} u_X \\\\ u_Y \\end{pmatrix} $$\n这个 $2 \\times 2$ 矩阵是 $Q^T$，即从局部到全局旋转矩阵 $Q$ 的转置。\n$$ Q = \\begin{pmatrix} \\cos\\theta  -\\sin\\theta \\\\ \\sin\\theta  \\cos\\theta \\end{pmatrix} $$\n节点转角是不变的：$\\varphi_z = \\varphi_Z$。\n单个节点自由度的转换由矩阵 $T_{node}$ 描述：\n$$ T_{node} = \\begin{pmatrix} \\cos\\theta  \\sin\\theta  0 \\\\ -\\sin\\theta  \\cos\\theta  0 \\\\ 0  0  1 \\end{pmatrix} $$\n完整的单元转换矩阵 $T$ 是一个 $6 \\times 6$ 的块对角矩阵：\n$$ T = \\begin{pmatrix} T_{node}  \\mathbf{0} \\\\ \\mathbf{0}  T_{node} \\end{pmatrix} $$\n力的转换需要 $T^T$：\n$$ T^T = \\begin{pmatrix} T_{node}^T  \\mathbf{0} \\\\ \\mathbf{0}  T_{node}^T \\end{pmatrix} \\quad \\text{其中} \\quad T_{node}^T = \\begin{pmatrix} \\cos\\theta  -\\sin\\theta  0 \\\\ \\sin\\theta  \\cos\\theta  0 \\\\ 0  0  1 \\end{pmatrix} $$\n令 $R = T_{node}^T$。全局力向量 $F_g$ 是通过分别使用 $R$ 转换节点 $i$ 和 $j$ 处的节点力得到的：\n$$ F_{g,i} = \\begin{pmatrix} f_{X,i} \\\\ f_{Y,i} \\\\ m_{Z,i} \\end{pmatrix} = R \\begin{pmatrix} f_{x,i} \\\\ f_{y,i} \\\\ m_{z,i} \\end{pmatrix} \\quad \\text{和} \\quad F_{g,j} = \\begin{pmatrix} f_{X,j} \\\\ f_{Y,j} \\\\ m_{Z,j} \\end{pmatrix} = R \\begin{pmatrix} f_{x,j} \\\\ f_{y,j} \\\\ m_{z,j} \\end{pmatrix} $$\n\n**任务3：计算显式的全局分量**\n\n给定 $\\theta = \\pi/3$：\n$\\cos(\\pi/3) = 1/2$\n$\\sin(\\pi/3) = \\sqrt{3}/2$\n\n转换矩阵 $R$ 为：\n$$ R = \\begin{pmatrix} 1/2  -\\sqrt{3}/2  0 \\\\ \\sqrt{3}/2  1/2  0 \\\\ 0  0  1 \\end{pmatrix} $$\n局部节点荷载为 $F_{l,i} = (0, 12, 5)^T$ 和 $F_{l,j} = (0, -12, 19)^T$。\n\n对于节点 $i$：\n$$ \\begin{pmatrix} f_{X,i} \\\\ f_{Y,i} \\\\ m_{Z,i} \\end{pmatrix} = \\begin{pmatrix} 1/2  -\\sqrt{3}/2  0 \\\\ \\sqrt{3}/2  1/2  0 \\\\ 0  0  1 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 12 \\\\ 5 \\end{pmatrix} = \\begin{pmatrix} (1/2)(0) + (-\\sqrt{3}/2)(12) + (0)(5) \\\\ (\\sqrt{3}/2)(0) + (1/2)(12) + (0)(5) \\\\ (0)(0) + (0)(12) + (1)(5) \\end{pmatrix} = \\begin{pmatrix} -6\\sqrt{3} \\\\ 6 \\\\ 5 \\end{pmatrix} $$\n\n对于节点 $j$：\n$$ \\begin{pmatrix} f_{X,j} \\\\ f_{Y,j} \\\\ m_{Z,j} \\end{pmatrix} = \\begin{pmatrix} 1/2  -\\sqrt{3}/2  0 \\\\ \\sqrt{3}/2  1/2  0 \\\\ 0  0  1 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ -12 \\\\ 19 \\end{pmatrix} = \\begin{pmatrix} (1/2)(0) + (-\\sqrt{3}/2)(-12) + (0)(19) \\\\ (\\sqrt{3}/2)(0) + (1/2)(-12) + (0)(19) \\\\ (0)(0) + (0)(-12) + (1)(19) \\end{pmatrix} = \\begin{pmatrix} 6\\sqrt{3} \\\\ -6 \\\\ 19 \\end{pmatrix} $$\n\n最终的全局节点荷载向量 $F_g$ 由这些分量组合而成：\n$$ F_g = (f_{X,i}, f_{Y,i}, m_{Z,i}, f_{X,j}, f_{Y,j}, m_{Z,j})^T = (-6\\sqrt{3}, 6, 5, 6\\sqrt{3}, -6, 19)^T $$\n\n**任务4：验证平衡性和刚度矩阵的对称性**\n\n*   **节点平衡的保持性：**\n    一个力和力矩系统处于平衡状态，如果其合力向量和（绕任意点的）合力矩向量为零。从局部坐标系到全局坐标系的转换是刚性旋转，这是一种仿射变换，它保持了向量和与力矩的性质。\n    形式上，设局部坐标系中的总力向量为 $\\mathbf{F}_{total, l} = \\sum_{k} \\mathbf{F}_{l,k}$。题目说明局部系统处于平衡状态，因此 $\\mathbf{F}_{total, l} = \\mathbf{0}$。\n    全局坐标系中的总力为 $\\mathbf{F}_{total, g} = \\sum_{k} \\mathbf{F}_{g,k}$。每个力向量的转换关系为 $\\mathbf{F}_{g,k} = Q \\mathbf{F}_{l,k}$。\n    $$ \\mathbf{F}_{total, g} = \\sum_{k} (Q \\mathbf{F}_{l,k}) = Q \\left( \\sum_{k} \\mathbf{F}_{l,k} \\right) = Q \\mathbf{F}_{total, l} = Q \\mathbf{0} = \\mathbf{0} $$\n    因此，力的平衡得以保持。类似的论证也适用于力矩的平衡。在一个坐标系中自平衡的力和力矩系统，在经过到另一个坐标系的刚性变换后，仍然保持自平衡。我们的数值结果证实了这一点：\n    $\\sum F_X = -6\\sqrt{3} + 6\\sqrt{3} = 0$。\n    $\\sum F_Y = 6 - 6 = 0$。\n\n*   **转换后刚度矩阵 $K_g$ 的对称性：**\n    刚度矩阵从局部坐标到全局坐标的转换由下式给出：\n    $$ K_g = T^T K_l T $$\n    给定局部刚度矩阵 $K_l$ 是对称的，即 $K_l^T = K_l$。我们必须验证 $K_g$ 也是对称的，即 $K_g^T = K_g$。\n    我们来计算 $K_g$ 的转置：\n    $$ K_g^T = (T^T K_l T)^T $$\n    使用矩阵乘积转置的性质，$(ABC)^T = C^T B^T A^T$：\n    $$ K_g^T = T^T (K_l)^T (T^T)^T $$\n    使用转置的转置是原矩阵的性质，$(A^T)^T = A$：\n    $$ K_g^T = T^T (K_l)^T T $$\n    由于 $K_l$ 是对称的，我们代入 $K_l^T = K_l$：\n    $$ K_g^T = T^T K_l T $$\n    这正是 $K_g$ 的定义。因此，$K_g^T = K_g$，证明了如果局部刚度矩阵是对称的，那么全局刚度矩阵也是对称的。这个性质对于有限元法中使用的合同变换是基础性的。",
            "answer": "$$ \\boxed{\n\\begin{pmatrix} -6\\sqrt{3}  6  5  6\\sqrt{3}  -6  19 \\end{pmatrix}\n} $$"
        },
        {
            "introduction": "在实际工程问题中，结构通常承受沿其长度分布的荷载，而非简单的节点力。本练习()建立在前一个练习的基础上，引入了处理分布荷载的关键步骤。您将学习如何首先利用虚功原理和单元的形函数，将一个空间变化的分布荷载转化为一组“一致的”等效局部节点力，然后，再将此局部节点力向量变换到全局坐标系，从而完成将复杂荷载用以全局组装的标准化过程。",
            "id": "3555024",
            "problem": "考虑一个长度为 $L$ 的二维欧拉-伯努利梁（框架）有限元，连接节点1和节点2。该单元的局部坐标系 $\\{x,y\\}$ 是通过将全局坐标系 $\\{X,Y\\}$ 从全局 $X$ 轴向局部 $x$ 轴逆时针旋转一个恒定角度 $\\theta$ 得到的。局部 $y$ 轴是平面内的横向轴，与局部 $x$ 轴正交。局部坐标系中的节点自由度排列为 $[u_1, v_1, \\varphi_1, u_2, v_2, \\varphi_2]^{T}$，其中 $u$ 是轴向位移，$v$ 是横向位移，$\\varphi$ 是转角。\n\n一个分布荷载仅在局部横向 $+y$ 方向上作用，并沿单元按如下规律变化：\n$$\nq_l(x) \\;=\\; q_0 \\;+\\; q_1\\,\\frac{x}{L} \\;+\\; q_2\\,\\Bigl(\\frac{x}{L}\\Bigr)^{2},\n\\quad 0 \\le x \\le L,\n$$\n其中 $q_0$、$q_1$ 和 $q_2$ 为常数。使用虚功原理和针对欧拉-伯努利梁横向位移的标准三次埃尔米特插值，\n$$\nv(x) \\;=\\; H_1(\\xi)\\,v_1 \\;+\\; H_2(\\xi)\\,L\\,\\varphi_1 \\;+\\; H_3(\\xi)\\,v_2 \\;+\\; H_4(\\xi)\\,L\\,\\varphi_2,\n\\quad \\xi \\equiv \\frac{x}{L},\n$$\n其中\n$$\nH_1(\\xi)=1-3\\xi^2+2\\xi^3,\\quad\nH_2(\\xi)=\\xi-2\\xi^2+\\xi^3,\\quad\nH_3(\\xi)=3\\xi^2-2\\xi^3,\\quad\nH_4(\\xi)=-\\xi^2+\\xi^3,\n$$\n首先，构建仅由 $q_l(x)$ 引起的、与节点1处的横向位移相关联的协调局部等效节点荷载向量分量，即局部向量 $[F_{u1}^{(l)},F_{v1}^{(l)},M_{1}^{(l)},F_{u2}^{(l)},F_{v2}^{(l)},M_{2}^{(l)}]^{T}$ 中的分量 $F_{v1}^{(l)}$。\n\n然后，使用力变换将局部等效节点荷载映射到全局坐标系：\n$$\n\\mathbf{f}^{(g)} \\;=\\; \\mathbf{T}^{T}\\,\\mathbf{f}^{(l)},\n$$\n其中 $\\mathbf{T}$ 是将全局节点位移映射到局部节点位移的块对角变换矩阵，即\n$$\n\\begin{bmatrix} u \\\\ v \\\\ \\varphi \\end{bmatrix}^{(l)}\n\\;=\\;\n\\mathbf{R}\\,\n\\begin{bmatrix} U \\\\ V \\\\ \\Phi \\end{bmatrix}^{(g)},\n\\qquad\n\\mathbf{R}\n=\n\\begin{bmatrix}\n\\cos\\theta  \\sin\\theta  0 \\\\\n-\\sin\\theta  \\cos\\theta  0 \\\\\n0  0  1\n\\end{bmatrix},\n$$\n此变换独立应用于节点1和节点2。\n\n从第一性原理出发，推导仅由 $q_l(x)$ 引起的、节点1处等效节点荷载的全局 $X$ 分量的闭式表达式，记为 $F_{X1}^{(g)}$。将您的最终答案表示为由 $q_0$、$q_1$、$q_2$、$L$ 和 $\\theta$ 组成的单个符号表达式。最终表达式中不应包含单位。无需进行数值计算或取整。",
            "solution": "该问题是有效的，因为它是计算固体力学中一个适定的、有科学依据的问题，其内部逻辑一致，并包含了获得唯一解所需的所有信息。\n\n推导过程分两个主要步骤：首先，利用虚功原理确定协调局部等效节点荷载；其次，将这些局部荷载转换到全局坐标系。\n\n虚功原理指出，外部自分布荷载所做的虚功 $\\delta W_{\\text{ext}}$ 等于等效节点荷载 $\\mathbf{f}^{(l)}$ 通过虚节点位移 $\\delta\\mathbf{d}^{(l)}$ 所做的功。分布荷载 $q_l(x)$ 仅在局部横向作用，因此虚功由下式给出：\n$$\n\\delta W_{\\text{ext}} = \\int_0^L q_l(x) \\, \\delta v(x) \\, dx\n$$\n虚横向位移 $\\delta v(x)$ 是通过使用给定的埃尔米特形函数 $H_i(\\xi)$ 从虚节点自由度插值得到的，其中 $\\xi = x/L$：\n$$\n\\delta v(x) = H_1(\\xi)\\,\\delta v_1 + H_2(\\xi)\\,L\\,\\delta \\varphi_1 + H_3(\\xi)\\,\\delta v_2 + H_4(\\xi)\\,L\\,\\delta \\varphi_2\n$$\n虚功也可以离散地表示为：\n$$\n\\delta W_{\\text{ext}} = [F_{u1}^{(l)}, F_{v1}^{(l)}, M_1^{(l)}, F_{u2}^{(l)}, F_{v2}^{(l)}, M_2^{(l)}] \\begin{bmatrix} \\delta u_1 \\\\ \\delta v_1 \\\\ \\delta \\varphi_1 \\\\ \\delta u_2 \\\\ \\delta v_2 \\\\ \\delta \\varphi_2 \\end{bmatrix}\n$$\n由于作用荷载 $q_l(x)$ 是纯横向的，它不通过任何虚轴向位移 $\\delta u(x)$ 做功。因此，协调节点轴向力为零：$F_{u1}^{(l)} = 0$ 和 $F_{u2}^{(l)} = 0$。\n\n为求得节点1处的局部横向力 $F_{v1}^{(l)}$，我们令 $\\delta W_{\\text{ext}}$ 两个表达式中虚位移 $\\delta v_1$ 的系数相等：\n$$\nF_{v1}^{(l)} = \\int_0^L q_l(x) H_1(\\xi) \\, dx\n$$\n我们代入 $q_l(x)$ 和 $H_1(\\xi)$ 的给定表达式，并利用 $x = L\\xi$ 和 $dx = L\\,d\\xi$ 将积分变量从 $x$ 更改为 $\\xi$：\n$$\nF_{v1}^{(l)} = \\int_0^1 \\left( q_0 + q_1\\xi + q_2\\xi^2 \\right) \\left( 1 - 3\\xi^2 + 2\\xi^3 \\right) L \\, d\\xi\n$$\n我们可以根据常数 $q_0$、$q_1$ 和 $q_2$ 将此式分解为三个积分：\n$$\nF_{v1}^{(l)} = L \\left( q_0 \\int_0^1 H_1(\\xi) \\, d\\xi + q_1 \\int_0^1 \\xi H_1(\\xi) \\, d\\xi + q_2 \\int_0^1 \\xi^2 H_1(\\xi) \\, d\\xi \\right)\n$$\n我们分别计算每个积分：\n$$\n\\int_0^1 H_1(\\xi) \\, d\\xi = \\int_0^1 (1 - 3\\xi^2 + 2\\xi^3) \\, d\\xi = \\left[ \\xi - \\xi^3 + \\frac{2}{4}\\xi^4 \\right]_0^1 = 1 - 1 + \\frac{1}{2} = \\frac{1}{2}\n$$\n$$\n\\int_0^1 \\xi H_1(\\xi) \\, d\\xi = \\int_0^1 (\\xi - 3\\xi^3 + 2\\xi^4) \\, d\\xi = \\left[ \\frac{1}{2}\\xi^2 - \\frac{3}{4}\\xi^4 + \\frac{2}{5}\\xi^5 \\right]_0^1 = \\frac{1}{2} - \\frac{3}{4} + \\frac{2}{5} = \\frac{10-15+8}{20} = \\frac{3}{20}\n$$\n$$\n\\int_0^1 \\xi^2 H_1(\\xi) \\, d\\xi = \\int_0^1 (\\xi^2 - 3\\xi^4 + 2\\xi^5) \\, d\\xi = \\left[ \\frac{1}{3}\\xi^3 - \\frac{3}{5}\\xi^5 + \\frac{2}{6}\\xi^6 \\right]_0^1 = \\frac{1}{3} - \\frac{3}{5} + \\frac{1}{3} = \\frac{2}{3} - \\frac{3}{5} = \\frac{10-9}{15} = \\frac{1}{15}\n$$\n将这些结果代回，我们得到 $F_{v1}^{(l)}$ 的表达式：\n$$\nF_{v1}^{(l)} = L \\left( \\frac{1}{2} q_0 + \\frac{3}{20} q_1 + \\frac{1}{15} q_2 \\right)\n$$\n第二步是将局部节点荷载转换到全局坐标系。力/力矩向量的变换由 $\\mathbf{f}^{(g)} = \\mathbf{T}^T \\mathbf{f}^{(l)}$ 给出。完整的变换矩阵 $\\mathbf{T}$ 是块对角矩阵，由两个 $3 \\times 3$ 的旋转矩阵 $\\mathbf{R}$ 组成。因此，节点1处节点荷载的变换为：\n$$\n\\begin{bmatrix} F_{X1}^{(g)} \\\\ F_{Y1}^{(g)} \\\\ M_{Z1}^{(g)} \\end{bmatrix} = \\mathbf{R}^T \\begin{bmatrix} F_{u1}^{(l)} \\\\ F_{v1}^{(l)} \\\\ M_1^{(l)} \\end{bmatrix}\n$$\n给定旋转矩阵 $\\mathbf{R}$ 的转置为：\n$$\n\\mathbf{R}^T = \\begin{bmatrix}\n\\cos\\theta  -\\sin\\theta  0 \\\\\n\\sin\\theta  \\cos\\theta  0 \\\\\n0  0  1\n\\end{bmatrix}\n$$\n进行矩阵-向量乘法，得到节点1处荷载的全局 $X$ 分量 $F_{X1}^{(g)}$ 为：\n$$\nF_{X1}^{(g)} = F_{u1}^{(l)} \\cos\\theta - F_{v1}^{(l)} \\sin\\theta\n$$\n如前所述，由于作用的分布荷载是纯横向的，局部轴向力分量 $F_{u1}^{(l)}$ 为零。因此，该表达式简化为：\n$$\nF_{X1}^{(g)} = - F_{v1}^{(l)} \\sin\\theta\n$$\n最后，代入推导出的 $F_{v1}^{(l)}$ 表达式，即可得到所需的全局荷载分量：\n$$\nF_{X1}^{(g)} = -L \\left( \\frac{1}{2} q_0 + \\frac{3}{20} q_1 + \\frac{1}{15} q_2 \\right) \\sin\\theta\n$$\n该表达式即为最终答案，用指定的常数 $q_0$、$q_1$、$q_2$、$L$ 和 $\\theta$ 表示。",
            "answer": "$$ \\boxed{-L \\left( \\frac{1}{2} q_0 + \\frac{3}{20} q_1 + \\frac{1}{15} q_2 \\right) \\sin\\theta} $$"
        },
        {
            "introduction": "本练习旨在解决计算力学中的一个更高级也更微妙的挑战：如何处理材料属性或几何方向沿单元长度变化的单元（例如功能梯度材料或曲梁）。通过一个编程实践()，您将探索“先变换后积分”（物理上一致）与“先积分后变换”（一种常见但可能不准确的简化方法）之间的关键差异。通过量化比较这两种方法的结果，您将深刻理解数值积分与坐标变换之间的耦合关系，这对于精确模拟复杂结构至关重要。",
            "id": "3554988",
            "problem": "考虑一个嵌入在二维环境空间中的一维弯曲单元。令单元参数表示为 $\\xi \\in [-1,1]$。在每个 $\\xi$ 位置，存在一个局部正交归一材料标架，该标架通过一个正常正交旋转场 $R(\\xi) \\in \\mathbb{R}^{2 \\times 2}$ 与全局标架相关联，该旋转场由一个连续可微的角度函数 $\\theta(\\xi)$（角度以弧度为单位）定义。由于材料的功能梯度特性，局部材料刚度是空间变化的。该单元承受一个在局部材料标架中指定的分布载荷。\n\n您的推导和实现必须严格从适用于计算固体力学的基本原理出发：\n- 刚性旋转下的标架不变性和基变换：一个正常正交矩阵 $R(\\xi)$ 满足 $R(\\xi)^\\top R(\\xi) = I$，二次型的基变换对应于 $Q^{glob}(\\xi) = R(\\xi)^\\top Q^{loc}(\\xi) R(\\xi)$。\n- 线性叠加和通过高斯-勒让德求积进行的数值积分：一个积分 $\\int_{-1}^{1} g(\\xi)\\, d\\xi$ 通过使用 $n$ 个高斯点 $\\{\\xi_i\\}$ 和权重 $\\{w_i\\}$ 的加权和 $\\sum_{i=1}^{n} w_i\\, g(\\xi_i)$ 来近似。\n\n在 $\\xi \\in [-1,1]$ 上定义以下场：\n- 旋转场 $R(\\xi)$ 由下式给出\n$$\nR(\\xi) =\n\\begin{bmatrix}\n\\cos\\theta(\\xi)  -\\sin\\theta(\\xi) \\\\\n\\sin\\theta(\\xi)  \\phantom{-}\\cos\\theta(\\xi)\n\\end{bmatrix}.\n$$\n- 功能梯度材料的局部刚度矩阵 $K^{loc}(\\xi) \\in \\mathbb{R}^{2 \\times 2}$，建模为对角、半正定矩阵\n$$\nK^{loc}(\\xi) =\n\\begin{bmatrix}\nk_t(\\xi)  0 \\\\\n0  k_n(\\xi)\n\\end{bmatrix}, \\quad\nk_t(\\xi) = k_0 \\left(1 + \\alpha\\, \\xi\\right)^p, \\quad\nk_n(\\xi) = \\beta\\, k_t(\\xi),\n$$\n其中 $k_0 > 0$，$\\alpha \\in \\mathbb{R}$，$p \\ge 1$ 且 $\\beta \\ge 0$。\n- 局部分布载荷向量 $f^{loc}(\\xi) \\in \\mathbb{R}^2$ 由下式给出\n$$\nf^{loc}(\\xi) =\n\\begin{bmatrix}\nq_t(\\xi) \\\\\nq_n(\\xi)\n\\end{bmatrix}, \\quad\nq_t(\\xi) = q_0 \\left(1 + \\gamma\\, \\xi\\right), \\quad\nq_n(\\xi) = \\frac{1}{2}\\, q_0 \\cos\\left(\\pi\\, \\xi\\right),\n$$\n其中 $q_0 \\in \\mathbb{R}$ 且 $\\gamma \\in \\mathbb{R}$。\n\n根据基变换原理，在参数 $\\xi$ 处的标架一致的全局刚度密度和全局载荷密度由下式给出\n$$\nK^{glob}(\\xi) = R(\\xi)^\\top K^{loc}(\\xi) R(\\xi), \\qquad\nf^{glob}(\\xi) = R(\\xi)^\\top f^{loc}(\\xi).\n$$\n单元一致的聚合量是以下积分\n$$\nS_{cons} = \\int_{-1}^{1} K^{glob}(\\xi)\\, d\\xi, \\qquad\nL_{cons} = \\int_{-1}^{1} f^{glob}(\\xi)\\, d\\xi,\n$$\n使用具有 $n$ 个点的高斯-勒让德求积进行数值计算，其中 $n$ 是一个固定的较小整数。一种常用但可能不一致的捷径方法，是用在单元中心评估的单个旋转 $\\bar{R} = R(0)$ 来替代空间变化的旋转，并在积分后进行变换：\n$$\nS_{naive} = \\bar{R}^\\top \\left( \\int_{-1}^{1} K^{loc}(\\xi)\\, d\\xi \\right) \\bar{R}, \\qquad\nL_{naive} = \\bar{R}^\\top \\left( \\int_{-1}^{1} f^{loc}(\\xi)\\, d\\xi \\right).\n$$\n\n任务：\n1. 从上述基本原理出发，推导 $S_{cons}$、$L_{cons}$ 和 $S_{naive}$、$L_{naive}$ 的标架一致公式和捷径（朴素）公式，并明确显示旋转场 $R(\\xi)$ 在积分内部的作用。\n2. 使用在 $\\xi \\in [-1,1]$ 上的 $n=8$ 点高斯-勒让德求积法，实现这两种公式。\n3. 对于下面提供的每个测试用例，计算相对一致性误差\n$$\ne_K = \\frac{\\left\\| S_{naive} - S_{cons} \\right\\|_F}{\\left\\| S_{cons} \\right\\|_F}, \\qquad\ne_F = \\frac{\\left\\| L_{naive} - L_{cons} \\right\\|_2}{\\left\\| L_{cons} \\right\\|_2},\n$$\n其中 $\\|\\cdot\\|_F$ 表示矩阵的弗罗贝尼乌斯范数，$\\|\\cdot\\|_2$ 表示向量的欧几里得范数。\n4. 角度必须以弧度处理。最终的数值答案是无量纲实数。\n\n测试套件（每个用例定义了 $\\theta(\\xi)$、$k_0$、$\\alpha$、$p$、$\\beta$、$q_0$、$\\gamma$）：\n- 用例 1（缓慢变化的旋转，轻度梯度）：$\\theta(\\xi) = \\left(\\frac{\\pi}{6}\\right)\\, \\xi$, $k_0 = 1$, $\\alpha = 0.2$, $p = 2$, $\\beta = 0.3$, $q_0 = 1.0$, $\\gamma = 0.1$。\n- 用例 2（快速变化的旋转，较强梯度）：$\\theta(\\xi) = \\left(\\frac{\\pi}{2}\\right)\\, \\sin(\\pi\\, \\xi)$, $k_0 = 1$, $\\alpha = 0.5$, $p = 3$, $\\beta = 0.5$, $q_0 = 1.0$, $\\gamma = 0.5$。\n- 用例 3（恒定旋转，可变刚度）：$\\theta(\\xi) = \\frac{\\pi}{4}$, $k_0 = 1$, $\\alpha = 0.8$, $p = 2$, $\\beta = 0.2$, $q_0 = 2.0$, $\\gamma = 0.3$。\n- 用例 4（奇次三次旋转，恒定刚度）：$\\theta(\\xi) = \\pi\\, \\xi^3$, $k_0 = 1$, $\\alpha = 0.0$, $p = 1$, $\\beta = 0.4$, $q_0 = 1.5$, $\\gamma = 0.0$。\n\n您的程序必须为每个用例计算 $(e_K, e_F)$，并生成单行输出，其中包含一个逗号分隔的列表，按 $[e_{K,1}, e_{F,1}, e_{K,2}, e_{F,2}, e_{K,3}, e_{F,3}, e_{K,4}, e_{F,4}]$ 的顺序列出 8 个浮点数结果，并用方括号括起来，整个计算过程中角度都应以弧度解释。",
            "solution": "该问题要求推导和比较计算一维弯曲单元的单元级聚合刚度和载荷向量的两种方法：一种是标架一致的方法，另一种是计算上更简单但可能不准确的捷径（朴素）方法。该比较通过相对误差度量进行量化。该问题是适定的，其科学基础是计算固体力学的原理，并包含获得唯一数值解所需的所有信息。\n\n### 1. 公式推导\n\n设所有场变量均为单元参数 $\\xi \\in [-1, 1]$ 的函数。从局部材料标架到全局标架的旋转由角度 $\\theta(\\xi)$ 给出，它定义了正常正交旋转矩阵：\n$$\nR(\\xi) =\n\\begin{bmatrix}\n\\cos\\theta(\\xi)  -\\sin\\theta(\\xi) \\\\\n\\sin\\theta(\\xi)  \\cos\\theta(\\xi)\n\\end{bmatrix}\n$$\n局部刚度矩阵 $K^{loc}(\\xi)$ 和局部分布载荷向量 $f^{loc}(\\xi)$ 如下所示：\n$$\nK^{loc}(\\xi) =\n\\begin{bmatrix}\nk_t(\\xi)  0 \\\\\n0  k_n(\\xi)\n\\end{bmatrix}, \\qquad\nf^{loc}(\\xi) =\n\\begin{bmatrix}\nq_t(\\xi) \\\\\nq_n(\\xi)\n\\end{bmatrix}\n$$\n\n#### 1.1. 标架一致公式\n此公式在积分前，对单元上每一点 $\\xi$ 都遵循标架不变性。全局刚度和载荷密度 $K^{glob}(\\xi)$ 和 $f^{glob}(\\xi)$，首先通过将局部量变换到全局标架中进行逐点计算。\n\n全局载荷密度 $f^{glob}(\\xi)$ 通过向量的基变换法则求得：\n$$\nf^{glob}(\\xi) = R(\\xi)^\\top f^{loc}(\\xi) =\n\\begin{bmatrix}\n\\cos\\theta(\\xi)  \\sin\\theta(\\xi) \\\\\n-\\sin\\theta(\\xi)  \\cos\\theta(\\xi)\n\\end{bmatrix}\n\\begin{bmatrix}\nq_t(\\xi) \\\\\nq_n(\\xi)\n\\end{bmatrix}\n=\n\\begin{bmatrix}\nq_t(\\xi)\\cos\\theta(\\xi) + q_n(\\xi)\\sin\\theta(\\xi) \\\\\n-q_t(\\xi)\\sin\\theta(\\xi) + q_n(\\xi)\\cos\\theta(\\xi)\n\\end{bmatrix}\n$$\n全局刚度密度 $K^{glob}(\\xi)$ 通过二次型（或二阶张量）的基变换法则求得：\n$$\nK^{glob}(\\xi) = R(\\xi)^\\top K^{loc}(\\xi) R(\\xi)\n$$\n执行矩阵乘法可得：\n$$\nK^{glob}(\\xi) =\n\\begin{bmatrix}\n\\cos\\theta(\\xi)  \\sin\\theta(\\xi) \\\\\n-\\sin\\theta(\\xi)  \\cos\\theta(\\xi)\n\\end{bmatrix}\n\\begin{bmatrix}\nk_t(\\xi)  0 \\\\\n0  k_n(\\xi)\n\\end{bmatrix}\n\\begin{bmatrix}\n\\cos\\theta(\\xi)  -\\sin\\theta(\\xi) \\\\\n\\sin\\theta(\\xi)  \\cos\\theta(\\xi)\n\\end{bmatrix}\n$$\n$$\nK^{glob}(\\xi) =\n\\begin{bmatrix}\nk_t(\\xi)\\cos^2\\theta(\\xi) + k_n(\\xi)\\sin^2\\theta(\\xi)  (k_n(\\xi) - k_t(\\xi))\\cos\\theta(\\xi)\\sin\\theta(\\xi) \\\\\n(k_n(\\xi) - k_t(\\xi))\\cos\\theta(\\xi)\\sin\\theta(\\xi)  k_t(\\xi)\\sin^2\\theta(\\xi) + k_n(\\xi)\\cos^2\\theta(\\xi)\n\\end{bmatrix}\n$$\n单元一致的聚合量 $S_{cons}$ 和 $L_{cons}$ 是这些全局密度在单元域上的积分：\n$$\nS_{cons} = \\int_{-1}^{1} K^{glob}(\\xi) \\,d\\xi, \\qquad L_{cons} = \\int_{-1}^{1} f^{glob}(\\xi) \\,d\\xi\n$$\n这些积分使用 $n$ 点高斯-勒让德求积法进行计算。对于一个通用被积函数 $g(\\xi)$：\n$$\n\\int_{-1}^{1} g(\\xi) \\,d\\xi \\approx \\sum_{i=1}^{n} w_i g(\\xi_i)\n$$\n其中 $\\{\\xi_i\\}$ 是高斯点，$\\{w_i\\}$ 是对应的权重。对于本问题，$n=8$。因此，一致的聚合量计算如下：\n$$\nS_{cons} \\approx \\sum_{i=1}^{8} w_i K^{glob}(\\xi_i), \\qquad L_{cons} \\approx \\sum_{i=1}^{8} w_i f^{glob}(\\xi_i)\n$$\n\n#### 1.2. 捷径（朴素）公式\n此公式颠倒了运算顺序：它首先对局部量进行积分，然后基于单元中心点 $\\xi=0$ 应用单个旋转。\n\n首先，计算积分后的局部刚度和载荷：\n$$\nK^{loc}_{int} = \\int_{-1}^{1} K^{loc}(\\xi) \\,d\\xi = \\int_{-1}^{1} \\begin{bmatrix} k_t(\\xi)  0 \\\\ 0  k_n(\\xi) \\end{bmatrix} \\,d\\xi = \\begin{bmatrix} \\int_{-1}^{1} k_t(\\xi) \\,d\\xi  0 \\\\ 0  \\int_{-1}^{1} k_n(\\xi) \\,d\\xi \\end{bmatrix}\n$$\n$$\nf^{loc}_{int} = \\int_{-1}^{1} f^{loc}(\\xi) \\,d\\xi = \\int_{-1}^{1} \\begin{bmatrix} q_t(\\xi) \\\\ q_n(\\xi) \\end{bmatrix} \\,d\\xi = \\begin{bmatrix} \\int_{-1}^{1} q_t(\\xi) \\,d\\xi \\\\ \\int_{-1}^{1} q_n(\\xi) \\,d\\xi \\end{bmatrix}\n$$\n这些积分使用相同的高斯求积方案进行数值计算：\n$$\nK^{loc}_{int} \\approx \\sum_{i=1}^{8} w_i K^{loc}(\\xi_i), \\qquad f^{loc}_{int} \\approx \\sum_{i=1}^{8} w_i f^{loc}(\\xi_i)\n$$\n接下来，在单元中心 $\\xi=0$ 处评估一个单一的、恒定的旋转矩阵 $\\bar{R}$：\n$$\n\\bar{R} = R(0) =\n\\begin{bmatrix}\n\\cos\\theta(0)  -\\sin\\theta(0) \\\\\n\\sin\\theta(0)  \\cos\\theta(0)\n\\end{bmatrix}\n$$\n然后，通过将这个单一旋转应用于积分后的局部量来计算朴素聚合量 $S_{naive}$ 和 $L_{naive}$：\n$$\nS_{naive} = \\bar{R}^\\top K^{loc}_{int} \\bar{R}, \\qquad L_{naive} = \\bar{R}^\\top f^{loc}_{int}\n$$\n只有当旋转场 $R(\\xi)$ 在整个单元上为常数时，这种方法才是精确的，此时对于所有 $\\xi \\in [-1, 1]$ 都有 $\\bar{R} = R(\\xi)$。\n\n### 2. 误差度量\n两种公式之间的差异使用相对一致性误差 $e_K$ 和 $e_F$ 来衡量。\n\n刚度矩阵的误差使用弗罗贝尼乌斯范数 $\\|A\\|_F = \\sqrt{\\sum_{i,j} |A_{ij}|^2}$ 来衡量：\n$$\ne_K = \\frac{\\| S_{naive} - S_{cons} \\|_F}{\\| S_{cons} \\|_F}\n$$\n载荷向量的误差使用欧几里得范数（或 $L_2$-范数）$\\|v\\|_2 = \\sqrt{\\sum_i |v_i|^2}$ 来衡量：\n$$\ne_F = \\frac{\\| L_{naive} - L_{cons} \\|_2}{\\| L_{cons} \\|_2}\n$$\n如果 $S_{cons}$ 或 $L_{cons}$ 的范数为零，则相应的误差取为零，这种情况当且仅当分子也为零时发生。\n\n### 3. 计算步骤\n对于每个测试用例，数值实现将按以下步骤进行：\n1. 为该用例定义与参数相关的函数：$\\theta(\\xi)$、$k_t(\\xi)$、$k_n(\\xi)$、$q_t(\\xi)$ 和 $q_n(\\xi)$。\n2. 获取 $n=8$ 个高斯-勒让德求积点 $\\xi_i$ 和权重 $w_i$。\n3. 将四个累加器初始化为零：$S_{cons}$、$L_{cons}$、$K^{loc}_{int}$ 和 $f^{loc}_{int}$。\n4. 遍历 8 个高斯点。在每个点 $\\xi_i$ 处：\n    a. 评估所有场函数：$\\theta(\\xi_i)$、$k_t(\\xi_i)$、$k_n(\\xi_i)$、$q_t(\\xi_i)$ 和 $q_n(\\xi_i)$。\n    b. 构建矩阵 $R(\\xi_i)$ 和 $K^{loc}(\\xi_i)$，以及向量 $f^{loc}(\\xi_i)$。\n    c. 计算全局密度 $K^{glob}(\\xi_i) = R(\\xi_i)^\\top K^{loc}(\\xi_i) R(\\xi_i)$ 和 $f^{glob}(\\xi_i) = R(\\xi_i)^\\top f^{loc}(\\xi_i)$。\n    d. 将加权贡献添加到一致性总和中：$S_{cons} \\leftarrow S_{cons} + w_i K^{glob}(\\xi_i)$ 和 $L_{cons} \\leftarrow L_{cons} + w_i f^{glob}(\\xi_i)$。\n    e. 将加权贡献添加到中间朴素总和中：$K^{loc}_{int} \\leftarrow K^{loc}_{int} + w_i K^{loc}(\\xi_i)$ 和 $f^{loc}_{int} \\leftarrow f^{loc}_{int} + w_i f^{loc}(\\xi_i)$。\n5. 循环结束后，计算朴素聚合量：\n    a. 评估 $\\bar{R} = R(0)$。\n    b. 计算 $S_{naive} = \\bar{R}^\\top K^{loc}_{int} \\bar{R}$ 和 $L_{naive} = \\bar{R}^\\top f^{loc}_{int}$。\n6. 最后，使用指定的范数定义计算相对误差 $e_K$ 和 $e_F$。这两个值构成了该测试用例的结果。\n对所有四个测试用例重复此过程。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes consistency errors for two different FEA formulations.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case: (theta_func, k0, alpha, p, beta, q0, gamma)\n    test_cases = [\n        (lambda xi: (np.pi / 6.0) * xi, 1.0, 0.2, 2, 0.3, 1.0, 0.1),\n        (lambda xi: (np.pi / 2.0) * np.sin(np.pi * xi), 1.0, 0.5, 3, 0.5, 1.0, 0.5),\n        (lambda xi: np.pi / 4.0, 1.0, 0.8, 2, 0.2, 2.0, 0.3),\n        (lambda xi: np.pi * (xi**3), 1.0, 0.0, 1, 0.4, 1.5, 0.0),\n    ]\n\n    # Number of Gauss-Legendre quadrature points\n    n_gauss = 8\n    gauss_points, gauss_weights = np.polynomial.legendre.leggauss(n_gauss)\n\n    results = []\n\n    for case in test_cases:\n        theta_func, k0, alpha, p, beta, q0, gamma = case\n\n        # Define material and load functions based on case parameters\n        def k_t(xi):\n            return k0 * (1.0 + alpha * xi)**p\n\n        def k_n(xi):\n            return beta * k_t(xi)\n\n        def q_t(xi):\n            return q0 * (1.0 + gamma * xi)\n\n        def q_n(xi):\n            return 0.5 * q0 * np.cos(np.pi * xi)\n\n        # Initialize aggregators\n        S_cons = np.zeros((2, 2))\n        L_cons = np.zeros(2)\n        K_loc_int = np.zeros((2, 2))\n        f_loc_int = np.zeros(2)\n\n        # Perform Gauss-Legendre quadrature\n        for i in range(n_gauss):\n            xi = gauss_points[i]\n            w = gauss_weights[i]\n\n            # Evaluate fields at the current Gauss point\n            th = theta_func(xi)\n            kt_val = k_t(xi)\n            kn_val = k_n(xi)\n            qt_val = q_t(xi)\n            qn_val = q_n(xi)\n            \n            # Construct local matrices and vectors\n            K_loc = np.array([[kt_val, 0.0], [0.0, kn_val]])\n            f_loc = np.array([qt_val, qn_val])\n\n            # Construct rotation matrix\n            c, s = np.cos(th), np.sin(th)\n            R = np.array([[c, -s], [s, c]])\n            R_T = R.T\n            \n            # --- Consistent Formulation: Transform then Integrate ---\n            K_glob = R_T @ K_loc @ R\n            f_glob = R_T @ f_loc\n            \n            S_cons += w * K_glob\n            L_cons += w * f_glob\n            \n            # --- Naive Formulation: Integrate then Transform ---\n            K_loc_int += w * K_loc\n            f_loc_int += w * f_loc\n\n        # Finalize the naive formulation calculation\n        th_0 = theta_func(0.0)\n        c0, s0 = np.cos(th_0), np.sin(th_0)\n        R_bar = np.array([[c0, -s0], [s0, c0]])\n        R_bar_T = R_bar.T\n\n        S_naive = R_bar_T @ K_loc_int @ R_bar\n        L_naive = R_bar_T @ f_loc_int\n        \n        # Calculate relative consistency errors\n        norm_S_cons = np.linalg.norm(S_cons, 'fro')\n        if norm_S_cons == 0.0:\n            e_K = 0.0\n        else:\n            e_K = np.linalg.norm(S_naive - S_cons, 'fro') / norm_S_cons\n\n        norm_L_cons = np.linalg.norm(L_cons)\n        if norm_L_cons == 0.0:\n            e_F = 0.0\n        else:\n            e_F = np.linalg.norm(L_naive - L_cons) / norm_L_cons\n        \n        results.extend([e_K, e_F])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}