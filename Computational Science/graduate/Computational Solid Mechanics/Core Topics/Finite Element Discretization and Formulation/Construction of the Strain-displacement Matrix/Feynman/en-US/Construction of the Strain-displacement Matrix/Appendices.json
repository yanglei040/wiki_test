{
    "hands_on_practices": [
        {
            "introduction": "The strain-displacement matrix, or $B$ matrix, forms the heart of the finite element method for stress analysis, directly linking discrete nodal displacements to the continuous strain field. Before assembling this matrix for a full element, it is essential to understand its fundamental structure. This practice guides you through the derivation of a single nodal block, $B_i$, directly from the first principles of continuum strain and displacement interpolation, revealing the \"atomic unit\" of the strain-displacement relationship for any 2D element .",
            "id": "3553225",
            "problem": "Consider a two-dimensional ($2$D) small-strain kinematic setting in computational solid mechanics under the plane strain assumption. Let the displacement field be $\\boldsymbol{u}(x,y) = (u(x,y), v(x,y))^{\\mathsf T}$, and let the small strain tensor be defined from first principles by the symmetric gradient of displacement, $\\boldsymbol{\\varepsilon} = \\mathrm{sym}\\,\\nabla \\boldsymbol{u} = \\tfrac{1}{2}(\\nabla \\boldsymbol{u} + (\\nabla \\boldsymbol{u})^{\\mathsf T})$. In the Voigt mapping for plane strain, define the strain vector by $\\varepsilon_v = [\\varepsilon_{xx}, \\varepsilon_{yy}, \\gamma_{xy}]^{\\mathsf T}$ where $\\gamma_{xy} = 2\\,\\varepsilon_{xy}$. Assume a standard finite element interpolation of the displacement field using scalar shape functions $N_i(x,y)$ and nodal degrees of freedom $d_i = [u_i, v_i]^{\\mathsf T}$, so that $u(x,y) \\approx \\sum_i N_i(x,y)\\,u_i$ and $v(x,y) \\approx \\sum_i N_i(x,y)\\,v_i$.\n\nStarting solely from the given definition $\\boldsymbol{\\varepsilon} = \\mathrm{sym}\\,\\nabla \\boldsymbol{u}$ and the plane strain Voigt mapping, derive the strain-displacement relation in Voigt form $\\varepsilon_v = B\\,\\mathbf{d}$, where $\\mathbf{d}$ collects the nodal degrees of freedom, and explicitly obtain the $3\\times 2$ block $B_i$ associated with a single node $i$. Express $B_i$ entirely in terms of spatial derivatives $\\frac{\\partial N_i}{\\partial x}$ and $\\frac{\\partial N_i}{\\partial y}$ of the shape function $N_i(x,y)$.\n\nYour final answer must be a single, closed-form analytic expression for the $3\\times 2$ block $B_i$.",
            "solution": "The problem is valid. It is a standard, well-posed derivation in the field of computational solid mechanics based on established principles of continuum mechanics and the finite element method. All definitions and conditions are self-contained, consistent, and scientifically sound.\n\nThe objective is to derive the explicit form of the $3 \\times 2$ strain-displacement block matrix, denoted as $B_i$, associated with a single node $i$ in a two-dimensional finite element model under the plane strain assumption. The relationship is given by $\\varepsilon_v = B\\,\\mathbf{d}$, where $\\varepsilon_v$ is the strain vector in Voigt notation and $\\mathbf{d}$ is the global vector of nodal degrees of freedom.\n\nWe begin with the provided finite element interpolation for the two components of the displacement field, $u(x,y)$ and $v(x,y)$, in terms of the scalar shape functions $N_i(x,y)$ and the nodal displacement components $u_i$ and $v_i$:\n$$\nu(x,y) = \\sum_i N_i(x,y) u_i\n$$\n$$\nv(x,y) = \\sum_i N_i(x,y) v_i\n$$\nThe summation is over all nodes in the element. The nodal displacement vector for node $i$ is $d_i = [u_i, v_i]^{\\mathsf T}$.\n\nThe components of the small strain tensor $\\boldsymbol{\\varepsilon}$ are defined by the symmetric part of the displacement gradient. For a two-dimensional problem, the relevant components are:\n$$\n\\varepsilon_{xx} = \\frac{\\partial u}{\\partial x}\n$$\n$$\n\\varepsilon_{yy} = \\frac{\\partial v}{\\partial y}\n$$\n$$\n\\varepsilon_{xy} = \\frac{1}{2} \\left( \\frac{\\partial u}{\\partial y} + \\frac{\\partial v}{\\partial x} \\right)\n$$\nThe problem specifies the use of the Voigt mapping for plane strain, where the strain vector is $\\varepsilon_v = [\\varepsilon_{xx}, \\varepsilon_{yy}, \\gamma_{xy}]^{\\mathsf T}$. The engineering shear strain $\\gamma_{xy}$ is defined as $\\gamma_{xy} = 2\\,\\varepsilon_{xy}$. Substituting the definition of $\\varepsilon_{xy}$ gives:\n$$\n\\gamma_{xy} = 2 \\left[ \\frac{1}{2} \\left( \\frac{\\partial u}{\\partial y} + \\frac{\\partial v}{\\partial x} \\right) \\right] = \\frac{\\partial u}{\\partial y} + \\frac{\\partial v}{\\partial x}\n$$\nNext, we compute the required spatial derivatives of the interpolated displacement field:\n$$\n\\frac{\\partial u}{\\partial x} = \\frac{\\partial}{\\partial x} \\left( \\sum_i N_i(x,y) u_i \\right) = \\sum_i \\frac{\\partial N_i}{\\partial x} u_i\n$$\n$$\n\\frac{\\partial v}{\\partial y} = \\frac{\\partial}{\\partial y} \\left( \\sum_i N_i(x,y) v_i \\right) = \\sum_i \\frac{\\partial N_i}{\\partial y} v_i\n$$\n$$\n\\frac{\\partial u}{\\partial y} = \\frac{\\partial}{\\partial y} \\left( \\sum_i N_i(x,y) u_i \\right) = \\sum_i \\frac{\\partial N_i}{\\partial y} u_i\n$$\n$$\n\\frac{\\partial v}{\\partial x} = \\frac{\\partial}{\\partial x} \\left( \\sum_i N_i(x,y) v_i \\right) = \\sum_i \\frac{\\partial N_i}{\\partial x} v_i\n$$\nNote that the nodal displacements $u_i$ and $v_i$ are constants with respect to the spatial coordinates $(x,y)$.\n\nNow, we substitute these derivatives into the expressions for the components of the Voigt strain vector:\n$$\n\\varepsilon_{xx} = \\sum_i \\frac{\\partial N_i}{\\partial x} u_i\n$$\n$$\n\\varepsilon_{yy} = \\sum_i \\frac{\\partial N_i}{\\partial y} v_i\n$$\n$$\n\\gamma_{xy} = \\left( \\sum_i \\frac{\\partial N_i}{\\partial y} u_i \\right) + \\left( \\sum_i \\frac{\\partial N_i}{\\partial x} v_i \\right) = \\sum_i \\left( \\frac{\\partial N_i}{\\partial y} u_i + \\frac{\\partial N_i}{\\partial x} v_i \\right)\n$$\nWe can write these three equations in a single matrix-vector equation for $\\varepsilon_v$:\n$$\n\\varepsilon_v = \\begin{pmatrix} \\varepsilon_{xx} \\\\ \\varepsilon_{yy} \\\\ \\gamma_{xy} \\end{pmatrix} =\n\\begin{pmatrix}\n\\sum_i \\frac{\\partial N_i}{\\partial x} u_i \\\\\n\\sum_i \\frac{\\partial N_i}{\\partial y} v_i \\\\\n\\sum_i \\left( \\frac{\\partial N_i}{\\partial y} u_i + \\frac{\\partial N_i}{\\partial x} v_i \\right)\n\\end{pmatrix}\n$$\nThe linearity of the summation allows us to rewrite this as a sum over the contributions from each node:\n$$\n\\varepsilon_v = \\sum_i\n\\begin{pmatrix}\n\\frac{\\partial N_i}{\\partial x} u_i \\\\\n\\frac{\\partial N_i}{\\partial y} v_i \\\\\n\\frac{\\partial N_i}{\\partial y} u_i + \\frac{\\partial N_i}{\\partial x} v_i\n\\end{pmatrix}\n$$\nThe expression inside the summation is the contribution to the strain from the degrees of freedom of node $i$. We seek to find the matrix $B_i$ such that this contribution can be written as $B_i d_i$, where $d_i = [u_i, v_i]^{\\mathsf T}$.\n$$\nB_i d_i =\nB_i \\begin{pmatrix} u_i \\\\ v_i \\end{pmatrix} =\n\\begin{pmatrix}\n\\frac{\\partial N_i}{\\partial x} u_i \\\\\n\\frac{\\partial N_i}{\\partial y} v_i \\\\\n\\frac{\\partial N_i}{\\partial y} u_i + \\frac{\\partial N_i}{\\partial x} v_i\n\\end{pmatrix}\n$$\nWe can express the right-hand side in matrix form by inspection:\n$$\n\\begin{pmatrix}\n\\frac{\\partial N_i}{\\partial x} & 0 \\\\\n0 & \\frac{\\partial N_i}{\\partial y} \\\\\n\\frac{\\partial N_i}{\\partial y} & \\frac{\\partial N_i}{\\partial x}\n\\end{pmatrix}\n\\begin{pmatrix} u_i \\\\ v_i \\end{pmatrix}\n=\n\\begin{pmatrix}\n(\\frac{\\partial N_i}{\\partial x}) u_i + (0) v_i \\\\\n(0) u_i + (\\frac{\\partial N_i}{\\partial y}) v_i \\\\\n(\\frac{\\partial N_i}{\\partial y}) u_i + (\\frac{\\partial N_i}{\\partial x}) v_i\n\\end{pmatrix}\n$$\nThis matches the required form. Therefore, the $3 \\times 2$ block matrix $B_i$ associated with node $i$ is:\n$$\nB_i =\n\\begin{pmatrix}\n\\frac{\\partial N_i}{\\partial x} & 0 \\\\\n0 & \\frac{\\partial N_i}{\\partial y} \\\\\n\\frac{\\partial N_i}{\\partial y} & \\frac{\\partial N_i}{\\partial x}\n\\end{pmatrix}\n$$\nThis matrix contains only spatial derivatives of the shape function $N_i(x,y)$, as required. The full strain-displacement matrix $B$ is then constructed by assembling these blocks horizontally: $B = [B_1, B_2, \\dots]$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{\\partial N_i}{\\partial x} & 0 \\\\\n0 & \\frac{\\partial N_i}{\\partial y} \\\\\n\\frac{\\partial N_i}{\\partial y} & \\frac{\\partial N_i}{\\partial x}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "With the general block structure understood, we can now construct the complete $B$ matrix for a specific, foundational element: the linear constant strain triangle (CST). This hands-on calculation takes you through the entire process, from deriving the element's linear shape functions to assembling their constant gradients into the final $B$ matrix . This exercise is invaluable as it not only provides concrete practice but also demonstrates a crucial concept: how the simple, constant form of the $B$ matrix for this element dictates its uniform strain behavior and its inherent inability to model complex states like pure bending.",
            "id": "2635801",
            "problem": "Consider a two-dimensional linear triangular finite element (often called the Constant Strain Triangle) used in the Finite Element Method (FEM) for small-strain plane problems. Let the three nodes have Cartesian coordinates $(x_{1},y_{1})=(0,0)$, $(x_{2},y_{2})=(3,0)$, and $(x_{3},y_{3})=(1,2)$. The element has the usual linear shape functions $N_{1}(x,y)$, $N_{2}(x,y)$, and $N_{3}(x,y)$, each a linear polynomial in $x$ and $y$, satisfying the Kronecker-delta nodal interpolation property $N_{i}(x_{j},y_{j})=\\delta_{ij}$ and the partition of unity $\\sum_{i=1}^{3}N_{i}(x,y)=1$. The displacement field is interpolated as $u(x,y)=\\sum_{i=1}^{3}N_{i}(x,y)\\,u_{i}$ and $v(x,y)=\\sum_{i=1}^{3}N_{i}(x,y)\\,v_{i}$, where $u_{i}$ and $v_{i}$ are the nodal displacement components at node $i$ in the $x$- and $y$-directions, respectively. The small-strain vector is defined as $\\boldsymbol{\\varepsilon}=\\begin{pmatrix}\\varepsilon_{x} & \\varepsilon_{y} & \\gamma_{xy}\\end{pmatrix}^{\\mathsf{T}}=\\begin{pmatrix}\\frac{\\partial u}{\\partial x} & \\frac{\\partial v}{\\partial y} & \\frac{\\partial u}{\\partial y} + \\frac{\\partial v}{\\partial x}\\end{pmatrix}^{\\mathsf{T}}$. By definition of the element strain-displacement matrix, $\\boldsymbol{\\varepsilon}=\\mathbf{B}\\,\\mathbf{d}$ with $\\mathbf{d}=\\begin{pmatrix}u_{1} & v_{1} & u_{2} & v_{2} & u_{3} & v_{3}\\end{pmatrix}^{\\mathsf{T}}$.\n\nStarting only from the fundamental properties of the shape functions stated above and the definition of small strain, perform the following:\n\n1) Construct the linear shape functions $N_{1}(x,y)$, $N_{2}(x,y)$, and $N_{3}(x,y)$ consistent with the given nodal coordinates, and compute their constant gradients $\\frac{\\partial N_{i}}{\\partial x}$ and $\\frac{\\partial N_{i}}{\\partial y}$.\n\n2) Assemble the element strain-displacement matrix $\\mathbf{B}$ such that $\\boldsymbol{\\varepsilon}=\\mathbf{B}\\,\\mathbf{d}$, written in the standard ordering $\\boldsymbol{\\varepsilon}=\\begin{pmatrix}\\varepsilon_{x} & \\varepsilon_{y} & \\gamma_{xy}\\end{pmatrix}^{\\mathsf{T}}$ and $\\mathbf{d}=\\begin{pmatrix}u_{1} & v_{1} & u_{2} & v_{2} & u_{3} & v_{3}\\end{pmatrix}^{\\mathsf{T}}$.\n\n3) Using only first principles, explain why the matrix $\\mathbf{B}$ is constant over the element domain, and deduce the consequences: that the element produces a uniform (constant) strain field under any nodal displacement vector and therefore cannot represent a pure bending state that requires a spatially varying normal strain. Make your argument by characterizing the most general displacement field the element can produce and differentiating it.\n\nProvide the final $\\mathbf{B}$ matrix with exact rational entries. Do not round. Your final boxed answer must be the single matrix $\\mathbf{B}$ without units.",
            "solution": "The problem statement is validated as scientifically grounded, well-posed, and objective. It represents a standard, fundamental exercise in the theory of the Finite Element Method. All provided data are self-contained and consistent. We proceed with the solution.\n\nThe problem requires the construction of the strain-displacement matrix $\\mathbf{B}$ for a linear triangular element, along with a first-principles explanation of its properties. This will be performed in three parts as requested.\n\n**Part 1: Construction of Shape Functions and Gradients**\n\nA linear shape function for a two-dimensional element has the general form:\n$$N_{i}(x,y) = \\alpha_{i0} + \\alpha_{i1} x + \\alpha_{i2} y$$\nThe three coefficients for each shape function are determined by enforcing the Kronecker-delta property, $N_{i}(x_{j},y_{j})=\\delta_{ij}$, at the three nodes. The given nodal coordinates are $(x_{1},y_{1})=(0,0)$, $(x_{2},y_{2})=(3,0)$, and $(x_{3},y_{3})=(1,2)$.\n\nFor shape function $N_{1}(x,y)$:\n1. $N_{1}(x_{1},y_{1})=N_{1}(0,0) = \\alpha_{10} = 1$\n2. $N_{1}(x_{2},y_{2})=N_{1}(3,0) = \\alpha_{10} + 3\\alpha_{11} = 1 + 3\\alpha_{11} = 0 \\implies \\alpha_{11} = -1/3$\n3. $N_{1}(x_{3},y_{3})=N_{1}(1,2) = \\alpha_{10} + \\alpha_{11} + 2\\alpha_{12} = 1 - 1/3 + 2\\alpha_{12} = 0 \\implies 2/3 + 2\\alpha_{12} = 0 \\implies \\alpha_{12} = -1/3$\nThus, $N_{1}(x,y) = 1 - \\frac{1}{3}x - \\frac{1}{3}y$.\n\nFor shape function $N_{2}(x,y)$:\n1. $N_{2}(x_{1},y_{1})=N_{2}(0,0) = \\alpha_{20} = 0$\n2. $N_{2}(x_{2},y_{2})=N_{2}(3,0) = \\alpha_{20} + 3\\alpha_{21} = 3\\alpha_{21} = 1 \\implies \\alpha_{21} = 1/3$\n3. $N_{2}(x_{3},y_{3})=N_{2}(1,2) = \\alpha_{20} + \\alpha_{21} + 2\\alpha_{22} = 1/3 + 2\\alpha_{22} = 0 \\implies \\alpha_{22} = -1/6$\nThus, $N_{2}(x,y) = \\frac{1}{3}x - \\frac{1}{6}y$.\n\nFor shape function $N_{3}(x,y)$:\n1. $N_{3}(x_{1},y_{1})=N_{3}(0,0) = \\alpha_{30} = 0$\n2. $N_{3}(x_{2},y_{2})=N_{3}(3,0) = \\alpha_{30} + 3\\alpha_{31} = 3\\alpha_{31} = 0 \\implies \\alpha_{31} = 0$\n3. $N_{3}(x_{3},y_{3})=N_{3}(1,2) = \\alpha_{30} + \\alpha_{31} + 2\\alpha_{32} = 2\\alpha_{32} = 1 \\implies \\alpha_{32} = 1/2$\nThus, $N_{3}(x,y) = \\frac{1}{2}y$.\n\nThe partition of unity condition, $\\sum_{i=1}^{3}N_{i}=1$, is satisfied:\n$$ \\left(1 - \\frac{1}{3}x - \\frac{1}{3}y\\right) + \\left(\\frac{1}{3}x - \\frac{1}{6}y\\right) + \\left(\\frac{1}{2}y\\right) = 1 + \\left(-\\frac{1}{3}+\\frac{1}{3}\\right)x + \\left(-\\frac{1}{3}-\\frac{1}{6}+\\frac{1}{2}\\right)y = 1 $$\nThe gradients of the shape functions are computed by direct differentiation. As the shape functions are linear polynomials in $x$ and $y$, their gradients are constant.\n$$ \\frac{\\partial N_{1}}{\\partial x} = -\\frac{1}{3}, \\quad \\frac{\\partial N_{1}}{\\partial y} = -\\frac{1}{3} $$\n$$ \\frac{\\partial N_{2}}{\\partial x} = \\frac{1}{3}, \\quad \\frac{\\partial N_{2}}{\\partial y} = -\\frac{1}{6} $$\n$$ \\frac{\\partial N_{3}}{\\partial x} = 0, \\quad \\frac{\\partial N_{3}}{\\partial y} = \\frac{1}{2} $$\n\n**Part 2: Assembly of the Strain-Displacement Matrix $\\mathbf{B}$**\n\nThe displacement field $(u, v)$ is interpolated from the nodal displacements $(u_i, v_i)$ using the shape functions:\n$$ u(x,y) = \\sum_{i=1}^{3} N_{i}(x,y) u_{i} = N_{1}u_{1} + N_{2}u_{2} + N_{3}u_{3} $$\n$$ v(x,y) = \\sum_{i=1}^{3} N_{i}(x,y) v_{i} = N_{1}v_{1} + N_{2}v_{2} + N_{3}v_{3} $$\nThe small-strain components are defined as:\n$$ \\varepsilon_{x} = \\frac{\\partial u}{\\partial x}, \\quad \\varepsilon_{y} = \\frac{\\partial v}{\\partial y}, \\quad \\gamma_{xy} = \\frac{\\partial u}{\\partial y} + \\frac{\\partial v}{\\partial x} $$\nBy substituting the interpolated displacement fields, we find the strains:\n$$ \\varepsilon_{x} = \\frac{\\partial}{\\partial x} \\left( \\sum_{i=1}^{3} N_{i} u_{i} \\right) = \\sum_{i=1}^{3} \\frac{\\partial N_{i}}{\\partial x} u_{i} = \\frac{\\partial N_{1}}{\\partial x}u_{1} + \\frac{\\partial N_{2}}{\\partial x}u_{2} + \\frac{\\partial N_{3}}{\\partial x}u_{3} $$\n$$ \\varepsilon_{y} = \\frac{\\partial}{\\partial y} \\left( \\sum_{i=1}^{3} N_{i} v_{i} \\right) = \\sum_{i=1}^{3} \\frac{\\partial N_{i}}{\\partial y} v_{i} = \\frac{\\partial N_{1}}{\\partial y}v_{1} + \\frac{\\partial N_{2}}{\\partial y}v_{2} + \\frac{\\partial N_{3}}{\\partial y}v_{3} $$\n$$ \\gamma_{xy} = \\frac{\\partial}{\\partial y} \\left( \\sum_{i=1}^{3} N_{i} u_{i} \\right) + \\frac{\\partial}{\\partial x} \\left( \\sum_{i=1}^{3} N_{i} v_{i} \\right) = \\sum_{i=1}^{3} \\left( \\frac{\\partial N_{i}}{\\partial y} u_{i} + \\frac{\\partial N_{i}}{\\partial x} v_{i} \\right) $$\nThese expressions can be written in matrix form $\\boldsymbol{\\varepsilon} = \\mathbf{B} \\mathbf{d}$, where $\\mathbf{d} = \\begin{pmatrix} u_{1} & v_{1} & u_{2} & v_{2} & u_{3} & v_{3} \\end{pmatrix}^{\\mathsf{T}}$:\n$$\n\\begin{pmatrix} \\varepsilon_{x} \\\\ \\varepsilon_{y} \\\\ \\gamma_{xy} \\end{pmatrix} =\n\\begin{pmatrix}\n\\frac{\\partial N_{1}}{\\partial x} & 0 & \\frac{\\partial N_{2}}{\\partial x} & 0 & \\frac{\\partial N_{3}}{\\partial x} & 0 \\\\\n0 & \\frac{\\partial N_{1}}{\\partial y} & 0 & \\frac{\\partial N_{2}}{\\partial y} & 0 & \\frac{\\partial N_{3}}{\\partial y} \\\\\n\\frac{\\partial N_{1}}{\\partial y} & \\frac{\\partial N_{1}}{\\partial x} & \\frac{\\partial N_{2}}{\\partial y} & \\frac{\\partial N_{2}}{\\partial x} & \\frac{\\partial N_{3}}{\\partial y} & \\frac{\\partial N_{3}}{\\partial x}\n\\end{pmatrix}\n\\begin{pmatrix} u_{1} \\\\ v_{1} \\\\ u_{2} \\\\ v_{2} \\\\ u_{3} \\\\ v_{3} \\end{pmatrix}\n$$\nThe matrix $\\mathbf{B}$ is thus identified. Substituting the constant gradients computed in Part 1 yields the final result for this element:\n$$ \\mathbf{B} = \\begin{pmatrix}\n-\\frac{1}{3} & 0 & \\frac{1}{3} & 0 & 0 & 0 \\\\\n0 & -\\frac{1}{3} & 0 & -\\frac{1}{6} & 0 & \\frac{1}{2} \\\\\n-\\frac{1}{3} & -\\frac{1}{3} & -\\frac{1}{6} & \\frac{1}{3} & \\frac{1}{2} & 0\n\\end{pmatrix} $$\n\n**Part 3: First-Principles Explanation**\n\nThe constant-strain behavior of the linear triangular element is a direct consequence of the linearity of its shape functions.\n\n1.  **Why $\\mathbf{B}$ is constant:** The matrix $\\mathbf{B}$ is composed entirely of the first partial derivatives of the shape functions, $\\frac{\\partial N_{i}}{\\partial x}$ and $\\frac{\\partial N_{i}}{\\partial y}$. By definition, the shape functions $N_i(x, y)$ for this element type are linear polynomials of the form $\\alpha_{i0} + \\alpha_{i1} x + \\alpha_{i2} y$. The partial derivative of such a function with respect to $x$ or $y$ is a constant ($\\alpha_{i1}$ or $\\alpha_{i2}$, respectively). Since every entry in the $\\mathbf{B}$ matrix is one of these constant gradients (or zero), the entire matrix $\\mathbf{B}$ is constant across the element domain. Its values depend only on the nodal coordinates, which define the geometry, and not on the position $(x, y)$ within the element.\n\n2.  **Consequences (Constant Strain and failure to model bending):**\n    The displacement field, $u(x,y)$ and $v(x,y)$, is a linear combination of the linear shape functions. A linear combination of linear polynomials results in another linear polynomial. Therefore, the most general displacement field this element can represent is of the form:\n    $$ u(x,y) = c_{1} + c_{2}x + c_{3}y $$\n    $$ v(x,y) = c_{4} + c_{5}x + c_{6}y $$\n    where the coefficients $c_{k}$ are constants determined by the nodal displacements.\n    The strains are obtained by differentiating this displacement field:\n    $$ \\varepsilon_{x} = \\frac{\\partial u}{\\partial x} = c_{2} $$\n    $$ \\varepsilon_{y} = \\frac{\\partial v}{\\partial y} = c_{6} $$\n    $$ \\gamma_{xy} = \\frac{\\partial u}{\\partial y} + \\frac{\\partial v}{\\partial x} = c_{3} + c_{5} $$\n    The strain components are constants throughout the element. This is why the element is known as the Constant Strain Triangle (CST).\n\n    Pure bending, however, is fundamentally characterized by a linearly varying strain field. For instance, a beam bending in the $x-y$ plane has a normal strain $\\varepsilon_x$ that is a linear function of $y$, such as $\\varepsilon_{x}(y) = \\kappa y$, where $\\kappa$ is the curvature. A constant strain field can only be a non-constant linear function if both the constant and the slope are zero, which is the trivial case of no deformation. The CST element, by its formulation, is restricted to producing only a single, constant value for each strain component within its domain. It is therefore constitutionally incapable of representing the strain gradient essential to a pure bending state. An assemblage of such elements can only approximate a bending moment with a piecewise-constant \"staircase\" of stress, which is a poor representation and leads to numerical pathologies such as shear locking.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-\\frac{1}{3} & 0 & \\frac{1}{3} & 0 & 0 & 0 \\\\\n0 & -\\frac{1}{3} & 0 & -\\frac{1}{6} & 0 & \\frac{1}{2} \\\\\n-\\frac{1}{3} & -\\frac{1}{3} & -\\frac{1}{6} & \\frac{1}{3} & \\frac{1}{2} & 0\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "A mastery of the $B$ matrix is critical not only for basic formulation but also for diagnosing and remedying numerical issues in advanced elements. This practice explores the phenomenon of shear locking in Timoshenko beam elements, a numerical pathology where overly stiff behavior emerges in thin-beam bending scenarios. By constructing the shear component of the strain-displacement matrix, $\\mathbf{B}_{s}$, and then deriving an effective operator, $\\bar{\\mathbf{B}}_{s}$, based on reduced integration, you will see firsthand how the formulation of the $B$ matrix is central to element performance and how it can be intelligently modified to achieve more accurate results .",
            "id": "3553277",
            "problem": "Consider a two-node isoparametric Timoshenko beam finite element in the Finite Element Method (FEM), of physical length $L$, with local natural coordinate $\\xi \\in [-1,1]$ and linear Lagrange interpolation for both the transverse displacement $w(\\xi)$ and the cross-section rotation $\\theta(\\xi)$. Let the nodal degrees of freedom be collected in the vector $\\mathbf{d} = (w_{1}, \\theta_{1}, w_{2}, \\theta_{2})^{\\mathsf{T}}$. The element mapping is linear, so $x(\\xi)$ satisfies $\\frac{dx}{d\\xi} = \\frac{L}{2}$. The shape functions are $N_{1}(\\xi) = \\frac{1 - \\xi}{2}$ and $N_{2}(\\xi) = \\frac{1 + \\xi}{2}$, with $w(\\xi) = N_{1}(\\xi)\\, w_{1} + N_{2}(\\xi)\\, w_{2}$ and $\\theta(\\xi) = N_{1}(\\xi)\\, \\theta_{1} + N_{2}(\\xi)\\, \\theta_{2}$.\n\nUse the Timoshenko beam kinematics, in which the engineering shear strain is defined by the fundamental relation $\\gamma(x) = \\frac{dw}{dx} - \\theta(x)$, and construct the shear strain–displacement operator $\\mathbf{B}_{s}(\\xi)$ such that $\\gamma(x(\\xi)) = \\mathbf{B}_{s}(\\xi)\\, \\mathbf{d}$. Then, model selective reduced integration by projecting the shear strain field onto the element’s constant subspace, i.e., replace $\\gamma(x)$ by its element average $\\bar{\\gamma} = \\frac{1}{L}\\int_{0}^{L} \\gamma(x)\\, dx$, and thereby obtain the effective constant shear strain–displacement operator $\\bar{\\mathbf{B}}_{s}$ satisfying $\\bar{\\gamma} = \\bar{\\mathbf{B}}_{s}\\, \\mathbf{d}$.\n\nStarting only from the above kinematic definitions and the given interpolation, derive the explicit symbolic expression for the reduced-integration effective operator $\\bar{\\mathbf{B}}_{s}$ in terms of $L$. Your final answer must be the single $1 \\times 4$ row vector expression for $\\bar{\\mathbf{B}}_{s}$. No numerical evaluation is required. Express the final answer in a closed-form analytic expression.",
            "solution": "The problem requires the derivation of the effective constant shear strain-displacement operator, $\\bar{\\mathbf{B}}_{s}$, for a two-node Timoshenko beam element using selective reduced integration. The derivation will proceed by first establishing the kinematic relationships in terms of the nodal degrees of freedom and the natural coordinate $\\xi$, then calculating the average shear strain over the element, and finally identifying the operator $\\bar{\\mathbf{B}}_{s}$ that relates this average strain to the nodal displacement vector $\\mathbf{d}$.\n\nThe problem provides the following givens:\n- Nodal degrees of freedom vector: $\\mathbf{d} = (w_{1}, \\theta_{1}, w_{2}, \\theta_{2})^{\\mathsf{T}}$.\n- Linear Lagrange shape functions: $N_{1}(\\xi) = \\frac{1 - \\xi}{2}$ and $N_{2}(\\xi) = \\frac{1 + \\xi}{2}$ for $\\xi \\in [-1,1]$.\n- Interpolated transverse displacement $w(\\xi)$ and cross-section rotation $\\theta(\\xi)$:\n$$w(\\xi) = N_{1}(\\xi)\\, w_{1} + N_{2}(\\xi)\\, w_{2}$$\n$$\\theta(\\xi) = N_{1}(\\xi)\\, \\theta_{1} + N_{2}(\\xi)\\, \\theta_{2}$$\n- Linear coordinate mapping from the natural coordinate $\\xi$ to the physical coordinate $x$: $\\frac{dx}{d\\xi} = \\frac{L}{2}$. This is the Jacobian of the transformation, $J$.\n- Engineering shear strain definition from Timoshenko beam theory: $\\gamma(x) = \\frac{dw}{dx} - \\theta(x)$.\n- Definition of the element-average shear strain: $\\bar{\\gamma} = \\frac{1}{L}\\int_{0}^{L} \\gamma(x)\\, dx$.\n- The target relation is $\\bar{\\gamma} = \\bar{\\mathbf{B}}_{s}\\,\\mathbf{d}$.\n\nFirst, we express the derivative of the transverse displacement, $\\frac{dw}{dx}$, in terms of the natural coordinate $\\xi$ and the nodal displacements. Using the chain rule for differentiation:\n$$\\frac{dw}{d\\xi} = \\frac{dw}{dx} \\frac{dx}{d\\xi}$$\nWe can solve for $\\frac{dw}{dx}$:\n$$\\frac{dw}{dx} = \\frac{dw}{d\\xi} \\left(\\frac{dx}{d\\xi}\\right)^{-1}$$\nGiven that $\\frac{dx}{d\\xi} = \\frac{L}{2}$, its inverse is $\\left(\\frac{dx}{d\\xi}\\right)^{-1} = \\frac{2}{L}$.\n\nNext, we calculate the derivative of the interpolated displacement field $w(\\xi)$ with respect to $\\xi$:\n$$w(\\xi) = \\left(\\frac{1 - \\xi}{2}\\right) w_{1} + \\left(\\frac{1 + \\xi}{2}\\right) w_{2}$$\n$$\\frac{dw}{d\\xi} = \\frac{d}{d\\xi}\\left[\\left(\\frac{1 - \\xi}{2}\\right) w_{1} + \\left(\\frac{1 + \\xi}{2}\\right) w_{2}\\right] = -\\frac{1}{2} w_{1} + \\frac{1}{2} w_{2}$$\nSubstituting this back into the expression for $\\frac{dw}{dx}$:\n$$\\frac{dw}{dx} = \\left(-\\frac{1}{2} w_{1} + \\frac{1}{2} w_{2}\\right) \\frac{2}{L} = \\frac{1}{L}(-w_{1} + w_{2})$$\nNote that for linear shape functions, the term $\\frac{dw}{dx}$ becomes constant throughout the element.\n\nNow, we can write the expression for the shear strain $\\gamma$ at a point $\\xi$ within the element:\n$$\\gamma(\\xi) = \\frac{dw}{dx} - \\theta(\\xi) = \\frac{1}{L}(-w_{1} + w_{2}) - \\left[N_{1}(\\xi)\\, \\theta_{1} + N_{2}(\\xi)\\, \\theta_{2}\\right]$$\nSubstituting the expressions for the shape functions:\n$$\\gamma(\\xi) = \\frac{1}{L}(-w_{1} + w_{2}) - \\left(\\frac{1 - \\xi}{2}\\right) \\theta_{1} - \\left(\\frac{1 + \\xi}{2}\\right) \\theta_{2}$$\nThis expression shows that the shear strain $\\gamma(\\xi)$ varies linearly with $\\xi$.\n\nThe problem asks for an effective constant strain operator based on the average shear strain $\\bar{\\gamma}$ over the element length $L$. The average strain is defined as:\n$$\\bar{\\gamma} = \\frac{1}{L}\\int_{0}^{L} \\gamma(x)\\, dx$$\nTo evaluate this integral, we change the integration variable from the physical coordinate $x$ to the natural coordinate $\\xi$. The differential element of length is $dx = \\frac{dx}{d\\xi} d\\xi = \\frac{L}{2} d\\xi$. The integration limits in the physical domain, $x \\in [0, L]$, correspond to the natural domain, $\\xi \\in [-1, 1]$.\n$$\\bar{\\gamma} = \\frac{1}{L}\\int_{-1}^{1} \\gamma(\\xi) \\left(\\frac{L}{2}\\right) d\\xi = \\frac{1}{2}\\int_{-1}^{1} \\gamma(\\xi)\\, d\\xi$$\nNow, substitute the expression for $\\gamma(\\xi)$:\n$$\\bar{\\gamma} = \\frac{1}{2}\\int_{-1}^{1} \\left[ \\frac{1}{L}(-w_{1} + w_{2}) - \\left(\\frac{1 - \\xi}{2}\\right) \\theta_{1} - \\left(\\frac{1 + \\xi}{2}\\right) \\theta_{2} \\right] d\\xi$$\nWe integrate term by term. The nodal degrees of freedom $w_1, w_2, \\theta_1, \\theta_2$ are constants with respect to the integration variable $\\xi$.\nThe integral of the first term is:\n$$\\int_{-1}^{1} \\frac{1}{L}(-w_{1} + w_{2}) d\\xi = \\frac{1}{L}(-w_{1} + w_{2}) \\int_{-1}^{1} 1\\, d\\xi = \\frac{1}{L}(-w_{1} + w_{2}) [\\xi]_{-1}^{1} = \\frac{2}{L}(-w_{1} + w_{2})$$\nThe integral of the second term is:\n$$\\int_{-1}^{1} -\\left(\\frac{1 - \\xi}{2}\\right) \\theta_{1} d\\xi = -\\frac{\\theta_{1}}{2} \\int_{-1}^{1} (1 - \\xi) d\\xi = -\\frac{\\theta_{1}}{2} \\left[\\xi - \\frac{\\xi^2}{2}\\right]_{-1}^{1} = -\\frac{\\theta_{1}}{2} \\left[ \\left(1-\\frac{1}{2}\\right) - \\left(-1-\\frac{1}{2}\\right) \\right] = -\\frac{\\theta_{1}}{2} \\left( \\frac{1}{2} + \\frac{3}{2} \\right) = - \\theta_{1}$$\nThe integral of the third term is:\n$$\\int_{-1}^{1} -\\left(\\frac{1 + \\xi}{2}\\right) \\theta_{2} d\\xi = -\\frac{\\theta_{2}}{2} \\int_{-1}^{1} (1 + \\xi) d\\xi = -\\frac{\\theta_{2}}{2} \\left[\\xi + \\frac{\\xi^2}{2}\\right]_{-1}^{1} = -\\frac{\\theta_{2}}{2} \\left[ \\left(1+\\frac{1}{2}\\right) - \\left(-1+\\frac{1}{2}\\right) \\right] = -\\frac{\\theta_{2}}{2} \\left( \\frac{3}{2} + \\frac{1}{2} \\right) = - \\theta_{2}$$\nCombining these results:\n$$\\int_{-1}^{1} \\gamma(\\xi)\\, d\\xi = \\frac{2}{L}(-w_{1} + w_{2}) - \\theta_{1} - \\theta_{2}$$\nNow, we apply the pre-factor $\\frac{1}{2}$ to get the average strain $\\bar{\\gamma}$:\n$$\\bar{\\gamma} = \\frac{1}{2} \\left[ \\frac{2}{L}(-w_{1} + w_{2}) - \\theta_{1} - \\theta_{2} \\right] = \\frac{1}{L}(-w_{1} + w_{2}) - \\frac{1}{2}\\theta_{1} - \\frac{1}{2}\\theta_{2}$$\nTo find the operator $\\bar{\\mathbf{B}}_{s}$, we rearrange this expression to match the matrix form $\\bar{\\gamma} = \\bar{\\mathbf{B}}_{s}\\,\\mathbf{d}$:\n$$\\bar{\\gamma} = \\left(-\\frac{1}{L}\\right) w_{1} + \\left(-\\frac{1}{2}\\right) \\theta_{1} + \\left(\\frac{1}{L}\\right) w_{2} + \\left(-\\frac{1}{2}\\right) \\theta_{2}$$\nThis can be written as the product of a row vector and the column vector of nodal DOFs:\n$$\\bar{\\gamma} = \\begin{pmatrix} -\\frac{1}{L} & -\\frac{1}{2} & \\frac{1}{L} & -\\frac{1}{2} \\end{pmatrix} \\begin{pmatrix} w_{1} \\\\ \\theta_{1} \\\\ w_{2} \\\\ \\theta_{2} \\end{pmatrix}$$\nBy comparing this with the target relation $\\bar{\\gamma} = \\bar{\\mathbf{B}}_{s}\\,\\mathbf{d}$, we identify the effective constant shear strain-displacement operator $\\bar{\\mathbf{B}}_{s}$ as the $1 \\times 4$ row vector:\n$$\\bar{\\mathbf{B}}_{s} = \\begin{pmatrix} -\\frac{1}{L} & -\\frac{1}{2} & \\frac{1}{L} & -\\frac{1}{2} \\end{pmatrix}$$\nThis result corresponds to evaluating the full, spatially varying operator $\\mathbf{B}_{s}(\\xi)$ at the element's center, $\\xi=0$, which is the location of the single Gauss point used for reduced integration of the shear stiffness matrix.",
            "answer": "$$ \\boxed{ \\begin{pmatrix} -\\frac{1}{L} & -\\frac{1}{2} & \\frac{1}{L} & -\\frac{1}{2} \\end{pmatrix} } $$"
        }
    ]
}