{
    "hands_on_practices": [
        {
            "introduction": "本练习将引导您完成为最简单的二维单元——常应变三角形（CST）——推导应变-位移矩阵（$B$ 矩阵）的基本过程。我们将从形函数和应变的基本定义出发，为一个具体的三角形显式构建其 $B$ 矩阵。这项实践对于理解单元的插值阶次与其力学行为之间的直接联系至关重要，例如，它解释了为何该单元无法捕捉弯曲等应变梯度。",
            "id": "2635801",
            "problem": "考虑一个用于小应变平面问题的二维线性三角形有限元（通常称为常应变三角形单元），该单元用于有限元法（FEM）中。设三个节点的笛卡尔坐标为 $(x_{1},y_{1})=(0,0)$、$(x_{2},y_{2})=(3,0)$ 和 $(x_{3},y_{3})=(1,2)$。该单元具有通常的线性形函数 $N_{1}(x,y)$、$N_{2}(x,y)$ 和 $N_{3}(x,y)$，每个函数都是关于 $x$ 和 $y$ 的线性多项式，满足 Kronecker-delta 节点插值性质 $N_{i}(x_{j},y_{j})=\\delta_{ij}$ 和单位分解性质 $\\sum_{i=1}^{3}N_{i}(x,y)=1$。位移场通过插值得到：$u(x,y)=\\sum_{i=1}^{3}N_{i}(x,y)\\,u_{i}$ 和 $v(x,y)=\\sum_{i=1}^{3}N_{i}(x,y)\\,v_{i}$，其中 $u_{i}$ 和 $v_{i}$ 分别是节点 $i$ 在 $x$ 和 $y$ 方向上的节点位移分量。小应变向量定义为 $\\boldsymbol{\\varepsilon}=\\begin{pmatrix}\\varepsilon_{x} & \\varepsilon_{y} & \\gamma_{xy}\\end{pmatrix}^{\\mathsf{T}}=\\begin{pmatrix}\\partial u/\\partial x & \\partial v/\\partial y & \\partial u/\\partial y + \\partial v/\\partial x\\end{pmatrix}^{\\mathsf{T}}$。根据单元应变-位移矩阵的定义，有 $\\boldsymbol{\\varepsilon}=\\mathbf{B}\\,\\mathbf{d}$，其中 $\\mathbf{d}=\\begin{pmatrix}u_{1} & v_{1} & u_{2} & v_{2} & u_{3} & v_{3}\\end{pmatrix}^{\\mathsf{T}}$。\n\n仅从上述形函数的基本性质和小应变的定义出发，完成以下任务：\n\n1) 根据给定的节点坐标，构造线性形函数 $N_{1}(x,y)$、$N_{2}(x,y)$ 和 $N_{3}(x,y)$，并计算它们的常数梯度 $\\partial N_{i}/\\partial x$ 和 $\\partial N_{i}/\\partial y$。\n\n2) 组装单元应变-位移矩阵 $\\mathbf{B}$，使得 $\\boldsymbol{\\varepsilon}=\\mathbf{B}\\,\\mathbf{d}$，并按标准顺序 $\\boldsymbol{\\varepsilon}=\\begin{pmatrix}\\varepsilon_{x} & \\varepsilon_{y} & \\gamma_{xy}\\end{pmatrix}^{\\mathsf{T}}$ 和 $\\mathbf{d}=\\begin{pmatrix}u_{1} & v_{1} & u_{2} & v_{2} & u_{3} & v_{3}\\end{pmatrix}^{\\mathsf{T}}$ 书写。\n\n3) 仅使用第一性原理，解释为什么矩阵 $\\mathbf{B}$ 在单元域上是常数，并推导其后果：即该单元在任何节点位移向量下都会产生均匀（常数）的应变场，因此不能表示需要空间变化的法向应变的纯弯曲状态。通过描述该单元能产生的最一般位移场的特征并对其进行微分来展开你的论证。\n\n提供最终的 $\\mathbf{B}$ 矩阵，其元素为精确的有理数。不要四舍五入。你最终在方框内的答案必须是无单位的单个矩阵 $\\mathbf{B}$。",
            "solution": "该问题陈述经核实具有科学依据，提法恰当且客观。它代表了有限元法理论中一个标准的、基础的练习。所有提供的数据都是自洽且一致的。我们开始求解。\n\n本问题要求构造一个线性三角形单元的应变-位移矩阵 $\\mathbf{B}$，并对其性质进行第一性原理解释。将按要求分三部分进行。\n\n**第1部分：形函数的构造及其梯度**\n\n二维单元的线性形函数具有以下一般形式：\n$$N_{i}(x,y) = \\alpha_{i0} + \\alpha_{i1} x + \\alpha_{i2} y$$\n每个形函数的三个系数通过在三个节点上施加 Kronecker-delta 性质 $N_{i}(x_{j},y_{j})=\\delta_{ij}$ 来确定。给定的节点坐标为 $(x_{1},y_{1})=(0,0)$、$(x_{2},y_{2})=(3,0)$ 和 $(x_{3},y_{3})=(1,2)$。\n\n对于形函数 $N_{1}(x,y)$:\n1. $N_{1}(x_{1},y_{1})=N_{1}(0,0) = \\alpha_{10} = 1$\n2. $N_{1}(x_{2},y_{2})=N_{1}(3,0) = \\alpha_{10} + 3\\alpha_{11} = 1 + 3\\alpha_{11} = 0 \\implies \\alpha_{11} = -1/3$\n3. $N_{1}(x_{3},y_{3})=N_{1}(1,2) = \\alpha_{10} + \\alpha_{11} + 2\\alpha_{12} = 1 - 1/3 + 2\\alpha_{12} = 0 \\implies 2/3 + 2\\alpha_{12} = 0 \\implies \\alpha_{12} = -1/3$\n因此，$N_{1}(x,y) = 1 - \\frac{1}{3}x - \\frac{1}{3}y$。\n\n对于形函数 $N_{2}(x,y)$:\n1. $N_{2}(x_{1},y_{1})=N_{2}(0,0) = \\alpha_{20} = 0$\n2. $N_{2}(x_{2},y_{2})=N_{2}(3,0) = \\alpha_{20} + 3\\alpha_{21} = 3\\alpha_{21} = 1 \\implies \\alpha_{21} = 1/3$\n3. $N_{2}(x_{3},y_{3})=N_{2}(1,2) = \\alpha_{20} + \\alpha_{21} + 2\\alpha_{22} = 1/3 + 2\\alpha_{22} = 0 \\implies \\alpha_{22} = -1/6$\n因此，$N_{2}(x,y) = \\frac{1}{3}x - \\frac{1}{6}y$。\n\n对于形函数 $N_{3}(x,y)$:\n1. $N_{3}(x_{1},y_{1})=N_{3}(0,0) = \\alpha_{30} = 0$\n2. $N_{3}(x_{2},y_{2})=N_{3}(3,0) = \\alpha_{30} + 3\\alpha_{31} = 3\\alpha_{31} = 0 \\implies \\alpha_{31} = 0$\n3. $N_{3}(x_{3},y_{3})=N_{3}(1,2) = \\alpha_{30} + \\alpha_{31} + 2\\alpha_{32} = 2\\alpha_{32} = 1 \\implies \\alpha_{32} = 1/2$\n因此，$N_{3}(x,y) = \\frac{1}{2}y$。\n\n单位分解条件 $\\sum_{i=1}^{3}N_{i}=1$ 得到满足：\n$$ \\left(1 - \\frac{1}{3}x - \\frac{1}{3}y\\right) + \\left(\\frac{1}{3}x - \\frac{1}{6}y\\right) + \\left(\\frac{1}{2}y\\right) = 1 + \\left(-\\frac{1}{3}+\\frac{1}{3}\\right)x + \\left(-\\frac{1}{3}-\\frac{1}{6}+\\frac{1}{2}\\right)y = 1 $$\n形函数的梯度通过直接微分计算。由于形函数是关于 $x$ 和 $y$ 的线性多项式，它们的梯度是常数。\n$$ \\frac{\\partial N_{1}}{\\partial x} = -\\frac{1}{3}, \\quad \\frac{\\partial N_{1}}{\\partial y} = -\\frac{1}{3} $$\n$$ \\frac{\\partial N_{2}}{\\partial x} = \\frac{1}{3}, \\quad \\frac{\\partial N_{2}}{\\partial y} = -\\frac{1}{6} $$\n$$ \\frac{\\partial N_{3}}{\\partial x} = 0, \\quad \\frac{\\partial N_{3}}{\\partial y} = \\frac{1}{2} $$\n\n**第2部分：应变-位移矩阵 $\\mathbf{B}$ 的组装**\n\n位移场 $(u, v)$ 由节点位移 $(u_i, v_i)$ 使用形函数插值得到：\n$$ u(x,y) = \\sum_{i=1}^{3} N_{i}(x,y) u_{i} = N_{1}u_{1} + N_{2}u_{2} + N_{3}u_{3} $$\n$$ v(x,y) = \\sum_{i=1}^{3} N_{i}(x,y) v_{i} = N_{1}v_{1} + N_{2}v_{2} + N_{3}v_{3} $$\n小应变分量定义为：\n$$ \\varepsilon_{x} = \\frac{\\partial u}{\\partial x}, \\quad \\varepsilon_{y} = \\frac{\\partial v}{\\partial y}, \\quad \\gamma_{xy} = \\frac{\\partial u}{\\partial y} + \\frac{\\partial v}{\\partial x} $$\n通过代入插值位移场，我们得到应变：\n$$ \\varepsilon_{x} = \\frac{\\partial}{\\partial x} \\left( \\sum_{i=1}^{3} N_{i} u_{i} \\right) = \\sum_{i=1}^{3} \\frac{\\partial N_{i}}{\\partial x} u_{i} = \\frac{\\partial N_{1}}{\\partial x}u_{1} + \\frac{\\partial N_{2}}{\\partial x}u_{2} + \\frac{\\partial N_{3}}{\\partial x}u_{3} $$\n$$ \\varepsilon_{y} = \\frac{\\partial}{\\partial y} \\left( \\sum_{i=1}^{3} N_{i} v_{i} \\right) = \\sum_{i=1}^{3} \\frac{\\partial N_{i}}{\\partial y} v_{i} = \\frac{\\partial N_{1}}{\\partial y}v_{1} + \\frac{\\partial N_{2}}{\\partial y}v_{2} + \\frac{\\partial N_{3}}{\\partial y}v_{3} $$\n$$ \\gamma_{xy} = \\frac{\\partial}{\\partial y} \\left( \\sum_{i=1}^{3} N_{i} u_{i} \\right) + \\frac{\\partial}{\\partial x} \\left( \\sum_{i=1}^{3} N_{i} v_{i} \\right) = \\sum_{i=1}^{3} \\left( \\frac{\\partial N_{i}}{\\partial y} u_{i} + \\frac{\\partial N_{i}}{\\partial x} v_{i} \\right) $$\n这些表达式可以写成矩阵形式 $\\boldsymbol{\\varepsilon} = \\mathbf{B} \\mathbf{d}$，其中 $\\mathbf{d} = \\begin{pmatrix} u_{1} & v_{1} & u_{2} & v_{2} & u_{3} & v_{3} \\end{pmatrix}^{\\mathsf{T}}$：\n$$\n\\begin{pmatrix} \\varepsilon_{x} \\\\ \\varepsilon_{y} \\\\ \\gamma_{xy} \\end{pmatrix} =\n\\begin{pmatrix}\n\\frac{\\partial N_{1}}{\\partial x} & 0 & \\frac{\\partial N_{2}}{\\partial x} & 0 & \\frac{\\partial N_{3}}{\\partial x} & 0 \\\\\n0 & \\frac{\\partial N_{1}}{\\partial y} & 0 & \\frac{\\partial N_{2}}{\\partial y} & 0 & \\frac{\\partial N_{3}}{\\partial y} \\\\\n\\frac{\\partial N_{1}}{\\partial y} & \\frac{\\partial N_{1}}{\\partial x} & \\frac{\\partial N_{2}}{\\partial y} & \\frac{\\partial N_{2}}{\\partial x} & \\frac{\\partial N_{3}}{\\partial y} & \\frac{\\partial N_{3}}{\\partial x}\n\\end{pmatrix}\n\\begin{pmatrix} u_{1} \\\\ v_{1} \\\\ u_{2} \\\\ v_{2} \\\\ u_{3} \\\\ v_{3} \\end{pmatrix}\n$$\n矩阵 $\\mathbf{B}$ 由此确定。代入第1部分计算出的常数梯度，得到该单元的最终结果：\n$$ \\mathbf{B} = \\begin{pmatrix}\n-\\frac{1}{3} & 0 & \\frac{1}{3} & 0 & 0 & 0 \\\\\n0 & -\\frac{1}{3} & 0 & -\\frac{1}{6} & 0 & \\frac{1}{2} \\\\\n-\\frac{1}{3} & -\\frac{1}{3} & -\\frac{1}{6} & \\frac{1}{3} & \\frac{1}{2} & 0\n\\end{pmatrix} $$\n\n**第3部分：第一性原理解释**\n\n线性三角形单元的常应变特性是其形函数线性的直接结果。\n\n1.  **为什么 $\\mathbf{B}$ 是常数：** 矩阵 $\\mathbf{B}$ 完全由形函数的一阶偏导数 $\\frac{\\partial N_{i}}{\\partial x}$ 和 $\\frac{\\partial N_{i}}{\\partial y}$ 组成。根据定义，该单元类型的形函数 $N_i(x, y)$ 是形式为 $\\alpha_{i0} + \\alpha_{i1} x + \\alpha_{i2} y$ 的线性多项式。此类函数关于 $x$ 或 $y$ 的偏导数是一个常数（分别为 $\\alpha_{i1}$ 或 $\\alpha_{i2}$）。由于 $\\mathbf{B}$ 矩阵中的每个元素都是这些常数梯度之一（或零），所以整个矩阵 $\\mathbf{B}$ 在单元域上是常数。其值仅取决于定义几何形状的节点坐标，而不取决于单元内的位置 $(x, y)$。\n\n2.  **后果（常应变及无法模拟弯曲）：**\n    位移场 $u(x,y)$ 和 $v(x,y)$ 是线性形函数的线性组合。线性多项式的线性组合会得到另一个线性多项式。因此，该单元能表示的最一般的位移场具有以下形式：\n    $$ u(x,y) = c_{1} + c_{2}x + c_{3}y $$\n    $$ v(x,y) = c_{4} + c_{5}x + c_{6}y $$\n    其中系数 $c_{k}$ 是由节点位移确定的常数。\n    对应变可通过对该位移场进行微分获得：\n    $$ \\varepsilon_{x} = \\frac{\\partial u}{\\partial x} = c_{2} $$\n    $$ \\varepsilon_{y} = \\frac{\\partial v}{\\partial y} = c_{6} $$\n    $$ \\gamma_{xy} = \\frac{\\partial u}{\\partial y} + \\frac{\\partial v}{\\partial x} = c_{3} + c_{5} $$\n    应变分量在整个单元内是常数。这就是为什么该单元被称为常应变三角形（CST）单元。\n\n    然而，纯弯曲的基本特征是线性变化的应变场。例如，在 $x-y$ 平面内弯曲的梁，其法向应变 $\\varepsilon_x$ 是 $y$ 的线性函数，如 $\\varepsilon_{x}(y) = \\kappa y$，其中 $\\kappa$ 是曲率。一个常数应变场无法表示一个非常数的线性函数（除非在无变形的平凡情况下，常数和斜率都为零）。CST单元根据其构造，被限制在其域内为每个应变分量仅能产生单一的常数值。因此，它从根本上无法表示纯弯曲状态所必需的应变梯度。此类单元的集合只能用分段常数的“阶梯状”应力来近似弯曲应力分布，这是一种很差的表示，并可能导致剪切自锁等数值病态问题。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-\\frac{1}{3} & 0 & \\frac{1}{3} & 0 & 0 & 0 \\\\\n0 & -\\frac{1}{3} & 0 & -\\frac{1}{6} & 0 & \\frac{1}{2} \\\\\n-\\frac{1}{3} & -\\frac{1}{3} & -\\frac{1}{6} & \\frac{1}{3} & \\frac{1}{2} & 0\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在完成一个具体算例后，我们现在转向一般性原理。本练习旨在推导与单个节点关联的应变-位移矩阵分块 $B_i$ 的通用结构。从连续介质力学中应变为位移对称梯度的基本定义出发，我们将建立一个适用于任何二维有限元的通用模板。掌握这一推导过程是理解有限元软件如何为各种单元类型构建这些矩阵的关键。",
            "id": "3553225",
            "problem": "在计算固体力学中，考虑平面应变假设下的二维（$2$D）小应变运动学背景。设位移场为 $u(x,y) = (u(x,y), v(x,y))^{\\mathsf T}$，并从位移对称梯度的基本定义出发，定义小应变张量为 $\\varepsilon = \\mathrm{sym}\\,\\nabla u = \\tfrac{1}{2}(\\nabla u + (\\nabla u)^{\\mathsf T})$。在平面应变的 Voigt 映射中，将应变向量定义为 $\\varepsilon_v = [\\varepsilon_{xx}, \\varepsilon_{yy}, \\gamma_{xy}]^{\\mathsf T}$，其中 $\\gamma_{xy} = 2\\,\\varepsilon_{xy}$。假设位移场采用标准的有限元插值，使用标量形函数 $N_i(x,y)$ 和节点自由度 $d_i = [u_i, v_i]^{\\mathsf T}$，因此有 $u(x,y) \\approx \\sum_i N_i(x,y)\\,u_i$ 和 $v(x,y) \\approx \\sum_i N_i(x,y)\\,v_i$。\n\n仅从给定的定义 $\\varepsilon = \\mathrm{sym}\\,\\nabla u$ 和平面应变 Voigt 映射出发，推导 Voigt 形式的应变-位移关系 $\\varepsilon_v = B\\,\\mathbf{d}$，其中 $\\mathbf{d}$ 集合了所有节点自由度，并显式地求出与单个节点 $i$ 相关联的 $3\\times 2$ 分块矩阵 $B_i$。将 $B_i$ 完全用形函数 $N_i(x,y)$ 的空间导数 $\\frac{\\partial N_i}{\\partial x}$ 和 $\\frac{\\partial N_i}{\\partial y}$ 来表示。\n\n你的最终答案必须是关于 $3\\times 2$ 分块矩阵 $B_i$ 的单个封闭形式解析表达式。",
            "solution": "该问题是有效的。这是计算固体力学领域中一个标准的、良定的推导，基于连续介质力学和有限元方法的既定原理。所有定义和条件都是自洽、一致且科学合理的。\n\n目标是在平面应变假设下，为一个二维有限元模型中的单个节点 $i$ 推导其关联的 $3 \\times 2$ 应变-位移分块矩阵（记为 $B_i$）的显式形式。该关系由 $\\varepsilon_v = B\\,\\mathbf{d}$ 给出，其中 $\\varepsilon_v$ 是 Voigt 记法下的应变向量，$\\mathbf{d}$ 是节点自由度的全局向量。\n\n我们从位移场两个分量 $u(x,y)$ 和 $v(x,y)$ 的有限元插值开始，这些插值是用标量形函数 $N_i(x,y)$ 和节点位移分量 $u_i$ 和 $v_i$ 表示的：\n$$\nu(x,y) = \\sum_i N_i(x,y) u_i\n$$\n$$\nv(x,y) = \\sum_i N_i(x,y) v_i\n$$\n求和遍及单元中的所有节点。节点 $i$ 的节点位移向量为 $d_i = [u_i, v_i]^{\\mathsf T}$。\n\n小应变张量 $\\varepsilon$ 的分量由位移梯度的对称部分定义。对于二维问题，相关分量为：\n$$\n\\varepsilon_{xx} = \\frac{\\partial u}{\\partial x}\n$$\n$$\n\\varepsilon_{yy} = \\frac{\\partial v}{\\partial y}\n$$\n$$\n\\varepsilon_{xy} = \\frac{1}{2} \\left( \\frac{\\partial u}{\\partial y} + \\frac{\\partial v}{\\partial x} \\right)\n$$\n问题指定使用平面应变的 Voigt 映射，其中应变向量为 $\\varepsilon_v = [\\varepsilon_{xx}, \\varepsilon_{yy}, \\gamma_{xy}]^{\\mathsf T}$。工程剪应变 $\\gamma_{xy}$ 定义为 $\\gamma_{xy} = 2\\,\\varepsilon_{xy}$。代入 $\\varepsilon_{xy}$ 的定义可得：\n$$\n\\gamma_{xy} = 2 \\left[ \\frac{1}{2} \\left( \\frac{\\partial u}{\\partial y} + \\frac{\\partial v}{\\partial x} \\right) \\right] = \\frac{\\partial u}{\\partial y} + \\frac{\\partial v}{\\partial x}\n$$\n接下来，我们计算插值位移场所需的空间导数：\n$$\n\\frac{\\partial u}{\\partial x} = \\frac{\\partial}{\\partial x} \\left( \\sum_i N_i(x,y) u_i \\right) = \\sum_i \\frac{\\partial N_i}{\\partial x} u_i\n$$\n$$\n\\frac{\\partial v}{\\partial y} = \\frac{\\partial}{\\partial y} \\left( \\sum_i N_i(x,y) v_i \\right) = \\sum_i \\frac{\\partial N_i}{\\partial y} v_i\n$$\n$$\n\\frac{\\partial u}{\\partial y} = \\frac{\\partial}{\\partial y} \\left( \\sum_i N_i(x,y) u_i \\right) = \\sum_i \\frac{\\partial N_i}{\\partial y} u_i\n$$\n$$\n\\frac{\\partial v}{\\partial x} = \\frac{\\partial}{\\partial x} \\left( \\sum_i N_i(x,y) v_i \\right) = \\sum_i \\frac{\\partial N_i}{\\partial x} v_i\n$$\n注意，节点位移 $u_i$ 和 $v_i$ 相对于空间坐标 $(x,y)$ 是常数。\n\n现在，我们将这些导数代入 Voigt 应变向量各分量的表达式中：\n$$\n\\varepsilon_{xx} = \\sum_i \\frac{\\partial N_i}{\\partial x} u_i\n$$\n$$\n\\varepsilon_{yy} = \\sum_i \\frac{\\partial N_i}{\\partial y} v_i\n$$\n$$\n\\gamma_{xy} = \\left( \\sum_i \\frac{\\partial N_i}{\\partial y} u_i \\right) + \\left( \\sum_i \\frac{\\partial N_i}{\\partial x} v_i \\right) = \\sum_i \\left( \\frac{\\partial N_i}{\\partial y} u_i + \\frac{\\partial N_i}{\\partial x} v_i \\right)\n$$\n我们可以将这三个方程写成关于 $\\varepsilon_v$ 的一个单一矩阵-向量方程：\n$$\n\\varepsilon_v = \\begin{pmatrix} \\varepsilon_{xx} \\\\ \\varepsilon_{yy} \\\\ \\gamma_{xy} \\end{pmatrix} =\n\\begin{pmatrix}\n\\sum_i \\frac{\\partial N_i}{\\partial x} u_i \\\\\n\\sum_i \\frac{\\partial N_i}{\\partial y} v_i \\\\\n\\sum_i \\left( \\frac{\\partial N_i}{\\partial y} u_i + \\frac{\\partial N_i}{\\partial x} v_i \\right)\n\\end{pmatrix}\n$$\n求和的线性性质允许我们将其重写为对每个节点贡献的求和：\n$$\n\\varepsilon_v = \\sum_i\n\\begin{pmatrix}\n\\frac{\\partial N_i}{\\partial x} u_i \\\\\n\\frac{\\partial N_i}{\\partial y} v_i \\\\\n\\frac{\\partial N_i}{\\partial y} u_i + \\frac{\\partial N_i}{\\partial x} v_i\n\\end{pmatrix}\n$$\n求和号内的表达式是来自节点 $i$ 自由度对应变的贡献。我们旨在找到矩阵 $B_i$，使得该贡献可以写成 $B_i d_i$ 的形式，其中 $d_i = [u_i, v_i]^{\\mathsf T}$。\n$$\nB_i d_i =\nB_i \\begin{pmatrix} u_i \\\\ v_i \\end{pmatrix} =\n\\begin{pmatrix}\n\\frac{\\partial N_i}{\\partial x} u_i \\\\\n\\frac{\\partial N_i}{\\partial y} v_i \\\\\n\\frac{\\partial N_i}{\\partial y} u_i + \\frac{\\partial N_i}{\\partial x} v_i\n\\end{pmatrix}\n$$\n通过观察，我们可以将右侧表示为矩阵形式：\n$$\n\\begin{pmatrix}\n\\frac{\\partial N_i}{\\partial x} & 0 \\\\\n0 & \\frac{\\partial N_i}{\\partial y} \\\\\n\\frac{\\partial N_i}{\\partial y} & \\frac{\\partial N_i}{\\partial x}\n\\end{pmatrix}\n\\begin{pmatrix} u_i \\\\ v_i \\end{pmatrix}\n=\n\\begin{pmatrix}\n(\\frac{\\partial N_i}{\\partial x}) u_i + (0) v_i \\\\\n(0) u_i + (\\frac{\\partial N_i}{\\partial y}) v_i \\\\\n(\\frac{\\partial N_i}{\\partial y}) u_i + (\\frac{\\partial N_i}{\\partial x}) v_i\n\\endpmatrix}\n$$\n这与所需的形式相匹配。因此，与节点 $i$ 相关联的 $3 \\times 2$ 分块矩阵 $B_i$ 是：\n$$\nB_i =\n\\begin{pmatrix}\n\\frac{\\partial N_i}{\\partial x} & 0 \\\\\n0 & \\frac{\\partial N_i}{\\partial y} \\\\\n\\frac{\\partial N_i}{\\partial y} & \\frac{\\partial N_i}{\\partial x}\n\\end{pmatrix}\n$$\n该矩阵仅包含形函数 $N_i(x,y)$ 的空间导数，符合要求。然后通过水平组装这些分块来构造完整的应变-位移矩阵 $B$：$B = [B_1, B_2, \\dots]$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{\\partial N_i}{\\partial x} & 0 \\\\\n0 & \\frac{\\partial N_i}{\\partial y} \\\\\n\\frac{\\partial N_i}{\\partial y} & \\frac{\\partial N_i}{\\partial x}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "本练习将运用我们对应变-位移矩阵的理解来诊断一种常见的数值病态问题：剪切自锁。我们将为铁木辛柯（Timoshenko）梁单元构建 $B$ 矩阵的剪切部分，并分析低阶插值如何导致单元表现出虚假的过刚行为。此外，我们还将探讨选择性减缩积分这一经典修正方法，展示如何通过修改 $B$ 矩阵的构建方式来显著改善单元的性能。",
            "id": "3553277",
            "problem": "考虑有限元法 (FEM) 中的一个二节点等参 Timoshenko 梁有限元，其物理长度为 $L$，局部自然坐标为 $\\xi \\in [-1,1]$，横向位移 $w(\\xi)$ 和横截面转角 $\\theta(\\xi)$ 均采用线性 Lagrange 插值。设节点自由度集于向量 $\\mathbf{d} = (w_{1}, \\theta_{1}, w_{2}, \\theta_{2})^{\\mathsf{T}}$。单元映射是线性的，因此 $x(\\xi)$ 满足 $\\frac{dx}{d\\xi} = \\frac{L}{2}$。形函数为 $N_{1}(\\xi) = \\frac{1 - \\xi}{2}$ 和 $N_{2}(\\xi) = \\frac{1 + \\xi}{2}$，其中 $w(\\xi) = N_{1}(\\xi)\\, w_{1} + N_{2}(\\xi)\\, w_{2}$ 且 $\\theta(\\xi) = N_{1}(\\xi)\\, \\theta_{1} + N_{2}(\\xi)\\, \\theta_{2}$。\n\n使用 Timoshenko 梁运动学，其中工程剪切应变由基本关系 $\\gamma(x) = \\frac{dw}{dx} - \\theta(x)$ 定义，并构造剪切应变-位移算子 $\\mathbf{B}_{s}(\\xi)$ 使得 $\\gamma(x(\\xi)) = \\mathbf{B}_{s}(\\xi)\\, \\mathbf{d}$。然后，通过将剪切应变场投影到单元的常数子空间上来模拟选择性减缩积分，即将 $\\gamma(x)$ 替换为其单元平均值 $\\bar{\\gamma} = \\frac{1}{L}\\int_{0}^{L} \\gamma(x)\\, dx$，并由此获得满足 $\\bar{\\gamma} = \\bar{\\mathbf{B}}_{s}\\, \\mathbf{d}$ 的等效常数剪切应变-位移算子 $\\bar{\\mathbf{B}}_{s}$。\n\n仅从上述运动学定义和给定的插值出发，推导减缩积分等效算子 $\\bar{\\mathbf{B}}_{s}$ 关于 $L$ 的显式符号表达式。您的最终答案必须是 $\\bar{\\mathbf{B}}_{s}$ 的单个 $1 \\times 4$ 行向量表达式。不需要进行数值计算。最终答案需用闭式解析表达式表示。",
            "solution": "问题要求使用选择性减缩积分，为一个二节点 Timoshenko 梁单元推导其等效常数剪切应变-位移算子 $\\bar{\\mathbf{B}}_{s}$。推导过程将首先用节点自由度和自然坐标 $\\xi$ 建立运动学关系，然后计算单元上的平均剪切应变，最后确定将此平均应变与节点位移向量 $\\mathbf{d}$ 相关联的算子 $\\bar{\\mathbf{B}}_{s}$。\n\n问题给出了以下已知条件：\n- 节点自由度向量： $\\mathbf{d} = (w_{1}, \\theta_{1}, w_{2}, \\theta_{2})^{\\mathsf{T}}$。\n- 对于 $\\xi \\in [-1,1]$，线性 Lagrange 形函数为： $N_{1}(\\xi) = \\frac{1 - \\xi}{2}$ 和 $N_{2}(\\xi) = \\frac{1 + \\xi}{2}$。\n- 插值得到的横向位移 $w(\\xi)$ 和横截面转角 $\\theta(\\xi)$：\n$$w(\\xi) = N_{1}(\\xi)\\, w_{1} + N_{2}(\\xi)\\, w_{2}$$\n$$\\theta(\\xi) = N_{1}(\\xi)\\, \\theta_{1} + N_{2}(\\xi)\\, \\theta_{2}$$\n- 从自然坐标 $\\xi$ 到物理坐标 $x$ 的线性坐标映射：$\\frac{dx}{d\\xi} = \\frac{L}{2}$。这是变换的雅可比矩阵 $J$。\n- Timoshenko 梁理论中的工程剪切应变定义： $\\gamma(x) = \\frac{dw}{dx} - \\theta(x)$。\n- 单元平均剪切应变的定义： $\\bar{\\gamma} = \\frac{1}{L}\\int_{0}^{L} \\gamma(x)\\, dx$。\n- 目标关系为 $\\bar{\\gamma} = \\bar{\\mathbf{B}}_{s}\\,\\mathbf{d}$。\n\n首先，我们用自然坐标 $\\xi$ 和节点位移来表示横向位移的导数 $\\frac{dw}{dx}$。使用链式法则求导：\n$$\\frac{dw}{d\\xi} = \\frac{dw}{dx} \\frac{dx}{d\\xi}$$\n我们可以解出 $\\frac{dw}{dx}$：\n$$\\frac{dw}{dx} = \\frac{dw}{d\\xi} \\left(\\frac{dx}{d\\xi}\\right)^{-1}$$\n已知 $\\frac{dx}{d\\xi} = \\frac{L}{2}$，其逆为 $\\left(\\frac{dx}{d\\xi}\\right)^{-1} = \\frac{2}{L}$。\n\n接下来，我们计算插值位移场 $w(\\xi)$ 关于 $\\xi$ 的导数：\n$$w(\\xi) = \\left(\\frac{1 - \\xi}{2}\\right) w_{1} + \\left(\\frac{1 + \\xi}{2}\\right) w_{2}$$\n$$\\frac{dw}{d\\xi} = \\frac{d}{d\\xi}\\left[\\left(\\frac{1 - \\xi}{2}\\right) w_{1} + \\left(\\frac{1 + \\xi}{2}\\right) w_{2}\\right] = -\\frac{1}{2} w_{1} + \\frac{1}{2} w_{2}$$\n将此代回 $\\frac{dw}{dx}$ 的表达式中：\n$$\\frac{dw}{dx} = \\left(-\\frac{1}{2} w_{1} + \\frac{1}{2} w_{2}\\right) \\frac{2}{L} = \\frac{1}{L}(-w_{1} + w_{2})$$\n注意，对于线性形函数，$\\frac{dw}{dx}$ 项在整个单元内为常数。\n\n现在，我们可以写出单元内一点 $\\xi$ 处的剪切应变 $\\gamma$ 的表达式：\n$$\\gamma(\\xi) = \\frac{dw}{dx} - \\theta(\\xi) = \\frac{1}{L}(-w_{1} + w_{2}) - \\left[N_{1}(\\xi)\\, \\theta_{1} + N_{2}(\\xi)\\, \\theta_{2}\\right]$$\n代入形函数的表达式：\n$$\\gamma(\\xi) = \\frac{1}{L}(-w_{1} + w_{2}) - \\left(\\frac{1 - \\xi}{2}\\right) \\theta_{1} - \\left(\\frac{1 + \\xi}{2}\\right) \\theta_{2}$$\n此表达式表明剪切应变 $\\gamma(\\xi)$ 随 $\\xi$ 线性变化。\n\n问题要求一个基于单元长度 $L$ 上的平均剪切应变 $\\bar{\\gamma}$ 的等效常数应变算子。平均应变定义为：\n$$\\bar{\\gamma} = \\frac{1}{L}\\int_{0}^{L} \\gamma(x)\\, dx$$\n为计算此积分，我们将积分变量从物理坐标 $x$ 变换为自然坐标 $\\xi$。长度微元为 $dx = \\frac{dx}{d\\xi} d\\xi = \\frac{L}{2} d\\xi$。物理域中的积分限 $x \\in [0, L]$ 对应于自然域中的 $\\xi \\in [-1, 1]$。\n$$\\bar{\\gamma} = \\frac{1}{L}\\int_{-1}^{1} \\gamma(\\xi) \\left(\\frac{L}{2}\\right) d\\xi = \\frac{1}{2}\\int_{-1}^{1} \\gamma(\\xi)\\, d\\xi$$\n现在，代入 $\\gamma(\\xi)$ 的表达式：\n$$\\bar{\\gamma} = \\frac{1}{2}\\int_{-1}^{1} \\left[ \\frac{1}{L}(-w_{1} + w_{2}) - \\left(\\frac{1 - \\xi}{2}\\right) \\theta_{1} - \\left(\\frac{1 + \\xi}{2}\\right) \\theta_{2} \\right] d\\xi$$\n我们逐项积分。节点自由度 $w_1, w_2, \\theta_1, \\theta_2$ 是相对于积分变量 $\\xi$ 的常数。\n第一项的积分为：\n$$\\int_{-1}^{1} \\frac{1}{L}(-w_{1} + w_{2}) d\\xi = \\frac{1}{L}(-w_{1} + w_{2}) \\int_{-1}^{1} 1\\, d\\xi = \\frac{1}{L}(-w_{1} + w_{2}) [\\xi]_{-1}^{1} = \\frac{2}{L}(-w_{1} + w_{2})$$\n第二项的积分为：\n$$\\int_{-1}^{1} -\\left(\\frac{1 - \\xi}{2}\\right) \\theta_{1} d\\xi = -\\frac{\\theta_{1}}{2} \\int_{-1}^{1} (1 - \\xi) d\\xi = -\\frac{\\theta_{1}}{2} \\left[\\xi - \\frac{\\xi^2}{2}\\right]_{-1}^{1} = -\\frac{\\theta_{1}}{2} \\left[ \\left(1-\\frac{1}{2}\\right) - \\left(-1-\\frac{1}{2}\\right) \\right] = -\\frac{\\theta_{1}}{2} \\left( \\frac{1}{2} + \\frac{3}{2} \\right) = - \\theta_{1}$$\n第三项的积分为：\n$$\\int_{-1}^{1} -\\left(\\frac{1 + \\xi}{2}\\right) \\theta_{2} d\\xi = -\\frac{\\theta_{2}}{2} \\int_{-1}^{1} (1 + \\xi) d\\xi = -\\frac{\\theta_{2}}{2} \\left[\\xi + \\frac{\\xi^2}{2}\\right]_{-1}^{1} = -\\frac{\\theta_{2}}{2} \\left[ \\left(1+\\frac{1}{2}\\right) - \\left(-1+\\frac{1}{2}\\right) \\right] = -\\frac{\\theta_{2}}{2} \\left( \\frac{3}{2} + \\frac{1}{2} \\right) = - \\theta_{2}$$\n综合这些结果：\n$$\\int_{-1}^{1} \\gamma(\\xi)\\, d\\xi = \\frac{2}{L}(-w_{1} + w_{2}) - \\theta_{1} - \\theta_{2}$$\n现在，我们乘以系数 $\\frac{1}{2}$ 来得到平均应变 $\\bar{\\gamma}$：\n$$\\bar{\\gamma} = \\frac{1}{2} \\left[ \\frac{2}{L}(-w_{1} + w_{2}) - \\theta_{1} - \\theta_{2} \\right] = \\frac{1}{L}(-w_{1} + w_{2}) - \\frac{1}{2}\\theta_{1} - \\frac{1}{2}\\theta_{2}$$\n为了找到算子 $\\bar{\\mathbf{B}}_{s}$，我们将此表达式重排以匹配矩阵形式 $\\bar{\\gamma} = \\bar{\\mathbf{B}}_{s}\\,\\mathbf{d}$：\n$$\\bar{\\gamma} = \\left(-\\frac{1}{L}\\right) w_{1} + \\left(-\\frac{1}{2}\\right) \\theta_{1} + \\left(\\frac{1}{L}\\right) w_{2} + \\left(-\\frac{1}{2}\\right) \\theta_{2}$$\n这可以写成一个行向量与节点自由度列向量的乘积：\n$$\\bar{\\gamma} = \\begin{pmatrix} -\\frac{1}{L} & -\\frac{1}{2} & \\frac{1}{L} & -\\frac{1}{2} \\end{pmatrix} \\begin{pmatrix} w_{1} \\\\ \\theta_{1} \\\\ w_{2} \\\\ \\theta_{2} \\end{pmatrix}$$\n将此与目标关系 $\\bar{\\gamma} = \\bar{\\mathbf{B}}_{s}\\,\\mathbf{d}$ 进行比较，我们确定等效常数剪切应变-位移算子 $\\bar{\\mathbf{B}}_{s}$ 为 $1 \\times 4$ 的行向量：\n$$\\bar{\\mathbf{B}}_{s} = \\begin{pmatrix} -\\frac{1}{L} & -\\frac{1}{2} & \\frac{1}{L} & -\\frac{1}{2} \\end{pmatrix}$$\n这个结果对应于在单元中心 $\\xi=0$ 处对完整的、随空间变化的算子 $\\mathbf{B}_{s}(\\xi)$ 进行求值，该点是用于剪切刚度矩阵减缩积分的单个 Gauss 点的位置。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} -\\frac{1}{L} & -\\frac{1}{2} & \\frac{1}{L} & -\\frac{1}{2} \\end{pmatrix} } $$"
        }
    ]
}