{
    "hands_on_practices": [
        {
            "introduction": "在我们求解线性系统 $A x = b$ 之前，理解该系统在计算力学中的来源以及矩阵 $A$ 必须具备的性质至关重要。第一个练习将指导您使用有限元法推导一个简单弹性杆的刚度矩阵，并验证其对称正定性 (Symmetric Positive Definite, SPD)——这是共轭梯度法收敛的基石。",
            "id": "3550398",
            "problem": "考虑一根小应变、一维线性弹性杆，总长度为 $2h$，杨氏模量为 $E>0$，横截面积恒为 $A>0$。该杆被离散为 $2$ 个线性的双节点有限元，节点位于 $x_{0}=0$、$x_{1}=h$ 和 $x_{2}=2h$。在 $x=0$ 处施加齐次狄利克雷（Dirichlet）边界条件 $u(0)=0$，在 $x=2h$ 处施加无牵引力的自然边界条件。有限元近似在每个单元上使用标准的线性形函数。\n\n从杆的内部弹性势能由下式给出的基本原理出发：\n$$\n\\Pi_{\\text{int}}(u)=\\frac{1}{2}\\int_{0}^{2h}EA\\left(\\frac{du}{dx}\\right)^{2}\\,dx,\n$$\n并使用伽辽金（Galerkin）法处理轴向平衡的弱形式，结合单元级形函数及其空间导数的定义，完成以下任务：\n- 对于长度为 $h$ 的通用单元，推导其一致的 $2\\times 2$ 单元刚度矩阵，用 $E$ 和 $A$ 表示。\n- 为三节点网格组装全局刚度矩阵，然后在 $x=0$ 处应用狄利克雷（Dirichlet）边界条件，以获得与 $x=h$ 和 $x=2h$ 处未知节点位移相关的降阶 $2\\times 2$ 全局刚度矩阵。\n- 以闭合形式计算降阶 $2\\times 2$ 全局刚度矩阵的特征值，并用它们来证明该矩阵是对称正定的，从而确保共轭梯度（CG）法在该问题的克里洛夫（Krylov）子空间框架内收敛。\n\n将最终的特征值表示为包含 $E$、$A$ 和 $h$ 的闭合形式解析表达式。不需要进行数值代入或四舍五入。以一对特征值的形式提供你的最终答案。",
            "solution": "该问题由一维小应变下的线性弹性理论控制。内部弹性势能泛函为\n$$\n\\Pi_{\\text{int}}(u)=\\frac{1}{2}\\int_{0}^{2h}EA\\left(\\frac{du}{dx}\\right)^{2}\\,dx,\n$$\n其中 $E>0$ 是杨氏模量，$A>0$ 是横截面积。轴向平衡的弱形式可以通过要求总势能对所有容许变分的一阶变分为零来导出：\n$$\n\\delta \\Pi_{\\text{int}}(u)=\\int_{0}^{2h}EA\\left(\\frac{du}{dx}\\right)\\left(\\frac{d\\,\\delta u}{dx}\\right)\\,dx=0,\n$$\n在没有体力且在 $x=2h$ 处为无牵引力边界的条件下。使用伽辽金（Galerkin）法和有限元近似 $u(x)\\approx \\sum_{i}N_{i}(x)u_{i}$（其中使用线性形函数），单元刚度矩阵的项可由下式得出\n$$\nk^{(e)}_{ij}=\\int_{x_{e}}^{x_{e}+h}EA\\,\\frac{dN_{i}}{dx}\\,\\frac{dN_{j}}{dx}\\,dx,\n$$\n对于一个跨越 $[x_{e},x_{e}+h]$ 的通用单元 $e$。\n\n对于位于 $[x_{e},x_{e}+h]$ 上的一个线性双节点单元，其形函数为\n$$\nN_{1}(x)=\\frac{x_{e}+h-x}{h},\\qquad N_{2}(x)=\\frac{x-x_{e}}{h},\n$$\n其空间导数在单元上是常数：\n$$\n\\frac{dN_{1}}{dx}=-\\frac{1}{h},\\qquad \\frac{dN_{2}}{dx}=\\frac{1}{h}.\n$$\n因此，\n$$\nk^{(e)}_{11}=\\int_{x_{e}}^{x_{e}+h}EA\\left(-\\frac{1}{h}\\right)\\left(-\\frac{1}{h}\\right)\\,dx=\\frac{EA}{h},\\quad\nk^{(e)}_{12}=\\int_{x_{e}}^{x_{e}+h}EA\\left(-\\frac{1}{h}\\right)\\left(\\frac{1}{h}\\right)\\,dx=-\\frac{EA}{h},\n$$\n$$\nk^{(e)}_{21}=\\int_{x_{e}}^{x_{e}+h}EA\\left(\\frac{1}{h}\\right)\\left(-\\frac{1}{h}\\right)\\,dx=-\\frac{EA}{h},\\quad\nk^{(e)}_{22}=\\int_{x_{e}}^{x_{e}+h}EA\\left(\\frac{1}{h}\\right)\\left(\\frac{1}{h}\\right)\\,dx=\\frac{EA}{h}.\n$$\n因此，一致单元刚度矩阵为\n$$\n\\mathbf{K}^{(e)}=\\frac{EA}{h}\\begin{bmatrix}1  -1 \\\\ -1  1\\end{bmatrix}.\n$$\n\n我们现在为节点位于 $x_{0}=0$、$x_{1}=h$ 和 $x_{2}=2h$ 的网格组装全局刚度矩阵。单元 $1$ 连接节点 $(0,1)$，单元 $2$ 连接节点 $(1,2)$。将各单元的贡献组装起来，得到全局 $3\\times 3$ 刚度矩阵\n$$\n\\mathbf{K}=\\frac{EA}{h}\\begin{bmatrix}\n1  -1  0 \\\\\n-1  2  -1 \\\\\n0  -1  1\n\\end{bmatrix}.\n$$\n齐次狄利克雷（Dirichlet）边界条件 $u(0)=0$ 消除了节点 $0$ 处的自由度，从而得到与节点 $1$ 和 $2$ 处的未知位移相关的降阶 $2\\times 2$ 全局刚度矩阵：\n$$\n\\mathbf{K}_{r}=\\frac{EA}{h}\\begin{bmatrix}\n2  -1 \\\\\n-1  1\n\\end{bmatrix}.\n$$\n\n为了验证对称正定性，并将其与克里洛夫（Krylov）子空间方法中对共轭梯度（CG）法的收敛性保证联系起来，我们计算 $\\mathbf{K}_{r}$ 的特征值。令\n$$\n\\mathbf{M}=\\begin{bmatrix}\n2  -1 \\\\\n-1  1\n\\end{bmatrix}.\n$$\n$\\mathbf{M}$ 的特征多项式是\n$$\np(\\lambda)=\\det(\\mathbf{M}-\\lambda \\mathbf{I})=\\det\\begin{bmatrix}2-\\lambda  -1 \\\\ -1  1-\\lambda\\end{bmatrix}=(2-\\lambda)(1-\\lambda)-1=\\lambda^{2}-3\\lambda+1.\n$$\n$\\mathbf{M}$ 的特征值是 $p(\\lambda)=0$ 的根：\n$$\n\\lambda_{1,2}=\\frac{3\\pm\\sqrt{9-4}}{2}=\\frac{3\\pm\\sqrt{5}}{2}.\n$$\n因此，$\\mathbf{K}_{r}=(EA/h)\\,\\mathbf{M}$ 的特征值为\n$$\n\\mu_{1}=\\frac{EA}{h}\\cdot\\frac{3-\\sqrt{5}}{2},\\qquad \\mu_{2}=\\frac{EA}{h}\\cdot\\frac{3+\\sqrt{5}}{2}.\n$$\n由于 $E>0$，$A>0$，$h>0$，并且 $(3\\pm\\sqrt{5})/2 > 0$，我们有 $\\mu_{1}>0$ 和 $\\mu_{2}>0$。因此，$\\mathbf{K}_{r}$ 是对称正定的。这一性质保证了共轭梯度（CG）法（一种专门用于对称正定系统的克里洛夫（Krylov）子空间方法）对于这个离散化问题将是收敛的，其收敛速率受条件数 $\\kappa(\\mathbf{K}_{r})=\\mu_{2}/\\mu_{1}$ 的影响。\n\n因此，所要求的闭合形式的特征值已如上文明确地用 $E$、$A$ 和 $h$ 表示。",
            "answer": "$$\\boxed{\\frac{EA}{2h}\\left(3-\\sqrt{5}\\right),\\ \\frac{EA}{2h}\\left(3+\\sqrt{5}\\right)}$$"
        },
        {
            "introduction": "共轭梯度法是克里洛夫子空间方法的典型代表。这个练习提供了一个动手实践的机会，让您构建这些方法的核心基础：克里洛夫子空间。通过为一个给定系统显式地生成基向量，您将对CG算法在其中寻找最优解的向量空间有一个具体的认识。",
            "id": "3550446",
            "problem": "在小应变线性弹性力学中，有限元法（FEM）会产生一个形如 $A x = b$ 的线性系统，其中 $A$ 是离散化结构的对称刚度矩阵，$x$ 是节点位移向量，$b$ 是节点力向量。对于具有适当基本边界条件的稳定结构，刚度矩阵 $A$ 是对称正定（SPD）的。克里洛夫子空间方法，例如共轭梯度（CG）法，在由残差 $r_{0} = b - A x_{0}$ 生成的克里洛夫子空间中构造迭代。\n\n考虑一个由三自由度离散化产生的 $3 \\times 3$ 对称正定刚度矩阵，\n$$\nA = \\begin{pmatrix}\n4  1  0 \\\\\n1  3  1 \\\\\n0  1  2\n\\end{pmatrix},\n$$\n一个节点力向量\n$$\nb = \\begin{pmatrix}\n1 \\\\\n2 \\\\\n3\n\\end{pmatrix},\n$$\n以及初始猜测值 $x_{0} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}$。\n\n仅使用基本定义，完成以下操作：\n1. 计算初始残差 $r_{0} = b - A x_{0}$。\n2. 使用克里洛夫子空间的定义，显式地为 $\\mathcal{K}_{3}(A, r_{0})$ 构建一个基。\n3. 构造这三个向量的 $3 \\times 3$ Gram矩阵，并通过基于行列式的准则评估它们的线性无关性。\n\n将您在第3步中构造的Gram矩阵的行列式作为最终答案。无需四舍五入。最终答案必须表示为一个无单位的实数。",
            "solution": "该问题被验证为具有科学依据、良态、客观、完整和一致。矩阵 $A$ 是对称的，其正定性通过Sylvester准则得到证实，因为其所有主子式均为正：$4 > 0$，$4(3)-1(1) = 11 > 0$，以及 $\\det(A) = 4(3 \\cdot 2 - 1 \\cdot 1) - 1(1 \\cdot 2 - 1 \\cdot 0) = 4(5) - 2 = 18 > 0$。满足有效问题的所有条件。\n\n解题过程按题目要求分三步进行。\n\n第1步：计算初始残差 $r_{0}$。\n初始残差 $r_{0}$ 定义为 $r_{0} = b - A x_{0}$。我们已知节点力向量 $b$ 和位移向量的初始猜测值 $x_{0}$。\n$$\nb = \\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\end{pmatrix}, \\quad x_{0} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n乘积 $A x_{0}$ 为：\n$$\nA x_{0} = \\begin{pmatrix} 4  1  0 \\\\ 1  3  1 \\\\ 0  1  2 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n因此，初始残差为：\n$$\nr_{0} = b - A x_{0} = \\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\end{pmatrix} - \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\end{pmatrix}\n$$\n\n第2步：为克里洛夫子空间 $\\mathcal{K}_{3}(A, r_{0})$ 构建一个基。\n克里洛夫子空间 $\\mathcal{K}_{k}(A, r)$ 定义为向量集 $\\{r, Ar, A^2r, \\dots, A^{k-1}r\\}$ 的张成空间。在我们的问题中，$k=3$，生成向量是 $r_{0}$。$\\mathcal{K}_{3}(A, r_{0})$ 的标准基是向量集 $\\{v_1, v_2, v_3\\}$，其中 $v_1 = r_0$，$v_2 = Ar_0$，以及 $v_3 = A^2r_0$。\n\n第一个基向量是 $v_1 = r_0$。\n$$\nv_1 = \\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\end{pmatrix}\n$$\n第二个基向量是 $v_2 = A v_1$。\n$$\nv_2 = A r_{0} = \\begin{pmatrix} 4  1  0 \\\\ 1  3  1 \\\\ 0  1  2 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\end{pmatrix} = \\begin{pmatrix} 4(1) + 1(2) + 0(3) \\\\ 1(1) + 3(2) + 1(3) \\\\ 0(1) + 1(2) + 2(3) \\end{pmatrix} = \\begin{pmatrix} 6 \\\\ 10 \\\\ 8 \\end{pmatrix}\n$$\n第三个基向量是 $v_3 = A^2 r_{0} = A (A r_{0}) = A v_2$。\n$$\nv_3 = A v_{2} = \\begin{pmatrix} 4  1  0 \\\\ 1  3  1 \\\\ 0  1  2 \\end{pmatrix} \\begin{pmatrix} 6 \\\\ 10 \\\\ 8 \\end{pmatrix} = \\begin{pmatrix} 4(6) + 1(10) + 0(8) \\\\ 1(6) + 3(10) + 1(8) \\\\ 0(6) + 1(10) + 2(8) \\end{pmatrix} = \\begin{pmatrix} 24+10 \\\\ 6+30+8 \\\\ 10+16 \\end{pmatrix} = \\begin{pmatrix} 34 \\\\ 44 \\\\ 26 \\end{pmatrix}\n$$\n因此，为 $\\mathcal{K}_{3}(A, r_{0})$ 构建的基是 $\\left\\{ \\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\end{pmatrix}, \\begin{pmatrix} 6 \\\\ 10 \\\\ 8 \\end{pmatrix}, \\begin{pmatrix} 34 \\\\ 44 \\\\ 26 \\end{pmatrix} \\right\\}$。\n\n第3步：构造Gram矩阵并计算其行列式。\n向量集 $\\{v_1, v_2, v_3\\}$ 的Gram矩阵 $G$ 由 $G_{ij} = v_i^T v_j$ 给出，这是内积（点积）矩阵。\n$$\nG = \\begin{pmatrix} v_1^T v_1  v_1^T v_2  v_1^T v_3 \\\\ v_2^T v_1  v_2^T v_2  v_2^T v_3 \\\\ v_3^T v_1  v_3^T v_2  v_3^T v_3 \\end{pmatrix}\n$$\n我们计算各个元素：\n$v_1^T v_1 = (1)^2 + (2)^2 + (3)^2 = 1+4+9 = 14$。\n$v_1^T v_2 = (1)(6) + (2)(10) + (3)(8) = 6+20+24 = 50$。\n$v_1^T v_3 = (1)(34) + (2)(44) + (3)(26) = 34+88+78 = 200$。\n$v_2^T v_2 = (6)^2 + (10)^2 + (8)^2 = 36+100+64 = 200$。\n$v_2^T v_3 = (6)(34) + (10)(44) + (8)(26) = 204+440+208 = 852$。\n$v_3^T v_3 = (34)^2 + (44)^2 + (26)^2 = 1156+1936+676 = 3768$。\n\n由于内积的对称性（$v_i^T v_j = v_j^T v_i$），Gram矩阵是对称的：\n$$\nG = \\begin{pmatrix} 14  50  200 \\\\ 50  200  852 \\\\ 200  852  3768 \\end{pmatrix}\n$$\nGram矩阵的行列式 $\\det(G)$ 是线性无关性的一个判据。当且仅当 $\\det(G) \\neq 0$ 时，这些向量是线性无关的。一个强大的性质将Gram行列式与以这些向量为列构成的矩阵的行列式联系起来。令 $V = \\begin{pmatrix} v_1  v_2  v_3 \\end{pmatrix}$。则 $\\det(G) = (\\det(V))^2$。\n$$\nV = \\begin{pmatrix} 1  6  34 \\\\ 2  10  44 \\\\ 3  8  26 \\end{pmatrix}\n$$\n我们使用沿第一行的代数余子式展开来计算 $V$ 的行列式：\n$$\n\\det(V) = 1 \\cdot \\det\\begin{pmatrix} 10  44 \\\\ 8  26 \\end{pmatrix} - 6 \\cdot \\det\\begin{pmatrix} 2  44 \\\\ 3  26 \\end{pmatrix} + 34 \\cdot \\det\\begin{pmatrix} 2  10 \\\\ 3  8 \\end{pmatrix}\n$$\n$$\n\\det(V) = 1(10 \\cdot 26 - 44 \\cdot 8) - 6(2 \\cdot 26 - 44 \\cdot 3) + 34(2 \\cdot 8 - 10 \\cdot 3)\n$$\n$$\n\\det(V) = 1(260 - 352) - 6(52 - 132) + 34(16 - 30)\n$$\n$$\n\\det(V) = 1(-92) - 6(-80) + 34(-14) = -92 + 480 - 476 = -88\n$$\nGram矩阵的行列式是该值的平方：\n$$\n\\det(G) = (\\det(V))^2 = (-88)^2 = 7744\n$$\n由于 $\\det(G) = 7744 \\neq 0$，向量 $\\{v_1, v_2, v_3\\}$ 是线性无关的，并构成了 $\\mathbb{R}^3$ 的一个基。这是预料之中的，因为对于一个大小为 $n \\times n$ 的非亏损矩阵 $A$ 和一个合适的起始向量 $r_0$，克里洛夫子空间 $\\mathcal{K}_n(A,r_0)$ 的维数是 $n$。Gram矩阵的行列式是所要求的最终答案。",
            "answer": "$$\n\\boxed{7744}\n$$"
        },
        {
            "introduction": "在建立了对称正定系统的来源和克里洛夫子空间的性质之后，我们现在转向算法本身。本练习将引导您逐步完成一个小型系统的共轭梯度法计算，让您手动计算迭代解、残差和搜索方向。最关键的是，您将验证搜索方向的 $A$-共轭性，从而揭示该方法强大和高效的根源。",
            "id": "3550427",
            "problem": "在一个通过有限元方法（FEM）离散化的小应变线性弹性边值问题中，平衡方程简化为一个形式为 $A x = b$ 的对称正定（SPD）线性系统，其中 $A$ 是全局刚度矩阵，$b$ 是载荷向量。解 $x$ 最小化二次势能泛函 $E(x) = \\tfrac{1}{2} x^{\\top} A x - b^{\\top} x$。共轭梯度（CG）法通过在由初始残差和 $A$ 在欧几里得内积下生成的逐次克里洛夫子空间上最小化此泛函来构造迭代解。\n\n考虑将无预处理的 CG 方法应用于具有以下参数的 SPD 系统：\n$$\nA = \\begin{pmatrix}\n4  1  0 \\\\\n1  3  1 \\\\\n0  1  2\n\\end{pmatrix}, \n\\quad\nb = \\begin{pmatrix}\n4 \\\\\n2 \\\\\n2\n\\end{pmatrix},\n\\quad\nx_0 = \\begin{pmatrix}\n0 \\\\\n0 \\\\\n0\n\\end{pmatrix}.\n$$\n使用标准的无预处理共轭梯度（CG）法（其中 $p_0 = r_0$ 并使用欧几里得内积）执行正好两次迭代。计算第一次和第二次迭代解 $x_1$ 和 $x_2$，相应的残差 $r_1$ 和 $r_2$，并对前两个搜索方向 $p_0$ 和 $p_1$ 验证 $A$-共轭条件 $p_0^{\\top} A p_1 = 0$。\n\n最后，将 $p_0^{\\top} A p_1$ 的值作为您的单一数值答案报告。无需四舍五入。",
            "solution": "该问题是适定的，有科学依据，并包含了进行计算所需的所有信息。矩阵 $A$ 是对称的，其正定性可以通过验证其所有顺序主子式均为正来确认：\n$D_1 = \\det([4]) = 4 > 0$.\n$D_2 = \\det \\begin{pmatrix} 4  1 \\\\ 1  3 \\end{pmatrix} = 4(3) - 1(1) = 11 > 0$.\n$D_3 = \\det(A) = 4(3 \\cdot 2 - 1 \\cdot 1) - 1(1 \\cdot 2 - 1 \\cdot 0) = 4(5) - 1(2) = 18 > 0$.\n由于所有顺序主子式均为正，矩阵 $A$ 是对称正定（SPD）的，这是标准共轭梯度（CG）法的一个先决条件。因此，该问题是有效的。\n\n对于初始猜测值 $x_0$，求解 $A x = b$ 的无预处理 CG 算法如下：\n初始化：\n$r_0 = b - A x_0$\n$p_0 = r_0$\n对于 $k=0, 1, 2, \\dots$\n$\\alpha_k = \\frac{r_k^{\\top} r_k}{p_k^{\\top} A p_k}$\n$x_{k+1} = x_k + \\alpha_k p_k$\n$r_{k+1} = r_k - \\alpha_k A p_k$\n$\\beta_k = \\frac{r_{k+1}^{\\top} r_{k+1}}{r_k^{\\top} r_k}$\n$p_{k+1} = r_{k+1} + \\beta_k p_k$\n\n给定：\n$$\nA = \\begin{pmatrix}\n4  1  0 \\\\\n1  3  1 \\\\\n0  1  2\n\\end{pmatrix}, \n\\quad\nb = \\begin{pmatrix}\n4 \\\\\n2 \\\\\n2\n\\end{pmatrix},\n\\quad\nx_0 = \\begin{pmatrix}\n0 \\\\\n0 \\\\\n0\n\\end{pmatrix}\n$$\n\n**迭代 $k=0$**\n\n1.  计算初始残差 $r_0$：\n    $$\n    r_0 = b - A x_0 = \\begin{pmatrix} 4 \\\\ 2 \\\\ 2 \\end{pmatrix} - \\begin{pmatrix} 4  1  0 \\\\ 1  3  1 \\\\ 0  1  2 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 4 \\\\ 2 \\\\ 2 \\end{pmatrix}\n    $$\n2.  设置初始搜索方向 $p_0$：\n    $$\n    p_0 = r_0 = \\begin{pmatrix} 4 \\\\ 2 \\\\ 2 \\end{pmatrix}\n    $$\n3.  计算步长 $\\alpha_0$：\n    首先，计算分子 $r_0^{\\top} r_0$：\n    $$\n    r_0^{\\top} r_0 = \\begin{pmatrix} 4  2  2 \\end{pmatrix} \\begin{pmatrix} 4 \\\\ 2 \\\\ 2 \\end{pmatrix} = 4^2 + 2^2 + 2^2 = 16 + 4 + 4 = 24\n    $$\n    接着，计算分母 $p_0^{\\top} A p_0$。我们首先需要计算 $A p_0$：\n    $$\n    A p_0 = \\begin{pmatrix} 4  1  0 \\\\ 1  3  1 \\\\ 0  1  2 \\end{pmatrix} \\begin{pmatrix} 4 \\\\ 2 \\\\ 2 \\end{pmatrix} = \\begin{pmatrix} 4(4) + 1(2) + 0(2) \\\\ 1(4) + 3(2) + 1(2) \\\\ 0(4) + 1(2) + 2(2) \\end{pmatrix} = \\begin{pmatrix} 18 \\\\ 12 \\\\ 6 \\end{pmatrix}\n    $$\n    然后，计算 $p_0^{\\top} (A p_0)$：\n    $$\n    p_0^{\\top} A p_0 = \\begin{pmatrix} 4  2  2 \\end{pmatrix} \\begin{pmatrix} 18 \\\\ 12 \\\\ 6 \\end{pmatrix} = 4(18) + 2(12) + 2(6) = 72 + 24 + 12 = 108\n    $$\n    步长 $\\alpha_0$ 为：\n    $$\n    \\alpha_0 = \\frac{r_0^{\\top} r_0}{p_0^{\\top} A p_0} = \\frac{24}{108} = \\frac{2}{9}\n    $$\n4.  更新解以得到 $x_1$：\n    $$\n    x_1 = x_0 + \\alpha_0 p_0 = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} + \\frac{2}{9} \\begin{pmatrix} 4 \\\\ 2 \\\\ 2 \\end{pmatrix} = \\begin{pmatrix} \\frac{8}{9} \\\\ \\frac{4}{9} \\\\ \\frac{4}{9} \\end{pmatrix}\n    $$\n5.  更新残差以得到 $r_1$：\n    $$\n    r_1 = r_0 - \\alpha_0 A p_0 = \\begin{pmatrix} 4 \\\\ 2 \\\\ 2 \\end{pmatrix} - \\frac{2}{9} \\begin{pmatrix} 18 \\\\ 12 \\\\ 6 \\end{pmatrix} = \\begin{pmatrix} 4 \\\\ 2 \\\\ 2 \\end{pmatrix} - \\begin{pmatrix} 4 \\\\ \\frac{8}{3} \\\\ \\frac{4}{3} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 2 - \\frac{8}{3} \\\\ 2 - \\frac{4}{3} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ -\\frac{2}{3} \\\\ \\frac{2}{3} \\end{pmatrix}\n    $$\n6.  计算 $\\beta_0$ 以找到下一个搜索方向：\n    首先，计算 $r_1^{\\top} r_1$：\n    $$\n    r_1^{\\top} r_1 = \\begin{pmatrix} 0  -\\frac{2}{3}  \\frac{2}{3} \\end{pmatrix} \\begin{pmatrix} 0 \\\\ -\\frac{2}{3} \\\\ \\frac{2}{3} \\end{pmatrix} = 0^2 + \\left(-\\frac{2}{3}\\right)^2 + \\left(\\frac{2}{3}\\right)^2 = \\frac{4}{9} + \\frac{4}{9} = \\frac{8}{9}\n    $$\n    然后，$\\beta_0$：\n    $$\n    \\beta_0 = \\frac{r_1^{\\top} r_1}{r_0^{\\top} r_0} = \\frac{8/9}{24} = \\frac{8}{9 \\cdot 24} = \\frac{1}{27}\n    $$\n7.  更新搜索方向以得到 $p_1$：\n    $$\n    p_1 = r_1 + \\beta_0 p_0 = \\begin{pmatrix} 0 \\\\ -\\frac{2}{3} \\\\ \\frac{2}{3} \\end{pmatrix} + \\frac{1}{27} \\begin{pmatrix} 4 \\\\ 2 \\\\ 2 \\end{pmatrix} = \\begin{pmatrix} \\frac{4}{27} \\\\ -\\frac{18}{27} + \\frac{2}{27} \\\\ \\frac{18}{27} + \\frac{2}{27} \\end{pmatrix} = \\begin{pmatrix} \\frac{4}{27} \\\\ -\\frac{16}{27} \\\\ \\frac{20}{27} \\end{pmatrix}\n    $$\n\n这就完成了第一次迭代。我们得到了 $x_1$、$r_1$ 和 $p_1$。\n\n**迭代 $k=1$**\n\n1.  计算步长 $\\alpha_1$：\n    分子是 $r_1^{\\top} r_1 = \\frac{8}{9}$。\n    对于分母，我们首先计算 $A p_1$：\n    $$\n    A p_1 = \\begin{pmatrix} 4  1  0 \\\\ 1  3  1 \\\\ 0  1  2 \\end{pmatrix} \\begin{pmatrix} \\frac{4}{27} \\\\ -\\frac{16}{27} \\\\ \\frac{20}{27} \\end{pmatrix} = \\frac{1}{27} \\begin{pmatrix} 4(4) + 1(-16) + 0(20) \\\\ 1(4) + 3(-16) + 1(20) \\\\ 0(4) + 1(-16) + 2(20) \\end{pmatrix} = \\frac{1}{27} \\begin{pmatrix} 0 \\\\ -24 \\\\ 24 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ -\\frac{8}{9} \\\\ \\frac{8}{9} \\end{pmatrix}\n    $$\n    然后，计算 $p_1^{\\top} (A p_1)$：\n    $$\n    p_1^{\\top} A p_1 = \\begin{pmatrix} \\frac{4}{27}  -\\frac{16}{27}  \\frac{20}{27} \\end{pmatrix} \\begin{pmatrix} 0 \\\\ -\\frac{8}{9} \\\\ \\frac{8}{9} \\end{pmatrix} = \\frac{1}{27} \\left( 4(0) - 16\\left(-\\frac{8}{9}\\right) + 20\\left(\\frac{8}{9}\\right) \\right) = \\frac{1}{27} \\left( \\frac{128}{9} + \\frac{160}{9} \\right) = \\frac{1}{27} \\left( \\frac{288}{9} \\right) = \\frac{32}{27}\n    $$\n    步长 $\\alpha_1$ 为：\n    $$\n    \\alpha_1 = \\frac{r_1^{\\top} r_1}{p_1^{\\top} A p_1} = \\frac{8/9}{32/27} = \\frac{8}{9} \\cdot \\frac{27}{32} = \\frac{1}{1} \\cdot \\frac{3}{4} = \\frac{3}{4}\n    $$\n2.  更新解以得到 $x_2$：\n    $$\n    x_2 = x_1 + \\alpha_1 p_1 = \\begin{pmatrix} \\frac{8}{9} \\\\ \\frac{4}{9} \\\\ \\frac{4}{9} \\end{pmatrix} + \\frac{3}{4} \\begin{pmatrix} \\frac{4}{27} \\\\ -\\frac{16}{27} \\\\ \\frac{20}{27} \\end{pmatrix} = \\begin{pmatrix} \\frac{8}{9} \\\\ \\frac{4}{9} \\\\ \\frac{4}{9} \\end{pmatrix} + \\begin{pmatrix} \\frac{1}{9} \\\\ -\\frac{4}{9} \\\\ \\frac{5}{9} \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 0 \\\\ 1 \\end{pmatrix}\n    $$\n3.  更新残差以得到 $r_2$：\n    $$\n    r_2 = r_1 - \\alpha_1 A p_1 = \\begin{pmatrix} 0 \\\\ -\\frac{2}{3} \\\\ \\frac{2}{3} \\end{pmatrix} - \\frac{3}{4} \\begin{pmatrix} 0 \\\\ -\\frac{8}{9} \\\\ \\frac{8}{9} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ -\\frac{2}{3} \\\\ \\frac{2}{3} \\end{pmatrix} - \\begin{pmatrix} 0 \\\\ -\\frac{2}{3} \\\\ \\frac{2}{3} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}\n    $$\n\n迭代解为 $x_1 = \\begin{pmatrix} 8/9 \\\\ 4/9 \\\\ 4/9 \\end{pmatrix}$ 和 $x_2 = \\begin{pmatrix} 1 \\\\ 0 \\\\ 1 \\end{pmatrix}$。残差为 $r_1 = \\begin{pmatrix} 0 \\\\ -2/3 \\\\ 2/3 \\end{pmatrix}$ 和 $r_2 = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}$。残差 $r_2$ 是零向量，这表明 $x_2$ 是精确解。这是可能的，因为对于一个 $N \\times N$ 的系统，在精确算术下，CG 方法保证在至多 $N$ 步内收敛，这里 $N=3$。\n\n**$A$-共轭性验证与最终答案**\n\n问题要求验证 $A$-共轭条件 $p_0^{\\top} A p_1 = 0$ 并报告计算出的值。\n使用上面推导出的向量 $p_0$ 和 $A p_1$：\n$$\np_0 = \\begin{pmatrix} 4 \\\\ 2 \\\\ 2 \\end{pmatrix} \\quad \\text{和} \\quad A p_1 = \\begin{pmatrix} 0 \\\\ -\\frac{8}{9} \\\\ \\frac{8}{9} \\end{pmatrix}\n$$\n我们计算标量积：\n$$\np_0^{\\top} A p_1 = \\begin{pmatrix} 4  2  2 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ -\\frac{8}{9} \\\\ \\frac{8}{9} \\end{pmatrix} = 4(0) + 2\\left(-\\frac{8}{9}\\right) + 2\\left(\\frac{8}{9}\\right) = 0 - \\frac{16}{9} + \\frac{16}{9} = 0\n$$\n该条件得到验证；搜索方向是 $A$-共轭的。数值为 $0$。",
            "answer": "$$\n\\boxed{0}\n$$"
        }
    ]
}