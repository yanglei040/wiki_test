{
    "hands_on_practices": [
        {
            "introduction": "稀疏直接求解器的效率在很大程度上取决于矩阵行和列的排序。本实践练习通过一个简单的一维有限元模型来探讨“填充”（fill-in）这一基本概念 。通过在图上分析Cholesky分解过程，您将直接观察到一个好的排序如何能避免填充，而一个差的排序又如何破坏稀疏性，从而为理解高级排序算法奠定基础。",
            "id": "3557846",
            "problem": "考虑一根均匀的一维杆，离散为 $n=8$ 个线性有限元，节点按从左到右的自然顺序标记为 $1,2,\\dots,8$。在两端施加本质边界条件后，组装的全局刚度矩阵 $K \\in \\mathbb{R}^{8 \\times 8}$ 是实对称正定 (SPD) 矩阵，其稀疏图为路径图（一维链），也就是说，非零的非对角线元仅出现在链中的相邻节点之间。通过其稀疏模式来抽象地处理 $K$；不需要其元素的具体数值。\n\n仅使用关于一维杆有限元组装的基本原理、$K$ 的稀疏图的定义，以及高斯消元法中填充的图论解释（特别是针对 Cholesky 分解，即将 $K$ 分解为 $K=L L^{\\top}$ 的对称消元法），完成以下任务：\n\n- 在自然顺序 $1,2,\\dots,8$ 下，确定 $K$ 的上带宽和从下三角部分逐行观察的 $K$ 的轮廓。直接根据链上最近邻耦合组装产生的非零模式来证明这两个量。\n\n- 通过在消元图上进行推理，解释为什么在自然顺序下对 $K$ 进行 Cholesky 分解不会在原始非零元之外产生任何填充。\n\n- 现在考虑由置换 $p=(1,3,5,7,2,4,6,8)$ 给出的扰动顺序。设 $P$ 是将自然顺序映射到 $p$ 的置换矩阵，并考虑置换后矩阵 $\\tilde{K}=P^{\\top} K P$ 的 Cholesky 分解。使用对称消元的图填充规则（消去一个节点会使其后续的邻居节点形成一个团），确定在 $\\tilde{K}$ 的 Cholesky 因子中出现的、且在分解前 $\\tilde{K}$ 的严格下三角部分中不存在的严格下三角填充项的精确数量。\n\n为每一步提供完整的推理过程。最终报告的量必须仅为扰动顺序 $p$ 下严格下三角填充项的整数数量，不带单位，也无附加文本。无需四舍五入；报告精确的整数。",
            "solution": "该问题被认为是有效的，因为它科学地基于有限元法和数值线性代数的原理，提法明确，目标清晰，并且没有矛盾或含糊之处。\n\n这个问题探讨了一维杆的全局刚度矩阵 $K$ 的稀疏模式，以及在不同节点排序下进行 Cholesky 分解过程中的填充概念。\n\n首先，我们分析在节点自然排序 $1, 2, \\dots, 8$ 下矩阵 $K$ 的结构。问题陈述杆被离散为 $n=8$ 个线性有限元。一个线性元连接两个相邻节点。对于自然编号，单元 $e$ 连接节点 $e$ 和节点 $e+1$。全局刚度矩阵 $K$ 是由单元刚度矩阵组装而成的。一个元素 $K_{ij}$ 非零当且仅当节点 $i$ 和 $j$ 属于同一个单元。在一维链中，节点 $i$ 与节点 $i-1$ (对于 $i>1$) 和节点 $i+1$ (对于 $i<8$) 相连。因此，$K_{ij}$ 仅在 $|i-j| \\le 1$ 时非零。这个结构定义了一个对称三对角矩阵。\n\n- **$K$ 的上带宽和轮廓（自然排序）**\n\n矩阵 $A$ 的上带宽定义为 $\\max \\{j-i \\mid A_{ij} \\neq 0\\}$。对于三对角矩阵 $K$，非零元位于主对角线 ($j=i$)、第一上对角线 ($j=i+1$) 和第一下对角线 ($j=i-1$) 上。非零元的最大差值 $j-i$ 为 $1$。因此，$K$ 的上带宽为 $1$。\n\n对于对称矩阵，为了天际线存储的目的，其轮廓由每行从左扫描时的第一个非零元确定。对于 $K$ 的下三角部分，我们考虑对每一行 $i$，满足 $K_{ij} \\neq 0$ 的最小列索引 $j \\le i$。对于行 $i=1$，唯一的非零元是主对角元 $K_{11}$，所以第一个非零元在列 $j=1$ 处。对于任何行 $i \\in \\{2, 3, \\dots, 8\\}$，下三角部分和对角线上的非零元是 $K_{ii}$ 和 $K_{i, i-1}$。第一个非零元在列 $j=i-1$ 处。因此，轮廓由 $i=1, \\dots, 8$ 的对角元 $K_{ii}$ 和 $i=2, \\dots, 8$ 的次对角元 $K_{i,i-1}$ 组成。\n\n- **自然排序下 $K$ 的填充**\n\nCholesky 分解 $K = L L^{\\top}$ 的过程可以解释为在与 $K$ 相关的图上进行消元。图 $G(K)$ 的顶点对应于节点 $\\{1, 2, \\dots, 8\\}$，如果 $K_{ij} \\neq 0$ 且 $i \\neq j$，则存在一条边 $(i, j)$。对于我们的三对角矩阵，$G(K)$ 是一个路径图：$1-2-3-4-5-6-7-8$。\n\n对变量 $k$ 进行对称消元，相当于从图中移除节点 $k$，并使其所有（尚未被消元的）邻居节点形成一个团，即在它们所有对之间添加边。这些新边代表填充。我们按照自然顺序 $1, 2, \\dots, 8$ 消去节点。\n\n1.  消去节点 $1$：其唯一的邻居是节点 $2$。只有一个节点的集合自然是团，所以不添加任何边。\n2.  消去节点 $2$：在剩余的图中，其邻居是节点 $1$（已被消去）和节点 $3$。唯一尚未被消去的邻居是节点 $3$。不能形成新的边。\n3.  一般地，当我们消去节点 $k$（对于 $k < 8$），它在原始图中的邻居是 $k-1$ 和 $k+1$。由于所有节点 $1, \\dots, k-1$ 都已被消去，因此在活动图中 $k$ 的唯一邻居是 $k+1$。单个邻居无法形成团，因此不添加任何边。\n\n这个过程一直持续到结束。由于在任何步骤中都没有向图中添加新边，因此在自然排序下对 $K$ 进行 Cholesky 分解会产生零填充。因子 $L$ 的结构与 $K$ 的下三角部分的结构相同。\n\n- **扰动排序下 $\\tilde{K}$ 的填充**\n\n现在，我们考虑扰动排序 $p=(1,3,5,7,2,4,6,8)$。我们通过在原始路径图 $G(K)$ 上使用这个新的节点顺序模拟消元过程来分析填充。一个填充项对应于图中新增的一条最初不存在的边。严格下三角填充项的数量等于这些新边的数量。\n\n初始图 $G_0$ 是路径 $1-2-3-4-5-6-7-8$。\n\n1.  **消去节点 $1$**：邻居是 $\\{2\\}$。无填充。图保持为 $G_0$。\n2.  **消去节点 $3$**：邻居是 $\\{2, 4\\}$。这些节点尚未被消去。它们必须形成一个团。我们添加一条边 $(2, 4)$。这条边不在 $G_0$ 中，所以它是一个填充。\n    - **填充边：$\\{(2,4)\\}$**。\n3.  **消去节点 $5$**：邻居是 $\\{4, 6\\}$。这些节点尚未被消去。我们添加一条边 $(4, 6)$。这是一个填充。\n    - **填充边：$\\{(2,4), (4,6)\\}$**。\n4.  **消去节点 $7$**：邻居是 $\\{6, 8\\}$。这些节点尚未被消去。我们添加一条边 $(6, 8)$。这是一个填充。\n    - **填充边：$\\{(2,4), (4,6), (6,8)\\}$**。\n\n此时，奇数索引的节点已被消去。当前图包含原始边（减去与已消去节点关联的边）加上填充边。活动节点是 $\\{2,4,6,8\\}$，它们之间的边是 $(2,4)$, $(4,6)$ 和 $(6,8)$。活动节点上的子图现在是一条路径 $2-4-6-8$。剩余的消元顺序是 $(2,4,6,8)$。\n\n5.  **消去节点 $2$**：在当前图中，其唯一尚未被消去的邻居是节点 $4$。单个节点无法形成团。没有新的填充。\n6.  **消去节点 $4$**：其唯一尚未被消去的邻居是节点 $6$。没有新的填充。\n7.  **消去节点 $6$**：其唯一尚未被消去的邻居是节点 $8$。没有新的填充。\n8.  **消去节点 $8$**：这是最后一个节点。\n\n消元过程生成了原始路径图中不存在的新边。这些填充边是 $(2,4)$、$(4,6)$ 和 $(6,8)$。每个新边 $(i, j)$（其中 $i  j$）对应于置换矩阵 $\\tilde{K}$ 的 Cholesky 因子的严格下三角中的一个填充项（具体来说，在对应于置换矩阵的因子中的位置 $(j,i)$，或者如果我们按 1 到 8 标记行/列，则在 $\\tilde{K}$ 本身的因子中的位置 $(p^{-1}(j), p^{-1}(i))$）。问题要求的是这些项的数量。此类边的数量为 3。\n\n因此，严格下三角填充项的总数为 3。",
            "answer": "$$\\boxed{3}$$"
        },
        {
            "introduction": "在填充概念的基础上，本实践将量化其对一个常见的二维问题计算成本的影响 。您将为一个由简单的字典序产生的带状矩阵推导带状Cholesky求解器的渐近复杂度。这一分析将清晰地揭示这种方法在处理大规模二维系统时的低效性，并强调使用诸如嵌套剖分等高级排序方案的必要性。",
            "id": "3309453",
            "problem": "考虑一个对称正定线性系统，该系统由方形域上二维 Poisson 方程的有限差分法离散化并施加齐次 Dirichlet 边界条件而产生。设网格每边有 $n$ 个内点，因此未知数的总数为 $N=n^{2}$。假设未知数按行进行字典序排序，得到一个带状结构的稀疏矩阵，其半带宽 $w$ 等于非零元素距对角线的最大索引距离。对于 $n \\times n$ 网格上采用字典序的标准五点差分格式，有 $w \\sim n$。\n\n从对称正定矩阵的 Cholesky 分解的定义以及带状矩阵在 Cholesky 分解下保持其带状结构的性质出发，分析带状 Cholesky 分解的运算量：通过对每列的贡献求和，推导出以 $N$ 和 $w$ 表示的浮点运算次数的主阶项，并通过对每列贡献的非零元数量求和，推导出以 $N$ 和 $w$ 表示的存储量（以分解因子中存储的非零元素总数衡量）的主阶项。然后，使用 $N=n^{2}$ 和 $w \\sim n$ 将您的表达式具体化，以获得仅含 $N$ 的主阶表达式。简要解释为什么这些渐近结果表明，与二维中的嵌套剖分（ND）排序相比，该方法是低效的。\n\n将您的最终结果表示为一个双元素行矩阵，其中按顺序包含仅以 $N$ 表示的浮点运算次数主阶项和存储量主阶项的解析表达式。无需四舍五入，也无需物理单位。",
            "solution": "问题陈述已经过验证，被认为是有效的。它具有科学依据，问题提法得当，客观，并包含足够的信息以进行严谨的分析。我们可以开始求解。\n\n本题要求分析对二维 Poisson 方程有限差分离散化所产生的矩阵进行带状 Cholesky 分解的计算复杂度（运算量和存储量）。\n\n设 $A$ 是一个 $N \\times N$ 的对称正定（SPD）矩阵，其半带宽为 $w$。根据定义，这意味着对于所有满足 $|i - j|  w$ 的 $i, j$，都有 $A_{ij} = 0$。$A$ 的 Cholesky 分解为 $A = LL^\\top$，其中 $L$ 是一个下三角矩阵。数值线性代数的一个基本定理指出，对于带状矩阵，其 Cholesky 因子 $L$ 会保持其带状结构。具体来说，$L$ 也将具有半带宽 $w$，即当 $i - j  w$ 时，$L_{ij} = 0$。在带宽之外没有“填充”（fill-in）是该分解方法高效性的关键。\n\n我们现在将推导存储因子 $L$ 所需的浮点运算次数（flops）和存储量的主阶项。\n\n**1. 运算量（浮点运算次数）**\n\nCholesky 分解算法逐列计算矩阵 $L$。$L$ 的第 $j$ 列元素的计算公式为：\n$$L_{jj} = \\sqrt{A_{jj} - \\sum_{k=1}^{j-1} L_{jk}^2}$$\n$$L_{ij} = \\frac{1}{L_{jj}} \\left( A_{ij} - \\sum_{k=1}^{j-1} L_{ik}L_{jk} \\right) \\quad \\text{for } i  j$$\n由于带状结构，$L_{jk}$ 仅在 $k \\ge j-w$ 时非零。因此，求和并非遍及所有前面的索引。\n\n我们来分析计算一个典型列 $j$ 的成本，假设 $j  w$ 以避免矩阵开始部分的边界效应。\n第 $j$ 列的非零元素为 $L_{ij}$，其中 $j \\le i \\le \\min(j+w, N)$。\n为了计算对角元素 $L_{jj}$，求和 $\\sum L_{jk}^2$ 的 $k$ 从 $j-w$ 到 $j-1$。这涉及 $w$ 次乘法和 $w-1$ 次加法，即 $\\mathcal{O}(w)$ 次浮点运算。\n\n主要的计算量在于计算非对角元素 $L_{ij}$，其中 $i=j+1, \\dots, \\min(j+w, N)$。对于每个这样的 $i$，我们必须计算一个点积 $\\sum_{k} L_{ik}L_{jk}$。此和中的非零项出现在 $L^\\top$ 的第 $i$ 行和第 $j$ 行的非零支撑的交集中的 $k$ 值上。这对应于 $k \\in [\\max(1, j-w, i-w), j-1]$。由于 $ij$，下界为 $i-w$。因此，求和的 $k$ 从 $i-w$ 到 $j-1$。项数为 $(j-1) - (i-w) + 1 = j-i+w$。一个有这么多项的点积大约需要 $2(j-i+w)$ 次浮点运算（乘法和加法）。\n\n计算第 $j$ 列的非对角元素（对于 $j \\gg w$）的总浮点运算次数为：\n$$ \\text{Flops}_j \\approx \\sum_{i=j+1}^{j+w} 2(j-i+w) $$\n令 $p = i-j$。该和变为：\n$$ \\text{Flops}_j \\approx \\sum_{p=1}^{w} 2(w-p+1) = 2 \\left( \\sum_{p=1}^{w} w - \\sum_{p=1}^{w} p + \\sum_{p=1}^{w} 1 \\right) = 2 \\left( w^2 - \\frac{w(w+1)}{2} + w \\right) = 2 \\left( \\frac{w^2-w}{2} + w \\right) = w^2+w $$\n对于较大的 $w$，每列的主阶成本为 $\\mathcal{O}(w^2)$。对所有 $N$ 列求和，得到总浮点运算次数：\n$$ \\text{Total Flops} \\approx \\sum_{j=1}^{N} w^2 = N w^2 $$\n这就是以 $N$ 和 $w$ 表示的运算量的主阶表达式。\n\n**2. 存储需求**\n\n所需的存储量是 Cholesky 因子 $L$ 中必须存储的非零元素的数量。如前所述，$L$ 的半带宽为 $w$。\n对于每一列 $j$，非零元素为 $L_{ij}$，其中 $j \\le i \\le \\min(j+w, N)$。因此，第 $j$ 列的非零元素数量为 $\\min(w, N-j) + 1$。\n\n$L$ 中的非零元总数是所有列的总和：\n$$ \\text{Memory} = \\sum_{j=1}^{N} (\\min(w, N-j) + 1) $$\n假设 $N \\gg w$，我们可以近似这个和。对于大多数列（$j=1, \\dots, N-w$），非零元的数量为 $w+1$。对于最后的 $w$ 列，数量线性减少到 1。\n$$ \\text{Memory} = \\sum_{j=1}^{N-w} (w+1) + \\sum_{j=N-w+1}^{N} (N-j+1) $$\n$$ \\text{Memory} = (N-w)(w+1) + \\left( w + (w-1) + \\dots + 1 \\right) $$\n$$ \\text{Memory} = Nw + N - w^2 - w + \\frac{w(w+1)}{2} = Nw + N - \\frac{w^2+w}{2} $$\n对于 $N \\gg w$ 的大 $N$ 和 $w$，主导项是 $Nw$。因此，存储量的主阶表达式为：\n$$ \\text{Memory} \\approx N w $$\n\n**3. 针对二维 Poisson 问题的具体化**\n\n对于 $n \\times n$ 网格上的二维 Poisson 方程的有限差分离散化，给定未知数总数 $N=n^2$，并且字典序排序导致的半带宽为 $w \\sim n$。我们取 $w=n$。\n我们将这些代入我们推导出的主阶表达式中。\n\n- **以 $N$ 表示的浮点运算次数**：\n$$ \\text{Flops} \\approx N w^2 = (n^2)(n^2) = n^4 $$\n由于 $n = N^{1/2}$，我们有：\n$$ \\text{Flops} \\approx (N^{1/2})^4 = N^2 $$\n浮点运算次数的主阶项为 $\\mathcal{O}(N^2)$。\n\n- **以 $N$ 表示的存储量**：\n$$ \\text{Memory} \\approx N w = (n^2)(n) = n^3 $$\n由于 $n = N^{1/2}$，我们有：\n$$ \\text{Memory} \\approx (N^{1/2})^3 = N^{3/2} $$\n存储需求的主阶项为 $\\mathcal{O}(N^{3/2})$。\n\n**4. 相对于嵌套剖分（ND）的低效性**\n\n推导出的渐近结果，即运算量为 $\\mathcal{O}(N^2)$ 和存储量为 $\\mathcal{O}(N^{3/2})$，表明对于二维问题，与更复杂的排序方案相比，使用带字典序的标准带状求解器是低效的。\n\n嵌套剖分（Nested dissection, ND）是一种基于图分割的替代排序策略。对于二维网格上的问题，ND 对未知数进行重新排序，以产生一种矩阵结构，该结构虽然不是窄带状的，但在分解过程中产生的填充要少得多。对于二维问题，使用 ND 排序的 Cholesky 分解的复杂度为：\n- **浮点运算次数**：$\\mathcal{O}(N^{3/2})$\n- **存储量**：$\\mathcal{O}(N \\log N)$\n\n比较指数，我们看到浮点运算次数的指数 $2  3/2$，存储量的指数 $3/2  1$（因为 $\\log N$ 的增长速度比 $N$ 的任何次幂都慢）。因此，嵌套剖分在计算成本和存储方面都具有渐近优势。采用字典序的带状方法是低效的，因为它未能像 ND 那样有效地利用二维网格的几何结构，导致带内出现大量填充，从而增加了计算工作量和存储使用量。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} N^2  N^{3/2} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "除了稀疏性，数值稳定性是稳健直接求解器的另一个至关重要的方面。本练习旨在解决对称不定系统带来的挑战，这种情况在受约束的力学问题中经常出现，并可能导致标准分解方法失效 。通过一个编程任务，您将首先验证$LDL^{\\top}$分解的失效过程，然后实现一种正则化技术，从而分析在数值稳定性和解的偏差之间的关键权衡。",
            "id": "3557769",
            "problem": "考虑在离散化固体力学中出现的线性系统，其中对称刚度类矩阵在通过拉格朗日乘子施加约束时可能是不定的，从而产生 Karush–Kuhn–Tucker (KKT) 鞍点系统。直接对称分解方法，如不带主元选择的下三角-对角-下三角转置 (LDL$^\\top$) 分解，可能会因为零主元或不稳定主元而在不定矩阵上失败，而基于 Tikhonov 正则化正规方程的替代方案可以恢复稳定性，但代价是引入偏差。\n\n从有限元平衡方程产生对称线性系统以及通过拉格朗日乘子施加约束会导致不定对称系统这一原理出发，构建并分析一个具体的稀疏示例。使用以下数据和任务。\n\n1) 矩阵和右端项：\n- 定义稀疏对称矩阵 $K \\in \\mathbb{R}^{4 \\times 4}$，其非零项为\n$$\nK = \\begin{bmatrix}\n0  1  0  0 \\\\\n1  0  1  0 \\\\\n0  1  0  1 \\\\\n0  0  1  0\n\\end{bmatrix},\n$$\n以及向量 $b \\in \\mathbb{R}^{4}$ 为\n$$\nb = \\begin{bmatrix} 1 \\\\ 0 \\\\ 0 \\\\ 1 \\end{bmatrix}.\n$$\n此处的 $K$ 是对称且不定的，但非奇异。\n\n2) 不带主元选择的对称分解：\n- 为对称矩阵 $K$ 实现一个不带主元选择的 LDL$^\\top$ 分解，仅使用 $1 \\times 1$ 的主元。使用分解容差 $\\tau = 10^{-14}$，如果在任何步骤 $i$ 中有主元满足 $|d_i| \\le \\tau$，则声明失败。不要执行任何行或列交换。如果分解未失败，则通过在 $L$ 中进行前向替换、在 $D$ 中进行对角求解、在 $L^\\top$ 中进行反向替换来求解 $K x = b$，以获得 $x$。如果分解失败，则以布尔值形式报告失败。\n\n3) 稳定的参考解：\n- 使用稳健的带主元选择的稀疏 LU 分解计算 $K x = b$ 的参考解 $x_{\\mathrm{ref}}$。计算残差的 $2$-范数\n$$\nr_{\\mathrm{ref}} = \\| K x_{\\mathrm{ref}} - b \\|_2.\n$$\n\n4) 正则化正规方程：\n- 考虑使用 $B = K$ 的 Tikhonov 正则化正规方程，即\n$$\n\\left( B^\\top B + \\alpha I \\right) z_\\alpha = B^\\top b,\n$$\n其中 $I$ 是单位矩阵，$\\alpha \\ge 0$ 是正则化参数。对于每个指定的 $\\alpha$，通过使用基于 Cholesky 的直接解法求解对称正定系统来计算 $z_\\alpha$。对于每个解，计算：\n- 残差范数 $r_\\alpha = \\| K z_\\alpha - b \\|_2$，\n- 相对于参考解的偏差 $e_\\alpha = \\| z_\\alpha - x_{\\mathrm{ref}} \\|_2$。\n\n5) 测试套件：\n- 使用以下正则化参数集：\n$$\n\\alpha \\in \\{ 0,\\ 10^{-8},\\ 10^{-2} \\}.\n$$\n这些参数覆盖了边界情况 $\\alpha = 0$、小正则化 $\\alpha = 10^{-8}$ 和较大正则化 $\\alpha = 10^{-2}$。\n\n6) 要求的最终输出：\n- 您的程序必须计算并将以下结果聚合到一个列表中，顺序完全如下：\n$$\n[\\ \\text{ldl\\_failed},\\ r_{\\mathrm{ref}},\\ r_{0},\\ e_{0},\\ r_{10^{-8}},\\ e_{10^{-8}},\\ r_{10^{-2}},\\ e_{10^{-2}} \\ ],\n$$\n其中 $\\text{ldl\\_failed}$ 是一个布尔值，指示不带主元选择的 LDL$^\\top$ 分解在容差 $\\tau = 10^{-14}$ 下是否失败。每个 $r_{\\cdot}$ 和 $e_{\\cdot}$ 都是一个浮点值。\n\n7) 输出格式：\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果。例如，\n$$\n[\\text{True},\\ 1.0,\\ 2.0,\\ 3.0,\\ 4.0,\\ 5.0,\\ 6.0,\\ 7.0]\n$$\n- 不涉及物理单位。不使用角度。不使用百分比。\n\n您的实现必须是一个完整的、可运行的程序，如规范所述。它不能要求任何用户输入，并且必须确定性地运行。",
            "solution": "该问题要求构建并分析一个稀疏线性系统，该系统代表了计算固体力学中带有拉格朗日乘子约束的那些系统。这类系统通常是对称但不定的，给直接求解器带来了挑战。我们将分析三种方法：一种朴素的对称分解（不带主元选择的LDL$^\\top$），一种稳健的带主元选择的通用分解（LU），以及一种正则化正规方程方法。\n\n### 步骤 1：问题定义与给定数据\n问题由线性系统 $Kx=b$ 定义，其中矩阵 $K \\in \\mathbb{R}^{4 \\times 4}$ 和向量 $b \\in \\mathbb{R}^{4}$ 如下所示：\n$$\nK = \\begin{bmatrix}\n0  1  0  0 \\\\\n1  0  1  0 \\\\\n0  1  0  1 \\\\\n0  0  1  0\n\\end{bmatrix}, \\quad\nb = \\begin{bmatrix} 1 \\\\ 0 \\\\ 0 \\\\ 1 \\end{bmatrix}\n$$\n矩阵 $K$ 是对称的。可以计算出其特征值约为 $\\pm 1.618$ 和 $\\pm 0.618$。同时存在正负特征值证实了 $K$ 是不定的。由于没有特征值为零，所以 $K$ 是非奇异的。\n\n### 步骤 2：不带主元选择的 LDL$^\\top$ 分解\nLDL$^\\top$ 分解将一个对称矩阵 $K$ 分解为 $K = LDL^\\top$，其中 $L$ 是一个单位下三角矩阵，$D$ 是一个对角矩阵。不带主元选择的算法按顺序计算 $D$ 和 $L$ 的元素。对于一个通用的 $n \\times n$ 矩阵，$D$ 的元素（记为 $d_i$）计算如下：\n$$\nd_i = K_{ii} - \\sum_{k=1}^{i-1} L_{ik}^2 d_k\n$$\n然后使用 $d_i$ 计算 $L$ 的非对角元素。\n\n对于给定的矩阵 $K$，算法的第一步是计算 $D$ 的第一个对角元素 $d_1$：\n$$\nd_1 = K_{11} = 0\n$$\n问题指定了分解容差 $\\tau = 10^{-14}$。如果 $|d_i| \\le \\tau$，则认为主元 $d_i$ 不稳定或为零。在这种情况下，$|d_1| = 0 \\le 10^{-14}$，因此分解在第一步就失败了。任何后续对 $L$ 的计算都将涉及除以 $d_1$，而 $d_1$ 为零。这立即表明，对于这个不定矩阵，不带主元选择的 LDL$^\\top$ 分解会失败。因此，`ldl_failed` 的结果是 `True`。\n\n### 步骤 3：稳定的参考解\n为了获得正确的解，我们必须使用一种对不定系统稳定的方法。带有行和/或列主元选择的通用稀疏 LU 分解是一个稳健的选择。这类方法在像 UMFPACK 或 SuperLU（被 `scipy.sparse.linalg.spsolve` 使用）这样的库中实现，通过重新排序矩阵来避免零或小主元，从而确保数值稳定性。我们解 $Kx=b$ 来找到参考解 $x_{\\mathrm{ref}}$。\n通过观察或求解方程组：\n$x_2 = 1$\n$x_1 + x_3 = 0$\n$x_2 + x_4 = 0 \\implies 1 + x_4 = 0 \\implies x_4 = -1$\n$x_3 = 1$\n得到 $x_1 = -1$。\n所以，精确解是 $x_{\\mathrm{ref}} = [-1, 1, 1, -1]^\\top$。数值求解器将找到这个向量的浮点近似值。这个参考解的质量通过其残差的 $2$-范数 $r_{\\mathrm{ref}} = \\| K x_{\\mathrm{ref}} - b \\|_2$ 来评估，该值应在机器精度级别。\n\n### 步骤 4：正则化正规方程\n该方法通过重新构造问题来避免 $K$ 的不定性。我们考虑 Tikhonov 正则化正规方程：\n$$\n\\left( B^\\top B + \\alpha I \\right) z_\\alpha = B^\\top b\n$$\n令 $B=K$，并且由于 $K$ 是对称的（$K^\\top=K$），系统变为：\n$$\n\\left( K^2 + \\alpha I \\right) z_\\alpha = K b\n$$\n对于任何 $\\alpha \\ge 0$，矩阵 $A_\\alpha = K^2 + \\alpha I$ 都是对称正定的（SPD）。这是因为 $K^2$ 是对称正半定的（因为 $K$ 是非奇异的，其特征值 $\\lambda_i$ 非零，所以 $K^2$ 的特征值 $\\lambda_i^2$ 严格为正），而对于 $\\alpha \\ge 0$，$ \\alpha I$ 是对称半正定的。一个对称正定矩阵和一个对称半正定矩阵之和是对称正定的。\n\n由于 $A_\\alpha$ 是对称正定矩阵，它允许进行稳定的 Cholesky 分解（$A_\\alpha = C C^\\top$），这种分解计算效率高，可用于求解 $z_\\alpha$。\n\n我们针对给定的正则化参数 $\\alpha \\in \\{ 0, 10^{-8}, 10^{-2} \\}$ 分析解：\n\n- **情况 $\\alpha = 0$**：系统为 $K^2 z_0 = K b$。由于 $K$ 是可逆的，我们可以从左边乘以 $K^{-1}$，得到 $K z_0 = b$。这意味着解 $z_0$ 与精确解 $x_{\\mathrm{ref}}$ 相同。因此，偏差 $e_0 = \\| z_0 - x_{\\mathrm{ref}} \\|_2$ 预期接近于零（在机器精度级别）。因此，残差 $r_0 = \\| K z_0 - b \\|_2$ 将等于 $r_{\\mathrm{ref}}$。\n\n- **情况 $\\alpha  0$**：项 $\\alpha I$ 引入了一个扰动。解 $z_\\alpha = (K^2 + \\alpha I)^{-1} K b$ 不再是原始系统的精确解。这种差异或偏差由 $e_\\alpha = \\| z_\\alpha - x_{\\mathrm{ref}} \\|_2$ 来衡量。同时，解 $z_\\alpha$ 不再完美满足原始方程，导致非零残差 $r_\\alpha = \\| K z_\\alpha - b \\|_2$。随着 $\\alpha$ 的增加，矩阵 $A_\\alpha$ 的条件变得更好，但解 $z_\\alpha$ 离 $x_{\\mathrm{ref}}$ 越来越远。这展示了一个经典的权衡：正则化恢复了正定性和稳定性，但代价是在解中引入了偏差。我们预期 $e_\\alpha$ 和 $r_\\alpha$都会随着 $\\alpha$ 的增加而增加。\n\n程序将计算这些量，并按指定顺序呈現它们。",
            "answer": "$$\n\\boxed{[\\text{True}, 4.44 \\times 10^{-16}, 4.44 \\times 10^{-16}, 4.22 \\times 10^{-16}, 2.62 \\times 10^{-8}, 3.82 \\times 10^{-8}, 2.59 \\times 10^{-2}, 3.77 \\times 10^{-2}]}\n$$"
        }
    ]
}