{
    "hands_on_practices": [
        {
            "introduction": "The validity of any Representative Volume Element (RVE) model hinges on its ability to satisfy the Hill–Mandel macro-homogeneity condition, which ensures energetic consistency between the micro and macro scales. This foundational exercise uses a simple one-dimensional composite bar to provide a clear, analytical demonstration of this principle. By contrasting an energy-consistent boundary condition with a deliberately \"polluted\" one, you will directly quantify the error introduced by violating this critical condition, thereby building a strong intuition for why proper boundary condition formulation is non-negotiable in multiscale modeling .",
            "id": "3608356",
            "problem": "Consider a one-dimensional representative volume element (RVE) of total length $L$ and uniform cross-sectional area $A$, composed of two linearly elastic phases stacked in series along the loading direction. The left sub-bar has length $L_{1}$ and Young’s modulus $E_{1}$, and the right sub-bar has length $L_{2}$ and Young’s modulus $E_{2}$, with $L_{1}+L_{2}=L$. Assume small strains, no body forces, and quasi-static loading. The microscopic constitutive relation is $\\sigma(x) = E(x)\\,\\epsilon(x)$ with $E(x)=E_{1}$ on $[0,L_{1}]$ and $E(x)=E_{2}$ on $[L_{1},L]$. The microscopic equilibrium condition is that the axial force is constant, so the microscopic stress $\\sigma$ is spatially uniform.\n\nThe Hill–Mandel macro-homogeneity condition states that the macroscopic stress–strain power is equal to the volume average of the microscopic stress–strain power, i.e., $\\bar{\\boldsymbol{\\sigma}}:\\delta\\bar{\\boldsymbol{\\epsilon}} = \\frac{1}{|V|}\\int_{V}\\boldsymbol{\\sigma}:\\delta\\boldsymbol{\\epsilon}\\,\\mathrm{d}V$ for all admissible macroscopic virtual strains, which in one dimension reduces to $\\bar{\\sigma}\\,\\delta\\bar{\\epsilon} = \\frac{1}{L}\\int_{0}^{L}\\sigma\\,\\delta\\epsilon\\,\\mathrm{d}x$. For first-order two-scale computational homogenization, energy-consistent boundary conditions on the RVE must ensure that the boundary work of microscopic fluctuation fields vanishes.\n\n1) Using only the fundamental definitions above, derive the effective homogenized modulus $E_{\\mathrm{eff}}$ that maps the macroscopic strain $\\bar{\\epsilon}$ to the macroscopic stress $\\bar{\\sigma}$ under an energy-consistent Dirichlet-type boundary condition that enforces a uniform macroscopic strain, i.e., $u(0)=0$ and $u(L)=\\bar{\\epsilon}L$.\n\n2) Now deliberately violate the Hill–Mandel energy consistency by imposing the following “polluted” boundary condition:\n$u(0)=0$ and $u(L)=\\bar{\\epsilon}L+\\delta$ with $\\delta\\neq 0$. Show, by evaluating the boundary work of microscopic fluctuations, that this boundary condition violates the Hill–Mandel condition. Then, solve the microscopic problem under this boundary condition to obtain the resulting apparent modulus $\\tilde{E}$ that maps $\\bar{\\epsilon}$ to $\\bar{\\sigma}$, and express the absolute error in apparent stiffness as $|\\tilde{E}-E_{\\mathrm{eff}}|$.\n\n3) For a specific heterogeneous medium with $L_{1}=L_{2}=L/2$, $E_{1}=150\\,\\text{GPa}$, $E_{2}=30\\,\\text{GPa}$, and a prescribed fluctuation magnitude given by $\\delta=0.1\\,\\bar{\\epsilon}L$, compute the absolute error $|\\tilde{E}-E_{\\mathrm{eff}}|$. Express your final numerical answer in gigapascals (GPa) and round your answer to four significant figures.",
            "solution": "The user-provided problem is a standard exercise in first-order computational homogenization in one dimension. Before proceeding to the solution, a validation of the problem statement is required.\n\n### Step 1: Extract Givens\n- **Geometry and Material:** A one-dimensional representative volume element (RVE) of total length $L$ and uniform cross-sectional area $A$. It comprises two linearly elastic phases in series.\n- **Phase 1:** Occupies the domain $x \\in [0, L_1]$ with Young’s modulus $E_1$.\n- **Phase 2:** Occupies the domain $x \\in [L_1, L]$ with Young’s modulus $E_2$.\n- **Constraint:** $L_1 + L_2 = L$.\n- **Physics:** Small strains, no body forces, and quasi-static loading are assumed.\n- **Microscopic Constitutive Law:** $\\sigma(x) = E(x)\\,\\epsilon(x)$, where $E(x) = E_1$ for $x \\in [0, L_1]$ and $E(x) = E_2$ for $x \\in [L_1, L]$.\n- **Microscopic Equilibrium:** The microscopic stress $\\sigma$ is spatially uniform.\n- **Hill-Mandel Condition:** The macroscopic and microscopic virtual work-rates are equivalent: $\\bar{\\sigma}\\,\\delta\\bar{\\epsilon} = \\frac{1}{L}\\int_{0}^{L}\\sigma\\,\\delta\\epsilon\\,\\mathrm{d}x$.\n- **Part 1 Task & BC:** Derive the effective modulus $E_{\\mathrm{eff}}$ under the Dirichlet boundary condition $u(0)=0$ and $u(L)=\\bar{\\epsilon}L$.\n- **Part 2 Task & BC:** For a \"polluted\" boundary condition $u(0)=0$ and $u(L)=\\bar{\\epsilon}L+\\delta$ (with $\\delta\\neq 0$), show it violates the Hill–Mandel condition, derive the apparent modulus $\\tilde{E}$, and find the error $|\\tilde{E}-E_{\\mathrm{eff}}|$.\n- **Part 3 Task & Data:** For the specific case where $L_{1}=L_{2}=L/2$, $E_{1}=150\\,\\text{GPa}$, $E_{2}=30\\,\\text{GPa}$, and $\\delta=0.1\\,\\bar{\\epsilon}L$, compute the numerical value of the absolute error $|\\tilde{E}-E_{\\mathrm{eff}}|$.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientific Grounding:** The problem is firmly grounded in the principles of continuum mechanics and multiscale material modeling. The concepts of an RVE, the Hill-Mandel condition, and the application of boundary conditions to derive effective properties are all standard and correct elements of homogenization theory.\n- **Well-Posedness:** The problem is well-posed. For each part, the givens are sufficient to determine a unique solution. The questions are mathematically and physically meaningful.\n- **Objectivity:** The problem is stated in precise, objective, and quantitative terms, free from any subjectivity or ambiguity.\n- **Conclusion:** The problem is free of scientific flaws, contradictions, or ambiguities. It is a valid, well-structured problem in computational solid mechanics.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A full, reasoned solution will be provided.\n\n### Solution\n\nThe foundation of this problem lies in relating macroscopic (homogenized) quantities to their microscopic (heterogeneous) counterparts. The macroscopic stress $\\bar{\\sigma}$ and strain $\\bar{\\epsilon}$ are defined as volume averages of the microscopic fields:\n$$ \\bar{\\sigma} = \\frac{1}{L}\\int_{0}^{L}\\sigma(x)\\,\\mathrm{d}x $$\n$$ \\bar{\\epsilon} = \\frac{1}{L}\\int_{0}^{L}\\epsilon(x)\\,\\mathrm{d}x $$\nFrom the microscopic equilibrium condition, the stress $\\sigma(x)$ is constant, which we denote as $\\sigma$. Therefore, the macroscopic stress simplifies to $\\bar{\\sigma} = \\sigma$. The microscopic strain is related to the displacement field $u(x)$ by $\\epsilon(x) = \\frac{\\mathrm{d}u}{\\mathrm{d}x}$. The average strain can then be computed as:\n$$ \\bar{\\epsilon} = \\frac{1}{L}\\int_{0}^{L}\\frac{\\mathrm{d}u}{\\mathrm{d}x}\\,\\mathrm{d}x = \\frac{u(L) - u(0)}{L} $$\n\n**1) Derivation of the Effective Modulus $E_{\\mathrm{eff}}$**\n\nFor this part, the boundary conditions are $u(0)=0$ and $u(L)=\\bar{\\epsilon}L$. Substituting these into the expression for the average strain confirms that the prescribed parameter $\\bar{\\epsilon}$ is indeed the true average strain of the RVE:\n$$ \\frac{u(L) - u(0)}{L} = \\frac{\\bar{\\epsilon}L-0}{L} = \\bar{\\epsilon} $$\nTo find the effective modulus $E_{\\mathrm{eff}}$ defined by the macroscopic law $\\bar{\\sigma}=E_{\\mathrm{eff}}\\bar{\\epsilon}$, we must express $\\bar{\\epsilon}$ in terms of $\\bar{\\sigma}$. We use the microscopic constitutive law $\\sigma(x) = E(x)\\epsilon(x)$, which can be inverted to find the strain: $\\epsilon(x) = \\sigma(x)/E(x)$. Since $\\sigma(x)=\\sigma=\\bar{\\sigma}$, we have $\\epsilon(x) = \\bar{\\sigma}/E(x)$.\n\nWe now compute the average strain by integrating over the two phases:\n$$ \\bar{\\epsilon} = \\frac{1}{L}\\int_{0}^{L}\\epsilon(x)\\,\\mathrm{d}x = \\frac{1}{L}\\int_{0}^{L}\\frac{\\bar{\\sigma}}{E(x)}\\,\\mathrm{d}x $$\n$$ \\bar{\\epsilon} = \\frac{\\bar{\\sigma}}{L}\\left[ \\int_{0}^{L_1}\\frac{1}{E_1}\\,\\mathrm{d}x + \\int_{L_1}^{L}\\frac{1}{E_2}\\,\\mathrm{d}x \\right] $$\n$$ \\bar{\\epsilon} = \\frac{\\bar{\\sigma}}{L}\\left[ \\frac{L_1}{E_1} + \\frac{L_2}{E_2} \\right] = \\bar{\\sigma} \\left[ \\frac{L_1/L}{E_1} + \\frac{L_2/L}{E_2} \\right] $$\nThe relationship between $\\bar{\\sigma}$ and $\\bar{\\epsilon}$ is thus $\\frac{\\bar{\\epsilon}}{\\bar{\\sigma}} = \\frac{L_1/L}{E_1} + \\frac{L_2/L}{E_2}$.\nBy definition, $E_{\\mathrm{eff}} = \\frac{\\bar{\\sigma}}{\\bar{\\epsilon}}$. Therefore, the reciprocal of the effective modulus is:\n$$ \\frac{1}{E_{\\mathrm{eff}}} = \\frac{L_1/L}{E_1} + \\frac{L_2/L}{E_2} $$\nThis gives the effective modulus as the volume-weighted harmonic average of the phase moduli:\n$$ E_{\\mathrm{eff}} = \\left(\\frac{L_1}{L E_1} + \\frac{L_2}{L E_2}\\right)^{-1} $$\nThis is the correct result for a series composite, corresponding to the Reuss bound.\n\n**2) Analysis of the \"Polluted\" Boundary Condition**\n\nThe Hill-Mandel condition is satisfied if the work done by boundary tractions on the fluctuation displacement field is zero. The displacement field $u(x)$ is decomposed as $u(x) = \\bar{\\epsilon}x + u'(x)$, where $\\bar{\\epsilon}x$ is the macroscopic part and $u'(x)$ is the fluctuation. The condition for energy consistency in $1$D is that the boundary work of fluctuations vanishes: $[(\\sigma A) u'(x)]_{0}^{L} = 0$.\n\nFor the \"polluted\" BC, $u(0)=0$ and $u(L)=\\bar{\\epsilon}L+\\delta$. We evaluate the fluctuation field at the boundaries:\n$$ u'(0) = u(0) - \\bar{\\epsilon}(0) = 0 - 0 = 0 $$\n$$ u'(L) = u(L) - \\bar{\\epsilon}L = (\\bar{\\epsilon}L + \\delta) - \\bar{\\epsilon}L = \\delta $$\nThe boundary work of fluctuations is therefore:\n$$ [(\\sigma A) u'(x)]_{0}^{L} = (\\sigma A) u'(L) - (\\sigma A) u'(0) = (\\sigma A)\\delta - 0 = \\sigma A \\delta $$\nSince it is given that $\\delta \\neq 0$ and we assume a non-trivial loading state ($\\sigma \\neq 0$), the boundary work $\\sigma A \\delta$ is non-zero. This non-zero boundary work demonstrates that the \"polluted\" boundary condition violates the Hill-Mandel energy consistency requirement.\n\nNext, we derive the apparent modulus $\\tilde{E}$ that maps the parameter $\\bar{\\epsilon}$ to the resulting average stress $\\bar{\\sigma}$. Under these BCs, the true average strain in the RVE, let's call it $\\epsilon_{\\mathrm{avg}}$, is:\n$$ \\epsilon_{\\mathrm{avg}} = \\frac{u(L) - u(0)}{L} = \\frac{(\\bar{\\epsilon}L+\\delta) - 0}{L} = \\bar{\\epsilon} + \\frac{\\delta}{L} $$\nThe relationship between the true average strain and the average stress is still governed by the true effective modulus $E_{\\mathrm{eff}}$:\n$$ \\bar{\\sigma} = E_{\\mathrm{eff}} \\epsilon_{\\mathrm{avg}} = E_{\\mathrm{eff}} \\left(\\bar{\\epsilon} + \\frac{\\delta}{L}\\right) $$\nThe problem defines the apparent modulus $\\tilde{E}$ through the relation $\\bar{\\sigma} = \\tilde{E} \\bar{\\epsilon}$, where $\\bar{\\epsilon}$ is the parameter from the BC, not the true average strain. Setting the two expressions for $\\bar{\\sigma}$ equal gives:\n$$ \\tilde{E} \\bar{\\epsilon} = E_{\\mathrm{eff}} \\left(\\bar{\\epsilon} + \\frac{\\delta}{L}\\right) $$\nSolving for $\\tilde{E}$ yields:\n$$ \\tilde{E} = E_{\\mathrm{eff}} \\left(1 + \\frac{\\delta}{L\\bar{\\epsilon}}\\right) $$\nThe absolute error in the apparent stiffness is:\n$$ |\\tilde{E} - E_{\\mathrm{eff}}| = \\left| E_{\\mathrm{eff}} \\left(1 + \\frac{\\delta}{L\\bar{\\epsilon}}\\right) - E_{\\mathrm{eff}} \\right| = \\left| E_{\\mathrm{eff}} \\frac{\\delta}{L\\bar{\\epsilon}} \\right| $$\n\n**3) Numerical Calculation of the Absolute Error**\n\nWe are given $L_1=L_2=L/2$, $E_1=150\\,\\text{GPa}$, and $E_2=30\\,\\text{GPa}$. First, we calculate the true effective modulus $E_{\\mathrm{eff}}$:\n$$ E_{\\mathrm{eff}} = \\left(\\frac{L_1/L}{E_1} + \\frac{L_2/L}{E_2}\\right)^{-1} = \\left(\\frac{1/2}{150} + \\frac{1/2}{30}\\right)^{-1} = \\left(\\frac{1}{300} + \\frac{1}{60}\\right)^{-1} $$\n$$ E_{\\mathrm{eff}} = \\left(\\frac{1+5}{300}\\right)^{-1} = \\left(\\frac{6}{300}\\right)^{-1} = \\frac{300}{6} = 50\\,\\text{GPa} $$\nNow, we use the given fluctuation magnitude $\\delta = 0.1\\bar{\\epsilon}L$ to calculate the absolute error. Substituting this into the error expression from Part 2:\n$$ |\\tilde{E} - E_{\\mathrm{eff}}| = \\left| E_{\\mathrm{eff}} \\frac{0.1\\bar{\\epsilon}L}{L\\bar{\\epsilon}} \\right| = |0.1 E_{\\mathrm{eff}}| $$\nSince $E_{\\mathrm{eff}} = 50\\,\\text{GPa}$ is positive, the absolute error is:\n$$ |\\tilde{E} - E_{\\mathrm{eff}}| = 0.1 \\times 50\\,\\text{GPa} = 5\\,\\text{GPa} $$\nRounding to four significant figures as requested, the final answer is $5.000\\,\\text{GPa}$.",
            "answer": "$$\\boxed{5.000}$$"
        },
        {
            "introduction": "With a firm grasp of the need for energy consistency, we now turn to its practical implementation. This exercise guides you through building a complete two-dimensional, linear elastic finite element solver for a composite RVE from first principles . You will implement Periodic Boundary Conditions (PBCs), the most widely used class of energy-consistent constraints, learning how to handle the periodic node-pairing and assemble the global system. The final step involves computing the volume-averaged homogenized stress, a core skill for extracting effective material properties.",
            "id": "3608310",
            "problem": "You are to implement a complete small-strain, two-dimensional, plane-strain, linear-elastic micro-scale problem for Two-Scale Computational Homogenization (FE2) using a Representative Volume Element (RVE) with Periodic Boundary Conditions (PBC). The RVE is the unit square domain $\\Omega = [0,1] \\times [0,1]$, discretized by a uniform bilinear quadrilateral finite element (FE) mesh, and occupied by a two-phase composite with prescribed phase properties and volume fraction. The goal is to compute the homogenized (volume-averaged) Cauchy stress for a prescribed macroscopic uniaxial strain. You must produce a single program that performs the micro-scale FE solve and outputs the homogenized stress component $\\bar{\\sigma}_{11}$ for each provided test case.\n\nStart from first principles of small-strain linear elasticity, balance of linear momentum, and constitutive linearity, without shortcut formulas beyond core definitions:\n\n- Kinematics: the small-strain tensor is $\\boldsymbol{\\varepsilon}(\\mathbf{u}) = \\frac{1}{2}(\\nabla \\mathbf{u} + \\nabla \\mathbf{u}^{\\mathsf{T}})$, with engineering shear strain defined by $\\gamma_{12} = 2 \\varepsilon_{12}$.\n- Balance of linear momentum (without body forces) at the micro-scale: $\\nabla \\cdot \\boldsymbol{\\sigma} = \\mathbf{0}$ in $\\Omega$.\n- Constitutive relation for isotropic linear elasticity under plane strain: $\\boldsymbol{\\sigma} = \\mathbb{C} : \\boldsymbol{\\varepsilon}$, with $\\mathbb{C}$ determined by Young’s modulus $E$ and Poisson’s ratio $\\nu$ via the Lamé parameters $\\lambda = \\dfrac{\\nu E}{(1+\\nu)(1-2\\nu)}$ and $\\mu = \\dfrac{E}{2(1+\\nu)}$, and the $3 \\times 3$ matrix (in Voigt notation with ordering $[\\varepsilon_{11}, \\varepsilon_{22}, \\gamma_{12}]^{\\mathsf{T}}$)\n$$\n\\mathbf{C} = \n\\begin{bmatrix}\n\\lambda + 2\\mu & \\lambda & 0 \\\\\n\\lambda & \\lambda + 2\\mu & 0 \\\\\n0 & 0 & \\mu\n\\end{bmatrix}.\n$$\n\nImpose Periodic Boundary Conditions (PBC) consistent with a prescribed macroscopic strain $\\bar{\\boldsymbol{E}}$ by decomposing the micro-scale displacement $\\mathbf{u}(\\mathbf{x})$ as $\\mathbf{u}(\\mathbf{x}) = \\bar{\\boldsymbol{E}} \\, \\mathbf{x} + \\tilde{\\mathbf{u}}(\\mathbf{x})$, where $\\tilde{\\mathbf{u}}(\\mathbf{x})$ is periodic across opposite boundaries. The periodicity is enforced by tying opposite boundary node pairs so that their displacement differences equal the macroscopic affine part, i.e., for opposite points $\\mathbf{x}^{+}$ and $\\mathbf{x}^{-}$ on a pair of opposite boundaries,\n$$\n\\mathbf{u}(\\mathbf{x}^{+}) - \\mathbf{u}(\\mathbf{x}^{-}) = \\bar{\\boldsymbol{E}} \\, (\\mathbf{x}^{+} - \\mathbf{x}^{-}).\n$$\nTo eliminate rigid body modes of $\\tilde{\\mathbf{u}}$, fix the two displacement components of a single reference node.\n\nUse the finite element method with bilinear quadrilateral elements (Q4) and $2 \\times 2$ Gauss quadrature. Let the mesh have $N_x$ elements along $x$ and $N_y$ elements along $y$. For this problem, fix $N_x = 12$ and $N_y = 12$. Use isoparametric mapping, compute element stiffness matrices via standard assembly $ \\mathbf{K}_e = \\int_{\\Omega_e} \\mathbf{B}^{\\mathsf{T}} \\mathbf{C} \\, \\mathbf{B} \\, \\mathrm{d}\\Omega$ with $ \\mathbf{B}$ the strain-displacement matrix, and assemble the global stiffness.\n\nDefine the two-phase composite as follows. Phase $1$ has Young’s modulus $E_1$ and Poisson’s ratio $\\nu_1$, phase $2$ has Young’s modulus $E_2$ and Poisson’s ratio $\\nu_2$. The target volume fraction of phase $1$ is $v_f \\in [0,1]$. The material distribution is a perfectly periodic vertical layering: phase $1$ occupies $\\{(x,y) \\in \\Omega: x \\in [0, v_f)\\}$ and phase $2$ occupies the complement. This realizes exactly the desired volume fraction in the continuum setting and is consistent with periodic extension of the RVE. In the finite element discretization, assign each element’s constitutive tensor $\\mathbf{C}_e$ based on the $x$-coordinate of its centroid relative to $v_f$.\n\nFor the macroscopic loading, prescribe a uniaxial macroscopic strain of the form\n$$\n\\bar{\\boldsymbol{E}} = \n\\begin{bmatrix}\n\\bar{\\varepsilon}_{11} & 0 \\\\\n0 & 0\n\\end{bmatrix},\n$$\nwith $\\bar{\\varepsilon}_{11}$ given. Solve the micro problem subject to PBC and the reference-node constraints, then compute the homogenized Cauchy stress by volume averaging,\n$$\n\\bar{\\boldsymbol{\\sigma}} = \\frac{1}{|\\Omega|} \\int_{\\Omega} \\boldsymbol{\\sigma}(\\mathbf{x}) \\, \\mathrm{d}\\Omega = \\frac{1}{|\\Omega|} \\sum_{e} \\int_{\\Omega_e} \\mathbf{C}_e \\, \\mathbf{B} \\, \\mathbf{u}_h \\, \\mathrm{d}\\Omega,\n$$\nand report the $\\bar{\\sigma}_{11}$ component.\n\nPhysical units: All Young’s moduli $E_1$ and $E_2$ must be interpreted in Pascals (Pa). Poisson’s ratios $\\nu_1$ and $\\nu_2$ are dimensionless. The macroscopic strain $\\bar{\\varepsilon}_{11}$ is dimensionless. The output homogenized stress $\\bar{\\sigma}_{11}$ must be reported in Pascals (Pa). Angles are not used. No percentages may appear; volume fraction $v_f$ is a decimal in $[0,1]$.\n\nNumerical specification for the FE discretization and quadrature:\n- Use a uniform mesh with $N_x = 12$ and $N_y = 12$ bilinear quadrilateral elements over $\\Omega$.\n- Use $2 \\times 2$ Gaussian quadrature per element with standard points at $\\pm 1/\\sqrt{3}$ and unit weights.\n- Enforce PBC by periodic node pairing in both $x$- and $y$-directions with the affine macroscopic jump defined by $\\bar{\\boldsymbol{E}}$.\n- Eliminate rigid body modes by fixing both displacement components of the master node at $(0,0)$.\n\nTest Suite:\nYour program must run the following four test cases and output the homogenized $\\bar{\\sigma}_{11}$ for each, in Pascals (Pa):\n1. $E_1 = 200 \\times 10^{9}$, $\\nu_1 = 0.30$, $E_2 = 70 \\times 10^{9}$, $\\nu_2 = 0.33$, $v_f = 0.30$, $\\bar{\\varepsilon}_{11} = 0.001$.\n2. $E_1 = 150 \\times 10^{9}$, $\\nu_1 = 0.28$, $E_2 = 50 \\times 10^{9}$, $\\nu_2 = 0.25$, $v_f = 0.0$, $\\bar{\\varepsilon}_{11} = 0.001$.\n3. $E_1 = 210 \\times 10^{9}$, $\\nu_1 = 0.30$, $E_2 = 5 \\times 10^{9}$, $\\nu_2 = 0.45$, $v_f = 1.0$, $\\bar{\\varepsilon}_{11} = 0.0005$.\n4. $E_1 = 100 \\times 10^{9}$, $\\nu_1 = 0.29$, $E_2 = 1 \\times 10^{9}$, $\\nu_2 = 0.35$, $v_f = 0.50$, $\\bar{\\varepsilon}_{11} = 0.002$.\n\nAnswer format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in scientific notation with six digits after the decimal point, namely $[\\text{res}_1,\\text{res}_2,\\text{res}_3,\\text{res}_4]$, where each $\\text{res}_k$ is $\\bar{\\sigma}_{11}$ in Pascals (Pa), formatted as, for example, $1.234567\\text{e}+08$.",
            "solution": "The user has provided a well-posed problem in computational solid mechanics, specifically concerning two-scale computational homogenization. The task is to implement a finite element (FE) model for a two-dimensional, plane-strain, linear-elastic Representative Volume Element (RVE) with Periodic Boundary Conditions (PBCs). The goal is to compute the homogenized stress tensor resulting from a prescribed macroscopic strain.\n\nThe problem statement is validated as scientifically grounded, well-posed, and objective. It provides all necessary information, including the governing equations, constitutive laws, boundary conditions, discretization parameters, material properties, and loading cases, allowing for a direct and unambiguous implementation.\n\nThe solution proceeds as follows:\n\n**1. Theoretical Formulation**\n\nThe micro-scale problem is governed by the balance of linear momentum, which in the absence of body forces is $\\nabla \\cdot \\boldsymbol{\\sigma} = \\mathbf{0}$, where $\\boldsymbol{\\sigma}$ is the Cauchy stress tensor. The material behavior is described by a linear isotropic elastic constitutive relation, $\\boldsymbol{\\sigma} = \\mathbb{C} : \\boldsymbol{\\varepsilon}$, where $\\mathbb{C}$ is the fourth-order elasticity tensor and $\\boldsymbol{\\varepsilon}$ is the small-strain tensor, $\\boldsymbol{\\varepsilon}(\\mathbf{u}) = \\frac{1}{2}(\\nabla \\mathbf{u} + \\nabla \\mathbf{u}^{\\mathsf{T}})$. For the plane strain condition, the constitutive matrix $\\mathbf{C}$ in Voigt notation ($[\\varepsilon_{11}, \\varepsilon_{22}, \\gamma_{12}]^\\mathsf{T}$) is given by:\n$$\n\\mathbf{C} = \n\\begin{bmatrix}\n\\lambda + 2\\mu & \\lambda & 0 \\\\\n\\lambda & \\lambda + 2\\mu & 0 \\\\\n0 & 0 & \\mu\n\\end{bmatrix}\n$$\nwhere $\\lambda = \\frac{\\nu E}{(1+\\nu)(1-2\\nu)}$ and $\\mu = \\frac{E}{2(1+\\nu)}$ are the Lamé parameters, defined by Young's modulus $E$ and Poisson's ratio $\\nu$.\n\n**2. Periodic Boundary Conditions (PBCs) and FE Discretization**\n\nThe key to homogenization is the enforcement of PBCs, which link the micro-scale displacement field $\\mathbf{u}(\\mathbf{x})$ to the macroscopic strain tensor $\\bar{\\boldsymbol{E}}$. The displacement field is decomposed as $\\mathbf{u}(\\mathbf{x}) = \\bar{\\boldsymbol{E}} \\mathbf{x} + \\tilde{\\mathbf{u}}(\\mathbf{x})$, where $\\tilde{\\mathbf{u}}(\\mathbf{x})$ is a periodic fluctuation field. This leads to the constraint for any pair of points $\\mathbf{x}^{+}$ and $\\mathbf{x}^{-}$ on opposite boundaries of the RVE:\n$$\n\\mathbf{u}(\\mathbf{x}^{+}) - \\mathbf{u}(\\mathbf{x}^{-}) = \\bar{\\boldsymbol{E}} (\\mathbf{x}^{+} - \\mathbf{x}^{-})\n$$\nIn the finite element framework, this translates to linear constraint equations between the degrees of freedom (DOFs) of nodes on opposite boundaries. We employ a master-slave approach. Nodes on the left and bottom boundaries are designated as \"master\" nodes, and nodes on the right and top boundaries are \"slave\" nodes. The DOFs of slave nodes are expressed in terms of the DOFs of their corresponding master nodes plus a non-homogeneous term derived from $\\bar{\\boldsymbol{E}}$. For the prescribed loading $\\bar{\\boldsymbol{E}} = \\text{diag}(\\bar{\\varepsilon}_{11}, 0)$, the constraints for nodal displacements $\\mathbf{d}$ are:\n- For a node pair on the right/left boundaries (at $x=1, x=0$): $\\mathbf{d}(1, y_j) = \\mathbf{d}(0, y_j) + [\\bar{\\varepsilon}_{11}, 0]^{\\mathsf{T}}$.\n- For a node pair on the top/bottom boundaries (at $y=1, y=0$): $\\mathbf{d}(x_i, 1) = \\mathbf{d}(x_i, 0)$.\n\nThese constraints are used to eliminate the slave DOFs, resulting in a reduced system of linear equations $\\mathbf{K}^* \\mathbf{d}^* = \\mathbf{F}^*$, where $\\mathbf{d}^*$ contains only the independent master DOFs. To ensure a unique solution by removing the rigid body motion of the fluctuation field $\\tilde{\\mathbf{u}}$, the displacements of one master node (here, the node at the origin $(0,0)$) are fixed to zero.\n\nThe RVE domain $\\Omega = [0,1] \\times [0,1]$ is discretized using a uniform $N_x \\times N_y = 12 \\times 12$ mesh of bilinear quadrilateral (Q4) elements. Standard isoparametric FE procedures are used. The element stiffness matrix $\\mathbf{K}_e = \\int_{\\Omega_e} \\mathbf{B}^{\\mathsf{T}} \\mathbf{C} \\mathbf{B} \\, \\mathrm{d}\\Omega$ is computed via $2 \\times 2$ Gaussian quadrature, where $\\mathbf{B}$ is the strain-displacement matrix.\n\n**3. Assembly of the Reduced System**\n\nThe assembly process condenses the global system into the reduced system for the independent DOFs $\\mathbf{d}^*$. For each element, its stiffness matrix $\\mathbf{K}_e$ is computed. The contribution of each entry $K_{e,ij}$ to the reduced system is determined by the master-slave relationships of the local DOFs $i$ and $j$. If local DOF $j$ is a slave with displacement $d_j = d_{m_j} + g_j$ (where $d_{m_j}$ is the master DOF and $g_j$ is the jump), its contribution is split: the stiffness part $K_{e,ij}d_{m_j}$ is assembled into the reduced stiffness matrix $\\mathbf{K}^*$, and the prescribed displacement part $K_{e,ij}g_j$ is moved to the right-hand side, contributing to the reduced force vector $\\mathbf{F}^*$.\n\n**4. Solution and Homogenization**\n\nAfter assembling $\\mathbf{K}^*$ and $\\mathbf{F}^*$, the linear system is solved for the unknown master displacements $\\mathbf{d}^*$. Subsequently, the full displacement field over the entire RVE is reconstructed by applying the master-slave relations.\n\nThe final step is to compute the homogenized stress tensor, which is the volume average of the micro-scale stress:\n$$\n\\bar{\\boldsymbol{\\sigma}} = \\frac{1}{|\\Omega|} \\int_{\\Omega} \\boldsymbol{\\sigma}(\\mathbf{x}) \\, \\mathrm{d}\\Omega\n$$\nSince $|\\Omega|=1$, this is simply the integral of the stress over the domain. In the FE context, this integral is computed as a sum of integrals over each element, evaluated using the same Gauss quadrature scheme:\n$$\n\\bar{\\boldsymbol{\\sigma}} = \\sum_e \\int_{\\Omega_e} \\mathbf{C}_e \\mathbf{B} \\mathbf{d}_e \\, \\mathrm{d}\\Omega = \\sum_e \\sum_{g} \\mathbf{C}_e \\mathbf{B}(\\mathbf{x}_g) \\mathbf{d}_e \\det(\\mathbf{J}(\\mathbf{x}_g)) w_g\n$$\nwhere $\\mathbf{d}_e$ are the reconstructed nodal displacements for element $e$, and the sum is over all elements and all Gauss points $\\mathbf{x}_g$ with weights $w_g$. The program calculates the $\\bar{\\sigma}_{11}$ component of this homogenized stress tensor for each test case.\nThe cases with $v_f=0$ and $v_f=1$ correspond to homogeneous materials, for which the exact analytical solution is $\\bar{\\sigma}_{11} = \\frac{E(1-\\nu)}{(1+\\nu)(1-2\\nu)} \\bar{\\varepsilon}_{11}$. The layered composite cases also have a known analytical solution under these loading conditions, providing a robust validation for the numerical implementation.```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main solver function that orchestrates the execution for all test cases.\n    \"\"\"\n\n    def get_shape_functions(xi, eta):\n        \"\"\"\n        Returns shape functions N and their derivatives dN/d_xi, dN/d_eta for a Q4 element.\n        \"\"\"\n        N = 0.25 * np.array([\n            (1.0 - xi) * (1.0 - eta),\n            (1.0 + xi) * (1.0 - eta),\n            (1.0 + xi) * (1.0 + eta),\n            (1.0 - xi) * (1.0 + eta)\n        ])\n        dN_dxi = 0.25 * np.array([\n            -(1.0 - eta),\n            (1.0 - eta),\n            (1.0 + eta),\n            -(1.0 + eta)\n        ])\n        dN_deta = 0.25 * np.array([\n            -(1.0 - xi),\n            -(1.0 + xi),\n            (1.0 + xi),\n            (1.0 - xi)\n        ])\n        return N, dN_dxi, dN_deta\n\n    def get_constitutive_matrix(E, nu):\n        \"\"\"\n        Returns the plane strain constitutive matrix C in Voigt notation.\n        \"\"\"\n        lam = (nu * E) / ((1.0 + nu) * (1.0 - 2.0 * nu))\n        mu = E / (2.0 * (1.0 + nu))\n        \n        C = np.array([\n            [lam + 2.0 * mu, lam, 0.0],\n            [lam, lam + 2.0 * mu, 0.0],\n            [0.0, 0.0, mu]\n        ])\n        return C\n\n    def run_fem_case(E1, nu1, E2, nu2, vf, eps11_macro, Nx, Ny):\n        \"\"\"\n        Runs a single FE2 micro-scale simulation for a given test case.\n        \"\"\"\n        # --- Setup FEM Parameters ---\n        num_nodes_x = Nx + 1\n        num_nodes_y = Ny + 1\n        total_nodes = num_nodes_x * num_nodes_y\n        total_dofs = 2 * total_nodes\n        gauss_points = np.array([-1.0 / np.sqrt(3.0), 1.0 / np.sqrt(3.0)])\n\n        # 1. DOF mapping for independent (master) DOFs\n        # Independent nodes are (i,j) for 0 = i  Nx, 0 = j  Ny\n        num_independent_nodes = Nx * Ny\n        num_reduced_dofs = 2 * num_independent_nodes - 2\n        \n        dof_map = -np.ones((Nx, Ny, 2), dtype=int)\n        dof_counter = 0\n        for j in range(Ny):\n            for i in range(Nx):\n                if i == 0 and j == 0:\n                    continue  # Node (0,0) is fixed\n                dof_map[i, j, 0] = dof_counter\n                dof_counter += 1\n                dof_map[i, j, 1] = dof_counter\n                dof_counter += 1\n\n        # 2. Assembly of reduced system K*d=F\n        K_reduced = np.zeros((num_reduced_dofs, num_reduced_dofs))\n        F_reduced = np.zeros(num_reduced_dofs)\n\n        # Element loop\n        for ey in range(Ny):\n            for ex in range(Nx):\n                node_coords_idx = [\n                    (ex, ey), (ex + 1, ey), (ex + 1, ey + 1), (ex, ey + 1)\n                ]\n                elem_coords = np.array(node_coords_idx, dtype=float)\n                elem_coords[:, 0] /= Nx\n                elem_coords[:, 1] /= Ny\n                \n                centroid_x = (ex + 0.5) / Nx\n                C = get_constitutive_matrix(E1, nu1) if centroid_x  vf else get_constitutive_matrix(E2, nu2)\n\n                Ke = np.zeros((8, 8))\n                for gp_eta in gauss_points:\n                    for gp_xi in gauss_points:\n                        _, dN_dxi, dN_deta = get_shape_functions(gp_xi, gp_eta)\n                        \n                        J = np.array([dN_dxi, dN_deta]) @ elem_coords\n                        detJ = np.linalg.det(J)\n                        invJ = np.linalg.inv(J)\n                        dN_dx_dy = invJ @ np.array([dN_dxi, dN_deta])\n                        \n                        B = np.zeros((3, 8))\n                        for i in range(4):\n                            B[0, 2*i] = dN_dx_dy[0, i]\n                            B[1, 2*i+1] = dN_dx_dy[1, i]\n                            B[2, 2*i] = dN_dx_dy[1, i]\n                            B[2, 2*i+1] = dN_dx_dy[0, i]\n                        Ke += B.T @ C @ B * detJ\n                \n                master_dof_indices = -np.ones(8, dtype=int)\n                g_jumps = np.zeros(8)\n                \n                for i_node in range(4):\n                    i, j = node_coords_idx[i_node]\n                    mi, mj = i % Nx, j % Ny\n                    \n                    jump_x = eps11_macro if i == Nx else 0.0\n                    jump_y = 0.0 # No jump in y-dir for this loading\n                    \n                    if mi == 0 and mj == 0:\n                        master_dof_indices[2*i_node:2*i_node+2] = -1\n                    else:\n                        master_dof_indices[2*i_node] = dof_map[mi, mj, 0]\n                        master_dof_indices[2*i_node+1] = dof_map[mi, mj, 1]\n\n                    g_jumps[2*i_node] = jump_x\n                    g_jumps[2*i_node+1] = jump_y\n\n                for i_dof in range(8):\n                    ri = master_dof_indices[i_dof]\n                    if ri == -1: continue\n                    \n                    for j_dof in range(8):\n                        rj = master_dof_indices[j_dof]\n                        F_reduced[ri] -= Ke[i_dof, j_dof] * g_jumps[j_dof]\n                        if rj != -1:\n                            K_reduced[ri, rj] += Ke[i_dof, j_dof]\n\n        # 3. Solve the system\n        d_reduced = np.linalg.solve(K_reduced, F_reduced)\n        \n        # 4. Reconstruct full displacement field\n        d_full = np.zeros(total_dofs)\n        for j in range(num_nodes_y):\n            for i in range(num_nodes_x):\n                node_idx = j * num_nodes_x + i\n                mi, mj = i % Nx, j % Ny\n                jump_x = eps11_macro if i == Nx else 0.0\n                jump_y = 0.0\n                \n                if mi == 0 and mj == 0:\n                    ux_master, uy_master = 0.0, 0.0\n                else:\n                    idx_x, idx_y = dof_map[mi, mj, 0], dof_map[mi, mj, 1]\n                    ux_master, uy_master = d_reduced[idx_x], d_reduced[idx_y]\n\n                d_full[2 * node_idx] = ux_master + jump_x\n                d_full[2 * node_idx + 1] = uy_master + jump_y\n\n        # 5. Post-processing: Compute homogenized stress\n        avg_stress = np.zeros(3)\n        for ey in range(Ny):\n            for ex in range(Nx):\n                node_coords_idx = [\n                    (ex, ey), (ex + 1, ey), (ex + 1, ey + 1), (ex, ey + 1)\n                ]\n                elem_coords = np.array(node_coords_idx, dtype=float)\n                elem_coords[:, 0] /= Nx\n                elem_coords[:, 1] /= Ny\n                \n                centroid_x = (ex + 0.5) / Nx\n                C = get_constitutive_matrix(E1, nu1) if centroid_x  vf else get_constitutive_matrix(E2, nu2)\n\n                elem_dofs = np.zeros(8)\n                for i_node in range(4):\n                    i, j = node_coords_idx[i_node]\n                    node_idx = j * num_nodes_x + i\n                    elem_dofs[2*i_node:2*i_node+2] = d_full[2*node_idx:2*node_idx+2]\n                    \n                for gp_eta in gauss_points:\n                    for gp_xi in gauss_points:\n                        _, dN_dxi, dN_deta = get_shape_functions(gp_xi, gp_eta)\n                        J = np.array([dN_dxi, dN_deta]) @ elem_coords\n                        detJ = np.linalg.det(J)\n                        invJ = np.linalg.inv(J)\n                        dN_dx_dy = invJ @ np.array([dN_dxi, dN_deta])\n                        \n                        B = np.zeros((3, 8))\n                        for i in range(4):\n                            B[0, 2*i] = dN_dx_dy[0, i]\n                            B[1, 2*i+1] = dN_dx_dy[1, i]\n                            B[2, 2*i] = dN_dx_dy[1, i]\n                            B[2, 2*i+1] = dN_dx_dy[0, i]\n                        \n                        avg_stress += (C @ (B @ elem_dofs)) * detJ\n        \n        return avg_stress[0]\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (200e9, 0.30, 70e9, 0.33, 0.30, 0.001),\n        (150e9, 0.28, 50e9, 0.25, 0.0, 0.001),\n        (210e9, 0.30, 5e9, 0.45, 1.0, 0.0005),\n        (100e9, 0.29, 1e9, 0.35, 0.50, 0.002),\n    ]\n\n    results = []\n    # Fixed FE discretization parameters\n    Nx, Ny = 12, 12\n\n    for case in test_cases:\n        E1, nu1, E2, nu2, vf, eps11_macro = case\n        sigma11_hom = run_fem_case(E1, nu1, E2, nu2, vf, eps11_macro, Nx, Ny)\n        results.append(f\"{sigma11_hom:.6e}\")\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nif __name__ == '__main__':\n    solve()\n```",
            "answer": "[1.553754e+08,6.000000e+07,1.413462e+08,1.351642e+08]"
        },
        {
            "introduction": "The FE² method is a fully coupled two-scale scheme where the RVE acts as a numerical constitutive model for a macroscopic analysis. This final practice closes the loop by focusing on the macro-scale problem . Using a hyperelastic constitutive response provided by an abstract RVE, you will implement a single Newton-Raphson step, assembling the macroscopic residual vector and tangent matrix from the RVE's homogenized stress, $\\bar{\\sigma}$, and consistent tangent, $\\mathbb{C}^{\\text{cons}}$. This exercise illuminates how information from the micro-scale drives the evolution of the macroscopic simulation.",
            "id": "3608362",
            "problem": "Implement a single Newton–Raphson iteration at the macroscopic scale for a two-scale computational homogenization problem with a Representative Volume Element (RVE). The macroscopic body is a one-dimensional bar discretized by a single $2$-node finite element. The microscopic scale is represented by an effective hyperelastic constitutive response derived from an RVE solution that provides a homogenized macroscopic stress and consistent tangent at any trial macroscopic strain. Your task is to derive, assemble, and program one macroscopic Newton step that updates the macroscopic strain and to apply it to a provided test suite.\n\nStart from the following fundamental base in computational solid mechanics:\n- Balance of linear momentum in weak form: the internal virtual work equals the external virtual work for all admissible virtual displacements.\n- The finite element discretization of the bar with $2$ nodes uses linear shape functions, leading to a constant strain within the element. Let the shape function derivatives form the matrix $B$, so that $ \\bar{\\epsilon} = B \\, u $, where $u$ is the vector of nodal displacements, and $ \\bar{\\epsilon} $ is the macroscopic Green–Lagrange strain under the small-strain assumption (i.e., $ \\bar{\\epsilon} $ is the infinitesimal strain).\n- The macroscopic stress is the RVE-homogenized Cauchy stress $ \\bar{\\sigma} $ satisfying the micro-to-macro energy consistency (Hill–Mandel condition), and the macroscopic consistent tangent is $ \\mathbb{C}^{\\text{cons}} = \\dfrac{\\partial \\bar{\\sigma}}{\\partial \\bar{\\epsilon}} $ provided by the RVE solution at the current macroscopic strain.\n- The Newton–Raphson method linearizes the residual about the current iterate $u^{(k)}$ and solves for the increment $\\Delta u^{(k)}$ from the linearized system, updating $u^{(k+1)} = u^{(k)} + \\Delta u^{(k)}$.\n\nMicroscale RVE closure provided for this problem:\n- The RVE effective stored energy density is $ W(\\bar{\\epsilon}) = \\dfrac{1}{2} E \\, \\bar{\\epsilon}^{2} + \\dfrac{1}{4} \\alpha \\, \\bar{\\epsilon}^{4} $, where $E$ and $\\alpha$ are material parameters. This defines the homogenized stress and consistent tangent by $ \\bar{\\sigma}(\\bar{\\epsilon}) = \\dfrac{\\mathrm{d} W}{\\mathrm{d} \\bar{\\epsilon}} $ and $ \\mathbb{C}^{\\text{cons}}(\\bar{\\epsilon}) = \\dfrac{\\mathrm{d} \\bar{\\sigma}}{\\mathrm{d} \\bar{\\epsilon}} $. These are the micro-scale outputs you must use to assemble the macroscopic residual and tangent.\n\nMacroscopic model and loading:\n- A single $2$-node bar element of length $L$ and cross-sectional area $A$ is subjected to a prescribed axial traction $T$ at the right end ($x=L$) and a displacement boundary condition $u(0)=0$ at the left end ($x=0$). The bar is aligned with the $x$-axis.\n- Use the small-strain kinematics in one dimension. The element strain is constant and equal to $ \\bar{\\epsilon} = \\dfrac{u_{2}-u_{1}}{L} $ with $u_{1}$ and $u_{2}$ the nodal displacements at $x=0$ and $x=L$. The initial iterate is $u_{1}^{(0)}=0$ and $u_{2}^{(0)}$ given per test case.\n\nAssembly requirements for one Newton step:\n- Assemble the macroscopic residual vector $R(u)$ using the RVE-provided $ \\bar{\\sigma} $ evaluated at the current iterate’s macroscopic strain. Express the internal force as the element integral of $ B^{\\mathsf{T}} \\bar{\\sigma} A $ and subtract the external nodal forces, which represent the traction $T$ at the right node.\n- Assemble the macroscopic tangent matrix $K(u)$ using the RVE-provided consistent tangent $ \\mathbb{C}^{\\text{cons}} $ evaluated at the current iterate’s macroscopic strain, via the element integral of $ B^{\\mathsf{T}} \\mathbb{C}^{\\text{cons}} B \\, A $.\n- Impose the essential boundary condition $u_{1}=0$ by reduction to the free degree of freedom $u_{2}$, solve the linearized equation for the increment $\\Delta u_{2}$, and update $u_{2}^{(1)} = u_{2}^{(0)} + \\Delta u_{2}$.\n- Report the updated macroscopic strain after the single Newton step as $ \\bar{\\epsilon}^{(1)} = \\dfrac{u_{2}^{(1)} - 0}{L} $.\n\nPhysical units:\n- Use the International System of Units. Length $L$ in meters ($\\mathrm{m}$), area $A$ in square meters ($\\mathrm{m}^{2}$), modulus $E$ and parameter $\\alpha$ in pascals ($\\mathrm{Pa}$), traction $T$ in newtons ($\\mathrm{N}$), displacement $u$ in meters ($\\mathrm{m}$), stress $ \\bar{\\sigma} $ in pascals ($\\mathrm{Pa}$), and strain $ \\bar{\\epsilon} $ is dimensionless. Express the requested final strains as dimensionless floating-point numbers.\n\nTest suite:\n- Case $1$: $E = 70\\times 10^{9}~\\mathrm{Pa}$, $\\alpha = 5\\times 10^{11}~\\mathrm{Pa}$, $A = 5\\times 10^{-4}~\\mathrm{m}^{2}$, $L = 2.0~\\mathrm{m}$, $T = 5.0\\times 10^{5}~\\mathrm{N}$, $u_{2}^{(0)} = 0.0~\\mathrm{m}$.\n- Case $2$: $E = 210\\times 10^{9}~\\mathrm{Pa}$, $\\alpha = 0~\\mathrm{Pa}$, $A = 1\\times 10^{-4}~\\mathrm{m}^{2}$, $L = 1.0~\\mathrm{m}$, $T = 0~\\mathrm{N}$, $u_{2}^{(0)} = 1\\times 10^{-4}~\\mathrm{m}$.\n- Case $3$: $E = 1\\times 10^{8}~\\mathrm{Pa}$, $\\alpha = 1\\times 10^{10}~\\mathrm{Pa}$, $A = 1\\times 10^{-3}~\\mathrm{m}^{2}$, $L = 0.5~\\mathrm{m}$, $T = 2\\times 10^{4}~\\mathrm{N}$, $u_{2}^{(0)} = -1\\times 10^{-3}~\\mathrm{m}$.\n\nRequired program output:\n- For each test case, compute the updated macroscopic strain $ \\bar{\\epsilon}^{(1)} $ after exactly one Newton step as described, and return the results in the order of the cases as a single line string containing a Python-style list of floats, with no extra text, for example, $[\\text{e1},\\text{e2},\\text{e3}]$.\n\nYour program must be a complete, runnable implementation that uses only the provided test suite and prints exactly one line in the specified format. No user input should be read. All numeric outputs must be in dimensionless form as described.",
            "solution": "The problem requires the implementation of a single Newton-Raphson iteration for a macroscopic one-dimensional bar modeled by a single finite element. The constitutive response is not given by a standard material law but is instead provided by a homogenized effective response from a Representative Volume Element (RVE), a key concept in two-scale computational homogenization.\n\nThe derivation proceeds from the fundamental principles of the finite element method and the Newton-Raphson algorithm, applied to the specific macroscopic problem setup.\n\n**1. Finite Element Kinematics**\n\nThe macroscopic body is a one-dimensional bar of length $L$ and constant cross-sectional area $A$. It is discretized using a single $2$-node linear finite element. The nodal displacements are denoted by the vector $u = [u_1, u_2]^{\\mathsf{T}}$, where $u_1$ is the displacement at $x=0$ and $u_2$ is the displacement at $x=L$.\n\nUnder the assumption of small-strain kinematics, the axial strain $\\bar{\\epsilon}$ is constant throughout the element. It is related to the nodal displacements via the strain-displacement matrix $B$:\n$$\n\\bar{\\epsilon} = \\frac{u_2 - u_1}{L}\n$$\nThis can be written in matrix form as $\\bar{\\epsilon} = B u$, where the matrix $B$ for this element is:\n$$\nB = \\begin{bmatrix} -1/L  1/L \\end{bmatrix}\n$$\n\n**2. Homogenized Constitutive Law from RVE**\n\nThe problem provides the effective constitutive behavior derived from an RVE. The effective stored energy density $W$ is a function of the macroscopic strain $\\bar{\\epsilon}$:\n$$\nW(\\bar{\\epsilon}) = \\frac{1}{2} E \\bar{\\epsilon}^{2} + \\frac{1}{4} \\alpha \\bar{\\epsilon}^{4}\n$$\nwhere $E$ and $\\alpha$ are material parameters obtained from the homogenization procedure.\n\nThe macroscopic Cauchy stress $\\bar{\\sigma}$ (in the axial direction) is derived as the derivative of the stored energy density with respect to the macroscopic strain:\n$$\n\\bar{\\sigma}(\\bar{\\epsilon}) = \\frac{\\mathrm{d}W}{\\mathrm{d}\\bar{\\epsilon}} = E \\bar{\\epsilon} + \\alpha \\bar{\\epsilon}^{3}\n$$\nThe macroscopic consistent tangent modulus $\\mathbb{C}^{\\text{cons}}$ is the derivative of the stress with respect to strain, which is essential for the quadratic convergence of the Newton-Raphson method:\n$$\n\\mathbb{C}^{\\text{cons}}(\\bar{\\epsilon}) = \\frac{\\mathrm{d}\\bar{\\sigma}}{\\mathrm{d}\\bar{\\epsilon}} = E + 3 \\alpha \\bar{\\epsilon}^{2}\n$$\nThese expressions define the RVE's contribution to the macroscopic calculation. At each macroscopic integration point (in this case, one point for the entire element), one would conceptually solve the RVE problem to obtain $\\bar{\\sigma}$ and $\\mathbb{C}^{\\text{cons}}$; here, these relations are given analytically.\n\n**3. Newton-Raphson Formulation at the Macroscopic Scale**\n\nThe Newton-Raphson method iteratively solves the nonlinear system of equations arising from the weak form of the balance of linear momentum, $R(u) = 0$, where $R(u)$ is the residual vector. For an iterate $u^{(k)}$, the method solves the linearized system for a displacement increment $\\Delta u^{(k)}$:\n$$\nK(u^{(k)}) \\Delta u^{(k)} = -R(u^{(k)})\n$$\nThe tangent stiffness matrix is $K(u) = \\frac{\\partial R(u)}{\\partial u}$. The solution is then updated: $u^{(k+1)} = u^{(k)} + \\Delta u^{(k)}$.\n\nThe residual vector $R(u)$ is the difference between the internal forces $F_{\\text{int}}$ and the external forces $F_{\\text{ext}}$:\n$$\nR(u) = F_{\\text{int}}(u) - F_{\\text{ext}}\n$$\n\nThe internal force vector is assembled by integrating the stress over the element volume $V$:\n$$\nF_{\\text{int}}(u) = \\int_{V} B^{\\mathsf{T}} \\bar{\\sigma} \\, \\mathrm{d}V\n$$\nSince $B$ and $\\bar{\\sigma}$ are constant over the element, the integral simplifies to $V B^{\\mathsf{T}} \\bar{\\sigma}$, where $V = A L$:\n$$\nF_{\\text{int}}(u) = A L \\begin{pmatrix} -1/L \\\\ 1/L \\end{pmatrix} \\bar{\\sigma} = \\begin{pmatrix} -A \\bar{\\sigma} \\\\ A \\bar{\\sigma} \\end{pmatrix}\n$$\n\nThe external force vector $F_{\\text{ext}}$ arises from the prescribed traction $T$ at the right end ($x=L$, node $2$):\n$$\nF_{\\text{ext}} = \\begin{pmatrix} 0 \\\\ T \\end{pmatrix}\n$$\n\nCombining these, the residual vector is:\n$$\nR(u) = \\begin{pmatrix} -A \\bar{\\sigma} \\\\ A \\bar{\\sigma} - T \\end{pmatrix}\n$$\n\nThe tangent stiffness matrix $K(u)$ is assembled by integrating the consistent tangent modulus:\n$$\nK(u) = \\int_{V} B^{\\mathsf{T}} \\mathbb{C}^{\\text{cons}} B \\, \\mathrm{d}V\n$$\nAgain, since all quantities are constant, this simplifies to $V B^{\\mathsf{T}} \\mathbb{C}^{\\text{cons}} B$:\n$$\nK(u) = A L \\begin{pmatrix} -1/L \\\\ 1/L \\end{pmatrix} \\mathbb{C}^{\\text{cons}} \\begin{bmatrix} -1/L  1/L \\end{bmatrix} = A L \\frac{\\mathbb{C}^{\\text{cons}}}{L^2} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix} = \\frac{A \\mathbb{C}^{\\text{cons}}}{L} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix}\n$$\n\n**4. System Reduction and Solution for a Single Iteration**\n\nWe start from an initial guess $u^{(0)} = [u_1^{(0)}, u_2^{(0)}]^{\\mathsf{T}}$. The problem specifies the boundary condition $u(0)=0$, which implies $u_1=0$. This essential boundary condition is imposed by setting $u_1^{(k)}=0$ for all iterations $k$, and thus the increment $\\Delta u_1^{(k)}$ must also be $0$.\n\nThe full linear system at iteration $k=0$ is:\n$$\n\\frac{A \\mathbb{C}^{\\text{cons},(0)}}{L} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix} \\begin{pmatrix} \\Delta u_1^{(0)} \\\\ \\Delta u_2^{(0)} \\end{pmatrix} = - \\begin{pmatrix} -A \\bar{\\sigma}^{(0)} \\\\ A \\bar{\\sigma}^{(0)} - T \\end{pmatrix}\n$$\nwhere $\\bar{\\epsilon}^{(0)} = (u_2^{(0)} - u_1^{(0)})/L$, $\\bar{\\sigma}^{(0)} = \\bar{\\sigma}(\\bar{\\epsilon}^{(0)})$, and $\\mathbb{C}^{\\text{cons},(0)} = \\mathbb{C}^{\\text{cons}}(\\bar{\\epsilon}^{(0)})$.\n\nWe reduce the system to the free degree of freedom, $u_2$. From the second row of the matrix equation, with $\\Delta u_1^{(0)}=0$:\n$$\n\\frac{A \\mathbb{C}^{\\text{cons},(0)}}{L} ( -1 \\cdot \\Delta u_1^{(0)} + 1 \\cdot \\Delta u_2^{(0)} ) = -(A \\bar{\\sigma}^{(0)} - T)\n$$\n$$\n\\frac{A \\mathbb{C}^{\\text{cons},(0)}}{L} \\Delta u_2^{(0)} = T - A \\bar{\\sigma}^{(0)}\n$$\nSolving for the displacement increment $\\Delta u_2^{(0)}$:\n$$\n\\Delta u_2^{(0)} = \\frac{L}{A \\mathbb{C}^{\\text{cons},(0)}} (T - A \\bar{\\sigma}^{(0)})\n$$\nThe updated displacement at node $2$ is $u_2^{(1)} = u_2^{(0)} + \\Delta u_2^{(0)}$.\n\nThe quantity of interest is the updated macroscopic strain, $\\bar{\\epsilon}^{(1)}$:\n$$\n\\bar{\\epsilon}^{(1)} = \\frac{u_2^{(1)} - u_1^{(1)}}{L} = \\frac{u_2^{(0)} + \\Delta u_2^{(0)}}{L} = \\bar{\\epsilon}^{(0)} + \\frac{\\Delta u_2^{(0)}}{L}\n$$\nSubstituting the expression for $\\Delta u_2^{(0)}$:\n$$\n\\bar{\\epsilon}^{(1)} = \\bar{\\epsilon}^{(0)} + \\frac{1}{L} \\left( \\frac{L}{A \\mathbb{C}^{\\text{cons},(0)}} (T - A \\bar{\\sigma}^{(0)}) \\right) = \\bar{\\epsilon}^{(0)} + \\frac{T - A \\bar{\\sigma}^{(0)}}{A \\mathbb{C}^{\\text{cons},(0)}}\n$$\nThis leads to a more direct update formula in terms of strain. Let $\\bar{T} = T/A$ be the prescribed macroscopic stress (traction). Then the strain increment is:\n$$\n\\Delta \\bar{\\epsilon}^{(0)} = \\frac{\\bar{T} - \\bar{\\sigma}^{(0)}}{\\mathbb{C}^{\\text{cons},(0)}}\n$$\nAnd the updated strain is:\n$$\n\\bar{\\epsilon}^{(1)} = \\bar{\\epsilon}^{(0)} + \\Delta \\bar{\\epsilon}^{(0)}\n$$\n\n**5. Algorithm Summary**\n\nFor each test case with parameters $(E, \\alpha, A, L, T, u_2^{(0)})$:\n1. Calculate the initial macroscopic strain at iteration $k=0$: $\\bar{\\epsilon}^{(0)} = u_2^{(0)}/L$ (since $u_1^{(0)}=0$).\n2. Evaluate the homogenized stress at this strain: $\\bar{\\sigma}^{(0)} = E \\bar{\\epsilon}^{(0)} + \\alpha (\\bar{\\epsilon}^{(0)})^3$.\n3. Evaluate the homogenized consistent tangent at this strain: $\\mathbb{C}^{\\text{cons},(0)} = E + 3 \\alpha (\\bar{\\epsilon}^{(0)})^2$.\n4. Calculate the macroscopic stress equivalent of the applied traction: $\\bar{T} = T/A$.\n5. Calculate the strain increment: $\\Delta\\bar{\\epsilon}^{(0)} = (\\bar{T} - \\bar{\\sigma}^{(0)}) / \\mathbb{C}^{\\text{cons},(0)}$.\n6. Compute the updated strain after one Newton step: $\\bar{\\epsilon}^{(1)} = \\bar{\\epsilon}^{(0)} + \\Delta\\bar{\\epsilon}^{(0)}$.\nThis value, $\\bar{\\epsilon}^{(1)}$, is the final result for the test case.",
            "answer": "[0.014285714285714285, 0.0, 0.19975864962045544]"
        }
    ]
}