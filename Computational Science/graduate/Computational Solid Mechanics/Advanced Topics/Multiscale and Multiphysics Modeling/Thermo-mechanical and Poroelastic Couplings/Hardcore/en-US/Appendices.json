{
    "hands_on_practices": [
        {
            "introduction": "Understanding how porous materials like soil, rock, or biological tissues respond to loads involves accounting for the interaction between the solid skeleton and the fluid within its pores. This practice delves into the fundamental phenomenon of poroelastic consolidation, which governs the time-dependent settlement of a saturated porous layer as excess pore fluid pressure dissipates. By deriving the governing one-dimensional diffusion equation from first principles, you will gain a foundational understanding of how fluid flow and solid mechanics are coupled and how to determine the characteristic time scale of this process .",
            "id": "3606377",
            "problem": "A fully saturated, homogeneous and isotropic poroelastic layer of thickness $H$ is bounded by perfectly drained surfaces at $z=0$ and $z=H$. At time $t=0^{+}$, the layer has a spatially uniform excess pore pressure $p(z,0)=p_{0}$ (with no subsequent external mechanical loading applied for $t>0$). Assume small strains, quasi-static momentum balance, constant properties, and negligible gravity acting on the excess pore pressure. Start from fluid mass conservation, Darcy’s law, and the linear poroelastic constitutive relation linking fluid content to pore pressure and volumetric strain. Under the assumption that the drained bulk modulus of the solid skeleton is sufficiently large and the Biot coefficient is close to unity so that the contribution of skeleton volumetric strain to storage is negligible compared to fluid storage, reduce the governing equation to a one-dimensional diffusion equation for $p(z,t)$ with a hydraulic diffusivity expressed in terms of the intrinsic permeability $k$, the dynamic viscosity of the pore fluid $\\mu$, and the Biot modulus $M$.\n\nUsing separation of variables and the fact that both boundaries are held at zero excess pore pressure for $t>0$, obtain the dominant (slowest) decay time constant and define the consolidation time scale $t_{c}$ as that dominant e-folding time. Express $t_{c}$ in closed form in terms of $H$, $k$, $\\mu$, and $M$.\n\nThen, evaluate $t_{c}$ numerically for the parameters $H=10\\,\\mathrm{m}$, $k=1.0\\times 10^{-20}\\,\\mathrm{m}^{2}$, $\\mu=1.0\\times 10^{-3}\\,\\mathrm{Pa\\cdot s}$, and $M=5.0\\times 10^{9}\\,\\mathrm{Pa}$. Express the final time in years using $1\\,\\mathrm{year}=365\\,\\mathrm{days}$ and round your answer to three significant figures. Your final answer must be a single real number representing the time in years.",
            "solution": "The problem requires the derivation and solution of a one-dimensional poroelastic consolidation problem to find the dominant consolidation time scale. The process involves several steps: derivation of the governing partial differential equation (PDE), solving the PDE using separation of variables, identifying the dominant decay time, and finally, numerical evaluation.\n\nFirst, we establish the governing equation. The problem starts from the principle of fluid mass conservation in a porous medium, which can be written as:\n$$\n\\frac{\\partial \\zeta}{\\partial t} + \\nabla \\cdot \\mathbf{q} = 0\n$$\nHere, $\\zeta$ is the variation of fluid content per unit bulk volume, and $\\mathbf{q}$ is the specific discharge vector of the fluid relative to the solid skeleton.\n\nDarcy's law relates the specific discharge to the gradient of the excess pore fluid pressure, $p$. Neglecting gravity effects on the excess pressure as stated, this relationship is:\n$$\n\\mathbf{q} = -\\frac{k}{\\mu} \\nabla p\n$$\nwhere $k$ is the intrinsic permeability of the porous medium and $\\mu$ is the dynamic viscosity of the pore fluid.\n\nThe constitutive relation for the variation of fluid content in linear poroelasticity is given by:\n$$\n\\zeta = \\frac{p}{M} + \\alpha \\epsilon_v\n$$\nwhere $M$ is the Biot modulus, $\\alpha$ is the Biot coefficient, and $\\epsilon_v = \\nabla \\cdot \\mathbf{u}$ is the volumetric strain of the solid skeleton, with $\\mathbf{u}$ being the displacement vector of the solid.\n\nThe problem states a crucial simplification: \"the contribution of skeleton volumetric strain to storage is negligible compared to fluid storage\". This allows us to approximate the fluid content variation as:\n$$\n\\zeta \\approx \\frac{p}{M}\n$$\nThis is a standard assumption for materials where the solid matrix is much stiffer than the fluid, or more accurately, when the compressibility of the fluid in the pores dominates the storage capacity.\n\nSubstituting Darcy's law and the simplified constitutive relation for $\\zeta$ into the fluid mass conservation equation gives:\n$$\n\\frac{\\partial}{\\partial t} \\left(\\frac{p}{M}\\right) + \\nabla \\cdot \\left(-\\frac{k}{\\mu} \\nabla p\\right) = 0\n$$\nAssuming the properties $M$, $k$, and $\\mu$ are constant and uniform as stated, we can pull them out of the derivatives:\n$$\n\\frac{1}{M} \\frac{\\partial p}{\\partial t} - \\frac{k}{\\mu} \\nabla^2 p = 0\n$$\nRearranging this equation gives the diffusion equation for pore pressure:\n$$\n\\frac{\\partial p}{\\partial t} = \\frac{kM}{\\mu} \\nabla^2 p\n$$\nFor the one-dimensional problem considered, where pressure varies only in the $z$-direction, this simplifies to:\n$$\n\\frac{\\partial p}{\\partial t} = c \\frac{\\partial^2 p}{\\partial z^2}\n$$\nwhere the hydraulic diffusivity, $c$, is defined as:\n$$\nc = \\frac{kM}{\\mu}\n$$\n\nNext, we solve this PDE subject to the given boundary and initial conditions.\nThe PDE is $\\frac{\\partial p}{\\partial t} = c \\frac{\\partial^2 p}{\\partial z^2}$ for $z \\in (0, H)$ and $t > 0$.\nThe boundary conditions (BCs) are for perfectly drained surfaces: $p(0, t) = 0$ and $p(H, t) = 0$ for $t > 0$.\nThe initial condition (IC) is a uniform excess pore pressure: $p(z, 0) = p_0$ for $z \\in (0, H)$.\n\nWe use the method of separation of variables, assuming a solution of the form $p(z, t) = Z(z)T(t)$. Substituting this into the PDE yields:\n$$\nZ(z)T'(t) = c Z''(z)T(t) \\implies \\frac{T'(t)}{cT(t)} = \\frac{Z''(z)}{Z(z)} = -\\lambda^2\n$$\nwhere $-\\lambda^2$ is the separation constant. This gives two ordinary differential equations:\n1. Spatial part: $Z''(z) + \\lambda^2 Z(z) = 0$\n2. Temporal part: $T'(t) + c\\lambda^2 T(t) = 0$\n\nThe general solution for $Z(z)$ is $Z(z) = A\\sin(\\lambda z) + B\\cos(\\lambda z)$. Applying the BCs:\n$Z(0) = 0 \\implies B = 0$.\n$Z(H) = 0 \\implies A\\sin(\\lambda H) = 0$. For a non-trivial solution ($A \\neq 0$), we must have $\\lambda H = n\\pi$ for $n = 1, 2, 3, \\dots$.\nThe eigenvalues are $\\lambda_n = \\frac{n\\pi}{H}$, and the corresponding eigenfunctions are $Z_n(z) = \\sin\\left(\\frac{n\\pi z}{H}\\right)$.\n\nThe solution for the temporal part for each mode $n$ is $T_n(t) = C_n \\exp(-c\\lambda_n^2 t)$.\nThe general solution for $p(z,t)$ is a superposition of these modes:\n$$\np(z,t) = \\sum_{n=1}^{\\infty} B_n \\sin\\left(\\frac{n\\pi z}{H}\\right) \\exp\\left(-c \\left(\\frac{n\\pi}{H}\\right)^2 t\\right)\n$$\nwhere $B_n$ are constants determined by the initial condition. At $t=0$:\n$$\np(z,0) = p_0 = \\sum_{n=1}^{\\infty} B_n \\sin\\left(\\frac{n\\pi z}{H}\\right)\n$$\nThis is the Fourier sine series of the constant function $p_0$. The coefficients $B_n$ are given by:\n$$\nB_n = \\frac{2}{H} \\int_0^H p_0 \\sin\\left(\\frac{n\\pi z}{H}\\right) dz = \\frac{2p_0}{H} \\left[-\\frac{H}{n\\pi}\\cos\\left(\\frac{n\\pi z}{H}\\right)\\right]_0^H = \\frac{2p_0}{n\\pi} (1 - \\cos(n\\pi))\n$$\nSince $\\cos(n\\pi) = (-1)^n$, the coefficients are $B_n = 0$ for even $n$, and $B_n = \\frac{4p_0}{n\\pi}$ for odd $n$.\n\nThe decay of each mode in the series is governed by the term $\\exp(-t/\\tau_n)$, where the time constant $\\tau_n$ for the $n$-th mode is:\n$$\n\\tau_n = \\frac{1}{c\\lambda_n^2} = \\frac{1}{c \\left(\\frac{n\\pi}{H}\\right)^2} = \\frac{H^2}{c n^2 \\pi^2}\n$$\nThe dominant (slowest) decay time corresponds to the largest time constant, which occurs for the smallest value of $n$, i.e., $n=1$. The problem defines the consolidation time scale $t_c$ as this dominant e-folding time.\n$$\nt_c = \\tau_1 = \\frac{H^2}{c \\pi^2}\n$$\nSubstituting the expression for the diffusivity $c = \\frac{kM}{\\mu}$:\n$$\nt_c = \\frac{H^2}{\\left(\\frac{kM}{\\mu}\\right) \\pi^2} = \\frac{\\mu H^2}{\\pi^2 k M}\n$$\nThis is the closed-form expression for the consolidation time scale.\n\nFinally, we evaluate $t_c$ numerically using the given parameters:\n$H = 10\\,\\mathrm{m}$\n$k = 1.0 \\times 10^{-20}\\,\\mathrm{m}^2$\n$\\mu = 1.0 \\times 10^{-3}\\,\\mathrm{Pa \\cdot s}$\n$M = 5.0 \\times 10^{9}\\,\\mathrm{Pa}$\n\n$$\nt_c = \\frac{(1.0 \\times 10^{-3}\\,\\mathrm{Pa \\cdot s})(10\\,\\mathrm{m})^2}{\\pi^2 (1.0 \\times 10^{-20}\\,\\mathrm{m}^2)(5.0 \\times 10^{9}\\,\\mathrm{Pa})}\n$$\n$$\nt_c = \\frac{1.0 \\times 10^{-3} \\times 100}{\\pi^2 \\times (1.0 \\times 10^{-20}) \\times (5.0 \\times 10^9)} \\,\\mathrm{s} = \\frac{1.0 \\times 10^{-1}}{5.0 \\pi^2 \\times 10^{-11}} \\,\\mathrm{s} = \\frac{1 \\times 10^{10}}{5 \\pi^2} \\,\\mathrm{s}\n$$\nCalculating the value in seconds:\n$$\nt_c \\approx \\frac{1 \\times 10^{10}}{5 \\times (9.8696044)} \\,\\mathrm{s} \\approx \\frac{1 \\times 10^{10}}{49.348022} \\,\\mathrm{s} \\approx 2.02642 \\times 10^8 \\,\\mathrm{s}\n$$\nTo convert this to years, we use the conversion $1\\,\\mathrm{year} = 365\\,\\mathrm{days} \\times 24\\,\\mathrm{hours/day} \\times 3600\\,\\mathrm{s/hour} = 31,536,000\\,\\mathrm{s}$.\n$$\nt_c (\\mathrm{years}) = \\frac{2.02642 \\times 10^8 \\,\\mathrm{s}}{3.1536 \\times 10^7 \\,\\mathrm{s/year}} \\approx 6.4259\\,\\mathrm{years}\n$$\nRounding to three significant figures, we get $6.43$ years.",
            "answer": "$$\\boxed{6.43}$$"
        },
        {
            "introduction": "While analytical solutions provide deep physical insight, most real-world engineering problems involving thermo-mechanical or poroelastic couplings require numerical methods like the Finite Element Method (FEM). This exercise transitions from theory to practice by guiding you through the construction of the core computational building blocks for a transient, coupled thermal analysis. You will discretize the governing heat equation in both space and time, and crucially, learn how to incorporate a source term, such as heat generated from mechanical dissipation, within a staggered solution scheme . This hands-on implementation demystifies the inner workings of FE software and reinforces the connection between the continuous weak form and the discrete algebraic equations that a computer solves.",
            "id": "3606390",
            "problem": "Consider the coupled thermo-mechanical problem in which the mechanical field is advanced first in time and provides a volumetric mechanical dissipation rate per unit volume, denoted by $\\Phi$ (with units of $\\mathrm{W/m^3}$), to the thermal field. The thermal field is governed by the transient heat equation with internal heat generation:\n$$\n\\rho c \\, \\dot{T} - \\nabla \\cdot (k \\nabla T) = r + \\Phi \\, ,\n$$\nwhere $\\rho$ is mass density in $\\mathrm{kg/m^3}$, $c$ is specific heat in $\\mathrm{J/(kg\\,K)}$, $k$ is thermal conductivity in $\\mathrm{W/(m\\,K)}$, $T$ is temperature in $\\mathrm{K}$, $r$ is an external volumetric source in $\\mathrm{W/m^3}$, and $\\Phi$ is the mechanical dissipation supplied by the mechanical step.\n\nStarting from the principle of virtual work for heat, the weak form over a domain $\\Omega$ with boundary $\\Gamma$ is:\n$$\n\\int_{\\Omega} \\rho c \\, \\dot{T} \\, \\delta T \\, \\mathrm{d} \\Omega + \\int_{\\Omega} k \\, \\nabla T \\cdot \\nabla \\delta T \\, \\mathrm{d} \\Omega = \\int_{\\Omega} (r + \\Phi) \\, \\delta T \\, \\mathrm{d} \\Omega + \\int_{\\Gamma_q} \\bar{q} \\, \\delta T \\, \\mathrm{d} \\Gamma \\, ,\n$$\nwhere $\\delta T$ is an admissible virtual temperature and $\\bar{q}$ is prescribed boundary heat flux on the Neumann part $\\Gamma_q \\subseteq \\Gamma$. Consider a one-dimensional, two-node, linear finite element of length $L_e$ and unit cross-sectional area, with standard shape functions $N_1(\\xi)$ and $N_2(\\xi)$ defined on the parent domain $\\xi \\in [-1,1]$ and $x(\\xi)$ mapped affinely to the physical element. Let the nodal temperatures at time step $n$ be collected in the vector $T^n = [T_1^n, T_2^n]^T$, and similarly at time step $n+1$ as $T^{n+1} = [T_1^{n+1}, T_2^{n+1}]^T$.\n\nUsing the $\\theta$-method for time integration for the conduction terms, with time step $\\Delta t > 0$ and parameter $\\theta \\in [0,1]$, and an algorithmic dissipation blending parameter $\\eta_{\\Phi} \\in [0,1]$ for evaluating $\\Phi$ that is supplied by the mechanical step (staggered coupling), construct the semi-discrete, element-level residual vector $R_e(T^{n+1}) \\in \\mathbb{R}^2$ such that the discrete heat balance over the element is:\n$$\nR_e(T^{n+1}) = \\frac{1}{\\Delta t} M_e (T^{n+1} - T^n) + \\theta K_e T^{n+1} + (1-\\theta) K_e T^n - f_{r,e}^{n+\\theta} - f_{\\Phi,e}^{n+\\eta_{\\Phi}} \\, ,\n$$\nwith\n$$\nM_e = \\int_{\\Omega_e} \\rho c \\, N^T N \\, \\mathrm{d}\\Omega, \\qquad K_e = \\int_{\\Omega_e} k \\, B^T B \\, \\mathrm{d}\\Omega,\n$$\nand\n$$\nf_{r,e}^{n+\\theta} = \\int_{\\Omega_e} N^T \\, r^{n+\\theta} \\, \\mathrm{d}\\Omega, \\quad r^{n+\\theta} = \\theta r^{n+1} + (1-\\theta) r^n,\n$$\n$$\nf_{\\Phi,e}^{n+\\eta_{\\Phi}} = \\int_{\\Omega_e} N^T \\, \\Phi^{n+\\eta_{\\Phi}} \\, \\mathrm{d}\\Omega, \\quad \\Phi^{n+\\eta_{\\Phi}} = \\eta_{\\Phi} \\, \\Phi^{n+1} + (1-\\eta_{\\Phi}) \\, \\Phi^n \\, ,\n$$\nwhere $N = [N_1, N_2]$ and $B = [\\partial N_1/\\partial x, \\partial N_2/\\partial x]$.\n\nYour tasks are:\n- Derive $M_e$ and $K_e$ for a one-dimensional, two-node, linear element of length $L_e$ with unit cross-sectional area, assuming constant $\\rho c$ and $k$ over the element, in terms of $L_e$, $\\rho c$, and $k$.\n- Derive the expressions for $f_{r,e}^{n+\\theta}$ and $f_{\\Phi,e}^{n+\\eta_{\\Phi}}$ for the case of constant $r$ on the element and piecewise-constant $\\Phi$ specified at two Gauss points using the standard two-point Gauss quadrature rule on $[-1,1]$ with points $\\xi_1 = -1/\\sqrt{3}$ and $\\xi_2 = +1/\\sqrt{3}$ and weights $w_1 = 1$, $w_2 = 1$. The mapping Jacobian is $J = L_e/2$.\n- Clearly state and check the units of each term in $R_e$ to show that all entries of $R_e$ have units of $\\mathrm{W}$.\n- Implement a program that, for each provided test case below, assembles $R_e(T^{n+1})$ and returns the Euclidean norm of the residual vector, $\\|R_e\\|_2$, as a floating-point number. Express the final answer in watts in $\\mathrm{W}$, rounded to six decimal places.\n- Use the following test suite of three cases. In all cases, the cross-sectional area is unity and the element is aligned with the $x$-axis. Temperatures are in $\\mathrm{K}$, length in $\\mathrm{m}$, time in $\\mathrm{s}$, thermal conductivity in $\\mathrm{W/(m\\,K)}$, volumetric heat capacity $\\rho c$ in $\\mathrm{J/(m^3\\,K)}$, sources $r$ and $\\Phi$ in $\\mathrm{W/m^3}$. The $\\Phi$ values are given at the two Gauss points and at time steps $n$ and $n+1$.\n\n- Case $1$ (general case):\n  - $L_e = 0.5$, $\\rho c = 2.5 \\times 10^6$, $k = 15$, $\\Delta t = 0.1$, $\\theta = 0.6$, $\\eta_{\\Phi} = 0.5$.\n  - $T^n = [300, 300]$, $T^{n+1} = [310, 305]$.\n  - $r^n = 1.0 \\times 10^5$, $r^{n+1} = 8.0 \\times 10^4$.\n  - $\\Phi^n$ at Gauss points: $[2.0 \\times 10^4, 3.0 \\times 10^4]$; $\\Phi^{n+1}$ at Gauss points: $[2.5 \\times 10^4, 3.5 \\times 10^4]$.\n\n- Case $2$ (zero conductivity, explicit dissipation):\n  - $L_e = 1.0$, $\\rho c = 1.0 \\times 10^6$, $k = 0.0$, $\\Delta t = 1.0$, $\\theta = 0.5$, $\\eta_{\\Phi} = 0.0$.\n  - $T^n = [300, 300]$, $T^{n+1} = [300, 300]$.\n  - $r^n = 0.0$, $r^{n+1} = 0.0$.\n  - $\\Phi^n$ at Gauss points: $[1.0 \\times 10^3, 1.0 \\times 10^3]$; $\\Phi^{n+1}$ at Gauss points: $[5.0 \\times 10^3, 5.0 \\times 10^3]$.\n\n- Case $3$ (quasi-steady conduction, no storage):\n  - $L_e = 2.0$, $\\rho c = 0.0$, $k = 10.0$, $\\Delta t = 0.5$, $\\theta = 1.0$, $\\eta_{\\Phi} = 1.0$.\n  - $T^n = [400, 300]$, $T^{n+1} = [350, 350]$.\n  - $r^n = 0.0$, $r^{n+1} = 0.0$.\n  - $\\Phi^n$ at Gauss points: $[0.0, 0.0]$; $\\Phi^{n+1}$ at Gauss points: $[0.0, 0.0]$.\n\nFinal output format requirement:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the cases above, for example $[a_1,a_2,a_3]$, where each $a_i$ is the Euclidean norm $\\|R_e\\|_2$ in $\\mathrm{W}$ for the corresponding case, rounded to six decimal places (no unit symbols in the output string).",
            "solution": "The problem requires the derivation of the finite element matrices and vectors for a one-dimensional transient heat transfer problem, followed by a dimensional analysis and the computation of the Euclidean norm of the element residual vector for three specific test cases. The problem is scientifically sound, well-posed, and provides all necessary data for a unique solution.\n\n### Derivation of Element Matrices\n\nWe consider a one-dimensional, two-node linear finite element of length $L_e$ and unit cross-sectional area $A=1 \\, \\mathrm{m^2}$. The physical coordinate $x$ is mapped from the parent coordinate $\\xi \\in [-1, 1]$ using the standard linear shape functions $N = [N_1, N_2]$, where $N_1(\\xi) = (1-\\xi)/2$ and $N_2(\\xi) = (1+\\xi)/2$. The Jacobian of the transformation is $J = \\mathrm{d}x/\\mathrm{d}\\xi = L_e/2$. The differential volume element is $\\mathrm{d}\\Omega = A \\, \\mathrm{d}x = A J \\, \\mathrm{d}\\xi$. Since $A=1$, $\\mathrm{d}\\Omega = (L_e/2) \\, \\mathrm{d}\\xi$.\n\n**1. Consistent Mass Matrix ($M_e$)**\n\nThe mass matrix is defined as $M_e = \\int_{\\Omega_e} \\rho c \\, N^T N \\, \\mathrm{d}\\Omega$. Assuming the volumetric heat capacity $\\rho c$ is constant over the element, we have:\n$$\nM_e = \\rho c \\int_{\\Omega_e} N^T N \\, \\mathrm{d}\\Omega = \\rho c A \\int_{-1}^{1} \\begin{bmatrix} N_1(\\xi) \\\\ N_2(\\xi) \\end{bmatrix} \\begin{bmatrix} N_1(\\xi) & N_2(\\xi) \\end{bmatrix} J \\, \\mathrm{d}\\xi\n$$\nSubstituting $N_1$, $N_2$, $J=L_e/2$, and $A=1$:\n$$\nM_e = \\rho c \\frac{L_e}{2} \\int_{-1}^{1} \\begin{bmatrix} N_1^2 & N_1 N_2 \\\\ N_1 N_2 & N_2^2 \\end{bmatrix} \\mathrm{d}\\xi\n$$\nThe required definite integrals are:\n$\\int_{-1}^{1} N_1^2 \\, \\mathrm{d}\\xi = \\int_{-1}^{1} \\left(\\frac{1-\\xi}{2}\\right)^2 \\mathrm{d}\\xi = \\frac{2}{3}$\n$\\int_{-1}^{1} N_2^2 \\, \\mathrm{d}\\xi = \\int_{-1}^{1} \\left(\\frac{1+\\xi}{2}\\right)^2 \\mathrm{d}\\xi = \\frac{2}{3}$\n$\\int_{-1}^{1} N_1 N_2 \\, \\mathrm{d}\\xi = \\int_{-1}^{1} \\frac{1-\\xi^2}{4} \\mathrm{d}\\xi = \\frac{1}{3}$\nSubstituting these results, we obtain the consistent mass matrix:\n$$\nM_e = \\rho c \\frac{L_e}{2} \\begin{bmatrix} 2/3 & 1/3 \\\\ 1/3 & 2/3 \\end{bmatrix} = \\frac{\\rho c L_e}{6} \\begin{bmatrix} 2 & 1 \\\\ 1 & 2 \\end{bmatrix}\n$$\n\n**2. Stiffness Matrix ($K_e$)**\n\nThe stiffness matrix is defined as $K_e = \\int_{\\Omega_e} k \\, B^T B \\, \\mathrm{d}\\Omega$, where $B = \\mathrm{d}N/\\mathrm{d}x$. The gradient of the shape functions $B$ is computed using the chain rule: $B = \\frac{\\mathrm{d}N}{\\mathrm{d}x} = \\frac{\\mathrm{d}N}{\\mathrm{d}\\xi} \\frac{\\mathrm{d}\\xi}{\\mathrm{d}x} = \\frac{1}{J} \\frac{\\mathrm{d}N}{\\mathrm{d}\\xi}$.\nWe have $\\frac{\\mathrm{d}N}{\\mathrm{d}\\xi} = [-\\frac{1}{2}, \\frac{1}{2}]$, so $B = \\frac{1}{L_e/2} [-\\frac{1}{2}, \\frac{1}{2}] = \\frac{1}{L_e} [-1, 1]$.\nThe term $B^T B$ is then:\n$B^T B = \\frac{1}{L_e^2} \\begin{bmatrix} -1 \\\\ 1 \\end{bmatrix} \\begin{bmatrix} -1 & 1 \\end{bmatrix} = \\frac{1}{L_e^2} \\begin{bmatrix} 1 & -1 \\\\ -1 & 1 \\end{bmatrix}$\nAssuming constant thermal conductivity $k$ over the element, we can evaluate the integral for $K_e$:\n$$\nK_e = k (B^T B) \\int_{\\Omega_e} \\mathrm{d}\\Omega = k \\left(\\frac{1}{L_e^2} \\begin{bmatrix} 1 & -1 \\\\ -1 & 1 \\end{bmatrix}\\right) (A L_e)\n$$\nWith $A=1$, the stiffness matrix becomes:\n$$\nK_e = \\frac{k}{L_e} \\begin{bmatrix} 1 & -1 \\\\ -1 & 1 \\end{bmatrix}\n$$\n\n### Derivation of Element Force Vectors\n\n**1. External Source Vector ($f_{r,e}^{n+\\theta}$)**\n\nThe external source vector is $f_{r,e}^{n+\\theta} = \\int_{\\Omega_e} N^T \\, r^{n+\\theta} \\, \\mathrm{d}\\Omega$. The source term $r^{n+\\theta} = \\theta r^{n+1} + (1-\\theta) r^n$ is constant over the element.\n$$\nf_{r,e}^{n+\\theta} = r^{n+\\theta} \\int_{\\Omega_e} N^T \\, \\mathrm{d}\\Omega = r^{n+\\theta} A \\int_{-1}^{1} \\begin{bmatrix} N_1(\\xi) \\\\ N_2(\\xi) \\end{bmatrix} J \\, \\mathrm{d}\\xi\n$$\nThe integrals are $\\int_{-1}^1 N_1(\\xi) \\mathrm{d}\\xi = 1$ and $\\int_{-1}^1 N_2(\\xi) \\mathrm{d}\\xi = 1$. With $A=1$ and $J=L_e/2$:\n$$\nf_{r,e}^{n+\\theta} = r^{n+\\theta} (1) \\frac{L_e}{2} \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix} = \\frac{r^{n+\\theta} L_e}{2} \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix}\n$$\n\n**2. Mechanical Dissipation Source Vector ($f_{\\Phi,e}^{n+\\eta_{\\Phi}}$)**\n\nThe dissipation vector $f_{\\Phi,e}^{n+\\eta_{\\Phi}} = \\int_{\\Omega_e} N^T \\, \\Phi^{n+\\eta_{\\Phi}} \\, \\mathrm{d}\\Omega$ is evaluated using two-point Gauss quadrature with points $\\xi_{1,2} = \\mp 1/\\sqrt{3}$ and weights $w_{1,2}=1$.\n$$\nf_{\\Phi,e}^{n+\\eta_{\\Phi}} \\approx \\sum_{i=1}^{2} N(\\xi_i)^T \\Phi^{n+\\eta_{\\Phi}}(\\xi_i) w_i A J = \\frac{A L_e}{2} \\sum_{i=1}^{2} w_i N(\\xi_i)^T \\Phi^{n+\\eta_{\\Phi}}(\\xi_i)\n$$\nLet $\\Phi_1$ and $\\Phi_2$ be the values of $\\Phi^{n+\\eta_{\\Phi}}$ at the two Gauss points. With $A=1$ and $w_{1,2}=1$:\n$$\nf_{\\Phi,e}^{n+\\eta_{\\Phi}} = \\frac{L_e}{2} \\left( N(-1/\\sqrt{3})^T \\Phi_1 + N(1/\\sqrt{3})^T \\Phi_2 \\right) = \\frac{L_e}{2} \\left( \\begin{bmatrix} N_1(-1/\\sqrt{3}) \\\\ N_2(-1/\\sqrt{3}) \\end{bmatrix} \\Phi_1 + \\begin{bmatrix} N_1(1/\\sqrt{3}) \\\\ N_2(1/\\sqrt{3}) \\end{bmatrix} \\Phi_2 \\right)\n$$\nThe shape functions evaluated at the Gauss points are:\n$N_1(-1/\\sqrt{3}) = N_2(1/\\sqrt{3}) = (1+1/\\sqrt{3})/2$\n$N_2(-1/\\sqrt{3}) = N_1(1/\\sqrt{3}) = (1-1/\\sqrt{3})/2$\nSubstituting these into the expression:\n$$\nf_{\\Phi,e}^{n+\\eta_{\\Phi}} = \\frac{L_e}{4} \\begin{bmatrix} (1+1/\\sqrt{3})\\Phi_1 + (1-1/\\sqrt{3})\\Phi_2 \\\\ (1-1/\\sqrt{3})\\Phi_1 + (1+1/\\sqrt{3})\\Phi_2 \\end{bmatrix}\n$$\n\n### Unit Analysis\n\nThe residual vector is $R_e = \\frac{1}{\\Delta t} M_e (T^{n+1} - T^n) + K_e (\\theta T^{n+1} + (1-\\theta) T^n) - f_{r,e}^{n+\\theta} - f_{\\Phi,e}^{n+\\eta_{\\Phi}}$. We verify that each component of $R_e$ has units of power ($\\mathrm{W} = \\mathrm{J/s}$).\n- Unit of $M_e$: $[\\rho c] [A] [L_e] = \\frac{\\mathrm{J}}{\\mathrm{m}^3 \\cdot \\mathrm{K}} \\cdot \\mathrm{m}^2 \\cdot \\mathrm{m} = \\frac{\\mathrm{J}}{\\mathrm{K}}$\n- Unit of $K_e$: $\\frac{[k][A]}{[L_e]} = \\frac{\\mathrm{W}}{\\mathrm{m} \\cdot \\mathrm{K}} \\frac{\\mathrm{m}^2}{\\mathrm{m}} = \\frac{\\mathrm{W}}{\\mathrm{K}} = \\frac{\\mathrm{J}}{\\mathrm{s} \\cdot \\mathrm{K}}$\n- Unit of $f_{r,e}$: $[r][A][L_e] = \\frac{\\mathrm{W}}{\\mathrm{m}^3} \\cdot \\mathrm{m}^2 \\cdot \\mathrm{m} = \\mathrm{W}$\n- Unit of $f_{\\Phi,e}$: $[\\Phi][A][L_e] = \\frac{\\mathrm{W}}{\\mathrm{m}^3} \\cdot \\mathrm{m}^2 \\cdot \\mathrm{m} = \\mathrm{W}$\n\nNow we check the terms in $R_e$:\n- Term 1: $\\frac{1}{[\\Delta t]} [M_e] [\\Delta T] = \\frac{1}{\\mathrm{s}} \\cdot \\frac{\\mathrm{J}}{\\mathrm{K}} \\cdot \\mathrm{K} = \\frac{\\mathrm{J}}{\\mathrm{s}} = \\mathrm{W}$\n- Term 2: $[K_e] [T] = \\frac{\\mathrm{W}}{\\mathrm{K}} \\cdot \\mathrm{K} = \\mathrm{W}$\n- Terms 3 & 4: $[f_{r,e}] = \\mathrm{W}$ and $[f_{\\Phi,e}] = \\mathrm{W}$\nThe units are consistent, and each entry in the residual vector $R_e$ represents a nodal power imbalance in Watts.\n\n### Computational Algorithm\n\nThe Euclidean norm of the residual vector, $\\|R_e\\|_2$, is computed for each test case by implementing the derived formulas.\n1. Define element parameters ($L_e, \\rho c, k, \\Delta t, \\theta, \\eta_{\\Phi}$), nodal temperatures ($T^n, T^{n+1}$), and source term values ($r^n, r^{n+1}, \\Phi^n, \\Phi^{n+1}$).\n2. Construct the element matrices $M_e$ and $K_e$.\n3. Assemble the thermal storage term: $\\frac{1}{\\Delta t} M_e (T^{n+1} - T^n)$.\n4. Assemble the conduction term: $\\theta K_e T^{n+1} + (1-\\theta) K_e T^n$.\n5. Compute the time-interpolated source $r^{n+\\theta}$ and assemble the force vector $f_{r,e}^{n+\\theta}$.\n6. Compute the time-interpolated dissipation values $\\Phi^{n+\\eta_{\\Phi}}$ at the Gauss points and assemble the force vector $f_{\\Phi,e}^{n+\\eta_{\\Phi}}$.\n7. Sum these terms to form the residual vector $R_e$.\n8. Calculate the Euclidean norm $\\|R_e\\|_2 = \\sqrt{R_{e,1}^2 + R_{e,2}^2}$.\n9. Round the result to six decimal places.",
            "answer": "[23093.805565,707.106781,250.000000]"
        },
        {
            "introduction": "A numerical simulation is only as reliable as its underlying code. A critical step in developing or using any finite element program is verification: ensuring the code correctly solves the mathematical equations it claims to. This practice introduces the \"patch test,\" a fundamental and powerful verification tool in computational mechanics. By examining how a thermoelastic FE formulation behaves under simple, analytically known solutions—specifically, rigid body motion and unconstrained thermal expansion—you will learn to identify the essential conditions the discrete system must satisfy to be considered a consistent and correct implementation .",
            "id": "3606438",
            "problem": "A small-strain, linear, thermoelastic body occupies a bounded domain $\\Omega \\subset \\mathbb{R}^3$ with outward unit normal $\\mathbf{n}$ on its boundary $\\partial \\Omega$. The kinematic fields are the displacement $\\mathbf{u}(\\mathbf{x})$ and the temperature $T(\\mathbf{x})$. The governing balance laws at the continuum level are: (i) the quasi-static balance of linear momentum $\\nabla \\cdot \\boldsymbol{\\sigma} + \\mathbf{b} = \\mathbf{0}$ in $\\Omega$ with $\\mathbf{t} = \\boldsymbol{\\sigma}\\mathbf{n}$ on the traction boundary $\\Gamma_t \\subset \\partial \\Omega$, and (ii) the steady energy balance (pure conduction) $-\\nabla \\cdot (\\mathbf{k}\\nabla T) = s$ in $\\Omega$ with prescribed heat flux $\\bar{q}$ on the thermal Neumann boundary $\\Gamma_q \\subset \\partial \\Omega$. The constitutive equations are linear thermoelasticity with constant properties: $\\boldsymbol{\\sigma} = \\mathbb{C}:\\big(\\boldsymbol{\\varepsilon}(\\mathbf{u}) - \\boldsymbol{\\varepsilon}^{\\mathrm{th}}(T)\\big)$, where $\\boldsymbol{\\varepsilon}(\\mathbf{u}) = \\tfrac{1}{2}(\\nabla \\mathbf{u} + \\nabla \\mathbf{u}^\\top)$ and $\\boldsymbol{\\varepsilon}^{\\mathrm{th}}(T) = \\alpha \\big(T - T_0\\big)\\mathbf{I}$, with $\\alpha$ the (isotropic) coefficient of thermal expansion, $T_0$ a reference temperature, and $\\mathbf{k}$ a symmetric positive-definite conductivity tensor.\n\nLet the Finite Element (FE) discretization employ standard $C^0$-continuous shape functions. Denote the discrete vectors of mechanical and thermal unknowns by $\\mathbf{d}$ and $\\boldsymbol{\\theta}$, producing fields $\\mathbf{u}_h(\\mathbf{x})$ and $T_h(\\mathbf{x})$. The assembled residual vectors for the semi-discrete system are written abstractly as\n$\\mathbf{r}_u(\\mathbf{d},\\boldsymbol{\\theta}) = \\mathbf{f}^{\\mathrm{int}}(\\mathbf{d},\\boldsymbol{\\theta}) - \\mathbf{f}^{\\mathrm{ext}}$ for mechanics and $\\mathbf{r}_T(\\boldsymbol{\\theta}) = \\mathbf{q}^{\\mathrm{int}}(\\boldsymbol{\\theta}) - \\mathbf{q}^{\\mathrm{ext}}$ for heat conduction, where the internal vectors arise from the weak forms of the above balance laws with the constitutive definitions.\n\nConsider the following two canonical “patch test” loading/kinematic cases intended to verify the thermoelastic FE formulation:\n\nCase $\\mathbf{I}$ (uniform temperature field with free expansion): Prescribe a uniform temperature field $T(\\mathbf{x}) \\equiv T_0 + \\Delta T$ with constant $\\Delta T$, no body force $\\mathbf{b} = \\mathbf{0}$, traction-free boundary $\\mathbf{t} = \\mathbf{0}$ on $\\Gamma_t = \\partial \\Omega$, zero heat source $s = 0$, and homogeneous thermal Neumann boundary $\\bar{q} = 0$ on $\\Gamma_q = \\partial \\Omega$. The exact continuum solution admits a purely homogeneous free expansion displacement field $\\mathbf{u}(\\mathbf{x})$ such that $\\boldsymbol{\\varepsilon}(\\mathbf{u}) = \\boldsymbol{\\varepsilon}^{\\mathrm{th}}(T)$ and hence $\\boldsymbol{\\sigma} = \\mathbf{0}$, and a uniform temperature gradient $\\nabla T = \\mathbf{0}$.\n\nCase $\\mathbf{II}$ (rigid body motion): Prescribe zero temperature change $T(\\mathbf{x}) \\equiv T_0$, no body force $\\mathbf{b} = \\mathbf{0}$, traction-free boundary $\\mathbf{t} = \\mathbf{0}$, zero heat source $s = 0$, and homogeneous thermal Neumann boundary $\\bar{q} = 0$. The exact continuum displacement is any rigid body motion $\\mathbf{u}(\\mathbf{x}) = \\mathbf{c} + \\boldsymbol{\\Omega}\\,\\mathbf{x}$, with constant translation $\\mathbf{c}$ and constant skew-symmetric tensor $\\boldsymbol{\\Omega}^\\top = -\\boldsymbol{\\Omega}$, so that $\\boldsymbol{\\varepsilon}(\\mathbf{u}) = \\mathbf{0}$ and $\\boldsymbol{\\sigma} = \\mathbf{0}$.\n\nAssume the FE spaces are sufficiently rich to represent the above exact fields exactly at the element level. Which statements about the assembled residuals and their couplings are necessary for the FE formulation to pass this patch test? Select all that apply.\n\nA. In Case $\\mathbf{I}$, with $\\mathbf{u}_h$ equal to the homogeneous free expansion and $T_h$ uniform, the element-level internal mechanical force vector must be $\\mathbf{0}$ and, with traction-free boundary, the assembled external mechanical force vector is $\\mathbf{0}$; hence the global mechanical residual $\\mathbf{r}_u$ must vanish identically.\n\nB. In Case $\\mathbf{II}$, for any discrete rigid body motion $\\mathbf{u}_h(\\mathbf{x}) = \\mathbf{c} + \\boldsymbol{\\Omega}\\,\\mathbf{x}$ and $T_h \\equiv T_0$, the discrete strain-displacement operator applied to this mode produces $\\boldsymbol{\\varepsilon}(\\mathbf{u}_h) = \\mathbf{0}$ elementwise, implying $\\boldsymbol{\\sigma} = \\mathbf{0}$ and an element internal mechanical force vector of $\\mathbf{0}$; therefore the assembled mechanical residual $\\mathbf{r}_u$ must vanish.\n\nC. In Case $\\mathbf{I}$, with $T_h$ uniform and $\\bar{q} = 0 = s$, the conductive flux term yields $\\nabla T_h = \\mathbf{0}$ and the assembled thermal residual $\\mathbf{r}_T$ must vanish; furthermore, in Case $\\mathbf{II}$, a rigid body motion of $\\mathbf{u}_h$ must not contribute any term to $\\mathbf{r}_T$.\n\nD. In the steady conduction setting with constant material properties, the thermal residual must not depend explicitly on the displacement field, i.e., $\\partial \\mathbf{r}_T/\\partial \\mathbf{d} = \\mathbf{0}$, so that rigid body motion cannot induce spurious heat production in the steady energy balance.\n\nE. The geometric (initial-stress) stiffness contribution to the mechanical tangent must be identically $\\mathbf{0}$ under any pre-stress when evaluated with a rigid body rotation, because rigid body rotations are stress-free and thus eliminate all stiffness effects.",
            "solution": "The problem asks to identify the necessary conditions for a finite element (FE) formulation to pass the thermoelastic patch test for two fundamental cases: unconstrained thermal expansion and rigid body motion. A patch test verifies that the FE formulation can exactly reproduce constant-strain states (including zero-strain states) and their corresponding constant stress fields, ensuring consistency.\n\n**Analysis of Case I: Uniform Free Expansion**\nIn this case, the body is subjected to a uniform temperature change $\\Delta T$, resulting in a uniform thermal strain $\\boldsymbol{\\varepsilon}^{\\mathrm{th}} = \\alpha \\Delta T \\mathbf{I}$. Since the body is unconstrained, the exact displacement field produces a total strain that exactly matches the thermal strain, i.e., $\\boldsymbol{\\varepsilon}(\\mathbf{u}) = \\boldsymbol{\\varepsilon}^{\\mathrm{th}}$. The mechanical strain is zero. The constitutive law gives the stress: $\\boldsymbol{\\sigma} = \\mathbb{C}:(\\boldsymbol{\\varepsilon}(\\mathbf{u}) - \\boldsymbol{\\varepsilon}^{\\mathrm{th}}) = \\mathbf{0}$. The body is stress-free.\n- **Option A:** For the FE formulation to pass this test, if the nodal displacements $\\mathbf{d}$ correspond to this exact homogeneous expansion, the resulting strain field $\\boldsymbol{\\varepsilon}(\\mathbf{u}_h)$ must be constant and equal to $\\boldsymbol{\\varepsilon}^{\\mathrm{th}}$ everywhere in the patch. This leads to $\\boldsymbol{\\sigma}_h = \\mathbf{0}$ element-wise. The internal force vector, $\\mathbf{f}^{\\mathrm{int}} = \\int \\mathbf{B}^T \\boldsymbol{\\sigma}_h \\, dV$, must therefore be identically zero. Since there are no external tractions or body forces, the external force vector $\\mathbf{f}^{\\mathrm{ext}}$ is also zero. Consequently, the mechanical residual $\\mathbf{r}_u = \\mathbf{f}^{\\mathrm{int}} - \\mathbf{f}^{\\mathrm{ext}} = \\mathbf{0}$. This statement is a necessary condition for consistency. **Thus, A is correct.**\n\n**Analysis of Case II: Rigid Body Motion**\nIn this case, the body undergoes a rigid motion $\\mathbf{u}(\\mathbf{x}) = \\mathbf{c} + \\boldsymbol{\\Omega}\\,\\mathbf{x}$. By definition, a rigid motion induces zero strain, so $\\boldsymbol{\\varepsilon}(\\mathbf{u}) = \\mathbf{0}$. The temperature change is zero, so $\\boldsymbol{\\varepsilon}^{\\mathrm{th}} = \\mathbf{0}$. The constitutive law gives $\\boldsymbol{\\sigma} = \\mathbb{C}:(\\mathbf{0} - \\mathbf{0}) = \\mathbf{0}$. The body is stress-free.\n- **Option B:** For the FE formulation to pass this test, if the nodal displacements $\\mathbf{d}$ correspond to a rigid body motion, the discrete strain-displacement operator $\\mathbf{B}$ must be such that the strain field is zero, $\\boldsymbol{\\varepsilon}(\\mathbf{u}_h) = \\mathbf{0}$, element-wise. This is a fundamental requirement for any valid element formulation. With zero strain and zero thermal strain, the stress $\\boldsymbol{\\sigma}_h$ is zero. The internal force vector $\\mathbf{f}^{\\mathrm{int}}$ is therefore zero. With no external forces, the residual $\\mathbf{r}_u$ must vanish. This statement is a necessary condition for consistency. **Thus, B is correct.**\n\n**Analysis of Thermal Residuals**\n- **Option C:** In Case I, the temperature field $T_h$ is uniform, so its gradient $\\nabla T_h$ is zero. The internal heat flux vector $\\mathbf{q}^{\\mathrm{int}}$ is computed from the integral of $\\nabla T_h$, so it must be zero. With no external heat sources or fluxes, the external heat vector $\\mathbf{q}^{\\mathrm{ext}}$ is also zero. The thermal residual $\\mathbf{r}_T$ must therefore vanish. In Case II, the governing equation for heat conduction $(-\\nabla \\cdot (\\mathbf{k}\\nabla T) = s)$ is explicitly uncoupled from the mechanical displacement $\\mathbf{u}$. Therefore, the discrete thermal residual $\\mathbf{r}_T$ depends only on the nodal temperatures $\\boldsymbol{\\theta}$, not the nodal displacements $\\mathbf{d}$. A rigid body motion of $\\mathbf{u}_h$ cannot affect $\\mathbf{r}_T$. This statement is correct. **Thus, C is correct.**\n- **Option D:** This option formalizes the second point of option C. The lack of coupling from the mechanical to the thermal field in the specified steady-state energy balance means that the thermal residual $\\mathbf{r}_T$ is not a function of the mechanical degrees of freedom $\\mathbf{d}$. Mathematically, this is expressed as the Jacobian (or sensitivity) of the thermal residual with respect to mechanical displacements being zero: $\\partial \\mathbf{r}_T/\\partial \\mathbf{d} = \\mathbf{0}$. This correctly reflects the one-way coupling (T affects u, but u does not affect T) in this problem formulation. **Thus, D is correct.**\n\n**Analysis of Tangent Stiffness**\n- **Option E:** This statement discusses the geometric stiffness matrix, which is a concept from nonlinear solid mechanics used to account for the effect of existing stress on the stiffness (e.g., in buckling analysis). The patch test is a verification tool for the fundamental consistency of the formulation, typically in a linear context. While tangent stiffness properties are important, this statement is misplaced and flawed. The condition that the tangent stiffness matrix must not generate energy under a rigid body rotation is a requirement for objectivity, but the justification provided is incorrect. A rigid body rotation can be superimposed on a stressed state; the geometric stiffness captures this interaction. The claim that rotations \"eliminate all stiffness effects\" is wrong. This option introduces an irrelevant concept from nonlinear analysis and provides a poor justification. **Thus, E is incorrect.**",
            "answer": "$$\n\\boxed{ABCD}\n$$"
        }
    ]
}