{
    "hands_on_practices": [
        {
            "introduction": "A robust numerical simulation begins with a stable discretization. In mixed displacement-pressure ($\\mathbf{u}-p$) formulations, particularly for nearly incompressible materials, naively chosen finite element spaces can lead to numerical locking and non-physical pressure oscillations. This practice provides a foundational exercise in deriving and implementing a pressure stabilization parameter $\\tau$ that guarantees robustness, demonstrating how to use Fourier analysis to calibrate a scheme and ensure its consistency and stability across different mesh sizes and material properties .",
            "id": "3555649",
            "problem": "Consider the mixed displacement–pressure ($\\mathbf{u}-p$) formulation of small-strain linear elasticity under plane strain for a homogeneous isotropic solid with Lamé parameters $\\lambda$ and $\\mu$, and bulk modulus $K$. The unknowns are displacement $u$ and pressure $p$, and the standard mixed weak form couples the deviatoric part controlled by $\\mu$ and the volumetric part controlled by $K$. In the incompressible limit, $K \\to \\infty$, the volumetric strain constraint becomes dominant and the formulation requires an appropriate choice of pressure space or stabilization to remain stable.\n\nA widely used approach with equal-order displacement–pressure finite element spaces adds a consistent pressure-gradient stabilization term of the form\n$$\nS(p, q) \\;=\\; \\sum_{e} \\tau_e \\int_{\\Omega_e} \\nabla p \\cdot \\nabla q \\, \\mathrm{d}\\Omega,\n$$\nwhere $\\tau_e$ is a positive stabilization parameter per element and $q$ is the pressure test function. The stabilization must be calibrated so that:\n- It is consistent with the continuous $u$–$p$ formulation (in the sense that it does not bias the solution for sufficiently smooth $p$).\n- It yields robustness of the discrete system as $K \\to \\infty$, especially for monolithic coupling (solving the fully coupled $u$–$p$ system) and staggered coupling (solving $u$ and $p$ in alternating substeps).\n- It controls spurious high-frequency pressure modes (e.g., checkerboard patterns) inherent to equal-order discretizations that otherwise violate the Ladyzhenskaya–Babuška–Brezzi inf–sup condition.\n\nStarting from first principles, use the following base:\n- The linear momentum balance for quasi-static small-strain elasticity and the constitutive relation for an isotropic solid: $\\sigma = 2\\mu \\varepsilon(u) - p I$ and $p = -K \\, \\nabla \\cdot u$ for finite $K$.\n- The mixed saddle-point structure with block operators $A$ (deviatoric stiffness), $B$ (discrete divergence), and the pressure block $-C$ where $C$ arises solely from stabilization in the incompressible limit.\n- A one-dimensional Fourier symbol analysis on a uniform grid of element size $h$ in which the deviatoric operator has symbol proportional to $\\mu k^2$, the coupling operator has symbol proportional to $ik$, and the maximum representable wavenumber (Nyquist wavenumber) is $k_{\\max} = \\pi/h$.\n\nDerive a calibration for $\\tau$ as a function of the mesh size $h$ and material shear modulus $\\mu$ that ensures the discrete pressure Schur complement remains uniformly bounded above and below for all admissible modes as $K \\to \\infty$, thereby preventing locking and suppressing spurious checkerboard modes. Express $\\tau$ in $\\text{m}^2/\\text{Pa}$.\n\nThen, implement a program that computes $\\tau$ for the following test suite of parameter triplets $(h, \\mu, K)$:\n- Case A (happy path): $h = 0.1$ m, $\\mu = 80 \\times 10^9$ Pa, $K = 10^{12}$ Pa.\n- Case B (small mesh size): $h = 0.001$ m, $\\mu = 10^6$ Pa, $K = 10^9$ Pa.\n- Case C (large shear modulus): $h = 0.2$ m, $\\mu = 200 \\times 10^9$ Pa, $K = 10^{12}$ Pa.\n- Case D (extremely large bulk modulus): $h = 0.05$ m, $\\mu = 5 \\times 10^9$ Pa, $K = 10^{15}$ Pa.\n- Case E (moderately compressible material): $h = 0.5$ m, $\\mu = 2 \\times 10^9$ Pa, $K = 10^8$ Pa.\n\nYour program must produce a single line of output containing the results for the five cases as a comma-separated list enclosed in square brackets, for example, $[x_1,x_2,x_3,x_4,x_5]$, where each $x_i$ is the value of $\\tau$ in $\\text{m}^2/\\text{Pa}$ computed by your derived calibration. The outputs must be real-valued floats. No other text should be printed.",
            "solution": "The problem statement has been validated and is deemed scientifically sound, well-posed, and objective. It presents a standard, non-trivial task in the field of computational solid mechanics, providing sufficient information for a rigorous derivation. We may therefore proceed with a solution.\n\nThe objective is to derive a calibration for the pressure stabilization parameter $\\tau$ in a mixed $u-p$ finite element formulation for nearly incompressible linear elasticity. The derivation will be based on a one-dimensional Fourier stability analysis, ensuring that the resulting discrete system is robust in the incompressible limit, $K \\to \\infty$.\n\nThe discrete saddle-point system arising from the mixed formulation is given in block matrix form as:\n$$\n\\begin{pmatrix} A  B^T \\\\ B  -C \\end{pmatrix}\n\\begin{pmatrix} \\mathbf{u} \\\\ \\mathbf{p} \\end{pmatrix}\n=\n\\begin{pmatrix} \\mathbf{f} \\\\ \\mathbf{g} \\end{pmatrix}\n$$\nHere, $\\mathbf{u}$ and $\\mathbf{p}$ are the vectors of discrete displacement and pressure degrees of freedom, respectively. The matrix $A$ represents the deviatoric stiffness, $B$ is the discrete divergence operator, and $C$ is the pressure matrix. For the stabilized formulation, the pressure block $C$ is composed of a compressibility term and a stabilization term: $C = \\frac{1}{K}M_p + C_{\\text{stab}}$, where $M_p$ is the pressure mass matrix. In the incompressible limit as $K \\to \\infty$, the term $\\frac{1}{K}M_p$ vanishes, and the problem states that the block $-C$ arises solely from the stabilization.\n\nThe stabilization term is given as $S(p, q) = \\sum_{e} \\tau_e \\int_{\\Omega_e} \\nabla p \\cdot \\nabla q \\, \\mathrm{d}\\Omega$. For a uniform mesh with element size $h$, the stabilization parameter $\\tau_e$ is constant, $\\tau_e = \\tau$. This term corresponds to a scaled discrete pressure Laplacian, $-\\tau \\nabla^2 p$.\n\nTo analyze the stability of this system, we eliminate the displacement vector $\\mathbf{u}$ to form the pressure Schur complement system. The Schur complement operator is $S_p = C + B A^{-1} B^T$. The stability and well-conditioning of the entire system depend critically on the properties of $S_p$. Our goal is to choose $\\tau$ such that the spectrum of $S_p$ is well-behaved and bounded away from zero, independently of the mesh size $h$.\n\nWe employ Fourier analysis, as specified, on a uniform one-dimensional grid. In this analysis, operators are replaced by their Fourier symbols, which represent their action on a mode $e^{ikx}$, where $k$ is the wavenumber. The symbol of an operator essentially describes its eigenvalues. The Schur complement operator $S_p$ has a symbol $\\hat{S}_p(k)$ given by:\n$$\n\\hat{S}_p(k) = \\hat{C}(k) + \\hat{B}(k) (\\hat{A}(k))^{-1} \\hat{B}(k)^*\n$$\nwhere $\\hat{A}(k)$, $\\hat{B}(k)$, and $\\hat{C}(k)$ are the symbols of the operators $A$, $B$, and $C$, and $\\hat{B}(k)^*$ is the conjugate transpose of $\\hat{B}(k)$.\n\nLet us determine the symbols for the operators based on the provided information and standard finite difference/element stencils.\n$1$. The operator $A$ corresponds to the deviatoric term, which behaves like $-2\\mu\\nabla^2 u$. The symbol of the discrete second derivative operator on a grid with spacing $h$ is $\\hat{\\mathcal{L}}(k) = -\\frac{4}{h^2}\\sin^2(\\frac{kh}{2})$. Thus, the symbol for the deviatoric stiffness operator $A$ is proportional to this, scaled by the shear modulus $\\mu$:\n$$\n\\hat{A}(k) = c_A \\mu \\frac{4}{h^2}\\sin^2\\left(\\frac{kh}{2}\\right)\n$$\nThis is consistent with the problem's hint that $\\hat{A}(k) \\propto \\mu k^2$ for small $k$.\n\n$2$. The operator $B$ is the discrete divergence, which for a central difference scheme has the symbol $\\hat{B}(k) = c_B \\frac{i}{h}\\sin(kh)$. This is consistent with the hint $\\hat{B}(k) \\propto ik$. Its conjugate transpose symbol is $\\hat{B}(k)^* = -c_B \\frac{i}{h}\\sin(kh)$.\n\n$3$. The operator $C$ in the incompressible limit is purely from stabilization, $C \\to C_{\\text{stab}}$. The stabilization term corresponds to $-\\tau \\nabla^2 p$. Its symbol is therefore proportional to the symbol of the discrete Laplacian:\n$$\n\\hat{C}(k) = \\hat{C}_{\\text{stab}}(k) = c_C \\tau \\frac{4}{h^2}\\sin^2\\left(\\frac{kh}{2}\\right)\n$$\nThe constants $c_A$, $c_B$, and $c_C$ are dimensionless factors of order unity that depend on the specific choice of finite element basis functions.\n\nSubstituting these symbols into the expression for the Schur complement symbol:\n$$\n\\hat{S}_p(k) = c_C \\tau \\frac{4}{h^2}\\sin^2\\left(\\frac{kh}{2}\\right) + \\left(c_B \\frac{i}{h}\\sin(kh)\\right) \\left(c_A \\mu \\frac{4}{h^2}\\sin^2\\left(\\frac{kh}{2}\\right)\\right)^{-1} \\left(-c_B \\frac{i}{h}\\sin(kh)\\right)\n$$\n$$\n\\hat{S}_p(k) = c_C \\tau \\frac{4}{h^2}\\sin^2\\left(\\frac{kh}{2}\\right) + \\frac{c_B^2}{h^2}\\sin^2(kh) \\left(c_A \\mu \\frac{4}{h^2}\\sin^2\\left(\\frac{kh}{2}\\right)\\right)^{-1}\n$$\nUsing the trigonometric identity $\\sin(kh) = 2\\sin(\\frac{kh}{2})\\cos(\\frac{kh}{2})$, we have $\\sin^2(kh) = 4\\sin^2(\\frac{kh}{2})\\cos^2(\\frac{kh}{2})$.\n$$\n\\hat{S}_p(k) = c_C \\tau \\frac{4}{h^2}\\sin^2\\left(\\frac{kh}{2}\\right) + \\frac{c_B^2}{h^2} \\frac{4\\sin^2(\\frac{kh}{2})\\cos^2(\\frac{kh}{2})}{c_A \\mu \\frac{4}{h^2}\\sin^2(\\frac{kh}{2})}\n$$\nThe term $\\sin^2(\\frac{kh}{2})$ cancels out in the second part, provided $k \\neq 0$ and $k \\neq 2\\pi/h$:\n$$\n\\hat{S}_p(k) = c_C \\tau \\frac{4}{h^2}\\sin^2\\left(\\frac{kh}{2}\\right) + \\frac{c_B^2}{c_A \\mu} \\cos^2\\left(\\frac{kh}{2}\\right)\n$$\nThis expression reveals the behavior of the Schur complement across the range of wavenumbers. The first term, from stabilization, dominates at high frequencies (large $k$, where $\\sin^2(\\frac{kh}{2})$ is large), while the second term, from the physical coupling, dominates at low frequencies (small $k$, where $\\cos^2(\\frac{kh}{2})$ is large). Instability in equal-order elements arises because for the highest frequency mode (checkerboard mode, $k_{\\max} = \\pi/h$), the discrete divergence operator symbol can be zero. In our model symbol, $\\sin(k_{\\max}h) = \\sin(\\pi) = 0$, so $\\hat{B}(k_{\\max})=0$. The unstabilized Schur complement would be singular for this mode. The stabilization term remedies this by being maximal at this frequency, since $\\sin^2(\\frac{k_{\\max}h}{2}) = \\sin^2(\\pi/2) = 1$.\n\nTo ensure the Schur complement is uniformly bounded and its condition number does not depend on the mesh size $h$, we must balance the two terms in the symbol expression. This is achieved by choosing $\\tau$ such that the coefficients of the trigonometric terms are of the same order of magnitude:\n$$\nc_C \\tau \\frac{4}{h^2} \\sim \\frac{c_B^2}{c_A \\mu}\n$$\nRearranging for $\\tau$ gives the desired scaling relationship:\n$$\n\\tau \\sim \\frac{c_B^2 h^2}{4 c_A c_C \\mu}\n$$\nThis shows that $\\tau$ must be proportional to $h^2/\\mu$. We can write the calibration as:\n$$\n\\tau = c \\frac{h^2}{\\mu}\n$$\nwhere $c = \\frac{c_B^2}{4 c_A c_C}$ is a dimensionless constant. In the absence of specific details about the finite element basis functions which define $c_A$, $c_B$, and $c_C$, the most reasonable and standard approach is to assume these constants are such that $c=1$. This choice yields an ideal balance. Therefore, the derived calibration is:\n$$\n\\tau = \\frac{h^2}{\\mu}\n$$\nLet us verify the physical units. The mesh size $h$ is in meters (m) and the shear modulus $\\mu$ is in Pascals (Pa). The units for $\\tau$ are therefore $\\text{m}^2/\\text{Pa}$, which matches the problem's requirement. The value of the bulk modulus $K$ is not part of the final formula, which is expected, as the parameter is designed for robustness in the limit $K \\to \\infty$.\n\nWe will now apply this formula, $\\tau = h^2 / \\mu$, to compute the stabilization parameter for the provided test cases.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the pressure stabilization parameter tau for several test cases\n    based on the derived formula tau = h^2 / mu.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (h, mu, K)\n    # h is in meters (m)\n    # mu is in Pascals (Pa)\n    # K is in Pascals (Pa)\n    # The value of K is not used in the calculation, as the formula is derived\n    # for the incompressible limit (K -> infinity).\n    test_cases = [\n        # Case A: (h, mu, K)\n        (0.1, 80e9, 1e12),\n        # Case B: (h, mu, K)\n        (0.001, 1e6, 1e9),\n        # Case C: (h, mu, K)\n        (0.2, 200e9, 1e12),\n        # Case D: (h, mu, K)\n        (0.05, 5e9, 1e15),\n        # Case E: (h, mu, K)\n        (0.5, 2e9, 1e8),\n    ]\n\n    results = []\n    for case in test_cases:\n        h, mu, K = case\n        \n        # The derived calibration for the stabilization parameter tau is h^2 / mu.\n        # The dimensionless constant of proportionality is taken as 1.\n        tau = h**2 / mu\n        \n        results.append(tau)\n\n    # Final print statement in the exact required format: a comma-separated\n    # list of floating-point numbers enclosed in square brackets.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Building on the concept of stability, this exercise provides a concrete look at the consequences of an unstable formulation and the differing abilities of coupling strategies to handle it. You will construct a small-scale system designed to exhibit a spurious \"checkerboard\" pressure mode—a classic artifact of failing the Ladyzhenskaya-Babuška-Brezzi (LBB) condition. Through an eigenvalue analysis, you will quantitatively compare how a monolithic scheme inherently suppresses this non-physical mode, while a simple staggered scheme allows it to persist, highlighting the superior stability of fully coupled approaches .",
            "id": "3555606",
            "problem": "Consider the quasi-static linear Biot poromechanics model in one spatial dimension, discretized in a mixed displacement-pressure formulation. Let $u$ denote the displacement vector and $p$ denote the pore pressure vector. At the algebraic level, the monolithic linearized system for the unknown increments $(\\Delta u, \\Delta p)$ can be written in block form as\n$$\n\\begin{bmatrix}\nK  -\\alpha B^{\\top} \\\\\n\\alpha B  C + D\n\\end{bmatrix}\n\\begin{bmatrix}\n\\Delta u \\\\\n\\Delta p\n\\end{bmatrix}\n=\n\\begin{bmatrix}\nr_u \\\\\nr_p\n\\end{bmatrix},\n$$\nwhere $K \\in \\mathbb{R}^{n_u \\times n_u}$ is the symmetric positive definite elasticity stiffness matrix, $B \\in \\mathbb{R}^{n_p \\times n_u}$ is the discrete volumetric coupling operator, $C \\in \\mathbb{R}^{n_p \\times n_p}$ is the symmetric positive definite storage matrix (scaled by the time step), $D \\in \\mathbb{R}^{n_p \\times n_p}$ is the symmetric positive semidefinite flow diffusion matrix, and $\\alpha \\in \\mathbb{R}$ is the Biot coefficient. In this problem, adopt the canonical simplification $D = 0$ to isolate the mechanics-pressure coupling. All quantities are dimensionless in the algebraic setting, and no physical unit conversions are required for the outputs.\n\nThe canonical Schur complement operator acting on the pressure increment is given by\n$$\nS = C + \\alpha^2 B K^{-1} B^{\\top} \\in \\mathbb{R}^{n_p \\times n_p}.\n$$\nSpurious pressure modes in mixed displacement-pressure formulations are associated with discrete vectors in the near-nullspace of the coupling term $B K^{-1} B^{\\top}$, often due to violation of the Ladyzhenskaya-Babuška-Brezzi (LBB) inf-sup stability condition when using equal-order interpolation for displacement and pressure. A canonical way to expose such modes is to study the eigenvalue problem\n$$\nS \\, \\varphi = \\lambda \\, \\varphi,\n$$\nand identify eigenvectors $\\varphi$ whose eigenvalues $\\lambda$ are anomalously small compared to the rest of the spectrum.\n\nThe fixed-stress partitioned (staggered) scheme performs a mechanics update with pressure held fixed, followed by a flow update with a stabilized volumetric term. For a linear system with an exact mechanics step and a flow step preconditioned by an added stabilization $\\tau I$ in the storage, the linear error-propagation operator for the pressure increment can be modeled as\n$$\nG = I - (C + \\tau I)^{-1} S,\n$$\nwhere $I$ is the identity matrix and $\\tau \\in \\mathbb{R}$ is a positive stabilization parameter approximating the drained bulk contribution (fixed-stress tangent). The amplification of a mode $\\varphi$ under one staggered iteration is characterized by the Rayleigh quotient of $G$ along $\\varphi$, namely\n$$\n\\rho(\\varphi) = \\frac{\\varphi^{\\top} G \\, \\varphi}{\\varphi^{\\top} \\varphi}.\n$$\nFor the monolithic coupling with exact tangent and a direct solve, the iteration count is one and the linear residual along any eigenmode is eliminated, so the effective single-step amplification factor along any mode is taken as $0$.\n\nYour task is to construct a canonical discrete system that provably exhibits a spurious pressure mode and then quantify how a monolithic exact-tangent approach suppresses this mode compared to a staggered fixed-stress splitting.\n\nImplement the following steps:\n\n1. Define $n_u = 4$ displacement degrees of freedom and $n_p = 4$ pressure degrees of freedom. Let the elasticity matrix be $K = k_u I$ with $k_u  0$, and the storage matrix be $C = c I$ with $c  0$. Choose the coupling operator $B \\in \\mathbb{R}^{4 \\times 4}$ as\n   $$\n   B =\n   \\begin{bmatrix}\n   1  0  0  1 \\\\\n   1  0  1  0 \\\\\n   0  1  1  0 \\\\\n   0  1  0  1\n   \\end{bmatrix},\n   $$\n   and the spurious pressure mode candidate $\\varphi_{\\mathrm{alt}} = [1, -1, 1, -1]^{\\top}$.\n\n2. Form the Schur complement $S = C + \\alpha^2 B K^{-1} B^{\\top}$ and solve the eigenvalue problem $S \\varphi = \\lambda \\varphi$. Extract the smallest eigenvalue $\\lambda_{\\min}$ as a proxy for the severity of spurious pressure modes. Evaluate the Rayleigh quotient of $G$ along $\\varphi_{\\mathrm{alt}}$ to quantify the amplification factor under the fixed-stress splitting. Report $0$ as the monolithic amplification for this mode.\n\n3. Use the following test suite of parameter sets, which explores a typical case, near-incompressible storage (edge case), strong stabilization, and weak stabilization:\n   - Test Case 1 (general case): $\\alpha = 1.0$, $k_u = 1.0$, $c = 10^{-3}$, $\\tau = 10^{-2}$.\n   - Test Case 2 (near-incompressible storage and weak stabilization): $\\alpha = 1.0$, $k_u = 1.0$, $c = 10^{-8}$, $\\tau = 10^{-2}$.\n   - Test Case 3 (near-incompressible storage and strong stabilization): $\\alpha = 1.0$, $k_u = 1.0$, $c = 10^{-8}$, $\\tau = 1.0$.\n   - Test Case 4 (general storage and very weak stabilization): $\\alpha = 1.0$, $k_u = 1.0$, $c = 10^{-3}$, $\\tau = 10^{-6}$.\n\n4. For each test case, compute and collect the three outputs:\n   - The smallest eigenvalue $\\lambda_{\\min}$ of $S$ (a float).\n   - The fixed-stress amplification factor along $\\varphi_{\\mathrm{alt}}$, namely the Rayleigh quotient $\\rho(\\varphi_{\\mathrm{alt}})$ of $G$ (a float).\n   - The monolithic amplification factor along $\\varphi_{\\mathrm{alt}}$, which is $0$ (a float).\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets in the order of the test suite, aggregating all three outputs per test case into a flat list. For example, the output format is\n$$\n[\\lambda_{\\min}^{(1)}, \\rho^{(1)}, 0, \\lambda_{\\min}^{(2)}, \\rho^{(2)}, 0, \\lambda_{\\min}^{(3)}, \\rho^{(3)}, 0, \\lambda_{\\min}^{(4)}, \\rho^{(4)}, 0].\n$$\nNo physical units are required in the output; all values are dimensionless floats. Angles are not involved. Express all floats with the default numerical representation of the programming language.",
            "solution": "The problem statement is found to be valid. It is scientifically grounded in the theory of computational poromechanics, well-posed, objective, and provides a complete and consistent set of definitions and parameters for a solvable numerical experiment.\n\nThe task is to analyze the stability of a mixed displacement-pressure formulation for the Biot equations in the presence of a spurious pressure mode. We will compare the behavior of a monolithic direct solver against a partitioned (staggered) fixed-stress iterative scheme. A specific discrete system is provided, designed to exhibit a known spurious pressure mode.\n\nThe algebraic system under consideration is the linearized quasi-static Biot system, simplified by setting the diffusion matrix $D=0$:\n$$\n\\begin{bmatrix}\nK  -\\alpha B^{\\top} \\\\\n\\alpha B  C\n\\end{bmatrix}\n\\begin{bmatrix}\n\\Delta u \\\\\n\\Delta p\n\\end{bmatrix}\n=\n\\begin{bmatrix}\nr_u \\\\\nr_p\n\\end{bmatrix}\n$$\nHere, $K$ is the elasticity stiffness matrix, $C$ is the storage matrix, $B$ is the coupling operator, and $\\alpha$ is the Biot coefficient. The dimensions are $n_u=4$ for displacements and $n_p=4$ for pressures. The matrices are given specific simplified forms: $K = k_u I$ and $C = c I$, where $I$ is the $4 \\times 4$ identity matrix.\n\nA key object of study is the Schur complement operator, $S$, which arises from eliminating the displacement increment $\\Delta u$ from the system:\n$$\nS = C + \\alpha^2 B K^{-1} B^{\\top}\n$$\nThe eigenvalues of $S$ characterize the stability and conditioning of the coupled system. Spurious pressure modes are eigenvectors of $S$ associated with anomalously small eigenvalues, often stemming from choices of finite element spaces that do not satisfy the Ladyzhenskaya-Babuška-Brezzi (LBB) inf-sup condition. These modes correspond to vectors in the near-nullspace of the coupling term $B K^{-1} B^{\\top}$.\n\nThe problem defines a specific coupling matrix $B$ and a candidate spurious mode $\\varphi_{\\mathrm{alt}}$:\n$$\nB =\n\\begin{bmatrix}\n1  0  0  1 \\\\\n1  0  1  0 \\\\\n0  1  1  0 \\\\\n0  1  0  1\n\\end{bmatrix},\n\\quad\n\\varphi_{\\mathrm{alt}} =\n\\begin{bmatrix}\n1 \\\\ -1 \\\\ 1 \\\\ -1\n\\end{bmatrix}\n$$\nWe can verify that $\\varphi_{\\mathrm{alt}}$ is a spurious mode by checking its relation to $B^{\\top}$. A direct calculation shows that $B^{\\top} \\varphi_{\\mathrm{alt}} = 0$, meaning $\\varphi_{\\mathrm{alt}}$ is in the nullspace of $B^{\\top}$. This is a characteristic of a \"checkerboard\" pressure mode which is not \"seen\" by the displacement field through the coupling operator $B$.\n\nConsequently, for this mode $\\varphi_{\\mathrm{alt}}$, the action of the mechanical part of the Schur complement is zero:\n$$\n(\\alpha^2 B K^{-1} B^{\\top}) \\varphi_{\\mathrm{alt}} = \\alpha^2 B K^{-1} (B^{\\top} \\varphi_{\\mathrm{alt}}) = 0\n$$\nApplying the full Schur complement operator $S$ to $\\varphi_{\\mathrm{alt}}$ gives:\n$$\nS \\varphi_{\\mathrm{alt}} = (C + \\alpha^2 B K^{-1} B^{\\top}) \\varphi_{\\mathrm{alt}} = C \\varphi_{\\mathrm{alt}} + 0 = (cI) \\varphi_{\\mathrm{alt}} = c \\varphi_{\\mathrm{alt}}\n$$\nThis demonstrates that $\\varphi_{\\mathrm{alt}}$ is an eigenvector of $S$ with the eigenvalue $\\lambda = c$. Since the matrix $\\alpha^2 B K^{-1} B^{\\top} = (\\alpha^2/k_u) B B^{\\top}$ is symmetric positive semidefinite (its eigenvalues are non-negative), the eigenvalues of $S$ are all greater than or equal to $c$. Thus, $\\lambda=c$ is the minimum eigenvalue of $S$, i.e., $\\lambda_{\\min}=c$. This eigenvalue being small (for small storage $c$) is the hallmark of the instability.\n\nThe monolithic solution scheme solves the full system directly. In a linear context, this is equivalent to a single step that eliminates the residual, so the amplification factor for any mode is $0$.\n\nThe fixed-stress staggered scheme iteratively solves the system. The amplification of errors is governed by the error-propagation operator $G = I - (C + \\tau I)^{-1} S$, where $\\tau$ is a stabilization parameter. We must quantify the amplification of the mode $\\varphi_{\\mathrm{alt}}$ by computing the Rayleigh quotient $\\rho(\\varphi_{\\mathrm{alt}})$.\nSince $\\varphi_{\\mathrm{alt}}$ is an eigenvector of $S$ with eigenvalue $c$, it is also an eigenvector of $G$:\n$$\nG \\varphi_{\\mathrm{alt}} = (I - (C + \\tau I)^{-1} S) \\varphi_{\\mathrm{alt}} = \\varphi_{\\mathrm{alt}} - ( (c+\\tau)I )^{-1} (c \\varphi_{\\mathrm{alt}}) = \\varphi_{\\mathrm{alt}} - \\frac{c}{c+\\tau} \\varphi_{\\mathrm{alt}} = \\left(1 - \\frac{c}{c+\\tau}\\right) \\varphi_{\\mathrm{alt}} = \\frac{\\tau}{c+\\tau} \\varphi_{\\mathrm{alt}}\n$$\nThe amplification factor, which is the eigenvalue of $G$ corresponding to the eigenvector $\\varphi_{\\mathrm{alt}}$, is therefore $\\rho(\\varphi_{\\mathrm{alt}}) = \\frac{\\tau}{c+\\tau}$.\n\nThis analytical result provides insight:\n- If $c \\ll \\tau$, then $\\rho(\\varphi_{\\mathrm{alt}}) \\approx 1$, meaning the staggered scheme fails to damp this spurious mode. This occurs in near-incompressible cases (small $c$) even with strong stabilization (large $\\tau$).\n- If $\\tau \\ll c$, then $\\rho(\\varphi_{\\mathrm{alt}}) \\approx \\tau/c \\ll 1$, meaning the mode is strongly damped.\n\nThe following steps are implemented for each test case to compute the required values numerically, confirming the analytical derivations.\n\n1.  **Construct Matrices**: For each set of parameters $(\\alpha, k_u, c, \\tau)$, the matrices $I$, $B$, $K = k_u I$, $C = c I$, and $\\varphi_{\\mathrm{alt}}$ are defined in $\\mathbb{R}^{4 \\times 4}$.\n2.  **Compute $\\lambda_{\\min}$**: The Schur complement $S = cI + \\frac{\\alpha^2}{k_u}B B^{\\top}$ is formed. The eigenvalues of this symmetric matrix are computed, and the smallest value is identified as $\\lambda_{\\min}$.\n3.  **Compute $\\rho(\\varphi_{\\mathrm{alt}})$**: The error propagator $G = I - (C + \\tau I)^{-1} S$ is constructed. The Rayleigh quotient $\\rho(\\varphi_{\\mathrm{alt}}) = (\\varphi_{\\mathrm{alt}}^{\\top} G \\varphi_{\\mathrm{alt}}) / (\\varphi_{\\mathrm{alt}}^{\\top} \\varphi_{\\mathrm{alt}})$ is then calculated.\n4.  **Aggregate Results**: The tuple $(\\lambda_{\\min}, \\rho(\\varphi_{\\mathrm{alt}}), 0.0)$ is determined for each test case and collected into a final flat list for output.\n\nThis procedure is systematically applied to the four test cases provided in the problem statement.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the poromechanics coupling stability problem by computing eigenvalues\n    and amplification factors for monolithic and staggered schemes.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (alpha, k_u, c, tau)\n        (1.0, 1.0, 1e-3, 1e-2),  # Test Case 1 (general case)\n        (1.0, 1.0, 1e-8, 1e-2),  # Test Case 2 (near-incompressible, weak stabilization)\n        (1.0, 1.0, 1e-8, 1.0),   # Test Case 3 (near-incompressible, strong stabilization)\n        (1.0, 1.0, 1e-3, 1e-6),  # Test Case 4 (general storage, very weak stabilization)\n    ]\n\n    results = []\n\n    # Define constant values based on the problem description\n    n_dim = 4\n    I = np.identity(n_dim)\n    \n    # Coupling operator B\n    B = np.array([\n        [1., 0., 0., 1.],\n        [1., 0., 1., 0.],\n        [0., 1., 1., 0.],\n        [0., 1., 0., 1.]\n    ])\n\n    # Spurious pressure mode candidate\n    phi_alt = np.array([1., -1., 1., -1.])\n\n    for case in test_cases:\n        alpha, k_u, c, tau = case\n\n        # Step 1: Form the Schur complement S\n        # K = k_u * I => K_inv = (1/k_u) * I\n        # C = c * I\n        K_inv = (1.0 / k_u) * I\n        C_mat = c * I\n        \n        # S = C + alpha^2 * B * K^-1 * B^T\n        S = C_mat + (alpha**2) * (B @ K_inv @ B.T)\n\n        # Step 2: Solve the eigenvalue problem for S to find lambda_min\n        # Since S is symmetric, we can use eigh for efficiency and stability.\n        # eigvalsh returns eigenvalues in ascending order.\n        eigenvalues_S = np.linalg.eigvalsh(S)\n        lambda_min = eigenvalues_S[0]\n\n        # Step 3: Compute the fixed-stress amplification factor rho\n        # G = I - (C + tau*I)^-1 * S\n        C_plus_tau_I_inv = np.linalg.inv(C_mat + tau * I)\n        G = I - C_plus_tau_I_inv @ S\n\n        # rho(phi_alt) = (phi_alt^T * G * phi_alt) / (phi_alt^T * phi_alt)\n        numerator = phi_alt.T @ G @ phi_alt\n        denominator = phi_alt.T @ phi_alt\n        rho_phi_alt = numerator / denominator\n\n        # Step 4: Collect the three outputs for the current test case\n        # The monolithic amplification factor is given as 0.\n        monolithic_amp = 0.0\n        \n        results.extend([lambda_min, rho_phi_alt, monolithic_amp])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "After ensuring a stable formulation and understanding its behavior, the final step is to verify that our code is correct. This practice introduces the Method of Manufactured Solutions (MMS), a powerful technique for code verification. By constructing a problem with a known analytical solution, you will test whether your numerical implementations of both monolithic and staggered schemes accurately conserve energy up to the expected order of truncation error, providing a rigorous check on the correctness of your coupled solver .",
            "id": "3555626",
            "problem": "Consider a lumped mixed displacement–pressure model that abstracts a one-dimensional linearized poroelastic coupling in computational solid mechanics. Let $u(t)$ denote the displacement, $v(t) = \\dot{u}(t)$ the velocity, and $p(t)$ the pore pressure. The governing equations are assumed to follow Newton's Second Law and linear storage and flow with dissipation, given by\n$$\nm \\ddot{u}(t) + k u(t) - b\\, p(t) = f_u(t),\n$$\n$$\ns \\dot{p}(t) + c\\, p(t) + b\\, \\dot{u}(t) = f_p(t),\n$$\nwhere $mgt;0$ is the mass, $kgt;0$ is the elastic stiffness, $b\\ge 0$ is the coupling coefficient, $sgt;0$ is the storage coefficient, $c\\ge 0$ is the flow dissipation coefficient, and $f_u(t)$ and $f_p(t)$ are externally applied generalized forces. Treat all quantities as nondimensional; no physical units are required.\n\nYou will construct a manufactured exact solution $(u^\\star(t), p^\\star(t))$ and corresponding right-hand sides $(f_u(t), f_p(t))$ so that $(u^\\star, p^\\star)$ satisfies the continuous equations exactly. Then, for two coupling strategies—monolithic and staggered—using an implicit first-order time discretization, you will compute the discrete energy residual over a time interval and verify that it remains within truncation error.\n\nManufactured solution and forcing:\n- Let\n$$\nu^\\star(t) = A_u \\sin(\\omega t), \\quad p^\\star(t) = A_p \\cos(\\omega t),\n$$\nwith constants $A_ugt;0$, $A_pgt;0$, and $\\omegagt;0$.\n- Define\n$$\n\\dot{u}^\\star(t) = A_u \\omega \\cos(\\omega t), \\quad \\ddot{u}^\\star(t) = -A_u \\omega^2 \\sin(\\omega t), \\quad \\dot{p}^\\star(t) = -A_p \\omega \\sin(\\omega t).\n$$\n- Define the manufactured forcing by substituting the exact solution into the continuous equations:\n$$\nf_u(t) = m \\ddot{u}^\\star(t) + k u^\\star(t) - b\\, p^\\star(t),\n$$\n$$\nf_p(t) = s \\dot{p}^\\star(t) + c\\, p^\\star(t) + b\\, \\dot{u}^\\star(t).\n$$\n\nDiscrete schemes on a uniform time grid:\n- Let the time grid be $t_n = n \\Delta t$ for $n=0,1,\\dots,N$ with $N = \\lfloor T/\\Delta t \\rfloor$. Initialize $u^0 = u^\\star(0)$, $v^0 = \\dot{u}^\\star(0)$, $p^0 = p^\\star(0)$.\n- Monolithic implicit scheme (solve all fields together at time $t_{n+1}$):\n  - Use Backward Euler (BE) for evolution and kinematics:\n  $$\n  \\frac{m}{\\Delta t}\\left(v^{n+1}-v^n\\right) + k\\, u^{n+1} - b\\, p^{n+1} = f_u(t_{n+1}),\n  $$\n  $$\n  \\frac{u^{n+1}-u^n}{\\Delta t} = v^{n+1},\n  $$\n  $$\n  \\frac{s}{\\Delta t}\\left(p^{n+1}-p^n\\right) + c\\, p^{n+1} + b\\, v^{n+1} = f_p(t_{n+1}).\n  $$\n- Staggered implicit scheme (partitioned update at time $t_{n+1}$):\n  - Mechanics substep with $p$ lagged:\n  $$\n  \\frac{m}{\\Delta t}\\left(v^{n+1}-v^n\\right) + k\\, u^{n+1} - b\\, p^{n} = f_u(t_{n+1}), \\quad \\frac{u^{n+1}-u^n}{\\Delta t} = v^{n+1}.\n  $$\n  - Flow substep with updated $v^{n+1}$:\n  $$\n  \\frac{s}{\\Delta t}\\left(p^{n+1}-p^{n}\\right) + c\\, p^{n+1} + b\\, v^{n+1} = f_p(t_{n+1}).\n  $$\n\nDiscrete energy residual:\n- Define the discrete total energy at step $n$ by\n$$\nE^n = \\tfrac{1}{2} m (v^n)^2 + \\tfrac{1}{2} k (u^n)^2 + \\tfrac{1}{2} s (p^n)^2.\n$$\n- Define the per-step discrete energy residual\n$$\n\\mathcal{R}^{n+1} = \\left(E^{n+1} - E^n + \\Delta t\\, c\\, (p^{n+1})^2\\right) - \\Delta t\\left(v^{n+1} f_u(t_{n+1}) + p^{n+1} f_p(t_{n+1})\\right).\n$$\n- Compute the root-mean-square (RMS) residual over all steps:\n$$\n\\mathrm{RMS} = \\left(\\frac{1}{N}\\sum_{n=0}^{N-1} (\\mathcal{R}^{n+1})^2 \\right)^{1/2}.\n$$\n\nYour task:\n- Implement the above manufactured solution and both time-integration strategies, compute $\\mathcal{R}^{n+1}$ at each step, and report the RMS residual for each strategy and each test case.\n- Treat all quantities as nondimensional; no physical units are required.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element corresponds to one test case and is itself a two-element list of the RMS residuals for the monolithic and staggered schemes, in that order.\n\nTest suite:\n- Use the following parameter sets, covering a typical case, a refined time step case, and an uncoupled edge case:\n  - Case $1$: $m=1.0$, $k=20.0$, $b=3.0$, $s=0.5$, $c=1.0$, $A_u=0.8$, $A_p=1.1$, $\\omega=2.3$, $T=2.0$, $\\Delta t=0.05$.\n  - Case $2$: Same as Case $1$ but with $\\Delta t=0.01$.\n  - Case $3$: Same as Case $1$ but with $b=0.0$ and $\\Delta t=0.05$.\n\nFinal output format:\n- Your program should print exactly one line:\n- Example format: $[[r_{1,\\mathrm{mono}},r_{1,\\mathrm{stag}}],[r_{2,\\mathrm{mono}},r_{2,\\mathrm{stag}}],[r_{3,\\mathrm{mono}},r_{3,\\mathrm{stag}}]]$, where each $r$ is a floating-point number.",
            "solution": "The problem statement is assessed to be valid. It is scientifically grounded in the principles of computational poroelasticity, mathematically well-posed, and provides a complete and consistent set of definitions and parameters for a verifiable numerical experiment. The method of manufactured solutions is a standard code verification technique.\n\nThe task is to implement and compare two time integration strategies, monolithic and staggered, for a system of coupled ordinary differential equations representing a linearized, lumped-parameter model of poroelasticity. The system is given by:\n$$\nm \\ddot{u}(t) + k u(t) - b\\, p(t) = f_u(t)\n$$\n$$\ns \\dot{p}(t) + c\\, p(t) + b\\, \\dot{u}(t) = f_p(t)\n$$\nwhere $u(t)$ is displacement, $p(t)$ is pore pressure, and $\\dot{u}(t) = v(t)$ is velocity. The parameters $m$, $k$, $b$, $s$, $c$ are positive or non-negative constants representing mass, stiffness, coupling, storage, and flow dissipation, respectively. The forcing functions $f_u(t)$ and $f_p(t)$ are derived from a manufactured analytical solution of the form $u^\\star(t) = A_u \\sin(\\omega t)$ and $p^\\star(t) = A_p \\cos(\\omega t)$.\n\nWe will solve this system numerically over a time interval $[0, T]$ with a uniform time step $\\Delta t$, using first-order implicit (Backward Euler) time discretization for both strategies. The initial conditions are $u^0 = u^\\star(0) = 0$, $v^0 = \\dot{u}^\\star(0) = A_u \\omega$, and $p^0 = p^\\star(0) = A_p$.\n\nThe core of the analysis involves stepping from a known state $(u^n, v^n, p^n)$ at time $t_n$ to a new state $(u^{n+1}, v^{n+1}, p^{n+1})$ at time $t_{n+1} = t_n + \\Delta t$.\n\n**Monolithic Scheme**\n\nThis approach solves for all unknown fields at $t_{n+1}$ simultaneously. The discrete equations are:\n$$\n\\frac{m}{\\Delta t}\\left(v^{n+1}-v^n\\right) + k\\, u^{n+1} - b\\, p^{n+1} = f_u(t_{n+1})\n$$\n$$\ns \\frac{p^{n+1}-p^n}{\\Delta t} + c\\, p^{n+1} + b\\, v^{n+1} = f_p(t_{n+1})\n$$\n$$\nu^{n+1} = u^n + \\Delta t \\, v^{n+1}\n$$\nSubstituting the kinematic relation for $u^{n+1}$ into the first equation and rearranging, we obtain a $2 \\times 2$ linear system for the unknowns $(v^{n+1}, p^{n+1})$:\n$$\n\\begin{pmatrix}\n\\frac{m}{\\Delta t} + k \\Delta t  -b \\\\\nb  \\frac{s}{\\Delta t} + c\n\\end{pmatrix}\n\\begin{pmatrix}\nv^{n+1} \\\\\np^{n+1}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\nf_u(t_{n+1}) + \\frac{m}{\\Delta t}v^n - k u^n \\\\\nf_p(t_{n+1}) + \\frac{s}{\\Delta t}p^n\n\\end{pmatrix}\n$$\nThe determinant of the system matrix is $(\\frac{m}{\\Delta t} + k \\Delta t)(\\frac{s}{\\Delta t} + c) + b^2$. Given the problem constraints ($m, k, s, c, \\Delta t  0$ and $b \\ge 0$), this determinant is strictly positive, which guarantees a unique solution exists at every time step.\n\n**Staggered Scheme**\n\nThis partitioned approach solves the problem in two sequential substeps. First, the mechanics block is solved for $(u^{n+1}, v^{n+1})$ using the pressure from the previous step, $p^n$. Then, the flow block is solved for $p^{n+1}$ using the newly computed velocity $v^{n+1}$.\n\n1.  **Mechanics Substep**: Solve for $v^{n+1}$.\n    $$\n    \\frac{m}{\\Delta t}\\left(v^{n+1}-v^n\\right) + k\\, (u^n + \\Delta t v^{n+1}) - b\\, p^{n} = f_u(t_{n+1})\n    $$\n    This is rearranged to explicitly solve for $v^{n+1}$:\n    $$\n    v^{n+1} = \\frac{f_u(t_{n+1}) + \\frac{m}{\\Delta t}v^n - k u^n + b p^n}{\\frac{m}{\\Delta t} + k \\Delta t}\n    $$\n    Then, $u^{n+1}$ is updated: $u^{n+1} = u^n + \\Delta t v^{n+1}$.\n\n2.  **Flow Substep**: Solve for $p^{n+1}$ using the computed $v^{n+1}$.\n    $$\n    \\frac{s}{\\Delta t}\\left(p^{n+1}-p^{n}\\right) + c\\, p^{n+1} + b\\, v^{n+1} = f_p(t_{n+1})\n    $$\n    This is rearranged to explicitly solve for $p^{n+1}$:\n    $$\n    p^{n+1} = \\frac{f_p(t_{n+1}) + \\frac{s}{\\Delta t}p^n - b v^{n+1}}{\\frac{s}{\\Delta t} + c}\n    $$\nThis sequential procedure avoids a matrix solve, but introduces a lag in the coupling term, which affects the numerical stability and accuracy properties (though the implicit nature ensures stability for this problem).\n\n**Discrete Energy Residual Analysis**\n\nThe discrete energy residual $\\mathcal{R}^{n+1}$ serves to verify the energy conservation properties of the numerical schemes. The residual is defined as:\n$$\n\\mathcal{R}^{n+1} = \\left(E^{n+1} - E^n + \\Delta t\\, c\\, (p^{n+1})^2\\right) - \\Delta t\\left(v^{n+1} f_u(t_{n+1}) + p^{n+1} f_p(t_{n+1})\\right)\n$$\nwhere $E^n = \\frac{1}{2} m (v^n)^2 + \\frac{1}{2} k (u^n)^2 + \\frac{1}{2} s (p^n)^2$. This residual measures the extent to which the numerical scheme fails to satisfy the discrete power balance. By multiplying the discrete governing equations by suitable test functions ($\\Delta t v^{n+1}$ for momentum, $\\Delta t p^{n+1}$ for flow) and summing them, we find:\n- For the **monolithic** scheme, the residual is exactly the negative of the numerical dissipation introduced by the time-stepping algorithm:\n  $$\n  \\mathcal{R}^{n+1}_{\\text{mono}} = -\\left[ \\frac{1}{2}m(v^{n+1}-v^n)^2 + \\frac{1}{2}k(u^{n+1}-u^n)^2 + \\frac{1}{2}s(p^{n+1}-p^n)^2 \\right]\n  $$\n- For the **staggered** scheme, an additional term arises from the inconsistent treatment of coupling terms between substeps:\n  $$\n  \\mathcal{R}^{n+1}_{\\text{stag}} = \\mathcal{R}^{n+1}_{\\text{mono}} + b \\Delta t (p^{n+1} - p^n)v^{n+1}\n  $$\nFor a first-order scheme like Backward Euler, the solution error is $O(\\Delta t)$. Thus, increments like $(v^{n+1}-v^n)$ are $O(\\Delta t)$, making the terms in $\\mathcal{R}^{n+1}$ of order $O(\\Delta t^2)$. Consequently, the root-mean-square (RMS) residual is expected to scale as $O(\\Delta t^2)$. This will be verified by comparing Case $1$ ($\\Delta t = 0.05$) and Case $2$ ($\\Delta t=0.01$).\n\nA crucial check is Case $3$, where the coupling coefficient $b=0$. In this scenario, the governing equations decouple, and the monolithic and staggered schemes become mathematically identical. The implementation should reflect this, yielding identical RMS residuals for both strategies.\n\nThe solution is implemented in Python, following the logic outlined above. For each test case, the monolithic and staggered schemes are executed in sequence, their respective RMS residuals are calculated and stored.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the poroelastic coupling problem for the given test cases using\n    monolithic and staggered implicit schemes, and computes the RMS energy residual.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        {'m': 1.0, 'k': 20.0, 'b': 3.0, 's': 0.5, 'c': 1.0, 'Au': 0.8, 'Ap': 1.1, 'omega': 2.3, 'T': 2.0, 'dt': 0.05},\n        {'m': 1.0, 'k': 20.0, 'b': 3.0, 's': 0.5, 'c': 1.0, 'Au': 0.8, 'Ap': 1.1, 'omega': 2.3, 'T': 2.0, 'dt': 0.01},\n        {'m': 1.0, 'k': 20.0, 'b': 0.0, 's': 0.5, 'c': 1.0, 'Au': 0.8, 'Ap': 1.1, 'omega': 2.3, 'T': 2.0, 'dt': 0.05},\n    ]\n\n    all_results = []\n\n    for params in test_cases:\n        m, k, b, s, c = params['m'], params['k'], params['b'], params['s'], params['c']\n        Au, Ap, omega = params['Au'], params['Ap'], params['omega']\n        T, dt = params['T'], params['dt']\n\n        N = int(T / dt)\n        \n        # Manufactured analytical solution and its derivatives\n        u_star = lambda t: Au * np.sin(omega * t)\n        p_star = lambda t: Ap * np.cos(omega * t)\n        udot_star = lambda t: Au * omega * np.cos(omega * t)\n        uddot_star = lambda t: -Au * omega**2 * np.sin(omega * t)\n        pdot_star = lambda t: -Ap * omega * np.sin(omega * t)\n\n        # Manufactured forcing functions based on the analytical solution\n        f_u = lambda t: m * uddot_star(t) + k * u_star(t) - b * p_star(t)\n        f_p = lambda t: s * pdot_star(t) + c * p_star(t) + b * udot_star(t)\n\n        case_results = []\n\n        # --- Solve using Monolithic Scheme ---\n        u_mono = np.zeros(N + 1)\n        v_mono = np.zeros(N + 1)\n        p_mono = np.zeros(N + 1)\n\n        u_mono[0] = u_star(0.0)\n        v_mono[0] = udot_star(0.0)\n        p_mono[0] = p_star(0.0)\n\n        residuals_sq_mono = []\n\n        A_mono = np.array([\n            [m/dt + k*dt, -b],\n            [b, s/dt + c]\n        ])\n\n        for n in range(N):\n            t_next = (n + 1) * dt\n            \n            B_mono = np.array([\n                f_u(t_next) + (m/dt) * v_mono[n] - k * u_mono[n],\n                f_p(t_next) + (s/dt) * p_mono[n]\n            ])\n\n            v_next, p_next = np.linalg.solve(A_mono, B_mono)\n            u_next = u_mono[n] + dt * v_next\n            \n            u_mono[n+1], v_mono[n+1], p_mono[n+1] = u_next, v_next, p_next\n\n            E_n = 0.5 * m * v_mono[n]**2 + 0.5 * k * u_mono[n]**2 + 0.5 * s * p_mono[n]**2\n            E_n1 = 0.5 * m * v_next**2 + 0.5 * k * u_next**2 + 0.5 * s * p_next**2\n            work = dt * (v_next * f_u(t_next) + p_next * f_p(t_next))\n            dissipation = dt * c * p_next**2\n            \n            residual = (E_n1 - E_n + dissipation) - work\n            residuals_sq_mono.append(residual**2)\n            \n        rms_mono = np.sqrt(np.mean(residuals_sq_mono))\n        case_results.append(rms_mono)\n\n        # --- Solve using Staggered Scheme ---\n        u_stag = np.zeros(N + 1)\n        v_stag = np.zeros(N + 1)\n        p_stag = np.zeros(N + 1)\n\n        u_stag[0] = u_star(0.0)\n        v_stag[0] = udot_star(0.0)\n        p_stag[0] = p_star(0.0)\n\n        residuals_sq_stag = []\n\n        coeff_v = m/dt + k*dt\n        coeff_p = s/dt + c\n        \n        for n in range(N):\n            t_next = (n + 1) * dt\n            \n            # Mechanics substep\n            rhs_v = f_u(t_next) + (m/dt) * v_stag[n] - k * u_stag[n] + b * p_stag[n]\n            v_next = rhs_v / coeff_v\n            u_next = u_stag[n] + dt * v_next\n\n            # Flow substep\n            rhs_p = f_p(t_next) + (s/dt) * p_stag[n] - b * v_next\n            p_next = rhs_p / coeff_p\n            \n            u_stag[n+1], v_stag[n+1], p_stag[n+1] = u_next, v_next, p_next\n\n            E_n = 0.5 * m * v_stag[n]**2 + 0.5 * k * u_stag[n]**2 + 0.5 * s * p_stag[n]**2\n            E_n1 = 0.5 * m * v_next**2 + 0.5 * k * u_next**2 + 0.5 * s * p_next**2\n            work = dt * (v_next * f_u(t_next) + p_next * f_p(t_next))\n            dissipation = dt * c * p_next**2\n\n            residual = (E_n1 - E_n + dissipation) - work\n            residuals_sq_stag.append(residual**2)\n\n        rms_stag = np.sqrt(np.mean(residuals_sq_stag))\n        case_results.append(rms_stag)\n        \n        all_results.append(case_results)\n\n    # Format the final list of results into the required string format.\n    formatted_results = [f\"[{r[0]},{r[1]}]\" for r in all_results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}