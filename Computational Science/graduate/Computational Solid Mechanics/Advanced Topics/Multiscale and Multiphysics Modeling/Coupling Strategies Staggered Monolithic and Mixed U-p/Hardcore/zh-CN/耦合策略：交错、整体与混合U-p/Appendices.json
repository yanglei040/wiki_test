{
    "hands_on_practices": [
        {
            "introduction": "在开发任何耦合问题的数值模拟程序时，首要任务是验证其实现的正确性。本实践将引导你使用“制造解方法”(Method of Manufactured Solutions, MMS)，这是一种强大的代码验证技术，用于检验你的程序是否能够精确地复现一个已知的解析解。通过对一个简化的多孔弹性模型实施整体式（monolithic）和交错式（staggered）两种时间积分策略，你将学会如何量化离散能量平衡，并评估不同耦合方案对能量守恒特性的影响。",
            "id": "3555626",
            "problem": "考虑一个在计算固体力学中抽象了一维线性化孔隙弹性耦合的集总混合位移-压力模型。令 $u(t)$ 表示位移，$v(t) = \\dot{u}(t)$ 表示速度，$p(t)$ 表示孔隙压力。假设控制方程遵循牛顿第二定律以及带耗散的线性存储和流动，由以下公式给出：\n$$\nm \\ddot{u}(t) + k u(t) - b\\, p(t) = f_u(t),\n$$\n$$\ns \\dot{p}(t) + c\\, p(t) + b\\, \\dot{u}(t) = f_p(t),\n$$\n其中 $m>0$ 是质量，$k>0$ 是弹性刚度，$b\\ge 0$ 是耦合系数，$s>0$ 是存储系数，$c\\ge 0$ 是流动耗散系数，$f_u(t)$ 和 $f_p(t)$ 是外部施加的广义力。将所有量视为无量纲；不需要物理单位。\n\n您需要构造一个精确解 $(u^\\star(t), p^\\star(t))$ 及相应的右端项 $(f_u(t), f_p(t))$，使得 $(u^\\star, p^\\star)$ 精确满足连续方程。然后，对于两种耦合策略——整体式和交错式——使用隐式一阶时间离散化，您将计算一个时间区间上的离散能量残差，并验证其保持在截断误差范围内。\n\n构造解与强迫项：\n- 令\n$$\nu^\\star(t) = A_u \\sin(\\omega t), \\quad p^\\star(t) = A_p \\cos(\\omega t),\n$$\n其中常数 $A_u>0$，$A_p>0$，$\\omega>0$。\n- 定义\n$$\n\\dot{u}^\\star(t) = A_u \\omega \\cos(\\omega t), \\quad \\ddot{u}^\\star(t) = -A_u \\omega^2 \\sin(\\omega t), \\quad \\dot{p}^\\star(t) = -A_p \\omega \\sin(\\omega t).\n$$\n- 通过将精确解代入连续方程来定义构造的强迫项：\n$$\nf_u(t) = m \\ddot{u}^\\star(t) + k u^\\star(t) - b\\, p^\\star(t),\n$$\n$$\nf_p(t) = s \\dot{p}^\\star(t) + c\\, p^\\star(t) + b\\, \\dot{u}^\\star(t).\n$$\n\n均匀时间网格上的离散格式：\n- 设时间网格为 $t_n = n \\Delta t$，对于 $n=0,1,\\dots,N$，其中 $N = \\lfloor T/\\Delta t \\rfloor$。初始化 $u^0 = u^\\star(0)$，$v^0 = \\dot{u}^\\star(0)$，$p^0 = p^\\star(0)$。\n- 整体式隐式格式（在时间 $t_{n+1}$ 求解所有场）：\n  - 对演化和运动学使用后向欧拉法（BE）：\n  $$\n  \\frac{m}{\\Delta t}\\left(v^{n+1}-v^n\\right) + k\\, u^{n+1} - b\\, p^{n+1} = f_u(t_{n+1}),\n  $$\n  $$\n  \\frac{u^{n+1}-u^n}{\\Delta t} = v^{n+1},\n  $$\n  $$\n  \\frac{s}{\\Delta t}\\left(p^{n+1}-p^n\\right) + c\\, p^{n+1} + b\\, v^{n+1} = f_p(t_{n+1}).\n  $$\n- 交错式隐式格式（在时间 $t_{n+1}$ 进行分区更新）：\n  - 使用滞后压力 $p$ 的力学子步：\n  $$\n  \\frac{m}{\\Delta t}\\left(v^{n+1}-v^n\\right) + k\\, u^{n+1} - b\\, p^{n} = f_u(t_{n+1}), \\quad \\frac{u^{n+1}-u^n}{\\Delta t} = v^{n+1}.\n  $$\n  - 使用更新后的 $v^{n+1}$ 的流动子步：\n  $$\n  \\frac{s}{\\Delta t}\\left(p^{n+1}-p^{n}\\right) + c\\, p^{n+1} + b\\, v^{n+1} = f_p(t_{n+1}).\n  $$\n\n离散能量残差：\n- 将第 $n$ 步的离散总能量定义为\n$$\nE^n = \\tfrac{1}{2} m (v^n)^2 + \\tfrac{1}{2} k (u^n)^2 + \\tfrac{1}{2} s (p^n)^2.\n$$\n- 定义每步的离散能量残差\n$$\n\\mathcal{R}^{n+1} = \\left(E^{n+1} - E^n + \\Delta t\\, c\\, (p^{n+1})^2\\right) - \\Delta t\\left(v^{n+1} f_u(t_{n+1}) + p^{n+1} f_p(t_{n+1})\\right).\n$$\n- 计算所有步骤的均方根（RMS）残差：\n$$\n\\mathrm{RMS} = \\left(\\frac{1}{N}\\sum_{n=0}^{N-1} (\\mathcal{R}^{n+1})^2 \\right)^{1/2}.\n$$\n\n您的任务：\n- 实现上述构造解和两种时间积分策略，计算每一步的 $\\mathcal{R}^{n+1}$，并报告每种策略和每种测试情况下的 RMS 残差。\n- 将所有量视为无量纲；不需要物理单位。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个元素对应一个测试用例，并且本身是一个包含整体式和交错式方案的 RMS 残差（按此顺序）的双元素列表。\n\n测试套件：\n- 使用以下参数集，涵盖一个典型情况、一个细化时间步长情况和一个解耦边界情况：\n  - 情况 $1$：$m=1.0$, $k=20.0$, $b=3.0$, $s=0.5$, $c=1.0$, $A_u=0.8$, $A_p=1.1$, $\\omega=2.3$, $T=2.0$, $\\Delta t=0.05$。\n  - 情况 $2$：与情况 $1$ 相同，但 $\\Delta t=0.01$。\n  - 情况 $3$：与情况 $1$ 相同，但 $b=0.0$ 且 $\\Delta t=0.05$。\n\n最终输出格式：\n- 您的程序应精确打印一行：\n- 示例格式：$[[r_{1,\\mathrm{mono}},r_{1,\\mathrm{stag}}],[r_{2,\\mathrm{mono}},r_{2,\\mathrm{stag}}],[r_{3,\\mathrm{mono}},r_{3,\\mathrm{stag}}]]$，其中每个 $r$ 是一个浮点数。",
            "solution": "经评估，问题陈述是有效的。它在科学上基于计算孔隙弹性力学的原理，数学上是适定的，并为可验证的数值实验提供了一套完整且一致的定义和参数。构造解方法是一种标准的代码验证技术。\n\n任务是为一个表示线性化集总参数孔隙弹性模型的耦合常微分方程组，实现并比较两种时间积分策略：整体式和交错式。该系统由以下方程给出：\n$$\nm \\ddot{u}(t) + k u(t) - b\\, p(t) = f_u(t)\n$$\n$$\ns \\dot{p}(t) + c\\, p(t) + b\\, \\dot{u}(t) = f_p(t)\n$$\n其中 $u(t)$ 是位移，$p(t)$ 是孔隙压力，$\\dot{u}(t) = v(t)$ 是速度。参数 $m$、$k$、$b$、$s$、$c$ 是分别表示质量、刚度、耦合、存储和流动耗散的正常数或非负常数。强迫函数 $f_u(t)$ 和 $f_p(t)$ 是从形式为 $u^\\star(t) = A_u \\sin(\\omega t)$ 和 $p^\\star(t) = A_p \\cos(\\omega t)$ 的构造解析解中导出的。\n\n我们将使用一阶隐式（后向欧拉）时间离散化策略，在时间区间 $[0, T]$ 上以均匀时间步长 $\\Delta t$ 对此系统进行数值求解。初始条件为 $u^0 = u^\\star(0) = 0$，$v^0 = \\dot{u}^\\star(0) = A_u \\omega$ 和 $p^0 = p^\\star(0) = A_p$。\n\n分析的核心在于从时间 $t_n$ 的已知状态 $(u^n, v^n, p^n)$ 推进到时间 $t_{n+1} = t_n + \\Delta t$ 的新状态 $(u^{n+1}, v^{n+1}, p^{n+1})$。\n\n**整体式格式**\n\n此方法同时求解在 $t_{n+1}$ 时的所有未知场。离散方程为：\n$$\n\\frac{m}{\\Delta t}\\left(v^{n+1}-v^n\\right) + k\\, u^{n+1} - b\\, p^{n+1} = f_u(t_{n+1})\n$$\n$$\ns \\frac{p^{n+1}-p^n}{\\Delta t} + c\\, p^{n+1} + b\\, v^{n+1} = f_p(t_{n+1})\n$$\n$$\nu^{n+1} = u^n + \\Delta t \\, v^{n+1}\n$$\n将运动学关系式 $u^{n+1}$ 代入第一个方程并重新整理，我们得到了一个关于未知数 $(v^{n+1}, p^{n+1})$ 的 $2 \\times 2$ 线性系统：\n$$\n\\begin{pmatrix}\n\\frac{m}{\\Delta t} + k \\Delta t  & -b \\\\\nb  & \\frac{s}{\\Delta t} + c\n\\end{pmatrix}\n\\begin{pmatrix}\nv^{n+1} \\\\\np^{n+1}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\nf_u(t_{n+1}) + \\frac{m}{\\Delta t}v^n - k u^n \\\\\nf_p(t_{n+1}) + \\frac{s}{\\Delta t}p^n\n\\end{pmatrix}\n$$\n该系统矩阵的行列式为 $(\\frac{m}{\\Delta t} + k \\Delta t)(\\frac{s}{\\Delta t} + c) + b^2$。鉴于问题的约束条件（$m, k, s, c, \\Delta t > 0$ 和 $b \\ge 0$），该行列式严格为正，这保证了在每个时间步都存在唯一解。\n\n**交错式格式**\n\n这种分区方法通过两个连续的子步来解决问题。首先，使用前一步的压力 $p^n$ 求解力学块以得到 $(u^{n+1}, v^{n+1})$。然后，使用新计算出的速度 $v^{n+1}$ 求解流动块以得到 $p^{n+1}$。\n\n1.  **力学子步**：求解 $v^{n+1}$。\n    $$\n    \\frac{m}{\\Delta t}\\left(v^{n+1}-v^n\\right) + k\\, (u^n + \\Delta t v^{n+1}) - b\\, p^{n} = f_u(t_{n+1})\n    $$\n    整理后可显式求解 $v^{n+1}$：\n    $$\n    v^{n+1} = \\frac{f_u(t_{n+1}) + \\frac{m}{\\Delta t}v^n - k u^n + b p^n}{\\frac{m}{\\Delta t} + k \\Delta t}\n    $$\n    然后，更新 $u^{n+1}$：$u^{n+1} = u^n + \\Delta t v^{n+1}$。\n\n2.  **流动子步**：使用已计算的 $v^{n+1}$ 求解 $p^{n+1}$。\n    $$\n    \\frac{s}{\\Delta t}\\left(p^{n+1}-p^{n}\\right) + c\\, p^{n+1} + b\\, v^{n+1} = f_p(t_{n+1})\n    $$\n    整理后可显式求解 $p^{n+1}$：\n    $$\n    p^{n+1} = \\frac{f_p(t_{n+1}) + \\frac{s}{\\Delta t}p^n - b v^{n+1}}{\\frac{s}{\\Delta t} + c}\n    $$\n这种顺序过程避免了矩阵求解，但在耦合项中引入了滞后，这会影响数值稳定性和精度特性（尽管对于本问题，其隐式性质确保了稳定性）。\n\n**离散能量残差分析**\n\n离散能量残差 $\\mathcal{R}^{n+1}$ 用于验证数值格式的能量守恒特性。残差定义为：\n$$\n\\mathcal{R}^{n+1} = \\left(E^{n+1} - E^n + \\Delta t\\, c\\, (p^{n+1})^2\\right) - \\Delta t\\left(v^{n+1} f_u(t_{n+1}) + p^{n+1} f_p(t_{n+1})\\right)\n$$\n其中 $E^n = \\frac{1}{2} m (v^n)^2 + \\frac{1}{2} k (u^n)^2 + \\frac{1}{2} s (p^n)^2$。该残差衡量了数值格式未能满足离散功率平衡的程度。通过将离散控制方程乘以合适的测试函数（动量方程乘以 $\\Delta t v^{n+1}$，流动方程乘以 $\\Delta t p^{n+1}$）并求和，我们发现：\n- 对于**整体式**格式，残差恰好是时间步进算法引入的数值耗散的负值：\n  $$\n  \\mathcal{R}^{n+1}_{\\text{mono}} = -\\left[ \\frac{1}{2}m(v^{n+1}-v^n)^2 + \\frac{1}{2}k(u^{n+1}-u^n)^2 + \\frac{1}{2}s(p^{n+1}-p^n)^2 \\right]\n  $$\n- 对于**交错式**格式，由于子步间耦合项处理不一致，会产生一个附加项：\n  $$\n  \\mathcal{R}^{n+1}_{\\text{stag}} = \\mathcal{R}^{n+1}_{\\text{mono}} - b \\Delta t (p^{n+1} - p^n)v^{n+1}\n  $$\n对于像后向欧拉法这样的一阶格式，解的误差是 $O(\\Delta t)$。因此，像 $(v^{n+1}-v^n)$ 这样的增量是 $O(\\Delta t)$，使得 $\\mathcal{R}^{n+1}$ 中的项为 $O(\\Delta t^2)$ 阶。因此，均方根（RMS）残差预计将按 $O(\\Delta t^2)$ 比例缩放。这将通过比较情况 1（$\\Delta t = 0.05$）和情况 2（$\\Delta t=0.01$）来验证。\n\n一个关键的检验是情况 3，其中耦合系数 $b=0$。在这种情况下，控制方程解耦，整体式和交错式格式在数学上变得相同。实现应反映这一点，为两种策略得出相同的 RMS 残差。\n\n该解法在 Python 中实现，遵循上述逻辑。对于每个测试用例，依次执行整体式和交错式格式，计算并存储它们各自的 RMS 残差。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the poroelastic coupling problem for the given test cases using\n    monolithic and staggered implicit schemes, and computes the RMS energy residual.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        {'m': 1.0, 'k': 20.0, 'b': 3.0, 's': 0.5, 'c': 1.0, 'Au': 0.8, 'Ap': 1.1, 'omega': 2.3, 'T': 2.0, 'dt': 0.05},\n        {'m': 1.0, 'k': 20.0, 'b': 3.0, 's': 0.5, 'c': 1.0, 'Au': 0.8, 'Ap': 1.1, 'omega': 2.3, 'T': 2.0, 'dt': 0.01},\n        {'m': 1.0, 'k': 20.0, 'b': 0.0, 's': 0.5, 'c': 1.0, 'Au': 0.8, 'Ap': 1.1, 'omega': 2.3, 'T': 2.0, 'dt': 0.05},\n    ]\n\n    all_results = []\n\n    for params in test_cases:\n        m, k, b, s, c = params['m'], params['k'], params['b'], params['s'], params['c']\n        Au, Ap, omega = params['Au'], params['Ap'], params['omega']\n        T, dt = params['T'], params['dt']\n\n        N = int(T / dt)\n        \n        # Manufactured analytical solution and its derivatives\n        u_star = lambda t: Au * np.sin(omega * t)\n        p_star = lambda t: Ap * np.cos(omega * t)\n        udot_star = lambda t: Au * omega * np.cos(omega * t)\n        uddot_star = lambda t: -Au * omega**2 * np.sin(omega * t)\n        pdot_star = lambda t: -Ap * omega * np.sin(omega * t)\n\n        # Manufactured forcing functions based on the analytical solution\n        f_u = lambda t: m * uddot_star(t) + k * u_star(t) - b * p_star(t)\n        f_p = lambda t: s * pdot_star(t) + c * p_star(t) + b * udot_star(t)\n\n        case_results = []\n\n        # --- Solve using Monolithic Scheme ---\n        u_mono = np.zeros(N + 1)\n        v_mono = np.zeros(N + 1)\n        p_mono = np.zeros(N + 1)\n\n        u_mono[0] = u_star(0.0)\n        v_mono[0] = udot_star(0.0)\n        p_mono[0] = p_star(0.0)\n\n        residuals_sq_mono = []\n\n        A_mono = np.array([\n            [m/dt + k*dt, -b],\n            [b, s/dt + c]\n        ])\n\n        for n in range(N):\n            t_next = (n + 1) * dt\n            \n            B_mono = np.array([\n                f_u(t_next) + (m/dt) * v_mono[n] - k * u_mono[n],\n                f_p(t_next) + (s/dt) * p_mono[n]\n            ])\n\n            v_next, p_next = np.linalg.solve(A_mono, B_mono)\n            u_next = u_mono[n] + dt * v_next\n            \n            u_mono[n+1], v_mono[n+1], p_mono[n+1] = u_next, v_next, p_next\n\n            E_n = 0.5 * m * v_mono[n]**2 + 0.5 * k * u_mono[n]**2 + 0.5 * s * p_mono[n]**2\n            E_n1 = 0.5 * m * v_next**2 + 0.5 * k * u_next**2 + 0.5 * s * p_next**2\n            work = dt * (v_next * f_u(t_next) + p_next * f_p(t_next))\n            dissipation = dt * c * p_next**2\n            \n            residual = (E_n1 - E_n + dissipation) - work\n            residuals_sq_mono.append(residual**2)\n            \n        rms_mono = np.sqrt(np.mean(residuals_sq_mono))\n        case_results.append(rms_mono)\n\n        # --- Solve using Staggered Scheme ---\n        u_stag = np.zeros(N + 1)\n        v_stag = np.zeros(N + 1)\n        p_stag = np.zeros(N + 1)\n\n        u_stag[0] = u_star(0.0)\n        v_stag[0] = udot_star(0.0)\n        p_stag[0] = p_star(0.0)\n\n        residuals_sq_stag = []\n\n        coeff_v = m/dt + k*dt\n        coeff_p = s/dt + c\n        \n        for n in range(N):\n            t_next = (n + 1) * dt\n            \n            # Mechanics substep\n            rhs_v = f_u(t_next) + (m/dt) * v_stag[n] - k * u_stag[n] + b * p_stag[n]\n            v_next = rhs_v / coeff_v\n            u_next = u_stag[n] + dt * v_next\n\n            # Flow substep\n            rhs_p = f_p(t_next) + (s/dt) * p_stag[n] - b * v_next\n            p_next = rhs_p / coeff_p\n            \n            u_stag[n+1], v_stag[n+1], p_stag[n+1] = u_next, v_next, p_next\n\n            E_n = 0.5 * m * v_stag[n]**2 + 0.5 * k * u_stag[n]**2 + 0.5 * s * p_stag[n]**2\n            E_n1 = 0.5 * m * v_next**2 + 0.5 * k * u_next**2 + 0.5 * s * p_next**2\n            work = dt * (v_next * f_u(t_next) + p_next * f_p(t_next))\n            dissipation = dt * c * p_next**2\n\n            residual = (E_n1 - E_n + dissipation) - work\n            residuals_sq_stag.append(residual**2)\n\n        rms_stag = np.sqrt(np.mean(residuals_sq_stag))\n        case_results.append(rms_stag)\n        \n        all_results.append(case_results)\n\n    # Format the final list of results into the required string format.\n    formatted_results = [f\"[{r[0]},{r[1]}]\" for r in all_results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在验证了基本实现之后，我们深入探讨混合 $u\\text{-}p$ 公式中一个更为微妙且关键的问题：数值稳定性。许多混合有限元方法，特别是使用等阶插值时，容易产生非物理的“伪压力模式”（spurious pressure modes），导致数值解的严重失真。本实践通过构建一个明确包含伪压力模式的规范代数系统，让你能够直观地比较整体式和交错式耦合策略在抑制这些不稳定模式方面的表现。",
            "id": "3555606",
            "problem": "考虑一维空间中的准静态线性Biot多孔力学模型，采用混合位移-压力公式进行离散化。令 $u$ 表示位移向量，$p$ 表示孔隙压力向量。在代数层面，未知增量 $(\\Delta u, \\Delta p)$ 的整体线性化系统可以写成如下块形式：\n$$\n\\begin{bmatrix}\nK  -\\alpha B^{\\top} \\\\\n\\alpha B  C + D\n\\end{bmatrix}\n\\begin{bmatrix}\n\\Delta u \\\\\n\\Delta p\n\\end{bmatrix}\n=\n\\begin{bmatrix}\nr_u \\\\\nr_p\n\\end{bmatrix},\n$$\n其中，$K \\in \\mathbb{R}^{n_u \\times n_u}$ 是对称正定的弹性刚度矩阵，$B \\in \\mathbb{R}^{n_p \\times n_u}$ 是离散体积耦合算子，$C \\in \\mathbb{R}^{n_p \\times n_p}$ 是对称正定的储水矩阵（已按时间步长缩放），$D \\in \\mathbb{R}^{n_p \\times n_p}$ 是对称半正定的流动扩散矩阵，$\\alpha \\in \\mathbb{R}$ 是Biot系数。在本问题中，采用典型的简化 $D = 0$ 来分离力学-压力耦合。在代数设置中，所有量都是无量纲的，输出不需要进行物理单位转换。\n\n作用于压力增量上的典型Schur补算子由下式给出：\n$$\nS = C + \\alpha^2 B K^{-1} B^{\\top} \\in \\mathbb{R}^{n_p \\times n_p}.\n$$\n在混合位移-压力公式中，伪压力模式与耦合项 $B K^{-1} B^{\\top}$ 的近零空间中的离散向量相关，这通常是由于对位移和压力使用等阶插值时违反了Ladyzhenskaya-Babuška-Brezzi（LBB）inf-sup稳定性条件。揭示此类模式的一种典型方法是研究特征值问题\n$$\nS \\, \\varphi = \\lambda \\, \\varphi,\n$$\n并识别那些特征值 $\\lambda$ 与谱中其他值相比异常小的特征向量 $\\varphi$。\n\n固定应力分区（交错）格式执行一次力学更新（压力保持不变），然后执行一次带有稳定化体积项的流动更新。对于一个具有精确力学步和通过在储水项中添加稳定化项 $\\tau I$ 进行预处理的流动步的线性系统，压力增量的线性误差传播算子可以建模为\n$$\nG = I - (C + \\tau I)^{-1} S,\n$$\n其中 $I$ 是单位矩阵，$\\tau \\in \\mathbb{R}$ 是一个正的稳定化参数，用于近似排水体积贡献（固定应力切线）。在一次交错迭代下，模式 $\\varphi$ 的放大由 $G$ 沿着 $\\varphi$ 的瑞利商来表征，即\n$$\n\\rho(\\varphi) = \\frac{\\varphi^{\\top} G \\, \\varphi}{\\varphi^{\\top} \\varphi}.\n$$\n对于具有精确切线和直接求解的整体耦合，迭代次数为1，并且沿任何特征模式的线性残差都被消除，因此沿任何模式的有效单步放大因子取为 $0$。\n\n您的任务是构建一个可证明存在伪压力模式的典型离散系统，然后量化整体精确切线方法与交错固定应力分裂方法相比如何抑制此模式。\n\n实现以下步骤：\n\n1. 定义 $n_u = 4$ 个位移自由度和 $n_p = 4$ 个压力自由度。令弹性矩阵为 $K = k_u I$（其中 $k_u > 0$），储水矩阵为 $C = c I$（其中 $c > 0$）。选择耦合算子 $B \\in \\mathbb{R}^{4 \\times 4}$ 为\n   $$\n   B =\n   \\begin{bmatrix}\n   1  0  0  1 \\\\\n   1  0  1  0 \\\\\n   0  1  1  0 \\\\\n   0  1  0  1\n   \\end{bmatrix},\n   $$\n   以及候选伪压力模式 $\\varphi_{\\mathrm{alt}} = [1, -1, 1, -1]^{\\top}$。\n\n2. 构建Schur补 $S = C + \\alpha^2 B K^{-1} B^{\\top}$ 并求解特征值问题 $S \\varphi = \\lambda \\varphi$。提取最小特征值 $\\lambda_{\\min}$ 作为伪压力模式严重性的代表。评估 $G$ 沿 $\\varphi_{\\mathrm{alt}}$ 的瑞利商，以量化固定应力分裂下的放大因子。报告该模式的整体放大因子为 $0$。\n\n3. 使用以下参数集测试套件，该套件探索了典型情况、近不可压缩储水（边界情况）、强稳定化和弱稳定化：\n   - 测试用例1（一般情况）：$\\alpha = 1.0$, $k_u = 1.0$, $c = 10^{-3}$, $\\tau = 10^{-2}$。\n   - 测试用例2（近不可压缩储水和弱稳定化）：$\\alpha = 1.0$, $k_u = 1.0$, $c = 10^{-8}$, $\\tau = 10^{-2}$。\n   - 测试用例3（近不可压缩储水和强稳定化）：$\\alpha = 1.0$, $k_u = 1.0$, $c = 10^{-8}$, $\\tau = 1.0$。\n   - 测试用例4（一般储水和极弱稳定化）：$\\alpha = 1.0$, $k_u = 1.0$, $c = 10^{-3}$, $\\tau = 10^{-6}$。\n\n4. 对于每个测试用例，计算并收集三个输出：\n   - $S$ 的最小特征值 $\\lambda_{\\min}$（一个浮点数）。\n   - 沿 $\\varphi_{\\mathrm{alt}}$ 的固定应力放大因子，即 $G$ 的瑞利商 $\\rho(\\varphi_{\\mathrm{alt}})$（一个浮点数）。\n   - 沿 $\\varphi_{\\mathrm{alt}}$ 的整体放大因子，为 $0$（一个浮点数）。\n\n您的程序应生成单行输出，其中包含按测试套件顺序排列的结果，以逗号分隔并用方括号括起来，将每个测试用例的三个输出聚合到一个扁平列表中。例如，输出格式为\n$$\n[\\lambda_{\\min}^{(1)}, \\rho^{(1)}, 0, \\lambda_{\\min}^{(2)}, \\rho^{(2)}, 0, \\lambda_{\\min}^{(3)}, \\rho^{(3)}, 0, \\lambda_{\\min}^{(4)}, \\rho^{(4)}, 0].\n$$\n输出中不需要物理单位；所有值都是无量纲的浮点数。不涉及角度。使用编程语言的默认数值表示法表示所有浮点数。",
            "solution": "问题陈述被认为是有效的。它在科学上基于计算多孔介质力学理论，问题提法得当、客观，并为可解的数值实验提供了一套完整且一致的定义和参数。\n\n任务是分析在存在伪压力模式的情况下，Biot方程混合位移-压力公式的稳定性。我们将比较整体直接求解器与分区（交错）固定应力迭代格式的行为。问题提供了一个特定的离散系统，其设计旨在展现一个已知的伪压力模式。\n\n所考虑的代数系统是线性化的准静态Biot系统，通过设置扩散矩阵 $D=0$ 进行了简化：\n$$\n\\begin{bmatrix}\nK  & -\\alpha B^{\\top} \\\\\n\\alpha B  & C\n\\end{bmatrix}\n\\begin{bmatrix}\n\\Delta u \\\\\n\\Delta p\n\\end{bmatrix}\n=\n\\begin{bmatrix}\nr_u \\\\\nr_p\n\\end{bmatrix}\n$$\n在此，$K$ 是弹性刚度矩阵，$C$ 是储水矩阵，$B$ 是耦合算子，$\\alpha$ 是Biot系数。维度为位移 $n_u=4$ 和压力 $n_p=4$。矩阵被赋予了特定的简化形式：$K = k_u I$ 和 $C = c I$，其中 $I$ 是 $4 \\times 4$ 的单位矩阵。\n\n研究的一个关键对象是Schur补算子 $S$，它通过从系统中消去位移增量 $\\Delta u$ 而产生：\n$$\nS = C + \\alpha^2 B K^{-1} B^{\\top}\n$$\n$S$ 的特征值表征了耦合系统的稳定性和条件数。伪压力模式是与异常小的特征值相关的 $S$ 的特征向量，通常源于选择的有限元空间不满足Ladyzhenskaya-Babuška-Brezzi (LBB) inf-sup条件。这些模式对应于耦合项 $B K^{-1} B^{\\top}$ 的近零空间中的向量。\n\n问题定义了一个特定的耦合矩阵 $B$ 和一个候选伪模式 $\\varphi_{\\mathrm{alt}}$：\n$$\nB =\n\\begin{bmatrix}\n1  0  0  1 \\\\\n1  0  1  0 \\\\\n0  1  1  0 \\\\\n0  1  0  1\n\\end{bmatrix},\n\\quad\n\\varphi_{\\mathrm{alt}} =\n\\begin{bmatrix}\n1 \\\\ -1 \\\\ 1 \\\\ -1\n\\end{bmatrix}\n$$\n我们可以通过检查 $\\varphi_{\\mathrm{alt}}$ 与 $B^{\\top}$ 的关系来验证它是一个伪模式。直接计算表明 $B^{\\top} \\varphi_{\\mathrm{alt}} = 0$，这意味着 $\\varphi_{\\mathrm{alt}}$ 位于 $B^{\\top}$ 的零空间中。这是一个“棋盘格”压力模式的特征，该模式不能通过耦合算子 $B$ 被位移场“看到”。\n\n因此，对于此模式 $\\varphi_{\\mathrm{alt}}$，Schur补的力学部分的作用为零：\n$$\n(\\alpha^2 B K^{-1} B^{\\top}) \\varphi_{\\mathrm{alt}} = \\alpha^2 B K^{-1} (B^{\\top} \\varphi_{\\mathrm{alt}}) = 0\n$$\n将完整的Schur补算子 $S$ 应用于 $\\varphi_{\\mathrm{alt}}$ 得到：\n$$\nS \\varphi_{\\mathrm{alt}} = (C + \\alpha^2 B K^{-1} B^{\\top}) \\varphi_{\\mathrm{alt}} = C \\varphi_{\\mathrm{alt}} + 0 = (cI) \\varphi_{\\mathrm{alt}} = c \\varphi_{\\mathrm{alt}}\n$$\n这表明 $\\varphi_{\\mathrm{alt}}$ 是 $S$ 的一个特征向量，其特征值为 $\\lambda = c$。由于矩阵 $\\alpha^2 B K^{-1} B^{\\top} = (\\alpha^2/k_u) B B^{\\top}$ 是对称半正定的（其特征值为非负），$S$ 的所有特征值都大于或等于 $c$。因此，$\\lambda=c$ 是 $S$ 的最小特征值，即 $\\lambda_{\\min}=c$。这个特征值很小（对于小的储水系数 $c$）是不稳定性的标志。\n\n整体求解方案直接求解完整系统。在线性情况下，这等同于一个消除残差的单一步骤，因此任何模式的放大因子都为 $0$。\n\n固定应力交错格式迭代地求解系统。误差的放大由误差传播算子 $G = I - (C + \\tau I)^{-1} S$ 控制，其中 $\\tau$ 是一个稳定化参数。我们必须通过计算瑞利商 $\\rho(\\varphi_{\\mathrm{alt}})$ 来量化模式 $\\varphi_{\\mathrm{alt}}$ 的放大。\n由于 $\\varphi_{\\mathrm{alt}}$ 是 $S$ 的特征值为 $c$ 的特征向量，它也是 $G$ 的一个特征向量：\n$$\nG \\varphi_{\\mathrm{alt}} = (I - (C + \\tau I)^{-1} S) \\varphi_{\\mathrm{alt}} = \\varphi_{\\mathrm{alt}} - ( (c+\\tau)I )^{-1} (c \\varphi_{\\mathrm{alt}}) = \\varphi_{\\mathrm{alt}} - \\frac{c}{c+\\tau} \\varphi_{\\mathrm{alt}} = \\left(1 - \\frac{c}{c+\\tau}\\right) \\varphi_{\\mathrm{alt}} = \\frac{\\tau}{c+\\tau} \\varphi_{\\mathrm{alt}}\n$$\n因此，放大因子，即对应于特征向量 $\\varphi_{\\mathrm{alt}}$ 的 $G$ 的特征值，是 $\\rho(\\varphi_{\\mathrm{alt}}) = \\frac{\\tau}{c+\\tau}$。\n\n这个解析结果提供了深刻见解：\n- 如果 $c \\ll \\tau$，则 $\\rho(\\varphi_{\\mathrm{alt}}) \\approx 1$，意味着交错格式无法抑制这个伪模式。这种情况发生在近不可压缩的情况下（小的 $c$），即使有强稳定化（大的 $\\tau$）。\n- 如果 $\\tau \\ll c$，则 $\\rho(\\varphi_{\\mathrm{alt}}) \\approx \\tau/c \\ll 1$，意味着该模式被强烈抑制。\n\n对于每个测试用例，实施以下步骤以数值方式计算所需值，从而证实解析推导。\n\n1.  **构建矩阵**：对于每组参数 $(\\alpha, k_u, c, \\tau)$，在 $\\mathbb{R}^{4 \\times 4}$ 中定义矩阵 $I$、$B$、$K = k_u I$、$C = c I$ 和 $\\varphi_{\\mathrm{alt}}$。\n2.  **计算 $\\lambda_{\\min}$**：构建Schur补 $S = cI + \\frac{\\alpha^2}{k_u}B B^{\\top}$。计算此对称矩阵的特征值，并将最小值确定为 $\\lambda_{\\min}$。\n3.  **计算 $\\rho(\\varphi_{\\mathrm{alt}})$**：构建误差传播算子 $G = I - (C + \\tau I)^{-1} S$。然后计算瑞利商 $\\rho(\\varphi_{\\mathrm{alt}}) = (\\varphi_{\\mathrm{alt}}^{\\top} G \\varphi_{\\mathrm{alt}}) / (\\varphi_{\\mathrm{alt}}^{\\top} \\varphi_{\\mathrm{alt}})$。\n4.  **汇总结果**：为每个测试用例确定元组 $(\\lambda_{\\min}, \\rho(\\varphi_{\\mathrm{alt}}), 0.0)$，并收集到一个最终的扁平列表中以供输出。\n\n此过程被系统地应用于问题陈述中提供的四个测试用例。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the poromechanics coupling stability problem by computing eigenvalues\n    and amplification factors for monolithic and staggered schemes.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # (alpha, k_u, c, tau)\n    test_cases = [\n        # Test Case 1 (general case)\n        (1.0, 1.0, 1e-3, 1e-2),\n        # Test Case 2 (near-incompressible, weak stabilization)\n        (1.0, 1.0, 1e-8, 1e-2),\n        # Test Case 3 (near-incompressible, strong stabilization)\n        (1.0, 1.0, 1e-8, 1.0),\n        # Test Case 4 (general storage, very weak stabilization)\n        (1.0, 1.0, 1e-3, 1e-6),\n    ]\n\n    results = []\n\n    # Define constant values based on the problem description\n    n_dim = 4\n    I = np.identity(n_dim)\n    \n    # Coupling operator B\n    B = np.array([\n        [1., 0., 0., 1.],\n        [1., 0., 1., 0.],\n        [0., 1., 1., 0.],\n        [0., 1., 0., 1.]\n    ])\n\n    # Spurious pressure mode candidate\n    phi_alt = np.array([1., -1., 1., -1.])\n\n    for case in test_cases:\n        alpha, k_u, c, tau = case\n\n        # Step 1: Form the Schur complement S\n        # K = k_u * I => K_inv = (1/k_u) * I\n        # C = c * I\n        K_inv = (1.0 / k_u) * I\n        C_mat = c * I\n        \n        # S = C + alpha^2 * B * K^-1 * B^T\n        S = C_mat + (alpha**2) * (B @ K_inv @ B.T)\n\n        # Step 2: Solve the eigenvalue problem for S to find lambda_min\n        # Since S is symmetric, we can use eigh for efficiency and stability.\n        # eigvalsh returns eigenvalues in ascending order.\n        eigenvalues_S = np.linalg.eigvalsh(S)\n        lambda_min = eigenvalues_S[0]\n\n        # Step 3: Compute the fixed-stress amplification factor rho\n        # G = I - (C + tau*I)^-1 * S\n        C_plus_tau_I_inv = np.linalg.inv(C_mat + tau * I)\n        G = I - C_plus_tau_I_inv @ S\n\n        # rho(phi_alt) = (phi_alt^T * G * phi_alt) / (phi_alt^T * phi_alt)\n        numerator = phi_alt.T @ G @ phi_alt\n        denominator = phi_alt.T @ phi_alt\n        rho_phi_alt = numerator / denominator\n\n        # Step 4: Collect the three outputs for the current test case\n        # The monolithic amplification factor is given as 0.\n        monolithic_amp = 0.0\n        \n        results.extend([lambda_min, rho_phi_alt, monolithic_amp])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "处理近不可压缩材料是混合 $u\\text{-}p$ 方法面临的另一个重大挑战，常导致“体积锁定”（volumetric locking）现象，使结果变得过于刚硬。本实践将介绍一种常用的解决方案——压力稳定化方法，以确保在不可压缩极限下数值格式的鲁棒性。你将通过推导稳定化参数 $\\tau$ 的标度律，并将其应用于具体算例，从而掌握连接理论分析与实际代码实现的关键技能，学会如何有效克服体积锁定问题。",
            "id": "3555649",
            "problem": "考虑一个均匀各向同性固体，在平面应变条件下的小应变线性弹性的位移-压力 ($u\\text{-}p$) 混合格式。该固体的拉梅参数为 $\\lambda$ 和 $\\mu$，体积模量为 $K$。未知量是位移 $u$ 和压力 $p$。标准的混合弱形式将由 $\\mu$ 控制的偏量部分和由 $K$ 控制的体积部分耦合起来。在不可压缩极限 $K \\to \\infty$ 下，体积应变约束成为主导，该格式需要选择合适的压力空间或进行稳定化处理以保持稳定。\n\n一种广泛使用于等阶位移-压力有限元空间的方法是添加一个一致的压力梯度稳定化项，其形式为\n$$\nS(p, q) \\;=\\; \\sum_{e} \\tau_e \\int_{\\Omega_e} \\nabla p \\cdot \\nabla q \\, \\mathrm{d}\\Omega,\n$$\n其中 $\\tau_e$ 是每个单元上的正常数稳定化参数，$q$ 是压力测试函数。该稳定化必须经过校准，以满足：\n- 它与连续的 $u\\text{-}p$ 格式相一致（即对于足够光滑的 $p$，它不会使解产生偏差）。\n- 当 $K \\to \\infty$ 时，它能保证离散系统的鲁棒性，特别是对于整体耦合（求解完全耦合的 $u\\text{-}p$ 系统）和交错耦合（在交替子步中求解 $u$ 和 $p$）而言。\n- 它能控制等阶离散化中固有的、会违反 Ladyzhenskaya–Babuška–Brezzi inf–sup 条件的虚假高频压力模式（例如棋盘格模式）。\n\n从第一性原理出发，使用以下基础：\n- 准静态小应变弹性的线性动量平衡方程和各向同性固体的本构关系：$\\sigma = 2\\mu \\varepsilon(u) - p I$ 以及对于有限 $K$ 的 $p = -K \\, \\nabla \\cdot u$。\n- 具有块算子 $A$（偏刚度）、$B$（离散散度）和压力块 $-C$ 的混合鞍点结构，其中在不可压缩极限下，$C$ 完全由稳定化项产生。\n- 在单元尺寸为 $h$ 的均匀网格上进行一维傅里叶符号分析，其中偏算子的符号与 $\\mu k^2$ 成正比，耦合算子的符号与 $ik$ 成正比，最大可表示波数（奈奎斯特波数）为 $k_{\\max} = \\pi/h$。\n\n推导 $\\tau$ 作为网格尺寸 $h$ 和材料剪切模量 $\\mu$ 的函数的一个校准公式，该公式确保当 $K \\to \\infty$ 时，离散压力舒尔补对所有容许模式一致有界（有上界和下界），从而防止闭锁并抑制虚假的棋盘格模式。将 $\\tau$ 的单位表示为 $\\text{m}^2/\\text{Pa}$。\n\n然后，实现一个程序，为以下参数三元组 $(h, \\mu, K)$ 的测试套件计算 $\\tau$：\n- 情况 A (理想情况): $h = 0.1$ m, $\\mu = 80 \\times 10^9$ Pa, $K = 10^{12}$ Pa.\n- 情况 B (小网格尺寸): $h = 0.001$ m, $\\mu = 10^6$ Pa, $K = 10^9$ Pa.\n- 情况 C (大剪切模量): $h = 0.2$ m, $\\mu = 200 \\times 10^9$ Pa, $K = 10^{12}$ Pa.\n- 情况 D (极大体积模量): $h = 0.05$ m, $\\mu = 5 \\times 10^9$ Pa, $K = 10^{15}$ Pa.\n- 情况 E (中等可压缩材料): $h = 0.5$ m, $\\mu = 2 \\times 10^9$ Pa, $K = 10^8$ Pa.\n\n您的程序必须产生单行输出，其中包含五个情况的结果，形式为方括号括起来的逗号分隔列表，例如 $[x_1,x_2,x_3,x_4,x_5]$，其中每个 $x_i$ 是由您推导的校准公式计算出的 $\\tau$ 值，单位为 $\\text{m}^2/\\text{Pa}$。输出必须是实值浮点数。不应打印任何其他文本。",
            "solution": "问题陈述已经过验证，被认为是科学上合理、良定且客观的。它提出了计算固体力学领域一个标准的、非平凡的任务，并为严谨的推导提供了充分的信息。因此，我们可以着手求解。\n\n目标是为近不可压缩线性弹性的混合 $u-p$ 有限元格式推导压力稳定化参数 $\\tau$ 的校准公式。该推导将基于一维傅里叶稳定性分析，以确保得到的离散系统在不可压缩极限 $K \\to \\infty$ 下是鲁棒的。\n\n由混合格式产生的离散鞍点系统以块矩阵形式给出：\n$$\n\\begin{pmatrix} A  & B^T \\\\ B  & -C \\end{pmatrix}\n\\begin{pmatrix} \\mathbf{u} \\\\ \\mathbf{p} \\end{pmatrix}\n=\n\\begin{pmatrix} \\mathbf{f} \\\\ \\mathbf{g} \\end{pmatrix}\n$$\n此处，$\\mathbf{u}$ 和 $\\mathbf{p}$ 分别是离散位移和压力自由度向量。矩阵 $A$ 代表偏刚度，$B$ 是离散散度算子，$C$ 是压力矩阵。对于稳定化格式，压力块 $C$ 由一个可压缩性项和一个稳定化项组成：$C = \\frac{1}{K}M_p + C_{\\text{stab}}$，其中 $M_p$ 是压力质量矩阵。在不可压缩极限 $K \\to \\infty$ 下，$\\frac{1}{K}M_p$ 项消失，且问题陈述指出块 $-C$ 完全由稳定化产生。\n\n稳定化项由 $S(p, q) = \\sum_{e} \\tau_e \\int_{\\Omega_e} \\nabla p \\cdot \\nabla q \\, \\mathrm{d}\\Omega$ 给出。对于单元尺寸为 $h$ 的均匀网格，稳定化参数 $\\tau_e$ 是常数，即 $\\tau_e = \\tau$。该项对应于一个按比例缩放的离散压力拉普拉斯算子 $-\\tau \\nabla^2 p$。\n\n为分析此系统的稳定性，我们消去位移向量 $\\mathbf{u}$ 以形成压力舒尔补系统。舒尔补算子为 $S_p = C + B A^{-1} B^T$。整个系统的稳定性和良态性关键取决于 $S_p$ 的性质。我们的目标是选择 $\\tau$，使得 $S_p$ 的谱性态良好且一致有正下界，并且不依赖于网格尺寸 $h$。\n\n我们按照要求，在均匀一维网格上采用傅里叶分析。在此分析中，算子被其傅里叶符号所取代，傅里叶符号表示算子对模式 $e^{ikx}$ 的作用，其中 $k$ 是波数。算子的符号本质上描述了其特征值。舒尔补算子 $S_p$ 的符号 $\\hat{S}_p(k)$ 由下式给出：\n$$\n\\hat{S}_p(k) = \\hat{C}(k) + \\hat{B}(k) (\\hat{A}(k))^{-1} \\hat{B}(k)^*\n$$\n其中 $\\hat{A}(k)$、$\\hat{B}(k)$ 和 $\\hat{C}(k)$ 分别是算子 $A$、B 和 $C$ 的符号，而 $\\hat{B}(k)^*$ 是 $\\hat{B}(k)$ 的共轭转置。\n\n让我们根据所提供的信息和标准的有限差分/有限元模板来确定这些算子的符号。\n1. 算子 $A$ 对应于偏量项，其行为类似于 $-2\\mu\\nabla^2 u$。在间距为 $h$ 的网格上，离散二阶导数算子的符号是 $\\hat{\\mathcal{L}}(k) = -\\frac{4}{h^2}\\sin^2(\\frac{kh}{2})$。因此，偏刚度算子 $A$ 的符号与此成正比，并按剪切模量 $\\mu$ 进行缩放：\n$$\n\\hat{A}(k) = c_A \\mu \\frac{4}{h^2}\\sin^2\\left(\\frac{kh}{2}\\right)\n$$\n这与问题提示中对于小 $k$ 有 $\\hat{A}(k) \\propto \\mu k^2$ 相一致。\n\n2. 算子 $B$ 是离散散度，对于中心差分格式，其符号为 $\\hat{B}(k) = c_B \\frac{i}{h}\\sin(kh)$。这与提示 $\\hat{B}(k) \\propto ik$ 相一致。其共轭转置符号为 $\\hat{B}(k)^* = -c_B \\frac{i}{h}\\sin(kh)$。\n\n3. 在不可压缩极限下，算子 $C$ 完全来自稳定化项，即 $C \\to C_{\\text{stab}}$。稳定化项对应于 $-\\tau \\nabla^2 p$。因此，其符号与离散拉普拉斯算子的符号成正比：\n$$\n\\hat{C}(k) = \\hat{C}_{\\text{stab}}(k) = c_C \\tau \\frac{4}{h^2}\\sin^2\\left(\\frac{kh}{2}\\right)\n$$\n常数 $c_A$、$c_B$ 和 $c_C$ 是量级为 1 的无量纲因子，其值取决于有限元基函数的具体选择。\n\n将这些符号代入舒尔补符号的表达式中：\n$$\n\\hat{S}_p(k) = c_C \\tau \\frac{4}{h^2}\\sin^2\\left(\\frac{kh}{2}\\right) + \\left(c_B \\frac{i}{h}\\sin(kh)\\right) \\left(c_A \\mu \\frac{4}{h^2}\\sin^2\\left(\\frac{kh}{2}\\right)\\right)^{-1} \\left(-c_B \\frac{i}{h}\\sin(kh)\\right)\n$$\n$$\n\\hat{S}_p(k) = c_C \\tau \\frac{4}{h^2}\\sin^2\\left(\\frac{kh}{2}\\right) + \\frac{c_B^2}{h^2}\\sin^2(kh) \\left(c_A \\mu \\frac{4}{h^2}\\sin^2\\left(\\frac{kh}{2}\\right)\\right)^{-1}\n$$\n使用三角恒等式 $\\sin(kh) = 2\\sin(\\frac{kh}{2})\\cos(\\frac{kh}{2})$，我们得到 $\\sin^2(kh) = 4\\sin^2(\\frac{kh}{2})\\cos^2(\\frac{kh}{2})$。\n$$\n\\hat{S}_p(k) = c_C \\tau \\frac{4}{h^2}\\sin^2\\left(\\frac{kh}{2}\\right) + \\frac{c_B^2}{h^2} \\frac{4\\sin^2(\\frac{kh}{2})\\cos^2(\\frac{kh}{2})}{c_A \\mu \\frac{4}{h^2}\\sin^2(\\frac{kh}{2})}\n$$\n只要 $k \\neq 0$ 且 $k \\neq 2\\pi/h$，第二部分的 $\\sin^2(\\frac{kh}{2})$ 项就会消掉：\n$$\n\\hat{S}_p(k) = c_C \\tau \\frac{4}{h^2}\\sin^2\\left(\\frac{kh}{2}\\right) + \\frac{c_B^2}{c_A \\mu} \\cos^2\\left(\\frac{kh}{2}\\right)\n$$\n这个表达式揭示了舒尔补在整个波数范围内的行为。第一项来自稳定化，在高频（大 $k$，此时 $\\sin^2(\\frac{kh}{2})$ 较大）处占主导；而第二项来自物理耦合，在低频（小 $k$，此时 $\\cos^2(\\frac{kh}{2})$ 较大）处占主导。等阶单元的不稳定性之所以出现，是因为对于最高频率模式（棋盘格模式，$k_{\\max} = \\pi/h$），离散散度算子的符号可能为零。在我们的模型符号中，$\\sin(k_{\\max}h) = \\sin(\\pi) = 0$，因此 $\\hat{B}(k_{\\max})=0$。对于此模式，未稳定的舒尔补将是奇异的。稳定化项通过在此频率处达到最大值来修正这个问题，因为 $\\sin^2(\\frac{k_{\\max}h}{2}) = \\sin^2(\\pi/2) = 1$。\n\n为确保舒尔补是一致有界的，并且其条件数不依赖于网格尺寸 $h$，我们必须平衡符号表达式中的两项。这可以通过选择 $\\tau$ 以使三角函数项的系数处于同一数量级来实现：\n$$\nc_C \\tau \\frac{4}{h^2} \\sim \\frac{c_B^2}{c_A \\mu}\n$$\n对 $\\tau$ 进行整理，得到所需的标度关系：\n$$\n\\tau \\sim \\frac{c_B^2 h^2}{4 c_A c_C \\mu}\n$$\n这表明 $\\tau$ 必须与 $h^2/\\mu$ 成正比。我们可以将校准公式写为：\n$$\n\\tau = c \\frac{h^2}{\\mu}\n$$\n其中 $c = \\frac{c_B^2}{4 c_A c_C}$ 是一个无量纲常数。在缺少定义 $c_A$、$c_B$ 和 $c_C$ 的有限元基函数的具体细节的情况下，最合理和标准的方法是假设这些常数使得 $c=1$。这个选择能产生理想的平衡。因此，推导出的校准公式为：\n$$\n\\tau = \\frac{h^2}{\\mu}\n$$\n让我们验证一下物理单位。网格尺寸 $h$ 的单位是米 (m)，剪切模量 $\\mu$ 的单位是帕斯卡 (Pa)。因此，$\\tau$ 的单位是 $\\text{m}^2/\\text{Pa}$，这与问题的要求相符。体积模量 $K$ 的值没有出现在最终公式中，这是符合预期的，因为该参数是为了在极限 $K \\to \\infty$ 下的鲁棒性而设计的。\n\n现在，我们将应用此公式 $\\tau = h^2 / \\mu$ 来为所提供的测试用例计算稳定化参数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the pressure stabilization parameter tau for several test cases\n    based on the derived formula tau = h^2 / mu.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (h, mu, K)\n    # h is in meters (m)\n    # mu is in Pascals (Pa)\n    # K is in Pascals (Pa)\n    # The value of K is not used in the calculation, as the formula is derived\n    # for the incompressible limit (K -> infinity).\n    test_cases = [\n        # Case A: (h, mu, K)\n        (0.1, 80e9, 1e12),\n        # Case B: (h, mu, K)\n        (0.001, 1e6, 1e9),\n        # Case C: (h, mu, K)\n        (0.2, 200e9, 1e12),\n        # Case D: (h, mu, K)\n        (0.05, 5e9, 1e15),\n        # Case E: (h, mu, K)\n        (0.5, 2e9, 1e8),\n    ]\n\n    results = []\n    for case in test_cases:\n        h, mu, K = case\n        \n        # The derived calibration for the stabilization parameter tau is h^2 / mu.\n        # The dimensionless constant of proportionality is taken as 1.\n        tau = h**2 / mu\n        \n        results.append(tau)\n\n    # Final print statement in the exact required format: a comma-separated\n    # list of floating-point numbers enclosed in square brackets.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}