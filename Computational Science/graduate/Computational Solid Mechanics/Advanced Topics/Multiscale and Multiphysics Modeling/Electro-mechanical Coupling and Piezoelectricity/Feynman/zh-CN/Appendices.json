{
    "hands_on_practices": [
        {
            "introduction": "在深入研究复杂的数值模拟之前，通过解析方法求解理想化问题是验证数值代码和获得物理直觉的关键一步。这项练习将引导您应用压电本构关系和平衡方程，从第一性原理出发，推导一个经典边界值问题的精确解。通过这项实践，您可以将抽象的控制方程与具体的物理行为联系起来，加深对压电耦合效应的理解()。",
            "id": "3561198",
            "problem": "考虑一半径为 $a$、长度为 $L$ 的直立圆形圆柱压电杆，其材料对称性为绕 z 轴横向各向同性（晶体类别 $6mm$），且其极化方向与圆柱轴 z 重合。该杆在小应变和准静态静电学条件下，于线性压电范围内进行建模。基本控制方程如下：\n- 线性动量平衡：$\\nabla \\cdot \\boldsymbol{T} + \\boldsymbol{b} = \\boldsymbol{0}$，其中 $\\boldsymbol{b} = \\boldsymbol{0}$。\n- 无自由电荷时的高斯定律：$\\nabla \\cdot \\boldsymbol{D} = 0$。\n- 静电场定义：$\\boldsymbol{E} = -\\nabla \\phi$。\n\n应力-电荷形式的线性压电本构关系为：\n$$\\boldsymbol{T} = \\boldsymbol{c}^{E} : \\boldsymbol{S} - \\boldsymbol{e}^{\\top} \\boldsymbol{E}, \\qquad \\boldsymbol{D} = \\boldsymbol{e} : \\boldsymbol{S} + \\boldsymbol{\\epsilon}^{S} \\boldsymbol{E},$$\n其中 $\\boldsymbol{T}$ 是 Cauchy 应力，$\\boldsymbol{S}$ 是小应变张量，$\\boldsymbol{D}$ 是电位移，$\\boldsymbol{E}$ 是电场，$\\boldsymbol{c}^{E}$ 是恒定电场下的弹性刚度，$\\boldsymbol{e}$ 是压电耦合张量，$\\boldsymbol{\\epsilon}^{S}$ 是恒定应变下的介电常数。\n\n边界与加载条件如下：\n- 机械条件：$z=0$ 端固定（$\\boldsymbol{u}=\\boldsymbol{0}$），$z=L$ 端施加一个绕 z 轴的静态扭矩 $M$；侧面 $r=a$ 无面力。\n- 电学条件：两端面为完美电极，电势给定为 $\\phi(0)=0$ 和 $\\phi(L)=V$；侧面 $r=a$ 电绝缘，因此该处 $\\boldsymbol{D}\\cdot \\boldsymbol{n}=0$。\n\n假设为轴对称的 Saint-Venant 扭转状态，横截面无翘曲，并忽略端部效应（即，除端部附近的边界层外，各场沿 z 轴均匀分布）。在给定的绕 z 轴的材料对称性和沿 z 轴的极化条件下，扭转中唯一相关的刚度是 $c_{44}$（杆的剪切模量），且对于 $6mm$ 晶体类别，轴向电场 $E_z$ 与剪应力分量 $T_{z\\theta}$ 之间的耦合为零。\n\n从上述定律和条件出发，推导以下物理量的精确解析表达式：\n1. 加载端 $z=L$ 处的周向位移 $u_{\\theta}(r)$，表示为 $r$、$a$、$L$、$M$ 和 $c_{44}$ 的函数。\n2. 整个杆内的轴向电场 $E_z$，表示为 $V$ 和 $L$ 的函数。\n\n将 $u_{\\theta}$ 以米为单位表示，$E_{z}$ 以伏特/米为单位表示。无需代入任何数值；仅提供封闭形式的表达式。无需进行舍入。你的最终答案必须是一个单一的解析表达式，使用 LaTeX 的 $pmatrix$ 环境将所求的两个量 $\\left(u_{\\theta}(r), E_{z}\\right)$ 按顺序包含在同一行中。",
            "solution": "所给出的问题陈述是线性压电学领域一个适定的边界值问题。它具有科学依据、内部一致，并包含足够的信息以在指定假设下推导出唯一解。问题的核心在于将连续介质力学和静电学的原理应用于具有特定对称性（晶体类别 $6mm$）且承受特定载荷（扭转）的压电材料。问题中明确指出的一个关键简化是，对于这种材料类别和载荷，机械扭转与轴向电场是解耦的。这使得问题可以分解为两个独立的子问题：一个纯机械扭转问题和一个纯静电学问题。\n\n求解过程是分别分析这两个子问题。\n\n首先，我们处理机械扭转问题，以求出 $z=L$ 端的周向位移 $u_{\\theta}(r)$。\n问题假设为轴对称的 Saint-Venant 扭转状态且无翘曲。对于圆轴，这对应于以下形式的位移场：\n$$\nu_r = 0, \\quad u_z = 0, \\quad u_{\\theta} = r \\psi(z)\n$$\n其中 $u_r$、$u_{\\theta}$ 和 $u_z$ 是柱坐标系 $(r, \\theta, z)$ 中的位移分量，而 $\\psi(z)$ 是位置 z 处横截面的扭转角。\n\n小应变张量 $\\boldsymbol{S} = \\frac{1}{2}(\\nabla \\boldsymbol{u} + (\\nabla \\boldsymbol{u})^{\\top})$ 的非零分量由该位移场导出。唯一的非零分量是 $\\theta-z$ 平面内的工程剪切应变：\n$$\nS_{\\theta z} = \\frac{1}{2}\\left(\\frac{1}{r}\\frac{\\partial u_z}{\\partial \\theta} + \\frac{\\partial u_{\\theta}}{\\partial z}\\right) = \\frac{1}{2}\\frac{\\partial}{\\partial z}(r\\psi(z)) = \\frac{1}{2}r \\frac{d\\psi}{dz}\n$$\n场沿长度 $L$ 均匀（忽略端部效应）的假设意味着扭转率是恒定的。我们将此恒定扭转率定义为 $\\alpha$：\n$$\n\\alpha = \\frac{d\\psi}{dz}\n$$\n因此，应变为 $S_{\\theta z} = \\frac{1}{2}r\\alpha$。\n\n根据问题陈述，对于 $6mm$ 晶体类别，剪应力 $T_{\\theta z}$ 与轴向电场 $E_z$ 之间的机电耦合为零。此外，问题的结构允许我们假设一个纯轴向电场 $\\boldsymbol{E} = E_z \\boldsymbol{\\hat{e}}_z$，即 $E_r=E_{\\theta}=0$。应力的本构关系 $\\boldsymbol{T} = \\boldsymbol{c}^{E} : \\boldsymbol{S} - \\boldsymbol{e}^{\\top} \\boldsymbol{E}$ 得以简化。对于剪应力分量 $T_{\\theta z}$，涉及 $E_z$ 的压电项不存在。该关系简化为纯弹性形式，其中 $c_{44}$ 是相关的剪切模量：\n$$\nT_{\\theta z} = 2 c_{44}^{E} S_{\\theta z} = 2 c_{44} \\left(\\frac{1}{2} r\\alpha\\right) = c_{44} r \\alpha\n$$\n我们省略 $c_{44}$ 上的上标 $E$，因为它是唯一被考虑的。该应力场在无体力的情况下自动满足平衡方程 $\\nabla \\cdot \\boldsymbol{T} = \\boldsymbol{0}$。\n\n接下来，我们应用边界条件。在 $z=L$ 端施加的扭矩 $M$ 是剪应力 $T_{\\theta z}$ 在横截面积 $A$ 上的合力矩：\n$$\nM = \\int_A r T_{\\theta z} \\, dA = \\int_0^{2\\pi}\\int_0^a r (c_{44} r \\alpha) \\, r \\, dr \\, d\\theta\n$$\n$$\nM = 2\\pi c_{44} \\alpha \\int_0^a r^3 \\, dr = 2\\pi c_{44} \\alpha \\left[\\frac{r^4}{4}\\right]_0^a = \\frac{\\pi c_{44} a^4 \\alpha}{2}\n$$\n从这个关系中，我们解出恒定的扭转率 $\\alpha$：\n$$\n\\alpha = \\frac{2M}{\\pi c_{44} a^4}\n$$\n为了求得位移，我们将扭转率 $\\alpha = d\\psi/dz$ 对 z 进行积分。固定端 $z=0$ 处的边界条件 $\\boldsymbol{u}=\\boldsymbol{0}$ 意味着 $u_{\\theta}(r,0)=0$，即 $\\psi(0)=0$。\n$$\n\\psi(z) = \\int_0^z \\alpha \\, dz' = \\alpha z\n$$\n加载端 $z=L$ 处的周向位移则由下式给出：\n$$\nu_{\\theta}(r, L) = r \\psi(L) = r \\alpha L\n$$\n代入 $\\alpha$ 的表达式：\n$$\nu_{\\theta}(r, L) = r L \\left(\\frac{2M}{\\pi c_{44} a^4}\\right) = \\frac{2MLr}{\\pi a^4 c_{44}}\n$$\n这就是所求的第一个表达式。\n\n其次，我们处理静电问题，以求出轴向电场 $E_z$。\n问题是解耦的，因此我们可以独立求解电场。杆的两端设有电极，电势为 $\\phi(0)=0$ 和 $\\phi(L)=V$。忽略端部效应意味着沿 z 轴的电场是均匀的。几何形状表明电势 $\\phi$ 仅随 z 变化，即 $\\phi = \\phi(z)$。\n电场通过 $\\boldsymbol{E} = -\\nabla \\phi$ 与电势相关。对于一个仅依赖于 z 的电势，这简化为：\n$$\n\\boldsymbol{E} = -\\frac{d\\phi}{dz} \\boldsymbol{\\hat{e}}_z\n$$\n因此，电场是纯轴向的，且 $E_z = -\\frac{d\\phi}{dz}$。由于我们假设场是均匀的，$E_z$ 必须是一个常数。\n$$\n\\frac{d\\phi}{dz} = -E_z = \\text{constant}\n$$\n对该方程积分得到电势：\n$$\n\\phi(z) = -E_z z + C\n$$\n其中 $C$ 是一个积分常数。我们应用电学边界条件来确定 $E_z$ 和 $C$：\n1. 在 $z=0$ 处, $\\phi(0) = 0$:\n   $$0 = -E_z(0) + C \\implies C=0$$\n2. 在 $z=L$ 处, $\\phi(L) = V$:\n   $$V = -E_z L$$\n解出轴向电场分量 $E_z$：\n$$\nE_z = -\\frac{V}{L}\n$$\n这个结果与所有其他条件都一致。高斯定律 $\\nabla \\cdot \\boldsymbol{D} = 0$ 得到满足，因为解耦意味着 $D_z = \\epsilon_{33}^{S} E_z$，这是一个常数，而 $\\boldsymbol{D}$ 的其他分量不会贡献非零散度。侧面上的绝缘条件 $\\boldsymbol{D} \\cdot \\boldsymbol{n} = D_r = 0$ 也得到满足，因为 $E_r=0$ 且应变场不会产生 $D_r$。\n\n结合两个推导出的表达式，我们得到所求的解集。\n$z=L$ 处的周向位移为 $u_{\\theta}(r) = \\frac{2MLr}{\\pi a^4 c_{44}}$。\n轴向电场为 $E_z = -\\frac{V}{L}$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{2MLr}{\\pi a^{4} c_{44}} & -\\frac{V}{L} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "压电材料的特性本质上是各向异性的，其机电响应强烈依赖于晶体取向。这项练习旨在训练一项核心技能：在不同坐标系之间变换材料属性张量。掌握张量坐标变换对于精确建模和设计压电器件至关重要，因为在实际应用中，材料的晶轴方向通常与器件的几何坐标系不一致()。",
            "id": "3561275",
            "problem": "考虑一个晶体学类别为 $6mm$ 的横观各向同性压电晶体，其材料对称轴与晶体坐标系的 $Z$ 轴对齐。设晶体坐标系表示为 $\\{X,Y,Z\\}$，实验室坐标系表示为 $\\{x,y,z\\}$。实验室坐标系是通过将晶体坐标系绕其 $Y$ 轴进行 $30$ 度的正常正交旋转得到的。从晶体坐标系到实验室坐标系的旋转矩阵 $Q$ 为\n$$\nQ \\;=\\; \\begin{pmatrix}\n\\cos\\theta  0  \\sin\\theta \\\\\n0  1  0 \\\\\n-\\sin\\theta  0  \\cos\\theta\n\\end{pmatrix},\n\\quad \\text{with } \\theta = 30~\\text{degrees}.\n$$\n在晶体坐标系中，与横观各向同性一致的非零独立弹性刚度分量（四阶弹性张量）由下式给出\n$$\nC_{XXXX} = C_{YYYY} = C_{11} = 160~\\text{Gigapascal (GPa)}, \\quad\nC_{ZZZZ} = C_{33} = 140~\\text{GPa}, \\quad\nC_{XXZZ} = C_{YYZZ} = C_{13} = 75~\\text{GPa}, \\quad\nC_{XZXZ} = C_{YZYZ} = C_{44} = 35~\\text{GPa}.\n$$\n所有通过弹性张量的次对称性和主对称性相关的分量都是隐含的，而所有其他非通过对称性获得的分量均为零。在晶体坐标系中，与 $6mm$ 对称性一致的非零压电应力张量分量 $e_{kij}$（三阶张量，在其最后两个指标 $i,j$ 上对称）为\n$$\ne_{3 1 1} = e_{3 2 2} = e_{31} = -0.58~\\text{Coulomb per square meter}, \\quad\ne_{3 3 3} = e_{33} = 1.34~\\text{Coulomb per square meter}, \\quad\ne_{1 1 3} = e_{1 3 1} = e_{2 2 3} = e_{2 3 2} = e_{15} = 0.48~\\text{Coulomb per square meter}.\n$$\n从正常正交旋转下的张量变换定义以及横观各向同性压电介质的对称性约束出发，推导旋转后的实验室坐标系分量 $C'_{1111}$ 和 $e'_{311}$，并根据给定的 $Q$、$C_{11}$、$C_{33}$、$C_{13}$、$C_{44}$、$e_{31}$、$e_{33}$ 和 $e_{15}$ 计算它们的数值。将旋转后的刚度 $C'_{11}$（等于 $C'_{1111}$）以吉帕斯卡（GPa）为单位表示，并四舍五入到四位有效数字。将旋转后的压电应力系数 $e'_{311}$ 以库仑/平方米为单位表示，并四舍五入到三位有效数字。以单行矩阵的形式提供最终答案，按 $\\big(C'_{11},\\, e'_{311}\\big)$ 的顺序包含这两个数字，矩阵内不含单位。",
            "solution": "问题陈述已经过严格验证，被认为是具有科学依据、适定、客观且内部一致的。它提出了一个连续介质力学中的标准问题，涉及材料属性张量在坐标系旋转下的变换。所有提供的数据在物理上都是合理的，并与指定的材料对称性一致。因此，我们可以进行完整求解。\n\n问题要求在旋转后的实验室坐标系中，分别计算弹性张量和压电应力张量的两个分量 $C'_{1111}$ 和 $e'_{311}$。变换是通过绕 $Y$ 轴旋转 $\\theta = 30^\\circ$ 从晶体坐标系 $\\{X, Y, Z\\}$ 到实验室坐标系 $\\{x, y, z\\}$。\n\n坐标的变换由 $x_p = Q_{pi} X_i$ 给出，其中 $Q$ 是正交旋转矩阵。\n一个四阶张量，如弹性张量 $C_{ijkl}$，根据以下法则进行变换：\n$$C'_{pqrs} = Q_{pi} Q_{qj} Q_{rk} Q_{sl} C_{ijkl}$$\n一个三阶张量，如压电应力张量 $e_{ijk}$，根据以下法则进行变换：\n$$e'_{pqr} = Q_{pi} Q_{qj} Q_{rk} e_{ijk}$$\n在这些表达式中，隐含了对重复指标（$i,j,k,l \\in \\{1,2,3\\}$）的爱因斯坦求和约定。绕 $Y$ 轴（即“2”轴）旋转角度 $\\theta$ 的旋转矩阵 $Q$ 的分量为：\n$$\nQ = \\begin{pmatrix} \\cos\\theta  0  \\sin\\theta \\\\ 0  1  0 \\\\ -\\sin\\theta  0  \\cos\\theta \\end{pmatrix} = \\begin{pmatrix} c  0  s \\\\ 0  1  0 \\\\ -s  0  c \\end{pmatrix}\n$$\n其中 $c = \\cos\\theta$ 且 $s = \\sin\\theta$。对于 $\\theta = 30^\\circ$，我们有 $c = \\frac{\\sqrt{3}}{2}$ 和 $s = \\frac{1}{2}$。\n\n**第一部分：计算旋转后的弹性刚度分量 $C'_{1111}$**\n\n我们需要计算旋转后的刚度张量的分量 $C'_{1111}$。在变换法则中令 $p=q=r=s=1$：\n$$C'_{1111} = Q_{1i} Q_{1j} Q_{1k} Q_{1l} C_{ijkl}$$\n从矩阵 $Q$ 可知，第一行中唯一的非零分量是 $Q_{11} = c$ 和 $Q_{13} = s$。因此，求和中的指标 $i, j, k, l$ 只能取值 $1$ 或 $3$ 才能产生非零项。\n\n该材料是横观各向同性的，对称轴为 $Z$ 轴（即“3”轴）。$C_{ijkl}$ 的非零分量是那些在横观平面（即指标 $1$ 和 $2$）中每个指标出现偶数次的分量。在我们指标仅为 $1$ 或 $3$ 的受限求和中，非零分量为 $C_{1111}$、$C_{3333}$、$C_{1133}$ 和 $C_{1313}$（以及通过对称性相关的分量）。\n\n让我们通过考虑所有贡献项来展开求和：\n$$C'_{1111} = \\sum_{i,j,k,l \\in \\{1,3\\}} Q_{1i} Q_{1j} Q_{1k} Q_{1l} C_{ijkl}$$\n求和中的项可以按非零 $C_{ijkl}$ 分量进行分组：\n1.  含 $C_{1111}$ 的项：唯一的指标组合是 $i=j=k=l=1$。这给出的项是 $Q_{11}Q_{11}Q_{11}Q_{11}C_{1111} = c^4 C_{1111}$。\n2.  含 $C_{3333}$ 的项：唯一的组合是 $i=j=k=l=3$。这给出的项是 $Q_{13}Q_{13}Q_{13}Q_{13}C_{3333} = s^4 C_{3333}$。\n3.  含 $C_{1133}$（及其对称等效项如 $C_{3311}$）的项：这些项有两个指标等于 $1$，两个指标等于 $3$。组合是 $(1,1,3,3)$ 和 $(3,3,1,1)$。这产生 $Q_{11}^2 Q_{13}^2 C_{1133} + Q_{13}^2 Q_{11}^2 C_{3311}$。由于主对称性，$C_{1133} = C_{3311}$。所以这个贡献是 $2 c^2 s^2 C_{1133}$。\n4.  含 $C_{1313}$（及其对称等效项）的项：这些项也有两个指标等于 $1$，两个指标等于 $3$。组合是 $(1,3,1,3)$、$(1,3,3,1)$、$(3,1,1,3)$ 和 $(3,1,3,1)$。这产生 $Q_{11}Q_{13}Q_{11}Q_{13}C_{1313} + Q_{11}Q_{13}Q_{13}Q_{11}C_{1331} + Q_{13}Q_{11}Q_{11}Q_{13}C_{3113} + Q_{13}Q_{11}Q_{13}Q_{11}C_{3131}$。由于次对称性，$C_{1313} = C_{1331} = C_{3113} = C_{3131}$。所以这个贡献是 $4 c^2 s^2 C_{1313}$。\n\n对于此类对称性，所有其他分量如 $C_{1113}$、$C_{1333}$ 均为零。\n合并所有项，我们得到完整表达式：\n$$C'_{1111} = c^4 C_{1111} + s^4 C_{3333} + 2c^2s^2 C_{1133} + 4c^2s^2 C_{1313}$$\n使用问题陈述中的缩写（类 Voigt）记法：$C_{11} \\equiv C_{1111}$、$C_{33} \\equiv C_{3333}$、$C_{13} \\equiv C_{1133}$ 和 $C_{44} \\equiv C_{1313}$（注意对于横观各向同性有 $C_{55}=C_{1313}=C_{44}$）。\n$$C'_{11} = c^4 C_{11} + s^4 C_{33} + 2c^2s^2 C_{13} + 4c^2s^2 C_{44}$$\n$$C'_{11} = c^4 C_{11} + s^4 C_{33} + 2c^2s^2 (C_{13} + 2C_{44})$$\n代入数值：\n$\\theta = 30^\\circ$，$c = \\cos(30^\\circ) = \\frac{\\sqrt{3}}{2}$，$s = \\sin(30^\\circ) = \\frac{1}{2}$。\n$c^2 = \\frac{3}{4}$，$s^2 = \\frac{1}{4}$。$c^4 = \\frac{9}{16}$，$s^4 = \\frac{1}{16}$。\n$C_{11} = 160$ GPa，$C_{33} = 140$ GPa，$C_{13} = 75$ GPa，$C_{44} = 35$ GPa。\n$$C'_{11} = \\left(\\frac{9}{16}\\right)(160) + \\left(\\frac{1}{16}\\right)(140) + 2\\left(\\frac{3}{4}\\right)\\left(\\frac{1}{4}\\right)\\left(75 + 2(35)\\right)$$\n$$C'_{11} = \\frac{1440}{16} + \\frac{140}{16} + \\frac{6}{16}(75 + 70)$$\n$$C'_{11} = \\frac{1}{16} (1440 + 140 + 6(145)) = \\frac{1}{16} (1580 + 870) = \\frac{2450}{16}$$\n$$C'_{11} = 153.125~\\text{GPa}$$\n四舍五入到四位有效数字，我们得到 $C'_{1111} = 153.1$ GPa。\n\n**第二部分：计算旋转后的压电分量 $e'_{311}$**\n\n现在我们计算旋转后的压电应力张量的分量 $e'_{311}$。在变换法则中令 $p=3, q=1, r=1$：\n$$e'_{311} = Q_{3i} Q_{1j} Q_{1k} e_{ijk}$$\n从 $Q$ 矩阵可知，第一行的非零分量是 $Q_{11}=c, Q_{13}=s$，第三行的非零分量是 $Q_{31}=-s, Q_{33}=c$。因此，求和指标必须为 $i \\in \\{1,3\\}$ 和 $j,k \\in \\{1,3\\}$。\n$$e'_{311} = \\sum_{i,j,k \\in \\{1,3\\}} Q_{3i} Q_{1j} Q_{1k} e_{ijk} = Q_{31} \\sum_{j,k \\in \\{1,3\\}} Q_{1j} Q_{1k} e_{1jk} + Q_{33} \\sum_{j,k \\in \\{1,3\\}} Q_{1j} Q_{1k} e_{3jk}$$\n对于 $6mm$ 类晶体，给定的非零 $e_{ijk}$ 分量为 $e_{311}=e_{322}=e_{31}$、$e_{333}=e_{33}$ 和 $e_{113}=e_{131}=e_{223}=e_{232}=e_{15}$。问题还指出其最后两个指标对称，$e_{ijk} = e_{ikj}$。\n\n让我们计算这两个和：\n1.  第一个和（$i=1$）：\n    $$Q_{31} [Q_{11}^2 e_{111} + Q_{11}Q_{13}e_{113} + Q_{13}Q_{11}e_{131} + Q_{13}^2 e_{133}]$$\n    对于 $6mm$ 类，$e_{111}=0$ 且 $e_{133}=0$。由于 $e_{113}=e_{131}=e_{15}$，此和变为：\n    $$(-s)[c \\cdot s \\cdot e_{15} + s \\cdot c \\cdot e_{15}] = -s(2cs e_{15}) = -2cs^2 e_{15}$$\n2.  第二个和（$i=3$）：\n    $$Q_{33} [Q_{11}^2 e_{311} + Q_{11}Q_{13}e_{313} + Q_{13}Q_{11}e_{331} + Q_{13}^2 e_{333}]$$\n    对于 $6mm$ 类，$e_{313}=e_{331}=0$。此和变为：\n    $$(c)[c^2 e_{311} + s^2 e_{333}] = c^3 e_{311} + cs^2 e_{333}$$\n    使用问题中的记法：$e_{311}=e_{31}$ 和 $e_{333}=e_{33}$。\n\n将两部分合并得到完整表达式：\n$$e'_{311} = c^3 e_{31} + cs^2 e_{33} - 2cs^2 e_{15}$$\n$$e'_{311} = c^3 e_{31} + cs^2(e_{33} - 2e_{15})$$\n代入数值：\n$e_{31} = -0.58$ C/m$^2$, $e_{33} = 1.34$ C/m$^2$, $e_{15} = 0.48$ C/m$^2$。\n$c = \\frac{\\sqrt{3}}{2}$, $s = \\frac{1}{2}$。$c^3 = \\frac{3\\sqrt{3}}{8}$, $cs^2 = \\frac{\\sqrt{3}}{2} \\cdot \\frac{1}{4} = \\frac{\\sqrt{3}}{8}$。\n$$e'_{311} = \\left(\\frac{3\\sqrt{3}}{8}\\right)(-0.58) + \\frac{\\sqrt{3}}{8}(1.34 - 2(0.48))$$\n$$e'_{311} = \\frac{\\sqrt{3}}{8} [3(-0.58) + (1.34 - 0.96)]$$\n$$e'_{311} = \\frac{\\sqrt{3}}{8} [-1.74 + 0.38]$$\n$$e'_{311} = \\frac{\\sqrt{3}}{8} [-1.36] = -0.17\\sqrt{3} \\approx -0.17 \\times 1.73205...$$\n$$e'_{311} \\approx -0.2944485~\\text{C/m}^2$$\n四舍五入到三位有效数字，我们得到 $e'_{311} = -0.294$ C/m$^2$。\n\n所要求的数值为 $C'_{1111} = 153.1$ GPa 和 $e'_{311} = -0.294$ C/m$^2$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n153.1 & -0.294\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "许多现实世界中的压电问题，尤其是在强电场或大应变下，表现出显著的非线性行为，必须通过先进的数值方法求解。这项编程练习提供了一个宝贵的实践机会，让您亲手实现并比较两种主流的多物理场耦合求解策略：整体（monolithic）求解器和交错（staggered）求解器。通过量化它们在不同参数下的收敛域，您将对这些算法的鲁棒性和效率有更深刻的认识()。",
            "id": "3561263",
            "problem": "本题要求您构建并分析一个能够捕捉压电固体中机电耦合效应的小型有限维模型，并利用该模型在不同介电常数对比度下比较单片牛顿求解器和交错牛顿求解器。目标是通过对初始猜测值进行采样，并统计在规定容差内成功收敛的次数，来量化这两种算法的近似收敛域。\n\n从以下电-力学基本原理出发：\n- 准静态小应变下的线性动量守恒：$\\nabla \\cdot \\boldsymbol{\\sigma} + \\boldsymbol{b} = \\boldsymbol{0}$。\n- 静电学高斯定律：$\\nabla \\cdot \\boldsymbol{D} - \\rho_{f} = 0$。\n- 小场和小应变下的线性压电本构关系：$\\boldsymbol{\\sigma} = \\mathbf{C} : \\boldsymbol{\\varepsilon} - \\mathbf{e}^{\\mathsf{T}} \\boldsymbol{E}$ 和 $\\boldsymbol{D} = \\mathbf{e} : \\boldsymbol{\\varepsilon} + \\boldsymbol{\\epsilon} \\boldsymbol{E}$，其中 $\\mathbf{C}$ 是弹性刚度张量，$\\mathbf{e}$ 是压电耦合张量，$\\boldsymbol{\\epsilon}$ 是介电常数张量。\n\n假设采用 Galerkin 离散化，得到总能量平稳性的有限维近似，其机械自由度为 $\\boldsymbol{u} \\in \\mathbb{R}^{n_u}$，电势自由度为 $\\boldsymbol{\\phi} \\in \\mathbb{R}^{n_{\\phi}}$。为使问题自洽，设 $n_u = 2$ 和 $n_{\\phi} = 2$，并定义一个总离散能量。该能量包含一个受控的非线性介电响应项，其灵感来源于非线性介电行为：\n$$\n\\Pi(\\boldsymbol{u},\\boldsymbol{\\phi}) = \\tfrac{1}{2} \\boldsymbol{u}^{\\mathsf{T}} \\mathbf{K}_{uu} \\boldsymbol{u} + \\boldsymbol{u}^{\\mathsf{T}} \\mathbf{K}_{u\\phi} \\boldsymbol{\\phi} + \\tfrac{1}{2} \\boldsymbol{\\phi}^{\\mathsf{T}} \\left( \\epsilon_r \\mathbf{K}_{\\phi\\phi}^{(0)} \\right) \\boldsymbol{\\phi} + \\tfrac{1}{2} \\alpha \\sum_{i=1}^{n_{\\phi}} \\phi_i^4 - \\boldsymbol{f}^{\\mathsf{T}} \\boldsymbol{u} - \\boldsymbol{r}^{\\mathsf{T}} \\boldsymbol{\\phi}.\n$$\n这里，$\\mathbf{K}_{uu} \\in \\mathbb{R}^{n_u \\times n_u}$ 和 $\\mathbf{K}_{\\phi\\phi}^{(0)} \\in \\mathbb{R}^{n_{\\phi} \\times n_{\\phi}}$ 分别是表示机械刚度和基准电刚度的对称正定矩阵，$\\mathbf{K}_{u\\phi} \\in \\mathbb{R}^{n_u \\times n_{\\phi}}$ 表示压电耦合，$\\epsilon_r > 0$ 是一个用于缩放基准电刚度的相对介电常数，$\\alpha \\ge 0$ 控制非线性介电项的强度，$\\boldsymbol{f} \\in \\mathbb{R}^{n_u}$ 是机械载荷，$\\boldsymbol{r} \\in \\mathbb{R}^{n_{\\phi}}$ 是电载荷。平稳性条件即为耦合残差方程：\n$$\n\\boldsymbol{R}_u(\\boldsymbol{u},\\boldsymbol{\\phi}) = \\mathbf{K}_{uu} \\boldsymbol{u} + \\mathbf{K}_{u\\phi} \\boldsymbol{\\phi} - \\boldsymbol{f} = \\boldsymbol{0},\n$$\n$$\n\\boldsymbol{R}_{\\phi}(\\boldsymbol{u},\\boldsymbol{\\phi}) = \\mathbf{K}_{u\\phi}^{\\mathsf{T}} \\boldsymbol{u} + \\epsilon_r \\mathbf{K}_{\\phi\\phi}^{(0)} \\boldsymbol{\\phi} + 2 \\alpha \\boldsymbol{\\phi}^{\\odot 3} - \\boldsymbol{r} = \\boldsymbol{0},\n$$\n其中 $\\boldsymbol{\\phi}^{\\odot 3}$ 表示逐元素立方。\n\n单片牛顿法构建完整残差\n$$\n\\boldsymbol{R}(\\boldsymbol{u},\\boldsymbol{\\phi}) = \\begin{bmatrix} \\boldsymbol{R}_u(\\boldsymbol{u},\\boldsymbol{\\phi}) \\\\ \\boldsymbol{R}_{\\phi}(\\boldsymbol{u},\\boldsymbol{\\phi}) \\end{bmatrix}\n$$\n的雅可比矩阵，并求解增量\n$$\n\\mathbf{J}(\\boldsymbol{u},\\boldsymbol{\\phi}) \\begin{bmatrix} \\Delta \\boldsymbol{u} \\\\ \\Delta \\boldsymbol{\\phi} \\end{bmatrix} = - \\boldsymbol{R}(\\boldsymbol{u},\\boldsymbol{\\phi}), \\quad \\text{其中} \\quad\n\\mathbf{J}(\\boldsymbol{u},\\boldsymbol{\\phi}) = \\begin{bmatrix}\n\\mathbf{K}_{uu}  \\mathbf{K}_{u\\phi} \\\\\n\\mathbf{K}_{u\\phi}^{\\mathsf{T}}  \\epsilon_r \\mathbf{K}_{\\phi\\phi}^{(0)} + 6 \\alpha \\operatorname{diag}(\\boldsymbol{\\phi}^{\\odot 2})\n\\end{bmatrix}.\n$$\n\n交错牛顿法在子问题之间交替进行：\n- 固定 $\\boldsymbol{\\phi}$，通过求解线性力学子问题来更新 $\\boldsymbol{u}$\n$$\n\\mathbf{K}_{uu} \\boldsymbol{u}^{\\text{new}} = \\boldsymbol{f} - \\mathbf{K}_{u\\phi} \\boldsymbol{\\phi}^{\\text{current}}.\n$$\n- 更新 $\\boldsymbol{u}$ 后，对电学子问题执行一个牛顿步\n$$\n\\left( \\epsilon_r \\mathbf{K}_{\\phi\\phi}^{(0)} + 6 \\alpha \\operatorname{diag}\\left((\\boldsymbol{\\phi}^{\\text{current}})^{\\odot 2}\\right) \\right) \\Delta \\boldsymbol{\\phi} = - \\left( \\mathbf{K}_{u\\phi}^{\\mathsf{T}} \\boldsymbol{u}^{\\text{new}} + \\epsilon_r \\mathbf{K}_{\\phi\\phi}^{(0)} \\boldsymbol{\\phi}^{\\text{current}} + 2 \\alpha (\\boldsymbol{\\phi}^{\\text{current}})^{\\odot 3} - \\boldsymbol{r} \\right),\n$$\n然后设置 $\\boldsymbol{\\phi}^{\\text{new}} = \\boldsymbol{\\phi}^{\\text{current}} + \\Delta \\boldsymbol{\\phi}$，可选择使用线搜索以确保残差减小。重复此过程直至完整残差收敛。\n\n您的程序必须实现这两种方法，并采用回溯线搜索以促进全局收敛：\n- 从单位步长开始，将步长减半，直到残差范数减小。如果步长低于最小阈值，则判定该初始猜测值求解失败。\n\n如果在最大迭代次数内，拼接残差的欧几里得范数低于容差 $10^{-10}$，则判定为收敛。否则，判定为失败。\n\n使用以下固定的矩阵和向量，这些矩阵和向量的选择在科学上是合理且一致的：\n- $\\mathbf{K}_{uu} = \\begin{bmatrix} 12.0  3.0 \\\\ 3.0  5.0 \\end{bmatrix}$,\n- $\\mathbf{K}_{\\phi\\phi}^{(0)} = \\begin{bmatrix} 5.0  1.0 \\\\ 1.0  3.0 \\end{bmatrix}$,\n- $\\mathbf{K}_{u\\phi} = \\begin{bmatrix} -0.8  0.2 \\\\ 0.1  -0.6 \\end{bmatrix}$,\n- $\\boldsymbol{f} = \\begin{bmatrix} 1.0 \\\\ -0.5 \\end{bmatrix}$,\n- $\\boldsymbol{r} = \\begin{bmatrix} 0.3 \\\\ -0.2 \\end{bmatrix}$.\n\n构建一个测试套件，涵盖不同的介电常数对比度和一个边界非线性情况。对于每种情况，在均匀网格 $\\{-a, 0, a\\}^{4}$ 上为 $(u_1,u_2,\\phi_1,\\phi_2)$ 采样初始猜测值，并对每个网格点运行两种求解器，统计成功收敛的次数。测试套件参数如下：\n- 情况 1：$\\epsilon_r = 1$, $\\alpha = 0.1$, $a = 1.0$。\n- 情况 2：$\\epsilon_r = 100$, $\\alpha = 0.1$, $a = 2.0$。\n- 情况 3：$\\epsilon_r = 10000$, $\\alpha = 0.1$, $a = 5.0$。\n- 情况 4（边界，线性介电）：$\\epsilon_r = 100$, $\\alpha = 0.0$, $a = 5.0$。\n\n对于每种情况，将每种求解器的近似收敛域量化为成功收敛的初始猜测值占总数（$3^4 = 81$个）的比例。该比例必须计算为 $[0,1]$ 区间内的浮点数。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，结果按以下顺序排列：\n$[\\text{M}_1,\\text{S}_1,\\text{M}_2,\\text{S}_2,\\text{M}_3,\\text{S}_3,\\text{M}_4,\\text{S}_4]$，其中 $\\text{M}_i$ 是情况 $i$ 的单片牛顿法收敛比例，$\\text{S}_i$ 是情况 $i$ 的交错牛顿法收敛比例。不涉及物理单位；所有量都是无量纲的。未使用角度。百分比必须表示为 $[0,1]$ 区间内的小数，而不是使用百分号。",
            "solution": "用户提供了一个计算固体力学领域的问题，重点是求解一个非线性机电耦合问题的数值解。任务是实现并比较两种迭代求解算法——单片牛顿法和交错牛顿法——并在一系列物理参数下评估它们的收敛行为。\n\n### 第一步：提取已知条件\n\n- **问题域**：一个压电固体的有限维模型（$n_u=2$, $n_{\\phi}=2$）。\n- **自由度**：机械位移 $\\boldsymbol{u} \\in \\mathbb{R}^2$，电势 $\\boldsymbol{\\phi} \\in \\mathbb{R}^2$。\n- **总离散能量**：\n  $$\n  \\Pi(\\boldsymbol{u},\\boldsymbol{\\phi}) = \\tfrac{1}{2} \\boldsymbol{u}^{\\mathsf{T}} \\mathbf{K}_{uu} \\boldsymbol{u} + \\boldsymbol{u}^{\\mathsf{T}} \\mathbf{K}_{u\\phi} \\boldsymbol{\\phi} + \\tfrac{1}{2} \\boldsymbol{\\phi}^{\\mathsf{T}} \\left( \\epsilon_r \\mathbf{K}_{\\phi\\phi}^{(0)} \\right) \\boldsymbol{\\phi} + \\tfrac{1}{2} \\alpha \\sum_{i=1}^{2} \\phi_i^4 - \\boldsymbol{f}^{\\mathsf{T}} \\boldsymbol{u} - \\boldsymbol{r}^{\\mathsf{T}} \\boldsymbol{\\phi}\n  $$\n- **残差方程**（源于 $\\nabla \\Pi = \\boldsymbol{0}$）：\n  - 机械：$\\boldsymbol{R}_u(\\boldsymbol{u},\\boldsymbol{\\phi}) = \\mathbf{K}_{uu} \\boldsymbol{u} + \\mathbf{K}_{u\\phi} \\boldsymbol{\\phi} - \\boldsymbol{f} = \\boldsymbol{0}$\n  - 电学：$\\boldsymbol{R}_{\\phi}(\\boldsymbol{u},\\boldsymbol{\\phi}) = \\mathbf{K}_{u\\phi}^{\\mathsf{T}} \\boldsymbol{u} + \\epsilon_r \\mathbf{K}_{\\phi\\phi}^{(0)} \\boldsymbol{\\phi} + 2 \\alpha \\boldsymbol{\\phi}^{\\odot 3} - \\boldsymbol{r} = \\boldsymbol{0}$\n- **固定的系统矩阵和向量**：\n  - 机械刚度：$\\mathbf{K}_{uu} = \\begin{bmatrix} 12.0  3.0 \\\\ 3.0  5.0 \\end{bmatrix}$（对称正定）\n  - 基准电刚度：$\\mathbf{K}_{\\phi\\phi}^{(0)} = \\begin{bmatrix} 5.0  1.0 \\\\ 1.0  3.0 \\end{bmatrix}$（对称正定）\n  - 压电耦合：$\\mathbf{K}_{u\\phi} = \\begin{bmatrix} -0.8  0.2 \\\\ 0.1  -0.6 \\end{bmatrix}$\n  - 机械载荷：$\\boldsymbol{f} = \\begin{bmatrix} 1.0 \\\\ -0.5 \\end{bmatrix}$\n  - 电载荷：$\\boldsymbol{r} = \\begin{bmatrix} 0.3 \\\\ -0.2 \\end{bmatrix}$\n- **单片牛顿法**：求解 $\\mathbf{J} \\Delta\\boldsymbol{x} = -\\boldsymbol{R}$，其雅可比矩阵为：\n  $$\n  \\mathbf{J}(\\boldsymbol{u},\\boldsymbol{\\phi}) = \\begin{bmatrix}\n  \\mathbf{K}_{uu}  \\mathbf{K}_{u\\phi} \\\\\n  \\mathbf{K}_{u\\phi}^{\\mathsf{T}}  \\epsilon_r \\mathbf{K}_{\\phi\\phi}^{(0)} + 6 \\alpha \\operatorname{diag}(\\boldsymbol{\\phi}^{\\odot 2})\n  \\end{bmatrix}\n  $$\n- **交错牛顿法**：迭代执行：\n  1. 求解 $\\boldsymbol{u}^{\\text{new}}$：$\\mathbf{K}_{uu} \\boldsymbol{u}^{\\text{new}} = \\boldsymbol{f} - \\mathbf{K}_{u\\phi} \\boldsymbol{\\phi}^{\\text{current}}$。\n  2. 使用 $\\boldsymbol{u}^{\\text{new}}$ 对 $\\boldsymbol{\\phi}$ 执行一个牛顿步：\n     - 求解 $\\Delta\\boldsymbol{\\phi}$：$\\left( \\epsilon_r \\mathbf{K}_{\\phi\\phi}^{(0)} + 6 \\alpha \\operatorname{diag}\\left((\\boldsymbol{\\phi}^{\\text{current}})^{\\odot 2}\\right) \\right) \\Delta \\boldsymbol{\\phi} = -\\boldsymbol{R}_{\\phi}(\\boldsymbol{u}^{\\text{new}}, \\boldsymbol{\\phi}^{\\text{current}})$\n- **线搜索**：对于两种方法，都使用回溯线搜索（从步长 $1.0$ 开始减半），直到完整拼接残差的欧几里得范数 $\\|\\boldsymbol{R}\\|_2$ 减小。如果步长低于最小阈值则失败。\n- **收敛标准**：在最大迭代次数内，$\\|\\boldsymbol{R}\\|_2  10^{-10}$。\n- **测试套件**：\n  - 在均匀网格 $\\{-a, 0, a\\}^{4}$ 上采样 $(\\boldsymbol{u}, \\boldsymbol{\\phi})$ 的初始猜测值。\n  - 情况 1：$\\epsilon_r = 1$, $\\alpha = 0.1$, $a = 1.0$。\n  - 情况 2：$\\epsilon_r = 100$, $\\alpha = 0.1$, $a = 2.0$。\n  - 情况 3：$\\epsilon_r = 10000$, $\\alpha = 0.1$, $a = 5.0$。\n  - 情况 4：$\\epsilon_r = 100$, $\\alpha = 0.0$, $a = 5.0$。\n- **要求输出**：一个包含 $8$ 个数字的逗号分隔列表：$[\\text{M}_1,\\text{S}_1,\\text{M}_2,\\text{S}_2,\\text{M}_3,\\text{S}_3,\\text{M}_4,\\text{S}_4]$，其中 $\\text{M}_i$ 和 $\\text{S}_i$ 分别是情况 $i$ 的单片法和交错法的收敛比例。\n\n### 第二步：使用提取的已知条件进行验证\n\n1.  **科学依据**：该问题在压电连续介质理论及其通过有限元法（伽辽金离散化）进行的数值近似方面有坚实的理论基础。能量泛函、残差方程和雅可比矩阵的推导都是正确的。矩阵 $\\mathbf{K}_{uu}$ 和 $\\mathbf{K}_{\\phi\\phi}^{(0)}$ 已确认为对称正定。非线性介电项是一个合理的简化模型。该设置在科学和数学上是合理的。\n2.  **适定性**：该问题是适定的。它明确了所有必要组成部分：控制方程、数值方法、固定数据、参数空间探索以及明确的比较指标（收敛比例）。\n3.  **客观性**：问题以精确、客观的数学语言陈述，没有主观论断。\n4.  **完整性**：问题是自洽的。虽然它省略了一些标准的数值参数，如最大迭代次数和最小线搜索步长，但这些是实现细节，可以设置为合理的标准值（例如，分别为 $50$ 和 $10^{-8}$），而不会改变问题的基本性质。这个小小的疏忽不会使问题无效。\n5.  **一致性**：问题陈述中没有内部矛盾。\n\n### 第三步：结论与行动\n\n该问题是**有效的**。它是一个表述清晰、科学合理的计算力学数值实验。我将继续执行解决方案的实现。\n\n### 基于原则的设计与实现\n\n该解决方案需要为一个非线性方程组实现两种不同的迭代求解器，以及一个测试它们的框架。实现的核心结构如下：\n\n1.  **数据表示**：固定的矩阵（$\\mathbf{K}_{uu}$, $\\mathbf{K}_{\\phi\\phi}^{(0)}$, $\\mathbf{K}_{u\\phi}$）和向量（$\\boldsymbol{f}$, $\\boldsymbol{r}$）将作为 `numpy` 数组存储。状态向量 $\\boldsymbol{x}$ 是位移向量 $\\boldsymbol{u}$ 和电势向量 $\\boldsymbol{\\phi}$ 的拼接。\n\n2.  **残差与雅可比函数**：将创建一个函数 `compute_R`，用于在给定状态 $(\\boldsymbol{u}, \\boldsymbol{\\phi})$ 和参数 $\\epsilon_r, \\alpha$ 的情况下，计算完整的残差向量 $\\boldsymbol{R} = [\\boldsymbol{R}_u, \\boldsymbol{R}_{\\phi}]^T$。雅可比矩阵 $\\mathbf{J}$ 及其子块的表达式将在需要它们的求解器函数内部直接实现。\n\n3.  **单片牛顿求解器**：一个函数 `solve_monolithic` 将实现完整的牛顿-拉夫逊方案。在每次迭代中，它将：\n    a. 计算当前残差 $\\boldsymbol{R}$ 及其范数。检查是否收敛。\n    b. 组装 $4 \\times 4$ 的雅可比矩阵 $\\mathbf{J}$。\n    c. 求解线性系统 $\\mathbf{J} \\Delta\\boldsymbol{x} = -\\boldsymbol{R}$ 以获得更新步长 $\\Delta\\boldsymbol{x} = [\\Delta\\boldsymbol{u}, \\Delta\\boldsymbol{\\phi}]^T$。\n    d. 采用回溯线搜索，从步长 $\\lambda=1$ 开始，并将其减半，直到满足条件 $\\|\\boldsymbol{R}(\\boldsymbol{x} + \\lambda \\Delta\\boldsymbol{x})\\|_2  \\|\\boldsymbol{R}(\\boldsymbol{x})\\|_2$。\n    e. 更新状态向量 $\\boldsymbol{x} \\leftarrow \\boldsymbol{x} + \\lambda \\Delta\\boldsymbol{x}$。\n    f. 如果达到最大迭代次数或线搜索步长变得过小，则以失败告终。\n\n4.  **交错牛顿求解器**：一个函数 `solve_staggered` 将实现分块高斯-赛德尔类型的迭代。在每次迭代中，它将：\n    a. 计算当前完整残差 $\\boldsymbol{R}$ 及其范数。检查是否收敛。\n    b. **机械更新**：求解线性系统 $\\mathbf{K}_{uu} \\boldsymbol{u}^{\\text{new}} = \\boldsymbol{f} - \\mathbf{K}_{u\\phi} \\boldsymbol{\\phi}^{\\text{current}}$ 以获得更新后的位移 $\\boldsymbol{u}^{\\text{new}}$。这是对机械子问题的精确求解。\n    c. **电学更新**：对电学子问题执行单个牛顿步。这包括：\n        i. 组装电学切向刚度 $\\mathbf{J}_{\\phi\\phi} = \\epsilon_r \\mathbf{K}_{\\phi\\phi}^{(0)} + 6 \\alpha \\operatorname{diag}((\\boldsymbol{\\phi}^{\\text{current}})^{\\odot 2})$。\n        ii. 计算新位移下的电学残差 $\\boldsymbol{R}_{\\phi}(\\boldsymbol{u}^{\\text{new}}, \\boldsymbol{\\phi}^{\\text{current}})$。\n        iii. 求解 $2 \\times 2$ 线性系统 $\\mathbf{J}_{\\phi\\phi} \\Delta\\boldsymbol{\\phi} = -\\boldsymbol{R}_{\\phi}(\\boldsymbol{u}^{\\text{new}}, \\boldsymbol{\\phi}^{\\text{current}})$ 以获得电势增量 $\\Delta\\boldsymbol{\\phi}$。\n    d. **线搜索与更新**：根据题目对全局残差范数减小的要求，将对电学更新应用回溯线搜索。从 $\\lambda=1$ 开始，将步长减半，直到状态 $(\\boldsymbol{u}^{\\text{new}}, \\boldsymbol{\\phi}^{\\text{current}} + \\lambda\\Delta\\boldsymbol{\\phi})$ 下的完整残差范数小于迭代开始时的范数。然后更新状态。\n    e. 如果达到最大迭代次数或线搜索失败，则以失败告终。\n\n5.  **测试框架**：一个主循环将遍历四个指定的测试用例。对于每个用例：\n    a. 从网格 $\\{-a, 0, a\\}^4$ 生成一组 $3^4 = 81$ 个初始猜测值。\n    b. 对每个初始猜测值运行 `solve_monolithic` 和 `solve_staggered`。\n    c. 统计每个求解器的成功收敛次数。\n    d. 将成功次数除以 $81$ 转换为比例。\n    e. 将这些比例收集并格式化为最终的输出字符串。\n\n这种系统化的方法确保了两种算法都按照规范实现，并且它们的性能在每个参数情况下都在相同且全面的初始条件集上进行比较，从而对其各自的收敛域进行稳健的量化。",
            "answer": "```python\nimport numpy as np\nimport itertools\n\ndef solve():\n    \"\"\"\n    Constructs and solves a finite-dimensional electro-mechanical problem to compare\n    monolithic and staggered Newton solvers.\n    \"\"\"\n\n    # --- Problem Constants and Solver Parameters ---\n    K_uu = np.array([[12.0, 3.0], [3.0, 5.0]])\n    K_pp0 = np.array([[5.0, 1.0], [1.0, 3.0]])\n    K_up = np.array([[-0.8, 0.2], [0.1, -0.6]])\n    f = np.array([1.0, -0.5])\n    r = np.array([0.3, -0.2])\n    \n    TOL = 1e-10\n    MAX_ITER = 50\n    MIN_STEP = 1e-8\n\n    # --- Nested Helper Function to Compute Residual ---\n    def compute_R(u, phi, eps_r, alpha):\n        \"\"\"Computes the full residual vector [R_u, R_phi].\"\"\"\n        R_u = K_uu @ u + K_up @ phi - f\n        phi_cubed = np.power(phi, 3)\n        R_p = K_up.T @ u + eps_r * (K_pp0 @ phi) + 2 * alpha * phi_cubed - r\n        return np.concatenate((R_u, R_p))\n\n    # --- Nested Solver Implementations ---\n    def solve_monolithic(u0, phi0, eps_r, alpha):\n        \"\"\"Solves the coupled system using a monolithic Newton-Raphson scheme.\"\"\"\n        u = u0.copy()\n        phi = phi0.copy()\n\n        for _ in range(MAX_ITER):\n            R = compute_R(u, phi, eps_r, alpha)\n            current_norm = np.linalg.norm(R)\n\n            if current_norm  TOL:\n                return True\n\n            # Assemble Jacobian\n            J_uu = K_uu\n            J_up = K_up\n            J_pu = K_up.T\n            phi_squared = np.power(phi, 2)\n            J_pp = eps_r * K_pp0 + 6 * alpha * np.diag(phi_squared)\n            J = np.block([[J_uu, J_up], [J_pu, J_pp]])\n\n            try:\n                delta_x = np.linalg.solve(J, -R)\n            except np.linalg.LinAlgError:\n                return False  # Singular Jacobian\n\n            delta_u, delta_phi = delta_x[:2], delta_x[2:]\n\n            # Backtracking line search\n            step = 1.0\n            line_search_success = False\n            while step > MIN_STEP:\n                u_new = u + step * delta_u\n                phi_new = phi + step * delta_phi\n                \n                # Heuristic to prevent overflow in residual calculation with large steps\n                if np.any(np.abs(phi_new) > 1e12):\n                    step /= 2.0\n                    continue\n\n                R_new = compute_R(u_new, phi_new, eps_r, alpha)\n                if np.linalg.norm(R_new)  current_norm:\n                    u, phi = u_new, phi_new\n                    line_search_success = True\n                    break\n                step /= 2.0\n            \n            if not line_search_success:\n                return False  # Line search failed\n\n        return np.linalg.norm(compute_R(u, phi, eps_r, alpha))  TOL\n\n    def solve_staggered(u0, phi0, eps_r, alpha):\n        \"\"\"Solves the coupled system using a staggered (block Gauss-Seidel) scheme.\"\"\"\n        u = u0.copy()\n        phi = phi0.copy()\n\n        for _ in range(MAX_ITER):\n            R_old = compute_R(u, phi, eps_r, alpha)\n            current_norm = np.linalg.norm(R_old)\n\n            if current_norm  TOL:\n                return True\n\n            # Mechanical Subproblem (u-update)\n            rhs_u = f - K_up @ phi\n            try:\n                u_new = np.linalg.solve(K_uu, rhs_u)\n            except np.linalg.LinAlgError:\n                return False\n\n            # Electrical Subproblem (phi-update, one Newton step)\n            R_p_at_new_u = K_up.T @ u_new + eps_r * (K_pp0 @ phi) + 2 * alpha * np.power(phi, 3) - r\n            J_pp = eps_r * K_pp0 + 6 * alpha * np.diag(np.power(phi, 2))\n            \n            try:\n                delta_phi = np.linalg.solve(J_pp, -R_p_at_new_u)\n            except np.linalg.LinAlgError:\n                return False\n\n            # Backtracking line search on the phi update, checking full residual norm\n            step = 1.0\n            line_search_success = False\n            while step > MIN_STEP:\n                phi_new = phi + step * delta_phi\n\n                if np.any(np.abs(phi_new) > 1e12):\n                    step /= 2.0\n                    continue\n\n                R_new = compute_R(u_new, phi_new, eps_r, alpha)\n                if np.linalg.norm(R_new)  current_norm:\n                    u, phi = u_new, phi_new\n                    line_search_success = True\n                    break\n                step /= 2.0\n            \n            if not line_search_success:\n                return False  # Line search failed\n\n        return np.linalg.norm(compute_R(u, phi, eps_r, alpha))  TOL\n\n    # --- Main Execution Logic ---\n    test_cases = [\n        (1.0, 0.1, 1.0),\n        (100.0, 0.1, 2.0),\n        (10000.0, 0.1, 5.0),\n        (100.0, 0.0, 5.0),\n    ]\n\n    results = []\n    \n    for eps_r, alpha, a in test_cases:\n        grid_points = [-a, 0.0, a]\n        initial_guesses = [np.array(p) for p in itertools.product(grid_points, repeat=4)]\n        num_guesses = len(initial_guesses)\n\n        monolithic_success = 0\n        staggered_success = 0\n\n        for x0 in initial_guesses:\n            u0, phi0 = x0[:2], x0[2:]\n\n            if solve_monolithic(u0.copy(), phi0.copy(), eps_r, alpha):\n                monolithic_success += 1\n            \n            if solve_staggered(u0.copy(), phi0.copy(), eps_r, alpha):\n                staggered_success += 1\n        \n        mono_frac = monolithic_success / num_guesses\n        stag_frac = staggered_success / num_guesses\n        results.extend([mono_frac, stag_frac])\n\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}