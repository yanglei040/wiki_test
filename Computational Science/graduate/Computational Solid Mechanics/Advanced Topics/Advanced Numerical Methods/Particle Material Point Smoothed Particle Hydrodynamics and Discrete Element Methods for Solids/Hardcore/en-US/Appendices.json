{
    "hands_on_practices": [
        {
            "introduction": "The kernel is the heart of the Smoothed Particle Hydrodynamics (SPH) method, defining how physical quantities are interpolated from discrete particle locations. To ensure the method is consistent—for instance, to correctly reproduce a constant field—the kernel must satisfy a normalization condition. This practice provides essential experience in verifying this property for a standard cubic spline kernel, a task that involves fundamental calculus and reinforces a core principle of SPH theory. ",
            "id": "3586445",
            "problem": "In Smoothed Particle Hydrodynamics (SPH), the kernel function must be normalized so that it integrates to unity over the spatial domain to ensure consistency of particle-based approximations. Consider the two-dimensional cubic spline kernel used in solid mechanics, defined radially by\n$$\nW(\\|x\\|, h) = \\alpha_{2}\\, f\\!\\left(q\\right), \\quad q = \\frac{\\|x\\|}{h}, \\quad h  0,\n$$\nwhere the dimensionless shape function $f(q)$ is given by the compactly supported piecewise polynomial\n$$\nf(q) = \n\\begin{cases}\n1 - \\frac{3}{2} q^{2} + \\frac{3}{4} q^{3},  0 \\leq q  1, \\\\\n\\frac{1}{4} (2 - q)^{3},  1 \\leq q  2, \\\\\n0,  q \\geq 2.\n\\end{cases}\n$$\nThe normalization constant $\\alpha_{2}$ depends on the smoothing length $h$ and the spatial dimension. Enforce the normalization condition\n$$\n\\int_{\\mathbb{R}^{2}} W\\!\\left(\\|x\\|, h\\right)\\, dx = 1,\n$$\nand compute $\\alpha_{2}$ explicitly. Then verify the result by evaluating the integral in plane polar coordinates with the change of variables $r = \\|x\\|$ and $q = r/h$. Provide your final answer as a closed-form analytic expression in terms of $h$ and $\\pi$. No rounding is required.",
            "solution": "The normalization of the kernel in two dimensions requires that the integral of $W(\\|x\\|, h)$ over $\\mathbb{R}^{2}$ equals $1$. Because $W$ is radially symmetric and compactly supported on $\\|x\\|  2h$, it is natural to use plane polar coordinates. Let $r = \\|x\\|$. The area element is $dx = r\\, d\\theta\\, dr$, and the integral becomes\n$$\n\\int_{\\mathbb{R}^{2}} W\\!\\left(\\|x\\|, h\\right)\\, dx = \\int_{0}^{2\\pi} \\int_{0}^{2h} \\alpha_{2}\\, f\\!\\left(\\frac{r}{h}\\right)\\, r\\, dr\\, d\\theta.\n$$\nThis simplifies to\n$$\n\\int_{\\mathbb{R}^{2}} W\\!\\left(\\|x\\|, h\\right)\\, dx = 2\\pi\\, \\alpha_{2} \\int_{0}^{2h} f\\!\\left(\\frac{r}{h}\\right)\\, r\\, dr.\n$$\nIntroduce the dimensionless variable $q = r/h$, so that $r = h q$ and $dr = h\\, dq$. The support $0 \\leq r  2h$ maps to $0 \\leq q  2$. Thus,\n$$\n\\int_{0}^{2h} f\\!\\left(\\frac{r}{h}\\right)\\, r\\, dr = \\int_{0}^{2} f(q)\\, (h q)\\, h\\, dq = h^{2} \\int_{0}^{2} f(q)\\, q\\, dq.\n$$\nTherefore, the normalization condition becomes\n$$\n2\\pi\\, \\alpha_{2}\\, h^{2} \\int_{0}^{2} f(q)\\, q\\, dq = 1.\n$$\nSolving for $\\alpha_{2}$ yields\n$$\n\\alpha_{2} = \\frac{1}{2\\pi\\, h^{2} \\displaystyle\\int_{0}^{2} f(q)\\, q\\, dq}.\n$$\nIt remains to compute the integral of $f(q)\\, q$ over $[0,2]$. Using the piecewise definition of $f(q)$,\n$$\n\\int_{0}^{2} f(q)\\, q\\, dq = \\int_{0}^{1} \\left(1 - \\frac{3}{2} q^{2} + \\frac{3}{4} q^{3}\\right) q\\, dq + \\int_{1}^{2} \\left(\\frac{1}{4} (2 - q)^{3}\\right) q\\, dq.\n$$\nCompute the first integral:\n$$\n\\int_{0}^{1} \\left( q - \\frac{3}{2} q^{3} + \\frac{3}{4} q^{4} \\right) dq = \\left[ \\frac{1}{2} q^{2} - \\frac{3}{8} q^{4} + \\frac{3}{20} q^{5} \\right]_{0}^{1} = \\frac{1}{2} - \\frac{3}{8} + \\frac{3}{20}.\n$$\nCombine the fractions:\n$$\n\\frac{1}{2} - \\frac{3}{8} + \\frac{3}{20} = \\frac{20}{40} - \\frac{15}{40} + \\frac{6}{40} = \\frac{11}{40}.\n$$\nCompute the second integral. Use the substitution $u = 2 - q$ with $du = - dq$, which maps $q \\in [1,2]$ to $u \\in [1,0]$. Then\n$$\n\\int_{1}^{2} \\left(\\frac{1}{4} (2 - q)^{3}\\right) q\\, dq = \\int_{u=1}^{0} \\frac{1}{4} u^{3} (2 - u)\\, (-du) = \\int_{0}^{1} \\frac{1}{4} u^{3} (2 - u)\\, du.\n$$\nEvaluate:\n$$\n\\int_{0}^{1} \\frac{1}{4} \\left(2 u^{3} - u^{4}\\right) du = \\frac{1}{4} \\left( 2 \\int_{0}^{1} u^{3} du - \\int_{0}^{1} u^{4} du \\right) = \\frac{1}{4} \\left( 2 \\cdot \\frac{1}{4} - \\frac{1}{5} \\right) = \\frac{1}{4} \\left( \\frac{1}{2} - \\frac{1}{5} \\right) = \\frac{1}{4} \\cdot \\frac{3}{10} = \\frac{3}{40}.\n$$\nThus,\n$$\n\\int_{0}^{2} f(q)\\, q\\, dq = \\frac{11}{40} + \\frac{3}{40} = \\frac{14}{40} = \\frac{7}{20}.\n$$\nSubstitute this into the expression for $\\alpha_{2}$:\n$$\n\\alpha_{2} = \\frac{1}{2\\pi\\, h^{2} \\cdot \\frac{7}{20}} = \\frac{1}{\\frac{7\\pi}{10}\\, h^{2}} = \\frac{10}{7\\pi\\, h^{2}}.\n$$\nTo verify by polar integration, substitute $\\alpha_{2} = \\frac{10}{7\\pi\\, h^{2}}$ back into the normalized integral:\n$$\n\\int_{\\mathbb{R}^{2}} W\\!\\left(\\|x\\|, h\\right)\\, dx = 2\\pi\\, \\alpha_{2} \\int_{0}^{2h} f\\!\\left(\\frac{r}{h}\\right)\\, r\\, dr = 2\\pi \\cdot \\frac{10}{7\\pi\\, h^{2}} \\cdot h^{2} \\int_{0}^{2} f(q)\\, q\\, dq = \\frac{20}{7} \\cdot \\frac{7}{20} = 1,\n$$\nconfirming the correctness of the normalization.",
            "answer": "$$\\boxed{\\frac{10}{7\\pi h^{2}}}$$"
        },
        {
            "introduction": "In the Material Point Method (MPM), the dialogue between Lagrangian particles and the Eulerian grid is mediated by shape functions. The Generalized Interpolation Material Point (GIMP) method refines this dialogue by giving particles a finite size, which significantly reduces the numerical noise generated when particles cross cell boundaries. This exercise guides you through the derivation of the GIMP 'effective' shape function, revealing the mathematical elegance behind its improved accuracy and stability. ",
            "id": "3586408",
            "problem": "Consider the one-dimensional Material Point Method (MPM) with the Generalized Interpolation Material Point (GIMP) formulation. Let the computational grid be uniform with spacing $\\Delta x$ and nodes at positions $\\{x_I\\}$. The standard nodal shape function for node $I$ is the linear “hat” function $N_I(x)$ with compact support on $[x_{I-1}, x_{I+1}]$. In the GIMP formulation, a particle is represented by a material point at position $x_p$ together with a finite domain (particle characteristic function) taken here as a top-hat of half-length $l_p$. The one-dimensional GIMP effective shape function is defined by averaging the grid shape function over the particle domain. Specifically, for node $I$, the effective shape function $\\tilde{N}_I(x_p)$ is the average of $N_I(x)$ over the interval $[x_p - l_p, x_p + l_p]$.\n\nStarting from these definitions, derive the closed-form, piecewise expression of the one-dimensional GIMP effective shape function $\\tilde{N}_I(x_p)$ in terms of the nondimensional particle position $s = (x_p - x_I)/\\Delta x$ and the nondimensional particle half-length $r = l_p/\\Delta x$, for $0  r \\leq 1$. Your derivation must explicitly account for the overlap between the particle domain and the compact support of $N_I(x)$ and must produce the explicit piecewise formula for $\\tilde{N}_I$ on its full support.\n\nThen, consider a particle “crossing an element boundary,” meaning the material point is instantaneously located at the grid node that forms the common boundary between two adjacent elements. Take this node to be $x_I$ so that $x_p = x_I$ at the crossing (i.e., $s = 0$). For $l_p = 0.25\\,\\Delta x$ (so $r = 0.25$), compute the derivative $\\partial_x \\tilde{N}_I(x_p)$ evaluated at the crossing.\n\nReport the final derivative as the nondimensional quantity $\\Delta x\\,\\partial_x \\tilde{N}_I(x_p)$ evaluated at $x_p = x_I$ with $r = 0.25$. No rounding is required. Do not include units in your final answer.",
            "solution": "The GIMP effective shape function, $\\tilde{N}_I(x_p)$, is the average of the nodal shape function $N_I(x)$ over the particle's domain $[x_p-l_p, x_p+l_p]$:\n$$\n\\tilde{N}_I(x_p) = \\frac{1}{2l_p} \\int_{x_p-l_p}^{x_p+l_p} N_I(x) \\, dx\n$$\nWe perform the analysis in a non-dimensional local coordinate system centered at node $I$. Let $\\eta = (x - x_I)/\\Delta x$. The nodal shape function becomes $N(\\eta) = 1 - |\\eta|$ for $\\eta \\in [-1, 1]$ and $N(\\eta) = 0$ otherwise. The non-dimensional particle position is $s = (x_p - x_I)/\\Delta x$ and the non-dimensional particle half-length is $r = l_p/\\Delta x$. The effective shape function is then:\n$$\n\\tilde{N}(s) = \\frac{1}{2r} \\int_{s-r}^{s+r} N(\\eta) \\, d\\eta\n$$\nThe function $\\tilde{N}(s)$ is even, so we only need to derive it for $s \\ge 0$. The support of $\\tilde{N}(s)$ is $|s| \\le 1+r$. We consider the case $0  r \\le 1/2$, which includes the required $r=0.25$.\n\nThe piecewise form depends on the overlap between the integration interval $[s-r, s+r]$ and the support of $N(\\eta)$, which is $[-1, 1]$.\n1.  **For $0 \\le s \\le r$**: The interval $[s-r, s+r]$ contains $\\eta=0$.\n    $$\n    \\tilde{N}(s) = \\frac{1}{2r} \\left[ \\int_{s-r}^{0} (1+\\eta) \\, d\\eta + \\int_{0}^{s+r} (1-\\eta) \\, d\\eta \\right] = \\frac{1}{2r} \\left[ \\left(\\eta+\\frac{\\eta^2}{2}\\right)\\bigg|_{s-r}^{0} + \\left(\\eta-\\frac{\\eta^2}{2}\\right)\\bigg|_{0}^{s+r} \\right]\n    $$\n    $$\n    = \\frac{1}{2r} \\left[ -\\left(s-r+\\frac{(s-r)^2}{2}\\right) + \\left(s+r-\\frac{(s+r)^2}{2}\\right) \\right] = \\frac{1}{2r} (2r - s^2 - r^2) = 1 - \\frac{s^2+r^2}{2r}\n    $$\n2.  **For $r  s  1-r$**: The interval $[s-r, s+r]$ lies entirely in $(0, 1)$.\n    $$\n    \\tilde{N}(s) = \\frac{1}{2r} \\int_{s-r}^{s+r} (1-\\eta) \\, d\\eta = \\frac{1}{2r} \\left[ \\eta-\\frac{\\eta^2}{2} \\right]_{s-r}^{s+r} = \\frac{1}{2r} (2r-2sr) = 1-s\n    $$\n3.  **For $1-r \\le s \\le 1+r$**: The integration is over $[s-r, 1]$.\n    $$\n    \\tilde{N}(s) = \\frac{1}{2r} \\int_{s-r}^{1} (1-\\eta) \\, d\\eta = \\frac{1}{2r} \\left[ -\\frac{(1-\\eta)^2}{2} \\right]_{s-r}^{1} = \\frac{(1-s+r)^2}{4r}\n    $$\nThis completes the derivation of the effective shape function for $s \\ge 0$. By symmetry, the full expression uses $|s|$.\n\nFor the second part, we need the derivative at $x_p = x_I$ ($s=0$) for $r=0.25$. The non-dimensional derivative is $\\Delta x\\,\\partial_x \\tilde{N}_I(x_p) = \\frac{d\\tilde{N}}{ds}$.\nFor $r=0.25$, we are in the case $0  r \\le 1/2$. The expression for $\\tilde{N}(s)$ near $s=0$ is given by the first piece:\n$$\n\\tilde{N}(s) = 1 - \\frac{s^2+r^2}{2r}\n$$\nTaking the derivative with respect to $s$:\n$$\n\\frac{d\\tilde{N}}{ds} = \\frac{d}{ds} \\left( 1 - \\frac{s^2+r^2}{2r} \\right) = - \\frac{2s}{2r} = -\\frac{s}{r}\n$$\nEvaluating this derivative at $s=0$:\n$$\n\\left. \\frac{d\\tilde{N}}{ds} \\right|_{s=0} = -\\frac{0}{r} = 0\n$$\nThe nondimensional derivative is 0. This smoothness of the derivative at the cell boundary is a key feature of GIMP that reduces cell-crossing error.",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "In the Discrete Element Method (DEM), the stability of computationally efficient explicit time integration schemes is paramount. This stability is governed by the system's highest natural frequency, which is determined by the physical properties of the particle contacts. This hands-on exercise demonstrates how to derive the critical time step from first principles, connecting the stiffness of the contact model directly to the numerical constraints of the simulation. ",
            "id": "3586437",
            "problem": "In particle-based computational solid mechanics, the Discrete Element Method (DEM) models contact between material points using linearized springs in the normal and tangential directions with Coulomb friction. Consider a single spherical particle of mass $m$ translating in the plane and contacting a rigid wall. The local contact response is modeled by a linear normal spring of stiffness $k_{n}$ and a linear tangential spring of stiffness $k_{t}$, and the contact obeys Coulomb friction with coefficient $\\mu$. Let the instantaneous normal overlap be $\\delta_{n}$ and the instantaneous tangential elastic displacement be $\\delta_{t}$.\n\nYou are asked to determine the most restrictive explicit time step for an undamped explicit time integrator based on first principles. Proceed by: (i) using Newton’s second law to construct the small-oscillation model for the contact in the normal and tangential directions, (ii) determining whether the contact is in sticking or sliding using the Coulomb condition, (iii) identifying the highest undamped angular frequency of the linearized system under the applicable stick or slide state, and (iv) enforcing a two-samples-per-period resolution requirement for the fastest mode to avoid aliasing in an explicit time march. From that, compute the most restrictive explicit time step.\n\nUse the following data, which are representative of a stiff small-particle contact:\n- $m = 2.0 \\times 10^{-4}$,\n- $k_{n} = 8.0 \\times 10^{6}$,\n- $k_{t} = 2.4 \\times 10^{6}$,\n- $\\mu = 0.50$,\n- $\\delta_{n} = 2.0 \\times 10^{-5}$,\n- $\\delta_{t} = 5.0 \\times 10^{-6}$.\n\nAll quantities above are in coherent SI units. Round your answer to four significant figures. Express the final time step in microseconds. In addition to reporting the final time step, compare the contribution of the tangential stiffness by computing the corresponding explicit time step for the tangential mode and determining which mode controls.",
            "solution": "The solution proceeds by determining the highest natural frequency of the particle-wall system and using it to find the critical time step for a stable explicit integration.\n\n**(i) Small-Oscillation Model and Natural Frequencies**\nThe system is modeled as a mass $m$ connected to uncoupled linear springs in the normal and tangential directions. The equations of motion for small oscillations are:\n$$\nm \\ddot{u}_n + k_n u_n = 0 \\quad \\text{(normal direction)}\n$$\n$$\nm \\ddot{u}_t + k_t u_t = 0 \\quad \\text{(tangential direction)}\n$$\nwhere $u_n$ and $u_t$ are the dynamic displacements. These equations describe simple harmonic motion. The corresponding undamped angular frequencies are:\n$$\n\\omega_n = \\sqrt{\\frac{k_n}{m}} \\quad \\text{and} \\quad \\omega_t = \\sqrt{\\frac{k_t}{m}}\n$$\nThese frequencies are relevant only if the contact is in a sticking state, allowing for tangential oscillations.\n\n**(ii) Determination of Sticking vs. Sliding State**\nThe contact state is determined by the Coulomb friction law. The contact sticks if the tangential force, $|F_t|$, is less than the maximum allowable static friction force, $\\mu |F_n|$.\nFirst, we compute the normal force $F_n$:\n$$\nF_n = k_n \\delta_n = (8.0 \\times 10^{6} \\text{ N/m}) \\times (2.0 \\times 10^{-5} \\text{ m}) = 160 \\text{ N}\n$$\nNext, we compute the tangential force $F_t$:\n$$\nF_t = k_t \\delta_t = (2.4 \\times 10^{6} \\text{ N/m}) \\times (5.0 \\times 10^{-6} \\text{ m}) = 12 \\text{ N}\n$$\nThe maximum static friction force is:\n$$\nF_{f,max} = \\mu F_n = 0.50 \\times 160 \\text{ N} = 80 \\text{ N}\n$$\nSince $|F_t| = 12 \\text{ N}  F_{f,max} = 80 \\text{ N}$, the contact is in a **sticking** state. Both normal and tangential oscillatory modes are active.\n\n**(iii) Identification of the Highest Undamped Angular Frequency**\nWe calculate the angular frequencies for both modes:\nNormal mode frequency:\n$$\n\\omega_n = \\sqrt{\\frac{k_n}{m}} = \\sqrt{\\frac{8.0 \\times 10^{6}}{2.0 \\times 10^{-4}}} = \\sqrt{4.0 \\times 10^{10}} = 2.0 \\times 10^5 \\text{ rad/s}\n$$\nTangential mode frequency:\n$$\n\\omega_t = \\sqrt{\\frac{k_t}{m}} = \\sqrt{\\frac{2.4 \\times 10^6}{2.0 \\times 10^{-4}}} = \\sqrt{1.2 \\times 10^{10}} \\approx 1.0954 \\times 10^5 \\text{ rad/s}\n$$\nThe highest frequency in the system determines the stability limit.\n$$\n\\omega_{max} = \\max(\\omega_n, \\omega_t) = \\omega_n = 2.0 \\times 10^5 \\text{ rad/s}\n$$\nThe normal mode is faster and thus **controls** the time step.\n\n**(iv) Computation of the Most Restrictive Explicit Time Step**\nThe \"two-samples-per-period\" requirement means the time step $\\Delta t$ must be no more than half the shortest period, $T_{min}$.\n$$\nT_{min} = \\frac{2\\pi}{\\omega_{max}}\n$$\nThe critical time step $\\Delta t_{crit}$ is therefore:\n$$\n\\Delta t_{crit} \\le \\frac{T_{min}}{2} = \\frac{1}{2} \\left( \\frac{2\\pi}{\\omega_{max}} \\right) = \\frac{\\pi}{\\omega_{max}}\n$$\nSubstituting the value of $\\omega_{max}$:\n$$\n\\Delta t_{crit} = \\frac{\\pi}{2.0 \\times 10^5 \\text{ s}^{-1}} \\approx 1.570796 \\times 10^{-5} \\text{ s}\n$$\nConverting to microseconds and rounding to four significant figures:\n$$\n\\Delta t_{crit} \\approx 15.70796 \\text{ }\\mu\\text{s} \\approx 15.71 \\text{ }\\mu\\text{s}\n$$\nThe most restrictive explicit time step is 15.71 $\\mu$s, and it is controlled by the normal contact stiffness.",
            "answer": "$$\\boxed{15.71}$$"
        }
    ]
}