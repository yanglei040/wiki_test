{
    "hands_on_practices": [
        {
            "introduction": "本练习将引导你为一个非常简单的一维问题手动构建多重网格的核心算子——延拓算子（$P$）、限制算子（$R$）和粗网格算子（$A_c$）。通过显式计算这些矩阵及其特征值，我们可以直接观察到伽辽金（Galerkin）投影的一个基本性质：粗、细网格谱的交错特性。这为粗网格算子如何表示细网格问题提供了具体的直观认识。",
            "id": "3290960",
            "problem": "考虑计算流体动力学 (CFD) 中的一维压力泊松方程 $- \\partial_{x}^{2} p = f$，该方程定义在单位区间上，两端均采用齐次狄利克雷边界条件。使用二阶中心差分近似，在一个包含 $3$ 个内部未知数且无量纲间距为 $h = 1$ 的均匀细网格上对该方程进行离散化。这会产生一个对称正定 (SPD) 的细网格算子 $A \\in \\mathbb{R}^{3 \\times 3}$，即典型的三对角离散拉普拉斯算子。在代数多重网格 (AMG) 的背景下，定义一个由与细网格点 $1$ 和 $3$ 对齐的 $2$ 个粗网格点组成的粗网格，并通过线性插值构建一个延拓算子 $P \\in \\mathbb{R}^{3 \\times 2}$，该算子将粗网格未知数 $\\begin{pmatrix} u_{C}^{1} \\\\ u_{C}^{2} \\end{pmatrix}$ 映射到细网格未知数 $\\begin{pmatrix} u_{f}^{1} \\\\ u_{f}^{2} \\\\ u_{f}^{3} \\end{pmatrix}$，具体映射关系为 $u_{f}^{1} = u_{C}^{1}$，$u_{f}^{2} = \\frac{1}{2} u_{C}^{1} + \\frac{1}{2} u_{C}^{2}$，以及 $u_{f}^{3} = u_{C}^{2}$。使用对称伽辽金选择来定义限制算子 $R = P^{\\top}$。从有限差分离散和离散拉普拉斯算子的对称正定性出发，显式构造 $R$ 和 $P$，计算粗网格算子 $A_{c} = R A P$，并确定 $A$ 和 $A_{c}$ 的谱（特征值集合）。然后，使用 SPD 矩阵 Ritz 值的基本原理，验证粗网格特征值与细网格特征值交错。作为最终报告结果，请提供 $A_{c}$ 的两个粗网格特征值的精确值。无需四舍五入；由于 $h = 1$，答案是无量纲的。",
            "solution": "问题陈述已经过验证，被认为是自洽的、有科学依据且适定的。尽管“Ritz 值的第一性原理”这一措辞在此背景下技术上不甚精确，但核心任务在数学上是合理的，并且所要求的验证对于此特定问题是成立的。我们现在可以开始求解。\n\n一维压力泊松方程为 $- \\partial_{x}^{2} p = f$，带有齐次狄利克雷边界条件。使用二阶中心差分格式 $\\frac{-p_{i-1} + 2p_i - p_{i+1}}{h^2}$，在具有 $N=3$ 个内部点和无量纲网格间距 $h=1$ 的均匀网格上对此方程进行离散化，得到一个线性系统 $A\\mathbf{p} = \\mathbf{f}$。矩阵 $A$ 是 $3 \\times 3$ 的离散拉普拉斯算子。给定 $p_0=0$ 和 $p_4=0$，细网格算子 $A$ 为：\n$$\nA = \\begin{pmatrix} 2  -1  0 \\\\ -1  2  -1 \\\\ 0  -1  2 \\end{pmatrix}\n$$\n该矩阵是对称的，并且从其特征值中我们可以看到，它是正定的。\n\n问题定义了一个延拓（插值）算子 $P \\in \\mathbb{R}^{3 \\times 2}$，它将一个包含 $2$ 个未知数的粗网格向量 $u_C = \\begin{pmatrix} u_C^1 \\\\ u_C^2 \\end{pmatrix}$ 映射到一个包含 $3$ 个未知数的细网格向量 $u_f = \\begin{pmatrix} u_f^1 \\\\ u_f^2 \\\\ u_f^3 \\end{pmatrix}$。映射关系定义为：\n$u_f^1 = u_C^1$\n$u_f^2 = \\frac{1}{2} u_C^1 + \\frac{1}{2} u_C^2$\n$u_f^3 = u_C^2$\n以矩阵形式 $u_f = P u_C$ 表示，延拓算子为：\n$$\nP = \\begin{pmatrix} 1  0 \\\\ \\frac{1}{2}  \\frac{1}{2} \\\\ 0  1 \\end{pmatrix}\n$$\n限制算子 $R$ 通过对称伽辽金选择构造，即 $R = P^{\\top}$。因此，$R \\in \\mathbb{R}^{2 \\times 3}$ 为：\n$$\nR = \\begin{pmatrix} 1  \\frac{1}{2}  0 \\\\ 0  \\frac{1}{2}  1 \\end{pmatrix}\n$$\n粗网格算子 $A_c$ 由伽辽金投影 $A_c = R A P = P^{\\top} A P$ 形成。我们分两步计算这个乘积。首先，我们计算 $A P$：\n$$\nA P = \\begin{pmatrix} 2  -1  0 \\\\ -1  2  -1 \\\\ 0  -1  2 \\end{pmatrix} \\begin{pmatrix} 1  0 \\\\ \\frac{1}{2}  \\frac{1}{2} \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} 2(1) - 1(\\frac{1}{2})   2(0) - 1(\\frac{1}{2}) \\\\ -1(1) + 2(\\frac{1}{2})   -1(0) + 2(\\frac{1}{2}) - 1(1) \\\\ -1(\\frac{1}{2})   -1(\\frac{1}{2}) + 2(1) \\end{pmatrix} = \\begin{pmatrix} \\frac{3}{2}   -\\frac{1}{2} \\\\ 0   0 \\\\ -\\frac{1}{2}   \\frac{3}{2} \\end{pmatrix}\n$$\n接下来，我们左乘 $R$ 来求得 $A_c$：\n$$\nA_c = R (A P) = \\begin{pmatrix} 1  \\frac{1}{2}  0 \\\\ 0  \\frac{1}{2}  1 \\end{pmatrix} \\begin{pmatrix} \\frac{3}{2}   -\\frac{1}{2} \\\\ 0   0 \\\\ -\\frac{1}{2}   \\frac{3}{2} \\end{pmatrix} = \\begin{pmatrix} \\frac{3}{2}   -\\frac{1}{2} \\\\ -\\frac{1}{2}   \\frac{3}{2} \\end{pmatrix}\n$$\n现在，我们确定 $A$ 和 $A_c$ 的谱。\n细网格算子 $A$ 的特征值，记为 $\\lambda_A$，是特征方程 $\\det(A - \\lambda_A I) = 0$ 的根：\n$$\n\\det \\begin{pmatrix} 2-\\lambda_A  -1  0 \\\\ -1  2-\\lambda_A  -1 \\\\ 0  -1  2-\\lambda_A \\end{pmatrix} = (2-\\lambda_A)((2-\\lambda_A)^2 - 1) - (-1)(-(2-\\lambda_A)) = (2-\\lambda_A)((2-\\lambda_A)^2 - 2) = 0\n$$\n这给出一个特征值 $\\lambda_A = 2$，另外两个来自 $(2-\\lambda_A)^2 = 2$，即 $2-\\lambda_A = \\pm\\sqrt{2}$，或 $\\lambda_A = 2 \\mp \\sqrt{2}$。$A$ 的排序后的特征值为：\n$\\lambda_1(A) = 2 - \\sqrt{2}$\n$\\lambda_2(A) = 2$\n$\\lambda_3(A) = 2 + \\sqrt{2}$\n所有特征值均为正，这证实了 $A$ 是正定的。\n\n粗网格算子 $A_c$ 的特征值，记为 $\\lambda_c$，是方程 $\\det(A_c - \\lambda_c I) = 0$ 的根：\n$$\n\\det \\begin{pmatrix} \\frac{3}{2}-\\lambda_c   -\\frac{1}{2} \\\\ -\\frac{1}{2}   \\frac{3}{2}-\\lambda_c \\end{pmatrix} = \\left(\\frac{3}{2}-\\lambda_c\\right)^2 - \\left(-\\frac{1}{2}\\right)^2 = \\left(\\frac{3}{2}-\\lambda_c\\right)^2 - \\frac{1}{4} = 0\n$$\n这意味着 $\\left(\\frac{3}{2}-\\lambda_c\\right)^2 = \\frac{1}{4}$，所以 $\\frac{3}{2}-\\lambda_c = \\pm\\frac{1}{2}$。由此得到特征值 $\\lambda_c = \\frac{3}{2} \\mp \\frac{1}{2}$。$A_c$ 的排序后的特征值为：\n$\\lambda_1(A_c) = \\frac{3}{2} - \\frac{1}{2} = 1$\n$\\lambda_2(A_c) = \\frac{3}{2} + \\frac{1}{2} = 2$\n\n最后，我们验证特征值交错性质。对于 SPD 矩阵，Courant-Fischer 最小-最大原理指出，伽辽金投影系统的特征值与原系统的特征值交错。对于一个 $n \\times n$ 的 SPD 矩阵 $A$ 和一个 $n \\times m$ 的满秩延拓矩阵 $P$ ($m  n$)，广义特征值问题 $P^{\\top}AP y = \\mu (P^{\\top}P) y$ 的特征值 $\\mu_k$ 与 $A$ 的特征值 $\\lambda_k$ 交错。即，对于 $k=1, \\dots, m$，有 $\\lambda_k(A) \\le \\mu_k \\le \\lambda_{k+n-m}(A)$。这些 $\\mu_k$ 是真正的 Ritz 值。本问题要求我们验证的是标准特征值 $\\lambda_k(A_c)$ 的此性质。我们直接进行检验。\n此处，$n=3$，$m=2$。我们必须验证对于 $k=1, 2$，有 $\\lambda_k(A) \\le \\lambda_k(A_c) \\le \\lambda_{k+1}(A)$。\n对于 $k=1$：\n$$\n\\lambda_1(A) \\le \\lambda_1(A_c) \\le \\lambda_2(A) \\implies 2 - \\sqrt{2} \\le 1 \\le 2\n$$\n因为 $1  \\sqrt{2}  2$，所以有 $0  2-\\sqrt{2}  1$。因此，$2 - \\sqrt{2} \\le 1$ 成立。同时，$1 \\le 2$ 也成立。第一个交错条件得到满足。\n对于 $k=2$：\n$$\n\\lambda_2(A) \\le \\lambda_2(A_c) \\le \\lambda_3(A) \\implies 2 \\le 2 \\le 2 + \\sqrt{2}\n$$\n此条件也得到满足。因此，对于这个特定问题，$A_c$ 的标准特征值满足交错性质。\n\n$A_c$ 的两个粗网格特征值为 $1$ 和 $2$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1  2\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "一个成功的多重网格方法依赖于粗网格能够近似并校正光滑误差分量的能力。本练习故意展示了一个“糟糕”的延拓算子的选择，以揭示当这一“近似性质”被违反时会发生什么。通过分析一个特定的光滑误差模式并运用一个代数判据，我们可以精确定位这种粗网格校正失败的原因，从而突显指导有效代数多重网格（AMG）插值策略设计的核心原则。",
            "id": "3532911",
            "problem": "考虑为具有对称正定(SPD)矩阵的线性系统设计代数多重网格(AMG)预条件子的任务。设系统矩阵为在四个网格点上具有狄利克雷边界条件的标准一维离散拉普拉斯算子，\n$$\nA \\;=\\;\n\\begin{pmatrix}\n2  -1  0  0 \\\\\n-1  2  -1  0 \\\\\n0  -1  2  -1 \\\\\n0  0  -1  2\n\\end{pmatrix},\n$$\n并假设选择了一种粗/细(C/F)分裂，其中粗网格变量位于索引 $\\{1,4\\}$ 处，细网格变量位于索引 $\\{2,3\\}$ 处。通过在粗网格点上直接注入并且不对细网格点进行插值来定义延拓算子 $P$，使得 $P$ 的列是索引 1 和 4 处的坐标向量，即\n$$\nP \\;=\\;\n\\begin{pmatrix}\n1  0 \\\\\n0  0 \\\\\n0  0 \\\\\n0  1\n\\end{pmatrix}.\n$$\n仅从代数多重网格(AMG)作为预条件子的核心定义、粗空间 $\\operatorname{Range}(P)$ 的作用以及伽辽金构造 $A_{\\mathrm{c}} = P^{\\top} A P$ 出发，通过找出一个粗空间无法逼近的非零代数光滑误差，来解释为什么这种C/F分裂和插值的选择违反了逼近性质。然后，通过计算 $\\operatorname{Null}(P^{\\top} A)$ 的维数，使用涉及 $P^{\\top} A$ 零空间的代数判据来诊断此问题。\n\n你的最终答案必须是 $\\operatorname{Null}(P^{\\top} A)$ 的维数，表示为单个整数。无需四舍五入。",
            "solution": "该问题陈述是数值线性代数中的一个有效练习，具体涉及代数多重网格(AMG)方法的原理。所有给定的定义和矩阵都是标准的，构成了一个自洽且适定的问题。我们可以开始求解。\n\n两重网格方法（并可推广至多重网格）的核心思想是使用松弛法（如雅可比法或高斯-赛德尔法）来衰减误差的高频（振荡）分量，并使用粗网格校正步骤来消除松弛法难以处理的误差的低频（代数光滑）分量。\n\n为使粗网格校正有效，必须满足两个主要条件：\n1. **逼近性质**：由延拓算子 $P$ 的值域（记为 $\\operatorname{Range}(P)$）所表示的粗网格向量空间，必须能够精确逼近代数光滑误差分量。\n2. 粗网格算子 $A_{\\mathrm{c}} = P^{\\top} A P$ 必须是细网格算子 $A$ 在粗空间上的一个良好、稳定的表示。\n\n问题要求我们证明第一个性质被违反，并从代数上诊断此问题。\n\n### 第1部分：违反逼近性质\n\n如果一个误差向量 $e$ 是矩阵 $A$ 对应于小特征值的特征向量的线性组合，那么它就被认为是代数光滑的。通常，如果一个向量 $e$ 的瑞利商 $R(e) = \\frac{e^{\\top}Ae}{e^{\\top}e}$ 很小，那么它就是光滑的。对于离散拉普拉斯矩阵 $A$，光滑向量是指那些在相邻网格点之间振荡不大的向量。一个光滑向量的典型例子是其分量近乎为常数的向量。让我们考虑向量 $e_{\\mathrm{smooth}} = \\begin{pmatrix} 1  1  1  1 \\end{pmatrix}^{\\top}$。这个向量代表一个常数模式，是网格上可能的最光滑函数。相对于 $A$，该向量确实是代数光滑的，因为它的瑞利商是 $R(e_{\\mathrm{smooth}}) = \\frac{\\begin{pmatrix} 1  1  1  1 \\end{pmatrix} A \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\\\ 1 \\end{pmatrix}}{\\begin{pmatrix} 1  1  1  1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\\\ 1 \\end{pmatrix}} = \\frac{\\begin{pmatrix} 1  1  1  1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\\\ 1 \\end{pmatrix}}{4} = \\frac{2}{4} = \\frac{1}{2}$。$A$ 的最小特征值是 $\\lambda_1 = 2 - 2\\cos(\\frac{\\pi}{5}) \\approx 0.382$，因此瑞利商为 $0.5$ 表明这是一个非常光滑的向量。\n\n逼近性质要求这个光滑向量 $e_{\\mathrm{smooth}}$ 能够被粗空间 $\\operatorname{Range}(P)$ 中的向量很好地逼近。给定的延拓算子是\n$$\nP \\;=\\;\n\\begin{pmatrix}\n1  0 \\\\\n0  0 \\\\\n0  0 \\\\\n0  1\n\\end{pmatrix}.\n$$\n$P$ 的列是标准基向量 $e_1$ 和 $e_4$。粗空间 $\\operatorname{Range}(P)$ 是所有形如 $v_c = \\alpha e_1 + \\beta e_4$ 的向量的集合，可以写成\n$$\nv_c = \\begin{pmatrix} \\alpha \\\\ 0 \\\\ 0 \\\\ \\beta \\end{pmatrix}\n$$\n其中 $\\alpha, \\beta \\in \\mathbb{R}$ 为某些标量。\n\n为了用 $\\operatorname{Range}(P)$ 中的向量来逼近 $e_{\\mathrm{smooth}} = \\begin{pmatrix} 1  1  1  1 \\end{pmatrix}^{\\top}$，我们会选择 $\\alpha=1$ 和 $\\beta=1$ 来匹配粗网格点（索引 $\\{1,4\\}$）处的值。因此，$e_{\\mathrm{smooth}}$ 在 $\\operatorname{Range}(P)$ 中的最佳逼近是\n$$\ne_{\\mathrm{approx}} = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\\\ 1 \\end{pmatrix}.\n$$\n这个逼近的误差是\n$$\ne_{\\mathrm{err}} = e_{\\mathrm{smooth}} - e_{\\mathrm{approx}} = \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\\\ 1 \\end{pmatrix} - \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 1 \\\\ 1 \\\\ 0 \\end{pmatrix}.\n$$\n此误差的大小为 $\\|e_{\\mathrm{err}}\\|_2 = \\sqrt{0^2 + 1^2 + 1^2 + 0^2} = \\sqrt{2}$，与原始光滑向量的大小 $\\|e_{\\mathrm{smooth}}\\|_2 = \\sqrt{4} = 2$ 相比是显著的。该逼近完全无法捕捉光滑误差在细网格点（索引 $\\{2,3\\}$）处的行为。这是所选 $P$ 的直接后果，它不执行插值操作，只是简单地注入粗网格点的值，并将细网格点的值设置为零。因此，这种对 $P$ 的选择违反了逼近性质。向量 $e_{\\mathrm{smooth}} = \\begin{pmatrix} 1  1  1  1 \\end{pmatrix}^{\\top}$ 是一个粗空间无法很好逼近的非零代数光滑误差。\n\n### 第2部分：通过 $\\operatorname{Null}(P^{\\top} A)$ 进行诊断\n\n一个失效的粗网格校正的更形式化的代数判据是算子 $P^{\\top} A$ 存在非平凡的零空间。如果存在一个非零向量 $e$ 使得 $P^{\\top} A e = 0$，这意味着一个光滑误差分量 $e$ 可以产生一个对粗网格完全“不可见”的残差 $r=Ae$。残差的限制 $P^{\\top}r$ 将为零。因此，粗网格问题 $A_{\\mathrm{c}} e_{\\mathrm{c}} = P^{\\top} r$ 的右端项将为零，导致零校正 $e_{\\mathrm{c}}=0$。误差 $e$ 将在粗网格校正步骤中得不到校正。这个零空间的维数，量化了粗网格校正无法处理的独立“坏”模式的数量。\n\n我们计算矩阵乘积 $P^{\\top} A$：\n$$\nP^{\\top} = \\begin{pmatrix} 1  0  0  0 \\\\ 0  0  0  1 \\end{pmatrix}.\n$$\n$$\nP^{\\top} A = \\begin{pmatrix} 1  0  0  0 \\\\ 0  0  0  1 \\end{pmatrix}\n\\begin{pmatrix}\n2  -1  0  0 \\\\\n-1  2  -1  0 \\\\\n0  -1  2  -1 \\\\\n0  0  -1  2\n\\end{pmatrix}\n= \\begin{pmatrix}\n2  -1  0  0 \\\\\n0  0  -1  2\n\\end{pmatrix}.\n$$\n现在，我们必须求这个 $2 \\times 4$ 矩阵的零空间。我们寻找所有向量 $x = \\begin{pmatrix} x_1  x_2  x_3  x_4 \\end{pmatrix}^{\\top}$ 使得 $(P^{\\top} A) x = 0$：\n$$\n\\begin{pmatrix}\n2  -1  0  0 \\\\\n0  0  -1  2\n\\end{pmatrix}\n\\begin{pmatrix} x_1 \\\\ x_2 \\\\ x_3 \\\\ x_4 \\end{pmatrix}\n= \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}.\n$$\n这个矩阵方程对应于以下包含四个未知数的两个线性方程组：\n\\begin{align*}\n2x_1 - x_2 = 0 \\\\\n-x_3 + 2x_4 = 0\n\\end{align*}\n从第一个方程，我们得到 $x_2 = 2x_1$。从第二个方程，我们得到 $x_3 = 2x_4$。变量 $x_1$ 和 $x_4$ 是自由变量。我们设 $x_1 = s$ 和 $x_4 = t$，其中 $s, t \\in \\mathbb{R}$ 是任意参数。通解为：\n$$\nx = \\begin{pmatrix} x_1 \\\\ x_2 \\\\ x_3 \\\\ x_4 \\end{pmatrix} = \\begin{pmatrix} s \\\\ 2s \\\\ 2t \\\\ t \\end{pmatrix} = s \\begin{pmatrix} 1 \\\\ 2 \\\\ 0 \\\\ 0 \\end{pmatrix} + t \\begin{pmatrix} 0 \\\\ 0 \\\\ 2 \\\\ 1 \\end{pmatrix}.\n$$\n零空间 $\\operatorname{Null}(P^{\\top} A)$ 由两个线性无关的向量张成\n$$\nv_1 = \\begin{pmatrix} 1 \\\\ 2 \\\\ 0 \\\\ 0 \\end{pmatrix} \\quad \\text{和} \\quad v_2 = \\begin{pmatrix} 0 \\\\ 0 \\\\ 2 \\\\ 1 \\end{pmatrix}.\n$$\n由于零空间由两个线性无关的向量张成，其维数为 $2$。这证实了所选AMG设置的失败。存在一个二维的误差向量子空间，该子空间被此 $P$ 定义的粗网格校正过程完全忽略。\n\n最终答案是该零空间的维数。",
            "answer": "$$\n\\boxed{2}\n$$"
        },
        {
            "introduction": "这项高级练习综合了用于分析多重网格性能的关键理论工具。我们将使用局部傅里叶分析（Local Fourier Analysis, LFA）方法，为一个一维弹性模型问题剖析一个完整的双网格循环。通过确定最优的光滑子松弛参数、量化插值的质量，并将这些见解结合起来预测该方法的整体收敛因子，本练习将揭示光滑过程和粗网格校正之间精妙的相互作用。",
            "id": "3543424",
            "problem": "考虑在区间 $[0,1]$ 上的小应变一维线性弹性问题，其具有齐次 Dirichlet 边界条件、恒定的杨氏模量 $E>0$ 和恒定的横截面积 $A>0$。令 $u(x)$ 表示轴向位移，弱形式通过在尺寸为 $h$ 的均匀网格上使用线性有限元进行离散化。得到的细网格上的刚度矩阵是一个对称正定的三对角矩阵 $A_h \\in \\mathbb{R}^{n \\times n}$，其模板与 $\\{-1,2,-1\\}$ 成比例，即 $A_h = \\frac{EA}{h}\\,\\mathrm{tridiag}(-1,2,-1)$。该设定是代数多重网格 (AMG) 预处理中使用的固体力学算子的一个经典标量模型。\n\n假设一个两层 AMG 方法，对于此常系数、标量、M-矩阵问题，该方法可退化为经典的几何要素：一个间距为 $2h$ 的粗网格，模板为 $\\{\\tfrac{1}{4},\\tfrac{1}{2},\\tfrac{1}{4}\\}$ 的全加权限制，线性插值（分段线性延拓），以及一个 Galerkin 粗算子 $A_{2h} = R A_h P$。光滑子为权重 $\\omega \\in (0,1)$ 的阻尼 Jacobi，并使用一步前光滑和一步后光滑。\n\n请仅从位移不变算子的核心定义和傅里叶符号出发，按以下步骤进行：\n\n1) 定义 $A_h$ 的傅里叶符号以及阻尼 Jacobi 光滑子 $S_h = I - \\omega D^{-1} A_h$ 的傅里叶符号，其中 $D = \\mathrm{diag}(A_h)$。将光滑因子 $\\mu(\\omega)$ 定义为 Jacobi 误差放大符号的幅值在“高频”集合 $\\theta \\in [\\pi/2,\\pi]$ 上的上确界，并确定使 $\\mu(\\omega)$ 最小化的最优阻尼 $\\omega^{\\star}$。报告最小光滑因子 $\\mu_{\\min}$。\n\n2) 定义线性插值 $P$ 关于对角范数 $D$ 的弱逼近性质常数 $C_A$，即满足下式的最小常数 $C_A$：\n$$\n\\min_{v_{2h}} \\| v_h - P v_{2h} \\|_{D}^{2} \\le C_A \\, v_h^{\\top} A_h v_h\n$$\n对于所有细网格向量 $v_h$ 均成立。在均匀网格上使用傅里叶分析，精确计算 $C_A$。\n\n3) 使用局部傅里叶分析，对两网格法，在 $\\omega=\\omega^{\\star}$ 处采用一步前 Jacobi 和一步后 Jacobi 光滑，线性插值，全加权限制，以及 Galerkin 粗算子，构建在由 $\\theta \\in (0,\\pi/2]$ 及其 $2h$-混叠 $\\pi-\\theta$ 张成的双频子空间上的 $2\\times 2$ 误差放大矩阵。确定在 $\\theta\\in (0,\\pi/2]$ 上的最坏情况谱半径，以预测两网格收敛因子 $\\rho_{\\mathrm{TG}}$。\n\n将你的最终答案表示为 $\\rho_{\\mathrm{TG}}$ 的精确值（无量纲）。不要四舍五入。",
            "solution": "该问题是适定的且有科学依据的，代表了多重网格方法局部傅里叶分析 (LFA) 的一个经典案例研究。我们按问题的三个部分进行处理。\n\n在整个分析过程中，对于频率 $\\theta \\in (0, \\pi/2]$，我们使用以下记号：$s = \\sin(\\theta/2)$ 和 $c = \\cos(\\theta/2)$。注意 $s^2+c^2=1$。\n\n**第 1 部分：光滑分析**\n\n刚度矩阵 $A_h$ 由模板 $\\frac{EA}{h}\\{-1, 2, -1\\}$ 给出。为求其傅里叶符号 $\\tilde{A}_h(\\theta)$，我们将该算子应用于傅里叶模态 $v_j = \\exp(ij\\theta)$，其中 $j$ 是网格点索引。\n$$\n(A_h v)_j = \\frac{EA}{h}(-v_{j-1} + 2v_j - v_{j+1}) = \\frac{EA}{h}(-\\exp(i(j-1)\\theta) + 2\\exp(ij\\theta) - \\exp(i(j+1)\\theta))\n$$\n提出因子 $\\exp(ij\\theta)$，我们得到其符号：\n$$\n\\tilde{A}_h(\\theta) = \\frac{EA}{h}(-\\exp(-i\\theta) + 2 - \\exp(i\\theta)) = \\frac{EA}{h}(2 - 2\\cos(\\theta))\n$$\n使用半角恒等式 $1-\\cos(\\theta) = 2\\sin^2(\\theta/2)$，我们有：\n$$\n\\tilde{A}_h(\\theta) = \\frac{4EA}{h}\\sin^2\\left(\\frac{\\theta}{2}\\right)\n$$\n光滑子是阻尼 Jacobi 方法，其迭代算子为 $S_h = I - \\omega D^{-1} A_h$。矩阵 $D = \\mathrm{diag}(A_h)$ 对于内部网格点，其对角线元素为常数，值为 $D_{jj} = \\frac{2EA}{h}$。在 LFA 中，假设网格是无限的， $D$ 被视为 $\\frac{2EA}{h}I$。其符号是常数 $\\tilde{D} = \\frac{2EA}{h}$。\n\n光滑子的符号，即光滑过程的误差放大因子，为：\n$$\n\\tilde{S}_h(\\theta) = 1 - \\omega \\tilde{D}^{-1} \\tilde{A}_h(\\theta) = 1 - \\omega \\left(\\frac{h}{2EA}\\right) \\left(\\frac{4EA}{h}\\sin^2\\left(\\frac{\\theta}{2}\\right)\\right) = 1 - 2\\omega\\sin^2\\left(\\frac{\\theta}{2}\\right)\n$$\n光滑因子 $\\mu(\\omega)$ 是误差放大因子幅值在高频范围 $\\theta \\in [\\pi/2, \\pi]$ 上的上确界。\n$$\n\\mu(\\omega) = \\sup_{\\theta \\in [\\pi/2, \\pi]} \\left| 1 - 2\\omega\\sin^2\\left(\\frac{\\theta}{2}\\right) \\right|\n$$\n令 $x = \\sin^2(\\theta/2)$。对于 $\\theta \\in [\\pi/2, \\pi]$，我们有 $\\theta/2 \\in [\\pi/4, \\pi/2]$，因此 $x \\in [\\sin^2(\\pi/4), \\sin^2(\\pi/2)] = [1/2, 1]$。问题简化为求解：\n$$\n\\mu(\\omega) = \\max_{x \\in [1/2, 1]} |1 - 2\\omega x|\n$$\n函数 $f(x)=1-2\\omega x$ 是线性的。对于 $\\omega \\in (0,1)$，其斜率为负。因此， $|f(x)|$ 在区间 $[1/2, 1]$ 上的最大值必定出现在端点 $x=1/2$ 或 $x=1$ 处。\n$$\n\\mu(\\omega) = \\max\\left(\\left|1 - 2\\omega\\left(\\frac{1}{2}\\right)\\right|, |1 - 2\\omega(1)|\\right) = \\max(|1-\\omega|, |1-2\\omega|)\n$$\n最优阻尼 $\\omega^{\\star}$ 使该量最小化。这发生在 max 函数的两个参数幅值相等时：\n$$\n|1-\\omega^{\\star}| = |1-2\\omega^{\\star}|\n$$\n因为 $\\omega^{\\star} \\in (0,1)$，$1-\\omega^{\\star}$ 是正的。我们求解 $1-\\omega^{\\star} = \\pm(1-2\\omega^{\\star})$。\n取 $+$ 号的情况给出 $1-\\omega^{\\star} = 1-2\\omega^{\\star}$，这意味着 $\\omega^{\\star}=0$，这是一个无效解。\n取 $-$ 号的情况给出 $1-\\omega^{\\star} = -(1-2\\omega^{\\star}) = 2\\omega^{\\star}-1$，这导致 $3\\omega^{\\star}=2$，所以 $\\omega^{\\star}=2/3$。\n最优阻尼因子是 $\\omega^{\\star}=2/3$。\n最小光滑因子是 $\\mu_{\\min} = \\mu(2/3) = |1-2/3| = 1/3$。\n\n**第 2 部分：弱逼近性质**\n\n我们被要求找到最小的常数 $C_A$，使得对于所有细网格向量 $v_h$：\n$$\n\\min_{v_{2h}} \\| v_h - P v_{2h} \\|_{D}^{2} \\le C_A \\, v_h^{\\top} A_h v_h\n$$\n项 $\\min_{v_{2h}} \\| v_h - P v_{2h} \\|_{D}^{2}$ 表示 $v_h$ 在 $P$ 的值域中的最佳逼近误差的 $D$-范数的平方。由于 $D = \\frac{2EA}{h}I$ 是单位矩阵的标量倍， $D$-范数等价于欧几里得 $L_2$-范数，最佳逼近由正交投影给出。对于线性插值 $P$，细网格函数 $v_h$ 的最佳粗网格表示 $v_{2h}$ 通常通过直射选取，即 $v_{2h}(J) = v_h(2J)$，其中 $J$ 表示粗网格索引，$j$ 表示细网格索引。\n插值函数 $(Pv_{2h})$ 的值则为：\n$(Pv_{2h})(2J) = v_{2h}(J) = v_h(2J)$\n$(Pv_{2h})(2J+1) = \\frac{1}{2}(v_{2h}(J) + v_{2h}(J+1)) = \\frac{1}{2}(v_h(2J) + v_h(2J+2))$\n\n逼近误差在偶数索引点 $j=2J$ 处为零。在奇数索引点 $j=2J+1$ 处，误差为：\n$$\ne_{2J+1} = v_h(2J+1) - \\frac{1}{2}(v_h(2J) + v_h(2J+2)) = -\\frac{1}{2}\\left(v_h(2J) - 2v_h(2J+1) + v_h(2J+2)\\right)\n$$\n这与 $v_h$ 的离散二阶导数成比例。我们在傅里叶空间中分析这个不等式。令 $v_h$ 为一个傅里叶模态 $v_j=\\exp(ij\\theta)$。\n右侧的能量范数变为 $v_h^{\\top} A_h v_h \\to \\tilde{A}_h(\\theta) = \\frac{4EA}{h}\\sin^2(\\theta/2)$。\n对于左侧，我们计算误差模态。在偶数点处的误差为 $0$。在奇数点 $j=2J+1$ 处，误差为：\n$$\ne_{2J+1} = \\exp(i(2J+1)\\theta) - \\frac{1}{2}(\\exp(i2J\\theta) + \\exp(i(2J+2)\\theta)) = \\exp(i(2J+1)\\theta) \\left(1 - \\frac{\\exp(-i\\theta)+\\exp(i\\theta)}{2}\\right)\n$$\n$$\ne_{2J+1} = \\exp(i(2J+1)\\theta)(1-\\cos\\theta) = 2\\sin^2(\\theta/2)\\exp(i(2J+1)\\theta)\n$$\n每个模态的误差的 $D$-范数平方通过在网格上取平均来计算。由于误差仅在一半的点（奇数点）上非零，我们有：\n$$\n\\|e_h\\|_D^2 \\to \\frac{1}{2} D_{jj} |e_{2J+1}|^2 = \\frac{1}{2} \\left(\\frac{2EA}{h}\\right) \\left|2\\sin^2(\\theta/2)\\right|^2 = \\frac{EA}{h} \\cdot 4\\sin^4(\\theta/2) = \\frac{4EA}{h}\\sin^4(\\theta/2)\n$$\n对于模态 $\\theta$，左侧与右侧的比率 $Q(\\theta)$ 为：\n$$\nQ(\\theta) = \\frac{\\frac{4EA}{h}\\sin^4(\\theta/2)}{\\frac{4EA}{h}\\sin^2(\\theta/2)} = \\sin^2(\\theta/2)\n$$\n常数 $C_A$ 是该量在所有可能模态，即 $\\theta \\in [0, \\pi]$ 上的上确界。\n$$\nC_A = \\sup_{\\theta \\in [0, \\pi]} \\sin^2(\\theta/2) = \\sin^2(\\pi/2) = 1\n$$\n\n**第 3 部分：两网格收敛因子**\n\n具有一步前光滑和一步后光滑的循环的两网格误差传播算子是 $M_{TG} = S_h (I - P A_{2h}^{-1} R A_h) S_h$，其中 $A_{2h} = R A_h P$。我们使用 LFA 来求其符号 $\\tilde{M}_{TG}(\\theta)$，对于每个 $\\theta \\in (0, \\pi/2]$，这是一个 $2\\times 2$ 矩阵。\n$$\n\\tilde{M}_{TG}(\\theta) = \\tilde{S}_h(\\theta) \\left(I - \\tilde{P}(\\theta) \\tilde{A}_{2h}(\\theta)^{-1} \\tilde{R}(\\theta) \\tilde{A}_h(\\theta)\\right) \\tilde{S}_h(\\theta)\n$$\n这些算子的符号为：\n- 光滑子 $\\tilde{S}_h(\\theta)$: 当 $\\omega^{\\star}=2/3$ 且 $x=s^2=\\sin^2(\\theta/2)$ 时，低频 ($\\theta$) 和高频 ($\\pi-\\theta$) 的放大因子分别为 $\\mu_s = 1-2\\omega^{\\star}s^2 = 1-4s^2/3$ 和 $\\mu_c = 1-2\\omega^{\\star}c^2 = 1-4c^2/3$。\n矩阵符号为 $\\tilde{S}_h(\\theta) = \\mathrm{diag}(\\mu_s, \\mu_c)$。\n- 算子 $\\tilde{A}_h(\\theta)$: 令 $C_0 = \\frac{4EA}{h}$。则 $\\tilde{A}_h(\\theta) = C_0 \\cdot \\mathrm{diag}(s^2, c^2)$。\n- 转移算子：对于一维线性插值 ($P$) 和全加权 ($R$ 的模板为 $\\{\\frac{1}{4}, \\frac{1}{2}, \\frac{1}{4}\\}$), LFA 符号为 $\\tilde{R}(\\theta)=(c^2, s^2)$ 和 $\\tilde{P}(\\theta)=2(c^2,s^2)^T$。\n- 粗算子 $\\tilde{A}_{2h}(\\theta) = \\tilde{R}(\\theta) \\tilde{A}_h(\\theta) \\tilde{P}(\\theta)$:\n$$\n\\tilde{A}_{2h}(\\theta) = (c^2, s^2) \\left( C_0 \\begin{pmatrix} s^2  0 \\\\ 0  c^2 \\end{pmatrix} \\right) \\left( 2 \\begin{pmatrix} c^2 \\\\ s^2 \\end{pmatrix} \\right) = 2C_0 (c^2s^2, s^2c^2) \\begin{pmatrix} c^2 \\\\ s^2 \\end{pmatrix} = 2C_0(c^4s^2 + s^4c^2) = 2C_0 s^2c^2(c^2+s^2) = 2C_0s^2c^2\n$$\n- 粗网格校正算子 $\\tilde{CGC}(\\theta) = I - \\tilde{P}(\\theta)\\tilde{A}_{2h}(\\theta)^{-1}\\tilde{R}(\\theta)\\tilde{A}_h(\\theta)$:\n$$\n\\tilde{P}(\\theta)\\tilde{A}_{2h}(\\theta)^{-1}\\tilde{R}(\\theta)\\tilde{A}_h(\\theta) = \\frac{1}{s^2c^2}\\begin{pmatrix}c^2 \\\\ s^2\\end{pmatrix}(c^2,s^2)\\begin{pmatrix}s^2  0 \\\\ 0  c^2 \\end{pmatrix} = \\begin{pmatrix}c^2  c^2 \\\\ s^2  s^2 \\end{pmatrix}\n$$\n$$\n\\tilde{CGC}(\\theta) = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} - \\begin{pmatrix} c^2  c^2 \\\\ s^2  s^2 \\end{pmatrix} = \\begin{pmatrix} s^2  -c^2 \\\\ -s^2  c^2 \\end{pmatrix}\n$$\n完整的两网格循环的符号为 $\\tilde{M}_{TG}(\\theta) = \\tilde{S}_h \\tilde{CGC} \\tilde{S}_h$:\n$$\n\\tilde{M}_{TG}(\\theta) = \\begin{pmatrix} \\mu_s  0 \\\\ 0  \\mu_c \\end{pmatrix} \\begin{pmatrix} s^2  -c^2 \\\\ -s^2  c^2 \\end{pmatrix} \\begin{pmatrix} \\mu_s  0 \\\\ 0  \\mu_c \\end{pmatrix} = \\begin{pmatrix} \\mu_s^2 s^2  -\\mu_s \\mu_c c^2 \\\\ -\\mu_s \\mu_c s^2  \\mu_c^2 c^2 \\end{pmatrix}\n$$\n为求谱半径 $\\rho(\\tilde{M}_{TG}(\\theta))$，我们求其特征值。\n$\\det(\\tilde{M}_{TG}(\\theta)) = (\\mu_s^2 s^2)(\\mu_c^2 c^2) - (-\\mu_s \\mu_c c^2)(-\\mu_s \\mu_c s^2) = \\mu_s^2 \\mu_c^2 s^2 c^2 - \\mu_s^2 \\mu_c^2 s^2 c^2 = 0$。\n由于行列式为零，一个特征值为 $0$。另一个是矩阵的迹。\n$\\lambda_1=0$, $\\lambda_2 = \\mathrm{tr}(\\tilde{M}_{TG}(\\theta)) = \\mu_s^2 s^2 + \\mu_c^2 c^2$。\n谱半径为 $\\rho(\\theta) = |\\mu_s^2 s^2 + \\mu_c^2 c^2|$。令 $x=s^2=\\sin^2(\\theta/2)$。\n$$\n\\rho(x) = \\left(1-\\frac{4}{3}x\\right)^2 x + \\left(1-\\frac{4}{3}(1-x)\\right)^2(1-x)\n$$\n$$\n\\rho(x) = \\left(\\frac{3-4x}{3}\\right)^2 x + \\left(\\frac{4x-1}{3}\\right)^2(1-x) = \\frac{1}{9} \\left[ (9-24x+16x^2)x + (16x^2-8x+1)(1-x) \\right]\n$$\n$$\n\\rho(x) = \\frac{1}{9} \\left[ (9x - 24x^2 + 16x^3) + (16x^2 - 8x + 1 - 16x^3 + 8x^2 - x) \\right]\n$$\n$$\n\\rho(x) = \\frac{1}{9} \\left[ (9x - 24x^2 + 16x^3) + (-9x + 24x^2 + 1 - 16x^3) \\right] = \\frac{1}{9}\n$$\n谱半径对于所有 $\\theta \\in (0, \\pi/2]$ 都是恒定的。因此，最坏情况的两网格收敛因子就是这个恒定值。\n$$\n\\rho_{\\mathrm{TG}} = \\sup_{\\theta \\in (0, \\pi/2]} \\rho(\\theta) = \\frac{1}{9}\n$$",
            "answer": "$$\\boxed{\\frac{1}{9}}$$"
        }
    ]
}