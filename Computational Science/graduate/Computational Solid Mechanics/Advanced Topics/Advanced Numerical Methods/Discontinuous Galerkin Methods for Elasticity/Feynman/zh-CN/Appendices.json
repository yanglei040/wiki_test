{
    "hands_on_practices": [
        {
            "introduction": "非连续伽辽金 (DG) 方法的核心在于数值通量，它定义了相邻单元之间的信息交换方式。本练习旨在巩固您对弹性力学中对称内部罚伽辽金 (SIPG) 格式的理解。通过推导并计算一个具体案例的通量贡献，您将亲身体验到一致性项、对称性项和罚项在实践中是如何协同工作的。",
            "id": "3558973",
            "problem": "考虑二维平面应变下的线弹性问题。设两个相邻单元 $K^{-}$ 和 $K^{+}$ 共享一个长度为 $|F| = 2$ 的平直内侧面 $F$，其单位法向量 $n$ 从 $K^{-}$ 指向 $K^{+}$。假设已经进行了无量纲化处理，因此所有量均为无量纲。每个单元上的本构关系是线性和各向同性的，其刚度张量 $\\mathbb{C}^{\\pm}$ 由 Lamé 参数 $\\lambda^{\\pm}$ 和 $\\mu^{\\pm}$ 定义，即 $\\sigma(u) = \\mathbb{C} : \\varepsilon(u) = \\lambda\\, \\operatorname{tr}(\\varepsilon(u))\\, I + 2 \\mu\\, \\varepsilon(u)$，其中 $\\varepsilon(u) = \\tfrac{1}{2}(\\nabla u + (\\nabla u)^{\\top})$ 是对称应变。单位向量 $n$ 和 $t$ 是标准正交的，其中 $n = (\\frac{1}{\\sqrt{2}}, \\frac{1}{\\sqrt{2}})$ 且 $t = (-\\frac{1}{\\sqrt{2}}, \\frac{1}{\\sqrt{2}})$。这些单元的 Lamé 参数为 $\\lambda^{-} = 2$，$\\mu^{-} = 1$ 和 $\\lambda^{+} = 3$，$\\mu^{+} = 2$。\n\n设试探位移场 $u_{h}$ 和检验位移场 $v_{h}$ 在每个单元上都是仿射的，其梯度和在 $F$ 上的迹指定如下。在 $K^{-}$ 和 $K^{+}$ 上，梯度为\n$\\nabla u_{h}^{-} = a_{u}^{-}\\, n \\otimes n$，$\\nabla u_{h}^{+} = a_{u}^{+}\\, n \\otimes n$，其中 $a_{u}^{-} = 0.5$，$a_{u}^{+} = -0.2$，\n以及\n$\\nabla v_{h}^{-} = a_{v}^{-}\\, n \\otimes n$，$\\nabla v_{h}^{+} = a_{v}^{+}\\, n \\otimes n$，其中 $a_{v}^{-} = 0.6$，$a_{v}^{+} = -0.1$。\n假设侧面 $F$ 穿过原点，因此仿射场在 $F$ 上的限制分别等于常向量 $b_{u}^{\\pm}$ 和 $b_{v}^{\\pm}$：\n$b_{u}^{-} = -0.15\\, n + 0.05\\, t$，$b_{u}^{+} = 0.15\\, n - 0.05\\, t$，以及 $b_{v}^{-} = 0.2\\, n - 0.1\\, t$，$b_{v}^{+} = -0.2\\, n + 0.1\\, t$。\n因此，在 $F$ 上的跳跃为 $[\\![u_{h}]\\!] = b_{u}^{+} - b_{u}^{-} = 0.3\\, n - 0.1\\, t$ 和 $[\\![v_{h}]\\!] = b_{v}^{+} - b_{v}^{-} = -0.4\\, n + 0.2\\, t$。\n\n使用不连续伽辽金 (DG) 方法，并采用罚参数为 $\\eta = 5$ 的对称内部罚数值通量，按以下步骤进行：\n1. 从线动量平衡和本构关系出发，推导内侧面 $F$ 对双线性残差 $R_{F}(u_{h}, v_{h})$ 的贡献，用平均牵引力 $\\{\\!\\{\\sigma(u_{h})\\}\\!\\} n$、跳跃 $[\\![\\cdot]\\!]$ 和罚参数 $\\eta$ 表示。在 $K^{-}$ 上使用外法向量 $n^{-} = n$，在 $K^{+}$ 上使用 $n^{+} = -n$，并使用标准平均算子 $\\{\\!\\{q\\}\\!\\} = \\tfrac{1}{2}(q^{-} + q^{+})$ 和跳跃算子 $[\\![w]\\!] = w^{+} - w^{-}$。\n2. 对给定数据，数值计算 $R_{F}(u_{h}, v_{h})$。\n\n将 $R_{F}(u_{h}, v_{h})$ 的最终值报告为单个实数。无需四舍五入。由于设定是无量纲的，最终答案无需单位。",
            "solution": "该问题是有效的，因为它在科学上基于计算固体力学理论，特别是针对线弹性问题的不连续伽辽金 (DG) 方法。所有提供的数据都是自洽、一致且足以进行所需计算的。\n\n根据要求，解答分为两部分。首先，我们推导对称内部罚伽辽金 (SIPG) 方法的内侧面贡献的一般形式。其次，我们使用所提供的数据对该贡献进行数值计算。\n\n### 第1部分：内侧面贡献 $R_{F}(u_{h}, v_{h})$ 的推导\n\nDG 方法从每个单元 $K$ 上的线动量平衡的弱形式 $-\\nabla \\cdot \\sigma(u) = 0$ (假设没有体力) 开始。对于一个检验函数 $v_h$，我们有：\n$$ \\int_K (-\\nabla \\cdot \\sigma(u_h)) \\cdot v_h \\, dK = 0 $$\n在每个单元 $K \\in \\{K^{-}, K^{+}\\}$ 上进行分部积分可得：\n$$ \\int_K \\sigma(u_h) : \\nabla v_h \\, dK - \\int_{\\partial K} (\\sigma(u_h) n_{\\partial K}) \\cdot v_h \\, dS = 0 $$\n其中 $n_{\\partial K}$ 是边界 $\\partial K$ 的外指向单位法向量。由于应力张量 $\\sigma(u_h)$ 是对称的，我们可以用对称应变张量 $\\varepsilon(v_h)$ 替换 $\\nabla v_h$：\n$$ \\int_K \\sigma(u_h) : \\varepsilon(v_h) \\, dK - \\int_{\\partial K} (\\sigma(u_h) n_{\\partial K}) \\cdot v_h \\, dS = 0 $$\n对两个相邻单元 $K^{-}$ 和 $K^{+}$ 求和，共享内侧面 $F$ 的贡献来自于边界积分项。$K^{-}$ 在 $F$ 上的外法向量是 $n^{-} = n$，而 $K^{+}$ 的外法向量是 $n^{+} = -n$。在 $F$ 上的边界积分之和为：\n$$ -\\int_F (\\sigma(u_h^{-}) n^{-}) \\cdot v_h^{-} \\, dS - \\int_F (\\sigma(u_h^{+}) n^{+}) \\cdot v_h^{+} \\, dS = -\\int_F \\left( (\\sigma(u_h^{-}) n) \\cdot v_h^{-} - (\\sigma(u_h^{+}) n) \\cdot v_h^{+} \\right) dS $$\n使用跳跃算子 $[\\![w]\\!] = w^{+} - w^{-}$ 和平均算子 $\\{\\!\\{q\\}\\!\\} = \\frac{1}{2}(q^{-} + q^{+})$，积分内的项可以重写为 $(\\sigma(u_h^{+}) n) \\cdot v_h^{+} - (\\sigma(u_h^{-}) n) \\cdot v_h^{-}$。一个标准的恒等式将其与跳跃和平均值联系起来：\n$$ a^{+} \\cdot b^{+} - a^{-} \\cdot b^{-} = \\{\\!\\{a\\}\\!\\} \\cdot [\\![b]\\!] + [\\![a]\\!] \\cdot \\{\\!\\{b\\}\\!\\} $$\n将此应用于 $a = \\sigma(u_h)n$ 和 $b = v_h$，积分变为：\n$$ \\int_F \\left( \\{\\!\\{\\sigma(u_h)n\\}\\!\\} \\cdot [\\![v_h]\\!] + [\\![\\sigma(u_h)n]\\!] \\cdot \\{\\!\\{v_h\\}\\!\\} \\right) dS $$\n在 DG 方法中，该项被数值通量项取代，以确保一致性、稳定性和对称性。对于对称内部罚伽辽金 (SIPG) 方法，双线性内侧面贡献 $R_F(u_h, v_h)$ 定义为：\n$$ R_F(u_h, v_h) = \\int_F \\left( -\\{\\!\\{\\sigma(u_h)n\\}\\!\\} \\cdot [\\![v_h]\\!] - \\{\\!\\{\\sigma(v_h)n\\}\\!\\} \\cdot [\\![u_h]\\!] + \\eta [\\![u_h]\\!] \\cdot [\\![v_h]\\!] \\right) dS $$\n此形式包含三个项：\n1.  一致性项，$-\\int_F \\{\\!\\{\\sigma(u_h)n\\}\\!\\} \\cdot [\\![v_h]\\!] \\, dS$，确保足够光滑的精确解满足离散方程。\n2.  对称性项，$-\\int_F \\{\\!\\{\\sigma(v_h)n\\}\\!\\} \\cdot [\\![u_h]\\!] \\, dS$，被添加以使双线性形式对称，即 $R_F(u_h, v_h) = R_F(v_h, u_h)$。\n3.  罚（或稳定）项，$\\int_F \\eta [\\![u_h]\\!] \\cdot [\\![v_h]\\!] \\, dS$，惩罚位移场在侧面上的跳跃，这为整个数值格式提供了稳定性和矫顽性。参数 $\\eta > 0$ 必须选择得足够大。\n\n### 第2部分：$R_{F}(u_{h}, v_{h})$ 的数值计算\n\n我们需要计算表达式 $R_F(u_h, v_h)$ 中的各项。由于所有场要么是常数，要么具有常数梯度，它们在侧面 $F$ 上的迹和产生的牵引力都是常数。因此，积分就是被积函数的值乘以侧面的长度 $|F|=2$。\n$$ R_F(u_h, v_h) = |F| \\left( -\\{\\!\\{\\sigma(u_h)n\\}\\!\\} \\cdot [\\![v_h]\\!] - \\{\\!\\{\\sigma(v_h)n\\}\\!\\} \\cdot [\\![u_h]\\!] + \\eta [\\![u_h]\\!] \\cdot [\\![v_h]\\!] \\right) $$\n我们首先计算一个具有梯度 $\\nabla w = a_w n \\otimes n$ 的通用场 $w$ 的牵引力向量 $\\sigma(w)n$。\n应变张量为 $\\varepsilon(w) = \\frac{1}{2}(\\nabla w + (\\nabla w)^{\\top}) = \\frac{1}{2}(a_w n \\otimes n + a_w n \\otimes n) = a_w n \\otimes n$。\n应变的迹为 $\\operatorname{tr}(\\varepsilon(w)) = \\operatorname{tr}(a_w n \\otimes n) = a_w \\operatorname{tr}(n \\otimes n) = a_w |n|^2 = a_w$。\n应力张量由 $\\sigma(w) = \\lambda \\operatorname{tr}(\\varepsilon(w)) I + 2\\mu \\varepsilon(w) = \\lambda a_w I + 2\\mu a_w n \\otimes n = a_w(\\lambda I + 2\\mu n \\otimes n)$ 给出。\n在法向量为 $n$ 的表面上的牵引力向量为：\n$$ \\sigma(w)n = a_w(\\lambda I + 2\\mu n \\otimes n)n = a_w(\\lambda In + 2\\mu (n \\otimes n)n) $$\n使用 $In=n$ 和 $(n\\otimes n)n = n(n \\cdot n) = n$，我们得到：\n$$ \\sigma(w)n = a_w(\\lambda n + 2\\mu n) = a_w(\\lambda + 2\\mu)n $$\n现在我们将此公式应用于单元 $K^{-}$ 和 $K^{+}$ 上的试探函数 $u_h$ 和检验函数 $v_h$。\n\n**$u_h$ 的牵引力向量：**\n在 $K^{-}$ 上：$\\lambda^{-} = 2$，$\\mu^{-} = 1$，$a_u^{-} = 0.5$。\n$$ \\sigma(u_h^{-})n = a_u^{-} (\\lambda^{-} + 2\\mu^{-}) n = 0.5(2 + 2 \\cdot 1)n = 0.5(4)n = 2n $$\n在 $K^{+}$ 上：$\\lambda^{+} = 3$，$\\mu^{+} = 2$，$a_u^{+} = -0.2$。\n$$ \\sigma(u_h^{+})n = a_u^{+} (\\lambda^{+} + 2\\mu^{+}) n = -0.2(3 + 2 \\cdot 2)n = -0.2(7)n = -1.4n $$\n\n**$v_h$ 的牵引力向量：**\n在 $K^{-}$ 上：$\\lambda^{-} = 2$，$\\mu^{-} = 1$，$a_v^{-} = 0.6$。\n$$ \\sigma(v_h^{-})n = a_v^{-} (\\lambda^{-} + 2\\mu^{-}) n = 0.6(2 + 2 \\cdot 1)n = 0.6(4)n = 2.4n $$\n在 $K^{+}$ 上：$\\lambda^{+} = 3$，$\\mu^{+} = 2$，$a_v^{+} = -0.1$。\n$$ \\sigma(v_h^{+})n = a_v^{+} (\\lambda^{+} + 2\\mu^{+}) n = -0.1(3 + 2 \\cdot 2)n = -0.1(7)n = -0.7n $$\n\n**平均牵引力：**\n$$ \\{\\!\\{\\sigma(u_h)n\\}\\!\\} = \\frac{1}{2}(\\sigma(u_h^{-})n + \\sigma(u_h^{+})n) = \\frac{1}{2}(2n - 1.4n) = \\frac{1}{2}(0.6n) = 0.3n $$\n$$ \\{\\!\\{\\sigma(v_h)n\\}\\!\\} = \\frac{1}{2}(\\sigma(v_h^{-})n + \\sigma(v_h^{+})n) = \\frac{1}{2}(2.4n - 0.7n) = \\frac{1}{2}(1.7n) = 0.85n $$\n\n**跳跃（给定）：**\n$$ [\\![u_h]\\!] = 0.3n - 0.1t $$\n$$ [\\![v_h]\\!] = -0.4n + 0.2t $$\n向量 $n$ 和 $t$ 是标准正交的，所以 $n \\cdot n = 1$，$t \\cdot t = 1$，且 $n \\cdot t = 0$。\n\n现在我们计算被积函数的三个项：\n1.  **一致性项贡献：**\n    $$ -\\{\\!\\{\\sigma(u_h)n\\}\\!\\} \\cdot [\\![v_h]\\!] = -(0.3n) \\cdot (-0.4n + 0.2t) = -0.3(-0.4)(n \\cdot n) - 0.3(0.2)(n \\cdot t) = 0.12 $$\n2.  **对称性项贡献：**\n    $$ -\\{\\!\\{\\sigma(v_h)n\\}\\!\\} \\cdot [\\![u_h]\\!] = -(0.85n) \\cdot (0.3n - 0.1t) = -0.85(0.3)(n \\cdot n) - 0.85(-0.1)(n \\cdot t) = -0.255 $$\n3.  **罚项贡献：** ($\\eta = 5$)\n    $$ \\eta [\\![u_h]\\!] \\cdot [\\![v_h]\\!] = 5 (0.3n - 0.1t) \\cdot (-0.4n + 0.2t) $$\n    $$ = 5( (0.3)(-0.4)(n \\cdot n) + (0.3)(0.2)(n \\cdot t) - (0.1)(-0.4)(t \\cdot n) - (0.1)(0.2)(t \\cdot t) ) $$\n    $$ = 5( -0.12 + 0 - 0 - 0.02 ) = 5(-0.14) = -0.7 $$\n\n这些贡献的总和是 $0.12 - 0.255 - 0.7 = -0.135 - 0.7 = -0.835$。\n最后，我们乘以侧面长度 $|F| = 2$：\n$$ R_F(u_h, v_h) = |F| \\times (-0.835) = 2 \\times (-0.835) = -1.67 $$",
            "answer": "$$\\boxed{-1.67}$$"
        },
        {
            "introduction": "在实现DG程序时，正确处理单元间共享面的方向是一个常见且关键的挑战。本实践问题聚焦于DG实现中的一个核心“簿记”环节：在局部节点排序相反的界面上对齐自由度。解决这个问题将使您掌握构建稳健DG求解器所需的基本几何推理能力。",
            "id": "3558954",
            "problem": "考虑一个二维域上的小应变线性弹性方程，其中 Cauchy 应力张量 $\\boldsymbol{\\sigma}$ 满足 $\\boldsymbol{\\sigma} = \\lambda \\, \\mathrm{tr}(\\boldsymbol{\\varepsilon}) \\, \\mathbf{I} + 2 \\mu \\, \\boldsymbol{\\varepsilon}$，$\\lambda$ 和 $\\mu$ 是 Lamé 参数，应变张量为 $\\boldsymbol{\\varepsilon} = \\tfrac{1}{2} \\left( \\nabla \\mathbf{u} + (\\nabla \\mathbf{u})^{\\top} \\right)$，$\\mathbf{u}$ 是位移场。在不连续伽辽金（Discontinuous Galerkin, DG）方法中，弱形式在内部面上使用界面项，这些界面项依赖于在面求积点上一致计算的牵引力和位移跳跃。\n\n两个双线性四边形单元 $E_{L}$ 和 $E_{R}$ 沿其公共边界共享一个垂直的内部面 $\\Gamma$。每个单元都从其自身的参考正方形映射而来，其局部坐标为 $(\\xi,\\eta) \\in [-1,1]^{2}$。左单元 $E_{L}$ 的内部面位于 $\\xi = 1$ 处，其向外单位法向量为 $\\mathbf{n}_{L} = (1,0)$。右单元 $E_{R}$ 的内部面位于 $\\xi = -1$ 处，其向外单位法向量为 $\\mathbf{n}_{R} = (-1,0) = -\\mathbf{n}_{L}$。$\\Gamma$ 上的界面数值通量通过选择规范面法线 $\\mathbf{n} := \\mathbf{n}_{L}$ 并将来自 $E_{R}$ 的数据用与 $E_{L}$ 一致的局部参数化表示来实现。\n\n在每个面上，迹空间由与沿面方向的多项式次数 $p \\geq 1$ 相关的 Lagrange 基生成。面的自由度与面参数在 $[-1,1]$ 上的 $p+1$ 个 Legendre–Gauss–Lobatto (LGL) 点相关联。对于 $E_{L}$，面参数是在 $\\xi=1$ 上的 $\\eta$，面的自由度按 $\\eta$ 的递增顺序排列，即索引 $m = 0,1,\\dots,p$ 对应于严格递增的 LGL 节点 $\\eta_{m}$，其中 $\\eta_{0} = -1$，$\\eta_{p} = 1$。对于 $E_{R}$，局部面参数在 $\\xi=-1$ 上表示为 $\\eta'$，并且由于其局部节点排序约定，面的自由度按 $\\eta'$ 的递增顺序排列，但从由 $\\mathbf{n} = \\mathbf{n}_{L}$ 导出的全局参数化来看，沿 $\\Gamma$ 的几何方向与 $E_{L}$ 的方向相反。具体来说，用于通量计算的一致参数化沿 $\\Gamma$ 满足方向反转关系 $\\eta' = -\\eta$。\n\n假设求积在 LGL 节点上精确执行，并且 Lagrange 迹基函数是与每个面上的这些节点相关联的规范插值函数。为了正确计算数值通量，必须对来自 $E_{R}$ 的自由度进行置换，使其排序在方向一致的面参数下与 $E_{L}$ 的排序相匹配。仅使用 DG 公式和沿面的参考到物理映射的第一性原理，推导右单元面自由度索引 $m \\in \\{0,1,\\dots,p\\}$ 的封闭形式置换 $\\pi(m)$，该置换将 $E_{R}$ 的迹数据与 $E_{L}$ 的方向对齐，以便在 $\\Gamma$ 上进行通量计算。\n\n以关于 $m$ 和 $p$ 的单个解析表达式 $\\pi(m)$ 的形式提供您的最终结果。不需要数值近似，也不涉及单位。",
            "solution": "问题要求推导一个置换 $\\pi(m)$，该置换重新对齐单元 $E_R$ 面上的自由度 (DoFs)，以匹配单元 $E_L$ 上共享面的几何方向。这是在不连续伽辽金 (DG) 方法中正确计算数值通量的必要步骤。\n\n让我们首先将所提供的信息形式化。我们有两个单元，$E_L$ (左) 和 $E_R$ (右)，共享一个面 $\\Gamma$。\n$\\Gamma$ 上的数值通量计算是在与 $E_L$ 方向一致的坐标系中进行的，该坐标系由规范法线 $\\mathbf{n} = \\mathbf{n}_L$ 定义。\n\n两个单元的面自由度都位于参考区间 $[-1, 1]$ 上的 $p+1$ 个 Legendre-Gauss-Lobatto (LGL) 节点上。让我们将这组有序的 LGL 节点表示为 $\\{\\zeta_j\\}_{j=0}^{p}$，其中 $-1 = \\zeta_0  \\zeta_1  \\dots  \\zeta_p = 1$。这些节点的一个基本性质是它们关于原点的对称性，表示为：\n$$\n\\zeta_j = -\\zeta_{p-j} \\quad \\text{for } j \\in \\{0, 1, \\dots, p\\}\n$$\n\n对于单元 $E_L$，面参数为 $\\eta \\in [-1, 1]$。自由度由 $m \\in \\{0, 1, \\dots, p\\}$ 索引，其位置 $\\eta_m$ 按 $m$ 严格递增排序。这直接对应于 LGL 节点的标准排序。因此，$E_L$ 面上第 $m$ 个自由度的坐标是：\n$$\n\\eta_m = \\zeta_m\n$$\n\n对于单元 $E_R$，局部面参数为 $\\eta' \\in [-1, 1]$。问题陈述其局部自由度排序约定也基于面参数的递增值。设 $E_R$ 的自由度索引为 $k \\in \\{0, 1, \\dots, p\\}$。$E_R$ 面上第 $k$ 个自由度的坐标是：\n$$\n\\eta'_k = \\zeta_k\n$$\n\n关键信息是共享面 $\\Gamma$ 上任意给定物理点处两种参数化之间的关系。由于各自局部参考单元中面的方向相反，该关系给出为：\n$$\n\\eta' = -\\eta\n$$\n\n我们的目标是找到一个置换 $\\pi(m)$，使得来自 $E_R$ 的自由度置换向量（我们称之为 $\\mathbf{d}'_R$）与 $E_L$ 的自由度位置对齐。这意味着 $\\mathbf{d}'_R$ 的第 $m$ 个分量，记作 $(\\mathbf{d}'_R)_m$，必须对应于与 $E_L$ 的第 $m$ 个自由度处于相同物理点的 $E_R$ 的值。\n\n让我们考虑 $E_L$ 的第 $m$ 个自由度。其位置在 $\\eta = \\eta_m = \\zeta_m$。为了找到来自 $E_R$ 的相应值，我们必须找到 $E_R$ 面上对应于同一点物理位置的坐标。使用方向反转关系，此坐标为：\n$$\n\\eta' = -\\eta = -\\zeta_m\n$$\n\n现在，我们必须确定 $E_R$ 的哪个原始自由度位于此坐标 $\\eta'$。设这是索引为 $k$ 的自由度。其位置由 $\\eta'_k = \\zeta_k$ 给出。因此我们要求：\n$$\n\\zeta_k = \\eta' = -\\zeta_m\n$$\n\n使用 LGL 节点的对称性质，$\\zeta_{p-m} = -\\zeta_m$。将此代入前一个方程，我们得到：\n$$\n\\zeta_k = \\zeta_{p-m}\n$$\n\n由于 LGL 节点 $\\zeta_j$ 对于 $j \\in \\{0, 1, \\dots, p\\}$ 是互不相同的，节点坐标的相等意味着其索引的相等：\n$$\nk = p-m\n$$\n\n这个结果告诉我们，对齐后的第 $m$ 个自由度位置的迹数据值必须从单元 $E_R$ 的原始（未置换）数据的第 $k = (p-m)$ 个自由度中获取。置换 $\\pi(m)$ 定义为将置换后数组中的目标索引 $m$ 映射到原始数组中源索引 $\\pi(m)$ 的函数。\n因此，所需的置换是：\n$$\n\\pi(m) = p-m\n$$\n其中 $m \\in \\{0, 1, \\dots, p\\}$。此置换有效地反转了来自单元 $E_R$ 的自由度顺序，以使其与单元 $E_L$ 的方向对齐。例如，对于对齐集中的第一个自由度 ($m=0$)，我们取原始集中的最后一个自由度 ($k=p$)。对于最后一个对齐的自由度 ($m=p$)，我们取第一个原始自由度 ($k=0$)。如果 $p$ 是偶数，则中心自由度 ($m=p/2$) 映射到其自身。",
            "answer": "$$\\boxed{\\pi(m) = p-m}$$"
        },
        {
            "introduction": "DG方法的一大优势在于其天然适用于后验误差估计，从而指导自适应网格加密。本练习将指导您实现一个基于残差的误差估计器 $\\eta^2$，这是实用工程模拟中的一个强大工具。您将学习如何利用DG解在单元界面上固有的跳跃作为局部误差的指标，为实现高效、准确的自适应分析铺平道路。",
            "id": "3558961",
            "problem": "考虑一个多边形域上的二维小应变线性弹性问题，其静态平衡的强形式由线动量平衡和牵引力连续性给出。基本依据是：\n- 每个子域内的平衡：$\\nabla \\cdot \\sigma + f = 0$。\n- 内部面上的牵引力连续性：牵引力 $t = \\sigma n$ 是连续的，其中 $n$ 是单位法向量。\n- 应力对称性：$\\sigma = \\sigma^{\\top}$。\n\n在不连续伽辽金（Discontinuous Galerkin, DG）方法中，离散应力场 $\\sigma_h$ 和离散位移场在单元界面上是不连续的。一个基于跳跃的、由平衡残差和牵引力跳跃引导的后验误差估计量，其经典形式由以下部分组成：\n$$\n\\eta^2 \\;=\\; \\sum_{F \\in \\mathcal{F}_{\\mathrm{int}}} h_F \\,\\lVert [\\![ \\sigma_h n ]\\!] \\rVert_{F}^2 \\;+\\; \\sum_{K \\in \\mathcal{T}_h} h_K^2 \\,\\lVert f + \\nabla \\cdot \\sigma_h \\rVert_{K}^2,\n$$\n其中 $[\\![ \\sigma_h n]\\!]$ 表示牵引力在内部面 $F$ 上的跳跃，$h_F$ 是面的长度尺度，$h_K$ 是单元的长度尺度。范数 $\\lVert \\cdot \\rVert_F$ 是面上的 $L^2$ 范数，而 $\\lVert \\cdot \\rVert_K$ 是单元上的 $L^2$ 范数。目标是开发并实现该估计量，仅使用平衡方程和牵引力连续性作为基本依据，而不使用超出这些原则的任何快捷公式。\n\n为使计算具体且普遍适用，作出以下实现假设：\n- 几何形状：每个单元 $K$ 都是与坐标轴对齐的矩形，由一个边界框 $[x_0,x_1]\\times[y_0,y_1]$ 定义。\n- 每个单元 $K$ 上的应力近似：一个对称的线性多项式场\n  $\n  \\sigma_{xx}(x,y) = a_0 + a_1 x + a_2 y,\\quad\n  \\sigma_{yy}(x,y) = b_0 + b_1 x + b_2 y,\\quad\n  \\sigma_{xy}(x,y) = c_0 + c_1 x + c_2 y,\n  $\n  且 $\\sigma_{xy}=\\sigma_{yx}$。\n- 每个单元 $K$ 上的体力：一个常数向量 $f = (f_x,f_y)$。\n- 非均质材料：为每个单元 $K$ 分配可能在单元间变化的 Lamé 参数 $(\\lambda,\\mu)$。这些参数是描述的一部分，以反映非均质性，但上述估计量公式仅显式地使用了 $\\sigma_h$ 和 $f$。将所有量视为无量纲。\n- 范数的数值积分：在面上使用中点求积，在单元上使用形心来定义 $L^2$ 范数的可计算代理：\n  - 对于一个端点为 $(x_0,y_0)$ 和 $(x_1,y_1)$ 的面 $F$，设其长度为 $|F| = \\sqrt{(x_1-x_0)^2 + (y_1-y_0)^2}$，中点为 $m_F$，从 $K^+$ 侧向外的单位法向量为 $n_F$。定义\n    $\n    \\lVert [\\![ \\sigma_h n]\\!] \\rVert_F^2 \\approx |F| \\,\\big\\lVert (\\sigma_h^+(m_F) n_F) + (\\sigma_h^-(m_F)(-n_F)) \\big\\rVert_2^2,\n    $\n    其中 $-$ 表示 $K^-$ 侧，跳跃为 $t^+ + t^-$，每个侧都带有向外的法向量。\n  - 对于一个面积为 $|K|$、形心为 $m_K$ 的单元 $K$，由于对于所采用的线性应力，$\\nabla\\cdot\\sigma_h$ 是常数，定义\n    $\n    \\lVert f + \\nabla \\cdot \\sigma_h \\rVert_K^2 \\approx |K| \\,\\big\\lVert f + \\nabla \\cdot \\sigma_h \\big\\rVert_2^2.\n    $\n- 网格尺度：对面设置 $h_F = |F|$，对单元设置 $h_K = \\sqrt{|K|}$。\n- 牵引力计算：对于任意单位法向量 $n=(n_x,n_y)$，\n  $\n  \\sigma n = \n  \\begin{bmatrix}\n  \\sigma_{xx}  \\sigma_{xy}\\\\\n  \\sigma_{xy}  \\sigma_{yy}\n  \\end{bmatrix}\n  \\begin{bmatrix} n_x\\\\ n_y \\end{bmatrix}\n  =\n  \\begin{bmatrix}\n  \\sigma_{xx} n_x + \\sigma_{xy} n_y \\\\\n  \\sigma_{xy} n_x + \\sigma_{yy} n_y\n  \\end{bmatrix}.\n  $\n- 每个单元 $K$ 上线性应力的散度是常数，由下式给出\n  $\n  \\nabla\\cdot\\sigma_h = \n  \\begin{bmatrix}\n  \\partial_x \\sigma_{xx} + \\partial_y \\sigma_{xy} \\\\\n  \\partial_x \\sigma_{xy} + \\partial_y \\sigma_{yy}\n  \\end{bmatrix}\n  =\n  \\begin{bmatrix}\n  a_1 + c_2\\\\\n  c_1 + b_2\n  \\end{bmatrix}.\n  $\n\n测试用例。实现一个程序，为以下三个测试用例计算 $\\eta^2$。在所有情况下，输出应为单行，包含按顺序排列的三个结果，四舍五入到六位小数，并以逗号分隔的列表形式放在方括号中。\n\n- 测试用例 1（两个水平相邻的矩形）：\n  - 单元：\n    - $K_0 = [0,0.5]\\times[0,1]$，Lamé 参数 $(\\lambda,\\mu)=(2,1)$，应力系数\n      $\n      \\sigma_{xx} = 2 + 1\\cdot x + 0\\cdot y,\\;\n      \\sigma_{yy} = 1 + 0\\cdot x + (-1)\\cdot y,\\;\n      \\sigma_{xy} = 0 + 0.5\\cdot x + 0.2\\cdot y.\n      $\n      体力 $f=(-0.2,\\,0.5)$。\n    - $K_1 = [0.5,1]\\times[0,1]$，Lamé 参数 $(\\lambda,\\mu)=(10,5)$，应力系数\n      $\n      \\sigma_{xx} = 1 + (-1)\\cdot x + 0\\cdot y,\\;\n      \\sigma_{yy} = 2 + 0\\cdot x + 1\\cdot y,\\;\n      \\sigma_{xy} = 0 + (-0.3)\\cdot x + 0.4\\cdot y.\n      $\n      体力 $f=(0.1,\\,-0.2)$。\n  - 内部面 $F$ 是在 $x=0.5$ 处从 $y=0$ 到 $y=1$ 的垂直线段，其中 $K^+=K_0$，$K^-=K_1$，且 $n_F=(1,0)$ 从 $K^+$ 向外。\n\n- 测试用例 2（一个处于精确平衡状态的矩形）：\n  - 单元：\n    - $K_0 = [0,1]\\times[0,1]$，Lamé 参数 $(\\lambda,\\mu)=(3,2)$，应力系数\n      $\n      \\sigma_{xx} = 0 + 1\\cdot x + 0\\cdot y,\\;\n      \\sigma_{yy} = 0 + 0\\cdot x + 1\\cdot y,\\;\n      \\sigma_{xy} = 0 + 0\\cdot x + 0\\cdot y,\n      $\n      体力 $f=(-1,\\,-1)$。\n  - 无内部面。\n\n- 测试用例 3（两个垂直堆叠的矩形）：\n  - 单元：\n    - $K_0 = [0,1]\\times[0,0.4]$，Lamé 参数 $(\\lambda,\\mu)=(1,0.5)$，应力系数\n      $\n      \\sigma_{xx} = 1 + 0\\cdot x + 0.1\\cdot y,\\;\n      \\sigma_{yy} = 2 + (-0.2)\\cdot x + 0\\cdot y,\\;\n      \\sigma_{xy} = 0 + 0.3\\cdot x + (-0.1)\\cdot y,\n      $\n      体力 $f=(0,\\,0)$。\n    - $K_1 = [0,1]\\times[0.4,1]$，Lamé 参数 $(\\lambda,\\mu)=(50,20)$，应力系数\n      $\n      \\sigma_{xx} = 1 + 0\\cdot x + (-0.2)\\cdot y,\\;\n      \\sigma_{yy} = 1 + 0.3\\cdot x + 0\\cdot y,\\;\n      \\sigma_{xy} = 0 + (-0.2)\\cdot x + 0.4\\cdot y,\n      $\n      体力 $f=(0,\\,0.1)$。\n  - 内部面 $F$ 是在 $y=0.4$ 处从 $x=0$ 到 $x=1$ 的水平线段，其中 $K^+=K_0$，$K^-=K_1$，且 $n_F=(0,1)$ 从 $K^+$ 向外。\n\n计算要求：\n- 完全按照上述规定，使用中点和形心求积法则实现估计量 $\\eta^2$，其中 $h_F=|F|$ 且 $h_K=\\sqrt{|K|}$。\n- 在面中点处使用牵引力跳跃定义 $[\\![\\sigma_h n]\\!]=\\sigma_h^+ n_F + \\sigma_h^-(-n_F)$。\n- 为每个测试用例计算一个标量 $\\eta^2$。\n- 最终输出格式：您的程序应生成单行输出，其中包含按测试用例顺序排列的结果，格式为方括号内的逗号分隔列表，每个结果四舍五入到六位小数（例如，$[r_1,r_2,r_3]$）。不应打印任何额外文本。",
            "solution": "用户提供的问题陈述已经过分析和验证。该问题被认为是科学上合理的、适定的，并包含唯一解所需的所有必要信息。该问题要求计算应用于二维线性弹性的不连续伽辽金（DG）方法的基于残差的后验误差估计量 $\\eta^2$。将按规定对三个不同的测试用例进行计算。\n\n误差估计量由以下公式给出：\n$$\n\\eta^2 \\;=\\; \\sum_{F \\in \\mathcal{F}_{\\mathrm{int}}} h_F \\,\\lVert [\\![ \\sigma_h n ]\\!] \\rVert_{F}^2 \\;+\\; \\sum_{K \\in \\mathcal{T}_h} h_K^2 \\,\\lVert f + \\nabla \\cdot \\sigma_h \\rVert_{K}^2\n$$\n问题为所涉及的各项提供了具体的实现方式：\n- **长度尺度：** 面的尺度是 $h_F = |F|$，即面 $F$ 的长度。单元的尺度是 $h_K = \\sqrt{|K|}$，其中 $|K|$ 是单元 $K$ 的面积。这意味着 $h_K^2 = |K|$。\n- **求积法则：**\n  - 单元残差项使用单元面积 $|K|$ 和在单元形心处的残差值进行近似。由于每个单元上的应力场 $\\sigma_h$ 是线性的，体力 $f$ 是常数，因此项 $f + \\nabla \\cdot \\sigma_h$ 在整个单元上是常数。因此，单元贡献 $\\eta_K^2$ 为：\n  $$\n  \\eta_K^2 = h_K^2 \\cdot \\lVert f + \\nabla \\cdot \\sigma_h \\rVert_K^2 \\approx (\\sqrt{|K|})^2 \\cdot \\left( |K| \\, \\lVert f + \\nabla \\cdot \\sigma_h \\rVert_2^2 \\right) = |K|^2 \\, \\lVert f + \\nabla \\cdot \\sigma_h \\rVert_2^2\n  $$\n  - 面跳跃项使用面长度 $|F|$ 和在面中点 $m_F$ 处计算的牵引力跳跃进行近似。跳跃定义为带有向外法向量的牵引力之和，可简化为 $(\\sigma_h^+(m_F) - \\sigma_h^-(m_F))n_F$。面贡献 $\\eta_F^2$ 为：\n  $$\n  \\eta_F^2 = h_F \\cdot \\lVert [\\![ \\sigma_h n ]\\!] \\rVert_F^2 \\approx |F| \\cdot \\left( |F| \\, \\lVert (\\sigma_h^+(m_F) - \\sigma_h^-(m_F)) n_F \\rVert_2^2 \\right) = |F|^2 \\, \\lVert (\\sigma_h^+(m_F) - \\sigma_h^-(m_F)) n_F \\rVert_2^2\n  $$\n\n每个单元 $K$ 上的应力场 $\\sigma_h$ 由线性多项式给出：\n$$\n\\sigma_{xx}(x,y) = a_0 + a_1 x + a_2 y\n$$\n$$\n\\sigma_{yy}(x,y) = b_0 + b_1 x + b_2 y\n$$\n$$\n\\sigma_{xy}(x,y) = c_0 + c_1 x + c_2 y\n$$\n该应力场的散度在 $K$ 上是一个常数向量：\n$$\n\\nabla\\cdot\\sigma_h = \n\\begin{bmatrix}\n\\partial_x \\sigma_{xx} + \\partial_y \\sigma_{xy} \\\\\n\\partial_x \\sigma_{xy} + \\partial_y \\sigma_{yy}\n\\end{bmatrix}\n=\n\\begin{bmatrix}\na_1 + c_2 \\\\\nc_1 + b_2\n\\end{bmatrix}\n$$\n在单位法向量为 $n=(n_x, n_y)$ 的表面上的牵引力向量是 $t = \\sigma n$：\n$$\nt = \n\\begin{bmatrix}\n\\sigma_{xx} n_x + \\sigma_{xy} n_y \\\\\n\\sigma_{xy} n_x + \\sigma_{yy} n_y\n\\end{bmatrix}\n$$\n\n我们现在将为每个测试用例计算 $\\eta^2$。\n\n### 测试用例 1：两个水平相邻的矩形\n\n- **单元：** $K_0 = [0,0.5]\\times[0,1]$, $K_1 = [0.5,1]\\times[0,1]$。\n- **内部面：** $F$ 是在 $x=0.5$ 处从 $y=0$ 到 $y=1$ 的线段。\n  - 面的几何属性：$|F|=1$，中点 $m_F=(0.5, 0.5)$。\n  - 法向量：$n_F=(1,0)$ （从 $K_0=K^+$ 向外）。\n\n**1. 单元贡献**\n- **单元 $K_0$ ($|K_0|=0.5$):**\n  - 应力系数：$(a_1,a_2)=(1,0)$, $(b_1,b_2)=(0,-1)$, $(c_1,c_2)=(0.5,0.2)$。\n  - 散度：$\\nabla\\cdot\\sigma_{h_0} = \\begin{pmatrix} 1+0.2 \\\\ 0.5-1 \\end{pmatrix} = \\begin{pmatrix} 1.2 \\\\ -0.5 \\end{pmatrix}$。\n  - 体力：$f_0 = \\begin{pmatrix} -0.2 \\\\ 0.5 \\end{pmatrix}$。\n  - 残差：$R_0 = f_0 + \\nabla\\cdot\\sigma_{h_0} = \\begin{pmatrix} -0.2+1.2 \\\\ 0.5-0.5 \\end{pmatrix} = \\begin{pmatrix} 1.0 \\\\ 0.0 \\end{pmatrix}$。\n  - 贡献：$\\eta_{K_0}^2 = |K_0|^2 \\lVert R_0 \\rVert_2^2 = (0.5)^2 (1.0^2+0.0^2) = 0.25$。\n- **单元 $K_1$ ($|K_1|=0.5$):**\n  - 应力系数：$(a_1,a_2)=(-1,0)$, $(b_1,b_2)=(0,1)$, $(c_1,c_2)=(-0.3,0.4)$。\n  - 散度：$\\nabla\\cdot\\sigma_{h_1} = \\begin{pmatrix} -1+0.4 \\\\ -0.3+1 \\end{pmatrix} = \\begin{pmatrix} -0.6 \\\\ 0.7 \\end{pmatrix}$。\n  - 体力：$f_1 = \\begin{pmatrix} 0.1 \\\\ -0.2 \\end{pmatrix}$。\n  - 残差：$R_1 = f_1 + \\nabla\\cdot\\sigma_{h_1} = \\begin{pmatrix} 0.1-0.6 \\\\ -0.2+0.7 \\end{pmatrix} = \\begin{pmatrix} -0.5 \\\\ 0.5 \\end{pmatrix}$。\n  - 贡献：$\\eta_{K_1}^2 = |K_1|^2 \\lVert R_1 \\rVert_2^2 = (0.5)^2 ((-0.5)^2+0.5^2) = 0.25 \\cdot 0.5 = 0.125$。\n\n总单元贡献：$\\sum \\eta_K^2 = 0.25 + 0.125 = 0.375$。\n\n**2. 面贡献**\n- **面 $F$:**\n  - 在 $m_F(0.5, 0.5)$ 处 $K_0$ 侧的应力：\n    $\\sigma^+_{xx} = 2+1(0.5) = 2.5$, $\\sigma^+_{yy} = 1-1(0.5) = 0.5$, $\\sigma^+_{xy} = 0.5(0.5)+0.2(0.5)=0.35$。\n    $\\sigma_h^+(m_F) = \\begin{pmatrix} 2.5  0.35 \\\\ 0.35  0.5 \\end{pmatrix}$。\n  - 在 $m_F(0.5, 0.5)$ 处 $K_1$ 侧的应力：\n    $\\sigma^-_{xx} = 1-1(0.5) = 0.5$, $\\sigma^-_{yy} = 2+1(0.5) = 2.5$, $\\sigma^-_{xy} = -0.3(0.5)+0.4(0.5)=0.05$。\n    $\\sigma_h^-(m_F) = \\begin{pmatrix} 0.5  0.05 \\\\ 0.05  2.5 \\end{pmatrix}$。\n  - 应力差：$\\Delta\\sigma = \\sigma_h^+ - \\sigma_h^- = \\begin{pmatrix} 2.0  0.3 \\\\ 0.3  -2.0 \\end{pmatrix}$。\n  - 牵引力跳跃向量：$J_F = \\Delta\\sigma \\cdot n_F = \\begin{pmatrix} 2.0  0.3 \\\\ 0.3  -2.0 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 2.0 \\\\ 0.3 \\end{pmatrix}$。\n  - 贡献：$\\eta_F^2 = |F|^2 \\lVert J_F \\rVert_2^2 = (1)^2 (2.0^2+0.3^2) = 4.09$。\n\n**情况 1 的总估计量：** $\\eta^2 = 0.375 + 4.09 = 4.465$。\n\n### 测试用例 2：处于精确平衡状态的单个矩形\n\n- **单元：** $K_0 = [0,1]\\times[0,1]$。\n- **内部面：** 无。\n\n**1. 单元贡献**\n- **单元 $K_0$ ($|K_0|=1.0$):**\n  - 应力系数：$(a_1,a_2)=(1,0)$, $(b_1,b_2)=(0,1)$, $(c_1,c_2)=(0,0)$。\n  - 散度：$\\nabla\\cdot\\sigma_{h_0} = \\begin{pmatrix} 1+0 \\\\ 0+1 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$。\n  - 体力：$f_0 = \\begin{pmatrix} -1 \\\\ -1 \\end{pmatrix}$。\n  - 残差：$R_0 = f_0 + \\nabla\\cdot\\sigma_{h_0} = \\begin{pmatrix} -1+1 \\\\ -1+1 \\end{pmatrix} = \\begin{pmatrix} 0.0 \\\\ 0.0 \\end{pmatrix}$。\n  - 贡献：$\\eta_{K_0}^2 = |K_0|^2 \\lVert R_0 \\rVert_2^2 = (1.0)^2 (0.0^2+0.0^2) = 0.0$。\n\n**2. 面贡献**\n- 由于没有内部面，对 $\\mathcal{F}_{\\mathrm{int}}$ 的求和为空，贡献为 $0$。\n\n**情况 2 的总估计量：** $\\eta^2 = 0.0 + 0.0 = 0.0$。\n\n### 测试用例 3：两个垂直堆叠的矩形\n\n- **单元：** $K_0 = [0,1]\\times[0,0.4]$, $K_1 = [0,1]\\times[0.4,1]$。\n- **内部面：** $F$ 是在 $y=0.4$ 处从 $x=0$ 到 $x=1$ 的线段。\n  - 面的几何属性：$|F|=1$，中点 $m_F=(0.5, 0.4)$。\n  - 法向量：$n_F=(0,1)$ （从 $K_0=K^+$ 向外）。\n\n**1. 单元贡献**\n- **单元 $K_0$ ($|K_0|=0.4$):**\n  - 应力系数：$(a_1,a_2)=(0,0.1)$, $(b_1,b_2)=(-0.2,0)$, $(c_1,c_2)=(0.3,-0.1)$。\n  - 散度：$\\nabla\\cdot\\sigma_{h_0} = \\begin{pmatrix} 0-0.1 \\\\ 0.3+0 \\end{pmatrix} = \\begin{pmatrix} -0.1 \\\\ 0.3 \\end{pmatrix}$。\n  - 体力：$f_0 = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$。\n  - 残差：$R_0 = \\begin{pmatrix} -0.1 \\\\ 0.3 \\end{pmatrix}$。\n  - 贡献：$\\eta_{K_0}^2 = (0.4)^2 ((-0.1)^2+0.3^2) = 0.16 \\cdot (0.01+0.09) = 0.016$。\n- **单元 $K_1$ ($|K_1|=0.6$):**\n  - 应力系数：$(a_1,a_2)=(0,-0.2)$, $(b_1,b_2)=(0.3,0)$, $(c_1,c_2)=(-0.2,0.4)$。\n  - 散度：$\\nabla\\cdot\\sigma_{h_1} = \\begin{pmatrix} 0+0.4 \\\\ -0.2+0 \\end{pmatrix} = \\begin{pmatrix} 0.4 \\\\ -0.2 \\end{pmatrix}$。\n  - 体力：$f_1 = \\begin{pmatrix} 0 \\\\ 0.1 \\end{pmatrix}$。\n  - 残差：$R_1 = f_1 + \\nabla\\cdot\\sigma_{h_1} = \\begin{pmatrix} 0+0.4 \\\\ 0.1-0.2 \\end{pmatrix} = \\begin{pmatrix} 0.4 \\\\ -0.1 \\end{pmatrix}$。\n  - 贡献：$\\eta_{K_1}^2 = (0.6)^2 (0.4^2+(-0.1)^2) = 0.36 \\cdot (0.16+0.01) = 0.36 \\cdot 0.17 = 0.0612$。\n\n总单元贡献：$\\sum \\eta_K^2 = 0.016 + 0.0612 = 0.0772$。\n\n**2. 面贡献**\n- **面 $F$:**\n  - 在 $m_F(0.5, 0.4)$ 处 $K_0$ 侧的应力：\n    $\\sigma^+_{xx} = 1+0.1(0.4)=1.04$, $\\sigma^+_{yy} = 2-0.2(0.5)=1.9$, $\\sigma^+_{xy} = 0.3(0.5)-0.1(0.4)=0.11$。\n    $\\sigma_h^+(m_F) = \\begin{pmatrix} 1.04  0.11 \\\\ 0.11  1.9 \\end{pmatrix}$。\n  - 在 $m_F(0.5, 0.4)$ 处 $K_1$ 侧的应力：\n    $\\sigma^-_{xx} = 1-0.2(0.4)=0.92$, $\\sigma^-_{yy} = 1+0.3(0.5)=1.15$, $\\sigma^-_{xy} = -0.2(0.5)+0.4(0.4)=0.06$。\n    $\\sigma_h^-(m_F) = \\begin{pmatrix} 0.92  0.06 \\\\ 0.06  1.15 \\end{pmatrix}$。\n  - 应力差：$\\Delta\\sigma = \\sigma_h^+ - \\sigma_h^- = \\begin{pmatrix} 0.12  0.05 \\\\ 0.05  0.75 \\end{pmatrix}$。\n  - 牵引力跳跃向量：$J_F = \\Delta\\sigma \\cdot n_F = \\begin{pmatrix} 0.12  0.05 \\\\ 0.05  0.75 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 0.05 \\\\ 0.75 \\end{pmatrix}$。\n  - 贡献：$\\eta_F^2 = (1)^2 (0.05^2+0.75^2) = 0.0025 + 0.5625 = 0.565$。\n\n**情况 3 的总估计量：** $\\eta^2 = 0.0772 + 0.565 = 0.6422$。\n\n结果摘要：\n- 情况 1：$4.465$\n- 情况 2：$0.0$\n- 情况 3：$0.6422$",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the a posteriori error estimator eta^2 for three test cases\n    in 2D linear elasticity using a Discontinuous Galerkin formulation.\n    \"\"\"\n\n    test_cases = [\n        # Test Case 1\n        {\n            \"elements\": [\n                {\n                    \"id\": 0,\n                    \"bbox\": [0, 0.5, 0, 1],\n                    \"stress_coeffs\": {\n                        \"xx\": [2.0, 1.0, 0.0],  # a0, a1, a2\n                        \"yy\": [1.0, 0.0, -1.0], # b0, b1, b2\n                        \"xy\": [0.0, 0.5, 0.2],  # c0, c1, c2\n                    },\n                    \"body_force\": np.array([-0.2, 0.5]),\n                },\n                {\n                    \"id\": 1,\n                    \"bbox\": [0.5, 1, 0, 1],\n                    \"stress_coeffs\": {\n                        \"xx\": [1.0, -1.0, 0.0],\n                        \"yy\": [2.0, 0.0, 1.0],\n                        \"xy\": [0.0, -0.3, 0.4],\n                    },\n                    \"body_force\": np.array([0.1, -0.2]),\n                },\n            ],\n            \"faces\": [\n                {\n                    \"endpoints\": [np.array([0.5, 0]), np.array([0.5, 1])],\n                    \"k_plus_id\": 0,\n                    \"k_minus_id\": 1,\n                    \"normal\": np.array([1, 0]),\n                }\n            ],\n        },\n        # Test Case 2\n        {\n            \"elements\": [\n                {\n                    \"id\": 0,\n                    \"bbox\": [0, 1, 0, 1],\n                    \"stress_coeffs\": {\n                        \"xx\": [0.0, 1.0, 0.0],\n                        \"yy\": [0.0, 0.0, 1.0],\n                        \"xy\": [0.0, 0.0, 0.0],\n                    },\n                    \"body_force\": np.array([-1.0, -1.0]),\n                }\n            ],\n            \"faces\": [],\n        },\n        # Test Case 3\n        {\n            \"elements\": [\n                {\n                    \"id\": 0,\n                    \"bbox\": [0, 1, 0, 0.4],\n                    \"stress_coeffs\": {\n                        \"xx\": [1.0, 0.0, 0.1],\n                        \"yy\": [2.0, -0.2, 0.0],\n                        \"xy\": [0.0, 0.3, -0.1],\n                    },\n                    \"body_force\": np.array([0.0, 0.0]),\n                },\n                {\n                    \"id\": 1,\n                    \"bbox\": [0, 1, 0.4, 1],\n                    \"stress_coeffs\": {\n                        \"xx\": [1.0, 0.0, -0.2],\n                        \"yy\": [1.0, 0.3, 0.0],\n                        \"xy\": [0.0, -0.2, 0.4],\n                    },\n                    \"body_force\": np.array([0.0, 0.1]),\n                },\n            ],\n            \"faces\": [\n                {\n                    \"endpoints\": [np.array([0, 0.4]), np.array([1, 0.4])],\n                    \"k_plus_id\": 0,\n                    \"k_minus_id\": 1,\n                    \"normal\": np.array([0, 1]),\n                }\n            ],\n        },\n    ]\n\n    def eval_stress_tensor(x, y, coeffs):\n        a0, a1, a2 = coeffs[\"xx\"]\n        b0, b1, b2 = coeffs[\"yy\"]\n        c0, c1, c2 = coeffs[\"xy\"]\n        s_xx = a0 + a1 * x + a2 * y\n        s_yy = b0 + b1 * x + b2 * y\n        s_xy = c0 + c1 * x + c2 * y\n        return np.array([[s_xx, s_xy], [s_xy, s_yy]])\n\n    def eval_div_stress(coeffs):\n        _, a1, a2 = coeffs[\"xx\"]\n        _, _, b2 = coeffs[\"yy\"]\n        _, c1, c2 = coeffs[\"xy\"]\n        div_x = a1 + c2\n        div_y = c1 + b2\n        return np.array([div_x, div_y])\n\n    results = []\n    for case in test_cases:\n        eta_squared = 0.0\n        \n        elements_by_id = {elem[\"id\"]: elem for elem in case[\"elements\"]}\n\n        # Calculate element contributions\n        for elem in case[\"elements\"]:\n            x0, x1, y0, y1 = elem[\"bbox\"]\n            area = (x1 - x0) * (y1 - y0)\n            \n            div_sigma = eval_div_stress(elem[\"stress_coeffs\"])\n            residual = elem[\"body_force\"] + div_sigma\n            \n            residual_norm_sq = np.dot(residual, residual)\n            eta_squared += area**2 * residual_norm_sq\n\n        # Calculate face contributions\n        for face in case[\"faces\"]:\n            p0, p1 = face[\"endpoints\"]\n            face_len = np.linalg.norm(p1 - p0)\n            midpoint = (p0 + p1) / 2.0\n            x_m, y_m = midpoint\n\n            k_plus = elements_by_id[face[\"k_plus_id\"]]\n            k_minus = elements_by_id[face[\"k_minus_id\"]]\n            \n            sigma_plus = eval_stress_tensor(x_m, y_m, k_plus[\"stress_coeffs\"])\n            sigma_minus = eval_stress_tensor(x_m, y_m, k_minus[\"stress_coeffs\"])\n            \n            delta_sigma = sigma_plus - sigma_minus\n            normal = face[\"normal\"]\n            \n            jump_vector = delta_sigma @ normal\n            jump_norm_sq = np.dot(jump_vector, jump_vector)\n            \n            eta_squared += face_len**2 * jump_norm_sq\n            \n        results.append(f\"{eta_squared:.6f}\")\n\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}