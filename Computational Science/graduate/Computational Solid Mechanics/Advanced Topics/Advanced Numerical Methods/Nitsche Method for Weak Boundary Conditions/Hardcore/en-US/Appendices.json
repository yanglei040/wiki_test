{
    "hands_on_practices": [
        {
            "introduction": "To move from the continuous theory of the Nitsche method to a practical finite element implementation, we must be able to translate its integral terms into discrete, computable element matrices. This exercise provides foundational practice in this critical step. By working through the derivation for a single triangular element, you will see how abstract variational forms are realized through the interplay of shape functions, material laws, and numerical quadrature, building a core competency for implementing weak boundary conditions .",
            "id": "3584364",
            "problem": "Consider small-strain, linear, isotropic elasticity in two space dimensions. The displacement field is denoted by $u:\\Omega\\rightarrow\\mathbb{R}^{2}$, the linearized strain is $\\varepsilon(u)=\\frac{1}{2}\\left(\\nabla u+\\nabla u^{\\top}\\right)$, and the Cauchy stress is $\\sigma(u)=2\\mu\\,\\varepsilon(u)+\\lambda\\,\\operatorname{tr}(\\varepsilon(u))\\,I$, where $I$ is the identity tensor, $\\mu$ and $\\lambda$ are the Lamé parameters, and $\\operatorname{tr}(\\cdot)$ denotes the trace. On a Dirichlet boundary $\\Gamma_{D}$, the traction is $\\sigma(u)n$, where $n$ is the unit outward normal. The Nitsche’s method imposes Dirichlet boundary conditions weakly by augmenting the bilinear form with boundary integrals that involve $\\sigma(u)n$, $\\sigma(v)n$, and a penalty term with parameter $\\gamma$.\n\nYou will focus on a single linear (degree $1$) triangular finite element used in the Finite Element Method (FEM). Let the element have vertices $x_{1}=(0,0)$, $x_{2}=(1,0)$, and $x_{3}=(0,1)$. The edge on $\\Gamma_{D}$ is the segment from $x_{1}$ to $x_{2}$, parameterized by $s\\in[0,1]$ via $x(s)=(s,0)$, with unit outward normal $n=(0,-1)^{\\top}$. The material is taken as isotropic with Young’s modulus $E$ and Poisson’s ratio $\\nu=0$, so that $\\lambda=0$ and $\\mu=\\frac{E}{2}$, hence $\\sigma(u)=E\\,\\varepsilon(u)$. The penalty parameter is scaled as $\\gamma=\\alpha\\,\\frac{E}{h_{e}}$, where $h_{e}$ is the length of the boundary edge. Take $E=210\\times 10^{9}$, $\\alpha=10$, and $h_{e}=1$. The Dirichlet data value is irrelevant for the requested bilinear form entry and should not be used.\n\nDenote the scalar shape functions associated with the vertices by $\\varphi_{1}$, $\\varphi_{2}$, and $\\varphi_{3}$, and construct the vector basis functions by multiplying each scalar shape function with the Cartesian unit vectors $e_{x}$ and $e_{y}$. Using the two-point Gaussian quadrature on $[0,1]$ with nodes $s_{1}=\\frac{1}{2}-\\frac{1}{2\\sqrt{3}}$ and $s_{2}=\\frac{1}{2}+\\frac{1}{2\\sqrt{3}}$, both with weight $w_{k}=\\frac{1}{2}$, do the following:\n\n1. Starting from the definitions above and the chosen geometry, derive the element-level quadrature expressions that assemble the three Nitsche contributions\n$$\n\\int_{\\Gamma_{D}}\\sigma(u_{h})\\,n\\cdot v_{h}\\,ds,\\quad\n\\int_{\\Gamma_{D}}\\sigma(v_{h})\\,n\\cdot u_{h}\\,ds,\\quad\n\\int_{\\Gamma_{D}}\\gamma\\,u_{h}\\cdot v_{h}\\,ds,\n$$\nfor vector-valued finite element trial function $u_{h}$ and test function $v_{h}$ built from the linear scalar shape functions on the given triangle.\n\n2. Using the derived expressions, evaluate the single scalar bilinear-form entry corresponding to the symmetric Nitsche combination $-\\int_{\\Gamma_{D}}\\sigma(u_{h})\\,n\\cdot v_{h}\\,ds-\\int_{\\Gamma_{D}}\\sigma(v_{h})\\,n\\cdot u_{h}\\,ds+\\int_{\\Gamma_{D}}\\gamma\\,u_{h}\\cdot v_{h}\\,ds$ for the pair where the trial basis is $\\varphi_{1}\\,e_{x}$ and the test basis is $\\varphi_{2}\\,e_{x}$. Compute the numerical value using the specified quadrature rule and the given parameters.\n\nExpress the final scalar entry in $\\mathrm{N}/\\mathrm{m}$ and round your answer to four significant figures.",
            "solution": "The user wants to solve a problem in computational solid mechanics concerning Nitsche's method for enforcing Dirichlet boundary conditions. The task consists of two parts: first, to derive the general quadrature expressions for the Nitsche boundary terms on a specific triangular element, and second, to compute a specific entry of the resulting bilinear form.\n\n### Step 1: Problem Validation\n\n#### Extract Givens\n-   **Problem Type**: 2D small-strain, linear, isotropic elasticity.\n-   **Element Geometry**: A linear triangular element with vertices $x_{1}=(0,0)$, $x_{2}=(1,0)$, and $x_{3}=(0,1)$.\n-   **Boundary Condition**: Dirichlet boundary condition on $\\Gamma_{D}$, which is the edge from $x_{1}$ to $x_{2}$.\n-   **Boundary Parameterization**: The edge on $\\Gamma_{D}$ is parameterized by $s\\in[0,1]$ as $x(s)=(s,0)$.\n-   **Outward Normal**: The unit outward normal on $\\Gamma_D$ is $n=(0,-1)^{\\top}$.\n-   **Material Properties**: Young's modulus $E = 210 \\times 10^{9}$, Poisson's ratio $\\nu=0$.\n-   **Constitutive Law**: From $\\nu=0$, the Lamé parameters are $\\lambda=0$ and $\\mu=\\frac{E}{2}$. The Cauchy stress tensor is given as $\\sigma(u)=E\\,\\varepsilon(u)$, with strain $\\varepsilon(u)=\\frac{1}{2}\\left(\\nabla u+\\nabla u^{\\top}\\right)$.\n-   **Penalty Parameter**: $\\gamma=\\alpha\\,\\frac{E}{h_{e}}$, with $\\alpha=10$ and boundary edge length $h_{e}=1$. So, $\\gamma = 10E$.\n-   **Finite Element Basis**: Vector basis functions are constructed from scalar linear shape functions $\\varphi_{i}$ as $\\varphi_{i}e_{x}$ and $\\varphi_{i}e_{y}$.\n-   **Numerical Integration**: Two-point Gaussian quadrature on $[0,1]$ with nodes $s_{1}=\\frac{1}{2}-\\frac{1}{2\\sqrt{3}}$, $s_{2}=\\frac{1}{2}+\\frac{1}{2\\sqrt{3}}$, and weights $w_{1}=w_{2}=\\frac{1}{2}$.\n-   **Task 1**: Derive the element-level quadrature expressions for the three Nitsche integrals:\n    $\\int_{\\Gamma_{D}}\\sigma(u_{h})\\,n\\cdot v_{h}\\,ds$, $\\int_{\\Gamma_{D}}\\sigma(v_{h})\\,n\\cdot u_{h}\\,ds$, and $\\int_{\\Gamma_{D}}\\gamma\\,u_{h}\\cdot v_{h}\\,ds$.\n-   **Task 2**: Evaluate the specific bilinear form entry $B(u_h, v_h) = -\\int_{\\Gamma_{D}}\\sigma(u_{h})\\,n\\cdot v_{h}\\,ds-\\int_{\\Gamma_{D}}\\sigma(v_{h})\\,n\\cdot u_{h}\\,ds+\\int_{\\Gamma_{D}}\\gamma\\,u_{h}\\cdot v_{h}\\,ds$ for the pair of trial function $u_{h} = \\varphi_{1}\\,e_{x}$ and test function $v_{h} = \\varphi_{2}\\,e_{x}$.\n-   **Output Format**: The final answer must be a numerical value in $\\mathrm{N}/\\mathrm{m}$, rounded to four significant figures.\n\n#### Validate Using Extracted Givens\n-   **Scientifically Grounded**: The problem is correctly formulated within the established theories of linear elasticity and the Finite Element Method. Nitsche's method is a standard and valid technique. The relationships between material parameters ($E, \\nu, \\lambda, \\mu$) are correct.\n-   **Well-Posed**: The problem is fully specified. It provides all necessary information: element geometry, material properties, basis functions, boundary definitions, and the numerical integration scheme. The goal is to compute a specific numerical value, which is a well-defined task.\n-   **Objective**: The problem is stated using precise and unambiguous technical language, free from any subjectivity.\n\nThe problem does not violate any of the invalidity criteria. It is a standard, well-posed problem in computational mechanics.\n\n#### Verdict and Action\nThe problem is valid. The solution will be provided.\n\n### Step 2: Solution\n\n#### Preliminaries: Shape Functions and Gradients\nThe scalar linear shape functions $\\varphi_i(x,y)$ for the triangle with vertices $x_1=(0,0)$, $x_2=(1,0)$, $x_3=(0,1)$ are derived from the condition $\\varphi_i(x_j) = \\delta_{ij}$.\n-   $\\varphi_{1}(x,y) = 1-x-y$\n-   $\\varphi_{2}(x,y) = x$\n-   $\\varphi_{3}(x,y) = y$\n\nThe gradients of these shape functions are constant over the element:\n-   $\\nabla \\varphi_{1} = \\begin{pmatrix} -1 \\\\ -1 \\end{pmatrix}$\n-   $\\nabla \\varphi_{2} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$\n-   $\\nabla \\varphi_{3} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$\n\nThe boundary $\\Gamma_D$ corresponds to the edge connecting $x_1$ and $x_2$, parameterized by $x(s) = (s,0)$ for $s \\in [0,1]$. On this boundary, the shape functions take the values:\n-   $\\varphi_{1}(s,0) = 1-s$\n-   $\\varphi_{2}(s,0) = s$\n-   $\\varphi_{3}(s,0) = 0$\n\n#### Part 1: Derivation of Quadrature Expressions\n\nLet the trial function $u_h$ and test function $v_h$ be generic basis functions from the finite element space. We consider $u_h = \\varphi_k e_d$ and $v_h = \\varphi_l e_{d'}$, where $k, l \\in \\{1,2,3\\}$ and $d, d' \\in \\{x,y\\}$.\n\nThe strain tensor for $u_h = \\varphi_k e_d$ is $\\varepsilon(\\varphi_k e_d) = \\frac{1}{2}(\\nabla(\\varphi_k e_d) + \\nabla(\\varphi_k e_d)^\\top)$.\nThe stress is $\\sigma(u_h) = E\\varepsilon(\\varphi_k e_d)$.\nThe traction vector on $\\Gamma_D$ (with normal $n = (0,-1)^\\top$) is $\\sigma(u_h)n$.\n\nThe integrals are approximated using the two-point Gaussian quadrature rule: $\\int_{0}^{1} f(s) ds \\approx \\sum_{q=1}^{2} w_q f(s_q)$, with $w_{1,2}=1/2$.\n\n1.  **First Nitsche Term**: $\\int_{\\Gamma_{D}}\\sigma(u_{h})\\,n\\cdot v_{h}\\,ds$\n    For $u_h=\\varphi_k e_d$ and $v_h=\\varphi_l e_{d'}$, the integrand is $(\\sigma(\\varphi_k e_d)n) \\cdot (\\varphi_l(s,0) e_{d'})$. Note that $\\sigma(\\varphi_k e_d)$ is constant.\n    The quadrature expression is:\n    $$ \\int_{\\Gamma_{D}}\\sigma(\\varphi_k e_d)\\,n\\cdot (\\varphi_l e_{d'})\\,ds \\approx \\sum_{q=1}^{2} w_q \\left[ (E \\varepsilon(\\varphi_k e_d) n) \\cdot (\\varphi_l(s_q,0) e_{d'}) \\right] $$\n\n2.  **Second Nitsche Term (Symmetric)**: $\\int_{\\Gamma_{D}}\\sigma(v_{h})\\,n\\cdot u_{h}\\,ds$\n    This is obtained by swapping the roles of trial and test functions.\n    The quadrature expression is:\n    $$ \\int_{\\Gamma_{D}}\\sigma(\\varphi_l e_{d'})\\,n\\cdot (\\varphi_k e_d)\\,ds \\approx \\sum_{q=1}^{2} w_q \\left[ (E \\varepsilon(\\varphi_l e_{d'}) n) \\cdot (\\varphi_k(s_q,0) e_d) \\right] $$\n\n3.  **Third Nitsche Term (Penalty)**: $\\int_{\\Gamma_{D}}\\gamma\\,u_{h}\\cdot v_{h}\\,ds$\n    The integrand is $\\gamma (\\varphi_k(s,0)e_d) \\cdot (\\varphi_l(s,0)e_{d'}) = \\gamma \\varphi_k(s,0) \\varphi_l(s,0) \\delta_{dd'}$.\n    The quadrature expression is:\n    $$ \\int_{\\Gamma_{D}}\\gamma (\\varphi_k e_d)\\cdot (\\varphi_l e_{d'})\\,ds \\approx \\gamma \\delta_{dd'} \\sum_{q=1}^{2} w_q \\varphi_k(s_q,0) \\varphi_l(s_q,0) $$\n\nThese three expressions constitute the general element-level quadrature forms requested.\n\n#### Part 2: Evaluation of a Specific Bilinear Form Entry\n\nWe now evaluate $B(u_h, v_h) = -I_1 - I_2 + I_3$ where $I_1 = \\int_{\\Gamma_D} \\sigma(u_h)n \\cdot v_h ds$, $I_2 = \\int_{\\Gamma_D} \\sigma(v_h)n \\cdot u_h ds$, and $I_3 = \\int_{\\Gamma_D} \\gamma u_h \\cdot v_h ds$.\nThe specific basis functions are:\n-   Trial function: $u_h = \\varphi_1 e_x = (1-x-y)e_x$\n-   Test function: $v_h = \\varphi_2 e_x = x e_x$\n\n**Calculate Tractions:**\n\nFor $u_h = \\varphi_1 e_x$:\nThe displacement vector is $u_h = (\\varphi_1, 0)$. Using the standard definition for the gradient of a vector field, $(\\nabla u_h)_{ij} = \\partial_j u_i$, we have:\n$\\nabla u_h = \\begin{pmatrix} \\partial_x u_x & \\partial_y u_x \\\\ \\partial_x u_y & \\partial_y u_y \\end{pmatrix} = \\begin{pmatrix} \\partial_x \\varphi_1 & \\partial_y \\varphi_1 \\\\ 0 & 0 \\end{pmatrix} = \\begin{pmatrix} -1 & -1 \\\\ 0 & 0 \\end{pmatrix}$.\n$\\varepsilon(u_h) = \\frac{1}{2}(\\nabla u_h + \\nabla u_h^\\top) = \\frac{1}{2}\\left( \\begin{pmatrix} -1 & -1 \\\\ 0 & 0 \\end{pmatrix} + \\begin{pmatrix} -1 & 0 \\\\ -1 & 0 \\end{pmatrix} \\right) = \\begin{pmatrix} -1 & -1/2 \\\\ -1/2 & 0 \\end{pmatrix}$.\n$\\sigma(u_h) = E\\varepsilon(u_h)$.\nThe traction is $\\sigma(u_h)n = E \\begin{pmatrix} -1 & -1/2 \\\\ -1/2 & 0 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ -1 \\end{pmatrix} = E \\begin{pmatrix} 1/2 \\\\ 0 \\end{pmatrix}$.\n\nFor $v_h = \\varphi_2 e_x$:\n$\\nabla v_h = \\begin{pmatrix} \\partial_x \\varphi_2 & \\partial_y \\varphi_2 \\\\ 0 & 0 \\end{pmatrix} = \\begin{pmatrix} 1 & 0 \\\\ 0 & 0 \\end{pmatrix}$.\n$\\varepsilon(v_h) = \\frac{1}{2}(\\nabla v_h + \\nabla v_h^\\top) = \\begin{pmatrix} 1 & 0 \\\\ 0 & 0 \\end{pmatrix}$.\n$\\sigma(v_h) = E\\varepsilon(v_h)$.\nThe traction is $\\sigma(v_h)n = E \\begin{pmatrix} 1 & 0 \\\\ 0 & 0 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ -1 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$.\n\n**Calculate Integrals:**\n\nThe integrals are over $s \\in [0,1]$. On this boundary, $u_h(s) = (1-s)e_x$ and $v_h(s) = s e_x$. The two-point quadrature is exact for polynomials up to degree $2(2)-1=3$. All our integrands will be of degree $2$ or less, so the quadrature is exact. We can compute the integrals analytically.\n\n1.  **Integral $I_1$**: $\\int_0^1 (\\sigma(u_h)n) \\cdot v_h(s) ds$\n    The integrand is $(E \\begin{pmatrix} 1/2 \\\\ 0 \\end{pmatrix}) \\cdot (s e_x) = (E/2) s$.\n    $$I_1 = \\int_0^1 \\frac{E}{2}s \\, ds = \\frac{E}{2} \\left[\\frac{s^2}{2}\\right]_0^1 = \\frac{E}{4}$$\n\n2.  **Integral $I_2$**: $\\int_0^1 (\\sigma(v_h)n) \\cdot u_h(s) ds$\n    The traction $\\sigma(v_h)n$ is the zero vector.\n    $$I_2 = \\int_0^1 0 \\cdot ((1-s)e_x) \\, ds = 0$$\n\n3.  **Integral $I_3$**: $\\int_0^1 \\gamma u_h(s) \\cdot v_h(s) ds$\n    With $\\gamma = 10E$, the integrand is $\\gamma ((1-s)e_x) \\cdot (s e_x) = \\gamma s(1-s)$.\n    $$I_3 = \\gamma \\int_0^1 (s-s^2) \\, ds = \\gamma \\left[\\frac{s^2}{2} - \\frac{s^3}{3}\\right]_0^1 = \\gamma \\left(\\frac{1}{2} - \\frac{1}{3}\\right) = \\frac{\\gamma}{6} = \\frac{10E}{6} = \\frac{5E}{3}$$\n\n**Combine Terms:**\nThe total contribution to the bilinear form is:\n$$ B(\\varphi_1 e_x, \\varphi_2 e_x) = -I_1 - I_2 + I_3 = -\\frac{E}{4} - 0 + \\frac{5E}{3} = E\\left(-\\frac{3}{12} + \\frac{20}{12}\\right) = \\frac{17E}{12} $$\n\n**Final Numerical Value:**\nSubstituting $E = 210 \\times 10^{9} \\, \\mathrm{N}/\\mathrm{m}^2$. A stiffness matrix entry has units of N/m, assuming a plane problem of unit thickness.\n$$ \\text{Value} = \\frac{17}{12} \\times (210 \\times 10^9) = \\frac{3570}{12} \\times 10^9 = 297.5 \\times 10^9 $$\nIn standard scientific notation and rounded to four significant figures (which it already has), the value is $2.975 \\times 10^{11} \\, \\mathrm{N}/\\mathrm{m}$.",
            "answer": "$$\\boxed{2.975 \\times 10^{11}}$$"
        },
        {
            "introduction": "The Nitsche method is one of several techniques for weakly imposing Dirichlet boundary conditions, alongside the classical penalty and Lagrange multiplier methods. This practice offers a direct, hands-on comparison of these three approaches by analyzing a key metric of numerical performance: the condition number. By assembling and analyzing the system matrices for a simple one-dimensional bar problem, you will gain tangible insight into the numerical stability, robustness, and potential drawbacks of each method, clarifying the practical advantages that have made the Nitsche method so popular .",
            "id": "3584401",
            "problem": "Consider a linear elastic bar occupying the domain $[0,1]$ with Young’s modulus $E$ and cross-sectional area $A$. The governing equation in strong form is $-(E A u')' = f$ in $[0,1]$, together with the Dirichlet boundary condition $u(0) = 0$ enforced at the left end and a natural boundary condition at $x=1$. Starting from the fundamental weak form of linear elasticity and performing integration by parts, the left boundary contribution can be handled weakly. Using the Finite Element Method (FEM), approximate the displacement $u$ with continuous, piecewise-linear shape functions on a uniform mesh of $N$ elements.\n\nYour tasks are:\n\n- Starting from the weak form, and without relying on any shortcut formulas, derive the discrete bilinear forms for three boundary enforcement strategies at $x=0$:\n  1. Penalty method: augment the bilinear form with a boundary penalty term scaled consistently with material and mesh parameters.\n  2. Nitsche’s method: add consistent boundary terms along with a symmetric stabilization term to ensure coercivity.\n  3. Lagrange multiplier method: enforce the boundary constraint with a Lagrange multiplier, forming an augmented saddle-point system.\n- Assemble the global stiffness matrix for each method using linear shape functions on a uniform mesh with $N$ elements, element length $h = 1/N$, Young’s modulus $E$, and cross-sectional area $A$. Do not eliminate degrees of freedom by directly imposing $u(0)=0$; enforce it weakly as specified.\n- Compute the two-norm condition number for each assembled matrix. For a square matrix $M$, define the two-norm condition number as $\\kappa_2(M) = \\sigma_{\\max}(M)/\\sigma_{\\min}(M)$, where $\\sigma_{\\max}(M)$ and $\\sigma_{\\min}(M)$ are the largest and smallest singular values obtained by Singular Value Decomposition (SVD).\n\nAssumptions and requirements:\n\n- Assume $A = 1$ and $E = 1$, so that the stiffness entries are dimensionless and the condition numbers are dimensionless.\n- For the penalty method, use a penalty parameter $\\gamma_p$ and scale the boundary term consistently with the element length $h$.\n- For Nitsche’s method, use a stabilization parameter $\\alpha$ and include the consistent symmetric boundary terms together with a stabilization term that scales with $h$. The bilinear form is:\n$a_N(u,v) = \\int_0^1 E A u'v' \\,dx - E A u'(0)v(0) - E A v'(0)u(0) + \\frac{\\alpha EA}{h} u(0)v(0)$.\n- For the Lagrange multiplier method, use a scaling parameter $s$ for the discrete constraint operator; study its effect on conditioning.\n\nTest suite:\n\n- Use the following test cases, each specified by $(N,\\gamma_p,\\alpha,s)$:\n  1. $(4, 100, 10, 1)$: a standard mesh and moderate stabilization parameters (happy path).\n  2. $(1, 100, 10, 1)$: a single element mesh to probe coarse discretization behavior (boundary case).\n  3. $(8, 1000000, 10, 1)$: very large penalty to stress conditioning (edge case).\n  4. $(8, 100, 0.000001, 100)$: very small Nitsche stabilization and large multiplier scaling to probe near-instability and saddle-point conditioning (edge case).\n\nOutput specification:\n\n- For each test case, compute a list of three floats $[\\kappa_2(M_{\\text{penalty}}), \\kappa_2(M_{\\text{nitsche}}), \\kappa_2(M_{\\text{multiplier}})]$.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each entry corresponds to one test case in the same order as above, and each entry is itself a list of the three floats. For example: $[[c_{11},c_{12},c_{13}],[c_{21},c_{22},c_{23}],\\dots]$.",
            "solution": "The problem is a valid exercise in computational solid mechanics, focusing on the finite element implementation and numerical analysis of three common methods for weakly enforcing Dirichlet boundary conditions. The problem is scientifically grounded, well-posed, and objective. We will proceed with a full derivation and solution.\n\nThe governing equation for a one-dimensional linear elastic bar is the strong form of the boundary value problem:\n$$ -(E A u'(x))' = f(x) \\quad \\text{for } x \\in (0, 1) $$\nwith a Dirichlet boundary condition $u(0) = 0$ and a natural (Neumann) boundary condition $EA u'(1) = 0$. Here, $u(x)$ is the axial displacement, $E$ is Young's modulus, $A$ is the cross-sectional area, and $f(x)$ is a distributed axial force.\n\nTo derive the weak form, we multiply the governing equation by a sufficiently smooth test function $v(x)$ and integrate over the domain $\\Omega = [0, 1]$:\n$$ \\int_0^1 -(E A u')' v \\,dx = \\int_0^1 f v \\,dx $$\nApplying integration by parts to the left-hand side yields:\n$$ \\left[ -E A u' v \\right]_0^1 + \\int_0^1 E A u' v' \\,dx = \\int_0^1 f v \\,dx $$\n$$ -E A u'(1) v(1) + E A u'(0) v(0) + \\int_0^1 E A u' v' \\,dx = \\int_0^1 f v \\,dx $$\nApplying the natural boundary condition $E A u'(1) = 0$, the equation simplifies to:\n$$ \\int_0^1 E A u' v' \\,dx + E A u'(0) v(0) = \\int_0^1 f v \\,dx $$\nThis identity holds for the exact solution. The term $E A u'(0)$ represents the unknown reaction force at the Dirichlet boundary. The three specified methods—Penalty, Nitsche, and Lagrange multiplier—deal with this term and the enforcement of $u(0)=0$ in different ways.\n\nWe discretize the domain $[0,1]$ into $N$ uniform elements of length $h = 1/N$. We approximate the displacement $u$ and test function $v$ using continuous, piecewise-linear (P1) basis functions $\\phi_i(x)$:\n$$ u_h(x) = \\sum_{j=0}^{N} u_j \\phi_j(x) \\quad \\text{and} \\quad v_h(x) = \\sum_{i=0}^{N} v_i \\phi_i(x) $$\nwhere $u_j$ are the nodal displacement degrees of freedom. The standard bilinear form $a(u,v) = \\int_0^1 E A u' v' \\,dx$ discretizes to the matrix-vector product $\\mathbf{v}^T \\mathbf{K}_{bulk} \\mathbf{u}$. The matrix $\\mathbf{K}_{bulk}$ is the global stiffness matrix assembled from element stiffness matrices $\\mathbf{k}^e = \\frac{EA}{h} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}$. For a bar with $N+1$ nodes, $\\mathbf{K}_{bulk}$ is an $(N+1) \\times (N+1)$ matrix. For the assumed $E=A=1$:\n$$\n\\mathbf{K}_{bulk} = \\frac{1}{h}\n\\begin{pmatrix}\n1 & -1 & & & \\\\\n-1 & 2 & -1 & & \\\\\n& \\ddots & \\ddots & \\ddots & \\\\\n& & -1 & 2 & -1 \\\\\n& & & -1 & 1\n\\end{pmatrix}\n$$\nThis matrix corresponds to a bar with natural boundary conditions at both ends and is singular.\n\n### 1. Penalty Method\n\nThe penalty method approximates the Dirichlet condition by adding a penalty term to the weak form, which penalizes non-zero displacements at the boundary. The modified bilinear form is:\n$$ a_p(u,v) = \\int_0^1 E A u' v' \\,dx + \\beta u(0) v(0) $$\nThe penalty parameter $\\beta$ must be large. As specified, we choose a scaling consistent with the stiffness matrix entries: $\\beta = \\frac{\\gamma_p EA}{h}$, where $\\gamma_p$ is a dimensionless parameter.\nThe discrete form of the penalty term is $\\frac{\\gamma_p EA}{h} u_h(0) v_h(0) = \\frac{\\gamma_p EA}{h} u_0 v_0$. This term only affects the $(0,0)$ entry of the global stiffness matrix.\nThe final matrix for the penalty method, $\\mathbf{K}_{\\text{penalty}}$, is:\n$$ \\mathbf{K}_{\\text{penalty}} = \\mathbf{K}_{bulk} + \\mathbf{K}_{add} $$\nwhere $\\mathbf{K}_{add}$ is a matrix of zeros except for the entry $(\\mathbf{K}_{add})_{00} = \\frac{\\gamma_p EA}{h}$. With $E=A=1$:\n$$\n(\\mathbf{K}_{\\text{penalty}})_{00} = \\frac{1}{h} + \\frac{\\gamma_p}{h} = \\frac{1+\\gamma_p}{h}\n$$\n\n### 2. Nitsche’s Method\n\nNitsche's method enforces the boundary condition by adding terms that are consistent (vanish for the exact solution) and include a stabilization term to ensure coercivity. The bilinear form for the symmetric Nitsche method is:\n$$ a_N(u,v) = \\int_0^1 E A u'v' \\,dx - E A u'(0)v(0) - E A v'(0)u(0) + \\frac{\\alpha EA}{h} u(0)v(0) $$\nWe discretize the new terms. We have $u_h(0) = u_0$ and $v_h(0) = v_0$. The derivative at $x=0$ is evaluated from within the first element $(0,h)$, so $u'_h(0) = (u_1-u_0)/h$. Similarly, for a basis function test function $v_h$, $v'_h(0) = (v_1-v_0)/h$.\n-   $-E A u'_h(0)v_h(0)$: This term is $-EA \\frac{u_1-u_0}{h} v_0$. It contributes $+EA/h$ to the $(0,0)$ matrix entry and $-EA/h$ to the $(0,1)$ entry.\n-   $-E A v'_h(0)u_h(0)$: Symmetrically, this is $-EA \\frac{v_1-v_0}{h} u_0$. It contributes $+EA/h$ to the $(0,0)$ entry and $-EA/h$ to the $(1,0)$ entry.\n-   $+\\frac{\\alpha EA}{h} u_h(0)v_h(0)$: This contributes $\\alpha EA/h$ to the $(0,0)$ entry.\n\nSumming the contributions to $\\mathbf{K}_{bulk}$ (with $E=A=1$):\n-   $(\\mathbf{K}_N)_{00} = (\\mathbf{K}_{bulk})_{00} + \\frac{EA}{h} + \\frac{EA}{h} + \\frac{\\alpha EA}{h} = \\frac{EA}{h} + \\frac{(2+\\alpha)EA}{h} = \\frac{(3+\\alpha)EA}{h}$.\n-   $(\\mathbf{K}_N)_{01} = (\\mathbf{K}_{bulk})_{01} - \\frac{EA}{h} = -\\frac{EA}{h} - \\frac{EA}{h} = -\\frac{2EA}{h}$.\n-   $(\\mathbf{K}_N)_{10} = (\\mathbf{K}_{bulk})_{10} - \\frac{EA}{h} = -\\frac{EA}{h} - \\frac{EA}{h} = -\\frac{2EA}{h}$.\nThe resulting matrix $\\mathbf{K}_{\\text{nitsche}}$ is therefore $\\mathbf{K}_{bulk}$ modified at its top-left $2 \\times 2$ block.\n\n### 3. Lagrange Multiplier Method\n\nThis method introduces a Lagrange multiplier, $\\lambda_0$, to exactly enforce the constraint $u(0)=0$. This results in a mixed (saddle-point) system. The unknowns are the displacement vector $\\mathbf{u}$ and the multiplier $\\lambda_0$.\nThe system of equations is:\n$$ \\begin{pmatrix} \\mathbf{K}_{bulk} & \\mathbf{C}^T \\\\ \\mathbf{C} & \\mathbf{0} \\end{pmatrix} \\begin{pmatrix} \\mathbf{u} \\\\ \\lambda_0 \\end{pmatrix} = \\begin{pmatrix} \\mathbf{f} \\\\ 0 \\end{pmatrix} $$\nThe constraint is $u_h(0) = u_0 = 0$. Thus, the discrete constraint operator $\\mathbf{C}$ is the row vector $[1, 0, \\dots, 0]$.\nThe problem specifies a scaling parameter $s$ for the constraint operator. We apply this scaling symmetrically to the off-diagonal blocks, leading to the matrix:\n$$ \\mathbf{K}_{\\text{multiplier}} = \\begin{pmatrix} \\mathbf{K}_{bulk} & s\\mathbf{C}^T \\\\ s\\mathbf{C} & 0 \\end{pmatrix} $$\nThis is an $(N+2) \\times (N+2)$ symmetric, indefinite matrix. With $E=A=1$:\n$$\n\\mathbf{K}_{\\text{multiplier}} =\n\\begin{pmatrix}\n1/h & -1/h & \\dots & 0 & s \\\\\n-1/h & 2/h & \\dots & 0 & 0 \\\\\n\\vdots & & \\ddots & & \\vdots \\\\\n0 & \\dots & -1/h & 1/h & 0 \\\\\ns & 0 & \\dots & 0 & 0\n\\end{pmatrix}\n$$\nWe will now compute the two-norm condition number, $\\kappa_2(\\mathbf{M}) = \\sigma_{\\max}(\\mathbf{M})/\\sigma_{\\min}(\\mathbf{M})$, for each of these three matrices using the provided test cases.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import svdvals\n\ndef calculate_condition_numbers(N, gamma_p, alpha, s_param):\n    \"\"\"\n    Assembles the stiffness matrices for the Penalty, Nitsche, and Lagrange\n    Multiplier methods and computes their two-norm condition numbers.\n\n    Args:\n        N (int): Number of elements.\n        gamma_p (float): Penalty parameter.\n        alpha (float): Nitsche stabilization parameter.\n        s_param (float): Lagrange multiplier scaling parameter.\n\n    Returns:\n        list: A list of three floats containing the condition numbers for\n              the penalty, Nitsche, and Lagrange multiplier matrices.\n    \"\"\"\n    h = 1.0 / N\n    EA_h = 1.0 / h\n\n    # 1. Assemble K_bulk for a bar with N elements\n    dof = N + 1\n    K_bulk = np.zeros((dof, dof))\n    \n    diag0 = np.full(dof, 2.0 * EA_h)\n    diag0[0] = EA_h\n    diag0[-1] = EA_h\n    np.fill_diagonal(K_bulk, diag0)\n\n    diag1 = np.full(dof - 1, -EA_h)\n    K_bulk[range(dof - 1), range(1, dof)] = diag1\n    K_bulk[range(1, dof), range(dof - 1)] = diag1\n\n    # 2. Penalty method matrix\n    K_penalty = K_bulk.copy()\n    K_penalty[0, 0] += gamma_p * EA_h\n    \n    s_vals_p = svdvals(K_penalty)\n    cond_p = s_vals_p[0] / s_vals_p[-1] if not np.isclose(s_vals_p[-1], 0) else np.inf\n\n    # 3. Nitsche's method matrix (corrected formulation)\n    K_nitsche = K_bulk.copy()\n    if N > 0:\n        K_nitsche[0, 0] += (2.0 + alpha) * EA_h\n        K_nitsche[0, 1] -= EA_h\n        K_nitsche[1, 0] -= EA_h\n\n    s_vals_n = svdvals(K_nitsche)\n    cond_n = s_vals_n[0] / s_vals_n[-1] if not np.isclose(s_vals_n[-1], 0) else np.inf\n\n    # 4. Lagrange multiplier matrix\n    K_lm = np.zeros((dof + 1, dof + 1))\n    K_lm[:dof, :dof] = K_bulk\n    K_lm[0, dof] = s_param\n    K_lm[dof, 0] = s_param\n    \n    s_vals_lm = svdvals(K_lm)\n    cond_lm = s_vals_lm[0] / s_vals_lm[-1] if not np.isclose(s_vals_lm[-1], 0) else np.inf\n\n    return [cond_p, cond_n, cond_lm]\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (N, gamma_p, alpha, s)\n        (4, 100, 10, 1),\n        (1, 100, 10, 1),\n        (8, 1000000, 10, 1),\n        (8, 100, 0.000001, 100)\n    ]\n\n    all_results = []\n    for case in test_cases:\n        N, gamma_p, alpha, s = case\n        results = calculate_condition_numbers(N, gamma_p, alpha, s)\n        all_results.append(results)\n\n    # Final print statement in the exact required format.\n    output_str = \"[\" + \",\".join([f\"[{','.join(map(str, r))}]\" for r in all_results]) + \"]\"\n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "A key advantage of the Nitsche method is its effectiveness in contexts like unfitted finite element methods, where the computational mesh does not conform to the domain boundary. In such cases, a mismatch between the exact boundary normal $\\mathbf{n}$ and the discrete normal $\\mathbf{n}_{h}$ can introduce consistency errors that degrade accuracy. This advanced exercise challenges you to derive a boundary correction that restores the method's optimal convergence properties by ensuring adjoint consistency is maintained . This practice demonstrates how to preserve theoretical rigor and accuracy in the face of practical geometric approximations.",
            "id": "3584380",
            "problem": "Consider a two-dimensional small-strain linear elastic body occupying a bounded Lipschitz domain $\\Omega \\subset \\mathbb{R}^{2}$ with outward unit normal $\\mathbf{n}$ on its boundary $\\partial \\Omega$. Let the boundary be decomposed into a Dirichlet part $\\Gamma_{D}$ and a Neumann part $\\Gamma_{N}$, with $\\Gamma_{D} \\cup \\Gamma_{N} = \\partial \\Omega$ and $\\Gamma_{D} \\cap \\Gamma_{N} = \\emptyset$. The material is isotropic with Lamé parameters $\\lambda$ and $\\mu$, and the Cauchy stress is $\\boldsymbol{\\sigma}(\\mathbf{u}) = 2 \\mu \\boldsymbol{\\varepsilon}(\\mathbf{u}) + \\lambda \\, \\operatorname{tr}(\\boldsymbol{\\varepsilon}(\\mathbf{u})) \\mathbf{I}$, where $\\boldsymbol{\\varepsilon}(\\mathbf{u}) = \\frac{1}{2}(\\nabla \\mathbf{u} + \\nabla \\mathbf{u}^{T})$ is the infinitesimal strain tensor. The strong form of equilibrium is $-\\nabla \\cdot \\boldsymbol{\\sigma}(\\mathbf{u}) = \\mathbf{f}$ in $\\Omega$, with $\\mathbf{u} = \\mathbf{g}$ on $\\Gamma_{D}$ and $\\boldsymbol{\\sigma}(\\mathbf{u}) \\mathbf{n} = \\mathbf{t}$ on $\\Gamma_{N}$.\n\nA conforming finite element space is used for the displacement field $\\mathbf{u}_{h}$ and a symmetric Nitsche method weakly enforces $\\mathbf{u} = \\mathbf{g}$ on $\\Gamma_{D}$. The symmetric Nitsche bilinear form on $\\Gamma_{D}$ contains the consistency terms\n$$\n-\\int_{\\Gamma_{D}} (\\boldsymbol{\\sigma}(\\mathbf{u}_{h}) \\mathbf{n}) \\cdot \\mathbf{v}_{h} \\, \\mathrm{d}\\Gamma\n\\;-\\;\n\\int_{\\Gamma_{D}} (\\boldsymbol{\\sigma}(\\mathbf{v}_{h}) \\mathbf{n}) \\cdot \\mathbf{u}_{h} \\, \\mathrm{d}\\Gamma,\n$$\nand a penalty term $\\int_{\\Gamma_{D}} \\frac{\\gamma}{h} \\mathbf{u}_{h} \\cdot \\mathbf{v}_{h} \\, \\mathrm{d}\\Gamma$ with $\\gamma > 0$ and local mesh size $h$.\n\nSuppose the exact geometry is represented by a discrete boundary with outward unit normal $\\mathbf{n}_{h}$ on $\\Gamma_{D}$, which deviates from the exact normal $\\mathbf{n}$ by a constant angle $\\theta$ along a boundary segment, i.e., $\\mathbf{n} \\cdot \\mathbf{n}_{h} = \\cos \\theta$ and $|\\theta| \\ll 1$. It is known that replacing $\\mathbf{n}$ with $\\mathbf{n}_{h}$ in the Nitsche consistency terms deteriorates adjoint consistency and can reduce the convergence rate.\n\nPropose a boundary correction that acts linearly on the discrete normal to restore adjoint consistency of the Nitsche consistency terms while retaining the symmetric structure. Specifically, consider a corrected consistency term that uses the operator $C(\\theta)$ acting on $\\mathbf{n}_{h}$ via the projection onto the exact normal direction, $P_{\\mathbf{n}} := \\mathbf{n} \\mathbf{n}^{T}$, and a scalar factor $\\alpha(\\theta)$:\n$$\n-\\int_{\\Gamma_{D}} \\big(\\boldsymbol{\\sigma}(\\mathbf{u}_{h}) \\, \\alpha(\\theta) \\, P_{\\mathbf{n}} \\mathbf{n}_{h}\\big) \\cdot \\mathbf{v}_{h} \\, \\mathrm{d}\\Gamma\n\\;-\\;\n\\int_{\\Gamma_{D}} \\big(\\boldsymbol{\\sigma}(\\mathbf{v}_{h}) \\, \\alpha(\\theta) \\, P_{\\mathbf{n}} \\mathbf{n}_{h}\\big) \\cdot \\mathbf{u}_{h} \\, \\mathrm{d}\\Gamma.\n$$\n\nStarting from the fundamental weak form obtained by integration by parts and the definitions above, derive the requirement for adjoint consistency of these corrected terms and determine a closed-form expression for the scalar correction factor $\\alpha(\\theta)$ such that the corrected consistency terms are exactly equal to the ones built with the exact normal $\\mathbf{n}$. Analyze how this correction affects the Nitsche consistency terms and explain, in terms of the operator $P_{\\mathbf{n}}$ and the angle $\\theta$, why the optimal convergence rate is restored.\n\nYour final answer should be the single analytic expression for $\\alpha(\\theta)$ with no units. If you use an approximation, you must present the exact closed-form expression as the final answer. No numerical rounding is required.",
            "solution": "The problem requires the derivation of a scalar correction factor $\\alpha(\\theta)$ for the consistency terms in a symmetric Nitsche formulation. This correction is intended to compensate for the geometric error introduced by using a discrete boundary normal $\\mathbf{n}_h$ instead of the exact normal $\\mathbf{n}$, where the two normals are related by a constant angle $\\theta$ such that $\\mathbf{n} \\cdot \\mathbf{n}_h = \\cos \\theta$. The goal is to restore the exact form of the consistency terms, which is a prerequisite for ensuring adjoint consistency and optimal convergence rates of the finite element method.\n\nThe standard weak enforcement of the Dirichlet boundary condition $\\mathbf{u} = \\mathbf{g}$ on $\\Gamma_D$ using the symmetric Nitsche method involves the bilinear form contribution from $\\Gamma_D$:\n$$\nb_{\\Gamma_D}(\\mathbf{u}_h, \\mathbf{v}_h) = -\\int_{\\Gamma_{D}} (\\boldsymbol{\\sigma}(\\mathbf{u}_{h}) \\mathbf{n}) \\cdot \\mathbf{v}_{h} \\, \\mathrm{d}\\Gamma - \\int_{\\Gamma_{D}} (\\boldsymbol{\\sigma}(\\mathbf{v}_{h}) \\mathbf{n}) \\cdot \\mathbf{u}_{h} \\, \\mathrm{d}\\Gamma + \\int_{\\Gamma_{D}} \\frac{\\gamma}{h} \\mathbf{u}_{h} \\cdot \\mathbf{v}_{h} \\, \\mathrm{d}\\Gamma.\n$$\nThe first two terms are the consistency terms, and the third is the penalty term.\n\nThe problem arises when the exact domain is approximated by a discrete one, where the outward unit normal on $\\Gamma_D$ is $\\mathbf{n}_h$ instead of $\\mathbf{n}$. Using $\\mathbf{n}_h$ directly in the consistency terms leads to a loss of consistency. The proposed correction modifies the consistency terms as follows:\n$$\nb_{\\Gamma_D}^{\\text{corr}}(\\mathbf{u}_h, \\mathbf{v}_h) = -\\int_{\\Gamma_{D}} \\big(\\boldsymbol{\\sigma}(\\mathbf{u}_{h}) \\, \\alpha(\\theta) \\, P_{\\mathbf{n}} \\mathbf{n}_{h}\\big) \\cdot \\mathbf{v}_{h} \\, \\mathrm{d}\\Gamma - \\int_{\\Gamma_{D}} \\big(\\boldsymbol{\\sigma}(\\mathbf{v}_{h}) \\, \\alpha(\\theta) \\, P_{\\mathbf{n}} \\mathbf{n}_{h}\\big) \\cdot \\mathbf{u}_{h} \\, \\mathrm{d}\\Gamma.\n$$\nThe penalty term is unaffected. The condition for restoring the ideal formulation is that these corrected consistency terms must be identical to the original ones for any admissible pair of discrete fields $\\mathbf{u}_h$ and $\\mathbf{v}_h$ from the finite element space.\n\nDue to the symmetric structure of the terms, we only need to enforce the equality for one of them. Let us demand that for any $\\mathbf{u}_h$ and $\\mathbf{v}_h$:\n$$\n\\int_{\\Gamma_{D}} (\\boldsymbol{\\sigma}(\\mathbf{u}_{h}) \\mathbf{n}) \\cdot \\mathbf{v}_{h} \\, \\mathrm{d}\\Gamma = \\int_{\\Gamma_{D}} \\big(\\boldsymbol{\\sigma}(\\mathbf{u}_{h}) \\, \\alpha(\\theta) \\, P_{\\mathbf{n}} \\mathbf{n}_{h}\\big) \\cdot \\mathbf{v}_{h} \\, \\mathrm{d}\\Gamma.\n$$\nSince this equality must hold for any choice of test function $\\mathbf{v}_h$ in the finite element space, the vector terms inside the integral must be equal almost everywhere on $\\Gamma_D$. This gives the condition:\n$$\n\\boldsymbol{\\sigma}(\\mathbf{u}_h) \\mathbf{n} = \\boldsymbol{\\sigma}(\\mathbf{u}_h) \\big( \\alpha(\\theta) \\, P_{\\mathbf{n}} \\mathbf{n}_{h} \\big).\n$$\nHere, $\\boldsymbol{\\sigma}(\\mathbf{u}_h)$ is the Cauchy stress tensor, a symmetric second-order tensor, acting on a vector. The space of possible stress tensors arising from kinematically admissible displacement fields is sufficiently rich (it spans the space of symmetric $2 \\times 2$ matrices). Therefore, for the equality $\\boldsymbol{\\sigma} \\mathbf{a} = \\boldsymbol{\\sigma} \\mathbf{b}$ to hold for all admissible $\\boldsymbol{\\sigma}$, it is necessary that the vectors are equal, i.e., $\\mathbf{a} = \\mathbf{b}$. Applying this principle to our equation yields the core requirement for the corrected normal vector:\n$$\n\\mathbf{n} = \\alpha(\\theta) \\, P_{\\mathbf{n}} \\mathbf{n}_{h}.\n$$\nThis equation directly relates the exact normal $\\mathbf{n}$ to the corrected discrete normal. We can now solve for the scalar factor $\\alpha(\\theta)$.\n\nThe problem defines the projection operator $P_{\\mathbf{n}}$ as $P_{\\mathbf{n}} := \\mathbf{n} \\mathbf{n}^{T}$. Its action on the discrete normal vector $\\mathbf{n}_h$ is:\n$$\nP_{\\mathbf{n}} \\mathbf{n}_{h} = (\\mathbf{n} \\mathbf{n}^{T}) \\mathbf{n}_{h} = \\mathbf{n} (\\mathbf{n}^{T} \\mathbf{n}_{h}) = \\mathbf{n} (\\mathbf{n} \\cdot \\mathbf{n}_{h}).\n$$\nWe are given that the angle between the exact and discrete normals is $\\theta$, so $\\mathbf{n} \\cdot \\mathbf{n}_h = \\cos \\theta$. Substituting this into the expression for $P_{\\mathbf{n}} \\mathbf{n}_{h}$ gives:\n$$\nP_{\\mathbf{n}} \\mathbf{n}_{h} = \\mathbf{n} \\cos \\theta.\n$$\nNow, we substitute this result back into our core requirement equation:\n$$\n\\mathbf{n} = \\alpha(\\theta) \\, (\\mathbf{n} \\cos \\theta).\n$$\nThis can be rewritten as:\n$$\n\\mathbf{n} = (\\alpha(\\theta) \\cos \\theta) \\mathbf{n}.\n$$\nSince $\\mathbf{n}$ is a unit vector, it is non-zero, so we can equate the scalar coefficients on both sides of the equation:\n$$\n1 = \\alpha(\\theta) \\cos \\theta.\n$$\nSolving for $\\alpha(\\theta)$ yields the desired closed-form expression:\n$$\n\\alpha(\\theta) = \\frac{1}{\\cos \\theta}.\n$$\nThis is the expression for the correction factor that makes the corrected consistency terms exactly equal to the ideal ones.\n\nTo understand why this restores the optimal convergence rate, we must analyze the effect of the correction. The use of an incorrect normal $\\mathbf{n}_h$ instead of $\\mathbf{n}$ introduces a consistency error. The consistency of the Nitsche formulation relies on the exact cancellation of the boundary traction term $\\int_{\\Gamma_D} (\\boldsymbol{\\sigma}(\\mathbf{u})\\mathbf{n}) \\cdot \\mathbf{v}_h \\, \\mathrm{d}\\Gamma$, which arises from integration by parts of the bulk term, with the corresponding term in the Nitsche formulation. If $\\mathbf{n}_h$ is used, a residual term $\\int_{\\Gamma_D} (\\boldsymbol{\\sigma}(\\mathbf{u}) (\\mathbf{n} - \\mathbf{n}_h)) \\cdot \\mathbf{v}_h \\, \\mathrm{d}\\Gamma$ remains. This variational crime pollutes the formulation and leads to a degradation of the convergence order. Adjoint consistency, which is crucial for optimal convergence of functionals of the solution, is also lost because the method is no longer consistent for the primal problem.\n\nThe proposed correction operates in two steps:\n$1$. The projection $P_{\\mathbf{n}}$ acts on $\\mathbf{n}_h$ to produce $P_{\\mathbf{n}} \\mathbf{n}_h = (\\cos\\theta)\\mathbf{n}$. This operation geometrically isolates the component of the discrete normal $\\mathbf{n}_h$ that lies in the direction of the true normal $\\mathbf{n}$ and eliminates the erroneous component tangential to the true boundary.\n$2$. The resulting vector $(\\cos\\theta)\\mathbf{n}$ has the correct direction but an incorrect magnitude of $\\cos\\theta$ (since $|\\theta| \\ll 1$, $\\cos\\theta < 1$). The scalar factor $\\alpha(\\theta) = 1/\\cos\\theta$ rescales this vector, restoring its magnitude to $1$.\n\nThe combined operation, $\\alpha(\\theta) P_{\\mathbf{n}} \\mathbf{n}_h$, therefore, exactly reconstructs the true normal vector $\\mathbf{n}$. By substituting this corrected vector into the Nitsche consistency terms, we make them mathematically identical to the ideal terms that use $\\mathbf{n}$. This completely eliminates the consistency error caused by the geometric approximation of the normal. By restoring consistency to the symmetric formulation, adjoint consistency is also restored, and standard error estimates guarantee that the optimal convergence rate is achieved, as if the exact geometry were used.",
            "answer": "$$\n\\boxed{\\frac{1}{\\cos(\\theta)}}\n$$"
        }
    ]
}