{
    "hands_on_practices": [
        {
            "introduction": "边界元方法的核心思想在于将体问题转化为边界问题。要做到这一点，首先必须牢固掌握定义在边界上的物理量，即面力（traction）和位移。本练习  将引导您根据给定的应力场计算面力矢量，并理解其与边界功的联系，这一概念构成了您将遇到的积分方程的能量基础。",
            "id": "3547823",
            "problem": "考虑一个三维弹性体，它占据了以原点为中心、半径为 $a$ 的实心球体，其光滑边界为 $\\Gamma = \\{ \\mathbf{x} \\in \\mathbb{R}^{3} : |\\mathbf{x}| = a \\}$。整个物体内的 Cauchy 应力场被规定为 $\\sigma_{ij}(\\mathbf{x}) = p_{0}\\,\\delta_{ij} + q_{0}\\,\\dfrac{x_{i} x_{j}}{a^{2}}$，其中 $p_{0}$ 和 $q_{0}$ 是常数，$\\delta_{ij}$ 是克罗内克δ函数，$x_{i}$ 是笛卡尔坐标。在 $\\Gamma$ 上的单位外法线为 $n_{i}(\\mathbf{x}) = \\dfrac{x_{i}}{a}$，且边界位移场是径向均匀的，对于 $\\mathbf{x} \\in \\Gamma$ 有 $u_{i}(\\mathbf{x}) = U_{0}\\,n_{i}(\\mathbf{x})$。\n\n从局部（微分）层面上的 Cauchy 应力原理和线性动量平衡出发，推导从应力张量到定向曲面上牵引矢量的线性映射，并确定 $\\Gamma$ 上的牵引矢量。然后，利用弹性力学中作为边界积分公式基础的、边界面力与边界位移之间的标准外部虚功配对，计算标量边界功泛函\n$$\nW \\;=\\; \\int_{\\Gamma} u_{i}(\\mathbf{x})\\, t_{i}(\\mathbf{x}) \\, \\mathrm{d}\\Gamma,\n$$\n其中 $t_{i}(\\mathbf{x})$ 表示作用于物体上、穿过边界 $\\Gamma$ 的边界面力矢量。使用数值数据 $a = 0.5\\,\\mathrm{m}$，$p_{0} = 2.0 \\times 10^{6}\\,\\mathrm{N/m^{2}}$，$q_{0} = 1.0 \\times 10^{6}\\,\\mathrm{N/m^{2}}$ 以及 $U_{0} = 5.0 \\times 10^{-3}\\,\\mathrm{m}$。\n\n解释单位外法线和牵引矢量的符号约定如何与边界位移在功共轭意义上相关，即对于边界速度 $v_{i}$，外部功率输入为 $\\int_{\\Gamma} t_{i} v_{i} \\,\\mathrm{d}\\Gamma$。最后，根据给定数据计算 $W$。将 $W$ 的最终值以牛顿·米为单位表示；无需四舍五入。最终答案必须是单个实数或单个闭式解析表达式。",
            "solution": "该问题被验证为是自洽的、有科学依据的，并且对于所要求的特定任务是适定的。给定的应力场 $\\sigma_{ij}(\\mathbf{x})$ 在没有体力的情况下不满足平衡方程 $\\sigma_{ij,j} = 0$（因为 $\\sigma_{ij,j} = 4q_0 x_i / a^2$），这一事实并不妨碍边界面力和后续功积分的计算，因为这些操作仅取决于场在边界上的值，而与内部的场方程无关。我们继续进行计算，假设问题陈述是要求使用给定场进行这些计算的指令。\n\n首先，我们推导从应力张量到牵引矢量的线性映射，这被称为 Cauchy 公式。对于具有边界 $\\partial V$ 的任意控制体 $V$，线性动量平衡表明，动量的变化率等于面力与体力的总和。在积分形式下，对于静态情况或惯性效应在极限情况下可忽略不计的情况，该平衡为 $\\int_{\\partial V} t_i \\, \\mathrm{d}\\Gamma + \\int_V b_i \\, \\mathrm{d}V = \\mathbf{0}$，其中 $t_i$ 是作用于 $\\partial V$ 上的牵引矢量，$b_i$ 是单位体积的体力。在曲面某点 $\\mathbf{x}$ 处的牵引力 $\\mathbf{t}$ 取决于该曲面的方向，该方向由其单位法向量 $\\mathbf{n}$ 给出。此关系表示为 $\\mathbf{t} = \\mathbf{t}(\\mathbf{x}, \\mathbf{n})$。通过考虑一个无穷小四面体的平衡，其三个面平行于笛卡尔坐标平面，另一个面具有任意法线 $\\mathbf{n}$，我们可以将斜面上的牵引力 $\\mathbf{t}^{(\\mathbf{n})}$ 与坐标平面上的牵引力联系起来。在四面体尺寸缩小到零的极限情况下，与体积相关的项（如体力）比与面积相关的项消失得更快。这导出了基本结果：\n$$\nt_i = \\sigma_{ij} n_j\n$$\n其中 $\\sigma_{ij}$ 是 Cauchy 应力张量，其第 $j$ 列表示作用在法线沿 $x_j$ 轴的表面上的牵引矢量。这就是所要求的线性映射。\n\n接下来，我们确定实心球体边界 $\\Gamma$ 上的牵引矢量 $t_i(\\mathbf{x})$。给定的应力场为：\n$$\n\\sigma_{ij}(\\mathbf{x}) = p_{0}\\,\\delta_{ij} + q_{0}\\,\\dfrac{x_{i} x_{j}}{a^{2}}\n$$\n在球面 $\\Gamma$ 上（其中 $|\\mathbf{x}| = a$），单位外法向量为：\n$$\nn_{j}(\\mathbf{x}) = \\dfrac{x_{j}}{a}\n$$\n应用 Cauchy 公式，我们计算牵引矢量 $t_i$ 的分量：\n$$\nt_i = \\sigma_{ij} n_j = \\left( p_{0}\\,\\delta_{ij} + q_{0}\\,\\dfrac{x_{i} x_{j}}{a^{2}} \\right) \\left( \\dfrac{x_{j}}{a} \\right)\n$$\n我们将乘法分配开：\n$$\nt_i = p_{0}\\,\\delta_{ij} \\dfrac{x_j}{a} + q_{0}\\,\\dfrac{x_{i} x_{j}}{a^{2}} \\dfrac{x_j}{a}\n$$\n利用克罗内克δ函数的性质 $\\delta_{ij} x_j = x_i$。第一项变为：\n$$\np_{0}\\,\\dfrac{x_i}{a} = p_0 n_i\n$$\n对于第二项，我们有乘积 $x_j x_j = x_1^2 + x_2^2 + x_3^2 = |\\mathbf{x}|^2$。因为我们在边界 $\\Gamma$ 上，所以 $|\\mathbf{x}|^2 = a^2$。第二项为：\n$$\nq_{0}\\,\\dfrac{x_{i}}{a^3} (x_j x_j) = q_{0}\\,\\dfrac{x_{i}}{a^3} a^2 = q_{0}\\,\\dfrac{x_i}{a} = q_0 n_i\n$$\n合并两项，边界上的牵引矢量为：\n$$\nt_i(\\mathbf{x}) = p_0 n_i(\\mathbf{x}) + q_0 n_i(\\mathbf{x}) = (p_0 + q_0) n_i(\\mathbf{x})\n$$\n\n问题要求解释符号约定。对物体所做的外功是外力与力作用点位移的点积的积分。牵引矢量 $t_i$ 表示*周围环境通过边界 $\\Gamma$ 作用在物体上*的单位面积力。边界的位移是 $u_i$。作用在面元 $\\mathrm{d}\\Gamma$ 上的微元力是 $t_i \\mathrm{d}\\Gamma$。该力所做的功是 $(t_i \\mathrm{d}\\Gamma) u_i$。对边界进行积分，得到总外功 $W = \\int_{\\Gamma} t_i u_i \\, \\mathrm{d}\\Gamma$。类似地，功率输入（功的速率）由 $P = \\int_{\\Gamma} t_i v_i \\, \\mathrm{d}\\Gamma$ 给出，其中 $v_i = \\dot{u}_i$ 是边界速度。这个框架定义了牵引力 $t_i$ 和位移/速度 $u_i/v_i$ 之间的一个功共轭配对。使用*外*法线 $\\mathbf{n}$ 是一个约定，通过 Cauchy 公式 $t_i = \\sigma_{ij}n_j$，它将 $\\mathbf{t}$ 定义为从外部作用于物体上的力。因此，功率积分 $\\int t_i v_i \\mathrm{d}\\Gamma$ 的正值明确地对应于能量从周围环境流入物体。\n\n现在，我们计算标量边界功泛函 $W$：\n$$\nW = \\int_{\\Gamma} u_{i}(\\mathbf{x})\\, t_{i}(\\mathbf{x}) \\, \\mathrm{d}\\Gamma\n$$\n边界位移给定为 $u_{i}(\\mathbf{x}) = U_{0}\\,n_{i}(\\mathbf{x})$。将被积函数中的 $u_i$ 和 $t_i$ 替换为其表达式：\n$$\nu_i t_i = \\left( U_0 n_i \\right) \\left( (p_0 + q_0) n_i \\right) = U_0 (p_0 + q_0) (n_i n_i)\n$$\n由于 $\\mathbf{n}$ 是一个单位矢量，其标量积 $n_i n_i = |\\mathbf{n}|^2 = 1$。因此，被积函数在整个边界 $\\Gamma$ 上是常数：\n$$\nu_i t_i = U_0 (p_0 + q_0)\n$$\n功泛函变为：\n$$\nW = \\int_{\\Gamma} U_0 (p_0 + q_0) \\, \\mathrm{d}\\Gamma = U_0 (p_0 + q_0) \\int_{\\Gamma} \\mathrm{d}\\Gamma\n$$\n积分 $\\int_{\\Gamma} \\mathrm{d}\\Gamma$ 是半径为 $a$ 的球体的表面积，即 $4 \\pi a^2$。因此，功的解析表达式为：\n$$\nW = 4 \\pi a^2 U_0 (p_0 + q_0)\n$$\n最后，我们代入给定的数值：$a = 0.5\\,\\mathrm{m}$，$p_{0} = 2.0 \\times 10^{6}\\,\\mathrm{N/m^{2}}$，$q_{0} = 1.0 \\times 10^{6}\\,\\mathrm{N/m^{2}}$ 以及 $U_{0} = 5.0 \\times 10^{-3}\\,\\mathrm{m}$。\n$$\np_0 + q_0 = (2.0 \\times 10^6 + 1.0 \\times 10^6)\\,\\mathrm{N/m^2} = 3.0 \\times 10^6\\,\\mathrm{N/m^2}\n$$\n$$\na^2 = (0.5\\,\\mathrm{m})^2 = 0.25\\,\\mathrm{m^2}\n$$\n将这些值代入 $W$ 的表达式中：\n$$\nW = 4 \\pi (0.25\\,\\mathrm{m^2}) (5.0 \\times 10^{-3}\\,\\mathrm{m}) (3.0 \\times 10^6\\,\\mathrm{N/m^2})\n$$\n$$\nW = \\pi (1.0\\,\\mathrm{m^2}) (5.0 \\times 10^{-3}\\,\\mathrm{m}) (3.0 \\times 10^6\\,\\mathrm{N/m^2})\n$$\n$$\nW = \\pi (15.0 \\times 10^3)\\,\\mathrm{N \\cdot m}\n$$\n$$\nW = 15000 \\pi \\,\\mathrm{N \\cdot m}\n$$\n结果以牛顿·米为单位，符合要求。",
            "answer": "$$\n\\boxed{15000\\pi}\n$$"
        },
        {
            "introduction": "建立边界积分方程（BIE）的关键一步是将观察点从区域内部移动到边界本身。这个极限过程并非一蹴而就，尤其是在像角点这样的几何不连续处，它会产生独特的“自由项”系数。本练习  深入探讨了这一关键方面，要求您推导凹角处的自由项，并思考其对数值离散化的影响。",
            "id": "3547859",
            "problem": "考虑一个占据有界域 $\\Omega \\subset \\mathbb{R}^{2}$ 且边界 $\\Gamma$ 为分段光滑的均匀、各向同性、线弹性体，对其进行二维弹性静力学边界元分析。设材料在平面应变或平面应力状态下的剪切模量为 $\\mu$，泊松比为 $\\nu$；并假设所需的基本解存在。由 Somigliana 恒等式推导出的位移边界积分方程 (BIE)，涉及奇异边界积分的柯西主值 (CPV) 以及边界配置点上的几何自由项系数。\n\n在一个边界配置点 $P \\in \\Gamma$ 处，该点是一个内角 $\\theta$ 满足 $\\theta > \\pi$ 的凹角，其局部边界由在 $P$ 点相交的两条直线段 $\\Gamma_{1}$ 和 $\\Gamma_{2}$ 形成，它们的张角分别为 $\\alpha_{1}$ 和 $\\alpha_{2}$，满足 $\\alpha_{1} + \\alpha_{2} = \\theta$。对于一种节点配置的边界元法 (BEM) 离散，该方法为角节点分配一个单值位移 $u_{i}(P)$，但通过相邻单元的形函数将其表示为来自 $\\Gamma_{1}$ 的 $u_{i}^{(1)}(P)$ 和来自 $\\Gamma_{2}$ 的 $u_{i}^{(2)}(P)$。为了在 $P$ 点对 BIE 取极限的过程中一致地定义 $u_{i}(P)$，需要一种平均策略。\n\n从经典的 Somigliana 位移恒等式出发，利用面力定义 $t_{i}(Q) = \\sigma_{ij}(Q) n_{j}(Q)$，以及各向同性线弹性中的应力-应变关系 $\\sigma_{ij} = \\lambda \\delta_{ij} \\varepsilon_{kk} + 2 \\mu \\varepsilon_{ij}$ 和 $\\varepsilon_{ij} = \\frac{1}{2} \\left( \\frac{\\partial u_{i}}{\\partial x_{j}} + \\frac{\\partial u_{j}}{\\partial x_{i}} \\right)$（其中 $\\lambda$ 是第一拉梅常数），并结合 Kelvin 基本解及其相关面力核函数的存在性和性质，推导在内角为 $\\theta$ 的凹角处位移 BIE 中出现的几何自由项系数 $c(P)$，并基于局部分割 $(\\alpha_{1}, \\alpha_{2})$ 确定一个与角度一致的 $u_{i}(P)$ 平均策略。\n\n明确计算：\n- 自由项系数 $c(P)$，作为 $\\theta$ 的函数。\n- 平均权重 $w_{1}$ 和 $w_{2}$，使得 $u_{i}(P) = w_{1} \\, u_{i}^{(1)}(P) + w_{2} \\, u_{i}^{(2)}(P)$，且与局部的角度分割一致，满足 $w_{1} + w_{2} = 1$。\n\n角度必须以弧度处理。将您的最终结果表示为一个单行矩阵，按顺序包含三个条目 $\\left( c(P), w_{1}, w_{2} \\right)$。提供精确表达式；不要四舍五入。简要解释这些量如何影响从边界配置获得的局部方程组。\n\n您的最终答案必须是闭合形式的计算结果，并且必须按上述规定表示为单行矩阵，所有角度均以弧度为单位，最终答案内不包含任何单位。",
            "solution": "该问题要求在二维弹性静力学边界元分析中，推导凹角的自由项系数 $c(P)$ 和平均权重 $(w_1, w_2)$。\n\n我们从规定的基本原理开始。弹性静力学的控制微分方程是 Navier 方程。其积分表示形式是针对内点 $p \\in \\Omega$ 的位移 $u_i$ 的 Somigliana 恒等式：\n$$u_i(p) = \\int_{\\Gamma} U_{ij}(p,Q) t_j(Q) \\, d\\Gamma(Q) - \\int_{\\Gamma} T_{ij}(p,Q) u_j(Q) \\, d\\Gamma(Q)$$\n此处，$Q \\in \\Gamma$ 是边界上的一个场点，$t_j(Q)$ 是 $Q$ 点的面力矢量，$U_{ij}(p,Q)$ 是 Kelvin 位移基本解（由于在 $p$ 点沿 $i$ 方向施加单位点力而在 $Q$ 点沿 $j$ 方向产生的位移），而 $T_{ij}(p,Q)$ 是相关的面力基本解。面力 $t_j$ 通过柯西公式与应力张量 $\\sigma_{jk}$ 相关联，$t_j = \\sigma_{jk} n_k$，其中 $n_k$ 是边界 $\\Gamma$ 的外法向单位矢量。\n\n为了获得边界积分方程 (BIE)，我们将源点 $p$ 趋近于边界上的点 $P$，即 $p \\to P$。涉及核函数 $U_{ij}$ 的积分是弱奇异的，极限可以移到积分号内部。涉及核函数 $T_{ij}$ 的积分是强奇异的，其极限必须谨慎计算，这会产生一个自由项和一个柯西主值 (CPV) 积分。对于配置点 $P \\in \\Gamma$ 得到的 BIE 为：\n$$c_{ij}(P) u_j(P) + \\oint_{\\Gamma} T_{ij}(P,Q) u_j(Q) \\, d\\Gamma(Q) = \\int_{\\Gamma} U_{ij}(P,Q) t_j(Q) \\, d\\Gamma(Q)$$\n其中 $\\oint$ 表示积分的柯西主值。\n\n**第一部分：自由项系数 $c(P)$ 的推导**\n\n自由项系数张量 $c_{ij}(P)$ 源于当点 $p$ 穿过边界时奇异积分 $\\int_{\\Gamma} T_{ij}(p,Q) u_j(Q) d\\Gamma$ 值的跳跃。对于一个常位移场 $u_j(Q) = \\delta_{jk}$（刚体平移），面力 $t_j$ 处处为零。对于内点 $p \\in \\Omega$，Somigliana 恒等式简化为：\n$$\\delta_{ik} + \\int_{\\Gamma} T_{ij}(p,Q) \\delta_{jk} \\, d\\Gamma(Q) = 0 \\quad \\implies \\quad \\int_{\\Gamma} T_{ik}(p,Q) \\, d\\Gamma(Q) = -\\delta_{ik}$$\n对于域外的一点 $p$，该积分为零。对于边界点 $P$，积分的值取决于局部几何形状。自由项系数 $c_{ij}(P)$ 与此几何形状直接相关。它可以通过用一个以 $P$ 为中心、半径为 $\\epsilon$、位于域 $\\Omega$ 内的小圆弧 $\\Gamma_{\\epsilon}$ 来隔离奇异点 $P$，然后取极限 $\\epsilon \\to 0$ 来计算。此圆弧所对的角是角的内角 $\\theta$。\n\n该系数由下式给出：\n$$c_{ij}(P) = \\lim_{\\epsilon \\to 0} \\int_{\\Gamma_{\\epsilon}} T_{ij}(P,Q) \\, d\\Gamma(Q)$$\n对于二维各向同性弹性静力学，直接对这个积分在一个角度为 $\\theta$ 的圆弧上求值表明，得到的矩阵 $c_{ij}(P)$ 通常不是单位矩阵的标量倍数，即 $c_{ij}(P) \\neq c(P) \\delta_{ij}$，因为它依赖于角点相对于坐标系的朝向。\n\n然而，问题要求的是一个单一的标量系数 $c(P)$。这是 BEM 文献中的一个常见简化，其中强调了自由项的几何性质。该标量系数被解释为域 $\\Omega$ 在点 $P$ 处所占的“立体角”的分数。在二维中，全角为 $2\\pi$ 弧度。对于一个内角为 $\\theta$ 的角点，域内所占角度的分数为 $\\frac{\\theta}{2\\pi}$。该值对应于完整张量系数对角项的平均值，即 $\\frac{1}{2} \\text{Tr}[c_{ij}(P)]$。它也是势问题（由拉普拉斯方程控制）的精确自由项系数。采用这种标准的、物理上直观的简化，我们有：\n$$c(P) = \\frac{\\theta}{2\\pi}$$\n对于光滑边界，$\\theta = \\pi$，这正确地给出了 $c(P) = \\frac{1}{2}$。对于指定的凹角，$\\theta > \\pi$。\n\n**第二部分：平均权重 $w_1$ 和 $w_2$ 的推导**\n\n问题描述了在角节点 $P$ 处的一种数值策略，其中单值位移 $u_i(P)$ 是通过对来自段 $\\Gamma_1$ 和 $\\Gamma_2$ 上相邻单元的值进行平均来定义的。平均法则如下：\n$$u_i(P) = w_1 u_i^{(1)}(P) + w_2 u_i^{(2)}(P)$$\n并有约束条件 $w_1 + w_2 = 1$。值 $u_i^{(1)}(P)$ 和 $u_i^{(2)}(P)$ 分别是从位于 $\\Gamma_1$ 和 $\\Gamma_2$ 上的单元角度看的 $P$ 点位移的表示。\n\n我们被要求找到一个“与角度一致的”平均策略，该策略基于将总内角 $\\theta$ 局部分割为两个子角 $\\alpha_1$ 和 $\\alpha_2$，使得 $\\alpha_1 + \\alpha_2 = \\theta$。“两条直线段的……张角”这一措辞被解释为总角 $\\theta$ 被分割为 $\\alpha_1$ 和 $\\alpha_2$，它们与每个线段/单元边的影响或贡献相关联。\n\n对“与角度一致的”平均的一个合理且一致的解释是，将权重定义为与分割中各角的大小成正比。我们设：\n$$w_1 = k \\alpha_1 \\quad \\text{和} \\quad w_2 = k \\alpha_2$$\n其中 $k$ 是一个比例常数。使用约束条件 $w_1 + w_2 = 1$：\n$$k \\alpha_1 + k \\alpha_2 = 1 \\implies k(\\alpha_1 + \\alpha_2) = 1$$\n因为 $\\alpha_1 + \\alpha_2 = \\theta$，我们有 $k\\theta = 1$，这给出 $k = \\frac{1}{\\theta}$。\n将此代回，我们得到权重的表达式：\n$$w_1 = \\frac{\\alpha_1}{\\theta}$$\n$$w_2 = \\frac{\\alpha_2}{\\theta}$$\n这个选择确保了每个“边”对平均位移的贡献与其在角点分割中各自的角度成正比。\n\n**对局部方程组的影响**\n\n在离散化的 BEM 方程组 $[H]\\{u\\} = [G]\\{t\\}$ 中，自由项系数 $c(P)$ 贡献于 $[H]$ 矩阵中对应于节点 $P$ 自由度的对角块。其值反映了角点的几何形状，对于系统矩阵的对角占优性和整体稳定性至关重要。\n\n平均权重 $(w_1, w_2)$ 定义了节点位移自由度之间的一个约束。在可能存在不同位移值 $u_i^{(1)}$ 和 $u_i^{(2)}$ 的多节点格式中，这个平均方程用于强制位移连续性并减少未知数的数量，从而将在角点相交的单元所关联的方程耦合起来。\n\n综合结果，所求的量为：\n$c(P) = \\frac{\\theta}{2\\pi}$\n$w_1 = \\frac{\\alpha_1}{\\theta}$\n$w_2 = \\frac{\\alpha_2}{\\theta}$\n这些按要求以单行矩阵形式呈现。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{\\theta}{2\\pi} & \\frac{\\alpha_1}{\\theta} & \\frac{\\alpha_2}{\\theta}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "边界元法的威力在于其积分表述，但这也带来了其最大的计算障碍：奇异积分的求值。标准数值求积方法对这些核函数会失效，因此需要专门的技术。在这个动手编程练习  中，您将实现并比较两种经典策略——极坐标映射和Duffy变换——以精确计算奇异积分，从而深入了解BEM代码的“引擎室”。",
            "id": "3547872",
            "problem": "考虑一个平面内的单个平面三角形边界元，它代表了用于线性弹性静力学的边界元法 (BEM) 中的一个局部面板。设三角形的顶点为 $\\mathbf{v}_1=(0,0)$、$\\mathbf{v}_2=(1,0.2)$ 和 $\\mathbf{v}_3=(0.1,0.9)$，且设 $\\mathbf{x}_0$ 为三角形内的一个点。定义一个光滑测试函数 $\\varphi(\\mathbf{x})=1+\\alpha x+\\beta y$，其中 $\\alpha=0.3$，$β=0.2$，且 $\\mathbf{x}=(x,y)$ 是面板上的一个点。在弹性静力学边界积分中会出现两种典型的核函数类型：\n- 一种二维弹性力学中的弱奇异核，其形式为 $K_{\\mathrm{w}}(r)=\\log r$，其中 $r=\\|\\mathbf{x}-\\mathbf{x}_0\\|$。\n- 一种三维弹性力学中出现在超奇异公式里的强奇异核，其局部行为为 $K_{\\mathrm{s}}(r)=1/r^2$。\n\n为了使数值积分在科学上和计算上是适定的，引入一个小的正则化参数 $\\varepsilon>0$ 并定义正则化核函数\n$$\nK_{\\mathrm{w},\\varepsilon}(r)=\\log\\big(\\sqrt{r^2+\\varepsilon^2}\\big),\\qquad K_{\\mathrm{s},\\varepsilon}(r)=\\frac{1}{r^2+\\varepsilon^2}.\n$$\n对于给定的面板和源点 $\\mathbf{x}_0$，定义目标积分\n$$\nI(K,\\varepsilon)=\\int_{T} \\varphi(\\mathbf{x})\\,K_{\\varepsilon}(\\|\\mathbf{x}-\\mathbf{x}_0\\|)\\,\\mathrm{d}A,\n$$\n其中 $T$ 是三角形面板，而 $K_{\\varepsilon}$ 为 $K_{\\mathrm{w},\\varepsilon}$ 或 $K_{\\mathrm{s},\\varepsilon}$。\n\n设计并实现两种专门用于处理 $\\mathbf{x}_0$ 处近奇异性的积分映射：\n1. 一种以面板上的 $\\mathbf{x}_0$ 为中心的极坐标映射，通过穿过 $\\mathbf{x}_0$ 的极射线对三角形进行参数化。对于每个角度 $\\theta\\in[0,2\\pi)$，定义 $\\rho_{\\max}(\\theta)$ 为从 $\\mathbf{x}_0$ 沿角度为 $\\theta$ 的射线到三角形边界的距离。映射 $(\\theta,\\rho)\\mapsto \\mathbf{x}(\\theta,\\rho)=\\mathbf{x}_0+\\rho\\,\\mathbf{d}(\\theta)$，其中 $\\mathbf{d}(\\theta)=(\\cos\\theta,\\sin\\theta)$，导出面积元 $\\mathrm{d}A=\\rho\\,\\mathrm{d}\\rho\\,\\mathrm{d}\\theta$。在 $\\theta\\in[0,2\\pi]$ 和归一化径向坐标 $t\\in[0,1]$（其中 $\\rho=t\\,\\rho_{\\max}(\\theta)$）上使用张量积 Gauss–Legendre 积分，得到\n$$\nI_{\\mathrm{polar}}(K,\\varepsilon;N_\\theta,N_\\rho)\\approx\\sum_{i=1}^{N_\\theta}\\sum_{j=1}^{N_\\rho} w_{\\theta,i}\\,w_{t,j}\\,\\varphi\\big(\\mathbf{x}_0+t_j\\,\\rho_{\\max}(\\theta_i)\\,\\mathbf{d}(\\theta_i)\\big)\\,K_{\\varepsilon}\\big(t_j\\,\\rho_{\\max}(\\theta_i)\\big)\\,\\big(\\rho_{\\max}(\\theta_i)^2\\,t_j\\big),\n$$\n其中 $w_{\\theta,i}$ 和 $w_{t,j}$ 分别是从 $[-1,1]$ 映射到 $[0,2\\pi]$ 和 $[0,1]$ 上的 Gauss–Legendre 权重。\n\n2. 一种在三角形的星型剖分上的 Duffy 变换，该剖分通过将 $\\mathbf{x}_0$ 与各个顶点相连，形成三个子三角形。对于每个具有局部仿射映射 $\\mathbf{x}(u,v)=\\mathbf{x}_0+u\\,\\mathbf{a}+v\\,\\mathbf{b}$（$u\\ge 0$, $v\\ge 0$, $u+v\\le 1$）的子三角形，其中 $\\mathbf{a}$ 和 $\\mathbf{b}$ 是从 $\\mathbf{x}_0$ 到两个连续顶点的边向量，应用 Duffy 映射 $(\\xi,\\eta)\\mapsto (u,v)$，其中 $u=\\xi(1-\\eta)$ 和 $v=\\xi\\eta$，$(\\xi,\\eta)\\in[0,1]^2$。面积元变换为 $\\mathrm{d}A=J_{\\text{sub}}\\,\\xi\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta$，其中 $J_{\\text{sub}}=\\left|\\det\\left[\\mathbf{a}\\ \\mathbf{b}\\right]\\right|$ 是平面雅可比行列式的绝对值。局部距离为 $r(\\xi,\\eta)=\\|\\mathbf{x}(\\xi,\\eta)-\\mathbf{x}_0\\|=\\xi\\,\\|\\,(1-\\eta)\\mathbf{a}+\\eta\\mathbf{b}\\,\\|$。在 $(\\xi,\\eta)\\in[0,1]^2$ 上使用张量积 Gauss–Legendre 积分，并对三个子三角形的贡献求和，得到 $I_{\\mathrm{Duffy}}(K,\\varepsilon;N_\\xi,N_\\eta)$。\n\n从线性弹性静力学中边界积分公式的基本原理（即，边界积分涉及具有弱或强局部奇异性的核函数，且精确的数值评估需要能够感知奇异性的映射和对雅可比行列式的控制）出发，推导映射的雅可比行列式并实现两种积分方案。对于下方的每个测试用例，使用具有大积分阶数的极坐标映射计算一个高精度参考值 $I_{\\mathrm{ref}}(K,\\varepsilon)$，并量化绝对误差\n$$\nE_{\\mathrm{polar}}=\\left|I_{\\mathrm{polar}}-I_{\\mathrm{ref}}\\right|,\\qquad E_{\\mathrm{Duffy}}=\\left|I_{\\mathrm{Duffy}}-I_{\\mathrm{ref}}\\right|.\n$$\n报告每个测试用例的效率比 $R=E_{\\mathrm{Duffy}}/E_{\\mathrm{polar}}$。\n\n测试套件参数化：\n- 三角形顶点如上固定。测试函数参数为 $\\alpha=0.3$，$\\beta=0.2$。\n- 源点 $\\mathbf{x}_0$：\n  - 情况 A：形心 $\\mathbf{x}_0=(\\mathbf{v}_1+\\mathbf{v}_2+\\mathbf{v}_3)/3$。\n  - 情况 B：靠近顶点 $\\mathbf{v}_1$，$\\mathbf{x}_0=0.8\\,\\mathbf{v}_1+0.1\\,\\mathbf{v}_2+0.1\\,\\mathbf{v}_3$。\n  - 情况 C：靠近 $\\mathbf{v}_2$ 和 $\\mathbf{v}_3$ 之间的边，$\\mathbf{x}_0=0.1\\,\\mathbf{v}_1+0.8\\,\\mathbf{v}_2+0.1\\,\\mathbf{v}_3$。\n- 参考积分阶数：$N_\\theta^{\\mathrm{ref}}=200$，$N_\\rho^{\\mathrm{ref}}=200$。\n\n待评估的测试用例，每个用例指定为 $(\\text{核函数类型}, \\varepsilon, N_\\theta, N_\\rho, N_{\\mathrm{Duffy}}, \\mathbf{x}_0)$：\n1. 弱奇异：$(\\text{weak}, 10^{-6}, 24, 24, 24, \\text{centroid})$。\n2. 弱奇异：$(\\text{weak}, 10^{-8}, 16, 16, 16, \\text{centroid})$。\n3. 弱奇异：$(\\text{weak}, 10^{-6}, 24, 24, 24, \\text{near } \\mathbf{v}_1)$。\n4. 强奇异：$(\\text{strong}, 10^{-4}, 24, 24, 24, \\text{centroid})$。\n5. 强奇异：$(\\text{strong}, 10^{-6}, 32, 32, 32, \\text{centroid})$。\n6. 强奇异：$(\\text{strong}, 10^{-6}, 24, 24, 24, \\text{near edge } \\mathbf{v}_2\\text{-}\\mathbf{v}_3)$。\n\n您的程序应生成单行输出，其中包含上述六个测试用例的效率比 $R$，格式为方括号内以逗号分隔的列表（例如，“[r1,r2,r3,r4,r5,r6]”）。所有数值必须使用此处给定的三角形和函数设置进行计算；无需物理单位。角度必须以弧度处理。",
            "solution": "用户提供了一个有效的问题陈述。该问题在计算固体力学领域具有科学依据，特别是关于弹性静力学边界元法 (BEM) 中奇异边界积分的数值计算。这是一个适定问题，提供了所有必需的数据、定义和约束，从而可以得到唯一的数值解。其语言客观、正式。本解答将继续推导积分方案并加以实现。\n\n核心任务是在三角形面板 $T$ 上计算积分 $I(K,\\varepsilon)=\\int_{T} \\varphi(\\mathbf{x})\\,K_{\\varepsilon}(\\|\\mathbf{x}-\\mathbf{x}_0\\|)\\,\\mathrm{d}A$，其中涉及两种类型的正则化核函数 $K_{\\mathrm{w},\\varepsilon}$ 和 $K_{\\mathrm{s},\\varepsilon}$。点 $\\mathbf{x}_0$ 是三角形内部的一个源点，当 $\\varepsilon \\to 0$ 时，核函数在该点附近变为奇异。我们将推导并实现两种专门的积分技术：极坐标映射和 Duffy 变换。\n\n三角形的顶点为 $\\mathbf{v}_1=(0,0)$、$\\mathbf{v}_2=(1,0.2)$ 和 $\\mathbf{v}_3=(0.1,0.9)$。测试函数为 $\\varphi(\\mathbf{x})=1+0.3x+0.2y$。正则化核函数为 $K_{\\mathrm{w},\\varepsilon}(r)=\\log\\big(\\sqrt{r^2+\\varepsilon^2}\\big)$ 和 $K_{\\mathrm{s},\\varepsilon}(r)=1/(r^2+\\varepsilon^2)$。\n\n### 1. 极坐标映射\n\n该方法使用以源点 $\\mathbf{x}_0$ 为中心的极坐标 $(\\rho, \\theta)$ 对积分域进行重新参数化。三角形中的一个点 $\\mathbf{x}$ 由 $\\mathbf{x}(\\rho, \\theta) = \\mathbf{x}_0 + \\rho\\mathbf{d}(\\theta)$ 给出，其中 $\\mathbf{d}(\\theta) = (\\cos\\theta, \\sin\\theta)$ 是方向向量。离源点的距离为 $r = \\|\\mathbf{x} - \\mathbf{x}_0\\| = \\rho$。\n\n从笛卡尔坐标 $(x,y)$ 到极坐标 $(\\rho,\\theta)$ 的这种变换的雅可比行列式给出了微分面积元 $\\mathrm{d}A = \\rho\\,\\mathrm{d}\\rho\\,\\mathrm{d}\\theta$。积分变为：\n$$\nI = \\int_{0}^{2\\pi} \\int_{0}^{\\rho_{\\max}(\\theta)} \\varphi\\big(\\mathbf{x}_0 + \\rho\\mathbf{d}(\\theta)\\big) K_{\\varepsilon}(\\rho) \\rho\\,\\mathrm{d}\\rho\\,\\mathrm{d}\\theta\n$$\n此处，$\\rho_{\\max}(\\theta)$ 是从 $\\mathbf{x}_0$ 沿方向 $\\mathbf{d}(\\theta)$ 到三角形 $T$ 边界的距离。\n\n为了创建一个固定的积分域，我们引入一个归一化的径向坐标 $t \\in [0,1]$，使得 $\\rho = t\\rho_{\\max}(\\theta)$。微分则为 $\\mathrm{d}\\rho = \\rho_{\\max}(\\theta)\\,\\mathrm{d}t$。将此代入积分表达式，项 $\\rho\\,\\mathrm{d}\\rho$ 变换为：\n$$\n\\rho\\,\\mathrm{d}\\rho = \\big(t\\rho_{\\max}(\\theta)\\big) \\big(\\rho_{\\max}(\\theta)\\,\\mathrm{d}t\\big) = t\\rho_{\\max}(\\theta)^2\\,\\mathrm{d}t\n$$\n在 $(\\theta, t)$ 坐标系下，矩形域 $[0, 2\\pi] \\times [0, 1]$ 上的积分为：\n$$\nI = \\int_{0}^{2\\pi} \\int_{0}^{1} \\varphi\\big(\\mathbf{x}_0 + t\\rho_{\\max}(\\theta)\\mathbf{d}(\\theta)\\big) K_{\\varepsilon}\\big(t\\rho_{\\max}(\\theta)\\big) \\left(t\\rho_{\\max}(\\theta)^2\\right)\\,\\mathrm{d}t\\,\\mathrm{d}\\theta\n$$\n对 $\\theta$ 使用 $N_\\theta$ 个点，对 $t$（在问题描述中对应于 $\\rho$）使用 $N_\\rho$ 个点，应用张量积 Gauss-Legendre 积分，我们得到数值近似：\n$$\nI_{\\mathrm{polar}} \\approx \\sum_{i=1}^{N_\\theta}\\sum_{j=1}^{N_\\rho} w_{\\theta,i}\\,w_{t,j}\\,\\left[ \\varphi\\big(\\mathbf{x}(\\theta_i, t_j)\\big) K_{\\varepsilon}\\big(r(\\theta_i, t_j)\\big) t_j\\,\\rho_{\\max}(\\theta_i)^2 \\right]\n$$\n其中 $\\mathbf{x}(\\theta_i, t_j) = \\mathbf{x}_0+t_j\\,\\rho_{\\max}(\\theta_i)\\,\\mathbf{d}(\\theta_i)$，$r(\\theta_i, t_j) = t_j\\,\\rho_{\\max}(\\theta_i)$，且 $(t_j, w_{t,j})$ 和 $(\\theta_i, w_{\\theta,i})$ 分别是映射到区间 $[0,1]$ 和 $[0,2\\pi]$ 上的 Gauss-Legendre 积分点和权重。这证实了问题陈述中提供的公式。\n\n### 2. Duffy 变换\n\n该方法首先通过将源点 $\\mathbf{x}_0$ 连接到每个顶点 $\\mathbf{v}_1, \\mathbf{v}_2, \\mathbf{v}_3$，将原始三角形 $T$ 分解为三个子三角形 ($T_1, T_2, T_3$)。总积分是这些子三角形上积分的总和：$I = \\sum_{k=1}^3 \\int_{T_k} \\varphi(\\mathbf{x}) K_\\varepsilon(\\dots) \\mathrm{d}A$。\n\n考虑一个顶点为 $\\mathbf{x}_0, \\mathbf{v}_a, \\mathbf{v}_b$ 的子三角形。我们引入一个从 $(u,v)$ 平面中的参考三角形（其中 $u \\ge 0, v \\ge 0, u+v \\le 1$）到该子三角形的标准仿射映射：\n$$\n\\mathbf{x}(u,v) = \\mathbf{x}_0 + u(\\mathbf{v}_a - \\mathbf{x}_0) + v(\\mathbf{v}_b - \\mathbf{x}_0) = \\mathbf{x}_0 + u\\mathbf{a} + v\\mathbf{b}\n$$\n面积元变换为 $\\mathrm{d}A = J_{\\text{sub}}\\,\\mathrm{d}u\\,\\mathrm{d}v$，其中 $J_{\\text{sub}} = |\\det[\\mathbf{a} \\ \\mathbf{b}]|$ 是该仿射映射的雅可比行列式。\n\n接下来，Duffy 变换将 $(\\xi, \\eta)$ 平面中的单位正方形 $(\\xi,\\eta) \\in [0,1]^2$ 映射到 $(u,v)$ 平面中的参考三角形：\n$$\nu = \\xi(1-\\eta), \\quad v = \\xi\\eta\n$$\n该映射的雅可比行列式为：\n$$\nJ_{\\text{Duffy}} = \\left|\\det\\left(\\frac{\\partial(u,v)}{\\partial(\\xi,\\eta)}\\right)\\right| = \\left|\\det\\begin{pmatrix} 1-\\eta & -\\xi \\\\ \\eta & \\xi \\end{pmatrix}\\right| = |\\xi(1-\\eta) - (-\\xi\\eta)| = |\\xi| = \\xi \\quad (\\text{since } \\xi \\in [0,1])\n$$\n面积元 $\\mathrm{d}u\\,\\mathrm{d}v$ 被替换为 $\\xi\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta$。因此，面积元的完整变换为 $\\mathrm{d}A = J_{\\text{sub}}\\,\\xi\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta$。\n\n离源点的距离为 $r = \\|\\mathbf{x} - \\mathbf{x}_0\\| = \\|u\\mathbf{a} + v\\mathbf{b}\\| = \\|\\xi(1-\\eta)\\mathbf{a} + \\xi\\eta\\mathbf{b}\\| = \\xi\\|(1-\\eta)\\mathbf{a} + \\eta\\mathbf{b}\\|$。单个子三角形上的积分变为：\n$$\nI_{\\text{sub}} = \\int_{0}^{1}\\int_{0}^{1} \\varphi\\big(\\mathbf{x}(\\xi,\\eta)\\big) K_{\\varepsilon}\\big(r(\\xi,\\eta)\\big) J_{\\text{sub}}\\,\\xi\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta\n$$\n总积分 $I_{\\mathrm{Duffy}}$ 是三个此类积分之和，每个子三角形对应一个。此变换的关键特征是面积元中的因子 $\\xi$，它有效地消除了奇异性最弱的部分。对于像 $K_w(r) = \\log r \\sim \\log \\xi$ 这样的弱奇异核，被积函数包含项 $\\xi \\log \\xi$，该项在 $\\xi=0$ 处是有限且非奇异的。对于强奇异正则化核 $K_s(r) = 1/(r^2+\\varepsilon^2) \\sim 1/(\\xi^2)$，当 $\\varepsilon > 0$ 时，被积函数项 $\\xi/(\\xi^2(\\dots)+\\varepsilon^2)$ 也是非奇异的。这表明 Duffy 变换使被积函数正则化，使其适合标准的 Gauss-Legendre 积分。\n\n### 3. 实现与比较\n\n提供的 Python 代码基于上述推导实现了极坐标和 Duffy 两种积分方案。对于每个测试用例，使用具有大量积分点（$N_\\theta^{\\mathrm{ref}}=200, N_\\rho^{\\mathrm{ref}}=200$）的极坐标方法计算一个高精度参考值 $I_{\\mathrm{ref}}$。使用指定的较低阶积分规则计算极坐标方法（$E_{\\mathrm{polar}} = |I_{\\mathrm{polar}} - I_{\\mathrm{ref}}|$）和 Duffy 方法（$E_{\\mathrm{Duffy}} = |I_{\\mathrm{Duffy}} - I_{\\mathrm{ref}}|$）的绝对误差。最终报告的值是效率比 $R = E_{\\mathrm{Duffy}} / E_{\\mathrm{polar}}$，它比较了在给定积分点数量下两种方法的精度。比率 $R<1$ 表示 Duffy 方法更精确。",
            "answer": "```python\nimport numpy as np\nfrom numpy.polynomial.legendre import leggauss\n\ndef solve():\n    \"\"\"\n    Solves the BEM quadrature problem by implementing and comparing polar and Duffy integration methods.\n    \"\"\"\n    # Global constants from the problem\n    V1 = np.array([0.0, 0.0])\n    V2 = np.array([1.0, 0.2])\n    V3 = np.array([0.1, 0.9])\n    VERTICES = (V1, V2, V3)\n    ALPHA = 0.3\n    BETA = 0.2\n\n    # Test function\n    def phi(x):\n        return 1.0 + ALPHA * x[0] + BETA * x[1]\n\n    # Regularized kernels\n    def k_weak(r, epsilon):\n        # The argument to log must be > 0. sqrt(r^2+eps^2) is always >0 for eps>0.\n        return 0.5 * np.log(r**2 + epsilon**2)\n\n    def k_strong(r, epsilon):\n        return 1.0 / (r**2 + epsilon**2)\n\n    # Helper function for Gauss-Legendre quadrature on arbitrary interval [a, b]\n    def mapped_leggauss(N, a, b):\n        points, weights = leggauss(N)\n        mapped_points = (b - a) / 2.0 * points + (a + b) / 2.0\n        mapped_weights = (b - a) / 2.0 * weights\n        return mapped_points, mapped_weights\n    \n    # Memoization for get_rho_max to speed up repeated calls with same theta\n    rho_max_cache = {}\n    def get_rho_max(theta, x0_tuple):\n        x0 = np.array(x0_tuple)\n        cache_key = (theta, x0_tuple)\n        if cache_key in rho_max_cache:\n            return rho_max_cache[cache_key]\n\n        d = np.array([np.cos(theta), np.sin(theta)])\n        distances = []\n        \n        edges = [(V1, V2), (V2, V3), (V3, V1)]\n        for p1, p2 in edges:\n            v = p2 - p1\n            mat_det = -d[0] * v[1] + d[1] * v[0]\n            \n            if np.abs(mat_det)  1e-15:\n                continue\n\n            rhs = p1 - x0\n            t = (rhs[0] * (-v[1]) - rhs[1] * (-v[0])) / mat_det\n            s = (d[0] * rhs[1] - d[1] * rhs[0]) / mat_det\n            \n            if t > 1e-12 and -1e-12 = s = 1.0 + 1e-12:\n                distances.append(t)\n        \n        if not distances:\n            raise ValueError(f\"No intersection found for theta={theta}, x0={x0}\")\n        \n        result = min(distances)\n        rho_max_cache[cache_key] = result\n        return result\n\n    def integrate_polar(kernel_func, epsilon, N_theta, N_rho, x0):\n        theta_pts, theta_w = mapped_leggauss(N_theta, 0, 2 * np.pi)\n        t_pts, t_w = mapped_leggauss(N_rho, 0, 1)\n        \n        integral = 0.0\n        x0_tuple = tuple(x0) # Use tuple for cache key\n        \n        for i, th in enumerate(theta_pts):\n            rho_max_i = get_rho_max(th, x0_tuple)\n            d_i = np.array([np.cos(th), np.sin(th)])\n            \n            for j, t in enumerate(t_pts):\n                rho = t * rho_max_i\n                x = x0 + rho * d_i\n                integrand = phi(x) * kernel_func(rho, epsilon) * (rho_max_i**2 * t)\n                integral += theta_w[i] * t_w[j] * integrand\n                \n        return integral\n\n    def integrate_duffy_sub(kernel_func, epsilon, N, x0, v_a, v_b):\n        a = v_a - x0\n        b = v_b - x0\n        \n        J_sub = np.abs(a[0] * b[1] - a[1] * b[0])\n        \n        xi_pts, xi_w = mapped_leggauss(N, 0, 1)\n        eta_pts, eta_w = mapped_leggauss(N, 0, 1)\n        \n        integral = 0.0\n        \n        for i, xi in enumerate(xi_pts):\n            for j, eta in enumerate(eta_pts):\n                pos_rel = xi * ((1 - eta) * a + eta * b)\n                x = x0 + pos_rel\n                r = np.linalg.norm(pos_rel)\n                integrand = phi(x) * kernel_func(r, epsilon) * J_sub * xi\n                integral += xi_w[i] * eta_w[j] * integrand\n        \n        return integral\n\n    def integrate_duffy(kernel_func, epsilon, N, x0):\n        total_integral = 0.0\n        v1, v2, v3 = VERTICES\n        total_integral += integrate_duffy_sub(kernel_func, epsilon, N, x0, v1, v2)\n        total_integral += integrate_duffy_sub(kernel_func, epsilon, N, x0, v2, v3)\n        total_integral += integrate_duffy_sub(kernel_func, epsilon, N, x0, v3, v1)\n        return total_integral\n\n    test_cases_params = [\n        ('weak', 1e-6, 24, 24, 24, 'centroid'),\n        ('weak', 1e-8, 16, 16, 16, 'centroid'),\n        ('weak', 1e-6, 24, 24, 24, 'near_v1'),\n        ('strong', 1e-4, 24, 24, 24, 'centroid'),\n        ('strong', 1e-6, 32, 32, 32, 'centroid'),\n        ('strong', 1e-6, 24, 24, 24, 'near_edge_v2_v3'),\n    ]\n\n    x0_centroid = (V1 + V2 + V3) / 3.0\n    x0_near_v1 = 0.8 * V1 + 0.1 * V2 + 0.1 * V3\n    x0_near_edge = 0.1 * V1 + 0.8 * V2 + 0.1 * V3\n\n    source_points_map = {\n        'centroid': x0_centroid,\n        'near_v1': x0_near_v1,\n        'near_edge_v2_v3': x0_near_edge\n    }\n    \n    kernel_map = {'weak': k_weak, 'strong': k_strong}\n    N_theta_ref, N_rho_ref = 200, 200\n    \n    results = []\n\n    for params in test_cases_params:\n        k_type, epsilon, N_theta, N_rho, N_duffy, x0_key = params\n        \n        kernel = kernel_map[k_type]\n        x0 = source_points_map[x0_key]\n        \n        rho_max_cache.clear() # Clear cache for each new configuration\n        I_ref = integrate_polar(kernel, epsilon, N_theta_ref, N_rho_ref, x0)\n        \n        rho_max_cache.clear()\n        I_polar = integrate_polar(kernel, epsilon, N_theta, N_rho, x0)\n        I_duffy = integrate_duffy(kernel, epsilon, N_duffy, x0)\n        \n        E_polar = np.abs(I_polar - I_ref)\n        E_duffy = np.abs(I_duffy - I_ref)\n        \n        if E_polar  1e-16:\n            ratio = 1.0 if E_duffy  1e-16 else np.inf\n        else:\n            ratio = E_duffy / E_polar\n            \n        results.append(ratio)\n        \n    print(f\"[{','.join(f'{r:.8f}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}