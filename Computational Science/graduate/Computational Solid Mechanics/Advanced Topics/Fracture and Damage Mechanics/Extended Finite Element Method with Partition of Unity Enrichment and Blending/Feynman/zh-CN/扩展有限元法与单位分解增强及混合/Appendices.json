{
    "hands_on_practices": [
        {
            "introduction": "在扩展有限元方法中，当一个单元内只有部分节点被富集时，该单元被称为“交融单元”。对这些单元处理不当会导致所谓的“交融误差”，破坏标准有限元方法具备的多项式再生性质。本练习  通过一个一维算例，清晰地揭示了非移位富集（non-shifted enrichment）如何引入误差，并展示了移位富集（shifted enrichment）是如何有效修正这一问题，从而保证了近似的准确性。",
            "id": "3564649",
            "problem": "考虑一个定义在参考区间 $[-1,1]$ 上的一维线性 Lagrange 有限元，其两个节点分别位于 $x_1=-1$ 和 $x_2=1$。令 $N_1(x)=\\tfrac{1-x}{2}$ 和 $N_2(x)=\\tfrac{1+x}{2}$ 表示标准形函数，它们满足单位分解性质 $\\sum_{i=1}^2 N_i(x)=1$ 和 Kronecker delta 性质 $N_i(x_j)=\\delta_{ij}$。在扩展有限元法 (Extended Finite Element Method, XFEM) 中，通过单位分解法 (Partition of Unity Method, PUM) 扩展标准有限元空间，从而构造出一种增强近似。给定一个增强函数 $\\psi(x)$ 和一个指示符 $\\chi_i\\in\\{0,1\\}$（用于标记节点 $i$ 是否被增强），可以定义目标场 $u(x)$ 的两种局部插值：\n- 非移位的 PUM 插值\n$$\nu_h^{\\mathrm{ns}}(x)=\\sum_{i=1}^{2} N_i(x)\\left[u(x_i)+\\chi_i\\,u(x_i)\\,\\psi(x)\\right],\n$$\n- 使用移位增强的 PUM 插值\n$$\n\\tilde{\\psi}(x;x_i)=\\psi(x)-\\psi(x_i),\\quad\nu_h^{\\mathrm{sh}}(x)=\\sum_{i=1}^{2} N_i(x)\\left[u(x_i)+\\chi_i\\,u(x_i)\\,\\tilde{\\psi}(x;x_i)\\right].\n$$\n移位增强是一种交融修正，其目的在于消除仅有部分节点被增强的单元（交融单元）中的伪振荡，同时保持标准有限元对多项式的再生能力。从以下两个基本事实出发：(i) 线性 Lagrange 形函数在节点插值下能精确再生最高为 1 次的多项式；(ii) 单位分解性质 $\\sum_i N_i(x)=1$ 逐点成立。请从基本原理推导，当 $\\psi(x)$ 为常数时，移位插值 $u_h^{\\mathrm{sh}}(x)$ 会退化为标准有限元插值，因此对于最高为 1 次的多项式是精确的，且与增强模式 $\\chi_i$ 无关。然后，将其与非移位插值 $u_h^{\\mathrm{ns}}(x)$ 进行对比，后者在 $\\chi_i\\neq 0$ 时会引入伪交融贡献。\n\n设目标场为 $u_0(x)=1$ 和 $u_1(x)=x$，并选择常数增强 $\\psi(x)\\equiv 1$。考虑以下增强模式和目标的测试套件：\n1. 完全增强，两个节点均被增强，$(\\chi_1,\\chi_2)=(1,1)$，目标 $u_0(x)=1$。\n2. 完全增强，两个节点均被增强，$(\\chi_1,\\chi_2)=(1,1)$，目标 $u_1(x)=x$。\n3. 交融单元，仅左侧节点被增强，$(\\chi_1,\\chi_2)=(1,0)$，目标 $u_1(x)=x$。\n4. 交融单元，仅左侧节点被增强，$(\\chi_1,\\chi_2)=(1,0)$，目标 $u_0(x)=1$。\n5. 无增强，$(\\chi_1,\\chi_2)=(0,0)$，目标 $u_1(x)=x$。\n\n对于每个测试用例，计算 $u_h^{\\mathrm{ns}}(x)$ 和 $u_h^{\\mathrm{sh}}(x)$ 在 $[-1,1]$ 上的 $L^2$ 误差，其定义为\n$$\n\\|u-u_h\\|_{L^2([-1,1])}=\\left(\\int_{-1}^{1}\\left[u(x)-u_h(x)\\right]^2\\,\\mathrm{d}x\\right)^{1/2}.\n$$\n您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表，列表包含十个结果，顺序如下\n$$\n\\left[\\|u-u_h^{\\mathrm{ns}}\\|_1,\\|u-u_h^{\\mathrm{sh}}\\|_1,\\|u-u_h^{\\mathrm{ns}}\\|_2,\\|u-u_h^{\\mathrm{sh}}\\|_2,\\|u-u_h^{\\mathrm{ns}}\\|_3,\\|u-u_h^{\\mathrm{sh}}\\|_3,\\|u-u_h^{\\mathrm{ns}}\\|_4,\\|u-u_h^{\\mathrm{sh}}\\|_4,\\|u-u_h^{\\mathrm{ns}}\\|_5,\\|u-u_h^{\\mathrm{sh}}\\|_5\\right],\n$$\n其中下标索引对应于上面编号的测试用例，每个条目都是一个浮点数。此计算不涉及物理单位，也不使用角度。代码必须是自包含的，且不需要任何输入。",
            "solution": "该问题是有效的，因为它是自包含的，其科学依据在于扩展有限元法的原理，并且在数学上是适定的。我们将开始求解，求解过程包括理论推导和针对指定测试用例的定量计算。\n\n首先，我们将确立对于常数增强函数 $\\psi(x)$，移位和非移位插值的性质。其次，我们将计算五个测试用例中每个用例的 $L^2$ 误差。\n\n设一维参考单元定义在区间 $x \\in [-1, 1]$ 上。节点位于 $x_1 = -1$ 和 $x_2 = 1$。线性 Lagrange 形函数为 $N_1(x) = \\frac{1-x}{2}$ 和 $N_2(x) = \\frac{1+x}{2}$。这些函数满足两个基本性质：\n1.  单位分解： $\\sum_{i=1}^{2} N_i(x) = N_1(x) + N_2(x) = \\frac{1-x}{2} + \\frac{1+x}{2} = \\frac{2}{2} = 1$。\n2.  线性多项式再生：线性函数 $u(x) = a + bx$ 的标准有限元插值是精确的。\n    $$u_h^{\\mathrm{std}}(x) = \\sum_{i=1}^2 N_i(x) u(x_i) = N_1(x)(a+bx_1) + N_2(x)(a+bx_2)$$\n    利用单位分解性质，$\\sum N_i(x) a = a \\sum N_i(x) = a$。利用特定坐标 $x_1 = -1$ 和 $x_2 = 1$，我们可以展示线性再生能力：\n    $$\\sum_{i=1}^2 N_i(x) x_i = N_1(x)x_1 + N_2(x)x_2 = \\frac{1-x}{2}(-1) + \\frac{1+x}{2}(1) = \\frac{x-1}{2} + \\frac{1+x}{2} = \\frac{2x}{2} = x$$\n    因此，$u_h^{\\mathrm{std}}(x) = a \\sum N_i(x) + b \\sum N_i(x)x_i = a(1) + b(x) = a+bx = u(x)$。\n\n**对移位 PUM 插值 ($u_h^{\\mathrm{sh}}(x)$) 的分析**\n\n移位 PUM 插值的定义为：\n$$u_h^{\\mathrm{sh}}(x) = \\sum_{i=1}^{2} N_i(x)\\left[u(x_i)+\\chi_i\\,u(x_i)\\,\\tilde{\\psi}(x;x_i)\\right]$$\n其中移位增强为 $\\tilde{\\psi}(x;x_i) = \\psi(x) - \\psi(x_i)$。\n\n问题指定了一个常数增强函数 $\\psi(x) = 1$。对于任意节点 $i$，增强函数在节点坐标 $x_i$ 处的值也为 $\\psi(x_i) = 1$。\n因此，移位增强函数变为：\n$$\\tilde{\\psi}(x;x_i) = \\psi(x) - \\psi(x_i) = 1 - 1 = 0$$\n将 $\\tilde{\\psi}(x;x_i) = 0$ 代入 $u_h^{\\mathrm{sh}}(x)$ 的定义中：\n$$u_h^{\\mathrm{sh}}(x) = \\sum_{i=1}^{2} N_i(x)\\left[u(x_i)+\\chi_i\\,u(x_i)\\,(0)\\right] = \\sum_{i=1}^{2} N_i(x)u(x_i)$$\n这恰好是标准的线性 Lagrange 有限元插值 $u_h^{\\mathrm{std}}(x)$。如上所示，$u_h^{\\mathrm{std}}(x)$ 能精确再生线性多项式。所提供的目标场是 $u_0(x)=1$（0 次）和 $u_1(x)=x$（1 次），它们都是次数最高为 1 的多项式。\n\n因此，对于任何增强模式 $(\\chi_1, \\chi_2)$，移位插值 $u_h^{\\mathrm{sh}}(x)$ 将与精确函数 $u(x)$ 完全相同。因此插值误差为零：\n$$u(x) - u_h^{\\mathrm{sh}}(x) = 0$$\n这意味着对于所有五个测试用例，$L^2$ 误差范数 $\\|u-u_h^{\\mathrm{sh}}\\|_{L^2([-1,1])}$ 都将为 $0$。这一结果展示了移位增强的关键优势：对于常数增强，它恢复了标准有限元法的最优行为，而与增强模式无关。\n\n**对非移位 PUM 插值 ($u_h^{\\mathrm{ns}}(x)$) 的分析**\n\n非移位 PUM 插值的定义为：\n$$u_h^{\\mathrm{ns}}(x)=\\sum_{i=1}^{2} N_i(x)\\left[u(x_i)+\\chi_i\\,u(x_i)\\,\\psi(x)\\right]$$\n此表达式可以展开和重排：\n$$u_h^{\\mathrm{ns}}(x) = \\sum_{i=1}^{2} N_i(x)u(x_i) + \\sum_{i=1}^{2} N_i(x)\\chi_i\\,u(x_i)\\,\\psi(x)$$\n将第一项识别为标准插值 $u_h^{\\mathrm{std}}(x)$：\n$$u_h^{\\mathrm{ns}}(x) = u_h^{\\mathrm{std}}(x) + \\psi(x)\\sum_{i=1}^{2} \\chi_i\\,N_i(x)\\,u(x_i)$$\n由于目标函数是线性的，我们有 $u_h^{\\mathrm{std}}(x) = u(x)$。因此，非移位方案的插值误差为：\n$$e_{\\mathrm{ns}}(x) = u(x) - u_h^{\\mathrm{ns}}(x) = u(x) - \\left(u(x) + \\psi(x)\\sum_{i=1}^{2} \\chi_i\\,N_i(x)\\,u(x_i)\\right)$$\n$$e_{\\mathrm{ns}}(x) = -\\psi(x)\\sum_{i=1}^{2} \\chi_i\\,N_i(x)\\,u(x_i)$$\n当 $\\psi(x) = 1$ 时，误差简化为：\n$$e_{\\mathrm{ns}}(x) = -\\sum_{i=1}^{2} \\chi_i\\,N_i(x)\\,u(x_i)$$\n当任何 $\\chi_i$ 非零时，该误差项通常不为零，导致精确性的丧失。这就是交融单元中由增强引起的伪贡献。\n\n我们现在计算每个测试用例的 $L^2$ 误差。$L^2$ 误差为 $\\|e\\|_{L^2} = (\\int_{-1}^{1} [e(x)]^2 dx)^{1/2}$。\n\n**情况 1：完全增强, $u_0(x)=1$**\n参数：$(\\chi_1, \\chi_2) = (1, 1)$，$u(x) = 1$。节点值：$u(x_1)=1, u(x_2)=1$。\n误差 $e_{\\mathrm{ns}}(x) = -[1 \\cdot N_1(x) \\cdot 1 + 1 \\cdot N_2(x) \\cdot 1] = -(N_1(x)+N_2(x)) = -1$。\n$\\|u-u_h^{\\mathrm{ns}}\\|_{L^2}^2 = \\int_{-1}^{1} (-1)^2 dx = \\int_{-1}^{1} 1 dx = [x]_{-1}^{1} = 2$。\n$\\|u-u_h^{\\mathrm{ns}}\\|_{L^2} = \\sqrt{2}$。\n$\\|u-u_h^{\\mathrm{sh}}\\|_{L^2} = 0$。\n\n**情况 2：完全增强, $u_1(x)=x$**\n参数：$(\\chi_1, \\chi_2) = (1, 1)$，$u(x) = x$。节点值：$u(x_1)=-1, u(x_2)=1$。\n误差 $e_{\\mathrm{ns}}(x) = -[1 \\cdot N_1(x) \\cdot (-1) + 1 \\cdot N_2(x) \\cdot 1] = -[-N_1(x)+N_2(x)] = N_1(x) - N_2(x) = \\frac{1-x}{2} - \\frac{1+x}{2} = -x$。\n$\\|u-u_h^{\\mathrm{ns}}\\|_{L^2}^2 = \\int_{-1}^{1} (-x)^2 dx = \\int_{-1}^{1} x^2 dx = [\\frac{x^3}{3}]_{-1}^{1} = \\frac{1}{3} - (-\\frac{1}{3}) = \\frac{2}{3}$。\n$\\|u-u_h^{\\mathrm{ns}}\\|_{L^2} = \\sqrt{2/3}$。\n$\\|u-u_h^{\\mathrm{sh}}\\|_{L^2} = 0$。\n\n**情况 3：交融单元, $u_1(x)=x$**\n参数：$(\\chi_1, \\chi_2) = (1, 0)$，$u(x) = x$。节点值：$u(x_1)=-1, u(x_2)=1$。\n误差 $e_{\\mathrm{ns}}(x) = -[1 \\cdot N_1(x) \\cdot (-1) + 0 \\cdot N_2(x) \\cdot 1] = N_1(x) = \\frac{1-x}{2}$。\n$\\|u-u_h^{\\mathrm{ns}}\\|_{L^2}^2 = \\int_{-1}^{1} (\\frac{1-x}{2})^2 dx = \\frac{1}{4}\\int_{-1}^{1} (1-2x+x^2) dx = \\frac{1}{4}[x-x^2+\\frac{x^3}{3}]_{-1}^{1} = \\frac{1}{4}[ (1-1+\\frac{1}{3}) - (-1-1-\\frac{1}{3}) ] = \\frac{1}{4}[\\frac{1}{3} - (-\\frac{7}{3})] = \\frac{1}{4}(\\frac{8}{3}) = \\frac{2}{3}$。\n$\\|u-u_h^{\\mathrm{ns}}\\|_{L^2} = \\sqrt{2/3}$。\n$\\|u-u_h^{\\mathrm{sh}}\\|_{L^2} = 0$。\n\n**情况 4：交融单元, $u_0(x)=1$**\n参数：$(\\chi_1, \\chi_2) = (1, 0)$，$u(x) = 1$。节点值：$u(x_1)=1, u(x_2)=1$。\n误差 $e_{\\mathrm{ns}}(x) = -[1 \\cdot N_1(x) \\cdot 1 + 0 \\cdot N_2(x) \\cdot 1] = -N_1(x) = -\\frac{1-x}{2} = \\frac{x-1}{2}$。\n$\\|u-u_h^{\\mathrm{ns}}\\|_{L^2}^2 = \\int_{-1}^{1} (\\frac{x-1}{2})^2 dx = \\frac{1}{4}\\int_{-1}^{1} (x^2-2x+1) dx$。这个积分与情况 3 中的积分相同。\n$\\|u-u_h^{\\mathrm{ns}}\\|_{L^2}^2 = \\frac{2}{3}$。\n$\\|u-u_h^{\\mathrm{ns}}\\|_{L^2} = \\sqrt{2/3}$。\n$\\|u-u_h^{\\mathrm{sh}}\\|_{L^2} = 0$。\n\n**情况 5：无增强, $u_1(x)=x$**\n参数：$(\\chi_1, \\chi_2) = (0, 0)$，$u(x) = x$。\n误差 $e_{\\mathrm{ns}}(x) = -[0 \\cdot N_1(x) \\cdot u(x_1) + 0 \\cdot N_2(x) \\cdot u(x_2)] = 0$。\n在这种情况下，非移位插值与标准插值相同，是精确的。\n$\\|u-u_h^{\\mathrm{ns}}\\|_{L^2} = 0$。\n$\\|u-u_h^{\\mathrm{sh}}\\|_{L^2} = 0$。\n\n结果总结：\n- 情况 1: $\\|u-u_h^{\\mathrm{ns}}\\|_{L^2} = \\sqrt{2}$, $\\|u-u_h^{\\mathrm{sh}}\\|_{L^2} = 0$\n- 情况 2: $\\|u-u_h^{\\mathrm{ns}}\\|_{L^2} = \\sqrt{2/3}$, $\\|u-u_h^{\\mathrm{sh}}\\|_{L^2} = 0$\n- 情况 3: $\\|u-u_h^{\\mathrm{ns}}\\|_{L^2} = \\sqrt{2/3}$, $\\|u-u_h^{\\mathrm{sh}}\\|_{L^2} = 0$\n- 情况 4: $\\|u-u_h^{\\mathrm{ns}}\\|_{L^2} = \\sqrt{2/3}$, $\\|u-u_h^{\\mathrm{sh}}\\|_{L^2} = 0$\n- 情况 5: $\\|u-u_h^{\\mathrm{ns}}\\|_{L^2} = 0$, $\\|u-u_h^{\\mathrm{sh}}\\|_{L^2} = 0$",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import integrate # Not needed, analytical integration is exact and simple.\n\ndef solve():\n    \"\"\"\n    Computes the L2 error for non-shifted and shifted PUM interpolants\n    for a series of test cases.\n    \"\"\"\n    # The enrichment function psi(x) is 1.\n    # The shifted enrichment psi_tilde(x; x_i) = psi(x) - psi(x_i) = 1 - 1 = 0.\n    # The shifted interpolant u_h_sh(x) thus reduces to the standard FEA interpolant.\n    # Since the target functions u(x) are linear, the standard interpolant is exact.\n    # Therefore, the error for the shifted interpolant is always 0.\n    \n    # Test cases: ( (chi1, chi2), u_id )\n    # u_id = 0 for u(x)=1\n    # u_id = 1 for u(x)=x\n    test_cases = [\n        ((1, 1), 0),  # Case 1\n        ((1, 1), 1),  # Case 2\n        ((1, 0), 1),  # Case 3\n        ((1, 0), 0),  # Case 4\n        ((0, 0), 1),  # Case 5\n    ]\n\n    results = []\n    \n    # Nodal coordinates\n    x1, x2 = -1.0, 1.0\n\n    # The error for the non-shifted interpolant is e_ns(x) = -sum(chi_i * N_i(x) * u(x_i)).\n    # We can express this error as e_ns(x) = a*x + b and use an analytical formula\n    # for the squared L2 norm over [-1, 1]:\n    # Integral from -1 to 1 of (ax+b)^2 dx = 2*a^2/3 + 2*b^2.\n    \n    for case in test_cases:\n        chi, u_id = case\n        chi1, chi2 = chi\n        \n        # Determine nodal values for the target function\n        if u_id == 0:  # u(x) = 1\n            u1, u2 = 1.0, 1.0\n        else:  # u(x) = x\n            u1, u2 = x1, x2\n\n        # The error e_ns(x) is -(chi1*u1*N1(x) + chi2*u2*N2(x))\n        # N1(x) = (1-x)/2, N2(x) = (1+x)/2\n        # e_ns(x) = - ( chi1*u1*(0.5 - 0.5*x) + chi2*u2*(0.5 + 0.5*x) )\n        # e_ns(x) = x * (0.5*chi1*u1 - 0.5*chi2*u2) - (0.5*chi1*u1 + 0.5*chi2*u2)\n        # This is of the form a*x + b\n        \n        a = 0.5 * chi1 * u1 - 0.5 * chi2 * u2\n        b = -0.5 * chi1 * u1 - 0.5 * chi2 * u2\n        \n        # Calculate squared L2 norm of the error for the non-shifted interpolant\n        l2_norm_sq_ns = (2.0/3.0) * a**2 + 2.0 * b**2\n        l2_norm_ns = np.sqrt(l2_norm_sq_ns)\n        \n        # The error for the shifted interpolant is 0 for all cases as derived.\n        l2_norm_sh = 0.0\n\n        results.append(l2_norm_ns)\n        results.append(l2_norm_sh)\n\n    # Format the final output string\n    # Using a high precision format string to avoid floating point representation issues.\n    output_str = f\"[{','.join(f'{r:.15f}' for r in results)}]\"\n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "理解了富集函数的概念及其修正（如移位富集）的必要性后，下一步是探究其在数学上如何改变标准的有限元方程。本练习  将引导你为一个被简单线性函数富集的三角形单元，从零开始推导其刚度矩阵和质量矩阵。通过这个过程，你将清晰地看到标准自由度和富集自由度之间是如何产生耦合项的，从而深化对富集近似核心机制的理解。",
            "id": "3564597",
            "problem": "考虑一个处于平面应力状态下的二维线性三角形有限元，其节点坐标分别为 $(0,0)$、$(h,0)$ 和 $(0,h)$，具有均匀厚度 $t$、杨氏模量 $E$、泊松比 $\\nu$ 和质量密度 $\\rho$。采用单位分解强化的位移场近似\n$$\nu_h(\\mathbf{x})=\\sum_{i=1}^{3} N_i(\\mathbf{x})\\,\\mathbf{a}_i \\;+\\; \\sum_{i=1}^{3} N_i(\\mathbf{x})\\,L(\\mathbf{x})\\,\\mathbf{b}_i,\n$$\n其中 $N_i(\\mathbf{x})$ 是标准线性形函数，$\\mathbf{a}_i=\\begin{pmatrix}a_{i}^{u}\\\\ a_{i}^{v}\\end{pmatrix}$ 是位移分量的标准节点自由度，$\\mathbf{b}_i=\\begin{pmatrix}b_{i}^{u}\\\\ b_{i}^{v}\\end{pmatrix}$ 是强化节点自由度，强化函数为 $L(\\mathbf{x})=x$。使用线性弹性静力学的标准弱形式，以及各向同性平面应力的本构律，\n$$\n\\boldsymbol{\\sigma} = \\mathbf{C}\\,\\boldsymbol{\\varepsilon}, \\quad \\mathbf{C}=\\frac{E}{1-\\nu^2}\\begin{pmatrix}1  \\nu  0\\\\ \\nu  1  0\\\\ 0  0  \\frac{1-\\nu}{2}\\end{pmatrix}.\n$$\n作用于位移矢量场 $\\mathbf{u}=(u,v)^{\\mathsf{T}}$ 上的小应变算子为\n$$\n\\boldsymbol{\\varepsilon}(\\mathbf{u}) = \\begin{pmatrix}\\partial u/\\partial x\\\\ \\partial v/\\partial y\\\\ \\partial u/\\partial y + \\partial v/\\partial x\\end{pmatrix}.\n$$\n对于一致单元质量矩阵，使用在单元域 $\\Omega_e$ 上的标准 $L^2$ 内积。\n\n任务：\n- 从弱形式和上述定义出发，为此强化近似构建单元级的一致质量矩阵和刚度矩阵。明确标识出分别对应于标准-标准、标准-强化和强化-强化耦合的分块 $(\\mathbf{M}_{aa},\\mathbf{M}_{ab},\\mathbf{M}_{bb})$ 和 $(\\mathbf{K}_{aa},\\mathbf{K}_{ab},\\mathbf{K}_{bb})$。清楚地指明用于标准场和强化场的形函数梯度和应变-位移矩阵，并精确计算在 $\\Omega_e$ 上的域积分。\n- 解释哪些子块体现了标准自由度与强化自由度之间的交叉耦合，并简要说明这些项出现的原因。\n\n答案规格：\n- 作为最终报告值，提供耦合节点2的标准$u$分量与节点2的强化$u$分量的单个刚度项的闭式解析表达式，即 $\\mathbf{K}_{ab}$ 的 $(2u,2u)$ 项，仅用 $E$、$\\nu$、$t$ 和 $h$ 表示。\n- 最终答案不包含单位。无需四舍五入。",
            "solution": "在尝试解答之前，对问题进行验证。\n\n### 步骤1：提取已知条件\n-   **单元类型**：一个二维线性三角形有限元。\n-   **节点坐标**：节点 $1$：$(0,0)$，节点 $2$：$(h,0)$，节点 $3$：$(0,h)$。\n-   **物理属性**：均匀厚度 $t$，杨氏模量 $E$，泊松比 $\\nu$，质量密度 $\\rho$。\n-   **应力状态**：平面应力。\n-   **位移近似**：$u_h(\\mathbf{x})=\\sum_{i=1}^{3} N_i(\\mathbf{x})\\,\\mathbf{a}_i \\;+\\; \\sum_{i=1}^{3} N_i(\\mathbf{x})\\,L(\\mathbf{x})\\,\\mathbf{b}_i$。\n-   **形函数**：$N_i(\\mathbf{x})$ 是标准线性形函数。\n-   **节点自由度(DOF)**：标准自由度 $\\mathbf{a}_i=\\begin{pmatrix}a_{i}^{u}\\\\ a_{i}^{v}\\end{pmatrix}$，强化自由度 $\\mathbf{b}_i=\\begin{pmatrix}b_{i}^{u}\\\\ b_{i}^{v}\\end{pmatrix}$。\n-   **强化函数**：$L(\\mathbf{x})=x$。\n-   **本构律**：$\\boldsymbol{\\sigma} = \\mathbf{C}\\,\\boldsymbol{\\varepsilon}$，其中 $\\mathbf{C}=\\frac{E}{1-\\nu^2}\\begin{pmatrix}1  \\nu  0\\\\ \\nu  1  0\\\\ 0  0  \\frac{1-\\nu}{2}\\end{pmatrix}$。\n-   **应变算子**：对于 $\\mathbf{u}=(u,v)^{\\mathsf{T}}$，$\\boldsymbol{\\varepsilon}(\\mathbf{u}) = \\begin{pmatrix}\\partial u/\\partial x\\\\ \\partial v/\\partial y\\\\ \\partial u/\\partial y + \\partial v/\\partial x\\end{pmatrix}$。\n-   **质量矩阵**：一致质量矩阵，由单元域 $\\Omega_e$ 上的 $L^2$ 内积得到。\n-   **任务**：\n    1.  构建具有分块 $(\\mathbf{M}_{aa},\\mathbf{M}_{ab},\\mathbf{M}_{bb})$ 和 $(\\mathbf{K}_{aa},\\mathbf{K}_{ab},\\mathbf{K}_{bb})$ 的一致质量矩阵 $\\mathbf{M}_e$ 和刚度矩阵 $\\mathbf{K}_e$。\n    2.  解释交叉耦合子块。\n-   **要求的最终答案**：耦合节点2的标准$u$分量与节点2的强化$u$分量的刚度项的闭式解析表达式。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题具有科学依据，是适定且客观的。这是计算固体力学领域的一个标准问题，特别涉及扩展有限元法 (XFEM) 或单位分解有限元法 (PUFEM)。所有必要的数据（几何形状、材料属性、本构律和近似场）均已提供且相互一致。任务定义明确，可以导出一个唯一且有意义的解。该问题不违反任何无效性标准。\n\n### 步骤3：结论与行动\n问题是**有效的**。将提供完整解答。\n\n***\n\n位移场 $\\mathbf{u}_h(\\mathbf{x})$ 可以写成标准部分 $\\mathbf{u}_a(\\mathbf{x})$ 和强化部分 $\\mathbf{u}_b(\\mathbf{x})$ 的和：\n$$\n\\mathbf{u}_h(\\mathbf{x}) = \\mathbf{u}_a(\\mathbf{x}) + \\mathbf{u}_b(\\mathbf{x}) = \\sum_{i=1}^{3} N_i(\\mathbf{x}) \\mathbf{a}_i + \\sum_{i=1}^{3} N_i(\\mathbf{x}) L(\\mathbf{x}) \\mathbf{b}_i\n$$\n节点自由度排列在一个向量 $\\mathbf{d} = (\\mathbf{a}^T, \\mathbf{b}^T)^T$ 中，其中 $\\mathbf{a} = (\\mathbf{a}_1^T, \\mathbf{a}_2^T, \\mathbf{a}_3^T)^T$ 且 $\\mathbf{b} = (\\mathbf{b}_1^T, \\mathbf{b}_2^T, \\mathbf{b}_3^T)^T$。单元刚度矩阵 $\\mathbf{K}_e$ 和质量矩阵 $\\mathbf{M}_e$ 将具有 $2 \\times 2$ 的分块结构：\n$$\n\\mathbf{K}_e = \\begin{pmatrix} \\mathbf{K}_{aa}  \\mathbf{K}_{ab} \\\\ \\mathbf{K}_{ba}  \\mathbf{K}_{bb} \\end{pmatrix}, \\quad\n\\mathbf{M}_e = \\begin{pmatrix} \\mathbf{M}_{aa}  \\mathbf{M}_{ab} \\\\ \\mathbf{M}_{ba}  \\mathbf{M}_{bb} \\end{pmatrix}\n$$\n刚度矩阵子块的一般表达式为：\n$$\n\\mathbf{K}_{XY} = \\int_{\\Omega_e} t (\\mathbf{B}_X)^T \\mathbf{C} \\mathbf{B}_Y \\, d\\Omega\n$$\n其中 $X, Y \\in \\{a, b\\}$，$\\mathbf{B}_X$ 是对应于近似中 $X$ 部分的应变-位移矩阵，$\\mathbf{C}$ 是本构矩阵，$t$ 是单元厚度。\n\n应变-位移矩阵 $\\mathbf{B}$ 将应变向量 $\\boldsymbol{\\varepsilon}$ 与节点自由度关联起来。对于标准部分，应变为 $\\boldsymbol{\\varepsilon}_a = \\sum_{i=1}^3 \\mathbf{B}_{a,i} \\mathbf{a}_i$，其中 $\\mathbf{B}_{a,i}$ 是节点 $i$ 的标准应变-位移矩阵：\n$$\n\\mathbf{B}_{a,i} = \\begin{pmatrix} \\frac{\\partial N_i}{\\partial x}  0 \\\\ 0  \\frac{\\partial N_i}{\\partial y} \\\\ \\frac{\\partial N_i}{\\partial y}  \\frac{\\partial N_i}{\\partial x} \\end{pmatrix}\n$$\n对于强化部分，应变为 $\\boldsymbol{\\varepsilon}_b = \\sum_{i=1}^3 \\mathbf{B}_{b,i} \\mathbf{b}_i$。强化场的基函数为 $\\Phi_i(\\mathbf{x}) = N_i(\\mathbf{x})L(\\mathbf{x})$。使用微分的乘法法则和给定的强化函数 $L(\\mathbf{x}) = x$：\n$$\n\\frac{\\partial \\Phi_i}{\\partial x} = \\frac{\\partial (N_i x)}{\\partial x} = \\frac{\\partial N_i}{\\partial x} x + N_i, \\quad \\frac{\\partial \\Phi_i}{\\partial y} = \\frac{\\partial (N_i x)}{\\partial y} = \\frac{\\partial N_i}{\\partial y} x\n$$\n这给出了节点 $i$ 处强化自由度的应变-位移矩阵：\n$$\n\\mathbf{B}_{b,i} = \\begin{pmatrix} \\frac{\\partial \\Phi_i}{\\partial x}  0 \\\\ 0  \\frac{\\partial \\Phi_i}{\\partial y} \\\\ \\frac{\\partial \\Phi_i}{\\partial y}  \\frac{\\partial \\Phi_i}{\\partial x} \\end{pmatrix} = \\begin{pmatrix} \\frac{\\partial N_i}{\\partial x} x + N_i  0 \\\\ 0  \\frac{\\partial N_i}{\\partial y} x \\\\ \\frac{\\partial N_i}{\\partial y} x  \\frac{\\partial N_i}{\\partial x} x + N_i \\end{pmatrix}\n$$\n我们的任务是找到耦合节点2的标准$u$分量 $a_{2u}$ 与节点2的强化$u$分量 $b_{2u}$ 的刚度项。该项是耦合自由度 $\\mathbf{a}_2$ 和 $\\mathbf{b}_2$ 的 $2 \\times 2$ 子块矩阵 $\\mathbf{K}_{ab}^{22}$ 在位置 $(1,1)$ 的元素。其表达式为：\n$$\n(\\mathbf{K}_{ab}^{22})_{11} = \\int_{\\Omega_e} t \\, (\\text{col } 1 \\text{ of } \\mathbf{B}_{a,2})^T \\mathbf{C} (\\text{col } 1 \\text{ of } \\mathbf{B}_{b,2}) \\, d\\Omega\n$$\n所需的向量为：\n$$\n(\\text{col } 1 \\text{ of } \\mathbf{B}_{a,2})^T = \\begin{pmatrix} \\frac{\\partial N_2}{\\partial x}  0  \\frac{\\partial N_2}{\\partial y} \\end{pmatrix}\n$$\n$$\n(\\text{col } 1 \\text{ of } \\mathbf{B}_{b,2}) = \\begin{pmatrix} \\frac{\\partial N_2}{\\partial x} x + N_2 \\\\ 0 \\\\ \\frac{\\partial N_2}{\\partial y} x \\end{pmatrix}\n$$\n单元节点位于 $(0,0)$、$(h,0)$ 和 $(0,h)$。这个直角三角形的线性形函数为：\n$$\nN_1(x,y) = 1 - \\frac{x}{h} - \\frac{y}{h}, \\quad N_2(x,y) = \\frac{x}{h}, \\quad N_3(x,y) = \\frac{y}{h}\n$$\n$N_2$ 的梯度在单元上是常数：\n$$\n\\frac{\\partial N_2}{\\partial x} = \\frac{1}{h}, \\quad \\frac{\\partial N_2}{\\partial y} = 0\n$$\n将这些梯度代入向量中：\n$$\n(\\text{col } 1 \\text{ of } \\mathbf{B}_{a,2})^T = \\begin{pmatrix} \\frac{1}{h}  0  0 \\end{pmatrix}\n$$\n$$\n(\\text{col } 1 \\text{ of } \\mathbf{B}_{b,2}) = \\begin{pmatrix} \\frac{1}{h} x + \\frac{x}{h} \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} \\frac{2x}{h} \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n被积函数为 $t \\, (\\begin{pmatrix} \\frac{1}{h}  0  0 \\end{pmatrix}) \\mathbf{C} (\\begin{pmatrix} \\frac{2x}{h} \\\\ 0 \\\\ 0 \\end{pmatrix})$。\n我们来执行矩阵乘法。这两个向量与 $\\mathbf{C}$ 的乘积只涉及 $\\mathbf{C}$ 的 $(1,1)$ 分量，即 $C_{11} = \\frac{E}{1-\\nu^2}$。\n$$\n\\text{Integrand} = t \\left( \\frac{1}{h} \\right) \\left( \\frac{E}{1-\\nu^2} \\right) \\left( \\frac{2x}{h} \\right) = \\frac{2Et}{h^2(1-\\nu^2)} x\n$$\n现在，我们必须在三角形域 $\\Omega_e$ 上对该表达式进行积分。积分限为 $x$ 从 $0$ 到 $h$，$y$ 对每个 $x$ 从 $0$ 到 $h-x$。单元的面积为 $A = h^2/2$。\n$$\n(\\mathbf{K}_{ab}^{22})_{11} = \\int_{\\Omega_e} \\frac{2Et}{h^2(1-\\nu^2)} x \\, d\\Omega = \\frac{2Et}{h^2(1-\\nu^2)} \\int_{\\Omega_e} x \\, d\\Omega\n$$\nx 在该三角形上的积分等于形心的 $x$ 坐标乘以面积。形心位于 $(\\frac{0+h+0}{3}, \\frac{0+0+h}{3}) = (\\frac{h}{3}, \\frac{h}{3})$。\n$$\n\\int_{\\Omega_e} x \\, d\\Omega = (\\text{Area}) \\times (\\bar{x}) = \\left(\\frac{h^2}{2}\\right) \\left(\\frac{h}{3}\\right) = \\frac{h^3}{6}\n$$\n将此结果代回刚度项的表达式中：\n$$\n(\\mathbf{K}_{ab}^{22})_{11} = \\frac{2Et}{h^2(1-\\nu^2)} \\left( \\frac{h^3}{6} \\right) = \\frac{2E t h^3}{6h^2(1-\\nu^2)} = \\frac{E t h}{3(1-\\nu^2)}\n$$\n质量矩阵块的构建遵循类似的过程，从一般表达式 $\\mathbf{M}_{XY} = \\int_{\\Omega_e} \\rho t (\\mathbf{N}_X)^T \\mathbf{N}_Y \\, d\\Omega$ 开始，其中 $\\mathbf{N}_X$ 和 $\\mathbf{N}_Y$ 分别是标准场和强化场的形函数的矩阵形式。\n\n关于交叉耦合项的解释：非对角块 $\\mathbf{K}_{ab}$ 和 $\\mathbf{K}_{ba}$（它是 $\\mathbf{K}_{ab}$ 的转置）表示标准自由度与强化自由度之间的能量耦合。这些项非零是因为从强化基函数 $\\boldsymbol{\\varepsilon}_b$ 导出的应变场依赖于标准形函数 $N_i$ 和强化函数 $L(\\mathbf{x})$。乘积 $(\\mathbf{B}_a)^T \\mathbf{C} \\mathbf{B}_b$ 的积分通常不为零，从而在应变能泛函中建立了标准自由度 $\\mathbf{a}$ 和强化自由度 $\\mathbf{b}$ 之间的联系。这种耦合是单位分解法的一个基本特征，确保了解的强化部分能与底层的标准有限元近似正确地相互作用。类似地，$\\mathbf{M}_{ab}$ 和 $\\mathbf{M}_{ba}$ 表示动能（或其虚功等效项）中的耦合，它们非零是因为标准基函数与强化基函数乘积的积分 $\\int N_i (N_j L) d\\Omega$ 不为零。\n\n最终要求的值是上面计算出的单个刚度项。",
            "answer": "$$\n\\boxed{\\frac{E t h}{3(1-\\nu^2)}}\n$$"
        },
        {
            "introduction": "任何一种有效的有限元列式都必须满足一个基本要求：它必须能够精确地再生一个常应变或常应力状态，这被称为“小片检验”（patch test）。本练习  将检验我们采用移位亥维赛德函数（shifted Heaviside function）富集的XFEM列式是否满足这一基本的一致性条件。通过证明对于一个常应力场，系统的残差向量精确为零，我们验证了该方法的可靠性和收敛性保证。",
            "id": "3564659",
            "problem": "考虑一个占据矩形区域 $\\Omega = [0,2L] \\times [0,H]$ 的二维小应变、线弹性、平面应力体，其中有一条与 $y = H/2$ 重合的直裂纹线 $\\Gamma_{c}$，该裂纹无牵引力，从 $x = 0$ 延伸到 $x = 2L$。该物体被划分为两个覆盖该矩形区域的线性三角形（T3）有限元：\n- 单元 $e_{1}$ 的节点为 $1:(0,0)$、$2:(2L,0)$ 和 $3:(2L,H)$。\n- 单元 $e_{2}$ 的节点为 $1:(0,0)$、$3:(2L,H)$ 和 $4:(0,H)$。\n\n设位移场通过单位分解（PoU）方法，采用仅含亥维赛（Heaviside）函数的扩展有限元法（XFEM）富集和适当的交融来进行近似。标准有限元插值由与节点 $i$ 相关联的线性形函数 $N_{i}(x,y)$ 定义，亥维赛阶跃函数 $H(y - H/2)$ 定义为：当 $y  H/2$ 时，$H(y - H/2) = +1$；当 $y  H/2$ 时，$H(y - H/2) = -1$。每个节点 $i \\in \\{1,2,3,4\\}$ 都通过一个确保正确交融的移位亥维赛富集项进行富集，因此节点 $i$ 处的富集位移贡献使用了修正后的单位分解函数 $N_{i}(x,y)\\left[H(y - H/2) - H(y_{i} - H/2)\\right]$，其中 $(x_{i},y_{i})$ 是节点 $i$ 的坐标。\n\n假设材料是均质、各向同性、线弹性的，其杨氏模量为 $E$，泊松比为 $\\nu$。精确应力场为常数，由下式给出\n$$\n\\boldsymbol{\\sigma} = \\begin{pmatrix} \\sigma_{0}  0 \\\\ 0  0 \\end{pmatrix},\n$$\n使得 $\\sigma_{xx} = \\sigma_{0}$，$\\sigma_{yy} = 0$ 且 $\\sigma_{xy} = 0$。不存在体力，即 $\\boldsymbol{b} = \\boldsymbol{0}$。在外边界 $\\partial\\Omega$ 上，施加牵引力 $\\boldsymbol{t} = \\boldsymbol{\\sigma}\\,\\boldsymbol{n}$，其中 $\\boldsymbol{n}$ 是向外的单位法向量。裂纹表面无牵引力，这与应力场 $\\boldsymbol{\\sigma}$ 和裂纹法线方向一致。\n\n以虚功原理为基本出发点，并使用上述带有 PoU 和移位亥维赛富集的离散化方法，为与以下自由度相关联的双单元区域构建组集残差（内力减外力）向量：\n- 节点 1, 2, 3, 4 处 $x$ 和 $y$ 方向的四个标准节点位移自由度，以及\n- 由仅含亥维赛函数的富集和混合产生的、在节点 1, 2, 3, 4 处 $x$ 和 $y$ 方向的四个富集节点位移自由度。\n\n将组集残差向量按以下顺序排列\n$$\n\\boldsymbol{R} = \\left( R_{u_{1}}, R_{v_{1}}, R_{u_{2}}, R_{v_{2}}, R_{u_{3}}, R_{v_{3}}, R_{u_{4}}, R_{v_{4}}, R_{a_{1x}}, R_{a_{1y}}, R_{a_{2x}}, R_{a_{2y}}, R_{a_{3x}}, R_{a_{3y}}, R_{a_{4x}}, R_{a_{4y}} \\right),\n$$\n其中 $u_{i}$ 和 $v_{i}$ 是节点 $i$ 处 $x$ 和 $y$ 方向的标准位移，而 $a_{ix}$ 和 $a_{iy}$ 是节点 $i$ 处 $x$ 和 $y$ 方向的富集位移自由度。\n\n通过计算两个单元上的必要域积分和边界积分，从第一性原理推导 $\\boldsymbol{R}$ 的每个分量的表达式，其中使用恒定应力场、零体力、牵引力边界载荷 $\\boldsymbol{t} = \\boldsymbol{\\sigma}\\,\\boldsymbol{n}$ 和无牵引力裂纹条件。在计算富集残差分量时，请仔细论证通过移位富集项 $N_{i}(x,y)\\left[H(y - H/2) - H(y_{i} - H/2)\\right]$ 实现的交融所起的作用。\n\n计算组集残差向量 $\\boldsymbol{R}$ 并给出其显式值。将每个分量以牛顿为单位表示。无需四舍五入。",
            "solution": "首先对问题进行验证，以确保其在科学上是合理的、适定的和客观的。\n\n### 步骤 1：提取已知条件\n- **域**：一个二维矩形 $\\Omega = [0,2L] \\times [0,H]$。\n- **裂纹**：一条沿 $y = H/2$ 从 $x=0$ 到 $x=2L$ 的无牵引力直裂纹 $\\Gamma_c$。\n- **离散化**：两个线性三角形（T3）单元：$e_{1}$ 的节点为 $1:(0,0)$、$2:(2L,0)$、$3:(2L,H)$；$e_{2}$ 的节点为 $1:(0,0)$、$3:(2L,H)$、$4:(0,H)$。此划分将矩形 $\\Omega$ 沿连接节点 1 $(0,0)$ 和节点 3 $(2L,H)$ 的对角线分为两个直角三角形，是一个有效的划分。\n- **位移近似（XFEM）**：\n$$ \\boldsymbol{u}^h(\\boldsymbol{x}) = \\sum_{i=1}^4 N_i(\\boldsymbol{x}) \\boldsymbol{u}_i + \\sum_{i=1}^4 N_i(\\boldsymbol{x}) \\left[ H(y - H/2) - H(y_i - H/2) \\right] \\boldsymbol{a}_i $$\n- **亥维赛函数**：当 $z0$ 时 $H(z) = +1$，当 $z0$ 时 $H(z)=-1$。裂纹位于 $y-H/2=0$。\n- **材料**：线弹性、均质、各向同性，杨氏模量为 $E$，泊松比为 $\\nu$，处于平面应力条件下。\n- **应力场**：精确应力场为常数：$\\sigma_{xx} = \\sigma_{0}$，$\\sigma_{yy} = 0$，$\\sigma_{xy} = 0$。矩阵形式为 $\\boldsymbol{\\sigma} = \\begin{pmatrix} \\sigma_{0}  0 \\\\ 0  0 \\end{pmatrix}$。\n- **载荷**：体力 $\\boldsymbol{b} = \\boldsymbol{0}$。边界 $\\partial\\Omega$ 上的牵引力为 $\\boldsymbol{t} = \\boldsymbol{\\sigma}\\boldsymbol{n}$。\n- **任务**：计算组集残差向量 $\\boldsymbol{R} = \\boldsymbol{F}^{int} - \\boldsymbol{F}^{ext}$，其分量与标准自由度（$\\boldsymbol{u}_i$）和富集自由度（$\\boldsymbol{a}_i$）相关联。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题在科学上基于计算固体力学。我们必须验证其自洽性。\n1.  **平衡**：恒定应力场 $\\boldsymbol{\\sigma}$ 的导数为零，因此由于 $\\boldsymbol{b}=\\boldsymbol{0}$，平衡方程 $\\nabla \\cdot \\boldsymbol{\\sigma} + \\boldsymbol{b} = \\boldsymbol{0}$ 得到满足。\n2.  **边界条件**：\n    - 裂纹表面（$\\Gamma_c$，位于 $y=H/2$）：法向量为 $\\boldsymbol{n}=(0, \\pm 1)$。牵引力为 $\\boldsymbol{t}_c = \\boldsymbol{\\sigma}\\boldsymbol{n} = \\begin{pmatrix} \\sigma_0  0 \\\\ 0  0 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ \\pm 1 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$。这与无牵引力裂纹条件一致。\n    - 外边界（$\\partial\\Omega$）：规定的牵引力 $\\boldsymbol{t} = \\boldsymbol{\\sigma}\\boldsymbol{n}$ 根据定义与给定的应力场一致。例如，在边界 $x=2L$ 上，$\\boldsymbol{n}=(1,0)$，因此 $\\boldsymbol{t} = (\\sigma_0, 0)^T$。在 $x=0$ 上，$\\boldsymbol{n}=(-1,0)$，因此 $\\boldsymbol{t} = (-\\sigma_0, 0)^T$。在 $y=0$ 和 $y=H$ 上，$\\boldsymbol{n}=(0,\\mp 1)$，因此 $\\boldsymbol{t} = (0,0)^T$。\n\n该问题是完全自洽的。所提供的应力场是给定几何形状和边界条件下的有效静力平衡解。该问题是一个定义明确的计算练习。\n\n### 步骤 3：结论与行动\n问题有效。我们继续进行求解。\n\n### 理论分析\n残差向量 $\\boldsymbol{R}$ 的分量为 $R_k = F_k^{int} - F_k^{ext}$，对应每个自由度 $k$。内力为 $F_k^{int} = \\int_\\Omega \\boldsymbol{\\sigma} : \\boldsymbol{\\varepsilon}(\\delta\\boldsymbol{u}_k) \\, d\\Omega$，外力为 $F_k^{ext} = \\int_{\\partial\\Omega_t} \\boldsymbol{t} \\cdot \\delta\\boldsymbol{u}_k \\, dS + \\int_\\Omega \\boldsymbol{b} \\cdot \\delta\\boldsymbol{u}_k \\, d\\Omega$。问题指定使用精确应力场 $\\boldsymbol{\\sigma}_{exact}$ 来计算内力。\n\n弱形式的虚功原理指出，对于处于平衡状态的物体，对于任何容许的虚位移 $\\delta\\boldsymbol{u}$，内力功等于外力功。在数学上，这通过分部积分（格林公式或散度定理）表示。对于可能跨越表面 $\\Gamma_c$ 不连续的虚位移场 $\\boldsymbol{v}$：\n$$ \\int_\\Omega \\boldsymbol{\\sigma} : \\nabla\\boldsymbol{v} \\, d\\Omega = \\int_{\\partial\\Omega} (\\boldsymbol{\\sigma n}) \\cdot \\boldsymbol{v} \\, dS - \\int_{\\Gamma_c} (\\boldsymbol{\\sigma n}) \\cdot [[\\boldsymbol{v}]] \\, dS - \\int_{\\Omega} (\\nabla\\cdot\\boldsymbol{\\sigma}) \\cdot \\boldsymbol{v} \\, d\\Omega $$\n其中 $[[\\boldsymbol{v}]]$ 是 $\\boldsymbol{v}$ 跨越 $\\Gamma_c$ 的跳跃量。\n\n在本问题中，$\\boldsymbol{\\sigma} = \\boldsymbol{\\sigma}_{exact}$。我们已经确定：\n- 在 $\\Omega$ 中 $\\nabla \\cdot \\boldsymbol{\\sigma}_{exact} = \\boldsymbol{0}$。\n- 在外边界 $\\partial\\Omega$ 上 $\\boldsymbol{\\sigma}_{exact}\\boldsymbol{n} = \\boldsymbol{t}$。\n- 在 $\\Gamma_c$ 上的裂纹表面牵引力 $\\boldsymbol{t}_c = \\boldsymbol{\\sigma}_{exact}\\boldsymbol{n}$ 为 $\\boldsymbol{0}$。\n- 体力 $\\boldsymbol{b} = \\boldsymbol{0}$。\n\n将这些代入恒等式，对于任何虚位移 $\\delta\\boldsymbol{u}_k = \\boldsymbol{v}$：\n$$ \\int_\\Omega \\boldsymbol{\\sigma}_{exact} : \\boldsymbol{\\varepsilon}(\\delta\\boldsymbol{u}_k) \\, d\\Omega = \\int_{\\partial\\Omega} \\boldsymbol{t} \\cdot \\delta\\boldsymbol{u}_k \\, dS - \\int_{\\Gamma_c} \\boldsymbol{0} \\cdot [[\\delta\\boldsymbol{u}_k]] \\, dS - \\int_{\\Omega} \\boldsymbol{0} \\cdot \\delta\\boldsymbol{u}_k \\, d\\Omega $$\n$$ \\implies \\int_\\Omega \\boldsymbol{\\sigma}_{exact} : \\boldsymbol{\\varepsilon}(\\delta\\boldsymbol{u}_k) \\, d\\Omega = \\int_{\\partial\\Omega} \\boldsymbol{t} \\cdot \\delta\\boldsymbol{u}_k \\, dS $$\n左侧是内力 $F_k^{int}$。右侧是外力 $F_k^{ext}$（因为 $\\boldsymbol{b}=\\boldsymbol{0}$）。\n因此，对于每个自由度 $k$，$F_k^{int} = F_k^{ext}$。这对标准和富集（不连续）的虚位移都成立。因此，残差向量 $\\boldsymbol{R} = \\boldsymbol{F}^{int} - \\boldsymbol{F}^{ext}$ 的每个分量都必须为零。\n\n然而，问题要求通过计算积分进行显式推导。我们执行此计算以验证理论结果。\n\n### 残差向量的显式计算\n\n首先，定义有限元形函数 $N_i$。\n对于单元 $e_1$（节点 $1(0,0), 2(2L,0), 3(2L,H)$），面积 $A_1 = LH$：\n$N_1^{e_1} = 1 - \\frac{x}{2L}$\n$N_2^{e_1} = \\frac{x}{2L} - \\frac{y}{H}$\n$N_3^{e_1} = \\frac{y}{H}$\n\n对于单元 $e_2$（节点 $1(0,0), 3(2L,H), 4(0,H)$），面积 $A_2 = LH$：\n$N_1^{e_2} = \\frac{1}{2A_2}[(x_3y_4-x_4y_3)+(y_3-y_4)x+(x_4-x_3)y] = \\frac{1}{2LH}[(2LH-0)+(H-H)x+(0-2L)y] = 1 - \\frac{y}{H}$。\n$N_3^{e_2} = \\frac{1}{2A_2}[(x_4y_1-x_1y_4)+(y_4-y_1)x+(x_1-x_4)y] = \\frac{1}{2LH}[0+(H-0)x+(0-0)y] = \\frac{x}{2L}$。\n$N_4^{e_2} = \\frac{1}{2A_2}[(x_1y_3-x_3y_1)+(y_1-y_3)x+(x_3-x_1)y] = \\frac{1}{2LH}[0+(0-H)x+(2L-0)y] = \\frac{y}{H} - \\frac{x}{2L}$。\n求和检验：$(1 - y/H) + (x/2L) + (y/H - x/2L) = 1$。正确。\n\n自由度 k 的虚位移是 $\\delta \\boldsymbol{u}_k$。残差是 $R_k = \\int_\\Omega \\boldsymbol{\\sigma}_{exact} : \\boldsymbol{\\varepsilon}(\\delta\\boldsymbol{u}_k) \\, d\\Omega - \\int_{\\partial\\Omega} \\boldsymbol{t} \\cdot \\delta\\boldsymbol{u}_k \\, dS$。\n\n**1. y方向自由度的残差（$R_{v_i}$ 和 $R_{a_{iy}}$）**\n对于任何y方向的自由度（标准 $v_k$ 或富集 $a_{ky}$），虚位移为 $\\delta\\boldsymbol{u} = \\phi(\\boldsymbol{x}) (0, 1)^T$，其中 $\\phi$ 是相应的基函数。\n虚应变为 $\\delta\\epsilon_{xx}=0$, $\\delta\\epsilon_{yy}=\\frac{\\partial \\phi}{\\partial y}$, $\\delta\\gamma_{xy}=\\frac{\\partial \\phi}{\\partial x}$。\n内力分量为：\n$F^{int} = \\int_\\Omega (\\sigma_{xx}\\delta\\epsilon_{xx} + \\sigma_{yy}\\delta\\epsilon_{yy} + \\sigma_{xy}\\delta\\gamma_{xy}) d\\Omega = \\int_\\Omega (\\sigma_0 \\cdot 0 + 0 \\cdot \\frac{\\partial \\phi}{\\partial y} + 0 \\cdot \\frac{\\partial \\phi}{\\partial x}) d\\Omega = 0$。\n外边界 $\\partial\\Omega$ 各部分的外牵引力分量 $t_y$ 均为零。\n$F^{ext} = \\int_{\\partial\\Omega} t_y \\phi \\, dS = 0$。\n因此，对于所有 $i \\in \\{1,2,3,4\\}$，$R_{v_i} = 0$ 且 $R_{a_{iy}} = 0$。\n\n**2. x方向标准自由度的残差（$R_{u_i}$）**\n对于标准自由度 $u_k$，$\\delta\\boldsymbol{u} = N_k(\\boldsymbol{x}) (1, 0)^T$。\n虚应变：$\\delta\\epsilon_{xx}=\\frac{\\partial N_k}{\\partial x}$, $\\delta\\epsilon_{yy}=0$, $\\delta\\gamma_{xy}=\\frac{\\partial N_k}{\\partial y}$。\n内力：$F_{u_k}^{int} = \\int_\\Omega \\sigma_0 \\frac{\\partial N_k}{\\partial x} d\\Omega = \\sigma_0 \\int_\\Omega \\frac{\\partial N_k}{\\partial x} d\\Omega$。\n外力：$F_{u_k}^{ext} = \\int_{x=2L} \\sigma_0 N_k(2L,y) dy - \\int_{x=0} \\sigma_0 N_k(0,y) dy$。\n- 对于 $k=1$：$\\frac{\\partial N_1^{e_1}}{\\partial x} = -1/(2L)$，$\\frac{\\partial N_1^{e_2}}{\\partial x}=0$。$N_1(2L,y)=0$，$N_1(0,y)=1-y/H$。\n  $F_{u_1}^{int} = \\sigma_0 \\int_{e_1} (-1/(2L)) dA = \\sigma_0 (-1/(2L)) A_1 = -\\sigma_0 H/2$。\n  $F_{u_1}^{ext} = 0 - \\int_0^H \\sigma_0 (1-y/H) dy = -\\sigma_0 [y-y^2/(2H)]_0^H = -\\sigma_0 H/2$。\n  $R_{u_1} = F_{u_1}^{int} - F_{u_1}^{ext} = 0$。\n- 对于 $k=2$：$N_2$ 仅存在于 $e_1$ 上。$\\frac{\\partial N_2^{e_1}}{\\partial x} = 1/(2L)$。$N_2(0,y)=0$，$N_2(2L,y)=1-y/H$。\n  $F_{u_2}^{int} = \\sigma_0 \\int_{e_1} (1/(2L)) dA = \\sigma_0 A_1/(2L) = \\sigma_0 H/2$。\n  $F_{u_2}^{ext} = \\int_0^H \\sigma_0 (1-y/H) dy - 0 = \\sigma_0 H/2$。\n  $R_{u_2} = F_{u_2}^{int} - F_{u_2}^{ext} = 0$。\n- 对于 $k=3$：$\\frac{\\partial N_3^{e_1}}{\\partial x} = 0$，$\\frac{\\partial N_3^{e_2}}{\\partial x}=1/(2L)$。$N_3(0,y)=0$，$N_3(2L,y)=y/H$。\n  $F_{u_3}^{int} = \\sigma_0 \\int_{e_2} (1/(2L)) dA = \\sigma_0 A_2/(2L) = \\sigma_0 H/2$。\n  $F_{u_3}^{ext} = \\int_0^H \\sigma_0 (y/H) dy - 0 = \\sigma_0 [y^2/(2H)]_0^H = \\sigma_0 H/2$。\n  $R_{u_3} = F_{u_3}^{int} - F_{u_3}^{ext} = 0$。\n- 对于 $k=4$：$N_4$ 仅存在于 $e_2$ 上。$\\frac{\\partial N_4^{e_2}}{\\partial x} = -1/(2L)$。$N_4(2L,y)=0$，$N_4(0,y)=y/H$。\n  $F_{u_4}^{int} = \\sigma_0 \\int_{e_2} (-1/(2L)) dA = -\\sigma_0 A_2/(2L) = -\\sigma_0 H/2$。\n  $F_{u_4}^{ext} = 0 - \\int_0^H \\sigma_0 (y/H) dy = -\\sigma_0 H/2$。\n  $R_{u_4} = F_{u_4}^{int} - F_{u_4}^{ext} = 0$。\n\n所有标准残差均为零。\n\n**3. x方向富集自由度的残差（$R_{a_{ix}}$）**\n对于富集自由度 $a_{kx}$，基函数为 $\\Phi_k(\\boldsymbol{x}) = N_k(\\boldsymbol{x}) \\psi_k(y)$，其中 $\\psi_k(y) = H(y-H/2) - H(y_k-H/2)$。\n内力：$F_{a_{kx}}^{int} = \\int_\\Omega \\sigma_0 \\frac{\\partial \\Phi_k}{\\partial x} d\\Omega = \\sigma_0 \\int_\\Omega \\psi_k(y) \\frac{\\partial N_k}{\\partial x} d\\Omega$。\n外力：$F_{a_{kx}}^{ext} = \\int_{x=2L} \\sigma_0 \\Phi_k(2L,y) dy - \\int_{x=0} \\sigma_0 \\Phi_k(0,y) dy$。\n\n- 对于 $k=1$（节点在 $y_1=0$）：$\\psi_1(y) = H(y-H/2) - (-1) = H(y-H/2)+1$。当 $y",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0\n\\end{pmatrix}\n}\n$$"
        }
    ]
}