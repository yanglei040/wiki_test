{
    "hands_on_practices": [
        {
            "introduction": "The foundation of the finite element method lies in the construction of element stiffness and mass matrices from the weak form of the governing equations. In the Extended Finite Element Method (XFEM), this process is complicated by the introduction of enriched basis functions. This first practice provides direct, hands-on experience in deriving these matrices for an element with a partition-of-unity enrichment, clarifying how the product rule for differentiation gives rise to the essential cross-coupling terms that link standard and enriched degrees of freedom. ",
            "id": "3564597",
            "problem": "Consider a single two-dimensional linear triangular finite element under plane stress with nodes at coordinates $(0,0)$, $(h,0)$, and $(0,h)$, with uniform thickness $t$, Young’s modulus $E$, Poisson’s ratio $\\nu$, and mass density $\\rho$. Adopt the partition-of-unity enriched approximation of the displacement field\n$$\nu_h(\\mathbf{x})=\\sum_{i=1}^{3} N_i(\\mathbf{x})\\,\\mathbf{a}_i \\;+\\; \\sum_{i=1}^{3} N_i(\\mathbf{x})\\,L(\\mathbf{x})\\,\\mathbf{b}_i,\n$$\nwhere $N_i(\\mathbf{x})$ are the standard linear shape functions, $\\mathbf{a}_i=\\begin{pmatrix}a_{i}^{u}\\\\ a_{i}^{v}\\end{pmatrix}$ are the standard nodal degrees of freedom for displacement components, $\\mathbf{b}_i=\\begin{pmatrix}b_{i}^{u}\\\\ b_{i}^{v}\\end{pmatrix}$ are the enriched nodal degrees of freedom, and the enrichment function is $L(\\mathbf{x})=x$. Use the standard weak form of linear elastostatics with the constitutive law for isotropic plane stress,\n$$\n\\boldsymbol{\\sigma} = \\mathbf{C}\\,\\boldsymbol{\\varepsilon}, \\quad \\mathbf{C}=\\frac{E}{1-\\nu^2}\\begin{pmatrix}1  \\nu  0\\\\ \\nu  1  0\\\\ 0  0  \\frac{1-\\nu}{2}\\end{pmatrix}.\n$$\nThe small-strain operator applied to a displacement vector field $\\mathbf{u}=(u,v)^{\\mathsf{T}}$ is\n$$\n\\boldsymbol{\\varepsilon}(\\mathbf{u}) = \\begin{pmatrix}\\partial u/\\partial x\\\\ \\partial v/\\partial y\\\\ \\partial u/\\partial y + \\partial v/\\partial x\\end{pmatrix}.\n$$\nFor the consistent element mass matrix, use the standard $L^2$ inner product over the element domain $\\Omega_e$.\n\nTasks:\n- Starting from the weak form and the above definitions, construct the element-level consistent mass matrix and stiffness matrix for this enriched approximation. Explicitly identify the block partitions $(\\mathbf{K}_{aa},\\mathbf{K}_{ab},\\mathbf{K}_{bb})$ and $(\\mathbf{M}_{aa},\\mathbf{M}_{ab},\\mathbf{M}_{bb})$ corresponding to the standard-to-standard, standard-to-enriched, and enriched-to-enriched couplings, respectively. Clearly specify the shape-function gradients and the strain-displacement matrices used for both the standard and enriched fields, and evaluate the domain integrals exactly over $\\Omega_e$.\n- Interpret which sub-blocks embody the cross-coupling between standard and enriched degrees of freedom and explain briefly why these terms appear.\n\nAnswer specification:\n- As your final reported value, provide the closed-form analytical expression for the single stiffness entry that couples the standard $u$-component at node $2$ with the enriched $u$-component at node $2$, i.e., the $(2u,2u)$ entry of $\\mathbf{K}_{ab}$, expressed in terms of $E$, $\\nu$, $t$, and $h$ only.\n- Do not include units in the final answer. No rounding is required.",
            "solution": "The displacement field $\\mathbf{u}_h(\\mathbf{x})$ is composed of a standard part and an enriched part:\n$$\n\\mathbf{u}_h(\\mathbf{x}) = \\mathbf{u}_a(\\mathbf{x}) + \\mathbf{u}_b(\\mathbf{x}) = \\sum_{i=1}^{3} N_i(\\mathbf{x}) \\mathbf{a}_i + \\sum_{i=1}^{3} N_i(\\mathbf{x}) L(\\mathbf{x}) \\mathbf{b}_i\n$$\nThe element stiffness matrix $\\mathbf{K}_e$ has a $2 \\times 2$ block structure corresponding to the standard ($\\mathbf{a}$) and enriched ($\\mathbf{b}$) degrees of freedom:\n$$\n\\mathbf{K}_e = \\begin{pmatrix} \\mathbf{K}_{aa}  \\mathbf{K}_{ab} \\\\ \\mathbf{K}_{ba}  \\mathbf{K}_{bb} \\end{pmatrix}\n$$\nA generic sub-block is given by $\\mathbf{K}_{XY} = \\int_{\\Omega_e} t (\\mathbf{B}_X)^T \\mathbf{C} \\mathbf{B}_Y \\, d\\Omega$, where $\\mathbf{B}_X$ is the strain-displacement matrix for the corresponding part of the approximation.\n\nFor the standard part, the strain-displacement matrix for node $i$ is:\n$$\n\\mathbf{B}_{a,i} = \\begin{pmatrix} \\frac{\\partial N_i}{\\partial x}  0 \\\\ 0  \\frac{\\partial N_i}{\\partial y} \\\\ \\frac{\\partial N_i}{\\partial y}  \\frac{\\partial N_i}{\\partial x} \\end{pmatrix}\n$$\nFor the enriched part, the basis functions are $\\Phi_i(\\mathbf{x}) = N_i(\\mathbf{x})L(\\mathbf{x})$. With the enrichment $L(\\mathbf{x}) = x$, the derivatives are found using the product rule:\n$$\n\\frac{\\partial \\Phi_i}{\\partial x} = \\frac{\\partial (N_i x)}{\\partial x} = \\frac{\\partial N_i}{\\partial x} x + N_i, \\quad \\frac{\\partial \\Phi_i}{\\partial y} = \\frac{\\partial (N_i x)}{\\partial y} = \\frac{\\partial N_i}{\\partial y} x\n$$\nThis gives the strain-displacement matrix for the enriched DOFs at node $i$:\n$$\n\\mathbf{B}_{b,i} = \\begin{pmatrix} \\frac{\\partial \\Phi_i}{\\partial x}  0 \\\\ 0  \\frac{\\partial \\Phi_i}{\\partial y} \\\\ \\frac{\\partial \\Phi_i}{\\partial y}  \\frac{\\partial \\Phi_i}{\\partial x} \\end{pmatrix} = \\begin{pmatrix} \\frac{\\partial N_i}{\\partial x} x + N_i  0 \\\\ 0  \\frac{\\partial N_i}{\\partial y} x \\\\ \\frac{\\partial N_i}{\\partial y} x  \\frac{\\partial N_i}{\\partial x} x + N_i \\end{pmatrix}\n$$\nWe need the stiffness entry coupling the standard $u$-component at node $2$, $a_{2u}$, with the enriched $u$-component at node $2$, $b_{2u}$. This is the $(1,1)$ entry of the $2 \\times 2$ sub-block matrix $\\mathbf{K}_{ab}^{22}$, which couples DOFs $\\mathbf{a}_2$ and $\\mathbf{b}_2$.\n$$\n(\\mathbf{K}_{ab}^{22})_{11} = \\int_{\\Omega_e} t \\, (\\text{col } 1 \\text{ of } \\mathbf{B}_{a,2})^T \\mathbf{C} (\\text{col } 1 \\text{ of } \\mathbf{B}_{b,2}) \\, d\\Omega\n$$\nThe element nodes are at $(0,0)$, $(h,0)$, and $(0,h)$. The linear shape function for node 2 is $N_2(x,y) = \\frac{x}{h}$, with constant gradients $\\frac{\\partial N_2}{\\partial x} = \\frac{1}{h}$ and $\\frac{\\partial N_2}{\\partial y} = 0$.\n\nThe required vectors are:\n$$\n(\\text{col } 1 \\text{ of } \\mathbf{B}_{a,2})^T = \\begin{pmatrix} \\frac{\\partial N_2}{\\partial x}  0  \\frac{\\partial N_2}{\\partial y} \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{h}  0  0 \\end{pmatrix}\n$$\n$$\n(\\text{col } 1 \\text{ of } \\mathbf{B}_{b,2}) = \\begin{pmatrix} \\frac{\\partial N_2}{\\partial x} x + N_2 \\\\ 0 \\\\ \\frac{\\partial N_2}{\\partial y} x \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{h} x + \\frac{x}{h} \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} \\frac{2x}{h} \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\nThe integrand involves only the $(1,1)$ component of $\\mathbf{C}$, which is $C_{11} = \\frac{E}{1-\\nu^2}$:\n$$\n\\text{Integrand} = t \\left( \\frac{1}{h} \\right) C_{11} \\left( \\frac{2x}{h} \\right) = \\frac{2Et}{h^2(1-\\nu^2)} x\n$$\nWe integrate this expression over the triangular domain $\\Omega_e$. The integral of $x$ over a domain is the product of the domain's area and the $x$-coordinate of its centroid.\nThe element's area is $A = \\frac{1}{2}h^2$.\nThe centroid's coordinates are $(\\bar{x}, \\bar{y}) = (\\frac{0+h+0}{3}, \\frac{0+0+h}{3}) = (\\frac{h}{3}, \\frac{h}{3})$.\nThus, $\\int_{\\Omega_e} x \\, d\\Omega = A \\cdot \\bar{x} = \\left(\\frac{h^2}{2}\\right) \\left(\\frac{h}{3}\\right) = \\frac{h^3}{6}$.\n\nSubstituting this result into the expression for the stiffness entry:\n$$\n(\\mathbf{K}_{ab}^{22})_{11} = \\frac{2Et}{h^2(1-\\nu^2)} \\int_{\\Omega_e} x \\, d\\Omega = \\frac{2Et}{h^2(1-\\nu^2)} \\left( \\frac{h^3}{6} \\right) = \\frac{E t h}{3(1-\\nu^2)}\n$$\nThe off-diagonal blocks $\\mathbf{K}_{ab}$ and $\\mathbf{K}_{ba}$ represent the energetic coupling between the standard and enriched degrees of freedom. They are non-zero because the strain from the enriched basis functions, $\\boldsymbol{\\varepsilon}_b$, depends on both the standard shape functions $N_i$ and the enrichment function $L(\\mathbf{x})$. The integral of $(\\mathbf{B}_a)^T \\mathbf{C} \\mathbf{B}_b$ is therefore non-zero, creating a link between the standard and enriched DOFs. This coupling is fundamental to the partition-of-unity method.",
            "answer": "$$\n\\boxed{\\frac{E t h}{3(1-\\nu^2)}}\n$$"
        },
        {
            "introduction": "Once the theoretical expressions for element matrices are derived, they must be computed via numerical integration. When modeling cracks with a discontinuous Heaviside function, the integrand within the stiffness matrix integrals becomes discontinuous, rendering standard Gaussian quadrature schemes inaccurate. This exercise demonstrates the standard XFEM solution to this critical implementation challenge: partitioning the element along the discontinuity into smooth subdomains and applying quadrature to each part separately, a cornerstone technique for accurately modeling strong discontinuities. ",
            "id": "3564628",
            "problem": "Consider a single four-node bilinear quadrilateral finite element occupying the physical domain $[0,1]\\times[0,1]$ in the plane with nodal coordinates $(0,0)$, $(1,0)$, $(1,1)$, $(0,1)$. Let $N_1(x,y)=(1-x)(1-y)$ denote the node-$1$ shape function of this element. An interface is described by the level set $\\phi(x,y)=y-(\\alpha+\\beta x)$ with constants $\\alpha=2/5$ and $\\beta=1/5$, so that the zero level set $\\Gamma=\\{(x,y):\\phi(x,y)=0\\}$ is the straight line segment from $(0,2/5)$ to $(1,3/5)$ cutting the element into two subdomains $\\Omega^{+}=\\{(x,y):\\phi(x,y)\\ge 0\\}$ and $\\Omega^{-}=\\{(x,y):\\phi(x,y)0\\}$. Define the Heaviside enrichment $H(\\phi)$ by $H(\\phi)=+1$ in $\\Omega^{+}$ and $H(\\phi)=-1$ in $\\Omega^{-}$.\n\nIn the extended finite element method (XFEM) with partition of unity, enriched trial and test functions containing $H(\\phi)$ are treated in the weak form by integrating piecewise on $\\Omega^{+}$ and $\\Omega^{-}$, using exact Gaussian quadrature rules on each subdomain. Starting from the product rule for distributions and the piecewise-constant nature of $H(\\phi)$ off the interface, adopt the standard XFEM volumetric treatment that neglects the distributional interface contribution in $\\nabla\\!\\left(N_1 H(\\phi)\\right)$ and replaces $\\nabla\\!\\left(N_1 H(\\phi)\\right)$ by $H(\\phi)\\nabla N_1$ within $\\Omega^{+}\\cup\\Omega^{-}$.\n\nPartition the cut element into the two polygons $\\Omega^{+}$ and $\\Omega^{-}$ and, in each polygon, apply a triangulation and a Gaussian quadrature that is exact for polynomials of total degree one on triangles. Using this procedure, compute the scalar integral\n$$\nI_x \\;=\\; \\int_{\\Omega_e} \\frac{\\partial}{\\partial x}\\!\\left(N_1(x,y)\\,H(\\phi(x,y))\\right)\\,\\mathrm{d}\\Omega,\n$$\nwhere $\\Omega_e=[0,1]\\times[0,1]$ is the element domain. Report the exact value of $I_x$ as a single number with no units. If intermediate numerical evaluation is used, ensure the final answer is exact; no rounding is required.",
            "solution": "The integral to be computed is $I_x = \\int_{\\Omega_e} \\frac{\\partial}{\\partial x}\\!\\left(N_1(x,y)\\,H(\\phi(x,y))\\right)\\,\\mathrm{d}\\Omega$.\nThe problem specifies the standard XFEM approximation for the derivative of the enriched function product: $\\frac{\\partial}{\\partial x}(N_1 H(\\phi)) \\approx H(\\phi) \\frac{\\partial N_1}{\\partial x}$.\nThe shape function for node 1 is $N_1(x,y) = (1-x)(1-y)$, so its partial derivative with respect to $x$ is $\\frac{\\partial N_1}{\\partial x} = -(1-y) = y-1$.\nThe integral becomes:\n$$\nI_x \\approx \\int_{\\Omega_e} H(\\phi(x,y)) (y-1) \\,\\mathrm{d}\\Omega\n$$\nThe domain $\\Omega_e = [0,1] \\times [0,1]$ is partitioned by the interface $y = \\frac{1}{5}x + \\frac{2}{5}$. The function $H(\\phi)$ is defined as $+1$ on $\\Omega^+$ (above the line) and $-1$ on $\\Omega^-$ (below the line). The integral is split into two parts:\n$$\nI_x = \\int_{\\Omega^+} (+1)(y-1) \\,\\mathrm{d}\\Omega + \\int_{\\Omega^-} (-1)(y-1) \\,\\mathrm{d}\\Omega = \\int_{\\Omega^+} (y-1) \\,\\mathrm{d}\\Omega - \\int_{\\Omega^-} (y-1) \\,\\mathrm{d}\\Omega\n$$\nThe integrand $f(x,y) = y-1$ is a linear polynomial. The problem specifies a quadrature rule on a triangular mesh that is exact for such functions. The one-point rule at the centroid of a triangle $T$ provides the exact integral: $\\int_T f(x,y) \\,\\mathrm{d}A = A(T) \\cdot f(x_c, y_c)$, where $A(T)$ is the area and $(x_c, y_c)$ is the centroid. We triangulate the polygonal subdomains $\\Omega^+$ and $\\Omega^-$ and apply this rule.\n\n**Integration over $\\Omega^+$**\nThe subdomain $\\Omega^+$ is a quadrilateral with vertices $(0, 2/5)$, $(0,1)$, $(1,1)$, and $(1, 3/5)$. We split it into two triangles.\n-   $T_1^+$: vertices $(0, 2/5)$, $(0,1)$, $(1,1)$.\n    Area $A(T_1^+) = \\frac{1}{2} \\cdot \\text{base} \\cdot \\text{height} = \\frac{1}{2} (1 - 2/5) \\cdot 1 = 3/10$.\n    Centroid $C_1^+ = (\\frac{0+0+1}{3}, \\frac{2/5+1+1}{3}) = (1/3, 4/5)$.\n    Integral: $A(T_1^+) \\cdot (y_c - 1) = \\frac{3}{10} \\cdot (\\frac{4}{5} - 1) = \\frac{3}{10} \\cdot (-\\frac{1}{5}) = -3/50$.\n-   $T_2^+$: vertices $(0, 2/5)$, $(1,1)$, $(1, 3/5)$.\n    Area $A(T_2^+) = 1/5$.\n    Centroid $C_2^+ = (\\frac{0+1+1}{3}, \\frac{2/5+1+3/5}{3}) = (2/3, 2/3)$.\n    Integral: $A(T_2^+) \\cdot (y_c - 1) = \\frac{1}{5} \\cdot (\\frac{2}{3} - 1) = \\frac{1}{5} \\cdot (-\\frac{1}{3}) = -1/15$.\nThe total integral over $\\Omega^+$ is: $\\int_{\\Omega^+} (y-1) \\,\\mathrm{d}\\Omega = -3/50 - 1/15 = -9/150 - 10/150 = -19/150$.\n\n**Integration over $\\Omega^-$**\nThe subdomain $\\Omega^-$ is a quadrilateral with vertices $(0,0)$, $(1,0)$, $(1, 3/5)$, and $(0, 2/5)$. We split it into two triangles.\n-   $T_1^-$: vertices $(0,0)$, $(1,0)$, $(0, 2/5)$.\n    Area $A(T_1^-) = \\frac{1}{2} \\cdot 1 \\cdot (2/5) = 1/5$.\n    Centroid $C_1^- = (\\frac{0+1+0}{3}, \\frac{0+0+2/5}{3}) = (1/3, 2/15)$.\n    Integral: $A(T_1^-) \\cdot (y_c - 1) = \\frac{1}{5} \\cdot (\\frac{2}{15} - 1) = \\frac{1}{5} \\cdot (-\\frac{13}{15}) = -13/75$.\n-   $T_2^-$: vertices $(1,0)$, $(1, 3/5)$, $(0, 2/5)$.\n    Area $A(T_2^-) = 3/10$.\n    Centroid $C_2^- = (\\frac{1+1+0}{3}, \\frac{0+3/5+2/5}{3}) = (2/3, 1/3)$.\n    Integral: $A(T_2^-) \\cdot (y_c - 1) = \\frac{3}{10} \\cdot (\\frac{1}{3} - 1) = \\frac{3}{10} \\cdot (-\\frac{2}{3}) = -1/5$.\nThe total integral over $\\Omega^-$ is: $\\int_{\\Omega^-} (y-1) \\,\\mathrm{d}\\Omega = -13/75 - 1/5 = -13/75 - 15/75 = -28/75$.\n\n**Final Calculation**\nFinally, we compute $I_x$:\n$$\nI_x = \\int_{\\Omega^+} (y-1) \\,\\mathrm{d}\\Omega - \\int_{\\Omega^-} (y-1) \\,\\mathrm{d}\\Omega = \\left(-\\frac{19}{150}\\right) - \\left(-\\frac{28}{75}\\right)\n$$\n$$\nI_x = -\\frac{19}{150} + \\frac{28}{75} = -\\frac{19}{150} + \\frac{56}{150} = \\frac{37}{150}\n$$",
            "answer": "$$\n\\boxed{\\frac{37}{150}}\n$$"
        },
        {
            "introduction": "After formulation and implementation, any new finite element must be verified to ensure its correctness and reliability. The patch test is a fundamental benchmark that verifies if the discrete model can exactly reproduce a simple, constant state of stress and strain, a necessary condition for convergence. This exercise guides you through performing a patch test for an XFEM model of a crack, demonstrating why standard enrichment can fail in \"blending\" elements and how a properly \"shifted\" enrichment function restores consistency, ensuring the method passes this crucial test. ",
            "id": "3564659",
            "problem": "Consider a two-dimensional small-strain, linear-elastic, plane-stress body occupying the rectangle $\\Omega = [0,2L] \\times [0,H]$, with a straight, traction-free crack line $\\Gamma_{c}$ coincident with $y = H/2$ and extending from $x = 0$ to $x = 2L$. The body is partitioned into two linear triangular ($T3$) finite elements that cover the rectangle:\n- Element $e_{1}$ has nodes $1:(0,0)$, $2:(2L,0)$, and $3:(2L,H)$.\n- Element $e_{2}$ has nodes $1:(0,0)$, $3:(2L,H)$, and $4:(0,H)$.\n\nLet the displacement field be approximated using the Partition of Unity (PoU) with Heaviside-only extended finite element method (XFEM) enrichment and proper blending. Define the standard finite element interpolation by the linear shape functions $N_{i}(x,y)$ associated with node $i$, and the Heaviside step function $H(y - H/2)$ such that $H(y - H/2) = +1$ for $y  H/2$ and $H(y - H/2) = -1$ for $y  H/2$. Each node $i \\in \\{1,2,3,4\\}$ is enriched with a shifted Heaviside enrichment that ensures correct blending, so the enriched displacement contribution at node $i$ uses the corrected partition-of-unity function $N_{i}(x,y)\\left[H(y - H/2) - H(y_{i} - H/2)\\right]$, where $(x_{i},y_{i})$ is the coordinate of node $i$.\n\nAssume the material is homogeneous, isotropic, and linear elastic, with Young’s modulus $E$ and Poisson’s ratio $\\nu$. The exact stress field is constant and given by\n$$\n\\boldsymbol{\\sigma} = \\begin{pmatrix} \\sigma_{0}  0 \\\\ 0  0 \\end{pmatrix},\n$$\nso that $\\sigma_{xx} = \\sigma_{0}$, $\\sigma_{yy} = 0$, and $\\sigma_{xy} = 0$. Body forces are absent, i.e., $\\boldsymbol{b} = \\boldsymbol{0}$. On the external boundary $\\partial\\Omega$, apply tractions $\\boldsymbol{t} = \\boldsymbol{\\sigma}\\,\\boldsymbol{n}$, where $\\boldsymbol{n}$ is the outward unit normal, and the crack faces are traction-free, consistent with $\\boldsymbol{\\sigma}$ and the crack normal.\n\nUsing the principle of virtual work as the fundamental starting point, and the above discretization with PoU and shifted Heaviside enrichment, construct the assembled residual (internal minus external) vector for the two-element patch associated with:\n- the four standard nodal displacement degrees of freedom in $x$ and $y$ at nodes $1,2,3,4$, and\n- the four enriched nodal displacement degrees of freedom in $x$ and $y$ at nodes $1,2,3,4$ due to the Heaviside-only enrichment and blending.\n\nOrder the assembled residual vector as\n$$\n\\boldsymbol{R} = \\left( R_{u_{1}}, R_{v_{1}}, R_{u_{2}}, R_{v_{2}}, R_{u_{3}}, R_{v_{3}}, R_{u_{4}}, R_{v_{4}}, R_{a_{1x}}, R_{a_{1y}}, R_{a_{2x}}, R_{a_{2y}}, R_{a_{3x}}, R_{a_{3y}}, R_{a_{4x}}, R_{a_{4y}} \\right),\n$$\nwhere $u_{i}$ and $v_{i}$ are the standard $x$- and $y$-direction displacements at node $i$, and $a_{ix}$ and $a_{iy}$ are the enriched $x$- and $y$-direction displacement degrees of freedom at node $i$.\n\nDerive from first principles the expressions for each component of $\\boldsymbol{R}$ by evaluating the necessary domain and boundary integrals over the two elements, using the constant stress field, zero body forces, traction boundary loading $\\boldsymbol{t} = \\boldsymbol{\\sigma}\\,\\boldsymbol{n}$, and traction-free crack. Carefully justify the role of blending through the shifted enrichment $N_{i}(x,y)\\left[H(y - H/2) - H(y_{i} - H/2)\\right]$ in the evaluation of the enriched residual components.\n\nCompute the assembled residual vector $\\boldsymbol{R}$ and provide its explicit value. Express each component in Newtons. No rounding is required.",
            "solution": "The problem asks for the assembled residual vector $\\boldsymbol{R} = \\boldsymbol{F}^{int} - \\boldsymbol{F}^{ext}$ for a two-element patch test. The test setup is consistent: the constant stress field $\\boldsymbol{\\sigma}_{exact} = \\begin{pmatrix} \\sigma_0  0 \\\\ 0  0 \\end{pmatrix}$ is in equilibrium ($\\nabla\\cdot\\boldsymbol{\\sigma}=\\boldsymbol{0}$), and the applied boundary tractions $\\boldsymbol{t} = \\boldsymbol{\\sigma}_{exact}\\boldsymbol{n}$ are consistent with this stress field.\n\nThe Principle of Virtual Work states that for any admissible virtual displacement field $\\delta\\boldsymbol{u}$, the internal virtual work must equal the external virtual work for a body in equilibrium. For a degree of freedom $k$, with corresponding basis function $\\phi_k$, the virtual displacement is $\\delta\\boldsymbol{u}_k = \\phi_k \\boldsymbol{e}$, where $\\boldsymbol{e}$ is a unit vector.\n- The internal force component is $F_k^{int} = \\int_\\Omega \\boldsymbol{\\sigma}_{exact} : \\boldsymbol{\\varepsilon}(\\delta\\boldsymbol{u}_k) \\, d\\Omega$.\n- The external force component is $F_k^{ext} = \\int_{\\partial\\Omega} \\boldsymbol{t} \\cdot \\delta\\boldsymbol{u}_k \\, dS + \\int_\\Omega \\boldsymbol{b} \\cdot \\delta\\boldsymbol{u}_k \\, d\\Omega$.\n\nBy the divergence theorem (integration by parts), and since $\\nabla\\cdot\\boldsymbol{\\sigma}_{exact}=\\boldsymbol{0}$, $\\boldsymbol{b}=\\boldsymbol{0}$, and tractions on the crack face are zero:\n$$\nF_k^{int} = \\int_\\Omega \\boldsymbol{\\sigma}_{exact} : \\nabla(\\delta\\boldsymbol{u}_k) \\, d\\Omega = \\int_{\\partial\\Omega} (\\boldsymbol{\\sigma}_{exact}\\boldsymbol{n}) \\cdot \\delta\\boldsymbol{u}_k \\, dS = \\int_{\\partial\\Omega} \\boldsymbol{t} \\cdot \\delta\\boldsymbol{u}_k \\, dS = F_k^{ext}\n$$\nThis identity holds for any admissible virtual displacement, including the standard and enriched basis functions used in the XFEM approximation. Therefore, the internal and external forces for each degree of freedom must be equal, and every component of the residual vector $\\boldsymbol{R}$ must be zero. This signifies that the patch test is passed.\n\nAn explicit calculation confirms this result.\n\n**1. Residuals for y-direction DOFs ($R_{v_i}$ and $R_{a_{iy}}$)**\nFor any y-direction DOF, the virtual displacement is $\\delta\\boldsymbol{u} = \\phi(\\boldsymbol{x}) (0, 1)^T$. The corresponding virtual strains are $\\delta\\epsilon_{xx}=0$, $\\delta\\epsilon_{yy}=\\frac{\\partial \\phi}{\\partial y}$, and $\\delta\\gamma_{xy}=\\frac{\\partial \\phi}{\\partial x}$.\nThe internal force is $F^{int} = \\int_\\Omega (\\sigma_{xx}\\delta\\epsilon_{xx} + \\sigma_{yy}\\delta\\epsilon_{yy} + \\sigma_{xy}\\delta\\gamma_{xy}) d\\Omega = \\int_\\Omega (\\sigma_0 \\cdot 0 + 0 + 0) d\\Omega = 0$.\nThe external traction component $t_y$ is zero on all parts of the external boundary $\\partial\\Omega$, so $F^{ext} = \\int_{\\partial\\Omega} t_y \\phi \\, dS = 0$.\nThus, $R_{v_i} = 0$ and $R_{a_{iy}} = 0$ for all $i \\in \\{1,2,3,4\\}$.\n\n**2. Residuals for x-direction Standard DOFs ($R_{u_i}$)**\nFor a standard DOF $u_k$, $\\delta\\boldsymbol{u} = N_k(\\boldsymbol{x}) (1, 0)^T$. The virtual strains are $\\delta\\epsilon_{xx}=\\frac{\\partial N_k}{\\partial x}$, $\\delta\\epsilon_{yy}=0$, and $\\delta\\gamma_{xy}=\\frac{\\partial N_k}{\\partial y}$.\nInternal force: $F_{u_k}^{int} = \\int_\\Omega \\sigma_0 \\frac{\\partial N_k}{\\partial x} d\\Omega$.\nExternal force: $F_{u_k}^{ext} = \\int_{x=2L} \\sigma_0 N_k(2L,y) dy - \\int_{x=0} \\sigma_0 N_k(0,y) dy$.\nBy applying the divergence theorem to the internal force integral:\n$F_{u_k}^{int} = \\int_\\Omega \\frac{\\partial}{\\partial x}(\\sigma_0 N_k) d\\Omega = \\int_{\\partial\\Omega} (\\sigma_0 N_k) n_x dS$.\nThis is exactly the expression for $F_{u_k}^{ext}$, as $t_x = \\sigma_0 n_x$ on the boundary. Therefore, $F_{u_k}^{int} = F_{u_k}^{ext}$, and $R_{u_i} = 0$ for all $i$.\n\n**3. Residuals for x-direction Enriched DOFs ($R_{a_{ix}}$)**\nFor an enriched DOF $a_{kx}$, the basis function is $\\Phi_k(\\boldsymbol{x}) = N_k(\\boldsymbol{x}) \\psi_k(y)$, where $\\psi_k(y) = H(y-H/2) - H(y_k-H/2)$.\nInternal force: $F_{a_{kx}}^{int} = \\int_\\Omega \\sigma_0 \\frac{\\partial \\Phi_k}{\\partial x} d\\Omega = \\int_\\Omega \\sigma_0 \\psi_k(y) \\frac{\\partial N_k}{\\partial x} d\\Omega$.\nExternal force: $F_{a_{kx}}^{ext} = \\int_{\\partial\\Omega} (\\sigma_0 n_x) \\Phi_k(\\boldsymbol{x}) dS$.\nThe enrichment $\\psi_k(y)$ is a piecewise constant function of $y$ only.\n$F_{a_{kx}}^{int} = \\int_\\Omega \\frac{\\partial}{\\partial x}(\\sigma_0 N_k \\psi_k) d\\Omega = \\int_{\\partial\\Omega} (\\sigma_0 N_k \\psi_k) n_x dS = F_{a_{kx}}^{ext}$.\nTherefore, $R_{a_{ix}} = 0$ for all $i$.\n\nThe \"shifted\" or \"blended\" enrichment is crucial for the method to be able to exactly reproduce a constant strain state, which is the condition being tested. Without this correction, the standard and enriched basis functions would not be linearly independent on the entire domain, and the approximation space could not represent the simple linear displacement field corresponding to the constant stress state, causing the patch test to fail. With the correct blending, the test passes, and the residual is zero.\n\nAll 16 components of the assembled residual vector $\\boldsymbol{R}$ are zero.\n$$\n\\boldsymbol{R} = (0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)\n$$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0\n\\end{pmatrix}\n}\n$$"
        }
    ]
}