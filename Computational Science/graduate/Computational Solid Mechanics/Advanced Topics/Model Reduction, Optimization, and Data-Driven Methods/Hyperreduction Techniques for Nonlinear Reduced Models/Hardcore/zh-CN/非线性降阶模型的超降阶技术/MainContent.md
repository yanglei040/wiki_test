## 引言
在现代[计算力学](@entry_id:174464)中，[降阶模型](@entry_id:754172)（Reduced-Order Models, ROMs）已成为模拟大规模复杂系统的一种强大工具。通过将高维状态空间投影到一个低维[子空间](@entry_id:150286)，ROMs能够在保持可接[受精](@entry_id:274949)度的同时，极大地降低线性问题的计算成本。然而，当面对[材料非线性](@entry_id:162855)、几何[大变形](@entry_id:167243)或接触等[非线性](@entry_id:637147)问题时，这种计算优势常常会丧失。其根源在于，即使在低维空间求解，模型仍然需要评估依赖于完整高维网格的[非线性](@entry_id:637147)力向量，导致计算成本与原始[全阶模型](@entry_id:171001)（FOM）的规模挂钩，从而形成了一个难以逾越的“计算瓶颈”。

为了解决这一根本性难题，超缩减（Hyperreduction）技术应运而生。它旨在通过构建一个廉价而精确的[非线性](@entry_id:637147)项近似，彻底切断降阶模型在线计算成本与[全阶模型](@entry_id:171001)规模之间的依赖关系，从而释放ROMs在[非线性](@entry_id:637147)领域的全部潜力。本文将系统性地探讨超缩减技术的理论、方法与应用。在“原理与机制”一章中，我们将深入剖析[非线性](@entry_id:637147)ROMs的计算瓶颈，并介绍超缩减的通用原理以及[离散经验插值法](@entry_id:748503)（DEIM）和[能量守恒](@entry_id:140514)采样与加权（ECSW）等核心机制。随后，在“应用与交叉学科联系”一章中，我们将展示这些技术如何应用于复杂的[非线性固体力学](@entry_id:171757)问题，并讨论其在[参数优化](@entry_id:151785)及与数据科学融合等前沿领域的角色。最后，“动手实践”部分将提供一系列精心设计的问题，帮助读者巩固理论知识并掌握实践中的关键权衡。

## 原理与机制

### [非线性降阶模型](@entry_id:172252)中的计算瓶颈

[基于投影的降阶模型](@entry_id:753809)（ROMs）为降低大规模计算力学问题的维度提供了一个强大的框架。其基本假设 (ansatz) 是将节点位移的高维状态向量 $u \in \mathbb{R}^{n}$ 近似为少量[基向量](@entry_id:199546)的线性组合。这些[基向量](@entry_id:199546)构成了降阶基矩阵 $\Phi \in \mathbb{R}^{n \times r}$（其中 $r \ll n$）的列，张成一个低维试探[子空间](@entry_id:150286)。因此，该近似可写作：

$u \approx \Phi q$

其中 $q \in \mathbb{R}^{r}$ 是降阶[坐标向量](@entry_id:153319)。

[全阶模型](@entry_id:171001)（FOM）的控制方程代表了平衡关系，其形式为一个[非线性](@entry_id:637147)代数方程组 $r(u) = 0$，其中 $r(u) \in \mathbb{R}^{n}$ 是[残差向量](@entry_id:165091)。对于一个静态问题，这通常是 $r(u) = f_{\text{ext}} - f_{\text{int}}(u)$，其中 $f_{\text{ext}}$ 是外力向量，$f_{\text{int}}(u)$ 是依赖于状态的[内力向量](@entry_id:750751)。为了推导ROM的控制方程，我们采用[加权残差法](@entry_id:140285)。最常见的方法是**[伽辽金投影](@entry_id:145611)**，即要求近似解的残差 $r(\Phi q)$ 与试探[子空间](@entry_id:150286)自身正交。这通过左乘基矩阵的[转置](@entry_id:142115)来实现：

$\Phi^{T} r(\Phi q) = 0$

这就为 $q$ 中 $r$ 个未知的降阶坐标创建了一个小型的非线性方程组。在一个更普适的**[彼得罗夫-伽辽金](@entry_id:174072)**框架中，测试[子空间](@entry_id:150286)可以不同于试探[子空间](@entry_id:150286)，由测试基 $W \in \mathbb{R}^{n \times r}$ 的列向量张成，从而得到条件 $W^{T} r(\Phi q) = 0$。当 $W = \Phi$ 时，该方法退化为伽辽金方法。

对于[线性系统](@entry_id:147850)，其中 $f_{\text{int}}(u) = K u$，$K$ 为常数[刚度矩阵](@entry_id:178659)，这个过程非常高效。降阶系统变为 $(\Phi^{T} K \Phi) q = \Phi^{T} f_{\text{ext}}$，其中降阶矩阵 $\Phi^{T} K \Phi \in \mathbb{R}^{r \times r}$ 和 $\Phi^{T} f_{\text{ext}} \in \mathbb{R}^{r}$ 可以预先计算，使得在线计算成本仅依赖于小维度 $r$。

然而，对于[非线性](@entry_id:637147)问题，这种效率便不复存在。核心挑战在于降阶[非线性](@entry_id:637147)[内力向量](@entry_id:750751) $\Phi^{T} f_{\text{int}}(\Phi q)$ 的评估。尽管最终的向量维度很小（为 $r$），但其计算首先需要评估当前状态下全维度的[内力向量](@entry_id:750751) $f_{\text{int}}(\Phi q) \in \mathbb{R}^{n}$，然后进行投影。在有限元分析中，[内力向量](@entry_id:750751)是由网格中所有单元或求积点的贡献组装而成：

$f_{\text{int}}(u) = \sum_{e=1}^{N_{el}} f_e(u)$

每个单元贡献 $f_e(u)$ 的评估都涉及到作为[非线性](@entry_id:637147)来源的材料本构律。例如，在有限应变[超弹性](@entry_id:159356)中，内力取决于[第一皮奥拉-基尔霍夫应力](@entry_id:163971) $P$，它是变形梯度 $F$ 的一个[非线性](@entry_id:637147)函数：$P(F) = \frac{\partial W}{\partial F}$，其中 $W$ 是[应变能密度](@entry_id:200085)。尽管从位移 $u$ 到变形梯度 $F$ 的映射是仿射的（$F = I + \nabla u$），但本构关系 $P(F)$ 通常是高度[非线性](@entry_id:637147)的。因此，组装完整的向量 $f_{\text{int}}(\Phi q)$ 需要遍历网格中的所有 $N_{el}$ 个单元，这使得评估降阶方程的成本与原始FOM的规模（而非ROM）成正比。这违背了[模型降阶](@entry_id:171175)的主要目的。**超缩减**指的就是一类专门为克服这一计算瓶颈而设计的技术。

### 超缩减的基本原理

超缩减的核心思想是用一个经过精心构造且计算廉价的近似（通常用帽子符号 $\hat{\cdot}$ 表示）来替代精确但计算昂贵的[非线性](@entry_id:637147)函数。我们不再计算 $f_{\text{int}}(\Phi q)$，而是计算一个其成本与FOM规模 $n$ 无关的近似 $\hat{f}_{\text{int}}(\Phi q)$。超缩减ROM（HROM）的方程变为：

$\Phi^{T} \hat{f}_{\text{int}}(\Phi q) - \Phi^{T} f_{\text{ext}} = 0$

任何超缩减方案的一个关键要求是**一致性**，即HROM应能准确复现非超缩减ROM的行为，至少在其训练所用的情形下是如此。许多超缩减方法被构造成在先前计算的FOM解的“[训练集](@entry_id:636396)”上是精确的。如果 $\\{u_k = \Phi q_k\\}$ 是一组用于训练的FOM解（快照），那么一个一致性要求是近似在这些点上是精确的：

$\hat{f}_{\text{int}}(\Phi q_k) = f_{\text{int}}(\Phi q_k) \quad \text{对于所有训练快照 } k$

如果此条件成立，那么任何满足伽辽金ROM方程 $\Phi^{T} r(\Phi q_k) = 0$ 的训练解，也将满足HROM方程 $\Phi^{T} \hat{r}(\Phi q_k) = 0$，这意味着HROM正确地复现了[训练集](@entry_id:636396)的平衡状态。构造这种近似的过程通常在**离线阶段**执行，其中高保真仿真数据被分析以构建必要的算子。由此产生的快速模型随后在**在线阶段**用于快速的新计算。

### 离线阶段：从高保真数据中学习

超缩减方案的构建始于收集关于[非线性](@entry_id:637147)项行为的数据。

首先，对一组有代表性的输入参数 $\mu_j$ 和时间点 $t_k$ 执行一次或多次高保真FOM仿真。从这些仿真中，收集待近似量的**快照**。例如，为了近似[内力向量](@entry_id:750751)，可以通过将计算出的力向量存储为**快照矩阵**的列来组装它：

$\mathcal{S}_f = [ f_{\text{int}}(u_1) \ | \ f_{\text{int}}(u_2) \ | \ \dots \ | \ f_{\text{int}}(u_M) ] \in \mathbb{R}^{n \times M}$

其中 $u_k$ 是在不同快照时刻的位移状态。这个快照矩阵包含了关于[内力向量](@entry_id:750751)在运行时所处的高维空间 $\mathbb{R}^n$ 中[流形](@entry_id:153038)的大量信息。

下一步是找到一个能够最优地表示这些数据的低维基。这通过**[本征正交分解](@entry_id:165074) (POD)** 实现，它在数学上等价于对快照矩阵 $\mathcal{S}_f$ 进行**[奇异值分解 (SVD)](@entry_id:172448)**。$\mathcal{S}_f$ 的主要[左奇异向量](@entry_id:751233)构成一个标准正交基，通常称为**旁系基 (collateral basis)** $U \in \mathbb{R}^{n \times m}$（其中 $m \ll n$），它能高保真地近似快照集中的任何向量。因此，解[流形](@entry_id:153038)上的任何力向量都可以近似为由 $U$ 张成的[子空间](@entry_id:150286)中的一个点：

$f_{\text{int}}(u) \approx U c(u)$

其中 $c(u) \in \mathbb{R}^m$ 是在旁系基下的系数。这个POD基 $U$ 是许多超缩减近似构建的基础。需要强调的是，这个用于[非线性](@entry_id:637147)项的基 $U$ 与用于解状态的基 $\Phi$ 是不同的。

### 关键的超缩减机制

有了旁系基 $U$ 之后，挑战便转移到如何高效地找到系数向量 $c(u)$，即无需计算完整的向量 $f_{\text{int}}(u)$。不同的超缩减技术提出了不同的机制来实现这一目标。

#### 基于插值的方法

这类方法通过强制近似 $\hat{f}_{\text{int}}(u) = U c(u)$ 在一个小的、精心选择的包含 $m$ 个分量索引（称为插值点）的集合上与真实函数 $f_{\text{int}}(u)$ 匹配，来确定系数 $c(u)$。

**[离散经验插值法](@entry_id:748503) (DEIM)** 是这种方法的典型代表。设插值索引为 $\\{p_1, p_2, \dots, p_m\\}$。我们可以定义一个采样矩阵 $P \in \mathbb{R}^{n \times m}$，其列是[标准基向量](@entry_id:152417) $\\{e_{p_1}, \dots, e_{p_m}\\}$。操作 $P^T f$ 提取 $f$ 在插值索引处的值。DEIM的插值约束为：

$P^T \hat{f}_{\text{int}}(u) = P^T f_{\text{int}}(u)$

代入 $\hat{f}_{\text{int}}(u) = U c(u)$，我们得到一个关于系数的小型 $m \times m$ [线性系统](@entry_id:147850)：

$(P^T U) c(u) = P^T f_{\text{int}}(u)$

DEIM算法包含一个在离线阶段应用的贪婪过程，该过程使用旁系基 $U$ 来选择插值索引，以使矩阵 $P^T U$ 良态且可逆。然后可以求得系数 $c(u) = (P^T U)^{-1} P^T f_{\text{int}}(u)$。这导出了最终的DEIM近似：

$\hat{f}_{\text{int}}(u) = U (P^T U)^{-1} P^T f_{\text{int}}(u)$

DEIM的[计算效率](@entry_id:270255)来自于这样一个事实：只需评估由 $P^T$ 选择的 $f_{\text{int}}(u)$ 的 $m$ 个分量来构成右端项。这显著降低了成本，因为只需要访问对这 $m$ 个自由度有贡献的单元。

一种相关的方法是**不完全POD (gappy POD)**，它将问题构建为[最小二乘拟合](@entry_id:751226)而非直接插值。在这里，可以使用的采样点数多于[基向量](@entry_id:199546)数（$s \ge m$）。系数 $c(u)$ 的选择旨在最小化在采样分量上的误差：

$c(u) = \arg\min_{c' \in \mathbb{R}^m} \| P^T(U c' - f_{\text{int}}(u)) \|_2$

这个最小二乘问题的解涉及到摩尔-彭若斯[伪逆](@entry_id:140762)，用匕首符号（$\dagger$）表示：

$c(u) = (P^T U)^{\dagger} P^T f_{\text{int}}(u)$

近似为 $\hat{f}_{\text{int}}(u) = U (P^T U)^{\dagger} P^T f_{\text{int}}(u)$。当采样点数量增加时，这种方法对噪声更鲁棒，也可能更稳定。**近似张量的[高斯-牛顿法](@entry_id:173233) (GNAT)** 正是建立在gappy POD概念之上，通常将其应用于近似整个[残差向量](@entry_id:165091) $R$ 而不仅仅是[内力](@entry_id:167605)。

#### 基于求积的方法

替代对组装好的[全局力向量](@entry_id:194422)分量进行采样的方法是近似定义它的积分。这些方法在单元层面操作，用一个在采样的单元[子集](@entry_id:261956) $\mathcal{S}_{el}$ 上的加权和来近似所有单元上的总和。

$\int_{\Omega} g(u, x) d\Omega = \sum_{e=1}^{N_{el}} \int_{\Omega_e} g(u, x) d\Omega \approx \sum_{e \in \mathcal{S}_{el}} w_e \int_{\Omega_e} g(u, x) d\Omega$

这可以看作是构建一个**经验求积**法则。挑战在于选择采样位置（单元或求积点）和非负权重 $w_e \ge 0$ 以确保精度。

**[能量守恒](@entry_id:140514)采样与加权 (ECSW)** 是此类方法中的杰出代表。对于保守的力学系统，内力是[势能](@entry_id:748988)泛函 $\Pi_{\text{int}}$ 的梯度。ECSW旨在在降阶模型中保持这种基本结构。它通过强制超缩减模型在训练集上复现[全阶模型](@entry_id:171001)的[虚功](@entry_id:176403)来确定权重 $w_e$。对于一组训练状态 $a^k$ 和[虚位移](@entry_id:168781) $\Delta a^k$，功匹配约束为：

$(\Delta a^k)^T V^T r(V a^k) = \sum_{e \in \mathcal{S}_{el}} w_e \left( (\Delta a^k)^T V^T r_e(V a^k) \right)$

其中 $r_e$ 是单元 $e$ 的力贡献。这些约束构成一个可以求解权重 $w_e$ 的[线性系统](@entry_id:147850)。通过构造，得到的超缩减[内力](@entry_id:167605) $\hat{f}_{\text{red}}(a) = \sum_{e \in \mathcal{S}_{el}} w_e V^T r_e(V a)$，是一个超缩减势能 $\hat{\Pi}(a) = \sum_{e \in \mathcal{S}_{el}} w_e \Pi_e(V a)$ 的精确梯度。这种势结构的保持意味着HROM是哈密顿的，并将守恒相应的离散能量，这是动态系统长期模拟的一个关键特性。

### 超缩减方法的影响与比较

超缩减技术的选择对最终模型的精度、稳定性和效率有着深远的影响。

#### 精度与误差估计

HROM的精度从根本上受限于两个误差源：由降阶基 $\Phi$ 的选择引起的投影误差，以及由超缩减方案本身引起的近似误差。一个好的超缩减方案引入的误差不应显著大于基投影已有的误差。

**[先验误差界](@entry_id:166308)**在仿真运行前提供了误差的理论估计。对于一个稳定问题，它们表明HROM解的误差受超缩减近似的误差和底层问题的稳定性常数控制。误差界通常具有以下形式：

$\| q^{\widehat{\star}} - q^{\star} \| \le C \cdot \alpha \cdot \varepsilon$

其中 $q^{\star}$ 是真实的ROM解，$q^{\widehat{\star}}$ 是HROM解，$\alpha$ 是一个稳定性常数（与降阶雅可比矩阵的逆相关），$\varepsilon$ 是近似误差 $\| \hat{r} - r \|$ 的一个度量。

**[后验误差估计](@entry_id:167288)器**在仿真后用于估计计算解 $u_r$ 的误差。它们通常基于在降阶解处评估的全阶残差的范数 $\| R(u_r) \|$。由于HROM避免计算这个全阶残差，一个关键挑战是仅使用采样点处可用的有限信息来估计此范数。

#### 结构保持性与稳定性

对于固体力学仿真，保持控制方程的物理和数学结构对于稳定性通常至关重要。

- **[能量守恒](@entry_id:140514)**：如前所述，ECSW通过保持势结构而被设计为[能量守恒](@entry_id:140514)的。相比之下，DEIM和GNAT会导致非保守的降阶力，并且通常不守恒能量，这可能在长期动态模拟中导致人为的[能量漂移](@entry_id:748982)。

- **[切线刚度](@entry_id:166213)的对称性**：在许多力学问题中，[切线刚度矩阵](@entry_id:170852) $K(u) = \frac{\partial f_{\text{int}}}{\partial u}$ 是对称的。这一特性非常理想，因为它允许在[牛顿-拉弗森](@entry_id:177436)迭代中使用高效且鲁棒的对称求解器（例如，共轭梯度法）。ECSW凭借其正权重，在降阶[切线](@entry_id:268870)矩阵中保持了这种对称性。然而，即使原始矩阵是对称的，DEIM和GNAT近似的雅可比矩阵通常也是**非对称**的。这种结构损失会降低数值性能和鲁棒性。对于任何方法，为了保持牛顿法的二次收敛性，求解器中使用的[切线](@entry_id:268870)矩阵必须是被求解的近似残差函数的精确导数。

#### 计算成本

在线计算成本是衡量超缩减方法成功与否的最终标准。主要成本通常是单元级本构律评估的次数。

- **ECSW**：成本是透明的，直接与采样单元数 $|\mathcal{S}_{el}|$ 成正比。
- **DEIM/GNAT**：成本更为复杂。这些方法对 $m$ 个全局自由度进行采样。为了评估单个自由度上的力，必须访问连接到该节点的所有单元。因此，计算 $m$ 个采样条目可能需要访问远大于 $m$ 个单元，并且内存访问可能是分散的。

因此，对成本的公平比较必须考虑采样方案所需的单元访问总数和局部求积点评估总数。在实践中，像ECSW这样基于单元采样的方法，通常比基于采样分散自由度的方法具有更可预测和更有利于并行化的计算结构。