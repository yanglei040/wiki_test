{
    "hands_on_practices": [
        {
            "introduction": "第一个练习将提供一个直接、动手的应用分层基函数的机会。通过在参考三角形上手动计算一个简单二次场的模态系数，您将具体了解顶点模态和边模态是如何被顺序确定，以及高阶函数如何修正低阶近似的。这个过程阐明了p版本插值的核心机制。",
            "id": "3570981",
            "problem": "考虑参考三角形 $\\hat{T}=\\{(x,y)\\in\\mathbb{R}^2:\\, x\\ge 0,\\, y\\ge 0,\\, x+y\\le 1\\}$，其重心坐标为 $\\lambda_1=1-x-y$、$\\lambda_2=x$ 和 $\\lambda_3=y$。一个最高为 $p=2$ 多项式阶次的分层 $p$ 型三角形基由以下模式定义：\n- 顶点模式：$\\psi_1=\\lambda_1$，$\\psi_2=\\lambda_2$，$\\psi_3=\\lambda_3$。\n- 2阶边模式：在边 $(1,2)$ 上的 $\\psi_4=4\\,\\lambda_1\\lambda_2$，在边 $(2,3)$ 上的 $\\psi_5=4\\,\\lambda_2\\lambda_3$，以及在边 $(3,1)$ 上的 $\\psi_6=4\\,\\lambda_3\\lambda_1$。\n\n使用一个分层节点插值算子，并按顺序应用以下自由度：\n- 顶点 $V_1=(0,0)$、$V_2=(1,0)$ 和 $V_3=(0,1)$ 处的值。\n- 边中点 $M_{12}=\\left(\\frac{1}{2},0\\right)$、$M_{23}=\\left(\\frac{1}{2},\\frac{1}{2}\\right)$ 和 $M_{31}=\\left(0,\\frac{1}{2}\\right)$ 处的值。\n\n对于二次场 $u(x,y)=x^2-xy+y^2$，通过在上述自由度上按分层顺序施加插值条件，确定其分层展开式\n$$\nI_2 u(x,y)=\\sum_{i=1}^{6} c_i\\,\\psi_i(x,y),\n$$\n中的系数 $c_1,\\dots,c_6$。请以 $1\\times 6$ 行向量 $\\left(c_1, c_2, c_3, c_4, c_5, c_6\\right)$ 的形式报告你的答案，使用精确值。无需四舍五入，不涉及单位。",
            "solution": "该问题是有效的。这是一个计算固体力学中的适定问题，具体涉及有限元法。所有定义、数据和条件在科学上都是合理的、一致的和完整的，从而可以得到唯一的解。\n\n目标是求出在参考三角形上，二次场 $u(x,y)=x^2-xy+y^2$ 的分层 $p$ 型展开式的系数 $c_1, \\dots, c_6$。该展开式由\n$$\nI_2 u(x,y)=\\sum_{i=1}^{6} c_i\\,\\psi_i(x,y)\n$$\n给出，其中的系数是通过在一组分层节点上施加插值条件来确定的。该方法依赖于从最低多项式阶次开始，顺序确定系数。\n\n首先，我们确定插值节点以及函数 $u(x,y)$ 和重心坐标 $(\\lambda_1, \\lambda_2, \\lambda_3)$ 在这些节点上的对应值。重心坐标定义为 $\\lambda_1=1-x-y$，$\\lambda_2=x$ 和 $\\lambda_3=y$。\n\n插值点（自由度）是：\n- 顶点：$V_1=(0,0)$，$V_2=(1,0)$，$V_3=(0,1)$。\n- 边中点：$M_{12}=\\left(\\frac{1}{2},0\\right)$，$M_{23}=\\left(\\frac{1}{2},\\frac{1}{2}\\right)$ 和 $M_{31}=\\left(0,\\frac{1}{2}\\right)$。\n\n我们来计算函数 $u(x,y) = x^2-xy+y^2$ 在这些节点上的值：\n- $u(V_1) = u(0,0) = 0^2 - (0)(0) + 0^2 = 0$。\n- $u(V_2) = u(1,0) = 1^2 - (1)(0) + 0^2 = 1$。\n- $u(V_3) = u(0,1) = 0^2 - (0)(1) + 1^2 = 1$。\n- $u(M_{12}) = u\\left(\\frac{1}{2},0\\right) = \\left(\\frac{1}{2}\\right)^2 - \\left(\\frac{1}{2}\\right)(0) + 0^2 = \\frac{1}{4}$。\n- $u(M_{23}) = u\\left(\\frac{1}{2},\\frac{1}{2}\\right) = \\left(\\frac{1}{2}\\right)^2 - \\left(\\frac{1}{2}\\right)\\left(\\frac{1}{2}\\right) + \\left(\\frac{1}{2}\\right)^2 = \\frac{1}{4} - \\frac{1}{4} + \\frac{1}{4} = \\frac{1}{4}$。\n- $u(M_{31}) = u\\left(0,\\frac{1}{2}\\right) = 0^2 - (0)\\left(\\frac{1}{2}\\right) + \\left(\\frac{1}{2}\\right)^2 = \\frac{1}{4}$。\n\n接下来，我们计算这些节点上的重心坐标：\n- $V_1=(0,0) \\implies (\\lambda_1, \\lambda_2, \\lambda_3) = (1,0,0)$。\n- $V_2=(1,0) \\implies (\\lambda_1, \\lambda_2, \\lambda_3) = (0,1,0)$。\n- $V_3=(0,1) \\implies (\\lambda_1, \\lambda_2, \\lambda_3) = (0,0,1)$。\n- $M_{12}=\\left(\\frac{1}{2},0\\right) \\implies (\\lambda_1, \\lambda_2, \\lambda_3) = \\left(\\frac{1}{2},\\frac{1}{2},0\\right)$。\n- $M_{23}=\\left(\\frac{1}{2},\\frac{1}{2}\\right) \\implies (\\lambda_1, \\lambda_2, \\lambda_3) = \\left(0,\\frac{1}{2},\\frac{1}{2}\\right)$。\n- $M_{31}=\\left(0,\\frac{1}{2}\\right) \\implies (\\lambda_1, \\lambda_2, \\lambda_3) = \\left(\\frac{1}{2},0,\\frac{1}{2}\\right)$。\n\n分层插值分阶段进行。\n\n**阶段1：确定顶点系数 ($c_1, c_2, c_3$)**\n我们首先考虑线性插值函数，$I_1 u(x,y) = c_1\\psi_1 + c_2\\psi_2 + c_3\\psi_3$，并在顶点上施加插值条件。\n基函数为 $\\psi_1=\\lambda_1$，$\\psi_2=\\lambda_2$，$\\psi_3=\\lambda_3$。这些是标准的线性形函数，它们具有性质 $\\psi_i(V_j) = \\delta_{ij}$（克罗内克δ函数）。\n- 在 $V_1$ 点：$I_1 u(V_1) = c_1\\psi_1(V_1) + c_2\\psi_2(V_1) + c_3\\psi_3(V_1) = c_1(1) + c_2(0) + c_3(0) = c_1$。\n  施加条件 $I_1 u(V_1) = u(V_1)$，我们得到 $c_1 = 0$。\n- 在 $V_2$ 点：$I_1 u(V_2) = c_1\\psi_1(V_2) + c_2\\psi_2(V_2) + c_3\\psi_3(V_2) = c_1(0) + c_2(1) + c_3(0) = c_2$。\n  施加条件 $I_1 u(V_2) = u(V_2)$，我们得到 $c_2 = 1$。\n- 在 $V_3$ 点：$I_1 u(V_3) = c_1\\psi_1(V_3) + c_2\\psi_2(V_3) + c_3\\psi_3(V_3) = c_1(0) + c_2(0) + c_3(1) = c_3$。\n  施加条件 $I_1 u(V_3) = u(V_3)$，我们得到 $c_3 = 1$。\n\n因此，顶点系数为 $c_1=0$、$c_2=1$ 和 $c_3=1$。插值函数的线性部分是 $I_1 u = (0)\\lambda_1 + (1)\\lambda_2 + (1)\\lambda_3 = \\lambda_2+\\lambda_3 = x+y$。\n\n**阶段2：确定边系数 ($c_4, c_5, c_6$)**\n现在我们考虑完整的二次插值函数，$I_2 u = I_1 u + c_4\\psi_4 + c_5\\psi_5 + c_6\\psi_6$。\n分层基的一个关键性质是，高阶模式（边模式 $\\psi_4, \\psi_5, \\psi_6$）在低阶近似的节点（顶点 $V_1, V_2, V_3$）上为零。例如，$\\psi_4=4\\lambda_1\\lambda_2$ 在 $V_1$（其中 $\\lambda_2=0$）、$V_2$（其中 $\\lambda_1=0$）和 $V_3$（其中两者都为零）处为零。这确保了确定 $c_4, c_5, c_6$ 不会改变已在顶点上施加的插值条件。\n我们通过在边中点上施加插值条件来确定边系数。\n\n- 对于 $c_4$（边 1-2）：我们使用中点 $M_{12}$。插值条件是 $I_2 u(M_{12}) = u(M_{12})$。\n  $I_1 u(M_{12}) + c_4\\psi_4(M_{12}) + c_5\\psi_5(M_{12}) + c_6\\psi_6(M_{12}) = u(M_{12})$。\n  在 $M_{12}$ 点，重心坐标为 $(\\lambda_1, \\lambda_2, \\lambda_3) = (\\frac{1}{2},\\frac{1}{2},0)$。\n  边模式 $\\psi_5=4\\lambda_2\\lambda_3$ 和 $\\psi_6=4\\lambda_3\\lambda_1$ 为零，因为 $\\lambda_3=0$。\n  模式 $\\psi_4(M_{12}) = 4\\lambda_1\\lambda_2 = 4\\left(\\frac{1}{2}\\right)\\left(\\frac{1}{2}\\right) = 1$。\n  线性插值函数的值为 $I_1 u(M_{12}) = \\lambda_2(M_{12}) + \\lambda_3(M_{12}) = \\frac{1}{2} + 0 = \\frac{1}{2}$。\n  方程变为：$\\frac{1}{2} + c_4(1) = u(M_{12}) = \\frac{1}{4}$。\n  解出 $c_4$：$c_4 = \\frac{1}{4} - \\frac{1}{2} = -\\frac{1}{4}$。\n\n- 对于 $c_5$（边 2-3）：我们使用中点 $M_{23}$。条件是 $I_2 u(M_{23}) = u(M_{23})$。\n  $I_1 u(M_{23}) + c_4\\psi_4(M_{23}) + c_5\\psi_5(M_{23}) + c_6\\psi_6(M_{23}) = u(M_{23})$。\n  在 $M_{23}$ 点，$(\\lambda_1, \\lambda_2, \\lambda_3) = (0,\\frac{1}{2},\\frac{1}{2})$。\n  边模式 $\\psi_4$ 和 $\\psi_6$ 为零，因为 $\\lambda_1=0$。\n  模式 $\\psi_5(M_{23}) = 4\\lambda_2\\lambda_3 = 4\\left(\\frac{1}{2}\\right)\\left(\\frac{1}{2}\\right) = 1$。\n  线性插值函数的值为 $I_1 u(M_{23}) = \\lambda_2(M_{23}) + \\lambda_3(M_{23}) = \\frac{1}{2} + \\frac{1}{2} = 1$。\n  方程变为：$1 + c_5(1) = u(M_{23}) = \\frac{1}{4}$。\n  解出 $c_5$：$c_5 = \\frac{1}{4} - 1 = -\\frac{3}{4}$。\n\n- 对于 $c_6$（边 3-1）：我们使用中点 $M_{31}$。条件是 $I_2 u(M_{31}) = u(M_{31})$。\n  $I_1 u(M_{31}) + c_4\\psi_4(M_{31}) + c_5\\psi_5(M_{31}) + c_6\\psi_6(M_{31}) = u(M_{31})$。\n  在 $M_{31}$ 点，$(\\lambda_1, \\lambda_2, \\lambda_3) = (\\frac{1}{2},0,\\frac{1}{2})$。\n  边模式 $\\psi_4$ 和 $\\psi_5$ 为零，因为 $\\lambda_2=0$。\n  模式 $\\psi_6(M_{31}) = 4\\lambda_3\\lambda_1 = 4\\left(\\frac{1}{2}\\right)\\left(\\frac{1}{2}\\right) = 1$。\n  线性插值函数的值为 $I_1 u(M_{31}) = \\lambda_2(M_{31}) + \\lambda_3(M_{31}) = 0 + \\frac{1}{2} = \\frac{1}{2}$。\n  方程变为：$\\frac{1}{2} + c_6(1) = u(M_{31}) = \\frac{1}{4}$。\n  解出 $c_6$：$c_6 = \\frac{1}{4} - \\frac{1}{2} = -\\frac{1}{4}$。\n\n分层系数集为：$c_1=0$，$c_2=1$，$c_3=1$，$c_4=-\\frac{1}{4}$，$c_5=-\\frac{3}{4}$，$c_6=-\\frac{1}{4}$。\n\n验证：由六个基函数 $\\{\\psi_i\\}_{i=1}^6$ 张成的空间是三角形上的所有二次多项式空间，即 $P_2(\\hat{T})$。由于给定函数 $u(x,y)=x^2-xy+y^2$ 是一个二次多项式，其在该空间中的插值必须是精确的。我们通过重构该多项式来确认。\n$I_2 u = c_1\\lambda_1 + c_2\\lambda_2 + c_3\\lambda_3 + c_4(4\\lambda_1\\lambda_2) + c_5(4\\lambda_2\\lambda_3) + c_6(4\\lambda_3\\lambda_1)$\n$I_2 u = (1)\\lambda_2 + (1)\\lambda_3 - \\frac{1}{4}(4\\lambda_1\\lambda_2) - \\frac{3}{4}(4\\lambda_2\\lambda_3) - \\frac{1}{4}(4\\lambda_3\\lambda_1)$\n$I_2 u = \\lambda_2 + \\lambda_3 - \\lambda_1\\lambda_2 - 3\\lambda_2\\lambda_3 - \\lambda_3\\lambda_1$\n将 $\\lambda_1=1-x-y$，$\\lambda_2=x$，$\\lambda_3=y$ 代入：\n$I_2 u(x,y) = x + y - (1-x-y)x - 3xy - y(1-x-y)$\n$I_2 u(x,y) = x + y - (x-x^2-xy) - 3xy - (y-xy-y^2)$\n$I_2 u(x,y) = x + y - x + x^2 + xy - 3xy - y + xy + y^2$\n$I_2 u(x,y) = x^2 + y^2 + (1-3+1)xy = x^2 - xy + y^2 = u(x,y)$。\n重构是精确的，这验证了计算出的系数。\n\n最终答案是系数行向量 $(c_1, c_2, c_3, c_4, c_5, c_6)$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0  1  1  -\\frac{1}{4}  -\\frac{3}{4}  -\\frac{1}{4}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在掌握了基础知识之后，本练习将重点从单个计算转移到单元矩阵的整体结构上。您将使用张量积形式的分层基函数，推导四边形单元的刚度矩阵和质量矩阵的形式，并揭示其独特的块结构。理解这种V-E-I（顶点-边-内部）划分至关重要，因为它构成了p版本有限元法中静态凝聚等高级求解策略的基础。",
            "id": "3570949",
            "problem": "考虑一个等参四边形有限元，其参考域为正方形 $\\hat{\\Omega} = [-1,1] \\times [-1,1]$，通过仿射映射到物理单元，因此雅可比行列式为常数且缩放因子可分离。采用一阶索伯列夫空间（H1）中的标量场 $u$ 作为小应变线性弹性中位移分量的代表，并将局部刚度和质量的双线性形式定义为\n$$\na(u,v) = \\int_{\\hat{\\Omega}} \\kappa \\, \\nabla u \\cdot \\nabla v \\, \\mathrm{d}\\xi \\, \\mathrm{d}\\eta, \n\\qquad \nm(u,v) = \\int_{\\hat{\\Omega}} \\rho \\, u \\, v \\, \\mathrm{d}\\xi \\, \\mathrm{d}\\eta,\n$$\n其中 $\\kappa > 0$ 是一个类扩散模量的常数，$\\rho > 0$ 是一个类密度系数的常数。令分层p-型张量积基由 $[-1,1]$ 上的一维分层模式构造：\n- 顶点模式 $l_{1}(\\xi) = \\frac{1 - \\xi}{2}$ 和 $l_{2}(\\xi) = \\frac{1 + \\xi}{2}$ 产生四个角点函数 $L_{i}(\\xi,\\eta) = l_{\\alpha}(\\xi) \\, l_{\\beta}(\\eta)$，其中 $\\alpha,\\beta \\in \\{1,2\\}$。\n- 每条一维边上的边模式为 $\\psi_{k}(\\xi)$，$k = 2,3,\\dots,p$，其定义为在 $\\xi = \\pm 1$ 处为零，并分层地张成次数递增的多项式；在 $\\eta$ 方向上同样如此。一个具体的选择可以是Legendre多项式的差 $\\psi_{k}(\\xi) = c_{k}\\left(P_{k}(\\xi)-P_{k-2}(\\xi)\\right)$，其中 $c_{k}>0$ 是归一化常数，$P_{n}$ 是n阶Legendre多项式，不过下面的推导对于任何在端点处为零的分层 $\\psi_{k}$ 都成立。\n- 内部模式是张量积 $\\Psi_{r,s}(\\xi,\\eta) = \\psi_{r}(\\xi)\\,\\psi_{s}(\\eta)$，其中 $r,s \\in \\{2,3,\\dots,p\\}$。\n\n根据其几何支集对模式进行分类：顶点模式 $V$、边模式 $E$（按边和次数组织）和内部模式 $I$。使用上述基本弱形式和张量积基的可分离性，以分层基及其导数的一维内积形式推导局部单元刚度矩阵 $\\mathbf{K}$ 和质量矩阵 $\\mathbf{M}$，并揭示其克罗内克积/和结构。然后，识别并解释当按 V–E–I 分类排序时 $\\mathbf{K}$ 和 $\\mathbf{M}$ 的块结构，说明哪些块是对角块，哪些块因构造而为零，以及哪些块包含由张量积可分离性和边界消失性质引起的非零耦合。\n\n最后，对于多项式阶次 $p \\geq 2$，为该四边形单元在上述分类下的分层自由度总数 $N(p)$ 提供一个单一的闭式解析表达式。将 $N(p)$ 表示为 $p$ 的简化函数。",
            "solution": "问题陈述是 p-型有限元法中的一个有效练习。它在计算固体力学方面有科学依据，是数学上适定、客观且自洽的。所有定义和条件都是标准的，并允许一个唯一的可推导解。我们将按要求进行推导和分析。\n\n解答分为三个部分：\n1. 以一维内积和克罗内克积/和的形式推导局部刚度矩阵和质量矩阵。\n2. 在基函数按顶点-边-内部（V-E-I）排序下，分析这些矩阵的块结构。\n3. 推导自由度总数 $N(p)$。\n\n**第1部分：单元矩阵的推导**\n\n令 $[-1,1]$ 上的完整一维分层基表示为 $\\{\\phi_i(\\xi)\\}_{i=0}^{p}$，其中 $\\phi_0(\\xi) = l_1(\\xi)$，$\\phi_1(\\xi) = l_2(\\xi)$，以及 $\\{\\phi_i(\\xi)\\}_{i=2}^{p} = \\{\\psi_i(\\xi)\\}_{i=2}^{p}$。一维基函数的总数为 $p+1$。$\\hat{\\Omega}$ 上的二维基是这些一维基的张量积：$\\{ N_k(\\xi, \\eta) \\} = \\{ \\phi_i(\\xi) \\phi_j(\\eta) \\}_{i,j=0}^{p}$。\n\n我们定义参考区间 $[-1,1]$ 上关于基 $\\{\\phi_i\\}$ 的一维质量矩阵和刚度矩阵。令这些一维矩阵的元素为：\n$$\nM^1_{ij} = \\int_{-1}^{1} \\phi_i(x) \\phi_j(x) \\, \\mathrm{d}x\n$$\n$$\nK^1_{ij} = \\int_{-1}^{1} \\phi'_i(x) \\phi'_j(x) \\, \\mathrm{d}x\n$$\n其中 ' 表示对其自变量的微分，例如 $\\phi'_i(x) = \\frac{\\mathrm{d}\\phi_i}{\\mathrm{d}x}(x)$。\n\n标量场 $u$ 近似为二维基函数的线性组合：\n$$\nu(\\xi, \\eta) = \\sum_{k} u_k N_k(\\xi, \\eta) = \\sum_{i=0}^{p} \\sum_{j=0}^{p} u_{ij} \\phi_i(\\xi) \\phi_j(\\eta)\n$$\n单元质量矩阵 $\\mathbf{M}$ 和刚度矩阵 $\\mathbf{K}$ 的元素分别由 $M_{kl} = m(N_k, N_l)$ 和 $K_{kl} = a(N_k, N_l)$ 给出。令第 k 个基函数对应于指数对 $(i,j)$，第 l 个基函数对应于 $(p,q)$。因此，$N_k(\\xi, \\eta) = \\phi_i(\\xi) \\phi_j(\\eta)$，$N_l(\\xi, \\eta) = \\phi_p(\\xi) \\phi_q(\\eta)$。\n\n对于质量矩阵项，我们有：\n$$\nM_{(i,j),(p,q)} = m(\\phi_i(\\xi)\\phi_j(\\eta), \\phi_p(\\xi)\\phi_q(\\eta)) = \\int_{-1}^{1}\\int_{-1}^{1} \\rho (\\phi_i(\\xi)\\phi_j(\\eta)) (\\phi_p(\\xi)\\phi_q(\\eta)) \\, \\mathrm{d}\\xi \\, \\mathrm{d}\\eta\n$$\n由于 $\\rho$ 是常数且积分是可分离的：\n$$\nM_{(i,j),(p,q)} = \\rho \\left( \\int_{-1}^{1} \\phi_i(\\xi)\\phi_p(\\xi) \\, \\mathrm{d}\\xi \\right) \\left( \\int_{-1}^{1} \\phi_j(\\eta)\\phi_q(\\eta) \\, \\mathrm{d}\\eta \\right) = \\rho \\, M^1_{ip} \\, M^1_{jq}\n$$\n这个结构正是克罗内克积 ($\\otimes$) 的定义。如果我们按 $\\eta$ 指数变化最快的方式排列基函数，则完整的质量矩阵为：\n$$\n\\mathbf{M} = \\rho (\\mathbf{M}^1 \\otimes \\mathbf{M}^1)\n$$\n\n对于刚度矩阵项，我们首先计算梯度：\n$$\n\\nabla N_k = \\nabla(\\phi_i(\\xi)\\phi_j(\\eta)) = \\begin{pmatrix} \\phi'_i(\\xi)\\phi_j(\\eta) \\\\ \\phi_i(\\xi)\\phi'_j(\\eta) \\end{pmatrix}, \\quad \\nabla N_l = \\begin{pmatrix} \\phi'_p(\\xi)\\phi_q(\\eta) \\\\ \\phi_p(\\xi)\\phi'_q(\\eta) \\end{pmatrix}\n$$\n刚度双线性形式的被积函数为 $\\nabla N_k \\cdot \\nabla N_l = \\phi'_i\\phi'_p\\phi_j\\phi_q + \\phi_i\\phi_p\\phi'_j\\phi'_q$。\n$$\nK_{(i,j),(p,q)} = a(N_k, N_l) = \\kappa \\int_{-1}^{1}\\int_{-1}^{1} (\\phi'_i(\\xi)\\phi'_p(\\xi)\\phi_j(\\eta)\\phi_q(\\eta) + \\phi_i(\\xi)\\phi_p(\\xi)\\phi'_j(\\eta)\\phi'_q(\\eta)) \\, \\mathrm{d}\\xi \\, \\mathrm{d}\\eta\n$$\n分离积分：\n$$\nK_{(i,j),(p,q)} = \\kappa \\left[ \\left(\\int_{-1}^{1} \\phi'_i(\\xi)\\phi'_p(\\xi)\\mathrm{d}\\xi\\right)\\left(\\int_{-1}^{1} \\phi_j(\\eta)\\phi_q(\\eta)\\mathrm{d}\\eta\\right) + \\left(\\int_{-1}^{1} \\phi_i(\\xi)\\phi_p(\\xi)\\mathrm{d}\\xi\\right)\\left(\\int_{-1}^{1} \\phi'_j(\\eta)\\phi'_q(\\eta)\\mathrm{d}\\eta\\right) \\right]\n$$\n$$\nK_{(i,j),(p,q)} = \\kappa ( K^1_{ip} M^1_{jq} + M^1_{ip} K^1_{jq} )\n$$\n这个结构对应于克罗内克和。完整的刚度矩阵为：\n$$\n\\mathbf{K} = \\kappa (\\mathbf{K}^1 \\otimes \\mathbf{M}^1 + \\mathbf{M}^1 \\otimes \\mathbf{K}^1)\n$$\n这个推导正式地将单元矩阵用一维积分表示，并揭示了其底层的克罗内克积/和结构，符合题目要求。\n\n**第2部分：块结构分析**\n\n我们现在根据几何分类对基函数重新排序：顶点 (V)、边 (E) 和内部 (I)。\n- **顶点模式 (V)**：4个函数 $\\{l_\\alpha(\\xi)l_\\beta(\\eta)\\}_{\\alpha,\\beta \\in \\{1,2\\}}$。\n- **边模式 (E)**：$4(p-1)$ 个函数。对于平行于 $\\xi$ 轴的边，这些是 $\\{ \\psi_k(\\xi)l_\\beta(\\eta) \\}_{k=2..p, \\beta=1,2}$。对于平行于 $\\eta$ 轴的边，是 $\\{ l_\\alpha(\\xi)\\psi_k(\\eta) \\}_{k=2..p, \\alpha=1,2}$。\n- **内部模式 (I)**：$(p-1)^2$ 个函数 $\\{ \\psi_r(\\xi)\\psi_s(\\eta) \\}_{r,s=2..p}$。\n\n分层边模式 $\\psi_k(x)$ 的一个关键性质是它们在端点处为零：$\\psi_k(\\pm 1) = 0$。这意味着顶点模式的导数与边/内部模式的导数之间存在正交性。一维顶点模式 $l_\\alpha(x)$ 是线性的，所以 $l''_\\alpha(x) = 0$。对于任何 $k \\ge 2$：\n$$\n\\int_{-1}^{1} l'_\\alpha(x) \\psi'_k(x) \\, \\mathrm{d}x = [l'_\\alpha(x) \\psi_k(x)]_{-1}^{1} - \\int_{-1}^{1} l''_\\alpha(x) \\psi_k(x) \\, \\mathrm{d}x = l'_\\alpha(\\pm 1)\\psi_k(\\pm 1) - 0 = 0\n$$\n这个结果 $\\langle l'_\\alpha, \\psi'_k \\rangle = 0$ 是刚度矩阵块结构的关键。\n\n按 V-E-I 排序分块的矩阵具有以下形式：\n$$\n\\mathbf{M} = \\begin{pmatrix} \\mathbf{M}_{VV}  \\mathbf{M}_{VE}  \\mathbf{M}_{VI} \\\\ \\mathbf{M}_{EV}  \\mathbf{M}_{EE}  \\mathbf{M}_{EI} \\\\ \\mathbf{M}_{IV}  \\mathbf{M}_{IE}  \\mathbf{M}_{II} \\end{pmatrix}, \\quad \\mathbf{K} = \\begin{pmatrix} \\mathbf{K}_{VV}  \\mathbf{K}_{VE}  \\mathbf{K}_{VI} \\\\ \\mathbf{K}_{EV}  \\mathbf{K}_{EE}  \\mathbf{K}_{EI} \\\\ \\mathbf{K}_{IV}  \\mathbf{K}_{IE}  \\mathbf{K}_{II} \\end{pmatrix}\n$$\n\n**质量矩阵 ($\\mathbf{M}$) 的块结构：**\n质量形式 $m(u,v) = \\rho \\int_{\\hat{\\Omega}} u v \\, \\mathrm{d}\\xi\\mathrm{d}\\eta$ 涉及 $L^2$ 内积。分层基函数在不同类型（V、E、I）之间通常不是 $L^2$-正交的。例如，$\\int_{-1}^{1} l_\\alpha(x) \\psi_k(x) \\, \\mathrm{d}x \\neq 0$。因此，质量矩阵的所有非对角块通常都是非零且稠密的。\n- $\\mathbf{M}_{VE}, \\mathbf{M}_{VI}, \\mathbf{M}_{EI}$ 都是**非零**的。\n在这种块划分中，质量矩阵 $\\mathbf{M}$ 是一个**完全耦合（稠密）的矩阵**。\n\n**刚度矩阵 ($\\mathbf{K}$) 的块结构：**\n由于 $\\langle l'_\\alpha, \\psi'_k \\rangle = 0$ 的性质，$\\mathbf{K}$ 的结构是稀疏的。\n- **$\\mathbf{K}_{VI}$ 和 $\\mathbf{K}_{IV}$ （顶点-内部耦合）：**\n令 $u = l_\\alpha(\\xi)l_\\beta(\\eta) \\in V$ 且 $v = \\psi_r(\\xi)\\psi_s(\\eta) \\in I$。\n$a(u,v) = \\kappa \\left( \\langle l'_\\alpha, \\psi'_r \\rangle \\langle l_\\beta, \\psi_s \\rangle + \\langle l_\\alpha, \\psi_r \\rangle \\langle l'_\\beta, \\psi'_s \\rangle \\right)$。\n两项都为零，因为 $\\langle l'_\\alpha, \\psi'_r \\rangle = 0$ 且 $\\langle l'_\\beta, \\psi'_s \\rangle = 0$。\n因此，$\\mathbf{K}_{VI} = \\mathbf{0}$，并且根据对称性，$\\mathbf{K}_{IV} = \\mathbf{0}$。这是分层基的一个基本性质：顶点模式与内部模式是 $H^1$-正交的。\n\n- **$\\mathbf{K}_{VE}$ 和 $\\mathbf{K}_{EI}$ （其他耦合）：**\n这些块通常是非零的。例如，考虑 $u = l_\\alpha(\\xi)l_\\beta(\\eta) \\in V$ 和一个边模式 $v = \\psi_k(\\xi)l_\\gamma(\\eta) \\in E$。\n$a(u,v) = \\kappa \\left( \\langle l'_\\alpha, \\psi'_k \\rangle \\langle l_\\beta, l_\\gamma \\rangle + \\langle l_\\alpha, \\psi_k \\rangle \\langle l'_\\beta, l'_\\gamma \\rangle \\right) = \\kappa \\langle l_\\alpha, \\psi_k \\rangle \\langle l'_\\beta, l'_\\gamma \\rangle \\neq 0$。\n所以 $\\mathbf{K}_{VE}$ 和 $\\mathbf{K}_{EV}$ 是**非零**的。\n类似地，对于 $u = \\psi_k(\\xi)l_\\beta(\\eta) \\in E$ 和 $v = \\psi_r(\\xi)\\psi_s(\\eta) \\in I$：\n$a(u,v) = \\kappa \\left( \\langle \\psi'_k, \\psi'_r \\rangle \\langle l_\\beta, \\psi_s \\rangle + \\langle \\psi_k, \\psi_r \\rangle \\langle l'_\\beta, \\psi'_s \\rangle \\right) = \\kappa \\langle \\psi'_k, \\psi'_r \\rangle \\langle l_\\beta, \\psi_s \\rangle \\neq 0$。\n所以 $\\mathbf{K}_{EI}$ 和 $\\mathbf{K}_{IE}$ 也是**非零**的。\n\n- **$\\mathbf{K}_{EE}$ （边-边块）：**\n这个块有特定的结构。垂直边上的边模式是 $H^1$-正交的。对于 $u = \\psi_k(\\xi)l_\\alpha(\\eta)$ 和 $v = l_\\beta(\\xi)\\psi_r(\\eta)$：\n$a(u,v) = \\kappa \\left( \\langle \\psi'_k, l'_\\beta \\rangle \\langle l_\\alpha, \\psi_r \\rangle + \\langle \\psi_k, l_\\beta \\rangle \\langle l'_\\alpha, \\psi'_r \\rangle \\right) = 0 + 0 = 0$。\n因此，$\\mathbf{K}_{EE}$ 是**块对角**的，非零耦合只存在于同一条边或平行边上的模式之间。\n\n总之，刚度矩阵具有以下块结构：\n$$\n\\mathbf{K} = \\begin{pmatrix} \\mathbf{K}_{VV}  \\mathbf{K}_{VE}  \\mathbf{0} \\\\ \\mathbf{K}_{EV}  \\mathbf{K}_{EE}  \\mathbf{K}_{EI} \\\\ \\mathbf{0}  \\mathbf{K}_{IE}  \\mathbf{K}_{II} \\end{pmatrix}\n$$\n其中 $\\mathbf{K}_{EE}$ 本身是块对角的，将与 $\\xi$-边相关的模式与与 $\\eta$-边相关的模式分开。对角块 $\\mathbf{K}_{VV}$、$\\mathbf{K}_{EE}$ 和 $\\mathbf{K}_{II}$ 通常不是对角矩阵，并包含非零项。\n\n**第3部分：自由度总数**\n\n自由度（DoFs）总数 $N(p)$ 是多项式阶次为 $p$ 的基函数总数。我们可以对 $p \\ge 2$ 的每类模式的数量求和：\n1.  **顶点模式 ($N_V$)：** 有4个角点，每个角点关联一个顶点模式（一维线性帽子函数的张量积）。\n    $$N_V = 4$$\n2.  **边模式 ($N_E$)：** 有4条边。对于每条边，有次数为 $k=2, 3, \\dots, p$ 的分层模式。每条边上此类模式的数量是 $p-1$。\n    $$N_E = 4 \\times (p-1)$$\n3.  **内部模式 ($N_I$)：** 这些是一维边模式 $\\psi_r(\\xi)\\psi_s(\\eta)$ 的张量积。指数 $r$ 和 $s$ 的范围都是从 $2$ 到 $p$。每个指数的选择数量是 $p-1$。\n    $$N_I = (p-1) \\times (p-1) = (p-1)^2$$\n\n自由度总数 $N(p)$ 是总和：\n$$\nN(p) = N_V + N_E + N_I = 4 + 4(p-1) + (p-1)^2\n$$\n展开并简化此表达式：\n$$\nN(p) = 4 + 4p - 4 + (p^2 - 2p + 1)\n$$\n$$\nN(p) = p^2 + 2p + 1\n$$\n这可以因式分解为一个简单的形式：\n$$\nN(p) = (p+1)^2\n$$\n这个结果与张量积构造是一致的，即一维中有 $p+1$ 个基函数（$\\{l_1, l_2, \\psi_2, \\dots, \\psi_p\\}$），从而在二维中得到 $(p+1) \\times (p+1)$ 个函数。",
            "answer": "$$\n\\boxed{(p+1)^2}\n$$"
        },
        {
            "introduction": "我们最后的练习将探讨单元几何形状对p版本公式产生的关键影响。您将分析一个非仿射（弯曲）四边形上的内部“气泡”模态，计算其对刚度矩阵的贡献，并将其与一个简化的近似值进行比较。这个练习展示了由非常数雅可比矩阵所捕捉的几何变形，是如何破坏在参考单元上所具有的便利正交性的，这也是高阶方法在实际应用中的一个关键挑战。",
            "id": "3570976",
            "problem": "考虑一个四节点双线性四边形有限元，该单元通过等参映射从具有局部坐标 $(\\xi,\\eta) \\in [-1,1] \\times [-1,1]$ 的参考正方形映射到物理 $(x,y)$ 平面得到。双线性形函数为 $N_1(\\xi,\\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta)$, $N_2(\\xi,\\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta)$, $N_3(\\xi,\\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta)$, $N_4(\\xi,\\eta) = \\frac{1}{4}(1-\\xi)(1+\\eta)$。物理节点坐标由下式给出\n$$\n(x_1,y_1)=(-0.5,-1),\\quad (x_2,y_2)=(0.5,-1),\\quad (x_3,y_3)=(1.5,1),\\quad (x_4,y_4)=(-1.5,1).\n$$\n等参映射定义为 $x(\\xi,\\eta)=\\sum_{i=1}^{4}N_i(\\xi,\\eta)\\,x_i$ 和 $y(\\xi,\\eta)=\\sum_{i=1}^{4}N_i(\\xi,\\eta)\\,y_i$，其雅可比矩阵为 $\\mathbf{J}(\\xi,\\eta)=\\begin{bmatrix}\\partial x/\\partial \\xi  \\partial x/\\partial \\eta \\\\ \\partial y/\\partial \\xi  \\partial y/\\partial \\eta\\end{bmatrix}$，行列式为 $\\det\\mathbf{J}$。考虑参考单元上多项式阶数为 $p=2$ 的分层内部气泡模式，\n$$\n\\hat{N}(\\xi,\\eta)=(1-\\xi^2)(1-\\eta^2),\n$$\n该模式在参考正方形的边界上为零。对于单位电导率的标量扩散问题，在 Galerkin 方法中与此内部模式相关的单元刚度为\n$$\nK_b=\\int_{-1}^{1}\\int_{-1}^{1} \\nabla_{\\boldsymbol{x}} \\hat{N}(\\xi,\\eta)\\cdot \\nabla_{\\boldsymbol{x}} \\hat{N}(\\xi,\\eta)\\,\\det\\mathbf{J}(\\xi,\\eta)\\,d\\xi\\,d\\eta,\n$$\n其中 $\\nabla_{\\boldsymbol{x}}$ 表示相对于物理坐标的梯度，并通过 $\\nabla_{\\boldsymbol{x}} \\hat{N}=\\mathbf{J}^{-T}\\nabla_{\\boldsymbol{\\xi}}\\hat{N}$ 与参考梯度相关，$\\nabla_{\\boldsymbol{\\xi}}$ 是 $(\\xi,\\eta)$ 中的梯度。\n\n仅从这些定义以及给定的节点坐标和气泡模式出发：\n- 推导显式映射 $x(\\xi,\\eta)$ 和 $y(\\xi,\\eta)$ 以及雅可比矩阵 $\\mathbf{J}(\\xi,\\eta)$。\n- 计算 $\\nabla_{\\boldsymbol{x}}\\hat{N}(\\xi,\\eta)$ 作为 $(\\xi,\\eta)$ 函数的闭式表达式。\n- 精确计算 $K_b$。\n- 计算“常数度量”近似值 $K_b^{(0)}$，该近似值通过在单元中心 $(\\xi,\\eta)=(0,0)$ 处冻结 $\\mathbf{J}$ 得到，即在积分中取 $\\mathbf{J}(\\xi,\\eta)\\equiv \\mathbf{J}(0,0)$ 和 $\\det\\mathbf{J}(\\xi,\\eta)\\equiv \\det\\mathbf{J}(0,0)$。\n- 将比率 $R=K_b/K_b^{(0)}$ 报告为单个闭式解析表达式。不要四舍五入；提供精确表达式。比率 $R$ 是无量纲的。",
            "solution": "用户想要解决一个与等参有限元相关的问题。我将首先验证问题陈述，如果有效，则继续进行求解。\n\n### 步骤 1：提取已知条件\n-   **单元类型**：四节点双线性四边形单元。\n-   **参考单元坐标**：$(\\xi,\\eta) \\in [-1,1] \\times [-1,1]$。\n-   **双线性形函数**：\n    $N_1(\\xi,\\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta)$\n    $N_2(\\xi,\\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta)$\n    $N_3(\\xi,\\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta)$\n    $N_4(\\xi,\\eta) = \\frac{1}{4}(1-\\xi)(1+\\eta)$\n-   **物理节点坐标**：\n    $(x_1,y_1)=(-0.5,-1)$\n    $(x_2,y_2)=(0.5,-1)$\n    $(x_3,y_3)=(1.5,1)$\n    $(x_4,y_4)=(-1.5,1)$\n-   **等参映射**：$x(\\xi,\\eta)=\\sum_{i=1}^{4}N_i(\\xi,\\eta)\\,x_i$ 和 $y(\\xi,\\eta)=\\sum_{i=1}^{4}N_i(\\xi,\\eta)\\,y_i$。\n-   **雅可比矩阵**：$\\mathbf{J}(\\xi,\\eta)=\\begin{bmatrix}\\partial x/\\partial \\xi  \\partial x/\\partial \\eta \\\\ \\partial y/\\partial \\xi  \\partial y/\\partial \\eta\\end{bmatrix}$。\n-   **分层内部气泡模式**：$\\hat{N}(\\xi,\\eta)=(1-\\xi^2)(1-\\eta^2)$。\n-   **单元刚度积分**：$K_b=\\int_{-1}^{1}\\int_{-1}^{1} \\nabla_{\\boldsymbol{x}} \\hat{N}(\\xi,\\eta)\\cdot \\nabla_{\\boldsymbol{x}} \\hat{N}(\\xi,\\eta)\\,\\det\\mathbf{J}(\\xi,\\eta)\\,d\\xi\\,d\\eta$。\n-   **梯度变换**：$\\nabla_{\\boldsymbol{x}} \\hat{N}=\\mathbf{J}^{-T}\\nabla_{\\boldsymbol{\\xi}}\\hat{N}$。\n-   **近似刚度积分**：$K_b^{(0)}$ 是通过在刚度积分中用 $\\mathbf{J}(0,0)$ 替换 $\\mathbf{J}(\\xi,\\eta)$ 来计算的。\n-   **目标**：计算比率 $R=K_b/K_b^{(0)}$。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题定义明确，并以有限元法 (FEM) 的标准理论为基础。所有概念——等参映射、形函数、变换的雅可比矩阵、分层基函数和刚度矩阵计算——都是计算力学的基础。给定的数据是完整且自洽的。\n\n为确保问题是适定的，我们必须检查等参映射的有效性。如果雅可比行列式 $\\det\\mathbf{J}$ 在单元域 $[-1,1] \\times [-1,1]$ 内不为零或负数，则映射有效。我将在求解过程中计算这一点。如果对于域中所有的 $(\\xi,\\eta)$，$\\det\\mathbf{J} > 0$，则映射是一对一的，问题是适定的。该问题是客观的，没有任何科学或事实上的不健全之处。\n\n### 步骤 3：结论和行动\n该问题被认为是**有效的**。我将继续进行详细的求解。\n\n### 等参映射和雅可比矩阵的推导\n物理坐标 $(x,y)$ 由等参映射给出：\n$x(\\xi,\\eta) = \\sum_{i=1}^{4} N_i(\\xi,\\eta) x_i$\n$y(\\xi,\\eta) = \\sum_{i=1}^{4} N_i(\\xi,\\eta) y_i$\n\n代入节点坐标和形函数：\n$x(\\xi,\\eta) = \\frac{-0.5}{4}(1-\\xi)(1-\\eta) + \\frac{0.5}{4}(1+\\xi)(1-\\eta) + \\frac{1.5}{4}(1+\\xi)(1+\\eta) + \\frac{-1.5}{4}(1-\\xi)(1+\\eta)$\n为了方便，按形如 $1, \\xi, \\eta, \\xi\\eta$ 的基函数对各项进行分组：\n$x(\\xi,\\eta) = \\frac{1}{4}(-0.5+0.5+1.5-1.5) + \\frac{1}{4}(0.5+0.5+1.5+1.5)\\xi + \\frac{1}{4}(0.5-0.5+1.5-1.5)\\eta + \\frac{1}{4}(-0.5-0.5+1.5+1.5)\\xi\\eta$\n$x(\\xi,\\eta) = \\frac{1}{4}(0) + \\frac{1}{4}(4)\\xi + \\frac{1}{4}(0)\\eta + \\frac{1}{4}(2)\\xi\\eta = \\xi + \\frac{1}{2}\\xi\\eta$\n\n对 $y(\\xi,\\eta)$ 进行类似操作：\n$y(\\xi,\\eta) = \\frac{-1}{4}(1-\\xi)(1-\\eta) + \\frac{-1}{4}(1+\\xi)(1-\\eta) + \\frac{1}{4}(1+\\xi)(1+\\eta) + \\frac{1}{4}(1-\\xi)(1+\\eta)$\n$y(\\xi,\\eta) = \\frac{1}{4}(-1-1+1+1) + \\frac{1}{4}(1-1+1-1)\\xi + \\frac{1}{4}(1+1+1+1)\\eta + \\frac{1}{4}(-1+1+1-1)\\xi\\eta$\n$y(\\xi,\\eta) = \\frac{1}{4}(0) + \\frac{1}{4}(0)\\xi + \\frac{1}{4}(4)\\eta + \\frac{1}{4}(0)\\xi\\eta = \\eta$\n\n映射为 $x(\\xi,\\eta) = \\xi(1+\\frac{1}{2}\\eta)$ 和 $y(\\xi,\\eta) = \\eta$。\n\n接下来，我们计算雅可比矩阵 $\\mathbf{J}(\\xi,\\eta)$ 的分量：\n$\\frac{\\partial x}{\\partial \\xi} = 1 + \\frac{1}{2}\\eta$\n$\\frac{\\partial x}{\\partial \\eta} = \\frac{1}{2}\\xi$\n$\\frac{\\partial y}{\\partial \\xi} = 0$\n$\\frac{\\partial y}{\\partial \\eta} = 1$\n因此，雅可比矩阵为：\n$$\n\\mathbf{J}(\\xi,\\eta) = \\begin{pmatrix} 1 + \\frac{1}{2}\\eta  \\frac{1}{2}\\xi \\\\ 0  1 \\end{pmatrix}\n$$\n雅可比矩阵的行列式为：\n$$\n\\det\\mathbf{J}(\\xi,\\eta) = \\left(1 + \\frac{1}{2}\\eta\\right)(1) - \\left(\\frac{1}{2}\\xi\\right)(0) = 1 + \\frac{1}{2}\\eta\n$$\n对于 $\\eta \\in [-1,1]$，$\\det\\mathbf{J}$ 的范围是从 $1 - 1/2 = 1/2$ 到 $1 + 1/2 = 3/2$。由于在整个父单元上 $\\det\\mathbf{J} > 0$，因此映射是有效的。\n\n### 气泡模式梯度的推导\n分层气泡模式为 $\\hat{N}(\\xi,\\eta)=(1-\\xi^2)(1-\\eta^2)$。其在参考坐标 $\\boldsymbol{\\xi}=(\\xi,\\eta)$ 中的梯度为：\n$$\n\\nabla_{\\boldsymbol{\\xi}}\\hat{N} = \\begin{pmatrix} \\frac{\\partial \\hat{N}}{\\partial \\xi} \\\\ \\frac{\\partial \\hat{N}}{\\partial \\eta} \\end{pmatrix} = \\begin{pmatrix} -2\\xi(1-\\eta^2) \\\\ -2\\eta(1-\\xi^2) \\end{pmatrix}\n$$\n在物理坐标 $\\boldsymbol{x}=(x,y)$ 中的梯度为 $\\nabla_{\\boldsymbol{x}}\\hat{N} = \\mathbf{J}^{-T}\\nabla_{\\boldsymbol{\\xi}}\\hat{N}$。\n$$\n\\mathbf{J}^{-1} = \\frac{1}{\\det\\mathbf{J}}\\begin{pmatrix} 1  -\\frac{1}{2}\\xi \\\\ 0  1 + \\frac{1}{2}\\eta \\end{pmatrix} = \\frac{1}{1 + \\frac{1}{2}\\eta}\\begin{pmatrix} 1  -\\frac{1}{2}\\xi \\\\ 0  1 + \\frac{1}{2}\\eta \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{1 + \\frac{1}{2}\\eta}  -\\frac{\\xi/2}{1 + \\frac{1}{2}\\eta} \\\\ 0  1 \\end{pmatrix}\n$$\n$$\n\\mathbf{J}^{-T} = (\\mathbf{J}^{-1})^T = \\begin{pmatrix} \\frac{1}{1 + \\frac{1}{2}\\eta}  0 \\\\ -\\frac{\\xi/2}{1 + \\frac{1}{2}\\eta}  1 \\end{pmatrix}\n$$\n现在我们计算 $\\nabla_{\\boldsymbol{x}}\\hat{N}$：\n$$\n\\nabla_{\\boldsymbol{x}}\\hat{N} = \\begin{pmatrix} \\frac{1}{1 + \\frac{1}{2}\\eta}  0 \\\\ -\\frac{\\xi/2}{1 + \\frac{1}{2}\\eta}  1 \\end{pmatrix} \\begin{pmatrix} -2\\xi(1-\\eta^2) \\\\ -2\\eta(1-\\xi^2) \\end{pmatrix} = \\begin{pmatrix} \\frac{-2\\xi(1-\\eta^2)}{1 + \\eta/2} \\\\ \\frac{\\xi^2(1-\\eta^2)}{1+\\eta/2} - 2\\eta(1-\\xi^2) \\end{pmatrix}\n$$\n\n### 精确刚度 $K_b$ 的计算\n刚度项由 $K_b = \\int_{-1}^{1}\\int_{-1}^{1} (\\nabla_{\\boldsymbol{x}} \\hat{N} \\cdot \\nabla_{\\boldsymbol{x}} \\hat{N}) \\det\\mathbf{J} \\,d\\xi d\\eta$ 给出。\n被积函数可以使用恒等式 $(\\nabla_{\\boldsymbol{x}} \\hat{N} \\cdot \\nabla_{\\boldsymbol{x}} \\hat{N}) \\det\\mathbf{J} = (\\nabla_{\\boldsymbol{\\xi}}\\hat{N})^T \\mathbf{J}^{-1}\\mathbf{J}^{-T}(\\nabla_{\\boldsymbol{\\xi}}\\hat{N}) \\det\\mathbf{J} = \\frac{1}{\\det\\mathbf{J}} (\\nabla_{\\boldsymbol{\\xi}}\\hat{N})^T \\text{adj}(\\mathbf{J}^T\\mathbf{J}) (\\nabla_{\\boldsymbol{\\xi}}\\hat{N})$ 进行简化。\n一个更直接的形式是：被积函数 $I(\\xi, \\eta) = \\frac{1}{\\det\\mathbf{J}} \\left[ \\left(\\frac{\\partial y}{\\partial \\eta}\\frac{\\partial \\hat{N}}{\\partial \\xi} - \\frac{\\partial y}{\\partial \\xi}\\frac{\\partial \\hat{N}}{\\partial \\eta}\\right)^2 + \\left(-\\frac{\\partial x}{\\partial \\eta}\\frac{\\partial \\hat{N}}{\\partial \\xi} + \\frac{\\partial x}{\\partial \\xi}\\frac{\\partial \\hat{N}}{\\partial \\eta}\\right)^2 \\right]$\n代入导数：\n$A = \\frac{\\partial y}{\\partial \\eta}\\frac{\\partial \\hat{N}}{\\partial \\xi} - \\frac{\\partial y}{\\partial \\xi}\\frac{\\partial \\hat{N}}{\\partial \\eta} = (1)(-2\\xi(1-\\eta^2)) - (0)(\\dots) = -2\\xi(1-\\eta^2)$\n$B = -\\frac{\\partial x}{\\partial \\eta}\\frac{\\partial \\hat{N}}{\\partial \\xi} + \\frac{\\partial x}{\\partial \\xi}\\frac{\\partial \\hat{N}}{\\partial \\eta} = -(\\frac{\\xi}{2})(-2\\xi(1-\\eta^2)) + (1+\\frac{\\eta}{2})(-2\\eta(1-\\xi^2)) = \\xi^2(1-\\eta^2) - (2\\eta+\\eta^2)(1-\\xi^2)$\n$B = \\xi^2 - \\xi^2\\eta^2 - 2\\eta + 2\\eta\\xi^2 - \\eta^2 + \\eta^2\\xi^2 = \\xi^2(1+2\\eta) - \\eta(2+\\eta)$\n\n积分为 $K_b = \\int_{-1}^{1}\\int_{-1}^{1} \\frac{A^2+B^2}{1+\\eta/2} d\\xi d\\eta$。我们首先对 $\\xi$ 进行积分：\n$\\int_{-1}^1 A^2 d\\xi = \\int_{-1}^1 4\\xi^2(1-\\eta^2)^2 d\\xi = 4(1-\\eta^2)^2 [\\frac{\\xi^3}{3}]_{-1}^1 = \\frac{8}{3}(1-\\eta^2)^2$。\n$\\int_{-1}^1 B^2 d\\xi = \\int_{-1}^1 [\\xi^2(1+2\\eta) - \\eta(2+\\eta)]^2 d\\xi$\n$= (1+2\\eta)^2 \\int_{-1}^1 \\xi^4 d\\xi - 2\\eta(1+2\\eta)(2+\\eta) \\int_{-1}^1 \\xi^2 d\\xi + \\eta^2(2+\\eta)^2 \\int_{-1}^1 d\\xi$\n$= \\frac{2}{5}(1+2\\eta)^2 - \\frac{4}{3}\\eta(1+2\\eta)(2+\\eta) + 2\\eta^2(2+\\eta)^2$\n展开并按 $\\eta$ 的幂次合并各项得到：\n$\\int_{-1}^1 B^2 d\\xi = \\frac{2}{5} - \\frac{16}{15}\\eta + \\frac{44}{15}\\eta^2 + \\frac{16}{3}\\eta^3 + 2\\eta^4$\n$A^2+B^2$ 对 $\\xi$ 的积分为：\n$I_\\eta = \\int_{-1}^1 (A^2+B^2) d\\xi = \\frac{8}{3}(1-2\\eta^2+\\eta^4) + \\frac{2}{5} - \\frac{16}{15}\\eta + \\frac{44}{15}\\eta^2 + \\frac{16}{3}\\eta^3 + 2\\eta^4$\n$I_\\eta = (\\frac{8}{3}+\\frac{2}{5}) - \\frac{16}{15}\\eta + (-\\frac{16}{3}+\\frac{44}{15})\\eta^2 + \\frac{16}{3}\\eta^3 + (\\frac{8}{3}+2)\\eta^4$\n$I_\\eta = \\frac{46}{15} - \\frac{16}{15}\\eta - \\frac{36}{15}\\eta^2 + \\frac{16}{3}\\eta^3 + \\frac{14}{3}\\eta^4 = \\frac{46}{15} - \\frac{16}{15}\\eta - \\frac{12}{5}\\eta^2 + \\frac{16}{3}\\eta^3 + \\frac{14}{3}\\eta^4$\n\n现在我们必须计算 $K_b = \\int_{-1}^{1} \\frac{I_\\eta}{1+\\eta/2} d\\eta = 2 \\int_{-1}^{1} \\frac{I_\\eta}{\\eta+2} d\\eta$。\n对 $P(\\eta)=I_\\eta$ 使用多项式长除法（或以 $-2$ 为根的综合除法）：\n$I_\\eta = (\\eta+2) \\left(\\frac{14}{3}\\eta^3 - 4\\eta^2 + \\frac{28}{5}\\eta - \\frac{184}{15}\\right) + \\frac{138}{5}$\n积分变为：\n$K_b = 2 \\int_{-1}^{1} \\left( \\frac{14}{3}\\eta^3 - 4\\eta^2 + \\frac{28}{5}\\eta - \\frac{184}{15} + \\frac{138/5}{\\eta+2} \\right) d\\eta$\n在对称区间 $[-1,1]$ 上，奇次幂 $\\eta^3$ 和 $\\eta$ 的积分为零。\n$K_b = 2 \\left[ -4\\frac{\\eta^3}{3} - \\frac{184}{15}\\eta + \\frac{138}{5}\\ln|\\eta+2| \\right]_{-1}^{1}$\n$K_b = 2 \\left( \\left(-\\frac{4}{3} - \\frac{184}{15}\\right) - \\left(\\frac{4}{3} + \\frac{184}{15}\\right) \\right) + 2 \\left( \\frac{138}{5}(\\ln(3) - \\ln(1)) \\right)$\n$K_b = 2 \\left( -2\\left(\\frac{4}{3} + \\frac{184}{15}\\right) \\right) + \\frac{276}{5}\\ln(3)$\n$K_b = -4\\left(\\frac{20+184}{15}\\right) + \\frac{276}{5}\\ln(3) = -4\\left(\\frac{204}{15}\\right) + \\frac{276}{5}\\ln(3) = -\\frac{816}{15} + \\frac{276}{5}\\ln(3)$\n$K_b = -\\frac{272}{5} + \\frac{276}{5}\\ln(3) = \\frac{4}{5}(69\\ln(3) - 68)$\n\n### 近似刚度 $K_b^{(0)}$ 的计算\n对于近似计算，我们使用 $\\mathbf{J}_0 = \\mathbf{J}(0,0)$ 和 $\\det\\mathbf{J}_0 = \\det\\mathbf{J}(0,0)$。\n在 $(\\xi,\\eta)=(0,0)$ 处，$\\mathbf{J}_0 = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} = \\mathbf{I}$，且 $\\det\\mathbf{J}_0 = 1$。\n近似刚度为：\n$K_b^{(0)} = \\int_{-1}^{1}\\int_{-1}^{1} (\\nabla_{\\boldsymbol{x}}\\hat{N} \\cdot \\nabla_{\\boldsymbol{x}}\\hat{N}) \\det\\mathbf{J}_0 d\\xi d\\eta$，其中 $\\nabla_{\\boldsymbol{x}}\\hat{N} = \\mathbf{J}_0^{-T}\\nabla_{\\boldsymbol{\\xi}}\\hat{N} = \\mathbf{I}\\nabla_{\\boldsymbol{\\xi}}\\hat{N} = \\nabla_{\\boldsymbol{\\xi}}\\hat{N}$。\n$K_b^{(0)} = \\int_{-1}^{1}\\int_{-1}^{1} (\\nabla_{\\boldsymbol{\\xi}}\\hat{N} \\cdot \\nabla_{\\boldsymbol{\\xi}}\\hat{N}) (1) d\\xi d\\eta = \\int_{-1}^{1}\\int_{-1}^{1} \\left( \\left(\\frac{\\partial\\hat{N}}{\\partial\\xi}\\right)^2 + \\left(\\frac{\\partial\\hat{N}}{\\partial\\eta}\\right)^2 \\right) d\\xi d\\eta$\n我们分别计算这两项：\n$\\int_{-1}^{1}\\int_{-1}^{1} \\left(\\frac{\\partial\\hat{N}}{\\partial\\xi}\\right)^2 d\\xi d\\eta = \\int_{-1}^{1}\\int_{-1}^{1} (-2\\xi(1-\\eta^2))^2 d\\xi d\\eta = 4 \\left(\\int_{-1}^1 \\xi^2 d\\xi\\right) \\left(\\int_{-1}^1 (1-\\eta^2)^2 d\\eta\\right)$\n$\\int_{-1}^1 \\xi^2 d\\xi = \\frac{2}{3}$\n$\\int_{-1}^1 (1-\\eta^2)^2 d\\eta = \\int_{-1}^1 (1-2\\eta^2+\\eta^4)d\\eta = \\left[\\eta - \\frac{2\\eta^3}{3} + \\frac{\\eta^5}{5}\\right]_{-1}^1 = 2(1 - \\frac{2}{3} + \\frac{1}{5}) = 2(\\frac{15-10+3}{15}) = \\frac{16}{15}$\n所以，第一个积分为 $4(\\frac{2}{3})(\\frac{16}{15}) = \\frac{128}{45}$。\n根据对称性，$\\int_{-1}^{1}\\int_{-1}^{1} (\\frac{\\partial\\hat{N}}{\\partial\\eta})^2 d\\xi d\\eta = \\frac{128}{45}$。\n$K_b^{(0)} = \\frac{128}{45} + \\frac{128}{45} = \\frac{256}{45}$。\n\n### 比率 $R$ 的计算\n比率为 $R = \\frac{K_b}{K_b^{(0)}}$。\n$$\nR = \\frac{\\frac{4}{5}(69\\ln(3) - 68)}{\\frac{256}{45}} = \\frac{4}{5} \\cdot \\frac{45}{256} (69\\ln(3) - 68)\n$$\n$$\nR = \\left(\\frac{4}{256}\\right) \\left(\\frac{45}{5}\\right) (69\\ln(3) - 68) = \\left(\\frac{1}{64}\\right) (9) (69\\ln(3) - 68) = \\frac{9}{64}(69\\ln(3) - 68)\n$$\n这是比率 $R$ 的最终闭式解析表达式。",
            "answer": "$$\\boxed{\\frac{9}{64}(69\\ln(3) - 68)}$$"
        }
    ]
}