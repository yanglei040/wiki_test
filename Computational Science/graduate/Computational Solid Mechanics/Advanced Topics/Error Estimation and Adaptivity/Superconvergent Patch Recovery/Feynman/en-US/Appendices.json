{
    "hands_on_practices": [
        {
            "introduction": "At its core, the Superconvergent Patch Recovery (SPR) method is a sophisticated averaging technique based on a local least-squares fit. This first exercise provides a direct, hands-on opportunity to perform the fundamental calculation of SPR. By fitting a simple linear polynomial, $\\sigma_{xx}(x,y) = a_{0} + a_{1} x + a_{2} y$, to a given set of discrete stress values from a patch of elements, you will recover a more accurate, continuous stress field and evaluate it at the central node .",
            "id": "3603832",
            "problem": "Consider a stress recovery task in the Finite Element Method (FEM), where a nodal stress is to be obtained by smoothing Gauss-point stresses on a patch using a least-squares fit of a linear field. In the Superconvergent Patch Recovery (SPR), one approximates a single stress component by a polynomial over a local patch and determines its coefficients by minimizing the sum of squared residuals, consistent with an $L^{2}$ projection viewpoint. Assume the stress component of interest is the normal stress in the $x$-direction, denoted by $\\sigma_{xx}$, and that it is modeled over the patch by the linear field\n$$\n\\sigma_{xx}(x,y) = a_{0} + a_{1} x + a_{2} y,\n$$\nwhere $x$ and $y$ are the global Cartesian coordinates (in $\\mathrm{mm}$), and the coefficients $a_{0}$, $a_{1}$, and $a_{2}$ are to be determined.\n\nYou are given Gauss-point data from a patch surrounding a node located at $(x,y) = (0\\,\\mathrm{mm}, 0\\,\\mathrm{mm})$. The Gauss-point coordinates $(x_i,y_i)$ and their corresponding computed values of $\\sigma_{xx}$ (in $\\mathrm{MPa}$) are:\n- $(x_1, y_1) = (1.0\\,\\mathrm{mm}, 0.0\\,\\mathrm{mm})$, with $\\sigma_{xx,1} = 122\\,\\mathrm{MPa}$,\n- $(x_2, y_2) = (-1.0\\,\\mathrm{mm}, 0.0\\,\\mathrm{mm})$, with $\\sigma_{xx,2} = 79\\,\\mathrm{MPa}$,\n- $(x_3, y_3) = (0.0\\,\\mathrm{mm}, 1.0\\,\\mathrm{mm})$, with $\\sigma_{xx,3} = 91\\,\\mathrm{MPa}$,\n- $(x_4, y_4) = (0.0\\,\\mathrm{mm}, -1.0\\,\\mathrm{mm})$, with $\\sigma_{xx,4} = 107\\,\\mathrm{MPa}$,\n- $(x_5, y_5) = (1.0\\,\\mathrm{mm}, 1.0\\,\\mathrm{mm})$, with $\\sigma_{xx,5} = 110\\,\\mathrm{MPa}$,\n- $(x_6, y_6) = (-1.0\\,\\mathrm{mm}, -1.0\\,\\mathrm{mm})$, with $\\sigma_{xx,6} = 92\\,\\mathrm{MPa}$.\n\nUsing an unweighted least-squares criterion over the above data, determine the coefficients $a_{0}$, $a_{1}$, and $a_{2}$ of the best-fit linear field $\\sigma_{xx}(x,y)$. Then evaluate the recovered nodal stress at the node $(x,y) = (0.0\\,\\mathrm{mm}, 0.0\\,\\mathrm{mm})$. Express the final recovered nodal stress in $\\mathrm{MPa}$ and round your answer to four significant figures.",
            "solution": "The user wants to find the recovered nodal stress at the center of a patch of Gauss points by performing an unweighted least-squares fit of a linear stress field to the given data.\n\n### Step 1: Problem Validation\n\nThe givens are:\n- The stress field model: $\\sigma_{xx}(x,y) = a_{0} + a_{1} x + a_{2} y$.\n- The node location for stress recovery: $(x,y) = (0\\,\\mathrm{mm}, 0\\,\\mathrm{mm})$.\n- The set of $6$ Gauss-point data $(x_i, y_i, \\sigma_{xx,i})$:\n  1. $(1.0, 0.0)$, $\\sigma_{xx,1} = 122$\n  2. $(-1.0, 0.0)$, $\\sigma_{xx,2} = 79$\n  3. $(0.0, 1.0)$, $\\sigma_{xx,3} = 91$\n  4. $(0.0, -1.0)$, $\\sigma_{xx,4} = 107$\n  5. $(1.0, 1.0)$, $\\sigma_{xx,5} = 110$\n  6. $(-1.0, -1.0)$, $\\sigma_{xx,6} = 92$\n  All coordinates are in $\\mathrm{mm}$ and all stresses are in $\\mathrm{MPa}$.\n- The method: Unweighted least-squares criterion.\n- The final output requirement: The recovered nodal stress at $(0,0)$ rounded to four significant figures.\n\nThe problem is scientifically grounded, as it describes the Superconvergent Patch Recovery (SPR) method, a standard and well-established post-processing technique in computational solid mechanics. It is well-posed, objective, self-contained, and free of any contradictions or ambiguities. The data provided allow for a unique solution. Therefore, the problem is deemed valid.\n\n### Step 2: Solution Formulation\n\nThe goal is to find the coefficients $a_{0}$, $a_{1}$, and $a_{2}$ that minimize the sum of the squared errors, $S$, between the linear model and the given Gauss-point stresses. The objective function to minimize is:\n$$\nS(a_{0}, a_{1}, a_{2}) = \\sum_{i=1}^{6} \\left[ \\sigma_{xx}(x_i, y_i) - \\sigma_{xx,i} \\right]^2 = \\sum_{i=1}^{6} \\left[ (a_{0} + a_{1} x_i + a_{2} y_i) - \\sigma_{xx,i} \\right]^2\n$$\nThis is a standard linear least-squares problem. We can express the problem in matrix form. Let $\\mathbf{a}$ be the vector of unknown coefficients, $\\boldsymbol{\\sigma}$ be the vector of known stress values, and $\\mathbf{A}$ be the design matrix:\n$$\n\\mathbf{a} = \\begin{pmatrix} a_0 \\\\ a_1 \\\\ a_2 \\end{pmatrix}, \\quad \\boldsymbol{\\sigma} = \\begin{pmatrix} \\sigma_{xx,1} \\\\ \\sigma_{xx,2} \\\\ \\sigma_{xx,3} \\\\ \\sigma_{xx,4} \\\\ \\sigma_{xx,5} \\\\ \\sigma_{xx,6} \\end{pmatrix}, \\quad \\mathbf{A} = \\begin{pmatrix} 1 & x_1 & y_1 \\\\ 1 & x_2 & y_2 \\\\ 1 & x_3 & y_3 \\\\ 1 & x_4 & y_4 \\\\ 1 & x_5 & y_5 \\\\ 1 & x_6 & y_6 \\end{pmatrix}\n$$\nThe minimization of $S = \\|\\mathbf{A}\\mathbf{a} - \\boldsymbol{\\sigma}\\|^2$ leads to the normal equations:\n$$\n(\\mathbf{A}^T \\mathbf{A}) \\mathbf{a} = \\mathbf{A}^T \\boldsymbol{\\sigma}\n$$\nLet's construct the matrices using the given data. All coordinates $(x_i, y_i)$ are in $\\mathrm{mm}$ and stresses $\\sigma_{xx,i}$ are in $\\mathrm{MPa}$.\n$$\n\\mathbf{A} = \\begin{pmatrix} 1 & 1.0 & 0.0 \\\\ 1 & -1.0 & 0.0 \\\\ 1 & 0.0 & 1.0 \\\\ 1 & 0.0 & -1.0 \\\\ 1 & 1.0 & 1.0 \\\\ 1 & -1.0 & -1.0 \\end{pmatrix}, \\quad \\boldsymbol{\\sigma} = \\begin{pmatrix} 122 \\\\ 79 \\\\ 91 \\\\ 107 \\\\ 110 \\\\ 92 \\end{pmatrix}\n$$\nNow, we compute the matrix $\\mathbf{A}^T \\mathbf{A}$ and the vector $\\mathbf{A}^T \\boldsymbol{\\sigma}$. The components of $\\mathbf{A}^T \\mathbf{A}$ involve sums of powers and products of the coordinates:\n$$\n\\mathbf{A}^T \\mathbf{A} = \\begin{pmatrix} \\sum 1 & \\sum x_i & \\sum y_i \\\\ \\sum x_i & \\sum x_i^2 & \\sum x_i y_i \\\\ \\sum y_i & \\sum x_i y_i & \\sum y_i^2 \\end{pmatrix}\n$$\nLet's compute the sums over the $N=6$ data points:\n$\\sum 1 = 6$\n$\\sum x_i = 1.0 - 1.0 + 0.0 + 0.0 + 1.0 - 1.0 = 0$\n$\\sum y_i = 0.0 + 0.0 + 1.0 - 1.0 + 1.0 - 1.0 = 0$\n$\\sum x_i^2 = (1.0)^2 + (-1.0)^2 + (0.0)^2 + (0.0)^2 + (1.0)^2 + (-1.0)^2 = 1.0 + 1.0 + 0.0 + 0.0 + 1.0 + 1.0 = 4.0$\n$\\sum y_i^2 = (0.0)^2 + (0.0)^2 + (1.0)^2 + (-1.0)^2 + (1.0)^2 + (-1.0)^2 = 0.0 + 0.0 + 1.0 + 1.0 + 1.0 + 1.0 = 4.0$\n$\\sum x_i y_i = (1.0)(0.0) + (-1.0)(0.0) + (0.0)(1.0) + (0.0)(-1.0) + (1.0)(1.0) + (-1.0)(-1.0) = 0.0 + 0.0 + 0.0 + 0.0 + 1.0 + 1.0 = 2.0$\n\nThus, the matrix $\\mathbf{A}^T \\mathbf{A}$ is:\n$$\n\\mathbf{A}^T \\mathbf{A} = \\begin{pmatrix} 6 & 0 & 0 \\\\ 0 & 4 & 2 \\\\ 0 & 2 & 4 \\end{pmatrix}\n$$\nNext, we compute the vector $\\mathbf{A}^T \\boldsymbol{\\sigma}$:\n$$\n\\mathbf{A}^T \\boldsymbol{\\sigma} = \\begin{pmatrix} \\sum \\sigma_{xx,i} \\\\ \\sum x_i \\sigma_{xx,i} \\\\ \\sum y_i \\sigma_{xx,i} \\end{pmatrix}\n$$\nLet's compute these sums:\n$\\sum \\sigma_{xx,i} = 122 + 79 + 91 + 107 + 110 + 92 = 601$\n$\\sum x_i \\sigma_{xx,i} = (1.0)(122) + (-1.0)(79) + (0.0)(91) + (0.0)(107) + (1.0)(110) + (-1.0)(92) = 122 - 79 + 110 - 92 = 43 + 18 = 61$\n$\\sum y_i \\sigma_{xx,i} = (0.0)(122) + (0.0)(79) + (1.0)(91) + (-1.0)(107) + (1.0)(110) + (-1.0)(92) = 91 - 107 + 110 - 92 = -16 + 18 = 2$\n\nSo, the vector $\\mathbf{A}^T \\boldsymbol{\\sigma}$ is:\n$$\n\\mathbf{A}^T \\boldsymbol{\\sigma} = \\begin{pmatrix} 601 \\\\ 61 \\\\ 2 \\end{pmatrix}\n$$\nThe normal equations are:\n$$\n\\begin{pmatrix} 6 & 0 & 0 \\\\ 0 & 4 & 2 \\\\ 0 & 2 & 4 \\end{pmatrix} \\begin{pmatrix} a_0 \\\\ a_1 \\\\ a_2 \\end{pmatrix} = \\begin{pmatrix} 601 \\\\ 61 \\\\ 2 \\end{pmatrix}\n$$\nThis gives us a system of three linear equations:\n1. $6 a_0 = 601$\n2. $4 a_1 + 2 a_2 = 61$\n3. $2 a_1 + 4 a_2 = 2$\n\nFrom equation (1), we immediately find $a_0$:\n$$\na_0 = \\frac{601}{6}\n$$\nEquations (2) and (3) form a $2 \\times 2$ system for $a_1$ and $a_2$. We can solve this system. Multiply equation (3) by $2$:\n$$\n4 a_1 + 8 a_2 = 4\n$$\nSubtract equation (2) from this new equation:\n$$\n(4 a_1 + 8 a_2) - (4 a_1 + 2 a_2) = 4 - 61\n$$\n$$\n6 a_2 = -57 \\implies a_2 = -\\frac{57}{6} = -\\frac{19}{2} = -9.5\n$$\nSubstitute $a_2$ back into equation (3):\n$$\n2 a_1 + 4 (-9.5) = 2 \\implies 2 a_1 - 38 = 2 \\implies 2 a_1 = 40 \\implies a_1 = 20\n$$\nThe coefficients of the best-fit linear field are:\n$$\na_0 = \\frac{601}{6}, \\quad a_1 = 20, \\quad a_2 = -9.5\n$$\nThe smoothed stress field is:\n$$\n\\sigma_{xx}(x,y) = \\frac{601}{6} + 20 x - 9.5 y\n$$\nThe problem asks for the recovered nodal stress at the node $(x,y) = (0,0)$. We evaluate the fitted field at this point:\n$$\n\\sigma_{xx}(0,0) = a_0 + a_1(0) + a_2(0) = a_0 = \\frac{601}{6}\n$$\nNow, we compute the numerical value and round to four significant figures.\n$$\n\\sigma_{xx}(0,0) = \\frac{601}{6} \\approx 100.1666... \\, \\mathrm{MPa}\n$$\nRounding to four significant figures, we look at the fifth significant digit. The first four are $1, 0, 0, 1$. The fifth digit is $6$, which is greater than or equal to $5$, so we round up the fourth digit.\n$$\n\\sigma_{xx}(0,0) \\approx 100.2 \\, \\mathrm{MPa}\n$$",
            "answer": "$$\n\\boxed{100.2}\n$$"
        },
        {
            "introduction": "The previous practice assumed a straightforward fitting procedure, but real-world finite element meshes are rarely composed of perfectly shaped elements. This conceptual exercise delves into the crucial theoretical implications of geometric distortion, which is handled in FEM via isoparametric mapping. You will explore how the Jacobian of the transformation, $\\det J$, which relates the reference element to the physical element, plays a critical role in preserving the accuracy of SPR and why a simple unweighted fit can fail on distorted meshes .",
            "id": "3604340",
            "problem": "Consider a single bilinear isoparametric quadrilateral element with physical node coordinates $X_1=(0,0)$, $X_2=(2,0)$, $X_3=(2, \\frac{3}{2})$, and $X_4=(0,1)$. Let $(\\xi,\\eta) \\in [-1,1] \\times [-1,1]$ denote the reference coordinates and let $x(\\xi,\\eta)$ be the usual isoparametric mapping defined by the bilinear shape functions. Denote the Jacobian matrix by $J(\\xi,\\eta) = \\partial x / \\partial(\\xi, \\eta)$ with determinant $\\det J(\\xi,\\eta)$.\n\nIn a Superconvergent Patch Recovery (SPR), one forms a least-squares fit of a polynomial stress field over a patch using stresses sampled at element Gauss points. In the reference element, the standard $2\\times 2$ Gauss points are at $(\\pm 1/\\sqrt{3},\\pm 1/\\sqrt{3})$. In an affine map (parallelogram element), $\\det J$ is constant; for a general bilinear distorted map, $\\det J$ varies spatially.\n\nUsing only fundamental definitions of isoparametric mapping, Gaussian quadrature, and change of variables for integrals, answer the following conceptual question:\n\nWhich statement best characterizes the effect of the Jacobian and the isoparametric mapping on the location of the superconvergent sampling points and the accuracy of SPR when one fits the recovered field in physical coordinates $(x,y)$ versus in reference coordinates $(\\xi,\\eta)$?\n\nA. For the given bilinear distorted element, the images of the reference $2\\times 2$ Gauss points are non-uniformly distributed in physical space because $\\det J(\\xi,\\eta)$ varies with $\\xi$. Consequently, a least-squares recovery posed in physical coordinates, or equivalently in $(\\xi,\\eta)$ but with residuals weighted by $|\\det J|$ and a basis expressed as polynomials in $(x,y)$, preserves the nominal SPR accuracy. Performing an unweighted fit in $(\\xi,\\eta)$ to polynomials in $(\\xi,\\eta)$ generally degrades accuracy on distorted meshes, whereas for affine maps (constant $J$) both approaches are equivalent.\n\nB. The Jacobian only rescales integration weights and does not affect where Gauss points map in physical space; therefore, recovering in $(\\xi,\\eta)$ is always equivalent to recovering in $(x,y)$, regardless of element distortion.\n\nC. Because the element is bilinear, the images of the $2\\times 2$ Gauss points are always the superconvergent points in physical space, independent of $J(\\xi,\\eta)$; hence one should always perform SPR in reference coordinates.\n\nD. Recovering in physical coordinates is always worse than in reference coordinates because the mapping induces aliasing; the optimal practice is to fit in $(\\xi,\\eta)$ without any Jacobian weighting so that the Gauss points remain symmetric.",
            "solution": "The problem asks for a conceptual characterization of the isoparametric mapping's effect on Superconvergent Patch Recovery (SPR), comparing recovery procedures performed in physical coordinates versus reference coordinates.\n\nFirst, let us formalize the problem setup. The isoparametric mapping from the reference element, a square defined by $(\\xi, \\eta) \\in [-1, 1] \\times [-1, 1]$, to the physical element is given by:\n$$ \\mathbf{x}(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) \\mathbf{X}_{i} $$\nwhere $\\mathbf{X}_i$ are the physical coordinates of the nodes and $N_i(\\xi, \\eta)$ are the bilinear shape functions:\n\\begin{align*} N_1(\\xi, \\eta) &= \\frac{1}{4}(1-\\xi)(1-\\eta) \\\\ N_2(\\xi, \\eta) &= \\frac{1}{4}(1+\\xi)(1-\\eta) \\\\ N_3(\\xi, \\eta) &= \\frac{1}{4}(1+\\xi)(1+\\eta) \\\\ N_4(\\xi, \\eta) &= \\frac{1}{4}(1-\\xi)(1+\\eta) \\end{align*}\nThe given nodal coordinates are $\\mathbf{X}_1 = (0,0)$, $\\mathbf{X}_2 = (2,0)$, $\\mathbf{X}_3 = (2, \\frac{3}{2})$, and $\\mathbf{X}_4 = (0,1)$. The mapping coordinates $(x,y)$ are therefore:\n$$ x(\\xi, \\eta) = N_1(0) + N_2(2) + N_3(2) + N_4(0) = \\frac{1}{4}(1+\\xi)(1-\\eta)(2) + \\frac{1}{4}(1+\\xi)(1+\\eta)(2) = \\frac{1}{2}(1+\\xi)(1-\\eta + 1+\\eta) = 1+\\xi $$\n$$ y(\\xi, \\eta) = N_1(0) + N_2(0) + N_3(\\frac{3}{2}) + N_4(1) = \\frac{1}{4}(1+\\xi)(1+\\eta)\\frac{3}{2} + \\frac{1}{4}(1-\\xi)(1+\\eta)(1) $$\n$$ y(\\xi, \\eta) = \\frac{1+\\eta}{4} \\left[ (1+\\xi)\\frac{3}{2} + (1-\\xi) \\right] = \\frac{1+\\eta}{4} \\left[ \\frac{3}{2} + \\frac{3}{2}\\xi + 1 - \\xi \\right] = \\frac{1+\\eta}{4} \\left[ \\frac{5}{2} + \\frac{1}{2}\\xi \\right] = \\frac{1}{8}(1+\\eta)(5+\\xi) $$\nThis element is not a parallelogram, which would have an affine mapping. Here, the $y$ coordinate has a bilinear $\\xi\\eta$ term, confirming it is a distorted quadrilateral.\n\nThe Jacobian matrix of the transformation is $\\mathbf{J} = \\frac{\\partial(x,y)}{\\partial(\\xi,\\eta)}$:\n$$ \\mathbf{J}(\\xi, \\eta) = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix} = \\begin{pmatrix} 1 & 0 \\\\ \\frac{1}{8}(1+\\eta) & \\frac{1}{8}(5+\\xi) \\end{pmatrix} $$\nThe determinant of the Jacobian is:\n$$ \\det \\mathbf{J}(\\xi, \\eta) = (1)\\left(\\frac{1}{8}(5+\\xi)\\right) - (0)\\left(\\frac{1}{8}(1+\\eta)\\right) = \\frac{5+\\xi}{8} $$\nAs stated in the problem, for this distorted element, $\\det \\mathbf{J}$ is not constant; it depends on $\\xi$. This is a crucial observation.\n\nThe core principle of SPR is to find a smooth polynomial field, $\\sigma^*(x,y)$, that best fits the raw, highly accurate finite element stresses, $\\sigma^h$, sampled at superconvergent points (typically the Gauss points). \"Best fit\" is usually interpreted in the sense of minimizing the $L_2$ error norm over the patch of elements $\\Omega_p$:\n$$ \\text{Minimize } \\| \\sigma^* - \\sigma^h \\|_{L_2(\\Omega_p)}^2 = \\int_{\\Omega_p} (\\sigma^*(x,y) - \\sigma^h(x,y))^2 \\, dA $$\nTo compute this integral, we sum the integrals over each element $\\Omega_e$ in the patch and transform to the reference domain:\n$$ \\int_{\\Omega_e} (\\sigma^* - \\sigma^h)^2 \\, dA = \\int_{-1}^{1}\\int_{-1}^{1} \\left[ \\sigma^*(x(\\xi,\\eta), y(\\xi,\\eta)) - \\sigma^h(\\xi,\\eta) \\right]^2 |\\det \\mathbf{J}(\\xi,\\eta)| \\, d\\xi \\, d\\eta $$\nApproximating this integral with $N_g$-point Gaussian quadrature (where weights are $w_g$ and points are $(\\xi_g, \\eta_g)$) yields a discrete sum to be minimized:\n$$ \\sum_{g=1}^{N_g} \\left[ \\sigma^*(x_g, y_g) - \\sigma^h_g \\right]^2 |\\det \\mathbf{J}(\\xi_g, \\eta_g)| w_g $$\nwhere $(x_g, y_g)$ are the physical coordinates of the Gauss points and $\\sigma^h_g$ is the raw stress sampled there. This is a **weighted** least-squares problem. The weights, $|\\det \\mathbf{J}| w_g$, account for the differential area element in physical space that each Gauss point represents. For distorted elements, $|\\det \\mathbf{J}|$ is not constant, so these weights are non-uniform.\n\nLet us now contrast two possible SPR procedures:\n1.  **Fit in Physical Coordinates $(x,y)$:** The recovered field $\\sigma^*$ is a polynomial in $x$ and $y$, e.g., $\\sigma^*(x,y) = a_0 + a_1 x + a_2 y$. The minimization is performed on the weighted sum above. This is the theoretically sound procedure as it correctly approximates the $L_2$ error minimization in the physical domain. The non-uniform values of $|\\det \\mathbf{J}|$ at the Gauss points correctly weight the contribution of each point.\n2.  **Fit in Reference Coordinates $(\\xi,\\eta)$:** A practitioner might be tempted to simplify the problem by performing an **unweighted** least-squares fit in the reference domain. Here, one would fit a polynomial $\\tilde{\\sigma}^*(\\xi, \\eta) = b_0 + b_1 \\xi + b_2 \\eta$ to the sampled stresses $\\sigma^h_g$ by minimizing:\n    $$ \\sum_{g=1}^{N_g} \\left[ \\tilde{\\sigma}^*(\\xi_g, \\eta_g) - \\sigma^h_g \\right]^2 w_g $$\n    This is computationally simpler because the sample points $(\\xi_g, \\eta_g)$ form a regular grid and the weights $w_g$ are uniform (for standard Gauss-Legendre quadrature). However, this procedure is physically equivalent to minimizing an unweighted sum of squared errors in the physical domain, which implicitly assumes that each Gauss point represents the same physical area. This is only true if $\\det \\mathbf{J}$ is constant. For a distorted element, this procedure is theoretically incorrect and will bias the fit, generally leading to a degradation in accuracy.\n\nNow, consider the special case of an **affine map** (a parallelogram element). In this case, the mapping is linear, the Jacobian matrix $\\mathbf{J}$ is constant, and therefore $\\det \\mathbf{J}$ is also constant. In this scenario, the weighting factor $|\\det \\mathbf{J}|$ is uniform across all Gauss points and can be factored out of the minimization. Furthermore, for an affine map, a polynomial in $(\\xi, \\eta)$ maps to a polynomial of the same degree in $(x,y)$. Consequently, for affine elements, the simple unweighted fit in reference coordinates is equivalent to the properly weighted fit in physical coordinates.\n\n**Evaluation of the Options:**\n\n*   **A. For the given bilinear distorted element, the images of the reference $2\\times 2$ Gauss points are non-uniformly distributed in physical space because $\\det J(\\xi,\\eta)$ varies with $\\xi$. Consequently, a least-squares recovery posed in physical coordinates, or equivalently in $(\\xi,\\eta)$ but with residuals weighted by $|\\det J|$ and a basis expressed as polynomials in $(x,y)$, preserves the nominal SPR accuracy. Performing an unweighted fit in $(\\xi,\\eta)$ to polynomials in $(\\xi,\\eta)$ generally degrades accuracy on distorted meshes, whereas for affine maps (constant $J$) both approaches are equivalent.**\n    This statement accurately describes the situation. The physical distribution of Gauss points is indeed non-uniform for a distorted element. It correctly identifies that the theoretically sound approach is a weighted least-squares fit, where the weight is the Jacobian determinant, whether the fit is conceptualized in physical or reference spaces. It correctly states that an unweighted fit in reference coordinates is problematic for distorted meshes but becomes equivalent for affine maps. This aligns perfectly with our derivation.\n    **Verdict: Correct**\n\n*   **B. The Jacobian only rescales integration weights and does not affect where Gauss points map in physical space; therefore, recovering in $(\\xi,\\eta)$ is always equivalent to recovering in $(x,y)$, regardless of element distortion.**\n    This statement contains a fundamental flaw. The Jacobian matrix contains the derivatives of the mapping function, so it is inextricably linked to how points are mapped. A non-constant Jacobian is a direct indicator of a non-affine (distorting) map. The conclusion that the two recovery methods are always equivalent is false; they are only equivalent for affine maps where the Jacobian determinant is constant.\n    **Verdict: Incorrect**\n\n*   **C. Because the element is bilinear, the images of the $2\\times 2$ Gauss points are always the superconvergent points in physical space, independent of $J(\\xi,\\eta)$; hence one should always perform SPR in reference coordinates.**\n    The premise is incorrect. The property that Gauss points are the locations of highest accuracy (superconvergence) for derivatives is strictly proven for rectangular elements and holds as a good approximation for mildly distorted (near-parallelogram) elements. For significantly distorted elements, the optimal sampling points can deviate from the mapped Gauss points. The quality of superconvergence is dependent on the mapping, and therefore on $J$. The conclusion to always use reference coordinates for the fit is also incorrect for distorted elements, as explained above.\n    **Verdict: Incorrect**\n\n*   **D. Recovering in physical coordinates is always worse than in reference coordinates because the mapping induces aliasing; the optimal practice is to fit in $(\\xi,\\eta)$ without any Jacobian weighting so that the Gauss points remain symmetric.**\n    This statement is the opposite of the correct principle. The goal of recovery is to obtain a better field in the physical domain, so a procedure that properly respects the geometry of the physical domain must be used. The claim that an unweighted fit in reference coordinates is \"optimal\" is false; this practice ignores the geometric distortion and is theoretically unsound for non-affine elements. The symmetry of points in the reference domain is irrelevant to the accuracy of the fit in the physical domain.\n    **Verdict: Incorrect**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "Superconvergent Patch Recovery is not merely a post-processing step for generating smoother plots; it is a cornerstone of adaptive meshing through a posteriori error estimation. This practice demonstrates the primary application of SPR by guiding you through the calculation of the celebrated Zienkiewicz-Zhu (ZZ) error indicator, $\\eta$. By calculating the energy norm of the difference between the recovered stress $\\sigma^{\\ast}$ and the raw finite element stress $\\sigma_{h}$, you will obtain a quantitative measure of the simulation's local error, which is essential for guiding mesh refinement .",
            "id": "3604343",
            "problem": "Consider a straight, prismatic, one-dimensional elastic bar of length $2\\,\\mathrm{m}$, modeled with two equal linear finite elements with nodes at $x=0$, $x=1$, and $x=2$. The bar has constant cross-sectional area $A = 1.0 \\times 10^{-2}\\,\\mathrm{m}^2$ and Young's modulus $E = 1.0 \\times 10^{7}\\,\\mathrm{Pa}$. The computed finite element nodal displacements are $u(0)=0$, $u(1)=1.0 \\times 10^{-3}\\,\\mathrm{m}$, and $u(2)=1.5 \\times 10^{-3}\\,\\mathrm{m}$.\n\nYou are to construct a Zienkiewicz–Zhu (ZZ) error indicator using Superconvergent Patch Recovery (SPR), under the assumptions of small strain and linear elasticity. Begin from the fundamental definitions $\\varepsilon(x) = \\mathrm{d}u/\\mathrm{d}x$ and $\\sigma(x) = E \\, \\varepsilon(x)$, and the energy-norm error density as the product of a constitutive inverse and the stress error.\n\nPerform the following steps:\n\n1. Compute the piecewise-constant finite element stress field $\\sigma_{h}$ on each element from the given nodal displacements, starting from $\\varepsilon(x) = \\mathrm{d}u/\\mathrm{d}x$ and $\\sigma(x) = E \\, \\varepsilon(x)$ for a linear two-node element.\n\n2. Construct a recovered stress field $\\sigma^{\\ast}(x)$ over the entire bar by a patch-based least-squares fit restricted to the linear ansatz $\\sigma^{\\ast}(x) = c_{0} + c_{1} x$, using the two superconvergent sampling points located at the element centers $x=0.5$ and $x=1.5$; take the target values at these points to be the corresponding elementwise finite element stresses $\\sigma_{h}$.\n\n3. Define the squared ZZ energy-norm error indicator for this bar as\n$$\n\\eta^{2} \\;=\\; \\sum_{e=1}^{2} \\int_{x_{e}}^{x_{e+1}} \\left(\\sigma^{\\ast}(x) - \\sigma_{h,e}\\right)^{2} \\,\\frac{A}{E}\\,\\mathrm{d}x,\n$$\nwhere $\\sigma_{h,e}$ is the constant finite element stress on element $e$. Evaluate each element integral using two-point Gauss–Legendre quadrature on the parent interval $[-1,1]$ with exact mapping, and justify why this quadrature is exact for this integrand.\n\nCompute $\\eta^{2}$ explicitly as a single real number. Express the final indicator energy in Joules and round your answer to four significant figures.",
            "solution": "The problem statement is evaluated as valid. It is self-contained, scientifically grounded in the principles of computational solid mechanics and the Finite Element Method (FEM), and well-posed, providing all necessary data and a clear, objective procedure for obtaining a unique solution.\n\nThe problem requires the computation of a squared Zienkiewicz–Zhu (ZZ) energy-norm error indicator, $\\eta^2$, for a one-dimensional elastic bar modeled with two linear finite elements. The solution proceeds by following the three steps outlined in the problem.\n\nGiven constants are:\nYoung's modulus, $E = 1.0 \\times 10^{7}\\,\\mathrm{Pa}$.\nCross-sectional area, $A = 1.0 \\times 10^{-2}\\,\\mathrm{m}^2$.\nThe ratio $A/E$ is $A/E = (1.0 \\times 10^{-2}) / (1.0 \\times 10^7) = 1.0 \\times 10^{-9}\\,\\mathrm{m}^2/\\mathrm{Pa}$.\n\nThe nodal coordinates are $x_1 = 0\\,\\mathrm{m}$, $x_2 = 1\\,\\mathrm{m}$, and $x_3 = 2\\,\\mathrm{m}$.\nThe nodal displacements are $u_1 = u(0) = 0\\,\\mathrm{m}$, $u_2 = u(1) = 1.0 \\times 10^{-3}\\,\\mathrm{m}$, and $u_3 = u(2) = 1.5 \\times 10^{-3}\\,\\mathrm{m}$.\n\n**1. Computation of the Finite Element Stress Field $\\sigma_h$**\n\nFor a one-dimensional, two-node linear finite element spanning from coordinate $x_a$ to $x_b$ with nodal displacements $u_a$ and $u_b$, the displacement field $u(x)$ is given by linear interpolation:\n$$\nu(x) = u_a \\frac{x_b - x}{x_b - x_a} + u_b \\frac{x - x_a}{x_b - x_a}\n$$\nThe strain $\\varepsilon(x) = \\mathrm{d}u/\\mathrm{d}x$ is constant within the element:\n$$\n\\varepsilon_h = \\frac{\\mathrm{d}u}{\\mathrm{d}x} = \\frac{u_b - u_a}{x_b - x_a}\n$$\nThe stress $\\sigma(x) = E \\varepsilon(x)$ is also constant, $\\sigma_h = E \\varepsilon_h$.\n\nFor element $1$ (from $x=0$ to $x=1$):\nThe nodal displacements are $u_1 = u(0) = 0$ and $u_2 = u(1) = 1.0 \\times 10^{-3}$.\nThe element length is $L_1 = 1 - 0 = 1\\,\\mathrm{m}$.\nThe strain is:\n$$\n\\varepsilon_{h,1} = \\frac{u(1) - u(0)}{1 - 0} = \\frac{1.0 \\times 10^{-3} - 0}{1} = 1.0 \\times 10^{-3}\n$$\nThe stress in element $1$ is:\n$$\n\\sigma_{h,1} = E \\varepsilon_{h,1} = (1.0 \\times 10^{7} \\, \\text{Pa}) \\times (1.0 \\times 10^{-3}) = 1.0 \\times 10^{4} \\, \\text{Pa}\n$$\n\nFor element $2$ (from $x=1$ to $x=2$):\nThe nodal displacements are $u_2 = u(1) = 1.0 \\times 10^{-3}$ and $u_3 = u(2) = 1.5 \\times 10^{-3}$.\nThe element length is $L_2 = 2 - 1 = 1\\,\\mathrm{m}$.\nThe strain is:\n$$\n\\varepsilon_{h,2} = \\frac{u(2) - u(1)}{2 - 1} = \\frac{1.5 \\times 10^{-3} - 1.0 \\times 10^{-3}}{1} = 0.5 \\times 10^{-3} = 5.0 \\times 10^{-4}\n$$\nThe stress in element $2$ is:\n$$\n\\sigma_{h,2} = E \\varepsilon_{h,2} = (1.0 \\times 10^{7} \\, \\text{Pa}) \\times (5.0 \\times 10^{-4}) = 5.0 \\times 10^{3} \\, \\text{Pa}\n$$\n\n**2. Construction of the Recovered Stress Field $\\sigma^{\\ast}(x)$**\n\nThe recovered stress field is assumed to be a linear function of position, $\\sigma^{\\ast}(x) = c_0 + c_1 x$. The coefficients $c_0$ and $c_1$ are determined by a least-squares fit using the finite element stresses at the superconvergent points. For linear elements, the center of each element is a superconvergent point for stress.\nThe sampling points are the centers of the elements: $x_{s1} = 0.5$ for element $1$, and $x_{s2} = 1.5$ for element $2$.\nThe target values for the fit are the constant FE stresses within each element: $\\sigma_h(0.5) = \\sigma_{h,1}$ and $\\sigma_h(1.5) = \\sigma_{h,2}$.\n\nSince there are two parameters ($c_0, c_1$) and two sampling points, the least-squares fit becomes an exact interpolation. We solve the following system of linear equations:\n$$\n\\sigma^{\\ast}(0.5) = c_0 + c_1(0.5) = 1.0 \\times 10^4 \\\\\n\\sigma^{\\ast}(1.5) = c_0 + c_1(1.5) = 5.0 \\times 10^3\n$$\nSubtracting the first equation from the second gives:\n$$\n(c_0 + 1.5 c_1) - (c_0 + 0.5 c_1) = 5.0 \\times 10^3 - 1.0 \\times 10^4 \\\\\nc_1 = -5.0 \\times 10^3\n$$\nSubstituting $c_1$ back into the first equation:\n$$\nc_0 + 0.5(-5.0 \\times 10^3) = 1.0 \\times 10^4 \\\\\nc_0 - 2.5 \\times 10^3 = 1.0 \\times 10^4 \\\\\nc_0 = 1.25 \\times 10^4\n$$\nThus, the recovered stress field is:\n$$\n\\sigma^{\\ast}(x) = 1.25 \\times 10^4 - (5.0 \\times 10^3) x \\quad (\\text{in Pa})\n$$\n\n**3. Evaluation of the Squared Error Indicator $\\eta^2$**\n\nThe squared ZZ energy-norm error indicator is given by:\n$$\n\\eta^{2} = \\sum_{e=1}^{2} \\int_{x_{e}}^{x_{e+1}} (\\sigma^{\\ast}(x) - \\sigma_{h,e})^{2} \\frac{A}{E} \\mathrm{d}x = \\frac{A}{E} \\left[ \\int_{0}^{1} (\\sigma^{\\ast}(x) - \\sigma_{h,1})^{2} \\mathrm{d}x + \\int_{1}^{2} (\\sigma^{\\ast}(x) - \\sigma_{h,2})^{2} \\mathrm{d}x \\right]\n$$\nThe integrands for each element are:\nFor element $1$: $(\\sigma^{\\ast}(x) - \\sigma_{h,1})^2 = (1.25 \\times 10^4 - 5.0 \\times 10^3 x - 1.0 \\times 10^4)^2 = (2.5 \\times 10^3 - 5.0 \\times 10^3 x)^2$.\nFor element $2$: $(\\sigma^{\\ast}(x) - \\sigma_{h,2})^2 = (1.25 \\times 10^4 - 5.0 \\times 10^3 x - 5.0 \\times 10^3)^2 = (7.5 \\times 10^3 - 5.0 \\times 10^3 x)^2$.\n\nThe problem requires evaluation using two-point Gauss–Legendre quadrature. This quadrature rule integrates polynomials of degree up to $2n-1 = 2(2)-1 = 3$ exactly. The integrands here are both quadratic polynomials ($\\text{degree } 2$), so the two-point rule will yield the exact result.\n\nLet $I_1 = \\int_{0}^{1} (2.5 \\times 10^3 - 5.0 \\times 10^3 x)^2 \\mathrm{d}x$ and $I_2 = \\int_{1}^{2} (7.5 \\times 10^3 - 5.0 \\times 10^3 x)^2 \\mathrm{d}x$.\n\nFor integral $I_1$ on $[0,1]$:\nMap $x \\in [0,1]$ to $\\xi \\in [-1,1]$ using $x = \\frac{1}{2}(\\xi+1)$, so $\\mathrm{d}x = \\frac{1}{2}\\mathrm{d}\\xi$.\nThe integrand becomes: $(2.5 \\times 10^3 - 5.0 \\times 10^3 \\frac{\\xi+1}{2})^2 = (2.5 \\times 10^3 - 2.5 \\times 10^3 (\\xi+1))^2 = (-2.5 \\times 10^3 \\xi)^2 = (6.25 \\times 10^6) \\xi^2$.\nSo, $I_1 = \\int_{-1}^{1} (6.25 \\times 10^6) \\xi^2 \\frac{1}{2} \\mathrm{d}\\xi = (3.125 \\times 10^6) \\int_{-1}^{1} \\xi^2 \\mathrm{d}\\xi$.\nThe two-point Gauss rule has points $\\xi = \\pm 1/\\sqrt{3}$ and weights $w=1$.\nLet $f(\\xi) = (3.125 \\times 10^6) \\xi^2$.\n$I_1 = f(-1/\\sqrt{3}) \\cdot 1 + f(1/\\sqrt{3}) \\cdot 1 = (3.125 \\times 10^6) (-\\frac{1}{\\sqrt{3}})^2 + (3.125 \\times 10^6) (\\frac{1}{\\sqrt{3}})^2 = 2 \\times (3.125 \\times 10^6) (\\frac{1}{3}) = \\frac{6.25 \\times 10^6}{3}$.\n\nFor integral $I_2$ on $[1,2]$:\nMap $x \\in [1,2]$ to $\\xi \\in [-1,1]$ using $x = \\frac{1}{2}(\\xi+3)$, so $\\mathrm{d}x = \\frac{1}{2}\\mathrm{d}\\xi$.\nThe integrand becomes: $(7.5 \\times 10^3 - 5.0 \\times 10^3 \\frac{\\xi+3}{2})^2 = (7.5 \\times 10^3 - 2.5 \\times 10^3 (\\xi+3))^2 = (7.5 \\times 10^3 - 2.5 \\times 10^3 \\xi - 7.5 \\times 10^3)^2 = (-2.5 \\times 10^3 \\xi)^2 = (6.25 \\times 10^6) \\xi^2$.\nThe integral $I_2$ is identical to $I_1$ in the parent coordinate system:\n$I_2 = \\int_{-1}^{1} (6.25 \\times 10^6) \\xi^2 \\frac{1}{2} \\mathrm{d}\\xi = \\frac{6.25 \\times 10^6}{3}$.\n\nTotal squared error:\n$$\n\\eta^2 = \\frac{A}{E} (I_1 + I_2) = (1.0 \\times 10^{-9}) \\left( \\frac{6.25 \\times 10^6}{3} + \\frac{6.25 \\times 10^6}{3} \\right)\n$$\n$$\n\\eta^2 = (1.0 \\times 10^{-9}) \\left( 2 \\times \\frac{6.25 \\times 10^6}{3} \\right) = (1.0 \\times 10^{-9}) \\left( \\frac{12.5 \\times 10^6}{3} \\right)\n$$\n$$\n\\eta^2 = \\frac{12.5}{3} \\times 10^{-3} \\approx 4.1666... \\times 10^{-3}\n$$\nThe units of $\\eta^2$ are $(\\text{m}^2/\\text{Pa}) \\times (\\text{Pa}^2 \\cdot \\text{m}) = \\text{N} \\cdot \\text{m} = \\text{J}$.\nRounding the result to four significant figures gives:\n$$\n\\eta^2 = 4.167 \\times 10^{-3} \\, \\text{J}\n$$",
            "answer": "$$\n\\boxed{4.167 \\times 10^{-3}}\n$$"
        }
    ]
}