{
    "hands_on_practices": [
        {
            "introduction": "To build robust computational models, we must first master the fundamentals. This practice returns to the canonical problem of a block on an inclined plane, providing a foundational benchmark for any friction algorithm. By implementing the logic to distinguish between stick and slip-threshold states based on the classic friction cone concept, you will develop a precise understanding of how to translate physical laws into a working computational test .",
            "id": "3555411",
            "problem": "You are asked to construct and validate a computational benchmark for a single rigid block in unilateral contact with a rigid inclined plane under gravity, modeled with Coulomb friction, focusing on the stick condition and the stick-slip transition threshold. The inclined plane makes an angle $\\,\\alpha\\,$ (in radians) with the horizontal. The block has mass $\\,m\\,$ (in kilograms), acceleration due to gravity $\\,g\\,$ (in meters per second squared), and a friction coefficient $\\,\\mu \\ge 0\\,$ (dimensionless). The coordinate system is defined such that the tangential direction $\\,t\\,$ is along the plane pointing downslope, and the normal direction $\\,n\\,$ is perpendicular to the plane pointing from the plane into the block. The contact is assumed to remain closed with zero normal gap $\\,g_n = 0\\,$ and nonnegative normal reaction $\\,R_n \\ge 0\\,$, and the block does not detach from the plane in any test case.\n\nFundamental base to be used:\n- Newton’s Second Law of Motion: $\\,\\sum F = m a\\,$.\n- Decomposition of gravitational force into tangential and normal components consistent with the defined coordinate system.\n- Coulomb friction law at contact: static friction satisfies $\\,|R_t| \\le \\mu R_n\\,$, and at the threshold of slip $\\,|R_t| = \\mu R_n\\,$. Here $\\,R_t\\,$ is the tangential reaction magnitude and $\\,R_n\\,$ is the normal reaction.\n- The stick condition is defined by $\\,\\tan\\alpha  \\mu\\,$, and the slip-threshold (onset of sliding) condition is defined by $\\,\\tan\\alpha = \\mu\\,$ within a specified numerical tolerance.\n\nYour task is to implement a program that, for each provided test case, determines the state classification and computes the reaction components magnitudes $\\,R_n\\,$ and $\\,R_t\\,$ in Newtons. Use the following state labeling: stick is $\\,0\\,$ and slip-threshold is $\\,1\\,$. Sign conventions must be handled so that $\\,R_n \\ge 0\\,$ and $\\,R_t \\ge 0\\,$ represent the magnitudes of the contact reactions in the normal and tangential directions, respectively. Angles must be interpreted in radians. All reaction components must be expressed in Newtons, rounded to six decimal places.\n\nThe algorithm must:\n- Use a numerical tolerance $\\,\\varepsilon = 10^{-12}\\,$ for comparing $\\,\\tan\\alpha\\,$ and $\\,\\mu\\,$.\n- Classify as stick if $\\,\\tan\\alpha  \\mu - \\varepsilon\\,$.\n- Classify as slip-threshold if $\\,|\\tan\\alpha - \\mu| \\le \\varepsilon\\,$.\n- For stick, enforce zero tangential acceleration and compute the unique equilibrium reactions consistent with the laws stated above.\n- For slip-threshold, enforce the equality form of Coulomb friction and compute the reactions consistently with the laws stated above.\n\nTest suite:\nProvide results for the following parameter sets $\\,\\{m,\\alpha,\\mu,g\\}\\,$, all with angles in radians and $\\,g\\,$ in meters per second squared:\n1. $\\,\\{2.0,\\,0.3,\\,0.5,\\,9.81\\}\\,$.\n2. $\\,\\{5.0,\\,\\arctan(0.3),\\,0.3,\\,9.81\\}\\,$.\n3. $\\,\\{10.5,\\,0.0,\\,0.2,\\,9.80665\\}\\,$.\n4. $\\,\\{1.0,\\,0.0,\\,0.0,\\,9.81\\}\\,$.\n\nOutput format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each test case must produce a list $\\,[s, R_n, R_t]\\,$ where $\\,s\\,$ is the integer state label ($\\,0\\,$ for stick, $\\,1\\,$ for slip-threshold) and $\\,R_n, R_t\\,$ are floats rounded to six decimal places. The final output must be a list of these lists, in the given order of test cases, for example $\\,[[s_1,R_{n1},R_{t1}],\\,[s_2,R_{n2},R_{t2}],\\,[s_3,R_{n3},R_{t3}],\\,[s_4,R_{n4},R_{t4}]]\\,$.",
            "solution": "The problem is deemed valid as it is scientifically grounded in classical mechanics, well-posed with a unique and stable solution for the given conditions, and expressed with objective, unambiguous language and data. All necessary parameters and constraints are provided, and there are no internal contradictions.\n\nThe solution framework is built upon Newton's Second Law, $\\sum F = m a$, applied to a rigid block of mass $m$ on an inclined plane. The plane forms an angle $\\alpha$ with the horizontal. The coordinate system is defined with the normal direction $n$ perpendicular to the plane and the tangential direction $t$ pointing downslope.\n\nFirst, we decompose the gravitational force, $F_g = m g$, into components along the $n$ and $t$ axes. The gravitational force acts vertically downward. The component normal to the plane acts in the negative $n$ direction (into the plane) and has a magnitude of $m g \\cos\\alpha$. The component tangential to the plane acts in the positive $t$ direction (downslope) and has a magnitude of $m g \\sin\\alpha$.\n\nThe contact forces exerted by the plane on the block consist of a normal reaction force, $R_n$, acting in the positive $n$ direction, and a tangential friction force, whose magnitude is denoted by $R_t$. The friction force opposes the tendency of motion, which is driven by the tangential component of gravity. Therefore, the friction force acts in the negative $t$ direction (upslope).\n\nApplying Newton's Second Law in the normal direction ($n$):\n$$ \\sum F_n = R_n - m g \\cos\\alpha = m a_n $$\nThe problem states that the block does not detach from the plane, which implies the normal acceleration $a_n = 0$. This simplifies the equation to:\n$$ R_n - m g \\cos\\alpha = 0 \\implies R_n = m g \\cos\\alpha $$\nSince $m  0$, $g  0$, and for any physical incline $\\cos\\alpha \\ge 0$, the condition $R_n \\ge 0$ is satisfied. This formula for the normal reaction magnitude $R_n$ is valid for all states considered.\n\nNext, we apply Newton's Second Law in the tangential direction ($t$):\n$$ \\sum F_t = m g \\sin\\alpha - R_t = m a_t $$\nHere, $R_t$ represents the magnitude of the friction force acting upslope. The analysis now diverges based on the state of the block, which is determined by comparing $\\tan\\alpha$ to the coefficient of static friction $\\mu$. A numerical tolerance $\\varepsilon = 10^{-12}$ is used for this comparison.\n\nState 1: Stick Condition ($s = 0$)\nThis state is active if the static friction is sufficient to prevent motion. The condition is given as $\\tan\\alpha  \\mu - \\varepsilon$.\nIn the stick state, the block remains in equilibrium, meaning its tangential acceleration is zero, $a_t = 0$. Substituting this into the tangential force equation yields:\n$$ m g \\sin\\alpha - R_t = 0 \\implies R_t = m g \\sin\\alpha $$\nThis result is valid as long as the required friction force $R_t$ does not exceed the maximum available static friction, $|R_t| \\le \\mu R_n$. Substituting the derived expressions for $R_t$ and $R_n$:\n$$ m g \\sin\\alpha \\le \\mu (m g \\cos\\alpha) \\implies \\tan\\alpha \\le \\mu $$\nThis confirms that our calculation is consistent with the physical principles and the problem's criteria. For the stick case, the reaction forces are $R_n = m g \\cos\\alpha$ and $R_t = m g \\sin\\alpha$.\n\nState 2: Slip-Threshold Condition ($s = 1$)\nThis state represents the point at which the block is on the verge of sliding. The condition is defined numerically as $|\\tan\\alpha - \\mu| \\le \\varepsilon$.\nAt this threshold, the static friction force reaches its maximum possible magnitude, given by the equality form of the Coulomb friction law:\n$$ R_t = \\mu R_n $$\nAs the slip-threshold is the limit of the static case, we still consider the block to be in equilibrium, so $a_t = 0$. The tangential force equation, $m g \\sin\\alpha - R_t = 0$, implies that the driving force equals the friction force. However, for the calculation in this state, we directly use the friction law. Substituting the expression for $R_n$:\n$$ R_t = \\mu (m g \\cos\\alpha) $$\nThus, for the slip-threshold case, the reaction forces are $R_n = m g \\cos\\alpha$ and $R_t = \\mu m g \\cos\\alpha$.\n\nThe computational algorithm proceeds as follows for each test case $\\{m, \\alpha, \\mu, g\\}$:\n1. Calculate $\\tan\\alpha$.\n2. Compare $\\tan\\alpha$ with $\\mu$ using the tolerance $\\varepsilon = 10^{-12}$.\n3. If $\\tan\\alpha  \\mu - \\varepsilon$, classify the state as stick ($s=0$) and compute $R_n = m g \\cos\\alpha$ and $R_t = m g \\sin\\alpha$.\n4. If $|\\tan\\alpha - \\mu| \\le \\varepsilon$, classify the state as slip-threshold ($s=1$) and compute $R_n = m g \\cos\\alpha$ and $R_t = \\mu R_n$.\n5. The resulting reaction components are rounded to six decimal places for the final output.\nThis procedure provides a unique and correct solution for each of the given test cases.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the state and reaction forces for a block on an inclined plane\n    based on Coulomb friction model for a series of test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Format: (m, alpha, mu, g)\n    test_cases = [\n        (2.0, 0.3, 0.5, 9.81),\n        (5.0, np.arctan(0.3), 0.3, 9.81),\n        (10.5, 0.0, 0.2, 9.80665),\n        (1.0, 0.0, 0.0, 9.81),\n    ]\n\n    # Numerical tolerance\n    epsilon = 1e-12\n\n    results = []\n    \n    for m, alpha, mu, g in test_cases:\n        # State classification\n        tan_alpha = np.tan(alpha)\n        \n        state = -1 # Uninitialized state\n        Rn = 0.0\n        Rt = 0.0\n\n        if tan_alpha  mu - epsilon:\n            # Stick condition\n            state = 0\n            # From Newton's laws for equilibrium (a_n=0, a_t=0)\n            # R_n - m*g*cos(alpha) = 0\n            # m*g*sin(alpha) - R_t = 0\n            Rn = m * g * np.cos(alpha)\n            Rt = m * g * np.sin(alpha)\n        elif np.abs(tan_alpha - mu) = epsilon:\n            # Slip-threshold condition\n            state = 1\n            # R_n is the same as for stick case\n            # R_t is at its maximum value: R_t = mu * R_n\n            Rn = m * g * np.cos(alpha)\n            Rt = mu * Rn\n        \n        results.append([state, Rn, Rt])\n\n    # Format the results into the required string format.\n    # Each sublist is formatted as [s, Rn, Rt] with floats rounded to 6 decimal places.\n    formatted_results = []\n    for res in results:\n        s, Rn, Rt = res\n        formatted_results.append(f\"[{s},{Rn:.6f},{Rt:.6f}]\")\n\n    # Combine all formatted sublists into the final output string.\n    final_output = f\"[{','.join(formatted_results)}]\"\n\n    # Final print statement in the exact required format.\n    print(final_output)\n\nsolve()\n```"
        },
        {
            "introduction": "Friction is fundamentally a dissipative process, converting mechanical work into heat. This exercise moves beyond static conditions to quantify the energy dissipated during slip, a critical factor in analyzing wear, thermal effects, and system efficiency. You will derive the frictional work for a specified stick-slip history under a time-varying normal load, revealing the crucial concept of path dependency in frictional systems .",
            "id": "3555423",
            "problem": "A rigid planar slider of unit area is in unilateral contact with a rough rigid substrate. The interface obeys the rate-independent Coulomb friction law with coefficient of friction $\\mu$, and the normal contact traction magnitude (compressive, per unit area) is time-varying and given by $N(t)$. Let the interfacial traction vector be $\\boldsymbol{t}(t)$ and let the tangential component of the interfacial velocity be $\\boldsymbol{v}_t(t)$. The frictional work per unit area accumulated over a time interval $\\left[t_0,t_1\\right]$ is defined as\n$$\nW_f \\;=\\; \\int_{t_0}^{t_1} \\boldsymbol{t}(t)\\cdot \\boldsymbol{v}_t(t)\\,dt.\n$$\nAssume the following:\n- The Coulomb friction law holds: during slip, $\\boldsymbol{t}(t) = -\\mu\\,N(t)\\,\\boldsymbol{e}_t(t)$, where $\\boldsymbol{e}_t(t)$ is the unit tangent aligned with $\\boldsymbol{v}_t(t)$; during stick, $|\\boldsymbol{t}(t)| \\le \\mu\\,N(t)$ and $\\boldsymbol{v}_t(t)=\\boldsymbol{0}$.\n- The normal traction is $N(t)=N_0+N_1\\cos(\\omega t)$, with $N_00$, $|N_1|N_0$, and $\\omega=1$ (radian per second). Angles must be treated in radians.\n- The tangential slip speed is constant $|\\boldsymbol{v}_t(t)|=V$ during slip (direction $\\boldsymbol{e}_t(t)$), and zero during stick.\n- The motion over one cycle is considered, with $t_0=0$ and $t_1=2\\pi$. The stick-slip path is specified as follows: slip occurs on the disjoint intervals $[0,\\frac{\\pi}{2}]$ and $\\left[\\frac{2\\pi}{3},\\frac{7\\pi}{6}\\right]$, and stick occurs elsewhere in $\\left[0,2\\pi\\right]$.\n\nGiven the parameters $\\mu=0.4$, $N_0=2000$ (Pascal), $N_1=500$ (Pascal), and $V=0.5$ (meter per second), derive $W_f$ from first principles using the above definitions, compute its value for the specified stick-slip path, and provide the exact analytical expression. Discuss in your derivation how $W_f$ depends on the timing of the slip relative to the variation in $N(t)$, and why the result is path-dependent for time-varying $N(t)$ even with fixed total slip duration. Express the final frictional work per unit area in joules per square meter (J/m$^2$). Provide your final answer as an exact expression without rounding.",
            "solution": "The problem requires the calculation of the frictional work per unit area, $W_f$, for a slider on a rough substrate over a specified time interval and stick-slip path. The analysis will proceed by first principles, starting from the given definition of $W_f$.\n\nThe frictional work per unit area is defined as:\n$$\nW_f = \\int_{t_0}^{t_1} \\boldsymbol{t}(t) \\cdot \\boldsymbol{v}_t(t) \\, dt\n$$\nThe time interval is $[t_0, t_1] = [0, 2\\pi]$. The integrand, $\\boldsymbol{t}(t) \\cdot \\boldsymbol{v}_t(t)$, represents the rate of work done by the interfacial traction $\\boldsymbol{t}(t)$ on the slider, which has a tangential velocity $\\boldsymbol{v}_t(t)$. We must evaluate this integrand based on the state of the interface (stick or slip).\n\nDuring stick, the tangential velocity is zero, i.e., $\\boldsymbol{v}_t(t) = \\boldsymbol{0}$. Consequently, the dot product $\\boldsymbol{t}(t) \\cdot \\boldsymbol{v}_t(t) = 0$. Therefore, no work is done during stick intervals.\n\nDuring slip, the tangential velocity has a constant magnitude $|\\boldsymbol{v}_t(t)| = V$, and its direction is given by the unit vector $\\boldsymbol{e}_t(t) = \\boldsymbol{v}_t(t) / V$. The Coulomb friction law specifies that the interfacial traction $\\boldsymbol{t}(t)$ opposes the direction of slip, with its magnitude proportional to the normal traction $N(t)$. The expression is given as:\n$$\n\\boldsymbol{t}(t) = -\\mu \\, N(t) \\, \\boldsymbol{e}_t(t)\n$$\nwhere $\\mu$ is the coefficient of friction.\n\nWe can now compute the rate of work during slip:\n$$\n\\boldsymbol{t}(t) \\cdot \\boldsymbol{v}_t(t) = \\left( -\\mu \\, N(t) \\, \\boldsymbol{e}_t(t) \\right) \\cdot \\left( V \\, \\boldsymbol{e}_t(t) \\right)\n$$\nSince $\\boldsymbol{e}_t(t)$ is a unit vector, $\\boldsymbol{e}_t(t) \\cdot \\boldsymbol{e}_t(t) = 1$. The expression simplifies to:\n$$\n\\boldsymbol{t}(t) \\cdot \\boldsymbol{v}_t(t) = -\\mu V N(t)\n$$\nThis quantity represents the power per unit area being expended by the friction force on the slider. The negative sign correctly indicates that friction is a dissipative force, meaning it removes energy from the slider (i.e., does negative work on it). The magnitude of this power, $\\mu V N(t)$, is the rate of energy dissipation per unit area.\n\nThe total frictional work $W_f$ is the time integral of this power over the entire cycle. Since the integrand is zero during stick periods, we only need to integrate over the specified slip intervals: $[0, \\frac{\\pi}{2}]$ and $[\\frac{2\\pi}{3}, \\frac{7\\pi}{6}]$.\n$$\nW_f = \\int_0^{2\\pi} (-\\mu V N(t) \\cdot I_{slip}(t)) \\, dt\n$$\nwhere $I_{slip}(t)$ is an indicator function that is $1$ during slip and $0$ during stick. This separates into two integrals over the slip intervals:\n$$\nW_f = \\int_0^{\\pi/2} -\\mu V N(t) \\, dt + \\int_{2\\pi/3}^{7\\pi/6} -\\mu V N(t) \\, dt\n$$\nThe parameters $\\mu$ and $V$ are constant, so they can be factored out:\n$$\nW_f = -\\mu V \\left( \\int_0^{\\pi/2} N(t) \\, dt + \\int_{2\\pi/3}^{7\\pi/6} N(t) \\, dt \\right)\n$$\nThe normal traction is given as $N(t) = N_0 + N_1 \\cos(\\omega t)$, with $\\omega=1$ rad/s. Substituting this into the integral:\n$$\nW_f = -\\mu V \\left( \\int_0^{\\pi/2} (N_0 + N_1 \\cos(t)) \\, dt + \\int_{2\\pi/3}^{7\\pi/6} (N_0 + N_1 \\cos(t)) \\, dt \\right)\n$$\nWe can evaluate the integrals for the $N_0$ and $N_1\\cos(t)$ terms separately. The integral of the constant term $N_0$ is:\n$$\n\\int_0^{\\pi/2} N_0 \\, dt + \\int_{2\\pi/3}^{7\\pi/6} N_0 \\, dt = N_0 \\left( \\frac{\\pi}{2} - 0 \\right) + N_0 \\left( \\frac{7\\pi}{6} - \\frac{2\\pi}{3} \\right) = N_0 \\frac{\\pi}{2} + N_0 \\left( \\frac{7\\pi - 4\\pi}{6} \\right) = N_0 \\frac{\\pi}{2} + N_0 \\frac{3\\pi}{6} = N_0 \\pi\n$$\nThis term depends only on the total duration of slip, which is $\\pi$ seconds.\n\nThe integral of the time-varying term $N_1 \\cos(t)$ is:\n$$\n\\int_0^{\\pi/2} N_1 \\cos(t) \\, dt + \\int_{2\\pi/3}^{7\\pi/6} N_1 \\cos(t) \\, dt = N_1 \\left( \\int_0^{\\pi/2} \\cos(t) \\, dt + \\int_{2\\pi/3}^{7\\pi/6} \\cos(t) \\, dt \\right)\n$$\nThe individual definite integrals are:\n$$\n\\int_0^{\\pi/2} \\cos(t) \\, dt = [\\sin(t)]_0^{\\pi/2} = \\sin\\left(\\frac{\\pi}{2}\\right) - \\sin(0) = 1 - 0 = 1\n$$\n$$\n\\int_{2\\pi/3}^{7\\pi/6} \\cos(t) \\, dt = [\\sin(t)]_{2\\pi/3}^{7\\pi/6} = \\sin\\left(\\frac{7\\pi}{6}\\right) - \\sin\\left(\\frac{2\\pi}{3}\\right)\n$$\nThe trigonometric values are $\\sin(7\\pi/6) = -\\frac{1}{2}$ and $\\sin(2\\pi/3) = \\frac{\\sqrt{3}}{2}$.\n$$\n\\int_{2\\pi/3}^{7\\pi/6} \\cos(t) \\, dt = -\\frac{1}{2} - \\frac{\\sqrt{3}}{2} = -\\frac{1+\\sqrt{3}}{2}\n$$\nSumming the contributions from the cosine term:\n$$\n1 + \\left(-\\frac{1+\\sqrt{3}}{2}\\right) = \\frac{2 - 1 - \\sqrt{3}}{2} = \\frac{1-\\sqrt{3}}{2}\n$$\nCombining all parts, the exact analytical expression for $W_f$ is:\n$$\nW_f = -\\mu V \\left( N_0 \\pi + N_1 \\left( \\frac{1-\\sqrt{3}}{2} \\right) \\right)\n$$\nThis expression demonstrates how $W_f$ depends on the parameters. The term $N_0\\pi$ is the work that would be done if the normal force were constant at its average value $N_0$ over the total slip duration $\\pi$. The term with $N_1$ represents the modification due to the varying normal load. Its value depends on the integral of $\\cos(t)$ over the slip intervals, which means it is sensitive to *when* the slip occurs relative to the phase of the normal force oscillation.\n\nThis path-dependence can be illustrated by considering a different slip path with the same total duration. If slip were to occur on $[-\\pi/2, \\pi/2]$ (total duration $\\pi$), the integral of $\\cos(t)$ would be $\\int_{-\\pi/2}^{\\pi/2} \\cos(t)dt = 2$, and $W_f$ would be $-\\mu V(N_0\\pi + 2N_1)$. This is different from our result, confirming that for a time-varying normal load, the total frictional work is path-dependent even for a fixed total slip duration.\n\nNow, we compute the numerical value using the given parameters: $\\mu=0.4$, $N_0=2000$ Pa, $N_1=500$ Pa, and $V=0.5$ m/s.\n$$\nW_f = -(0.4)(0.5) \\left( (2000) \\pi + (500) \\left( \\frac{1-\\sqrt{3}}{2} \\right) \\right)\n$$\n$$\nW_f = -0.2 \\left( 2000\\pi + 250(1-\\sqrt{3}) \\right)\n$$\nDistributing the $-0.2$:\n$$\nW_f = -(0.2 \\times 2000)\\pi - (0.2 \\times 250)(1-\\sqrt{3})\n$$\n$$\nW_f = -400\\pi - 50(1-\\sqrt{3})\n$$\n$$\nW_f = -400\\pi - 50 + 50\\sqrt{3}\n$$\nThe units are $(\\text{dimensionless}) \\times (\\text{m/s}) \\times (\\text{N/m}^2) \\times (\\text{s}) = (\\text{N}\\cdot\\text{m})/\\text{m}^2 = \\text{J/m}^2$, as required. The final answer is an exact expression without rounding.\nRearranging for a compact representation:\n$$\nW_f = -(400\\pi + 50 - 50\\sqrt{3})\n$$",
            "answer": "$$\n\\boxed{-(400\\pi + 50 - 50\\sqrt{3})}\n$$"
        },
        {
            "introduction": "The efficiency and robustness of modern implicit solvers for contact mechanics hinge on the use of Newton's method, which requires a precise linearization of the governing equations. This advanced practice challenges you to derive and implement the 'consistent Jacobian' for a non-smooth Coulomb friction law, a cornerstone of computational contact mechanics. By verifying the quadratic convergence of your active-set solver, you will gain firsthand experience with the numerical techniques that enable stable and rapid simulation of complex frictional phenomena .",
            "id": "3555393",
            "problem": "Consider a quasi-static, planar, single-node tangential contact problem between a deformable body and a rigid foundation with Coulomb friction. The deformable body is modeled by a linear elastic tangential spring of stiffness $k_{s}  0$ attached to a point mass constrained in the plane, and the contact interface is modeled by a tangential penalty stiffness $k_{t}  0$ with Coulomb friction limit $\\tau = \\mu p  0$, where $\\mu$ is the coefficient of friction and $p$ is the (constant) contact pressure. Let the unknown tangential displacement be the vector $u \\in \\mathbb{R}^{2}$, and let the externally applied load be $F \\in \\mathbb{R}^{2}$.\n\nThe governing equilibrium equation at the node is the balance of forces\n$$\nK u + t(u) = F,\n$$\nwhere $K = k_{s} I$ is the structural stiffness with $I \\in \\mathbb{R}^{2 \\times 2}$ the identity, and $t(u) \\in \\mathbb{R}^{2}$ is the frictional traction supplied by the interface. The Coulomb friction model with a tangential penalty for sticking is defined by the following active-set characterization:\n\n- Define the trial traction\n$$\nt_{\\mathrm{tr}}(u) = k_{t}\\,u.\n$$\n\n- Stick set: if $\\|t_{\\mathrm{tr}}(u)\\| \\le \\tau$, the state is sticking and the traction is\n$$\nt(u) = t_{\\mathrm{tr}}(u).\n$$\n\n- Slip set: if $\\|t_{\\mathrm{tr}}(u)\\|  \\tau$, the state is slipping and the traction is radial-returned to the Coulomb disc,\n$$\nt(u) = \\tau \\,\\frac{t_{\\mathrm{tr}}(u)}{\\|t_{\\mathrm{tr}}(u)\\|} = \\tau \\,\\frac{u}{\\|u\\|}.\n$$\n\nYou are to derive a fully consistent linearization of the residual for use in a monolithic Newton method with active-set updates within each iteration. Specifically:\n\n1. Starting only from the balance equation, the stick/slip definitions above, and calculus rules, derive the Newton residual\n$$\nr(u) = K u + t(u) - F,\n$$\nand the consistent Jacobian\n$$\nJ(u) = \\frac{\\partial r(u)}{\\partial u} = K + \\frac{\\partial t(u)}{\\partial u},\n$$\nfor both the stick and slip sets. Your derivation must show how the active-set updates enter the algorithm and why the linearization remains consistent once the set is identified.\n\n2. Implement a Newton solver for the nonlinear system $r(u) = 0$ with active-set updates at each iteration according to the stick/slip criteria above, using the derived consistent Jacobian for the current set. At each iteration $k$, compute the residual norm $\\|r(u^{(k)})\\|_{2}$, update $u^{(k+1)}$ by solving\n$$\nJ(u^{(k)})\\,\\Delta u^{(k)} = -r(u^{(k)}), \\quad u^{(k+1)} = u^{(k)} + \\Delta u^{(k)},\n$$\nand record the active set label (stick or slip). Terminate when $\\|r(u^{(k)})\\|_{2} \\le \\varepsilon$ for a prescribed tolerance $\\varepsilon  0$.\n\n3. Quantitatively verify sustained quadratic convergence through repeated stick–slip transitions by checking the observed convergence order near the end of the iteration sequence for each load step. Define the local observed order using residual norms as\n$$\np_{k} = \\frac{\\ln\\left(\\dfrac{\\|r(u^{(k+1)})\\|_{2}}{\\|r(u^{(k)})\\|_{2}}\\right)}{\\ln\\left(\\dfrac{\\|r(u^{(k)})\\|_{2}}{\\|r(u^{(k-1)})\\|_{2}}\\right)},\n$$\nwhenever the denominators are defined and all residual norms are strictly positive. To avoid pre-asymptotic pollution, only assess $p_{k}$ once $\\|r(u^{(k)})\\|_{2} \\le \\rho$ for a prescribed threshold $\\rho  0$.\n\nFor each load step in a sequence, identify the last iteration index at which the active set label changes; then, using only iterations after that index, require that the last two computed observed orders $p_{k}$ are each greater than or equal to $1.8$ to declare sustained quadratic convergence for that load step. If the Newton method converges in at most two iterations for a load step, declare sustained quadratic convergence by default for that step.\n\nImplement the algorithm and apply it to the following test suite. All forces must be expressed in Newtons (N), stiffnesses in Newtons per meter (N/m), displacements in meters (m), and angles in radians.\n\nCommon parameters for all tests:\n- $k_{s} = 10 \\,\\text{N/m}$,\n- $k_{t} = 100 \\,\\text{N/m}$,\n- $\\tau = 1 \\,\\text{N}$,\n- Newton tolerance $\\varepsilon = 10^{-12} \\,\\text{N}$,\n- Asymptotic threshold $\\rho = 10^{-6} \\,\\text{N}$,\n- Maximum iterations per load step $50$.\n\nTest cases:\n\n- Case 1 (stick–slip–stick–slip along a straight line): A sequence of four loads $F \\in \\mathbb{R}^{2}$ along the $x$-axis,\n  1. $F = (0.5, 0.0)$,\n  2. $F = (1.2, 0.0)$,\n  3. $F = (0.8, 0.0)$,\n  4. $F = (1.5, 0.0)$,\n  applied sequentially, using the converged displacement from the previous step as the initial guess for the next step.\n\n- Case 2 (directional rotation under persistent slip): A sequence of three loads of magnitude $2.0 \\,\\text{N}$ at angles $0$, $\\pi/4$, and $\\pi/2$ radians,\n  1. $F = 2.0 \\,(\\cos(0), \\sin(0))$,\n  2. $F = 2.0 \\,(\\cos(\\pi/4), \\sin(\\pi/4))$,\n  3. $F = 2.0 \\,(\\cos(\\pi/2), \\sin(\\pi/2))$,\n  applied sequentially, using the converged displacement from the previous step as the initial guess for the next step.\n\n- Case 3 (near-threshold toggling): A sequence of four loads near the stick–slip threshold along the $x$-axis,\n  1. $F = (1.08, 0.0)$,\n  2. $F = (1.12, 0.0)$,\n  3. $F = (1.09, 0.0)$,\n  4. $F = (1.11, 0.0)$,\n  applied sequentially, using the converged displacement from the previous step as the initial guess for the next step.\n\nFor each case, return a boolean indicating whether sustained quadratic convergence, in the precise sense defined above, is observed for every load step in that case. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[true,false,true]\" but using your language's boolean literals). Angles must be interpreted in radians, and all physical units must be respected as specified above. The final outputs for each case must be booleans.",
            "solution": "The user has provided a well-posed problem in computational solid mechanics concerning a single-node contact model with Coulomb friction. The task is to derive the consistent Jacobian for an active-set Newton method, implement the solver, and verify its quadratic convergence properties on a suite of test cases.\n\n### Problem Validation\nThe provided problem is a standard, albeit simplified, representation of frictional contact within computational mechanics.\n\n- **Givens**:\n    - Governing Equation: $K u + t(u) = F$\n    - Structural Stiffness: $K = k_{s} I$, with $I \\in \\mathbb{R}^{2 \\times 2}$ being the identity matrix.\n    - Frictional Traction $t(u)$:\n        - Trial Traction: $t_{\\mathrm{tr}}(u) = k_{t}\\,u$.\n        - Stick: If $\\|t_{\\mathrm{tr}}(u)\\| \\le \\tau$, then $t(u) = t_{\\mathrm{tr}}(u)$.\n        - Slip: If $\\|t_{\\mathrm{tr}}(u)\\|  \\tau$, then $t(u) = \\tau \\frac{u}{\\|u\\|}$.\n    - Newton Method:\n        - Residual: $r(u) = K u + t(u) - F$.\n        - Jacobian: $J(u) = \\frac{\\partial r(u)}{\\partial u}$.\n        - Update: Solve $J(u^{(k)})\\,\\Delta u^{(k)} = -r(u^{(k)})$ for $\\Delta u^{(k)}$, then $u^{(k+1)} = u^{(k)} + \\Delta u^{(k)}$.\n    - Convergence Criteria:\n        - Termination: $\\|r(u^{(k)})\\|_{2} \\le \\varepsilon$.\n        - Observed Order: $p_{k} = \\frac{\\ln\\left(\\|r(u^{(k+1)})\\|_{2}/\\|r(u^{(k)})\\|_{2}\\right)}{\\ln\\left(\\|r(u^{(k)})\\|_{2}/\\|r(u^{(k-1)})\\|_{2}\\right)}$.\n        - Quadratic Convergence Check: For each load step, sustained quadratic convergence is declared if the last two valid computed orders $p_k$ (after the final active-set change and with $\\|r(u^{(k)})\\|_{2} \\le \\rho$) are both $\\ge 1.8$, or if the solver converges in $\\le 2$ iterations.\n    - Parameters: $k_{s} = 10 \\,\\text{N/m}$, $k_{t} = 100 \\,\\text{N/m}$, $\\tau = 1 \\,\\text{N}$, $\\varepsilon = 10^{-12} \\,\\text{N}$, $\\rho = 10^{-6} \\,\\text{N}$, max iterations $50$.\n    - Test Cases: Three sequences of applied loads $F$.\n\n- **Validation Verdict**: The problem is **valid**. It is scientifically grounded in established principles of contact mechanics, mathematically well-posed, objective, and self-contained. All necessary equations, parameters, and criteria are explicitly provided. The task requires a rigorous derivation and a careful implementation, which is a standard exercise in the field.\n\n### Part 1: Derivation of the Consistent Jacobian\n\nThe Newton's method for solving the nonlinear system $r(u) = 0$ requires the Jacobian matrix $J(u)$, which is the derivative of the residual $r(u)$ with respect to the displacement vector $u$.\n$$\nr(u) = k_s u + t(u) - F\n$$\nThe derivative of the residual is:\n$$\nJ(u) = \\frac{\\partial r(u)}{\\partial u} = \\frac{\\partial}{\\partial u} (k_s u + t(u) - F) = k_s \\frac{\\partial u}{\\partial u} + \\frac{\\partial t(u)}{\\partial u} - \\frac{\\partial F}{\\partial u}\n$$\nSince $F$ is an externally applied load, it is independent of $u$, so $\\frac{\\partial F}{\\partial u} = 0$. The term $\\frac{\\partial u}{\\partial u}$ is the identity matrix $I \\in \\mathbb{R}^{2 \\times 2}$. The structural stiffness is $K=k_s I$. Thus, the Jacobian simplifies to:\n$$\nJ(u) = K + \\frac{\\partial t(u)}{\\partial u}\n$$\nThe crucial part is the derivation of the traction derivative, $\\frac{\\partial t(u)}{\\partial u}$, which depends on the active set (stick or slip) at displacement $u$.\n\n**1. Stick Set Derivation**\n- **Condition**: The stick condition is $\\|t_{\\mathrm{tr}}(u)\\| \\le \\tau$, which, using the definition $t_{\\mathrm{tr}}(u) = k_t u$, simplifies to $k_t \\|u\\| \\le \\tau$.\n- **Traction**: In the stick set, the traction is linear in displacement:\n$$\nt(u) = k_t u\n$$\n- **Jacobian**: The derivative of this linear function is a constant tensor:\n$$\n\\frac{\\partial t(u)}{\\partial u} = \\frac{\\partial}{\\partial u} (k_t u) = k_t I\n$$\nSubstituting this into the general expression for $J(u)$, the consistent Jacobian for the stick set is:\n$$\nJ_{\\mathrm{stick}}(u) = K + k_t I = k_s I + k_t I = (k_s + k_t)I\n$$\nThis is a simple diagonal matrix, representing the combined stiffness of the structural spring and the contact penalty spring.\n\n**2. Slip Set Derivation**\n- **Condition**: The slip condition is $\\|t_{\\mathrm{tr}}(u)\\|  \\tau$, which simplifies to $k_t \\|u\\|  \\tau$. In this regime, $\\|u\\|$ cannot be zero.\n- **Traction**: In the slip set, the traction vector has a constant magnitude $\\tau$ and is directed opposite to the slip. Here, it is aligned with the displacement $u$:\n$$\nt(u) = \\tau \\frac{u}{\\|u\\|} = \\tau \\hat{n}(u)\n$$\nwhere $\\hat{n}(u) = u/\\|u\\|$ is the normalized displacement vector.\n- **Jacobian**: We must differentiate $t(u)$ with respect to $u \\in \\mathbb{R}^2$. This requires the chain rule. The derivative of the normalized vector $\\hat{n}(u)$ is a known result from tensor calculus:\n$$\n\\frac{\\partial \\hat{n}(u)}{\\partial u} = \\frac{\\partial}{\\partial u} \\left( \\frac{u}{\\|u\\|} \\right) = \\frac{1}{\\|u\\|} \\left( I - \\frac{u \\otimes u}{\\|u\\|^2} \\right)\n$$\nwhere $\\otimes$ denotes the outer product. The term $(I - \\hat{n} \\otimes \\hat{n})$ is a projection operator that projects onto the space orthogonal to $\\hat{n}$.\nUsing this, the derivative of the slip traction is:\n$$\n\\frac{\\partial t(u)}{\\partial u} = \\tau \\frac{\\partial \\hat{n}(u)}{\\partial u} = \\frac{\\tau}{\\|u\\|} \\left( I - \\frac{u \\otimes u}{\\|u\\|^2} \\right)\n$$\nSubstituting this into the general expression for $J(u)$, the consistent Jacobian for the slip set is:\n$$\nJ_{\\mathrm{slip}}(u) = K + \\frac{\\tau}{\\|u\\|} \\left( I - \\frac{u \\otimes u}{\\|u\\|^2} \\right) = k_s I + \\frac{\\tau}{\\|u\\|}I - \\frac{\\tau}{\\|u\\|^3}(u \\otimes u)\n$$\nThis Jacobian is rank-deficient in the radial direction (it has a zero eigenvalue corresponding to the eigenvector $u$), which reflects the fact that in the slip state, resistance to motion along the direction of $u$ is governed by the structural stiffness $k_s$ alone, while resistance to motion orthogonal to $u$ involves both $k_s$ and a geometric stiffness term $\\tau/\\|u\\|$.\n\n### Part 2: Algorithmic Design and Convergence\n\nThe Newton method is implemented with an active-set strategy. Within each iteration $k$ for a given displacement guess $u^{(k)}$:\n1.  The trial traction $t_{\\mathrm{tr}}(u^{(k)}) = k_t u^{(k)}$ is computed.\n2.  The active set is determined by comparing $\\|t_{\\mathrm{tr}}(u^{(k)})\\|$ with $\\tau$.\n3.  Based on the active set ('stick' or 'slip'), the appropriate expressions for the traction $t(u^{(k)})$ and Jacobian $J(u^{(k)})$ are selected from the derivations above.\n4.  The residual $r(u^{(k)}) = k_s u^{(k)} + t(u^{(k)}) - F$ is computed.\n5.  The linear system $J(u^{(k)}) \\Delta u^{(k)} = -r(u^{(k)})$ is solved for the displacement increment $\\Delta u^{(k)}$.\n6.  The displacement is updated: $u^{(k+1)} = u^{(k)} + \\Delta u^{(k)}$.\n7.  The process repeats until the residual norm $\\|r(u^{(k+1)})\\|_2$ falls below the tolerance $\\varepsilon$.\n\nThis procedure uses a *consistent linearization* because the Jacobian $J(u^{(k)})$ is the exact derivative of the residual function $r(u)$ for the specific active-set branch chosen at iteration $k$. Once the iterations converge to a point where the active set no longer changes, the method behaves as a standard Newton-Raphson solver for a smooth nonlinear system, which is known to exhibit quadratic convergence.\n\nThe quantitative verification of convergence is performed as specified. After a load step converges, the history of residual norms and active sets is analyzed. The \"sustained quadratic convergence\" criterion, which requires the last two computed asymptotic convergence orders $p_k$ to be $\\ge 1.8$, is a rigorous check that the method indeed achieves the theoretically expected performance after any initial non-smoothness due to active-set toggling is resolved.",
            "answer": "```python\nimport numpy as np\nimport math\n\ndef solve():\n    \"\"\"\n    Solves the contact mechanics problem and verifies convergence.\n    \"\"\"\n\n    # Common parameters\n    ks = 10.0  # N/m\n    kt = 100.0 # N/m\n    tau = 1.0  # N\n    eps = 1e-12 # N\n    rho = 1e-6  # N\n    max_iter = 50\n\n    # Test cases\n    test_cases_loads = [\n        # Case 1: stick-slip-stick-slip along a straight line\n        [\n            np.array([0.5, 0.0]),\n            np.array([1.2, 0.0]),\n            np.array([0.8, 0.0]),\n            np.array([1.5, 0.0]),\n        ],\n        # Case 2: directional rotation under persistent slip\n        [\n            2.0 * np.array([math.cos(0.0), math.sin(0.0)]),\n            2.0 * np.array([math.cos(math.pi / 4.0), math.sin(math.pi / 4.0)]),\n            2.0 * np.array([math.cos(math.pi / 2.0), math.sin(math.pi / 2.0)]),\n        ],\n        # Case 3: near-threshold toggling\n        [\n            np.array([1.08, 0.0]),\n            np.array([1.12, 0.0]),\n            np.array([1.09, 0.0]),\n            np.array([1.11, 0.0]),\n        ],\n    ]\n\n    overall_results = []\n\n    for case_loads in test_cases_loads:\n        u_initial = np.zeros(2)\n        case_passed = True\n        for F_load in case_loads:\n            u_converged, history = newton_solver(F_load, u_initial, ks, kt, tau, eps, max_iter)\n            \n            load_step_passed = analyze_convergence(history['residual_norms'], history['active_sets'], rho)\n\n            if not load_step_passed:\n                case_passed = False\n                break\n            \n            u_initial = u_converged\n        \n        overall_results.append(case_passed)\n\n    print(f\"[{','.join(map(str, overall_results))}]\".lower())\n\ndef newton_solver(F, u_initial, ks, kt, tau, eps, max_iter):\n    \"\"\"\n    Performs the active-set Newton method for a single load step.\n    \"\"\"\n    u = np.copy(u_initial)\n    I = np.identity(2)\n    K = ks * I\n\n    history = {'residual_norms': [], 'active_sets': []}\n    \n    for k in range(max_iter + 1):\n        # Determine active set and compute traction t and its derivative dt_du\n        t_tr = kt * u\n        norm_t_tr = np.linalg.norm(t_tr)\n\n        if norm_t_tr = tau:\n            # Stick state\n            active_set = 'stick'\n            t = t_tr\n            dt_du = kt * I\n        else:\n            # Slip state\n            active_set = 'slip'\n            norm_u = np.linalg.norm(u)\n            # norm_u will not be zero in slip, as kt*||u||  tau  0\n            t = tau * u / norm_u\n            \n            u_outer_u = np.outer(u, u)\n            dt_du = (tau / norm_u) * (I - u_outer_u / (norm_u**2))\n            \n        # Compute residual r and Jacobian J\n        r = K @ u + t - F\n        J = K + dt_du\n        \n        norm_r = np.linalg.norm(r)\n        \n        history['residual_norms'].append(norm_r)\n        history['active_sets'].append(active_set)\n        \n        if norm_r = eps:\n            break\n            \n        if k == max_iter:\n            # Failed to converge\n            break\n\n        # Solve for increment and update\n        delta_u = np.linalg.solve(J, -r)\n        u = u + delta_u\n        \n    return u, history\n\ndef analyze_convergence(residual_norms, active_sets, rho):\n    \"\"\"\n    Verifies sustained quadratic convergence for a single load step.\n    \"\"\"\n    num_iterations = len(residual_norms) - 1\n    \n    # Pass by default if converged in = 2 iterations\n    if num_iterations = 2:\n        return True\n\n    # Find the index of the last iteration where the active set changed\n    last_change_idx = 0\n    for i in range(1, len(active_sets)):\n        if active_sets[i] != active_sets[i-1]:\n            last_change_idx = i\n\n    valid_p_orders = []\n    # k is the index into the residual_norms list, corresponding to u^(k)\n    # We can compute p_k for k from 1 to len-2.\n    # We only consider k  last_change_idx.\n    for k in range(last_change_idx + 1, len(residual_norms) - 1):\n        if k == 0:\n             continue # Cannot compute p_k if k=0\n        \n        norm_rk_m1 = residual_norms[k-1]\n        norm_rk = residual_norms[k]\n        norm_rk_p1 = residual_norms[k+1]\n\n        # Check conditions for computing p_k\n        if norm_rk  rho:\n            continue\n            \n        # Denominators must be defined and norms strictly positive\n        if norm_rk_m1 = 0 or norm_rk = 0:\n            continue\n        \n        # Avoid division by zero if norms are equal\n        if abs(norm_rk - norm_rk_m1)  1e-15:\n            continue\n\n        denominator = np.log(norm_rk / norm_rk_m1)\n        if abs(denominator)  1e-15:\n            continue\n\n        numerator = np.log(norm_rk_p1 / norm_rk)\n        \n        pk = numerator / denominator\n        valid_p_orders.append(pk)\n        \n    # Check if the last two valid computed orders are = 1.8\n    if len(valid_p_orders) = 2:\n        if valid_p_orders[-1] = 1.8 and valid_p_orders[-2] = 1.8:\n            return True\n    \n    return False\n\nif __name__ == '__main__':\n    solve()\n\n```"
        }
    ]
}