{
    "hands_on_practices": [
        {
            "introduction": "掌握库仑摩擦模型的第一步是将其基本原理转化为可计算的逻辑。这个经典的斜面问题  是一个理想的基准测试，它要求我们基于物理定律来区分静止（stick）和临界滑动（slip-threshold）状态。通过这个练习，你将把牛顿第二定律和库仑摩擦定律直接应用于一个简单的计算场景，为更复杂的摩擦分析奠定基础。",
            "id": "3555411",
            "problem": "要求您为一个在重力作用下与刚性斜面发生单边接触的单个刚性滑块构建并验证一个计算基准。该模型使用库仑摩擦，重点关注粘滞条件和粘滑转换阈值。斜面与水平面成 $\\,\\alpha\\,$ 角（单位为弧度）。滑块的质量为 $\\,m\\,$（单位为千克），重力加速度为 $\\,g\\,$（单位为米每平方秒），摩擦系数为 $\\,\\mu \\ge 0\\,$（无量纲）。坐标系的定义如下：切向 $\\,t\\,$ 沿斜面向下，法向 $\\,n\\,$ 垂直于斜面并从斜面指向滑块。假设接触保持闭合，法向间隙 $\\,g_n = 0\\,$，法向反力 $\\,R_n \\ge 0\\,$，并且在任何测试用例中滑块都不会脱离斜面。\n\n使用的基本原理：\n- 牛顿第二运动定律：$\\,\\sum F = m a\\,$.\n- 将重力分解为与所定义坐标系一致的切向和法向分量。\n- 接触点的库仑摩擦定律：静摩擦满足 $\\,|R_t| \\le \\mu R_n\\,$，在滑动阈值时 $\\,|R_t| = \\mu R_n\\,$。这里 $\\,R_t\\,$ 是切向反力的大小，$\\,R_n\\,$ 是法向反力。\n- 粘滞条件定义为 $\\,\\tan\\alpha  \\mu\\,$，滑动阈值（开始滑动的临界点）条件在指定的数值容差内定义为 $\\,\\tan\\alpha = \\mu\\,$。\n\n您的任务是实现一个程序，为每个提供的测试用例确定状态分类，并计算反力分量 $\\,R_n\\,$ 和 $\\,R_t\\,$ 的大小（单位为牛顿）。使用以下状态标签：粘滞为 $\\,0\\,$，滑动阈值为 $\\,1\\,$。必须处理好符号约定，使得 $\\,R_n \\ge 0\\,$ 和 $\\,R_t \\ge 0\\,$ 分别表示法向和切向接触反力的大小。角度必须以弧度为单位进行解释。所有反力分量必须以牛顿表示，并四舍五入到六位小数。\n\n算法必须：\n- 使用数值容差 $\\,\\varepsilon = 10^{-12}\\,$ 来比较 $\\,\\tan\\alpha\\,$ 和 $\\,\\mu\\,$。\n- 如果 $\\,\\tan\\alpha  \\mu - \\varepsilon\\,$，则分类为粘滞。\n- 如果 $\\,|\\tan\\alpha - \\mu| \\le \\varepsilon\\,$，则分类为滑动阈值。\n- 对于粘滞状态，强制切向加速度为零，并根据上述定律计算出唯一的平衡反力。\n- 对于滑动阈值状态，强制使用库仑摩擦的等式形式，并根据上述定律计算反力。\n\n测试套件：\n为以下参数集 $\\,\\{m,\\alpha,\\mu,g\\}\\,$ 提供结果，所有角度单位均为弧度，$\\,g\\,$ 的单位为米每平方秒：\n1. $\\,\\{2.0,\\,0.3,\\,0.5,\\,9.81\\}\\,$.\n2. $\\,\\{5.0,\\,\\arctan(0.3),\\,0.3,\\,9.81\\}\\,$.\n3. $\\,\\{10.5,\\,0.0,\\,0.2,\\,9.80665\\}\\,$.\n4. $\\,\\{1.0,\\,0.0,\\,0.0,\\,9.81\\}\\,$.\n\n输出格式：\n您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表。每个测试用例必须生成一个列表 $\\,[s, R_n, R_t]\\,$，其中 $\\,s\\,$ 是整数状态标签（$\\,0\\,$ 代表粘滞，$\\,1\\,$ 代表滑动阈值），$\\,R_n, R_t\\,$ 是四舍五入到六位小数的浮点数。最终输出必须是这些列表组成的列表，并按给定测试用例的顺序排列，例如 $\\,[[s_1,R_{n1},R_{t1}],\\,[s_2,R_{n2},R_{t2}],\\,[s_3,R_{n3},R_{t3}],\\,[s_4,R_{n4},R_{t4}]]\\,$。",
            "solution": "该问题被认为是有效的，因为它有经典力学的科学依据，对于给定条件是适定的，具有唯一且稳定的解，并使用客观、明确的语言和数据进行表述。所有必要的参数和约束都已提供，并且没有内部矛盾。\n\n解决方案框架建立在牛顿第二定律 $\\sum F = m a$ 之上，并应用于斜面上的一个质量为 $m$ 的刚性滑块。该斜面与水平面成 $\\alpha$ 角。坐标系的定义为：法向 $n$ 垂直于斜面，切向 $t$ 指向斜面下方。\n\n首先，我们将重力 $F_g = m g$ 分解到 $n$ 轴和 $t$ 轴上。重力垂直向下作用。垂直于斜面的分量作用于负 $n$ 方向（指向斜面内），大小为 $m g \\cos\\alpha$。平行于斜面的分量作用于正 $t$ 方向（沿斜面向下），大小为 $m g \\sin\\alpha$。\n\n斜面对滑块施加的接触力包括一个作用于正 $n$ 方向的法向反力 $R_n$，以及一个大小记为 $R_t$ 的切向摩擦力。摩擦力抵抗由重力的切向分量驱动的运动趋势。因此，摩擦力作用于负 $t$ 方向（沿斜面向上）。\n\n在法向（$n$）上应用牛顿第二定律：\n$$ \\sum F_n = R_n - m g \\cos\\alpha = m a_n $$\n问题陈述滑块不脱离斜面，这意味着法向加速度 $a_n = 0$。这使得方程简化为：\n$$ R_n - m g \\cos\\alpha = 0 \\implies R_n = m g \\cos\\alpha $$\n由于 $m  0$，$g  0$，且对于任何物理斜面 $\\cos\\alpha \\ge 0$，条件 $R_n \\ge 0$ 均满足。这个法向反力大小 $R_n$ 的公式对所有考虑的状态都有效。\n\n接下来，我们在切向（$t$）应用牛顿第二定律：\n$$ \\sum F_t = m g \\sin\\alpha - R_t = m a_t $$\n这里，$R_t$ 代表沿斜面向上作用的摩擦力的大小。现在的分析根据滑块的状态而有所不同，该状态通过比较 $\\tan\\alpha$ 与静摩擦系数 $\\mu$ 来确定。此比较使用数值容差 $\\varepsilon = 10^{-12}$。\n\n状态1：粘滞条件（$s = 0$）\n如果静摩擦力足以阻止运动，则此状态被激活。其条件为 $\\tan\\alpha  \\mu - \\varepsilon$。\n在粘滞状态下，滑块保持平衡，意味着其切向加速度为零，$a_t = 0$。将此代入切向力方程得到：\n$$ m g \\sin\\alpha - R_t = 0 \\implies R_t = m g \\sin\\alpha $$\n只要所需的摩擦力 $R_t$ 不超过最大可用静摩擦力 $|R_t| \\le \\mu R_n$，此结果就有效。代入推导出的 $R_t$ 和 $R_n$ 的表达式：\n$$ m g \\sin\\alpha \\le \\mu (m g \\cos\\alpha) \\implies \\tan\\alpha \\le \\mu $$\n这证实了我们的计算与物理原理及问题标准是一致的。对于粘滞情况，反力为 $R_n = m g \\cos\\alpha$ 和 $R_t = m g \\sin\\alpha$。\n\n状态2：滑动阈值条件（$s = 1$）\n此状态表示滑块处于即将滑动的临界点。其条件在数值上定义为 $|\\tan\\alpha - \\mu| \\le \\varepsilon$。\n在此阈值下，静摩擦力达到其最大可能值，由库仑摩擦定律的等式形式给出：\n$$ R_t = \\mu R_n $$\n由于滑动阈值是静态情况的极限，我们仍认为滑块处于平衡状态，因此 $a_t = 0$。切向力方程 $m g \\sin\\alpha - R_t = 0$ 意味着驱动力等于摩擦力。然而，在此状态的计算中，我们直接使用摩擦定律。代入 $R_n$ 的表达式：\n$$ R_t = \\mu (m g \\cos\\alpha) $$\n因此，对于滑动阈值情况，反力为 $R_n = m g \\cos\\alpha$ 和 $R_t = \\mu m g \\cos\\alpha$。\n\n对于每个测试用例 $\\{m, \\alpha, \\mu, g\\}$，计算算法按以下步骤进行：\n1. 计算 $\\tan\\alpha$。\n2. 使用容差 $\\varepsilon = 10^{-12}$ 比较 $\\tan\\alpha$ 与 $\\mu$。\n3. 如果 $\\tan\\alpha  \\mu - \\varepsilon$，将状态分类为粘滞（$s=0$）并计算 $R_n = m g \\cos\\alpha$ 和 $R_t = m g \\sin\\alpha$。\n4. 如果 $|\\tan\\alpha - \\mu| \\le \\varepsilon$，将状态分类为滑动阈值（$s=1$）并计算 $R_n = m g \\cos\\alpha$ 和 $R_t = \\mu R_n$。\n5. 将得到的反力分量四舍五入到六位小数作为最终输出。\n此过程为每个给定的测试用例提供了唯一且正确的解。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the state and reaction forces for a block on an inclined plane\n    based on Coulomb friction model for a series of test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Format: (m, alpha, mu, g)\n    test_cases = [\n        (2.0, 0.3, 0.5, 9.81),\n        (5.0, np.arctan(0.3), 0.3, 9.81),\n        (10.5, 0.0, 0.2, 9.80665),\n        (1.0, 0.0, 0.0, 9.81),\n    ]\n\n    # Numerical tolerance\n    epsilon = 1e-12\n\n    results = []\n    \n    for m, alpha, mu, g in test_cases:\n        # State classification\n        tan_alpha = np.tan(alpha)\n        \n        state = -1 # Uninitialized state\n        Rn = 0.0\n        Rt = 0.0\n\n        if tan_alpha  mu - epsilon:\n            # Stick condition\n            state = 0\n            # From Newton's laws for equilibrium (a_n=0, a_t=0)\n            # R_n - m*g*cos(alpha) = 0\n            # m*g*sin(alpha) - R_t = 0\n            Rn = m * g * np.cos(alpha)\n            Rt = m * g * np.sin(alpha)\n        elif np.abs(tan_alpha - mu) = epsilon:\n            # Slip-threshold condition\n            state = 1\n            # R_n is the same as for stick case\n            # R_t is at its maximum value: R_t = mu * R_n\n            Rn = m * g * np.cos(alpha)\n            Rt = mu * Rn\n        \n        results.append([state, Rn, Rt])\n\n    # Format the results into the required string format.\n    # Each sublist is formatted as [s, Rn, Rt] with floats rounded to 6 decimal places.\n    formatted_results = []\n    for res in results:\n        s, Rn, Rt = res\n        formatted_results.append(f\"[{s},{Rn:.6f},{Rt:.6f}]\")\n\n    # Combine all formatted sublists into the final output string.\n    final_output = f\"[{','.join(formatted_results)}]\"\n\n    # Final print statement in the exact required format.\n    print(final_output)\n\nsolve()\n```"
        },
        {
            "introduction": "摩擦是一个耗散过程，理解其能量耗散的机制至关重要。当法向力 $N(t)$ 随时间变化时，摩擦功 $W_f$ 不仅取决于总滑移距离，还强烈依赖于滑移发生的具体路径和时间。这个练习  将引导你通过对一个给定的粘滑（stick-slip）路径进行积分来精确计算摩擦功，从而深化对摩擦功路径依赖性的理解。",
            "id": "3555423",
            "problem": "一个单位面积的刚性平面滑块与一个粗糙的刚性基底发生单边接触。该界面遵循率无关的库仑摩擦定律，摩擦系数为 $\\mu$，法向接触压应力（单位面积上的压缩应力）的大小是随时间变化的，由 $N(t)$ 给出。设界面牵引力矢量为 $\\boldsymbol{t}(t)$，界面速度的切向分量为 $\\boldsymbol{v}_t(t)$。在时间区间 $\\left[t_0,t_1\\right]$ 内累积的单位面积摩擦功定义为\n$$\nW_f \\;=\\; \\int_{t_0}^{t_1} \\boldsymbol{t}(t)\\cdot \\boldsymbol{v}_t(t)\\,dt.\n$$\n假设如下：\n- 库仑摩擦定律成立：在滑移期间，$\\boldsymbol{t}(t) = -\\mu\\,N(t)\\,\\boldsymbol{e}_t(t)$，其中 $\\boldsymbol{e}_t(t)$ 是与 $\\boldsymbol{v}_t(t)$ 方向一致的单位切向量；在黏滞期间，$|\\boldsymbol{t}(t)| \\le \\mu\\,N(t)$ 且 $\\boldsymbol{v}_t(t)=\\boldsymbol{0}$。\n- 法向应力为 $N(t)=N_0+N_1\\cos(\\omega t)$，其中 $N_00$，$|N_1|N_0$ 以确保接触压力始终为正。\n- 在时间区间 $[0, 2\\pi]$ 秒内，界面经历一个黏滑循环，其切向速度 $|\\boldsymbol{v}_t(t)|$ 在滑移期间为常数 $V0$。滑移发生在时间子区间 $[0, \\frac{\\pi}{2}]$ 和 $[\\frac{2\\pi}{3}, \\frac{7\\pi}{6}]$ 内，在其他时间黏滞。\n\n您的任务是推导并计算在给定区间 $[0, 2\\pi]$ 内所做的总摩擦功 $W_f$（单位：焦耳/平方米）。参数如下：$\\mu=0.4$ (无量纲)，$N_0=2000$ $\\text{N}/\\text{m}^2$ (Pa)，$N_1=500$ $\\text{N}/\\text{m}^2$ (Pa)，$V=0.5$ $\\text{m}/\\text{s}$，$\\omega=1.0$ $\\text{rad}/\\text{s}$。提供一个精确的解析表达式作为答案，不需要数值近似。",
            "solution": "该问题要求计算在指定的时间区间和黏滑路径下，滑块在粗糙基底上单位面积的摩擦功 $W_f$。分析将从 $W_f$ 的给定定义出发，遵循基本原理进行。\n\n单位面积的摩擦功定义为：\n$$\nW_f = \\int_{t_0}^{t_1} \\boldsymbol{t}(t) \\cdot \\boldsymbol{v}_t(t) \\, dt\n$$\n时间区间为 $[t_0, t_1] = [0, 2\\pi]$。被积函数 $\\boldsymbol{t}(t) \\cdot \\boldsymbol{v}_t(t)$ 代表了界面牵引力 $\\boldsymbol{t}(t)$ 对切向速度为 $\\boldsymbol{v}_t(t)$ 的滑块做功的速率。我们必须根据界面状态（黏滞或滑移）来计算该被积函数的值。\n\n在黏滞期间，切向速度为零，即 $\\boldsymbol{v}_t(t) = \\boldsymbol{0}$。因此，点积 $\\boldsymbol{t}(t) \\cdot \\boldsymbol{v}_t(t) = 0$。所以在黏滞区间内不做功。\n\n在滑移期间，切向速度具有恒定的大小 $|\\boldsymbol{v}_t(t)| = V$，其方向由单位向量 $\\boldsymbol{e}_t(t) = \\boldsymbol{v}_t(t) / V$ 给出。库仑摩擦定律规定，界面牵引力 $\\boldsymbol{t}(t)$ 的方向与滑移方向相反，其大小与法向应力 $N(t)$ 成正比。其表达式为：\n$$\n\\boldsymbol{t}(t) = -\\mu \\, N(t) \\, \\boldsymbol{e}_t(t)\n$$\n其中 $\\mu$ 是摩擦系数。\n\n现在我们可以计算滑移期间的做功速率：\n$$\n\\boldsymbol{t}(t) \\cdot \\boldsymbol{v}_t(t) = \\left( -\\mu \\, N(t) \\, \\boldsymbol{e}_t(t) \\right) \\cdot \\left( V \\, \\boldsymbol{e}_t(t) \\right)\n$$\n由于 $\\boldsymbol{e}_t(t)$ 是单位向量，$\\boldsymbol{e}_t(t) \\cdot \\boldsymbol{e}_t(t) = 1$。表达式简化为：\n$$\n\\boldsymbol{t}(t) \\cdot \\boldsymbol{v}_t(t) = -\\mu V N(t)\n$$\n这个量代表了摩擦力在滑块上消耗的单位面积功率。负号正确地表明摩擦是一种耗散力，意味着它从滑块中移除能量（即对其做负功）。该功率的大小 $\\mu V N(t)$ 是单位面积的能量耗散率。\n\n总摩擦功 $W_f$ 是此功率在整个周期上的时间积分。由于在黏滞期间被积函数为零，我们只需在指定的滑移区间 $[0, \\frac{\\pi}{2}]$ 和 $[\\frac{2\\pi}{3}, \\frac{7\\pi}{6}]$ 上进行积分。\n$$\nW_f = \\int_0^{2\\pi} (-\\mu V N(t) \\cdot I_{slip}(t)) \\, dt\n$$\n其中 $I_{slip}(t)$ 是一个指示函数，在滑移期间为 1，在黏滞期间为 0。这可以分解为在滑移区间上的两个积分：\n$$\nW_f = \\int_0^{\\pi/2} -\\mu V N(t) \\, dt + \\int_{2\\pi/3}^{7\\pi/6} -\\mu V N(t) \\, dt\n$$\n参数 $\\mu$ 和 $V$ 是常数，因此可以提取出来：\n$$\nW_f = -\\mu V \\left( \\int_0^{\\pi/2} N(t) \\, dt + \\int_{2\\pi/3}^{7\\pi/6} N(t) \\, dt \\right)\n$$\n法向应力由 $N(t) = N_0 + N_1 \\cos(\\omega t)$ 给出，其中 $\\omega=1$ rad/s。将此代入积分：\n$$\nW_f = -\\mu V \\left( \\int_0^{\\pi/2} (N_0 + N_1 \\cos(t)) \\, dt + \\int_{2\\pi/3}^{7\\pi/6} (N_0 + N_1 \\cos(t)) \\, dt \\right)\n$$\n我们可以分别计算 $N_0$ 和 $N_1\\cos(t)$ 项的积分。常数项 $N_0$ 的积分为：\n$$\n\\int_0^{\\pi/2} N_0 \\, dt + \\int_{2\\pi/3}^{7\\pi/6} N_0 \\, dt = N_0 \\left( \\frac{\\pi}{2} - 0 \\right) + N_0 \\left( \\frac{7\\pi}{6} - \\frac{2\\pi}{3} \\right) = N_0 \\frac{\\pi}{2} + N_0 \\left( \\frac{7\\pi - 4\\pi}{6} \\right) = N_0 \\frac{\\pi}{2} + N_0 \\frac{3\\pi}{6} = N_0 \\pi\n$$\n该项仅取决于总滑移持续时间，即 $\\pi$ 秒。\n\n时变项 $N_1 \\cos(t)$ 的积分为：\n$$\n\\int_0^{\\pi/2} N_1 \\cos(t) \\, dt + \\int_{2\\pi/3}^{7\\pi/6} N_1 \\cos(t) \\, dt = N_1 \\left( \\int_0^{\\pi/2} \\cos(t) \\, dt + \\int_{2\\pi/3}^{7\\pi/6} \\cos(t) \\, dt \\right)\n$$\n各个定积分分别为：\n$$\n\\int_0^{\\pi/2} \\cos(t) \\, dt = [\\sin(t)]_0^{\\pi/2} = \\sin\\left(\\frac{\\pi}{2}\\right) - \\sin(0) = 1 - 0 = 1\n$$\n$$\n\\int_{2\\pi/3}^{7\\pi/6} \\cos(t) \\, dt = [\\sin(t)]_{2\\pi/3}^{7\\pi/6} = \\sin\\left(\\frac{7\\pi}{6}\\right) - \\sin\\left(\\frac{2\\pi}{3}\\right)\n$$\n三角函数值为 $\\sin(7\\pi/6) = -\\frac{1}{2}$ 和 $\\sin(2\\pi/3) = \\frac{\\sqrt{3}}{2}$。\n$$\n\\int_{2\\pi/3}^{7\\pi/6} \\cos(t) \\, dt = -\\frac{1}{2} - \\frac{\\sqrt{3}}{2} = -\\frac{1+\\sqrt{3}}{2}\n$$\n将余弦项的贡献相加：\n$$\n1 + \\left(-\\frac{1+\\sqrt{3}}{2}\\right) = \\frac{2 - 1 - \\sqrt{3}}{2} = \\frac{1-\\sqrt{3}}{2}\n$$\n综合所有部分，$W_f$ 的精确解析表达式为：\n$$\nW_f = -\\mu V \\left( N_0 \\pi + N_1 \\left( \\frac{1-\\sqrt{3}}{2} \\right) \\right)\n$$\n该表达式展示了 $W_f$ 如何依赖于各项参数。$N_0\\pi$ 项是在总滑移持续时间 $\\pi$ 内，法向力恒定为其平均值 $N_0$ 时所做的功。带有 $N_1$ 的项代表了由变化的法向载荷引起的修正。其值取决于 $\\cos(t)$ 在滑移区间上的积分，这意味着它对滑移发生时间相对于法向力振荡相位的位置很敏感。\n\n这种路径相关性可以通过考虑一个总持续时间相同但滑移路径不同的情况来说明。如果滑移发生在 $[-\\pi/2, \\pi/2]$（总持续时间为 $\\pi$），$\\cos(t)$ 的积分将是 $\\int_{-\\pi/2}^{\\pi/2} \\cos(t)dt = 2$，而 $W_f$ 将是 $-\\mu V(N_0\\pi + 2N_1)$。这与我们的结果不同，从而证实了对于时变的法向载荷，即使总滑移持续时间固定，总摩擦功也是路径相关的。\n\n现在，我们使用给定的参数计算数值：$\\mu=0.4$，$N_0=2000$ Pa，$N_1=500$ Pa，以及 $V=0.5$ m/s。\n$$\nW_f = -(0.4)(0.5) \\left( (2000) \\pi + (500) \\left( \\frac{1-\\sqrt{3}}{2} \\right) \\right)\n$$\n$$\nW_f = -0.2 \\left( 2000\\pi + 250(1-\\sqrt{3}) \\right)\n$$\n将 $-0.2$ 分配进去：\n$$\nW_f = -(0.2 \\times 2000)\\pi - (0.2 \\times 250)(1-\\sqrt{3})\n$$\n$$\nW_f = -400\\pi - 50(1-\\sqrt{3})\n$$\n$$\nW_f = -400\\pi - 50 + 50\\sqrt{3}\n$$\n单位为 $(\\text{无量纲}) \\times (\\text{m/s}) \\times (\\text{N/m}^2) \\times (\\text{s}) = (\\text{N}\\cdot\\text{m})/\\text{m}^2 = \\text{J/m}^2$，符合要求。最终答案是一个未经四舍五入的精确表达式。\n为了紧凑表示而重新整理：\n$$\nW_f = -(400\\pi + 50 - 50\\sqrt{3})\n$$",
            "answer": "$$\n\\boxed{-(400\\pi + 50 - 50\\sqrt{3})}\n$$"
        },
        {
            "introduction": "将理想的摩擦模型应用于数值模拟时，我们经常会遇到意想不到的挑战。由于几何离散化和数值噪声的存在，库仑模型中急剧的力-速度转变可能导致非物理的高频振荡，即所谓的“数值颤振”（numerical chatter）。这个高级练习  模拟了这一现象，并探讨了如何通过平滑等技术来缓解这种伪影，这对于开发稳定可靠的接触动力学仿真至关重要。",
            "id": "3555440",
            "problem": "考虑一个单自由度质点 $m$，代表一个在刚性平面上滑动的刚性滑块。该滑块通过一个刚度为 $k$ 的线性弹簧进行切向驱动，弹簧的固定端以恒定速度 $v_0$ 移动。滑块与平面之间的接触存在摩擦，并遵循经典的库仑摩擦模型。设全局坐标系中，预期的滑动方向为全局 $x$ 轴，平面的名义法线方向为全局 $y$ 轴。通过一个使法向间隙保持为零的约束，强制质点始终与平面保持接触。由于接触检测噪声和几何离散化，接触法线方向允许随时间变化，这被建模为一个时变法向角 $\\theta(t)$，单位为弧度，从全局 $y$ 轴向量全局 $x$ 轴测量。法向单位向量和切向单位向量分别为\n$$\nn(t) = \\begin{bmatrix}\\sin \\theta(t) \\\\ \\cos \\theta(t)\\end{bmatrix}, \\quad\nt(t) = \\begin{bmatrix}\\cos \\theta(t) \\\\ -\\sin \\theta(t)\\end{bmatrix}.\n$$\n该模拟由以下假设和模型驱动：\n- 牛顿第二定律在切向方向上成立：$m \\, \\dot{v}_x(t) = F_s(t) + F_f^x(t)$，其中 $v_x(t)$ 是滑块速度的全局 $x$ 分量，$F_s(t)$ 是沿全局 $x$ 方向的弹簧力，$F_f^x(t)$ 是摩擦力的全局 $x$ 分量。\n- 弹簧力为 $F_s(t) = k \\left( x_d(t) - x(t) \\right)$，其中 $x(t)$ 是滑块的位置（单位：米），$x_d(t) = v_0 t$ 是以恒定速度 $v_0$ 演变的驱动位置（单位：米）。\n- 法向反力的大小近似为一个常数 $N = m g$，其中 $g$ 是重力加速度。此近似在 $\\theta(t)$ 很小时有效，确保 $N$ 保持在接近 $m g$ 的值。\n- 在接触切向方向上施加带滞后效应的库仑摩擦，其阈值为 $\\mu_{\\text{stick}\\rightarrow\\text{slip}} = \\mu (1 + h)$ 和 $\\mu_{\\text{slip}\\rightarrow\\text{stick}} = \\mu (1 - h)$，其中 $\\mu$ 是摩擦系数，$h \\in [0,1)$ 是一个滞后系数。定义弹簧力的切向投影为 $F_s^t(t) = F_s(t) \\, t_x(t) = F_s(t) \\cos \\theta(t)$，切向滑移速度为 $v_t(t) = v_x(t) \\cos \\theta(t)$。粘滑切换逻辑如下：\n  - 如果接触当前处于粘滞状态且 $|F_s^t(t)|  \\mu (1 + h) N$，则切换到滑动状态。\n  - 如果接触当前处于滑动状态且 $|F_s^t(t)| \\le \\mu (1 - h) N$ 且 $|v_t(t)| \\le v_\\varepsilon$，则切换到粘滞状态。\n  在粘滞期间，在该时间步内设置 $v_x(t) = 0$ 且 $x(t)$ 为常数。在滑动期间，施加动摩擦力 $F_f^t(t) = - \\mu (1 - h) N \\, \\operatorname{sign}(v_t(t))$（如果 $v_t(t) = 0$，则使用 $\\operatorname{sign}(F_s^t(t))$），其全局 $x$ 分量为 $F_f^x(t) = F_f^t(t) \\, t_x(t) = F_f^t(t) \\cos \\theta(t)$。\n- 法向角 $\\theta(t)$ 是几何离散化和检测噪声组合的结果，并通过指数平滑进行处理：\n  1. 定义基础角 $\\theta_b(t) = A \\sin(\\omega t)$，其振幅为 $A$，基础频率为 $\\omega = 2 \\pi f_b$。\n  2. 通过将 $\\theta_b(t)$ 在区间 $[-A, A]$ 内量化到 $L$ 个等间隔层级，应用几何离散化，得到 $\\theta_q(t)$。\n  3. 添加检测噪声 $\\delta \\theta(t) = 0.1 A \\sin(\\omega_j t)$，其抖动频率为 $\\omega_j = 2 \\pi f_j$，产生原始角度 $\\theta_{\\text{raw}}(t) = \\theta_q(t) + \\delta \\theta(t)$。\n  4. 应用指数平滑：$\\theta(t_n) = (1 - \\alpha) \\, \\theta(t_{n-1}) + \\alpha \\, \\theta_{\\text{raw}}(t_n)$，其中平滑因子为 $\\alpha \\in [0,1]$，在离散时间 $t_n = n \\Delta t$，$n = 0,1,2,\\dots$，时间步长为 $\\Delta t$。\n\n模拟通过在滑动模式下使用显式欧拉积分进行时间步进：\n$$\na_x(t_n) = \\frac{F_s(t_n) + F_f^x(t_n)}{m}, \\quad\nv_x(t_{n+1}) = v_x(t_n) + \\Delta t \\, a_x(t_n), \\quad\nx(t_{n+1}) = x(t_n) + \\Delta t \\, v_x(t_{n+1}),\n$$\n并在粘滞期间保持 $v_x(t_n) = 0$。初始条件为 $x(0) = 0$ 和 $v_x(0) = 0$，初始模式为粘滞。重力加速度为 $g = 9.81$ $\\text{m}/\\text{s}^2$。\n\n将伪颤振分数 $\\psi$ 定义为：自上次转换以来时间间隔小于或等于颤振阈值 $\\tau_c$ 的粘滑转换次数，除以在整个模拟过程中观察到的总转换次数。如果没有发生转换，则设置 $\\psi = 0$。角度单位必须是弧度，所有量均使用国际单位制 (SI)：米、千克、秒和牛顿。伪颤振分数 $\\psi$ 是无量纲的，必须以小数形式报告。\n\n为给定的测试套件实现上述模拟。对于所有情况，使用相同的数值参数：时间步长 $\\Delta t = 0.001$ $\\text{s}$，总时间 $T = 3.0$ $\\text{s}$，颤振阈值 $\\tau_c = 0.005$ $\\text{s}$，基础频率 $f_b = 30$ $\\text{Hz}$，以及抖动频率 $f_j = 200$ $\\text{Hz}$。使用 $v_\\varepsilon = 10^{-4}$ $\\text{m}/\\text{s}$。\n\n测试套件：\n- 案例1（理想情况，中等噪声，一定平滑，轻度滞后）：$m = 1.0$ $\\text{kg}$，$k = 100.0$ $\\text{N}/\\text{m}$，$\\mu = 0.3$，$v_0 = 0.05$ $\\text{m}/\\text{s}$，$A = 0.05$ $\\text{rad}$，$L = 8$，$\\alpha = 0.2$，$h = 0.1$。\n- 案例2（大噪声振幅，粗糙几何，强平滑，无滞后）：$m = 1.0$ $\\text{kg}$，$k = 100.0$ $\\text{N}/\\text{m}$，$\\mu = 0.3$，$v_0 = 0.05$ $\\text{m}/\\text{s}$，$A = 0.2$ $\\text{rad}$，$L = 3$，$\\alpha = 0.05$，$h = 0.0$。\n- 案例3（无平滑，中等噪声，无滞后）：$m = 1.0$ $\\text{kg}$，$k = 100.0$ $\\text{N}/\\text{m}$，$\\mu = 0.3$，$v_0 = 0.05$ $\\text{m}/\\text{s}$，$A = 0.1$ $\\text{rad}$，$L = 4$，$\\alpha = 1.0$，$h = 0.0$。\n- 案例4（精细几何离散化，低噪声，中等平滑，较强滞后）：$m = 1.0$ $\\text{kg}$，$k = 100.0$ $\\text{N}/\\text{m}$，$\\mu = 0.3$，$v_0 = 0.05$ $\\text{m}/\\text{s}$，$A = 0.02$ $\\text{rad}$，$L = 64$，$\\alpha = 0.5$，$h = 0.2$。\n- 案例5（中等噪声，中等平滑，强滞后）：$m = 1.0$ $\\text{kg}$，$k = 100.0$ $\\text{N}/\\text{m}$，$\\mu = 0.3$，$v_0 = 0.05$ $\\text{m}/\\text{s}$，$A = 0.1$ $\\text{rad}$，$L = 8$，$\\alpha = 0.3$，$h = 0.5$。\n\n您的程序应生成单行输出，其中包含五个案例的伪颤振分数，形式为包含在方括号中的逗号分隔列表（例如，$[\\psi_1,\\psi_2,\\psi_3,\\psi_4,\\psi_5]$）。每个 $\\psi_i$ 必须打印为十进制数。",
            "solution": "该问题要求通过模拟一个单自由度摩擦系统来计算伪颤振分数 $\\psi$。该模拟基于一组耦合的时变常微分方程和一个用于粘滑摩擦模型的状态机。解决方案是通过对系统进行时间离散化并实现一个显式时间步进算法来获得的。\n\n在任何离散时间步 $t_n = n \\Delta t$，系统的状态由滑块的位置 $x(t_n)$、其速度 $v_x(t_n)$、平滑后的接触法向角 $\\theta(t_n)$ 以及接触的摩擦状态（粘滞或滑动）来描述。在 $t_0=0$ 时的初始条件为 $x(0)=0$，$v_x(0)=0$，初始模式为“粘滞”。假设在 $t  0$ 时系统处于静止状态，初始角度 $\\theta(0)$ 取为 $0$。模拟总时长为 $T = 3.0$ 秒，时间步长为 $\\Delta t=0.001$ 秒。\n\n解决方案的核心是一个时间步进循环，它将系统状态从 $t_n$推进到 $t_{n+1}$。在每一步 $n$，执行以下操作序列：\n\n1.  **更新接触法向角 $\\theta(t_n)$**：根据指定的多阶段过程计算随时间变化的法向角 $\\theta(t_n)$。\n    -   计算基础正弦角 $\\theta_b(t_n) = A \\sin(\\omega_b t_n)$，其中 $\\omega_b = 2 \\pi f_b$ 且 $f_b=30$ Hz。\n    -   $\\theta_b(t_n)$ 在区间 $[-A, A]$ 内被量化到 $L$ 个离散层级中的一个。量化函数将值 $v \\in [-A, A]$ 映射到集合 $\\{-A, -A + \\frac{2A}{L-1}, \\dots, A\\}$ 中最接近的层级。\n    -   计算高频正弦噪声项 $\\delta \\theta(t_n) = 0.1 A \\sin(\\omega_j t_n)$，其中 $\\omega_j = 2 \\pi f_j$ 且 $f_j = 200$ Hz。\n    -   原始角度由 $\\theta_{\\text{raw}}(t_n) = \\theta_q(t_n) + \\delta \\theta(t_n)$ 构成。\n    -   最后，通过指数平滑更新平滑角度 $\\theta(t_n)$：$\\theta(t_n) = (1 - \\alpha) \\theta(t_{n-1}) + \\alpha \\theta_{\\text{raw}}(t_n)$。对于第一步 $t_0=0$，我们使用 $\\theta(t_{-1})=0$。\n\n2.  **评估力和摩擦状态**：根据 $t_n$ 时的状态计算力，以确定区间 $[t_n, t_{n+1}]$ 内的摩擦模式。\n    -   弹簧力为 $F_s(t_n) = k (v_0 t_n - x(t_n))$。\n    -   弹簧力的切向投影为 $F_s^t(t_n) = F_s(t_n) \\cos(\\theta(t_n))$。\n    -   切向滑移速度为 $v_t(t_n) = v_x(t_n) \\cos(\\theta(t_n))$。\n    -   法向力近似为常数 $N = mg$，其中 $g = 9.81 \\, \\text{m}/\\text{s}^2$。\n    -   粘滞到滑动的转换阈值为 $F_{\\text{stick}\\rightarrow\\text{slip}} = \\mu (1 + h) N$。\n    -   滑动到粘滞的力阈值为 $F_{\\text{slip}\\rightarrow\\text{stick}} = \\mu (1-h) N$。\n    -   应用状态机逻辑：\n        -   如果当前模式为“粘滞”，当 $|F_s^t(t_n)|  F_{\\text{stick}\\rightarrow\\text{slip}}$ 时，发生向“滑动”的转换。\n        -   如果当前模式为“滑动”，当 $|F_s^t(t_n)| \\le F_{\\text{slip}\\rightarrow\\text{stick}}$ 且 $|v_t(t_n)| \\le v_\\varepsilon$ 时，发生向“粘滞”的转换，其中 $v_\\varepsilon = 10^{-4} \\, \\text{m}/\\text{s}$。\n    -   如果发生转换，则记录时间 $t_n$。\n\n3.  **将状态传播到 $t_{n+1}$**：根据上一步确定的模式更新系统状态。\n    -   **如果在“粘滞”模式下**：滑块的速度被设为零，其位置保持不变。\n        $$v_x(t_{n+1}) = 0$$\n        $$x(t_{n+1}) = x(t_n)$$\n    -   **如果在“滑动”模式下**：使用半隐式欧拉格式对运动方程进行积分。\n        -   切向动摩擦力为 $F_f^t(t_n) = - \\mu (1 - h) N \\cdot \\text{sign}(v_t(t_n))$。如果 $v_t(t_n)$ 实际上为零，则改用即将发生的运动的符号，即 $\\text{sign}(F_s^t(t_n))$。\n        -   摩擦力的全局 $x$ 分量为 $F_f^x(t_n) = F_f^t(t_n) \\cos(\\theta(t_n))$。\n        -   通过牛顿第二定律计算加速度：$a_x(t_n) = (F_s(t_n) + F_f^x(t_n)) / m$。\n        -   更新状态：\n            $$v_x(t_{n+1}) = v_x(t_n) + \\Delta t \\cdot a_x(t_n)$$\n            $$x(t_{n+1}) = x(t_n) + \\Delta t \\cdot v_x(t_{n+1})$$\n\n4.  **计算伪颤振分数 $\\psi$**：在模拟于 $T = 3.0$ 秒完成后，分析记录的转换时间列表。\n    -   设 $K$ 个转换时间的序列为 $T_1, T_2, \\ldots, T_K$。\n    -   如果 $K \\le 1$，则无法形成时间间隔，因此 $\\psi=0$。\n    -   “颤振”转换的数量是满足以下条件的转换 $T_j$（对于 $j \\in \\{2, \\ldots, K\\}$）的计数：其前一个时间间隔小于或等于颤振阈值，即 $T_j - T_{j-1} \\le \\tau_c$，其中 $\\tau_c = 0.005$ 秒。设此计数为 $N_{\\text{chatter}}$。\n    -   伪颤振分数的计算方法是颤振转换次数与总转换次数的比率：$\\psi = N_{\\text{chatter}} / K$。\n\n这整个过程被封装在一个函数中，该函数接受单个测试用例的参数。对测试套件中提供的五个案例中的每一个都调用此函数，并将得到的 $\\psi$ 值收集并格式化为所需的输出字符串。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the simulation for all test cases and print results.\n    \"\"\"\n    # Numerical parameters common to all cases\n    G = 9.81  # m/s^2\n    DT = 0.001  # s\n    T_TOTAL = 3.0  # s\n    TAU_C = 0.005  # s\n    F_B = 30.0  # Hz\n    F_J = 200.0  # Hz\n    V_EPS = 1e-4  # m/s\n\n    test_cases = [\n        # Case 1 (m, k, mu, v0, A, L, alpha, h)\n        (1.0, 100.0, 0.3, 0.05, 0.05, 8, 0.2, 0.1),\n        # Case 2\n        (1.0, 100.0, 0.3, 0.05, 0.2, 3, 0.05, 0.0),\n        # Case 3\n        (1.0, 100.0, 0.3, 0.05, 0.1, 4, 1.0, 0.0),\n        # Case 4\n        (1.0, 100.0, 0.3, 0.05, 0.02, 64, 0.5, 0.2),\n        # Case 5\n        (1.0, 100.0, 0.3, 0.05, 0.1, 8, 0.3, 0.5),\n    ]\n\n    results = []\n    for case_params in test_cases:\n        m, k, mu, v0, A, L, alpha, h = case_params\n        \n        # Pass all parameters to the simulation runner\n        psi = run_simulation(m, k, mu, v0, A, L, alpha, h, G, DT, T_TOTAL, TAU_C, F_B, F_J, V_EPS)\n        results.append(psi)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef quantize(val, A, L):\n    \"\"\"Quantizes a value to L levels in the symmetric interval [-A, A].\"\"\"\n    if L = 1:\n        return 0.0\n    \n    interval_size = 2.0 * A / (L - 1)\n    if interval_size == 0:\n        return 0.0\n        \n    # Map val from [-A, A] to an index in [0, L-1]\n    index = np.round((val + A) / interval_size)\n    index = np.clip(index, 0, L - 1)\n    \n    # Return the quantized value corresponding to the index\n    return -A + index * interval_size\n\ndef run_simulation(m, k, mu, v0, A, L, alpha, h, G, DT, T_TOTAL, TAU_C, F_B, F_J, V_EPS):\n    \"\"\"\n    Runs a single simulation for a given set of parameters.\n    \"\"\"\n    # Setup simulation time and state arrays\n    num_steps = int(T_TOTAL / DT) + 1\n    t = np.linspace(0, T_TOTAL, num_steps)\n    \n    x = np.zeros(num_steps)\n    vx = np.zeros(num_steps)\n    theta = np.zeros(num_steps)\n    \n    # Calculate constants for the simulation\n    N = m * G\n    omega_b = 2 * np.pi * F_B\n    omega_j = 2 * np.pi * F_J\n    \n    # Friction force thresholds\n    stick_slip_thresh = mu * (1 + h) * N\n    slip_stick_thresh_F = mu * (1 - h) * N\n    kinetic_friction_force_mag = slip_stick_thresh_F\n\n    # Initial state\n    mode = 'stick'\n    transition_times = []\n    \n    # theta[0] is 0 based on quiescent pre-simulation state\n    theta[0] = 0.0\n\n    # Main simulation loop\n    for n in range(num_steps - 1):\n        t_n = t[n]\n        \n        # 1. Update contact normal angle theta for current step t_n\n        # The first theta[0] is the initial value, update from n=1 (so theta[0] is used)\n        # In the loop, we calculate theta[n] using theta[n-1]\n        # This is safe because theta[0] is pre-set and n starts from 0.\n        # But let's be explicit and update theta[n] at step n based on theta[n-1]\n        if n > 0:\n            theta_b_n = A * np.sin(omega_b * t_n)\n            theta_q_n = quantize(theta_b_n, A, L)\n            delta_theta_n = 0.1 * A * np.sin(omega_j * t_n)\n            theta_raw_n = theta_q_n + delta_theta_n\n            theta[n] = (1 - alpha) * theta[n-1] + alpha * theta_raw_n\n        \n        # 2. Evaluate forces and check for state transition\n        x_d = v0 * t_n\n        F_s = k * (x_d - x[n])\n        cos_theta_n = np.cos(theta[n])\n        F_s_t = F_s * cos_theta_n\n        v_t = vx[n] * cos_theta_n\n        \n        prev_mode = mode\n        if mode == 'stick':\n            if abs(F_s_t) > stick_slip_thresh:\n                mode = 'slip'\n        else:  # mode == 'slip'\n            if abs(F_s_t) = slip_stick_thresh_F and abs(v_t) = V_EPS:\n                mode = 'stick'\n\n        if mode != prev_mode:\n            transition_times.append(t_n)\n\n        # 3. Propagate state to t_{n+1}\n        if mode == 'stick':\n            vx[n+1] = 0.0\n            x[n+1] = x[n]\n        else:  # mode == 'slip'\n            if abs(v_t) > 1e-12:\n                sign_v = np.sign(v_t)\n            else:\n                sign_v = np.sign(F_s_t) if F_s_t != 0 else 1\n            \n            Ff_t = -kinetic_friction_force_mag * sign_v\n            Ff_x = Ff_t * cos_theta_n\n            \n            ax = (F_s + Ff_x) / m\n            vx[n+1] = vx[n] + DT * ax\n            x[n+1] = x[n] + DT * vx[n+1]  # Semi-implicit Euler\n\n    # 4. Calculate spurious chatter fraction psi\n    num_transitions = len(transition_times)\n    if num_transitions = 1:\n        return 0.0\n\n    chatter_count = 0\n    intervals = np.diff(np.array(transition_times))\n    chatter_count = np.sum(intervals = TAU_C)\n        \n    psi = chatter_count / (num_transitions-1) if num_transitions > 1 else 0.0\n    # Correction: The definition asks for number of chattering transitions / total transitions.\n    # A \"chattering transition\" is one that happens too quickly after the *previous* one.\n    # So if there are K transitions, there are K-1 intervals. The number of short intervals is `chatter_count`.\n    # A transition at T_j is a \"chatter transition\" if T_j - T_{j-1} = tau_c.\n    # So the denominator should be the total number of transitions, K.\n    psi = chatter_count / num_transitions if num_transitions > 0 else 0.0\n    # Re-reading prompt: \"number of stick-slip transitions for which the time elapsed since the last transition is less than or equal to ... divided by the total number of transitions observed\"\n    # This means chatter_count / K. Let's stick with that.\n    return psi if num_transitions > 0 else 0.0\n\nsolve()\n```"
        }
    ]
}