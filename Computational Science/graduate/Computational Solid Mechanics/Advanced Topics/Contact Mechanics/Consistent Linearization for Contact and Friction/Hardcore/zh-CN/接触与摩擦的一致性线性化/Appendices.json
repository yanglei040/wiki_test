{
    "hands_on_practices": [
        {
            "introduction": "本次实践是基础。我们将从一个看似简单的单节点接触模型入手，探讨一致性线性化的核心概念。通过为粘着（stick）和滑动（slip）状态推导精确的雅可比矩阵并实现一个牛顿求解器，你将直接观察到一致性切线在实现快速、二次收敛方面的威力，这对于高效、稳健的非线性有限元分析至关重要。",
            "id": "3555393",
            "problem": "考虑一个可变形体与刚性基础之间的准静态、平面、单节点切向接触问题，其中包含库仑摩擦。该可变形体由一个刚度为 $k_{s}  0$ 的线性弹性切向弹簧建模，该弹簧连接到一个约束在平面内的质点上。接触界面由一个切向罚刚度 $k_{t}  0$ 和库仑摩擦极限 $\\tau = \\mu p  0$ 建模，其中 $\\mu$ 是摩擦系数，$p$ 是（恒定的）接触压力。设未知切向位移为向量 $u \\in \\mathbb{R}^{2}$，外部施加的载荷为 $F \\in \\mathbb{R}^{2}$。\n\n节点处的控制平衡方程是力的平衡\n$$\nK u + t(u) = F,\n$$\n其中 $K = k_{s} I$ 是结构刚度，$I \\in \\mathbb{R}^{2 \\times 2}$ 是单位矩阵，$t(u) \\in \\mathbb{R}^{2}$ 是由界面提供的摩擦牵引力。带有粘滞切向罚函数的库仑摩擦模型由以下活动集特征定义：\n\n- 定义试探牵引力\n$$\nt_{\\mathrm{tr}}(u) = k_{t}\\,u.\n$$\n\n- 粘滞集：如果 $\\|t_{\\mathrm{tr}}(u)\\| \\le \\tau$，则状态为粘滞，牵引力为\n$$\nt(u) = t_{\\mathrm{tr}}(u).\n$$\n\n- 滑移集：如果 $\\|t_{\\mathrm{tr}}(u)\\|  \\tau$，则状态为滑移，牵引力被径向返回到库仑摩擦盘上，\n$$\nt(u) = \\tau \\,\\frac{t_{\\mathrm{tr}}(u)}{\\|t_{\\mathrm{tr}}(u)\\|} = \\tau \\,\\frac{u}{\\|u\\|}.\n$$\n\n你需要推导残差的完全一致线性化，以便在每次迭代中都进行活动集更新的整体牛顿法中使用。具体而言：\n\n1. 仅从平衡方程、上述粘滞/滑移定义和微积分法则出发，推导牛顿法残差\n$$\nr(u) = K u + t(u) - F,\n$$\n和一致的雅可比矩阵\n$$\nJ(u) = \\frac{\\partial r(u)}{\\partial u} = K + \\frac{\\partial t(u)}{\\partial u},\n$$\n两者均需覆盖粘滞集和滑移集。你的推导必须说明活动集更新如何进入算法，并解释为何一旦确定了集合，线性化仍然保持一致。\n\n2. 根据上述粘滞/滑移准则，在每次迭代中进行活动集更新，实现一个用于求解非线性系统 $r(u) = 0$ 的牛顿求解器，并使用为当前集合推导的一致雅可比矩阵。在每次迭代 $k$ 中，计算残差范数 $\\|r(u^{(k)})\\|_{2}$，通过求解\n$$\nJ(u^{(k)})\\,\\Delta u^{(k)} = -r(u^{(k)}), \\quad u^{(k+1)} = u^{(k)} + \\Delta u^{(k)},\n$$\n来更新 $u^{(k+1)}$，并记录活动集标签（粘滞或滑移）。当 $\\|r(u^{(k)})\\|_{2} \\le \\varepsilon$ 时终止，其中 $\\varepsilon  0$ 为预设容差。\n\n3. 通过检查每个载荷步迭代序列末端的观测收敛阶，定量验证在重复的粘滞-滑移转换过程中是否保持了二次收敛。使用残差范数将局部观测阶定义为\n$$\np_{k} = \\frac{\\ln\\left(\\dfrac{\\|r(u^{(k+1)})\\|_{2}}{\\|r(u^{(k)})\\|_{2}}\\right)}{\\ln\\left(\\dfrac{\\|r(u^{(k)})\\|_{2}}{\\|r(u^{(k-1)})\\|_{2}}\\right)},\n$$\n前提是分母有定义且所有残差范数均为严格正值。为避免前渐近污染，仅在 $\\|r(u^{(k)})\\|_{2} \\le \\rho$ 时评估 $p_{k}$，其中 $\\rho  0$ 为预设阈值。\n\n对于序列中的每个载荷步，确定活动集标签最后一次变化的迭代索引；然后，仅使用该索引之后的迭代，要求最后两个计算出的观测阶 $p_{k}$ 均大于或等于 $1.8$，以宣告该载荷步达到了持续的二次收敛。如果牛顿法在某个载荷步中最多两次迭代即收敛，则默认宣告该步骤达到了持续的二次收敛。\n\n实现该算法并将其应用于以下测试套件。所有力必须以牛顿 (N) 表示，刚度以牛顿/米 (N/m) 表示，位移以米 (m) 表示，角度以弧度表示。\n\n所有测试的通用参数：\n- $k_{s} = 10 \\,\\text{N/m}$,\n- $k_{t} = 100 \\,\\text{N/m}$,\n- $\\tau = 1 \\,\\text{N}$,\n- 牛顿法容差 $\\varepsilon = 10^{-12} \\,\\text{N}$,\n- 渐近阈值 $\\rho = 10^{-6} \\,\\text{N}$,\n- 每个载荷步的最大迭代次数为 $50$。\n\n测试案例：\n\n- 案例1（沿直线发生的粘滞-滑移-粘滞-滑移）：沿 $x$ 轴施加的四个载荷序列 $F \\in \\mathbb{R}^{2}$，\n  1. $F = (0.5, 0.0)$,\n  2. $F = (1.2, 0.0)$,\n  3. $F = (0.8, 0.0)$,\n  4. $F = (1.5, 0.0)$,\n  顺序施加，使用上一步的收敛位移作为下一步的初始猜测值。\n\n- 案例2（持续滑移下的方向旋转）：大小为 $2.0 \\,\\text{N}$、角度分别为 $0$、$\\pi/4$ 和 $\\pi/2$ 弧度的三个载荷序列，\n  1. $F = 2.0 \\,(\\cos(0), \\sin(0))$,\n  2. $F = 2.0 \\,(\\cos(\\pi/4), \\sin(\\pi/4))$,\n  3. $F = 2.0 \\,(\\cos(\\pi/2), \\sin(\\pi/2))$,\n  顺序施加，使用上一步的收敛位移作为下一步的初始猜测值。\n\n- 案例3（近阈值切换）：沿 $x$ 轴施加的四个接近粘滞-滑移阈值的载荷序列，\n  1. $F = (1.08, 0.0)$,\n  2. $F = (1.12, 0.0)$,\n  3. $F = (1.09, 0.0)$,\n  4. $F = (1.11, 0.0)$,\n  顺序施加，使用上一步的收敛位移作为下一步的初始猜测值。\n\n对于每个案例，返回一个布尔值，指示该案例中的每个载荷步是否都观察到了上述精确定义的持续二次收敛。你的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表（例如，“[true,false,true]”，但使用你语言的布尔字面量）。角度必须以弧度解释，所有物理单位必须如上所述被遵守。每个案例的最终输出必须是布尔值。",
            "solution": "用户提供了一个关于带有库仑摩擦的单节点接触模型的计算固体力学适定问题。任务是为活动集牛顿法推导一致的雅可比矩阵，实现求解器，并在一个测试套件上验证其二次收敛特性。\n\n### 问题验证\n所提供的问题是计算力学中摩擦接触的一个标准（尽管简化了）的表示。\n\n- **已知条件**：\n    - 控制方程：$K u + t(u) = F$\n    - 结构刚度：$K = k_{s} I$，其中 $I \\in \\mathbb{R}^{2 \\times 2}$ 是单位矩阵。\n    - 摩擦牵引力 $t(u)$:\n        - 试探牵引力: $t_{\\mathrm{tr}}(u) = k_{t}\\,u$.\n        - 粘滞: 如果 $\\|t_{\\mathrm{tr}}(u)\\| \\le \\tau$，则 $t(u) = t_{\\mathrm{tr}}(u)$。\n        - 滑移: 如果 $\\|t_{\\mathrm{tr}}(u)\\|  \\tau$，则 $t(u) = \\tau \\frac{u}{\\|u\\|}$。\n    - 牛顿法：\n        - 残差: $r(u) = K u + t(u) - F$。\n        - 雅可比矩阵: $J(u) = \\frac{\\partial r(u)}{\\partial u}$。\n        - 更新: 求解 $J(u^{(k)})\\,\\Delta u^{(k)} = -r(u^{(k)})$ 得到 $\\Delta u^{(k)}$，然后 $u^{(k+1)} = u^{(k)} + \\Delta u^{(k)}$。\n    - 收敛准则：\n        - 终止条件: $\\|r(u^{(k)})\\|_{2} \\le \\varepsilon$。\n        - 观测阶: $p_{k} = \\frac{\\ln\\left(\\|r(u^{(k+1)})\\|_{2}/\\|r(u^{(k)})\\|_{2}\\right)}{\\ln\\left(\\|r(u^{(k)})\\|_{2}/\\|r(u^{(k-1)})\\|_{2}\\right)}$。\n        - 二次收敛检查: 对于每个载荷步，如果在最后一次活动集改变之后且 $\\|r(u^{(k)})\\|_{2} \\le \\rho$ 的条件下，最后两个有效的计算收敛阶 $p_k$ 均 $\\ge 1.8$，或者如果求解器在 $\\le 2$ 次迭代内收敛，则宣告达到持续二次收敛。\n    - 参数：$k_{s} = 10 \\,\\text{N/m}$，$k_{t} = 100 \\,\\text{N/m}$，$\\tau = 1 \\,\\text{N}$，$\\varepsilon = 10^{-12} \\,\\text{N}$，$\\rho = 10^{-6} \\,\\text{N}$，最大迭代次数 $50$。\n    - 测试案例：三组施加载荷 $F$ 的序列。\n\n- **验证结论**：该问题是有效的。它在科学上基于接触力学的既定原则，数学上适定，客观且自包含。所有必要的方程、参数和标准都已明确提供。该任务需要严谨的推导和仔细的实现，这是该领域的标准练习。\n\n### 第1部分：一致雅可比矩阵的推导\n\n求解非线性系统 $r(u) = 0$ 的牛顿法需要雅可比矩阵 $J(u)$，它是残差 $r(u)$ 相对于位移向量 $u$ 的导数。\n$$\nr(u) = k_s u + t(u) - F\n$$\n残差的导数是：\n$$\nJ(u) = \\frac{\\partial r(u)}{\\partial u} = \\frac{\\partial}{\\partial u} (k_s u + t(u) - F) = k_s \\frac{\\partial u}{\\partial u} + \\frac{\\partial t(u)}{\\partial u} - \\frac{\\partial F}{\\partial u}\n$$\n由于 $F$ 是外部施加的载荷，它与 $u$ 无关，因此 $\\frac{\\partial F}{\\partial u} = 0$。项 $\\frac{\\partial u}{\\partial u}$ 是单位矩阵 $I \\in \\mathbb{R}^{2 \\times 2}$。结构刚度为 $K=k_s I$。因此，雅可比矩阵简化为：\n$$\nJ(u) = K + \\frac{\\partial t(u)}{\\partial u}\n$$\n关键部分是推导牵引力导数 $\\frac{\\partial t(u)}{\\partial u}$，它取决于位移 $u$ 处的活动集（粘滞或滑移）。\n\n**1. 粘滞集推导**\n- **条件**：粘滞条件是 $\\|t_{\\mathrm{tr}}(u)\\| \\le \\tau$，使用 $t_{\\mathrm{tr}}(u) = k_t u$ 的定义，简化为 $k_t \\|u\\| \\le \\tau$。\n- **牵引力**：在粘滞集中，牵引力与位移呈线性关系：\n$$\nt(u) = k_t u\n$$\n- **雅可比矩阵**：这个线性函数的导数是一个常数张量：\n$$\n\\frac{\\partial t(u)}{\\partial u} = \\frac{\\partial}{\\partial u} (k_t u) = k_t I\n$$\n将此代入 $J(u)$ 的一般表达式，粘滞集的一致雅可比矩阵为：\n$$\nJ_{\\mathrm{stick}}(u) = K + k_t I = k_s I + k_t I = (k_s + k_t)I\n$$\n这是一个简单的对角矩阵，代表结构弹簧和接触罚弹簧的组合刚度。\n\n**2. 滑移集推导**\n- **条件**：滑移条件是 $\\|t_{\\mathrm{tr}}(u)\\|  \\tau$，简化为 $k_t \\|u\\|  \\tau$。在此状态下，$\\|u\\|$ 不能为零。\n- **牵引力**：在滑移集中，牵引力向量的大小恒为 $\\tau$，方向与滑移方向相反。此处，它与位移 $u$ 对齐：\n$$\nt(u) = \\tau \\frac{u}{\\|u\\|} = \\tau \\hat{n}(u)\n$$\n其中 $\\hat{n}(u) = u/\\|u\\|$ 是归一化的位移向量。\n- **雅可比矩阵**：我们必须对 $t(u)$ 求关于 $u \\in \\mathbb{R}^2$ 的导数。这需要使用链式法则。归一化向量 $\\hat{n}(u)$ 的导数是张量微积分中的一个已知结果：\n$$\n\\frac{\\partial \\hat{n}(u)}{\\partial u} = \\frac{\\partial}{\\partial u} \\left( \\frac{u}{\\|u\\|} \\right) = \\frac{1}{\\|u\\|} \\left( I - \\frac{u \\otimes u}{\\|u\\|^2} \\right)\n$$\n其中 $\\otimes$ 表示外积。项 $(I - \\hat{n} \\otimes \\hat{n})$ 是一个投影算子，它投影到与 $\\hat{n}$ 正交的空间上。\n利用这个结果，滑移牵引力的导数为：\n$$\n\\frac{\\partial t(u)}{\\partial u} = \\tau \\frac{\\partial \\hat{n}(u)}{\\partial u} = \\frac{\\tau}{\\|u\\|} \\left( I - \\frac{u \\otimes u}{\\|u\\|^2} \\right)\n$$\n将此代入 $J(u)$ 的一般表达式，滑移集的一致雅可比矩阵为：\n$$\nJ_{\\mathrm{slip}}(u) = K + \\frac{\\tau}{\\|u\\|} \\left( I - \\frac{u \\otimes u}{\\|u\\|^2} \\right) = k_s I + \\frac{\\tau}{\\|u\\|}I - \\frac{\\tau}{\\|u\\|^3}(u \\otimes u)\n$$\n这个雅可比矩阵在径向方向上是秩亏的（它有一个对应于特征向量 $u$ 的零特征值），这反映了在滑移状态下，沿 $u$ 方向运动的阻力仅由结构刚度 $k_s$ 决定，而与 $u$ 正交方向的运动阻力则涉及 $k_s$ 和一个几何刚度项 $\\tau/\\|u\\|$。\n\n### 第2部分：算法设计与收敛性\n\n牛顿法采用活动集策略实现。在给定一个位移猜测值 $u^{(k)}$ 的每次迭代 $k$ 中：\n1.  计算试探牵引力 $t_{\\mathrm{tr}}(u^{(k)}) = k_t u^{(k)}$。\n2.  通过比较 $\\|t_{\\mathrm{tr}}(u^{(k)})\\|$ 与 $\\tau$ 来确定活动集。\n3.  根据活动集（‘粘滞’或‘滑移’），从上述推导中选择牵引力 $t(u^{(k)})$ 和雅可比矩阵 $J(u^{(k)})$ 的相应表达式。\n4.  计算残差 $r(u^{(k)}) = k_s u^{(k)} + t(u^{(k)}) - F$。\n5.  求解线性系统 $J(u^{(k)}) \\Delta u^{(k)} = -r(u^{(k)})$ 以获得位移增量 $\\Delta u^{(k)}$。\n6.  更新位移：$u^{(k+1)} = u^{(k)} + \\Delta u^{(k)}$。\n7.  重复此过程，直到残差范数 $\\|r(u^{(k+1)})\\|_2$ 小于容差 $\\varepsilon$。\n\n这个过程使用*一致线性化*，因为雅可比矩阵 $J(u^{(k)})$ 是在第 $k$ 次迭代时为所选特定活动集分支的残差函数 $r(u)$ 的精确导数。一旦迭代收敛到活动集不再改变的点，该方法就如同一个用于光滑非线性系统的标准 Newton-Raphson 求解器，已知其表现出二次收敛性。\n\n收敛性的定量验证按规定执行。在一个载荷步收敛后，分析残差范数和活动集的历史记录。“持续二次收敛”标准要求最后两个计算出的渐近收敛阶 $p_k$ 均 $\\ge 1.8$，这是一个严格的检查，用以确认该方法在解决了因活动集切换引起的任何初始非光滑性之后，确实达到了理论上预期的性能。",
            "answer": "```python\nimport numpy as np\nimport math\n\ndef solve():\n    \"\"\"\n    Solves the contact mechanics problem and verifies convergence.\n    \"\"\"\n\n    # Common parameters\n    ks = 10.0  # N/m\n    kt = 100.0 # N/m\n    tau = 1.0  # N\n    eps = 1e-12 # N\n    rho = 1e-6  # N\n    max_iter = 50\n\n    # Test cases\n    test_cases_loads = [\n        # Case 1: stick-slip-stick-slip along a straight line\n        [\n            np.array([0.5, 0.0]),\n            np.array([1.2, 0.0]),\n            np.array([0.8, 0.0]),\n            np.array([1.5, 0.0]),\n        ],\n        # Case 2: directional rotation under persistent slip\n        [\n            2.0 * np.array([math.cos(0.0), math.sin(0.0)]),\n            2.0 * np.array([math.cos(math.pi / 4.0), math.sin(math.pi / 4.0)]),\n            2.0 * np.array([math.cos(math.pi / 2.0), math.sin(math.pi / 2.0)]),\n        ],\n        # Case 3: near-threshold toggling\n        [\n            np.array([1.08, 0.0]),\n            np.array([1.12, 0.0]),\n            np.array([1.09, 0.0]),\n            np.array([1.11, 0.0]),\n        ],\n    ]\n\n    overall_results = []\n\n    for case_loads in test_cases_loads:\n        u_initial = np.zeros(2)\n        case_passed = True\n        for F_load in case_loads:\n            u_converged, history = newton_solver(F_load, u_initial, ks, kt, tau, eps, max_iter)\n            \n            load_step_passed = analyze_convergence(history['residual_norms'], history['active_sets'], rho)\n\n            if not load_step_passed:\n                case_passed = False\n                break\n            \n            u_initial = u_converged\n        \n        overall_results.append(case_passed)\n\n    print(f\"[{','.join(map(str, overall_results))}]\".lower())\n\ndef newton_solver(F, u_initial, ks, kt, tau, eps, max_iter):\n    \"\"\"\n    Performs the active-set Newton method for a single load step.\n    \"\"\"\n    u = np.copy(u_initial)\n    I = np.identity(2)\n    K = ks * I\n\n    history = {'residual_norms': [], 'active_sets': []}\n    \n    for k in range(max_iter + 1):\n        # Determine active set and compute traction t and its derivative dt_du\n        t_tr = kt * u\n        norm_t_tr = np.linalg.norm(t_tr)\n\n        if norm_t_tr = tau:\n            # Stick state\n            active_set = 'stick'\n            t = t_tr\n            dt_du = kt * I\n        else:\n            # Slip state\n            active_set = 'slip'\n            norm_u = np.linalg.norm(u)\n            # norm_u will not be zero in slip, as kt*||u|| > tau > 0\n            t = tau * u / norm_u\n            \n            u_outer_u = np.outer(u, u)\n            dt_du = (tau / norm_u) * (I - u_outer_u / (norm_u**2))\n            \n        # Compute residual r and Jacobian J\n        r = K @ u + t - F\n        J = K + dt_du\n        \n        norm_r = np.linalg.norm(r)\n        \n        history['residual_norms'].append(norm_r)\n        history['active_sets'].append(active_set)\n        \n        if norm_r = eps:\n            break\n            \n        if k == max_iter:\n            # Failed to converge\n            break\n\n        # Solve for increment and update\n        delta_u = np.linalg.solve(J, -r)\n        u = u + delta_u\n        \n    return u, history\n\ndef analyze_convergence(residual_norms, active_sets, rho):\n    \"\"\"\n    Verifies sustained quadratic convergence for a single load step.\n    \"\"\"\n    num_iterations = len(residual_norms) - 1\n    \n    # Pass by default if converged in = 2 iterations\n    if num_iterations = 2:\n        return True\n\n    # Find the index of the last iteration where the active set changed\n    last_change_idx = 0\n    for i in range(1, len(active_sets)):\n        if active_sets[i] != active_sets[i-1]:\n            last_change_idx = i\n\n    valid_p_orders = []\n    # k is the index into the residual_norms list, corresponding to u^(k)\n    # We can compute p_k for k from 1 to len-2.\n    # We only consider k > last_change_idx.\n    for k in range(last_change_idx + 1, len(residual_norms) - 1):\n        if k == 0:\n             continue # Cannot compute p_k if k=0\n        \n        norm_rk_m1 = residual_norms[k-1]\n        norm_rk = residual_norms[k]\n        norm_rk_p1 = residual_norms[k+1]\n\n        # Check conditions for computing p_k\n        if norm_rk > rho:\n            continue\n            \n        # Denominators must be defined and norms strictly positive\n        if norm_rk_m1 = 0 or norm_rk = 0:\n            continue\n        \n        # Avoid division by zero if norms are equal\n        if abs(norm_rk - norm_rk_m1)  1e-15:\n            continue\n\n        denominator = np.log(norm_rk / norm_rk_m1)\n        if abs(denominator)  1e-15:\n            continue\n\n        numerator = np.log(norm_rk_p1 / norm_rk)\n        \n        pk = numerator / denominator\n        valid_p_orders.append(pk)\n        \n    # Check if the last two valid computed orders are >= 1.8\n    if len(valid_p_orders) >= 2:\n        if valid_p_orders[-1] >= 1.8 and valid_p_orders[-2] >= 1.8:\n            return True\n    \n    return False\n\nif __name__ == '__main__':\n    solve()\n\n```"
        },
        {
            "introduction": "在罚函数法的基础上，我们现在转向应用广泛的增广拉格朗日方法。本练习要求你为一个接触界面推导一致性切线，其中活动集（active-set）的逻辑取决于法向和切向牵引力的试探值。这次实践将加深你对一致性线性化如何适应不同接触算法的理解，并突显在滑动条件下切线刚度矩阵的非对称性。",
            "id": "2550855",
            "problem": "考虑一个有限元网格中单个积分点上的二维节点对节点摩擦接触界面。设界面处的单位法向量和切向量分别为 $n = (0,1)^{\\top}$ 和 $t = (1,0)^{\\top}$。从节点和主节点之间的相对位移为 $d = u_{s} - u_{m}$，其中 $u_{s} = (u_{s,x}, u_{s,y})^{\\top}$ 且 $u_{m} = (u_{m,x}, u_{m,y})^{\\top}$。定义法向间隙和切向间隙分别为 $g_{n} = -n^{\\top} d$（侵入时为正）和 $g_{t} = t^{\\top} d$。令 $\\varepsilon_{n}  0$ 和 $\\varepsilon_{t}  0$ 为增广拉格朗日参数，$\\lambda_{n}$、$\\lambda_{t}$ 为当前的拉格朗日乘子，它们在线性化过程中保持不变。定义法向和切向预测值分别为 $y_{n} = \\lambda_{n} + \\varepsilon_{n} g_{n}$ 和 $y_{t} = \\lambda_{t} + \\varepsilon_{t} g_{t}$。法向压应力大小为 $t_{n} = \\langle y_{n} \\rangle_{+} = \\max(0, y_{n})$。对于库仑摩擦系数 $\\mu  0$，摩擦界限为 $b = \\mu t_{n}$，切向应力由投影（限制）给出 $\\tau = \\operatorname{clamp}(y_{t}, -b, b)$。作用于从节点侧的界面应力向量为 $ \\mathbf{t} = t_{n} \\boldsymbol{n} + \\tau \\boldsymbol{t}$，对从节点的残差贡献为 $r_{s} = -\\mathbf{t}$。\n\n从以上定义和由单边接触及库仑摩擦所蕴含的互补结构出发，推导适用于 Newton 方法的一致线性化 $\\partial r_{s} / \\partial u$。您的推导必须明确说明激活集对试探状态的依赖性，即：(i) 由 $y_{n}$ 的符号决定的张开与闭合接触，以及 (ii) 通过比较 $|y_{t}|$ 与 $b = \\mu t_{n}$ 决定的粘着与滑移。清晰地陈述在每个激活集分支中关于 $u$ 的方向导数的表达式。\n\n然后，对于以下特定数据\n$\\varepsilon_{n} = 2.5 \\times 10^{6}$，$\\varepsilon_{t} = 1.0 \\times 10^{6}$，$\\mu = 0.3$，$\\lambda_{n} = 150$，$\\lambda_{t} = 50$，$u_{s} = (4.0 \\times 10^{-4}, -3.0 \\times 10^{-4})^{\\top}$，以及 $u_{m} = (5.0 \\times 10^{-5}, -1.0 \\times 10^{-4})^{\\top}$，计算此试探状态下的标量雅可比项 $\\partial r_{s,y} / \\partial u_{s,y}$。将您的答案四舍五入至四位有效数字，并以 $\\mathrm{N/m}$ 为单位表示。",
            "solution": "该问题陈述具有科学依据，提法恰当且完整。它描述了一种用于摩擦接触的标准增广拉格朗日列式，这是计算力学中一种常用且有效的方法。我现在将进行推导和评估。\n\n目标是计算从节点残差 $r_s$ 相对于节点位移 $u$ 的一致线性化。残差由 $r_s = -\\mathbf{t}$ 给出，其中 $\\mathbf{t} = t_n n + \\tau t$。我们感兴趣的是雅可比矩阵，其分量是 $r_s$ 的方向导数。总位移向量为 $u = (u_s^\\top, u_m^\\top)^\\top$。所有量都依赖于相对位移 $d = u_s - u_m$。根据链式法则，显然有 $\\frac{\\partial r_s}{\\partial u_m} = \\frac{\\partial r_s}{\\partial d} \\frac{\\partial d}{\\partial u_m} = \\frac{\\partial r_s}{\\partial d} (-I) = -\\frac{\\partial r_s}{\\partial u_s}$。因此，我们只需要推导雅可比块 $K_{ss} = \\frac{\\partial r_s}{\\partial u_s}$。\n\n$r_s$ 关于 $u_s$ 沿方向 $\\Delta u_s$ 变化的的方向导数为：\n$$\nD_{u_s}r_s[\\Delta u_s] = -D_{u_s}\\mathbf{t}[\\Delta u_s] = -\\left( (D_{u_s}t_n[\\Delta u_s]) n + (D_{u_s}\\tau[\\Delta u_s]) t \\right)\n$$\n我们必须求出法向应力 $t_n$ 和切向应力 $\\tau$ 的方向导数。这些导数取决于试探状态，而试探状态由预测值 $y_n$ 和 $y_t$ 决定。\n\n首先，我们确定运动学量和预测值的变分。\n法向间隙 $g_n$ 和切向间隙 $g_t$ 关于变分 $\\Delta u_s$ 的变分为：\n$$\n\\Delta g_n = D_{u_s}g_n[\\Delta u_s] = D_{u_s}(-n^\\top (u_s - u_m))[\\Delta u_s] = -n^\\top \\Delta u_s\n$$\n$$\n\\Delta g_t = D_{u_s}g_t[\\Delta u_s] = D_{u_s}(t^\\top (u_s - u_m))[\\Delta u_s] = t^\\top \\Delta u_s\n$$\n拉格朗日乘子 $\\lambda_n$ 和 $\\lambda_t$ 保持不变。因此，预测值 $y_n$ 和 $y_t$ 的变分为：\n$$\n\\Delta y_n = \\varepsilon_n \\Delta g_n = -\\varepsilon_n n^\\top \\Delta u_s\n$$\n$$\n\\Delta y_t = \\varepsilon_t \\Delta g_t = \\varepsilon_t t^\\top \\Delta u_s\n$$\n$t_n$ 和 $\\tau$ 的导数非光滑，且依赖于激活集。我们分情况进行分析。\n\n情况1：张开接触 ($y_n \\leq 0$)\n在此状态下，$t_n = \\langle y_n \\rangle_+ = 0$。摩擦界限为 $b = \\mu t_n = 0$。切向应力为 $\\tau = \\operatorname{clamp}(y_t, -b, b) = 0$。总应力为 $\\mathbf{t} = 0$，因此残差 $r_s = 0$。结果，切线刚度为零矩阵：\n$$\nK_{ss} = \\frac{\\partial r_s}{\\partial u_s} = 0\n$$\n\n情况2：闭合接触 ($y_n  0$)\n此时，$t_n = y_n$。方向导数为：\n$$\nD_{u_s}t_n[\\Delta u_s] = \\Delta y_n = -\\varepsilon_n n^\\top \\Delta u_s \\implies \\frac{\\partial t_n}{\\partial u_s} = -\\varepsilon_n n^\\top\n$$\n摩擦界限 $b = \\mu t_n$ 的变分为：\n$$\n\\Delta b = \\mu \\Delta t_n = -\\mu \\varepsilon_n n^\\top \\Delta u_s\n$$\n切向应力 $\\tau = \\operatorname{clamp}(y_t, -b, b)$ 的导数取决于粘着/滑移状态。\n\n子情况2a：粘着 ($|y_t|  b$)\n在粘着状态下，$\\tau = y_t$。方向导数为：\n$$\nD_{u_s}\\tau[\\Delta u_s] = \\Delta y_t = \\varepsilon_t t^\\top \\Delta u_s \\implies \\frac{\\partial \\tau}{\\partial u_s} = \\varepsilon_t t^\\top\n$$\n代入残差变分的表达式中：\n$$\nD_{u_s}r_s[\\Delta u_s] = -\\left( (-\\varepsilon_n n^\\top \\Delta u_s) n + (\\varepsilon_t t^\\top \\Delta u_s) t \\right) = \\left( \\varepsilon_n n n^\\top + \\varepsilon_t t t^\\top \\right) \\Delta u_s\n$$\n切线刚度矩阵是对称的：\n$$\nK_{ss} = \\varepsilon_n n n^\\top + \\varepsilon_t t t^\\top\n$$\n\n子情况2b：正向滑移 ($y_t \\geq b$)\n在正向滑移中，$\\tau = b = \\mu t_n$。方向导数为：\n$$\nD_{u_s}\\tau[\\Delta u_s] = \\Delta b = -\\mu \\varepsilon_n n^\\top \\Delta u_s \\implies \\frac{\\partial \\tau}{\\partial u_s} = -\\mu \\varepsilon_n n^\\top\n$$\n残差变分为：\n$$\nD_{u_s}r_s[\\Delta u_s] = -\\left( (-\\varepsilon_n n^\\top \\Delta u_s) n + (-\\mu \\varepsilon_n n^\\top \\Delta u_s) t \\right) = \\left( \\varepsilon_n n n^\\top + \\mu \\varepsilon_n t n^\\top \\right) \\Delta u_s\n$$\n切线刚度矩阵是非对称的：\n$$\nK_{ss} = \\varepsilon_n (n n^\\top + \\mu t n^\\top) = \\varepsilon_n(n + \\mu t)n^\\top\n$$\n\n子情况2c：反向滑移 ($y_t \\leq -b$)\n在反向滑移中，$\\tau = -b = -\\mu t_n$。方向导数为：\n$$\nD_{u_s}\\tau[\\Delta u_s] = -\\Delta b = -(-\\mu \\varepsilon_n n^\\top \\Delta u_s) = \\mu \\varepsilon_n n^\\top \\Delta u_s \\implies \\frac{\\partial \\tau}{\\partial u_s} = \\mu \\varepsilon_n n^\\top\n$$\n残差变分为：\n$$\nD_{u_s}r_s[\\Delta u_s] = -\\left( (-\\varepsilon_n n^\\top \\Delta u_s) n + (\\mu \\varepsilon_n n^\\top \\Delta u_s) t \\right) = \\left( \\varepsilon_n n n^\\top - \\mu \\varepsilon_n t n^\\top \\right) \\Delta u_s\n$$\n切线刚度矩阵也是非对称的：\n$$\nK_{ss} = \\varepsilon_n (n n^\\top - \\mu t n^\\top) = \\varepsilon_n(n - \\mu t)n^\\top\n$$\n\n现在，我们用给定的数据评估这个具体案例。\n给定：$\\varepsilon_{n} = 2.5 \\times 10^{6}$，$\\varepsilon_{t} = 1.0 \\times 10^{6}$，$\\mu = 0.3$，$\\lambda_{n} = 150$，$\\lambda_{t} = 50$。\n从节点位移 $u_{s} = (4.0 \\times 10^{-4}, -3.0 \\times 10^{-4})^{\\top}$。\n主节点位移 $u_{m} = (5.0 \\times 10^{-5}, -1.0 \\times 10^{-4})^{\\top}$。\n向量 $n = (0,1)^{\\top}$，$t = (1,0)^{\\top}$。\n\n1.  计算相对位移 $d$：\n    $$\n    d = u_s - u_m = \\begin{pmatrix} 4.0 \\times 10^{-4} - 5.0 \\times 10^{-5} \\\\ -3.0 \\times 10^{-4} - (-1.0 \\times 10^{-4}) \\end{pmatrix} = \\begin{pmatrix} 3.5 \\times 10^{-4} \\\\ -2.0 \\times 10^{-4} \\end{pmatrix}\n    $$\n2.  计算间隙 $g_n$ 和 $g_t$：\n    $$\n    g_n = -n^\\top d = - \\begin{pmatrix} 0  1 \\end{pmatrix} \\begin{pmatrix} 3.5 \\times 10^{-4} \\\\ -2.0 \\times 10^{-4} \\end{pmatrix} = 2.0 \\times 10^{-4}\n    $$\n    $$\n    g_t = t^\\top d = \\begin{pmatrix} 1  0 \\end{pmatrix} \\begin{pmatrix} 3.5 \\times 10^{-4} \\\\ -2.0 \\times 10^{-4} \\end{pmatrix} = 3.5 \\times 10^{-4}\n    $$\n3.  计算预测值 $y_n$ 和 $y_t$：\n    $$\n    y_n = \\lambda_n + \\varepsilon_n g_n = 150 + (2.5 \\times 10^6)(2.0 \\times 10^{-4}) = 150 + 500 = 650\n    $$\n    $$\n    y_t = \\lambda_t + \\varepsilon_t g_t = 50 + (1.0 \\times 10^6)(3.5 \\times 10^{-4}) = 50 + 350 = 400\n    $$\n4.  确定接触和摩擦状态：\n    -   接触状态：由于 $y_n = 650  0$，接触是闭合的。\n    -   法向应力：$t_n = \\langle y_n \\rangle_+ = 650$。\n    -   摩擦界限：$b = \\mu t_n = 0.3 \\times 650 = 195$。\n    -   摩擦状态：由于 $y_t = 400  b = 195$，状态为**正向滑移**。\n\n5.  选择相应的切线刚度矩阵 $K_{ss}$：\n    对于正向滑移，$K_{ss} = \\varepsilon_n(n + \\mu t)n^\\top$。我们使用给定的向量展开此式：\n    $$\n    K_{ss} = (2.5 \\times 10^{6}) \\left( \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} + 0.3 \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} \\right) \\begin{pmatrix} 0  1 \\end{pmatrix} = (2.5 \\times 10^{6}) \\begin{pmatrix} 0.3 \\\\ 1 \\end{pmatrix} \\begin{pmatrix} 0  1 \\end{pmatrix}\n    $$\n    $$\n    K_{ss} = (2.5 \\times 10^{6}) \\begin{pmatrix} 0  0.3 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} 0  0.75 \\times 10^{6} \\\\ 0  2.5 \\times 10^{6} \\end{pmatrix}\n    $$\n    矩阵 $K_{ss}$ 的分量为：\n    $$\n    K_{ss} = \\begin{pmatrix} \\frac{\\partial r_{s,x}}{\\partial u_{s,x}}  \\frac{\\partial r_{s,x}}{\\partial u_{s,y}} \\\\ \\frac{\\partial r_{s,y}}{\\partial u_{s,x}}  \\frac{\\partial r_{s,y}}{\\partial u_{s,y}} \\end{pmatrix}\n    $$\n    所求的标量雅可比项是该矩阵的 $(2,2)$ 分量：\n    $$\n    \\frac{\\partial r_{s,y}}{\\partial u_{s,y}} = 2.5 \\times 10^{6}\n    $$\n    四舍五入到四位有效数字，得到 $2.500 \\times 10^{6}$。隐含单位是 $\\mathrm{N/m}$。",
            "answer": "$$\\boxed{2.500 \\times 10^{6}}$$"
        },
        {
            "introduction": "真实世界的模拟通常涉及变形体之间的接触，而不仅仅是节点与刚性表面。本次实践通过考虑一个段-段（segment-to-segment）接触单元来提升复杂性，其中接触坐标系本身会随着变形而旋转。你将执行一个考虑了这些运动学变化的一致性线性化，从而揭示“几何刚度”或“压力载荷”项的来源，这是大变形接触分析中确保稳定性的一个关键组成部分。",
            "id": "3584746",
            "problem": "在有限元法（FEM）的背景下，考虑一个二维的段-段接触离散化，其中法向和切向约束采用罚函数法实施，并包含经典的 Coulomb 摩擦。一个带有节点 $A$ 和 $B$ 的直线主段，其初始坐标分别为 $(-L/2,0)$ 和 $(+L/2,0)$，并且在参考构型中，一个单个从属粒子 $S$ 位于 $(0,-\\delta)$。接触积分点固定在主段的中点（因此在该积分点上主单元形函数的值为 $N_{A}=N_{B}=1/2$），分段标架 $\\{\\boldsymbol{t},\\boldsymbol{n}\\}$ 由变形后的段定义，其中 $\\boldsymbol{t}$ 是单位切向量，$\\boldsymbol{n}$ 是单位外法向量，两者都从当前构型进行协同旋转更新。\n\n假设为小应变、小转动运动学。主段的旋转由小角度 $\\phi=(u_{y}^{B}-u_{y}^{A})/L$ 参数化，因此，在未变形的水平构型下，标架的一阶变分满足\n$$\n\\frac{\\partial \\boldsymbol{t}}{\\partial \\phi}=\\begin{bmatrix}0\\\\1\\end{bmatrix},\\qquad \\frac{\\partial \\boldsymbol{n}}{\\partial \\phi}=\\begin{bmatrix}-1\\\\0\\end{bmatrix},\n$$\n因此\n$$\n\\frac{\\partial \\boldsymbol{t}}{\\partial u_{y}^{B}}=\\frac{1}{L}\\begin{bmatrix}0\\\\1\\end{bmatrix},\\qquad \\frac{\\partial \\boldsymbol{n}}{\\partial u_{y}^{B}}=\\frac{1}{L}\\begin{bmatrix}-1\\\\0\\end{bmatrix},\n$$\n在 $u_{y}^{A}=u_{y}^{B}=0$ 处取值。\n\n设法向响应的罚参数为 $k_{n}$，切向（粘滞）响应的罚参数为 $k_{t}$。设 Coulomb 摩擦系数为 $\\mu$，滑动方向标量为 $s=+1$（即，当摩擦激活时，摩擦牵引力与正切向滑移方向相反）。将作用于从属粒子的接触牵引力向量定义为\n$$\n\\boldsymbol{f}=-p_{n}\\,\\boldsymbol{n}+t_{t}\\,\\boldsymbol{t},\n$$\n其中，当 $g_{n}  0$ 时，法向压力大小为 $p_{n}=k_{n}(-g_{n})$，法向间隙为 $g_{n}=(\\boldsymbol{x}_{s}-\\boldsymbol{x}_{m})\\cdot \\boldsymbol{n}$；切向牵引力大小 $t_{t}$ 在粘滞状态下由粘滞定律 $t_{t}=k_{t}\\,g_{t}$ 给出，其中切向间隙为 $g_{t}=(\\boldsymbol{x}_{s}-\\boldsymbol{x}_{m})\\cdot \\boldsymbol{t}$，在滑动状态下由滑动定律 $t_{t}=-\\mu\\,p_{n}\\,s$ 给出。取主段中点位置为 $\\boldsymbol{x}_{m}=(\\boldsymbol{x}_{A}+\\boldsymbol{x}_{B})/2$。\n\n在线性化点，设 $u_{y}^{A}=u_{y}^{B}=0$，因此 $\\boldsymbol{t}=[1,0]^{T}$，$\\boldsymbol{n}=[0,1]^{T}$，且从属粒子处于恒定的法向侵入量 $g_{n}=-\\delta  0$（其中 $\\delta0$）和零切向间隙 $g_{t}=0$ 的状态。\n\n关注于将从属粒子上接触力的全局 $x$ 分量的变化，\n$$\nF_{x}=\\boldsymbol{f}\\cdot \\boldsymbol{e}_{x},\n$$\n与主节点 $B$ 垂直位移 $u_{y}^{B}$ 的扰动线性关联的单个标量雅可比项，即\n$$\nK:=\\frac{\\partial F_{x}}{\\partial u_{y}^{B}}。\n$$\n\n1) 从接触虚功原理和上述定义出发，进行一致性线性化以推导 $K$，并显式保留来自 $\\partial \\boldsymbol{t}/\\partial u_{y}^{B}$ 和 $\\partial \\boldsymbol{n}/\\partial u_{y}^{B}$ 的贡献。在同一线性化点，对粘滞区域和滑动区域都进行此操作。您必须将 $g_{n}$ 和 $g_{t}$ 视为相对位置和标架的函数，即 $g_{n}=(\\boldsymbol{x}_{s}-\\boldsymbol{x}_{m})\\cdot \\boldsymbol{n}$ 和 $g_{t}=(\\boldsymbol{x}_{s}-\\boldsymbol{x}_{m})\\cdot \\boldsymbol{t}$，其中接触积分点固定在主段中点。\n\n2) 使用您的符号表达式，计算从粘滞过渡到滑动时切向刚度项的变化量，\n$$\n\\Delta K:=K_{\\text{slip}}-K_{\\text{stick}},\n$$\n使用以下数据：$L=2\\,\\mathrm{m}$，$\\delta=1.0\\times 10^{-3}\\,\\mathrm{m}$，$k_{n}=1.0\\times 10^{6}\\,\\mathrm{N/m}$，$k_{t}=1.0\\times 10^{5}\\,\\mathrm{N/m}$，$\\mu=0.3$，$s=+1$。假设单位厚度，因此力和刚度是每单位平面外厚度的值，并且接触求积权重为1。\n\n将您对 $\\Delta K$ 的最终数值答案以 $\\mathrm{N/m}$ 为单位表示，并将答案四舍五入到四位有效数字。",
            "solution": "该问题要求推导一个段-段接触单元在粘滞和滑动条件下的特定切向刚度矩阵项 $K = \\frac{\\partial F_{x}}{\\partial u_{y}^{B}}$，然后计算该刚度的变化量 $\\Delta K = K_{\\text{slip}} - K_{\\text{stick}}$。\n\n要求导的量是作用于从属粒子上的接触力向量 $\\boldsymbol{f}$ 的 $x$ 分量。力向量定义为 $\\boldsymbol{f} = -p_{n}\\,\\boldsymbol{n}+t_{t}\\,\\boldsymbol{t}$。其 $x$ 分量为 $F_{x} = \\boldsymbol{f} \\cdot \\boldsymbol{e}_{x}$，其中 $\\boldsymbol{e}_{x} = [1, 0]^T$。\n$$\nF_{x} = (-p_{n}\\,\\boldsymbol{n}+t_{t}\\,\\boldsymbol{t}) \\cdot \\boldsymbol{e}_{x} = -p_{n}(\\boldsymbol{n} \\cdot \\boldsymbol{e}_{x}) + t_{t}(\\boldsymbol{t} \\cdot \\boldsymbol{e}_{x})\n$$\n我们记 $n_x = \\boldsymbol{n} \\cdot \\boldsymbol{e}_{x}$ 和 $t_x = \\boldsymbol{t} \\cdot \\boldsymbol{e}_{x}$。所以，$F_{x} = -p_{n} n_x + t_{t} t_x$。\n\n刚度项 $K$ 是 $F_x$ 关于主节点 $B$ 的垂直位移 $u_{y}^{B}$ 的偏导数。应用乘法法则求导得到：\n$$\nK = \\frac{\\partial F_{x}}{\\partial u_{y}^{B}} = -\\frac{\\partial p_{n}}{\\partial u_{y}^{B}} n_x - p_{n} \\frac{\\partial n_x}{\\partial u_{y}^{B}} + \\frac{\\partial t_{t}}{\\partial u_{y}^{B}} t_x + t_{t} \\frac{\\partial t_x}{\\partial u_{y}^{B}}\n$$\n该表达式必须在指定的线性化点（其中 $u_{y}^{A} = u_{y}^{B} = 0$）进行求值。在此点，主段是水平的。\n切向量和法向量为：\n$\\boldsymbol{t} = [1, 0]^T$，所以 $t_x = 1$。\n$\\boldsymbol{n} = [0, 1]^T$，所以 $n_x = 0$。\n\n从属粒子处于法向侵入量 $g_n = -\\delta$（其中 $\\delta > 0$）和零切向间隙 $g_t = 0$ 的状态。\n法向压力大小为 $p_n = k_n(-g_n) = k_n \\delta$。\n在粘滞情况下，切向牵引力为 $t_t = k_t g_t = k_t(0) = 0$。\n在滑动情况下，切向牵引力为 $t_t = -\\mu p_n s = -\\mu (k_n \\delta) s$。\n\n将线性化点处的 $n_x$ 和 $t_x$ 的值代入 $K$ 的表达式中：\n$$\nK = -\\frac{\\partial p_{n}}{\\partial u_{y}^{B}} (0) - p_{n} \\frac{\\partial n_x}{\\partial u_{y}^{B}} + \\frac{\\partial t_{t}}{\\partial u_{y}^{B}} (1) + t_{t} \\frac{\\partial t_x}{\\partial u_{y}^{B}} = -p_{n} \\frac{\\partial n_x}{\\partial u_{y}^{B}} + \\frac{\\partial t_{t}}{\\partial u_{y}^{B}} + t_{t} \\frac{\\partial t_x}{\\partial u_{y}^{B}}\n$$\n我们需要求出标架分量的导数 $\\frac{\\partial n_x}{\\partial u_{y}^{B}}$ 和 $\\frac{\\partial t_x}{\\partial u_{y}^{B}}$。使用给定的标架导数：\n$$\n\\frac{\\partial \\boldsymbol{t}}{\\partial u_{y}^{B}} = \\frac{1}{L}\\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}, \\qquad \\frac{\\partial \\boldsymbol{n}}{\\partial u_{y}^{B}} = \\frac{1}{L}\\begin{bmatrix} -1 \\\\ 0 \\end{bmatrix}\n$$\n各分量的导数为：\n$$\n\\frac{\\partial t_x}{\\partial u_{y}^{B}} = \\frac{\\partial (\\boldsymbol{t} \\cdot \\boldsymbol{e}_x)}{\\partial u_{y}^{B}} = \\frac{\\partial \\boldsymbol{t}}{\\partial u_{y}^{B}} \\cdot \\boldsymbol{e}_x = \\frac{1}{L}\\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix} \\cdot \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix} = 0\n$$\n$$\n\\frac{\\partial n_x}{\\partial u_{y}^{B}} = \\frac{\\partial (\\boldsymbol{n} \\cdot \\boldsymbol{e}_x)}{\\partial u_{y}^{B}} = \\frac{\\partial \\boldsymbol{n}}{\\partial u_{y}^{B}} \\cdot \\boldsymbol{e}_x = \\frac{1}{L}\\begin{bmatrix} -1 \\\\ 0 \\end{bmatrix} \\cdot \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix} = -\\frac{1}{L}\n$$\n将这些代入 $K$ 的表达式中：\n$$\nK = -p_n \\left(-\\frac{1}{L}\\right) + \\frac{\\partial t_t}{\\partial u_{y}^{B}} + t_t(0) = \\frac{p_n}{L} + \\frac{\\partial t_t}{\\partial u_{y}^{B}}\n$$\n代入 $p_n=k_n \\delta$：\n$$\nK = \\frac{k_n \\delta}{L} + \\frac{\\partial t_t}{\\partial u_{y}^{B}}\n$$\n这个通用形式对粘滞和滑动区域都有效。区别在于 $\\frac{\\partial t_t}{\\partial u_{y}^{B}}$ 项。这一项通常被称为“材料”贡献，而 $\\frac{p_n}{L}$ 是对刚度的“几何”或“压力”贡献。\n\n### 1. 粘滞区域 ($K_{\\text{stick}}$)\n在粘滞区域，$t_t = k_t g_t$。我们需要计算其导数：\n$$\n\\frac{\\partial t_t}{\\partial u_{y}^{B}} = k_t \\frac{\\partial g_t}{\\partial u_{y}^{B}}\n$$\n切向间隙为 $g_t = (\\boldsymbol{x}_s - \\boldsymbol{x}_m) \\cdot \\boldsymbol{t}$。其导数为：\n$$\n\\frac{\\partial g_t}{\\partial u_{y}^{B}} = \\frac{\\partial (\\boldsymbol{x}_s - \\boldsymbol{x}_m)}{\\partial u_{y}^{B}} \\cdot \\boldsymbol{t} + (\\boldsymbol{x}_s - \\boldsymbol{x}_m) \\cdot \\frac{\\partial \\boldsymbol{t}}{\\partial u_{y}^{B}}\n$$\n在线性化点，从属粒子位置 $\\boldsymbol{x}_s$ 保持不变，主接触点位置为 $\\boldsymbol{x}_m=\\frac{1}{2}(\\boldsymbol{x}_A+\\boldsymbol{x}_B)$。主点的位移为 $\\boldsymbol{u}_m = \\frac{1}{2}(\\boldsymbol{u}_A+\\boldsymbol{u}_B)$。\n相对位置向量的导数为：\n$$\n\\frac{\\partial (\\boldsymbol{x}_s - \\boldsymbol{x}_m)}{\\partial u_{y}^{B}} = -\\frac{\\partial \\boldsymbol{x}_m}{\\partial u_{y}^{B}} = -\\frac{\\partial \\boldsymbol{u}_m}{\\partial u_{y}^{B}} = -\\frac{1}{2}\\frac{\\partial \\boldsymbol{u}_B}{\\partial u_{y}^{B}} = -\\frac{1}{2}\\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}\n$$\n在线性化点计算 $\\frac{\\partial g_t}{\\partial u_{y}^{B}}$ 的各项：\n第一项：$\\frac{\\partial (\\boldsymbol{x}_s - \\boldsymbol{x}_m)}{\\partial u_{y}^{B}} \\cdot \\boldsymbol{t} = \\left(-\\frac{1}{2}\\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}\\right) \\cdot \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix} = 0$。\n第二项：相对位置向量为 $\\boldsymbol{x}_s - \\boldsymbol{x}_m = [0, -\\delta]^T - [0, 0]^T = [0, -\\delta]^T$。\n$$\n(\\boldsymbol{x}_s - \\boldsymbol{x}_m) \\cdot \\frac{\\partial \\boldsymbol{t}}{\\partial u_{y}^{B}} = \\begin{bmatrix} 0 \\\\ -\\delta \\end{bmatrix} \\cdot \\left(\\frac{1}{L}\\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}\\right) = -\\frac{\\delta}{L}\n$$\n所以，$\\frac{\\partial g_t}{\\partial u_{y}^{B}} = 0 - \\frac{\\delta}{L} = -\\frac{\\delta}{L}$。\n切向牵引力的导数为 $\\frac{\\partial t_t}{\\partial u_{y}^{B}} = k_t \\left(-\\frac{\\delta}{L}\\right) = -\\frac{k_t \\delta}{L}$。\n最后，我们组装粘滞情况下的刚度项：\n$$\nK_{\\text{stick}} = \\frac{k_n \\delta}{L} - \\frac{k_t \\delta}{L} = \\frac{\\delta}{L}(k_n - k_t)\n$$\n\n### 2. 滑动区域 ($K_{\\text{slip}}$)\n在滑动区域，$t_t = -\\mu p_n s$。对 $u_{y}^{B}$ 求导：\n$$\n\\frac{\\partial t_t}{\\partial u_{y}^{B}} = -\\mu s \\frac{\\partial p_n}{\\partial u_{y}^{B}}\n$$\n我们需要求法向压力 $p_n = k_n(-g_n)$ 的导数：\n$$\n\\frac{\\partial p_n}{\\partial u_{y}^{B}} = -k_n \\frac{\\partial g_n}{\\partial u_{y}^{B}}\n$$\n法向间隙为 $g_n = (\\boldsymbol{x}_s - \\boldsymbol{x}_m) \\cdot \\boldsymbol{n}$。其导数为：\n$$\n\\frac{\\partial g_n}{\\partial u_{y}^{B}} = \\frac{\\partial (\\boldsymbol{x}_s - \\boldsymbol{x}_m)}{\\partial u_{y}^{B}} \\cdot \\boldsymbol{n} + (\\boldsymbol{x}_s - \\boldsymbol{x}_m) \\cdot \\frac{\\partial \\boldsymbol{n}}{\\partial u_{y}^{B}}\n$$\n在线性化点计算 $\\frac{\\partial g_n}{\\partial u_{y}^{B}}$ 的各项：\n第一项：$\\frac{\\partial (\\boldsymbol{x}_s - \\boldsymbol{x}_m)}{\\partial u_{y}^{B}} \\cdot \\boldsymbol{n} = \\left(-\\frac{1}{2}\\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}\\right) \\cdot \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix} = -\\frac{1}{2}$。\n第二项：\n$$\n(\\boldsymbol{x}_s - \\boldsymbol{x}_m) \\cdot \\frac{\\partial \\boldsymbol{n}}{\\partial u_{y}^{B}} = \\begin{bmatrix} 0 \\\\ -\\delta \\end{bmatrix} \\cdot \\left(\\frac{1}{L}\\begin{bmatrix} -1 \\\\ 0 \\end{bmatrix}\\right) = 0\n$$\n所以，$\\frac{\\partial g_n}{\\partial u_{y}^{B}} = -\\frac{1}{2} + 0 = -\\frac{1}{2}$。\n法向压力的导数为 $\\frac{\\partial p_n}{\\partial u_{y}^{B}} = -k_n \\left(-\\frac{1}{2}\\right) = \\frac{k_n}{2}$。\n那么，切向牵引力的导数为 $\\frac{\\partial t_t}{\\partial u_{y}^{B}} = -\\mu s \\left(\\frac{k_n}{2}\\right) = -\\frac{\\mu s k_n}{2}$。\n最后，我们组装滑动情况下的刚度项：\n$$\nK_{\\text{slip}} = \\frac{k_n \\delta}{L} - \\frac{\\mu s k_n}{2}\n$$\n\n### 3. 刚度变化量 ($\\Delta K$)\n从粘滞过渡到滑动时，切向刚度项的变化量为：\n$$\n\\Delta K = K_{\\text{slip}} - K_{\\text{stick}} = \\left(\\frac{k_n \\delta}{L} - \\frac{\\mu s k_n}{2}\\right) - \\left(\\frac{k_n \\delta}{L} - \\frac{k_t \\delta}{L}\\right)\n$$\n$$\n\\Delta K = \\frac{k_n \\delta}{L} - \\frac{\\mu s k_n}{2} - \\frac{k_n \\delta}{L} + \\frac{k_t \\delta}{L} = \\frac{k_t \\delta}{L} - \\frac{\\mu s k_n}{2}\n$$\n\n### 4. 数值计算\n我们将给定的数值代入 $\\Delta K$ 的表达式中：\n$L=2\\,\\mathrm{m}$，$\\delta=1.0\\times 10^{-3}\\,\\mathrm{m}$，$k_{n}=1.0\\times 10^{6}\\,\\mathrm{N/m}$，$k_{t}=1.0\\times 10^{5}\\,\\mathrm{N/m}$，$\\mu=0.3$，$s=1$。\n\n第一项：\n$$\n\\frac{k_t \\delta}{L} = \\frac{(1.0 \\times 10^{5}\\,\\mathrm{N/m}) (1.0 \\times 10^{-3}\\,\\mathrm{m})}{2\\,\\mathrm{m}} = \\frac{100}{2}\\,\\mathrm{N/m} = 50\\,\\mathrm{N/m}\n$$\n第二项：\n$$\n\\frac{\\mu s k_n}{2} = \\frac{(0.3)(1)(1.0 \\times 10^{6}\\,\\mathrm{N/m})}{2} = \\frac{3 \\times 10^{5}}{2}\\,\\mathrm{N/m} = 1.5 \\times 10^{5}\\,\\mathrm{N/m} = 150000\\,\\mathrm{N/m}\n$$\n刚度的变化量是：\n$$\n\\Delta K = 50\\,\\mathrm{N/m} - 150000\\,\\mathrm{N/m} = -149950\\,\\mathrm{N/m}\n$$\n将该值四舍五入到四位有效数字：\n$$\n-149950 = -1.4995 \\times 10^5\n$$\n由于其后的数字为5，将第四位有效数字（第二个9）向上进位，我们得到：\n$$\n\\Delta K \\approx -1.500 \\times 10^5\\,\\mathrm{N/m}\n$$",
            "answer": "$$\n\\boxed{-1.500 \\times 10^{5}}\n$$"
        }
    ]
}