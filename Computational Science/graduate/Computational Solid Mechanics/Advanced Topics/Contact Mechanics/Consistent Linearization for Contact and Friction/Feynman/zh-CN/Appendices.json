{
    "hands_on_practices": [
        {
            "introduction": "理论上，一致线性化是实现牛顿法二次收敛的关键，但只有通过实践才能真正体会其威力。本练习旨在通过一个简化的单点摩擦接触问题，将理论与实际联系起来。你将亲自推导粘滞（stick）和滑移（slip）状态下的一致雅可比矩阵，并编写一个牛顿求解器来直接验证二次收敛率，从而深刻理解一致线性化在提升计算效率方面的重要作用。",
            "id": "3555393",
            "problem": "考虑一个准静态、平面、单节点的切向接触问题，该问题涉及一个可变形体与一个具有库仑摩擦的刚性基础之间的接触。可变形体被建模为一个刚度为 $k_{s} > 0$ 的线性弹性切向弹簧，该弹簧连接到一个在平面内受约束的点质量；接触界面则被建模为一个切向罚刚度为 $k_{t} > 0$ 且库仑摩擦极限为 $\\tau = \\mu p > 0$ 的模型，其中 $\\mu$ 是摩擦系数， $p$ 是（恒定的）接触压力。设未知切向位移为向量 $u \\in \\mathbb{R}^{2}$，外部施加的载荷为 $F \\in \\mathbb{R}^{2}$。\n\n节点处的控制平衡方程是力的平衡\n$$\nK u + t(u) = F,\n$$\n其中 $K = k_{s} I$ 是结构刚度，$I \\in \\mathbb{R}^{2 \\times 2}$ 是单位矩阵，$t(u) \\in \\mathbb{R}^{2}$ 是由界面提供的摩擦牵引力。带有切向罚函数的库仑摩擦模型用于模拟粘着状态，其活动集表征定义如下：\n\n- 定义试探牵引力\n$$\nt_{\\mathrm{tr}}(u) = k_{t}\\,u.\n$$\n\n- 粘着集：若 $\\|t_{\\mathrm{tr}}(u)\\| \\le \\tau$，则状态为粘着，牵引力为\n$$\nt(u) = t_{\\mathrm{tr}}(u).\n$$\n\n- 滑移集：若 $\\|t_{\\mathrm{tr}}(u)\\| > \\tau$，则状态为滑移，牵引力被径向返回到库仑盘上，\n$$\nt(u) = \\tau \\,\\frac{t_{\\mathrm{tr}}(u)}{\\|t_{\\mathrm{tr}}(u)\\|} = \\tau \\,\\frac{u}{\\|u\\|}.\n$$\n\n你的任务是为在每次迭代中进行活动集更新的整体牛顿法推导残差的完全一致线性化。具体来说：\n\n1. 仅从上述平衡方程、粘着/滑移定义和微积分法则出发，推导牛顿残差\n$$\nr(u) = K u + t(u) - F,\n$$\n和一致雅可比矩阵\n$$\nJ(u) = \\frac{\\partial r(u)}{\\partial u} = K + \\frac{\\partial t(u)}{\\partial u},\n$$\n用于粘着集和滑移集。你的推导必须展示活动集更新如何进入算法，以及一旦活动集被确定，线性化为何保持一致。\n\n2. 实现一个求解非线性系统 $r(u) = 0$ 的牛顿求解器，在每次迭代中根据上述粘着/滑移准则进行活动集更新，并使用为当前活动集推导的一致雅可比矩阵。在每次迭代 $k$ 中，计算残差范数 $\\|r(u^{(k)})\\|_{2}$，通过求解\n$$\nJ(u^{(k)})\\,\\Delta u^{(k)} = -r(u^{(k)}), \\quad u^{(k+1)} = u^{(k)} + \\Delta u^{(k)},\n$$\n来更新 $u^{(k+1)}$，并记录活动集标签（粘着或滑移）。当对于给定的容差 $\\varepsilon > 0$，满足 $\\|r(u^{(k)})\\|_{2} \\le \\varepsilon$ 时终止。\n\n3. 通过重复的粘着-滑移转换来定量验证持续的二次收敛性，方法是检查每个载荷步迭代序列末端的观测收敛阶。使用残差范数定义局部观测阶为\n$$\np_{k} = \\frac{\\ln\\left(\\dfrac{\\|r(u^{(k+1)})\\|_{2}}{\\|r(u^{(k)})\\|_{2}}\\right)}{\\ln\\left(\\dfrac{\\|r(u^{(k)})\\|_{2}}{\\|r(u^{(k-1)})\\|_{2}}\\right)},\n$$\n只要分母有定义且所有残差范数均为严格正值。为避免前渐近污染，仅在对于给定的阈值 $\\rho > 0$，满足 $\\|r(u^{(k)})\\|_{2} \\le \\rho$ 时才评估 $p_{k}$。\n\n对于序列中的每个载荷步，确定活动集标签最后一次变化的迭代索引；然后，仅使用该索引之后的迭代，要求最后两个计算出的观测阶 $p_{k}$ 均大于或等于 $1.8$，以宣告该载荷步实现了持续的二次收敛。如果牛顿法在某个载荷步中最多两次迭代就收敛，则默认宣告该步骤实现了持续的二次收敛。\n\n实现该算法并将其应用于以下测试套件。所有力必须以牛顿（N）表示，刚度以牛顿每米（N/m）表示，位移以米（m）表示，角度以弧度表示。\n\n所有测试的通用参数：\n- $k_{s} = 10 \\,\\text{N/m}$，\n- $k_{t} = 100 \\,\\text{N/m}$，\n- $\\tau = 1 \\,\\text{N}$，\n- 牛顿法容差 $\\varepsilon = 10^{-12} \\,\\text{N}$，\n- 渐近阈值 $\\rho = 10^{-6} \\,\\text{N}$，\n- 每个载荷步的最大迭代次数 $50$。\n\n测试用例：\n\n- 用例1（沿直线发生粘着-滑移-粘着-滑移）：沿 $x$ 轴施加的一系列四个载荷 $F \\in \\mathbb{R}^{2}$，\n  1. $F = (0.5, 0.0)$,\n  2. $F = (1.2, 0.0)$,\n  3. $F = (0.8, 0.0)$,\n  4. $F = (1.5, 0.0)$,\n  顺序施加，使用上一步的收敛位移作为下一步的初始猜测值。\n\n- 用例2（持续滑移下的方向旋转）：一系列三个大小为 $2.0 \\,\\text{N}$ 的载荷，角度分别为 $0$、$\\pi/4$ 和 $\\pi/2$ 弧度，\n  1. $F = 2.0 \\,(\\cos(0), \\sin(0))$,\n  2. $F = 2.0 \\,(\\cos(\\pi/4), \\sin(\\pi/4))$,\n  3. $F = 2.0 \\,(\\cos(\\pi/2), \\sin(\\pi/2))$,\n  顺序施加，使用上一步的收敛位移作为下一步的初始猜测值。\n\n- 用例3（接近阈值的切换）：沿 $x$ 轴施加的一系列四个接近粘着-滑移阈值的载荷，\n  1. $F = (1.08, 0.0)$,\n  2. $F = (1.12, 0.0)$,\n  3. $F = (1.09, 0.0)$,\n  4. $F = (1.11, 0.0)$,\n  顺序施加，使用上一步的收敛位移作为下一步的初始猜测值。\n\n对于每个用例，返回一个布尔值，指示在该用例的每个载荷步中是否观察到上述精确定义的持续二次收敛。你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，“[true,false,true]”，但使用你语言的布尔文字）。角度必须以弧度解释，并且所有物理单位必须按上述规定遵守。每个用例的最终输出必须是布尔值。",
            "solution": "用户提供了一个在计算固体力学领域中关于带有库仑摩擦的单节点接触模型的适定问题。任务是为活动集牛顿法推导一致雅可比矩阵，实现求解器，并在一组测试用例上验证其二次收敛特性。\n\n### 问题验证\n所提供的问题是计算力学中摩擦接触的一个标准（尽管简化了）的表示。\n\n- **已知条件**：\n    - 控制方程：$K u + t(u) = F$\n    - 结构刚度：$K = k_{s} I$，其中 $I \\in \\mathbb{R}^{2 \\times 2}$ 是单位矩阵。\n    - 摩擦牵引力 $t(u)$：\n        - 试探牵引力：$t_{\\mathrm{tr}}(u) = k_{t}\\,u$。\n        - 粘着：若 $\\|t_{\\mathrm{tr}}(u)\\| \\le \\tau$，则 $t(u) = t_{\\mathrm{tr}}(u)$。\n        - 滑移：若 $\\|t_{\\mathrm{tr}}(u)\\| > \\tau$，则 $t(u) = \\tau \\frac{u}{\\|u\\|}$。\n    - 牛顿法：\n        - 残差：$r(u) = K u + t(u) - F$。\n        - 雅可比矩阵：$J(u) = \\frac{\\partial r(u)}{\\partial u}$。\n        - 更新：求解 $J(u^{(k)})\\,\\Delta u^{(k)} = -r(u^{(k)})$ 以得到 $\\Delta u^{(k)}$，然后 $u^{(k+1)} = u^{(k)} + \\Delta u^{(k)}$。\n    - 收敛准则：\n        - 终止条件：$\\|r(u^{(k)})\\|_{2} \\le \\varepsilon$。\n        - 观测阶：$p_{k} = \\frac{\\ln\\left(\\|r(u^{(k+1)})\\|_{2}/\\|r(u^{(k)})\\|_{2}\\right)}{\\ln\\left(\\|r(u^{(k)})\\|_{2}/\\|r(u^{(k-1)})\\|_{2}\\right)}$。\n        - 二次收敛检查：对于每个载荷步，如果最后两个有效的计算阶数 $p_k$（在最后一次活动集改变之后且 $\\|r(u^{(k)})\\|_{2} \\le \\rho$）都 $\\ge 1.8$，或者求解器在 $\\le 2$ 次迭代内收敛，则宣告实现了持续的二次收敛。\n    - 参数：$k_{s} = 10 \\,\\text{N/m}$， $k_{t} = 100 \\,\\text{N/m}$， $\\tau = 1 \\,\\text{N}$， $\\varepsilon = 10^{-12} \\,\\text{N}$， $\\rho = 10^{-6} \\,\\text{N}$，最大迭代次数 $50$。\n    - 测试用例：三组施加载荷 $F$ 的序列。\n\n- **验证结论**：该问题是**有效的**。它在科学上基于接触力学的既定原理，数学上是适定的，客观且自洽的。所有必要的方程、参数和准则都已明确提供。该任务需要严谨的推导和仔细的实现，这是该领域的标准练习。\n\n### 第1部分：一致雅可比矩阵的推导\n\n求解非线性系统 $r(u) = 0$ 的牛顿法需要雅可比矩阵 $J(u)$，即残差 $r(u)$ 关于位移向量 $u$ 的导数。\n$$\nr(u) = k_s u + t(u) - F\n$$\n残差的导数为：\n$$\nJ(u) = \\frac{\\partial r(u)}{\\partial u} = \\frac{\\partial}{\\partial u} (k_s u + t(u) - F) = k_s \\frac{\\partial u}{\\partial u} + \\frac{\\partial t(u)}{\\partial u} - \\frac{\\partial F}{\\partial u}\n$$\n由于 $F$ 是外部施加的载荷，它与 $u$ 无关，因此 $\\frac{\\partial F}{\\partial u} = 0$。项 $\\frac{\\partial u}{\\partial u}$ 是单位矩阵 $I \\in \\mathbb{R}^{2 \\times 2}$。结构刚度为 $K=k_s I$。因此，雅可比矩阵简化为：\n$$\nJ(u) = K + \\frac{\\partial t(u)}{\\partial u}\n$$\n关键部分是推导牵引力导数 $\\frac{\\partial t(u)}{\\partial u}$，它取决于位移 $u$ 处的活动集（粘着或滑移）。\n\n**1. 粘着集推导**\n- **条件**：粘着条件为 $\\|t_{\\mathrm{tr}}(u)\\| \\le \\tau$，使用定义 $t_{\\mathrm{tr}}(u) = k_t u$ 后，简化为 $k_t \\|u\\| \\le \\tau$。\n- **牵引力**：在粘着集中，牵引力与位移呈线性关系：\n$$\nt(u) = k_t u\n$$\n- **雅可比矩阵**：这个线性函数的导数是一个常数张量：\n$$\n\\frac{\\partial t(u)}{\\partial u} = \\frac{\\partial}{\\partial u} (k_t u) = k_t I\n$$\n将此代入 $J(u)$ 的一般表达式，得到粘着集的一致雅可比矩阵：\n$$\nJ_{\\mathrm{stick}}(u) = K + k_t I = k_s I + k_t I = (k_s + k_t)I\n$$\n这是一个简单的对角矩阵，代表结构弹簧和接触罚弹簧的组合刚度。\n\n**2. 滑移集推导**\n- **条件**：滑移条件为 $\\|t_{\\mathrm{tr}}(u)\\| > \\tau$，简化为 $k_t \\|u\\| > \\tau$。在此区域，$\\|u\\|$ 不能为零。\n- **牵引力**：在滑移集中，牵引力向量的大小恒为 $\\tau$，方向与滑移方向相反。这里，它与位移 $u$ 的方向一致：\n$$\nt(u) = \\tau \\frac{u}{\\|u\\|} = \\tau \\hat{n}(u)\n$$\n其中 $\\hat{n}(u) = u/\\|u\\|$ 是归一化的位移向量。\n- **雅可比矩阵**：我们必须对 $t(u)$ 求关于 $u \\in \\mathbb{R}^2$ 的导数。这需要使用链式法则。归一化向量 $\\hat{n}(u)$ 的导数是张量微积分中的一个已知结果：\n$$\n\\frac{\\partial \\hat{n}(u)}{\\partial u} = \\frac{\\partial}{\\partial u} \\left( \\frac{u}{\\|u\\|} \\right) = \\frac{1}{\\|u\\|} \\left( I - \\frac{u \\otimes u}{\\|u\\|^2} \\right)\n$$\n其中 $\\otimes$ 表示外积。项 $(I - \\hat{n} \\otimes \\hat{n})$ 是一个投影算子，它投影到与 $\\hat{n}$ 正交的空间上。\n利用这个结果，滑移牵引力的导数为：\n$$\n\\frac{\\partial t(u)}{\\partial u} = \\tau \\frac{\\partial \\hat{n}(u)}{\\partial u} = \\frac{\\tau}{\\|u\\|} \\left( I - \\frac{u \\otimes u}{\\|u\\|^2} \\right)\n$$\n将此代入 $J(u)$ 的一般表达式，得到滑移集的一致雅可比矩阵：\n$$\nJ_{\\mathrm{slip}}(u) = K + \\frac{\\tau}{\\|u\\|} \\left( I - \\frac{u \\otimes u}{\\|u\\|^2} \\right) = k_s I + \\frac{\\tau}{\\|u\\|}I - \\frac{\\tau}{\\|u\\|^3}(u \\otimes u)\n$$\n这个雅可比矩阵在径向方向上是秩亏的（它有一个对应于特征向量 $u$ 的零特征值），这反映了在滑移状态下，沿 $u$ 方向运动的阻力仅由结构刚度 $k_s$ 决定，而与 $u$ 正交方向运动的阻力则涉及 $k_s$ 和一个几何刚度项 $\\tau/\\|u\\|$。\n\n### 第2部分：算法设计与收敛性\n\n牛顿法采用活动集策略实现。在给定一个位移猜测值 $u^{(k)}$ 的每次迭代 $k$ 中：\n1.  计算试探牵引力 $t_{\\mathrm{tr}}(u^{(k)}) = k_t u^{(k)}$。\n2.  通过比较 $\\|t_{\\mathrm{tr}}(u^{(k)})\\|$ 与 $\\tau$ 来确定活动集。\n3.  根据活动集（‘粘着’或‘滑移’），从上述推导中选择相应的牵引力 $t(u^{(k)})$ 和雅可比矩阵 $J(u^{(k)})$ 的表达式。\n4.  计算残差 $r(u^{(k)}) = k_s u^{(k)} + t(u^{(k)}) - F$。\n5.  求解线性系统 $J(u^{(k)}) \\Delta u^{(k)} = -r(u^{(k)})$ 以得到位移增量 $\\Delta u^{(k)}$。\n6.  更新位移：$u^{(k+1)} = u^{(k)} + \\Delta u^{(k)}$。\n7.  重复此过程，直到残差范数 $\\|r(u^{(k+1)})\\|_2$ 低于容差 $\\varepsilon$。\n\n此过程使用*一致线性化*，因为雅可比矩阵 $J(u^{(k)})$ 是在迭代 $k$ 时所选特定活动集分支下残差函数 $r(u)$ 的精确导数。一旦迭代收敛到一个点，使得活动集不再改变，该方法就如同一个用于光滑非线性系统的标准牛顿-拉弗森求解器，已知其表现出二次收敛性。\n\n收敛性的定量验证按规定执行。在一个载荷步收敛后，分析残差范数和活动集的历史记录。“持续二次收敛”准则要求最后两个计算出的渐近收敛阶 $p_k$ 均 $\\ge 1.8$，这是一个严格的检查，用以确认该方法在解决了因活动集切换引起的任何初始非光滑性后，确实达到了理论上预期的性能。",
            "answer": "```python\nimport numpy as np\nimport math\n\ndef solve():\n    \"\"\"\n    Solves the contact mechanics problem and verifies convergence.\n    \"\"\"\n\n    # Common parameters\n    ks = 10.0  # N/m\n    kt = 100.0 # N/m\n    tau = 1.0  # N\n    eps = 1e-12 # N\n    rho = 1e-6  # N\n    max_iter = 50\n\n    # Test cases\n    test_cases_loads = [\n        # Case 1: stick-slip-stick-slip along a straight line\n        [\n            np.array([0.5, 0.0]),\n            np.array([1.2, 0.0]),\n            np.array([0.8, 0.0]),\n            np.array([1.5, 0.0]),\n        ],\n        # Case 2: directional rotation under persistent slip\n        [\n            2.0 * np.array([math.cos(0.0), math.sin(0.0)]),\n            2.0 * np.array([math.cos(math.pi / 4.0), math.sin(math.pi / 4.0)]),\n            2.0 * np.array([math.cos(math.pi / 2.0), math.sin(math.pi / 2.0)]),\n        ],\n        # Case 3: near-threshold toggling\n        [\n            np.array([1.08, 0.0]),\n            np.array([1.12, 0.0]),\n            np.array([1.09, 0.0]),\n            np.array([1.11, 0.0]),\n        ],\n    ]\n\n    overall_results = []\n\n    for case_loads in test_cases_loads:\n        u_initial = np.zeros(2)\n        case_passed = True\n        for F_load in case_loads:\n            u_converged, history = newton_solver(F_load, u_initial, ks, kt, tau, eps, max_iter)\n            \n            load_step_passed = analyze_convergence(history['residual_norms'], history['active_sets'], rho)\n\n            if not load_step_passed:\n                case_passed = False\n                break\n            \n            u_initial = u_converged\n        \n        overall_results.append(case_passed)\n\n    print(f\"[{','.join(map(str, overall_results))}]\".lower())\n\ndef newton_solver(F, u_initial, ks, kt, tau, eps, max_iter):\n    \"\"\"\n    Performs the active-set Newton method for a single load step.\n    \"\"\"\n    u = np.copy(u_initial)\n    I = np.identity(2)\n    K = ks * I\n\n    history = {'residual_norms': [], 'active_sets': []}\n    \n    for k in range(max_iter + 1):\n        # Determine active set and compute traction t and its derivative dt_du\n        t_tr = kt * u\n        norm_t_tr = np.linalg.norm(t_tr)\n\n        if norm_t_tr = tau:\n            # Stick state\n            active_set = 'stick'\n            t = t_tr\n            dt_du = kt * I\n        else:\n            # Slip state\n            active_set = 'slip'\n            norm_u = np.linalg.norm(u)\n            # norm_u will not be zero in slip, as kt*||u|| > tau > 0\n            t = tau * u / norm_u\n            \n            u_outer_u = np.outer(u, u)\n            dt_du = (tau / norm_u) * (I - u_outer_u / (norm_u**2))\n            \n        # Compute residual r and Jacobian J\n        r = K @ u + t - F\n        J = K + dt_du\n        \n        norm_r = np.linalg.norm(r)\n        \n        history['residual_norms'].append(norm_r)\n        history['active_sets'].append(active_set)\n        \n        if norm_r = eps:\n            break\n            \n        if k == max_iter:\n            # Failed to converge\n            break\n\n        # Solve for increment and update\n        delta_u = np.linalg.solve(J, -r)\n        u = u + delta_u\n        \n    return u, history\n\ndef analyze_convergence(residual_norms, active_sets, rho):\n    \"\"\"\n    Verifies sustained quadratic convergence for a single load step.\n    \"\"\"\n    num_iterations = len(residual_norms) - 1\n    \n    # Pass by default if converged in = 2 iterations\n    if num_iterations = 2:\n        return True\n\n    # Find the index of the last iteration where the active set changed\n    last_change_idx = 0\n    for i in range(1, len(active_sets)):\n        if active_sets[i] != active_sets[i-1]:\n            last_change_idx = i\n\n    valid_p_orders = []\n    # k is the index into the residual_norms list, corresponding to u^(k)\n    # We can compute p_k for k from 1 to len-2.\n    # We only consider k > last_change_idx.\n    for k in range(last_change_idx + 1, len(residual_norms) - 1):\n        if k == 0:\n             continue # Cannot compute p_k if k=0\n        \n        norm_rk_m1 = residual_norms[k-1]\n        norm_rk = residual_norms[k]\n        norm_rk_p1 = residual_norms[k+1]\n\n        # Check conditions for computing p_k\n        if norm_rk > rho:\n            continue\n            \n        # Denominators must be defined and norms strictly positive\n        if norm_rk_m1 == 0 or norm_rk == 0:\n            continue\n        \n        # Avoid division by zero if norms are equal\n        if abs(norm_rk - norm_rk_m1)  1e-15:\n            continue\n\n        denominator = np.log(norm_rk / norm_rk_m1)\n        if abs(denominator)  1e-15:\n            continue\n\n        numerator = np.log(norm_rk_p1 / norm_rk)\n        \n        pk = numerator / denominator\n        valid_p_orders.append(pk)\n        \n    # Check if the last two valid computed orders are >= 1.8\n    if len(valid_p_orders) >= 2:\n        if valid_p_orders[-1] >= 1.8 and valid_p_orders[-2] >= 1.8:\n            return True\n    \n    return False\n\nif __name__ == '__main__':\n    solve()\n\n```"
        },
        {
            "introduction": "在更真实的接触模拟中，我们不仅要考虑材料响应，还必须处理接触几何构型的变化。本练习从单点模型升级到更实际的“段-段”（segment-to-segment）接触，重点关注接触面旋转对切向刚度的影响。通过推导一个特定的雅可比矩阵项，你将揭示由接触框架（法向 $\\boldsymbol{n}$ 和切向 $\\boldsymbol{t}$）变化引起的“几何刚度”项，并理解其对系统稳定性和收敛性的重要性。",
            "id": "3584746",
            "problem": "考虑在有限元法（FEM）背景下的二维段-段接触离散化，其中法向和切向约束采用罚函数法施加，并包含经典库仑摩擦。一个由节点 $A$ 和 $B$ 构成的直主段，其初始坐标分别为 $(-L/2,0)$ 和 $(+L/2,0)$，另有一个从点 $S$ 在参考构型中位于 $(0,-\\delta)$。接触积分点固定在主段中点（因此在该积分点处主单元形函数的值为 $N_{A}=N_{B}=1/2$），线段坐标系 $\\{\\boldsymbol{t},\\boldsymbol{n}\\}$ 由变形后的线段定义，其中 $\\boldsymbol{t}$ 是单位切向量，$\\boldsymbol{n}$ 是单位外法向量，两者均根据当前构型共转更新。\n\n假设为小应变、小转动运动学。主段的转动由小角度 $\\phi=(u_{y}^{B}-u_{y}^{A})/L$ 参数化，因此，在未变形的水平构型下，坐标系的一阶变分满足\n$$\n\\frac{\\partial \\boldsymbol{t}}{\\partial \\phi}=\\begin{bmatrix}0\\\\1\\end{bmatrix},\\qquad \\frac{\\partial \\boldsymbol{n}}{\\partial \\phi}=\\begin{bmatrix}-1\\\\0\\end{bmatrix},\n$$\n并且\n$$\n\\frac{\\partial \\boldsymbol{t}}{\\partial u_{y}^{B}}=\\frac{1}{L}\\begin{bmatrix}0\\\\1\\end{bmatrix},\\qquad \\frac{\\partial \\boldsymbol{n}}{\\partial u_{y}^{B}}=\\frac{1}{L}\\begin{bmatrix}-1\\\\0\\end{bmatrix},\n$$\n在 $u_{y}^{A}=u_{y}^{B}=0$ 处计算。\n\n设法向响应的罚参数为 $k_{n}$，切向（粘滞）响应的罚参数为 $k_{t}$。设库仑摩擦系数为 $\\mu$，滑动方向标量为 $s=+1$（即，当摩擦力激活时，其方向与正切向滑移方向相反）。定义作用于从属体上的接触牵引力矢量为\n$$\n\\boldsymbol{f}=-p_{n}\\,\\boldsymbol{n}+t_{t}\\,\\boldsymbol{t},\n$$\n其中，当法向间隙 $g_{n}0$ 时，法向压力大小为 $p_{n}=k_{n}(-g_{n})$，法向间隙 $g_{n}=(\\boldsymbol{x}_{s}-\\boldsymbol{x}_{m})\\cdot \\boldsymbol{n}$；切向牵引力大小 $t_{t}$ 在粘滞状态下由粘滞定律 $t_{t}=k_{t}\\,g_{t}$ 给出，切向间隙 $g_{t}=(\\boldsymbol{x}_{s}-\\boldsymbol{x}_{m})\\cdot \\boldsymbol{t}$，在滑移状态下由滑移定律 $t_{t}=-\\mu\\,p_{n}\\,s$ 给出。取主段中点位置为 $\\boldsymbol{x}_{m}=(\\boldsymbol{x}_{A}+\\boldsymbol{x}_{B})/2$。\n\n在线性化点，设 $u_{y}^{A}=u_{y}^{B}=0$，因此 $\\boldsymbol{t}=\\begin{bmatrix}1\\\\0\\end{bmatrix}$，$\\boldsymbol{n}=\\begin{bmatrix}0\\\\1\\end{bmatrix}$，且从点处于一个恒定的法向侵入量 $g_{n}=-\\delta0$（其中 $\\delta>0$）和零切向间隙 $g_{t}=0$ 的位置。\n\n关注单个标量雅可比项，它线性地关联了作用于从点上的接触力的全局 $x$ 分量的变化，\n$$\nF_{x}=\\boldsymbol{f}\\cdot \\boldsymbol{e}_{x},\n$$\n与主节点 $B$ 的竖向位移 $u_{y}^{B}$ 的微扰之间的关系，即：\n$$\nK:=\\frac{\\partial F_{x}}{\\partial u_{y}^{B}}。\n$$\n\n1) 从接触虚功原理和上述定义出发，进行一致线性化以推导 $K$，并显式地保留来自 $\\partial \\boldsymbol{t}/\\partial u_{y}^{B}$ 和 $\\partial \\boldsymbol{n}/\\partial u_{y}^{B}$ 的贡献。在同一线性化点上，分别对粘滞状态和滑移状态进行此推导。您必须将 $g_{n}$ 和 $g_{t}$ 视为相对位置和坐标系的函数，即 $g_{n}=(\\boldsymbol{x}_{s}-\\boldsymbol{x}_{m})\\cdot \\boldsymbol{n}$ 和 $g_{t}=(\\boldsymbol{x}_{s}-\\boldsymbol{x}_{m})\\cdot \\boldsymbol{t}$，其中接触积分点固定在主段中点。\n\n2) 使用您的符号表达式，计算从粘滞状态过渡到滑移状态时切向刚度项的变化量，\n$$\n\\Delta K:=K_{\\text{slip}}-K_{\\text{stick}},\n$$\n使用以下数据：$L=2\\,\\mathrm{m}$，$\\delta=1.0\\times 10^{-3}\\,\\mathrm{m}$，$k_{n}=1.0\\times 10^{6}\\,\\mathrm{N/m}$，$k_{t}=1.0\\times 10^{5}\\,\\mathrm{N/m}$，$\\mu=0.3$，$s=+1$。假设单位厚度，因此力和刚度是单位平面外厚度的值，且接触求积权重为1。\n\n将您的 $\\Delta K$ 最终数值答案以 $\\mathrm{N/m}$ 为单位表示，并四舍五入到四位有效数字。",
            "solution": "问题要求推导在粘滞和滑移条件下，段-段接触单元的一个特定切向刚度矩阵项 $K = \\frac{\\partial F_{x}}{\\partial u_{y}^{B}}$，然后计算该刚度的变化量 $\\Delta K = K_{\\text{slip}} - K_{\\text{stick}}$。\n\n需要求导的量是作用于从点上的接触力矢量 $\\boldsymbol{f}$ 的 $x$ 分量。力矢量定义为 $\\boldsymbol{f} = -p_{n}\\,\\boldsymbol{n}+t_{t}\\,\\boldsymbol{t}$。其 $x$ 分量为 $F_{x} = \\boldsymbol{f} \\cdot \\boldsymbol{e}_{x}$，其中 $\\boldsymbol{e}_{x} = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix}$。\n$$\nF_{x} = (-p_{n}\\,\\boldsymbol{n}+t_{t}\\,\\boldsymbol{t}) \\cdot \\boldsymbol{e}_{x} = -p_{n}(\\boldsymbol{n} \\cdot \\boldsymbol{e}_{x}) + t_{t}(\\boldsymbol{t} \\cdot \\boldsymbol{e}_{x})\n$$\n我们记 $n_x = \\boldsymbol{n} \\cdot \\boldsymbol{e}_{x}$ 和 $t_x = \\boldsymbol{t} \\cdot \\boldsymbol{e}_{x}$。所以，$F_{x} = -p_{n} n_x + t_{t} t_x$。\n\n刚度项 $K$ 是 $F_x$ 对主节点 $B$ 的竖向位移 $u_{y}^{B}$ 的偏导数。应用微分的乘法法则可得：\n$$\nK = \\frac{\\partial F_{x}}{\\partial u_{y}^{B}} = -\\frac{\\partial p_{n}}{\\partial u_{y}^{B}} n_x - p_{n} \\frac{\\partial n_x}{\\partial u_{y}^{B}} + \\frac{\\partial t_{t}}{\\partial u_{y}^{B}} t_x + t_{t} \\frac{\\partial t_x}{\\partial u_{y}^{B}}\n$$\n此表达式必须在指定的线性化点进行计算，在该点 $u_{y}^{A} = u_{y}^{B} = 0$。此时，主段是水平的。\n切向量和法向量为：\n$\\boldsymbol{t} = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix}$，所以 $t_x = 1$。\n$\\boldsymbol{n} = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}$，所以 $n_x = 0$。\n\n从点处于法向侵入量 $g_n = -\\delta$（其中 $\\delta  0$）和零切向间隙 $g_t = 0$ 的状态。\n法向压力大小为 $p_n = k_n(-g_n) = k_n \\delta$。\n在粘滞情况下，切向牵引力为 $t_t = k_t g_t = k_t(0) = 0$。\n在滑移情况下，切向牵引力为 $t_t = -\\mu p_n s = -\\mu (k_n \\delta) s$。\n\n将线性化点处的 $n_x$ 和 $t_x$ 的值代入 $K$ 的表达式中：\n$$\nK = -\\frac{\\partial p_{n}}{\\partial u_{y}^{B}} (0) - p_{n} \\frac{\\partial n_x}{\\partial u_{y}^{B}} + \\frac{\\partial t_{t}}{\\partial u_{y}^{B}} (1) + t_{t} \\frac{\\partial t_x}{\\partial u_{y}^{B}} = -p_{n} \\frac{\\partial n_x}{\\partial u_{y}^{B}} + \\frac{\\partial t_{t}}{\\partial u_{y}^{B}} + t_{t} \\frac{\\partial t_x}{\\partial u_{y}^{B}}\n$$\n我们需要求出坐标系分量的导数，$\\frac{\\partial n_x}{\\partial u_{y}^{B}}$ 和 $\\frac{\\partial t_x}{\\partial u_{y}^{B}}$。\n使用给定的坐标系导数：\n$$\n\\frac{\\partial \\boldsymbol{t}}{\\partial u_{y}^{B}} = \\frac{1}{L}\\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}, \\qquad \\frac{\\partial \\boldsymbol{n}}{\\partial u_{y}^{B}} = \\frac{1}{L}\\begin{bmatrix} -1 \\\\ 0 \\end{bmatrix}\n$$\n各分量的导数为：\n$$\n\\frac{\\partial t_x}{\\partial u_{y}^{B}} = \\frac{\\partial (\\boldsymbol{t} \\cdot \\boldsymbol{e}_x)}{\\partial u_{y}^{B}} = \\frac{\\partial \\boldsymbol{t}}{\\partial u_{y}^{B}} \\cdot \\boldsymbol{e}_x = \\frac{1}{L}\\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix} \\cdot \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix} = 0\n$$\n$$\n\\frac{\\partial n_x}{\\partial u_{y}^{B}} = \\frac{\\partial (\\boldsymbol{n} \\cdot \\boldsymbol{e}_x)}{\\partial u_{y}^{B}} = \\frac{\\partial \\boldsymbol{n}}{\\partial u_{y}^{B}} \\cdot \\boldsymbol{e}_x = \\frac{1}{L}\\begin{bmatrix} -1 \\\\ 0 \\end{bmatrix} \\cdot \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix} = -\\frac{1}{L}\n$$\n将这些代入 $K$ 的表达式中：\n$$\nK = -p_n \\left(-\\frac{1}{L}\\right) + \\frac{\\partial t_t}{\\partial u_{y}^{B}} + t_t(0) = \\frac{p_n}{L} + \\frac{\\partial t_t}{\\partial u_{y}^{B}}\n$$\n代入 $p_n=k_n \\delta$：\n$$\nK = \\frac{k_n \\delta}{L} + \\frac{\\partial t_t}{\\partial u_{y}^{B}}\n$$\n这个通用形式对粘滞和滑移两种状态都有效。区别在于 $\\frac{\\partial t_t}{\\partial u_{y}^{B}}$ 这一项。该项通常被称为刚度的“材料”贡献，而 $\\frac{p_n}{L}$ 是“几何”或“压力”贡献。\n\n### 1. 粘滞状态 ($K_{\\text{stick}}$)\n在粘滞状态下，$t_t = k_t g_t$。我们需要计算其导数：\n$$\n\\frac{\\partial t_t}{\\partial u_{y}^{B}} = k_t \\frac{\\partial g_t}{\\partial u_{y}^{B}}\n$$\n切向间隙为 $g_t = (\\boldsymbol{x}_s - \\boldsymbol{x}_m) \\cdot \\boldsymbol{t}$。其导数为：\n$$\n\\frac{\\partial g_t}{\\partial u_{y}^{B}} = \\frac{\\partial (\\boldsymbol{x}_s - \\boldsymbol{x}_m)}{\\partial u_{y}^{B}} \\cdot \\boldsymbol{t} + (\\boldsymbol{x}_s - \\boldsymbol{x}_m) \\cdot \\frac{\\partial \\boldsymbol{t}}{\\partial u_{y}^{B}}\n$$\n在线性化点，从点位置 $\\boldsymbol{x}_s$ 保持不变，主接触点位置为 $\\boldsymbol{x}_m=\\frac{1}{2}(\\boldsymbol{x}_A+\\boldsymbol{x}_B)$。主点的位移为 $\\boldsymbol{u}_m = \\frac{1}{2}(\\boldsymbol{u}_A+\\boldsymbol{u}_B)$。\n相对位置矢量的导数为：\n$$\n\\frac{\\partial (\\boldsymbol{x}_s - \\boldsymbol{x}_m)}{\\partial u_{y}^{B}} = -\\frac{\\partial \\boldsymbol{x}_m}{\\partial u_{y}^{B}} = -\\frac{\\partial \\boldsymbol{u}_m}{\\partial u_{y}^{B}} = -\\frac{1}{2}\\frac{\\partial \\boldsymbol{u}_B}{\\partial u_{y}^{B}} = -\\frac{1}{2}\\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}\n$$\n在线性化点计算 $\\frac{\\partial g_t}{\\partial u_{y}^{B}}$ 的各项：\n第一项：$\\frac{\\partial (\\boldsymbol{x}_s - \\boldsymbol{x}_m)}{\\partial u_{y}^{B}} \\cdot \\boldsymbol{t} = \\left(-\\frac{1}{2}\\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}\\right) \\cdot \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix} = 0$。\n第二项：相对位置矢量为 $\\boldsymbol{x}_s - \\boldsymbol{x}_m = \\begin{bmatrix} 0 \\\\ -\\delta \\end{bmatrix} - \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix} = \\begin{bmatrix} 0 \\\\ -\\delta \\end{bmatrix}$。\n$$\n(\\boldsymbol{x}_s - \\boldsymbol{x}_m) \\cdot \\frac{\\partial \\boldsymbol{t}}{\\partial u_{y}^{B}} = \\begin{bmatrix} 0 \\\\ -\\delta \\end{bmatrix} \\cdot \\left(\\frac{1}{L}\\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}\\right) = -\\frac{\\delta}{L}\n$$\n所以，$\\frac{\\partial g_t}{\\partial u_{y}^{B}} = 0 - \\frac{\\delta}{L} = -\\frac{\\delta}{L}$。\n切向牵引力的导数为 $\\frac{\\partial t_t}{\\partial u_{y}^{B}} = k_t \\left(-\\frac{\\delta}{L}\\right) = -\\frac{k_t \\delta}{L}$。\n最后，我们组装粘滞情况下的刚度项：\n$$\nK_{\\text{stick}} = \\frac{k_n \\delta}{L} - \\frac{k_t \\delta}{L} = \\frac{\\delta}{L}(k_n - k_t)\n$$\n\n### 2. 滑移状态 ($K_{\\text{slip}}$)\n在滑移状态下，$t_t = -\\mu p_n s$。对 $u_{y}^{B}$求导：\n$$\n\\frac{\\partial t_t}{\\partial u_{y}^{B}} = -\\mu s \\frac{\\partial p_n}{\\partial u_{y}^{B}}\n$$\n我们需要求法向压力 $p_n = k_n(-g_n)$ 的导数：\n$$\n\\frac{\\partial p_n}{\\partial u_{y}^{B}} = -k_n \\frac{\\partial g_n}{\\partial u_{y}^{B}}\n$$\n法向间隙为 $g_n = (\\boldsymbol{x}_s - \\boldsymbol{x}_m) \\cdot \\boldsymbol{n}$。其导数为：\n$$\n\\frac{\\partial g_n}{\\partial u_{y}^{B}} = \\frac{\\partial (\\boldsymbol{x}_s - \\boldsymbol{x}_m)}{\\partial u_{y}^{B}} \\cdot \\boldsymbol{n} + (\\boldsymbol{x}_s - \\boldsymbol{x}_m) \\cdot \\frac{\\partial \\boldsymbol{n}}{\\partial u_{y}^{B}}\n$$\n在线性化点计算 $\\frac{\\partial g_n}{\\partial u_{y}^{B}}$ 的各项：\n第一项：$\\frac{\\partial (\\boldsymbol{x}_s - \\boldsymbol{x}_m)}{\\partial u_{y}^{B}} \\cdot \\boldsymbol{n} = \\left(-\\frac{1}{2}\\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}\\right) \\cdot \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix} = -\\frac{1}{2}$。\n第二项：\n$$\n(\\boldsymbol{x}_s - \\boldsymbol{x}_m) \\cdot \\frac{\\partial \\boldsymbol{n}}{\\partial u_{y}^{B}} = \\begin{bmatrix} 0 \\\\ -\\delta \\end{bmatrix} \\cdot \\left(\\frac{1}{L}\\begin{bmatrix} -1 \\\\ 0 \\end{bmatrix}\\right) = 0\n$$\n所以，$\\frac{\\partial g_n}{\\partial u_{y}^{B}} = -\\frac{1}{2} + 0 = -\\frac{1}{2}$。\n法向压力的导数为 $\\frac{\\partial p_n}{\\partial u_{y}^{B}} = -k_n \\left(-\\frac{1}{2}\\right) = \\frac{k_n}{2}$。\n那么，切向牵引力的导数为 $\\frac{\\partial t_t}{\\partial u_{y}^{B}} = -\\mu s \\left(\\frac{k_n}{2}\\right) = -\\frac{\\mu s k_n}{2}$。\n最后，我们组装滑移情况下的刚度项：\n$$\nK_{\\text{slip}} = \\frac{k_n \\delta}{L} - \\frac{\\mu s k_n}{2}\n$$\n\n### 3. 刚度变化量 ($\\Delta K$)\n从粘滞状态过渡到滑移状态时，切向刚度项的变化量为：\n$$\n\\Delta K = K_{\\text{slip}} - K_{\\text{stick}} = \\left(\\frac{k_n \\delta}{L} - \\frac{\\mu s k_n}{2}\\right) - \\left(\\frac{k_n \\delta}{L} - \\frac{k_t \\delta}{L}\\right)\n$$\n$$\n\\Delta K = \\frac{k_n \\delta}{L} - \\frac{\\mu s k_n}{2} - \\frac{k_n \\delta}{L} + \\frac{k_t \\delta}{L} = \\frac{k_t \\delta}{L} - \\frac{\\mu s k_n}{2}\n$$\n\n### 4. 数值计算\n我们将给定的数值代入 $\\Delta K$ 的表达式中：\n$L=2\\,\\mathrm{m}$，$\\delta=1.0\\times 10^{-3}\\,\\mathrm{m}$，$k_{n}=1.0\\times 10^{6}\\,\\mathrm{N/m}$，$k_{t}=1.0\\times 10^{5}\\,\\mathrm{N/m}$，$\\mu=0.3$，$s=1$。\n\n第一项：\n$$\n\\frac{k_t \\delta}{L} = \\frac{(1.0 \\times 10^{5}\\,\\mathrm{N/m}) (1.0 \\times 10^{-3}\\,\\mathrm{m})}{2\\,\\mathrm{m}} = \\frac{100}{2}\\,\\mathrm{N/m} = 50\\,\\mathrm{N/m}\n$$\n第二项：\n$$\n\\frac{\\mu s k_n}{2} = \\frac{(0.3)(1)(1.0 \\times 10^{6}\\,\\mathrm{N/m})}{2} = \\frac{3 \\times 10^{5}}{2}\\,\\mathrm{N/m} = 1.5 \\times 10^{5}\\,\\mathrm{N/m} = 150000\\,\\mathrm{N/m}\n$$\n刚度的变化量为：\n$$\n\\Delta K = 50\\,\\mathrm{N/m} - 150000\\,\\mathrm{N/m} = -149950\\,\\mathrm{N/m}\n$$\n将此值四舍五入到四位有效数字：\n$$\n-149950 = -1.4995 \\times 10^5\n$$\n由于第五位有效数字是 $5$，我们将第四位有效数字（第二个 $9$）向上取整，得到：\n$$\n\\Delta K \\approx -1.500 \\times 10^5\\,\\mathrm{N/m}\n$$",
            "answer": "$$\n\\boxed{-1.500 \\times 10^{5}}\n$$"
        },
        {
            "introduction": "除了罚函数法，增广拉格朗日方法是求解接触问题的另一种强大且广泛使用的技术。本实践将带你深入该方法的核心，推导其在库仑摩擦模型下的一致线性化形式。你将学习如何处理由法向不可穿透和切向摩擦状态（粘滞或滑移）共同决定的“活动集”（active set）变化，并看到非对称的切向刚度矩阵是如何从摩擦的物理本质中自然产生的。",
            "id": "2550855",
            "problem": "考虑有限元网格中单个积分点上的二维节点-节点摩擦接触界面。设界面处的单位法向量和切向量分别为 $\\boldsymbol{n} = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}$ 和 $\\boldsymbol{t} = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix}$。从节点和主节点之间的相对位移为 $\\boldsymbol{d} = \\boldsymbol{u}_{s} - \\boldsymbol{u}_{m}$，其中 $\\boldsymbol{u}_{s} = \\begin{bmatrix} u_{s,x} \\\\ u_{s,y} \\end{bmatrix}$ 且 $\\boldsymbol{u}_{m} = \\begin{bmatrix} u_{m,x} \\\\ u_{m,y} \\end{bmatrix}$。定义法向间隙和切向间隙分别为 $g_{n} = -\\boldsymbol{n}^{\\top} \\boldsymbol{d}$（侵入时为正）和 $g_{t} = \\boldsymbol{t}^{\\top} \\boldsymbol{d}$。设 $\\varepsilon_{n}  0$ 和 $\\varepsilon_{t}  0$ 为增广拉格朗日参数，$\\lambda_{n}$、$\\lambda_{t}$ 为当前的拉格朗日乘子，它们在线性化过程中保持不变。定义法向和切向预测值分别为 $y_{n} = \\lambda_{n} + \\varepsilon_{n} g_{n}$ 和 $y_{t} = \\lambda_{t} + \\varepsilon_{t} g_{t}$。法向压应力大小为 $t_{n} = \\langle y_{n} \\rangle_{+} = \\max(0, y_{n})$。设库仑摩擦系数为 $\\mu  0$，则摩擦界限为 $b = \\mu t_{n}$，切向应力由投影（约束）给出：$\\tau = \\operatorname{clamp}(y_{t}, -b, b)$。作用于从节点一侧的界面应力向量为 $ \\mathbf{t} = t_{n} \\boldsymbol{n} + \\tau \\boldsymbol{t}$，对从节点的残差贡献为 $\\boldsymbol{r}_{s} = -\\mathbf{t}$。\n\n从以上定义以及单边接触和库仑摩擦所蕴含的互补结构出发，推导适用于牛顿法的一致性线性化 $\\partial \\boldsymbol{r}_{s} / \\partial \\boldsymbol{u}$。您的推导必须明确考虑激活集对试探状态的依赖性，即：(i) 由 $y_{n}$ 的符号决定的接触打开与闭合状态，以及 (ii) 通过比较 $|y_{t}|$ 与 $b = \\mu t_{n}$ 决定的粘滞与滑移状态。请清楚地写出在每个激活集分支中关于 $\\boldsymbol{u}$ 的方向导数表达式。\n\n然后，对于给定的具体数据\n$\\varepsilon_{n} = 2.5 \\times 10^{6}$，$\\varepsilon_{t} = 1.0 \\times 10^{6}$，$\\mu = 0.3$，$\\lambda_{n} = 150$，$\\lambda_{t} = 50$，$\\boldsymbol{u}_{s} = \\begin{bmatrix} 4.0 \\times 10^{-4} \\\\ -3.0 \\times 10^{-4} \\end{bmatrix}$，以及 $\\boldsymbol{u}_{m} = \\begin{bmatrix} 5.0 \\times 10^{-5} \\\\ -1.0 \\times 10^{-4} \\end{bmatrix}$，计算在此试探状态下的雅可比标量项 $\\partial r_{s,y} / \\partial u_{s,y}$。将您的答案四舍五入至四位有效数字，并以 $\\mathrm{N/m}$ 为单位表示。",
            "solution": "问题陈述具有科学依据，是适定且完整的。它描述了摩擦接触的标准增广拉格朗日公式，这是计算力学中一种常用且有效的方法。我现在将进行推导和计算。\n\n目标是计算从节点残差 $\\boldsymbol{r}_s$ 相对于节点位移 $\\boldsymbol{u}$ 的一致性线性化。残差由 $\\boldsymbol{r}_s = -\\mathbf{t}$ 给出，其中 $\\mathbf{t} = t_n \\boldsymbol{n} + \\tau \\boldsymbol{t}$。我们感兴趣的是雅可比矩阵，其分量是 $\\boldsymbol{r}_s$ 的方向导数。总位移向量为 $\\boldsymbol{u} = (\\boldsymbol{u}_s^\\top, \\boldsymbol{u}_m^\\top)^\\top$。所有量都依赖于相对位移 $\\boldsymbol{d} = \\boldsymbol{u}_s - \\boldsymbol{u}_m$。根据链式法则，显然有 $\\frac{\\partial \\boldsymbol{r}_s}{\\partial \\boldsymbol{u}_m} = \\frac{\\partial \\boldsymbol{r}_s}{\\partial \\boldsymbol{d}} \\frac{\\partial \\boldsymbol{d}}{\\partial \\boldsymbol{u}_m} = \\frac{\\partial \\boldsymbol{r}_s}{\\partial \\boldsymbol{d}} (-I) = -\\frac{\\partial \\boldsymbol{r}_s}{\\partial \\boldsymbol{u}_s}$。因此，我们只需要推导雅可比块 $K_{ss} = \\frac{\\partial \\boldsymbol{r}_s}{\\partial \\boldsymbol{u}_s}$。\n\n$\\boldsymbol{r}_s$ 关于 $\\boldsymbol{u}_s$ 沿方向 $\\Delta \\boldsymbol{u}_s$ 变化的 方向导数为：\n$$\nD_{\\boldsymbol{u}_s}\\boldsymbol{r}_s[\\Delta \\boldsymbol{u}_s] = -D_{\\boldsymbol{u}_s}\\mathbf{t}[\\Delta \\boldsymbol{u}_s] = -\\left( (D_{\\boldsymbol{u}_s}t_n[\\Delta \\boldsymbol{u}_s]) \\boldsymbol{n} + (D_{\\boldsymbol{u}_s}\\tau[\\Delta \\boldsymbol{u}_s]) \\boldsymbol{t} \\right)\n$$\n我们必须求出法向应力 $t_n$ 和切向应力 $\\tau$ 的方向导数。这些导数依赖于由预测值 $y_n$ 和 $y_t$ 决定的试探状态。\n\n首先，我们确定运动学量和预测值的变分。\n法向和切向间隙 $g_n$ 和 $g_t$ 关于变分 $\\Delta \\boldsymbol{u}_s$ 的变分为：\n$$\n\\Delta g_n = D_{\\boldsymbol{u}_s}g_n[\\Delta \\boldsymbol{u}_s] = D_{\\boldsymbol{u}_s}(-\\boldsymbol{n}^\\top (\\boldsymbol{u}_s - \\boldsymbol{u}_m))[\\Delta \\boldsymbol{u}_s] = -\\boldsymbol{n}^\\top \\Delta \\boldsymbol{u}_s\n$$\n$$\n\\Delta g_t = D_{\\boldsymbol{u}_s}g_t[\\Delta \\boldsymbol{u}_s] = D_{\\boldsymbol{u}_s}(\\boldsymbol{t}^\\top (\\boldsymbol{u}_s - \\boldsymbol{u}_m))[\\Delta \\boldsymbol{u}_s] = \\boldsymbol{t}^\\top \\Delta \\boldsymbol{u}_s\n$$\n拉格朗日乘子 $\\lambda_n$ 和 $\\lambda_t$ 保持不变。因此，预测值 $y_n$ 和 $y_t$ 的变分为：\n$$\n\\Delta y_n = \\varepsilon_n \\Delta g_n = -\\varepsilon_n \\boldsymbol{n}^\\top \\Delta \\boldsymbol{u}_s\n$$\n$$\n\\Delta y_t = \\varepsilon_t \\Delta g_t = \\varepsilon_t \\boldsymbol{t}^\\top \\Delta \\boldsymbol{u}_s\n$$\n$t_n$ 和 $\\tau$ 的导数是非光滑的，且依赖于激活集。我们逐一分析各种情况。\n\n情况1：接触打开 ($y_n \\leq 0$)\n在此状态下，$t_n = \\langle y_n \\rangle_+ = 0$。摩擦界限为 $b = \\mu t_n = 0$。切向应力为 $\\tau = \\operatorname{clamp}(y_t, -b, b) = 0$。总应力为 $\\mathbf{t} = 0$，因此残差 $\\boldsymbol{r}_s = 0$。所以，切线刚度为零矩阵：\n$$\nK_{ss} = \\frac{\\partial \\boldsymbol{r}_s}{\\partial \\boldsymbol{u}_s} = 0\n$$\n\n情况2：接触闭合 ($y_n  0$)\n此时，$t_n = y_n$。方向导数为：\n$$\nD_{\\boldsymbol{u}_s}t_n[\\Delta \\boldsymbol{u}_s] = \\Delta y_n = -\\varepsilon_n \\boldsymbol{n}^\\top \\Delta \\boldsymbol{u}_s \\implies \\frac{\\partial t_n}{\\partial \\boldsymbol{u}_s} = -\\varepsilon_n \\boldsymbol{n}^\\top\n$$\n摩擦界限 $b = \\mu t_n$ 的变分为：\n$$\n\\Delta b = \\mu \\Delta t_n = -\\mu \\varepsilon_n \\boldsymbol{n}^\\top \\Delta \\boldsymbol{u}_s\n$$\n切向应力 $\\tau = \\operatorname{clamp}(y_t, -b, b)$ 的导数取决于粘滞/滑移状态。\n\n子情况2a：粘滞 ($|y_t|  b$)\n在粘滞状态下，$\\tau = y_t$。方向导数为：\n$$\nD_{\\boldsymbol{u}_s}\\tau[\\Delta \\boldsymbol{u}_s] = \\Delta y_t = \\varepsilon_t \\boldsymbol{t}^\\top \\Delta \\boldsymbol{u}_s \\implies \\frac{\\partial \\tau}{\\partial \\boldsymbol{u}_s} = \\varepsilon_t \\boldsymbol{t}^\\top\n$$\n代入残差变分的表达式中：\n$$\nD_{\\boldsymbol{u}_s}\\boldsymbol{r}_s[\\Delta \\boldsymbol{u}_s] = -\\left( (-\\varepsilon_n \\boldsymbol{n}^\\top \\Delta \\boldsymbol{u}_s) \\boldsymbol{n} + (\\varepsilon_t \\boldsymbol{t}^\\top \\Delta \\boldsymbol{u}_s) \\boldsymbol{t} \\right) = \\left( \\varepsilon_n \\boldsymbol{n} \\boldsymbol{n}^\\top + \\varepsilon_t \\boldsymbol{t} \\boldsymbol{t}^\\top \\right) \\Delta \\boldsymbol{u}_s\n$$\n切线刚度矩阵是对称的：\n$$\nK_{ss} = \\varepsilon_n \\boldsymbol{n} \\boldsymbol{n}^\\top + \\varepsilon_t \\boldsymbol{t} \\boldsymbol{t}^\\top\n$$\n\n子情况2b：正向滑移 ($y_t \\geq b$)\n在正向滑移状态下，$\\tau = b = \\mu t_n$。方向导数为：\n$$\nD_{\\boldsymbol{u}_s}\\tau[\\Delta \\boldsymbol{u}_s] = \\Delta b = -\\mu \\varepsilon_n \\boldsymbol{n}^\\top \\Delta \\boldsymbol{u}_s \\implies \\frac{\\partial \\tau}{\\partial \\boldsymbol{u}_s} = -\\mu \\varepsilon_n \\boldsymbol{n}^\\top\n$$\n残差变分为：\n$$\nD_{\\boldsymbol{u}_s}\\boldsymbol{r}_s[\\Delta \\boldsymbol{u}_s] = -\\left( (-\\varepsilon_n \\boldsymbol{n}^\\top \\Delta \\boldsymbol{u}_s) \\boldsymbol{n} + (-\\mu \\varepsilon_n \\boldsymbol{n}^\\top \\Delta \\boldsymbol{u}_s) \\boldsymbol{t} \\right) = \\left( \\varepsilon_n \\boldsymbol{n} \\boldsymbol{n}^\\top + \\mu \\varepsilon_n \\boldsymbol{t} \\boldsymbol{n}^\\top \\right) \\Delta \\boldsymbol{u}_s\n$$\n切线刚度矩阵是非对称的：\n$$\nK_{ss} = \\varepsilon_n (\\boldsymbol{n} \\boldsymbol{n}^\\top + \\mu \\boldsymbol{t} \\boldsymbol{n}^\\top) = \\varepsilon_n(\\boldsymbol{n} + \\mu \\boldsymbol{t})\\boldsymbol{n}^\\top\n$$\n\n子情况2c：反向滑移 ($y_t \\leq -b$)\n在反向滑移状态下，$\\tau = -b = -\\mu t_n$。方向导数为：\n$$\nD_{\\boldsymbol{u}_s}\\tau[\\Delta \\boldsymbol{u}_s] = -\\Delta b = -(-\\mu \\varepsilon_n \\boldsymbol{n}^\\top \\Delta \\boldsymbol{u}_s) = \\mu \\varepsilon_n \\boldsymbol{n}^\\top \\Delta \\boldsymbol{u}_s \\implies \\frac{\\partial \\tau}{\\partial \\boldsymbol{u}_s} = \\mu \\varepsilon_n \\boldsymbol{n}^\\top\n$$\n残差变分为：\n$$\nD_{\\boldsymbol{u}_s}\\boldsymbol{r}_s[\\Delta \\boldsymbol{u}_s] = -\\left( (-\\varepsilon_n \\boldsymbol{n}^\\top \\Delta \\boldsymbol{u}_s) \\boldsymbol{n} + (\\mu \\varepsilon_n \\boldsymbol{n}^\\top \\Delta \\boldsymbol{u}_s) \\boldsymbol{t} \\right) = \\left( \\varepsilon_n \\boldsymbol{n} \\boldsymbol{n}^\\top - \\mu \\varepsilon_n \\boldsymbol{t} \\boldsymbol{n}^\\top \\right) \\Delta \\boldsymbol{u}_s\n$$\n切线刚度矩阵也是非对称的：\n$$\nK_{ss} = \\varepsilon_n (\\boldsymbol{n} \\boldsymbol{n}^\\top - \\mu \\boldsymbol{t} \\boldsymbol{n}^\\top) = \\varepsilon_n(\\boldsymbol{n} - \\mu \\boldsymbol{t})\\boldsymbol{n}^\\top\n$$\n\n现在，我们使用给定的数据来计算这个具体案例。\n已知：$\\varepsilon_{n} = 2.5 \\times 10^{6}$，$\\varepsilon_{t} = 1.0 \\times 10^{6}$，$\\mu = 0.3$，$\\lambda_{n} = 150$，$\\lambda_{t} = 50$。\n从节点位移 $\\boldsymbol{u}_{s} = \\begin{bmatrix} 4.0 \\times 10^{-4} \\\\ -3.0 \\times 10^{-4} \\end{bmatrix}$。\n主节点位移 $\\boldsymbol{u}_{m} = \\begin{bmatrix} 5.0 \\times 10^{-5} \\\\ -1.0 \\times 10^{-4} \\end{bmatrix}$。\n向量 $\\boldsymbol{n} = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}$，$\\boldsymbol{t} = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix}$。\n\n1.  计算相对位移 $\\boldsymbol{d}$:\n    $$\n    \\boldsymbol{d} = \\boldsymbol{u}_s - \\boldsymbol{u}_m = \\begin{bmatrix} 4.0 \\times 10^{-4} - 5.0 \\times 10^{-5} \\\\ -3.0 \\times 10^{-4} - (-1.0 \\times 10^{-4}) \\end{bmatrix} = \\begin{bmatrix} 3.5 \\times 10^{-4} \\\\ -2.0 \\times 10^{-4} \\end{bmatrix}\n    $$\n2.  计算间隙 $g_n$ 和 $g_t$:\n    $$\n    g_n = -\\boldsymbol{n}^\\top \\boldsymbol{d} = - \\begin{bmatrix} 0  1 \\end{bmatrix} \\begin{bmatrix} 3.5 \\times 10^{-4} \\\\ -2.0 \\times 10^{-4} \\end{bmatrix} = 2.0 \\times 10^{-4}\n    $$\n    $$\n    g_t = \\boldsymbol{t}^\\top \\boldsymbol{d} = \\begin{bmatrix} 1  0 \\end{bmatrix} \\begin{bmatrix} 3.5 \\times 10^{-4} \\\\ -2.0 \\times 10^{-4} \\end{bmatrix} = 3.5 \\times 10^{-4}\n    $$\n3.  计算预测值 $y_n$ 和 $y_t$:\n    $$\n    y_n = \\lambda_n + \\varepsilon_n g_n = 150 + (2.5 \\times 10^6)(2.0 \\times 10^{-4}) = 150 + 500 = 650\n    $$\n    $$\n    y_t = \\lambda_t + \\varepsilon_t g_t = 50 + (1.0 \\times 10^6)(3.5 \\times 10^{-4}) = 50 + 350 = 400\n    $$\n4.  确定接触和摩擦状态：\n    -   接触状态：由于 $y_n = 650  0$，接触是闭合的。\n    -   法向应力：$t_n = \\langle y_n \\rangle_+ = 650$。\n    -   摩擦界限：$b = \\mu t_n = 0.3 \\times 650 = 195$。\n    -   摩擦状态：由于 $y_t = 400  b = 195$，状态为**正向滑移**。\n\n5.  选择相应的切线刚度矩阵 $K_{ss}$：\n    对于正向滑移， $K_{ss} = \\varepsilon_n(\\boldsymbol{n} + \\mu \\boldsymbol{t})\\boldsymbol{n}^\\top$。我们使用给定的向量展开此式：\n    $$\n    K_{ss} = (2.5 \\times 10^{6}) \\left( \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix} + 0.3 \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix} \\right) \\begin{bmatrix} 0  1 \\end{bmatrix} = (2.5 \\times 10^{6}) \\begin{bmatrix} 0.3 \\\\ 1 \\end{bmatrix} \\begin{bmatrix} 0  1 \\end{bmatrix}\n    $$\n    $$\n    K_{ss} = (2.5 \\times 10^{6}) \\begin{bmatrix} 0  0.3 \\\\ 0  1 \\end{bmatrix} = \\begin{bmatrix} 0  0.75 \\times 10^{6} \\\\ 0  2.5 \\times 10^{6} \\end{bmatrix}\n    $$\n    矩阵 $K_{ss}$ 的分量为：\n    $$\n    K_{ss} = \\begin{bmatrix} \\frac{\\partial r_{s,x}}{\\partial u_{s,x}}  \\frac{\\partial r_{s,x}}{\\partial u_{s,y}} \\\\ \\frac{\\partial r_{s,y}}{\\partial u_{s,x}}  \\frac{\\partial r_{s,y}}{\\partial u_{s,y}} \\end{bmatrix}\n    $$\n    所求的雅可比标量项是该矩阵的 $(2,2)$ 分量：\n    $$\n    \\frac{\\partial r_{s,y}}{\\partial u_{s,y}} = 2.5 \\times 10^{6}\n    $$\n    四舍五入至四位有效数字得到 $2.500 \\times 10^{6}$。其隐含单位为 $\\mathrm{N/m}$。",
            "answer": "$$\\boxed{2.500 \\times 10^{6}}$$"
        }
    ]
}