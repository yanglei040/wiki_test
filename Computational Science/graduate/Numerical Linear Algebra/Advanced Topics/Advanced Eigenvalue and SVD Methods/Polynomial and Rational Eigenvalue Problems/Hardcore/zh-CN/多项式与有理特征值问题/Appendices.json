{
    "hands_on_practices": [
        {
            "introduction": "本练习旨在巩固核心概念：如何将一个有理特征值问题（REP）转化为等价的广义线性特征值问题。这个被称为“线性化”的过程，是应用强大的线性代数工具来解决这类非线性问题的关键第一步。通过从第一性原理出发构建一个最小实现，你将深入理解有理矩阵函数与其线性化表示之间的内在联系 。",
            "id": "3565395",
            "problem": "设 $r(\\lambda) = 1 + \\dfrac{2}{\\lambda - 1} - \\dfrac{1}{\\lambda + 1}$ 且 $R(\\lambda) = r(\\lambda) I_{2}$，其中 $I_{2}$ 表示 $2 \\times 2$ 单位矩阵。仅使用有理矩阵函数实现的基本定义，即具有实数矩阵的描述符实现 $(A,E,B,C,D)$ 满足\n$$\nR(\\lambda) \\;=\\; D \\;+\\; C\\,(\\lambda E - A)^{-1}\\,B,\n$$\n构造一个显式的最小实现 $(A,E,B,C,D)$，其中 $E$ 是非奇异的，使得 $R(\\lambda)$ 的有限极点被 $(A,E)$ 捕获，并且直通项等于 $I_{2}$。从第一性原理出发证明你的构造，包括极点处的留数如何决定分块的大小和结构。\n\n然后，通过求解限制在与 $R(\\lambda)$ 的严格真有理部分相关的不变子空间上的广义特征值问题 $\\det(A - \\lambda E) = 0$，计算所有有限广义特征值（包括代数重数）。将特征值按升序排列在一个单行矩阵中，并根据其代数重数重复取值。\n\n你的最终答案必须是一个由数字组成的单行矩阵。无需四舍五入。",
            "solution": "该问题要求为给定的有理矩阵函数 $R(\\lambda)$ 构造一个最小描述符实现，并随后计算所得系统矩阵束 $(A,E)$ 的有限广义特征值。\n\n**步骤 1：问题验证**\n\n已知条件如下：\n- $r(\\lambda) = 1 + \\dfrac{2}{\\lambda - 1} - \\dfrac{1}{\\lambda + 1}$\n- $R(\\lambda) = r(\\lambda) I_{2}$，其中 $I_{2}$ 是 $2 \\times 2$ 单位矩阵。\n- 实现形式为描述符系统：$R(\\lambda) = D + C(\\lambda E - A)^{-1}B$。\n- 实现 $(A,E,B,C,D)$ 所需的性质是：它必须是最小的，$E$ 必须是非奇异的，并且直通项 $D$ 必须为 $I_2$。\n- 任务是构造这个实现，然后求解广义特征值问题 $\\det(A - \\lambda E) = 0$ 以得到有限特征值。\n\n该问题在科学上植根于线性系统理论和数值线性代数领域。有理传递函数的最小状态空间或描述符实现的概念是这些领域的基石。该问题是适定的、客观的、自洽的，没有矛盾或歧义。它是在应用基本原理方面的一个标准练习。因此，该问题被认为是有效的。\n\n**步骤 2：有理矩阵函数的分解**\n\n给定的有理矩阵函数为 $R(\\lambda) = r(\\lambda) I_2$。我们代入 $r(\\lambda)$ 的表达式：\n$$\nR(\\lambda) = \\left(1 + \\dfrac{2}{\\lambda - 1} - \\dfrac{1}{\\lambda + 1}\\right) I_2\n$$\n我们可以将其分解为一个常数项（当 $\\lambda \\to \\infty$ 时的值）和一个严格真有理部分（当 $\\lambda \\to \\infty$ 时趋于零）。\n$$\nR(\\lambda) = 1 \\cdot I_2 + \\left(\\dfrac{2}{\\lambda - 1} - \\dfrac{1}{\\lambda + 1}\\right) I_2\n$$\n问题规定直通项 $D$ 必须为 $I_2$。这与分解相符，因此我们确定：\n- 直通项：$D = I_2$。\n- 严格真有理部分：$R_{sp}(\\lambda) = \\left(\\dfrac{2}{\\lambda - 1} - \\dfrac{1}{\\lambda + 1}\\right) I_2$。\n\n我们现在的任务是找到一个最小实现 $(A,E,B,C)$，其中 $E$ 非奇异，使得 $C(\\lambda E - A)^{-1}B = R_{sp}(\\lambda)$。\n\n**步骤 3：从第一性原理构造最小实现**\n\n$R_{sp}(\\lambda)$ 的最小实现的构造基于其部分分式展开。该函数有两个单极点，$p_1 = 1$ 和 $p_2 = -1$。我们可以将 $R_{sp}(\\lambda)$ 写成：\n$$\nR_{sp}(\\lambda) = \\frac{1}{\\lambda-1}K_1 + \\frac{1}{\\lambda-p_2}K_2 = \\frac{1}{\\lambda - 1}(2I_2) + \\frac{1}{\\lambda - (-1)}(-I_2)\n$$\n这里，留数矩阵为 $K_1 = 2I_2$ 和 $K_2 = -I_2$。\n\n根据实现理论，对于一个表示为对应于不同单极点的项之和的有理函数，可以通过组合每个单独项的最小实现来构造一个最小实现。最小实现的状态空间维数，称为麦克米兰阶 $\\delta(R)$，是每个极点处局部阶数的总和。对于单极点，在 $p_i$ 处的局部阶数由相应留数矩阵 $K_i$ 的秩给出。\n\n我们来计算留数矩阵的秩：\n- 对于极点 $p_1 = 1$，留数为 $K_1 = 2I_2 = \\begin{pmatrix} 2 & 0 \\\\ 0 & 2 \\end{pmatrix}$。其秩为 $\\text{rank}(K_1) = 2$。\n- 对于极点 $p_2 = -1$，留数为 $K_2 = -I_2 = \\begin{pmatrix} -1 & 0 \\\\ 0 & -1 \\end{pmatrix}$。其秩为 $\\text{rank}(K_2) = 2$。\n\n$R(\\lambda)$ 的麦克米兰阶为 $\\delta(R) = \\text{rank}(K_1) + \\text{rank}(K_2) = 2 + 2 = 4$。这意味着最小实现的状态空间维数为 $4$。矩阵 $A$ 和 $E$ 将是 $4 \\times 4$ 的。\n\n对于每一项 $\\frac{K_i}{\\lambda-p_i}$，可以构造一个最小实现 $(A_i, E_i, B_i, C_i)$，其中 $E_i$ 非奇异。我们要求 $C_i(\\lambda E_i - A_i)^{-1}B_i = \\frac{K_i}{\\lambda-p_i}$。当 $E_i=I_{r_i}$（其中 $r_i = \\text{rank}(K_i)$）时，一个标准的选择是使用留数的满秩分解，$K_i = C_i B_i$，其中 $C_i$ 是 $m \\times r_i$ 矩阵，$B_i$ 是 $r_i \\times m$ 矩阵。然后实现由 $A_i=p_i I_{r_i}$、$E_i=I_{r_i}$以及因子 $B_i, C_i$ 给出。\n\n对于 $p_1 = 1$：$r_1=2$。我们分解 $K_1 = 2I_2$。一个简单的分解是 $C_1 = 2I_2$ 和 $B_1 = I_2$。\n- $A_1 = p_1 I_{r_1} = 1 \\cdot I_2 = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}$\n- $E_1 = I_{r_1} = I_2$\n- $B_1 = I_2 = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}$\n- $C_1 = 2I_2 = \\begin{pmatrix} 2 & 0 \\\\ 0 & 2 \\end{pmatrix}$\n\n对于 $p_2 = -1$：$r_2=2$。我们分解 $K_2 = -I_2$。一个简单的分解是 $C_2 = -I_2$ 和 $B_2 = I_2$。\n- $A_2 = p_2 I_{r_2} = -1 \\cdot I_2 = \\begin{pmatrix} -1 & 0 \\\\ 0 & -1 \\end{pmatrix}$\n- $E_2 = I_{r_2} = I_2$\n- $B_2 = I_2 = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}$\n- $C_2 = -I_2 = \\begin{pmatrix} -1 & 0 \\\\ 0 & -1 \\end{pmatrix}$\n\n求和项 $R_{sp}(\\lambda)$ 的总实现通过组合这些分块得到：\n$A = \\begin{pmatrix} A_1 & 0 \\\\ 0 & A_2 \\end{pmatrix} = \\begin{pmatrix} 1 \\cdot I_2 & 0 \\\\ 0 & -1 \\cdot I_2 \\end{pmatrix} = \\begin{pmatrix} 1 & 0 & 0 & 0 \\\\ 0 & 1 & 0 & 0 \\\\ 0 & 0 & -1 & 0 \\\\ 0 & 0 & 0 & -1 \\end{pmatrix}$\n$E = \\begin{pmatrix} E_1 & 0 \\\\ 0 & E_2 \\end{pmatrix} = \\begin{pmatrix} I_2 & 0 \\\\ 0 & I_2 \\end{pmatrix} = I_4$\n$B = \\begin{pmatrix} B_1 \\\\ B_2 \\end{pmatrix} = \\begin{pmatrix} I_2 \\\\ I_2 \\end{pmatrix} = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\\\ 1 & 0 \\\\ 0 & 1 \\end{pmatrix}$\n$C = \\begin{pmatrix} C_1 & C_2 \\end{pmatrix} = \\begin{pmatrix} 2I_2 & -I_2 \\end{pmatrix} = \\begin{pmatrix} 2 & 0 & -1 & 0 \\\\ 0 & 2 & 0 & -1 \\end{pmatrix}$\n\n该实现是最小的，因为其维数 ($4$) 等于麦克米兰阶。它满足 $E$ 是非奇异的条件 ($E=I_4$)。直通项是 $D=I_2$。因此，我们构造了所要求的实现 $(A,E,B,C,D)$。\n\n**步骤 4：有限广义特征值的计算**\n\n该实现的有限广义特征值是广义特征值问题 $\\det(A - \\lambda E) = 0$ 的解 $\\lambda$。使用上面推导出的矩阵 $A$ 和 $E$：\n$$\nA - \\lambda E = \\begin{pmatrix} 1 & 0 & 0 & 0 \\\\ 0 & 1 & 0 & 0 \\\\ 0 & 0 & -1 & 0 \\\\ 0 & 0 & 0 & -1 \\end{pmatrix} - \\lambda \\begin{pmatrix} 1 & 0 & 0 & 0 \\\\ 0 & 1 & 0 & 0 \\\\ 0 & 0 & 1 & 0 \\\\ 0 & 0 & 0 & 1 \\end{pmatrix} = \\begin{pmatrix} 1-\\lambda & 0 & 0 & 0 \\\\ 0 & 1-\\lambda & 0 & 0 \\\\ 0 & 0 & -1-\\lambda & 0 \\\\ 0 & 0 & 0 & -1-\\lambda \\end{pmatrix}\n$$\n这个对角矩阵的行列式是其对角元素的乘积：\n$$\n\\det(A - \\lambda E) = (1-\\lambda)(1-\\lambda)(-1-\\lambda)(-1-\\lambda) = (1-\\lambda)^2 (- (1+\\lambda))^2 = (1-\\lambda)^2 (1+\\lambda)^2\n$$\n将行列式设为零得到特征方程 $(1-\\lambda)^2 (1+\\lambda)^2 = 0$。该方程的根即为特征值：\n- $\\lambda = 1$，代数重数为 $2$。\n- $\\lambda = -1$，代数重数为 $2$。\n\n正如预期的那样，最小实现的有限特征值恰好是有理函数 $R(\\lambda)$ 的极点，并且它们的代数重数与相应留数矩阵的秩相匹配。\n\n问题要求将特征值按升序排列在一个单行矩阵中，并根据其重数重复取值。排序后的特征值列表是 $-1, -1, 1, 1$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -1 & -1 & 1 & 1 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "并非所有的特征值问题都是“正则”的。本练习将引导你处理奇异二次特征值问题（QEP），其特点是首项系数矩阵奇异，从而导致无限特征值的出现。你将学习一种系统性的解耦方法，通过秩亏分解，将决定有限特征值的正则部分与决定无限特征值的部分分离开来 。",
            "id": "3565397",
            "problem": "考虑由矩阵多项式 $P(\\lambda) = \\lambda^{2} M + \\lambda C + K$ 定义的二次特征值问题 (QEP)，其中\n$$\nM = \\begin{pmatrix}\n1 & 0 & 0\\\\\n0 & 1 & 0\\\\\n0 & 0 & 0\n\\end{pmatrix}, \\quad\nC = \\begin{pmatrix}\n2 & -1 & 0\\\\\n3 & 4 & 0\\\\\n0 & 0 & 6\n\\end{pmatrix}, \\quad\nK = \\begin{pmatrix}\n3 & 1 & 0\\\\\n0 & 5 & 0\\\\\n0 & 0 & -9\n\\end{pmatrix}.\n$$\n从基本定义出发：一个特征值 $\\lambda \\in \\mathbb{C}$ (有限或无穷) 满足 $\\det\\!\\big(P(\\lambda)\\big) = 0$，而无穷大特征值通过反转多项式 $R(\\mu) = \\mu^{2} P(1/\\mu)$ 定义。仅使用这些基础知识以及关于正交变换和秩-揭示分解的成熟线性代数事实，完成以下任务。\n\n1. 使用秩-揭示分解，例如奇异值分解 (SVD) 或列主元分解，构造正交矩阵 $U$ 和 $V$ 以及变换后系数\n$$\n\\widehat{M} = U^{\\top} M V, \\quad \\widehat{C} = U^{\\top} C V, \\quad \\widehat{K} = U^{\\top} K V,\n$$\n的分块，以分离 $M$ 的零奇异子空间，使得\n$$\n\\widehat{M} = \\begin{pmatrix} I_{r} & 0\\\\ 0 & 0 \\end{pmatrix}\n$$\n其中 $r$ 等于 $M$ 的秩。明确报告 $U$、$V$、$r$ 以及 $\\widehat{C}$ 和 $\\widehat{K}$ 的相应分块。\n\n2. 基于此分解，构建有限部分的降阶正则 QEP，\n$$\nP_{r}(\\lambda) = \\lambda^{2} I_{r} + \\lambda \\widehat{C}_{11} + \\widehat{K}_{11},\n$$\n并从第一性原理出发，解释为什么 $P(\\lambda)$ 的有限特征值与 $P_{r}(\\lambda)$ 的有限特征值以及由右下方严格低阶的降阶标量或块因子（若有）产生的特征值的并集相吻合。\n\n3. 对于给定数据，明确确认恰好有一个无穷大特征值，并识别出由右下角分块产生的有限因子。\n\n4. 计算原始 QEP $P(\\lambda)$ 的所有有限特征值的乘积。以精确的简化分数形式表示你的最终答案。无需四舍五入，不涉及单位。你的最终答案必须是一个实数。",
            "solution": "用户希望我解决一个关于二次特征值问题 (QEP) 的问题。我将首先验证问题，然后进行解答。\n\n### 问题验证\n\n**第1步：提取已知条件**\n\n-   QEP 由 $P(\\lambda) = \\lambda^{2} M + \\lambda C + K$ 定义。\n-   矩阵给定如下\n    $$\n    M = \\begin{pmatrix}\n    1 & 0 & 0\\\\\n    0 & 1 & 0\\\\\n    0 & 0 & 0\n    \\end{pmatrix}, \\quad\n    C = \\begin{pmatrix}\n    2 & -1 & 0\\\\\n    3 & 4 & 0\\\\\n    0 & 0 & 6\n    \\end{pmatrix}, \\quad\n    K = \\begin{pmatrix}\n    3 & 1 & 0\\\\\n    0 & 5 & 0\\\\\n    0 & 0 & -9\n    \\end{pmatrix}.\n    $$\n-   一个特征值 $\\lambda$ 满足 $\\det(P(\\lambda)) = 0$。\n-   无穷大特征值通过反转多项式 $R(\\mu) = \\mu^{2} P(1/\\mu)$ 定义。\n-   任务1：找到正交矩阵 $U$ 和 $V$ 以将 $M$ 变换为 $\\widehat{M} = U^{\\top} M V = \\begin{pmatrix} I_{r} & 0\\\\ 0 & 0 \\end{pmatrix}$，其中 $r = \\text{rank}(M)$。报告 $U$、$V$、$r$ 以及分块后的 $\\widehat{C} = U^{\\top} C V$ 和 $\\widehat{K} = U^{\\top} K V$。\n-   任务2：构建降阶 QEP $P_{r}(\\lambda) = \\lambda^{2} I_{r} + \\lambda \\widehat{C}_{11} + \\widehat{K}_{11}$ 并解释为什么它的特征值，与一个低阶因子的特征值相结合，构成了 $P(\\lambda)$ 的有限特征值。\n-   任务3：确认恰好有一个无穷大特征值，并识别出右下角分块产生的有限因子。\n-   任务4：计算 $P(\\lambda)$ 的所有有限特征值的乘积。\n\n**第2步：使用提取的已知条件进行验证**\n\n-   **科学依据：** 该问题是数值线性代数中的一个标准练习，涉及奇异二次特征值问题。所有概念（QEP、秩-揭示分解、反转多项式、特征值）都是成熟的数学原理。\n-   **适定性：** 问题陈述清晰，包含了所有必要的数据和定义。任务明确，可以导出一个确定且唯一的数值答案。\n-   **客观性：** 问题以精确、客观的数学语言表述。\n-   **缺陷分析：**\n    1.  **科学/事實不准确：** 无。前提在数学上是合理的。\n    2.  **不可形式化/不相关：** 无。该问题是形式化的，并且与多项式特征值问题直接相关。\n    3.  **不完整/矛盾：** 无。数据和任务是完整且一致的。\n    4.  **不切实际/不可行：** 无。这些矩阵在计算上很简单。\n    5.  **不适定/结构不良：** 无。问题结构良好，能導出唯一解。\n    6.  **伪深刻/琐碎：** 无。虽然特定的矩阵简化了某些步骤，但该问题需要正确应用奇异 QEP 的理论，这不是一个琐碎的练习。\n    7.  **超出科学可验证性范围：** 无。所有步骤和最终答案在数学上都是可验证的。\n\n**第3步：结论与行动**\n\n-   **结论：** 问题有效。\n-   **行动：** 进行完整解答。\n\n### 解答\n\n二次特征值问题 (QEP) 由 $P(\\lambda)v = 0$ 给出，其中 $P(\\lambda) = \\lambda^{2} M + \\lambda C + K$，$v$ 是一个非零特征向量。特征值 $\\lambda$ 是特征方程 $\\det(P(\\lambda)) = 0$ 的根。矩阵 $M$ 是奇异的，这表明存在无穷大特征值。\n\n**1. 秩-揭示分解**\n\n首项系数矩阵为\n$$\nM = \\begin{pmatrix}\n1 & 0 & 0\\\\\n0 & 1 & 0\\\\\n0 & 0 & 0\n\\end{pmatrix}.\n$$\n$M$ 的秩为 $r=2$。矩阵 $M$ 已经处于秩-揭示分解所需的对角形式。因此，我们可以选择正交矩阵 $U$ 和 $V$ 为 $3 \\times 3$ 的单位矩阵 $I_{3}$。\n$$\nU = V = I_{3} = \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}.\n$$\n变换后的系数为：\n$$\n\\widehat{M} = U^{\\top} M V = I_{3} M I_{3} = M = \\begin{pmatrix}\n1 & 0 & 0\\\\\n0 & 1 & 0\\\\\n0 & 0 & 0\n\\end{pmatrix} = \\begin{pmatrix} I_{2} & 0 \\\\ 0 & 0 \\end{pmatrix}.\n$$\n$$\n\\widehat{C} = U^{\\top} C V = I_{3} C I_{3} = C = \\begin{pmatrix}\n2 & -1 & 0\\\\\n3 & 4 & 0\\\\\n0 & 0 & 6\n\\end{pmatrix}.\n$$\n$$\n\\widehat{K} = U^{\\top} K V = I_{3} K I_{3} = K = \\begin{pmatrix}\n3 & 1 & 0\\\\\n0 & 5 & 0\\\\\n0 & 0 & -9\n\\end{pmatrix}.\n$$\n秩为 $r=2$。我们根据 $\\widehat{M}$ 的分块结构对 $\\widehat{C}$ 和 $\\widehat{K}$进行分块：\n$$\n\\widehat{C} = \\begin{pmatrix} \\widehat{C}_{11} & \\widehat{C}_{12} \\\\ \\widehat{C}_{21} & \\widehat{C}_{22} \\end{pmatrix} = \\begin{pmatrix} \\begin{pmatrix} 2 & -1 \\\\ 3 & 4 \\end{pmatrix} & \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} \\\\ \\begin{pmatrix} 0 & 0 \\end{pmatrix} & 6 \\end{pmatrix}.\n$$\n$$\n\\widehat{K} = \\begin{pmatrix} \\widehat{K}_{11} & \\widehat{K}_{12} \\\\ \\widehat{K}_{21} & \\widehat{K}_{22} \\end{pmatrix} = \\begin{pmatrix} \\begin{pmatrix} 3 & 1 \\\\ 0 & 5 \\end{pmatrix} & \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} \\\\ \\begin{pmatrix} 0 & 0 \\end{pmatrix} & -9 \\end{pmatrix}.\n$$\n因此我们得到以下分块：\n$\\widehat{C}_{11} = \\begin{pmatrix} 2 & -1 \\\\ 3 & 4 \\end{pmatrix}$，$\\widehat{C}_{12} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$，$\\widehat{C}_{21} = \\begin{pmatrix} 0 & 0 \\end{pmatrix}$，$\\widehat{C}_{22} = (6)$。\n$\\widehat{K}_{11} = \\begin{pmatrix} 3 & 1 \\\\ 0 & 5 \\end{pmatrix}$，$\\widehat{K}_{12} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$，$\\widehat{K}_{21} = \\begin{pmatrix} 0 & 0 \\end{pmatrix}$，$\\widehat{K}_{22} = (-9)$。\n\n**2. 降阶 QEP 与第一性原理解释**\n\n降阶正则 QEP 由左上角的分块构成：\n$$\nP_{r}(\\lambda) = \\lambda^{2} I_{r} + \\lambda \\widehat{C}_{11} + \\widehat{K}_{11} = \\lambda^{2} I_{2} + \\lambda \\begin{pmatrix} 2 & -1 \\\\ 3 & 4 \\end{pmatrix} + \\begin{pmatrix} 3 & 1 \\\\ 0 & 5 \\end{pmatrix}.\n$$\n为了解释有限特征值的来源，我们考虑变换后的多项式 $\\widehat{P}(\\lambda) = U^{\\top} P(\\lambda) V = \\lambda^2 \\widehat{M} + \\lambda \\widehat{C} + \\widehat{K}$。由于 $U$ 和 $V$ 是正交的，$\\det(U^{\\top})\\det(V) = (\\pm 1)(\\pm 1) \\neq 0$。因此，$\\det(P(\\lambda))=0$ 当且仅当 $\\det(\\widehat{P}(\\lambda))=0$。特征值在此变换下保持不变。\n将分块矩阵代入 $\\widehat{P}(\\lambda)$：\n$$\n\\widehat{P}(\\lambda) = \\lambda^2 \\begin{pmatrix} I_{r} & 0 \\\\ 0 & 0 \\end{pmatrix} + \\lambda \\begin{pmatrix} \\widehat{C}_{11} & \\widehat{C}_{12} \\\\ \\widehat{C}_{21} & \\widehat{C}_{22} \\end{pmatrix} + \\begin{pmatrix} \\widehat{K}_{11} & \\widehat{K}_{12} \\\\ \\widehat{K}_{21} & \\widehat{K}_{22} \\end{pmatrix} = \\begin{pmatrix} \\lambda^2 I_{r} + \\lambda \\widehat{C}_{11} + \\widehat{K}_{11} & \\lambda \\widehat{C}_{12} + \\widehat{K}_{12} \\\\ \\lambda \\widehat{C}_{21} + \\widehat{K}_{21} & \\lambda \\widehat{C}_{22} + \\widehat{K}_{22} \\end{pmatrix}.\n$$\n在我们的特定情况下，非对角块 $\\widehat{C}_{12}, \\widehat{C}_{21}, \\widehat{K}_{12}, \\widehat{K}_{21}$ 均为零。这使得 $\\widehat{P}(\\lambda)$ 成为块对角矩阵：\n$$\n\\widehat{P}(\\lambda) = \\begin{pmatrix} P_{r}(\\lambda) & 0 \\\\ 0 & \\lambda \\widehat{C}_{22} + \\widehat{K}_{22} \\end{pmatrix}.\n$$\n块对角矩阵的行列式是其对角块行列式的乘积：\n$$\n\\det(\\widehat{P}(\\lambda)) = \\det(P_{r}(\\lambda)) \\cdot \\det(\\lambda \\widehat{C}_{22} + \\widehat{K}_{22}).\n$$\n因此，一个有限的 $\\lambda$ 是 $P(\\lambda)$ 的特征值，当且仅当它是 $\\det(P_r(\\lambda))=0$ 的根或 $\\det(\\lambda \\widehat{C}_{22} + \\widehat{K}_{22})=0$ 的根。这表明 $P(\\lambda)$ 的有限特征值集合是降阶 QEP $P_{r}(\\lambda)$ 的特征值与线性束 $L(\\lambda) = \\lambda \\widehat{C}_{22} + \\widehat{K}_{22}$ 的特征值的并集。$L(\\lambda)$ 是严格低阶（本例中为1阶）的“右下角降阶因子”。\n\n**3. 无穷大特征值与有限因子识别**\n\n如果 $\\mu=0$ 是反转多项式 $R(\\mu) = \\mu^{2} P(1/\\mu) = M + \\mu C + \\mu^{2} K$ 的特征值，则存在无穷大特征值。这在 $\\det(R(0))=0$ 时发生。\n$$\nR(0) = M + 0 \\cdot C + 0 \\cdot K = M.\n$$\n我们计算 $\\det(M) = \\det\\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} = 0$。这证实了至少存在一个无穷大特征值。\n\n一个 $n \\times n$ QEP 的总特征值数量（有限和无穷）为 $2n$。此处 $n=3$，所以有 $2 \\times 3 = 6$ 个特征值。有限特征值的数量等于多项式 $\\det(P(\\lambda))$ 的次数。\n根据第2部分的因式分解，我们有：\n$$\n\\det(P(\\lambda)) = \\det(\\widehat{P}(\\lambda)) = \\det(P_{r}(\\lambda)) \\det(L(\\lambda)).\n$$\n$\\det(P_r(\\lambda))$ 的次数为 $2r = 2(2) = 4$，因为 $I_r$ 是可逆的。$\\det(L(\\lambda))$ 的次数为 $n-r=3-2=1$，因为 $\\widehat{C}_{22}=(6)$ 是可逆的。\n$\\det(P(\\lambda))$ 的总次数为 $4+1 = 5$。\n由于总共有 $6$ 个特征值和 $5$ 个有限特征值，所以必定恰好有 $6 - 5 = 1$ 个无穷大特征值。\n\n由右下角分块产生的有限因子是线性多项式 $L(\\lambda) = \\lambda \\widehat{C}_{22} + \\widehat{K}_{22}$。代入标量块，我们得到：\n$$\nL(\\lambda) = \\lambda (6) + (-9) = 6\\lambda - 9.\n$$\n\n**4. 有限特征值的乘积**\n\n$P(\\lambda)$ 的有限特征值是 $\\det(P(\\lambda))=0$ 的根。这些根的乘積可以通过计算行列式因式分解中每个因子的根的乘积来得到。\n$\\det(L(\\lambda))=6\\lambda - 9 = 0$ 的根的乘积就是其唯一的根 $\\lambda_1 = 9/6 = 3/2$。\n\n$\\det(P_r(\\lambda))=0$ 的根的乘积可以从正则多项式特征值问题的一个已知结果得到。对于一个正则 QEP $Q(\\lambda) = \\lambda^2 A + \\lambda B + C$，其 $2r$ 个特征值的乘积由 $\\det(C)/\\det(A)$ 给出。对于 $P_r(\\lambda)$，首项系数是 $I_r=I_2$，常数项是 $\\widehat{K}_{11}$。其4个特征值的乘积是：\n$$\n\\prod_{i=2}^{5} \\lambda_i = \\frac{\\det(\\widehat{K}_{11})}{\\det(I_2)} = \\det(\\widehat{K}_{11}).\n$$\n我们有 $\\widehat{K}_{11} = \\begin{pmatrix} 3 & 1 \\\\ 0 & 5 \\end{pmatrix}$，所以 $\\det(\\widehat{K}_{11}) = (3)(5) - (1)(0) = 15$。\n\n原始 QEP 的所有有限特征值的乘积是来自两个因子的特征值的乘积：\n$$\n\\text{Product} = \\left(\\frac{3}{2}\\right) \\times (15) = \\frac{45}{2}.\n$$\n作为验算，我们可以完整写出 $\\det(P(\\lambda))$：\n$$\n\\det(P_r(\\lambda)) = \\det\\begin{pmatrix} \\lambda^2+2\\lambda+3 & -\\lambda+1 \\\\ 3\\lambda & \\lambda^2+4\\lambda+5 \\end{pmatrix} = (\\lambda^2+2\\lambda+3)(\\lambda^2+4\\lambda+5) - (3\\lambda)(-\\lambda+1) = \\lambda^4 + 6\\lambda^3 + 19\\lambda^2 + 19\\lambda + 15.\n$$\n根的乘积是 $15/1=15$。\n$$\n\\det(P(\\lambda)) = (6\\lambda - 9)(\\lambda^4 + 6\\lambda^3 + 19\\lambda^2 + 19\\lambda + 15) = 6\\lambda^5 + 27\\lambda^4 + \\dots - 135.\n$$\n这个多项式的根的乘积是 $(-1)^5 \\frac{-135}{6} = \\frac{135}{6} = \\frac{45}{2}$。这验证了结果。\n最终答案是一个精确的简化分数。",
            "answer": "$$\n\\boxed{\\frac{45}{2}}\n$$"
        },
        {
            "introduction": "从理论走向计算，本练习将指导你实现一个基于围线积分的先进数值算法。该方法在寻找复平面内特定区域的所有特征值方面非常高效，它展示了科学计算中用于解决非线性特征值问题的现代技术。通过亲手实现，你将体会到数值积分、奇异值分解和投影技术如何协同工作，以精确捕获目标的谱信息 。",
            "id": "3565422",
            "problem": "实现一个完整的程序，该程序使用在圆上通过梯形求积计算的围线积分矩来近似二次特征值问题（QEP）的选定特征值，然后求解一个小的投影广义特征值问题。二次特征值问题由形式为 $P(\\lambda) = \\lambda^2 M_2 + \\lambda M_1 + M_0$ 的矩阵多项式 $P(\\lambda) \\in \\mathbb{C}^{n \\times n}$ 定义，其中 $M_2$、$M_1$ 和 $M_0$ 是常数矩阵。本任务中的目标QEP是一个对角情形，其中 $n=3$，其构造使得其精确特征值是先验已知的。\n\n您必须从以下基本基础开始：\n- 二次特征值问题旨在寻找标量 $\\lambda \\in \\mathbb{C}$ 和非零向量 $x \\in \\mathbb{C}^n$，使得 $P(\\lambda)x = 0$。\n- 与闭合围线 $\\Gamma$ 内部的 $P(\\lambda)$ 的特征值相关的谱投影算子由围线积分 $S_0 = \\frac{1}{2\\pi i} \\oint_{\\Gamma} P(\\lambda)^{-1} \\, d\\lambda$ 给出，前提是对于所有在 $\\Gamma$ 上的 $\\lambda$，$P(\\lambda)$ 都是可逆的。\n- 一阶矩为 $S_1 = \\frac{1}{2\\pi i} \\oint_{\\Gamma} \\lambda P(\\lambda)^{-1} \\, d\\lambda$。\n- 如果围线包含一组特征值 $\\{\\lambda_j\\}_{j=1}^m$ 和相应的特征投影算子，则 $S_0$ 的秩为 $m$，并且在 $S_0$ 的值域上，由 $S_1$ 导出的算子的行为类似于乘以所包含的特征值。因此，可以通过将 $S_1$ 投影到 $S_0$ 的值域上来获得所包含特征值的近似值。\n\n您的程序必须实现以下数值方法：\n1. 构建 $3\\times 3$ 的 QEP $P(\\lambda) = \\lambda^2 M_2 + \\lambda M_1 + M_0$，其中 $M_2 = I_3$ 是单位矩阵，对角矩阵 $M_1$ 和 $M_0$ 的定义使得 $P(\\lambda)$ 的精确特征值为六个实标量 $\\{-1, 2, 3, 4, -2, 5\\}$。具体来说，令 $(\\alpha_1,\\beta_1)=(-1,2)$、$(\\alpha_2,\\beta_2)=(3,4)$ 和 $(\\alpha_3,\\beta_3)=(-2,5)$，并定义对角项 $p_i(\\lambda) = \\lambda^2 - (\\alpha_i+\\beta_i)\\lambda + \\alpha_i \\beta_i$，使得 $M_1 = -\\mathrm{diag}(\\alpha_1+\\beta_1,\\alpha_2+\\beta_2,\\alpha_3+\\beta_3)$ 且 $M_0 = \\mathrm{diag}(\\alpha_1\\beta_1,\\alpha_2\\beta_2,\\alpha_3\\beta_3)$。\n2. 对于由参数化 $\\lambda(\\theta) = c + r e^{i\\theta}$（中心为 $c \\in \\mathbb{C}$，半径为 $r>0$）给出的给定圆 $\\Gamma$，使用具有 $N$ 个等距节点 $\\theta_j = \\frac{2\\pi j}{N}$（其中 $j=0,1,\\dots,N-1$）的梯形法则来组装矩矩阵\n   $$C_0 \\approx \\frac{1}{2\\pi i} \\oint_{\\Gamma} P(\\lambda)^{-1} \\, d\\lambda, \\quad C_1 \\approx \\frac{1}{2\\pi i} \\oint_{\\Gamma} \\lambda P(\\lambda)^{-1} \\, d\\lambda,$$\n   具体计算如下：\n   $$C_k \\approx \\frac{r}{N} \\sum_{j=0}^{N-1} e^{i\\theta_j} \\lambda(\\theta_j)^k P(\\lambda(\\theta_j))^{-1}, \\quad k \\in \\{0,1\\}.$$\n   此公式由 $\\frac{1}{2\\pi i} \\oint_{\\Gamma} g(\\lambda)\\, d\\lambda = \\frac{1}{2\\pi} \\int_{0}^{2\\pi} g(\\lambda(\\theta)) i r e^{i\\theta}\\, d\\theta$ 和步长为 $\\Delta\\theta = \\frac{2\\pi}{N}$ 的梯形法则得出。\n3. 计算奇异值分解 $C_0 = U \\Sigma V^*$，并通过计算大于相对于 $\\|\\Sigma\\|_{\\infty}$ 的容差 $\\tau$ 的奇异值数量来确定数值秩 $m$。构成 $m \\times m$ 的小矩阵\n   $$T = U_m^* C_1 V_m \\Sigma_m^{-1},$$\n   其中 $U_m$、$V_m$ 和 $\\Sigma_m$ 是对应于秩 $m$ 的前导奇异向量和奇异值。$T$ 的特征值近似于 $\\Gamma$ 内部的 $P(\\lambda)$ 的特征值。\n4. 通过仅保留圆盘 $\\{ \\lambda \\in \\mathbb{C} : |\\lambda - c| \\le r \\}$ 内的特征值来过滤计算出的特征值，以移除潜在的伪值。然后与同一圆盘所包含的精确特征值进行比较。为了比较，计算计算出的特征值集合和精确特征值集合之间的对称豪斯多夫距离，\n   $$d_H(A,B) = \\max\\left(\\max_{a\\in A}\\min_{b\\in B}|a-b|, \\max_{b\\in B}\\min_{a\\in A}|b-a|\\right),$$\n   其中 $A$ 是过滤后保留的计算特征值集合，而 $B$ 是圆盘内的精确特征值集合。\n5. 每个测试用例的最终结果必须包含整数 $m_{\\mathrm{comp}}$（等于保留的计算特征值的数量）和浮点数豪斯多夫距离 $d_H$（计算集合与精确集合之间）。\n\n使用以下测试套件，它探测了不同的场景：\n- 测试用例1（正常情况）：$c=2.5$，$r=1.0$，$N=128$。\n- 测试用例2（两个相近的特征值）：$c=4.5$，$r=0.8$，$N=128$。\n- 测试用例3（单个被包含的特征值）：$c=0.0$，$r=1.5$，$N=128$。\n- 测试用例4（没有被包含的特征值）：$c=10.0$，$r=1.0$，$N=128$。\n\n您的程序应生成一行输出，其中包含四个测试用例的结果，形式为方括号内的逗号分隔列表，每个测试用例的结果本身是一个逗号分隔的列表 $[m_{\\mathrm{comp}}, d_H]$。例如，输出格式必须完全是 \"[[m1,d1],[m2,d2],[m3,d3],[m4,d4]]\"，其中 $m_k$ 是整数，$d_k$ 是浮点数。不涉及物理单位，角度通过参数化 $\\theta \\in [0,2\\pi)$ 隐式地以弧度为单位。",
            "solution": "该用户希望实现一个完整的程序，使用基于围线积分的方法来近似二次特征值问题（QEP）的选定特征值。\n\n### 方法验证\n首先根据所需标准对问题陈述进行验证。\n\n**1. 提取给定信息：**\n- **问题类型：** 二次特征值问题（QEP），$P(\\lambda)x = 0$。\n- **矩阵多项式：** $P(\\lambda) = \\lambda^2 M_2 + \\lambda M_1 + M_0$，其中 $P(\\lambda) \\in \\mathbb{C}^{n \\times n}$。\n- **问题细节：** $n=3$，$M_2 = I_3$。$M_1$ 和 $M_0$ 是对角矩阵。\n- **特征值定义：** $P(\\lambda)$ 的对角项为 $p_i(\\lambda) = \\lambda^2 - (\\alpha_i+\\beta_i)\\lambda + \\alpha_i \\beta_i$。$p_i(\\lambda)$ 的根是 $(\\alpha_i, \\beta_i)$。\n- **特征值对：** $(\\alpha_1, \\beta_1) = (-1, 2)$，$(\\alpha_2, \\beta_2) = (3, 4)$，$(\\alpha_3, \\beta_3) = (-2, 5)$。这定义了全部精确特征值集合为 $\\{-1, 2, 3, 4, -2, 5\\}$。\n- **矩阵构造：** $M_1 = -\\mathrm{diag}(\\alpha_1+\\beta_1, \\alpha_2+\\beta_2, \\alpha_3+\\beta_3)$ 和 $M_0 = \\mathrm{diag}(\\alpha_1\\beta_1, \\alpha_2\\beta_2, \\alpha_3\\beta_3)$。\n- **数值方法：**\n    - **围线：** 由 $\\lambda(\\theta) = c + r e^{i\\theta}$ 参数化的圆 $\\Gamma$。\n    - **矩近似：** 矩矩阵 $C_0$ 和 $C_1$ 使用具有 $N$ 个节点的梯形法则进行近似：\n      $$C_k \\approx \\frac{r}{N} \\sum_{j=0}^{N-1} e^{i\\theta_j} \\lambda(\\theta_j)^k P(\\lambda(\\theta_j))^{-1}, \\quad k \\in \\{0,1\\}.$$\n    - **特征值提取：**\n        1. 计算 $C_0$ 的SVD分解 $C_0 = U \\Sigma V^*$。\n        2. 通过计算奇异值 $\\sigma_j$ 满足 $\\sigma_j / \\sigma_1 > \\tau$ 的数量来确定数值秩 $m$。\n        3. 构成投影矩阵 $T = U_m^* C_1 V_m \\Sigma_m^{-1}$。\n        4. $T$ 的特征值即为近似值。\n- **后处理：**\n    - 过滤计算出的特征值，只保留圆盘 $|\\lambda - c| \\le r$ 内的值。\n    - 使用对称豪斯多夫距离 $d_H(A,B)$ 将过滤后的集合 $A$ 与精确集合 $B$ 进行比较。\n- **输出：** 对每个测试用例，生成过滤后的特征值数量 $m_{\\mathrm{comp}}$ 和豪斯多夫距离 $d_H$。\n- **测试用例：**\n    1. $c=2.5, r=1.0, N=128$。\n    2. $c=4.5, r=0.8, N=128$。\n    3. $c=0.0, r=1.5, N=128$。\n    4. $c=10.0, r=1.0, N=128$。\n\n**2. 验证分析：**\n- **科学合理性：** 所提出的方法是求解非线性特征值问题的一种公认的数值技术，通常被称为围线积分法或基于矩的方法。其基础理论涉及谱投影算子及其积分表示，是算子理论的基石。在圆上使用梯形法则进行数值近似，对于解析被积函数具有谱精度。通过SVD和降维特征值问题从矩中提取特征值的过程是标准做法。该问题在科学和数学上是合理的。\n- **适定性：** 该问题是适定的。QEP被明确定义，并具有已知的特征值。数值算法的描述足够详细。对于所有测试用例，积分围线 $\\Gamma$ 都不经过任何精确特征值，确保了 $P(\\lambda)^{-1}$ 在 $\\Gamma$ 上及其附近是良定义和解析的。SVD容差 $\\tau$ 的具体值存在轻微的模糊性，但这是一个标准的实现细节；任何合理的选择（例如，基于机器精度）都会得到有效的解。该问题是自洽且一致的。\n- **客观性：** 该问题以精确、客观的数学语言陈述。没有主观因素。\n\n**3. 结论：**\n该问题是**有效的**。它是一个清晰、科学根据充分、且适定的数值线性代数问题。我们可以着手解决。\n\n### 基于原则的解决方案\n\n该解决方案实现了指定的围线积分方法，以寻找位于复平面中给定圆形围线 $\\Gamma$ 内部的二次矩阵多项式 $P(\\lambda)$ 的特征值。\n\n**1. QEP定义**\n二次特征值问题由 $P(\\lambda)x = (\\lambda^2 M_2 + \\lambda M_1 + M_0)x = 0$ 给出。对于此特定任务，我们构建一个大小为 $n=3$ 且具有已知特征值的对角QEP。特征值以三对形式给出：$(\\alpha_1, \\beta_1) = (-1, 2)$，$(\\alpha_2, \\beta_2) = (3, 4)$ 和 $(\\alpha_3, \\beta_3) = (-2, 5)$。多项式 $P(\\lambda)$ 的对角项定义为 $p_i(\\lambda) = (\\lambda - \\alpha_i)(\\lambda - \\beta_i) = \\lambda^2 - (\\alpha_i + \\beta_i)\\lambda + \\alpha_i\\beta_i$。\n将此与对角QEP的一般形式 $p_i(\\lambda) = \\lambda^2 [M_2]_{ii} + \\lambda [M_1]_{ii} + [M_0]_{ii}$ 进行比较，我们可以确定这些矩阵。\n- 令 $M_2 = I_3$，我们有 $[M_2]_{ii}=1$。\n- 线性项矩阵为 $M_1 = \\mathrm{diag}(-(\\alpha_1+\\beta_1), -(\\alpha_2+\\beta_2), -(\\alpha_3+\\beta_3)) = \\mathrm{diag}(-1, -7, -3)$。\n- 常数项矩阵为 $M_0 = \\mathrm{diag}(\\alpha_1\\beta_1, \\alpha_2\\beta_2, \\alpha_3\\beta_3) = \\mathrm{diag}(-2, 12, -10)$。\n$P(\\lambda)$ 的完整特征值集合是其对角项根的并集：$\\{-1, 2, 3, 4, -2, 5\\}$。\n\n**2. 围线积分法**\n该方法的核心依赖于解算子 $P(\\lambda)^{-1}$ 的围线积分性质。在一个闭合围线 $\\Gamma$ 上的积分，该围线包含 $m$ 个特征值（计算重数）但不包含其他特征值，\n$$S_0 = \\frac{1}{2\\pi i} \\oint_{\\Gamma} P(\\lambda)^{-1} \\, d\\lambda,$$\n是到与所包含特征值相关的不变子空间上的一个投影算子。$S_0$ 的秩为 $m$。一阶矩矩阵，\n$$S_1 = \\frac{1}{2\\pi i} \\oint_{\\Gamma} \\lambda P(\\lambda)^{-1} \\, d\\lambda,$$\n作用于此不变子空间。算子对 $(S_1, S_0)$ 在此子空间上的限制的特征值恰好是 $\\Gamma$ 所包含的特征值。\n\n**3. 数值实现**\n解析积分通过数值方法近似。\n- **离散化：** 圆形围线 $\\lambda(\\theta) = c + r e^{i\\theta}$ 使用 $N$ 个等距点 $\\theta_j = 2\\pi j / N$（其中 $j=0, \\dots, N-1$）进行离散化。积分使用梯形法则近似，该方法对周期性解析函数表现出高精度。近似矩 $C_k$ 的表达式从积分定义导出：\n$$C_k = \\frac{1}{2\\pi i} \\oint_{\\Gamma} \\lambda^k P(\\lambda)^{-1} d\\lambda = \\frac{1}{2\\pi i} \\int_{0}^{2\\pi} \\lambda(\\theta)^k P(\\lambda(\\theta))^{-1} (i r e^{i\\theta}) d\\theta \\approx \\frac{r}{N} \\sum_{j=0}^{N-1} e^{i\\theta_j} \\lambda(\\theta_j)^k P(\\lambda(\\theta_j))^{-1}。$$\n由于我们的问题中 $P(\\lambda)$ 是对角的，其逆 $P(\\lambda)^{-1}$ 也是对角的，其对角项为 $1/p_i(\\lambda)$，这简化了计算。\n\n- **子空间与投影：** $S_0$ 的数值秩 $m$ 从其近似 $C_0 = U\\Sigma V^*$ 的奇异值分解（SVD）中估计。我们计算相对于最大奇异值 $\\sigma_1$ 而言显著的奇异值 $\\sigma_j$ 的数量，即 $\\sigma_j > \\tau \\sigma_1$，其中 $\\tau$ 是一个小的容差（例如 $10^{-12}$）。这给出了 $\\Gamma$ 内部的特征值数量。前导的 $m$ 个奇异向量 $U_m$ 和 $V_m$ 构成了 $C_0$ 的值域和余值域的正交基。\n广义特征值问题 $S_1 y = \\lambda S_0 y$ 被投影到这些基上，从而得到小的 $m \\times m$ 广义特征值问题 $(U_m^* C_1 V_m) z = \\lambda (U_m^* C_0 V_m) z$。由于 $U_m^* C_0 V_m \\approx U_m^* (U_m \\Sigma_m V_m^*) V_m = \\Sigma_m$，这简化为求矩阵 $\\Sigma_m^{-1} (U_m^* C_1 V_m)$ 的特征值。$AB$ 的特征值与 $BA$ 的特征值相同，所以我们可以计算问题中指定的矩阵 $T = (U_m^* C_1 V_m) \\Sigma_m^{-1}$ 的特征值。\n\n- **过滤与比较：** $T$ 的特征值提供了对 $\\Gamma$ 内部 $P(\\lambda)$ 特征值的近似。由于数值误差，一些计算出的特征值可能略微位于围线圆盘之外。这些值被过滤掉。最终的计算特征值集合 $A$ 与已知在圆盘内的精确特征值集合 $B$ 进行比较。对称豪斯多夫距离 $d_H(A,B) = \\max(\\sup_{a \\in A} \\inf_{b \\in B} |a-b|, \\sup_{b \\in B} \\inf_{a \\in A} |b-a|)$ 量化了两个集合之间的最大误差。如果两个集合都为空，则距离为0。\n\n程序系统地将这些步骤应用于每个测试用例，计算计算出的特征值数量和与精确集合的豪斯多夫距离。",
            "answer": "```python\nimport numpy as np\nfrom scipy.linalg import svd, eigvals\n\ndef solve():\n    \"\"\"\n    为二次特征值问题(QEP)实现围线积分方法，并运行指定的测试用例。\n    \"\"\"\n\n    def solve_qep_contour(c, r, N):\n        \"\"\"\n        针对单个围线配置求解QEP。\n\n        Args:\n            c (float or complex): 圆形围线的中心。\n            r (float): 圆形围线的半径。\n            N (int): 求积点数。\n\n        Returns:\n            list: 一个包含 [m_comp, d_H] 的列表，其中 m_comp 是围线内计算出的特征值数量，d_H 是与精确特征值之间的豪斯多夫距离。\n        \"\"\"\n        n = 3  # 矩阵的大小\n        exact_eigs = np.array([-1., 2., 3., 4., -2., 5.])\n\n        # 1. 构建对角QEP矩阵 M2, M1, M0\n        alpha_beta_pairs = [(-1, 2), (3, 4), (-2, 5)]\n        m1_diag = -np.array([a + b for a, b in alpha_beta_pairs], dtype=np.float64)\n        m0_diag = np.array([a * b for a, b in alpha_beta_pairs], dtype=np.float64)\n\n        M2 = np.identity(n, dtype=np.float64)\n        M1 = np.diag(m1_diag)\n        M0 = np.diag(m0_diag)\n\n        def P_inv(lam):\n            # 由于矩阵是对角的，求逆是逐元素的。\n            # P_ii(lam) = lam^2 * M2_ii + lam * M1_ii + M0_ii\n            p_diag = lam**2 * np.diag(M2) + lam * np.diag(M1) + np.diag(M0)\n            return np.diag(1.0 / p_diag)\n\n        # 2. 使用梯形求积法组装矩矩阵 C0 和 C1\n        theta = (2 * np.pi / N) * np.arange(N)\n        lambda_vals = c + r * np.exp(1j * theta)\n\n        C0 = np.zeros((n, n), dtype=np.complex128)\n        C1 = np.zeros((n, n), dtype=np.complex128)\n\n        for j in range(N):\n            lam = lambda_vals[j]\n            P_inv_lam = P_inv(lam)\n            common_term = (r / N) * np.exp(1j * theta[j]) * P_inv_lam\n            C0 += common_term\n            C1 += lam * common_term\n\n        # 3. 使用SVD寻找子空间并进行投影\n        U, s, Vh = svd(C0)\n\n        # 确定数值秩 m\n        svd_tol = 1e-12\n        if s.size == 0:\n            m = 0\n        else:\n            m = np.sum(s > svd_tol * s[0])\n\n        if m == 0:\n            computed_eigs_filtered = []\n        else:\n            # 截断SVD分量\n            U_m = U[:, :m]\n            s_m = s[:m]\n            Vh_m = Vh[:m, :]\n            V_m = Vh_m.conj().T\n            Sigma_m_inv = np.diag(1 / s_m)\n\n            # 构成小矩阵 T 并求其特征值\n            T = U_m.conj().T @ C1 @ V_m @ Sigma_m_inv\n            computed_eigs = eigvals(T)\n\n            # 4. 过滤计算出的特征值，只保留圆盘内的值\n            computed_eigs_filtered = [eig for eig in computed_eigs if np.abs(eig - c) = r]\n\n        m_comp = len(computed_eigs_filtered)\n\n        # 识别圆盘内的精确特征值\n        exact_eigs_inside = [eig for eig in exact_eigs if np.abs(eig - c) = r]\n\n        # 5. 计算对称豪斯多夫距离\n        set_A = np.array(computed_eigs_filtered, dtype=np.complex128)\n        set_B = np.array(exact_eigs_inside, dtype=np.complex128)\n\n        if set_A.size == 0 and set_B.size == 0:\n            d_H = 0.0\n        elif set_A.size == 0 or set_B.size == 0:\n            # 如果一个集合为空而另一个不为空，则距离为无穷大。\n            # 对于给定的测试套件，预计不会出现这种情况。\n            d_H = np.inf\n        else:\n            dist_A_to_B = np.max([np.min(np.abs(a - set_B)) for a in set_A])\n            dist_B_to_A = np.max([np.min(np.abs(b - set_A)) for b in set_B])\n            d_H = np.max([dist_A_to_B, dist_B_to_A])\n            \n        return [m_comp, d_H]\n\n    # 定义来自问题描述的测试用例。\n    test_cases = [\n        (2.5, 1.0, 128),\n        (4.5, 0.8, 128),\n        (0.0, 1.5, 128),\n        (10.0, 1.0, 128),\n    ]\n\n    results = []\n    for case in test_cases:\n        result = solve_qep_contour(case[0], case[1], case[2])\n        results.append(result)\n\n    # 最终的打印语句，格式需完全符合要求。\n    formatted_results = [f\"[{r[0]},{r[1]}]\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}