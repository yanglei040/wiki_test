{
    "hands_on_practices": [
        {
            "introduction": "理论的威力通常体现在其最简单的例子中。这项练习将通过一个精心设计的 $2 \\times 2$ 厄米特矩阵来揭示戴维斯-卡韩定理的核心思想。通过从第一性原理出发，你将亲手计算一个微小谱隙（spectral gap）如何放大微小扰动对不变子空间的影响，从而直观地理解子空间条件数的关键决定因素。",
            "id": "3540449",
            "problem": "考虑埃尔米特矩阵 $A \\in \\mathbb{R}^{2 \\times 2}$，其表达式为\n$$\nA = \\begin{pmatrix}\n\\lambda & 0 \\\\\n0 & \\lambda + \\Delta\n\\end{pmatrix},\n$$\n其中参数 $\\lambda \\in \\mathbb{R}$ 且 $\\Delta > 0$，以及一个埃尔米特扰动 $E \\in \\mathbb{R}^{2 \\times 2}$ 定义为\n$$\nE = \\begin{pmatrix}\n0 & \\varepsilon \\\\\n\\varepsilon & 0\n\\end{pmatrix},\n$$\n其中 $\\varepsilon \\in \\mathbb{R}$ 满足 $|\\varepsilon| \\ll \\Delta$。令 $A_{\\varepsilon} = A + E$。$A$ 的与最小特征值相关的不变子空间为 $\\mathcal{U} = \\operatorname{span}\\{e_{1}\\}$，其中 $e_{1} = (1, 0)^{\\top}$。令 $\\mathcal{V}$ 表示 $A_{\\varepsilon}$ 的与最小特征值相关的不变子空间。\n\n从对称（埃尔米特）矩阵的特征值和特征向量的定义以及子空间之间主角的定义出发，推导 $\\sin \\theta$ 的精确表达式，其中 $\\theta$ 是 $\\mathcal{U}$ 和 $\\mathcal{V}$ 之间的主角。然后，解释当谱隙 $\\Delta$ 非常小时，该表达式如何表现出不变子空间的病态条件，这与 Davis–Kahan 角正弦定理的定性预测一致（推导中不应使用该定理的任何公式；仅使用其解释性陈述，即角的正弦值与扰动幅度相对于谱隙的比例成正比）。角度以弧度为单位。\n\n你的最终答案必须是 $\\sin \\theta$ 关于 $\\Delta$ 和 $\\varepsilon$ 的单个闭式解析表达式。",
            "solution": "在尝试解答之前，需对问题进行验证。\n\n### 第1步：提取已知条件\n- $A \\in \\mathbb{R}^{2 \\times 2}$ 是一个埃尔米特矩阵：$A = \\begin{pmatrix} \\lambda & 0 \\\\ 0 & \\lambda + \\Delta \\end{pmatrix}$。\n- $\\lambda \\in \\mathbb{R}$。\n- $\\Delta > 0$。\n- $E \\in \\mathbb{R}^{2 \\times 2}$ 是一个埃尔米特扰动：$E = \\begin{pmatrix} 0 & \\varepsilon \\\\ \\varepsilon & 0 \\end{pmatrix}$。\n- $\\varepsilon \\in \\mathbb{R}$，且 $|\\varepsilon| \\ll \\Delta$。\n- 扰动后的矩阵是 $A_{\\varepsilon} = A + E$。\n- $\\mathcal{U} = \\operatorname{span}\\{e_{1}\\}$ 是 $A$ 的与最小特征值相关的不变子空间，其中 $e_{1} = (1, 0)^{\\top}$。\n- $\\mathcal{V}$ 是 $A_{\\varepsilon}$ 的与最小特征值相关的不变子空间。\n- $\\theta$ 是子空间 $\\mathcal{U}$ 和 $\\mathcal{V}$ 之间的主角。\n\n### 第2步：使用提取的已知条件进行验证\n1.  **科学依据：** 该问题是数值线性代数中的一个标准练习，特别是矩阵扰动理论。所有概念（埃尔米特矩阵、特征值、特征向量、不变子空间、主角）在数学中都是成熟的概念。\n2.  **适定性：** 问题提供了确定指定矩阵特征值和特征向量所需的所有信息。条件 $\\Delta > 0$ 确保了未扰动矩阵 $A$ 具有不同的特征值，从而使子空间 $\\mathcal{U}$ 被明确定义。扰动的结构清晰，允许计算扰动后的子空间 $\\mathcal{V}$以及随后的角度 $\\theta$。该问题是适定的。\n3.  **客观性：** 问题使用精确的数学语言陈述，没有任何主观或偏见的术语。\n4.  **完整性和一致性：** 问题是自洽的。所提供的数据是完整的，并且没有矛盾。\n5.  **总体评估：** 该问题没有违反任何无效性标准。它是数值线性代数中一个有效且适定的问题。\n\n### 第3步：结论与行动\n该问题被判定为 **有效**。将提供完整解答。\n\n### 推导\n求解过程首先找到不变子空间 $\\mathcal{U}$ 和 $\\mathcal{V}$，然后计算它们之间的主角 $\\theta$。\n\n未扰动的矩阵是 $A = \\begin{pmatrix} \\lambda & 0 \\\\ 0 & \\lambda + \\Delta \\end{pmatrix}$。由于 $A$ 是对角矩阵，其特征值是对角线上的元素。给定 $\\Delta > 0$，特征值为 $\\mu_1 = \\lambda$ 和 $\\mu_2 = \\lambda + \\Delta$，其中 $\\mu_1$ 是最小的。$\\mu_1$ 对应的特征向量是 $u = e_{1} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$。不变子空间是 $\\mathcal{U} = \\operatorname{span}\\{u\\}$，正如问题中所述。\n\n扰动后的矩阵是 $A_{\\varepsilon} = A + E = \\begin{pmatrix} \\lambda & \\varepsilon \\\\ \\varepsilon & \\lambda + \\Delta \\end{pmatrix}$。为了求其特征值，我们求解特征方程 $\\det(A_{\\varepsilon} - \\eta I) = 0$：\n$$\n\\det \\begin{pmatrix} \\lambda - \\eta & \\varepsilon \\\\ \\varepsilon & \\lambda + \\Delta - \\eta \\end{pmatrix} = (\\lambda - \\eta)(\\lambda + \\Delta - \\eta) - \\varepsilon^2 = 0\n$$\n我们引入一个代换 $\\eta' = \\eta - \\lambda$。方程变为：\n$$\n(-\\eta')(\\Delta - \\eta') - \\varepsilon^2 = 0 \\implies (\\eta')^2 - \\Delta \\eta' - \\varepsilon^2 = 0\n$$\n使用二次公式求解 $\\eta'$，我们得到：\n$$\n\\eta' = \\frac{\\Delta \\pm \\sqrt{\\Delta^2 - 4(1)(-\\varepsilon^2)}}{2} = \\frac{\\Delta \\pm \\sqrt{\\Delta^2 + 4\\varepsilon^2}}{2}\n$$\n$A_{\\varepsilon}$ 的特征值是 $\\eta = \\lambda + \\eta'$。由于 $\\sqrt{\\Delta^2 + 4\\varepsilon^2} > \\Delta$，最小的特征值对应于负号：\n$$\n\\eta_1 = \\lambda + \\frac{\\Delta - \\sqrt{\\Delta^2 + 4\\varepsilon^2}}{2}\n$$\n现在，我们通过求解 $(A_{\\varepsilon} - \\eta_1 I)v=0$ 来找到对应于 $\\eta_1$ 的特征向量 $v$。令 $v = \\begin{pmatrix} v_1 \\\\ v_2 \\end{pmatrix}$。矩阵方程的第一行给出：\n$$\n(\\lambda - \\eta_1)v_1 + \\varepsilon v_2 = 0\n$$\n代入 $\\lambda - \\eta_1 = -(\\eta_1 - \\lambda) = -\\eta'_1 = \\frac{\\sqrt{\\Delta^2 + 4\\varepsilon^2} - \\Delta}{2}$：\n$$\n\\left(\\frac{\\sqrt{\\Delta^2 + 4\\varepsilon^2} - \\Delta}{2}\\right)v_1 + \\varepsilon v_2 = 0\n$$\n这意味着 $\\frac{v_2}{v_1} = -\\frac{\\sqrt{\\Delta^2 + 4\\varepsilon^2} - \\Delta}{2\\varepsilon}$。\n不变子空间 $\\mathcal{V}$ 由任何这样的特征向量 $v$ 张成。我们可以将一个归一化的特征向量表示为 $\\hat{v} = \\begin{pmatrix} \\cos\\phi \\\\ \\sin\\phi \\end{pmatrix}$，其中 $\\phi$ 是某个角度。那么 $\\tan\\phi = v_2/v_1$。\n$$\n\\tan\\phi = \\frac{\\Delta - \\sqrt{\\Delta^2 + 4\\varepsilon^2}}{2\\varepsilon}\n$$\n为了简化这个表达式，我们对分子进行有理化：\n$$\n\\tan\\phi = \\frac{\\Delta - \\sqrt{\\Delta^2 + 4\\varepsilon^2}}{2\\varepsilon} \\times \\frac{\\Delta + \\sqrt{\\Delta^2 + 4\\varepsilon^2}}{\\Delta + \\sqrt{\\Delta^2 + 4\\varepsilon^2}} = \\frac{\\Delta^2 - (\\Delta^2 + 4\\varepsilon^2)}{2\\varepsilon(\\Delta + \\sqrt{\\Delta^2 + 4\\varepsilon^2})} = \\frac{-4\\varepsilon^2}{2\\varepsilon(\\Delta + \\sqrt{\\Delta^2 + 4\\varepsilon^2})} = \\frac{-2\\varepsilon}{\\Delta + \\sqrt{\\Delta^2 + 4\\varepsilon^2}}\n$$\n一维子空间 $\\mathcal{U} = \\operatorname{span}\\{e_1\\}$ 和 $\\mathcal{V} = \\operatorname{span}\\{\\hat{v}\\}$ 之间的主角 $\\theta$ 就是向量 $e_1 = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$ 和 $\\hat{v} = \\begin{pmatrix} \\cos\\phi \\\\ \\sin\\phi \\end{pmatrix}$ 之间的夹角。这个角就是 $|\\phi|$ (对于在一个合适区间如 $(-\\pi/2, \\pi/2]$ 内的 $\\phi$）。因此，$\\theta = |\\phi|$ 且在 $[0, \\pi/2]$ 区间内。我们需要求的是 $\\sin\\theta$。\n\n一个更直接的方法是使用三角代换。令 $\\tan\\alpha = \\frac{2\\varepsilon}{\\Delta}$，其中 $\\alpha \\in (-\\pi/2, \\pi/2)$。\n那么 $\\sqrt{\\Delta^2 + 4\\varepsilon^2} = \\sqrt{\\Delta^2(1 + 4\\varepsilon^2/\\Delta^2)} = |\\Delta|\\sqrt{1+\\tan^2\\alpha} = \\Delta\\sec\\alpha$ (因为 $\\Delta>0$ 且 $\\cos\\alpha>0$）。\n将此代入前面 $\\tan\\phi$ 的表达式中：\n$$\n\\tan\\phi = \\frac{\\Delta - \\Delta\\sec\\alpha}{2\\varepsilon} = \\frac{\\Delta(1-\\sec\\alpha)}{\\Delta\\tan\\alpha} = \\frac{1-\\sec\\alpha}{\\tan\\alpha} = \\frac{1-1/\\cos\\alpha}{\\sin\\alpha/\\cos\\alpha} = \\frac{\\cos\\alpha-1}{\\sin\\alpha}\n$$\n使用半角恒等式 $\\cos\\alpha-1 = -2\\sin^2(\\alpha/2)$ 和 $\\sin\\alpha = 2\\sin(\\alpha/2)\\cos(\\alpha/2)$：\n$$\n\\tan\\phi = \\frac{-2\\sin^2(\\alpha/2)}{2\\sin(\\alpha/2)\\cos(\\alpha/2)} = -\\tan(\\alpha/2)\n$$\n这意味着 $\\phi = -\\alpha/2$。主角是 $\\theta=|\\phi|=|\\alpha/2|$。由于 $\\alpha \\in (-\\pi/2, \\pi/2)$，所以 $\\alpha/2 \\in (-\\pi/4, \\pi/4)$，且 $\\sin(\\alpha/2)$ 与 $\\alpha$ 同号。我们想要求 $\\sin\\theta = \\sin(|\\alpha/2|) = |\\sin(\\alpha/2)|$。\n\n我们可以使用恒等式 $|\\sin(\\alpha/2)| = \\sqrt{\\frac{1-\\cos\\alpha}{2}}$ 从 $\\cos\\alpha$ 计算 $|\\sin(\\alpha/2)|$。\n从 $\\tan\\alpha = \\frac{2\\varepsilon}{\\Delta}$，我们求得 $\\cos\\alpha$：\n$$\n\\cos\\alpha = \\frac{1}{\\sec\\alpha} = \\frac{1}{\\sqrt{1+\\tan^2\\alpha}} = \\frac{1}{\\sqrt{1 + (2\\varepsilon/\\Delta)^2}} = \\frac{|\\Delta|}{\\sqrt{\\Delta^2 + 4\\varepsilon^2}} = \\frac{\\Delta}{\\sqrt{\\Delta^2 + 4\\varepsilon^2}}\n$$\n将此代入 $\\sin\\theta$ 的表达式中：\n$$\n\\sin\\theta = \\sqrt{\\frac{1}{2}\\left(1 - \\frac{\\Delta}{\\sqrt{\\Delta^2 + 4\\varepsilon^2}}\\right)} = \\sqrt{\\frac{\\sqrt{\\Delta^2 + 4\\varepsilon^2} - \\Delta}{2\\sqrt{\\Delta^2 + 4\\varepsilon^2}}}\n$$\n这就是 $\\sin\\theta$ 的精确、闭式表达式。\n\n### 性态分析\nDavis-Kahan 定理定性地预测，原始不变子空间与扰动后的不变子空间之间夹角的正弦值与扰动范数成正比，与谱隙成反比。在我们的问题中，扰动范数与 $|\\varepsilon|$ 相关（例如，$\\|E\\|_F = \\sqrt{2}|\\varepsilon|$），谱隙为 $\\delta = \\mu_2 - \\mu_1 = \\Delta$。因此，该定理表明 $\\sin\\theta$ 与 $|\\varepsilon|/\\Delta$ 成比例。\n\n让我们在 $|\\varepsilon| \\ll \\Delta$ 的情况下分析我们的精确表达式，这允许我们将 $x = |\\varepsilon|/\\Delta$ 视为一个小参数。\n$$\n\\sin^2\\theta = \\frac{1}{2}\\left(1 - \\frac{\\Delta}{\\sqrt{\\Delta^2 + 4\\varepsilon^2}}\\right) = \\frac{1}{2}\\left(1 - \\frac{1}{\\sqrt{1 + 4\\varepsilon^2/\\Delta^2}}\\right)\n$$\n对于小的 $z = 4\\varepsilon^2/\\Delta^2$，使用泰勒展开 $(1+z)^{-1/2} \\approx 1 - \\frac{1}{2}z$：\n$$\n\\sin^2\\theta \\approx \\frac{1}{2}\\left(1 - \\left(1 - \\frac{1}{2} \\frac{4\\varepsilon^2}{\\Delta^2}\\right)\\right) = \\frac{1}{2}\\left(\\frac{2\\varepsilon^2}{\\Delta^2}\\right) = \\frac{\\varepsilon^2}{\\Delta^2}\n$$\n取平方根（因为 $\\theta \\in [0, \\pi/2]$ 意味着 $\\sin\\theta \\ge 0$）：\n$$\n\\sin\\theta \\approx \\frac{|\\varepsilon|}{\\Delta}\n$$\n这个结果表明，不变子空间旋转角的正弦值，在一阶近似下，与扰动的大小 $|\\varepsilon|$ 成正比，与谱隙 $\\Delta$ 成反比。\n\n当一个小的扰动导致子空间发生大的变化时，不变子空间就表现出病态条件。我们的结果表明，$\\theta$ 对 $\\varepsilon$ 的敏感度由因子 $1/\\Delta$ 控制。如果谱隙 $\\Delta$ 非常小，这个因子就会变得非常大，表明即使一个非常小的扰动 $\\varepsilon$ 也可能导致不变子空间发生显著的旋转（一个大的 $\\theta$）。这就是病态条件的定义。因此，推导出的表达式为 Davis-Kahan 定理背后的定性原理提供了一个具体的、定量的验证。例如，如果对于固定的 $\\varepsilon \\neq 0$ 有 $\\Delta \\to 0$，那么 $\\sin\\theta \\to \\sqrt{\\frac{\\sqrt{4\\varepsilon^2}-0}{2\\sqrt{4\\varepsilon^2}}} = \\sqrt{\\frac{2|\\varepsilon|}{4|\\varepsilon|}} = \\frac{1}{\\sqrt{2}}$，这对应于一个大角度 $\\theta=\\pi/4$。",
            "answer": "$$\n\\boxed{\\sqrt{\\frac{\\sqrt{\\Delta^2 + 4\\varepsilon^2} - \\Delta}{2\\sqrt{\\Delta^2 + 4\\varepsilon^2}}}}\n$$"
        },
        {
            "introduction": "一个好的理论界限不仅要正确，还要足够“紧”，才能具有预测价值。在前一个练习的基础上，本练习将探讨戴维斯-卡韩定理界限的紧致性。你将构造一个“最坏情况”下的 $2 \\times 2$ 例子，精确计算主角度的正弦值，并证明在扰动趋于零时，该界限几乎是可达到的，这突显了该定理在实际误差分析中的重要性。",
            "id": "3540476",
            "problem": "设 $A=\\mathrm{diag}(\\alpha,\\beta)\\in\\mathbb{C}^{2\\times 2}$ 是一个埃尔米特矩阵，其中 $\\alpha,\\beta\\in\\mathbb{R}$ 且 $\\alpha>\\beta$，并设 $E=\\epsilon\\begin{bmatrix} 0 & 1 \\\\ 1 & 0 \\end{bmatrix}$，其中 $\\epsilon\\in\\mathbb{R}$。考虑扰动后的埃尔米特矩阵 $A+E=\\begin{bmatrix} \\alpha & \\epsilon \\\\ \\epsilon & \\beta \\end{bmatrix}$。定义 $A$ 的一维不变子空间为 $\\mathcal{U}=\\mathrm{span}\\{u\\}$，其中 $u=\\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix}$ (对应于特征值 $\\alpha$ 的特征向量)，并设 $\\mathcal{V}=\\mathrm{span}\\{v\\}$ 为 $A+E$ 的一维不变子空间，该子空间与 $A+E$ 的较大特征值相关联，其中 $v$ 是一个单位特征向量。设 $\\theta\\in[0,\\pi/2]$ 表示 $\\mathcal{U}$ 和 $\\mathcal{V}$ 之间的主角（以弧度为单位），使得 $\\sin\\theta=\\|P_{\\mathcal{U}^{\\perp}} v\\|_{2}$，其中 $P_{\\mathcal{U}^{\\perp}}$ 是到 $\\mathcal{U}$ 的正交补空间上的正交投影。\n\n从埃尔米特矩阵的特征值/特征向量、子空间的主角以及矩阵的谱范数（最大奇异值）的基本定义出发，执行以下操作：\n\n- 计算 $\\sin\\theta$ 关于 $\\alpha$、$\\beta$ 和 $\\epsilon$ 的精确闭式表达式。\n- 使用基本原理，推导出此实例的不等式 $\\sin\\theta\\le \\|E\\|_{2}/|\\alpha-\\beta|$，并通过分析极限比率 $\\displaystyle\\lim_{\\epsilon\\to 0}\\frac{\\sin\\theta}{\\|E\\|_{2}/|\\alpha-\\beta|}$ 来解释为什么这个例子是近乎紧的。\n\n将您的最终答案表示为 $\\sin\\theta$ 关于 $\\alpha$、$\\beta$ 和 $\\epsilon$ 的单一闭式解析表达式。无需四舍五入，不涉及物理单位。角度应以弧度解释。",
            "solution": "首先根据指定标准对问题进行验证。\n\n**步骤1：提取已知条件**\n-   埃尔米特矩阵 $A=\\mathrm{diag}(\\alpha,\\beta)\\in\\mathbb{C}^{2\\times 2}$，其中 $\\alpha,\\beta\\in\\mathbb{R}$ 且 $\\alpha>\\beta$。\n-   扰动矩阵 $E=\\epsilon\\begin{bmatrix} 0 & 1 \\\\ 1 & 0 \\end{bmatrix}$，其中 $\\epsilon\\in\\mathbb{R}$。\n-   扰动后的埃尔米特矩阵 $A+E=\\begin{bmatrix} \\alpha & \\epsilon \\\\ \\epsilon & \\beta \\end{bmatrix}$。\n-   $A$ 的一维不变子空间 $\\mathcal{U}=\\mathrm{span}\\{u\\}$，其中 $u=\\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix}$ 是对应于特征值 $\\alpha$ 的特征向量。\n-   $A+E$ 的一维不变子空间 $\\mathcal{V}=\\mathrm{span}\\{v\\}$，其中 $v$ 是与 $A+E$ 的较大特征值相关联的单位特征向量。\n-   $\\mathcal{U}$ 和 $\\mathcal{V}$ 之间的主角 $\\theta\\in[0,\\pi/2]$。\n-   主角的定义：$\\sin\\theta=\\|P_{\\mathcal{U}^{\\perp}} v\\|_{2}$，其中 $P_{\\mathcal{U}^{\\perp}}$ 是到 $\\mathcal{U}^{\\perp}$ 上的正交投影。\n\n**步骤2：使用提取的已知条件进行验证**\n-   **科学依据：** 该问题是数值线性代数中的一个标准练习，特别是矩阵扰动理论。所涉及的矩阵和概念（埃尔米特矩阵、特征值、特征向量、不变子空间、主角、谱范数）在该领域中都得到了很好的定义并且是基础性的。所有前提在事实上都是正确的。\n-   **适定性：** 问题陈述清晰，包含了求解 $\\sin\\theta$ 唯一解所需的所有信息。谱定理保证了埃尔米特矩阵特征值和特征向量的存在性。\n-   **客观性：** 语言精确且数学化，没有任何主观或基于观点的陈述。\n-   问题是自洽且内部一致的。所提供的定义与标准数学文献一致。任务是具体的、可形式化的。\n\n**步骤3：结论与行动**\n问题有效。将提供完整解答。\n\n**第1部分：$\\sin\\theta$ 的计算**\n\n首先，我们求扰动矩阵 $A+E$ 的特征值和相关特征向量。其特征方程为 $\\det(A+E - \\lambda I) = 0$。\n$$\n\\det\\left(\\begin{bmatrix} \\alpha-\\lambda & \\epsilon \\\\ \\epsilon & \\beta-\\lambda \\end{bmatrix}\\right) = (\\alpha-\\lambda)(\\beta-\\lambda) - \\epsilon^2 = 0\n$$\n这是一个关于 $\\lambda$ 的二次方程：$\\lambda^2 - (\\alpha+\\beta)\\lambda + \\alpha\\beta - \\epsilon^2 = 0$。\n$\\lambda$ 的解由二次方程求根公式给出：\n$$\n\\lambda = \\frac{(\\alpha+\\beta) \\pm \\sqrt{(\\alpha+\\beta)^2 - 4(\\alpha\\beta - \\epsilon^2)}}{2} = \\frac{(\\alpha+\\beta) \\pm \\sqrt{\\alpha^2+2\\alpha\\beta+\\beta^2 - 4\\alpha\\beta + 4\\epsilon^2}}{2}\n$$\n$$\n\\lambda = \\frac{(\\alpha+\\beta) \\pm \\sqrt{(\\alpha-\\beta)^2 + 4\\epsilon^2}}{2}\n$$\n问题指明 $\\mathcal{V}$ 与较大的特征值相关联，我们将其记为 $\\lambda_{+}$。\n$$\n\\lambda_{+} = \\frac{\\alpha+\\beta}{2} + \\frac{1}{2}\\sqrt{(\\alpha-\\beta)^2 + 4\\epsilon^2}\n$$\n接下来，我们求对应于 $\\lambda_{+}$ 的特征向量 $v$。设 $v = \\begin{bmatrix}v_1 \\\\ v_2\\end{bmatrix}$。特征向量方程为 $(A+E)v = \\lambda_{+}v$，得到方程组：\n$$\n(\\alpha-\\lambda_{+})v_1 + \\epsilon v_2 = 0\n$$\n$$\n\\epsilon v_1 + (\\beta-\\lambda_{+})v_2 = 0\n$$\n这两个方程是线性相关的。从第一个方程，假设 $\\epsilon \\neq 0$，我们有 $v_2 = -\\frac{\\alpha-\\lambda_{+}}{\\epsilon}v_1$。因此，特征向量与 $\\begin{bmatrix} 1 \\\\ -(\\alpha-\\lambda_{+})/\\epsilon \\end{bmatrix}$ 成比例。我们定义 $c = -\\frac{\\alpha-\\lambda_{+}}{\\epsilon}$。\n$$\n\\alpha - \\lambda_{+} = \\alpha - \\left(\\frac{\\alpha+\\beta}{2} + \\frac{1}{2}\\sqrt{(\\alpha-\\beta)^2+4\\epsilon^2}\\right) = \\frac{\\alpha-\\beta}{2} - \\frac{1}{2}\\sqrt{(\\alpha-\\beta)^2+4\\epsilon^2}\n$$\n所以，$c = -\\frac{1}{\\epsilon}\\left(\\frac{\\alpha-\\beta}{2} - \\frac{1}{2}\\sqrt{(\\alpha-\\beta)^2+4\\epsilon^2}\\right) = \\frac{-(\\alpha-\\beta) + \\sqrt{(\\alpha-\\beta)^2+4\\epsilon^2}}{2\\epsilon}$。\n单位特征向量 $v$ 为：\n$$\nv = \\frac{1}{\\sqrt{1+c^2}} \\begin{bmatrix} 1 \\\\ c \\end{bmatrix}\n$$\n不变子空间 $\\mathcal{U}$ 是由 $u = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix}$ 张成的。其正交补 $\\mathcal{U}^{\\perp}$ 是由 $u^{\\perp} = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}$ 张成的。到 $\\mathcal{U}^{\\perp}$ 上的正交投影为 $P_{\\mathcal{U}^{\\perp}} = u^{\\perp}(u^{\\perp})^T = \\begin{bmatrix} 0 & 0 \\\\ 0 & 1 \\end{bmatrix}$。\n$\\sin\\theta$ 的定义是 $\\sin\\theta = \\|P_{\\mathcal{U}^{\\perp}} v\\|_{2}$。\n$$\nP_{\\mathcal{U}^{\\perp}} v = \\begin{bmatrix} 0 & 0 \\\\ 0 & 1 \\end{bmatrix} \\frac{1}{\\sqrt{1+c^2}} \\begin{bmatrix} 1 \\\\ c \\end{bmatrix} = \\frac{1}{\\sqrt{1+c^2}} \\begin{bmatrix} 0 \\\\ c \\end{bmatrix}\n$$\n$$\n\\sin\\theta = \\left\\| \\frac{1}{\\sqrt{1+c^2}} \\begin{bmatrix} 0 \\\\ c \\end{bmatrix} \\right\\|_{2} = \\frac{|c|}{\\sqrt{1+c^2}}\n$$\n这可以通过三角换元来简化。令 $\\delta = \\alpha-\\beta > 0$。则 $c = \\frac{-\\delta + \\sqrt{\\delta^2+4\\epsilon^2}}{2\\epsilon}$。\n设 $\\phi \\in [0, \\pi/2)$ 为一个角，使得 $\\tan\\phi = \\frac{2|\\epsilon|}{\\delta}$。\n则 $\\sqrt{\\delta^2+4\\epsilon^2} = \\sqrt{\\delta^2(1 + 4\\epsilon^2/\\delta^2)} = \\delta\\sqrt{1+\\tan^2\\phi} = \\delta\\sec\\phi$。\n将此代入 $c$ 的表达式中：\n$$\nc = \\frac{-\\delta + \\delta\\sec\\phi}{2\\epsilon} = \\frac{\\delta}{2\\epsilon}(\\sec\\phi - 1)\n$$\n如果 $\\epsilon > 0$，则 $\\frac{\\delta}{2\\epsilon} = \\frac{1}{\\tan\\phi} = \\cot\\phi$。\n$c = \\cot\\phi(\\sec\\phi - 1) = \\frac{\\cos\\phi}{\\sin\\phi}\\left(\\frac{1}{\\cos\\phi}-1\\right) = \\frac{1-\\cos\\phi}{\\sin\\phi} = \\tan(\\phi/2)$。\n如果 $\\epsilon  0$，则 $\\frac{\\delta}{2\\epsilon} = -\\cot\\phi$，所以 $c = -\\tan(\\phi/2)$。\n在这两种情况下，都有 $|c| = \\tan(\\phi/2)$。因为 $\\theta\\in[0,\\pi/2]$ 且 $\\phi/2\\in[0,\\pi/4)$，所以 $\\sin\\theta$ 和 $\\tan(\\phi/2)$ 都是非负的。\n$$\n\\sin\\theta = \\frac{\\tan(\\phi/2)}{\\sqrt{1+\\tan^2(\\phi/2)}} = \\frac{\\tan(\\phi/2)}{\\sec(\\phi/2)} = \\sin(\\phi/2)\n$$\n我们可以使用半角恒等式 $\\sin^2(\\phi/2) = \\frac{1-\\cos\\phi}{2}$，用 $\\alpha, \\beta, \\epsilon$ 来表示 $\\sin(\\phi/2)$。\n从 $\\tan\\phi = \\frac{2|\\epsilon|}{\\alpha-\\beta}$，我们得到 $\\cos\\phi = \\frac{1}{\\sqrt{1+\\tan^2\\phi}} = \\frac{1}{\\sqrt{1 + \\frac{4\\epsilon^2}{(\\alpha-\\beta)^2}}} = \\frac{\\alpha-\\beta}{\\sqrt{(\\alpha-\\beta)^2+4\\epsilon^2}}$。\n因此，\n$$\n\\sin^2\\theta = \\sin^2(\\phi/2) = \\frac{1}{2}\\left(1 - \\frac{\\alpha-\\beta}{\\sqrt{(\\alpha-\\beta)^2+4\\epsilon^2}}\\right)\n$$\n由于 $\\theta \\in [0, \\pi/2]$，$\\sin\\theta \\ge 0$。取平方根得到 $\\sin\\theta$ 的最终表达式：\n$$\n\\sin\\theta = \\sqrt{\\frac{1}{2}\\left(1 - \\frac{\\alpha-\\beta}{\\sqrt{(\\alpha-\\beta)^2+4\\epsilon^2}}\\right)}\n$$\n\n**第2部分：不等式及其紧性**\n\n这部分关注不等式 $\\sin\\theta \\le \\frac{\\|E\\|_{2}}{|\\alpha-\\beta|}$。\n首先，我们计算谱范数 $\\|E\\|_2$。$\\|E\\|_2$ 是 $E$ 的最大奇异值，即 $\\sqrt{\\lambda_{\\max}(E^TE)}$。\n$E = \\epsilon\\begin{bmatrix} 0  1 \\\\ 1  0 \\end{bmatrix}$，所以 $E^T = E$。\n$E^TE = E^2 = \\epsilon^2\\begin{bmatrix} 0  1 \\\\ 1  0 \\end{bmatrix}\\begin{bmatrix} 0  1 \\\\ 1  0 \\end{bmatrix} = \\epsilon^2\\begin{bmatrix} 1  0 \\\\ 0  1 \\end{bmatrix} = \\epsilon^2I$。\n$E^2$ 的特征值均为 $\\epsilon^2$。最大特征值为 $\\lambda_{\\max}(E^2) = \\epsilon^2$。\n所以，$\\|E\\|_2 = \\sqrt{\\epsilon^2} = |\\epsilon|$。\n该不等式为 $\\sin\\theta \\le \\frac{|\\epsilon|}{\\alpha-\\beta}$ (因为 $\\alpha\\beta$，所以 $|\\alpha-\\beta|=\\alpha-\\beta$）。\n令 $x = \\frac{|\\epsilon|}{\\alpha-\\beta}$。不等式变为 $\\sin\\theta \\le x$。\n在第1部分中，我们得到 $\\sin\\theta = \\sin(\\phi/2)$，其中 $\\tan\\phi = \\frac{2|\\epsilon|}{\\alpha-\\beta} = 2x$。\n我们需要证明 $\\sin(\\phi/2) \\le x$。\n令 $t = \\tan(\\phi/2)$。根据正切的二倍角恒等式 $\\tan\\phi = \\frac{2\\tan(\\phi/2)}{1-\\tan^2(\\phi/2)}$，我们有 $2x = \\frac{2t}{1-t^2}$，所以 $x = \\frac{t}{1-t^2}$。\n正弦函数可以用半角的正切表示为 $\\sin(\\phi/2) = \\frac{t}{\\sqrt{1+t^2}}$。\n我们希望证明的不等式是 $\\frac{t}{\\sqrt{1+t^2}} \\le \\frac{t}{1-t^2}$。\n由于 $\\phi \\in [0, \\pi/2)$，我们有 $t = \\tan(\\phi/2) \\in [0, 1)$。因此，$t \\ge 0$ 且 $1-t^2  0$。\n如果 $t=0$ (即 $\\epsilon=0$)，不等式为 $0 \\le 0$，成立。\n如果 $t  0$，我们可以两边同除以 $t$ 得到 $\\frac{1}{\\sqrt{1+t^2}} \\le \\frac{1}{1-t^2}$，这等价于 $1-t^2 \\le \\sqrt{1+t^2}$。\n因为对于 $t \\in (0,1)$，两边都是正数，我们可以将两边平方：\n$(1-t^2)^2 \\le 1+t^2$\n$1 - 2t^2 + t^4 \\le 1+t^2$\n$t^4 - 3t^2 \\le 0$\n$t^2(t^2 - 3) \\le 0$。\n因为 $t^2 \\ge 0$，这个不等式成立当且仅当 $t^2 - 3 \\le 0$，即 $t^2 \\le 3$。\n因为 $t = \\tan(\\phi/2)$ 且 $\\phi/2 \\in [0, \\pi/4)$，我们有 $t  1$，所以 $t^2  1$。因此条件 $t^2 \\le 3$ 总是满足的。这证实了该不等式。\n\n为分析其紧性，我们计算极限：\n$$\n\\lim_{\\epsilon\\to 0}\\frac{\\sin\\theta}{\\|E\\|_{2}/|\\alpha-\\beta|} = \\lim_{\\epsilon\\to 0}\\frac{\\sin\\theta}{|\\epsilon|/(\\alpha-\\beta)}\n$$\n使用上面的记号，这就是 $\\lim_{x\\to 0} \\frac{\\sin(\\phi/2)}{x}$。\n当 $\\epsilon \\to 0$ 时，$x \\to 0$，这意味着 $\\phi \\to 0$ 且 $t=\\tan(\\phi/2) \\to 0$。\n该比值为 $\\frac{\\sin(\\phi/2)}{x} = \\frac{t/\\sqrt{1+t^2}}{t/(1-t^2)} = \\frac{1-t^2}{\\sqrt{1+t^2}}$。\n$$\n\\lim_{t\\to 0} \\frac{1-t^2}{\\sqrt{1+t^2}} = \\frac{1-0}{\\sqrt{1+0}} = 1\n$$\n由于该比率的极限为 1，该不等式是渐近紧的。对于小的 $\\epsilon$，$\\sin\\theta$ 可以很好地由 $\\|E\\|_{2}/|\\alpha-\\beta|$ 近似。这个例子表明 Davis-Kahan $\\sin\\theta$ 定理给出的界可以是紧的。",
            "answer": "$$\n\\boxed{\\sqrt{\\frac{1}{2}\\left(1 - \\frac{\\alpha-\\beta}{\\sqrt{(\\alpha-\\beta)^2+4\\epsilon^2}}\\right)}}\n$$"
        },
        {
            "introduction": "从解析推导到计算验证是掌握科学概念的关键一步。这项编程练习将理论付诸实践，要求你编写一个程序来数值验证戴维斯-卡韩 $\\sin\\Theta$ 定理。通过实现子空间计算、主角度测量和谱隙分析，你将在一系列测试用例中见证该定理的有效性，并加深对矩阵扰动理论在计算科学中应用的理解。",
            "id": "3168152",
            "problem": "考虑实对称矩阵及其由特征分解产生的标准正交子空间。请仅使用以下基本定义和事实作为基础： (i) 实对称矩阵具有标准正交特征基； (ii) 子空间的标准正交基可以用一个具有标准正交列的矩阵表示； (iii) 到具有标准正交列的矩阵 $U$ 的列空间上的正交投影矩阵为 $P = U U^\\top$； (iv) 对于两个相同维度的标准正交基 $U$ 和 $V$，$U^\\top V$ 的奇异值是这两个子空间之间主角的余弦； (v) 矩阵 $M$ 的谱范数 $\\|M\\|_2$ 是其最大的奇异值；以及 (vi) 与对称矩阵 $A$ 的谱分裂成两组相关的谱隙是一组中的特征值与另一组中的特征值之间绝对差的最小值。角度必须以弧度为单位进行测量。\n\n您的任务是编写一个完整的程序，该程序针对每个测试用例，使用这些定义执行以下所有步骤：\n\n1. 给定一个实对称矩阵 $A \\in \\mathbb{R}^{n \\times n}$、一个对称扰动矩阵 $E \\in \\mathbb{R}^{n \\times n}$ 以及一个整数 $k$（$1 \\le k \\le n-1$），构建 $\\tilde{A} = A + E$。\n2. 令 $U_k \\in \\mathbb{R}^{n \\times k}$ 为 $A$ 的不变子空间的标准正交基，该子空间由与 $A$ 的 $k$ 个最大特征值相关联的特征向量张成。令 $\\tilde{U}_k \\in \\mathbb{R}^{n \\times k}$ 为对 $\\tilde{A}$ 的类似定义。\n3. 通过使用 $U_k^\\top \\tilde{U}_k$ 的奇异值是主角的余弦这一定义，计算子空间 $\\mathcal{U}_k = \\mathrm{range}(U_k)$ 和 $\\tilde{\\mathcal{U}}_k = \\mathrm{range}(\\tilde{U}_k)$ 之间的最大主角 $\\theta_{\\max}$。提取 $U_k^\\top \\tilde{U}_k$ 的最小奇异值 $\\sigma_{\\min}$，然后计算 $\\sin(\\theta_{\\max}) = \\sqrt{1 - \\sigma_{\\min}^2}$。\n4. 计算谱范数 $\\|E\\|_2$。\n5. 仅使用 $A$ 的特征值计算在 $k$ 处分裂的谱隙 $\\delta$，定义为\n   $$ \\delta = \\min_{i \\in \\{1,\\dots,k\\},\\; j \\in \\{k+1,\\dots,n\\}} \\left| \\lambda_i - \\lambda_j \\right|, $$\n   其中 $\\lambda_1 \\ge \\lambda_2 \\ge \\cdots \\ge \\lambda_n$ 是 $A$ 的按非递增顺序排列的特征值。\n6. 比较两个非负量 $\\sin(\\theta_{\\max})$ 和比率 $r = \\|E\\|_2 / \\delta$。生成一个布尔值，当且仅当 $\\sin(\\theta_{\\max}) \\le r$ 在 $10^{-10}$ 的绝对容差内成立时（即，将 $\\sin(\\theta_{\\max}) \\le r + 10^{-10}$ 视为真），该值为真，否则为假。\n\n测试套件。您的程序必须硬编码并精确使用以下五个测试用例，每个用例由 $(A, E, k)$ 指定：\n\n- 测试用例 $1$：$n = 5$, $k = 2$,\n  $$ A = \\mathrm{diag}\\big([\\,5.0,\\;3.0,\\;1.0,\\;-1.0,\\;-2.0\\,]\\big), $$\n  $$ E = 0.02 \\times \\begin{bmatrix}\n  0  1  -1  0.5  0 \\\\\n  1  0  0.2  -0.3  0.1 \\\\\n  -1  0.2  0  0.1  0.4 \\\\\n  0.5  -0.3  0.1  0  -0.2 \\\\\n  0  0.1  0.4  -0.2  0\n  \\end{bmatrix}. $$\n\n- 测试用例 $2$：$n = 5$, $k = 2$,\n  $$ A = \\mathrm{diag}\\big([\\,1.0,\\;0.2,\\;0.0,\\;-1.0,\\;-2.0\\,]\\big), $$\n  $$ E = 0.01 \\times \\begin{bmatrix}\n  0  -0.5  0.3  0  0.1 \\\\\n  -0.5  0  0.2  -0.1  0 \\\\\n  0.3  0.2  0  0.4  -0.2 \\\\\n  0  -0.1  0.4  0  0.3 \\\\\n  0.1  0  -0.2  0.3  0\n  \\end{bmatrix}. $$\n\n- 测试用例 $3$：$n = 4$, $k = 2$,\n  $$ A = \\mathrm{diag}\\big([\\,3.0,\\;2.0,\\;1.0,\\;-1.0\\,]\\big), \\quad E = \\begin{bmatrix}\n  0  0  0  0 \\\\\n  0  0  0  0 \\\\\n  0  0  0  0 \\\\\n  0  0  0  0\n  \\end{bmatrix}. $$\n\n- 测试用例 $4$：$n = 6$, $k = 3$,\n  $$ A = \\mathrm{diag}\\big([\\,4.0,\\;3.0,\\;2.0,\\;-1.0,\\;-2.0,\\;-3.0\\,]\\big), $$\n  $$ E = 0.05 \\times \\begin{bmatrix}\n  0  0.3  -0.2  0.1  0  0 \\\\\n  0.3  0  0.25  -0.15  0.05  0 \\\\\n  -0.2  0.25  0  0.2  -0.1  0.05 \\\\\n  0.1  -0.15  0.2  0  0.3  -0.2 \\\\\n  0  0.05  -0.1  0.3  0  0.25 \\\\\n  0  0  0.05  -0.2  0.25  0\n  \\end{bmatrix}. $$\n\n- 测试用例 $5$：$n = 4$, $k = 2$,\n  $$ A = \\mathrm{diag}\\big([\\,1.0,\\;0.001,\\;0.0,\\;-1.0\\,]\\big), $$\n  $$ E = 0.00005 \\times \\begin{bmatrix}\n  0  1  0  0.2 \\\\\n  1  0  0.3  -0.1 \\\\\n  0  0.3  0  0.4 \\\\\n  0.2  -0.1  0.4  0\n  \\end{bmatrix}. $$\n\n角度单位说明：所有角度均以弧度为单位。最终比较直接使用 $\\sin(\\theta_{\\max})$，因此不需要转换。\n\n最终输出格式。您的程序应生成单行输出，其中包含五个测试用例的结果，格式为方括号内以逗号分隔的布尔值列表，不含空格。例如，输出可能像`[True,False,True,True,True]`，但没有空格：`[True,False,True,True,True]`。",
            "solution": "该问题要求对一个与对称矩阵不变子空间扰动相关的不等式进行数值验证。这个不等式是 Davis-Kahan $\\sin\\Theta$ 定理的一种形式，该定理是矩阵扰动理论中的一个基本结果。该定理给出了矩阵 $A$ 的一个不变子空间与一个扰动后矩阵 $\\tilde{A} = A + E$ 的相应不变子空间之间角度的界。\n\n该过程针对几个测试用例执行，每个用例由一个实对称矩阵 $A \\in \\mathbb{R}^{n \\times n}$、一个对称扰动矩阵 $E \\in \\mathbb{R}^{n \\times n}$ 以及一个定义了谱划分的整数 $k$ 定义。对于每个用例，我们必须计算两个量并进行比较。第一个量是 $\\sin(\\theta_{\\max})$，其中 $\\theta_{\\max}$ 是与 $A$ 的 $k$ 个最大特征值关联的不变子空间与 $\\tilde{A}$ 的相应子空间之间的最大主角。第二个量是比率 $r = \\|E\\|_2 / \\delta$，其中 $\\|E\\|_2$ 是扰动矩阵的谱范数，$\\delta$ 是 $A$ 在划分点 $k$ 处的谱隙。最后一步是在给定的数值容差内验证不等式 $\\sin(\\theta_{\\max}) \\le r$ 是否成立。\n\n对于每个测试用例 $(A, E, k)$，算法按以下步骤进行：\n\n1.  **构建扰动矩阵**：\n    给定实对称矩阵 $A$ 和对称扰动矩阵 $E$，我们构建扰动矩阵 $\\tilde{A}$ 为它们的和：\n    $$ \\tilde{A} = A + E $$\n    由于 $A$ 和 $E$ 是对称的，$\\tilde{A}$ 也是一个实对称矩阵。\n\n2.  **确定不变子空间**：\n    我们必须找到 $A$ 和 $\\tilde{A}$ 的与它们 $k$ 个最大特征值相对应的不变子空间的标准正交基。\n    首先，对于矩阵 $A$，我们求解特征值问题 $Av = \\lambda v$。由于 $A$ 是对称的，它有完备的 $n$ 个实特征值 $\\lambda_1, \\lambda_2, \\dots, \\lambda_n$ 以及相应的标准正交特征向量基 $v_1, v_2, \\dots, v_n$。我们将特征值按非递增顺序排序：$\\lambda_1 \\ge \\lambda_2 \\ge \\cdots \\ge \\lambda_n$。\n    不变子空间 $\\mathcal{U}_k$ 是由与 $k$ 个最大特征值相对应的特征向量 $\\{v_1, \\dots, v_k\\}$ 张成的子空间。该子空间的一个标准正交基由矩阵 $U_k \\in \\mathbb{R}^{n \\times k}$ 给出，其列是这些特征向量：\n    $$ U_k = \\begin{bmatrix} v_1  v_2  \\cdots  v_k \\end{bmatrix} $$\n    类似地，我们计算 $\\tilde{A}$ 的特征值 $\\tilde{\\lambda}_i$ 和特征向量 $\\tilde{v}_i$，将它们按非递增顺序排序，并从与 $\\tilde{A}$ 的 $k$ 个最大特征值相对应的特征向量构建矩阵 $\\tilde{U}_k \\in \\mathbb{R}^{n \\times k}$：\n    $$ \\tilde{U}_k = \\begin{bmatrix} \\tilde{v}_1  \\tilde{v}_2  \\cdots  \\tilde{v}_k \\end{bmatrix} $$\n    由 $\\tilde{U}_k$ 的列张成的子空间记为 $\\tilde{\\mathcal{U}}_k$。\n\n3.  **计算最大主角的正弦值**：\n    子空间 $\\mathcal{U}_k$ 和 $\\tilde{\\mathcal{U}}_k$ 之间的主角是通过矩阵 $U_k^\\top \\tilde{U}_k$ 的奇异值来定义的。设这个 $k \\times k$ 矩阵的奇异值为 $s_1 \\ge s_2 \\ge \\cdots \\ge s_k$。这些奇异值是主角 $\\theta_i$ 的余弦，所以 $s_i = \\cos(\\theta_i)$。这些角度被排序，使得 $0 \\le \\theta_1 \\le \\theta_2 \\le \\dots \\le \\theta_k \\le \\pi/2$。\n    最大主角 $\\theta_{\\max} = \\theta_k$ 对应于最小奇异值 $\\sigma_{\\min} = s_k = \\cos(\\theta_{\\max})$。使用三角恒等式 $\\sin^2(\\theta) + \\cos^2(\\theta) = 1$，我们可以计算 $\\sin(\\theta_{\\max})$：\n    $$ \\sin(\\theta_{\\max}) = \\sqrt{1 - \\cos^2(\\theta_{\\max})} = \\sqrt{1 - \\sigma_{\\min}^2} $$\n    此计算需要找到 $U_k^\\top \\tilde{U}_k$ 的奇异值分解（SVD）并确定最小奇异值。\n\n4.  **计算扰动矩阵的谱范数**：\n    矩阵 $E$ 的谱范数，记为 $\\|E\\|_2$，定义为其最大的奇异值。该值衡量了由 $E$ 表示的线性变换的最大“拉伸”效应。\n\n5.  **计算谱隙**：\n    谱隙 $\\delta$ 量化了 $A$ 的前 $k$ 个特征值集合与剩下 $n-k$ 个特征值集合之间的分离程度。它定义为：\n    $$ \\delta = \\min_{i \\in \\{1,\\dots,k\\},\\; j \\in \\{k+1,\\dots,n\\}} \\left| \\lambda_i - \\lambda_j \\right| $$\n    由于特征值按非递增顺序排序（$\\lambda_1 \\ge \\cdots \\ge \\lambda_k \\ge \\lambda_{k+1} \\ge \\cdots \\ge \\lambda_n$），这个最小差值就是第 $k$ 个和第 $(k+1)$ 个特征值之间的差：\n    $$ \\delta = \\lambda_k - \\lambda_{k+1} $$\n    非零的谱隙（$\\delta  0$）对于不变子空间 $\\mathcal{U}_k$ 的稳定性至关重要。问题陈述通过提供具有不同特征值的矩阵 $A$ 来确保所有测试用例的 $\\delta  0$。\n\n6.  **验证不等式**：\n    最后，我们比较计算出的两个非负量。我们评估布尔表达式：\n    $$ \\sin(\\theta_{\\max}) \\le \\frac{\\|E\\|_2}{\\delta} $$\n    由于浮点数运算，直接比较可能不可靠。因此，我们使用一个小的绝对容差 $\\epsilon = 10^{-10}$ 来检查该不等式：\n    $$ \\sin(\\theta_{\\max}) \\le \\frac{\\|E\\|_2}{\\delta} + \\epsilon $$\n    如果满足此条件，则每个测试用例的结果为 `True`，否则为 `False`。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem for all test cases by verifying a form of the\n    Davis-Kahan sin(Theta) theorem for each case.\n    \"\"\"\n\n    test_cases = [\n        # Test case 1\n        (\n            np.diag([5.0, 3.0, 1.0, -1.0, -2.0]),\n            0.02 * np.array([\n                [0.0, 1.0, -1.0, 0.5, 0.0],\n                [1.0, 0.0, 0.2, -0.3, 0.1],\n                [-1.0, 0.2, 0.0, 0.1, 0.4],\n                [0.5, -0.3, 0.1, 0.0, -0.2],\n                [0.0, 0.1, 0.4, -0.2, 0.0]\n            ]),\n            2\n        ),\n        # Test case 2\n        (\n            np.diag([1.0, 0.2, 0.0, -1.0, -2.0]),\n            0.01 * np.array([\n                [0.0, -0.5, 0.3, 0.0, 0.1],\n                [-0.5, 0.0, 0.2, -0.1, 0.0],\n                [0.3, 0.2, 0.0, 0.4, -0.2],\n                [0.0, -0.1, 0.4, 0.0, 0.3],\n                [0.1, 0.0, -0.2, 0.3, 0.0]\n            ]),\n            2\n        ),\n        # Test case 3\n        (\n            np.diag([3.0, 2.0, 1.0, -1.0]),\n            np.zeros((4, 4)),\n            2\n        ),\n        # Test case 4\n        (\n            np.diag([4.0, 3.0, 2.0, -1.0, -2.0, -3.0]),\n            0.05 * np.array([\n                [0.0, 0.3, -0.2, 0.1, 0.0, 0.0],\n                [0.3, 0.0, 0.25, -0.15, 0.05, 0.0],\n                [-0.2, 0.25, 0.0, 0.2, -0.1, 0.05],\n                [0.1, -0.15, 0.2, 0.0, 0.3, -0.2],\n                [0.0, 0.05, -0.1, 0.3, 0.0, 0.25],\n                [0.0, 0.0, 0.05, -0.2, 0.25, 0.0]\n            ]),\n            3\n        ),\n        # Test case 5\n        (\n            np.diag([1.0, 0.001, 0.0, -1.0]),\n            0.00005 * np.array([\n                [0.0, 1.0, 0.0, 0.2],\n                [1.0, 0.0, 0.3, -0.1],\n                [0.0, 0.3, 0.0, 0.4],\n                [0.2, -0.1, 0.4, 0.0]\n            ]),\n            2\n        )\n    ]\n\n    results = []\n    \n    def get_invariant_subspace(matrix, k):\n        \"\"\"\n        Computes the orthonormal basis for the invariant subspace spanned by the\n        eigenvectors associated with the k largest eigenvalues of a symmetric matrix.\n        \"\"\"\n        # eigh is for symmetric matrices. It returns eigenvalues and eigenvectors.\n        # Eigenvalues are not guaranteed to be sorted.\n        eigenvalues, eigenvectors = np.linalg.eigh(matrix)\n        \n        # Sort eigenvalues in descending order and get the sorting indices\n        sorted_indices = np.argsort(eigenvalues)[::-1]\n        \n        # Reorder eigenvectors according to sorted eigenvalues\n        sorted_eigenvectors = eigenvectors[:, sorted_indices]\n        \n        # The basis for the subspace is the matrix of the first k eigenvectors\n        U_k = sorted_eigenvectors[:, :k]\n        \n        return U_k, eigenvalues[sorted_indices]\n\n    for A, E, k in test_cases:\n        # Step 1: Form the perturbed matrix\n        A_tilde = A + E\n\n        # Step 2: Determine the invariant subspaces\n        U_k, lambda_A = get_invariant_subspace(A, k)\n        U_tilde_k, _ = get_invariant_subspace(A_tilde, k)\n\n        # Step 3: Compute the sine of the maximum principal angle\n        # The cosines of principal angles are the singular values of U_k.T @ U_tilde_k\n        svd_vals = np.linalg.svd(U_k.T @ U_tilde_k, compute_uv=False)\n        sigma_min = np.min(svd_vals)\n        # sin(theta_max) = sqrt(1 - cos^2(theta_max)) = sqrt(1 - sigma_min^2)\n        # Handle potential floating point inaccuracies where sigma_min > 1\n        sin_theta_max = np.sqrt(max(0, 1 - sigma_min**2))\n        \n        # Step 4: Compute the spectral norm of the perturbation\n        norm_E = np.linalg.norm(E, ord=2)\n\n        # Step 5: Compute the spectral gap\n        # lambda_A is already sorted in descending order\n        # The problem states 1 = k = n-1, so lambda_A[k] is safe\n        delta = lambda_A[k-1] - lambda_A[k]\n\n        # Step 6: Verify the inequality\n        # Avoid division by zero if delta is very small or zero, although\n        # test cases are designed to have delta > 0.\n        if delta > np.finfo(float).eps:\n            r = norm_E / delta\n        else: # Handle case of zero or numerically zero gap\n            # If norm_E is also zero, 0 = 0 is true.\n            # If norm_E > 0 and delta is 0, the bound is infinite. Inequality holds.\n            r = np.inf\n\n        # The inequality to check with an absolute tolerance of 1e-10\n        is_less_or_equal = (sin_theta_max = r + 1e-10)\n        results.append(is_less_or_equal)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}