{
    "hands_on_practices": [
        {
            "introduction": "掌握任何矩阵分解的第一步，都是通过一个简单的例子进行手动计算。这个练习将引导您完成为一个小的、满秩矩阵对构建广义奇异值分解（GSVD）的基本步骤。通过这个过程 ，您将加深对 GSVD 与广义特征值问题之间核心联系的理解，而这正是该分解的理论基石。",
            "id": "3547762",
            "problem": "考虑一对实数方阵 $$A=\\begin{bmatrix}1  0 \\\\ 0  2\\end{bmatrix},\\qquad B=\\begin{bmatrix}0  1 \\\\ 3  0\\end{bmatrix}.$$ 一个满秩矩阵对的广义奇异值分解 (GSVD) 定义如下：存在正交矩阵 $$U\\in\\mathbb{R}^{2\\times 2},\\quad V\\in\\mathbb{R}^{2\\times 2},$$ 一个可逆矩阵 $$X\\in\\mathbb{R}^{2\\times 2},$$ 以及非负对角矩阵 $$C=\\operatorname{diag}(c_{1},c_{2}),\\quad S=\\operatorname{diag}(s_{1},s_{2})$$ 使得 $$U^{\\top}AX=C,\\qquad V^{\\top}BX=S$$ 并且，在非零对角块上，有 $$C^{2}+S^{2}=I.$$ 从正交对角化、广义特征值问题和 GSVD 结构关系的基本定义出发，显式地构造一个对于给定矩阵对 $(A,B)$ 的有效 GSVD 五元组 $$(U,V,X,C,S)$$ 并验证 $$C^{2}+S^{2}=I$$ 在对角线上成立。最后，令 $$\\gamma_{i}=\\frac{c_{i}}{s_{i}}$$ 表示广义奇异值之比。计算标量 $$\\gamma_{1}\\gamma_{2}$$ 并以精确形式给出作为你的最终答案。",
            "solution": "该问题的陈述是有效的。这是一个数值线性代数中定义明确的问题，提供了所有必要的信息和定义，并且没有科学或逻辑上的不一致性。矩阵 $A$ 和 $B$ 由下式给出\n$$A=\\begin{bmatrix}1  0 \\\\ 0  2\\end{bmatrix},\\qquad B=\\begin{bmatrix}0  1 \\\\ 3  0\\end{bmatrix}$$\n$A$ 的行列式为 $\\det(A) = (1)(2) - (0)(0) = 2 \\neq 0$， $B$ 的行列式为 $\\det(B) = (0)(0) - (1)(3) = -3 \\neq 0$。两个矩阵都是满秩的，满足所述条件。\n\n广义奇异值分解 (GSVD) 的构造与广义特征值问题的解密切相关。广义奇异值 $\\gamma_i$ 是矩阵对 $(A^\\top A, B^\\top B)$ 的广义特征值 $\\lambda_i$ 的平方根。广义特征值问题由 $A^\\top A \\mathbf{x} = \\lambda B^\\top B \\mathbf{x}$ 给出。\n\n首先，我们计算矩阵 $A^\\top A$ 和 $B^\\top B$。\n$$A^\\top A = \\begin{bmatrix}1  0\\\\0  2\\end{bmatrix}^\\top \\begin{bmatrix}1  0\\\\0  2\\end{bmatrix} = \\begin{bmatrix}1  0\\\\0  2\\end{bmatrix} \\begin{bmatrix}1  0\\\\0  2\\end{bmatrix} = \\begin{bmatrix}1  0\\\\0  4\\end{bmatrix}$$\n$$B^\\top B = \\begin{bmatrix}0  3\\\\1  0\\end{bmatrix} \\begin{bmatrix}0  1\\\\3  0\\end{bmatrix} = \\begin{bmatrix}9  0\\\\0  1\\end{bmatrix}$$\n广义特征值问题是寻找 $\\lambda$ 使得 $\\det(A^\\top A - \\lambda B^\\top B) = 0$。\n$$A^\\top A - \\lambda B^\\top B = \\begin{bmatrix}1  0\\\\0  4\\end{bmatrix} - \\lambda \\begin{bmatrix}9  0\\\\0  1\\end{bmatrix} = \\begin{bmatrix}1-9\\lambda   0 \\\\ 0  4-\\lambda\\end{bmatrix}$$\n行列式为 $(1-9\\lambda)(4-\\lambda) = 0$。广义特征值为 $\\lambda_1 = 4$ 和 $\\lambda_2 = \\frac{1}{9}$。广义奇异值是它们的正平方根，$\\gamma = \\sqrt{\\lambda}$。我们有两个值，$2$ 和 $\\frac{1}{3}$。我们可以按任意顺序分配它们；最终的乘积 $\\gamma_1 \\gamma_2$ 将是不变的。我们稍后根据矩阵 $X$ 的构造来定义排序。\n\nGSVD 关系 $U^\\top A X = C$ 和 $V^\\top B X = S$ 意味着 $X^\\top A^\\top U U^\\top A X = C^2$ 和 $X^\\top B^\\top V V^\\top B X = S^2$。因为 $U$ 和 $V$ 是正交的，这可以简化为：\n$$X^\\top(A^\\top A)X = C^2 \\quad \\text{和} \\quad X^\\top(B^\\top B)X = S^2$$\n这意味着可逆矩阵 $X$ 的列构成一个可以同时对角化 $A^\\top A$ 和 $B^\\top B$ 的基。由于 $A^\\top A$ 和 $B^\\top B$ 已经是对角矩阵，它们可交换，并且可以被任何其列是经过缩放的标准基向量的矩阵同时对角化。设 $X$ 的列为 $\\mathbf{x}_1 = \\alpha_1 \\mathbf{e}_1$ 和 $\\mathbf{x}_2 = \\alpha_2 \\mathbf{e}_2$，其中 $\\mathbf{e}_1 = \\begin{pmatrix}1\\\\0\\end{pmatrix}$ 和 $\\mathbf{e}_2 = \\begin{pmatrix}0\\\\1\\end{pmatrix}$，并且 $\\alpha_1, \\alpha_2$ 是非零缩放因子。\n$$X = \\begin{bmatrix}\\alpha_1   0 \\\\ 0  \\alpha_2\\end{bmatrix}$$\n$C^2$ 和 $S^2$ 的对角元素由下式给出：\n$$c_1^2 = \\mathbf{x}_1^\\top(A^\\top A)\\mathbf{x}_1 = \\alpha_1^2 \\mathbf{e}_1^\\top(A^\\top A)\\mathbf{e}_1 = \\alpha_1^2(1) = \\alpha_1^2$$\n$$s_1^2 = \\mathbf{x}_1^\\top(B^\\top B)\\mathbf{x}_1 = \\alpha_1^2 \\mathbf{e}_1^\\top(B^\\top B)\\mathbf{e}_1 = \\alpha_1^2(9) = 9\\alpha_1^2$$\n$$c_2^2 = \\mathbf{x}_2^\\top(A^\\top A)\\mathbf{x}_2 = \\alpha_2^2 \\mathbf{e}_2^\\top(A^\\top A)\\mathbf{e}_2 = \\alpha_2^2(4) = 4\\alpha_2^2$$\n$$s_2^2 = \\mathbf{x}_2^\\top(B^\\top B)\\mathbf{x}_2 = \\alpha_2^2 \\mathbf{e}_2^\\top(B^\\top B)\\mathbf{e}_2 = \\alpha_2^2(1) = \\alpha_2^2$$\n归一化条件 $C^2+S^2=I$ 要求对于每个 $i \\in \\{1, 2\\}$ 都有 $c_i^2+s_i^2=1$。\n对于 $i=1$：$\\alpha_1^2 + 9\\alpha_1^2 = 1 \\implies 10\\alpha_1^2=1 \\implies \\alpha_1 = \\frac{1}{\\sqrt{10}}$ （我们选择正根）。\n对于 $i=2$：$4\\alpha_2^2 + \\alpha_2^2 = 1 \\implies 5\\alpha_2^2=1 \\implies \\alpha_2 = \\frac{1}{\\sqrt{5}}$。\n\n现在我们可以构造矩阵 $X$、$C$ 和 $S$。\n$$X = \\begin{bmatrix}\\frac{1}{\\sqrt{10}}   0 \\\\ 0  \\frac{1}{\\sqrt{5}}\\end{bmatrix}$$\n使用缩放因子，我们找到 $C$ 和 $S$ 的对角元素（必须为非负）。\n$c_1 = \\sqrt{\\alpha_1^2} = \\alpha_1 = \\frac{1}{\\sqrt{10}}$\n$s_1 = \\sqrt{9\\alpha_1^2} = 3\\alpha_1 = \\frac{3}{\\sqrt{10}}$\n$c_2 = \\sqrt{4\\alpha_2^2} = 2\\alpha_2 = \\frac{2}{\\sqrt{5}}$\n$s_2 = \\sqrt{\\alpha_2^2} = \\alpha_2 = \\frac{1}{\\sqrt{5}}$\n所以，对角矩阵为：\n$$C = \\begin{bmatrix}\\frac{1}{\\sqrt{10}}  0 \\\\ 0  \\frac{2}{\\sqrt{5}}\\end{bmatrix}, \\qquad S = \\begin{bmatrix}\\frac{3}{\\sqrt{10}}  0 \\\\ 0  \\frac{1}{\\sqrt{5}}\\end{bmatrix}$$\n我们验证条件 $C^2+S^2=I$：\n$$C^2+S^2 = \\begin{bmatrix}\\frac{1}{10}  0 \\\\ 0  \\frac{4}{5}\\end{bmatrix} + \\begin{bmatrix}\\frac{9}{10}  0 \\\\ 0  \\frac{1}{5}\\end{bmatrix} = \\begin{bmatrix}\\frac{1}{10}+\\frac{9}{10}  0 \\\\ 0  \\frac{4}{5}+\\frac{1}{5}\\end{bmatrix} = \\begin{bmatrix}1  0 \\\\ 0  1\\end{bmatrix} = I$$\n该条件得到满足。\n\n接下来，我们构造正交矩阵 $U$ 和 $V$。\n由 $U^\\top A X = C$，我们有 $A X = U C$。因此，$U = (AX)C^{-1}$。\n$$AX = \\begin{bmatrix}1  0\\\\0  2\\end{bmatrix}\\begin{bmatrix}\\frac{1}{\\sqrt{10}}  0 \\\\ 0  \\frac{1}{\\sqrt{5}}\\end{bmatrix} = \\begin{bmatrix}\\frac{1}{\\sqrt{10}}  0 \\\\ 0  \\frac{2}{\\sqrt{5}}\\end{bmatrix}$$\n$$C^{-1} = \\begin{bmatrix}\\sqrt{10}  0 \\\\ 0  \\frac{\\sqrt{5}}{2}\\end{bmatrix}$$\n$$U = (AX)C^{-1} = \\begin{bmatrix}\\frac{1}{\\sqrt{10}}  0 \\\\ 0  \\frac{2}{\\sqrt{5}}\\end{bmatrix}\\begin{bmatrix}\\sqrt{10}  0 \\\\ 0  \\frac{\\sqrt{5}}{2}\\end{bmatrix} = \\begin{bmatrix}1  0 \\\\ 0  1\\end{bmatrix}=I_2$$\n$U=I_2$ 是一个正交矩阵。\n\n由 $V^\\top B X = S$，我们有 $B X = V S$。因此，$V = (BX)S^{-1}$。\n$$BX = \\begin{bmatrix}0  1\\\\3  0\\end{bmatrix}\\begin{bmatrix}\\frac{1}{\\sqrt{10}}  0 \\\\ 0  \\frac{1}{\\sqrt{5}}\\end{bmatrix} = \\begin{bmatrix}0  \\frac{1}{\\sqrt{5}} \\\\ \\frac{3}{\\sqrt{10}}  0 \\end{bmatrix}$$\n$$S^{-1} = \\begin{bmatrix}\\frac{\\sqrt{10}}{3}  0 \\\\ 0  \\sqrt{5}\\end{bmatrix}$$\n$$V = (BX)S^{-1} = \\begin{bmatrix}0  \\frac{1}{\\sqrt{5}} \\\\ \\frac{3}{\\sqrt{10}}  0 \\end{bmatrix}\\begin{bmatrix}\\frac{\\sqrt{10}}{3}  0 \\\\ 0  \\sqrt{5}\\end{bmatrix} = \\begin{bmatrix}0  1 \\\\ 1  0\\end{bmatrix}$$\n$V=\\begin{bmatrix}0  1 \\\\ 1  0\\end{bmatrix}$ 是一个正交矩阵。\n\n我们已经成功构造了一个有效的 GSVD 五元组 $(U,V,X,C,S)$：\n$$U=\\begin{bmatrix}1  0\\\\0  1\\end{bmatrix}, \\quad V=\\begin{bmatrix}0  1\\\\1  0\\end{bmatrix}, \\quad X=\\begin{bmatrix}\\frac{1}{\\sqrt{10}}  0\\\\0  \\frac{1}{\\sqrt{5}}\\end{bmatrix}, \\quad C=\\begin{bmatrix}\\frac{1}{\\sqrt{10}}  0\\\\0  \\frac{2}{\\sqrt{5}}\\end{bmatrix}, \\quad S=\\begin{bmatrix}\\frac{3}{\\sqrt{10}}  0\\\\0  \\frac{1}{\\sqrt{5}}\\end{bmatrix}$$\n\n最后，我们计算广义奇异值之比 $\\gamma_i = \\frac{c_i}{s_i}$ 及其乘积。\n$$\\gamma_1 = \\frac{c_1}{s_1} = \\frac{1/\\sqrt{10}}{3/\\sqrt{10}} = \\frac{1}{3}$$\n$$\\gamma_2 = \\frac{c_2}{s_2} = \\frac{2/\\sqrt{5}}{1/\\sqrt{5}} = 2$$\n乘积是：\n$$\\gamma_1\\gamma_2 = \\left(\\frac{1}{3}\\right) \\times 2 = \\frac{2}{3}$$\n广义奇异值的乘积是 $\\sqrt{\\det((B^\\top B)^{-1}(A^\\top A))}$。\n$$(B^\\top B)^{-1} = \\begin{bmatrix}1/9  0\\\\0  1\\end{bmatrix}$$\n$$(B^\\top B)^{-1}(A^\\top A) = \\begin{bmatrix}1/9  0\\\\0  1\\end{bmatrix}\\begin{bmatrix}1  0\\\\0  4\\end{bmatrix} = \\begin{bmatrix}1/9  0\\\\0  4\\end{bmatrix}$$\n该矩阵的特征值为 $\\frac{1}{9}$ 和 $4$，它们是我们 $\\gamma_i$ 的平方。$\\gamma_i$ 的乘积是 $\\sqrt{(\\frac{1}{9})(4)} = \\sqrt{\\frac{4}{9}} = \\frac{2}{3}$。这证实了我们的结果。",
            "answer": "$$\\boxed{\\frac{2}{3}}$$"
        },
        {
            "introduction": "广义奇异值分解（GSVD）的威力在处理非满秩矩阵时才真正显现。本练习将探讨这样一种情况，展示 GSVD 如何优雅地处理奇异矩阵。通过这个简单的例子 ，我们将看到零和无穷大广义奇异值的出现，并理解它们的实际含义。",
            "id": "3547804",
            "problem": "设 $A \\in \\mathbb{R}^{2 \\times 2}$ 和 $B \\in \\mathbb{R}^{2 \\times 2}$ 由下式给出\n$$\nA=\\begin{bmatrix}1  0 \\\\ 0  0\\end{bmatrix}, \\qquad B=\\begin{bmatrix}0  0 \\\\ 0  1\\end{bmatrix}.\n$$\n一对矩阵 $(A,B)$ 的广义奇异值分解 (GSVD) 定义如下：存在正交矩阵 $U \\in \\mathbb{R}^{2 \\times 2}$ 和 $V \\in \\mathbb{R}^{2 \\times 2}$ 以及一个可逆矩阵 $X \\in \\mathbb{R}^{2 \\times 2}$，使得\n$$\nU^{\\top} A X = C, \\qquad V^{\\top} B X = S,\n$$\n其中 $C=\\operatorname{diag}(c_1,c_2)$ 和 $S=\\operatorname{diag}(s_1,s_2)$ 的对角线元素为非负，并满足 $C^{\\top} C + S^{\\top} S = I_2$。广义奇异值定义为 $\\gamma_i = \\frac{c_i}{s_i}$，其中约定，若 $c_i=0$ 且 $s_i0$，则 $\\gamma_i=0$；若 $c_i0$ 且 $s_i=0$，则 $\\gamma_i=+\\infty$。\n\n从 GSVD 的定义以及正交矩阵和对角矩阵的性质出发，通过显式地确定合适的 $U$、$V$、$X$ 以及 $C$ 和 $S$ 的对角线元素，为 $(A,B)$ 构建一个 GSVD。然后计算广义奇异值 $\\gamma_1$ 和 $\\gamma_2$，并将每个值分类为零、有限或无限。\n\n请提供广义奇异值的有序对 $(\\gamma_1,\\gamma_2)$ 作为最终答案，形式为单一的精确表达式。无需四舍五入。",
            "solution": "问题要求我们为矩阵 $A = \\begin{bmatrix}1  0 \\\\ 0  0\\end{bmatrix}$ 和 $B = \\begin{bmatrix}0  0 \\\\ 0  1\\end{bmatrix}$ 找到一个广义奇异值分解 (GSVD)。这涉及到寻找正交矩阵 $U, V \\in \\mathbb{R}^{2 \\times 2}$ 和一个可逆矩阵 $X \\in \\mathbb{R}^{2 \\times 2}$，使得 $U^{\\top} A X = C$ 和 $V^{\\top} B X = S$，其中 $C=\\operatorname{diag}(c_1, c_2)$ 和 $S=\\operatorname{diag}(s_1, s_2)$ 是对角矩阵，其非负对角线元素满足 $C^{\\top} C + S^{\\top} S = I_2$。\n\n给定的矩阵 $A$ 和 $B$ 已经是对角矩阵。这表明对变换矩阵进行简单的选择可能就足够了。让我们测试最直接的可能性，即为 $U$、$V$ 和 $X$ 选择单位矩阵。\n\n设 $U = I_2$，$V = I_2$，$X = I_2$。\n- 矩阵 $U=I_2$ 和 $V=I_2$ 是正交的，因为 $I_2^{\\top}I_2 = I_2$。\n- 矩阵 $X=I_2$ 是可逆的，因为 $\\det(I_2) = 1 \\neq 0$。\n\n现在，我们使用这些选择来计算矩阵 $C$ 和 $S$：\n$$\nC = U^{\\top} A X = I_2^{\\top} A I_2 = A = \\begin{bmatrix}1  0 \\\\ 0  0\\end{bmatrix}\n$$\n$$\nS = V^{\\top} B X = I_2^{\\top} B I_2 = B = \\begin{bmatrix}0  0 \\\\ 0  1\\end{bmatrix}\n$$\n我们必须验证这些得到的矩阵 $C$ 和 $S$ 满足所需的性质。\n- $C$ 和 $S$ 是对角矩阵。\n- $C$ 的对角线元素是 $c_1=1$ 和 $c_2=0$，它们是非负的。\n- $S$ 的对角线元素是 $s_1=0$ 和 $s_2=1$，它们是非负的。\n\n要检查的最后一个条件是 $C^{\\top} C + S^{\\top} S = I_2$。\n$$\nC^{\\top} C = \\begin{bmatrix}1  0 \\\\ 0  0\\end{bmatrix}^{\\top} \\begin{bmatrix}1  0 \\\\ 0  0\\end{bmatrix} = \\begin{bmatrix}1  0 \\\\ 0  0\\end{bmatrix} \\begin{bmatrix}1  0 \\\\ 0  0\\end{bmatrix} = \\begin{bmatrix}1  0 \\\\ 0  0\\end{bmatrix}\n$$\n$$\nS^{\\top} S = \\begin{bmatrix}0  0 \\\\ 0  1\\end{bmatrix}^{\\top} \\begin{bmatrix}0  0 \\\\ 0  1\\end{bmatrix} = \\begin{bmatrix}0  0 \\\\ 0  1\\end{bmatrix} \\begin{bmatrix}0  0 \\\\ 0  1\\end{bmatrix} = \\begin{bmatrix}0  0 \\\\ 0  1\\end{bmatrix}\n$$\n将它们相加：\n$$\nC^{\\top} C + S^{\\top} S = \\begin{bmatrix}1  0 \\\\ 0  0\\end{bmatrix} + \\begin{bmatrix}0  0 \\\\ 0  1\\end{bmatrix} = \\begin{bmatrix}1  0 \\\\ 0  1\\end{bmatrix} = I_2\n$$\n所有条件都已满足。因此，对 $(A,B)$ 的一个有效 GSVD 由 $U=I_2$，$V=I_2$，$X=I_2$，$C=\\operatorname{diag}(1,0)$ 和 $S=\\operatorname{diag}(0,1)$ 给出。\n\n现在，我们使用 $C$ 和 $S$ 的对角线元素以及提供的约定来计算广义奇异值 $\\gamma_i = \\frac{c_i}{s_i}$。\n对于 $i=1$：\n$c_1=1$, $s_1=0$。这种情况符合 $c_i  0$ 且 $s_i=0$ 的约定，因此广义奇异值定义为无穷大。\n$$\n\\gamma_1 = +\\infty\n$$\n对于 $i=2$：\n$c_2=0$, $s_2=1$。这种情况符合 $c_i = 0$ 且 $s_i0$ 的约定，因此广义奇异值定义为零。\n$$\n\\gamma_2 = \\frac{0}{1} = 0\n$$\n\n每个值都已分类：$\\gamma_1$ 是无限的，$\\gamma_2$ 是零。问题要求提供有序对 $(\\gamma_1, \\gamma_2)$。根据我们的构造，这个对是 $(\\infty, 0)$。按照惯例，广义奇异值通常按降序排列，由于 $\\infty  0$，这个排序是标准的。\n\n广义奇异值的有序对是 $(\\infty, 0)$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\infty  0 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "GSVD 不仅仅是理论上的一个奇妙构造，它更是解决不适定反问题的强大工具。这个高级练习将 GSVD 应用于吉洪诺夫正则化（Tikhonov regularization）的背景下，这是科学计算中的一个基石技术。我们将研究预处理如何影响问题，并利用 GSVD 揭示的结构来设计一个最优的预处理策略，以改善解的数值属性 。",
            "id": "3547807",
            "problem": "考虑一个经过对角行预处理的矩阵对的广义奇异值分解 (GSVD)。设 $A \\in \\mathbb{R}^{3 \\times 1}$ 和 $B \\in \\mathbb{R}^{2 \\times 1}$ 为\n$$\nA = \\begin{pmatrix} 4 \\\\ 2 \\\\ 1 \\end{pmatrix}, \\quad B = \\begin{pmatrix} 3 \\\\ 1 \\end{pmatrix}.\n$$\n我们研究由正定对角矩阵 $P = \\mathrm{diag}(p_1,p_2,p_3)$ 和 $Q = \\mathrm{diag}(q_1,q_2)$ 对矩阵对 $(A,B)$ 的 GSVD 进行左（行）预处理的影响，并施加约束条件 $p_i \\in [\\tfrac{1}{2},2]$，$q_j \\in [\\tfrac{1}{2},2]$，以及 $\\prod_{i=1}^{3} p_i = 1$，$\\prod_{j=1}^{2} q_j = 1$。使用以下基本依据：\n\n- 广义奇异值分解 (GSVD) 的定义：对于 $A \\in \\mathbb{R}^{m \\times n}$ 和 $B \\in \\mathbb{R}^{p \\times n}$，且 $\\mathrm{rank}\\begin{pmatrix} A \\\\ B \\end{pmatrix}=n$，存在正交矩阵 $U \\in \\mathbb{R}^{m \\times m}$、$V \\in \\mathbb{R}^{p \\times p}$、非奇异矩阵 $X \\in \\mathbb{R}^{n \\times n}$，以及非负对角矩阵 $C,S \\in \\mathbb{R}^{n \\times n}$ 满足 $C^{\\top} C + S^{\\top} S = I$，使得 $A = U \\begin{pmatrix} C \\\\ 0 \\end{pmatrix} X^{-1}$ 且 $B = V \\begin{pmatrix} S \\\\ 0 \\end{pmatrix} X^{-1}$。当 $n=1$ 时，有标量 $c \\ge 0$ 和 $s \\ge 0$ 满足 $c^2 + s^2 = 1$，广义奇异值为 $\\gamma = c/s$。\n\n- Tikhonov 正则化的正规方程：对于数据 $y \\in \\mathbb{R}^{3}$ 和参数 $\\lambda  0$，$\\min_{x \\in \\mathbb{R}} \\|A x - y\\|_2^2 + \\lambda^2 \\|B x\\|_2^2$ 的最小值点满足 $(A^{\\top} A + \\lambda^2 B^{\\top} B) x = A^{\\top} y$。在左预处理下，问题变为 $\\min_{x \\in \\mathbb{R}} \\|P A x - P y\\|_2^2 + \\lambda'^2 \\|Q B x\\|_2^2$，其正规方程为 $(A^{\\top} P^{\\top} P A + \\lambda'^2 B^{\\top} Q^{\\top} Q B) x = A^{\\top} P^{\\top} P y$。\n\n假设存在无噪声的一致性数据 $y = A x_{\\star}$，其中 $x_{\\star} \\neq 0$。分析在 $n=1$ 的情况下，预处理对矩阵对 $(P A,Q B)$ 的 GSVD 的影响，并证明 GSVD 的余弦和正弦为\n$$\nc = \\frac{\\|P A\\|_2}{\\sqrt{\\|P A\\|_2^2 + \\|Q B\\|_2^2}}, \\qquad s = \\frac{\\|Q B\\|_2}{\\sqrt{\\|P A\\|_2^2 + \\|Q B\\|_2^2}}.\n$$\n从正规方程出发，证明当正则化参数被重新调整为\n$$\n\\lambda'^2 = \\frac{\\|P A\\|_2^2}{\\|A\\|_2^2} \\cdot \\frac{\\|B\\|_2^2}{\\|Q B\\|_2^2} \\, \\lambda^2\n$$\n时，Tikhonov 最小值点不受行预处理器的影响。\n现在，在所述的界限和乘积约束下设计 $P$ 和 $Q$，以最大化由目标函数 $\\phi(c,s) = c^2 - s^2$ 量化的 GSVD 分量的分离度，同时由于上述对 $\\lambda$ 的重新调整而不改变 Tikhonov 解。以精确的闭合形式计算由此产生的 $c$ 的最优值。你的最终答案必须是单一的精确表达式；不要四舍五入。",
            "solution": "问题要求我们为预处理后的矩阵对 $(PA, QB)$ 找到广义奇异值余弦 $c$ 的最优值，该值在对角预处理器 $P$ 和 $Q$ 的一组约束条件下，最大化目标函数 $\\phi(c,s) = c^2 - s^2$。\n\n首先，我们解决问题陈述所要求的初步证明。\n\n对于矩阵对 $(G, H)$，其中 $G \\in \\mathbb{R}^{m \\times 1}$ 和 $H \\in \\mathbb{R}^{p \\times 1}$ 是非零列向量，其广义奇异值分解 (GSVD) 大大简化。广义奇异值 $\\gamma$ 由广义特征值问题 $G^{\\top}G x = \\gamma^2 H^{\\top}H x$ 确定。由于 $G$ 和 $H$ 是列向量，并且我们寻求标量 $x$ 的非平凡解，此方程简化为 $\\|G\\|_2^2 = \\gamma^2 \\|H\\|_2^2$。因此，$\\gamma^2 = \\frac{\\|G\\|_2^2}{\\|H\\|_2^2}$。根据 $n=1$ 情况的定义，$\\gamma = c/s$，其中 $c^2 + s^2 = 1$。结合这些，我们得到 $\\frac{c^2}{s^2} = \\frac{\\|G\\|_2^2}{\\|H\\|_2^2}$，这导致 $c^2 \\|H\\|_2^2 = s^2 \\|G\\|_2^2 = (1-c^2)\\|G\\|_2^2$。解出 $c^2$ 可得 $c^2 (\\|H\\|_2^2 + \\|G\\|_2^2) = \\|G\\|_2^2$，所以 $c^2 = \\frac{\\|G\\|_2^2}{\\|G\\|_2^2 + \\|H\\|_2^2}$。因为 $c \\ge 0$，我们有 $c = \\frac{\\|G\\|_2}{\\sqrt{\\|G\\|_2^2 + \\|H\\|_2^2}}$。因此，$s^2 = 1 - c^2 = \\frac{\\|H\\|_2^2}{\\|G\\|_2^2 + \\|H\\|_2^2}$，所以 $s = \\frac{\\|H\\|_2}{\\sqrt{\\|G\\|_2^2 + \\|H\\|_2^2}}$。将此应用于预处理后的矩阵对 $G=PA$ 和 $H=QB$，我们得到问题中给出的表达式：\n$$\nc = \\frac{\\|P A\\|_2}{\\sqrt{\\|P A\\|_2^2 + \\|Q B\\|_2^2}}, \\qquad s = \\frac{\\|Q B\\|_2}{\\sqrt{\\|P A\\|_2^2 + \\|Q B\\|_2^2}}.\n$$\n\n接下来，我们证明 Tikhonov 正则化解在正则化参数的指定重新调整下保持不变。对于标量未知数 $x$ 的原始问题，解为 $x = \\frac{A^{\\top}y}{A^{\\top}A + \\lambda^2 B^{\\top}B}$。对于无噪声数据 $y=Ax_{\\star}$，解为 $x = \\frac{A^{\\top}A x_{\\star}}{A^{\\top}A + \\lambda^2 B^{\\top}B} = \\frac{\\|A\\|_2^2}{\\|A\\|_2^2 + \\lambda^2 \\|B\\|_2^2} x_{\\star}$。\n对于预处理问题，解 $x'$ 为 $x' = \\frac{(PA)^{\\top}(Py)}{(PA)^{\\top}(PA) + \\lambda'^2 (QB)^{\\top}(QB)}$。对于 $y=Ax_{\\star}$，这变为 $x' = \\frac{A^{\\top}P^{\\top}P A x_{\\star}}{A^{\\top}P^{\\top}P A + \\lambda'^2 B^{\\top}Q^{\\top}Q B} = \\frac{\\|PA\\|_2^2}{\\|PA\\|_2^2 + \\lambda'^2 \\|QB\\|_2^2} x_{\\star}$。\n我们必须证明 $x=x'$。这要求滤波因子相等：\n$$\n\\frac{\\|A\\|_2^2}{\\|A\\|_2^2 + \\lambda^2 \\|B\\|_2^2} = \\frac{\\|PA\\|_2^2}{\\|PA\\|_2^2 + \\lambda'^2 \\|QB\\|_2^2}.\n$$\n将给定的重新调整规则 $\\lambda'^2 = \\frac{\\|P A\\|_2^2}{\\|A\\|_2^2} \\cdot \\frac{\\|B\\|_2^2}{\\|Q B\\|_2^2} \\, \\lambda^2$ 代入右侧分式的分母，得到：\n$$\n\\|PA\\|_2^2 + \\left(\\frac{\\|P A\\|_2^2}{\\|A\\|_2^2} \\cdot \\frac{\\|B\\|_2^2}{\\|Q B\\|_2^2} \\, \\lambda^2\\right) \\|QB\\|_2^2 = \\|PA\\|_2^2 + \\frac{\\|P A\\|_2^2 \\|B\\|_2^2}{\\|A\\|_2^2} \\lambda^2 = \\|PA\\|_2^2 \\left(1 + \\frac{\\|B\\|_2^2}{\\|A\\|_2^2} \\lambda^2\\right) = \\|PA\\|_2^2 \\frac{\\|A\\|_2^2 + \\lambda^2 \\|B\\|_2^2}{\\|A\\|_2^2}.\n$$\n于是等式右侧变为：\n$$\n\\frac{\\|PA\\|_2^2}{\\|PA\\|_2^2 \\frac{\\|A\\|_2^2 + \\lambda^2 \\|B\\|_2^2}{\\|A\\|_2^2}} = \\frac{\\|A\\|_2^2}{\\|A\\|_2^2 + \\lambda^2 \\|B\\|_2^2}.\n$$\n这与左侧相同，从而证实了解的不变性。\n\n现在我们进行主要的优化任务。目标是最大化 $\\phi(c,s) = c^2 - s^2$。使用 $c^2$ 和 $s^2$ 的表达式，我们有：\n$$\n\\phi = \\frac{\\|P A\\|_2^2}{\\|P A\\|_2^2 + \\|Q B\\|_2^2} - \\frac{\\|Q B\\|_2^2}{\\|P A\\|_2^2 + \\|Q B\\|_2^2} = \\frac{\\|P A\\|_2^2 - \\|Q B\\|_2^2}{\\|P A\\|_2^2 + \\|Q B\\|_2^2}.\n$$\n设 $X = \\|P A\\|_2^2$ 和 $Y = \\|Q B\\|_2^2$。我们希望最大化 $\\phi = \\frac{X-Y}{X+Y} = \\frac{X/Y - 1}{X/Y + 1}$。由于此函数对于 $R0$ 是关于比率 $R = X/Y$ 单调递增的，最大化 $\\phi$ 等价于最大化 $R$。这进而通过最大化分子 $X$ 和最小化分母 $Y$ 来实现。$X$ 和 $Y$ 的优化问题是解耦的。\n\n我们来计算 $X$ 和 $Y$。给定 $A = \\begin{pmatrix} 4 \\\\ 2 \\\\ 1 \\end{pmatrix}$ 和 $B = \\begin{pmatrix} 3 \\\\ 1 \\end{pmatrix}$，以及预处理器 $P = \\mathrm{diag}(p_1, p_2, p_3)$，$Q = \\mathrm{diag}(q_1, q_2)$：\n$$\nX = \\|PA\\|_2^2 = \\left\\| \\begin{pmatrix} 4p_1 \\\\ 2p_2 \\\\ p_3 \\end{pmatrix} \\right\\|_2^2 = 16p_1^2 + 4p_2^2 + p_3^2.\n$$\n$$\nY = \\|QB\\|_2^2 = \\left\\| \\begin{pmatrix} 3q_1 \\\\ q_2 \\end{pmatrix} \\right\\|_2^2 = 9q_1^2 + q_2^2.\n$$\n\n我们首先在约束 $p_1 p_2 p_3 = 1$ 和 $p_i \\in [\\frac{1}{2}, 2]$ 下最大化 $X = 16p_1^2 + 4p_2^2 + p_3^2$。$X$ 的值是平方加权和。为了最大化它，我们应该将尽可能大的 $p_i$ 值赋给具有最大系数的项。最大系数是 16，对应于 $p_1$。我们将 $p_1$ 设为其最大可能值，$p_1=2$。约束变为 $p_2 p_3 = \\frac{1}{2}$。$p_2, p_3$ 的约束是 $p_2, p_3 \\in [\\frac{1}{2}, 2]$。代入 $p_3 = \\frac{1}{2p_2}$，条件 $p_3 \\ge \\frac{1}{2}$ 意味着 $\\frac{1}{2p_2} \\ge \\frac{1}{2}$，所以 $p_2 \\le 1$。条件 $p_3 \\le 2$ 意味着 $\\frac{1}{2p_2} \\le 2$，所以 $p_2 \\ge \\frac{1}{4}$。结合 $p_2 \\in [\\frac{1}{2}, 2]$， $p_2$ 的可行范围是 $[\\frac{1}{2}, 1]$。\n对于 $p_1=2$，我们在 $p_2 \\in [\\frac{1}{2}, 1]$ 上最大化 $X = 16(2^2) + 4p_2^2 + (\\frac{1}{2p_2})^2 = 64 + 4p_2^2 + \\frac{1}{4p_2^2}$。设 $f(p_2) = 4p_2^2 + \\frac{1}{4p_2^2}$。其导数为 $f'(p_2) = 8p_2 - \\frac{1}{2p_2^3}$。在 $[\\frac{1}{2}, 1]$ 上，$f'(p_2) \\ge 8(\\frac{1}{2}) - \\frac{1}{2(1/8)} = 4-4=0$。该函数是非递减的，因此其最大值在 $p_2=1$ 处取得。\n当 $p_1=2$ 和 $p_2=1$ 时，我们得到 $p_3 = \\frac{1}{2(1)} = \\frac{1}{2}$。所有约束都得到满足。\n$X$ 的最大值为 $X_{max} = 16(2^2) + 4(1^2) + (\\frac{1}{2})^2 = 64 + 4 + \\frac{1}{4} = 68.25 = \\frac{273}{4}$。\n\n接下来，我们在约束 $q_1 q_2 = 1$ 和 $q_j \\in [\\frac{1}{2}, 2]$ 下最小化 $Y = 9q_1^2 + q_2^2$。设 $q_1 = t$。则 $q_2=1/t$。约束 $q_1, q_2 \\in [\\frac{1}{2}, 2]$ 意味着 $t \\in [\\frac{1}{2}, 2]$。我们在区间 $t \\in [\\frac{1}{2}, 2]$ 上最小化 $Y(t) = 9t^2 + \\frac{1}{t^2}$。\n其导数为 $Y'(t) = 18t - \\frac{2}{t^3}$。令 $Y'(t)=0$ 得到 $18t^4 = 2$，所以 $t^4 = \\frac{1}{9}$。由于 $t0$，有 $t^2 = \\frac{1}{3}$，且 $t = \\frac{1}{\\sqrt{3}}$。\n这个临界点 $t = 1/\\sqrt{3} \\approx 0.577$ 位于区间 $[\\frac{1}{2}, 2]$ 内。\n二阶导数 $Y''(t) = 18 + \\frac{6}{t^4}$ 恒为正，所以这个临界点是一个最小值点。\n$Y$ 的最小值为 $Y_{min} = Y(1/\\sqrt{3}) = 9(\\frac{1}{\\sqrt{3}})^2 + \\frac{1}{(1/\\sqrt{3})^2} = 9(\\frac{1}{3}) + 3 = 3+3=6$。\n最优参数为 $q_1 = 1/\\sqrt{3}$ 和 $q_2 = \\sqrt{3}$，两者都在 $[\\frac{1}{2}, 2]$ 区间内。\n\n现在我们可以计算 $\\phi$ 的最大值：\n$$\n\\phi_{max} = \\frac{X_{max} - Y_{min}}{X_{max} + Y_{min}} = \\frac{\\frac{273}{4} - 6}{\\frac{273}{4} + 6} = \\frac{\\frac{273 - 24}{4}}{\\frac{273 + 24}{4}} = \\frac{249}{297}.\n$$\n化简分数：$249 = 3 \\times 83$ 且 $297 = 3 \\times 99 = 3 \\times 3 \\times 33$。所以，$\\phi_{max} = \\frac{83}{99}$。\n\n最后，我们求出 $c$ 的最优值。$\\phi$ 和 $c$ 之间的关系是 $\\phi = c^2 - s^2 = c^2 - (1-c^2) = 2c^2 - 1$。\n解出 $c^2$：$c^2 = \\frac{1+\\phi}{2}$。\n使用 $\\phi$ 的最大值，我们找到最优的 $c^2$：\n$$\nc^2 = \\frac{1 + \\frac{83}{99}}{2} = \\frac{\\frac{99+83}{99}}{2} = \\frac{\\frac{182}{99}}{2} = \\frac{91}{99}.\n$$\n由于 $c \\ge 0$， $c$ 的最优值为：\n$$\nc = \\sqrt{\\frac{91}{99}} = \\frac{\\sqrt{91}}{\\sqrt{99}} = \\frac{\\sqrt{91}}{3\\sqrt{11}}.\n$$\n为了将分母有理化，我们将分子和分母同乘以 $\\sqrt{11}$：\n$$\nc = \\frac{\\sqrt{91} \\sqrt{11}}{3\\sqrt{11}\\sqrt{11}} = \\frac{\\sqrt{1001}}{33}.\n$$",
            "answer": "$$\\boxed{\\frac{\\sqrt{1001}}{33}}$$"
        }
    ]
}