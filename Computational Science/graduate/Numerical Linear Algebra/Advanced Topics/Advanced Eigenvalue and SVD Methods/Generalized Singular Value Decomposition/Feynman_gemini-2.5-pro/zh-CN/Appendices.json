{
    "hands_on_practices": [
        {
            "introduction": "本次实践将引导你通过一个具体的例子，一步步地构建广义奇异值分解（GSVD）。通过处理一对小型的满秩矩阵，你将巩固对该分解结构的理解，并揭示其与广义特征值问题之间的内在联系。在深入研究更复杂的应用之前，这项基础练习对于建立直观认识至关重要。",
            "id": "3547762",
            "problem": "考虑一对实方阵 $$A=\\begin{bmatrix}1  0\\\\0  2\\end{bmatrix},\\qquad B=\\begin{bmatrix}0  1\\\\3  0\\end{bmatrix}.$$ 一对满秩矩阵的广义奇异值分解 (Generalized Singular Value Decomposition, GSVD) 定义如下：存在正交矩阵 $$U\\in\\mathbb{R}^{2\\times 2},\\quad V\\in\\mathbb{R}^{2\\times 2},$$ 一个可逆矩阵 $$X\\in\\mathbb{R}^{2\\times 2},$$ 以及非负对角矩阵 $$C=\\operatorname{diag}(c_{1},c_{2}),\\quad S=\\operatorname{diag}(s_{1},s_{2})$$ 使得 $$U^{\\top}AX=C,\\qquad V^{\\top}BX=S$$ 并且，在非零对角块上，有 $$C^{2}+S^{2}=I.$$ 从正交对角化、广义特征值问题和 GSVD 结构关系的基本定义出发，为给定的矩阵对 $(A,B)$ 显式构造一个有效的 GSVD 五元组 $(U,V,X,C,S)$，并验证 $$C^{2}+S^{2}=I$$ 在对角线上成立。最后，令 $$\\gamma_{i}=\\frac{c_{i}}{s_{i}}$$ 表示广义奇异值比。计算单个标量 $$\\gamma_{1}\\gamma_{2}$$ 并以精确形式给出作为你的最终答案。",
            "solution": "问题陈述是有效的。这是一个适定的数值线性代数问题，提供了所有必要的信息和定义，并且没有科学或逻辑上的不一致之处。矩阵 $A$ 和 $B$ 由下式给出\n$$A=\\begin{bmatrix}1  0\\\\0  2\\end{bmatrix},\\qquad B=\\begin{bmatrix}0  1\\\\3  0\\end{bmatrix}$$\n$A$ 的行列式是 $\\det(A) = (1)(2) - (0)(0) = 2 \\neq 0$，$B$ 的行列式是 $\\det(B) = (0)(3) - (1)(0) = -3 \\neq 0$。两个矩阵都是满秩的，满足所述条件。\n\n广义奇异值分解 (GSVD) 的构造与广义特征值问题的解密切相关。广义奇异值 $\\gamma_i$ 是矩阵对 $(A^\\top A, B^\\top B)$ 的广义特征值 $\\lambda_i$ 的平方根。广义特征值问题由 $A^\\top A \\mathbf{x} = \\lambda B^\\top B \\mathbf{x}$ 给出。\n\n首先，我们计算矩阵 $A^\\top A$ 和 $B^\\top B$。\n$$A^\\top A = \\begin{bmatrix}1  0\\\\0  2\\end{bmatrix}^\\top \\begin{bmatrix}1  0\\\\0  2\\end{bmatrix} = \\begin{bmatrix}1  0\\\\0  2\\end{bmatrix} \\begin{bmatrix}1  0\\\\0  2\\end{bmatrix} = \\begin{bmatrix}1  0\\\\0  4\\end{bmatrix}$$\n$$B^\\top B = \\begin{bmatrix}0  3\\\\1  0\\end{bmatrix} \\begin{bmatrix}0  1\\\\3  0\\end{bmatrix} = \\begin{bmatrix}9  0\\\\0  1\\end{bmatrix}$$\n广义特征值问题是找到 $\\lambda$ 使得 $\\det(A^\\top A - \\lambda B^\\top B) = 0$。\n$$A^\\top A - \\lambda B^\\top B = \\begin{bmatrix}1  0\\\\0  4\\end{bmatrix} - \\lambda \\begin{bmatrix}9  0\\\\0  1\\end{bmatrix} = \\begin{bmatrix}1-9\\lambda  0 \\\\ 0  4-\\lambda\\end{bmatrix}$$\n行列式为 $(1-9\\lambda)(4-\\lambda) = 0$。广义特征值为 $\\lambda_1 = 4$ 和 $\\lambda_2 = \\frac{1}{9}$。广义奇异值是它们的正平方根，即 $\\gamma = \\sqrt{\\lambda}$。我们得到两个值，$2$ 和 $\\frac{1}{3}$。我们可以按任何顺序排列它们；最终的乘积 $\\gamma_1 \\gamma_2$ 将是不变的。让我们根据矩阵 $X$ 的构造稍后确定排序。\n\nGSVD 关系 $U^\\top A X = C$ 和 $V^\\top B X = S$ 意味着 $X^\\top A^\\top U U^\\top A X = C^2$ 和 $X^\\top B^\\top V V^\\top B X = S^2$。由于 $U$ 和 $V$ 是正交的，这可以简化为：\n$$X^\\top(A^\\top A)X = C^2 \\quad \\text{和} \\quad X^\\top(B^\\top B)X = S^2$$\n这意味着可逆矩阵 $X$ 的列构成了同时对角化 $A^\\top A$ 和 $B^\\top B$ 的一组基。由于 $A^\\top A$ 和 $B^\\top B$ 已经是对角矩阵，它们是可交换的，并且可以被任何其列为缩放后的标准基向量的矩阵同时对角化。设 $X$ 的列为 $\\mathbf{x}_1 = \\alpha_1 \\mathbf{e}_1$ 和 $\\mathbf{x}_2 = \\alpha_2 \\mathbf{e}_2$，其中 $\\mathbf{e}_1 = \\begin{pmatrix}1\\\\0\\end{pmatrix}$ 和 $\\mathbf{e}_2 = \\begin{pmatrix}0\\\\1\\end{pmatrix}$，$\\alpha_1, \\alpha_2$ 是非零缩放因子。\n$$X = \\begin{bmatrix}\\alpha_1  0 \\\\ 0  \\alpha_2\\end{bmatrix}$$\n$C^2$ 和 $S^2$ 的对角元素由下式给出：\n$$c_1^2 = \\mathbf{x}_1^\\top(A^\\top A)\\mathbf{x}_1 = \\alpha_1^2 \\mathbf{e}_1^\\top(A^\\top A)\\mathbf{e}_1 = \\alpha_1^2(1) = \\alpha_1^2$$\n$$s_1^2 = \\mathbf{x}_1^\\top(B^\\top B)\\mathbf{x}_1 = \\alpha_1^2 \\mathbf{e}_1^\\top(B^\\top B)\\mathbf{e}_1 = \\alpha_1^2(9) = 9\\alpha_1^2$$\n$$c_2^2 = \\mathbf{x}_2^\\top(A^\\top A)\\mathbf{x}_2 = \\alpha_2^2 \\mathbf{e}_2^\\top(A^\\top A)\\mathbf{e}_2 = \\alpha_2^2(4) = 4\\alpha_2^2$$\n$$s_2^2 = \\mathbf{x}_2^\\top(B^\\top B)\\mathbf{x}_2 = \\alpha_2^2 \\mathbf{e}_2^\\top(B^\\top B)\\mathbf{e}_2 = \\alpha_2^2(1) = \\alpha_2^2$$\n归一化条件 $C^2+S^2=I$ 要求对每个 $i \\in \\{1, 2\\}$ 都有 $c_i^2+s_i^2=1$。\n对于 $i=1$：$\\alpha_1^2 + 9\\alpha_1^2 = 1 \\implies 10\\alpha_1^2=1 \\implies \\alpha_1 = \\frac{1}{\\sqrt{10}}$ (我们选择正根)。\n对于 $i=2$：$4\\alpha_2^2 + \\alpha_2^2 = 1 \\implies 5\\alpha_2^2=1 \\implies \\alpha_2 = \\frac{1}{\\sqrt{5}}$。\n\n现在我们可以构造矩阵 $X$、$C$ 和 $S$。\n$$X = \\begin{bmatrix}\\frac{1}{\\sqrt{10}}  0 \\\\ 0  \\frac{1}{\\sqrt{5}}\\end{bmatrix}$$\n使用这些缩放因子，我们找到 $C$ 和 $S$ 的对角元素（必须为非负）。\n$c_1 = \\sqrt{\\alpha_1^2} = \\alpha_1 = \\frac{1}{\\sqrt{10}}$\n$s_1 = \\sqrt{9\\alpha_1^2} = 3\\alpha_1 = \\frac{3}{\\sqrt{10}}$\n$c_2 = \\sqrt{4\\alpha_2^2} = 2\\alpha_2 = \\frac{2}{\\sqrt{5}}$\n$s_2 = \\sqrt{\\alpha_2^2} = \\alpha_2 = \\frac{1}{\\sqrt{5}}$\n所以，对角矩阵为：\n$$C = \\begin{bmatrix}\\frac{1}{\\sqrt{10}}  0 \\\\ 0  \\frac{2}{\\sqrt{5}}\\end{bmatrix}, \\qquad S = \\begin{bmatrix}\\frac{3}{\\sqrt{10}}  0 \\\\ 0  \\frac{1}{\\sqrt{5}}\\end{bmatrix}$$\n我们验证条件 $C^2+S^2=I$：\n$$C^2+S^2 = \\begin{bmatrix}\\frac{1}{10}  0 \\\\ 0  \\frac{4}{5}\\end{bmatrix} + \\begin{bmatrix}\\frac{9}{10}  0 \\\\ 0  \\frac{1}{5}\\end{bmatrix} = \\begin{bmatrix}\\frac{1}{10}+\\frac{9}{10}  0 \\\\ 0  \\frac{4}{5}+\\frac{1}{5}\\end{bmatrix} = \\begin{bmatrix}1  0 \\\\ 0  1\\end{bmatrix} = I$$\n条件满足。\n\n接下来，我们构造正交矩阵 $U$ 和 $V$。\n由 $U^\\top A X = C$，我们有 $A X = U C$。因此，$U = (AX)C^{-1}$。\n$$AX = \\begin{bmatrix}1  0\\\\0  2\\end{bmatrix}\\begin{bmatrix}\\frac{1}{\\sqrt{10}}  0 \\\\ 0  \\frac{1}{\\sqrt{5}}\\end{bmatrix} = \\begin{bmatrix}\\frac{1}{\\sqrt{10}}  0 \\\\ 0  \\frac{2}{\\sqrt{5}}\\end{bmatrix}$$\n$$C^{-1} = \\begin{bmatrix}\\sqrt{10}  0 \\\\ 0  \\frac{\\sqrt{5}}{2}\\end{bmatrix}$$\n$$U = (AX)C^{-1} = \\begin{bmatrix}\\frac{1}{\\sqrt{10}}  0 \\\\ 0  \\frac{2}{\\sqrt{5}}\\end{bmatrix}\\begin{bmatrix}\\sqrt{10}  0 \\\\ 0  \\frac{\\sqrt{5}}{2}\\end{bmatrix} = \\begin{bmatrix}1  0 \\\\ 0  1\\end{bmatrix}=I_2$$\n$U=I_2$ 是一个正交矩阵。\n\n由 $V^\\top B X = S$，我们有 $B X = V S$。因此，$V = (BX)S^{-1}$。\n$$BX = \\begin{bmatrix}0  1\\\\3  0\\end{bmatrix}\\begin{bmatrix}\\frac{1}{\\sqrt{10}}  0 \\\\ 0  \\frac{1}{\\sqrt{5}}\\end{bmatrix} = \\begin{bmatrix}0  \\frac{1}{\\sqrt{5}} \\\\ \\frac{3}{\\sqrt{10}}  0 \\end{bmatrix}$$\n$$S^{-1} = \\begin{bmatrix}\\frac{\\sqrt{10}}{3}  0 \\\\ 0  \\sqrt{5}\\end{bmatrix}$$\n$$V = (BX)S^{-1} = \\begin{bmatrix}0  \\frac{1}{\\sqrt{5}} \\\\ \\frac{3}{\\sqrt{10}}  0 \\end{bmatrix}\\begin{bmatrix}\\frac{\\sqrt{10}}{3}  0 \\\\ 0  \\sqrt{5}\\end{bmatrix} = \\begin{bmatrix}0  1 \\\\ 1  0\\end{bmatrix}$$\n$V=\\begin{bmatrix}0  1 \\\\ 1  0\\end{bmatrix}$ 是一个正交矩阵。\n\n我们成功地构造了一个有效的 GSVD 五元组 $(U,V,X,C,S)$：\n$$U=\\begin{bmatrix}1  0\\\\0  1\\end{bmatrix}, \\quad V=\\begin{bmatrix}0  1\\\\1  0\\end{bmatrix}, \\quad X=\\begin{bmatrix}\\frac{1}{\\sqrt{10}}  0\\\\0  \\frac{1}{\\sqrt{5}}\\end{bmatrix}, \\quad C=\\begin{bmatrix}\\frac{1}{\\sqrt{10}}  0\\\\0  \\frac{2}{\\sqrt{5}}\\end{bmatrix}, \\quad S=\\begin{bmatrix}\\frac{3}{\\sqrt{10}}  0\\\\0  \\frac{1}{\\sqrt{5}}\\end{bmatrix}$$\n\n最后，我们计算广义奇异值比 $\\gamma_i = \\frac{c_i}{s_i}$ 及其乘积。\n$$\\gamma_1 = \\frac{c_1}{s_1} = \\frac{1/\\sqrt{10}}{3/\\sqrt{10}} = \\frac{1}{3}$$\n$$\\gamma_2 = \\frac{c_2}{s_2} = \\frac{2/\\sqrt{5}}{1/\\sqrt{5}} = 2$$\n乘积为：\n$$\\gamma_1\\gamma_2 = \\left(\\frac{1}{3}\\right) \\times 2 = \\frac{2}{3}$$\n广义奇异值的乘积是 $\\sqrt{\\det((B^\\top B)^{-1}(A^\\top A))}$。\n$$(B^\\top B)^{-1} = \\begin{bmatrix}1/9  0\\\\0  1\\end{bmatrix}$$\n$$(B^\\top B)^{-1}(A^\\top A) = \\begin{bmatrix}1/9  0\\\\0  1\\end{bmatrix}\\begin{bmatrix}1  0\\\\0  4\\end{bmatrix} = \\begin{bmatrix}1/9  0\\\\0  4\\end{bmatrix}$$\n这个矩阵的特征值是 $\\frac{1}{9}$ 和 $4$，它们是我们 $\\gamma_i$ 的平方。$\\gamma_i$ 的乘积是 $\\sqrt{(\\frac{1}{9})(4)} = \\sqrt{\\frac{4}{9}} = \\frac{2}{3}$。这证实了我们的结果。",
            "answer": "$$\\boxed{\\frac{2}{3}}$$"
        },
        {
            "introduction": "广义奇异值分解的一个关键优势在于它能够优雅地处理一个或两个矩阵是奇异的情况。本练习探讨了这样一个场景，展示了 GSVD 框架如何自然地产生零或无穷大的广义奇异值。理解这些特殊情况对于解释在正则化和信号处理等领域中常见的不适定问题或秩亏问题的解至关重要。",
            "id": "3547804",
            "problem": "设 $A \\in \\mathbb{R}^{2 \\times 2}$ 和 $B \\in \\mathbb{R}^{2 \\times 2}$ 由下式给出\n$$\nA=\\begin{bmatrix}1  0 \\\\ 0  0\\end{bmatrix}, \\qquad B=\\begin{bmatrix}0  0 \\\\ 0  1\\end{bmatrix}.\n$$\n一对矩阵 $(A,B)$ 的广义奇异值分解 (GSVD) 定义如下：存在正交矩阵 $U \\in \\mathbb{R}^{2 \\times 2}$ 和 $V \\in \\mathbb{R}^{2 \\times 2}$ 以及一个可逆矩阵 $X \\in \\mathbb{R}^{2 \\times 2}$，使得\n$$\nU^{\\top} A X = C, \\qquad V^{\\top} B X = S,\n$$\n其中 $C=\\operatorname{diag}(c_1,c_2)$ 和 $S=\\operatorname{diag}(s_1,s_2)$ 的对角线元素为非负，并满足 $C^{\\top} C + S^{\\top} S = I_2$。广义奇异值定义为 $\\gamma_i = \\frac{c_i}{s_i}$，按照惯例，如果 $c_i=0$ 且 $s_i0$，则 $\\gamma_i=0$；如果 $c_i0$ 且 $s_i=0$，则 $\\gamma_i=+\\infty$。\n\n从GSVD的定义以及正交矩阵和对角矩阵的性质出发，通过显式确定合适的 $U$、$V$、$X$ 以及 $C$ 和 $S$ 的对角线元素，为 $(A,B)$ 构建一个GSVD。然后计算广义奇异值 $\\gamma_1$ 和 $\\gamma_2$，并将每个值分类为零、有限或无限。\n\n请以单个精确表达式的形式提供广义奇异值的有序对 $(\\gamma_1,\\gamma_2)$ 作为最终答案。不需要四舍五入。",
            "solution": "问题要求我们求出矩阵 $A = \\begin{bmatrix}1  0 \\\\ 0  0\\end{bmatrix}$ 和 $B = \\begin{bmatrix}0  0 \\\\ 0  1\\end{bmatrix}$ 的广义奇异值分解 (GSVD)。这涉及找到正交矩阵 $U, V \\in \\mathbb{R}^{2 \\times 2}$ 和一个可逆矩阵 $X \\in \\mathbb{R}^{2 \\times 2}$，使得 $U^{\\top} A X = C$ 和 $V^{\\top} B X = S$，其中 $C=\\operatorname{diag}(c_1, c_2)$ 和 $S=\\operatorname{diag}(s_1, s_2)$ 是对角线元素为非负且满足 $C^{\\top} C + S^{\\top} S = I_2$ 的对角矩阵。\n\n给定的矩阵 $A$ 和 $B$ 已经是 对角矩阵。这表明对变换矩阵进行简单的选择可能就足够了。让我们通过为 $U$、$V$ 和 $X$ 选择单位矩阵来测试最直接的可能性。\n\n设 $U = I_2$，$V = I_2$，$X = I_2$。\n- 矩阵 $U=I_2$ 和 $V=I_2$ 是正交的，因为 $I_2^{\\top}I_2 = I_2$。\n- 矩阵 $X=I_2$ 是可逆的，因为 $\\det(I_2) = 1 \\neq 0$。\n\n现在，我们使用这些选择来计算矩阵 $C$ 和 $S$：\n$$\nC = U^{\\top} A X = I_2^{\\top} A I_2 = A = \\begin{bmatrix}1  0 \\\\ 0  0\\end{bmatrix}\n$$\n$$\nS = V^{\\top} B X = I_2^{\\top} B I_2 = B = \\begin{bmatrix}0  0 \\\\ 0  1\\end{bmatrix}\n$$\n我们必须验证这些得到的矩阵 $C$ 和 $S$ 是否满足所需的性质。\n- $C$ 和 $S$ 是对角矩阵。\n- $C$ 的对角线元素是 $c_1=1$ 和 $c_2=0$，它们都是非负的。\n- $S$ 的对角线元素是 $s_1=0$ 和 $s_2=1$，它们都是非负的。\n\n需要检查的最后一个条件是 $C^{\\top} C + S^{\\top} S = I_2$。\n$$\nC^{\\top} C = \\begin{bmatrix}1  0 \\\\ 0  0\\end{bmatrix}^{\\top} \\begin{bmatrix}1  0 \\\\ 0  0\\end{bmatrix} = \\begin{bmatrix}1  0 \\\\ 0  0\\end{bmatrix} \\begin{bmatrix}1  0 \\\\ 0  0\\end{bmatrix} = \\begin{bmatrix}1  0 \\\\ 0  0\\end{bmatrix}\n$$\n$$\nS^{\\top} S = \\begin{bmatrix}0  0 \\\\ 0  1\\end{bmatrix}^{\\top} \\begin{bmatrix}0  0 \\\\ 0  1\\end{bmatrix} = \\begin{bmatrix}0  0 \\\\ 0  1\\end{bmatrix} \\begin{bmatrix}0  0 \\\\ 0  1\\end{bmatrix} = \\begin{bmatrix}0  0 \\\\ 0  1\\end{bmatrix}\n$$\n将它们相加：\n$$\nC^{\\top} C + S^{\\top} S = \\begin{bmatrix}1  0 \\\\ 0  0\\end{bmatrix} + \\begin{bmatrix}0  0 \\\\ 0  1\\end{bmatrix} = \\begin{bmatrix}1  0 \\\\ 0  1\\end{bmatrix} = I_2\n$$\n所有条件都已满足。因此，矩阵对 $(A,B)$ 的一个有效GSVD由 $U=I_2$，$V=I_2$，$X=I_2$，$C=\\operatorname{diag}(1,0)$ 和 $S=\\operatorname{diag}(0,1)$ 给出。\n\n现在，我们使用 $C$ 和 $S$ 的对角线元素以及所提供的惯例来计算广义奇异值 $\\gamma_i = \\frac{c_i}{s_i}$。\n对于 $i=1$：\n$c_1=1$，$s_1=0$。这种情况符合 $c_i  0$ 且 $s_i=0$ 的惯例，因此广义奇异值定义为无穷大。\n$$\n\\gamma_1 = +\\infty\n$$\n对于 $i=2$：\n$c_2=0$，$s_2=1$。这种情况符合 $c_i = 0$ 且 $s_i0$ 的惯例，因此广义奇异值定义为零。\n$$\n\\gamma_2 = \\frac{0}{1} = 0\n$$\n\n每个值都已分类：$\\gamma_1$ 是无限的，$\\gamma_2$ 是零。问题要求提供有序对 $(\\gamma_1, \\gamma_2)$。根据我们的构造，这个对是 $(\\infty, 0)$。按照惯例，广义奇异值通常按降序排列，由于 $\\infty  0$，这个排序是标准的。\n\n广义奇异值的有序对是 $(\\infty, 0)$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\infty  0 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "从理论走向计算，我们需要面对有限精度算法的现实。我们如何信任数值算法产生的 GSVD 结果？这个高级实践将引导你设计一个后向误差的数值测试，这是数值分析的基石。你将推导理论界限，然后实现一个测试来验证计算出的 GSVD 的质量，从而在抽象的数学构造与实用、可靠的计算之间架起一座桥梁。",
            "id": "3547773",
            "problem": "给定两个满列秩为 $n$ 的实矩阵 $A \\in \\mathbb{R}^{m \\times n}$ 和 $B \\in \\mathbb{R}^{p \\times n}$。广义奇异值分解 (GSVD) 断言存在正交矩阵 $U \\in \\mathbb{R}^{m \\times m}$ 和 $V \\in \\mathbb{R}^{p \\times p}$、一个可逆矩阵 $X \\in \\mathbb{R}^{n \\times n}$ 以及非负对角矩阵 $C \\in \\mathbb{R}^{n \\times n}$ 和 $S \\in \\mathbb{R}^{n \\times n}$，使得 $U^T A X = C$，$V^T B X = S$ 且 $C^2 + S^2 = I_n$。在简化（瘦）形式中，可以使用具有正交列的矩阵 $U \\in \\mathbb{R}^{m \\times n}$ 和 $V \\in \\mathbb{R}^{p \\times n}$，使得 $U^T U = I_n$ 且 $V^T V = I_n$。\n\n你的任务是设计一个数值测试，通过报告计算出的 GSVD 因子的后向误差。具体而言，对于一个计算出的三元组 $(U, V, X)$ 和在数值精度内满足 $C^2 + S^2 \\approx I_n$ 的对角矩阵 $C, S$，你需要报告其 Frobenius 范数残差 $\\lVert U^T A X - C \\rVert_F$ 和 $\\lVert V^T B X - S \\rVert_F$。你必须仅从 GSVD 的核心定义、范数的酉不变性以及标准矩阵范数不等式出发，推导出明确的双边界，将这些残差与输入扰动 $(\\Delta A, \\Delta B)$ 联系起来。这些扰动使得计算出的因子是精确正确的，即 $U^T (A + \\Delta A) X = C$ 和 $V^T (B + \\Delta B) X = S$。你的推导必须得到可计算的下界和上界，这些界依赖于 $X$ 和 $X^{-1}$ 的算子范数以及观测到的 Frobenius 残差，并且不依赖于任何未经证明的假设。\n\n你的程序必须：\n- 按如下方式构建三个测试用例 $(A, B)$，使用固定的种子以保证可复现性，并利用生成式 GSVD 模型 $A = U_0 C_0 X_0^{-1}$ 和 $B = V_0 S_0 X_0^{-1}$：\n  - 测试用例 1：设 $m = 6$，$p = 5$，$n = 4$。选择角度 $\\theta = [0.2, 0.5, 0.9, 1.2]$（弧度），使得 $C_0 = \\operatorname{diag}(\\cos(\\theta))$ 且 $S_0 = \\operatorname{diag}(\\sin(\\theta))$。选择 $X_0$ 的对角元素为 $[1, 3, 30, 300]$。使用种子 $12345$ 从独立的高斯矩阵生成具有正交列的 $U_0 \\in \\mathbb{R}^{m \\times n}$ 和 $V_0 \\in \\mathbb{R}^{p \\times n}$，然后进行简化 QR 分解。\n  - 测试用例 2：设 $m = 7$，$p = 6$，$n = 5$。选择角度 $\\theta = [0.01, 0.3, 0.7, 1.0, 1.56]$，使得 $C_0 = \\operatorname{diag}(\\cos(\\theta))$ 且 $S_0 = \\operatorname{diag}(\\sin(\\theta))$。选择 $X_0$ 的对角元素为 $[10^{-4}, 10^{-2}, 1, 10^{2}, 10^{4}]$。使用种子 $24680$ 从独立的高斯矩阵生成具有正交列的 $U_0 \\in \\mathbb{R}^{m \\times n}$ 和 $V_0 \\in \\mathbb{R}^{p \\times n}$，然后进行简化 QR 分解。\n  - 测试用例 3：设 $m = 3$，$p = 3$，$n = 1$。选择角度 $\\theta = [0.9]$，使得 $C_0 = \\operatorname{diag}(\\cos(\\theta))$ 且 $S_0 = \\operatorname{diag}(\\sin(\\theta))$。选择 $X_0$ 的对角元素为 $[10^{6}]$。使用种子 $13579$ 从独立的高斯向量生成具有正交列的 $U_0 \\in \\mathbb{R}^{m \\times n}$ 和 $V_0 \\in \\mathbb{R}^{p \\times n}$，然后进行归一化。\n- 对于每个测试用例，按上述方式构建 $(A, B)$。然后，通过任何与 GSVD 定义和标准酉不变性原则一致的方法，从 $(A, B)$ 计算一个简化的 GSVD 三元组 $(U, V, X)$ 以及对角矩阵 $C, S$。测量 Frobenius 残差 $r_A = \\lVert U^T A X - C \\rVert_F$ 和 $r_B = \\lVert V^T B X - S \\rVert_F$。\n- 仅使用范数的酉不变性和次可乘性的基本性质，推导最小扰动范数 $\\eta = \\min \\{ \\sqrt{ \\lVert \\Delta A \\rVert_F^2 + \\lVert \\Delta B \\rVert_F^2 } : U^T (A + \\Delta A) X = C, V^T (B + \\Delta B) X = S \\}$ 的可计算双边界，用 $r_A$、$r_B$ 以及 $X$ 和 $X^{-1}$ 的算子范数表示。然后，报告：\n  - 由你根据残差方程和计算出的 $(U, V, X)$、$C$、$S$ 显式构造的一个具体扰动对 $(\\Delta A, \\Delta B)$ 所实现的绝对后向误差 $\\widehat{\\eta}$。\n  - 一个基于你的推导得出的 $\\eta$ 的下界 $\\mathrm{LB}$ 和上界 $\\mathrm{UB}$，这些界仅依赖于 $r_A$、$r_B$、$\\lVert X \\rVert_2$ 和 $\\lVert X^{-1} \\rVert_2$。\n  - 布尔指示符，表明 $\\widehat{\\eta}$ 是否在数值上合理的容差范围内满足 $\\mathrm{LB} \\le \\widehat{\\eta} \\le \\mathrm{UB}$。\n- 不涉及物理单位。角度以弧度为单位。\n\n最终输出格式：\n- 你的程序应该生成单行输出，包含所有三个测试用例的结果，格式为一个包含三个列表的列表。对于每个测试用例，输出列表 $[r_A, r_B, \\widehat{\\eta}, \\mathrm{LB}, \\mathrm{UB}, \\text{okL}, \\text{okU}]$，其中 $r_A$、$r_B$、$\\widehat{\\eta}$、$\\mathrm{LB}$ 和 $\\mathrm{UB}$ 是浮点数，而 $\\text{okL}$、$\\text{okU}$ 分别是用于下界和上界检查的布尔值。例如，一个语法上有效的输出是 $[[a_1,b_1,c_1,d_1,e_1,\\mathrm{True},\\mathrm{True}],[a_2,b_2,c_2,d_2,e_2,\\mathrm{True},\\mathrm{True}],[a_3,b_3,c_3,d_3,e_3,\\mathrm{True},\\mathrm{True}]]$.\n\n你的程序将使用的测试套件摘要：\n- 用例 1：$m=6$，$p=5$，$n=4$，$\\theta = [0.2, 0.5, 0.9, 1.2]$，$\\operatorname{diag}(X_0) = [1, 3, 30, 300]$，种子 $12345$。\n- 用例 2：$m=7$，$p=6$，$n=5$，$\\theta = [0.01, 0.3, 0.7, 1.0, 1.56]$，$\\operatorname{diag}(X_0) = [10^{-4}, 10^{-2}, 1, 10^{2}, 10^{4}]$，种子 $24680$。\n- 用例 3：$m=3$，$p=3$，$n=1$，$\\theta = [0.9]$，$\\operatorname{diag}(X_0) = [10^{6}]$，种子 $13579$。",
            "solution": "该问题要求推导计算出的广义奇异值分解 (GSVD) 后向误差的双边界，并对这些界进行数值验证。\n\n设给定的实矩阵为 $A \\in \\mathbb{R}^{m \\times n}$ 和 $B \\in \\mathbb{R}^{p \\times n}$，并假设两者均为满列秩 $n$。一次计算出的简化 GSVD 提供一组因子：具有正交列的矩阵 $U \\in \\mathbb{R}^{m \\times n}$ 和 $V \\in \\mathbb{R}^{p \\times n}$（即 $U^T U = I_n$ 和 $V^T V = I_n$）、一个可逆矩阵 $X \\in \\mathbb{R}^{n \\times n}$，以及在数值上满足 $C^2 + S^2 \\approx I_n$ 的非负对角矩阵 $C, S \\in \\mathbb{R}^{n \\times n}$。\n\n这些计算出的因子的质量通过残差矩阵的 Frobenius 范数来衡量：\n$$R_A = U^T A X - C$$\n$$R_B = V^T B X - S$$\n设它们的范数为 $r_A = \\lVert R_A \\rVert_F$ 和 $r_B = \\lVert R_B \\rVert_F$。\n\n后向误差分析旨在寻找最小的扰动对 $(\\Delta A, \\Delta B)$，使得计算出的因子是扰动后矩阵 $(A + \\Delta A, B + \\Delta B)$ 的精确 GSVD。其定义方程为：\n$$U^T (A + \\Delta A) X = C$$\n$$V^T (B + \\Delta B) X = S$$\n\n我们希望找到满足这些方程的所有 $(\\Delta A, \\Delta B)$ 对中的最小总扰动范数，定义为 $\\eta = \\min \\left\\{ \\sqrt{ \\lVert \\Delta A \\rVert_F^2 + \\lVert \\Delta B \\rVert_F^2 } \\right\\}$。\n\n从第一个方程中，我们可以分离出包含 $\\Delta A$ 的项：\n$$U^T A X + U^T \\Delta A X = C \\implies U^T \\Delta A X = C - U^T A X = -R_A$$\n由于 $X$ 是可逆的，我们可以写成：\n$$U^T \\Delta A = -R_A X^{-1}$$\n为了找到满足此方程且具有最小 Frobenius 范数的 $\\Delta A$，我们注意到任何矩阵 $\\Delta A \\in \\mathbb{R}^{m \\times n}$ 都可以分解为 $U$ 的列空间中的一部分和其正交补空间中的一部分。当与 $U$ 的列空间正交的分量为零时，范数 $\\lVert \\Delta A \\rVert_F$ 最小化。这给出了最小范数解：\n$$\\Delta A_{opt} = -U (R_A X^{-1})$$\n这个特定扰动的范数是利用“左乘一个具有正交列的矩阵会保持 Frobenius 范数”这一性质得到的，即 $\\lVert U M \\rVert_F = \\lVert M \\rVert_F$。\n$$\\lVert \\Delta A_{opt} \\rVert_F = \\lVert -U (R_A X^{-1}) \\rVert_F = \\lVert R_A X^{-1} \\rVert_F$$\n对涉及 $B$ 和 $\\Delta B$ 的第二个方程进行相同的论证，可得：\n$$V^T \\Delta B = -R_B X^{-1}$$\n最小范数扰动 $\\Delta B$ 是 $\\Delta B_{opt} = -V (R_B X^{-1})$，其范数为 $\\lVert \\Delta B_{opt} \\rVert_F = \\lVert R_B X^{-1} \\rVert_F$。\n\n$\\Delta A$ 和 $\\Delta B$ 的最小化问题是独立的。因此，当两个单独的范数都最小时，达到最小总扰动范数 $\\eta$。具体的扰动对 $(\\widehat{\\Delta A}, \\widehat{\\Delta B}) = (\\Delta A_{opt}, \\Delta B_{opt})$ 实现了这个最小值。这个最小后向误差的值，我们将其计算为 $\\widehat{\\eta}$，是：\n$$\\widehat{\\eta} = \\sqrt{\\lVert \\Delta A_{opt} \\rVert_F^2 + \\lVert \\Delta B_{opt} \\rVert_F^2} = \\sqrt{\\lVert R_A X^{-1} \\rVert_F^2 + \\lVert R_B X^{-1} \\rVert_F^2}$$\n\n接下来，我们根据 $r_A$、$r_B$ 以及 $X$ 和 $X^{-1}$ 的算子范数，推导 $\\eta$（其值等于 $\\widehat{\\eta}$）的可计算双边界。所使用的算子范数是 $2$-范数，$\\lVert \\cdot \\rVert_2$。\n\n**上界推导：**\n我们使用矩阵范数的次可乘性，具体为 $\\lVert M N \\rVert_F \\le \\lVert M \\rVert_F \\lVert N \\rVert_2$。\n将此应用于 $\\widehat{\\eta}^2$ 表达式中的各项：\n$$\\lVert R_A X^{-1} \\rVert_F \\le \\lVert R_A \\rVert_F \\lVert X^{-1} \\rVert_2 = r_A \\lVert X^{-1} \\rVert_2$$\n$$\\lVert R_B X^{-1} \\rVert_F \\le \\lVert R_B \\rVert_F \\lVert X^{-1} \\rVert_2 = r_B \\lVert X^{-1} \\rVert_2$$\n将这些代入 $\\widehat{\\eta}^2$ 的表达式，得到一个上界：\n$$\\widehat{\\eta}^2 \\le (r_A \\lVert X^{-1} \\rVert_2)^2 + (r_B \\lVert X^{-1} \\rVert_2)^2 = (r_A^2 + r_B^2) \\lVert X^{-1} \\rVert_2^2$$\n取平方根得到上界 $\\mathrm{UB}$：\n$$\\widehat{\\eta} \\le \\sqrt{r_A^2 + r_B^2} \\cdot \\lVert X^{-1} \\rVert_2 = \\mathrm{UB}$$\n\n**下界推导：**\n我们从残差方程 $R_A = -U^T \\Delta A X$ 和 $R_B = -V^T \\Delta B X$ 开始。取 Frobenius 范数：\n$$r_A = \\lVert R_A \\rVert_F = \\lVert U^T \\Delta A X \\rVert_F$$\n$$r_B = \\lVert R_B \\rVert_F = \\lVert V^T \\Delta B X \\rVert_F$$\n使用次可乘性 $\\lVert M N \\rVert_F \\le \\lVert M \\rVert_F \\lVert N \\rVert_2$：\n$$r_A \\le \\lVert U^T \\Delta A \\rVert_F \\lVert X \\rVert_2$$\n矩阵 $U^T$ 具有正交行，其算子 $2$-范数为 $\\lVert U^T \\rVert_2 = 1$。应用不等式 $\\lVert M N \\rVert_F \\le \\lVert M \\rVert_2 \\lVert N \\rVert_F$：\n$$\\lVert U^T \\Delta A \\rVert_F \\le \\lVert U^T \\rVert_2 \\lVert \\Delta A \\rVert_F = \\lVert \\Delta A \\rVert_F$$\n结合这些，我们得到 $r_A \\le \\lVert \\Delta A \\rVert_F \\lVert X \\rVert_2$。由于 $X$ 是可逆的，$\\lVert X \\rVert_2 > 0$，所以我们可以写成：\n$$\\lVert \\Delta A \\rVert_F \\ge \\frac{r_A}{\\lVert X \\rVert_2}$$\n这个不等式对于任何满足后向误差条件的 $\\Delta A$ 都成立。对 $\\Delta B$ 进行类似的推导可得 $\\lVert \\Delta B \\rVert_F \\ge \\frac{r_B}{\\lVert X \\rVert_2}$。\n将这些最小值的平方相加，得到对于任何有效对 $(\\Delta A, \\Delta B)$ 的总扰动平方的下界：\n$$\\lVert \\Delta A \\rVert_F^2 + \\lVert \\Delta B \\rVert_F^2 \\ge \\left(\\frac{r_A}{\\lVert X \\rVert_2}\\right)^2 + \\left(\\frac{r_B}{\\lVert X \\rVert_2}\\right)^2 = \\frac{r_A^2 + r_B^2}{\\lVert X \\rVert_2^2}$$\n由于 $\\eta^2$ 是左侧的最小值，我们有：\n$$\\eta^2 \\ge \\frac{r_A^2 + r_B^2}{\\lVert X \\rVert_2^2}$$\n取平方根得到下界 $\\mathrm{LB}$：\n$$\\eta \\ge \\frac{\\sqrt{r_A^2 + r_B^2}}{\\lVert X \\rVert_2} = \\mathrm{LB}$$\n\n总之，我们已经推导出了最小后向误差 $\\eta$ 的可计算双边界：\n$$\\frac{\\sqrt{r_A^2 + r_B^2}}{\\lVert X \\rVert_2} \\le \\eta \\le \\sqrt{r_A^2 + r_B^2} \\cdot \\lVert X^{-1} \\rVert_2$$\n实现部分将计算 $\\widehat{\\eta}$、$\\mathrm{LB}$ 和 $\\mathrm{UB}$，并验证这些不等式是否成立。GSVD 本身的计算是通过一个数值上标准的过程完成的，该过程涉及 QR 分解，然后是奇异值分解，以实现所需的 CS 分解。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import linalg\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    # Define test cases as specified in the problem.\n    test_cases = [\n        # Case 1\n        {\n            \"m\": 6, \"p\": 5, \"n\": 4, \n            \"theta\": [0.2, 0.5, 0.9, 1.2],\n            \"diag_X0\": [1., 3., 30., 300.],\n            \"seed\": 12345\n        },\n        # Case 2\n        {\n            \"m\": 7, \"p\": 6, \"n\": 5,\n            \"theta\": [0.01, 0.3, 0.7, 1.0, 1.56],\n            \"diag_X0\": [1e-4, 1e-2, 1., 1e2, 1e4],\n            \"seed\": 24680\n        },\n        # Case 3\n        {\n            \"m\": 3, \"p\": 3, \"n\": 1,\n            \"theta\": [0.9],\n            \"diag_X0\": [1e6],\n            \"seed\": 13579\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        result_tuple = run_analysis_for_case(**case)\n        results.append(result_tuple)\n\n    # Format the final output string as a list of lists.\n    formatted_results = []\n    for res in results:\n        # res is [r_A, r_B, eta_hat, LB, UB, okL, okU]\n        s = f\"[{res[0]:.8e},{res[1]:.8e},{res[2]:.8e},{res[3]:.8e},{res[4]:.8e},{str(res[5]).lower()},{str(res[6]).lower()}]\"\n        formatted_results.append(s)\n    \n    print(f\"[{','.join(formatted_results)}]\")\n\ndef create_test_matrices(m, p, n, theta, diag_X0, seed):\n    \"\"\"Generates test matrices A and B with a known GSVD structure.\"\"\"\n    rng = np.random.default_rng(seed)\n    \n    C0 = np.diag(np.cos(np.array(theta)))\n    S0 = np.diag(np.sin(np.array(theta)))\n    X0 = np.diag(np.array(diag_X0))\n    \n    # Generate random orthonormal matrices U0 and V0\n    U0, _ = np.linalg.qr(rng.standard_normal(size=(m, n)))\n    V0, _ = np.linalg.qr(rng.standard_normal(size=(p, n)))\n    \n    X0_inv = np.linalg.inv(X0)\n    # A = U0 @ C0 @ X0^{-1}\n    A = U0 @ C0 @ X0_inv\n    # B = V0 @ S0 @ X0^{-1}\n    B = V0 @ S0 @ X0_inv\n    \n    return A, B\n\ndef compute_gsvd(A, B, m, p, n):\n    \"\"\"\n    Computes the reduced Generalized Singular Value Decomposition (GSVD) of (A, B)\n    using the Paige-Saunders algorithm based on QR and SVD.\n    This yields U, V, X, C, S such that U.T @ A @ X = C and V.T @ B @ X = S.\n    \"\"\"\n    # Step 1: QR factorization of the stacked matrix\n    K = np.vstack((A, B))\n    Q_k, R_k = np.linalg.qr(K)\n    \n    Q_A = Q_k[:m, :]\n    Q_B = Q_k[m:, :]\n    \n    # Step 2: CSD of the pair (Q_A, Q_B) via SVD of Q_A\n    U, c_diag, Zt = np.linalg.svd(Q_A, full_matrices=False)\n    C = np.diag(c_diag)\n    Z = Zt.T\n    \n    # Step 3: Compute S from C^2 + S^2 = I\n    s_diag = np.sqrt(np.maximum(0.0, 1.0 - c_diag**2))\n    S = np.diag(s_diag)\n    \n    # Step 4: Compute V\n    # From the CSD relation, V.T @ Q_B @ Z = S must hold. We solve for V.\n    M = Q_B @ Z\n    V = np.zeros_like(Q_B, dtype=float)\n    tol = 1e-14\n    \n    # Columns of V corresponding to non-zero sin values\n    not_zero_s = s_diag > tol\n    if np.any(not_zero_s):\n        V[:, not_zero_s] = M[:, not_zero_s] / s_diag[not_zero_s]\n        \n    # Columns of V corresponding to zero sin values (i.e., cos=1)\n    zero_s = ~not_zero_s\n    if np.any(zero_s):\n        num_zeros = np.sum(zero_s)\n        V_basis_to_find = np.zeros((p, num_zeros))\n        \n        if np.any(not_zero_s):\n            # Find orthonormal basis for the orthogonal complement of the known columns\n            known_V_cols = V[:, not_zero_s]\n            ortho_basis = linalg.null_space(known_V_cols.T)\n            V_basis_to_find = ortho_basis[:, :num_zeros]\n        else: # All sin values are zero. Q_B should be a zero matrix.\n            # V can be any orthonormal set of p x n columns.\n            V_basis_to_find, _ = np.linalg.qr(np.eye(p, n))\n\n        V[:, zero_s] = V_basis_to_find\n\n    # Step 5: Compute X\n    # From A = U @ C @ Z.T @ R_k => U.T A (R_k^{-1} Z) = C.\n    # So X = R_k^{-1} Z. Use solve_triangular for stability.\n    X = linalg.solve_triangular(R_k, Z, lower=False)\n\n    return U, V, X, C, S\n\n\ndef run_analysis_for_case(m, p, n, theta, diag_X0, seed):\n    \"\"\"\n    Performs the full backward error analysis for a single test case.\n    \"\"\"\n    # 1. Construct matrices A and B\n    A, B = create_test_matrices(m, p, n, theta, diag_X0, seed)\n    \n    # 2. Compute GSVD factors U, V, X, C, S from A and B\n    U, V, X, C, S = compute_gsvd(A, B, m, p, n)\n    \n    # 3. Calculate residuals\n    R_A = U.T @ A @ X - C\n    R_B = V.T @ B @ X - S\n    r_A = np.linalg.norm(R_A, 'fro')\n    r_B = np.linalg.norm(R_B, 'fro')\n    \n    # 4. Calculate the minimal backward error, eta_hat\n    X_inv = np.linalg.inv(X)\n    \n    eta_hat = np.sqrt(\n        np.linalg.norm(R_A @ X_inv, 'fro')**2 + \n        np.linalg.norm(R_B @ X_inv, 'fro')**2\n    )\n\n    # 5. Calculate the two-sided bounds LB and UB\n    norm_X_2 = np.linalg.norm(X, 2)\n    norm_X_inv_2 = np.linalg.norm(X_inv, 2)\n    \n    r_comb_norm = np.sqrt(r_A**2 + r_B**2)\n    \n    LB = r_comb_norm / norm_X_2\n    UB = r_comb_norm * norm_X_inv_2\n\n    # 6. Verify the bounds are satisfied within a numerical tolerance\n    rtol = 1e-9\n    atol = 1e-14\n    okL = (LB = eta_hat) or np.isclose(LB, eta_hat, rtol=rtol, atol=atol)\n    okU = (eta_hat = UB) or np.isclose(eta_hat, UB, rtol=rtol, atol=atol)\n\n    return [r_A, r_B, eta_hat, LB, UB, okL, okU]\n\nsolve()\n```"
        }
    ]
}