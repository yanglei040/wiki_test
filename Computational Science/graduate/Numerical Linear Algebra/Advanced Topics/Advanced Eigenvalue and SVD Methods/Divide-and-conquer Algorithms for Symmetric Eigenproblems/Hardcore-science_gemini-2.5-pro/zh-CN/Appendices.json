{
    "hands_on_practices": [
        {
            "introduction": "分治算法的合并步骤依赖于求解一个对角加一秩矩阵的特征值。这个过程由一个称为“世俗函数” (secular function) 的特殊有理函数控制。本练习将引导你从第一性原理出发，推导世俗函数及其导数，理解这些表达式对于开发高效稳定的数值求解器（例如基于牛顿法的求解器）至关重要。",
            "id": "3543876",
            "problem": "考虑一个在对称三对角矩阵的分治方法中出现的对称特征值问题，其中需要求解一个对角矩阵的秩一修正的特征值。设 $D \\in \\mathbb{R}^{n \\times n}$ 是一个对角矩阵，其对角线元素 $d_{1}  d_{2}  \\cdots  d_{n}$ 互不相同，设 $z \\in \\mathbb{R}^{n}$ 是一个非零向量，且 $\\rho \\in \\mathbb{R} \\setminus \\{0\\}$。更新后的矩阵为 $D + \\rho z z^{\\top}$。$D + \\rho z z^{\\top}$ 的特征值 $\\lambda$ 正是世俗方程的根，该方程可以从矩阵行列式引理中获得，该引理指出：对于任意可逆矩阵 $A \\in \\mathbb{R}^{n \\times n}$ 和向量 $u, v \\in \\mathbb{R}^{n}$，有 $\\det(A + u v^{\\top}) = \\det(A)\\left(1 + v^{\\top} A^{-1} u\\right)$。使用这个基本恒等式，令 $A = D - \\lambda I$，推导出标量世俗函数 $f(\\lambda)$，其零点即为 $D + \\rho z z^{\\top}$ 的特征值。从第一性原理出发，推导出导数 $f'(\\lambda)$ 的表达式，不要使用任何预先记忆的快捷公式。然后，解释 $f'(\\lambda)$ 如何用于对单根 $\\lambda^{\\ast}$ 关于 $\\rho$ 的扰动进行敏感性估计，以及如何用于构造一个高效的牛顿迭代法来精确求解位于交错区间 $(d_{j}, d_{j+1})$ 内的根。作为您的最终任务，写出当对世俗方程 $f(\\lambda) = 0$ 应用牛顿法时，单步牛顿迭代 $\\lambda_{k+1}$ 关于 $\\lambda_{k}$、$\\{d_{i}\\}_{i=1}^{n}$、$\\{z_{i}\\}_{i=1}^{n}$ 和 $\\rho$ 的闭式解析表达式。最终答案应为 $\\lambda_{k+1}$ 的解析表达式（无需进行数值计算）。",
            "solution": "所述问题具有科学依据，是适定的、客观的且内部一致的。它提出了一个数值线性代数领域的标准且不平凡的任务，特别是关于对称特征值问题的分治算法。所有必要的信息都已提供，术语精确。因此，该问题是有效的，可以推导出完整的解。\n\n矩阵 $D + \\rho z z^{\\top}$ 的特征值 $\\lambda$ 是使得矩阵 $D + \\rho z z^{\\top} - \\lambda I$ 为奇异的标量。这等价于其行列式为零：\n$$\n\\det\\left(D + \\rho z z^{\\top} - \\lambda I\\right) = 0\n$$\n我们可以重新排列行列式内的表达式，以匹配矩阵行列式引理所需的形式：\n$$\n\\det\\left((D - \\lambda I) + (\\rho z) z^{\\top}\\right) = 0\n$$\n矩阵行列式引理指出，对于一个可逆矩阵 $A$ 和向量 $u, v$，我们有 $\\det(A + u v^{\\top}) = \\det(A)(1 + v^{\\top} A^{-1} u)$。我们识别出 $A = D - \\lambda I$，$u = \\rho z$，$v = z$。为了使该引理适用，$A = D - \\lambda I$ 必须是可逆的，这意味着 $\\lambda$ 不能是 $D$ 的对角元素 $d_i$ 中的任何一个。如果我们假设 $\\lambda \\notin \\{d_1, \\dots, d_n\\}$，我们可以应用该引理：\n$$\n\\det(D - \\lambda I) \\left(1 + z^{\\top} (D - \\lambda I)^{-1} (\\rho z)\\right) = 0\n$$\n由于我们假设对所有 $i$ 都有 $\\lambda \\neq d_i$，第一项 $\\det(D - \\lambda I) = \\prod_{i=1}^{n} (d_i - \\lambda)$ 是非零的。因此，特征值必须是第二项因子的根：\n$$\n1 + z^{\\top} (D - \\lambda I)^{-1} (\\rho z) = 0\n$$\n由于 $\\rho$ 是一个标量，这可以写成：\n$$\n1 + \\rho z^{\\top} (D - \\lambda I)^{-1} z = 0\n$$\n矩阵 $D - \\lambda I$ 是一个对角矩阵，其对角元素为 $(d_i - \\lambda)$。它的逆矩阵 $(D - \\lambda I)^{-1}$ 也是一个对角矩阵，其对角元素为 $1 / (d_i - \\lambda)$。因此，二次型 $z^{\\top} (D - \\lambda I)^{-1} z$ 可以计算为：\n$$\nz^{\\top} (D - \\lambda I)^{-1} z = \\sum_{i=1}^{n} z_i \\left(\\frac{1}{d_i - \\lambda}\\right) z_i = \\sum_{i=1}^{n} \\frac{z_i^2}{d_i - \\lambda}\n$$\n将此代入方程得到世俗方程。世俗函数 $f(\\lambda)$ 的零点是 $D + \\rho z z^{\\top}$ 的特征值（不等于任何 $d_i$），其表达式为：\n$$\nf(\\lambda) = 1 + \\rho \\sum_{i=1}^{n} \\frac{z_i^2}{d_i - \\lambda}\n$$\n\n接下来，我们从第一性原理推导导数 $f'(\\lambda)$。我们对 $f(\\lambda)$ 关于 $\\lambda$ 逐项求导：\n$$\nf'(\\lambda) = \\frac{d}{d\\lambda} \\left(1 + \\rho \\sum_{i=1}^{n} \\frac{z_i^2}{d_i - \\lambda}\\right)\n$$\n常数 $1$ 的导数为 $0$。我们可以将常数因子 $\\rho$ 和求和符号移到微分之外：\n$$\nf'(\\lambda) = \\rho \\sum_{i=1}^{n} z_i^2 \\frac{d}{d\\lambda} \\left(\\frac{1}{d_i - \\lambda}\\right) = \\rho \\sum_{i=1}^{n} z_i^2 \\frac{d}{d\\lambda} \\left((d_i - \\lambda)^{-1}\\right)\n$$\n使用链式法则 $\\frac{d}{dx} u(x)^{-1} = -u(x)^{-2} u'(x)$，令 $u(\\lambda) = d_i - \\lambda$，我们有 $u'(\\lambda) = -1$。\n$$\n\\frac{d}{d\\lambda} \\left((d_i - \\lambda)^{-1}\\right) = -1 \\cdot (d_i - \\lambda)^{-2} \\cdot (-1) = \\frac{1}{(d_i - \\lambda)^2}\n$$\n将此代回 $f'(\\lambda)$ 的表达式中，我们得到：\n$$\nf'(\\lambda) = \\rho \\sum_{i=1}^{n} \\frac{z_i^2}{(d_i - \\lambda)^2}\n$$\n\n导数 $f'(\\lambda)$ 在敏感性分析和数值求根中都扮演着至关重要的角色。\n\n1.  **敏感性分析**：令 $\\lambda^*$ 为世俗方程的一个单根，因此 $f(\\lambda^*, \\rho)=0$。我们可以将根看作是参数 $\\rho$ 的一个隐函数，即 $\\lambda^*(\\rho)$。特征值 $\\lambda^*$ 对 $\\rho$ 的扰动的敏感性由导数 $\\frac{d\\lambda^*}{d\\rho}$ 给出。通过使用多元链式法则对恒等式 $f(\\lambda^*(\\rho), \\rho) = 0$ 关于 $\\rho$ 求导，我们得到：\n    $$\n    \\frac{\\partial f}{\\partial \\lambda} \\frac{d\\lambda^*}{d\\rho} + \\frac{\\partial f}{\\partial \\rho} = 0 \\implies \\frac{d\\lambda^*}{d\\rho} = - \\frac{\\partial f / \\partial \\rho}{\\partial f / \\partial \\lambda}\n    $$\n    分母正是 $f'(\\lambda^*)$。分子是 $\\frac{\\partial f}{\\partial \\rho} = \\frac{\\partial}{\\partial \\rho} \\left(1 + \\rho \\sum_{i=1}^{n} \\frac{z_i^2}{d_i - \\lambda^*}\\right) = \\sum_{i=1}^{n} \\frac{z_i^2}{d_i - \\lambda^*}$。由世俗方程 $f(\\lambda^*, \\rho)=0$ 可知 $\\rho \\sum_{i=1}^{n} \\frac{z_i^2}{d_i - \\lambda^*} = -1$，这意味着 $\\sum_{i=1}^{n} \\frac{z_i^2}{d_i - \\lambda^*} = -\\frac{1}{\\rho}$。因此，$\\frac{\\partial f}{\\partial \\rho} = -\\frac{1}{\\rho}$。\n    因此，敏感性为 $\\frac{d\\lambda^*}{d\\rho} = - \\frac{-1/\\rho}{f'(\\lambda^*)} = \\frac{1}{\\rho f'(\\lambda^*)}$。所以，导数 $f'(\\lambda^*)$ 与特征值对 $\\rho$ 变化的敏感性成反比。\n\n2.  **牛顿法**：为了数值求解 $f(\\lambda)=0$ 的根，牛顿法是一个非常高效的选择。迭代公式为 $\\lambda_{k+1} = \\lambda_k - \\frac{f(\\lambda_k)}{f'(\\lambda_k)}$。导数 $f'(\\lambda_k)$ 是函数在 $\\lambda_k$ 处的切线斜率，下一个迭代点 $\\lambda_{k+1}$ 是该切线与 $\\lambda$ 轴的交点。$f'(\\lambda)$ 的表达式计算成本低廉（$O(n)$ 次运算），对于实现该方法至关重要。此外，$f'(\\lambda)$ 的性质保证了其良好的表现。对于极点 $d_j$ 和 $d_{j+1}$ 之间的任何 $\\lambda$， $f'(\\lambda)$ 的求和式中所有项均为正，因此 $f'(\\lambda)$ 的符号与 $\\rho$ 的符号相同。这意味着 $f(\\lambda)$ 在每个交错区间内是严格单调的，这保证了像牛顿法这样的求根算法能够可靠地收敛到该区间内的唯一根。\n\n最后，我们写下单步牛顿迭代的闭式解析表达式。给定当前近似值 $\\lambda_k$，下一个近似值 $\\lambda_{k+1}$ 由公式 $\\lambda_{k+1} = \\lambda_k - \\frac{f(\\lambda_k)}{f'(\\lambda_k)}$ 给出。代入我们推导出的 $f(\\lambda)$ 和 $f'(\\lambda)$ 的表达式：\n$$\nf(\\lambda_k) = 1 + \\rho \\sum_{i=1}^{n} \\frac{z_i^2}{d_i - \\lambda_k}\n$$\n$$\nf'(\\lambda_k) = \\rho \\sum_{i=1}^{n} \\frac{z_i^2}{(d_i - \\lambda_k)^2}\n$$\n得到的牛顿迭代步骤的表达式为：\n$$\n\\lambda_{k+1} = \\lambda_k - \\frac{1 + \\rho \\displaystyle\\sum_{i=1}^{n} \\frac{z_i^2}{d_i - \\lambda_k}}{\\rho \\displaystyle\\sum_{i=1}^{n} \\frac{z_i^2}{(d_i - \\lambda_k)^2}}\n$$\n此表达式为精确求解世俗方程的根提供了完整的更新规则。",
            "answer": "$$\n\\boxed{\\lambda_{k+1} = \\lambda_k - \\frac{1 + \\rho \\sum_{i=1}^{n} \\frac{z_{i}^{2}}{d_{i} - \\lambda_{k}}}{\\rho \\sum_{i=1}^{n} \\frac{z_{i}^{2}}{(d_{i} - \\lambda_{k})^{2}}}}\n$$"
        },
        {
            "introduction": "在理解了世俗方程背后的理论之后，将其应用于一个具体的数值例子会很有启发性。本练习提供了一个小而明确的对角加一秩问题，其精确解是已知的。通过手动执行每个步骤——推导并求解世俗方程，以及构造新的特征向量——你将能验证自己对分治合并机制的理解，并观察到一秩更新是如何扰动原始谱的。",
            "id": "3543882",
            "problem": "考虑在一个分治 (DC) 步骤中，在两个子问题完全对角化后，通过单次合并构造的对称三对角矩阵。设子问题的特征分解已经是单位矩阵，因此在合并后的基中，对角线部分为\n$$\nD \\;=\\; \\operatorname{diag}\\!\\big(d_1, d_2, d_3, d_4\\big)\n\\;=\\;\n\\operatorname{diag}\\!\\big(-1,\\,1,\\,3,\\,5\\big),\n$$\n且秩一耦合由下式指定\n$$\n\\rho \\;=\\; 1, \n\\qquad\nz \\;=\\; e_2 + e_3,\n$$\n其中 $e_k$ 表示 $\\mathbb{R}^{4}$ 中的第 $k$ 个标准基向量。在对角基中，合并后的矩阵为\n$$\n\\widehat{T} \\;=\\; D + \\rho\\, z z^{\\top}\n\\;=\\;\n\\begin{pmatrix}\n-1   0   0   0\\\\\n0   2   1   0\\\\\n0   1   4   0\\\\\n0   0   0   5\n\\end{pmatrix}.\n$$\n注意，在原始标准基（此处与合并基相同，因为子问题是对角化的）中表示时，$\\widehat{T}$ 是三对角的。其精确的特征对可以通过观察 $2\\times 2$ 的内部块和未受影响的外部对角元得到。\n\n仅从适用于数值线性代数的核心线性代数原理出发，即：\n- 矩阵行列式引理，\n- 特征对的定义，以及\n- 与世俗根 $\\sigma$ 对应的对角加秩一矩阵的特征向量与 $(D-\\sigma I)^{-1}z$ 成比例这一事实，\n\n按如下方式在对角基中执行 DC 合并分析。\n1. 将矩阵行列式引理应用于 $\\det(\\widehat{T}-\\sigma I)$，推导出世俗方程，并将其简化为关于 $\\sigma$ 的标量有理方程。\n2. 精确求解此标量方程，以获得两个非平凡的世俗根。\n3. 对于这两个世俗根中较大的一个，构造其在对角基中的对应特征向量，将其归一化为单位 $2$-范数，并验证其支撑集仅在第二和第三坐标上。\n4. 解释为什么在此次合并中，$d_1$ 和 $d_4$ 仍然是特征值，其对应的特征向量分别为 $e_1$ 和 $e_4$。\n\n两个世俗根中较大的一个是什么？请以精确形式表示最终答案。无需四舍五入，不涉及单位。",
            "solution": "该问题要求分析用于寻找对称矩阵特征值的的分治算法中的一个步骤。所讨论的矩阵形式为 $\\widehat{T} = D + \\rho z z^{\\top}$，这是一个对角加秩一 (DPR1) 矩阵。给定的参数是对角矩阵 $D = \\operatorname{diag}(-1, 1, 3, 5)$，标量 $\\rho = 1$，以及向量 $z = e_2 + e_3 = [0, 1, 1, 0]^{\\top}$。\n\n1. 推导世俗方程。\n$\\widehat{T}$ 的特征值 $\\sigma$ 是特征方程 $\\det(\\widehat{T} - \\sigma I) = 0$ 的根。代入 $\\widehat{T}$ 的定义，我们有：\n$$\n\\det(D + \\rho z z^{\\top} - \\sigma I) = \\det((D - \\sigma I) + (\\rho z) z^{\\top}) = 0\n$$\n我们应用矩阵行列式引理，该引理指出，对于可逆矩阵 $A$ 和向量 $u, v$，有 $\\det(A + uv^{\\top}) = (1 + v^{\\top}A^{-1}u)\\det(A)$。令 $A = D - \\sigma I$，$u = \\rho z$，$v = z$。这对任何不是 $D$ 的特征值的 $\\sigma$ 都适用，从而确保 $A$ 是可逆的。特征方程变为：\n$$\n(1 + \\rho z^{\\top}(D - \\sigma I)^{-1}z) \\det(D - \\sigma I) = 0\n$$\n因此，$\\widehat{T}$ 的特征值是使 $\\det(D - \\sigma I) = 0$ 或 $1 + \\rho z^{\\top}(D - \\sigma I)^{-1}z = 0$ 成立的 $\\sigma$ 值。\n当 $\\sigma$ 是 $D$ 的特征值时，项 $\\det(D - \\sigma I) = \\prod_{i=1}^4 (d_i - \\sigma)$ 为零。第二项产生了世俗方程。\n矩阵 $(D - \\sigma I)^{-1}$ 是一个对角矩阵，其对角元为 $\\frac{1}{d_i - \\sigma}$。项 $z^{\\top}(D - \\sigma I)^{-1}z$ 是一个标量，由下式给出：\n$$\nz^{\\top}(D - \\sigma I)^{-1}z = \\sum_{i=1}^4 \\frac{z_i^2}{d_i - \\sigma}\n$$\n给定 $z = [0, 1, 1, 0]^{\\top}$，我们有 $z_1=0, z_2=1, z_3=1, z_4=0$。求和式简化为：\n$$\n\\sum_{i=1}^4 \\frac{z_i^2}{d_i - \\sigma} = \\frac{0^2}{d_1 - \\sigma} + \\frac{1^2}{d_2 - \\sigma} + \\frac{1^2}{d_3 - \\sigma} + \\frac{0^2}{d_4 - \\sigma} = \\frac{1}{d_2 - \\sigma} + \\frac{1}{d_3 - \\sigma}\n$$\n根据给定值 $d_2 = 1, d_3 = 3$ 和 $\\rho=1$，世俗方程 $1 + \\rho z^{\\top}(D - \\sigma I)^{-1}z = 0$ 变为：\n$$\nf(\\sigma) = 1 + \\frac{1}{1 - \\sigma} + \\frac{1}{3 - \\sigma} = 0\n$$\n这就是所要求的关于 $\\sigma$ 的标量有理方程。该方程的根是 $\\widehat{T}$ 中那些不是 $D$ 的特征值的特征值。\n\n2. 求解世俗方程。\n为了求解 $\\sigma$，我们乘以 $(1-\\sigma)(3-\\sigma)$ 来去分母，假设 $\\sigma \\neq 1$ 且 $\\sigma \\neq 3$：\n$$\n(1 - \\sigma)(3 - \\sigma) + (3 - \\sigma) + (1 - \\sigma) = 0\n$$\n展开各项：\n$$\n(3 - \\sigma - 3\\sigma + \\sigma^2) + (3 - \\sigma) + (1 - \\sigma) = 0\n$$\n$$\n(\\sigma^2 - 4\\sigma + 3) + (4 - 2\\sigma) = 0\n$$\n$$\n\\sigma^2 - 6\\sigma + 7 = 0\n$$\n这是一个关于 $\\sigma$ 的二次方程。我们使用二次方程求根公式 $\\sigma = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$：\n$$\n\\sigma = \\frac{-(-6) \\pm \\sqrt{(-6)^2 - 4(1)(7)}}{2(1)} = \\frac{6 \\pm \\sqrt{36 - 28}}{2} = \\frac{6 \\pm \\sqrt{8}}{2}\n$$\n化简平方根，$\\sqrt{8} = \\sqrt{4 \\cdot 2} = 2\\sqrt{2}$。\n$$\n\\sigma = \\frac{6 \\pm 2\\sqrt{2}}{2} = 3 \\pm \\sqrt{2}\n$$\n两个非平凡的世俗根是 $\\sigma_1 = 3 - \\sqrt{2}$ 和 $\\sigma_2 = 3 + \\sqrt{2}$。\n\n3. 较大世俗根对应的特征向量。\n较大的根是 $\\sigma = 3 + \\sqrt{2}$。对应的特征向量 $v$ 与 $(D - \\sigma I)^{-1}z$ 成比例。特征向量的分量 $v_i$ 由 $v_i \\propto \\frac{z_i}{d_i - \\sigma}$ 给出。\n对于 $i=1$ 和 $i=4$，$z_1=0$ 且 $z_4=0$，所以 $v_1=0$ 且 $v_4=0$。这证实了该特征向量的支撑集仅在第二和第三坐标上。\n对于 $i=2$：\n$$\nv_2 \\propto \\frac{z_2}{d_2 - \\sigma} = \\frac{1}{1 - (3 + \\sqrt{2})} = \\frac{1}{-2 - \\sqrt{2}}\n$$\n对于 $i=3$：\n$$\nv_3 \\propto \\frac{z_3}{d_3 - \\sigma} = \\frac{1}{3 - (3 + \\sqrt{2})} = \\frac{1}{-\\sqrt{2}}\n$$\n一个未归一化的特征向量是 $v' = \\begin{pmatrix} 0  \\frac{1}{-2-\\sqrt{2}}  \\frac{1}{-\\sqrt{2}}  0 \\end{pmatrix}^{\\top}$。\n为将此向量归一化，我们计算其 $2$-范数的平方：\n$$\n\\|v'\\|_2^2 = \\left(\\frac{1}{-2-\\sqrt{2}}\\right)^2 + \\left(\\frac{1}{-\\sqrt{2}}\\right)^2 = \\frac{1}{(2+\\sqrt{2})^2} + \\frac{1}{2} = \\frac{1}{4+4\\sqrt{2}+2} + \\frac{1}{2} = \\frac{1}{6+4\\sqrt{2}} + \\frac{1}{2}\n$$\n我们对第一项进行有理化：\n$$\n\\frac{1}{6+4\\sqrt{2}} = \\frac{1}{6+4\\sqrt{2}} \\cdot \\frac{6-4\\sqrt{2}}{6-4\\sqrt{2}} = \\frac{6-4\\sqrt{2}}{36 - 16(2)} = \\frac{6-4\\sqrt{2}}{36-32} = \\frac{6-4\\sqrt{2}}{4} = \\frac{3-2\\sqrt{2}}{2}\n$$\n现在，代回到范数计算中：\n$$\n\\|v'\\|_2^2 = \\frac{3-2\\sqrt{2}}{2} + \\frac{1}{2} = \\frac{4-2\\sqrt{2}}{2} = 2-\\sqrt{2}\n$$\n其范数为 $\\|v'\\|_2 = \\sqrt{2-\\sqrt{2}}$。因此，归一化的特征向量 $v$ 为：\n$$\nv = \\frac{1}{\\sqrt{2-\\sqrt{2}}} \\begin{pmatrix} 0 \\\\ \\frac{1}{-2-\\sqrt{2}} \\\\ \\frac{1}{-\\sqrt{2}} \\\\ 0 \\end{pmatrix}\n$$\n\n4. 未受影响的特征值和特征向量。\n我们必须解释为什么 $d_1 = -1$ 和 $d_4 = 5$ 仍然是 $\\widehat{T}$ 的特征值，其对应的特征向量分别为 $e_1$ 和 $e_4$。\n考虑特征向量方程 $\\widehat{T}x = \\lambda x$。让我们检验 $(\\lambda, x) = (d_1, e_1)$ 这一对。\n$$\n\\widehat{T}e_1 = (D + \\rho z z^{\\top})e_1 = D e_1 + \\rho z (z^{\\top}e_1)\n$$\n根据定义，$D e_1 = d_1 e_1$。项 $z^{\\top}e_1$ 是 $z=[0,1,1,0]^{\\top}$ 和 $e_1=[1,0,0,0]^{\\top}$ 的点积，即 $0 \\cdot 1 + 1 \\cdot 0 + 1 \\cdot 0 + 0 \\cdot 0 = 0$。\n因此，方程简化为：\n$$\n\\widehat{T}e_1 = d_1 e_1 + \\rho z(0) = d_1 e_1\n$$\n这表明 $e_1$ 是 $\\widehat{T}$ 的一个特征向量，对应的特征值为 $d_1 = -1$。\n类似地，对于 $(\\lambda, x) = (d_4, e_4)$ 这一对：\n$$\n\\widehat{T}e_4 = (D + \\rho z z^{\\top})e_4 = D e_4 + \\rho z (z^{\\top}e_4)\n$$\n$D e_4 = d_4 e_4$。项 $z^{\\top}e_4$ 是 $z=[0,1,1,0]^{\\top}$ 和 $e_4=[0,0,0,1]^{\\top}$ 的点积，即 $0$。\n因此，方程变为：\n$$\n\\widehat{T}e_4 = d_4 e_4 + \\rho z(0) = d_4 e_4\n$$\n这表明 $e_4$ 是 $\\widehat{T}$ 的一个特征向量，对应的特征值为 $d_4 = 5$。\n一般而言，如果 $D$ 的一个特征向量 $e_i$ 与更新向量 $z$ 正交，那么它仍然是更新后矩阵 $\\widehat{T}=D+\\rho z z^{\\top}$ 的一个特征向量。这等价于 $z$ 的第 $i$ 个分量 $z_i$ 为零。在本问题中，$z_1=0$ 且 $z_4=0$，因此特征对 $(d_1, e_1)$ 和 $(d_4, e_4)$ 不受秩一更新的影响。\n\n两个非平凡的世俗根 $3-\\sqrt{2}$ 和 $3+\\sqrt{2}$ 中，较大的一个是 $3+\\sqrt{2}$。",
            "answer": "$$\\boxed{3 + \\sqrt{2}}$$"
        },
        {
            "introduction": "实际的数值算法必须对可能导致不稳定的特殊情况具有鲁棒性。在世俗方程的背景下，一个关键挑战出现在当对角矩阵 $D$ 的对角元素不唯一时，这会导致世俗函数中出现重叠的极点。本练习探讨处理此类退化情况的正确方法，你将识别一个涉及局部旋转的稳定过程，它能有效地对问题进行“降维” (deflate)，这在数值线性代数中是一种强大的技术，而非依赖可能在数值上失败的朴素方法。",
            "id": "3543892",
            "problem": "在用于对称特征问题的分治算法中，一个对称三对角矩阵被正交约化并分块，使得一个子问题以对角加一秩矩阵 $D + \\rho z z^{\\top}$ 的形式出现，其中 $D = \\mathrm{diag}(d_1,\\dots,d_n)$，$\\rho \\in \\mathbb{R}$，且 $z \\in \\mathbb{R}^n$。特征值通过求解相关的世俗子问题来恢复，已知该子问题具有有理结构，其极点位于 $D$ 的各元素上。考虑这样一种情况：存在一个索引集 $I = \\{i_1,\\dots,i_m\\}$（其中 $m \\ge 2$），使得 $d_{i_1} = \\cdots = d_{i_m} = \\delta$，即对角矩阵 $D$ 在值 $\\delta$ 处有一个 $m$ 维的简并特征空间。这种简并性在世俗子问题的有理结构中表现为重复的极点，如果处理不当，可能会导致数值不稳定性。\n\n下列哪个过程是鲁棒的，即它能在世俗方程求值中避免产生无穷大，保持数值正交性，并产生与分治框架一致的稳定特征对？\n\nA. 将 $I$ 中的索引分组，为子空间 $\\mathcal{S} = \\mathrm{span}\\{e_{i_k} : k = 1,\\dots,m\\}$ 构建一个标准正交基 $Q \\in \\mathbb{R}^{m \\times m}$，使得 $Q^{\\top} z_I = [\\alpha, 0, \\dots, 0]^{\\top}$，其中 $\\alpha = \\|z_I\\|_2$ 且 $z_I \\in \\mathbb{R}^m$ 是 $z$ 在 $I$ 上的限制。然后，用 $\\delta I_m + \\rho \\tilde{z}_I \\tilde{z}_I^{\\top}$ 替换简并块的贡献，其中 $\\tilde{z}_I = [\\alpha, 0, \\dots, 0]^{\\top}$。这将在 $\\delta$ 处产生一个总权重为 $\\alpha^2$ 的单一有效极点，对 $m-1$ 个零权重方向进行降维处理，并稳定地求解世俗子问题；特征向量通过 $Q$ 进行反向旋转恢复。\n\nB. 添加大小为 $\\mathcal{O}(\\epsilon)$ 的独立扰动来分裂 $D$ 中的相等元素，使得 $d_{i_k}$ 变得互不相同，求解具有不同极点的标准世俗问题，然后在最后将扰动设置回零以恢复原始值。\n\nC. 保持重复的元素不变，直接使用重复的分母来计算有理世俗结构，并使用诸如洛必达法则之类的形式化极限论证来消除在 $\\lambda = \\delta$ 处的无穷大。\n\nD. 通过将来自 $I$ 的贡献中的每个分母 $(\\delta - \\lambda)$ 替换为 $m(\\delta - \\lambda)$ 来合并重复的极点，从而在不改变 $\\mathcal{S}$ 上基的情况下，将组合项缩放为 $\\rho \\sum_{k=1}^m z_{i_k}^2 / \\big(m(\\delta - \\lambda)\\big)$。",
            "solution": "这个问题解决了分治算法数值稳定性的一个关键方面：如何处理对角矩阵 $D$ 中的简并（相同）特征值，这种情况对应于世俗方程中的重复极点。我们来分析各个选项。\n\n*   **A. (正确)** 该选项描述了标准的、数值稳健的技术，称为**缩减 (deflation)**。当一组对角元素相同时，即 $d_{i_1} = \\cdots = d_{i_m} = \\delta$，对应的标准基向量 $\\{e_{i_k}\\}_{k=1}^m$ 张成了 $D$ 对于特征值 $\\delta$ 的一个 $m$ 维特征空间。核心思想是在这个不变子空间内部进行一次正交基变换，以简化秩一修正向量 $z$ 的结构。可以构建一个正交旋转 $Q \\in \\mathbb{R}^{m \\times m}$（例如，一个Householder变换），将子向量 $z_I$（$z$ 在简并索引上的分量）映射到一个仅在第一个分量上非零的向量：$Q^{\\top} z_I = [\\alpha, 0, \\dots, 0]^{\\top}$，其中 $\\alpha = \\|z_I\\|_2$。在这个新基下，秩一修正只影响一个维度。有 $m-1$ 个维度不受更新的影响，这意味着 $\\delta$ 仍然是矩阵的一个特征值，其重数至少为 $m-1$。这 $m-1$ 个特征对从问题中被“缩减”掉了，从而将世俗方程简化为在 $\\delta$ 处只有一个极点。这避免了除以零的问题，是高质量数值库（如LAPACK）中采用的标准过程。\n\n*   **B. (错误)** 添加微小的随机扰动来打破简并性（“抖动”）是一种数值上很差的策略。它将一个定义明确的问题转变为一个潜在的病态问题，其中极点非常接近。这可能导致计算出的特征值出现显著误差，更严重的是，会导致相应特征向量灾难性地失去正交性。结果对任意选择的扰动变得敏感。\n\n*   **C. (错误)** 虽然洛必达法则可以在理论分析中用于求世俗函数的极限，但它不是一个适用于浮点运算的实用数值算法。它没有解决根本问题，即当 $z_I$ 有多个非零分量时，基 $\\{e_{i_k}\\}$ 对于该问题是不合适的。数值不稳定性依然存在。\n\n*   **D. (错误)** 该选项提出了一个随意的、没有数学依据的缩放项。它完全改变了原问题，并且不对应于任何能保持原矩阵 $D + \\rho z z^{\\top}$ 特征值的有效变换。这是一种临时的修改，会导致错误的解。\n\n因此，选项A是唯一描述了处理世俗方程中重复极点的、数学上合理且数值稳定的过程。",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}