{
    "hands_on_practices": [
        {
            "introduction": "The heart of the divide-and-conquer algorithm is the \"merge\" step, where the eigensystem of a larger matrix is constructed from the eigensystems of two smaller subproblems. This process mathematically reduces to finding the eigenpairs of a diagonal-plus-rank-one (DPR1) matrix. This first exercise provides a concrete, step-by-step walkthrough of this merge process, demystifying the abstract theory by applying it to a small, manageable example where the solution can be verified directly.",
            "id": "3543882",
            "problem": "Consider the symmetric tridiagonal matrix constructed as a single merge in a divide-and-conquer (DC) step after complete diagonalization of two subproblems. Let the subproblem eigen-decompositions already be the identity, so that the diagonal in the merged basis is\n$$\nD \\;=\\; \\operatorname{diag}\\!\\big(d_1, d_2, d_3, d_4\\big)\n\\;=\\;\n\\operatorname{diag}\\!\\big(-1,\\,1,\\,3,\\,5\\big),\n$$\nand the rank-one coupling is specified by\n$$\n\\rho \\;=\\; 1, \n\\qquad\nz \\;=\\; e_2 + e_3,\n$$\nwhere $e_k$ denotes the $k$-th standard basis vector in $\\mathbb{R}^{4}$. The merged matrix in the diagonal basis is\n$$\n\\widehat{T} \\;=\\; D + \\rho\\, z z^{\\top}\n\\;=\\;\n\\begin{pmatrix}\n-1  0  0  0\\\\\n0  2  1  0\\\\\n0  1  4  0\\\\\n0  0  0  5\n\\end{pmatrix}.\n$$\nNote that, expressed in the original standard basis (here identical to the merged basis because the subproblems were diagonal), $\\widehat{T}$ is tridiagonal. Its exact eigenpairs can be obtained by inspection of the $2\\times 2$ interior block and the unaffected outer diagonal entries.\n\nStarting only from core linear algebraic principles appropriate for numerical linear algebra, namely:\n- the Matrix Determinant Lemma,\n- the definition of eigenpairs, and\n- the fact that the eigenvectors of a diagonal-plus-rank-one matrix corresponding to a secular root $\\sigma$ are proportional to $(D-\\sigma I)^{-1}z$,\n\nperform the DC merge analysis in the diagonal basis as follows.\n1. Derive the secular equation by applying the Matrix Determinant Lemma to $\\det(\\widehat{T}-\\sigma I)$ and reduce it to a scalar rational equation in $\\sigma$.\n2. Solve this scalar equation exactly to obtain the two nontrivial secular roots.\n3. For the larger of these two secular roots, construct the corresponding eigenvector in the diagonal basis, normalize it to unit $2$-norm, and verify that it has support only on the second and third coordinates.\n4. Explain why $d_1$ and $d_4$ remain eigenvalues with eigenvectors $e_1$ and $e_4$ in this merge.\n\nWhat is the larger of the two secular roots? Express your final answer in exact form. No rounding is required and no units are involved.",
            "solution": "The problem requires an analysis of a single step in the divide-and-conquer algorithm for finding eigenvalues of a symmetric matrix. The matrix in question is of the form $\\widehat{T} = D + \\rho z z^{\\top}$, a diagonal-plus-rank-one (DPR1) matrix. The given parameters are the diagonal matrix $D = \\operatorname{diag}(-1, 1, 3, 5)$, the scalar $\\rho = 1$, and the vector $z = e_2 + e_3 = [0, 1, 1, 0]^{\\top}$.\n\n1. Derivation of the secular equation.\nThe eigenvalues $\\sigma$ of $\\widehat{T}$ are the roots of the characteristic equation $\\det(\\widehat{T} - \\sigma I) = 0$. Substituting the definition of $\\widehat{T}$, we have:\n$$\n\\det(D + \\rho z z^{\\top} - \\sigma I) = \\det((D - \\sigma I) + (\\rho z) z^{\\top}) = 0\n$$\nWe apply the Matrix Determinant Lemma, which states that for an invertible matrix $A$ and vectors $u, v$, $\\det(A + uv^{\\top}) = (1 + v^{\\top}A^{-1}u)\\det(A)$. Let $A = D - \\sigma I$, $u = \\rho z$, and $v = z$. This is applicable for any $\\sigma$ that is not an eigenvalue of $D$, ensuring $A$ is invertible. The characteristic equation becomes:\n$$\n(1 + \\rho z^{\\top}(D - \\sigma I)^{-1}z) \\det(D - \\sigma I) = 0\n$$\nThe eigenvalues of $\\widehat{T}$ are therefore the values of $\\sigma$ for which either $\\det(D - \\sigma I) = 0$ or $1 + \\rho z^{\\top}(D - \\sigma I)^{-1}z = 0$.\nThe term $\\det(D - \\sigma I) = \\prod_{i=1}^4 (d_i - \\sigma)$ is zero when $\\sigma$ is an eigenvalue of $D$. The second term gives rise to the secular equation.\nThe matrix $(D - \\sigma I)^{-1}$ is a diagonal matrix with entries $\\frac{1}{d_i - \\sigma}$. The term $z^{\\top}(D - \\sigma I)^{-1}z$ is a scalar given by:\n$$\nz^{\\top}(D - \\sigma I)^{-1}z = \\sum_{i=1}^4 \\frac{z_i^2}{d_i - \\sigma}\n$$\nGiven $z = [0, 1, 1, 0]^{\\top}$, we have $z_1=0$, $z_2=1$, $z_3=1$, $z_4=0$. The summation simplifies to:\n$$\n\\sum_{i=1}^4 \\frac{z_i^2}{d_i - \\sigma} = \\frac{0^2}{d_1 - \\sigma} + \\frac{1^2}{d_2 - \\sigma} + \\frac{1^2}{d_3 - \\sigma} + \\frac{0^2}{d_4 - \\sigma} = \\frac{1}{d_2 - \\sigma} + \\frac{1}{d_3 - \\sigma}\n$$\nWith the given values $d_2 = 1$, $d_3 = 3$, and $\\rho=1$, the secular equation $1 + \\rho z^{\\top}(D - \\sigma I)^{-1}z = 0$ becomes:\n$$\nf(\\sigma) = 1 + \\frac{1}{1 - \\sigma} + \\frac{1}{3 - \\sigma} = 0\n$$\nThis is the required scalar rational equation in $\\sigma$. The roots of this equation are the eigenvalues of $\\widehat{T}$ that are not eigenvalues of $D$.\n\n2. Solving the secular equation.\nTo solve for $\\sigma$, we clear the denominators by multiplying by $(1-\\sigma)(3-\\sigma)$, assuming $\\sigma \\neq 1$ and $\\sigma \\neq 3$:\n$$\n(1 - \\sigma)(3 - \\sigma) + (3 - \\sigma) + (1 - \\sigma) = 0\n$$\nExpanding the terms:\n$$\n(3 - \\sigma - 3\\sigma + \\sigma^2) + (3 - \\sigma) + (1 - \\sigma) = 0\n$$\n$$\n(\\sigma^2 - 4\\sigma + 3) + (4 - 2\\sigma) = 0\n$$\n$$\n\\sigma^2 - 6\\sigma + 7 = 0\n$$\nThis is a quadratic equation for $\\sigma$. We use the quadratic formula $\\sigma = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$:\n$$\n\\sigma = \\frac{-(-6) \\pm \\sqrt{(-6)^2 - 4(1)(7)}}{2(1)} = \\frac{6 \\pm \\sqrt{36 - 28}}{2} = \\frac{6 \\pm \\sqrt{8}}{2}\n$$\nSimplifying the square root, $\\sqrt{8} = \\sqrt{4 \\cdot 2} = 2\\sqrt{2}$.\n$$\n\\sigma = \\frac{6 \\pm 2\\sqrt{2}}{2} = 3 \\pm \\sqrt{2}\n$$\nThe two nontrivial secular roots are $\\sigma_1 = 3 - \\sqrt{2}$ and $\\sigma_2 = 3 + \\sqrt{2}$.\n\n3. Eigenvector for the larger secular root.\nThe larger root is $\\sigma = 3 + \\sqrt{2}$. The corresponding eigenvector $v$ is proportional to $(D - \\sigma I)^{-1}z$. The components $v_i$ of the eigenvector are given by $v_i \\propto \\frac{z_i}{d_i - \\sigma}$.\nFor $i=1$ and $i=4$, $z_1=0$ and $z_4=0$, so $v_1=0$ and $v_4=0$. This confirms the eigenvector has support only on the second and third coordinates.\nFor $i=2$:\n$$\nv_2 \\propto \\frac{z_2}{d_2 - \\sigma} = \\frac{1}{1 - (3 + \\sqrt{2})} = \\frac{1}{-2 - \\sqrt{2}}\n$$\nFor $i=3$:\n$$\nv_3 \\propto \\frac{z_3}{d_3 - \\sigma} = \\frac{1}{3 - (3 + \\sqrt{2})} = \\frac{1}{-\\sqrt{2}}\n$$\nAn unnormalized eigenvector is $v' = \\begin{pmatrix} 0  \\frac{1}{-2-\\sqrt{2}}  \\frac{1}{-\\sqrt{2}}  0 \\end{pmatrix}^{\\top}$.\nTo normalize this vector, we compute its squared $2$-norm:\n$$\n\\|v'\\|_2^2 = \\left(\\frac{1}{-2-\\sqrt{2}}\\right)^2 + \\left(\\frac{1}{-\\sqrt{2}}\\right)^2 = \\frac{1}{(2+\\sqrt{2})^2} + \\frac{1}{2} = \\frac{1}{4+4\\sqrt{2}+2} + \\frac{1}{2} = \\frac{1}{6+4\\sqrt{2}} + \\frac{1}{2}\n$$\nWe rationalize the first term:\n$$\n\\frac{1}{6+4\\sqrt{2}} = \\frac{1}{6+4\\sqrt{2}} \\cdot \\frac{6-4\\sqrt{2}}{6-4\\sqrt{2}} = \\frac{6-4\\sqrt{2}}{36 - 16(2)} = \\frac{6-4\\sqrt{2}}{36-32} = \\frac{6-4\\sqrt{2}}{4} = \\frac{3-2\\sqrt{2}}{2}\n$$\nNow, substitute back into the norm calculation:\n$$\n\\|v'\\|_2^2 = \\frac{3-2\\sqrt{2}}{2} + \\frac{1}{2} = \\frac{4-2\\sqrt{2}}{2} = 2-\\sqrt{2}\n$$\nThe norm is $\\|v'\\|_2 = \\sqrt{2-\\sqrt{2}}$. The normalized eigenvector $v$ is therefore:\n$$\nv = \\frac{1}{\\sqrt{2-\\sqrt{2}}} \\begin{pmatrix} 0 \\\\ \\frac{1}{-2-\\sqrt{2}} \\\\ \\frac{1}{-\\sqrt{2}} \\\\ 0 \\end{pmatrix}\n$$\n\n4. Unaffected eigenvalues and eigenvectors.\nWe must explain why $d_1 = -1$ and $d_4 = 5$ remain eigenvalues of $\\widehat{T}$, with eigenvectors $e_1$ and $e_4$ respectively.\nConsider the eigenvector equation $\\widehat{T}x = \\lambda x$. Let's test the pair $(\\lambda, x) = (d_1, e_1)$.\n$$\n\\widehat{T}e_1 = (D + \\rho z z^{\\top})e_1 = D e_1 + \\rho z (z^{\\top}e_1)\n$$\nBy definition, $D e_1 = d_1 e_1$. The term $z^{\\top}e_1$ is the dot product of $z=[0,1,1,0]^{\\top}$ and $e_1=[1,0,0,0]^{\\top}$, which is $0 \\cdot 1 + 1 \\cdot 0 + 1 \\cdot 0 + 0 \\cdot 0 = 0$.\nThus, the equation simplifies to:\n$$\n\\widehat{T}e_1 = d_1 e_1 + \\rho z(0) = d_1 e_1\n$$\nThis shows that $e_1$ is an eigenvector of $\\widehat{T}$ with eigenvalue $d_1 = -1$.\nSimilarly, for the pair $(\\lambda, x) = (d_4, e_4)$:\n$$\n\\widehat{T}e_4 = (D + \\rho z z^{\\top})e_4 = D e_4 + \\rho z (z^{\\top}e_4)\n$$\n$D e_4 = d_4 e_4$. The term $z^{\\top}e_4$ is the dot product of $z=[0,1,1,0]^{\\top}$ and $e_4=[0,0,0,1]^{\\top}$, which is $0$.\nThus, the equation becomes:\n$$\n\\widehat{T}e_4 = d_4 e_4 + \\rho z(0) = d_4 e_4\n$$\nThis shows that $e_4$ is an eigenvector of $\\widehat{T}$ with eigenvalue $d_4 = 5$.\nIn general, an eigenvector $e_i$ of $D$ remains an eigenvector of the updated matrix $\\widehat{T}=D+\\rho z z^{\\top}$ if $e_i$ is orthogonal to the update vector $z$. This is equivalent to the $i$-th component of $z$, $z_i$, being zero. In this problem, $z_1=0$ and $z_4=0$, so the eigenpairs $(d_1, e_1)$ and $(d_4, e_4)$ are unaffected by the rank-one update.\n\nThe larger of the two nontrivial secular roots, $3-\\sqrt{2}$ and $3+\\sqrt{2}$, is $3+\\sqrt{2}$.",
            "answer": "$$\\boxed{3 + \\sqrt{2}}$$"
        },
        {
            "introduction": "After formulating the DPR1 problem, the key computational task is to find the roots of the resulting secular equation. Newton's method provides a powerful and efficient framework for this, but it requires an explicit expression for the function's derivative. This practice focuses on deriving the essential components needed to build a Newton-based solver, connecting the algebraic structure of the secular equation to a practical numerical algorithm.",
            "id": "3543876",
            "problem": "Consider a symmetric eigenproblem that appears in the divide-and-conquer approach for symmetric tridiagonal matrices, where one solves eigenvalues of a rank-one modification of a diagonal matrix. Let $D \\in \\mathbb{R}^{n \\times n}$ be a diagonal matrix with distinct diagonal entries $d_{1}  d_{2}  \\cdots  d_{n}$, let $z \\in \\mathbb{R}^{n}$ be a nonzero vector, and let $\\rho \\in \\mathbb{R} \\setminus \\{0\\}$. The updated matrix is $D + \\rho z z^{\\top}$. The eigenvalues $\\lambda$ of $D + \\rho z z^{\\top}$ are precisely the roots of a secular equation that can be obtained from the Matrix Determinant Lemma, which states that for any invertible matrix $A \\in \\mathbb{R}^{n \\times n}$ and vectors $u, v \\in \\mathbb{R}^{n}$, one has $\\det(A + u v^{\\top}) = \\det(A)\\left(1 + v^{\\top} A^{-1} u\\right)$. Use this fundamental identity, with $A = D - \\lambda I$, to derive the scalar secular function $f(\\lambda)$ whose zeros are the eigenvalues of $D + \\rho z z^{\\top}$. From first principles, derive the expression for the derivative $f'(\\lambda)$ without invoking any pre-remembered shortcut formulas. Then, explain how $f'(\\lambda)$ enters both a sensitivity estimate of a simple root $\\lambda^{\\ast}$ with respect to perturbations in $\\rho$ and the construction of an efficient Newton iteration to refine a root located in an interlacing interval $(d_{j}, d_{j+1})$. As your final task, write down the closed-form analytic expression for a single Newton step $\\lambda_{k+1}$ in terms of $\\lambda_{k}$, $\\{d_{i}\\}_{i=1}^{n}$, $\\{z_{i}\\}_{i=1}^{n}$, and $\\rho$ when applying Newtonâ€™s method to the secular equation $f(\\lambda) = 0$. The final answer should be the analytic expression for $\\lambda_{k+1}$ (no numeric evaluation is required).",
            "solution": "The eigenvalues $\\lambda$ of the matrix $D + \\rho z z^{\\top}$ are the scalars for which the matrix $D + \\rho z z^{\\top} - \\lambda I$ is singular. This is equivalent to its determinant being zero:\n$$\n\\det\\left(D + \\rho z z^{\\top} - \\lambda I\\right) = 0\n$$\nWe can rearrange the expression inside the determinant to match the form required by the Matrix Determinant Lemma:\n$$\n\\det\\left((D - \\lambda I) + (\\rho z) z^{\\top}\\right) = 0\n$$\nThe Matrix Determinant Lemma states that for an invertible matrix $A$ and vectors $u, v$, we have $\\det(A + u v^{\\top}) = \\det(A)(1 + v^{\\top} A^{-1} u)$. We identify $A = D - \\lambda I$, $u = \\rho z$, and $v = z$. For the lemma to be applicable, $A = D - \\lambda I$ must be invertible, which means $\\lambda$ cannot be one of the diagonal entries $d_i$ of $D$. If we assume $\\lambda \\notin \\{d_1, \\dots, d_n\\}$, we can apply the lemma:\n$$\n\\det(D - \\lambda I) \\left(1 + z^{\\top} (D - \\lambda I)^{-1} (\\rho z)\\right) = 0\n$$\nSince we assumed $\\lambda \\neq d_i$ for all $i$, the first term $\\det(D - \\lambda I) = \\prod_{i=1}^{n} (d_i - \\lambda)$ is non-zero. Therefore, the eigenvalues must be the roots of the second factor:\n$$\n1 + z^{\\top} (D - \\lambda I)^{-1} (\\rho z) = 0\n$$\nSince $\\rho$ is a scalar, this can be written as:\n$$\n1 + \\rho z^{\\top} (D - \\lambda I)^{-1} z = 0\n$$\nThe matrix $D - \\lambda I$ is a diagonal matrix with diagonal entries $(d_i - \\lambda)$. Its inverse, $(D - \\lambda I)^{-1}$, is also a diagonal matrix with entries $1 / (d_i - \\lambda)$. The quadratic form $z^{\\top} (D - \\lambda I)^{-1} z$ can thus be computed as:\n$$\nz^{\\top} (D - \\lambda I)^{-1} z = \\sum_{i=1}^{n} z_i \\left(\\frac{1}{d_i - \\lambda}\\right) z_i = \\sum_{i=1}^{n} \\frac{z_i^2}{d_i - \\lambda}\n$$\nSubstituting this into the equation yields the secular equation. The secular function $f(\\lambda)$, whose zeros are the eigenvalues of $D + \\rho z z^{\\top}$ (that are not equal to any $d_i$), is given by:\n$$\nf(\\lambda) = 1 + \\rho \\sum_{i=1}^{n} \\frac{z_i^2}{d_i - \\lambda}\n$$\n\nNext, we derive the derivative $f'(\\lambda)$ from first principles. We differentiate $f(\\lambda)$ with respect to $\\lambda$ term by term:\n$$\nf'(\\lambda) = \\frac{d}{d\\lambda} \\left(1 + \\rho \\sum_{i=1}^{n} \\frac{z_i^2}{d_i - \\lambda}\\right)\n$$\nThe derivative of the constant $1$ is $0$. We can move the constant factor $\\rho$ and the summation outside the differentiation:\n$$\nf'(\\lambda) = \\rho \\sum_{i=1}^{n} z_i^2 \\frac{d}{d\\lambda} \\left(\\frac{1}{d_i - \\lambda}\\right) = \\rho \\sum_{i=1}^{n} z_i^2 \\frac{d}{d\\lambda} \\left((d_i - \\lambda)^{-1}\\right)\n$$\nUsing the chain rule, $\\frac{d}{dx} u(x)^{-1} = -u(x)^{-2} u'(x)$, with $u(\\lambda) = d_i - \\lambda$, we have $u'(\\lambda) = -1$.\n$$\n\\frac{d}{d\\lambda} \\left((d_i - \\lambda)^{-1}\\right) = -1 \\cdot (d_i - \\lambda)^{-2} \\cdot (-1) = \\frac{1}{(d_i - \\lambda)^2}\n$$\nSubstituting this back into the expression for $f'(\\lambda)$, we obtain:\n$$\nf'(\\lambda) = \\rho \\sum_{i=1}^{n} \\frac{z_i^2}{(d_i - \\lambda)^2}\n$$\n\nThe derivative $f'(\\lambda)$ plays a crucial role in both sensitivity analysis and numerical root-finding.\n\n1.  **Sensitivity Analysis**: Let $\\lambda^*$ be a simple root of the secular equation, so $f(\\lambda^*, \\rho)=0$. We can view the root as an implicit function of the parameter $\\rho$, i.e., $\\lambda^*(\\rho)$. The sensitivity of the eigenvalue $\\lambda^*$ with respect to perturbations in $\\rho$ is given by the derivative $\\frac{d\\lambda^*}{d\\rho}$. By differentiating the identity $f(\\lambda^*(\\rho), \\rho) = 0$ with respect to $\\rho$ using the multivariable chain rule, we get:\n    $$\n    \\frac{\\partial f}{\\partial \\lambda} \\frac{d\\lambda^*}{d\\rho} + \\frac{\\partial f}{\\partial \\rho} = 0 \\implies \\frac{d\\lambda^*}{d\\rho} = - \\frac{\\partial f / \\partial \\rho}{\\partial f / \\partial \\lambda}\n    $$\n    The denominator is precisely $f'(\\lambda^*)$. The numerator is $\\frac{\\partial f}{\\partial \\rho} = \\frac{\\partial}{\\partial \\rho} \\left(1 + \\rho \\sum_{i=1}^{n} \\frac{z_i^2}{d_i - \\lambda^*}\\right) = \\sum_{i=1}^{n} \\frac{z_i^2}{d_i - \\lambda^*}$. From the secular equation $f(\\lambda^*, \\rho)=0$, we have $\\rho \\sum_{i=1}^{n} \\frac{z_i^2}{d_i - \\lambda^*} = -1$, which implies $\\sum_{i=1}^{n} \\frac{z_i^2}{d_i - \\lambda^*} = -\\frac{1}{\\rho}$. Thus, $\\frac{\\partial f}{\\partial \\rho} = -\\frac{1}{\\rho}$.\n    The sensitivity is then $\\frac{d\\lambda^*}{d\\rho} = - \\frac{-1/\\rho}{f'(\\lambda^*)} = \\frac{1}{\\rho f'(\\lambda^*)}$. The derivative $f'(\\lambda^*)$ is therefore inversely proportional to the sensitivity of the eigenvalue to changes in $\\rho$.\n\n2.  **Newton's Method**: To find a root of $f(\\lambda)=0$ numerically, Newton's method is a highly efficient choice. The iterative formula is $\\lambda_{k+1} = \\lambda_k - \\frac{f(\\lambda_k)}{f'(\\lambda_k)}$. The derivative $f'(\\lambda_k)$ is the slope of the tangent to the function at $\\lambda_k$, and the next iterate $\\lambda_{k+1}$ is the point where this tangent line intersects the $\\lambda$-axis. The expression for $f'(\\lambda)$, which is inexpensive to compute ($O(n)$ operations), is essential for implementing the method. Moreover, the properties of $f'(\\lambda)$ guarantee good behavior. For any $\\lambda$ between the poles $d_j$ and $d_{j+1}$, all terms in the sum for $f'(\\lambda)$ are positive, so the sign of $f'(\\lambda)$ is the same as the sign of $\\rho$. This means $f(\\lambda)$ is strictly monotonic within each interlacing interval, which ensures that a root-finder like Newton's method can reliably converge to the unique root in that interval.\n\nFinally, we write down the closed-form analytic expression for a single Newton step. Given the current approximation $\\lambda_k$, the next approximation $\\lambda_{k+1}$ is given by the formula $\\lambda_{k+1} = \\lambda_k - \\frac{f(\\lambda_k)}{f'(\\lambda_k)}$. Substituting our derived expressions for $f(\\lambda)$ and $f'(\\lambda)$:\n$$\nf(\\lambda_k) = 1 + \\rho \\sum_{i=1}^{n} \\frac{z_i^2}{d_i - \\lambda_k}\n$$\n$$\nf'(\\lambda_k) = \\rho \\sum_{i=1}^{n} \\frac{z_i^2}{(d_i - \\lambda_k)^2}\n$$\nThe resulting expression for the Newton step is:\n$$\n\\lambda_{k+1} = \\lambda_k - \\frac{1 + \\rho \\displaystyle\\sum_{i=1}^{n} \\frac{z_i^2}{d_i - \\lambda_k}}{\\rho \\displaystyle\\sum_{i=1}^{n} \\frac{z_i^2}{(d_i - \\lambda_k)^2}}\n$$\nThis expression provides the complete update rule for refining a root of the secular equation.",
            "answer": "$$\n\\boxed{\\lambda_{k+1} = \\lambda_k - \\frac{1 + \\rho \\sum_{i=1}^{n} \\frac{z_{i}^{2}}{d_{i} - \\lambda_{k}}}{\\rho \\sum_{i=1}^{n} \\frac{z_{i}^{2}}{(d_{i} - \\lambda_{k})^{2}}}}\n$$"
        },
        {
            "introduction": "A purely theoretical algorithm is rarely sufficient for robust numerical software; practical implementations must anticipate and handle potential pitfalls. While Newton's method is fast, its performance can degrade when an iterate is close to one of the poles of the secular function. This coding exercise bridges theory and practice by asking you to implement a critical safeguard, highlighting the kind of stability considerations essential for building high-performance numerical libraries.",
            "id": "3543817",
            "problem": "You are asked to implement a decision rule used in divide-and-conquer (DC) algorithms for symmetric eigenproblems. In such algorithms, after deflation and a rank-one update to a diagonal matrix, one solves a secular equation for eigenvalues in intervals between poles. The secular equation for a diagonal matrix with a rank-one modification has the form\n$$\nf(\\lambda) = 1 + \\rho \\sum_{i=1}^{n} \\frac{w_i}{d_i - \\lambda},\n$$\nwhere $d_1  d_2  \\cdots  d_n$ are the poles (eigenvalues of the deflated diagonal block), $w_i = z_i^2 \\ge 0$ are weights derived from the rank-one data, and $\\rho  0$ is a scalar from the rank-one update. The derivative of the secular function is\n$$\nf'(\\lambda) = \\rho \\sum_{i=1}^{n} \\frac{w_i}{(d_i - \\lambda)^2}.\n$$\nWithin each open interval $(d_k, d_{k+1})$, under standard assumptions in numerical linear algebra (nonnegative weights $w_i$ and positive $\\rho$), there is a unique root of $f(\\lambda) = 0$. Newton's method update uses the step\n$$\ns_{\\text{N}} = -\\frac{f(\\lambda)}{f'(\\lambda)}.\n$$\n\nTo ensure numerical stability, modern secular solvers switch between Newton updates and rational (pole-aware) updates, depending on the magnitude of the Newton step relative to the distance to the nearest pole and the proximity to poles. Implement the following switching test:\n\n- Let $\\delta_- = \\lambda - d_k$, $\\delta_+ = d_{k+1} - \\lambda$, and $\\delta = \\min(\\delta_-, \\delta_+)$.\n- Let $g = d_{k+1} - d_k$ be the local gap.\n- Compute the Newton step $s_{\\text{N}} = -f(\\lambda)/f'(\\lambda)$.\n- With fixed constants $\\mu = 1.0$ and $\\tau = 0.1$, decide as follows:\n  - Choose the Newton update if both $|s_{\\text{N}}| \\le \\mu \\,\\delta$ and $\\delta \\ge \\tau\\, g$.\n  - Otherwise, choose the rational update.\n- As a safeguard, if $f'(\\lambda)$ is numerically too small to yield a finite $s_{\\text{N}}$ (so that $s_{\\text{N}}$ is not a finite real number), choose the rational update.\n\nYour program must implement this decision rule and evaluate it on the following test suite. Each test case specifies $(d, w, \\rho, k, \\lambda)$, where $d$ is the sorted list of poles, $w$ is the list of weights $w_i = z_i^2$, $\\rho$ is the scalar, $k$ is the interval index, and $\\lambda$ is the current iterate assumed to lie strictly within $(d_k, d_{k+1})$.\n\nTest suite:\n\n1. $d = [1.0, 3.0]$, $w = [1.0, 1.0]$, $\\rho = 1.0$, $k = 0$, $\\lambda = 1.585786437626905$.\n2. $d = [1.0, 3.0]$, $w = [1.0, 1.0]$, $\\rho = 1.0$, $k = 0$, $\\lambda = 1.000001$.\n3. $d = [1.0, 3.0]$, $w = [1.0, 1.0]$, $\\rho = 1.0$, $k = 0$, $\\lambda = 2.5$.\n4. $d = [-1.0, 1.0]$, $w = [10^{-8}, 10^{-8}]$, $\\rho = 10^{-8}$, $k = 0$, $\\lambda = 0.0$.\n5. $d = [1.0, 3.0]$, $w = [1.0, 1.0]$, $\\rho = 1.0$, $k = 0$, $\\lambda = 1.2$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. For each test case, output the integer $0$ if the decision is to use the Newton update, and the integer $1$ if the decision is to use the rational update. For example, if the decisions are Newton, Rational, Rational, Rational, Newton, the output should be\n$$\n[0,1,1,1,0].\n$$\nNo physical units or angles are involved in this problem, and no percentage outputs are required or permitted. Ensure that the mathematical computations are performed using real double-precision arithmetic.",
            "solution": "The problem requires the implementation of a decision rule used in divide-and-conquer algorithms for symmetric eigenproblems. This rule determines whether to use a standard Newton's method update or an alternative rational function update when numerically solving the secular equation. The decision is based on the behavior of the Newton step relative to the local geometry of the function's poles.\n\nThe secular equation is given by\n$$\nf(\\lambda) = 1 + \\rho \\sum_{i=1}^{n} \\frac{w_i}{d_i - \\lambda},\n$$\nwhere $d_1  d_2  \\dots  d_n$ are the poles of the function, $w_i \\ge 0$ are weights, and $\\rho  0$ is a scalar constant. The roots of $f(\\lambda)=0$ are the sought-after eigenvalues. The algorithm focuses on finding the unique root within a specific open interval $(d_k, d_{k+1})$ for some index $k$.\n\nNewton's method is an iterative root-finding algorithm that approximates the function locally with its tangent line. Starting from an estimate $\\lambda$, the next iterate is found by taking a step $s_{\\text{N}}$:\n$$\ns_{\\text{N}} = -\\frac{f(\\lambda)}{f'(\\lambda)},\n$$\nwhere $f'(\\lambda)$ is the derivative of the secular function:\n$$\nf'(\\lambda) = \\rho \\sum_{i=1}^{n} \\frac{w_i}{(d_i - \\lambda)^2}.\n$$\nThe next iterate would be $\\lambda_{\\text{new}} = \\lambda + s_{\\text{N}}$.\n\nWhile Newton's method is quadratically convergent near a simple root, it can be unreliable if the initial guess is far from the root or if the iterate is very close to a pole, where the function and its derivative can become extremely large. The implemented decision rule serves as a safeguard to ensure robust convergence.\n\nThe decision is based on the following quantities:\n- The current iterate $\\lambda$ within the interval $(d_k, d_{k+1})$.\n- The distance from $\\lambda$ to the left pole $d_k$: $\\delta_- = \\lambda - d_k$.\n- The distance from $\\lambda$ to the right pole $d_{k+1}$: $\\delta_+ = d_{k+1} - \\lambda$.\n- The smaller of these two distances: $\\delta = \\min(\\delta_-, \\delta_+)$.\n- The width of the interval, or gap: $g = d_{k+1} - d_k$.\n\nWith two pre-defined constants $\\mu=1.0$ and $\\tau=0.1$, the switching rule is as follows:\nThe Newton update is chosen if and only if both of the following conditions are met:\n1. The magnitude of the Newton step is not too large relative to the distance to the nearest pole: $|s_{\\text{N}}| \\le \\mu \\delta$.\n2. The current iterate $\\lambda$ is not too close to either pole relative to the total interval width: $\\delta \\ge \\tau g$.\n\nIf either of these conditions fails, or if the Newton step $s_{\\text{N}}$ cannot be computed as a finite number (e.g., due to division by zero if $f'(\\lambda)$ is numerically zero), the algorithm switches to a more stable rational update. The output is $0$ for a Newton update and $1$ for a rational update.\n\nLet us apply this procedure to Test Case 3: $d = [1.0, 3.0]$, $w = [1.0, 1.0]$, $\\rho = 1.0$, $k = 0$, $\\lambda = 2.5$.\n1.  **Identify Interval and Parameters:** The interval is $(d_0, d_1) = (1.0, 3.0)$. The iterate is $\\lambda = 2.5$.\n2.  **Calculate Distances:**\n    $$ \\delta_- = \\lambda - d_0 = 2.5 - 1.0 = 1.5 $$\n    $$ \\delta_+ = d_1 - \\lambda = 3.0 - 2.5 = 0.5 $$\n    $$ \\delta = \\min(1.5, 0.5) = 0.5 $$\n    $$ g = d_1 - d_0 = 3.0 - 1.0 = 2.0 $$\n3.  **Evaluate Secular Function and its Derivative:**\n    $$ f(2.5) = 1 + 1.0 \\left( \\frac{1.0}{1.0 - 2.5} + \\frac{1.0}{3.0 - 2.5} \\right) = 1 + \\frac{1}{-1.5} + \\frac{1}{0.5} = 1 - \\frac{2}{3} + 2 = \\frac{8}{3} $$\n    $$ f'(2.5) = 1.0 \\left( \\frac{1.0}{(1.0 - 2.5)^2} + \\frac{1.0}{(3.0 - 2.5)^2} \\right) = \\frac{1}{(-1.5)^2} + \\frac{1}{(0.5)^2} = \\frac{1}{2.25} + \\frac{1}{0.25} = \\frac{4}{9} + 4 = \\frac{40}{9} $$\n4.  **Compute Newton Step:**\n    $$ s_{\\text{N}} = -\\frac{f(2.5)}{f'(2.5)} = -\\frac{8/3}{40/9} = -\\frac{8}{3} \\times \\frac{9}{40} = -\\frac{3 \\times 1}{5} = -0.6 $$\n    The step is a finite number, so the safeguard is not triggered.\n5.  **Apply Decision Rule:** The constants are $\\mu=1.0$ and $\\tau=0.1$.\n    -   Condition 1: $|s_{\\text{N}}| \\le \\mu \\delta \\implies |-0.6| \\le 1.0 \\times 0.5 \\implies 0.6 \\le 0.5$. This is **false**.\n    -   Since the first condition is false, there is no need to check the second. The overall condition for the Newton update is not met.\n\nTherefore, the decision is to use the rational update, which corresponds to an output of $1$. This process is systematically applied to all test cases to generate the final output.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nimport math\n\ndef solve():\n    \"\"\"\n    Implements the decision rule for switching between Newton and rational updates\n    in a divide-and-conquer symmetric eigenproblem solver.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (d, w, rho, k, lambda)\n        ([1.0, 3.0], [1.0, 1.0], 1.0, 0, 1.585786437626905),\n        ([1.0, 3.0], [1.0, 1.0], 1.0, 0, 1.000001),\n        ([1.0, 3.0], [1.0, 1.0], 1.0, 0, 2.5),\n        ([-1.0, 1.0], [1e-8, 1e-8], 1e-8, 0, 0.0),\n        ([1.0, 3.0], [1.0, 1.0], 1.0, 0, 1.2),\n    ]\n\n    results = []\n    mu = 1.0\n    tau = 0.1\n    \n    for case in test_cases:\n        d_list, w_list, rho, k, lam = case\n        d = np.array(d_list, dtype=float)\n        w = np.array(w_list, dtype=float)\n\n        d_k = d[k]\n        d_k_plus_1 = d[k+1]\n\n        # Calculate distances for the decision rule\n        delta_minus = lam - d_k\n        delta_plus = d_k_plus_1 - lam\n        delta = min(delta_minus, delta_plus)\n        g = d_k_plus_1 - d_k\n\n        # Calculate the secular function f(lambda) and its derivative f'(lambda)\n        d_minus_lam = d - lam\n        # The sum is over all poles i=0...n-1 (or 1...n in math notation)\n        f_val = 1.0 + rho * np.sum(w / d_minus_lam)\n        f_prime = rho * np.sum(w / (d_minus_lam**2))\n\n        # Calculate Newton step s_N\n        # A division by zero in numpy results in inf or -inf, which math.isfinite detects.\n        # A 0/0 division results in nan, also detected.\n        if f_prime == 0.0:\n            s_N = float('inf') if f_val != 0 else float('nan')\n        else:\n            s_N = -f_val / f_prime\n\n        # Safeguard: if s_N is not a finite real number, choose the rational update.\n        if not math.isfinite(s_N):\n            results.append(1)\n            continue\n\n        # Main decision rule\n        # Condition 1: Newton step is small enough.\n        cond1 = abs(s_N) = mu * delta\n        # Condition 2: Iterate is not too close to a pole.\n        cond2 = delta >= tau * g\n\n        if cond1 and cond2:\n            results.append(0) # Choose Newton update\n        else:\n            results.append(1) # Choose rational update\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}