{
    "hands_on_practices": [
        {
            "introduction": "The power of the divide-and-conquer strategy for symmetric eigenproblems lies in its \"conquer\" or \"merge\" phase, where the eigensystem of a diagonal-plus-rank-one matrix $D + \\rho z z^{\\top}$ must be found efficiently. This problem is transformed into finding the roots of a special rational function, the secular function $f(\\lambda)$. This foundational exercise  guides you through the derivation of $f(\\lambda)$ and its derivative $f'(\\lambda)$, tools that are indispensable for analyzing the problem structure and for building fast and reliable numerical solvers like Newton's method.",
            "id": "3543876",
            "problem": "Consider a symmetric eigenproblem that appears in the divide-and-conquer approach for symmetric tridiagonal matrices, where one solves eigenvalues of a rank-one modification of a diagonal matrix. Let $D \\in \\mathbb{R}^{n \\times n}$ be a diagonal matrix with distinct diagonal entries $d_{1} < d_{2} < \\cdots < d_{n}$, let $z \\in \\mathbb{R}^{n}$ be a nonzero vector, and let $\\rho \\in \\mathbb{R} \\setminus \\{0\\}$. The updated matrix is $D + \\rho z z^{\\top}$. The eigenvalues $\\lambda$ of $D + \\rho z z^{\\top}$ are precisely the roots of a secular equation that can be obtained from the Matrix Determinant Lemma, which states that for any invertible matrix $A \\in \\mathbb{R}^{n \\times n}$ and vectors $u, v \\in \\mathbb{R}^{n}$, one has $\\det(A + u v^{\\top}) = \\det(A)\\left(1 + v^{\\top} A^{-1} u\\right)$. Use this fundamental identity, with $A = D - \\lambda I$, to derive the scalar secular function $f(\\lambda)$ whose zeros are the eigenvalues of $D + \\rho z z^{\\top}$. From first principles, derive the expression for the derivative $f'(\\lambda)$ without invoking any pre-remembered shortcut formulas. Then, explain how $f'(\\lambda)$ enters both a sensitivity estimate of a simple root $\\lambda^{\\ast}$ with respect to perturbations in $\\rho$ and the construction of an efficient Newton iteration to refine a root located in an interlacing interval $(d_{j}, d_{j+1})$. As your final task, write down the closed-form analytic expression for a single Newton step $\\lambda_{k+1}$ in terms of $\\lambda_{k}$, $\\{d_{i}\\}_{i=1}^{n}$, $\\{z_{i}\\}_{i=1}^{n}$, and $\\rho$ when applying Newton’s method to the secular equation $f(\\lambda) = 0$. The final answer should be the analytic expression for $\\lambda_{k+1}$ (no numeric evaluation is required).",
            "solution": "The problem as stated is scientifically grounded, well-posed, objective, and internally consistent. It poses a standard, non-trivial task from the field of numerical linear algebra, specifically concerning the divide-and-conquer algorithm for symmetric eigenproblems. All necessary information is provided, and the terminology is precise. Therefore, the problem is valid, and a full solution can be derived.\n\nThe eigenvalues $\\lambda$ of the matrix $D + \\rho z z^{\\top}$ are the scalars for which the matrix $D + \\rho z z^{\\top} - \\lambda I$ is singular. This is equivalent to its determinant being zero:\n$$\n\\det\\left(D + \\rho z z^{\\top} - \\lambda I\\right) = 0\n$$\nWe can rearrange the expression inside the determinant to match the form required by the Matrix Determinant Lemma:\n$$\n\\det\\left((D - \\lambda I) + (\\rho z) z^{\\top}\\right) = 0\n$$\nThe Matrix Determinant Lemma states that for an invertible matrix $A$ and vectors $u, v$, we have $\\det(A + u v^{\\top}) = \\det(A)(1 + v^{\\top} A^{-1} u)$. We identify $A = D - \\lambda I$, $u = \\rho z$, and $v = z$. For the lemma to be applicable, $A = D - \\lambda I$ must be invertible, which means $\\lambda$ cannot be one of the diagonal entries $d_i$ of $D$. If we assume $\\lambda \\notin \\{d_1, \\dots, d_n\\}$, we can apply the lemma:\n$$\n\\det(D - \\lambda I) \\left(1 + z^{\\top} (D - \\lambda I)^{-1} (\\rho z)\\right) = 0\n$$\nSince we assumed $\\lambda \\neq d_i$ for all $i$, the first term $\\det(D - \\lambda I) = \\prod_{i=1}^{n} (d_i - \\lambda)$ is non-zero. Therefore, the eigenvalues must be the roots of the second factor:\n$$\n1 + z^{\\top} (D - \\lambda I)^{-1} (\\rho z) = 0\n$$\nSince $\\rho$ is a scalar, this can be written as:\n$$\n1 + \\rho z^{\\top} (D - \\lambda I)^{-1} z = 0\n$$\nThe matrix $D - \\lambda I$ is a diagonal matrix with diagonal entries $(d_i - \\lambda)$. Its inverse, $(D - \\lambda I)^{-1}$, is also a diagonal matrix with entries $1 / (d_i - \\lambda)$. The quadratic form $z^{\\top} (D - \\lambda I)^{-1} z$ can thus be computed as:\n$$\nz^{\\top} (D - \\lambda I)^{-1} z = \\sum_{i=1}^{n} z_i \\left(\\frac{1}{d_i - \\lambda}\\right) z_i = \\sum_{i=1}^{n} \\frac{z_i^2}{d_i - \\lambda}\n$$\nSubstituting this into the equation yields the secular equation. The secular function $f(\\lambda)$, whose zeros are the eigenvalues of $D + \\rho z z^{\\top}$ (that are not equal to any $d_i$), is given by:\n$$\nf(\\lambda) = 1 + \\rho \\sum_{i=1}^{n} \\frac{z_i^2}{d_i - \\lambda}\n$$\n\nNext, we derive the derivative $f'(\\lambda)$ from first principles. We differentiate $f(\\lambda)$ with respect to $\\lambda$ term by term:\n$$\nf'(\\lambda) = \\frac{d}{d\\lambda} \\left(1 + \\rho \\sum_{i=1}^{n} \\frac{z_i^2}{d_i - \\lambda}\\right)\n$$\nThe derivative of the constant $1$ is $0$. We can move the constant factor $\\rho$ and the summation outside the differentiation:\n$$\nf'(\\lambda) = \\rho \\sum_{i=1}^{n} z_i^2 \\frac{d}{d\\lambda} \\left(\\frac{1}{d_i - \\lambda}\\right) = \\rho \\sum_{i=1}^{n} z_i^2 \\frac{d}{d\\lambda} \\left((d_i - \\lambda)^{-1}\\right)\n$$\nUsing the chain rule, $\\frac{d}{dx} u(x)^{-1} = -u(x)^{-2} u'(x)$, with $u(\\lambda) = d_i - \\lambda$, we have $u'(\\lambda) = -1$.\n$$\n\\frac{d}{d\\lambda} \\left((d_i - \\lambda)^{-1}\\right) = -1 \\cdot (d_i - \\lambda)^{-2} \\cdot (-1) = \\frac{1}{(d_i - \\lambda)^2}\n$$\nSubstituting this back into the expression for $f'(\\lambda)$, we obtain:\n$$\nf'(\\lambda) = \\rho \\sum_{i=1}^{n} \\frac{z_i^2}{(d_i - \\lambda)^2}\n$$\n\nThe derivative $f'(\\lambda)$ plays a crucial role in both sensitivity analysis and numerical root-finding.\n\n1.  **Sensitivity Analysis**: Let $\\lambda^*$ be a simple root of the secular equation, so $f(\\lambda^*, \\rho)=0$. We can view the root as an implicit function of the parameter $\\rho$, i.e., $\\lambda^*(\\rho)$. The sensitivity of the eigenvalue $\\lambda^*$ with respect to perturbations in $\\rho$ is given by the derivative $\\frac{d\\lambda^*}{d\\rho}$. By differentiating the identity $f(\\lambda^*(\\rho), \\rho) = 0$ with respect to $\\rho$ using the multivariable chain rule, we get:\n    $$\n    \\frac{\\partial f}{\\partial \\lambda} \\frac{d\\lambda^*}{d\\rho} + \\frac{\\partial f}{\\partial \\rho} = 0 \\implies \\frac{d\\lambda^*}{d\\rho} = - \\frac{\\partial f / \\partial \\rho}{\\partial f / \\partial \\lambda}\n    $$\n    The denominator is precisely $f'(\\lambda^*)$. The numerator is $\\frac{\\partial f}{\\partial \\rho} = \\frac{\\partial}{\\partial \\rho} \\left(1 + \\rho \\sum_{i=1}^{n} \\frac{z_i^2}{d_i - \\lambda^*}\\right) = \\sum_{i=1}^{n} \\frac{z_i^2}{d_i - \\lambda^*}$. From the secular equation $f(\\lambda^*, \\rho)=0$, we have $\\rho \\sum_{i=1}^{n} \\frac{z_i^2}{d_i - \\lambda^*} = -1$, which implies $\\sum_{i=1}^{n} \\frac{z_i^2}{d_i - \\lambda^*} = -\\frac{1}{\\rho}$. Thus, $\\frac{\\partial f}{\\partial \\rho} = -\\frac{1}{\\rho}$.\n    The sensitivity is then $\\frac{d\\lambda^*}{d\\rho} = - \\frac{-1/\\rho}{f'(\\lambda^*)} = \\frac{1}{\\rho f'(\\lambda^*)}$. The derivative $f'(\\lambda^*)$ is therefore inversely proportional to the sensitivity of the eigenvalue to changes in $\\rho$.\n\n2.  **Newton's Method**: To find a root of $f(\\lambda)=0$ numerically, Newton's method is a highly efficient choice. The iterative formula is $\\lambda_{k+1} = \\lambda_k - \\frac{f(\\lambda_k)}{f'(\\lambda_k)}$. The derivative $f'(\\lambda_k)$ is the slope of the tangent to the function at $\\lambda_k$, and the next iterate $\\lambda_{k+1}$ is the point where this tangent line intersects the $\\lambda$-axis. The expression for $f'(\\lambda)$, which is inexpensive to compute ($O(n)$ operations), is essential for implementing the method. Moreover, the properties of $f'(\\lambda)$ guarantee good behavior. For any $\\lambda$ between the poles $d_j$ and $d_{j+1}$, all terms in the sum for $f'(\\lambda)$ are positive, so the sign of $f'(\\lambda)$ is the same as the sign of $\\rho$. This means $f(\\lambda)$ is strictly monotonic within each interlacing interval, which ensures that a root-finder like Newton's method can reliably converge to the unique root in that interval.\n\nFinally, we write down the closed-form analytic expression for a single Newton step. Given the current approximation $\\lambda_k$, the next approximation $\\lambda_{k+1}$ is given by the formula $\\lambda_{k+1} = \\lambda_k - \\frac{f(\\lambda_k)}{f'(\\lambda_k)}$. Substituting our derived expressions for $f(\\lambda)$ and $f'(\\lambda)$:\n$$\nf(\\lambda_k) = 1 + \\rho \\sum_{i=1}^{n} \\frac{z_i^2}{d_i - \\lambda_k}\n$$\n$$\nf'(\\lambda_k) = \\rho \\sum_{i=1}^{n} \\frac{z_i^2}{(d_i - \\lambda_k)^2}\n$$\nThe resulting expression for the Newton step is:\n$$\n\\lambda_{k+1} = \\lambda_k - \\frac{1 + \\rho \\displaystyle\\sum_{i=1}^{n} \\frac{z_i^2}{d_i - \\lambda_k}}{\\rho \\displaystyle\\sum_{i=1}^{n} \\frac{z_i^2}{(d_i - \\lambda_k)^2}}\n$$\nThis expression provides the complete update rule for refining a root of the secular equation.",
            "answer": "$$\n\\boxed{\\lambda_{k+1} = \\lambda_k - \\frac{1 + \\rho \\sum_{i=1}^{n} \\frac{z_{i}^{2}}{d_{i} - \\lambda_{k}}}{\\rho \\sum_{i=1}^{n} \\frac{z_{i}^{2}}{(d_{i} - \\lambda_{k})^{2}}}}\n$$"
        },
        {
            "introduction": "After deriving the abstract form of the secular equation, it is crucial to see the theory in action on a tangible example. This practice  provides a concrete, small-scale merge step where the exact eigenpairs can be computed and verified. By manually performing the analysis—from setting up the secular equation to calculating the new eigenvalues and eigenvectors—you will build crucial intuition for how the rank-one update perturbs the spectrum and how the components of the vector $z$ control which eigenpairs are affected.",
            "id": "3543882",
            "problem": "Consider the symmetric tridiagonal matrix constructed as a single merge in a divide-and-conquer (D&C) step after complete diagonalization of two subproblems. Let the subproblem eigen-decompositions already be the identity, so that the diagonal in the merged basis is\n$$\nD \\;=\\; \\operatorname{diag}\\!\\big(d_1, d_2, d_3, d_4\\big)\n\\;=\\;\n\\operatorname{diag}\\!\\big(-1,\\,1,\\,3,\\,5\\big),\n$$\nand the rank-one coupling is specified by\n$$\n\\rho \\;=\\; 1, \n\\qquad\nz \\;=\\; e_2 + e_3,\n$$\nwhere $e_k$ denotes the $k$-th standard basis vector in $\\mathbb{R}^{4}$. The merged matrix in the diagonal basis is\n$$\n\\widehat{T} \\;=\\; D + \\rho\\, z z^{\\top}\n\\;=\\;\n\\begin{pmatrix}\n-1 & 0 & 0 & 0\\\\\n0 & 2 & 1 & 0\\\\\n0 & 1 & 4 & 0\\\\\n0 & 0 & 0 & 5\n\\end{pmatrix}.\n$$\nNote that, expressed in the original standard basis (here identical to the merged basis because the subproblems were diagonal), $\\widehat{T}$ is tridiagonal. Its exact eigenpairs can be obtained by inspection of the $2\\times 2$ interior block and the unaffected outer diagonal entries.\n\nStarting only from core linear algebraic principles appropriate for numerical linear algebra, namely:\n- the Matrix Determinant Lemma,\n- the definition of eigenpairs, and\n- the fact that the eigenvectors of a diagonal-plus-rank-one matrix corresponding to a secular root $\\sigma$ are proportional to $(D-\\sigma I)^{-1}z$,\n\nperform the D&C merge analysis in the diagonal basis as follows.\n1. Derive the secular equation by applying the Matrix Determinant Lemma to $\\det(\\widehat{T}-\\sigma I)$ and reduce it to a scalar rational equation in $\\sigma$.\n2. Solve this scalar equation exactly to obtain the two nontrivial secular roots.\n3. For the larger of these two secular roots, construct the corresponding eigenvector in the diagonal basis, normalize it to unit $2$-norm, and verify that it has support only on the second and third coordinates.\n4. Explain why $d_1$ and $d_4$ remain eigenvalues with eigenvectors $e_1$ and $e_4$ in this merge.\n\nWhat is the larger of the two secular roots? Express your final answer in exact form. No rounding is required and no units are involved.",
            "solution": "The problem requires an analysis of a single step in the divide-and-conquer algorithm for finding eigenvalues of a symmetric matrix. The matrix in question is of the form $\\widehat{T} = D + \\rho z z^{\\top}$, a diagonal-plus-rank-one (DPR1) matrix. The given parameters are the diagonal matrix $D = \\operatorname{diag}(-1, 1, 3, 5)$, the scalar $\\rho = 1$, and the vector $z = e_2 + e_3 = [0, 1, 1, 0]^{\\top}$.\n\n1. Derivation of the secular equation.\nThe eigenvalues $\\sigma$ of $\\widehat{T}$ are the roots of the characteristic equation $\\det(\\widehat{T} - \\sigma I) = 0$. Substituting the definition of $\\widehat{T}$, we have:\n$$\n\\det(D + \\rho z z^{\\top} - \\sigma I) = \\det((D - \\sigma I) + (\\rho z) z^{\\top}) = 0\n$$\nWe apply the Matrix Determinant Lemma, which states that for an invertible matrix $A$ and vectors $u, v$, $\\det(A + uv^{\\top}) = (1 + v^{\\top}A^{-1}u)\\det(A)$. Let $A = D - \\sigma I$, $u = \\rho z$, and $v = z$. This is applicable for any $\\sigma$ that is not an eigenvalue of $D$, ensuring $A$ is invertible. The characteristic equation becomes:\n$$\n(1 + \\rho z^{\\top}(D - \\sigma I)^{-1}z) \\det(D - \\sigma I) = 0\n$$\nThe eigenvalues of $\\widehat{T}$ are therefore the values of $\\sigma$ for which either $\\det(D - \\sigma I) = 0$ or $1 + \\rho z^{\\top}(D - \\sigma I)^{-1}z = 0$.\nThe term $\\det(D - \\sigma I) = \\prod_{i=1}^4 (d_i - \\sigma)$ is zero when $\\sigma$ is an eigenvalue of $D$. The second term gives rise to the secular equation.\nThe matrix $(D - \\sigma I)^{-1}$ is a diagonal matrix with entries $\\frac{1}{d_i - \\sigma}$. The term $z^{\\top}(D - \\sigma I)^{-1}z$ is a scalar given by:\n$$\nz^{\\top}(D - \\sigma I)^{-1}z = \\sum_{i=1}^4 \\frac{z_i^2}{d_i - \\sigma}\n$$\nGiven $z = [0, 1, 1, 0]^{\\top}$, we have $z_1=0$, $z_2=1$, $z_3=1$, $z_4=0$. The summation simplifies to:\n$$\n\\sum_{i=1}^4 \\frac{z_i^2}{d_i - \\sigma} = \\frac{0^2}{d_1 - \\sigma} + \\frac{1^2}{d_2 - \\sigma} + \\frac{1^2}{d_3 - \\sigma} + \\frac{0^2}{d_4 - \\sigma} = \\frac{1}{d_2 - \\sigma} + \\frac{1}{d_3 - \\sigma}\n$$\nWith the given values $d_2 = 1$, $d_3 = 3$, and $\\rho=1$, the secular equation $1 + \\rho z^{\\top}(D - \\sigma I)^{-1}z = 0$ becomes:\n$$\nf(\\sigma) = 1 + \\frac{1}{1 - \\sigma} + \\frac{1}{3 - \\sigma} = 0\n$$\nThis is the required scalar rational equation in $\\sigma$. The roots of this equation are the eigenvalues of $\\widehat{T}$ that are not eigenvalues of $D$.\n\n2. Solving the secular equation.\nTo solve for $\\sigma$, we clear the denominators by multiplying by $(1-\\sigma)(3-\\sigma)$, assuming $\\sigma \\neq 1$ and $\\sigma \\neq 3$:\n$$\n(1 - \\sigma)(3 - \\sigma) + (3 - \\sigma) + (1 - \\sigma) = 0\n$$\nExpanding the terms:\n$$\n(3 - \\sigma - 3\\sigma + \\sigma^2) + (3 - \\sigma) + (1 - \\sigma) = 0\n$$\n$$\n(\\sigma^2 - 4\\sigma + 3) + (4 - 2\\sigma) = 0\n$$\n$$\n\\sigma^2 - 6\\sigma + 7 = 0\n$$\nThis is a quadratic equation for $\\sigma$. We use the quadratic formula $\\sigma = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$:\n$$\n\\sigma = \\frac{-(-6) \\pm \\sqrt{(-6)^2 - 4(1)(7)}}{2(1)} = \\frac{6 \\pm \\sqrt{36 - 28}}{2} = \\frac{6 \\pm \\sqrt{8}}{2}\n$$\nSimplifying the square root, $\\sqrt{8} = \\sqrt{4 \\cdot 2} = 2\\sqrt{2}$.\n$$\n\\sigma = \\frac{6 \\pm 2\\sqrt{2}}{2} = 3 \\pm \\sqrt{2}\n$$\nThe two nontrivial secular roots are $\\sigma_1 = 3 - \\sqrt{2}$ and $\\sigma_2 = 3 + \\sqrt{2}$.\n\n3. Eigenvector for the larger secular root.\nThe larger root is $\\sigma = 3 + \\sqrt{2}$. The corresponding eigenvector $v$ is proportional to $(D - \\sigma I)^{-1}z$. The components $v_i$ of the eigenvector are given by $v_i \\propto \\frac{z_i}{d_i - \\sigma}$.\nFor $i=1$ and $i=4$, $z_1=0$ and $z_4=0$, so $v_1=0$ and $v_4=0$. This confirms the eigenvector has support only on the second and third coordinates.\nFor $i=2$:\n$$\nv_2 \\propto \\frac{z_2}{d_2 - \\sigma} = \\frac{1}{1 - (3 + \\sqrt{2})} = \\frac{1}{-2 - \\sqrt{2}}\n$$\nFor $i=3$:\n$$\nv_3 \\propto \\frac{z_3}{d_3 - \\sigma} = \\frac{1}{3 - (3 + \\sqrt{2})} = \\frac{1}{-\\sqrt{2}}\n$$\nAn unnormalized eigenvector is $v' = \\begin{pmatrix} 0 & \\frac{1}{-2-\\sqrt{2}} & \\frac{1}{-\\sqrt{2}} & 0 \\end{pmatrix}^{\\top}$.\nTo normalize this vector, we compute its squared $2$-norm:\n$$\n\\|v'\\|_2^2 = \\left(\\frac{1}{-2-\\sqrt{2}}\\right)^2 + \\left(\\frac{1}{-\\sqrt{2}}\\right)^2 = \\frac{1}{(2+\\sqrt{2})^2} + \\frac{1}{2} = \\frac{1}{4+4\\sqrt{2}+2} + \\frac{1}{2} = \\frac{1}{6+4\\sqrt{2}} + \\frac{1}{2}\n$$\nWe rationalize the first term:\n$$\n\\frac{1}{6+4\\sqrt{2}} = \\frac{1}{6+4\\sqrt{2}} \\cdot \\frac{6-4\\sqrt{2}}{6-4\\sqrt{2}} = \\frac{6-4\\sqrt{2}}{36 - 16(2)} = \\frac{6-4\\sqrt{2}}{36-32} = \\frac{6-4\\sqrt{2}}{4} = \\frac{3-2\\sqrt{2}}{2}\n$$\nNow, substitute back into the norm calculation:\n$$\n\\|v'\\|_2^2 = \\frac{3-2\\sqrt{2}}{2} + \\frac{1}{2} = \\frac{4-2\\sqrt{2}}{2} = 2-\\sqrt{2}\n$$\nThe norm is $\\|v'\\|_2 = \\sqrt{2-\\sqrt{2}}$. The normalized eigenvector $v$ is therefore:\n$$\nv = \\frac{1}{\\sqrt{2-\\sqrt{2}}} \\begin{pmatrix} 0 \\\\ \\frac{1}{-2-\\sqrt{2}} \\\\ \\frac{1}{-\\sqrt{2}} \\\\ 0 \\end{pmatrix}\n$$\n\n4. Unaffected eigenvalues and eigenvectors.\nWe must explain why $d_1 = -1$ and $d_4 = 5$ remain eigenvalues of $\\widehat{T}$, with eigenvectors $e_1$ and $e_4$ respectively.\nConsider the eigenvector equation $\\widehat{T}x = \\lambda x$. Let's test the pair $(\\lambda, x) = (d_1, e_1)$.\n$$\n\\widehat{T}e_1 = (D + \\rho z z^{\\top})e_1 = D e_1 + \\rho z (z^{\\top}e_1)\n$$\nBy definition, $D e_1 = d_1 e_1$. The term $z^{\\top}e_1$ is the dot product of $z=[0,1,1,0]^{\\top}$ and $e_1=[1,0,0,0]^{\\top}$, which is $0 \\cdot 1 + 1 \\cdot 0 + 1 \\cdot 0 + 0 \\cdot 0 = 0$.\nThus, the equation simplifies to:\n$$\n\\widehat{T}e_1 = d_1 e_1 + \\rho z(0) = d_1 e_1\n$$\nThis shows that $e_1$ is an eigenvector of $\\widehat{T}$ with eigenvalue $d_1 = -1$.\nSimilarly, for the pair $(\\lambda, x) = (d_4, e_4)$:\n$$\n\\widehat{T}e_4 = (D + \\rho z z^{\\top})e_4 = D e_4 + \\rho z (z^{\\top}e_4)\n$$\n$D e_4 = d_4 e_4$. The term $z^{\\top}e_4$ is the dot product of $z=[0,1,1,0]^{\\top}$ and $e_4=[0,0,0,1]^{\\top}$, which is $0$.\nThus, the equation becomes:\n$$\n\\widehat{T}e_4 = d_4 e_4 + \\rho z(0) = d_4 e_4\n$$\nThis shows that $e_4$ is an eigenvector of $\\widehat{T}$ with eigenvalue $d_4 = 5$.\nIn general, an eigenvector $e_i$ of $D$ remains an eigenvector of the updated matrix $\\widehat{T}=D+\\rho z z^{\\top}$ if $e_i$ is orthogonal to the update vector $z$. This is equivalent to the $i$-th component of $z$, $z_i$, being zero. In this problem, $z_1=0$ and $z_4=0$, so the eigenpairs $(d_1, e_1)$ and $(d_4, e_4)$ are unaffected by the rank-one update.\n\nThe larger of the two nontrivial secular roots, $3-\\sqrt{2}$ and $3+\\sqrt{2}$, is $3+\\sqrt{2}$.",
            "answer": "$$\\boxed{3 + \\sqrt{2}}$$"
        },
        {
            "introduction": "A robust numerical algorithm must gracefully handle situations that are often glossed over in introductory derivations. In the context of the secular equation, a common challenge arises when the diagonal matrix $D$ has repeated entries, leading to repeated poles in the function $f(\\lambda)$ and potential numerical infinities. This problem  addresses this critical implementation detail, introducing the concept of deflation as a stable and efficient method to resolve the degeneracy, thereby ensuring the stability of the overall divide-and-conquer algorithm.",
            "id": "3543892",
            "problem": "In the divide-and-conquer algorithm for symmetric eigenproblems, a symmetric tridiagonal matrix is orthogonally reduced and partitioned so that a subproblem appears in the form of a diagonal-plus-rank-one matrix $D + \\rho z z^{\\top}$, where $D = \\mathrm{diag}(d_1,\\dots,d_n)$, $\\rho \\in \\mathbb{R}$, and $z \\in \\mathbb{R}^n$. The eigenvalues are recovered by solving the associated secular subproblem, which is known to have rational structure with poles at the entries of $D$. Consider the situation where there is an index set $I = \\{i_1,\\dots,i_m\\}$ with $m \\ge 2$ such that $d_{i_1} = \\cdots = d_{i_m} = \\delta$, i.e., the diagonal matrix $D$ has an $m$-dimensional degenerate eigenspace at the value $\\delta$. This degeneracy manifests as repeated poles in the rational structure of the secular subproblem and can cause numerical instabilities if treated naively.\n\nWhich of the following procedures is robust, in the sense that it avoids forming infinities in the secular evaluation, preserves numerical orthogonality, and yields stable eigenpairs consistent with the divide-and-conquer framework?\n\nA. Group the indices in $I$, construct an orthonormal basis $Q \\in \\mathbb{R}^{m \\times m}$ for the subspace $\\mathcal{S} = \\mathrm{span}\\{e_{i_k} : k = 1,\\dots,m\\}$ such that $Q^{\\top} z_I = [\\alpha, 0, \\dots, 0]^{\\top}$ with $\\alpha = \\|z_I\\|_2$ and $z_I \\in \\mathbb{R}^m$ the restriction of $z$ to $I$, and replace the contribution of the degenerate block by $\\delta I_m + \\rho \\tilde{z}_I \\tilde{z}_I^{\\top}$ with $\\tilde{z}_I = [\\alpha, 0, \\dots, 0]^{\\top}$. This yields a single effective pole at $\\delta$ with aggregate weight $\\alpha^2$, deflates the $m-1$ zero-weight directions, and evaluates the secular subproblem stably; eigenvectors are back-rotated by $Q$.\n\nB. Add independent perturbations of size $\\mathcal{O}(\\epsilon)$ to split the equal entries of $D$ so that $d_{i_k}$ become distinct, solve the standard secular problem with distinct poles, and then set the perturbations back to zero at the end to retrieve the original values.\n\nC. Leave the repeated entries unchanged and evaluate the rational secular structure directly with repeated denominators, using formal limiting arguments such as L’Hospital’s rule to cancel infinities at $\\lambda = \\delta$.\n\nD. Merge the repeated poles by replacing each denominator $(\\delta - \\lambda)$ in the contributions from $I$ by $m(\\delta - \\lambda)$, thereby scaling the combined term to $\\rho \\sum_{k=1}^m z_{i_k}^2 / \\big(m(\\delta - \\lambda)\\big)$ without altering the basis on $\\mathcal{S}$.",
            "solution": "The problem addresses how to handle degenerate poles in the secular equation $f(\\lambda) = 1 + \\rho \\sum_{i=1}^n \\frac{z_i^2}{d_i - \\lambda} = 0$. If a subset of diagonal entries are equal, e.g., $d_{i_1} = \\cdots = d_{i_m} = \\delta$, the function has multiple poles at $\\lambda = \\delta$, leading to numerical difficulties. A robust procedure must resolve this degeneracy algebraically before numerical evaluation. Let's analyze the options:\n\n**A. Deflation via orthogonal transformation:** This is the standard, numerically robust technique. The subproblem on the degenerate subspace spanned by $\\{e_{i_1}, \\dots, e_{i_m}\\}$ is an $m \\times m$ matrix of the form $\\delta I_m + \\rho z_I z_I^{\\top}$, where $z_I$ is the restriction of $z$ to these indices. We can find an orthogonal matrix $Q$ (e.g., a Householder reflector) that rotates $z_I$ to align with the first basis vector: $Q^{\\top}z_I = [\\alpha, 0, \\dots, 0]^{\\top}$, where $\\alpha = \\|z_I\\|_2$. Applying this transformation, the subproblem becomes:\n$$\nQ^{\\top}(\\delta I_m + \\rho z_I z_I^{\\top})Q = \\delta Q^{\\top}I_m Q + \\rho (Q^{\\top}z_I)(Q^{\\top}z_I)^{\\top} = \\delta I_m + \\rho \\begin{pmatrix} \\alpha^2 & 0 & \\dots \\\\ 0 & 0 & \\dots \\\\ \\vdots & \\vdots & \\ddots \\end{pmatrix}\n$$\nIn this new basis, $m-1$ eigenpairs are immediately \"deflated\": they are the standard basis vectors corresponding to the zero entries in the transformed update vector, with eigenvalue $\\delta$. The only non-trivial part is a $1 \\times 1$ problem involving the first basis vector, which corresponds to a single term $\\frac{\\rho \\alpha^2}{\\delta - \\lambda}$ in the secular equation. This procedure avoids infinities, is perfectly stable due to the orthogonal transformation, and correctly identifies the invariant subspace. The eigenvectors are finally transformed back using $Q$. This is the correct approach.\n\n**B. Perturbation:** Adding small perturbations to split the poles, solving the now non-degenerate problem, and then removing the perturbations is numerically unsound. The eigenvectors of the perturbed problem can be very different from those of the original problem, especially if the corresponding components of $z$ are small. As the perturbation goes to zero, the computed eigenvectors may not converge to the correct subspace, leading to loss of orthogonality. This approach is unstable.\n\n**C. L'Hopital's Rule:** While theoretically possible to handle the limit as $\\lambda \\to \\delta$, this is computationally complex and prone to floating-point errors. It requires evaluating higher-order derivatives or using symbolic manipulation, which is antithetical to a fast numerical algorithm. It is not a practical or robust numerical method.\n\n**D. Ad-hoc Merging:** Simply summing the numerators and multiplying the denominator by $m$ is an incorrect modification. It does not correspond to any valid algebraic simplification of the eigenproblem. The correct approach must account for the vector nature of the update $z_I$, not just the scalar values of the numerators. This method would produce incorrect eigenvalues and eigenvectors.\n\nTherefore, option A describes the correct and standard deflation procedure for handling repeated poles in the divide-and-conquer algorithm.",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}