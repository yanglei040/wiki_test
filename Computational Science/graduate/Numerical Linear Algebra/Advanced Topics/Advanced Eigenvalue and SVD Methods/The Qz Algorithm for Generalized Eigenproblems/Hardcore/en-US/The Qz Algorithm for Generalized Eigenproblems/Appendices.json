{
    "hands_on_practices": [
        {
            "introduction": "The implicit QZ algorithm is often described as a \"bulge chasing\" procedure, which can seem abstract. This practice provides a concrete opportunity to see this mechanism in action on a small, illustrative example. By manually performing one sweep of the algorithm, you will gain a hands-on understanding of how Givens rotations are used to introduce and then systematically chase a \"bulge\" down the diagonal, all while maintaining the crucial Hessenberg-triangular structure of the matrix pair .",
            "id": "3594787",
            "problem": "Consider the generalized eigenproblem for a real pair of matrices $(A,B)$, where $A \\in \\mathbb{R}^{5 \\times 5}$ is upper Hessenberg and $B \\in \\mathbb{R}^{5 \\times 5}$ is upper triangular. A single implicit-shift step of the generalized Schur (QZ) algorithm applies a sequence of orthogonal plane rotations to $(A,B)$ so that, after the step, $(A,B)$ is again an upper Hessenberg–triangular pair with the chase of the initially introduced bulge completed. A Givens rotation is a $2 \\times 2$ orthogonal matrix of the form\n$$G(c,s) = \\begin{pmatrix} c & s \\\\ -s & c \\end{pmatrix},$$\nwith $c^2+s^2=1$, used to act on consecutive rows (from the left) or on consecutive columns (from the right). In a single-shift QZ sweep, one chooses the shift $\\mu$ from the trailing $1 \\times 1$ block as $\\mu = a_{55}/b_{55}$, introduces a bulge at the top via a left rotation based on the first two entries of the vector $(A - \\mu B)e_{1}$, restores upper triangularity of $B$ via a right rotation, and then chases the bulge down with alternating left and right Givens rotations on successive $2 \\times 2$ row/column windows.\n\nLet\n$$\nA =\n\\begin{pmatrix}\n4 & 2 & 0 & 0 & 0 \\\\\n1 & 5 & 3 & 0 & 0 \\\\\n0 & 0 & 6 & 0 & 0 \\\\\n0 & 0 & 0 & 7 & 5 \\\\\n0 & 0 & 0 & 0 & 8\n\\end{pmatrix},\n\\qquad\nB =\n\\begin{pmatrix}\n2 & 0 & 0 & 0 & 0 \\\\\n0 & 3 & 0 & 0 & 0 \\\\\n0 & 0 & 4 & 0 & 0 \\\\\n0 & 0 & 0 & 5 & 0 \\\\\n0 & 0 & 0 & 0 & 6\n\\end{pmatrix}.\n$$\nPerform one implicit single-shift QZ sweep with the shift $\\mu = a_{55}/b_{55}$. Use the following fundamental definitions and facts:\n\n- The generalized eigenproblem seeks $\\lambda \\in \\mathbb{R}$ and $x \\neq 0$ such that $Ax = \\lambda Bx$.\n- An upper Hessenberg matrix has zeros below the first subdiagonal.\n- An upper triangular matrix has zeros below the diagonal.\n- A left Givens rotation $G(c,s)$ acts on rows $i,i+1$, and a right Givens rotation acts on columns $j,j+1$.\n- Given a 2-vector $(\\alpha,\\beta)^T$, the Givens parameters may be chosen as $c = \\alpha/\\sqrt{\\alpha^{2}+\\beta^{2}}$, $s = \\beta/\\sqrt{\\alpha^{2}+\\beta^{2}}$ to zero the second entry when applied from the left; and, when acting on columns to zero the first component of a row 2-vector $(\\gamma,\\delta)$, one may take $c = \\delta/\\sqrt{\\gamma^{2}+\\delta^{2}}$, $s = -\\gamma/\\sqrt{\\gamma^{2}+\\delta^{2}}$.\n\nExplicitly determine the ordered sequence of Givens rotations that annihilates all introduced bulge elements in this sweep:\n\n1. The first left rotation $G(c_{1},s_{1})$ on rows $1$ and $2$ derived from the first two entries of $(A - \\mu B)e_{1}$.\n2. The first right rotation $G(c_{2},s_{2})$ on columns $1$ and $2$ that restores upper triangularity of $B$ by annihilating the entry at position $(2,1)$.\n3. Continue the bulge chase with alternating left rotations on rows $(2,3)$, $(3,4)$, $(4,5)$ and right rotations on columns $(2,3)$, $(3,4)$, $(4,5)$, writing each rotation as $G(c_{k},s_{k})$ with its specific parameters. Where the structure of $(A,B)$ implies no bulge is present, include the corresponding identity rotation $G(1,0)$ explicitly.\n\nProvide your final answer as a single row matrix containing the 16 scalars\n$$\nc_{1}, s_{1}, c_{2}, s_{2}, c_{3}, s_{3}, c_{4}, s_{4}, c_{5}, s_{5}, c_{6}, s_{6}, c_{7}, s_{7}, c_{8}, s_{8}.\n$$\nNo rounding is required; give exact expressions. The final answer must be dimensionless and expressed in analytic form only, with no units.",
            "solution": "The user wants me to perform a single step of the implicit-shift QZ algorithm for a given pair of matrices $(A, B)$.\n\n### Step 0: Problem Setup and Shift Calculation\nThe given matrices are:\n$$ A = A_0 = \\begin{pmatrix} 4 & 2 & 0 & 0 & 0 \\\\ 1 & 5 & 3 & 0 & 0 \\\\ 0 & 0 & 6 & 0 & 0 \\\\ 0 & 0 & 0 & 7 & 5 \\\\ 0 & 0 & 0 & 0 & 8 \\end{pmatrix}, \\quad B = B_0 = \\begin{pmatrix} 2 & 0 & 0 & 0 & 0 \\\\ 0 & 3 & 0 & 0 & 0 \\\\ 0 & 0 & 4 & 0 & 0 \\\\ 0 & 0 & 0 & 5 & 0 \\\\ 0 & 0 & 0 & 0 & 6 \\end{pmatrix} $$\nMatrix $A$ is upper Hessenberg and matrix $B$ is upper triangular (in fact, diagonal).\nThe shift for the implicit QZ step is given by $\\mu = a_{55}/b_{55}$.\n$$ \\mu = \\frac{8}{6} = \\frac{4}{3} $$\n\nThe QZ sweep consists of a sequence of left and right Givens rotations. A rotation is denoted by $G(c,s) = \\begin{pmatrix} c & s \\\\ -s & c \\end{pmatrix}$. We will determine the parameters $(c_k, s_k)$ for each rotation $G_k$.\n\n### Step 1: First Left Rotation, $G_1(c_1, s_1)$\nThis rotation is applied to rows $1$ and $2$ of $A$ and $B$. It is constructed to zero the second element of the vector $v = (A - \\mu B)e_1$. The first column of $A-\\mu B$ is:\n$$ (A - \\mu B)e_1 = \\begin{pmatrix} a_{11} - \\mu b_{11} \\\\ a_{21} - \\mu b_{21} \\\\ \\vdots \\end{pmatrix} = \\begin{pmatrix} 4 - \\frac{4}{3}(2) \\\\ 1 - \\frac{4}{3}(0) \\\\ \\vdots \\end{pmatrix} = \\begin{pmatrix} 4 - \\frac{8}{3} \\\\ 1 \\\\ \\vdots \\end{pmatrix} = \\begin{pmatrix} \\frac{4}{3} \\\\ 1 \\\\ \\vdots \\end{pmatrix} $$\nWe consider the $2$-vector $(\\alpha, \\beta)^T = (4/3, 1)^T$. The problem provides the formula to calculate the Givens parameters $(c,s)$ to zero the second entry: $c = \\alpha/\\sqrt{\\alpha^2+\\beta^2}$ and $s = \\beta/\\sqrt{\\alpha^2+\\beta^2}$.\nFirst, we compute the norm:\n$$ \\sqrt{\\alpha^2 + \\beta^2} = \\sqrt{\\left(\\frac{4}{3}\\right)^2 + 1^2} = \\sqrt{\\frac{16}{9} + 1} = \\sqrt{\\frac{25}{9}} = \\frac{5}{3} $$\nThe parameters for the first rotation $G_1$ are:\n$$ c_1 = \\frac{4/3}{5/3} = \\frac{4}{5}, \\quad s_1 = \\frac{1}{5/3} = \\frac{3}{5} $$\nSo, $G_1 = G(4/5, 3/5)$. Let the corresponding $5 \\times 5$ rotation matrix be $Q_1$. Applying this to $B_0$ from the left gives $B_1 = Q_1 B_0$. The new rows 1 and 2 of $B_1$ are:\n$B_{1, \\text{row } 1} = c_1 B_{0, \\text{row } 1} + s_1 B_{0, \\text{row } 2} = \\frac{4}{5}(2,0,\\dots) + \\frac{3}{5}(0,3,\\dots) = (\\frac{8}{5}, \\frac{9}{5}, 0, 0, 0)$.\n$B_{1, \\text{row } 2} = -s_1 B_{0, \\text{row } 1} + c_1 B_{0, \\text{row } 2} = -\\frac{3}{5}(2,0,\\dots) + \\frac{4}{5}(0,3,\\dots) = (-\\frac{6}{5}, \\frac{12}{5}, 0, 0, 0)$.\n$B_1$ now has a non-zero element at position $(2,1)$, which is $b_{21} = -6/5$.\n\n### Step 2: First Right Rotation, $G_2(c_2, s_2)$\nThis rotation is applied to columns $1$ and $2$ of $A_1=Q_1 A_0$ and $B_1=Q_1 B_0$ to restore $B$ to upper triangular form by annihilating the element $b_{21}$.\nWe need to zero the first component of the row vector $(b_{21}, b_{22}) = (-6/5, 12/5)$. Let this vector be $(\\gamma, \\delta)$.\nThe problem provides the formula $c = \\delta/\\sqrt{\\gamma^2+\\delta^2}$ and $s = -\\gamma/\\sqrt{\\gamma^2+\\delta^2}$.\nFirst, the norm:\n$$ \\sqrt{\\gamma^2 + \\delta^2} = \\sqrt{\\left(-\\frac{6}{5}\\right)^2 + \\left(\\frac{12}{5}\\right)^2} = \\frac{1}{5}\\sqrt{36 + 144} = \\frac{1}{5}\\sqrt{180} = \\frac{1}{5}\\sqrt{36 \\times 5} = \\frac{6\\sqrt{5}}{5} $$\nThe parameters for the second rotation $G_2$ are:\n$$ c_2 = \\frac{12/5}{6\\sqrt{5}/5} = \\frac{12}{6\\sqrt{5}} = \\frac{2}{\\sqrt{5}}, \\quad s_2 = - \\frac{-6/5}{6\\sqrt{5}/5} = \\frac{6}{6\\sqrt{5}} = \\frac{1}{\\sqrt{5}} $$\nSo, $G_2 = G(2/\\sqrt{5}, 1/\\sqrt{5})$. Let the corresponding right rotation matrix be $Z_1$. We have $A_2 = A_1 Z_1$ and $B_2 = B_1 Z_1$.\n\n### Step 3: Chasing the Bulge\nThe rest of the sweep consists of alternating left and right rotations to chase the bulge down the subdiagonal of $A$ and $B$.\n\n**Rotation $G_3(c_3, s_3)$ (Left, rows 2-3):**\nThis rotation $Q_2$ must annihilate the bulge element $a_{31}$ created by the previous right rotation $Z_1$. Let's compute this element in the current matrix $A_2$.\n$$ A_2(3,1) = c_2 A_1(3,1) + s_2 A_1(3,2) $$\nThe matrix $A_1 = Q_1 A_0$ has its third row unchanged from $A_0$ because $Q_1$ acts only on rows 1 and 2. The third row of $A_0$ is $(0, 0, 6, 0, 0)$.\nThus, $A_1(3,1) = 0$ and $A_1(3,2) = 0$. This implies $A_2(3,1) = c_2(0) + s_2(0) = 0$.\nThe bulge element to be annihilated is already zero. The problem states that in this case we should use the identity rotation $G(1,0)$.\n$$ c_3 = 1, \\quad s_3 = 0 $$\n\n**Rotation $G_4(c_4, s_4)$ (Right, cols 2-3):**\nThis rotation $Z_2$ must annihilate the bulge element $b_{32}$ created by the left rotation $Q_2$. The current matrix is $B_3 = Q_2 B_2$. Since $Q_2$ is the identity transformation ($c_3=1, s_3=0$), we have $B_3=B_2$. The element to be annihilated is $b_{32}$ of the matrix $B_2$.\nThe rotation $Q_1$ does not affect row 3 of $B_0$, so row 3 of $B_1$ is $(0,0,4,0,0)$. The right rotation $Z_1$ acts on columns 1 and 2.\n$B_2(3,2) = s_2 B_1(3,1) + c_2 B_1(3,2) = s_2(0) + c_2(0) = 0$.\nThe bulge element is zero. Therefore, we use the identity rotation.\n$$ c_4 = 1, \\quad s_4 = 0 $$\n\n**Subsequent Rotations:**\nThe specific sparse structure of $A$ and the diagonal form of $B$ cause all subsequent bulge elements to be zero before the application of the corresponding rotation.\nLet's verify this systematically.\nThe rotation pair $(Q_k, Z_k)$ acts on rows/cols $(k,k+1)$ to chase bulges at $A_{k+1,k-1}$ and $B_{k+1,k}$.\nOur finding is that $A_2(3,1)=0$ and $B_2(3,2)=0$. This leads to $Q_2=I$ and $Z_2=I$. Consequently, $A_4=A_2$ and $B_4=B_2$.\n\n**Rotation $G_5(c_5, s_5)$ (Left, rows 3-4):** Annihilates $A_4(4,2)$.\n$A_4(4,2) = A_2(4,2) = s_2 A_1(4,1) + c_2 A_1(4,2)$. Row 4 of $A_1$ is same as $A_0$, which is $(0,0,0,7,5)$. So $A_1(4,1)=0, A_1(4,2)=0 \\implies A_4(4,2)=0$.\nElement is zero, so we use identity rotation:\n$$ c_5 = 1, \\quad s_5 = 0 $$\n\n**Rotation $G_6(c_6, s_6)$ (Right, cols 3-4):** Annihilates $B_5(4,3)$.\n$B_5=Q_3 B_4=I B_4 = B_2$. We need to annihilate $B_2(4,3)$. $Z_1$ acts on cols 1,2. $B_2$ is upper triangular. $Z_2=I$. So $B_4=B_2$. Q_3=I, so $B_5=B_4$. We need to zero $B_5(4,3) = B_2(4,3)$.\n$B_2(4,3)$ is unchanged from $B_0(4,3)=0$.\nElement is zero, so we use identity rotation:\n$$ c_6 = 1, \\quad s_6 = 0 $$\n\n**Rotation $G_7(c_7, s_7)$ (Left, rows 4-5):** Annihilates $A_6(5,3)$.\n$A_6=A_4=A_2$. We need to check $A_2(5,3)$. $Z_1$ acts on cols 1,2. $A_2(:,3)=A_1(:,3)$. $Q_1$ acts on rows 1,2. $A_1(5,3)=A_0(5,3)=0$.\nElement is zero, so we use identity rotation:\n$$ c_7 = 1, \\quad s_7 = 0 $$\n\n**Rotation $G_8(c_8, s_8)$ (Right, cols 4-5):** Annihilates $B_7(5,4)$.\n$B_7=B_5=B_2$. We need $B_2(5,4)$. $Z_1$ acts on cols 1,2. $B_2(5,4) = B_1(5,4)$. $Q_1$ acts on rows 1,2. $B_1(5,4)=B_0(5,4)=0$.\nElement is zero, so we use identity rotation:\n$$ c_8 = 1, \\quad s_8 = 0 $$\n\n### Summary of Rotation Parameters\nThe sequence of parameters for the 8 Givens rotations is:\n- $G_1(c_1,s_1): c_1 = 4/5, s_1 = 3/5$\n- $G_2(c_2,s_2): c_2 = 2/\\sqrt{5}, s_2 = 1/\\sqrt{5}$\n- $G_3(c_3,s_3): c_3 = 1, s_3 = 0$\n- $G_4(c_4,s_4): c_4 = 1, s_4 = 0$\n- $G_5(c_5,s_5): c_5 = 1, s_5 = 0$\n- $G_6(c_6,s_6): c_6 = 1, s_6 = 0$\n- $G_7(c_7,s_7): c_7 = 1, s_7 = 0$\n- $G_8(c_8,s_8): c_8 = 1, s_8 = 0$\n\nThe final answer is presented as a single row matrix of these 16 scalars.",
            "answer": "$$ \\boxed{\\begin{pmatrix} \\frac{4}{5} & \\frac{3}{5} & \\frac{2}{\\sqrt{5}} & \\frac{1}{\\sqrt{5}} & 1 & 0 & 1 & 0 & 1 & 0 & 1 & 0 & 1 & 0 & 1 & 0 \\end{pmatrix}} $$"
        },
        {
            "introduction": "After the iterative QZ algorithm has converged, it delivers a generalized Schur form $(S, T)$. This exercise focuses on the final, crucial step: extracting the generalized eigenvalues from this structured result. You will see how the quasi-triangular structure allows the problem to be decoupled into smaller, manageable diagonal blocks, and you will verify the results by connecting them back to the fundamental definition of a generalized eigenvalue, $\\det(A - \\lambda B) = 0$ .",
            "id": "3594724",
            "problem": "Consider the generalized eigenvalue problem for matrices $\\mathbf{A} \\in \\mathbb{R}^{n \\times n}$ and $\\mathbf{B} \\in \\mathbb{R}^{n \\times n}$, defined by the roots $\\lambda \\in \\mathbb{C}$ of the equation $\\det(\\mathbf{A} - \\lambda \\mathbf{B}) = 0$. The generalized Schur (QZ) algorithm produces orthogonal matrices $\\mathbf{Q}$ and $\\mathbf{Z}$ such that $\\mathbf{Q}^T \\mathbf{A} \\mathbf{Z} = \\mathbf{S}$ and $\\mathbf{Q}^T \\mathbf{B} \\mathbf{Z} = \\mathbf{T}$, where $\\mathbf{S}$ is upper quasi-triangular and $\\mathbf{T}$ is upper triangular. Using only these foundational facts, extract the generalized eigenvalues from a given $(\\mathbf{S}, \\mathbf{T})$ pair by solving $\\det(\\mathbf{S}_{ii} - \\lambda \\mathbf{T}_{ii}) = 0$ on the diagonal blocks $\\mathbf{S}_{ii}, \\mathbf{T}_{ii}$. Then, verify by direct computation that $\\det(\\mathbf{A} - \\lambda \\mathbf{B})$ vanishes at those values (within rounding error).\n\nFor this task, you are given the generalized Schur form\n$$\n\\mathbf{S} = \\begin{pmatrix}\n2 & 3 & 0 \\\\\n1 & 4 & 0 \\\\\n0 & 0 & 5\n\\end{pmatrix}, \n\\quad\n\\mathbf{T} = \\begin{pmatrix}\n1 & 0 & 0 \\\\\n0 & 1 & 0 \\\\\n0 & 0 & 2\n\\end{pmatrix}.\n$$\nFor the purpose of the verification step, take $\\mathbf{Q} = \\mathbf{I}$ and $\\mathbf{Z} = \\mathbf{I}$, so that $\\mathbf{A} = \\mathbf{S}$ and $\\mathbf{B} = \\mathbf{T}$.\n\nCompute the generalized eigenvalues from $(\\mathbf{S}, \\mathbf{T})$, verify that $\\det(\\mathbf{A} - \\lambda \\mathbf{B})$ evaluates to zero at each of these values by direct evaluation, and report the sum of the generalized eigenvalues. Express your final answer as an exact number (no rounding required).",
            "solution": "The problem is valid as it is scientifically grounded in numerical linear algebra, well-posed, objective, and fully specified. All premises are factually correct and internally consistent.\n\nThe problem asks for the computation of generalized eigenvalues for a given pair of matrices $(\\mathbf{S}, \\mathbf{T})$ in generalized Schur form, verification of these eigenvalues, and their sum. The generalized eigenvalue problem is defined by the equation $\\det(\\mathbf{A} - \\lambda \\mathbf{B}) = 0$. The QZ algorithm provides a decomposition such that $\\mathbf{Q}^T \\mathbf{A} \\mathbf{Z} = \\mathbf{S}$ and $\\mathbf{Q}^T \\mathbf{B} \\mathbf{Z} = \\mathbf{T}$, where $\\mathbf{Q}$ and $\\mathbf{Z}$ are orthogonal matrices. A key property of this decomposition is that the generalized eigenvalues of the pair $(\\mathbf{A}, \\mathbf{B})$ are the same as those of the pair $(\\mathbf{S}, \\mathbf{T})$. This is because $\\det(\\mathbf{Q})$ and $\\det(\\mathbf{Z})$ are non-zero (specifically, $\\pm 1$).\n$$\n\\det(\\mathbf{A} - \\lambda \\mathbf{B}) = 0 \\iff \\det(\\mathbf{Q}^T(\\mathbf{A} - \\lambda \\mathbf{B})\\mathbf{Z}) = 0\n$$\n$$\n\\iff \\det(\\mathbf{Q}^T\\mathbf{A}\\mathbf{Z} - \\lambda \\mathbf{Q}^T\\mathbf{B}\\mathbf{Z}) = 0 \\iff \\det(\\mathbf{S} - \\lambda \\mathbf{T}) = 0\n$$\nThe problem provides the matrices $\\mathbf{S}$ and $\\mathbf{T}$ in generalized Schur form:\n$$\n\\mathbf{S} = \\begin{pmatrix}\n2 & 3 & 0 \\\\\n1 & 4 & 0 \\\\\n0 & 0 & 5\n\\end{pmatrix}, \n\\quad\n\\mathbf{T} = \\begin{pmatrix}\n1 & 0 & 0 \\\\\n0 & 1 & 0 \\\\\n0 & 0 & 2\n\\end{pmatrix}\n$$\nThe matrix $\\mathbf{S}$ is upper quasi-triangular, which means it is block upper triangular with $1 \\times 1$ or $2 \\times 2$ diagonal blocks. The matrix $\\mathbf{T}$ is upper triangular. In this case, $\\mathbf{S}$ is block upper triangular and $\\mathbf{T}$ is block diagonal (which is a special case of block upper triangular with the same block structure). The determinant of a block triangular matrix is the product of the determinants of its diagonal blocks. Thus, the generalized eigenvalues can be extracted by solving $\\det(\\mathbf{S}_{ii} - \\lambda \\mathbf{T}_{ii}) = 0$ for each diagonal block pair $(\\mathbf{S}_{ii}, \\mathbf{T}_{ii})$.\n\nThe diagonal blocks of $\\mathbf{S}$ and $\\mathbf{T}$ are:\nA $2 \\times 2$ block:\n$$\n\\mathbf{S}_{11} = \\begin{pmatrix} 2 & 3 \\\\ 1 & 4 \\end{pmatrix}, \\quad \\mathbf{T}_{11} = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}\n$$\nAnd a $1 \\times 1$ block:\n$$\n\\mathbf{S}_{22} = (5), \\quad \\mathbf{T}_{22} = (2)\n$$\n\nFirst, we find the eigenvalues from the $2 \\times 2$ block by solving $\\det(\\mathbf{S}_{11} - \\lambda \\mathbf{T}_{11}) = 0$.\n$$\n\\mathbf{S}_{11} - \\lambda \\mathbf{T}_{11} = \\begin{pmatrix} 2 & 3 \\\\ 1 & 4 \\end{pmatrix} - \\lambda \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} = \\begin{pmatrix} 2-\\lambda & 3 \\\\ 1 & 4-\\lambda \\end{pmatrix}\n$$\nThe determinant is:\n$$\n\\det(\\mathbf{S}_{11} - \\lambda \\mathbf{T}_{11}) = (2-\\lambda)(4-\\lambda) - (3)(1) = 8 - 4\\lambda - 2\\lambda + \\lambda^2 - 3 = \\lambda^2 - 6\\lambda + 5\n$$\nSetting the determinant to zero:\n$$\n\\lambda^2 - 6\\lambda + 5 = 0\n$$\nFactoring the quadratic equation gives $(\\lambda - 1)(\\lambda - 5) = 0$. The roots are $\\lambda_1 = 1$ and $\\lambda_2 = 5$.\n\nNext, we find the eigenvalue from the $1 \\times 1$ block by solving $\\det(\\mathbf{S}_{22} - \\lambda \\mathbf{T}_{22}) = 0$.\n$$\n\\mathbf{S}_{22} - \\lambda \\mathbf{T}_{22} = (5) - \\lambda(2) = (5 - 2\\lambda)\n$$\nThe determinant is simply $5 - 2\\lambda$. Setting this to zero gives:\n$$\n5 - 2\\lambda = 0 \\implies \\lambda_3 = \\frac{5}{2}\n$$\nThe set of generalized eigenvalues is $\\{\\lambda_1, \\lambda_2, \\lambda_3\\} = \\{1, 5, \\frac{5}{2}\\}$.\n\nFor the verification, we are instructed to set $\\mathbf{A} = \\mathbf{S}$ and $\\mathbf{B} = \\mathbf{T}$ and show that $\\det(\\mathbf{A} - \\lambda \\mathbf{B})$ vanishes for each eigenvalue. We compute $\\det(\\mathbf{S} - \\lambda \\mathbf{T})$ directly.\n$$\n\\mathbf{S} - \\lambda \\mathbf{T} = \\begin{pmatrix}\n2-\\lambda & 3 & 0 \\\\\n1 & 4-\\lambda & 0 \\\\\n0 & 0 & 5-2\\lambda\n\\end{pmatrix}\n$$\nThe determinant of this block-structured matrix is:\n$$\n\\det(\\mathbf{S} - \\lambda \\mathbf{T}) = \\left( \\det \\begin{pmatrix} 2-\\lambda & 3 \\\\ 1 & 4-\\lambda \\end{pmatrix} \\right) \\cdot (5-2\\lambda)\n$$\n$$\n\\det(\\mathbf{S} - \\lambda \\mathbf{T}) = ( (2-\\lambda)(4-\\lambda) - 3 ) \\cdot (5-2\\lambda) = (\\lambda^2 - 6\\lambda + 5)(5-2\\lambda) = (\\lambda-1)(\\lambda-5)(5-2\\lambda)\n$$\nLet's name this characteristic polynomial $p(\\lambda) = \\det(\\mathbf{S} - \\lambda \\mathbf{T})$. We verify by direct evaluation that $p(\\lambda) = 0$ for each computed eigenvalue:\nFor $\\lambda_1 = 1$:\n$$\np(1) = (1-1)(1-5)(5 - 2 \\cdot 1) = (0)(-4)(3) = 0\n$$\nFor $\\lambda_2 = 5$:\n$$\np(5) = (5-1)(5-5)(5 - 2 \\cdot 5) = (4)(0)(-5) = 0\n$$\nFor $\\lambda_3 = \\frac{5}{2}$:\n$$\np\\left(\\frac{5}{2}\\right) = \\left(\\frac{5}{2}-1\\right)\\left(\\frac{5}{2}-5\\right)\\left(5 - 2 \\cdot \\frac{5}{2}\\right) = \\left(\\frac{3}{2}\\right)\\left(-\\frac{5}{2}\\right)(5-5) = \\left(\\frac{3}{2}\\right)\\left(-\\frac{5}{2}\\right)(0) = 0\n$$\nThe verification is successful. All computed eigenvalues are correct.\n\nFinally, we compute the sum of the generalized eigenvalues:\n$$\n\\sum_{i=1}^{3} \\lambda_i = \\lambda_1 + \\lambda_2 + \\lambda_3 = 1 + 5 + \\frac{5}{2} = 6 + \\frac{5}{2} = \\frac{12}{2} + \\frac{5}{2} = \\frac{17}{2}\n$$\nThe sum of the generalized eigenvalues is $\\frac{17}{2}$.",
            "answer": "$$\n\\boxed{\\frac{17}{2}}\n$$"
        },
        {
            "introduction": "A numerically stable algorithm can still produce unreliable results if the underlying problem is inherently sensitive to small changes in the input data. This practice explores the vital concept of eigenvalue conditioning for the generalized eigenproblem . By deriving the sensitivity of an eigenvalue to a perturbation from first principles, you will uncover why certain matrix pairs—particularly those where the matrix $B$ is nearly singular—lead to \"fragile\" eigenvalues, highlighting the important distinction between the stability of an algorithm and the conditioning of a problem.",
            "id": "3594704",
            "problem": "Consider the generalized eigenproblem defined by matrices $A \\in \\mathbb{C}^{4\\times 4}$ and $B \\in \\mathbb{C}^{4\\times 4}$, where\n$$\nA = \\operatorname{diag}(1,\\,2,\\,3,\\,4),\\qquad B = \\operatorname{diag}\\!\\left(1,\\,1,\\,1,\\,10^{-4}\\right).\n$$\nThis pair is already in generalized Schur form (also known as the generalized Schur decomposition or the QZ algorithm form), so the generalized eigenvalues are the diagonal ratios.\n\nDefine a perturbation to $B$ along the rank-one direction $E = e_{4} e_{4}^{\\top}$ by\n$$\nB(\\varepsilon) = B + \\varepsilon E,\\quad \\varepsilon \\in \\mathbb{R},\n$$\nso that only the $(4,4)$ entry of $B$ is perturbed.\n\nStarting from the definition of a generalized eigenpair $(\\lambda, x)$ satisfying $A x = \\lambda B x$ with an associated left eigenvector $y$ satisfying $y^* A = \\lambda y^* B$, and without invoking any pre-stated perturbation formulas, derive the first-order sensitivity of the eigenvalue $\\lambda_{4}(\\varepsilon)$ that corresponds to the $4$-th diagonal ratio under the perturbation $B(\\varepsilon)$. Use the differentiation of the defining equations and appropriate normalizations to obtain an explicit analytic expression for $\\left.\\frac{d\\lambda_{4}}{d\\varepsilon}\\right|_{\\varepsilon=0}$.\n\nThen, connect your expression to a condition-number-based explanation by interpreting the directional derivative in terms of the left and right eigenvectors and the bilinear form $y^* B x$, and briefly explain why this eigenvalue is sensitive to perturbations in $B$.\n\nYour final reported quantity must be the exact value of $\\left.\\frac{d\\lambda_{4}}{d\\varepsilon}\\right|_{\\varepsilon=0}$. No rounding is required. Provide no units.",
            "solution": "The problem asks for the first-order sensitivity of the generalized eigenvalue $\\lambda_4$ of the pair $(A, B)$ with respect to a specific perturbation in $B$. We are required to derive this from first principles.\n\nLet the generalized eigenpair be $(\\lambda(\\varepsilon), x(\\varepsilon))$, which depends on the perturbation parameter $\\varepsilon$. The defining equation is:\n$$ A x(\\varepsilon) = \\lambda(\\varepsilon) B(\\varepsilon) x(\\varepsilon) $$\nwhere $A = \\operatorname{diag}(1, 2, 3, 4)$, $B(\\varepsilon) = B + \\varepsilon E$, with $B = \\operatorname{diag}(1, 1, 1, 10^{-4})$ and $E = e_4 e_4^T$. The vector $e_4$ is the fourth standard basis vector in $\\mathbb{C}^4$.\n\nFirst, we identify the unperturbed eigenvalue and eigenvectors at $\\varepsilon=0$. The problem is $A x = \\lambda B x$. Since $A$ and $B$ are diagonal, the generalized eigenvalues are the ratios of the diagonal elements, $\\lambda_i = A_{ii} / B_{ii}$. We are interested in the fourth eigenvalue:\n$$ \\lambda_4(0) \\equiv \\lambda_4 = \\frac{A_{44}}{B_{44}} = \\frac{4}{10^{-4}} = 4 \\times 10^4 $$\nThe corresponding right eigenvector is $x_4(0) \\equiv x_4 = e_4$. The left eigenvector $y_4$ is defined by $y_4^* A = \\lambda_4 y_4^* B$. Since $A$ and $B$ are real symmetric (diagonal), the left eigenvector is the same as the right eigenvector, so $y_4(0) \\equiv y_4 = e_4$. We can verify this:\n$e_4^T A = 4 e_4^T$ and $\\lambda_4 e_4^T B = (4 \\times 10^4) (10^{-4} e_4^T) = 4 e_4^T$.\n\nTo find the sensitivity, we differentiate the defining equation $A x(\\varepsilon) = \\lambda(\\varepsilon) B(\\varepsilon) x(\\varepsilon)$ with respect to $\\varepsilon$:\n$$ \\frac{d}{d\\varepsilon} [A x(\\varepsilon)] = \\frac{d}{d\\varepsilon} [\\lambda(\\varepsilon) (B + \\varepsilon E) x(\\varepsilon)] $$\nUsing the product rule on both sides (though $A$ is constant), we get:\n$$ A \\frac{dx}{d\\varepsilon} = \\frac{d\\lambda}{d\\varepsilon} (B + \\varepsilon E) x(\\varepsilon) + \\lambda(\\varepsilon) \\left[ \\frac{d}{d\\varepsilon}(B + \\varepsilon E) x(\\varepsilon) + (B + \\varepsilon E) \\frac{dx}{d\\varepsilon} \\right] $$\n$$ A \\dot{x}(\\varepsilon) = \\dot{\\lambda}(\\varepsilon) (B + \\varepsilon E) x(\\varepsilon) + \\lambda(\\varepsilon) \\left[ E x(\\varepsilon) + (B + \\varepsilon E) \\dot{x}(\\varepsilon) \\right] $$\nwhere the dot notation signifies differentiation with respect to $\\varepsilon$.\n\nNow, we evaluate this expression at $\\varepsilon=0$. At this point, $\\lambda(0) = \\lambda_4$, $x(0) = x_4$, and $B(0)=B$:\n$$ A \\dot{x}(0) = \\dot{\\lambda_4}(0) B x_4 + \\lambda_4 [E x_4 + B \\dot{x}(0)] $$\nTo solve for $\\dot{\\lambda_4}(0)$ without needing to find $\\dot{x}(0)$, we pre-multiply the entire equation by the conjugate transpose of the left eigenvector, $y_4^* = e_4^T$:\n$$ y_4^* A \\dot{x}(0) = \\dot{\\lambda_4}(0) y_4^* B x_4 + \\lambda_4 y_4^* E x_4 + \\lambda_4 y_4^* B \\dot{x}(0) $$\nWe use the defining property of the left eigenvector, $y_4^* A = \\lambda_4 y_4^* B$. Substituting this into the left-hand side gives:\n$$ (\\lambda_4 y_4^* B) \\dot{x}(0) = \\dot{\\lambda_4}(0) y_4^* B x_4 + \\lambda_4 y_4^* E x_4 + \\lambda_4 y_4^* B \\dot{x}(0) $$\nThe term $\\lambda_4 y_4^* B \\dot{x}(0)$ appears on both sides and cancels out, leaving:\n$$ 0 = \\dot{\\lambda_4}(0) y_4^* B x_4 + \\lambda_4 y_4^* E x_4 $$\nThis cancellation demonstrates that the first-order perturbation of the eigenvalue does not depend on the first-order perturbation of the eigenvector, for a simple eigenvalue.\n\nSolving for the desired derivative, $\\dot{\\lambda_4}(0) = \\left.\\frac{d\\lambda_4}{d\\varepsilon}\\right|_{\\varepsilon=0}$:\n$$ \\dot{\\lambda_4}(0) = - \\lambda_4 \\frac{y_4^* E x_4}{y_4^* B x_4} $$\nThis expression gives the first-order sensitivity.\n\nNow, we compute the scalar quantities in this expression:\n- $y_4^* E x_4 = e_4^T (e_4 e_4^T) e_4 = (e_4^T e_4) (e_4^T e_4) = (1)(1) = 1$. This term represents the magnitude of the perturbation in the \"direction\" of the eigenpair.\n- $y_4^* B x_4 = e_4^T B e_4 = B_{44} = 10^{-4}$. This term is a crucial part of the eigenvalue condition number.\n\nSubstituting these values along with $\\lambda_4 = 4 \\times 10^4$:\n$$ \\left.\\frac{d\\lambda_4}{d\\varepsilon}\\right|_{\\varepsilon=0} = - (4 \\times 10^4) \\frac{1}{10^{-4}} = -4 \\times 10^4 \\times 10^4 = -4 \\times 10^8 $$\n\nThe derived expression for the sensitivity, $\\dot{\\lambda_4}(0) = -\\lambda_4 (y_4^* E x_4) / (y_4^* B x_4)$, connects directly to the conditioning of the generalized eigenvalue problem. The sensitivity is inversely proportional to the magnitude of the bilinear form $y_4^* B x_4$. In this case, $y_4^* B x_4 = 10^{-4}$, which is a very small number. A small denominator leads to a large derivative, indicating that the eigenvalue $\\lambda_4$ is highly sensitive to perturbations. This eigenvalue is ill-conditioned. The reason for this is that the matrix $B$ is nearly singular (one of its diagonal entries is close to zero). The generalized eigenvalue $\\lambda_4 = A_{44}/B_{44}$ involves division by this small number. A small absolute perturbation $\\varepsilon$ to $B_{44}$ results in a large relative change in $B_{44}$, which in turn causes a very large absolute change in $\\lambda_4$. The large magnitude of the derivative, $-4 \\times 10^8$, quantifies this extreme sensitivity.",
            "answer": "$$\\boxed{-4 \\times 10^{8}}$$"
        }
    ]
}