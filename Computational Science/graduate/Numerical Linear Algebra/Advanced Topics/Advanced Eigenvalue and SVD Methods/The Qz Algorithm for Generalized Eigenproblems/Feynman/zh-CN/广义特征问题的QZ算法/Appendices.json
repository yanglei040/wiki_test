{
    "hands_on_practices": [
        {
            "introduction": "为了真正掌握 QZ 算法，我们必须理解其核心的“凸起追踪” (bulge chasing) 过程。这个练习提供了一个具体的例子，让您亲手完成隐式 QZ 算法中的一步迭代，计算用于恢复矩阵对的 Hessenberg-三角结构的一系列 Givens 旋转。通过这个过程，您将对算法的迭代本质和精巧设计有更深刻的体悟。",
            "id": "3594787",
            "problem": "考虑一个实数矩阵对 $(A,B)$ 的广义特征值问题，其中 $A \\in \\mathbb{R}^{5 \\times 5}$ 是上Hessenberg矩阵，$B \\in \\mathbb{R}^{5 \\times 5}$ 是上三角矩阵。广义Schur (QZ) 算法的单次隐式位移步对矩阵对 $(A,B)$ 应用一系列正交平面旋转，使得该步骤结束后，$(A,B)$ 再次成为一个上Hessenberg-三角矩阵对，并完成对初始引入的凸起（bulge）的追逐。Givens旋转是一个形如\n$$G(c,s) \\;=\\; \\begin{pmatrix} c  s \\\\ -s  c \\end{pmatrix}$$\n的 $2 \\times 2$ 正交矩阵，其中 $c^{2}+s^{2}=1$，用于（从左）作用于连续的行或（从右）作用于连续的列。在一次单位移QZ扫描中，我们从末尾的 $1 \\times 1$ 块选择位移 $\\mu = a_{55}/b_{55}$，基于向量 $(A - \\mu B)e_{1}$ 的前两个元素，通过一次左旋转在顶部引入一个凸起，再通过一次右旋转恢复 $B$ 的上三角性，然后通过在连续的 $2 \\times 2$ 行/列窗口上交替进行左右Givens旋转来向下追逐凸起。\n\n设\n$$\nA \\;=\\;\n\\begin{pmatrix}\n4  2  0  0  0 \\\\\n1  5  3  0  0 \\\\\n0  0  6  0  0 \\\\\n0  0  0  7  5 \\\\\n0  0  0  0  8\n\\end{pmatrix},\n\\qquad\nB \\;=\\;\n\\begin{pmatrix}\n2  0  0  0  0 \\\\\n0  3  0  0  0 \\\\\n0  0  4  0  0 \\\\\n0  0  0  5  0 \\\\\n0  0  0  0  6\n\\end{pmatrix}.\n$$\n使用位移 $\\mu = a_{55}/b_{55}$ 执行一次隐式单位移QZ扫描。使用以下基本定义和事实：\n\n- 广义特征值问题旨在求解满足 $Ax = \\lambda Bx$ 的 $\\lambda \\in \\mathbb{R}$ 和 $x \\neq 0$。\n- 上Hessenberg矩阵在第一副对角线下方元素为零。\n- 上三角矩阵在主对角线下方元素为零。\n- 一个左Givens旋转 $G(c,s)$ 作用于行 $i,i+1$，一个右Givens旋转作用于列 $j,j+1$。\n- 给定一个2维向量 $(\\alpha,\\beta)^{\\top}$，当从左侧应用时，为使第二个元素为零，Givens参数可选择为 $c = \\alpha/\\sqrt{\\alpha^{2}+\\beta^{2}}$，$s = \\beta/\\sqrt{\\alpha^{2}+\\beta^{2}}$；当作用于列以使行2维向量 $(\\gamma,\\delta)$ 的第一个分量为零时，可取 $c = \\delta/\\sqrt{\\gamma^{2}+\\delta^{2}}$，$s = -\\gamma/\\sqrt{\\gamma^{2}+\\delta^{2}}$。\n\n明确确定在此次扫描中消去所有引入的凸起元素的Givens旋转的有序序列：\n\n1. 作用于第1行和第2行的第一次左旋转 $G(c_{1},s_{1})$，由 $(A - \\mu B)e_{1}$ 的前两个元素导出。\n2. 作用于第1列和第2列的第一次右旋转 $G(c_{2},s_{2})$，通过消去位置 $(2,1)$ 的元素来恢复 $B$ 的上三角性。\n3. 通过在行 $(2,3)$、$(3,4)$、$(4,5)$ 上交替进行左旋转和在列 $(2,3)$、$(3,4)$、$(4,5)$ 上交替进行右旋转来继续追逐凸起，将每次旋转写作 $G(c_{k},s_{k})$ 并附上其具体参数。当 $(A,B)$ 的结构意味着不存在凸起时，明确地包含相应的单位旋转 $G(1,0)$。\n\n将你的最终答案以包含这16个标量\n$$\nc_{1}, s_{1}, c_{2}, s_{2}, c_{3}, s_{3}, c_{4}, s_{4}, c_{5}, s_{5}, c_{6}, s_{6}, c_{7}, s_{7}, c_{8}, s_{8}.\n$$\n的单行矩阵形式给出。无需四舍五入；给出精确表达式。最终答案必须是无量纲的，并且只能以解析形式表示，不带单位。",
            "solution": "用户要求我针对给定的矩阵对 $(A, B)$ 执行一步隐式位移QZ算法。\n\n### 第0步：问题设置与位移计算\n给定的矩阵是：\n$$ A = A_0 = \\begin{pmatrix} 4  2  0  0  0 \\\\ 1  5  3  0  0 \\\\ 0  0  6  0  0 \\\\ 0  0  0  7  5 \\\\ 0  0  0  0  8 \\end{pmatrix}, \\quad B = B_0 = \\begin{pmatrix} 2  0  0  0  0 \\\\ 0  3  0  0  0 \\\\ 0  0  4  0  0 \\\\ 0  0  0  5  0 \\\\ 0  0  0  0  6 \\end{pmatrix} $$\n矩阵 $A$ 是上Hessenberg矩阵，矩阵 $B$ 是上三角矩阵（实际上是对角矩阵）。\n隐式QZ步的位移由 $\\mu = a_{55}/b_{55}$ 给出。\n$$ \\mu = \\frac{8}{6} = \\frac{4}{3} $$\n\nQZ扫描由一系列左、右Givens旋转组成。一次旋转表示为 $G(c,s) = \\begin{pmatrix} c  s \\\\ -s  c \\end{pmatrix}$。我们将确定每次旋转 $G_k$ 的参数 $(c_k, s_k)$。\n\n### 第1步：第一次左旋转, $G_1(c_1, s_1)$\n此旋转应用于 $A$ 和 $B$ 的第1行和第2行。它被构造用来消去向量 $v = (A - \\mu B)e_1$ 的第二个元素。$A-\\mu B$ 的第一列是：\n$$ (A - \\mu B)e_1 = \\begin{pmatrix} a_{11} - \\mu b_{11} \\\\ a_{21} - \\mu b_{21} \\\\ \\vdots \\end{pmatrix} = \\begin{pmatrix} 4 - \\frac{4}{3}(2) \\\\ 1 - \\frac{4}{3}(0) \\\\ \\vdots \\end{pmatrix} = \\begin{pmatrix} 4 - \\frac{8}{3} \\\\ 1 \\\\ \\vdots \\end{pmatrix} = \\begin{pmatrix} \\frac{4}{3} \\\\ 1 \\\\ \\vdots \\end{pmatrix} $$\n我们考虑2维向量 $(\\alpha, \\beta)^T = (4/3, 1)^T$。问题提供了计算Givens参数 $(c,s)$ 以消去第二个元素的公式：$c = \\alpha/\\sqrt{\\alpha^2+\\beta^2}$ 和 $s = \\beta/\\sqrt{\\alpha^2+\\beta^2}$。\n首先，我们计算范数：\n$$ \\sqrt{\\alpha^2 + \\beta^2} = \\sqrt{\\left(\\frac{4}{3}\\right)^2 + 1^2} = \\sqrt{\\frac{16}{9} + 1} = \\sqrt{\\frac{25}{9}} = \\frac{5}{3} $$\n第一次旋转 $G_1$ 的参数是：\n$$ c_1 = \\frac{4/3}{5/3} = \\frac{4}{5}, \\quad s_1 = \\frac{1}{5/3} = \\frac{3}{5} $$\n因此，$G_1 = G(4/5, 3/5)$。设相应的 $5 \\times 5$ 旋转矩阵为 $Q_1$。将其从左侧应用于 $B_0$ 得到 $B_1 = Q_1 B_0$。$B_1$ 新的第1行和第2行是：\n$B_{1, \\text{row } 1} = c_1 B_{0, \\text{row } 1} + s_1 B_{0, \\text{row } 2} = \\frac{4}{5}(2,0,\\dots) + \\frac{3}{5}(0,3,\\dots) = (\\frac{8}{5}, \\frac{9}{5}, 0, 0, 0)$。\n$B_{1, \\text{row } 2} = -s_1 B_{0, \\text{row } 1} + c_1 B_{0, \\text{row } 2} = -\\frac{3}{5}(2,0,\\dots) + \\frac{4}{5}(0,3,\\dots) = (-\\frac{6}{5}, \\frac{12}{5}, 0, 0, 0)$。\n$B_1$ 现在在位置 $(2,1)$ 有一个非零元素，即 $b_{21} = -6/5$。\n\n### 第2步：第一次右旋转, $G_2(c_2, s_2)$\n此旋转应用于 $A_1=Q_1 A_0$ 和 $B_1=Q_1 B_0$ 的第1列和第2列，通过消去元素 $b_{21}$ 来将 $B$ 恢复为上三角形式。\n我们需要消去行向量 $(b_{21}, b_{22}) = (-6/5, 12/5)$ 的第一个分量。设此向量为 $(\\gamma, \\delta)$。\n问题提供了公式 $c = \\delta/\\sqrt{\\gamma^2+\\delta^2}$ 和 $s = -\\gamma/\\sqrt{\\gamma^2+\\delta^2}$。\n首先，范数：\n$$ \\sqrt{\\gamma^2 + \\delta^2} = \\sqrt{\\left(-\\frac{6}{5}\\right)^2 + \\left(\\frac{12}{5}\\right)^2} = \\frac{1}{5}\\sqrt{36 + 144} = \\frac{1}{5}\\sqrt{180} = \\frac{1}{5}\\sqrt{36 \\times 5} = \\frac{6\\sqrt{5}}{5} $$\n第二次旋转 $G_2$ 的参数是：\n$$ c_2 = \\frac{12/5}{6\\sqrt{5}/5} = \\frac{12}{6\\sqrt{5}} = \\frac{2}{\\sqrt{5}}, \\quad s_2 = - \\frac{-6/5}{6\\sqrt{5}/5} = \\frac{6}{6\\sqrt{5}} = \\frac{1}{\\sqrt{5}} $$\n因此，$G_2 = G(2/\\sqrt{5}, 1/\\sqrt{5})$。设相应的右旋转矩阵为 $Z_1$。我们有 $A_2 = A_1 Z_1$ 和 $B_2 = B_1 Z_1$。\n\n### 第3步：追逐凸起\n扫描的其余部分包括交替的左、右旋转，以沿 $A$ 和 $B$ 的次对角线向下追逐凸起。\n\n**旋转 $G_3(c_3, s_3)$ (左，作用于行2-3)：**\n这次旋转 $Q_2$ 必须消去由前一次右旋转 $Z_1$ 产生的凸起元素 $a_{31}$。让我们计算当前矩阵 $A_2$ 中的这个元素。\n$$ A_2(3,1) = c_2 A_1(3,1) + s_2 A_1(3,2) $$\n矩阵 $A_1 = Q_1 A_0$ 的第三行与 $A_0$ 相比没有变化，因为 $Q_1$ 只作用于第1行和第2行。$A_0$ 的第三行是 $(0, 0, 6, 0, 0)$。因此，$A_1(3,1) = 0$ 且 $A_1(3,2) = 0$。这意味着 $A_2(3,1) = c_2(0) + s_2(0) = 0$。\n要消去的凸起元素已经是零。问题说明在这种情况下我们应该使用单位旋转 $G(1,0)$。\n$$ c_3 = 1, \\quad s_3 = 0 $$\n\n**旋转 $G_4(c_4, s_4)$ (右，作用于列2-3)：**\n这次旋转 $Z_2$ 必须消去由左旋转 $Q_2$ 产生的凸起元素 $b_{32}$。当前矩阵是 $B_3 = Q_2 B_2$。由于 $Q_2$ 是单位变换($c_3=1, s_3=0$)，我们有 $B_3=B_2$。要消去的元素是矩阵 $B_2$ 的 $b_{32}$。\n$B_2(3,2) = -s_2 B_1(3,1) + c_2 B_1(3,2)$\n旋转 $Q_1$ 不影响 $B_0$ 的第3行，所以 $B_1$ 的第3行是 $(0,0,4,0,0)$。因此 $B_1(3,1)=0$ 且 $B_1(3,2)=0$。\n这意味着 $B_2(3,2) = 0$。由 $Q_2$ 产生的元素 $b_{32}$ 是 $B_3(3,2)$。\n$B_3$ 的第3行是 $c_3(\\text{row }3 \\text{ of } B_2) + s_3(\\text{row }2 \\text{ of } B_2)$。由于 $c_3=1, s_3=0$，第3行不变。所以 $B_3(3,2)=B_2(3,2)=0$。\n凸起元素为零。因此，我们使用单位旋转。\n$$ c_4 = 1, \\quad s_4 = 0 $$\n\n**后续旋转：**\n$A$ 的特定稀疏结构和 $B$ 的对角形式导致所有后续的凸起元素在应用相应旋转之前都为零。\n让我们系统地验证这一点。\n旋转对 $(Q_k, Z_k)$ 作用于行/列 $(k,k+1)$ 以追逐 $A_{k+1,k-1}$ 和 $B_{k+1,k}$ 处的凸起。\n我们的发现是 $A_2(3,1)=0$ 和 $B_2(3,2)=0$。这导致 $Q_2=I$ 和 $Z_2=I$。因此，$A_4=A_2$ 且 $B_4=B_2$。\n\n**旋转 $G_5(c_5, s_5)$ (左，作用于行3-4)：**消去 $A_4(4,2)$。\n$A_4(4,2) = A_2(4,2) = c_2 A_1(4,2)+s_2 A_1(4,1)$。$A_1$ 的第4行与 $A_0$ 相同，为 $(0,0,0,7,5)$。所以 $A_1(4,1)=0, A_1(4,2)=0 \\implies A_4(4,2)=0$。\n元素为零，所以我们使用单位旋转：\n$$ c_5 = 1, \\quad s_5 = 0 $$\n\n**旋转 $G_6(c_6, s_6)$ (右，作用于列3-4)：**消去 $B_5(4,3)$。\n$B_5=Q_3 B_4=I B_4 = B_4=B_2$。我们需要消去 $B_2(4,3)$。$Z_1$ 和 $Z_2$ 作用于列1-3。$B_2$ 是上三角矩阵。$Z_2=I$。所以 $B_4=B_2$。Q_3=I，所以 $B_5=B_4$。我们需要将 $B_5(4,3) = B_2(4,3)$ 置零。$B_2$ 仅在列1,2上与 $B_1$ 不同。所以 $B_2(4,3)=B_1(4,3)$。$B_1$ 仅在行1,2上与 $B_0$ 不同。所以 $B_1(4,3)=B_0(4,3)=0$。\n元素为零，所以我们使用单位旋转：\n$$ c_6 = 1, \\quad s_6 = 0 $$\n\n**旋转 $G_7(c_7, s_7)$ (左，作用于行4-5)：**消去 $A_6(5,3)$。\n$A_6=A_4=A_2$。我们需要检查 $A_2(5,3)$。$Z_1$ 作用于列1,2。$A_2(:,3)=A_1(:,3)$。$Q_1$ 作用于行1,2。$A_1(5,3)=A_0(5,3)=0$。\n元素为零，所以我们使用单位旋转：\n$$ c_7 = 1, \\quad s_7 = 0 $$\n\n**旋转 $G_8(c_8, s_8)$ (右，作用于列4-5)：**消去 $B_7(5,4)$。\n$B_7=B_5=B_2$。我们需要 $B_2(5,4)$。$Z_1$ 作用于列1,2。$B_2(5,4) = B_1(5,4)$。$Q_1$ 作用于行1,2。$B_1(5,4)=B_0(5,4)=0$。\n元素为零，所以我们使用单位旋转：\n$$ c_8 = 1, \\quad s_8 = 0 $$\n\n### 旋转参数总结\n这8次Givens旋转的参数序列是：\n- $G_1(c_1,s_1): c_1 = 4/5, s_1 = 3/5$\n- $G_2(c_2,s_2): c_2 = 2/\\sqrt{5}, s_2 = 1/\\sqrt{5}$\n- $G_3(c_3,s_3): c_3 = 1, s_3 = 0$\n- $G_4(c_4,s_4): c_4 = 1, s_4 = 0$\n- $G_5(c_5,s_5): c_5 = 1, s_5 = 0$\n- $G_6(c_6,s_6): c_6 = 1, s_6 = 0$\n- $G_7(c_7,s_7): c_7 = 1, s_7 = 0$\n- $G_8(c_8,s_8): c_8 = 1, s_8 = 0$\n\n最终答案以包含这16个标量的单行矩阵形式呈现。",
            "answer": "$$ \\boxed{\\begin{pmatrix} \\frac{4}{5}  \\frac{3}{5}  \\frac{2}{\\sqrt{5}}  \\frac{1}{\\sqrt{5}}  1  0  1  0  1  0  1  0  1  0  1  0 \\end{pmatrix}} $$"
        },
        {
            "introduction": "QZ 算法的输出，即广义 Schur 型，需要我们仔细解读，尤其是在处理一些边界情况时。本练习将揭示无限特征值是如何产生的，更重要的是，它阐明了一种关键的数值策略——将特征值表示为数对 $(\\alpha_i, \\beta_i)$，以避免计算中可能出现的上溢、下溢和精度损失。这是设计鲁棒数值软件的一项核心原则。",
            "id": "3594698",
            "problem": "考虑广义特征值问题 $A x = \\lambda B x$ 及其通过 QZ 算法（广义舒尔分解）约简为一个上三角矩阵对 $(S,T)$，满足 $Q^{\\top} A Z = S$ 和 $Q^{\\top} B Z = T$，其中 $Q$ 和 $Z$ 是正交矩阵，$S$ 和 $T$ 是上三角矩阵。矩阵束 $S - \\lambda T$ 的广义特征值由 $\\det(S - \\lambda T) = 0$ 的根定义，并有如下约定：如果 $T$ 的某个对角元 $t_{ii}$ 为零，而对应的 $s_{ii} \\neq 0$，则相关的特征值为无穷大。\n\n设\n$$\nS = \\begin{pmatrix}\n5  9 \\times 10^{150} \\\\\n0  3 \\times 10^{-200}\n\\end{pmatrix},\\quad\nT = \\begin{pmatrix}\n0  7 \\times 10^{150} \\\\\n0  2 \\times 10^{-200}\n\\end{pmatrix}.\n$$\n$S$ 和 $T$ 均为上三角矩阵，且 $t_{11} = 0$。\n\n仅使用广义舒尔形式的核心定义和性质，(i) 确定矩阵束 $S - \\lambda T$ 的广义特征值，并指明哪个是无穷大特征值，哪个是有限特征值；(ii) 从基本原理出发，解释 QZ 算法在将特征值报告为满足 $\\lambda_i = \\alpha_i / \\beta_i$ 的数对 $(\\alpha_i, \\beta_i)$ 时，为避免数值下溢或上溢而在概念上采用的一种缩放策略。然后，根据给定的 $S$ 和 $T$ 数值计算有限特征值，并将其作为最终报告值。将最终报告值四舍五入至六位有效数字。",
            "solution": "该问题要求找出给定上三角矩阵 $S$ 和 $T$ 的矩阵束 $S - \\lambda T$ 的广义特征值，解释 QZ 算法中使用的数值缩放策略，并计算有限特征值。\n\n### 第 (i) 部分：确定广义特征值\n\n矩阵束 $S - \\lambda T$ 的广义特征值 $\\lambda$ 是满足特征方程 $\\det(S - \\lambda T) = 0$ 的值。给定的矩阵为：\n$$\nS = \\begin{pmatrix}\n5  9 \\times 10^{150} \\\\\n0  3 \\times 10^{-200}\n\\end{pmatrix},\\quad\nT = \\begin{pmatrix}\n0  7 \\times 10^{150} \\\\\n0  2 \\times 10^{-200}\n\\end{pmatrix}\n$$\n矩阵束 $S - \\lambda T$ 为：\n$$\nS - \\lambda T = \\begin{pmatrix}\n5 - \\lambda(0)  (9 \\times 10^{150}) - \\lambda(7 \\times 10^{150}) \\\\\n0 - \\lambda(0)  (3 \\times 10^{-200}) - \\lambda(2 \\times 10^{-200})\n\\end{pmatrix}\n$$\n由于 $S - \\lambda T$ 是一个上三角矩阵，其行列式是对角元素的乘积：\n$$\n\\det(S - \\lambda T) = (s_{11} - \\lambda t_{11})(s_{22} - \\lambda t_{22}) = 0\n$$\n该方程意味着广义特征值由 $s_{ii} - \\lambda t_{ii} = 0$ (对于 $i=1, 2$) 的解给出。\n\n对于第一对对角元，即 $i=1$：\n我们有 $s_{11} = 5$ 和 $t_{11} = 0$。方程为 $5 - \\lambda \\cdot 0 = 0$，简化为 $5 = 0$。这是一个矛盾，表明存在特殊情况。根据问题陈述中的定义，“如果一个对角元 $t_{ii}$ 为零，而对应的 $s_{ii} \\neq 0$，则相关的特征值为无穷大。” 由于 $t_{11}=0$ 且 $s_{11}=5 \\neq 0$，第一个广义特征值 $\\lambda_1$ 是无穷大。\n\n对于第二对对角元，即 $i=2$：\n我们有 $s_{22} = 3 \\times 10^{-200}$ 和 $t_{22} = 2 \\times 10^{-200}$。方程为：\n$$\ns_{22} - \\lambda_2 t_{22} = 0\n$$\n鉴于 $t_{22} = 2 \\times 10^{-200} \\neq 0$，我们可以解出有限特征值 $\\lambda_2$：\n$$\n\\lambda_2 = \\frac{s_{22}}{t_{22}} = \\frac{3 \\times 10^{-200}}{2 \\times 10^{-200}} = \\frac{3}{2} = 1.5\n$$\n因此，有限特征值为 $\\lambda_2 = 1.5$。\n\n### 第 (ii) 部分：缩放策略的解释\n\n在浮点运算中，直接将广义特征值计算为比值 $\\lambda_i = s_{ii} / t_{ii}$ 是数值不稳定的。给定的矩阵完美地说明了这一点。\n\n1.  **上溢和下溢的风险：** 除法 $s_{ii} / t_{ii}$ 可能产生超出浮点数可表示范围的值。例如，如果 $s_{ii}$ 非常大而 $t_{ii}$ 非常小，它们的比值可能导致上溢。相反，如果 $s_{ii}$ 非常小而 $t_{ii}$ 非常大，则可能导致下溢，结果被舍入为零，造成信息丢失。在给定的问题中，$s_{22} = 3 \\times 10^{-200}$ 和 $t_{22} = 2 \\times 10^{-200}$ 这两个值非常小，在标准双精度算术中它们会下溢为 $0$（标准双精度算术的最小正规数约为 $2.2 \\times 10^{-308}$，而单精度的范围要小得多）。如果两者都被视为 $0$，它们的比值就变成了不定式 $0/0$，尽管真实的比值是良态数 $1.5$。\n\n2.  **基本原理策略：** 为避免这些数值风险，QZ 算法的稳健实现（例如 LAPACK 中的实现）不会显式计算比值 $\\lambda_i = s_{ii} / t_{ii}$。取而代之的是，它们将每个广义特征值表示为一个数对 $(\\alpha_i, \\beta_i)$，使得 $\\lambda_i = \\alpha_i / \\beta_i$。从广义舒尔形式 $(S, T)$ 导出的这些数对的自然选择是 $(\\alpha_i, \\beta_i) = (s_{ii}, t_{ii})$。\n\n这种 $(\\alpha_i, \\beta_i)$ 表示法是一个核心特性，它从基本原理上保证了数值稳定性：\n- 它**避免了可能导致上溢或下溢异常的除法运算**，将其留给用户在需要时自行谨慎执行。\n- 它提供了一种**自然且统一的方式来处理无穷大和零特征值**。\n    - 无穷大特征值对应于 $\\beta_i = t_{ii} = 0$ 且 $\\alpha_i = s_{ii} \\neq 0$ 的数对 $(\\alpha_i, \\beta_i)$。对于我们的问题，这个数对是 $(5, 0)$。\n    - 零特征值对应于 $\\alpha_i = s_{ii} = 0$ 且 $\\beta_i = t_{ii} \\neq 0$ 的数对。\n- 它**保存了信息**。通过存储数对 $(s_{ii}, t_{ii})$，该算法保持了原始对角元的量级，防止了在除法之前因数值下溢为零而导致的信息丢失。例如，数对 $(3 \\times 10^{-200}, 2 \\times 10^{-200})$ 正确地编码了特征值 $1.5$，而使用下溢后的值 $(0, 0)$ 进行计算则会失败。\n\n总而言之，通过将特征值报告为数对 $(\\alpha_i, \\beta_i) = (s_{ii}, t_{ii})$，QZ 算法避免了直接除法的数值陷阱，并为所有类型的广义特征值（有限、无穷大和零）提供了一种稳健的表示方法。\n\n### 最终计算\n\n问题要求有限特征值的数值，并四舍五入到六位有效数字。如上计算，有限特征值为：\n$$\n\\lambda_2 = \\frac{s_{22}}{t_{22}} = 1.5\n$$\n将 $1.5$ 表示为六位有效数字得到 $1.50000$。",
            "answer": "$$\\boxed{1.50000}$$"
        },
        {
            "introduction": "有时，计算出的特征值出现较大误差，其根源并非算法不稳定，而是问题本身是“病态”的 (ill-conditioned)。本练习将从第一性原理出发，通过推导条件数来探讨特征值的敏感性概念。它将向您展示，当矩阵 $B$ 接近奇异时，为何某些广义特征值会对微小的扰动变得异常敏感。",
            "id": "3594704",
            "problem": "考虑由矩阵 $A \\in \\mathbb{C}^{4\\times 4}$ 和 $B \\in \\mathbb{C}^{4\\times 4}$ 定义的广义特征问题，其中\n$$\nA = \\operatorname{diag}(1,\\,2,\\,3,\\,4),\\qquad B = \\operatorname{diag}\\!\\left(1,\\,1,\\,1,\\,10^{-4}\\right).\n$$\n这对矩阵已经处于广义舒尔范式（也称为广义舒尔分解或QZ算法范式），因此广义特征值是对角元素之比。\n\n定义 $B$ 沿秩一方向 $E = e_{4} e_{4}^{\\top}$ 的扰动为\n$$\nB(\\varepsilon) = B + \\varepsilon E,\\quad \\varepsilon \\in \\mathbb{R},\n$$\n使得只有 $B$ 的 $(4,4)$ 元素受到扰动。\n\n从满足 $A x = \\lambda B x$ 的广义特征对 $(\\lambda, x)$ 及其满足 $y^{*} A = \\lambda y^{*} B$ 的相应左特征向量 $y$ 的定义出发，在不引用任何已有的扰动公式的情况下，推导在扰动 $B(\\varepsilon)$ 下，对应于第四个对角元素之比的特征值 $\\lambda_{4}(\\varepsilon)$ 的一阶灵敏度。使用定义方程的微分和适当的归一化来获得 $\\left.\\frac{d\\lambda_{4}}{d\\varepsilon}\\right|_{\\varepsilon=0}$ 的显式解析表达式。\n\n然后，通过根据左、右特征向量和双线性形式 $y^{*} B x$ 来解释方向导数，将您的表达式与基于条件数的解释联系起来，并简要解释为什么该特征值对 $B$ 的扰动敏感。\n\n您最终报告的量必须是 $\\left.\\frac{d\\lambda_{4}}{d\\varepsilon}\\right|_{\\varepsilon=0}$ 的精确值。无需四舍五入。不提供单位。",
            "solution": "该问题要求计算矩阵对 $(A, B)$ 的广义特征值 $\\lambda_4$ 关于 $B$ 中特定扰动的一阶灵敏度。我们需要从第一性原理出发进行推导。\n\n设广义特征对为 $(\\lambda(\\varepsilon), x(\\varepsilon))$，它依赖于扰动参数 $\\varepsilon$。定义方程为：\n$$ A x(\\varepsilon) = \\lambda(\\varepsilon) B(\\varepsilon) x(\\varepsilon) $$\n其中 $A = \\operatorname{diag}(1, 2, 3, 4)$，$B(\\varepsilon) = B + \\varepsilon E$，而 $B = \\operatorname{diag}(1, 1, 1, 10^{-4})$ 且 $E = e_4 e_4^T$。向量 $e_4$ 是 $\\mathbb{C}^4$ 中的第四个标准基向量。\n\n首先，我们确定在 $\\varepsilon=0$ 时的未扰动特征值和特征向量。问题是 $A x = \\lambda B x$。由于 $A$ 和 $B$ 是对角矩阵，广义特征值是对角元素之比，即 $\\lambda_i = A_{ii} / B_{ii}$。我们关心的是第四个特征值：\n$$ \\lambda_4(0) \\equiv \\lambda_4 = \\frac{A_{44}}{B_{44}} = \\frac{4}{10^{-4}} = 4 \\times 10^4 $$\n对应的右特征向量是 $x_4(0) \\equiv x_4 = e_4$。左特征向量 $y_4$ 由 $y_4^* A = \\lambda_4 y_4^* B$ 定义。由于 $A$ 和 $B$ 是实对称（对角）矩阵，左特征向量与右特征向量相同，因此 $y_4(0) \\equiv y_4 = e_4$。我们可以验证这一点：\n$e_4^T A = 4 e_4^T$ 且 $\\lambda_4 e_4^T B = (4 \\times 10^4) (10^{-4} e_4^T) = 4 e_4^T$。\n\n为了求出灵敏度，我们对定义方程 $A x(\\varepsilon) = \\lambda(\\varepsilon) B(\\varepsilon) x(\\varepsilon)$ 关于 $\\varepsilon$ 进行微分：\n$$ \\frac{d}{d\\varepsilon} [A x(\\varepsilon)] = \\frac{d}{d\\varepsilon} [\\lambda(\\varepsilon) (B + \\varepsilon E) x(\\varepsilon)] $$\n对两边使用乘法法则（尽管 $A$ 是常数），我们得到：\n$$ A \\frac{dx}{d\\varepsilon} = \\frac{d\\lambda}{d\\varepsilon} (B + \\varepsilon E) x(\\varepsilon) + \\lambda(\\varepsilon) \\left[ \\frac{d}{d\\varepsilon}(B + \\varepsilon E) x(\\varepsilon) + (B + \\varepsilon E) \\frac{dx}{d\\varepsilon} \\right] $$\n$$ A \\dot{x}(\\varepsilon) = \\dot{\\lambda}(\\varepsilon) (B + \\varepsilon E) x(\\varepsilon) + \\lambda(\\varepsilon) \\left[ E x(\\varepsilon) + (B + \\varepsilon E) \\dot{x}(\\varepsilon) \\right] $$\n其中点表示法表示对 $\\varepsilon$ 的微分。\n\n现在，我们在 $\\varepsilon=0$ 处计算该表达式。此时，$\\lambda(0) = \\lambda_4$，$x(0) = x_4$，$B(0)=B$：\n$$ A \\dot{x}(0) = \\dot{\\lambda_4}(0) B x_4 + \\lambda_4 [E x_4 + B \\dot{x}(0)] $$\n为了解出 $\\dot{\\lambda_4}(0)$ 而无需计算 $\\dot{x}(0)$，我们将整个方程左乘左特征向量的共轭转置 $y_4^* = e_4^T$：\n$$ y_4^* A \\dot{x}(0) = \\dot{\\lambda_4}(0) y_4^* B x_4 + \\lambda_4 y_4^* E x_4 + \\lambda_4 y_4^* B \\dot{x}(0) $$\n我们使用左特征向量的定义性质 $y_4^* A = \\lambda_4 y_4^* B$。将其代入等式左侧得到：\n$$ (\\lambda_4 y_4^* B) \\dot{x}(0) = \\dot{\\lambda_4}(0) y_4^* B x_4 + \\lambda_4 y_4^* E x_4 + \\lambda_4 y_4^* B \\dot{x}(0) $$\n项 $\\lambda_4 y_4^* B \\dot{x}(0)$ 在等式两边都出现，因此可以消去，剩下：\n$$ 0 = \\dot{\\lambda_4}(0) y_4^* B x_4 + \\lambda_4 y_4^* E x_4 $$\n这个消去过程表明，对于单特征值，其一阶扰动不依赖于特征向量的一阶扰动。\n\n求解所求的导数 $\\dot{\\lambda_4}(0) = \\left.\\frac{d\\lambda_4}{d\\varepsilon}\\right|_{\\varepsilon=0}$：\n$$ \\dot{\\lambda_4}(0) = - \\lambda_4 \\frac{y_4^* E x_4}{y_4^* B x_4} $$\n这个表达式给出了一阶灵敏度。\n\n现在，我们计算此表达式中的标量：\n- $y_4^* E x_4 = e_4^T (e_4 e_4^T) e_4 = (e_4^T e_4) (e_4^T e_4) = (1)(1) = 1$。这一项表示在特征对“方向”上的扰动大小。\n- $y_4^* B x_4 = e_4^T B e_4 = B_{44} = 10^{-4}$。这一项是特征值条件数的关键部分。\n\n将这些值与 $\\lambda_4 = 4 \\times 10^4$ 一起代入：\n$$ \\left.\\frac{d\\lambda_4}{d\\varepsilon}\\right|_{\\varepsilon=0} = - (4 \\times 10^4) \\frac{1}{10^{-4}} = -4 \\times 10^4 \\times 10^4 = -4 \\times 10^8 $$\n\n推导出的灵敏度表达式 $\\dot{\\lambda_4}(0) = -\\lambda_4 (y_4^* E x_4) / (y_4^* B x_4)$，直接关系到广义特征值问题的条件。灵敏度与双线性形式 $y_4^* B x_4$ 的大小成反比。在本例中，$y_4^* B x_4 = 10^{-4}$，这是一个非常小的数。小的分母导致大的导数，表明特征值 $\\lambda_4$ 对扰动高度敏感。这个特征值是病态的。其原因是矩阵 $B$ 接近奇异（其对角元素之一接近于零）。广义特征值 $\\lambda_4 = A_{44}/B_{44}$ 涉及到除以这个小数。对 $B_{44}$ 的一个小的绝对扰动 $\\varepsilon$ 会导致 $B_{44}$ 的一个大的相对变化，进而导致 $\\lambda_4$ 的一个非常大的绝对变化。导数的巨大数值 $-4 \\times 10^8$ 量化了这种极端的灵敏度。",
            "answer": "$$\\boxed{-4 \\times 10^{8}}$$"
        }
    ]
}