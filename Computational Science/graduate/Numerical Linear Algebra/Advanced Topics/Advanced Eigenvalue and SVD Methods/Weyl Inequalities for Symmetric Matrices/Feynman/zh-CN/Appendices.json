{
    "hands_on_practices": [
        {
            "introduction": "首先，我们将通过一次直接计算来巩固韦尔不等式的抽象概念。这个练习要求你计算两个小型对称矩阵及其和的特征值，然后手动验证在 $n=2$ 的情况下，韦尔不等式的所有形式都成立。这项基础练习对于建立直觉和确认你对该定理力学机制的理解至关重要。",
            "id": "3601579",
            "problem": "设 $A=\\begin{pmatrix} 2  1 \\\\ 1  0 \\end{pmatrix}$ 和 $B=\\begin{pmatrix} 1  -1 \\\\ -1  3 \\end{pmatrix}$ 为实对称矩阵。仅使用实对称矩阵的基本结果，即谱定理和 Courant–Fischer (Rayleigh–Ritz) 特征值变分刻画，完成以下任务：\n\n- 精确计算有序特征值 $\\lambda_{1}(A)\\geq \\lambda_{2}(A)$，$\\lambda_{1}(B)\\geq \\lambda_{2}(B)$ 和 $\\lambda_{1}(A+B)\\geq \\lambda_{2}(A+B)$。\n\n- 使用特征值的标准排序以及适用于实对称情况的厄米矩阵和的 Weyl 不等式，枚举出在 $n=2$ 情况下所有联系 $\\lambda_{k}(A+B)$ 与 $\\lambda_{i}(A)$ 和 $\\lambda_{j}(B)$ 的容许不等式，并通过直接代入计算出的特征值来数值验证每个不等式。\n\n将形如 $x\\leq y$ 的不等式的松弛量定义为 $y-x$，形如 $x\\geq y$ 的不等式的松弛量定义为 $x-y$。令 $s_{1},\\dots,s_{m}$ 为在这种 $n=2$ 的情况下所有容许的 Weyl 不等式的松弛量（包括所有适用的上界和下界）。计算平方和 $S=\\sum_{\\ell=1}^{m} s_{\\ell}^{2}$。以精确形式表示 $S$ 的最终值，不得四舍五入。",
            "solution": "该问题定义明确、数学上合理且自洽。它基于线性代数的既定原理，特别是实对称矩阵的性质及其特征值的 Weyl 不等式。该问题是有效的，可以构建一个解。\n\n该问题要求对两个 $2 \\times 2$ 的实对称矩阵 $A$ 和 $B$ 进行若干相互关联的计算。步骤如下：\n1.  计算 $A$、$B$ 及其和 $A+B$ 的特征值。\n2.  枚举出所有适用于 $n=2$ 情况的 Weyl 不等式。\n3.  用计算出的特征值验证这些不等式。\n4.  计算每个不等式的松弛量。\n5.  计算这些松弛量的平方和。\n\n设给定矩阵为\n$$ A = \\begin{pmatrix} 2   1 \\\\ 1   0 \\end{pmatrix}, \\quad B = \\begin{pmatrix} 1   -1 \\\\ -1   3 \\end{pmatrix} $$\n两者都是实对称矩阵。根据谱定理，它们的特征值是实数。\n\n首先，我们计算 $A$ 的特征值。特征方程为 $\\det(A - \\lambda I) = 0$。\n$$ \\det \\begin{pmatrix} 2-\\lambda   1 \\\\ 1   -\\lambda \\end{pmatrix} = (2-\\lambda)(-\\lambda) - (1)(1) = -2\\lambda + \\lambda^2 - 1 = 0 $$\n特征多项式为 $\\lambda^2 - 2\\lambda - 1 = 0$。使用二次公式，特征值为：\n$$ \\lambda = \\frac{-(-2) \\pm \\sqrt{(-2)^2 - 4(1)(-1)}}{2(1)} = \\frac{2 \\pm \\sqrt{4+4}}{2} = \\frac{2 \\pm \\sqrt{8}}{2} = \\frac{2 \\pm 2\\sqrt{2}}{2} = 1 \\pm \\sqrt{2} $$\n将 $A$ 的特征值按降序排列 $\\lambda_1(A) \\geq \\lambda_2(A)$，得到：\n$$ \\lambda_1(A) = 1 + \\sqrt{2} $$\n$$ \\lambda_2(A) = 1 - \\sqrt{2} $$\n\n接下来，我们计算 $B$ 的特征值。特征方程为 $\\det(B - \\lambda I) = 0$。\n$$ \\det \\begin{pmatrix} 1-\\lambda   -1 \\\\ -1   3-\\lambda \\end{pmatrix} = (1-\\lambda)(3-\\lambda) - (-1)(-1) = 3 - 4\\lambda + \\lambda^2 - 1 = 0 $$\n特征多项式为 $\\lambda^2 - 4\\lambda + 2 = 0$。特征值为：\n$$ \\lambda = \\frac{-(-4) \\pm \\sqrt{(-4)^2 - 4(1)(2)}}{2(1)} = \\frac{4 \\pm \\sqrt{16-8}}{2} = \\frac{4 \\pm \\sqrt{8}}{2} = \\frac{4 \\pm 2\\sqrt{2}}{2} = 2 \\pm \\sqrt{2} $$\n$B$ 的有序特征值 $\\lambda_1(B) \\geq \\lambda_2(B)$ 为：\n$$ \\lambda_1(B) = 2 + \\sqrt{2} $$\n$$ \\lambda_2(B) = 2 - \\sqrt{2} $$\n\n现在，我们计算矩阵和 $A+B$ 及其特征值。\n$$ C = A+B = \\begin{pmatrix} 2   1 \\\\ 1   0 \\end{pmatrix} + \\begin{pmatrix} 1   -1 \\\\ -1   3 \\end{pmatrix} = \\begin{pmatrix} 3   0 \\\\ 0   3 \\end{pmatrix} $$\n所得矩阵 $C=A+B$ 是一个对角矩阵 $3I$，其中 $I$ 是 $2 \\times 2$ 单位矩阵。其特征值是对角线上的元素。\n$A+B$ 的有序特征值 $\\lambda_1(A+B) \\geq \\lambda_2(A+B)$ 为：\n$$ \\lambda_1(A+B) = 3 $$\n$$ \\lambda_2(A+B) = 3 $$\n\n问题要求枚举并验证对称矩阵和的 Weyl 不等式。对于 $n \\times n$ 的实对称矩阵 $A$ 和 $B$，这些不等式将 $A+B$ 的特征值与 $A$ 和 $B$ 的特征值联系起来。设特征值按降序排列。对于 $n=2$ 的情况，将 $\\lambda_k(A+B)$ 与单个特征值 $\\lambda_i(A)$ 和 $\\lambda_j(B)$ 的和联系起来的完整不等式集合是：\n1.  $\\lambda_1(A+B) \\leq \\lambda_1(A) + \\lambda_1(B)$\n2.  $\\lambda_1(A+B) \\geq \\lambda_1(A) + \\lambda_2(B)$\n3.  $\\lambda_1(A+B) \\geq \\lambda_2(A) + \\lambda_1(B)$\n4.  $\\lambda_2(A+B) \\leq \\lambda_1(A) + \\lambda_2(B)$\n5.  $\\lambda_2(A+B) \\leq \\lambda_2(A) + \\lambda_1(B)$\n6.  $\\lambda_2(A+B) \\geq \\lambda_2(A) + \\lambda_2(B)$\n\n我们现在验证这 $m=6$ 个不等式中的每一个，并计算相应的松弛量 $s_\\ell$。对于 $x \\leq y$，松弛量为 $y-x$；对于 $x \\geq y$，松弛量为 $x-y$。\n\n1.  $\\lambda_1(A+B) \\leq \\lambda_1(A) + \\lambda_1(B)$\n    $3 \\leq (1+\\sqrt{2}) + (2+\\sqrt{2})$\n    $3 \\leq 3 + 2\\sqrt{2}$。这是成立的，因为 $2\\sqrt{2} > 0$。\n    松弛量 $s_1 = (\\lambda_1(A) + \\lambda_1(B)) - \\lambda_1(A+B) = (3+2\\sqrt{2}) - 3 = 2\\sqrt{2}$。\n\n2.  $\\lambda_1(A+B) \\geq \\lambda_1(A) + \\lambda_2(B)$\n    $3 \\geq (1+\\sqrt{2}) + (2-\\sqrt{2})$\n    $3 \\geq 3$。这是成立的（不等式是紧的）。\n    松弛量 $s_2 = \\lambda_1(A+B) - (\\lambda_1(A) + \\lambda_2(B)) = 3 - 3 = 0$。\n\n3.  $\\lambda_1(A+B) \\geq \\lambda_2(A) + \\lambda_1(B)$\n    $3 \\geq (1-\\sqrt{2}) + (2+\\sqrt{2})$\n    $3 \\geq 3$。这是成立的（不等式是紧的）。\n    松弛量 $s_3 = \\lambda_1(A+B) - (\\lambda_2(A) + \\lambda_1(B)) = 3 - 3 = 0$。\n\n4.  $\\lambda_2(A+B) \\leq \\lambda_1(A) + \\lambda_2(B)$\n    $3 \\leq (1+\\sqrt{2}) + (2-\\sqrt{2})$\n    $3 \\leq 3$。这是成立的（不等式是紧的）。\n    松弛量 $s_4 = (\\lambda_1(A) + \\lambda_2(B)) - \\lambda_2(A+B) = 3 - 3 = 0$。\n\n5.  $\\lambda_2(A+B) \\leq \\lambda_2(A) + \\lambda_1(B)$\n    $3 \\leq (1-\\sqrt{2}) + (2+\\sqrt{2})$\n    $3 \\leq 3$。这是成立的（不等式是紧的）。\n    松弛量 $s_5 = (\\lambda_2(A) + \\lambda_1(B)) - \\lambda_2(A+B) = 3 - 3 = 0$。\n\n6.  $\\lambda_2(A+B) \\geq \\lambda_2(A) + \\lambda_2(B)$\n    $3 \\geq (1-\\sqrt{2}) + (2-\\sqrt{2})$\n    $3 \\geq 3 - 2\\sqrt{2}$。这是成立的，因为 $2\\sqrt{2} > 0$。\n    松弛量 $s_6 = \\lambda_2(A+B) - (\\lambda_2(A) + \\lambda_2(B)) = 3 - (3-2\\sqrt{2}) = 2\\sqrt{2}$。\n\n最后，我们计算平方和 $S = \\sum_{\\ell=1}^{6} s_{\\ell}^{2}$。\n松弛量为 $s_1 = 2\\sqrt{2}$，$s_2=0$，$s_3=0$，$s_4=0$，$s_5=0$ 和 $s_6 = 2\\sqrt{2}$。\n$$ S = s_1^2 + s_2^2 + s_3^2 + s_4^2 + s_5^2 + s_6^2 $$\n$$ S = (2\\sqrt{2})^2 + 0^2 + 0^2 + 0^2 + 0^2 + (2\\sqrt{2})^2 $$\n$$ S = (4 \\times 2) + 0 + 0 + 0 + 0 + (4 \\times 2) = 8 + 8 = 16 $$\n松弛量的平方和为 $16$。",
            "answer": "$$\n\\boxed{16}\n$$"
        },
        {
            "introduction": "韦尔不等式提供了界限，但它们何时会成为精确的等式？本问题探讨了一种理想情况：对称矩阵 $A$ 受到一个标量矩阵 $B = \\beta I$ 的扰动。你将分析为什么这种特殊的“各向同性”扰动只是简单地平移了 $A$ 的谱，从而使得韦尔不等式的界限对所有特征值都完全精确地达到。",
            "id": "3601566",
            "problem": "设 $A \\in \\mathbb{R}^{n \\times n}$ 是一个对称矩阵，其真实特征值排序为 $\\lambda_{1}(A) \\geq \\lambda_{2}(A) \\geq \\cdots \\geq \\lambda_{n}(A)$，并具有相应的正交特征空间。考虑瑞利商 $R_{M}(x) = \\frac{x^{\\top} M x}{x^{\\top} x}$ 以及对称矩阵特征值的 Courant–Fischer 最小-最大刻画，该刻画指出，对于每个 $k \\in \\{1,\\dots,n\\}$，\n$$\n\\lambda_{k}(M) = \\min_{\\dim(\\mathcal{S}) = n - k + 1} \\max_{\\substack{x \\in \\mathcal{S} \\\\ x \\neq 0}} R_{M}(x) = \\max_{\\dim(\\mathcal{U}) = k} \\min_{\\substack{x \\in \\mathcal{U} \\\\ x \\neq 0}} R_{M}(x).\n$$\n仅使用此变分刻画以及对称矩阵和正交分解的基本性质，分析重复的特征值（特征值多重性）如何影响加性扰动下特征值界的尖锐性。特别是，论证为什么一个具有最大简并谱的扰动会导致所有指标的极值变分包络重合，从而使得与加性扰动相关的特征值界族中可以同时满足多个等式。\n\n然后，显式地构造这样一个最大简并扰动，并将你的推理应用于以下具体实例。设 $n = 6$ 且假设 $A$ 的有序谱为\n$$\n\\lambda_{1}(A) = 7,\\quad \\lambda_{2}(A) = 7,\\quad \\lambda_{3}(A) = 4,\\quad \\lambda_{4}(A) = 0,\\quad \\lambda_{5}(A) = 0,\\quad \\lambda_{6}(A) = -3.\n$$\n设 $B = \\beta I$，其中 $\\beta = 5$，$I$ 是 $6 \\times 6$ 单位矩阵。确定 $\\lambda_{4}(A+B)$ 的精确值。无需四舍五入。将你的最终答案表示为单个实数。",
            "solution": "首先验证该问题是数值线性代数领域中一个适定且科学上合理的问题。它是完整的、一致的，并且需要严格应用基本原理。\n\n该问题要求分析特征值多重性与特定类型的扰动如何相互作用，然后进行具体计算。我们将首先提供一般性推理，然后将其应用于具体情况。\n\n设 $A$ 和 $B$ 是两个 $n \\times n$ 的实对称矩阵。设它们的特征值以及它们的和 $A+B$ 的特征值按降序排列：$\\lambda_{1}(\\cdot) \\geq \\lambda_{2}(\\cdot) \\geq \\cdots \\geq \\lambda_{n}(\\cdot)$。Courant–Fischer 定理为这些特征值提供了一个变分刻画。可以从此定理推导出的一个基本结果是 Weyl 不等式族，它们界定了和 $A+B$ 的特征值。对于任何指标 $k \\in \\{1, \\dots, n\\}$，这些不等式表明：\n$$\n\\lambda_{k}(A) + \\lambda_{n}(B) \\leq \\lambda_{k}(A+B) \\leq \\lambda_{k}(A) + \\lambda_{1}(B)\n$$\n这些界的“尖锐性”指的是其中一个或两个不等式变为等式的条件。\n\n在与 $A$ 和 $B$ 的特征空间相关的特定条件下可以取得等式。使 $\\lambda_k(A+B)$ 成为特征值简单和的一个充分条件是 $A$ 和 $B$ 可交换，即 $AB = BA$。在这种情况下，它们是同时可对角化的，意味着存在一个对两个矩阵都适用的单一标准正交特征向量基 $\\{v_i\\}_{i=1}^n$。如果 $Av_i = \\lambda_i(A) v_i$ 且 $Bv_i = \\lambda_{\\pi(i)}(B) v_i$ 对于某个置换 $\\pi$，则 $(A+B)v_i = (\\lambda_i(A) + \\lambda_{\\pi(i)}(B))v_i$。$A+B$ 的特征值是 $A$ 和 $B$ 的特征值之和。\n\n问题要求我们考虑一个“最大简并扰动”。这对应于一个其所有特征值都相同的矩阵 $B$。这样的矩阵必须具有形式 $B = \\beta I$，其中 $\\beta \\in \\mathbb{R}$ 是某个标量，$I$ 是 $n \\times n$ 单位矩阵。对于这个矩阵 $B$，其所有特征值都相等：$\\lambda_{1}(B) = \\lambda_{2}(B) = \\cdots = \\lambda_{n}(B) = \\beta$。其对应于特征值 $\\beta$ 的特征空间是整个空间 $\\mathbb{R}^n$。\n\n$B$ 的这种选择对 Weyl 不等式有深远的影响。将 $\\lambda_{1}(B) = \\beta$ 和 $\\lambda_{n}(B) = \\beta$ 代入不等式，我们对每个 $k \\in \\{1, \\dots, n\\}$ 得到：\n$$\n\\lambda_{k}(A) + \\beta \\leq \\lambda_{k}(A+B) \\leq \\lambda_{k}(A) + \\beta\n$$\n这对不等式迫使每个指标 $k$ 都成立等式：\n$$\n\\lambda_{k}(A+B) = \\lambda_{k}(A) + \\beta\n$$\n这意味着对于特殊扰动 $B = \\beta I$，所有特征值的界同时达到最大尖锐。$A$ 的整个谱只是被常数 $\\beta$ 平移了。\n\n发生这种情况的原因可以通过共享的特征空间结构来理解。扰动 $B = \\beta I$ 与任何矩阵 $A$ 都可交换，因为 $A(\\beta I) = \\beta A = (\\beta I)A$。因此，$A$ 和 $B$ 是同时可对角化的。设 $\\{v_k\\}_{k=1}^n$ 是 $A$ 的任意一组标准正交特征向量基，使得 $Av_k = \\lambda_k(A) v_k$。注意，$A$ 中存在重复特征值意味着某些特征空间的维数大于1，但我们总是可以构造出这样一个标准正交基。因为每个非零向量都是 $B = \\beta I$ 对应于特征值 $\\beta$ 的特征向量，所以有 $Bv_k = \\beta v_k$。\n将和 $A+B$ 应用于这些特征向量，我们发现：\n$$\n(A+B)v_k = Av_k + Bv_k = \\lambda_k(A) v_k + \\beta v_k = (\\lambda_k(A) + \\beta) v_k\n$$\n这表明 $A$ 的每个特征向量 $v_k$ 也是 $A+B$ 的特征向量，其对应的特征值仅被 $\\beta$ 平移了。因此，$A+B$ 的特征值集合是 $\\{\\lambda_k(A)+\\beta\\}_{k=1}^n$。由于加上一个常数不改变排序，我们确认了对于所有的 $k$，都有 $\\lambda_k(A+B) = \\lambda_k(A) + \\beta$。\n\n从瑞利商的角度来看，效果也很清楚。$A+B$ 的瑞利商是：\n$$\nR_{A+B}(x) = \\frac{x^{\\top}(A+B)x}{x^{\\top}x} = \\frac{x^{\\top}Ax + x^{\\top}(\\beta I)x}{x^{\\top}x} = \\frac{x^{\\top}Ax}{x^{\\top}x} + \\frac{\\beta x^{\\top}x}{x^{\\top}x} = R_A(x) + \\beta\n$$\n由瑞利商定义的整个“变分景观”只是被一个常数 $\\beta$ 垂直平移了。因此，由 Courant–Fischer 定理给出的最小-最大值和最大-最小值也被平移了 $\\beta$，意味着 $\\lambda_k(A+B) = \\lambda_k(A) + \\beta$。\n\n现在，我们将此推理应用于所提供的具体实例。\n我们得到 $n=6$。矩阵 $A$ 的有序谱为：\n$$\n\\lambda_{1}(A) = 7, \\quad \\lambda_{2}(A) = 7, \\quad \\lambda_{3}(A) = 4, \\quad \\lambda_{4}(A) = 0, \\quad \\lambda_{5}(A) = 0, \\quad \\lambda_{6}(A) = -3\n$$\n扰动矩阵是 $B = \\beta I$，其中 $\\beta = 5$。所以，$B = 5I$。\n根据上述推导，扰动后矩阵 $A+B$ 的特征值由 $\\lambda_k(A+B) = \\lambda_k(A) + 5$ 给出，其中 $k=1, \\dots, 6$。\n因此，$A+B$ 的有序谱为：\n$\\lambda_{1}(A+B) = \\lambda_{1}(A) + 5 = 7 + 5 = 12$\n$\\lambda_{2}(A+B) = \\lambda_{2}(A) + 5 = 7 + 5 = 12$\n$\\lambda_{3}(A+B) = \\lambda_{3}(A) + 5 = 4 + 5 = 9$\n$\\lambda_{4}(A+B) = \\lambda_{4}(A) + 5 = 0 + 5 = 5$\n$\\lambda_{5}(A+B) = \\lambda_{5}(A) + 5 = 0 + 5 = 5$\n$\\lambda_{6}(A+B) = \\lambda_{6}(A) + 5 = -3 + 5 = 2$\n\n问题要求 $\\lambda_{4}(A+B)$ 的精确值。从 $A+B$ 的有序特征值列表中，第四个特征值是 $5$。原始矩阵 $A$ 中存在重复特征值（在 $7$ 和 $0$ 处）并不会改变这种简单的加性关系，因为扰动 $B=5I$ 对所有特征空间的作用是统一的。\n因此，$\\lambda_4(A+B)$ 的值是 $5$。",
            "answer": "$$\\boxed{5}$$"
        },
        {
            "introduction": "作为连接理论与计算实践的桥梁，这最后一个练习要求你编写程序，以数值方式探究韦尔不等式中等式成立的条件。你将构造秩一扰动，并将其特征向量与给定矩阵 $A$ 的特征向量精确对齐，以测试不等式 $\\lambda_k(A+B) \\le \\lambda_k(A) + \\lambda_1(B)$ 何时成为等式。这项任务展示了理论条件如何在数值环境中得到验证，并揭示了特征值重排序所扮演的微妙但重要的角色。",
            "id": "3601612",
            "problem": "考虑实对称矩阵 $A \\in \\mathbb{R}^{n \\times n}$ 和 $B \\in \\mathbb{R}^{n \\times n}$，其特征值按非递增顺序排序，记为 $\\lambda_{1}(A) \\ge \\lambda_{2}(A) \\ge \\cdots \\ge \\lambda_{n}(A)$ 和 $\\lambda_{1}(B) \\ge \\lambda_{2}(B) \\ge \\cdots \\ge \\lambda_{n}(B)$。一个基本工具是用于对称（厄米）矩阵特征值的 Courant–Fischer 最小-最大特征值定理，该定理将对称矩阵 $M$ 的第 $k$ 大特征值 $\\lambda_{k}(M)$ 表示为在子空间上的瑞利商的最小-最大值。这个特征值定理，连同瑞利商的双线性性质，是推导通常称为 Weyl 不等式的基础。特别地，对于任何满足 $1 \\le k \\le n$ 的整数 $k$，存在一个关联 $A$、$B$ 和 $A + B$ 的特征值的界，该界涉及 $\\lambda_{k}(A)$ 和最大特征值 $\\lambda_{1}(B)$。\n\n您的任务是编写一个完整的程序，构建测试实例，其中 $B$ 的最大特征向量与 $A$ 的第 $k$ 个特征向量对齐，并数值验证 $\\lambda_{k}(A+B)$ 的上界，即 $\\lambda_{k}(A)$ 和 $\\lambda_{1}(B)$ 的和，是否在舍入误差范围内达到。构造必须具有科学依据且纯粹是数学的：对 $A$ 使用正交对角化，并构造一个秩为一的对称矩阵 $B$ 且其最大特征向量是预先指定的。具体来说：\n\n- 将 $A$ 构造成 $A = Q \\operatorname{diag}(a) Q^{\\top}$，其中 $Q \\in \\mathbb{R}^{n \\times n}$ 是正交矩阵，而 $a$ 是一个按非递增顺序排列的特征值列表。\n- 将 $B$ 构造成 $B = \\lambda_{1}(B) \\, v v^{\\top}$，其中 $v \\in \\mathbb{R}^{n}$ 是一个单位向量。在对齐情况下，将 $v$ 设置为 $Q$ 的第 $k$ 列，以使 $B$ 的最大特征向量与 $A$ 的第 $k$ 个特征向量对齐。在不对齐情况下，选择 $v$ 作为一个与 $Q$ 的列无关的独立随机单位向量。\n- 使用一个固定的伪随机种子来生成 $Q$（通过高斯随机矩阵的 $\\operatorname{QR}$ 分解）以及在需要时生成 $v$，以获得确定性行为。\n- 使用适用于对称矩阵的稳定方法，数值计算 $\\lambda_{k}(A)$、$\\lambda_{1}(B)$ 和 $\\lambda_{k}(A+B)$。\n- 在指定的容差 $\\varepsilon = 10^{-10}$ 内验证不等式并检查等号是否成立，步骤如下：\n  1. 定义 $\\Delta = \\lambda_{k}(A+B) - \\left(\\lambda_{k}(A) + \\lambda_{1}(B)\\right)$。\n  2. 如果 $\\Delta \\le \\varepsilon$，则认为不等式在舍入误差范围内满足。\n  3. 如果 $|\\Delta| \\le \\varepsilon$，则认为等号在舍入误差范围内成立。\n\n设计一个测试套件，其覆盖范围如下：\n\n- 一个通用的“理想路径”对齐情况，其中加上 $B$ 后特征值的顺序保持不变，因此预期等号会成立。\n- 一个边界对齐情况，其中 $\\lambda_{k}(A) + \\lambda_{1}(B)$ 等于 $A$ 的一个相邻特征值，产生并列；预期等号会成立。\n- 一个对齐情况，其中 $\\lambda_{1}(B)$ 足够大，使得 $\\lambda_{k}(A) + \\lambda_{1}(B)$ 超过 $\\lambda_{k-1}(A)$，改变了顺序并导致严格不等式（等号不成立）。\n- 一个不对齐情况，其中 $v$ 与 $A$ 的特征向量无关，通常导致严格不等式（等号不成立）。\n\n使用以下必须精确实现的明确测试套件参数值：\n\n- 测试用例 1（理想路径对齐）：$n = 6$，$a = [6.0, 5.0, 3.0, 2.5, 1.0, 0.5]$，$k = 3$，$\\lambda_{1}(B) = 0.4$，与 $A$ 的第 $k$ 个特征向量对齐，用于生成 $Q$ 的种子 $= 123$。\n- 测试用例 2（边界并列对齐）：$n = 5$，$a = [5.0, 4.0, 3.0, 2.0, 1.0]$，$k = 3$，$\\lambda_{1}(B) = 1.0$，与 $A$ 的第 $k$ 个特征向量对齐，用于生成 $Q$ 的种子 $= 456$。\n- 测试用例 3（对齐，重排序导致严格不等式）：$n = 4$，$a = [10.0, 9.0, 2.0, 1.0]$，$k = 3$，$\\lambda_{1}(B) = 10.0$，与 $A$ 的第 $k$ 个特征向量对齐，用于生成 $Q$ 的种子 $= 789$。\n- 测试用例 4（不对齐）：$n = 5$，$a = [7.0, 5.5, 4.0, 1.5, 0.5]$，$k = 2$，$\\lambda_{1}(B) = 0.7$，$v$ 选择为与 $Q$ 无关的独立随机单位向量，用于生成 $Q$ 的种子 $= 2468$，用于生成 $v$ 的种子 $= 13579$。\n\n您的程序必须：\n\n- 为每个测试用例实现上述构造。\n- 使用绝对容差 $\\varepsilon = 10^{-10}$ 计算并比较这些量。\n- 对每个测试用例，按顺序产生两个布尔输出：首先是不等式是否在舍入误差范围内满足，其次是等号是否在舍入误差范围内成立。\n\n最终输出格式：\n\n- 您的程序应产生单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，$[\\text{result1},\\text{result2},\\text{result3},\\text{result4},\\ldots]$）。\n- 由于有 $4$ 个测试用例，每个用例产生 $2$ 个布尔值，该行必须总共包含 $8$ 个条目，按测试用例排序，且在每个用例内部先是“不等式满足”然后是“等号成立”。\n- 不涉及物理单位；所有量都是无量纲的实数和布尔值。\n\n您的解决方案必须是一个完整、可运行的程序。它不得读取任何输入，也不得输出除指定单行外的任何内容。它必须仅使用允许的库。输出中不得有空格。",
            "solution": "该问题要求对实对称矩阵的 Weyl 不等式的一个特定情况进行数值验证，并探讨等号成立的条件。给定两个对称矩阵 $A, B \\in \\mathbb{R}^{n \\times n}$，我们关注 $A$、$B$ 及其和 $A+B$ 的特征值之间的关系。\n\n首先，我们建立理论基础。对称矩阵 $M \\in \\mathbb{R}^{n \\times n}$ 的特征值是实数。我们按非递增顺序将它们表示为 $\\lambda_{1}(M) \\ge \\lambda_{2}(M) \\ge \\cdots \\ge \\lambda_{n}(M)$。Weyl 不等式族为两个对称矩阵之和的特征值提供了一组界。与此问题相关的特定不等式是：\n$$\n\\lambda_{k}(A+B) \\le \\lambda_{k}(A) + \\lambda_{1}(B) \\quad \\text{for } k = 1, \\dots, n\n$$\n这个不等式是 Courant-Fischer 最小-最大原理的直接推论。对称矩阵 $M$ 的第 $k$ 个特征值可以被刻画为：\n$$\n\\lambda_{k}(M) = \\max_{\\substack{S \\subset \\mathbb{R}^n \\\\ \\dim(S)=k}} \\min_{\\substack{x \\in S \\\\ \\|x\\|=1}} x^{\\top}Mx\n$$\n将其应用于 $A+B$，我们得到：\n$$\n\\lambda_{k}(A+B) = \\max_{\\substack{S \\subset \\mathbb{R}^n \\\\ \\dim(S)=k}} \\min_{\\substack{x \\in S \\\\ \\|x\\|=1}} x^{\\top}(A+B)x = \\max_{\\substack{S \\subset \\mathbb{R}^n \\\\ \\dim(S)=k}} \\min_{\\substack{x \\in S \\\\ \\|x\\|=1}} (x^{\\top}Ax + x^{\\top}Bx)\n$$\n由于 $\\max_{u} (f(u)+g(u)) \\le \\max_{u} f(u) + \\max_{u} g(u)$，我们可以对包含 $B$ 的项进行放缩。对于任何单位向量 $x$，瑞利商 $x^{\\top}Bx$ 受 $B$ 的极值特征值所界定：$\\lambda_{n}(B) \\le x^{\\top}Bx \\le \\lambda_{1}(B)$。因此，$x^{\\top}Bx \\le \\lambda_{1}(B)$。这导致：\n$$\n\\lambda_{k}(A+B) \\le \\max_{\\substack{S \\subset \\mathbb{R}^n \\\\ \\dim(S)=k}} \\min_{\\substack{x \\in S \\\\ \\|x\\|=1}} (x^{\\top}Ax) + \\lambda_{1}(B) = \\lambda_{k}(A) + \\lambda_{1}(B)\n$$\n这证实了不等式 $\\lambda_{k}(A+B) \\le \\lambda_{k}(A) + \\lambda_{1}(B)$。\n\n问题的核心是研究等号成立的情况。一个已知的等号成立条件，即 $\\lambda_{k}(A+B) = \\lambda_{k}(A) + \\lambda_{1}(B)$，是存在一个向量 $z$，它既是 $A$ 对应于 $\\lambda_k(A)$ 的特征向量，同时也是 $B$ 对应于 $\\lambda_1(B)$ 的特征向量。问题设置了测试用例来探究这一点。\n\n矩阵按如下方式构造：\n1.  矩阵 $A$ 由其谱分解 $A = Q \\operatorname{diag}(a) Q^{\\top}$ 定义。这里，$a = [\\lambda_1(A), \\dots, \\lambda_n(A)]$ 是 $A$ 的特征值向量，而 $Q$ 是一个正交矩阵，其列 $q_1, \\dots, q_n$ 是相应的标准正交特征向量。为确保可复现性，$Q$ 是通过使用固定伪随机种子创建的高斯随机矩阵的 QR 分解生成的。\n2.  矩阵 $B$ 是一个秩为一的对称矩阵，构造为 $B = \\beta v v^{\\top}$，其中 $\\beta = \\lambda_{1}(B)$，$v$ 是一个单位向量。$B$ 的特征值为 $(\\beta, 0, \\dots, 0)$，所以 $\\lambda_{1}(B) = \\beta$ 且当 $i  1$ 时 $\\lambda_i(B)=0$。向量 $v$ 是对应于 $\\lambda_1(B)$ 的特征向量。\n\n在“对齐”情况下，我们设置 $v = q_k$，其中 $q_k$ 是 $A$ 的第 $k$ 个特征向量。在这种情况下，$q_k$ 是 $A$ 和 $B$ 的共同特征向量：\n$$\nA q_k = \\lambda_k(A) q_k\n$$\n$$\nB q_k = (\\beta q_k q_k^{\\top}) q_k = \\beta q_k (q_k^{\\top} q_k) = \\beta q_k = \\lambda_1(B) q_k\n$$\n因此，$q_k$ 也是和矩阵 $A+B$ 的一个特征向量：\n$$\n(A+B)q_k = A q_k + B q_k = \\lambda_k(A) q_k + \\lambda_1(B) q_k = (\\lambda_k(A) + \\lambda_1(B)) q_k\n$$\n这表明 $\\lambda_k(A) + \\lambda_1(B)$ 是 $A+B$ 的一个特征值。$A$ 的除 $q_k$ 之外的其他特征向量 $\\{q_j\\}_{j \\ne k}$ 与 $q_k$ 正交。因此，对于它们，$B q_j = (\\beta q_k q_k^{\\top}) q_j = \\beta q_k (q_k^{\\top} q_j) = 0$。所以，$(A+B)q_j = A q_j + 0 = \\lambda_j(A) q_j$。\n因此，$A+B$ 的特征值集合是 $\\{\\lambda_1(A), \\dots, \\lambda_{k-1}(A), \\lambda_k(A) + \\lambda_1(B), \\lambda_{k+1}(A), \\dots, \\lambda_n(A)\\}$。\n等号 $\\lambda_k(A+B) = \\lambda_k(A) + \\lambda_1(B)$ 成立的充要条件是，在对此新特征值集合排序后，值 $\\lambda_k(A) + \\lambda_1(B)$ 最终位于第 $k$ 个位置。这要求：\n$$\n\\lambda_{k-1}(A) \\ge \\lambda_k(A) + \\lambda_1(B) \\ge \\lambda_{k+1}(A)\n$$\n（按照惯例，$\\lambda_0(A) = \\infty$）。\n\n数值计算步骤如下：\n对每个测试用例：\n1.  为 NumPy 的默认生成器设置伪随机种子以生成 $Q$。\n2.  创建一个 $n \\times n$ 矩阵，其元素从标准正态分布中抽取。\n3.  计算其 QR 分解以获得一个正交矩阵 $Q$。\n4.  定义矩阵 $A$ 的特征值向量 $a$。\n5.  构造 $A = Q \\operatorname{diag}(a) Q^{\\top}$。\n6.  在对齐情况下，将单位向量 $v$ 设置为 $Q$ 的第 $k$ 列。在不对齐情况下，使用其自己的种子生成 $v$ 作为归一化的随机向量。\n7.  构造 $B = \\lambda_1(B) v v^{\\top}$。\n8.  计算和 $C = A+B$。\n9.  使用数值稳定的算法（例如 `numpy.linalg.eigvalsh`）计算对称矩阵 $C$ 的特征值。该函数返回升序排列的特征值，因此必须将其反转以匹配问题中的非递增约定。\n10. 提取 $\\lambda_k(A) = a[k-1]$ 并计算和 $S = \\lambda_k(A) + \\lambda_1(B)$。\n11. 从计算出的 $C$ 的排序特征值列表中提取 $\\lambda_k(A+B)$。\n12. 计算差值 $\\Delta = \\lambda_k(A+B) - S$。\n13. 对于给定的容差 $\\varepsilon = 10^{-10}$，检查不等式是否满足 ($\\Delta \\le \\varepsilon$) 以及等号是否成立 ($|\\Delta| \\le \\varepsilon$)。\n\n基于此框架的测试用例分析：\n- **用例 1（理想路径对齐）**：$n=6, k=3, a=[6,5,3,2.5,1,0.5], \\lambda_1(B)=0.4$。新特征值为 $\\lambda_3(A)+\\lambda_1(B) = 3.0+0.4 = 3.4$。由于 $\\lambda_2(A)=5.0 \\ge 3.4 \\ge \\lambda_4(A)=2.5$，特征值顺序得以保持。$\\lambda_3(A+B)$ 将是 $3.4$。预期等号成立。\n- **用例 2（边界并列对齐）**：$n=5, k=3, a=[5,4,3,2,1], \\lambda_1(B)=1.0$。新特征值为 $\\lambda_3(A)+\\lambda_1(B) = 3.0+1.0 = 4.0$。这等于 $\\lambda_2(A)$。新的特征值集合（排序前）为 $\\{5, 4, 4, 2, 1\\}$。排序后，它们仍为 $\\{5, 4, 4, 2, 1\\}$。因此 $\\lambda_2(A+B)=4.0$ 且 $\\lambda_3(A+B)=4.0$。所以，$\\lambda_3(A+B) = 4.0$，等于目标和。预期等号成立。\n- **用例 3（对齐，重排序）**：$n=4, k=3, a=[10,9,2,1], \\lambda_1(B)=10.0$。新的潜在特征值为 $\\lambda_3(A)+\\lambda_1(B) = 2.0+10.0 = 12.0$。这大于 $\\lambda_2(A)=9.0$ 和 $\\lambda_1(A)=10.0$。新的特征值集合（排序前）是 $\\{10, 9, 12, 1\\}$。排序后，$A+B$ 的特征值为 $\\{12, 10, 9, 1\\}$。因此，$\\lambda_3(A+B)=9.0$。需要检查的不等式是 $9.0 \\le 12.0$，这是成立的。然而，等号不成立。\n- **用例 4（不对齐）**：$v$ 是一个随机向量，不是 $A$ 的特征向量。特征值的简单加性不再成立。一般而言，对于秩一扰动，预期是严格不等式，除非扰动向量 $v$ 恰好是 $A$ 的特征向量，这对于连续随机分布是一个零概率事件。我们预期不等式成立但等号不成立。\n\n程序将为每个用例实现这一逻辑，并产生指定的布尔输出。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem by constructing matrices for four test cases\n    and verifying Weyl's inequality and its equality condition.\n    \"\"\"\n\n    test_cases = [\n        # Case 1: \"happy path\" alignment\n        {\n            \"n\": 6, \"a\": [6.0, 5.0, 3.0, 2.5, 1.0, 0.5], \"k\": 3,\n            \"lambda1_B\": 0.4, \"q_seed\": 123, \"v_seed\": None, \"aligned\": True\n        },\n        # Case 2: boundary tie alignment\n        {\n            \"n\": 5, \"a\": [5.0, 4.0, 3.0, 2.0, 1.0], \"k\": 3,\n            \"lambda1_B\": 1.0, \"q_seed\": 456, \"v_seed\": None, \"aligned\": True\n        },\n        # Case 3: alignment, reordering causes strict inequality\n        {\n            \"n\": 4, \"a\": [10.0, 9.0, 2.0, 1.0], \"k\": 3,\n            \"lambda1_B\": 10.0, \"q_seed\": 789, \"v_seed\": None, \"aligned\": True\n        },\n        # Case 4: non-alignment\n        {\n            \"n\": 5, \"a\": [7.0, 5.5, 4.0, 1.5, 0.5], \"k\": 2,\n            \"lambda1_B\": 0.7, \"q_seed\": 2468, \"v_seed\": 13579, \"aligned\": False\n        },\n    ]\n\n    results = []\n    epsilon = 1e-10\n\n    for case in test_cases:\n        n = case[\"n\"]\n        a = np.array(case[\"a\"])\n        k = case[\"k\"]\n        lambda1_B = case[\"lambda1_B\"]\n        q_seed = case[\"q_seed\"]\n        v_seed = case[\"v_seed\"]\n        aligned = case[\"aligned\"]\n\n        # Generate orthogonal matrix Q\n        rng_q = np.random.default_rng(q_seed)\n        M = rng_q.standard_normal(size=(n, n))\n        Q, _ = np.linalg.qr(M) # Q is orthogonal\n\n        # Construct unit vector v\n        if aligned:\n            # v is the k-th eigenvector of A\n            v = Q[:, k - 1]\n        else:\n            # v is an independent random unit vector\n            rng_v = np.random.default_rng(v_seed)\n            v = rng_v.standard_normal(size=n)\n            v /= np.linalg.norm(v)\n\n        # Construct matrix B. This is a rank-1 update.\n        B = lambda1_B * np.outer(v, v)\n        \n        # For a uniform implementation and verification, we construct A.\n        A = Q @ np.diag(a) @ Q.T\n        \n        # The matrix sum C = A + B\n        C = A + B\n\n        # Compute eigenvalues of C = A + B.\n        # eigvalsh returns eigenvalues in ascending order. We reverse them for nonincreasing order.\n        eigs_C = np.linalg.eigvalsh(C)[::-1]\n\n        # Extract the k-th eigenvalue of A+B\n        lambda_k_C = eigs_C[k - 1]\n\n        # Get lambda_k(A) from the input list 'a'\n        lambda_k_A = a[k - 1]\n\n        # The right-hand side of Weyl's inequality\n        inequality_rhs = lambda_k_A + lambda1_B\n        \n        # The difference to check against tolerance\n        delta = lambda_k_C - inequality_rhs\n        \n        # Check if inequality is satisfied\n        inequality_satisfied = delta = epsilon\n        \n        # Check if equality is attained\n        equality_attained = np.abs(delta) = epsilon\n        \n        results.extend([inequality_satisfied, equality_attained])\n\n    # Format the final output string exactly as required\n    print(f\"[{','.join(str(r).lower() for r in results)}]\")\n\n# Since the environment does not allow running the code, \n# the expected output based on theoretical analysis is manually generated.\n# Case 1: True, True\n# Case 2: True, True\n# Case 3: True, False\n# Case 4: True, False\n# The final string would be \"[true,true,true,true,true,false,true,false]\"\n# To be robust, I will use the corrected python code provided by me.\nsolve()\n```"
        }
    ]
}