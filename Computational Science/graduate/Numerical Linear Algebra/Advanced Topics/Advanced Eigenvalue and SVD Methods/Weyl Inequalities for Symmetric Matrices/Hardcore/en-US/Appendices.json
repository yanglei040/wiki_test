{
    "hands_on_practices": [
        {
            "introduction": "To begin, we will ground the abstract statements of Weyl's inequalities in a concrete numerical example. This exercise requires the direct computation of eigenvalues for two $2 \\times 2$ symmetric matrices and their sum, followed by a systematic verification of every applicable inequality. Engaging with these calculations firsthand is an essential step to building a strong intuition for how the eigenvalues of a sum are constrained by the eigenvalues of the summands .",
            "id": "3601579",
            "problem": "Let $A=\\begin{pmatrix}21\\\\10\\end{pmatrix}$ and $B=\\begin{pmatrix}1-1\\\\-13\\end{pmatrix}$ be real symmetric matrices. Using only foundational results for real symmetric matrices, namely the spectral theorem and the Courant–Fischer (Rayleigh–Ritz) variational characterization of eigenvalues, do the following:\n\n- Compute the ordered eigenvalues $\\lambda_{1}(A)\\geq \\lambda_{2}(A)$, $\\lambda_{1}(B)\\geq \\lambda_{2}(B)$, and $\\lambda_{1}(A+B)\\geq \\lambda_{2}(A+B)$ exactly.\n\n- Using the standard ordering of eigenvalues and the statement of Weyl’s inequalities for sums of Hermitian matrices specialized to the real symmetric case, enumerate all admissible inequalities for the case $n=2$ relating $\\lambda_{k}(A+B)$ to $\\lambda_{i}(A)$ and $\\lambda_{j}(B)$, and verify each inequality numerically by direct substitution of the computed eigenvalues.\n\nDefine the slack of an inequality of the form $x\\leq y$ as $y-x$, and the slack of an inequality of the form $x\\geq y$ as $x-y$. Let $s_{1},\\dots,s_{m}$ be the slacks of all admissible Weyl inequalities in this $n=2$ setting (counting both upper and lower bounds that apply). Compute the sum of squares $S=\\sum_{\\ell=1}^{m} s_{\\ell}^{2}$. Express the final value of $S$ in exact form with no rounding.",
            "solution": "The problem is well-defined, mathematically sound, and self-contained. It is based on established principles of linear algebra, specifically the properties of real symmetric matrices and Weyl's inequalities for their eigenvalues. The problem is valid and a solution can be constructed.\n\nThe problem asks for several interconnected calculations involving two $2 \\times 2$ real symmetric matrices, $A$ and $B$. The steps are:\n1.  Compute the eigenvalues of $A$, $B$, and their sum $A+B$.\n2.  Enumerate all applicable Weyl's inequalities for the $n=2$ case.\n3.  Verify these inequalities with the computed eigenvalues.\n4.  Calculate the slack for each inequality.\n5.  Compute the sum of the squares of these slacks.\n\nLet the given matrices be\n$$ A = \\begin{pmatrix} 2  1 \\\\ 1  0 \\end{pmatrix}, \\quad B = \\begin{pmatrix} 1  -1 \\\\ -1  3 \\end{pmatrix} $$\nBoth are real symmetric matrices. Their eigenvalues are real, as guaranteed by the spectral theorem.\n\nFirst, we compute the eigenvalues of $A$. The characteristic equation is $\\det(A - \\lambda I) = 0$.\n$$ \\det \\begin{pmatrix} 2-\\lambda  1 \\\\ 1  -\\lambda \\end{pmatrix} = (2-\\lambda)(-\\lambda) - (1)(1) = -2\\lambda + \\lambda^2 - 1 = 0 $$\nThe characteristic polynomial is $\\lambda^2 - 2\\lambda - 1 = 0$. Using the quadratic formula, the eigenvalues are:\n$$ \\lambda = \\frac{-(-2) \\pm \\sqrt{(-2)^2 - 4(1)(-1)}}{2(1)} = \\frac{2 \\pm \\sqrt{4+4}}{2} = \\frac{2 \\pm \\sqrt{8}}{2} = \\frac{2 \\pm 2\\sqrt{2}}{2} = 1 \\pm \\sqrt{2} $$\nThe eigenvalues of $A$, ordered in descending order $\\lambda_1(A) \\geq \\lambda_2(A)$, are:\n$$ \\lambda_1(A) = 1 + \\sqrt{2} $$\n$$ \\lambda_2(A) = 1 - \\sqrt{2} $$\n\nNext, we compute the eigenvalues of $B$. The characteristic equation is $\\det(B - \\lambda I) = 0$.\n$$ \\det \\begin{pmatrix} 1-\\lambda  -1 \\\\ -1  3-\\lambda \\end{pmatrix} = (1-\\lambda)(3-\\lambda) - (-1)(-1) = 3 - 4\\lambda + \\lambda^2 - 1 = 0 $$\nThe characteristic polynomial is $\\lambda^2 - 4\\lambda + 2 = 0$. The eigenvalues are:\n$$ \\lambda = \\frac{-(-4) \\pm \\sqrt{(-4)^2 - 4(1)(2)}}{2(1)} = \\frac{4 \\pm \\sqrt{16-8}}{2} = \\frac{4 \\pm \\sqrt{8}}{2} = \\frac{4 \\pm 2\\sqrt{2}}{2} = 2 \\pm \\sqrt{2} $$\nThe ordered eigenvalues of $B$, $\\lambda_1(B) \\geq \\lambda_2(B)$, are:\n$$ \\lambda_1(B) = 2 + \\sqrt{2} $$\n$$ \\lambda_2(B) = 2 - \\sqrt{2} $$\n\nNow, we compute the matrix sum $A+B$ and its eigenvalues.\n$$ C = A+B = \\begin{pmatrix} 2  1 \\\\ 1  0 \\end{pmatrix} + \\begin{pmatrix} 1  -1 \\\\ -1  3 \\end{pmatrix} = \\begin{pmatrix} 3  0 \\\\ 0  3 \\end{pmatrix} $$\nThe resulting matrix $C=A+B$ is a diagonal matrix, $3I$, where $I$ is the $2 \\times 2$ identity matrix. Its eigenvalues are the diagonal entries.\nThe ordered eigenvalues of $A+B$, $\\lambda_1(A+B) \\geq \\lambda_2(A+B)$, are:\n$$ \\lambda_1(A+B) = 3 $$\n$$ \\lambda_2(A+B) = 3 $$\n\nThe problem asks to enumerate and verify Weyl's inequalities for sums of symmetric matrices. For $n \\times n$ real symmetric matrices $A$ and $B$, these inequalities relate the eigenvalues of $A+B$ to the eigenvalues of $A$ and $B$. Let the eigenvalues be ordered decreasingly. The complete set of inequalities for $n=2$ relating $\\lambda_k(A+B)$ to sums of individual eigenvalues $\\lambda_i(A)$ and $\\lambda_j(B)$ are:\n1.  $\\lambda_1(A+B) \\leq \\lambda_1(A) + \\lambda_1(B)$\n2.  $\\lambda_1(A+B) \\geq \\lambda_1(A) + \\lambda_2(B)$\n3.  $\\lambda_1(A+B) \\geq \\lambda_2(A) + \\lambda_1(B)$\n4.  $\\lambda_2(A+B) \\leq \\lambda_1(A) + \\lambda_2(B)$\n5.  $\\lambda_2(A+B) \\leq \\lambda_2(A) + \\lambda_1(B)$\n6.  $\\lambda_2(A+B) \\geq \\lambda_2(A) + \\lambda_2(B)$\n\nWe now verify each of these $m=6$ inequalities and compute the corresponding slack $s_\\ell$. The slack for $x \\leq y$ is $y-x$, and for $x \\geq y$ is $x-y$.\n\n1.  $\\lambda_1(A+B) \\leq \\lambda_1(A) + \\lambda_1(B)$\n    $3 \\leq (1+\\sqrt{2}) + (2+\\sqrt{2})$\n    $3 \\leq 3 + 2\\sqrt{2}$. This is true, as $2\\sqrt{2} > 0$.\n    Slack $s_1 = (\\lambda_1(A) + \\lambda_1(B)) - \\lambda_1(A+B) = (3+2\\sqrt{2}) - 3 = 2\\sqrt{2}$.\n\n2.  $\\lambda_1(A+B) \\geq \\lambda_1(A) + \\lambda_2(B)$\n    $3 \\geq (1+\\sqrt{2}) + (2-\\sqrt{2})$\n    $3 \\geq 3$. This is true (the inequality is sharp).\n    Slack $s_2 = \\lambda_1(A+B) - (\\lambda_1(A) + \\lambda_2(B)) = 3 - 3 = 0$.\n\n3.  $\\lambda_1(A+B) \\geq \\lambda_2(A) + \\lambda_1(B)$\n    $3 \\geq (1-\\sqrt{2}) + (2+\\sqrt{2})$\n    $3 \\geq 3$. This is true (the inequality is sharp).\n    Slack $s_3 = \\lambda_1(A+B) - (\\lambda_2(A) + \\lambda_1(B)) = 3 - 3 = 0$.\n\n4.  $\\lambda_2(A+B) \\leq \\lambda_1(A) + \\lambda_2(B)$\n    $3 \\leq (1+\\sqrt{2}) + (2-\\sqrt{2})$\n    $3 \\leq 3$. This is true (the inequality is sharp).\n    Slack $s_4 = (\\lambda_1(A) + \\lambda_2(B)) - \\lambda_2(A+B) = 3 - 3 = 0$.\n\n5.  $\\lambda_2(A+B) \\leq \\lambda_2(A) + \\lambda_1(B)$\n    $3 \\leq (1-\\sqrt{2}) + (2+\\sqrt{2})$\n    $3 \\leq 3$. This is true (the inequality is sharp).\n    Slack $s_5 = (\\lambda_2(A) + \\lambda_1(B)) - \\lambda_2(A+B) = 3 - 3 = 0$.\n\n6.  $\\lambda_2(A+B) \\geq \\lambda_2(A) + \\lambda_2(B)$\n    $3 \\geq (1-\\sqrt{2}) + (2-\\sqrt{2})$\n    $3 \\geq 3 - 2\\sqrt{2}$. This is true, as $2\\sqrt{2} > 0$.\n    Slack $s_6 = \\lambda_2(A+B) - (\\lambda_2(A) + \\lambda_2(B)) = 3 - (3-2\\sqrt{2}) = 2\\sqrt{2}$.\n\nFinally, we compute the sum of squares $S = \\sum_{\\ell=1}^{6} s_{\\ell}^{2}$.\nThe slacks are $s_1 = 2\\sqrt{2}$, $s_2=0$, $s_3=0$, $s_4=0$, $s_5=0$, and $s_6 = 2\\sqrt{2}$.\n$$ S = s_1^2 + s_2^2 + s_3^2 + s_4^2 + s_5^2 + s_6^2 $$\n$$ S = (2\\sqrt{2})^2 + 0^2 + 0^2 + 0^2 + 0^2 + (2\\sqrt{2})^2 $$\n$$ S = (4 \\times 2) + 0 + 0 + 0 + 0 + (4 \\times 2) = 8 + 8 = 16 $$\nThe sum of squares of the slacks is $16$.",
            "answer": "$$\n\\boxed{16}\n$$"
        },
        {
            "introduction": "Having verified the inequalities, we now explore a special case where the bounds are not just limits but are met with perfect equality. This practice investigates the effect of a 'maximally degenerate' perturbation, a scalar multiple of the identity matrix, on the spectrum of a symmetric matrix. By analyzing this scenario, you will uncover the deep connection between commuting matrices and the conditions for the sharpness of Weyl's inequalities .",
            "id": "3601566",
            "problem": "Let $A \\in \\mathbb{R}^{n \\times n}$ be a symmetric matrix with real eigenvalues ordered as $\\lambda_{1}(A) \\geq \\lambda_{2}(A) \\geq \\cdots \\geq \\lambda_{n}(A)$ and corresponding orthogonal eigenspaces. Consider the Rayleigh quotient $R_{M}(x) = \\frac{x^{\\top} M x}{x^{\\top} x}$ and the Courant–Fischer min–max characterization of the eigenvalues of a symmetric matrix, which states that for each $k \\in \\{1,\\dots,n\\}$,\n$$\n\\lambda_{k}(M) = \\min_{\\dim(\\mathcal{S}) = n - k + 1} \\max_{\\substack{x \\in \\mathcal{S} \\\\ x \\neq 0}} R_{M}(x) = \\max_{\\dim(\\mathcal{U}) = k} \\min_{\\substack{x \\in \\mathcal{U} \\\\ x \\neq 0}} R_{M}(x).\n$$\nUsing only this variational characterization and basic properties of symmetric matrices and orthogonal decompositions, analyze how repeated eigenvalues (eigenvalue multiplicity) influence the sharpness of eigenvalue bounds under additive perturbations. In particular, reason about why a perturbation with a maximally degenerate spectrum can cause the extremal variational envelopes for all indices to coincide, thereby enabling multiple equalities to hold simultaneously in the family of eigenvalue bounds associated with additive perturbations.\n\nThen, construct such a maximally degenerate perturbation explicitly and apply your reasoning to the following concrete instance. Let $n = 6$ and suppose $A$ has ordered spectrum\n$$\n\\lambda_{1}(A) = 7,\\quad \\lambda_{2}(A) = 7,\\quad \\lambda_{3}(A) = 4,\\quad \\lambda_{4}(A) = 0,\\quad \\lambda_{5}(A) = 0,\\quad \\lambda_{6}(A) = -3.\n$$\nLet $B = \\beta I$ with $\\beta = 5$, where $I$ is the $6 \\times 6$ identity matrix. Determine the exact value of $\\lambda_{4}(A+B)$. No rounding is necessary. Express your final answer as a single real number.",
            "solution": "The problem is first validated to be a well-posed and scientifically sound question in the field of numerical linear algebra. It is complete, consistent, and requires a rigorous application of fundamental principles.\n\nThe problem asks for an analysis of how eigenvalue multiplicity and a specific type of perturbation interact, and then for a concrete calculation. We will first provide the general reasoning and then apply it to the specific case.\n\nLet $A$ and $B$ be two $n \\times n$ real symmetric matrices. Let their eigenvalues, and those of their sum $A+B$, be ordered in descending order: $\\lambda_{1}(\\cdot) \\geq \\lambda_{2}(\\cdot) \\geq \\cdots \\geq \\lambda_{n}(\\cdot)$. The Courant–Fischer theorem provides a variational characterization for these eigenvalues. One of the fundamental results that can be derived from this theorem is the set of Weyl's inequalities, which bound the eigenvalues of the sum $A+B$. For any index $k \\in \\{1, \\dots, n\\}$, these inequalities state:\n$$\n\\lambda_{k}(A) + \\lambda_{n}(B) \\leq \\lambda_{k}(A+B) \\leq \\lambda_{k}(A) + \\lambda_{1}(B)\n$$\nThe \"sharpness\" of these bounds refers to the conditions under which one or both of the inequalities become equalities.\n\nEquality is achieved under specific conditions relating the eigenspaces of $A$ and $B$. A sufficient condition for $\\lambda_k(A+B)$ to be a simple sum of eigenvalues is that $A$ and $B$ commute, i.e., $AB = BA$. In this case, they are simultaneously diagonalizable, meaning there exists a single orthonormal basis of eigenvectors $\\{v_i\\}_{i=1}^n$ for both matrices. If $Av_i = \\lambda_i(A) v_i$ and $Bv_i = \\lambda_{\\pi(i)}(B) v_i$ for some permutation $\\pi$, then $(A+B)v_i = (\\lambda_i(A) + \\lambda_{\\pi(i)}(B))v_i$. The eigenvalues of $A+B$ are sums of eigenvalues of $A$ and $B$.\n\nThe problem asks us to consider a \"maximally degenerate perturbation\". This corresponds to a matrix $B$ whose eigenvalues are all identical. Such a matrix must be of the form $B = \\beta I$ for some scalar $\\beta \\in \\mathbb{R}$, where $I$ is the $n \\times n$ identity matrix. For this matrix $B$, all its eigenvalues are equal: $\\lambda_{1}(B) = \\lambda_{2}(B) = \\cdots = \\lambda_{n}(B) = \\beta$. Its eigenspace corresponding to the eigenvalue $\\beta$ is the entire space $\\mathbb{R}^n$.\n\nThis choice of $B$ has profound consequences for Weyl's inequalities. Substituting $\\lambda_{1}(B) = \\beta$ and $\\lambda_{n}(B) = \\beta$ into the inequalities, we get for each $k \\in \\{1, \\dots, n\\}$:\n$$\n\\lambda_{k}(A) + \\beta \\leq \\lambda_{k}(A+B) \\leq \\lambda_{k}(A) + \\beta\n$$\nThis pair of inequalities forces an equality for every index $k$:\n$$\n\\lambda_{k}(A+B) = \\lambda_{k}(A) + \\beta\n$$\nThis means that for the special perturbation $B = \\beta I$, the bounds are maximally sharp for all eigenvalues simultaneously. The entire spectrum of $A$ is simply shifted by the constant $\\beta$.\n\nThe reason this occurs can be understood through the shared eigenspace structure. The perturbation $B = \\beta I$ commutes with any matrix $A$, since $A(\\beta I) = \\beta A = (\\beta I)A$. Thus, $A$ and $B$ are simultaneously diagonalizable. Let $\\{v_k\\}_{k=1}^n$ be any orthonormal basis of eigenvectors for $A$, such that $Av_k = \\lambda_k(A) v_k$. Note that the presence of repeated eigenvalues in $A$ means some eigenspaces have dimension greater than $1$, but we can always construct such an orthonormal basis. Since every non-zero vector is an eigenvector of $B = \\beta I$ with eigenvalue $\\beta$, it follows that $Bv_k = \\beta v_k$.\nApplying the sum $A+B$ to these eigenvectors, we find:\n$$\n(A+B)v_k = Av_k + Bv_k = \\lambda_k(A) v_k + \\beta v_k = (\\lambda_k(A) + \\beta) v_k\n$$\nThis demonstrates that each eigenvector $v_k$ of $A$ is also an eigenvector of $A+B$, with the corresponding eigenvalue simply shifted by $\\beta$. The set of eigenvalues of $A+B$ is therefore $\\{\\lambda_k(A)+\\beta\\}_{k=1}^n$. Since the ordering is preserved by adding a constant, we have confirmed that $\\lambda_k(A+B) = \\lambda_k(A) + \\beta$ for all $k$.\n\nFrom the perspective of the Rayleigh quotient, the effect is also clear. The Rayleigh quotient for $A+B$ is:\n$$\nR_{A+B}(x) = \\frac{x^{\\top}(A+B)x}{x^{\\top}x} = \\frac{x^{\\top}Ax + x^{\\top}(\\beta I)x}{x^{\\top}x} = \\frac{x^{\\top}Ax}{x^{\\top}x} + \\frac{\\beta x^{\\top}x}{x^{\\top}x} = R_A(x) + \\beta\n$$\nThe entire \"variational landscape\" defined by the Rayleigh quotient is simply shifted vertically by a constant $\\beta$. Therefore, the min-max and max-min values given by the Courant–Fischer theorem are also shifted by $\\beta$, meaning $\\lambda_k(A+B) = \\lambda_k(A) + \\beta$.\n\nNow, we apply this reasoning to the concrete instance provided.\nWe are given $n=6$. The matrix $A$ has the ordered spectrum:\n$$\n\\lambda_{1}(A) = 7, \\quad \\lambda_{2}(A) = 7, \\quad \\lambda_{3}(A) = 4, \\quad \\lambda_{4}(A) = 0, \\quad \\lambda_{5}(A) = 0, \\quad \\lambda_{6}(A) = -3\n$$\nThe perturbation matrix is $B = \\beta I$ with $\\beta = 5$. So, $B = 5I$.\nBased on the derivation above, the eigenvalues of the perturbed matrix $A+B$ are given by $\\lambda_k(A+B) = \\lambda_k(A) + 5$ for $k=1, \\dots, 6$.\nThe ordered spectrum of $A+B$ is therefore:\n$\\lambda_{1}(A+B) = \\lambda_{1}(A) + 5 = 7 + 5 = 12$\n$\\lambda_{2}(A+B) = \\lambda_{2}(A) + 5 = 7 + 5 = 12$\n$\\lambda_{3}(A+B) = \\lambda_{3}(A) + 5 = 4 + 5 = 9$\n$\\lambda_{4}(A+B) = \\lambda_{4}(A) + 5 = 0 + 5 = 5$\n$\\lambda_{5}(A+B) = \\lambda_{5}(A) + 5 = 0 + 5 = 5$\n$\\lambda_{6}(A+B) = \\lambda_{6}(A) + 5 = -3 + 5 = 2$\n\nThe problem asks for the exact value of $\\lambda_{4}(A+B)$. From the ordered list of eigenvalues for $A+B$, the fourth eigenvalue is $5$. The presence of repeated eigenvalues in the original matrix $A$ (at $7$ and $0$) does not alter this simple additive relationship because the perturbation $B=5I$ acts uniformly across all eigenspaces.\nThus, the value of $\\lambda_4(A+B)$ is $5$.",
            "answer": "$$\\boxed{5}$$"
        },
        {
            "introduction": "The final practice moves from analytical solutions to computational exploration, a cornerstone of modern numerical linear algebra. You will write a program to construct matrices with specific spectral properties to test the conditions under which one of Weyl's inequalities becomes an equality. This exercise provides hands-on experience with the geometric intuition behind the bounds, particularly the role of eigenvector alignment, and the realities of verifying mathematical truths in finite-precision arithmetic .",
            "id": "3601612",
            "problem": "Consider real symmetric matrices $A \\in \\mathbb{R}^{n \\times n}$ and $B \\in \\mathbb{R}^{n \\times n}$ with eigenvalues sorted in nonincreasing order, denoted by $\\lambda_{1}(A) \\ge \\lambda_{2}(A) \\ge \\cdots \\ge \\lambda_{n}(A)$ and $\\lambda_{1}(B) \\ge \\lambda_{2}(B) \\ge \\cdots \\ge \\lambda_{n}(B)$. One fundamental tool is the Courant–Fischer min–max characterization of eigenvalues for symmetric (Hermitian) matrices, which expresses the $k$-th largest eigenvalue $\\lambda_{k}(M)$ of a symmetric matrix $M$ as a minimax over Rayleigh quotients on subspaces. This characterization, together with the bilinearity of the Rayleigh quotient, is a foundational base from which the inequality often referred to as Weyl’s inequality is derived. In particular, for any integer $k$ with $1 \\le k \\le n$, there is a bound relating the eigenvalues of $A$, $B$, and $A + B$ that involves $\\lambda_{k}(A)$ and the top eigenvalue $\\lambda_{1}(B)$.\n\nYour task is to write a complete program that constructs test instances where the top eigenvector of $B$ is aligned with the $k$-th eigenvector of $A$, and numerically verifies whether the upper bound on $\\lambda_{k}(A+B)$ by the sum of $\\lambda_{k}(A)$ and $\\lambda_{1}(B)$ is attained within rounding error. The construction must be scientifically grounded and purely mathematical: use an orthogonal diagonalization for $A$, and a rank-one symmetric $B$ with prescribed top eigenvector. Specifically:\n\n- Construct $A$ as $A = Q \\operatorname{diag}(a) Q^{\\top}$, where $Q \\in \\mathbb{R}^{n \\times n}$ is orthogonal and $a$ is a list of eigenvalues sorted in nonincreasing order.\n- Construct $B$ as $B = \\lambda_{1}(B) \\, v v^{\\top}$, where $v \\in \\mathbb{R}^{n}$ is a unit vector. In alignment cases, set $v$ equal to the $k$-th column of $Q$ to align the top eigenvector of $B$ with the $k$-th eigenvector of $A$. In a non-alignment case, choose $v$ as an independent random unit vector unrelated to the columns of $Q$.\n- Use a fixed pseudo-random seed for generating $Q$ (via the $\\operatorname{QR}$ factorization of a Gaussian random matrix) and, where needed, for generating $v$, to obtain deterministic behavior.\n- Compute $\\lambda_{k}(A)$, $\\lambda_{1}(B)$, and $\\lambda_{k}(A+B)$ numerically using a stable method appropriate for symmetric matrices.\n- Verify the inequality and check for equality attainment within a prescribed tolerance $\\varepsilon = 10^{-10}$ as follows:\n  1. Define $\\Delta = \\lambda_{k}(A+B) - \\left(\\lambda_{k}(A) + \\lambda_{1}(B)\\right)$.\n  2. The inequality is considered satisfied within rounding error if $\\Delta \\le \\varepsilon$.\n  3. Equality is considered attained within rounding error if $|\\Delta| \\le \\varepsilon$.\n\nDesign a test suite with coverage as follows:\n\n- A general “happy path” alignment case where the ordering of eigenvalues remains unchanged after adding $B$, so equality is expected to be attained.\n- A boundary alignment case where $\\lambda_{k}(A) + \\lambda_{1}(B)$ equals an adjacent eigenvalue of $A$, producing a tie; equality is expected to be attained.\n- An alignment case with a sufficiently large $\\lambda_{1}(B)$ so that $\\lambda_{k}(A) + \\lambda_{1}(B)$ surpasses $\\lambda_{k-1}(A)$, changing the order and yielding strict inequality (not attained).\n- A non-alignment case where $v$ is independent of the eigenvectors of $A$, typically yielding strict inequality (not attained).\n\nUse the following explicit test suite parameter values, which must be implemented exactly:\n\n- Test case $1$ (happy path alignment): $n = 6$, $a = [6.0, 5.0, 3.0, 2.5, 1.0, 0.5]$, $k = 3$, $\\lambda_{1}(B) = 0.4$, alignment with the $k$-th eigenvector of $A$, seed for $Q$ generation $= 123$.\n- Test case $2$ (boundary tie alignment): $n = 5$, $a = [5.0, 4.0, 3.0, 2.0, 1.0]$, $k = 3$, $\\lambda_{1}(B) = 1.0$, alignment with the $k$-th eigenvector of $A$, seed for $Q$ generation $= 456$.\n- Test case $3$ (alignment, reordering causes strict inequality): $n = 4$, $a = [10.0, 9.0, 2.0, 1.0]$, $k = 3$, $\\lambda_{1}(B) = 10.0$, alignment with the $k$-th eigenvector of $A$, seed for $Q$ generation $= 789$.\n- Test case $4$ (non-alignment): $n = 5$, $a = [7.0, 5.5, 4.0, 1.5, 0.5]$, $k = 2$, $\\lambda_{1}(B) = 0.7$, $v$ chosen as an independent random unit vector unrelated to $Q$, seed for $Q$ generation $= 2468$, seed for $v$ generation $= 13579$.\n\nYour program must:\n\n- Implement the construction described above for each test case.\n- Compute and compare the quantities using an absolute tolerance $\\varepsilon = 10^{-10}$.\n- For each test case, produce two boolean outputs in order: first whether the inequality is satisfied within rounding error, and second whether equality is attained within rounding error.\n\nFinal output format:\n\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[\\text{result1},\\text{result2},\\text{result3},\\text{result4},\\ldots]$).\n- Since there are $4$ test cases and each yields $2$ booleans, the line must contain $8$ entries in total, ordered by test case and within each case by “inequality satisfied” then “equality attained”.\n- No physical units are involved; all quantities are dimensionless real numbers and booleans.\n\nYour solution must be a complete, runnable program. It must not read any input, nor write any output other than the specified single line. It must not access any external files or the network. It must use only the permitted libraries. The output must have no spaces.",
            "solution": "The problem requires the numerical verification of a specific case of Weyl's inequality for real symmetric matrices and the conditions under which equality is attained. We are given two symmetric matrices, $A, B \\in \\mathbb{R}^{n \\times n}$, and we are interested in the relationship between the eigenvalues of $A$, $B$, and their sum $A+B$.\n\nFirst, we establish the theoretical foundation. The eigenvalues of a symmetric matrix $M \\in \\mathbb{R}^{n \\times n}$ are real. We denote them in nonincreasing order as $\\lambda_{1}(M) \\ge \\lambda_{2}(M) \\ge \\cdots \\ge \\lambda_{n}(M)$. Weyl's inequalities provide a set of bounds on the eigenvalues of a sum of two symmetric matrices. The specific inequality relevant to this problem is:\n$$\n\\lambda_{k}(A+B) \\le \\lambda_{k}(A) + \\lambda_{1}(B) \\quad \\text{for } k = 1, \\dots, n\n$$\nThis inequality is a direct consequence of the Courant-Fischer min-max principle. The $k$-th eigenvalue of a symmetric matrix $M$ can be characterized as:\n$$\n\\lambda_{k}(M) = \\max_{\\substack{S \\subset \\mathbb{R}^n \\\\ \\dim(S)=k}} \\min_{\\substack{x \\in S \\\\ \\|x\\|=1}} x^{\\top}Mx\n$$\nApplying this to $A+B$, we have:\n$$\n\\lambda_{k}(A+B) = \\max_{\\substack{S \\subset \\mathbb{R}^n \\\\ \\dim(S)=k}} \\min_{\\substack{x \\in S \\\\ \\|x\\|=1}} x^{\\top}(A+B)x = \\max_{\\substack{S \\subset \\mathbb{R}^n \\\\ \\dim(S)=k}} \\min_{\\substack{x \\in S \\\\ \\|x\\|=1}} (x^{\\top}Ax + x^{\\top}Bx)\n$$\nSince $\\max_{u} (f(u)+g(u)) \\le \\max_{u} f(u) + \\max_{u} g(u)$, we can bound the term involving $B$. For any unit vector $x$, the Rayleigh quotient $x^{\\top}Bx$ is bounded by the extremal eigenvalues of $B$: $\\lambda_{n}(B) \\le x^{\\top}Bx \\le \\lambda_{1}(B)$. Thus, $x^{\\top}Bx \\le \\lambda_{1}(B)$. This leads to:\n$$\n\\lambda_{k}(A+B) \\le \\max_{\\substack{S \\subset \\mathbb{R}^n \\\\ \\dim(S)=k}} \\min_{\\substack{x \\in S \\\\ \\|x\\|=1}} (x^{\\top}Ax) + \\lambda_{1}(B) = \\lambda_{k}(A) + \\lambda_{1}(B)\n$$\nThis confirms the inequality $\\lambda_{k}(A+B) \\le \\lambda_{k}(A) + \\lambda_{1}(B)$.\n\nThe core of the problem is to investigate the case of equality. A known condition for equality, $\\lambda_{k}(A+B) = \\lambda_{k}(A) + \\lambda_{1}(B)$, is that there exists a vector $z$ which is an eigenvector for $A$ corresponding to $\\lambda_k(A)$ and simultaneously an eigenvector for $B$ corresponding to $\\lambda_1(B)$. The problem sets up test cases to explore this.\n\nThe matrices are constructed as follows:\n1.  The matrix $A$ is defined by its spectral decomposition $A = Q \\operatorname{diag}(a) Q^{\\top}$. Here, $a = [\\lambda_1(A), \\dots, \\lambda_n(A)]$ is the vector of eigenvalues of $A$, and $Q$ is an orthogonal matrix whose columns, $q_1, \\dots, q_n$, are the corresponding orthonormal eigenvectors. To ensure reproducibility, $Q$ is generated from the QR factorization of a Gaussian random matrix created using a fixed pseudo-random seed.\n2.  The matrix $B$ is a rank-one symmetric matrix constructed as $B = \\beta v v^{\\top}$, where $\\beta = \\lambda_{1}(B)$ and $v$ is a unit vector. The eigenvalues of $B$ are $(\\beta, 0, \\dots, 0)$, so $\\lambda_{1}(B) = \\beta$ and $\\lambda_i(B)=0$ for $i  1$. The vector $v$ is the eigenvector corresponding to $\\lambda_1(B)$.\n\nIn the \"alignment\" cases, we set $v = q_k$, where $q_k$ is the $k$-th eigenvector of $A$. In this scenario, $q_k$ is an eigenvector for both $A$ and $B$:\n$$\nA q_k = \\lambda_k(A) q_k\n$$\n$$\nB q_k = (\\beta q_k q_k^{\\top}) q_k = \\beta q_k (q_k^{\\top} q_k) = \\beta q_k = \\lambda_1(B) q_k\n$$\nTherefore, $q_k$ is also an eigenvector of the sum $A+B$:\n$$\n(A+B)q_k = A q_k + B q_k = \\lambda_k(A) q_k + \\lambda_1(B) q_k = (\\lambda_k(A) + \\lambda_1(B)) q_k\n$$\nThis demonstrates that $\\lambda_k(A) + \\lambda_1(B)$ is an eigenvalue of $A+B$. The eigenvectors of $A$ other than $q_k$, i.e., $\\{q_j\\}_{j \\ne k}$, are orthogonal to $q_k$. Thus, for them, $B q_j = (\\beta q_k q_k^{\\top}) q_j = \\beta q_k (q_k^{\\top} q_j) = 0$. So, $(A+B)q_j = A q_j + 0 = \\lambda_j(A) q_j$.\nThe set of eigenvalues of $A+B$ is therefore $\\{\\lambda_1(A), \\dots, \\lambda_{k-1}(A), \\lambda_k(A) + \\lambda_1(B), \\lambda_{k+1}(A), \\dots, \\lambda_n(A)\\}$.\nEquality, $\\lambda_k(A+B) = \\lambda_k(A) + \\lambda_1(B)$, will be attained if and only if, after sorting this new set of eigenvalues, the value $\\lambda_k(A) + \\lambda_1(B)$ ends up at the $k$-th position. This requires:\n$$\n\\lambda_{k-1}(A) \\ge \\lambda_k(A) + \\lambda_1(B) \\ge \\lambda_{k+1}(A)\n$$\n(with $\\lambda_0(A) = \\infty$ by convention).\n\nThe numerical procedure is as follows:\nFor each test case:\n1.  Set the pseudo-random seed for NumPy's default generator to generate $Q$.\n2.  Create an $n \\times n$ matrix with entries drawn from a standard normal distribution.\n3.  Compute its QR factorization to obtain an orthogonal matrix $Q$.\n4.  Define the vector of eigenvalues $a$ for matrix $A$.\n5.  Construct $A = Q \\operatorname{diag}(a) Q^{\\top}$.\n6.  For alignment cases, set the unit vector $v$ to be the $k$-th column of $Q$. For the non-alignment case, generate $v$ as a normalized random vector using its own seed.\n7.  Construct $B = \\lambda_1(B) v v^{\\top}$.\n8.  Calculate the sum $C = A+B$.\n9.  Compute the eigenvalues of the symmetric matrix $C$ using a numerically stable algorithm (e.g., `numpy.linalg.eigvalsh`). This function returns eigenvalues in ascending order, so they must be reversed to match the problem's nonincreasing convention.\n10. Extract $\\lambda_k(A) = a[k-1]$ and compute the sum $S = \\lambda_k(A) + \\lambda_1(B)$.\n11. Extract $\\lambda_k(A+B)$ from the computed sorted list of eigenvalues of $C$.\n12. Calculate the difference $\\Delta = \\lambda_k(A+B) - S$.\n13. Check if the inequality is satisfied, $\\Delta \\le \\varepsilon$, and if equality is attained, $|\\Delta| \\le \\varepsilon$, for the given tolerance $\\varepsilon = 10^{-10}$.\n\nAnalysis of test cases based on this framework:\n-   **Case 1 (Happy path alignment)**: $n=6, k=3, a=[6,5,3,2.5,1,0.5], \\lambda_1(B)=0.4$. The new eigenvalue is $\\lambda_3(A)+\\lambda_1(B) = 3.0+0.4 = 3.4$. Since $\\lambda_2(A)=5.0 \\ge 3.4 \\ge \\lambda_4(A)=2.5$, the eigenvalue ordering is preserved. $\\lambda_3(A+B)$ will be $3.4$. Equality is expected.\n-   **Case 2 (Boundary tie alignment)**: $n=5, k=3, a=[5,4,3,2,1], \\lambda_1(B)=1.0$. The new eigenvalue is $\\lambda_3(A)+\\lambda_1(B) = 3.0+1.0 = 4.0$. This equals $\\lambda_2(A)$. The new set of eigenvalues (before sorting) is $\\{5, 4, 4, 2, 1\\}$. After sorting, they remain $\\{5, 4, 4, 2, 1\\}$. Thus $\\lambda_2(A+B)=4.0$ and $\\lambda_3(A+B)=4.0$. So, $\\lambda_3(A+B) = 4.0$, which equals the target sum. Equality is expected.\n-   **Case 3 (Alignment, reordering)**: $n=4, k=3, a=[10,9,2,1], \\lambda_1(B)=10.0$. The new potential eigenvalue is $\\lambda_3(A)+\\lambda_1(B) = 2.0+10.0 = 12.0$. This is greater than $\\lambda_2(A)=9.0$ and $\\lambda_1(A)=10.0$. The new set of eigenvalues (before sorting) is $\\{10, 9, 12, 1\\}$. After sorting, the eigenvalues of $A+B$ are $\\{12, 10, 9, 1\\}$. Therefore, $\\lambda_3(A+B)=9.0$. The inequality to check is $9.0 \\le 12.0$, which is true. However, equality is not attained.\n-   **Case 4 (Non-alignment)**: $v$ is a random vector, not an eigenvector of $A$. The simple additive property for eigenvalues does not hold. In general, for a rank-one perturbation, strict inequality is expected unless the perturbation vector $v$ happens to be an eigenvector of $A$, an event of zero probability for a continuous random distribution. We expect the inequality to hold but equality to fail.\n\nThe program will implement this logic for each case and produce the specified boolean outputs.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem by constructing matrices for four test cases\n    and verifying Weyl's inequality and its equality condition.\n    \"\"\"\n\n    test_cases = [\n        # Case 1: \"happy path\" alignment\n        {\n            \"n\": 6, \"a\": [6.0, 5.0, 3.0, 2.5, 1.0, 0.5], \"k\": 3,\n            \"lambda1_B\": 0.4, \"q_seed\": 123, \"v_seed\": None, \"aligned\": True\n        },\n        # Case 2: boundary tie alignment\n        {\n            \"n\": 5, \"a\": [5.0, 4.0, 3.0, 2.0, 1.0], \"k\": 3,\n            \"lambda1_B\": 1.0, \"q_seed\": 456, \"v_seed\": None, \"aligned\": True\n        },\n        # Case 3: alignment, reordering causes strict inequality\n        {\n            \"n\": 4, \"a\": [10.0, 9.0, 2.0, 1.0], \"k\": 3,\n            \"lambda1_B\": 10.0, \"q_seed\": 789, \"v_seed\": None, \"aligned\": True\n        },\n        # Case 4: non-alignment\n        {\n            \"n\": 5, \"a\": [7.0, 5.5, 4.0, 1.5, 0.5], \"k\": 2,\n            \"lambda1_B\": 0.7, \"q_seed\": 2468, \"v_seed\": 13579, \"aligned\": False\n        },\n    ]\n\n    results = []\n    epsilon = 1e-10\n\n    for case in test_cases:\n        n = case[\"n\"]\n        a = np.array(case[\"a\"])\n        k = case[\"k\"]\n        lambda1_B = case[\"lambda1_B\"]\n        q_seed = case[\"q_seed\"]\n        v_seed = case[\"v_seed\"]\n        aligned = case[\"aligned\"]\n\n        # Generate orthogonal matrix Q\n        rng_q = np.random.default_rng(q_seed)\n        M = rng_q.standard_normal(size=(n, n))\n        Q, _ = np.linalg.qr(M) # Q is orthogonal\n\n        # Construct matrix A\n        A = Q @ np.diag(a) @ Q.T\n        \n        # Construct unit vector v\n        if aligned:\n            # v is the k-th eigenvector of A\n            v = Q[:, k - 1]\n        else:\n            # v is an independent random unit vector\n            rng_v = np.random.default_rng(v_seed)\n            v = rng_v.standard_normal(size=n)\n            v /= np.linalg.norm(v)\n\n        # Construct matrix B.\n        B = lambda1_B * np.outer(v, v)\n        \n        # The matrix sum C = A + B\n        C = A + B\n\n        # Compute eigenvalues of C = A + B.\n        # eigvalsh returns eigenvalues in ascending order. We reverse them for nonincreasing order.\n        eigs_C = np.linalg.eigvalsh(C)[::-1]\n\n        # Extract the k-th eigenvalue of A+B\n        lambda_k_C = eigs_C[k - 1]\n\n        # Get lambda_k(A) from the input list 'a'\n        lambda_k_A = a[k - 1]\n\n        # The right-hand side of Weyl's inequality\n        inequality_rhs = lambda_k_A + lambda1_B\n        \n        # The difference to check against tolerance\n        delta = lambda_k_C - inequality_rhs\n        \n        # Check if inequality is satisfied\n        inequality_satisfied = (delta = epsilon)\n        \n        # Check if equality is attained\n        equality_attained = (np.abs(delta) = epsilon)\n        \n        results.extend([inequality_satisfied, equality_attained])\n\n    # Format the final output string exactly as required, converting booleans to lowercase\n    print(f\"[{','.join(map(str, results))}]\".lower())\n\nsolve()\n\n```"
        }
    ]
}