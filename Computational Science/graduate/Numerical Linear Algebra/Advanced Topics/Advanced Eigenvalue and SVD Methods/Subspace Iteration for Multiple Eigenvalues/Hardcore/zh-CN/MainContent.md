## 引言
在[数值线性代数](@entry_id:144418)和科学计算的广阔领域中，求解大型矩阵的[特征值问题](@entry_id:142153)是一项基础而核心的任务。虽然[幂法](@entry_id:148021)等经典算法能有效找到单个主导[特征值](@entry_id:154894)，但许多现代应用，从[主成分分析](@entry_id:145395)（PCA）到[结构动力学](@entry_id:172684)模拟，都要求我们同时计算多个[特征值](@entry_id:154894)及其对应的[不变子空间](@entry_id:152829)。这便引出了一个关键的挑战：如何将单向量迭代的思想高效地扩展到一个[子空间](@entry_id:150286)上？[子空间迭代](@entry_id:168266)法正是为解决这一问题而生，它提供了一个强大而灵活的框架。本文旨在全面剖析这一重要算法。在接下来的章节中，我们将首先深入“原理与机制”，建立从瑞利-里兹投影到[收敛性分析](@entry_id:151547)的坚实理论基础；随后，在“应用与[交叉](@entry_id:147634)学科联系”中，我们将探索该方法在数据科学、[高性能计算](@entry_id:169980)等前沿领域的实际应用与高级变体；最后，通过“动手实践”，你将有机会通过具体编码练习来巩固关键的理论概念。通过这一系列的学习，读者将掌握[子空间迭代](@entry_id:168266)的核心思想与实践技巧。

## 原理与机制

在理解了[子空间迭代](@entry_id:168266)的基本思想之后，本章将深入探讨其核心的数学原理与算法机制。我们将从瑞利-里兹（Rayleigh-Ritz）[投影法](@entry_id:144836)开始，建立从一个给定[子空间](@entry_id:150286)中提取最优特征近似的框架。随后，我们将引入[主交角](@entry_id:201254)（principal angles）这一关键工具，用以[精确度](@entry_id:143382)量[子空间](@entry_id:150286)之间的“距离”，从而为[收敛性分析](@entry_id:151547)奠定几何基础。本章的重点在于剖析算法的收敛行为，我们将分别探讨对称/[正规矩阵](@entry_id:185943)和[非正规矩阵](@entry_id:752668)这两种情形下的[收敛理论](@entry_id:176137)，并揭示后者所带来的独特挑战。最后，我们将转向实践层面，讨论如何选择合适的算法参数（如块大小），以及如何设计基于残差（residual）的有效[停止准则](@entry_id:136282)。

### [子空间迭代](@entry_id:168266)与瑞利-里兹过程

基本的[子空间迭代](@entry_id:168266)可以看作是[幂法](@entry_id:148021)（power method）向多个向量的直接推广。始于一个$n \times p$的列满秩矩阵$Y_0$，其列[向量张成](@entry_id:152883)初始[子空间](@entry_id:150286)$\mathcal{Y}_0$，迭代过程如下：
$$
Z_{k+1} = A Y_k, \quad Z_{k+1} = Y_{k+1} R_{k+1}
$$
其中，第二步是一个QR分解，它将矩阵$Z_{k+1}$正交化，得到一个列向量标准正交的矩阵$Y_{k+1}$，其[列空间](@entry_id:156444)与$Z_{k+1}$相同，即 $\operatorname{span}(Y_{k+1}) = \operatorname{span}(A Y_k)$。这个过程反复将矩阵$A$作用于整个[子空间](@entry_id:150286)，从而放大与较大[特征值](@entry_id:154894)相关联的分量。

然而，仅仅[迭代子](@entry_id:200280)空间本身是不够的。在每一步，我们都希望从当前[子空间](@entry_id:150286)$\mathcal{Y}_k = \operatorname{span}(Y_k)$中提取出关于原矩阵$A$的[特征值](@entry_id:154894)和[特征向量](@entry_id:151813)的最佳近似。这正是**瑞利-里兹过程**（也称为里兹-[伽辽金投影](@entry_id:145611)法，Ritz-Galerkin projection）的核心任务。

该过程基于**[伽辽金原理](@entry_id:167636)**（Galerkin principle），即要求近似解的残差与近似所在的[子空间](@entry_id:150286)正交。假设我们想在[子空间](@entry_id:150286)$\mathcal{Y}_k$中寻找$A$的一个近似特征对$(\theta, u)$，其中$u \in \mathcal{Y}_k$且$u \neq 0$。[伽辽金条件](@entry_id:173975)要求[残差向量](@entry_id:165091)$r = Au - \theta u$与$\mathcal{Y}_k$中的所有向量正交。由于$Y_k$的列向量构成了$\mathcal{Y}_k$的一组标准正交基，该条件可以简洁地写为：
$$
Y_k^* (A u - \theta u) = 0
$$
其中$Y_k^*$是$Y_k$的[共轭转置](@entry_id:147909)。

因为近似[特征向量](@entry_id:151813)$u$必须位于$\mathcal{Y}_k$中，所以它可以表示为$u = Y_k y$，其中$y \in \mathbb{C}^p$是$u$在$Y_k$基下的[坐标向量](@entry_id:153319)。将$u = Y_k y$代入[伽辽金条件](@entry_id:173975)，我们得到：
$$
Y_k^* (A (Y_k y) - \theta (Y_k y)) = 0
$$
整理后得到：
$$
(Y_k^* A Y_k) y = \theta (Y_k^* Y_k) y
$$
由于$Y_k$的列是标准正交的，我们有$Y_k^* Y_k = I_p$（$p \times p$的单位矩阵）。令$T_k = Y_k^* A Y_k$，这是一个$p \times p$的小矩阵，称为$A$在[子空间](@entry_id:150286)$\mathcal{Y}_k$上的**[瑞利商](@entry_id:137794)矩阵**或[投影矩阵](@entry_id:154479)。上述方程简化为一个标准的$p$维[特征值问题](@entry_id:142153)：
$$
T_k y = \theta y
$$
这个小规模[特征值问题](@entry_id:142153)的解提供了我们所寻求的近似。
- $T_k$的[特征值](@entry_id:154894)$\theta_i$被称为**[里兹值](@entry_id:145862)**（Ritz values），它们是原矩阵$A$的[特征值](@entry_id:154894)的近似。
- $T_k$的[特征向量](@entry_id:151813)$y_i$是[坐标向量](@entry_id:153319)。
- 相应的**里兹向量**（Ritz vectors）$u_i = Y_k y_i$是原矩阵$A$的[特征向量](@entry_id:151813)在[子空间](@entry_id:150286)$\mathcal{Y}_k$中的最佳近似。
这一对$(\theta_i, u_i)$被称为**里兹对**（Ritz pair）。

因此，现代的[子空间迭代](@entry_id:168266)算法通常包含这一瑞利-里兹提取步骤，它不仅提供了对[特征值](@entry_id:154894)和[特征向量](@entry_id:151813)的近似，而且对于加速收敛至关重要。

### 度量误差：[子空间](@entry_id:150286)之间的[主交角](@entry_id:201254)

为了分析[子空间迭代](@entry_id:168266)的收敛性，我们必须首先建立一个度量标准，用以量化算法在第$k$步生成的[子空间](@entry_id:150286)$\mathcal{Y}_k$与目标不变子空间$\mathcal{U}$之间的“距离”。仅仅比较[基向量](@entry_id:199546)是不可靠的，因为同一个[子空间](@entry_id:150286)可以有无穷多组不同的基。我们需要一个内蕴于[子空间](@entry_id:150286)几何结构的度量。

这个度量由**[主交角](@entry_id:201254)**（principal angles）提供。给定两个$p$维[子空间](@entry_id:150286)$\mathcal{S}$和$\mathcal{T}$，分别由[标准正交基](@entry_id:147779)矩阵$Q_{\mathcal{S}}$和$Q_{\mathcal{T}}$张成。它们之间的关系可以通过$p \times p$的**[交叉](@entry_id:147634)格拉姆矩阵**（cross-Gram matrix）$C = Q_{\mathcal{S}}^* Q_{\mathcal{T}}$来刻画。对$C$进行[奇异值分解](@entry_id:138057)（SVD）：
$$
C = U \Sigma V^*, \quad \text{其中 } \Sigma = \operatorname{diag}(\sigma_1, \sigma_2, \dots, \sigma_p)
$$
奇异值$\sigma_i$满足$1 \ge \sigma_1 \ge \dots \ge \sigma_p \ge 0$。这$p$个奇异值在几何上编码了两个[子空间](@entry_id:150286)相互对齐的程度。

$p$个[主交角](@entry_id:201254)$\phi_i \in [0, \pi/2]$定义为：
$$
\phi_i = \arccos(\sigma_i), \quad \text{对于 } i=1, \dots, p
$$
由于$\arccos$是单调递减函数，[主交角](@entry_id:201254)是按非降序[排列](@entry_id:136432)的：$0 \le \phi_1 \le \dots \le \phi_p \le \pi/2$。这些角度是两个[子空间](@entry_id:150286)的内蕴属性，不依赖于基的选择。
- 如果$\phi_i = 0$，意味着$\sigma_i=1$，两个[子空间](@entry_id:150286)在该“方向”上完美重合。
- 如果$\phi_i = \pi/2$，意味着$\sigma_i=0$，两个[子空间](@entry_id:150286)在该“方向”上相互正交。
- 如果$\mathcal{S} = \mathcal{T}$，那么所有$\phi_i=0$。

在[收敛性分析](@entry_id:151547)中，最重要的通常是**最大[主交角](@entry_id:201254)**$\phi_{\max} = \phi_p$。它捕捉了两个[子空间](@entry_id:150286)之间最坏情况下的偏离。一个常用的误差度量是$\sin(\phi_{\max})$，它可以直接通过算子范数计算：
$$
\sin(\phi_{\max}) = \|(I - P_{\mathcal{S}}) Q_{\mathcal{T}}\|_2 = \|P_{\mathcal{S}}^{\perp} P_{\mathcal{T}}\|_2
$$
其中$P_{\mathcal{S}} = Q_{\mathcal{S}} Q_{\mathcal{S}}^*$和$P_{\mathcal{T}} = Q_{\mathcal{T}} Q_{\mathcal{T}}^*$分别是到$\mathcal{S}$和$\mathcal{T}$上的正交投影算子。这个量仅当$\mathcal{S} = \mathcal{T}$时才为零。当[子空间迭代](@entry_id:168266)收敛时，我们期望所有[主交角](@entry_id:201254)都趋向于零。

### [收敛性分析](@entry_id:151547)

[子空间迭代](@entry_id:168266)的[收敛速度](@entry_id:636873)取决于矩阵$A$的谱特性以及迭代块大小$p$的选择。我们将分开讨论对称/[正规矩阵](@entry_id:185943)和[非正规矩阵](@entry_id:752668)这两种情况，因为它们的行为有着本质的区别。

#### 对称与正规情形

对于对称矩阵（在[复数域](@entry_id:153768)中，更一般地是[正规矩阵](@entry_id:185943)，即满足$A^*A = AA^*$的矩阵），存在一个由标准正交的[特征向量](@entry_id:151813)构成的完[整基](@entry_id:190217)。这极大地简化了[收敛性分析](@entry_id:151547)。

假设我们的目标是找到与前$m$个[绝对值](@entry_id:147688)最大的[特征值](@entry_id:154894)$\{\lambda_1, \dots, \lambda_m\}$对应的不变子空间$\mathcal{U}$，并且存在一个谱隙（spectral gap），即$|\lambda_m| > |\lambda_{m+1}|$。如果我们使用一个块大小为$p \ge m$的[子空间迭代](@entry_id:168266)，可以证明，[迭代子](@entry_id:200280)空间$\mathcal{Y}_k$与目标[子空间](@entry_id:150286)$\mathcal{U}$之间的最大[主交角](@entry_id:201254)$\phi_{\max}^{(k)}$会以几何级数收敛到零。具体来说，其正切值满足如下经典界：
$$
\tan(\phi_{\max}^{(k+1)}) \le \frac{|\lambda_{p+1}|}{|\lambda_m|} \tan(\phi_{\max}^{(k)})
$$
这个不等式清晰地表明，收敛速度由比率$|\lambda_{p+1}|/|\lambda_m|$决定。这个比率越小，收敛越快。这揭示了选择块大小$p$的一个关键动机：通过增大$p$，我们可以将$\lambda_{p+1}$推向谱的更深处，从而减小收敛因子 。

为了更深刻地理解这个收敛因子，我们可以引入一个非常优雅的视角：**[外代数](@entry_id:201164)**（exterior algebra）。一个$p$维[子空间](@entry_id:150286)$\mathcal{Y} = \operatorname{span}\{y_1, \dots, y_p\}$可以由一个简单的$p$-向量（或称[楔积](@entry_id:147029)，wedge product）$w = y_1 \wedge y_2 \wedge \dots \wedge y_p$在$p$次外幂空间$\Lambda^p(\mathbb{C}^n)$中表示。[子空间迭代](@entry_id:168266)$A\mathcal{Y}$对应于一个在$\Lambda^p(\mathbb{C}^n)$上诱导的[线性算子](@entry_id:149003)$\mathcal{A}$的作用，其定义为$\mathcal{A}(y_1 \wedge \dots \wedge y_p) = Ay_1 \wedge \dots \wedge Ay_p$。

如果$A$的[特征向量](@entry_id:151813)是$v_i$，那么$\mathcal{A}$的[特征向量](@entry_id:151813)就是这些$v_i$的楔积，例如$v_{i_1} \wedge \dots \wedge v_{i_p}$，其对应的[特征值](@entry_id:154894)为$\lambda_{i_1} \cdots \lambda_{i_p}$。从这个角度看，[子空间迭代](@entry_id:168266)无非是在外幂空间$\Lambda^p(\mathbb{C}^n)$上对诱导算子$\mathcal{A}$执行的[幂法](@entry_id:148021)。其[收敛速度](@entry_id:636873)由$\mathcal{A}$的第二大[特征值](@entry_id:154894)（[绝对值](@entry_id:147688)）与最大[特征值](@entry_id:154894)（[绝对值](@entry_id:147688)）之比决定。
- $\mathcal{A}$的[主特征值](@entry_id:142677)是 $\Lambda_{\text{dom}} = \lambda_1 \lambda_2 \cdots \lambda_p$。
- $\mathcal{A}$的次[主特征值](@entry_id:142677)是 $\Lambda_{\text{sec}} = \lambda_1 \cdots \lambda_{p-1} \lambda_{p+1}$。

收敛因子因此是：
$$
\rho = \frac{|\Lambda_{\text{sec}}|}{|\Lambda_{\text{dom}}|} = \frac{|\lambda_1 \cdots \lambda_{p-1} \lambda_{p+1}|}{|\lambda_1 \cdots \lambda_{p-1} \lambda_p|} = \frac{|\lambda_{p+1}|}{|\lambda_p|}
$$
这为[收敛率](@entry_id:146534)提供了一个深刻的代数解释，并再次确认了收敛速度由谱隙决定的基本原理。

#### 非正规情形

当矩阵$A$非正规时（即$A^*A \neq AA^*$），情况变得复杂得多。其[特征向量](@entry_id:151813)可能不再正交，甚至可能无法形成一个完整的基（即矩阵是亏损的，defective）。

在这种情况下，收敛性不仅取决于[特征值](@entry_id:154894)的[分布](@entry_id:182848)，还严重依赖于[特征向量](@entry_id:151813)的几何结构。这个几何结构可以通过**[特征基](@entry_id:151409)的条件数**$\kappa_2(V) = \|V\|_2 \|V^{-1}\|_2$来量化，其中$V$是由$A$的[特征向量](@entry_id:151813)构成的矩阵。对于[正规矩阵](@entry_id:185943)，可以选择$V$为酉矩阵，$\kappa_2(V)=1$。对于高度非正规的矩阵，$\kappa_2(V)$可能非常大。收敛界现在包含这个条件数：
$$
\|\tan\Theta_k\|_2 \le \kappa_2(V)^2 \left( \frac{|\lambda_{p+1}|}{|\lambda_m|} \right)^k \|\tan\Theta_0\|_2
$$
其中$\Theta_k$是[主交角](@entry_id:201254)的[对角矩阵](@entry_id:637782)。这个界表明，一个大的[条件数](@entry_id:145150)$\kappa_2(V)$会显著放大初始误差，导致收敛在初始阶段（前渐近阶段）非常缓慢，即使谱比率$|\lambda_{p+1}|/|\lambda_m|$很小。

更进一步，[非正规矩阵](@entry_id:752668)的行为与其**伪谱**（pseudospectrum）密切相关。[伪谱](@entry_id:138878)$\Lambda_{\epsilon}(A)$是复平面上这样一个点的集合，在这些点$z$上，矩阵的[预解式](@entry_id:199555)范数$\|(zI-A)^{-1}\|_2$很大。大的[预解式](@entry_id:199555)范数是$A$[非正规性](@entry_id:752585)的一个标志，它会导致幂次$A^k$的范数出现**[瞬时增长](@entry_id:263654)**（transient growth）现象，即$\|A^k\|$在最终衰减到$(\rho(A))^k$之前，可能会经历一个显著增长的阶段。

在[子空间迭代](@entry_id:168266)中，这种[瞬时增长](@entry_id:263654)可能导致[迭代子](@entry_id:200280)空间暂时偏离目标不变子空间，即使[特征值](@entry_id:154894)本身是良好分离的。这表现为[主交角](@entry_id:201254)的非单调行为：角度可能在收敛之前暂时增大或停滞。因此，对于非正规问题，仅仅依赖[特征值](@entry_id:154894)谱隙来预测收敛行为是不可靠的。

此外，[非正规矩阵](@entry_id:752668)的左、右[特征向量](@entry_id:151813)（或[不变子空间](@entry_id:152829)）通常是不同的。标准的瑞利-里兹过程（[伽辽金法](@entry_id:749698)）只使用一个试探[子空间](@entry_id:150286)，无法同时有效地逼近左右两个不变子空间。为了解决这个问题，需要采用**双边[投影法](@entry_id:144836)**（two-sided projection），如**[彼得罗夫-伽辽金](@entry_id:174072)**（[Petrov-Galerkin](@entry_id:174072)）方法。这种方法使用两个不同的[子空间](@entry_id:150286)：一个用于逼近右不变子空间的试探[子空间](@entry_id:150286)$\mathcal{Y}$，另一个用于逼近左不变子空间（即$A^*$的右不变子空间）的测试[子空间](@entry_id:150286)$\mathcal{Z}$。这会产生**双正交里兹对**，它们能更稳定地处理非正交的本征结构，是求解[非对称特征值问题](@entry_id:752671)的标准工具。

### 算法设计与实践考量

理论分析为我们提供了设计和使用[子空间迭代](@entry_id:168266)算法时的指导原则。

#### 块大小的选择

如何选择块大小$p$是[子空间迭代](@entry_id:168266)中的一个核心问题，它涉及到[收敛速度](@entry_id:636873)和计算成本之间的权衡。

1.  **基本要求**：要计算一个$m$维的不变子空间，块大小$p$必须至少为$m$。如果$p < m$，迭代产生的[子空间](@entry_id:150286)维数不足，无法包含整个目标[子空间](@entry_id:150286)，因此不可能收敛到正确的目标。

2.  **处理簇和重根**：收敛速度取决于谱隙$|\lambda_p| - |\lambda_{p+1}|$。如果目标[特征值](@entry_id:154894)$\{\lambda_1, \dots, \lambda_m\}$形成一个紧密的簇，即$\lambda_m \approx \lambda_{m+1}$，那么选择$p=m$会导致收敛因子$|\lambda_{m+1}/\lambda_m| \approx 1$，收敛将极其缓慢。正确的策略是**[过采样](@entry_id:270705)**（oversampling），即选择$p > m$，使得$p$跨过整个[特征值](@entry_id:154894)簇，从而在$\lambda_p$和$\lambda_{p+1}$之间形成一个显著的[谱隙](@entry_id:144877)。这能显著提高[收敛速度](@entry_id:636873)。因此，块大小$p$必须大到足以包含所有感兴趣的[特征值](@entry_id:154894)，以及任何与它们紧密聚集的[特征值](@entry_id:154894)。[子空间迭代](@entry_id:168266)方法天然地收敛到与整个[特征值](@entry_id:154894)簇相关联的不变子空间，而不是簇内的单个[特征向量](@entry_id:151813)。对于[亏损矩阵](@entry_id:184234)，其目标则是与[代数重数](@entry_id:154240)相对应的广义特征空间。

3.  **计算成本权衡**：增加块大小$p$可以提高收敛速度（即减少迭代次数），但每一步迭代的计算成本也会增加。一次迭代的主要计算开销包括：
    - 矩阵-块乘法 $A Y_k$：对于一个有$z$个非零元的稀疏矩阵$A$，成本约为$O(zp)$。
    - [正交化](@entry_id:149208) $Y_{k+1}$：使用格拉姆-施密特等方法，成本约为$O(np^2)$。
    - 求解小型投影问题 $T_k = Y_k^* A Y_k$：形成$T_k$并求解其[特征值](@entry_id:154894)，成本约为$O(np^2 + p^3)$。
    总成本主要由$O(np^2)$项主导。成本随$p$超[线性增长](@entry_id:157553)，而收敛速度的提升通常有收益递减的效应。因此，选择$p$是一个需要在总计算时间上进行优化的权衡过程。

#### [停止准则](@entry_id:136282)与误差估计

在实际计算中，我们无法直接计算[迭代子](@entry_id:200280)空间与真实不变子空间之间的[主交角](@entry_id:201254)，因为后者是未知的。因此，我们需要一个可计算的量来[估计误差](@entry_id:263890)，并据此决定何时停止迭代。这个量就是**残差**。

对于一个里兹对$(\theta, u)$，其残差向量是$r = Au - \theta u$。直观上，如果$(\theta, u)$是$A$的精确特征对，残差将为零。如果它们是好的近似，残差的范数$\|r\|_2$应该很小。

**戴维斯-卡汉（Davis-Kahan）$\sin\Theta$定理**为这种直观感觉提供了严格的理论支撑。对于[对称矩阵](@entry_id:143130)，该定理的一个重要推论给出了[子空间](@entry_id:150286)误差（以[主交角](@entry_id:201254)正弦的范数度量）与残差[矩阵范数](@entry_id:139520)之间的关系：
$$
\|\sin\Theta(\mathcal{Y}, \mathcal{U})\|_F \le \frac{\|R\|_F}{\delta}
$$
这里，$\mathcal{Y}$是里兹向量张成的[子空间](@entry_id:150286)，$\mathcal{U}$是目标[不变子空间](@entry_id:152829)，$\Theta$是它们之间的[主交角](@entry_id:201254)矩阵，$\|\cdot\|_F$表示[弗罗贝尼乌斯范数](@entry_id:143384)。$R = AY - Y\Theta$是残差矩阵，其列为各个里兹向量的残差。$\delta$是目标[特征值](@entry_id:154894)簇与矩阵其余谱之间的**谱隙**。

这个不等式是设计**[停止准则](@entry_id:136282)**的基石。假设我们的目标是达到的[子空间](@entry_id:150286)误差容忍度为$\tau$，即要求$\|\sin\Theta\|_2 \le \tau$（注意$\|X\|_2 \le \|X\|_F$）。为了确保满足这个要求，我们可以要求其[弗罗贝尼乌斯范数](@entry_id:143384)满足更强的条件，即$\|\sin\Theta\|_F \le \tau$。通过戴维斯-卡汉不等式，只要我们能确保$\frac{\|R\|_F}{\delta} \le \tau$，目标即可达成。这导出了一个非常实用的[停止准则](@entry_id:136282)：当计算出的残差矩阵满足以下条件时，停止迭代：
$$
\|R\|_F \le \tau \cdot \delta
$$
这个准则将不可直接计算的几何误差与在每一步迭代中都可计算的[残差范数](@entry_id:754273)联系起来。

为了更具体地理解残差与[主交角](@entry_id:201254)之间的联系，我们可以考虑一个简单的例子。对于一个具有两个[特征值](@entry_id:154894)$\alpha$和$\beta$的对称矩阵$A$，其对应的里兹[残差范数](@entry_id:754273)与[主交角](@entry_id:201254)$\phi_i$之间有一个精确的关系：
$$
\| r_{i} \|_2 = | \alpha - \beta | \sin(\phi_{i}) \cos(\phi_{i})
$$
这个公式清晰地表明，当[主交角](@entry_id:201254)$\phi_i$很小时，[残差范数](@entry_id:754273)与$\phi_i$成正比（因为$\cos\phi_i \approx 1, \sin\phi_i \approx \phi_i$）。这再次印证了[残差范数](@entry_id:754273)是衡量收敛性的一个优良指标。