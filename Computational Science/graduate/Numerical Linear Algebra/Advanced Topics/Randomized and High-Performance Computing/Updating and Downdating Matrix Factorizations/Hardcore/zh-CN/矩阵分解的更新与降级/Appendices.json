{
    "hands_on_practices": [
        {
            "introduction": "本实践将引导你掌握QR分解降级的基本机制。当从原始矩阵中移除一列时，其R因子的上三角结构会受到破坏，通常会产生一个不应存在的次对角线元素。本练习将通过一个具体的例子，一步步地指导你如何运用一系列吉文斯旋转（Givens rotations）来精确地消除这个不速之客，并恢复矩阵的上梯形结构，从而让你对更新过程建立起扎实的基础理解。",
            "id": "3600365",
            "problem": "令 $n=3$ 和 $m=5$。考虑一个实矩阵 $A \\in \\mathbb{R}^{n \\times m}$，它具有正交-三角（QR）分解 $A = Q R$，其中 $Q \\in \\mathbb{R}^{3 \\times 3}$ 是正交矩阵，$R \\in \\mathbb{R}^{3 \\times 5}$ 是上梯形矩阵，其前导 $3 \\times 3$ 子块为上三角矩阵。假设因子 $R$ 为\n$$\nR \\;=\\;\n\\begin{pmatrix}\n2  1  2  0  3 \\\\\n0  5  3  1  2 \\\\\n0  0  4  2  1\n\\end{pmatrix}.\n$$\n我们移除 $A$ 的第二列（因此也移除 $R$ 的第二列），以形成一个降级（downdated）矩阵 $A' \\in \\mathbb{R}^{3 \\times 4}$ 和一个通过删除 $R$ 的第二列得到的中间矩阵 $R_{\\text{del}} \\in \\mathbb{R}^{3 \\times 4}$。仅使用正交变换和吉文斯（Givens）旋转的基本性质，通过明确指定应用于 $R_{\\text{del}}$ 的吉文斯旋转序列来执行 QR 降级，以恢复其上梯形结构，并使其前导 $3 \\times 3$ 子块为上三角矩阵。特别地，从第一性原理推导旋转参数，并将其应用于受影响的列，以消除因删除列而引入的次对角线元素。\n\n作为最终答案，报告前导三角块中第二列更新后的对角线元素的确切值，即 $r'_{22}$。提供确切值，无需四舍五入。",
            "solution": "该问题陈述经核实具有科学依据、问题设定良好且客观。这是数值线性代数中一个标准练习，涉及在移除一列后对 QR 分解进行降级。所有必要的数据均已提供，任务定义明确。\n\n出发点是给定一个矩阵 $A \\in \\mathbb{R}^{3 \\times 5}$ 的上梯形因子 $R \\in \\mathbb{R}^{3 \\times 5}$。\n$$\nR \\;=\\;\n\\begin{pmatrix}\n2  1  2  0  3 \\\\\n0  5  3  1  2 \\\\\n0  0  4  2  1\n\\end{pmatrix}.\n$$\n问题指明，移除原始矩阵 $A$ 的第二列，这对应于移除 $R$ 的第二列。此操作产生一个中间矩阵 $R_{\\text{del}} \\in \\mathbb{R}^{3 \\times 4}$。\n$$\nR_{\\text{del}} \\;=\\;\n\\begin{pmatrix}\n2  2  0  3 \\\\\n0  3  1  2 \\\\\n0  4  2  1\n\\end{pmatrix}.\n$$\n由于位置 $(3, 2)$ 处的非零元素 $r_{32} = 4$，矩阵 $R_{\\text{del}}$ 不再是上梯形形式。这种第一条次对角线下方的所有元素都为零的结构被称为上海森堡（upper Hessenberg）形式。\n\n为了恢复上梯形形式，我们必须在位置 $(3, 2)$ 引入一个零。这可以通过将 $R_{\\text{del}}$ 左乘一个合适的正交矩阵来实现，该矩阵旋转第二行和第三行。吉文斯旋转是为此目的设计的基本正交变换。我们寻求一个吉文斯旋转矩阵 $G_{23} \\in \\mathbb{R}^{3 \\times 3}$，它作用于由第二和第三个标准基向量张成的平面。该矩阵具有以下形式：\n$$\nG_{23} =\n\\begin{pmatrix}\n1  0  0 \\\\\n0  c  s \\\\\n0  -s  c\n\\end{pmatrix}\n$$\n其中 $c = \\cos(\\theta)$ 和 $s = \\sin(\\theta)$，对于某个角度 $\\theta$，满足条件 $c^2 + s^2 = 1$。\n\n新的上梯形矩阵，我们称之为 $R'$，通过乘积 $R' = G_{23} R_{\\text{del}}$ 得到。该变换只影响 $R_{\\text{del}}$ 的第二行和第三行。设 $R_{\\text{del}}$ 的第二行和第三行分别为 $\\mathbf{r}_2^T = \\begin{pmatrix} 0  3  1  2 \\end{pmatrix}$ 和 $\\mathbf{r}_3^T = \\begin{pmatrix} 0  4  2  1 \\end{pmatrix}$。新的第二行和第三行 $\\mathbf{r'}_2^T$ 和 $\\mathbf{r'}_3^T$ 将是旧行的线性组合：\n$$\n\\begin{pmatrix} \\mathbf{r'}_2^T \\\\ \\mathbf{r'}_3^T \\end{pmatrix} = \\begin{pmatrix} c  s \\\\ -s  c \\end{pmatrix} \\begin{pmatrix} \\mathbf{r}_2^T \\\\ \\mathbf{r}_3^T \\end{pmatrix}.\n$$\n参数 $c$ 和 $s$ 由一个要求确定，即所得矩阵 $R'$ 中位置 $(3, 2)$ 的元素变为零。此条件适用于 $R_{\\text{del}}$ 的第二列，特别是子向量 $\\begin{pmatrix} 3 \\\\ 4 \\end{pmatrix}$。我们要求：\n$$\n\\begin{pmatrix} c  s \\\\ -s  c \\end{pmatrix} \\begin{pmatrix} 3 \\\\ 4 \\end{pmatrix} = \\begin{pmatrix} r'_{22} \\\\ 0 \\end{pmatrix}\n$$\n其中 $r'_{22}$ 是新的对角线元素。这个矩阵-向量方程产生一个由两个线性方程组成的方程组：\n$1.$ $3c + 4s = r'_{22}$\n$2.$ $-3s + 4c = 0$\n\n从第二个方程，我们得到 $4c = 3s$。我们可以用 $c$ 表示 $s$，即 $s = \\frac{4}{3}c$。将此代入恒等式 $c^2+s^2=1$：\n$$ c^2 + \\left(\\frac{4}{3}c\\right)^2 = 1 \\implies c^2 + \\frac{16}{9}c^2 = 1 \\implies \\frac{25}{9}c^2 = 1 \\implies c^2 = \\frac{9}{25}. $$\n吉文斯旋转的一个标准约定是为 $c$ 选择正根，所以 $c = \\frac{3}{5}$。因此，$s = \\frac{4}{3}c = \\frac{4}{3} \\cdot \\frac{3}{5} = \\frac{4}{5}$。\n\n这些 $c$ 和 $s$ 的值定义了具体的吉文斯旋转。我们现在可以使用第一个方程计算新的对角线元素 $r'_{22}$：\n$$ r'_{22} = 3c + 4s = 3\\left(\\frac{3}{5}\\right) + 4\\left(\\frac{4}{5}\\right) = \\frac{9}{5} + \\frac{16}{5} = \\frac{25}{5} = 5. $$\n另外，对于一个设计用来使用主元 $a$ 将元素 $b$ 置零的吉文斯旋转，新的主元值总是向量 $\\begin{pmatrix} a \\\\ b \\end{pmatrix}$ 的欧几里得范数。在我们的例子中，$a = 3$ 和 $b = 4$，所以 $r'_{22} = \\sqrt{3^2 + 4^2} = \\sqrt{9+16} = \\sqrt{25} = 5$。这证实了我们的计算。\n\n问题要求的是 $r'_{22}$，我们已经找到了。为了完整起见，我们可以计算整个更新后的矩阵 $R'$。第一行保持不变。新的第二行和第三行是：\n$$\n\\mathbf{r'}_2^T = c \\mathbf{r}_2^T + s \\mathbf{r}_3^T = \\frac{3}{5}\\begin{pmatrix} 0  3  1  2 \\end{pmatrix} + \\frac{4}{5}\\begin{pmatrix} 0  4  2  1 \\end{pmatrix} = \\begin{pmatrix} 0  \\frac{9+16}{5}  \\frac{3+8}{5}  \\frac{6+4}{5} \\end{pmatrix} = \\begin{pmatrix} 0  5  \\frac{11}{5}  2 \\end{pmatrix}.\n$$\n$$\n\\mathbf{r'}_3^T = -s \\mathbf{r}_2^T + c \\mathbf{r}_3^T = -\\frac{4}{5}\\begin{pmatrix} 0  3  1  2 \\end{pmatrix} + \\frac{3}{5}\\begin{pmatrix} 0  4  2  1 \\end{pmatrix} = \\begin{pmatrix} 0  \\frac{-12+12}{5}  \\frac{-4+6}{5}  \\frac{-8+3}{5} \\end{pmatrix} = \\begin{pmatrix} 0  0  \\frac{2}{5}  -1 \\end{pmatrix}.\n$$\n完全更新后的矩阵 $R'$ 是：\n$$\nR' =\n\\begin{pmatrix}\n2  2  0  3 \\\\\n0  5  \\frac{11}{5}  2 \\\\\n0  0  \\frac{2}{5}  -1\n\\end{pmatrix}.\n$$\n这个矩阵是所要求的上梯形形式，其前导 $3 \\times 3$ 子块是上三角矩阵。位置 $(2, 2)$ 的值确实是 $5$。\n\n所要求的具体值是第二列更新后的对角线元素，$r'_{22}$。\n$$\nr'_{22} = 5.\n$$",
            "answer": "$$\n\\boxed{5}\n$$"
        },
        {
            "introduction": "在掌握了降级操作的基本方法后，我们必须面对一个更关键的问题：数值稳定性。本实践通过一个精心设计的思想实验，揭示了朴素降级算法潜在的风险。你将看到，对矩阵的一个看似微不足道的秩一修改，可能会导致一个原本合适的对角主元变得极小，从而在分解过程中产生巨大的因子元素，这种现象被称为“元素增长”（element growth）。这个练习旨在警示我们，为何在更新和降级分解时，必须重新审视主元选择策略以保证算法的稳健性。",
            "id": "3600385",
            "problem": "考虑一个对称矩阵 $A \\in \\mathbb{R}^{3 \\times 3}$ 的下-对角-下转置 ($LDL^{T}$) 分解，其中 $L$ 是单位下三角矩阵，$D$ 是对角矩阵。已知 $A$ 是单位矩阵，因此 $A = I_{3}$，$L = I_{3}$，$D = I_{3}$。定义对称秩-1降阶更新\n$$\nA_{-} = A - u u^{T}\n$$\n其中 $u = \\begin{pmatrix} 1 - \\delta \\\\ 1 \\\\ 0 \\end{pmatrix}$ 且 $\\delta = 10^{-8}$。一个不重新考虑主元选择的朴素 $LDL^{T}$ 降阶更新方法是，强制第一个主元保持为索引1处的 $1 \\times 1$ 主元，并直接在 $A_{-}$ 上执行第一步对称消元，而不改变主元顺序或切换到 $2 \\times 2$ 主元。在这一步中，令 $\\tilde{d}_{1}$ 表示更新后的第一个对角主元，$\\tilde{L}_{21}$ 表示更新后的第一列次对角乘子。\n\n仅从 $LDL^{T}$ 分解的定义、恒等式 $A = L D L^{T}$ 以及降阶更新的定义 $A_{-} = A - u u^{T}$ 出发，推导出这个朴素的第一步所产生的 $\\tilde{L}_{21}$ 的显式表达式，并根据上述数据计算其大小。您的答案必须是 $\\left|\\tilde{L}_{21}\\right|$ 的数值。将答案四舍五入到四位有效数字。\n\n简要说明为什么这是一个反例，证明了不重新选择主元的朴素 $LDL^{T}$ 降阶更新会导致大的元素增长或算法崩溃，并用更新后的主元和乘子来解释其机制。除了所述定义之外，不得使用任何额外的假设或外部公式。",
            "solution": "该问题是有效的，因为它提出了一个数值线性代数领域中适定的、有科学依据的问题。所有必要信息都已提供，任务是执行一个特定的计算，并基于矩阵分解的基本原理给出解释。\n\n首先，我们构造降阶更新后的矩阵 $A_{-} = A - u u^{T}$。已知 $A = I_{3}$ ( $3 \\times 3$ 单位矩阵) 和 $u = \\begin{pmatrix} 1 - \\delta \\\\ 1 \\\\ 0 \\end{pmatrix}$，我们首先计算外积 $u u^{T}$：\n$$\nu u^{T} = \\begin{pmatrix} 1 - \\delta \\\\ 1 \\\\ 0 \\end{pmatrix} \\begin{pmatrix} 1 - \\delta  1  0 \\end{pmatrix} = \\begin{pmatrix} (1-\\delta)^{2}  1-\\delta  0 \\\\ 1-\\delta  1  0 \\\\ 0  0  0 \\end{pmatrix}\n$$\n降阶更新后的矩阵 $A_{-}$ 则为：\n$$\nA_{-} = I_{3} - u u^{T} = \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} - \\begin{pmatrix} (1-\\delta)^{2}  1-\\delta  0 \\\\ 1-\\delta  1  0 \\\\ 0  0  0 \\end{pmatrix}\n$$\n$$\nA_{-} = \\begin{pmatrix} 1 - (1-\\delta)^{2}  -(1-\\delta)  0 \\\\ -(1-\\delta)  1-1  0 \\\\ 0  0  1-0 \\end{pmatrix}\n$$\n我们来简化元素 $A_{-}(1,1)$：\n$$\nA_{-}(1,1) = 1 - (1 - 2\\delta + \\delta^{2}) = 2\\delta - \\delta^{2} = \\delta(2-\\delta)\n$$\n因此，降阶更新后的矩阵是：\n$$\nA_{-} = \\begin{pmatrix} \\delta(2-\\delta)  -(1-\\delta)  0 \\\\ -(1-\\delta)  0  0 \\\\ 0  0  1 \\end{pmatrix}\n$$\n问题描述了一个不进行主元重选的朴素 $LDL^{T}$ 分解步骤，强制使用 $(1,1)$ 元素作为主元。$LDL^{T}$ 分解是一种对称高斯消元。第一步中，主元是 $\\tilde{d}_{1} = A_{-}(1,1)$。为消除第一列中的次对角元素所需的乘子存储在单位下三角矩阵 $\\tilde{L}$ 的第一列中。\n乘子 $\\tilde{L}_{21}$ 定义为将 $A_{-}$ 的第1行乘以该因子后从第2行中减去，以在 $(2,1)$ 位置上产生一个零。它由要消去的元素与主元元素之比给出：\n$$\n\\tilde{L}_{21} = \\frac{A_{-}(2,1)}{A_{-}(1,1)}\n$$\n代入 $A_{-}$ 的元素表达式：\n$$\n\\tilde{L}_{21} = \\frac{-(1-\\delta)}{\\delta(2-\\delta)}\n$$\n题目要求我们计算当 $\\delta = 10^{-8}$ 时 $|\\tilde{L}_{21}|$ 的大小。\n$$\n\\left|\\tilde{L}_{21}\\right| = \\left| \\frac{-(1-\\delta)}{\\delta(2-\\delta)} \\right| = \\frac{1-\\delta}{\\delta(2-\\delta)}\n$$\n代入 $\\delta = 10^{-8}$：\n$$\n\\left|\\tilde{L}_{21}\\right| = \\frac{1 - 10^{-8}}{10^{-8}(2 - 10^{-8})} = \\frac{0.99999999}{10^{-8}(1.99999998)} = \\frac{0.99999999}{1.99999998 \\times 10^{-8}}\n$$\n进行除法计算：\n$$\n\\left|\\tilde{L}_{21}\\right| = 0.5000000025 \\times 10^{8} = 50000000.25\n$$\n将此结果四舍五入到四位有效数字，得到 $5.000 \\times 10^{7}$。\n\n这个结果可以作为一个反例，证明朴素降阶更新过程的不稳定性，原因如下：\n原始分解 $A = I_{3} = I_{3} I_{3} I_{3}^{T}$ 由元素大小为1或0的良态矩阵组成。使用向量 $u$ 进行的秩-1修正是看似无害的。然而，它将矩阵 $A$ 转换为 $A_{-}$，后者具有非常不同的结构。\n当 $\\delta = 10^{-8}$ 时，主元元素 $\\tilde{d}_{1} = A_{-}(1,1) = 2\\delta - \\delta^{2}$ 约等于 $2 \\times 10^{-8}$，非常接近于零。非对角元素 $A_{-}(2,1) = -(1-\\delta)$ 的大小接近于1。\n不稳定的机制在于，将一个中等大小的非对角元素 ($A_{-}(2,1) \\approx -1$) 除以一个非常小的主元元素 ($\\tilde{d}_{1} \\approx 2 \\times 10^{-8}$)。这导致了一个极大的乘子，即 $|\\tilde{L}_{21}| \\approx 0.5 \\times 10^{8}$。这种现象被称为元素增长。因子矩阵中的大元素是数值不稳定性的一个主要指标，因为它们会放大后续计算中的舍入误差。\n一个稳健的对称不定分解算法，例如使用 Bunch-Kaufman 主元选择法的算法，会检查矩阵 $A_{-}$ 并发现 $1 \\times 1$ 主元 $A_{-}(1,1)$ 相对于非对角元素来说太小。然后它会选择一个更稳定的主元，例如使用前导 $2 \\times 2$ 子矩阵 $\\begin{pmatrix} A_{-}(1,1)  A_{-}(1,2) \\\\ A_{-}(2,1)  A_{-}(2,2) \\end{pmatrix}$ 的 $2 \\times 2$ 块主元，从而避免除以小数和随之而来的元素增长。朴素方法之所以失败，是因为它没有重新考虑主元选择，而这个选择在降阶更新后变得很差。",
            "answer": "$$\\boxed{5.000 \\times 10^{7}}$$"
        },
        {
            "introduction": "本实践将理论与数据分析中的一个核心应用联系起来：高效更新线性回归模型。当一个数据点（即矩阵$A$和向量$b$中的一行）被移除时，重新从头计算最小二乘解的成本可能很高。本练习将指导你使用两种不同的方法——一种基于QR分解的降级，另一种基于对法方程的Cholesky因子进行秩一降级——来计算新的解。通过这个过程，你不仅能体会到因子分解降级在实际问题中的威力，还能验证不同数值方法在解决同一问题时的一致性。",
            "id": "3600432",
            "problem": "考虑由超定系统 $\\min_{x \\in \\mathbb{R}^{2}} \\|A x - b\\|_{2}$ 定义的线性最小二乘 (LS) 问题，其中\n$$\nA \\;=\\;\n\\begin{pmatrix}\n1  0\\\\\n1  1\\\\\n1  2\\\\\n2  1\n\\end{pmatrix}\n,\\quad\nb \\;=\\;\n\\begin{pmatrix}\n1\\\\\n2\\\\\n2\\\\\n3\n\\end{pmatrix}.\n$$\n移除单个观测值：删除矩阵 $A$ 的第三行和向量 $b$ 的第三个元素，得到降级更新后的数据\n$$\nA' \\;=\\;\n\\begin{pmatrix}\n1  0\\\\\n1  1\\\\\n2  1\n\\end{pmatrix}\n,\\quad\nb' \\;=\\;\n\\begin{pmatrix}\n1\\\\\n2\\\\\n3\n\\end{pmatrix}.\n$$\n从 LS 的基本定义以及关于法方程的正交三角 (QR) 分解和 Cholesky 分解的核心知识出发，使用以下两种原则性方法，推导在删除一行后更新的 LS 解 $\\hat{x}'$：\n- 一种基于 QR 的降级更新方法，通过正交变换恢复上三角因子。\n- 一种基于 Cholesky 的方法，对法方程矩阵和右侧向量进行秩一降级更新。\n\n证明两种方法得到相同的 $\\hat{x}'$。将最终答案表示为单个行向量。无需四舍五入。",
            "solution": "该问题要求解一个降级更新后的线性最小二乘 (LS) 问题。给定一个初始 LS 问题 $\\min_{x \\in \\mathbb{R}^{2}} \\|A x - b\\|_{2}$，通过删除矩阵 $A$ 的第三行和向量 $b$ 的第三个元素，构成了一个新问题 $\\min_{x' \\in \\mathbb{R}^{2}} \\|A' x' - b'\\|_{2}$。我们必须使用两种不同的方法——基于 QR 的降级更新和基于 Cholesky 的降级更新——来找到新的解向量 $\\hat{x}'$，并证明它们得出相同的结果。\n\n原始数据为：\n$$\nA \\;=\\;\n\\begin{pmatrix}\n1  0\\\\\n1  1\\\\\n1  2\\\\\n2  1\n\\end{pmatrix}\n,\\quad\nb \\;=\\;\n\\begin{pmatrix}\n1\\\\\n2\\\\\n2\\\\\n3\n\\end{pmatrix}.\n$$\n$A$ 的第三行是 $a_3^T = \\begin{pmatrix} 1  2 \\end{pmatrix}$，$b$ 的第三个元素是 $b_3 = 2$。\n降级更新后的数据为：\n$$\nA' \\;=\\;\n\\begin{pmatrix}\n1  0\\\\\n1  1\\\\\n2  1\n\\end{pmatrix}\n,\\quad\nb' \\;=\\;\n\\begin{pmatrix}\n1\\\\\n2\\\\\n3\n\\end{pmatrix}.\n$$\nLS 问题 $\\min_{x} \\|Ax-b\\|_2$ 的解 $\\hat{x}$ 由法方程 $A^T A x = A^T b$ 的解给出。类似地，降级更新后的解 $\\hat{x}'$ 是 $A'^T A' x' = A'^T b'$ 的解。\n\n首先，我们建立原始法方程与降级更新后法方程之间的关系。降级更新后的法方程矩阵 $A'^T A'$ 通过一次秩一更新与原始矩阵 $A^T A$ 相关联：\n$$\nA'^T A' = A^T A - a_3 a_3^T.\n$$\n类似地，降级更新后的右侧向量为：\n$$\nA'^T b' = A^T b - a_3 b_3.\n$$\n\n现在我们使用指定的两种方法求解 $\\hat{x}'$。\n\n**方法 1：基于 QR 的降级更新**\n\n该方法涉及对矩阵 $A$ 的 QR 分解的因子进行降级更新。LS 解可通过求解三角系统 $Rx=c_1$ 得到，其中 $A=QR$（$Q$ 的列是标准正交的，$R$ 是上三角矩阵），$c_1$ 由 $Q^T b$ 的前 $n$ 个分量组成。法方程可以写为 $R^T R x = R^T c_1$。\n\n降级更新过程将新问题的因子 $R$ 和 $c_1$ 更新为 $R'$ 和 $c_1'$。新因子满足：\n$$\nR'^T R' = A'^T A' = A^T A - a_3 a_3^T = R^T R - a_3 a_3^T\n$$\n$$\nR'^T c_1' = A'^T b' = A^T b - a_3 b_3 = R^T c_1 - a_3 b_3\n$$\n\n1.  首先，我们计算原始法方程的组成部分，$A^T A$ 和 $A^T b$。\n    $$\n    A^T A = \\begin{pmatrix} 1  1  1  2 \\\\ 0  1  2  1 \\end{pmatrix} \\begin{pmatrix} 1  0 \\\\ 1  1 \\\\ 1  2 \\\\ 2  1 \\end{pmatrix} = \\begin{pmatrix} 1+1+1+4  0+1+2+2 \\\\ 0+1+2+2  0+1+4+1 \\end{pmatrix} = \\begin{pmatrix} 7  5 \\\\ 5  6 \\end{pmatrix}.\n    $$\n    $$\n    A^T b = \\begin{pmatrix} 1  1  1  2 \\\\ 0  1  2  1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 2 \\\\ 2 \\\\ 3 \\end{pmatrix} = \\begin{pmatrix} 1+2+2+6 \\\\ 0+2+4+3 \\end{pmatrix} = \\begin{pmatrix} 11 \\\\ 9 \\end{pmatrix}.\n    $$\n    因此，$R^T R = \\begin{pmatrix} 7  5 \\\\ 5  6 \\end{pmatrix}$ 且 $R^T c_1 = \\begin{pmatrix} 11 \\\\ 9 \\end{pmatrix}$。\n\n2.  接下来，我们计算降级更新后的矩阵 $R'^T R'$ 和 $R'^T c_1'$。已知 $a_3 = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix}$ 和 $b_3=2$：\n    $$\n    R'^T R' = \\begin{pmatrix} 7  5 \\\\ 5  6 \\end{pmatrix} - \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix} \\begin{pmatrix} 1  2 \\end{pmatrix} = \\begin{pmatrix} 7  5 \\\\ 5  6 \\end{pmatrix} - \\begin{pmatrix} 1  2 \\\\ 2  4 \\end{pmatrix} = \\begin{pmatrix} 6  3 \\\\ 3  2 \\end{pmatrix}.\n    $$\n    $$\n    R'^T c_1' = \\begin{pmatrix} 11 \\\\ 9 \\end{pmatrix} - \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix} (2) = \\begin{pmatrix} 11 \\\\ 9 \\end{pmatrix} - \\begin{pmatrix} 2 \\\\ 4 \\end{pmatrix} = \\begin{pmatrix} 9 \\\\ 5 \\end{pmatrix}.\n    $$\n\n3.  为了恢复上三角结构，我们使用 Cholesky 分解从 $R'^T R'$ 中找到新的因子 $R'$。令 $R' = \\begin{pmatrix} r'_{11}  r'_{12} \\\\ 0  r'_{22} \\end{pmatrix}$。\n    $r'_{11} = \\sqrt{6}$。\n    $r'_{11} r'_{12} = 3 \\implies r'_{12} = 3 / \\sqrt{6} = \\sqrt{3/2}$。\n    $(r'_{12})^2 + (r'_{22})^2 = 2 \\implies 3/2 + (r'_{22})^2 = 2 \\implies (r'_{22})^2 = 1/2 \\implies r'_{22} = 1/\\sqrt{2}$。\n    因此，$R' = \\begin{pmatrix} \\sqrt{6}  \\sqrt{3/2} \\\\ 0  1/\\sqrt{2} \\end{pmatrix}$。\n\n4.  我们通过求解下三角系统 $R'^T c_1' = \\begin{pmatrix} 9 \\\\ 5 \\end{pmatrix}$ 来找到新的右侧向量 $c_1'$。令 $c_1' = \\begin{pmatrix} c'_1 \\\\ c'_2 \\end{pmatrix}$。\n    $R'^T = \\begin{pmatrix} \\sqrt{6}  0 \\\\ \\sqrt{3/2}  1/\\sqrt{2} \\end{pmatrix}$。\n    $\\sqrt{6} c'_1 = 9 \\implies c'_1 = 9/\\sqrt{6}$。\n    $\\sqrt{3/2} c'_1 + (1/\\sqrt{2}) c'_2 = 5 \\implies \\sqrt{3/2} (9/\\sqrt{6}) + c'_2/\\sqrt{2} = 5$。\n    $9\\sqrt{3/12} + c'_2/\\sqrt{2} = 5 \\implies 9\\sqrt{1/4} + c'_2/\\sqrt{2} = 5 \\implies 9/2 + c'_2/\\sqrt{2} = 5$。\n    $c'_2/\\sqrt{2} = 1/2 \\implies c'_2 = \\sqrt{2}/2 = 1/\\sqrt{2}$。\n    因此，$c_1' = \\begin{pmatrix} 9/\\sqrt{6} \\\\ 1/\\sqrt{2} \\end{pmatrix}$。\n\n5.  最后，我们求解上三角系统 $R' \\hat{x}' = c_1'$ 以获得降级更新后的解 $\\hat{x}' = \\begin{pmatrix} x'_1 \\\\ x'_2 \\end{pmatrix}$。\n    $$\n    \\begin{pmatrix} \\sqrt{6}  \\sqrt{3/2} \\\\ 0  1/\\sqrt{2} \\end{pmatrix} \\begin{pmatrix} x'_1 \\\\ x'_2 \\end{pmatrix} = \\begin{pmatrix} 9/\\sqrt{6} \\\\ 1/\\sqrt{2} \\end{pmatrix}.\n    $$\n    从第二行得到：$(1/\\sqrt{2}) x'_2 = 1/\\sqrt{2} \\implies x'_2 = 1$。\n    从第一行得到：$\\sqrt{6} x'_1 + \\sqrt{3/2} x'_2 = 9/\\sqrt{6}$。\n    $\\sqrt{6} x'_1 + \\sqrt{3/2} (1) = 9/\\sqrt{6}$。\n    两边乘以 $\\sqrt{6}$：$6 x'_1 + \\sqrt{3/2}\\sqrt{6} = 9 \\implies 6 x'_1 + \\sqrt{9} = 9 \\implies 6 x'_1 + 3 = 9$。\n    $6 x'_1 = 6 \\implies x'_1 = 1$。\n    因此，解为 $\\hat{x}' = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$。\n\n**方法 2：基于 Cholesky 的秩一降级更新**\n\n此方法直接对法方程矩阵 $M=A^T A$ 和右侧向量 $y=A^T b$ 进行降级更新，然后求解得到的线性系统。\n\n1.  从原始法方程矩阵 $M=A^T A$ 和向量 $y=A^T b$ 开始：\n    $$\n    M = \\begin{pmatrix} 7  5 \\\\ 5  6 \\end{pmatrix}, \\quad y = \\begin{pmatrix} 11 \\\\ 9 \\end{pmatrix}.\n    $$\n\n2.  使用 $a_3 = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix}$ 和 $b_3=2$ 执行秩一降级更新。\n    降级更新后的矩阵为 $M' = M - a_3 a_3^T$：\n    $$\n    M' = \\begin{pmatrix} 7  5 \\\\ 5  6 \\end{pmatrix} - \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix} \\begin{pmatrix} 1  2 \\end{pmatrix} = \\begin{pmatrix} 7  5 \\\\ 5  6 \\end{pmatrix} - \\begin{pmatrix} 1  2 \\\\ 2  4 \\end{pmatrix} = \\begin{pmatrix} 6  3 \\\\ 3  2 \\end{pmatrix}.\n    $$\n    降级更新后的向量为 $y' = y - a_3 b_3$：\n    $$\n    y' = \\begin{pmatrix} 11 \\\\ 9 \\end{pmatrix} - \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix} (2) = \\begin{pmatrix} 11 \\\\ 9 \\end{pmatrix} - \\begin{pmatrix} 2 \\\\ 4 \\end{pmatrix} = \\begin{pmatrix} 9 \\\\ 5 \\end{pmatrix}.\n    $$\n\n3.  求解降级更新后的法方程 $M' \\hat{x}' = y'$：\n    $$\n    \\begin{pmatrix} 6  3 \\\\ 3  2 \\end{pmatrix} \\begin{pmatrix} x'_1 \\\\ x'_2 \\end{pmatrix} = \\begin{pmatrix} 9 \\\\ 5 \\end{pmatrix}.\n    $$\n    这是一个由两个线性方程组成的方程组：\n    $6x'_1 + 3x'_2 = 9 \\implies 2x'_1 + x'_2 = 3$。\n    $3x'_1 + 2x'_2 = 5$。\n    由第一个方程可得，$x'_2 = 3 - 2x'_1$。\n    代入第二个方程：$3x'_1 + 2(3 - 2x'_1) = 5$。\n    $3x'_1 + 6 - 4x'_1 = 5 \\implies -x'_1 = -1 \\implies x'_1 = 1$。\n    代回：$x'_2 = 3 - 2(1) = 1$。\n    解为 $\\hat{x}' = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$。\n\n**结论**\n\n基于 QR 的降级更新方法和基于 Cholesky 的降级更新方法都为降级更新后的最小二乘问题得出了相同的解：$\\hat{x}' = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$。这证实了两种推导的正确性。最终答案按要求表示为行向量。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1  1\n\\end{pmatrix}\n}\n$$"
        }
    ]
}